const a303_0x5e9595=a303_0x1bae;(function(_0x2f0cb0,_0x3cec78){const _0x3853dc=a303_0x1bae,_0xea317c=_0x2f0cb0();while(!![]){try{const _0x161c32=parseInt(_0x3853dc(0xd9))/0x1*(-parseInt(_0x3853dc(0xb6))/0x2)+parseInt(_0x3853dc(0x83))/0x3*(parseInt(_0x3853dc(0xd6))/0x4)+-parseInt(_0x3853dc(0xe0))/0x5*(-parseInt(_0x3853dc(0xc8))/0x6)+parseInt(_0x3853dc(0xa8))/0x7*(-parseInt(_0x3853dc(0xa0))/0x8)+parseInt(_0x3853dc(0xe1))/0x9+-parseInt(_0x3853dc(0x99))/0xa+parseInt(_0x3853dc(0x9c))/0xb*(parseInt(_0x3853dc(0x96))/0xc);if(_0x161c32===_0x3cec78)break;else _0xea317c['push'](_0xea317c['shift']());}catch(_0x377a7b){_0xea317c['push'](_0xea317c['shift']());}}}(a303_0x4418,0xddec2));function a303_0x4418(){const _0x217a1d=['Tracking\x20components\x20job\x20has\x20been\x20failed','stream/promises','Tracking_Setting__c','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','../../../core','../../../constants','then','catch','initMetadataLogger','getComponentsDeployer','../../shared/managers/auth.manager','Is_Processed__c','targetInstance','getSourceMemberHandler','defineProperty','MetadataRetriever','(((.+)+)+)+$','AxiosInstanceUtils','516vBzwzC','lastRetrieveDate','metadataLogger','12790850knhfzF','__importDefault','../../../constants/job','5698iWKxhJ','SourceMemberHandler','startDate','flosumInstance','519128DJgqZr','create','parse','slice','updateTrackingSetting','readFile','Tracking\x20components\x20job\x20has\x20been\x20completed','message','7GQBBfD','getMetadataRetriever','initLogger','FLOSUM_NAMESPACE','initManifest','status','jobStorePath','init','IN_PROGRESS','RestSimpleDeployData','Job','./classes/source-member.retriever','createTrackingSettingRecord','update','294RrtwcK','__esModule','ComponentsDeployer','targetOrgId','toString','trackingSettingId','log','default','./classes/metadata.retriever','apiVersion','SourceMemberRetriever','timeZone','EXCEPTION','MetadataLogger','Logger','metadataLogId','search','fs/promises','1426962zMTWQJ','targetOrgCredentials','success','COMPLETED','jobId','getSourceMemberRetriever','MANIFEST_FILENAME','Last_Start_Retrieval__c','execute','./classes/components.deployer','error','flosumOrgCredentials','logger','./classes/metadata-logger','1542820rmYkCH','metadataTypes','path','2198ScnJBR','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','initInstances','getTime','AuthManager','Job\x20Error:\x20','join','20sjkXPx','7479756eVicXo','LogStatus','6koVCqp'];a303_0x4418=function(){return _0x217a1d;};return a303_0x4418();}const a303_0x114351=(function(){let _0x254ee6=!![];return function(_0x57ac7a,_0x10d966){const _0x425776=_0x254ee6?function(){if(_0x10d966){const _0x472cb9=_0x10d966['apply'](_0x57ac7a,arguments);return _0x10d966=null,_0x472cb9;}}:function(){};return _0x254ee6=![],_0x425776;};}()),a303_0x5b2aa7=a303_0x114351(this,function(){const _0x3a5f18=a303_0x1bae;return a303_0x5b2aa7[_0x3a5f18(0xba)]()[_0x3a5f18(0xc6)]('(((.+)+)+)+$')[_0x3a5f18(0xba)]()['constructor'](a303_0x5b2aa7)[_0x3a5f18(0xc6)](_0x3a5f18(0x94));});a303_0x5b2aa7();'use strict';var __importDefault=this&&this[a303_0x5e9595(0x9a)]||function(_0x5d98de){const _0x57e5ee=a303_0x5e9595;return _0x5d98de&&_0x5d98de[_0x57e5ee(0xb7)]?_0x5d98de:{'default':_0x5d98de};};Object[a303_0x5e9595(0x92)](exports,a303_0x5e9595(0xb7),{'value':!![]}),exports[a303_0x5e9595(0xb2)]=void 0x0;const minimist_1=__importDefault(require('minimist')),core_1=require(a303_0x5e9595(0x88)),salesforce_1=require('@flosum/salesforce'),auth_manager_1=require(a303_0x5e9595(0x8e)),logger_1=require('./classes/logger/logger'),promises_1=require(a303_0x5e9595(0x85)),promises_2=require(a303_0x5e9595(0xc7)),path_1=__importDefault(require(a303_0x5e9595(0xd8))),metadata_retriever_1=require(a303_0x5e9595(0xbe)),components_deployer_1=require(a303_0x5e9595(0xd1)),source_member_retriever_1=require(a303_0x5e9595(0xb3)),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require(a303_0x5e9595(0xd5)),job_1=require(a303_0x5e9595(0x9b)),constants_1=require(a303_0x5e9595(0x89)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1[a303_0x5e9595(0xbd)])(process['argv'][a303_0x5e9595(0xa3)](0x2)),systemLogger=new core_1['Logger'](jobId);function a303_0x1bae(_0xad3a83,_0x482d7b){const _0x3b49d4=a303_0x4418();return a303_0x1bae=function(_0x5b2aa7,_0x114351){_0x5b2aa7=_0x5b2aa7-0x83;let _0x441890=_0x3b49d4[_0x5b2aa7];return _0x441890;},a303_0x1bae(_0xad3a83,_0x482d7b);}class Job{constructor(){const _0x1819ab=a303_0x5e9595;this[_0x1819ab(0xae)]=jobStorePath,this[_0x1819ab(0xcc)]=jobId;}async[a303_0x5e9595(0xac)](){const _0x4e0be2=a303_0x5e9595,_0x1aaf89=path_1[_0x4e0be2(0xbd)][_0x4e0be2(0xdf)](this[_0x4e0be2(0xae)],job_1[_0x4e0be2(0xce)]),_0x5914fc=await(0x0,promises_2[_0x4e0be2(0xa5)])(_0x1aaf89,{'encoding':'utf-8'})[_0x4e0be2(0x8a)](JSON[_0x4e0be2(0xa2)])[_0x4e0be2(0x8a)](({details:_0x581a9e})=>_0x581a9e);await(0x0,promises_2['rm'])(_0x1aaf89,{'recursive':!![],'force':!![]}),this[_0x4e0be2(0xbf)]=_0x5914fc['apiVersion'],this[_0x4e0be2(0xd3)]=_0x5914fc[_0x4e0be2(0xd3)],this[_0x4e0be2(0xc9)]=_0x5914fc[_0x4e0be2(0xc9)],this[_0x4e0be2(0xb9)]=_0x5914fc[_0x4e0be2(0xb9)],this[_0x4e0be2(0xbb)]=_0x5914fc[_0x4e0be2(0xbb)],this['lastRetrieveDate']=_0x5914fc['lastRetrieveDate'],this[_0x4e0be2(0xd7)]=_0x5914fc[_0x4e0be2(0xd7)],this[_0x4e0be2(0xc1)]=_0x5914fc['timeZone'];}async[a303_0x5e9595(0xdb)](){const _0x88931f=a303_0x5e9595;this[_0x88931f(0x9f)]=await salesforce_1['AxiosInstanceUtils'][_0x88931f(0xa1)](new auth_manager_1[(_0x88931f(0xdd))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x88931f(0x90)]=await salesforce_1[_0x88931f(0x95)][_0x88931f(0xa1)](new auth_manager_1['AuthManager'](this[_0x88931f(0xc9)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a303_0x5e9595(0x8c)](){const _0x26d986=a303_0x5e9595;this[_0x26d986(0x98)]=new metadata_logger_1[(_0x26d986(0xc3))]({'apiVersion':this['apiVersion'],'instance':this[_0x26d986(0x9f)],'targetOrgId':this[_0x26d986(0xb9)],'trackingSettingId':this[_0x26d986(0xbb)],'startDate':this[_0x26d986(0x9e)]}),this['metadataLogId']=await this['metadataLogger'][_0x26d986(0xaf)]();}['initLogger'](){const _0x4d42a3=a303_0x5e9595;this['logger']=new logger_1[(_0x4d42a3(0xc4))]({'systemLogger':systemLogger,'apiVersion':this[_0x4d42a3(0xbf)],'instance':this['flosumInstance'],'metadataLogId':this[_0x4d42a3(0xc5)],'timeZone':this[_0x4d42a3(0xc1)]});}['getSourceMemberRetriever'](){const _0x5d8082=a303_0x5e9595;return new source_member_retriever_1[(_0x5d8082(0xc0))]({'apiVersion':this['apiVersion'],'instance':this[_0x5d8082(0x90)],'logger':this['logger'],'lastRetrieveDate':this[_0x5d8082(0x97)],'currentRetrieveDate':this['startDate'],'metadataTypes':this[_0x5d8082(0xd7)]});}[a303_0x5e9595(0x91)](){const _0x30cb98=a303_0x5e9595;return new source_member_handler_1[(_0x30cb98(0x9d))]({'instance':this[_0x30cb98(0x9f)],'apiVersion':this[_0x30cb98(0xbf)],'logger':this[_0x30cb98(0xd4)],'targetOrgId':this[_0x30cb98(0xb9)]});}[a303_0x5e9595(0xa9)](){const _0x55eacb=a303_0x5e9595;return new metadata_retriever_1[(_0x55eacb(0x93))]({'instance':this[_0x55eacb(0x90)],'apiVersion':this[_0x55eacb(0xbf)],'logger':this[_0x55eacb(0xd4)],'metadataTypes':this[_0x55eacb(0xd7)]});}[a303_0x5e9595(0x8d)](){const _0x119e12=a303_0x5e9595;return new components_deployer_1[(_0x119e12(0xb8))]({'instance':this[_0x119e12(0x9f)],'logger':this['logger'],'apiVersion':this['apiVersion'],'targetOrgId':this[_0x119e12(0xb9)],'trackingSettingId':this[_0x119e12(0xbb)]});}['createTrackingSettingRecord'](){const _0x7160f9=a303_0x5e9595;return{'attributes':{'type':constants_1[_0x7160f9(0xab)]+'Tracking_Setting__c'},'Id':this['trackingSettingId'],[constants_1[_0x7160f9(0xab)]+_0x7160f9(0x8f)]:![],[constants_1['FLOSUM_NAMESPACE']+_0x7160f9(0xcf)]:this[_0x7160f9(0x9e)]};}async['updateTrackingSetting'](){const _0x3ab15b=a303_0x5e9595,_0x405baf=this[_0x3ab15b(0xb4)](),_0x3ea41a=new salesforce_1[(_0x3ab15b(0xb1))]({'instance':this[_0x3ab15b(0x9f)],'objectName':constants_1[_0x3ab15b(0xab)]+_0x3ab15b(0x86),'api':this[_0x3ab15b(0xbf)],'allOrNone':![],'externalIdField':'Id'}),_0x385d69=await _0x3ea41a[_0x3ab15b(0xd0)]({'records':[_0x405baf]}),_0x5412ce=_0x385d69['at'](0x0);(_0x5412ce===null||_0x5412ce===void 0x0?void 0x0:_0x5412ce[_0x3ab15b(0xca)])?this['logger'][_0x3ab15b(0xbc)]('Tracking\x20setting\x20updated'):this[_0x3ab15b(0xd4)][_0x3ab15b(0xbc)](_0x3ab15b(0xda)+(_0x5412ce===null||_0x5412ce===void 0x0?void 0x0:_0x5412ce[_0x3ab15b(0xd2)]));}async[a303_0x5e9595(0xd0)](){const _0x518b6f=a303_0x5e9595;await this[_0x518b6f(0xac)](),this[_0x518b6f(0x9e)]=new Date()[_0x518b6f(0xdc)]();try{await this[_0x518b6f(0xdb)](),await this[_0x518b6f(0x8c)](),this[_0x518b6f(0xaa)](),this[_0x518b6f(0xd4)][_0x518b6f(0xbc)](_0x518b6f(0x87)+this[_0x518b6f(0xcc)]),this[_0x518b6f(0x98)]['status']=constants_2[_0x518b6f(0xe2)][_0x518b6f(0xb0)],await this[_0x518b6f(0x98)][_0x518b6f(0xb5)](),await this['logger'][_0x518b6f(0xb5)]();const _0x107a8b=this[_0x518b6f(0xcd)](),_0x1e1347=this[_0x518b6f(0x91)](),_0x41131f=this[_0x518b6f(0xa9)](),_0x197ac4=this[_0x518b6f(0x8d)]();await(0x0,promises_1['pipeline'])(_0x107a8b,_0x1e1347,_0x41131f,_0x197ac4),this[_0x518b6f(0xd4)]['log'](_0x518b6f(0xa6)),this[_0x518b6f(0x98)][_0x518b6f(0xad)]=constants_2[_0x518b6f(0xe2)][_0x518b6f(0xcb)];}catch(_0x403a61){this[_0x518b6f(0xd4)][_0x518b6f(0xd2)](_0x518b6f(0x84)),this[_0x518b6f(0xd4)][_0x518b6f(0xd2)](_0x403a61[_0x518b6f(0xa7)]),this[_0x518b6f(0x98)]['status']=constants_2[_0x518b6f(0xe2)][_0x518b6f(0xc2)];}finally{await this[_0x518b6f(0xa4)](),await this[_0x518b6f(0xd4)]['update'](),await this['metadataLogger']['update']();}}}exports[a303_0x5e9595(0xb2)]=Job,new Job()[a303_0x5e9595(0xd0)]()[a303_0x5e9595(0x8a)](()=>process['exit'](0x0))[a303_0x5e9595(0x8b)](_0x530b99=>{const _0x136dfc=a303_0x5e9595;systemLogger['error'](_0x136dfc(0xde)+_0x530b99['message']),process['exit'](0x1);});