const a348_0x5b56f3=a348_0x1ed4;function a348_0x3659(){const _0x57d167=['error','10784DgGOBF','defineProperty','getSourceMemberHandler','FLOSUM_NAMESPACE','join','isProcessed','__importDefault','parse','startDate','flosumInstance','jobId','execute','default','15405eQlUVG','4xyXooL','getSourceMemberRetriever','136571eSbybw','targetOrgId','Last_Start_Retrieval__c','(((.+)+)+)+$','EXCEPTION','metadataLogId','SourceMemberHandler','jobStorePath','LogStatus','../../../constants','RestSimpleDeployData','initMetadataLogger','IN_PROGRESS','metadataLogger','flosumOrgCredentials','targetInstance','message','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','ComponentsDeployer','catch','MetadataRetriever','MANIFEST_FILENAME','__esModule','create','updateTrackingSetting','utf-8','Tracking\x20components\x20job\x20has\x20been\x20failed','../../../constants/job','exit','AxiosInstanceUtils','AuthManager','6QsBKYn','28950924VdYaXU','toString','update','slice','getTime','Is_Processed__c','Tracking_Setting__c','initManifest','apiVersion','Logger','getComponentsDeployer','Job','then','6YfMPvb','7758961zPhRHy','targetOrgCredentials','initLogger','timeZone','5674630GmmohJ','Job\x20Error:\x20','11vOGMtz','./classes/source-member.retriever','stream/promises','SourceMemberRetriever','Tracking\x20components\x20job\x20has\x20been\x20completed','search','MetadataLogger','path','getMetadataRetriever','./classes/source-member.handler','../../shared/managers/auth.manager','trackingSettingId','log','createTrackingSettingRecord','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','./classes/logger/logger','status','./classes/metadata.retriever','logger','311514tigXUg','lastRetrieveDate','@flosum/salesforce','minimist','1530AdGGGo'];a348_0x3659=function(){return _0x57d167;};return a348_0x3659();}(function(_0x2d81de,_0x387c0d){const _0x15eed3=a348_0x1ed4,_0x989a80=_0x2d81de();while(!![]){try{const _0xacc372=-parseInt(_0x15eed3(0xa7))/0x1*(parseInt(_0x15eed3(0xc6))/0x2)+parseInt(_0x15eed3(0x91))/0x3*(parseInt(_0x15eed3(0xa5))/0x4)+parseInt(_0x15eed3(0xa4))/0x5+parseInt(_0x15eed3(0xd4))/0x6*(-parseInt(_0x15eed3(0xd5))/0x7)+-parseInt(_0x15eed3(0x97))/0x8*(-parseInt(_0x15eed3(0x95))/0x9)+-parseInt(_0x15eed3(0xd9))/0xa+-parseInt(_0x15eed3(0x7e))/0xb*(-parseInt(_0x15eed3(0xc7))/0xc);if(_0xacc372===_0x387c0d)break;else _0x989a80['push'](_0x989a80['shift']());}catch(_0x1273ec){_0x989a80['push'](_0x989a80['shift']());}}}(a348_0x3659,0xa1e11));function a348_0x1ed4(_0x1153ec,_0xaf4f0d){const _0x4f1149=a348_0x3659();return a348_0x1ed4=function(_0x5db017,_0x2ee226){_0x5db017=_0x5db017-0x7d;let _0x36594=_0x4f1149[_0x5db017];return _0x36594;},a348_0x1ed4(_0x1153ec,_0xaf4f0d);}const a348_0x2ee226=(function(){let _0x2260ea=!![];return function(_0x2bbb96,_0x480778){const _0x460cdf=_0x2260ea?function(){if(_0x480778){const _0x3b5c28=_0x480778['apply'](_0x2bbb96,arguments);return _0x480778=null,_0x3b5c28;}}:function(){};return _0x2260ea=![],_0x460cdf;};}()),a348_0x5db017=a348_0x2ee226(this,function(){const _0x42f6d1=a348_0x1ed4;return a348_0x5db017[_0x42f6d1(0xc8)]()[_0x42f6d1(0x83)](_0x42f6d1(0xaa))['toString']()['constructor'](a348_0x5db017)[_0x42f6d1(0x83)](_0x42f6d1(0xaa));});a348_0x5db017();'use strict';var __importDefault=this&&this[a348_0x5b56f3(0x9d)]||function(_0x108420){const _0xe3a231=a348_0x5b56f3;return _0x108420&&_0x108420[_0xe3a231(0xbd)]?_0x108420:{'default':_0x108420};};Object[a348_0x5b56f3(0x98)](exports,a348_0x5b56f3(0xbd),{'value':!![]}),exports[a348_0x5b56f3(0xd2)]=void 0x0;const minimist_1=__importDefault(require(a348_0x5b56f3(0x94))),core_1=require('../../../core'),salesforce_1=require(a348_0x5b56f3(0x93)),auth_manager_1=require(a348_0x5b56f3(0x88)),logger_1=require(a348_0x5b56f3(0x8d)),promises_1=require(a348_0x5b56f3(0x80)),promises_2=require('fs/promises'),path_1=__importDefault(require(a348_0x5b56f3(0x85))),metadata_retriever_1=require(a348_0x5b56f3(0x8f)),components_deployer_1=require('./classes/components.deployer'),source_member_retriever_1=require(a348_0x5b56f3(0x7f)),source_member_handler_1=require(a348_0x5b56f3(0x87)),metadata_logger_1=require('./classes/metadata-logger'),job_1=require(a348_0x5b56f3(0xc2)),constants_1=require(a348_0x5b56f3(0xb0)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1[a348_0x5b56f3(0xa3)])(process['argv'][a348_0x5b56f3(0xca)](0x2)),systemLogger=new core_1['Logger'](jobId);class Job{constructor(){const _0x274231=a348_0x5b56f3;this[_0x274231(0xae)]=jobStorePath,this['jobId']=jobId;}async[a348_0x5b56f3(0xce)](){const _0x216ff6=a348_0x5b56f3,_0x204a50=path_1[_0x216ff6(0xa3)][_0x216ff6(0x9b)](this['jobStorePath'],job_1[_0x216ff6(0xbc)]),_0x17c655=await(0x0,promises_2['readFile'])(_0x204a50,{'encoding':_0x216ff6(0xc0)})[_0x216ff6(0xd3)](JSON[_0x216ff6(0x9e)])[_0x216ff6(0xd3)](({details:_0xbb78ae})=>_0xbb78ae);await(0x0,promises_2['rm'])(_0x204a50,{'recursive':!![],'force':!![]}),this[_0x216ff6(0xcf)]=_0x17c655[_0x216ff6(0xcf)],this[_0x216ff6(0xb5)]=_0x17c655[_0x216ff6(0xb5)],this[_0x216ff6(0xd6)]=_0x17c655[_0x216ff6(0xd6)],this[_0x216ff6(0xa8)]=_0x17c655['targetOrgId'],this[_0x216ff6(0x89)]=_0x17c655[_0x216ff6(0x89)],this[_0x216ff6(0x92)]=_0x17c655[_0x216ff6(0x92)],this['metadataTypes']=_0x17c655['metadataTypes'],this[_0x216ff6(0xd8)]=_0x17c655[_0x216ff6(0xd8)];}async['initInstances'](){const _0x6b35a8=a348_0x5b56f3;this[_0x6b35a8(0xa0)]=await salesforce_1[_0x6b35a8(0xc4)][_0x6b35a8(0xbe)](new auth_manager_1[(_0x6b35a8(0xc5))](this[_0x6b35a8(0xb5)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this['targetInstance']=await salesforce_1['AxiosInstanceUtils'][_0x6b35a8(0xbe)](new auth_manager_1[(_0x6b35a8(0xc5))](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a348_0x5b56f3(0xb2)](){const _0xff235f=a348_0x5b56f3;this[_0xff235f(0xb4)]=new metadata_logger_1[(_0xff235f(0x84))]({'apiVersion':this['apiVersion'],'instance':this[_0xff235f(0xa0)],'targetOrgId':this[_0xff235f(0xa8)],'trackingSettingId':this[_0xff235f(0x89)],'startDate':this[_0xff235f(0x9f)]}),this[_0xff235f(0xac)]=await this[_0xff235f(0xb4)]['init']();}[a348_0x5b56f3(0xd7)](){const _0xaef371=a348_0x5b56f3;this[_0xaef371(0x90)]=new logger_1[(_0xaef371(0xd0))]({'systemLogger':systemLogger,'apiVersion':this[_0xaef371(0xcf)],'instance':this[_0xaef371(0xa0)],'metadataLogId':this[_0xaef371(0xac)],'timeZone':this[_0xaef371(0xd8)]});}[a348_0x5b56f3(0xa6)](){const _0xd1ecfb=a348_0x5b56f3;return new source_member_retriever_1[(_0xd1ecfb(0x81))]({'apiVersion':this[_0xd1ecfb(0xcf)],'instance':this[_0xd1ecfb(0xb6)],'logger':this[_0xd1ecfb(0x90)],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0xd1ecfb(0x9f)],'metadataTypes':this['metadataTypes']});}[a348_0x5b56f3(0x99)](){const _0x23937f=a348_0x5b56f3;return new source_member_handler_1[(_0x23937f(0xad))]({'instance':this[_0x23937f(0xa0)],'apiVersion':this[_0x23937f(0xcf)],'logger':this[_0x23937f(0x90)],'targetOrgId':this['targetOrgId']});}['getMetadataRetriever'](){const _0x4fbfba=a348_0x5b56f3;return new metadata_retriever_1[(_0x4fbfba(0xbb))]({'instance':this[_0x4fbfba(0xb6)],'apiVersion':this['apiVersion'],'logger':this['logger'],'metadataTypes':this['metadataTypes']});}[a348_0x5b56f3(0xd1)](){const _0x3c76cf=a348_0x5b56f3;return new components_deployer_1[(_0x3c76cf(0xb9))]({'instance':this[_0x3c76cf(0xa0)],'logger':this[_0x3c76cf(0x90)],'apiVersion':this['apiVersion'],'targetOrgId':this[_0x3c76cf(0xa8)],'trackingSettingId':this['trackingSettingId']});}[a348_0x5b56f3(0x8b)](){const _0x3b7c3a=a348_0x5b56f3;return{'attributes':{'type':constants_1[_0x3b7c3a(0x9a)]+_0x3b7c3a(0xcd)},'Id':this[_0x3b7c3a(0x89)],[constants_1[_0x3b7c3a(0x9a)]+_0x3b7c3a(0xcc)]:this[_0x3b7c3a(0x9c)],[constants_1[_0x3b7c3a(0x9a)]+_0x3b7c3a(0xa9)]:this[_0x3b7c3a(0x9f)]};}async['updateTrackingSetting'](){const _0x33bd48=a348_0x5b56f3,_0x35f011=this[_0x33bd48(0x8b)](),_0xcdb5f7=new salesforce_1[(_0x33bd48(0xb1))]({'instance':this[_0x33bd48(0xa0)],'objectName':constants_1[_0x33bd48(0x9a)]+_0x33bd48(0xcd),'api':this[_0x33bd48(0xcf)],'allOrNone':![],'externalIdField':'Id'}),_0x573689=await _0xcdb5f7[_0x33bd48(0xa2)]({'records':[_0x35f011]}),_0x38f01b=_0x573689['at'](0x0);(_0x38f01b===null||_0x38f01b===void 0x0?void 0x0:_0x38f01b['success'])?this['logger']['log']('Tracking\x20setting\x20updated'):this[_0x33bd48(0x90)]['log'](_0x33bd48(0x8c)+(_0x38f01b===null||_0x38f01b===void 0x0?void 0x0:_0x38f01b[_0x33bd48(0x96)]));}async['execute'](){const _0x1d0094=a348_0x5b56f3;await this['initManifest'](),this[_0x1d0094(0x9f)]=new Date()[_0x1d0094(0xcb)]();try{await this['initInstances'](),await this[_0x1d0094(0xb2)](),this['initLogger'](),this[_0x1d0094(0x90)][_0x1d0094(0x8a)](_0x1d0094(0xb8)+this[_0x1d0094(0xa1)]),this[_0x1d0094(0xb4)]['status']=constants_2[_0x1d0094(0xaf)][_0x1d0094(0xb3)],this['isProcessed']=!![],await this[_0x1d0094(0xbf)](),await this['metadataLogger']['update'](),await this[_0x1d0094(0x90)][_0x1d0094(0xc9)]();const _0x558e07=this['getSourceMemberRetriever'](),_0x40e502=this['getSourceMemberHandler'](),_0x27a7c0=this[_0x1d0094(0x86)](),_0x4bcd02=this[_0x1d0094(0xd1)]();await(0x0,promises_1['pipeline'])(_0x558e07,_0x40e502,_0x27a7c0,_0x4bcd02),this[_0x1d0094(0x90)]['log'](_0x1d0094(0x82)),this[_0x1d0094(0xb4)][_0x1d0094(0x8e)]=constants_2['LogStatus']['COMPLETED'];}catch(_0xebf616){this['logger'][_0x1d0094(0x96)](_0x1d0094(0xc1)),this['logger'][_0x1d0094(0x96)](_0xebf616[_0x1d0094(0xb7)]),this[_0x1d0094(0xb4)][_0x1d0094(0x8e)]=constants_2['LogStatus'][_0x1d0094(0xab)];}finally{this['isProcessed']=![],await this[_0x1d0094(0xbf)](),await this[_0x1d0094(0x90)][_0x1d0094(0xc9)](),await this[_0x1d0094(0xb4)][_0x1d0094(0xc9)]();}}}exports['Job']=Job,new Job()[a348_0x5b56f3(0xa2)]()[a348_0x5b56f3(0xd3)](()=>process['exit'](0x0))[a348_0x5b56f3(0xba)](_0x445952=>{const _0xd68e24=a348_0x5b56f3;systemLogger[_0xd68e24(0x96)](_0xd68e24(0x7d)+_0x445952[_0xd68e24(0xb7)]),process[_0xd68e24(0xc3)](0x1);});