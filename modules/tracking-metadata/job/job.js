const a304_0x429c34=a304_0xacbe;(function(_0x3974cf,_0x4d9996){const _0x5523a8=a304_0xacbe,_0x34b382=_0x3974cf();while(!![]){try{const _0x34bb7b=-parseInt(_0x5523a8(0xc5))/0x1+-parseInt(_0x5523a8(0xa3))/0x2+parseInt(_0x5523a8(0xcc))/0x3*(parseInt(_0x5523a8(0xca))/0x4)+parseInt(_0x5523a8(0xd9))/0x5+parseInt(_0x5523a8(0xdb))/0x6*(parseInt(_0x5523a8(0xf5))/0x7)+parseInt(_0x5523a8(0xdd))/0x8*(parseInt(_0x5523a8(0xe1))/0x9)+-parseInt(_0x5523a8(0xc2))/0xa;if(_0x34bb7b===_0x4d9996)break;else _0x34b382['push'](_0x34b382['shift']());}catch(_0x29cc4b){_0x34b382['push'](_0x34b382['shift']());}}}(a304_0x5bbb,0x45c57));const a304_0x5e4761=(function(){let _0x1c54d5=!![];return function(_0x3bc432,_0x30ee20){const _0x595a18=_0x1c54d5?function(){const _0x582899=a304_0xacbe;if(_0x30ee20){const _0x64f7a=_0x30ee20[_0x582899(0xb4)](_0x3bc432,arguments);return _0x30ee20=null,_0x64f7a;}}:function(){};return _0x1c54d5=![],_0x595a18;};}()),a304_0x38d8aa=a304_0x5e4761(this,function(){const _0x31e05b=a304_0xacbe;return a304_0x38d8aa[_0x31e05b(0xa6)]()['search'](_0x31e05b(0xa7))[_0x31e05b(0xa6)]()[_0x31e05b(0xb3)](a304_0x38d8aa)[_0x31e05b(0xea)]('(((.+)+)+)+$');});function a304_0x5bbb(){const _0x15483c=['initManifest','slice','MANIFEST_FILENAME','update','default','__esModule','__importDefault','metadataLogger','log','defineProperty','getComponentsDeployer','939398ySupgn','getSourceMemberHandler','./classes/source-member.retriever','toString','(((.+)+)+)+$','trackingSettingId','Tracking_Setting__c','getMetadataRetriever','../../../constants/job','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','startDate','join','logger','message','catch','metadataTypes','constructor','apply','SourceMemberRetriever','LogStatus','RestSimpleDeployData','targetOrgCredentials','initMetadataLogger','AxiosInstanceUtils','jobId','argv','targetInstance','../../shared/managers/auth.manager','./classes/components.deployer','Job','execute','666080ihhpvm','create','then','458840oyAGJu','MetadataRetriever','updateTrackingSetting','utf-8','FLOSUM_NAMESPACE','488tYZUnM','status','2958nkuabB','targetOrgId','Tracking\x20components\x20job\x20has\x20been\x20failed','@flosum/salesforce','AuthManager','Job\x20Error:\x20','fs/promises','createTrackingSettingRecord','stream/promises','metadataLogId','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','initLogger','getSourceMemberRetriever','2313595wwmLvI','jobStorePath','445350pLhvGy','flosumOrgCredentials','8ikhsWo','apiVersion','lastRetrieveDate','error','4945221UQloco','MetadataLogger','./classes/source-member.handler','IN_PROGRESS','EXCEPTION','SourceMemberHandler','../constants','exit','getTime','search','Logger','./classes/logger/logger','pipeline','../../../core','minimist','Is_Processed__c','path','flosumInstance','timeZone','./classes/metadata-logger','14mAckhk','../../../constants','initInstances'];a304_0x5bbb=function(){return _0x15483c;};return a304_0x5bbb();}a304_0x38d8aa();'use strict';function a304_0xacbe(_0x2f1a86,_0x5a4c5f){const _0x28c8ad=a304_0x5bbb();return a304_0xacbe=function(_0x38d8aa,_0x5e4761){_0x38d8aa=_0x38d8aa-0xa3;let _0x5bbb0d=_0x28c8ad[_0x38d8aa];return _0x5bbb0d;},a304_0xacbe(_0x2f1a86,_0x5a4c5f);}var __importDefault=this&&this[a304_0x429c34(0xfe)]||function(_0x529458){return _0x529458&&_0x529458['__esModule']?_0x529458:{'default':_0x529458};};Object[a304_0x429c34(0x101)](exports,a304_0x429c34(0xfd),{'value':!![]}),exports[a304_0x429c34(0xc0)]=void 0x0;const minimist_1=__importDefault(require(a304_0x429c34(0xef))),core_1=require(a304_0x429c34(0xee)),salesforce_1=require(a304_0x429c34(0xcf)),auth_manager_1=require(a304_0x429c34(0xbe)),logger_1=require(a304_0x429c34(0xec)),promises_1=require(a304_0x429c34(0xd4)),promises_2=require(a304_0x429c34(0xd2)),path_1=__importDefault(require(a304_0x429c34(0xf1))),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a304_0x429c34(0xbf)),source_member_retriever_1=require(a304_0x429c34(0xa5)),source_member_handler_1=require(a304_0x429c34(0xe3)),metadata_logger_1=require(a304_0x429c34(0xf4)),job_1=require(a304_0x429c34(0xab)),constants_1=require(a304_0x429c34(0xf6)),constants_2=require(a304_0x429c34(0xe7)),{jobId,jobStorePath}=(0x0,minimist_1['default'])(process[a304_0x429c34(0xbc)][a304_0x429c34(0xf9)](0x2)),systemLogger=new core_1[(a304_0x429c34(0xeb))](jobId);class Job{constructor(){const _0x424e80=a304_0x429c34;this[_0x424e80(0xda)]=jobStorePath,this['jobId']=jobId;}async[a304_0x429c34(0xf8)](){const _0x43dc81=a304_0x429c34,_0x3d6b1e=path_1[_0x43dc81(0xfc)][_0x43dc81(0xae)](this[_0x43dc81(0xda)],job_1[_0x43dc81(0xfa)]),_0x1cd241=await(0x0,promises_2['readFile'])(_0x3d6b1e,{'encoding':_0x43dc81(0xc8)})[_0x43dc81(0xc4)](JSON['parse'])[_0x43dc81(0xc4)](({details:_0x527e65})=>_0x527e65);await(0x0,promises_2['rm'])(_0x3d6b1e,{'recursive':!![],'force':!![]}),this[_0x43dc81(0xde)]=_0x1cd241[_0x43dc81(0xde)],this[_0x43dc81(0xdc)]=_0x1cd241[_0x43dc81(0xdc)],this[_0x43dc81(0xb8)]=_0x1cd241['targetOrgCredentials'],this[_0x43dc81(0xcd)]=_0x1cd241[_0x43dc81(0xcd)],this[_0x43dc81(0xa8)]=_0x1cd241['trackingSettingId'],this[_0x43dc81(0xdf)]=_0x1cd241[_0x43dc81(0xdf)],this['metadataTypes']=_0x1cd241[_0x43dc81(0xb2)],this[_0x43dc81(0xf3)]=_0x1cd241[_0x43dc81(0xf3)];}async['initInstances'](){const _0x2a6c32=a304_0x429c34;this[_0x2a6c32(0xf2)]=await salesforce_1[_0x2a6c32(0xba)][_0x2a6c32(0xc3)](new auth_manager_1[(_0x2a6c32(0xd0))](this[_0x2a6c32(0xdc)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x2a6c32(0xbd)]=await salesforce_1[_0x2a6c32(0xba)][_0x2a6c32(0xc3)](new auth_manager_1['AuthManager'](this[_0x2a6c32(0xb8)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a304_0x429c34(0xb9)](){const _0x2e8e74=a304_0x429c34;this[_0x2e8e74(0xff)]=new metadata_logger_1[(_0x2e8e74(0xe2))]({'apiVersion':this[_0x2e8e74(0xde)],'instance':this[_0x2e8e74(0xf2)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x2e8e74(0xa8)],'startDate':this['startDate']}),this[_0x2e8e74(0xd5)]=await this[_0x2e8e74(0xff)]['init']();}[a304_0x429c34(0xd7)](){const _0x1bfe35=a304_0x429c34;this['logger']=new logger_1['Logger']({'systemLogger':systemLogger,'apiVersion':this[_0x1bfe35(0xde)],'instance':this[_0x1bfe35(0xf2)],'metadataLogId':this[_0x1bfe35(0xd5)],'timeZone':this[_0x1bfe35(0xf3)]});}[a304_0x429c34(0xd8)](){const _0xa70df4=a304_0x429c34;return new source_member_retriever_1[(_0xa70df4(0xb5))]({'apiVersion':this['apiVersion'],'instance':this[_0xa70df4(0xbd)],'logger':this[_0xa70df4(0xaf)],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0xa70df4(0xad)],'metadataTypes':this['metadataTypes']});}['getSourceMemberHandler'](){const _0x2baa0f=a304_0x429c34;return new source_member_handler_1[(_0x2baa0f(0xe6))]({'instance':this[_0x2baa0f(0xf2)],'apiVersion':this[_0x2baa0f(0xde)],'logger':this[_0x2baa0f(0xaf)],'targetOrgId':this[_0x2baa0f(0xcd)]});}[a304_0x429c34(0xaa)](){const _0x2c5fc6=a304_0x429c34;return new metadata_retriever_1[(_0x2c5fc6(0xc6))]({'instance':this['targetInstance'],'apiVersion':this['apiVersion'],'logger':this['logger'],'metadataTypes':this[_0x2c5fc6(0xb2)]});}[a304_0x429c34(0x102)](){const _0x142adb=a304_0x429c34;return new components_deployer_1['ComponentsDeployer']({'instance':this[_0x142adb(0xf2)],'logger':this[_0x142adb(0xaf)],'apiVersion':this['apiVersion'],'targetOrgId':this[_0x142adb(0xcd)],'trackingSettingId':this['trackingSettingId']});}[a304_0x429c34(0xd3)](){const _0x4cd9f4=a304_0x429c34;return{'attributes':{'type':constants_1[_0x4cd9f4(0xc9)]+'Tracking_Setting__c'},'Id':this[_0x4cd9f4(0xa8)],[constants_1[_0x4cd9f4(0xc9)]+_0x4cd9f4(0xf0)]:![],[constants_1[_0x4cd9f4(0xc9)]+'Last_Start_Retrieval__c']:this[_0x4cd9f4(0xad)]};}async[a304_0x429c34(0xc7)](){const _0x593f81=a304_0x429c34,_0x58d57e=this[_0x593f81(0xd3)](),_0x1c0860=new salesforce_1[(_0x593f81(0xb7))]({'instance':this[_0x593f81(0xf2)],'objectName':constants_1[_0x593f81(0xc9)]+_0x593f81(0xa9),'api':this[_0x593f81(0xde)],'allOrNone':![],'externalIdField':'Id'}),_0x22751a=await _0x1c0860[_0x593f81(0xc1)]({'records':[_0x58d57e]}),_0x483ee9=_0x22751a['at'](0x0);(_0x483ee9===null||_0x483ee9===void 0x0?void 0x0:_0x483ee9['success'])?this[_0x593f81(0xaf)][_0x593f81(0x100)]('Tracking\x20setting\x20updated'):this[_0x593f81(0xaf)][_0x593f81(0x100)](_0x593f81(0xac)+(_0x483ee9===null||_0x483ee9===void 0x0?void 0x0:_0x483ee9[_0x593f81(0xe0)]));}async['execute'](){const _0x4f5456=a304_0x429c34;await this[_0x4f5456(0xf8)](),this['startDate']=new Date()[_0x4f5456(0xe9)]();try{await this[_0x4f5456(0xf7)](),await this[_0x4f5456(0xb9)](),this[_0x4f5456(0xd7)](),this[_0x4f5456(0xaf)][_0x4f5456(0x100)](_0x4f5456(0xd6)+this[_0x4f5456(0xbb)]),this[_0x4f5456(0xff)][_0x4f5456(0xcb)]=constants_2[_0x4f5456(0xb6)][_0x4f5456(0xe4)],await this[_0x4f5456(0xff)]['update'](),await this[_0x4f5456(0xaf)]['update']();const _0x84bc71=this[_0x4f5456(0xd8)](),_0x470214=this[_0x4f5456(0xa4)](),_0x31a894=this[_0x4f5456(0xaa)](),_0x1f2d08=this[_0x4f5456(0x102)]();await(0x0,promises_1[_0x4f5456(0xed)])(_0x84bc71,_0x470214,_0x31a894,_0x1f2d08),this[_0x4f5456(0xaf)]['log']('Tracking\x20components\x20job\x20has\x20been\x20completed'),this[_0x4f5456(0xff)]['status']=constants_2['LogStatus']['COMPLETED'];}catch(_0x5b0c48){this[_0x4f5456(0xaf)][_0x4f5456(0xe0)](_0x4f5456(0xce)),this[_0x4f5456(0xaf)]['error'](_0x5b0c48['message']),this['metadataLogger']['status']=constants_2[_0x4f5456(0xb6)][_0x4f5456(0xe5)];}finally{await this['updateTrackingSetting'](),await this['logger'][_0x4f5456(0xfb)](),await this[_0x4f5456(0xff)][_0x4f5456(0xfb)]();}}}exports[a304_0x429c34(0xc0)]=Job,new Job()[a304_0x429c34(0xc1)]()[a304_0x429c34(0xc4)](()=>process[a304_0x429c34(0xe8)](0x0))[a304_0x429c34(0xb1)](_0x478e72=>{const _0x407c05=a304_0x429c34;systemLogger[_0x407c05(0xe0)](_0x407c05(0xd1)+_0x478e72[_0x407c05(0xb0)]),process['exit'](0x1);});