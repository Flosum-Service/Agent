const a304_0x31eed8=a304_0x29b1;(function(_0x59f762,_0x2a428a){const _0x4595f4=a304_0x29b1,_0x238932=_0x59f762();while(!![]){try{const _0x5d84f8=-parseInt(_0x4595f4(0x1ac))/0x1+-parseInt(_0x4595f4(0x1ee))/0x2+parseInt(_0x4595f4(0x1aa))/0x3*(-parseInt(_0x4595f4(0x1d1))/0x4)+-parseInt(_0x4595f4(0x1a0))/0x5*(-parseInt(_0x4595f4(0x1b5))/0x6)+-parseInt(_0x4595f4(0x1ae))/0x7*(-parseInt(_0x4595f4(0x1ea))/0x8)+parseInt(_0x4595f4(0x1d5))/0x9+parseInt(_0x4595f4(0x1da))/0xa;if(_0x5d84f8===_0x2a428a)break;else _0x238932['push'](_0x238932['shift']());}catch(_0x13ba94){_0x238932['push'](_0x238932['shift']());}}}(a304_0x2667,0xa39ca));function a304_0x29b1(_0x20bb7f,_0x3ef36a){const _0x16e296=a304_0x2667();return a304_0x29b1=function(_0x24235d,_0x57a8d5){_0x24235d=_0x24235d-0x19b;let _0x2667ac=_0x16e296[_0x24235d];return _0x2667ac;},a304_0x29b1(_0x20bb7f,_0x3ef36a);}function a304_0x2667(){const _0x113c43=['timeZone','Tracking\x20components\x20job\x20has\x20been\x20completed','COMPLETED','error','(((.+)+)+)+$','targetInstance','message','./classes/metadata.retriever','execute','2725OwTAbz','initInstances','minimist','targetOrgCredentials','./classes/source-member.handler','trackingSettingId','apiVersion','getTime','SourceMemberHandler','../../../core','1291623kQOzYM','EXCEPTION','1008698tSKvkC','FLOSUM_NAMESPACE','4428228qIrKJG','readFile','initMetadataLogger','AuthManager','create','createTrackingSettingRecord','AxiosInstanceUtils','4722iKpzDO','search','metadataTypes','getSourceMemberRetriever','parse','Tracking\x20components\x20job\x20has\x20been\x20failed','LogStatus','defineProperty','getMetadataRetriever','logger','Last_Start_Retrieval__c','getSourceMemberHandler','fs/promises','./classes/metadata-logger','initManifest','SourceMemberRetriever','success','flosumInstance','utf-8','@flosum/salesforce','init','then','log','startDate','../constants','../../../constants/job','ComponentsDeployer','flosumOrgCredentials','4GvUPOr','RestSimpleDeployData','./classes/source-member.retriever','./classes/logger/logger','4821840XCqCUV','Job','MetadataRetriever','argv','Tracking\x20setting\x20updated','2142570gmmcLN','Logger','MetadataLogger','Tracking_Setting__c','../../shared/managers/auth.manager','metadataLogId','targetOrgId','__esModule','toString','jobId','join','catch','metadataLogger','MANIFEST_FILENAME','updateTrackingSetting','getComponentsDeployer','16HEaSaK','lastRetrieveDate','jobStorePath','default','669494FIGSBP','status'];a304_0x2667=function(){return _0x113c43;};return a304_0x2667();}const a304_0x57a8d5=(function(){let _0x2d53d0=!![];return function(_0x42a6db,_0x12d84a){const _0x1c0fd6=_0x2d53d0?function(){if(_0x12d84a){const _0x328f44=_0x12d84a['apply'](_0x42a6db,arguments);return _0x12d84a=null,_0x328f44;}}:function(){};return _0x2d53d0=![],_0x1c0fd6;};}()),a304_0x24235d=a304_0x57a8d5(this,function(){const _0x488e47=a304_0x29b1;return a304_0x24235d['toString']()[_0x488e47(0x1b6)](_0x488e47(0x19b))[_0x488e47(0x1e2)]()['constructor'](a304_0x24235d)[_0x488e47(0x1b6)](_0x488e47(0x19b));});a304_0x24235d();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4d64af){const _0x1c1292=a304_0x29b1;return _0x4d64af&&_0x4d64af[_0x1c1292(0x1e1)]?_0x4d64af:{'default':_0x4d64af};};Object[a304_0x31eed8(0x1bc)](exports,'__esModule',{'value':!![]}),exports[a304_0x31eed8(0x1d6)]=void 0x0;const minimist_1=__importDefault(require(a304_0x31eed8(0x1a2))),core_1=require(a304_0x31eed8(0x1a9)),salesforce_1=require(a304_0x31eed8(0x1c8)),auth_manager_1=require(a304_0x31eed8(0x1de)),logger_1=require(a304_0x31eed8(0x1d4)),promises_1=require('stream/promises'),promises_2=require(a304_0x31eed8(0x1c1)),path_1=__importDefault(require('path')),metadata_retriever_1=require(a304_0x31eed8(0x19e)),components_deployer_1=require('./classes/components.deployer'),source_member_retriever_1=require(a304_0x31eed8(0x1d3)),source_member_handler_1=require(a304_0x31eed8(0x1a4)),metadata_logger_1=require(a304_0x31eed8(0x1c2)),job_1=require(a304_0x31eed8(0x1ce)),constants_1=require('../../../constants'),constants_2=require(a304_0x31eed8(0x1cd)),{jobId,jobStorePath}=(0x0,minimist_1[a304_0x31eed8(0x1ed)])(process[a304_0x31eed8(0x1d8)]['slice'](0x2)),systemLogger=new core_1[(a304_0x31eed8(0x1db))](jobId);class Job{constructor(){const _0x18f473=a304_0x31eed8;this[_0x18f473(0x1ec)]=jobStorePath,this['jobId']=jobId;}async['initManifest'](){const _0x55b13c=a304_0x31eed8,_0x1fcccf=path_1[_0x55b13c(0x1ed)][_0x55b13c(0x1e4)](this[_0x55b13c(0x1ec)],job_1[_0x55b13c(0x1e7)]),_0x2cd78c=await(0x0,promises_2[_0x55b13c(0x1af)])(_0x1fcccf,{'encoding':_0x55b13c(0x1c7)})[_0x55b13c(0x1ca)](JSON[_0x55b13c(0x1b9)])['then'](({details:_0x5cd1b0})=>_0x5cd1b0);await(0x0,promises_2['rm'])(_0x1fcccf,{'recursive':!![],'force':!![]}),this[_0x55b13c(0x1a6)]=_0x2cd78c[_0x55b13c(0x1a6)],this['flosumOrgCredentials']=_0x2cd78c[_0x55b13c(0x1d0)],this[_0x55b13c(0x1a3)]=_0x2cd78c[_0x55b13c(0x1a3)],this[_0x55b13c(0x1e0)]=_0x2cd78c[_0x55b13c(0x1e0)],this['trackingSettingId']=_0x2cd78c[_0x55b13c(0x1a5)],this[_0x55b13c(0x1eb)]=_0x2cd78c[_0x55b13c(0x1eb)],this['metadataTypes']=_0x2cd78c['metadataTypes'],this[_0x55b13c(0x1f0)]=_0x2cd78c[_0x55b13c(0x1f0)];}async[a304_0x31eed8(0x1a1)](){const _0x2795a0=a304_0x31eed8;this[_0x2795a0(0x1c6)]=await salesforce_1['AxiosInstanceUtils'][_0x2795a0(0x1b2)](new auth_manager_1['AuthManager'](this[_0x2795a0(0x1d0)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this['targetInstance']=await salesforce_1[_0x2795a0(0x1b4)][_0x2795a0(0x1b2)](new auth_manager_1[(_0x2795a0(0x1b1))](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async['initMetadataLogger'](){const _0x160e74=a304_0x31eed8;this[_0x160e74(0x1e6)]=new metadata_logger_1[(_0x160e74(0x1dc))]({'apiVersion':this[_0x160e74(0x1a6)],'instance':this[_0x160e74(0x1c6)],'targetOrgId':this[_0x160e74(0x1e0)],'trackingSettingId':this['trackingSettingId'],'startDate':this['startDate']}),this[_0x160e74(0x1df)]=await this[_0x160e74(0x1e6)][_0x160e74(0x1c9)]();}['initLogger'](){const _0x4db1c2=a304_0x31eed8;this[_0x4db1c2(0x1be)]=new logger_1[(_0x4db1c2(0x1db))]({'systemLogger':systemLogger,'apiVersion':this[_0x4db1c2(0x1a6)],'instance':this[_0x4db1c2(0x1c6)],'metadataLogId':this[_0x4db1c2(0x1df)],'timeZone':this[_0x4db1c2(0x1f0)]});}[a304_0x31eed8(0x1b8)](){const _0x391289=a304_0x31eed8;return new source_member_retriever_1[(_0x391289(0x1c4))]({'apiVersion':this[_0x391289(0x1a6)],'instance':this[_0x391289(0x19c)],'logger':this[_0x391289(0x1be)],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0x391289(0x1cc)],'metadataTypes':this[_0x391289(0x1b7)]});}[a304_0x31eed8(0x1c0)](){const _0x5f4b12=a304_0x31eed8;return new source_member_handler_1[(_0x5f4b12(0x1a8))]({'instance':this[_0x5f4b12(0x1c6)],'apiVersion':this[_0x5f4b12(0x1a6)],'logger':this['logger'],'targetOrgId':this[_0x5f4b12(0x1e0)]});}[a304_0x31eed8(0x1bd)](){const _0x283db4=a304_0x31eed8;return new metadata_retriever_1[(_0x283db4(0x1d7))]({'instance':this[_0x283db4(0x19c)],'apiVersion':this[_0x283db4(0x1a6)],'logger':this[_0x283db4(0x1be)],'metadataTypes':this[_0x283db4(0x1b7)]});}[a304_0x31eed8(0x1e9)](){const _0x567eb4=a304_0x31eed8;return new components_deployer_1[(_0x567eb4(0x1cf))]({'instance':this[_0x567eb4(0x1c6)],'logger':this[_0x567eb4(0x1be)],'apiVersion':this['apiVersion'],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x567eb4(0x1a5)]});}[a304_0x31eed8(0x1b3)](){const _0x33005f=a304_0x31eed8;return{'attributes':{'type':constants_1[_0x33005f(0x1ad)]+_0x33005f(0x1dd)},'Id':this[_0x33005f(0x1a5)],[constants_1[_0x33005f(0x1ad)]+'Is_Processed__c']:![],[constants_1[_0x33005f(0x1ad)]+_0x33005f(0x1bf)]:this[_0x33005f(0x1cc)]};}async[a304_0x31eed8(0x1e8)](){const _0x49428b=a304_0x31eed8,_0x41abc8=this['createTrackingSettingRecord'](),_0x198bbd=new salesforce_1[(_0x49428b(0x1d2))]({'instance':this[_0x49428b(0x1c6)],'objectName':constants_1[_0x49428b(0x1ad)]+_0x49428b(0x1dd),'api':this[_0x49428b(0x1a6)],'allOrNone':![],'externalIdField':'Id'}),_0x3c2d1a=await _0x198bbd[_0x49428b(0x19f)]({'records':[_0x41abc8]}),_0x598212=_0x3c2d1a['at'](0x0);(_0x598212===null||_0x598212===void 0x0?void 0x0:_0x598212[_0x49428b(0x1c5)])?this[_0x49428b(0x1be)][_0x49428b(0x1cb)](_0x49428b(0x1d9)):this[_0x49428b(0x1be)][_0x49428b(0x1cb)]('Tracking\x20setting\x20not\x20updated\x20\x0a\x20'+(_0x598212===null||_0x598212===void 0x0?void 0x0:_0x598212[_0x49428b(0x1f3)]));}async[a304_0x31eed8(0x19f)](){const _0x3349a8=a304_0x31eed8;await this[_0x3349a8(0x1c3)](),this[_0x3349a8(0x1cc)]=new Date()[_0x3349a8(0x1a7)]();try{await this[_0x3349a8(0x1a1)](),await this[_0x3349a8(0x1b0)](),this['initLogger'](),this[_0x3349a8(0x1be)][_0x3349a8(0x1cb)]('Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20'+this[_0x3349a8(0x1e3)]),this[_0x3349a8(0x1e6)][_0x3349a8(0x1ef)]=constants_2[_0x3349a8(0x1bb)]['IN_PROGRESS'],await this[_0x3349a8(0x1e6)]['update'](),await this[_0x3349a8(0x1be)]['update']();const _0x44b5dc=this['getSourceMemberRetriever'](),_0x37c50e=this[_0x3349a8(0x1c0)](),_0x47b9d7=this[_0x3349a8(0x1bd)](),_0x391723=this[_0x3349a8(0x1e9)]();await(0x0,promises_1['pipeline'])(_0x44b5dc,_0x37c50e,_0x47b9d7,_0x391723),this[_0x3349a8(0x1be)][_0x3349a8(0x1cb)](_0x3349a8(0x1f1)),this[_0x3349a8(0x1e6)]['status']=constants_2[_0x3349a8(0x1bb)][_0x3349a8(0x1f2)];}catch(_0x405aa4){this[_0x3349a8(0x1be)][_0x3349a8(0x1f3)](_0x3349a8(0x1ba)),this[_0x3349a8(0x1be)][_0x3349a8(0x1f3)](_0x405aa4[_0x3349a8(0x19d)]),this[_0x3349a8(0x1e6)][_0x3349a8(0x1ef)]=constants_2['LogStatus'][_0x3349a8(0x1ab)];}finally{await this[_0x3349a8(0x1e8)](),await this[_0x3349a8(0x1be)]['update'](),await this[_0x3349a8(0x1e6)]['update']();}}}exports[a304_0x31eed8(0x1d6)]=Job,new Job()[a304_0x31eed8(0x19f)]()['then'](()=>process['exit'](0x0))[a304_0x31eed8(0x1e5)](_0x465543=>{const _0x93ca9f=a304_0x31eed8;systemLogger['error']('Job\x20Error:\x20'+_0x465543[_0x93ca9f(0x19d)]),process['exit'](0x1);});