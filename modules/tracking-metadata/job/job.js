const a319_0x478688=a319_0x1e66;(function(_0x1b1948,_0x63b205){const _0x29c3cd=a319_0x1e66,_0x247046=_0x1b1948();while(!![]){try{const _0x14eefe=-parseInt(_0x29c3cd(0x1b8))/0x1+parseInt(_0x29c3cd(0x1ac))/0x2+-parseInt(_0x29c3cd(0x1f2))/0x3*(-parseInt(_0x29c3cd(0x1c8))/0x4)+parseInt(_0x29c3cd(0x19c))/0x5+-parseInt(_0x29c3cd(0x1c0))/0x6*(-parseInt(_0x29c3cd(0x1d7))/0x7)+-parseInt(_0x29c3cd(0x1a0))/0x8*(-parseInt(_0x29c3cd(0x1c5))/0x9)+-parseInt(_0x29c3cd(0x1f1))/0xa;if(_0x14eefe===_0x63b205)break;else _0x247046['push'](_0x247046['shift']());}catch(_0x101f65){_0x247046['push'](_0x247046['shift']());}}}(a319_0x61d1,0xc7404));const a319_0x20d8ec=(function(){let _0x1ec197=!![];return function(_0x2fe668,_0x2c0285){const _0x25130f=_0x1ec197?function(){const _0x4f6509=a319_0x1e66;if(_0x2c0285){const _0x519146=_0x2c0285[_0x4f6509(0x1bc)](_0x2fe668,arguments);return _0x2c0285=null,_0x519146;}}:function(){};return _0x1ec197=![],_0x25130f;};}()),a319_0x29bc92=a319_0x20d8ec(this,function(){const _0x597b29=a319_0x1e66;return a319_0x29bc92[_0x597b29(0x1cc)]()[_0x597b29(0x1ef)](_0x597b29(0x1e2))[_0x597b29(0x1cc)]()[_0x597b29(0x1dd)](a319_0x29bc92)[_0x597b29(0x1ef)](_0x597b29(0x1e2));});a319_0x29bc92();function a319_0x1e66(_0x2a480c,_0x10c561){const _0x2143ad=a319_0x61d1();return a319_0x1e66=function(_0x29bc92,_0x20d8ec){_0x29bc92=_0x29bc92-0x19c;let _0x61d136=_0x2143ad[_0x29bc92];return _0x61d136;},a319_0x1e66(_0x2a480c,_0x10c561);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4fde05){return _0x4fde05&&_0x4fde05['__esModule']?_0x4fde05:{'default':_0x4fde05};};Object[a319_0x478688(0x1de)](exports,'__esModule',{'value':!![]}),exports[a319_0x478688(0x1df)]=void 0x0;const minimist_1=__importDefault(require(a319_0x478688(0x1cd))),core_1=require(a319_0x478688(0x1cf)),salesforce_1=require(a319_0x478688(0x1c4)),auth_manager_1=require(a319_0x478688(0x1e4)),logger_1=require(a319_0x478688(0x1f4)),promises_1=require(a319_0x478688(0x1ec)),promises_2=require(a319_0x478688(0x1b2)),path_1=__importDefault(require('path')),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a319_0x478688(0x1af)),source_member_retriever_1=require('./classes/source-member.retriever'),source_member_handler_1=require(a319_0x478688(0x1a4)),metadata_logger_1=require(a319_0x478688(0x1b4)),job_1=require('../../../constants/job'),constants_1=require(a319_0x478688(0x1a8)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1[a319_0x478688(0x1ab)])(process[a319_0x478688(0x1d5)][a319_0x478688(0x1ce)](0x2)),systemLogger=new core_1[(a319_0x478688(0x1e7))](jobId);function a319_0x61d1(){const _0x235a87=['(((.+)+)+)+$','error','../../shared/managers/auth.manager','initInstances','Last_Start_Retrieval__c','Logger','getSourceMemberHandler','initMetadataLogger','status','updateTrackingSetting','stream/promises','getSourceMemberRetriever','pipeline','search','getMetadataRetriever','22061600wZTJFn','3MtYPNZ','targetOrgCredentials','./classes/logger/logger','2112025UiSlqC','getComponentsDeployer','MANIFEST_FILENAME','targetInstance','56vZqYmZ','jobId','targetOrgId','metadataLogger','./classes/source-member.handler','readFile','initManifest','init','../../../constants','flosumInstance','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','default','2887146KfvkTf','trackingSettingId','IN_PROGRESS','./classes/components.deployer','success','create','fs/promises','parse','./classes/metadata-logger','logger','metadataTypes','timeZone','1559941ZwcCLQ','Tracking_Setting__c','Tracking\x20setting\x20updated','LogStatus','apply','ComponentsDeployer','metadataLogId','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','54XUykso','utf-8','lastRetrieveDate','update','@flosum/salesforce','1392975uLInzJ','apiVersion','join','4652084QejqUo','initLogger','log','FLOSUM_NAMESPACE','toString','minimist','slice','../../../core','exit','COMPLETED','EXCEPTION','execute','message','argv','startDate','365407BWdYUM','AuthManager','jobStorePath','catch','MetadataLogger','flosumOrgCredentials','constructor','defineProperty','Job','AxiosInstanceUtils','then'];a319_0x61d1=function(){return _0x235a87;};return a319_0x61d1();}class Job{constructor(){const _0x2c7d35=a319_0x478688;this[_0x2c7d35(0x1d9)]=jobStorePath,this['jobId']=jobId;}async[a319_0x478688(0x1a6)](){const _0x15112b=a319_0x478688,_0x409c11=path_1[_0x15112b(0x1ab)][_0x15112b(0x1c7)](this['jobStorePath'],job_1[_0x15112b(0x19e)]),_0x50a0cc=await(0x0,promises_2[_0x15112b(0x1a5)])(_0x409c11,{'encoding':_0x15112b(0x1c1)})['then'](JSON[_0x15112b(0x1b3)])[_0x15112b(0x1e1)](({details:_0x5dae24})=>_0x5dae24);await(0x0,promises_2['rm'])(_0x409c11,{'recursive':!![],'force':!![]}),this[_0x15112b(0x1c6)]=_0x50a0cc[_0x15112b(0x1c6)],this[_0x15112b(0x1dc)]=_0x50a0cc['flosumOrgCredentials'],this[_0x15112b(0x1f3)]=_0x50a0cc[_0x15112b(0x1f3)],this[_0x15112b(0x1a2)]=_0x50a0cc[_0x15112b(0x1a2)],this[_0x15112b(0x1ad)]=_0x50a0cc[_0x15112b(0x1ad)],this[_0x15112b(0x1c2)]=_0x50a0cc[_0x15112b(0x1c2)],this[_0x15112b(0x1b6)]=_0x50a0cc[_0x15112b(0x1b6)],this[_0x15112b(0x1b7)]=_0x50a0cc['timeZone'];}async['initInstances'](){const _0x34d7bf=a319_0x478688;this[_0x34d7bf(0x1a9)]=await salesforce_1[_0x34d7bf(0x1e0)]['create'](new auth_manager_1[(_0x34d7bf(0x1d8))](this[_0x34d7bf(0x1dc)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x34d7bf(0x19f)]=await salesforce_1['AxiosInstanceUtils'][_0x34d7bf(0x1b1)](new auth_manager_1[(_0x34d7bf(0x1d8))](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async['initMetadataLogger'](){const _0x8e74dc=a319_0x478688;this[_0x8e74dc(0x1a3)]=new metadata_logger_1[(_0x8e74dc(0x1db))]({'apiVersion':this[_0x8e74dc(0x1c6)],'instance':this['flosumInstance'],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x8e74dc(0x1ad)],'startDate':this['startDate']}),this['metadataLogId']=await this['metadataLogger'][_0x8e74dc(0x1a7)]();}[a319_0x478688(0x1c9)](){const _0x1580b7=a319_0x478688;this[_0x1580b7(0x1b5)]=new logger_1[(_0x1580b7(0x1e7))]({'systemLogger':systemLogger,'apiVersion':this[_0x1580b7(0x1c6)],'instance':this['flosumInstance'],'metadataLogId':this[_0x1580b7(0x1be)],'timeZone':this[_0x1580b7(0x1b7)]});}[a319_0x478688(0x1ed)](){const _0x228824=a319_0x478688;return new source_member_retriever_1['SourceMemberRetriever']({'apiVersion':this['apiVersion'],'instance':this[_0x228824(0x19f)],'logger':this[_0x228824(0x1b5)],'lastRetrieveDate':this[_0x228824(0x1c2)],'currentRetrieveDate':this[_0x228824(0x1d6)],'metadataTypes':this[_0x228824(0x1b6)]});}[a319_0x478688(0x1e8)](){const _0x4ac71a=a319_0x478688;return new source_member_handler_1['SourceMemberHandler']({'instance':this[_0x4ac71a(0x1a9)],'apiVersion':this['apiVersion'],'logger':this[_0x4ac71a(0x1b5)],'targetOrgId':this[_0x4ac71a(0x1a2)]});}[a319_0x478688(0x1f0)](){const _0x13c4c0=a319_0x478688;return new metadata_retriever_1['MetadataRetriever']({'instance':this[_0x13c4c0(0x19f)],'apiVersion':this[_0x13c4c0(0x1c6)],'logger':this[_0x13c4c0(0x1b5)],'metadataTypes':this[_0x13c4c0(0x1b6)]});}['getComponentsDeployer'](){const _0xcae6d8=a319_0x478688;return new components_deployer_1[(_0xcae6d8(0x1bd))]({'instance':this[_0xcae6d8(0x1a9)],'logger':this[_0xcae6d8(0x1b5)],'apiVersion':this[_0xcae6d8(0x1c6)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0xcae6d8(0x1ad)]});}['createTrackingSettingRecord'](){const _0x383fad=a319_0x478688;return{'attributes':{'type':constants_1[_0x383fad(0x1cb)]+'Tracking_Setting__c'},'Id':this[_0x383fad(0x1ad)],[constants_1[_0x383fad(0x1cb)]+'Is_Processed__c']:![],[constants_1[_0x383fad(0x1cb)]+_0x383fad(0x1e6)]:this[_0x383fad(0x1d6)]};}async[a319_0x478688(0x1eb)](){const _0x1a1441=a319_0x478688,_0x2cc0a0=this['createTrackingSettingRecord'](),_0xdbc986=new salesforce_1['RestSimpleDeployData']({'instance':this[_0x1a1441(0x1a9)],'objectName':constants_1[_0x1a1441(0x1cb)]+_0x1a1441(0x1b9),'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'}),_0x1b974e=await _0xdbc986[_0x1a1441(0x1d3)]({'records':[_0x2cc0a0]}),_0x4eff62=_0x1b974e['at'](0x0);(_0x4eff62===null||_0x4eff62===void 0x0?void 0x0:_0x4eff62[_0x1a1441(0x1b0)])?this[_0x1a1441(0x1b5)][_0x1a1441(0x1ca)](_0x1a1441(0x1ba)):this[_0x1a1441(0x1b5)]['log'](_0x1a1441(0x1bf)+(_0x4eff62===null||_0x4eff62===void 0x0?void 0x0:_0x4eff62[_0x1a1441(0x1e3)]));}async[a319_0x478688(0x1d3)](){const _0x38af41=a319_0x478688;await this['initManifest'](),this[_0x38af41(0x1d6)]=new Date()['getTime']();try{await this[_0x38af41(0x1e5)](),await this[_0x38af41(0x1e9)](),this[_0x38af41(0x1c9)](),this['logger'][_0x38af41(0x1ca)](_0x38af41(0x1aa)+this[_0x38af41(0x1a1)]),this[_0x38af41(0x1a3)]['status']=constants_2['LogStatus'][_0x38af41(0x1ae)],await this[_0x38af41(0x1a3)]['update'](),await this['logger'][_0x38af41(0x1c3)]();const _0x3786cd=this[_0x38af41(0x1ed)](),_0x262b8b=this[_0x38af41(0x1e8)](),_0x2dc780=this[_0x38af41(0x1f0)](),_0x47ab07=this[_0x38af41(0x19d)]();await(0x0,promises_1[_0x38af41(0x1ee)])(_0x3786cd,_0x262b8b,_0x2dc780,_0x47ab07),this[_0x38af41(0x1b5)][_0x38af41(0x1ca)]('Tracking\x20components\x20job\x20has\x20been\x20completed'),this[_0x38af41(0x1a3)][_0x38af41(0x1ea)]=constants_2[_0x38af41(0x1bb)][_0x38af41(0x1d1)];}catch(_0x5766e8){this['logger'][_0x38af41(0x1e3)]('Tracking\x20components\x20job\x20has\x20been\x20failed'),this[_0x38af41(0x1b5)][_0x38af41(0x1e3)](_0x5766e8[_0x38af41(0x1d4)]),this[_0x38af41(0x1a3)][_0x38af41(0x1ea)]=constants_2[_0x38af41(0x1bb)][_0x38af41(0x1d2)];}finally{await this[_0x38af41(0x1eb)](),await this[_0x38af41(0x1b5)][_0x38af41(0x1c3)](),await this[_0x38af41(0x1a3)]['update']();}}}exports[a319_0x478688(0x1df)]=Job,new Job()[a319_0x478688(0x1d3)]()[a319_0x478688(0x1e1)](()=>process['exit'](0x0))[a319_0x478688(0x1da)](_0x4dea32=>{const _0x82061c=a319_0x478688;systemLogger[_0x82061c(0x1e3)]('Job\x20Error:\x20'+_0x4dea32['message']),process[_0x82061c(0x1d0)](0x1);});