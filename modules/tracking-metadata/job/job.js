const a320_0x43ed0f=a320_0x374b;(function(_0x58f6fd,_0x38a664){const _0x4b2aa3=a320_0x374b,_0x3e7fd5=_0x58f6fd();while(!![]){try{const _0x58336d=-parseInt(_0x4b2aa3(0xaa))/0x1+-parseInt(_0x4b2aa3(0xde))/0x2+parseInt(_0x4b2aa3(0xf1))/0x3+-parseInt(_0x4b2aa3(0xe4))/0x4*(parseInt(_0x4b2aa3(0x9f))/0x5)+parseInt(_0x4b2aa3(0xec))/0x6*(parseInt(_0x4b2aa3(0xae))/0x7)+-parseInt(_0x4b2aa3(0xeb))/0x8+-parseInt(_0x4b2aa3(0xf7))/0x9*(-parseInt(_0x4b2aa3(0x9c))/0xa);if(_0x58336d===_0x38a664)break;else _0x3e7fd5['push'](_0x3e7fd5['shift']());}catch(_0x13d166){_0x3e7fd5['push'](_0x3e7fd5['shift']());}}}(a320_0x57bf,0x75183));const a320_0x4c05e4=(function(){let _0x1554b1=!![];return function(_0x9f937,_0x1e2da9){const _0x408074=_0x1554b1?function(){const _0x19b52c=a320_0x374b;if(_0x1e2da9){const _0x1fa7b2=_0x1e2da9[_0x19b52c(0xa6)](_0x9f937,arguments);return _0x1e2da9=null,_0x1fa7b2;}}:function(){};return _0x1554b1=![],_0x408074;};}()),a320_0x5edef0=a320_0x4c05e4(this,function(){const _0x2efebd=a320_0x374b;return a320_0x5edef0[_0x2efebd(0x9e)]()[_0x2efebd(0xb6)]('(((.+)+)+)+$')['toString']()[_0x2efebd(0xb0)](a320_0x5edef0)[_0x2efebd(0xb6)](_0x2efebd(0xb4));});a320_0x5edef0();'use strict';var __importDefault=this&&this[a320_0x43ed0f(0xa1)]||function(_0x35bc7d){const _0x250f34=a320_0x43ed0f;return _0x35bc7d&&_0x35bc7d[_0x250f34(0xed)]?_0x35bc7d:{'default':_0x35bc7d};};Object[a320_0x43ed0f(0xa8)](exports,'__esModule',{'value':!![]}),exports['Job']=void 0x0;function a320_0x374b(_0xd71db,_0x4c0ab1){const _0x386e95=a320_0x57bf();return a320_0x374b=function(_0x5edef0,_0x4c05e4){_0x5edef0=_0x5edef0-0x9c;let _0x57bf7b=_0x386e95[_0x5edef0];return _0x57bf7b;},a320_0x374b(_0xd71db,_0x4c0ab1);}function a320_0x57bf(){const _0x4fc681=['metadataLogger','trackingSettingId','363474KsJnty','Tracking\x20components\x20job\x20has\x20been\x20completed','jobStorePath','getSourceMemberRetriever','log','RestSimpleDeployData','36dNOHbP','../../../constants/job','flosumInstance','message','logger','3615230CApnTp','utf-8','toString','2053930xHwaeR','SourceMemberHandler','__importDefault','initInstances','argv','Tracking\x20setting\x20updated','metadataTypes','apply','./classes/metadata-logger','defineProperty','targetInstance','390794gXFLbx','../constants','initManifest','fs/promises','869834GrBnvw','EXCEPTION','constructor','SourceMemberRetriever','IN_PROGRESS','targetOrgId','(((.+)+)+)+$','catch','search','updateTrackingSetting','getMetadataRetriever','stream/promises','default','initMetadataLogger','FLOSUM_NAMESPACE','MetadataRetriever','Logger','initLogger','./classes/source-member.handler','targetOrgCredentials','then','timeZone','update','../../../constants','apiVersion','path','@flosum/salesforce','./classes/metadata.retriever','getComponentsDeployer','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','slice','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','lastRetrieveDate','metadataLogId','join','minimist','parse','status','create','Tracking_Setting__c','pipeline','getSourceMemberHandler','error','ComponentsDeployer','execute','getTime','./classes/components.deployer','exit','1137854eweHKH','startDate','AxiosInstanceUtils','COMPLETED','Job\x20Error:\x20','AuthManager','4SImtmt','LogStatus','./classes/logger/logger','./classes/source-member.retriever','../../../core','success','MANIFEST_FILENAME','1713376lLrZmu','24bhjsjL','__esModule','Last_Start_Retrieval__c'];a320_0x57bf=function(){return _0x4fc681;};return a320_0x57bf();}const minimist_1=__importDefault(require(a320_0x43ed0f(0xd1))),core_1=require(a320_0x43ed0f(0xe8)),salesforce_1=require(a320_0x43ed0f(0xc8)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a320_0x43ed0f(0xe6)),promises_1=require(a320_0x43ed0f(0xb9)),promises_2=require(a320_0x43ed0f(0xad)),path_1=__importDefault(require(a320_0x43ed0f(0xc7))),metadata_retriever_1=require(a320_0x43ed0f(0xc9)),components_deployer_1=require(a320_0x43ed0f(0xdc)),source_member_retriever_1=require(a320_0x43ed0f(0xe7)),source_member_handler_1=require(a320_0x43ed0f(0xc0)),metadata_logger_1=require(a320_0x43ed0f(0xa7)),job_1=require(a320_0x43ed0f(0xf8)),constants_1=require(a320_0x43ed0f(0xc5)),constants_2=require(a320_0x43ed0f(0xab)),{jobId,jobStorePath}=(0x0,minimist_1[a320_0x43ed0f(0xba)])(process[a320_0x43ed0f(0xa3)][a320_0x43ed0f(0xcc)](0x2)),systemLogger=new core_1[(a320_0x43ed0f(0xbe))](jobId);class Job{constructor(){const _0x22ad79=a320_0x43ed0f;this[_0x22ad79(0xf3)]=jobStorePath,this['jobId']=jobId;}async[a320_0x43ed0f(0xac)](){const _0x16d38c=a320_0x43ed0f,_0x71797d=path_1[_0x16d38c(0xba)][_0x16d38c(0xd0)](this[_0x16d38c(0xf3)],job_1[_0x16d38c(0xea)]),_0x287792=await(0x0,promises_2['readFile'])(_0x71797d,{'encoding':_0x16d38c(0x9d)})['then'](JSON[_0x16d38c(0xd2)])[_0x16d38c(0xc2)](({details:_0xf0eebd})=>_0xf0eebd);await(0x0,promises_2['rm'])(_0x71797d,{'recursive':!![],'force':!![]}),this['apiVersion']=_0x287792['apiVersion'],this['flosumOrgCredentials']=_0x287792['flosumOrgCredentials'],this['targetOrgCredentials']=_0x287792[_0x16d38c(0xc1)],this[_0x16d38c(0xb3)]=_0x287792[_0x16d38c(0xb3)],this[_0x16d38c(0xf0)]=_0x287792[_0x16d38c(0xf0)],this[_0x16d38c(0xce)]=_0x287792['lastRetrieveDate'],this[_0x16d38c(0xa5)]=_0x287792[_0x16d38c(0xa5)],this[_0x16d38c(0xc3)]=_0x287792[_0x16d38c(0xc3)];}async[a320_0x43ed0f(0xa2)](){const _0x3f4edc=a320_0x43ed0f;this[_0x3f4edc(0xf9)]=await salesforce_1[_0x3f4edc(0xe0)]['create'](new auth_manager_1[(_0x3f4edc(0xe3))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x3f4edc(0xa9)]=await salesforce_1[_0x3f4edc(0xe0)][_0x3f4edc(0xd4)](new auth_manager_1[(_0x3f4edc(0xe3))](this[_0x3f4edc(0xc1)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a320_0x43ed0f(0xbb)](){const _0x27d27c=a320_0x43ed0f;this[_0x27d27c(0xef)]=new metadata_logger_1['MetadataLogger']({'apiVersion':this[_0x27d27c(0xc6)],'instance':this[_0x27d27c(0xf9)],'targetOrgId':this[_0x27d27c(0xb3)],'trackingSettingId':this[_0x27d27c(0xf0)],'startDate':this[_0x27d27c(0xdf)]}),this[_0x27d27c(0xcf)]=await this[_0x27d27c(0xef)]['init']();}['initLogger'](){const _0x203e24=a320_0x43ed0f;this[_0x203e24(0xfb)]=new logger_1[(_0x203e24(0xbe))]({'systemLogger':systemLogger,'apiVersion':this['apiVersion'],'instance':this[_0x203e24(0xf9)],'metadataLogId':this[_0x203e24(0xcf)],'timeZone':this[_0x203e24(0xc3)]});}[a320_0x43ed0f(0xf4)](){const _0x55b550=a320_0x43ed0f;return new source_member_retriever_1[(_0x55b550(0xb1))]({'apiVersion':this['apiVersion'],'instance':this['targetInstance'],'logger':this['logger'],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0x55b550(0xdf)],'metadataTypes':this[_0x55b550(0xa5)]});}['getSourceMemberHandler'](){const _0x35182c=a320_0x43ed0f;return new source_member_handler_1[(_0x35182c(0xa0))]({'instance':this[_0x35182c(0xf9)],'apiVersion':this['apiVersion'],'logger':this['logger'],'targetOrgId':this['targetOrgId']});}[a320_0x43ed0f(0xb8)](){const _0x16cbbb=a320_0x43ed0f;return new metadata_retriever_1[(_0x16cbbb(0xbd))]({'instance':this[_0x16cbbb(0xa9)],'apiVersion':this[_0x16cbbb(0xc6)],'logger':this[_0x16cbbb(0xfb)],'metadataTypes':this[_0x16cbbb(0xa5)]});}[a320_0x43ed0f(0xca)](){const _0x3a8fbe=a320_0x43ed0f;return new components_deployer_1[(_0x3a8fbe(0xd9))]({'instance':this[_0x3a8fbe(0xf9)],'logger':this[_0x3a8fbe(0xfb)],'apiVersion':this[_0x3a8fbe(0xc6)],'targetOrgId':this[_0x3a8fbe(0xb3)],'trackingSettingId':this[_0x3a8fbe(0xf0)]});}['createTrackingSettingRecord'](){const _0x816f26=a320_0x43ed0f;return{'attributes':{'type':constants_1[_0x816f26(0xbc)]+'Tracking_Setting__c'},'Id':this[_0x816f26(0xf0)],[constants_1[_0x816f26(0xbc)]+'Is_Processed__c']:![],[constants_1[_0x816f26(0xbc)]+_0x816f26(0xee)]:this['startDate']};}async[a320_0x43ed0f(0xb7)](){const _0xfc8234=a320_0x43ed0f,_0x40b3fc=this['createTrackingSettingRecord'](),_0x47df3a=new salesforce_1[(_0xfc8234(0xf6))]({'instance':this[_0xfc8234(0xf9)],'objectName':constants_1[_0xfc8234(0xbc)]+_0xfc8234(0xd5),'api':this[_0xfc8234(0xc6)],'allOrNone':![],'externalIdField':'Id'}),_0x124aa2=await _0x47df3a[_0xfc8234(0xda)]({'records':[_0x40b3fc]}),_0x1b03f1=_0x124aa2['at'](0x0);(_0x1b03f1===null||_0x1b03f1===void 0x0?void 0x0:_0x1b03f1[_0xfc8234(0xe9)])?this[_0xfc8234(0xfb)][_0xfc8234(0xf5)](_0xfc8234(0xa4)):this[_0xfc8234(0xfb)][_0xfc8234(0xf5)](_0xfc8234(0xcd)+(_0x1b03f1===null||_0x1b03f1===void 0x0?void 0x0:_0x1b03f1[_0xfc8234(0xd8)]));}async['execute'](){const _0x4b3ef2=a320_0x43ed0f;await this[_0x4b3ef2(0xac)](),this['startDate']=new Date()[_0x4b3ef2(0xdb)]();try{await this[_0x4b3ef2(0xa2)](),await this[_0x4b3ef2(0xbb)](),this[_0x4b3ef2(0xbf)](),this[_0x4b3ef2(0xfb)][_0x4b3ef2(0xf5)](_0x4b3ef2(0xcb)+this['jobId']),this[_0x4b3ef2(0xef)][_0x4b3ef2(0xd3)]=constants_2[_0x4b3ef2(0xe5)][_0x4b3ef2(0xb2)],await this[_0x4b3ef2(0xef)][_0x4b3ef2(0xc4)](),await this[_0x4b3ef2(0xfb)][_0x4b3ef2(0xc4)]();const _0x4ab17a=this[_0x4b3ef2(0xf4)](),_0x4cbca6=this[_0x4b3ef2(0xd7)](),_0x3f9716=this[_0x4b3ef2(0xb8)](),_0x492c7c=this[_0x4b3ef2(0xca)]();await(0x0,promises_1[_0x4b3ef2(0xd6)])(_0x4ab17a,_0x4cbca6,_0x3f9716,_0x492c7c),this['logger']['log'](_0x4b3ef2(0xf2)),this['metadataLogger'][_0x4b3ef2(0xd3)]=constants_2[_0x4b3ef2(0xe5)][_0x4b3ef2(0xe1)];}catch(_0x4a1f80){this[_0x4b3ef2(0xfb)][_0x4b3ef2(0xd8)]('Tracking\x20components\x20job\x20has\x20been\x20failed'),this['logger'][_0x4b3ef2(0xd8)](_0x4a1f80[_0x4b3ef2(0xfa)]),this[_0x4b3ef2(0xef)][_0x4b3ef2(0xd3)]=constants_2[_0x4b3ef2(0xe5)][_0x4b3ef2(0xaf)];}finally{await this[_0x4b3ef2(0xb7)](),await this[_0x4b3ef2(0xfb)][_0x4b3ef2(0xc4)](),await this[_0x4b3ef2(0xef)][_0x4b3ef2(0xc4)]();}}}exports['Job']=Job,new Job()[a320_0x43ed0f(0xda)]()[a320_0x43ed0f(0xc2)](()=>process[a320_0x43ed0f(0xdd)](0x0))[a320_0x43ed0f(0xb5)](_0xb0a4c8=>{const _0x7cf67a=a320_0x43ed0f;systemLogger[_0x7cf67a(0xd8)](_0x7cf67a(0xe2)+_0xb0a4c8[_0x7cf67a(0xfa)]),process[_0x7cf67a(0xdd)](0x1);});