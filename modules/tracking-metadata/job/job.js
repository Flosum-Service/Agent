const a304_0x4038b0=a304_0x1708;(function(_0x2d32a0,_0x4cf9f5){const _0x239074=a304_0x1708,_0x2c6bcc=_0x2d32a0();while(!![]){try{const _0x3a4935=-parseInt(_0x239074(0x1d5))/0x1*(-parseInt(_0x239074(0x1a9))/0x2)+parseInt(_0x239074(0x17f))/0x3*(-parseInt(_0x239074(0x1b3))/0x4)+-parseInt(_0x239074(0x1c0))/0x5*(parseInt(_0x239074(0x1d3))/0x6)+parseInt(_0x239074(0x1ce))/0x7+parseInt(_0x239074(0x18d))/0x8+parseInt(_0x239074(0x190))/0x9*(-parseInt(_0x239074(0x182))/0xa)+parseInt(_0x239074(0x1b7))/0xb*(-parseInt(_0x239074(0x1a0))/0xc);if(_0x3a4935===_0x4cf9f5)break;else _0x2c6bcc['push'](_0x2c6bcc['shift']());}catch(_0x534c99){_0x2c6bcc['push'](_0x2c6bcc['shift']());}}}(a304_0x1693,0x1b6b0));const a304_0x3f2820=(function(){let _0x3c8c8b=!![];return function(_0x372230,_0x58bfbe){const _0x46f74f=_0x3c8c8b?function(){const _0x2ab158=a304_0x1708;if(_0x58bfbe){const _0x5e071a=_0x58bfbe[_0x2ab158(0x1cc)](_0x372230,arguments);return _0x58bfbe=null,_0x5e071a;}}:function(){};return _0x3c8c8b=![],_0x46f74f;};}()),a304_0x4e31cc=a304_0x3f2820(this,function(){const _0x5abc78=a304_0x1708;return a304_0x4e31cc[_0x5abc78(0x1bc)]()[_0x5abc78(0x187)](_0x5abc78(0x1d9))[_0x5abc78(0x1bc)]()['constructor'](a304_0x4e31cc)[_0x5abc78(0x187)](_0x5abc78(0x1d9));});a304_0x4e31cc();function a304_0x1693(){const _0x3f5af4=['targetInstance','2010UukJNM','../../shared/managers/auth.manager','../../../core','Is_Processed__c','./classes/source-member.handler','search','update','Tracking\x20components\x20job\x20has\x20been\x20completed','metadataLogId','getComponentsDeployer','message','1033096IBNxrn','create','readFile','6075mTAFdl','__importDefault','targetOrgId','logger','EXCEPTION','flosumInstance','apiVersion','updateTrackingSetting','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','argv','Logger','jobId','Tracking\x20setting\x20updated','Job','parse','stream/promises','24wohsNR','flosumOrgCredentials','IN_PROGRESS','default','jobStorePath','Tracking_Setting__c','startDate','timeZone','init','421766MltDny','success','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','catch','initMetadataLogger','getSourceMemberHandler','log','@flosum/salesforce','execute','./classes/metadata-logger','4364ieFVoR','createTrackingSettingRecord','getTime','./classes/components.deployer','294316lZxrmg','ComponentsDeployer','trackingSettingId','lastRetrieveDate','initLogger','toString','then','path','exit','5kQkiYi','initManifest','./classes/source-member.retriever','FLOSUM_NAMESPACE','slice','MetadataLogger','../../../constants/job','join','initInstances','AxiosInstanceUtils','minimist','fs/promises','apply','AuthManager','710360zSqiJn','MetadataRetriever','../../../constants','error','getMetadataRetriever','264006zCRmSz','getSourceMemberRetriever','1dVjROe','metadataTypes','status','__esModule','(((.+)+)+)+$','Job\x20Error:\x20','SourceMemberRetriever','LogStatus','metadataLogger','264Ysxtlg','targetOrgCredentials'];a304_0x1693=function(){return _0x3f5af4;};return a304_0x1693();}'use strict';var __importDefault=this&&this[a304_0x4038b0(0x191)]||function(_0x5c523e){const _0x1ad27a=a304_0x4038b0;return _0x5c523e&&_0x5c523e[_0x1ad27a(0x1d8)]?_0x5c523e:{'default':_0x5c523e};};Object['defineProperty'](exports,a304_0x4038b0(0x1d8),{'value':!![]}),exports[a304_0x4038b0(0x19d)]=void 0x0;const minimist_1=__importDefault(require(a304_0x4038b0(0x1ca))),core_1=require(a304_0x4038b0(0x184)),salesforce_1=require(a304_0x4038b0(0x1b0)),auth_manager_1=require(a304_0x4038b0(0x183)),logger_1=require('./classes/logger/logger'),promises_1=require(a304_0x4038b0(0x19f)),promises_2=require(a304_0x4038b0(0x1cb)),path_1=__importDefault(require(a304_0x4038b0(0x1be))),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a304_0x4038b0(0x1b6)),source_member_retriever_1=require(a304_0x4038b0(0x1c2)),source_member_handler_1=require(a304_0x4038b0(0x186)),metadata_logger_1=require(a304_0x4038b0(0x1b2)),job_1=require(a304_0x4038b0(0x1c6)),constants_1=require(a304_0x4038b0(0x1d0)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1[a304_0x4038b0(0x1a3)])(process[a304_0x4038b0(0x199)][a304_0x4038b0(0x1c4)](0x2)),systemLogger=new core_1[(a304_0x4038b0(0x19a))](jobId);function a304_0x1708(_0xcdc158,_0x1e1079){const _0x5d668b=a304_0x1693();return a304_0x1708=function(_0x4e31cc,_0x3f2820){_0x4e31cc=_0x4e31cc-0x17d;let _0x16934f=_0x5d668b[_0x4e31cc];return _0x16934f;},a304_0x1708(_0xcdc158,_0x1e1079);}class Job{constructor(){const _0x549a3a=a304_0x4038b0;this[_0x549a3a(0x1a4)]=jobStorePath,this['jobId']=jobId;}async[a304_0x4038b0(0x1c1)](){const _0x529b96=a304_0x4038b0,_0x339aa5=path_1[_0x529b96(0x1a3)][_0x529b96(0x1c7)](this[_0x529b96(0x1a4)],job_1['MANIFEST_FILENAME']),_0x4adc13=await(0x0,promises_2[_0x529b96(0x18f)])(_0x339aa5,{'encoding':'utf-8'})[_0x529b96(0x1bd)](JSON[_0x529b96(0x19e)])['then'](({details:_0x58e3fd})=>_0x58e3fd);await(0x0,promises_2['rm'])(_0x339aa5,{'recursive':!![],'force':!![]}),this['apiVersion']=_0x4adc13['apiVersion'],this[_0x529b96(0x1a1)]=_0x4adc13[_0x529b96(0x1a1)],this[_0x529b96(0x180)]=_0x4adc13[_0x529b96(0x180)],this[_0x529b96(0x192)]=_0x4adc13['targetOrgId'],this['trackingSettingId']=_0x4adc13['trackingSettingId'],this[_0x529b96(0x1ba)]=_0x4adc13[_0x529b96(0x1ba)],this['metadataTypes']=_0x4adc13[_0x529b96(0x1d6)],this[_0x529b96(0x1a7)]=_0x4adc13['timeZone'];}async['initInstances'](){const _0x5207ef=a304_0x4038b0;this[_0x5207ef(0x195)]=await salesforce_1[_0x5207ef(0x1c9)][_0x5207ef(0x18e)](new auth_manager_1['AuthManager'](this[_0x5207ef(0x1a1)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x5207ef(0x181)]=await salesforce_1[_0x5207ef(0x1c9)]['create'](new auth_manager_1[(_0x5207ef(0x1cd))](this[_0x5207ef(0x180)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a304_0x4038b0(0x1ad)](){const _0x2b9aba=a304_0x4038b0;this[_0x2b9aba(0x17e)]=new metadata_logger_1[(_0x2b9aba(0x1c5))]({'apiVersion':this[_0x2b9aba(0x196)],'instance':this[_0x2b9aba(0x195)],'targetOrgId':this[_0x2b9aba(0x192)],'trackingSettingId':this[_0x2b9aba(0x1b9)],'startDate':this[_0x2b9aba(0x1a6)]}),this[_0x2b9aba(0x18a)]=await this[_0x2b9aba(0x17e)][_0x2b9aba(0x1a8)]();}[a304_0x4038b0(0x1bb)](){const _0x4509c5=a304_0x4038b0;this['logger']=new logger_1[(_0x4509c5(0x19a))]({'systemLogger':systemLogger,'apiVersion':this[_0x4509c5(0x196)],'instance':this[_0x4509c5(0x195)],'metadataLogId':this[_0x4509c5(0x18a)],'timeZone':this['timeZone']});}[a304_0x4038b0(0x1d4)](){const _0x127a1f=a304_0x4038b0;return new source_member_retriever_1[(_0x127a1f(0x1db))]({'apiVersion':this[_0x127a1f(0x196)],'instance':this['targetInstance'],'logger':this['logger'],'lastRetrieveDate':this[_0x127a1f(0x1ba)],'currentRetrieveDate':this[_0x127a1f(0x1a6)],'metadataTypes':this[_0x127a1f(0x1d6)]});}[a304_0x4038b0(0x1ae)](){const _0x1de518=a304_0x4038b0;return new source_member_handler_1['SourceMemberHandler']({'instance':this[_0x1de518(0x195)],'apiVersion':this[_0x1de518(0x196)],'logger':this[_0x1de518(0x193)],'targetOrgId':this[_0x1de518(0x192)]});}['getMetadataRetriever'](){const _0x2f5f5d=a304_0x4038b0;return new metadata_retriever_1[(_0x2f5f5d(0x1cf))]({'instance':this['targetInstance'],'apiVersion':this[_0x2f5f5d(0x196)],'logger':this[_0x2f5f5d(0x193)],'metadataTypes':this[_0x2f5f5d(0x1d6)]});}['getComponentsDeployer'](){const _0x4617ca=a304_0x4038b0;return new components_deployer_1[(_0x4617ca(0x1b8))]({'instance':this[_0x4617ca(0x195)],'logger':this['logger'],'apiVersion':this[_0x4617ca(0x196)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x4617ca(0x1b9)]});}[a304_0x4038b0(0x1b4)](){const _0x4cb7aa=a304_0x4038b0;return{'attributes':{'type':constants_1['FLOSUM_NAMESPACE']+_0x4cb7aa(0x1a5)},'Id':this['trackingSettingId'],[constants_1['FLOSUM_NAMESPACE']+_0x4cb7aa(0x185)]:![],[constants_1[_0x4cb7aa(0x1c3)]+'Last_Start_Retrieval__c']:this[_0x4cb7aa(0x1a6)]};}async[a304_0x4038b0(0x197)](){const _0x10e7bc=a304_0x4038b0,_0x1b94bf=this['createTrackingSettingRecord'](),_0x382274=new salesforce_1['RestSimpleDeployData']({'instance':this['flosumInstance'],'objectName':constants_1[_0x10e7bc(0x1c3)]+_0x10e7bc(0x1a5),'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'}),_0x23290a=await _0x382274[_0x10e7bc(0x1b1)]({'records':[_0x1b94bf]}),_0x259c90=_0x23290a['at'](0x0);(_0x259c90===null||_0x259c90===void 0x0?void 0x0:_0x259c90[_0x10e7bc(0x1aa)])?this[_0x10e7bc(0x193)]['log'](_0x10e7bc(0x19c)):this[_0x10e7bc(0x193)][_0x10e7bc(0x1af)](_0x10e7bc(0x1ab)+(_0x259c90===null||_0x259c90===void 0x0?void 0x0:_0x259c90[_0x10e7bc(0x1d1)]));}async[a304_0x4038b0(0x1b1)](){const _0x3708b5=a304_0x4038b0;await this[_0x3708b5(0x1c1)](),this['startDate']=new Date()[_0x3708b5(0x1b5)]();try{await this[_0x3708b5(0x1c8)](),await this[_0x3708b5(0x1ad)](),this[_0x3708b5(0x1bb)](),this['logger']['log'](_0x3708b5(0x198)+this[_0x3708b5(0x19b)]),this[_0x3708b5(0x17e)][_0x3708b5(0x1d7)]=constants_2[_0x3708b5(0x17d)][_0x3708b5(0x1a2)],await this[_0x3708b5(0x17e)][_0x3708b5(0x188)](),await this['logger']['update']();const _0x3eabed=this['getSourceMemberRetriever'](),_0x20941f=this['getSourceMemberHandler'](),_0x52cc95=this[_0x3708b5(0x1d2)](),_0x2755cd=this[_0x3708b5(0x18b)]();await(0x0,promises_1['pipeline'])(_0x3eabed,_0x20941f,_0x52cc95,_0x2755cd),this[_0x3708b5(0x193)]['log'](_0x3708b5(0x189)),this[_0x3708b5(0x17e)]['status']=constants_2[_0x3708b5(0x17d)]['COMPLETED'];}catch(_0x222078){this[_0x3708b5(0x193)]['error']('Tracking\x20components\x20job\x20has\x20been\x20failed'),this[_0x3708b5(0x193)]['error'](_0x222078['message']),this[_0x3708b5(0x17e)][_0x3708b5(0x1d7)]=constants_2['LogStatus'][_0x3708b5(0x194)];}finally{await this[_0x3708b5(0x197)](),await this['logger'][_0x3708b5(0x188)](),await this[_0x3708b5(0x17e)][_0x3708b5(0x188)]();}}}exports[a304_0x4038b0(0x19d)]=Job,new Job()[a304_0x4038b0(0x1b1)]()[a304_0x4038b0(0x1bd)](()=>process[a304_0x4038b0(0x1bf)](0x0))[a304_0x4038b0(0x1ac)](_0x4eb301=>{const _0x3eb15d=a304_0x4038b0;systemLogger[_0x3eb15d(0x1d1)](_0x3eb15d(0x1da)+_0x4eb301[_0x3eb15d(0x18c)]),process[_0x3eb15d(0x1bf)](0x1);});