const a348_0x351be7=a348_0x4a3c;function a348_0x4a3c(_0x16f4c1,_0x28bc85){const _0xafd86d=a348_0x4a96();return a348_0x4a3c=function(_0x92a45a,_0x200494){_0x92a45a=_0x92a45a-0x148;let _0x4a96c1=_0xafd86d[_0x92a45a];return _0x4a96c1;},a348_0x4a3c(_0x16f4c1,_0x28bc85);}(function(_0x883aec,_0x48fc2d){const _0x4bd519=a348_0x4a3c,_0x2166fb=_0x883aec();while(!![]){try{const _0x3a955d=-parseInt(_0x4bd519(0x18e))/0x1*(parseInt(_0x4bd519(0x194))/0x2)+parseInt(_0x4bd519(0x157))/0x3*(-parseInt(_0x4bd519(0x1a8))/0x4)+parseInt(_0x4bd519(0x15a))/0x5+parseInt(_0x4bd519(0x199))/0x6*(parseInt(_0x4bd519(0x1ab))/0x7)+parseInt(_0x4bd519(0x15c))/0x8*(parseInt(_0x4bd519(0x162))/0x9)+-parseInt(_0x4bd519(0x155))/0xa+-parseInt(_0x4bd519(0x17b))/0xb*(-parseInt(_0x4bd519(0x1a5))/0xc);if(_0x3a955d===_0x48fc2d)break;else _0x2166fb['push'](_0x2166fb['shift']());}catch(_0x5e0bf4){_0x2166fb['push'](_0x2166fb['shift']());}}}(a348_0x4a96,0xd652f));const a348_0x200494=(function(){let _0x5c3dd7=!![];return function(_0x4d671c,_0x1e65db){const _0x315321=_0x5c3dd7?function(){const _0x1e6da9=a348_0x4a3c;if(_0x1e65db){const _0x118ab9=_0x1e65db[_0x1e6da9(0x14a)](_0x4d671c,arguments);return _0x1e65db=null,_0x118ab9;}}:function(){};return _0x5c3dd7=![],_0x315321;};}()),a348_0x92a45a=a348_0x200494(this,function(){const _0x2f277c=a348_0x4a3c;return a348_0x92a45a['toString']()['search'](_0x2f277c(0x166))['toString']()['constructor'](a348_0x92a45a)['search'](_0x2f277c(0x166));});a348_0x92a45a();'use strict';var __importDefault=this&&this[a348_0x351be7(0x153)]||function(_0x2eadc0){const _0x322fbd=a348_0x351be7;return _0x2eadc0&&_0x2eadc0[_0x322fbd(0x19e)]?_0x2eadc0:{'default':_0x2eadc0};};Object[a348_0x351be7(0x16a)](exports,a348_0x351be7(0x19e),{'value':!![]}),exports[a348_0x351be7(0x185)]=void 0x0;const minimist_1=__importDefault(require(a348_0x351be7(0x17c))),core_1=require(a348_0x351be7(0x1a2)),salesforce_1=require(a348_0x351be7(0x161)),auth_manager_1=require(a348_0x351be7(0x169)),logger_1=require(a348_0x351be7(0x1a6)),promises_1=require(a348_0x351be7(0x150)),promises_2=require(a348_0x351be7(0x192)),path_1=__importDefault(require(a348_0x351be7(0x17a))),metadata_retriever_1=require(a348_0x351be7(0x15d)),components_deployer_1=require(a348_0x351be7(0x173)),source_member_retriever_1=require('./classes/source-member.retriever'),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require('./classes/metadata-logger'),job_1=require(a348_0x351be7(0x15f)),constants_1=require(a348_0x351be7(0x156)),constants_2=require(a348_0x351be7(0x1a4)),{jobId,jobStorePath}=(0x0,minimist_1[a348_0x351be7(0x176)])(process[a348_0x351be7(0x184)][a348_0x351be7(0x18a)](0x2)),systemLogger=new core_1[(a348_0x351be7(0x195))](jobId);function a348_0x4a96(){const _0x489470=['2777316NPYYcs','./classes/logger/logger','getSourceMemberRetriever','2752zdTRwf','startDate','join','10500jlyZgZ','parse','catch','FLOSUM_NAMESPACE','apply','lastRetrieveDate','create','metadataLogger','metadataLogId','apiVersion','stream/promises','targetInstance','status','__importDefault','pipeline','13590130cKKHVy','../../../constants','411HwAUiO','isProcessed','MetadataRetriever','2552335Hpfzvr','MetadataLogger','48344qLkCIV','./classes/metadata.retriever','LogStatus','../../../constants/job','execute','@flosum/salesforce','1647eBgOOS','utf-8','AxiosInstanceUtils','metadataTypes','(((.+)+)+)+$','init','targetOrgCredentials','../../shared/managers/auth.manager','defineProperty','SourceMemberHandler','Tracking\x20components\x20job\x20has\x20been\x20failed','Last_Start_Retrieval__c','createTrackingSettingRecord','initManifest','updateTrackingSetting','jobId','then','./classes/components.deployer','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','EXCEPTION','default','MANIFEST_FILENAME','flosumOrgCredentials','log','path','22jtDyGC','minimist','RestSimpleDeployData','jobStorePath','ComponentsDeployer','update','initMetadataLogger','getMetadataRetriever','trackingSettingId','argv','Job','exit','getTime','COMPLETED','readFile','slice','error','initInstances','Tracking\x20setting\x20updated','22kHvFFf','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','message','Job\x20Error:\x20','fs/promises','timeZone','14462NeAIYX','Logger','SourceMemberRetriever','logger','flosumInstance','1644JWHpDY','Tracking\x20components\x20job\x20has\x20been\x20completed','Tracking_Setting__c','success','initLogger','__esModule','targetOrgId','getSourceMemberHandler','Is_Processed__c','../../../core','AuthManager','../constants'];a348_0x4a96=function(){return _0x489470;};return a348_0x4a96();}class Job{constructor(){const _0x59b8bb=a348_0x351be7;this[_0x59b8bb(0x17e)]=jobStorePath,this[_0x59b8bb(0x171)]=jobId;}async['initManifest'](){const _0x4593e3=a348_0x351be7,_0x2677ca=path_1['default'][_0x4593e3(0x1aa)](this['jobStorePath'],job_1[_0x4593e3(0x177)]),_0x3da508=await(0x0,promises_2[_0x4593e3(0x189)])(_0x2677ca,{'encoding':_0x4593e3(0x163)})[_0x4593e3(0x172)](JSON[_0x4593e3(0x1ac)])[_0x4593e3(0x172)](({details:_0x9869ae})=>_0x9869ae);await(0x0,promises_2['rm'])(_0x2677ca,{'recursive':!![],'force':!![]}),this[_0x4593e3(0x14f)]=_0x3da508[_0x4593e3(0x14f)],this[_0x4593e3(0x178)]=_0x3da508[_0x4593e3(0x178)],this[_0x4593e3(0x168)]=_0x3da508[_0x4593e3(0x168)],this[_0x4593e3(0x19f)]=_0x3da508[_0x4593e3(0x19f)],this[_0x4593e3(0x183)]=_0x3da508[_0x4593e3(0x183)],this[_0x4593e3(0x14b)]=_0x3da508['lastRetrieveDate'],this[_0x4593e3(0x165)]=_0x3da508['metadataTypes'],this[_0x4593e3(0x193)]=_0x3da508[_0x4593e3(0x193)];}async[a348_0x351be7(0x18c)](){const _0xde71af=a348_0x351be7;this['flosumInstance']=await salesforce_1[_0xde71af(0x164)][_0xde71af(0x14c)](new auth_manager_1['AuthManager'](this[_0xde71af(0x178)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0xde71af(0x151)]=await salesforce_1['AxiosInstanceUtils'][_0xde71af(0x14c)](new auth_manager_1[(_0xde71af(0x1a3))](this[_0xde71af(0x168)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a348_0x351be7(0x181)](){const _0x5d7954=a348_0x351be7;this[_0x5d7954(0x14d)]=new metadata_logger_1[(_0x5d7954(0x15b))]({'apiVersion':this['apiVersion'],'instance':this[_0x5d7954(0x198)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x5d7954(0x183)],'startDate':this[_0x5d7954(0x1a9)]}),this[_0x5d7954(0x14e)]=await this['metadataLogger'][_0x5d7954(0x167)]();}[a348_0x351be7(0x19d)](){const _0x5cf8d6=a348_0x351be7;this[_0x5cf8d6(0x197)]=new logger_1[(_0x5cf8d6(0x195))]({'systemLogger':systemLogger,'apiVersion':this[_0x5cf8d6(0x14f)],'instance':this[_0x5cf8d6(0x198)],'metadataLogId':this['metadataLogId'],'timeZone':this[_0x5cf8d6(0x193)]});}[a348_0x351be7(0x1a7)](){const _0x248606=a348_0x351be7;return new source_member_retriever_1[(_0x248606(0x196))]({'apiVersion':this[_0x248606(0x14f)],'instance':this['targetInstance'],'logger':this[_0x248606(0x197)],'lastRetrieveDate':this[_0x248606(0x14b)],'currentRetrieveDate':this[_0x248606(0x1a9)],'metadataTypes':this[_0x248606(0x165)]});}[a348_0x351be7(0x1a0)](){const _0x5c89a4=a348_0x351be7;return new source_member_handler_1[(_0x5c89a4(0x16b))]({'instance':this['flosumInstance'],'apiVersion':this[_0x5c89a4(0x14f)],'logger':this['logger'],'targetOrgId':this[_0x5c89a4(0x19f)]});}[a348_0x351be7(0x182)](){const _0x55533c=a348_0x351be7;return new metadata_retriever_1[(_0x55533c(0x159))]({'instance':this[_0x55533c(0x151)],'apiVersion':this[_0x55533c(0x14f)],'logger':this['logger'],'metadataTypes':this[_0x55533c(0x165)]});}['getComponentsDeployer'](){const _0x4213c5=a348_0x351be7;return new components_deployer_1[(_0x4213c5(0x17f))]({'instance':this[_0x4213c5(0x198)],'logger':this[_0x4213c5(0x197)],'apiVersion':this[_0x4213c5(0x14f)],'targetOrgId':this[_0x4213c5(0x19f)],'trackingSettingId':this[_0x4213c5(0x183)]});}['createTrackingSettingRecord'](){const _0x3f792c=a348_0x351be7;return{'attributes':{'type':constants_1['FLOSUM_NAMESPACE']+_0x3f792c(0x19b)},'Id':this[_0x3f792c(0x183)],[constants_1[_0x3f792c(0x149)]+_0x3f792c(0x1a1)]:this[_0x3f792c(0x158)],[constants_1[_0x3f792c(0x149)]+_0x3f792c(0x16d)]:this['startDate']};}async[a348_0x351be7(0x170)](){const _0x472081=a348_0x351be7,_0x5f4bd4=this[_0x472081(0x16e)](),_0xa99b38=new salesforce_1[(_0x472081(0x17d))]({'instance':this[_0x472081(0x198)],'objectName':constants_1['FLOSUM_NAMESPACE']+'Tracking_Setting__c','api':this[_0x472081(0x14f)],'allOrNone':![],'externalIdField':'Id'}),_0x4bab97=await _0xa99b38[_0x472081(0x160)]({'records':[_0x5f4bd4]}),_0x4d508f=_0x4bab97['at'](0x0);(_0x4d508f===null||_0x4d508f===void 0x0?void 0x0:_0x4d508f[_0x472081(0x19c)])?this[_0x472081(0x197)]['log'](_0x472081(0x18d)):this[_0x472081(0x197)][_0x472081(0x179)](_0x472081(0x174)+(_0x4d508f===null||_0x4d508f===void 0x0?void 0x0:_0x4d508f[_0x472081(0x18b)]));}async['execute'](){const _0x305751=a348_0x351be7;await this[_0x305751(0x16f)](),this[_0x305751(0x1a9)]=new Date()[_0x305751(0x187)]();try{await this[_0x305751(0x18c)](),await this[_0x305751(0x181)](),this[_0x305751(0x19d)](),this['logger'][_0x305751(0x179)](_0x305751(0x18f)+this[_0x305751(0x171)]),this[_0x305751(0x14d)][_0x305751(0x152)]=constants_2[_0x305751(0x15e)]['IN_PROGRESS'],this[_0x305751(0x158)]=!![],await this[_0x305751(0x170)](),await this[_0x305751(0x14d)][_0x305751(0x180)](),await this[_0x305751(0x197)][_0x305751(0x180)]();const _0x12cf3f=this[_0x305751(0x1a7)](),_0x1bf5de=this[_0x305751(0x1a0)](),_0x3e3c6a=this[_0x305751(0x182)](),_0x2951d2=this['getComponentsDeployer']();await(0x0,promises_1[_0x305751(0x154)])(_0x12cf3f,_0x1bf5de,_0x3e3c6a,_0x2951d2),this[_0x305751(0x197)][_0x305751(0x179)](_0x305751(0x19a)),this[_0x305751(0x14d)][_0x305751(0x152)]=constants_2[_0x305751(0x15e)][_0x305751(0x188)];}catch(_0x4d7c17){this['logger'][_0x305751(0x18b)](_0x305751(0x16c)),this[_0x305751(0x197)][_0x305751(0x18b)](_0x4d7c17[_0x305751(0x190)]),this[_0x305751(0x14d)]['status']=constants_2['LogStatus'][_0x305751(0x175)];}finally{this[_0x305751(0x158)]=![],await this[_0x305751(0x170)](),await this[_0x305751(0x197)][_0x305751(0x180)](),await this[_0x305751(0x14d)][_0x305751(0x180)]();}}}exports['Job']=Job,new Job()['execute']()['then'](()=>process[a348_0x351be7(0x186)](0x0))[a348_0x351be7(0x148)](_0x1b8479=>{const _0x532660=a348_0x351be7;systemLogger[_0x532660(0x18b)](_0x532660(0x191)+_0x1b8479[_0x532660(0x190)]),process['exit'](0x1);});