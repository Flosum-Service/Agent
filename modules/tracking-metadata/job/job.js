const a335_0x4fe70e=a335_0xfb64;(function(_0x29988e,_0x56bb76){const _0x1fff39=a335_0xfb64,_0x30d5d5=_0x29988e();while(!![]){try{const _0x3dc146=parseInt(_0x1fff39(0xa9))/0x1+parseInt(_0x1fff39(0xc7))/0x2+parseInt(_0x1fff39(0xb5))/0x3*(parseInt(_0x1fff39(0xe8))/0x4)+-parseInt(_0x1fff39(0xda))/0x5*(parseInt(_0x1fff39(0x99))/0x6)+parseInt(_0x1fff39(0xe0))/0x7*(-parseInt(_0x1fff39(0x92))/0x8)+parseInt(_0x1fff39(0xdf))/0x9+-parseInt(_0x1fff39(0x94))/0xa;if(_0x3dc146===_0x56bb76)break;else _0x30d5d5['push'](_0x30d5d5['shift']());}catch(_0x43efe1){_0x30d5d5['push'](_0x30d5d5['shift']());}}}(a335_0x1515,0x90540));const a335_0x985e61=(function(){let _0x5915b5=!![];return function(_0x5becd8,_0x38cac1){const _0x2f83e6=_0x5915b5?function(){const _0x298829=a335_0xfb64;if(_0x38cac1){const _0x142dde=_0x38cac1[_0x298829(0xc4)](_0x5becd8,arguments);return _0x38cac1=null,_0x142dde;}}:function(){};return _0x5915b5=![],_0x2f83e6;};}()),a335_0x24ecf6=a335_0x985e61(this,function(){const _0x5cb985=a335_0xfb64;return a335_0x24ecf6[_0x5cb985(0xa0)]()[_0x5cb985(0xae)](_0x5cb985(0x9a))['toString']()[_0x5cb985(0xb4)](a335_0x24ecf6)[_0x5cb985(0xae)](_0x5cb985(0x9a));});a335_0x24ecf6();'use strict';var __importDefault=this&&this['__importDefault']||function(_0xb18148){const _0x222b65=a335_0xfb64;return _0xb18148&&_0xb18148[_0x222b65(0xb9)]?_0xb18148:{'default':_0xb18148};};function a335_0x1515(){const _0xacf0fb=['Logger','constructor','100941LawMqc','argv','execute','trackingSettingId','__esModule','catch','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','join','../constants','LogStatus','metadataLogger','initLogger','targetOrgId','initManifest','AuthManager','apply','MetadataRetriever','./classes/components.deployer','1191010gCtwiX','Tracking_Setting__c','lastRetrieveDate','Job\x20Error:\x20','error','../../../core','status','MetadataLogger','exit','metadataLogId','jobId','metadataTypes','Job','./classes/logger/logger','Is_Processed__c','COMPLETED','AxiosInstanceUtils','targetOrgCredentials','getComponentsDeployer','290jmLBft','fs/promises','default','initInstances','update','6762870tmreCi','41293HATAQC','getTime','@flosum/salesforce','getSourceMemberHandler','../../../constants','SourceMemberHandler','message','./classes/source-member.retriever','4LnMBmC','SourceMemberRetriever','getMetadataRetriever','RestSimpleDeployData','flosumInstance','createTrackingSettingRecord','24Jhndtv','apiVersion','3066820udTQaN','utf-8','Tracking\x20setting\x20updated','then','initMetadataLogger','76686jLhNWZ','(((.+)+)+)+$','timeZone','MANIFEST_FILENAME','Tracking\x20components\x20job\x20has\x20been\x20completed','log','FLOSUM_NAMESPACE','toString','create','Tracking\x20components\x20job\x20has\x20been\x20failed','Last_Start_Retrieval__c','IN_PROGRESS','startDate','targetInstance','readFile','./classes/source-member.handler','276263eJSZNX','./classes/metadata-logger','flosumOrgCredentials','stream/promises','jobStorePath','search','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','logger','defineProperty','minimist'];a335_0x1515=function(){return _0xacf0fb;};return a335_0x1515();}function a335_0xfb64(_0x1b48fe,_0x15e093){const _0x394463=a335_0x1515();return a335_0xfb64=function(_0x24ecf6,_0x985e61){_0x24ecf6=_0x24ecf6-0x8d;let _0x15157a=_0x394463[_0x24ecf6];return _0x15157a;},a335_0xfb64(_0x1b48fe,_0x15e093);}Object[a335_0x4fe70e(0xb1)](exports,'__esModule',{'value':!![]}),exports['Job']=void 0x0;const minimist_1=__importDefault(require(a335_0x4fe70e(0xb2))),core_1=require(a335_0x4fe70e(0xcc)),salesforce_1=require(a335_0x4fe70e(0xe2)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a335_0x4fe70e(0xd4)),promises_1=require(a335_0x4fe70e(0xac)),promises_2=require(a335_0x4fe70e(0xdb)),path_1=__importDefault(require('path')),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a335_0x4fe70e(0xc6)),source_member_retriever_1=require(a335_0x4fe70e(0xe7)),source_member_handler_1=require(a335_0x4fe70e(0xa8)),metadata_logger_1=require(a335_0x4fe70e(0xaa)),job_1=require('../../../constants/job'),constants_1=require(a335_0x4fe70e(0xe4)),constants_2=require(a335_0x4fe70e(0xbd)),{jobId,jobStorePath}=(0x0,minimist_1[a335_0x4fe70e(0xdc)])(process[a335_0x4fe70e(0xb6)]['slice'](0x2)),systemLogger=new core_1[(a335_0x4fe70e(0xb3))](jobId);class Job{constructor(){const _0x37aab2=a335_0x4fe70e;this[_0x37aab2(0xad)]=jobStorePath,this[_0x37aab2(0xd1)]=jobId;}async[a335_0x4fe70e(0xc2)](){const _0x4ca006=a335_0x4fe70e,_0x3bb7cb=path_1[_0x4ca006(0xdc)][_0x4ca006(0xbc)](this[_0x4ca006(0xad)],job_1[_0x4ca006(0x9c)]),_0x5ef74a=await(0x0,promises_2[_0x4ca006(0xa7)])(_0x3bb7cb,{'encoding':_0x4ca006(0x95)})[_0x4ca006(0x97)](JSON['parse'])[_0x4ca006(0x97)](({details:_0xee479f})=>_0xee479f);await(0x0,promises_2['rm'])(_0x3bb7cb,{'recursive':!![],'force':!![]}),this[_0x4ca006(0x93)]=_0x5ef74a['apiVersion'],this[_0x4ca006(0xab)]=_0x5ef74a['flosumOrgCredentials'],this['targetOrgCredentials']=_0x5ef74a[_0x4ca006(0xd8)],this[_0x4ca006(0xc1)]=_0x5ef74a['targetOrgId'],this['trackingSettingId']=_0x5ef74a[_0x4ca006(0xb8)],this[_0x4ca006(0xc9)]=_0x5ef74a['lastRetrieveDate'],this[_0x4ca006(0xd2)]=_0x5ef74a[_0x4ca006(0xd2)],this['timeZone']=_0x5ef74a['timeZone'];}async[a335_0x4fe70e(0xdd)](){const _0x485e10=a335_0x4fe70e;this[_0x485e10(0x90)]=await salesforce_1['AxiosInstanceUtils'][_0x485e10(0xa1)](new auth_manager_1[(_0x485e10(0xc3))](this[_0x485e10(0xab)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this['targetInstance']=await salesforce_1[_0x485e10(0xd7)][_0x485e10(0xa1)](new auth_manager_1['AuthManager'](this[_0x485e10(0xd8)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a335_0x4fe70e(0x98)](){const _0x1e7c8d=a335_0x4fe70e;this['metadataLogger']=new metadata_logger_1[(_0x1e7c8d(0xce))]({'apiVersion':this['apiVersion'],'instance':this[_0x1e7c8d(0x90)],'targetOrgId':this[_0x1e7c8d(0xc1)],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0x1e7c8d(0xa5)]}),this['metadataLogId']=await this[_0x1e7c8d(0xbf)]['init']();}[a335_0x4fe70e(0xc0)](){const _0x1911d3=a335_0x4fe70e;this[_0x1911d3(0xb0)]=new logger_1['Logger']({'systemLogger':systemLogger,'apiVersion':this[_0x1911d3(0x93)],'instance':this[_0x1911d3(0x90)],'metadataLogId':this[_0x1911d3(0xd0)],'timeZone':this[_0x1911d3(0x9b)]});}['getSourceMemberRetriever'](){const _0xfeef19=a335_0x4fe70e;return new source_member_retriever_1[(_0xfeef19(0x8d))]({'apiVersion':this[_0xfeef19(0x93)],'instance':this[_0xfeef19(0xa6)],'logger':this[_0xfeef19(0xb0)],'lastRetrieveDate':this[_0xfeef19(0xc9)],'currentRetrieveDate':this[_0xfeef19(0xa5)],'metadataTypes':this[_0xfeef19(0xd2)]});}['getSourceMemberHandler'](){const _0x3146de=a335_0x4fe70e;return new source_member_handler_1[(_0x3146de(0xe5))]({'instance':this[_0x3146de(0x90)],'apiVersion':this[_0x3146de(0x93)],'logger':this[_0x3146de(0xb0)],'targetOrgId':this[_0x3146de(0xc1)]});}['getMetadataRetriever'](){const _0x58cf98=a335_0x4fe70e;return new metadata_retriever_1[(_0x58cf98(0xc5))]({'instance':this['targetInstance'],'apiVersion':this['apiVersion'],'logger':this['logger'],'metadataTypes':this[_0x58cf98(0xd2)]});}['getComponentsDeployer'](){const _0x3a51c5=a335_0x4fe70e;return new components_deployer_1['ComponentsDeployer']({'instance':this['flosumInstance'],'logger':this[_0x3a51c5(0xb0)],'apiVersion':this[_0x3a51c5(0x93)],'targetOrgId':this[_0x3a51c5(0xc1)],'trackingSettingId':this[_0x3a51c5(0xb8)]});}[a335_0x4fe70e(0x91)](){const _0x28609f=a335_0x4fe70e;return{'attributes':{'type':constants_1[_0x28609f(0x9f)]+_0x28609f(0xc8)},'Id':this['trackingSettingId'],[constants_1[_0x28609f(0x9f)]+_0x28609f(0xd5)]:![],[constants_1['FLOSUM_NAMESPACE']+_0x28609f(0xa3)]:this[_0x28609f(0xa5)]};}async['updateTrackingSetting'](){const _0xbf247=a335_0x4fe70e,_0x4fbb99=this[_0xbf247(0x91)](),_0x53d976=new salesforce_1[(_0xbf247(0x8f))]({'instance':this['flosumInstance'],'objectName':constants_1[_0xbf247(0x9f)]+_0xbf247(0xc8),'api':this[_0xbf247(0x93)],'allOrNone':![],'externalIdField':'Id'}),_0x3e878b=await _0x53d976[_0xbf247(0xb7)]({'records':[_0x4fbb99]}),_0x55f6db=_0x3e878b['at'](0x0);(_0x55f6db===null||_0x55f6db===void 0x0?void 0x0:_0x55f6db['success'])?this[_0xbf247(0xb0)][_0xbf247(0x9e)](_0xbf247(0x96)):this[_0xbf247(0xb0)][_0xbf247(0x9e)](_0xbf247(0xbb)+(_0x55f6db===null||_0x55f6db===void 0x0?void 0x0:_0x55f6db['error']));}async['execute'](){const _0x5eac22=a335_0x4fe70e;await this[_0x5eac22(0xc2)](),this[_0x5eac22(0xa5)]=new Date()[_0x5eac22(0xe1)]();try{await this[_0x5eac22(0xdd)](),await this[_0x5eac22(0x98)](),this[_0x5eac22(0xc0)](),this['logger']['log'](_0x5eac22(0xaf)+this[_0x5eac22(0xd1)]),this[_0x5eac22(0xbf)]['status']=constants_2[_0x5eac22(0xbe)][_0x5eac22(0xa4)],await this[_0x5eac22(0xbf)][_0x5eac22(0xde)](),await this[_0x5eac22(0xb0)][_0x5eac22(0xde)]();const _0x3310f7=this['getSourceMemberRetriever'](),_0x10e82b=this[_0x5eac22(0xe3)](),_0x26878b=this[_0x5eac22(0x8e)](),_0x3eef9c=this[_0x5eac22(0xd9)]();await(0x0,promises_1['pipeline'])(_0x3310f7,_0x10e82b,_0x26878b,_0x3eef9c),this[_0x5eac22(0xb0)][_0x5eac22(0x9e)](_0x5eac22(0x9d)),this[_0x5eac22(0xbf)][_0x5eac22(0xcd)]=constants_2['LogStatus'][_0x5eac22(0xd6)];}catch(_0x40182a){this[_0x5eac22(0xb0)]['error'](_0x5eac22(0xa2)),this[_0x5eac22(0xb0)]['error'](_0x40182a[_0x5eac22(0xe6)]),this[_0x5eac22(0xbf)]['status']=constants_2[_0x5eac22(0xbe)]['EXCEPTION'];}finally{await this['updateTrackingSetting'](),await this[_0x5eac22(0xb0)][_0x5eac22(0xde)](),await this[_0x5eac22(0xbf)][_0x5eac22(0xde)]();}}}exports[a335_0x4fe70e(0xd3)]=Job,new Job()['execute']()[a335_0x4fe70e(0x97)](()=>process['exit'](0x0))[a335_0x4fe70e(0xba)](_0x10756d=>{const _0x4284a0=a335_0x4fe70e;systemLogger[_0x4284a0(0xcb)](_0x4284a0(0xca)+_0x10756d[_0x4284a0(0xe6)]),process[_0x4284a0(0xcf)](0x1);});