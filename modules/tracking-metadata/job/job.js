const a348_0xefd9a9=a348_0x260f;(function(_0x55dadd,_0x5828b7){const _0x2895d6=a348_0x260f,_0x4740bc=_0x55dadd();while(!![]){try{const _0x1748fa=parseInt(_0x2895d6(0xd6))/0x1+parseInt(_0x2895d6(0x11b))/0x2*(-parseInt(_0x2895d6(0x11e))/0x3)+-parseInt(_0x2895d6(0x114))/0x4+-parseInt(_0x2895d6(0xec))/0x5*(parseInt(_0x2895d6(0xd9))/0x6)+parseInt(_0x2895d6(0x131))/0x7*(parseInt(_0x2895d6(0x103))/0x8)+parseInt(_0x2895d6(0x100))/0x9+-parseInt(_0x2895d6(0x11c))/0xa*(-parseInt(_0x2895d6(0x122))/0xb);if(_0x1748fa===_0x5828b7)break;else _0x4740bc['push'](_0x4740bc['shift']());}catch(_0x56432b){_0x4740bc['push'](_0x4740bc['shift']());}}}(a348_0x517d,0x9f954));const a348_0x390444=(function(){let _0x2910eb=!![];return function(_0x4f3d33,_0x14f5f5){const _0x557263=_0x2910eb?function(){const _0xab8966=a348_0x260f;if(_0x14f5f5){const _0x15ef7c=_0x14f5f5[_0xab8966(0xf7)](_0x4f3d33,arguments);return _0x14f5f5=null,_0x15ef7c;}}:function(){};return _0x2910eb=![],_0x557263;};}()),a348_0x7054e=a348_0x390444(this,function(){const _0x20bead=a348_0x260f;return a348_0x7054e[_0x20bead(0x126)]()[_0x20bead(0xf5)](_0x20bead(0x102))[_0x20bead(0x126)]()[_0x20bead(0xd7)](a348_0x7054e)[_0x20bead(0xf5)](_0x20bead(0x102));});a348_0x7054e();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1913f8){const _0x5451a2=a348_0x260f;return _0x1913f8&&_0x1913f8[_0x5451a2(0x111)]?_0x1913f8:{'default':_0x1913f8};};function a348_0x260f(_0xf295f6,_0x102df6){const _0x2fcf67=a348_0x517d();return a348_0x260f=function(_0x7054e,_0x390444){_0x7054e=_0x7054e-0xd4;let _0x517dfc=_0x2fcf67[_0x7054e];return _0x517dfc;},a348_0x260f(_0xf295f6,_0x102df6);}Object[a348_0xefd9a9(0x105)](exports,a348_0xefd9a9(0x111),{'value':!![]}),exports['Job']=void 0x0;function a348_0x517d(){const _0x5899a9=['2459992TXbjnr','trackingSettingId','defineProperty','./classes/source-member.handler','pipeline','./classes/source-member.retriever','targetOrgCredentials','message','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','ComponentsDeployer','metadataLogger','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','create','../../../core','__esModule','logger','../constants','4656660DiEMaJ','flosumInstance','join','timeZone','default','COMPLETED','jobStorePath','12854hEFAkh','61920dwaXvy','getSourceMemberHandler','339BFeHjl','flosumOrgCredentials','minimist','getSourceMemberRetriever','110NGUZvx','AxiosInstanceUtils','success','Job\x20Error:\x20','toString','stream/promises','IN_PROGRESS','../../shared/managers/auth.manager','initInstances','updateTrackingSetting','./classes/components.deployer','EXCEPTION','Tracking\x20components\x20job\x20has\x20been\x20completed','init','getMetadataRetriever','7xmblAq','./classes/metadata-logger','Is_Processed__c','Logger','apiVersion','MANIFEST_FILENAME','targetInstance','@flosum/salesforce','1306768FkwWVk','constructor','lastRetrieveDate','406542vecQIC','metadataTypes','status','jobId','initLogger','update','metadataLogId','RestSimpleDeployData','targetOrgId','LogStatus','Tracking_Setting__c','AuthManager','../../../constants/job','FLOSUM_NAMESPACE','./classes/metadata.retriever','getComponentsDeployer','slice','createTrackingSettingRecord','isProcessed','30MzRyUa','execute','argv','startDate','Tracking\x20setting\x20updated','log','exit','utf-8','catch','search','parse','apply','initMetadataLogger','initManifest','error','SourceMemberHandler','../../../constants','Tracking\x20components\x20job\x20has\x20been\x20failed','Last_Start_Retrieval__c','then','11469807HVDBgl','readFile','(((.+)+)+)+$'];a348_0x517d=function(){return _0x5899a9;};return a348_0x517d();}const minimist_1=__importDefault(require(a348_0xefd9a9(0x120))),core_1=require(a348_0xefd9a9(0x110)),salesforce_1=require(a348_0xefd9a9(0xd5)),auth_manager_1=require(a348_0xefd9a9(0x129)),logger_1=require('./classes/logger/logger'),promises_1=require(a348_0xefd9a9(0x127)),promises_2=require('fs/promises'),path_1=__importDefault(require('path')),metadata_retriever_1=require(a348_0xefd9a9(0xe7)),components_deployer_1=require(a348_0xefd9a9(0x12c)),source_member_retriever_1=require(a348_0xefd9a9(0x108)),source_member_handler_1=require(a348_0xefd9a9(0x106)),metadata_logger_1=require(a348_0xefd9a9(0x132)),job_1=require(a348_0xefd9a9(0xe5)),constants_1=require(a348_0xefd9a9(0xfc)),constants_2=require(a348_0xefd9a9(0x113)),{jobId,jobStorePath}=(0x0,minimist_1[a348_0xefd9a9(0x118)])(process[a348_0xefd9a9(0xee)][a348_0xefd9a9(0xe9)](0x2)),systemLogger=new core_1['Logger'](jobId);class Job{constructor(){const _0xc57c5e=a348_0xefd9a9;this['jobStorePath']=jobStorePath,this[_0xc57c5e(0xdc)]=jobId;}async[a348_0xefd9a9(0xf9)](){const _0x3f76c7=a348_0xefd9a9,_0x1452fe=path_1[_0x3f76c7(0x118)][_0x3f76c7(0x116)](this[_0x3f76c7(0x11a)],job_1[_0x3f76c7(0x136)]),_0x380c3f=await(0x0,promises_2[_0x3f76c7(0x101)])(_0x1452fe,{'encoding':_0x3f76c7(0xf3)})[_0x3f76c7(0xff)](JSON[_0x3f76c7(0xf6)])[_0x3f76c7(0xff)](({details:_0x3a3841})=>_0x3a3841);await(0x0,promises_2['rm'])(_0x1452fe,{'recursive':!![],'force':!![]}),this[_0x3f76c7(0x135)]=_0x380c3f['apiVersion'],this[_0x3f76c7(0x11f)]=_0x380c3f[_0x3f76c7(0x11f)],this[_0x3f76c7(0x109)]=_0x380c3f['targetOrgCredentials'],this['targetOrgId']=_0x380c3f[_0x3f76c7(0xe1)],this[_0x3f76c7(0x104)]=_0x380c3f[_0x3f76c7(0x104)],this[_0x3f76c7(0xd8)]=_0x380c3f['lastRetrieveDate'],this['metadataTypes']=_0x380c3f[_0x3f76c7(0xda)],this[_0x3f76c7(0x117)]=_0x380c3f['timeZone'];}async[a348_0xefd9a9(0x12a)](){const _0x343a52=a348_0xefd9a9;this[_0x343a52(0x115)]=await salesforce_1[_0x343a52(0x123)][_0x343a52(0x10f)](new auth_manager_1[(_0x343a52(0xe4))](this[_0x343a52(0x11f)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x343a52(0xd4)]=await salesforce_1[_0x343a52(0x123)][_0x343a52(0x10f)](new auth_manager_1['AuthManager'](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a348_0xefd9a9(0xf8)](){const _0x2865d9=a348_0xefd9a9;this[_0x2865d9(0x10d)]=new metadata_logger_1['MetadataLogger']({'apiVersion':this['apiVersion'],'instance':this[_0x2865d9(0x115)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0x2865d9(0xef)]}),this[_0x2865d9(0xdf)]=await this[_0x2865d9(0x10d)][_0x2865d9(0x12f)]();}['initLogger'](){const _0x2ad315=a348_0xefd9a9;this[_0x2ad315(0x112)]=new logger_1[(_0x2ad315(0x134))]({'systemLogger':systemLogger,'apiVersion':this[_0x2ad315(0x135)],'instance':this[_0x2ad315(0x115)],'metadataLogId':this[_0x2ad315(0xdf)],'timeZone':this[_0x2ad315(0x117)]});}[a348_0xefd9a9(0x121)](){const _0x51f855=a348_0xefd9a9;return new source_member_retriever_1['SourceMemberRetriever']({'apiVersion':this['apiVersion'],'instance':this[_0x51f855(0xd4)],'logger':this['logger'],'lastRetrieveDate':this[_0x51f855(0xd8)],'currentRetrieveDate':this[_0x51f855(0xef)],'metadataTypes':this[_0x51f855(0xda)]});}[a348_0xefd9a9(0x11d)](){const _0xb3e0bd=a348_0xefd9a9;return new source_member_handler_1[(_0xb3e0bd(0xfb))]({'instance':this[_0xb3e0bd(0x115)],'apiVersion':this[_0xb3e0bd(0x135)],'logger':this[_0xb3e0bd(0x112)],'targetOrgId':this[_0xb3e0bd(0xe1)]});}[a348_0xefd9a9(0x130)](){const _0x22557a=a348_0xefd9a9;return new metadata_retriever_1['MetadataRetriever']({'instance':this[_0x22557a(0xd4)],'apiVersion':this[_0x22557a(0x135)],'logger':this[_0x22557a(0x112)],'metadataTypes':this['metadataTypes']});}[a348_0xefd9a9(0xe8)](){const _0x5d47ca=a348_0xefd9a9;return new components_deployer_1[(_0x5d47ca(0x10c))]({'instance':this[_0x5d47ca(0x115)],'logger':this['logger'],'apiVersion':this[_0x5d47ca(0x135)],'targetOrgId':this[_0x5d47ca(0xe1)],'trackingSettingId':this[_0x5d47ca(0x104)]});}['createTrackingSettingRecord'](){const _0x49f374=a348_0xefd9a9;return{'attributes':{'type':constants_1[_0x49f374(0xe6)]+_0x49f374(0xe3)},'Id':this['trackingSettingId'],[constants_1[_0x49f374(0xe6)]+_0x49f374(0x133)]:this[_0x49f374(0xeb)],[constants_1[_0x49f374(0xe6)]+_0x49f374(0xfe)]:this[_0x49f374(0xef)]};}async[a348_0xefd9a9(0x12b)](){const _0xbc94ad=a348_0xefd9a9,_0x3fab05=this[_0xbc94ad(0xea)](),_0x604fff=new salesforce_1[(_0xbc94ad(0xe0))]({'instance':this[_0xbc94ad(0x115)],'objectName':constants_1[_0xbc94ad(0xe6)]+_0xbc94ad(0xe3),'api':this[_0xbc94ad(0x135)],'allOrNone':![],'externalIdField':'Id'}),_0x331d21=await _0x604fff[_0xbc94ad(0xed)]({'records':[_0x3fab05]}),_0x4fbfa3=_0x331d21['at'](0x0);(_0x4fbfa3===null||_0x4fbfa3===void 0x0?void 0x0:_0x4fbfa3[_0xbc94ad(0x124)])?this['logger'][_0xbc94ad(0xf1)](_0xbc94ad(0xf0)):this[_0xbc94ad(0x112)][_0xbc94ad(0xf1)](_0xbc94ad(0x10e)+(_0x4fbfa3===null||_0x4fbfa3===void 0x0?void 0x0:_0x4fbfa3[_0xbc94ad(0xfa)]));}async[a348_0xefd9a9(0xed)](){const _0x4b477b=a348_0xefd9a9;await this[_0x4b477b(0xf9)](),this['startDate']=new Date()['getTime']();try{await this['initInstances'](),await this['initMetadataLogger'](),this[_0x4b477b(0xdd)](),this[_0x4b477b(0x112)][_0x4b477b(0xf1)](_0x4b477b(0x10b)+this[_0x4b477b(0xdc)]),this[_0x4b477b(0x10d)][_0x4b477b(0xdb)]=constants_2[_0x4b477b(0xe2)][_0x4b477b(0x128)],this[_0x4b477b(0xeb)]=!![],await this['updateTrackingSetting'](),await this[_0x4b477b(0x10d)][_0x4b477b(0xde)](),await this[_0x4b477b(0x112)]['update']();const _0x4b3217=this[_0x4b477b(0x121)](),_0x546f65=this['getSourceMemberHandler'](),_0x4c5f96=this[_0x4b477b(0x130)](),_0x5a9d9d=this[_0x4b477b(0xe8)]();await(0x0,promises_1[_0x4b477b(0x107)])(_0x4b3217,_0x546f65,_0x4c5f96,_0x5a9d9d),this[_0x4b477b(0x112)][_0x4b477b(0xf1)](_0x4b477b(0x12e)),this[_0x4b477b(0x10d)][_0x4b477b(0xdb)]=constants_2[_0x4b477b(0xe2)][_0x4b477b(0x119)];}catch(_0x2a0420){this[_0x4b477b(0x112)][_0x4b477b(0xfa)](_0x4b477b(0xfd)),this[_0x4b477b(0x112)]['error'](_0x2a0420[_0x4b477b(0x10a)]),this[_0x4b477b(0x10d)][_0x4b477b(0xdb)]=constants_2[_0x4b477b(0xe2)][_0x4b477b(0x12d)];}finally{this[_0x4b477b(0xeb)]=![],await this['updateTrackingSetting'](),await this[_0x4b477b(0x112)]['update'](),await this[_0x4b477b(0x10d)][_0x4b477b(0xde)]();}}}exports['Job']=Job,new Job()[a348_0xefd9a9(0xed)]()[a348_0xefd9a9(0xff)](()=>process[a348_0xefd9a9(0xf2)](0x0))[a348_0xefd9a9(0xf4)](_0xab5edb=>{const _0x2beec5=a348_0xefd9a9;systemLogger[_0x2beec5(0xfa)](_0x2beec5(0x125)+_0xab5edb[_0x2beec5(0x10a)]),process[_0x2beec5(0xf2)](0x1);});