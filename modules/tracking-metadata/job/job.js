const a347_0x2ab689=a347_0x40a5;(function(_0x426ff7,_0x20a1e4){const _0x28c165=a347_0x40a5,_0x16f38b=_0x426ff7();while(!![]){try{const _0x2f8c06=parseInt(_0x28c165(0x129))/0x1*(-parseInt(_0x28c165(0x143))/0x2)+-parseInt(_0x28c165(0x172))/0x3+-parseInt(_0x28c165(0x142))/0x4*(-parseInt(_0x28c165(0x157))/0x5)+parseInt(_0x28c165(0x147))/0x6+parseInt(_0x28c165(0x13a))/0x7+parseInt(_0x28c165(0x132))/0x8+parseInt(_0x28c165(0x12e))/0x9;if(_0x2f8c06===_0x20a1e4)break;else _0x16f38b['push'](_0x16f38b['shift']());}catch(_0x70419b){_0x16f38b['push'](_0x16f38b['shift']());}}}(a347_0x4bea,0xbab46));const a347_0x3d8177=(function(){let _0x4b5894=!![];return function(_0x239d9b,_0x31e0ed){const _0x422ca5=_0x4b5894?function(){const _0x3b960e=a347_0x40a5;if(_0x31e0ed){const _0x23adeb=_0x31e0ed[_0x3b960e(0x13e)](_0x239d9b,arguments);return _0x31e0ed=null,_0x23adeb;}}:function(){};return _0x4b5894=![],_0x422ca5;};}()),a347_0x12383e=a347_0x3d8177(this,function(){const _0x147ad4=a347_0x40a5;return a347_0x12383e[_0x147ad4(0x150)]()['search'](_0x147ad4(0x13b))[_0x147ad4(0x150)]()[_0x147ad4(0x126)](a347_0x12383e)[_0x147ad4(0x12b)](_0x147ad4(0x13b));});function a347_0x4bea(){const _0x223677=['timeZone','error','constructor','../constants','AuthManager','1jJzMAn','targetOrgId','search','getMetadataRetriever','RestSimpleDeployData','962712xcVOIe','getTime','initLogger','Logger','2064432PHTtlL','initInstances','create','./classes/metadata-logger','Job\x20Error:\x20','startDate','../../../constants','trackingSettingId','5187644DfFzFZ','(((.+)+)+)+$','updateTrackingSetting','Job','apply','Tracking_Setting__c','MetadataRetriever','Tracking\x20components\x20job\x20has\x20been\x20failed','244dGkbqh','2459214zWYniH','__esModule','fs/promises','__importDefault','5716014bQxdxE','../../../core','catch','getSourceMemberHandler','jobId','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','update','./classes/source-member.handler','targetOrgCredentials','toString','MetadataLogger','metadataLogger','initManifest','flosumInstance','Is_Processed__c','Tracking\x20components\x20job\x20has\x20been\x20completed','64405JZgULE','targetInstance','message','Tracking\x20setting\x20updated','initMetadataLogger','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','defineProperty','flosumOrgCredentials','IN_PROGRESS','getComponentsDeployer','argv','jobStorePath','pipeline','ComponentsDeployer','status','FLOSUM_NAMESPACE','join','../../../constants/job','path','slice','log','metadataLogId','createTrackingSettingRecord','apiVersion','metadataTypes','./classes/logger/logger','@flosum/salesforce','2550525dhJskW','Last_Start_Retrieval__c','default','LogStatus','logger','exit','./classes/components.deployer','readFile','COMPLETED','lastRetrieveDate','utf-8','success','../../shared/managers/auth.manager','AxiosInstanceUtils','execute','SourceMemberHandler','then','getSourceMemberRetriever','./classes/metadata.retriever'];a347_0x4bea=function(){return _0x223677;};return a347_0x4bea();}a347_0x12383e();'use strict';var __importDefault=this&&this[a347_0x2ab689(0x146)]||function(_0x14f874){const _0x347d8a=a347_0x2ab689;return _0x14f874&&_0x14f874[_0x347d8a(0x144)]?_0x14f874:{'default':_0x14f874};};Object[a347_0x2ab689(0x15d)](exports,a347_0x2ab689(0x144),{'value':!![]}),exports[a347_0x2ab689(0x13d)]=void 0x0;function a347_0x40a5(_0x2e4c0e,_0x3e190c){const _0x42c0a1=a347_0x4bea();return a347_0x40a5=function(_0x12383e,_0x3d8177){_0x12383e=_0x12383e-0x119;let _0x4beaf7=_0x42c0a1[_0x12383e];return _0x4beaf7;},a347_0x40a5(_0x2e4c0e,_0x3e190c);}const minimist_1=__importDefault(require('minimist')),core_1=require(a347_0x2ab689(0x148)),salesforce_1=require(a347_0x2ab689(0x171)),auth_manager_1=require(a347_0x2ab689(0x11d)),logger_1=require(a347_0x2ab689(0x170)),promises_1=require('stream/promises'),promises_2=require(a347_0x2ab689(0x145)),path_1=__importDefault(require(a347_0x2ab689(0x169))),metadata_retriever_1=require(a347_0x2ab689(0x123)),components_deployer_1=require(a347_0x2ab689(0x178)),source_member_retriever_1=require('./classes/source-member.retriever'),source_member_handler_1=require(a347_0x2ab689(0x14e)),metadata_logger_1=require(a347_0x2ab689(0x135)),job_1=require(a347_0x2ab689(0x168)),constants_1=require(a347_0x2ab689(0x138)),constants_2=require(a347_0x2ab689(0x127)),{jobId,jobStorePath}=(0x0,minimist_1[a347_0x2ab689(0x174)])(process[a347_0x2ab689(0x161)][a347_0x2ab689(0x16a)](0x2)),systemLogger=new core_1[(a347_0x2ab689(0x131))](jobId);class Job{constructor(){const _0x28941a=a347_0x2ab689;this[_0x28941a(0x162)]=jobStorePath,this[_0x28941a(0x14b)]=jobId;}async[a347_0x2ab689(0x153)](){const _0x547d51=a347_0x2ab689,_0x3ee444=path_1['default'][_0x547d51(0x167)](this[_0x547d51(0x162)],job_1['MANIFEST_FILENAME']),_0x214731=await(0x0,promises_2[_0x547d51(0x179)])(_0x3ee444,{'encoding':_0x547d51(0x11b)})[_0x547d51(0x121)](JSON['parse'])[_0x547d51(0x121)](({details:_0x3e7700})=>_0x3e7700);await(0x0,promises_2['rm'])(_0x3ee444,{'recursive':!![],'force':!![]}),this[_0x547d51(0x16e)]=_0x214731['apiVersion'],this[_0x547d51(0x15e)]=_0x214731[_0x547d51(0x15e)],this['targetOrgCredentials']=_0x214731[_0x547d51(0x14f)],this[_0x547d51(0x12a)]=_0x214731[_0x547d51(0x12a)],this[_0x547d51(0x139)]=_0x214731[_0x547d51(0x139)],this[_0x547d51(0x11a)]=_0x214731[_0x547d51(0x11a)],this[_0x547d51(0x16f)]=_0x214731[_0x547d51(0x16f)],this[_0x547d51(0x124)]=_0x214731[_0x547d51(0x124)];}async[a347_0x2ab689(0x133)](){const _0x3bca51=a347_0x2ab689;this['flosumInstance']=await salesforce_1[_0x3bca51(0x11e)][_0x3bca51(0x134)](new auth_manager_1['AuthManager'](this[_0x3bca51(0x15e)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x3bca51(0x158)]=await salesforce_1[_0x3bca51(0x11e)]['create'](new auth_manager_1[(_0x3bca51(0x128))](this[_0x3bca51(0x14f)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a347_0x2ab689(0x15b)](){const _0x86d2c5=a347_0x2ab689;this[_0x86d2c5(0x152)]=new metadata_logger_1[(_0x86d2c5(0x151))]({'apiVersion':this[_0x86d2c5(0x16e)],'instance':this['flosumInstance'],'targetOrgId':this[_0x86d2c5(0x12a)],'trackingSettingId':this[_0x86d2c5(0x139)],'startDate':this[_0x86d2c5(0x137)]}),this[_0x86d2c5(0x16c)]=await this[_0x86d2c5(0x152)]['init']();}[a347_0x2ab689(0x130)](){const _0x2825cf=a347_0x2ab689;this[_0x2825cf(0x176)]=new logger_1[(_0x2825cf(0x131))]({'systemLogger':systemLogger,'apiVersion':this[_0x2825cf(0x16e)],'instance':this[_0x2825cf(0x154)],'metadataLogId':this['metadataLogId'],'timeZone':this['timeZone']});}['getSourceMemberRetriever'](){const _0xb961ff=a347_0x2ab689;return new source_member_retriever_1['SourceMemberRetriever']({'apiVersion':this['apiVersion'],'instance':this[_0xb961ff(0x158)],'logger':this['logger'],'lastRetrieveDate':this[_0xb961ff(0x11a)],'currentRetrieveDate':this[_0xb961ff(0x137)],'metadataTypes':this[_0xb961ff(0x16f)]});}['getSourceMemberHandler'](){const _0x2024f8=a347_0x2ab689;return new source_member_handler_1[(_0x2024f8(0x120))]({'instance':this['flosumInstance'],'apiVersion':this[_0x2024f8(0x16e)],'logger':this[_0x2024f8(0x176)],'targetOrgId':this[_0x2024f8(0x12a)]});}['getMetadataRetriever'](){const _0x1548ed=a347_0x2ab689;return new metadata_retriever_1[(_0x1548ed(0x140))]({'instance':this[_0x1548ed(0x158)],'apiVersion':this[_0x1548ed(0x16e)],'logger':this[_0x1548ed(0x176)],'metadataTypes':this[_0x1548ed(0x16f)]});}[a347_0x2ab689(0x160)](){const _0x14f36a=a347_0x2ab689;return new components_deployer_1[(_0x14f36a(0x164))]({'instance':this[_0x14f36a(0x154)],'logger':this[_0x14f36a(0x176)],'apiVersion':this[_0x14f36a(0x16e)],'targetOrgId':this[_0x14f36a(0x12a)],'trackingSettingId':this[_0x14f36a(0x139)]});}[a347_0x2ab689(0x16d)](){const _0x2e4b5c=a347_0x2ab689;return{'attributes':{'type':constants_1[_0x2e4b5c(0x166)]+_0x2e4b5c(0x13f)},'Id':this[_0x2e4b5c(0x139)],[constants_1[_0x2e4b5c(0x166)]+_0x2e4b5c(0x155)]:![],[constants_1[_0x2e4b5c(0x166)]+_0x2e4b5c(0x173)]:this['startDate']};}async[a347_0x2ab689(0x13c)](){const _0x16445b=a347_0x2ab689,_0x3a4458=this[_0x16445b(0x16d)](),_0x31bacd=new salesforce_1[(_0x16445b(0x12d))]({'instance':this[_0x16445b(0x154)],'objectName':constants_1['FLOSUM_NAMESPACE']+_0x16445b(0x13f),'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'}),_0x54aab6=await _0x31bacd[_0x16445b(0x11f)]({'records':[_0x3a4458]}),_0x2828df=_0x54aab6['at'](0x0);(_0x2828df===null||_0x2828df===void 0x0?void 0x0:_0x2828df[_0x16445b(0x11c)])?this[_0x16445b(0x176)][_0x16445b(0x16b)](_0x16445b(0x15a)):this[_0x16445b(0x176)]['log'](_0x16445b(0x15c)+(_0x2828df===null||_0x2828df===void 0x0?void 0x0:_0x2828df['error']));}async[a347_0x2ab689(0x11f)](){const _0x52c791=a347_0x2ab689;await this['initManifest'](),this[_0x52c791(0x137)]=new Date()[_0x52c791(0x12f)]();try{await this[_0x52c791(0x133)](),await this[_0x52c791(0x15b)](),this[_0x52c791(0x130)](),this[_0x52c791(0x176)][_0x52c791(0x16b)](_0x52c791(0x14c)+this['jobId']),this[_0x52c791(0x152)][_0x52c791(0x165)]=constants_2[_0x52c791(0x175)][_0x52c791(0x15f)],await this[_0x52c791(0x152)][_0x52c791(0x14d)](),await this['logger'][_0x52c791(0x14d)]();const _0x4e49a1=this[_0x52c791(0x122)](),_0x35f1dd=this[_0x52c791(0x14a)](),_0x242039=this[_0x52c791(0x12c)](),_0x5aa441=this[_0x52c791(0x160)]();await(0x0,promises_1[_0x52c791(0x163)])(_0x4e49a1,_0x35f1dd,_0x242039,_0x5aa441),this[_0x52c791(0x176)][_0x52c791(0x16b)](_0x52c791(0x156)),this[_0x52c791(0x152)][_0x52c791(0x165)]=constants_2[_0x52c791(0x175)][_0x52c791(0x119)];}catch(_0x472ffe){this['logger'][_0x52c791(0x125)](_0x52c791(0x141)),this[_0x52c791(0x176)]['error'](_0x472ffe[_0x52c791(0x159)]),this[_0x52c791(0x152)][_0x52c791(0x165)]=constants_2['LogStatus']['EXCEPTION'];}finally{await this['updateTrackingSetting'](),await this[_0x52c791(0x176)]['update'](),await this[_0x52c791(0x152)][_0x52c791(0x14d)]();}}}exports[a347_0x2ab689(0x13d)]=Job,new Job()[a347_0x2ab689(0x11f)]()['then'](()=>process[a347_0x2ab689(0x177)](0x0))[a347_0x2ab689(0x149)](_0x5ee3d1=>{const _0x196080=a347_0x2ab689;systemLogger[_0x196080(0x125)](_0x196080(0x136)+_0x5ee3d1['message']),process[_0x196080(0x177)](0x1);});