const a335_0x419b13=a335_0x38ba;(function(_0x12cf3a,_0x48d998){const _0x526f82=a335_0x38ba,_0x4d93d5=_0x12cf3a();while(!![]){try{const _0x18cc3c=-parseInt(_0x526f82(0x178))/0x1+-parseInt(_0x526f82(0x16a))/0x2+-parseInt(_0x526f82(0x141))/0x3+-parseInt(_0x526f82(0x160))/0x4*(parseInt(_0x526f82(0x14a))/0x5)+-parseInt(_0x526f82(0x143))/0x6+parseInt(_0x526f82(0x170))/0x7*(parseInt(_0x526f82(0x16d))/0x8)+parseInt(_0x526f82(0x164))/0x9;if(_0x18cc3c===_0x48d998)break;else _0x4d93d5['push'](_0x4d93d5['shift']());}catch(_0x47051f){_0x4d93d5['push'](_0x4d93d5['shift']());}}}(a335_0x2b24,0x91161));const a335_0x564cac=(function(){let _0x484b62=!![];return function(_0xa53218,_0x2f1dd6){const _0x240854=_0x484b62?function(){const _0x4c6c07=a335_0x38ba;if(_0x2f1dd6){const _0x310990=_0x2f1dd6[_0x4c6c07(0x129)](_0xa53218,arguments);return _0x2f1dd6=null,_0x310990;}}:function(){};return _0x484b62=![],_0x240854;};}()),a335_0x531604=a335_0x564cac(this,function(){const _0x51bb17=a335_0x38ba;return a335_0x531604[_0x51bb17(0x12d)]()[_0x51bb17(0x132)](_0x51bb17(0x147))[_0x51bb17(0x12d)]()[_0x51bb17(0x17f)](a335_0x531604)[_0x51bb17(0x132)](_0x51bb17(0x147));});a335_0x531604();'use strict';function a335_0x2b24(){const _0x2fae30=['Job\x20Error:\x20','110Mcikvp','updateTrackingSetting','../../../constants','COMPLETED','metadataLogger','initInstances','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','flosumInstance','getSourceMemberRetriever','RestSimpleDeployData','metadataLogId','success','join','utf-8','flosumOrgCredentials','EXCEPTION','default','update','lastRetrieveDate','getSourceMemberHandler','@flosum/salesforce','IN_PROGRESS','104792widvtp','initManifest','../../../core','getTime','37587105yLAhju','then','logger','targetInstance','Tracking\x20components\x20job\x20has\x20been\x20completed','__importDefault','1586628aFYdDp','jobStorePath','targetOrgCredentials','376072uGAnPo','execute','exit','154HFhLVu','initLogger','MetadataRetriever','log','createTrackingSettingRecord','Logger','readFile','jobId','1181910NyPDfj','timeZone','Tracking\x20components\x20job\x20has\x20been\x20failed','SourceMemberHandler','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','fs/promises','./classes/source-member.handler','constructor','status','argv','init','initMetadataLogger','minimist','apply','Job','targetOrgId','MANIFEST_FILENAME','toString','message','__esModule','AxiosInstanceUtils','../constants','search','create','LogStatus','metadataTypes','Tracking_Setting__c','stream/promises','FLOSUM_NAMESPACE','./classes/metadata-logger','./classes/metadata.retriever','error','getComponentsDeployer','AuthManager','startDate','trackingSettingId','ComponentsDeployer','3420882SCgIGS','getMetadataRetriever','5546376hqTPQu','defineProperty','slice','apiVersion','(((.+)+)+)+$','../../../constants/job'];a335_0x2b24=function(){return _0x2fae30;};return a335_0x2b24();}function a335_0x38ba(_0x456ec3,_0xe1cea6){const _0x147c14=a335_0x2b24();return a335_0x38ba=function(_0x531604,_0x564cac){_0x531604=_0x531604-0x125;let _0x2b240c=_0x147c14[_0x531604];return _0x2b240c;},a335_0x38ba(_0x456ec3,_0xe1cea6);}var __importDefault=this&&this[a335_0x419b13(0x169)]||function(_0x5b1d31){return _0x5b1d31&&_0x5b1d31['__esModule']?_0x5b1d31:{'default':_0x5b1d31};};Object[a335_0x419b13(0x144)](exports,a335_0x419b13(0x12f),{'value':!![]}),exports[a335_0x419b13(0x12a)]=void 0x0;const minimist_1=__importDefault(require(a335_0x419b13(0x128))),core_1=require(a335_0x419b13(0x162)),salesforce_1=require(a335_0x419b13(0x15e)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require('./classes/logger/logger'),promises_1=require(a335_0x419b13(0x137)),promises_2=require(a335_0x419b13(0x17d)),path_1=__importDefault(require('path')),metadata_retriever_1=require(a335_0x419b13(0x13a)),components_deployer_1=require('./classes/components.deployer'),source_member_retriever_1=require('./classes/source-member.retriever'),source_member_handler_1=require(a335_0x419b13(0x17e)),metadata_logger_1=require(a335_0x419b13(0x139)),job_1=require(a335_0x419b13(0x148)),constants_1=require(a335_0x419b13(0x14c)),constants_2=require(a335_0x419b13(0x131)),{jobId,jobStorePath}=(0x0,minimist_1['default'])(process[a335_0x419b13(0x125)][a335_0x419b13(0x145)](0x2)),systemLogger=new core_1[(a335_0x419b13(0x175))](jobId);class Job{constructor(){const _0x2271b5=a335_0x419b13;this[_0x2271b5(0x16b)]=jobStorePath,this[_0x2271b5(0x177)]=jobId;}async[a335_0x419b13(0x161)](){const _0x1f5ccc=a335_0x419b13,_0x93ca95=path_1[_0x1f5ccc(0x15a)][_0x1f5ccc(0x156)](this[_0x1f5ccc(0x16b)],job_1[_0x1f5ccc(0x12c)]),_0x4c30c8=await(0x0,promises_2[_0x1f5ccc(0x176)])(_0x93ca95,{'encoding':_0x1f5ccc(0x157)})[_0x1f5ccc(0x165)](JSON['parse'])[_0x1f5ccc(0x165)](({details:_0x4ceda4})=>_0x4ceda4);await(0x0,promises_2['rm'])(_0x93ca95,{'recursive':!![],'force':!![]}),this['apiVersion']=_0x4c30c8[_0x1f5ccc(0x146)],this[_0x1f5ccc(0x158)]=_0x4c30c8[_0x1f5ccc(0x158)],this[_0x1f5ccc(0x16c)]=_0x4c30c8[_0x1f5ccc(0x16c)],this['targetOrgId']=_0x4c30c8['targetOrgId'],this[_0x1f5ccc(0x13f)]=_0x4c30c8['trackingSettingId'],this[_0x1f5ccc(0x15c)]=_0x4c30c8['lastRetrieveDate'],this[_0x1f5ccc(0x135)]=_0x4c30c8[_0x1f5ccc(0x135)],this['timeZone']=_0x4c30c8[_0x1f5ccc(0x179)];}async[a335_0x419b13(0x14f)](){const _0x4076ed=a335_0x419b13;this[_0x4076ed(0x151)]=await salesforce_1[_0x4076ed(0x130)][_0x4076ed(0x133)](new auth_manager_1[(_0x4076ed(0x13d))](this[_0x4076ed(0x158)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x4076ed(0x167)]=await salesforce_1['AxiosInstanceUtils'][_0x4076ed(0x133)](new auth_manager_1[(_0x4076ed(0x13d))](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a335_0x419b13(0x127)](){const _0x1d3d61=a335_0x419b13;this['metadataLogger']=new metadata_logger_1['MetadataLogger']({'apiVersion':this[_0x1d3d61(0x146)],'instance':this[_0x1d3d61(0x151)],'targetOrgId':this[_0x1d3d61(0x12b)],'trackingSettingId':this[_0x1d3d61(0x13f)],'startDate':this[_0x1d3d61(0x13e)]}),this[_0x1d3d61(0x154)]=await this['metadataLogger'][_0x1d3d61(0x126)]();}[a335_0x419b13(0x171)](){const _0x537217=a335_0x419b13;this[_0x537217(0x166)]=new logger_1[(_0x537217(0x175))]({'systemLogger':systemLogger,'apiVersion':this[_0x537217(0x146)],'instance':this[_0x537217(0x151)],'metadataLogId':this[_0x537217(0x154)],'timeZone':this['timeZone']});}[a335_0x419b13(0x152)](){const _0xc49eb1=a335_0x419b13;return new source_member_retriever_1['SourceMemberRetriever']({'apiVersion':this[_0xc49eb1(0x146)],'instance':this[_0xc49eb1(0x167)],'logger':this['logger'],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0xc49eb1(0x13e)],'metadataTypes':this['metadataTypes']});}[a335_0x419b13(0x15d)](){const _0x1f1a77=a335_0x419b13;return new source_member_handler_1[(_0x1f1a77(0x17b))]({'instance':this[_0x1f1a77(0x151)],'apiVersion':this[_0x1f1a77(0x146)],'logger':this[_0x1f1a77(0x166)],'targetOrgId':this[_0x1f1a77(0x12b)]});}[a335_0x419b13(0x142)](){const _0x343c39=a335_0x419b13;return new metadata_retriever_1[(_0x343c39(0x172))]({'instance':this[_0x343c39(0x167)],'apiVersion':this['apiVersion'],'logger':this[_0x343c39(0x166)],'metadataTypes':this[_0x343c39(0x135)]});}[a335_0x419b13(0x13c)](){const _0x2f8695=a335_0x419b13;return new components_deployer_1[(_0x2f8695(0x140))]({'instance':this[_0x2f8695(0x151)],'logger':this['logger'],'apiVersion':this[_0x2f8695(0x146)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x2f8695(0x13f)]});}[a335_0x419b13(0x174)](){const _0x4acb4b=a335_0x419b13;return{'attributes':{'type':constants_1[_0x4acb4b(0x138)]+_0x4acb4b(0x136)},'Id':this['trackingSettingId'],[constants_1[_0x4acb4b(0x138)]+'Is_Processed__c']:![],[constants_1[_0x4acb4b(0x138)]+'Last_Start_Retrieval__c']:this[_0x4acb4b(0x13e)]};}async['updateTrackingSetting'](){const _0xa2aa2f=a335_0x419b13,_0x59c1d8=this[_0xa2aa2f(0x174)](),_0x57325c=new salesforce_1[(_0xa2aa2f(0x153))]({'instance':this[_0xa2aa2f(0x151)],'objectName':constants_1[_0xa2aa2f(0x138)]+_0xa2aa2f(0x136),'api':this[_0xa2aa2f(0x146)],'allOrNone':![],'externalIdField':'Id'}),_0x2a6f25=await _0x57325c['execute']({'records':[_0x59c1d8]}),_0x3382af=_0x2a6f25['at'](0x0);(_0x3382af===null||_0x3382af===void 0x0?void 0x0:_0x3382af[_0xa2aa2f(0x155)])?this[_0xa2aa2f(0x166)][_0xa2aa2f(0x173)]('Tracking\x20setting\x20updated'):this['logger'][_0xa2aa2f(0x173)](_0xa2aa2f(0x150)+(_0x3382af===null||_0x3382af===void 0x0?void 0x0:_0x3382af[_0xa2aa2f(0x13b)]));}async['execute'](){const _0x40c85c=a335_0x419b13;await this[_0x40c85c(0x161)](),this[_0x40c85c(0x13e)]=new Date()[_0x40c85c(0x163)]();try{await this[_0x40c85c(0x14f)](),await this['initMetadataLogger'](),this[_0x40c85c(0x171)](),this[_0x40c85c(0x166)]['log'](_0x40c85c(0x17c)+this[_0x40c85c(0x177)]),this[_0x40c85c(0x14e)][_0x40c85c(0x180)]=constants_2['LogStatus'][_0x40c85c(0x15f)],await this[_0x40c85c(0x14e)][_0x40c85c(0x15b)](),await this['logger'][_0x40c85c(0x15b)]();const _0x2bf493=this[_0x40c85c(0x152)](),_0x5b508b=this[_0x40c85c(0x15d)](),_0x430b7d=this['getMetadataRetriever'](),_0x34d7ac=this['getComponentsDeployer']();await(0x0,promises_1['pipeline'])(_0x2bf493,_0x5b508b,_0x430b7d,_0x34d7ac),this[_0x40c85c(0x166)]['log'](_0x40c85c(0x168)),this[_0x40c85c(0x14e)][_0x40c85c(0x180)]=constants_2[_0x40c85c(0x134)][_0x40c85c(0x14d)];}catch(_0x971cc){this[_0x40c85c(0x166)]['error'](_0x40c85c(0x17a)),this[_0x40c85c(0x166)][_0x40c85c(0x13b)](_0x971cc[_0x40c85c(0x12e)]),this[_0x40c85c(0x14e)][_0x40c85c(0x180)]=constants_2[_0x40c85c(0x134)][_0x40c85c(0x159)];}finally{await this[_0x40c85c(0x14b)](),await this[_0x40c85c(0x166)]['update'](),await this['metadataLogger'][_0x40c85c(0x15b)]();}}}exports[a335_0x419b13(0x12a)]=Job,new Job()[a335_0x419b13(0x16e)]()['then'](()=>process[a335_0x419b13(0x16f)](0x0))['catch'](_0x4a9eb5=>{const _0x56b071=a335_0x419b13;systemLogger['error'](_0x56b071(0x149)+_0x4a9eb5[_0x56b071(0x12e)]),process[_0x56b071(0x16f)](0x1);});