const a347_0x4f3fe4=a347_0x2829;(function(_0x421b88,_0x27bcf6){const _0x3540d8=a347_0x2829,_0x3c1ad9=_0x421b88();while(!![]){try{const _0x1ca5d9=-parseInt(_0x3540d8(0xc7))/0x1*(-parseInt(_0x3540d8(0xcd))/0x2)+parseInt(_0x3540d8(0x9e))/0x3*(parseInt(_0x3540d8(0x9a))/0x4)+-parseInt(_0x3540d8(0xb1))/0x5+-parseInt(_0x3540d8(0xe9))/0x6+parseInt(_0x3540d8(0xbb))/0x7*(parseInt(_0x3540d8(0xba))/0x8)+parseInt(_0x3540d8(0xf3))/0x9+-parseInt(_0x3540d8(0xa4))/0xa*(parseInt(_0x3540d8(0x98))/0xb);if(_0x1ca5d9===_0x27bcf6)break;else _0x3c1ad9['push'](_0x3c1ad9['shift']());}catch(_0xdca276){_0x3c1ad9['push'](_0x3c1ad9['shift']());}}}(a347_0x328f,0xa14ed));const a347_0x6c375e=(function(){let _0x4e6a65=!![];return function(_0x507ca5,_0x2ba4ed){const _0x51e2c7=_0x4e6a65?function(){const _0xa84b4c=a347_0x2829;if(_0x2ba4ed){const _0x2d04b8=_0x2ba4ed[_0xa84b4c(0xed)](_0x507ca5,arguments);return _0x2ba4ed=null,_0x2d04b8;}}:function(){};return _0x4e6a65=![],_0x51e2c7;};}()),a347_0x490c73=a347_0x6c375e(this,function(){const _0x4766db=a347_0x2829;return a347_0x490c73[_0x4766db(0xcf)]()[_0x4766db(0xac)](_0x4766db(0x9c))[_0x4766db(0xcf)]()[_0x4766db(0xd5)](a347_0x490c73)[_0x4766db(0xac)](_0x4766db(0x9c));});function a347_0x2829(_0x1c7183,_0x476378){const _0x1bb8bd=a347_0x328f();return a347_0x2829=function(_0x490c73,_0x6c375e){_0x490c73=_0x490c73-0x97;let _0x328fb7=_0x1bb8bd[_0x490c73];return _0x328fb7;},a347_0x2829(_0x1c7183,_0x476378);}function a347_0x328f(){const _0x256918=['getComponentsDeployer','minimist','initMetadataLogger','404EgHBDI','lastRetrieveDate','toString','MANIFEST_FILENAME','catch','initManifest','execute','metadataTypes','constructor','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','exit','jobId','create','Tracking_Setting__c','fs/promises','updateTrackingSetting','trackingSettingId','default','message','AuthManager','targetOrgCredentials','path','AxiosInstanceUtils','ComponentsDeployer','metadataLogId','SourceMemberHandler','startDate','createTrackingSettingRecord','1829106eSCFmT','RestSimpleDeployData','Logger','logger','apply','stream/promises','LogStatus','getTime','success','slice','3893814VXbCAF','parse','./classes/components.deployer','Tracking\x20components\x20job\x20has\x20been\x20completed','127402lirOTJ','error','44rAOQmM','getMetadataRetriever','(((.+)+)+)+$','Job\x20Error:\x20','250089YpNiQt','__esModule','MetadataRetriever','./classes/source-member.retriever','then','getSourceMemberHandler','100bRLYom','Job','initLogger','targetInstance','../constants','argv','apiVersion','timeZone','search','initInstances','log','targetOrgId','../../../core','4796455EQIDbK','FLOSUM_NAMESPACE','SourceMemberRetriever','pipeline','IN_PROGRESS','./classes/metadata-logger','flosumOrgCredentials','./classes/metadata.retriever','update','8bzNdae','1200472lYHTwu','metadataLogger','COMPLETED','jobStorePath','flosumInstance','../../shared/managers/auth.manager','readFile','Tracking\x20setting\x20updated','getSourceMemberRetriever','status','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','Tracking\x20components\x20job\x20has\x20been\x20failed','2572BdFOUZ','Last_Start_Retrieval__c','init'];a347_0x328f=function(){return _0x256918;};return a347_0x328f();}a347_0x490c73();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4756be){const _0x4e09fc=a347_0x2829;return _0x4756be&&_0x4756be[_0x4e09fc(0x9f)]?_0x4756be:{'default':_0x4756be};};Object['defineProperty'](exports,a347_0x4f3fe4(0x9f),{'value':!![]}),exports[a347_0x4f3fe4(0xa5)]=void 0x0;const minimist_1=__importDefault(require(a347_0x4f3fe4(0xcb))),core_1=require(a347_0x4f3fe4(0xb0)),salesforce_1=require('@flosum/salesforce'),auth_manager_1=require(a347_0x4f3fe4(0xc0)),logger_1=require('./classes/logger/logger'),promises_1=require(a347_0x4f3fe4(0xee)),promises_2=require(a347_0x4f3fe4(0xdb)),path_1=__importDefault(require(a347_0x4f3fe4(0xe2))),metadata_retriever_1=require(a347_0x4f3fe4(0xb8)),components_deployer_1=require(a347_0x4f3fe4(0xf5)),source_member_retriever_1=require(a347_0x4f3fe4(0xa1)),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require(a347_0x4f3fe4(0xb6)),job_1=require('../../../constants/job'),constants_1=require('../../../constants'),constants_2=require(a347_0x4f3fe4(0xa8)),{jobId,jobStorePath}=(0x0,minimist_1[a347_0x4f3fe4(0xde)])(process[a347_0x4f3fe4(0xa9)][a347_0x4f3fe4(0xf2)](0x2)),systemLogger=new core_1['Logger'](jobId);class Job{constructor(){const _0x18769c=a347_0x4f3fe4;this[_0x18769c(0xbe)]=jobStorePath,this[_0x18769c(0xd8)]=jobId;}async['initManifest'](){const _0x2e1bae=a347_0x4f3fe4,_0x30c2fc=path_1[_0x2e1bae(0xde)]['join'](this[_0x2e1bae(0xbe)],job_1[_0x2e1bae(0xd0)]),_0x2dcace=await(0x0,promises_2[_0x2e1bae(0xc1)])(_0x30c2fc,{'encoding':'utf-8'})[_0x2e1bae(0xa2)](JSON[_0x2e1bae(0xf4)])[_0x2e1bae(0xa2)](({details:_0x5250c3})=>_0x5250c3);await(0x0,promises_2['rm'])(_0x30c2fc,{'recursive':!![],'force':!![]}),this[_0x2e1bae(0xaa)]=_0x2dcace[_0x2e1bae(0xaa)],this['flosumOrgCredentials']=_0x2dcace[_0x2e1bae(0xb7)],this['targetOrgCredentials']=_0x2dcace[_0x2e1bae(0xe1)],this[_0x2e1bae(0xaf)]=_0x2dcace[_0x2e1bae(0xaf)],this[_0x2e1bae(0xdd)]=_0x2dcace['trackingSettingId'],this[_0x2e1bae(0xce)]=_0x2dcace[_0x2e1bae(0xce)],this['metadataTypes']=_0x2dcace[_0x2e1bae(0xd4)],this[_0x2e1bae(0xab)]=_0x2dcace[_0x2e1bae(0xab)];}async['initInstances'](){const _0x2a0a7d=a347_0x4f3fe4;this[_0x2a0a7d(0xbf)]=await salesforce_1[_0x2a0a7d(0xe3)][_0x2a0a7d(0xd9)](new auth_manager_1[(_0x2a0a7d(0xe0))](this[_0x2a0a7d(0xb7)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x2a0a7d(0xa7)]=await salesforce_1[_0x2a0a7d(0xe3)][_0x2a0a7d(0xd9)](new auth_manager_1[(_0x2a0a7d(0xe0))](this[_0x2a0a7d(0xe1)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async['initMetadataLogger'](){const _0x1b4a28=a347_0x4f3fe4;this[_0x1b4a28(0xbc)]=new metadata_logger_1['MetadataLogger']({'apiVersion':this[_0x1b4a28(0xaa)],'instance':this[_0x1b4a28(0xbf)],'targetOrgId':this[_0x1b4a28(0xaf)],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0x1b4a28(0xe7)]}),this[_0x1b4a28(0xe5)]=await this[_0x1b4a28(0xbc)][_0x1b4a28(0xc9)]();}[a347_0x4f3fe4(0xa6)](){const _0x5ce618=a347_0x4f3fe4;this[_0x5ce618(0xec)]=new logger_1[(_0x5ce618(0xeb))]({'systemLogger':systemLogger,'apiVersion':this[_0x5ce618(0xaa)],'instance':this[_0x5ce618(0xbf)],'metadataLogId':this[_0x5ce618(0xe5)],'timeZone':this[_0x5ce618(0xab)]});}[a347_0x4f3fe4(0xc3)](){const _0x241164=a347_0x4f3fe4;return new source_member_retriever_1[(_0x241164(0xb3))]({'apiVersion':this[_0x241164(0xaa)],'instance':this[_0x241164(0xa7)],'logger':this['logger'],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this['startDate'],'metadataTypes':this[_0x241164(0xd4)]});}[a347_0x4f3fe4(0xa3)](){const _0x16fae5=a347_0x4f3fe4;return new source_member_handler_1[(_0x16fae5(0xe6))]({'instance':this[_0x16fae5(0xbf)],'apiVersion':this[_0x16fae5(0xaa)],'logger':this[_0x16fae5(0xec)],'targetOrgId':this[_0x16fae5(0xaf)]});}[a347_0x4f3fe4(0x9b)](){const _0x5d5431=a347_0x4f3fe4;return new metadata_retriever_1[(_0x5d5431(0xa0))]({'instance':this[_0x5d5431(0xa7)],'apiVersion':this[_0x5d5431(0xaa)],'logger':this[_0x5d5431(0xec)],'metadataTypes':this['metadataTypes']});}[a347_0x4f3fe4(0xca)](){const _0x2817f3=a347_0x4f3fe4;return new components_deployer_1[(_0x2817f3(0xe4))]({'instance':this[_0x2817f3(0xbf)],'logger':this['logger'],'apiVersion':this[_0x2817f3(0xaa)],'targetOrgId':this[_0x2817f3(0xaf)],'trackingSettingId':this['trackingSettingId']});}[a347_0x4f3fe4(0xe8)](){const _0x49aece=a347_0x4f3fe4;return{'attributes':{'type':constants_1[_0x49aece(0xb2)]+_0x49aece(0xda)},'Id':this[_0x49aece(0xdd)],[constants_1[_0x49aece(0xb2)]+'Is_Processed__c']:![],[constants_1[_0x49aece(0xb2)]+_0x49aece(0xc8)]:this[_0x49aece(0xe7)]};}async[a347_0x4f3fe4(0xdc)](){const _0x378154=a347_0x4f3fe4,_0x54eead=this[_0x378154(0xe8)](),_0x5f2e80=new salesforce_1[(_0x378154(0xea))]({'instance':this[_0x378154(0xbf)],'objectName':constants_1[_0x378154(0xb2)]+'Tracking_Setting__c','api':this[_0x378154(0xaa)],'allOrNone':![],'externalIdField':'Id'}),_0x5f4759=await _0x5f2e80['execute']({'records':[_0x54eead]}),_0x3b187c=_0x5f4759['at'](0x0);(_0x3b187c===null||_0x3b187c===void 0x0?void 0x0:_0x3b187c[_0x378154(0xf1)])?this[_0x378154(0xec)][_0x378154(0xae)](_0x378154(0xc2)):this[_0x378154(0xec)]['log'](_0x378154(0xd6)+(_0x3b187c===null||_0x3b187c===void 0x0?void 0x0:_0x3b187c[_0x378154(0x99)]));}async['execute'](){const _0x33381e=a347_0x4f3fe4;await this[_0x33381e(0xd2)](),this[_0x33381e(0xe7)]=new Date()[_0x33381e(0xf0)]();try{await this[_0x33381e(0xad)](),await this[_0x33381e(0xcc)](),this[_0x33381e(0xa6)](),this[_0x33381e(0xec)][_0x33381e(0xae)](_0x33381e(0xc5)+this[_0x33381e(0xd8)]),this[_0x33381e(0xbc)]['status']=constants_2[_0x33381e(0xef)][_0x33381e(0xb5)],await this[_0x33381e(0xbc)][_0x33381e(0xb9)](),await this['logger'][_0x33381e(0xb9)]();const _0x1e5aa8=this[_0x33381e(0xc3)](),_0xac740=this[_0x33381e(0xa3)](),_0x5af2b2=this[_0x33381e(0x9b)](),_0xf322ec=this['getComponentsDeployer']();await(0x0,promises_1[_0x33381e(0xb4)])(_0x1e5aa8,_0xac740,_0x5af2b2,_0xf322ec),this['logger']['log'](_0x33381e(0x97)),this[_0x33381e(0xbc)][_0x33381e(0xc4)]=constants_2[_0x33381e(0xef)][_0x33381e(0xbd)];}catch(_0x24059d){this[_0x33381e(0xec)]['error'](_0x33381e(0xc6)),this['logger'][_0x33381e(0x99)](_0x24059d[_0x33381e(0xdf)]),this['metadataLogger'][_0x33381e(0xc4)]=constants_2['LogStatus']['EXCEPTION'];}finally{await this[_0x33381e(0xdc)](),await this[_0x33381e(0xec)]['update'](),await this['metadataLogger'][_0x33381e(0xb9)]();}}}exports[a347_0x4f3fe4(0xa5)]=Job,new Job()[a347_0x4f3fe4(0xd3)]()[a347_0x4f3fe4(0xa2)](()=>process[a347_0x4f3fe4(0xd7)](0x0))[a347_0x4f3fe4(0xd1)](_0x10df9a=>{const _0x426444=a347_0x4f3fe4;systemLogger[_0x426444(0x99)](_0x426444(0x9d)+_0x10df9a['message']),process['exit'](0x1);});