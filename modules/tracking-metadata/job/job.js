function a348_0x4dd0(){const _0x3d295f=['initLogger','EXCEPTION','SourceMemberRetriever','logger','flosumOrgCredentials','MetadataLogger','LogStatus','jobStorePath','join','IN_PROGRESS','default','success','initInstances','exit','(((.+)+)+)+$','51275egjULE','jobId','message','../constants','AuthManager','timeZone','./classes/components.deployer','MetadataRetriever','3419340ojCVnw','408OYHiDp','FLOSUM_NAMESPACE','COMPLETED','argv','283830iLvRjS','88RkBenT','./classes/source-member.retriever','189FCzbZx','create','defineProperty','getSourceMemberHandler','updateTrackingSetting','RestSimpleDeployData','getSourceMemberRetriever','../../../core','./classes/source-member.handler','Job','isProcessed','Is_Processed__c','initMetadataLogger','targetOrgId','initManifest','./classes/metadata-logger','startDate','apply','AxiosInstanceUtils','trackingSettingId','lastRetrieveDate','slice','2124409RUJBIZ','18DYIufO','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','getTime','error','init','constructor','1410986KpHKya','apiVersion','then','__importDefault','./classes/logger/logger','Logger','log','execute','targetInstance','search','272016ILHjZr','getComponentsDeployer','__esModule','update','utf-8','628181zohgNj','Tracking_Setting__c','status','MANIFEST_FILENAME','metadataLogger','../../../constants','pipeline','targetOrgCredentials','flosumInstance','toString','catch','8EXaWNw','createTrackingSettingRecord','metadataTypes'];a348_0x4dd0=function(){return _0x3d295f;};return a348_0x4dd0();}const a348_0x2de497=a348_0x1e45;(function(_0x27cd61,_0x2578f5){const _0x4ff5c4=a348_0x1e45,_0x2f2b68=_0x27cd61();while(!![]){try{const _0x833bad=-parseInt(_0x4ff5c4(0x152))/0x1+-parseInt(_0x4ff5c4(0x143))/0x2+parseInt(_0x4ff5c4(0x13d))/0x3*(parseInt(_0x4ff5c4(0x14d))/0x4)+-parseInt(_0x4ff5c4(0x116))/0x5*(parseInt(_0x4ff5c4(0x11f))/0x6)+-parseInt(_0x4ff5c4(0x13c))/0x7*(-parseInt(_0x4ff5c4(0x15d))/0x8)+parseInt(_0x4ff5c4(0x126))/0x9*(-parseInt(_0x4ff5c4(0x123))/0xa)+-parseInt(_0x4ff5c4(0x124))/0xb*(-parseInt(_0x4ff5c4(0x11e))/0xc);if(_0x833bad===_0x2578f5)break;else _0x2f2b68['push'](_0x2f2b68['shift']());}catch(_0x3e4727){_0x2f2b68['push'](_0x2f2b68['shift']());}}}(a348_0x4dd0,0x58dee));const a348_0x1678e5=(function(){let _0x729e92=!![];return function(_0xec41b4,_0x44bb1d){const _0x23b5fa=_0x729e92?function(){const _0x554f7f=a348_0x1e45;if(_0x44bb1d){const _0x562b26=_0x44bb1d[_0x554f7f(0x137)](_0xec41b4,arguments);return _0x44bb1d=null,_0x562b26;}}:function(){};return _0x729e92=![],_0x23b5fa;};}()),a348_0x1bd6e0=a348_0x1678e5(this,function(){const _0x34a04e=a348_0x1e45;return a348_0x1bd6e0[_0x34a04e(0x15b)]()[_0x34a04e(0x14c)](_0x34a04e(0x115))[_0x34a04e(0x15b)]()[_0x34a04e(0x142)](a348_0x1bd6e0)[_0x34a04e(0x14c)](_0x34a04e(0x115));});a348_0x1bd6e0();'use strict';var __importDefault=this&&this[a348_0x2de497(0x146)]||function(_0x48e39){const _0x3db607=a348_0x2de497;return _0x48e39&&_0x48e39[_0x3db607(0x14f)]?_0x48e39:{'default':_0x48e39};};Object[a348_0x2de497(0x128)](exports,a348_0x2de497(0x14f),{'value':!![]}),exports['Job']=void 0x0;function a348_0x1e45(_0x34b2c6,_0x5bb230){const _0x1506e6=a348_0x4dd0();return a348_0x1e45=function(_0x1bd6e0,_0x1678e5){_0x1bd6e0=_0x1bd6e0-0x108;let _0x4dd0d2=_0x1506e6[_0x1bd6e0];return _0x4dd0d2;},a348_0x1e45(_0x34b2c6,_0x5bb230);}const minimist_1=__importDefault(require('minimist')),core_1=require(a348_0x2de497(0x12d)),salesforce_1=require('@flosum/salesforce'),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a348_0x2de497(0x147)),promises_1=require('stream/promises'),promises_2=require('fs/promises'),path_1=__importDefault(require('path')),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a348_0x2de497(0x11c)),source_member_retriever_1=require(a348_0x2de497(0x125)),source_member_handler_1=require(a348_0x2de497(0x12e)),metadata_logger_1=require(a348_0x2de497(0x135)),job_1=require('../../../constants/job'),constants_1=require(a348_0x2de497(0x157)),constants_2=require(a348_0x2de497(0x119)),{jobId,jobStorePath}=(0x0,minimist_1[a348_0x2de497(0x111)])(process[a348_0x2de497(0x122)][a348_0x2de497(0x13b)](0x2)),systemLogger=new core_1[(a348_0x2de497(0x148))](jobId);class Job{constructor(){const _0x4d4924=a348_0x2de497;this[_0x4d4924(0x10e)]=jobStorePath,this[_0x4d4924(0x117)]=jobId;}async[a348_0x2de497(0x134)](){const _0x1a68ac=a348_0x2de497,_0x391d3b=path_1[_0x1a68ac(0x111)][_0x1a68ac(0x10f)](this[_0x1a68ac(0x10e)],job_1[_0x1a68ac(0x155)]),_0x5ad20a=await(0x0,promises_2['readFile'])(_0x391d3b,{'encoding':_0x1a68ac(0x151)})['then'](JSON['parse'])[_0x1a68ac(0x145)](({details:_0x19cc3d})=>_0x19cc3d);await(0x0,promises_2['rm'])(_0x391d3b,{'recursive':!![],'force':!![]}),this[_0x1a68ac(0x144)]=_0x5ad20a[_0x1a68ac(0x144)],this[_0x1a68ac(0x10b)]=_0x5ad20a[_0x1a68ac(0x10b)],this[_0x1a68ac(0x159)]=_0x5ad20a[_0x1a68ac(0x159)],this['targetOrgId']=_0x5ad20a[_0x1a68ac(0x133)],this[_0x1a68ac(0x139)]=_0x5ad20a['trackingSettingId'],this['lastRetrieveDate']=_0x5ad20a[_0x1a68ac(0x13a)],this['metadataTypes']=_0x5ad20a[_0x1a68ac(0x15f)],this['timeZone']=_0x5ad20a[_0x1a68ac(0x11b)];}async[a348_0x2de497(0x113)](){const _0x1cd351=a348_0x2de497;this['flosumInstance']=await salesforce_1[_0x1cd351(0x138)]['create'](new auth_manager_1[(_0x1cd351(0x11a))](this[_0x1cd351(0x10b)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this['targetInstance']=await salesforce_1[_0x1cd351(0x138)][_0x1cd351(0x127)](new auth_manager_1[(_0x1cd351(0x11a))](this[_0x1cd351(0x159)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a348_0x2de497(0x132)](){const _0x32ebaf=a348_0x2de497;this[_0x32ebaf(0x156)]=new metadata_logger_1[(_0x32ebaf(0x10c))]({'apiVersion':this['apiVersion'],'instance':this[_0x32ebaf(0x15a)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x32ebaf(0x139)],'startDate':this[_0x32ebaf(0x136)]}),this['metadataLogId']=await this[_0x32ebaf(0x156)][_0x32ebaf(0x141)]();}[a348_0x2de497(0x160)](){const _0x4547b6=a348_0x2de497;this[_0x4547b6(0x10a)]=new logger_1[(_0x4547b6(0x148))]({'systemLogger':systemLogger,'apiVersion':this[_0x4547b6(0x144)],'instance':this[_0x4547b6(0x15a)],'metadataLogId':this['metadataLogId'],'timeZone':this['timeZone']});}['getSourceMemberRetriever'](){const _0x201c59=a348_0x2de497;return new source_member_retriever_1[(_0x201c59(0x109))]({'apiVersion':this[_0x201c59(0x144)],'instance':this[_0x201c59(0x14b)],'logger':this['logger'],'lastRetrieveDate':this[_0x201c59(0x13a)],'currentRetrieveDate':this['startDate'],'metadataTypes':this[_0x201c59(0x15f)]});}[a348_0x2de497(0x129)](){const _0x2958ef=a348_0x2de497;return new source_member_handler_1['SourceMemberHandler']({'instance':this[_0x2958ef(0x15a)],'apiVersion':this[_0x2958ef(0x144)],'logger':this[_0x2958ef(0x10a)],'targetOrgId':this['targetOrgId']});}['getMetadataRetriever'](){const _0x168cb6=a348_0x2de497;return new metadata_retriever_1[(_0x168cb6(0x11d))]({'instance':this[_0x168cb6(0x14b)],'apiVersion':this[_0x168cb6(0x144)],'logger':this['logger'],'metadataTypes':this[_0x168cb6(0x15f)]});}['getComponentsDeployer'](){const _0x10f151=a348_0x2de497;return new components_deployer_1['ComponentsDeployer']({'instance':this[_0x10f151(0x15a)],'logger':this[_0x10f151(0x10a)],'apiVersion':this['apiVersion'],'targetOrgId':this[_0x10f151(0x133)],'trackingSettingId':this[_0x10f151(0x139)]});}[a348_0x2de497(0x15e)](){const _0x53aaa1=a348_0x2de497;return{'attributes':{'type':constants_1[_0x53aaa1(0x120)]+_0x53aaa1(0x153)},'Id':this[_0x53aaa1(0x139)],[constants_1[_0x53aaa1(0x120)]+_0x53aaa1(0x131)]:this[_0x53aaa1(0x130)],[constants_1['FLOSUM_NAMESPACE']+'Last_Start_Retrieval__c']:this[_0x53aaa1(0x136)]};}async['updateTrackingSetting'](){const _0x5d550f=a348_0x2de497,_0x126f1e=this[_0x5d550f(0x15e)](),_0x1b3cf9=new salesforce_1[(_0x5d550f(0x12b))]({'instance':this[_0x5d550f(0x15a)],'objectName':constants_1['FLOSUM_NAMESPACE']+_0x5d550f(0x153),'api':this[_0x5d550f(0x144)],'allOrNone':![],'externalIdField':'Id'}),_0x164273=await _0x1b3cf9[_0x5d550f(0x14a)]({'records':[_0x126f1e]}),_0x24175d=_0x164273['at'](0x0);(_0x24175d===null||_0x24175d===void 0x0?void 0x0:_0x24175d[_0x5d550f(0x112)])?this[_0x5d550f(0x10a)][_0x5d550f(0x149)]('Tracking\x20setting\x20updated'):this[_0x5d550f(0x10a)]['log']('Tracking\x20setting\x20not\x20updated\x20\x0a\x20'+(_0x24175d===null||_0x24175d===void 0x0?void 0x0:_0x24175d['error']));}async[a348_0x2de497(0x14a)](){const _0x1f6858=a348_0x2de497;await this[_0x1f6858(0x134)](),this[_0x1f6858(0x136)]=new Date()[_0x1f6858(0x13f)]();try{await this[_0x1f6858(0x113)](),await this['initMetadataLogger'](),this[_0x1f6858(0x160)](),this['logger']['log'](_0x1f6858(0x13e)+this[_0x1f6858(0x117)]),this['metadataLogger']['status']=constants_2[_0x1f6858(0x10d)][_0x1f6858(0x110)],this['isProcessed']=!![],await this['updateTrackingSetting'](),await this[_0x1f6858(0x156)][_0x1f6858(0x150)](),await this[_0x1f6858(0x10a)][_0x1f6858(0x150)]();const _0x325309=this[_0x1f6858(0x12c)](),_0x29077e=this['getSourceMemberHandler'](),_0x5390d6=this['getMetadataRetriever'](),_0x1c15d8=this[_0x1f6858(0x14e)]();await(0x0,promises_1[_0x1f6858(0x158)])(_0x325309,_0x29077e,_0x5390d6,_0x1c15d8),this['logger'][_0x1f6858(0x149)]('Tracking\x20components\x20job\x20has\x20been\x20completed'),this[_0x1f6858(0x156)][_0x1f6858(0x154)]=constants_2[_0x1f6858(0x10d)][_0x1f6858(0x121)];}catch(_0x49fbbc){this[_0x1f6858(0x10a)][_0x1f6858(0x140)]('Tracking\x20components\x20job\x20has\x20been\x20failed'),this[_0x1f6858(0x10a)][_0x1f6858(0x140)](_0x49fbbc[_0x1f6858(0x118)]),this['metadataLogger']['status']=constants_2['LogStatus'][_0x1f6858(0x108)];}finally{this[_0x1f6858(0x130)]=![],await this[_0x1f6858(0x12a)](),await this['logger'][_0x1f6858(0x150)](),await this[_0x1f6858(0x156)][_0x1f6858(0x150)]();}}}exports[a348_0x2de497(0x12f)]=Job,new Job()[a348_0x2de497(0x14a)]()[a348_0x2de497(0x145)](()=>process[a348_0x2de497(0x114)](0x0))[a348_0x2de497(0x15c)](_0x2b5f6f=>{const _0x243edc=a348_0x2de497;systemLogger['error']('Job\x20Error:\x20'+_0x2b5f6f[_0x243edc(0x118)]),process[_0x243edc(0x114)](0x1);});