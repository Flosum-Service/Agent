const a304_0x1450d9=a304_0x493c;(function(_0x46a2a0,_0x3240e9){const _0x4166d5=a304_0x493c,_0x5ef101=_0x46a2a0();while(!![]){try{const _0x2df70a=parseInt(_0x4166d5(0x145))/0x1+-parseInt(_0x4166d5(0x103))/0x2*(-parseInt(_0x4166d5(0xfc))/0x3)+-parseInt(_0x4166d5(0xfe))/0x4+parseInt(_0x4166d5(0x11a))/0x5+-parseInt(_0x4166d5(0xff))/0x6+parseInt(_0x4166d5(0x123))/0x7+-parseInt(_0x4166d5(0x147))/0x8;if(_0x2df70a===_0x3240e9)break;else _0x5ef101['push'](_0x5ef101['shift']());}catch(_0x4f43bb){_0x5ef101['push'](_0x5ef101['shift']());}}}(a304_0x1553,0xd7342));function a304_0x493c(_0x48f1f1,_0x5d377e){const _0x37c672=a304_0x1553();return a304_0x493c=function(_0x38d6fa,_0x3c0f2a){_0x38d6fa=_0x38d6fa-0xec;let _0x155375=_0x37c672[_0x38d6fa];return _0x155375;},a304_0x493c(_0x48f1f1,_0x5d377e);}const a304_0x3c0f2a=(function(){let _0x4e0c88=!![];return function(_0x59aaaa,_0x44fbff){const _0x51680e=_0x4e0c88?function(){const _0x255e76=a304_0x493c;if(_0x44fbff){const _0x459ae1=_0x44fbff[_0x255e76(0x10d)](_0x59aaaa,arguments);return _0x44fbff=null,_0x459ae1;}}:function(){};return _0x4e0c88=![],_0x51680e;};}()),a304_0x38d6fa=a304_0x3c0f2a(this,function(){const _0x28941d=a304_0x493c;return a304_0x38d6fa['toString']()[_0x28941d(0x132)](_0x28941d(0x146))[_0x28941d(0x141)]()['constructor'](a304_0x38d6fa)[_0x28941d(0x132)]('(((.+)+)+)+$');});a304_0x38d6fa();'use strict';var __importDefault=this&&this[a304_0x1450d9(0x10a)]||function(_0x54473d){const _0xd6f62d=a304_0x1450d9;return _0x54473d&&_0x54473d[_0xd6f62d(0xef)]?_0x54473d:{'default':_0x54473d};};Object['defineProperty'](exports,a304_0x1450d9(0xef),{'value':!![]}),exports[a304_0x1450d9(0x13b)]=void 0x0;const minimist_1=__importDefault(require(a304_0x1450d9(0x10c))),core_1=require(a304_0x1450d9(0xf6)),salesforce_1=require(a304_0x1450d9(0x13c)),auth_manager_1=require(a304_0x1450d9(0x136)),logger_1=require(a304_0x1450d9(0xf7)),promises_1=require(a304_0x1450d9(0x105)),promises_2=require('fs/promises'),path_1=__importDefault(require(a304_0x1450d9(0x11f))),metadata_retriever_1=require(a304_0x1450d9(0xfb)),components_deployer_1=require(a304_0x1450d9(0x13d)),source_member_retriever_1=require(a304_0x1450d9(0xfd)),source_member_handler_1=require(a304_0x1450d9(0x11e)),metadata_logger_1=require(a304_0x1450d9(0x119)),job_1=require('../../../constants/job'),constants_1=require(a304_0x1450d9(0x122)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1[a304_0x1450d9(0x12c)])(process[a304_0x1450d9(0x100)][a304_0x1450d9(0x10f)](0x2)),systemLogger=new core_1[(a304_0x1450d9(0x13f))](jobId);class Job{constructor(){const _0x2638cc=a304_0x1450d9;this[_0x2638cc(0xfa)]=jobStorePath,this[_0x2638cc(0x106)]=jobId;}async[a304_0x1450d9(0x120)](){const _0x489336=a304_0x1450d9,_0x3ab7e2=path_1[_0x489336(0x12c)][_0x489336(0x137)](this[_0x489336(0xfa)],job_1[_0x489336(0x117)]),_0x23d15=await(0x0,promises_2[_0x489336(0x11d)])(_0x3ab7e2,{'encoding':_0x489336(0x10e)})['then'](JSON[_0x489336(0x102)])[_0x489336(0xed)](({details:_0x32382d})=>_0x32382d);await(0x0,promises_2['rm'])(_0x3ab7e2,{'recursive':!![],'force':!![]}),this[_0x489336(0x143)]=_0x23d15['apiVersion'],this['flosumOrgCredentials']=_0x23d15[_0x489336(0x10b)],this[_0x489336(0x104)]=_0x23d15[_0x489336(0x104)],this[_0x489336(0x13e)]=_0x23d15[_0x489336(0x13e)],this['trackingSettingId']=_0x23d15['trackingSettingId'],this[_0x489336(0x142)]=_0x23d15[_0x489336(0x142)],this[_0x489336(0x111)]=_0x23d15[_0x489336(0x111)],this['timeZone']=_0x23d15[_0x489336(0xf2)];}async[a304_0x1450d9(0x118)](){const _0x4ac8f5=a304_0x1450d9;this[_0x4ac8f5(0xf5)]=await salesforce_1['AxiosInstanceUtils'][_0x4ac8f5(0x127)](new auth_manager_1[(_0x4ac8f5(0x124))](this[_0x4ac8f5(0x10b)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x4ac8f5(0x107)]=await salesforce_1[_0x4ac8f5(0x116)][_0x4ac8f5(0x127)](new auth_manager_1[(_0x4ac8f5(0x124))](this[_0x4ac8f5(0x104)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async['initMetadataLogger'](){const _0x2d47ea=a304_0x1450d9;this[_0x2d47ea(0x13a)]=new metadata_logger_1[(_0x2d47ea(0x135))]({'apiVersion':this[_0x2d47ea(0x143)],'instance':this[_0x2d47ea(0xf5)],'targetOrgId':this[_0x2d47ea(0x13e)],'trackingSettingId':this[_0x2d47ea(0x12e)],'startDate':this[_0x2d47ea(0x108)]}),this[_0x2d47ea(0x12b)]=await this[_0x2d47ea(0x13a)][_0x2d47ea(0xf4)]();}[a304_0x1450d9(0x12a)](){const _0x348635=a304_0x1450d9;this[_0x348635(0x126)]=new logger_1[(_0x348635(0x13f))]({'systemLogger':systemLogger,'apiVersion':this['apiVersion'],'instance':this[_0x348635(0xf5)],'metadataLogId':this[_0x348635(0x12b)],'timeZone':this['timeZone']});}[a304_0x1450d9(0x131)](){const _0x990769=a304_0x1450d9;return new source_member_retriever_1['SourceMemberRetriever']({'apiVersion':this[_0x990769(0x143)],'instance':this[_0x990769(0x107)],'logger':this['logger'],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0x990769(0x108)],'metadataTypes':this[_0x990769(0x111)]});}[a304_0x1450d9(0xec)](){const _0x14776c=a304_0x1450d9;return new source_member_handler_1['SourceMemberHandler']({'instance':this[_0x14776c(0xf5)],'apiVersion':this[_0x14776c(0x143)],'logger':this[_0x14776c(0x126)],'targetOrgId':this[_0x14776c(0x13e)]});}[a304_0x1450d9(0x140)](){const _0x3a0604=a304_0x1450d9;return new metadata_retriever_1[(_0x3a0604(0xf9))]({'instance':this['targetInstance'],'apiVersion':this['apiVersion'],'logger':this[_0x3a0604(0x126)],'metadataTypes':this['metadataTypes']});}['getComponentsDeployer'](){const _0x56225e=a304_0x1450d9;return new components_deployer_1['ComponentsDeployer']({'instance':this[_0x56225e(0xf5)],'logger':this['logger'],'apiVersion':this[_0x56225e(0x143)],'targetOrgId':this[_0x56225e(0x13e)],'trackingSettingId':this[_0x56225e(0x12e)]});}[a304_0x1450d9(0x113)](){const _0x2092a6=a304_0x1450d9;return{'attributes':{'type':constants_1['FLOSUM_NAMESPACE']+_0x2092a6(0x11b)},'Id':this[_0x2092a6(0x12e)],[constants_1[_0x2092a6(0x110)]+'Is_Processed__c']:![],[constants_1[_0x2092a6(0x110)]+'Last_Start_Retrieval__c']:this[_0x2092a6(0x108)]};}async[a304_0x1450d9(0x112)](){const _0x2c86dc=a304_0x1450d9,_0x33eb8f=this[_0x2c86dc(0x113)](),_0x1183eb=new salesforce_1[(_0x2c86dc(0x144))]({'instance':this['flosumInstance'],'objectName':constants_1[_0x2c86dc(0x110)]+_0x2c86dc(0x11b),'api':this[_0x2c86dc(0x143)],'allOrNone':![],'externalIdField':'Id'}),_0x4a9f6b=await _0x1183eb['execute']({'records':[_0x33eb8f]}),_0x1b43bf=_0x4a9f6b['at'](0x0);(_0x1b43bf===null||_0x1b43bf===void 0x0?void 0x0:_0x1b43bf[_0x2c86dc(0x138)])?this['logger'][_0x2c86dc(0x11c)](_0x2c86dc(0xf0)):this['logger']['log'](_0x2c86dc(0xf3)+(_0x1b43bf===null||_0x1b43bf===void 0x0?void 0x0:_0x1b43bf[_0x2c86dc(0x121)]));}async['execute'](){const _0x148169=a304_0x1450d9;await this[_0x148169(0x120)](),this[_0x148169(0x108)]=new Date()[_0x148169(0xee)]();try{await this[_0x148169(0x118)](),await this[_0x148169(0x12d)](),this[_0x148169(0x12a)](),this[_0x148169(0x126)]['log'](_0x148169(0x133)+this[_0x148169(0x106)]),this[_0x148169(0x13a)]['status']=constants_2[_0x148169(0x128)][_0x148169(0x12f)],await this[_0x148169(0x13a)][_0x148169(0xf1)](),await this[_0x148169(0x126)][_0x148169(0xf1)]();const _0x37d624=this[_0x148169(0x131)](),_0x45ac03=this['getSourceMemberHandler'](),_0x49eb9c=this[_0x148169(0x140)](),_0x2c3dff=this[_0x148169(0x101)]();await(0x0,promises_1[_0x148169(0x115)])(_0x37d624,_0x45ac03,_0x49eb9c,_0x2c3dff),this[_0x148169(0x126)]['log'](_0x148169(0x109)),this[_0x148169(0x13a)][_0x148169(0x129)]=constants_2[_0x148169(0x128)][_0x148169(0xf8)];}catch(_0x33b5a4){this[_0x148169(0x126)][_0x148169(0x121)](_0x148169(0x114)),this['logger']['error'](_0x33b5a4[_0x148169(0x130)]),this[_0x148169(0x13a)][_0x148169(0x129)]=constants_2[_0x148169(0x128)][_0x148169(0x139)];}finally{await this['updateTrackingSetting'](),await this[_0x148169(0x126)][_0x148169(0xf1)](),await this[_0x148169(0x13a)][_0x148169(0xf1)]();}}}function a304_0x1553(){const _0x588e9c=['default','initMetadataLogger','trackingSettingId','IN_PROGRESS','message','getSourceMemberRetriever','search','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','exit','MetadataLogger','../../shared/managers/auth.manager','join','success','EXCEPTION','metadataLogger','Job','@flosum/salesforce','./classes/components.deployer','targetOrgId','Logger','getMetadataRetriever','toString','lastRetrieveDate','apiVersion','RestSimpleDeployData','495758AOmVJJ','(((.+)+)+)+$','1339784GjqYRu','getSourceMemberHandler','then','getTime','__esModule','Tracking\x20setting\x20updated','update','timeZone','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','init','flosumInstance','../../../core','./classes/logger/logger','COMPLETED','MetadataRetriever','jobStorePath','./classes/metadata.retriever','184869UIXezw','./classes/source-member.retriever','1770492mISkQO','5075400PnKezn','argv','getComponentsDeployer','parse','16WFHZlO','targetOrgCredentials','stream/promises','jobId','targetInstance','startDate','Tracking\x20components\x20job\x20has\x20been\x20completed','__importDefault','flosumOrgCredentials','minimist','apply','utf-8','slice','FLOSUM_NAMESPACE','metadataTypes','updateTrackingSetting','createTrackingSettingRecord','Tracking\x20components\x20job\x20has\x20been\x20failed','pipeline','AxiosInstanceUtils','MANIFEST_FILENAME','initInstances','./classes/metadata-logger','2721125gikXgu','Tracking_Setting__c','log','readFile','./classes/source-member.handler','path','initManifest','error','../../../constants','5631521PHgrDw','AuthManager','execute','logger','create','LogStatus','status','initLogger','metadataLogId'];a304_0x1553=function(){return _0x588e9c;};return a304_0x1553();}exports[a304_0x1450d9(0x13b)]=Job,new Job()[a304_0x1450d9(0x125)]()[a304_0x1450d9(0xed)](()=>process[a304_0x1450d9(0x134)](0x0))['catch'](_0xd980f7=>{const _0x54289c=a304_0x1450d9;systemLogger[_0x54289c(0x121)]('Job\x20Error:\x20'+_0xd980f7[_0x54289c(0x130)]),process['exit'](0x1);});