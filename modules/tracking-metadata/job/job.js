const a336_0x245613=a336_0x3f43;(function(_0xf248c0,_0x5dd3eb){const _0x45a6db=a336_0x3f43,_0x391d2e=_0xf248c0();while(!![]){try{const _0x419cd8=parseInt(_0x45a6db(0x11b))/0x1+parseInt(_0x45a6db(0x11a))/0x2*(-parseInt(_0x45a6db(0x115))/0x3)+-parseInt(_0x45a6db(0xf9))/0x4*(-parseInt(_0x45a6db(0x119))/0x5)+parseInt(_0x45a6db(0x10a))/0x6*(-parseInt(_0x45a6db(0xfd))/0x7)+-parseInt(_0x45a6db(0x121))/0x8*(-parseInt(_0x45a6db(0x105))/0x9)+parseInt(_0x45a6db(0xfc))/0xa+-parseInt(_0x45a6db(0x108))/0xb;if(_0x419cd8===_0x5dd3eb)break;else _0x391d2e['push'](_0x391d2e['shift']());}catch(_0x1fb6f8){_0x391d2e['push'](_0x391d2e['shift']());}}}(a336_0x2ed2,0xecc65));const a336_0x12a6cd=(function(){let _0xca95e4=!![];return function(_0x156b80,_0x23c497){const _0x31f867=_0xca95e4?function(){const _0x14e5ce=a336_0x3f43;if(_0x23c497){const _0x2a91b1=_0x23c497[_0x14e5ce(0x118)](_0x156b80,arguments);return _0x23c497=null,_0x2a91b1;}}:function(){};return _0xca95e4=![],_0x31f867;};}()),a336_0x20dc5c=a336_0x12a6cd(this,function(){const _0x242081=a336_0x3f43;return a336_0x20dc5c[_0x242081(0xda)]()['search'](_0x242081(0xe6))['toString']()[_0x242081(0xe4)](a336_0x20dc5c)[_0x242081(0xee)](_0x242081(0xe6));});a336_0x20dc5c();'use strict';var __importDefault=this&&this[a336_0x245613(0xf3)]||function(_0x2fea9d){const _0x10ae18=a336_0x245613;return _0x2fea9d&&_0x2fea9d[_0x10ae18(0xf5)]?_0x2fea9d:{'default':_0x2fea9d};};Object['defineProperty'](exports,a336_0x245613(0xf5),{'value':!![]}),exports[a336_0x245613(0x12a)]=void 0x0;function a336_0x3f43(_0xc7a50e,_0x1713ac){const _0x565170=a336_0x2ed2();return a336_0x3f43=function(_0x20dc5c,_0x12a6cd){_0x20dc5c=_0x20dc5c-0xcf;let _0x2ed2a5=_0x565170[_0x20dc5c];return _0x2ed2a5;},a336_0x3f43(_0xc7a50e,_0x1713ac);}const minimist_1=__importDefault(require(a336_0x245613(0xfa))),core_1=require(a336_0x245613(0x12f)),salesforce_1=require(a336_0x245613(0xe0)),auth_manager_1=require(a336_0x245613(0x10d)),logger_1=require('./classes/logger/logger'),promises_1=require(a336_0x245613(0x111)),promises_2=require(a336_0x245613(0x125)),path_1=__importDefault(require(a336_0x245613(0xd7))),metadata_retriever_1=require(a336_0x245613(0x126)),components_deployer_1=require(a336_0x245613(0x11f)),source_member_retriever_1=require(a336_0x245613(0x102)),source_member_handler_1=require(a336_0x245613(0xe2)),metadata_logger_1=require(a336_0x245613(0xfb)),job_1=require(a336_0x245613(0xde)),constants_1=require(a336_0x245613(0xcf)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1['default'])(process[a336_0x245613(0xe9)][a336_0x245613(0x113)](0x2)),systemLogger=new core_1[(a336_0x245613(0x10c))](jobId);class Job{constructor(){this['jobStorePath']=jobStorePath,this['jobId']=jobId;}async[a336_0x245613(0x12e)](){const _0x4b40ad=a336_0x245613,_0x2098a9=path_1['default'][_0x4b40ad(0x103)](this[_0x4b40ad(0x128)],job_1[_0x4b40ad(0x104)]),_0x21506c=await(0x0,promises_2['readFile'])(_0x2098a9,{'encoding':_0x4b40ad(0x124)})[_0x4b40ad(0xd3)](JSON[_0x4b40ad(0xd1)])['then'](({details:_0x20a637})=>_0x20a637);await(0x0,promises_2['rm'])(_0x2098a9,{'recursive':!![],'force':!![]}),this[_0x4b40ad(0x101)]=_0x21506c[_0x4b40ad(0x101)],this[_0x4b40ad(0x10f)]=_0x21506c[_0x4b40ad(0x10f)],this[_0x4b40ad(0xef)]=_0x21506c['targetOrgCredentials'],this[_0x4b40ad(0xf7)]=_0x21506c[_0x4b40ad(0xf7)],this['trackingSettingId']=_0x21506c[_0x4b40ad(0xd2)],this['lastRetrieveDate']=_0x21506c[_0x4b40ad(0x109)],this[_0x4b40ad(0x106)]=_0x21506c['metadataTypes'],this[_0x4b40ad(0x10e)]=_0x21506c[_0x4b40ad(0x10e)];}async[a336_0x245613(0xd5)](){const _0x28f299=a336_0x245613;this[_0x28f299(0xf0)]=await salesforce_1['AxiosInstanceUtils'][_0x28f299(0x11e)](new auth_manager_1[(_0x28f299(0xf8))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x28f299(0x127)]=await salesforce_1[_0x28f299(0xd8)][_0x28f299(0x11e)](new auth_manager_1[(_0x28f299(0xf8))](this[_0x28f299(0xef)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a336_0x245613(0xe3)](){const _0x1b3eb2=a336_0x245613;this[_0x1b3eb2(0xd6)]=new metadata_logger_1['MetadataLogger']({'apiVersion':this[_0x1b3eb2(0x101)],'instance':this[_0x1b3eb2(0xf0)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x1b3eb2(0xd2)],'startDate':this['startDate']}),this[_0x1b3eb2(0xdc)]=await this[_0x1b3eb2(0xd6)][_0x1b3eb2(0x112)]();}[a336_0x245613(0xd0)](){const _0x3e1b48=a336_0x245613;this['logger']=new logger_1['Logger']({'systemLogger':systemLogger,'apiVersion':this[_0x3e1b48(0x101)],'instance':this['flosumInstance'],'metadataLogId':this[_0x3e1b48(0xdc)],'timeZone':this['timeZone']});}[a336_0x245613(0xd9)](){const _0x3ae5b5=a336_0x245613;return new source_member_retriever_1[(_0x3ae5b5(0xe8))]({'apiVersion':this['apiVersion'],'instance':this[_0x3ae5b5(0x127)],'logger':this[_0x3ae5b5(0x11d)],'lastRetrieveDate':this[_0x3ae5b5(0x109)],'currentRetrieveDate':this['startDate'],'metadataTypes':this[_0x3ae5b5(0x106)]});}[a336_0x245613(0xec)](){const _0x2a0dfc=a336_0x245613;return new source_member_handler_1['SourceMemberHandler']({'instance':this[_0x2a0dfc(0xf0)],'apiVersion':this[_0x2a0dfc(0x101)],'logger':this[_0x2a0dfc(0x11d)],'targetOrgId':this[_0x2a0dfc(0xf7)]});}[a336_0x245613(0x12d)](){const _0x22cdc5=a336_0x245613;return new metadata_retriever_1[(_0x22cdc5(0xff))]({'instance':this['targetInstance'],'apiVersion':this[_0x22cdc5(0x101)],'logger':this[_0x22cdc5(0x11d)],'metadataTypes':this['metadataTypes']});}['getComponentsDeployer'](){const _0x2c5569=a336_0x245613;return new components_deployer_1[(_0x2c5569(0x123))]({'instance':this[_0x2c5569(0xf0)],'logger':this[_0x2c5569(0x11d)],'apiVersion':this[_0x2c5569(0x101)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x2c5569(0xd2)]});}[a336_0x245613(0x12b)](){const _0x356f13=a336_0x245613;return{'attributes':{'type':constants_1[_0x356f13(0xdd)]+_0x356f13(0xd4)},'Id':this[_0x356f13(0xd2)],[constants_1[_0x356f13(0xdd)]+_0x356f13(0xdb)]:![],[constants_1[_0x356f13(0xdd)]+_0x356f13(0x11c)]:this[_0x356f13(0x117)]};}async['updateTrackingSetting'](){const _0x479508=a336_0x245613,_0x4ad2f3=this[_0x479508(0x12b)](),_0x376650=new salesforce_1[(_0x479508(0xed))]({'instance':this[_0x479508(0xf0)],'objectName':constants_1[_0x479508(0xdd)]+_0x479508(0xd4),'api':this[_0x479508(0x101)],'allOrNone':![],'externalIdField':'Id'}),_0x4c86c2=await _0x376650[_0x479508(0x122)]({'records':[_0x4ad2f3]}),_0x13df80=_0x4c86c2['at'](0x0);(_0x13df80===null||_0x13df80===void 0x0?void 0x0:_0x13df80['success'])?this[_0x479508(0x11d)][_0x479508(0x12c)]('Tracking\x20setting\x20updated'):this['logger'][_0x479508(0x12c)](_0x479508(0xf4)+(_0x13df80===null||_0x13df80===void 0x0?void 0x0:_0x13df80[_0x479508(0x116)]));}async[a336_0x245613(0x122)](){const _0x3d9a8c=a336_0x245613;await this[_0x3d9a8c(0x12e)](),this['startDate']=new Date()[_0x3d9a8c(0xf1)]();try{await this['initInstances'](),await this[_0x3d9a8c(0xe3)](),this['initLogger'](),this[_0x3d9a8c(0x11d)]['log'](_0x3d9a8c(0xe1)+this[_0x3d9a8c(0x10b)]),this['metadataLogger'][_0x3d9a8c(0x107)]=constants_2['LogStatus'][_0x3d9a8c(0x129)],await this[_0x3d9a8c(0xd6)]['update'](),await this[_0x3d9a8c(0x11d)][_0x3d9a8c(0x120)]();const _0x2cbd3c=this[_0x3d9a8c(0xd9)](),_0x52ccf5=this[_0x3d9a8c(0xec)](),_0x1c855f=this[_0x3d9a8c(0x12d)](),_0x3ae156=this[_0x3d9a8c(0xea)]();await(0x0,promises_1[_0x3d9a8c(0x110)])(_0x2cbd3c,_0x52ccf5,_0x1c855f,_0x3ae156),this['logger'][_0x3d9a8c(0x12c)](_0x3d9a8c(0xdf)),this[_0x3d9a8c(0xd6)][_0x3d9a8c(0x107)]=constants_2['LogStatus'][_0x3d9a8c(0x114)];}catch(_0x262847){this[_0x3d9a8c(0x11d)]['error'](_0x3d9a8c(0xe5)),this[_0x3d9a8c(0x11d)][_0x3d9a8c(0x116)](_0x262847['message']),this[_0x3d9a8c(0xd6)][_0x3d9a8c(0x107)]=constants_2['LogStatus'][_0x3d9a8c(0xe7)];}finally{await this[_0x3d9a8c(0xf6)](),await this[_0x3d9a8c(0x11d)][_0x3d9a8c(0x120)](),await this[_0x3d9a8c(0xd6)][_0x3d9a8c(0x120)]();}}}exports[a336_0x245613(0x12a)]=Job,new Job()[a336_0x245613(0x122)]()[a336_0x245613(0xd3)](()=>process[a336_0x245613(0xf2)](0x0))[a336_0x245613(0xeb)](_0x4cdaa5=>{const _0x35d64c=a336_0x245613;systemLogger[_0x35d64c(0x116)](_0x35d64c(0x100)+_0x4cdaa5[_0x35d64c(0xfe)]),process['exit'](0x1);});function a336_0x2ed2(){const _0x5c36b4=['metadataTypes','status','28764593LfEBeh','lastRetrieveDate','318216BYToXu','jobId','Logger','../../shared/managers/auth.manager','timeZone','flosumOrgCredentials','pipeline','stream/promises','init','slice','COMPLETED','831804xOWacK','error','startDate','apply','1565wBbvFG','8vcYQZN','1350618ceIJgb','Last_Start_Retrieval__c','logger','create','./classes/components.deployer','update','40XPioOL','execute','ComponentsDeployer','utf-8','fs/promises','./classes/metadata.retriever','targetInstance','jobStorePath','IN_PROGRESS','Job','createTrackingSettingRecord','log','getMetadataRetriever','initManifest','../../../core','../../../constants','initLogger','parse','trackingSettingId','then','Tracking_Setting__c','initInstances','metadataLogger','path','AxiosInstanceUtils','getSourceMemberRetriever','toString','Is_Processed__c','metadataLogId','FLOSUM_NAMESPACE','../../../constants/job','Tracking\x20components\x20job\x20has\x20been\x20completed','@flosum/salesforce','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','./classes/source-member.handler','initMetadataLogger','constructor','Tracking\x20components\x20job\x20has\x20been\x20failed','(((.+)+)+)+$','EXCEPTION','SourceMemberRetriever','argv','getComponentsDeployer','catch','getSourceMemberHandler','RestSimpleDeployData','search','targetOrgCredentials','flosumInstance','getTime','exit','__importDefault','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','__esModule','updateTrackingSetting','targetOrgId','AuthManager','6204qxFQvC','minimist','./classes/metadata-logger','14647840mjZnRz','7BWPItI','message','MetadataRetriever','Job\x20Error:\x20','apiVersion','./classes/source-member.retriever','join','MANIFEST_FILENAME','2602863cOgOpo'];a336_0x2ed2=function(){return _0x5c36b4;};return a336_0x2ed2();}