const a303_0x4b9303=a303_0xcc1b;(function(_0x485b58,_0x2a9893){const _0xfbcd14=a303_0xcc1b,_0x542cda=_0x485b58();while(!![]){try{const _0x53e561=-parseInt(_0xfbcd14(0x127))/0x1+-parseInt(_0xfbcd14(0x11a))/0x2+-parseInt(_0xfbcd14(0x102))/0x3+-parseInt(_0xfbcd14(0x118))/0x4*(-parseInt(_0xfbcd14(0x121))/0x5)+-parseInt(_0xfbcd14(0x111))/0x6*(parseInt(_0xfbcd14(0x123))/0x7)+-parseInt(_0xfbcd14(0xe1))/0x8+parseInt(_0xfbcd14(0xf1))/0x9;if(_0x53e561===_0x2a9893)break;else _0x542cda['push'](_0x542cda['shift']());}catch(_0x578405){_0x542cda['push'](_0x542cda['shift']());}}}(a303_0x44c3,0x52cf1));const a303_0xe6cf6e=(function(){let _0x1ae1e0=!![];return function(_0x4c2350,_0x1cc07e){const _0x5930eb=_0x1ae1e0?function(){const _0x23d6af=a303_0xcc1b;if(_0x1cc07e){const _0x5e0afa=_0x1cc07e[_0x23d6af(0x11d)](_0x4c2350,arguments);return _0x1cc07e=null,_0x5e0afa;}}:function(){};return _0x1ae1e0=![],_0x5930eb;};}()),a303_0x59e8be=a303_0xe6cf6e(this,function(){const _0x365b49=a303_0xcc1b;return a303_0x59e8be[_0x365b49(0xe5)]()[_0x365b49(0xd8)](_0x365b49(0x114))[_0x365b49(0xe5)]()[_0x365b49(0xea)](a303_0x59e8be)[_0x365b49(0xd8)]('(((.+)+)+)+$');});a303_0x59e8be();'use strict';var __importDefault=this&&this[a303_0x4b9303(0x122)]||function(_0x5328ac){const _0x23e8ab=a303_0x4b9303;return _0x5328ac&&_0x5328ac[_0x23e8ab(0xf4)]?_0x5328ac:{'default':_0x5328ac};};Object[a303_0x4b9303(0x100)](exports,a303_0x4b9303(0xf4),{'value':!![]}),exports[a303_0x4b9303(0x128)]=void 0x0;const minimist_1=__importDefault(require('minimist')),core_1=require(a303_0x4b9303(0xed)),salesforce_1=require(a303_0x4b9303(0x10c)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a303_0x4b9303(0xd5)),promises_1=require(a303_0x4b9303(0xd7)),promises_2=require(a303_0x4b9303(0xfa)),path_1=__importDefault(require(a303_0x4b9303(0x12b))),metadata_retriever_1=require(a303_0x4b9303(0x10f)),components_deployer_1=require('./classes/components.deployer'),source_member_retriever_1=require('./classes/source-member.retriever'),source_member_handler_1=require(a303_0x4b9303(0xf2)),metadata_logger_1=require(a303_0x4b9303(0xd9)),job_1=require(a303_0x4b9303(0xe9)),constants_1=require(a303_0x4b9303(0x12a)),constants_2=require(a303_0x4b9303(0xe7)),{jobId,jobStorePath}=(0x0,minimist_1[a303_0x4b9303(0xe0)])(process[a303_0x4b9303(0xfe)][a303_0x4b9303(0xdc)](0x2)),systemLogger=new core_1[(a303_0x4b9303(0xf3))](jobId);function a303_0x44c3(){const _0x1312d0=['status','metadataTypes','AuthManager','then','Tracking_Setting__c','flosumInstance','@flosum/salesforce','MetadataLogger','jobId','./classes/metadata.retriever','targetOrgId','254754QkQhlv','initMetadataLogger','Job\x20Error:\x20','(((.+)+)+)+$','Is_Processed__c','timeZone','RestSimpleDeployData','44wpAXKb','getMetadataRetriever','802336eemXHD','create','EXCEPTION','apply','update','trackingSettingId','join','249070PbrnQX','__importDefault','35xcWNsd','initLogger','COMPLETED','flosumOrgCredentials','109408nvnWip','Job','initManifest','../../../constants','path','updateTrackingSetting','init','log','metadataLogger','metadataLogId','MetadataRetriever','exit','pipeline','Tracking\x20components\x20job\x20has\x20been\x20failed','./classes/logger/logger','logger','stream/promises','search','./classes/metadata-logger','targetInstance','error','slice','getTime','getComponentsDeployer','AxiosInstanceUtils','default','4159112epoDZt','createTrackingSettingRecord','startDate','message','toString','initInstances','../constants','FLOSUM_NAMESPACE','../../../constants/job','constructor','Tracking\x20components\x20job\x20has\x20been\x20completed','catch','../../../core','SourceMemberRetriever','ComponentsDeployer','apiVersion','10272213KXOEdS','./classes/source-member.handler','Logger','__esModule','execute','jobStorePath','targetOrgCredentials','Last_Start_Retrieval__c','getSourceMemberRetriever','fs/promises','success','IN_PROGRESS','readFile','argv','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','defineProperty','Tracking\x20setting\x20updated','322098BtqfKe','MANIFEST_FILENAME','LogStatus','lastRetrieveDate'];a303_0x44c3=function(){return _0x1312d0;};return a303_0x44c3();}class Job{constructor(){const _0x3964f=a303_0x4b9303;this[_0x3964f(0xf6)]=jobStorePath,this[_0x3964f(0x10e)]=jobId;}async[a303_0x4b9303(0x129)](){const _0x8f2bbd=a303_0x4b9303,_0x3e1852=path_1[_0x8f2bbd(0xe0)][_0x8f2bbd(0x120)](this[_0x8f2bbd(0xf6)],job_1[_0x8f2bbd(0x103)]),_0x34c6bd=await(0x0,promises_2[_0x8f2bbd(0xfd)])(_0x3e1852,{'encoding':'utf-8'})[_0x8f2bbd(0x109)](JSON['parse'])[_0x8f2bbd(0x109)](({details:_0x37d3d0})=>_0x37d3d0);await(0x0,promises_2['rm'])(_0x3e1852,{'recursive':!![],'force':!![]}),this[_0x8f2bbd(0xf0)]=_0x34c6bd['apiVersion'],this[_0x8f2bbd(0x126)]=_0x34c6bd[_0x8f2bbd(0x126)],this[_0x8f2bbd(0xf7)]=_0x34c6bd['targetOrgCredentials'],this[_0x8f2bbd(0x110)]=_0x34c6bd['targetOrgId'],this[_0x8f2bbd(0x11f)]=_0x34c6bd[_0x8f2bbd(0x11f)],this[_0x8f2bbd(0x105)]=_0x34c6bd['lastRetrieveDate'],this['metadataTypes']=_0x34c6bd['metadataTypes'],this[_0x8f2bbd(0x116)]=_0x34c6bd[_0x8f2bbd(0x116)];}async[a303_0x4b9303(0xe6)](){const _0x313ed5=a303_0x4b9303;this['flosumInstance']=await salesforce_1[_0x313ed5(0xdf)][_0x313ed5(0x11b)](new auth_manager_1['AuthManager'](this[_0x313ed5(0x126)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x313ed5(0xda)]=await salesforce_1[_0x313ed5(0xdf)]['create'](new auth_manager_1[(_0x313ed5(0x108))](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a303_0x4b9303(0x112)](){const _0x1ff029=a303_0x4b9303;this[_0x1ff029(0xcf)]=new metadata_logger_1[(_0x1ff029(0x10d))]({'apiVersion':this[_0x1ff029(0xf0)],'instance':this['flosumInstance'],'targetOrgId':this[_0x1ff029(0x110)],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0x1ff029(0xe3)]}),this[_0x1ff029(0xd0)]=await this[_0x1ff029(0xcf)][_0x1ff029(0xcd)]();}[a303_0x4b9303(0x124)](){const _0x5e1e51=a303_0x4b9303;this[_0x5e1e51(0xd6)]=new logger_1[(_0x5e1e51(0xf3))]({'systemLogger':systemLogger,'apiVersion':this[_0x5e1e51(0xf0)],'instance':this[_0x5e1e51(0x10b)],'metadataLogId':this[_0x5e1e51(0xd0)],'timeZone':this[_0x5e1e51(0x116)]});}[a303_0x4b9303(0xf9)](){const _0x4c4f09=a303_0x4b9303;return new source_member_retriever_1[(_0x4c4f09(0xee))]({'apiVersion':this[_0x4c4f09(0xf0)],'instance':this[_0x4c4f09(0xda)],'logger':this['logger'],'lastRetrieveDate':this[_0x4c4f09(0x105)],'currentRetrieveDate':this[_0x4c4f09(0xe3)],'metadataTypes':this[_0x4c4f09(0x107)]});}['getSourceMemberHandler'](){const _0x263722=a303_0x4b9303;return new source_member_handler_1['SourceMemberHandler']({'instance':this[_0x263722(0x10b)],'apiVersion':this[_0x263722(0xf0)],'logger':this[_0x263722(0xd6)],'targetOrgId':this['targetOrgId']});}['getMetadataRetriever'](){const _0x5f5c67=a303_0x4b9303;return new metadata_retriever_1[(_0x5f5c67(0xd1))]({'instance':this['targetInstance'],'apiVersion':this[_0x5f5c67(0xf0)],'logger':this[_0x5f5c67(0xd6)],'metadataTypes':this[_0x5f5c67(0x107)]});}['getComponentsDeployer'](){const _0x45409f=a303_0x4b9303;return new components_deployer_1[(_0x45409f(0xef))]({'instance':this['flosumInstance'],'logger':this[_0x45409f(0xd6)],'apiVersion':this['apiVersion'],'targetOrgId':this[_0x45409f(0x110)],'trackingSettingId':this[_0x45409f(0x11f)]});}[a303_0x4b9303(0xe2)](){const _0x47d678=a303_0x4b9303;return{'attributes':{'type':constants_1['FLOSUM_NAMESPACE']+_0x47d678(0x10a)},'Id':this[_0x47d678(0x11f)],[constants_1[_0x47d678(0xe8)]+_0x47d678(0x115)]:![],[constants_1[_0x47d678(0xe8)]+_0x47d678(0xf8)]:this[_0x47d678(0xe3)]};}async[a303_0x4b9303(0xcc)](){const _0x1941a2=a303_0x4b9303,_0x1297b4=this[_0x1941a2(0xe2)](),_0x2f87f=new salesforce_1[(_0x1941a2(0x117))]({'instance':this[_0x1941a2(0x10b)],'objectName':constants_1[_0x1941a2(0xe8)]+_0x1941a2(0x10a),'api':this[_0x1941a2(0xf0)],'allOrNone':![],'externalIdField':'Id'}),_0xc6a251=await _0x2f87f[_0x1941a2(0xf5)]({'records':[_0x1297b4]}),_0x416496=_0xc6a251['at'](0x0);(_0x416496===null||_0x416496===void 0x0?void 0x0:_0x416496[_0x1941a2(0xfb)])?this[_0x1941a2(0xd6)][_0x1941a2(0xce)](_0x1941a2(0x101)):this[_0x1941a2(0xd6)]['log'](_0x1941a2(0xff)+(_0x416496===null||_0x416496===void 0x0?void 0x0:_0x416496[_0x1941a2(0xdb)]));}async[a303_0x4b9303(0xf5)](){const _0x10faea=a303_0x4b9303;await this[_0x10faea(0x129)](),this[_0x10faea(0xe3)]=new Date()[_0x10faea(0xdd)]();try{await this[_0x10faea(0xe6)](),await this[_0x10faea(0x112)](),this[_0x10faea(0x124)](),this['logger'][_0x10faea(0xce)]('Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20'+this[_0x10faea(0x10e)]),this['metadataLogger']['status']=constants_2['LogStatus'][_0x10faea(0xfc)],await this[_0x10faea(0xcf)][_0x10faea(0x11e)](),await this[_0x10faea(0xd6)][_0x10faea(0x11e)]();const _0x974b33=this[_0x10faea(0xf9)](),_0x472c27=this['getSourceMemberHandler'](),_0x419ff0=this[_0x10faea(0x119)](),_0x2fc37f=this[_0x10faea(0xde)]();await(0x0,promises_1[_0x10faea(0xd3)])(_0x974b33,_0x472c27,_0x419ff0,_0x2fc37f),this[_0x10faea(0xd6)][_0x10faea(0xce)](_0x10faea(0xeb)),this[_0x10faea(0xcf)][_0x10faea(0x106)]=constants_2[_0x10faea(0x104)][_0x10faea(0x125)];}catch(_0x7c1fee){this[_0x10faea(0xd6)][_0x10faea(0xdb)](_0x10faea(0xd4)),this[_0x10faea(0xd6)][_0x10faea(0xdb)](_0x7c1fee[_0x10faea(0xe4)]),this['metadataLogger'][_0x10faea(0x106)]=constants_2[_0x10faea(0x104)][_0x10faea(0x11c)];}finally{await this[_0x10faea(0xcc)](),await this[_0x10faea(0xd6)][_0x10faea(0x11e)](),await this[_0x10faea(0xcf)][_0x10faea(0x11e)]();}}}function a303_0xcc1b(_0x1e29be,_0x367466){const _0x4eb6ab=a303_0x44c3();return a303_0xcc1b=function(_0x59e8be,_0xe6cf6e){_0x59e8be=_0x59e8be-0xcc;let _0x44c359=_0x4eb6ab[_0x59e8be];return _0x44c359;},a303_0xcc1b(_0x1e29be,_0x367466);}exports[a303_0x4b9303(0x128)]=Job,new Job()[a303_0x4b9303(0xf5)]()['then'](()=>process[a303_0x4b9303(0xd2)](0x0))[a303_0x4b9303(0xec)](_0x2d8e12=>{const _0x1ec2ef=a303_0x4b9303;systemLogger['error'](_0x1ec2ef(0x113)+_0x2d8e12[_0x1ec2ef(0xe4)]),process[_0x1ec2ef(0xd2)](0x1);});