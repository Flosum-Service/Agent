const a304_0x298474=a304_0x2261;(function(_0x11f3f6,_0x3b42dd){const _0x4fbf6c=a304_0x2261,_0x58797f=_0x11f3f6();while(!![]){try{const _0x41ff49=-parseInt(_0x4fbf6c(0x13e))/0x1+-parseInt(_0x4fbf6c(0x143))/0x2*(-parseInt(_0x4fbf6c(0x108))/0x3)+parseInt(_0x4fbf6c(0x141))/0x4+-parseInt(_0x4fbf6c(0x10f))/0x5*(parseInt(_0x4fbf6c(0x151))/0x6)+parseInt(_0x4fbf6c(0x12d))/0x7*(parseInt(_0x4fbf6c(0x109))/0x8)+parseInt(_0x4fbf6c(0x153))/0x9+parseInt(_0x4fbf6c(0x14e))/0xa*(-parseInt(_0x4fbf6c(0x118))/0xb);if(_0x41ff49===_0x3b42dd)break;else _0x58797f['push'](_0x58797f['shift']());}catch(_0x2268df){_0x58797f['push'](_0x58797f['shift']());}}}(a304_0x3905,0xb8485));const a304_0x222094=(function(){let _0x594e38=!![];return function(_0x3ae6b6,_0x6a1f74){const _0x27d198=_0x594e38?function(){if(_0x6a1f74){const _0x1a5596=_0x6a1f74['apply'](_0x3ae6b6,arguments);return _0x6a1f74=null,_0x1a5596;}}:function(){};return _0x594e38=![],_0x27d198;};}()),a304_0x45887e=a304_0x222094(this,function(){const _0x1795d0=a304_0x2261;return a304_0x45887e[_0x1795d0(0x126)]()['search'](_0x1795d0(0x102))['toString']()[_0x1795d0(0x106)](a304_0x45887e)['search'](_0x1795d0(0x102));});a304_0x45887e();'use strict';var __importDefault=this&&this[a304_0x298474(0x13f)]||function(_0x55fc1a){return _0x55fc1a&&_0x55fc1a['__esModule']?_0x55fc1a:{'default':_0x55fc1a};};Object['defineProperty'](exports,a304_0x298474(0x134),{'value':!![]}),exports['Job']=void 0x0;function a304_0x3905(){const _0xb02840=['path','getSourceMemberHandler','619979ODoxwO','__importDefault','logger','3956192tWbrEs','initInstances','2662578GSSprS','Last_Start_Retrieval__c','catch','join','error','jobStorePath','../../shared/managers/auth.manager','timeZone','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','getTime','minimist','10GatbeL','Tracking\x20components\x20job\x20has\x20been\x20completed','./classes/logger/logger','12sNZdsV','startDate','1342998MNCerI','pipeline','COMPLETED','lastRetrieveDate','init','Job\x20Error:\x20','execute','../../../constants','trackingSettingId','fs/promises','./classes/source-member.retriever','create','updateTrackingSetting','(((.+)+)+)+$','utf-8','flosumInstance','exit','constructor','Tracking_Setting__c','3qkHXqG','479624mEYPfd','getComponentsDeployer','initManifest','metadataLogId','SourceMemberRetriever','targetOrgCredentials','993670grHDpE','log','Job','metadataTypes','Is_Processed__c','IN_PROGRESS','../constants','update','../../../core','23497793TlbYhV','./classes/metadata-logger','slice','@flosum/salesforce','MANIFEST_FILENAME','getMetadataRetriever','LogStatus','metadataLogger','success','then','createTrackingSettingRecord','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','AuthManager','default','toString','./classes/components.deployer','FLOSUM_NAMESPACE','flosumOrgCredentials','Tracking\x20setting\x20updated','targetInstance','argv','168IPFUkn','initLogger','Logger','status','targetOrgId','message','AxiosInstanceUtils','__esModule','apiVersion','MetadataLogger','ComponentsDeployer','./classes/source-member.handler','MetadataRetriever','SourceMemberHandler','initMetadataLogger'];a304_0x3905=function(){return _0xb02840;};return a304_0x3905();}const minimist_1=__importDefault(require(a304_0x298474(0x14d))),core_1=require(a304_0x298474(0x117)),salesforce_1=require(a304_0x298474(0x11b)),auth_manager_1=require(a304_0x298474(0x149)),logger_1=require(a304_0x298474(0x150)),promises_1=require('stream/promises'),promises_2=require(a304_0x298474(0x15c)),path_1=__importDefault(require(a304_0x298474(0x13c))),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a304_0x298474(0x127)),source_member_retriever_1=require(a304_0x298474(0x15d)),source_member_handler_1=require(a304_0x298474(0x138)),metadata_logger_1=require(a304_0x298474(0x119)),job_1=require('../../../constants/job'),constants_1=require(a304_0x298474(0x15a)),constants_2=require(a304_0x298474(0x115)),{jobId,jobStorePath}=(0x0,minimist_1[a304_0x298474(0x125)])(process[a304_0x298474(0x12c)][a304_0x298474(0x11a)](0x2)),systemLogger=new core_1[(a304_0x298474(0x12f))](jobId);class Job{constructor(){const _0x3db6b0=a304_0x298474;this[_0x3db6b0(0x148)]=jobStorePath,this['jobId']=jobId;}async[a304_0x298474(0x10b)](){const _0x9673f0=a304_0x298474,_0x5ca3b1=path_1[_0x9673f0(0x125)][_0x9673f0(0x146)](this[_0x9673f0(0x148)],job_1[_0x9673f0(0x11c)]),_0x3ac8b0=await(0x0,promises_2['readFile'])(_0x5ca3b1,{'encoding':_0x9673f0(0x103)})['then'](JSON['parse'])[_0x9673f0(0x121)](({details:_0xbf881d})=>_0xbf881d);await(0x0,promises_2['rm'])(_0x5ca3b1,{'recursive':!![],'force':!![]}),this[_0x9673f0(0x135)]=_0x3ac8b0[_0x9673f0(0x135)],this[_0x9673f0(0x129)]=_0x3ac8b0['flosumOrgCredentials'],this[_0x9673f0(0x10e)]=_0x3ac8b0[_0x9673f0(0x10e)],this[_0x9673f0(0x131)]=_0x3ac8b0[_0x9673f0(0x131)],this[_0x9673f0(0x15b)]=_0x3ac8b0[_0x9673f0(0x15b)],this[_0x9673f0(0x156)]=_0x3ac8b0[_0x9673f0(0x156)],this[_0x9673f0(0x112)]=_0x3ac8b0[_0x9673f0(0x112)],this[_0x9673f0(0x14a)]=_0x3ac8b0['timeZone'];}async[a304_0x298474(0x142)](){const _0x335cfc=a304_0x298474;this['flosumInstance']=await salesforce_1[_0x335cfc(0x133)]['create'](new auth_manager_1[(_0x335cfc(0x124))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x335cfc(0x12b)]=await salesforce_1[_0x335cfc(0x133)][_0x335cfc(0x15e)](new auth_manager_1['AuthManager'](this[_0x335cfc(0x10e)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a304_0x298474(0x13b)](){const _0x5dac84=a304_0x298474;this[_0x5dac84(0x11f)]=new metadata_logger_1[(_0x5dac84(0x136))]({'apiVersion':this[_0x5dac84(0x135)],'instance':this[_0x5dac84(0x104)],'targetOrgId':this[_0x5dac84(0x131)],'trackingSettingId':this[_0x5dac84(0x15b)],'startDate':this['startDate']}),this['metadataLogId']=await this[_0x5dac84(0x11f)][_0x5dac84(0x157)]();}[a304_0x298474(0x12e)](){const _0x290f20=a304_0x298474;this[_0x290f20(0x140)]=new logger_1[(_0x290f20(0x12f))]({'systemLogger':systemLogger,'apiVersion':this['apiVersion'],'instance':this[_0x290f20(0x104)],'metadataLogId':this[_0x290f20(0x10c)],'timeZone':this[_0x290f20(0x14a)]});}['getSourceMemberRetriever'](){const _0x1f2153=a304_0x298474;return new source_member_retriever_1[(_0x1f2153(0x10d))]({'apiVersion':this[_0x1f2153(0x135)],'instance':this['targetInstance'],'logger':this[_0x1f2153(0x140)],'lastRetrieveDate':this[_0x1f2153(0x156)],'currentRetrieveDate':this[_0x1f2153(0x152)],'metadataTypes':this[_0x1f2153(0x112)]});}[a304_0x298474(0x13d)](){const _0x3b321a=a304_0x298474;return new source_member_handler_1[(_0x3b321a(0x13a))]({'instance':this[_0x3b321a(0x104)],'apiVersion':this[_0x3b321a(0x135)],'logger':this[_0x3b321a(0x140)],'targetOrgId':this[_0x3b321a(0x131)]});}[a304_0x298474(0x11d)](){const _0x34ca79=a304_0x298474;return new metadata_retriever_1[(_0x34ca79(0x139))]({'instance':this['targetInstance'],'apiVersion':this[_0x34ca79(0x135)],'logger':this[_0x34ca79(0x140)],'metadataTypes':this[_0x34ca79(0x112)]});}[a304_0x298474(0x10a)](){const _0x41ec0e=a304_0x298474;return new components_deployer_1[(_0x41ec0e(0x137))]({'instance':this[_0x41ec0e(0x104)],'logger':this[_0x41ec0e(0x140)],'apiVersion':this[_0x41ec0e(0x135)],'targetOrgId':this[_0x41ec0e(0x131)],'trackingSettingId':this[_0x41ec0e(0x15b)]});}[a304_0x298474(0x122)](){const _0x5ccebf=a304_0x298474;return{'attributes':{'type':constants_1[_0x5ccebf(0x128)]+_0x5ccebf(0x107)},'Id':this[_0x5ccebf(0x15b)],[constants_1[_0x5ccebf(0x128)]+_0x5ccebf(0x113)]:![],[constants_1[_0x5ccebf(0x128)]+_0x5ccebf(0x144)]:this['startDate']};}async[a304_0x298474(0x15f)](){const _0x419229=a304_0x298474,_0x57d255=this[_0x419229(0x122)](),_0x1dd21d=new salesforce_1['RestSimpleDeployData']({'instance':this[_0x419229(0x104)],'objectName':constants_1['FLOSUM_NAMESPACE']+_0x419229(0x107),'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'}),_0x268d37=await _0x1dd21d[_0x419229(0x159)]({'records':[_0x57d255]}),_0x596b99=_0x268d37['at'](0x0);(_0x596b99===null||_0x596b99===void 0x0?void 0x0:_0x596b99[_0x419229(0x120)])?this[_0x419229(0x140)][_0x419229(0x110)](_0x419229(0x12a)):this['logger'][_0x419229(0x110)](_0x419229(0x14b)+(_0x596b99===null||_0x596b99===void 0x0?void 0x0:_0x596b99['error']));}async[a304_0x298474(0x159)](){const _0x51cd9b=a304_0x298474;await this[_0x51cd9b(0x10b)](),this[_0x51cd9b(0x152)]=new Date()[_0x51cd9b(0x14c)]();try{await this[_0x51cd9b(0x142)](),await this[_0x51cd9b(0x13b)](),this[_0x51cd9b(0x12e)](),this[_0x51cd9b(0x140)][_0x51cd9b(0x110)](_0x51cd9b(0x123)+this['jobId']),this['metadataLogger'][_0x51cd9b(0x130)]=constants_2[_0x51cd9b(0x11e)][_0x51cd9b(0x114)],await this[_0x51cd9b(0x11f)][_0x51cd9b(0x116)](),await this[_0x51cd9b(0x140)][_0x51cd9b(0x116)]();const _0x499be1=this['getSourceMemberRetriever'](),_0x1e42a8=this[_0x51cd9b(0x13d)](),_0x5a3cb8=this[_0x51cd9b(0x11d)](),_0x504120=this[_0x51cd9b(0x10a)]();await(0x0,promises_1[_0x51cd9b(0x154)])(_0x499be1,_0x1e42a8,_0x5a3cb8,_0x504120),this[_0x51cd9b(0x140)][_0x51cd9b(0x110)](_0x51cd9b(0x14f)),this['metadataLogger']['status']=constants_2[_0x51cd9b(0x11e)][_0x51cd9b(0x155)];}catch(_0xa658a4){this[_0x51cd9b(0x140)][_0x51cd9b(0x147)]('Tracking\x20components\x20job\x20has\x20been\x20failed'),this[_0x51cd9b(0x140)][_0x51cd9b(0x147)](_0xa658a4[_0x51cd9b(0x132)]),this[_0x51cd9b(0x11f)]['status']=constants_2['LogStatus']['EXCEPTION'];}finally{await this[_0x51cd9b(0x15f)](),await this['logger']['update'](),await this['metadataLogger'][_0x51cd9b(0x116)]();}}}function a304_0x2261(_0x16c611,_0xb778f6){const _0x11ad16=a304_0x3905();return a304_0x2261=function(_0x45887e,_0x222094){_0x45887e=_0x45887e-0x102;let _0x390522=_0x11ad16[_0x45887e];return _0x390522;},a304_0x2261(_0x16c611,_0xb778f6);}exports[a304_0x298474(0x111)]=Job,new Job()[a304_0x298474(0x159)]()[a304_0x298474(0x121)](()=>process[a304_0x298474(0x105)](0x0))[a304_0x298474(0x145)](_0x4c9606=>{const _0x425ba9=a304_0x298474;systemLogger[_0x425ba9(0x147)](_0x425ba9(0x158)+_0x4c9606[_0x425ba9(0x132)]),process[_0x425ba9(0x105)](0x1);});