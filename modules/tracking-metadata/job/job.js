const a347_0x493e88=a347_0x174d;(function(_0x7c569f,_0x54df9d){const _0x44e89b=a347_0x174d,_0x121554=_0x7c569f();while(!![]){try{const _0x4fb0fb=parseInt(_0x44e89b(0x1cf))/0x1+parseInt(_0x44e89b(0x1c3))/0x2*(parseInt(_0x44e89b(0x19d))/0x3)+parseInt(_0x44e89b(0x1cc))/0x4*(-parseInt(_0x44e89b(0x1a4))/0x5)+-parseInt(_0x44e89b(0x1a7))/0x6+parseInt(_0x44e89b(0x19c))/0x7*(parseInt(_0x44e89b(0x1d5))/0x8)+parseInt(_0x44e89b(0x1de))/0x9+-parseInt(_0x44e89b(0x1a2))/0xa*(parseInt(_0x44e89b(0x1b0))/0xb);if(_0x4fb0fb===_0x54df9d)break;else _0x121554['push'](_0x121554['shift']());}catch(_0x193062){_0x121554['push'](_0x121554['shift']());}}}(a347_0x3a8d,0x6a196));function a347_0x174d(_0x164d3a,_0x5ad40e){const _0x31a914=a347_0x3a8d();return a347_0x174d=function(_0x33dc2f,_0xfdc9e5){_0x33dc2f=_0x33dc2f-0x188;let _0x3a8dc2=_0x31a914[_0x33dc2f];return _0x3a8dc2;},a347_0x174d(_0x164d3a,_0x5ad40e);}const a347_0xfdc9e5=(function(){let _0x4cfc89=!![];return function(_0x14d81d,_0x24cdee){const _0xb8df10=_0x4cfc89?function(){const _0x190274=a347_0x174d;if(_0x24cdee){const _0x240bf2=_0x24cdee[_0x190274(0x1bf)](_0x14d81d,arguments);return _0x24cdee=null,_0x240bf2;}}:function(){};return _0x4cfc89=![],_0xb8df10;};}()),a347_0x33dc2f=a347_0xfdc9e5(this,function(){const _0x4afa0a=a347_0x174d;return a347_0x33dc2f['toString']()[_0x4afa0a(0x18c)](_0x4afa0a(0x1a6))[_0x4afa0a(0x1df)]()['constructor'](a347_0x33dc2f)[_0x4afa0a(0x18c)](_0x4afa0a(0x1a6));});a347_0x33dc2f();'use strict';var __importDefault=this&&this[a347_0x493e88(0x1d1)]||function(_0x200f85){return _0x200f85&&_0x200f85['__esModule']?_0x200f85:{'default':_0x200f85};};Object[a347_0x493e88(0x1c2)](exports,a347_0x493e88(0x1ae),{'value':!![]}),exports[a347_0x493e88(0x190)]=void 0x0;const minimist_1=__importDefault(require(a347_0x493e88(0x1d7))),core_1=require('../../../core'),salesforce_1=require(a347_0x493e88(0x18b)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a347_0x493e88(0x1b8)),promises_1=require('stream/promises'),promises_2=require('fs/promises'),path_1=__importDefault(require('path')),metadata_retriever_1=require(a347_0x493e88(0x19e)),components_deployer_1=require(a347_0x493e88(0x1ca)),source_member_retriever_1=require(a347_0x493e88(0x1aa)),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require('./classes/metadata-logger'),job_1=require(a347_0x493e88(0x1b6)),constants_1=require(a347_0x493e88(0x1db)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1[a347_0x493e88(0x194)])(process[a347_0x493e88(0x1a1)][a347_0x493e88(0x1d9)](0x2)),systemLogger=new core_1['Logger'](jobId);class Job{constructor(){const _0x10e1ad=a347_0x493e88;this[_0x10e1ad(0x199)]=jobStorePath,this[_0x10e1ad(0x1af)]=jobId;}async['initManifest'](){const _0xfd1036=a347_0x493e88,_0x31086e=path_1['default'][_0xfd1036(0x18a)](this[_0xfd1036(0x199)],job_1[_0xfd1036(0x1ab)]),_0x304fce=await(0x0,promises_2['readFile'])(_0x31086e,{'encoding':'utf-8'})[_0xfd1036(0x198)](JSON[_0xfd1036(0x1d6)])[_0xfd1036(0x198)](({details:_0xb388b7})=>_0xb388b7);await(0x0,promises_2['rm'])(_0x31086e,{'recursive':!![],'force':!![]}),this[_0xfd1036(0x1d8)]=_0x304fce[_0xfd1036(0x1d8)],this['flosumOrgCredentials']=_0x304fce['flosumOrgCredentials'],this[_0xfd1036(0x19a)]=_0x304fce['targetOrgCredentials'],this[_0xfd1036(0x1be)]=_0x304fce[_0xfd1036(0x1be)],this[_0xfd1036(0x1c1)]=_0x304fce[_0xfd1036(0x1c1)],this[_0xfd1036(0x1c5)]=_0x304fce[_0xfd1036(0x1c5)],this[_0xfd1036(0x1da)]=_0x304fce[_0xfd1036(0x1da)],this[_0xfd1036(0x188)]=_0x304fce['timeZone'];}async[a347_0x493e88(0x193)](){const _0x5b74d1=a347_0x493e88;this[_0x5b74d1(0x1cb)]=await salesforce_1[_0x5b74d1(0x1a5)][_0x5b74d1(0x1a0)](new auth_manager_1[(_0x5b74d1(0x1d2))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x5b74d1(0x1b1)]=await salesforce_1[_0x5b74d1(0x1a5)]['create'](new auth_manager_1[(_0x5b74d1(0x1d2))](this[_0x5b74d1(0x19a)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a347_0x493e88(0x1e0)](){const _0x188866=a347_0x493e88;this[_0x188866(0x1ac)]=new metadata_logger_1[(_0x188866(0x197))]({'apiVersion':this[_0x188866(0x1d8)],'instance':this['flosumInstance'],'targetOrgId':this[_0x188866(0x1be)],'trackingSettingId':this[_0x188866(0x1c1)],'startDate':this['startDate']}),this[_0x188866(0x1c7)]=await this[_0x188866(0x1ac)]['init']();}['initLogger'](){const _0x312230=a347_0x493e88;this['logger']=new logger_1[(_0x312230(0x1bd))]({'systemLogger':systemLogger,'apiVersion':this[_0x312230(0x1d8)],'instance':this[_0x312230(0x1cb)],'metadataLogId':this[_0x312230(0x1c7)],'timeZone':this['timeZone']});}[a347_0x493e88(0x1bb)](){const _0x392e20=a347_0x493e88;return new source_member_retriever_1[(_0x392e20(0x1b2))]({'apiVersion':this['apiVersion'],'instance':this[_0x392e20(0x1b1)],'logger':this[_0x392e20(0x19f)],'lastRetrieveDate':this[_0x392e20(0x1c5)],'currentRetrieveDate':this[_0x392e20(0x18e)],'metadataTypes':this[_0x392e20(0x1da)]});}[a347_0x493e88(0x1bc)](){const _0x192446=a347_0x493e88;return new source_member_handler_1[(_0x192446(0x189))]({'instance':this['flosumInstance'],'apiVersion':this[_0x192446(0x1d8)],'logger':this['logger'],'targetOrgId':this[_0x192446(0x1be)]});}[a347_0x493e88(0x1ba)](){const _0x2b9fc2=a347_0x493e88;return new metadata_retriever_1[(_0x2b9fc2(0x1ad))]({'instance':this[_0x2b9fc2(0x1b1)],'apiVersion':this[_0x2b9fc2(0x1d8)],'logger':this[_0x2b9fc2(0x19f)],'metadataTypes':this[_0x2b9fc2(0x1da)]});}[a347_0x493e88(0x195)](){const _0x399a46=a347_0x493e88;return new components_deployer_1[(_0x399a46(0x1a8))]({'instance':this[_0x399a46(0x1cb)],'logger':this[_0x399a46(0x19f)],'apiVersion':this[_0x399a46(0x1d8)],'targetOrgId':this[_0x399a46(0x1be)],'trackingSettingId':this[_0x399a46(0x1c1)]});}['createTrackingSettingRecord'](){const _0x5f0c84=a347_0x493e88;return{'attributes':{'type':constants_1[_0x5f0c84(0x192)]+_0x5f0c84(0x1ce)},'Id':this['trackingSettingId'],[constants_1[_0x5f0c84(0x192)]+'Is_Processed__c']:this[_0x5f0c84(0x1b5)],[constants_1['FLOSUM_NAMESPACE']+_0x5f0c84(0x1cd)]:this[_0x5f0c84(0x18e)]};}async[a347_0x493e88(0x1b9)](){const _0x697384=a347_0x493e88,_0x3ebe09=this['createTrackingSettingRecord'](),_0x1e40a1=new salesforce_1[(_0x697384(0x1c0))]({'instance':this['flosumInstance'],'objectName':constants_1['FLOSUM_NAMESPACE']+_0x697384(0x1ce),'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'}),_0x26dd76=await _0x1e40a1['execute']({'records':[_0x3ebe09]}),_0x5694c8=_0x26dd76['at'](0x0);(_0x5694c8===null||_0x5694c8===void 0x0?void 0x0:_0x5694c8[_0x697384(0x1b7)])?this['logger'][_0x697384(0x1b3)](_0x697384(0x18f)):this['logger'][_0x697384(0x1b3)](_0x697384(0x18d)+(_0x5694c8===null||_0x5694c8===void 0x0?void 0x0:_0x5694c8[_0x697384(0x191)]));}async[a347_0x493e88(0x19b)](){const _0x351144=a347_0x493e88;await this[_0x351144(0x196)](),this['startDate']=new Date()['getTime']();try{await this[_0x351144(0x193)](),await this[_0x351144(0x1e0)](),this['initLogger'](),this[_0x351144(0x19f)]['log'](_0x351144(0x1c6)+this[_0x351144(0x1af)]),this['metadataLogger'][_0x351144(0x1d0)]=constants_2['LogStatus']['IN_PROGRESS'],this[_0x351144(0x1b5)]=!![],await this[_0x351144(0x1b9)](),await this[_0x351144(0x1ac)]['update'](),await this[_0x351144(0x19f)][_0x351144(0x1dc)]();const _0x9c2fa0=this[_0x351144(0x1bb)](),_0x3a37e8=this[_0x351144(0x1bc)](),_0x9b24b8=this[_0x351144(0x1ba)](),_0x40a9fa=this[_0x351144(0x195)]();await(0x0,promises_1[_0x351144(0x1c4)])(_0x9c2fa0,_0x3a37e8,_0x9b24b8,_0x40a9fa),this[_0x351144(0x19f)]['log'](_0x351144(0x1c9)),this['metadataLogger'][_0x351144(0x1d0)]=constants_2[_0x351144(0x1a9)][_0x351144(0x1a3)];}catch(_0x189e1d){this[_0x351144(0x19f)][_0x351144(0x191)](_0x351144(0x1dd)),this['logger']['error'](_0x189e1d[_0x351144(0x1c8)]),this[_0x351144(0x1ac)]['status']=constants_2[_0x351144(0x1a9)]['EXCEPTION'];}finally{this[_0x351144(0x1b5)]=![],await this['updateTrackingSetting'](),await this[_0x351144(0x19f)]['update'](),await this['metadataLogger'][_0x351144(0x1dc)]();}}}function a347_0x3a8d(){const _0x5f3e1e=['../../../constants/job','success','./classes/logger/logger','updateTrackingSetting','getMetadataRetriever','getSourceMemberRetriever','getSourceMemberHandler','Logger','targetOrgId','apply','RestSimpleDeployData','trackingSettingId','defineProperty','10SWIAtt','pipeline','lastRetrieveDate','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','metadataLogId','message','Tracking\x20components\x20job\x20has\x20been\x20completed','./classes/components.deployer','flosumInstance','616092ZassQk','Last_Start_Retrieval__c','Tracking_Setting__c','381742XdGSFo','status','__importDefault','AuthManager','Job\x20Error:\x20','exit','1900632lpreZh','parse','minimist','apiVersion','slice','metadataTypes','../../../constants','update','Tracking\x20components\x20job\x20has\x20been\x20failed','7066818HTTbfa','toString','initMetadataLogger','timeZone','SourceMemberHandler','join','@flosum/salesforce','search','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','startDate','Tracking\x20setting\x20updated','Job','error','FLOSUM_NAMESPACE','initInstances','default','getComponentsDeployer','initManifest','MetadataLogger','then','jobStorePath','targetOrgCredentials','execute','7SGAGYd','79647qeJBAi','./classes/metadata.retriever','logger','create','argv','70qntrTP','COMPLETED','25vmDnNE','AxiosInstanceUtils','(((.+)+)+)+$','1177602TCvjyy','ComponentsDeployer','LogStatus','./classes/source-member.retriever','MANIFEST_FILENAME','metadataLogger','MetadataRetriever','__esModule','jobId','214192kHsInV','targetInstance','SourceMemberRetriever','log','catch','isProcessed'];a347_0x3a8d=function(){return _0x5f3e1e;};return a347_0x3a8d();}exports[a347_0x493e88(0x190)]=Job,new Job()[a347_0x493e88(0x19b)]()[a347_0x493e88(0x198)](()=>process[a347_0x493e88(0x1d4)](0x0))[a347_0x493e88(0x1b4)](_0x8eec7d=>{const _0x298f4d=a347_0x493e88;systemLogger[_0x298f4d(0x191)](_0x298f4d(0x1d3)+_0x8eec7d[_0x298f4d(0x1c8)]),process[_0x298f4d(0x1d4)](0x1);});