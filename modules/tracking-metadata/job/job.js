const a304_0x5c0d1b=a304_0x3134;function a304_0x1d3c(){const _0x35971e=['getTime','./classes/components.deployer','error','FLOSUM_NAMESPACE','getComponentsDeployer','readFile','AxiosInstanceUtils','stream/promises','apiVersion','MetadataRetriever','./classes/metadata-logger','./classes/source-member.handler','getSourceMemberHandler','IN_PROGRESS','metadataLogId','getSourceMemberRetriever','status','4996jDXkpW','fs/promises','jobStorePath','../../../constants/job','apply','4152ZfvGUv','AuthManager','flosumInstance','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','search','targetOrgId','MetadataLogger','execute','36qcIbpR','Last_Start_Retrieval__c','catch','timeZone','update','lastRetrieveDate','Tracking\x20components\x20job\x20has\x20been\x20failed','constructor','exit','log','toString','create','argv','SourceMemberRetriever','logger','initLogger','updateTrackingSetting','trackingSettingId','getMetadataRetriever','targetOrgCredentials','jobId','Job','Tracking\x20setting\x20updated','createTrackingSettingRecord','688qVgoMY','startDate','56509dgyEKD','join','8161307XfRBUE','../../shared/managers/auth.manager','COMPLETED','../../../core','LogStatus','default','__esModule','utf-8','../../../constants','Logger','minimist','metadataTypes','initMetadataLogger','targetInstance','SourceMemberHandler','EXCEPTION','RestSimpleDeployData','flosumOrgCredentials','metadataLogger','211902PlbbIa','message','MANIFEST_FILENAME','14907580baExll','slice','171441KkUlRi','Is_Processed__c','then','22BHBqom','9225785lzHwQI','initInstances','(((.+)+)+)+$','./classes/source-member.retriever'];a304_0x1d3c=function(){return _0x35971e;};return a304_0x1d3c();}(function(_0x505ae3,_0x427b89){const _0x59caad=a304_0x3134,_0x29dd7d=_0x505ae3();while(!![]){try{const _0x339aad=-parseInt(_0x59caad(0x7c))/0x1*(-parseInt(_0x59caad(0xbc))/0x2)+parseInt(_0x59caad(0xb4))/0x3*(-parseInt(_0x59caad(0xaf))/0x4)+-parseInt(_0x59caad(0x9a))/0x5+parseInt(_0x59caad(0x91))/0x6+-parseInt(_0x59caad(0x7e))/0x7+parseInt(_0x59caad(0x7a))/0x8*(parseInt(_0x59caad(0x96))/0x9)+parseInt(_0x59caad(0x94))/0xa*(parseInt(_0x59caad(0x99))/0xb);if(_0x339aad===_0x427b89)break;else _0x29dd7d['push'](_0x29dd7d['shift']());}catch(_0x5bd0d5){_0x29dd7d['push'](_0x29dd7d['shift']());}}}(a304_0x1d3c,0xe3ab7));const a304_0x46e1d2=(function(){let _0x145cbd=!![];return function(_0x274679,_0x3995dd){const _0x20eeac=_0x145cbd?function(){const _0x89a83b=a304_0x3134;if(_0x3995dd){const _0x1c81bb=_0x3995dd[_0x89a83b(0xb3)](_0x274679,arguments);return _0x3995dd=null,_0x1c81bb;}}:function(){};return _0x145cbd=![],_0x20eeac;};}()),a304_0x3b991a=a304_0x46e1d2(this,function(){const _0x3ba403=a304_0x3134;return a304_0x3b991a[_0x3ba403(0x6c)]()[_0x3ba403(0xb8)](_0x3ba403(0x9c))[_0x3ba403(0x6c)]()[_0x3ba403(0xc3)](a304_0x3b991a)[_0x3ba403(0xb8)](_0x3ba403(0x9c));});a304_0x3b991a();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4fcd83){return _0x4fcd83&&_0x4fcd83['__esModule']?_0x4fcd83:{'default':_0x4fcd83};};function a304_0x3134(_0x1f8267,_0x37065e){const _0x3559a1=a304_0x1d3c();return a304_0x3134=function(_0x3b991a,_0x46e1d2){_0x3b991a=_0x3b991a-0x6c;let _0x1d3c4f=_0x3559a1[_0x3b991a];return _0x1d3c4f;},a304_0x3134(_0x1f8267,_0x37065e);}Object['defineProperty'](exports,a304_0x5c0d1b(0x84),{'value':!![]}),exports['Job']=void 0x0;const minimist_1=__importDefault(require(a304_0x5c0d1b(0x88))),core_1=require(a304_0x5c0d1b(0x81)),salesforce_1=require('@flosum/salesforce'),auth_manager_1=require(a304_0x5c0d1b(0x7f)),logger_1=require('./classes/logger/logger'),promises_1=require(a304_0x5c0d1b(0xa5)),promises_2=require(a304_0x5c0d1b(0xb0)),path_1=__importDefault(require('path')),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a304_0x5c0d1b(0x9f)),source_member_retriever_1=require(a304_0x5c0d1b(0x9d)),source_member_handler_1=require(a304_0x5c0d1b(0xa9)),metadata_logger_1=require(a304_0x5c0d1b(0xa8)),job_1=require(a304_0x5c0d1b(0xb2)),constants_1=require(a304_0x5c0d1b(0x86)),constants_2=require('../constants'),{jobId,jobStorePath}=(0x0,minimist_1[a304_0x5c0d1b(0x83)])(process[a304_0x5c0d1b(0x6e)][a304_0x5c0d1b(0x95)](0x2)),systemLogger=new core_1[(a304_0x5c0d1b(0x87))](jobId);class Job{constructor(){const _0x3cccc3=a304_0x5c0d1b;this['jobStorePath']=jobStorePath,this[_0x3cccc3(0x76)]=jobId;}async['initManifest'](){const _0x4d1f45=a304_0x5c0d1b,_0x5d0dbd=path_1[_0x4d1f45(0x83)][_0x4d1f45(0x7d)](this[_0x4d1f45(0xb1)],job_1[_0x4d1f45(0x93)]),_0xd95012=await(0x0,promises_2[_0x4d1f45(0xa3)])(_0x5d0dbd,{'encoding':_0x4d1f45(0x85)})['then'](JSON['parse'])[_0x4d1f45(0x98)](({details:_0x10fefe})=>_0x10fefe);await(0x0,promises_2['rm'])(_0x5d0dbd,{'recursive':!![],'force':!![]}),this[_0x4d1f45(0xa6)]=_0xd95012[_0x4d1f45(0xa6)],this[_0x4d1f45(0x8f)]=_0xd95012['flosumOrgCredentials'],this[_0x4d1f45(0x75)]=_0xd95012[_0x4d1f45(0x75)],this[_0x4d1f45(0xb9)]=_0xd95012[_0x4d1f45(0xb9)],this['trackingSettingId']=_0xd95012['trackingSettingId'],this['lastRetrieveDate']=_0xd95012[_0x4d1f45(0xc1)],this['metadataTypes']=_0xd95012[_0x4d1f45(0x89)],this['timeZone']=_0xd95012[_0x4d1f45(0xbf)];}async[a304_0x5c0d1b(0x9b)](){const _0x7a4a31=a304_0x5c0d1b;this[_0x7a4a31(0xb6)]=await salesforce_1[_0x7a4a31(0xa4)][_0x7a4a31(0x6d)](new auth_manager_1['AuthManager'](this[_0x7a4a31(0x8f)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this['targetInstance']=await salesforce_1['AxiosInstanceUtils'][_0x7a4a31(0x6d)](new auth_manager_1[(_0x7a4a31(0xb5))](this[_0x7a4a31(0x75)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a304_0x5c0d1b(0x8a)](){const _0x2cb993=a304_0x5c0d1b;this[_0x2cb993(0x90)]=new metadata_logger_1[(_0x2cb993(0xba))]({'apiVersion':this[_0x2cb993(0xa6)],'instance':this[_0x2cb993(0xb6)],'targetOrgId':this[_0x2cb993(0xb9)],'trackingSettingId':this[_0x2cb993(0x73)],'startDate':this[_0x2cb993(0x7b)]}),this['metadataLogId']=await this[_0x2cb993(0x90)]['init']();}['initLogger'](){const _0x4302e5=a304_0x5c0d1b;this[_0x4302e5(0x70)]=new logger_1[(_0x4302e5(0x87))]({'systemLogger':systemLogger,'apiVersion':this[_0x4302e5(0xa6)],'instance':this['flosumInstance'],'metadataLogId':this[_0x4302e5(0xac)],'timeZone':this[_0x4302e5(0xbf)]});}[a304_0x5c0d1b(0xad)](){const _0x355a04=a304_0x5c0d1b;return new source_member_retriever_1[(_0x355a04(0x6f))]({'apiVersion':this['apiVersion'],'instance':this['targetInstance'],'logger':this[_0x355a04(0x70)],'lastRetrieveDate':this[_0x355a04(0xc1)],'currentRetrieveDate':this[_0x355a04(0x7b)],'metadataTypes':this[_0x355a04(0x89)]});}[a304_0x5c0d1b(0xaa)](){const _0x17825a=a304_0x5c0d1b;return new source_member_handler_1[(_0x17825a(0x8c))]({'instance':this[_0x17825a(0xb6)],'apiVersion':this[_0x17825a(0xa6)],'logger':this[_0x17825a(0x70)],'targetOrgId':this['targetOrgId']});}['getMetadataRetriever'](){const _0x271d68=a304_0x5c0d1b;return new metadata_retriever_1[(_0x271d68(0xa7))]({'instance':this[_0x271d68(0x8b)],'apiVersion':this['apiVersion'],'logger':this[_0x271d68(0x70)],'metadataTypes':this['metadataTypes']});}[a304_0x5c0d1b(0xa2)](){const _0x23cb54=a304_0x5c0d1b;return new components_deployer_1['ComponentsDeployer']({'instance':this['flosumInstance'],'logger':this[_0x23cb54(0x70)],'apiVersion':this['apiVersion'],'targetOrgId':this[_0x23cb54(0xb9)],'trackingSettingId':this[_0x23cb54(0x73)]});}[a304_0x5c0d1b(0x79)](){const _0xff20e9=a304_0x5c0d1b;return{'attributes':{'type':constants_1[_0xff20e9(0xa1)]+'Tracking_Setting__c'},'Id':this[_0xff20e9(0x73)],[constants_1[_0xff20e9(0xa1)]+_0xff20e9(0x97)]:![],[constants_1[_0xff20e9(0xa1)]+_0xff20e9(0xbd)]:this[_0xff20e9(0x7b)]};}async[a304_0x5c0d1b(0x72)](){const _0x63ee5b=a304_0x5c0d1b,_0x31295b=this['createTrackingSettingRecord'](),_0x468f7c=new salesforce_1[(_0x63ee5b(0x8e))]({'instance':this[_0x63ee5b(0xb6)],'objectName':constants_1[_0x63ee5b(0xa1)]+'Tracking_Setting__c','api':this[_0x63ee5b(0xa6)],'allOrNone':![],'externalIdField':'Id'}),_0x55e7b1=await _0x468f7c[_0x63ee5b(0xbb)]({'records':[_0x31295b]}),_0x6d26a2=_0x55e7b1['at'](0x0);(_0x6d26a2===null||_0x6d26a2===void 0x0?void 0x0:_0x6d26a2['success'])?this[_0x63ee5b(0x70)][_0x63ee5b(0xc5)](_0x63ee5b(0x78)):this[_0x63ee5b(0x70)]['log'](_0x63ee5b(0xb7)+(_0x6d26a2===null||_0x6d26a2===void 0x0?void 0x0:_0x6d26a2[_0x63ee5b(0xa0)]));}async[a304_0x5c0d1b(0xbb)](){const _0x2cf669=a304_0x5c0d1b;await this['initManifest'](),this[_0x2cf669(0x7b)]=new Date()[_0x2cf669(0x9e)]();try{await this[_0x2cf669(0x9b)](),await this['initMetadataLogger'](),this[_0x2cf669(0x71)](),this[_0x2cf669(0x70)][_0x2cf669(0xc5)]('Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20'+this[_0x2cf669(0x76)]),this['metadataLogger']['status']=constants_2['LogStatus'][_0x2cf669(0xab)],await this[_0x2cf669(0x90)]['update'](),await this[_0x2cf669(0x70)][_0x2cf669(0xc0)]();const _0x17892c=this[_0x2cf669(0xad)](),_0x355991=this[_0x2cf669(0xaa)](),_0x3deb98=this[_0x2cf669(0x74)](),_0x2484fe=this[_0x2cf669(0xa2)]();await(0x0,promises_1['pipeline'])(_0x17892c,_0x355991,_0x3deb98,_0x2484fe),this[_0x2cf669(0x70)]['log']('Tracking\x20components\x20job\x20has\x20been\x20completed'),this[_0x2cf669(0x90)][_0x2cf669(0xae)]=constants_2[_0x2cf669(0x82)][_0x2cf669(0x80)];}catch(_0xad5338){this[_0x2cf669(0x70)]['error'](_0x2cf669(0xc2)),this['logger'][_0x2cf669(0xa0)](_0xad5338['message']),this[_0x2cf669(0x90)][_0x2cf669(0xae)]=constants_2[_0x2cf669(0x82)][_0x2cf669(0x8d)];}finally{await this[_0x2cf669(0x72)](),await this[_0x2cf669(0x70)][_0x2cf669(0xc0)](),await this[_0x2cf669(0x90)][_0x2cf669(0xc0)]();}}}exports[a304_0x5c0d1b(0x77)]=Job,new Job()[a304_0x5c0d1b(0xbb)]()[a304_0x5c0d1b(0x98)](()=>process[a304_0x5c0d1b(0xc4)](0x0))[a304_0x5c0d1b(0xbe)](_0xac7716=>{const _0x4ebf3a=a304_0x5c0d1b;systemLogger['error']('Job\x20Error:\x20'+_0xac7716[_0x4ebf3a(0x92)]),process[_0x4ebf3a(0xc4)](0x1);});