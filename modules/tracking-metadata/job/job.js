const a348_0x3e8982=a348_0x27b2;(function(_0x2a7445,_0x5bb159){const _0x3879a7=a348_0x27b2,_0x44015d=_0x2a7445();while(!![]){try{const _0x2b8c06=-parseInt(_0x3879a7(0x235))/0x1*(-parseInt(_0x3879a7(0x21e))/0x2)+-parseInt(_0x3879a7(0x21f))/0x3+-parseInt(_0x3879a7(0x233))/0x4*(parseInt(_0x3879a7(0x20d))/0x5)+-parseInt(_0x3879a7(0x236))/0x6*(-parseInt(_0x3879a7(0x212))/0x7)+-parseInt(_0x3879a7(0x211))/0x8+parseInt(_0x3879a7(0x215))/0x9*(-parseInt(_0x3879a7(0x20f))/0xa)+parseInt(_0x3879a7(0x1e8))/0xb;if(_0x2b8c06===_0x5bb159)break;else _0x44015d['push'](_0x44015d['shift']());}catch(_0xa2c71b){_0x44015d['push'](_0x44015d['shift']());}}}(a348_0x4aa4,0x309f7));const a348_0x5a32a2=(function(){let _0x8b4dc2=!![];return function(_0x45a8c2,_0x5cb5c2){const _0x21618a=_0x8b4dc2?function(){const _0x2870a1=a348_0x27b2;if(_0x5cb5c2){const _0x4476c5=_0x5cb5c2[_0x2870a1(0x204)](_0x45a8c2,arguments);return _0x5cb5c2=null,_0x4476c5;}}:function(){};return _0x8b4dc2=![],_0x21618a;};}()),a348_0x247813=a348_0x5a32a2(this,function(){const _0x10ce69=a348_0x27b2;return a348_0x247813['toString']()[_0x10ce69(0x22d)]('(((.+)+)+)+$')[_0x10ce69(0x208)]()['constructor'](a348_0x247813)['search'](_0x10ce69(0x1fb));});a348_0x247813();function a348_0x27b2(_0x37938d,_0x552af5){const _0xe9f726=a348_0x4aa4();return a348_0x27b2=function(_0x247813,_0x5a32a2){_0x247813=_0x247813-0x1df;let _0x4aa475=_0xe9f726[_0x247813];return _0x4aa475;},a348_0x27b2(_0x37938d,_0x552af5);}'use strict';var __importDefault=this&&this[a348_0x3e8982(0x20b)]||function(_0x3d6a47){const _0x4cebe1=a348_0x3e8982;return _0x3d6a47&&_0x3d6a47[_0x4cebe1(0x1f5)]?_0x3d6a47:{'default':_0x3d6a47};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['Job']=void 0x0;function a348_0x4aa4(){const _0x352979=['utf-8','../../shared/managers/auth.manager','targetInstance','Tracking\x20components\x20job\x20has\x20been\x20completed','message','Last_Start_Retrieval__c','create','10OZHHsT','399810yOmswK','catch','Tracking_Setting__c','error','LogStatus','minimist','jobStorePath','init','flosumOrgCredentials','initMetadataLogger','./classes/logger/logger','MetadataLogger','success','./classes/source-member.retriever','search','Job','./classes/source-member.handler','startDate','exit','createTrackingSettingRecord','4HiJBkf','AxiosInstanceUtils','25309xJwiEU','5136ZjgiKg','getSourceMemberRetriever','metadataTypes','AuthManager','readFile','Tracking\x20setting\x20updated','ComponentsDeployer','execute','COMPLETED','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','timeZone','apiVersion','../../../constants','../constants','metadataLogger','lastRetrieveDate','3794373hrlzui','../../../core','targetOrgId','MANIFEST_FILENAME','@flosum/salesforce','getMetadataRetriever','./classes/metadata-logger','then','MetadataRetriever','Logger','stream/promises','parse','SourceMemberHandler','__esModule','path','default','logger','update','./classes/metadata.retriever','(((.+)+)+)+$','getTime','status','Job\x20Error:\x20','log','isProcessed','targetOrgCredentials','argv','getSourceMemberHandler','apply','initInstances','flosumInstance','metadataLogId','toString','initLogger','Is_Processed__c','__importDefault','jobId','1022510DVeKAP','getComponentsDeployer','798460HQCuqb','trackingSettingId','1104376CJXcOo','2317JOPklO','FLOSUM_NAMESPACE','pipeline','9PHoDLZ','updateTrackingSetting'];a348_0x4aa4=function(){return _0x352979;};return a348_0x4aa4();}const minimist_1=__importDefault(require(a348_0x3e8982(0x224))),core_1=require(a348_0x3e8982(0x1e9)),salesforce_1=require(a348_0x3e8982(0x1ec)),auth_manager_1=require(a348_0x3e8982(0x218)),logger_1=require(a348_0x3e8982(0x229)),promises_1=require(a348_0x3e8982(0x1f2)),promises_2=require('fs/promises'),path_1=__importDefault(require(a348_0x3e8982(0x1f6))),metadata_retriever_1=require(a348_0x3e8982(0x1fa)),components_deployer_1=require('./classes/components.deployer'),source_member_retriever_1=require(a348_0x3e8982(0x22c)),source_member_handler_1=require(a348_0x3e8982(0x22f)),metadata_logger_1=require(a348_0x3e8982(0x1ee)),job_1=require('../../../constants/job'),constants_1=require(a348_0x3e8982(0x1e4)),constants_2=require(a348_0x3e8982(0x1e5)),{jobId,jobStorePath}=(0x0,minimist_1[a348_0x3e8982(0x1f7)])(process[a348_0x3e8982(0x202)]['slice'](0x2)),systemLogger=new core_1[(a348_0x3e8982(0x1f1))](jobId);class Job{constructor(){const _0xd8bc76=a348_0x3e8982;this[_0xd8bc76(0x225)]=jobStorePath,this['jobId']=jobId;}async['initManifest'](){const _0x2c86fd=a348_0x3e8982,_0x59f357=path_1['default']['join'](this['jobStorePath'],job_1[_0x2c86fd(0x1eb)]),_0x1215fb=await(0x0,promises_2[_0x2c86fd(0x23a)])(_0x59f357,{'encoding':_0x2c86fd(0x217)})['then'](JSON[_0x2c86fd(0x1f3)])[_0x2c86fd(0x1ef)](({details:_0x26f791})=>_0x26f791);await(0x0,promises_2['rm'])(_0x59f357,{'recursive':!![],'force':!![]}),this[_0x2c86fd(0x1e3)]=_0x1215fb[_0x2c86fd(0x1e3)],this[_0x2c86fd(0x227)]=_0x1215fb[_0x2c86fd(0x227)],this[_0x2c86fd(0x201)]=_0x1215fb[_0x2c86fd(0x201)],this[_0x2c86fd(0x1ea)]=_0x1215fb['targetOrgId'],this[_0x2c86fd(0x210)]=_0x1215fb[_0x2c86fd(0x210)],this[_0x2c86fd(0x1e7)]=_0x1215fb[_0x2c86fd(0x1e7)],this[_0x2c86fd(0x238)]=_0x1215fb[_0x2c86fd(0x238)],this[_0x2c86fd(0x1e2)]=_0x1215fb[_0x2c86fd(0x1e2)];}async[a348_0x3e8982(0x205)](){const _0x17124c=a348_0x3e8982;this['flosumInstance']=await salesforce_1[_0x17124c(0x234)][_0x17124c(0x21d)](new auth_manager_1['AuthManager'](this[_0x17124c(0x227)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this['targetInstance']=await salesforce_1['AxiosInstanceUtils'][_0x17124c(0x21d)](new auth_manager_1[(_0x17124c(0x239))](this[_0x17124c(0x201)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async['initMetadataLogger'](){const _0x3c1803=a348_0x3e8982;this['metadataLogger']=new metadata_logger_1[(_0x3c1803(0x22a))]({'apiVersion':this[_0x3c1803(0x1e3)],'instance':this[_0x3c1803(0x206)],'targetOrgId':this[_0x3c1803(0x1ea)],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0x3c1803(0x230)]}),this['metadataLogId']=await this[_0x3c1803(0x1e6)][_0x3c1803(0x226)]();}[a348_0x3e8982(0x209)](){const _0x4ae82b=a348_0x3e8982;this['logger']=new logger_1[(_0x4ae82b(0x1f1))]({'systemLogger':systemLogger,'apiVersion':this[_0x4ae82b(0x1e3)],'instance':this[_0x4ae82b(0x206)],'metadataLogId':this[_0x4ae82b(0x207)],'timeZone':this[_0x4ae82b(0x1e2)]});}[a348_0x3e8982(0x237)](){const _0x1e186d=a348_0x3e8982;return new source_member_retriever_1['SourceMemberRetriever']({'apiVersion':this[_0x1e186d(0x1e3)],'instance':this['targetInstance'],'logger':this[_0x1e186d(0x1f8)],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0x1e186d(0x230)],'metadataTypes':this['metadataTypes']});}['getSourceMemberHandler'](){const _0x2dc11e=a348_0x3e8982;return new source_member_handler_1[(_0x2dc11e(0x1f4))]({'instance':this[_0x2dc11e(0x206)],'apiVersion':this['apiVersion'],'logger':this[_0x2dc11e(0x1f8)],'targetOrgId':this[_0x2dc11e(0x1ea)]});}['getMetadataRetriever'](){const _0x3ce087=a348_0x3e8982;return new metadata_retriever_1[(_0x3ce087(0x1f0))]({'instance':this[_0x3ce087(0x219)],'apiVersion':this[_0x3ce087(0x1e3)],'logger':this[_0x3ce087(0x1f8)],'metadataTypes':this[_0x3ce087(0x238)]});}[a348_0x3e8982(0x20e)](){const _0x4b039e=a348_0x3e8982;return new components_deployer_1[(_0x4b039e(0x23c))]({'instance':this[_0x4b039e(0x206)],'logger':this[_0x4b039e(0x1f8)],'apiVersion':this[_0x4b039e(0x1e3)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x4b039e(0x210)]});}[a348_0x3e8982(0x232)](){const _0xa2201f=a348_0x3e8982;return{'attributes':{'type':constants_1['FLOSUM_NAMESPACE']+_0xa2201f(0x221)},'Id':this[_0xa2201f(0x210)],[constants_1['FLOSUM_NAMESPACE']+_0xa2201f(0x20a)]:this[_0xa2201f(0x200)],[constants_1[_0xa2201f(0x213)]+_0xa2201f(0x21c)]:this[_0xa2201f(0x230)]};}async['updateTrackingSetting'](){const _0xdcb510=a348_0x3e8982,_0x4da76b=this[_0xdcb510(0x232)](),_0x442a8f=new salesforce_1['RestSimpleDeployData']({'instance':this[_0xdcb510(0x206)],'objectName':constants_1[_0xdcb510(0x213)]+'Tracking_Setting__c','api':this[_0xdcb510(0x1e3)],'allOrNone':![],'externalIdField':'Id'}),_0x4f3313=await _0x442a8f[_0xdcb510(0x1df)]({'records':[_0x4da76b]}),_0x3a158d=_0x4f3313['at'](0x0);(_0x3a158d===null||_0x3a158d===void 0x0?void 0x0:_0x3a158d[_0xdcb510(0x22b)])?this[_0xdcb510(0x1f8)][_0xdcb510(0x1ff)](_0xdcb510(0x23b)):this[_0xdcb510(0x1f8)][_0xdcb510(0x1ff)](_0xdcb510(0x1e1)+(_0x3a158d===null||_0x3a158d===void 0x0?void 0x0:_0x3a158d[_0xdcb510(0x222)]));}async['execute'](){const _0x4d77cc=a348_0x3e8982;await this['initManifest'](),this['startDate']=new Date()[_0x4d77cc(0x1fc)]();try{await this['initInstances'](),await this[_0x4d77cc(0x228)](),this['initLogger'](),this[_0x4d77cc(0x1f8)][_0x4d77cc(0x1ff)]('Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20'+this[_0x4d77cc(0x20c)]),this['metadataLogger'][_0x4d77cc(0x1fd)]=constants_2[_0x4d77cc(0x223)]['IN_PROGRESS'],this['isProcessed']=!![],await this[_0x4d77cc(0x216)](),await this[_0x4d77cc(0x1e6)][_0x4d77cc(0x1f9)](),await this[_0x4d77cc(0x1f8)][_0x4d77cc(0x1f9)]();const _0x38c9ce=this[_0x4d77cc(0x237)](),_0xce2b3d=this[_0x4d77cc(0x203)](),_0x463677=this[_0x4d77cc(0x1ed)](),_0x1e7d64=this['getComponentsDeployer']();await(0x0,promises_1[_0x4d77cc(0x214)])(_0x38c9ce,_0xce2b3d,_0x463677,_0x1e7d64),this[_0x4d77cc(0x1f8)][_0x4d77cc(0x1ff)](_0x4d77cc(0x21a)),this['metadataLogger']['status']=constants_2[_0x4d77cc(0x223)][_0x4d77cc(0x1e0)];}catch(_0x548f69){this[_0x4d77cc(0x1f8)]['error']('Tracking\x20components\x20job\x20has\x20been\x20failed'),this[_0x4d77cc(0x1f8)][_0x4d77cc(0x222)](_0x548f69[_0x4d77cc(0x21b)]),this['metadataLogger'][_0x4d77cc(0x1fd)]=constants_2['LogStatus']['EXCEPTION'];}finally{this[_0x4d77cc(0x200)]=![],await this['updateTrackingSetting'](),await this[_0x4d77cc(0x1f8)][_0x4d77cc(0x1f9)](),await this['metadataLogger'][_0x4d77cc(0x1f9)]();}}}exports[a348_0x3e8982(0x22e)]=Job,new Job()[a348_0x3e8982(0x1df)]()[a348_0x3e8982(0x1ef)](()=>process[a348_0x3e8982(0x231)](0x0))[a348_0x3e8982(0x220)](_0x579065=>{const _0x98f614=a348_0x3e8982;systemLogger[_0x98f614(0x222)](_0x98f614(0x1fe)+_0x579065[_0x98f614(0x21b)]),process[_0x98f614(0x231)](0x1);});