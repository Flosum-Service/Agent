const a347_0x4568ac=a347_0x135c;(function(_0x5092c2,_0x46d709){const _0x244dec=a347_0x135c,_0x2845e9=_0x5092c2();while(!![]){try{const _0x56eef8=-parseInt(_0x244dec(0x178))/0x1*(-parseInt(_0x244dec(0x16a))/0x2)+-parseInt(_0x244dec(0x18b))/0x3*(parseInt(_0x244dec(0x15c))/0x4)+-parseInt(_0x244dec(0x18f))/0x5+-parseInt(_0x244dec(0x177))/0x6+-parseInt(_0x244dec(0x16f))/0x7*(parseInt(_0x244dec(0x163))/0x8)+parseInt(_0x244dec(0x188))/0x9+parseInt(_0x244dec(0x179))/0xa*(parseInt(_0x244dec(0x165))/0xb);if(_0x56eef8===_0x46d709)break;else _0x2845e9['push'](_0x2845e9['shift']());}catch(_0x474f5b){_0x2845e9['push'](_0x2845e9['shift']());}}}(a347_0xc70e,0x4aa13));const a347_0x107acd=(function(){let _0x25e92e=!![];return function(_0x44fc1c,_0xf0aede){const _0x5393d2=_0x25e92e?function(){const _0x12d4a5=a347_0x135c;if(_0xf0aede){const _0x19f01d=_0xf0aede[_0x12d4a5(0x166)](_0x44fc1c,arguments);return _0xf0aede=null,_0x19f01d;}}:function(){};return _0x25e92e=![],_0x5393d2;};}()),a347_0x4964f5=a347_0x107acd(this,function(){const _0x438902=a347_0x135c;return a347_0x4964f5[_0x438902(0x155)]()['search'](_0x438902(0x142))[_0x438902(0x155)]()[_0x438902(0x174)](a347_0x4964f5)[_0x438902(0x138)](_0x438902(0x142));});a347_0x4964f5();'use strict';function a347_0xc70e(){const _0x13802a=['apiVersion','SourceMemberHandler','2413348YEWPxB','readFile','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','SourceMemberRetriever','initMetadataLogger','constructor','MetadataRetriever','stream/promises','148164oqRLVH','1jseoDO','6678890nbmEhM','COMPLETED','metadataLogger','jobStorePath','IN_PROGRESS','Tracking\x20components\x20job\x20has\x20been\x20completed','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','../constants','getMetadataRetriever','@flosum/salesforce','create','flosumOrgCredentials','then','metadataTypes','initManifest','4023270JzbDuW','EXCEPTION','targetInstance','349233WxsOlf','argv','getTime','AuthManager','1090125mgOHYC','Tracking\x20setting\x20updated','initLogger','jobId','search','updateTrackingSetting','fs/promises','getComponentsDeployer','status','init','update','default','logger','path','(((.+)+)+)+$','initInstances','getSourceMemberHandler','lastRetrieveDate','../../../constants/job','./classes/logger/logger','minimist','MetadataLogger','catch','exit','startDate','RestSimpleDeployData','getSourceMemberRetriever','FLOSUM_NAMESPACE','error','Job\x20Error:\x20','__importDefault','LogStatus','message','toString','MANIFEST_FILENAME','defineProperty','timeZone','utf-8','Logger','__esModule','8hFOhFV','trackingSettingId','flosumInstance','targetOrgId','targetOrgCredentials','success','metadataLogId','8QbQzDh','log','11hmTUHo','apply','AxiosInstanceUtils','createTrackingSettingRecord','./classes/metadata-logger','22138UWLZki','Tracking_Setting__c','../../../core'];a347_0xc70e=function(){return _0x13802a;};return a347_0xc70e();}var __importDefault=this&&this[a347_0x4568ac(0x152)]||function(_0x3237c4){const _0x3823bd=a347_0x4568ac;return _0x3237c4&&_0x3237c4[_0x3823bd(0x15b)]?_0x3237c4:{'default':_0x3237c4};};Object[a347_0x4568ac(0x157)](exports,a347_0x4568ac(0x15b),{'value':!![]}),exports['Job']=void 0x0;const minimist_1=__importDefault(require(a347_0x4568ac(0x148))),core_1=require(a347_0x4568ac(0x16c)),salesforce_1=require(a347_0x4568ac(0x182)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a347_0x4568ac(0x147)),promises_1=require(a347_0x4568ac(0x176)),promises_2=require(a347_0x4568ac(0x13a)),path_1=__importDefault(require(a347_0x4568ac(0x141))),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require('./classes/components.deployer'),source_member_retriever_1=require('./classes/source-member.retriever'),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require(a347_0x4568ac(0x169)),job_1=require(a347_0x4568ac(0x146)),constants_1=require('../../../constants'),constants_2=require(a347_0x4568ac(0x180)),{jobId,jobStorePath}=(0x0,minimist_1[a347_0x4568ac(0x13f)])(process[a347_0x4568ac(0x18c)]['slice'](0x2)),systemLogger=new core_1[(a347_0x4568ac(0x15a))](jobId);class Job{constructor(){const _0x327628=a347_0x4568ac;this[_0x327628(0x17c)]=jobStorePath,this['jobId']=jobId;}async['initManifest'](){const _0x1846e8=a347_0x4568ac,_0x2873d0=path_1[_0x1846e8(0x13f)]['join'](this['jobStorePath'],job_1[_0x1846e8(0x156)]),_0x16b66c=await(0x0,promises_2[_0x1846e8(0x170)])(_0x2873d0,{'encoding':_0x1846e8(0x159)})[_0x1846e8(0x185)](JSON['parse'])['then'](({details:_0x4c88e9})=>_0x4c88e9);await(0x0,promises_2['rm'])(_0x2873d0,{'recursive':!![],'force':!![]}),this[_0x1846e8(0x16d)]=_0x16b66c[_0x1846e8(0x16d)],this[_0x1846e8(0x184)]=_0x16b66c[_0x1846e8(0x184)],this[_0x1846e8(0x160)]=_0x16b66c[_0x1846e8(0x160)],this['targetOrgId']=_0x16b66c[_0x1846e8(0x15f)],this[_0x1846e8(0x15d)]=_0x16b66c[_0x1846e8(0x15d)],this[_0x1846e8(0x145)]=_0x16b66c[_0x1846e8(0x145)],this[_0x1846e8(0x186)]=_0x16b66c[_0x1846e8(0x186)],this[_0x1846e8(0x158)]=_0x16b66c[_0x1846e8(0x158)];}async[a347_0x4568ac(0x143)](){const _0x288804=a347_0x4568ac;this[_0x288804(0x15e)]=await salesforce_1[_0x288804(0x167)][_0x288804(0x183)](new auth_manager_1[(_0x288804(0x18e))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x288804(0x18a)]=await salesforce_1['AxiosInstanceUtils']['create'](new auth_manager_1[(_0x288804(0x18e))](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a347_0x4568ac(0x173)](){const _0xd4f8b8=a347_0x4568ac;this['metadataLogger']=new metadata_logger_1[(_0xd4f8b8(0x149))]({'apiVersion':this[_0xd4f8b8(0x16d)],'instance':this['flosumInstance'],'targetOrgId':this[_0xd4f8b8(0x15f)],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0xd4f8b8(0x14c)]}),this[_0xd4f8b8(0x162)]=await this[_0xd4f8b8(0x17b)][_0xd4f8b8(0x13d)]();}[a347_0x4568ac(0x191)](){const _0xda037=a347_0x4568ac;this[_0xda037(0x140)]=new logger_1[(_0xda037(0x15a))]({'systemLogger':systemLogger,'apiVersion':this[_0xda037(0x16d)],'instance':this[_0xda037(0x15e)],'metadataLogId':this[_0xda037(0x162)],'timeZone':this['timeZone']});}[a347_0x4568ac(0x14e)](){const _0x3e1d73=a347_0x4568ac;return new source_member_retriever_1[(_0x3e1d73(0x172))]({'apiVersion':this['apiVersion'],'instance':this[_0x3e1d73(0x18a)],'logger':this[_0x3e1d73(0x140)],'lastRetrieveDate':this[_0x3e1d73(0x145)],'currentRetrieveDate':this[_0x3e1d73(0x14c)],'metadataTypes':this['metadataTypes']});}[a347_0x4568ac(0x144)](){const _0xaf9a2f=a347_0x4568ac;return new source_member_handler_1[(_0xaf9a2f(0x16e))]({'instance':this[_0xaf9a2f(0x15e)],'apiVersion':this[_0xaf9a2f(0x16d)],'logger':this['logger'],'targetOrgId':this[_0xaf9a2f(0x15f)]});}[a347_0x4568ac(0x181)](){const _0x22d4f3=a347_0x4568ac;return new metadata_retriever_1[(_0x22d4f3(0x175))]({'instance':this[_0x22d4f3(0x18a)],'apiVersion':this[_0x22d4f3(0x16d)],'logger':this[_0x22d4f3(0x140)],'metadataTypes':this[_0x22d4f3(0x186)]});}[a347_0x4568ac(0x13b)](){const _0x2ab746=a347_0x4568ac;return new components_deployer_1['ComponentsDeployer']({'instance':this[_0x2ab746(0x15e)],'logger':this[_0x2ab746(0x140)],'apiVersion':this[_0x2ab746(0x16d)],'targetOrgId':this[_0x2ab746(0x15f)],'trackingSettingId':this[_0x2ab746(0x15d)]});}['createTrackingSettingRecord'](){const _0x19ed64=a347_0x4568ac;return{'attributes':{'type':constants_1[_0x19ed64(0x14f)]+'Tracking_Setting__c'},'Id':this[_0x19ed64(0x15d)],[constants_1['FLOSUM_NAMESPACE']+'Is_Processed__c']:![],[constants_1[_0x19ed64(0x14f)]+'Last_Start_Retrieval__c']:this[_0x19ed64(0x14c)]};}async[a347_0x4568ac(0x139)](){const _0x4c73f3=a347_0x4568ac,_0x3fa6c8=this[_0x4c73f3(0x168)](),_0x44a9bd=new salesforce_1[(_0x4c73f3(0x14d))]({'instance':this[_0x4c73f3(0x15e)],'objectName':constants_1[_0x4c73f3(0x14f)]+_0x4c73f3(0x16b),'api':this[_0x4c73f3(0x16d)],'allOrNone':![],'externalIdField':'Id'}),_0x347834=await _0x44a9bd['execute']({'records':[_0x3fa6c8]}),_0x3f22b3=_0x347834['at'](0x0);(_0x3f22b3===null||_0x3f22b3===void 0x0?void 0x0:_0x3f22b3[_0x4c73f3(0x161)])?this[_0x4c73f3(0x140)][_0x4c73f3(0x164)](_0x4c73f3(0x190)):this[_0x4c73f3(0x140)][_0x4c73f3(0x164)](_0x4c73f3(0x171)+(_0x3f22b3===null||_0x3f22b3===void 0x0?void 0x0:_0x3f22b3[_0x4c73f3(0x150)]));}async['execute'](){const _0x44ef39=a347_0x4568ac;await this[_0x44ef39(0x187)](),this[_0x44ef39(0x14c)]=new Date()[_0x44ef39(0x18d)]();try{await this[_0x44ef39(0x143)](),await this[_0x44ef39(0x173)](),this[_0x44ef39(0x191)](),this['logger'][_0x44ef39(0x164)](_0x44ef39(0x17f)+this[_0x44ef39(0x137)]),this[_0x44ef39(0x17b)][_0x44ef39(0x13c)]=constants_2[_0x44ef39(0x153)][_0x44ef39(0x17d)],await this[_0x44ef39(0x17b)][_0x44ef39(0x13e)](),await this[_0x44ef39(0x140)][_0x44ef39(0x13e)]();const _0x4bcb3a=this[_0x44ef39(0x14e)](),_0x2bf384=this[_0x44ef39(0x144)](),_0x548e64=this[_0x44ef39(0x181)](),_0xf2287a=this['getComponentsDeployer']();await(0x0,promises_1['pipeline'])(_0x4bcb3a,_0x2bf384,_0x548e64,_0xf2287a),this['logger']['log'](_0x44ef39(0x17e)),this['metadataLogger'][_0x44ef39(0x13c)]=constants_2[_0x44ef39(0x153)][_0x44ef39(0x17a)];}catch(_0x1df12e){this[_0x44ef39(0x140)][_0x44ef39(0x150)]('Tracking\x20components\x20job\x20has\x20been\x20failed'),this['logger'][_0x44ef39(0x150)](_0x1df12e[_0x44ef39(0x154)]),this[_0x44ef39(0x17b)][_0x44ef39(0x13c)]=constants_2[_0x44ef39(0x153)][_0x44ef39(0x189)];}finally{await this[_0x44ef39(0x139)](),await this[_0x44ef39(0x140)]['update'](),await this[_0x44ef39(0x17b)]['update']();}}}function a347_0x135c(_0x4cbcb4,_0x369e19){const _0x3073d0=a347_0xc70e();return a347_0x135c=function(_0x4964f5,_0x107acd){_0x4964f5=_0x4964f5-0x137;let _0xc70ef5=_0x3073d0[_0x4964f5];return _0xc70ef5;},a347_0x135c(_0x4cbcb4,_0x369e19);}exports['Job']=Job,new Job()['execute']()[a347_0x4568ac(0x185)](()=>process[a347_0x4568ac(0x14b)](0x0))[a347_0x4568ac(0x14a)](_0x279bf8=>{const _0x6d51bb=a347_0x4568ac;systemLogger[_0x6d51bb(0x150)](_0x6d51bb(0x151)+_0x279bf8[_0x6d51bb(0x154)]),process['exit'](0x1);});