const a348_0x1a75f5=a348_0x58e1;(function(_0x599d8a,_0xf11203){const _0x16f020=a348_0x58e1,_0x124e73=_0x599d8a();while(!![]){try{const _0x397f67=-parseInt(_0x16f020(0x1f9))/0x1+-parseInt(_0x16f020(0x209))/0x2*(parseInt(_0x16f020(0x218))/0x3)+parseInt(_0x16f020(0x1fa))/0x4+-parseInt(_0x16f020(0x212))/0x5+parseInt(_0x16f020(0x20a))/0x6*(-parseInt(_0x16f020(0x1f0))/0x7)+parseInt(_0x16f020(0x1f1))/0x8*(-parseInt(_0x16f020(0x1df))/0x9)+parseInt(_0x16f020(0x211))/0xa;if(_0x397f67===_0xf11203)break;else _0x124e73['push'](_0x124e73['shift']());}catch(_0x5aab82){_0x124e73['push'](_0x124e73['shift']());}}}(a348_0x281b,0x5c875));const a348_0x569b8c=(function(){let _0x38fcc4=!![];return function(_0x204a80,_0x58ea3f){const _0xdbf88a=_0x38fcc4?function(){const _0x352aa5=a348_0x58e1;if(_0x58ea3f){const _0x54a8f5=_0x58ea3f[_0x352aa5(0x221)](_0x204a80,arguments);return _0x58ea3f=null,_0x54a8f5;}}:function(){};return _0x38fcc4=![],_0xdbf88a;};}()),a348_0x2802bc=a348_0x569b8c(this,function(){const _0x11b884=a348_0x58e1;return a348_0x2802bc['toString']()[_0x11b884(0x1e2)](_0x11b884(0x1cd))[_0x11b884(0x1dc)]()[_0x11b884(0x1d0)](a348_0x2802bc)[_0x11b884(0x1e2)](_0x11b884(0x1cd));});a348_0x2802bc();'use strict';function a348_0x58e1(_0x3611a1,_0x443ebc){const _0x331dcc=a348_0x281b();return a348_0x58e1=function(_0x2802bc,_0x569b8c){_0x2802bc=_0x2802bc-0x1cd;let _0x281b7c=_0x331dcc[_0x2802bc];return _0x281b7c;},a348_0x58e1(_0x3611a1,_0x443ebc);}var __importDefault=this&&this[a348_0x1a75f5(0x1e9)]||function(_0x43ff8d){const _0x2ccabf=a348_0x1a75f5;return _0x43ff8d&&_0x43ff8d[_0x2ccabf(0x1d1)]?_0x43ff8d:{'default':_0x43ff8d};};Object['defineProperty'](exports,a348_0x1a75f5(0x1d1),{'value':!![]}),exports[a348_0x1a75f5(0x20e)]=void 0x0;const minimist_1=__importDefault(require(a348_0x1a75f5(0x1fe))),core_1=require(a348_0x1a75f5(0x1e3)),salesforce_1=require(a348_0x1a75f5(0x214)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a348_0x1a75f5(0x219)),promises_1=require('stream/promises'),promises_2=require(a348_0x1a75f5(0x21c)),path_1=__importDefault(require('path')),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require(a348_0x1a75f5(0x1e0)),source_member_retriever_1=require(a348_0x1a75f5(0x1e7)),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require('./classes/metadata-logger'),job_1=require(a348_0x1a75f5(0x202)),constants_1=require(a348_0x1a75f5(0x215)),constants_2=require(a348_0x1a75f5(0x1f6)),{jobId,jobStorePath}=(0x0,minimist_1['default'])(process[a348_0x1a75f5(0x1d4)][a348_0x1a75f5(0x1cf)](0x2)),systemLogger=new core_1[(a348_0x1a75f5(0x1fb))](jobId);class Job{constructor(){const _0x4c14f0=a348_0x1a75f5;this[_0x4c14f0(0x1ec)]=jobStorePath,this[_0x4c14f0(0x1d2)]=jobId;}async[a348_0x1a75f5(0x1d8)](){const _0x124ee1=a348_0x1a75f5,_0x2716ba=path_1[_0x124ee1(0x1f7)]['join'](this['jobStorePath'],job_1['MANIFEST_FILENAME']),_0x7b6428=await(0x0,promises_2[_0x124ee1(0x1ee)])(_0x2716ba,{'encoding':_0x124ee1(0x21d)})[_0x124ee1(0x201)](JSON[_0x124ee1(0x1e6)])[_0x124ee1(0x201)](({details:_0x4db23a})=>_0x4db23a);await(0x0,promises_2['rm'])(_0x2716ba,{'recursive':!![],'force':!![]}),this['apiVersion']=_0x7b6428[_0x124ee1(0x223)],this[_0x124ee1(0x1d9)]=_0x7b6428[_0x124ee1(0x1d9)],this[_0x124ee1(0x1dd)]=_0x7b6428[_0x124ee1(0x1dd)],this[_0x124ee1(0x1d7)]=_0x7b6428['targetOrgId'],this['trackingSettingId']=_0x7b6428[_0x124ee1(0x1f4)],this[_0x124ee1(0x216)]=_0x7b6428[_0x124ee1(0x216)],this[_0x124ee1(0x1eb)]=_0x7b6428[_0x124ee1(0x1eb)],this[_0x124ee1(0x203)]=_0x7b6428['timeZone'];}async[a348_0x1a75f5(0x204)](){const _0x2ed615=a348_0x1a75f5;this[_0x2ed615(0x20c)]=await salesforce_1[_0x2ed615(0x1de)][_0x2ed615(0x1ff)](new auth_manager_1[(_0x2ed615(0x224))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x2ed615(0x1e4)]=await salesforce_1['AxiosInstanceUtils']['create'](new auth_manager_1[(_0x2ed615(0x224))](this[_0x2ed615(0x1dd)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a348_0x1a75f5(0x1e8)](){const _0x59d848=a348_0x1a75f5;this['metadataLogger']=new metadata_logger_1['MetadataLogger']({'apiVersion':this[_0x59d848(0x223)],'instance':this[_0x59d848(0x20c)],'targetOrgId':this[_0x59d848(0x1d7)],'trackingSettingId':this[_0x59d848(0x1f4)],'startDate':this[_0x59d848(0x217)]}),this[_0x59d848(0x213)]=await this[_0x59d848(0x205)][_0x59d848(0x1e5)]();}[a348_0x1a75f5(0x21a)](){const _0x192bb0=a348_0x1a75f5;this['logger']=new logger_1[(_0x192bb0(0x1fb))]({'systemLogger':systemLogger,'apiVersion':this[_0x192bb0(0x223)],'instance':this['flosumInstance'],'metadataLogId':this[_0x192bb0(0x213)],'timeZone':this[_0x192bb0(0x203)]});}[a348_0x1a75f5(0x21f)](){const _0x2d143e=a348_0x1a75f5;return new source_member_retriever_1[(_0x2d143e(0x208))]({'apiVersion':this['apiVersion'],'instance':this[_0x2d143e(0x1e4)],'logger':this[_0x2d143e(0x1d6)],'lastRetrieveDate':this['lastRetrieveDate'],'currentRetrieveDate':this[_0x2d143e(0x217)],'metadataTypes':this['metadataTypes']});}['getSourceMemberHandler'](){const _0x459751=a348_0x1a75f5;return new source_member_handler_1[(_0x459751(0x206))]({'instance':this[_0x459751(0x20c)],'apiVersion':this[_0x459751(0x223)],'logger':this[_0x459751(0x1d6)],'targetOrgId':this[_0x459751(0x1d7)]});}[a348_0x1a75f5(0x1d5)](){const _0x2c469c=a348_0x1a75f5;return new metadata_retriever_1[(_0x2c469c(0x228))]({'instance':this[_0x2c469c(0x1e4)],'apiVersion':this[_0x2c469c(0x223)],'logger':this['logger'],'metadataTypes':this[_0x2c469c(0x1eb)]});}['getComponentsDeployer'](){const _0x5859fa=a348_0x1a75f5;return new components_deployer_1[(_0x5859fa(0x1ea))]({'instance':this[_0x5859fa(0x20c)],'logger':this[_0x5859fa(0x1d6)],'apiVersion':this['apiVersion'],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x5859fa(0x1f4)]});}['createTrackingSettingRecord'](){const _0x3f8982=a348_0x1a75f5;return{'attributes':{'type':constants_1[_0x3f8982(0x1fd)]+_0x3f8982(0x227)},'Id':this[_0x3f8982(0x1f4)],[constants_1['FLOSUM_NAMESPACE']+_0x3f8982(0x1db)]:this[_0x3f8982(0x200)],[constants_1[_0x3f8982(0x1fd)]+'Last_Start_Retrieval__c']:this[_0x3f8982(0x217)]};}async[a348_0x1a75f5(0x1ef)](){const _0x968f95=a348_0x1a75f5,_0x5562bd=this['createTrackingSettingRecord'](),_0x588621=new salesforce_1[(_0x968f95(0x1f2))]({'instance':this[_0x968f95(0x20c)],'objectName':constants_1[_0x968f95(0x1fd)]+'Tracking_Setting__c','api':this[_0x968f95(0x223)],'allOrNone':![],'externalIdField':'Id'}),_0x16f0ee=await _0x588621[_0x968f95(0x1fc)]({'records':[_0x5562bd]}),_0x5619aa=_0x16f0ee['at'](0x0);(_0x5619aa===null||_0x5619aa===void 0x0?void 0x0:_0x5619aa[_0x968f95(0x20b)])?this[_0x968f95(0x1d6)][_0x968f95(0x1ed)](_0x968f95(0x1da)):this[_0x968f95(0x1d6)]['log'](_0x968f95(0x20d)+(_0x5619aa===null||_0x5619aa===void 0x0?void 0x0:_0x5619aa['error']));}async[a348_0x1a75f5(0x1fc)](){const _0x2c0131=a348_0x1a75f5;await this[_0x2c0131(0x1d8)](),this[_0x2c0131(0x217)]=new Date()['getTime']();try{await this['initInstances'](),await this[_0x2c0131(0x1e8)](),this['initLogger'](),this[_0x2c0131(0x1d6)][_0x2c0131(0x1ed)](_0x2c0131(0x226)+this[_0x2c0131(0x1d2)]),this[_0x2c0131(0x205)][_0x2c0131(0x21b)]=constants_2['LogStatus'][_0x2c0131(0x220)],this[_0x2c0131(0x200)]=!![],await this['updateTrackingSetting'](),await this[_0x2c0131(0x205)][_0x2c0131(0x1d3)](),await this[_0x2c0131(0x1d6)][_0x2c0131(0x1d3)]();const _0x165642=this[_0x2c0131(0x21f)](),_0x104cfa=this[_0x2c0131(0x1ce)](),_0x3a96c4=this[_0x2c0131(0x1d5)](),_0x1b9407=this[_0x2c0131(0x21e)]();await(0x0,promises_1[_0x2c0131(0x210)])(_0x165642,_0x104cfa,_0x3a96c4,_0x1b9407),this['logger']['log'](_0x2c0131(0x1f3)),this[_0x2c0131(0x205)]['status']=constants_2['LogStatus'][_0x2c0131(0x1f8)];}catch(_0x5d9e1f){this[_0x2c0131(0x1d6)][_0x2c0131(0x222)]('Tracking\x20components\x20job\x20has\x20been\x20failed'),this[_0x2c0131(0x1d6)][_0x2c0131(0x222)](_0x5d9e1f['message']),this['metadataLogger']['status']=constants_2[_0x2c0131(0x20f)][_0x2c0131(0x207)];}finally{this['isProcessed']=![],await this['updateTrackingSetting'](),await this[_0x2c0131(0x1d6)][_0x2c0131(0x1d3)](),await this[_0x2c0131(0x205)][_0x2c0131(0x1d3)]();}}}exports[a348_0x1a75f5(0x20e)]=Job,new Job()[a348_0x1a75f5(0x1fc)]()[a348_0x1a75f5(0x201)](()=>process[a348_0x1a75f5(0x1e1)](0x0))['catch'](_0x4a9ad6=>{const _0x2c500c=a348_0x1a75f5;systemLogger[_0x2c500c(0x222)](_0x2c500c(0x1f5)+_0x4a9ad6[_0x2c500c(0x225)]),process[_0x2c500c(0x1e1)](0x1);});function a348_0x281b(){const _0x3d678c=['readFile','updateTrackingSetting','1813KtNTAQ','392YEsWcE','RestSimpleDeployData','Tracking\x20components\x20job\x20has\x20been\x20completed','trackingSettingId','Job\x20Error:\x20','../constants','default','COMPLETED','20093XYYptv','3030336xnGUYZ','Logger','execute','FLOSUM_NAMESPACE','minimist','create','isProcessed','then','../../../constants/job','timeZone','initInstances','metadataLogger','SourceMemberHandler','EXCEPTION','SourceMemberRetriever','5458bYVqWb','1122VJTkVo','success','flosumInstance','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','Job','LogStatus','pipeline','1911010cpgRMN','42475YfNrqF','metadataLogId','@flosum/salesforce','../../../constants','lastRetrieveDate','startDate','231yRrNyL','./classes/logger/logger','initLogger','status','fs/promises','utf-8','getComponentsDeployer','getSourceMemberRetriever','IN_PROGRESS','apply','error','apiVersion','AuthManager','message','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','Tracking_Setting__c','MetadataRetriever','(((.+)+)+)+$','getSourceMemberHandler','slice','constructor','__esModule','jobId','update','argv','getMetadataRetriever','logger','targetOrgId','initManifest','flosumOrgCredentials','Tracking\x20setting\x20updated','Is_Processed__c','toString','targetOrgCredentials','AxiosInstanceUtils','51894wesTdM','./classes/components.deployer','exit','search','../../../core','targetInstance','init','parse','./classes/source-member.retriever','initMetadataLogger','__importDefault','ComponentsDeployer','metadataTypes','jobStorePath','log'];a348_0x281b=function(){return _0x3d678c;};return a348_0x281b();}