const a304_0x185eac=a304_0x2e01;(function(_0x574466,_0x3eac3b){const _0xa19f08=a304_0x2e01,_0x3acbea=_0x574466();while(!![]){try{const _0xfc83f6=parseInt(_0xa19f08(0x161))/0x1*(-parseInt(_0xa19f08(0x15b))/0x2)+parseInt(_0xa19f08(0x153))/0x3*(-parseInt(_0xa19f08(0x179))/0x4)+parseInt(_0xa19f08(0x14c))/0x5+parseInt(_0xa19f08(0x143))/0x6+parseInt(_0xa19f08(0x175))/0x7*(parseInt(_0xa19f08(0x166))/0x8)+-parseInt(_0xa19f08(0x15d))/0x9+-parseInt(_0xa19f08(0x132))/0xa;if(_0xfc83f6===_0x3eac3b)break;else _0x3acbea['push'](_0x3acbea['shift']());}catch(_0x2ad340){_0x3acbea['push'](_0x3acbea['shift']());}}}(a304_0x58aa,0x21d59));const a304_0x3f2334=(function(){let _0x1a4af5=!![];return function(_0x312480,_0x4c77d0){const _0x26ce2a=_0x1a4af5?function(){const _0x4f064f=a304_0x2e01;if(_0x4c77d0){const _0x22855a=_0x4c77d0[_0x4f064f(0x183)](_0x312480,arguments);return _0x4c77d0=null,_0x22855a;}}:function(){};return _0x1a4af5=![],_0x26ce2a;};}()),a304_0x51c24d=a304_0x3f2334(this,function(){const _0x514614=a304_0x2e01;return a304_0x51c24d[_0x514614(0x15c)]()[_0x514614(0x160)](_0x514614(0x159))['toString']()['constructor'](a304_0x51c24d)[_0x514614(0x160)](_0x514614(0x159));});a304_0x51c24d();'use strict';var __importDefault=this&&this[a304_0x185eac(0x155)]||function(_0x2bec9a){const _0x144908=a304_0x185eac;return _0x2bec9a&&_0x2bec9a[_0x144908(0x12e)]?_0x2bec9a:{'default':_0x2bec9a};};Object[a304_0x185eac(0x164)](exports,a304_0x185eac(0x12e),{'value':!![]}),exports['Job']=void 0x0;const minimist_1=__importDefault(require(a304_0x185eac(0x138))),core_1=require(a304_0x185eac(0x156)),salesforce_1=require('@flosum/salesforce'),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a304_0x185eac(0x16d)),promises_1=require(a304_0x185eac(0x131)),promises_2=require('fs/promises'),path_1=__importDefault(require(a304_0x185eac(0x178))),metadata_retriever_1=require('./classes/metadata.retriever'),components_deployer_1=require('./classes/components.deployer'),source_member_retriever_1=require('./classes/source-member.retriever'),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require(a304_0x185eac(0x13c)),job_1=require(a304_0x185eac(0x140)),constants_1=require('../../../constants'),constants_2=require(a304_0x185eac(0x146)),{jobId,jobStorePath}=(0x0,minimist_1[a304_0x185eac(0x15f)])(process[a304_0x185eac(0x145)][a304_0x185eac(0x13e)](0x2)),systemLogger=new core_1[(a304_0x185eac(0x130))](jobId);function a304_0x58aa(){const _0x228735=['__importDefault','../../../core','initManifest','initLogger','(((.+)+)+)+$','IN_PROGRESS','4pMMxrB','toString','291537nlecDr','timeZone','default','search','34977xAKcRZ','error','Tracking\x20setting\x20updated','defineProperty','create','1765608zLChDY','targetInstance','getTime','FLOSUM_NAMESPACE','log','LogStatus','RestSimpleDeployData','./classes/logger/logger','metadataLogger','SourceMemberRetriever','metadataTypes','targetOrgCredentials','success','Last_Start_Retrieval__c','getSourceMemberRetriever','7JjzbAD','AxiosInstanceUtils','COMPLETED','path','308PqxLwp','jobId','jobStorePath','readFile','flosumOrgCredentials','Tracking\x20components\x20job\x20has\x20been\x20failed','getSourceMemberHandler','initMetadataLogger','Job','EXCEPTION','apply','Is_Processed__c','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','__esModule','logger','Logger','stream/promises','742350hNTizP','parse','then','exit','getComponentsDeployer','message','minimist','ComponentsDeployer','updateTrackingSetting','Tracking_Setting__c','./classes/metadata-logger','initInstances','slice','join','../../../constants/job','update','createTrackingSettingRecord','1393416gKTPLR','MetadataRetriever','argv','../constants','getMetadataRetriever','lastRetrieveDate','trackingSettingId','targetOrgId','metadataLogId','339485FYmQty','apiVersion','MetadataLogger','execute','startDate','status','MANIFEST_FILENAME','8013TmCGIW','flosumInstance'];a304_0x58aa=function(){return _0x228735;};return a304_0x58aa();}class Job{constructor(){const _0x527faf=a304_0x185eac;this[_0x527faf(0x17b)]=jobStorePath,this[_0x527faf(0x17a)]=jobId;}async[a304_0x185eac(0x157)](){const _0x3351a5=a304_0x185eac,_0x51443f=path_1[_0x3351a5(0x15f)][_0x3351a5(0x13f)](this[_0x3351a5(0x17b)],job_1[_0x3351a5(0x152)]),_0x1e3ace=await(0x0,promises_2[_0x3351a5(0x17c)])(_0x51443f,{'encoding':'utf-8'})[_0x3351a5(0x134)](JSON[_0x3351a5(0x133)])[_0x3351a5(0x134)](({details:_0x235d60})=>_0x235d60);await(0x0,promises_2['rm'])(_0x51443f,{'recursive':!![],'force':!![]}),this['apiVersion']=_0x1e3ace[_0x3351a5(0x14d)],this['flosumOrgCredentials']=_0x1e3ace[_0x3351a5(0x17d)],this['targetOrgCredentials']=_0x1e3ace[_0x3351a5(0x171)],this[_0x3351a5(0x14a)]=_0x1e3ace[_0x3351a5(0x14a)],this['trackingSettingId']=_0x1e3ace[_0x3351a5(0x149)],this[_0x3351a5(0x148)]=_0x1e3ace[_0x3351a5(0x148)],this[_0x3351a5(0x170)]=_0x1e3ace['metadataTypes'],this[_0x3351a5(0x15e)]=_0x1e3ace[_0x3351a5(0x15e)];}async['initInstances'](){const _0x2dbe1e=a304_0x185eac;this[_0x2dbe1e(0x154)]=await salesforce_1[_0x2dbe1e(0x176)][_0x2dbe1e(0x165)](new auth_manager_1['AuthManager'](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x2dbe1e(0x167)]=await salesforce_1[_0x2dbe1e(0x176)]['create'](new auth_manager_1['AuthManager'](this[_0x2dbe1e(0x171)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a304_0x185eac(0x180)](){const _0x20078f=a304_0x185eac;this[_0x20078f(0x16e)]=new metadata_logger_1[(_0x20078f(0x14e))]({'apiVersion':this[_0x20078f(0x14d)],'instance':this[_0x20078f(0x154)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0x20078f(0x150)]}),this[_0x20078f(0x14b)]=await this[_0x20078f(0x16e)]['init']();}[a304_0x185eac(0x158)](){const _0x5202b5=a304_0x185eac;this[_0x5202b5(0x12f)]=new logger_1[(_0x5202b5(0x130))]({'systemLogger':systemLogger,'apiVersion':this[_0x5202b5(0x14d)],'instance':this[_0x5202b5(0x154)],'metadataLogId':this[_0x5202b5(0x14b)],'timeZone':this['timeZone']});}[a304_0x185eac(0x174)](){const _0x460635=a304_0x185eac;return new source_member_retriever_1[(_0x460635(0x16f))]({'apiVersion':this['apiVersion'],'instance':this[_0x460635(0x167)],'logger':this[_0x460635(0x12f)],'lastRetrieveDate':this[_0x460635(0x148)],'currentRetrieveDate':this['startDate'],'metadataTypes':this[_0x460635(0x170)]});}[a304_0x185eac(0x17f)](){const _0x455b6a=a304_0x185eac;return new source_member_handler_1['SourceMemberHandler']({'instance':this[_0x455b6a(0x154)],'apiVersion':this[_0x455b6a(0x14d)],'logger':this[_0x455b6a(0x12f)],'targetOrgId':this[_0x455b6a(0x14a)]});}[a304_0x185eac(0x147)](){const _0x551782=a304_0x185eac;return new metadata_retriever_1[(_0x551782(0x144))]({'instance':this[_0x551782(0x167)],'apiVersion':this[_0x551782(0x14d)],'logger':this[_0x551782(0x12f)],'metadataTypes':this['metadataTypes']});}[a304_0x185eac(0x136)](){const _0x458294=a304_0x185eac;return new components_deployer_1[(_0x458294(0x139))]({'instance':this['flosumInstance'],'logger':this[_0x458294(0x12f)],'apiVersion':this[_0x458294(0x14d)],'targetOrgId':this['targetOrgId'],'trackingSettingId':this[_0x458294(0x149)]});}[a304_0x185eac(0x142)](){const _0xde4e10=a304_0x185eac;return{'attributes':{'type':constants_1[_0xde4e10(0x169)]+_0xde4e10(0x13b)},'Id':this['trackingSettingId'],[constants_1[_0xde4e10(0x169)]+_0xde4e10(0x184)]:![],[constants_1[_0xde4e10(0x169)]+_0xde4e10(0x173)]:this[_0xde4e10(0x150)]};}async[a304_0x185eac(0x13a)](){const _0x4769f9=a304_0x185eac,_0x5a7c19=this[_0x4769f9(0x142)](),_0x3f526b=new salesforce_1[(_0x4769f9(0x16c))]({'instance':this[_0x4769f9(0x154)],'objectName':constants_1[_0x4769f9(0x169)]+_0x4769f9(0x13b),'api':this[_0x4769f9(0x14d)],'allOrNone':![],'externalIdField':'Id'}),_0x29b631=await _0x3f526b['execute']({'records':[_0x5a7c19]}),_0x44529e=_0x29b631['at'](0x0);(_0x44529e===null||_0x44529e===void 0x0?void 0x0:_0x44529e[_0x4769f9(0x172)])?this[_0x4769f9(0x12f)]['log'](_0x4769f9(0x163)):this[_0x4769f9(0x12f)][_0x4769f9(0x16a)](_0x4769f9(0x12d)+(_0x44529e===null||_0x44529e===void 0x0?void 0x0:_0x44529e[_0x4769f9(0x162)]));}async[a304_0x185eac(0x14f)](){const _0x462a3=a304_0x185eac;await this[_0x462a3(0x157)](),this[_0x462a3(0x150)]=new Date()[_0x462a3(0x168)]();try{await this[_0x462a3(0x13d)](),await this['initMetadataLogger'](),this['initLogger'](),this[_0x462a3(0x12f)]['log']('Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20'+this[_0x462a3(0x17a)]),this[_0x462a3(0x16e)][_0x462a3(0x151)]=constants_2[_0x462a3(0x16b)][_0x462a3(0x15a)],await this[_0x462a3(0x16e)][_0x462a3(0x141)](),await this['logger'][_0x462a3(0x141)]();const _0x38eca7=this[_0x462a3(0x174)](),_0x382441=this['getSourceMemberHandler'](),_0x3c57b5=this[_0x462a3(0x147)](),_0x56934d=this['getComponentsDeployer']();await(0x0,promises_1['pipeline'])(_0x38eca7,_0x382441,_0x3c57b5,_0x56934d),this[_0x462a3(0x12f)][_0x462a3(0x16a)]('Tracking\x20components\x20job\x20has\x20been\x20completed'),this[_0x462a3(0x16e)][_0x462a3(0x151)]=constants_2['LogStatus'][_0x462a3(0x177)];}catch(_0x4cbc62){this[_0x462a3(0x12f)][_0x462a3(0x162)](_0x462a3(0x17e)),this[_0x462a3(0x12f)]['error'](_0x4cbc62[_0x462a3(0x137)]),this['metadataLogger'][_0x462a3(0x151)]=constants_2[_0x462a3(0x16b)][_0x462a3(0x182)];}finally{await this[_0x462a3(0x13a)](),await this['logger'][_0x462a3(0x141)](),await this[_0x462a3(0x16e)][_0x462a3(0x141)]();}}}function a304_0x2e01(_0x18e576,_0x198be6){const _0x32f89f=a304_0x58aa();return a304_0x2e01=function(_0x51c24d,_0x3f2334){_0x51c24d=_0x51c24d-0x12d;let _0x58aa12=_0x32f89f[_0x51c24d];return _0x58aa12;},a304_0x2e01(_0x18e576,_0x198be6);}exports[a304_0x185eac(0x181)]=Job,new Job()[a304_0x185eac(0x14f)]()[a304_0x185eac(0x134)](()=>process[a304_0x185eac(0x135)](0x0))['catch'](_0x1baf2c=>{const _0x3de714=a304_0x185eac;systemLogger['error']('Job\x20Error:\x20'+_0x1baf2c[_0x3de714(0x137)]),process[_0x3de714(0x135)](0x1);});