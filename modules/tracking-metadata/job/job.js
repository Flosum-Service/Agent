const a304_0x1c4265=a304_0x399a;(function(_0x2b4aed,_0x5ef901){const _0x129519=a304_0x399a,_0x37126a=_0x2b4aed();while(!![]){try{const _0x24506a=-parseInt(_0x129519(0xf7))/0x1+parseInt(_0x129519(0xb5))/0x2+parseInt(_0x129519(0x10d))/0x3*(-parseInt(_0x129519(0x10f))/0x4)+-parseInt(_0x129519(0x10b))/0x5*(-parseInt(_0x129519(0xc1))/0x6)+-parseInt(_0x129519(0xf4))/0x7+-parseInt(_0x129519(0xee))/0x8+-parseInt(_0x129519(0x106))/0x9*(-parseInt(_0x129519(0xc7))/0xa);if(_0x24506a===_0x5ef901)break;else _0x37126a['push'](_0x37126a['shift']());}catch(_0x3c4e19){_0x37126a['push'](_0x37126a['shift']());}}}(a304_0x304c,0x9426b));const a304_0x4b49a9=(function(){let _0x4b5d42=!![];return function(_0x1a8d8b,_0xaae8e9){const _0x29192b=_0x4b5d42?function(){if(_0xaae8e9){const _0x3f552d=_0xaae8e9['apply'](_0x1a8d8b,arguments);return _0xaae8e9=null,_0x3f552d;}}:function(){};return _0x4b5d42=![],_0x29192b;};}()),a304_0x424ad0=a304_0x4b49a9(this,function(){const _0x276a4a=a304_0x399a;return a304_0x424ad0['toString']()[_0x276a4a(0xc9)](_0x276a4a(0xbe))[_0x276a4a(0xd9)]()['constructor'](a304_0x424ad0)[_0x276a4a(0xc9)](_0x276a4a(0xbe));});a304_0x424ad0();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1b9a75){const _0x40411e=a304_0x399a;return _0x1b9a75&&_0x1b9a75[_0x40411e(0xfd)]?_0x1b9a75:{'default':_0x1b9a75};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a304_0x1c4265(0xfb)]=void 0x0;function a304_0x304c(){const _0x4afcc2=['../../../constants','MetadataLogger','initManifest','error','message','RestSimpleDeployData','init','execute','success','../../../constants/job','default','readFile','createTrackingSettingRecord','getSourceMemberRetriever','toString','initLogger','metadataLogId','./classes/metadata.retriever','./classes/components.deployer','Tracking\x20setting\x20updated','startDate','join','Tracking\x20components\x20job\x20has\x20been\x20completed','jobId','@flosum/salesforce','./classes/source-member.handler','initInstances','argv','jobStorePath','lastRetrieveDate','create','then','AuthManager','fs/promises','IN_PROGRESS','5943408fjgiNZ','log','update','minimist','targetOrgId','targetOrgCredentials','1641402vxRoaG','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','initMetadataLogger','552651Hievoq','../constants','getComponentsDeployer','getMetadataRetriever','Job','MetadataRetriever','__esModule','Last_Start_Retrieval__c','MANIFEST_FILENAME','timeZone','AxiosInstanceUtils','../../shared/managers/auth.manager','FLOSUM_NAMESPACE','logger','Logger','4848129MqhfUX','apiVersion','exit','./classes/logger/logger','slice','603730fhgrNf','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','57fnfbvE','metadataTypes','198808xzTtTX','path','534154rkxMsl','COMPLETED','parse','SourceMemberRetriever','./classes/source-member.retriever','flosumOrgCredentials','trackingSettingId','LogStatus','flosumInstance','(((.+)+)+)+$','Job\x20Error:\x20','../../../core','6ikDURg','status','metadataLogger','Is_Processed__c','updateTrackingSetting','stream/promises','50WcmALR','catch','search','targetInstance'];a304_0x304c=function(){return _0x4afcc2;};return a304_0x304c();}function a304_0x399a(_0x24b44f,_0x50d827){const _0x20458b=a304_0x304c();return a304_0x399a=function(_0x424ad0,_0x4b49a9){_0x424ad0=_0x424ad0-0xb4;let _0x304c2f=_0x20458b[_0x424ad0];return _0x304c2f;},a304_0x399a(_0x24b44f,_0x50d827);}const minimist_1=__importDefault(require(a304_0x1c4265(0xf1))),core_1=require(a304_0x1c4265(0xc0)),salesforce_1=require(a304_0x1c4265(0xe3)),auth_manager_1=require(a304_0x1c4265(0x102)),logger_1=require(a304_0x1c4265(0x109)),promises_1=require(a304_0x1c4265(0xc6)),promises_2=require(a304_0x1c4265(0xec)),path_1=__importDefault(require(a304_0x1c4265(0xb4))),metadata_retriever_1=require(a304_0x1c4265(0xdc)),components_deployer_1=require(a304_0x1c4265(0xdd)),source_member_retriever_1=require(a304_0x1c4265(0xb9)),source_member_handler_1=require(a304_0x1c4265(0xe4)),metadata_logger_1=require('./classes/metadata-logger'),job_1=require(a304_0x1c4265(0xd4)),constants_1=require(a304_0x1c4265(0xcb)),constants_2=require(a304_0x1c4265(0xf8)),{jobId,jobStorePath}=(0x0,minimist_1[a304_0x1c4265(0xd5)])(process[a304_0x1c4265(0xe6)][a304_0x1c4265(0x10a)](0x2)),systemLogger=new core_1[(a304_0x1c4265(0x105))](jobId);class Job{constructor(){const _0x238893=a304_0x1c4265;this['jobStorePath']=jobStorePath,this[_0x238893(0xe2)]=jobId;}async[a304_0x1c4265(0xcd)](){const _0x3b31ce=a304_0x1c4265,_0x1c4962=path_1[_0x3b31ce(0xd5)][_0x3b31ce(0xe0)](this[_0x3b31ce(0xe7)],job_1[_0x3b31ce(0xff)]),_0x5b94a7=await(0x0,promises_2[_0x3b31ce(0xd6)])(_0x1c4962,{'encoding':'utf-8'})[_0x3b31ce(0xea)](JSON[_0x3b31ce(0xb7)])[_0x3b31ce(0xea)](({details:_0x3abf09})=>_0x3abf09);await(0x0,promises_2['rm'])(_0x1c4962,{'recursive':!![],'force':!![]}),this['apiVersion']=_0x5b94a7[_0x3b31ce(0x107)],this[_0x3b31ce(0xba)]=_0x5b94a7[_0x3b31ce(0xba)],this[_0x3b31ce(0xf3)]=_0x5b94a7['targetOrgCredentials'],this[_0x3b31ce(0xf2)]=_0x5b94a7[_0x3b31ce(0xf2)],this[_0x3b31ce(0xbb)]=_0x5b94a7[_0x3b31ce(0xbb)],this[_0x3b31ce(0xe8)]=_0x5b94a7[_0x3b31ce(0xe8)],this['metadataTypes']=_0x5b94a7[_0x3b31ce(0x10e)],this[_0x3b31ce(0x100)]=_0x5b94a7[_0x3b31ce(0x100)];}async[a304_0x1c4265(0xe5)](){const _0x1da05e=a304_0x1c4265;this[_0x1da05e(0xbd)]=await salesforce_1[_0x1da05e(0x101)][_0x1da05e(0xe9)](new auth_manager_1[(_0x1da05e(0xeb))](this['flosumOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0x1da05e(0xca)]=await salesforce_1[_0x1da05e(0x101)][_0x1da05e(0xe9)](new auth_manager_1[(_0x1da05e(0xeb))](this[_0x1da05e(0xf3)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a304_0x1c4265(0xf6)](){const _0x22d822=a304_0x1c4265;this[_0x22d822(0xc3)]=new metadata_logger_1[(_0x22d822(0xcc))]({'apiVersion':this[_0x22d822(0x107)],'instance':this[_0x22d822(0xbd)],'targetOrgId':this[_0x22d822(0xf2)],'trackingSettingId':this['trackingSettingId'],'startDate':this[_0x22d822(0xdf)]}),this[_0x22d822(0xdb)]=await this[_0x22d822(0xc3)][_0x22d822(0xd1)]();}[a304_0x1c4265(0xda)](){const _0x228256=a304_0x1c4265;this[_0x228256(0x104)]=new logger_1[(_0x228256(0x105))]({'systemLogger':systemLogger,'apiVersion':this[_0x228256(0x107)],'instance':this[_0x228256(0xbd)],'metadataLogId':this[_0x228256(0xdb)],'timeZone':this['timeZone']});}[a304_0x1c4265(0xd8)](){const _0x14c738=a304_0x1c4265;return new source_member_retriever_1[(_0x14c738(0xb8))]({'apiVersion':this['apiVersion'],'instance':this[_0x14c738(0xca)],'logger':this[_0x14c738(0x104)],'lastRetrieveDate':this[_0x14c738(0xe8)],'currentRetrieveDate':this[_0x14c738(0xdf)],'metadataTypes':this[_0x14c738(0x10e)]});}['getSourceMemberHandler'](){const _0x3b2e0a=a304_0x1c4265;return new source_member_handler_1['SourceMemberHandler']({'instance':this['flosumInstance'],'apiVersion':this[_0x3b2e0a(0x107)],'logger':this['logger'],'targetOrgId':this['targetOrgId']});}[a304_0x1c4265(0xfa)](){const _0x4889b0=a304_0x1c4265;return new metadata_retriever_1[(_0x4889b0(0xfc))]({'instance':this[_0x4889b0(0xca)],'apiVersion':this[_0x4889b0(0x107)],'logger':this[_0x4889b0(0x104)],'metadataTypes':this['metadataTypes']});}[a304_0x1c4265(0xf9)](){const _0x2d5c72=a304_0x1c4265;return new components_deployer_1['ComponentsDeployer']({'instance':this[_0x2d5c72(0xbd)],'logger':this[_0x2d5c72(0x104)],'apiVersion':this[_0x2d5c72(0x107)],'targetOrgId':this[_0x2d5c72(0xf2)],'trackingSettingId':this[_0x2d5c72(0xbb)]});}[a304_0x1c4265(0xd7)](){const _0x2d7ea2=a304_0x1c4265;return{'attributes':{'type':constants_1[_0x2d7ea2(0x103)]+'Tracking_Setting__c'},'Id':this[_0x2d7ea2(0xbb)],[constants_1[_0x2d7ea2(0x103)]+_0x2d7ea2(0xc4)]:![],[constants_1[_0x2d7ea2(0x103)]+_0x2d7ea2(0xfe)]:this[_0x2d7ea2(0xdf)]};}async[a304_0x1c4265(0xc5)](){const _0x443553=a304_0x1c4265,_0x8c41c7=this['createTrackingSettingRecord'](),_0x30433d=new salesforce_1[(_0x443553(0xd0))]({'instance':this[_0x443553(0xbd)],'objectName':constants_1['FLOSUM_NAMESPACE']+'Tracking_Setting__c','api':this[_0x443553(0x107)],'allOrNone':![],'externalIdField':'Id'}),_0x725bca=await _0x30433d['execute']({'records':[_0x8c41c7]}),_0x77e7ec=_0x725bca['at'](0x0);(_0x77e7ec===null||_0x77e7ec===void 0x0?void 0x0:_0x77e7ec[_0x443553(0xd3)])?this[_0x443553(0x104)]['log'](_0x443553(0xde)):this[_0x443553(0x104)][_0x443553(0xef)](_0x443553(0x10c)+(_0x77e7ec===null||_0x77e7ec===void 0x0?void 0x0:_0x77e7ec[_0x443553(0xce)]));}async[a304_0x1c4265(0xd2)](){const _0x1f4d26=a304_0x1c4265;await this[_0x1f4d26(0xcd)](),this[_0x1f4d26(0xdf)]=new Date()['getTime']();try{await this['initInstances'](),await this['initMetadataLogger'](),this[_0x1f4d26(0xda)](),this[_0x1f4d26(0x104)][_0x1f4d26(0xef)](_0x1f4d26(0xf5)+this['jobId']),this[_0x1f4d26(0xc3)]['status']=constants_2[_0x1f4d26(0xbc)][_0x1f4d26(0xed)],await this['metadataLogger'][_0x1f4d26(0xf0)](),await this[_0x1f4d26(0x104)][_0x1f4d26(0xf0)]();const _0x35963c=this[_0x1f4d26(0xd8)](),_0x4ecb80=this['getSourceMemberHandler'](),_0x5a481a=this[_0x1f4d26(0xfa)](),_0x4da5e2=this[_0x1f4d26(0xf9)]();await(0x0,promises_1['pipeline'])(_0x35963c,_0x4ecb80,_0x5a481a,_0x4da5e2),this[_0x1f4d26(0x104)][_0x1f4d26(0xef)](_0x1f4d26(0xe1)),this[_0x1f4d26(0xc3)][_0x1f4d26(0xc2)]=constants_2['LogStatus'][_0x1f4d26(0xb6)];}catch(_0x5b0cda){this[_0x1f4d26(0x104)][_0x1f4d26(0xce)]('Tracking\x20components\x20job\x20has\x20been\x20failed'),this[_0x1f4d26(0x104)][_0x1f4d26(0xce)](_0x5b0cda[_0x1f4d26(0xcf)]),this[_0x1f4d26(0xc3)][_0x1f4d26(0xc2)]=constants_2['LogStatus']['EXCEPTION'];}finally{await this['updateTrackingSetting'](),await this[_0x1f4d26(0x104)][_0x1f4d26(0xf0)](),await this['metadataLogger'][_0x1f4d26(0xf0)]();}}}exports[a304_0x1c4265(0xfb)]=Job,new Job()[a304_0x1c4265(0xd2)]()[a304_0x1c4265(0xea)](()=>process[a304_0x1c4265(0x108)](0x0))[a304_0x1c4265(0xc8)](_0x3022db=>{const _0x4781dc=a304_0x1c4265;systemLogger[_0x4781dc(0xce)](_0x4781dc(0xbf)+_0x3022db['message']),process[_0x4781dc(0x108)](0x1);});