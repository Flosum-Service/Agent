function a299_0x1c9e(){const _0x34f8ad=['3726KKIPSP','targetOrgId','Logger','logger','initInstances','__esModule','../../../constants/job','metadataLogId','AuthManager','__importDefault','../../../constants','pipeline','AxiosInstanceUtils','getSourceMemberRetriever','parse','108VoZptS','initLogger','SourceMemberHandler','@flosum/salesforce','Tracking\x20components\x20job\x20has\x20been\x20failed','error','966236uIHLBp','Last_Start_Retrieval__c','apply','argv','exit','join','createTrackingSettingRecord','13789764auXPDf','status','flosumOrgCredentials','startDate','../constants','Tracking_Setting__c','48UonEcO','LogStatus','fs/promises','EXCEPTION','jobStorePath','success','1853187tYkdbv','init','slice','3548733PJdjEW','timeZone','flosumInstance','targetOrgCredentials','initManifest','then','(((.+)+)+)+$','IN_PROGRESS','update','Is_Processed__c','ComponentsDeployer','MetadataRetriever','execute','./classes/metadata.retriever','./classes/metadata-logger','9254862XvFvBt','search','COMPLETED','./classes/logger/logger','defineProperty','path','30OtbADL','MANIFEST_FILENAME','metadataLogger','Tracking\x20setting\x20updated','toString','getComponentsDeployer','jobId','targetInstance','trackingSettingId','metadataTypes','./classes/source-member.retriever','initMetadataLogger','minimist','RestSimpleDeployData','apiVersion','./classes/components.deployer','updateTrackingSetting','../../../core','SourceMemberRetriever','message','utf-8','getMetadataRetriever','constructor','Tracking\x20components\x20job\x20has\x20been\x20started\x20with\x20id:\x20','create','catch','Tracking\x20components\x20job\x20has\x20been\x20completed','lastRetrieveDate','Job','Tracking\x20setting\x20not\x20updated\x20\x0a\x20','6232750uOmBNo','log','FLOSUM_NAMESPACE'];a299_0x1c9e=function(){return _0x34f8ad;};return a299_0x1c9e();}const a299_0x163fdb=a299_0xbe22;function a299_0xbe22(_0x110a84,_0x4774b0){const _0x141f2b=a299_0x1c9e();return a299_0xbe22=function(_0x39d616,_0x4c91d1){_0x39d616=_0x39d616-0x12d;let _0x1c9ed7=_0x141f2b[_0x39d616];return _0x1c9ed7;},a299_0xbe22(_0x110a84,_0x4774b0);}(function(_0x2b4bb7,_0x3e3752){const _0x49fbf5=a299_0xbe22,_0x2b8baf=_0x2b4bb7();while(!![]){try{const _0x18a957=parseInt(_0x49fbf5(0x180))/0x1*(parseInt(_0x49fbf5(0x12e))/0x2)+parseInt(_0x49fbf5(0x14a))/0x3+-parseInt(_0x49fbf5(0x134))/0x4*(parseInt(_0x49fbf5(0x15f))/0x5)+-parseInt(_0x49fbf5(0x159))/0x6+-parseInt(_0x49fbf5(0x147))/0x7*(-parseInt(_0x49fbf5(0x141))/0x8)+parseInt(_0x49fbf5(0x13b))/0x9+-parseInt(_0x49fbf5(0x17d))/0xa;if(_0x18a957===_0x3e3752)break;else _0x2b8baf['push'](_0x2b8baf['shift']());}catch(_0x54d021){_0x2b8baf['push'](_0x2b8baf['shift']());}}}(a299_0x1c9e,0xd9333));const a299_0x4c91d1=(function(){let _0x1321cb=!![];return function(_0x455ab0,_0x4f40d9){const _0x230baf=_0x1321cb?function(){const _0x531681=a299_0xbe22;if(_0x4f40d9){const _0x13255d=_0x4f40d9[_0x531681(0x136)](_0x455ab0,arguments);return _0x4f40d9=null,_0x13255d;}}:function(){};return _0x1321cb=![],_0x230baf;};}()),a299_0x39d616=a299_0x4c91d1(this,function(){const _0x452862=a299_0xbe22;return a299_0x39d616[_0x452862(0x163)]()[_0x452862(0x15a)](_0x452862(0x150))[_0x452862(0x163)]()[_0x452862(0x175)](a299_0x39d616)['search']('(((.+)+)+)+$');});a299_0x39d616();'use strict';var __importDefault=this&&this[a299_0x163fdb(0x189)]||function(_0x39048b){const _0x278f39=a299_0x163fdb;return _0x39048b&&_0x39048b[_0x278f39(0x185)]?_0x39048b:{'default':_0x39048b};};Object[a299_0x163fdb(0x15d)](exports,a299_0x163fdb(0x185),{'value':!![]}),exports['Job']=void 0x0;const minimist_1=__importDefault(require(a299_0x163fdb(0x16b))),core_1=require(a299_0x163fdb(0x170)),salesforce_1=require(a299_0x163fdb(0x131)),auth_manager_1=require('../../shared/managers/auth.manager'),logger_1=require(a299_0x163fdb(0x15c)),promises_1=require('stream/promises'),promises_2=require(a299_0x163fdb(0x143)),path_1=__importDefault(require(a299_0x163fdb(0x15e))),metadata_retriever_1=require(a299_0x163fdb(0x157)),components_deployer_1=require(a299_0x163fdb(0x16e)),source_member_retriever_1=require(a299_0x163fdb(0x169)),source_member_handler_1=require('./classes/source-member.handler'),metadata_logger_1=require(a299_0x163fdb(0x158)),job_1=require(a299_0x163fdb(0x186)),constants_1=require(a299_0x163fdb(0x18a)),constants_2=require(a299_0x163fdb(0x13f)),{jobId,jobStorePath}=(0x0,minimist_1['default'])(process[a299_0x163fdb(0x137)][a299_0x163fdb(0x149)](0x2)),systemLogger=new core_1[(a299_0x163fdb(0x182))](jobId);class Job{constructor(){const _0x234e19=a299_0x163fdb;this[_0x234e19(0x145)]=jobStorePath,this[_0x234e19(0x165)]=jobId;}async[a299_0x163fdb(0x14e)](){const _0x6cc0f6=a299_0x163fdb,_0x355a5b=path_1['default'][_0x6cc0f6(0x139)](this['jobStorePath'],job_1[_0x6cc0f6(0x160)]),_0x52e9c6=await(0x0,promises_2['readFile'])(_0x355a5b,{'encoding':_0x6cc0f6(0x173)})[_0x6cc0f6(0x14f)](JSON[_0x6cc0f6(0x12d)])[_0x6cc0f6(0x14f)](({details:_0x200edf})=>_0x200edf);await(0x0,promises_2['rm'])(_0x355a5b,{'recursive':!![],'force':!![]}),this['apiVersion']=_0x52e9c6[_0x6cc0f6(0x16d)],this[_0x6cc0f6(0x13d)]=_0x52e9c6['flosumOrgCredentials'],this[_0x6cc0f6(0x14d)]=_0x52e9c6[_0x6cc0f6(0x14d)],this[_0x6cc0f6(0x181)]=_0x52e9c6[_0x6cc0f6(0x181)],this['trackingSettingId']=_0x52e9c6[_0x6cc0f6(0x167)],this['lastRetrieveDate']=_0x52e9c6[_0x6cc0f6(0x17a)],this[_0x6cc0f6(0x168)]=_0x52e9c6[_0x6cc0f6(0x168)],this['timeZone']=_0x52e9c6['timeZone'];}async[a299_0x163fdb(0x184)](){const _0xd9c619=a299_0x163fdb;this['flosumInstance']=await salesforce_1[_0xd9c619(0x18c)][_0xd9c619(0x177)](new auth_manager_1[(_0xd9c619(0x188))](this[_0xd9c619(0x13d)]),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),this[_0xd9c619(0x166)]=await salesforce_1['AxiosInstanceUtils'][_0xd9c619(0x177)](new auth_manager_1[(_0xd9c619(0x188))](this['targetOrgCredentials']),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a299_0x163fdb(0x16a)](){const _0x5025c7=a299_0x163fdb;this[_0x5025c7(0x161)]=new metadata_logger_1['MetadataLogger']({'apiVersion':this[_0x5025c7(0x16d)],'instance':this[_0x5025c7(0x14c)],'targetOrgId':this[_0x5025c7(0x181)],'trackingSettingId':this[_0x5025c7(0x167)],'startDate':this[_0x5025c7(0x13e)]}),this[_0x5025c7(0x187)]=await this['metadataLogger'][_0x5025c7(0x148)]();}[a299_0x163fdb(0x12f)](){const _0xdc9b2b=a299_0x163fdb;this[_0xdc9b2b(0x183)]=new logger_1[(_0xdc9b2b(0x182))]({'systemLogger':systemLogger,'apiVersion':this[_0xdc9b2b(0x16d)],'instance':this[_0xdc9b2b(0x14c)],'metadataLogId':this[_0xdc9b2b(0x187)],'timeZone':this[_0xdc9b2b(0x14b)]});}['getSourceMemberRetriever'](){const _0x2bb4bd=a299_0x163fdb;return new source_member_retriever_1[(_0x2bb4bd(0x171))]({'apiVersion':this[_0x2bb4bd(0x16d)],'instance':this[_0x2bb4bd(0x166)],'logger':this['logger'],'lastRetrieveDate':this[_0x2bb4bd(0x17a)],'currentRetrieveDate':this[_0x2bb4bd(0x13e)],'metadataTypes':this[_0x2bb4bd(0x168)]});}['getSourceMemberHandler'](){const _0x30614d=a299_0x163fdb;return new source_member_handler_1[(_0x30614d(0x130))]({'instance':this['flosumInstance'],'apiVersion':this[_0x30614d(0x16d)],'logger':this['logger'],'targetOrgId':this[_0x30614d(0x181)]});}[a299_0x163fdb(0x174)](){const _0x448ebb=a299_0x163fdb;return new metadata_retriever_1[(_0x448ebb(0x155))]({'instance':this[_0x448ebb(0x166)],'apiVersion':this[_0x448ebb(0x16d)],'logger':this[_0x448ebb(0x183)],'metadataTypes':this[_0x448ebb(0x168)]});}[a299_0x163fdb(0x164)](){const _0x3ca982=a299_0x163fdb;return new components_deployer_1[(_0x3ca982(0x154))]({'instance':this[_0x3ca982(0x14c)],'logger':this['logger'],'apiVersion':this[_0x3ca982(0x16d)],'targetOrgId':this[_0x3ca982(0x181)],'trackingSettingId':this[_0x3ca982(0x167)]});}[a299_0x163fdb(0x13a)](){const _0x6fd380=a299_0x163fdb;return{'attributes':{'type':constants_1[_0x6fd380(0x17f)]+'Tracking_Setting__c'},'Id':this[_0x6fd380(0x167)],[constants_1[_0x6fd380(0x17f)]+_0x6fd380(0x153)]:![],[constants_1[_0x6fd380(0x17f)]+_0x6fd380(0x135)]:this['startDate']};}async[a299_0x163fdb(0x16f)](){const _0x1d50e9=a299_0x163fdb,_0x27b384=this['createTrackingSettingRecord'](),_0x8bce31=new salesforce_1[(_0x1d50e9(0x16c))]({'instance':this[_0x1d50e9(0x14c)],'objectName':constants_1[_0x1d50e9(0x17f)]+_0x1d50e9(0x140),'api':this[_0x1d50e9(0x16d)],'allOrNone':![],'externalIdField':'Id'}),_0x3f2471=await _0x8bce31[_0x1d50e9(0x156)]({'records':[_0x27b384]}),_0x5a5638=_0x3f2471['at'](0x0);(_0x5a5638===null||_0x5a5638===void 0x0?void 0x0:_0x5a5638[_0x1d50e9(0x146)])?this['logger'][_0x1d50e9(0x17e)](_0x1d50e9(0x162)):this[_0x1d50e9(0x183)][_0x1d50e9(0x17e)](_0x1d50e9(0x17c)+(_0x5a5638===null||_0x5a5638===void 0x0?void 0x0:_0x5a5638[_0x1d50e9(0x133)]));}async[a299_0x163fdb(0x156)](){const _0x6c7d8d=a299_0x163fdb;await this[_0x6c7d8d(0x14e)](),this[_0x6c7d8d(0x13e)]=new Date()['getTime']();try{await this[_0x6c7d8d(0x184)](),await this[_0x6c7d8d(0x16a)](),this['initLogger'](),this[_0x6c7d8d(0x183)][_0x6c7d8d(0x17e)](_0x6c7d8d(0x176)+this[_0x6c7d8d(0x165)]),this[_0x6c7d8d(0x161)][_0x6c7d8d(0x13c)]=constants_2[_0x6c7d8d(0x142)][_0x6c7d8d(0x151)],await this[_0x6c7d8d(0x161)]['update'](),await this['logger']['update']();const _0x170060=this[_0x6c7d8d(0x18d)](),_0x3509c1=this['getSourceMemberHandler'](),_0x97ae42=this['getMetadataRetriever'](),_0x121d4d=this[_0x6c7d8d(0x164)]();await(0x0,promises_1[_0x6c7d8d(0x18b)])(_0x170060,_0x3509c1,_0x97ae42,_0x121d4d),this['logger'][_0x6c7d8d(0x17e)](_0x6c7d8d(0x179)),this[_0x6c7d8d(0x161)][_0x6c7d8d(0x13c)]=constants_2['LogStatus'][_0x6c7d8d(0x15b)];}catch(_0x5059b0){this[_0x6c7d8d(0x183)][_0x6c7d8d(0x133)](_0x6c7d8d(0x132)),this[_0x6c7d8d(0x183)][_0x6c7d8d(0x133)](_0x5059b0[_0x6c7d8d(0x172)]),this['metadataLogger'][_0x6c7d8d(0x13c)]=constants_2[_0x6c7d8d(0x142)][_0x6c7d8d(0x144)];}finally{await this[_0x6c7d8d(0x16f)](),await this['logger']['update'](),await this['metadataLogger'][_0x6c7d8d(0x152)]();}}}exports[a299_0x163fdb(0x17b)]=Job,new Job()[a299_0x163fdb(0x156)]()[a299_0x163fdb(0x14f)](()=>process['exit'](0x0))[a299_0x163fdb(0x178)](_0x3a18f9=>{const _0x1f40e4=a299_0x163fdb;systemLogger['error']('Job\x20Error:\x20'+_0x3a18f9[_0x1f40e4(0x172)]),process[_0x1f40e4(0x138)](0x1);});