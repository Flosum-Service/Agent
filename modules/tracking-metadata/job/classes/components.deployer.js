function a311_0x4419(){const _0x5db020=['__importDefault','orgComponentsToDeployChunk','fullName','instance','addAttachmentToChunk','jszip','_final','from','push','handleDeployResult','default','deploy','__esModule','generateAsync','Label__c','Source_Member_Id__c','919440mIaOJu','constructor','API_Name__c','2002014jZEOwH','7688zjUqhW','Tracking_Setting__c','20XzSHGI','targetOrgId','2124199ynRabE','Folder__c','search','CompositeBinaryDeployData','RestSimpleDeployData','has','records','1EpzFPc','binaryRecordsSizeChunk','Is_Deleted__c','type','apiVersion','application/zip','logger','Process\x20completed\x20for\x20','apply','6qgBZTK','deployOrgComponents','2177452QHIXyi','BINARY_FIELD_NAME','Writable','1297833hklnZr','../../constants','execute','trackingSettingId','Attachment_ID__c','OrganisationName__c','_write','successDeployedCounter','nodebuffer','Component_Type__c','componentId','FLOSUM_NAMESPACE','defineProperty','\x20components','then','populateAttachmentId','addOrgComponentToChunk','Revision_Counter__c','isNameObsolete','createZip','Retrieved','../../../../constants','Name__c','error','attachmentId','resetChunks','5399805UVxKHX','Last_Updated_By__c','ATTACHMENT_OBJECT_NAME','fileName','sourceMemberId','ORG_COMPONENT_OBJECT_NAME','attachmentsToDeployChunk','Status__c','Readable','revisionCounter','isReachedMaxChunk','toString','CompositeConstants','(((.+)+)+)+$','deployAttachments','file'];a311_0x4419=function(){return _0x5db020;};return a311_0x4419();}const a311_0x1e2985=a311_0xfaed;(function(_0x4e9b1f,_0x307cd7){const _0x3a555a=a311_0xfaed,_0x2f9e55=_0x4e9b1f();while(!![]){try{const _0x754e92=-parseInt(_0x3a555a(0x1fb))/0x1*(-parseInt(_0x3a555a(0x206))/0x2)+-parseInt(_0x3a555a(0x209))/0x3+parseInt(_0x3a555a(0x1ec))/0x4+parseInt(_0x3a555a(0x223))/0x5*(-parseInt(_0x3a555a(0x204))/0x6)+parseInt(_0x3a555a(0x1f4))/0x7+-parseInt(_0x3a555a(0x1f0))/0x8+parseInt(_0x3a555a(0x1ef))/0x9*(parseInt(_0x3a555a(0x1f2))/0xa);if(_0x754e92===_0x307cd7)break;else _0x2f9e55['push'](_0x2f9e55['shift']());}catch(_0x242093){_0x2f9e55['push'](_0x2f9e55['shift']());}}}(a311_0x4419,0x871ba));const a311_0x2528ad=(function(){let _0x4634a2=!![];return function(_0x256a6b,_0x56bc9e){const _0x279e8e=_0x4634a2?function(){const _0x26c8c1=a311_0xfaed;if(_0x56bc9e){const _0x3d2da9=_0x56bc9e[_0x26c8c1(0x203)](_0x256a6b,arguments);return _0x56bc9e=null,_0x3d2da9;}}:function(){};return _0x4634a2=![],_0x279e8e;};}()),a311_0x438b5e=a311_0x2528ad(this,function(){const _0x307aeb=a311_0xfaed;return a311_0x438b5e[_0x307aeb(0x1d7)]()['search'](_0x307aeb(0x1d9))[_0x307aeb(0x1d7)]()[_0x307aeb(0x1ed)](a311_0x438b5e)[_0x307aeb(0x1f6)](_0x307aeb(0x1d9));});a311_0x438b5e();'use strict';var __importDefault=this&&this[a311_0x1e2985(0x1dc)]||function(_0x53090c){const _0xc7a41e=a311_0x1e2985;return _0x53090c&&_0x53090c[_0xc7a41e(0x1e8)]?_0x53090c:{'default':_0x53090c};};Object[a311_0x1e2985(0x215)](exports,a311_0x1e2985(0x1e8),{'value':!![]}),exports['ComponentsDeployer']=void 0x0;function a311_0xfaed(_0x27043a,_0x1b5a1f){const _0x124e5d=a311_0x4419();return a311_0xfaed=function(_0x438b5e,_0x2528ad){_0x438b5e=_0x438b5e-0x1d7;let _0x441929=_0x124e5d[_0x438b5e];return _0x441929;},a311_0xfaed(_0x27043a,_0x1b5a1f);}const salesforce_1=require('@flosum/salesforce'),constants_1=require(a311_0x1e2985(0x20a)),stream_1=require('stream'),jszip_1=__importDefault(require(a311_0x1e2985(0x1e1))),constants_2=require(a311_0x1e2985(0x21e)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a311_0x1e2985(0x20d),CONTENT_TYPE=a311_0x1e2985(0x200);class ComponentsDeployer extends stream_1[a311_0x1e2985(0x208)]{constructor({apiVersion:_0x2cfc0f,instance:_0x2a8076,logger:_0x2cf11f,targetOrgId:_0x428327,trackingSettingId:_0x32c065}){const _0x31648e=a311_0x1e2985;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x31648e(0x1fc)]=0x0,this[_0x31648e(0x1dd)]=[],this[_0x31648e(0x210)]=0x0,this[_0x31648e(0x1ff)]=_0x2cfc0f,this[_0x31648e(0x1df)]=_0x2a8076,this[_0x31648e(0x201)]=_0x2cf11f,this['targetOrgId']=_0x428327,this[_0x31648e(0x20c)]=_0x32c065;}async[a311_0x1e2985(0x1e7)](){const _0x58204d=a311_0x1e2985;await this[_0x58204d(0x1da)]()[_0x58204d(0x217)](_0x1805c0=>this[_0x58204d(0x218)](_0x1805c0))[_0x58204d(0x217)](()=>this['deployOrgComponents']())[_0x58204d(0x217)](_0x3d7a1c=>this[_0x58204d(0x1e5)](_0x3d7a1c)),this['resetChunks']();}['deployAttachments'](){const _0x257146=a311_0x1e2985,_0x24bc84=new salesforce_1[(_0x257146(0x1f7))]({'instance':this[_0x257146(0x1df)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x257146(0x1ff)]});return _0x24bc84[_0x257146(0x20b)](this[_0x257146(0x229)]);}[a311_0x1e2985(0x205)](){const _0x50056a=a311_0x1e2985,_0x14e24e=new salesforce_1[(_0x50056a(0x1f8))]({'instance':this[_0x50056a(0x1df)],'objectName':constants_1[_0x50056a(0x228)],'api':this[_0x50056a(0x1ff)],'allOrNone':![],'externalIdField':'Id'});return _0x14e24e[_0x50056a(0x20b)]({'records':this['orgComponentsToDeployChunk']});}async['handleDeployResult'](_0xe2d22d){const _0x2fff9e=a311_0x1e2985;for(const {success:_0x29881b,error:_0x1f98ca}of _0xe2d22d){if(_0x29881b){this[_0x2fff9e(0x210)]++;continue;}_0x1f98ca&&this['logger'][_0x2fff9e(0x220)](_0x1f98ca);}}[a311_0x1e2985(0x22d)](_0x140968){const _0x4fe3cf=a311_0x1e2985;return _0x140968+this[_0x4fe3cf(0x1fc)]>=salesforce_1[_0x4fe3cf(0x1d8)]['MAX_BODY_SIZE']||this[_0x4fe3cf(0x229)]['records']['length']===MAX_COMPOSITE_CHUNK_COUNT;}[a311_0x1e2985(0x222)](){const _0x5a1f1b=a311_0x1e2985;this[_0x5a1f1b(0x1fc)]=0x0,this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x5a1f1b(0x1dd)]=[];}[a311_0x1e2985(0x218)](_0x443f23){const _0x4d7eb4=a311_0x1e2985;for(const _0x3cea90 in _0x443f23){this[_0x4d7eb4(0x1dd)][_0x3cea90][ATTACHMENT_FIELD_NAME]=_0x443f23[_0x3cea90]['id'];}}async[a311_0x1e2985(0x1e0)](_0x187617,_0x34c000){const _0x5b9c74=a311_0x1e2985,{listMetadataItem:_0x102803,sourceMemberRecord:_0x167f2e}=_0x187617,_0x371d7e={'attributes':{'type':constants_1[_0x5b9c74(0x225)],'binaryPartName':_0x102803[_0x5b9c74(0x1de)],'binaryPartNameAlias':constants_1[_0x5b9c74(0x207)]},'Id':_0x167f2e[_0x5b9c74(0x221)],'Name':_0x102803[_0x5b9c74(0x1de)],'Description':_0x102803[_0x5b9c74(0x1fe)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x5b9c74(0x1f3)],'Body':_0x102803[_0x5b9c74(0x1de)]},_0x456021={'binaryFieldName':constants_1[_0x5b9c74(0x207)],'name':_0x102803[_0x5b9c74(0x1de)],'value':stream_1[_0x5b9c74(0x22b)][_0x5b9c74(0x1e3)](_0x34c000)};this[_0x5b9c74(0x229)][_0x5b9c74(0x1fa)][_0x5b9c74(0x1e4)](_0x371d7e),this[_0x5b9c74(0x229)]['binary'][_0x5b9c74(0x1e4)](_0x456021);}[a311_0x1e2985(0x21c)](_0x2c5834){const _0x512e35=a311_0x1e2985,_0x3fa5af=new jszip_1[(_0x512e35(0x1e6))]();for(const _0x8c3132 in _0x2c5834){_0x3fa5af[_0x512e35(0x1db)](_0x8c3132,_0x2c5834[_0x8c3132]);}return _0x3fa5af[_0x512e35(0x1e9)]({'type':_0x512e35(0x211)});}[a311_0x1e2985(0x219)](_0x5a0fe6,_0x1a48ec){const _0x407bd2=a311_0x1e2985,_0x57ceb0={'attributes':{'type':constants_1['ORG_COMPONENT_OBJECT_NAME']},'Id':_0x1a48ec[_0x407bd2(0x213)],[constants_2[_0x407bd2(0x214)]+_0x407bd2(0x1fd)]:_0x1a48ec[_0x407bd2(0x21b)],[constants_2[_0x407bd2(0x214)]+_0x407bd2(0x21a)]:_0x1a48ec[_0x407bd2(0x22c)],[constants_2[_0x407bd2(0x214)]+_0x407bd2(0x1eb)]:_0x1a48ec[_0x407bd2(0x227)],[constants_2[_0x407bd2(0x214)]+_0x407bd2(0x224)]:_0x1a48ec['changedBy'],[constants_2[_0x407bd2(0x214)]+_0x407bd2(0x1ee)]:_0x5a0fe6['fullName'],[constants_2[_0x407bd2(0x214)]+_0x407bd2(0x21f)]:_0x5a0fe6[_0x407bd2(0x1de)],[constants_2['FLOSUM_NAMESPACE']+_0x407bd2(0x212)]:_0x5a0fe6[_0x407bd2(0x1fe)],[constants_2['FLOSUM_NAMESPACE']+_0x407bd2(0x1ea)]:_0x5a0fe6[_0x407bd2(0x226)],[constants_2['FLOSUM_NAMESPACE']+_0x407bd2(0x1f5)]:constants_1['METADATA_FOLDER_MAP'][_0x407bd2(0x1f9)](_0x5a0fe6[_0x407bd2(0x1fe)])||null,[constants_2[_0x407bd2(0x214)]+'Is_Retrieved__c']:!![],[constants_2[_0x407bd2(0x214)]+_0x407bd2(0x20e)]:this['targetOrgId'],[constants_2['FLOSUM_NAMESPACE']+_0x407bd2(0x1f1)]:this['trackingSettingId'],[constants_2['FLOSUM_NAMESPACE']+_0x407bd2(0x22a)]:_0x407bd2(0x21d)};this[_0x407bd2(0x1dd)][_0x407bd2(0x1e4)](_0x57ceb0);}async[a311_0x1e2985(0x20f)](_0x5893a5,_0x384fce,_0x5a2de1){const _0x4df808=a311_0x1e2985;try{const {listMetadataItem:_0x105b43,sourceMemberRecord:_0x595298,files:_0x12b407}=_0x5893a5,_0x4ac452=await this['createZip'](_0x12b407),_0x19685e=Buffer['byteLength'](_0x4ac452);this[_0x4df808(0x22d)](_0x19685e)&&await this['deploy'](),this[_0x4df808(0x1fc)]+=_0x19685e,await this[_0x4df808(0x1e0)](_0x5893a5,_0x4ac452),this[_0x4df808(0x219)](_0x105b43,_0x595298),_0x5a2de1();}catch(_0x1999ee){_0x5a2de1(_0x1999ee);}}async[a311_0x1e2985(0x1e2)](_0x4fad55){const _0x21cfb3=a311_0x1e2985;try{this[_0x21cfb3(0x229)]['records']['length']&&this[_0x21cfb3(0x1dd)]['length']&&await this['deploy'](),this['logger']['log'](_0x21cfb3(0x202)+this[_0x21cfb3(0x210)]+_0x21cfb3(0x216)),await this[_0x21cfb3(0x201)]['update'](),_0x4fad55();}catch(_0x3cce97){_0x4fad55(_0x3cce97);}}}exports['ComponentsDeployer']=ComponentsDeployer;