function a340_0x31d3(){const _0x33ac9b=['9iRKhKR','_write','update','Source_Member_Id__c','logger','fileName','apply','1327308KFWhlv','file','API_Name__c','attachmentId','nodebuffer','7284848Sahrct','records','sourceMemberId','../../constants','isNameObsolete','37151830SOgfTv','1226354gCcNoc','10365236PGoLdr','revisionCounter','ATTACHMENT_OBJECT_NAME','560155BWucnj','addOrgComponentToChunk','resetChunks','createZip','Too\x20Large','isReachedMaxChunk','push','type','Component\x20too\x20large.\x20Type:\x20','BINARY_FIELD_NAME','instance','log','@flosum/salesforce','Is_Retrieved__c','Is_Deleted__c','57Rmfuvk','addAttachmentToChunk','18SiRRoQ','generateAsync','(((.+)+)+)+$','205588MOuAPa','search','\x20components','deploy','defineProperty','Tracking_Setting__c','RestSimpleDeployData','stream','successDeployedCounter','Attachment_ID__c','METADATA_FOLDER_MAP','handleDeployResult','execute','binaryRecordsSizeChunk','Status__c','Writable','then','CompositeBinaryDeployData','application/zip','error','attachmentsToDeployChunk','Label__c','Process\x20completed\x20for\x20','orgComponentsToDeployChunk','ComponentsDeployer','FLOSUM_NAMESPACE','trackingSettingId','length','fullName','MAX_BODY_SIZE','CompositeConstants','apiVersion','deployOrgComponents','deployAttachments','Folder__c','Name__c',',\x20Name:\x20','Retrieved','ORG_COMPONENT_OBJECT_NAME','Component_Type__c','../../../../constants'];a340_0x31d3=function(){return _0x33ac9b;};return a340_0x31d3();}const a340_0x4366e7=a340_0x200c;function a340_0x200c(_0x1a55a3,_0x33deb4){const _0x1ddbdc=a340_0x31d3();return a340_0x200c=function(_0x88ecfd,_0x34877e){_0x88ecfd=_0x88ecfd-0xeb;let _0x31d305=_0x1ddbdc[_0x88ecfd];return _0x31d305;},a340_0x200c(_0x1a55a3,_0x33deb4);}(function(_0x49948e,_0x50b81b){const _0x37e5d1=a340_0x200c,_0x640e1a=_0x49948e();while(!![]){try{const _0x5eab1b=-parseInt(_0x37e5d1(0x12f))/0x1+-parseInt(_0x37e5d1(0x124))/0x2+parseInt(_0x37e5d1(0xef))/0x3*(parseInt(_0x37e5d1(0xf4))/0x4)+parseInt(_0x37e5d1(0x133))/0x5*(parseInt(_0x37e5d1(0xf1))/0x6)+-parseInt(_0x37e5d1(0x130))/0x7+-parseInt(_0x37e5d1(0x129))/0x8+parseInt(_0x37e5d1(0x11d))/0x9*(parseInt(_0x37e5d1(0x12e))/0xa);if(_0x5eab1b===_0x50b81b)break;else _0x640e1a['push'](_0x640e1a['shift']());}catch(_0x1d7e1d){_0x640e1a['push'](_0x640e1a['shift']());}}}(a340_0x31d3,0xb63d9));const a340_0x34877e=(function(){let _0x27717c=!![];return function(_0x24a8d1,_0x205bc6){const _0x38230f=_0x27717c?function(){const _0x3fb3e7=a340_0x200c;if(_0x205bc6){const _0xf3e6ea=_0x205bc6[_0x3fb3e7(0x123)](_0x24a8d1,arguments);return _0x205bc6=null,_0xf3e6ea;}}:function(){};return _0x27717c=![],_0x38230f;};}()),a340_0x88ecfd=a340_0x34877e(this,function(){const _0x33a156=a340_0x200c;return a340_0x88ecfd['toString']()[_0x33a156(0xf5)](_0x33a156(0xf3))['toString']()['constructor'](a340_0x88ecfd)[_0x33a156(0xf5)](_0x33a156(0xf3));});a340_0x88ecfd();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5dfeca){return _0x5dfeca&&_0x5dfeca['__esModule']?_0x5dfeca:{'default':_0x5dfeca};};Object[a340_0x4366e7(0xf8)](exports,'__esModule',{'value':!![]}),exports[a340_0x4366e7(0x10c)]=void 0x0;const salesforce_1=require(a340_0x4366e7(0xec)),constants_1=require(a340_0x4366e7(0x12c)),stream_1=require(a340_0x4366e7(0xfb)),jszip_1=__importDefault(require('jszip')),constants_2=require(a340_0x4366e7(0x11c)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,MAX_SINGLE_FILE_SIZE=0x5a06e0,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a340_0x4366e7(0x10d)]+a340_0x4366e7(0xfd),CONTENT_TYPE=a340_0x4366e7(0x106);class ComponentsDeployer extends stream_1[a340_0x4366e7(0x103)]{constructor({apiVersion:_0x3853b7,instance:_0x3a371e,logger:_0x48275e,targetOrgId:_0x49974b,trackingSettingId:_0x443129}){const _0x386fe5=a340_0x4366e7;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x386fe5(0x101)]=0x0,this['orgComponentsToDeployChunk']=[],this['successDeployedCounter']=0x0,this[_0x386fe5(0x113)]=_0x3853b7,this[_0x386fe5(0x13d)]=_0x3a371e,this['logger']=_0x48275e,this['targetOrgId']=_0x49974b,this[_0x386fe5(0x10e)]=_0x443129;}async['deploy'](){const _0x1adaa0=a340_0x4366e7;await this[_0x1adaa0(0x115)]()[_0x1adaa0(0x104)](_0x62593b=>this['populateAttachmentId'](_0x62593b))[_0x1adaa0(0x104)](()=>this[_0x1adaa0(0x114)]())['then'](_0x57879e=>this['handleDeployResult'](_0x57879e)),this[_0x1adaa0(0x135)]();}[a340_0x4366e7(0x115)](){const _0x5a7fba=a340_0x4366e7,_0x520e17=new salesforce_1[(_0x5a7fba(0x105))]({'instance':this[_0x5a7fba(0x13d)],'objectName':constants_1[_0x5a7fba(0x132)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x5a7fba(0x113)]});return _0x520e17[_0x5a7fba(0x100)](this[_0x5a7fba(0x108)]);}['deployOrgComponents'](){const _0x113449=a340_0x4366e7,_0x19938b=new salesforce_1[(_0x113449(0xfa))]({'instance':this[_0x113449(0x13d)],'objectName':constants_1[_0x113449(0x11a)],'api':this[_0x113449(0x113)],'allOrNone':![],'externalIdField':'Id'});return _0x19938b['execute']({'records':this[_0x113449(0x10b)]});}async[a340_0x4366e7(0xff)](_0x2496ff){const _0x318980=a340_0x4366e7;for(const {success:_0x472fa1,error:_0x92259e}of _0x2496ff){if(_0x472fa1){this[_0x318980(0xfc)]++;continue;}_0x92259e&&this[_0x318980(0x121)][_0x318980(0x107)](_0x92259e);}}[a340_0x4366e7(0x138)](_0x4c9456){const _0x10e7fc=a340_0x4366e7;return _0x4c9456+this['binaryRecordsSizeChunk']>=salesforce_1[_0x10e7fc(0x112)][_0x10e7fc(0x111)]||this[_0x10e7fc(0x108)][_0x10e7fc(0x12a)][_0x10e7fc(0x10f)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x5b5bab=a340_0x4366e7;this[_0x5b5bab(0x101)]=0x0,this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x5b5bab(0x10b)]=[];}['populateAttachmentId'](_0x1ea0e9){const _0x3b7271=a340_0x4366e7;for(const _0x28baa3 in _0x1ea0e9){this[_0x3b7271(0x10b)][_0x28baa3][ATTACHMENT_FIELD_NAME]=_0x1ea0e9[_0x28baa3]['id'];}}async[a340_0x4366e7(0xf0)](_0x14c616,_0x1ca94c){const _0x428c0d=a340_0x4366e7,{listMetadataItem:_0x309044,sourceMemberRecord:_0x2a6125}=_0x14c616,_0x5de35e={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x309044[_0x428c0d(0x110)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x2a6125[_0x428c0d(0x127)],'Name':_0x309044[_0x428c0d(0x110)],'Description':_0x309044[_0x428c0d(0x13a)],'ContentType':CONTENT_TYPE,'ParentId':this['targetOrgId'],'Body':_0x309044[_0x428c0d(0x110)]},_0x3de68a={'binaryFieldName':constants_1[_0x428c0d(0x13c)],'name':_0x309044['fullName'],'value':stream_1['Readable']['from'](_0x1ca94c)};this['attachmentsToDeployChunk'][_0x428c0d(0x12a)][_0x428c0d(0x139)](_0x5de35e),this[_0x428c0d(0x108)]['binary'][_0x428c0d(0x139)](_0x3de68a);}[a340_0x4366e7(0x136)](_0x1416c2){const _0x34535e=a340_0x4366e7,_0x17977d=new jszip_1['default']();for(const _0x585b25 in _0x1416c2){_0x17977d[_0x34535e(0x125)](_0x585b25,_0x1416c2[_0x585b25]);}return _0x17977d[_0x34535e(0xf2)]({'type':_0x34535e(0x128)});}[a340_0x4366e7(0x134)](_0x3338e1,_0x37eb9c,_0x14d8c5){const _0x1f9cfe=a340_0x4366e7,_0x2b4b15={'attributes':{'type':constants_1[_0x1f9cfe(0x11a)]},'Id':_0x37eb9c['componentId'],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0xee)]:_0x37eb9c[_0x1f9cfe(0x12d)],[constants_2[_0x1f9cfe(0x10d)]+'Revision_Counter__c']:_0x37eb9c[_0x1f9cfe(0x131)],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0x120)]:_0x37eb9c[_0x1f9cfe(0x12b)],[constants_2[_0x1f9cfe(0x10d)]+'Last_Updated_By__c']:_0x37eb9c['changedBy'],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0x126)]:_0x3338e1[_0x1f9cfe(0x110)],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0x117)]:_0x3338e1[_0x1f9cfe(0x110)],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0x11b)]:_0x3338e1[_0x1f9cfe(0x13a)],[constants_2['FLOSUM_NAMESPACE']+_0x1f9cfe(0x109)]:_0x3338e1[_0x1f9cfe(0x122)],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0x116)]:constants_1[_0x1f9cfe(0xfe)]['has'](_0x3338e1[_0x1f9cfe(0x13a)])||null,[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0xed)]:!![],[constants_2['FLOSUM_NAMESPACE']+'OrganisationName__c']:this['targetOrgId'],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0xf9)]:this[_0x1f9cfe(0x10e)],[constants_2[_0x1f9cfe(0x10d)]+_0x1f9cfe(0x102)]:_0x14d8c5>MAX_SINGLE_FILE_SIZE?_0x1f9cfe(0x137):_0x1f9cfe(0x119)};_0x14d8c5>MAX_SINGLE_FILE_SIZE&&this[_0x1f9cfe(0x121)]['log'](_0x1f9cfe(0x13b)+_0x3338e1[_0x1f9cfe(0x13a)]+_0x1f9cfe(0x118)+_0x3338e1[_0x1f9cfe(0x110)]),this[_0x1f9cfe(0x10b)][_0x1f9cfe(0x139)](_0x2b4b15);}async[a340_0x4366e7(0x11e)](_0xf2770e,_0x495557,_0x47d15a){const _0x46f215=a340_0x4366e7;try{const {listMetadataItem:_0x5d63bf,sourceMemberRecord:_0x24cb00,files:_0x4c2a27}=_0xf2770e,_0x42ee3e=await this[_0x46f215(0x136)](_0x4c2a27),_0x3bb9c0=Buffer['byteLength'](_0x42ee3e);this[_0x46f215(0x138)](_0x3bb9c0)&&await this[_0x46f215(0xf7)](),this[_0x46f215(0x101)]+=_0x3bb9c0,await this[_0x46f215(0xf0)](_0xf2770e,_0x42ee3e),this['addOrgComponentToChunk'](_0x5d63bf,_0x24cb00,_0x42ee3e['length']),_0x47d15a();}catch(_0x1ed209){_0x47d15a(_0x1ed209);}}async['_final'](_0x26830c){const _0x30c0ff=a340_0x4366e7;try{this[_0x30c0ff(0x108)][_0x30c0ff(0x12a)]['length']&&this[_0x30c0ff(0x10b)][_0x30c0ff(0x10f)]&&await this[_0x30c0ff(0xf7)](),this['logger'][_0x30c0ff(0xeb)](_0x30c0ff(0x10a)+this[_0x30c0ff(0xfc)]+_0x30c0ff(0xf6)),await this[_0x30c0ff(0x121)][_0x30c0ff(0x11f)](),_0x26830c();}catch(_0x315986){_0x26830c(_0x315986);}}}exports[a340_0x4366e7(0x10c)]=ComponentsDeployer;