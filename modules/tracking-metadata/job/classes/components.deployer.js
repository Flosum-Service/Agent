function a327_0x3f45(){const _0x380ba7=['addAttachmentToChunk','CompositeBinaryDeployData','apply','from','binary','log','Is_Retrieved__c','8505398bDrvbV','Readable','defineProperty','OrganisationName__c','handleDeployResult','92670hNThKg','605220OqWYOj','API_Name__c','length','9zjyoaG','ComponentsDeployer','73145rZhROf','application/zip','Is_Deleted__c','_write','binaryRecordsSizeChunk','2546410JuKapD','attachmentId','deployAttachments','then','stream','revisionCounter','Revision_Counter__c','targetOrgId','isReachedMaxChunk','__esModule','Component_Type__c','Process\x20completed\x20for\x20','__importDefault','FLOSUM_NAMESPACE','default','resetChunks','update','952175iamEdr','64peLMQD','16xOgaWr','populateAttachmentId','type','Label__c','CompositeConstants','(((.+)+)+)+$','addOrgComponentToChunk','Retrieved','Writable','apiVersion','search','deploy','Folder__c','METADATA_FOLDER_MAP','changedBy','execute','error','ORG_COMPONENT_OBJECT_NAME','114wASuIY','isNameObsolete','MAX_BODY_SIZE','Last_Updated_By__c','jszip','createZip','Name__c','deployOrgComponents','generateAsync','constructor','Tracking_Setting__c','push','file','records','has','successDeployedCounter','nodebuffer','Status__c','2EVWkPS','ATTACHMENT_OBJECT_NAME','\x20components','Source_Member_Id__c','../../constants','attachmentsToDeployChunk','componentId','toString','orgComponentsToDeployChunk','logger','fullName','../../../../constants','sourceMemberId','109639dKxXrP','trackingSettingId'];a327_0x3f45=function(){return _0x380ba7;};return a327_0x3f45();}const a327_0x39391a=a327_0x196c;(function(_0xa841ba,_0x115a24){const _0x13f4ef=a327_0x196c,_0x5ab996=_0xa841ba();while(!![]){try{const _0x411b25=-parseInt(_0x13f4ef(0x12e))/0x1*(-parseInt(_0x13f4ef(0x17e))/0x2)+-parseInt(_0x13f4ef(0x13c))/0x3*(parseInt(_0x13f4ef(0x159))/0x4)+-parseInt(_0x13f4ef(0x142))/0x5*(-parseInt(_0x13f4ef(0x16c))/0x6)+parseInt(_0x13f4ef(0x158))/0x7*(-parseInt(_0x13f4ef(0x15a))/0x8)+-parseInt(_0x13f4ef(0x140))/0x9*(-parseInt(_0x13f4ef(0x147))/0xa)+parseInt(_0x13f4ef(0x137))/0xb+-parseInt(_0x13f4ef(0x13d))/0xc;if(_0x411b25===_0x115a24)break;else _0x5ab996['push'](_0x5ab996['shift']());}catch(_0xdd3b4a){_0x5ab996['push'](_0x5ab996['shift']());}}}(a327_0x3f45,0x922c4));const a327_0x5d71b4=(function(){let _0x2e2eb5=!![];return function(_0x882cf8,_0x423dc9){const _0x366a04=_0x2e2eb5?function(){const _0x3a6129=a327_0x196c;if(_0x423dc9){const _0x5d0c20=_0x423dc9[_0x3a6129(0x132)](_0x882cf8,arguments);return _0x423dc9=null,_0x5d0c20;}}:function(){};return _0x2e2eb5=![],_0x366a04;};}()),a327_0xe55bd0=a327_0x5d71b4(this,function(){const _0x3ff4dd=a327_0x196c;return a327_0xe55bd0[_0x3ff4dd(0x185)]()[_0x3ff4dd(0x164)](_0x3ff4dd(0x15f))[_0x3ff4dd(0x185)]()[_0x3ff4dd(0x175)](a327_0xe55bd0)[_0x3ff4dd(0x164)](_0x3ff4dd(0x15f));});a327_0xe55bd0();'use strict';var __importDefault=this&&this[a327_0x39391a(0x153)]||function(_0x596a70){const _0x253f81=a327_0x39391a;return _0x596a70&&_0x596a70[_0x253f81(0x150)]?_0x596a70:{'default':_0x596a70};};function a327_0x196c(_0x1f07c0,_0x3ceddb){const _0x1b9b2e=a327_0x3f45();return a327_0x196c=function(_0xe55bd0,_0x5d71b4){_0xe55bd0=_0xe55bd0-0x12a;let _0x3f45e0=_0x1b9b2e[_0xe55bd0];return _0x3f45e0;},a327_0x196c(_0x1f07c0,_0x3ceddb);}Object[a327_0x39391a(0x139)](exports,a327_0x39391a(0x150),{'value':!![]}),exports[a327_0x39391a(0x141)]=void 0x0;const salesforce_1=require('@flosum/salesforce'),constants_1=require(a327_0x39391a(0x182)),stream_1=require(a327_0x39391a(0x14b)),jszip_1=__importDefault(require(a327_0x39391a(0x170))),constants_2=require(a327_0x39391a(0x12c)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a327_0x39391a(0x154)]+'Attachment_ID__c',CONTENT_TYPE=a327_0x39391a(0x143);class ComponentsDeployer extends stream_1[a327_0x39391a(0x162)]{constructor({apiVersion:_0x1e8b07,instance:_0x380783,logger:_0x41e0c6,targetOrgId:_0x339c8a,trackingSettingId:_0x16bf56}){const _0x3d7e17=a327_0x39391a;super({'objectMode':!![]}),this[_0x3d7e17(0x183)]={'records':[],'binary':[]},this[_0x3d7e17(0x146)]=0x0,this['orgComponentsToDeployChunk']=[],this[_0x3d7e17(0x17b)]=0x0,this[_0x3d7e17(0x163)]=_0x1e8b07,this['instance']=_0x380783,this[_0x3d7e17(0x12a)]=_0x41e0c6,this[_0x3d7e17(0x14e)]=_0x339c8a,this[_0x3d7e17(0x12f)]=_0x16bf56;}async[a327_0x39391a(0x165)](){const _0x315dd2=a327_0x39391a;await this[_0x315dd2(0x149)]()[_0x315dd2(0x14a)](_0x2e7157=>this[_0x315dd2(0x15b)](_0x2e7157))[_0x315dd2(0x14a)](()=>this[_0x315dd2(0x173)]())[_0x315dd2(0x14a)](_0x3df3d2=>this[_0x315dd2(0x13b)](_0x3df3d2)),this[_0x315dd2(0x156)]();}['deployAttachments'](){const _0x46b8ad=a327_0x39391a,_0x1aaa0c=new salesforce_1[(_0x46b8ad(0x131))]({'instance':this['instance'],'objectName':constants_1[_0x46b8ad(0x17f)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x1aaa0c[_0x46b8ad(0x169)](this['attachmentsToDeployChunk']);}[a327_0x39391a(0x173)](){const _0x1d183e=a327_0x39391a,_0x3dd585=new salesforce_1['RestSimpleDeployData']({'instance':this['instance'],'objectName':constants_1[_0x1d183e(0x16b)],'api':this[_0x1d183e(0x163)],'allOrNone':![],'externalIdField':'Id'});return _0x3dd585[_0x1d183e(0x169)]({'records':this[_0x1d183e(0x186)]});}async['handleDeployResult'](_0x2a70c6){const _0x5ee46c=a327_0x39391a;for(const {success:_0x57d058,error:_0x48dd30}of _0x2a70c6){if(_0x57d058){this[_0x5ee46c(0x17b)]++;continue;}_0x48dd30&&this['logger'][_0x5ee46c(0x16a)](_0x48dd30);}}[a327_0x39391a(0x14f)](_0x36e871){const _0x3b0d35=a327_0x39391a;return _0x36e871+this[_0x3b0d35(0x146)]>=salesforce_1[_0x3b0d35(0x15e)][_0x3b0d35(0x16e)]||this[_0x3b0d35(0x183)][_0x3b0d35(0x179)]['length']===MAX_COMPOSITE_CHUNK_COUNT;}[a327_0x39391a(0x156)](){const _0x3c1f65=a327_0x39391a;this[_0x3c1f65(0x146)]=0x0,this[_0x3c1f65(0x183)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a327_0x39391a(0x15b)](_0x49356f){for(const _0xc8ed4e in _0x49356f){this['orgComponentsToDeployChunk'][_0xc8ed4e][ATTACHMENT_FIELD_NAME]=_0x49356f[_0xc8ed4e]['id'];}}async[a327_0x39391a(0x130)](_0x205372,_0x2df082){const _0x1613dd=a327_0x39391a,{listMetadataItem:_0x15a87b,sourceMemberRecord:_0x2446b3}=_0x205372,_0x160768={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x15a87b[_0x1613dd(0x12b)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x2446b3[_0x1613dd(0x148)],'Name':_0x15a87b[_0x1613dd(0x12b)],'Description':_0x15a87b['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x1613dd(0x14e)],'Body':_0x15a87b[_0x1613dd(0x12b)]},_0x4a1969={'binaryFieldName':constants_1['BINARY_FIELD_NAME'],'name':_0x15a87b[_0x1613dd(0x12b)],'value':stream_1[_0x1613dd(0x138)][_0x1613dd(0x133)](_0x2df082)};this[_0x1613dd(0x183)]['records'][_0x1613dd(0x177)](_0x160768),this[_0x1613dd(0x183)][_0x1613dd(0x134)][_0x1613dd(0x177)](_0x4a1969);}['createZip'](_0x42fdb1){const _0x4426d8=a327_0x39391a,_0x3f42c4=new jszip_1[(_0x4426d8(0x155))]();for(const _0x158a06 in _0x42fdb1){_0x3f42c4[_0x4426d8(0x178)](_0x158a06,_0x42fdb1[_0x158a06]);}return _0x3f42c4[_0x4426d8(0x174)]({'type':_0x4426d8(0x17c)});}[a327_0x39391a(0x160)](_0x56a5a4,_0x4ed42b){const _0x1fb690=a327_0x39391a,_0x587645={'attributes':{'type':constants_1['ORG_COMPONENT_OBJECT_NAME']},'Id':_0x4ed42b[_0x1fb690(0x184)],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x144)]:_0x4ed42b[_0x1fb690(0x16d)],[constants_2['FLOSUM_NAMESPACE']+_0x1fb690(0x14d)]:_0x4ed42b[_0x1fb690(0x14c)],[constants_2['FLOSUM_NAMESPACE']+_0x1fb690(0x181)]:_0x4ed42b[_0x1fb690(0x12d)],[constants_2['FLOSUM_NAMESPACE']+_0x1fb690(0x16f)]:_0x4ed42b[_0x1fb690(0x168)],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x13e)]:_0x56a5a4[_0x1fb690(0x12b)],[constants_2['FLOSUM_NAMESPACE']+_0x1fb690(0x172)]:_0x56a5a4[_0x1fb690(0x12b)],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x151)]:_0x56a5a4[_0x1fb690(0x15c)],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x15d)]:_0x56a5a4['fileName'],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x166)]:constants_1[_0x1fb690(0x167)][_0x1fb690(0x17a)](_0x56a5a4[_0x1fb690(0x15c)])||null,[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x136)]:!![],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x13a)]:this[_0x1fb690(0x14e)],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x176)]:this[_0x1fb690(0x12f)],[constants_2[_0x1fb690(0x154)]+_0x1fb690(0x17d)]:_0x1fb690(0x161)};this[_0x1fb690(0x186)][_0x1fb690(0x177)](_0x587645);}async[a327_0x39391a(0x145)](_0x1001ec,_0xa36cfc,_0x19dfc6){const _0x5352e9=a327_0x39391a;try{const {listMetadataItem:_0x3ccb6a,sourceMemberRecord:_0x4e6e10,files:_0x80d138}=_0x1001ec,_0x33d9c1=await this[_0x5352e9(0x171)](_0x80d138),_0x3f0a40=Buffer['byteLength'](_0x33d9c1);this[_0x5352e9(0x14f)](_0x3f0a40)&&await this[_0x5352e9(0x165)](),this[_0x5352e9(0x146)]+=_0x3f0a40,await this[_0x5352e9(0x130)](_0x1001ec,_0x33d9c1),this[_0x5352e9(0x160)](_0x3ccb6a,_0x4e6e10),_0x19dfc6();}catch(_0x469478){_0x19dfc6(_0x469478);}}async['_final'](_0x45b859){const _0x31b1cb=a327_0x39391a;try{this['attachmentsToDeployChunk']['records'][_0x31b1cb(0x13f)]&&this[_0x31b1cb(0x186)][_0x31b1cb(0x13f)]&&await this['deploy'](),this[_0x31b1cb(0x12a)][_0x31b1cb(0x135)](_0x31b1cb(0x152)+this[_0x31b1cb(0x17b)]+_0x31b1cb(0x180)),await this[_0x31b1cb(0x12a)][_0x31b1cb(0x157)](),_0x45b859();}catch(_0x2aa6b7){_0x45b859(_0x2aa6b7);}}}exports[a327_0x39391a(0x141)]=ComponentsDeployer;