const a327_0x5e00c8=a327_0x270b;(function(_0x388b76,_0x1910b5){const _0x2416ae=a327_0x270b,_0x4624ca=_0x388b76();while(!![]){try{const _0x41bb75=-parseInt(_0x2416ae(0x21b))/0x1+-parseInt(_0x2416ae(0x239))/0x2*(parseInt(_0x2416ae(0x1f5))/0x3)+-parseInt(_0x2416ae(0x1f6))/0x4+parseInt(_0x2416ae(0x219))/0x5*(-parseInt(_0x2416ae(0x1ee))/0x6)+parseInt(_0x2416ae(0x226))/0x7*(-parseInt(_0x2416ae(0x204))/0x8)+-parseInt(_0x2416ae(0x212))/0x9*(parseInt(_0x2416ae(0x217))/0xa)+-parseInt(_0x2416ae(0x21c))/0xb*(-parseInt(_0x2416ae(0x1fd))/0xc);if(_0x41bb75===_0x1910b5)break;else _0x4624ca['push'](_0x4624ca['shift']());}catch(_0x5c7e8f){_0x4624ca['push'](_0x4624ca['shift']());}}}(a327_0x2618,0x65287));function a327_0x2618(){const _0x1f16ee=['binary','__importDefault','deploy','has','Attachment_ID__c','trackingSettingId','apply','targetOrgId','addAttachmentToChunk','_write','attachmentId','(((.+)+)+)+$','sourceMemberId','2oOkZDD','deployOrgComponents','fullName','error','defineProperty','FLOSUM_NAMESPACE','Is_Retrieved__c','jszip','search','METADATA_FOLDER_MAP','15918QiISWv','ComponentsDeployer','\x20components','type','isReachedMaxChunk','../../../../constants','RestSimpleDeployData','954957eIHVaP','3294720dZQotq','Label__c','log','apiVersion','componentId','attachmentsToDeployChunk','Readable','13892424bBsGTH','deployAttachments','generateAsync','Source_Member_Id__c','logger','resetChunks','populateAttachmentId','5326728KupQEP','_final','ORG_COMPONENT_OBJECT_NAME','OrganisationName__c','constructor','Folder__c','handleDeployResult','BINARY_FIELD_NAME','API_Name__c','createZip','changedBy','file','ATTACHMENT_OBJECT_NAME','push','6462459AzckQp','binaryRecordsSizeChunk','Is_Deleted__c','instance','Retrieved','10JBJXLs','Status__c','515cHJsZF','successDeployedCounter','259613hMEegP','33UmKBkw','isNameObsolete','orgComponentsToDeployChunk','Component_Type__c','stream','from','records','Name__c','@flosum/salesforce','Process\x20completed\x20for\x20','7eAySZu','execute','Last_Updated_By__c','__esModule','length','then'];a327_0x2618=function(){return _0x1f16ee;};return a327_0x2618();}const a327_0x488f60=(function(){let _0x6010ee=!![];return function(_0x508cca,_0x32e4ee){const _0x309c4a=_0x6010ee?function(){const _0x152d19=a327_0x270b;if(_0x32e4ee){const _0x9421ef=_0x32e4ee[_0x152d19(0x232)](_0x508cca,arguments);return _0x32e4ee=null,_0x9421ef;}}:function(){};return _0x6010ee=![],_0x309c4a;};}()),a327_0x1f49e1=a327_0x488f60(this,function(){const _0x4ba891=a327_0x270b;return a327_0x1f49e1['toString']()[_0x4ba891(0x241)](_0x4ba891(0x237))['toString']()[_0x4ba891(0x208)](a327_0x1f49e1)[_0x4ba891(0x241)](_0x4ba891(0x237));});function a327_0x270b(_0x227408,_0x11c5c7){const _0x3ffe64=a327_0x2618();return a327_0x270b=function(_0x1f49e1,_0x488f60){_0x1f49e1=_0x1f49e1-0x1ed;let _0x261809=_0x3ffe64[_0x1f49e1];return _0x261809;},a327_0x270b(_0x227408,_0x11c5c7);}a327_0x1f49e1();'use strict';var __importDefault=this&&this[a327_0x5e00c8(0x22d)]||function(_0x1557c4){const _0x1f884d=a327_0x5e00c8;return _0x1557c4&&_0x1557c4[_0x1f884d(0x229)]?_0x1557c4:{'default':_0x1557c4};};Object[a327_0x5e00c8(0x23d)](exports,a327_0x5e00c8(0x229),{'value':!![]}),exports['ComponentsDeployer']=void 0x0;const salesforce_1=require(a327_0x5e00c8(0x224)),constants_1=require('../../constants'),stream_1=require(a327_0x5e00c8(0x220)),jszip_1=__importDefault(require(a327_0x5e00c8(0x240))),constants_2=require(a327_0x5e00c8(0x1f3)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a327_0x5e00c8(0x230),CONTENT_TYPE='application/zip';class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x4a732a,instance:_0x1a726d,logger:_0x884aec,targetOrgId:_0x3f8f8e,trackingSettingId:_0x427de4}){const _0x413a55=a327_0x5e00c8;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x413a55(0x213)]=0x0,this[_0x413a55(0x21e)]=[],this[_0x413a55(0x21a)]=0x0,this[_0x413a55(0x1f9)]=_0x4a732a,this['instance']=_0x1a726d,this[_0x413a55(0x201)]=_0x884aec,this['targetOrgId']=_0x3f8f8e,this['trackingSettingId']=_0x427de4;}async['deploy'](){const _0x329436=a327_0x5e00c8;await this[_0x329436(0x1fe)]()['then'](_0x5a7e13=>this[_0x329436(0x203)](_0x5a7e13))[_0x329436(0x22b)](()=>this[_0x329436(0x23a)]())[_0x329436(0x22b)](_0x3c54ad=>this[_0x329436(0x20a)](_0x3c54ad)),this[_0x329436(0x202)]();}['deployAttachments'](){const _0x84311d=a327_0x5e00c8,_0x403ff8=new salesforce_1['CompositeBinaryDeployData']({'instance':this[_0x84311d(0x215)],'objectName':constants_1[_0x84311d(0x210)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x84311d(0x1f9)]});return _0x403ff8[_0x84311d(0x227)](this[_0x84311d(0x1fb)]);}[a327_0x5e00c8(0x23a)](){const _0x5255b4=a327_0x5e00c8,_0x500e87=new salesforce_1[(_0x5255b4(0x1f4))]({'instance':this[_0x5255b4(0x215)],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0x500e87['execute']({'records':this['orgComponentsToDeployChunk']});}async['handleDeployResult'](_0x5d261a){const _0x19d219=a327_0x5e00c8;for(const {success:_0x384598,error:_0x4f616e}of _0x5d261a){if(_0x384598){this[_0x19d219(0x21a)]++;continue;}_0x4f616e&&this[_0x19d219(0x201)][_0x19d219(0x23c)](_0x4f616e);}}[a327_0x5e00c8(0x1f2)](_0x71c147){const _0x40796e=a327_0x5e00c8;return _0x71c147+this[_0x40796e(0x213)]>=salesforce_1['CompositeConstants']['MAX_BODY_SIZE']||this['attachmentsToDeployChunk'][_0x40796e(0x222)][_0x40796e(0x22a)]===MAX_COMPOSITE_CHUNK_COUNT;}[a327_0x5e00c8(0x202)](){const _0x494294=a327_0x5e00c8;this[_0x494294(0x213)]=0x0,this[_0x494294(0x1fb)]={'records':[],'binary':[]},this[_0x494294(0x21e)]=[];}[a327_0x5e00c8(0x203)](_0x11a39c){const _0xf36f55=a327_0x5e00c8;for(const _0x4327c0 in _0x11a39c){this[_0xf36f55(0x21e)][_0x4327c0][ATTACHMENT_FIELD_NAME]=_0x11a39c[_0x4327c0]['id'];}}async[a327_0x5e00c8(0x234)](_0x31c3f3,_0xd33062){const _0x5f4357=a327_0x5e00c8,{listMetadataItem:_0x33486a,sourceMemberRecord:_0x4c1091}=_0x31c3f3,_0x13b1a5={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x33486a[_0x5f4357(0x23b)],'binaryPartNameAlias':constants_1[_0x5f4357(0x20b)]},'Id':_0x4c1091[_0x5f4357(0x236)],'Name':_0x33486a[_0x5f4357(0x23b)],'Description':_0x33486a[_0x5f4357(0x1f1)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x5f4357(0x233)],'Body':_0x33486a['fullName']},_0x14184b={'binaryFieldName':constants_1[_0x5f4357(0x20b)],'name':_0x33486a[_0x5f4357(0x23b)],'value':stream_1[_0x5f4357(0x1fc)][_0x5f4357(0x221)](_0xd33062)};this[_0x5f4357(0x1fb)][_0x5f4357(0x222)][_0x5f4357(0x211)](_0x13b1a5),this[_0x5f4357(0x1fb)][_0x5f4357(0x22c)]['push'](_0x14184b);}[a327_0x5e00c8(0x20d)](_0x4205dc){const _0x3c93c4=a327_0x5e00c8,_0x1c02ee=new jszip_1['default']();for(const _0x45043b in _0x4205dc){_0x1c02ee[_0x3c93c4(0x20f)](_0x45043b,_0x4205dc[_0x45043b]);}return _0x1c02ee[_0x3c93c4(0x1ff)]({'type':'nodebuffer'});}['addOrgComponentToChunk'](_0x44823f,_0x24c2a4){const _0x1f2498=a327_0x5e00c8,_0x14638d={'attributes':{'type':constants_1[_0x1f2498(0x206)]},'Id':_0x24c2a4[_0x1f2498(0x1fa)],[constants_2[_0x1f2498(0x23e)]+_0x1f2498(0x214)]:_0x24c2a4[_0x1f2498(0x21d)],[constants_2[_0x1f2498(0x23e)]+'Revision_Counter__c']:_0x24c2a4['revisionCounter'],[constants_2['FLOSUM_NAMESPACE']+_0x1f2498(0x200)]:_0x24c2a4[_0x1f2498(0x238)],[constants_2['FLOSUM_NAMESPACE']+_0x1f2498(0x228)]:_0x24c2a4[_0x1f2498(0x20e)],[constants_2['FLOSUM_NAMESPACE']+_0x1f2498(0x20c)]:_0x44823f[_0x1f2498(0x23b)],[constants_2['FLOSUM_NAMESPACE']+_0x1f2498(0x223)]:_0x44823f[_0x1f2498(0x23b)],[constants_2[_0x1f2498(0x23e)]+_0x1f2498(0x21f)]:_0x44823f['type'],[constants_2[_0x1f2498(0x23e)]+_0x1f2498(0x1f7)]:_0x44823f['fileName'],[constants_2['FLOSUM_NAMESPACE']+_0x1f2498(0x209)]:constants_1[_0x1f2498(0x1ed)][_0x1f2498(0x22f)](_0x44823f['type'])||null,[constants_2[_0x1f2498(0x23e)]+_0x1f2498(0x23f)]:!![],[constants_2['FLOSUM_NAMESPACE']+_0x1f2498(0x207)]:this['targetOrgId'],[constants_2[_0x1f2498(0x23e)]+'Tracking_Setting__c']:this[_0x1f2498(0x231)],[constants_2[_0x1f2498(0x23e)]+_0x1f2498(0x218)]:_0x1f2498(0x216)};this['orgComponentsToDeployChunk'][_0x1f2498(0x211)](_0x14638d);}async[a327_0x5e00c8(0x235)](_0x2ed729,_0x14b5bf,_0x134024){const _0x3a277f=a327_0x5e00c8;try{const {listMetadataItem:_0x44098c,sourceMemberRecord:_0x56d21f,files:_0x2eb593}=_0x2ed729,_0x289c78=await this['createZip'](_0x2eb593),_0x59b4dc=Buffer['byteLength'](_0x289c78);this['isReachedMaxChunk'](_0x59b4dc)&&await this[_0x3a277f(0x22e)](),this[_0x3a277f(0x213)]+=_0x59b4dc,await this[_0x3a277f(0x234)](_0x2ed729,_0x289c78),this['addOrgComponentToChunk'](_0x44098c,_0x56d21f),_0x134024();}catch(_0x4f41d8){_0x134024(_0x4f41d8);}}async[a327_0x5e00c8(0x205)](_0x6a76d){const _0x18b987=a327_0x5e00c8;try{this[_0x18b987(0x1fb)][_0x18b987(0x222)]['length']&&this[_0x18b987(0x21e)]['length']&&await this['deploy'](),this[_0x18b987(0x201)][_0x18b987(0x1f8)](_0x18b987(0x225)+this[_0x18b987(0x21a)]+_0x18b987(0x1f0)),await this[_0x18b987(0x201)]['update'](),_0x6a76d();}catch(_0x13a8a6){_0x6a76d(_0x13a8a6);}}}exports[a327_0x5e00c8(0x1ef)]=ComponentsDeployer;