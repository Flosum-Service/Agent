const a295_0x454e2e=a295_0x3d21;(function(_0x5f316e,_0x1c9104){const _0x5550e0=a295_0x3d21,_0x5b026a=_0x5f316e();while(!![]){try{const _0x57b556=-parseInt(_0x5550e0(0x21f))/0x1+parseInt(_0x5550e0(0x207))/0x2*(-parseInt(_0x5550e0(0x1e4))/0x3)+parseInt(_0x5550e0(0x208))/0x4+-parseInt(_0x5550e0(0x20e))/0x5+-parseInt(_0x5550e0(0x1f6))/0x6*(parseInt(_0x5550e0(0x1db))/0x7)+parseInt(_0x5550e0(0x1dd))/0x8+-parseInt(_0x5550e0(0x1f2))/0x9*(-parseInt(_0x5550e0(0x1e6))/0xa);if(_0x57b556===_0x1c9104)break;else _0x5b026a['push'](_0x5b026a['shift']());}catch(_0x531f8c){_0x5b026a['push'](_0x5b026a['shift']());}}}(a295_0x2b01,0x52d3c));const a295_0x2cb64c=(function(){let _0x457ee8=!![];return function(_0x137cb7,_0x56e34e){const _0x33b145=_0x457ee8?function(){const _0x17c14c=a295_0x3d21;if(_0x56e34e){const _0x51b2c2=_0x56e34e[_0x17c14c(0x212)](_0x137cb7,arguments);return _0x56e34e=null,_0x51b2c2;}}:function(){};return _0x457ee8=![],_0x33b145;};}()),a295_0x8f462c=a295_0x2cb64c(this,function(){const _0x5eceb7=a295_0x3d21;return a295_0x8f462c[_0x5eceb7(0x1d5)]()['search'](_0x5eceb7(0x1e1))[_0x5eceb7(0x1d5)]()['constructor'](a295_0x8f462c)[_0x5eceb7(0x1ea)]('(((.+)+)+)+$');});function a295_0x3d21(_0x3b4191,_0x3f5daf){const _0x518411=a295_0x2b01();return a295_0x3d21=function(_0x8f462c,_0x2cb64c){_0x8f462c=_0x8f462c-0x1d4;let _0x2b0120=_0x518411[_0x8f462c];return _0x2b0120;},a295_0x3d21(_0x3b4191,_0x3f5daf);}a295_0x8f462c();'use strict';function a295_0x2b01(){const _0x4c77ea=['1989392tUesDs','Folder__c','isReachedMaxChunk','targetOrgId','../../constants','fullName','801565kQnCdG','__esModule','jszip','log','apply','ORG_COMPONENT_OBJECT_NAME','byteLength','logger','Writable','Is_Retrieved__c','instance','trackingSettingId','\x20components','_write','deployOrgComponents','componentId','type','251298kChiiq','error','length','OrganisationName__c','toString','handleDeployResult','Revision_Counter__c','addAttachmentToChunk','push','Label__c','21wMHkIb','records','3911168xpwtVp','METADATA_FOLDER_MAP','resetChunks','successDeployedCounter','(((.+)+)+)+$','@flosum/salesforce','application/zip','806478qHLorz','defineProperty','80CUibIP','ComponentsDeployer','apiVersion','has','search','revisionCounter','Retrieved','changedBy','Is_Deleted__c','default','Source_Member_Id__c','binaryRecordsSizeChunk','952488lBHDTi','createZip','CompositeConstants','attachmentsToDeployChunk','1088754VQQHnu','orgComponentsToDeployChunk','MAX_BODY_SIZE','stream','Status__c','API_Name__c','addOrgComponentToChunk','Tracking_Setting__c','populateAttachmentId','deploy','generateAsync','from','RestSimpleDeployData','BINARY_FIELD_NAME','FLOSUM_NAMESPACE','CompositeBinaryDeployData','Readable','4VgfoWt'];a295_0x2b01=function(){return _0x4c77ea;};return a295_0x2b01();}var __importDefault=this&&this['__importDefault']||function(_0x501d9c){const _0x1d6d01=a295_0x3d21;return _0x501d9c&&_0x501d9c[_0x1d6d01(0x20f)]?_0x501d9c:{'default':_0x501d9c};};Object[a295_0x454e2e(0x1e5)](exports,a295_0x454e2e(0x20f),{'value':!![]}),exports[a295_0x454e2e(0x1e7)]=void 0x0;const salesforce_1=require(a295_0x454e2e(0x1e2)),constants_1=require(a295_0x454e2e(0x20c)),stream_1=require(a295_0x454e2e(0x1f9)),jszip_1=__importDefault(require(a295_0x454e2e(0x210))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a295_0x454e2e(0x204)]+'Attachment_ID__c',CONTENT_TYPE=a295_0x454e2e(0x1e3);class ComponentsDeployer extends stream_1[a295_0x454e2e(0x216)]{constructor({apiVersion:_0x5e12f0,instance:_0x59c96e,logger:_0x384cef,targetOrgId:_0x2af412,trackingSettingId:_0x39de67}){const _0x3d1407=a295_0x454e2e;super({'objectMode':!![]}),this[_0x3d1407(0x1f5)]={'records':[],'binary':[]},this[_0x3d1407(0x1f1)]=0x0,this[_0x3d1407(0x1f7)]=[],this[_0x3d1407(0x1e0)]=0x0,this[_0x3d1407(0x1e8)]=_0x5e12f0,this[_0x3d1407(0x218)]=_0x59c96e,this[_0x3d1407(0x215)]=_0x384cef,this[_0x3d1407(0x20b)]=_0x2af412,this[_0x3d1407(0x219)]=_0x39de67;}async[a295_0x454e2e(0x1ff)](){const _0x449b48=a295_0x454e2e;await this['deployAttachments']()['then'](_0x188d86=>this[_0x449b48(0x1fe)](_0x188d86))['then'](()=>this[_0x449b48(0x21c)]())['then'](_0x13707a=>this[_0x449b48(0x1d6)](_0x13707a)),this[_0x449b48(0x1df)]();}['deployAttachments'](){const _0x364140=a295_0x454e2e,_0x15fc2f=new salesforce_1[(_0x364140(0x205))]({'instance':this[_0x364140(0x218)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x364140(0x1e8)]});return _0x15fc2f['execute'](this[_0x364140(0x1f5)]);}[a295_0x454e2e(0x21c)](){const _0x2f50c6=a295_0x454e2e,_0x2f7d3f=new salesforce_1[(_0x2f50c6(0x202))]({'instance':this['instance'],'objectName':constants_1[_0x2f50c6(0x213)],'api':this[_0x2f50c6(0x1e8)],'allOrNone':![],'externalIdField':'Id'});return _0x2f7d3f['execute']({'records':this[_0x2f50c6(0x1f7)]});}async[a295_0x454e2e(0x1d6)](_0x4c1f6){const _0x41173f=a295_0x454e2e;for(const {success:_0x4bff5b,error:_0x3caaf0}of _0x4c1f6){if(_0x4bff5b){this['successDeployedCounter']++;continue;}_0x3caaf0&&this['logger'][_0x41173f(0x220)](_0x3caaf0);}}['isReachedMaxChunk'](_0x2fa063){const _0x2e904b=a295_0x454e2e;return _0x2fa063+this[_0x2e904b(0x1f1)]>=salesforce_1[_0x2e904b(0x1f4)][_0x2e904b(0x1f8)]||this['attachmentsToDeployChunk'][_0x2e904b(0x1dc)][_0x2e904b(0x221)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x8e0ed5=a295_0x454e2e;this[_0x8e0ed5(0x1f1)]=0x0,this[_0x8e0ed5(0x1f5)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a295_0x454e2e(0x1fe)](_0x118ee3){const _0x3f9d7d=a295_0x454e2e;for(const _0x203948 in _0x118ee3){this[_0x3f9d7d(0x1f7)][_0x203948][ATTACHMENT_FIELD_NAME]=_0x118ee3[_0x203948]['id'];}}async[a295_0x454e2e(0x1d8)](_0x442af5,_0x1de4c8){const _0x4fbf43=a295_0x454e2e,{listMetadataItem:_0x511a05,sourceMemberRecord:_0x157994}=_0x442af5,_0x2d3839={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x511a05[_0x4fbf43(0x20d)],'binaryPartNameAlias':constants_1[_0x4fbf43(0x203)]},'Id':_0x157994['attachmentId'],'Name':_0x511a05[_0x4fbf43(0x20d)],'Description':_0x511a05[_0x4fbf43(0x21e)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x4fbf43(0x20b)],'Body':_0x511a05['fullName']},_0x24d444={'binaryFieldName':constants_1['BINARY_FIELD_NAME'],'name':_0x511a05['fullName'],'value':stream_1[_0x4fbf43(0x206)][_0x4fbf43(0x201)](_0x1de4c8)};this[_0x4fbf43(0x1f5)][_0x4fbf43(0x1dc)][_0x4fbf43(0x1d9)](_0x2d3839),this['attachmentsToDeployChunk']['binary'][_0x4fbf43(0x1d9)](_0x24d444);}[a295_0x454e2e(0x1f3)](_0xb5e082){const _0x44084c=a295_0x454e2e,_0x1d5a22=new jszip_1[(_0x44084c(0x1ef))]();for(const _0x200f5a in _0xb5e082){_0x1d5a22['file'](_0x200f5a,_0xb5e082[_0x200f5a]);}return _0x1d5a22[_0x44084c(0x200)]({'type':'nodebuffer'});}[a295_0x454e2e(0x1fc)](_0x1f54e9,_0x1ef4a2){const _0xed1f=a295_0x454e2e,_0x1bb8da={'attributes':{'type':constants_1['ORG_COMPONENT_OBJECT_NAME']},'Id':_0x1ef4a2[_0xed1f(0x21d)],[constants_2[_0xed1f(0x204)]+_0xed1f(0x1ee)]:_0x1ef4a2['isNameObsolete'],[constants_2[_0xed1f(0x204)]+_0xed1f(0x1d7)]:_0x1ef4a2[_0xed1f(0x1eb)],[constants_2[_0xed1f(0x204)]+_0xed1f(0x1f0)]:_0x1ef4a2['sourceMemberId'],[constants_2[_0xed1f(0x204)]+'Last_Updated_By__c']:_0x1ef4a2[_0xed1f(0x1ed)],[constants_2[_0xed1f(0x204)]+_0xed1f(0x1fb)]:_0x1f54e9[_0xed1f(0x20d)],[constants_2[_0xed1f(0x204)]+'Name__c']:_0x1f54e9[_0xed1f(0x20d)],[constants_2[_0xed1f(0x204)]+'Component_Type__c']:_0x1f54e9[_0xed1f(0x21e)],[constants_2[_0xed1f(0x204)]+_0xed1f(0x1da)]:_0x1f54e9['fileName'],[constants_2[_0xed1f(0x204)]+_0xed1f(0x209)]:constants_1[_0xed1f(0x1de)][_0xed1f(0x1e9)](_0x1f54e9['type'])||null,[constants_2[_0xed1f(0x204)]+_0xed1f(0x217)]:!![],[constants_2['FLOSUM_NAMESPACE']+_0xed1f(0x1d4)]:this[_0xed1f(0x20b)],[constants_2[_0xed1f(0x204)]+_0xed1f(0x1fd)]:this[_0xed1f(0x219)],[constants_2[_0xed1f(0x204)]+_0xed1f(0x1fa)]:_0xed1f(0x1ec)};this['orgComponentsToDeployChunk'][_0xed1f(0x1d9)](_0x1bb8da);}async[a295_0x454e2e(0x21b)](_0x19bcb4,_0x2021d8,_0x49f2a0){const _0x59811f=a295_0x454e2e;try{const {listMetadataItem:_0x43ec13,sourceMemberRecord:_0x16a549,files:_0x4ae639}=_0x19bcb4,_0x4543e6=await this['createZip'](_0x4ae639),_0x1c1aac=Buffer[_0x59811f(0x214)](_0x4543e6);this[_0x59811f(0x20a)](_0x1c1aac)&&await this[_0x59811f(0x1ff)](),this[_0x59811f(0x1f1)]+=_0x1c1aac,await this[_0x59811f(0x1d8)](_0x19bcb4,_0x4543e6),this[_0x59811f(0x1fc)](_0x43ec13,_0x16a549),_0x49f2a0();}catch(_0x59f1dc){_0x49f2a0(_0x59f1dc);}}async['_final'](_0xe81dbe){const _0x249ade=a295_0x454e2e;try{this[_0x249ade(0x1f5)][_0x249ade(0x1dc)][_0x249ade(0x221)]&&this['orgComponentsToDeployChunk'][_0x249ade(0x221)]&&await this['deploy'](),this['logger'][_0x249ade(0x211)]('Process\x20completed\x20for\x20'+this['successDeployedCounter']+_0x249ade(0x21a)),await this['logger']['update'](),_0xe81dbe();}catch(_0x541b45){_0xe81dbe(_0x541b45);}}}exports[a295_0x454e2e(0x1e7)]=ComponentsDeployer;