const a327_0x1fa718=a327_0x55b2;(function(_0x4daba4,_0x5f0e03){const _0x3d465d=a327_0x55b2,_0x18a479=_0x4daba4();while(!![]){try{const _0x11fab8=parseInt(_0x3d465d(0xaa))/0x1+parseInt(_0x3d465d(0xac))/0x2+parseInt(_0x3d465d(0xa0))/0x3*(-parseInt(_0x3d465d(0x99))/0x4)+-parseInt(_0x3d465d(0xd6))/0x5*(parseInt(_0x3d465d(0xae))/0x6)+parseInt(_0x3d465d(0xbc))/0x7+parseInt(_0x3d465d(0xe2))/0x8+-parseInt(_0x3d465d(0xbe))/0x9;if(_0x11fab8===_0x5f0e03)break;else _0x18a479['push'](_0x18a479['shift']());}catch(_0x2e18a7){_0x18a479['push'](_0x18a479['shift']());}}}(a327_0x2700,0xb4e18));const a327_0x36e908=(function(){let _0x2f3113=!![];return function(_0x1a681d,_0x3a6c4e){const _0x173792=_0x2f3113?function(){const _0x31365d=a327_0x55b2;if(_0x3a6c4e){const _0x42d822=_0x3a6c4e[_0x31365d(0xce)](_0x1a681d,arguments);return _0x3a6c4e=null,_0x42d822;}}:function(){};return _0x2f3113=![],_0x173792;};}()),a327_0x16506e=a327_0x36e908(this,function(){const _0x3651b1=a327_0x55b2;return a327_0x16506e[_0x3651b1(0xc0)]()[_0x3651b1(0xb1)](_0x3651b1(0xd5))[_0x3651b1(0xc0)]()[_0x3651b1(0x9b)](a327_0x16506e)[_0x3651b1(0xb1)](_0x3651b1(0xd5));});a327_0x16506e();'use strict';var __importDefault=this&&this[a327_0x1fa718(0xc5)]||function(_0x125b99){return _0x125b99&&_0x125b99['__esModule']?_0x125b99:{'default':_0x125b99};};Object[a327_0x1fa718(0x96)](exports,'__esModule',{'value':!![]}),exports[a327_0x1fa718(0xad)]=void 0x0;const salesforce_1=require(a327_0x1fa718(0xb4)),constants_1=require('../../constants'),stream_1=require(a327_0x1fa718(0xdc)),jszip_1=__importDefault(require(a327_0x1fa718(0xd4))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a327_0x1fa718(0xd7)]+a327_0x1fa718(0xc8),CONTENT_TYPE='application/zip';class ComponentsDeployer extends stream_1[a327_0x1fa718(0xa7)]{constructor({apiVersion:_0x433535,instance:_0x1417d4,logger:_0x3ffee6,targetOrgId:_0x3ce058,trackingSettingId:_0x489709}){const _0x58ce16=a327_0x1fa718;super({'objectMode':!![]}),this[_0x58ce16(0xdd)]={'records':[],'binary':[]},this[_0x58ce16(0x9f)]=0x0,this[_0x58ce16(0xd9)]=[],this[_0x58ce16(0xe4)]=0x0,this['apiVersion']=_0x433535,this[_0x58ce16(0x9e)]=_0x1417d4,this['logger']=_0x3ffee6,this[_0x58ce16(0x9a)]=_0x3ce058,this[_0x58ce16(0xab)]=_0x489709;}async[a327_0x1fa718(0xc9)](){const _0x595d12=a327_0x1fa718;await this['deployAttachments']()[_0x595d12(0xd0)](_0x529b78=>this['populateAttachmentId'](_0x529b78))['then'](()=>this['deployOrgComponents']())[_0x595d12(0xd0)](_0x5be21f=>this[_0x595d12(0xe1)](_0x5be21f)),this[_0x595d12(0xbb)]();}[a327_0x1fa718(0xdb)](){const _0x193e9a=a327_0x1fa718,_0x5ee7e3=new salesforce_1[(_0x193e9a(0xca))]({'instance':this[_0x193e9a(0x9e)],'objectName':constants_1[_0x193e9a(0xb8)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x193e9a(0xb3)]});return _0x5ee7e3[_0x193e9a(0xd3)](this[_0x193e9a(0xdd)]);}[a327_0x1fa718(0xe3)](){const _0x5a0a4e=a327_0x1fa718,_0x223b38=new salesforce_1[(_0x5a0a4e(0xd1))]({'instance':this[_0x5a0a4e(0x9e)],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this[_0x5a0a4e(0xb3)],'allOrNone':![],'externalIdField':'Id'});return _0x223b38[_0x5a0a4e(0xd3)]({'records':this[_0x5a0a4e(0xd9)]});}async[a327_0x1fa718(0xe1)](_0x273ead){const _0x2e01c5=a327_0x1fa718;for(const {success:_0x5ac82b,error:_0x3fb9ca}of _0x273ead){if(_0x5ac82b){this[_0x2e01c5(0xe4)]++;continue;}_0x3fb9ca&&this[_0x2e01c5(0xaf)][_0x2e01c5(0xde)](_0x3fb9ca);}}[a327_0x1fa718(0xba)](_0x5d6f4f){const _0xfc25cd=a327_0x1fa718;return _0x5d6f4f+this[_0xfc25cd(0x9f)]>=salesforce_1[_0xfc25cd(0xb9)][_0xfc25cd(0xc4)]||this[_0xfc25cd(0xdd)]['records'][_0xfc25cd(0xc2)]===MAX_COMPOSITE_CHUNK_COUNT;}[a327_0x1fa718(0xbb)](){const _0x20c3a9=a327_0x1fa718;this['binaryRecordsSizeChunk']=0x0,this[_0x20c3a9(0xdd)]={'records':[],'binary':[]},this[_0x20c3a9(0xd9)]=[];}[a327_0x1fa718(0xa9)](_0x57a989){const _0x1c7568=a327_0x1fa718;for(const _0x4f927c in _0x57a989){this[_0x1c7568(0xd9)][_0x4f927c][ATTACHMENT_FIELD_NAME]=_0x57a989[_0x4f927c]['id'];}}async[a327_0x1fa718(0xb5)](_0x212f8a,_0x2a6b80){const _0x6d7f63=a327_0x1fa718,{listMetadataItem:_0x38fb94,sourceMemberRecord:_0x30dd33}=_0x212f8a,_0x3c0d47={'attributes':{'type':constants_1[_0x6d7f63(0xb8)],'binaryPartName':_0x38fb94[_0x6d7f63(0xa6)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x30dd33[_0x6d7f63(0xa8)],'Name':_0x38fb94['fullName'],'Description':_0x38fb94[_0x6d7f63(0xdf)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x6d7f63(0x9a)],'Body':_0x38fb94['fullName']},_0x242251={'binaryFieldName':constants_1['BINARY_FIELD_NAME'],'name':_0x38fb94['fullName'],'value':stream_1[_0x6d7f63(0xc7)]['from'](_0x2a6b80)};this[_0x6d7f63(0xdd)]['records'][_0x6d7f63(0x98)](_0x3c0d47),this['attachmentsToDeployChunk']['binary'][_0x6d7f63(0x98)](_0x242251);}[a327_0x1fa718(0xe0)](_0x2a99bb){const _0x10f028=a327_0x1fa718,_0x4de93d=new jszip_1[(_0x10f028(0xa4))]();for(const _0xf06aee in _0x2a99bb){_0x4de93d[_0x10f028(0xa5)](_0xf06aee,_0x2a99bb[_0xf06aee]);}return _0x4de93d['generateAsync']({'type':_0x10f028(0xbd)});}['addOrgComponentToChunk'](_0x418aa9,_0x2ada30){const _0x41a730=a327_0x1fa718,_0x3e9740={'attributes':{'type':constants_1[_0x41a730(0xb6)]},'Id':_0x2ada30[_0x41a730(0xcc)],[constants_2[_0x41a730(0xd7)]+'Is_Deleted__c']:_0x2ada30[_0x41a730(0xb2)],[constants_2[_0x41a730(0xd7)]+_0x41a730(0xb7)]:_0x2ada30[_0x41a730(0xc6)],[constants_2[_0x41a730(0xd7)]+_0x41a730(0x9c)]:_0x2ada30['sourceMemberId'],[constants_2[_0x41a730(0xd7)]+_0x41a730(0xb0)]:_0x2ada30[_0x41a730(0xd8)],[constants_2['FLOSUM_NAMESPACE']+_0x41a730(0x97)]:_0x418aa9['fullName'],[constants_2[_0x41a730(0xd7)]+_0x41a730(0xda)]:_0x418aa9[_0x41a730(0xa6)],[constants_2[_0x41a730(0xd7)]+_0x41a730(0xd2)]:_0x418aa9['type'],[constants_2[_0x41a730(0xd7)]+_0x41a730(0xcb)]:_0x418aa9[_0x41a730(0x9d)],[constants_2[_0x41a730(0xd7)]+_0x41a730(0xcd)]:constants_1['METADATA_FOLDER_MAP'][_0x41a730(0xa3)](_0x418aa9['type'])||null,[constants_2['FLOSUM_NAMESPACE']+'Is_Retrieved__c']:!![],[constants_2[_0x41a730(0xd7)]+'OrganisationName__c']:this[_0x41a730(0x9a)],[constants_2[_0x41a730(0xd7)]+'Tracking_Setting__c']:this[_0x41a730(0xab)],[constants_2[_0x41a730(0xd7)]+_0x41a730(0xa1)]:_0x41a730(0xbf)};this[_0x41a730(0xd9)]['push'](_0x3e9740);}async['_write'](_0x4b5787,_0x74336f,_0x1e2fdb){const _0x2461d6=a327_0x1fa718;try{const {listMetadataItem:_0x4d3963,sourceMemberRecord:_0x1920ac,files:_0x2b8326}=_0x4b5787,_0x1cef61=await this['createZip'](_0x2b8326),_0x146022=Buffer[_0x2461d6(0xc3)](_0x1cef61);this[_0x2461d6(0xba)](_0x146022)&&await this['deploy'](),this[_0x2461d6(0x9f)]+=_0x146022,await this[_0x2461d6(0xb5)](_0x4b5787,_0x1cef61),this[_0x2461d6(0xc1)](_0x4d3963,_0x1920ac),_0x1e2fdb();}catch(_0x5b4fef){_0x1e2fdb(_0x5b4fef);}}async['_final'](_0x4cb9dc){const _0x3b7dcc=a327_0x1fa718;try{this['attachmentsToDeployChunk'][_0x3b7dcc(0xa2)][_0x3b7dcc(0xc2)]&&this[_0x3b7dcc(0xd9)][_0x3b7dcc(0xc2)]&&await this[_0x3b7dcc(0xc9)](),this['logger']['log']('Process\x20completed\x20for\x20'+this[_0x3b7dcc(0xe4)]+_0x3b7dcc(0xcf)),await this[_0x3b7dcc(0xaf)]['update'](),_0x4cb9dc();}catch(_0x14600f){_0x4cb9dc(_0x14600f);}}}exports['ComponentsDeployer']=ComponentsDeployer;function a327_0x55b2(_0x2ac3e6,_0x51b678){const _0xb52df3=a327_0x2700();return a327_0x55b2=function(_0x16506e,_0x36e908){_0x16506e=_0x16506e-0x96;let _0x27002a=_0xb52df3[_0x16506e];return _0x27002a;},a327_0x55b2(_0x2ac3e6,_0x51b678);}function a327_0x2700(){const _0x69424=['binaryRecordsSizeChunk','21iltroT','Status__c','records','has','default','file','fullName','Writable','attachmentId','populateAttachmentId','162381OPswjH','trackingSettingId','1169714pTDTkF','ComponentsDeployer','432Iwfbwq','logger','Last_Updated_By__c','search','isNameObsolete','apiVersion','@flosum/salesforce','addAttachmentToChunk','ORG_COMPONENT_OBJECT_NAME','Revision_Counter__c','ATTACHMENT_OBJECT_NAME','CompositeConstants','isReachedMaxChunk','resetChunks','3125815GHGZmW','nodebuffer','4827483RBmedm','Retrieved','toString','addOrgComponentToChunk','length','byteLength','MAX_BODY_SIZE','__importDefault','revisionCounter','Readable','Attachment_ID__c','deploy','CompositeBinaryDeployData','Label__c','componentId','Folder__c','apply','\x20components','then','RestSimpleDeployData','Component_Type__c','execute','jszip','(((.+)+)+)+$','8120YIzrKD','FLOSUM_NAMESPACE','changedBy','orgComponentsToDeployChunk','Name__c','deployAttachments','stream','attachmentsToDeployChunk','error','type','createZip','handleDeployResult','1628728viZZso','deployOrgComponents','successDeployedCounter','defineProperty','API_Name__c','push','1812urBApQ','targetOrgId','constructor','Source_Member_Id__c','fileName','instance'];a327_0x2700=function(){return _0x69424;};return a327_0x2700();}