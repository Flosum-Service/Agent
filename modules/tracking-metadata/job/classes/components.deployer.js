const a338_0x11431c=a338_0x1729;(function(_0x4b6362,_0x414ade){const _0x44cde7=a338_0x1729,_0x3c3062=_0x4b6362();while(!![]){try{const _0x27785b=parseInt(_0x44cde7(0xd9))/0x1*(-parseInt(_0x44cde7(0x10d))/0x2)+parseInt(_0x44cde7(0xfa))/0x3+parseInt(_0x44cde7(0x126))/0x4+parseInt(_0x44cde7(0x100))/0x5+-parseInt(_0x44cde7(0x123))/0x6*(parseInt(_0x44cde7(0xf1))/0x7)+parseInt(_0x44cde7(0xde))/0x8*(parseInt(_0x44cde7(0x121))/0x9)+-parseInt(_0x44cde7(0x101))/0xa;if(_0x27785b===_0x414ade)break;else _0x3c3062['push'](_0x3c3062['shift']());}catch(_0x9b3bec){_0x3c3062['push'](_0x3c3062['shift']());}}}(a338_0x12c0,0xe9055));const a338_0x3ed937=(function(){let _0xd89a75=!![];return function(_0x3585c8,_0x2f3048){const _0x48f986=_0xd89a75?function(){if(_0x2f3048){const _0x3c0439=_0x2f3048['apply'](_0x3585c8,arguments);return _0x2f3048=null,_0x3c0439;}}:function(){};return _0xd89a75=![],_0x48f986;};}()),a338_0x51c81a=a338_0x3ed937(this,function(){const _0x1a3914=a338_0x1729;return a338_0x51c81a[_0x1a3914(0x11b)]()['search'](_0x1a3914(0x117))[_0x1a3914(0x11b)]()[_0x1a3914(0x118)](a338_0x51c81a)[_0x1a3914(0xf5)](_0x1a3914(0x117));});a338_0x51c81a();'use strict';var __importDefault=this&&this[a338_0x11431c(0x125)]||function(_0x34a303){const _0x5c2757=a338_0x11431c;return _0x34a303&&_0x34a303[_0x5c2757(0xe7)]?_0x34a303:{'default':_0x34a303};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a338_0x11431c(0x10e)]=void 0x0;const salesforce_1=require(a338_0x11431c(0x111)),constants_1=require(a338_0x11431c(0x113)),stream_1=require(a338_0x11431c(0xe1)),jszip_1=__importDefault(require(a338_0x11431c(0xff))),constants_2=require(a338_0x11431c(0xef)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a338_0x11431c(0x104),CONTENT_TYPE=a338_0x11431c(0xdd);class ComponentsDeployer extends stream_1[a338_0x11431c(0x11a)]{constructor({apiVersion:_0x270ac9,instance:_0x46b256,logger:_0xb7e2b6,targetOrgId:_0x42f0d4,trackingSettingId:_0x5fd814}){const _0x52058d=a338_0x11431c;super({'objectMode':!![]}),this[_0x52058d(0xf3)]={'records':[],'binary':[]},this[_0x52058d(0x11c)]=0x0,this[_0x52058d(0xe4)]=[],this[_0x52058d(0x112)]=0x0,this[_0x52058d(0x11e)]=_0x270ac9,this[_0x52058d(0xe2)]=_0x46b256,this['logger']=_0xb7e2b6,this[_0x52058d(0xe0)]=_0x42f0d4,this[_0x52058d(0x128)]=_0x5fd814;}async[a338_0x11431c(0xf4)](){const _0x1dd114=a338_0x11431c;await this['deployAttachments']()[_0x1dd114(0x114)](_0x5b5935=>this['populateAttachmentId'](_0x5b5935))[_0x1dd114(0x114)](()=>this[_0x1dd114(0x10c)]())['then'](_0x1af067=>this[_0x1dd114(0xea)](_0x1af067)),this['resetChunks']();}[a338_0x11431c(0xe8)](){const _0x3f1dcc=a338_0x11431c,_0x348727=new salesforce_1['CompositeBinaryDeployData']({'instance':this['instance'],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x3f1dcc(0x11e)]});return _0x348727['execute'](this[_0x3f1dcc(0xf3)]);}['deployOrgComponents'](){const _0x470ad1=a338_0x11431c,_0x5a1290=new salesforce_1[(_0x470ad1(0xe5))]({'instance':this[_0x470ad1(0xe2)],'objectName':constants_1[_0x470ad1(0xed)],'api':this[_0x470ad1(0x11e)],'allOrNone':![],'externalIdField':'Id'});return _0x5a1290['execute']({'records':this[_0x470ad1(0xe4)]});}async['handleDeployResult'](_0x3f7cc5){const _0xeaf1d9=a338_0x11431c;for(const {success:_0x5f199f,error:_0x5343f0}of _0x3f7cc5){if(_0x5f199f){this[_0xeaf1d9(0x112)]++;continue;}_0x5343f0&&this['logger'][_0xeaf1d9(0xeb)](_0x5343f0);}}[a338_0x11431c(0x122)](_0xc49483){const _0x32cdf3=a338_0x11431c;return _0xc49483+this[_0x32cdf3(0x11c)]>=salesforce_1['CompositeConstants'][_0x32cdf3(0x10b)]||this['attachmentsToDeployChunk'][_0x32cdf3(0x110)]['length']===MAX_COMPOSITE_CHUNK_COUNT;}[a338_0x11431c(0x120)](){const _0x47b3c5=a338_0x11431c;this[_0x47b3c5(0x11c)]=0x0,this[_0x47b3c5(0xf3)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a338_0x11431c(0xd7)](_0x1fcf03){const _0x23dab5=a338_0x11431c;for(const _0x45f0e9 in _0x1fcf03){this[_0x23dab5(0xe4)][_0x45f0e9][ATTACHMENT_FIELD_NAME]=_0x1fcf03[_0x45f0e9]['id'];}}async[a338_0x11431c(0xe6)](_0x42972e,_0x224d3c){const _0x15f38d=a338_0x11431c,{listMetadataItem:_0x3d7347,sourceMemberRecord:_0x4acb3a}=_0x42972e,_0x59c4f9={'attributes':{'type':constants_1[_0x15f38d(0xdf)],'binaryPartName':_0x3d7347[_0x15f38d(0x115)],'binaryPartNameAlias':constants_1[_0x15f38d(0x124)]},'Id':_0x4acb3a[_0x15f38d(0x129)],'Name':_0x3d7347[_0x15f38d(0x115)],'Description':_0x3d7347[_0x15f38d(0xfb)],'ContentType':CONTENT_TYPE,'ParentId':this['targetOrgId'],'Body':_0x3d7347[_0x15f38d(0x115)]},_0x40c4ff={'binaryFieldName':constants_1[_0x15f38d(0x124)],'name':_0x3d7347[_0x15f38d(0x115)],'value':stream_1['Readable'][_0x15f38d(0x109)](_0x224d3c)};this[_0x15f38d(0xf3)]['records'][_0x15f38d(0xee)](_0x59c4f9),this[_0x15f38d(0xf3)]['binary']['push'](_0x40c4ff);}[a338_0x11431c(0xf9)](_0x218b42){const _0x24608d=a338_0x11431c,_0x5a3f6c=new jszip_1[(_0x24608d(0xf7))]();for(const _0x489e0b in _0x218b42){_0x5a3f6c[_0x24608d(0x102)](_0x489e0b,_0x218b42[_0x489e0b]);}return _0x5a3f6c[_0x24608d(0xfc)]({'type':_0x24608d(0x10f)});}[a338_0x11431c(0x11d)](_0x23b6a2,_0x3268c5){const _0x3ede0b=a338_0x11431c,_0x268bd0={'attributes':{'type':constants_1[_0x3ede0b(0xed)]},'Id':_0x3268c5[_0x3ede0b(0xe3)],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0xd8)]:_0x3268c5[_0x3ede0b(0x119)],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0xf8)]:_0x3268c5[_0x3ede0b(0x108)],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0xd6)]:_0x3268c5[_0x3ede0b(0x103)],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0xf6)]:_0x3268c5[_0x3ede0b(0xda)],[constants_2[_0x3ede0b(0xfe)]+'API_Name__c']:_0x23b6a2[_0x3ede0b(0x115)],[constants_2[_0x3ede0b(0xfe)]+'Name__c']:_0x23b6a2[_0x3ede0b(0x115)],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0x11f)]:_0x23b6a2[_0x3ede0b(0xfb)],[constants_2[_0x3ede0b(0xfe)]+'Label__c']:_0x23b6a2[_0x3ede0b(0x107)],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0xfd)]:constants_1[_0x3ede0b(0xdc)][_0x3ede0b(0x105)](_0x23b6a2[_0x3ede0b(0xfb)])||null,[constants_2[_0x3ede0b(0xfe)]+'Is_Retrieved__c']:!![],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0x116)]:this[_0x3ede0b(0xe0)],[constants_2['FLOSUM_NAMESPACE']+'Tracking_Setting__c']:this[_0x3ede0b(0x128)],[constants_2[_0x3ede0b(0xfe)]+_0x3ede0b(0x106)]:_0x3ede0b(0xf2)};this[_0x3ede0b(0xe4)]['push'](_0x268bd0);}async['_write'](_0x4d09db,_0x45e597,_0x2cd3d4){const _0x19ff17=a338_0x11431c;try{const {listMetadataItem:_0x349832,sourceMemberRecord:_0x10a250,files:_0x5b4b03}=_0x4d09db,_0x3b3925=await this[_0x19ff17(0xf9)](_0x5b4b03),_0x49e28c=Buffer[_0x19ff17(0xdb)](_0x3b3925);this[_0x19ff17(0x122)](_0x49e28c)&&await this[_0x19ff17(0xf4)](),this[_0x19ff17(0x11c)]+=_0x49e28c,await this[_0x19ff17(0xe6)](_0x4d09db,_0x3b3925),this['addOrgComponentToChunk'](_0x349832,_0x10a250),_0x2cd3d4();}catch(_0xffdcf2){_0x2cd3d4(_0xffdcf2);}}async[a338_0x11431c(0x127)](_0x2a385a){const _0x3090fe=a338_0x11431c;try{this[_0x3090fe(0xf3)][_0x3090fe(0x110)][_0x3090fe(0xf0)]&&this['orgComponentsToDeployChunk'][_0x3090fe(0xf0)]&&await this['deploy'](),this[_0x3090fe(0xec)]['log']('Process\x20completed\x20for\x20'+this[_0x3090fe(0x112)]+_0x3090fe(0x10a)),await this[_0x3090fe(0xec)][_0x3090fe(0xe9)](),_0x2a385a();}catch(_0x3dc19b){_0x2a385a(_0x3dc19b);}}}function a338_0x12c0(){const _0x4dd2a6=['fullName','OrganisationName__c','(((.+)+)+)+$','constructor','isNameObsolete','Writable','toString','binaryRecordsSizeChunk','addOrgComponentToChunk','apiVersion','Component_Type__c','resetChunks','9Yscqys','isReachedMaxChunk','11436468kLNGrf','BINARY_FIELD_NAME','__importDefault','1975776GKGfmb','_final','trackingSettingId','attachmentId','Source_Member_Id__c','populateAttachmentId','Is_Deleted__c','4RJRDkB','changedBy','byteLength','METADATA_FOLDER_MAP','application/zip','14314632uDTzuq','ATTACHMENT_OBJECT_NAME','targetOrgId','stream','instance','componentId','orgComponentsToDeployChunk','RestSimpleDeployData','addAttachmentToChunk','__esModule','deployAttachments','update','handleDeployResult','error','logger','ORG_COMPONENT_OBJECT_NAME','push','../../../../constants','length','7RwwwmJ','Retrieved','attachmentsToDeployChunk','deploy','search','Last_Updated_By__c','default','Revision_Counter__c','createZip','3734790bwSazn','type','generateAsync','Folder__c','FLOSUM_NAMESPACE','jszip','4654155diiPxX','5586310MGLnwm','file','sourceMemberId','Attachment_ID__c','has','Status__c','fileName','revisionCounter','from','\x20components','MAX_BODY_SIZE','deployOrgComponents','519936HnYSRs','ComponentsDeployer','nodebuffer','records','@flosum/salesforce','successDeployedCounter','../../constants','then'];a338_0x12c0=function(){return _0x4dd2a6;};return a338_0x12c0();}function a338_0x1729(_0x4b36a2,_0x2c7eae){const _0x4e8d3c=a338_0x12c0();return a338_0x1729=function(_0x51c81a,_0x3ed937){_0x51c81a=_0x51c81a-0xd6;let _0x12c0ae=_0x4e8d3c[_0x51c81a];return _0x12c0ae;},a338_0x1729(_0x4b36a2,_0x2c7eae);}exports['ComponentsDeployer']=ComponentsDeployer;