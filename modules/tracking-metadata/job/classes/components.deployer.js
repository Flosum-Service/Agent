const a295_0x2f384a=a295_0x24bb;(function(_0x8b2fa9,_0x43188b){const _0x2c8a66=a295_0x24bb,_0x2f78bd=_0x8b2fa9();while(!![]){try{const _0x59b5d7=parseInt(_0x2c8a66(0xad))/0x1*(-parseInt(_0x2c8a66(0xa3))/0x2)+parseInt(_0x2c8a66(0x97))/0x3*(parseInt(_0x2c8a66(0xc9))/0x4)+parseInt(_0x2c8a66(0xc5))/0x5+parseInt(_0x2c8a66(0x9a))/0x6*(-parseInt(_0x2c8a66(0xbd))/0x7)+parseInt(_0x2c8a66(0xd7))/0x8*(parseInt(_0x2c8a66(0xe6))/0x9)+-parseInt(_0x2c8a66(0x9b))/0xa+parseInt(_0x2c8a66(0xc1))/0xb;if(_0x59b5d7===_0x43188b)break;else _0x2f78bd['push'](_0x2f78bd['shift']());}catch(_0x880657){_0x2f78bd['push'](_0x2f78bd['shift']());}}}(a295_0x68e6,0x8339e));const a295_0x30f139=(function(){let _0x552a1a=!![];return function(_0x1540fd,_0xefeed3){const _0x2f7743=_0x552a1a?function(){const _0x502c3d=a295_0x24bb;if(_0xefeed3){const _0x48c53a=_0xefeed3[_0x502c3d(0xb1)](_0x1540fd,arguments);return _0xefeed3=null,_0x48c53a;}}:function(){};return _0x552a1a=![],_0x2f7743;};}()),a295_0x196341=a295_0x30f139(this,function(){const _0x5e0eaf=a295_0x24bb;return a295_0x196341[_0x5e0eaf(0x9e)]()[_0x5e0eaf(0xa6)](_0x5e0eaf(0xdc))['toString']()['constructor'](a295_0x196341)[_0x5e0eaf(0xa6)](_0x5e0eaf(0xdc));});function a295_0x68e6(){const _0x198e39=['orgComponentsToDeployChunk','4276695fKQuek','push','execute','sourceMemberId','8tOYBrc','Is_Deleted__c','_final','Component_Type__c','Status__c','FLOSUM_NAMESPACE','Retrieved','METADATA_FOLDER_MAP','resetChunks','targetOrgId','addOrgComponentToChunk','CompositeConstants','MAX_BODY_SIZE','@flosum/salesforce','8fABkMy','length','from','log','isReachedMaxChunk','(((.+)+)+)+$','createZip','jszip','handleDeployResult','Label__c','logger','isNameObsolete','__importDefault','Last_Updated_By__c','successDeployedCounter','4223736nNOOah','revisionCounter','binaryRecordsSizeChunk','../../constants','type','Revision_Counter__c','API_Name__c','60054GedqXr','__esModule','Tracking_Setting__c','7248svknSK','6470170nZZtXD','instance','RestSimpleDeployData','toString','then','apiVersion','addAttachmentToChunk','default','974230eslEVT','changedBy','Is_Retrieved__c','search','Writable','nodebuffer','fullName','deployOrgComponents','CompositeBinaryDeployData','OrganisationName__c','2FoUvCz','application/zip','records','trackingSettingId','apply','deployAttachments','ComponentsDeployer','attachmentsToDeployChunk','BINARY_FIELD_NAME','byteLength','ATTACHMENT_OBJECT_NAME','fileName','deploy','has','Folder__c','populateAttachmentId','1211cnIQHD','ORG_COMPONENT_OBJECT_NAME','generateAsync','stream','11033594FzJhyy','\x20components','Readable'];a295_0x68e6=function(){return _0x198e39;};return a295_0x68e6();}a295_0x196341();'use strict';var __importDefault=this&&this[a295_0x2f384a(0xe3)]||function(_0x10082d){return _0x10082d&&_0x10082d['__esModule']?_0x10082d:{'default':_0x10082d};};Object['defineProperty'](exports,a295_0x2f384a(0x98),{'value':!![]}),exports[a295_0x2f384a(0xb3)]=void 0x0;const salesforce_1=require(a295_0x2f384a(0xd6)),constants_1=require(a295_0x2f384a(0x93)),stream_1=require(a295_0x2f384a(0xc0)),jszip_1=__importDefault(require(a295_0x2f384a(0xde))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+'Attachment_ID__c',CONTENT_TYPE=a295_0x2f384a(0xae);function a295_0x24bb(_0x295f3f,_0x2497cf){const _0x4c0290=a295_0x68e6();return a295_0x24bb=function(_0x196341,_0x30f139){_0x196341=_0x196341-0x92;let _0x68e61=_0x4c0290[_0x196341];return _0x68e61;},a295_0x24bb(_0x295f3f,_0x2497cf);}class ComponentsDeployer extends stream_1[a295_0x2f384a(0xa7)]{constructor({apiVersion:_0x2702e3,instance:_0x302b2c,logger:_0x27a236,targetOrgId:_0x4cfa5c,trackingSettingId:_0x211412}){const _0x3f4be3=a295_0x2f384a;super({'objectMode':!![]}),this[_0x3f4be3(0xb4)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this['orgComponentsToDeployChunk']=[],this[_0x3f4be3(0xe5)]=0x0,this[_0x3f4be3(0xa0)]=_0x2702e3,this[_0x3f4be3(0x9c)]=_0x302b2c,this[_0x3f4be3(0xe1)]=_0x27a236,this[_0x3f4be3(0xd2)]=_0x4cfa5c,this['trackingSettingId']=_0x211412;}async[a295_0x2f384a(0xb9)](){const _0x4dd1c7=a295_0x2f384a;await this[_0x4dd1c7(0xb2)]()['then'](_0x1c8470=>this[_0x4dd1c7(0xbc)](_0x1c8470))[_0x4dd1c7(0x9f)](()=>this[_0x4dd1c7(0xaa)]())['then'](_0x2e116f=>this['handleDeployResult'](_0x2e116f)),this['resetChunks']();}['deployAttachments'](){const _0x42ba1f=a295_0x2f384a,_0xea4c8a=new salesforce_1[(_0x42ba1f(0xab))]({'instance':this[_0x42ba1f(0x9c)],'objectName':constants_1[_0x42ba1f(0xb7)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x42ba1f(0xa0)]});return _0xea4c8a[_0x42ba1f(0xc7)](this[_0x42ba1f(0xb4)]);}[a295_0x2f384a(0xaa)](){const _0x35cd62=a295_0x2f384a,_0x1baf84=new salesforce_1[(_0x35cd62(0x9d))]({'instance':this['instance'],'objectName':constants_1[_0x35cd62(0xbe)],'api':this[_0x35cd62(0xa0)],'allOrNone':![],'externalIdField':'Id'});return _0x1baf84[_0x35cd62(0xc7)]({'records':this[_0x35cd62(0xc4)]});}async[a295_0x2f384a(0xdf)](_0x3fea7a){const _0x175b3d=a295_0x2f384a;for(const {success:_0x2580b7,error:_0x5ca1f7}of _0x3fea7a){if(_0x2580b7){this[_0x175b3d(0xe5)]++;continue;}_0x5ca1f7&&this[_0x175b3d(0xe1)]['error'](_0x5ca1f7);}}[a295_0x2f384a(0xdb)](_0x3d359c){const _0x301cc0=a295_0x2f384a;return _0x3d359c+this[_0x301cc0(0x92)]>=salesforce_1[_0x301cc0(0xd4)][_0x301cc0(0xd5)]||this[_0x301cc0(0xb4)][_0x301cc0(0xaf)][_0x301cc0(0xd8)]===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x2f384a(0xd1)](){const _0x4af941=a295_0x2f384a;this[_0x4af941(0x92)]=0x0,this[_0x4af941(0xb4)]={'records':[],'binary':[]},this[_0x4af941(0xc4)]=[];}['populateAttachmentId'](_0x4e1ad3){for(const _0x1be662 in _0x4e1ad3){this['orgComponentsToDeployChunk'][_0x1be662][ATTACHMENT_FIELD_NAME]=_0x4e1ad3[_0x1be662]['id'];}}async[a295_0x2f384a(0xa1)](_0x1b2962,_0x4ece37){const _0x5c7509=a295_0x2f384a,{listMetadataItem:_0x49d7a9,sourceMemberRecord:_0x1448ec}=_0x1b2962,_0xa28792={'attributes':{'type':constants_1[_0x5c7509(0xb7)],'binaryPartName':_0x49d7a9[_0x5c7509(0xa9)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x1448ec['attachmentId'],'Name':_0x49d7a9[_0x5c7509(0xa9)],'Description':_0x49d7a9['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x5c7509(0xd2)],'Body':_0x49d7a9['fullName']},_0x511259={'binaryFieldName':constants_1[_0x5c7509(0xb5)],'name':_0x49d7a9['fullName'],'value':stream_1[_0x5c7509(0xc3)][_0x5c7509(0xd9)](_0x4ece37)};this['attachmentsToDeployChunk'][_0x5c7509(0xaf)]['push'](_0xa28792),this[_0x5c7509(0xb4)]['binary']['push'](_0x511259);}[a295_0x2f384a(0xdd)](_0x369a33){const _0x3ba60e=a295_0x2f384a,_0x3d5193=new jszip_1[(_0x3ba60e(0xa2))]();for(const _0x1ac2d0 in _0x369a33){_0x3d5193['file'](_0x1ac2d0,_0x369a33[_0x1ac2d0]);}return _0x3d5193[_0x3ba60e(0xbf)]({'type':_0x3ba60e(0xa8)});}[a295_0x2f384a(0xd3)](_0x484fbe,_0x164bc5){const _0x1577c0=a295_0x2f384a,_0x478b35={'attributes':{'type':constants_1[_0x1577c0(0xbe)]},'Id':_0x164bc5['componentId'],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0xca)]:_0x164bc5[_0x1577c0(0xe2)],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0x95)]:_0x164bc5[_0x1577c0(0xe7)],[constants_2[_0x1577c0(0xce)]+'Source_Member_Id__c']:_0x164bc5[_0x1577c0(0xc8)],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0xe4)]:_0x164bc5[_0x1577c0(0xa4)],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0x96)]:_0x484fbe[_0x1577c0(0xa9)],[constants_2[_0x1577c0(0xce)]+'Name__c']:_0x484fbe[_0x1577c0(0xa9)],[constants_2['FLOSUM_NAMESPACE']+_0x1577c0(0xcc)]:_0x484fbe[_0x1577c0(0x94)],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0xe0)]:_0x484fbe[_0x1577c0(0xb8)],[constants_2['FLOSUM_NAMESPACE']+_0x1577c0(0xbb)]:constants_1[_0x1577c0(0xd0)][_0x1577c0(0xba)](_0x484fbe[_0x1577c0(0x94)])||null,[constants_2[_0x1577c0(0xce)]+_0x1577c0(0xa5)]:!![],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0xac)]:this[_0x1577c0(0xd2)],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0x99)]:this[_0x1577c0(0xb0)],[constants_2[_0x1577c0(0xce)]+_0x1577c0(0xcd)]:_0x1577c0(0xcf)};this[_0x1577c0(0xc4)][_0x1577c0(0xc6)](_0x478b35);}async['_write'](_0x3af81d,_0x77eb64,_0x36aa5d){const _0x14cdf3=a295_0x2f384a;try{const {listMetadataItem:_0x5dfa1c,sourceMemberRecord:_0x1602de,files:_0xaaedd7}=_0x3af81d,_0x30bf47=await this[_0x14cdf3(0xdd)](_0xaaedd7),_0x5d50df=Buffer[_0x14cdf3(0xb6)](_0x30bf47);this[_0x14cdf3(0xdb)](_0x5d50df)&&await this[_0x14cdf3(0xb9)](),this[_0x14cdf3(0x92)]+=_0x5d50df,await this[_0x14cdf3(0xa1)](_0x3af81d,_0x30bf47),this['addOrgComponentToChunk'](_0x5dfa1c,_0x1602de),_0x36aa5d();}catch(_0x2bb36a){_0x36aa5d(_0x2bb36a);}}async[a295_0x2f384a(0xcb)](_0xb275aa){const _0x4651e7=a295_0x2f384a;try{this['attachmentsToDeployChunk'][_0x4651e7(0xaf)][_0x4651e7(0xd8)]&&this[_0x4651e7(0xc4)][_0x4651e7(0xd8)]&&await this['deploy'](),this[_0x4651e7(0xe1)][_0x4651e7(0xda)]('Process\x20completed\x20for\x20'+this[_0x4651e7(0xe5)]+_0x4651e7(0xc2)),await this[_0x4651e7(0xe1)]['update'](),_0xb275aa();}catch(_0x1319e7){_0xb275aa(_0x1319e7);}}}exports[a295_0x2f384a(0xb3)]=ComponentsDeployer;