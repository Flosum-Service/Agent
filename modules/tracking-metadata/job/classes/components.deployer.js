const a338_0x37f3c1=a338_0x480d;(function(_0xb17815,_0x7a135f){const _0x589c65=a338_0x480d,_0x3b103f=_0xb17815();while(!![]){try{const _0x37205c=parseInt(_0x589c65(0x167))/0x1*(parseInt(_0x589c65(0x134))/0x2)+-parseInt(_0x589c65(0x155))/0x3*(parseInt(_0x589c65(0x14a))/0x4)+-parseInt(_0x589c65(0x13c))/0x5+parseInt(_0x589c65(0x14f))/0x6+-parseInt(_0x589c65(0x133))/0x7+parseInt(_0x589c65(0x16e))/0x8+parseInt(_0x589c65(0x172))/0x9*(parseInt(_0x589c65(0x139))/0xa);if(_0x37205c===_0x7a135f)break;else _0x3b103f['push'](_0x3b103f['shift']());}catch(_0x389677){_0x3b103f['push'](_0x3b103f['shift']());}}}(a338_0xf0a6,0xee179));const a338_0x53c514=(function(){let _0x20fa0f=!![];return function(_0x41e79a,_0x35f464){const _0x4050f0=_0x20fa0f?function(){if(_0x35f464){const _0x47f912=_0x35f464['apply'](_0x41e79a,arguments);return _0x35f464=null,_0x47f912;}}:function(){};return _0x20fa0f=![],_0x4050f0;};}()),a338_0x98b43a=a338_0x53c514(this,function(){const _0x48a4cd=a338_0x480d;return a338_0x98b43a[_0x48a4cd(0x16d)]()[_0x48a4cd(0x15e)]('(((.+)+)+)+$')[_0x48a4cd(0x16d)]()[_0x48a4cd(0x164)](a338_0x98b43a)['search'](_0x48a4cd(0x135));});function a338_0x480d(_0x2c2c6d,_0x356069){const _0x334246=a338_0xf0a6();return a338_0x480d=function(_0x98b43a,_0x53c514){_0x98b43a=_0x98b43a-0x12a;let _0xf0a6c9=_0x334246[_0x98b43a];return _0xf0a6c9;},a338_0x480d(_0x2c2c6d,_0x356069);}a338_0x98b43a();'use strict';var __importDefault=this&&this['__importDefault']||function(_0xf073c){const _0x4d2e82=a338_0x480d;return _0xf073c&&_0xf073c[_0x4d2e82(0x153)]?_0xf073c:{'default':_0xf073c};};Object[a338_0x37f3c1(0x130)](exports,'__esModule',{'value':!![]}),exports[a338_0x37f3c1(0x145)]=void 0x0;const salesforce_1=require(a338_0x37f3c1(0x13b)),constants_1=require(a338_0x37f3c1(0x149)),stream_1=require(a338_0x37f3c1(0x15c)),jszip_1=__importDefault(require(a338_0x37f3c1(0x13a))),constants_2=require(a338_0x37f3c1(0x17a)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a338_0x37f3c1(0x158)]+a338_0x37f3c1(0x154),CONTENT_TYPE=a338_0x37f3c1(0x15a);class ComponentsDeployer extends stream_1[a338_0x37f3c1(0x12e)]{constructor({apiVersion:_0x2c701b,instance:_0x785012,logger:_0x16e517,targetOrgId:_0x2b516a,trackingSettingId:_0x338c09}){const _0x4df7f4=a338_0x37f3c1;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x4df7f4(0x131)]=0x0,this[_0x4df7f4(0x14d)]=[],this[_0x4df7f4(0x14c)]=0x0,this[_0x4df7f4(0x12a)]=_0x2c701b,this[_0x4df7f4(0x14e)]=_0x785012,this[_0x4df7f4(0x159)]=_0x16e517,this['targetOrgId']=_0x2b516a,this[_0x4df7f4(0x160)]=_0x338c09;}async[a338_0x37f3c1(0x161)](){const _0x2b287a=a338_0x37f3c1;await this['deployAttachments']()['then'](_0x3f4d70=>this[_0x2b287a(0x173)](_0x3f4d70))[_0x2b287a(0x13e)](()=>this[_0x2b287a(0x148)]())['then'](_0x241692=>this[_0x2b287a(0x13f)](_0x241692)),this[_0x2b287a(0x141)]();}['deployAttachments'](){const _0xab127=a338_0x37f3c1,_0x16417c=new salesforce_1[(_0xab127(0x12c))]({'instance':this[_0xab127(0x14e)],'objectName':constants_1[_0xab127(0x170)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0xab127(0x12a)]});return _0x16417c['execute'](this[_0xab127(0x16a)]);}[a338_0x37f3c1(0x148)](){const _0x44801e=a338_0x37f3c1,_0x2beebb=new salesforce_1[(_0x44801e(0x165))]({'instance':this['instance'],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this[_0x44801e(0x12a)],'allOrNone':![],'externalIdField':'Id'});return _0x2beebb[_0x44801e(0x140)]({'records':this[_0x44801e(0x14d)]});}async[a338_0x37f3c1(0x13f)](_0x265ae2){const _0x2fc471=a338_0x37f3c1;for(const {success:_0x58a8de,error:_0x370fca}of _0x265ae2){if(_0x58a8de){this[_0x2fc471(0x14c)]++;continue;}_0x370fca&&this[_0x2fc471(0x159)][_0x2fc471(0x16f)](_0x370fca);}}[a338_0x37f3c1(0x150)](_0x308138){const _0x3c4d23=a338_0x37f3c1;return _0x308138+this[_0x3c4d23(0x131)]>=salesforce_1['CompositeConstants']['MAX_BODY_SIZE']||this['attachmentsToDeployChunk']['records'][_0x3c4d23(0x162)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x32f721=a338_0x37f3c1;this[_0x32f721(0x131)]=0x0,this[_0x32f721(0x16a)]={'records':[],'binary':[]},this[_0x32f721(0x14d)]=[];}[a338_0x37f3c1(0x173)](_0x476ff2){const _0x46103c=a338_0x37f3c1;for(const _0x38dab4 in _0x476ff2){this[_0x46103c(0x14d)][_0x38dab4][ATTACHMENT_FIELD_NAME]=_0x476ff2[_0x38dab4]['id'];}}async[a338_0x37f3c1(0x152)](_0x409a0f,_0x162748){const _0x2c7d91=a338_0x37f3c1,{listMetadataItem:_0x3f5c13,sourceMemberRecord:_0x3af742}=_0x409a0f,_0x2ecb96={'attributes':{'type':constants_1[_0x2c7d91(0x170)],'binaryPartName':_0x3f5c13['fullName'],'binaryPartNameAlias':constants_1[_0x2c7d91(0x17c)]},'Id':_0x3af742[_0x2c7d91(0x15f)],'Name':_0x3f5c13['fullName'],'Description':_0x3f5c13[_0x2c7d91(0x16b)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x2c7d91(0x143)],'Body':_0x3f5c13['fullName']},_0x477656={'binaryFieldName':constants_1[_0x2c7d91(0x17c)],'name':_0x3f5c13[_0x2c7d91(0x138)],'value':stream_1[_0x2c7d91(0x16c)][_0x2c7d91(0x146)](_0x162748)};this[_0x2c7d91(0x16a)][_0x2c7d91(0x14b)][_0x2c7d91(0x151)](_0x2ecb96),this['attachmentsToDeployChunk'][_0x2c7d91(0x17b)][_0x2c7d91(0x151)](_0x477656);}[a338_0x37f3c1(0x171)](_0x55ada7){const _0x1442e3=a338_0x37f3c1,_0x26df5b=new jszip_1[(_0x1442e3(0x144))]();for(const _0x263db7 in _0x55ada7){_0x26df5b[_0x1442e3(0x178)](_0x263db7,_0x55ada7[_0x263db7]);}return _0x26df5b['generateAsync']({'type':'nodebuffer'});}[a338_0x37f3c1(0x12f)](_0x16f5df,_0x476a04){const _0x50cf73=a338_0x37f3c1,_0x14b738={'attributes':{'type':constants_1[_0x50cf73(0x156)]},'Id':_0x476a04[_0x50cf73(0x142)],[constants_2['FLOSUM_NAMESPACE']+_0x50cf73(0x12b)]:_0x476a04[_0x50cf73(0x157)],[constants_2[_0x50cf73(0x158)]+_0x50cf73(0x168)]:_0x476a04['revisionCounter'],[constants_2['FLOSUM_NAMESPACE']+_0x50cf73(0x137)]:_0x476a04['sourceMemberId'],[constants_2[_0x50cf73(0x158)]+_0x50cf73(0x136)]:_0x476a04[_0x50cf73(0x132)],[constants_2['FLOSUM_NAMESPACE']+'API_Name__c']:_0x16f5df['fullName'],[constants_2[_0x50cf73(0x158)]+_0x50cf73(0x12d)]:_0x16f5df['fullName'],[constants_2['FLOSUM_NAMESPACE']+'Component_Type__c']:_0x16f5df[_0x50cf73(0x16b)],[constants_2[_0x50cf73(0x158)]+_0x50cf73(0x174)]:_0x16f5df['fileName'],[constants_2[_0x50cf73(0x158)]+'Folder__c']:constants_1[_0x50cf73(0x163)][_0x50cf73(0x169)](_0x16f5df[_0x50cf73(0x16b)])||null,[constants_2[_0x50cf73(0x158)]+'Is_Retrieved__c']:!![],[constants_2[_0x50cf73(0x158)]+_0x50cf73(0x147)]:this[_0x50cf73(0x143)],[constants_2[_0x50cf73(0x158)]+_0x50cf73(0x175)]:this[_0x50cf73(0x160)],[constants_2['FLOSUM_NAMESPACE']+_0x50cf73(0x15d)]:_0x50cf73(0x13d)};this[_0x50cf73(0x14d)][_0x50cf73(0x151)](_0x14b738);}async[a338_0x37f3c1(0x176)](_0x2b0bbd,_0x5f40e8,_0xa6b986){const _0x10f778=a338_0x37f3c1;try{const {listMetadataItem:_0x1e1ad5,sourceMemberRecord:_0x390f88,files:_0x3fd6a0}=_0x2b0bbd,_0x106598=await this[_0x10f778(0x171)](_0x3fd6a0),_0x1371c9=Buffer['byteLength'](_0x106598);this[_0x10f778(0x150)](_0x1371c9)&&await this['deploy'](),this['binaryRecordsSizeChunk']+=_0x1371c9,await this['addAttachmentToChunk'](_0x2b0bbd,_0x106598),this[_0x10f778(0x12f)](_0x1e1ad5,_0x390f88),_0xa6b986();}catch(_0x3230ba){_0xa6b986(_0x3230ba);}}async[a338_0x37f3c1(0x177)](_0x5233b3){const _0x504a8c=a338_0x37f3c1;try{this[_0x504a8c(0x16a)]['records']['length']&&this[_0x504a8c(0x14d)][_0x504a8c(0x162)]&&await this[_0x504a8c(0x161)](),this[_0x504a8c(0x159)][_0x504a8c(0x166)](_0x504a8c(0x179)+this['successDeployedCounter']+_0x504a8c(0x15b)),await this[_0x504a8c(0x159)]['update'](),_0x5233b3();}catch(_0x3e1a22){_0x5233b3(_0x3e1a22);}}}exports[a338_0x37f3c1(0x145)]=ComponentsDeployer;function a338_0xf0a6(){const _0x383ef4=['from','OrganisationName__c','deployOrgComponents','../../constants','4oFZvUW','records','successDeployedCounter','orgComponentsToDeployChunk','instance','819894jNPTea','isReachedMaxChunk','push','addAttachmentToChunk','__esModule','Attachment_ID__c','2797179Zvvcgp','ORG_COMPONENT_OBJECT_NAME','isNameObsolete','FLOSUM_NAMESPACE','logger','application/zip','\x20components','stream','Status__c','search','attachmentId','trackingSettingId','deploy','length','METADATA_FOLDER_MAP','constructor','RestSimpleDeployData','log','1SNrbeV','Revision_Counter__c','has','attachmentsToDeployChunk','type','Readable','toString','4854992eKOxLM','error','ATTACHMENT_OBJECT_NAME','createZip','2057769PvYsOu','populateAttachmentId','Label__c','Tracking_Setting__c','_write','_final','file','Process\x20completed\x20for\x20','../../../../constants','binary','BINARY_FIELD_NAME','apiVersion','Is_Deleted__c','CompositeBinaryDeployData','Name__c','Writable','addOrgComponentToChunk','defineProperty','binaryRecordsSizeChunk','changedBy','8196237XIRFRo','1160426nHFODO','(((.+)+)+)+$','Last_Updated_By__c','Source_Member_Id__c','fullName','110eDEHIA','jszip','@flosum/salesforce','3801390WjyRhb','Retrieved','then','handleDeployResult','execute','resetChunks','componentId','targetOrgId','default','ComponentsDeployer'];a338_0xf0a6=function(){return _0x383ef4;};return a338_0xf0a6();}