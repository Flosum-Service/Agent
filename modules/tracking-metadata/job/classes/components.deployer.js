const a327_0x33772b=a327_0x315c;(function(_0x1e56b0,_0x53e087){const _0x24b6ee=a327_0x315c,_0x231276=_0x1e56b0();while(!![]){try{const _0x14c568=-parseInt(_0x24b6ee(0x18d))/0x1+parseInt(_0x24b6ee(0x197))/0x2+-parseInt(_0x24b6ee(0x19a))/0x3+-parseInt(_0x24b6ee(0x178))/0x4*(parseInt(_0x24b6ee(0x17e))/0x5)+parseInt(_0x24b6ee(0x19c))/0x6+-parseInt(_0x24b6ee(0x179))/0x7+-parseInt(_0x24b6ee(0x14f))/0x8*(-parseInt(_0x24b6ee(0x17b))/0x9);if(_0x14c568===_0x53e087)break;else _0x231276['push'](_0x231276['shift']());}catch(_0x231b8e){_0x231276['push'](_0x231276['shift']());}}}(a327_0x1bf8,0xa804a));const a327_0x55d971=(function(){let _0x21744b=!![];return function(_0x383e38,_0x5c0a64){const _0x401c39=_0x21744b?function(){const _0x43825d=a327_0x315c;if(_0x5c0a64){const _0x2fece2=_0x5c0a64[_0x43825d(0x15d)](_0x383e38,arguments);return _0x5c0a64=null,_0x2fece2;}}:function(){};return _0x21744b=![],_0x401c39;};}()),a327_0x358f23=a327_0x55d971(this,function(){const _0x22c943=a327_0x315c;return a327_0x358f23[_0x22c943(0x182)]()[_0x22c943(0x189)]('(((.+)+)+)+$')[_0x22c943(0x182)]()[_0x22c943(0x15b)](a327_0x358f23)['search'](_0x22c943(0x16f));});a327_0x358f23();function a327_0x1bf8(){const _0x260b94=['log','Writable','fullName','binary','stream','componentId','isNameObsolete','logger','Is_Retrieved__c','API_Name__c','deployAttachments','createZip','Status__c','../../../../constants','(((.+)+)+)+$','execute','file','length','__importDefault','trackingSettingId','update','records','then','1772fkFbHw','7941899rioZgR','push','18OllvEx','isReachedMaxChunk','sourceMemberId','3945agsXGT','defineProperty','has','Attachment_ID__c','toString','instance','revisionCounter','MAX_BODY_SIZE','application/zip','jszip','Process\x20completed\x20for\x20','search','generateAsync','handleDeployResult','_final','795298GVwzmb','addOrgComponentToChunk','populateAttachmentId','Last_Updated_By__c','FLOSUM_NAMESPACE','_write','OrganisationName__c','Name__c','addAttachmentToChunk','Component_Type__c','2428250eFBpfX','byteLength','ComponentsDeployer','901350pohenV','Is_Deleted__c','3070926IfDkdA','successDeployedCounter','__esModule','Readable','Folder__c','resetChunks','ORG_COMPONENT_OBJECT_NAME','BINARY_FIELD_NAME','METADATA_FOLDER_MAP','\x20components','Tracking_Setting__c','changedBy','6168352CZLkQx','@flosum/salesforce','orgComponentsToDeployChunk','ATTACHMENT_OBJECT_NAME','apiVersion','binaryRecordsSizeChunk','deployOrgComponents','RestSimpleDeployData','targetOrgId','Label__c','Source_Member_Id__c','attachmentsToDeployChunk','constructor','CompositeBinaryDeployData','apply','type','CompositeConstants','deploy'];a327_0x1bf8=function(){return _0x260b94;};return a327_0x1bf8();}'use strict';var __importDefault=this&&this[a327_0x33772b(0x173)]||function(_0x2679fa){const _0x2eb46e=a327_0x33772b;return _0x2679fa&&_0x2679fa[_0x2eb46e(0x19e)]?_0x2679fa:{'default':_0x2679fa};};Object[a327_0x33772b(0x17f)](exports,a327_0x33772b(0x19e),{'value':!![]}),exports[a327_0x33772b(0x199)]=void 0x0;const salesforce_1=require(a327_0x33772b(0x150)),constants_1=require('../../constants'),stream_1=require(a327_0x33772b(0x165)),jszip_1=__importDefault(require(a327_0x33772b(0x187))),constants_2=require(a327_0x33772b(0x16e)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a327_0x33772b(0x191)]+a327_0x33772b(0x181),CONTENT_TYPE=a327_0x33772b(0x186);function a327_0x315c(_0x2df2ee,_0x41750d){const _0x1fd39b=a327_0x1bf8();return a327_0x315c=function(_0x358f23,_0x55d971){_0x358f23=_0x358f23-0x14a;let _0x1bf8a6=_0x1fd39b[_0x358f23];return _0x1bf8a6;},a327_0x315c(_0x2df2ee,_0x41750d);}class ComponentsDeployer extends stream_1[a327_0x33772b(0x162)]{constructor({apiVersion:_0xd1126,instance:_0x1a3622,logger:_0x3bf7c4,targetOrgId:_0x439738,trackingSettingId:_0x20c884}){const _0x5973fe=a327_0x33772b;super({'objectMode':!![]}),this[_0x5973fe(0x15a)]={'records':[],'binary':[]},this[_0x5973fe(0x154)]=0x0,this['orgComponentsToDeployChunk']=[],this[_0x5973fe(0x19d)]=0x0,this[_0x5973fe(0x153)]=_0xd1126,this[_0x5973fe(0x183)]=_0x1a3622,this['logger']=_0x3bf7c4,this[_0x5973fe(0x157)]=_0x439738,this[_0x5973fe(0x174)]=_0x20c884;}async[a327_0x33772b(0x160)](){const _0x45fdaa=a327_0x33772b;await this[_0x45fdaa(0x16b)]()[_0x45fdaa(0x177)](_0x57fa6c=>this[_0x45fdaa(0x18f)](_0x57fa6c))[_0x45fdaa(0x177)](()=>this['deployOrgComponents']())['then'](_0x53e357=>this[_0x45fdaa(0x18b)](_0x53e357)),this[_0x45fdaa(0x1a1)]();}['deployAttachments'](){const _0x2aed95=a327_0x33772b,_0x45c038=new salesforce_1[(_0x2aed95(0x15c))]({'instance':this[_0x2aed95(0x183)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x2aed95(0x153)]});return _0x45c038[_0x2aed95(0x170)](this[_0x2aed95(0x15a)]);}[a327_0x33772b(0x155)](){const _0x3b855c=a327_0x33772b,_0x4ce87f=new salesforce_1[(_0x3b855c(0x156))]({'instance':this[_0x3b855c(0x183)],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this[_0x3b855c(0x153)],'allOrNone':![],'externalIdField':'Id'});return _0x4ce87f[_0x3b855c(0x170)]({'records':this['orgComponentsToDeployChunk']});}async[a327_0x33772b(0x18b)](_0x258ff9){const _0x5cb7a5=a327_0x33772b;for(const {success:_0x33048d,error:_0x1fb505}of _0x258ff9){if(_0x33048d){this[_0x5cb7a5(0x19d)]++;continue;}_0x1fb505&&this[_0x5cb7a5(0x168)]['error'](_0x1fb505);}}[a327_0x33772b(0x17c)](_0x2e05fe){const _0x5bdfb9=a327_0x33772b;return _0x2e05fe+this[_0x5bdfb9(0x154)]>=salesforce_1[_0x5bdfb9(0x15f)][_0x5bdfb9(0x185)]||this[_0x5bdfb9(0x15a)][_0x5bdfb9(0x176)][_0x5bdfb9(0x172)]===MAX_COMPOSITE_CHUNK_COUNT;}[a327_0x33772b(0x1a1)](){const _0x5e9779=a327_0x33772b;this[_0x5e9779(0x154)]=0x0,this[_0x5e9779(0x15a)]={'records':[],'binary':[]},this[_0x5e9779(0x151)]=[];}[a327_0x33772b(0x18f)](_0x670a50){const _0x3fa9f1=a327_0x33772b;for(const _0x4007a4 in _0x670a50){this[_0x3fa9f1(0x151)][_0x4007a4][ATTACHMENT_FIELD_NAME]=_0x670a50[_0x4007a4]['id'];}}async['addAttachmentToChunk'](_0x33579a,_0x51004f){const _0x59da47=a327_0x33772b,{listMetadataItem:_0x2d52b0,sourceMemberRecord:_0x2bc742}=_0x33579a,_0x4811cf={'attributes':{'type':constants_1[_0x59da47(0x152)],'binaryPartName':_0x2d52b0[_0x59da47(0x163)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x2bc742['attachmentId'],'Name':_0x2d52b0['fullName'],'Description':_0x2d52b0[_0x59da47(0x15e)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x59da47(0x157)],'Body':_0x2d52b0[_0x59da47(0x163)]},_0x3ffd20={'binaryFieldName':constants_1[_0x59da47(0x14a)],'name':_0x2d52b0[_0x59da47(0x163)],'value':stream_1[_0x59da47(0x19f)]['from'](_0x51004f)};this['attachmentsToDeployChunk'][_0x59da47(0x176)][_0x59da47(0x17a)](_0x4811cf),this[_0x59da47(0x15a)][_0x59da47(0x164)][_0x59da47(0x17a)](_0x3ffd20);}[a327_0x33772b(0x16c)](_0x23e4bb){const _0x254bd7=a327_0x33772b,_0x135cb4=new jszip_1['default']();for(const _0x34459d in _0x23e4bb){_0x135cb4[_0x254bd7(0x171)](_0x34459d,_0x23e4bb[_0x34459d]);}return _0x135cb4[_0x254bd7(0x18a)]({'type':'nodebuffer'});}[a327_0x33772b(0x18e)](_0x16907f,_0x401443){const _0x57929e=a327_0x33772b,_0x4fe117={'attributes':{'type':constants_1[_0x57929e(0x1a2)]},'Id':_0x401443[_0x57929e(0x166)],[constants_2['FLOSUM_NAMESPACE']+_0x57929e(0x19b)]:_0x401443[_0x57929e(0x167)],[constants_2[_0x57929e(0x191)]+'Revision_Counter__c']:_0x401443[_0x57929e(0x184)],[constants_2[_0x57929e(0x191)]+_0x57929e(0x159)]:_0x401443[_0x57929e(0x17d)],[constants_2[_0x57929e(0x191)]+_0x57929e(0x190)]:_0x401443[_0x57929e(0x14e)],[constants_2['FLOSUM_NAMESPACE']+_0x57929e(0x16a)]:_0x16907f['fullName'],[constants_2[_0x57929e(0x191)]+_0x57929e(0x194)]:_0x16907f[_0x57929e(0x163)],[constants_2[_0x57929e(0x191)]+_0x57929e(0x196)]:_0x16907f[_0x57929e(0x15e)],[constants_2['FLOSUM_NAMESPACE']+_0x57929e(0x158)]:_0x16907f['fileName'],[constants_2[_0x57929e(0x191)]+_0x57929e(0x1a0)]:constants_1[_0x57929e(0x14b)][_0x57929e(0x180)](_0x16907f[_0x57929e(0x15e)])||null,[constants_2[_0x57929e(0x191)]+_0x57929e(0x169)]:!![],[constants_2[_0x57929e(0x191)]+_0x57929e(0x193)]:this['targetOrgId'],[constants_2[_0x57929e(0x191)]+_0x57929e(0x14d)]:this[_0x57929e(0x174)],[constants_2[_0x57929e(0x191)]+_0x57929e(0x16d)]:'Retrieved'};this[_0x57929e(0x151)][_0x57929e(0x17a)](_0x4fe117);}async[a327_0x33772b(0x192)](_0x14e24c,_0x954fca,_0x40dd22){const _0x12fc03=a327_0x33772b;try{const {listMetadataItem:_0x5756b0,sourceMemberRecord:_0x40908c,files:_0x27c43e}=_0x14e24c,_0x1c05c3=await this[_0x12fc03(0x16c)](_0x27c43e),_0x594243=Buffer[_0x12fc03(0x198)](_0x1c05c3);this[_0x12fc03(0x17c)](_0x594243)&&await this[_0x12fc03(0x160)](),this[_0x12fc03(0x154)]+=_0x594243,await this[_0x12fc03(0x195)](_0x14e24c,_0x1c05c3),this[_0x12fc03(0x18e)](_0x5756b0,_0x40908c),_0x40dd22();}catch(_0x53d864){_0x40dd22(_0x53d864);}}async[a327_0x33772b(0x18c)](_0x5c38ae){const _0x955767=a327_0x33772b;try{this[_0x955767(0x15a)]['records'][_0x955767(0x172)]&&this[_0x955767(0x151)]['length']&&await this[_0x955767(0x160)](),this['logger'][_0x955767(0x161)](_0x955767(0x188)+this[_0x955767(0x19d)]+_0x955767(0x14c)),await this[_0x955767(0x168)][_0x955767(0x175)](),_0x5c38ae();}catch(_0x3029ed){_0x5c38ae(_0x3029ed);}}}exports[a327_0x33772b(0x199)]=ComponentsDeployer;