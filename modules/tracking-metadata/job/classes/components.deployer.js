function a340_0xd444(){const _0x11bf89=['222936iyqPrz','update','RestSimpleDeployData','Name__c','16OUqAEf','Too\x20Large','Is_Retrieved__c','populateAttachmentId','OrganisationName__c','jszip','ComponentsDeployer','has','Label__c','orgComponentsToDeployChunk','Last_Updated_By__c','attachmentsToDeployChunk','createZip','Status__c','isNameObsolete','Is_Deleted__c','_final','Attachment_ID__c','_write','deployOrgComponents','@flosum/salesforce','sourceMemberId','655824ihtfxA','resetChunks','push','apiVersion','successDeployedCounter','binary','trackingSettingId','instance','file','__esModule','ATTACHMENT_OBJECT_NAME','constructor','6940683cOzydV','then','8NyuXpA','revisionCounter','MAX_BODY_SIZE','2331483pDdjie','Retrieved','fullName','binaryRecordsSizeChunk','4403510NIDGtw','logger','\x20components','type','deploy','62CDPxIj','search','apply','componentId','5725013aoCPwC','handleDeployResult','addOrgComponentToChunk','Folder__c','application/zip','Source_Member_Id__c','targetOrgId','deployAttachments','ORG_COMPONENT_OBJECT_NAME','execute','nodebuffer','15PyHhcQ','toString','(((.+)+)+)+$','BINARY_FIELD_NAME','CompositeConstants','addAttachmentToChunk','FLOSUM_NAMESPACE','length','attachmentId','records','default','../../constants','35214dOzhVe','__importDefault','Revision_Counter__c','Tracking_Setting__c','isReachedMaxChunk'];a340_0xd444=function(){return _0x11bf89;};return a340_0xd444();}const a340_0x2d6fc8=a340_0x4347;(function(_0x2b4341,_0x26a79c){const _0xfb834e=a340_0x4347,_0x4867f1=_0x2b4341();while(!![]){try{const _0x1a69ad=-parseInt(_0xfb834e(0x18e))/0x1*(-parseInt(_0xfb834e(0x155))/0x2)+-parseInt(_0xfb834e(0x174))/0x3*(parseInt(_0xfb834e(0x15e))/0x4)+-parseInt(_0xfb834e(0x19d))/0x5*(-parseInt(_0xfb834e(0x15a))/0x6)+parseInt(_0xfb834e(0x192))/0x7+parseInt(_0xfb834e(0x182))/0x8*(-parseInt(_0xfb834e(0x180))/0x9)+parseInt(_0xfb834e(0x189))/0xa+-parseInt(_0xfb834e(0x185))/0xb;if(_0x1a69ad===_0x26a79c)break;else _0x4867f1['push'](_0x4867f1['shift']());}catch(_0x2fe489){_0x4867f1['push'](_0x4867f1['shift']());}}}(a340_0xd444,0x9365c));const a340_0x142451=(function(){let _0x230473=!![];return function(_0x783375,_0x34ffd5){const _0x133373=_0x230473?function(){const _0x768ae=a340_0x4347;if(_0x34ffd5){const _0x24ebe4=_0x34ffd5[_0x768ae(0x190)](_0x783375,arguments);return _0x34ffd5=null,_0x24ebe4;}}:function(){};return _0x230473=![],_0x133373;};}()),a340_0x3d88a9=a340_0x142451(this,function(){const _0x5c2e73=a340_0x4347;return a340_0x3d88a9[_0x5c2e73(0x19e)]()[_0x5c2e73(0x18f)](_0x5c2e73(0x19f))[_0x5c2e73(0x19e)]()[_0x5c2e73(0x17f)](a340_0x3d88a9)['search'](_0x5c2e73(0x19f));});a340_0x3d88a9();'use strict';function a340_0x4347(_0x1817ed,_0x35f214){const _0x34bfaf=a340_0xd444();return a340_0x4347=function(_0x3d88a9,_0x142451){_0x3d88a9=_0x3d88a9-0x14f;let _0xd44466=_0x34bfaf[_0x3d88a9];return _0xd44466;},a340_0x4347(_0x1817ed,_0x35f214);}var __importDefault=this&&this[a340_0x2d6fc8(0x156)]||function(_0x3af90e){return _0x3af90e&&_0x3af90e['__esModule']?_0x3af90e:{'default':_0x3af90e};};Object['defineProperty'](exports,a340_0x2d6fc8(0x17d),{'value':!![]}),exports[a340_0x2d6fc8(0x164)]=void 0x0;const salesforce_1=require(a340_0x2d6fc8(0x172)),constants_1=require(a340_0x2d6fc8(0x154)),stream_1=require('stream'),jszip_1=__importDefault(require(a340_0x2d6fc8(0x163))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,MAX_SINGLE_FILE_SIZE=0x5a06e0,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a340_0x2d6fc8(0x14f)]+a340_0x2d6fc8(0x16f),CONTENT_TYPE=a340_0x2d6fc8(0x196);class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x5d0491,instance:_0x439d2d,logger:_0x2e380e,targetOrgId:_0xc28ba6,trackingSettingId:_0x10b7a4}){const _0x4e6536=a340_0x2d6fc8;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x4e6536(0x167)]=[],this['successDeployedCounter']=0x0,this[_0x4e6536(0x177)]=_0x5d0491,this[_0x4e6536(0x17b)]=_0x439d2d,this[_0x4e6536(0x18a)]=_0x2e380e,this['targetOrgId']=_0xc28ba6,this[_0x4e6536(0x17a)]=_0x10b7a4;}async['deploy'](){const _0x53555e=a340_0x2d6fc8;await this[_0x53555e(0x199)]()['then'](_0x589b5f=>this[_0x53555e(0x161)](_0x589b5f))['then'](()=>this[_0x53555e(0x171)]())[_0x53555e(0x181)](_0x12a2d9=>this[_0x53555e(0x193)](_0x12a2d9)),this[_0x53555e(0x175)]();}[a340_0x2d6fc8(0x199)](){const _0x55371b=a340_0x2d6fc8,_0x1a5bf4=new salesforce_1['CompositeBinaryDeployData']({'instance':this[_0x55371b(0x17b)],'objectName':constants_1[_0x55371b(0x17e)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x55371b(0x177)]});return _0x1a5bf4[_0x55371b(0x19b)](this['attachmentsToDeployChunk']);}['deployOrgComponents'](){const _0x465c20=a340_0x2d6fc8,_0x192f21=new salesforce_1[(_0x465c20(0x15c))]({'instance':this[_0x465c20(0x17b)],'objectName':constants_1[_0x465c20(0x19a)],'api':this[_0x465c20(0x177)],'allOrNone':![],'externalIdField':'Id'});return _0x192f21[_0x465c20(0x19b)]({'records':this[_0x465c20(0x167)]});}async[a340_0x2d6fc8(0x193)](_0x2c1724){const _0x172123=a340_0x2d6fc8;for(const {success:_0x2d19b0,error:_0x42808e}of _0x2c1724){if(_0x2d19b0){this[_0x172123(0x178)]++;continue;}_0x42808e&&this['logger']['error'](_0x42808e);}}[a340_0x2d6fc8(0x159)](_0xf26aee){const _0x5833d9=a340_0x2d6fc8;return _0xf26aee+this[_0x5833d9(0x188)]>=salesforce_1[_0x5833d9(0x1a1)][_0x5833d9(0x184)]||this[_0x5833d9(0x169)]['records'][_0x5833d9(0x150)]===MAX_COMPOSITE_CHUNK_COUNT;}[a340_0x2d6fc8(0x175)](){const _0xbe789f=a340_0x2d6fc8;this[_0xbe789f(0x188)]=0x0,this[_0xbe789f(0x169)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a340_0x2d6fc8(0x161)](_0xe71947){const _0x19a85a=a340_0x2d6fc8;for(const _0x1fbec1 in _0xe71947){this[_0x19a85a(0x167)][_0x1fbec1][ATTACHMENT_FIELD_NAME]=_0xe71947[_0x1fbec1]['id'];}}async['addAttachmentToChunk'](_0xb63f0c,_0x4c18d0){const _0x4d7ebb=a340_0x2d6fc8,{listMetadataItem:_0x18c0f3,sourceMemberRecord:_0x2c2ec2}=_0xb63f0c,_0x4ad7c3={'attributes':{'type':constants_1[_0x4d7ebb(0x17e)],'binaryPartName':_0x18c0f3['fullName'],'binaryPartNameAlias':constants_1[_0x4d7ebb(0x1a0)]},'Id':_0x2c2ec2[_0x4d7ebb(0x151)],'Name':_0x18c0f3['fullName'],'Description':_0x18c0f3['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x4d7ebb(0x198)],'Body':_0x18c0f3[_0x4d7ebb(0x187)]},_0x4c3512={'binaryFieldName':constants_1[_0x4d7ebb(0x1a0)],'name':_0x18c0f3['fullName'],'value':stream_1['Readable']['from'](_0x4c18d0)};this[_0x4d7ebb(0x169)][_0x4d7ebb(0x152)]['push'](_0x4ad7c3),this[_0x4d7ebb(0x169)][_0x4d7ebb(0x179)][_0x4d7ebb(0x176)](_0x4c3512);}[a340_0x2d6fc8(0x16a)](_0x6de2c){const _0x218d5e=a340_0x2d6fc8,_0x323017=new jszip_1[(_0x218d5e(0x153))]();for(const _0x535839 in _0x6de2c){_0x323017[_0x218d5e(0x17c)](_0x535839,_0x6de2c[_0x535839]);}return _0x323017['generateAsync']({'type':_0x218d5e(0x19c)});}[a340_0x2d6fc8(0x194)](_0x510ba8,_0x5dddb0,_0xa664fe){const _0x46e3d1=a340_0x2d6fc8,_0x114882={'attributes':{'type':constants_1[_0x46e3d1(0x19a)]},'Id':_0x5dddb0[_0x46e3d1(0x191)],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x16d)]:_0x5dddb0[_0x46e3d1(0x16c)],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x157)]:_0x5dddb0[_0x46e3d1(0x183)],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x197)]:_0x5dddb0[_0x46e3d1(0x173)],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x168)]:_0x5dddb0['changedBy'],[constants_2[_0x46e3d1(0x14f)]+'API_Name__c']:_0x510ba8[_0x46e3d1(0x187)],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x15d)]:_0x510ba8[_0x46e3d1(0x187)],[constants_2[_0x46e3d1(0x14f)]+'Component_Type__c']:_0x510ba8[_0x46e3d1(0x18c)],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x166)]:_0x510ba8['fileName'],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x195)]:constants_1['METADATA_FOLDER_MAP'][_0x46e3d1(0x165)](_0x510ba8['type'])||null,[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x160)]:!![],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x162)]:this['targetOrgId'],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x158)]:this['trackingSettingId'],[constants_2[_0x46e3d1(0x14f)]+_0x46e3d1(0x16b)]:_0xa664fe>MAX_SINGLE_FILE_SIZE?_0x46e3d1(0x15f):_0x46e3d1(0x186)};_0xa664fe>MAX_SINGLE_FILE_SIZE&&this[_0x46e3d1(0x18a)]['log']('Component\x20too\x20large.\x20Type:\x20'+_0x510ba8[_0x46e3d1(0x18c)]+',\x20Name:\x20'+_0x510ba8['fullName']),this[_0x46e3d1(0x167)][_0x46e3d1(0x176)](_0x114882);}async[a340_0x2d6fc8(0x170)](_0x61d674,_0x21f59d,_0x4d32f2){const _0x2d62c7=a340_0x2d6fc8;try{const {listMetadataItem:_0xa5849d,sourceMemberRecord:_0x18737b,files:_0x14f917}=_0x61d674,_0x35df2e=await this['createZip'](_0x14f917),_0x1356f6=Buffer['byteLength'](_0x35df2e);this[_0x2d62c7(0x159)](_0x1356f6)&&await this[_0x2d62c7(0x18d)](),this[_0x2d62c7(0x188)]+=_0x1356f6,await this[_0x2d62c7(0x1a2)](_0x61d674,_0x35df2e),this[_0x2d62c7(0x194)](_0xa5849d,_0x18737b,_0x35df2e['length']),_0x4d32f2();}catch(_0xe80e45){_0x4d32f2(_0xe80e45);}}async[a340_0x2d6fc8(0x16e)](_0x2e4c77){const _0x9c4de0=a340_0x2d6fc8;try{this[_0x9c4de0(0x169)][_0x9c4de0(0x152)]['length']&&this['orgComponentsToDeployChunk'][_0x9c4de0(0x150)]&&await this['deploy'](),this[_0x9c4de0(0x18a)]['log']('Process\x20completed\x20for\x20'+this['successDeployedCounter']+_0x9c4de0(0x18b)),await this['logger'][_0x9c4de0(0x15b)](),_0x2e4c77();}catch(_0x3788bd){_0x2e4c77(_0x3788bd);}}}exports[a340_0x2d6fc8(0x164)]=ComponentsDeployer;