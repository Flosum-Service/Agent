const a295_0x338306=a295_0x5896;(function(_0x595de5,_0x513eb1){const _0x1d3e88=a295_0x5896,_0x50f41c=_0x595de5();while(!![]){try{const _0xb901b4=parseInt(_0x1d3e88(0x10f))/0x1+parseInt(_0x1d3e88(0xf1))/0x2+-parseInt(_0x1d3e88(0x125))/0x3*(-parseInt(_0x1d3e88(0x111))/0x4)+parseInt(_0x1d3e88(0x112))/0x5+-parseInt(_0x1d3e88(0x120))/0x6*(-parseInt(_0x1d3e88(0x12b))/0x7)+-parseInt(_0x1d3e88(0xf0))/0x8*(parseInt(_0x1d3e88(0xf4))/0x9)+-parseInt(_0x1d3e88(0xf6))/0xa;if(_0xb901b4===_0x513eb1)break;else _0x50f41c['push'](_0x50f41c['shift']());}catch(_0x17906d){_0x50f41c['push'](_0x50f41c['shift']());}}}(a295_0x53ab,0x224b9));const a295_0x4fc538=(function(){let _0xd6d5df=!![];return function(_0x2ef171,_0xf2b2fa){const _0x51ac57=_0xd6d5df?function(){const _0x588451=a295_0x5896;if(_0xf2b2fa){const _0x46a36f=_0xf2b2fa[_0x588451(0x10b)](_0x2ef171,arguments);return _0xf2b2fa=null,_0x46a36f;}}:function(){};return _0xd6d5df=![],_0x51ac57;};}()),a295_0x3fd0d0=a295_0x4fc538(this,function(){const _0x2d052a=a295_0x5896;return a295_0x3fd0d0[_0x2d052a(0x130)]()[_0x2d052a(0x11b)]('(((.+)+)+)+$')['toString']()['constructor'](a295_0x3fd0d0)[_0x2d052a(0x11b)](_0x2d052a(0x100));});a295_0x3fd0d0();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x272fad){return _0x272fad&&_0x272fad['__esModule']?_0x272fad:{'default':_0x272fad};};Object[a295_0x338306(0x116)](exports,a295_0x338306(0x127),{'value':!![]}),exports['ComponentsDeployer']=void 0x0;function a295_0x53ab(){const _0x15bf99=['update','5559930PunneD','addAttachmentToChunk','successDeployedCounter','ATTACHMENT_OBJECT_NAME','instance','has','attachmentId','Source_Member_Id__c','Revision_Counter__c','_final','(((.+)+)+)+$','file','METADATA_FOLDER_MAP','fullName','../../constants','sourceMemberId','_write','changedBy','generateAsync','length','binaryRecordsSizeChunk','apply','@flosum/salesforce','deploy','isReachedMaxChunk','24258IggGvV','error','244jcrzMj','1080110UcLaXm','targetOrgId','execute','CompositeBinaryDeployData','defineProperty','../../../../constants','Is_Retrieved__c','application/zip','Last_Updated_By__c','search','handleDeployResult','then','log','\x20components','6RcxIoH','Readable','trackingSettingId','Component_Type__c','deployOrgComponents','13101NUxevh','Retrieved','__esModule','stream','type','Attachment_ID__c','1377649qJhDRI','Folder__c','addOrgComponentToChunk','deployAttachments','Name__c','toString','BINARY_FIELD_NAME','binary','createZip','from','apiVersion','resetChunks','default','records','Label__c','CompositeConstants','API_Name__c','orgComponentsToDeployChunk','logger','FLOSUM_NAMESPACE','revisionCounter','componentId','push','MAX_BODY_SIZE','attachmentsToDeployChunk','fileName','1048816Qcgiid','510392FPIKay','ComponentsDeployer','isNameObsolete','18QugIBx'];a295_0x53ab=function(){return _0x15bf99;};return a295_0x53ab();}const salesforce_1=require(a295_0x338306(0x10c)),constants_1=require(a295_0x338306(0x104)),stream_1=require(a295_0x338306(0x128)),jszip_1=__importDefault(require('jszip')),constants_2=require(a295_0x338306(0x117)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a295_0x338306(0xe9)]+a295_0x338306(0x12a),CONTENT_TYPE=a295_0x338306(0x119);function a295_0x5896(_0x54ee55,_0x460468){const _0x3243ac=a295_0x53ab();return a295_0x5896=function(_0x3fd0d0,_0x4fc538){_0x3fd0d0=_0x3fd0d0-0xe2;let _0x53ab60=_0x3243ac[_0x3fd0d0];return _0x53ab60;},a295_0x5896(_0x54ee55,_0x460468);}class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x567677,instance:_0x3ec2c1,logger:_0x4d4b57,targetOrgId:_0x363802,trackingSettingId:_0x37d7e3}){const _0x51c13f=a295_0x338306;super({'objectMode':!![]}),this[_0x51c13f(0xee)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x51c13f(0xe7)]=[],this['successDeployedCounter']=0x0,this[_0x51c13f(0x135)]=_0x567677,this[_0x51c13f(0xfa)]=_0x3ec2c1,this[_0x51c13f(0xe8)]=_0x4d4b57,this[_0x51c13f(0x113)]=_0x363802,this['trackingSettingId']=_0x37d7e3;}async['deploy'](){const _0x3599f8=a295_0x338306;await this[_0x3599f8(0x12e)]()[_0x3599f8(0x11d)](_0xe26baa=>this['populateAttachmentId'](_0xe26baa))['then'](()=>this[_0x3599f8(0x124)]())[_0x3599f8(0x11d)](_0x4e9c85=>this[_0x3599f8(0x11c)](_0x4e9c85)),this['resetChunks']();}[a295_0x338306(0x12e)](){const _0x511239=a295_0x338306,_0x10006c=new salesforce_1[(_0x511239(0x115))]({'instance':this[_0x511239(0xfa)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x511239(0x135)]});return _0x10006c[_0x511239(0x114)](this[_0x511239(0xee)]);}[a295_0x338306(0x124)](){const _0x3f9ec4=a295_0x338306,_0x3b8bd0=new salesforce_1['RestSimpleDeployData']({'instance':this[_0x3f9ec4(0xfa)],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this[_0x3f9ec4(0x135)],'allOrNone':![],'externalIdField':'Id'});return _0x3b8bd0[_0x3f9ec4(0x114)]({'records':this[_0x3f9ec4(0xe7)]});}async[a295_0x338306(0x11c)](_0x581568){const _0x1b13fc=a295_0x338306;for(const {success:_0xc5ac36,error:_0xe74320}of _0x581568){if(_0xc5ac36){this['successDeployedCounter']++;continue;}_0xe74320&&this[_0x1b13fc(0xe8)][_0x1b13fc(0x110)](_0xe74320);}}['isReachedMaxChunk'](_0x1a06fd){const _0x1f850b=a295_0x338306;return _0x1a06fd+this['binaryRecordsSizeChunk']>=salesforce_1[_0x1f850b(0xe5)][_0x1f850b(0xed)]||this[_0x1f850b(0xee)][_0x1f850b(0xe3)]['length']===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x338306(0x136)](){const _0x5965c0=a295_0x338306;this[_0x5965c0(0x10a)]=0x0,this[_0x5965c0(0xee)]={'records':[],'binary':[]},this[_0x5965c0(0xe7)]=[];}['populateAttachmentId'](_0x317467){const _0xe0a0c0=a295_0x338306;for(const _0x17d0f4 in _0x317467){this[_0xe0a0c0(0xe7)][_0x17d0f4][ATTACHMENT_FIELD_NAME]=_0x317467[_0x17d0f4]['id'];}}async[a295_0x338306(0xf7)](_0x5b9c3c,_0x2dccac){const _0x39459b=a295_0x338306,{listMetadataItem:_0x5c1f05,sourceMemberRecord:_0x474314}=_0x5b9c3c,_0x5bf2d6={'attributes':{'type':constants_1[_0x39459b(0xf9)],'binaryPartName':_0x5c1f05[_0x39459b(0x103)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x474314[_0x39459b(0xfc)],'Name':_0x5c1f05[_0x39459b(0x103)],'Description':_0x5c1f05[_0x39459b(0x129)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x39459b(0x113)],'Body':_0x5c1f05[_0x39459b(0x103)]},_0x42534a={'binaryFieldName':constants_1[_0x39459b(0x131)],'name':_0x5c1f05[_0x39459b(0x103)],'value':stream_1[_0x39459b(0x121)][_0x39459b(0x134)](_0x2dccac)};this[_0x39459b(0xee)][_0x39459b(0xe3)][_0x39459b(0xec)](_0x5bf2d6),this[_0x39459b(0xee)][_0x39459b(0x132)][_0x39459b(0xec)](_0x42534a);}[a295_0x338306(0x133)](_0x526837){const _0x37f6f6=a295_0x338306,_0x32fcd6=new jszip_1[(_0x37f6f6(0xe2))]();for(const _0x115d1e in _0x526837){_0x32fcd6[_0x37f6f6(0x101)](_0x115d1e,_0x526837[_0x115d1e]);}return _0x32fcd6[_0x37f6f6(0x108)]({'type':'nodebuffer'});}[a295_0x338306(0x12d)](_0x206ef5,_0x6e5e00){const _0x30769b=a295_0x338306,_0x1a091f={'attributes':{'type':constants_1['ORG_COMPONENT_OBJECT_NAME']},'Id':_0x6e5e00[_0x30769b(0xeb)],[constants_2[_0x30769b(0xe9)]+'Is_Deleted__c']:_0x6e5e00[_0x30769b(0xf3)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0xfe)]:_0x6e5e00[_0x30769b(0xea)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0xfd)]:_0x6e5e00[_0x30769b(0x105)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0x11a)]:_0x6e5e00[_0x30769b(0x107)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0xe6)]:_0x206ef5[_0x30769b(0x103)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0x12f)]:_0x206ef5[_0x30769b(0x103)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0x123)]:_0x206ef5[_0x30769b(0x129)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0xe4)]:_0x206ef5[_0x30769b(0xef)],[constants_2[_0x30769b(0xe9)]+_0x30769b(0x12c)]:constants_1[_0x30769b(0x102)][_0x30769b(0xfb)](_0x206ef5[_0x30769b(0x129)])||null,[constants_2[_0x30769b(0xe9)]+_0x30769b(0x118)]:!![],[constants_2[_0x30769b(0xe9)]+'OrganisationName__c']:this[_0x30769b(0x113)],[constants_2[_0x30769b(0xe9)]+'Tracking_Setting__c']:this[_0x30769b(0x122)],[constants_2[_0x30769b(0xe9)]+'Status__c']:_0x30769b(0x126)};this[_0x30769b(0xe7)]['push'](_0x1a091f);}async[a295_0x338306(0x106)](_0x842fca,_0x21345f,_0x51fa6a){const _0x57ce62=a295_0x338306;try{const {listMetadataItem:_0x21b1b0,sourceMemberRecord:_0x405833,files:_0x8f1bac}=_0x842fca,_0x1e95a7=await this[_0x57ce62(0x133)](_0x8f1bac),_0xfcde21=Buffer['byteLength'](_0x1e95a7);this[_0x57ce62(0x10e)](_0xfcde21)&&await this[_0x57ce62(0x10d)](),this['binaryRecordsSizeChunk']+=_0xfcde21,await this[_0x57ce62(0xf7)](_0x842fca,_0x1e95a7),this[_0x57ce62(0x12d)](_0x21b1b0,_0x405833),_0x51fa6a();}catch(_0x5124d2){_0x51fa6a(_0x5124d2);}}async[a295_0x338306(0xff)](_0x57b142){const _0x7c70f6=a295_0x338306;try{this[_0x7c70f6(0xee)]['records'][_0x7c70f6(0x109)]&&this[_0x7c70f6(0xe7)][_0x7c70f6(0x109)]&&await this[_0x7c70f6(0x10d)](),this[_0x7c70f6(0xe8)][_0x7c70f6(0x11e)]('Process\x20completed\x20for\x20'+this[_0x7c70f6(0xf8)]+_0x7c70f6(0x11f)),await this[_0x7c70f6(0xe8)][_0x7c70f6(0xf5)](),_0x57b142();}catch(_0x1f8811){_0x57b142(_0x1f8811);}}}exports[a295_0x338306(0xf2)]=ComponentsDeployer;