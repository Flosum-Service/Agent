const a311_0x4cc3a6=a311_0x6a44;(function(_0xc590d1,_0x4a43ab){const _0x52391b=a311_0x6a44,_0x350328=_0xc590d1();while(!![]){try{const _0x5de473=parseInt(_0x52391b(0x15a))/0x1*(-parseInt(_0x52391b(0x125))/0x2)+parseInt(_0x52391b(0x124))/0x3*(parseInt(_0x52391b(0x13f))/0x4)+parseInt(_0x52391b(0x129))/0x5+parseInt(_0x52391b(0x130))/0x6+parseInt(_0x52391b(0x128))/0x7*(-parseInt(_0x52391b(0x150))/0x8)+-parseInt(_0x52391b(0x148))/0x9*(-parseInt(_0x52391b(0x154))/0xa)+-parseInt(_0x52391b(0x160))/0xb*(-parseInt(_0x52391b(0x158))/0xc);if(_0x5de473===_0x4a43ab)break;else _0x350328['push'](_0x350328['shift']());}catch(_0xaa53c5){_0x350328['push'](_0x350328['shift']());}}}(a311_0x16fc,0x35c2b));function a311_0x6a44(_0x4bf18a,_0xffa7b4){const _0x4c7a51=a311_0x16fc();return a311_0x6a44=function(_0x8cf74a,_0x19ca1b){_0x8cf74a=_0x8cf74a-0x10b;let _0x16fceb=_0x4c7a51[_0x8cf74a];return _0x16fceb;},a311_0x6a44(_0x4bf18a,_0xffa7b4);}const a311_0x19ca1b=(function(){let _0x2b68a1=!![];return function(_0x2692f5,_0x3bc33f){const _0x320b3c=_0x2b68a1?function(){const _0x44223e=a311_0x6a44;if(_0x3bc33f){const _0x3e8d4a=_0x3bc33f[_0x44223e(0x14c)](_0x2692f5,arguments);return _0x3bc33f=null,_0x3e8d4a;}}:function(){};return _0x2b68a1=![],_0x320b3c;};}()),a311_0x8cf74a=a311_0x19ca1b(this,function(){const _0x23dc85=a311_0x6a44;return a311_0x8cf74a[_0x23dc85(0x11f)]()[_0x23dc85(0x117)](_0x23dc85(0x110))[_0x23dc85(0x11f)]()[_0x23dc85(0x146)](a311_0x8cf74a)['search'](_0x23dc85(0x110));});a311_0x8cf74a();'use strict';var __importDefault=this&&this[a311_0x4cc3a6(0x11e)]||function(_0x4ef45f){const _0x395f8b=a311_0x4cc3a6;return _0x4ef45f&&_0x4ef45f[_0x395f8b(0x12c)]?_0x4ef45f:{'default':_0x4ef45f};};Object[a311_0x4cc3a6(0x126)](exports,'__esModule',{'value':!![]}),exports[a311_0x4cc3a6(0x12a)]=void 0x0;const salesforce_1=require(a311_0x4cc3a6(0x115)),constants_1=require(a311_0x4cc3a6(0x11d)),stream_1=require(a311_0x4cc3a6(0x135)),jszip_1=__importDefault(require(a311_0x4cc3a6(0x151))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a311_0x4cc3a6(0x13a)]+a311_0x4cc3a6(0x13d),CONTENT_TYPE=a311_0x4cc3a6(0x112);class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x1ec9c1,instance:_0xebe8d4,logger:_0x2b60de,targetOrgId:_0x4c97fe,trackingSettingId:_0x3fcfd2}){const _0x494a9a=a311_0x4cc3a6;super({'objectMode':!![]}),this[_0x494a9a(0x139)]={'records':[],'binary':[]},this[_0x494a9a(0x15b)]=0x0,this[_0x494a9a(0x133)]=[],this['successDeployedCounter']=0x0,this[_0x494a9a(0x162)]=_0x1ec9c1,this['instance']=_0xebe8d4,this['logger']=_0x2b60de,this[_0x494a9a(0x12e)]=_0x4c97fe,this[_0x494a9a(0x143)]=_0x3fcfd2;}async[a311_0x4cc3a6(0x10b)](){const _0x1aa622=a311_0x4cc3a6;await this[_0x1aa622(0x127)]()[_0x1aa622(0x122)](_0xc005f7=>this['populateAttachmentId'](_0xc005f7))['then'](()=>this[_0x1aa622(0x156)]())['then'](_0x416a32=>this[_0x1aa622(0x137)](_0x416a32)),this['resetChunks']();}[a311_0x4cc3a6(0x127)](){const _0x374d39=a311_0x4cc3a6,_0x15249f=new salesforce_1['CompositeBinaryDeployData']({'instance':this['instance'],'objectName':constants_1[_0x374d39(0x141)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x15249f[_0x374d39(0x10e)](this[_0x374d39(0x139)]);}[a311_0x4cc3a6(0x156)](){const _0x4cf516=a311_0x4cc3a6,_0x4ddd5b=new salesforce_1[(_0x4cf516(0x12f))]({'instance':this[_0x4cf516(0x15e)],'objectName':constants_1[_0x4cf516(0x142)],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0x4ddd5b[_0x4cf516(0x10e)]({'records':this[_0x4cf516(0x133)]});}async[a311_0x4cc3a6(0x137)](_0x455170){const _0x155fd9=a311_0x4cc3a6;for(const {success:_0x154541,error:_0x1ff5ad}of _0x455170){if(_0x154541){this['successDeployedCounter']++;continue;}_0x1ff5ad&&this['logger'][_0x155fd9(0x149)](_0x1ff5ad);}}[a311_0x4cc3a6(0x140)](_0x50239e){const _0x103acd=a311_0x4cc3a6;return _0x50239e+this['binaryRecordsSizeChunk']>=salesforce_1['CompositeConstants'][_0x103acd(0x157)]||this[_0x103acd(0x139)][_0x103acd(0x12d)][_0x103acd(0x147)]===MAX_COMPOSITE_CHUNK_COUNT;}[a311_0x4cc3a6(0x132)](){const _0x4c156b=a311_0x4cc3a6;this['binaryRecordsSizeChunk']=0x0,this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x4c156b(0x133)]=[];}[a311_0x4cc3a6(0x15c)](_0x61bea0){const _0x37ac56=a311_0x4cc3a6;for(const _0x9ffc8a in _0x61bea0){this[_0x37ac56(0x133)][_0x9ffc8a][ATTACHMENT_FIELD_NAME]=_0x61bea0[_0x9ffc8a]['id'];}}async['addAttachmentToChunk'](_0x24eae2,_0x13c313){const _0x3503d5=a311_0x4cc3a6,{listMetadataItem:_0xfd79fe,sourceMemberRecord:_0x235aa5}=_0x24eae2,_0x34f5c5={'attributes':{'type':constants_1[_0x3503d5(0x141)],'binaryPartName':_0xfd79fe[_0x3503d5(0x144)],'binaryPartNameAlias':constants_1[_0x3503d5(0x118)]},'Id':_0x235aa5[_0x3503d5(0x113)],'Name':_0xfd79fe['fullName'],'Description':_0xfd79fe[_0x3503d5(0x123)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x3503d5(0x12e)],'Body':_0xfd79fe[_0x3503d5(0x144)]},_0x39e08e={'binaryFieldName':constants_1[_0x3503d5(0x118)],'name':_0xfd79fe[_0x3503d5(0x144)],'value':stream_1[_0x3503d5(0x119)]['from'](_0x13c313)};this['attachmentsToDeployChunk'][_0x3503d5(0x12d)][_0x3503d5(0x14a)](_0x34f5c5),this[_0x3503d5(0x139)][_0x3503d5(0x14d)][_0x3503d5(0x14a)](_0x39e08e);}[a311_0x4cc3a6(0x10f)](_0x217fd8){const _0x1cee28=a311_0x4cc3a6,_0x2dce6b=new jszip_1[(_0x1cee28(0x163))]();for(const _0x2613bb in _0x217fd8){_0x2dce6b[_0x1cee28(0x14e)](_0x2613bb,_0x217fd8[_0x2613bb]);}return _0x2dce6b[_0x1cee28(0x145)]({'type':_0x1cee28(0x15d)});}[a311_0x4cc3a6(0x11a)](_0x2912c1,_0x471b6c){const _0x204510=a311_0x4cc3a6,_0x4e2397={'attributes':{'type':constants_1[_0x204510(0x142)]},'Id':_0x471b6c[_0x204510(0x10d)],[constants_2[_0x204510(0x13a)]+'Is_Deleted__c']:_0x471b6c[_0x204510(0x15f)],[constants_2['FLOSUM_NAMESPACE']+_0x204510(0x13e)]:_0x471b6c[_0x204510(0x120)],[constants_2[_0x204510(0x13a)]+_0x204510(0x136)]:_0x471b6c[_0x204510(0x14b)],[constants_2[_0x204510(0x13a)]+_0x204510(0x111)]:_0x471b6c[_0x204510(0x164)],[constants_2[_0x204510(0x13a)]+_0x204510(0x134)]:_0x2912c1[_0x204510(0x144)],[constants_2[_0x204510(0x13a)]+'Name__c']:_0x2912c1['fullName'],[constants_2[_0x204510(0x13a)]+_0x204510(0x153)]:_0x2912c1[_0x204510(0x123)],[constants_2[_0x204510(0x13a)]+_0x204510(0x13b)]:_0x2912c1[_0x204510(0x161)],[constants_2[_0x204510(0x13a)]+'Folder__c']:constants_1['METADATA_FOLDER_MAP'][_0x204510(0x114)](_0x2912c1[_0x204510(0x123)])||null,[constants_2['FLOSUM_NAMESPACE']+_0x204510(0x13c)]:!![],[constants_2[_0x204510(0x13a)]+'OrganisationName__c']:this[_0x204510(0x12e)],[constants_2['FLOSUM_NAMESPACE']+_0x204510(0x14f)]:this['trackingSettingId'],[constants_2[_0x204510(0x13a)]+_0x204510(0x12b)]:_0x204510(0x138)};this[_0x204510(0x133)][_0x204510(0x14a)](_0x4e2397);}async[a311_0x4cc3a6(0x116)](_0x5dfc33,_0x3c04fc,_0x2ed3f7){const _0x402a1a=a311_0x4cc3a6;try{const {listMetadataItem:_0x4e3241,sourceMemberRecord:_0x7798d5,files:_0x2b8067}=_0x5dfc33,_0x3ce7ae=await this[_0x402a1a(0x10f)](_0x2b8067),_0xe6a8b=Buffer[_0x402a1a(0x131)](_0x3ce7ae);this[_0x402a1a(0x140)](_0xe6a8b)&&await this[_0x402a1a(0x10b)](),this['binaryRecordsSizeChunk']+=_0xe6a8b,await this[_0x402a1a(0x159)](_0x5dfc33,_0x3ce7ae),this[_0x402a1a(0x11a)](_0x4e3241,_0x7798d5),_0x2ed3f7();}catch(_0x40f2ab){_0x2ed3f7(_0x40f2ab);}}async[a311_0x4cc3a6(0x11c)](_0x47347d){const _0x333fd8=a311_0x4cc3a6;try{this[_0x333fd8(0x139)][_0x333fd8(0x12d)][_0x333fd8(0x147)]&&this['orgComponentsToDeployChunk'][_0x333fd8(0x147)]&&await this[_0x333fd8(0x10b)](),this[_0x333fd8(0x121)][_0x333fd8(0x11b)](_0x333fd8(0x152)+this[_0x333fd8(0x10c)]+_0x333fd8(0x155)),await this['logger']['update'](),_0x47347d();}catch(_0x44a785){_0x47347d(_0x44a785);}}}exports[a311_0x4cc3a6(0x12a)]=ComponentsDeployer;function a311_0x16fc(){const _0xce9181=['attachmentsToDeployChunk','FLOSUM_NAMESPACE','Label__c','Is_Retrieved__c','Attachment_ID__c','Revision_Counter__c','12wxBhRT','isReachedMaxChunk','ATTACHMENT_OBJECT_NAME','ORG_COMPONENT_OBJECT_NAME','trackingSettingId','fullName','generateAsync','constructor','length','27lNrPCZ','error','push','sourceMemberId','apply','binary','file','Tracking_Setting__c','10376QadQIC','jszip','Process\x20completed\x20for\x20','Component_Type__c','261830QEUDLu','\x20components','deployOrgComponents','MAX_BODY_SIZE','360NBStKE','addAttachmentToChunk','29131YNkbrj','binaryRecordsSizeChunk','populateAttachmentId','nodebuffer','instance','isNameObsolete','96349WpXMBp','fileName','apiVersion','default','changedBy','deploy','successDeployedCounter','componentId','execute','createZip','(((.+)+)+)+$','Last_Updated_By__c','application/zip','attachmentId','has','@flosum/salesforce','_write','search','BINARY_FIELD_NAME','Readable','addOrgComponentToChunk','log','_final','../../constants','__importDefault','toString','revisionCounter','logger','then','type','324111tjjYoF','26xTHXCd','defineProperty','deployAttachments','1169wTVFuZ','556455Bbjekc','ComponentsDeployer','Status__c','__esModule','records','targetOrgId','RestSimpleDeployData','232704YJITrh','byteLength','resetChunks','orgComponentsToDeployChunk','API_Name__c','stream','Source_Member_Id__c','handleDeployResult','Retrieved'];a311_0x16fc=function(){return _0xce9181;};return a311_0x16fc();}