const a295_0x4d6448=a295_0xb567;(function(_0x17da7d,_0x162ded){const _0x2a2c39=a295_0xb567,_0x5b110c=_0x17da7d();while(!![]){try{const _0x3ffb2b=-parseInt(_0x2a2c39(0xae))/0x1*(-parseInt(_0x2a2c39(0x91))/0x2)+parseInt(_0x2a2c39(0x95))/0x3+parseInt(_0x2a2c39(0xe7))/0x4*(-parseInt(_0x2a2c39(0xc8))/0x5)+-parseInt(_0x2a2c39(0xbc))/0x6*(-parseInt(_0x2a2c39(0xc0))/0x7)+-parseInt(_0x2a2c39(0x93))/0x8*(parseInt(_0x2a2c39(0xd3))/0x9)+parseInt(_0x2a2c39(0x96))/0xa+parseInt(_0x2a2c39(0xe3))/0xb*(-parseInt(_0x2a2c39(0x97))/0xc);if(_0x3ffb2b===_0x162ded)break;else _0x5b110c['push'](_0x5b110c['shift']());}catch(_0x90f2a2){_0x5b110c['push'](_0x5b110c['shift']());}}}(a295_0x1caa,0xa6534));const a295_0x1db92a=(function(){let _0x400c3f=!![];return function(_0x1a3748,_0x59cd99){const _0x460851=_0x400c3f?function(){const _0x14acd3=a295_0xb567;if(_0x59cd99){const _0x2e3903=_0x59cd99[_0x14acd3(0xb7)](_0x1a3748,arguments);return _0x59cd99=null,_0x2e3903;}}:function(){};return _0x400c3f=![],_0x460851;};}()),a295_0x4da52f=a295_0x1db92a(this,function(){const _0x1500e3=a295_0xb567;return a295_0x4da52f[_0x1500e3(0xb9)]()[_0x1500e3(0xab)](_0x1500e3(0x9b))[_0x1500e3(0xb9)]()['constructor'](a295_0x4da52f)['search']('(((.+)+)+)+$');});a295_0x4da52f();'use strict';var __importDefault=this&&this[a295_0x4d6448(0xb0)]||function(_0x4170fb){const _0xc5bdf6=a295_0x4d6448;return _0x4170fb&&_0x4170fb[_0xc5bdf6(0xc2)]?_0x4170fb:{'default':_0x4170fb};};Object[a295_0x4d6448(0xd9)](exports,a295_0x4d6448(0xc2),{'value':!![]}),exports[a295_0x4d6448(0xdf)]=void 0x0;function a295_0xb567(_0x1c15f3,_0x22f1fb){const _0x1698c8=a295_0x1caa();return a295_0xb567=function(_0x4da52f,_0x1db92a){_0x4da52f=_0x4da52f-0x91;let _0x1caab8=_0x1698c8[_0x4da52f];return _0x1caab8;},a295_0xb567(_0x1c15f3,_0x22f1fb);}const salesforce_1=require('@flosum/salesforce'),constants_1=require(a295_0x4d6448(0xc3)),stream_1=require(a295_0x4d6448(0xa2)),jszip_1=__importDefault(require(a295_0x4d6448(0x9f))),constants_2=require(a295_0x4d6448(0xaf)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a295_0x4d6448(0x9e)]+a295_0x4d6448(0xd4),CONTENT_TYPE=a295_0x4d6448(0x98);function a295_0x1caa(){const _0x39a950=['deploy','(((.+)+)+)+$','trackingSettingId','ATTACHMENT_OBJECT_NAME','FLOSUM_NAMESPACE','jszip','then','componentId','stream','Name__c','file','binary','error','_final','resetChunks','generateAsync','createZip','search','isReachedMaxChunk','BINARY_FIELD_NAME','175590EtKMng','../../../../constants','__importDefault','instance','CompositeBinaryDeployData','changedBy','logger','fileName','from','apply','API_Name__c','toString','log','execute','929886QNKWhV','handleDeployResult','sourceMemberId','binaryRecordsSizeChunk','35bjgmwv','Tracking_Setting__c','__esModule','../../constants','apiVersion','length','records','deployOrgComponents','686690vevdfG','Process\x20completed\x20for\x20','byteLength','Retrieved','orgComponentsToDeployChunk','populateAttachmentId','targetOrgId','ORG_COMPONENT_OBJECT_NAME','Component_Type__c','Writable','CompositeConstants','407529iHvWoB','Attachment_ID__c','Last_Updated_By__c','METADATA_FOLDER_MAP','default','Folder__c','defineProperty','addAttachmentToChunk','Source_Member_Id__c','RestSimpleDeployData','Label__c','Is_Retrieved__c','ComponentsDeployer','attachmentsToDeployChunk','fullName','addOrgComponentToChunk','11KUEywb','Is_Deleted__c','type','push','8IvVbuD','deployAttachments','4BMwLeK','\x20components','176WaqHRF','successDeployedCounter','3825003oFAtcn','10304830TPZJgd','17753316pNSiph','application/zip','MAX_BODY_SIZE'];a295_0x1caa=function(){return _0x39a950;};return a295_0x1caa();}class ComponentsDeployer extends stream_1[a295_0x4d6448(0xd1)]{constructor({apiVersion:_0x41986e,instance:_0x59b95a,logger:_0x30106e,targetOrgId:_0x8f513a,trackingSettingId:_0x3b9e42}){const _0xb9ba29=a295_0x4d6448;super({'objectMode':!![]}),this[_0xb9ba29(0xe0)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0xb9ba29(0xcc)]=[],this[_0xb9ba29(0x94)]=0x0,this[_0xb9ba29(0xc4)]=_0x41986e,this['instance']=_0x59b95a,this['logger']=_0x30106e,this[_0xb9ba29(0xce)]=_0x8f513a,this[_0xb9ba29(0x9c)]=_0x3b9e42;}async[a295_0x4d6448(0x9a)](){const _0x1a29b6=a295_0x4d6448;await this[_0x1a29b6(0xe8)]()['then'](_0x3f8fa1=>this[_0x1a29b6(0xcd)](_0x3f8fa1))[_0x1a29b6(0xa0)](()=>this['deployOrgComponents']())[_0x1a29b6(0xa0)](_0x2cdd81=>this[_0x1a29b6(0xbd)](_0x2cdd81)),this[_0x1a29b6(0xa8)]();}['deployAttachments'](){const _0x6ebec7=a295_0x4d6448,_0x103ad5=new salesforce_1[(_0x6ebec7(0xb2))]({'instance':this[_0x6ebec7(0xb1)],'objectName':constants_1[_0x6ebec7(0x9d)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x103ad5[_0x6ebec7(0xbb)](this[_0x6ebec7(0xe0)]);}[a295_0x4d6448(0xc7)](){const _0x4eac=a295_0x4d6448,_0x49509c=new salesforce_1[(_0x4eac(0xdc))]({'instance':this[_0x4eac(0xb1)],'objectName':constants_1[_0x4eac(0xcf)],'api':this[_0x4eac(0xc4)],'allOrNone':![],'externalIdField':'Id'});return _0x49509c[_0x4eac(0xbb)]({'records':this[_0x4eac(0xcc)]});}async[a295_0x4d6448(0xbd)](_0x958075){const _0x1e5c32=a295_0x4d6448;for(const {success:_0x3e2930,error:_0xc8d814}of _0x958075){if(_0x3e2930){this[_0x1e5c32(0x94)]++;continue;}_0xc8d814&&this[_0x1e5c32(0xb4)][_0x1e5c32(0xa6)](_0xc8d814);}}[a295_0x4d6448(0xac)](_0x461ed5){const _0x2dd7cb=a295_0x4d6448;return _0x461ed5+this[_0x2dd7cb(0xbf)]>=salesforce_1[_0x2dd7cb(0xd2)][_0x2dd7cb(0x99)]||this[_0x2dd7cb(0xe0)][_0x2dd7cb(0xc6)]['length']===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x4d6448(0xa8)](){const _0x1214ac=a295_0x4d6448;this[_0x1214ac(0xbf)]=0x0,this[_0x1214ac(0xe0)]={'records':[],'binary':[]},this[_0x1214ac(0xcc)]=[];}['populateAttachmentId'](_0x281d43){const _0x5d5176=a295_0x4d6448;for(const _0x5d7344 in _0x281d43){this[_0x5d5176(0xcc)][_0x5d7344][ATTACHMENT_FIELD_NAME]=_0x281d43[_0x5d7344]['id'];}}async[a295_0x4d6448(0xda)](_0x6f554b,_0x14a67d){const _0x232226=a295_0x4d6448,{listMetadataItem:_0x2ec234,sourceMemberRecord:_0x328e50}=_0x6f554b,_0x3d7a57={'attributes':{'type':constants_1[_0x232226(0x9d)],'binaryPartName':_0x2ec234['fullName'],'binaryPartNameAlias':constants_1[_0x232226(0xad)]},'Id':_0x328e50['attachmentId'],'Name':_0x2ec234['fullName'],'Description':_0x2ec234['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x232226(0xce)],'Body':_0x2ec234[_0x232226(0xe1)]},_0x1432fe={'binaryFieldName':constants_1[_0x232226(0xad)],'name':_0x2ec234[_0x232226(0xe1)],'value':stream_1['Readable'][_0x232226(0xb6)](_0x14a67d)};this[_0x232226(0xe0)][_0x232226(0xc6)][_0x232226(0xe6)](_0x3d7a57),this[_0x232226(0xe0)][_0x232226(0xa5)][_0x232226(0xe6)](_0x1432fe);}['createZip'](_0x424e8b){const _0x4f6655=a295_0x4d6448,_0xd72d9f=new jszip_1[(_0x4f6655(0xd7))]();for(const _0x28d0d5 in _0x424e8b){_0xd72d9f[_0x4f6655(0xa4)](_0x28d0d5,_0x424e8b[_0x28d0d5]);}return _0xd72d9f[_0x4f6655(0xa9)]({'type':'nodebuffer'});}[a295_0x4d6448(0xe2)](_0x2f6f85,_0x3456b5){const _0x3cd2e9=a295_0x4d6448,_0x30aa3b={'attributes':{'type':constants_1[_0x3cd2e9(0xcf)]},'Id':_0x3456b5[_0x3cd2e9(0xa1)],[constants_2['FLOSUM_NAMESPACE']+_0x3cd2e9(0xe4)]:_0x3456b5['isNameObsolete'],[constants_2[_0x3cd2e9(0x9e)]+'Revision_Counter__c']:_0x3456b5['revisionCounter'],[constants_2[_0x3cd2e9(0x9e)]+_0x3cd2e9(0xdb)]:_0x3456b5[_0x3cd2e9(0xbe)],[constants_2[_0x3cd2e9(0x9e)]+_0x3cd2e9(0xd5)]:_0x3456b5[_0x3cd2e9(0xb3)],[constants_2[_0x3cd2e9(0x9e)]+_0x3cd2e9(0xb8)]:_0x2f6f85[_0x3cd2e9(0xe1)],[constants_2['FLOSUM_NAMESPACE']+_0x3cd2e9(0xa3)]:_0x2f6f85[_0x3cd2e9(0xe1)],[constants_2[_0x3cd2e9(0x9e)]+_0x3cd2e9(0xd0)]:_0x2f6f85[_0x3cd2e9(0xe5)],[constants_2[_0x3cd2e9(0x9e)]+_0x3cd2e9(0xdd)]:_0x2f6f85[_0x3cd2e9(0xb5)],[constants_2[_0x3cd2e9(0x9e)]+_0x3cd2e9(0xd8)]:constants_1[_0x3cd2e9(0xd6)]['has'](_0x2f6f85[_0x3cd2e9(0xe5)])||null,[constants_2[_0x3cd2e9(0x9e)]+_0x3cd2e9(0xde)]:!![],[constants_2[_0x3cd2e9(0x9e)]+'OrganisationName__c']:this['targetOrgId'],[constants_2['FLOSUM_NAMESPACE']+_0x3cd2e9(0xc1)]:this['trackingSettingId'],[constants_2['FLOSUM_NAMESPACE']+'Status__c']:_0x3cd2e9(0xcb)};this['orgComponentsToDeployChunk'][_0x3cd2e9(0xe6)](_0x30aa3b);}async['_write'](_0x6d6e94,_0x22a144,_0x4905b8){const _0x535313=a295_0x4d6448;try{const {listMetadataItem:_0x5506ff,sourceMemberRecord:_0xa20bfa,files:_0x3fd155}=_0x6d6e94,_0x4961c7=await this[_0x535313(0xaa)](_0x3fd155),_0x25abf2=Buffer[_0x535313(0xca)](_0x4961c7);this[_0x535313(0xac)](_0x25abf2)&&await this['deploy'](),this['binaryRecordsSizeChunk']+=_0x25abf2,await this[_0x535313(0xda)](_0x6d6e94,_0x4961c7),this[_0x535313(0xe2)](_0x5506ff,_0xa20bfa),_0x4905b8();}catch(_0xa1a641){_0x4905b8(_0xa1a641);}}async[a295_0x4d6448(0xa7)](_0x2ece29){const _0x3ebd12=a295_0x4d6448;try{this[_0x3ebd12(0xe0)][_0x3ebd12(0xc6)]['length']&&this[_0x3ebd12(0xcc)][_0x3ebd12(0xc5)]&&await this[_0x3ebd12(0x9a)](),this[_0x3ebd12(0xb4)][_0x3ebd12(0xba)](_0x3ebd12(0xc9)+this['successDeployedCounter']+_0x3ebd12(0x92)),await this[_0x3ebd12(0xb4)]['update'](),_0x2ece29();}catch(_0x5071b6){_0x2ece29(_0x5071b6);}}}exports[a295_0x4d6448(0xdf)]=ComponentsDeployer;