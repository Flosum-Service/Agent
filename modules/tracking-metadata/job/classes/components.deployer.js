const a295_0x547f96=a295_0x3e9c;(function(_0xf42ecf,_0x1d777f){const _0x5d52fe=a295_0x3e9c,_0x3cb2c2=_0xf42ecf();while(!![]){try{const _0xd3efe1=-parseInt(_0x5d52fe(0x15c))/0x1+parseInt(_0x5d52fe(0x15e))/0x2*(-parseInt(_0x5d52fe(0x126))/0x3)+parseInt(_0x5d52fe(0x14b))/0x4*(-parseInt(_0x5d52fe(0x133))/0x5)+parseInt(_0x5d52fe(0x13b))/0x6+-parseInt(_0x5d52fe(0x12d))/0x7+-parseInt(_0x5d52fe(0x151))/0x8+-parseInt(_0x5d52fe(0x153))/0x9*(-parseInt(_0x5d52fe(0x13a))/0xa);if(_0xd3efe1===_0x1d777f)break;else _0x3cb2c2['push'](_0x3cb2c2['shift']());}catch(_0x2a7788){_0x3cb2c2['push'](_0x3cb2c2['shift']());}}}(a295_0x117f,0x6bd58));const a295_0x32bb53=(function(){let _0x217b44=!![];return function(_0x4bf3bd,_0x291918){const _0xbf4c8c=_0x217b44?function(){const _0x2392aa=a295_0x3e9c;if(_0x291918){const _0x109c32=_0x291918[_0x2392aa(0x149)](_0x4bf3bd,arguments);return _0x291918=null,_0x109c32;}}:function(){};return _0x217b44=![],_0xbf4c8c;};}()),a295_0x5a95c4=a295_0x32bb53(this,function(){const _0x20e176=a295_0x3e9c;return a295_0x5a95c4['toString']()[_0x20e176(0x155)](_0x20e176(0x15b))[_0x20e176(0x146)]()[_0x20e176(0x164)](a295_0x5a95c4)[_0x20e176(0x155)]('(((.+)+)+)+$');});function a295_0x3e9c(_0xd9ee67,_0x3184c7){const _0x1b0af4=a295_0x117f();return a295_0x3e9c=function(_0x5a95c4,_0x32bb53){_0x5a95c4=_0x5a95c4-0x111;let _0x117f8=_0x1b0af4[_0x5a95c4];return _0x117f8;},a295_0x3e9c(_0xd9ee67,_0x3184c7);}function a295_0x117f(){const _0x3c8919=['2344272qKbnDb','isNameObsolete','9288261iwkkHE','type','search','length','MAX_BODY_SIZE','ORG_COMPONENT_OBJECT_NAME','error','attachmentId','(((.+)+)+)+$','302447ZWABkb','fullName','2lBTpaj','Attachment_ID__c','log','addAttachmentToChunk','API_Name__c','Tracking_Setting__c','constructor','execute','\x20components','_final','deployAttachments','handleDeployResult','Label__c','FLOSUM_NAMESPACE','@flosum/salesforce','resetChunks','isReachedMaxChunk','apiVersion','application/zip','binary','METADATA_FOLDER_MAP','populateAttachmentId','Is_Retrieved__c','defineProperty','has','deployOrgComponents','createZip','logger','Source_Member_Id__c','instance','revisionCounter','1744629lDzuCB','__importDefault','jszip','then','componentId','Component_Type__c','addOrgComponentToChunk','334089lTkauu','deploy','ATTACHMENT_OBJECT_NAME','Last_Updated_By__c','BINARY_FIELD_NAME','attachmentsToDeployChunk','10rXWTon','changedBy','successDeployedCounter','Readable','Writable','targetOrgId','Status__c','10LUbMWW','4865688cMlkaM','fileName','records','Process\x20completed\x20for\x20','ComponentsDeployer','CompositeBinaryDeployData','binaryRecordsSizeChunk','file','orgComponentsToDeployChunk','CompositeConstants','push','toString','stream','sourceMemberId','apply','trackingSettingId','353076lHabuX','__esModule','../../constants','generateAsync','Folder__c','nodebuffer'];a295_0x117f=function(){return _0x3c8919;};return a295_0x117f();}a295_0x5a95c4();'use strict';var __importDefault=this&&this[a295_0x547f96(0x127)]||function(_0x1f6328){const _0x31d9d3=a295_0x547f96;return _0x1f6328&&_0x1f6328[_0x31d9d3(0x14c)]?_0x1f6328:{'default':_0x1f6328};};Object[a295_0x547f96(0x11e)](exports,'__esModule',{'value':!![]}),exports['ComponentsDeployer']=void 0x0;const salesforce_1=require(a295_0x547f96(0x115)),constants_1=require(a295_0x547f96(0x14d)),stream_1=require(a295_0x547f96(0x147)),jszip_1=__importDefault(require(a295_0x547f96(0x128))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a295_0x547f96(0x114)]+a295_0x547f96(0x15f),CONTENT_TYPE=a295_0x547f96(0x119);class ComponentsDeployer extends stream_1[a295_0x547f96(0x137)]{constructor({apiVersion:_0x1aa80c,instance:_0x463aab,logger:_0x1a6b18,targetOrgId:_0x130699,trackingSettingId:_0x1c305b}){const _0x4bfab6=a295_0x547f96;super({'objectMode':!![]}),this[_0x4bfab6(0x132)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x4bfab6(0x143)]=[],this[_0x4bfab6(0x135)]=0x0,this[_0x4bfab6(0x118)]=_0x1aa80c,this[_0x4bfab6(0x124)]=_0x463aab,this[_0x4bfab6(0x122)]=_0x1a6b18,this[_0x4bfab6(0x138)]=_0x130699,this[_0x4bfab6(0x14a)]=_0x1c305b;}async[a295_0x547f96(0x12e)](){const _0x13b012=a295_0x547f96;await this[_0x13b012(0x111)]()[_0x13b012(0x129)](_0x4a99ef=>this[_0x13b012(0x11c)](_0x4a99ef))[_0x13b012(0x129)](()=>this['deployOrgComponents']())[_0x13b012(0x129)](_0x234cd0=>this[_0x13b012(0x112)](_0x234cd0)),this[_0x13b012(0x116)]();}['deployAttachments'](){const _0x3a2205=a295_0x547f96,_0x42edee=new salesforce_1[(_0x3a2205(0x140))]({'instance':this['instance'],'objectName':constants_1[_0x3a2205(0x12f)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x42edee[_0x3a2205(0x165)](this[_0x3a2205(0x132)]);}[a295_0x547f96(0x120)](){const _0x2b15b1=a295_0x547f96,_0x306777=new salesforce_1['RestSimpleDeployData']({'instance':this[_0x2b15b1(0x124)],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this[_0x2b15b1(0x118)],'allOrNone':![],'externalIdField':'Id'});return _0x306777['execute']({'records':this[_0x2b15b1(0x143)]});}async['handleDeployResult'](_0x4d4299){const _0x3937d3=a295_0x547f96;for(const {success:_0x1d4400,error:_0x40c3f9}of _0x4d4299){if(_0x1d4400){this[_0x3937d3(0x135)]++;continue;}_0x40c3f9&&this['logger'][_0x3937d3(0x159)](_0x40c3f9);}}[a295_0x547f96(0x117)](_0xb69182){const _0x3882b3=a295_0x547f96;return _0xb69182+this[_0x3882b3(0x141)]>=salesforce_1[_0x3882b3(0x144)][_0x3882b3(0x157)]||this['attachmentsToDeployChunk']['records'][_0x3882b3(0x156)]===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x547f96(0x116)](){const _0x47f37d=a295_0x547f96;this[_0x47f37d(0x141)]=0x0,this[_0x47f37d(0x132)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a295_0x547f96(0x11c)](_0x1cbf90){const _0x41122d=a295_0x547f96;for(const _0x315f57 in _0x1cbf90){this[_0x41122d(0x143)][_0x315f57][ATTACHMENT_FIELD_NAME]=_0x1cbf90[_0x315f57]['id'];}}async[a295_0x547f96(0x161)](_0x344f95,_0x2fe53d){const _0x4b0090=a295_0x547f96,{listMetadataItem:_0xd75f71,sourceMemberRecord:_0x4d265a}=_0x344f95,_0x3b9269={'attributes':{'type':constants_1[_0x4b0090(0x12f)],'binaryPartName':_0xd75f71[_0x4b0090(0x15d)],'binaryPartNameAlias':constants_1[_0x4b0090(0x131)]},'Id':_0x4d265a[_0x4b0090(0x15a)],'Name':_0xd75f71[_0x4b0090(0x15d)],'Description':_0xd75f71[_0x4b0090(0x154)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x4b0090(0x138)],'Body':_0xd75f71[_0x4b0090(0x15d)]},_0x30c7a5={'binaryFieldName':constants_1['BINARY_FIELD_NAME'],'name':_0xd75f71[_0x4b0090(0x15d)],'value':stream_1[_0x4b0090(0x136)]['from'](_0x2fe53d)};this[_0x4b0090(0x132)][_0x4b0090(0x13d)][_0x4b0090(0x145)](_0x3b9269),this['attachmentsToDeployChunk'][_0x4b0090(0x11a)][_0x4b0090(0x145)](_0x30c7a5);}[a295_0x547f96(0x121)](_0xfa2af1){const _0x3510b6=a295_0x547f96,_0x5798cc=new jszip_1['default']();for(const _0x2acba5 in _0xfa2af1){_0x5798cc[_0x3510b6(0x142)](_0x2acba5,_0xfa2af1[_0x2acba5]);}return _0x5798cc[_0x3510b6(0x14e)]({'type':_0x3510b6(0x150)});}[a295_0x547f96(0x12c)](_0x7808f6,_0x437d27){const _0x4d2e12=a295_0x547f96,_0x5c8624={'attributes':{'type':constants_1[_0x4d2e12(0x158)]},'Id':_0x437d27[_0x4d2e12(0x12a)],[constants_2[_0x4d2e12(0x114)]+'Is_Deleted__c']:_0x437d27[_0x4d2e12(0x152)],[constants_2['FLOSUM_NAMESPACE']+'Revision_Counter__c']:_0x437d27[_0x4d2e12(0x125)],[constants_2[_0x4d2e12(0x114)]+_0x4d2e12(0x123)]:_0x437d27[_0x4d2e12(0x148)],[constants_2['FLOSUM_NAMESPACE']+_0x4d2e12(0x130)]:_0x437d27[_0x4d2e12(0x134)],[constants_2[_0x4d2e12(0x114)]+_0x4d2e12(0x162)]:_0x7808f6[_0x4d2e12(0x15d)],[constants_2[_0x4d2e12(0x114)]+'Name__c']:_0x7808f6[_0x4d2e12(0x15d)],[constants_2[_0x4d2e12(0x114)]+_0x4d2e12(0x12b)]:_0x7808f6[_0x4d2e12(0x154)],[constants_2[_0x4d2e12(0x114)]+_0x4d2e12(0x113)]:_0x7808f6[_0x4d2e12(0x13c)],[constants_2['FLOSUM_NAMESPACE']+_0x4d2e12(0x14f)]:constants_1[_0x4d2e12(0x11b)][_0x4d2e12(0x11f)](_0x7808f6[_0x4d2e12(0x154)])||null,[constants_2[_0x4d2e12(0x114)]+_0x4d2e12(0x11d)]:!![],[constants_2[_0x4d2e12(0x114)]+'OrganisationName__c']:this[_0x4d2e12(0x138)],[constants_2[_0x4d2e12(0x114)]+_0x4d2e12(0x163)]:this[_0x4d2e12(0x14a)],[constants_2[_0x4d2e12(0x114)]+_0x4d2e12(0x139)]:'Retrieved'};this['orgComponentsToDeployChunk'][_0x4d2e12(0x145)](_0x5c8624);}async['_write'](_0x24b73e,_0x98dd24,_0x490e70){const _0x33f6c9=a295_0x547f96;try{const {listMetadataItem:_0x221b34,sourceMemberRecord:_0xc381a9,files:_0x4d7958}=_0x24b73e,_0x71cd12=await this['createZip'](_0x4d7958),_0x57bf28=Buffer['byteLength'](_0x71cd12);this[_0x33f6c9(0x117)](_0x57bf28)&&await this[_0x33f6c9(0x12e)](),this[_0x33f6c9(0x141)]+=_0x57bf28,await this[_0x33f6c9(0x161)](_0x24b73e,_0x71cd12),this[_0x33f6c9(0x12c)](_0x221b34,_0xc381a9),_0x490e70();}catch(_0x28341d){_0x490e70(_0x28341d);}}async[a295_0x547f96(0x167)](_0x3dc680){const _0x374d9c=a295_0x547f96;try{this['attachmentsToDeployChunk'][_0x374d9c(0x13d)][_0x374d9c(0x156)]&&this[_0x374d9c(0x143)][_0x374d9c(0x156)]&&await this[_0x374d9c(0x12e)](),this[_0x374d9c(0x122)][_0x374d9c(0x160)](_0x374d9c(0x13e)+this[_0x374d9c(0x135)]+_0x374d9c(0x166)),await this[_0x374d9c(0x122)]['update'](),_0x3dc680();}catch(_0x56c57a){_0x3dc680(_0x56c57a);}}}exports[a295_0x547f96(0x13f)]=ComponentsDeployer;