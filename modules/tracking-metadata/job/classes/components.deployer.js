const a295_0x199776=a295_0x5de8;(function(_0x4f504f,_0x1e77fd){const _0x5811ca=a295_0x5de8,_0x230c21=_0x4f504f();while(!![]){try{const _0xce09cd=parseInt(_0x5811ca(0x1ae))/0x1*(parseInt(_0x5811ca(0x197))/0x2)+-parseInt(_0x5811ca(0x1ce))/0x3*(-parseInt(_0x5811ca(0x1a7))/0x4)+parseInt(_0x5811ca(0x1cb))/0x5+-parseInt(_0x5811ca(0x1be))/0x6*(parseInt(_0x5811ca(0x1d9))/0x7)+-parseInt(_0x5811ca(0x1d4))/0x8+parseInt(_0x5811ca(0x18f))/0x9*(parseInt(_0x5811ca(0x1c6))/0xa)+parseInt(_0x5811ca(0x1bc))/0xb*(-parseInt(_0x5811ca(0x1a6))/0xc);if(_0xce09cd===_0x1e77fd)break;else _0x230c21['push'](_0x230c21['shift']());}catch(_0x53ce93){_0x230c21['push'](_0x230c21['shift']());}}}(a295_0x35f4,0x5069a));const a295_0x3553bc=(function(){let _0x201d9c=!![];return function(_0x533703,_0x2f9c60){const _0x3fd552=_0x201d9c?function(){const _0x56ef00=a295_0x5de8;if(_0x2f9c60){const _0xc1665a=_0x2f9c60[_0x56ef00(0x18e)](_0x533703,arguments);return _0x2f9c60=null,_0xc1665a;}}:function(){};return _0x201d9c=![],_0x3fd552;};}()),a295_0x36eb36=a295_0x3553bc(this,function(){const _0x20faa7=a295_0x5de8;return a295_0x36eb36[_0x20faa7(0x1b3)]()[_0x20faa7(0x19a)]('(((.+)+)+)+$')[_0x20faa7(0x1b3)]()[_0x20faa7(0x19f)](a295_0x36eb36)[_0x20faa7(0x19a)](_0x20faa7(0x19c));});function a295_0x5de8(_0x4a07cd,_0x327c40){const _0xb0c909=a295_0x35f4();return a295_0x5de8=function(_0x36eb36,_0x3553bc){_0x36eb36=_0x36eb36-0x18a;let _0x35f4f1=_0xb0c909[_0x36eb36];return _0x35f4f1;},a295_0x5de8(_0x4a07cd,_0x327c40);}a295_0x36eb36();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x56362a){const _0x5f3525=a295_0x5de8;return _0x56362a&&_0x56362a[_0x5f3525(0x1ac)]?_0x56362a:{'default':_0x56362a};};Object[a295_0x199776(0x1aa)](exports,'__esModule',{'value':!![]}),exports[a295_0x199776(0x1a5)]=void 0x0;const salesforce_1=require(a295_0x199776(0x19d)),constants_1=require(a295_0x199776(0x1c5)),stream_1=require(a295_0x199776(0x194)),jszip_1=__importDefault(require('jszip')),constants_2=require(a295_0x199776(0x1b8)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a295_0x199776(0x1c0)]+a295_0x199776(0x18d),CONTENT_TYPE=a295_0x199776(0x1b2);class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x4c9e3a,instance:_0x1aaa5a,logger:_0x523f1a,targetOrgId:_0x52b73d,trackingSettingId:_0x2522f2}){const _0x40b994=a295_0x199776;super({'objectMode':!![]}),this[_0x40b994(0x191)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x40b994(0x1ca)]=[],this['successDeployedCounter']=0x0,this[_0x40b994(0x192)]=_0x4c9e3a,this['instance']=_0x1aaa5a,this[_0x40b994(0x198)]=_0x523f1a,this[_0x40b994(0x1c1)]=_0x52b73d,this[_0x40b994(0x1c9)]=_0x2522f2;}async[a295_0x199776(0x19b)](){const _0xaa56e2=a295_0x199776;await this[_0xaa56e2(0x1db)]()[_0xaa56e2(0x1cc)](_0xe83305=>this[_0xaa56e2(0x1ab)](_0xe83305))[_0xaa56e2(0x1cc)](()=>this[_0xaa56e2(0x1a1)]())[_0xaa56e2(0x1cc)](_0x23eeea=>this['handleDeployResult'](_0x23eeea)),this[_0xaa56e2(0x1b5)]();}['deployAttachments'](){const _0x4aacef=a295_0x199776,_0x1823a5=new salesforce_1[(_0x4aacef(0x18a))]({'instance':this[_0x4aacef(0x1e1)],'objectName':constants_1[_0x4aacef(0x1e0)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x1823a5['execute'](this[_0x4aacef(0x191)]);}[a295_0x199776(0x1a1)](){const _0x13628d=a295_0x199776,_0x1ccea9=new salesforce_1[(_0x13628d(0x1bd))]({'instance':this['instance'],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this[_0x13628d(0x192)],'allOrNone':![],'externalIdField':'Id'});return _0x1ccea9[_0x13628d(0x190)]({'records':this[_0x13628d(0x1ca)]});}async['handleDeployResult'](_0xb12368){const _0xb03bad=a295_0x199776;for(const {success:_0x232e0c,error:_0x3d98ff}of _0xb12368){if(_0x232e0c){this[_0xb03bad(0x1da)]++;continue;}_0x3d98ff&&this[_0xb03bad(0x198)][_0xb03bad(0x1e2)](_0x3d98ff);}}[a295_0x199776(0x1c3)](_0x5bb18b){const _0x14556b=a295_0x199776;return _0x5bb18b+this[_0x14556b(0x1d5)]>=salesforce_1[_0x14556b(0x1cf)][_0x14556b(0x1dd)]||this[_0x14556b(0x191)][_0x14556b(0x18c)]['length']===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x199776(0x1b5)](){const _0x1ab721=a295_0x199776;this[_0x1ab721(0x1d5)]=0x0,this[_0x1ab721(0x191)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a295_0x199776(0x1ab)](_0x5d47ab){const _0x52ccc6=a295_0x199776;for(const _0x1a3338 in _0x5d47ab){this[_0x52ccc6(0x1ca)][_0x1a3338][ATTACHMENT_FIELD_NAME]=_0x5d47ab[_0x1a3338]['id'];}}async[a295_0x199776(0x1d8)](_0x3a0d83,_0xdc7df9){const _0x5921d5=a295_0x199776,{listMetadataItem:_0x13e1bd,sourceMemberRecord:_0x4a585c}=_0x3a0d83,_0x25d2ed={'attributes':{'type':constants_1[_0x5921d5(0x1e0)],'binaryPartName':_0x13e1bd['fullName'],'binaryPartNameAlias':constants_1[_0x5921d5(0x1a8)]},'Id':_0x4a585c[_0x5921d5(0x1d6)],'Name':_0x13e1bd[_0x5921d5(0x1de)],'Description':_0x13e1bd[_0x5921d5(0x195)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x5921d5(0x1c1)],'Body':_0x13e1bd[_0x5921d5(0x1de)]},_0x57dd45={'binaryFieldName':constants_1[_0x5921d5(0x1a8)],'name':_0x13e1bd[_0x5921d5(0x1de)],'value':stream_1[_0x5921d5(0x1a2)][_0x5921d5(0x1a0)](_0xdc7df9)};this[_0x5921d5(0x191)]['records'][_0x5921d5(0x1d7)](_0x25d2ed),this['attachmentsToDeployChunk'][_0x5921d5(0x1b0)][_0x5921d5(0x1d7)](_0x57dd45);}['createZip'](_0x1bafb0){const _0x5b356f=a295_0x199776,_0x59b887=new jszip_1[(_0x5b356f(0x1b9))]();for(const _0x4dbf63 in _0x1bafb0){_0x59b887[_0x5b356f(0x1b7)](_0x4dbf63,_0x1bafb0[_0x4dbf63]);}return _0x59b887[_0x5b356f(0x193)]({'type':'nodebuffer'});}[a295_0x199776(0x1dc)](_0xcce658,_0x3bd449){const _0x23651b=a295_0x199776,_0x552ce3={'attributes':{'type':constants_1[_0x23651b(0x199)]},'Id':_0x3bd449[_0x23651b(0x1bf)],[constants_2[_0x23651b(0x1c0)]+'Is_Deleted__c']:_0x3bd449['isNameObsolete'],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1b1)]:_0x3bd449[_0x23651b(0x1d3)],[constants_2['FLOSUM_NAMESPACE']+'Source_Member_Id__c']:_0x3bd449[_0x23651b(0x1bb)],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1e3)]:_0x3bd449[_0x23651b(0x1d2)],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1d0)]:_0xcce658['fullName'],[constants_2['FLOSUM_NAMESPACE']+'Name__c']:_0xcce658[_0x23651b(0x1de)],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1c4)]:_0xcce658[_0x23651b(0x195)],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1df)]:_0xcce658[_0x23651b(0x19e)],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1d1)]:constants_1[_0x23651b(0x1ad)][_0x23651b(0x1a4)](_0xcce658[_0x23651b(0x195)])||null,[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1b4)]:!![],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1a9)]:this[_0x23651b(0x1c1)],[constants_2[_0x23651b(0x1c0)]+_0x23651b(0x1c8)]:this['trackingSettingId'],[constants_2['FLOSUM_NAMESPACE']+_0x23651b(0x1a3)]:_0x23651b(0x1af)};this[_0x23651b(0x1ca)]['push'](_0x552ce3);}async[a295_0x199776(0x1c7)](_0x3424d5,_0x112a0e,_0x3d4a7f){const _0x5e046=a295_0x199776;try{const {listMetadataItem:_0x464705,sourceMemberRecord:_0x272c7e,files:_0x4d5c68}=_0x3424d5,_0x3db263=await this[_0x5e046(0x1cd)](_0x4d5c68),_0xe3a075=Buffer[_0x5e046(0x18b)](_0x3db263);this['isReachedMaxChunk'](_0xe3a075)&&await this[_0x5e046(0x19b)](),this['binaryRecordsSizeChunk']+=_0xe3a075,await this['addAttachmentToChunk'](_0x3424d5,_0x3db263),this[_0x5e046(0x1dc)](_0x464705,_0x272c7e),_0x3d4a7f();}catch(_0x28094f){_0x3d4a7f(_0x28094f);}}async[a295_0x199776(0x1c2)](_0x30e3f3){const _0x506295=a295_0x199776;try{this[_0x506295(0x191)][_0x506295(0x18c)]['length']&&this['orgComponentsToDeployChunk'][_0x506295(0x196)]&&await this['deploy'](),this[_0x506295(0x198)]['log'](_0x506295(0x1b6)+this[_0x506295(0x1da)]+'\x20components'),await this[_0x506295(0x198)][_0x506295(0x1ba)](),_0x30e3f3();}catch(_0x174688){_0x30e3f3(_0x174688);}}}function a295_0x35f4(){const _0xdecd41=['from','deployOrgComponents','Readable','Status__c','has','ComponentsDeployer','4818996MUvdSJ','984408joQxZf','BINARY_FIELD_NAME','OrganisationName__c','defineProperty','populateAttachmentId','__esModule','METADATA_FOLDER_MAP','17323APQVSL','Retrieved','binary','Revision_Counter__c','application/zip','toString','Is_Retrieved__c','resetChunks','Process\x20completed\x20for\x20','file','../../../../constants','default','update','sourceMemberId','11GTIRBG','RestSimpleDeployData','6HDWtld','componentId','FLOSUM_NAMESPACE','targetOrgId','_final','isReachedMaxChunk','Component_Type__c','../../constants','1719660XpLHgj','_write','Tracking_Setting__c','trackingSettingId','orgComponentsToDeployChunk','3102230AcCijw','then','createZip','3FMxrzj','CompositeConstants','API_Name__c','Folder__c','changedBy','revisionCounter','687608kctiPg','binaryRecordsSizeChunk','attachmentId','push','addAttachmentToChunk','2400097WLRHHZ','successDeployedCounter','deployAttachments','addOrgComponentToChunk','MAX_BODY_SIZE','fullName','Label__c','ATTACHMENT_OBJECT_NAME','instance','error','Last_Updated_By__c','CompositeBinaryDeployData','byteLength','records','Attachment_ID__c','apply','9kDViKV','execute','attachmentsToDeployChunk','apiVersion','generateAsync','stream','type','length','14QBjgJc','logger','ORG_COMPONENT_OBJECT_NAME','search','deploy','(((.+)+)+)+$','@flosum/salesforce','fileName','constructor'];a295_0x35f4=function(){return _0xdecd41;};return a295_0x35f4();}exports[a295_0x199776(0x1a5)]=ComponentsDeployer;