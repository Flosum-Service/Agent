const a295_0x302850=a295_0x2f51;(function(_0x41be71,_0x24fafc){const _0x244bd3=a295_0x2f51,_0x3d4492=_0x41be71();while(!![]){try{const _0x5db10a=parseInt(_0x244bd3(0x129))/0x1*(parseInt(_0x244bd3(0x11f))/0x2)+-parseInt(_0x244bd3(0x115))/0x3+parseInt(_0x244bd3(0x104))/0x4*(parseInt(_0x244bd3(0xfc))/0x5)+-parseInt(_0x244bd3(0x111))/0x6+parseInt(_0x244bd3(0xfe))/0x7*(parseInt(_0x244bd3(0x10f))/0x8)+-parseInt(_0x244bd3(0x116))/0x9*(-parseInt(_0x244bd3(0xfb))/0xa)+-parseInt(_0x244bd3(0x103))/0xb*(parseInt(_0x244bd3(0x128))/0xc);if(_0x5db10a===_0x24fafc)break;else _0x3d4492['push'](_0x3d4492['shift']());}catch(_0x2f8c0d){_0x3d4492['push'](_0x3d4492['shift']());}}}(a295_0x599c,0x2f26b));const a295_0x28e32d=(function(){let _0x1aaccf=!![];return function(_0x1ad91f,_0x433087){const _0x271d9f=_0x1aaccf?function(){if(_0x433087){const _0x34b9a1=_0x433087['apply'](_0x1ad91f,arguments);return _0x433087=null,_0x34b9a1;}}:function(){};return _0x1aaccf=![],_0x271d9f;};}()),a295_0x510bb7=a295_0x28e32d(this,function(){const _0x24a1e1=a295_0x2f51;return a295_0x510bb7[_0x24a1e1(0xf3)]()[_0x24a1e1(0x138)](_0x24a1e1(0xf1))[_0x24a1e1(0xf3)]()['constructor'](a295_0x510bb7)[_0x24a1e1(0x138)](_0x24a1e1(0xf1));});a295_0x510bb7();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3200ae){const _0x77cfdd=a295_0x2f51;return _0x3200ae&&_0x3200ae[_0x77cfdd(0x142)]?_0x3200ae:{'default':_0x3200ae};};Object['defineProperty'](exports,a295_0x302850(0x142),{'value':!![]}),exports[a295_0x302850(0x11d)]=void 0x0;const salesforce_1=require('@flosum/salesforce'),constants_1=require(a295_0x302850(0x12a)),stream_1=require(a295_0x302850(0x127)),jszip_1=__importDefault(require(a295_0x302850(0x109))),constants_2=require(a295_0x302850(0x113)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a295_0x302850(0x140)]+'Attachment_ID__c',CONTENT_TYPE=a295_0x302850(0x122);function a295_0x2f51(_0x24af04,_0x539b2f){const _0x2887c2=a295_0x599c();return a295_0x2f51=function(_0x510bb7,_0x28e32d){_0x510bb7=_0x510bb7-0xf1;let _0x599cf6=_0x2887c2[_0x510bb7];return _0x599cf6;},a295_0x2f51(_0x24af04,_0x539b2f);}class ComponentsDeployer extends stream_1[a295_0x302850(0x143)]{constructor({apiVersion:_0x3031be,instance:_0x2ce786,logger:_0x37dc1b,targetOrgId:_0xdbc948,trackingSettingId:_0x2764f1}){const _0x5d5058=a295_0x302850;super({'objectMode':!![]}),this[_0x5d5058(0xfd)]={'records':[],'binary':[]},this[_0x5d5058(0x117)]=0x0,this['orgComponentsToDeployChunk']=[],this['successDeployedCounter']=0x0,this[_0x5d5058(0x126)]=_0x3031be,this[_0x5d5058(0x12c)]=_0x2ce786,this[_0x5d5058(0x105)]=_0x37dc1b,this['targetOrgId']=_0xdbc948,this[_0x5d5058(0x125)]=_0x2764f1;}async[a295_0x302850(0x13b)](){const _0x1ac906=a295_0x302850;await this[_0x1ac906(0x119)]()['then'](_0x576102=>this[_0x1ac906(0x141)](_0x576102))[_0x1ac906(0x100)](()=>this['deployOrgComponents']())[_0x1ac906(0x100)](_0x39c063=>this[_0x1ac906(0xf8)](_0x39c063)),this[_0x1ac906(0x13e)]();}[a295_0x302850(0x119)](){const _0x245673=a295_0x302850,_0x2c4362=new salesforce_1[(_0x245673(0xff))]({'instance':this[_0x245673(0x12c)],'objectName':constants_1[_0x245673(0x101)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x245673(0x126)]});return _0x2c4362[_0x245673(0x12b)](this[_0x245673(0xfd)]);}[a295_0x302850(0x12f)](){const _0x1d58f9=a295_0x302850,_0x43a427=new salesforce_1['RestSimpleDeployData']({'instance':this[_0x1d58f9(0x12c)],'objectName':constants_1[_0x1d58f9(0x114)],'api':this[_0x1d58f9(0x126)],'allOrNone':![],'externalIdField':'Id'});return _0x43a427[_0x1d58f9(0x12b)]({'records':this[_0x1d58f9(0x108)]});}async['handleDeployResult'](_0x59f339){const _0x427bd1=a295_0x302850;for(const {success:_0x50a701,error:_0xe875c4}of _0x59f339){if(_0x50a701){this['successDeployedCounter']++;continue;}_0xe875c4&&this[_0x427bd1(0x105)][_0x427bd1(0x131)](_0xe875c4);}}['isReachedMaxChunk'](_0x2d94fd){const _0x16f291=a295_0x302850;return _0x2d94fd+this[_0x16f291(0x117)]>=salesforce_1['CompositeConstants']['MAX_BODY_SIZE']||this['attachmentsToDeployChunk']['records']['length']===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x302850(0x13e)](){const _0x17f15a=a295_0x302850;this[_0x17f15a(0x117)]=0x0,this[_0x17f15a(0xfd)]={'records':[],'binary':[]},this[_0x17f15a(0x108)]=[];}[a295_0x302850(0x141)](_0xadff6d){for(const _0x430f35 in _0xadff6d){this['orgComponentsToDeployChunk'][_0x430f35][ATTACHMENT_FIELD_NAME]=_0xadff6d[_0x430f35]['id'];}}async['addAttachmentToChunk'](_0x36ccd9,_0x16c1c5){const _0x536e19=a295_0x302850,{listMetadataItem:_0x1631be,sourceMemberRecord:_0xa4715b}=_0x36ccd9,_0x44e49={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x1631be[_0x536e19(0x137)],'binaryPartNameAlias':constants_1[_0x536e19(0x13c)]},'Id':_0xa4715b[_0x536e19(0x123)],'Name':_0x1631be[_0x536e19(0x137)],'Description':_0x1631be['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x536e19(0x11a)],'Body':_0x1631be[_0x536e19(0x137)]},_0x1ab744={'binaryFieldName':constants_1['BINARY_FIELD_NAME'],'name':_0x1631be['fullName'],'value':stream_1[_0x536e19(0x139)][_0x536e19(0x10a)](_0x16c1c5)};this[_0x536e19(0xfd)][_0x536e19(0x136)][_0x536e19(0xf5)](_0x44e49),this[_0x536e19(0xfd)][_0x536e19(0x13d)][_0x536e19(0xf5)](_0x1ab744);}['createZip'](_0x5c0b26){const _0x3aa9a2=a295_0x302850,_0x21ebc0=new jszip_1[(_0x3aa9a2(0x10d))]();for(const _0xcb3c9b in _0x5c0b26){_0x21ebc0[_0x3aa9a2(0x135)](_0xcb3c9b,_0x5c0b26[_0xcb3c9b]);}return _0x21ebc0[_0x3aa9a2(0x120)]({'type':_0x3aa9a2(0x132)});}[a295_0x302850(0xf6)](_0x33800b,_0x751100){const _0x3379ef=a295_0x302850,_0x20f8c2={'attributes':{'type':constants_1[_0x3379ef(0x114)]},'Id':_0x751100['componentId'],[constants_2[_0x3379ef(0x140)]+_0x3379ef(0x11c)]:_0x751100[_0x3379ef(0xf2)],[constants_2[_0x3379ef(0x140)]+_0x3379ef(0x124)]:_0x751100[_0x3379ef(0x107)],[constants_2[_0x3379ef(0x140)]+'Source_Member_Id__c']:_0x751100[_0x3379ef(0x110)],[constants_2[_0x3379ef(0x140)]+'Last_Updated_By__c']:_0x751100['changedBy'],[constants_2['FLOSUM_NAMESPACE']+_0x3379ef(0x12d)]:_0x33800b[_0x3379ef(0x137)],[constants_2[_0x3379ef(0x140)]+_0x3379ef(0xf4)]:_0x33800b[_0x3379ef(0x137)],[constants_2['FLOSUM_NAMESPACE']+_0x3379ef(0x134)]:_0x33800b[_0x3379ef(0xf9)],[constants_2[_0x3379ef(0x140)]+'Label__c']:_0x33800b[_0x3379ef(0x13f)],[constants_2[_0x3379ef(0x140)]+_0x3379ef(0x13a)]:constants_1[_0x3379ef(0x112)][_0x3379ef(0x11b)](_0x33800b[_0x3379ef(0xf9)])||null,[constants_2[_0x3379ef(0x140)]+_0x3379ef(0x133)]:!![],[constants_2[_0x3379ef(0x140)]+'OrganisationName__c']:this[_0x3379ef(0x11a)],[constants_2['FLOSUM_NAMESPACE']+_0x3379ef(0xfa)]:this[_0x3379ef(0x125)],[constants_2[_0x3379ef(0x140)]+'Status__c']:_0x3379ef(0x10b)};this[_0x3379ef(0x108)][_0x3379ef(0xf5)](_0x20f8c2);}async[a295_0x302850(0x118)](_0x2524ed,_0x4eb963,_0x3fb8ef){const _0x462bac=a295_0x302850;try{const {listMetadataItem:_0x36e6f1,sourceMemberRecord:_0x399c99,files:_0x29570c}=_0x2524ed,_0x115f56=await this[_0x462bac(0x130)](_0x29570c),_0x400a42=Buffer[_0x462bac(0x10c)](_0x115f56);this[_0x462bac(0x11e)](_0x400a42)&&await this['deploy'](),this['binaryRecordsSizeChunk']+=_0x400a42,await this[_0x462bac(0x102)](_0x2524ed,_0x115f56),this[_0x462bac(0xf6)](_0x36e6f1,_0x399c99),_0x3fb8ef();}catch(_0x35fa54){_0x3fb8ef(_0x35fa54);}}async['_final'](_0x4a547e){const _0x2f0fb3=a295_0x302850;try{this[_0x2f0fb3(0xfd)]['records'][_0x2f0fb3(0x106)]&&this['orgComponentsToDeployChunk'][_0x2f0fb3(0x106)]&&await this[_0x2f0fb3(0x13b)](),this[_0x2f0fb3(0x105)][_0x2f0fb3(0x121)](_0x2f0fb3(0xf7)+this['successDeployedCounter']+_0x2f0fb3(0x12e)),await this[_0x2f0fb3(0x105)][_0x2f0fb3(0x10e)](),_0x4a547e();}catch(_0xe68850){_0x4a547e(_0xe68850);}}}function a295_0x599c(){const _0x5061e3=['execute','instance','API_Name__c','\x20components','deployOrgComponents','createZip','error','nodebuffer','Is_Retrieved__c','Component_Type__c','file','records','fullName','search','Readable','Folder__c','deploy','BINARY_FIELD_NAME','binary','resetChunks','fileName','FLOSUM_NAMESPACE','populateAttachmentId','__esModule','Writable','(((.+)+)+)+$','isNameObsolete','toString','Name__c','push','addOrgComponentToChunk','Process\x20completed\x20for\x20','handleDeployResult','type','Tracking_Setting__c','610bMHVEu','1835SpzIgO','attachmentsToDeployChunk','91csmvCp','CompositeBinaryDeployData','then','ATTACHMENT_OBJECT_NAME','addAttachmentToChunk','77riymQR','56wWSydl','logger','length','revisionCounter','orgComponentsToDeployChunk','jszip','from','Retrieved','byteLength','default','update','131896CPntBu','sourceMemberId','217314MGiCDb','METADATA_FOLDER_MAP','../../../../constants','ORG_COMPONENT_OBJECT_NAME','27162GdZmGT','19179XResgi','binaryRecordsSizeChunk','_write','deployAttachments','targetOrgId','has','Is_Deleted__c','ComponentsDeployer','isReachedMaxChunk','244514cKRTnS','generateAsync','log','application/zip','attachmentId','Revision_Counter__c','trackingSettingId','apiVersion','stream','819132QzektG','3UhLMuY','../../constants'];a295_0x599c=function(){return _0x5061e3;};return a295_0x599c();}exports[a295_0x302850(0x11d)]=ComponentsDeployer;