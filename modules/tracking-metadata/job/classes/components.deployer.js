function a295_0x1e23(){const _0x108670=['__esModule','@flosum/salesforce','isNameObsolete','Folder__c','2567060djEhsR','fullName','5609185kaVgUS','handleDeployResult','_write','execute','deploy','isReachedMaxChunk','length','FLOSUM_NAMESPACE','__importDefault','push','revisionCounter','_final','trackingSettingId','7JEUszK','file','application/zip','constructor','Is_Retrieved__c','addOrgComponentToChunk','Source_Member_Id__c','binaryRecordsSizeChunk','sourceMemberId','logger','METADATA_FOLDER_MAP','resetChunks','then','instance','update','Last_Updated_By__c','createZip','successDeployedCounter','targetOrgId','63bxfPNQ','componentId','OrganisationName__c','error','orgComponentsToDeployChunk','Tracking_Setting__c','2838972waLyvs','ATTACHMENT_OBJECT_NAME','Revision_Counter__c','Is_Deleted__c','\x20components','Status__c','fileName','populateAttachmentId','(((.+)+)+)+$','Component_Type__c','apiVersion','Label__c','deployOrgComponents','records','toString','apply','deployAttachments','changedBy','from','stream','BINARY_FIELD_NAME','Process\x20completed\x20for\x20','ORG_COMPONENT_OBJECT_NAME','Name__c','CompositeConstants','byteLength','attachmentId','1763280eymKwf','36533zMEJdM','7951968RDNkoN','attachmentsToDeployChunk','../../constants','type','6Tjhwkq','MAX_BODY_SIZE','261952UcvVFd','Retrieved','jszip'];a295_0x1e23=function(){return _0x108670;};return a295_0x1e23();}const a295_0x5ed6b2=a295_0xac31;(function(_0x32da98,_0x50a0f6){const _0x1dfb3d=a295_0xac31,_0x24fe77=_0x32da98();while(!![]){try{const _0x42deb3=parseInt(_0x1dfb3d(0x1ec))/0x1*(parseInt(_0x1dfb3d(0x1f1))/0x2)+-parseInt(_0x1dfb3d(0x1d0))/0x3+parseInt(_0x1dfb3d(0x1f3))/0x4+-parseInt(_0x1dfb3d(0x1fc))/0x5+-parseInt(_0x1dfb3d(0x1eb))/0x6+-parseInt(_0x1dfb3d(0x209))/0x7*(-parseInt(_0x1dfb3d(0x1ed))/0x8)+-parseInt(_0x1dfb3d(0x21c))/0x9*(-parseInt(_0x1dfb3d(0x1fa))/0xa);if(_0x42deb3===_0x50a0f6)break;else _0x24fe77['push'](_0x24fe77['shift']());}catch(_0x3d9f46){_0x24fe77['push'](_0x24fe77['shift']());}}}(a295_0x1e23,0x93750));const a295_0x581666=(function(){let _0x4e72e1=!![];return function(_0x5c1990,_0x2da002){const _0x20ddd6=_0x4e72e1?function(){const _0xf16fa=a295_0xac31;if(_0x2da002){const _0x2934b4=_0x2da002[_0xf16fa(0x1df)](_0x5c1990,arguments);return _0x2da002=null,_0x2934b4;}}:function(){};return _0x4e72e1=![],_0x20ddd6;};}()),a295_0x5be18f=a295_0x581666(this,function(){const _0x5e809a=a295_0xac31;return a295_0x5be18f[_0x5e809a(0x1de)]()['search'](_0x5e809a(0x1d8))['toString']()[_0x5e809a(0x20c)](a295_0x5be18f)['search']('(((.+)+)+)+$');});function a295_0xac31(_0x4c26ff,_0x30f333){const _0x5ecfb2=a295_0x1e23();return a295_0xac31=function(_0x5be18f,_0x581666){_0x5be18f=_0x5be18f-0x1d0;let _0x1e2390=_0x5ecfb2[_0x5be18f];return _0x1e2390;},a295_0xac31(_0x4c26ff,_0x30f333);}a295_0x5be18f();'use strict';var __importDefault=this&&this[a295_0x5ed6b2(0x204)]||function(_0x4b8a19){const _0x4bb7bc=a295_0x5ed6b2;return _0x4b8a19&&_0x4b8a19[_0x4bb7bc(0x1f6)]?_0x4b8a19:{'default':_0x4b8a19};};Object['defineProperty'](exports,a295_0x5ed6b2(0x1f6),{'value':!![]}),exports['ComponentsDeployer']=void 0x0;const salesforce_1=require(a295_0x5ed6b2(0x1f7)),constants_1=require(a295_0x5ed6b2(0x1ef)),stream_1=require(a295_0x5ed6b2(0x1e3)),jszip_1=__importDefault(require(a295_0x5ed6b2(0x1f5))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a295_0x5ed6b2(0x203)]+'Attachment_ID__c',CONTENT_TYPE=a295_0x5ed6b2(0x20b);class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x42e5bc,instance:_0x4a1861,logger:_0xb64259,targetOrgId:_0x449977,trackingSettingId:_0xcb07e0}){const _0x545af8=a295_0x5ed6b2;super({'objectMode':!![]}),this[_0x545af8(0x1ee)]={'records':[],'binary':[]},this[_0x545af8(0x210)]=0x0,this['orgComponentsToDeployChunk']=[],this[_0x545af8(0x21a)]=0x0,this[_0x545af8(0x1da)]=_0x42e5bc,this[_0x545af8(0x216)]=_0x4a1861,this[_0x545af8(0x212)]=_0xb64259,this[_0x545af8(0x21b)]=_0x449977,this[_0x545af8(0x208)]=_0xcb07e0;}async[a295_0x5ed6b2(0x200)](){const _0x12a0b7=a295_0x5ed6b2;await this['deployAttachments']()[_0x12a0b7(0x215)](_0x5d8ee3=>this[_0x12a0b7(0x1d7)](_0x5d8ee3))['then'](()=>this['deployOrgComponents']())[_0x12a0b7(0x215)](_0x4bc01c=>this[_0x12a0b7(0x1fd)](_0x4bc01c)),this[_0x12a0b7(0x214)]();}[a295_0x5ed6b2(0x1e0)](){const _0x2798a0=a295_0x5ed6b2,_0x429db0=new salesforce_1['CompositeBinaryDeployData']({'instance':this['instance'],'objectName':constants_1[_0x2798a0(0x1d1)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x429db0[_0x2798a0(0x1ff)](this[_0x2798a0(0x1ee)]);}[a295_0x5ed6b2(0x1dc)](){const _0x4532cb=a295_0x5ed6b2,_0x5a2e04=new salesforce_1['RestSimpleDeployData']({'instance':this[_0x4532cb(0x216)],'objectName':constants_1[_0x4532cb(0x1e6)],'api':this[_0x4532cb(0x1da)],'allOrNone':![],'externalIdField':'Id'});return _0x5a2e04['execute']({'records':this[_0x4532cb(0x220)]});}async[a295_0x5ed6b2(0x1fd)](_0x57b3da){const _0x42e15f=a295_0x5ed6b2;for(const {success:_0xcfb3fb,error:_0x50838a}of _0x57b3da){if(_0xcfb3fb){this[_0x42e15f(0x21a)]++;continue;}_0x50838a&&this[_0x42e15f(0x212)][_0x42e15f(0x21f)](_0x50838a);}}[a295_0x5ed6b2(0x201)](_0x5b1725){const _0x503983=a295_0x5ed6b2;return _0x5b1725+this[_0x503983(0x210)]>=salesforce_1[_0x503983(0x1e8)][_0x503983(0x1f2)]||this[_0x503983(0x1ee)][_0x503983(0x1dd)][_0x503983(0x202)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x21f675=a295_0x5ed6b2;this[_0x21f675(0x210)]=0x0,this['attachmentsToDeployChunk']={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a295_0x5ed6b2(0x1d7)](_0x1c6392){const _0xb7fb92=a295_0x5ed6b2;for(const _0x17de8c in _0x1c6392){this[_0xb7fb92(0x220)][_0x17de8c][ATTACHMENT_FIELD_NAME]=_0x1c6392[_0x17de8c]['id'];}}async['addAttachmentToChunk'](_0x72fc35,_0x489290){const _0x590821=a295_0x5ed6b2,{listMetadataItem:_0x13bf78,sourceMemberRecord:_0x298606}=_0x72fc35,_0x2600d7={'attributes':{'type':constants_1[_0x590821(0x1d1)],'binaryPartName':_0x13bf78[_0x590821(0x1fb)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x298606[_0x590821(0x1ea)],'Name':_0x13bf78[_0x590821(0x1fb)],'Description':_0x13bf78['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x590821(0x21b)],'Body':_0x13bf78[_0x590821(0x1fb)]},_0x5b55f6={'binaryFieldName':constants_1[_0x590821(0x1e4)],'name':_0x13bf78['fullName'],'value':stream_1['Readable'][_0x590821(0x1e2)](_0x489290)};this[_0x590821(0x1ee)][_0x590821(0x1dd)][_0x590821(0x205)](_0x2600d7),this[_0x590821(0x1ee)]['binary'][_0x590821(0x205)](_0x5b55f6);}['createZip'](_0x24ce31){const _0x3bfc84=a295_0x5ed6b2,_0x26478f=new jszip_1['default']();for(const _0x98dca2 in _0x24ce31){_0x26478f[_0x3bfc84(0x20a)](_0x98dca2,_0x24ce31[_0x98dca2]);}return _0x26478f['generateAsync']({'type':'nodebuffer'});}[a295_0x5ed6b2(0x20e)](_0x5a8d57,_0x1739df){const _0x5f07d9=a295_0x5ed6b2,_0x160988={'attributes':{'type':constants_1['ORG_COMPONENT_OBJECT_NAME']},'Id':_0x1739df[_0x5f07d9(0x21d)],[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x1d3)]:_0x1739df[_0x5f07d9(0x1f8)],[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x1d2)]:_0x1739df[_0x5f07d9(0x206)],[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x20f)]:_0x1739df[_0x5f07d9(0x211)],[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x218)]:_0x1739df[_0x5f07d9(0x1e1)],[constants_2[_0x5f07d9(0x203)]+'API_Name__c']:_0x5a8d57[_0x5f07d9(0x1fb)],[constants_2['FLOSUM_NAMESPACE']+_0x5f07d9(0x1e7)]:_0x5a8d57[_0x5f07d9(0x1fb)],[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x1d9)]:_0x5a8d57[_0x5f07d9(0x1f0)],[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x1db)]:_0x5a8d57[_0x5f07d9(0x1d6)],[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x1f9)]:constants_1[_0x5f07d9(0x213)]['has'](_0x5a8d57[_0x5f07d9(0x1f0)])||null,[constants_2[_0x5f07d9(0x203)]+_0x5f07d9(0x20d)]:!![],[constants_2['FLOSUM_NAMESPACE']+_0x5f07d9(0x21e)]:this[_0x5f07d9(0x21b)],[constants_2['FLOSUM_NAMESPACE']+_0x5f07d9(0x221)]:this[_0x5f07d9(0x208)],[constants_2['FLOSUM_NAMESPACE']+_0x5f07d9(0x1d5)]:_0x5f07d9(0x1f4)};this['orgComponentsToDeployChunk'][_0x5f07d9(0x205)](_0x160988);}async[a295_0x5ed6b2(0x1fe)](_0x37fc01,_0x45fbf0,_0x199509){const _0x3773be=a295_0x5ed6b2;try{const {listMetadataItem:_0x2f22d7,sourceMemberRecord:_0x17f918,files:_0x5f55a9}=_0x37fc01,_0x29f8b7=await this[_0x3773be(0x219)](_0x5f55a9),_0x220acc=Buffer[_0x3773be(0x1e9)](_0x29f8b7);this['isReachedMaxChunk'](_0x220acc)&&await this['deploy'](),this[_0x3773be(0x210)]+=_0x220acc,await this['addAttachmentToChunk'](_0x37fc01,_0x29f8b7),this[_0x3773be(0x20e)](_0x2f22d7,_0x17f918),_0x199509();}catch(_0x4f4839){_0x199509(_0x4f4839);}}async[a295_0x5ed6b2(0x207)](_0x1f5c65){const _0x3889d1=a295_0x5ed6b2;try{this[_0x3889d1(0x1ee)][_0x3889d1(0x1dd)][_0x3889d1(0x202)]&&this[_0x3889d1(0x220)][_0x3889d1(0x202)]&&await this[_0x3889d1(0x200)](),this[_0x3889d1(0x212)]['log'](_0x3889d1(0x1e5)+this[_0x3889d1(0x21a)]+_0x3889d1(0x1d4)),await this[_0x3889d1(0x212)][_0x3889d1(0x217)](),_0x1f5c65();}catch(_0x1159b6){_0x1f5c65(_0x1159b6);}}}exports['ComponentsDeployer']=ComponentsDeployer;