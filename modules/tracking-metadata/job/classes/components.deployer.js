const a295_0x1e6be6=a295_0x5e72;(function(_0x348667,_0x3d80e4){const _0x3f4645=a295_0x5e72,_0x2e55d2=_0x348667();while(!![]){try{const _0x3c8957=parseInt(_0x3f4645(0x106))/0x1+parseInt(_0x3f4645(0x105))/0x2+-parseInt(_0x3f4645(0xda))/0x3*(-parseInt(_0x3f4645(0xed))/0x4)+parseInt(_0x3f4645(0xf5))/0x5*(-parseInt(_0x3f4645(0xf6))/0x6)+-parseInt(_0x3f4645(0xd5))/0x7+-parseInt(_0x3f4645(0xc5))/0x8+parseInt(_0x3f4645(0xc4))/0x9*(parseInt(_0x3f4645(0xe3))/0xa);if(_0x3c8957===_0x3d80e4)break;else _0x2e55d2['push'](_0x2e55d2['shift']());}catch(_0x12f7c7){_0x2e55d2['push'](_0x2e55d2['shift']());}}}(a295_0xb69e,0xdddcf));const a295_0x7fb3d7=(function(){let _0x1c8794=!![];return function(_0x5cd5e3,_0x1feb7e){const _0x425c9b=_0x1c8794?function(){const _0x3cfbc4=a295_0x5e72;if(_0x1feb7e){const _0x478433=_0x1feb7e[_0x3cfbc4(0xcb)](_0x5cd5e3,arguments);return _0x1feb7e=null,_0x478433;}}:function(){};return _0x1c8794=![],_0x425c9b;};}()),a295_0x521743=a295_0x7fb3d7(this,function(){const _0x43dd55=a295_0x5e72;return a295_0x521743[_0x43dd55(0xcf)]()[_0x43dd55(0xe6)](_0x43dd55(0xbb))[_0x43dd55(0xcf)]()[_0x43dd55(0xbc)](a295_0x521743)[_0x43dd55(0xe6)]('(((.+)+)+)+$');});a295_0x521743();'use strict';function a295_0x5e72(_0x14cc04,_0x40995f){const _0x4ef5e2=a295_0xb69e();return a295_0x5e72=function(_0x521743,_0x7fb3d7){_0x521743=_0x521743-0xba;let _0xb69ece=_0x4ef5e2[_0x521743];return _0xb69ece;},a295_0x5e72(_0x14cc04,_0x40995f);}var __importDefault=this&&this[a295_0x1e6be6(0xe1)]||function(_0x3cb9d6){return _0x3cb9d6&&_0x3cb9d6['__esModule']?_0x3cb9d6:{'default':_0x3cb9d6};};Object[a295_0x1e6be6(0xec)](exports,a295_0x1e6be6(0xdd),{'value':!![]}),exports[a295_0x1e6be6(0xd2)]=void 0x0;function a295_0xb69e(){const _0x31e103=['byteLength','generateAsync','Retrieved','populateAttachmentId','file','RestSimpleDeployData','36485VLMkBZ','1386IoNBQG','Readable','successDeployedCounter','MAX_BODY_SIZE','isNameObsolete','logger','_write','deploy','CompositeBinaryDeployData','Is_Retrieved__c','addAttachmentToChunk','createZip','BINARY_FIELD_NAME','../../../../constants','changedBy','948970VmsNeT','997822cBnRAb','then','Is_Deleted__c','length','revisionCounter','trackingSettingId','Attachment_ID__c','Label__c','fullName','_final','handleDeployResult','type','Name__c','targetOrgId','(((.+)+)+)+$','constructor','Last_Updated_By__c','sourceMemberId','error','records','../../constants','Tracking_Setting__c','log','279eZzYcH','7593328RAFxZW','OrganisationName__c','resetChunks','binaryRecordsSizeChunk','Folder__c','API_Name__c','apply','update','isReachedMaxChunk','CompositeConstants','toString','attachmentsToDeployChunk','@flosum/salesforce','ComponentsDeployer','stream','ATTACHMENT_OBJECT_NAME','12204535ZAMfdQ','deployOrgComponents','FLOSUM_NAMESPACE','has','orgComponentsToDeployChunk','2991VLuMND','binary','addOrgComponentToChunk','__esModule','Writable','push','fileName','__importDefault','componentId','914410bXGtqd','Component_Type__c','ORG_COMPONENT_OBJECT_NAME','search','execute','from','deployAttachments','instance','apiVersion','defineProperty','3932zjtOTf','jszip'];a295_0xb69e=function(){return _0x31e103;};return a295_0xb69e();}const salesforce_1=require(a295_0x1e6be6(0xd1)),constants_1=require(a295_0x1e6be6(0xc1)),stream_1=require(a295_0x1e6be6(0xd3)),jszip_1=__importDefault(require(a295_0x1e6be6(0xee))),constants_2=require(a295_0x1e6be6(0x103)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a295_0x1e6be6(0x10c),CONTENT_TYPE='application/zip';class ComponentsDeployer extends stream_1[a295_0x1e6be6(0xde)]{constructor({apiVersion:_0x3c5b13,instance:_0x3fa418,logger:_0x1d0a64,targetOrgId:_0x1a2202,trackingSettingId:_0x5c0b72}){const _0x42dd38=a295_0x1e6be6;super({'objectMode':!![]}),this[_0x42dd38(0xd0)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this['orgComponentsToDeployChunk']=[],this[_0x42dd38(0xf8)]=0x0,this[_0x42dd38(0xeb)]=_0x3c5b13,this[_0x42dd38(0xea)]=_0x3fa418,this['logger']=_0x1d0a64,this[_0x42dd38(0xba)]=_0x1a2202,this[_0x42dd38(0x10b)]=_0x5c0b72;}async[a295_0x1e6be6(0xfd)](){const _0x4a2eac=a295_0x1e6be6;await this['deployAttachments']()[_0x4a2eac(0x107)](_0x27d055=>this['populateAttachmentId'](_0x27d055))[_0x4a2eac(0x107)](()=>this[_0x4a2eac(0xd6)]())[_0x4a2eac(0x107)](_0x450963=>this['handleDeployResult'](_0x450963)),this[_0x4a2eac(0xc7)]();}[a295_0x1e6be6(0xe9)](){const _0xd67bae=a295_0x1e6be6,_0x4ac9df=new salesforce_1[(_0xd67bae(0xfe))]({'instance':this[_0xd67bae(0xea)],'objectName':constants_1[_0xd67bae(0xd4)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x4ac9df[_0xd67bae(0xe7)](this[_0xd67bae(0xd0)]);}['deployOrgComponents'](){const _0x2dadaa=a295_0x1e6be6,_0x2f5cdf=new salesforce_1[(_0x2dadaa(0xf4))]({'instance':this[_0x2dadaa(0xea)],'objectName':constants_1[_0x2dadaa(0xe5)],'api':this[_0x2dadaa(0xeb)],'allOrNone':![],'externalIdField':'Id'});return _0x2f5cdf['execute']({'records':this[_0x2dadaa(0xd9)]});}async[a295_0x1e6be6(0x110)](_0xeedac9){const _0x15f5e9=a295_0x1e6be6;for(const {success:_0xae2b3c,error:_0x15addc}of _0xeedac9){if(_0xae2b3c){this[_0x15f5e9(0xf8)]++;continue;}_0x15addc&&this[_0x15f5e9(0xfb)][_0x15f5e9(0xbf)](_0x15addc);}}[a295_0x1e6be6(0xcd)](_0x316f25){const _0x22967a=a295_0x1e6be6;return _0x316f25+this[_0x22967a(0xc8)]>=salesforce_1[_0x22967a(0xce)][_0x22967a(0xf9)]||this[_0x22967a(0xd0)][_0x22967a(0xc0)][_0x22967a(0x109)]===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x1e6be6(0xc7)](){const _0x120cc3=a295_0x1e6be6;this[_0x120cc3(0xc8)]=0x0,this[_0x120cc3(0xd0)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a295_0x1e6be6(0xf2)](_0x1a6b9c){for(const _0x55cb08 in _0x1a6b9c){this['orgComponentsToDeployChunk'][_0x55cb08][ATTACHMENT_FIELD_NAME]=_0x1a6b9c[_0x55cb08]['id'];}}async['addAttachmentToChunk'](_0x1f94e8,_0x28e114){const _0x1fdc6d=a295_0x1e6be6,{listMetadataItem:_0x3774cc,sourceMemberRecord:_0x517a2f}=_0x1f94e8,_0x2c174d={'attributes':{'type':constants_1[_0x1fdc6d(0xd4)],'binaryPartName':_0x3774cc[_0x1fdc6d(0x10e)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x517a2f['attachmentId'],'Name':_0x3774cc[_0x1fdc6d(0x10e)],'Description':_0x3774cc[_0x1fdc6d(0x111)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x1fdc6d(0xba)],'Body':_0x3774cc[_0x1fdc6d(0x10e)]},_0x15ccab={'binaryFieldName':constants_1[_0x1fdc6d(0x102)],'name':_0x3774cc[_0x1fdc6d(0x10e)],'value':stream_1[_0x1fdc6d(0xf7)][_0x1fdc6d(0xe8)](_0x28e114)};this[_0x1fdc6d(0xd0)][_0x1fdc6d(0xc0)]['push'](_0x2c174d),this[_0x1fdc6d(0xd0)][_0x1fdc6d(0xdb)]['push'](_0x15ccab);}['createZip'](_0x3b299e){const _0x19e0fb=a295_0x1e6be6,_0x4e2e63=new jszip_1['default']();for(const _0x445beb in _0x3b299e){_0x4e2e63[_0x19e0fb(0xf3)](_0x445beb,_0x3b299e[_0x445beb]);}return _0x4e2e63[_0x19e0fb(0xf0)]({'type':'nodebuffer'});}[a295_0x1e6be6(0xdc)](_0x2b46d3,_0x288c57){const _0x2bf4b3=a295_0x1e6be6,_0x1d83d4={'attributes':{'type':constants_1['ORG_COMPONENT_OBJECT_NAME']},'Id':_0x288c57[_0x2bf4b3(0xe2)],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0x108)]:_0x288c57[_0x2bf4b3(0xfa)],[constants_2[_0x2bf4b3(0xd7)]+'Revision_Counter__c']:_0x288c57[_0x2bf4b3(0x10a)],[constants_2['FLOSUM_NAMESPACE']+'Source_Member_Id__c']:_0x288c57[_0x2bf4b3(0xbe)],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0xbd)]:_0x288c57[_0x2bf4b3(0x104)],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0xca)]:_0x2b46d3['fullName'],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0x112)]:_0x2b46d3[_0x2bf4b3(0x10e)],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0xe4)]:_0x2b46d3[_0x2bf4b3(0x111)],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0x10d)]:_0x2b46d3[_0x2bf4b3(0xe0)],[constants_2['FLOSUM_NAMESPACE']+_0x2bf4b3(0xc9)]:constants_1['METADATA_FOLDER_MAP'][_0x2bf4b3(0xd8)](_0x2b46d3[_0x2bf4b3(0x111)])||null,[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0xff)]:!![],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0xc6)]:this[_0x2bf4b3(0xba)],[constants_2[_0x2bf4b3(0xd7)]+_0x2bf4b3(0xc2)]:this[_0x2bf4b3(0x10b)],[constants_2[_0x2bf4b3(0xd7)]+'Status__c']:_0x2bf4b3(0xf1)};this[_0x2bf4b3(0xd9)][_0x2bf4b3(0xdf)](_0x1d83d4);}async[a295_0x1e6be6(0xfc)](_0x34c41e,_0x14f418,_0x556cd2){const _0x2a75af=a295_0x1e6be6;try{const {listMetadataItem:_0x2596ce,sourceMemberRecord:_0x449215,files:_0x2298b1}=_0x34c41e,_0x1b6b3d=await this[_0x2a75af(0x101)](_0x2298b1),_0x422503=Buffer[_0x2a75af(0xef)](_0x1b6b3d);this[_0x2a75af(0xcd)](_0x422503)&&await this[_0x2a75af(0xfd)](),this[_0x2a75af(0xc8)]+=_0x422503,await this[_0x2a75af(0x100)](_0x34c41e,_0x1b6b3d),this['addOrgComponentToChunk'](_0x2596ce,_0x449215),_0x556cd2();}catch(_0x52341d){_0x556cd2(_0x52341d);}}async[a295_0x1e6be6(0x10f)](_0x5351a4){const _0x2227ed=a295_0x1e6be6;try{this[_0x2227ed(0xd0)]['records']['length']&&this['orgComponentsToDeployChunk'][_0x2227ed(0x109)]&&await this['deploy'](),this['logger'][_0x2227ed(0xc3)]('Process\x20completed\x20for\x20'+this['successDeployedCounter']+'\x20components'),await this[_0x2227ed(0xfb)][_0x2227ed(0xcc)](),_0x5351a4();}catch(_0x5b66ed){_0x5351a4(_0x5b66ed);}}}exports[a295_0x1e6be6(0xd2)]=ComponentsDeployer;