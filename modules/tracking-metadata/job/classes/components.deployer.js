const a327_0x310f81=a327_0x3c8b;(function(_0x27bcde,_0x127bf6){const _0x475925=a327_0x3c8b,_0x50dd62=_0x27bcde();while(!![]){try{const _0xf9c1b1=parseInt(_0x475925(0x6b))/0x1*(-parseInt(_0x475925(0x86))/0x2)+parseInt(_0x475925(0x6d))/0x3+-parseInt(_0x475925(0x87))/0x4*(parseInt(_0x475925(0xa8))/0x5)+parseInt(_0x475925(0xb3))/0x6*(parseInt(_0x475925(0x90))/0x7)+parseInt(_0x475925(0x69))/0x8*(parseInt(_0x475925(0xb5))/0x9)+parseInt(_0x475925(0x9d))/0xa+-parseInt(_0x475925(0x9a))/0xb;if(_0xf9c1b1===_0x127bf6)break;else _0x50dd62['push'](_0x50dd62['shift']());}catch(_0x563456){_0x50dd62['push'](_0x50dd62['shift']());}}}(a327_0x47ec,0x5ace0));const a327_0xf7e633=(function(){let _0x57bbd7=!![];return function(_0x41c9fe,_0x1d8df0){const _0x42f77e=_0x57bbd7?function(){const _0x17d1cf=a327_0x3c8b;if(_0x1d8df0){const _0x5005c7=_0x1d8df0[_0x17d1cf(0x9b)](_0x41c9fe,arguments);return _0x1d8df0=null,_0x5005c7;}}:function(){};return _0x57bbd7=![],_0x42f77e;};}()),a327_0x567244=a327_0xf7e633(this,function(){const _0x4f5bf3=a327_0x3c8b;return a327_0x567244[_0x4f5bf3(0x98)]()['search'](_0x4f5bf3(0x7f))[_0x4f5bf3(0x98)]()[_0x4f5bf3(0xb0)](a327_0x567244)[_0x4f5bf3(0x89)](_0x4f5bf3(0x7f));});a327_0x567244();function a327_0x3c8b(_0x52fdb7,_0x2bc1eb){const _0xe644e5=a327_0x47ec();return a327_0x3c8b=function(_0x567244,_0xf7e633){_0x567244=_0x567244-0x64;let _0x47ecea=_0xe644e5[_0x567244];return _0x47ecea;},a327_0x3c8b(_0x52fdb7,_0x2bc1eb);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x31db90){return _0x31db90&&_0x31db90['__esModule']?_0x31db90:{'default':_0x31db90};};Object[a327_0x310f81(0x82)](exports,a327_0x310f81(0xa0),{'value':!![]}),exports[a327_0x310f81(0xb2)]=void 0x0;const salesforce_1=require(a327_0x310f81(0xaf)),constants_1=require(a327_0x310f81(0x85)),stream_1=require(a327_0x310f81(0x9c)),jszip_1=__importDefault(require('jszip')),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a327_0x310f81(0xa5)]+a327_0x310f81(0x65),CONTENT_TYPE='application/zip';class ComponentsDeployer extends stream_1[a327_0x310f81(0x88)]{constructor({apiVersion:_0x2684ad,instance:_0x3be36e,logger:_0x49d8d4,targetOrgId:_0x606d24,trackingSettingId:_0x5a82d4}){const _0x47c193=a327_0x310f81;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x47c193(0x6f)]=0x0,this[_0x47c193(0x91)]=[],this[_0x47c193(0x84)]=0x0,this[_0x47c193(0x97)]=_0x2684ad,this[_0x47c193(0x6e)]=_0x3be36e,this['logger']=_0x49d8d4,this[_0x47c193(0x72)]=_0x606d24,this[_0x47c193(0xa1)]=_0x5a82d4;}async[a327_0x310f81(0xa6)](){const _0x5b8325=a327_0x310f81;await this[_0x5b8325(0xa2)]()[_0x5b8325(0xae)](_0x14994d=>this[_0x5b8325(0x92)](_0x14994d))[_0x5b8325(0xae)](()=>this[_0x5b8325(0x81)]())[_0x5b8325(0xae)](_0x34941a=>this[_0x5b8325(0x93)](_0x34941a)),this[_0x5b8325(0x99)]();}[a327_0x310f81(0xa2)](){const _0x4f1b5a=a327_0x310f81,_0x193414=new salesforce_1['CompositeBinaryDeployData']({'instance':this[_0x4f1b5a(0x6e)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x4f1b5a(0x97)]});return _0x193414['execute'](this[_0x4f1b5a(0x8b)]);}[a327_0x310f81(0x81)](){const _0x21a2ae=a327_0x310f81,_0x360a20=new salesforce_1[(_0x21a2ae(0x74))]({'instance':this[_0x21a2ae(0x6e)],'objectName':constants_1[_0x21a2ae(0x95)],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0x360a20['execute']({'records':this[_0x21a2ae(0x91)]});}async['handleDeployResult'](_0x294ecc){const _0x1ff1e9=a327_0x310f81;for(const {success:_0x31114c,error:_0x3f666d}of _0x294ecc){if(_0x31114c){this[_0x1ff1e9(0x84)]++;continue;}_0x3f666d&&this['logger'][_0x1ff1e9(0xa3)](_0x3f666d);}}[a327_0x310f81(0x7a)](_0x485f6f){const _0x1181ae=a327_0x310f81;return _0x485f6f+this[_0x1181ae(0x6f)]>=salesforce_1[_0x1181ae(0x6a)]['MAX_BODY_SIZE']||this[_0x1181ae(0x8b)][_0x1181ae(0xac)][_0x1181ae(0x78)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x9847fe=a327_0x310f81;this[_0x9847fe(0x6f)]=0x0,this[_0x9847fe(0x8b)]={'records':[],'binary':[]},this[_0x9847fe(0x91)]=[];}[a327_0x310f81(0x92)](_0x263aa9){for(const _0xb7467a in _0x263aa9){this['orgComponentsToDeployChunk'][_0xb7467a][ATTACHMENT_FIELD_NAME]=_0x263aa9[_0xb7467a]['id'];}}async[a327_0x310f81(0x7c)](_0x563020,_0xd6b4c9){const _0x33edb2=a327_0x310f81,{listMetadataItem:_0x92123c,sourceMemberRecord:_0xc42061}=_0x563020,_0x264225={'attributes':{'type':constants_1[_0x33edb2(0x66)],'binaryPartName':_0x92123c[_0x33edb2(0x71)],'binaryPartNameAlias':constants_1[_0x33edb2(0xb4)]},'Id':_0xc42061[_0x33edb2(0x79)],'Name':_0x92123c[_0x33edb2(0x71)],'Description':_0x92123c['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x33edb2(0x72)],'Body':_0x92123c['fullName']},_0x48c96f={'binaryFieldName':constants_1[_0x33edb2(0xb4)],'name':_0x92123c[_0x33edb2(0x71)],'value':stream_1['Readable'][_0x33edb2(0x96)](_0xd6b4c9)};this[_0x33edb2(0x8b)]['records']['push'](_0x264225),this[_0x33edb2(0x8b)]['binary'][_0x33edb2(0xaa)](_0x48c96f);}[a327_0x310f81(0x94)](_0x65276){const _0x33ea25=a327_0x310f81,_0x2310d2=new jszip_1[(_0x33ea25(0x8a))]();for(const _0x3a5dc in _0x65276){_0x2310d2[_0x33ea25(0x8c)](_0x3a5dc,_0x65276[_0x3a5dc]);}return _0x2310d2['generateAsync']({'type':'nodebuffer'});}['addOrgComponentToChunk'](_0x1d2a33,_0x15353e){const _0x5b1f39=a327_0x310f81,_0x5c7db7={'attributes':{'type':constants_1[_0x5b1f39(0x95)]},'Id':_0x15353e[_0x5b1f39(0x9f)],[constants_2[_0x5b1f39(0xa5)]+_0x5b1f39(0xab)]:_0x15353e[_0x5b1f39(0x68)],[constants_2['FLOSUM_NAMESPACE']+_0x5b1f39(0x7b)]:_0x15353e[_0x5b1f39(0x64)],[constants_2[_0x5b1f39(0xa5)]+_0x5b1f39(0xa9)]:_0x15353e[_0x5b1f39(0x6c)],[constants_2[_0x5b1f39(0xa5)]+'Last_Updated_By__c']:_0x15353e['changedBy'],[constants_2[_0x5b1f39(0xa5)]+'API_Name__c']:_0x1d2a33[_0x5b1f39(0x71)],[constants_2[_0x5b1f39(0xa5)]+_0x5b1f39(0x8f)]:_0x1d2a33[_0x5b1f39(0x71)],[constants_2['FLOSUM_NAMESPACE']+_0x5b1f39(0x73)]:_0x1d2a33[_0x5b1f39(0xa4)],[constants_2[_0x5b1f39(0xa5)]+'Label__c']:_0x1d2a33[_0x5b1f39(0x8e)],[constants_2[_0x5b1f39(0xa5)]+_0x5b1f39(0x80)]:constants_1[_0x5b1f39(0x9e)][_0x5b1f39(0x67)](_0x1d2a33['type'])||null,[constants_2[_0x5b1f39(0xa5)]+_0x5b1f39(0xad)]:!![],[constants_2['FLOSUM_NAMESPACE']+_0x5b1f39(0xb1)]:this[_0x5b1f39(0x72)],[constants_2[_0x5b1f39(0xa5)]+_0x5b1f39(0xa7)]:this['trackingSettingId'],[constants_2[_0x5b1f39(0xa5)]+_0x5b1f39(0xb6)]:'Retrieved'};this[_0x5b1f39(0x91)][_0x5b1f39(0xaa)](_0x5c7db7);}async['_write'](_0x80512e,_0x4000ba,_0x5b35bd){const _0x4de2c9=a327_0x310f81;try{const {listMetadataItem:_0x550dc3,sourceMemberRecord:_0x43375b,files:_0x307f70}=_0x80512e,_0x27306b=await this['createZip'](_0x307f70),_0x306e2a=Buffer[_0x4de2c9(0x76)](_0x27306b);this[_0x4de2c9(0x7a)](_0x306e2a)&&await this[_0x4de2c9(0xa6)](),this[_0x4de2c9(0x6f)]+=_0x306e2a,await this[_0x4de2c9(0x7c)](_0x80512e,_0x27306b),this[_0x4de2c9(0x83)](_0x550dc3,_0x43375b),_0x5b35bd();}catch(_0x463efa){_0x5b35bd(_0x463efa);}}async[a327_0x310f81(0x7e)](_0x26790f){const _0x407702=a327_0x310f81;try{this[_0x407702(0x8b)]['records']['length']&&this[_0x407702(0x91)][_0x407702(0x78)]&&await this[_0x407702(0xa6)](),this[_0x407702(0x70)][_0x407702(0x75)](_0x407702(0x8d)+this[_0x407702(0x84)]+_0x407702(0x77)),await this[_0x407702(0x70)][_0x407702(0x7d)](),_0x26790f();}catch(_0x3e1233){_0x26790f(_0x3e1233);}}}exports['ComponentsDeployer']=ComponentsDeployer;function a327_0x47ec(){const _0x40ea87=['Tracking_Setting__c','3670CWkaBX','Source_Member_Id__c','push','Is_Deleted__c','records','Is_Retrieved__c','then','@flosum/salesforce','constructor','OrganisationName__c','ComponentsDeployer','4434786PtMdej','BINARY_FIELD_NAME','9JUykvs','Status__c','revisionCounter','Attachment_ID__c','ATTACHMENT_OBJECT_NAME','has','isNameObsolete','5950536AlprvE','CompositeConstants','3793HjYMkt','sourceMemberId','770232PwZJco','instance','binaryRecordsSizeChunk','logger','fullName','targetOrgId','Component_Type__c','RestSimpleDeployData','log','byteLength','\x20components','length','attachmentId','isReachedMaxChunk','Revision_Counter__c','addAttachmentToChunk','update','_final','(((.+)+)+)+$','Folder__c','deployOrgComponents','defineProperty','addOrgComponentToChunk','successDeployedCounter','../../constants','314ppIHqM','1816MIFlTn','Writable','search','default','attachmentsToDeployChunk','file','Process\x20completed\x20for\x20','fileName','Name__c','7AdvaGN','orgComponentsToDeployChunk','populateAttachmentId','handleDeployResult','createZip','ORG_COMPONENT_OBJECT_NAME','from','apiVersion','toString','resetChunks','11048829mJWXVd','apply','stream','5654200zQEqqY','METADATA_FOLDER_MAP','componentId','__esModule','trackingSettingId','deployAttachments','error','type','FLOSUM_NAMESPACE','deploy'];a327_0x47ec=function(){return _0x40ea87;};return a327_0x47ec();}