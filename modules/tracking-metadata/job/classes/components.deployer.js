function a295_0x9b25(_0xe9abec,_0x5c7334){const _0x3dc2e3=a295_0x1364();return a295_0x9b25=function(_0x4516de,_0x3b96e0){_0x4516de=_0x4516de-0x145;let _0x1364eb=_0x3dc2e3[_0x4516de];return _0x1364eb;},a295_0x9b25(_0xe9abec,_0x5c7334);}const a295_0x4b0dbc=a295_0x9b25;(function(_0x25600b,_0x351f99){const _0x4052ff=a295_0x9b25,_0x50703c=_0x25600b();while(!![]){try{const _0x563ef5=-parseInt(_0x4052ff(0x178))/0x1+parseInt(_0x4052ff(0x180))/0x2*(-parseInt(_0x4052ff(0x155))/0x3)+parseInt(_0x4052ff(0x158))/0x4+-parseInt(_0x4052ff(0x153))/0x5*(parseInt(_0x4052ff(0x17d))/0x6)+-parseInt(_0x4052ff(0x16c))/0x7+parseInt(_0x4052ff(0x147))/0x8+parseInt(_0x4052ff(0x193))/0x9;if(_0x563ef5===_0x351f99)break;else _0x50703c['push'](_0x50703c['shift']());}catch(_0x431f23){_0x50703c['push'](_0x50703c['shift']());}}}(a295_0x1364,0x37fb6));const a295_0x3b96e0=(function(){let _0x1555d1=!![];return function(_0x131511,_0x48679f){const _0x2cd31a=_0x1555d1?function(){if(_0x48679f){const _0x27c121=_0x48679f['apply'](_0x131511,arguments);return _0x48679f=null,_0x27c121;}}:function(){};return _0x1555d1=![],_0x2cd31a;};}()),a295_0x4516de=a295_0x3b96e0(this,function(){const _0x5d7d62=a295_0x9b25;return a295_0x4516de[_0x5d7d62(0x160)]()[_0x5d7d62(0x14e)]('(((.+)+)+)+$')['toString']()[_0x5d7d62(0x177)](a295_0x4516de)['search'](_0x5d7d62(0x146));});a295_0x4516de();'use strict';function a295_0x1364(){const _0x317538=['__importDefault','push','Retrieved','constructor','235162RBnZKy','length','default','Writable','populateAttachmentId','30KRufFs','BINARY_FIELD_NAME','Tracking_Setting__c','26McPvXw','__esModule','deploy','@flosum/salesforce','file','logger','Revision_Counter__c','records','Status__c','instance','binaryRecordsSizeChunk','isReachedMaxChunk','revisionCounter','FLOSUM_NAMESPACE','jszip','\x20components','apiVersion','addAttachmentToChunk','trackingSettingId','3640392qURQLH','ATTACHMENT_OBJECT_NAME','generateAsync','defineProperty','update','resetChunks','(((.+)+)+)+$','2347632tcOTTI','addOrgComponentToChunk','attachmentsToDeployChunk','_final','orgComponentsToDeployChunk','fullName','isNameObsolete','search','Last_Updated_By__c','_write','MAX_BODY_SIZE','createZip','25530nOpKnO','execute','61542JAfQAN','RestSimpleDeployData','stream','1083100koXKCM','CompositeBinaryDeployData','Readable','CompositeConstants','log','ORG_COMPONENT_OBJECT_NAME','targetOrgId','handleDeployResult','toString','from','deployAttachments','Process\x20completed\x20for\x20','deployOrgComponents','type','ComponentsDeployer','API_Name__c','attachmentId','Is_Deleted__c','Name__c','../../../../constants','1484287KOLLgd','byteLength','application/zip','then','successDeployedCounter','Label__c','fileName','sourceMemberId'];a295_0x1364=function(){return _0x317538;};return a295_0x1364();}var __importDefault=this&&this[a295_0x4b0dbc(0x174)]||function(_0x22a415){const _0x44a7f3=a295_0x4b0dbc;return _0x22a415&&_0x22a415[_0x44a7f3(0x181)]?_0x22a415:{'default':_0x22a415};};Object[a295_0x4b0dbc(0x196)](exports,a295_0x4b0dbc(0x181),{'value':!![]}),exports[a295_0x4b0dbc(0x166)]=void 0x0;const salesforce_1=require(a295_0x4b0dbc(0x183)),constants_1=require('../../constants'),stream_1=require(a295_0x4b0dbc(0x157)),jszip_1=__importDefault(require(a295_0x4b0dbc(0x18e))),constants_2=require(a295_0x4b0dbc(0x16b)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+'Attachment_ID__c',CONTENT_TYPE=a295_0x4b0dbc(0x16e);class ComponentsDeployer extends stream_1[a295_0x4b0dbc(0x17b)]{constructor({apiVersion:_0x1526b7,instance:_0x381b9b,logger:_0x5dda38,targetOrgId:_0x3953b8,trackingSettingId:_0x9cf02c}){const _0x2e58e7=a295_0x4b0dbc;super({'objectMode':!![]}),this[_0x2e58e7(0x149)]={'records':[],'binary':[]},this[_0x2e58e7(0x18a)]=0x0,this[_0x2e58e7(0x14b)]=[],this[_0x2e58e7(0x170)]=0x0,this[_0x2e58e7(0x190)]=_0x1526b7,this['instance']=_0x381b9b,this[_0x2e58e7(0x185)]=_0x5dda38,this['targetOrgId']=_0x3953b8,this[_0x2e58e7(0x192)]=_0x9cf02c;}async[a295_0x4b0dbc(0x182)](){const _0x5a947e=a295_0x4b0dbc;await this[_0x5a947e(0x162)]()[_0x5a947e(0x16f)](_0x583b6e=>this[_0x5a947e(0x17c)](_0x583b6e))[_0x5a947e(0x16f)](()=>this[_0x5a947e(0x164)]())['then'](_0xaed78f=>this[_0x5a947e(0x15f)](_0xaed78f)),this[_0x5a947e(0x145)]();}[a295_0x4b0dbc(0x162)](){const _0x25f051=a295_0x4b0dbc,_0x2c726a=new salesforce_1[(_0x25f051(0x159))]({'instance':this[_0x25f051(0x189)],'objectName':constants_1[_0x25f051(0x194)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x2c726a[_0x25f051(0x154)](this[_0x25f051(0x149)]);}[a295_0x4b0dbc(0x164)](){const _0x2d674c=a295_0x4b0dbc,_0xd248d5=new salesforce_1[(_0x2d674c(0x156))]({'instance':this[_0x2d674c(0x189)],'objectName':constants_1[_0x2d674c(0x15d)],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0xd248d5[_0x2d674c(0x154)]({'records':this['orgComponentsToDeployChunk']});}async['handleDeployResult'](_0x435420){const _0x1cfd5b=a295_0x4b0dbc;for(const {success:_0x41dbc8,error:_0x4b1e80}of _0x435420){if(_0x41dbc8){this['successDeployedCounter']++;continue;}_0x4b1e80&&this[_0x1cfd5b(0x185)]['error'](_0x4b1e80);}}[a295_0x4b0dbc(0x18b)](_0x17f6e0){const _0x3a1bd2=a295_0x4b0dbc;return _0x17f6e0+this[_0x3a1bd2(0x18a)]>=salesforce_1[_0x3a1bd2(0x15b)][_0x3a1bd2(0x151)]||this['attachmentsToDeployChunk']['records'][_0x3a1bd2(0x179)]===MAX_COMPOSITE_CHUNK_COUNT;}[a295_0x4b0dbc(0x145)](){const _0x4532c0=a295_0x4b0dbc;this[_0x4532c0(0x18a)]=0x0,this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x4532c0(0x14b)]=[];}[a295_0x4b0dbc(0x17c)](_0x7bf39c){for(const _0x424f47 in _0x7bf39c){this['orgComponentsToDeployChunk'][_0x424f47][ATTACHMENT_FIELD_NAME]=_0x7bf39c[_0x424f47]['id'];}}async[a295_0x4b0dbc(0x191)](_0x4bbfa2,_0x5b582e){const _0x1071a9=a295_0x4b0dbc,{listMetadataItem:_0x2a90b8,sourceMemberRecord:_0xff2108}=_0x4bbfa2,_0x3f417d={'attributes':{'type':constants_1[_0x1071a9(0x194)],'binaryPartName':_0x2a90b8[_0x1071a9(0x14c)],'binaryPartNameAlias':constants_1[_0x1071a9(0x17e)]},'Id':_0xff2108[_0x1071a9(0x168)],'Name':_0x2a90b8[_0x1071a9(0x14c)],'Description':_0x2a90b8['type'],'ContentType':CONTENT_TYPE,'ParentId':this[_0x1071a9(0x15e)],'Body':_0x2a90b8[_0x1071a9(0x14c)]},_0x5ddd96={'binaryFieldName':constants_1[_0x1071a9(0x17e)],'name':_0x2a90b8[_0x1071a9(0x14c)],'value':stream_1[_0x1071a9(0x15a)][_0x1071a9(0x161)](_0x5b582e)};this[_0x1071a9(0x149)][_0x1071a9(0x187)][_0x1071a9(0x175)](_0x3f417d),this[_0x1071a9(0x149)]['binary'][_0x1071a9(0x175)](_0x5ddd96);}[a295_0x4b0dbc(0x152)](_0xdacc69){const _0x1e5a76=a295_0x4b0dbc,_0x37aadf=new jszip_1[(_0x1e5a76(0x17a))]();for(const _0x26cf4e in _0xdacc69){_0x37aadf[_0x1e5a76(0x184)](_0x26cf4e,_0xdacc69[_0x26cf4e]);}return _0x37aadf[_0x1e5a76(0x195)]({'type':'nodebuffer'});}[a295_0x4b0dbc(0x148)](_0x25a64b,_0x483ca8){const _0x6b48f3=a295_0x4b0dbc,_0x517db5={'attributes':{'type':constants_1[_0x6b48f3(0x15d)]},'Id':_0x483ca8['componentId'],[constants_2[_0x6b48f3(0x18d)]+_0x6b48f3(0x169)]:_0x483ca8[_0x6b48f3(0x14d)],[constants_2['FLOSUM_NAMESPACE']+_0x6b48f3(0x186)]:_0x483ca8[_0x6b48f3(0x18c)],[constants_2['FLOSUM_NAMESPACE']+'Source_Member_Id__c']:_0x483ca8[_0x6b48f3(0x173)],[constants_2['FLOSUM_NAMESPACE']+_0x6b48f3(0x14f)]:_0x483ca8['changedBy'],[constants_2['FLOSUM_NAMESPACE']+_0x6b48f3(0x167)]:_0x25a64b[_0x6b48f3(0x14c)],[constants_2['FLOSUM_NAMESPACE']+_0x6b48f3(0x16a)]:_0x25a64b[_0x6b48f3(0x14c)],[constants_2[_0x6b48f3(0x18d)]+'Component_Type__c']:_0x25a64b[_0x6b48f3(0x165)],[constants_2['FLOSUM_NAMESPACE']+_0x6b48f3(0x171)]:_0x25a64b[_0x6b48f3(0x172)],[constants_2[_0x6b48f3(0x18d)]+'Folder__c']:constants_1['METADATA_FOLDER_MAP']['has'](_0x25a64b[_0x6b48f3(0x165)])||null,[constants_2[_0x6b48f3(0x18d)]+'Is_Retrieved__c']:!![],[constants_2[_0x6b48f3(0x18d)]+'OrganisationName__c']:this[_0x6b48f3(0x15e)],[constants_2[_0x6b48f3(0x18d)]+_0x6b48f3(0x17f)]:this[_0x6b48f3(0x192)],[constants_2['FLOSUM_NAMESPACE']+_0x6b48f3(0x188)]:_0x6b48f3(0x176)};this[_0x6b48f3(0x14b)]['push'](_0x517db5);}async[a295_0x4b0dbc(0x150)](_0x2a369b,_0x56d75a,_0x5b8391){const _0xd66838=a295_0x4b0dbc;try{const {listMetadataItem:_0x5a3de2,sourceMemberRecord:_0x2e8e62,files:_0x23e617}=_0x2a369b,_0x573e53=await this['createZip'](_0x23e617),_0x1714a4=Buffer[_0xd66838(0x16d)](_0x573e53);this[_0xd66838(0x18b)](_0x1714a4)&&await this['deploy'](),this[_0xd66838(0x18a)]+=_0x1714a4,await this['addAttachmentToChunk'](_0x2a369b,_0x573e53),this[_0xd66838(0x148)](_0x5a3de2,_0x2e8e62),_0x5b8391();}catch(_0x342559){_0x5b8391(_0x342559);}}async[a295_0x4b0dbc(0x14a)](_0x334119){const _0x5aae0c=a295_0x4b0dbc;try{this[_0x5aae0c(0x149)][_0x5aae0c(0x187)]['length']&&this['orgComponentsToDeployChunk'][_0x5aae0c(0x179)]&&await this['deploy'](),this[_0x5aae0c(0x185)][_0x5aae0c(0x15c)](_0x5aae0c(0x163)+this[_0x5aae0c(0x170)]+_0x5aae0c(0x18f)),await this[_0x5aae0c(0x185)][_0x5aae0c(0x197)](),_0x334119();}catch(_0x280a6e){_0x334119(_0x280a6e);}}}exports[a295_0x4b0dbc(0x166)]=ComponentsDeployer;