const a338_0x5d86be=a338_0x5b97;(function(_0x20c858,_0x2367a2){const _0x386622=a338_0x5b97,_0x1ad746=_0x20c858();while(!![]){try{const _0x5df2e8=-parseInt(_0x386622(0x192))/0x1*(-parseInt(_0x386622(0x153))/0x2)+-parseInt(_0x386622(0x169))/0x3+-parseInt(_0x386622(0x19f))/0x4*(parseInt(_0x386622(0x16f))/0x5)+-parseInt(_0x386622(0x19a))/0x6*(-parseInt(_0x386622(0x183))/0x7)+-parseInt(_0x386622(0x181))/0x8*(-parseInt(_0x386622(0x167))/0x9)+-parseInt(_0x386622(0x174))/0xa+parseInt(_0x386622(0x177))/0xb;if(_0x5df2e8===_0x2367a2)break;else _0x1ad746['push'](_0x1ad746['shift']());}catch(_0x40a603){_0x1ad746['push'](_0x1ad746['shift']());}}}(a338_0x454b,0x4711f));function a338_0x5b97(_0x221d5e,_0x313edb){const _0x6763f7=a338_0x454b();return a338_0x5b97=function(_0x254081,_0x3f2d9d){_0x254081=_0x254081-0x149;let _0x454bc2=_0x6763f7[_0x254081];return _0x454bc2;},a338_0x5b97(_0x221d5e,_0x313edb);}const a338_0x3f2d9d=(function(){let _0x3b5d7a=!![];return function(_0x238de9,_0x24c553){const _0x6d3527=_0x3b5d7a?function(){const _0x1552a4=a338_0x5b97;if(_0x24c553){const _0x1f4889=_0x24c553[_0x1552a4(0x154)](_0x238de9,arguments);return _0x24c553=null,_0x1f4889;}}:function(){};return _0x3b5d7a=![],_0x6d3527;};}()),a338_0x254081=a338_0x3f2d9d(this,function(){const _0x57b737=a338_0x5b97;return a338_0x254081[_0x57b737(0x170)]()[_0x57b737(0x186)](_0x57b737(0x19e))['toString']()[_0x57b737(0x155)](a338_0x254081)[_0x57b737(0x186)](_0x57b737(0x19e));});function a338_0x454b(){const _0x2073ec=['handleDeployResult','isNameObsolete','56346AeFDkW','apply','constructor','execute','addOrgComponentToChunk','@flosum/salesforce','deploy','componentId','METADATA_FOLDER_MAP','log','isReachedMaxChunk','then','has','Tracking_Setting__c','__esModule','trackingSettingId','application/zip','byteLength','deployOrgComponents','records','2584125gtIyFC','../../constants','1149441JJbdlQ','Folder__c','logger','Attachment_ID__c','BINARY_FIELD_NAME','revisionCounter','524275OiDRRB','toString','deployAttachments','targetOrgId','default','770660SfHQxm','nodebuffer','apiVersion','4444187wRuGFz','push','binary','FLOSUM_NAMESPACE','changedBy','type','stream','length','Retrieved','API_Name__c','16iqIlEK','successDeployedCounter','42AwLLIv','_write','orgComponentsToDeployChunk','search','Is_Retrieved__c','Name__c','error','__importDefault','CompositeConstants','binaryRecordsSizeChunk','generateAsync','from','ComponentsDeployer','fullName','ORG_COMPONENT_OBJECT_NAME','10ItjHKN','Last_Updated_By__c','createZip','RestSimpleDeployData','Component_Type__c','_final','attachmentId','Revision_Counter__c','15594epWUGJ','update','resetChunks','Label__c','(((.+)+)+)+$','20RPIdKp','Writable','CompositeBinaryDeployData','instance','file','ATTACHMENT_OBJECT_NAME','populateAttachmentId','sourceMemberId','attachmentsToDeployChunk','\x20components','OrganisationName__c'];a338_0x454b=function(){return _0x2073ec;};return a338_0x454b();}a338_0x254081();'use strict';var __importDefault=this&&this[a338_0x5d86be(0x18a)]||function(_0x41bd97){const _0x21f611=a338_0x5d86be;return _0x41bd97&&_0x41bd97[_0x21f611(0x161)]?_0x41bd97:{'default':_0x41bd97};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a338_0x5d86be(0x18f)]=void 0x0;const salesforce_1=require(a338_0x5d86be(0x158)),constants_1=require(a338_0x5d86be(0x168)),stream_1=require(a338_0x5d86be(0x17d)),jszip_1=__importDefault(require('jszip')),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a338_0x5d86be(0x17a)]+a338_0x5d86be(0x16c),CONTENT_TYPE=a338_0x5d86be(0x163);class ComponentsDeployer extends stream_1[a338_0x5d86be(0x1a0)]{constructor({apiVersion:_0x2c4a20,instance:_0x16d07b,logger:_0x5d3b89,targetOrgId:_0x20999c,trackingSettingId:_0x28bd2f}){const _0x3b830e=a338_0x5d86be;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x3b830e(0x18c)]=0x0,this[_0x3b830e(0x185)]=[],this[_0x3b830e(0x182)]=0x0,this[_0x3b830e(0x176)]=_0x2c4a20,this[_0x3b830e(0x149)]=_0x16d07b,this[_0x3b830e(0x16b)]=_0x5d3b89,this['targetOrgId']=_0x20999c,this[_0x3b830e(0x162)]=_0x28bd2f;}async[a338_0x5d86be(0x159)](){const _0x4ed4c0=a338_0x5d86be;await this[_0x4ed4c0(0x171)]()[_0x4ed4c0(0x15e)](_0x32df76=>this[_0x4ed4c0(0x14c)](_0x32df76))['then'](()=>this[_0x4ed4c0(0x165)]())['then'](_0x40d22b=>this[_0x4ed4c0(0x151)](_0x40d22b)),this[_0x4ed4c0(0x19c)]();}['deployAttachments'](){const _0x1d393f=a338_0x5d86be,_0x4ca709=new salesforce_1[(_0x1d393f(0x1a1))]({'instance':this[_0x1d393f(0x149)],'objectName':constants_1[_0x1d393f(0x14b)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x4ca709[_0x1d393f(0x156)](this[_0x1d393f(0x14e)]);}[a338_0x5d86be(0x165)](){const _0x53888d=a338_0x5d86be,_0x4d5e24=new salesforce_1[(_0x53888d(0x195))]({'instance':this[_0x53888d(0x149)],'objectName':constants_1[_0x53888d(0x191)],'api':this[_0x53888d(0x176)],'allOrNone':![],'externalIdField':'Id'});return _0x4d5e24[_0x53888d(0x156)]({'records':this[_0x53888d(0x185)]});}async[a338_0x5d86be(0x151)](_0x31acc8){const _0xad08fc=a338_0x5d86be;for(const {success:_0x3006a6,error:_0x289c84}of _0x31acc8){if(_0x3006a6){this[_0xad08fc(0x182)]++;continue;}_0x289c84&&this['logger'][_0xad08fc(0x189)](_0x289c84);}}['isReachedMaxChunk'](_0x3c6336){const _0x270dda=a338_0x5d86be;return _0x3c6336+this[_0x270dda(0x18c)]>=salesforce_1[_0x270dda(0x18b)]['MAX_BODY_SIZE']||this[_0x270dda(0x14e)][_0x270dda(0x166)][_0x270dda(0x17e)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x478951=a338_0x5d86be;this[_0x478951(0x18c)]=0x0,this[_0x478951(0x14e)]={'records':[],'binary':[]},this[_0x478951(0x185)]=[];}[a338_0x5d86be(0x14c)](_0x1b355c){const _0x47e705=a338_0x5d86be;for(const _0x53f681 in _0x1b355c){this[_0x47e705(0x185)][_0x53f681][ATTACHMENT_FIELD_NAME]=_0x1b355c[_0x53f681]['id'];}}async['addAttachmentToChunk'](_0x425573,_0x2a706d){const _0x56bc45=a338_0x5d86be,{listMetadataItem:_0xfc09e8,sourceMemberRecord:_0x162067}=_0x425573,_0x6e4907={'attributes':{'type':constants_1[_0x56bc45(0x14b)],'binaryPartName':_0xfc09e8[_0x56bc45(0x190)],'binaryPartNameAlias':constants_1[_0x56bc45(0x16d)]},'Id':_0x162067[_0x56bc45(0x198)],'Name':_0xfc09e8[_0x56bc45(0x190)],'Description':_0xfc09e8[_0x56bc45(0x17c)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x56bc45(0x172)],'Body':_0xfc09e8[_0x56bc45(0x190)]},_0x53fdc8={'binaryFieldName':constants_1[_0x56bc45(0x16d)],'name':_0xfc09e8['fullName'],'value':stream_1['Readable'][_0x56bc45(0x18e)](_0x2a706d)};this['attachmentsToDeployChunk']['records']['push'](_0x6e4907),this[_0x56bc45(0x14e)][_0x56bc45(0x179)][_0x56bc45(0x178)](_0x53fdc8);}['createZip'](_0x469dd2){const _0x3e9e0c=a338_0x5d86be,_0x522dee=new jszip_1[(_0x3e9e0c(0x173))]();for(const _0x7b93f1 in _0x469dd2){_0x522dee[_0x3e9e0c(0x14a)](_0x7b93f1,_0x469dd2[_0x7b93f1]);}return _0x522dee[_0x3e9e0c(0x18d)]({'type':_0x3e9e0c(0x175)});}[a338_0x5d86be(0x157)](_0x4b564f,_0x8e5e5d){const _0x4cf4=a338_0x5d86be,_0x5f1a7e={'attributes':{'type':constants_1[_0x4cf4(0x191)]},'Id':_0x8e5e5d[_0x4cf4(0x15a)],[constants_2[_0x4cf4(0x17a)]+'Is_Deleted__c']:_0x8e5e5d[_0x4cf4(0x152)],[constants_2[_0x4cf4(0x17a)]+_0x4cf4(0x199)]:_0x8e5e5d[_0x4cf4(0x16e)],[constants_2['FLOSUM_NAMESPACE']+'Source_Member_Id__c']:_0x8e5e5d[_0x4cf4(0x14d)],[constants_2['FLOSUM_NAMESPACE']+_0x4cf4(0x193)]:_0x8e5e5d[_0x4cf4(0x17b)],[constants_2['FLOSUM_NAMESPACE']+_0x4cf4(0x180)]:_0x4b564f[_0x4cf4(0x190)],[constants_2[_0x4cf4(0x17a)]+_0x4cf4(0x188)]:_0x4b564f[_0x4cf4(0x190)],[constants_2[_0x4cf4(0x17a)]+_0x4cf4(0x196)]:_0x4b564f[_0x4cf4(0x17c)],[constants_2[_0x4cf4(0x17a)]+_0x4cf4(0x19d)]:_0x4b564f['fileName'],[constants_2['FLOSUM_NAMESPACE']+_0x4cf4(0x16a)]:constants_1[_0x4cf4(0x15b)][_0x4cf4(0x15f)](_0x4b564f[_0x4cf4(0x17c)])||null,[constants_2[_0x4cf4(0x17a)]+_0x4cf4(0x187)]:!![],[constants_2[_0x4cf4(0x17a)]+_0x4cf4(0x150)]:this[_0x4cf4(0x172)],[constants_2[_0x4cf4(0x17a)]+_0x4cf4(0x160)]:this['trackingSettingId'],[constants_2['FLOSUM_NAMESPACE']+'Status__c']:_0x4cf4(0x17f)};this[_0x4cf4(0x185)]['push'](_0x5f1a7e);}async[a338_0x5d86be(0x184)](_0x1a0336,_0x1a173b,_0x2cb459){const _0x21c20c=a338_0x5d86be;try{const {listMetadataItem:_0x1fd3eb,sourceMemberRecord:_0x5a2c9d,files:_0x45974b}=_0x1a0336,_0x3e5779=await this[_0x21c20c(0x194)](_0x45974b),_0x59eed1=Buffer[_0x21c20c(0x164)](_0x3e5779);this[_0x21c20c(0x15d)](_0x59eed1)&&await this[_0x21c20c(0x159)](),this[_0x21c20c(0x18c)]+=_0x59eed1,await this['addAttachmentToChunk'](_0x1a0336,_0x3e5779),this[_0x21c20c(0x157)](_0x1fd3eb,_0x5a2c9d),_0x2cb459();}catch(_0x59eb0c){_0x2cb459(_0x59eb0c);}}async[a338_0x5d86be(0x197)](_0x1d848a){const _0xea65bc=a338_0x5d86be;try{this[_0xea65bc(0x14e)][_0xea65bc(0x166)][_0xea65bc(0x17e)]&&this['orgComponentsToDeployChunk'][_0xea65bc(0x17e)]&&await this[_0xea65bc(0x159)](),this[_0xea65bc(0x16b)][_0xea65bc(0x15c)]('Process\x20completed\x20for\x20'+this['successDeployedCounter']+_0xea65bc(0x14f)),await this[_0xea65bc(0x16b)][_0xea65bc(0x19b)](),_0x1d848a();}catch(_0x431b07){_0x1d848a(_0x431b07);}}}exports[a338_0x5d86be(0x18f)]=ComponentsDeployer;