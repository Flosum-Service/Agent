const a290_0x18c117=a290_0x4735;function a290_0x4735(_0x192404,_0x38bcdb){const _0x269086=a290_0xf6de();return a290_0x4735=function(_0x3df82b,_0x714b32){_0x3df82b=_0x3df82b-0x1ea;let _0xf6deda=_0x269086[_0x3df82b];return _0xf6deda;},a290_0x4735(_0x192404,_0x38bcdb);}(function(_0x3f6305,_0x503814){const _0x1b688a=a290_0x4735,_0x1c85a6=_0x3f6305();while(!![]){try{const _0x36dc57=parseInt(_0x1b688a(0x202))/0x1*(parseInt(_0x1b688a(0x1ee))/0x2)+parseInt(_0x1b688a(0x238))/0x3+parseInt(_0x1b688a(0x226))/0x4+parseInt(_0x1b688a(0x20f))/0x5+-parseInt(_0x1b688a(0x1f9))/0x6+-parseInt(_0x1b688a(0x204))/0x7*(parseInt(_0x1b688a(0x221))/0x8)+-parseInt(_0x1b688a(0x1ff))/0x9;if(_0x36dc57===_0x503814)break;else _0x1c85a6['push'](_0x1c85a6['shift']());}catch(_0x317160){_0x1c85a6['push'](_0x1c85a6['shift']());}}}(a290_0xf6de,0x72457));const a290_0x714b32=(function(){let _0x480782=!![];return function(_0x1e00ab,_0x4c0351){const _0x86b0df=_0x480782?function(){const _0x3550f4=a290_0x4735;if(_0x4c0351){const _0xd96059=_0x4c0351[_0x3550f4(0x22c)](_0x1e00ab,arguments);return _0x4c0351=null,_0xd96059;}}:function(){};return _0x480782=![],_0x86b0df;};}()),a290_0x3df82b=a290_0x714b32(this,function(){const _0x44876b=a290_0x4735;return a290_0x3df82b[_0x44876b(0x224)]()['search'](_0x44876b(0x21c))[_0x44876b(0x224)]()[_0x44876b(0x20b)](a290_0x3df82b)['search'](_0x44876b(0x21c));});a290_0x3df82b();'use strict';var __importDefault=this&&this[a290_0x18c117(0x212)]||function(_0xb6a6c4){const _0x10bc74=a290_0x18c117;return _0xb6a6c4&&_0xb6a6c4[_0x10bc74(0x20e)]?_0xb6a6c4:{'default':_0xb6a6c4};};function a290_0xf6de(){const _0x40546f=['Label__c','createZip','deploy','fullName','records','2211018ZpQwFw','type','Status__c','Readable','Is_Deleted__c','instance','3368754LAEavF','changedBy','RestSimpleDeployData','1513fosPEN','Folder__c','14AsZtEI','attachmentsToDeployChunk','file','Name__c','../../constants','\x20components','from','constructor','OrganisationName__c','generateAsync','__esModule','3045945qJGUWW','ATTACHMENT_OBJECT_NAME','revisionCounter','__importDefault','Retrieved','log','has','handleDeployResult','fileName','deployAttachments','deployOrgComponents','application/zip','Source_Member_Id__c','(((.+)+)+)+$','trackingSettingId','stream','Is_Retrieved__c','resetChunks','1513488ntfDLE','_final','ComponentsDeployer','toString','default','2010584jYnfUS','ORG_COMPONENT_OBJECT_NAME','isNameObsolete','binaryRecordsSizeChunk','push','length','apply','addAttachmentToChunk','Attachment_ID__c','isReachedMaxChunk','MAX_BODY_SIZE','execute','nodebuffer','BINARY_FIELD_NAME','Process\x20completed\x20for\x20','Writable','update','CompositeBinaryDeployData','1237026LabOOh','API_Name__c','error','../../../../constants','then','targetOrgId','orgComponentsToDeployChunk','jszip','Revision_Counter__c','defineProperty','apiVersion','Last_Updated_By__c','86sPtDCB','FLOSUM_NAMESPACE','successDeployedCounter','logger','byteLength','populateAttachmentId'];a290_0xf6de=function(){return _0x40546f;};return a290_0xf6de();}Object[a290_0x18c117(0x1eb)](exports,a290_0x18c117(0x20e),{'value':!![]}),exports[a290_0x18c117(0x223)]=void 0x0;const salesforce_1=require('@flosum/salesforce'),constants_1=require(a290_0x18c117(0x208)),stream_1=require(a290_0x18c117(0x21e)),jszip_1=__importDefault(require(a290_0x18c117(0x23f))),constants_2=require(a290_0x18c117(0x23b)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a290_0x18c117(0x22e),CONTENT_TYPE=a290_0x18c117(0x21a);class ComponentsDeployer extends stream_1[a290_0x18c117(0x235)]{constructor({apiVersion:_0x1738dd,instance:_0x2b56da,logger:_0x655a6f,targetOrgId:_0x68672d,trackingSettingId:_0x39c71d}){const _0x518dcf=a290_0x18c117;super({'objectMode':!![]}),this[_0x518dcf(0x205)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x518dcf(0x23e)]=[],this[_0x518dcf(0x1f0)]=0x0,this[_0x518dcf(0x1ec)]=_0x1738dd,this[_0x518dcf(0x1fe)]=_0x2b56da,this[_0x518dcf(0x1f1)]=_0x655a6f,this[_0x518dcf(0x23d)]=_0x68672d,this[_0x518dcf(0x21d)]=_0x39c71d;}async[a290_0x18c117(0x1f6)](){const _0x4e22ae=a290_0x18c117;await this[_0x4e22ae(0x218)]()['then'](_0x56dc5d=>this['populateAttachmentId'](_0x56dc5d))[_0x4e22ae(0x23c)](()=>this[_0x4e22ae(0x219)]())['then'](_0x2a610a=>this[_0x4e22ae(0x216)](_0x2a610a)),this['resetChunks']();}[a290_0x18c117(0x218)](){const _0x10546d=a290_0x18c117,_0x5d907b=new salesforce_1[(_0x10546d(0x237))]({'instance':this[_0x10546d(0x1fe)],'objectName':constants_1[_0x10546d(0x210)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x10546d(0x1ec)]});return _0x5d907b[_0x10546d(0x231)](this[_0x10546d(0x205)]);}[a290_0x18c117(0x219)](){const _0x399878=a290_0x18c117,_0x23ea6a=new salesforce_1[(_0x399878(0x201))]({'instance':this[_0x399878(0x1fe)],'objectName':constants_1[_0x399878(0x227)],'api':this[_0x399878(0x1ec)],'allOrNone':![],'externalIdField':'Id'});return _0x23ea6a['execute']({'records':this[_0x399878(0x23e)]});}async[a290_0x18c117(0x216)](_0x4f6d16){const _0x419b70=a290_0x18c117;for(const {success:_0x105bde,error:_0x42fdd7}of _0x4f6d16){if(_0x105bde){this[_0x419b70(0x1f0)]++;continue;}_0x42fdd7&&this[_0x419b70(0x1f1)][_0x419b70(0x23a)](_0x42fdd7);}}[a290_0x18c117(0x22f)](_0x3a48f5){const _0x474542=a290_0x18c117;return _0x3a48f5+this[_0x474542(0x229)]>=salesforce_1['CompositeConstants'][_0x474542(0x230)]||this[_0x474542(0x205)][_0x474542(0x1f8)][_0x474542(0x22b)]===MAX_COMPOSITE_CHUNK_COUNT;}[a290_0x18c117(0x220)](){const _0x567339=a290_0x18c117;this[_0x567339(0x229)]=0x0,this[_0x567339(0x205)]={'records':[],'binary':[]},this[_0x567339(0x23e)]=[];}[a290_0x18c117(0x1f3)](_0x4baa4b){const _0x4fdbde=a290_0x18c117;for(const _0x396423 in _0x4baa4b){this[_0x4fdbde(0x23e)][_0x396423][ATTACHMENT_FIELD_NAME]=_0x4baa4b[_0x396423]['id'];}}async[a290_0x18c117(0x22d)](_0x23c083,_0x494fd){const _0x3b209f=a290_0x18c117,{listMetadataItem:_0x40f452,sourceMemberRecord:_0x3c859f}=_0x23c083,_0x3141c3={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x40f452[_0x3b209f(0x1f7)],'binaryPartNameAlias':constants_1[_0x3b209f(0x233)]},'Id':_0x3c859f['attachmentId'],'Name':_0x40f452[_0x3b209f(0x1f7)],'Description':_0x40f452[_0x3b209f(0x1fa)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x3b209f(0x23d)],'Body':_0x40f452[_0x3b209f(0x1f7)]},_0x4c957f={'binaryFieldName':constants_1[_0x3b209f(0x233)],'name':_0x40f452[_0x3b209f(0x1f7)],'value':stream_1[_0x3b209f(0x1fc)][_0x3b209f(0x20a)](_0x494fd)};this[_0x3b209f(0x205)][_0x3b209f(0x1f8)]['push'](_0x3141c3),this[_0x3b209f(0x205)]['binary']['push'](_0x4c957f);}[a290_0x18c117(0x1f5)](_0x49d918){const _0x336dc3=a290_0x18c117,_0x9ffca1=new jszip_1[(_0x336dc3(0x225))]();for(const _0x236803 in _0x49d918){_0x9ffca1[_0x336dc3(0x206)](_0x236803,_0x49d918[_0x236803]);}return _0x9ffca1[_0x336dc3(0x20d)]({'type':_0x336dc3(0x232)});}['addOrgComponentToChunk'](_0x40df3b,_0x14a55e){const _0x1804d5=a290_0x18c117,_0x40b75a={'attributes':{'type':constants_1[_0x1804d5(0x227)]},'Id':_0x14a55e['componentId'],[constants_2[_0x1804d5(0x1ef)]+_0x1804d5(0x1fd)]:_0x14a55e[_0x1804d5(0x228)],[constants_2[_0x1804d5(0x1ef)]+_0x1804d5(0x1ea)]:_0x14a55e[_0x1804d5(0x211)],[constants_2[_0x1804d5(0x1ef)]+_0x1804d5(0x21b)]:_0x14a55e['sourceMemberId'],[constants_2['FLOSUM_NAMESPACE']+_0x1804d5(0x1ed)]:_0x14a55e[_0x1804d5(0x200)],[constants_2['FLOSUM_NAMESPACE']+_0x1804d5(0x239)]:_0x40df3b[_0x1804d5(0x1f7)],[constants_2['FLOSUM_NAMESPACE']+_0x1804d5(0x207)]:_0x40df3b[_0x1804d5(0x1f7)],[constants_2['FLOSUM_NAMESPACE']+'Component_Type__c']:_0x40df3b[_0x1804d5(0x1fa)],[constants_2[_0x1804d5(0x1ef)]+_0x1804d5(0x1f4)]:_0x40df3b[_0x1804d5(0x217)],[constants_2[_0x1804d5(0x1ef)]+_0x1804d5(0x203)]:constants_1['METADATA_FOLDER_MAP'][_0x1804d5(0x215)](_0x40df3b[_0x1804d5(0x1fa)])||null,[constants_2[_0x1804d5(0x1ef)]+_0x1804d5(0x21f)]:!![],[constants_2['FLOSUM_NAMESPACE']+_0x1804d5(0x20c)]:this[_0x1804d5(0x23d)],[constants_2['FLOSUM_NAMESPACE']+'Tracking_Setting__c']:this['trackingSettingId'],[constants_2[_0x1804d5(0x1ef)]+_0x1804d5(0x1fb)]:_0x1804d5(0x213)};this[_0x1804d5(0x23e)][_0x1804d5(0x22a)](_0x40b75a);}async['_write'](_0x2ad27e,_0x2242ec,_0x3033c3){const _0x3453ef=a290_0x18c117;try{const {listMetadataItem:_0x7b7616,sourceMemberRecord:_0x1efccb,files:_0x59a057}=_0x2ad27e,_0xfc438b=await this['createZip'](_0x59a057),_0x425846=Buffer[_0x3453ef(0x1f2)](_0xfc438b);this[_0x3453ef(0x22f)](_0x425846)&&await this[_0x3453ef(0x1f6)](),this[_0x3453ef(0x229)]+=_0x425846,await this[_0x3453ef(0x22d)](_0x2ad27e,_0xfc438b),this['addOrgComponentToChunk'](_0x7b7616,_0x1efccb),_0x3033c3();}catch(_0x16db36){_0x3033c3(_0x16db36);}}async[a290_0x18c117(0x222)](_0x46e603){const _0x155e1e=a290_0x18c117;try{this['attachmentsToDeployChunk'][_0x155e1e(0x1f8)][_0x155e1e(0x22b)]&&this[_0x155e1e(0x23e)][_0x155e1e(0x22b)]&&await this[_0x155e1e(0x1f6)](),this['logger'][_0x155e1e(0x214)](_0x155e1e(0x234)+this[_0x155e1e(0x1f0)]+_0x155e1e(0x209)),await this[_0x155e1e(0x1f1)][_0x155e1e(0x236)](),_0x46e603();}catch(_0x3dcf99){_0x46e603(_0x3dcf99);}}}exports[a290_0x18c117(0x223)]=ComponentsDeployer;