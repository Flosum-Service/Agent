const a339_0x7bb222=a339_0x5bb4;(function(_0x48d90d,_0x17d6ee){const _0x53ffb9=a339_0x5bb4,_0x1495b2=_0x48d90d();while(!![]){try{const _0x27bdd8=parseInt(_0x53ffb9(0x1b1))/0x1*(-parseInt(_0x53ffb9(0x1a7))/0x2)+parseInt(_0x53ffb9(0x1c0))/0x3+-parseInt(_0x53ffb9(0x1d3))/0x4*(-parseInt(_0x53ffb9(0x1cc))/0x5)+parseInt(_0x53ffb9(0x194))/0x6+parseInt(_0x53ffb9(0x1b6))/0x7*(parseInt(_0x53ffb9(0x1c9))/0x8)+-parseInt(_0x53ffb9(0x1a6))/0x9*(parseInt(_0x53ffb9(0x1c6))/0xa)+-parseInt(_0x53ffb9(0x1b2))/0xb*(parseInt(_0x53ffb9(0x1af))/0xc);if(_0x27bdd8===_0x17d6ee)break;else _0x1495b2['push'](_0x1495b2['shift']());}catch(_0x4d5201){_0x1495b2['push'](_0x1495b2['shift']());}}}(a339_0x8e70,0x8ddd5));const a339_0x5cc1b0=(function(){let _0x56dc7a=!![];return function(_0x2db9d4,_0x5618de){const _0x450b1d=_0x56dc7a?function(){const _0x376bb5=a339_0x5bb4;if(_0x5618de){const _0x1be2da=_0x5618de[_0x376bb5(0x1a2)](_0x2db9d4,arguments);return _0x5618de=null,_0x1be2da;}}:function(){};return _0x56dc7a=![],_0x450b1d;};}()),a339_0x1230bc=a339_0x5cc1b0(this,function(){const _0x214217=a339_0x5bb4;return a339_0x1230bc[_0x214217(0x1cd)]()[_0x214217(0x1be)](_0x214217(0x1d5))['toString']()[_0x214217(0x1b9)](a339_0x1230bc)[_0x214217(0x1be)](_0x214217(0x1d5));});function a339_0x5bb4(_0x499606,_0x18ad98){const _0x407e21=a339_0x8e70();return a339_0x5bb4=function(_0x1230bc,_0x5cc1b0){_0x1230bc=_0x1230bc-0x192;let _0x8e7063=_0x407e21[_0x1230bc];return _0x8e7063;},a339_0x5bb4(_0x499606,_0x18ad98);}a339_0x1230bc();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x37a84f){const _0x669061=a339_0x5bb4;return _0x37a84f&&_0x37a84f[_0x669061(0x1cf)]?_0x37a84f:{'default':_0x37a84f};};Object['defineProperty'](exports,a339_0x7bb222(0x1cf),{'value':!![]}),exports[a339_0x7bb222(0x1c8)]=void 0x0;function a339_0x8e70(){const _0x1dab1c=['7404529OpwEqy','BINARY_FIELD_NAME','trackingSettingId','changedBy','35CjBdCH','deployAttachments','Status__c','constructor','componentId','fileName','CompositeBinaryDeployData','log','search','deploy','3352356gZdvdg','default','Retrieved','logger','sourceMemberId','Source_Member_Id__c','10DHBuzI','ATTACHMENT_OBJECT_NAME','ComponentsDeployer','967152FeZdFw','addOrgComponentToChunk','nodebuffer','5WqIrrs','toString','targetOrgId','__esModule','binaryRecordsSizeChunk','Writable','fullName','3680128NHfkFE','CompositeConstants','(((.+)+)+)+$','Label__c','createZip','deployOrgComponents','stream','../../constants','Revision_Counter__c','../../../../constants','Component_Type__c','ORG_COMPONENT_OBJECT_NAME','METADATA_FOLDER_MAP','resetChunks','Name__c','isNameObsolete','execute','populateAttachmentId','addAttachmentToChunk','then','attachmentsToDeployChunk','from','3332226BpmJaR','records','instance','isReachedMaxChunk','Last_Updated_By__c','binary','revisionCounter','attachmentId','application/zip','orgComponentsToDeployChunk','FLOSUM_NAMESPACE','has','Folder__c','length','apply','successDeployedCounter','file','error','8534385jRUbhu','994844YpmUfx','Attachment_ID__c','push','handleDeployResult','jszip','update','@flosum/salesforce','API_Name__c','12hBBJHo','type','2RTYtjI'];a339_0x8e70=function(){return _0x1dab1c;};return a339_0x8e70();}const salesforce_1=require(a339_0x7bb222(0x1ad)),constants_1=require(a339_0x7bb222(0x1da)),stream_1=require(a339_0x7bb222(0x1d9)),jszip_1=__importDefault(require(a339_0x7bb222(0x1ab))),constants_2=require(a339_0x7bb222(0x1dc)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a339_0x7bb222(0x19e)]+a339_0x7bb222(0x1a8),CONTENT_TYPE=a339_0x7bb222(0x19c);class ComponentsDeployer extends stream_1[a339_0x7bb222(0x1d1)]{constructor({apiVersion:_0x354d47,instance:_0x41d0db,logger:_0x511e1c,targetOrgId:_0xf2a9cd,trackingSettingId:_0x38b767}){const _0x224295=a339_0x7bb222;super({'objectMode':!![]}),this[_0x224295(0x192)]={'records':[],'binary':[]},this[_0x224295(0x1d0)]=0x0,this[_0x224295(0x19d)]=[],this[_0x224295(0x1a3)]=0x0,this['apiVersion']=_0x354d47,this[_0x224295(0x196)]=_0x41d0db,this[_0x224295(0x1c3)]=_0x511e1c,this[_0x224295(0x1ce)]=_0xf2a9cd,this['trackingSettingId']=_0x38b767;}async['deploy'](){const _0x5bbc14=a339_0x7bb222;await this[_0x5bbc14(0x1b7)]()[_0x5bbc14(0x1e6)](_0x4d937f=>this[_0x5bbc14(0x1e4)](_0x4d937f))[_0x5bbc14(0x1e6)](()=>this[_0x5bbc14(0x1d8)]())[_0x5bbc14(0x1e6)](_0x2fcdfa=>this[_0x5bbc14(0x1aa)](_0x2fcdfa)),this[_0x5bbc14(0x1e0)]();}[a339_0x7bb222(0x1b7)](){const _0x18ac1b=a339_0x7bb222,_0x4e6320=new salesforce_1[(_0x18ac1b(0x1bc))]({'instance':this[_0x18ac1b(0x196)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this['apiVersion']});return _0x4e6320[_0x18ac1b(0x1e3)](this[_0x18ac1b(0x192)]);}[a339_0x7bb222(0x1d8)](){const _0x1fe068=a339_0x7bb222,_0x4c88c9=new salesforce_1['RestSimpleDeployData']({'instance':this[_0x1fe068(0x196)],'objectName':constants_1[_0x1fe068(0x1de)],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0x4c88c9['execute']({'records':this['orgComponentsToDeployChunk']});}async['handleDeployResult'](_0x2a3453){const _0x1cd403=a339_0x7bb222;for(const {success:_0xfa84d5,error:_0x5d00db}of _0x2a3453){if(_0xfa84d5){this['successDeployedCounter']++;continue;}_0x5d00db&&this['logger'][_0x1cd403(0x1a5)](_0x5d00db);}}[a339_0x7bb222(0x197)](_0x49bba9){const _0x37c03b=a339_0x7bb222;return _0x49bba9+this[_0x37c03b(0x1d0)]>=salesforce_1[_0x37c03b(0x1d4)]['MAX_BODY_SIZE']||this[_0x37c03b(0x192)][_0x37c03b(0x195)][_0x37c03b(0x1a1)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x2cddbe=a339_0x7bb222;this[_0x2cddbe(0x1d0)]=0x0,this[_0x2cddbe(0x192)]={'records':[],'binary':[]},this[_0x2cddbe(0x19d)]=[];}[a339_0x7bb222(0x1e4)](_0x3d2374){for(const _0x3ed879 in _0x3d2374){this['orgComponentsToDeployChunk'][_0x3ed879][ATTACHMENT_FIELD_NAME]=_0x3d2374[_0x3ed879]['id'];}}async[a339_0x7bb222(0x1e5)](_0x48c536,_0x2e820c){const _0xecd37b=a339_0x7bb222,{listMetadataItem:_0x5b2ac7,sourceMemberRecord:_0xca59fd}=_0x48c536,_0x402705={'attributes':{'type':constants_1[_0xecd37b(0x1c7)],'binaryPartName':_0x5b2ac7[_0xecd37b(0x1d2)],'binaryPartNameAlias':constants_1[_0xecd37b(0x1b3)]},'Id':_0xca59fd[_0xecd37b(0x19b)],'Name':_0x5b2ac7[_0xecd37b(0x1d2)],'Description':_0x5b2ac7[_0xecd37b(0x1b0)],'ContentType':CONTENT_TYPE,'ParentId':this['targetOrgId'],'Body':_0x5b2ac7[_0xecd37b(0x1d2)]},_0x7fe955={'binaryFieldName':constants_1[_0xecd37b(0x1b3)],'name':_0x5b2ac7[_0xecd37b(0x1d2)],'value':stream_1['Readable'][_0xecd37b(0x193)](_0x2e820c)};this[_0xecd37b(0x192)][_0xecd37b(0x195)][_0xecd37b(0x1a9)](_0x402705),this[_0xecd37b(0x192)][_0xecd37b(0x199)][_0xecd37b(0x1a9)](_0x7fe955);}['createZip'](_0x51db0c){const _0x234bee=a339_0x7bb222,_0x4649fe=new jszip_1[(_0x234bee(0x1c1))]();for(const _0x4bad8e in _0x51db0c){_0x4649fe[_0x234bee(0x1a4)](_0x4bad8e,_0x51db0c[_0x4bad8e]);}return _0x4649fe['generateAsync']({'type':_0x234bee(0x1cb)});}['addOrgComponentToChunk'](_0x4da336,_0x50e3c1){const _0x1b3dac=a339_0x7bb222,_0x46330a={'attributes':{'type':constants_1[_0x1b3dac(0x1de)]},'Id':_0x50e3c1[_0x1b3dac(0x1ba)],[constants_2[_0x1b3dac(0x19e)]+'Is_Deleted__c']:_0x50e3c1[_0x1b3dac(0x1e2)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1db)]:_0x50e3c1[_0x1b3dac(0x19a)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1c5)]:_0x50e3c1[_0x1b3dac(0x1c4)],[constants_2['FLOSUM_NAMESPACE']+_0x1b3dac(0x198)]:_0x50e3c1[_0x1b3dac(0x1b5)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1ae)]:_0x4da336[_0x1b3dac(0x1d2)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1e1)]:_0x4da336[_0x1b3dac(0x1d2)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1dd)]:_0x4da336[_0x1b3dac(0x1b0)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1d6)]:_0x4da336[_0x1b3dac(0x1bb)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1a0)]:constants_1[_0x1b3dac(0x1df)][_0x1b3dac(0x19f)](_0x4da336['type'])||null,[constants_2[_0x1b3dac(0x19e)]+'Is_Retrieved__c']:!![],[constants_2[_0x1b3dac(0x19e)]+'OrganisationName__c']:this[_0x1b3dac(0x1ce)],[constants_2[_0x1b3dac(0x19e)]+'Tracking_Setting__c']:this[_0x1b3dac(0x1b4)],[constants_2[_0x1b3dac(0x19e)]+_0x1b3dac(0x1b8)]:_0x1b3dac(0x1c2)};this[_0x1b3dac(0x19d)][_0x1b3dac(0x1a9)](_0x46330a);}async['_write'](_0x517f79,_0x4b11ac,_0xc8d068){const _0x5936e6=a339_0x7bb222;try{const {listMetadataItem:_0x4ae37e,sourceMemberRecord:_0x5cd21d,files:_0x55a65c}=_0x517f79,_0x3cc4b5=await this[_0x5936e6(0x1d7)](_0x55a65c),_0x5dddaf=Buffer['byteLength'](_0x3cc4b5);this[_0x5936e6(0x197)](_0x5dddaf)&&await this['deploy'](),this[_0x5936e6(0x1d0)]+=_0x5dddaf,await this[_0x5936e6(0x1e5)](_0x517f79,_0x3cc4b5),this[_0x5936e6(0x1ca)](_0x4ae37e,_0x5cd21d),_0xc8d068();}catch(_0xd1be0e){_0xc8d068(_0xd1be0e);}}async['_final'](_0x32777f){const _0x43a6f8=a339_0x7bb222;try{this['attachmentsToDeployChunk'][_0x43a6f8(0x195)][_0x43a6f8(0x1a1)]&&this['orgComponentsToDeployChunk'][_0x43a6f8(0x1a1)]&&await this[_0x43a6f8(0x1bf)](),this[_0x43a6f8(0x1c3)][_0x43a6f8(0x1bd)]('Process\x20completed\x20for\x20'+this[_0x43a6f8(0x1a3)]+'\x20components'),await this[_0x43a6f8(0x1c3)][_0x43a6f8(0x1ac)](),_0x32777f();}catch(_0x4b9a90){_0x32777f(_0x4b9a90);}}}exports[a339_0x7bb222(0x1c8)]=ComponentsDeployer;