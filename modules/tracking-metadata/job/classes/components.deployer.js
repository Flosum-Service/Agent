const a338_0xe9c9bc=a338_0x109b;(function(_0x1ff890,_0x27c719){const _0x3d1209=a338_0x109b,_0xfb1ae1=_0x1ff890();while(!![]){try{const _0xc91d6b=-parseInt(_0x3d1209(0xb6))/0x1*(parseInt(_0x3d1209(0x9f))/0x2)+-parseInt(_0x3d1209(0xc1))/0x3+-parseInt(_0x3d1209(0xdf))/0x4+parseInt(_0x3d1209(0xda))/0x5+-parseInt(_0x3d1209(0xde))/0x6*(parseInt(_0x3d1209(0xe4))/0x7)+-parseInt(_0x3d1209(0xe0))/0x8+parseInt(_0x3d1209(0xbf))/0x9;if(_0xc91d6b===_0x27c719)break;else _0xfb1ae1['push'](_0xfb1ae1['shift']());}catch(_0x5e99ad){_0xfb1ae1['push'](_0xfb1ae1['shift']());}}}(a338_0x3b36,0x4555e));const a338_0x1025d6=(function(){let _0x1040df=!![];return function(_0x51e0fc,_0x403d33){const _0x20c9c8=_0x1040df?function(){const _0x475139=a338_0x109b;if(_0x403d33){const _0x5e1fa5=_0x403d33[_0x475139(0xbd)](_0x51e0fc,arguments);return _0x403d33=null,_0x5e1fa5;}}:function(){};return _0x1040df=![],_0x20c9c8;};}()),a338_0x11c6f9=a338_0x1025d6(this,function(){const _0x393e3c=a338_0x109b;return a338_0x11c6f9[_0x393e3c(0xcc)]()[_0x393e3c(0xd9)]('(((.+)+)+)+$')['toString']()['constructor'](a338_0x11c6f9)['search'](_0x393e3c(0xa3));});function a338_0x109b(_0x346e48,_0xf0c395){const _0x34b05=a338_0x3b36();return a338_0x109b=function(_0x11c6f9,_0x1025d6){_0x11c6f9=_0x11c6f9-0x9b;let _0x3b3683=_0x34b05[_0x11c6f9];return _0x3b3683;},a338_0x109b(_0x346e48,_0xf0c395);}a338_0x11c6f9();'use strict';function a338_0x3b36(){const _0x442ddc=['Source_Member_Id__c','populateAttachmentId','handleDeployResult','CompositeBinaryDeployData','resetChunks','apply','byteLength','13285017BnpoNs','Tracking_Setting__c','689418bpjOTq','_write','length','@flosum/salesforce','Last_Updated_By__c','Component_Type__c','__importDefault','then','Is_Retrieved__c','defineProperty','error','toString','records','addOrgComponentToChunk','revisionCounter','instance','MAX_BODY_SIZE','fileName','orgComponentsToDeployChunk','CompositeConstants','trackingSettingId','generateAsync','Label__c','logger','search','698260bEYXaf','FLOSUM_NAMESPACE','deployOrgComponents','deploy','51540TcnORq','1528824YGWsUt','656448QDUZAB','deployAttachments','API_Name__c','nodebuffer','84XsWFSW','fullName','targetOrgId','default','Readable','addAttachmentToChunk','_final','push','BINARY_FIELD_NAME','__esModule','log','apiVersion','isNameObsolete','binaryRecordsSizeChunk','24866owFMCW','Status__c','OrganisationName__c','type','(((.+)+)+)+$','Revision_Counter__c','../../../../constants','attachmentsToDeployChunk','update','successDeployedCounter','execute','../../constants','changedBy','ATTACHMENT_OBJECT_NAME','ComponentsDeployer','ORG_COMPONENT_OBJECT_NAME','METADATA_FOLDER_MAP','createZip','isReachedMaxChunk','stream','has','\x20components','binary','43AVzARG','Process\x20completed\x20for\x20'];a338_0x3b36=function(){return _0x442ddc;};return a338_0x3b36();}var __importDefault=this&&this[a338_0xe9c9bc(0xc7)]||function(_0x42d4f0){const _0x30884b=a338_0xe9c9bc;return _0x42d4f0&&_0x42d4f0[_0x30884b(0xed)]?_0x42d4f0:{'default':_0x42d4f0};};Object[a338_0xe9c9bc(0xca)](exports,a338_0xe9c9bc(0xed),{'value':!![]}),exports[a338_0xe9c9bc(0xad)]=void 0x0;const salesforce_1=require(a338_0xe9c9bc(0xc4)),constants_1=require(a338_0xe9c9bc(0xaa)),stream_1=require(a338_0xe9c9bc(0xb2)),jszip_1=__importDefault(require('jszip')),constants_2=require(a338_0xe9c9bc(0xa5)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+'Attachment_ID__c',CONTENT_TYPE='application/zip';class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x1c354e,instance:_0x1c6ea4,logger:_0x38b27e,targetOrgId:_0x5eefad,trackingSettingId:_0x299c9a}){const _0x3dc4a2=a338_0xe9c9bc;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x3dc4a2(0xd3)]=[],this[_0x3dc4a2(0xa8)]=0x0,this['apiVersion']=_0x1c354e,this[_0x3dc4a2(0xd0)]=_0x1c6ea4,this[_0x3dc4a2(0xd8)]=_0x38b27e,this[_0x3dc4a2(0xe6)]=_0x5eefad,this[_0x3dc4a2(0xd5)]=_0x299c9a;}async[a338_0xe9c9bc(0xdd)](){const _0x94d58f=a338_0xe9c9bc;await this[_0x94d58f(0xe1)]()[_0x94d58f(0xc8)](_0x178e4c=>this[_0x94d58f(0xb9)](_0x178e4c))[_0x94d58f(0xc8)](()=>this[_0x94d58f(0xdc)]())[_0x94d58f(0xc8)](_0x3a739a=>this[_0x94d58f(0xba)](_0x3a739a)),this['resetChunks']();}[a338_0xe9c9bc(0xe1)](){const _0x20cb36=a338_0xe9c9bc,_0x4e0b28=new salesforce_1[(_0x20cb36(0xbb))]({'instance':this['instance'],'objectName':constants_1[_0x20cb36(0xac)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x20cb36(0x9c)]});return _0x4e0b28[_0x20cb36(0xa9)](this['attachmentsToDeployChunk']);}[a338_0xe9c9bc(0xdc)](){const _0x1746e6=a338_0xe9c9bc,_0xbe2319=new salesforce_1['RestSimpleDeployData']({'instance':this['instance'],'objectName':constants_1[_0x1746e6(0xae)],'api':this[_0x1746e6(0x9c)],'allOrNone':![],'externalIdField':'Id'});return _0xbe2319[_0x1746e6(0xa9)]({'records':this['orgComponentsToDeployChunk']});}async[a338_0xe9c9bc(0xba)](_0xe1a68e){const _0x91faf9=a338_0xe9c9bc;for(const {success:_0xbb394b,error:_0x4e550a}of _0xe1a68e){if(_0xbb394b){this[_0x91faf9(0xa8)]++;continue;}_0x4e550a&&this['logger'][_0x91faf9(0xcb)](_0x4e550a);}}['isReachedMaxChunk'](_0x14a6f6){const _0x2999d7=a338_0xe9c9bc;return _0x14a6f6+this[_0x2999d7(0x9e)]>=salesforce_1[_0x2999d7(0xd4)][_0x2999d7(0xd1)]||this[_0x2999d7(0xa6)][_0x2999d7(0xcd)][_0x2999d7(0xc3)]===MAX_COMPOSITE_CHUNK_COUNT;}[a338_0xe9c9bc(0xbc)](){const _0x242c6f=a338_0xe9c9bc;this[_0x242c6f(0x9e)]=0x0,this[_0x242c6f(0xa6)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a338_0xe9c9bc(0xb9)](_0x59ab84){for(const _0x58e614 in _0x59ab84){this['orgComponentsToDeployChunk'][_0x58e614][ATTACHMENT_FIELD_NAME]=_0x59ab84[_0x58e614]['id'];}}async[a338_0xe9c9bc(0xe9)](_0x2f6c8c,_0x137b6b){const _0xb6db21=a338_0xe9c9bc,{listMetadataItem:_0x329f2d,sourceMemberRecord:_0x310a41}=_0x2f6c8c,_0x156bef={'attributes':{'type':constants_1[_0xb6db21(0xac)],'binaryPartName':_0x329f2d[_0xb6db21(0xe5)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x310a41['attachmentId'],'Name':_0x329f2d[_0xb6db21(0xe5)],'Description':_0x329f2d[_0xb6db21(0xa2)],'ContentType':CONTENT_TYPE,'ParentId':this[_0xb6db21(0xe6)],'Body':_0x329f2d[_0xb6db21(0xe5)]},_0x560924={'binaryFieldName':constants_1[_0xb6db21(0xec)],'name':_0x329f2d[_0xb6db21(0xe5)],'value':stream_1[_0xb6db21(0xe8)]['from'](_0x137b6b)};this[_0xb6db21(0xa6)][_0xb6db21(0xcd)]['push'](_0x156bef),this['attachmentsToDeployChunk'][_0xb6db21(0xb5)]['push'](_0x560924);}['createZip'](_0x12c5e2){const _0x23cbca=a338_0xe9c9bc,_0x466875=new jszip_1[(_0x23cbca(0xe7))]();for(const _0x400471 in _0x12c5e2){_0x466875['file'](_0x400471,_0x12c5e2[_0x400471]);}return _0x466875[_0x23cbca(0xd6)]({'type':_0x23cbca(0xe3)});}[a338_0xe9c9bc(0xce)](_0x28b3e2,_0x18743a){const _0x4609f5=a338_0xe9c9bc,_0x3957dd={'attributes':{'type':constants_1[_0x4609f5(0xae)]},'Id':_0x18743a['componentId'],[constants_2[_0x4609f5(0xdb)]+'Is_Deleted__c']:_0x18743a[_0x4609f5(0x9d)],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xa4)]:_0x18743a[_0x4609f5(0xcf)],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xb8)]:_0x18743a['sourceMemberId'],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xc5)]:_0x18743a[_0x4609f5(0xab)],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xe2)]:_0x28b3e2[_0x4609f5(0xe5)],[constants_2[_0x4609f5(0xdb)]+'Name__c']:_0x28b3e2[_0x4609f5(0xe5)],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xc6)]:_0x28b3e2['type'],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xd7)]:_0x28b3e2[_0x4609f5(0xd2)],[constants_2['FLOSUM_NAMESPACE']+'Folder__c']:constants_1[_0x4609f5(0xaf)][_0x4609f5(0xb3)](_0x28b3e2[_0x4609f5(0xa2)])||null,[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xc9)]:!![],[constants_2['FLOSUM_NAMESPACE']+_0x4609f5(0xa1)]:this['targetOrgId'],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xc0)]:this[_0x4609f5(0xd5)],[constants_2[_0x4609f5(0xdb)]+_0x4609f5(0xa0)]:'Retrieved'};this[_0x4609f5(0xd3)][_0x4609f5(0xeb)](_0x3957dd);}async[a338_0xe9c9bc(0xc2)](_0x1132a4,_0x388c44,_0x1857a1){const _0x4aeca1=a338_0xe9c9bc;try{const {listMetadataItem:_0x57d383,sourceMemberRecord:_0x4dbff5,files:_0x1cec31}=_0x1132a4,_0x5e182d=await this[_0x4aeca1(0xb0)](_0x1cec31),_0x5eaf5e=Buffer[_0x4aeca1(0xbe)](_0x5e182d);this[_0x4aeca1(0xb1)](_0x5eaf5e)&&await this['deploy'](),this[_0x4aeca1(0x9e)]+=_0x5eaf5e,await this[_0x4aeca1(0xe9)](_0x1132a4,_0x5e182d),this[_0x4aeca1(0xce)](_0x57d383,_0x4dbff5),_0x1857a1();}catch(_0x916c54){_0x1857a1(_0x916c54);}}async[a338_0xe9c9bc(0xea)](_0x473a4a){const _0x334ac3=a338_0xe9c9bc;try{this[_0x334ac3(0xa6)][_0x334ac3(0xcd)]['length']&&this[_0x334ac3(0xd3)][_0x334ac3(0xc3)]&&await this['deploy'](),this[_0x334ac3(0xd8)][_0x334ac3(0x9b)](_0x334ac3(0xb7)+this[_0x334ac3(0xa8)]+_0x334ac3(0xb4)),await this[_0x334ac3(0xd8)][_0x334ac3(0xa7)](),_0x473a4a();}catch(_0x11e647){_0x473a4a(_0x11e647);}}}exports[a338_0xe9c9bc(0xad)]=ComponentsDeployer;