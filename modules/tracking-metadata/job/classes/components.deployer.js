const a295_0x28dbf5=a295_0x544c;(function(_0x472686,_0x4b3e40){const _0x469d9e=a295_0x544c,_0x3342ae=_0x472686();while(!![]){try{const _0x18c8bc=parseInt(_0x469d9e(0x108))/0x1+parseInt(_0x469d9e(0x138))/0x2+-parseInt(_0x469d9e(0x133))/0x3*(parseInt(_0x469d9e(0x119))/0x4)+parseInt(_0x469d9e(0xf8))/0x5*(-parseInt(_0x469d9e(0x135))/0x6)+-parseInt(_0x469d9e(0xf5))/0x7*(parseInt(_0x469d9e(0xea))/0x8)+-parseInt(_0x469d9e(0x12b))/0x9*(parseInt(_0x469d9e(0x11a))/0xa)+parseInt(_0x469d9e(0x11d))/0xb*(parseInt(_0x469d9e(0x101))/0xc);if(_0x18c8bc===_0x4b3e40)break;else _0x3342ae['push'](_0x3342ae['shift']());}catch(_0x226af8){_0x3342ae['push'](_0x3342ae['shift']());}}}(a295_0x31c1,0xe61cc));const a295_0x4cd09a=(function(){let _0x4a1c97=!![];return function(_0x43b6eb,_0x462006){const _0x33b901=_0x4a1c97?function(){const _0x594fc9=a295_0x544c;if(_0x462006){const _0x4178cb=_0x462006[_0x594fc9(0x127)](_0x43b6eb,arguments);return _0x462006=null,_0x4178cb;}}:function(){};return _0x4a1c97=![],_0x33b901;};}()),a295_0x4eb653=a295_0x4cd09a(this,function(){const _0x3a1809=a295_0x544c;return a295_0x4eb653[_0x3a1809(0xfc)]()[_0x3a1809(0x12d)]('(((.+)+)+)+$')[_0x3a1809(0xfc)]()[_0x3a1809(0xff)](a295_0x4eb653)[_0x3a1809(0x12d)](_0x3a1809(0x139));});a295_0x4eb653();function a295_0x31c1(){const _0x3e6422=['from','OrganisationName__c','isNameObsolete','__esModule','6113960PXKXht','_final','targetOrgId','nodebuffer','binaryRecordsSizeChunk','attachmentsToDeployChunk','length','Tracking_Setting__c','Source_Member_Id__c','BINARY_FIELD_NAME','RestSimpleDeployData','7xfruEX','Process\x20completed\x20for\x20','Readable','5JlduNw','generateAsync','API_Name__c','instance','toString','handleDeployResult','Attachment_ID__c','constructor','Component_Type__c','240bKuSXp','@flosum/salesforce','type','FLOSUM_NAMESPACE','trackingSettingId','then','deployAttachments','305702Jevdim','Name__c','../../constants','CompositeBinaryDeployData','addOrgComponentToChunk','successDeployedCounter','orgComponentsToDeployChunk','records','ORG_COMPONENT_OBJECT_NAME','jszip','Folder__c','isReachedMaxChunk','application/zip','CompositeConstants','file','error','update','5874956qNkgej','2089970nlKwJM','defineProperty','\x20components','2829266uKbVke','__importDefault','logger','Retrieved','push','execute','has','deployOrgComponents','Last_Updated_By__c','addAttachmentToChunk','apply','log','deploy','stream','63nZYnhB','createZip','search','sourceMemberId','MAX_BODY_SIZE','apiVersion','resetChunks','populateAttachmentId','3uZjqMZ','fullName','10918638hHAlqL','ComponentsDeployer','attachmentId','2016908amjtcO','(((.+)+)+)+$'];a295_0x31c1=function(){return _0x3e6422;};return a295_0x31c1();}function a295_0x544c(_0xf7ca2f,_0x1dfe67){const _0x308a70=a295_0x31c1();return a295_0x544c=function(_0x4eb653,_0x4cd09a){_0x4eb653=_0x4eb653-0xe7;let _0x31c175=_0x308a70[_0x4eb653];return _0x31c175;},a295_0x544c(_0xf7ca2f,_0x1dfe67);}'use strict';var __importDefault=this&&this[a295_0x28dbf5(0x11e)]||function(_0x17e812){const _0x29b5c4=a295_0x28dbf5;return _0x17e812&&_0x17e812[_0x29b5c4(0xe9)]?_0x17e812:{'default':_0x17e812};};Object[a295_0x28dbf5(0x11b)](exports,a295_0x28dbf5(0xe9),{'value':!![]}),exports[a295_0x28dbf5(0x136)]=void 0x0;const salesforce_1=require(a295_0x28dbf5(0x102)),constants_1=require(a295_0x28dbf5(0x10a)),stream_1=require(a295_0x28dbf5(0x12a)),jszip_1=__importDefault(require(a295_0x28dbf5(0x111))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a295_0x28dbf5(0xfe),CONTENT_TYPE=a295_0x28dbf5(0x114);class ComponentsDeployer extends stream_1['Writable']{constructor({apiVersion:_0x32e0a5,instance:_0x160726,logger:_0xc8b4ad,targetOrgId:_0x4b9585,trackingSettingId:_0x118729}){const _0x303588=a295_0x28dbf5;super({'objectMode':!![]}),this[_0x303588(0xef)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x303588(0x10e)]=[],this['successDeployedCounter']=0x0,this[_0x303588(0x130)]=_0x32e0a5,this[_0x303588(0xfb)]=_0x160726,this['logger']=_0xc8b4ad,this[_0x303588(0xec)]=_0x4b9585,this[_0x303588(0x105)]=_0x118729;}async['deploy'](){const _0x19c6f3=a295_0x28dbf5;await this[_0x19c6f3(0x107)]()[_0x19c6f3(0x106)](_0x44620b=>this[_0x19c6f3(0x132)](_0x44620b))[_0x19c6f3(0x106)](()=>this[_0x19c6f3(0x124)]())[_0x19c6f3(0x106)](_0x4867f1=>this[_0x19c6f3(0xfd)](_0x4867f1)),this[_0x19c6f3(0x131)]();}[a295_0x28dbf5(0x107)](){const _0x125759=a295_0x28dbf5,_0x37acce=new salesforce_1[(_0x125759(0x10b))]({'instance':this[_0x125759(0xfb)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x125759(0x130)]});return _0x37acce[_0x125759(0x122)](this['attachmentsToDeployChunk']);}['deployOrgComponents'](){const _0x5e3f5b=a295_0x28dbf5,_0x3b3670=new salesforce_1[(_0x5e3f5b(0xf4))]({'instance':this[_0x5e3f5b(0xfb)],'objectName':constants_1[_0x5e3f5b(0x110)],'api':this[_0x5e3f5b(0x130)],'allOrNone':![],'externalIdField':'Id'});return _0x3b3670[_0x5e3f5b(0x122)]({'records':this[_0x5e3f5b(0x10e)]});}async[a295_0x28dbf5(0xfd)](_0x4c892a){const _0x20bb39=a295_0x28dbf5;for(const {success:_0x1b20ad,error:_0x344310}of _0x4c892a){if(_0x1b20ad){this[_0x20bb39(0x10d)]++;continue;}_0x344310&&this['logger'][_0x20bb39(0x117)](_0x344310);}}[a295_0x28dbf5(0x113)](_0x5a43ff){const _0x2ab739=a295_0x28dbf5;return _0x5a43ff+this[_0x2ab739(0xee)]>=salesforce_1[_0x2ab739(0x115)][_0x2ab739(0x12f)]||this[_0x2ab739(0xef)][_0x2ab739(0x10f)][_0x2ab739(0xf0)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x2af63e=a295_0x28dbf5;this[_0x2af63e(0xee)]=0x0,this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x2af63e(0x10e)]=[];}[a295_0x28dbf5(0x132)](_0x3b63c9){for(const _0x12c99d in _0x3b63c9){this['orgComponentsToDeployChunk'][_0x12c99d][ATTACHMENT_FIELD_NAME]=_0x3b63c9[_0x12c99d]['id'];}}async[a295_0x28dbf5(0x126)](_0x3fd82b,_0x1f6c5d){const _0x1f1189=a295_0x28dbf5,{listMetadataItem:_0x14f472,sourceMemberRecord:_0x180269}=_0x3fd82b,_0x717807={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x14f472[_0x1f1189(0x134)],'binaryPartNameAlias':constants_1[_0x1f1189(0xf3)]},'Id':_0x180269[_0x1f1189(0x137)],'Name':_0x14f472['fullName'],'Description':_0x14f472[_0x1f1189(0x103)],'ContentType':CONTENT_TYPE,'ParentId':this['targetOrgId'],'Body':_0x14f472[_0x1f1189(0x134)]},_0x1ec0cb={'binaryFieldName':constants_1[_0x1f1189(0xf3)],'name':_0x14f472['fullName'],'value':stream_1[_0x1f1189(0xf7)][_0x1f1189(0x13a)](_0x1f6c5d)};this[_0x1f1189(0xef)][_0x1f1189(0x10f)][_0x1f1189(0x121)](_0x717807),this[_0x1f1189(0xef)]['binary'][_0x1f1189(0x121)](_0x1ec0cb);}[a295_0x28dbf5(0x12c)](_0x23b692){const _0x381917=a295_0x28dbf5,_0x4f4b35=new jszip_1['default']();for(const _0x5d3cc5 in _0x23b692){_0x4f4b35[_0x381917(0x116)](_0x5d3cc5,_0x23b692[_0x5d3cc5]);}return _0x4f4b35[_0x381917(0xf9)]({'type':_0x381917(0xed)});}[a295_0x28dbf5(0x10c)](_0x29ce9b,_0x267e52){const _0x1ea6b3=a295_0x28dbf5,_0x903e42={'attributes':{'type':constants_1[_0x1ea6b3(0x110)]},'Id':_0x267e52['componentId'],[constants_2[_0x1ea6b3(0x104)]+'Is_Deleted__c']:_0x267e52[_0x1ea6b3(0xe8)],[constants_2[_0x1ea6b3(0x104)]+'Revision_Counter__c']:_0x267e52['revisionCounter'],[constants_2[_0x1ea6b3(0x104)]+_0x1ea6b3(0xf2)]:_0x267e52[_0x1ea6b3(0x12e)],[constants_2[_0x1ea6b3(0x104)]+_0x1ea6b3(0x125)]:_0x267e52['changedBy'],[constants_2[_0x1ea6b3(0x104)]+_0x1ea6b3(0xfa)]:_0x29ce9b[_0x1ea6b3(0x134)],[constants_2[_0x1ea6b3(0x104)]+_0x1ea6b3(0x109)]:_0x29ce9b[_0x1ea6b3(0x134)],[constants_2[_0x1ea6b3(0x104)]+_0x1ea6b3(0x100)]:_0x29ce9b[_0x1ea6b3(0x103)],[constants_2[_0x1ea6b3(0x104)]+'Label__c']:_0x29ce9b['fileName'],[constants_2[_0x1ea6b3(0x104)]+_0x1ea6b3(0x112)]:constants_1['METADATA_FOLDER_MAP'][_0x1ea6b3(0x123)](_0x29ce9b[_0x1ea6b3(0x103)])||null,[constants_2[_0x1ea6b3(0x104)]+'Is_Retrieved__c']:!![],[constants_2[_0x1ea6b3(0x104)]+_0x1ea6b3(0xe7)]:this['targetOrgId'],[constants_2['FLOSUM_NAMESPACE']+_0x1ea6b3(0xf1)]:this[_0x1ea6b3(0x105)],[constants_2[_0x1ea6b3(0x104)]+'Status__c']:_0x1ea6b3(0x120)};this['orgComponentsToDeployChunk'][_0x1ea6b3(0x121)](_0x903e42);}async['_write'](_0x388dc5,_0x7d9edd,_0x391ddc){const _0x152493=a295_0x28dbf5;try{const {listMetadataItem:_0x3d2c9c,sourceMemberRecord:_0x14a094,files:_0x20fb9e}=_0x388dc5,_0x38cca4=await this[_0x152493(0x12c)](_0x20fb9e),_0x25dd7a=Buffer['byteLength'](_0x38cca4);this[_0x152493(0x113)](_0x25dd7a)&&await this['deploy'](),this['binaryRecordsSizeChunk']+=_0x25dd7a,await this[_0x152493(0x126)](_0x388dc5,_0x38cca4),this[_0x152493(0x10c)](_0x3d2c9c,_0x14a094),_0x391ddc();}catch(_0x329c52){_0x391ddc(_0x329c52);}}async[a295_0x28dbf5(0xeb)](_0x372bd6){const _0x5cd5e4=a295_0x28dbf5;try{this[_0x5cd5e4(0xef)]['records'][_0x5cd5e4(0xf0)]&&this[_0x5cd5e4(0x10e)][_0x5cd5e4(0xf0)]&&await this[_0x5cd5e4(0x129)](),this['logger'][_0x5cd5e4(0x128)](_0x5cd5e4(0xf6)+this[_0x5cd5e4(0x10d)]+_0x5cd5e4(0x11c)),await this[_0x5cd5e4(0x11f)][_0x5cd5e4(0x118)](),_0x372bd6();}catch(_0x8f3fea){_0x372bd6(_0x8f3fea);}}}exports['ComponentsDeployer']=ComponentsDeployer;