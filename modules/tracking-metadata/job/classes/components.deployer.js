const a326_0x3ea7f6=a326_0x2be0;(function(_0x5eee91,_0x3f5784){const _0x300fa4=a326_0x2be0,_0x459b19=_0x5eee91();while(!![]){try{const _0x53e7cd=-parseInt(_0x300fa4(0x1e8))/0x1+parseInt(_0x300fa4(0x1fa))/0x2*(parseInt(_0x300fa4(0x1e1))/0x3)+parseInt(_0x300fa4(0x1bb))/0x4+-parseInt(_0x300fa4(0x1d7))/0x5+-parseInt(_0x300fa4(0x1dc))/0x6*(parseInt(_0x300fa4(0x1cb))/0x7)+parseInt(_0x300fa4(0x202))/0x8*(parseInt(_0x300fa4(0x1ba))/0x9)+parseInt(_0x300fa4(0x1eb))/0xa;if(_0x53e7cd===_0x3f5784)break;else _0x459b19['push'](_0x459b19['shift']());}catch(_0x5a39a8){_0x459b19['push'](_0x459b19['shift']());}}}(a326_0x4868,0x1fff2));function a326_0x2be0(_0x1f4bbe,_0x395bf4){const _0x1d8193=a326_0x4868();return a326_0x2be0=function(_0x42af82,_0x44ad59){_0x42af82=_0x42af82-0x1b8;let _0x48688d=_0x1d8193[_0x42af82];return _0x48688d;},a326_0x2be0(_0x1f4bbe,_0x395bf4);}function a326_0x4868(){const _0x3877d0=['binaryRecordsSizeChunk','records','142806hTazcH','createZip','toString','API_Name__c','MAX_BODY_SIZE','Is_Deleted__c','fileName','217326lPkNms','search','Label__c','2062940fhHcrB','length','Is_Retrieved__c','OrganisationName__c','attachmentsToDeployChunk','update','error','file','__esModule','\x20components','Status__c','deploy','application/zip','resetChunks','Retrieved','4tQDtEd','orgComponentsToDeployChunk','FLOSUM_NAMESPACE','Folder__c','push','@flosum/salesforce','jszip','defineProperty','29864lfXSss','execute','stream','addOrgComponentToChunk','Writable','targetOrgId','constructor','generateAsync','99OESwwZ','784664xtRcgm','ComponentsDeployer','Tracking_Setting__c','then','logger','successDeployedCounter','RestSimpleDeployData','isReachedMaxChunk','Name__c','_write','apiVersion','attachmentId','_final','__importDefault','../../constants','(((.+)+)+)+$','686581EPbHIJ','ORG_COMPONENT_OBJECT_NAME','trackingSettingId','deployAttachments','type','handleDeployResult','log','METADATA_FOLDER_MAP','instance','componentId','../../../../constants','sourceMemberId','461300ZBdGXS','BINARY_FIELD_NAME','fullName','populateAttachmentId','addAttachmentToChunk','6agswGF','ATTACHMENT_OBJECT_NAME','Source_Member_Id__c'];a326_0x4868=function(){return _0x3877d0;};return a326_0x4868();}const a326_0x44ad59=(function(){let _0x45e7c6=!![];return function(_0x4a5f5c,_0x176f7d){const _0x2e7b33=_0x45e7c6?function(){if(_0x176f7d){const _0x2ccd06=_0x176f7d['apply'](_0x4a5f5c,arguments);return _0x176f7d=null,_0x2ccd06;}}:function(){};return _0x45e7c6=![],_0x2e7b33;};}()),a326_0x42af82=a326_0x44ad59(this,function(){const _0x94f3c3=a326_0x2be0;return a326_0x42af82[_0x94f3c3(0x1e3)]()[_0x94f3c3(0x1e9)]('(((.+)+)+)+$')['toString']()[_0x94f3c3(0x1b8)](a326_0x42af82)[_0x94f3c3(0x1e9)](_0x94f3c3(0x1ca));});a326_0x42af82();'use strict';var __importDefault=this&&this[a326_0x3ea7f6(0x1c8)]||function(_0x285167){const _0x30a746=a326_0x3ea7f6;return _0x285167&&_0x285167[_0x30a746(0x1f3)]?_0x285167:{'default':_0x285167};};Object[a326_0x3ea7f6(0x201)](exports,'__esModule',{'value':!![]}),exports[a326_0x3ea7f6(0x1bc)]=void 0x0;const salesforce_1=require(a326_0x3ea7f6(0x1ff)),constants_1=require(a326_0x3ea7f6(0x1c9)),stream_1=require(a326_0x3ea7f6(0x204)),jszip_1=__importDefault(require(a326_0x3ea7f6(0x200))),constants_2=require(a326_0x3ea7f6(0x1d5)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a326_0x3ea7f6(0x1fc)]+'Attachment_ID__c',CONTENT_TYPE=a326_0x3ea7f6(0x1f7);class ComponentsDeployer extends stream_1[a326_0x3ea7f6(0x206)]{constructor({apiVersion:_0x591a9a,instance:_0x1db35,logger:_0x135e3f,targetOrgId:_0x455d13,trackingSettingId:_0x3cca9a}){const _0x4eb3ad=a326_0x3ea7f6;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this[_0x4eb3ad(0x1df)]=0x0,this[_0x4eb3ad(0x1fb)]=[],this[_0x4eb3ad(0x1c0)]=0x0,this[_0x4eb3ad(0x1c5)]=_0x591a9a,this[_0x4eb3ad(0x1d3)]=_0x1db35,this['logger']=_0x135e3f,this[_0x4eb3ad(0x207)]=_0x455d13,this[_0x4eb3ad(0x1cd)]=_0x3cca9a;}async[a326_0x3ea7f6(0x1f6)](){const _0x185b6e=a326_0x3ea7f6;await this[_0x185b6e(0x1ce)]()[_0x185b6e(0x1be)](_0x1e3eff=>this[_0x185b6e(0x1da)](_0x1e3eff))[_0x185b6e(0x1be)](()=>this['deployOrgComponents']())[_0x185b6e(0x1be)](_0x2933ee=>this[_0x185b6e(0x1d0)](_0x2933ee)),this[_0x185b6e(0x1f8)]();}[a326_0x3ea7f6(0x1ce)](){const _0x2b799f=a326_0x3ea7f6,_0x415e12=new salesforce_1['CompositeBinaryDeployData']({'instance':this[_0x2b799f(0x1d3)],'objectName':constants_1[_0x2b799f(0x1dd)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x2b799f(0x1c5)]});return _0x415e12[_0x2b799f(0x203)](this['attachmentsToDeployChunk']);}['deployOrgComponents'](){const _0xdf8bae=a326_0x3ea7f6,_0x1967ee=new salesforce_1[(_0xdf8bae(0x1c1))]({'instance':this[_0xdf8bae(0x1d3)],'objectName':constants_1[_0xdf8bae(0x1cc)],'api':this[_0xdf8bae(0x1c5)],'allOrNone':![],'externalIdField':'Id'});return _0x1967ee['execute']({'records':this[_0xdf8bae(0x1fb)]});}async[a326_0x3ea7f6(0x1d0)](_0x24de2f){const _0x13996a=a326_0x3ea7f6;for(const {success:_0x2f3659,error:_0xa29c0e}of _0x24de2f){if(_0x2f3659){this[_0x13996a(0x1c0)]++;continue;}_0xa29c0e&&this[_0x13996a(0x1bf)][_0x13996a(0x1f1)](_0xa29c0e);}}[a326_0x3ea7f6(0x1c2)](_0x16c4c3){const _0x1ab7f5=a326_0x3ea7f6;return _0x16c4c3+this['binaryRecordsSizeChunk']>=salesforce_1['CompositeConstants'][_0x1ab7f5(0x1e5)]||this[_0x1ab7f5(0x1ef)]['records'][_0x1ab7f5(0x1ec)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x24bb91=a326_0x3ea7f6;this[_0x24bb91(0x1df)]=0x0,this[_0x24bb91(0x1ef)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}[a326_0x3ea7f6(0x1da)](_0x27c580){const _0x232f95=a326_0x3ea7f6;for(const _0x3c54b4 in _0x27c580){this[_0x232f95(0x1fb)][_0x3c54b4][ATTACHMENT_FIELD_NAME]=_0x27c580[_0x3c54b4]['id'];}}async[a326_0x3ea7f6(0x1db)](_0x45ba86,_0x270903){const _0x29a54c=a326_0x3ea7f6,{listMetadataItem:_0x1c4d44,sourceMemberRecord:_0x1329c6}=_0x45ba86,_0x324d55={'attributes':{'type':constants_1[_0x29a54c(0x1dd)],'binaryPartName':_0x1c4d44[_0x29a54c(0x1d9)],'binaryPartNameAlias':constants_1[_0x29a54c(0x1d8)]},'Id':_0x1329c6[_0x29a54c(0x1c6)],'Name':_0x1c4d44[_0x29a54c(0x1d9)],'Description':_0x1c4d44[_0x29a54c(0x1cf)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x29a54c(0x207)],'Body':_0x1c4d44[_0x29a54c(0x1d9)]},_0x244605={'binaryFieldName':constants_1['BINARY_FIELD_NAME'],'name':_0x1c4d44[_0x29a54c(0x1d9)],'value':stream_1['Readable']['from'](_0x270903)};this[_0x29a54c(0x1ef)]['records'][_0x29a54c(0x1fe)](_0x324d55),this['attachmentsToDeployChunk']['binary'][_0x29a54c(0x1fe)](_0x244605);}[a326_0x3ea7f6(0x1e2)](_0x5ce755){const _0x5cad7c=a326_0x3ea7f6,_0x5e8a64=new jszip_1['default']();for(const _0x20a74c in _0x5ce755){_0x5e8a64[_0x5cad7c(0x1f2)](_0x20a74c,_0x5ce755[_0x20a74c]);}return _0x5e8a64[_0x5cad7c(0x1b9)]({'type':'nodebuffer'});}[a326_0x3ea7f6(0x205)](_0x3fe8a3,_0x23f66b){const _0x1ee60d=a326_0x3ea7f6,_0x3bca07={'attributes':{'type':constants_1['ORG_COMPONENT_OBJECT_NAME']},'Id':_0x23f66b[_0x1ee60d(0x1d4)],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1e6)]:_0x23f66b['isNameObsolete'],[constants_2[_0x1ee60d(0x1fc)]+'Revision_Counter__c']:_0x23f66b['revisionCounter'],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1de)]:_0x23f66b[_0x1ee60d(0x1d6)],[constants_2[_0x1ee60d(0x1fc)]+'Last_Updated_By__c']:_0x23f66b['changedBy'],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1e4)]:_0x3fe8a3['fullName'],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1c3)]:_0x3fe8a3['fullName'],[constants_2['FLOSUM_NAMESPACE']+'Component_Type__c']:_0x3fe8a3['type'],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1ea)]:_0x3fe8a3[_0x1ee60d(0x1e7)],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1fd)]:constants_1[_0x1ee60d(0x1d2)]['has'](_0x3fe8a3['type'])||null,[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1ed)]:!![],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1ee)]:this[_0x1ee60d(0x207)],[constants_2[_0x1ee60d(0x1fc)]+_0x1ee60d(0x1bd)]:this['trackingSettingId'],[constants_2['FLOSUM_NAMESPACE']+_0x1ee60d(0x1f5)]:_0x1ee60d(0x1f9)};this[_0x1ee60d(0x1fb)][_0x1ee60d(0x1fe)](_0x3bca07);}async[a326_0x3ea7f6(0x1c4)](_0x2f54ca,_0x576120,_0x66a77c){const _0x10199b=a326_0x3ea7f6;try{const {listMetadataItem:_0x2c1ae9,sourceMemberRecord:_0x262eb4,files:_0x5ddf19}=_0x2f54ca,_0x117459=await this[_0x10199b(0x1e2)](_0x5ddf19),_0x1c6616=Buffer['byteLength'](_0x117459);this['isReachedMaxChunk'](_0x1c6616)&&await this['deploy'](),this[_0x10199b(0x1df)]+=_0x1c6616,await this[_0x10199b(0x1db)](_0x2f54ca,_0x117459),this[_0x10199b(0x205)](_0x2c1ae9,_0x262eb4),_0x66a77c();}catch(_0x3acbee){_0x66a77c(_0x3acbee);}}async[a326_0x3ea7f6(0x1c7)](_0x5eb60a){const _0x2a5f59=a326_0x3ea7f6;try{this[_0x2a5f59(0x1ef)][_0x2a5f59(0x1e0)][_0x2a5f59(0x1ec)]&&this['orgComponentsToDeployChunk'][_0x2a5f59(0x1ec)]&&await this[_0x2a5f59(0x1f6)](),this[_0x2a5f59(0x1bf)][_0x2a5f59(0x1d1)]('Process\x20completed\x20for\x20'+this[_0x2a5f59(0x1c0)]+_0x2a5f59(0x1f4)),await this['logger'][_0x2a5f59(0x1f0)](),_0x5eb60a();}catch(_0x341004){_0x5eb60a(_0x341004);}}}exports[a326_0x3ea7f6(0x1bc)]=ComponentsDeployer;