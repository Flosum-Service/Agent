const a339_0x42ca7c=a339_0x4fe2;(function(_0x5a497a,_0x35ba9){const _0x26d41d=a339_0x4fe2,_0x2c3e73=_0x5a497a();while(!![]){try{const _0x36b645=parseInt(_0x26d41d(0x1c1))/0x1+parseInt(_0x26d41d(0x1d8))/0x2+-parseInt(_0x26d41d(0x1c4))/0x3*(-parseInt(_0x26d41d(0x1f7))/0x4)+parseInt(_0x26d41d(0x1e7))/0x5+-parseInt(_0x26d41d(0x1eb))/0x6*(-parseInt(_0x26d41d(0x1ab))/0x7)+-parseInt(_0x26d41d(0x1b8))/0x8*(-parseInt(_0x26d41d(0x1ec))/0x9)+parseInt(_0x26d41d(0x1d5))/0xa*(-parseInt(_0x26d41d(0x1d4))/0xb);if(_0x36b645===_0x35ba9)break;else _0x2c3e73['push'](_0x2c3e73['shift']());}catch(_0x69a853){_0x2c3e73['push'](_0x2c3e73['shift']());}}}(a339_0x1184,0x46c01));const a339_0x2a7d1e=(function(){let _0xe5a0e0=!![];return function(_0x516c23,_0x430aa5){const _0x4a6275=_0xe5a0e0?function(){const _0x18e446=a339_0x4fe2;if(_0x430aa5){const _0x1d71f1=_0x430aa5[_0x18e446(0x1bd)](_0x516c23,arguments);return _0x430aa5=null,_0x1d71f1;}}:function(){};return _0xe5a0e0=![],_0x4a6275;};}()),a339_0x570c54=a339_0x2a7d1e(this,function(){const _0xb5262a=a339_0x4fe2;return a339_0x570c54[_0xb5262a(0x1da)]()['search'](_0xb5262a(0x1d0))[_0xb5262a(0x1da)]()[_0xb5262a(0x1dc)](a339_0x570c54)[_0xb5262a(0x1f1)](_0xb5262a(0x1d0));});a339_0x570c54();'use strict';function a339_0x4fe2(_0x585ee,_0x1e495f){const _0x56dc83=a339_0x1184();return a339_0x4fe2=function(_0x570c54,_0x2a7d1e){_0x570c54=_0x570c54-0x1a5;let _0x1184be=_0x56dc83[_0x570c54];return _0x1184be;},a339_0x4fe2(_0x585ee,_0x1e495f);}var __importDefault=this&&this[a339_0x42ca7c(0x1bc)]||function(_0xaadfcd){const _0x3dfaab=a339_0x42ca7c;return _0xaadfcd&&_0xaadfcd[_0x3dfaab(0x1c5)]?_0xaadfcd:{'default':_0xaadfcd};};Object[a339_0x42ca7c(0x1b1)](exports,'__esModule',{'value':!![]}),exports[a339_0x42ca7c(0x1e3)]=void 0x0;const salesforce_1=require(a339_0x42ca7c(0x1f0)),constants_1=require('../../constants'),stream_1=require(a339_0x42ca7c(0x1df)),jszip_1=__importDefault(require(a339_0x42ca7c(0x1cf))),constants_2=require(a339_0x42ca7c(0x1f2)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a339_0x42ca7c(0x1dd)]+'Attachment_ID__c',CONTENT_TYPE=a339_0x42ca7c(0x1d2);class ComponentsDeployer extends stream_1[a339_0x42ca7c(0x1ca)]{constructor({apiVersion:_0x144c23,instance:_0x46c41a,logger:_0xb1411a,targetOrgId:_0x51b0db,trackingSettingId:_0x384a2c}){const _0x2b089a=a339_0x42ca7c;super({'objectMode':!![]}),this[_0x2b089a(0x1a7)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this['orgComponentsToDeployChunk']=[],this['successDeployedCounter']=0x0,this[_0x2b089a(0x1cd)]=_0x144c23,this['instance']=_0x46c41a,this[_0x2b089a(0x1bb)]=_0xb1411a,this[_0x2b089a(0x1e6)]=_0x51b0db,this[_0x2b089a(0x1aa)]=_0x384a2c;}async[a339_0x42ca7c(0x1ba)](){const _0x2b96cc=a339_0x42ca7c;await this['deployAttachments']()[_0x2b96cc(0x1bf)](_0x12a2ca=>this[_0x2b96cc(0x1e1)](_0x12a2ca))['then'](()=>this[_0x2b96cc(0x1d9)]())['then'](_0x1d9b7f=>this['handleDeployResult'](_0x1d9b7f)),this[_0x2b96cc(0x1b6)]();}[a339_0x42ca7c(0x1c0)](){const _0x4a4654=a339_0x42ca7c,_0x1fe036=new salesforce_1[(_0x4a4654(0x1cc))]({'instance':this[_0x4a4654(0x1cb)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x4a4654(0x1cd)]});return _0x1fe036[_0x4a4654(0x1e5)](this[_0x4a4654(0x1a7)]);}['deployOrgComponents'](){const _0x108682=a339_0x42ca7c,_0x2fdee7=new salesforce_1[(_0x108682(0x1f6))]({'instance':this[_0x108682(0x1cb)],'objectName':constants_1[_0x108682(0x1d7)],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0x2fdee7[_0x108682(0x1e5)]({'records':this[_0x108682(0x1c2)]});}async[a339_0x42ca7c(0x1d1)](_0x5b9c85){const _0x1e30f8=a339_0x42ca7c;for(const {success:_0x3bb95b,error:_0x25b030}of _0x5b9c85){if(_0x3bb95b){this['successDeployedCounter']++;continue;}_0x25b030&&this['logger'][_0x1e30f8(0x1f4)](_0x25b030);}}['isReachedMaxChunk'](_0x52349c){const _0x23a17d=a339_0x42ca7c;return _0x52349c+this[_0x23a17d(0x1a5)]>=salesforce_1[_0x23a17d(0x1e8)][_0x23a17d(0x1b5)]||this[_0x23a17d(0x1a7)][_0x23a17d(0x1ea)][_0x23a17d(0x1f8)]===MAX_COMPOSITE_CHUNK_COUNT;}[a339_0x42ca7c(0x1b6)](){const _0x3184bc=a339_0x42ca7c;this[_0x3184bc(0x1a5)]=0x0,this[_0x3184bc(0x1a7)]={'records':[],'binary':[]},this[_0x3184bc(0x1c2)]=[];}[a339_0x42ca7c(0x1e1)](_0x13eff8){const _0x38a5ed=a339_0x42ca7c;for(const _0xa9b1d1 in _0x13eff8){this[_0x38a5ed(0x1c2)][_0xa9b1d1][ATTACHMENT_FIELD_NAME]=_0x13eff8[_0xa9b1d1]['id'];}}async[a339_0x42ca7c(0x1b0)](_0x42788c,_0x1f820c){const _0x123f7d=a339_0x42ca7c,{listMetadataItem:_0x532873,sourceMemberRecord:_0x315c07}=_0x42788c,_0x21383e={'attributes':{'type':constants_1[_0x123f7d(0x1ac)],'binaryPartName':_0x532873['fullName'],'binaryPartNameAlias':constants_1[_0x123f7d(0x1c8)]},'Id':_0x315c07[_0x123f7d(0x1a9)],'Name':_0x532873[_0x123f7d(0x1d3)],'Description':_0x532873['type'],'ContentType':CONTENT_TYPE,'ParentId':this['targetOrgId'],'Body':_0x532873[_0x123f7d(0x1d3)]},_0x3c7179={'binaryFieldName':constants_1[_0x123f7d(0x1c8)],'name':_0x532873[_0x123f7d(0x1d3)],'value':stream_1[_0x123f7d(0x1be)][_0x123f7d(0x1ef)](_0x1f820c)};this[_0x123f7d(0x1a7)][_0x123f7d(0x1ea)][_0x123f7d(0x1f3)](_0x21383e),this[_0x123f7d(0x1a7)]['binary']['push'](_0x3c7179);}[a339_0x42ca7c(0x1b2)](_0x3098da){const _0x3568e4=a339_0x42ca7c,_0xc5d97f=new jszip_1['default']();for(const _0x4cab42 in _0x3098da){_0xc5d97f[_0x3568e4(0x1b9)](_0x4cab42,_0x3098da[_0x4cab42]);}return _0xc5d97f[_0x3568e4(0x1c6)]({'type':_0x3568e4(0x1db)});}[a339_0x42ca7c(0x1e2)](_0x1fb8f6,_0x27d1af){const _0x2388b9=a339_0x42ca7c,_0x21fc47={'attributes':{'type':constants_1[_0x2388b9(0x1d7)]},'Id':_0x27d1af['componentId'],[constants_2[_0x2388b9(0x1dd)]+_0x2388b9(0x1de)]:_0x27d1af[_0x2388b9(0x1ae)],[constants_2[_0x2388b9(0x1dd)]+_0x2388b9(0x1f5)]:_0x27d1af['revisionCounter'],[constants_2[_0x2388b9(0x1dd)]+'Source_Member_Id__c']:_0x27d1af[_0x2388b9(0x1e4)],[constants_2[_0x2388b9(0x1dd)]+_0x2388b9(0x1c7)]:_0x27d1af['changedBy'],[constants_2[_0x2388b9(0x1dd)]+_0x2388b9(0x1ad)]:_0x1fb8f6['fullName'],[constants_2[_0x2388b9(0x1dd)]+'Name__c']:_0x1fb8f6['fullName'],[constants_2['FLOSUM_NAMESPACE']+_0x2388b9(0x1c3)]:_0x1fb8f6[_0x2388b9(0x1d6)],[constants_2[_0x2388b9(0x1dd)]+_0x2388b9(0x1b4)]:_0x1fb8f6[_0x2388b9(0x1a8)],[constants_2[_0x2388b9(0x1dd)]+_0x2388b9(0x1b7)]:constants_1['METADATA_FOLDER_MAP'][_0x2388b9(0x1ee)](_0x1fb8f6[_0x2388b9(0x1d6)])||null,[constants_2['FLOSUM_NAMESPACE']+_0x2388b9(0x1a6)]:!![],[constants_2['FLOSUM_NAMESPACE']+'OrganisationName__c']:this[_0x2388b9(0x1e6)],[constants_2[_0x2388b9(0x1dd)]+_0x2388b9(0x1c9)]:this[_0x2388b9(0x1aa)],[constants_2[_0x2388b9(0x1dd)]+'Status__c']:_0x2388b9(0x1af)};this['orgComponentsToDeployChunk']['push'](_0x21fc47);}async[a339_0x42ca7c(0x1e9)](_0x57b99e,_0x46c13b,_0x42012b){const _0x2823ec=a339_0x42ca7c;try{const {listMetadataItem:_0x24a008,sourceMemberRecord:_0x4266d7,files:_0x1aab05}=_0x57b99e,_0x585e49=await this[_0x2823ec(0x1b2)](_0x1aab05),_0x576e0f=Buffer[_0x2823ec(0x1ed)](_0x585e49);this[_0x2823ec(0x1ce)](_0x576e0f)&&await this[_0x2823ec(0x1ba)](),this[_0x2823ec(0x1a5)]+=_0x576e0f,await this[_0x2823ec(0x1b0)](_0x57b99e,_0x585e49),this[_0x2823ec(0x1e2)](_0x24a008,_0x4266d7),_0x42012b();}catch(_0x541385){_0x42012b(_0x541385);}}async['_final'](_0x46c530){const _0x1464b9=a339_0x42ca7c;try{this[_0x1464b9(0x1a7)][_0x1464b9(0x1ea)][_0x1464b9(0x1f8)]&&this[_0x1464b9(0x1c2)][_0x1464b9(0x1f8)]&&await this[_0x1464b9(0x1ba)](),this[_0x1464b9(0x1bb)]['log']('Process\x20completed\x20for\x20'+this[_0x1464b9(0x1b3)]+'\x20components'),await this[_0x1464b9(0x1bb)][_0x1464b9(0x1e0)](),_0x46c530();}catch(_0x66dc0b){_0x46c530(_0x66dc0b);}}}function a339_0x1184(){const _0x3e384d=['Is_Deleted__c','stream','update','populateAttachmentId','addOrgComponentToChunk','ComponentsDeployer','sourceMemberId','execute','targetOrgId','826710rpzmwM','CompositeConstants','_write','records','6AwUCeO','1018701sHxeEr','byteLength','has','from','@flosum/salesforce','search','../../../../constants','push','error','Revision_Counter__c','RestSimpleDeployData','1686684BUrMcX','length','binaryRecordsSizeChunk','Is_Retrieved__c','attachmentsToDeployChunk','fileName','attachmentId','trackingSettingId','3685038XVaLut','ATTACHMENT_OBJECT_NAME','API_Name__c','isNameObsolete','Retrieved','addAttachmentToChunk','defineProperty','createZip','successDeployedCounter','Label__c','MAX_BODY_SIZE','resetChunks','Folder__c','8bQasKP','file','deploy','logger','__importDefault','apply','Readable','then','deployAttachments','503041dQfVzA','orgComponentsToDeployChunk','Component_Type__c','3FqKkEI','__esModule','generateAsync','Last_Updated_By__c','BINARY_FIELD_NAME','Tracking_Setting__c','Writable','instance','CompositeBinaryDeployData','apiVersion','isReachedMaxChunk','jszip','(((.+)+)+)+$','handleDeployResult','application/zip','fullName','11LwRvGu','16161990PgGEuz','type','ORG_COMPONENT_OBJECT_NAME','352630Ytwfis','deployOrgComponents','toString','nodebuffer','constructor','FLOSUM_NAMESPACE'];a339_0x1184=function(){return _0x3e384d;};return a339_0x1184();}exports[a339_0x42ca7c(0x1e3)]=ComponentsDeployer;