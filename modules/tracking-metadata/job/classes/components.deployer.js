const a295_0x29ea0e=a295_0x29dd;(function(_0x29619a,_0x56d65e){const _0x47c6fa=a295_0x29dd,_0x56f590=_0x29619a();while(!![]){try{const _0x372084=parseInt(_0x47c6fa(0xd3))/0x1+parseInt(_0x47c6fa(0xa8))/0x2*(parseInt(_0x47c6fa(0xc5))/0x3)+-parseInt(_0x47c6fa(0xc9))/0x4+-parseInt(_0x47c6fa(0x92))/0x5+parseInt(_0x47c6fa(0xc3))/0x6+parseInt(_0x47c6fa(0xda))/0x7*(-parseInt(_0x47c6fa(0xe0))/0x8)+parseInt(_0x47c6fa(0xc7))/0x9*(parseInt(_0x47c6fa(0xbe))/0xa);if(_0x372084===_0x56d65e)break;else _0x56f590['push'](_0x56f590['shift']());}catch(_0x1ab7de){_0x56f590['push'](_0x56f590['shift']());}}}(a295_0x3838,0x23256));const a295_0x4055c8=(function(){let _0x788604=!![];return function(_0x30dee8,_0x19356e){const _0x1c169c=_0x788604?function(){const _0x10d2f=a295_0x29dd;if(_0x19356e){const _0x42d74f=_0x19356e[_0x10d2f(0xa6)](_0x30dee8,arguments);return _0x19356e=null,_0x42d74f;}}:function(){};return _0x788604=![],_0x1c169c;};}()),a295_0x374e3f=a295_0x4055c8(this,function(){const _0x1bbb38=a295_0x29dd;return a295_0x374e3f[_0x1bbb38(0xd9)]()[_0x1bbb38(0xbd)]('(((.+)+)+)+$')[_0x1bbb38(0xd9)]()[_0x1bbb38(0xc0)](a295_0x374e3f)['search'](_0x1bbb38(0xd5));});a295_0x374e3f();function a295_0x29dd(_0xcb4a45,_0x487d0e){const _0x25d32d=a295_0x3838();return a295_0x29dd=function(_0x374e3f,_0x4055c8){_0x374e3f=_0x374e3f-0x8e;let _0x383816=_0x25d32d[_0x374e3f];return _0x383816;},a295_0x29dd(_0xcb4a45,_0x487d0e);}'use strict';function a295_0x3838(){const _0x16c7b4=['trackingSettingId','3eXgWHg','METADATA_FOLDER_MAP','9UNGKkS','deployOrgComponents','704492bDumYr','attachmentsToDeployChunk','MAX_BODY_SIZE','addAttachmentToChunk','FLOSUM_NAMESPACE','stream','BINARY_FIELD_NAME','fileName','../../constants','logger','20035fbRNLR','resetChunks','(((.+)+)+)+$','componentId','Readable','createZip','toString','7vJjFvk','byteLength','Process\x20completed\x20for\x20','../../../../constants','Writable','execute','854872LswSVj','jszip','OrganisationName__c','populateAttachmentId','attachmentId','type','push','Attachment_ID__c','230705wcfWkU','ORG_COMPONENT_OBJECT_NAME','length','changedBy','log','update','Last_Updated_By__c','Folder__c','revisionCounter','Revision_Counter__c','binary','CompositeBinaryDeployData','binaryRecordsSizeChunk','Tracking_Setting__c','fullName','then','deploy','Retrieved','__esModule','ComponentsDeployer','apply','sourceMemberId','223628CcIiSZ','Name__c','defineProperty','ATTACHMENT_OBJECT_NAME','Component_Type__c','records','RestSimpleDeployData','\x20components','apiVersion','_final','Is_Retrieved__c','deployAttachments','CompositeConstants','addOrgComponentToChunk','handleDeployResult','default','generateAsync','nodebuffer','orgComponentsToDeployChunk','instance','successDeployedCounter','search','2427310SiBZcJ','Label__c','constructor','targetOrgId','application/zip','591006WIhrwq'];a295_0x3838=function(){return _0x16c7b4;};return a295_0x3838();}var __importDefault=this&&this['__importDefault']||function(_0x38e8dc){return _0x38e8dc&&_0x38e8dc['__esModule']?_0x38e8dc:{'default':_0x38e8dc};};Object[a295_0x29ea0e(0xaa)](exports,a295_0x29ea0e(0xa4),{'value':!![]}),exports['ComponentsDeployer']=void 0x0;const salesforce_1=require('@flosum/salesforce'),constants_1=require(a295_0x29ea0e(0xd1)),stream_1=require(a295_0x29ea0e(0xce)),jszip_1=__importDefault(require(a295_0x29ea0e(0xe1))),constants_2=require(a295_0x29ea0e(0xdd)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a295_0x29ea0e(0x91),CONTENT_TYPE=a295_0x29ea0e(0xc2);class ComponentsDeployer extends stream_1[a295_0x29ea0e(0xde)]{constructor({apiVersion:_0x256fdf,instance:_0x315104,logger:_0x24d2fb,targetOrgId:_0x5c8e97,trackingSettingId:_0x5ad0c2}){const _0x2f72cf=a295_0x29ea0e;super({'objectMode':!![]}),this[_0x2f72cf(0xca)]={'records':[],'binary':[]},this[_0x2f72cf(0x9e)]=0x0,this['orgComponentsToDeployChunk']=[],this[_0x2f72cf(0xbc)]=0x0,this['apiVersion']=_0x256fdf,this[_0x2f72cf(0xbb)]=_0x315104,this[_0x2f72cf(0xd2)]=_0x24d2fb,this['targetOrgId']=_0x5c8e97,this[_0x2f72cf(0xc4)]=_0x5ad0c2;}async[a295_0x29ea0e(0xa2)](){const _0x114b1b=a295_0x29ea0e;await this[_0x114b1b(0xb3)]()[_0x114b1b(0xa1)](_0xd08ab2=>this[_0x114b1b(0xe3)](_0xd08ab2))[_0x114b1b(0xa1)](()=>this[_0x114b1b(0xc8)]())[_0x114b1b(0xa1)](_0x4ac464=>this[_0x114b1b(0xb6)](_0x4ac464)),this[_0x114b1b(0xd4)]();}[a295_0x29ea0e(0xb3)](){const _0x487635=a295_0x29ea0e,_0x14ecbd=new salesforce_1[(_0x487635(0x9d))]({'instance':this[_0x487635(0xbb)],'objectName':constants_1[_0x487635(0xab)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x487635(0xb0)]});return _0x14ecbd[_0x487635(0xdf)](this[_0x487635(0xca)]);}['deployOrgComponents'](){const _0x2054fa=a295_0x29ea0e,_0x5e261d=new salesforce_1[(_0x2054fa(0xae))]({'instance':this[_0x2054fa(0xbb)],'objectName':constants_1[_0x2054fa(0x93)],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0x5e261d['execute']({'records':this[_0x2054fa(0xba)]});}async[a295_0x29ea0e(0xb6)](_0x4a8399){const _0x3cb5ed=a295_0x29ea0e;for(const {success:_0x5d9b42,error:_0x22ceab}of _0x4a8399){if(_0x5d9b42){this[_0x3cb5ed(0xbc)]++;continue;}_0x22ceab&&this[_0x3cb5ed(0xd2)]['error'](_0x22ceab);}}['isReachedMaxChunk'](_0x3e4fac){const _0x30574a=a295_0x29ea0e;return _0x3e4fac+this[_0x30574a(0x9e)]>=salesforce_1[_0x30574a(0xb4)][_0x30574a(0xcb)]||this['attachmentsToDeployChunk'][_0x30574a(0xad)][_0x30574a(0x94)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x32e2e8=a295_0x29ea0e;this[_0x32e2e8(0x9e)]=0x0,this[_0x32e2e8(0xca)]={'records':[],'binary':[]},this[_0x32e2e8(0xba)]=[];}['populateAttachmentId'](_0x10b35){const _0x2a2e08=a295_0x29ea0e;for(const _0x360332 in _0x10b35){this[_0x2a2e08(0xba)][_0x360332][ATTACHMENT_FIELD_NAME]=_0x10b35[_0x360332]['id'];}}async[a295_0x29ea0e(0xcc)](_0x302696,_0x5bce01){const _0x40b259=a295_0x29ea0e,{listMetadataItem:_0xd3c027,sourceMemberRecord:_0x152cf4}=_0x302696,_0x1be2f1={'attributes':{'type':constants_1[_0x40b259(0xab)],'binaryPartName':_0xd3c027[_0x40b259(0xa0)],'binaryPartNameAlias':constants_1['BINARY_FIELD_NAME']},'Id':_0x152cf4[_0x40b259(0x8e)],'Name':_0xd3c027[_0x40b259(0xa0)],'Description':_0xd3c027[_0x40b259(0x8f)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x40b259(0xc1)],'Body':_0xd3c027['fullName']},_0x27ecd6={'binaryFieldName':constants_1[_0x40b259(0xcf)],'name':_0xd3c027[_0x40b259(0xa0)],'value':stream_1[_0x40b259(0xd7)]['from'](_0x5bce01)};this['attachmentsToDeployChunk'][_0x40b259(0xad)][_0x40b259(0x90)](_0x1be2f1),this[_0x40b259(0xca)][_0x40b259(0x9c)][_0x40b259(0x90)](_0x27ecd6);}[a295_0x29ea0e(0xd8)](_0x20d7d1){const _0x40895c=a295_0x29ea0e,_0x3d2c0a=new jszip_1[(_0x40895c(0xb7))]();for(const _0x36ef52 in _0x20d7d1){_0x3d2c0a['file'](_0x36ef52,_0x20d7d1[_0x36ef52]);}return _0x3d2c0a[_0x40895c(0xb8)]({'type':_0x40895c(0xb9)});}[a295_0x29ea0e(0xb5)](_0x3b984a,_0x4c641c){const _0x2e6f20=a295_0x29ea0e,_0x111f9d={'attributes':{'type':constants_1[_0x2e6f20(0x93)]},'Id':_0x4c641c[_0x2e6f20(0xd6)],[constants_2[_0x2e6f20(0xcd)]+'Is_Deleted__c']:_0x4c641c['isNameObsolete'],[constants_2[_0x2e6f20(0xcd)]+_0x2e6f20(0x9b)]:_0x4c641c[_0x2e6f20(0x9a)],[constants_2[_0x2e6f20(0xcd)]+'Source_Member_Id__c']:_0x4c641c[_0x2e6f20(0xa7)],[constants_2[_0x2e6f20(0xcd)]+_0x2e6f20(0x98)]:_0x4c641c[_0x2e6f20(0x95)],[constants_2[_0x2e6f20(0xcd)]+'API_Name__c']:_0x3b984a[_0x2e6f20(0xa0)],[constants_2[_0x2e6f20(0xcd)]+_0x2e6f20(0xa9)]:_0x3b984a[_0x2e6f20(0xa0)],[constants_2[_0x2e6f20(0xcd)]+_0x2e6f20(0xac)]:_0x3b984a[_0x2e6f20(0x8f)],[constants_2[_0x2e6f20(0xcd)]+_0x2e6f20(0xbf)]:_0x3b984a[_0x2e6f20(0xd0)],[constants_2['FLOSUM_NAMESPACE']+_0x2e6f20(0x99)]:constants_1[_0x2e6f20(0xc6)]['has'](_0x3b984a[_0x2e6f20(0x8f)])||null,[constants_2['FLOSUM_NAMESPACE']+_0x2e6f20(0xb2)]:!![],[constants_2[_0x2e6f20(0xcd)]+_0x2e6f20(0xe2)]:this[_0x2e6f20(0xc1)],[constants_2[_0x2e6f20(0xcd)]+_0x2e6f20(0x9f)]:this[_0x2e6f20(0xc4)],[constants_2[_0x2e6f20(0xcd)]+'Status__c']:_0x2e6f20(0xa3)};this['orgComponentsToDeployChunk'][_0x2e6f20(0x90)](_0x111f9d);}async['_write'](_0x924127,_0x55ef1f,_0x36ade0){const _0x585b28=a295_0x29ea0e;try{const {listMetadataItem:_0x1c8436,sourceMemberRecord:_0x14c191,files:_0x5ddc25}=_0x924127,_0x1e388b=await this[_0x585b28(0xd8)](_0x5ddc25),_0x2ee11f=Buffer[_0x585b28(0xdb)](_0x1e388b);this['isReachedMaxChunk'](_0x2ee11f)&&await this[_0x585b28(0xa2)](),this['binaryRecordsSizeChunk']+=_0x2ee11f,await this[_0x585b28(0xcc)](_0x924127,_0x1e388b),this[_0x585b28(0xb5)](_0x1c8436,_0x14c191),_0x36ade0();}catch(_0x45eb3f){_0x36ade0(_0x45eb3f);}}async[a295_0x29ea0e(0xb1)](_0x4bedc5){const _0x5e1a26=a295_0x29ea0e;try{this[_0x5e1a26(0xca)][_0x5e1a26(0xad)]['length']&&this[_0x5e1a26(0xba)][_0x5e1a26(0x94)]&&await this[_0x5e1a26(0xa2)](),this['logger'][_0x5e1a26(0x96)](_0x5e1a26(0xdc)+this[_0x5e1a26(0xbc)]+_0x5e1a26(0xaf)),await this[_0x5e1a26(0xd2)][_0x5e1a26(0x97)](),_0x4bedc5();}catch(_0x197b80){_0x4bedc5(_0x197b80);}}}exports[a295_0x29ea0e(0xa5)]=ComponentsDeployer;