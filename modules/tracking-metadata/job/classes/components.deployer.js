function a340_0x4658(){const _0x4a4336=['then','defineProperty','type','populateAttachmentId','8SvnYJn','search','Tracking_Setting__c','RestSimpleDeployData','Is_Deleted__c','1560678ChpQLO','binaryRecordsSizeChunk','apply','Status__c','changedBy','Component\x20too\x20large.\x20Type:\x20','componentId','constructor','Label__c','attachmentsToDeployChunk','Attachment_ID__c','441927NbklmO','default','3678975ImZMiN','3349925KHOwxS','push','byteLength','isReachedMaxChunk','instance','2073HSlzEZ','nodebuffer','handleDeployResult','CompositeBinaryDeployData','Source_Member_Id__c','fileName','Folder__c','Writable','log','error','METADATA_FOLDER_MAP','Process\x20completed\x20for\x20','OrganisationName__c','successDeployedCounter','generateAsync','ORG_COMPONENT_OBJECT_NAME','attachmentId','addAttachmentToChunk','ComponentsDeployer','../../constants','_final','apiVersion','fullName','targetOrgId','orgComponentsToDeployChunk','Retrieved','file','deployAttachments','Revision_Counter__c','trackingSettingId','Component_Type__c','stream','toString','deployOrgComponents','jszip','deploy','__importDefault','length','\x20components','__esModule','(((.+)+)+)+$','binary','update','logger','createZip','ATTACHMENT_OBJECT_NAME','2258FNFrlh','addOrgComponentToChunk','BINARY_FIELD_NAME','from','1716444IoOmWo','4537542HNFUAN','resetChunks','records','Readable','FLOSUM_NAMESPACE','MAX_BODY_SIZE','Name__c','Is_Retrieved__c'];a340_0x4658=function(){return _0x4a4336;};return a340_0x4658();}const a340_0x1ae25e=a340_0xa908;(function(_0x183679,_0x3ca3c9){const _0x15f754=a340_0xa908,_0x28a85f=_0x183679();while(!![]){try{const _0x1feaef=-parseInt(_0x15f754(0x103))/0x1+parseInt(_0x15f754(0xe2))/0x2*(parseInt(_0x15f754(0x10b))/0x3)+parseInt(_0x15f754(0xe6))/0x4+parseInt(_0x15f754(0x106))/0x5+-parseInt(_0x15f754(0xe7))/0x6+parseInt(_0x15f754(0xf8))/0x7*(parseInt(_0x15f754(0xf3))/0x8)+-parseInt(_0x15f754(0x105))/0x9;if(_0x1feaef===_0x3ca3c9)break;else _0x28a85f['push'](_0x28a85f['shift']());}catch(_0x32a7a8){_0x28a85f['push'](_0x28a85f['shift']());}}}(a340_0x4658,0x78e7e));const a340_0x4f028f=(function(){let _0x77b8b4=!![];return function(_0x471c55,_0x4038d1){const _0x32756f=_0x77b8b4?function(){const _0x3912ee=a340_0xa908;if(_0x4038d1){const _0x51a247=_0x4038d1[_0x3912ee(0xfa)](_0x471c55,arguments);return _0x4038d1=null,_0x51a247;}}:function(){};return _0x77b8b4=![],_0x32756f;};}()),a340_0x2fe2d3=a340_0x4f028f(this,function(){const _0xeedf9a=a340_0xa908;return a340_0x2fe2d3[_0xeedf9a(0x12b)]()[_0xeedf9a(0xf4)](_0xeedf9a(0xdc))['toString']()[_0xeedf9a(0xff)](a340_0x2fe2d3)[_0xeedf9a(0xf4)]('(((.+)+)+)+$');});a340_0x2fe2d3();'use strict';function a340_0xa908(_0xdf46d2,_0x3a713c){const _0x455554=a340_0x4658();return a340_0xa908=function(_0x2fe2d3,_0x4f028f){_0x2fe2d3=_0x2fe2d3-0xd7;let _0x465831=_0x455554[_0x2fe2d3];return _0x465831;},a340_0xa908(_0xdf46d2,_0x3a713c);}var __importDefault=this&&this[a340_0x1ae25e(0xd8)]||function(_0x53f3c1){const _0x54d512=a340_0x1ae25e;return _0x53f3c1&&_0x53f3c1[_0x54d512(0xdb)]?_0x53f3c1:{'default':_0x53f3c1};};Object[a340_0x1ae25e(0xf0)](exports,a340_0x1ae25e(0xdb),{'value':!![]}),exports[a340_0x1ae25e(0x11d)]=void 0x0;const salesforce_1=require('@flosum/salesforce'),constants_1=require(a340_0x1ae25e(0x11e)),stream_1=require(a340_0x1ae25e(0x12a)),jszip_1=__importDefault(require(a340_0x1ae25e(0x12d))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,MAX_SINGLE_FILE_SIZE=0x5a06e0,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a340_0x1ae25e(0xeb)]+a340_0x1ae25e(0x102),CONTENT_TYPE='application/zip';class ComponentsDeployer extends stream_1[a340_0x1ae25e(0x112)]{constructor({apiVersion:_0x4aa1c6,instance:_0x3bd80e,logger:_0xc37d85,targetOrgId:_0x2269a4,trackingSettingId:_0x262206}){const _0x174fac=a340_0x1ae25e;super({'objectMode':!![]}),this['attachmentsToDeployChunk']={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this[_0x174fac(0x123)]=[],this['successDeployedCounter']=0x0,this[_0x174fac(0x120)]=_0x4aa1c6,this[_0x174fac(0x10a)]=_0x3bd80e,this['logger']=_0xc37d85,this[_0x174fac(0x122)]=_0x2269a4,this[_0x174fac(0x128)]=_0x262206;}async[a340_0x1ae25e(0xd7)](){const _0x5597a8=a340_0x1ae25e;await this['deployAttachments']()[_0x5597a8(0xef)](_0x2260eb=>this['populateAttachmentId'](_0x2260eb))[_0x5597a8(0xef)](()=>this[_0x5597a8(0x12c)]())[_0x5597a8(0xef)](_0x51ad30=>this[_0x5597a8(0x10d)](_0x51ad30)),this[_0x5597a8(0xe8)]();}[a340_0x1ae25e(0x126)](){const _0x2816f9=a340_0x1ae25e,_0x2ee02e=new salesforce_1[(_0x2816f9(0x10e))]({'instance':this[_0x2816f9(0x10a)],'objectName':constants_1['ATTACHMENT_OBJECT_NAME'],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x2816f9(0x120)]});return _0x2ee02e['execute'](this[_0x2816f9(0x101)]);}['deployOrgComponents'](){const _0x1524bf=a340_0x1ae25e,_0x51d7d9=new salesforce_1[(_0x1524bf(0xf6))]({'instance':this[_0x1524bf(0x10a)],'objectName':constants_1[_0x1524bf(0x11a)],'api':this[_0x1524bf(0x120)],'allOrNone':![],'externalIdField':'Id'});return _0x51d7d9['execute']({'records':this[_0x1524bf(0x123)]});}async['handleDeployResult'](_0x412e29){const _0x57f2f0=a340_0x1ae25e;for(const {success:_0x18ebe9,error:_0x56d019}of _0x412e29){if(_0x18ebe9){this[_0x57f2f0(0x118)]++;continue;}_0x56d019&&this[_0x57f2f0(0xdf)][_0x57f2f0(0x114)](_0x56d019);}}[a340_0x1ae25e(0x109)](_0x313472){const _0x448054=a340_0x1ae25e;return _0x313472+this['binaryRecordsSizeChunk']>=salesforce_1['CompositeConstants'][_0x448054(0xec)]||this[_0x448054(0x101)][_0x448054(0xe9)][_0x448054(0xd9)]===MAX_COMPOSITE_CHUNK_COUNT;}[a340_0x1ae25e(0xe8)](){const _0x6ceee5=a340_0x1ae25e;this[_0x6ceee5(0xf9)]=0x0,this[_0x6ceee5(0x101)]={'records':[],'binary':[]},this[_0x6ceee5(0x123)]=[];}[a340_0x1ae25e(0xf2)](_0x1782eb){const _0x50aed5=a340_0x1ae25e;for(const _0x3378fd in _0x1782eb){this[_0x50aed5(0x123)][_0x3378fd][ATTACHMENT_FIELD_NAME]=_0x1782eb[_0x3378fd]['id'];}}async['addAttachmentToChunk'](_0x2c5103,_0x1f7054){const _0x373c82=a340_0x1ae25e,{listMetadataItem:_0x491289,sourceMemberRecord:_0x23dea8}=_0x2c5103,_0x123e3a={'attributes':{'type':constants_1[_0x373c82(0xe1)],'binaryPartName':_0x491289[_0x373c82(0x121)],'binaryPartNameAlias':constants_1[_0x373c82(0xe4)]},'Id':_0x23dea8[_0x373c82(0x11b)],'Name':_0x491289[_0x373c82(0x121)],'Description':_0x491289[_0x373c82(0xf1)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x373c82(0x122)],'Body':_0x491289['fullName']},_0x1a41a9={'binaryFieldName':constants_1[_0x373c82(0xe4)],'name':_0x491289[_0x373c82(0x121)],'value':stream_1[_0x373c82(0xea)][_0x373c82(0xe5)](_0x1f7054)};this[_0x373c82(0x101)][_0x373c82(0xe9)]['push'](_0x123e3a),this[_0x373c82(0x101)][_0x373c82(0xdd)][_0x373c82(0x107)](_0x1a41a9);}[a340_0x1ae25e(0xe0)](_0x5e2a66){const _0x226b52=a340_0x1ae25e,_0x583288=new jszip_1[(_0x226b52(0x104))]();for(const _0x547409 in _0x5e2a66){_0x583288[_0x226b52(0x125)](_0x547409,_0x5e2a66[_0x547409]);}return _0x583288[_0x226b52(0x119)]({'type':_0x226b52(0x10c)});}[a340_0x1ae25e(0xe3)](_0x29e4d7,_0x2d3541,_0x4156fa){const _0x120017=a340_0x1ae25e,_0x3a769f={'attributes':{'type':constants_1[_0x120017(0x11a)]},'Id':_0x2d3541[_0x120017(0xfe)],[constants_2[_0x120017(0xeb)]+_0x120017(0xf7)]:_0x2d3541['isNameObsolete'],[constants_2[_0x120017(0xeb)]+_0x120017(0x127)]:_0x2d3541['revisionCounter'],[constants_2['FLOSUM_NAMESPACE']+_0x120017(0x10f)]:_0x2d3541['sourceMemberId'],[constants_2[_0x120017(0xeb)]+'Last_Updated_By__c']:_0x2d3541[_0x120017(0xfc)],[constants_2[_0x120017(0xeb)]+'API_Name__c']:_0x29e4d7['fullName'],[constants_2[_0x120017(0xeb)]+_0x120017(0xed)]:_0x29e4d7[_0x120017(0x121)],[constants_2[_0x120017(0xeb)]+_0x120017(0x129)]:_0x29e4d7['type'],[constants_2[_0x120017(0xeb)]+_0x120017(0x100)]:_0x29e4d7[_0x120017(0x110)],[constants_2[_0x120017(0xeb)]+_0x120017(0x111)]:constants_1[_0x120017(0x115)]['has'](_0x29e4d7[_0x120017(0xf1)])||null,[constants_2[_0x120017(0xeb)]+_0x120017(0xee)]:!![],[constants_2[_0x120017(0xeb)]+_0x120017(0x117)]:this['targetOrgId'],[constants_2[_0x120017(0xeb)]+_0x120017(0xf5)]:this['trackingSettingId'],[constants_2[_0x120017(0xeb)]+_0x120017(0xfb)]:_0x4156fa>MAX_SINGLE_FILE_SIZE?'Too\x20Large':_0x120017(0x124)};_0x4156fa>MAX_SINGLE_FILE_SIZE&&this[_0x120017(0xdf)][_0x120017(0x113)](_0x120017(0xfd)+_0x29e4d7['type']+',\x20Name:\x20'+_0x29e4d7[_0x120017(0x121)]),this['orgComponentsToDeployChunk']['push'](_0x3a769f);}async['_write'](_0x5d4d96,_0x4d5490,_0x1dbeab){const _0x21ab91=a340_0x1ae25e;try{const {listMetadataItem:_0x11c147,sourceMemberRecord:_0xa17d3d,files:_0x464b3e}=_0x5d4d96,_0x58da40=await this[_0x21ab91(0xe0)](_0x464b3e),_0x6d83aa=Buffer[_0x21ab91(0x108)](_0x58da40);this['isReachedMaxChunk'](_0x6d83aa)&&await this[_0x21ab91(0xd7)](),this[_0x21ab91(0xf9)]+=_0x6d83aa,await this[_0x21ab91(0x11c)](_0x5d4d96,_0x58da40),this['addOrgComponentToChunk'](_0x11c147,_0xa17d3d,_0x58da40['length']),_0x1dbeab();}catch(_0x7f467e){_0x1dbeab(_0x7f467e);}}async[a340_0x1ae25e(0x11f)](_0x5094f9){const _0xe666a8=a340_0x1ae25e;try{this[_0xe666a8(0x101)][_0xe666a8(0xe9)][_0xe666a8(0xd9)]&&this[_0xe666a8(0x123)]['length']&&await this[_0xe666a8(0xd7)](),this[_0xe666a8(0xdf)][_0xe666a8(0x113)](_0xe666a8(0x116)+this[_0xe666a8(0x118)]+_0xe666a8(0xda)),await this[_0xe666a8(0xdf)][_0xe666a8(0xde)](),_0x5094f9();}catch(_0xcb44ee){_0x5094f9(_0xcb44ee);}}}exports['ComponentsDeployer']=ComponentsDeployer;