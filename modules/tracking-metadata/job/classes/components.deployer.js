function a338_0x217d(){const _0x4a054f=['5250SvCDVf','OrganisationName__c','BINARY_FIELD_NAME','4200794wOZAcb','RestSimpleDeployData','trackingSettingId','orgComponentsToDeployChunk','targetOrgId','__esModule','addOrgComponentToChunk','Attachment_ID__c','921VJaLpd','deployAttachments','has','push','nodebuffer','search','then','binaryRecordsSizeChunk','ComponentsDeployer','6FAHjaa','250799ZuvprF','log','Status__c','jszip','ORG_COMPONENT_OBJECT_NAME','Is_Retrieved__c','execute','error','Tracking_Setting__c','Source_Member_Id__c','successDeployedCounter','generateAsync','20ytCEYC','7136UCScmq','logger','Revision_Counter__c','CompositeConstants','from','Readable','length','METADATA_FOLDER_MAP','deploy','Is_Deleted__c','revisionCounter','3016CRknsy','fullName','@flosum/salesforce','addAttachmentToChunk','attachmentsToDeployChunk','ATTACHMENT_OBJECT_NAME','24MRkLbb','resetChunks','apiVersion','createZip','_write','records','stream','1033675fUgJvy','update','byteLength','Process\x20completed\x20for\x20','defineProperty','attachmentId','handleDeployResult','instance','Last_Updated_By__c','(((.+)+)+)+$','Retrieved','MAX_BODY_SIZE','Writable','apply','changedBy','type','deployOrgComponents','isReachedMaxChunk','../../../../constants','fileName','isNameObsolete','Folder__c','4YhYMLx','API_Name__c','populateAttachmentId','FLOSUM_NAMESPACE','file','959634rmGYEr','1890988cdBubg'];a338_0x217d=function(){return _0x4a054f;};return a338_0x217d();}const a338_0x71b7a3=a338_0x54f7;(function(_0x4f9055,_0xf0cb05){const _0x471f9e=a338_0x54f7,_0x93f71b=_0x4f9055();while(!![]){try{const _0xdf289e=parseInt(_0x471f9e(0x1ad))/0x1*(-parseInt(_0x471f9e(0x191))/0x2)+-parseInt(_0x471f9e(0x1a3))/0x3*(parseInt(_0x471f9e(0x1c5))/0x4)+parseInt(_0x471f9e(0x17b))/0x5*(parseInt(_0x471f9e(0x1ac))/0x6)+-parseInt(_0x471f9e(0x198))/0x7*(-parseInt(_0x471f9e(0x1ba))/0x8)+parseInt(_0x471f9e(0x196))/0x9*(parseInt(_0x471f9e(0x1b9))/0xa)+-parseInt(_0x471f9e(0x197))/0xb*(parseInt(_0x471f9e(0x1cb))/0xc)+parseInt(_0x471f9e(0x19b))/0xd;if(_0xdf289e===_0xf0cb05)break;else _0x93f71b['push'](_0x93f71b['shift']());}catch(_0x3ec4d5){_0x93f71b['push'](_0x93f71b['shift']());}}}(a338_0x217d,0x51d81));const a338_0x5d11b5=(function(){let _0x94fa23=!![];return function(_0x5b7cbd,_0xba0d7e){const _0x5d626b=_0x94fa23?function(){const _0x42e1de=a338_0x54f7;if(_0xba0d7e){const _0x46070a=_0xba0d7e[_0x42e1de(0x188)](_0x5b7cbd,arguments);return _0xba0d7e=null,_0x46070a;}}:function(){};return _0x94fa23=![],_0x5d626b;};}()),a338_0x14af0f=a338_0x5d11b5(this,function(){const _0x235f14=a338_0x54f7;return a338_0x14af0f['toString']()['search'](_0x235f14(0x184))['toString']()['constructor'](a338_0x14af0f)[_0x235f14(0x1a8)]('(((.+)+)+)+$');});a338_0x14af0f();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x153c9d){const _0x4ddfa0=a338_0x54f7;return _0x153c9d&&_0x153c9d[_0x4ddfa0(0x1a0)]?_0x153c9d:{'default':_0x153c9d};};Object[a338_0x71b7a3(0x17f)](exports,a338_0x71b7a3(0x1a0),{'value':!![]}),exports[a338_0x71b7a3(0x1ab)]=void 0x0;function a338_0x54f7(_0x1025b2,_0x1edd91){const _0xc9ca53=a338_0x217d();return a338_0x54f7=function(_0x14af0f,_0x5d11b5){_0x14af0f=_0x14af0f-0x175;let _0x217dbc=_0xc9ca53[_0x14af0f];return _0x217dbc;},a338_0x54f7(_0x1025b2,_0x1edd91);}const salesforce_1=require(a338_0x71b7a3(0x1c7)),constants_1=require('../../constants'),stream_1=require(a338_0x71b7a3(0x17a)),jszip_1=__importDefault(require(a338_0x71b7a3(0x1b0))),constants_2=require(a338_0x71b7a3(0x18d)),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a338_0x71b7a3(0x1a2),CONTENT_TYPE='application/zip';class ComponentsDeployer extends stream_1[a338_0x71b7a3(0x187)]{constructor({apiVersion:_0x5a9ef1,instance:_0x571290,logger:_0x5d1232,targetOrgId:_0xc360aa,trackingSettingId:_0x39a7ad}){const _0x2fd8de=a338_0x71b7a3;super({'objectMode':!![]}),this[_0x2fd8de(0x1c9)]={'records':[],'binary':[]},this['binaryRecordsSizeChunk']=0x0,this['orgComponentsToDeployChunk']=[],this[_0x2fd8de(0x1b7)]=0x0,this[_0x2fd8de(0x176)]=_0x5a9ef1,this[_0x2fd8de(0x182)]=_0x571290,this[_0x2fd8de(0x1bb)]=_0x5d1232,this[_0x2fd8de(0x19f)]=_0xc360aa,this[_0x2fd8de(0x19d)]=_0x39a7ad;}async['deploy'](){const _0x432e27=a338_0x71b7a3;await this[_0x432e27(0x1a4)]()[_0x432e27(0x1a9)](_0x54f776=>this[_0x432e27(0x193)](_0x54f776))[_0x432e27(0x1a9)](()=>this[_0x432e27(0x18b)]())[_0x432e27(0x1a9)](_0x2d7378=>this[_0x432e27(0x181)](_0x2d7378)),this[_0x432e27(0x175)]();}[a338_0x71b7a3(0x1a4)](){const _0x3b818c=a338_0x71b7a3,_0x5da841=new salesforce_1['CompositeBinaryDeployData']({'instance':this[_0x3b818c(0x182)],'objectName':constants_1[_0x3b818c(0x1ca)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x3b818c(0x176)]});return _0x5da841[_0x3b818c(0x1b3)](this['attachmentsToDeployChunk']);}[a338_0x71b7a3(0x18b)](){const _0x256d7f=a338_0x71b7a3,_0x2d08c2=new salesforce_1[(_0x256d7f(0x19c))]({'instance':this[_0x256d7f(0x182)],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this['apiVersion'],'allOrNone':![],'externalIdField':'Id'});return _0x2d08c2[_0x256d7f(0x1b3)]({'records':this[_0x256d7f(0x19e)]});}async[a338_0x71b7a3(0x181)](_0x5ac586){const _0x4cec61=a338_0x71b7a3;for(const {success:_0x395103,error:_0x5bcd6c}of _0x5ac586){if(_0x395103){this['successDeployedCounter']++;continue;}_0x5bcd6c&&this['logger'][_0x4cec61(0x1b4)](_0x5bcd6c);}}[a338_0x71b7a3(0x18c)](_0x2a7e0b){const _0x41f8ac=a338_0x71b7a3;return _0x2a7e0b+this['binaryRecordsSizeChunk']>=salesforce_1[_0x41f8ac(0x1bd)][_0x41f8ac(0x186)]||this[_0x41f8ac(0x1c9)][_0x41f8ac(0x179)][_0x41f8ac(0x1c0)]===MAX_COMPOSITE_CHUNK_COUNT;}['resetChunks'](){const _0x17fd86=a338_0x71b7a3;this['binaryRecordsSizeChunk']=0x0,this[_0x17fd86(0x1c9)]={'records':[],'binary':[]},this[_0x17fd86(0x19e)]=[];}[a338_0x71b7a3(0x193)](_0x5905d0){for(const _0x33227c in _0x5905d0){this['orgComponentsToDeployChunk'][_0x33227c][ATTACHMENT_FIELD_NAME]=_0x5905d0[_0x33227c]['id'];}}async[a338_0x71b7a3(0x1c8)](_0xfec63c,_0x5f2f1d){const _0x95f663=a338_0x71b7a3,{listMetadataItem:_0x408b56,sourceMemberRecord:_0x16d97d}=_0xfec63c,_0x4f5d73={'attributes':{'type':constants_1['ATTACHMENT_OBJECT_NAME'],'binaryPartName':_0x408b56[_0x95f663(0x1c6)],'binaryPartNameAlias':constants_1[_0x95f663(0x19a)]},'Id':_0x16d97d[_0x95f663(0x180)],'Name':_0x408b56[_0x95f663(0x1c6)],'Description':_0x408b56[_0x95f663(0x18a)],'ContentType':CONTENT_TYPE,'ParentId':this[_0x95f663(0x19f)],'Body':_0x408b56[_0x95f663(0x1c6)]},_0x200789={'binaryFieldName':constants_1['BINARY_FIELD_NAME'],'name':_0x408b56[_0x95f663(0x1c6)],'value':stream_1[_0x95f663(0x1bf)][_0x95f663(0x1be)](_0x5f2f1d)};this[_0x95f663(0x1c9)]['records'][_0x95f663(0x1a6)](_0x4f5d73),this[_0x95f663(0x1c9)]['binary'][_0x95f663(0x1a6)](_0x200789);}[a338_0x71b7a3(0x177)](_0x41e853){const _0xb93eb4=a338_0x71b7a3,_0x5f2204=new jszip_1['default']();for(const _0x4c506 in _0x41e853){_0x5f2204[_0xb93eb4(0x195)](_0x4c506,_0x41e853[_0x4c506]);}return _0x5f2204[_0xb93eb4(0x1b8)]({'type':_0xb93eb4(0x1a7)});}[a338_0x71b7a3(0x1a1)](_0x4b588a,_0x12699e){const _0x29baec=a338_0x71b7a3,_0x6cace={'attributes':{'type':constants_1[_0x29baec(0x1b1)]},'Id':_0x12699e['componentId'],[constants_2[_0x29baec(0x194)]+_0x29baec(0x1c3)]:_0x12699e[_0x29baec(0x18f)],[constants_2[_0x29baec(0x194)]+_0x29baec(0x1bc)]:_0x12699e[_0x29baec(0x1c4)],[constants_2[_0x29baec(0x194)]+_0x29baec(0x1b6)]:_0x12699e['sourceMemberId'],[constants_2['FLOSUM_NAMESPACE']+_0x29baec(0x183)]:_0x12699e[_0x29baec(0x189)],[constants_2['FLOSUM_NAMESPACE']+_0x29baec(0x192)]:_0x4b588a[_0x29baec(0x1c6)],[constants_2['FLOSUM_NAMESPACE']+'Name__c']:_0x4b588a['fullName'],[constants_2[_0x29baec(0x194)]+'Component_Type__c']:_0x4b588a[_0x29baec(0x18a)],[constants_2[_0x29baec(0x194)]+'Label__c']:_0x4b588a[_0x29baec(0x18e)],[constants_2['FLOSUM_NAMESPACE']+_0x29baec(0x190)]:constants_1[_0x29baec(0x1c1)][_0x29baec(0x1a5)](_0x4b588a[_0x29baec(0x18a)])||null,[constants_2[_0x29baec(0x194)]+_0x29baec(0x1b2)]:!![],[constants_2[_0x29baec(0x194)]+_0x29baec(0x199)]:this[_0x29baec(0x19f)],[constants_2['FLOSUM_NAMESPACE']+_0x29baec(0x1b5)]:this['trackingSettingId'],[constants_2[_0x29baec(0x194)]+_0x29baec(0x1af)]:_0x29baec(0x185)};this['orgComponentsToDeployChunk'][_0x29baec(0x1a6)](_0x6cace);}async[a338_0x71b7a3(0x178)](_0x3269fb,_0x55e141,_0x36d51f){const _0xd509da=a338_0x71b7a3;try{const {listMetadataItem:_0x293ad5,sourceMemberRecord:_0x58728a,files:_0x2be52a}=_0x3269fb,_0x1f196a=await this[_0xd509da(0x177)](_0x2be52a),_0x14a898=Buffer[_0xd509da(0x17d)](_0x1f196a);this['isReachedMaxChunk'](_0x14a898)&&await this['deploy'](),this[_0xd509da(0x1aa)]+=_0x14a898,await this[_0xd509da(0x1c8)](_0x3269fb,_0x1f196a),this['addOrgComponentToChunk'](_0x293ad5,_0x58728a),_0x36d51f();}catch(_0x419c43){_0x36d51f(_0x419c43);}}async['_final'](_0x201037){const _0x59a429=a338_0x71b7a3;try{this[_0x59a429(0x1c9)][_0x59a429(0x179)][_0x59a429(0x1c0)]&&this[_0x59a429(0x19e)][_0x59a429(0x1c0)]&&await this[_0x59a429(0x1c2)](),this['logger'][_0x59a429(0x1ae)](_0x59a429(0x17e)+this['successDeployedCounter']+'\x20components'),await this[_0x59a429(0x1bb)][_0x59a429(0x17c)](),_0x201037();}catch(_0x2e499e){_0x201037(_0x2e499e);}}}exports[a338_0x71b7a3(0x1ab)]=ComponentsDeployer;