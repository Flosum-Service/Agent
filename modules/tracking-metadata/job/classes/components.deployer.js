const a310_0x1f4787=a310_0x479e;(function(_0x3c9c3d,_0x2c91d6){const _0x1905ac=a310_0x479e,_0x5c20af=_0x3c9c3d();while(!![]){try{const _0x191f24=parseInt(_0x1905ac(0xeb))/0x1*(-parseInt(_0x1905ac(0xe4))/0x2)+parseInt(_0x1905ac(0xcc))/0x3*(-parseInt(_0x1905ac(0xc5))/0x4)+parseInt(_0x1905ac(0xf0))/0x5*(-parseInt(_0x1905ac(0x10b))/0x6)+parseInt(_0x1905ac(0xdd))/0x7+parseInt(_0x1905ac(0xd9))/0x8+-parseInt(_0x1905ac(0x10a))/0x9*(-parseInt(_0x1905ac(0xd0))/0xa)+parseInt(_0x1905ac(0xda))/0xb;if(_0x191f24===_0x2c91d6)break;else _0x5c20af['push'](_0x5c20af['shift']());}catch(_0x5f01ce){_0x5c20af['push'](_0x5c20af['shift']());}}}(a310_0x9856,0x49950));const a310_0x2a14a0=(function(){let _0x537baf=!![];return function(_0x5a7585,_0x8f8da8){const _0x206916=_0x537baf?function(){const _0x33e66a=a310_0x479e;if(_0x8f8da8){const _0x3ee2c4=_0x8f8da8[_0x33e66a(0xea)](_0x5a7585,arguments);return _0x8f8da8=null,_0x3ee2c4;}}:function(){};return _0x537baf=![],_0x206916;};}()),a310_0x12c28d=a310_0x2a14a0(this,function(){const _0x5e20aa=a310_0x479e;return a310_0x12c28d['toString']()[_0x5e20aa(0xf4)](_0x5e20aa(0xfe))[_0x5e20aa(0xc8)]()[_0x5e20aa(0xe2)](a310_0x12c28d)[_0x5e20aa(0xf4)](_0x5e20aa(0xfe));});a310_0x12c28d();'use strict';var __importDefault=this&&this[a310_0x1f4787(0xee)]||function(_0x55f12e){return _0x55f12e&&_0x55f12e['__esModule']?_0x55f12e:{'default':_0x55f12e};};function a310_0x479e(_0x4cf526,_0x37de82){const _0x33f258=a310_0x9856();return a310_0x479e=function(_0x12c28d,_0x2a14a0){_0x12c28d=_0x12c28d-0xc0;let _0x985630=_0x33f258[_0x12c28d];return _0x985630;},a310_0x479e(_0x4cf526,_0x37de82);}Object[a310_0x1f4787(0xd3)](exports,a310_0x1f4787(0x104),{'value':!![]}),exports['ComponentsDeployer']=void 0x0;function a310_0x9856(){const _0xc2dadd=['1265ntLtOw','_final','resetChunks','__importDefault','addAttachmentToChunk','85HcjSys','trackingSettingId','apiVersion','type','search','attachmentsToDeployChunk','RestSimpleDeployData','addOrgComponentToChunk','Retrieved','Attachment_ID__c','Component_Type__c','logger','BINARY_FIELD_NAME','populateAttachmentId','(((.+)+)+)+$','sourceMemberId','Writable','file','application/zip','Status__c','__esModule','changedBy','isReachedMaxChunk','Source_Member_Id__c','Revision_Counter__c','CompositeConstants','9tWSKrt','124548tlVHZK','ComponentsDeployer','handleDeployResult','\x20components','deploy','MAX_BODY_SIZE','../../constants','stream','Last_Updated_By__c','default','fullName','Process\x20completed\x20for\x20','binaryRecordsSizeChunk','nodebuffer','execute','Is_Retrieved__c','update','records','isNameObsolete','120212YLZndS','log','generateAsync','toString','from','@flosum/salesforce','FLOSUM_NAMESPACE','51MgeECt','_write','attachmentId','componentId','5263340IWaObU','orgComponentsToDeployChunk','jszip','defineProperty','length','then','Tracking_Setting__c','createZip','revisionCounter','1730840UsRBzr','3993187DQOZtF','Label__c','deployAttachments','1310666haFFkm','targetOrgId','ATTACHMENT_OBJECT_NAME','Readable','Folder__c','constructor','OrganisationName__c','202hyDJoi','API_Name__c','instance','successDeployedCounter','ORG_COMPONENT_OBJECT_NAME','binary','apply'];a310_0x9856=function(){return _0xc2dadd;};return a310_0x9856();}const salesforce_1=require(a310_0x1f4787(0xca)),constants_1=require(a310_0x1f4787(0x111)),stream_1=require(a310_0x1f4787(0x112)),jszip_1=__importDefault(require(a310_0x1f4787(0xd2))),constants_2=require('../../../../constants'),MAX_COMPOSITE_CHUNK_COUNT=0xc8,EXTERNAL_ID_FIELD='Id',ATTACHMENT_FIELD_NAME=constants_2[a310_0x1f4787(0xcb)]+a310_0x1f4787(0xf9),CONTENT_TYPE=a310_0x1f4787(0x102);class ComponentsDeployer extends stream_1[a310_0x1f4787(0x100)]{constructor({apiVersion:_0x5d2e44,instance:_0x2b50ac,logger:_0x15e80d,targetOrgId:_0x4edb37,trackingSettingId:_0xcf882d}){const _0x2578b5=a310_0x1f4787;super({'objectMode':!![]}),this[_0x2578b5(0xf5)]={'records':[],'binary':[]},this[_0x2578b5(0x117)]=0x0,this[_0x2578b5(0xd1)]=[],this['successDeployedCounter']=0x0,this[_0x2578b5(0xf2)]=_0x5d2e44,this[_0x2578b5(0xe6)]=_0x2b50ac,this['logger']=_0x15e80d,this[_0x2578b5(0xde)]=_0x4edb37,this[_0x2578b5(0xf1)]=_0xcf882d;}async['deploy'](){const _0x413367=a310_0x1f4787;await this[_0x413367(0xdc)]()[_0x413367(0xd5)](_0x24394e=>this[_0x413367(0xfd)](_0x24394e))[_0x413367(0xd5)](()=>this['deployOrgComponents']())[_0x413367(0xd5)](_0xd5baaa=>this['handleDeployResult'](_0xd5baaa)),this[_0x413367(0xed)]();}[a310_0x1f4787(0xdc)](){const _0x473274=a310_0x1f4787,_0x41c3f6=new salesforce_1['CompositeBinaryDeployData']({'instance':this[_0x473274(0xe6)],'objectName':constants_1[_0x473274(0xdf)],'externalIdField':EXTERNAL_ID_FIELD,'allOrNone':![],'api':this[_0x473274(0xf2)]});return _0x41c3f6['execute'](this[_0x473274(0xf5)]);}['deployOrgComponents'](){const _0x572c84=a310_0x1f4787,_0x32d5f9=new salesforce_1[(_0x572c84(0xf6))]({'instance':this[_0x572c84(0xe6)],'objectName':constants_1['ORG_COMPONENT_OBJECT_NAME'],'api':this[_0x572c84(0xf2)],'allOrNone':![],'externalIdField':'Id'});return _0x32d5f9[_0x572c84(0xc0)]({'records':this[_0x572c84(0xd1)]});}async[a310_0x1f4787(0x10d)](_0x2658bb){const _0x5d14c5=a310_0x1f4787;for(const {success:_0x1d40aa,error:_0x1a08bb}of _0x2658bb){if(_0x1d40aa){this[_0x5d14c5(0xe7)]++;continue;}_0x1a08bb&&this[_0x5d14c5(0xfb)]['error'](_0x1a08bb);}}[a310_0x1f4787(0x106)](_0x1ee2cf){const _0x40c6aa=a310_0x1f4787;return _0x1ee2cf+this[_0x40c6aa(0x117)]>=salesforce_1[_0x40c6aa(0x109)][_0x40c6aa(0x110)]||this['attachmentsToDeployChunk'][_0x40c6aa(0xc3)][_0x40c6aa(0xd4)]===MAX_COMPOSITE_CHUNK_COUNT;}[a310_0x1f4787(0xed)](){const _0x254918=a310_0x1f4787;this[_0x254918(0x117)]=0x0,this[_0x254918(0xf5)]={'records':[],'binary':[]},this['orgComponentsToDeployChunk']=[];}['populateAttachmentId'](_0x865760){const _0x447546=a310_0x1f4787;for(const _0x4caab3 in _0x865760){this[_0x447546(0xd1)][_0x4caab3][ATTACHMENT_FIELD_NAME]=_0x865760[_0x4caab3]['id'];}}async[a310_0x1f4787(0xef)](_0x3e8b2f,_0x5948fd){const _0x401973=a310_0x1f4787,{listMetadataItem:_0x47a9aa,sourceMemberRecord:_0x19e2a5}=_0x3e8b2f,_0x215a66={'attributes':{'type':constants_1[_0x401973(0xdf)],'binaryPartName':_0x47a9aa[_0x401973(0x115)],'binaryPartNameAlias':constants_1[_0x401973(0xfc)]},'Id':_0x19e2a5[_0x401973(0xce)],'Name':_0x47a9aa[_0x401973(0x115)],'Description':_0x47a9aa[_0x401973(0xf3)],'ContentType':CONTENT_TYPE,'ParentId':this['targetOrgId'],'Body':_0x47a9aa[_0x401973(0x115)]},_0x2a631a={'binaryFieldName':constants_1[_0x401973(0xfc)],'name':_0x47a9aa[_0x401973(0x115)],'value':stream_1[_0x401973(0xe0)][_0x401973(0xc9)](_0x5948fd)};this['attachmentsToDeployChunk'][_0x401973(0xc3)]['push'](_0x215a66),this[_0x401973(0xf5)][_0x401973(0xe9)]['push'](_0x2a631a);}[a310_0x1f4787(0xd7)](_0x54e734){const _0x927d53=a310_0x1f4787,_0x4aa134=new jszip_1[(_0x927d53(0x114))]();for(const _0x3351f1 in _0x54e734){_0x4aa134[_0x927d53(0x101)](_0x3351f1,_0x54e734[_0x3351f1]);}return _0x4aa134[_0x927d53(0xc7)]({'type':_0x927d53(0x118)});}[a310_0x1f4787(0xf7)](_0x5b3884,_0x58e4d0){const _0x50a373=a310_0x1f4787,_0x4e616d={'attributes':{'type':constants_1[_0x50a373(0xe8)]},'Id':_0x58e4d0[_0x50a373(0xcf)],[constants_2[_0x50a373(0xcb)]+'Is_Deleted__c']:_0x58e4d0[_0x50a373(0xc4)],[constants_2[_0x50a373(0xcb)]+_0x50a373(0x108)]:_0x58e4d0[_0x50a373(0xd8)],[constants_2['FLOSUM_NAMESPACE']+_0x50a373(0x107)]:_0x58e4d0[_0x50a373(0xff)],[constants_2[_0x50a373(0xcb)]+_0x50a373(0x113)]:_0x58e4d0[_0x50a373(0x105)],[constants_2[_0x50a373(0xcb)]+_0x50a373(0xe5)]:_0x5b3884[_0x50a373(0x115)],[constants_2['FLOSUM_NAMESPACE']+'Name__c']:_0x5b3884['fullName'],[constants_2[_0x50a373(0xcb)]+_0x50a373(0xfa)]:_0x5b3884[_0x50a373(0xf3)],[constants_2[_0x50a373(0xcb)]+_0x50a373(0xdb)]:_0x5b3884['fileName'],[constants_2[_0x50a373(0xcb)]+_0x50a373(0xe1)]:constants_1['METADATA_FOLDER_MAP']['has'](_0x5b3884[_0x50a373(0xf3)])||null,[constants_2[_0x50a373(0xcb)]+_0x50a373(0xc1)]:!![],[constants_2[_0x50a373(0xcb)]+_0x50a373(0xe3)]:this[_0x50a373(0xde)],[constants_2[_0x50a373(0xcb)]+_0x50a373(0xd6)]:this[_0x50a373(0xf1)],[constants_2['FLOSUM_NAMESPACE']+_0x50a373(0x103)]:_0x50a373(0xf8)};this['orgComponentsToDeployChunk']['push'](_0x4e616d);}async[a310_0x1f4787(0xcd)](_0x1bc196,_0x1d68ee,_0x3b8fa4){const _0x243017=a310_0x1f4787;try{const {listMetadataItem:_0x3a8e84,sourceMemberRecord:_0x595e82,files:_0x24c633}=_0x1bc196,_0x24b7da=await this[_0x243017(0xd7)](_0x24c633),_0x29e2f1=Buffer['byteLength'](_0x24b7da);this['isReachedMaxChunk'](_0x29e2f1)&&await this[_0x243017(0x10f)](),this['binaryRecordsSizeChunk']+=_0x29e2f1,await this[_0x243017(0xef)](_0x1bc196,_0x24b7da),this[_0x243017(0xf7)](_0x3a8e84,_0x595e82),_0x3b8fa4();}catch(_0x32f59f){_0x3b8fa4(_0x32f59f);}}async[a310_0x1f4787(0xec)](_0x4bcd94){const _0x364dde=a310_0x1f4787;try{this['attachmentsToDeployChunk'][_0x364dde(0xc3)]['length']&&this[_0x364dde(0xd1)][_0x364dde(0xd4)]&&await this[_0x364dde(0x10f)](),this['logger'][_0x364dde(0xc6)](_0x364dde(0x116)+this[_0x364dde(0xe7)]+_0x364dde(0x10e)),await this[_0x364dde(0xfb)][_0x364dde(0xc2)](),_0x4bcd94();}catch(_0x2451b1){_0x4bcd94(_0x2451b1);}}}exports[a310_0x1f4787(0x10c)]=ComponentsDeployer;