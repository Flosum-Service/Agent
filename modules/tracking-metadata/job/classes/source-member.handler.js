const a300_0x422202=a300_0x5171;(function(_0x4501a1,_0x1e1c6c){const _0x542463=a300_0x5171,_0x46ddd4=_0x4501a1();while(!![]){try{const _0xf56c8=parseInt(_0x542463(0xb7))/0x1+-parseInt(_0x542463(0xb8))/0x2*(parseInt(_0x542463(0xc0))/0x3)+-parseInt(_0x542463(0x9a))/0x4*(-parseInt(_0x542463(0xb1))/0x5)+parseInt(_0x542463(0xad))/0x6+-parseInt(_0x542463(0xa3))/0x7*(-parseInt(_0x542463(0xa7))/0x8)+parseInt(_0x542463(0xaa))/0x9*(parseInt(_0x542463(0xb2))/0xa)+-parseInt(_0x542463(0xb0))/0xb*(parseInt(_0x542463(0xa6))/0xc);if(_0xf56c8===_0x1e1c6c)break;else _0x46ddd4['push'](_0x46ddd4['shift']());}catch(_0x25ff5c){_0x46ddd4['push'](_0x46ddd4['shift']());}}}(a300_0x2668,0x888df));const a300_0x2fb566=(function(){let _0x5b1f63=!![];return function(_0x2c5b7c,_0x16154e){const _0x2f1c3a=_0x5b1f63?function(){const _0x27e1d9=a300_0x5171;if(_0x16154e){const _0x57b96d=_0x16154e[_0x27e1d9(0xc7)](_0x2c5b7c,arguments);return _0x16154e=null,_0x57b96d;}}:function(){};return _0x5b1f63=![],_0x2f1c3a;};}()),a300_0x7ec4d6=a300_0x2fb566(this,function(){const _0x50f899=a300_0x5171;return a300_0x7ec4d6[_0x50f899(0x96)]()[_0x50f899(0xbc)](_0x50f899(0xc6))[_0x50f899(0x96)]()[_0x50f899(0xc4)](a300_0x7ec4d6)['search'](_0x50f899(0xc6));});a300_0x7ec4d6();'use strict';Object[a300_0x422202(0x9b)](exports,a300_0x422202(0x9f),{'value':!![]}),exports['SourceMemberHandler']=void 0x0;function a300_0x5171(_0x774cf5,_0x3121fc){const _0x366371=a300_0x2668();return a300_0x5171=function(_0x7ec4d6,_0x2fb566){_0x7ec4d6=_0x7ec4d6-0x8d;let _0x26682f=_0x366371[_0x7ec4d6];return _0x26682f;},a300_0x5171(_0x774cf5,_0x3121fc);}const stream_1=require(a300_0x422202(0xbd)),salesforce_1=require('@flosum/salesforce'),constants_1=require(a300_0x422202(0xc5)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME='RevisionCounter',IS_NAME_OBSOLETE=a300_0x422202(0xb4),MEMBER_ID_FIELD_NAME=a300_0x422202(0x92),MEMBER_TYPE_FIELD_NAME=a300_0x422202(0xc1),CHANGED_BY_FIELD_NAME=a300_0x422202(0xa0),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a300_0x422202(0xab)]+a300_0x422202(0xb5),ORGANIZATION_NAME_FIELD=constants_2[a300_0x422202(0xab)]+a300_0x422202(0xa5),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x422202(0xab)]+a300_0x422202(0xc3),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a300_0x422202(0xab)]+a300_0x422202(0xc3),constants_2[a300_0x422202(0xab)]+a300_0x422202(0xa4),constants_2[a300_0x422202(0xab)]+a300_0x422202(0x8f),constants_2[a300_0x422202(0xab)]+a300_0x422202(0x9c),constants_2[a300_0x422202(0xab)]+a300_0x422202(0xb5),constants_2[a300_0x422202(0xab)]+a300_0x422202(0xa5),constants_2['FLOSUM_NAMESPACE']+a300_0x422202(0xb6),constants_2['FLOSUM_NAMESPACE']+a300_0x422202(0x9e)];function a300_0x2668(){const _0xc3b23c=['targetOrgId','handle','1085413vRPEck','Component_Type__c','OrganisationName__c','2616QDLJXo','8WhIoxe','size','update','23913qHRgLB','FLOSUM_NAMESPACE','execute','1481016YsSRVY','\x20=\x20:targetOrgId','addToChunk','40689huDHSr','382455XOYFGv','2010zuJaxT','keys','IsNameObsolete','Source_Member_Id__c','Attachment_ID__c','106126OCIDnc','4gDZWQy','get','Transform','from','search','stream','where','api','317709ASSsWg','MemberType','QueryBuilder','Revision_Counter__c','constructor','../../constants','(((.+)+)+)+$','apply','\x20components','\x20IN\x20(:sourceMemberIds)','API_Name__c','buildOrgComponentQuery','logger','MemberIdOrName','handledMembersCounter','ORG_COMPONENT_OBJECT_NAME','log','toString','_flush','set','instance','28bVzmtp','defineProperty','Name__c','sourceMemberRecords','Folder__c','__esModule','ChangedBy'];a300_0x2668=function(){return _0xc3b23c;};return a300_0x2668();}class SourceMemberHandler extends stream_1[a300_0x422202(0xba)]{constructor({apiVersion:_0x2b3c73,instance:_0xd3a5c0,targetOrgId:_0x3983fc,logger:_0x21961a}){const _0x2a9952=a300_0x422202;super({'objectMode':!![]}),this[_0x2a9952(0x9d)]=new Map(),this[_0x2a9952(0x93)]=0x0,this[_0x2a9952(0xbf)]=_0x2b3c73,this['instance']=_0xd3a5c0,this[_0x2a9952(0xa1)]=_0x3983fc,this['logger']=_0x21961a;}[a300_0x422202(0x90)](){const _0xa15647=a300_0x422202;return new salesforce_1[(_0xa15647(0xc2))]()['select'](...ORG_COMPONENT_SELECT_FIELDS)[_0xa15647(0xbb)](constants_1[_0xa15647(0x94)])[_0xa15647(0xbe)](SOURCE_MEMBER_ID_FIELD_NAME+_0xa15647(0x8e),{'sourceMemberIds':[...this['sourceMemberRecords'][_0xa15647(0xb3)]()]})['andWhere'](ORGANIZATION_NAME_FIELD+_0xa15647(0xae),{'targetOrgId':this[_0xa15647(0xa1)]});}async['getComponentFromFlosum'](){const _0xce82d6=a300_0x422202,_0x197d42=new salesforce_1['CompositeRetrieveData']({'api':this[_0xce82d6(0xbf)],'queryBuilder':this['buildOrgComponentQuery'](),'instance':this[_0xce82d6(0x99)],'isTooling':![]}),_0x3065df=new Map();do{const {records:_0x1db682}=await _0x197d42[_0xce82d6(0xac)]();for(const _0x29c20b of _0x1db682){_0x3065df['set'](_0x29c20b[SOURCE_MEMBER_ID_FIELD_NAME],_0x29c20b);}}while(!_0x197d42['getIsDone']());return _0x3065df;}async[a300_0x422202(0xaf)](_0x4502f9){const _0x31475d=a300_0x422202;this[_0x31475d(0x9d)][_0x31475d(0x98)](_0x4502f9['Id'],_0x4502f9),this[_0x31475d(0x9d)][_0x31475d(0xa8)]===MAX_CHUNK_SIZE&&await this[_0x31475d(0xa2)]();}async[a300_0x422202(0xa2)](){const _0x5baf07=a300_0x422202,_0x210355=await this['getComponentFromFlosum']();for(const [_0x4279d0,_0x4ef6bc]of this['sourceMemberRecords']){const _0xed0daa=_0x210355[_0x5baf07(0xb9)](_0x4279d0);if(_0xed0daa&&_0x4ef6bc[REVISION_COUNTER_FIELD_NAME]===_0xed0daa[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x59b9ae={'sourceMemberId':_0x4ef6bc['Id'],'componentId':(_0xed0daa===null||_0xed0daa===void 0x0?void 0x0:_0xed0daa['Id'])||null,'attachmentId':(_0xed0daa===null||_0xed0daa===void 0x0?void 0x0:_0xed0daa[_0x5baf07(0xb6)])||null,'metadataId':_0x4ef6bc[MEMBER_ID_FIELD_NAME],'metadataType':_0x4ef6bc[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x4ef6bc[IS_NAME_OBSOLETE],'revisionCounter':_0x4ef6bc[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x4ef6bc[CHANGED_BY_FIELD_NAME]};this[_0x5baf07(0x93)]++,this['push'](_0x59b9ae);}this[_0x5baf07(0x9d)]=new Map();}async['_transform'](_0x227136,_0x5a4554,_0x300c46){const _0x3ff196=a300_0x422202;try{await this[_0x3ff196(0xaf)](_0x227136),_0x300c46();}catch(_0xa2226a){_0x300c46(_0xa2226a);}}async[a300_0x422202(0x97)](_0x1cf53e){const _0x352ed6=a300_0x422202;try{this['sourceMemberRecords'][_0x352ed6(0xa8)]&&await this['handle'](),this[_0x352ed6(0x91)][_0x352ed6(0x95)]('Changes\x20found\x20for\x20'+this[_0x352ed6(0x93)]+_0x352ed6(0x8d)),await this['logger'][_0x352ed6(0xa9)](),_0x1cf53e();}catch(_0x4b8a1a){_0x1cf53e(_0x4b8a1a);}}}exports['SourceMemberHandler']=SourceMemberHandler;