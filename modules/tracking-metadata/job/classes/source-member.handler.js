const a300_0x479624=a300_0x276c;(function(_0x15892f,_0xc1763f){const _0x5b5e96=a300_0x276c,_0x1334ee=_0x15892f();while(!![]){try{const _0x3ec195=parseInt(_0x5b5e96(0xc5))/0x1*(-parseInt(_0x5b5e96(0xed))/0x2)+parseInt(_0x5b5e96(0xf4))/0x3+parseInt(_0x5b5e96(0xc3))/0x4*(parseInt(_0x5b5e96(0xf0))/0x5)+-parseInt(_0x5b5e96(0xbd))/0x6+-parseInt(_0x5b5e96(0xbf))/0x7+parseInt(_0x5b5e96(0xf1))/0x8+parseInt(_0x5b5e96(0xf2))/0x9;if(_0x3ec195===_0xc1763f)break;else _0x1334ee['push'](_0x1334ee['shift']());}catch(_0x32609a){_0x1334ee['push'](_0x1334ee['shift']());}}}(a300_0x5278,0x5f058));function a300_0x5278(){const _0x41ae0a=['select','log','getComponentFromFlosum','search','Source_Member_Id__c','logger','Folder__c','addToChunk','Attachment_ID__c','MemberType','Name__c','targetOrgId','handledMembersCounter','QueryBuilder','keys','OrganisationName__c','Revision_Counter__c','instance','where','toString','from','buildOrgComponentQuery','SourceMemberHandler','CompositeRetrieveData','api','defineProperty','ChangedBy','_transform','ORG_COMPONENT_OBJECT_NAME','set','Component_Type__c','Transform','14026cfwHKm','apply','../../constants','190yGergF','800888luVOTm','7483266fMdIul','constructor','1305882YPCpCF','sourceMemberRecords','FLOSUM_NAMESPACE','2797056Klsjue','stream','5424426vkgfQO','RevisionCounter','size','API_Name__c','74236YgBmQX','update','63YvEhti','Changes\x20found\x20for\x20','(((.+)+)+)+$','execute','handle','andWhere','@flosum/salesforce','__esModule'];a300_0x5278=function(){return _0x41ae0a;};return a300_0x5278();}const a300_0x4f6151=(function(){let _0x5c5ef9=!![];return function(_0x4abc2f,_0xc32ea0){const _0x2dbd4a=_0x5c5ef9?function(){const _0x280923=a300_0x276c;if(_0xc32ea0){const _0x303b3f=_0xc32ea0[_0x280923(0xee)](_0x4abc2f,arguments);return _0xc32ea0=null,_0x303b3f;}}:function(){};return _0x5c5ef9=![],_0x2dbd4a;};}()),a300_0x28b0a5=a300_0x4f6151(this,function(){const _0x3b492f=a300_0x276c;return a300_0x28b0a5['toString']()[_0x3b492f(0xd0)](_0x3b492f(0xc7))[_0x3b492f(0xe0)]()[_0x3b492f(0xf3)](a300_0x28b0a5)[_0x3b492f(0xd0)](_0x3b492f(0xc7));});function a300_0x276c(_0xb107da,_0x56926b){const _0x270a5a=a300_0x5278();return a300_0x276c=function(_0x28b0a5,_0x4f6151){_0x28b0a5=_0x28b0a5-0xbd;let _0x527835=_0x270a5a[_0x28b0a5];return _0x527835;},a300_0x276c(_0xb107da,_0x56926b);}a300_0x28b0a5();'use strict';Object[a300_0x479624(0xe6)](exports,a300_0x479624(0xcc),{'value':!![]}),exports[a300_0x479624(0xe3)]=void 0x0;const stream_1=require(a300_0x479624(0xbe)),salesforce_1=require(a300_0x479624(0xcb)),constants_1=require(a300_0x479624(0xef)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x479624(0xc0),IS_NAME_OBSOLETE='IsNameObsolete',MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME=a300_0x479624(0xd6),CHANGED_BY_FIELD_NAME=a300_0x479624(0xe7),SOURCE_MEMBER_ID_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a300_0x479624(0xd1),ORGANIZATION_NAME_FIELD=constants_2[a300_0x479624(0xf6)]+a300_0x479624(0xdc),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x479624(0xf6)]+a300_0x479624(0xdd),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2['FLOSUM_NAMESPACE']+a300_0x479624(0xdd),constants_2['FLOSUM_NAMESPACE']+a300_0x479624(0xeb),constants_2[a300_0x479624(0xf6)]+a300_0x479624(0xc2),constants_2[a300_0x479624(0xf6)]+a300_0x479624(0xd7),constants_2[a300_0x479624(0xf6)]+a300_0x479624(0xd1),constants_2[a300_0x479624(0xf6)]+a300_0x479624(0xdc),constants_2[a300_0x479624(0xf6)]+'Attachment_ID__c',constants_2[a300_0x479624(0xf6)]+a300_0x479624(0xd3)];class SourceMemberHandler extends stream_1[a300_0x479624(0xec)]{constructor({apiVersion:_0x51637e,instance:_0x34923d,targetOrgId:_0x2cca60,logger:_0x4ff5f4}){const _0x33062e=a300_0x479624;super({'objectMode':!![]}),this[_0x33062e(0xf5)]=new Map(),this[_0x33062e(0xd9)]=0x0,this[_0x33062e(0xe5)]=_0x51637e,this[_0x33062e(0xde)]=_0x34923d,this[_0x33062e(0xd8)]=_0x2cca60,this[_0x33062e(0xd2)]=_0x4ff5f4;}[a300_0x479624(0xe2)](){const _0x4e4616=a300_0x479624;return new salesforce_1[(_0x4e4616(0xda))]()[_0x4e4616(0xcd)](...ORG_COMPONENT_SELECT_FIELDS)[_0x4e4616(0xe1)](constants_1[_0x4e4616(0xe9)])[_0x4e4616(0xdf)](SOURCE_MEMBER_ID_FIELD_NAME+'\x20IN\x20(:sourceMemberIds)',{'sourceMemberIds':[...this['sourceMemberRecords'][_0x4e4616(0xdb)]()]})[_0x4e4616(0xca)](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this['targetOrgId']});}async[a300_0x479624(0xcf)](){const _0x175839=a300_0x479624,_0x2e9cce=new salesforce_1[(_0x175839(0xe4))]({'api':this[_0x175839(0xe5)],'queryBuilder':this[_0x175839(0xe2)](),'instance':this[_0x175839(0xde)],'isTooling':![]}),_0x1913f0=new Map();do{const {records:_0x437797}=await _0x2e9cce[_0x175839(0xc8)]();for(const _0x24e2a6 of _0x437797){_0x1913f0[_0x175839(0xea)](_0x24e2a6[SOURCE_MEMBER_ID_FIELD_NAME],_0x24e2a6);}}while(!_0x2e9cce['getIsDone']());return _0x1913f0;}async[a300_0x479624(0xd4)](_0x21b1d1){const _0x454e74=a300_0x479624;this[_0x454e74(0xf5)][_0x454e74(0xea)](_0x21b1d1['Id'],_0x21b1d1),this[_0x454e74(0xf5)][_0x454e74(0xc1)]===MAX_CHUNK_SIZE&&await this[_0x454e74(0xc9)]();}async[a300_0x479624(0xc9)](){const _0x1fdf96=a300_0x479624,_0x73d96=await this[_0x1fdf96(0xcf)]();for(const [_0x354d94,_0x4b03f3]of this['sourceMemberRecords']){const _0x1e52a2=_0x73d96['get'](_0x354d94);if(_0x1e52a2&&_0x4b03f3[REVISION_COUNTER_FIELD_NAME]===_0x1e52a2[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x445cc0={'sourceMemberId':_0x4b03f3['Id'],'componentId':(_0x1e52a2===null||_0x1e52a2===void 0x0?void 0x0:_0x1e52a2['Id'])||null,'attachmentId':(_0x1e52a2===null||_0x1e52a2===void 0x0?void 0x0:_0x1e52a2[_0x1fdf96(0xd5)])||null,'metadataId':_0x4b03f3[MEMBER_ID_FIELD_NAME],'metadataType':_0x4b03f3[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x4b03f3[IS_NAME_OBSOLETE],'revisionCounter':_0x4b03f3[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x4b03f3[CHANGED_BY_FIELD_NAME]};this[_0x1fdf96(0xd9)]++,this['push'](_0x445cc0);}this[_0x1fdf96(0xf5)]=new Map();}async[a300_0x479624(0xe8)](_0x15c46c,_0x2bed3b,_0x2fe768){const _0x3c61cb=a300_0x479624;try{await this[_0x3c61cb(0xd4)](_0x15c46c),_0x2fe768();}catch(_0x8191dc){_0x2fe768(_0x8191dc);}}async['_flush'](_0x2004d7){const _0x3f61ff=a300_0x479624;try{this[_0x3f61ff(0xf5)]['size']&&await this[_0x3f61ff(0xc9)](),this[_0x3f61ff(0xd2)][_0x3f61ff(0xce)](_0x3f61ff(0xc6)+this[_0x3f61ff(0xd9)]+'\x20components'),await this[_0x3f61ff(0xd2)][_0x3f61ff(0xc4)](),_0x2004d7();}catch(_0x381ca2){_0x2004d7(_0x381ca2);}}}exports['SourceMemberHandler']=SourceMemberHandler;