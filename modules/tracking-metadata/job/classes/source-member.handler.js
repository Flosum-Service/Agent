const a343_0x541d81=a343_0x237f;function a343_0x237f(_0x41cdca,_0x44e841){const _0x37482c=a343_0x3fd7();return a343_0x237f=function(_0x5e2c66,_0x337e29){_0x5e2c66=_0x5e2c66-0xb1;let _0x3fd7e9=_0x37482c[_0x5e2c66];return _0x3fd7e9;},a343_0x237f(_0x41cdca,_0x44e841);}(function(_0x589703,_0x380f29){const _0x4d2523=a343_0x237f,_0x5d6508=_0x589703();while(!![]){try{const _0x18ff67=parseInt(_0x4d2523(0xe7))/0x1*(parseInt(_0x4d2523(0xb3))/0x2)+parseInt(_0x4d2523(0xe5))/0x3*(-parseInt(_0x4d2523(0xdb))/0x4)+parseInt(_0x4d2523(0xc3))/0x5+-parseInt(_0x4d2523(0xb9))/0x6+parseInt(_0x4d2523(0xc6))/0x7+parseInt(_0x4d2523(0xcf))/0x8*(-parseInt(_0x4d2523(0xbd))/0x9)+parseInt(_0x4d2523(0xe4))/0xa;if(_0x18ff67===_0x380f29)break;else _0x5d6508['push'](_0x5d6508['shift']());}catch(_0x485225){_0x5d6508['push'](_0x5d6508['shift']());}}}(a343_0x3fd7,0x4b56e));const a343_0x337e29=(function(){let _0x348ca0=!![];return function(_0x5adf36,_0x1b8b0b){const _0x1ace9e=_0x348ca0?function(){const _0x3b901d=a343_0x237f;if(_0x1b8b0b){const _0x2f59f3=_0x1b8b0b[_0x3b901d(0xbb)](_0x5adf36,arguments);return _0x1b8b0b=null,_0x2f59f3;}}:function(){};return _0x348ca0=![],_0x1ace9e;};}()),a343_0x5e2c66=a343_0x337e29(this,function(){const _0x1fadfe=a343_0x237f;return a343_0x5e2c66['toString']()[_0x1fadfe(0xcd)](_0x1fadfe(0xc0))[_0x1fadfe(0xd1)]()[_0x1fadfe(0xba)](a343_0x5e2c66)[_0x1fadfe(0xcd)](_0x1fadfe(0xc0));});function a343_0x3fd7(){const _0x15bd86=['targetOrgId','QueryBuilder','Revision_Counter__c','1728318CzEdvK','constructor','apply','CompositeRetrieveData','18072tHWdCJ','sourceMemberRecords','stream','(((.+)+)+)+$','keys','addToChunk','2289845lZNsws','logger','set','2506371UcPKBq','@flosum/salesforce','defineProperty','Transform','handledMembersCounter','_flush','from','search','\x20IN\x20(:sourceMemberIds)','2416eTelAG','../../constants','toString','where','API_Name__c','SourceMemberHandler','andWhere','update','select','__esModule','get','Attachment_ID__c','229268kGPzmM','instance','OrganisationName__c','Folder__c','\x20=\x20:targetOrgId','api','handle','FLOSUM_NAMESPACE','IsNameObsolete','1459350hFLgex','3STuaBg','buildOrgComponentQuery','9043yVOJGP','\x20components','execute','getComponentFromFlosum','66COjOYd','push','log'];a343_0x3fd7=function(){return _0x15bd86;};return a343_0x3fd7();}a343_0x5e2c66();'use strict';Object[a343_0x541d81(0xc8)](exports,a343_0x541d81(0xd8),{'value':!![]}),exports[a343_0x541d81(0xd4)]=void 0x0;const stream_1=require(a343_0x541d81(0xbf)),salesforce_1=require(a343_0x541d81(0xc7)),constants_1=require(a343_0x541d81(0xd0)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME='RevisionCounter',IS_NAME_OBSOLETE=a343_0x541d81(0xe3),MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME='MemberType',CHANGED_BY_FIELD_NAME='ChangedBy',SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x541d81(0xe2)]+'Source_Member_Id__c',ORGANIZATION_NAME_FIELD=constants_2[a343_0x541d81(0xe2)]+a343_0x541d81(0xdd),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a343_0x541d81(0xb8),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a343_0x541d81(0xe2)]+a343_0x541d81(0xb8),constants_2[a343_0x541d81(0xe2)]+'Component_Type__c',constants_2[a343_0x541d81(0xe2)]+a343_0x541d81(0xd3),constants_2[a343_0x541d81(0xe2)]+'Name__c',constants_2[a343_0x541d81(0xe2)]+'Source_Member_Id__c',constants_2[a343_0x541d81(0xe2)]+a343_0x541d81(0xdd),constants_2[a343_0x541d81(0xe2)]+a343_0x541d81(0xda),constants_2[a343_0x541d81(0xe2)]+a343_0x541d81(0xde)];class SourceMemberHandler extends stream_1[a343_0x541d81(0xc9)]{constructor({apiVersion:_0x50239f,instance:_0x2fc506,targetOrgId:_0x5c15c3,logger:_0x2fa0b0}){const _0x268fbf=a343_0x541d81;super({'objectMode':!![]}),this[_0x268fbf(0xbe)]=new Map(),this[_0x268fbf(0xca)]=0x0,this['api']=_0x50239f,this[_0x268fbf(0xdc)]=_0x2fc506,this['targetOrgId']=_0x5c15c3,this[_0x268fbf(0xc4)]=_0x2fa0b0;}[a343_0x541d81(0xe6)](){const _0x46dbf4=a343_0x541d81;return new salesforce_1[(_0x46dbf4(0xb7))]()[_0x46dbf4(0xd7)](...ORG_COMPONENT_SELECT_FIELDS)[_0x46dbf4(0xcc)](constants_1['ORG_COMPONENT_OBJECT_NAME'])[_0x46dbf4(0xd2)](SOURCE_MEMBER_ID_FIELD_NAME+_0x46dbf4(0xce),{'sourceMemberIds':[...this['sourceMemberRecords'][_0x46dbf4(0xc1)]()]})[_0x46dbf4(0xd5)](ORGANIZATION_NAME_FIELD+_0x46dbf4(0xdf),{'targetOrgId':this[_0x46dbf4(0xb6)]});}async[a343_0x541d81(0xb2)](){const _0x10eff6=a343_0x541d81,_0x21aae6=new salesforce_1[(_0x10eff6(0xbc))]({'api':this[_0x10eff6(0xe0)],'queryBuilder':this[_0x10eff6(0xe6)](),'instance':this[_0x10eff6(0xdc)],'isTooling':![]}),_0x45decc=new Map();do{const {records:_0x347581}=await _0x21aae6[_0x10eff6(0xb1)]();for(const _0x30a5a5 of _0x347581){_0x45decc[_0x10eff6(0xc5)](_0x30a5a5[SOURCE_MEMBER_ID_FIELD_NAME],_0x30a5a5);}}while(!_0x21aae6['getIsDone']());return _0x45decc;}async[a343_0x541d81(0xc2)](_0x2d6587){const _0x59c7e8=a343_0x541d81;this[_0x59c7e8(0xbe)]['set'](_0x2d6587['Id'],_0x2d6587),this[_0x59c7e8(0xbe)]['size']===MAX_CHUNK_SIZE&&await this[_0x59c7e8(0xe1)]();}async[a343_0x541d81(0xe1)](){const _0x543786=a343_0x541d81,_0x48fa7b=await this[_0x543786(0xb2)]();for(const [_0x53d4cd,_0x505b47]of this[_0x543786(0xbe)]){const _0x3927aa=_0x48fa7b[_0x543786(0xd9)](_0x53d4cd);if(_0x3927aa&&_0x505b47[REVISION_COUNTER_FIELD_NAME]===_0x3927aa[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x592c33={'sourceMemberId':_0x505b47['Id'],'componentId':(_0x3927aa===null||_0x3927aa===void 0x0?void 0x0:_0x3927aa['Id'])||null,'attachmentId':(_0x3927aa===null||_0x3927aa===void 0x0?void 0x0:_0x3927aa[_0x543786(0xda)])||null,'metadataId':_0x505b47[MEMBER_ID_FIELD_NAME],'metadataType':_0x505b47[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x505b47[IS_NAME_OBSOLETE],'revisionCounter':_0x505b47[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x505b47[CHANGED_BY_FIELD_NAME]};this[_0x543786(0xca)]++,this[_0x543786(0xb4)](_0x592c33);}this[_0x543786(0xbe)]=new Map();}async['_transform'](_0x4bc151,_0x588321,_0x334b6c){const _0x2e9bd0=a343_0x541d81;try{await this[_0x2e9bd0(0xc2)](_0x4bc151),_0x334b6c();}catch(_0x360a77){_0x334b6c(_0x360a77);}}async[a343_0x541d81(0xcb)](_0x2404d5){const _0x3d5f1a=a343_0x541d81;try{this[_0x3d5f1a(0xbe)]['size']&&await this['handle'](),this[_0x3d5f1a(0xc4)][_0x3d5f1a(0xb5)]('Changes\x20found\x20for\x20'+this[_0x3d5f1a(0xca)]+_0x3d5f1a(0xe8)),await this['logger'][_0x3d5f1a(0xd6)](),_0x2404d5();}catch(_0x1ba8e8){_0x2404d5(_0x1ba8e8);}}}exports[a343_0x541d81(0xd4)]=SourceMemberHandler;