const a315_0xc3905d=a315_0x5d63;function a315_0x3395(){const _0x4b7353=['@flosum/salesforce','targetOrgId','192QJFwEB','12070944eDYEbk','api','SourceMemberHandler','1865350qFywnT','size','toString','2310iEGxxv','where','\x20components','\x20=\x20:targetOrgId','FLOSUM_NAMESPACE','andWhere','(((.+)+)+)+$','handledMembersCounter','Attachment_ID__c','Revision_Counter__c','apply','Transform','instance','OrganisationName__c','constructor','stream','Changes\x20found\x20for\x20','5786IZxvZl','get','handle','__esModule','MemberType','3533286SNkFBy','select','push','8pgAbmu','_transform','IsNameObsolete','Source_Member_Id__c','log','Name__c','RevisionCounter','addToChunk','13740kKbrEn','getComponentFromFlosum','set','search','66647TxWQMH','8qGKKrx','ORG_COMPONENT_OBJECT_NAME','QueryBuilder','API_Name__c','Folder__c','\x20IN\x20(:sourceMemberIds)','logger','../../constants','248246CvekLD','execute','ChangedBy','update','../../../../constants','_flush','sourceMemberRecords','17946bSIxpv','buildOrgComponentQuery'];a315_0x3395=function(){return _0x4b7353;};return a315_0x3395();}(function(_0xc86e32,_0xdcd6c7){const _0x9c8390=a315_0x5d63,_0x509580=_0xc86e32();while(!![]){try{const _0x2ae35a=-parseInt(_0x9c8390(0x1cb))/0x1*(parseInt(_0x9c8390(0x1c3))/0x2)+-parseInt(_0x9c8390(0x1b3))/0x3+-parseInt(_0x9c8390(0x1b6))/0x4*(-parseInt(_0x9c8390(0x19a))/0x5)+parseInt(_0x9c8390(0x196))/0x6*(-parseInt(_0x9c8390(0x1c2))/0x7)+parseInt(_0x9c8390(0x197))/0x8+-parseInt(_0x9c8390(0x1d2))/0x9*(-parseInt(_0x9c8390(0x19d))/0xa)+parseInt(_0x9c8390(0x1ae))/0xb*(parseInt(_0x9c8390(0x1be))/0xc);if(_0x2ae35a===_0xdcd6c7)break;else _0x509580['push'](_0x509580['shift']());}catch(_0xe989ff){_0x509580['push'](_0x509580['shift']());}}}(a315_0x3395,0xcdaea));const a315_0xf0b446=(function(){let _0x155f5d=!![];return function(_0x526390,_0x2a09c1){const _0x28c291=_0x155f5d?function(){const _0xdae636=a315_0x5d63;if(_0x2a09c1){const _0x49fbaa=_0x2a09c1[_0xdae636(0x1a7)](_0x526390,arguments);return _0x2a09c1=null,_0x49fbaa;}}:function(){};return _0x155f5d=![],_0x28c291;};}()),a315_0x532452=a315_0xf0b446(this,function(){const _0x300d66=a315_0x5d63;return a315_0x532452['toString']()[_0x300d66(0x1c1)](_0x300d66(0x1a3))[_0x300d66(0x19c)]()[_0x300d66(0x1ab)](a315_0x532452)['search'](_0x300d66(0x1a3));});a315_0x532452();'use strict';Object['defineProperty'](exports,a315_0xc3905d(0x1b1),{'value':!![]}),exports['SourceMemberHandler']=void 0x0;const stream_1=require(a315_0xc3905d(0x1ac)),salesforce_1=require(a315_0xc3905d(0x194)),constants_1=require(a315_0xc3905d(0x1ca)),constants_2=require(a315_0xc3905d(0x1cf)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a315_0xc3905d(0x1bc),IS_NAME_OBSOLETE=a315_0xc3905d(0x1b8),MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME=a315_0xc3905d(0x1b2),CHANGED_BY_FIELD_NAME=a315_0xc3905d(0x1cd),SOURCE_MEMBER_ID_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a315_0xc3905d(0x1b9),ORGANIZATION_NAME_FIELD=constants_2[a315_0xc3905d(0x1a1)]+a315_0xc3905d(0x1aa),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a315_0xc3905d(0x1a1)]+a315_0xc3905d(0x1a6),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a315_0xc3905d(0x1a1)]+a315_0xc3905d(0x1a6),constants_2[a315_0xc3905d(0x1a1)]+'Component_Type__c',constants_2[a315_0xc3905d(0x1a1)]+a315_0xc3905d(0x1c6),constants_2[a315_0xc3905d(0x1a1)]+a315_0xc3905d(0x1bb),constants_2[a315_0xc3905d(0x1a1)]+a315_0xc3905d(0x1b9),constants_2[a315_0xc3905d(0x1a1)]+'OrganisationName__c',constants_2['FLOSUM_NAMESPACE']+a315_0xc3905d(0x1a5),constants_2[a315_0xc3905d(0x1a1)]+a315_0xc3905d(0x1c7)];class SourceMemberHandler extends stream_1[a315_0xc3905d(0x1a8)]{constructor({apiVersion:_0x34e47a,instance:_0x377393,targetOrgId:_0x2e8fb2,logger:_0x1ebe00}){const _0x5b3374=a315_0xc3905d;super({'objectMode':!![]}),this[_0x5b3374(0x1d1)]=new Map(),this['handledMembersCounter']=0x0,this['api']=_0x34e47a,this[_0x5b3374(0x1a9)]=_0x377393,this['targetOrgId']=_0x2e8fb2,this['logger']=_0x1ebe00;}[a315_0xc3905d(0x1d3)](){const _0x951372=a315_0xc3905d;return new salesforce_1[(_0x951372(0x1c5))]()[_0x951372(0x1b4)](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0x951372(0x1c4)])[_0x951372(0x19e)](SOURCE_MEMBER_ID_FIELD_NAME+_0x951372(0x1c8),{'sourceMemberIds':[...this[_0x951372(0x1d1)]['keys']()]})[_0x951372(0x1a2)](ORGANIZATION_NAME_FIELD+_0x951372(0x1a0),{'targetOrgId':this[_0x951372(0x195)]});}async[a315_0xc3905d(0x1bf)](){const _0x5766d0=a315_0xc3905d,_0x5d6859=new salesforce_1['CompositeRetrieveData']({'api':this[_0x5766d0(0x198)],'queryBuilder':this[_0x5766d0(0x1d3)](),'instance':this['instance'],'isTooling':![]}),_0x4e4a51=new Map();do{const {records:_0x2347f9}=await _0x5d6859[_0x5766d0(0x1cc)]();for(const _0x466fd4 of _0x2347f9){_0x4e4a51['set'](_0x466fd4[SOURCE_MEMBER_ID_FIELD_NAME],_0x466fd4);}}while(!_0x5d6859['getIsDone']());return _0x4e4a51;}async[a315_0xc3905d(0x1bd)](_0x45ce45){const _0x2d95c9=a315_0xc3905d;this[_0x2d95c9(0x1d1)][_0x2d95c9(0x1c0)](_0x45ce45['Id'],_0x45ce45),this[_0x2d95c9(0x1d1)][_0x2d95c9(0x19b)]===MAX_CHUNK_SIZE&&await this[_0x2d95c9(0x1b0)]();}async[a315_0xc3905d(0x1b0)](){const _0x4d961e=a315_0xc3905d,_0xa5bfeb=await this[_0x4d961e(0x1bf)]();for(const [_0x3e8d72,_0x3804a8]of this[_0x4d961e(0x1d1)]){const _0x5bee97=_0xa5bfeb[_0x4d961e(0x1af)](_0x3e8d72);if(_0x5bee97&&_0x3804a8[REVISION_COUNTER_FIELD_NAME]===_0x5bee97[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x1fd363={'sourceMemberId':_0x3804a8['Id'],'componentId':(_0x5bee97===null||_0x5bee97===void 0x0?void 0x0:_0x5bee97['Id'])||null,'attachmentId':(_0x5bee97===null||_0x5bee97===void 0x0?void 0x0:_0x5bee97[_0x4d961e(0x1a5)])||null,'metadataId':_0x3804a8[MEMBER_ID_FIELD_NAME],'metadataType':_0x3804a8[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x3804a8[IS_NAME_OBSOLETE],'revisionCounter':_0x3804a8[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x3804a8[CHANGED_BY_FIELD_NAME]};this[_0x4d961e(0x1a4)]++,this[_0x4d961e(0x1b5)](_0x1fd363);}this[_0x4d961e(0x1d1)]=new Map();}async[a315_0xc3905d(0x1b7)](_0x206d30,_0xac301e,_0x1a46c8){const _0x42a630=a315_0xc3905d;try{await this[_0x42a630(0x1bd)](_0x206d30),_0x1a46c8();}catch(_0x5f5b9b){_0x1a46c8(_0x5f5b9b);}}async[a315_0xc3905d(0x1d0)](_0x2d978b){const _0x57ecd1=a315_0xc3905d;try{this['sourceMemberRecords']['size']&&await this[_0x57ecd1(0x1b0)](),this['logger'][_0x57ecd1(0x1ba)](_0x57ecd1(0x1ad)+this[_0x57ecd1(0x1a4)]+_0x57ecd1(0x19f)),await this[_0x57ecd1(0x1c9)][_0x57ecd1(0x1ce)](),_0x2d978b();}catch(_0x5a467b){_0x2d978b(_0x5a467b);}}}function a315_0x5d63(_0x193739,_0x35c08f){const _0x25a2db=a315_0x3395();return a315_0x5d63=function(_0x532452,_0xf0b446){_0x532452=_0x532452-0x194;let _0x3395d0=_0x25a2db[_0x532452];return _0x3395d0;},a315_0x5d63(_0x193739,_0x35c08f);}exports[a315_0xc3905d(0x199)]=SourceMemberHandler;