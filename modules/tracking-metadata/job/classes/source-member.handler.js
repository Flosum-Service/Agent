const a300_0x687562=a300_0x1083;(function(_0x382a58,_0x153c6f){const _0xebd170=a300_0x1083,_0x53c00a=_0x382a58();while(!![]){try{const _0x4086df=-parseInt(_0xebd170(0x1cd))/0x1+parseInt(_0xebd170(0x1c8))/0x2+parseInt(_0xebd170(0x1c7))/0x3+parseInt(_0xebd170(0x1ef))/0x4+-parseInt(_0xebd170(0x1c3))/0x5+-parseInt(_0xebd170(0x1e3))/0x6*(-parseInt(_0xebd170(0x1d9))/0x7)+-parseInt(_0xebd170(0x1d7))/0x8;if(_0x4086df===_0x153c6f)break;else _0x53c00a['push'](_0x53c00a['shift']());}catch(_0x41046f){_0x53c00a['push'](_0x53c00a['shift']());}}}(a300_0x1b2f,0x32306));const a300_0x329849=(function(){let _0x340635=!![];return function(_0xc4620c,_0x5107b0){const _0x3896c=_0x340635?function(){const _0xf52283=a300_0x1083;if(_0x5107b0){const _0x4aa809=_0x5107b0[_0xf52283(0x1d3)](_0xc4620c,arguments);return _0x5107b0=null,_0x4aa809;}}:function(){};return _0x340635=![],_0x3896c;};}()),a300_0xc2af8a=a300_0x329849(this,function(){const _0x187ab4=a300_0x1083;return a300_0xc2af8a[_0x187ab4(0x1e4)]()[_0x187ab4(0x1ce)]('(((.+)+)+)+$')[_0x187ab4(0x1e4)]()['constructor'](a300_0xc2af8a)[_0x187ab4(0x1ce)]('(((.+)+)+)+$');});a300_0xc2af8a();'use strict';function a300_0x1b2f(){const _0x10941c=['api','6EMByYs','toString','CompositeRetrieveData','\x20components','RevisionCounter','IsNameObsolete','instance','@flosum/salesforce','logger','set','getIsDone','addToChunk','1518032sYUcbW','Source_Member_Id__c','buildOrgComponentQuery','ORG_COMPONENT_OBJECT_NAME','getComponentFromFlosum','targetOrgId','handle','854555ruxUGG','where','Attachment_ID__c','__esModule','280227EWXEOb','573028LqRYuX','../../../../constants','FLOSUM_NAMESPACE','stream','sourceMemberRecords','395653AmBBtz','search','Revision_Counter__c','andWhere','select','\x20=\x20:targetOrgId','apply','MemberIdOrName','size','SourceMemberHandler','677208JuZFct','push','681506KhRgNp','handledMembersCounter','Component_Type__c','OrganisationName__c','keys','../../constants','MemberType','Changes\x20found\x20for\x20','Name__c'];a300_0x1b2f=function(){return _0x10941c;};return a300_0x1b2f();}Object['defineProperty'](exports,a300_0x687562(0x1c6),{'value':!![]}),exports[a300_0x687562(0x1d6)]=void 0x0;const stream_1=require(a300_0x687562(0x1cb)),salesforce_1=require(a300_0x687562(0x1ea)),constants_1=require(a300_0x687562(0x1de)),constants_2=require(a300_0x687562(0x1c9)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x687562(0x1e7),IS_NAME_OBSOLETE=a300_0x687562(0x1e8),MEMBER_ID_FIELD_NAME=a300_0x687562(0x1d4),MEMBER_TYPE_FIELD_NAME=a300_0x687562(0x1df),CHANGED_BY_FIELD_NAME='ChangedBy',SOURCE_MEMBER_ID_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a300_0x687562(0x1bd),ORGANIZATION_NAME_FIELD=constants_2[a300_0x687562(0x1ca)]+a300_0x687562(0x1dc),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x687562(0x1ca)]+a300_0x687562(0x1cf),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a300_0x687562(0x1ca)]+a300_0x687562(0x1cf),constants_2[a300_0x687562(0x1ca)]+a300_0x687562(0x1db),constants_2[a300_0x687562(0x1ca)]+'API_Name__c',constants_2[a300_0x687562(0x1ca)]+a300_0x687562(0x1e1),constants_2[a300_0x687562(0x1ca)]+a300_0x687562(0x1bd),constants_2[a300_0x687562(0x1ca)]+'OrganisationName__c',constants_2[a300_0x687562(0x1ca)]+a300_0x687562(0x1c5),constants_2[a300_0x687562(0x1ca)]+'Folder__c'];class SourceMemberHandler extends stream_1['Transform']{constructor({apiVersion:_0x2c1253,instance:_0x53e300,targetOrgId:_0x14cefa,logger:_0x1478d3}){const _0x4bf072=a300_0x687562;super({'objectMode':!![]}),this[_0x4bf072(0x1cc)]=new Map(),this[_0x4bf072(0x1da)]=0x0,this['api']=_0x2c1253,this[_0x4bf072(0x1e9)]=_0x53e300,this['targetOrgId']=_0x14cefa,this[_0x4bf072(0x1eb)]=_0x1478d3;}[a300_0x687562(0x1be)](){const _0xcdc19b=a300_0x687562;return new salesforce_1['QueryBuilder']()[_0xcdc19b(0x1d1)](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0xcdc19b(0x1bf)])[_0xcdc19b(0x1c4)](SOURCE_MEMBER_ID_FIELD_NAME+'\x20IN\x20(:sourceMemberIds)',{'sourceMemberIds':[...this[_0xcdc19b(0x1cc)][_0xcdc19b(0x1dd)]()]})[_0xcdc19b(0x1d0)](ORGANIZATION_NAME_FIELD+_0xcdc19b(0x1d2),{'targetOrgId':this[_0xcdc19b(0x1c1)]});}async[a300_0x687562(0x1c0)](){const _0x2bb9c8=a300_0x687562,_0xc73e53=new salesforce_1[(_0x2bb9c8(0x1e5))]({'api':this[_0x2bb9c8(0x1e2)],'queryBuilder':this['buildOrgComponentQuery'](),'instance':this[_0x2bb9c8(0x1e9)],'isTooling':![]}),_0x4ad061=new Map();do{const {records:_0x3ed98c}=await _0xc73e53['execute']();for(const _0xd40dd7 of _0x3ed98c){_0x4ad061[_0x2bb9c8(0x1ec)](_0xd40dd7[SOURCE_MEMBER_ID_FIELD_NAME],_0xd40dd7);}}while(!_0xc73e53[_0x2bb9c8(0x1ed)]());return _0x4ad061;}async[a300_0x687562(0x1ee)](_0x5be18e){const _0xc9a860=a300_0x687562;this[_0xc9a860(0x1cc)]['set'](_0x5be18e['Id'],_0x5be18e),this[_0xc9a860(0x1cc)][_0xc9a860(0x1d5)]===MAX_CHUNK_SIZE&&await this[_0xc9a860(0x1c2)]();}async['handle'](){const _0x25ad6b=a300_0x687562,_0x179536=await this['getComponentFromFlosum']();for(const [_0x19ed9a,_0x361b7d]of this[_0x25ad6b(0x1cc)]){const _0xfa34ed=_0x179536['get'](_0x19ed9a);if(_0xfa34ed&&_0x361b7d[REVISION_COUNTER_FIELD_NAME]===_0xfa34ed[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x9037e1={'sourceMemberId':_0x361b7d['Id'],'componentId':(_0xfa34ed===null||_0xfa34ed===void 0x0?void 0x0:_0xfa34ed['Id'])||null,'attachmentId':(_0xfa34ed===null||_0xfa34ed===void 0x0?void 0x0:_0xfa34ed[_0x25ad6b(0x1c5)])||null,'metadataId':_0x361b7d[MEMBER_ID_FIELD_NAME],'metadataType':_0x361b7d[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x361b7d[IS_NAME_OBSOLETE],'revisionCounter':_0x361b7d[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x361b7d[CHANGED_BY_FIELD_NAME]};this[_0x25ad6b(0x1da)]++,this[_0x25ad6b(0x1d8)](_0x9037e1);}this[_0x25ad6b(0x1cc)]=new Map();}async['_transform'](_0x4232f7,_0x1a7d47,_0x30b1d2){const _0x43e697=a300_0x687562;try{await this[_0x43e697(0x1ee)](_0x4232f7),_0x30b1d2();}catch(_0x358101){_0x30b1d2(_0x358101);}}async['_flush'](_0x5e8cfc){const _0x2977b4=a300_0x687562;try{this['sourceMemberRecords'][_0x2977b4(0x1d5)]&&await this[_0x2977b4(0x1c2)](),this[_0x2977b4(0x1eb)]['log'](_0x2977b4(0x1e0)+this[_0x2977b4(0x1da)]+_0x2977b4(0x1e6)),await this['logger']['update'](),_0x5e8cfc();}catch(_0xfb254){_0x5e8cfc(_0xfb254);}}}function a300_0x1083(_0x50185b,_0x5ac4e7){const _0xc95299=a300_0x1b2f();return a300_0x1083=function(_0xc2af8a,_0x329849){_0xc2af8a=_0xc2af8a-0x1bd;let _0x1b2f39=_0xc95299[_0xc2af8a];return _0x1b2f39;},a300_0x1083(_0x50185b,_0x5ac4e7);}exports[a300_0x687562(0x1d6)]=SourceMemberHandler;