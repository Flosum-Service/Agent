const a300_0x26cf03=a300_0x3007;(function(_0x4fae3b,_0x13a58f){const _0x46ca66=a300_0x3007,_0x1d95bb=_0x4fae3b();while(!![]){try{const _0x84d9b=parseInt(_0x46ca66(0x6e))/0x1*(parseInt(_0x46ca66(0x6d))/0x2)+parseInt(_0x46ca66(0x69))/0x3+-parseInt(_0x46ca66(0x7b))/0x4*(parseInt(_0x46ca66(0x80))/0x5)+-parseInt(_0x46ca66(0x90))/0x6+parseInt(_0x46ca66(0x76))/0x7*(parseInt(_0x46ca66(0x74))/0x8)+-parseInt(_0x46ca66(0x6b))/0x9+-parseInt(_0x46ca66(0x6f))/0xa;if(_0x84d9b===_0x13a58f)break;else _0x1d95bb['push'](_0x1d95bb['shift']());}catch(_0x9443b7){_0x1d95bb['push'](_0x1d95bb['shift']());}}}(a300_0x1b35,0xa78da));const a300_0x320cd5=(function(){let _0x3cdb5c=!![];return function(_0x331be6,_0x2931c7){const _0x3b99c1=_0x3cdb5c?function(){const _0x1985a4=a300_0x3007;if(_0x2931c7){const _0x15dfe3=_0x2931c7[_0x1985a4(0x72)](_0x331be6,arguments);return _0x2931c7=null,_0x15dfe3;}}:function(){};return _0x3cdb5c=![],_0x3b99c1;};}()),a300_0x2bacd7=a300_0x320cd5(this,function(){const _0x46f655=a300_0x3007;return a300_0x2bacd7[_0x46f655(0x95)]()[_0x46f655(0x9a)]('(((.+)+)+)+$')[_0x46f655(0x95)]()[_0x46f655(0x84)](a300_0x2bacd7)[_0x46f655(0x9a)]('(((.+)+)+)+$');});a300_0x2bacd7();'use strict';Object[a300_0x26cf03(0x87)](exports,a300_0x26cf03(0x6a),{'value':!![]}),exports['SourceMemberHandler']=void 0x0;function a300_0x3007(_0x3a9f24,_0x5a9492){const _0x2a8f1e=a300_0x1b35();return a300_0x3007=function(_0x2bacd7,_0x320cd5){_0x2bacd7=_0x2bacd7-0x66;let _0x1b35bb=_0x2a8f1e[_0x2bacd7];return _0x1b35bb;},a300_0x3007(_0x3a9f24,_0x5a9492);}const stream_1=require('stream'),salesforce_1=require(a300_0x26cf03(0x81)),constants_1=require(a300_0x26cf03(0x70)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x26cf03(0x77),IS_NAME_OBSOLETE=a300_0x26cf03(0x99),MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME=a300_0x26cf03(0x8b),CHANGED_BY_FIELD_NAME=a300_0x26cf03(0x78),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a300_0x26cf03(0x7f)]+a300_0x26cf03(0x7e),ORGANIZATION_NAME_FIELD=constants_2[a300_0x26cf03(0x7f)]+'OrganisationName__c',REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x26cf03(0x7f)]+a300_0x26cf03(0x8f),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a300_0x26cf03(0x7f)]+a300_0x26cf03(0x8f),constants_2[a300_0x26cf03(0x7f)]+a300_0x26cf03(0x66),constants_2['FLOSUM_NAMESPACE']+'API_Name__c',constants_2['FLOSUM_NAMESPACE']+a300_0x26cf03(0x92),constants_2[a300_0x26cf03(0x7f)]+a300_0x26cf03(0x7e),constants_2[a300_0x26cf03(0x7f)]+'OrganisationName__c',constants_2[a300_0x26cf03(0x7f)]+a300_0x26cf03(0x6c),constants_2[a300_0x26cf03(0x7f)]+a300_0x26cf03(0x8a)];class SourceMemberHandler extends stream_1[a300_0x26cf03(0x86)]{constructor({apiVersion:_0x574a69,instance:_0x26d6d2,targetOrgId:_0x6b8205,logger:_0x50aea5}){const _0x423c61=a300_0x26cf03;super({'objectMode':!![]}),this['sourceMemberRecords']=new Map(),this[_0x423c61(0x8c)]=0x0,this['api']=_0x574a69,this[_0x423c61(0x73)]=_0x26d6d2,this[_0x423c61(0x91)]=_0x6b8205,this[_0x423c61(0x7c)]=_0x50aea5;}[a300_0x26cf03(0x8d)](){const _0x3b0c89=a300_0x26cf03;return new salesforce_1[(_0x3b0c89(0x93))]()['select'](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0x3b0c89(0x75)])[_0x3b0c89(0x97)](SOURCE_MEMBER_ID_FIELD_NAME+_0x3b0c89(0x8e),{'sourceMemberIds':[...this[_0x3b0c89(0x88)][_0x3b0c89(0x68)]()]})['andWhere'](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this['targetOrgId']});}async['getComponentFromFlosum'](){const _0x566fa9=a300_0x26cf03,_0x149b3f=new salesforce_1[(_0x566fa9(0x89))]({'api':this['api'],'queryBuilder':this[_0x566fa9(0x8d)](),'instance':this[_0x566fa9(0x73)],'isTooling':![]}),_0x404741=new Map();do{const {records:_0x2cd85a}=await _0x149b3f[_0x566fa9(0x79)]();for(const _0x572353 of _0x2cd85a){_0x404741[_0x566fa9(0x67)](_0x572353[SOURCE_MEMBER_ID_FIELD_NAME],_0x572353);}}while(!_0x149b3f['getIsDone']());return _0x404741;}async[a300_0x26cf03(0x96)](_0x545208){const _0x292d39=a300_0x26cf03;this[_0x292d39(0x88)][_0x292d39(0x67)](_0x545208['Id'],_0x545208),this[_0x292d39(0x88)][_0x292d39(0x7d)]===MAX_CHUNK_SIZE&&await this[_0x292d39(0x85)]();}async[a300_0x26cf03(0x85)](){const _0x5515c5=a300_0x26cf03,_0x3a4352=await this[_0x5515c5(0x71)]();for(const [_0x58fbb3,_0x570dc9]of this['sourceMemberRecords']){const _0x10c678=_0x3a4352['get'](_0x58fbb3);if(_0x10c678&&_0x570dc9[REVISION_COUNTER_FIELD_NAME]===_0x10c678[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x3f559c={'sourceMemberId':_0x570dc9['Id'],'componentId':(_0x10c678===null||_0x10c678===void 0x0?void 0x0:_0x10c678['Id'])||null,'attachmentId':(_0x10c678===null||_0x10c678===void 0x0?void 0x0:_0x10c678[_0x5515c5(0x6c)])||null,'metadataId':_0x570dc9[MEMBER_ID_FIELD_NAME],'metadataType':_0x570dc9[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x570dc9[IS_NAME_OBSOLETE],'revisionCounter':_0x570dc9[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x570dc9[CHANGED_BY_FIELD_NAME]};this[_0x5515c5(0x8c)]++,this[_0x5515c5(0x98)](_0x3f559c);}this['sourceMemberRecords']=new Map();}async[a300_0x26cf03(0x82)](_0x417d09,_0x44fd3e,_0x34d37c){const _0x486ba7=a300_0x26cf03;try{await this[_0x486ba7(0x96)](_0x417d09),_0x34d37c();}catch(_0x5bb954){_0x34d37c(_0x5bb954);}}async[a300_0x26cf03(0x83)](_0x3da6b5){const _0x1e81b0=a300_0x26cf03;try{this[_0x1e81b0(0x88)][_0x1e81b0(0x7d)]&&await this[_0x1e81b0(0x85)](),this[_0x1e81b0(0x7c)]['log']('Changes\x20found\x20for\x20'+this[_0x1e81b0(0x8c)]+'\x20components'),await this[_0x1e81b0(0x7c)][_0x1e81b0(0x7a)](),_0x3da6b5();}catch(_0x5ec563){_0x3da6b5(_0x5ec563);}}}function a300_0x1b35(){const _0x3b1bb3=['3028080sNEdNk','__esModule','1219437NVKWcY','Attachment_ID__c','8VzwMiC','2113fFhXip','117490GxfnIZ','../../constants','getComponentFromFlosum','apply','instance','7016CRlxtM','ORG_COMPONENT_OBJECT_NAME','7574UpjGsB','RevisionCounter','ChangedBy','execute','update','728116TWJHRz','logger','size','Source_Member_Id__c','FLOSUM_NAMESPACE','25kpJKxV','@flosum/salesforce','_transform','_flush','constructor','handle','Transform','defineProperty','sourceMemberRecords','CompositeRetrieveData','Folder__c','MemberType','handledMembersCounter','buildOrgComponentQuery','\x20IN\x20(:sourceMemberIds)','Revision_Counter__c','1338246gvUDJC','targetOrgId','Name__c','QueryBuilder','SourceMemberHandler','toString','addToChunk','where','push','IsNameObsolete','search','Component_Type__c','set','keys'];a300_0x1b35=function(){return _0x3b1bb3;};return a300_0x1b35();}exports[a300_0x26cf03(0x94)]=SourceMemberHandler;