const a300_0x298082=a300_0x5565;(function(_0x382a15,_0x13d5fa){const _0x4089c9=a300_0x5565,_0x13af3e=_0x382a15();while(!![]){try{const _0x53ef89=parseInt(_0x4089c9(0x1f1))/0x1+parseInt(_0x4089c9(0x1ef))/0x2*(parseInt(_0x4089c9(0x1ee))/0x3)+parseInt(_0x4089c9(0x1fa))/0x4*(-parseInt(_0x4089c9(0x1f9))/0x5)+-parseInt(_0x4089c9(0x1f0))/0x6+parseInt(_0x4089c9(0x1ed))/0x7+-parseInt(_0x4089c9(0x1e8))/0x8+-parseInt(_0x4089c9(0x1f4))/0x9;if(_0x53ef89===_0x13d5fa)break;else _0x13af3e['push'](_0x13af3e['shift']());}catch(_0x1c02d8){_0x13af3e['push'](_0x13af3e['shift']());}}}(a300_0x5020,0xdac16));const a300_0x5b6f03=(function(){let _0x1570d9=!![];return function(_0x287b74,_0x393347){const _0x339ca6=_0x1570d9?function(){const _0x36fc7e=a300_0x5565;if(_0x393347){const _0x1d5049=_0x393347[_0x36fc7e(0x1d2)](_0x287b74,arguments);return _0x393347=null,_0x1d5049;}}:function(){};return _0x1570d9=![],_0x339ca6;};}()),a300_0x439bf6=a300_0x5b6f03(this,function(){const _0x39768a=a300_0x5565;return a300_0x439bf6['toString']()['search'](_0x39768a(0x1fc))[_0x39768a(0x1cb)]()[_0x39768a(0x1c3)](a300_0x439bf6)[_0x39768a(0x1ca)](_0x39768a(0x1fc));});a300_0x439bf6();'use strict';Object[a300_0x298082(0x1ec)](exports,a300_0x298082(0x1e2),{'value':!![]}),exports[a300_0x298082(0x1f6)]=void 0x0;const stream_1=require('stream'),salesforce_1=require(a300_0x298082(0x1e1)),constants_1=require(a300_0x298082(0x1d3)),constants_2=require(a300_0x298082(0x1df)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x298082(0x1e5),IS_NAME_OBSOLETE=a300_0x298082(0x1dd),MEMBER_ID_FIELD_NAME=a300_0x298082(0x1e0),MEMBER_TYPE_FIELD_NAME=a300_0x298082(0x1d5),CHANGED_BY_FIELD_NAME=a300_0x298082(0x1d6),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a300_0x298082(0x1e6)]+'Source_Member_Id__c',ORGANIZATION_NAME_FIELD=constants_2[a300_0x298082(0x1e6)]+a300_0x298082(0x1d1),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x298082(0x1e6)]+'Revision_Counter__c',ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a300_0x298082(0x1e6)]+'Revision_Counter__c',constants_2[a300_0x298082(0x1e6)]+a300_0x298082(0x1e7),constants_2['FLOSUM_NAMESPACE']+'API_Name__c',constants_2['FLOSUM_NAMESPACE']+a300_0x298082(0x1ea),constants_2[a300_0x298082(0x1e6)]+'Source_Member_Id__c',constants_2[a300_0x298082(0x1e6)]+a300_0x298082(0x1d1),constants_2[a300_0x298082(0x1e6)]+a300_0x298082(0x1f8),constants_2[a300_0x298082(0x1e6)]+a300_0x298082(0x1f7)];function a300_0x5020(){const _0x4d8cd2=['164wiQfiu','Transform','(((.+)+)+)+$','constructor','size','_transform','\x20IN\x20(:sourceMemberIds)','addToChunk','handledMembersCounter','getIsDone','search','toString','sourceMemberRecords','logger','CompositeRetrieveData','andWhere','instance','OrganisationName__c','apply','../../constants','Changes\x20found\x20for\x20','MemberType','ChangedBy','where','handle','\x20components','update','keys','_flush','IsNameObsolete','select','../../../../constants','MemberIdOrName','@flosum/salesforce','__esModule','get','api','RevisionCounter','FLOSUM_NAMESPACE','Component_Type__c','611960uGnQTD','ORG_COMPONENT_OBJECT_NAME','Name__c','targetOrgId','defineProperty','7779863BzYmWt','6BuWOgB','926150XVwppX','4838148kKuSsM','658277kqyBxC','push','buildOrgComponentQuery','1979280JTZyqX','log','SourceMemberHandler','Folder__c','Attachment_ID__c','85005ouRrpp'];a300_0x5020=function(){return _0x4d8cd2;};return a300_0x5020();}function a300_0x5565(_0x148c14,_0x18fbad){const _0x1fe918=a300_0x5020();return a300_0x5565=function(_0x439bf6,_0x5b6f03){_0x439bf6=_0x439bf6-0x1c3;let _0x50204b=_0x1fe918[_0x439bf6];return _0x50204b;},a300_0x5565(_0x148c14,_0x18fbad);}class SourceMemberHandler extends stream_1[a300_0x298082(0x1fb)]{constructor({apiVersion:_0x538417,instance:_0x40016b,targetOrgId:_0x22d1e4,logger:_0x3a4fdc}){const _0x5ad2ef=a300_0x298082;super({'objectMode':!![]}),this['sourceMemberRecords']=new Map(),this['handledMembersCounter']=0x0,this[_0x5ad2ef(0x1e4)]=_0x538417,this[_0x5ad2ef(0x1d0)]=_0x40016b,this[_0x5ad2ef(0x1eb)]=_0x22d1e4,this[_0x5ad2ef(0x1cd)]=_0x3a4fdc;}[a300_0x298082(0x1f3)](){const _0x330a69=a300_0x298082;return new salesforce_1['QueryBuilder']()[_0x330a69(0x1de)](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0x330a69(0x1e9)])[_0x330a69(0x1d7)](SOURCE_MEMBER_ID_FIELD_NAME+_0x330a69(0x1c6),{'sourceMemberIds':[...this['sourceMemberRecords'][_0x330a69(0x1db)]()]})[_0x330a69(0x1cf)](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this[_0x330a69(0x1eb)]});}async['getComponentFromFlosum'](){const _0x531b8c=a300_0x298082,_0x5364e3=new salesforce_1[(_0x531b8c(0x1ce))]({'api':this[_0x531b8c(0x1e4)],'queryBuilder':this[_0x531b8c(0x1f3)](),'instance':this[_0x531b8c(0x1d0)],'isTooling':![]}),_0x465249=new Map();do{const {records:_0x34e519}=await _0x5364e3['execute']();for(const _0x3902c2 of _0x34e519){_0x465249['set'](_0x3902c2[SOURCE_MEMBER_ID_FIELD_NAME],_0x3902c2);}}while(!_0x5364e3[_0x531b8c(0x1c9)]());return _0x465249;}async[a300_0x298082(0x1c7)](_0x17ff48){const _0x735b57=a300_0x298082;this[_0x735b57(0x1cc)]['set'](_0x17ff48['Id'],_0x17ff48),this[_0x735b57(0x1cc)][_0x735b57(0x1c4)]===MAX_CHUNK_SIZE&&await this[_0x735b57(0x1d8)]();}async[a300_0x298082(0x1d8)](){const _0x966eb9=a300_0x298082,_0x5e8a4f=await this['getComponentFromFlosum']();for(const [_0x4f450f,_0x18c49d]of this['sourceMemberRecords']){const _0x5856bf=_0x5e8a4f[_0x966eb9(0x1e3)](_0x4f450f);if(_0x5856bf&&_0x18c49d[REVISION_COUNTER_FIELD_NAME]===_0x5856bf[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x3f3973={'sourceMemberId':_0x18c49d['Id'],'componentId':(_0x5856bf===null||_0x5856bf===void 0x0?void 0x0:_0x5856bf['Id'])||null,'attachmentId':(_0x5856bf===null||_0x5856bf===void 0x0?void 0x0:_0x5856bf['Attachment_ID__c'])||null,'metadataId':_0x18c49d[MEMBER_ID_FIELD_NAME],'metadataType':_0x18c49d[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x18c49d[IS_NAME_OBSOLETE],'revisionCounter':_0x18c49d[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x18c49d[CHANGED_BY_FIELD_NAME]};this[_0x966eb9(0x1c8)]++,this[_0x966eb9(0x1f2)](_0x3f3973);}this['sourceMemberRecords']=new Map();}async[a300_0x298082(0x1c5)](_0x375ab2,_0x257039,_0xd03dad){const _0x3b9d69=a300_0x298082;try{await this[_0x3b9d69(0x1c7)](_0x375ab2),_0xd03dad();}catch(_0x2565c9){_0xd03dad(_0x2565c9);}}async[a300_0x298082(0x1dc)](_0x15a5eb){const _0x3b08dc=a300_0x298082;try{this[_0x3b08dc(0x1cc)][_0x3b08dc(0x1c4)]&&await this['handle'](),this['logger'][_0x3b08dc(0x1f5)](_0x3b08dc(0x1d4)+this[_0x3b08dc(0x1c8)]+_0x3b08dc(0x1d9)),await this[_0x3b08dc(0x1cd)][_0x3b08dc(0x1da)](),_0x15a5eb();}catch(_0x38df7f){_0x15a5eb(_0x38df7f);}}}exports[a300_0x298082(0x1f6)]=SourceMemberHandler;