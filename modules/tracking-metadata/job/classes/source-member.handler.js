const a332_0x5569a8=a332_0x4129;(function(_0x4efea0,_0x15229d){const _0x3d2479=a332_0x4129,_0x4bcf5f=_0x4efea0();while(!![]){try{const _0xa7de05=parseInt(_0x3d2479(0x1d6))/0x1+-parseInt(_0x3d2479(0x1ec))/0x2*(-parseInt(_0x3d2479(0x1eb))/0x3)+-parseInt(_0x3d2479(0x1e7))/0x4*(parseInt(_0x3d2479(0x1f4))/0x5)+-parseInt(_0x3d2479(0x1e5))/0x6*(parseInt(_0x3d2479(0x203))/0x7)+-parseInt(_0x3d2479(0x1e0))/0x8*(parseInt(_0x3d2479(0x204))/0x9)+-parseInt(_0x3d2479(0x1e2))/0xa*(parseInt(_0x3d2479(0x1d3))/0xb)+parseInt(_0x3d2479(0x1dd))/0xc;if(_0xa7de05===_0x15229d)break;else _0x4bcf5f['push'](_0x4bcf5f['shift']());}catch(_0x31925b){_0x4bcf5f['push'](_0x4bcf5f['shift']());}}}(a332_0x103d,0xd8a60));const a332_0x1d1d66=(function(){let _0x464185=!![];return function(_0x471766,_0x30f302){const _0x52b531=_0x464185?function(){const _0x467312=a332_0x4129;if(_0x30f302){const _0xcaf6ac=_0x30f302[_0x467312(0x1e9)](_0x471766,arguments);return _0x30f302=null,_0xcaf6ac;}}:function(){};return _0x464185=![],_0x52b531;};}()),a332_0xc0a91d=a332_0x1d1d66(this,function(){const _0x347f62=a332_0x4129;return a332_0xc0a91d[_0x347f62(0x1d0)]()['search'](_0x347f62(0x1d5))[_0x347f62(0x1d0)]()[_0x347f62(0x1f6)](a332_0xc0a91d)['search'](_0x347f62(0x1d5));});a332_0xc0a91d();'use strict';Object['defineProperty'](exports,a332_0x5569a8(0x1f0),{'value':!![]}),exports[a332_0x5569a8(0x1e4)]=void 0x0;const stream_1=require(a332_0x5569a8(0x1d2)),salesforce_1=require(a332_0x5569a8(0x1e1)),constants_1=require(a332_0x5569a8(0x1df)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a332_0x5569a8(0x1da),IS_NAME_OBSOLETE=a332_0x5569a8(0x1f1),MEMBER_ID_FIELD_NAME=a332_0x5569a8(0x1fb),MEMBER_TYPE_FIELD_NAME='MemberType',CHANGED_BY_FIELD_NAME='ChangedBy',SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a332_0x5569a8(0x1fa)]+a332_0x5569a8(0x1e6),ORGANIZATION_NAME_FIELD=constants_2['FLOSUM_NAMESPACE']+a332_0x5569a8(0x1e8),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a332_0x5569a8(0x1fa)]+'Revision_Counter__c',ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a332_0x5569a8(0x1fa)]+a332_0x5569a8(0x1fd),constants_2[a332_0x5569a8(0x1fa)]+a332_0x5569a8(0x1f2),constants_2[a332_0x5569a8(0x1fa)]+a332_0x5569a8(0x1d1),constants_2[a332_0x5569a8(0x1fa)]+a332_0x5569a8(0x1f9),constants_2[a332_0x5569a8(0x1fa)]+a332_0x5569a8(0x1e6),constants_2[a332_0x5569a8(0x1fa)]+'OrganisationName__c',constants_2[a332_0x5569a8(0x1fa)]+a332_0x5569a8(0x201),constants_2['FLOSUM_NAMESPACE']+a332_0x5569a8(0x1db)];function a332_0x103d(){const _0x11510f=['targetOrgId','Name__c','FLOSUM_NAMESPACE','MemberIdOrName','\x20IN\x20(:sourceMemberIds)','Revision_Counter__c','_flush','getComponentFromFlosum','select','Attachment_ID__c','_transform','1700258ypsHOl','1368xfBEXH','instance','size','from','set','toString','API_Name__c','stream','693gJxqDL','Changes\x20found\x20for\x20','(((.+)+)+)+$','226474OLrmow','sourceMemberRecords','\x20=\x20:targetOrgId','get','RevisionCounter','Folder__c','CompositeRetrieveData','4139748PHgOWL','logger','../../constants','11688bFBonk','@flosum/salesforce','60340WsYbWb','getIsDone','SourceMemberHandler','6MOzGjj','Source_Member_Id__c','172dfTMZj','OrganisationName__c','apply','\x20components','12vixBlV','629178qlSraW','handledMembersCounter','addToChunk','where','__esModule','IsNameObsolete','Component_Type__c','handle','11315oCxQgc','ORG_COMPONENT_OBJECT_NAME','constructor','buildOrgComponentQuery'];a332_0x103d=function(){return _0x11510f;};return a332_0x103d();}function a332_0x4129(_0x3fc9a2,_0x2187d2){const _0xb15a91=a332_0x103d();return a332_0x4129=function(_0xc0a91d,_0x1d1d66){_0xc0a91d=_0xc0a91d-0x1cd;let _0x103d91=_0xb15a91[_0xc0a91d];return _0x103d91;},a332_0x4129(_0x3fc9a2,_0x2187d2);}class SourceMemberHandler extends stream_1['Transform']{constructor({apiVersion:_0x4a5d9e,instance:_0x28dca6,targetOrgId:_0xade5f4,logger:_0x4c2e44}){const _0x48b31e=a332_0x5569a8;super({'objectMode':!![]}),this['sourceMemberRecords']=new Map(),this[_0x48b31e(0x1ed)]=0x0,this['api']=_0x4a5d9e,this[_0x48b31e(0x205)]=_0x28dca6,this[_0x48b31e(0x1f8)]=_0xade5f4,this[_0x48b31e(0x1de)]=_0x4c2e44;}[a332_0x5569a8(0x1f7)](){const _0x5fd86b=a332_0x5569a8;return new salesforce_1['QueryBuilder']()[_0x5fd86b(0x200)](...ORG_COMPONENT_SELECT_FIELDS)[_0x5fd86b(0x1ce)](constants_1[_0x5fd86b(0x1f5)])[_0x5fd86b(0x1ef)](SOURCE_MEMBER_ID_FIELD_NAME+_0x5fd86b(0x1fc),{'sourceMemberIds':[...this['sourceMemberRecords']['keys']()]})['andWhere'](ORGANIZATION_NAME_FIELD+_0x5fd86b(0x1d8),{'targetOrgId':this['targetOrgId']});}async[a332_0x5569a8(0x1ff)](){const _0xf1580e=a332_0x5569a8,_0x5694b6=new salesforce_1[(_0xf1580e(0x1dc))]({'api':this['api'],'queryBuilder':this[_0xf1580e(0x1f7)](),'instance':this[_0xf1580e(0x205)],'isTooling':![]}),_0x5cda08=new Map();do{const {records:_0x3672cd}=await _0x5694b6['execute']();for(const _0x13d45e of _0x3672cd){_0x5cda08[_0xf1580e(0x1cf)](_0x13d45e[SOURCE_MEMBER_ID_FIELD_NAME],_0x13d45e);}}while(!_0x5694b6[_0xf1580e(0x1e3)]());return _0x5cda08;}async[a332_0x5569a8(0x1ee)](_0x2234a1){const _0x2fa1c8=a332_0x5569a8;this[_0x2fa1c8(0x1d7)][_0x2fa1c8(0x1cf)](_0x2234a1['Id'],_0x2234a1),this[_0x2fa1c8(0x1d7)][_0x2fa1c8(0x1cd)]===MAX_CHUNK_SIZE&&await this[_0x2fa1c8(0x1f3)]();}async[a332_0x5569a8(0x1f3)](){const _0x4bd03c=a332_0x5569a8,_0x1b824a=await this[_0x4bd03c(0x1ff)]();for(const [_0x4cebad,_0x26a60e]of this[_0x4bd03c(0x1d7)]){const _0x35202c=_0x1b824a[_0x4bd03c(0x1d9)](_0x4cebad);if(_0x35202c&&_0x26a60e[REVISION_COUNTER_FIELD_NAME]===_0x35202c[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x2b036d={'sourceMemberId':_0x26a60e['Id'],'componentId':(_0x35202c===null||_0x35202c===void 0x0?void 0x0:_0x35202c['Id'])||null,'attachmentId':(_0x35202c===null||_0x35202c===void 0x0?void 0x0:_0x35202c[_0x4bd03c(0x201)])||null,'metadataId':_0x26a60e[MEMBER_ID_FIELD_NAME],'metadataType':_0x26a60e[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x26a60e[IS_NAME_OBSOLETE],'revisionCounter':_0x26a60e[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x26a60e[CHANGED_BY_FIELD_NAME]};this[_0x4bd03c(0x1ed)]++,this['push'](_0x2b036d);}this[_0x4bd03c(0x1d7)]=new Map();}async[a332_0x5569a8(0x202)](_0x253927,_0x2af84e,_0x485ba0){const _0x2361d1=a332_0x5569a8;try{await this[_0x2361d1(0x1ee)](_0x253927),_0x485ba0();}catch(_0x4152e9){_0x485ba0(_0x4152e9);}}async[a332_0x5569a8(0x1fe)](_0x44e164){const _0x5f08d8=a332_0x5569a8;try{this[_0x5f08d8(0x1d7)]['size']&&await this[_0x5f08d8(0x1f3)](),this['logger']['log'](_0x5f08d8(0x1d4)+this[_0x5f08d8(0x1ed)]+_0x5f08d8(0x1ea)),await this['logger']['update'](),_0x44e164();}catch(_0x3815bc){_0x44e164(_0x3815bc);}}}exports[a332_0x5569a8(0x1e4)]=SourceMemberHandler;