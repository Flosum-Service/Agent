const a345_0x5e1122=a345_0x5f1b;(function(_0x35f151,_0x49847e){const _0x2a9108=a345_0x5f1b,_0x4bbe61=_0x35f151();while(!![]){try{const _0x152591=-parseInt(_0x2a9108(0xfe))/0x1*(-parseInt(_0x2a9108(0x105))/0x2)+-parseInt(_0x2a9108(0xd6))/0x3*(parseInt(_0x2a9108(0xf0))/0x4)+parseInt(_0x2a9108(0xf2))/0x5+-parseInt(_0x2a9108(0x10d))/0x6+-parseInt(_0x2a9108(0xd4))/0x7+parseInt(_0x2a9108(0xdf))/0x8+parseInt(_0x2a9108(0xf9))/0x9*(parseInt(_0x2a9108(0xf5))/0xa);if(_0x152591===_0x49847e)break;else _0x4bbe61['push'](_0x4bbe61['shift']());}catch(_0x4917fb){_0x4bbe61['push'](_0x4bbe61['shift']());}}}(a345_0x12e3,0xc6b92));const a345_0x43c9ca=(function(){let _0x39b073=!![];return function(_0x74ba9,_0x2d7afc){const _0x5293a5=_0x39b073?function(){if(_0x2d7afc){const _0x5ba8eb=_0x2d7afc['apply'](_0x74ba9,arguments);return _0x2d7afc=null,_0x5ba8eb;}}:function(){};return _0x39b073=![],_0x5293a5;};}()),a345_0x42cb77=a345_0x43c9ca(this,function(){const _0xb1ddc2=a345_0x5f1b;return a345_0x42cb77['toString']()[_0xb1ddc2(0xfd)](_0xb1ddc2(0xd9))['toString']()['constructor'](a345_0x42cb77)[_0xb1ddc2(0xfd)](_0xb1ddc2(0xd9));});a345_0x42cb77();function a345_0x5f1b(_0x23b07b,_0x2d8567){const _0x38b036=a345_0x12e3();return a345_0x5f1b=function(_0x42cb77,_0x43c9ca){_0x42cb77=_0x42cb77-0xd4;let _0x12e3c4=_0x38b036[_0x42cb77];return _0x12e3c4;},a345_0x5f1b(_0x23b07b,_0x2d8567);}'use strict';function a345_0x12e3(){const _0x24eea9=['andWhere','(((.+)+)+)+$','from','logger','instance','sourceMemberRecords','MemberIdOrName','8163344ZVmYPh','QueryBuilder','../../../../constants','@flosum/salesforce','IsNameObsolete','../../constants','ORG_COMPONENT_OBJECT_NAME','api','OrganisationName__c','\x20=\x20:targetOrgId','API_Name__c','SourceMemberHandler','defineProperty','push','select','FLOSUM_NAMESPACE','update','1933648MdhtBl','size','3307320GbDgPG','Component_Type__c','MemberName','6910rVhUjy','log','handle','set','3096AMOcrF','MemberType','\x20IN\x20(:sourceMemberIds)','where','search','129RtRQHF','CompositeRetrieveData','Folder__c','buildOrgComponentQuery','get','handledMembersCounter','Source_Member_Id__c','570oIieVu','Transform','targetOrgId','Attachment_ID__c','RevisionCounter','addToChunk','getComponentFromFlosum','Changes\x20found\x20for\x20','1874142rBYUIv','2426284IyJOsl','execute','3xvnVWK','stream'];a345_0x12e3=function(){return _0x24eea9;};return a345_0x12e3();}Object[a345_0x5e1122(0xeb)](exports,'__esModule',{'value':!![]}),exports[a345_0x5e1122(0xea)]=void 0x0;const stream_1=require(a345_0x5e1122(0xd7)),salesforce_1=require(a345_0x5e1122(0xe2)),constants_1=require(a345_0x5e1122(0xe4)),constants_2=require(a345_0x5e1122(0xe1)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a345_0x5e1122(0x109),IS_NAME_OBSOLETE=a345_0x5e1122(0xe3),MEMBER_ID_FIELD_NAME=a345_0x5e1122(0xde),MEMBER_TYPE_FIELD_NAME=a345_0x5e1122(0xfa),MEMBER_NAME=a345_0x5e1122(0xf4),CHANGED_BY_FIELD_NAME='ChangedBy',SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a345_0x5e1122(0xee)]+a345_0x5e1122(0x104),ORGANIZATION_NAME_FIELD=constants_2[a345_0x5e1122(0xee)]+'OrganisationName__c',REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+'Revision_Counter__c',ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a345_0x5e1122(0xee)]+'Revision_Counter__c',constants_2[a345_0x5e1122(0xee)]+a345_0x5e1122(0xf3),constants_2[a345_0x5e1122(0xee)]+a345_0x5e1122(0xe9),constants_2['FLOSUM_NAMESPACE']+'Name__c',constants_2[a345_0x5e1122(0xee)]+a345_0x5e1122(0x104),constants_2['FLOSUM_NAMESPACE']+a345_0x5e1122(0xe7),constants_2[a345_0x5e1122(0xee)]+'Attachment_ID__c',constants_2[a345_0x5e1122(0xee)]+a345_0x5e1122(0x100)];class SourceMemberHandler extends stream_1[a345_0x5e1122(0x106)]{constructor({apiVersion:_0x10ee7d,instance:_0x46cdaa,targetOrgId:_0x4e6e34,logger:_0xcaa875}){const _0x204f9b=a345_0x5e1122;super({'objectMode':!![]}),this[_0x204f9b(0xdd)]=new Map(),this[_0x204f9b(0x103)]=0x0,this[_0x204f9b(0xe6)]=_0x10ee7d,this['instance']=_0x46cdaa,this[_0x204f9b(0x107)]=_0x4e6e34,this[_0x204f9b(0xdb)]=_0xcaa875;}['buildOrgComponentQuery'](){const _0x4037a2=a345_0x5e1122;return new salesforce_1[(_0x4037a2(0xe0))]()[_0x4037a2(0xed)](...ORG_COMPONENT_SELECT_FIELDS)[_0x4037a2(0xda)](constants_1[_0x4037a2(0xe5)])[_0x4037a2(0xfc)](SOURCE_MEMBER_ID_FIELD_NAME+_0x4037a2(0xfb),{'sourceMemberIds':[...this['sourceMemberRecords']['keys']()]})[_0x4037a2(0xd8)](ORGANIZATION_NAME_FIELD+_0x4037a2(0xe8),{'targetOrgId':this['targetOrgId']});}async[a345_0x5e1122(0x10b)](){const _0x1f809a=a345_0x5e1122,_0x4b73fb=new salesforce_1[(_0x1f809a(0xff))]({'api':this['api'],'queryBuilder':this[_0x1f809a(0x101)](),'instance':this[_0x1f809a(0xdc)],'isTooling':![]}),_0x1a70a6=new Map();do{const {records:_0x433514}=await _0x4b73fb[_0x1f809a(0xd5)]();for(const _0x66f7bf of _0x433514){_0x1a70a6[_0x1f809a(0xf8)](_0x66f7bf[SOURCE_MEMBER_ID_FIELD_NAME],_0x66f7bf);}}while(!_0x4b73fb['getIsDone']());return _0x1a70a6;}async['addToChunk'](_0x7b6fac){const _0x20d3a6=a345_0x5e1122;this[_0x20d3a6(0xdd)][_0x20d3a6(0xf8)](_0x7b6fac['Id'],_0x7b6fac),this[_0x20d3a6(0xdd)][_0x20d3a6(0xf1)]===MAX_CHUNK_SIZE&&await this[_0x20d3a6(0xf7)]();}async[a345_0x5e1122(0xf7)](){const _0x6bc0d5=a345_0x5e1122,_0x57bb1b=await this[_0x6bc0d5(0x10b)]();for(const [_0x5d0a87,_0x3158a3]of this[_0x6bc0d5(0xdd)]){const _0x3cadfb=_0x57bb1b[_0x6bc0d5(0x102)](_0x5d0a87);if(_0x3cadfb&&_0x3158a3[REVISION_COUNTER_FIELD_NAME]===_0x3cadfb[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x39a736={'sourceMemberId':_0x3158a3['Id'],'componentId':(_0x3cadfb===null||_0x3cadfb===void 0x0?void 0x0:_0x3cadfb['Id'])||null,'attachmentId':(_0x3cadfb===null||_0x3cadfb===void 0x0?void 0x0:_0x3cadfb[_0x6bc0d5(0x108)])||null,'metadataId':_0x3158a3[MEMBER_ID_FIELD_NAME],'metadataType':_0x3158a3[MEMBER_TYPE_FIELD_NAME],'metadataName':_0x3158a3[MEMBER_NAME],'isNameObsolete':_0x3158a3[IS_NAME_OBSOLETE],'revisionCounter':_0x3158a3[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x3158a3[CHANGED_BY_FIELD_NAME]};this[_0x6bc0d5(0x103)]++,this[_0x6bc0d5(0xec)](_0x39a736);}this[_0x6bc0d5(0xdd)]=new Map();}async['_transform'](_0x5d4468,_0xe8a903,_0x17fe28){const _0x326412=a345_0x5e1122;try{await this[_0x326412(0x10a)](_0x5d4468),_0x17fe28();}catch(_0x192bd6){_0x17fe28(_0x192bd6);}}async['_flush'](_0x39b606){const _0x2d032d=a345_0x5e1122;try{this['sourceMemberRecords'][_0x2d032d(0xf1)]&&await this[_0x2d032d(0xf7)](),this[_0x2d032d(0xdb)][_0x2d032d(0xf6)](_0x2d032d(0x10c)+this[_0x2d032d(0x103)]+'\x20components'),await this['logger'][_0x2d032d(0xef)](),_0x39b606();}catch(_0x2c1896){_0x39b606(_0x2c1896);}}}exports[a345_0x5e1122(0xea)]=SourceMemberHandler;