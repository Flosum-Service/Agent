const a343_0x227a5c=a343_0x1953;(function(_0x5c6f54,_0x1fc729){const _0x1492b6=a343_0x1953,_0x160947=_0x5c6f54();while(!![]){try{const _0x1f4c56=parseInt(_0x1492b6(0xa3))/0x1+-parseInt(_0x1492b6(0xba))/0x2+parseInt(_0x1492b6(0x9b))/0x3*(-parseInt(_0x1492b6(0xae))/0x4)+parseInt(_0x1492b6(0xb1))/0x5*(parseInt(_0x1492b6(0xb8))/0x6)+-parseInt(_0x1492b6(0xb4))/0x7*(parseInt(_0x1492b6(0xc7))/0x8)+-parseInt(_0x1492b6(0x94))/0x9*(parseInt(_0x1492b6(0x9d))/0xa)+parseInt(_0x1492b6(0x99))/0xb;if(_0x1f4c56===_0x1fc729)break;else _0x160947['push'](_0x160947['shift']());}catch(_0x2ab02a){_0x160947['push'](_0x160947['shift']());}}}(a343_0x5df9,0x57be1));const a343_0x5e7fc2=(function(){let _0x14974b=!![];return function(_0x156285,_0x51600b){const _0x498433=_0x14974b?function(){const _0x8457b6=a343_0x1953;if(_0x51600b){const _0x291718=_0x51600b[_0x8457b6(0x9c)](_0x156285,arguments);return _0x51600b=null,_0x291718;}}:function(){};return _0x14974b=![],_0x498433;};}()),a343_0x4eb69b=a343_0x5e7fc2(this,function(){const _0x185fd2=a343_0x1953;return a343_0x4eb69b['toString']()[_0x185fd2(0xa6)]('(((.+)+)+)+$')[_0x185fd2(0xaf)]()[_0x185fd2(0x9a)](a343_0x4eb69b)[_0x185fd2(0xa6)](_0x185fd2(0xb3));});a343_0x4eb69b();'use strict';function a343_0x5df9(){const _0x30c998=['select','Component_Type__c','23391Bcbkjl','logger','Attachment_ID__c','Name__c','getIsDone','1839156TfbnFT','constructor','82671XFWmuU','apply','290WoXcaT','MemberName','andWhere','api','getComponentFromFlosum','_transform','411070adExlJ','\x20IN\x20(:sourceMemberIds)','execute','search','__esModule','where','handledMembersCounter','\x20components','sourceMemberRecords','buildOrgComponentQuery','OrganisationName__c','4wGAMKq','toString','instance','598090AGGAXX','ChangedBy','(((.+)+)+)+$','2135zForBS','handle','addToChunk','set','18vXjyKs','SourceMemberHandler','880668LXHFYD','push','QueryBuilder','update','MemberType','IsNameObsolete','Transform','stream','Folder__c','FLOSUM_NAMESPACE','ORG_COMPONENT_OBJECT_NAME','CompositeRetrieveData','targetOrgId','904GRBPdU','size','keys','from','Revision_Counter__c','Changes\x20found\x20for\x20'];a343_0x5df9=function(){return _0x30c998;};return a343_0x5df9();}function a343_0x1953(_0x58c351,_0x4efc39){const _0x3403c7=a343_0x5df9();return a343_0x1953=function(_0x4eb69b,_0x5e7fc2){_0x4eb69b=_0x4eb69b-0x92;let _0x5df9db=_0x3403c7[_0x4eb69b];return _0x5df9db;},a343_0x1953(_0x58c351,_0x4efc39);}Object['defineProperty'](exports,a343_0x227a5c(0xa7),{'value':!![]}),exports['SourceMemberHandler']=void 0x0;const stream_1=require(a343_0x227a5c(0xc1)),salesforce_1=require('@flosum/salesforce'),constants_1=require('../../constants'),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME='RevisionCounter',IS_NAME_OBSOLETE=a343_0x227a5c(0xbf),MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME=a343_0x227a5c(0xbe),MEMBER_NAME=a343_0x227a5c(0x9e),CHANGED_BY_FIELD_NAME=a343_0x227a5c(0xb2),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x227a5c(0xc3)]+'Source_Member_Id__c',ORGANIZATION_NAME_FIELD=constants_2['FLOSUM_NAMESPACE']+a343_0x227a5c(0xad),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a343_0x227a5c(0xc3)]+a343_0x227a5c(0xcb),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a343_0x227a5c(0xc3)]+a343_0x227a5c(0xcb),constants_2[a343_0x227a5c(0xc3)]+a343_0x227a5c(0x93),constants_2[a343_0x227a5c(0xc3)]+'API_Name__c',constants_2[a343_0x227a5c(0xc3)]+a343_0x227a5c(0x97),constants_2[a343_0x227a5c(0xc3)]+'Source_Member_Id__c',constants_2['FLOSUM_NAMESPACE']+a343_0x227a5c(0xad),constants_2[a343_0x227a5c(0xc3)]+a343_0x227a5c(0x96),constants_2[a343_0x227a5c(0xc3)]+a343_0x227a5c(0xc2)];class SourceMemberHandler extends stream_1[a343_0x227a5c(0xc0)]{constructor({apiVersion:_0x5a24d8,instance:_0x780bb5,targetOrgId:_0x4ad07d,logger:_0x3cc0c3}){const _0xeecb77=a343_0x227a5c;super({'objectMode':!![]}),this[_0xeecb77(0xab)]=new Map(),this[_0xeecb77(0xa9)]=0x0,this[_0xeecb77(0xa0)]=_0x5a24d8,this[_0xeecb77(0xb0)]=_0x780bb5,this[_0xeecb77(0xc6)]=_0x4ad07d,this['logger']=_0x3cc0c3;}[a343_0x227a5c(0xac)](){const _0x2fffda=a343_0x227a5c;return new salesforce_1[(_0x2fffda(0xbc))]()[_0x2fffda(0x92)](...ORG_COMPONENT_SELECT_FIELDS)[_0x2fffda(0xca)](constants_1[_0x2fffda(0xc4)])[_0x2fffda(0xa8)](SOURCE_MEMBER_ID_FIELD_NAME+_0x2fffda(0xa4),{'sourceMemberIds':[...this[_0x2fffda(0xab)][_0x2fffda(0xc9)]()]})[_0x2fffda(0x9f)](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this[_0x2fffda(0xc6)]});}async['getComponentFromFlosum'](){const _0x50925e=a343_0x227a5c,_0x5b0aeb=new salesforce_1[(_0x50925e(0xc5))]({'api':this[_0x50925e(0xa0)],'queryBuilder':this[_0x50925e(0xac)](),'instance':this[_0x50925e(0xb0)],'isTooling':![]}),_0xe1587c=new Map();do{const {records:_0x4179dc}=await _0x5b0aeb[_0x50925e(0xa5)]();for(const _0xb41ede of _0x4179dc){_0xe1587c['set'](_0xb41ede[SOURCE_MEMBER_ID_FIELD_NAME],_0xb41ede);}}while(!_0x5b0aeb[_0x50925e(0x98)]());return _0xe1587c;}async['addToChunk'](_0x2a26e5){const _0x1a840c=a343_0x227a5c;this[_0x1a840c(0xab)][_0x1a840c(0xb7)](_0x2a26e5['Id'],_0x2a26e5),this[_0x1a840c(0xab)][_0x1a840c(0xc8)]===MAX_CHUNK_SIZE&&await this[_0x1a840c(0xb5)]();}async['handle'](){const _0x2ce94c=a343_0x227a5c,_0x24355e=await this[_0x2ce94c(0xa1)]();for(const [_0x10924e,_0x2ea794]of this[_0x2ce94c(0xab)]){const _0xf11baa=_0x24355e['get'](_0x10924e);if(_0xf11baa&&_0x2ea794[REVISION_COUNTER_FIELD_NAME]===_0xf11baa[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x361930={'sourceMemberId':_0x2ea794['Id'],'componentId':(_0xf11baa===null||_0xf11baa===void 0x0?void 0x0:_0xf11baa['Id'])||null,'attachmentId':(_0xf11baa===null||_0xf11baa===void 0x0?void 0x0:_0xf11baa[_0x2ce94c(0x96)])||null,'metadataId':_0x2ea794[MEMBER_ID_FIELD_NAME],'metadataType':_0x2ea794[MEMBER_TYPE_FIELD_NAME],'metadataName':_0x2ea794[MEMBER_NAME],'isNameObsolete':_0x2ea794[IS_NAME_OBSOLETE],'revisionCounter':_0x2ea794[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x2ea794[CHANGED_BY_FIELD_NAME]};this[_0x2ce94c(0xa9)]++,this[_0x2ce94c(0xbb)](_0x361930);}this[_0x2ce94c(0xab)]=new Map();}async[a343_0x227a5c(0xa2)](_0x450604,_0x558e0f,_0x282029){const _0x2ef152=a343_0x227a5c;try{await this[_0x2ef152(0xb6)](_0x450604),_0x282029();}catch(_0x2f9f5e){_0x282029(_0x2f9f5e);}}async['_flush'](_0x18cd10){const _0x3baecb=a343_0x227a5c;try{this[_0x3baecb(0xab)]['size']&&await this[_0x3baecb(0xb5)](),this[_0x3baecb(0x95)]['log'](_0x3baecb(0xcc)+this[_0x3baecb(0xa9)]+_0x3baecb(0xaa)),await this[_0x3baecb(0x95)][_0x3baecb(0xbd)](),_0x18cd10();}catch(_0x4d4c94){_0x18cd10(_0x4d4c94);}}}exports[a343_0x227a5c(0xb9)]=SourceMemberHandler;