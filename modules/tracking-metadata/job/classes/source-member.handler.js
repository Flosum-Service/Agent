function a343_0x3b08(_0x396334,_0x291cad){const _0x3a8540=a343_0x47d5();return a343_0x3b08=function(_0x4cbff3,_0x25ec5d){_0x4cbff3=_0x4cbff3-0x1e5;let _0x47d591=_0x3a8540[_0x4cbff3];return _0x47d591;},a343_0x3b08(_0x396334,_0x291cad);}const a343_0x5ac698=a343_0x3b08;(function(_0x39b90e,_0x3a28cd){const _0x3b1fe9=a343_0x3b08,_0x2677a3=_0x39b90e();while(!![]){try{const _0x3cec50=-parseInt(_0x3b1fe9(0x215))/0x1*(parseInt(_0x3b1fe9(0x1ee))/0x2)+parseInt(_0x3b1fe9(0x207))/0x3*(-parseInt(_0x3b1fe9(0x1f6))/0x4)+parseInt(_0x3b1fe9(0x20b))/0x5*(parseInt(_0x3b1fe9(0x201))/0x6)+parseInt(_0x3b1fe9(0x1fa))/0x7+-parseInt(_0x3b1fe9(0x1f5))/0x8+-parseInt(_0x3b1fe9(0x1eb))/0x9+parseInt(_0x3b1fe9(0x219))/0xa*(parseInt(_0x3b1fe9(0x218))/0xb);if(_0x3cec50===_0x3a28cd)break;else _0x2677a3['push'](_0x2677a3['shift']());}catch(_0x3e9024){_0x2677a3['push'](_0x2677a3['shift']());}}}(a343_0x47d5,0xd87b9));const a343_0x25ec5d=(function(){let _0x508b94=!![];return function(_0x322bd8,_0x3d0538){const _0x4810e8=_0x508b94?function(){if(_0x3d0538){const _0x228fdf=_0x3d0538['apply'](_0x322bd8,arguments);return _0x3d0538=null,_0x228fdf;}}:function(){};return _0x508b94=![],_0x4810e8;};}()),a343_0x4cbff3=a343_0x25ec5d(this,function(){const _0x221899=a343_0x3b08;return a343_0x4cbff3[_0x221899(0x1e9)]()[_0x221899(0x209)](_0x221899(0x204))[_0x221899(0x1e9)]()[_0x221899(0x21b)](a343_0x4cbff3)[_0x221899(0x209)](_0x221899(0x204));});function a343_0x47d5(){const _0x401843=['942OTHUWg','RevisionCounter','buildOrgComponentQuery','QueryBuilder','Changes\x20found\x20for\x20','push','size','13402928PrphOy','24VeYDdI','execute','set','Attachment_ID__c','6412588CrTfRs','FLOSUM_NAMESPACE','get','Transform','handledMembersCounter','\x20=\x20:targetOrgId','addToChunk','137766VrulYY','Name__c','SourceMemberHandler','(((.+)+)+)+$','log','__esModule','278631CZyJVS','getComponentFromFlosum','search','targetOrgId','5diePyn','Revision_Counter__c','sourceMemberRecords','CompositeRetrieveData','Source_Member_Id__c','update','api','keys','logger','OrganisationName__c','501FLHtNS','defineProperty','stream','319bwfbsF','1286810aEySJI','Component_Type__c','constructor','../../constants','handle','ORG_COMPONENT_OBJECT_NAME','MemberName','getIsDone','toString','_transform','11839338syLsKO','MemberType','instance'];a343_0x47d5=function(){return _0x401843;};return a343_0x47d5();}a343_0x4cbff3();'use strict';Object[a343_0x5ac698(0x216)](exports,a343_0x5ac698(0x206),{'value':!![]}),exports['SourceMemberHandler']=void 0x0;const stream_1=require(a343_0x5ac698(0x217)),salesforce_1=require('@flosum/salesforce'),constants_1=require(a343_0x5ac698(0x21c)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a343_0x5ac698(0x1ef),IS_NAME_OBSOLETE='IsNameObsolete',MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME=a343_0x5ac698(0x1ec),MEMBER_NAME=a343_0x5ac698(0x1e7),CHANGED_BY_FIELD_NAME='ChangedBy',SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x5ac698(0x1fb)]+a343_0x5ac698(0x20f),ORGANIZATION_NAME_FIELD=constants_2['FLOSUM_NAMESPACE']+a343_0x5ac698(0x214),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a343_0x5ac698(0x1fb)]+a343_0x5ac698(0x20c),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2['FLOSUM_NAMESPACE']+a343_0x5ac698(0x20c),constants_2[a343_0x5ac698(0x1fb)]+a343_0x5ac698(0x21a),constants_2[a343_0x5ac698(0x1fb)]+'API_Name__c',constants_2['FLOSUM_NAMESPACE']+a343_0x5ac698(0x202),constants_2[a343_0x5ac698(0x1fb)]+a343_0x5ac698(0x20f),constants_2[a343_0x5ac698(0x1fb)]+a343_0x5ac698(0x214),constants_2[a343_0x5ac698(0x1fb)]+'Attachment_ID__c',constants_2[a343_0x5ac698(0x1fb)]+'Folder__c'];class SourceMemberHandler extends stream_1[a343_0x5ac698(0x1fd)]{constructor({apiVersion:_0x274121,instance:_0x34bb0e,targetOrgId:_0xe07210,logger:_0x429a9e}){const _0x47d433=a343_0x5ac698;super({'objectMode':!![]}),this[_0x47d433(0x20d)]=new Map(),this[_0x47d433(0x1fe)]=0x0,this[_0x47d433(0x211)]=_0x274121,this[_0x47d433(0x1ed)]=_0x34bb0e,this['targetOrgId']=_0xe07210,this[_0x47d433(0x213)]=_0x429a9e;}['buildOrgComponentQuery'](){const _0x4103ab=a343_0x5ac698;return new salesforce_1[(_0x4103ab(0x1f1))]()['select'](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0x4103ab(0x1e6)])['where'](SOURCE_MEMBER_ID_FIELD_NAME+'\x20IN\x20(:sourceMemberIds)',{'sourceMemberIds':[...this[_0x4103ab(0x20d)][_0x4103ab(0x212)]()]})['andWhere'](ORGANIZATION_NAME_FIELD+_0x4103ab(0x1ff),{'targetOrgId':this[_0x4103ab(0x20a)]});}async[a343_0x5ac698(0x208)](){const _0x2406fd=a343_0x5ac698,_0x419bc7=new salesforce_1[(_0x2406fd(0x20e))]({'api':this[_0x2406fd(0x211)],'queryBuilder':this[_0x2406fd(0x1f0)](),'instance':this[_0x2406fd(0x1ed)],'isTooling':![]}),_0x4ca493=new Map();do{const {records:_0x7b4121}=await _0x419bc7[_0x2406fd(0x1f7)]();for(const _0x5a9e47 of _0x7b4121){_0x4ca493['set'](_0x5a9e47[SOURCE_MEMBER_ID_FIELD_NAME],_0x5a9e47);}}while(!_0x419bc7[_0x2406fd(0x1e8)]());return _0x4ca493;}async['addToChunk'](_0x5619ec){const _0x43d0aa=a343_0x5ac698;this[_0x43d0aa(0x20d)][_0x43d0aa(0x1f8)](_0x5619ec['Id'],_0x5619ec),this[_0x43d0aa(0x20d)][_0x43d0aa(0x1f4)]===MAX_CHUNK_SIZE&&await this[_0x43d0aa(0x1e5)]();}async[a343_0x5ac698(0x1e5)](){const _0x26fb1a=a343_0x5ac698,_0x3a24bf=await this[_0x26fb1a(0x208)]();for(const [_0x4f7717,_0x5e2bd6]of this[_0x26fb1a(0x20d)]){const _0x3dd2a1=_0x3a24bf[_0x26fb1a(0x1fc)](_0x4f7717);if(_0x3dd2a1&&_0x5e2bd6[REVISION_COUNTER_FIELD_NAME]===_0x3dd2a1[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x236e42={'sourceMemberId':_0x5e2bd6['Id'],'componentId':(_0x3dd2a1===null||_0x3dd2a1===void 0x0?void 0x0:_0x3dd2a1['Id'])||null,'attachmentId':(_0x3dd2a1===null||_0x3dd2a1===void 0x0?void 0x0:_0x3dd2a1[_0x26fb1a(0x1f9)])||null,'metadataId':_0x5e2bd6[MEMBER_ID_FIELD_NAME],'metadataType':_0x5e2bd6[MEMBER_TYPE_FIELD_NAME],'metadataName':_0x5e2bd6[MEMBER_NAME],'isNameObsolete':_0x5e2bd6[IS_NAME_OBSOLETE],'revisionCounter':_0x5e2bd6[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x5e2bd6[CHANGED_BY_FIELD_NAME]};this[_0x26fb1a(0x1fe)]++,this[_0x26fb1a(0x1f3)](_0x236e42);}this[_0x26fb1a(0x20d)]=new Map();}async[a343_0x5ac698(0x1ea)](_0x143abb,_0x32beec,_0x346369){const _0x30d408=a343_0x5ac698;try{await this[_0x30d408(0x200)](_0x143abb),_0x346369();}catch(_0x22b749){_0x346369(_0x22b749);}}async['_flush'](_0x29250a){const _0x26d2a3=a343_0x5ac698;try{this[_0x26d2a3(0x20d)][_0x26d2a3(0x1f4)]&&await this[_0x26d2a3(0x1e5)](),this['logger'][_0x26d2a3(0x205)](_0x26d2a3(0x1f2)+this[_0x26d2a3(0x1fe)]+'\x20components'),await this[_0x26d2a3(0x213)][_0x26d2a3(0x210)](),_0x29250a();}catch(_0x1f3bbb){_0x29250a(_0x1f3bbb);}}}exports[a343_0x5ac698(0x203)]=SourceMemberHandler;