const a300_0x759999=a300_0x231e;(function(_0x477dbf,_0x4eb56e){const _0x5644f6=a300_0x231e,_0x38b1d4=_0x477dbf();while(!![]){try{const _0x5ea26d=-parseInt(_0x5644f6(0x192))/0x1*(-parseInt(_0x5644f6(0x19f))/0x2)+-parseInt(_0x5644f6(0x1c8))/0x3+-parseInt(_0x5644f6(0x1ab))/0x4*(-parseInt(_0x5644f6(0x1c5))/0x5)+parseInt(_0x5644f6(0x1be))/0x6+-parseInt(_0x5644f6(0x1a8))/0x7+parseInt(_0x5644f6(0x1c1))/0x8*(-parseInt(_0x5644f6(0x1a6))/0x9)+-parseInt(_0x5644f6(0x1bf))/0xa*(-parseInt(_0x5644f6(0x1c7))/0xb);if(_0x5ea26d===_0x4eb56e)break;else _0x38b1d4['push'](_0x38b1d4['shift']());}catch(_0xd8ba){_0x38b1d4['push'](_0x38b1d4['shift']());}}}(a300_0x2960,0x342c6));const a300_0x26f29f=(function(){let _0x210495=!![];return function(_0x39caf8,_0x59d544){const _0x5a8498=_0x210495?function(){if(_0x59d544){const _0x22668c=_0x59d544['apply'](_0x39caf8,arguments);return _0x59d544=null,_0x22668c;}}:function(){};return _0x210495=![],_0x5a8498;};}()),a300_0x3c3742=a300_0x26f29f(this,function(){const _0x29da69=a300_0x231e;return a300_0x3c3742[_0x29da69(0x1bc)]()['search']('(((.+)+)+)+$')[_0x29da69(0x1bc)]()['constructor'](a300_0x3c3742)[_0x29da69(0x1a5)](_0x29da69(0x1bb));});a300_0x3c3742();'use strict';function a300_0x231e(_0x3cd108,_0x5f01c9){const _0x5cfa16=a300_0x2960();return a300_0x231e=function(_0x3c3742,_0x26f29f){_0x3c3742=_0x3c3742-0x191;let _0x29607e=_0x5cfa16[_0x3c3742];return _0x29607e;},a300_0x231e(_0x3cd108,_0x5f01c9);}Object['defineProperty'](exports,a300_0x759999(0x1aa),{'value':!![]}),exports[a300_0x759999(0x1bd)]=void 0x0;const stream_1=require(a300_0x759999(0x1c6)),salesforce_1=require(a300_0x759999(0x197)),constants_1=require(a300_0x759999(0x194)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x759999(0x1ad),IS_NAME_OBSOLETE='IsNameObsolete',MEMBER_ID_FIELD_NAME=a300_0x759999(0x1a2),MEMBER_TYPE_FIELD_NAME=a300_0x759999(0x1b0),CHANGED_BY_FIELD_NAME='ChangedBy',SOURCE_MEMBER_ID_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a300_0x759999(0x1c3),ORGANIZATION_NAME_FIELD=constants_2[a300_0x759999(0x198)]+a300_0x759999(0x1c9),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x759999(0x198)]+a300_0x759999(0x1b4),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2['FLOSUM_NAMESPACE']+a300_0x759999(0x1b4),constants_2[a300_0x759999(0x198)]+a300_0x759999(0x19e),constants_2[a300_0x759999(0x198)]+a300_0x759999(0x1b3),constants_2['FLOSUM_NAMESPACE']+'Name__c',constants_2[a300_0x759999(0x198)]+a300_0x759999(0x1c3),constants_2[a300_0x759999(0x198)]+'OrganisationName__c',constants_2['FLOSUM_NAMESPACE']+a300_0x759999(0x1b5),constants_2[a300_0x759999(0x198)]+'Folder__c'];function a300_0x2960(){const _0x5e6eaf=['\x20components','__esModule','484aKNbaw','_transform','RevisionCounter','api','from','MemberType','getIsDone','size','API_Name__c','Revision_Counter__c','Attachment_ID__c','getComponentFromFlosum','addToChunk','QueryBuilder','_flush','targetOrgId','(((.+)+)+)+$','toString','SourceMemberHandler','37056XrrfLI','55480uyNfxF','handledMembersCounter','2280KxpMEr','select','Source_Member_Id__c','execute','7770KjwfgM','stream','1529UqCxsO','783990IizcdG','OrganisationName__c','log','1GLXexb','get','../../constants','handle','CompositeRetrieveData','@flosum/salesforce','FLOSUM_NAMESPACE','logger','sourceMemberRecords','\x20=\x20:targetOrgId','where','instance','Component_Type__c','120640VqPxHS','Transform','buildOrgComponentQuery','MemberIdOrName','ORG_COMPONENT_OBJECT_NAME','set','search','8100mlamIT','\x20IN\x20(:sourceMemberIds)','2059190GfIPxz'];a300_0x2960=function(){return _0x5e6eaf;};return a300_0x2960();}class SourceMemberHandler extends stream_1[a300_0x759999(0x1a0)]{constructor({apiVersion:_0x45bd1f,instance:_0x4b91de,targetOrgId:_0x35848b,logger:_0x4d4256}){const _0x4589c4=a300_0x759999;super({'objectMode':!![]}),this[_0x4589c4(0x19a)]=new Map(),this[_0x4589c4(0x1c0)]=0x0,this[_0x4589c4(0x1ae)]=_0x45bd1f,this[_0x4589c4(0x19d)]=_0x4b91de,this[_0x4589c4(0x1ba)]=_0x35848b,this[_0x4589c4(0x199)]=_0x4d4256;}[a300_0x759999(0x1a1)](){const _0x2ee926=a300_0x759999;return new salesforce_1[(_0x2ee926(0x1b8))]()[_0x2ee926(0x1c2)](...ORG_COMPONENT_SELECT_FIELDS)[_0x2ee926(0x1af)](constants_1[_0x2ee926(0x1a3)])[_0x2ee926(0x19c)](SOURCE_MEMBER_ID_FIELD_NAME+_0x2ee926(0x1a7),{'sourceMemberIds':[...this[_0x2ee926(0x19a)]['keys']()]})['andWhere'](ORGANIZATION_NAME_FIELD+_0x2ee926(0x19b),{'targetOrgId':this[_0x2ee926(0x1ba)]});}async[a300_0x759999(0x1b6)](){const _0x5f1dea=a300_0x759999,_0x3ece34=new salesforce_1[(_0x5f1dea(0x196))]({'api':this[_0x5f1dea(0x1ae)],'queryBuilder':this[_0x5f1dea(0x1a1)](),'instance':this[_0x5f1dea(0x19d)],'isTooling':![]}),_0x502c12=new Map();do{const {records:_0x312e68}=await _0x3ece34[_0x5f1dea(0x1c4)]();for(const _0x3a94d9 of _0x312e68){_0x502c12[_0x5f1dea(0x1a4)](_0x3a94d9[SOURCE_MEMBER_ID_FIELD_NAME],_0x3a94d9);}}while(!_0x3ece34[_0x5f1dea(0x1b1)]());return _0x502c12;}async[a300_0x759999(0x1b7)](_0x21e234){const _0x5e34eb=a300_0x759999;this['sourceMemberRecords']['set'](_0x21e234['Id'],_0x21e234),this[_0x5e34eb(0x19a)]['size']===MAX_CHUNK_SIZE&&await this[_0x5e34eb(0x195)]();}async[a300_0x759999(0x195)](){const _0x5c6bf2=a300_0x759999,_0x4333d7=await this[_0x5c6bf2(0x1b6)]();for(const [_0x268410,_0x4aa144]of this['sourceMemberRecords']){const _0x32f666=_0x4333d7[_0x5c6bf2(0x193)](_0x268410);if(_0x32f666&&_0x4aa144[REVISION_COUNTER_FIELD_NAME]===_0x32f666[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x5a4642={'sourceMemberId':_0x4aa144['Id'],'componentId':(_0x32f666===null||_0x32f666===void 0x0?void 0x0:_0x32f666['Id'])||null,'attachmentId':(_0x32f666===null||_0x32f666===void 0x0?void 0x0:_0x32f666['Attachment_ID__c'])||null,'metadataId':_0x4aa144[MEMBER_ID_FIELD_NAME],'metadataType':_0x4aa144[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x4aa144[IS_NAME_OBSOLETE],'revisionCounter':_0x4aa144[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x4aa144[CHANGED_BY_FIELD_NAME]};this['handledMembersCounter']++,this['push'](_0x5a4642);}this['sourceMemberRecords']=new Map();}async[a300_0x759999(0x1ac)](_0x30adf9,_0x27c7ee,_0x445b1c){const _0x100f59=a300_0x759999;try{await this[_0x100f59(0x1b7)](_0x30adf9),_0x445b1c();}catch(_0x3c621d){_0x445b1c(_0x3c621d);}}async[a300_0x759999(0x1b9)](_0x377d68){const _0x3ad9aa=a300_0x759999;try{this['sourceMemberRecords'][_0x3ad9aa(0x1b2)]&&await this[_0x3ad9aa(0x195)](),this[_0x3ad9aa(0x199)][_0x3ad9aa(0x191)]('Changes\x20found\x20for\x20'+this['handledMembersCounter']+_0x3ad9aa(0x1a9)),await this[_0x3ad9aa(0x199)]['update'](),_0x377d68();}catch(_0x1f8e29){_0x377d68(_0x1f8e29);}}}exports[a300_0x759999(0x1bd)]=SourceMemberHandler;