const a343_0x1eafdc=a343_0x32a9;(function(_0x36f11d,_0x36278c){const _0x5418c5=a343_0x32a9,_0x3de629=_0x36f11d();while(!![]){try{const _0x333543=-parseInt(_0x5418c5(0xd7))/0x1+parseInt(_0x5418c5(0xd4))/0x2+-parseInt(_0x5418c5(0xf3))/0x3+parseInt(_0x5418c5(0xfa))/0x4*(parseInt(_0x5418c5(0x10c))/0x5)+-parseInt(_0x5418c5(0xe6))/0x6+-parseInt(_0x5418c5(0xee))/0x7*(parseInt(_0x5418c5(0xf7))/0x8)+parseInt(_0x5418c5(0xf5))/0x9;if(_0x333543===_0x36278c)break;else _0x3de629['push'](_0x3de629['shift']());}catch(_0x4eb9e8){_0x3de629['push'](_0x3de629['shift']());}}}(a343_0x5ec2,0x860aa));const a343_0x46a0ea=(function(){let _0x158b1d=!![];return function(_0x67bcd6,_0x1fbcbf){const _0x2733f5=_0x158b1d?function(){const _0x301b71=a343_0x32a9;if(_0x1fbcbf){const _0x373a60=_0x1fbcbf[_0x301b71(0xea)](_0x67bcd6,arguments);return _0x1fbcbf=null,_0x373a60;}}:function(){};return _0x158b1d=![],_0x2733f5;};}()),a343_0x31d0f5=a343_0x46a0ea(this,function(){const _0x533be3=a343_0x32a9;return a343_0x31d0f5[_0x533be3(0x101)]()[_0x533be3(0xf2)](_0x533be3(0xfb))[_0x533be3(0x101)]()[_0x533be3(0xe9)](a343_0x31d0f5)[_0x533be3(0xf2)](_0x533be3(0xfb));});a343_0x31d0f5();'use strict';Object[a343_0x1eafdc(0x10b)](exports,'__esModule',{'value':!![]}),exports[a343_0x1eafdc(0xf4)]=void 0x0;function a343_0x32a9(_0x53f541,_0x327d43){const _0x2465ed=a343_0x5ec2();return a343_0x32a9=function(_0x31d0f5,_0x46a0ea){_0x31d0f5=_0x31d0f5-0xd4;let _0x5ec243=_0x2465ed[_0x31d0f5];return _0x5ec243;},a343_0x32a9(_0x53f541,_0x327d43);}function a343_0x5ec2(){const _0xe2c29b=['\x20components','@flosum/salesforce','QueryBuilder','get','size','CompositeRetrieveData','_transform','handle','\x20=\x20:targetOrgId','RevisionCounter','keys','Changes\x20found\x20for\x20','Source_Member_Id__c','Transform','3149190YYEXzl','\x20IN\x20(:sourceMemberIds)','addToChunk','constructor','apply','getComponentFromFlosum','ORG_COMPONENT_OBJECT_NAME','update','1869ryjaes','execute','../../../../constants','sourceMemberRecords','search','2027301YEDknh','SourceMemberHandler','13680396ALlitH','ChangedBy','4600ESagov','andWhere','Attachment_ID__c','5084Krbzxr','(((.+)+)+)+$','Component_Type__c','set','getIsDone','instance','log','toString','api','logger','stream','Name__c','../../constants','IsNameObsolete','buildOrgComponentQuery','OrganisationName__c','targetOrgId','defineProperty','865vavGVv','FLOSUM_NAMESPACE','select','1485718wraFRj','handledMembersCounter','MemberIdOrName','579595xorNKb'];a343_0x5ec2=function(){return _0xe2c29b;};return a343_0x5ec2();}const stream_1=require(a343_0x1eafdc(0x104)),salesforce_1=require(a343_0x1eafdc(0xd9)),constants_1=require(a343_0x1eafdc(0x106)),constants_2=require(a343_0x1eafdc(0xf0)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a343_0x1eafdc(0xe1),IS_NAME_OBSOLETE=a343_0x1eafdc(0x107),MEMBER_ID_FIELD_NAME=a343_0x1eafdc(0xd6),MEMBER_TYPE_FIELD_NAME='MemberType',CHANGED_BY_FIELD_NAME=a343_0x1eafdc(0xf6),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x1eafdc(0x10d)]+a343_0x1eafdc(0xe4),ORGANIZATION_NAME_FIELD=constants_2[a343_0x1eafdc(0x10d)]+a343_0x1eafdc(0x109),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a343_0x1eafdc(0x10d)]+'Revision_Counter__c',ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a343_0x1eafdc(0x10d)]+'Revision_Counter__c',constants_2[a343_0x1eafdc(0x10d)]+a343_0x1eafdc(0xfc),constants_2[a343_0x1eafdc(0x10d)]+'API_Name__c',constants_2[a343_0x1eafdc(0x10d)]+a343_0x1eafdc(0x105),constants_2['FLOSUM_NAMESPACE']+a343_0x1eafdc(0xe4),constants_2[a343_0x1eafdc(0x10d)]+a343_0x1eafdc(0x109),constants_2['FLOSUM_NAMESPACE']+a343_0x1eafdc(0xf9),constants_2[a343_0x1eafdc(0x10d)]+'Folder__c'];class SourceMemberHandler extends stream_1[a343_0x1eafdc(0xe5)]{constructor({apiVersion:_0x32397d,instance:_0x41dd9a,targetOrgId:_0x8dd788,logger:_0x5b34d6}){const _0xbda88=a343_0x1eafdc;super({'objectMode':!![]}),this[_0xbda88(0xf1)]=new Map(),this[_0xbda88(0xd5)]=0x0,this[_0xbda88(0x102)]=_0x32397d,this[_0xbda88(0xff)]=_0x41dd9a,this[_0xbda88(0x10a)]=_0x8dd788,this['logger']=_0x5b34d6;}[a343_0x1eafdc(0x108)](){const _0x4410a2=a343_0x1eafdc;return new salesforce_1[(_0x4410a2(0xda))]()[_0x4410a2(0x10e)](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0x4410a2(0xec)])['where'](SOURCE_MEMBER_ID_FIELD_NAME+_0x4410a2(0xe7),{'sourceMemberIds':[...this[_0x4410a2(0xf1)][_0x4410a2(0xe2)]()]})[_0x4410a2(0xf8)](ORGANIZATION_NAME_FIELD+_0x4410a2(0xe0),{'targetOrgId':this['targetOrgId']});}async[a343_0x1eafdc(0xeb)](){const _0x3fbe30=a343_0x1eafdc,_0xf4926b=new salesforce_1[(_0x3fbe30(0xdd))]({'api':this['api'],'queryBuilder':this[_0x3fbe30(0x108)](),'instance':this['instance'],'isTooling':![]}),_0xad18cd=new Map();do{const {records:_0x1bf2be}=await _0xf4926b[_0x3fbe30(0xef)]();for(const _0x40b8ee of _0x1bf2be){_0xad18cd[_0x3fbe30(0xfd)](_0x40b8ee[SOURCE_MEMBER_ID_FIELD_NAME],_0x40b8ee);}}while(!_0xf4926b[_0x3fbe30(0xfe)]());return _0xad18cd;}async[a343_0x1eafdc(0xe8)](_0x47292d){const _0x31fb10=a343_0x1eafdc;this['sourceMemberRecords']['set'](_0x47292d['Id'],_0x47292d),this[_0x31fb10(0xf1)][_0x31fb10(0xdc)]===MAX_CHUNK_SIZE&&await this[_0x31fb10(0xdf)]();}async['handle'](){const _0x20672f=a343_0x1eafdc,_0x18691e=await this['getComponentFromFlosum']();for(const [_0x5b6c22,_0x49555d]of this[_0x20672f(0xf1)]){const _0x528cb3=_0x18691e[_0x20672f(0xdb)](_0x5b6c22);if(_0x528cb3&&_0x49555d[REVISION_COUNTER_FIELD_NAME]===_0x528cb3[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0xd2b5f2={'sourceMemberId':_0x49555d['Id'],'componentId':(_0x528cb3===null||_0x528cb3===void 0x0?void 0x0:_0x528cb3['Id'])||null,'attachmentId':(_0x528cb3===null||_0x528cb3===void 0x0?void 0x0:_0x528cb3[_0x20672f(0xf9)])||null,'metadataId':_0x49555d[MEMBER_ID_FIELD_NAME],'metadataType':_0x49555d[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x49555d[IS_NAME_OBSOLETE],'revisionCounter':_0x49555d[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x49555d[CHANGED_BY_FIELD_NAME]};this[_0x20672f(0xd5)]++,this['push'](_0xd2b5f2);}this['sourceMemberRecords']=new Map();}async[a343_0x1eafdc(0xde)](_0x3fc315,_0x3022f7,_0x41d911){const _0x133cf8=a343_0x1eafdc;try{await this[_0x133cf8(0xe8)](_0x3fc315),_0x41d911();}catch(_0x43fc66){_0x41d911(_0x43fc66);}}async['_flush'](_0x3d7769){const _0x3a7868=a343_0x1eafdc;try{this[_0x3a7868(0xf1)][_0x3a7868(0xdc)]&&await this[_0x3a7868(0xdf)](),this[_0x3a7868(0x103)][_0x3a7868(0x100)](_0x3a7868(0xe3)+this['handledMembersCounter']+_0x3a7868(0xd8)),await this['logger'][_0x3a7868(0xed)](),_0x3d7769();}catch(_0x322ff4){_0x3d7769(_0x322ff4);}}}exports[a343_0x1eafdc(0xf4)]=SourceMemberHandler;