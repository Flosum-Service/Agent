function a343_0x5f47(_0x5984eb,_0x269f57){const _0x43f6c1=a343_0x4b0b();return a343_0x5f47=function(_0x3e49af,_0x717490){_0x3e49af=_0x3e49af-0xdd;let _0x4b0ba6=_0x43f6c1[_0x3e49af];return _0x4b0ba6;},a343_0x5f47(_0x5984eb,_0x269f57);}const a343_0x588a18=a343_0x5f47;(function(_0x3c1095,_0x4716e7){const _0x3ecebc=a343_0x5f47,_0x47cac1=_0x3c1095();while(!![]){try{const _0xbf7145=-parseInt(_0x3ecebc(0xf7))/0x1*(parseInt(_0x3ecebc(0x118))/0x2)+parseInt(_0x3ecebc(0xdd))/0x3+-parseInt(_0x3ecebc(0x107))/0x4*(parseInt(_0x3ecebc(0x111))/0x5)+parseInt(_0x3ecebc(0xe5))/0x6+-parseInt(_0x3ecebc(0x10f))/0x7*(-parseInt(_0x3ecebc(0xfd))/0x8)+-parseInt(_0x3ecebc(0x10e))/0x9*(-parseInt(_0x3ecebc(0xe1))/0xa)+parseInt(_0x3ecebc(0xfc))/0xb;if(_0xbf7145===_0x4716e7)break;else _0x47cac1['push'](_0x47cac1['shift']());}catch(_0x2e2e63){_0x47cac1['push'](_0x47cac1['shift']());}}}(a343_0x4b0b,0x8415e));const a343_0x717490=(function(){let _0x52865d=!![];return function(_0x15298e,_0x395230){const _0x37ac82=_0x52865d?function(){const _0x195cb3=a343_0x5f47;if(_0x395230){const _0x3be42e=_0x395230[_0x195cb3(0xf2)](_0x15298e,arguments);return _0x395230=null,_0x3be42e;}}:function(){};return _0x52865d=![],_0x37ac82;};}()),a343_0x3e49af=a343_0x717490(this,function(){const _0xac4a29=a343_0x5f47;return a343_0x3e49af[_0xac4a29(0xe7)]()[_0xac4a29(0xeb)](_0xac4a29(0x10a))[_0xac4a29(0xe7)]()[_0xac4a29(0x104)](a343_0x3e49af)[_0xac4a29(0xeb)](_0xac4a29(0x10a));});a343_0x3e49af();'use strict';Object[a343_0x588a18(0x116)](exports,a343_0x588a18(0xfe),{'value':!![]}),exports['SourceMemberHandler']=void 0x0;function a343_0x4b0b(){const _0x4c7d8b=['getComponentFromFlosum','(((.+)+)+)+$','SourceMemberHandler','handledMembersCounter','buildOrgComponentQuery','9Zuhrvo','14OPBRWw','set','2382815pLWQpF','_transform','@flosum/salesforce','Folder__c','where','defineProperty','\x20=\x20:targetOrgId','4846YqEHui','sourceMemberRecords','handle','MemberType','stream','Name__c','1985874JtpIMV','Changes\x20found\x20for\x20','../../constants','size','1000430opjaix','Source_Member_Id__c','OrganisationName__c','ORG_COMPONENT_OBJECT_NAME','171792SLNaEJ','MemberIdOrName','toString','\x20IN\x20(:sourceMemberIds)','get','andWhere','search','update','MemberName','_flush','api','Attachment_ID__c','select','apply','push','RevisionCounter','Revision_Counter__c','FLOSUM_NAMESPACE','359NyFWkz','Component_Type__c','instance','ChangedBy','keys','6571499cfVgMG','1997600oLevTf','__esModule','addToChunk','API_Name__c','targetOrgId','IsNameObsolete','execute','constructor','Transform','getIsDone','4nxapCI','log'];a343_0x4b0b=function(){return _0x4c7d8b;};return a343_0x4b0b();}const stream_1=require(a343_0x588a18(0x11c)),salesforce_1=require(a343_0x588a18(0x113)),constants_1=require(a343_0x588a18(0xdf)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a343_0x588a18(0xf4),IS_NAME_OBSOLETE=a343_0x588a18(0x102),MEMBER_ID_FIELD_NAME=a343_0x588a18(0xe6),MEMBER_TYPE_FIELD_NAME=a343_0x588a18(0x11b),MEMBER_NAME=a343_0x588a18(0xed),CHANGED_BY_FIELD_NAME=a343_0x588a18(0xfa),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x588a18(0xf6)]+a343_0x588a18(0xe2),ORGANIZATION_NAME_FIELD=constants_2['FLOSUM_NAMESPACE']+a343_0x588a18(0xe3),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a343_0x588a18(0xf6)]+a343_0x588a18(0xf5),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2['FLOSUM_NAMESPACE']+a343_0x588a18(0xf5),constants_2[a343_0x588a18(0xf6)]+a343_0x588a18(0xf8),constants_2[a343_0x588a18(0xf6)]+a343_0x588a18(0x100),constants_2['FLOSUM_NAMESPACE']+a343_0x588a18(0x11d),constants_2[a343_0x588a18(0xf6)]+a343_0x588a18(0xe2),constants_2['FLOSUM_NAMESPACE']+a343_0x588a18(0xe3),constants_2[a343_0x588a18(0xf6)]+a343_0x588a18(0xf0),constants_2[a343_0x588a18(0xf6)]+a343_0x588a18(0x114)];class SourceMemberHandler extends stream_1[a343_0x588a18(0x105)]{constructor({apiVersion:_0x318e51,instance:_0x2042cd,targetOrgId:_0x15ba46,logger:_0x1c591e}){const _0x34e628=a343_0x588a18;super({'objectMode':!![]}),this['sourceMemberRecords']=new Map(),this[_0x34e628(0x10c)]=0x0,this['api']=_0x318e51,this[_0x34e628(0xf9)]=_0x2042cd,this[_0x34e628(0x101)]=_0x15ba46,this['logger']=_0x1c591e;}['buildOrgComponentQuery'](){const _0x5de8f9=a343_0x588a18;return new salesforce_1['QueryBuilder']()[_0x5de8f9(0xf1)](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0x5de8f9(0xe4)])[_0x5de8f9(0x115)](SOURCE_MEMBER_ID_FIELD_NAME+_0x5de8f9(0xe8),{'sourceMemberIds':[...this[_0x5de8f9(0x119)][_0x5de8f9(0xfb)]()]})[_0x5de8f9(0xea)](ORGANIZATION_NAME_FIELD+_0x5de8f9(0x117),{'targetOrgId':this['targetOrgId']});}async[a343_0x588a18(0x109)](){const _0x3ac310=a343_0x588a18,_0x2700e2=new salesforce_1['CompositeRetrieveData']({'api':this[_0x3ac310(0xef)],'queryBuilder':this[_0x3ac310(0x10d)](),'instance':this[_0x3ac310(0xf9)],'isTooling':![]}),_0x433dc2=new Map();do{const {records:_0x7f5138}=await _0x2700e2[_0x3ac310(0x103)]();for(const _0x3354da of _0x7f5138){_0x433dc2[_0x3ac310(0x110)](_0x3354da[SOURCE_MEMBER_ID_FIELD_NAME],_0x3354da);}}while(!_0x2700e2[_0x3ac310(0x106)]());return _0x433dc2;}async[a343_0x588a18(0xff)](_0x3e2aae){const _0x240b63=a343_0x588a18;this[_0x240b63(0x119)][_0x240b63(0x110)](_0x3e2aae['Id'],_0x3e2aae),this[_0x240b63(0x119)]['size']===MAX_CHUNK_SIZE&&await this[_0x240b63(0x11a)]();}async[a343_0x588a18(0x11a)](){const _0x86b00=a343_0x588a18,_0x1498e2=await this['getComponentFromFlosum']();for(const [_0x16105c,_0x3f706a]of this[_0x86b00(0x119)]){const _0x35fbd0=_0x1498e2[_0x86b00(0xe9)](_0x16105c);if(_0x35fbd0&&_0x3f706a[REVISION_COUNTER_FIELD_NAME]===_0x35fbd0[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x12cf0b={'sourceMemberId':_0x3f706a['Id'],'componentId':(_0x35fbd0===null||_0x35fbd0===void 0x0?void 0x0:_0x35fbd0['Id'])||null,'attachmentId':(_0x35fbd0===null||_0x35fbd0===void 0x0?void 0x0:_0x35fbd0[_0x86b00(0xf0)])||null,'metadataId':_0x3f706a[MEMBER_ID_FIELD_NAME],'metadataType':_0x3f706a[MEMBER_TYPE_FIELD_NAME],'metadataName':_0x3f706a[MEMBER_NAME],'isNameObsolete':_0x3f706a[IS_NAME_OBSOLETE],'revisionCounter':_0x3f706a[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x3f706a[CHANGED_BY_FIELD_NAME]};this['handledMembersCounter']++,this[_0x86b00(0xf3)](_0x12cf0b);}this[_0x86b00(0x119)]=new Map();}async[a343_0x588a18(0x112)](_0x64cd5d,_0x519f1e,_0x2ca500){const _0x45116b=a343_0x588a18;try{await this[_0x45116b(0xff)](_0x64cd5d),_0x2ca500();}catch(_0x5e31cc){_0x2ca500(_0x5e31cc);}}async[a343_0x588a18(0xee)](_0x33a2ad){const _0x49a665=a343_0x588a18;try{this[_0x49a665(0x119)][_0x49a665(0xe0)]&&await this[_0x49a665(0x11a)](),this['logger'][_0x49a665(0x108)](_0x49a665(0xde)+this[_0x49a665(0x10c)]+'\x20components'),await this['logger'][_0x49a665(0xec)](),_0x33a2ad();}catch(_0x2a8630){_0x33a2ad(_0x2a8630);}}}exports[a343_0x588a18(0x10b)]=SourceMemberHandler;