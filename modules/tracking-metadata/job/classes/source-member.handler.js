const a343_0x1a98c5=a343_0x228f;(function(_0x133d44,_0x29eba5){const _0x332bb0=a343_0x228f,_0x102474=_0x133d44();while(!![]){try{const _0x487818=parseInt(_0x332bb0(0x1dd))/0x1*(parseInt(_0x332bb0(0x1e7))/0x2)+-parseInt(_0x332bb0(0x1ed))/0x3*(parseInt(_0x332bb0(0x1d5))/0x4)+-parseInt(_0x332bb0(0x1e8))/0x5*(-parseInt(_0x332bb0(0x1cd))/0x6)+-parseInt(_0x332bb0(0x1e3))/0x7*(parseInt(_0x332bb0(0x1fa))/0x8)+-parseInt(_0x332bb0(0x1e6))/0x9*(-parseInt(_0x332bb0(0x1e2))/0xa)+-parseInt(_0x332bb0(0x1f9))/0xb*(-parseInt(_0x332bb0(0x1cf))/0xc)+-parseInt(_0x332bb0(0x1c9))/0xd;if(_0x487818===_0x29eba5)break;else _0x102474['push'](_0x102474['shift']());}catch(_0x123fc1){_0x102474['push'](_0x102474['shift']());}}}(a343_0x36aa,0x3b534));const a343_0x640726=(function(){let _0x2ae624=!![];return function(_0xf7c5c9,_0x5c869e){const _0x123ba3=_0x2ae624?function(){if(_0x5c869e){const _0x332ad0=_0x5c869e['apply'](_0xf7c5c9,arguments);return _0x5c869e=null,_0x332ad0;}}:function(){};return _0x2ae624=![],_0x123ba3;};}()),a343_0x43622b=a343_0x640726(this,function(){const _0x240e34=a343_0x228f;return a343_0x43622b[_0x240e34(0x1f4)]()[_0x240e34(0x1f6)](_0x240e34(0x1f0))['toString']()[_0x240e34(0x1eb)](a343_0x43622b)[_0x240e34(0x1f6)]('(((.+)+)+)+$');});a343_0x43622b();function a343_0x228f(_0x4c2efc,_0x4df295){const _0x5dc10c=a343_0x36aa();return a343_0x228f=function(_0x43622b,_0x640726){_0x43622b=_0x43622b-0x1c6;let _0x36aa46=_0x5dc10c[_0x43622b];return _0x36aa46;},a343_0x228f(_0x4c2efc,_0x4df295);}'use strict';Object[a343_0x1a98c5(0x1f5)](exports,a343_0x1a98c5(0x1e5),{'value':!![]}),exports[a343_0x1a98c5(0x1d8)]=void 0x0;const stream_1=require(a343_0x1a98c5(0x1df)),salesforce_1=require(a343_0x1a98c5(0x1f2)),constants_1=require('../../constants'),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a343_0x1a98c5(0x1f8),IS_NAME_OBSOLETE=a343_0x1a98c5(0x1e0),MEMBER_ID_FIELD_NAME=a343_0x1a98c5(0x1da),MEMBER_TYPE_FIELD_NAME=a343_0x1a98c5(0x1f3),CHANGED_BY_FIELD_NAME=a343_0x1a98c5(0x1c8),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x1a98c5(0x1ca)]+a343_0x1a98c5(0x1f7),ORGANIZATION_NAME_FIELD=constants_2[a343_0x1a98c5(0x1ca)]+a343_0x1a98c5(0x1f1),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a343_0x1a98c5(0x1ca)]+a343_0x1a98c5(0x1d7),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a343_0x1a98c5(0x1ca)]+a343_0x1a98c5(0x1d7),constants_2['FLOSUM_NAMESPACE']+a343_0x1a98c5(0x1d3),constants_2[a343_0x1a98c5(0x1ca)]+'API_Name__c',constants_2['FLOSUM_NAMESPACE']+'Name__c',constants_2[a343_0x1a98c5(0x1ca)]+a343_0x1a98c5(0x1f7),constants_2[a343_0x1a98c5(0x1ca)]+a343_0x1a98c5(0x1f1),constants_2[a343_0x1a98c5(0x1ca)]+a343_0x1a98c5(0x1e4),constants_2[a343_0x1a98c5(0x1ca)]+'Folder__c'];class SourceMemberHandler extends stream_1[a343_0x1a98c5(0x1ef)]{constructor({apiVersion:_0x8027ec,instance:_0x1d1ce4,targetOrgId:_0x40b7ad,logger:_0x11b2a1}){const _0x4fb351=a343_0x1a98c5;super({'objectMode':!![]}),this[_0x4fb351(0x1e9)]=new Map(),this['handledMembersCounter']=0x0,this[_0x4fb351(0x1cb)]=_0x8027ec,this['instance']=_0x1d1ce4,this['targetOrgId']=_0x40b7ad,this[_0x4fb351(0x1d6)]=_0x11b2a1;}[a343_0x1a98c5(0x1ee)](){const _0x1bbcaa=a343_0x1a98c5;return new salesforce_1[(_0x1bbcaa(0x1de))]()[_0x1bbcaa(0x1db)](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1['ORG_COMPONENT_OBJECT_NAME'])[_0x1bbcaa(0x1d9)](SOURCE_MEMBER_ID_FIELD_NAME+'\x20IN\x20(:sourceMemberIds)',{'sourceMemberIds':[...this[_0x1bbcaa(0x1e9)]['keys']()]})['andWhere'](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this[_0x1bbcaa(0x1c6)]});}async[a343_0x1a98c5(0x1ea)](){const _0x23e904=a343_0x1a98c5,_0x16710a=new salesforce_1[(_0x23e904(0x1ec))]({'api':this['api'],'queryBuilder':this[_0x23e904(0x1ee)](),'instance':this['instance'],'isTooling':![]}),_0x4b5ca7=new Map();do{const {records:_0xa03abe}=await _0x16710a[_0x23e904(0x1d0)]();for(const _0x460928 of _0xa03abe){_0x4b5ca7[_0x23e904(0x1ce)](_0x460928[SOURCE_MEMBER_ID_FIELD_NAME],_0x460928);}}while(!_0x16710a['getIsDone']());return _0x4b5ca7;}async[a343_0x1a98c5(0x1c7)](_0xc430d5){const _0x4f58a2=a343_0x1a98c5;this[_0x4f58a2(0x1e9)][_0x4f58a2(0x1ce)](_0xc430d5['Id'],_0xc430d5),this[_0x4f58a2(0x1e9)][_0x4f58a2(0x1e1)]===MAX_CHUNK_SIZE&&await this[_0x4f58a2(0x1cc)]();}async[a343_0x1a98c5(0x1cc)](){const _0x41474a=a343_0x1a98c5,_0x125ee8=await this[_0x41474a(0x1ea)]();for(const [_0x537452,_0x4c7c71]of this[_0x41474a(0x1e9)]){const _0x5e501d=_0x125ee8[_0x41474a(0x1d4)](_0x537452);if(_0x5e501d&&_0x4c7c71[REVISION_COUNTER_FIELD_NAME]===_0x5e501d[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x5369b8={'sourceMemberId':_0x4c7c71['Id'],'componentId':(_0x5e501d===null||_0x5e501d===void 0x0?void 0x0:_0x5e501d['Id'])||null,'attachmentId':(_0x5e501d===null||_0x5e501d===void 0x0?void 0x0:_0x5e501d[_0x41474a(0x1e4)])||null,'metadataId':_0x4c7c71[MEMBER_ID_FIELD_NAME],'metadataType':_0x4c7c71[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x4c7c71[IS_NAME_OBSOLETE],'revisionCounter':_0x4c7c71[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x4c7c71[CHANGED_BY_FIELD_NAME]};this[_0x41474a(0x1d2)]++,this['push'](_0x5369b8);}this[_0x41474a(0x1e9)]=new Map();}async[a343_0x1a98c5(0x1d1)](_0x206657,_0x4c4333,_0x2284cb){try{await this['addToChunk'](_0x206657),_0x2284cb();}catch(_0x549a93){_0x2284cb(_0x549a93);}}async['_flush'](_0x1381e7){const _0x27075c=a343_0x1a98c5;try{this[_0x27075c(0x1e9)][_0x27075c(0x1e1)]&&await this[_0x27075c(0x1cc)](),this[_0x27075c(0x1d6)]['log']('Changes\x20found\x20for\x20'+this[_0x27075c(0x1d2)]+'\x20components'),await this[_0x27075c(0x1d6)][_0x27075c(0x1dc)](),_0x1381e7();}catch(_0x5a1286){_0x1381e7(_0x5a1286);}}}function a343_0x36aa(){const _0x440573=['logger','Revision_Counter__c','SourceMemberHandler','where','MemberIdOrName','select','update','429041SwdbEV','QueryBuilder','stream','IsNameObsolete','size','60tPLfAs','5789mAnNBR','Attachment_ID__c','__esModule','517653wbYLrW','2JirjYJ','15bqcevr','sourceMemberRecords','getComponentFromFlosum','constructor','CompositeRetrieveData','4215TTmikR','buildOrgComponentQuery','Transform','(((.+)+)+)+$','OrganisationName__c','@flosum/salesforce','MemberType','toString','defineProperty','search','Source_Member_Id__c','RevisionCounter','38049tsvsaO','712tEdNoJ','targetOrgId','addToChunk','ChangedBy','13004329TpdaqN','FLOSUM_NAMESPACE','api','handle','558684Ebzyip','set','1416xNPhuV','execute','_transform','handledMembersCounter','Component_Type__c','get','412NzVmyL'];a343_0x36aa=function(){return _0x440573;};return a343_0x36aa();}exports[a343_0x1a98c5(0x1d8)]=SourceMemberHandler;