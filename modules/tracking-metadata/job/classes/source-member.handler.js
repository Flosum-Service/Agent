const a300_0x321533=a300_0x4fdc;function a300_0x4fdc(_0x19847e,_0x3d784c){const _0x547b5e=a300_0x4e28();return a300_0x4fdc=function(_0x4007f1,_0x46d668){_0x4007f1=_0x4007f1-0xd6;let _0x4e28ba=_0x547b5e[_0x4007f1];return _0x4e28ba;},a300_0x4fdc(_0x19847e,_0x3d784c);}(function(_0x35f005,_0x3bad2e){const _0x145a35=a300_0x4fdc,_0x10fc90=_0x35f005();while(!![]){try{const _0x25cbff=-parseInt(_0x145a35(0xe2))/0x1+parseInt(_0x145a35(0x10a))/0x2+parseInt(_0x145a35(0x102))/0x3*(parseInt(_0x145a35(0xee))/0x4)+parseInt(_0x145a35(0x109))/0x5*(-parseInt(_0x145a35(0x108))/0x6)+-parseInt(_0x145a35(0xfa))/0x7*(parseInt(_0x145a35(0xd8))/0x8)+parseInt(_0x145a35(0x10b))/0x9+parseInt(_0x145a35(0xe3))/0xa;if(_0x25cbff===_0x3bad2e)break;else _0x10fc90['push'](_0x10fc90['shift']());}catch(_0x3a0424){_0x10fc90['push'](_0x10fc90['shift']());}}}(a300_0x4e28,0x7851d));const a300_0x46d668=(function(){let _0x125847=!![];return function(_0x33e374,_0x40814b){const _0x50e730=_0x125847?function(){const _0x1dfc5c=a300_0x4fdc;if(_0x40814b){const _0x4f011f=_0x40814b[_0x1dfc5c(0xdf)](_0x33e374,arguments);return _0x40814b=null,_0x4f011f;}}:function(){};return _0x125847=![],_0x50e730;};}()),a300_0x4007f1=a300_0x46d668(this,function(){const _0x305e18=a300_0x4fdc;return a300_0x4007f1[_0x305e18(0xef)]()[_0x305e18(0xf7)](_0x305e18(0x101))[_0x305e18(0xef)]()['constructor'](a300_0x4007f1)[_0x305e18(0xf7)]('(((.+)+)+)+$');});a300_0x4007f1();'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a300_0x321533(0xe5)]=void 0x0;const stream_1=require(a300_0x321533(0xf0)),salesforce_1=require(a300_0x321533(0xd6)),constants_1=require(a300_0x321533(0xf8)),constants_2=require(a300_0x321533(0xd7)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x321533(0x103),IS_NAME_OBSOLETE='IsNameObsolete',MEMBER_ID_FIELD_NAME=a300_0x321533(0xd9),MEMBER_TYPE_FIELD_NAME='MemberType',CHANGED_BY_FIELD_NAME=a300_0x321533(0x106),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a300_0x321533(0x107)]+a300_0x321533(0xdb),ORGANIZATION_NAME_FIELD=constants_2[a300_0x321533(0x107)]+a300_0x321533(0xe6),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x321533(0x107)]+a300_0x321533(0xe8),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a300_0x321533(0x107)]+a300_0x321533(0xe8),constants_2[a300_0x321533(0x107)]+a300_0x321533(0x100),constants_2[a300_0x321533(0x107)]+'API_Name__c',constants_2[a300_0x321533(0x107)]+a300_0x321533(0xf1),constants_2[a300_0x321533(0x107)]+a300_0x321533(0xdb),constants_2['FLOSUM_NAMESPACE']+a300_0x321533(0xe6),constants_2[a300_0x321533(0x107)]+'Attachment_ID__c',constants_2[a300_0x321533(0x107)]+a300_0x321533(0x104)];class SourceMemberHandler extends stream_1[a300_0x321533(0xf2)]{constructor({apiVersion:_0x3957c0,instance:_0x1b5aaf,targetOrgId:_0x3f658d,logger:_0x486675}){const _0x5eac82=a300_0x321533;super({'objectMode':!![]}),this[_0x5eac82(0xea)]=new Map(),this[_0x5eac82(0xed)]=0x0,this[_0x5eac82(0xff)]=_0x3957c0,this['instance']=_0x1b5aaf,this[_0x5eac82(0xfb)]=_0x3f658d,this['logger']=_0x486675;}['buildOrgComponentQuery'](){const _0x5b1b02=a300_0x321533;return new salesforce_1[(_0x5b1b02(0xfd))]()[_0x5b1b02(0xf6)](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1['ORG_COMPONENT_OBJECT_NAME'])['where'](SOURCE_MEMBER_ID_FIELD_NAME+_0x5b1b02(0xe4),{'sourceMemberIds':[...this[_0x5b1b02(0xea)][_0x5b1b02(0xda)]()]})[_0x5b1b02(0x105)](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this[_0x5b1b02(0xfb)]});}async[a300_0x321533(0xf4)](){const _0xdb560d=a300_0x321533,_0x4505fb=new salesforce_1['CompositeRetrieveData']({'api':this['api'],'queryBuilder':this[_0xdb560d(0xf5)](),'instance':this[_0xdb560d(0xfc)],'isTooling':![]}),_0x17e634=new Map();do{const {records:_0x11f914}=await _0x4505fb[_0xdb560d(0xe0)]();for(const _0x3c68d5 of _0x11f914){_0x17e634['set'](_0x3c68d5[SOURCE_MEMBER_ID_FIELD_NAME],_0x3c68d5);}}while(!_0x4505fb['getIsDone']());return _0x17e634;}async[a300_0x321533(0xe1)](_0x390139){const _0xcba8=a300_0x321533;this[_0xcba8(0xea)][_0xcba8(0xf9)](_0x390139['Id'],_0x390139),this[_0xcba8(0xea)]['size']===MAX_CHUNK_SIZE&&await this[_0xcba8(0xeb)]();}async[a300_0x321533(0xeb)](){const _0x43ce8b=a300_0x321533,_0x64deb2=await this[_0x43ce8b(0xf4)]();for(const [_0x41941a,_0x58b952]of this[_0x43ce8b(0xea)]){const _0x3bbc97=_0x64deb2[_0x43ce8b(0xe7)](_0x41941a);if(_0x3bbc97&&_0x58b952[REVISION_COUNTER_FIELD_NAME]===_0x3bbc97[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x893d96={'sourceMemberId':_0x58b952['Id'],'componentId':(_0x3bbc97===null||_0x3bbc97===void 0x0?void 0x0:_0x3bbc97['Id'])||null,'attachmentId':(_0x3bbc97===null||_0x3bbc97===void 0x0?void 0x0:_0x3bbc97[_0x43ce8b(0xfe)])||null,'metadataId':_0x58b952[MEMBER_ID_FIELD_NAME],'metadataType':_0x58b952[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x58b952[IS_NAME_OBSOLETE],'revisionCounter':_0x58b952[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x58b952[CHANGED_BY_FIELD_NAME]};this['handledMembersCounter']++,this['push'](_0x893d96);}this['sourceMemberRecords']=new Map();}async[a300_0x321533(0xec)](_0x5e727e,_0x429365,_0x2ff07e){const _0x14dc38=a300_0x321533;try{await this[_0x14dc38(0xe1)](_0x5e727e),_0x2ff07e();}catch(_0xf7d20b){_0x2ff07e(_0xf7d20b);}}async[a300_0x321533(0xdd)](_0x59df10){const _0x22f76f=a300_0x321533;try{this['sourceMemberRecords'][_0x22f76f(0xe9)]&&await this[_0x22f76f(0xeb)](),this['logger'][_0x22f76f(0xf3)](_0x22f76f(0xde)+this[_0x22f76f(0xed)]+'\x20components'),await this['logger'][_0x22f76f(0xdc)](),_0x59df10();}catch(_0x5a48e9){_0x59df10(_0x5a48e9);}}}function a300_0x4e28(){const _0x3fb24c=['376335XUqBoi','810948pxAKDN','3364893SjjNtV','@flosum/salesforce','../../../../constants','152bufBUv','MemberIdOrName','keys','Source_Member_Id__c','update','_flush','Changes\x20found\x20for\x20','apply','execute','addToChunk','630716tIpYum','19068930AjtCVn','\x20IN\x20(:sourceMemberIds)','SourceMemberHandler','OrganisationName__c','get','Revision_Counter__c','size','sourceMemberRecords','handle','_transform','handledMembersCounter','8144tnJGvc','toString','stream','Name__c','Transform','log','getComponentFromFlosum','buildOrgComponentQuery','select','search','../../constants','set','301504ennGWo','targetOrgId','instance','QueryBuilder','Attachment_ID__c','api','Component_Type__c','(((.+)+)+)+$','345QufJhK','RevisionCounter','Folder__c','andWhere','ChangedBy','FLOSUM_NAMESPACE','78wvkOCZ'];a300_0x4e28=function(){return _0x3fb24c;};return a300_0x4e28();}exports[a300_0x321533(0xe5)]=SourceMemberHandler;