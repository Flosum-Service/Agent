const a332_0xa4c0c1=a332_0x440d;function a332_0x440d(_0x2fb465,_0x33ad5a){const _0x41b16f=a332_0x11a8();return a332_0x440d=function(_0x46371f,_0x9fc979){_0x46371f=_0x46371f-0x1ef;let _0x11a88a=_0x41b16f[_0x46371f];return _0x11a88a;},a332_0x440d(_0x2fb465,_0x33ad5a);}(function(_0x52193c,_0x1fcde8){const _0x13a455=a332_0x440d,_0x533899=_0x52193c();while(!![]){try{const _0x53e326=parseInt(_0x13a455(0x221))/0x1+parseInt(_0x13a455(0x202))/0x2*(-parseInt(_0x13a455(0x1f0))/0x3)+parseInt(_0x13a455(0x222))/0x4+parseInt(_0x13a455(0x1fb))/0x5+-parseInt(_0x13a455(0x1f2))/0x6*(-parseInt(_0x13a455(0x204))/0x7)+-parseInt(_0x13a455(0x21b))/0x8+-parseInt(_0x13a455(0x227))/0x9*(parseInt(_0x13a455(0x215))/0xa);if(_0x53e326===_0x1fcde8)break;else _0x533899['push'](_0x533899['shift']());}catch(_0x3ad721){_0x533899['push'](_0x533899['shift']());}}}(a332_0x11a8,0xdfdb3));const a332_0x9fc979=(function(){let _0x470c1f=!![];return function(_0x53496f,_0x4d0429){const _0xf2790e=_0x470c1f?function(){const _0x37788f=a332_0x440d;if(_0x4d0429){const _0x581a5a=_0x4d0429[_0x37788f(0x225)](_0x53496f,arguments);return _0x4d0429=null,_0x581a5a;}}:function(){};return _0x470c1f=![],_0xf2790e;};}()),a332_0x46371f=a332_0x9fc979(this,function(){const _0x4eb745=a332_0x440d;return a332_0x46371f['toString']()['search'](_0x4eb745(0x21e))['toString']()['constructor'](a332_0x46371f)[_0x4eb745(0x200)]('(((.+)+)+)+$');});function a332_0x11a8(){const _0x261b7e=['171AxchBy','@flosum/salesforce','addToChunk','2819166YYJtJJ','api','4141038RvUolP','buildOrgComponentQuery','OrganisationName__c','\x20=\x20:targetOrgId','from','FLOSUM_NAMESPACE','log','SourceMemberHandler','logger','1492105ENYXCh','execute','defineProperty','../../constants','Revision_Counter__c','search','Name__c','2uqzhcK','size','14SrMSBF','Source_Member_Id__c','CompositeRetrieveData','Attachment_ID__c','RevisionCounter','_transform','get','push','Folder__c','QueryBuilder','targetOrgId','instance','__esModule','getComponentFromFlosum','_flush','ChangedBy','select','1133990nGuwRf','handle','stream','where','../../../../constants','andWhere','4888920VrQxnP','sourceMemberRecords','Changes\x20found\x20for\x20','(((.+)+)+)+$','update','API_Name__c','1279266wCEHXz','6657200ublrzA','handledMembersCounter','getIsDone','apply','MemberIdOrName'];a332_0x11a8=function(){return _0x261b7e;};return a332_0x11a8();}a332_0x46371f();'use strict';Object[a332_0xa4c0c1(0x1fd)](exports,a332_0xa4c0c1(0x210),{'value':!![]}),exports['SourceMemberHandler']=void 0x0;const stream_1=require(a332_0xa4c0c1(0x217)),salesforce_1=require(a332_0xa4c0c1(0x228)),constants_1=require(a332_0xa4c0c1(0x1fe)),constants_2=require(a332_0xa4c0c1(0x219)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a332_0xa4c0c1(0x208),IS_NAME_OBSOLETE='IsNameObsolete',MEMBER_ID_FIELD_NAME=a332_0xa4c0c1(0x226),MEMBER_TYPE_FIELD_NAME='MemberType',CHANGED_BY_FIELD_NAME=a332_0xa4c0c1(0x213),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a332_0xa4c0c1(0x1f7)]+a332_0xa4c0c1(0x205),ORGANIZATION_NAME_FIELD=constants_2[a332_0xa4c0c1(0x1f7)]+a332_0xa4c0c1(0x1f4),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a332_0xa4c0c1(0x1ff),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a332_0xa4c0c1(0x1f7)]+a332_0xa4c0c1(0x1ff),constants_2['FLOSUM_NAMESPACE']+'Component_Type__c',constants_2['FLOSUM_NAMESPACE']+a332_0xa4c0c1(0x220),constants_2['FLOSUM_NAMESPACE']+a332_0xa4c0c1(0x201),constants_2['FLOSUM_NAMESPACE']+a332_0xa4c0c1(0x205),constants_2[a332_0xa4c0c1(0x1f7)]+a332_0xa4c0c1(0x1f4),constants_2[a332_0xa4c0c1(0x1f7)]+a332_0xa4c0c1(0x207),constants_2['FLOSUM_NAMESPACE']+a332_0xa4c0c1(0x20c)];class SourceMemberHandler extends stream_1['Transform']{constructor({apiVersion:_0x458465,instance:_0x9840b,targetOrgId:_0x17001d,logger:_0x2d5bcd}){const _0x45e3f0=a332_0xa4c0c1;super({'objectMode':!![]}),this['sourceMemberRecords']=new Map(),this['handledMembersCounter']=0x0,this[_0x45e3f0(0x1f1)]=_0x458465,this['instance']=_0x9840b,this[_0x45e3f0(0x20e)]=_0x17001d,this[_0x45e3f0(0x1fa)]=_0x2d5bcd;}[a332_0xa4c0c1(0x1f3)](){const _0x4ab472=a332_0xa4c0c1;return new salesforce_1[(_0x4ab472(0x20d))]()[_0x4ab472(0x214)](...ORG_COMPONENT_SELECT_FIELDS)[_0x4ab472(0x1f6)](constants_1['ORG_COMPONENT_OBJECT_NAME'])[_0x4ab472(0x218)](SOURCE_MEMBER_ID_FIELD_NAME+'\x20IN\x20(:sourceMemberIds)',{'sourceMemberIds':[...this[_0x4ab472(0x21c)]['keys']()]})[_0x4ab472(0x21a)](ORGANIZATION_NAME_FIELD+_0x4ab472(0x1f5),{'targetOrgId':this['targetOrgId']});}async[a332_0xa4c0c1(0x211)](){const _0x4ecc7b=a332_0xa4c0c1,_0x1df4d8=new salesforce_1[(_0x4ecc7b(0x206))]({'api':this[_0x4ecc7b(0x1f1)],'queryBuilder':this[_0x4ecc7b(0x1f3)](),'instance':this[_0x4ecc7b(0x20f)],'isTooling':![]}),_0x246737=new Map();do{const {records:_0x1d68eb}=await _0x1df4d8[_0x4ecc7b(0x1fc)]();for(const _0x2c5395 of _0x1d68eb){_0x246737['set'](_0x2c5395[SOURCE_MEMBER_ID_FIELD_NAME],_0x2c5395);}}while(!_0x1df4d8[_0x4ecc7b(0x224)]());return _0x246737;}async['addToChunk'](_0x21ded7){const _0x1943e4=a332_0xa4c0c1;this[_0x1943e4(0x21c)]['set'](_0x21ded7['Id'],_0x21ded7),this[_0x1943e4(0x21c)][_0x1943e4(0x203)]===MAX_CHUNK_SIZE&&await this[_0x1943e4(0x216)]();}async[a332_0xa4c0c1(0x216)](){const _0x351f79=a332_0xa4c0c1,_0x3098b5=await this[_0x351f79(0x211)]();for(const [_0x14866b,_0x55b563]of this[_0x351f79(0x21c)]){const _0x5df42f=_0x3098b5[_0x351f79(0x20a)](_0x14866b);if(_0x5df42f&&_0x55b563[REVISION_COUNTER_FIELD_NAME]===_0x5df42f[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x22e597={'sourceMemberId':_0x55b563['Id'],'componentId':(_0x5df42f===null||_0x5df42f===void 0x0?void 0x0:_0x5df42f['Id'])||null,'attachmentId':(_0x5df42f===null||_0x5df42f===void 0x0?void 0x0:_0x5df42f[_0x351f79(0x207)])||null,'metadataId':_0x55b563[MEMBER_ID_FIELD_NAME],'metadataType':_0x55b563[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x55b563[IS_NAME_OBSOLETE],'revisionCounter':_0x55b563[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x55b563[CHANGED_BY_FIELD_NAME]};this['handledMembersCounter']++,this[_0x351f79(0x20b)](_0x22e597);}this[_0x351f79(0x21c)]=new Map();}async[a332_0xa4c0c1(0x209)](_0x444f3e,_0x3d8804,_0x3c09cd){const _0x1754ca=a332_0xa4c0c1;try{await this[_0x1754ca(0x1ef)](_0x444f3e),_0x3c09cd();}catch(_0x33cdad){_0x3c09cd(_0x33cdad);}}async[a332_0xa4c0c1(0x212)](_0x4f3786){const _0x15bd8e=a332_0xa4c0c1;try{this[_0x15bd8e(0x21c)]['size']&&await this[_0x15bd8e(0x216)](),this[_0x15bd8e(0x1fa)][_0x15bd8e(0x1f8)](_0x15bd8e(0x21d)+this[_0x15bd8e(0x223)]+'\x20components'),await this[_0x15bd8e(0x1fa)][_0x15bd8e(0x21f)](),_0x4f3786();}catch(_0x4679dd){_0x4f3786(_0x4679dd);}}}exports[a332_0xa4c0c1(0x1f9)]=SourceMemberHandler;