const a295_0x1cc2cc=a295_0x409d;(function(_0x26938e,_0x4830e9){const _0x3e685a=a295_0x409d,_0x419545=_0x26938e();while(!![]){try{const _0x1f410e=-parseInt(_0x3e685a(0x167))/0x1+parseInt(_0x3e685a(0x168))/0x2*(-parseInt(_0x3e685a(0x179))/0x3)+parseInt(_0x3e685a(0x185))/0x4*(-parseInt(_0x3e685a(0x197))/0x5)+parseInt(_0x3e685a(0x16c))/0x6+-parseInt(_0x3e685a(0x193))/0x7*(-parseInt(_0x3e685a(0x16a))/0x8)+-parseInt(_0x3e685a(0x181))/0x9+parseInt(_0x3e685a(0x188))/0xa;if(_0x1f410e===_0x4830e9)break;else _0x419545['push'](_0x419545['shift']());}catch(_0x5bfbaf){_0x419545['push'](_0x419545['shift']());}}}(a295_0x5108,0xa6b6a));const a295_0x1e001f=(function(){let _0x58f371=!![];return function(_0x2da285,_0x27f582){const _0x216a83=_0x58f371?function(){if(_0x27f582){const _0x199f8e=_0x27f582['apply'](_0x2da285,arguments);return _0x27f582=null,_0x199f8e;}}:function(){};return _0x58f371=![],_0x216a83;};}()),a295_0x301903=a295_0x1e001f(this,function(){const _0x2a0684=a295_0x409d;return a295_0x301903[_0x2a0684(0x17d)]()[_0x2a0684(0x183)]('(((.+)+)+)+$')[_0x2a0684(0x17d)]()['constructor'](a295_0x301903)['search'](_0x2a0684(0x18e));});a295_0x301903();'use strict';Object['defineProperty'](exports,a295_0x1cc2cc(0x16d),{'value':!![]}),exports[a295_0x1cc2cc(0x198)]=void 0x0;function a295_0x5108(){const _0x5d1469=['883050DadWnT','3160gcaLam','set','8zAPIiw','targetOrgId','7055682FGhWBm','__esModule','FLOSUM_NAMESPACE','get','where','ChangedBy','push','IsNameObsolete','handledMembersCounter','select','api','sourceMemberRecords','OrganisationName__c','1572HQllgY','Source_Member_Id__c','Attachment_ID__c','handle','toString','MemberType','ORG_COMPONENT_OBJECT_NAME','Changes\x20found\x20for\x20','115470spEfaq','RevisionCounter','search','from','16528MJPkzJ','MemberIdOrName','stream','15705620NBKPBH','size','\x20=\x20:targetOrgId','andWhere','../../constants','\x20components','(((.+)+)+)+$','Component_Type__c','\x20IN\x20(:sourceMemberIds)','instance','_flush','773759PnGCaQ','../../../../constants','logger','CompositeRetrieveData','545nUujJa','SourceMemberHandler','Revision_Counter__c','update','API_Name__c','getComponentFromFlosum','addToChunk','buildOrgComponentQuery'];a295_0x5108=function(){return _0x5d1469;};return a295_0x5108();}const stream_1=require(a295_0x1cc2cc(0x187)),salesforce_1=require('@flosum/salesforce'),constants_1=require(a295_0x1cc2cc(0x18c)),constants_2=require(a295_0x1cc2cc(0x194)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a295_0x1cc2cc(0x182),IS_NAME_OBSOLETE=a295_0x1cc2cc(0x173),MEMBER_ID_FIELD_NAME=a295_0x1cc2cc(0x186),MEMBER_TYPE_FIELD_NAME=a295_0x1cc2cc(0x17e),CHANGED_BY_FIELD_NAME=a295_0x1cc2cc(0x171),SOURCE_MEMBER_ID_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+'Source_Member_Id__c',ORGANIZATION_NAME_FIELD=constants_2[a295_0x1cc2cc(0x16e)]+'OrganisationName__c',REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a295_0x1cc2cc(0x16e)]+a295_0x1cc2cc(0x199),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2['FLOSUM_NAMESPACE']+'Revision_Counter__c',constants_2[a295_0x1cc2cc(0x16e)]+a295_0x1cc2cc(0x18f),constants_2[a295_0x1cc2cc(0x16e)]+a295_0x1cc2cc(0x163),constants_2[a295_0x1cc2cc(0x16e)]+'Name__c',constants_2[a295_0x1cc2cc(0x16e)]+a295_0x1cc2cc(0x17a),constants_2[a295_0x1cc2cc(0x16e)]+a295_0x1cc2cc(0x178),constants_2[a295_0x1cc2cc(0x16e)]+'Attachment_ID__c',constants_2[a295_0x1cc2cc(0x16e)]+'Folder__c'];function a295_0x409d(_0x1eb208,_0x5acd12){const _0x16d341=a295_0x5108();return a295_0x409d=function(_0x301903,_0x1e001f){_0x301903=_0x301903-0x162;let _0x5108a7=_0x16d341[_0x301903];return _0x5108a7;},a295_0x409d(_0x1eb208,_0x5acd12);}class SourceMemberHandler extends stream_1['Transform']{constructor({apiVersion:_0x90ebdc,instance:_0x3569c9,targetOrgId:_0x5c5f92,logger:_0x4a9378}){const _0x571134=a295_0x1cc2cc;super({'objectMode':!![]}),this[_0x571134(0x177)]=new Map(),this[_0x571134(0x174)]=0x0,this['api']=_0x90ebdc,this[_0x571134(0x191)]=_0x3569c9,this[_0x571134(0x16b)]=_0x5c5f92,this[_0x571134(0x195)]=_0x4a9378;}[a295_0x1cc2cc(0x166)](){const _0x328ba3=a295_0x1cc2cc;return new salesforce_1['QueryBuilder']()[_0x328ba3(0x175)](...ORG_COMPONENT_SELECT_FIELDS)[_0x328ba3(0x184)](constants_1[_0x328ba3(0x17f)])[_0x328ba3(0x170)](SOURCE_MEMBER_ID_FIELD_NAME+_0x328ba3(0x190),{'sourceMemberIds':[...this[_0x328ba3(0x177)]['keys']()]})[_0x328ba3(0x18b)](ORGANIZATION_NAME_FIELD+_0x328ba3(0x18a),{'targetOrgId':this[_0x328ba3(0x16b)]});}async['getComponentFromFlosum'](){const _0x52e89d=a295_0x1cc2cc,_0x2c2b68=new salesforce_1[(_0x52e89d(0x196))]({'api':this[_0x52e89d(0x176)],'queryBuilder':this[_0x52e89d(0x166)](),'instance':this[_0x52e89d(0x191)],'isTooling':![]}),_0x59649f=new Map();do{const {records:_0x220d5c}=await _0x2c2b68['execute']();for(const _0x38ec66 of _0x220d5c){_0x59649f['set'](_0x38ec66[SOURCE_MEMBER_ID_FIELD_NAME],_0x38ec66);}}while(!_0x2c2b68['getIsDone']());return _0x59649f;}async[a295_0x1cc2cc(0x165)](_0x4de368){const _0x33d083=a295_0x1cc2cc;this[_0x33d083(0x177)][_0x33d083(0x169)](_0x4de368['Id'],_0x4de368),this['sourceMemberRecords'][_0x33d083(0x189)]===MAX_CHUNK_SIZE&&await this[_0x33d083(0x17c)]();}async[a295_0x1cc2cc(0x17c)](){const _0x166926=a295_0x1cc2cc,_0x4620fe=await this[_0x166926(0x164)]();for(const [_0x30f28c,_0x45335d]of this[_0x166926(0x177)]){const _0x37ffb0=_0x4620fe[_0x166926(0x16f)](_0x30f28c);if(_0x37ffb0&&_0x45335d[REVISION_COUNTER_FIELD_NAME]===_0x37ffb0[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x1fe720={'sourceMemberId':_0x45335d['Id'],'componentId':(_0x37ffb0===null||_0x37ffb0===void 0x0?void 0x0:_0x37ffb0['Id'])||null,'attachmentId':(_0x37ffb0===null||_0x37ffb0===void 0x0?void 0x0:_0x37ffb0[_0x166926(0x17b)])||null,'metadataId':_0x45335d[MEMBER_ID_FIELD_NAME],'metadataType':_0x45335d[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x45335d[IS_NAME_OBSOLETE],'revisionCounter':_0x45335d[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x45335d[CHANGED_BY_FIELD_NAME]};this['handledMembersCounter']++,this[_0x166926(0x172)](_0x1fe720);}this[_0x166926(0x177)]=new Map();}async['_transform'](_0x473518,_0x5af311,_0x446f3b){const _0x56f861=a295_0x1cc2cc;try{await this[_0x56f861(0x165)](_0x473518),_0x446f3b();}catch(_0x237526){_0x446f3b(_0x237526);}}async[a295_0x1cc2cc(0x192)](_0x2f6522){const _0x947e0a=a295_0x1cc2cc;try{this[_0x947e0a(0x177)]['size']&&await this[_0x947e0a(0x17c)](),this[_0x947e0a(0x195)]['log'](_0x947e0a(0x180)+this[_0x947e0a(0x174)]+_0x947e0a(0x18d)),await this[_0x947e0a(0x195)][_0x947e0a(0x162)](),_0x2f6522();}catch(_0x43075a){_0x2f6522(_0x43075a);}}}exports[a295_0x1cc2cc(0x198)]=SourceMemberHandler;