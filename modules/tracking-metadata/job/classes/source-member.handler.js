const a343_0x10d034=a343_0x242b;function a343_0x242b(_0x497fc8,_0xef73ac){const _0x4384f0=a343_0x475c();return a343_0x242b=function(_0x321d09,_0xb1acd5){_0x321d09=_0x321d09-0x114;let _0x475c5e=_0x4384f0[_0x321d09];return _0x475c5e;},a343_0x242b(_0x497fc8,_0xef73ac);}(function(_0x107d30,_0x121bd3){const _0x144677=a343_0x242b,_0x2d3e72=_0x107d30();while(!![]){try{const _0x5d3779=parseInt(_0x144677(0x119))/0x1+-parseInt(_0x144677(0x11d))/0x2*(-parseInt(_0x144677(0x12d))/0x3)+-parseInt(_0x144677(0x12c))/0x4*(-parseInt(_0x144677(0x120))/0x5)+parseInt(_0x144677(0x127))/0x6+-parseInt(_0x144677(0x13f))/0x7*(-parseInt(_0x144677(0x12f))/0x8)+parseInt(_0x144677(0x131))/0x9+parseInt(_0x144677(0x129))/0xa*(-parseInt(_0x144677(0x14a))/0xb);if(_0x5d3779===_0x121bd3)break;else _0x2d3e72['push'](_0x2d3e72['shift']());}catch(_0x315349){_0x2d3e72['push'](_0x2d3e72['shift']());}}}(a343_0x475c,0x1a97b));const a343_0xb1acd5=(function(){let _0x4e2af7=!![];return function(_0x2619c6,_0x57de7e){const _0xa558=_0x4e2af7?function(){const _0x162bc1=a343_0x242b;if(_0x57de7e){const _0x443475=_0x57de7e[_0x162bc1(0x122)](_0x2619c6,arguments);return _0x57de7e=null,_0x443475;}}:function(){};return _0x4e2af7=![],_0xa558;};}()),a343_0x321d09=a343_0xb1acd5(this,function(){const _0x58de5c=a343_0x242b;return a343_0x321d09[_0x58de5c(0x13e)]()[_0x58de5c(0x13b)](_0x58de5c(0x135))[_0x58de5c(0x13e)]()['constructor'](a343_0x321d09)[_0x58de5c(0x13b)](_0x58de5c(0x135));});a343_0x321d09();function a343_0x475c(){const _0x5d00ab=['2751SYkcsp','addToChunk','keys','Transform','../../constants','getComponentFromFlosum','MemberIdOrName','log','SourceMemberHandler','API_Name__c','_flush','737CdYaVt','Attachment_ID__c','targetOrgId','_transform','sourceMemberRecords','Name__c','RevisionCounter','set','handledMembersCounter','FLOSUM_NAMESPACE','OrganisationName__c','118462UcPTmk','instance','andWhere','QueryBuilder','766CVLyiz','ChangedBy','IsNameObsolete','5710fPgDsq','execute','apply','logger','buildOrgComponentQuery','api','ORG_COMPONENT_OBJECT_NAME','514890jLWQxb','update','58080PugOgl','CompositeRetrieveData','Component_Type__c','224zTwevP','1449CJJiYq','Source_Member_Id__c','96BvvWlP','MemberName','361125WVOABp','../../../../constants','\x20IN\x20(:sourceMemberIds)','size','(((.+)+)+)+$','handle','get','push','defineProperty','stream','search','__esModule','\x20components','toString'];a343_0x475c=function(){return _0x5d00ab;};return a343_0x475c();}'use strict';Object[a343_0x10d034(0x139)](exports,a343_0x10d034(0x13c),{'value':!![]}),exports[a343_0x10d034(0x147)]=void 0x0;const stream_1=require(a343_0x10d034(0x13a)),salesforce_1=require('@flosum/salesforce'),constants_1=require(a343_0x10d034(0x143)),constants_2=require(a343_0x10d034(0x132)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a343_0x10d034(0x114),IS_NAME_OBSOLETE=a343_0x10d034(0x11f),MEMBER_ID_FIELD_NAME=a343_0x10d034(0x145),MEMBER_TYPE_FIELD_NAME='MemberType',MEMBER_NAME=a343_0x10d034(0x130),CHANGED_BY_FIELD_NAME=a343_0x10d034(0x11e),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x10d034(0x117)]+'Source_Member_Id__c',ORGANIZATION_NAME_FIELD=constants_2[a343_0x10d034(0x117)]+a343_0x10d034(0x118),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a343_0x10d034(0x117)]+'Revision_Counter__c',ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2['FLOSUM_NAMESPACE']+'Revision_Counter__c',constants_2[a343_0x10d034(0x117)]+a343_0x10d034(0x12b),constants_2[a343_0x10d034(0x117)]+a343_0x10d034(0x148),constants_2[a343_0x10d034(0x117)]+a343_0x10d034(0x14f),constants_2[a343_0x10d034(0x117)]+a343_0x10d034(0x12e),constants_2[a343_0x10d034(0x117)]+a343_0x10d034(0x118),constants_2[a343_0x10d034(0x117)]+'Attachment_ID__c',constants_2[a343_0x10d034(0x117)]+'Folder__c'];class SourceMemberHandler extends stream_1[a343_0x10d034(0x142)]{constructor({apiVersion:_0x34449c,instance:_0x193eff,targetOrgId:_0x34b7de,logger:_0x272375}){const _0x18444c=a343_0x10d034;super({'objectMode':!![]}),this[_0x18444c(0x14e)]=new Map(),this[_0x18444c(0x116)]=0x0,this[_0x18444c(0x125)]=_0x34449c,this[_0x18444c(0x11a)]=_0x193eff,this['targetOrgId']=_0x34b7de,this[_0x18444c(0x123)]=_0x272375;}[a343_0x10d034(0x124)](){const _0x27716a=a343_0x10d034;return new salesforce_1[(_0x27716a(0x11c))]()['select'](...ORG_COMPONENT_SELECT_FIELDS)['from'](constants_1[_0x27716a(0x126)])['where'](SOURCE_MEMBER_ID_FIELD_NAME+_0x27716a(0x133),{'sourceMemberIds':[...this[_0x27716a(0x14e)][_0x27716a(0x141)]()]})[_0x27716a(0x11b)](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this[_0x27716a(0x14c)]});}async[a343_0x10d034(0x144)](){const _0xc923f6=a343_0x10d034,_0x4b5906=new salesforce_1[(_0xc923f6(0x12a))]({'api':this[_0xc923f6(0x125)],'queryBuilder':this[_0xc923f6(0x124)](),'instance':this[_0xc923f6(0x11a)],'isTooling':![]}),_0x121899=new Map();do{const {records:_0x2b6e16}=await _0x4b5906[_0xc923f6(0x121)]();for(const _0x1f96e1 of _0x2b6e16){_0x121899[_0xc923f6(0x115)](_0x1f96e1[SOURCE_MEMBER_ID_FIELD_NAME],_0x1f96e1);}}while(!_0x4b5906['getIsDone']());return _0x121899;}async[a343_0x10d034(0x140)](_0x407f44){const _0x46aef1=a343_0x10d034;this[_0x46aef1(0x14e)]['set'](_0x407f44['Id'],_0x407f44),this[_0x46aef1(0x14e)][_0x46aef1(0x134)]===MAX_CHUNK_SIZE&&await this[_0x46aef1(0x136)]();}async[a343_0x10d034(0x136)](){const _0x161b79=a343_0x10d034,_0x6bb0c6=await this[_0x161b79(0x144)]();for(const [_0x318a54,_0x1e709b]of this['sourceMemberRecords']){const _0x40e2df=_0x6bb0c6[_0x161b79(0x137)](_0x318a54);if(_0x40e2df&&_0x1e709b[REVISION_COUNTER_FIELD_NAME]===_0x40e2df[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x47e370={'sourceMemberId':_0x1e709b['Id'],'componentId':(_0x40e2df===null||_0x40e2df===void 0x0?void 0x0:_0x40e2df['Id'])||null,'attachmentId':(_0x40e2df===null||_0x40e2df===void 0x0?void 0x0:_0x40e2df[_0x161b79(0x14b)])||null,'metadataId':_0x1e709b[MEMBER_ID_FIELD_NAME],'metadataType':_0x1e709b[MEMBER_TYPE_FIELD_NAME],'metadataName':_0x1e709b[MEMBER_NAME],'isNameObsolete':_0x1e709b[IS_NAME_OBSOLETE],'revisionCounter':_0x1e709b[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x1e709b[CHANGED_BY_FIELD_NAME]};this[_0x161b79(0x116)]++,this[_0x161b79(0x138)](_0x47e370);}this['sourceMemberRecords']=new Map();}async[a343_0x10d034(0x14d)](_0x16e253,_0x463cdb,_0xddd189){const _0x191c3a=a343_0x10d034;try{await this[_0x191c3a(0x140)](_0x16e253),_0xddd189();}catch(_0x230f8f){_0xddd189(_0x230f8f);}}async[a343_0x10d034(0x149)](_0x5afeec){const _0x4e1efa=a343_0x10d034;try{this[_0x4e1efa(0x14e)][_0x4e1efa(0x134)]&&await this[_0x4e1efa(0x136)](),this[_0x4e1efa(0x123)][_0x4e1efa(0x146)]('Changes\x20found\x20for\x20'+this[_0x4e1efa(0x116)]+_0x4e1efa(0x13d)),await this[_0x4e1efa(0x123)][_0x4e1efa(0x128)](),_0x5afeec();}catch(_0x56af0c){_0x5afeec(_0x56af0c);}}}exports[a343_0x10d034(0x147)]=SourceMemberHandler;