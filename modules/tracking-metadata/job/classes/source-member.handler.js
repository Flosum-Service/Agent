const a344_0x34c693=a344_0x1a74;(function(_0x547198,_0x4d0ff9){const _0x194b03=a344_0x1a74,_0x3c7fbc=_0x547198();while(!![]){try{const _0xce3ee4=-parseInt(_0x194b03(0x1f5))/0x1+-parseInt(_0x194b03(0x220))/0x2*(-parseInt(_0x194b03(0x224))/0x3)+-parseInt(_0x194b03(0x20d))/0x4*(-parseInt(_0x194b03(0x203))/0x5)+parseInt(_0x194b03(0x1f6))/0x6+-parseInt(_0x194b03(0x202))/0x7+parseInt(_0x194b03(0x201))/0x8*(parseInt(_0x194b03(0x1f8))/0x9)+parseInt(_0x194b03(0x20a))/0xa*(-parseInt(_0x194b03(0x221))/0xb);if(_0xce3ee4===_0x4d0ff9)break;else _0x3c7fbc['push'](_0x3c7fbc['shift']());}catch(_0x3e4666){_0x3c7fbc['push'](_0x3c7fbc['shift']());}}}(a344_0x3859,0xe6ed4));const a344_0x5a763c=(function(){let _0x4d5cdd=!![];return function(_0x58ba2c,_0x510637){const _0xe5927c=_0x4d5cdd?function(){const _0x1cce71=a344_0x1a74;if(_0x510637){const _0x4b58a9=_0x510637[_0x1cce71(0x20e)](_0x58ba2c,arguments);return _0x510637=null,_0x4b58a9;}}:function(){};return _0x4d5cdd=![],_0xe5927c;};}()),a344_0x456a40=a344_0x5a763c(this,function(){const _0x153f51=a344_0x1a74;return a344_0x456a40[_0x153f51(0x20b)]()[_0x153f51(0x225)]('(((.+)+)+)+$')[_0x153f51(0x20b)]()[_0x153f51(0x1f2)](a344_0x456a40)[_0x153f51(0x225)](_0x153f51(0x206));});function a344_0x1a74(_0x295243,_0x33b064){const _0x39c6ff=a344_0x3859();return a344_0x1a74=function(_0x456a40,_0x5a763c){_0x456a40=_0x456a40-0x1eb;let _0x3859a3=_0x39c6ff[_0x456a40];return _0x3859a3;},a344_0x1a74(_0x295243,_0x33b064);}a344_0x456a40();'use strict';function a344_0x3859(){const _0x4c349a=['RevisionCounter','Source_Member_Id__c','Revision_Counter__c','../../../../constants','@flosum/salesforce','56bYVnLk','6678896riGJWV','115WVbfDO','logger','select','(((.+)+)+)+$','sourceMemberRecords','addToChunk','IsNameObsolete','4163020gtowtz','toString','\x20components','278428LqmykW','apply','Transform','targetOrgId','../../constants','FLOSUM_NAMESPACE','instance','api','getIsDone','buildOrgComponentQuery','MemberIdOrName','where','set','__esModule','size','push','SourceMemberHandler','keys','CompositeRetrieveData','50mHUMIX','33LJDQfI','andWhere','get','44703NujjPl','search','handle','update','OrganisationName__c','Attachment_ID__c','Changes\x20found\x20for\x20','QueryBuilder','log','\x20IN\x20(:sourceMemberIds)','constructor','Folder__c','handledMembersCounter','1466114glZLJb','10899906vItSno','Name__c','1060569IvIthT','_transform','from','getComponentFromFlosum'];a344_0x3859=function(){return _0x4c349a;};return a344_0x3859();}Object['defineProperty'](exports,a344_0x34c693(0x21a),{'value':!![]}),exports[a344_0x34c693(0x21d)]=void 0x0;const stream_1=require('stream'),salesforce_1=require(a344_0x34c693(0x200)),constants_1=require(a344_0x34c693(0x211)),constants_2=require(a344_0x34c693(0x1ff)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a344_0x34c693(0x1fc),IS_NAME_OBSOLETE=a344_0x34c693(0x209),MEMBER_ID_FIELD_NAME=a344_0x34c693(0x217),MEMBER_TYPE_FIELD_NAME='MemberType',MEMBER_NAME='MemberName',CHANGED_BY_FIELD_NAME='ChangedBy',SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a344_0x34c693(0x212)]+a344_0x34c693(0x1fd),ORGANIZATION_NAME_FIELD=constants_2[a344_0x34c693(0x212)]+a344_0x34c693(0x1ec),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a344_0x34c693(0x1fe),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a344_0x34c693(0x212)]+a344_0x34c693(0x1fe),constants_2[a344_0x34c693(0x212)]+'Component_Type__c',constants_2['FLOSUM_NAMESPACE']+'API_Name__c',constants_2[a344_0x34c693(0x212)]+a344_0x34c693(0x1f7),constants_2['FLOSUM_NAMESPACE']+a344_0x34c693(0x1fd),constants_2['FLOSUM_NAMESPACE']+'OrganisationName__c',constants_2[a344_0x34c693(0x212)]+'Attachment_ID__c',constants_2[a344_0x34c693(0x212)]+a344_0x34c693(0x1f3)];class SourceMemberHandler extends stream_1[a344_0x34c693(0x20f)]{constructor({apiVersion:_0x8edf6b,instance:_0x1db104,targetOrgId:_0x517044,logger:_0x3fcfe3}){const _0x3815da=a344_0x34c693;super({'objectMode':!![]}),this[_0x3815da(0x207)]=new Map(),this[_0x3815da(0x1f4)]=0x0,this['api']=_0x8edf6b,this['instance']=_0x1db104,this['targetOrgId']=_0x517044,this[_0x3815da(0x204)]=_0x3fcfe3;}[a344_0x34c693(0x216)](){const _0x37c5c3=a344_0x34c693;return new salesforce_1[(_0x37c5c3(0x1ef))]()[_0x37c5c3(0x205)](...ORG_COMPONENT_SELECT_FIELDS)[_0x37c5c3(0x1fa)](constants_1['ORG_COMPONENT_OBJECT_NAME'])[_0x37c5c3(0x218)](SOURCE_MEMBER_ID_FIELD_NAME+_0x37c5c3(0x1f1),{'sourceMemberIds':[...this[_0x37c5c3(0x207)][_0x37c5c3(0x21e)]()]})[_0x37c5c3(0x222)](ORGANIZATION_NAME_FIELD+'\x20=\x20:targetOrgId',{'targetOrgId':this[_0x37c5c3(0x210)]});}async[a344_0x34c693(0x1fb)](){const _0x580ff9=a344_0x34c693,_0x53de7b=new salesforce_1[(_0x580ff9(0x21f))]({'api':this[_0x580ff9(0x214)],'queryBuilder':this['buildOrgComponentQuery'](),'instance':this[_0x580ff9(0x213)],'isTooling':![]}),_0x350060=new Map();do{const {records:_0x33726f}=await _0x53de7b['execute']();for(const _0x4bc9c4 of _0x33726f){_0x350060[_0x580ff9(0x219)](_0x4bc9c4[SOURCE_MEMBER_ID_FIELD_NAME],_0x4bc9c4);}}while(!_0x53de7b[_0x580ff9(0x215)]());return _0x350060;}async[a344_0x34c693(0x208)](_0x130ed9){const _0x488b20=a344_0x34c693;this[_0x488b20(0x207)]['set'](_0x130ed9['Id'],_0x130ed9),this[_0x488b20(0x207)][_0x488b20(0x21b)]===MAX_CHUNK_SIZE&&await this['handle']();}async[a344_0x34c693(0x226)](){const _0x292b2e=a344_0x34c693,_0x29dabe=await this[_0x292b2e(0x1fb)]();for(const [_0x1cc807,_0x52b194]of this[_0x292b2e(0x207)]){const _0x1280ad=_0x29dabe[_0x292b2e(0x223)](_0x1cc807);if(_0x1280ad&&_0x52b194[REVISION_COUNTER_FIELD_NAME]===_0x1280ad[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x13e94e={'sourceMemberId':_0x52b194['Id'],'componentId':(_0x1280ad===null||_0x1280ad===void 0x0?void 0x0:_0x1280ad['Id'])||null,'attachmentId':(_0x1280ad===null||_0x1280ad===void 0x0?void 0x0:_0x1280ad[_0x292b2e(0x1ed)])||null,'metadataId':_0x52b194[MEMBER_ID_FIELD_NAME],'metadataType':_0x52b194[MEMBER_TYPE_FIELD_NAME],'metadataName':_0x52b194[MEMBER_NAME],'isNameObsolete':_0x52b194[IS_NAME_OBSOLETE],'revisionCounter':_0x52b194[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x52b194[CHANGED_BY_FIELD_NAME]};this[_0x292b2e(0x1f4)]++,this[_0x292b2e(0x21c)](_0x13e94e);}this[_0x292b2e(0x207)]=new Map();}async[a344_0x34c693(0x1f9)](_0x38550c,_0x1d51dc,_0x1f4e11){const _0x339dae=a344_0x34c693;try{await this[_0x339dae(0x208)](_0x38550c),_0x1f4e11();}catch(_0x2a98f2){_0x1f4e11(_0x2a98f2);}}async['_flush'](_0x18d0e4){const _0x44abf0=a344_0x34c693;try{this['sourceMemberRecords'][_0x44abf0(0x21b)]&&await this[_0x44abf0(0x226)](),this[_0x44abf0(0x204)][_0x44abf0(0x1f0)](_0x44abf0(0x1ee)+this[_0x44abf0(0x1f4)]+_0x44abf0(0x20c)),await this[_0x44abf0(0x204)][_0x44abf0(0x1eb)](),_0x18d0e4();}catch(_0x3a20dd){_0x18d0e4(_0x3a20dd);}}}exports[a344_0x34c693(0x21d)]=SourceMemberHandler;