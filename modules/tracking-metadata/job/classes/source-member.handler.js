const a343_0x3efcea=a343_0x2a0b;(function(_0x6307c9,_0x4cc13a){const _0x1a9630=a343_0x2a0b,_0xc767b5=_0x6307c9();while(!![]){try{const _0xc5954d=-parseInt(_0x1a9630(0x153))/0x1+-parseInt(_0x1a9630(0x159))/0x2*(-parseInt(_0x1a9630(0x171))/0x3)+parseInt(_0x1a9630(0x17a))/0x4*(parseInt(_0x1a9630(0x15c))/0x5)+parseInt(_0x1a9630(0x178))/0x6*(-parseInt(_0x1a9630(0x17b))/0x7)+parseInt(_0x1a9630(0x150))/0x8*(-parseInt(_0x1a9630(0x14c))/0x9)+-parseInt(_0x1a9630(0x158))/0xa+parseInt(_0x1a9630(0x15f))/0xb;if(_0xc5954d===_0x4cc13a)break;else _0xc767b5['push'](_0xc767b5['shift']());}catch(_0x7dadd){_0xc767b5['push'](_0xc767b5['shift']());}}}(a343_0x4ab1,0x9ff90));const a343_0x14afc4=(function(){let _0x493761=!![];return function(_0x2d1ac3,_0x54f8f1){const _0x2c7c97=_0x493761?function(){const _0x2d8bc8=a343_0x2a0b;if(_0x54f8f1){const _0x4790e7=_0x54f8f1[_0x2d8bc8(0x147)](_0x2d1ac3,arguments);return _0x54f8f1=null,_0x4790e7;}}:function(){};return _0x493761=![],_0x2c7c97;};}()),a343_0x4b1b64=a343_0x14afc4(this,function(){const _0x454a00=a343_0x2a0b;return a343_0x4b1b64[_0x454a00(0x17e)]()[_0x454a00(0x148)](_0x454a00(0x164))[_0x454a00(0x17e)]()[_0x454a00(0x160)](a343_0x4b1b64)[_0x454a00(0x148)](_0x454a00(0x164));});a343_0x4b1b64();function a343_0x2a0b(_0x3a92db,_0x2e823b){const _0x152bd1=a343_0x4ab1();return a343_0x2a0b=function(_0x4b1b64,_0x14afc4){_0x4b1b64=_0x4b1b64-0x145;let _0x4ab14e=_0x152bd1[_0x4b1b64];return _0x4ab14e;},a343_0x2a0b(_0x3a92db,_0x2e823b);}'use strict';Object[a343_0x3efcea(0x17c)](exports,'__esModule',{'value':!![]}),exports[a343_0x3efcea(0x163)]=void 0x0;const stream_1=require('stream'),salesforce_1=require(a343_0x3efcea(0x14b)),constants_1=require(a343_0x3efcea(0x174)),constants_2=require('../../../../constants'),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a343_0x3efcea(0x166),IS_NAME_OBSOLETE='IsNameObsolete',MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME=a343_0x3efcea(0x15d),CHANGED_BY_FIELD_NAME=a343_0x3efcea(0x170),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x145),ORGANIZATION_NAME_FIELD=constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x149),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x172),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a343_0x3efcea(0x14e)]+'Revision_Counter__c',constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x16c),constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x14d),constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x14a),constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x145),constants_2[a343_0x3efcea(0x14e)]+'OrganisationName__c',constants_2[a343_0x3efcea(0x14e)]+'Attachment_ID__c',constants_2[a343_0x3efcea(0x14e)]+a343_0x3efcea(0x157)];class SourceMemberHandler extends stream_1['Transform']{constructor({apiVersion:_0x5a3e8b,instance:_0x5b23a0,targetOrgId:_0x36a4d0,logger:_0x2d4226}){const _0x4f3cf9=a343_0x3efcea;super({'objectMode':!![]}),this['sourceMemberRecords']=new Map(),this[_0x4f3cf9(0x15a)]=0x0,this[_0x4f3cf9(0x165)]=_0x5a3e8b,this[_0x4f3cf9(0x14f)]=_0x5b23a0,this[_0x4f3cf9(0x146)]=_0x36a4d0,this[_0x4f3cf9(0x16f)]=_0x2d4226;}['buildOrgComponentQuery'](){const _0x366711=a343_0x3efcea;return new salesforce_1[(_0x366711(0x16e))]()[_0x366711(0x169)](...ORG_COMPONENT_SELECT_FIELDS)[_0x366711(0x15b)](constants_1[_0x366711(0x154)])[_0x366711(0x161)](SOURCE_MEMBER_ID_FIELD_NAME+_0x366711(0x16b),{'sourceMemberIds':[...this['sourceMemberRecords']['keys']()]})['andWhere'](ORGANIZATION_NAME_FIELD+_0x366711(0x155),{'targetOrgId':this[_0x366711(0x146)]});}async[a343_0x3efcea(0x168)](){const _0x375af5=a343_0x3efcea,_0x44db30=new salesforce_1[(_0x375af5(0x175))]({'api':this[_0x375af5(0x165)],'queryBuilder':this[_0x375af5(0x152)](),'instance':this['instance'],'isTooling':![]}),_0x56fc5c=new Map();do{const {records:_0x1d3a01}=await _0x44db30[_0x375af5(0x151)]();for(const _0x2c4fdd of _0x1d3a01){_0x56fc5c['set'](_0x2c4fdd[SOURCE_MEMBER_ID_FIELD_NAME],_0x2c4fdd);}}while(!_0x44db30[_0x375af5(0x176)]());return _0x56fc5c;}async[a343_0x3efcea(0x177)](_0x47934a){const _0x49dd85=a343_0x3efcea;this[_0x49dd85(0x16d)][_0x49dd85(0x173)](_0x47934a['Id'],_0x47934a),this['sourceMemberRecords']['size']===MAX_CHUNK_SIZE&&await this[_0x49dd85(0x179)]();}async[a343_0x3efcea(0x179)](){const _0x25d26d=a343_0x3efcea,_0x38c754=await this[_0x25d26d(0x168)]();for(const [_0x202f2c,_0x2942d4]of this['sourceMemberRecords']){const _0x4a9151=_0x38c754[_0x25d26d(0x15e)](_0x202f2c);if(_0x4a9151&&_0x2942d4[REVISION_COUNTER_FIELD_NAME]===_0x4a9151[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x3b8de0={'sourceMemberId':_0x2942d4['Id'],'componentId':(_0x4a9151===null||_0x4a9151===void 0x0?void 0x0:_0x4a9151['Id'])||null,'attachmentId':(_0x4a9151===null||_0x4a9151===void 0x0?void 0x0:_0x4a9151[_0x25d26d(0x156)])||null,'metadataId':_0x2942d4[MEMBER_ID_FIELD_NAME],'metadataType':_0x2942d4[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x2942d4[IS_NAME_OBSOLETE],'revisionCounter':_0x2942d4[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x2942d4[CHANGED_BY_FIELD_NAME]};this['handledMembersCounter']++,this[_0x25d26d(0x17d)](_0x3b8de0);}this[_0x25d26d(0x16d)]=new Map();}async[a343_0x3efcea(0x162)](_0x2bb4ea,_0x574f9c,_0x52b0b2){const _0x1e70b7=a343_0x3efcea;try{await this[_0x1e70b7(0x177)](_0x2bb4ea),_0x52b0b2();}catch(_0x50fdd6){_0x52b0b2(_0x50fdd6);}}async['_flush'](_0x4ab8fd){const _0xc88005=a343_0x3efcea;try{this[_0xc88005(0x16d)][_0xc88005(0x16a)]&&await this[_0xc88005(0x179)](),this['logger'][_0xc88005(0x167)]('Changes\x20found\x20for\x20'+this[_0xc88005(0x15a)]+'\x20components'),await this['logger']['update'](),_0x4ab8fd();}catch(_0xfa109a){_0x4ab8fd(_0xfa109a);}}}function a343_0x4ab1(){const _0x3e7463=['API_Name__c','FLOSUM_NAMESPACE','instance','8kZsjtH','execute','buildOrgComponentQuery','846728mnHehd','ORG_COMPONENT_OBJECT_NAME','\x20=\x20:targetOrgId','Attachment_ID__c','Folder__c','909570OwUxla','3682oOJVLk','handledMembersCounter','from','65ddaPSV','MemberType','get','32044133AiYWHa','constructor','where','_transform','SourceMemberHandler','(((.+)+)+)+$','api','RevisionCounter','log','getComponentFromFlosum','select','size','\x20IN\x20(:sourceMemberIds)','Component_Type__c','sourceMemberRecords','QueryBuilder','logger','ChangedBy','3XfvEFk','Revision_Counter__c','set','../../constants','CompositeRetrieveData','getIsDone','addToChunk','4746XGCzvi','handle','53468WsZdRi','4627KnqCMS','defineProperty','push','toString','Source_Member_Id__c','targetOrgId','apply','search','OrganisationName__c','Name__c','@flosum/salesforce','8756379JRhtjb'];a343_0x4ab1=function(){return _0x3e7463;};return a343_0x4ab1();}exports['SourceMemberHandler']=SourceMemberHandler;