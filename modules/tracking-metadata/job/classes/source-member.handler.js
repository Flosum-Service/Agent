function a300_0x440a(){const _0x17a419=['CompositeRetrieveData','\x20IN\x20(:sourceMemberIds)','api','Name__c','1259608wcaGpC','ORG_COMPONENT_OBJECT_NAME','OrganisationName__c','sourceMemberRecords','../../../../constants','handledMembersCounter','2GhjEid','__esModule','stream','1765730blJvMx','777570SCGXxN','handle','getIsDone','get','push','buildOrgComponentQuery','select','apply','log','search','IsNameObsolete','QueryBuilder','144AwBSSl','26248MXIYKl','ChangedBy','targetOrgId','\x20=\x20:targetOrgId','\x20components','instance','Attachment_ID__c','size','getComponentFromFlosum','toString','4187340oBgpNL','execute','from','_flush','6iWuIOU','addToChunk','(((.+)+)+)+$','Changes\x20found\x20for\x20','constructor','Folder__c','Source_Member_Id__c','RevisionCounter','SourceMemberHandler','logger','Transform','update','366329csgdnS','where','3688979XqEODp','22tPnYrQ','FLOSUM_NAMESPACE','keys','set','API_Name__c'];a300_0x440a=function(){return _0x17a419;};return a300_0x440a();}const a300_0x195159=a300_0x4188;(function(_0x379ad8,_0xd6d89e){const _0x1a1d42=a300_0x4188,_0x4a769e=_0x379ad8();while(!![]){try{const _0x2742ab=parseInt(_0x1a1d42(0xa3))/0x1*(-parseInt(_0x1a1d42(0x78))/0x2)+parseInt(_0x1a1d42(0x7c))/0x3+-parseInt(_0x1a1d42(0x72))/0x4+-parseInt(_0x1a1d42(0x7b))/0x5*(-parseInt(_0x1a1d42(0x97))/0x6)+-parseInt(_0x1a1d42(0xa5))/0x7+-parseInt(_0x1a1d42(0x89))/0x8*(-parseInt(_0x1a1d42(0x88))/0x9)+-parseInt(_0x1a1d42(0x93))/0xa*(-parseInt(_0x1a1d42(0xa6))/0xb);if(_0x2742ab===_0xd6d89e)break;else _0x4a769e['push'](_0x4a769e['shift']());}catch(_0x2d89d7){_0x4a769e['push'](_0x4a769e['shift']());}}}(a300_0x440a,0x47cb8));const a300_0x36b394=(function(){let _0x3f9dee=!![];return function(_0x388cbb,_0xb4b143){const _0x2ab3e9=_0x3f9dee?function(){const _0xf6c0d0=a300_0x4188;if(_0xb4b143){const _0x77fe8f=_0xb4b143[_0xf6c0d0(0x83)](_0x388cbb,arguments);return _0xb4b143=null,_0x77fe8f;}}:function(){};return _0x3f9dee=![],_0x2ab3e9;};}()),a300_0x2fd8f6=a300_0x36b394(this,function(){const _0x38aa81=a300_0x4188;return a300_0x2fd8f6[_0x38aa81(0x92)]()[_0x38aa81(0x85)]('(((.+)+)+)+$')[_0x38aa81(0x92)]()[_0x38aa81(0x9b)](a300_0x2fd8f6)['search'](_0x38aa81(0x99));});a300_0x2fd8f6();function a300_0x4188(_0x176552,_0x7db29d){const _0x3660a7=a300_0x440a();return a300_0x4188=function(_0x2fd8f6,_0x36b394){_0x2fd8f6=_0x2fd8f6-0x6d;let _0x440acf=_0x3660a7[_0x2fd8f6];return _0x440acf;},a300_0x4188(_0x176552,_0x7db29d);}'use strict';Object['defineProperty'](exports,a300_0x195159(0x79),{'value':!![]}),exports[a300_0x195159(0x9f)]=void 0x0;const stream_1=require(a300_0x195159(0x7a)),salesforce_1=require('@flosum/salesforce'),constants_1=require('../../constants'),constants_2=require(a300_0x195159(0x76)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x195159(0x9e),IS_NAME_OBSOLETE=a300_0x195159(0x86),MEMBER_ID_FIELD_NAME='MemberIdOrName',MEMBER_TYPE_FIELD_NAME='MemberType',CHANGED_BY_FIELD_NAME=a300_0x195159(0x8a),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a300_0x195159(0xa7)]+'Source_Member_Id__c',ORGANIZATION_NAME_FIELD=constants_2[a300_0x195159(0xa7)]+'OrganisationName__c',REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2[a300_0x195159(0xa7)]+'Revision_Counter__c',ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2[a300_0x195159(0xa7)]+'Revision_Counter__c',constants_2[a300_0x195159(0xa7)]+'Component_Type__c',constants_2[a300_0x195159(0xa7)]+a300_0x195159(0x6d),constants_2[a300_0x195159(0xa7)]+a300_0x195159(0x71),constants_2[a300_0x195159(0xa7)]+a300_0x195159(0x9d),constants_2[a300_0x195159(0xa7)]+a300_0x195159(0x74),constants_2[a300_0x195159(0xa7)]+'Attachment_ID__c',constants_2[a300_0x195159(0xa7)]+a300_0x195159(0x9c)];class SourceMemberHandler extends stream_1[a300_0x195159(0xa1)]{constructor({apiVersion:_0x42290d,instance:_0x2c823a,targetOrgId:_0x588a23,logger:_0x9a75bf}){const _0x35b3ba=a300_0x195159;super({'objectMode':!![]}),this[_0x35b3ba(0x75)]=new Map(),this['handledMembersCounter']=0x0,this[_0x35b3ba(0x70)]=_0x42290d,this[_0x35b3ba(0x8e)]=_0x2c823a,this['targetOrgId']=_0x588a23,this[_0x35b3ba(0xa0)]=_0x9a75bf;}[a300_0x195159(0x81)](){const _0x5ec66f=a300_0x195159;return new salesforce_1[(_0x5ec66f(0x87))]()[_0x5ec66f(0x82)](...ORG_COMPONENT_SELECT_FIELDS)[_0x5ec66f(0x95)](constants_1[_0x5ec66f(0x73)])[_0x5ec66f(0xa4)](SOURCE_MEMBER_ID_FIELD_NAME+_0x5ec66f(0x6f),{'sourceMemberIds':[...this[_0x5ec66f(0x75)][_0x5ec66f(0xa8)]()]})['andWhere'](ORGANIZATION_NAME_FIELD+_0x5ec66f(0x8c),{'targetOrgId':this[_0x5ec66f(0x8b)]});}async[a300_0x195159(0x91)](){const _0x357389=a300_0x195159,_0x4e5d2d=new salesforce_1[(_0x357389(0x6e))]({'api':this[_0x357389(0x70)],'queryBuilder':this[_0x357389(0x81)](),'instance':this[_0x357389(0x8e)],'isTooling':![]}),_0x5b3cee=new Map();do{const {records:_0x13d928}=await _0x4e5d2d[_0x357389(0x94)]();for(const _0x38634f of _0x13d928){_0x5b3cee[_0x357389(0xa9)](_0x38634f[SOURCE_MEMBER_ID_FIELD_NAME],_0x38634f);}}while(!_0x4e5d2d[_0x357389(0x7e)]());return _0x5b3cee;}async[a300_0x195159(0x98)](_0x84695f){const _0x5d4aec=a300_0x195159;this[_0x5d4aec(0x75)]['set'](_0x84695f['Id'],_0x84695f),this['sourceMemberRecords'][_0x5d4aec(0x90)]===MAX_CHUNK_SIZE&&await this[_0x5d4aec(0x7d)]();}async['handle'](){const _0xe49ffb=a300_0x195159,_0x154af5=await this['getComponentFromFlosum']();for(const [_0x45a913,_0x11e418]of this[_0xe49ffb(0x75)]){const _0x3749f2=_0x154af5[_0xe49ffb(0x7f)](_0x45a913);if(_0x3749f2&&_0x11e418[REVISION_COUNTER_FIELD_NAME]===_0x3749f2[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0xc8387e={'sourceMemberId':_0x11e418['Id'],'componentId':(_0x3749f2===null||_0x3749f2===void 0x0?void 0x0:_0x3749f2['Id'])||null,'attachmentId':(_0x3749f2===null||_0x3749f2===void 0x0?void 0x0:_0x3749f2[_0xe49ffb(0x8f)])||null,'metadataId':_0x11e418[MEMBER_ID_FIELD_NAME],'metadataType':_0x11e418[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x11e418[IS_NAME_OBSOLETE],'revisionCounter':_0x11e418[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x11e418[CHANGED_BY_FIELD_NAME]};this['handledMembersCounter']++,this[_0xe49ffb(0x80)](_0xc8387e);}this['sourceMemberRecords']=new Map();}async['_transform'](_0x1943bc,_0x5a7567,_0x43fd20){const _0x1a677b=a300_0x195159;try{await this[_0x1a677b(0x98)](_0x1943bc),_0x43fd20();}catch(_0x7adbb){_0x43fd20(_0x7adbb);}}async[a300_0x195159(0x96)](_0x20ad9a){const _0x5b57cd=a300_0x195159;try{this['sourceMemberRecords']['size']&&await this[_0x5b57cd(0x7d)](),this[_0x5b57cd(0xa0)][_0x5b57cd(0x84)](_0x5b57cd(0x9a)+this[_0x5b57cd(0x77)]+_0x5b57cd(0x8d)),await this[_0x5b57cd(0xa0)][_0x5b57cd(0xa2)](),_0x20ad9a();}catch(_0x3ccb30){_0x20ad9a(_0x3ccb30);}}}exports[a300_0x195159(0x9f)]=SourceMemberHandler;