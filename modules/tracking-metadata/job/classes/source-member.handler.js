function a300_0x22d5(_0x49d810,_0x314305){const _0x4c3952=a300_0x549a();return a300_0x22d5=function(_0x320d05,_0x3d364d){_0x320d05=_0x320d05-0x193;let _0x549a6d=_0x4c3952[_0x320d05];return _0x549a6d;},a300_0x22d5(_0x49d810,_0x314305);}const a300_0x36314e=a300_0x22d5;(function(_0x5c0758,_0x1c4006){const _0x39011a=a300_0x22d5,_0x17f1f9=_0x5c0758();while(!![]){try{const _0x49f4de=-parseInt(_0x39011a(0x1c0))/0x1*(-parseInt(_0x39011a(0x19e))/0x2)+parseInt(_0x39011a(0x1ba))/0x3*(-parseInt(_0x39011a(0x1a2))/0x4)+parseInt(_0x39011a(0x194))/0x5*(parseInt(_0x39011a(0x1cf))/0x6)+-parseInt(_0x39011a(0x1c8))/0x7+-parseInt(_0x39011a(0x1ce))/0x8*(parseInt(_0x39011a(0x1a9))/0x9)+-parseInt(_0x39011a(0x197))/0xa*(parseInt(_0x39011a(0x198))/0xb)+-parseInt(_0x39011a(0x1ca))/0xc*(-parseInt(_0x39011a(0x19a))/0xd);if(_0x49f4de===_0x1c4006)break;else _0x17f1f9['push'](_0x17f1f9['shift']());}catch(_0x8afb17){_0x17f1f9['push'](_0x17f1f9['shift']());}}}(a300_0x549a,0x1d94b));const a300_0x3d364d=(function(){let _0x4cd624=!![];return function(_0x44af1e,_0x42e0b6){const _0x5205f5=_0x4cd624?function(){const _0x56dd9c=a300_0x22d5;if(_0x42e0b6){const _0x57048f=_0x42e0b6[_0x56dd9c(0x1cb)](_0x44af1e,arguments);return _0x42e0b6=null,_0x57048f;}}:function(){};return _0x4cd624=![],_0x5205f5;};}()),a300_0x320d05=a300_0x3d364d(this,function(){const _0x1c9c6a=a300_0x22d5;return a300_0x320d05[_0x1c9c6a(0x1af)]()[_0x1c9c6a(0x1cc)]('(((.+)+)+)+$')['toString']()[_0x1c9c6a(0x1ab)](a300_0x320d05)['search'](_0x1c9c6a(0x19d));});a300_0x320d05();'use strict';Object[a300_0x36314e(0x1c9)](exports,'__esModule',{'value':!![]}),exports[a300_0x36314e(0x1a3)]=void 0x0;function a300_0x549a(){const _0x4f2315=['9bRPFpw','from','constructor','\x20IN\x20(:sourceMemberIds)','OrganisationName__c','handle','toString','getIsDone','Component_Type__c','size','update','get','getComponentFromFlosum','../../../../constants','Source_Member_Id__c','log','stream','45fxyBYs','MemberIdOrName','targetOrgId','push','andWhere','MemberType','223385WSstsI','Folder__c','ChangedBy','\x20components','Transform','FLOSUM_NAMESPACE','../../constants','logger','1197455OidSvL','defineProperty','84umZOSV','apply','search','_transform','561112lUJSyk','6llYTMA','addToChunk','144575xkWaFB','RevisionCounter','handledMembersCounter','45380NjJObI','462qEydZx','QueryBuilder','978042XshxRh','\x20=\x20:targetOrgId','Revision_Counter__c','(((.+)+)+)+$','2DrsUUL','buildOrgComponentQuery','@flosum/salesforce','sourceMemberRecords','60260mCPBoF','SourceMemberHandler','Attachment_ID__c','instance','ORG_COMPONENT_OBJECT_NAME','Name__c','api'];a300_0x549a=function(){return _0x4f2315;};return a300_0x549a();}const stream_1=require(a300_0x36314e(0x1b9)),salesforce_1=require(a300_0x36314e(0x1a0)),constants_1=require(a300_0x36314e(0x1c6)),constants_2=require(a300_0x36314e(0x1b6)),MAX_CHUNK_SIZE=0xfa0,REVISION_COUNTER_FIELD_NAME=a300_0x36314e(0x195),IS_NAME_OBSOLETE='IsNameObsolete',MEMBER_ID_FIELD_NAME=a300_0x36314e(0x1bb),MEMBER_TYPE_FIELD_NAME=a300_0x36314e(0x1bf),CHANGED_BY_FIELD_NAME=a300_0x36314e(0x1c2),SOURCE_MEMBER_ID_FIELD_NAME=constants_2[a300_0x36314e(0x1c5)]+a300_0x36314e(0x1b7),ORGANIZATION_NAME_FIELD=constants_2[a300_0x36314e(0x1c5)]+a300_0x36314e(0x1ad),REVISION_COUNTER_CUSTOM_FIELD_NAME=constants_2['FLOSUM_NAMESPACE']+a300_0x36314e(0x19c),ORG_COMPONENT_SELECT_FIELDS=['Id',constants_2['FLOSUM_NAMESPACE']+a300_0x36314e(0x19c),constants_2[a300_0x36314e(0x1c5)]+a300_0x36314e(0x1b1),constants_2[a300_0x36314e(0x1c5)]+'API_Name__c',constants_2[a300_0x36314e(0x1c5)]+a300_0x36314e(0x1a7),constants_2[a300_0x36314e(0x1c5)]+a300_0x36314e(0x1b7),constants_2['FLOSUM_NAMESPACE']+a300_0x36314e(0x1ad),constants_2[a300_0x36314e(0x1c5)]+a300_0x36314e(0x1a4),constants_2[a300_0x36314e(0x1c5)]+a300_0x36314e(0x1c1)];class SourceMemberHandler extends stream_1[a300_0x36314e(0x1c4)]{constructor({apiVersion:_0x528d95,instance:_0x341b5c,targetOrgId:_0x4a0e27,logger:_0x3db873}){const _0x3744db=a300_0x36314e;super({'objectMode':!![]}),this['sourceMemberRecords']=new Map(),this['handledMembersCounter']=0x0,this[_0x3744db(0x1a8)]=_0x528d95,this[_0x3744db(0x1a5)]=_0x341b5c,this[_0x3744db(0x1bc)]=_0x4a0e27,this['logger']=_0x3db873;}[a300_0x36314e(0x19f)](){const _0x5cbdbe=a300_0x36314e;return new salesforce_1[(_0x5cbdbe(0x199))]()['select'](...ORG_COMPONENT_SELECT_FIELDS)[_0x5cbdbe(0x1aa)](constants_1[_0x5cbdbe(0x1a6)])['where'](SOURCE_MEMBER_ID_FIELD_NAME+_0x5cbdbe(0x1ac),{'sourceMemberIds':[...this[_0x5cbdbe(0x1a1)]['keys']()]})[_0x5cbdbe(0x1be)](ORGANIZATION_NAME_FIELD+_0x5cbdbe(0x19b),{'targetOrgId':this[_0x5cbdbe(0x1bc)]});}async['getComponentFromFlosum'](){const _0xdd9c3=a300_0x36314e,_0x2c7660=new salesforce_1['CompositeRetrieveData']({'api':this[_0xdd9c3(0x1a8)],'queryBuilder':this[_0xdd9c3(0x19f)](),'instance':this['instance'],'isTooling':![]}),_0x263242=new Map();do{const {records:_0x3f0fbd}=await _0x2c7660['execute']();for(const _0x453631 of _0x3f0fbd){_0x263242['set'](_0x453631[SOURCE_MEMBER_ID_FIELD_NAME],_0x453631);}}while(!_0x2c7660[_0xdd9c3(0x1b0)]());return _0x263242;}async[a300_0x36314e(0x193)](_0x546c4f){const _0x35e2a8=a300_0x36314e;this['sourceMemberRecords']['set'](_0x546c4f['Id'],_0x546c4f),this[_0x35e2a8(0x1a1)][_0x35e2a8(0x1b2)]===MAX_CHUNK_SIZE&&await this[_0x35e2a8(0x1ae)]();}async[a300_0x36314e(0x1ae)](){const _0x40fb7b=a300_0x36314e,_0x9a6248=await this[_0x40fb7b(0x1b5)]();for(const [_0x57b4ec,_0x1882c3]of this[_0x40fb7b(0x1a1)]){const _0x5daea7=_0x9a6248[_0x40fb7b(0x1b4)](_0x57b4ec);if(_0x5daea7&&_0x1882c3[REVISION_COUNTER_FIELD_NAME]===_0x5daea7[REVISION_COUNTER_CUSTOM_FIELD_NAME])continue;const _0x59daa3={'sourceMemberId':_0x1882c3['Id'],'componentId':(_0x5daea7===null||_0x5daea7===void 0x0?void 0x0:_0x5daea7['Id'])||null,'attachmentId':(_0x5daea7===null||_0x5daea7===void 0x0?void 0x0:_0x5daea7[_0x40fb7b(0x1a4)])||null,'metadataId':_0x1882c3[MEMBER_ID_FIELD_NAME],'metadataType':_0x1882c3[MEMBER_TYPE_FIELD_NAME],'isNameObsolete':_0x1882c3[IS_NAME_OBSOLETE],'revisionCounter':_0x1882c3[REVISION_COUNTER_FIELD_NAME],'changedBy':_0x1882c3[CHANGED_BY_FIELD_NAME]};this[_0x40fb7b(0x196)]++,this[_0x40fb7b(0x1bd)](_0x59daa3);}this[_0x40fb7b(0x1a1)]=new Map();}async[a300_0x36314e(0x1cd)](_0x4c60aa,_0x12d93d,_0x48788a){const _0x35f9d6=a300_0x36314e;try{await this[_0x35f9d6(0x193)](_0x4c60aa),_0x48788a();}catch(_0x4a3d58){_0x48788a(_0x4a3d58);}}async['_flush'](_0x4ca15b){const _0x28e52b=a300_0x36314e;try{this[_0x28e52b(0x1a1)][_0x28e52b(0x1b2)]&&await this[_0x28e52b(0x1ae)](),this[_0x28e52b(0x1c7)][_0x28e52b(0x1b8)]('Changes\x20found\x20for\x20'+this[_0x28e52b(0x196)]+_0x28e52b(0x1c3)),await this[_0x28e52b(0x1c7)][_0x28e52b(0x1b3)](),_0x4ca15b();}catch(_0x4108ff){_0x4ca15b(_0x4108ff);}}}exports[a300_0x36314e(0x1a3)]=SourceMemberHandler;