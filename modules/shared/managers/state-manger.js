const a326_0x1232fa=a326_0x41e6;(function(_0xef7098,_0x2e49b6){const _0x1359cc=a326_0x41e6,_0x55b3e2=_0xef7098();while(!![]){try{const _0x4040b2=parseInt(_0x1359cc(0x82))/0x1*(parseInt(_0x1359cc(0x6c))/0x2)+parseInt(_0x1359cc(0x7f))/0x3*(-parseInt(_0x1359cc(0x8a))/0x4)+-parseInt(_0x1359cc(0x69))/0x5*(parseInt(_0x1359cc(0x98))/0x6)+parseInt(_0x1359cc(0x87))/0x7*(parseInt(_0x1359cc(0x88))/0x8)+-parseInt(_0x1359cc(0x8d))/0x9+-parseInt(_0x1359cc(0x70))/0xa*(parseInt(_0x1359cc(0x78))/0xb)+parseInt(_0x1359cc(0x86))/0xc;if(_0x4040b2===_0x2e49b6)break;else _0x55b3e2['push'](_0x55b3e2['shift']());}catch(_0x4c26e2){_0x55b3e2['push'](_0x55b3e2['shift']());}}}(a326_0x424b,0x67bc3));const a326_0x5a1e47=(function(){let _0x213e6a=!![];return function(_0x3edfff,_0x44c53e){const _0x16a632=_0x213e6a?function(){const _0x572eaf=a326_0x41e6;if(_0x44c53e){const _0x2d2acb=_0x44c53e[_0x572eaf(0x96)](_0x3edfff,arguments);return _0x44c53e=null,_0x2d2acb;}}:function(){};return _0x213e6a=![],_0x16a632;};}()),a326_0x227279=a326_0x5a1e47(this,function(){const _0xa6afd0=a326_0x41e6;return a326_0x227279[_0xa6afd0(0x79)]()[_0xa6afd0(0x8b)]('(((.+)+)+)+$')['toString']()[_0xa6afd0(0x73)](a326_0x227279)[_0xa6afd0(0x8b)](_0xa6afd0(0x8f));});a326_0x227279();'use strict';function a326_0x41e6(_0x4b250b,_0x34533a){const _0x24e0fe=a326_0x424b();return a326_0x41e6=function(_0x227279,_0x5a1e47){_0x227279=_0x227279-0x69;let _0x424b81=_0x24e0fe[_0x227279];return _0x424b81;},a326_0x41e6(_0x4b250b,_0x34533a);}var __importDefault=this&&this['__importDefault']||function(_0x407e89){const _0x399a84=a326_0x41e6;return _0x407e89&&_0x407e89[_0x399a84(0x89)]?_0x407e89:{'default':_0x407e89};};Object[a326_0x1232fa(0x8e)](exports,a326_0x1232fa(0x89),{'value':!![]});function a326_0x424b(){const _0x2b28e5=['writeFile','getJobState','completedDate','FsUtils','update','3FcwYpS','JOB_LOG_STATE_FILENAME','isExistsPath','36903nyXyJS','create','jobState','readFile','20151708rSRmjB','7mNXzSu','1980840SGvjWC','__esModule','2942668TAcaGw','search','@flosum/utils','3027141iMpehr','defineProperty','(((.+)+)+)+$','stringify','then','getTime','JobStatus','FAILED','init','apply','getJobStatePath','42qjjuuI','statePath','322655mPAfMG','default','status','14uXCUfq','error','Job\x20not\x20found.','push','10mOeBRI','../../../constants/job','createdDate','constructor','utf-8','parse','join','COMPLETED','2602633SuhrIi','toString'];a326_0x424b=function(){return _0x2b28e5;};return a326_0x424b();}const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require('path')),promises_1=require('fs/promises'),utils_1=require(a326_0x1232fa(0x8c)),job_1=require(a326_0x1232fa(0x71));class StateManager{constructor(_0x35dc4f){const _0x62bdb9=a326_0x1232fa;this[_0x62bdb9(0x99)]=StateManager[_0x62bdb9(0x97)](_0x35dc4f);}static[a326_0x1232fa(0x97)](_0x1b62a1){const _0x44a65d=a326_0x1232fa;return path_1[_0x44a65d(0x6a)][_0x44a65d(0x76)](_0x1b62a1,job_1[_0x44a65d(0x80)]);}static async[a326_0x1232fa(0x83)](_0x59db7b,_0x3ad78c){const _0x12ad76=a326_0x1232fa,_0xea7c94=StateManager[_0x12ad76(0x97)](_0x59db7b),_0x32cbe5={'id':_0x3ad78c,'status':logger_enums_1[_0x12ad76(0x93)]['QUEUED'],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x12ad76(0x7a)])(_0xea7c94,JSON[_0x12ad76(0x90)](_0x32cbe5));}static async[a326_0x1232fa(0x7b)](_0x42a8f1){const _0x154fe5=a326_0x1232fa,_0x16bcff=StateManager[_0x154fe5(0x97)](_0x42a8f1);if(await utils_1[_0x154fe5(0x7d)][_0x154fe5(0x81)](_0x16bcff))return(0x0,promises_1[_0x154fe5(0x85)])(_0x16bcff,_0x154fe5(0x74))['then'](JSON[_0x154fe5(0x75)]);throw new Error(_0x154fe5(0x6e));}async[a326_0x1232fa(0x7e)](){const _0x5d3681=a326_0x1232fa;await(0x0,promises_1[_0x5d3681(0x7a)])(this[_0x5d3681(0x99)],JSON[_0x5d3681(0x90)](this['jobState']));}async[a326_0x1232fa(0x95)](){const _0x164222=a326_0x1232fa;return this[_0x164222(0x84)]=await(0x0,promises_1[_0x164222(0x85)])(this[_0x164222(0x99)],_0x164222(0x74))[_0x164222(0x91)](JSON[_0x164222(0x75)]),this;}async['setInProgress'](){const _0x5b2def=a326_0x1232fa;this[_0x5b2def(0x84)][_0x5b2def(0x6b)]=logger_enums_1[_0x5b2def(0x93)]['IN_PROGRESS'],this[_0x5b2def(0x84)][_0x5b2def(0x72)]=new Date()['getTime'](),await this[_0x5b2def(0x7e)]();}async['setCompleted'](){const _0x3818f3=a326_0x1232fa;this[_0x3818f3(0x84)][_0x3818f3(0x6b)]=logger_enums_1['JobStatus'][_0x3818f3(0x77)],this['jobState']['completedDate']=new Date()[_0x3818f3(0x92)](),await this['update']();}async['setError']({message:_0x5d2950}){const _0x286385=a326_0x1232fa;this['jobState']['status']=logger_enums_1[_0x286385(0x93)][_0x286385(0x94)],this['jobState'][_0x286385(0x7c)]=new Date()['getTime'](),this[_0x286385(0x84)][_0x286385(0x6d)]=_0x5d2950,await this[_0x286385(0x7e)]();}['addWarning'](_0x19ba94){const _0x1b93d9=a326_0x1232fa;return this[_0x1b93d9(0x84)]['warnings'][_0x1b93d9(0x6f)](_0x19ba94),this[_0x1b93d9(0x7e)]();}}exports['default']=StateManager;