const a315_0x58696e=a315_0x1d83;(function(_0x14b5e8,_0x498962){const _0x1afe2f=a315_0x1d83,_0x4cffb6=_0x14b5e8();while(!![]){try{const _0x3703b1=parseInt(_0x1afe2f(0x106))/0x1+parseInt(_0x1afe2f(0xe9))/0x2+parseInt(_0x1afe2f(0xe6))/0x3+parseInt(_0x1afe2f(0x100))/0x4+parseInt(_0x1afe2f(0xf0))/0x5+parseInt(_0x1afe2f(0xe4))/0x6+-parseInt(_0x1afe2f(0xef))/0x7;if(_0x3703b1===_0x498962)break;else _0x4cffb6['push'](_0x4cffb6['shift']());}catch(_0x2e640a){_0x4cffb6['push'](_0x4cffb6['shift']());}}}(a315_0x334c,0xab44a));const a315_0x3208c8=(function(){let _0x538c62=!![];return function(_0x51daac,_0x809d7a){const _0x3f25f3=_0x538c62?function(){const _0x58eab3=a315_0x1d83;if(_0x809d7a){const _0x52322f=_0x809d7a[_0x58eab3(0xe0)](_0x51daac,arguments);return _0x809d7a=null,_0x52322f;}}:function(){};return _0x538c62=![],_0x3f25f3;};}()),a315_0xe77a7a=a315_0x3208c8(this,function(){const _0xfb19a9=a315_0x1d83;return a315_0xe77a7a[_0xfb19a9(0xe8)]()[_0xfb19a9(0xee)](_0xfb19a9(0xfc))['toString']()[_0xfb19a9(0x102)](a315_0xe77a7a)[_0xfb19a9(0xee)](_0xfb19a9(0xfc));});a315_0xe77a7a();function a315_0x1d83(_0x4b155c,_0x18e086){const _0x3872b1=a315_0x334c();return a315_0x1d83=function(_0xe77a7a,_0x3208c8){_0xe77a7a=_0xe77a7a-0xe0;let _0x334ccf=_0x3872b1[_0xe77a7a];return _0x334ccf;},a315_0x1d83(_0x4b155c,_0x18e086);}function a315_0x334c(){const _0xe08417=['init','constructor','stringify','fs/promises','FsUtils','239058gFcyCR','jobState','push','../enums/logger.enums','apply','QUEUED','create','completedDate','5050878yueQFR','status','4118184XJcyJt','utf-8','toString','86572VfMaMM','error','Job\x20not\x20found.','COMPLETED','statePath','search','28755258lQxIYe','5031775zwRyPe','getJobStatePath','IN_PROGRESS','__esModule','parse','update','getTime','default','writeFile','JOB_LOG_STATE_FILENAME','@flosum/utils','JobStatus','(((.+)+)+)+$','__importDefault','readFile','then','5224672dFuOqv'];a315_0x334c=function(){return _0xe08417;};return a315_0x334c();}'use strict';var __importDefault=this&&this[a315_0x58696e(0xfd)]||function(_0x4671b2){return _0x4671b2&&_0x4671b2['__esModule']?_0x4671b2:{'default':_0x4671b2};};Object['defineProperty'](exports,a315_0x58696e(0xf3),{'value':!![]});const logger_enums_1=require(a315_0x58696e(0x109)),path_1=__importDefault(require('path')),promises_1=require(a315_0x58696e(0x104)),utils_1=require(a315_0x58696e(0xfa)),job_1=require('../../../constants/job');class StateManager{constructor(_0x3044cf){const _0x2c8758=a315_0x58696e;this[_0x2c8758(0xed)]=StateManager[_0x2c8758(0xf1)](_0x3044cf);}static[a315_0x58696e(0xf1)](_0x28e61f){const _0x1338e1=a315_0x58696e;return path_1[_0x1338e1(0xf7)]['join'](_0x28e61f,job_1[_0x1338e1(0xf9)]);}static async[a315_0x58696e(0xe2)](_0x47ef74,_0xc26c9b){const _0x14e7e4=a315_0x58696e,_0x580b81=StateManager[_0x14e7e4(0xf1)](_0x47ef74),_0x1a91ee={'id':_0xc26c9b,'status':logger_enums_1[_0x14e7e4(0xfb)][_0x14e7e4(0xe1)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x14e7e4(0xf8)])(_0x580b81,JSON[_0x14e7e4(0x103)](_0x1a91ee));}static async['getJobState'](_0x2a08b7){const _0x5ed0c9=a315_0x58696e,_0x58bd8f=StateManager['getJobStatePath'](_0x2a08b7);if(await utils_1[_0x5ed0c9(0x105)]['isExistsPath'](_0x58bd8f))return(0x0,promises_1[_0x5ed0c9(0xfe)])(_0x58bd8f,_0x5ed0c9(0xe7))[_0x5ed0c9(0xff)](JSON[_0x5ed0c9(0xf4)]);throw new Error(_0x5ed0c9(0xeb));}async[a315_0x58696e(0xf5)](){const _0x52b844=a315_0x58696e;await(0x0,promises_1[_0x52b844(0xf8)])(this[_0x52b844(0xed)],JSON[_0x52b844(0x103)](this[_0x52b844(0x107)]));}async[a315_0x58696e(0x101)](){const _0x1ffe04=a315_0x58696e;return this['jobState']=await(0x0,promises_1['readFile'])(this[_0x1ffe04(0xed)],_0x1ffe04(0xe7))['then'](JSON[_0x1ffe04(0xf4)]),this;}async['setInProgress'](){const _0x5818c3=a315_0x58696e;this[_0x5818c3(0x107)][_0x5818c3(0xe5)]=logger_enums_1['JobStatus'][_0x5818c3(0xf2)],this[_0x5818c3(0x107)]['createdDate']=new Date()[_0x5818c3(0xf6)](),await this[_0x5818c3(0xf5)]();}async['setCompleted'](){const _0x20c3cc=a315_0x58696e;this[_0x20c3cc(0x107)][_0x20c3cc(0xe5)]=logger_enums_1['JobStatus'][_0x20c3cc(0xec)],this['jobState'][_0x20c3cc(0xe3)]=new Date()[_0x20c3cc(0xf6)](),await this[_0x20c3cc(0xf5)]();}async['setError']({message:_0x319bd8}){const _0x19d208=a315_0x58696e;this[_0x19d208(0x107)][_0x19d208(0xe5)]=logger_enums_1[_0x19d208(0xfb)]['FAILED'],this[_0x19d208(0x107)][_0x19d208(0xe3)]=new Date()[_0x19d208(0xf6)](),this['jobState'][_0x19d208(0xea)]=_0x319bd8,await this['update']();}['addWarning'](_0x45877a){const _0xf5d8ad=a315_0x58696e;return this[_0xf5d8ad(0x107)]['warnings'][_0xf5d8ad(0x108)](_0x45877a),this['update']();}}exports[a315_0x58696e(0xf7)]=StateManager;