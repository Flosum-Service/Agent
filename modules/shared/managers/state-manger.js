const a327_0x2f3350=a327_0x2727;(function(_0x5b971b,_0x51f480){const _0x59c357=a327_0x2727,_0x2b24bb=_0x5b971b();while(!![]){try{const _0x508644=parseInt(_0x59c357(0x138))/0x1*(parseInt(_0x59c357(0x129))/0x2)+-parseInt(_0x59c357(0x120))/0x3+parseInt(_0x59c357(0x123))/0x4+parseInt(_0x59c357(0x127))/0x5+-parseInt(_0x59c357(0x12f))/0x6+parseInt(_0x59c357(0x121))/0x7*(parseInt(_0x59c357(0x140))/0x8)+parseInt(_0x59c357(0x10f))/0x9*(-parseInt(_0x59c357(0x137))/0xa);if(_0x508644===_0x51f480)break;else _0x2b24bb['push'](_0x2b24bb['shift']());}catch(_0x2b126c){_0x2b24bb['push'](_0x2b24bb['shift']());}}}(a327_0xdad9,0x3982e));const a327_0x2c15b4=(function(){let _0x34c0f5=!![];return function(_0x49f6f1,_0x27943d){const _0x3c1436=_0x34c0f5?function(){if(_0x27943d){const _0x40a54b=_0x27943d['apply'](_0x49f6f1,arguments);return _0x27943d=null,_0x40a54b;}}:function(){};return _0x34c0f5=![],_0x3c1436;};}()),a327_0x705495=a327_0x2c15b4(this,function(){const _0x3063f9=a327_0x2727;return a327_0x705495['toString']()['search']('(((.+)+)+)+$')[_0x3063f9(0x111)]()[_0x3063f9(0x11f)](a327_0x705495)[_0x3063f9(0x118)](_0x3063f9(0x12e));});a327_0x705495();function a327_0x2727(_0x5bfae1,_0x59829a){const _0x3a0d47=a327_0xdad9();return a327_0x2727=function(_0x705495,_0x2c15b4){_0x705495=_0x705495-0x10f;let _0xdad9fd=_0x3a0d47[_0x705495];return _0xdad9fd;},a327_0x2727(_0x5bfae1,_0x59829a);}'use strict';var __importDefault=this&&this[a327_0x2f3350(0x136)]||function(_0x581709){return _0x581709&&_0x581709['__esModule']?_0x581709:{'default':_0x581709};};Object['defineProperty'](exports,a327_0x2f3350(0x13d),{'value':!![]});function a327_0xdad9(){const _0x1f599d=['writeFile','COMPLETED','update','getJobStatePath','default','constructor','168171PehBwU','16716FMvvod','readFile','695848DZRfGc','jobState','setInProgress','push','2221675YbglBB','completedDate','107482TBBnXg','init','setCompleted','status','createdDate','(((.+)+)+)+$','465258qrTFnw','../enums/logger.enums','statePath','create','IN_PROGRESS','error','setError','__importDefault','10TTFSGY','2UvKRyH','warnings','utf-8','Job\x20not\x20found.','JobStatus','__esModule','isExistsPath','getJobState','1448CbCkrJ','7099569KqEwAl','getTime','toString','addWarning','join','then','@flosum/utils','stringify','path','search','QUEUED'];a327_0xdad9=function(){return _0x1f599d;};return a327_0xdad9();}const logger_enums_1=require(a327_0x2f3350(0x130)),path_1=__importDefault(require(a327_0x2f3350(0x117))),promises_1=require('fs/promises'),utils_1=require(a327_0x2f3350(0x115)),job_1=require('../../../constants/job');class StateManager{constructor(_0x51ea83){const _0x10c2c6=a327_0x2f3350;this[_0x10c2c6(0x131)]=StateManager['getJobStatePath'](_0x51ea83);}static['getJobStatePath'](_0x3cc9de){const _0x521fc8=a327_0x2f3350;return path_1[_0x521fc8(0x11e)][_0x521fc8(0x113)](_0x3cc9de,job_1['JOB_LOG_STATE_FILENAME']);}static async[a327_0x2f3350(0x132)](_0x542633,_0x2a87c3){const _0x3dcf95=a327_0x2f3350,_0x4fe1af=StateManager[_0x3dcf95(0x11d)](_0x542633),_0x3d1035={'id':_0x2a87c3,'status':logger_enums_1[_0x3dcf95(0x13c)][_0x3dcf95(0x119)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1['writeFile'])(_0x4fe1af,JSON[_0x3dcf95(0x116)](_0x3d1035));}static async[a327_0x2f3350(0x13f)](_0x40cfc7){const _0x36bd4a=a327_0x2f3350,_0x499d91=StateManager[_0x36bd4a(0x11d)](_0x40cfc7);if(await utils_1['FsUtils'][_0x36bd4a(0x13e)](_0x499d91))return(0x0,promises_1[_0x36bd4a(0x122)])(_0x499d91,_0x36bd4a(0x13a))[_0x36bd4a(0x114)](JSON['parse']);throw new Error(_0x36bd4a(0x13b));}async[a327_0x2f3350(0x11c)](){const _0x261b73=a327_0x2f3350;await(0x0,promises_1[_0x261b73(0x11a)])(this[_0x261b73(0x131)],JSON[_0x261b73(0x116)](this['jobState']));}async[a327_0x2f3350(0x12a)](){const _0x2f4f9b=a327_0x2f3350;return this[_0x2f4f9b(0x124)]=await(0x0,promises_1[_0x2f4f9b(0x122)])(this[_0x2f4f9b(0x131)],_0x2f4f9b(0x13a))[_0x2f4f9b(0x114)](JSON['parse']),this;}async[a327_0x2f3350(0x125)](){const _0x13507d=a327_0x2f3350;this[_0x13507d(0x124)][_0x13507d(0x12c)]=logger_enums_1['JobStatus'][_0x13507d(0x133)],this['jobState'][_0x13507d(0x12d)]=new Date()[_0x13507d(0x110)](),await this[_0x13507d(0x11c)]();}async[a327_0x2f3350(0x12b)](){const _0xc0f686=a327_0x2f3350;this[_0xc0f686(0x124)]['status']=logger_enums_1[_0xc0f686(0x13c)][_0xc0f686(0x11b)],this[_0xc0f686(0x124)][_0xc0f686(0x128)]=new Date()['getTime'](),await this[_0xc0f686(0x11c)]();}async[a327_0x2f3350(0x135)]({message:_0x1b0c2b}){const _0x527f24=a327_0x2f3350;this[_0x527f24(0x124)][_0x527f24(0x12c)]=logger_enums_1['JobStatus']['FAILED'],this['jobState'][_0x527f24(0x128)]=new Date()[_0x527f24(0x110)](),this[_0x527f24(0x124)][_0x527f24(0x134)]=_0x1b0c2b,await this['update']();}[a327_0x2f3350(0x112)](_0x1a898d){const _0x248842=a327_0x2f3350;return this['jobState'][_0x248842(0x139)][_0x248842(0x126)](_0x1a898d),this['update']();}}exports['default']=StateManager;