const a283_0x519692=a283_0x5913;(function(_0x180958,_0x47c116){const _0x376f92=a283_0x5913,_0x420bc3=_0x180958();while(!![]){try{const _0x46634f=-parseInt(_0x376f92(0x16d))/0x1+parseInt(_0x376f92(0x170))/0x2+-parseInt(_0x376f92(0x144))/0x3+parseInt(_0x376f92(0x15c))/0x4+parseInt(_0x376f92(0x16e))/0x5*(parseInt(_0x376f92(0x16b))/0x6)+-parseInt(_0x376f92(0x164))/0x7*(-parseInt(_0x376f92(0x154))/0x8)+parseInt(_0x376f92(0x15b))/0x9;if(_0x46634f===_0x47c116)break;else _0x420bc3['push'](_0x420bc3['shift']());}catch(_0x76bfd6){_0x420bc3['push'](_0x420bc3['shift']());}}}(a283_0x4646,0xe0917));const a283_0x3a78a0=(function(){let _0x59491a=!![];return function(_0x10068e,_0x560ae6){const _0x242fb1=_0x59491a?function(){if(_0x560ae6){const _0x417495=_0x560ae6['apply'](_0x10068e,arguments);return _0x560ae6=null,_0x417495;}}:function(){};return _0x59491a=![],_0x242fb1;};}()),a283_0x2ec711=a283_0x3a78a0(this,function(){const _0x58f68d=a283_0x5913;return a283_0x2ec711[_0x58f68d(0x14e)]()['search'](_0x58f68d(0x152))[_0x58f68d(0x14e)]()[_0x58f68d(0x15f)](a283_0x2ec711)['search'](_0x58f68d(0x152));});a283_0x2ec711();'use strict';var __importDefault=this&&this[a283_0x519692(0x16a)]||function(_0x278c35){const _0x2aedff=a283_0x519692;return _0x278c35&&_0x278c35[_0x2aedff(0x155)]?_0x278c35:{'default':_0x278c35};};Object[a283_0x519692(0x14f)](exports,'__esModule',{'value':!![]});function a283_0x4646(){const _0x5e7554=['update','utf-8','__importDefault','398982jhIcuJ','COMPLETED','1513810uTyPdR','25foSxzi','Job\x20not\x20found.','179946NjKroD','warnings','getJobStatePath','create','createdDate','setError','writeFile','5010471hSNqzy','error','push','getTime','FAILED','QUEUED','@flosum/utils','jobState','setCompleted','setInProgress','toString','defineProperty','addWarning','init','(((.+)+)+)+$','completedDate','160SGgcPZ','__esModule','then','getJobState','readFile','isExistsPath','stringify','11533356Yprlna','2608864xiSSvr','JobStatus','join','constructor','path','IN_PROGRESS','../../../constants/job','statePath','611674LrICyn','status','parse','fs/promises'];a283_0x4646=function(){return _0x5e7554;};return a283_0x4646();}const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a283_0x519692(0x160))),promises_1=require(a283_0x519692(0x167)),utils_1=require(a283_0x519692(0x14a)),job_1=require(a283_0x519692(0x162));function a283_0x5913(_0x28055a,_0x149c2f){const _0x51cb95=a283_0x4646();return a283_0x5913=function(_0x2ec711,_0x3a78a0){_0x2ec711=_0x2ec711-0x140;let _0x4646d7=_0x51cb95[_0x2ec711];return _0x4646d7;},a283_0x5913(_0x28055a,_0x149c2f);}class StateManager{constructor(_0x12da28){const _0x4c4fb2=a283_0x519692;this[_0x4c4fb2(0x163)]=StateManager[_0x4c4fb2(0x172)](_0x12da28);}static['getJobStatePath'](_0x281445){const _0x27815f=a283_0x519692;return path_1['default'][_0x27815f(0x15e)](_0x281445,job_1['JOB_LOG_STATE_FILENAME']);}static async[a283_0x519692(0x140)](_0x33bcf1,_0x4e6fdf){const _0xbb7067=a283_0x519692,_0x2c8694=StateManager[_0xbb7067(0x172)](_0x33bcf1),_0x3dd67e={'id':_0x4e6fdf,'status':logger_enums_1[_0xbb7067(0x15d)][_0xbb7067(0x149)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0xbb7067(0x143)])(_0x2c8694,JSON['stringify'](_0x3dd67e));}static async[a283_0x519692(0x157)](_0x12b05b){const _0x26fd1f=a283_0x519692,_0x56eedf=StateManager[_0x26fd1f(0x172)](_0x12b05b);if(await utils_1['FsUtils'][_0x26fd1f(0x159)](_0x56eedf))return(0x0,promises_1[_0x26fd1f(0x158)])(_0x56eedf,_0x26fd1f(0x169))['then'](JSON[_0x26fd1f(0x166)]);throw new Error(_0x26fd1f(0x16f));}async[a283_0x519692(0x168)](){const _0x500f83=a283_0x519692;await(0x0,promises_1[_0x500f83(0x143)])(this[_0x500f83(0x163)],JSON[_0x500f83(0x15a)](this[_0x500f83(0x14b)]));}async[a283_0x519692(0x151)](){const _0x199850=a283_0x519692;return this['jobState']=await(0x0,promises_1[_0x199850(0x158)])(this[_0x199850(0x163)],_0x199850(0x169))[_0x199850(0x156)](JSON['parse']),this;}async[a283_0x519692(0x14d)](){const _0x1bf511=a283_0x519692;this[_0x1bf511(0x14b)][_0x1bf511(0x165)]=logger_enums_1[_0x1bf511(0x15d)][_0x1bf511(0x161)],this['jobState'][_0x1bf511(0x141)]=new Date()[_0x1bf511(0x147)](),await this[_0x1bf511(0x168)]();}async[a283_0x519692(0x14c)](){const _0x60e605=a283_0x519692;this[_0x60e605(0x14b)][_0x60e605(0x165)]=logger_enums_1[_0x60e605(0x15d)][_0x60e605(0x16c)],this[_0x60e605(0x14b)][_0x60e605(0x153)]=new Date()[_0x60e605(0x147)](),await this[_0x60e605(0x168)]();}async[a283_0x519692(0x142)]({message:_0x509dea}){const _0x116ccd=a283_0x519692;this[_0x116ccd(0x14b)][_0x116ccd(0x165)]=logger_enums_1[_0x116ccd(0x15d)][_0x116ccd(0x148)],this['jobState'][_0x116ccd(0x153)]=new Date()[_0x116ccd(0x147)](),this['jobState'][_0x116ccd(0x145)]=_0x509dea,await this['update']();}[a283_0x519692(0x150)](_0x54086f){const _0x5224b5=a283_0x519692;return this['jobState'][_0x5224b5(0x171)][_0x5224b5(0x146)](_0x54086f),this['update']();}}exports['default']=StateManager;