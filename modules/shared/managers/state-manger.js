function a326_0x5377(){const _0x35d8e1=['utf-8','createdDate','writeFile','fs/promises','50290kuPNWg','261592TZoTQS','8766XvTnVh','push','(((.+)+)+)+$','then','getTime','IN_PROGRESS','warnings','@flosum/utils','JOB_LOG_STATE_FILENAME','update','setCompleted','setError','11UpcFwZ','readFile','21gUflQu','setInProgress','getJobStatePath','7257228ORWdMq','1990AfHRMW','35MJqzcj','statePath','completedDate','jobState','stringify','search','COMPLETED','status','FsUtils','apply','toString','310128vWXfjH','30pYpJVZ','error','JobStatus','99559AkEdXq','29038szCXGo','../../../constants/job','path','QUEUED','addWarning','parse','__esModule'];a326_0x5377=function(){return _0x35d8e1;};return a326_0x5377();}const a326_0x4020d2=a326_0x3c2b;(function(_0x41367b,_0x4af936){const _0x30c21a=a326_0x3c2b,_0x530b71=_0x41367b();while(!![]){try{const _0x3ba84d=-parseInt(_0x30c21a(0xac))/0x1+-parseInt(_0x30c21a(0xad))/0x2*(-parseInt(_0x30c21a(0xc8))/0x3)+-parseInt(_0x30c21a(0xb9))/0x4+parseInt(_0x30c21a(0xb8))/0x5*(-parseInt(_0x30c21a(0xa9))/0x6)+-parseInt(_0x30c21a(0x9d))/0x7*(parseInt(_0x30c21a(0xa8))/0x8)+parseInt(_0x30c21a(0xba))/0x9*(-parseInt(_0x30c21a(0x9c))/0xa)+-parseInt(_0x30c21a(0xc6))/0xb*(-parseInt(_0x30c21a(0x9b))/0xc);if(_0x3ba84d===_0x4af936)break;else _0x530b71['push'](_0x530b71['shift']());}catch(_0xd7b74c){_0x530b71['push'](_0x530b71['shift']());}}}(a326_0x5377,0x1944b));function a326_0x3c2b(_0x2ba540,_0x42d10c){const _0x201fa5=a326_0x5377();return a326_0x3c2b=function(_0x4bb3ac,_0x842c9b){_0x4bb3ac=_0x4bb3ac-0x9b;let _0x53771b=_0x201fa5[_0x4bb3ac];return _0x53771b;},a326_0x3c2b(_0x2ba540,_0x42d10c);}const a326_0x842c9b=(function(){let _0x116244=!![];return function(_0x489651,_0x4a6d16){const _0xa2b905=_0x116244?function(){const _0x4c96d7=a326_0x3c2b;if(_0x4a6d16){const _0x3fd025=_0x4a6d16[_0x4c96d7(0xa6)](_0x489651,arguments);return _0x4a6d16=null,_0x3fd025;}}:function(){};return _0x116244=![],_0xa2b905;};}()),a326_0x4bb3ac=a326_0x842c9b(this,function(){const _0x39febf=a326_0x3c2b;return a326_0x4bb3ac['toString']()[_0x39febf(0xa2)](_0x39febf(0xbc))[_0x39febf(0xa7)]()['constructor'](a326_0x4bb3ac)[_0x39febf(0xa2)](_0x39febf(0xbc));});a326_0x4bb3ac();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2f0b7d){const _0x2e0c6f=a326_0x3c2b;return _0x2f0b7d&&_0x2f0b7d[_0x2e0c6f(0xb3)]?_0x2f0b7d:{'default':_0x2f0b7d};};Object['defineProperty'](exports,a326_0x4020d2(0xb3),{'value':!![]});const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a326_0x4020d2(0xaf))),promises_1=require(a326_0x4020d2(0xb7)),utils_1=require(a326_0x4020d2(0xc1)),job_1=require(a326_0x4020d2(0xae));class StateManager{constructor(_0x410040){const _0x3de614=a326_0x4020d2;this[_0x3de614(0x9e)]=StateManager[_0x3de614(0xca)](_0x410040);}static[a326_0x4020d2(0xca)](_0x19da8b){const _0x51bfec=a326_0x4020d2;return path_1['default']['join'](_0x19da8b,job_1[_0x51bfec(0xc2)]);}static async['create'](_0x4c40c7,_0x5bacd7){const _0x249c11=a326_0x4020d2,_0x37cb0b=StateManager[_0x249c11(0xca)](_0x4c40c7),_0x32442b={'id':_0x5bacd7,'status':logger_enums_1[_0x249c11(0xab)][_0x249c11(0xb0)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x249c11(0xb6)])(_0x37cb0b,JSON[_0x249c11(0xa1)](_0x32442b));}static async['getJobState'](_0x2022a7){const _0x4c0024=a326_0x4020d2,_0x30411f=StateManager[_0x4c0024(0xca)](_0x2022a7);if(await utils_1[_0x4c0024(0xa5)]['isExistsPath'](_0x30411f))return(0x0,promises_1['readFile'])(_0x30411f,'utf-8')[_0x4c0024(0xbd)](JSON[_0x4c0024(0xb2)]);throw new Error('Job\x20not\x20found.');}async[a326_0x4020d2(0xc3)](){const _0x2df9f6=a326_0x4020d2;await(0x0,promises_1[_0x2df9f6(0xb6)])(this['statePath'],JSON[_0x2df9f6(0xa1)](this['jobState']));}async['init'](){const _0x90ff8=a326_0x4020d2;return this[_0x90ff8(0xa0)]=await(0x0,promises_1[_0x90ff8(0xc7)])(this[_0x90ff8(0x9e)],_0x90ff8(0xb4))[_0x90ff8(0xbd)](JSON[_0x90ff8(0xb2)]),this;}async[a326_0x4020d2(0xc9)](){const _0x1d4d76=a326_0x4020d2;this[_0x1d4d76(0xa0)][_0x1d4d76(0xa4)]=logger_enums_1['JobStatus'][_0x1d4d76(0xbf)],this[_0x1d4d76(0xa0)][_0x1d4d76(0xb5)]=new Date()[_0x1d4d76(0xbe)](),await this[_0x1d4d76(0xc3)]();}async[a326_0x4020d2(0xc4)](){const _0x376bc3=a326_0x4020d2;this[_0x376bc3(0xa0)][_0x376bc3(0xa4)]=logger_enums_1[_0x376bc3(0xab)][_0x376bc3(0xa3)],this[_0x376bc3(0xa0)][_0x376bc3(0x9f)]=new Date()[_0x376bc3(0xbe)](),await this[_0x376bc3(0xc3)]();}async[a326_0x4020d2(0xc5)]({message:_0x47393b}){const _0x31c029=a326_0x4020d2;this[_0x31c029(0xa0)][_0x31c029(0xa4)]=logger_enums_1['JobStatus']['FAILED'],this[_0x31c029(0xa0)]['completedDate']=new Date()[_0x31c029(0xbe)](),this[_0x31c029(0xa0)][_0x31c029(0xaa)]=_0x47393b,await this['update']();}[a326_0x4020d2(0xb1)](_0x9d0a9b){const _0x19b3d5=a326_0x4020d2;return this[_0x19b3d5(0xa0)][_0x19b3d5(0xc0)][_0x19b3d5(0xbb)](_0x9d0a9b),this['update']();}}exports['default']=StateManager;