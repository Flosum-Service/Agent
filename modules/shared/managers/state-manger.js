const a299_0x50e18a=a299_0x5999;(function(_0x2e2464,_0x253905){const _0x193b47=a299_0x5999,_0x2a5606=_0x2e2464();while(!![]){try{const _0x15de54=parseInt(_0x193b47(0x17e))/0x1*(-parseInt(_0x193b47(0x159))/0x2)+parseInt(_0x193b47(0x171))/0x3*(parseInt(_0x193b47(0x16f))/0x4)+-parseInt(_0x193b47(0x170))/0x5+-parseInt(_0x193b47(0x156))/0x6*(-parseInt(_0x193b47(0x176))/0x7)+parseInt(_0x193b47(0x160))/0x8*(-parseInt(_0x193b47(0x17c))/0x9)+parseInt(_0x193b47(0x166))/0xa*(-parseInt(_0x193b47(0x15a))/0xb)+-parseInt(_0x193b47(0x155))/0xc*(-parseInt(_0x193b47(0x153))/0xd);if(_0x15de54===_0x253905)break;else _0x2a5606['push'](_0x2a5606['shift']());}catch(_0x48b143){_0x2a5606['push'](_0x2a5606['shift']());}}}(a299_0x533b,0x3beef));const a299_0x201ff4=(function(){let _0x4a6d42=!![];return function(_0x3f8c0f,_0x208e0e){const _0x26aa26=_0x4a6d42?function(){const _0xbf0613=a299_0x5999;if(_0x208e0e){const _0x5c22fc=_0x208e0e[_0xbf0613(0x17d)](_0x3f8c0f,arguments);return _0x208e0e=null,_0x5c22fc;}}:function(){};return _0x4a6d42=![],_0x26aa26;};}()),a299_0x171275=a299_0x201ff4(this,function(){const _0x5c590a=a299_0x5999;return a299_0x171275[_0x5c590a(0x165)]()[_0x5c590a(0x15e)]('(((.+)+)+)+$')['toString']()['constructor'](a299_0x171275)[_0x5c590a(0x15e)](_0x5c590a(0x16e));});a299_0x171275();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2bc5b9){const _0x3bf8c2=a299_0x5999;return _0x2bc5b9&&_0x2bc5b9[_0x3bf8c2(0x169)]?_0x2bc5b9:{'default':_0x2bc5b9};};Object[a299_0x50e18a(0x174)](exports,a299_0x50e18a(0x169),{'value':!![]});const logger_enums_1=require(a299_0x50e18a(0x167)),path_1=__importDefault(require(a299_0x50e18a(0x163))),promises_1=require(a299_0x50e18a(0x16d)),utils_1=require(a299_0x50e18a(0x168)),job_1=require('../../../constants/job');function a299_0x5999(_0x2c4255,_0x419fa4){const _0x4cf61a=a299_0x533b();return a299_0x5999=function(_0x171275,_0x201ff4){_0x171275=_0x171275-0x150;let _0x533b51=_0x4cf61a[_0x171275];return _0x533b51;},a299_0x5999(_0x2c4255,_0x419fa4);}function a299_0x533b(){const _0x15bf7f=['202668equtRK','readFile','getTime','6whjnAT','1048366ASYDla','FAILED','jobState','update','search','JobStatus','16FhWZxT','push','statePath','path','getJobState','toString','10OdBVHe','../enums/logger.enums','@flosum/utils','__esModule','setCompleted','utf-8','IN_PROGRESS','fs/promises','(((.+)+)+)+$','109772UmqvRI','2035070raoBvs','33quajMT','default','setInProgress','defineProperty','error','7zVZiPH','join','FsUtils','warnings','getJobStatePath','stringify','300123JfSArT','apply','145946TbPgbr','setError','addWarning','createdDate','writeFile','status','create','63388MKXrVl','parse','2256wkttZM'];a299_0x533b=function(){return _0x15bf7f;};return a299_0x533b();}class StateManager{constructor(_0x1af4ad){const _0x214880=a299_0x50e18a;this[_0x214880(0x162)]=StateManager[_0x214880(0x17a)](_0x1af4ad);}static['getJobStatePath'](_0x28ef2a){const _0x366df0=a299_0x50e18a;return path_1[_0x366df0(0x172)][_0x366df0(0x177)](_0x28ef2a,job_1['JOB_LOG_STATE_FILENAME']);}static async[a299_0x50e18a(0x152)](_0x59b4be,_0x42d29a){const _0x3a805b=a299_0x50e18a,_0x56fe99=StateManager[_0x3a805b(0x17a)](_0x59b4be),_0x4fab14={'id':_0x42d29a,'status':logger_enums_1[_0x3a805b(0x15f)]['QUEUED'],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x3a805b(0x150)])(_0x56fe99,JSON[_0x3a805b(0x17b)](_0x4fab14));}static async[a299_0x50e18a(0x164)](_0x3eac40){const _0x3b2243=a299_0x50e18a,_0x3e39a8=StateManager[_0x3b2243(0x17a)](_0x3eac40);if(await utils_1[_0x3b2243(0x178)]['isExistsPath'](_0x3e39a8))return(0x0,promises_1[_0x3b2243(0x157)])(_0x3e39a8,'utf-8')['then'](JSON[_0x3b2243(0x154)]);throw new Error('Job\x20not\x20found.');}async[a299_0x50e18a(0x15d)](){const _0x1ceabd=a299_0x50e18a;await(0x0,promises_1['writeFile'])(this['statePath'],JSON[_0x1ceabd(0x17b)](this[_0x1ceabd(0x15c)]));}async['init'](){const _0x81207d=a299_0x50e18a;return this['jobState']=await(0x0,promises_1[_0x81207d(0x157)])(this['statePath'],_0x81207d(0x16b))['then'](JSON[_0x81207d(0x154)]),this;}async[a299_0x50e18a(0x173)](){const _0x20b5af=a299_0x50e18a;this[_0x20b5af(0x15c)]['status']=logger_enums_1[_0x20b5af(0x15f)][_0x20b5af(0x16c)],this[_0x20b5af(0x15c)][_0x20b5af(0x181)]=new Date()[_0x20b5af(0x158)](),await this['update']();}async[a299_0x50e18a(0x16a)](){const _0x1fd157=a299_0x50e18a;this[_0x1fd157(0x15c)][_0x1fd157(0x151)]=logger_enums_1[_0x1fd157(0x15f)]['COMPLETED'],this[_0x1fd157(0x15c)]['completedDate']=new Date()['getTime'](),await this[_0x1fd157(0x15d)]();}async[a299_0x50e18a(0x17f)]({message:_0x386fae}){const _0xeacc2f=a299_0x50e18a;this[_0xeacc2f(0x15c)][_0xeacc2f(0x151)]=logger_enums_1['JobStatus'][_0xeacc2f(0x15b)],this['jobState']['completedDate']=new Date()[_0xeacc2f(0x158)](),this['jobState'][_0xeacc2f(0x175)]=_0x386fae,await this['update']();}[a299_0x50e18a(0x180)](_0x3ec1e7){const _0x58d915=a299_0x50e18a;return this['jobState'][_0x58d915(0x179)][_0x58d915(0x161)](_0x3ec1e7),this['update']();}}exports[a299_0x50e18a(0x172)]=StateManager;