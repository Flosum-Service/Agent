const a328_0x16dfaf=a328_0x408a;(function(_0x485355,_0x2c46b7){const _0x1e82a5=a328_0x408a,_0x26bca7=_0x485355();while(!![]){try{const _0x7f6328=parseInt(_0x1e82a5(0x204))/0x1*(parseInt(_0x1e82a5(0x1f0))/0x2)+-parseInt(_0x1e82a5(0x1fe))/0x3*(parseInt(_0x1e82a5(0x21c))/0x4)+parseInt(_0x1e82a5(0x1ef))/0x5+parseInt(_0x1e82a5(0x203))/0x6*(parseInt(_0x1e82a5(0x1fb))/0x7)+parseInt(_0x1e82a5(0x201))/0x8*(-parseInt(_0x1e82a5(0x1ff))/0x9)+parseInt(_0x1e82a5(0x1fa))/0xa+-parseInt(_0x1e82a5(0x207))/0xb*(parseInt(_0x1e82a5(0x210))/0xc);if(_0x7f6328===_0x2c46b7)break;else _0x26bca7['push'](_0x26bca7['shift']());}catch(_0x3b0364){_0x26bca7['push'](_0x26bca7['shift']());}}}(a328_0x25c6,0x294c5));const a328_0x39f59f=(function(){let _0x24fa52=!![];return function(_0x943b35,_0x4fecea){const _0x58be74=_0x24fa52?function(){const _0x12380c=a328_0x408a;if(_0x4fecea){const _0x4f7453=_0x4fecea[_0x12380c(0x200)](_0x943b35,arguments);return _0x4fecea=null,_0x4f7453;}}:function(){};return _0x24fa52=![],_0x58be74;};}()),a328_0x46933f=a328_0x39f59f(this,function(){const _0x3d2d64=a328_0x408a;return a328_0x46933f['toString']()[_0x3d2d64(0x212)](_0x3d2d64(0x215))['toString']()[_0x3d2d64(0x205)](a328_0x46933f)['search'](_0x3d2d64(0x215));});a328_0x46933f();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x9f964d){const _0x5c43a6=a328_0x408a;return _0x9f964d&&_0x9f964d[_0x5c43a6(0x20a)]?_0x9f964d:{'default':_0x9f964d};};Object['defineProperty'](exports,a328_0x16dfaf(0x20a),{'value':!![]});function a328_0x408a(_0x2a7034,_0x1fdc7d){const _0x4206b9=a328_0x25c6();return a328_0x408a=function(_0x46933f,_0x39f59f){_0x46933f=_0x46933f-0x1ed;let _0x25c695=_0x4206b9[_0x46933f];return _0x25c695;},a328_0x408a(_0x2a7034,_0x1fdc7d);}const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a328_0x16dfaf(0x213))),promises_1=require(a328_0x16dfaf(0x21b)),utils_1=require('@flosum/utils'),job_1=require(a328_0x16dfaf(0x217));function a328_0x25c6(){const _0x877ec3=['join','IN_PROGRESS','1452uHbJtu','default','search','path','getJobState','(((.+)+)+)+$','readFile','../../../constants/job','getJobStatePath','JobStatus','stringify','fs/promises','63436qOuyKv','statePath','completedDate','765295PIEleF','21034LSLOQo','push','FAILED','create','update','setInProgress','utf-8','init','addWarning','status','2472870zcVyce','1718094LSKLuc','warnings','Job\x20not\x20found.','24ZfNusR','1084734nKZeQj','apply','8bZIXaD','error','6zcPEDm','18VjhnSF','constructor','getTime','38049VODnJe','createdDate','QUEUED','__esModule','parse','writeFile','jobState'];a328_0x25c6=function(){return _0x877ec3;};return a328_0x25c6();}class StateManager{constructor(_0x37364a){const _0x28d408=a328_0x16dfaf;this['statePath']=StateManager[_0x28d408(0x218)](_0x37364a);}static[a328_0x16dfaf(0x218)](_0x573772){const _0x3dbb3d=a328_0x16dfaf;return path_1[_0x3dbb3d(0x211)][_0x3dbb3d(0x20e)](_0x573772,job_1['JOB_LOG_STATE_FILENAME']);}static async[a328_0x16dfaf(0x1f3)](_0xb6a093,_0x591157){const _0x1dc561=a328_0x16dfaf,_0x320506=StateManager[_0x1dc561(0x218)](_0xb6a093),_0x57cf0b={'id':_0x591157,'status':logger_enums_1[_0x1dc561(0x219)][_0x1dc561(0x209)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x1dc561(0x20c)])(_0x320506,JSON[_0x1dc561(0x21a)](_0x57cf0b));}static async[a328_0x16dfaf(0x214)](_0x1aea00){const _0x1bf1b4=a328_0x16dfaf,_0x454b96=StateManager[_0x1bf1b4(0x218)](_0x1aea00);if(await utils_1['FsUtils']['isExistsPath'](_0x454b96))return(0x0,promises_1[_0x1bf1b4(0x216)])(_0x454b96,_0x1bf1b4(0x1f6))['then'](JSON['parse']);throw new Error(_0x1bf1b4(0x1fd));}async[a328_0x16dfaf(0x1f4)](){const _0x575693=a328_0x16dfaf;await(0x0,promises_1[_0x575693(0x20c)])(this['statePath'],JSON[_0x575693(0x21a)](this[_0x575693(0x20d)]));}async[a328_0x16dfaf(0x1f7)](){const _0x28d4f4=a328_0x16dfaf;return this['jobState']=await(0x0,promises_1[_0x28d4f4(0x216)])(this[_0x28d4f4(0x1ed)],'utf-8')['then'](JSON[_0x28d4f4(0x20b)]),this;}async[a328_0x16dfaf(0x1f5)](){const _0x21584a=a328_0x16dfaf;this['jobState'][_0x21584a(0x1f9)]=logger_enums_1[_0x21584a(0x219)][_0x21584a(0x20f)],this[_0x21584a(0x20d)][_0x21584a(0x208)]=new Date()[_0x21584a(0x206)](),await this[_0x21584a(0x1f4)]();}async['setCompleted'](){const _0x59e595=a328_0x16dfaf;this[_0x59e595(0x20d)][_0x59e595(0x1f9)]=logger_enums_1['JobStatus']['COMPLETED'],this[_0x59e595(0x20d)][_0x59e595(0x1ee)]=new Date()[_0x59e595(0x206)](),await this[_0x59e595(0x1f4)]();}async['setError']({message:_0x2ddadb}){const _0x1261c8=a328_0x16dfaf;this['jobState'][_0x1261c8(0x1f9)]=logger_enums_1['JobStatus'][_0x1261c8(0x1f2)],this['jobState'][_0x1261c8(0x1ee)]=new Date()['getTime'](),this[_0x1261c8(0x20d)][_0x1261c8(0x202)]=_0x2ddadb,await this[_0x1261c8(0x1f4)]();}[a328_0x16dfaf(0x1f8)](_0x1d40fd){const _0x5325de=a328_0x16dfaf;return this['jobState'][_0x5325de(0x1fc)][_0x5325de(0x1f1)](_0x1d40fd),this['update']();}}exports['default']=StateManager;