const a298_0x1410ae=a298_0x3345;(function(_0x4a2278,_0x536652){const _0x55eb3d=a298_0x3345,_0xfffa71=_0x4a2278();while(!![]){try{const _0x3467da=-parseInt(_0x55eb3d(0x1ff))/0x1*(-parseInt(_0x55eb3d(0x1ec))/0x2)+-parseInt(_0x55eb3d(0x1e9))/0x3+parseInt(_0x55eb3d(0x1fb))/0x4*(-parseInt(_0x55eb3d(0x1e3))/0x5)+parseInt(_0x55eb3d(0x1fe))/0x6*(parseInt(_0x55eb3d(0x1d0))/0x7)+-parseInt(_0x55eb3d(0x1fa))/0x8*(parseInt(_0x55eb3d(0x1d3))/0x9)+parseInt(_0x55eb3d(0x200))/0xa*(parseInt(_0x55eb3d(0x1f5))/0xb)+-parseInt(_0x55eb3d(0x1f0))/0xc*(-parseInt(_0x55eb3d(0x1f3))/0xd);if(_0x3467da===_0x536652)break;else _0xfffa71['push'](_0xfffa71['shift']());}catch(_0x3ffcd3){_0xfffa71['push'](_0xfffa71['shift']());}}}(a298_0x571f,0x3dfc2));const a298_0x597db0=(function(){let _0x2b4716=!![];return function(_0x1d5594,_0x35f9c8){const _0x4e8cc2=_0x2b4716?function(){const _0x407424=a298_0x3345;if(_0x35f9c8){const _0x592a07=_0x35f9c8[_0x407424(0x1d6)](_0x1d5594,arguments);return _0x35f9c8=null,_0x592a07;}}:function(){};return _0x2b4716=![],_0x4e8cc2;};}()),a298_0xc9b0ce=a298_0x597db0(this,function(){const _0x177d40=a298_0x3345;return a298_0xc9b0ce[_0x177d40(0x1ed)]()[_0x177d40(0x1f4)]('(((.+)+)+)+$')[_0x177d40(0x1ed)]()[_0x177d40(0x1d2)](a298_0xc9b0ce)['search'](_0x177d40(0x201));});a298_0xc9b0ce();'use strict';function a298_0x3345(_0x367182,_0x2ffa6a){const _0x38e83b=a298_0x571f();return a298_0x3345=function(_0xc9b0ce,_0x597db0){_0xc9b0ce=_0xc9b0ce-0x1cf;let _0x571fca=_0x38e83b[_0xc9b0ce];return _0x571fca;},a298_0x3345(_0x367182,_0x2ffa6a);}function a298_0x571f(){const _0x410389=['addWarning','__esModule','1375308dSFyeD','fs/promises','completedDate','172630tJKFbK','toString','join','init','12NUKPhQ','parse','../../../constants/job','1449721CbxziU','search','1705583AFhCId','default','getTime','error','update','8jRxRGp','875296FOzlRD','then','jobState','2659032goWqvO','1NKfUtL','30ZiJcWJ','(((.+)+)+)+$','path','7ysuyge','getJobState','constructor','1575117AMIIZY','isExistsPath','getJobStatePath','apply','FsUtils','create','utf-8','JobStatus','status','setCompleted','warnings','setError','setInProgress','Job\x20not\x20found.','stringify','__importDefault','5dGIenS','IN_PROGRESS','statePath','writeFile'];a298_0x571f=function(){return _0x410389;};return a298_0x571f();}var __importDefault=this&&this[a298_0x1410ae(0x1e2)]||function(_0x250d66){const _0x4a947c=a298_0x1410ae;return _0x250d66&&_0x250d66[_0x4a947c(0x1e8)]?_0x250d66:{'default':_0x250d66};};Object['defineProperty'](exports,a298_0x1410ae(0x1e8),{'value':!![]});const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a298_0x1410ae(0x1cf))),promises_1=require(a298_0x1410ae(0x1ea)),utils_1=require('@flosum/utils'),job_1=require(a298_0x1410ae(0x1f2));class StateManager{constructor(_0x4f60e0){const _0xe7edc6=a298_0x1410ae;this[_0xe7edc6(0x1e5)]=StateManager[_0xe7edc6(0x1d5)](_0x4f60e0);}static[a298_0x1410ae(0x1d5)](_0x65481b){const _0x2e0289=a298_0x1410ae;return path_1[_0x2e0289(0x1f6)][_0x2e0289(0x1ee)](_0x65481b,job_1['JOB_LOG_STATE_FILENAME']);}static async[a298_0x1410ae(0x1d8)](_0x591278,_0xa470e){const _0x19ccbb=a298_0x1410ae,_0x1f97bf=StateManager[_0x19ccbb(0x1d5)](_0x591278),_0x4db781={'id':_0xa470e,'status':logger_enums_1[_0x19ccbb(0x1da)]['QUEUED'],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x19ccbb(0x1e6)])(_0x1f97bf,JSON[_0x19ccbb(0x1e1)](_0x4db781));}static async[a298_0x1410ae(0x1d1)](_0x484b69){const _0x3df77d=a298_0x1410ae,_0x1184a1=StateManager[_0x3df77d(0x1d5)](_0x484b69);if(await utils_1[_0x3df77d(0x1d7)][_0x3df77d(0x1d4)](_0x1184a1))return(0x0,promises_1['readFile'])(_0x1184a1,_0x3df77d(0x1d9))[_0x3df77d(0x1fc)](JSON[_0x3df77d(0x1f1)]);throw new Error(_0x3df77d(0x1e0));}async[a298_0x1410ae(0x1f9)](){const _0x2203e0=a298_0x1410ae;await(0x0,promises_1[_0x2203e0(0x1e6)])(this[_0x2203e0(0x1e5)],JSON[_0x2203e0(0x1e1)](this[_0x2203e0(0x1fd)]));}async[a298_0x1410ae(0x1ef)](){const _0x1eeb28=a298_0x1410ae;return this[_0x1eeb28(0x1fd)]=await(0x0,promises_1['readFile'])(this[_0x1eeb28(0x1e5)],_0x1eeb28(0x1d9))['then'](JSON[_0x1eeb28(0x1f1)]),this;}async[a298_0x1410ae(0x1df)](){const _0x250462=a298_0x1410ae;this[_0x250462(0x1fd)][_0x250462(0x1db)]=logger_enums_1['JobStatus'][_0x250462(0x1e4)],this['jobState']['createdDate']=new Date()[_0x250462(0x1f7)](),await this['update']();}async[a298_0x1410ae(0x1dc)](){const _0x9c2a57=a298_0x1410ae;this[_0x9c2a57(0x1fd)][_0x9c2a57(0x1db)]=logger_enums_1[_0x9c2a57(0x1da)]['COMPLETED'],this[_0x9c2a57(0x1fd)][_0x9c2a57(0x1eb)]=new Date()['getTime'](),await this[_0x9c2a57(0x1f9)]();}async[a298_0x1410ae(0x1de)]({message:_0x45207f}){const _0x316bbc=a298_0x1410ae;this[_0x316bbc(0x1fd)][_0x316bbc(0x1db)]=logger_enums_1[_0x316bbc(0x1da)]['FAILED'],this[_0x316bbc(0x1fd)]['completedDate']=new Date()['getTime'](),this[_0x316bbc(0x1fd)][_0x316bbc(0x1f8)]=_0x45207f,await this[_0x316bbc(0x1f9)]();}[a298_0x1410ae(0x1e7)](_0x81e319){const _0x404b4f=a298_0x1410ae;return this[_0x404b4f(0x1fd)][_0x404b4f(0x1dd)]['push'](_0x81e319),this[_0x404b4f(0x1f9)]();}}exports['default']=StateManager;