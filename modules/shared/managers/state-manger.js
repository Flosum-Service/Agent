const a326_0x2e0f21=a326_0x1afc;function a326_0x1afc(_0x11e465,_0xf44e6d){const _0x1f597e=a326_0xf404();return a326_0x1afc=function(_0x16a5e8,_0x3b16e3){_0x16a5e8=_0x16a5e8-0x74;let _0xf40412=_0x1f597e[_0x16a5e8];return _0xf40412;},a326_0x1afc(_0x11e465,_0xf44e6d);}(function(_0x563cf5,_0x4f3208){const _0x41a65a=a326_0x1afc,_0x186fb5=_0x563cf5();while(!![]){try{const _0x24a2a2=parseInt(_0x41a65a(0x88))/0x1*(-parseInt(_0x41a65a(0x93))/0x2)+parseInt(_0x41a65a(0x94))/0x3+parseInt(_0x41a65a(0x86))/0x4+-parseInt(_0x41a65a(0x78))/0x5+-parseInt(_0x41a65a(0x9a))/0x6+-parseInt(_0x41a65a(0x92))/0x7*(-parseInt(_0x41a65a(0x9d))/0x8)+-parseInt(_0x41a65a(0x9c))/0x9;if(_0x24a2a2===_0x4f3208)break;else _0x186fb5['push'](_0x186fb5['shift']());}catch(_0xbe7c20){_0x186fb5['push'](_0x186fb5['shift']());}}}(a326_0xf404,0x764cc));const a326_0x3b16e3=(function(){let _0x1715f3=!![];return function(_0x3b7b60,_0x31ee82){const _0x11d2c2=_0x1715f3?function(){if(_0x31ee82){const _0x1b7721=_0x31ee82['apply'](_0x3b7b60,arguments);return _0x31ee82=null,_0x1b7721;}}:function(){};return _0x1715f3=![],_0x11d2c2;};}()),a326_0x16a5e8=a326_0x3b16e3(this,function(){const _0x486339=a326_0x1afc;return a326_0x16a5e8[_0x486339(0x8c)]()[_0x486339(0x84)]('(((.+)+)+)+$')[_0x486339(0x8c)]()[_0x486339(0x89)](a326_0x16a5e8)[_0x486339(0x84)]('(((.+)+)+)+$');});a326_0x16a5e8();'use strict';var __importDefault=this&&this[a326_0x2e0f21(0x7b)]||function(_0x459ce8){const _0x231d16=a326_0x2e0f21;return _0x459ce8&&_0x459ce8[_0x231d16(0x96)]?_0x459ce8:{'default':_0x459ce8};};Object[a326_0x2e0f21(0x9e)](exports,'__esModule',{'value':!![]});function a326_0xf404(){const _0xcf1cae=['readFile','setError','stringify','then','JobStatus','update','../enums/logger.enums','search','getTime','2684252cnOwzi','join','115hAXQCA','constructor','utf-8','push','toString','setCompleted','writeFile','../../../constants/job','getJobStatePath','isExistsPath','31717xurEpu','8966JvuTtO','2613402pzsxQh','getJobState','__esModule','completedDate','setInProgress','Job\x20not\x20found.','1605126RSXyVj','jobState','4287348TPkDQj','440uFikem','defineProperty','JOB_LOG_STATE_FILENAME','error','statePath','addWarning','@flosum/utils','status','fs/promises','FAILED','default','237040ovqkLo','COMPLETED','parse','__importDefault','path'];a326_0xf404=function(){return _0xcf1cae;};return a326_0xf404();}const logger_enums_1=require(a326_0x2e0f21(0x83)),path_1=__importDefault(require(a326_0x2e0f21(0x7c))),promises_1=require(a326_0x2e0f21(0x75)),utils_1=require(a326_0x2e0f21(0xa3)),job_1=require(a326_0x2e0f21(0x8f));class StateManager{constructor(_0xc02607){const _0x42e72a=a326_0x2e0f21;this[_0x42e72a(0xa1)]=StateManager[_0x42e72a(0x90)](_0xc02607);}static['getJobStatePath'](_0x5b4b74){const _0x46ead5=a326_0x2e0f21;return path_1[_0x46ead5(0x77)][_0x46ead5(0x87)](_0x5b4b74,job_1[_0x46ead5(0x9f)]);}static async['create'](_0x57a5be,_0x5be4f8){const _0x150dbe=a326_0x2e0f21,_0x95fa3f=StateManager[_0x150dbe(0x90)](_0x57a5be),_0xb3c924={'id':_0x5be4f8,'status':logger_enums_1['JobStatus']['QUEUED'],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x150dbe(0x8e)])(_0x95fa3f,JSON[_0x150dbe(0x7f)](_0xb3c924));}static async[a326_0x2e0f21(0x95)](_0x20521a){const _0x15be6c=a326_0x2e0f21,_0x5cc6e2=StateManager['getJobStatePath'](_0x20521a);if(await utils_1['FsUtils'][_0x15be6c(0x91)](_0x5cc6e2))return(0x0,promises_1['readFile'])(_0x5cc6e2,_0x15be6c(0x8a))[_0x15be6c(0x80)](JSON[_0x15be6c(0x7a)]);throw new Error(_0x15be6c(0x99));}async['update'](){const _0x30a824=a326_0x2e0f21;await(0x0,promises_1[_0x30a824(0x8e)])(this['statePath'],JSON[_0x30a824(0x7f)](this[_0x30a824(0x9b)]));}async['init'](){const _0x1e515a=a326_0x2e0f21;return this[_0x1e515a(0x9b)]=await(0x0,promises_1[_0x1e515a(0x7d)])(this[_0x1e515a(0xa1)],_0x1e515a(0x8a))[_0x1e515a(0x80)](JSON[_0x1e515a(0x7a)]),this;}async[a326_0x2e0f21(0x98)](){const _0x1b8ee2=a326_0x2e0f21;this['jobState'][_0x1b8ee2(0x74)]=logger_enums_1[_0x1b8ee2(0x81)]['IN_PROGRESS'],this['jobState']['createdDate']=new Date()[_0x1b8ee2(0x85)](),await this[_0x1b8ee2(0x82)]();}async[a326_0x2e0f21(0x8d)](){const _0xe965a=a326_0x2e0f21;this[_0xe965a(0x9b)][_0xe965a(0x74)]=logger_enums_1['JobStatus'][_0xe965a(0x79)],this[_0xe965a(0x9b)][_0xe965a(0x97)]=new Date()[_0xe965a(0x85)](),await this['update']();}async[a326_0x2e0f21(0x7e)]({message:_0x253fd9}){const _0x4d9039=a326_0x2e0f21;this[_0x4d9039(0x9b)][_0x4d9039(0x74)]=logger_enums_1['JobStatus'][_0x4d9039(0x76)],this['jobState'][_0x4d9039(0x97)]=new Date()[_0x4d9039(0x85)](),this[_0x4d9039(0x9b)][_0x4d9039(0xa0)]=_0x253fd9,await this['update']();}[a326_0x2e0f21(0xa2)](_0x4b48db){const _0x45c9a4=a326_0x2e0f21;return this[_0x45c9a4(0x9b)]['warnings'][_0x45c9a4(0x8b)](_0x4b48db),this[_0x45c9a4(0x82)]();}}exports[a326_0x2e0f21(0x77)]=StateManager;