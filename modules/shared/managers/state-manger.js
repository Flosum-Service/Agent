const a328_0x1e2f9d=a328_0x1440;(function(_0x2a910e,_0x5b2f0c){const _0x32486c=a328_0x1440,_0x5367d9=_0x2a910e();while(!![]){try{const _0x53275b=-parseInt(_0x32486c(0xa5))/0x1*(-parseInt(_0x32486c(0xc9))/0x2)+-parseInt(_0x32486c(0xd6))/0x3*(-parseInt(_0x32486c(0xad))/0x4)+parseInt(_0x32486c(0xb8))/0x5+-parseInt(_0x32486c(0xac))/0x6*(parseInt(_0x32486c(0xc2))/0x7)+parseInt(_0x32486c(0xd5))/0x8*(-parseInt(_0x32486c(0xbd))/0x9)+parseInt(_0x32486c(0xd4))/0xa*(parseInt(_0x32486c(0xb6))/0xb)+parseInt(_0x32486c(0xbe))/0xc*(-parseInt(_0x32486c(0xcd))/0xd);if(_0x53275b===_0x5b2f0c)break;else _0x5367d9['push'](_0x5367d9['shift']());}catch(_0x5bdea9){_0x5367d9['push'](_0x5367d9['shift']());}}}(a328_0x3464,0x1f0c2));function a328_0x1440(_0x17b7b5,_0x2bd9ea){const _0x4bb5fd=a328_0x3464();return a328_0x1440=function(_0x1c0aa6,_0x1b5c15){_0x1c0aa6=_0x1c0aa6-0xa2;let _0x346458=_0x4bb5fd[_0x1c0aa6];return _0x346458;},a328_0x1440(_0x17b7b5,_0x2bd9ea);}const a328_0x1b5c15=(function(){let _0x5223a0=!![];return function(_0x1b742e,_0x3eaf6f){const _0x48857f=_0x5223a0?function(){const _0x2c5465=a328_0x1440;if(_0x3eaf6f){const _0x355856=_0x3eaf6f[_0x2c5465(0xa6)](_0x1b742e,arguments);return _0x3eaf6f=null,_0x355856;}}:function(){};return _0x5223a0=![],_0x48857f;};}()),a328_0x1c0aa6=a328_0x1b5c15(this,function(){const _0xb87d4c=a328_0x1440;return a328_0x1c0aa6[_0xb87d4c(0xb2)]()['search'](_0xb87d4c(0xce))[_0xb87d4c(0xb2)]()[_0xb87d4c(0xb5)](a328_0x1c0aa6)[_0xb87d4c(0xa7)](_0xb87d4c(0xce));});function a328_0x3464(){const _0x3cadea=['COMPLETED','update','10413zJHBSP','852IzQuTF','setCompleted','getJobState','default','210tPNJIC','create','warnings','join','error','JobStatus','FsUtils','10psJLno','parse','defineProperty','isExistsPath','5707mYsicN','(((.+)+)+)+$','then','addWarning','statePath','stringify','createdDate','10zSRGGy','800kRrHPI','45RvVKwC','QUEUED','status','../../../constants/job','FAILED','6982VlcYKA','apply','search','jobState','writeFile','../enums/logger.enums','getJobStatePath','47028GySgSA','50708lISYEf','setError','IN_PROGRESS','completedDate','readFile','toString','setInProgress','fs/promises','constructor','1398408RhxhUp','getTime','784930RdzRGY','__esModule','JOB_LOG_STATE_FILENAME'];a328_0x3464=function(){return _0x3cadea;};return a328_0x3464();}a328_0x1c0aa6();'use strict';var __importDefault=this&&this['__importDefault']||function(_0xbc54b6){const _0x2ac783=a328_0x1440;return _0xbc54b6&&_0xbc54b6[_0x2ac783(0xb9)]?_0xbc54b6:{'default':_0xbc54b6};};Object[a328_0x1e2f9d(0xcb)](exports,a328_0x1e2f9d(0xb9),{'value':!![]});const logger_enums_1=require(a328_0x1e2f9d(0xaa)),path_1=__importDefault(require('path')),promises_1=require(a328_0x1e2f9d(0xb4)),utils_1=require('@flosum/utils'),job_1=require(a328_0x1e2f9d(0xa3));class StateManager{constructor(_0x390d04){const _0x527930=a328_0x1e2f9d;this[_0x527930(0xd1)]=StateManager[_0x527930(0xab)](_0x390d04);}static[a328_0x1e2f9d(0xab)](_0x48a696){const _0x37cb0d=a328_0x1e2f9d;return path_1[_0x37cb0d(0xc1)][_0x37cb0d(0xc5)](_0x48a696,job_1[_0x37cb0d(0xba)]);}static async[a328_0x1e2f9d(0xc3)](_0x3e4a26,_0x2d7a92){const _0x1da907=a328_0x1e2f9d,_0x3435f6=StateManager[_0x1da907(0xab)](_0x3e4a26),_0x21f2ef={'id':_0x2d7a92,'status':logger_enums_1[_0x1da907(0xc7)][_0x1da907(0xd7)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x1da907(0xa9)])(_0x3435f6,JSON['stringify'](_0x21f2ef));}static async[a328_0x1e2f9d(0xc0)](_0x4cf906){const _0x259cd6=a328_0x1e2f9d,_0xc2e956=StateManager[_0x259cd6(0xab)](_0x4cf906);if(await utils_1[_0x259cd6(0xc8)][_0x259cd6(0xcc)](_0xc2e956))return(0x0,promises_1['readFile'])(_0xc2e956,'utf-8')[_0x259cd6(0xcf)](JSON[_0x259cd6(0xca)]);throw new Error('Job\x20not\x20found.');}async[a328_0x1e2f9d(0xbc)](){const _0x73ae17=a328_0x1e2f9d;await(0x0,promises_1[_0x73ae17(0xa9)])(this[_0x73ae17(0xd1)],JSON[_0x73ae17(0xd2)](this['jobState']));}async['init'](){const _0x5b6f30=a328_0x1e2f9d;return this[_0x5b6f30(0xa8)]=await(0x0,promises_1[_0x5b6f30(0xb1)])(this[_0x5b6f30(0xd1)],'utf-8')[_0x5b6f30(0xcf)](JSON[_0x5b6f30(0xca)]),this;}async[a328_0x1e2f9d(0xb3)](){const _0x5d649e=a328_0x1e2f9d;this[_0x5d649e(0xa8)]['status']=logger_enums_1[_0x5d649e(0xc7)][_0x5d649e(0xaf)],this[_0x5d649e(0xa8)][_0x5d649e(0xd3)]=new Date()[_0x5d649e(0xb7)](),await this[_0x5d649e(0xbc)]();}async[a328_0x1e2f9d(0xbf)](){const _0x4928b7=a328_0x1e2f9d;this['jobState'][_0x4928b7(0xa2)]=logger_enums_1[_0x4928b7(0xc7)][_0x4928b7(0xbb)],this[_0x4928b7(0xa8)][_0x4928b7(0xb0)]=new Date()[_0x4928b7(0xb7)](),await this[_0x4928b7(0xbc)]();}async[a328_0x1e2f9d(0xae)]({message:_0x482bdc}){const _0x1cf500=a328_0x1e2f9d;this[_0x1cf500(0xa8)]['status']=logger_enums_1[_0x1cf500(0xc7)][_0x1cf500(0xa4)],this[_0x1cf500(0xa8)][_0x1cf500(0xb0)]=new Date()['getTime'](),this[_0x1cf500(0xa8)][_0x1cf500(0xc6)]=_0x482bdc,await this['update']();}[a328_0x1e2f9d(0xd0)](_0x41c930){const _0x2a5d5b=a328_0x1e2f9d;return this[_0x2a5d5b(0xa8)][_0x2a5d5b(0xc4)]['push'](_0x41c930),this[_0x2a5d5b(0xbc)]();}}exports['default']=StateManager;