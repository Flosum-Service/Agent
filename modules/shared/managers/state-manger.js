const a327_0x4bf803=a327_0x5cf9;(function(_0x358036,_0x2bb2e6){const _0x461a95=a327_0x5cf9,_0x5c095b=_0x358036();while(!![]){try{const _0x57fe18=parseInt(_0x461a95(0x19f))/0x1+parseInt(_0x461a95(0x196))/0x2+parseInt(_0x461a95(0x1b8))/0x3+-parseInt(_0x461a95(0x1b4))/0x4*(-parseInt(_0x461a95(0x192))/0x5)+-parseInt(_0x461a95(0x197))/0x6*(-parseInt(_0x461a95(0x19b))/0x7)+parseInt(_0x461a95(0x19e))/0x8+-parseInt(_0x461a95(0x19a))/0x9;if(_0x57fe18===_0x2bb2e6)break;else _0x5c095b['push'](_0x5c095b['shift']());}catch(_0x3e7706){_0x5c095b['push'](_0x5c095b['shift']());}}}(a327_0x5185,0x6dc96));const a327_0x376458=(function(){let _0x21ffee=!![];return function(_0x192a04,_0x272b08){const _0x4af190=_0x21ffee?function(){const _0xc1b088=a327_0x5cf9;if(_0x272b08){const _0x1e05c2=_0x272b08[_0xc1b088(0x1a5)](_0x192a04,arguments);return _0x272b08=null,_0x1e05c2;}}:function(){};return _0x21ffee=![],_0x4af190;};}()),a327_0x35b7b9=a327_0x376458(this,function(){const _0x5f00a5=a327_0x5cf9;return a327_0x35b7b9['toString']()[_0x5f00a5(0x1ad)](_0x5f00a5(0x18f))[_0x5f00a5(0x1aa)]()[_0x5f00a5(0x1a1)](a327_0x35b7b9)['search']('(((.+)+)+)+$');});a327_0x35b7b9();function a327_0x5185(){const _0x31a7ce=['parse','__esModule','(((.+)+)+)+$','defineProperty','jobState','25NdikPU','addWarning','@flosum/utils','setCompleted','1388820WFHjZQ','582swHFdZ','getJobState','warnings','24049359TigsZl','13489uNwSac','create','utf-8','4073296JoJtUC','542486CBVieX','JobStatus','constructor','fs/promises','QUEUED','statePath','apply','setInProgress','readFile','completedDate','default','toString','Job\x20not\x20found.','getJobStatePath','search','writeFile','then','error','setError','init','update','408324XtrATP','getTime','FsUtils','status','2035365aJrebj','push'];a327_0x5185=function(){return _0x31a7ce;};return a327_0x5185();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4446a8){return _0x4446a8&&_0x4446a8['__esModule']?_0x4446a8:{'default':_0x4446a8};};Object[a327_0x4bf803(0x190)](exports,a327_0x4bf803(0x18e),{'value':!![]});const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require('path')),promises_1=require(a327_0x4bf803(0x1a2)),utils_1=require(a327_0x4bf803(0x194)),job_1=require('../../../constants/job');class StateManager{constructor(_0x28a624){const _0x2e213b=a327_0x4bf803;this[_0x2e213b(0x1a4)]=StateManager['getJobStatePath'](_0x28a624);}static[a327_0x4bf803(0x1ac)](_0x4ec278){const _0x4de556=a327_0x4bf803;return path_1[_0x4de556(0x1a9)]['join'](_0x4ec278,job_1['JOB_LOG_STATE_FILENAME']);}static async[a327_0x4bf803(0x19c)](_0x58b2f0,_0x1f5b1e){const _0x299ea9=a327_0x4bf803,_0x29ee33=StateManager[_0x299ea9(0x1ac)](_0x58b2f0),_0x41402c={'id':_0x1f5b1e,'status':logger_enums_1['JobStatus'][_0x299ea9(0x1a3)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x299ea9(0x1ae)])(_0x29ee33,JSON['stringify'](_0x41402c));}static async[a327_0x4bf803(0x198)](_0x259c26){const _0x1e142f=a327_0x4bf803,_0x5aaeb0=StateManager['getJobStatePath'](_0x259c26);if(await utils_1[_0x1e142f(0x1b6)]['isExistsPath'](_0x5aaeb0))return(0x0,promises_1[_0x1e142f(0x1a7)])(_0x5aaeb0,'utf-8')[_0x1e142f(0x1af)](JSON[_0x1e142f(0x18d)]);throw new Error(_0x1e142f(0x1ab));}async[a327_0x4bf803(0x1b3)](){const _0x58d642=a327_0x4bf803;await(0x0,promises_1[_0x58d642(0x1ae)])(this[_0x58d642(0x1a4)],JSON['stringify'](this[_0x58d642(0x191)]));}async[a327_0x4bf803(0x1b2)](){const _0x1a1eda=a327_0x4bf803;return this['jobState']=await(0x0,promises_1[_0x1a1eda(0x1a7)])(this['statePath'],_0x1a1eda(0x19d))[_0x1a1eda(0x1af)](JSON['parse']),this;}async[a327_0x4bf803(0x1a6)](){const _0x27bed3=a327_0x4bf803;this[_0x27bed3(0x191)][_0x27bed3(0x1b7)]=logger_enums_1[_0x27bed3(0x1a0)]['IN_PROGRESS'],this['jobState']['createdDate']=new Date()[_0x27bed3(0x1b5)](),await this['update']();}async[a327_0x4bf803(0x195)](){const _0x152a67=a327_0x4bf803;this['jobState'][_0x152a67(0x1b7)]=logger_enums_1[_0x152a67(0x1a0)]['COMPLETED'],this[_0x152a67(0x191)][_0x152a67(0x1a8)]=new Date()[_0x152a67(0x1b5)](),await this['update']();}async[a327_0x4bf803(0x1b1)]({message:_0x31e1e6}){const _0x3bc07e=a327_0x4bf803;this[_0x3bc07e(0x191)][_0x3bc07e(0x1b7)]=logger_enums_1['JobStatus']['FAILED'],this['jobState']['completedDate']=new Date()[_0x3bc07e(0x1b5)](),this[_0x3bc07e(0x191)][_0x3bc07e(0x1b0)]=_0x31e1e6,await this[_0x3bc07e(0x1b3)]();}[a327_0x4bf803(0x193)](_0x52d566){const _0x1c31b4=a327_0x4bf803;return this[_0x1c31b4(0x191)][_0x1c31b4(0x199)][_0x1c31b4(0x18c)](_0x52d566),this[_0x1c31b4(0x1b3)]();}}function a327_0x5cf9(_0xe985ad,_0x58cb86){const _0x568233=a327_0x5185();return a327_0x5cf9=function(_0x35b7b9,_0x376458){_0x35b7b9=_0x35b7b9-0x18c;let _0x5185d5=_0x568233[_0x35b7b9];return _0x5185d5;},a327_0x5cf9(_0xe985ad,_0x58cb86);}exports[a327_0x4bf803(0x1a9)]=StateManager;