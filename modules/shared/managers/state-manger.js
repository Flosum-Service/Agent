const a283_0x30890c=a283_0x23a9;(function(_0xfadf49,_0x163e1e){const _0x1678ea=a283_0x23a9,_0x1aea83=_0xfadf49();while(!![]){try{const _0x1784d9=parseInt(_0x1678ea(0xce))/0x1+parseInt(_0x1678ea(0xc1))/0x2+parseInt(_0x1678ea(0xc0))/0x3+parseInt(_0x1678ea(0xb6))/0x4+-parseInt(_0x1678ea(0xbe))/0x5*(parseInt(_0x1678ea(0xc2))/0x6)+parseInt(_0x1678ea(0xd1))/0x7*(-parseInt(_0x1678ea(0xb3))/0x8)+-parseInt(_0x1678ea(0xb0))/0x9;if(_0x1784d9===_0x163e1e)break;else _0x1aea83['push'](_0x1aea83['shift']());}catch(_0x244152){_0x1aea83['push'](_0x1aea83['shift']());}}}(a283_0x3dd9,0x38d09));const a283_0x55fe55=(function(){let _0x2710bd=!![];return function(_0x27a6df,_0x35629c){const _0x110244=_0x2710bd?function(){if(_0x35629c){const _0x54c20d=_0x35629c['apply'](_0x27a6df,arguments);return _0x35629c=null,_0x54c20d;}}:function(){};return _0x2710bd=![],_0x110244;};}()),a283_0x4f918d=a283_0x55fe55(this,function(){const _0x285aa8=a283_0x23a9;return a283_0x4f918d[_0x285aa8(0xba)]()[_0x285aa8(0xa8)](_0x285aa8(0xd0))[_0x285aa8(0xba)]()[_0x285aa8(0xcd)](a283_0x4f918d)[_0x285aa8(0xa8)]('(((.+)+)+)+$');});a283_0x4f918d();function a283_0x3dd9(){const _0x9acd7e=['path','parse','getJobState','@flosum/utils','init','search','writeFile','readFile','Job\x20not\x20found.','stringify','setInProgress','jobState','status','4833360gEfwZq','statePath','then','6584ewxouA','COMPLETED','warnings','420872sucUAF','FAILED','FsUtils','isExistsPath','toString','getTime','completedDate','QUEUED','486685PymRbz','__esModule','749643aJJTse','695464EWFNgL','6NlQJlz','error','JobStatus','IN_PROGRESS','push','fs/promises','utf-8','create','getJobStatePath','createdDate','update','constructor','229276rlqvae','addWarning','(((.+)+)+)+$','553WyphRF','default'];a283_0x3dd9=function(){return _0x9acd7e;};return a283_0x3dd9();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x80c0a8){const _0x364e35=a283_0x23a9;return _0x80c0a8&&_0x80c0a8[_0x364e35(0xbf)]?_0x80c0a8:{'default':_0x80c0a8};};Object['defineProperty'](exports,a283_0x30890c(0xbf),{'value':!![]});const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a283_0x30890c(0xd3))),promises_1=require(a283_0x30890c(0xc7)),utils_1=require(a283_0x30890c(0xa6)),job_1=require('../../../constants/job');class StateManager{constructor(_0x5a3625){const _0x3a2133=a283_0x30890c;this[_0x3a2133(0xb1)]=StateManager[_0x3a2133(0xca)](_0x5a3625);}static[a283_0x30890c(0xca)](_0x298d97){return path_1['default']['join'](_0x298d97,job_1['JOB_LOG_STATE_FILENAME']);}static async[a283_0x30890c(0xc9)](_0x3d9e71,_0x153817){const _0x9e26d3=a283_0x30890c,_0x4fcc50=StateManager[_0x9e26d3(0xca)](_0x3d9e71),_0x5d5f04={'id':_0x153817,'status':logger_enums_1[_0x9e26d3(0xc4)][_0x9e26d3(0xbd)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x9e26d3(0xa9)])(_0x4fcc50,JSON[_0x9e26d3(0xac)](_0x5d5f04));}static async[a283_0x30890c(0xa5)](_0x3f0214){const _0x223c2c=a283_0x30890c,_0x3a75b9=StateManager[_0x223c2c(0xca)](_0x3f0214);if(await utils_1[_0x223c2c(0xb8)][_0x223c2c(0xb9)](_0x3a75b9))return(0x0,promises_1[_0x223c2c(0xaa)])(_0x3a75b9,_0x223c2c(0xc8))[_0x223c2c(0xb2)](JSON['parse']);throw new Error(_0x223c2c(0xab));}async[a283_0x30890c(0xcc)](){const _0x4c8d22=a283_0x30890c;await(0x0,promises_1[_0x4c8d22(0xa9)])(this['statePath'],JSON[_0x4c8d22(0xac)](this['jobState']));}async[a283_0x30890c(0xa7)](){const _0x39f494=a283_0x30890c;return this[_0x39f494(0xae)]=await(0x0,promises_1['readFile'])(this['statePath'],'utf-8')[_0x39f494(0xb2)](JSON[_0x39f494(0xd4)]),this;}async[a283_0x30890c(0xad)](){const _0x5c046f=a283_0x30890c;this['jobState']['status']=logger_enums_1[_0x5c046f(0xc4)][_0x5c046f(0xc5)],this[_0x5c046f(0xae)][_0x5c046f(0xcb)]=new Date()[_0x5c046f(0xbb)](),await this[_0x5c046f(0xcc)]();}async['setCompleted'](){const _0x50ee8f=a283_0x30890c;this[_0x50ee8f(0xae)][_0x50ee8f(0xaf)]=logger_enums_1[_0x50ee8f(0xc4)][_0x50ee8f(0xb4)],this[_0x50ee8f(0xae)]['completedDate']=new Date()[_0x50ee8f(0xbb)](),await this['update']();}async['setError']({message:_0x4bffe2}){const _0x50c000=a283_0x30890c;this['jobState'][_0x50c000(0xaf)]=logger_enums_1[_0x50c000(0xc4)][_0x50c000(0xb7)],this[_0x50c000(0xae)][_0x50c000(0xbc)]=new Date()[_0x50c000(0xbb)](),this[_0x50c000(0xae)][_0x50c000(0xc3)]=_0x4bffe2,await this[_0x50c000(0xcc)]();}[a283_0x30890c(0xcf)](_0x2ff6d5){const _0xee1d1b=a283_0x30890c;return this[_0xee1d1b(0xae)][_0xee1d1b(0xb5)][_0xee1d1b(0xc6)](_0x2ff6d5),this[_0xee1d1b(0xcc)]();}}function a283_0x23a9(_0x5cd3fa,_0x44099e){const _0x5d32c0=a283_0x3dd9();return a283_0x23a9=function(_0x4f918d,_0x55fe55){_0x4f918d=_0x4f918d-0xa5;let _0x3dd961=_0x5d32c0[_0x4f918d];return _0x3dd961;},a283_0x23a9(_0x5cd3fa,_0x44099e);}exports[a283_0x30890c(0xd2)]=StateManager;