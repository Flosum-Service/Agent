const a283_0x3ba750=a283_0x5d80;function a283_0x2e26(){const _0x35f19c=['IN_PROGRESS','search','11zqSNnS','JobStatus','warnings','JOB_LOG_STATE_FILENAME','stringify','getTime','defineProperty','utf-8','(((.+)+)+)+$','getJobStatePath','../enums/logger.enums','5643712LuIDix','Job\x20not\x20found.','QUEUED','__importDefault','update','constructor','../../../constants/job','readFile','statePath','completedDate','create','getJobState','isExistsPath','30qewOFI','jobState','5497891wWzBdj','723755WXYcBY','FsUtils','then','apply','2462181lsWTxi','setCompleted','push','setError','610HWucHy','6NdptBc','1143486XhFgxA','toString','fs/promises','20005188mpgxRx','parse','init','4wKYYLn','3271MHAlQp','path','setInProgress','join','status','default'];a283_0x2e26=function(){return _0x35f19c;};return a283_0x2e26();}(function(_0x13db69,_0x5a9656){const _0x3fdc13=a283_0x5d80,_0x2d7d9c=_0x13db69();while(!![]){try{const _0x2ddbc6=parseInt(_0x3fdc13(0x12f))/0x1*(parseInt(_0x3fdc13(0x126))/0x2)+parseInt(_0x3fdc13(0x122))/0x3*(-parseInt(_0x3fdc13(0x12e))/0x4)+parseInt(_0x3fdc13(0x11e))/0x5*(parseInt(_0x3fdc13(0x127))/0x6)+parseInt(_0x3fdc13(0x11d))/0x7+parseInt(_0x3fdc13(0x10e))/0x8+parseInt(_0x3fdc13(0x128))/0x9*(parseInt(_0x3fdc13(0x11b))/0xa)+parseInt(_0x3fdc13(0x137))/0xb*(-parseInt(_0x3fdc13(0x12b))/0xc);if(_0x2ddbc6===_0x5a9656)break;else _0x2d7d9c['push'](_0x2d7d9c['shift']());}catch(_0x16fc4b){_0x2d7d9c['push'](_0x2d7d9c['shift']());}}}(a283_0x2e26,0x8091b));const a283_0x19dbaa=(function(){let _0x290e4a=!![];return function(_0x59c36f,_0x25d79c){const _0x30c29f=_0x290e4a?function(){const _0x2a96ed=a283_0x5d80;if(_0x25d79c){const _0x50ca40=_0x25d79c[_0x2a96ed(0x121)](_0x59c36f,arguments);return _0x25d79c=null,_0x50ca40;}}:function(){};return _0x290e4a=![],_0x30c29f;};}()),a283_0x2d4704=a283_0x19dbaa(this,function(){const _0x20618e=a283_0x5d80;return a283_0x2d4704[_0x20618e(0x129)]()[_0x20618e(0x136)](_0x20618e(0x10b))[_0x20618e(0x129)]()[_0x20618e(0x113)](a283_0x2d4704)[_0x20618e(0x136)](_0x20618e(0x10b));});a283_0x2d4704();function a283_0x5d80(_0x140b20,_0x433f90){const _0x166be7=a283_0x2e26();return a283_0x5d80=function(_0x2d4704,_0x19dbaa){_0x2d4704=_0x2d4704-0x10a;let _0x2e26cf=_0x166be7[_0x2d4704];return _0x2e26cf;},a283_0x5d80(_0x140b20,_0x433f90);}'use strict';var __importDefault=this&&this[a283_0x3ba750(0x111)]||function(_0x38f40b){return _0x38f40b&&_0x38f40b['__esModule']?_0x38f40b:{'default':_0x38f40b};};Object[a283_0x3ba750(0x13d)](exports,'__esModule',{'value':!![]});const logger_enums_1=require(a283_0x3ba750(0x10d)),path_1=__importDefault(require(a283_0x3ba750(0x130))),promises_1=require(a283_0x3ba750(0x12a)),utils_1=require('@flosum/utils'),job_1=require(a283_0x3ba750(0x114));class StateManager{constructor(_0x1e3c5d){const _0x2cadcb=a283_0x3ba750;this[_0x2cadcb(0x116)]=StateManager[_0x2cadcb(0x10c)](_0x1e3c5d);}static['getJobStatePath'](_0x37a450){const _0x531164=a283_0x3ba750;return path_1[_0x531164(0x134)][_0x531164(0x132)](_0x37a450,job_1[_0x531164(0x13a)]);}static async[a283_0x3ba750(0x118)](_0x251a77,_0x21e1e9){const _0x559bc6=a283_0x3ba750,_0x2189ba=StateManager[_0x559bc6(0x10c)](_0x251a77),_0x5e915c={'id':_0x21e1e9,'status':logger_enums_1[_0x559bc6(0x138)][_0x559bc6(0x110)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1['writeFile'])(_0x2189ba,JSON['stringify'](_0x5e915c));}static async[a283_0x3ba750(0x119)](_0x5c3c54){const _0x1be51c=a283_0x3ba750,_0x4e99bf=StateManager['getJobStatePath'](_0x5c3c54);if(await utils_1[_0x1be51c(0x11f)][_0x1be51c(0x11a)](_0x4e99bf))return(0x0,promises_1[_0x1be51c(0x115)])(_0x4e99bf,'utf-8')[_0x1be51c(0x120)](JSON[_0x1be51c(0x12c)]);throw new Error(_0x1be51c(0x10f));}async[a283_0x3ba750(0x112)](){const _0x39885b=a283_0x3ba750;await(0x0,promises_1['writeFile'])(this['statePath'],JSON[_0x39885b(0x13b)](this[_0x39885b(0x11c)]));}async[a283_0x3ba750(0x12d)](){const _0x4ee7c7=a283_0x3ba750;return this[_0x4ee7c7(0x11c)]=await(0x0,promises_1[_0x4ee7c7(0x115)])(this[_0x4ee7c7(0x116)],_0x4ee7c7(0x10a))[_0x4ee7c7(0x120)](JSON[_0x4ee7c7(0x12c)]),this;}async[a283_0x3ba750(0x131)](){const _0x34e41f=a283_0x3ba750;this[_0x34e41f(0x11c)][_0x34e41f(0x133)]=logger_enums_1['JobStatus'][_0x34e41f(0x135)],this[_0x34e41f(0x11c)]['createdDate']=new Date()[_0x34e41f(0x13c)](),await this[_0x34e41f(0x112)]();}async[a283_0x3ba750(0x123)](){const _0x356309=a283_0x3ba750;this['jobState']['status']=logger_enums_1[_0x356309(0x138)]['COMPLETED'],this[_0x356309(0x11c)][_0x356309(0x117)]=new Date()[_0x356309(0x13c)](),await this[_0x356309(0x112)]();}async[a283_0x3ba750(0x125)]({message:_0x3a6beb}){const _0x489146=a283_0x3ba750;this[_0x489146(0x11c)][_0x489146(0x133)]=logger_enums_1[_0x489146(0x138)]['FAILED'],this[_0x489146(0x11c)]['completedDate']=new Date()['getTime'](),this[_0x489146(0x11c)]['error']=_0x3a6beb,await this[_0x489146(0x112)]();}['addWarning'](_0x2e998c){const _0x54181d=a283_0x3ba750;return this[_0x54181d(0x11c)][_0x54181d(0x139)][_0x54181d(0x124)](_0x2e998c),this[_0x54181d(0x112)]();}}exports[a283_0x3ba750(0x134)]=StateManager;