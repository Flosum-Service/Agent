const a283_0x2d75a2=a283_0x2211;function a283_0x5662(){const _0x374c59=['8bxIdlO','setInProgress','IN_PROGRESS','toString','getJobStatePath','parse','stringify','jobState','init','status','writeFile','20158zAImLO','__esModule','statePath','utf-8','update','addWarning','2593063YBYcpH','(((.+)+)+)+$','getJobState','then','Job\x20not\x20found.','FAILED','6nwuBbS','913775dXNQsN','88oREIdP','createdDate','404WsKyyz','6480131DIPRKi','fs/promises','../enums/logger.enums','defineProperty','9468048CeMRwN','getTime','create','push','constructor','readFile','setCompleted','4383xUTdsA','@flosum/utils','JobStatus','FsUtils','QUEUED','path','50JoxfPe','COMPLETED','warnings','770967ChJydk','apply','search','default','__importDefault','isExistsPath'];a283_0x5662=function(){return _0x374c59;};return a283_0x5662();}(function(_0x9f4d64,_0x578cac){const _0xd7872e=a283_0x2211,_0x1660ba=_0x9f4d64();while(!![]){try{const _0x50058d=-parseInt(_0xd7872e(0x1df))/0x1*(-parseInt(_0xd7872e(0x1ed))/0x2)+-parseInt(_0xd7872e(0x1c5))/0x3*(-parseInt(_0xd7872e(0x1ef))/0x4)+-parseInt(_0xd7872e(0x1ec))/0x5*(parseInt(_0xd7872e(0x1eb))/0x6)+-parseInt(_0xd7872e(0x1f0))/0x7*(parseInt(_0xd7872e(0x1d4))/0x8)+-parseInt(_0xd7872e(0x1ce))/0x9*(parseInt(_0xd7872e(0x1cb))/0xa)+parseInt(_0xd7872e(0x1e5))/0xb+parseInt(_0xd7872e(0x1f4))/0xc;if(_0x50058d===_0x578cac)break;else _0x1660ba['push'](_0x1660ba['shift']());}catch(_0x33baa5){_0x1660ba['push'](_0x1660ba['shift']());}}}(a283_0x5662,0x7f8cf));const a283_0x36cb20=(function(){let _0x2b1f9f=!![];return function(_0x15c11d,_0x296111){const _0x63def4=_0x2b1f9f?function(){const _0x4622d8=a283_0x2211;if(_0x296111){const _0xadade3=_0x296111[_0x4622d8(0x1cf)](_0x15c11d,arguments);return _0x296111=null,_0xadade3;}}:function(){};return _0x2b1f9f=![],_0x63def4;};}()),a283_0x16fa17=a283_0x36cb20(this,function(){const _0x35ac94=a283_0x2211;return a283_0x16fa17['toString']()[_0x35ac94(0x1d0)](_0x35ac94(0x1e6))[_0x35ac94(0x1d7)]()[_0x35ac94(0x1c2)](a283_0x16fa17)[_0x35ac94(0x1d0)]('(((.+)+)+)+$');});a283_0x16fa17();function a283_0x2211(_0x4d0ec2,_0x5e88b5){const _0x14a3f6=a283_0x5662();return a283_0x2211=function(_0x16fa17,_0x36cb20){_0x16fa17=_0x16fa17-0x1bf;let _0x5662bc=_0x14a3f6[_0x16fa17];return _0x5662bc;},a283_0x2211(_0x4d0ec2,_0x5e88b5);}'use strict';var __importDefault=this&&this[a283_0x2d75a2(0x1d2)]||function(_0x4d4931){const _0x1d44d9=a283_0x2d75a2;return _0x4d4931&&_0x4d4931[_0x1d44d9(0x1e0)]?_0x4d4931:{'default':_0x4d4931};};Object[a283_0x2d75a2(0x1f3)](exports,a283_0x2d75a2(0x1e0),{'value':!![]});const logger_enums_1=require(a283_0x2d75a2(0x1f2)),path_1=__importDefault(require(a283_0x2d75a2(0x1ca))),promises_1=require(a283_0x2d75a2(0x1f1)),utils_1=require(a283_0x2d75a2(0x1c6)),job_1=require('../../../constants/job');class StateManager{constructor(_0x192a92){const _0x5de3bd=a283_0x2d75a2;this[_0x5de3bd(0x1e1)]=StateManager[_0x5de3bd(0x1d8)](_0x192a92);}static[a283_0x2d75a2(0x1d8)](_0x17e745){const _0x11bc83=a283_0x2d75a2;return path_1[_0x11bc83(0x1d1)]['join'](_0x17e745,job_1['JOB_LOG_STATE_FILENAME']);}static async[a283_0x2d75a2(0x1c0)](_0x41e0b0,_0x36302b){const _0x3bc474=a283_0x2d75a2,_0x24e284=StateManager['getJobStatePath'](_0x41e0b0),_0x1a2e68={'id':_0x36302b,'status':logger_enums_1[_0x3bc474(0x1c7)][_0x3bc474(0x1c9)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x3bc474(0x1de)])(_0x24e284,JSON[_0x3bc474(0x1da)](_0x1a2e68));}static async[a283_0x2d75a2(0x1e7)](_0x4f0f95){const _0x484296=a283_0x2d75a2,_0x1b414b=StateManager['getJobStatePath'](_0x4f0f95);if(await utils_1[_0x484296(0x1c8)][_0x484296(0x1d3)](_0x1b414b))return(0x0,promises_1['readFile'])(_0x1b414b,_0x484296(0x1e2))[_0x484296(0x1e8)](JSON[_0x484296(0x1d9)]);throw new Error(_0x484296(0x1e9));}async[a283_0x2d75a2(0x1e3)](){const _0x13a367=a283_0x2d75a2;await(0x0,promises_1[_0x13a367(0x1de)])(this[_0x13a367(0x1e1)],JSON[_0x13a367(0x1da)](this['jobState']));}async[a283_0x2d75a2(0x1dc)](){const _0x355aca=a283_0x2d75a2;return this[_0x355aca(0x1db)]=await(0x0,promises_1[_0x355aca(0x1c3)])(this[_0x355aca(0x1e1)],_0x355aca(0x1e2))[_0x355aca(0x1e8)](JSON[_0x355aca(0x1d9)]),this;}async[a283_0x2d75a2(0x1d5)](){const _0x57376b=a283_0x2d75a2;this['jobState'][_0x57376b(0x1dd)]=logger_enums_1['JobStatus'][_0x57376b(0x1d6)],this[_0x57376b(0x1db)][_0x57376b(0x1ee)]=new Date()[_0x57376b(0x1bf)](),await this[_0x57376b(0x1e3)]();}async[a283_0x2d75a2(0x1c4)](){const _0x3a3ea6=a283_0x2d75a2;this[_0x3a3ea6(0x1db)][_0x3a3ea6(0x1dd)]=logger_enums_1[_0x3a3ea6(0x1c7)][_0x3a3ea6(0x1cc)],this['jobState']['completedDate']=new Date()[_0x3a3ea6(0x1bf)](),await this[_0x3a3ea6(0x1e3)]();}async['setError']({message:_0x584ef5}){const _0x57e08e=a283_0x2d75a2;this[_0x57e08e(0x1db)]['status']=logger_enums_1[_0x57e08e(0x1c7)][_0x57e08e(0x1ea)],this[_0x57e08e(0x1db)]['completedDate']=new Date()[_0x57e08e(0x1bf)](),this[_0x57e08e(0x1db)]['error']=_0x584ef5,await this['update']();}[a283_0x2d75a2(0x1e4)](_0x41a4cb){const _0x3b2e79=a283_0x2d75a2;return this[_0x3b2e79(0x1db)][_0x3b2e79(0x1cd)][_0x3b2e79(0x1c1)](_0x41a4cb),this[_0x3b2e79(0x1e3)]();}}exports[a283_0x2d75a2(0x1d1)]=StateManager;