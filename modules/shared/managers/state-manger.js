const a283_0x31d052=a283_0x6d19;function a283_0x1f1d(){const _0x347144=['utf-8','12GHqJqh','9042770ncysyf','(((.+)+)+)+$','FsUtils','COMPLETED','1368154MBTbJb','defineProperty','warnings','jobState','6vwgdwa','push','stringify','createdDate','writeFile','fs/promises','16ogRGdg','610304qlwPqU','getTime','addWarning','setInProgress','4477963jVflnc','path','3382155rgSGZP','constructor','init','QUEUED','604345JVTLtH','getJobStatePath','setCompleted','118392rquweY','status','IN_PROGRESS','JOB_LOG_STATE_FILENAME','__esModule','update','then','create','1958Ppjpzt','parse','readFile','join','JobStatus','completedDate','default','statePath','error','3sIaWtP','search','Job\x20not\x20found.'];a283_0x1f1d=function(){return _0x347144;};return a283_0x1f1d();}function a283_0x6d19(_0x4af10a,_0x32b024){const _0x556128=a283_0x1f1d();return a283_0x6d19=function(_0x31ea47,_0x438a6d){_0x31ea47=_0x31ea47-0xe7;let _0x1f1d3a=_0x556128[_0x31ea47];return _0x1f1d3a;},a283_0x6d19(_0x4af10a,_0x32b024);}(function(_0x4d3aa2,_0x242b1c){const _0x4f1ba9=a283_0x6d19,_0x31ce76=_0x4d3aa2();while(!![]){try{const _0x3c155c=-parseInt(_0x4f1ba9(0x102))/0x1+-parseInt(_0x4f1ba9(0xf7))/0x2*(parseInt(_0x4f1ba9(0xee))/0x3)+-parseInt(_0x4f1ba9(0xf2))/0x4*(parseInt(_0x4f1ba9(0x10c))/0x5)+-parseInt(_0x4f1ba9(0xfb))/0x6*(-parseInt(_0x4f1ba9(0x106))/0x7)+-parseInt(_0x4f1ba9(0x101))/0x8*(-parseInt(_0x4f1ba9(0x108))/0x9)+-parseInt(_0x4f1ba9(0xf3))/0xa+parseInt(_0x4f1ba9(0x117))/0xb*(parseInt(_0x4f1ba9(0x10f))/0xc);if(_0x3c155c===_0x242b1c)break;else _0x31ce76['push'](_0x31ce76['shift']());}catch(_0x2ce03b){_0x31ce76['push'](_0x31ce76['shift']());}}}(a283_0x1f1d,0x8f1c6));const a283_0x438a6d=(function(){let _0x24a9cb=!![];return function(_0x3e6b13,_0xaa103b){const _0x574b92=_0x24a9cb?function(){if(_0xaa103b){const _0x2ad104=_0xaa103b['apply'](_0x3e6b13,arguments);return _0xaa103b=null,_0x2ad104;}}:function(){};return _0x24a9cb=![],_0x574b92;};}()),a283_0x31ea47=a283_0x438a6d(this,function(){const _0x629db7=a283_0x6d19;return a283_0x31ea47['toString']()[_0x629db7(0xef)](_0x629db7(0xf4))['toString']()[_0x629db7(0x109)](a283_0x31ea47)[_0x629db7(0xef)]('(((.+)+)+)+$');});a283_0x31ea47();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x27d1bb){return _0x27d1bb&&_0x27d1bb['__esModule']?_0x27d1bb:{'default':_0x27d1bb};};Object[a283_0x31d052(0xf8)](exports,a283_0x31d052(0x113),{'value':!![]});const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a283_0x31d052(0x107))),promises_1=require(a283_0x31d052(0x100)),utils_1=require('@flosum/utils'),job_1=require('../../../constants/job');class StateManager{constructor(_0x538e51){const _0xf656aa=a283_0x31d052;this[_0xf656aa(0xec)]=StateManager[_0xf656aa(0x10d)](_0x538e51);}static[a283_0x31d052(0x10d)](_0x5d2c08){const _0x429f92=a283_0x31d052;return path_1['default'][_0x429f92(0xe8)](_0x5d2c08,job_1[_0x429f92(0x112)]);}static async[a283_0x31d052(0x116)](_0x516679,_0xd58e20){const _0x4edccd=a283_0x31d052,_0x2f5d5d=StateManager[_0x4edccd(0x10d)](_0x516679),_0x29c8df={'id':_0xd58e20,'status':logger_enums_1[_0x4edccd(0xe9)][_0x4edccd(0x10b)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x4edccd(0xff)])(_0x2f5d5d,JSON[_0x4edccd(0xfd)](_0x29c8df));}static async['getJobState'](_0x2fe310){const _0x550fd9=a283_0x31d052,_0x2bbca4=StateManager[_0x550fd9(0x10d)](_0x2fe310);if(await utils_1[_0x550fd9(0xf5)]['isExistsPath'](_0x2bbca4))return(0x0,promises_1[_0x550fd9(0xe7)])(_0x2bbca4,_0x550fd9(0xf1))[_0x550fd9(0x115)](JSON[_0x550fd9(0x118)]);throw new Error(_0x550fd9(0xf0));}async['update'](){const _0x398373=a283_0x31d052;await(0x0,promises_1[_0x398373(0xff)])(this[_0x398373(0xec)],JSON['stringify'](this['jobState']));}async[a283_0x31d052(0x10a)](){const _0x3175af=a283_0x31d052;return this[_0x3175af(0xfa)]=await(0x0,promises_1[_0x3175af(0xe7)])(this[_0x3175af(0xec)],_0x3175af(0xf1))[_0x3175af(0x115)](JSON['parse']),this;}async[a283_0x31d052(0x105)](){const _0x131a22=a283_0x31d052;this[_0x131a22(0xfa)][_0x131a22(0x110)]=logger_enums_1[_0x131a22(0xe9)][_0x131a22(0x111)],this[_0x131a22(0xfa)][_0x131a22(0xfe)]=new Date()[_0x131a22(0x103)](),await this[_0x131a22(0x114)]();}async[a283_0x31d052(0x10e)](){const _0x462bf5=a283_0x31d052;this[_0x462bf5(0xfa)][_0x462bf5(0x110)]=logger_enums_1[_0x462bf5(0xe9)][_0x462bf5(0xf6)],this[_0x462bf5(0xfa)][_0x462bf5(0xea)]=new Date()[_0x462bf5(0x103)](),await this[_0x462bf5(0x114)]();}async['setError']({message:_0x392ec5}){const _0x39f12f=a283_0x31d052;this[_0x39f12f(0xfa)][_0x39f12f(0x110)]=logger_enums_1[_0x39f12f(0xe9)]['FAILED'],this['jobState'][_0x39f12f(0xea)]=new Date()[_0x39f12f(0x103)](),this[_0x39f12f(0xfa)][_0x39f12f(0xed)]=_0x392ec5,await this[_0x39f12f(0x114)]();}[a283_0x31d052(0x104)](_0xc9a538){const _0x375dcf=a283_0x31d052;return this[_0x375dcf(0xfa)][_0x375dcf(0xf9)][_0x375dcf(0xfc)](_0xc9a538),this[_0x375dcf(0x114)]();}}exports[a283_0x31d052(0xeb)]=StateManager;