const a331_0x179102=a331_0x52eb;(function(_0xd16c13,_0x388946){const _0x98932e=a331_0x52eb,_0x1f21cf=_0xd16c13();while(!![]){try{const _0x5b6242=-parseInt(_0x98932e(0x69))/0x1+-parseInt(_0x98932e(0x74))/0x2+parseInt(_0x98932e(0x70))/0x3+-parseInt(_0x98932e(0x86))/0x4*(-parseInt(_0x98932e(0x7c))/0x5)+-parseInt(_0x98932e(0x75))/0x6*(-parseInt(_0x98932e(0x85))/0x7)+-parseInt(_0x98932e(0x8b))/0x8+-parseInt(_0x98932e(0x8c))/0x9*(-parseInt(_0x98932e(0x84))/0xa);if(_0x5b6242===_0x388946)break;else _0x1f21cf['push'](_0x1f21cf['shift']());}catch(_0x3f48a1){_0x1f21cf['push'](_0x1f21cf['shift']());}}}(a331_0x1eab,0xdf7b1));const a331_0x595e78=(function(){let _0x220a9c=!![];return function(_0x14fc07,_0x11a8be){const _0x54d794=_0x220a9c?function(){if(_0x11a8be){const _0x196676=_0x11a8be['apply'](_0x14fc07,arguments);return _0x11a8be=null,_0x196676;}}:function(){};return _0x220a9c=![],_0x54d794;};}()),a331_0x5133fa=a331_0x595e78(this,function(){const _0x5384f4=a331_0x52eb;return a331_0x5133fa[_0x5384f4(0x6e)]()[_0x5384f4(0x6c)]('(((.+)+)+)+$')[_0x5384f4(0x6e)]()[_0x5384f4(0x77)](a331_0x5133fa)[_0x5384f4(0x6c)](_0x5384f4(0x6b));});a331_0x5133fa();'use strict';Object['defineProperty'](exports,a331_0x179102(0x82),{'value':!![]}),exports[a331_0x179102(0x88)]=exports[a331_0x179102(0x76)]=exports[a331_0x179102(0x71)]=exports[a331_0x179102(0x80)]=exports['retrieveAttachments']=void 0x0;function a331_0x1eab(){const _0x6e6492=['push','fetchAttachments','length','get','11595832jbFrmv','18wcdvGF','ParentId','post','/query/','records','374911uMDuyj','base64','(((.+)+)+)+$','search','\x27,\x27','toString','SALESFORCE_API_VERSION','1280802ghGROu','fetchAttachmentsDetailsByParentId','../../../constants','chunkArray','1099444POVteF','2443332oArMXw','fetchAttachmentBody','constructor','namespace','join','BodyLength','./index','167725qJrsWF','Body','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20Id,\x20Name,\x20BodyLength,\x20ParentId\x0a\x20\x20\x20\x20\x20\x20FROM\x20Attachment\x0a\x20\x20\x20\x20\x20\x20WHERE\x20','retrieveAttachments','fetchAttachmentsDetailsById','arraybuffer','__esModule','/retrieveAttachments/','7389230dwwtWK','14GcFXsd','68NybJHl'];a331_0x1eab=function(){return _0x6e6492;};return a331_0x1eab();}const index_1=require(a331_0x179102(0x7b)),constants_1=require(a331_0x179102(0x72)),salesforce_request_1=require('../../functions/utils/salesforce-request'),CHUNK_QUERY_SIZE=0x1f4,REST_ATTACHMENT_MAX_SIZE=0x200000,REST_ATTACHMENT_COUNT=0x64,BINARY_FIELDS=[a331_0x179102(0x7d)],FIELD_PARENT_ID=a331_0x179102(0x8d),FIELD_ID='Id';function a331_0x52eb(_0x1b31dc,_0x325ec4){const _0x5defa8=a331_0x1eab();return a331_0x52eb=function(_0x5133fa,_0x595e78){_0x5133fa=_0x5133fa-0x66;let _0x1eabf5=_0x5defa8[_0x5133fa];return _0x1eabf5;},a331_0x52eb(_0x1b31dc,_0x325ec4);}async function retrieveAttachments(_0xf5bc23,_0x53c306){const _0x102e67=a331_0x179102;let _0x40130f=0x0,_0x3726cc=0x0,_0xa6f4f7=[];const _0x24ecb2=[];for(const _0x49ae84 of _0xf5bc23){if(_0x49ae84[_0x102e67(0x7a)]>REST_ATTACHMENT_MAX_SIZE){const _0x297963=await fetchAttachmentBody(_0x53c306,_0x49ae84['Id']);_0x24ecb2[_0x102e67(0x87)]({'id':_0x49ae84['Id'],'values':{'Body':_0x297963[_0x102e67(0x6e)](_0x102e67(0x6a))}});continue;}if(_0x49ae84[_0x102e67(0x7a)]+_0x40130f>REST_ATTACHMENT_MAX_SIZE||_0x3726cc+0x1>=REST_ATTACHMENT_COUNT){const _0x447d1f=await fetchAttachments(_0x53c306,BINARY_FIELDS,_0xa6f4f7);_0x24ecb2[_0x102e67(0x87)](..._0x447d1f),_0xa6f4f7=[],_0x40130f=0x0,_0x3726cc=0x0;}_0xa6f4f7['push'](_0x49ae84['Id']),_0x40130f+=_0x49ae84['BodyLength'],_0x3726cc++;}if(_0xa6f4f7[_0x102e67(0x89)]){const _0x247b72=await fetchAttachments(_0x53c306,BINARY_FIELDS,_0xa6f4f7);_0x24ecb2[_0x102e67(0x87)](..._0x247b72);}return _0x24ecb2;}exports[a331_0x179102(0x7f)]=retrieveAttachments;function fetchAttachmentsDetailsById(_0xefb29b,_0x5874b9){return fetchAttachmentsDetails(_0xefb29b,FIELD_ID,_0x5874b9);}exports['fetchAttachmentsDetailsById']=fetchAttachmentsDetailsById;function fetchAttachmentsDetailsByParentId(_0x271af8,_0x2ac8ff){return fetchAttachmentsDetails(_0x271af8,FIELD_PARENT_ID,_0x2ac8ff);}exports['fetchAttachmentsDetailsByParentId']=fetchAttachmentsDetailsByParentId;async function fetchAttachmentsDetails(_0x4b518e,_0x248a1b,_0x24a963){const _0x6549ea=a331_0x179102,_0x4c4300=[],_0x505c41=(0x0,index_1[_0x6549ea(0x73)])(_0x24a963,CHUNK_QUERY_SIZE);for(const _0x2d3fe2 of _0x505c41){const _0x44cde3=_0x6549ea(0x7e)+_0x248a1b+'\x20IN\x20('+('\x27'+_0x2d3fe2[_0x6549ea(0x79)](_0x6549ea(0x6d))+'\x27')+')',{data:_0x301353}=await _0x4b518e[_0x6549ea(0x8a)]('/services/data/'+constants_1[_0x6549ea(0x6f)]+_0x6549ea(0x67),{'params':{'q':_0x44cde3}});_0x4c4300[_0x6549ea(0x87)](..._0x301353[_0x6549ea(0x68)]);}return _0x4c4300;}async function fetchAttachmentBody(_0xe60375,_0x3a0771){const _0x49be51=a331_0x179102,{data:_0xbe1d4f}=await _0xe60375[_0x49be51(0x8a)]('/services/data/'+constants_1[_0x49be51(0x6f)]+'/sobjects/Attachment/'+_0x3a0771+'/body',{'responseType':_0x49be51(0x81)});return _0xbe1d4f;}exports[a331_0x179102(0x76)]=fetchAttachmentBody;async function fetchAttachments(_0x1b527e,_0x2b7897,_0xc32f52){const _0x29f1c0=a331_0x179102,{data:_0x55b36c}=await _0x1b527e[_0x29f1c0(0x66)]('/services/apexrest'+salesforce_request_1[_0x29f1c0(0x78)]+_0x29f1c0(0x83),{'objectName':'Attachment','binaryFields':_0x2b7897,'recordIds':_0xc32f52});return _0x55b36c;}exports[a331_0x179102(0x88)]=fetchAttachments;