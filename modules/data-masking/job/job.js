const a73_0x170a4f=a73_0x309d;function a73_0x3559(){const _0x30c4c3=['then','_maskingManifest','_isEnableAutomationProcessError','details','toString','gzip','writeFile','../../shared/managers/auth.manager','(((.+)+)+)+$','MaskingJob','_managerAutomationProcess','_request','from','exit','enableAutomationProcess','LoggerJobState','defineProperty','1611357RShwvX','disableAutomationProcess','jobStorePath','./classes/step/steps-creator','4179816taxkmb','default','JobStatus','./enums/logger.enums','apply','_steps','@flosum/salesforce','getManagerAutomationProcessOptions','parse','IN_PROGRESS','saveSourceAutomationProcessesBackup','2068WhxBZv','Start\x20Masking\x20Process','1mUMnaV','372282uxHCnN','constructor','base64','join','disableAutomation','execute','masking','AuthManager','__esModule','setJobStatus','_loggerJobState','LoggerDetails','kill','218068TaUCbB','search','setJobError','_loggerDetails','StepsCreator','error','systemLogger','4169880JKygmO','Finish\x20Masking\x20Process','./job-detail','initAutomationProcess','path','utf-8','readFile','jobId','ManagerAutomationProcess','Enable\x20automation\x20process','MANIFEST_FILENAME','push','COMPLETED','AUTOMATION_PROCESS_METADATA_BACKUP_FILENAME','disable','19642150AdgiTD','catch','Disable\x20automation\x20process','980orHYuK','getManifest','7FlIMau','log','message'];a73_0x3559=function(){return _0x30c4c3;};return a73_0x3559();}(function(_0x114957,_0x2fd6e5){const _0x1de9ff=a73_0x309d,_0x31ec56=_0x114957();while(!![]){try{const _0x50ff22=-parseInt(_0x1de9ff(0x1e4))/0x1*(-parseInt(_0x1de9ff(0x1f2))/0x2)+-parseInt(_0x1de9ff(0x1d3))/0x3+-parseInt(_0x1de9ff(0x1e2))/0x4*(parseInt(_0x1de9ff(0x1bd))/0x5)+-parseInt(_0x1de9ff(0x1e5))/0x6*(parseInt(_0x1de9ff(0x1bf))/0x7)+-parseInt(_0x1de9ff(0x1d7))/0x8+-parseInt(_0x1de9ff(0x1ab))/0x9+parseInt(_0x1de9ff(0x1ba))/0xa;if(_0x50ff22===_0x2fd6e5)break;else _0x31ec56['push'](_0x31ec56['shift']());}catch(_0xa57515){_0x31ec56['push'](_0x31ec56['shift']());}}}(a73_0x3559,0x5e78a));const a73_0x43758c=(function(){let _0x5d37e3=!![];return function(_0x11ac2b,_0x54e0e3){const _0x11f6ef=_0x5d37e3?function(){const _0x305b81=a73_0x309d;if(_0x54e0e3){const _0x162fdf=_0x54e0e3[_0x305b81(0x1db)](_0x11ac2b,arguments);return _0x54e0e3=null,_0x162fdf;}}:function(){};return _0x5d37e3=![],_0x11f6ef;};}()),a73_0x30ba03=a73_0x43758c(this,function(){const _0x41dd2e=a73_0x309d;return a73_0x30ba03[_0x41dd2e(0x1c6)]()[_0x41dd2e(0x1a5)]('(((.+)+)+)+$')[_0x41dd2e(0x1c6)]()[_0x41dd2e(0x1e6)](a73_0x30ba03)[_0x41dd2e(0x1a5)](_0x41dd2e(0x1ca));});a73_0x30ba03();function a73_0x309d(_0x3f0460,_0x3cbf1c){const _0x5a5625=a73_0x3559();return a73_0x309d=function(_0x30ba03,_0x43758c){_0x30ba03=_0x30ba03-0x1a5;let _0x355927=_0x5a5625[_0x30ba03];return _0x355927;},a73_0x309d(_0x3f0460,_0x3cbf1c);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x46b977){const _0x235c18=a73_0x309d;return _0x46b977&&_0x46b977[_0x235c18(0x1ed)]?_0x46b977:{'default':_0x46b977};};Object[a73_0x170a4f(0x1d2)](exports,a73_0x170a4f(0x1ed),{'value':!![]}),exports[a73_0x170a4f(0x1cb)]=void 0x0;const promises_1=require('fs/promises'),salesforce_1=require(a73_0x170a4f(0x1dd)),steps_creator_1=require(a73_0x170a4f(0x1d6)),logger_enums_1=require(a73_0x170a4f(0x1da)),logger_details_1=require('./classes/logger/logger-details'),logger_job_state_1=require('./classes/logger/logger-job-state'),job_1=require('../../../constants/job'),path_1=__importDefault(require(a73_0x170a4f(0x1af))),auth_manager_1=require(a73_0x170a4f(0x1c9)),constants_1=require('../constants'),job_detail_1=require(a73_0x170a4f(0x1ad));class MaskingJob{constructor(){const _0x44bf51=a73_0x170a4f;this[_0x44bf51(0x1c4)]=![];}async[a73_0x170a4f(0x1ae)](){const _0xb35110=a73_0x170a4f,{objectRules:_0xa90175}=this['_maskingManifest'];this[_0xb35110(0x1cc)]=new salesforce_1[(_0xb35110(0x1b3))](this['getManagerAutomationProcessOptions'](_0xa90175));}async[a73_0x170a4f(0x1eb)](){const _0x556727=a73_0x170a4f;job_detail_1['systemLogger']['log']('Start\x20Masking\x20Process'),this['_loggerDetails']['log'](_0x556727(0x1e3));const {objectRules:_0x2f27a2,libraries:_0x1dbaf4}=this[_0x556727(0x1c3)];this[_0x556727(0x1dc)]=await new steps_creator_1[(_0x556727(0x1a8))]({'loggerDetails':this[_0x556727(0x1a7)],'loggerJobState':this[_0x556727(0x1ef)],'libraries':_0x1dbaf4,'objectRules':_0x2f27a2,'request':this['_request']})['create']();for(const _0x3ed0ed of this[_0x556727(0x1dc)]){await _0x3ed0ed[_0x556727(0x1ea)]();}}[a73_0x170a4f(0x1de)](_0x584af4){const _0x5c4f77=a73_0x170a4f,_0x910f52=[],_0x1e5032=[],_0x2615d6=[],_0x3cbef9=[];for(const _0x38be29 in _0x584af4){const {isDisableProcessBuilder:_0x5931be,isDisableTrigger:_0xd6ab70,isDisableValidationRule:_0x38cb0a,isDisableWorkflow:_0x2e7563}=_0x584af4[_0x38be29][_0x5c4f77(0x1e9)];_0x5931be&&_0x2615d6['push'](_0x38be29),_0xd6ab70&&_0x910f52['push'](_0x38be29),_0x38cb0a&&_0x3cbef9[_0x5c4f77(0x1b6)](_0x38be29),_0x2e7563&&_0x1e5032[_0x5c4f77(0x1b6)](_0x38be29);}return{'instance':this[_0x5c4f77(0x1cd)],'saveSourceMetadataBackup':this[_0x5c4f77(0x1e1)],'triggersObjects':_0x910f52,'workflowsObjects':_0x1e5032,'processBuilderObjects':_0x2615d6,'validationRulesObjects':_0x3cbef9};}async[a73_0x170a4f(0x1d4)](){const _0x561c18=a73_0x170a4f;job_detail_1[_0x561c18(0x1aa)][_0x561c18(0x1c0)](_0x561c18(0x1bc)),this[_0x561c18(0x1a7)][_0x561c18(0x1c0)](_0x561c18(0x1bc)),await this[_0x561c18(0x1cc)][_0x561c18(0x1b9)]();}async[a73_0x170a4f(0x1d0)](){const _0x247214=a73_0x170a4f;!this[_0x247214(0x1c4)]&&(job_detail_1['systemLogger'][_0x247214(0x1c0)]('Enable\x20automation\x20process'),this[_0x247214(0x1a7)][_0x247214(0x1c0)](_0x247214(0x1b4)),await this[_0x247214(0x1cc)]['enable']()[_0x247214(0x1bb)](_0x1d5588=>{const _0x5eb933=_0x247214;this[_0x5eb933(0x1c4)]=!![];throw _0x1d5588;}));}async[a73_0x170a4f(0x1be)](){const _0x2ca255=a73_0x170a4f,_0xd0d1e6=await(0x0,promises_1[_0x2ca255(0x1b1)])(path_1[_0x2ca255(0x1d8)]['join'](job_detail_1[_0x2ca255(0x1d5)],job_1[_0x2ca255(0x1b5)]),{'encoding':_0x2ca255(0x1b0)});return await(0x0,promises_1['rm'])(path_1[_0x2ca255(0x1d8)][_0x2ca255(0x1e8)](job_detail_1[_0x2ca255(0x1d5)],job_1[_0x2ca255(0x1b5)]),{'recursive':!![],'force':!![]}),JSON[_0x2ca255(0x1df)](_0xd0d1e6)[_0x2ca255(0x1c5)];}[a73_0x170a4f(0x1e1)](_0x35ed1a){const _0x9a972=a73_0x170a4f;return(0x0,promises_1[_0x9a972(0x1c8)])(path_1[_0x9a972(0x1d8)]['join'](job_detail_1[_0x9a972(0x1d5)],constants_1[_0x9a972(0x1b8)]),Buffer[_0x9a972(0x1ce)](_0x35ed1a,_0x9a972(0x1e7)));}async[a73_0x170a4f(0x1ea)](){const _0x1abd51=a73_0x170a4f;this['_maskingManifest']=await this['getManifest']();const {objectRules:_0x21f125,credentials:_0x5e197d}=this[_0x1abd51(0x1c3)];this[_0x1abd51(0x1a7)]=await new logger_details_1[(_0x1abd51(0x1f0))](job_detail_1[_0x1abd51(0x1d5)],job_detail_1[_0x1abd51(0x1b2)])['init'](),this[_0x1abd51(0x1ef)]=await new logger_job_state_1[(_0x1abd51(0x1d1))](job_detail_1[_0x1abd51(0x1d5)],job_detail_1[_0x1abd51(0x1b2)])['init'](Object['keys'](_0x21f125));try{this['_loggerJobState'][_0x1abd51(0x1ee)](logger_enums_1['JobStatus'][_0x1abd51(0x1e0)]),this[_0x1abd51(0x1cd)]=await salesforce_1['AxiosInstanceUtils']['create'](new auth_manager_1[(_0x1abd51(0x1ec))](_0x5e197d),[],{'headers':{'Accept-Encoding':_0x1abd51(0x1c7)}}),await this[_0x1abd51(0x1ae)](),await this[_0x1abd51(0x1d4)](),await this[_0x1abd51(0x1eb)](),await this[_0x1abd51(0x1d0)](),this[_0x1abd51(0x1ef)]['setJobStatus'](logger_enums_1[_0x1abd51(0x1d9)][_0x1abd51(0x1b7)]);}catch(_0x5157a0){await this['enableAutomationProcess']()[_0x1abd51(0x1bb)](_0x5131dd=>{const _0x569b31=_0x1abd51;job_detail_1[_0x569b31(0x1aa)][_0x569b31(0x1a9)](_0x5131dd[_0x569b31(0x1c1)]);}),this[_0x1abd51(0x1a7)]['exception'](_0x5157a0['message']),this[_0x1abd51(0x1ef)][_0x1abd51(0x1ee)](logger_enums_1['JobStatus']['FAILED']),this[_0x1abd51(0x1ef)][_0x1abd51(0x1a6)](_0x5157a0[_0x1abd51(0x1c1)]),job_detail_1['systemLogger'][_0x1abd51(0x1a9)](_0x5157a0['message']);}finally{this[_0x1abd51(0x1a7)][_0x1abd51(0x1c0)](_0x1abd51(0x1ac)),job_detail_1[_0x1abd51(0x1aa)][_0x1abd51(0x1c0)](_0x1abd51(0x1ac)),await this[_0x1abd51(0x1ef)][_0x1abd51(0x1f1)](),await this[_0x1abd51(0x1a7)][_0x1abd51(0x1f1)]();}}}exports[a73_0x170a4f(0x1cb)]=MaskingJob,new MaskingJob()[a73_0x170a4f(0x1ea)]()[a73_0x170a4f(0x1c2)](()=>process[a73_0x170a4f(0x1cf)](0x0))[a73_0x170a4f(0x1bb)](()=>process['exit'](0x1));