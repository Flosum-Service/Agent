const a73_0x536a39=a73_0x4d9e;(function(_0x570c1d,_0x12b6b4){const _0x130cee=a73_0x4d9e,_0x44fffa=_0x570c1d();while(!![]){try{const _0x3db89b=-parseInt(_0x130cee(0xa7))/0x1*(-parseInt(_0x130cee(0xb8))/0x2)+parseInt(_0x130cee(0xc3))/0x3+parseInt(_0x130cee(0xe0))/0x4+-parseInt(_0x130cee(0xc8))/0x5+-parseInt(_0x130cee(0xad))/0x6+parseInt(_0x130cee(0xf3))/0x7+-parseInt(_0x130cee(0xbd))/0x8*(parseInt(_0x130cee(0xd6))/0x9);if(_0x3db89b===_0x12b6b4)break;else _0x44fffa['push'](_0x44fffa['shift']());}catch(_0x5dbad5){_0x44fffa['push'](_0x44fffa['shift']());}}}(a73_0x5582,0xa254e));function a73_0x4d9e(_0x2fbd8f,_0x48bddf){const _0x2dffe3=a73_0x5582();return a73_0x4d9e=function(_0x280537,_0x11f97e){_0x280537=_0x280537-0xa6;let _0x558263=_0x2dffe3[_0x280537];return _0x558263;},a73_0x4d9e(_0x2fbd8f,_0x48bddf);}const a73_0x11f97e=(function(){let _0x3296ec=!![];return function(_0x3e8d11,_0x573140){const _0x236d3c=_0x3296ec?function(){if(_0x573140){const _0x5bd556=_0x573140['apply'](_0x3e8d11,arguments);return _0x573140=null,_0x5bd556;}}:function(){};return _0x3296ec=![],_0x236d3c;};}()),a73_0x280537=a73_0x11f97e(this,function(){const _0x502b34=a73_0x4d9e;return a73_0x280537['toString']()[_0x502b34(0xc9)](_0x502b34(0xc5))['toString']()[_0x502b34(0xab)](a73_0x280537)[_0x502b34(0xc9)](_0x502b34(0xc5));});a73_0x280537();'use strict';var __importDefault=this&&this[a73_0x536a39(0xba)]||function(_0x2492c2){return _0x2492c2&&_0x2492c2['__esModule']?_0x2492c2:{'default':_0x2492c2};};Object[a73_0x536a39(0xbb)](exports,a73_0x536a39(0xb1),{'value':!![]}),exports[a73_0x536a39(0xc6)]=void 0x0;function a73_0x5582(){const _0x1f481b=['AuthManager','2163344FEqiDa','Disable\x20automation\x20process','StepsCreator','IN_PROGRESS','log','getManagerAutomationProcessOptions','LoggerDetails','./classes/logger/logger-details','path','catch','kill','writeFile','disableAutomationProcess','base64','COMPLETED','details','./classes/logger/logger-job-state','masking','enable','2301929Mgeood','disable','AxiosInstanceUtils','189989HyPDFJ','_steps','_isEnableAutomationProcessError','message','constructor','exit','567252dTCZcH','jobId','_loggerJobState','../../../constants/job','__esModule','MANIFEST_FILENAME','_maskingManifest','gzip','setJobError','keys','../constants','4CkCgzp','_request','__importDefault','defineProperty','saveSourceAutomationProcessesBackup','322648tgkWGl','utf-8','_loggerDetails','then','getManifest','disableAutomation','2387046wsAJlw','join','(((.+)+)+)+$','MaskingJob','setJobStatus','6227800xvjJap','search','FAILED','systemLogger','AUTOMATION_PROCESS_METADATA_BACKUP_FILENAME','Enable\x20automation\x20process','fs/promises','exception','ManagerAutomationProcess','default','initAutomationProcess','_managerAutomationProcess','create','execute','9ewpRwb','from','Start\x20Masking\x20Process','init','push','jobStorePath','Finish\x20Masking\x20Process','error','JobStatus'];a73_0x5582=function(){return _0x1f481b;};return a73_0x5582();}const promises_1=require(a73_0x536a39(0xce)),salesforce_1=require('@flosum/salesforce'),steps_creator_1=require('./classes/step/steps-creator'),logger_enums_1=require('./enums/logger.enums'),logger_details_1=require(a73_0x536a39(0xe7)),logger_job_state_1=require(a73_0x536a39(0xf0)),job_1=require(a73_0x536a39(0xb0)),path_1=__importDefault(require(a73_0x536a39(0xe8))),auth_manager_1=require('../../shared/managers/auth.manager'),constants_1=require(a73_0x536a39(0xb7)),job_detail_1=require('./job-detail');class MaskingJob{constructor(){const _0x27d829=a73_0x536a39;this[_0x27d829(0xa9)]=![];}async[a73_0x536a39(0xd2)](){const _0x5483eb=a73_0x536a39,{objectRules:_0x524526}=this[_0x5483eb(0xb3)];this['_managerAutomationProcess']=new salesforce_1[(_0x5483eb(0xd0))](this[_0x5483eb(0xe5)](_0x524526));}async['masking'](){const _0x535196=a73_0x536a39;job_detail_1['systemLogger']['log'](_0x535196(0xd8)),this[_0x535196(0xbf)]['log'](_0x535196(0xd8));const {objectRules:_0x27c715,libraries:_0x57435f}=this[_0x535196(0xb3)];this[_0x535196(0xa8)]=await new steps_creator_1[(_0x535196(0xe2))]({'loggerDetails':this['_loggerDetails'],'loggerJobState':this[_0x535196(0xaf)],'libraries':_0x57435f,'objectRules':_0x27c715,'request':this[_0x535196(0xb9)]})[_0x535196(0xd4)]();for(const _0xd72f5e of this[_0x535196(0xa8)]){await _0xd72f5e[_0x535196(0xd5)]();}}[a73_0x536a39(0xe5)](_0x9d4b6f){const _0x4257bd=a73_0x536a39,_0x39a7db=[],_0x4196cd=[],_0x25636a=[],_0x33872e=[];for(const _0x550830 in _0x9d4b6f){const {isDisableProcessBuilder:_0x5be267,isDisableTrigger:_0x170af8,isDisableValidationRule:_0xda95f3,isDisableWorkflow:_0x58b6e9}=_0x9d4b6f[_0x550830][_0x4257bd(0xc2)];_0x5be267&&_0x25636a[_0x4257bd(0xda)](_0x550830),_0x170af8&&_0x39a7db['push'](_0x550830),_0xda95f3&&_0x33872e[_0x4257bd(0xda)](_0x550830),_0x58b6e9&&_0x4196cd['push'](_0x550830);}return{'instance':this['_request'],'saveSourceMetadataBackup':this[_0x4257bd(0xbc)],'triggersObjects':_0x39a7db,'workflowsObjects':_0x4196cd,'processBuilderObjects':_0x25636a,'validationRulesObjects':_0x33872e};}async[a73_0x536a39(0xec)](){const _0x579474=a73_0x536a39;job_detail_1[_0x579474(0xcb)][_0x579474(0xe4)](_0x579474(0xe1)),this['_loggerDetails']['log'](_0x579474(0xe1)),await this[_0x579474(0xd3)][_0x579474(0xf4)]();}async['enableAutomationProcess'](){const _0x3be10b=a73_0x536a39;!this[_0x3be10b(0xa9)]&&(job_detail_1['systemLogger'][_0x3be10b(0xe4)](_0x3be10b(0xcd)),this[_0x3be10b(0xbf)][_0x3be10b(0xe4)](_0x3be10b(0xcd)),await this['_managerAutomationProcess'][_0x3be10b(0xf2)]()['catch'](_0x10c637=>{const _0x378f08=_0x3be10b;this[_0x378f08(0xa9)]=!![];throw _0x10c637;}));}async[a73_0x536a39(0xc1)](){const _0x36d195=a73_0x536a39,_0x4089da=await(0x0,promises_1['readFile'])(path_1[_0x36d195(0xd1)][_0x36d195(0xc4)](job_detail_1['jobStorePath'],job_1[_0x36d195(0xb2)]),{'encoding':_0x36d195(0xbe)});return await(0x0,promises_1['rm'])(path_1[_0x36d195(0xd1)][_0x36d195(0xc4)](job_detail_1[_0x36d195(0xdb)],job_1[_0x36d195(0xb2)]),{'recursive':!![],'force':!![]}),JSON['parse'](_0x4089da)[_0x36d195(0xef)];}['saveSourceAutomationProcessesBackup'](_0x51170c){const _0x397d62=a73_0x536a39;return(0x0,promises_1[_0x397d62(0xeb)])(path_1[_0x397d62(0xd1)]['join'](job_detail_1[_0x397d62(0xdb)],constants_1[_0x397d62(0xcc)]),Buffer[_0x397d62(0xd7)](_0x51170c,_0x397d62(0xed)));}async['execute'](){const _0x34e720=a73_0x536a39;this['_maskingManifest']=await this[_0x34e720(0xc1)]();const {objectRules:_0x45c42f,credentials:_0x4014b3}=this['_maskingManifest'];this[_0x34e720(0xbf)]=await new logger_details_1[(_0x34e720(0xe6))](job_detail_1[_0x34e720(0xdb)],job_detail_1['jobId'])[_0x34e720(0xd9)](),this[_0x34e720(0xaf)]=await new logger_job_state_1['LoggerJobState'](job_detail_1[_0x34e720(0xdb)],job_detail_1[_0x34e720(0xae)])['init'](Object[_0x34e720(0xb6)](_0x45c42f));try{this['_loggerJobState']['setJobStatus'](logger_enums_1['JobStatus'][_0x34e720(0xe3)]),this[_0x34e720(0xb9)]=await salesforce_1[_0x34e720(0xa6)]['create'](new auth_manager_1[(_0x34e720(0xdf))](_0x4014b3),[],{'headers':{'Accept-Encoding':_0x34e720(0xb4)}}),await this[_0x34e720(0xd2)](),await this[_0x34e720(0xec)](),await this[_0x34e720(0xf1)](),await this['enableAutomationProcess'](),this[_0x34e720(0xaf)][_0x34e720(0xc7)](logger_enums_1[_0x34e720(0xde)][_0x34e720(0xee)]);}catch(_0x56f600){await this['enableAutomationProcess']()[_0x34e720(0xe9)](_0xdb32f1=>{const _0x5e52c2=_0x34e720;job_detail_1[_0x5e52c2(0xcb)][_0x5e52c2(0xdd)](_0xdb32f1[_0x5e52c2(0xaa)]);}),this[_0x34e720(0xbf)][_0x34e720(0xcf)](_0x56f600[_0x34e720(0xaa)]),this[_0x34e720(0xaf)]['setJobStatus'](logger_enums_1[_0x34e720(0xde)][_0x34e720(0xca)]),this[_0x34e720(0xaf)][_0x34e720(0xb5)](_0x56f600[_0x34e720(0xaa)]),job_detail_1['systemLogger'][_0x34e720(0xdd)](_0x56f600[_0x34e720(0xaa)]);}finally{this[_0x34e720(0xbf)][_0x34e720(0xe4)]('Finish\x20Masking\x20Process'),job_detail_1[_0x34e720(0xcb)][_0x34e720(0xe4)](_0x34e720(0xdc)),await this[_0x34e720(0xaf)][_0x34e720(0xea)](),await this[_0x34e720(0xbf)]['kill']();}}}exports[a73_0x536a39(0xc6)]=MaskingJob,new MaskingJob()['execute']()[a73_0x536a39(0xc0)](()=>process[a73_0x536a39(0xac)](0x0))[a73_0x536a39(0xe9)](()=>process['exit'](0x1));