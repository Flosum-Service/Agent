const a73_0xdf306b=a73_0x4e0b;function a73_0x17d1(){const _0x4575f4=['_loggerJobState','JobStatus','AxiosInstanceUtils','ManagerAutomationProcess','../constants','__esModule','writeFile','disableAutomation','path','@flosum/salesforce','initAutomationProcess','from','getManifest','429028AFYmjs','__importDefault','28653CVdQzv','search','utf-8','error','constructor','./job-detail','723080KgmGIQ','_request','jobId','keys','execute','124LtfrSq','init','Disable\x20automation\x20process','default','MaskingJob','StepsCreator','400036kPWOnz','masking','then','join','_loggerDetails','24IwXSKl','jobStorePath','push','Enable\x20automation\x20process','catch','6FlQCPD','toString','gzip','_maskingManifest','log','getManagerAutomationProcessOptions','11429340KTIzXZ','604773rcKRIv','exit','base64','./enums/logger.enums','LoggerDetails','44ldZeuH','MANIFEST_FILENAME','./classes/logger/logger-job-state','details','COMPLETED','systemLogger','_managerAutomationProcess','../../shared/managers/auth.manager','(((.+)+)+)+$','message','_steps','parse','readFile','setJobStatus','AuthManager','apply','FAILED','./classes/logger/logger-details','2AJxCqO','Finish\x20Masking\x20Process','enable','IN_PROGRESS','Start\x20Masking\x20Process','enableAutomationProcess','AUTOMATION_PROCESS_METADATA_BACKUP_FILENAME','create','kill','disable','saveSourceAutomationProcessesBackup','_isEnableAutomationProcessError','215870pbtJig'];a73_0x17d1=function(){return _0x4575f4;};return a73_0x17d1();}(function(_0x491c63,_0x5e9301){const _0xfeee5=a73_0x4e0b,_0x536112=_0x491c63();while(!![]){try{const _0x5ea02d=parseInt(_0xfeee5(0x169))/0x1*(-parseInt(_0xfeee5(0x183))/0x2)+parseInt(_0xfeee5(0x185))/0x3*(-parseInt(_0xfeee5(0x190))/0x4)+-parseInt(_0xfeee5(0x18b))/0x5*(-parseInt(_0xfeee5(0x1a0))/0x6)+-parseInt(_0xfeee5(0x196))/0x7*(parseInt(_0xfeee5(0x19b))/0x8)+-parseInt(_0xfeee5(0x1a7))/0x9+-parseInt(_0xfeee5(0x175))/0xa*(-parseInt(_0xfeee5(0x1ac))/0xb)+parseInt(_0xfeee5(0x1a6))/0xc;if(_0x5ea02d===_0x5e9301)break;else _0x536112['push'](_0x536112['shift']());}catch(_0x3beeee){_0x536112['push'](_0x536112['shift']());}}}(a73_0x17d1,0x35a0b));function a73_0x4e0b(_0x399dac,_0x59ebd4){const _0x19485a=a73_0x17d1();return a73_0x4e0b=function(_0x2815e8,_0x687580){_0x2815e8=_0x2815e8-0x161;let _0x17d158=_0x19485a[_0x2815e8];return _0x17d158;},a73_0x4e0b(_0x399dac,_0x59ebd4);}const a73_0x687580=(function(){let _0x1ea5a2=!![];return function(_0x4e30f0,_0x1dfe39){const _0x1e5aea=_0x1ea5a2?function(){const _0xf74044=a73_0x4e0b;if(_0x1dfe39){const _0xac89f4=_0x1dfe39[_0xf74044(0x166)](_0x4e30f0,arguments);return _0x1dfe39=null,_0xac89f4;}}:function(){};return _0x1ea5a2=![],_0x1e5aea;};}()),a73_0x2815e8=a73_0x687580(this,function(){const _0x4bacd3=a73_0x4e0b;return a73_0x2815e8[_0x4bacd3(0x1a1)]()[_0x4bacd3(0x186)](_0x4bacd3(0x1b4))[_0x4bacd3(0x1a1)]()[_0x4bacd3(0x189)](a73_0x2815e8)[_0x4bacd3(0x186)](_0x4bacd3(0x1b4));});a73_0x2815e8();'use strict';var __importDefault=this&&this[a73_0xdf306b(0x184)]||function(_0x4fb409){const _0x3265f9=a73_0xdf306b;return _0x4fb409&&_0x4fb409[_0x3265f9(0x17b)]?_0x4fb409:{'default':_0x4fb409};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a73_0xdf306b(0x194)]=void 0x0;const promises_1=require('fs/promises'),salesforce_1=require(a73_0xdf306b(0x17f)),steps_creator_1=require('./classes/step/steps-creator'),logger_enums_1=require(a73_0xdf306b(0x1aa)),logger_details_1=require(a73_0xdf306b(0x168)),logger_job_state_1=require(a73_0xdf306b(0x1ae)),job_1=require('../../../constants/job'),path_1=__importDefault(require(a73_0xdf306b(0x17e))),auth_manager_1=require(a73_0xdf306b(0x1b3)),constants_1=require(a73_0xdf306b(0x17a)),job_detail_1=require(a73_0xdf306b(0x18a));class MaskingJob{constructor(){const _0x9ca4a5=a73_0xdf306b;this[_0x9ca4a5(0x174)]=![];}async[a73_0xdf306b(0x180)](){const _0x98d71b=a73_0xdf306b,{objectRules:_0x733f5c}=this[_0x98d71b(0x1a3)];this['_managerAutomationProcess']=new salesforce_1[(_0x98d71b(0x179))](this['getManagerAutomationProcessOptions'](_0x733f5c));}async[a73_0xdf306b(0x197)](){const _0x1d7c39=a73_0xdf306b;job_detail_1[_0x1d7c39(0x1b1)][_0x1d7c39(0x1a4)](_0x1d7c39(0x16d)),this[_0x1d7c39(0x19a)]['log'](_0x1d7c39(0x16d));const {objectRules:_0x17f33d,libraries:_0x424c7d}=this['_maskingManifest'];this[_0x1d7c39(0x161)]=await new steps_creator_1[(_0x1d7c39(0x195))]({'loggerDetails':this[_0x1d7c39(0x19a)],'loggerJobState':this[_0x1d7c39(0x176)],'libraries':_0x424c7d,'objectRules':_0x17f33d,'request':this['_request']})[_0x1d7c39(0x170)]();for(const _0x507e9d of this['_steps']){await _0x507e9d[_0x1d7c39(0x18f)]();}}[a73_0xdf306b(0x1a5)](_0x3b03b7){const _0x3e56d1=a73_0xdf306b,_0x176e1a=[],_0x6ffbea=[],_0x358505=[],_0x30c894=[];for(const _0x542674 in _0x3b03b7){const {isDisableProcessBuilder:_0x31f3e4,isDisableTrigger:_0x5e027c,isDisableValidationRule:_0x183bee,isDisableWorkflow:_0x316cdb}=_0x3b03b7[_0x542674][_0x3e56d1(0x17d)];_0x31f3e4&&_0x358505[_0x3e56d1(0x19d)](_0x542674),_0x5e027c&&_0x176e1a['push'](_0x542674),_0x183bee&&_0x30c894['push'](_0x542674),_0x316cdb&&_0x6ffbea[_0x3e56d1(0x19d)](_0x542674);}return{'instance':this[_0x3e56d1(0x18c)],'saveSourceMetadataBackup':this['saveSourceAutomationProcessesBackup'],'triggersObjects':_0x176e1a,'workflowsObjects':_0x6ffbea,'processBuilderObjects':_0x358505,'validationRulesObjects':_0x30c894};}async['disableAutomationProcess'](){const _0x59cc94=a73_0xdf306b;job_detail_1[_0x59cc94(0x1b1)][_0x59cc94(0x1a4)](_0x59cc94(0x192)),this[_0x59cc94(0x19a)]['log']('Disable\x20automation\x20process'),await this[_0x59cc94(0x1b2)][_0x59cc94(0x172)]();}async['enableAutomationProcess'](){const _0x550683=a73_0xdf306b;!this[_0x550683(0x174)]&&(job_detail_1[_0x550683(0x1b1)]['log'](_0x550683(0x19e)),this[_0x550683(0x19a)][_0x550683(0x1a4)](_0x550683(0x19e)),await this[_0x550683(0x1b2)][_0x550683(0x16b)]()[_0x550683(0x19f)](_0x1bb0ad=>{const _0x9bb5e9=_0x550683;this[_0x9bb5e9(0x174)]=!![];throw _0x1bb0ad;}));}async[a73_0xdf306b(0x182)](){const _0x3a35d1=a73_0xdf306b,_0x5ea87e=await(0x0,promises_1[_0x3a35d1(0x163)])(path_1[_0x3a35d1(0x193)][_0x3a35d1(0x199)](job_detail_1[_0x3a35d1(0x19c)],job_1[_0x3a35d1(0x1ad)]),{'encoding':_0x3a35d1(0x187)});return await(0x0,promises_1['rm'])(path_1[_0x3a35d1(0x193)]['join'](job_detail_1[_0x3a35d1(0x19c)],job_1[_0x3a35d1(0x1ad)]),{'recursive':!![],'force':!![]}),JSON[_0x3a35d1(0x162)](_0x5ea87e)[_0x3a35d1(0x1af)];}[a73_0xdf306b(0x173)](_0x3f0700){const _0x3b4534=a73_0xdf306b;return(0x0,promises_1[_0x3b4534(0x17c)])(path_1[_0x3b4534(0x193)][_0x3b4534(0x199)](job_detail_1[_0x3b4534(0x19c)],constants_1[_0x3b4534(0x16f)]),Buffer[_0x3b4534(0x181)](_0x3f0700,_0x3b4534(0x1a9)));}async['execute'](){const _0x3bda6a=a73_0xdf306b;this[_0x3bda6a(0x1a3)]=await this[_0x3bda6a(0x182)]();const {objectRules:_0x5493bd,credentials:_0x4f22af}=this['_maskingManifest'];this[_0x3bda6a(0x19a)]=await new logger_details_1[(_0x3bda6a(0x1ab))](job_detail_1['jobStorePath'],job_detail_1[_0x3bda6a(0x18d)])[_0x3bda6a(0x191)](),this[_0x3bda6a(0x176)]=await new logger_job_state_1['LoggerJobState'](job_detail_1[_0x3bda6a(0x19c)],job_detail_1['jobId'])[_0x3bda6a(0x191)](Object[_0x3bda6a(0x18e)](_0x5493bd));try{this[_0x3bda6a(0x176)][_0x3bda6a(0x164)](logger_enums_1['JobStatus'][_0x3bda6a(0x16c)]),this[_0x3bda6a(0x18c)]=await salesforce_1[_0x3bda6a(0x178)]['create'](new auth_manager_1[(_0x3bda6a(0x165))](_0x4f22af),[],{'headers':{'Accept-Encoding':_0x3bda6a(0x1a2)}}),await this[_0x3bda6a(0x180)](),await this['disableAutomationProcess'](),await this[_0x3bda6a(0x197)](),await this[_0x3bda6a(0x16e)](),this[_0x3bda6a(0x176)]['setJobStatus'](logger_enums_1[_0x3bda6a(0x177)][_0x3bda6a(0x1b0)]);}catch(_0x1fbb90){await this[_0x3bda6a(0x16e)]()[_0x3bda6a(0x19f)](_0x3af288=>{const _0x200956=_0x3bda6a;job_detail_1['systemLogger'][_0x200956(0x188)](_0x3af288[_0x200956(0x1b5)]);}),this[_0x3bda6a(0x19a)]['exception'](_0x1fbb90[_0x3bda6a(0x1b5)]),this[_0x3bda6a(0x176)][_0x3bda6a(0x164)](logger_enums_1['JobStatus'][_0x3bda6a(0x167)]),this[_0x3bda6a(0x176)]['setJobError'](_0x1fbb90[_0x3bda6a(0x1b5)]),job_detail_1[_0x3bda6a(0x1b1)][_0x3bda6a(0x188)](_0x1fbb90[_0x3bda6a(0x1b5)]);}finally{this[_0x3bda6a(0x19a)][_0x3bda6a(0x1a4)]('Finish\x20Masking\x20Process'),job_detail_1[_0x3bda6a(0x1b1)]['log'](_0x3bda6a(0x16a)),await this['_loggerJobState'][_0x3bda6a(0x171)](),await this[_0x3bda6a(0x19a)][_0x3bda6a(0x171)]();}}}exports['MaskingJob']=MaskingJob,new MaskingJob()[a73_0xdf306b(0x18f)]()[a73_0xdf306b(0x198)](()=>process[a73_0xdf306b(0x1a8)](0x0))[a73_0xdf306b(0x19f)](()=>process[a73_0xdf306b(0x1a8)](0x1));