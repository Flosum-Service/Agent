const a91_0x1edd81=a91_0x304c;(function(_0x2c019b,_0x491239){const _0xc8b66d=a91_0x304c,_0x473e4f=_0x2c019b();while(!![]){try{const _0x5175dd=parseInt(_0xc8b66d(0x1f8))/0x1+parseInt(_0xc8b66d(0x1fc))/0x2+parseInt(_0xc8b66d(0x1de))/0x3*(-parseInt(_0xc8b66d(0x1d7))/0x4)+-parseInt(_0xc8b66d(0x1fe))/0x5+-parseInt(_0xc8b66d(0x211))/0x6*(-parseInt(_0xc8b66d(0x1e6))/0x7)+parseInt(_0xc8b66d(0x20c))/0x8*(parseInt(_0xc8b66d(0x1e9))/0x9)+-parseInt(_0xc8b66d(0x1e3))/0xa;if(_0x5175dd===_0x491239)break;else _0x473e4f['push'](_0x473e4f['shift']());}catch(_0x7aaba9){_0x473e4f['push'](_0x473e4f['shift']());}}}(a91_0x2956,0xd0c33));const a91_0xb77e14=(function(){let _0xbbdc48=!![];return function(_0x481acc,_0x48f273){const _0x3b1dd2=_0xbbdc48?function(){if(_0x48f273){const _0x309d72=_0x48f273['apply'](_0x481acc,arguments);return _0x48f273=null,_0x309d72;}}:function(){};return _0xbbdc48=![],_0x3b1dd2;};}()),a91_0xeba372=a91_0xb77e14(this,function(){const _0x4740c2=a91_0x304c;return a91_0xeba372[_0x4740c2(0x1f0)]()[_0x4740c2(0x1e7)]('(((.+)+)+)+$')['toString']()['constructor'](a91_0xeba372)['search'](_0x4740c2(0x1cf));});a91_0xeba372();'use strict';var __importDefault=this&&this[a91_0x1edd81(0x1fb)]||function(_0x1793ae){return _0x1793ae&&_0x1793ae['__esModule']?_0x1793ae:{'default':_0x1793ae};};function a91_0x304c(_0x11cd6b,_0x35f005){const _0x70cf9f=a91_0x2956();return a91_0x304c=function(_0xeba372,_0xb77e14){_0xeba372=_0xeba372-0x1cd;let _0x29564a=_0x70cf9f[_0xeba372];return _0x29564a;},a91_0x304c(_0x11cd6b,_0x35f005);}Object[a91_0x1edd81(0x1f2)](exports,a91_0x1edd81(0x1e2),{'value':!![]}),exports[a91_0x1edd81(0x1d9)]=void 0x0;const base_retrieve_1=require('./base-retrieve'),stream_1=require('stream'),path_1=__importDefault(require('path')),utils_1=require(a91_0x1edd81(0x205)),promises_1=require('fs/promises'),fs_1=__importDefault(require('fs')),promises_2=require(a91_0x1edd81(0x1d8)),crypto_1=require(a91_0x1edd81(0x1fd)),csv_parse_1=require(a91_0x1edd81(0x207)),salesforce_1=require(a91_0x1edd81(0x1ff)),job_detail_1=require(a91_0x1edd81(0x1ef)),constants_1=require('../../constants');class BaseBulkRetrieve extends base_retrieve_1[a91_0x1edd81(0x1d3)]{get[a91_0x1edd81(0x209)](){const _0x1135a3=a91_0x1edd81;return{'queryBuilder':this[_0x1135a3(0x203)],'instance':this['request'],'api':constants_1['SALESFORCE_API_VERSION'],'contentType':salesforce_1[_0x1135a3(0x213)]['TEXT_CSV']};}async[a91_0x1edd81(0x1db)](){const _0x59a93a=a91_0x1edd81;var _0x4b86ab,_0x1efc89;if(this[_0x59a93a(0x1e0)][_0x59a93a(0x201)]()&&!((_0x4b86ab=this['csvParser'])===null||_0x4b86ab===void 0x0?void 0x0:_0x4b86ab[_0x59a93a(0x1d1)]())){this[_0x59a93a(0x20b)](null);return;}if((_0x1efc89=this[_0x59a93a(0x1ed)])===null||_0x1efc89===void 0x0?void 0x0:_0x1efc89[_0x59a93a(0x1d1)]()){this[_0x59a93a(0x1ed)][_0x59a93a(0x202)]();return;}const _0x1013f5=await this['retrieve'][_0x59a93a(0x1ea)]();if(!_0x1013f5)return this[_0x59a93a(0x1db)]();await this[_0x59a93a(0x20d)](_0x1013f5);}async[a91_0x1edd81(0x20d)](_0x2484c4){const _0x384313=a91_0x1edd81,_0x1a036f=path_1[_0x384313(0x206)]['join'](job_detail_1[_0x384313(0x208)],(0x0,crypto_1['randomUUID'])()),_0x58138c=(0x0,crypto_1[_0x384313(0x1d2)])(),_0x13e512=await this['writeEncryptedTempFile'](_0x2484c4,_0x1a036f,_0x58138c)['then'](()=>this[_0x384313(0x1e5)](_0x1a036f,_0x58138c)),_0x173959={'columns':!![],'cast':this[_0x384313(0x1ee)]['bind'](this)};this[_0x384313(0x1ed)]=(0x0,stream_1[_0x384313(0x1da)])(_0x13e512,(0x0,csv_parse_1[_0x384313(0x1e4)])(_0x173959),this[_0x384313(0x20e)][_0x384313(0x214)](this,_0x1a036f)),this[_0x384313(0x1ed)]['on'](_0x384313(0x1d5),_0x364f7d=>{const _0x370a90=_0x384313;this[_0x370a90(0x1ed)]['pause'](),this[_0x370a90(0x20b)](_0x364f7d);}),this[_0x384313(0x1ed)]['on'](_0x384313(0x1f3),async()=>{const _0x3cf7f7=_0x384313;return await utils_1[_0x3cf7f7(0x1f5)]['isExistsPath'](_0x1a036f)&&await(0x0,promises_1['rm'])(_0x1a036f)['catch'](this[_0x3cf7f7(0x1cd)][_0x3cf7f7(0x214)](this,null)),this[_0x3cf7f7(0x1e1)]();}),this[_0x384313(0x1ed)]['on']('error',this[_0x384313(0x20e)][_0x384313(0x214)](this,_0x1a036f));}async['writeEncryptedTempFile'](_0x2d6871,_0x694242,_0x44e1ec){const _0x32e006=a91_0x1edd81,_0x185b12=fs_1[_0x32e006(0x206)][_0x32e006(0x1d0)](_0x694242);await(0x0,promises_2[_0x32e006(0x1da)])(_0x2d6871,utils_1['CryptoUtils'][_0x32e006(0x20a)](_0x44e1ec),_0x185b12);}async[a91_0x1edd81(0x1e5)](_0x42cabe,_0x25859a){const _0x212f23=a91_0x1edd81,_0x207bd0=fs_1[_0x212f23(0x206)]['createReadStream'](_0x42cabe),_0x14cf25=await this[_0x212f23(0x1ec)](_0x207bd0),_0x26d254=utils_1[_0x212f23(0x1f7)][_0x212f23(0x1dd)](_0x25859a,_0x14cf25);return(0x0,stream_1[_0x212f23(0x1da)])(_0x207bd0,_0x26d254,this[_0x212f23(0x20e)][_0x212f23(0x214)](this,_0x42cabe));}async['pipelineCallback'](_0x1bc01a,_0x36da91){const _0x120b42=a91_0x1edd81;_0x36da91&&await this[_0x120b42(0x1cd)](_0x1bc01a,_0x36da91);}async[a91_0x1edd81(0x1cd)](_0x179c91,_0x12b856){const _0x2fd543=a91_0x1edd81;_0x179c91&&await utils_1[_0x2fd543(0x1f5)][_0x2fd543(0x1df)](_0x179c91)&&await(0x0,promises_1['rm'])(_0x179c91)['catch'](_0xd7554b=>job_detail_1[_0x2fd543(0x1f4)]['error'](_0xd7554b)),this[_0x2fd543(0x215)](_0x12b856);}async['readEncryptionVector'](_0xecb69c){return new Promise((_0xfa0ccc,_0x414ebf)=>{const _0x566d0d=a91_0x304c;_0xecb69c['once'](_0x566d0d(0x1eb),_0x414ebf),_0xecb69c[_0x566d0d(0x1f9)](_0x566d0d(0x1ce),()=>{const _0xd931b6=_0xecb69c['read'](0x10);_0xfa0ccc(_0xd931b6);});});}[a91_0x1edd81(0x1ee)](_0x3776f4,{header:_0x473f5d,column:_0x1c88bb}){const _0xb34b55=a91_0x1edd81;!this[_0xb34b55(0x204)]&&(this['_fieldsTypes']=this[_0xb34b55(0x1f6)][_0xb34b55(0x200)][_0xb34b55(0x216)]((_0x35ba34,{name:_0x3c3e8f,type:_0x238de3})=>_0x35ba34['set'](_0x3c3e8f,_0x238de3),new Map()));if(_0x473f5d)return _0x3776f4;if(!_0x3776f4)return null;switch(this['_fieldsTypes'][_0xb34b55(0x1e8)](_0x1c88bb)){case'datetime':return _0x3776f4[_0xb34b55(0x1dc)](/\.\d{3}Z$/,_0xb34b55(0x1f1));case _0xb34b55(0x1d6):return _0x3776f4==='true';case _0xb34b55(0x20f):case _0xb34b55(0x212):case _0xb34b55(0x1fa):case _0xb34b55(0x1d4):return+_0x3776f4;default:return _0x3776f4;}}}function a91_0x2956(){const _0x12930b=['end','systemLogger','FsUtils','describe','CryptoUtils','89238pSewUv','once','int','__importDefault','939620HOvTtP','crypto','7137450nuXwgT','@flosum/salesforce','fields','getIsDone','resume','queryBuilder','_fieldsTypes','@flosum/utils','default','csv-parse','jobStorePath','baseRetrievePayload','createEncryptPipe','push','6488uFoXNt','createReader','pipelineCallback','currency','POLL_INTERVAL','85062NgFxXI','double','BulkV1QueryContentType','bind','destroy','reduce','handleError','readable','(((.+)+)+)+$','createWriteStream','isPaused','randomUUID','BaseRetrieve','percent','data','boolean','12brzBzU','stream/promises','BaseBulkRetrieve','pipeline','pull','replace','createDecryptPipe','108726aMTPei','isExistsPath','retrieve','_read','__esModule','3392760KpaoiB','parse','readEncryptedTempFile','329qohuDi','search','get','16704UcduUL','execute','error','readEncryptionVector','csvParser','castCsvValue','../job-detail','toString','.000+0000','defineProperty'];a91_0x2956=function(){return _0x12930b;};return a91_0x2956();}exports['BaseBulkRetrieve']=BaseBulkRetrieve,BaseBulkRetrieve[a91_0x1edd81(0x210)]=0x1388;