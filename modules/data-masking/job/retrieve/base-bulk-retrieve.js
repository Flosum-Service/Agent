const a75_0x5c5072=a75_0x2f75;(function(_0x24844c,_0x57a21b){const _0x44501e=a75_0x2f75,_0x4d53db=_0x24844c();while(!![]){try{const _0x379387=parseInt(_0x44501e(0xdb))/0x1*(-parseInt(_0x44501e(0x100))/0x2)+-parseInt(_0x44501e(0x105))/0x3+-parseInt(_0x44501e(0xdc))/0x4+-parseInt(_0x44501e(0x112))/0x5+-parseInt(_0x44501e(0xe4))/0x6*(-parseInt(_0x44501e(0xf7))/0x7)+parseInt(_0x44501e(0x109))/0x8+parseInt(_0x44501e(0x103))/0x9;if(_0x379387===_0x57a21b)break;else _0x4d53db['push'](_0x4d53db['shift']());}catch(_0x2098f9){_0x4d53db['push'](_0x4d53db['shift']());}}}(a75_0x5207,0xbc4a8));function a75_0x2f75(_0x2421e1,_0x2e60d1){const _0x5d1bd2=a75_0x5207();return a75_0x2f75=function(_0x1059f2,_0x2c6045){_0x1059f2=_0x1059f2-0xca;let _0x52074b=_0x5d1bd2[_0x1059f2];return _0x52074b;},a75_0x2f75(_0x2421e1,_0x2e60d1);}const a75_0x2c6045=(function(){let _0x5cd5b1=!![];return function(_0x53d323,_0x5be2c8){const _0x3561e2=_0x5cd5b1?function(){const _0x107d8c=a75_0x2f75;if(_0x5be2c8){const _0x2a19a4=_0x5be2c8[_0x107d8c(0x116)](_0x53d323,arguments);return _0x5be2c8=null,_0x2a19a4;}}:function(){};return _0x5cd5b1=![],_0x3561e2;};}()),a75_0x1059f2=a75_0x2c6045(this,function(){const _0x110c54=a75_0x2f75;return a75_0x1059f2[_0x110c54(0xec)]()['search'](_0x110c54(0xda))[_0x110c54(0xec)]()[_0x110c54(0x111)](a75_0x1059f2)[_0x110c54(0xd0)]('(((.+)+)+)+$');});a75_0x1059f2();'use strict';var __importDefault=this&&this[a75_0x5c5072(0xeb)]||function(_0xf25396){return _0xf25396&&_0xf25396['__esModule']?_0xf25396:{'default':_0xf25396};};Object['defineProperty'](exports,a75_0x5c5072(0xee),{'value':!![]}),exports['BaseBulkRetrieve']=void 0x0;function a75_0x5207(){const _0x72e790=['resume','1294FhldKg','isPaused','BaseRetrieve','28229562XwiVsM','queryBuilder','4455786fuqcTm','_read','boolean','error','7280544XFWEIO','destroy','createEncryptPipe','SALESFORCE_API_VERSION','fs/promises','FsUtils','true','randomUUID','constructor','6916120epmZOZ','double','TEXT_CSV','BulkV1QueryContentType','apply','parse','createWriteStream','read','createReader','fields','@flosum/salesforce','search','baseRetrievePayload','handleError','pull','createDecryptPipe','bind','int','once','catch','stream','(((.+)+)+)+$','252QqUpnW','4328620sqgvod','BaseBulkRetrieve','../job-detail','jobStorePath','csvParser','push','CryptoUtils','get','18CyRJww','path','reduce','./base-retrieve','data','POLL_INTERVAL','end','__importDefault','toString','crypto','__esModule','set','pipelineCallback','readable','default','_fieldsTypes','then','execute','retrieve','1955891FQmxjH','pause','castCsvValue','readEncryptedTempFile','readEncryptionVector','percent','currency','csv-parse'];a75_0x5207=function(){return _0x72e790;};return a75_0x5207();}const base_retrieve_1=require(a75_0x5c5072(0xe7)),stream_1=require(a75_0x5c5072(0xd9)),path_1=__importDefault(require(a75_0x5c5072(0xe5))),utils_1=require('@flosum/utils'),promises_1=require(a75_0x5c5072(0x10d)),fs_1=__importDefault(require('fs')),promises_2=require('stream/promises'),crypto_1=require(a75_0x5c5072(0xed)),csv_parse_1=require(a75_0x5c5072(0xfe)),salesforce_1=require(a75_0x5c5072(0xcf)),job_detail_1=require(a75_0x5c5072(0xde)),constants_1=require('../../constants');class BaseBulkRetrieve extends base_retrieve_1[a75_0x5c5072(0x102)]{get[a75_0x5c5072(0xd1)](){const _0x3f6196=a75_0x5c5072;return{'queryBuilder':this[_0x3f6196(0x104)],'instance':this['request'],'api':constants_1[_0x3f6196(0x10c)],'contentType':salesforce_1[_0x3f6196(0x115)][_0x3f6196(0x114)]};}async[a75_0x5c5072(0xd3)](){const _0x1fc999=a75_0x5c5072;var _0x1edf5f,_0x3f020f;if(this[_0x1fc999(0xf6)]['getIsDone']()&&!((_0x1edf5f=this[_0x1fc999(0xe0)])===null||_0x1edf5f===void 0x0?void 0x0:_0x1edf5f[_0x1fc999(0x101)]())){this[_0x1fc999(0xe1)](null);return;}if((_0x3f020f=this[_0x1fc999(0xe0)])===null||_0x3f020f===void 0x0?void 0x0:_0x3f020f[_0x1fc999(0x101)]()){this['csvParser'][_0x1fc999(0xff)]();return;}const _0x5a34cc=await this[_0x1fc999(0xf6)][_0x1fc999(0xf5)]();if(!_0x5a34cc)return this['pull']();await this[_0x1fc999(0xcd)](_0x5a34cc);}async[a75_0x5c5072(0xcd)](_0xa26dd1){const _0x2963ed=a75_0x5c5072,_0x5b9117=path_1[_0x2963ed(0xf2)]['join'](job_detail_1[_0x2963ed(0xdf)],(0x0,crypto_1[_0x2963ed(0x110)])()),_0x332d34=(0x0,crypto_1[_0x2963ed(0x110)])(),_0x3548c5=await this['writeEncryptedTempFile'](_0xa26dd1,_0x5b9117,_0x332d34)[_0x2963ed(0xf4)](()=>this['readEncryptedTempFile'](_0x5b9117,_0x332d34)),_0x34bd44={'columns':!![],'cast':this[_0x2963ed(0xf9)][_0x2963ed(0xd5)](this)};this[_0x2963ed(0xe0)]=(0x0,stream_1['pipeline'])(_0x3548c5,(0x0,csv_parse_1[_0x2963ed(0xca)])(_0x34bd44),this[_0x2963ed(0xf0)][_0x2963ed(0xd5)](this,_0x5b9117)),this[_0x2963ed(0xe0)]['on'](_0x2963ed(0xe8),_0xd9e2f=>{const _0x9906f4=_0x2963ed;this[_0x9906f4(0xe0)][_0x9906f4(0xf8)](),this[_0x9906f4(0xe1)](_0xd9e2f);}),this[_0x2963ed(0xe0)]['on'](_0x2963ed(0xea),async()=>{const _0x90dc71=_0x2963ed;return await utils_1[_0x90dc71(0x10e)]['isExistsPath'](_0x5b9117)&&await(0x0,promises_1['rm'])(_0x5b9117)[_0x90dc71(0xd8)](this[_0x90dc71(0xd2)][_0x90dc71(0xd5)](this,null)),this[_0x90dc71(0x106)]();}),this['csvParser']['on'](_0x2963ed(0x108),this[_0x2963ed(0xf0)][_0x2963ed(0xd5)](this,_0x5b9117));}async['writeEncryptedTempFile'](_0x5e8745,_0x52f050,_0x20bf26){const _0x147a60=a75_0x5c5072,_0x107719=fs_1[_0x147a60(0xf2)][_0x147a60(0xcb)](_0x52f050);await(0x0,promises_2['pipeline'])(_0x5e8745,utils_1[_0x147a60(0xe2)][_0x147a60(0x10b)](_0x20bf26),_0x107719);}async[a75_0x5c5072(0xfa)](_0x152c43,_0x54166c){const _0x49c068=a75_0x5c5072,_0xde41f2=fs_1[_0x49c068(0xf2)]['createReadStream'](_0x152c43),_0x28b886=await this[_0x49c068(0xfb)](_0xde41f2),_0xf85d94=utils_1['CryptoUtils'][_0x49c068(0xd4)](_0x54166c,_0x28b886);return(0x0,stream_1['pipeline'])(_0xde41f2,_0xf85d94,this[_0x49c068(0xf0)]['bind'](this,_0x152c43));}async[a75_0x5c5072(0xf0)](_0x12a938,_0x21bdd1){const _0x4b32e4=a75_0x5c5072;_0x21bdd1&&await this[_0x4b32e4(0xd2)](_0x12a938,_0x21bdd1);}async[a75_0x5c5072(0xd2)](_0x21397c,_0x1f6e7c){const _0xbb028=a75_0x5c5072;_0x21397c&&await utils_1[_0xbb028(0x10e)]['isExistsPath'](_0x21397c)&&await(0x0,promises_1['rm'])(_0x21397c)[_0xbb028(0xd8)](_0x43388d=>job_detail_1['systemLogger'][_0xbb028(0x108)](_0x43388d)),this[_0xbb028(0x10a)](_0x1f6e7c);}async['readEncryptionVector'](_0x29d33a){return new Promise((_0x439860,_0x3774c4)=>{const _0x52ac14=a75_0x2f75;_0x29d33a[_0x52ac14(0xd7)](_0x52ac14(0x108),_0x3774c4),_0x29d33a['once'](_0x52ac14(0xf1),()=>{const _0x15ec6b=_0x52ac14,_0x461621=_0x29d33a[_0x15ec6b(0xcc)](0x10);_0x439860(_0x461621);});});}[a75_0x5c5072(0xf9)](_0x4dfdf5,{header:_0x411012,column:_0x104b91}){const _0x4ce6d4=a75_0x5c5072;!this[_0x4ce6d4(0xf3)]&&(this[_0x4ce6d4(0xf3)]=this['describe'][_0x4ce6d4(0xce)][_0x4ce6d4(0xe6)]((_0x3349ff,{name:_0x3bd4ae,type:_0x3cf10f})=>_0x3349ff[_0x4ce6d4(0xef)](_0x3bd4ae,_0x3cf10f),new Map()));if(_0x411012)return _0x4dfdf5;if(!_0x4dfdf5)return null;switch(this['_fieldsTypes'][_0x4ce6d4(0xe3)](_0x104b91)){case'datetime':return _0x4dfdf5['replace'](/\.\d{3}Z$/,'.000+0000');case _0x4ce6d4(0x107):return _0x4dfdf5===_0x4ce6d4(0x10f);case _0x4ce6d4(0xfd):case _0x4ce6d4(0x113):case _0x4ce6d4(0xd6):case _0x4ce6d4(0xfc):return+_0x4dfdf5;default:return _0x4dfdf5;}}}exports[a75_0x5c5072(0xdd)]=BaseBulkRetrieve,BaseBulkRetrieve[a75_0x5c5072(0xe9)]=0x1388;