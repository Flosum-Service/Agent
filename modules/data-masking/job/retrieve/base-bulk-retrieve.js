const a91_0x5ae60b=a91_0x3ca4;(function(_0x5777ec,_0x41f000){const _0x6cc730=a91_0x3ca4,_0x1ecfb8=_0x5777ec();while(!![]){try{const _0x4de8f6=-parseInt(_0x6cc730(0x186))/0x1+parseInt(_0x6cc730(0x1b7))/0x2+-parseInt(_0x6cc730(0x1a2))/0x3+-parseInt(_0x6cc730(0x17d))/0x4*(parseInt(_0x6cc730(0x194))/0x5)+-parseInt(_0x6cc730(0x1a9))/0x6*(-parseInt(_0x6cc730(0x1a7))/0x7)+parseInt(_0x6cc730(0x1aa))/0x8*(parseInt(_0x6cc730(0x18e))/0x9)+parseInt(_0x6cc730(0x192))/0xa;if(_0x4de8f6===_0x41f000)break;else _0x1ecfb8['push'](_0x1ecfb8['shift']());}catch(_0x536b6a){_0x1ecfb8['push'](_0x1ecfb8['shift']());}}}(a91_0x535c,0xbeb5b));const a91_0x552a04=(function(){let _0x18967c=!![];return function(_0x1a7705,_0x5e592b){const _0x57e086=_0x18967c?function(){const _0x28a046=a91_0x3ca4;if(_0x5e592b){const _0x1fa4a1=_0x5e592b[_0x28a046(0x181)](_0x1a7705,arguments);return _0x5e592b=null,_0x1fa4a1;}}:function(){};return _0x18967c=![],_0x57e086;};}()),a91_0x1ca6ab=a91_0x552a04(this,function(){const _0x544f99=a91_0x3ca4;return a91_0x1ca6ab['toString']()[_0x544f99(0x1c1)](_0x544f99(0x1b3))[_0x544f99(0x1b8)]()[_0x544f99(0x196)](a91_0x1ca6ab)[_0x544f99(0x1c1)](_0x544f99(0x1b3));});a91_0x1ca6ab();function a91_0x3ca4(_0x3260f8,_0x42ea42){const _0x1bd9d2=a91_0x535c();return a91_0x3ca4=function(_0x1ca6ab,_0x552a04){_0x1ca6ab=_0x1ca6ab-0x174;let _0x535c38=_0x1bd9d2[_0x1ca6ab];return _0x535c38;},a91_0x3ca4(_0x3260f8,_0x42ea42);}function a91_0x535c(){const _0x3acf54=['search','stream','end','crypto','systemLogger','pull','__esModule','pipelineCallback','handleError','stream/promises','get','4njabYU','__importDefault','FsUtils','isExistsPath','apply','resume','createReader','createWriteStream','read','109433Jgjbhp','readable','getIsDone','true','currency','_read','push','bind','1368XwYdNS','error','castCsvValue','./base-retrieve','7651460EyiRcg','default','1512445VIrbbi','BaseBulkRetrieve','constructor','fields','_fieldsTypes','then','join','double','set','baseRetrievePayload','@flosum/utils','TEXT_CSV','once','POLL_INTERVAL','3715740zOZSmx','request','path','writeEncryptedTempFile','boolean','194418aYPIiD','percent','150nvFpBU','34904QHunLE','isPaused','csv-parse','readEncryptedTempFile','queryBuilder','readEncryptionVector','pause','createDecryptPipe','createReadStream','(((.+)+)+)+$','data','createEncryptPipe','BaseRetrieve','617954vibSIS','toString','csvParser','pipeline','fs/promises','randomUUID','destroy','../../constants','CryptoUtils','reduce'];a91_0x535c=function(){return _0x3acf54;};return a91_0x535c();}'use strict';var __importDefault=this&&this[a91_0x5ae60b(0x17e)]||function(_0xf3cf95){return _0xf3cf95&&_0xf3cf95['__esModule']?_0xf3cf95:{'default':_0xf3cf95};};Object['defineProperty'](exports,a91_0x5ae60b(0x178),{'value':!![]}),exports[a91_0x5ae60b(0x195)]=void 0x0;const base_retrieve_1=require(a91_0x5ae60b(0x191)),stream_1=require(a91_0x5ae60b(0x1c2)),path_1=__importDefault(require(a91_0x5ae60b(0x1a4))),utils_1=require(a91_0x5ae60b(0x19e)),promises_1=require(a91_0x5ae60b(0x1bb)),fs_1=__importDefault(require('fs')),promises_2=require(a91_0x5ae60b(0x17b)),crypto_1=require(a91_0x5ae60b(0x175)),csv_parse_1=require(a91_0x5ae60b(0x1ac)),salesforce_1=require('@flosum/salesforce'),job_detail_1=require('../job-detail'),constants_1=require(a91_0x5ae60b(0x1be));class BaseBulkRetrieve extends base_retrieve_1[a91_0x5ae60b(0x1b6)]{get[a91_0x5ae60b(0x19d)](){const _0x89ace1=a91_0x5ae60b;return{'queryBuilder':this[_0x89ace1(0x1ae)],'instance':this[_0x89ace1(0x1a3)],'api':constants_1['SALESFORCE_API_VERSION'],'contentType':salesforce_1['BulkV1QueryContentType'][_0x89ace1(0x19f)]};}async[a91_0x5ae60b(0x177)](){const _0x1fe8f5=a91_0x5ae60b;var _0x1e6b4a,_0x1a1c85;if(this['retrieve'][_0x1fe8f5(0x188)]()&&!((_0x1e6b4a=this[_0x1fe8f5(0x1b9)])===null||_0x1e6b4a===void 0x0?void 0x0:_0x1e6b4a[_0x1fe8f5(0x1ab)]())){this[_0x1fe8f5(0x18c)](null);return;}if((_0x1a1c85=this['csvParser'])===null||_0x1a1c85===void 0x0?void 0x0:_0x1a1c85[_0x1fe8f5(0x1ab)]()){this[_0x1fe8f5(0x1b9)][_0x1fe8f5(0x182)]();return;}const _0x47b4da=await this['retrieve']['execute']();if(!_0x47b4da)return this[_0x1fe8f5(0x177)]();await this[_0x1fe8f5(0x183)](_0x47b4da);}async['createReader'](_0x169f35){const _0x5cb6f9=a91_0x5ae60b,_0x10dc0a=path_1[_0x5cb6f9(0x193)][_0x5cb6f9(0x19a)](job_detail_1['jobStorePath'],(0x0,crypto_1[_0x5cb6f9(0x1bc)])()),_0x1c4efb=(0x0,crypto_1['randomUUID'])(),_0x4f3625=await this[_0x5cb6f9(0x1a5)](_0x169f35,_0x10dc0a,_0x1c4efb)[_0x5cb6f9(0x199)](()=>this[_0x5cb6f9(0x1ad)](_0x10dc0a,_0x1c4efb)),_0x383523={'columns':!![],'cast':this[_0x5cb6f9(0x190)]['bind'](this)};this[_0x5cb6f9(0x1b9)]=(0x0,stream_1[_0x5cb6f9(0x1ba)])(_0x4f3625,(0x0,csv_parse_1['parse'])(_0x383523),this['pipelineCallback'][_0x5cb6f9(0x18d)](this,_0x10dc0a)),this['csvParser']['on'](_0x5cb6f9(0x1b4),_0x242e74=>{const _0x88a14c=_0x5cb6f9;this[_0x88a14c(0x1b9)][_0x88a14c(0x1b0)](),this['push'](_0x242e74);}),this[_0x5cb6f9(0x1b9)]['on'](_0x5cb6f9(0x174),async()=>{const _0x3452bc=_0x5cb6f9;return await utils_1[_0x3452bc(0x17f)][_0x3452bc(0x180)](_0x10dc0a)&&await(0x0,promises_1['rm'])(_0x10dc0a)['catch'](this[_0x3452bc(0x17a)][_0x3452bc(0x18d)](this,null)),this[_0x3452bc(0x18b)]();}),this[_0x5cb6f9(0x1b9)]['on'](_0x5cb6f9(0x18f),this['pipelineCallback'][_0x5cb6f9(0x18d)](this,_0x10dc0a));}async[a91_0x5ae60b(0x1a5)](_0x515a88,_0xcd428b,_0x2509a1){const _0x47fc2e=a91_0x5ae60b,_0x33e486=fs_1[_0x47fc2e(0x193)][_0x47fc2e(0x184)](_0xcd428b);await(0x0,promises_2['pipeline'])(_0x515a88,utils_1[_0x47fc2e(0x1bf)][_0x47fc2e(0x1b5)](_0x2509a1),_0x33e486);}async[a91_0x5ae60b(0x1ad)](_0x4d70bd,_0x55a5e8){const _0x4d686b=a91_0x5ae60b,_0x11b42e=fs_1[_0x4d686b(0x193)][_0x4d686b(0x1b2)](_0x4d70bd),_0x1da0b0=await this[_0x4d686b(0x1af)](_0x11b42e),_0x1d8dd0=utils_1[_0x4d686b(0x1bf)][_0x4d686b(0x1b1)](_0x55a5e8,_0x1da0b0);return(0x0,stream_1[_0x4d686b(0x1ba)])(_0x11b42e,_0x1d8dd0,this[_0x4d686b(0x179)][_0x4d686b(0x18d)](this,_0x4d70bd));}async['pipelineCallback'](_0x2cb2d2,_0x52e7be){const _0x52e91c=a91_0x5ae60b;_0x52e7be&&await this[_0x52e91c(0x17a)](_0x2cb2d2,_0x52e7be);}async['handleError'](_0x25ad88,_0x43006f){const _0x130c30=a91_0x5ae60b;_0x25ad88&&await utils_1[_0x130c30(0x17f)]['isExistsPath'](_0x25ad88)&&await(0x0,promises_1['rm'])(_0x25ad88)['catch'](_0x392fb6=>job_detail_1[_0x130c30(0x176)][_0x130c30(0x18f)](_0x392fb6)),this[_0x130c30(0x1bd)](_0x43006f);}async[a91_0x5ae60b(0x1af)](_0x57048b){return new Promise((_0x29bb88,_0x150b13)=>{const _0x19dc07=a91_0x3ca4;_0x57048b[_0x19dc07(0x1a0)](_0x19dc07(0x18f),_0x150b13),_0x57048b[_0x19dc07(0x1a0)](_0x19dc07(0x187),()=>{const _0xe73643=_0x19dc07,_0x457496=_0x57048b[_0xe73643(0x185)](0x10);_0x29bb88(_0x457496);});});}['castCsvValue'](_0x3d5c00,{header:_0x23d727,column:_0x27f1b3}){const _0x481427=a91_0x5ae60b;!this['_fieldsTypes']&&(this[_0x481427(0x198)]=this['describe'][_0x481427(0x197)][_0x481427(0x1c0)]((_0x283a15,{name:_0x573eab,type:_0x5123cc})=>_0x283a15[_0x481427(0x19c)](_0x573eab,_0x5123cc),new Map()));if(_0x23d727)return _0x3d5c00;if(!_0x3d5c00)return null;switch(this[_0x481427(0x198)][_0x481427(0x17c)](_0x27f1b3)){case'datetime':return _0x3d5c00['replace'](/\.\d{3}Z$/,'.000+0000');case _0x481427(0x1a6):return _0x3d5c00===_0x481427(0x189);case _0x481427(0x18a):case _0x481427(0x19b):case'int':case _0x481427(0x1a8):return+_0x3d5c00;default:return _0x3d5c00;}}}exports[a91_0x5ae60b(0x195)]=BaseBulkRetrieve,BaseBulkRetrieve[a91_0x5ae60b(0x1a1)]=0x1388;