const a75_0x4d3688=a75_0xab2e;function a75_0x1cf5(){const _0x51aa0d=['currency','1258434aucEQy','stream','get','describe','BaseBulkRetrieve','createEncryptPipe','_fieldsTypes','set','catch','destroy','queryBuilder','read','readEncryptedTempFile','data','(((.+)+)+)+$','reduce','138dPBiVB','@flosum/salesforce','pull','readEncryptionVector','12qjLhFM','7rFAZbU','pipelineCallback','../../constants','./base-retrieve','33324MgwtoR','isExistsPath','push','boolean','randomUUID','int','3176555wizngw','BaseRetrieve','createDecryptPipe','readable','../job-detail','error','pipeline','jobStorePath','handleError','path','castCsvValue','defineProperty','baseRetrievePayload','FsUtils','datetime','fs/promises','91786hAjZrE','csvParser','then','431189yWbvdu','execute','systemLogger','constructor','fields','crypto','retrieve','double','apply','true','stream/promises','__importDefault','.000+0000','CryptoUtils','bind','default','search','once','getIsDone','18DliDng','@flosum/utils','6cUCJSZ','isPaused','1841120AubIio','_read','replace','request','createWriteStream','toString','2853510ATexeJ','createReadStream','createReader','resume','writeEncryptedTempFile'];a75_0x1cf5=function(){return _0x51aa0d;};return a75_0x1cf5();}(function(_0x25f1f1,_0x2ed978){const _0x33dd36=a75_0xab2e,_0x122eba=_0x25f1f1();while(!![]){try{const _0x3b5f02=parseInt(_0x33dd36(0x177))/0x1*(-parseInt(_0x33dd36(0x18f))/0x2)+parseInt(_0x33dd36(0x1ad))/0x3*(parseInt(_0x33dd36(0x1b6))/0x4)+parseInt(_0x33dd36(0x167))/0x5+parseInt(_0x33dd36(0x19d))/0x6*(-parseInt(_0x33dd36(0x1b2))/0x7)+parseInt(_0x33dd36(0x191))/0x8*(-parseInt(_0x33dd36(0x18d))/0x9)+parseInt(_0x33dd36(0x197))/0xa+-parseInt(_0x33dd36(0x17a))/0xb*(parseInt(_0x33dd36(0x1b1))/0xc);if(_0x3b5f02===_0x2ed978)break;else _0x122eba['push'](_0x122eba['shift']());}catch(_0x249fb5){_0x122eba['push'](_0x122eba['shift']());}}}(a75_0x1cf5,0x4df50));const a75_0x2e039d=(function(){let _0x33354d=!![];return function(_0x394fc9,_0x24f800){const _0x859018=_0x33354d?function(){const _0xd10b54=a75_0xab2e;if(_0x24f800){const _0x2557f6=_0x24f800[_0xd10b54(0x182)](_0x394fc9,arguments);return _0x24f800=null,_0x2557f6;}}:function(){};return _0x33354d=![],_0x859018;};}()),a75_0x12d28e=a75_0x2e039d(this,function(){const _0x55c912=a75_0xab2e;return a75_0x12d28e[_0x55c912(0x196)]()['search'](_0x55c912(0x1ab))[_0x55c912(0x196)]()[_0x55c912(0x17d)](a75_0x12d28e)[_0x55c912(0x18a)](_0x55c912(0x1ab));});a75_0x12d28e();function a75_0xab2e(_0x582ced,_0x36c3ee){const _0x50c76e=a75_0x1cf5();return a75_0xab2e=function(_0x12d28e,_0x2e039d){_0x12d28e=_0x12d28e-0x164;let _0x1cf590=_0x50c76e[_0x12d28e];return _0x1cf590;},a75_0xab2e(_0x582ced,_0x36c3ee);}'use strict';var __importDefault=this&&this[a75_0x4d3688(0x185)]||function(_0x4d9a7a){return _0x4d9a7a&&_0x4d9a7a['__esModule']?_0x4d9a7a:{'default':_0x4d9a7a};};Object[a75_0x4d3688(0x172)](exports,'__esModule',{'value':!![]}),exports[a75_0x4d3688(0x1a1)]=void 0x0;const base_retrieve_1=require(a75_0x4d3688(0x1b5)),stream_1=require(a75_0x4d3688(0x19e)),path_1=__importDefault(require(a75_0x4d3688(0x170))),utils_1=require(a75_0x4d3688(0x18e)),promises_1=require(a75_0x4d3688(0x176)),fs_1=__importDefault(require('fs')),promises_2=require(a75_0x4d3688(0x184)),crypto_1=require(a75_0x4d3688(0x17f)),csv_parse_1=require('csv-parse'),salesforce_1=require(a75_0x4d3688(0x1ae)),job_detail_1=require(a75_0x4d3688(0x16b)),constants_1=require(a75_0x4d3688(0x1b4));class BaseBulkRetrieve extends base_retrieve_1[a75_0x4d3688(0x168)]{get[a75_0x4d3688(0x173)](){const _0x2877ae=a75_0x4d3688;return{'queryBuilder':this[_0x2877ae(0x1a7)],'instance':this[_0x2877ae(0x194)],'api':constants_1['SALESFORCE_API_VERSION'],'contentType':salesforce_1['BulkV1QueryContentType']['TEXT_CSV']};}async[a75_0x4d3688(0x1af)](){const _0xd763e3=a75_0x4d3688;var _0x33c00d,_0x44eaac;if(this[_0xd763e3(0x180)][_0xd763e3(0x18c)]()&&!((_0x33c00d=this['csvParser'])===null||_0x33c00d===void 0x0?void 0x0:_0x33c00d['isPaused']())){this[_0xd763e3(0x1b8)](null);return;}if((_0x44eaac=this[_0xd763e3(0x178)])===null||_0x44eaac===void 0x0?void 0x0:_0x44eaac[_0xd763e3(0x190)]()){this[_0xd763e3(0x178)][_0xd763e3(0x19a)]();return;}const _0x577e0e=await this[_0xd763e3(0x180)][_0xd763e3(0x17b)]();if(!_0x577e0e)return this['pull']();await this['createReader'](_0x577e0e);}async[a75_0x4d3688(0x199)](_0x1e164f){const _0x2e37c3=a75_0x4d3688,_0x31a359=path_1[_0x2e37c3(0x189)]['join'](job_detail_1[_0x2e37c3(0x16e)],(0x0,crypto_1[_0x2e37c3(0x165)])()),_0x47631c=(0x0,crypto_1[_0x2e37c3(0x165)])(),_0x41895b=await this[_0x2e37c3(0x19b)](_0x1e164f,_0x31a359,_0x47631c)[_0x2e37c3(0x179)](()=>this[_0x2e37c3(0x1a9)](_0x31a359,_0x47631c)),_0x51c457={'columns':!![],'cast':this[_0x2e37c3(0x171)][_0x2e37c3(0x188)](this)};this[_0x2e37c3(0x178)]=(0x0,stream_1[_0x2e37c3(0x16d)])(_0x41895b,(0x0,csv_parse_1['parse'])(_0x51c457),this[_0x2e37c3(0x1b3)][_0x2e37c3(0x188)](this,_0x31a359)),this[_0x2e37c3(0x178)]['on'](_0x2e37c3(0x1aa),_0x1237ed=>{const _0x54d67e=_0x2e37c3;this[_0x54d67e(0x178)]['pause'](),this[_0x54d67e(0x1b8)](_0x1237ed);}),this[_0x2e37c3(0x178)]['on']('end',async()=>{const _0x2a806c=_0x2e37c3;return await utils_1[_0x2a806c(0x174)][_0x2a806c(0x1b7)](_0x31a359)&&await(0x0,promises_1['rm'])(_0x31a359)[_0x2a806c(0x1a5)](this['handleError'][_0x2a806c(0x188)](this,null)),this[_0x2a806c(0x192)]();}),this[_0x2e37c3(0x178)]['on']('error',this['pipelineCallback'][_0x2e37c3(0x188)](this,_0x31a359));}async['writeEncryptedTempFile'](_0x274f78,_0x2c1418,_0x473b93){const _0x40a46b=a75_0x4d3688,_0x110a15=fs_1['default'][_0x40a46b(0x195)](_0x2c1418);await(0x0,promises_2[_0x40a46b(0x16d)])(_0x274f78,utils_1[_0x40a46b(0x187)][_0x40a46b(0x1a2)](_0x473b93),_0x110a15);}async['readEncryptedTempFile'](_0x58c928,_0x20d957){const _0x309792=a75_0x4d3688,_0x54ccf7=fs_1[_0x309792(0x189)][_0x309792(0x198)](_0x58c928),_0x10ade=await this[_0x309792(0x1b0)](_0x54ccf7),_0x23e743=utils_1['CryptoUtils'][_0x309792(0x169)](_0x20d957,_0x10ade);return(0x0,stream_1[_0x309792(0x16d)])(_0x54ccf7,_0x23e743,this['pipelineCallback'][_0x309792(0x188)](this,_0x58c928));}async['pipelineCallback'](_0x5679c8,_0x32d62d){const _0xaef6a7=a75_0x4d3688;_0x32d62d&&await this[_0xaef6a7(0x16f)](_0x5679c8,_0x32d62d);}async['handleError'](_0x314156,_0x5eaba0){const _0x6c183e=a75_0x4d3688;_0x314156&&await utils_1['FsUtils']['isExistsPath'](_0x314156)&&await(0x0,promises_1['rm'])(_0x314156)['catch'](_0x5e707d=>job_detail_1[_0x6c183e(0x17c)][_0x6c183e(0x16c)](_0x5e707d)),this[_0x6c183e(0x1a6)](_0x5eaba0);}async['readEncryptionVector'](_0x419bb3){return new Promise((_0xd4f2ef,_0x1107c9)=>{const _0x5b3c2f=a75_0xab2e;_0x419bb3['once'](_0x5b3c2f(0x16c),_0x1107c9),_0x419bb3[_0x5b3c2f(0x18b)](_0x5b3c2f(0x16a),()=>{const _0x167d40=_0x5b3c2f,_0x16656e=_0x419bb3[_0x167d40(0x1a8)](0x10);_0xd4f2ef(_0x16656e);});});}['castCsvValue'](_0x4ba049,{header:_0x4f867c,column:_0x393993}){const _0x3ef084=a75_0x4d3688;!this[_0x3ef084(0x1a3)]&&(this[_0x3ef084(0x1a3)]=this[_0x3ef084(0x1a0)][_0x3ef084(0x17e)][_0x3ef084(0x1ac)]((_0x2239fe,{name:_0x5bf995,type:_0x57b80b})=>_0x2239fe[_0x3ef084(0x1a4)](_0x5bf995,_0x57b80b),new Map()));if(_0x4f867c)return _0x4ba049;if(!_0x4ba049)return null;switch(this[_0x3ef084(0x1a3)][_0x3ef084(0x19f)](_0x393993)){case _0x3ef084(0x175):return _0x4ba049[_0x3ef084(0x193)](/\.\d{3}Z$/,_0x3ef084(0x186));case _0x3ef084(0x164):return _0x4ba049===_0x3ef084(0x183);case _0x3ef084(0x19c):case _0x3ef084(0x181):case _0x3ef084(0x166):case'percent':return+_0x4ba049;default:return _0x4ba049;}}}exports[a75_0x4d3688(0x1a1)]=BaseBulkRetrieve,BaseBulkRetrieve['POLL_INTERVAL']=0x1388;