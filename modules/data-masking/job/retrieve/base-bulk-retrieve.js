const a92_0x54ec95=a92_0x2338;(function(_0x5330e3,_0x36d1fe){const _0x1a3a00=a92_0x2338,_0x44ee61=_0x5330e3();while(!![]){try{const _0x5a43d8=-parseInt(_0x1a3a00(0x185))/0x1+-parseInt(_0x1a3a00(0x182))/0x2*(parseInt(_0x1a3a00(0x1b7))/0x3)+parseInt(_0x1a3a00(0x189))/0x4*(-parseInt(_0x1a3a00(0x1af))/0x5)+-parseInt(_0x1a3a00(0x1c5))/0x6*(parseInt(_0x1a3a00(0x1ae))/0x7)+-parseInt(_0x1a3a00(0x183))/0x8*(-parseInt(_0x1a3a00(0x19b))/0x9)+-parseInt(_0x1a3a00(0x1a8))/0xa+parseInt(_0x1a3a00(0x1c1))/0xb;if(_0x5a43d8===_0x36d1fe)break;else _0x44ee61['push'](_0x44ee61['shift']());}catch(_0x416ce0){_0x44ee61['push'](_0x44ee61['shift']());}}}(a92_0x1b90,0x44a20));const a92_0x469afb=(function(){let _0x375185=!![];return function(_0x4cc147,_0x58421b){const _0x41b3be=_0x375185?function(){const _0x1b5348=a92_0x2338;if(_0x58421b){const _0x229c85=_0x58421b[_0x1b5348(0x19e)](_0x4cc147,arguments);return _0x58421b=null,_0x229c85;}}:function(){};return _0x375185=![],_0x41b3be;};}()),a92_0x4bc88e=a92_0x469afb(this,function(){const _0x6e221c=a92_0x2338;return a92_0x4bc88e[_0x6e221c(0x1aa)]()[_0x6e221c(0x1be)](_0x6e221c(0x193))['toString']()[_0x6e221c(0x18a)](a92_0x4bc88e)[_0x6e221c(0x1be)]('(((.+)+)+)+$');});a92_0x4bc88e();'use strict';var __importDefault=this&&this[a92_0x54ec95(0x18b)]||function(_0x56e7a9){return _0x56e7a9&&_0x56e7a9['__esModule']?_0x56e7a9:{'default':_0x56e7a9};};function a92_0x1b90(){const _0x5be516=['__importDefault','true','stream','getIsDone','.000+0000','baseRetrievePayload','readEncryptionVector','readEncryptedTempFile','(((.+)+)+)+$','data','csvParser','pipeline','catch','../job-detail','isExistsPath','castCsvValue','6759gOJAOP','createReadStream','parse','apply','stream/promises','createEncryptPipe','createReader','error','_fieldsTypes','double','randomUUID','queryBuilder','datetime','1300200OUscEl','once','toString','resume','request','writeEncryptedTempFile','436121PGmhyD','5YiHEdf','default','pull','set','describe','then','push','CryptoUtils','3eHlRkz','defineProperty','readable','_read','BaseBulkRetrieve','bind','BaseRetrieve','search','systemLogger','BulkV1QueryContentType','15168439MGTIPk','fs/promises','destroy','path','18xEhCmk','execute','isPaused','retrieve','handleError','FsUtils','pipelineCallback','read','222338KkLNVy','520PULsIi','__esModule','510851NnuOam','percent','POLL_INTERVAL','pause','830780RUEMEy','constructor'];a92_0x1b90=function(){return _0x5be516;};return a92_0x1b90();}function a92_0x2338(_0x10b0fc,_0x26ab9e){const _0x5c3a10=a92_0x1b90();return a92_0x2338=function(_0x4bc88e,_0x469afb){_0x4bc88e=_0x4bc88e-0x17d;let _0x1b9013=_0x5c3a10[_0x4bc88e];return _0x1b9013;},a92_0x2338(_0x10b0fc,_0x26ab9e);}Object[a92_0x54ec95(0x1b8)](exports,a92_0x54ec95(0x184),{'value':!![]}),exports[a92_0x54ec95(0x1bb)]=void 0x0;const base_retrieve_1=require('./base-retrieve'),stream_1=require(a92_0x54ec95(0x18d)),path_1=__importDefault(require(a92_0x54ec95(0x1c4))),utils_1=require('@flosum/utils'),promises_1=require(a92_0x54ec95(0x1c2)),fs_1=__importDefault(require('fs')),promises_2=require(a92_0x54ec95(0x19f)),crypto_1=require('crypto'),csv_parse_1=require('csv-parse'),salesforce_1=require('@flosum/salesforce'),job_detail_1=require(a92_0x54ec95(0x198)),constants_1=require('../../constants');class BaseBulkRetrieve extends base_retrieve_1[a92_0x54ec95(0x1bd)]{get[a92_0x54ec95(0x190)](){const _0x1fcad2=a92_0x54ec95;return{'queryBuilder':this[_0x1fcad2(0x1a6)],'instance':this[_0x1fcad2(0x1ac)],'api':constants_1['SALESFORCE_API_VERSION'],'contentType':salesforce_1[_0x1fcad2(0x1c0)]['TEXT_CSV']};}async[a92_0x54ec95(0x1b1)](){const _0x5e4808=a92_0x54ec95;var _0x4580c2,_0x33aa2e;if(this[_0x5e4808(0x17d)][_0x5e4808(0x18e)]()&&!((_0x4580c2=this['csvParser'])===null||_0x4580c2===void 0x0?void 0x0:_0x4580c2[_0x5e4808(0x1c7)]())){this[_0x5e4808(0x1b5)](null);return;}if((_0x33aa2e=this[_0x5e4808(0x195)])===null||_0x33aa2e===void 0x0?void 0x0:_0x33aa2e[_0x5e4808(0x1c7)]()){this[_0x5e4808(0x195)][_0x5e4808(0x1ab)]();return;}const _0x46c1d8=await this[_0x5e4808(0x17d)][_0x5e4808(0x1c6)]();if(!_0x46c1d8)return this[_0x5e4808(0x1b1)]();await this[_0x5e4808(0x1a1)](_0x46c1d8);}async[a92_0x54ec95(0x1a1)](_0x22d14f){const _0x5e7e1d=a92_0x54ec95,_0x5a718f=path_1[_0x5e7e1d(0x1b0)]['join'](job_detail_1['jobStorePath'],(0x0,crypto_1[_0x5e7e1d(0x1a5)])()),_0x223998=(0x0,crypto_1[_0x5e7e1d(0x1a5)])(),_0x2e9773=await this[_0x5e7e1d(0x1ad)](_0x22d14f,_0x5a718f,_0x223998)[_0x5e7e1d(0x1b4)](()=>this[_0x5e7e1d(0x192)](_0x5a718f,_0x223998)),_0x1a76d7={'columns':!![],'cast':this['castCsvValue'][_0x5e7e1d(0x1bc)](this)};this[_0x5e7e1d(0x195)]=(0x0,stream_1[_0x5e7e1d(0x196)])(_0x2e9773,(0x0,csv_parse_1[_0x5e7e1d(0x19d)])(_0x1a76d7),this[_0x5e7e1d(0x180)][_0x5e7e1d(0x1bc)](this,_0x5a718f)),this[_0x5e7e1d(0x195)]['on'](_0x5e7e1d(0x194),_0x5451d8=>{const _0x26ab6c=_0x5e7e1d;this['csvParser'][_0x26ab6c(0x188)](),this[_0x26ab6c(0x1b5)](_0x5451d8);}),this['csvParser']['on']('end',async()=>{const _0x39227f=_0x5e7e1d;return await utils_1[_0x39227f(0x17f)]['isExistsPath'](_0x5a718f)&&await(0x0,promises_1['rm'])(_0x5a718f)['catch'](this[_0x39227f(0x17e)][_0x39227f(0x1bc)](this,null)),this[_0x39227f(0x1ba)]();}),this[_0x5e7e1d(0x195)]['on']('error',this[_0x5e7e1d(0x180)][_0x5e7e1d(0x1bc)](this,_0x5a718f));}async[a92_0x54ec95(0x1ad)](_0xc3cd6f,_0x596282,_0xae15e){const _0xa2315c=a92_0x54ec95,_0xae0e83=fs_1['default']['createWriteStream'](_0x596282);await(0x0,promises_2[_0xa2315c(0x196)])(_0xc3cd6f,utils_1[_0xa2315c(0x1b6)][_0xa2315c(0x1a0)](_0xae15e),_0xae0e83);}async[a92_0x54ec95(0x192)](_0x213c58,_0x387ada){const _0x42cd33=a92_0x54ec95,_0x518da6=fs_1[_0x42cd33(0x1b0)][_0x42cd33(0x19c)](_0x213c58),_0x10e814=await this[_0x42cd33(0x191)](_0x518da6),_0x17d182=utils_1['CryptoUtils']['createDecryptPipe'](_0x387ada,_0x10e814);return(0x0,stream_1['pipeline'])(_0x518da6,_0x17d182,this[_0x42cd33(0x180)][_0x42cd33(0x1bc)](this,_0x213c58));}async['pipelineCallback'](_0x56f7f0,_0x4c3696){const _0x5b0c84=a92_0x54ec95;_0x4c3696&&await this[_0x5b0c84(0x17e)](_0x56f7f0,_0x4c3696);}async[a92_0x54ec95(0x17e)](_0x10b2e5,_0x1e53a5){const _0x275150=a92_0x54ec95;_0x10b2e5&&await utils_1[_0x275150(0x17f)][_0x275150(0x199)](_0x10b2e5)&&await(0x0,promises_1['rm'])(_0x10b2e5)[_0x275150(0x197)](_0x2416c8=>job_detail_1[_0x275150(0x1bf)][_0x275150(0x1a2)](_0x2416c8)),this[_0x275150(0x1c3)](_0x1e53a5);}async['readEncryptionVector'](_0x33db92){return new Promise((_0x224721,_0x103dad)=>{const _0x31e77d=a92_0x2338;_0x33db92[_0x31e77d(0x1a9)](_0x31e77d(0x1a2),_0x103dad),_0x33db92[_0x31e77d(0x1a9)](_0x31e77d(0x1b9),()=>{const _0x3637b8=_0x31e77d,_0xf782a7=_0x33db92[_0x3637b8(0x181)](0x10);_0x224721(_0xf782a7);});});}[a92_0x54ec95(0x19a)](_0x55f9bb,{header:_0xf0da55,column:_0x4b180c}){const _0x36aa59=a92_0x54ec95;!this[_0x36aa59(0x1a3)]&&(this['_fieldsTypes']=this[_0x36aa59(0x1b3)]['fields']['reduce']((_0xc0891d,{name:_0x2d8963,type:_0x591a14})=>_0xc0891d[_0x36aa59(0x1b2)](_0x2d8963,_0x591a14),new Map()));if(_0xf0da55)return _0x55f9bb;if(!_0x55f9bb)return null;switch(this[_0x36aa59(0x1a3)]['get'](_0x4b180c)){case _0x36aa59(0x1a7):return _0x55f9bb['replace'](/\.\d{3}Z$/,_0x36aa59(0x18f));case'boolean':return _0x55f9bb===_0x36aa59(0x18c);case'currency':case _0x36aa59(0x1a4):case'int':case _0x36aa59(0x186):return+_0x55f9bb;default:return _0x55f9bb;}}}exports[a92_0x54ec95(0x1bb)]=BaseBulkRetrieve,BaseBulkRetrieve[a92_0x54ec95(0x187)]=0x1388;