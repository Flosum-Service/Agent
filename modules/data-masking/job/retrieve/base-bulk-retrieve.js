const a92_0x242bdf=a92_0x2e0e;function a92_0x2e0e(_0x4a6867,_0x124ad0){const _0x31229e=a92_0x3478();return a92_0x2e0e=function(_0x4364f2,_0x4062a8){_0x4364f2=_0x4364f2-0x15d;let _0x3478ca=_0x31229e[_0x4364f2];return _0x3478ca;},a92_0x2e0e(_0x4a6867,_0x124ad0);}(function(_0x3994ab,_0x331b5f){const _0x25224e=a92_0x2e0e,_0x4ecf3b=_0x3994ab();while(!![]){try{const _0x51e76a=parseInt(_0x25224e(0x19c))/0x1+parseInt(_0x25224e(0x18c))/0x2*(-parseInt(_0x25224e(0x182))/0x3)+-parseInt(_0x25224e(0x171))/0x4+-parseInt(_0x25224e(0x166))/0x5*(parseInt(_0x25224e(0x1a8))/0x6)+parseInt(_0x25224e(0x1ab))/0x7+parseInt(_0x25224e(0x191))/0x8*(-parseInt(_0x25224e(0x199))/0x9)+parseInt(_0x25224e(0x180))/0xa;if(_0x51e76a===_0x331b5f)break;else _0x4ecf3b['push'](_0x4ecf3b['shift']());}catch(_0x2f2c9f){_0x4ecf3b['push'](_0x4ecf3b['shift']());}}}(a92_0x3478,0x24a5d));const a92_0x4062a8=(function(){let _0x2f1e67=!![];return function(_0x387e55,_0x2f42fd){const _0x3fca1a=_0x2f1e67?function(){const _0x3c95ef=a92_0x2e0e;if(_0x2f42fd){const _0x1e49eb=_0x2f42fd[_0x3c95ef(0x186)](_0x387e55,arguments);return _0x2f42fd=null,_0x1e49eb;}}:function(){};return _0x2f1e67=![],_0x3fca1a;};}()),a92_0x4364f2=a92_0x4062a8(this,function(){const _0x1631da=a92_0x2e0e;return a92_0x4364f2[_0x1631da(0x1a7)]()[_0x1631da(0x15e)](_0x1631da(0x1ad))[_0x1631da(0x1a7)]()['constructor'](a92_0x4364f2)[_0x1631da(0x15e)]('(((.+)+)+)+$');});function a92_0x3478(){const _0x4d54bc=['SALESFORCE_API_VERSION','queryBuilder','parse','@flosum/salesforce','currency','catch','true','34479PEVHZZ','createReader','error','248322jkJWLq','boolean','BaseRetrieve','FsUtils','isExistsPath','createDecryptPipe','handleError','castCsvValue','crypto','path','percent','toString','1182126vEkTbJ','randomUUID','retrieve','1943886USbYZx','baseRetrievePayload','(((.+)+)+)+$','default','pipeline','search','pull','bind','createWriteStream','@flosum/utils','CryptoUtils','once','fs/promises','5lHDQoh','join','describe','createReadStream','replace','BaseBulkRetrieve','isPaused','destroy','datetime','_fieldsTypes','stream','667656sOufZY','double','request','./base-retrieve','__esModule','.000+0000','../../constants','reduce','int','set','pause','push','readEncryptionVector','end','defineProperty','1803610RzXopF','TEXT_CSV','282759tRBBvI','systemLogger','readEncryptedTempFile','jobStorePath','apply','POLL_INTERVAL','createEncryptPipe','pipelineCallback','writeEncryptedTempFile','stream/promises','4TJhUBE','then','_read','csvParser','readable','8tLqIEh'];a92_0x3478=function(){return _0x4d54bc;};return a92_0x3478();}a92_0x4364f2();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4e3a95){const _0x11fdc5=a92_0x2e0e;return _0x4e3a95&&_0x4e3a95[_0x11fdc5(0x175)]?_0x4e3a95:{'default':_0x4e3a95};};Object[a92_0x242bdf(0x17f)](exports,a92_0x242bdf(0x175),{'value':!![]}),exports[a92_0x242bdf(0x16b)]=void 0x0;const base_retrieve_1=require(a92_0x242bdf(0x174)),stream_1=require(a92_0x242bdf(0x170)),path_1=__importDefault(require(a92_0x242bdf(0x1a5))),utils_1=require(a92_0x242bdf(0x162)),promises_1=require(a92_0x242bdf(0x165)),fs_1=__importDefault(require('fs')),promises_2=require(a92_0x242bdf(0x18b)),crypto_1=require(a92_0x242bdf(0x1a4)),csv_parse_1=require('csv-parse'),salesforce_1=require(a92_0x242bdf(0x195)),job_detail_1=require('../job-detail'),constants_1=require(a92_0x242bdf(0x177));class BaseBulkRetrieve extends base_retrieve_1[a92_0x242bdf(0x19e)]{get[a92_0x242bdf(0x1ac)](){const _0x56bfb5=a92_0x242bdf;return{'queryBuilder':this[_0x56bfb5(0x193)],'instance':this[_0x56bfb5(0x173)],'api':constants_1[_0x56bfb5(0x192)],'contentType':salesforce_1['BulkV1QueryContentType'][_0x56bfb5(0x181)]};}async['pull'](){const _0x3aa519=a92_0x242bdf;var _0x4c88d0,_0x54da79;if(this[_0x3aa519(0x1aa)]['getIsDone']()&&!((_0x4c88d0=this['csvParser'])===null||_0x4c88d0===void 0x0?void 0x0:_0x4c88d0[_0x3aa519(0x16c)]())){this[_0x3aa519(0x17c)](null);return;}if((_0x54da79=this[_0x3aa519(0x18f)])===null||_0x54da79===void 0x0?void 0x0:_0x54da79['isPaused']()){this[_0x3aa519(0x18f)]['resume']();return;}const _0x3fb9fd=await this[_0x3aa519(0x1aa)]['execute']();if(!_0x3fb9fd)return this[_0x3aa519(0x15f)]();await this['createReader'](_0x3fb9fd);}async[a92_0x242bdf(0x19a)](_0xf03256){const _0x58a1c4=a92_0x242bdf,_0x5b7541=path_1['default'][_0x58a1c4(0x167)](job_detail_1[_0x58a1c4(0x185)],(0x0,crypto_1[_0x58a1c4(0x1a9)])()),_0x55ff79=(0x0,crypto_1[_0x58a1c4(0x1a9)])(),_0x4dfcf1=await this[_0x58a1c4(0x18a)](_0xf03256,_0x5b7541,_0x55ff79)[_0x58a1c4(0x18d)](()=>this['readEncryptedTempFile'](_0x5b7541,_0x55ff79)),_0x5b2756={'columns':!![],'cast':this[_0x58a1c4(0x1a3)][_0x58a1c4(0x160)](this)};this[_0x58a1c4(0x18f)]=(0x0,stream_1[_0x58a1c4(0x15d)])(_0x4dfcf1,(0x0,csv_parse_1[_0x58a1c4(0x194)])(_0x5b2756),this[_0x58a1c4(0x189)][_0x58a1c4(0x160)](this,_0x5b7541)),this[_0x58a1c4(0x18f)]['on']('data',_0x4b37b0=>{const _0x5d8513=_0x58a1c4;this['csvParser'][_0x5d8513(0x17b)](),this[_0x5d8513(0x17c)](_0x4b37b0);}),this[_0x58a1c4(0x18f)]['on'](_0x58a1c4(0x17e),async()=>{const _0x14e2f7=_0x58a1c4;return await utils_1[_0x14e2f7(0x19f)][_0x14e2f7(0x1a0)](_0x5b7541)&&await(0x0,promises_1['rm'])(_0x5b7541)[_0x14e2f7(0x197)](this['handleError'][_0x14e2f7(0x160)](this,null)),this[_0x14e2f7(0x18e)]();}),this['csvParser']['on']('error',this[_0x58a1c4(0x189)][_0x58a1c4(0x160)](this,_0x5b7541));}async['writeEncryptedTempFile'](_0x40e856,_0x5310e6,_0x4f1aa8){const _0x2d7afd=a92_0x242bdf,_0x16b5eb=fs_1['default'][_0x2d7afd(0x161)](_0x5310e6);await(0x0,promises_2[_0x2d7afd(0x15d)])(_0x40e856,utils_1['CryptoUtils'][_0x2d7afd(0x188)](_0x4f1aa8),_0x16b5eb);}async[a92_0x242bdf(0x184)](_0x3f6b54,_0x23a79d){const _0xcead25=a92_0x242bdf,_0x3224d4=fs_1[_0xcead25(0x1ae)][_0xcead25(0x169)](_0x3f6b54),_0x38963c=await this[_0xcead25(0x17d)](_0x3224d4),_0x2967fe=utils_1[_0xcead25(0x163)][_0xcead25(0x1a1)](_0x23a79d,_0x38963c);return(0x0,stream_1[_0xcead25(0x15d)])(_0x3224d4,_0x2967fe,this[_0xcead25(0x189)][_0xcead25(0x160)](this,_0x3f6b54));}async[a92_0x242bdf(0x189)](_0x49589d,_0x2f3efd){_0x2f3efd&&await this['handleError'](_0x49589d,_0x2f3efd);}async[a92_0x242bdf(0x1a2)](_0x563e27,_0x3b4ad9){const _0x58e0ed=a92_0x242bdf;_0x563e27&&await utils_1['FsUtils']['isExistsPath'](_0x563e27)&&await(0x0,promises_1['rm'])(_0x563e27)[_0x58e0ed(0x197)](_0x509119=>job_detail_1[_0x58e0ed(0x183)][_0x58e0ed(0x19b)](_0x509119)),this[_0x58e0ed(0x16d)](_0x3b4ad9);}async['readEncryptionVector'](_0x324b06){return new Promise((_0x1c20f4,_0x5d6d75)=>{const _0x30933d=a92_0x2e0e;_0x324b06[_0x30933d(0x164)](_0x30933d(0x19b),_0x5d6d75),_0x324b06[_0x30933d(0x164)](_0x30933d(0x190),()=>{const _0xba4f4d=_0x324b06['read'](0x10);_0x1c20f4(_0xba4f4d);});});}['castCsvValue'](_0x26bb27,{header:_0x41e6b5,column:_0x2fad7c}){const _0x68d47b=a92_0x242bdf;!this['_fieldsTypes']&&(this[_0x68d47b(0x16f)]=this[_0x68d47b(0x168)]['fields'][_0x68d47b(0x178)]((_0x4f1b33,{name:_0x272213,type:_0x581d99})=>_0x4f1b33[_0x68d47b(0x17a)](_0x272213,_0x581d99),new Map()));if(_0x41e6b5)return _0x26bb27;if(!_0x26bb27)return null;switch(this['_fieldsTypes']['get'](_0x2fad7c)){case _0x68d47b(0x16e):return _0x26bb27[_0x68d47b(0x16a)](/\.\d{3}Z$/,_0x68d47b(0x176));case _0x68d47b(0x19d):return _0x26bb27===_0x68d47b(0x198);case _0x68d47b(0x196):case _0x68d47b(0x172):case _0x68d47b(0x179):case _0x68d47b(0x1a6):return+_0x26bb27;default:return _0x26bb27;}}}exports[a92_0x242bdf(0x16b)]=BaseBulkRetrieve,BaseBulkRetrieve[a92_0x242bdf(0x187)]=0x1388;