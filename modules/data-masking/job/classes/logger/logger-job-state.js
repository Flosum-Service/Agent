const a58_0x244537=a58_0xd3b5;function a58_0xd3b5(_0x2c485a,_0x1bc4fd){const _0xe617f8=a58_0x2200();return a58_0xd3b5=function(_0x3b4bf0,_0x490bab){_0x3b4bf0=_0x3b4bf0-0x1ac;let _0x22003d=_0xe617f8[_0x3b4bf0];return _0x22003d;},a58_0xd3b5(_0x2c485a,_0x1bc4fd);}(function(_0x50d540,_0x35a332){const _0x1b32b9=a58_0xd3b5,_0x2e7362=_0x50d540();while(!![]){try{const _0x1ad24f=parseInt(_0x1b32b9(0x1d8))/0x1+parseInt(_0x1b32b9(0x1e9))/0x2+parseInt(_0x1b32b9(0x1e3))/0x3*(parseInt(_0x1b32b9(0x1df))/0x4)+parseInt(_0x1b32b9(0x1c3))/0x5*(-parseInt(_0x1b32b9(0x1c0))/0x6)+-parseInt(_0x1b32b9(0x1e5))/0x7+parseInt(_0x1b32b9(0x1e7))/0x8*(-parseInt(_0x1b32b9(0x1c4))/0x9)+-parseInt(_0x1b32b9(0x1b5))/0xa*(-parseInt(_0x1b32b9(0x1e2))/0xb);if(_0x1ad24f===_0x35a332)break;else _0x2e7362['push'](_0x2e7362['shift']());}catch(_0x522949){_0x2e7362['push'](_0x2e7362['shift']());}}}(a58_0x2200,0x3159b));const a58_0x490bab=(function(){let _0x39b42d=!![];return function(_0x374514,_0x3cf5d2){const _0x52ab10=_0x39b42d?function(){const _0x3481d4=a58_0xd3b5;if(_0x3cf5d2){const _0x4a29ed=_0x3cf5d2[_0x3481d4(0x1ce)](_0x374514,arguments);return _0x3cf5d2=null,_0x4a29ed;}}:function(){};return _0x39b42d=![],_0x52ab10;};}()),a58_0x3b4bf0=a58_0x490bab(this,function(){const _0x3421df=a58_0xd3b5;return a58_0x3b4bf0['toString']()['search'](_0x3421df(0x1d4))[_0x3421df(0x1cc)]()[_0x3421df(0x1d2)](a58_0x3b4bf0)[_0x3421df(0x1cf)](_0x3421df(0x1d4));});a58_0x3b4bf0();'use strict';var __importDefault=this&&this[a58_0x244537(0x1ac)]||function(_0x7afc4e){const _0x345a59=a58_0x244537;return _0x7afc4e&&_0x7afc4e[_0x345a59(0x1b1)]?_0x7afc4e:{'default':_0x7afc4e};};Object[a58_0x244537(0x1b3)](exports,'__esModule',{'value':!![]}),exports[a58_0x244537(0x1b2)]=void 0x0;const path_1=__importDefault(require(a58_0x244537(0x1bf))),logger_enums_1=require(a58_0x244537(0x1da)),base_logger_1=require('./base-logger'),promises_1=require(a58_0x244537(0x1de)),job_detail_1=require(a58_0x244537(0x1e4)),utils_1=require(a58_0x244537(0x1c6)),job_1=require('../../../../../constants/job');function a58_0x2200(){const _0x51ceab=['_jobState','path','42fYapuP','completedDate','_isLoggerInit','89055YMyRqD','1049607vqssGn','setJobError','@flosum/utils','JOB_LOG_STATE_FILENAME','write','setObjectStatus','initJobState','status','toString','name','apply','search','updateLoggerState','jobStorePath','constructor','filePath','(((.+)+)+)+$','start','failed','FsUtils','11595fYeyKf','default','../../enums/logger.enums','JobStatus','isExistsPath','successful','fs/promises','1900YqgRFb','jobState','BaseLogger','3352437cFzFjO','879LEijrS','../../job-detail','970564UTONGT','Cannot\x20find\x20object\x20\x27','8Modjbm','readFile','253108pgtKVd','__importDefault','setJobStatus','utf-8','error','parse','__esModule','LoggerJobState','defineProperty','initObjectStatistics','10pKjKSR','find','isLoggerInit','updateObjectProcess','QUEUED','FAILED','getObjectState','_jobId','_jobPath'];a58_0x2200=function(){return _0x51ceab;};return a58_0x2200();}class LoggerJobState extends base_logger_1[a58_0x244537(0x1e1)]{constructor(){const _0x3382c5=a58_0x244537;super(...arguments),this[_0x3382c5(0x1c2)]=![];}get['isLoggerInit'](){return this['_isLoggerInit'];}set[a58_0x244537(0x1b7)](_0x502511){const _0x8f7e60=a58_0x244537;this[_0x8f7e60(0x1c2)]=_0x502511;}get[a58_0x244537(0x1e0)](){const _0xacc3fb=a58_0x244537;if(!this[_0xacc3fb(0x1b7)])throw new Error('Logger\x20Job\x20State\x20wasn\x27t\x20init');return this[_0xacc3fb(0x1be)];}get[a58_0x244537(0x1d3)](){const _0x171d01=a58_0x244537;return path_1[_0x171d01(0x1d9)]['join'](this[_0x171d01(0x1bd)],job_1[_0x171d01(0x1c7)]);}async['init'](_0x2787b6){const _0xece1d9=a58_0x244537;return this[_0xece1d9(0x1be)]=await this['getJobState'](),this[_0xece1d9(0x1be)]['processed']=this['initObjectStatistics'](_0x2787b6),await this[_0xece1d9(0x1c8)](),await this[_0xece1d9(0x1d5)](),this[_0xece1d9(0x1b7)]=!![],this;}[a58_0x244537(0x1c9)](_0x2adafb,_0xa143a5){const _0x507916=a58_0x244537;this['getObjectState'](_0x2adafb)['status']=_0xa143a5,this[_0x507916(0x1d0)]();}[a58_0x244537(0x1ad)](_0x4e7abd){const _0x1b2334=a58_0x244537;this['jobState'][_0x1b2334(0x1cb)]=_0x4e7abd,[logger_enums_1[_0x1b2334(0x1db)][_0x1b2334(0x1ba)],logger_enums_1[_0x1b2334(0x1db)]['COMPLETED']]['includes'](_0x4e7abd)&&(this[_0x1b2334(0x1e0)][_0x1b2334(0x1c1)]=new Date()['getTime']()),this[_0x1b2334(0x1d0)]();}[a58_0x244537(0x1c5)](_0x58bfcc){const _0x411b70=a58_0x244537;this[_0x411b70(0x1e0)][_0x411b70(0x1af)]=_0x58bfcc,this[_0x411b70(0x1d0)]();}[a58_0x244537(0x1b8)](_0x398a87,_0x55f9da,_0x14e766){const _0x44232b=a58_0x244537,_0x1ecbde=this[_0x44232b(0x1bb)](_0x398a87);_0x1ecbde[_0x44232b(0x1dd)]+=_0x55f9da,_0x1ecbde[_0x44232b(0x1d6)]+=_0x14e766,this[_0x44232b(0x1e0)][_0x44232b(0x1dd)]+=_0x55f9da,this['jobState'][_0x44232b(0x1d6)]+=_0x14e766,this[_0x44232b(0x1d0)]();}[a58_0x244537(0x1bb)](_0x1d6db4){const _0x4536b0=a58_0x244537;var _0x1ab74b;const _0x686448=(_0x1ab74b=this[_0x4536b0(0x1e0)]['processed'])===null||_0x1ab74b===void 0x0?void 0x0:_0x1ab74b[_0x4536b0(0x1b6)](_0x2861f1=>_0x2861f1[_0x4536b0(0x1cd)]===_0x1d6db4);if(!_0x686448)throw new Error(_0x4536b0(0x1e6)+_0x1d6db4+'\x27\x20in\x20statistic');return _0x686448;}async['getJobState'](){const _0x345d90=a58_0x244537;if(!await utils_1[_0x345d90(0x1d7)][_0x345d90(0x1dc)](this['filePath']))return this[_0x345d90(0x1ca)]();const _0x489fc8=await(0x0,promises_1[_0x345d90(0x1e8)])(job_detail_1[_0x345d90(0x1d1)]+'/'+job_1[_0x345d90(0x1c7)],{'encoding':_0x345d90(0x1ae)});return JSON[_0x345d90(0x1b0)](_0x489fc8);}['initJobState'](){const _0x96f67d=a58_0x244537;return{'id':this[_0x96f67d(0x1bc)],'status':logger_enums_1[_0x96f67d(0x1db)][_0x96f67d(0x1b9)],'processed':[],'createdDate':new Date()['getTime'](),'successful':0x0,'failed':0x0};}[a58_0x244537(0x1b4)](_0x1e1340){return _0x1e1340['map'](_0x21a8d4=>({'name':_0x21a8d4,'status':logger_enums_1['ObjectStatus']['QUEUED'],'failed':0x0,'successful':0x0}));}[a58_0x244537(0x1c8)](){const _0x4d5d31=a58_0x244537;return(0x0,promises_1['writeFile'])(this['filePath'],JSON['stringify'](this[_0x4d5d31(0x1be)]));}}exports[a58_0x244537(0x1b2)]=LoggerJobState;