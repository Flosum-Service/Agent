const a75_0x38a035=a75_0x41a5;(function(_0x4089f7,_0x86dde1){const _0x374b8c=a75_0x41a5,_0xbf7b3b=_0x4089f7();while(!![]){try{const _0x474680=-parseInt(_0x374b8c(0x1a9))/0x1*(-parseInt(_0x374b8c(0x16c))/0x2)+-parseInt(_0x374b8c(0x19a))/0x3+-parseInt(_0x374b8c(0x18f))/0x4+parseInt(_0x374b8c(0x175))/0x5+-parseInt(_0x374b8c(0x1a6))/0x6*(-parseInt(_0x374b8c(0x181))/0x7)+parseInt(_0x374b8c(0x199))/0x8*(parseInt(_0x374b8c(0x1ab))/0x9)+parseInt(_0x374b8c(0x192))/0xa*(-parseInt(_0x374b8c(0x188))/0xb);if(_0x474680===_0x86dde1)break;else _0xbf7b3b['push'](_0xbf7b3b['shift']());}catch(_0x3c5455){_0xbf7b3b['push'](_0xbf7b3b['shift']());}}}(a75_0x3d8c,0xe64de));const a75_0x81a985=(function(){let _0x352eef=!![];return function(_0x42383d,_0x3ffcba){const _0x3a0efb=_0x352eef?function(){const _0x408299=a75_0x41a5;if(_0x3ffcba){const _0x10ebb=_0x3ffcba[_0x408299(0x17c)](_0x42383d,arguments);return _0x3ffcba=null,_0x10ebb;}}:function(){};return _0x352eef=![],_0x3a0efb;};}()),a75_0x2f9cb5=a75_0x81a985(this,function(){const _0x53a245=a75_0x41a5;return a75_0x2f9cb5['toString']()['search']('(((.+)+)+)+$')[_0x53a245(0x1a0)]()[_0x53a245(0x1a5)](a75_0x2f9cb5)[_0x53a245(0x196)](_0x53a245(0x19c));});a75_0x2f9cb5();'use strict';function a75_0x41a5(_0x17eab4,_0x3addbb){const _0x5a349d=a75_0x3d8c();return a75_0x41a5=function(_0x2f9cb5,_0x81a985){_0x2f9cb5=_0x2f9cb5-0x16b;let _0x3d8cb2=_0x5a349d[_0x2f9cb5];return _0x3d8cb2;},a75_0x41a5(_0x17eab4,_0x3addbb);}var __importDefault=this&&this[a75_0x38a035(0x17a)]||function(_0x5231f2){return _0x5231f2&&_0x5231f2['__esModule']?_0x5231f2:{'default':_0x5231f2};};Object[a75_0x38a035(0x185)](exports,a75_0x38a035(0x178),{'value':!![]}),exports['LoggerJobState']=void 0x0;const path_1=__importDefault(require('path')),logger_enums_1=require(a75_0x38a035(0x170)),base_logger_1=require(a75_0x38a035(0x179)),promises_1=require(a75_0x38a035(0x190)),job_detail_1=require(a75_0x38a035(0x17f)),utils_1=require(a75_0x38a035(0x1aa)),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1[a75_0x38a035(0x19f)]{constructor(){const _0x430a7d=a75_0x38a035;super(...arguments),this[_0x430a7d(0x18e)]=![];}get[a75_0x38a035(0x187)](){const _0x7ee11a=a75_0x38a035;return this[_0x7ee11a(0x18e)];}set[a75_0x38a035(0x187)](_0x2c4e9f){this['_isLoggerInit']=_0x2c4e9f;}get[a75_0x38a035(0x1a2)](){const _0x374289=a75_0x38a035;if(!this[_0x374289(0x187)])throw new Error(_0x374289(0x183));return this['_jobState'];}get[a75_0x38a035(0x18a)](){const _0x280df0=a75_0x38a035;return path_1[_0x280df0(0x18b)]['join'](this['_jobPath'],job_1['JOB_LOG_STATE_FILENAME']);}async[a75_0x38a035(0x16d)](_0x52780b){const _0x58746d=a75_0x38a035;return this[_0x58746d(0x176)]=await this['getJobState'](),this[_0x58746d(0x176)][_0x58746d(0x172)]=this[_0x58746d(0x194)](_0x52780b),await this['write'](),await this[_0x58746d(0x177)](),this[_0x58746d(0x187)]=!![],this;}['setObjectStatus'](_0x788991,_0x28b361){const _0x2d27c1=a75_0x38a035;this[_0x2d27c1(0x17d)](_0x788991)[_0x2d27c1(0x191)]=_0x28b361,this[_0x2d27c1(0x1a8)]();}['setJobStatus'](_0x4b08ef){const _0xd8e47c=a75_0x38a035;this[_0xd8e47c(0x1a2)]['status']=_0x4b08ef,[logger_enums_1[_0xd8e47c(0x17b)][_0xd8e47c(0x19d)],logger_enums_1[_0xd8e47c(0x17b)]['COMPLETED']][_0xd8e47c(0x184)](_0x4b08ef)&&(this[_0xd8e47c(0x1a2)][_0xd8e47c(0x198)]=new Date()[_0xd8e47c(0x1a7)]()),this[_0xd8e47c(0x1a8)]();}[a75_0x38a035(0x19b)](_0x82063){const _0x52ba71=a75_0x38a035;this['jobState'][_0x52ba71(0x193)]=_0x82063,this[_0x52ba71(0x1a8)]();}[a75_0x38a035(0x1a4)](_0x5c0872,_0x275850,_0x214c6f){const _0x3903fc=a75_0x38a035,_0x373441=this[_0x3903fc(0x17d)](_0x5c0872);_0x373441[_0x3903fc(0x171)]+=_0x275850,_0x373441[_0x3903fc(0x189)]+=_0x214c6f,this['jobState']['successful']+=_0x275850,this[_0x3903fc(0x1a2)][_0x3903fc(0x189)]+=_0x214c6f,this['updateLoggerState']();}['getObjectState'](_0x48b079){const _0x1f566e=a75_0x38a035;var _0x12518a;const _0x53ef0c=(_0x12518a=this[_0x1f566e(0x1a2)][_0x1f566e(0x172)])===null||_0x12518a===void 0x0?void 0x0:_0x12518a[_0x1f566e(0x1a3)](_0x88c45=>_0x88c45[_0x1f566e(0x195)]===_0x48b079);if(!_0x53ef0c)throw new Error(_0x1f566e(0x180)+_0x48b079+'\x27\x20in\x20statistic');return _0x53ef0c;}async[a75_0x38a035(0x18c)](){const _0x47135f=a75_0x38a035;if(!await utils_1[_0x47135f(0x173)][_0x47135f(0x17e)](this[_0x47135f(0x18a)]))return this[_0x47135f(0x186)]();const _0x22fc15=await(0x0,promises_1[_0x47135f(0x1ac)])(job_detail_1['jobStorePath']+'/'+job_1['JOB_LOG_STATE_FILENAME'],{'encoding':_0x47135f(0x18d)});return JSON[_0x47135f(0x1a1)](_0x22fc15);}['initJobState'](){const _0x3caed7=a75_0x38a035;return{'id':this[_0x3caed7(0x16b)],'status':logger_enums_1[_0x3caed7(0x17b)][_0x3caed7(0x16e)],'processed':[],'createdDate':new Date()[_0x3caed7(0x1a7)](),'successful':0x0,'failed':0x0};}[a75_0x38a035(0x194)](_0x1ae19c){const _0x4bc2ee=a75_0x38a035;return _0x1ae19c[_0x4bc2ee(0x197)](_0x20fa3b=>({'name':_0x20fa3b,'status':logger_enums_1[_0x4bc2ee(0x174)][_0x4bc2ee(0x16e)],'failed':0x0,'successful':0x0}));}['write'](){const _0x4e19d3=a75_0x38a035;return(0x0,promises_1[_0x4e19d3(0x182)])(this[_0x4e19d3(0x18a)],JSON[_0x4e19d3(0x16f)](this['_jobState']));}}function a75_0x3d8c(){const _0x5ba481=['@flosum/utils','4245372FwTWnb','readFile','_jobId','16uWDgaq','init','QUEUED','stringify','../../enums/logger.enums','successful','processed','FsUtils','ObjectStatus','8308600TwXplT','_jobState','start','__esModule','./base-logger','__importDefault','JobStatus','apply','getObjectState','isExistsPath','../../job-detail','Cannot\x20find\x20object\x20\x27','791609lpTyCF','writeFile','Logger\x20Job\x20State\x20wasn\x27t\x20init','includes','defineProperty','initJobState','isLoggerInit','11xazLmo','failed','filePath','default','getJobState','utf-8','_isLoggerInit','5286116HdVBaw','fs/promises','status','12083870TkqZEw','error','initObjectStatistics','name','search','map','completedDate','24OuQNik','3885771iiiyzR','setJobError','(((.+)+)+)+$','FAILED','LoggerJobState','BaseLogger','toString','parse','jobState','find','updateObjectProcess','constructor','6rftRJY','getTime','updateLoggerState','197321ssPOJW'];a75_0x3d8c=function(){return _0x5ba481;};return a75_0x3d8c();}exports[a75_0x38a035(0x19e)]=LoggerJobState;