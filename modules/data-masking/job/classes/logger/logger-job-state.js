const a73_0x1a45ca=a73_0x5d89;(function(_0x48914c,_0x2a49d8){const _0x210b97=a73_0x5d89,_0x4959c7=_0x48914c();while(!![]){try{const _0x33eeba=parseInt(_0x210b97(0xba))/0x1*(-parseInt(_0x210b97(0xf6))/0x2)+parseInt(_0x210b97(0xc6))/0x3*(parseInt(_0x210b97(0xd1))/0x4)+parseInt(_0x210b97(0xde))/0x5*(-parseInt(_0x210b97(0xf1))/0x6)+-parseInt(_0x210b97(0xd5))/0x7+parseInt(_0x210b97(0xe2))/0x8*(-parseInt(_0x210b97(0xd9))/0x9)+parseInt(_0x210b97(0xdf))/0xa+parseInt(_0x210b97(0xcf))/0xb;if(_0x33eeba===_0x2a49d8)break;else _0x4959c7['push'](_0x4959c7['shift']());}catch(_0x4a6a7c){_0x4959c7['push'](_0x4959c7['shift']());}}}(a73_0x2e4d,0xbb67a));function a73_0x2e4d(){const _0x457aa3=['4wQkwYS','successful','search','_isLoggerInit','6359675QLmgyj','apply','setJobError','QUEUED','117EyrNTk','stringify','updateObjectProcess','getObjectState','initObjectStatistics','5MqGpfV','4093740lRpYOv','failed','setJobStatus','839912BRDkAt','__importDefault','path','_jobId','./base-logger','jobStorePath','completedDate','BaseLogger','updateLoggerState','defineProperty','status','../../../../../constants/job','FsUtils','_jobPath','utf-8','6800844cyTPqE','../../enums/logger.enums','__esModule','../../job-detail','constructor','1336egGCOs','(((.+)+)+)+$','processed','name','isLoggerInit','319LjxofS','join','_jobState','map','Cannot\x20find\x20object\x20\x27','toString','writeFile','\x27\x20in\x20statistic','JOB_LOG_STATE_FILENAME','parse','getTime','error','3136017kwgUaD','initJobState','isExistsPath','JobStatus','jobState','LoggerJobState','readFile','filePath','includes','32261295ejEFQu','Logger\x20Job\x20State\x20wasn\x27t\x20init'];a73_0x2e4d=function(){return _0x457aa3;};return a73_0x2e4d();}const a73_0x245c45=(function(){let _0x31fe93=!![];return function(_0x12f843,_0x25a5e8){const _0x1fc778=_0x31fe93?function(){const _0x3d645d=a73_0x5d89;if(_0x25a5e8){const _0x383ae3=_0x25a5e8[_0x3d645d(0xd6)](_0x12f843,arguments);return _0x25a5e8=null,_0x383ae3;}}:function(){};return _0x31fe93=![],_0x1fc778;};}()),a73_0x2ad5e1=a73_0x245c45(this,function(){const _0x3b5033=a73_0x5d89;return a73_0x2ad5e1['toString']()[_0x3b5033(0xd3)](_0x3b5033(0xf7))[_0x3b5033(0xbf)]()[_0x3b5033(0xf5)](a73_0x2ad5e1)['search']('(((.+)+)+)+$');});a73_0x2ad5e1();'use strict';function a73_0x5d89(_0x440e8f,_0x478e8e){const _0x5e46fe=a73_0x2e4d();return a73_0x5d89=function(_0x2ad5e1,_0x245c45){_0x2ad5e1=_0x2ad5e1-0xb9;let _0x2e4d64=_0x5e46fe[_0x2ad5e1];return _0x2e4d64;},a73_0x5d89(_0x440e8f,_0x478e8e);}var __importDefault=this&&this[a73_0x1a45ca(0xe3)]||function(_0x25da8c){return _0x25da8c&&_0x25da8c['__esModule']?_0x25da8c:{'default':_0x25da8c};};Object[a73_0x1a45ca(0xeb)](exports,a73_0x1a45ca(0xf3),{'value':!![]}),exports[a73_0x1a45ca(0xcb)]=void 0x0;const path_1=__importDefault(require(a73_0x1a45ca(0xe4))),logger_enums_1=require(a73_0x1a45ca(0xf2)),base_logger_1=require(a73_0x1a45ca(0xe6)),promises_1=require('fs/promises'),job_detail_1=require(a73_0x1a45ca(0xf4)),utils_1=require('@flosum/utils'),job_1=require(a73_0x1a45ca(0xed));class LoggerJobState extends base_logger_1[a73_0x1a45ca(0xe9)]{constructor(){super(...arguments),this['_isLoggerInit']=![];}get[a73_0x1a45ca(0xb9)](){const _0x32d8ee=a73_0x1a45ca;return this[_0x32d8ee(0xd4)];}set['isLoggerInit'](_0x4d633d){this['_isLoggerInit']=_0x4d633d;}get[a73_0x1a45ca(0xca)](){const _0x1f30a4=a73_0x1a45ca;if(!this[_0x1f30a4(0xb9)])throw new Error(_0x1f30a4(0xd0));return this[_0x1f30a4(0xbc)];}get['filePath'](){const _0xb37d87=a73_0x1a45ca;return path_1['default'][_0xb37d87(0xbb)](this[_0xb37d87(0xef)],job_1[_0xb37d87(0xc2)]);}async['init'](_0x441987){const _0x47d694=a73_0x1a45ca;return this['_jobState']=await this['getJobState'](),this[_0x47d694(0xbc)]['processed']=this['initObjectStatistics'](_0x441987),await this['write'](),await this['start'](),this['isLoggerInit']=!![],this;}['setObjectStatus'](_0x958202,_0x650a20){const _0x2f24c6=a73_0x1a45ca;this[_0x2f24c6(0xdc)](_0x958202)[_0x2f24c6(0xec)]=_0x650a20,this[_0x2f24c6(0xea)]();}[a73_0x1a45ca(0xe1)](_0x328d44){const _0x5b3260=a73_0x1a45ca;this[_0x5b3260(0xca)][_0x5b3260(0xec)]=_0x328d44,[logger_enums_1['JobStatus']['FAILED'],logger_enums_1[_0x5b3260(0xc9)]['COMPLETED']][_0x5b3260(0xce)](_0x328d44)&&(this[_0x5b3260(0xca)][_0x5b3260(0xe8)]=new Date()['getTime']()),this[_0x5b3260(0xea)]();}[a73_0x1a45ca(0xd7)](_0x146c12){const _0x2122d5=a73_0x1a45ca;this[_0x2122d5(0xca)][_0x2122d5(0xc5)]=_0x146c12,this['updateLoggerState']();}[a73_0x1a45ca(0xdb)](_0x16bf3a,_0x569102,_0x2823ba){const _0x90eae9=a73_0x1a45ca,_0x21ba63=this['getObjectState'](_0x16bf3a);_0x21ba63[_0x90eae9(0xd2)]+=_0x569102,_0x21ba63[_0x90eae9(0xe0)]+=_0x2823ba,this[_0x90eae9(0xca)]['successful']+=_0x569102,this['jobState'][_0x90eae9(0xe0)]+=_0x2823ba,this[_0x90eae9(0xea)]();}[a73_0x1a45ca(0xdc)](_0x5e1487){const _0x3cbd64=a73_0x1a45ca;var _0x3ca065;const _0xceb6b4=(_0x3ca065=this[_0x3cbd64(0xca)][_0x3cbd64(0xf8)])===null||_0x3ca065===void 0x0?void 0x0:_0x3ca065['find'](_0x1a2747=>_0x1a2747[_0x3cbd64(0xf9)]===_0x5e1487);if(!_0xceb6b4)throw new Error(_0x3cbd64(0xbe)+_0x5e1487+_0x3cbd64(0xc1));return _0xceb6b4;}async['getJobState'](){const _0x4ba857=a73_0x1a45ca;if(!await utils_1[_0x4ba857(0xee)][_0x4ba857(0xc8)](this['filePath']))return this[_0x4ba857(0xc7)]();const _0x2cf804=await(0x0,promises_1[_0x4ba857(0xcc)])(job_detail_1[_0x4ba857(0xe7)]+'/'+job_1[_0x4ba857(0xc2)],{'encoding':_0x4ba857(0xf0)});return JSON[_0x4ba857(0xc3)](_0x2cf804);}['initJobState'](){const _0x2f262b=a73_0x1a45ca;return{'id':this[_0x2f262b(0xe5)],'status':logger_enums_1[_0x2f262b(0xc9)]['QUEUED'],'processed':[],'createdDate':new Date()[_0x2f262b(0xc4)](),'successful':0x0,'failed':0x0};}[a73_0x1a45ca(0xdd)](_0xf74512){const _0x5a6147=a73_0x1a45ca;return _0xf74512[_0x5a6147(0xbd)](_0x3df325=>({'name':_0x3df325,'status':logger_enums_1['ObjectStatus'][_0x5a6147(0xd8)],'failed':0x0,'successful':0x0}));}['write'](){const _0x1daddb=a73_0x1a45ca;return(0x0,promises_1[_0x1daddb(0xc0)])(this[_0x1daddb(0xcd)],JSON[_0x1daddb(0xda)](this['_jobState']));}}exports['LoggerJobState']=LoggerJobState;