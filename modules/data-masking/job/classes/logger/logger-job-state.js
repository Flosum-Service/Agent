const a58_0x5c914b=a58_0x2d4d;(function(_0x3a29c4,_0x1f7a95){const _0x4c1e7b=a58_0x2d4d,_0x173cb4=_0x3a29c4();while(!![]){try{const _0xab2e5f=-parseInt(_0x4c1e7b(0x170))/0x1*(parseInt(_0x4c1e7b(0x172))/0x2)+parseInt(_0x4c1e7b(0x17f))/0x3+parseInt(_0x4c1e7b(0x16b))/0x4*(parseInt(_0x4c1e7b(0x197))/0x5)+parseInt(_0x4c1e7b(0x17a))/0x6*(-parseInt(_0x4c1e7b(0x16a))/0x7)+parseInt(_0x4c1e7b(0x17e))/0x8*(-parseInt(_0x4c1e7b(0x183))/0x9)+-parseInt(_0x4c1e7b(0x18a))/0xa*(-parseInt(_0x4c1e7b(0x199))/0xb)+-parseInt(_0x4c1e7b(0x166))/0xc;if(_0xab2e5f===_0x1f7a95)break;else _0x173cb4['push'](_0x173cb4['shift']());}catch(_0x41406d){_0x173cb4['push'](_0x173cb4['shift']());}}}(a58_0x4cdc,0x43247));const a58_0x110fda=(function(){let _0x400d42=!![];return function(_0x2d9ee0,_0x32e39b){const _0x4f46bd=_0x400d42?function(){if(_0x32e39b){const _0x4008b0=_0x32e39b['apply'](_0x2d9ee0,arguments);return _0x32e39b=null,_0x4008b0;}}:function(){};return _0x400d42=![],_0x4f46bd;};}()),a58_0x47fa97=a58_0x110fda(this,function(){const _0x3ae110=a58_0x2d4d;return a58_0x47fa97[_0x3ae110(0x180)]()[_0x3ae110(0x178)](_0x3ae110(0x184))['toString']()['constructor'](a58_0x47fa97)[_0x3ae110(0x178)](_0x3ae110(0x184));});function a58_0x2d4d(_0x9e8818,_0x4a3c31){const _0x5eff54=a58_0x4cdc();return a58_0x2d4d=function(_0x47fa97,_0x110fda){_0x47fa97=_0x47fa97-0x163;let _0x4cdca0=_0x5eff54[_0x47fa97];return _0x4cdca0;},a58_0x2d4d(_0x9e8818,_0x4a3c31);}a58_0x47fa97();'use strict';var __importDefault=this&&this[a58_0x5c914b(0x169)]||function(_0x21e7e5){return _0x21e7e5&&_0x21e7e5['__esModule']?_0x21e7e5:{'default':_0x21e7e5};};function a58_0x4cdc(){const _0x3562b2=['getTime','QUEUED','FsUtils','jobStorePath','failed','completedDate','parse','JOB_LOG_STATE_FILENAME','1061640VspyAj','find','getObjectState','__importDefault','231Qepsdx','16VQTxWp','../../job-detail','JobStatus','setJobStatus','updateLoggerState','2LQCNan','filePath','401636LeRrvA','defineProperty','name','successful','path','jobState','search','_isLoggerInit','13674NDJXUY','getJobState','stringify','fs/promises','4208056pmJEdq','1592202TFqWCv','toString','Logger\x20Job\x20State\x20wasn\x27t\x20init','./base-logger','9DHjNPP','(((.+)+)+)+$','isLoggerInit','utf-8','initJobState','COMPLETED','LoggerJobState','30jDDDuM','FAILED','Cannot\x20find\x20object\x20\x27','map','write','@flosum/utils','__esModule','_jobState','status','writeFile','setObjectStatus','readFile','join','655960ZBCtPr','start','1139721XwLjpN','_jobId','init','BaseLogger','isExistsPath'];a58_0x4cdc=function(){return _0x3562b2;};return a58_0x4cdc();}Object[a58_0x5c914b(0x173)](exports,a58_0x5c914b(0x190),{'value':!![]}),exports[a58_0x5c914b(0x189)]=void 0x0;const path_1=__importDefault(require(a58_0x5c914b(0x176))),logger_enums_1=require('../../enums/logger.enums'),base_logger_1=require(a58_0x5c914b(0x182)),promises_1=require(a58_0x5c914b(0x17d)),job_detail_1=require(a58_0x5c914b(0x16c)),utils_1=require(a58_0x5c914b(0x18f)),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1[a58_0x5c914b(0x19c)]{constructor(){const _0x38edd9=a58_0x5c914b;super(...arguments),this[_0x38edd9(0x179)]=![];}get['isLoggerInit'](){const _0x2939c5=a58_0x5c914b;return this[_0x2939c5(0x179)];}set[a58_0x5c914b(0x185)](_0x40a83c){const _0x1e1b51=a58_0x5c914b;this[_0x1e1b51(0x179)]=_0x40a83c;}get['jobState'](){const _0x329001=a58_0x5c914b;if(!this['isLoggerInit'])throw new Error(_0x329001(0x181));return this[_0x329001(0x191)];}get[a58_0x5c914b(0x171)](){const _0x2e2c61=a58_0x5c914b;return path_1['default'][_0x2e2c61(0x196)](this['_jobPath'],job_1['JOB_LOG_STATE_FILENAME']);}async[a58_0x5c914b(0x19b)](_0x4f0f72){const _0x3287cb=a58_0x5c914b;return this['_jobState']=await this['getJobState'](),this[_0x3287cb(0x191)]['processed']=this['initObjectStatistics'](_0x4f0f72),await this[_0x3287cb(0x18e)](),await this[_0x3287cb(0x198)](),this[_0x3287cb(0x185)]=!![],this;}[a58_0x5c914b(0x194)](_0x52ae52,_0x2c7e58){const _0x5f51cc=a58_0x5c914b;this['getObjectState'](_0x52ae52)['status']=_0x2c7e58,this[_0x5f51cc(0x16f)]();}[a58_0x5c914b(0x16e)](_0x428043){const _0x1abd50=a58_0x5c914b;this[_0x1abd50(0x177)][_0x1abd50(0x192)]=_0x428043,[logger_enums_1[_0x1abd50(0x16d)][_0x1abd50(0x18b)],logger_enums_1[_0x1abd50(0x16d)][_0x1abd50(0x188)]]['includes'](_0x428043)&&(this['jobState'][_0x1abd50(0x163)]=new Date()[_0x1abd50(0x19e)]()),this[_0x1abd50(0x16f)]();}['setJobError'](_0x4cd3b8){const _0x3abccc=a58_0x5c914b;this[_0x3abccc(0x177)]['error']=_0x4cd3b8,this[_0x3abccc(0x16f)]();}['updateObjectProcess'](_0x1c46f7,_0x10e5ca,_0x123278){const _0x922fc6=a58_0x5c914b,_0x23e36f=this[_0x922fc6(0x168)](_0x1c46f7);_0x23e36f['successful']+=_0x10e5ca,_0x23e36f['failed']+=_0x123278,this[_0x922fc6(0x177)][_0x922fc6(0x175)]+=_0x10e5ca,this[_0x922fc6(0x177)][_0x922fc6(0x1a2)]+=_0x123278,this[_0x922fc6(0x16f)]();}[a58_0x5c914b(0x168)](_0x4455e8){const _0x32234a=a58_0x5c914b;var _0x4a4ba8;const _0x56768b=(_0x4a4ba8=this[_0x32234a(0x177)]['processed'])===null||_0x4a4ba8===void 0x0?void 0x0:_0x4a4ba8[_0x32234a(0x167)](_0x42129e=>_0x42129e[_0x32234a(0x174)]===_0x4455e8);if(!_0x56768b)throw new Error(_0x32234a(0x18c)+_0x4455e8+'\x27\x20in\x20statistic');return _0x56768b;}async[a58_0x5c914b(0x17b)](){const _0x216741=a58_0x5c914b;if(!await utils_1[_0x216741(0x1a0)][_0x216741(0x19d)](this['filePath']))return this[_0x216741(0x187)]();const _0x573663=await(0x0,promises_1[_0x216741(0x195)])(job_detail_1[_0x216741(0x1a1)]+'/'+job_1[_0x216741(0x165)],{'encoding':_0x216741(0x186)});return JSON[_0x216741(0x164)](_0x573663);}[a58_0x5c914b(0x187)](){const _0x183a07=a58_0x5c914b;return{'id':this[_0x183a07(0x19a)],'status':logger_enums_1[_0x183a07(0x16d)]['QUEUED'],'processed':[],'createdDate':new Date()['getTime'](),'successful':0x0,'failed':0x0};}['initObjectStatistics'](_0x53f964){const _0x51f412=a58_0x5c914b;return _0x53f964[_0x51f412(0x18d)](_0x3b16eb=>({'name':_0x3b16eb,'status':logger_enums_1['ObjectStatus'][_0x51f412(0x19f)],'failed':0x0,'successful':0x0}));}[a58_0x5c914b(0x18e)](){const _0x50763e=a58_0x5c914b;return(0x0,promises_1[_0x50763e(0x193)])(this[_0x50763e(0x171)],JSON[_0x50763e(0x17c)](this[_0x50763e(0x191)]));}}exports[a58_0x5c914b(0x189)]=LoggerJobState;