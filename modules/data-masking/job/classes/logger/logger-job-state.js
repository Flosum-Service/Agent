const a58_0x25fb6d=a58_0xeb7b;(function(_0x3964ea,_0x5da04c){const _0x2228fd=a58_0xeb7b,_0x5a4cd2=_0x3964ea();while(!![]){try{const _0xa4be3e=-parseInt(_0x2228fd(0x76))/0x1*(parseInt(_0x2228fd(0xaf))/0x2)+-parseInt(_0x2228fd(0x8d))/0x3*(-parseInt(_0x2228fd(0x78))/0x4)+-parseInt(_0x2228fd(0xa0))/0x5*(parseInt(_0x2228fd(0x82))/0x6)+parseInt(_0x2228fd(0x79))/0x7*(-parseInt(_0x2228fd(0x98))/0x8)+parseInt(_0x2228fd(0x7d))/0x9+parseInt(_0x2228fd(0xac))/0xa+parseInt(_0x2228fd(0x8f))/0xb;if(_0xa4be3e===_0x5da04c)break;else _0x5a4cd2['push'](_0x5a4cd2['shift']());}catch(_0x3393a0){_0x5a4cd2['push'](_0x5a4cd2['shift']());}}}(a58_0x16b2,0xa668b));const a58_0x35cf57=(function(){let _0xb74d57=!![];return function(_0x2648e1,_0x28e2de){const _0x4f5912=_0xb74d57?function(){const _0x1b60c7=a58_0xeb7b;if(_0x28e2de){const _0xc05130=_0x28e2de[_0x1b60c7(0xa6)](_0x2648e1,arguments);return _0x28e2de=null,_0xc05130;}}:function(){};return _0xb74d57=![],_0x4f5912;};}()),a58_0x2c4cdd=a58_0x35cf57(this,function(){const _0x48078b=a58_0xeb7b;return a58_0x2c4cdd[_0x48078b(0x91)]()['search'](_0x48078b(0xad))[_0x48078b(0x91)]()['constructor'](a58_0x2c4cdd)[_0x48078b(0xa2)](_0x48078b(0xad));});a58_0x2c4cdd();function a58_0xeb7b(_0x50914c,_0x24b386){const _0x2ef0a1=a58_0x16b2();return a58_0xeb7b=function(_0x2c4cdd,_0x35cf57){_0x2c4cdd=_0x2c4cdd-0x72;let _0x16b22e=_0x2ef0a1[_0x2c4cdd];return _0x16b22e;},a58_0xeb7b(_0x50914c,_0x24b386);}'use strict';var __importDefault=this&&this[a58_0x25fb6d(0x83)]||function(_0x2c7733){return _0x2c7733&&_0x2c7733['__esModule']?_0x2c7733:{'default':_0x2c7733};};Object[a58_0x25fb6d(0x95)](exports,'__esModule',{'value':!![]}),exports[a58_0x25fb6d(0x93)]=void 0x0;const path_1=__importDefault(require('path')),logger_enums_1=require(a58_0x25fb6d(0xae)),base_logger_1=require(a58_0x25fb6d(0x8a)),promises_1=require('fs/promises'),job_detail_1=require('../../job-detail'),utils_1=require('@flosum/utils'),job_1=require(a58_0x25fb6d(0x94));class LoggerJobState extends base_logger_1[a58_0x25fb6d(0x92)]{constructor(){const _0x561be9=a58_0x25fb6d;super(...arguments),this[_0x561be9(0x9a)]=![];}get[a58_0x25fb6d(0x87)](){const _0x4ee173=a58_0x25fb6d;return this[_0x4ee173(0x9a)];}set[a58_0x25fb6d(0x87)](_0x161ced){this['_isLoggerInit']=_0x161ced;}get[a58_0x25fb6d(0x9c)](){const _0x413767=a58_0x25fb6d;if(!this['isLoggerInit'])throw new Error('Logger\x20Job\x20State\x20wasn\x27t\x20init');return this[_0x413767(0x8e)];}get[a58_0x25fb6d(0x9d)](){const _0x2c5468=a58_0x25fb6d;return path_1[_0x2c5468(0x75)][_0x2c5468(0x97)](this[_0x2c5468(0xa4)],job_1['JOB_LOG_STATE_FILENAME']);}async['init'](_0x783fcb){const _0x149c9d=a58_0x25fb6d;return this[_0x149c9d(0x8e)]=await this[_0x149c9d(0x9b)](),this[_0x149c9d(0x8e)][_0x149c9d(0x96)]=this[_0x149c9d(0xa3)](_0x783fcb),await this[_0x149c9d(0x9f)](),await this['start'](),this[_0x149c9d(0x87)]=!![],this;}[a58_0x25fb6d(0xaa)](_0x813adb,_0x39622b){const _0x35a06f=a58_0x25fb6d;this['getObjectState'](_0x813adb)[_0x35a06f(0x88)]=_0x39622b,this[_0x35a06f(0xa7)]();}[a58_0x25fb6d(0x7c)](_0x26013d){const _0x37bc71=a58_0x25fb6d;this['jobState'][_0x37bc71(0x88)]=_0x26013d,[logger_enums_1[_0x37bc71(0x73)][_0x37bc71(0xa5)],logger_enums_1['JobStatus'][_0x37bc71(0xab)]]['includes'](_0x26013d)&&(this[_0x37bc71(0x9c)][_0x37bc71(0xa1)]=new Date()[_0x37bc71(0x81)]()),this['updateLoggerState']();}[a58_0x25fb6d(0x86)](_0xf50bdb){const _0x1240f4=a58_0x25fb6d;this[_0x1240f4(0x9c)][_0x1240f4(0x77)]=_0xf50bdb,this['updateLoggerState']();}[a58_0x25fb6d(0x8c)](_0xece9d1,_0x5331b2,_0x3cce04){const _0x274389=a58_0x25fb6d,_0x36440d=this[_0x274389(0x72)](_0xece9d1);_0x36440d[_0x274389(0x99)]+=_0x5331b2,_0x36440d['failed']+=_0x3cce04,this[_0x274389(0x9c)][_0x274389(0x99)]+=_0x5331b2,this[_0x274389(0x9c)][_0x274389(0x90)]+=_0x3cce04,this['updateLoggerState']();}[a58_0x25fb6d(0x72)](_0x11a9a4){const _0x45af93=a58_0x25fb6d;var _0x1f269f;const _0x423bbb=(_0x1f269f=this[_0x45af93(0x9c)][_0x45af93(0x96)])===null||_0x1f269f===void 0x0?void 0x0:_0x1f269f[_0x45af93(0x84)](_0x4834de=>_0x4834de[_0x45af93(0x9e)]===_0x11a9a4);if(!_0x423bbb)throw new Error('Cannot\x20find\x20object\x20\x27'+_0x11a9a4+'\x27\x20in\x20statistic');return _0x423bbb;}async[a58_0x25fb6d(0x9b)](){const _0x45bdcf=a58_0x25fb6d;if(!await utils_1[_0x45bdcf(0x7a)][_0x45bdcf(0x7f)](this[_0x45bdcf(0x9d)]))return this[_0x45bdcf(0x80)]();const _0x22f27b=await(0x0,promises_1[_0x45bdcf(0x8b)])(job_detail_1[_0x45bdcf(0x7b)]+'/'+job_1[_0x45bdcf(0xa8)],{'encoding':'utf-8'});return JSON['parse'](_0x22f27b);}['initJobState'](){const _0x249029=a58_0x25fb6d;return{'id':this['_jobId'],'status':logger_enums_1[_0x249029(0x73)][_0x249029(0x85)],'processed':[],'createdDate':new Date()['getTime'](),'successful':0x0,'failed':0x0};}[a58_0x25fb6d(0xa3)](_0x1a9c80){const _0xbda550=a58_0x25fb6d;return _0x1a9c80[_0xbda550(0x7e)](_0x4ef020=>({'name':_0x4ef020,'status':logger_enums_1[_0xbda550(0x74)][_0xbda550(0x85)],'failed':0x0,'successful':0x0}));}[a58_0x25fb6d(0x9f)](){const _0x2a5087=a58_0x25fb6d;return(0x0,promises_1[_0x2a5087(0x89)])(this[_0x2a5087(0x9d)],JSON[_0x2a5087(0xa9)](this[_0x2a5087(0x8e)]));}}function a58_0x16b2(){const _0xa9829a=['search','initObjectStatistics','_jobPath','FAILED','apply','updateLoggerState','JOB_LOG_STATE_FILENAME','stringify','setObjectStatus','COMPLETED','11247230NoXOsD','(((.+)+)+)+$','../../enums/logger.enums','762578ZVCxvz','getObjectState','JobStatus','ObjectStatus','default','3AYsvlQ','error','2714692xvNWKZ','14FoGRFi','FsUtils','jobStorePath','setJobStatus','5194521UgFwhX','map','isExistsPath','initJobState','getTime','12gFREFx','__importDefault','find','QUEUED','setJobError','isLoggerInit','status','writeFile','./base-logger','readFile','updateObjectProcess','3OVvfQV','_jobState','4910609KMqkzQ','failed','toString','BaseLogger','LoggerJobState','../../../../../constants/job','defineProperty','processed','join','2750080FXzEza','successful','_isLoggerInit','getJobState','jobState','filePath','name','write','784965VTvLzh','completedDate'];a58_0x16b2=function(){return _0xa9829a;};return a58_0x16b2();}exports[a58_0x25fb6d(0x93)]=LoggerJobState;