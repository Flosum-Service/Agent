const a58_0x17b242=a58_0x4647;(function(_0x303a9c,_0x17243f){const _0x37eceb=a58_0x4647,_0x218a96=_0x303a9c();while(!![]){try{const _0x50f602=parseInt(_0x37eceb(0x1af))/0x1*(parseInt(_0x37eceb(0x18a))/0x2)+parseInt(_0x37eceb(0x1a1))/0x3+parseInt(_0x37eceb(0x19b))/0x4+parseInt(_0x37eceb(0x1ac))/0x5*(-parseInt(_0x37eceb(0x192))/0x6)+parseInt(_0x37eceb(0x198))/0x7+-parseInt(_0x37eceb(0x18b))/0x8*(parseInt(_0x37eceb(0x1ab))/0x9)+-parseInt(_0x37eceb(0x194))/0xa;if(_0x50f602===_0x17243f)break;else _0x218a96['push'](_0x218a96['shift']());}catch(_0x305abf){_0x218a96['push'](_0x218a96['shift']());}}}(a58_0xa0bb,0x7bdc5));function a58_0x4647(_0x426e8a,_0x5349d1){const _0xdb7291=a58_0xa0bb();return a58_0x4647=function(_0x211e5d,_0x20fe2c){_0x211e5d=_0x211e5d-0x178;let _0xa0bb48=_0xdb7291[_0x211e5d];return _0xa0bb48;},a58_0x4647(_0x426e8a,_0x5349d1);}const a58_0x20fe2c=(function(){let _0x54febb=!![];return function(_0x3016cf,_0x3960f7){const _0x371ebd=_0x54febb?function(){const _0x89a38a=a58_0x4647;if(_0x3960f7){const _0x5a19c2=_0x3960f7[_0x89a38a(0x191)](_0x3016cf,arguments);return _0x3960f7=null,_0x5a19c2;}}:function(){};return _0x54febb=![],_0x371ebd;};}()),a58_0x211e5d=a58_0x20fe2c(this,function(){const _0xa434bb=a58_0x4647;return a58_0x211e5d['toString']()['search']('(((.+)+)+)+$')['toString']()[_0xa434bb(0x17b)](a58_0x211e5d)[_0xa434bb(0x1a4)](_0xa434bb(0x1a6));});a58_0x211e5d();'use strict';var __importDefault=this&&this[a58_0x17b242(0x197)]||function(_0x4840c4){const _0x5c44ee=a58_0x17b242;return _0x4840c4&&_0x4840c4[_0x5c44ee(0x186)]?_0x4840c4:{'default':_0x4840c4};};Object[a58_0x17b242(0x19f)](exports,a58_0x17b242(0x186),{'value':!![]}),exports[a58_0x17b242(0x181)]=void 0x0;function a58_0xa0bb(){const _0x48074a=['fs/promises','start','371043fzZBKz','2533675hmnwYi','../../enums/logger.enums','failed','26kFngrZ','processed','getObjectState','writeFile','setObjectStatus','path','readFile','BaseLogger','updateObjectProcess','constructor','./base-logger','../../job-detail','JobStatus','setJobStatus','initObjectStatistics','LoggerJobState','isLoggerInit','initJobState','jobState','getTime','__esModule','name','map','FAILED','38258OTHzvM','24dMjtTg','default','status','filePath','../../../../../constants/job','Cannot\x20find\x20object\x20\x27','apply','6YPZGkw','_isLoggerInit','5894500HkOBWD','JOB_LOG_STATE_FILENAME','QUEUED','__importDefault','3947321HyXbca','includes','updateLoggerState','435076RsXmzU','write','_jobPath','successful','defineProperty','completedDate','1671519hUwjMf','FsUtils','jobStorePath','search','setJobError','(((.+)+)+)+$','getJobState','_jobState'];a58_0xa0bb=function(){return _0x48074a;};return a58_0xa0bb();}const path_1=__importDefault(require(a58_0x17b242(0x1b4))),logger_enums_1=require(a58_0x17b242(0x1ad)),base_logger_1=require(a58_0x17b242(0x17c)),promises_1=require(a58_0x17b242(0x1a9)),job_detail_1=require(a58_0x17b242(0x17d)),utils_1=require('@flosum/utils'),job_1=require(a58_0x17b242(0x18f));class LoggerJobState extends base_logger_1[a58_0x17b242(0x179)]{constructor(){super(...arguments),this['_isLoggerInit']=![];}get['isLoggerInit'](){const _0x23c246=a58_0x17b242;return this[_0x23c246(0x193)];}set[a58_0x17b242(0x182)](_0x315dfb){const _0x51a21e=a58_0x17b242;this[_0x51a21e(0x193)]=_0x315dfb;}get[a58_0x17b242(0x184)](){const _0x54e367=a58_0x17b242;if(!this[_0x54e367(0x182)])throw new Error('Logger\x20Job\x20State\x20wasn\x27t\x20init');return this['_jobState'];}get[a58_0x17b242(0x18e)](){const _0x16a1cc=a58_0x17b242;return path_1[_0x16a1cc(0x18c)]['join'](this[_0x16a1cc(0x19d)],job_1[_0x16a1cc(0x195)]);}async['init'](_0x2b6732){const _0x2b0b47=a58_0x17b242;return this[_0x2b0b47(0x1a8)]=await this[_0x2b0b47(0x1a7)](),this[_0x2b0b47(0x1a8)][_0x2b0b47(0x1b0)]=this[_0x2b0b47(0x180)](_0x2b6732),await this['write'](),await this[_0x2b0b47(0x1aa)](),this[_0x2b0b47(0x182)]=!![],this;}[a58_0x17b242(0x1b3)](_0x296dc8,_0x4d04b8){const _0x5405b8=a58_0x17b242;this[_0x5405b8(0x1b1)](_0x296dc8)[_0x5405b8(0x18d)]=_0x4d04b8,this[_0x5405b8(0x19a)]();}[a58_0x17b242(0x17f)](_0x4c61e7){const _0x5f453d=a58_0x17b242;this['jobState'][_0x5f453d(0x18d)]=_0x4c61e7,[logger_enums_1[_0x5f453d(0x17e)][_0x5f453d(0x189)],logger_enums_1[_0x5f453d(0x17e)]['COMPLETED']][_0x5f453d(0x199)](_0x4c61e7)&&(this['jobState'][_0x5f453d(0x1a0)]=new Date()[_0x5f453d(0x185)]()),this[_0x5f453d(0x19a)]();}[a58_0x17b242(0x1a5)](_0x54ff42){const _0x4ef819=a58_0x17b242;this[_0x4ef819(0x184)]['error']=_0x54ff42,this[_0x4ef819(0x19a)]();}[a58_0x17b242(0x17a)](_0x2487b6,_0x58c968,_0x2c71a6){const _0x56c8e6=a58_0x17b242,_0x5d3b6c=this['getObjectState'](_0x2487b6);_0x5d3b6c[_0x56c8e6(0x19e)]+=_0x58c968,_0x5d3b6c[_0x56c8e6(0x1ae)]+=_0x2c71a6,this[_0x56c8e6(0x184)][_0x56c8e6(0x19e)]+=_0x58c968,this[_0x56c8e6(0x184)][_0x56c8e6(0x1ae)]+=_0x2c71a6,this[_0x56c8e6(0x19a)]();}[a58_0x17b242(0x1b1)](_0x3ab930){const _0x4f9a24=a58_0x17b242;var _0x2ef80b;const _0x17a575=(_0x2ef80b=this['jobState'][_0x4f9a24(0x1b0)])===null||_0x2ef80b===void 0x0?void 0x0:_0x2ef80b['find'](_0x54687b=>_0x54687b[_0x4f9a24(0x187)]===_0x3ab930);if(!_0x17a575)throw new Error(_0x4f9a24(0x190)+_0x3ab930+'\x27\x20in\x20statistic');return _0x17a575;}async[a58_0x17b242(0x1a7)](){const _0x11a9f2=a58_0x17b242;if(!await utils_1[_0x11a9f2(0x1a2)]['isExistsPath'](this[_0x11a9f2(0x18e)]))return this[_0x11a9f2(0x183)]();const _0x3c3c56=await(0x0,promises_1[_0x11a9f2(0x178)])(job_detail_1[_0x11a9f2(0x1a3)]+'/'+job_1[_0x11a9f2(0x195)],{'encoding':'utf-8'});return JSON['parse'](_0x3c3c56);}['initJobState'](){const _0x4370b5=a58_0x17b242;return{'id':this['_jobId'],'status':logger_enums_1[_0x4370b5(0x17e)]['QUEUED'],'processed':[],'createdDate':new Date()[_0x4370b5(0x185)](),'successful':0x0,'failed':0x0};}[a58_0x17b242(0x180)](_0x49c34b){const _0x3e18c5=a58_0x17b242;return _0x49c34b[_0x3e18c5(0x188)](_0x5df299=>({'name':_0x5df299,'status':logger_enums_1['ObjectStatus'][_0x3e18c5(0x196)],'failed':0x0,'successful':0x0}));}[a58_0x17b242(0x19c)](){const _0x32f80e=a58_0x17b242;return(0x0,promises_1[_0x32f80e(0x1b2)])(this['filePath'],JSON['stringify'](this['_jobState']));}}exports[a58_0x17b242(0x181)]=LoggerJobState;