const a58_0x25d9b3=a58_0x40ac;(function(_0x2e028d,_0x48b225){const _0x344d28=a58_0x40ac,_0x3a9e82=_0x2e028d();while(!![]){try{const _0x2bc0c7=parseInt(_0x344d28(0x188))/0x1+parseInt(_0x344d28(0x16b))/0x2*(-parseInt(_0x344d28(0x172))/0x3)+-parseInt(_0x344d28(0x18d))/0x4*(parseInt(_0x344d28(0x182))/0x5)+parseInt(_0x344d28(0x178))/0x6+parseInt(_0x344d28(0x191))/0x7+parseInt(_0x344d28(0x187))/0x8+-parseInt(_0x344d28(0x194))/0x9;if(_0x2bc0c7===_0x48b225)break;else _0x3a9e82['push'](_0x3a9e82['shift']());}catch(_0x35926d){_0x3a9e82['push'](_0x3a9e82['shift']());}}}(a58_0x295d,0x62cb6));const a58_0x32fe4d=(function(){let _0x565b11=!![];return function(_0xa982f4,_0x14ec35){const _0x5d7c14=_0x565b11?function(){const _0x583a6b=a58_0x40ac;if(_0x14ec35){const _0xcd9178=_0x14ec35[_0x583a6b(0x171)](_0xa982f4,arguments);return _0x14ec35=null,_0xcd9178;}}:function(){};return _0x565b11=![],_0x5d7c14;};}()),a58_0x625685=a58_0x32fe4d(this,function(){const _0x11a101=a58_0x40ac;return a58_0x625685[_0x11a101(0x183)]()[_0x11a101(0x167)](_0x11a101(0x17e))['toString']()[_0x11a101(0x165)](a58_0x625685)['search'](_0x11a101(0x17e));});a58_0x625685();function a58_0x40ac(_0x247977,_0x2ea2ee){const _0x1c27b9=a58_0x295d();return a58_0x40ac=function(_0x625685,_0x32fe4d){_0x625685=_0x625685-0x157;let _0x295d8c=_0x1c27b9[_0x625685];return _0x295d8c;},a58_0x40ac(_0x247977,_0x2ea2ee);}'use strict';var __importDefault=this&&this[a58_0x25d9b3(0x17a)]||function(_0x2d2655){const _0x789cfd=a58_0x25d9b3;return _0x2d2655&&_0x2d2655[_0x789cfd(0x185)]?_0x2d2655:{'default':_0x2d2655};};Object[a58_0x25d9b3(0x169)](exports,'__esModule',{'value':!![]}),exports[a58_0x25d9b3(0x18f)]=void 0x0;const path_1=__importDefault(require(a58_0x25d9b3(0x15c))),logger_enums_1=require(a58_0x25d9b3(0x164)),base_logger_1=require('./base-logger'),promises_1=require(a58_0x25d9b3(0x17c)),job_detail_1=require('../../job-detail'),utils_1=require('@flosum/utils'),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1[a58_0x25d9b3(0x193)]{constructor(){const _0x153f2e=a58_0x25d9b3;super(...arguments),this[_0x153f2e(0x175)]=![];}get[a58_0x25d9b3(0x17b)](){const _0x43bd2d=a58_0x25d9b3;return this[_0x43bd2d(0x175)];}set[a58_0x25d9b3(0x17b)](_0x591b93){const _0x15f6de=a58_0x25d9b3;this[_0x15f6de(0x175)]=_0x591b93;}get['jobState'](){const _0x3200ad=a58_0x25d9b3;if(!this['isLoggerInit'])throw new Error(_0x3200ad(0x18c));return this[_0x3200ad(0x186)];}get[a58_0x25d9b3(0x16c)](){const _0x432231=a58_0x25d9b3;return path_1[_0x432231(0x180)][_0x432231(0x179)](this['_jobPath'],job_1['JOB_LOG_STATE_FILENAME']);}async[a58_0x25d9b3(0x168)](_0x1134ee){const _0x269f14=a58_0x25d9b3;return this[_0x269f14(0x186)]=await this[_0x269f14(0x173)](),this[_0x269f14(0x186)]['processed']=this[_0x269f14(0x17d)](_0x1134ee),await this[_0x269f14(0x184)](),await this[_0x269f14(0x15e)](),this[_0x269f14(0x17b)]=!![],this;}[a58_0x25d9b3(0x15f)](_0x3d178f,_0x3210d6){const _0x395f18=a58_0x25d9b3;this['getObjectState'](_0x3d178f)[_0x395f18(0x16f)]=_0x3210d6,this['updateLoggerState']();}['setJobStatus'](_0x52dbce){const _0x3edbec=a58_0x25d9b3;this['jobState'][_0x3edbec(0x16f)]=_0x52dbce,[logger_enums_1[_0x3edbec(0x174)][_0x3edbec(0x159)],logger_enums_1['JobStatus'][_0x3edbec(0x17f)]]['includes'](_0x52dbce)&&(this[_0x3edbec(0x162)]['completedDate']=new Date()[_0x3edbec(0x18e)]()),this['updateLoggerState']();}[a58_0x25d9b3(0x15a)](_0x304410){const _0x509991=a58_0x25d9b3;this[_0x509991(0x162)][_0x509991(0x192)]=_0x304410,this[_0x509991(0x166)]();}['updateObjectProcess'](_0x33dfa4,_0x5bf7e1,_0x440181){const _0x3c186b=a58_0x25d9b3,_0x4e091d=this['getObjectState'](_0x33dfa4);_0x4e091d[_0x3c186b(0x16a)]+=_0x5bf7e1,_0x4e091d[_0x3c186b(0x190)]+=_0x440181,this['jobState'][_0x3c186b(0x16a)]+=_0x5bf7e1,this[_0x3c186b(0x162)][_0x3c186b(0x190)]+=_0x440181,this[_0x3c186b(0x166)]();}[a58_0x25d9b3(0x158)](_0x38cf73){const _0x4d4c6b=a58_0x25d9b3;var _0xed1478;const _0x342f73=(_0xed1478=this['jobState']['processed'])===null||_0xed1478===void 0x0?void 0x0:_0xed1478[_0x4d4c6b(0x157)](_0x361174=>_0x361174[_0x4d4c6b(0x163)]===_0x38cf73);if(!_0x342f73)throw new Error(_0x4d4c6b(0x160)+_0x38cf73+'\x27\x20in\x20statistic');return _0x342f73;}async[a58_0x25d9b3(0x173)](){const _0x585ee7=a58_0x25d9b3;if(!await utils_1[_0x585ee7(0x170)][_0x585ee7(0x189)](this[_0x585ee7(0x16c)]))return this[_0x585ee7(0x18a)]();const _0x290680=await(0x0,promises_1[_0x585ee7(0x18b)])(job_detail_1[_0x585ee7(0x15b)]+'/'+job_1[_0x585ee7(0x177)],{'encoding':_0x585ee7(0x15d)});return JSON[_0x585ee7(0x181)](_0x290680);}[a58_0x25d9b3(0x18a)](){const _0x48b55b=a58_0x25d9b3;return{'id':this[_0x48b55b(0x16d)],'status':logger_enums_1[_0x48b55b(0x174)][_0x48b55b(0x16e)],'processed':[],'createdDate':new Date()[_0x48b55b(0x18e)](),'successful':0x0,'failed':0x0};}[a58_0x25d9b3(0x17d)](_0x34733e){const _0x4f0d15=a58_0x25d9b3;return _0x34733e['map'](_0x24632c=>({'name':_0x24632c,'status':logger_enums_1[_0x4f0d15(0x161)][_0x4f0d15(0x16e)],'failed':0x0,'successful':0x0}));}['write'](){const _0x24f368=a58_0x25d9b3;return(0x0,promises_1['writeFile'])(this[_0x24f368(0x16c)],JSON[_0x24f368(0x176)](this[_0x24f368(0x186)]));}}function a58_0x295d(){const _0x528e57=['find','getObjectState','FAILED','setJobError','jobStorePath','path','utf-8','start','setObjectStatus','Cannot\x20find\x20object\x20\x27','ObjectStatus','jobState','name','../../enums/logger.enums','constructor','updateLoggerState','search','init','defineProperty','successful','896640VIGcVO','filePath','_jobId','QUEUED','status','FsUtils','apply','3OvxUxJ','getJobState','JobStatus','_isLoggerInit','stringify','JOB_LOG_STATE_FILENAME','1776918xkvUkV','join','__importDefault','isLoggerInit','fs/promises','initObjectStatistics','(((.+)+)+)+$','COMPLETED','default','parse','121865KPNKXQ','toString','write','__esModule','_jobState','3853504FelgRr','107406GUmdUM','isExistsPath','initJobState','readFile','Logger\x20Job\x20State\x20wasn\x27t\x20init','12KOZJUn','getTime','LoggerJobState','failed','1459325ZkbdcR','error','BaseLogger','1508589PsIeiJ'];a58_0x295d=function(){return _0x528e57;};return a58_0x295d();}exports['LoggerJobState']=LoggerJobState;