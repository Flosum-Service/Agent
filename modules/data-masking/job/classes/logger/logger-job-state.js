const a58_0x5134f6=a58_0x35fa;function a58_0x2192(){const _0x38d119=['5964ntgGHT','getTime','isExistsPath','4942102aGRlFr','includes','error','constructor','QUEUED','write','utf-8','./base-logger','JobStatus','2474580YJNmjB','stringify','../../../../../constants/job','ObjectStatus','setObjectStatus','7JtYQkc','apply','Cannot\x20find\x20object\x20\x27','15550OIKvxJ','isLoggerInit','initJobState','Logger\x20Job\x20State\x20wasn\x27t\x20init','51eRbxSL','FAILED','init','successful','959992RrRqjR','\x27\x20in\x20statistic','28bSmoig','getObjectState','_isLoggerInit','completedDate','status','map','2062385XlbhHw','toString','processed','COMPLETED','initObjectStatistics','__esModule','(((.+)+)+)+$','LoggerJobState','_jobState','name','start','failed','filePath','updateObjectProcess','updateLoggerState','setJobError','find','default','parse','JOB_LOG_STATE_FILENAME','writeFile','26632blJbrH','search','18cvfbbr','setJobStatus','jobState'];a58_0x2192=function(){return _0x38d119;};return a58_0x2192();}(function(_0x2aa620,_0x9a0f20){const _0x319f40=a58_0x35fa,_0x5b9b7e=_0x2aa620();while(!![]){try{const _0x5cb7f1=-parseInt(_0x319f40(0x20c))/0x1*(-parseInt(_0x319f40(0x1e9))/0x2)+parseInt(_0x319f40(0x206))/0x3*(-parseInt(_0x319f40(0x1ee))/0x4)+-parseInt(_0x319f40(0x212))/0x5+-parseInt(_0x319f40(0x1fa))/0x6*(parseInt(_0x319f40(0x1ff))/0x7)+-parseInt(_0x319f40(0x20a))/0x8*(-parseInt(_0x319f40(0x1eb))/0x9)+-parseInt(_0x319f40(0x202))/0xa+parseInt(_0x319f40(0x1f1))/0xb;if(_0x5cb7f1===_0x9a0f20)break;else _0x5b9b7e['push'](_0x5b9b7e['shift']());}catch(_0x504c29){_0x5b9b7e['push'](_0x5b9b7e['shift']());}}}(a58_0x2192,0x3358f));const a58_0x3b0cae=(function(){let _0x500923=!![];return function(_0x3993a7,_0x156ce3){const _0x3c0cda=_0x500923?function(){const _0x489fb8=a58_0x35fa;if(_0x156ce3){const _0x77cc08=_0x156ce3[_0x489fb8(0x200)](_0x3993a7,arguments);return _0x156ce3=null,_0x77cc08;}}:function(){};return _0x500923=![],_0x3c0cda;};}()),a58_0x3e1922=a58_0x3b0cae(this,function(){const _0x5c160a=a58_0x35fa;return a58_0x3e1922[_0x5c160a(0x213)]()['search']('(((.+)+)+)+$')[_0x5c160a(0x213)]()[_0x5c160a(0x1f4)](a58_0x3e1922)[_0x5c160a(0x1ea)](_0x5c160a(0x218));});a58_0x3e1922();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x385174){const _0x13238d=a58_0x35fa;return _0x385174&&_0x385174[_0x13238d(0x217)]?_0x385174:{'default':_0x385174};};function a58_0x35fa(_0x106ebd,_0x304678){const _0x22c76c=a58_0x2192();return a58_0x35fa=function(_0x3e1922,_0x3b0cae){_0x3e1922=_0x3e1922-0x1dd;let _0x219200=_0x22c76c[_0x3e1922];return _0x219200;},a58_0x35fa(_0x106ebd,_0x304678);}Object['defineProperty'](exports,a58_0x5134f6(0x217),{'value':!![]}),exports[a58_0x5134f6(0x219)]=void 0x0;const path_1=__importDefault(require('path')),logger_enums_1=require('../../enums/logger.enums'),base_logger_1=require(a58_0x5134f6(0x1f8)),promises_1=require('fs/promises'),job_detail_1=require('../../job-detail'),utils_1=require('@flosum/utils'),job_1=require(a58_0x5134f6(0x1fc));class LoggerJobState extends base_logger_1['BaseLogger']{constructor(){const _0xbad203=a58_0x5134f6;super(...arguments),this[_0xbad203(0x20e)]=![];}get['isLoggerInit'](){const _0x47a387=a58_0x5134f6;return this[_0x47a387(0x20e)];}set[a58_0x5134f6(0x203)](_0x305026){this['_isLoggerInit']=_0x305026;}get[a58_0x5134f6(0x1ed)](){const _0x5f2158=a58_0x5134f6;if(!this['isLoggerInit'])throw new Error(_0x5f2158(0x205));return this[_0x5f2158(0x21a)];}get['filePath'](){const _0x376d4d=a58_0x5134f6;return path_1[_0x376d4d(0x1e5)]['join'](this['_jobPath'],job_1[_0x376d4d(0x1e7)]);}async[a58_0x5134f6(0x208)](_0x526644){const _0x16e16f=a58_0x5134f6;return this[_0x16e16f(0x21a)]=await this['getJobState'](),this[_0x16e16f(0x21a)][_0x16e16f(0x214)]=this[_0x16e16f(0x216)](_0x526644),await this[_0x16e16f(0x1f6)](),await this[_0x16e16f(0x1de)](),this[_0x16e16f(0x203)]=!![],this;}[a58_0x5134f6(0x1fe)](_0x7a368c,_0xab8d90){const _0x56f276=a58_0x5134f6;this[_0x56f276(0x20d)](_0x7a368c)[_0x56f276(0x210)]=_0xab8d90,this[_0x56f276(0x1e2)]();}[a58_0x5134f6(0x1ec)](_0x1404f9){const _0x3db290=a58_0x5134f6;this[_0x3db290(0x1ed)][_0x3db290(0x210)]=_0x1404f9,[logger_enums_1[_0x3db290(0x1f9)][_0x3db290(0x207)],logger_enums_1[_0x3db290(0x1f9)][_0x3db290(0x215)]][_0x3db290(0x1f2)](_0x1404f9)&&(this[_0x3db290(0x1ed)][_0x3db290(0x20f)]=new Date()[_0x3db290(0x1ef)]()),this['updateLoggerState']();}[a58_0x5134f6(0x1e3)](_0x32fd25){const _0x310781=a58_0x5134f6;this['jobState'][_0x310781(0x1f3)]=_0x32fd25,this['updateLoggerState']();}[a58_0x5134f6(0x1e1)](_0xd2a742,_0x154152,_0x4066ec){const _0x47e147=a58_0x5134f6,_0x689020=this[_0x47e147(0x20d)](_0xd2a742);_0x689020[_0x47e147(0x209)]+=_0x154152,_0x689020[_0x47e147(0x1df)]+=_0x4066ec,this[_0x47e147(0x1ed)][_0x47e147(0x209)]+=_0x154152,this['jobState']['failed']+=_0x4066ec,this[_0x47e147(0x1e2)]();}[a58_0x5134f6(0x20d)](_0x52fc98){const _0x1d4715=a58_0x5134f6;var _0x31ca67;const _0x2187ed=(_0x31ca67=this['jobState']['processed'])===null||_0x31ca67===void 0x0?void 0x0:_0x31ca67[_0x1d4715(0x1e4)](_0x50b148=>_0x50b148[_0x1d4715(0x1dd)]===_0x52fc98);if(!_0x2187ed)throw new Error(_0x1d4715(0x201)+_0x52fc98+_0x1d4715(0x20b));return _0x2187ed;}async['getJobState'](){const _0x13dd7b=a58_0x5134f6;if(!await utils_1['FsUtils'][_0x13dd7b(0x1f0)](this['filePath']))return this[_0x13dd7b(0x204)]();const _0x26ae1d=await(0x0,promises_1['readFile'])(job_detail_1['jobStorePath']+'/'+job_1['JOB_LOG_STATE_FILENAME'],{'encoding':_0x13dd7b(0x1f7)});return JSON[_0x13dd7b(0x1e6)](_0x26ae1d);}[a58_0x5134f6(0x204)](){const _0x271a2c=a58_0x5134f6;return{'id':this['_jobId'],'status':logger_enums_1[_0x271a2c(0x1f9)][_0x271a2c(0x1f5)],'processed':[],'createdDate':new Date()[_0x271a2c(0x1ef)](),'successful':0x0,'failed':0x0};}[a58_0x5134f6(0x216)](_0x5bda4f){const _0x9da1af=a58_0x5134f6;return _0x5bda4f[_0x9da1af(0x211)](_0x546708=>({'name':_0x546708,'status':logger_enums_1[_0x9da1af(0x1fd)][_0x9da1af(0x1f5)],'failed':0x0,'successful':0x0}));}['write'](){const _0x1917db=a58_0x5134f6;return(0x0,promises_1[_0x1917db(0x1e8)])(this[_0x1917db(0x1e0)],JSON[_0x1917db(0x1fb)](this['_jobState']));}}exports[a58_0x5134f6(0x219)]=LoggerJobState;