const a58_0x485a0d=a58_0x4125;(function(_0x273d93,_0x10a874){const _0x181598=a58_0x4125,_0x4cc113=_0x273d93();while(!![]){try{const _0xa213dc=-parseInt(_0x181598(0x1f4))/0x1*(parseInt(_0x181598(0x21a))/0x2)+-parseInt(_0x181598(0x213))/0x3+parseInt(_0x181598(0x1ed))/0x4*(-parseInt(_0x181598(0x1fd))/0x5)+-parseInt(_0x181598(0x228))/0x6*(-parseInt(_0x181598(0x1ee))/0x7)+-parseInt(_0x181598(0x223))/0x8+-parseInt(_0x181598(0x1fe))/0x9*(parseInt(_0x181598(0x205))/0xa)+-parseInt(_0x181598(0x1f5))/0xb*(-parseInt(_0x181598(0x202))/0xc);if(_0xa213dc===_0x10a874)break;else _0x4cc113['push'](_0x4cc113['shift']());}catch(_0x26265c){_0x4cc113['push'](_0x4cc113['shift']());}}}(a58_0x3395,0xb7e65));const a58_0x38bea4=(function(){let _0x197996=!![];return function(_0x1c3b3f,_0xec1ce6){const _0x4b0c7b=_0x197996?function(){const _0x207e52=a58_0x4125;if(_0xec1ce6){const _0x5552d3=_0xec1ce6[_0x207e52(0x225)](_0x1c3b3f,arguments);return _0xec1ce6=null,_0x5552d3;}}:function(){};return _0x197996=![],_0x4b0c7b;};}()),a58_0x349437=a58_0x38bea4(this,function(){const _0x682501=a58_0x4125;return a58_0x349437[_0x682501(0x21d)]()['search'](_0x682501(0x207))[_0x682501(0x21d)]()[_0x682501(0x21b)](a58_0x349437)[_0x682501(0x218)]('(((.+)+)+)+$');});a58_0x349437();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x7763d3){return _0x7763d3&&_0x7763d3['__esModule']?_0x7763d3:{'default':_0x7763d3};};function a58_0x4125(_0x35c024,_0x5ed2ec){const _0x1875d4=a58_0x3395();return a58_0x4125=function(_0x349437,_0x38bea4){_0x349437=_0x349437-0x1ec;let _0x3395a4=_0x1875d4[_0x349437];return _0x3395a4;},a58_0x4125(_0x35c024,_0x5ed2ec);}function a58_0x3395(){const _0x5d62e5=['534318KGFTsv','status','_jobState','setObjectStatus','includes','search','writeFile','2595002MIZNEZ','constructor','../../job-detail','toString','start','isLoggerInit','updateLoggerState','processed','Cannot\x20find\x20object\x20\x27','6663264AoVNTg','LoggerJobState','apply','completedDate','BaseLogger','6oXZwyv','default','getJobState','readFile','initJobState','successful','JobStatus','4Kwdlul','2938901wNfCez','filePath','\x27\x20in\x20statistic','ObjectStatus','FAILED','__esModule','1ssQvRt','134651yEtEEP','Logger\x20Job\x20State\x20wasn\x27t\x20init','updateObjectProcess','initObjectStatistics','defineProperty','_jobId','../../../../../constants/job','path','734645ngapkk','9TaNuas','FsUtils','_isLoggerInit','COMPLETED','3468UsJdgS','getTime','failed','7487950sOtLiW','parse','(((.+)+)+)+$','write','join','utf-8','setJobStatus','../../enums/logger.enums','getObjectState','name','jobStorePath','error','JOB_LOG_STATE_FILENAME','jobState'];a58_0x3395=function(){return _0x5d62e5;};return a58_0x3395();}Object[a58_0x485a0d(0x1f9)](exports,a58_0x485a0d(0x1f3),{'value':!![]}),exports['LoggerJobState']=void 0x0;const path_1=__importDefault(require(a58_0x485a0d(0x1fc))),logger_enums_1=require(a58_0x485a0d(0x20c)),base_logger_1=require('./base-logger'),promises_1=require('fs/promises'),job_detail_1=require(a58_0x485a0d(0x21c)),utils_1=require('@flosum/utils'),job_1=require(a58_0x485a0d(0x1fb));class LoggerJobState extends base_logger_1[a58_0x485a0d(0x227)]{constructor(){const _0x5c8422=a58_0x485a0d;super(...arguments),this[_0x5c8422(0x200)]=![];}get['isLoggerInit'](){return this['_isLoggerInit'];}set[a58_0x485a0d(0x21f)](_0x2b7c76){const _0x53f78f=a58_0x485a0d;this[_0x53f78f(0x200)]=_0x2b7c76;}get[a58_0x485a0d(0x212)](){const _0x38d403=a58_0x485a0d;if(!this[_0x38d403(0x21f)])throw new Error(_0x38d403(0x1f6));return this['_jobState'];}get[a58_0x485a0d(0x1ef)](){const _0x1599c5=a58_0x485a0d;return path_1[_0x1599c5(0x229)][_0x1599c5(0x209)](this['_jobPath'],job_1[_0x1599c5(0x211)]);}async['init'](_0x2e4a50){const _0x112d25=a58_0x485a0d;return this[_0x112d25(0x215)]=await this[_0x112d25(0x22a)](),this[_0x112d25(0x215)][_0x112d25(0x221)]=this['initObjectStatistics'](_0x2e4a50),await this[_0x112d25(0x208)](),await this[_0x112d25(0x21e)](),this[_0x112d25(0x21f)]=!![],this;}[a58_0x485a0d(0x216)](_0x9e962e,_0x1e8969){const _0x3e7ca8=a58_0x485a0d;this[_0x3e7ca8(0x20d)](_0x9e962e)['status']=_0x1e8969,this['updateLoggerState']();}[a58_0x485a0d(0x20b)](_0x33e5db){const _0x483eaf=a58_0x485a0d;this[_0x483eaf(0x212)][_0x483eaf(0x214)]=_0x33e5db,[logger_enums_1[_0x483eaf(0x1ec)][_0x483eaf(0x1f2)],logger_enums_1[_0x483eaf(0x1ec)][_0x483eaf(0x201)]][_0x483eaf(0x217)](_0x33e5db)&&(this['jobState'][_0x483eaf(0x226)]=new Date()['getTime']()),this[_0x483eaf(0x220)]();}['setJobError'](_0x3df818){const _0x2873c6=a58_0x485a0d;this[_0x2873c6(0x212)][_0x2873c6(0x210)]=_0x3df818,this[_0x2873c6(0x220)]();}[a58_0x485a0d(0x1f7)](_0x5bb3ad,_0x157539,_0x1fdbc1){const _0x490bb2=a58_0x485a0d,_0x1c7720=this[_0x490bb2(0x20d)](_0x5bb3ad);_0x1c7720[_0x490bb2(0x22d)]+=_0x157539,_0x1c7720[_0x490bb2(0x204)]+=_0x1fdbc1,this['jobState']['successful']+=_0x157539,this[_0x490bb2(0x212)]['failed']+=_0x1fdbc1,this[_0x490bb2(0x220)]();}[a58_0x485a0d(0x20d)](_0x2b5d1c){const _0x5e01c6=a58_0x485a0d;var _0x22a63e;const _0x5ef259=(_0x22a63e=this[_0x5e01c6(0x212)][_0x5e01c6(0x221)])===null||_0x22a63e===void 0x0?void 0x0:_0x22a63e['find'](_0x238803=>_0x238803[_0x5e01c6(0x20e)]===_0x2b5d1c);if(!_0x5ef259)throw new Error(_0x5e01c6(0x222)+_0x2b5d1c+_0x5e01c6(0x1f0));return _0x5ef259;}async['getJobState'](){const _0x25716d=a58_0x485a0d;if(!await utils_1[_0x25716d(0x1ff)]['isExistsPath'](this[_0x25716d(0x1ef)]))return this[_0x25716d(0x22c)]();const _0x5e4412=await(0x0,promises_1[_0x25716d(0x22b)])(job_detail_1[_0x25716d(0x20f)]+'/'+job_1[_0x25716d(0x211)],{'encoding':_0x25716d(0x20a)});return JSON[_0x25716d(0x206)](_0x5e4412);}[a58_0x485a0d(0x22c)](){const _0x57301f=a58_0x485a0d;return{'id':this[_0x57301f(0x1fa)],'status':logger_enums_1[_0x57301f(0x1ec)]['QUEUED'],'processed':[],'createdDate':new Date()[_0x57301f(0x203)](),'successful':0x0,'failed':0x0};}[a58_0x485a0d(0x1f8)](_0x2ec987){const _0x314397=a58_0x485a0d;return _0x2ec987['map'](_0x475a51=>({'name':_0x475a51,'status':logger_enums_1[_0x314397(0x1f1)]['QUEUED'],'failed':0x0,'successful':0x0}));}[a58_0x485a0d(0x208)](){const _0x505b85=a58_0x485a0d;return(0x0,promises_1[_0x505b85(0x219)])(this[_0x505b85(0x1ef)],JSON['stringify'](this[_0x505b85(0x215)]));}}exports[a58_0x485a0d(0x224)]=LoggerJobState;