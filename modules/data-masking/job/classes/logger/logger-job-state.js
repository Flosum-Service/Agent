const a76_0x41de92=a76_0x4644;(function(_0xcd8170,_0x47c4ed){const _0x321e1b=a76_0x4644,_0x1f9e4a=_0xcd8170();while(!![]){try{const _0x10c21c=parseInt(_0x321e1b(0x1e5))/0x1*(parseInt(_0x321e1b(0x21d))/0x2)+parseInt(_0x321e1b(0x1f5))/0x3*(parseInt(_0x321e1b(0x1ed))/0x4)+-parseInt(_0x321e1b(0x210))/0x5+-parseInt(_0x321e1b(0x1f9))/0x6*(parseInt(_0x321e1b(0x1fd))/0x7)+-parseInt(_0x321e1b(0x1e1))/0x8*(parseInt(_0x321e1b(0x1e7))/0x9)+-parseInt(_0x321e1b(0x1fb))/0xa*(parseInt(_0x321e1b(0x1e0))/0xb)+parseInt(_0x321e1b(0x221))/0xc;if(_0x10c21c===_0x47c4ed)break;else _0x1f9e4a['push'](_0x1f9e4a['shift']());}catch(_0x26fa95){_0x1f9e4a['push'](_0x1f9e4a['shift']());}}}(a76_0x18eb,0x69db8));const a76_0x47412d=(function(){let _0x4b5051=!![];return function(_0x184f8a,_0x2a30f7){const _0x4d5ef5=_0x4b5051?function(){const _0x1b2cfc=a76_0x4644;if(_0x2a30f7){const _0x46801d=_0x2a30f7[_0x1b2cfc(0x206)](_0x184f8a,arguments);return _0x2a30f7=null,_0x46801d;}}:function(){};return _0x4b5051=![],_0x4d5ef5;};}()),a76_0x3562a0=a76_0x47412d(this,function(){const _0x32e7fa=a76_0x4644;return a76_0x3562a0[_0x32e7fa(0x208)]()[_0x32e7fa(0x1f1)](_0x32e7fa(0x205))['toString']()[_0x32e7fa(0x220)](a76_0x3562a0)[_0x32e7fa(0x1f1)](_0x32e7fa(0x205));});a76_0x3562a0();'use strict';function a76_0x4644(_0x44435d,_0x5449b8){const _0x115ec4=a76_0x18eb();return a76_0x4644=function(_0x3562a0,_0x47412d){_0x3562a0=_0x3562a0-0x1dc;let _0x18eb00=_0x115ec4[_0x3562a0];return _0x18eb00;},a76_0x4644(_0x44435d,_0x5449b8);}function a76_0x18eb(){const _0xee4eb4=['apply','error','toString','initJobState','@flosum/utils','Logger\x20Job\x20State\x20wasn\x27t\x20init','map','../../job-detail','getObjectState','readFile','2167890FynzHc','processed','fs/promises','setObjectStatus','Cannot\x20find\x20object\x20\x27','find','getJobState','failed','isLoggerInit','_jobPath','join','filePath','name','260006VRBGdE','updateLoggerState','getTime','constructor','16869060JmxLgw','_jobState','../../enums/logger.enums','QUEUED','initObjectStatistics','22edXEjm','32RdGdXC','JOB_LOG_STATE_FILENAME','includes','path','2fIHbBv','BaseLogger','1673307AizWtu','jobStorePath','stringify','jobState','init','writeFile','4PUupxh','__importDefault','start','__esModule','search','write','FAILED','COMPLETED','1143204oprmkW','JobStatus','LoggerJobState','successful','6myKXcM','isExistsPath','710890ZTQnEL','status','2056523znqevo','utf-8','default','ObjectStatus','_isLoggerInit','parse','completedDate','../../../../../constants/job','(((.+)+)+)+$'];a76_0x18eb=function(){return _0xee4eb4;};return a76_0x18eb();}var __importDefault=this&&this[a76_0x41de92(0x1ee)]||function(_0x556376){return _0x556376&&_0x556376['__esModule']?_0x556376:{'default':_0x556376};};Object['defineProperty'](exports,a76_0x41de92(0x1f0),{'value':!![]}),exports['LoggerJobState']=void 0x0;const path_1=__importDefault(require(a76_0x41de92(0x1e4))),logger_enums_1=require(a76_0x41de92(0x1dd)),base_logger_1=require('./base-logger'),promises_1=require(a76_0x41de92(0x212)),job_detail_1=require(a76_0x41de92(0x20d)),utils_1=require(a76_0x41de92(0x20a)),job_1=require(a76_0x41de92(0x204));class LoggerJobState extends base_logger_1[a76_0x41de92(0x1e6)]{constructor(){const _0x585cd3=a76_0x41de92;super(...arguments),this[_0x585cd3(0x201)]=![];}get[a76_0x41de92(0x218)](){const _0x4f6670=a76_0x41de92;return this[_0x4f6670(0x201)];}set[a76_0x41de92(0x218)](_0x3feb90){this['_isLoggerInit']=_0x3feb90;}get[a76_0x41de92(0x1ea)](){const _0x2c5f9b=a76_0x41de92;if(!this[_0x2c5f9b(0x218)])throw new Error(_0x2c5f9b(0x20b));return this['_jobState'];}get[a76_0x41de92(0x21b)](){const _0x55c093=a76_0x41de92;return path_1[_0x55c093(0x1ff)][_0x55c093(0x21a)](this[_0x55c093(0x219)],job_1[_0x55c093(0x1e2)]);}async[a76_0x41de92(0x1eb)](_0x85e225){const _0x4ff379=a76_0x41de92;return this[_0x4ff379(0x1dc)]=await this['getJobState'](),this[_0x4ff379(0x1dc)][_0x4ff379(0x211)]=this[_0x4ff379(0x1df)](_0x85e225),await this[_0x4ff379(0x1f2)](),await this[_0x4ff379(0x1ef)](),this['isLoggerInit']=!![],this;}[a76_0x41de92(0x213)](_0xb0c504,_0x26acf4){const _0x23e24a=a76_0x41de92;this[_0x23e24a(0x20e)](_0xb0c504)[_0x23e24a(0x1fc)]=_0x26acf4,this[_0x23e24a(0x21e)]();}['setJobStatus'](_0xc1181e){const _0x4d92ec=a76_0x41de92;this[_0x4d92ec(0x1ea)][_0x4d92ec(0x1fc)]=_0xc1181e,[logger_enums_1['JobStatus'][_0x4d92ec(0x1f3)],logger_enums_1[_0x4d92ec(0x1f6)][_0x4d92ec(0x1f4)]][_0x4d92ec(0x1e3)](_0xc1181e)&&(this[_0x4d92ec(0x1ea)][_0x4d92ec(0x203)]=new Date()[_0x4d92ec(0x21f)]()),this['updateLoggerState']();}['setJobError'](_0x59b0bf){const _0x390b27=a76_0x41de92;this[_0x390b27(0x1ea)][_0x390b27(0x207)]=_0x59b0bf,this['updateLoggerState']();}['updateObjectProcess'](_0x2fea7b,_0x2a4f8a,_0x569f5b){const _0x9b3512=a76_0x41de92,_0x43c1bd=this[_0x9b3512(0x20e)](_0x2fea7b);_0x43c1bd['successful']+=_0x2a4f8a,_0x43c1bd['failed']+=_0x569f5b,this[_0x9b3512(0x1ea)][_0x9b3512(0x1f8)]+=_0x2a4f8a,this[_0x9b3512(0x1ea)][_0x9b3512(0x217)]+=_0x569f5b,this['updateLoggerState']();}[a76_0x41de92(0x20e)](_0x1e5ea3){const _0x3285d1=a76_0x41de92;var _0x16e124;const _0x5ccbda=(_0x16e124=this[_0x3285d1(0x1ea)]['processed'])===null||_0x16e124===void 0x0?void 0x0:_0x16e124[_0x3285d1(0x215)](_0x314416=>_0x314416[_0x3285d1(0x21c)]===_0x1e5ea3);if(!_0x5ccbda)throw new Error(_0x3285d1(0x214)+_0x1e5ea3+'\x27\x20in\x20statistic');return _0x5ccbda;}async[a76_0x41de92(0x216)](){const _0x1ce756=a76_0x41de92;if(!await utils_1['FsUtils'][_0x1ce756(0x1fa)](this[_0x1ce756(0x21b)]))return this[_0x1ce756(0x209)]();const _0x2655fd=await(0x0,promises_1[_0x1ce756(0x20f)])(job_detail_1[_0x1ce756(0x1e8)]+'/'+job_1[_0x1ce756(0x1e2)],{'encoding':_0x1ce756(0x1fe)});return JSON[_0x1ce756(0x202)](_0x2655fd);}[a76_0x41de92(0x209)](){const _0x2c5cd6=a76_0x41de92;return{'id':this['_jobId'],'status':logger_enums_1['JobStatus'][_0x2c5cd6(0x1de)],'processed':[],'createdDate':new Date()[_0x2c5cd6(0x21f)](),'successful':0x0,'failed':0x0};}[a76_0x41de92(0x1df)](_0x2e4e44){const _0x11782f=a76_0x41de92;return _0x2e4e44[_0x11782f(0x20c)](_0x4330a2=>({'name':_0x4330a2,'status':logger_enums_1[_0x11782f(0x200)][_0x11782f(0x1de)],'failed':0x0,'successful':0x0}));}['write'](){const _0x3f4af1=a76_0x41de92;return(0x0,promises_1[_0x3f4af1(0x1ec)])(this[_0x3f4af1(0x21b)],JSON[_0x3f4af1(0x1e9)](this['_jobState']));}}exports[a76_0x41de92(0x1f7)]=LoggerJobState;