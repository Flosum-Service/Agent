const a58_0x17e7d6=a58_0x6ba8;(function(_0x2019d4,_0x17f7d4){const _0x5bd647=a58_0x6ba8,_0x189b5a=_0x2019d4();while(!![]){try{const _0x244a8b=parseInt(_0x5bd647(0x1c3))/0x1*(-parseInt(_0x5bd647(0x195))/0x2)+parseInt(_0x5bd647(0x1b4))/0x3+-parseInt(_0x5bd647(0x18a))/0x4+parseInt(_0x5bd647(0x1bc))/0x5*(-parseInt(_0x5bd647(0x190))/0x6)+-parseInt(_0x5bd647(0x18c))/0x7+-parseInt(_0x5bd647(0x1b2))/0x8+parseInt(_0x5bd647(0x1bb))/0x9;if(_0x244a8b===_0x17f7d4)break;else _0x189b5a['push'](_0x189b5a['shift']());}catch(_0x5afa2e){_0x189b5a['push'](_0x189b5a['shift']());}}}(a58_0x4a7a,0x7712d));const a58_0x6ddea1=(function(){let _0x38ac39=!![];return function(_0x445e63,_0x1506fe){const _0x13e30d=_0x38ac39?function(){const _0x336de5=a58_0x6ba8;if(_0x1506fe){const _0x46df72=_0x1506fe[_0x336de5(0x1c6)](_0x445e63,arguments);return _0x1506fe=null,_0x46df72;}}:function(){};return _0x38ac39=![],_0x13e30d;};}()),a58_0x15603d=a58_0x6ddea1(this,function(){const _0x5989d4=a58_0x6ba8;return a58_0x15603d[_0x5989d4(0x1a2)]()[_0x5989d4(0x193)](_0x5989d4(0x1a3))['toString']()[_0x5989d4(0x1aa)](a58_0x15603d)[_0x5989d4(0x193)]('(((.+)+)+)+$');});function a58_0x4a7a(){const _0x247f74=['__esModule','Logger\x20Job\x20State\x20wasn\x27t\x20init','init','status','toString','(((.+)+)+)+$','updateObjectProcess','join','_isLoggerInit','QUEUED','isLoggerInit','writeFile','constructor','path','FsUtils','FAILED','error','utf-8','BaseLogger','initObjectStatistics','4028744FRKqPe','JobStatus','2360451VGBonh','default','@flosum/utils','updateLoggerState','failed','defineProperty','initJobState','14233023LEaJMT','7565WFcsEq','jobStorePath','setJobStatus','setObjectStatus','processed','Cannot\x20find\x20object\x20\x27','getTime','30305wErXVo','write','find','apply','../../../../../constants/job','setJobError','includes','_jobPath','1789792rqLtQu','JOB_LOG_STATE_FILENAME','922194DxvJmt','\x27\x20in\x20statistic','readFile','LoggerJobState','2082AudtpR','COMPLETED','completedDate','search','jobState','18TyaLqM','getObjectState','isExistsPath','start','successful','name','_jobState','filePath','./base-logger'];a58_0x4a7a=function(){return _0x247f74;};return a58_0x4a7a();}a58_0x15603d();'use strict';function a58_0x6ba8(_0xb45e60,_0x54847e){const _0x113c8b=a58_0x4a7a();return a58_0x6ba8=function(_0x15603d,_0x6ddea1){_0x15603d=_0x15603d-0x186;let _0x4a7aba=_0x113c8b[_0x15603d];return _0x4a7aba;},a58_0x6ba8(_0xb45e60,_0x54847e);}var __importDefault=this&&this['__importDefault']||function(_0x4e7e0d){const _0xd29b50=a58_0x6ba8;return _0x4e7e0d&&_0x4e7e0d[_0xd29b50(0x19e)]?_0x4e7e0d:{'default':_0x4e7e0d};};Object[a58_0x17e7d6(0x1b9)](exports,'__esModule',{'value':!![]}),exports[a58_0x17e7d6(0x18f)]=void 0x0;const path_1=__importDefault(require(a58_0x17e7d6(0x1ab))),logger_enums_1=require('../../enums/logger.enums'),base_logger_1=require(a58_0x17e7d6(0x19d)),promises_1=require('fs/promises'),job_detail_1=require('../../job-detail'),utils_1=require(a58_0x17e7d6(0x1b6)),job_1=require(a58_0x17e7d6(0x186));class LoggerJobState extends base_logger_1[a58_0x17e7d6(0x1b0)]{constructor(){const _0x43571c=a58_0x17e7d6;super(...arguments),this[_0x43571c(0x1a6)]=![];}get[a58_0x17e7d6(0x1a8)](){const _0x4d6a6a=a58_0x17e7d6;return this[_0x4d6a6a(0x1a6)];}set[a58_0x17e7d6(0x1a8)](_0x514e51){const _0x73fa69=a58_0x17e7d6;this[_0x73fa69(0x1a6)]=_0x514e51;}get[a58_0x17e7d6(0x194)](){const _0x537774=a58_0x17e7d6;if(!this[_0x537774(0x1a8)])throw new Error(_0x537774(0x19f));return this[_0x537774(0x19b)];}get[a58_0x17e7d6(0x19c)](){const _0x18f2f3=a58_0x17e7d6;return path_1[_0x18f2f3(0x1b5)][_0x18f2f3(0x1a5)](this[_0x18f2f3(0x189)],job_1['JOB_LOG_STATE_FILENAME']);}async[a58_0x17e7d6(0x1a0)](_0xb52b16){const _0x4e11c9=a58_0x17e7d6;return this['_jobState']=await this['getJobState'](),this[_0x4e11c9(0x19b)]['processed']=this[_0x4e11c9(0x1b1)](_0xb52b16),await this[_0x4e11c9(0x1c4)](),await this[_0x4e11c9(0x198)](),this[_0x4e11c9(0x1a8)]=!![],this;}[a58_0x17e7d6(0x1bf)](_0x3e5d9c,_0x20c450){const _0x5cd83a=a58_0x17e7d6;this[_0x5cd83a(0x196)](_0x3e5d9c)[_0x5cd83a(0x1a1)]=_0x20c450,this[_0x5cd83a(0x1b7)]();}[a58_0x17e7d6(0x1be)](_0x12c403){const _0x1af3d4=a58_0x17e7d6;this[_0x1af3d4(0x194)][_0x1af3d4(0x1a1)]=_0x12c403,[logger_enums_1[_0x1af3d4(0x1b3)][_0x1af3d4(0x1ad)],logger_enums_1[_0x1af3d4(0x1b3)][_0x1af3d4(0x191)]][_0x1af3d4(0x188)](_0x12c403)&&(this['jobState'][_0x1af3d4(0x192)]=new Date()[_0x1af3d4(0x1c2)]()),this['updateLoggerState']();}[a58_0x17e7d6(0x187)](_0x47b61b){const _0x2180d6=a58_0x17e7d6;this['jobState'][_0x2180d6(0x1ae)]=_0x47b61b,this['updateLoggerState']();}[a58_0x17e7d6(0x1a4)](_0x4a1d97,_0x2b8378,_0x302af0){const _0x440b94=a58_0x17e7d6,_0x48089c=this[_0x440b94(0x196)](_0x4a1d97);_0x48089c[_0x440b94(0x199)]+=_0x2b8378,_0x48089c[_0x440b94(0x1b8)]+=_0x302af0,this[_0x440b94(0x194)][_0x440b94(0x199)]+=_0x2b8378,this['jobState'][_0x440b94(0x1b8)]+=_0x302af0,this[_0x440b94(0x1b7)]();}['getObjectState'](_0x258e47){const _0x439583=a58_0x17e7d6;var _0x1cfbfb;const _0x2c960b=(_0x1cfbfb=this['jobState'][_0x439583(0x1c0)])===null||_0x1cfbfb===void 0x0?void 0x0:_0x1cfbfb[_0x439583(0x1c5)](_0x2e4a8c=>_0x2e4a8c[_0x439583(0x19a)]===_0x258e47);if(!_0x2c960b)throw new Error(_0x439583(0x1c1)+_0x258e47+_0x439583(0x18d));return _0x2c960b;}async['getJobState'](){const _0x3c55c3=a58_0x17e7d6;if(!await utils_1[_0x3c55c3(0x1ac)][_0x3c55c3(0x197)](this[_0x3c55c3(0x19c)]))return this[_0x3c55c3(0x1ba)]();const _0x5e3bab=await(0x0,promises_1[_0x3c55c3(0x18e)])(job_detail_1[_0x3c55c3(0x1bd)]+'/'+job_1[_0x3c55c3(0x18b)],{'encoding':_0x3c55c3(0x1af)});return JSON['parse'](_0x5e3bab);}[a58_0x17e7d6(0x1ba)](){const _0x6191c=a58_0x17e7d6;return{'id':this['_jobId'],'status':logger_enums_1['JobStatus'][_0x6191c(0x1a7)],'processed':[],'createdDate':new Date()[_0x6191c(0x1c2)](),'successful':0x0,'failed':0x0};}['initObjectStatistics'](_0x593911){const _0xa9a505=a58_0x17e7d6;return _0x593911['map'](_0x2b803d=>({'name':_0x2b803d,'status':logger_enums_1['ObjectStatus'][_0xa9a505(0x1a7)],'failed':0x0,'successful':0x0}));}[a58_0x17e7d6(0x1c4)](){const _0x2f626b=a58_0x17e7d6;return(0x0,promises_1[_0x2f626b(0x1a9)])(this['filePath'],JSON['stringify'](this['_jobState']));}}exports['LoggerJobState']=LoggerJobState;