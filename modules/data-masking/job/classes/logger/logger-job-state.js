const a58_0x5171b8=a58_0x3f35;(function(_0x5444ae,_0x2873ee){const _0x52b031=a58_0x3f35,_0x15e7b7=_0x5444ae();while(!![]){try{const _0x260707=parseInt(_0x52b031(0xac))/0x1*(parseInt(_0x52b031(0x79))/0x2)+-parseInt(_0x52b031(0x9d))/0x3*(-parseInt(_0x52b031(0xa2))/0x4)+-parseInt(_0x52b031(0x95))/0x5*(-parseInt(_0x52b031(0x8d))/0x6)+-parseInt(_0x52b031(0xa4))/0x7*(parseInt(_0x52b031(0xa1))/0x8)+-parseInt(_0x52b031(0xa0))/0x9*(parseInt(_0x52b031(0xb0))/0xa)+parseInt(_0x52b031(0x9a))/0xb+-parseInt(_0x52b031(0xb4))/0xc;if(_0x260707===_0x2873ee)break;else _0x15e7b7['push'](_0x15e7b7['shift']());}catch(_0xa0e1de){_0x15e7b7['push'](_0x15e7b7['shift']());}}}(a58_0x395c,0x41973));const a58_0x483dcd=(function(){let _0x1fcf8c=!![];return function(_0x3c406e,_0x193ef5){const _0x3790cf=_0x1fcf8c?function(){const _0x1cd25b=a58_0x3f35;if(_0x193ef5){const _0x21197d=_0x193ef5[_0x1cd25b(0x99)](_0x3c406e,arguments);return _0x193ef5=null,_0x21197d;}}:function(){};return _0x1fcf8c=![],_0x3790cf;};}()),a58_0x1c480f=a58_0x483dcd(this,function(){const _0x2a2f69=a58_0x3f35;return a58_0x1c480f[_0x2a2f69(0x77)]()[_0x2a2f69(0x98)]('(((.+)+)+)+$')[_0x2a2f69(0x77)]()[_0x2a2f69(0x8c)](a58_0x1c480f)['search'](_0x2a2f69(0x74));});a58_0x1c480f();'use strict';function a58_0x3f35(_0x1a4666,_0x55cb29){const _0x2fde5b=a58_0x395c();return a58_0x3f35=function(_0x1c480f,_0x483dcd){_0x1c480f=_0x1c480f-0x71;let _0x395ce0=_0x2fde5b[_0x1c480f];return _0x395ce0;},a58_0x3f35(_0x1a4666,_0x55cb29);}var __importDefault=this&&this['__importDefault']||function(_0x11dfe6){return _0x11dfe6&&_0x11dfe6['__esModule']?_0x11dfe6:{'default':_0x11dfe6};};Object[a58_0x5171b8(0xa3)](exports,'__esModule',{'value':!![]}),exports[a58_0x5171b8(0x8e)]=void 0x0;function a58_0x395c(){const _0x2dd21e=['toString','updateLoggerState','17742gPNsbd','../../enums/logger.enums','write','./base-logger','path','getObjectState','readFile','initJobState','isExistsPath','_isLoggerInit','BaseLogger','init','@flosum/utils','default','jobState','FAILED','filePath','FsUtils','successful','constructor','12IyQvdp','LoggerJobState','error','QUEUED','getTime','join','setJobStatus','JobStatus','1002790WDdrSG','writeFile','_jobId','search','apply','4376196uzhOQm','\x27\x20in\x20statistic','processed','8133qIRoDd','getJobState','map','9eZbiSt','4191848eoYgAu','292vgaFOM','defineProperty','7TnDmiH','setObjectStatus','JOB_LOG_STATE_FILENAME','jobStorePath','Logger\x20Job\x20State\x20wasn\x27t\x20init','start','isLoggerInit','status','23lmvXOs','initObjectStatistics','_jobPath','parse','1932650VUxqHg','ObjectStatus','stringify','_jobState','2579796LcEWGG','fs/promises','Cannot\x20find\x20object\x20\x27','find','(((.+)+)+)+$','../../job-detail','updateObjectProcess'];a58_0x395c=function(){return _0x2dd21e;};return a58_0x395c();}const path_1=__importDefault(require(a58_0x5171b8(0x7d))),logger_enums_1=require(a58_0x5171b8(0x7a)),base_logger_1=require(a58_0x5171b8(0x7c)),promises_1=require(a58_0x5171b8(0x71)),job_detail_1=require(a58_0x5171b8(0x75)),utils_1=require(a58_0x5171b8(0x85)),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1[a58_0x5171b8(0x83)]{constructor(){super(...arguments),this['_isLoggerInit']=![];}get[a58_0x5171b8(0xaa)](){return this['_isLoggerInit'];}set[a58_0x5171b8(0xaa)](_0x25ed2a){const _0x444c5d=a58_0x5171b8;this[_0x444c5d(0x82)]=_0x25ed2a;}get[a58_0x5171b8(0x87)](){const _0x14289b=a58_0x5171b8;if(!this[_0x14289b(0xaa)])throw new Error(_0x14289b(0xa8));return this['_jobState'];}get[a58_0x5171b8(0x89)](){const _0x319b30=a58_0x5171b8;return path_1[_0x319b30(0x86)][_0x319b30(0x92)](this[_0x319b30(0xae)],job_1[_0x319b30(0xa6)]);}async[a58_0x5171b8(0x84)](_0x422faf){const _0x27b188=a58_0x5171b8;return this[_0x27b188(0xb3)]=await this[_0x27b188(0x9e)](),this[_0x27b188(0xb3)][_0x27b188(0x9c)]=this[_0x27b188(0xad)](_0x422faf),await this[_0x27b188(0x7b)](),await this[_0x27b188(0xa9)](),this[_0x27b188(0xaa)]=!![],this;}[a58_0x5171b8(0xa5)](_0x5437c5,_0x1afb6f){const _0x3a4aad=a58_0x5171b8;this['getObjectState'](_0x5437c5)[_0x3a4aad(0xab)]=_0x1afb6f,this[_0x3a4aad(0x78)]();}[a58_0x5171b8(0x93)](_0x33abaf){const _0x4b7a88=a58_0x5171b8;this['jobState'][_0x4b7a88(0xab)]=_0x33abaf,[logger_enums_1['JobStatus'][_0x4b7a88(0x88)],logger_enums_1['JobStatus']['COMPLETED']]['includes'](_0x33abaf)&&(this['jobState']['completedDate']=new Date()[_0x4b7a88(0x91)]()),this[_0x4b7a88(0x78)]();}['setJobError'](_0x46606d){const _0x3c58f2=a58_0x5171b8;this[_0x3c58f2(0x87)][_0x3c58f2(0x8f)]=_0x46606d,this[_0x3c58f2(0x78)]();}[a58_0x5171b8(0x76)](_0x5b6f73,_0x1085db,_0x7097e){const _0x2419d2=a58_0x5171b8,_0x4cf6d3=this[_0x2419d2(0x7e)](_0x5b6f73);_0x4cf6d3['successful']+=_0x1085db,_0x4cf6d3['failed']+=_0x7097e,this[_0x2419d2(0x87)][_0x2419d2(0x8b)]+=_0x1085db,this[_0x2419d2(0x87)]['failed']+=_0x7097e,this[_0x2419d2(0x78)]();}[a58_0x5171b8(0x7e)](_0x58a335){const _0x39b08e=a58_0x5171b8;var _0x60f3c6;const _0x107bb9=(_0x60f3c6=this[_0x39b08e(0x87)][_0x39b08e(0x9c)])===null||_0x60f3c6===void 0x0?void 0x0:_0x60f3c6[_0x39b08e(0x73)](_0x3cabcd=>_0x3cabcd['name']===_0x58a335);if(!_0x107bb9)throw new Error(_0x39b08e(0x72)+_0x58a335+_0x39b08e(0x9b));return _0x107bb9;}async[a58_0x5171b8(0x9e)](){const _0x42e74b=a58_0x5171b8;if(!await utils_1[_0x42e74b(0x8a)][_0x42e74b(0x81)](this[_0x42e74b(0x89)]))return this[_0x42e74b(0x80)]();const _0x1c4d4f=await(0x0,promises_1[_0x42e74b(0x7f)])(job_detail_1[_0x42e74b(0xa7)]+'/'+job_1[_0x42e74b(0xa6)],{'encoding':'utf-8'});return JSON[_0x42e74b(0xaf)](_0x1c4d4f);}[a58_0x5171b8(0x80)](){const _0x22176d=a58_0x5171b8;return{'id':this[_0x22176d(0x97)],'status':logger_enums_1[_0x22176d(0x94)][_0x22176d(0x90)],'processed':[],'createdDate':new Date()[_0x22176d(0x91)](),'successful':0x0,'failed':0x0};}[a58_0x5171b8(0xad)](_0x345dbf){const _0x583e41=a58_0x5171b8;return _0x345dbf[_0x583e41(0x9f)](_0x32ba55=>({'name':_0x32ba55,'status':logger_enums_1[_0x583e41(0xb1)][_0x583e41(0x90)],'failed':0x0,'successful':0x0}));}['write'](){const _0xa624f=a58_0x5171b8;return(0x0,promises_1[_0xa624f(0x96)])(this[_0xa624f(0x89)],JSON[_0xa624f(0xb2)](this[_0xa624f(0xb3)]));}}exports['LoggerJobState']=LoggerJobState;