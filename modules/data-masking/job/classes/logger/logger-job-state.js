const a58_0x373158=a58_0x208d;function a58_0x3c1a(){const _0x2e0f3a=['getJobState','initObjectStatistics','170LUnTdm','244915XIfWwO','_jobState','updateObjectProcess','filePath','setJobStatus','__esModule','write','FAILED','parse','processed','@flosum/utils','../../enums/logger.enums','jobState','Logger\x20Job\x20State\x20wasn\x27t\x20init','_jobId','name','679956Zxdrob','apply','error','completedDate','BaseLogger','toString','updateLoggerState','map','successful','_isLoggerInit','constructor','124492eKBaHn','isLoggerInit','getTime','LoggerJobState','search','184jVvRgN','status','getObjectState','readFile','130401wCVynu','setJobError','12JVxkrz','writeFile','\x27\x20in\x20statistic','JOB_LOG_STATE_FILENAME','205wglVuY','2493000xBWUkE','start','initJobState','COMPLETED','join','isExistsPath','1198eXlfxo','(((.+)+)+)+$','1275722YOoMeW','JobStatus','jobStorePath','39MeVDdG','QUEUED','__importDefault','failed','path','setObjectStatus','find'];a58_0x3c1a=function(){return _0x2e0f3a;};return a58_0x3c1a();}(function(_0x50d479,_0x284ed5){const _0x3fc010=a58_0x208d,_0x3c0ee2=_0x50d479();while(!![]){try{const _0x564b40=-parseInt(_0x3fc010(0x1bd))/0x1*(-parseInt(_0x3fc010(0x1c4))/0x2)+parseInt(_0x3fc010(0x1c9))/0x3*(parseInt(_0x3fc010(0x1ae))/0x4)+-parseInt(_0x3fc010(0x1be))/0x5+parseInt(_0x3fc010(0x1b9))/0x6*(parseInt(_0x3fc010(0x1c6))/0x7)+-parseInt(_0x3fc010(0x1b3))/0x8*(-parseInt(_0x3fc010(0x1b7))/0x9)+-parseInt(_0x3fc010(0x1d2))/0xa*(parseInt(_0x3fc010(0x1d3))/0xb)+parseInt(_0x3fc010(0x1e3))/0xc;if(_0x564b40===_0x284ed5)break;else _0x3c0ee2['push'](_0x3c0ee2['shift']());}catch(_0xa5db10){_0x3c0ee2['push'](_0x3c0ee2['shift']());}}}(a58_0x3c1a,0x62cd3));const a58_0x4742ff=(function(){let _0x38cca6=!![];return function(_0x4297c8,_0x5676dd){const _0x888b8=_0x38cca6?function(){const _0x3a64c3=a58_0x208d;if(_0x5676dd){const _0x3d8e6b=_0x5676dd[_0x3a64c3(0x1e4)](_0x4297c8,arguments);return _0x5676dd=null,_0x3d8e6b;}}:function(){};return _0x38cca6=![],_0x888b8;};}()),a58_0x2839b6=a58_0x4742ff(this,function(){const _0x4b835a=a58_0x208d;return a58_0x2839b6['toString']()[_0x4b835a(0x1b2)](_0x4b835a(0x1c5))[_0x4b835a(0x1e8)]()[_0x4b835a(0x1ad)](a58_0x2839b6)[_0x4b835a(0x1b2)]('(((.+)+)+)+$');});a58_0x2839b6();'use strict';var __importDefault=this&&this[a58_0x373158(0x1cb)]||function(_0x3a1f53){const _0x560bd2=a58_0x373158;return _0x3a1f53&&_0x3a1f53[_0x560bd2(0x1d8)]?_0x3a1f53:{'default':_0x3a1f53};};Object['defineProperty'](exports,a58_0x373158(0x1d8),{'value':!![]}),exports[a58_0x373158(0x1b1)]=void 0x0;const path_1=__importDefault(require(a58_0x373158(0x1cd))),logger_enums_1=require(a58_0x373158(0x1de)),base_logger_1=require('./base-logger'),promises_1=require('fs/promises'),job_detail_1=require('../../job-detail'),utils_1=require(a58_0x373158(0x1dd)),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1[a58_0x373158(0x1e7)]{constructor(){const _0x57b809=a58_0x373158;super(...arguments),this[_0x57b809(0x1ac)]=![];}get[a58_0x373158(0x1af)](){const _0x7d4999=a58_0x373158;return this[_0x7d4999(0x1ac)];}set['isLoggerInit'](_0x2a57b5){const _0x3673ac=a58_0x373158;this[_0x3673ac(0x1ac)]=_0x2a57b5;}get[a58_0x373158(0x1df)](){const _0x22f7c4=a58_0x373158;if(!this['isLoggerInit'])throw new Error(_0x22f7c4(0x1e0));return this['_jobState'];}get[a58_0x373158(0x1d6)](){const _0x271b57=a58_0x373158;return path_1['default'][_0x271b57(0x1c2)](this['_jobPath'],job_1['JOB_LOG_STATE_FILENAME']);}async['init'](_0x48953a){const _0x58746e=a58_0x373158;return this[_0x58746e(0x1d4)]=await this[_0x58746e(0x1d0)](),this['_jobState'][_0x58746e(0x1dc)]=this[_0x58746e(0x1d1)](_0x48953a),await this[_0x58746e(0x1d9)](),await this[_0x58746e(0x1bf)](),this['isLoggerInit']=!![],this;}[a58_0x373158(0x1ce)](_0x94b04b,_0xc225bf){const _0x33d9ba=a58_0x373158;this[_0x33d9ba(0x1b5)](_0x94b04b)['status']=_0xc225bf,this['updateLoggerState']();}[a58_0x373158(0x1d7)](_0x436668){const _0x2435ed=a58_0x373158;this[_0x2435ed(0x1df)][_0x2435ed(0x1b4)]=_0x436668,[logger_enums_1[_0x2435ed(0x1c7)][_0x2435ed(0x1da)],logger_enums_1['JobStatus'][_0x2435ed(0x1c1)]]['includes'](_0x436668)&&(this[_0x2435ed(0x1df)][_0x2435ed(0x1e6)]=new Date()[_0x2435ed(0x1b0)]()),this[_0x2435ed(0x1e9)]();}[a58_0x373158(0x1b8)](_0x325b67){const _0x316530=a58_0x373158;this['jobState'][_0x316530(0x1e5)]=_0x325b67,this[_0x316530(0x1e9)]();}[a58_0x373158(0x1d5)](_0x14fa85,_0x18e6c0,_0x57789d){const _0x18a529=a58_0x373158,_0x5e2c08=this[_0x18a529(0x1b5)](_0x14fa85);_0x5e2c08[_0x18a529(0x1ab)]+=_0x18e6c0,_0x5e2c08[_0x18a529(0x1cc)]+=_0x57789d,this['jobState'][_0x18a529(0x1ab)]+=_0x18e6c0,this[_0x18a529(0x1df)]['failed']+=_0x57789d,this[_0x18a529(0x1e9)]();}[a58_0x373158(0x1b5)](_0x5db716){const _0xb8b75d=a58_0x373158;var _0x39c5db;const _0x215fa4=(_0x39c5db=this[_0xb8b75d(0x1df)][_0xb8b75d(0x1dc)])===null||_0x39c5db===void 0x0?void 0x0:_0x39c5db[_0xb8b75d(0x1cf)](_0x597777=>_0x597777[_0xb8b75d(0x1e2)]===_0x5db716);if(!_0x215fa4)throw new Error('Cannot\x20find\x20object\x20\x27'+_0x5db716+_0xb8b75d(0x1bb));return _0x215fa4;}async[a58_0x373158(0x1d0)](){const _0x170365=a58_0x373158;if(!await utils_1['FsUtils'][_0x170365(0x1c3)](this[_0x170365(0x1d6)]))return this[_0x170365(0x1c0)]();const _0x342438=await(0x0,promises_1[_0x170365(0x1b6)])(job_detail_1[_0x170365(0x1c8)]+'/'+job_1[_0x170365(0x1bc)],{'encoding':'utf-8'});return JSON[_0x170365(0x1db)](_0x342438);}[a58_0x373158(0x1c0)](){const _0x38afcb=a58_0x373158;return{'id':this[_0x38afcb(0x1e1)],'status':logger_enums_1[_0x38afcb(0x1c7)][_0x38afcb(0x1ca)],'processed':[],'createdDate':new Date()[_0x38afcb(0x1b0)](),'successful':0x0,'failed':0x0};}[a58_0x373158(0x1d1)](_0xa9fbf7){const _0x4f0e41=a58_0x373158;return _0xa9fbf7[_0x4f0e41(0x1aa)](_0x431242=>({'name':_0x431242,'status':logger_enums_1['ObjectStatus'][_0x4f0e41(0x1ca)],'failed':0x0,'successful':0x0}));}['write'](){const _0x3dac8e=a58_0x373158;return(0x0,promises_1[_0x3dac8e(0x1ba)])(this['filePath'],JSON['stringify'](this['_jobState']));}}function a58_0x208d(_0x1a0029,_0x6871d){const _0x2b90a5=a58_0x3c1a();return a58_0x208d=function(_0x2839b6,_0x4742ff){_0x2839b6=_0x2839b6-0x1aa;let _0x3c1af6=_0x2b90a5[_0x2839b6];return _0x3c1af6;},a58_0x208d(_0x1a0029,_0x6871d);}exports[a58_0x373158(0x1b1)]=LoggerJobState;