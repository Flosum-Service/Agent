const a58_0x15ec9b=a58_0x3e5f;function a58_0x8598(){const _0x2e3f33=['@flosum/utils','status','search','getObjectState','updateLoggerState','start','constructor','FsUtils','2065343VbgWvA','getTime','_jobState','519320fYaUPB','1959ZzkjmF','parse','name','completedDate','updateObjectProcess','toString','writeFile','../../enums/logger.enums','failed','setJobError','896csbqpE','path','_isLoggerInit','initJobState','JOB_LOG_STATE_FILENAME','1474AvcQbG','COMPLETED','error','initObjectStatistics','init','fs/promises','processed','(((.+)+)+)+$','18nWMSEt','includes','write','QUEUED','../../job-detail','LoggerJobState','apply','readFile','21662861yGsJWs','12GMxLle','Logger\x20Job\x20State\x20wasn\x27t\x20init','__esModule','./base-logger','JobStatus','618124WeKWln','\x27\x20in\x20statistic','jobStorePath','FAILED','join','ObjectStatus','isLoggerInit','117639byIGUe','default','successful','defineProperty','setObjectStatus','filePath','10tEWTwF','getJobState','jobState','2189660SOdqZW','stringify','find','isExistsPath'];a58_0x8598=function(){return _0x2e3f33;};return a58_0x8598();}function a58_0x3e5f(_0xf241d,_0x2c53fd){const _0x3e34f6=a58_0x8598();return a58_0x3e5f=function(_0x522651,_0x33dab9){_0x522651=_0x522651-0x1dc;let _0x8598f7=_0x3e34f6[_0x522651];return _0x8598f7;},a58_0x3e5f(_0xf241d,_0x2c53fd);}(function(_0x4a7c0d,_0x574b4c){const _0xff3f04=a58_0x3e5f,_0x191937=_0x4a7c0d();while(!![]){try{const _0x3fc844=parseInt(_0xff3f04(0x1ee))/0x1+-parseInt(_0xff3f04(0x21d))/0x2*(-parseInt(_0xff3f04(0x20e))/0x3)+parseInt(_0xff3f04(0x1fe))/0x4*(parseInt(_0xff3f04(0x1fb))/0x5)+-parseInt(_0xff3f04(0x1e0))/0x6*(parseInt(_0xff3f04(0x20a))/0x7)+parseInt(_0xff3f04(0x218))/0x8*(parseInt(_0xff3f04(0x1f5))/0x9)+-parseInt(_0xff3f04(0x20d))/0xa+-parseInt(_0xff3f04(0x1e8))/0xb*(parseInt(_0xff3f04(0x1e9))/0xc);if(_0x3fc844===_0x574b4c)break;else _0x191937['push'](_0x191937['shift']());}catch(_0x462d1b){_0x191937['push'](_0x191937['shift']());}}}(a58_0x8598,0xb7879));const a58_0x33dab9=(function(){let _0x2baeea=!![];return function(_0x24b096,_0x17f852){const _0x5cb827=_0x2baeea?function(){const _0x5a92ae=a58_0x3e5f;if(_0x17f852){const _0x575387=_0x17f852[_0x5a92ae(0x1e6)](_0x24b096,arguments);return _0x17f852=null,_0x575387;}}:function(){};return _0x2baeea=![],_0x5cb827;};}()),a58_0x522651=a58_0x33dab9(this,function(){const _0x4fba4b=a58_0x3e5f;return a58_0x522651[_0x4fba4b(0x213)]()['search'](_0x4fba4b(0x1df))[_0x4fba4b(0x213)]()[_0x4fba4b(0x208)](a58_0x522651)[_0x4fba4b(0x204)](_0x4fba4b(0x1df));});a58_0x522651();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x389a20){return _0x389a20&&_0x389a20['__esModule']?_0x389a20:{'default':_0x389a20};};Object[a58_0x15ec9b(0x1f8)](exports,a58_0x15ec9b(0x1eb),{'value':!![]}),exports[a58_0x15ec9b(0x1e5)]=void 0x0;const path_1=__importDefault(require(a58_0x15ec9b(0x219))),logger_enums_1=require(a58_0x15ec9b(0x215)),base_logger_1=require(a58_0x15ec9b(0x1ec)),promises_1=require(a58_0x15ec9b(0x1dd)),job_detail_1=require(a58_0x15ec9b(0x1e4)),utils_1=require(a58_0x15ec9b(0x202)),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1['BaseLogger']{constructor(){const _0x1b95a4=a58_0x15ec9b;super(...arguments),this[_0x1b95a4(0x21a)]=![];}get[a58_0x15ec9b(0x1f4)](){const _0x15a063=a58_0x15ec9b;return this[_0x15a063(0x21a)];}set[a58_0x15ec9b(0x1f4)](_0x3ff4fe){const _0x3a1f0b=a58_0x15ec9b;this[_0x3a1f0b(0x21a)]=_0x3ff4fe;}get[a58_0x15ec9b(0x1fd)](){const _0x510766=a58_0x15ec9b;if(!this[_0x510766(0x1f4)])throw new Error(_0x510766(0x1ea));return this[_0x510766(0x20c)];}get[a58_0x15ec9b(0x1fa)](){const _0x4a86eb=a58_0x15ec9b;return path_1[_0x4a86eb(0x1f6)][_0x4a86eb(0x1f2)](this['_jobPath'],job_1[_0x4a86eb(0x21c)]);}async[a58_0x15ec9b(0x1dc)](_0x53224e){const _0x4bb4b7=a58_0x15ec9b;return this[_0x4bb4b7(0x20c)]=await this[_0x4bb4b7(0x1fc)](),this['_jobState'][_0x4bb4b7(0x1de)]=this[_0x4bb4b7(0x220)](_0x53224e),await this[_0x4bb4b7(0x1e2)](),await this[_0x4bb4b7(0x207)](),this[_0x4bb4b7(0x1f4)]=!![],this;}[a58_0x15ec9b(0x1f9)](_0x1c67b0,_0x5d38d9){const _0x4ff6fa=a58_0x15ec9b;this['getObjectState'](_0x1c67b0)[_0x4ff6fa(0x203)]=_0x5d38d9,this[_0x4ff6fa(0x206)]();}['setJobStatus'](_0x56fb1e){const _0x2df9ae=a58_0x15ec9b;this['jobState'][_0x2df9ae(0x203)]=_0x56fb1e,[logger_enums_1[_0x2df9ae(0x1ed)][_0x2df9ae(0x1f1)],logger_enums_1[_0x2df9ae(0x1ed)][_0x2df9ae(0x21e)]][_0x2df9ae(0x1e1)](_0x56fb1e)&&(this[_0x2df9ae(0x1fd)][_0x2df9ae(0x211)]=new Date()[_0x2df9ae(0x20b)]()),this[_0x2df9ae(0x206)]();}[a58_0x15ec9b(0x217)](_0x15a330){const _0x38f184=a58_0x15ec9b;this['jobState'][_0x38f184(0x21f)]=_0x15a330,this[_0x38f184(0x206)]();}[a58_0x15ec9b(0x212)](_0x1b52f7,_0x37fafd,_0xb58d44){const _0x50c410=a58_0x15ec9b,_0x5052de=this[_0x50c410(0x205)](_0x1b52f7);_0x5052de[_0x50c410(0x1f7)]+=_0x37fafd,_0x5052de['failed']+=_0xb58d44,this[_0x50c410(0x1fd)][_0x50c410(0x1f7)]+=_0x37fafd,this['jobState'][_0x50c410(0x216)]+=_0xb58d44,this[_0x50c410(0x206)]();}[a58_0x15ec9b(0x205)](_0x1a1bdc){const _0x270ab1=a58_0x15ec9b;var _0x3e44b3;const _0x3f207a=(_0x3e44b3=this['jobState'][_0x270ab1(0x1de)])===null||_0x3e44b3===void 0x0?void 0x0:_0x3e44b3[_0x270ab1(0x200)](_0x2c2cc3=>_0x2c2cc3[_0x270ab1(0x210)]===_0x1a1bdc);if(!_0x3f207a)throw new Error('Cannot\x20find\x20object\x20\x27'+_0x1a1bdc+_0x270ab1(0x1ef));return _0x3f207a;}async[a58_0x15ec9b(0x1fc)](){const _0x102c43=a58_0x15ec9b;if(!await utils_1[_0x102c43(0x209)][_0x102c43(0x201)](this[_0x102c43(0x1fa)]))return this[_0x102c43(0x21b)]();const _0x4f38a0=await(0x0,promises_1[_0x102c43(0x1e7)])(job_detail_1[_0x102c43(0x1f0)]+'/'+job_1[_0x102c43(0x21c)],{'encoding':'utf-8'});return JSON[_0x102c43(0x20f)](_0x4f38a0);}[a58_0x15ec9b(0x21b)](){const _0x54ee23=a58_0x15ec9b;return{'id':this['_jobId'],'status':logger_enums_1[_0x54ee23(0x1ed)][_0x54ee23(0x1e3)],'processed':[],'createdDate':new Date()[_0x54ee23(0x20b)](),'successful':0x0,'failed':0x0};}['initObjectStatistics'](_0x124b34){const _0x233435=a58_0x15ec9b;return _0x124b34['map'](_0x4be964=>({'name':_0x4be964,'status':logger_enums_1[_0x233435(0x1f3)]['QUEUED'],'failed':0x0,'successful':0x0}));}['write'](){const _0x45d5cd=a58_0x15ec9b;return(0x0,promises_1[_0x45d5cd(0x214)])(this[_0x45d5cd(0x1fa)],JSON[_0x45d5cd(0x1ff)](this['_jobState']));}}exports['LoggerJobState']=LoggerJobState;