const a58_0x432ba0=a58_0x5bf4;function a58_0x46b9(){const _0x15ebaf=['filePath','writeFile','updateObjectProcess','init','parse','LoggerJobState','processed','defineProperty','../../../../../constants/job','@flosum/utils','path','906693pFfUVq','FAILED','search','updateLoggerState','fs/promises','\x27\x20in\x20statistic','Logger\x20Job\x20State\x20wasn\x27t\x20init','getObjectState','QUEUED','416492pVFIFm','__importDefault','find','failed','initObjectStatistics','includes','initJobState','error','_jobId','(((.+)+)+)+$','_jobState','../../job-detail','JobStatus','name','isLoggerInit','constructor','status','716BQkNsI','BaseLogger','utf-8','./base-logger','getTime','ObjectStatus','14951120BPjtBe','__esModule','setJobStatus','JOB_LOG_STATE_FILENAME','_isLoggerInit','getJobState','toString','successful','write','jobStorePath','map','3239922aKqKiS','1911606NHSymM','stringify','2673846TTyyDA','setObjectStatus','jobState','_jobPath','readFile','16580nwDWMp'];a58_0x46b9=function(){return _0x15ebaf;};return a58_0x46b9();}(function(_0x31bdbe,_0x1b8f7c){const _0x3f9d89=a58_0x5bf4,_0x5249df=_0x31bdbe();while(!![]){try{const _0x1cfdae=-parseInt(_0x3f9d89(0x123))/0x1+-parseInt(_0x3f9d89(0x107))/0x2+parseInt(_0x3f9d89(0x11a))/0x3+parseInt(_0x3f9d89(0x134))/0x4*(parseInt(_0x3f9d89(0x10e))/0x5)+-parseInt(_0x3f9d89(0x109))/0x6+-parseInt(_0x3f9d89(0x106))/0x7+parseInt(_0x3f9d89(0x13a))/0x8;if(_0x1cfdae===_0x1b8f7c)break;else _0x5249df['push'](_0x5249df['shift']());}catch(_0x4cd725){_0x5249df['push'](_0x5249df['shift']());}}}(a58_0x46b9,0x7623f));const a58_0x4cac9f=(function(){let _0xb3f4c9=!![];return function(_0x33fddc,_0x3af67d){const _0xb07068=_0xb3f4c9?function(){if(_0x3af67d){const _0x41da07=_0x3af67d['apply'](_0x33fddc,arguments);return _0x3af67d=null,_0x41da07;}}:function(){};return _0xb3f4c9=![],_0xb07068;};}()),a58_0x1bc819=a58_0x4cac9f(this,function(){const _0x348c16=a58_0x5bf4;return a58_0x1bc819['toString']()[_0x348c16(0x11c)](_0x348c16(0x12c))[_0x348c16(0x140)]()[_0x348c16(0x132)](a58_0x1bc819)['search']('(((.+)+)+)+$');});a58_0x1bc819();'use strict';var __importDefault=this&&this[a58_0x432ba0(0x124)]||function(_0x36edbf){const _0x1e1deb=a58_0x432ba0;return _0x36edbf&&_0x36edbf[_0x1e1deb(0x13b)]?_0x36edbf:{'default':_0x36edbf};};Object[a58_0x432ba0(0x116)](exports,'__esModule',{'value':!![]}),exports[a58_0x432ba0(0x114)]=void 0x0;const path_1=__importDefault(require(a58_0x432ba0(0x119))),logger_enums_1=require('../../enums/logger.enums'),base_logger_1=require(a58_0x432ba0(0x137)),promises_1=require(a58_0x432ba0(0x11e)),job_detail_1=require(a58_0x432ba0(0x12e)),utils_1=require(a58_0x432ba0(0x118)),job_1=require(a58_0x432ba0(0x117));function a58_0x5bf4(_0x109266,_0x2001e9){const _0x423fdf=a58_0x46b9();return a58_0x5bf4=function(_0x1bc819,_0x4cac9f){_0x1bc819=_0x1bc819-0x102;let _0x46b975=_0x423fdf[_0x1bc819];return _0x46b975;},a58_0x5bf4(_0x109266,_0x2001e9);}class LoggerJobState extends base_logger_1[a58_0x432ba0(0x135)]{constructor(){const _0x47a650=a58_0x432ba0;super(...arguments),this[_0x47a650(0x13e)]=![];}get[a58_0x432ba0(0x131)](){const _0x32afda=a58_0x432ba0;return this[_0x32afda(0x13e)];}set[a58_0x432ba0(0x131)](_0x14564c){this['_isLoggerInit']=_0x14564c;}get[a58_0x432ba0(0x10b)](){const _0x2b1de2=a58_0x432ba0;if(!this[_0x2b1de2(0x131)])throw new Error(_0x2b1de2(0x120));return this['_jobState'];}get['filePath'](){const _0x1317db=a58_0x432ba0;return path_1['default']['join'](this[_0x1317db(0x10c)],job_1[_0x1317db(0x13d)]);}async[a58_0x432ba0(0x112)](_0x15c0d){const _0x2f4b00=a58_0x432ba0;return this[_0x2f4b00(0x12d)]=await this['getJobState'](),this[_0x2f4b00(0x12d)][_0x2f4b00(0x115)]=this[_0x2f4b00(0x127)](_0x15c0d),await this['write'](),await this['start'](),this[_0x2f4b00(0x131)]=!![],this;}[a58_0x432ba0(0x10a)](_0x56cc9e,_0x57260e){const _0xec2a01=a58_0x432ba0;this[_0xec2a01(0x121)](_0x56cc9e)[_0xec2a01(0x133)]=_0x57260e,this['updateLoggerState']();}[a58_0x432ba0(0x13c)](_0x384cf1){const _0x31e69a=a58_0x432ba0;this[_0x31e69a(0x10b)]['status']=_0x384cf1,[logger_enums_1['JobStatus'][_0x31e69a(0x11b)],logger_enums_1[_0x31e69a(0x12f)]['COMPLETED']][_0x31e69a(0x128)](_0x384cf1)&&(this[_0x31e69a(0x10b)]['completedDate']=new Date()[_0x31e69a(0x138)]()),this['updateLoggerState']();}['setJobError'](_0x54f256){const _0x1600de=a58_0x432ba0;this[_0x1600de(0x10b)][_0x1600de(0x12a)]=_0x54f256,this[_0x1600de(0x11d)]();}[a58_0x432ba0(0x111)](_0x4b5e89,_0x23ba2d,_0x2e281b){const _0x24ef85=a58_0x432ba0,_0x40f8c5=this[_0x24ef85(0x121)](_0x4b5e89);_0x40f8c5[_0x24ef85(0x102)]+=_0x23ba2d,_0x40f8c5[_0x24ef85(0x126)]+=_0x2e281b,this[_0x24ef85(0x10b)][_0x24ef85(0x102)]+=_0x23ba2d,this[_0x24ef85(0x10b)]['failed']+=_0x2e281b,this[_0x24ef85(0x11d)]();}['getObjectState'](_0x9ec03e){const _0xcab7ac=a58_0x432ba0;var _0x1241db;const _0x2be744=(_0x1241db=this[_0xcab7ac(0x10b)]['processed'])===null||_0x1241db===void 0x0?void 0x0:_0x1241db[_0xcab7ac(0x125)](_0x3d3f3a=>_0x3d3f3a[_0xcab7ac(0x130)]===_0x9ec03e);if(!_0x2be744)throw new Error('Cannot\x20find\x20object\x20\x27'+_0x9ec03e+_0xcab7ac(0x11f));return _0x2be744;}async[a58_0x432ba0(0x13f)](){const _0x16d31a=a58_0x432ba0;if(!await utils_1['FsUtils']['isExistsPath'](this[_0x16d31a(0x10f)]))return this[_0x16d31a(0x129)]();const _0x17638a=await(0x0,promises_1[_0x16d31a(0x10d)])(job_detail_1[_0x16d31a(0x104)]+'/'+job_1[_0x16d31a(0x13d)],{'encoding':_0x16d31a(0x136)});return JSON[_0x16d31a(0x113)](_0x17638a);}['initJobState'](){const _0x44fc98=a58_0x432ba0;return{'id':this[_0x44fc98(0x12b)],'status':logger_enums_1[_0x44fc98(0x12f)][_0x44fc98(0x122)],'processed':[],'createdDate':new Date()['getTime'](),'successful':0x0,'failed':0x0};}['initObjectStatistics'](_0x3359cc){const _0x2e4091=a58_0x432ba0;return _0x3359cc[_0x2e4091(0x105)](_0x177bd5=>({'name':_0x177bd5,'status':logger_enums_1[_0x2e4091(0x139)][_0x2e4091(0x122)],'failed':0x0,'successful':0x0}));}[a58_0x432ba0(0x103)](){const _0x2d613b=a58_0x432ba0;return(0x0,promises_1[_0x2d613b(0x110)])(this[_0x2d613b(0x10f)],JSON[_0x2d613b(0x108)](this[_0x2d613b(0x12d)]));}}exports[a58_0x432ba0(0x114)]=LoggerJobState;