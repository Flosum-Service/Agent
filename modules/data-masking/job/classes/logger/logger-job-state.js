const a58_0x4c7974=a58_0x3637;(function(_0x53d0d3,_0x218765){const _0x176124=a58_0x3637,_0x4fabe0=_0x53d0d3();while(!![]){try{const _0x3ffb81=parseInt(_0x176124(0x16c))/0x1+parseInt(_0x176124(0x179))/0x2+-parseInt(_0x176124(0x16d))/0x3+parseInt(_0x176124(0x16a))/0x4*(parseInt(_0x176124(0x18a))/0x5)+-parseInt(_0x176124(0x182))/0x6*(-parseInt(_0x176124(0x183))/0x7)+-parseInt(_0x176124(0x17c))/0x8*(-parseInt(_0x176124(0x176))/0x9)+parseInt(_0x176124(0x1a2))/0xa*(-parseInt(_0x176124(0x170))/0xb);if(_0x3ffb81===_0x218765)break;else _0x4fabe0['push'](_0x4fabe0['shift']());}catch(_0x42c237){_0x4fabe0['push'](_0x4fabe0['shift']());}}}(a58_0x473e,0x383cf));const a58_0x25d0c7=(function(){let _0xd28c96=!![];return function(_0x4ba6bc,_0x3d7597){const _0x156dfa=_0xd28c96?function(){const _0x5b5eaa=a58_0x3637;if(_0x3d7597){const _0x2815fd=_0x3d7597[_0x5b5eaa(0x178)](_0x4ba6bc,arguments);return _0x3d7597=null,_0x2815fd;}}:function(){};return _0xd28c96=![],_0x156dfa;};}()),a58_0x3bb530=a58_0x25d0c7(this,function(){const _0x40b15e=a58_0x3637;return a58_0x3bb530[_0x40b15e(0x198)]()[_0x40b15e(0x173)]('(((.+)+)+)+$')[_0x40b15e(0x198)]()['constructor'](a58_0x3bb530)['search'](_0x40b15e(0x18c));});function a58_0x3637(_0x390967,_0x116b3b){const _0x450a93=a58_0x473e();return a58_0x3637=function(_0x3bb530,_0x25d0c7){_0x3bb530=_0x3bb530-0x166;let _0x473ead=_0x450a93[_0x3bb530];return _0x473ead;},a58_0x3637(_0x390967,_0x116b3b);}a58_0x3bb530();function a58_0x473e(){const _0xb0b4de=['completedDate','successful','write','initObjectStatistics','start','__esModule','init','toString','LoggerJobState','status','updateLoggerState','JobStatus','_isLoggerInit','filePath','parse','path','isLoggerInit','370PmIxnZ','defineProperty','../../enums/logger.enums','JOB_LOG_STATE_FILENAME','_jobPath','188HkWovh','getObjectState','119532LXGYaE','451230rJxiWN','_jobState','jobState','171237WVyFdO','initJobState','stringify','search','find','FsUtils','519084xnYXLE','setObjectStatus','apply','796680ORtjzq','getTime','processed','32LDYHFs','utf-8','failed','default','updateObjectProcess','./base-logger','6mVZjRM','750456jiQwms','Logger\x20Job\x20State\x20wasn\x27t\x20init','_jobId','readFile','includes','setJobStatus','ObjectStatus','10740cqDFRN','isExistsPath','(((.+)+)+)+$','writeFile','QUEUED','__importDefault','getJobState'];a58_0x473e=function(){return _0xb0b4de;};return a58_0x473e();}'use strict';var __importDefault=this&&this[a58_0x4c7974(0x18f)]||function(_0x372ff6){const _0x28b6a8=a58_0x4c7974;return _0x372ff6&&_0x372ff6[_0x28b6a8(0x196)]?_0x372ff6:{'default':_0x372ff6};};Object[a58_0x4c7974(0x166)](exports,a58_0x4c7974(0x196),{'value':!![]}),exports['LoggerJobState']=void 0x0;const path_1=__importDefault(require(a58_0x4c7974(0x1a0))),logger_enums_1=require(a58_0x4c7974(0x167)),base_logger_1=require(a58_0x4c7974(0x181)),promises_1=require('fs/promises'),job_detail_1=require('../../job-detail'),utils_1=require('@flosum/utils'),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1['BaseLogger']{constructor(){const _0x272b31=a58_0x4c7974;super(...arguments),this[_0x272b31(0x19d)]=![];}get[a58_0x4c7974(0x1a1)](){const _0x3cc1c6=a58_0x4c7974;return this[_0x3cc1c6(0x19d)];}set[a58_0x4c7974(0x1a1)](_0x456b4d){const _0x15e73f=a58_0x4c7974;this[_0x15e73f(0x19d)]=_0x456b4d;}get[a58_0x4c7974(0x16f)](){const _0x3f8ba6=a58_0x4c7974;if(!this['isLoggerInit'])throw new Error(_0x3f8ba6(0x184));return this[_0x3f8ba6(0x16e)];}get[a58_0x4c7974(0x19e)](){const _0x339624=a58_0x4c7974;return path_1[_0x339624(0x17f)]['join'](this[_0x339624(0x169)],job_1[_0x339624(0x168)]);}async[a58_0x4c7974(0x197)](_0x51b483){const _0x3b6cc7=a58_0x4c7974;return this[_0x3b6cc7(0x16e)]=await this[_0x3b6cc7(0x190)](),this[_0x3b6cc7(0x16e)][_0x3b6cc7(0x17b)]=this['initObjectStatistics'](_0x51b483),await this[_0x3b6cc7(0x193)](),await this[_0x3b6cc7(0x195)](),this[_0x3b6cc7(0x1a1)]=!![],this;}[a58_0x4c7974(0x177)](_0xf9807d,_0x4805da){const _0x3998ba=a58_0x4c7974;this[_0x3998ba(0x16b)](_0xf9807d)[_0x3998ba(0x19a)]=_0x4805da,this['updateLoggerState']();}[a58_0x4c7974(0x188)](_0x2ae79b){const _0x2acff2=a58_0x4c7974;this[_0x2acff2(0x16f)][_0x2acff2(0x19a)]=_0x2ae79b,[logger_enums_1[_0x2acff2(0x19c)]['FAILED'],logger_enums_1[_0x2acff2(0x19c)]['COMPLETED']][_0x2acff2(0x187)](_0x2ae79b)&&(this['jobState'][_0x2acff2(0x191)]=new Date()[_0x2acff2(0x17a)]()),this[_0x2acff2(0x19b)]();}['setJobError'](_0x36f178){const _0x41e962=a58_0x4c7974;this[_0x41e962(0x16f)]['error']=_0x36f178,this[_0x41e962(0x19b)]();}[a58_0x4c7974(0x180)](_0x47d338,_0x7cfe7,_0x545f40){const _0x154a65=a58_0x4c7974,_0x51dedf=this[_0x154a65(0x16b)](_0x47d338);_0x51dedf['successful']+=_0x7cfe7,_0x51dedf[_0x154a65(0x17e)]+=_0x545f40,this['jobState'][_0x154a65(0x192)]+=_0x7cfe7,this[_0x154a65(0x16f)][_0x154a65(0x17e)]+=_0x545f40,this[_0x154a65(0x19b)]();}['getObjectState'](_0x47f5e1){const _0x528d04=a58_0x4c7974;var _0x50f93b;const _0x2c0a2c=(_0x50f93b=this[_0x528d04(0x16f)][_0x528d04(0x17b)])===null||_0x50f93b===void 0x0?void 0x0:_0x50f93b[_0x528d04(0x174)](_0x452f91=>_0x452f91['name']===_0x47f5e1);if(!_0x2c0a2c)throw new Error('Cannot\x20find\x20object\x20\x27'+_0x47f5e1+'\x27\x20in\x20statistic');return _0x2c0a2c;}async[a58_0x4c7974(0x190)](){const _0x20a208=a58_0x4c7974;if(!await utils_1[_0x20a208(0x175)][_0x20a208(0x18b)](this['filePath']))return this['initJobState']();const _0x3c3c05=await(0x0,promises_1[_0x20a208(0x186)])(job_detail_1['jobStorePath']+'/'+job_1[_0x20a208(0x168)],{'encoding':_0x20a208(0x17d)});return JSON[_0x20a208(0x19f)](_0x3c3c05);}[a58_0x4c7974(0x171)](){const _0x25195f=a58_0x4c7974;return{'id':this[_0x25195f(0x185)],'status':logger_enums_1[_0x25195f(0x19c)][_0x25195f(0x18e)],'processed':[],'createdDate':new Date()[_0x25195f(0x17a)](),'successful':0x0,'failed':0x0};}[a58_0x4c7974(0x194)](_0x5c7851){const _0x3d9f7c=a58_0x4c7974;return _0x5c7851['map'](_0x110df6=>({'name':_0x110df6,'status':logger_enums_1[_0x3d9f7c(0x189)][_0x3d9f7c(0x18e)],'failed':0x0,'successful':0x0}));}[a58_0x4c7974(0x193)](){const _0x2b66a9=a58_0x4c7974;return(0x0,promises_1[_0x2b66a9(0x18d)])(this[_0x2b66a9(0x19e)],JSON[_0x2b66a9(0x172)](this[_0x2b66a9(0x16e)]));}}exports[a58_0x4c7974(0x199)]=LoggerJobState;