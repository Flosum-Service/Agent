const a73_0x46b0a5=a73_0x9b0a;(function(_0x48f939,_0x58d2fe){const _0x24fd84=a73_0x9b0a,_0x2d5e34=_0x48f939();while(!![]){try{const _0x60a0c5=-parseInt(_0x24fd84(0x110))/0x1+-parseInt(_0x24fd84(0x120))/0x2+-parseInt(_0x24fd84(0x12f))/0x3+-parseInt(_0x24fd84(0x111))/0x4+-parseInt(_0x24fd84(0x102))/0x5+parseInt(_0x24fd84(0x108))/0x6+parseInt(_0x24fd84(0x117))/0x7;if(_0x60a0c5===_0x58d2fe)break;else _0x2d5e34['push'](_0x2d5e34['shift']());}catch(_0x354ad7){_0x2d5e34['push'](_0x2d5e34['shift']());}}}(a73_0x34b5,0xf41da));function a73_0x9b0a(_0x4ca971,_0x2f040d){const _0x10df2f=a73_0x34b5();return a73_0x9b0a=function(_0x2ead63,_0x31c2f7){_0x2ead63=_0x2ead63-0xf4;let _0x34b52c=_0x10df2f[_0x2ead63];return _0x34b52c;},a73_0x9b0a(_0x4ca971,_0x2f040d);}const a73_0x31c2f7=(function(){let _0x9f9443=!![];return function(_0x244d6c,_0x42df96){const _0x5e31ba=_0x9f9443?function(){const _0x362807=a73_0x9b0a;if(_0x42df96){const _0x18aa51=_0x42df96[_0x362807(0x10e)](_0x244d6c,arguments);return _0x42df96=null,_0x18aa51;}}:function(){};return _0x9f9443=![],_0x5e31ba;};}()),a73_0x2ead63=a73_0x31c2f7(this,function(){const _0x4a2895=a73_0x9b0a;return a73_0x2ead63[_0x4a2895(0x12b)]()['search'](_0x4a2895(0x127))[_0x4a2895(0x12b)]()[_0x4a2895(0x11c)](a73_0x2ead63)[_0x4a2895(0x11e)](_0x4a2895(0x127));});a73_0x2ead63();'use strict';var __importDefault=this&&this[a73_0x46b0a5(0x106)]||function(_0x3feee3){return _0x3feee3&&_0x3feee3['__esModule']?_0x3feee3:{'default':_0x3feee3};};function a73_0x34b5(){const _0x44c5c1=['(((.+)+)+)+$','getObjectState','__esModule','getJobState','toString','name','QUEUED','start','3547212VpowXk','writeFile','write','updateLoggerState','error','isLoggerInit','filePath','default','completedDate','setObjectStatus','JOB_LOG_STATE_FILENAME','includes','initObjectStatistics','updateObjectProcess','_jobId','7565635IUWYGY','getTime','stringify','initJobState','__importDefault','processed','11136732EDSGuz','jobStorePath','failed','setJobStatus','_jobPath','join','apply','fs/promises','1715455nJCVMO','7123680spnbOF','utf-8','COMPLETED','status','FsUtils','_jobState','46902303rLhijf','JobStatus','../../enums/logger.enums','@flosum/utils','LoggerJobState','constructor','Cannot\x20find\x20object\x20\x27','search','jobState','2729294mvjHME','setJobError','defineProperty','path','parse','\x27\x20in\x20statistic','_isLoggerInit'];a73_0x34b5=function(){return _0x44c5c1;};return a73_0x34b5();}Object[a73_0x46b0a5(0x122)](exports,a73_0x46b0a5(0x129),{'value':!![]}),exports[a73_0x46b0a5(0x11b)]=void 0x0;const path_1=__importDefault(require(a73_0x46b0a5(0x123))),logger_enums_1=require(a73_0x46b0a5(0x119)),base_logger_1=require('./base-logger'),promises_1=require(a73_0x46b0a5(0x10f)),job_detail_1=require('../../job-detail'),utils_1=require(a73_0x46b0a5(0x11a)),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1['BaseLogger']{constructor(){const _0x462b0d=a73_0x46b0a5;super(...arguments),this[_0x462b0d(0x126)]=![];}get['isLoggerInit'](){return this['_isLoggerInit'];}set[a73_0x46b0a5(0xf8)](_0x4dbd58){const _0x397bda=a73_0x46b0a5;this[_0x397bda(0x126)]=_0x4dbd58;}get[a73_0x46b0a5(0x11f)](){const _0x4f23fe=a73_0x46b0a5;if(!this[_0x4f23fe(0xf8)])throw new Error('Logger\x20Job\x20State\x20wasn\x27t\x20init');return this['_jobState'];}get[a73_0x46b0a5(0xf9)](){const _0xdbc9ff=a73_0x46b0a5;return path_1[_0xdbc9ff(0xfa)][_0xdbc9ff(0x10d)](this[_0xdbc9ff(0x10c)],job_1[_0xdbc9ff(0xfd)]);}async['init'](_0x25ea75){const _0x5292af=a73_0x46b0a5;return this['_jobState']=await this[_0x5292af(0x12a)](),this[_0x5292af(0x116)][_0x5292af(0x107)]=this['initObjectStatistics'](_0x25ea75),await this[_0x5292af(0xf5)](),await this[_0x5292af(0x12e)](),this[_0x5292af(0xf8)]=!![],this;}[a73_0x46b0a5(0xfc)](_0x4d75ab,_0x5505b2){const _0x43d837=a73_0x46b0a5;this['getObjectState'](_0x4d75ab)[_0x43d837(0x114)]=_0x5505b2,this[_0x43d837(0xf6)]();}[a73_0x46b0a5(0x10b)](_0x39f053){const _0x2abebe=a73_0x46b0a5;this[_0x2abebe(0x11f)][_0x2abebe(0x114)]=_0x39f053,[logger_enums_1[_0x2abebe(0x118)]['FAILED'],logger_enums_1[_0x2abebe(0x118)][_0x2abebe(0x113)]][_0x2abebe(0xfe)](_0x39f053)&&(this['jobState'][_0x2abebe(0xfb)]=new Date()[_0x2abebe(0x103)]()),this[_0x2abebe(0xf6)]();}[a73_0x46b0a5(0x121)](_0x171edc){const _0x26b090=a73_0x46b0a5;this['jobState'][_0x26b090(0xf7)]=_0x171edc,this[_0x26b090(0xf6)]();}[a73_0x46b0a5(0x100)](_0x20a0ff,_0x2426c1,_0x1e2085){const _0x24c68e=a73_0x46b0a5,_0x1842e0=this[_0x24c68e(0x128)](_0x20a0ff);_0x1842e0['successful']+=_0x2426c1,_0x1842e0[_0x24c68e(0x10a)]+=_0x1e2085,this[_0x24c68e(0x11f)]['successful']+=_0x2426c1,this[_0x24c68e(0x11f)][_0x24c68e(0x10a)]+=_0x1e2085,this[_0x24c68e(0xf6)]();}[a73_0x46b0a5(0x128)](_0x24948a){const _0x22a1dc=a73_0x46b0a5;var _0x1433cf;const _0x1fb814=(_0x1433cf=this['jobState'][_0x22a1dc(0x107)])===null||_0x1433cf===void 0x0?void 0x0:_0x1433cf['find'](_0x9b37ee=>_0x9b37ee[_0x22a1dc(0x12c)]===_0x24948a);if(!_0x1fb814)throw new Error(_0x22a1dc(0x11d)+_0x24948a+_0x22a1dc(0x125));return _0x1fb814;}async['getJobState'](){const _0x2442e2=a73_0x46b0a5;if(!await utils_1[_0x2442e2(0x115)]['isExistsPath'](this[_0x2442e2(0xf9)]))return this[_0x2442e2(0x105)]();const _0xc8b1c9=await(0x0,promises_1['readFile'])(job_detail_1[_0x2442e2(0x109)]+'/'+job_1[_0x2442e2(0xfd)],{'encoding':_0x2442e2(0x112)});return JSON[_0x2442e2(0x124)](_0xc8b1c9);}[a73_0x46b0a5(0x105)](){const _0x54fa8b=a73_0x46b0a5;return{'id':this[_0x54fa8b(0x101)],'status':logger_enums_1[_0x54fa8b(0x118)]['QUEUED'],'processed':[],'createdDate':new Date()[_0x54fa8b(0x103)](),'successful':0x0,'failed':0x0};}[a73_0x46b0a5(0xff)](_0x23b501){const _0x3ccf65=a73_0x46b0a5;return _0x23b501['map'](_0x4b1cb4=>({'name':_0x4b1cb4,'status':logger_enums_1['ObjectStatus'][_0x3ccf65(0x12d)],'failed':0x0,'successful':0x0}));}['write'](){const _0x5577ee=a73_0x46b0a5;return(0x0,promises_1[_0x5577ee(0xf4)])(this[_0x5577ee(0xf9)],JSON[_0x5577ee(0x104)](this[_0x5577ee(0x116)]));}}exports[a73_0x46b0a5(0x11b)]=LoggerJobState;