const a58_0x47657c=a58_0x893d;function a58_0x1098(){const _0x27d19d=['map','../../../../../constants/job','26218ScbGri','toString','includes','_isLoggerInit','fs/promises','name','29493XzYMcY','../../job-detail','ObjectStatus','getTime','QUEUED','writeFile','3265045OxuUJv','processed','parse','Cannot\x20find\x20object\x20\x27','defineProperty','./base-logger','readFile','COMPLETED','setJobError','Logger\x20Job\x20State\x20wasn\x27t\x20init','constructor','status','3504ktLDsA','apply','isLoggerInit','LoggerJobState','join','_jobState','getObjectState','__esModule','completedDate','__importDefault','search','2033274bgONNK','59487YIhSAt','successful','isExistsPath','updateLoggerState','_jobPath','start','FsUtils','setObjectStatus','filePath','JobStatus','path','getJobState','(((.+)+)+)+$','init','jobState','write','641859Dtmkzx','@flosum/utils','updateObjectProcess','76OwpMNY','jobStorePath','\x27\x20in\x20statistic','JOB_LOG_STATE_FILENAME','FAILED','134550iPSBhe','error'];a58_0x1098=function(){return _0x27d19d;};return a58_0x1098();}function a58_0x893d(_0x751968,_0x5255a3){const _0x52c2f1=a58_0x1098();return a58_0x893d=function(_0x5b67b1,_0x3df579){_0x5b67b1=_0x5b67b1-0xc1;let _0x1098ff=_0x52c2f1[_0x5b67b1];return _0x1098ff;},a58_0x893d(_0x751968,_0x5255a3);}(function(_0x16383e,_0x4dab8f){const _0x135540=a58_0x893d,_0x54177b=_0x16383e();while(!![]){try{const _0x5d024f=-parseInt(_0x135540(0xda))/0x1+parseInt(_0x135540(0xe6))/0x2+parseInt(_0x135540(0xca))/0x3*(parseInt(_0x135540(0xdd))/0x4)+-parseInt(_0x135540(0xe2))/0x5+-parseInt(_0x135540(0xc9))/0x6+-parseInt(_0x135540(0xf2))/0x7+parseInt(_0x135540(0xfe))/0x8*(parseInt(_0x135540(0xec))/0x9);if(_0x5d024f===_0x4dab8f)break;else _0x54177b['push'](_0x54177b['shift']());}catch(_0xad9ce5){_0x54177b['push'](_0x54177b['shift']());}}}(a58_0x1098,0x55b7f));const a58_0x3df579=(function(){let _0x383b52=!![];return function(_0x14178a,_0x494c21){const _0x154060=_0x383b52?function(){const _0x495b42=a58_0x893d;if(_0x494c21){const _0x50b1e7=_0x494c21[_0x495b42(0xff)](_0x14178a,arguments);return _0x494c21=null,_0x50b1e7;}}:function(){};return _0x383b52=![],_0x154060;};}()),a58_0x5b67b1=a58_0x3df579(this,function(){const _0x32bca8=a58_0x893d;return a58_0x5b67b1[_0x32bca8(0xe7)]()[_0x32bca8(0xc8)](_0x32bca8(0xd6))['toString']()[_0x32bca8(0xfc)](a58_0x5b67b1)[_0x32bca8(0xc8)](_0x32bca8(0xd6));});a58_0x5b67b1();'use strict';var __importDefault=this&&this[a58_0x47657c(0xc7)]||function(_0x1abab6){const _0x10d0c7=a58_0x47657c;return _0x1abab6&&_0x1abab6[_0x10d0c7(0xc5)]?_0x1abab6:{'default':_0x1abab6};};Object[a58_0x47657c(0xf6)](exports,a58_0x47657c(0xc5),{'value':!![]}),exports[a58_0x47657c(0xc1)]=void 0x0;const path_1=__importDefault(require(a58_0x47657c(0xd4))),logger_enums_1=require('../../enums/logger.enums'),base_logger_1=require(a58_0x47657c(0xf7)),promises_1=require(a58_0x47657c(0xea)),job_detail_1=require(a58_0x47657c(0xed)),utils_1=require(a58_0x47657c(0xdb)),job_1=require(a58_0x47657c(0xe5));class LoggerJobState extends base_logger_1['BaseLogger']{constructor(){const _0x4ff276=a58_0x47657c;super(...arguments),this[_0x4ff276(0xe9)]=![];}get[a58_0x47657c(0x100)](){const _0x4070a0=a58_0x47657c;return this[_0x4070a0(0xe9)];}set[a58_0x47657c(0x100)](_0x2149f1){const _0x2cf939=a58_0x47657c;this[_0x2cf939(0xe9)]=_0x2149f1;}get[a58_0x47657c(0xd8)](){const _0x39a172=a58_0x47657c;if(!this[_0x39a172(0x100)])throw new Error(_0x39a172(0xfb));return this[_0x39a172(0xc3)];}get[a58_0x47657c(0xd2)](){const _0xd2d2e8=a58_0x47657c;return path_1['default'][_0xd2d2e8(0xc2)](this[_0xd2d2e8(0xce)],job_1[_0xd2d2e8(0xe0)]);}async[a58_0x47657c(0xd7)](_0x56b8c6){const _0x38c0ac=a58_0x47657c;return this[_0x38c0ac(0xc3)]=await this['getJobState'](),this[_0x38c0ac(0xc3)][_0x38c0ac(0xf3)]=this['initObjectStatistics'](_0x56b8c6),await this[_0x38c0ac(0xd9)](),await this[_0x38c0ac(0xcf)](),this[_0x38c0ac(0x100)]=!![],this;}[a58_0x47657c(0xd1)](_0x285e01,_0x114a3e){const _0x97674a=a58_0x47657c;this[_0x97674a(0xc4)](_0x285e01)[_0x97674a(0xfd)]=_0x114a3e,this[_0x97674a(0xcd)]();}['setJobStatus'](_0xbf8189){const _0x5779a8=a58_0x47657c;this[_0x5779a8(0xd8)][_0x5779a8(0xfd)]=_0xbf8189,[logger_enums_1['JobStatus'][_0x5779a8(0xe1)],logger_enums_1[_0x5779a8(0xd3)][_0x5779a8(0xf9)]][_0x5779a8(0xe8)](_0xbf8189)&&(this[_0x5779a8(0xd8)][_0x5779a8(0xc6)]=new Date()[_0x5779a8(0xef)]()),this['updateLoggerState']();}[a58_0x47657c(0xfa)](_0x31ef93){const _0x431214=a58_0x47657c;this[_0x431214(0xd8)][_0x431214(0xe3)]=_0x31ef93,this[_0x431214(0xcd)]();}[a58_0x47657c(0xdc)](_0x265177,_0x2f2da4,_0x34c75d){const _0x47d6ad=a58_0x47657c,_0x36f4e2=this[_0x47d6ad(0xc4)](_0x265177);_0x36f4e2[_0x47d6ad(0xcb)]+=_0x2f2da4,_0x36f4e2['failed']+=_0x34c75d,this['jobState'][_0x47d6ad(0xcb)]+=_0x2f2da4,this[_0x47d6ad(0xd8)]['failed']+=_0x34c75d,this[_0x47d6ad(0xcd)]();}[a58_0x47657c(0xc4)](_0x44dcbd){const _0x199806=a58_0x47657c;var _0x5cba95;const _0x57e742=(_0x5cba95=this[_0x199806(0xd8)][_0x199806(0xf3)])===null||_0x5cba95===void 0x0?void 0x0:_0x5cba95['find'](_0x518b5b=>_0x518b5b[_0x199806(0xeb)]===_0x44dcbd);if(!_0x57e742)throw new Error(_0x199806(0xf5)+_0x44dcbd+_0x199806(0xdf));return _0x57e742;}async[a58_0x47657c(0xd5)](){const _0x10e06c=a58_0x47657c;if(!await utils_1[_0x10e06c(0xd0)][_0x10e06c(0xcc)](this['filePath']))return this['initJobState']();const _0xf5c278=await(0x0,promises_1[_0x10e06c(0xf8)])(job_detail_1[_0x10e06c(0xde)]+'/'+job_1[_0x10e06c(0xe0)],{'encoding':'utf-8'});return JSON[_0x10e06c(0xf4)](_0xf5c278);}['initJobState'](){const _0x4c45fd=a58_0x47657c;return{'id':this['_jobId'],'status':logger_enums_1[_0x4c45fd(0xd3)][_0x4c45fd(0xf0)],'processed':[],'createdDate':new Date()[_0x4c45fd(0xef)](),'successful':0x0,'failed':0x0};}['initObjectStatistics'](_0x1c6cee){const _0x4ff009=a58_0x47657c;return _0x1c6cee[_0x4ff009(0xe4)](_0x2ae4ef=>({'name':_0x2ae4ef,'status':logger_enums_1[_0x4ff009(0xee)][_0x4ff009(0xf0)],'failed':0x0,'successful':0x0}));}[a58_0x47657c(0xd9)](){const _0x2f43e5=a58_0x47657c;return(0x0,promises_1[_0x2f43e5(0xf1)])(this[_0x2f43e5(0xd2)],JSON['stringify'](this[_0x2f43e5(0xc3)]));}}exports['LoggerJobState']=LoggerJobState;