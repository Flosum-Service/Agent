const a58_0x210412=a58_0x1c00;function a58_0x1c00(_0x480479,_0x310c7a){const _0x3ef016=a58_0x5413();return a58_0x1c00=function(_0x1951b2,_0x5bc97f){_0x1951b2=_0x1951b2-0xee;let _0x541372=_0x3ef016[_0x1951b2];return _0x541372;},a58_0x1c00(_0x480479,_0x310c7a);}(function(_0xa5e839,_0x388b85){const _0x2570fe=a58_0x1c00,_0x3ee265=_0xa5e839();while(!![]){try{const _0x23dbdf=-parseInt(_0x2570fe(0x125))/0x1+-parseInt(_0x2570fe(0x11f))/0x2*(-parseInt(_0x2570fe(0x105))/0x3)+parseInt(_0x2570fe(0xf3))/0x4*(-parseInt(_0x2570fe(0x128))/0x5)+parseInt(_0x2570fe(0x121))/0x6+parseInt(_0x2570fe(0x106))/0x7*(-parseInt(_0x2570fe(0x117))/0x8)+-parseInt(_0x2570fe(0x12d))/0x9+parseInt(_0x2570fe(0x102))/0xa*(parseInt(_0x2570fe(0x11b))/0xb);if(_0x23dbdf===_0x388b85)break;else _0x3ee265['push'](_0x3ee265['shift']());}catch(_0xff9f1b){_0x3ee265['push'](_0x3ee265['shift']());}}}(a58_0x5413,0x1c0a0));const a58_0x5bc97f=(function(){let _0x401c18=!![];return function(_0x52590f,_0x3b12a2){const _0x1896a4=_0x401c18?function(){const _0x43afb4=a58_0x1c00;if(_0x3b12a2){const _0x3fcfa0=_0x3b12a2[_0x43afb4(0x119)](_0x52590f,arguments);return _0x3b12a2=null,_0x3fcfa0;}}:function(){};return _0x401c18=![],_0x1896a4;};}()),a58_0x1951b2=a58_0x5bc97f(this,function(){const _0x17c95b=a58_0x1c00;return a58_0x1951b2[_0x17c95b(0x109)]()[_0x17c95b(0x116)](_0x17c95b(0xee))[_0x17c95b(0x109)]()[_0x17c95b(0xf0)](a58_0x1951b2)['search']('(((.+)+)+)+$');});a58_0x1951b2();'use strict';function a58_0x5413(){const _0x5cb849=['__importDefault','writeFile','LoggerJobState','join','7570DtIROB','_jobState','parse','321DnJJCE','22897yVeRsf','includes','write','toString','JobStatus','jobState','initObjectStatistics','stringify','Cannot\x20find\x20object\x20\x27','init','jobStorePath','completedDate','QUEUED','FsUtils','isLoggerInit','start','search','472CRghXr','updateObjectProcess','apply','processed','6061OVSqaG','filePath','__esModule','setObjectStatus','3138xSHAoT','JOB_LOG_STATE_FILENAME','975054TRgCTV','setJobError','status','name','22554EyPsLi','FAILED','updateLoggerState','509980MklQmm','_isLoggerInit','BaseLogger','getObjectState','successful','1918044pCySDH','map','initJobState','readFile','(((.+)+)+)+$','getTime','constructor','_jobId','find','8RqirVd','failed','../../job-detail','getJobState','defineProperty','./base-logger','default','Logger\x20Job\x20State\x20wasn\x27t\x20init','COMPLETED','isExistsPath','error'];a58_0x5413=function(){return _0x5cb849;};return a58_0x5413();}var __importDefault=this&&this[a58_0x210412(0xfe)]||function(_0x299dc0){const _0x1b983f=a58_0x210412;return _0x299dc0&&_0x299dc0[_0x1b983f(0x11d)]?_0x299dc0:{'default':_0x299dc0};};Object[a58_0x210412(0xf7)](exports,'__esModule',{'value':!![]}),exports['LoggerJobState']=void 0x0;const path_1=__importDefault(require('path')),logger_enums_1=require('../../enums/logger.enums'),base_logger_1=require(a58_0x210412(0xf8)),promises_1=require('fs/promises'),job_detail_1=require(a58_0x210412(0xf5)),utils_1=require('@flosum/utils'),job_1=require('../../../../../constants/job');class LoggerJobState extends base_logger_1[a58_0x210412(0x12a)]{constructor(){const _0x3a169a=a58_0x210412;super(...arguments),this[_0x3a169a(0x129)]=![];}get[a58_0x210412(0x114)](){return this['_isLoggerInit'];}set['isLoggerInit'](_0xf6c054){this['_isLoggerInit']=_0xf6c054;}get[a58_0x210412(0x10b)](){const _0x55b200=a58_0x210412;if(!this[_0x55b200(0x114)])throw new Error(_0x55b200(0xfa));return this['_jobState'];}get[a58_0x210412(0x11c)](){const _0x405034=a58_0x210412;return path_1[_0x405034(0xf9)][_0x405034(0x101)](this['_jobPath'],job_1[_0x405034(0x120)]);}async[a58_0x210412(0x10f)](_0x490617){const _0x1ee86f=a58_0x210412;return this[_0x1ee86f(0x103)]=await this[_0x1ee86f(0xf6)](),this[_0x1ee86f(0x103)][_0x1ee86f(0x11a)]=this[_0x1ee86f(0x10c)](_0x490617),await this[_0x1ee86f(0x108)](),await this[_0x1ee86f(0x115)](),this['isLoggerInit']=!![],this;}[a58_0x210412(0x11e)](_0x2128dc,_0x3bfed1){const _0x2e51cc=a58_0x210412;this[_0x2e51cc(0x12b)](_0x2128dc)['status']=_0x3bfed1,this['updateLoggerState']();}['setJobStatus'](_0xc90699){const _0x5f73de=a58_0x210412;this[_0x5f73de(0x10b)][_0x5f73de(0x123)]=_0xc90699,[logger_enums_1[_0x5f73de(0x10a)][_0x5f73de(0x126)],logger_enums_1[_0x5f73de(0x10a)][_0x5f73de(0xfb)]][_0x5f73de(0x107)](_0xc90699)&&(this['jobState'][_0x5f73de(0x111)]=new Date()[_0x5f73de(0xef)]()),this[_0x5f73de(0x127)]();}[a58_0x210412(0x122)](_0xcf2520){const _0x54ea39=a58_0x210412;this[_0x54ea39(0x10b)][_0x54ea39(0xfd)]=_0xcf2520,this[_0x54ea39(0x127)]();}[a58_0x210412(0x118)](_0x17e167,_0x57e8de,_0x49ae02){const _0x161741=a58_0x210412,_0x4849e6=this['getObjectState'](_0x17e167);_0x4849e6[_0x161741(0x12c)]+=_0x57e8de,_0x4849e6['failed']+=_0x49ae02,this[_0x161741(0x10b)][_0x161741(0x12c)]+=_0x57e8de,this[_0x161741(0x10b)][_0x161741(0xf4)]+=_0x49ae02,this['updateLoggerState']();}[a58_0x210412(0x12b)](_0x345c34){const _0x2429ef=a58_0x210412;var _0x3bfdd1;const _0x585f46=(_0x3bfdd1=this[_0x2429ef(0x10b)][_0x2429ef(0x11a)])===null||_0x3bfdd1===void 0x0?void 0x0:_0x3bfdd1[_0x2429ef(0xf2)](_0x520c39=>_0x520c39[_0x2429ef(0x124)]===_0x345c34);if(!_0x585f46)throw new Error(_0x2429ef(0x10e)+_0x345c34+'\x27\x20in\x20statistic');return _0x585f46;}async[a58_0x210412(0xf6)](){const _0x5cb295=a58_0x210412;if(!await utils_1[_0x5cb295(0x113)][_0x5cb295(0xfc)](this['filePath']))return this[_0x5cb295(0x12f)]();const _0x37d2db=await(0x0,promises_1[_0x5cb295(0x130)])(job_detail_1[_0x5cb295(0x110)]+'/'+job_1['JOB_LOG_STATE_FILENAME'],{'encoding':'utf-8'});return JSON[_0x5cb295(0x104)](_0x37d2db);}[a58_0x210412(0x12f)](){const _0x1c911a=a58_0x210412;return{'id':this[_0x1c911a(0xf1)],'status':logger_enums_1[_0x1c911a(0x10a)][_0x1c911a(0x112)],'processed':[],'createdDate':new Date()[_0x1c911a(0xef)](),'successful':0x0,'failed':0x0};}[a58_0x210412(0x10c)](_0x5e8856){const _0x2523c7=a58_0x210412;return _0x5e8856[_0x2523c7(0x12e)](_0x47adef=>({'name':_0x47adef,'status':logger_enums_1['ObjectStatus'][_0x2523c7(0x112)],'failed':0x0,'successful':0x0}));}['write'](){const _0x2fbcc8=a58_0x210412;return(0x0,promises_1[_0x2fbcc8(0xff)])(this[_0x2fbcc8(0x11c)],JSON[_0x2fbcc8(0x10d)](this['_jobState']));}}exports[a58_0x210412(0x100)]=LoggerJobState;