const a58_0x479ea4=a58_0x2531;(function(_0x5aa400,_0x33c127){const _0x23945f=a58_0x2531,_0x4a52f4=_0x5aa400();while(!![]){try{const _0x293a22=-parseInt(_0x23945f(0x196))/0x1*(parseInt(_0x23945f(0x164))/0x2)+-parseInt(_0x23945f(0x16d))/0x3*(parseInt(_0x23945f(0x169))/0x4)+-parseInt(_0x23945f(0x185))/0x5+parseInt(_0x23945f(0x191))/0x6*(-parseInt(_0x23945f(0x193))/0x7)+parseInt(_0x23945f(0x199))/0x8*(parseInt(_0x23945f(0x1a0))/0x9)+-parseInt(_0x23945f(0x18e))/0xa+-parseInt(_0x23945f(0x187))/0xb*(-parseInt(_0x23945f(0x18b))/0xc);if(_0x293a22===_0x33c127)break;else _0x4a52f4['push'](_0x4a52f4['shift']());}catch(_0x1e6946){_0x4a52f4['push'](_0x4a52f4['shift']());}}}(a58_0x4898,0x1b2ab));const a58_0x15444b=(function(){let _0x17b2a2=!![];return function(_0x3e1988,_0x357482){const _0x249651=_0x17b2a2?function(){const _0x26a08d=a58_0x2531;if(_0x357482){const _0x45603c=_0x357482[_0x26a08d(0x17c)](_0x3e1988,arguments);return _0x357482=null,_0x45603c;}}:function(){};return _0x17b2a2=![],_0x249651;};}()),a58_0x3c5bc9=a58_0x15444b(this,function(){const _0x4ed4ed=a58_0x2531;return a58_0x3c5bc9[_0x4ed4ed(0x168)]()[_0x4ed4ed(0x19c)](_0x4ed4ed(0x16f))[_0x4ed4ed(0x168)]()[_0x4ed4ed(0x16b)](a58_0x3c5bc9)[_0x4ed4ed(0x19c)](_0x4ed4ed(0x16f));});a58_0x3c5bc9();'use strict';function a58_0x2531(_0x487604,_0x59724c){const _0x666a7e=a58_0x4898();return a58_0x2531=function(_0x3c5bc9,_0x15444b){_0x3c5bc9=_0x3c5bc9-0x162;let _0x48982a=_0x666a7e[_0x3c5bc9];return _0x48982a;},a58_0x2531(_0x487604,_0x59724c);}var __importDefault=this&&this[a58_0x479ea4(0x177)]||function(_0x27b19d){const _0x28c9a5=a58_0x479ea4;return _0x27b19d&&_0x27b19d[_0x28c9a5(0x176)]?_0x27b19d:{'default':_0x27b19d};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a58_0x479ea4(0x195)]=void 0x0;const path_1=__importDefault(require('path')),logger_enums_1=require('../../enums/logger.enums'),base_logger_1=require(a58_0x479ea4(0x198)),promises_1=require(a58_0x479ea4(0x184)),job_detail_1=require('../../job-detail'),utils_1=require(a58_0x479ea4(0x165)),job_1=require(a58_0x479ea4(0x19d));function a58_0x4898(){const _0x447b07=['isExistsPath','constructor','filePath','303AibWiF','failed','(((.+)+)+)+$','readFile','updateLoggerState','QUEUED','_jobPath','writeFile','jobStorePath','__esModule','__importDefault','ObjectStatus','getJobState','_jobState','initJobState','apply','parse','status','start','setJobError','FAILED','stringify','find','fs/promises','1107305uNjsaI','FsUtils','121YEZWfa','includes','_isLoggerInit','COMPLETED','706548CIIXoB','name','JobStatus','1228780jHmkaA','_jobId','join','222072xdhSvp','init','14hjkmWA','jobState','LoggerJobState','418HOOVmw','write','./base-logger','5552alNySo','setJobStatus','utf-8','search','../../../../../constants/job','getObjectState','successful','972jMooMa','initObjectStatistics','JOB_LOG_STATE_FILENAME','Cannot\x20find\x20object\x20\x27','isLoggerInit','804VxIslK','@flosum/utils','updateObjectProcess','setObjectStatus','toString','988TdDBxY'];a58_0x4898=function(){return _0x447b07;};return a58_0x4898();}class LoggerJobState extends base_logger_1['BaseLogger']{constructor(){const _0x596f23=a58_0x479ea4;super(...arguments),this[_0x596f23(0x189)]=![];}get[a58_0x479ea4(0x163)](){const _0x6d2725=a58_0x479ea4;return this[_0x6d2725(0x189)];}set[a58_0x479ea4(0x163)](_0x589ec5){this['_isLoggerInit']=_0x589ec5;}get[a58_0x479ea4(0x194)](){const _0x209bd1=a58_0x479ea4;if(!this[_0x209bd1(0x163)])throw new Error('Logger\x20Job\x20State\x20wasn\x27t\x20init');return this[_0x209bd1(0x17a)];}get[a58_0x479ea4(0x16c)](){const _0xf3b835=a58_0x479ea4;return path_1['default'][_0xf3b835(0x190)](this[_0xf3b835(0x173)],job_1['JOB_LOG_STATE_FILENAME']);}async[a58_0x479ea4(0x192)](_0x587214){const _0x596599=a58_0x479ea4;return this[_0x596599(0x17a)]=await this[_0x596599(0x179)](),this['_jobState']['processed']=this[_0x596599(0x1a1)](_0x587214),await this[_0x596599(0x197)](),await this[_0x596599(0x17f)](),this[_0x596599(0x163)]=!![],this;}[a58_0x479ea4(0x167)](_0x549ab0,_0x376cd4){const _0x591989=a58_0x479ea4;this[_0x591989(0x19e)](_0x549ab0)[_0x591989(0x17e)]=_0x376cd4,this[_0x591989(0x171)]();}[a58_0x479ea4(0x19a)](_0x44b9fb){const _0x4db8a7=a58_0x479ea4;this['jobState'][_0x4db8a7(0x17e)]=_0x44b9fb,[logger_enums_1[_0x4db8a7(0x18d)][_0x4db8a7(0x181)],logger_enums_1[_0x4db8a7(0x18d)][_0x4db8a7(0x18a)]][_0x4db8a7(0x188)](_0x44b9fb)&&(this['jobState']['completedDate']=new Date()['getTime']()),this['updateLoggerState']();}[a58_0x479ea4(0x180)](_0x5ae0a2){const _0x1de0ff=a58_0x479ea4;this[_0x1de0ff(0x194)]['error']=_0x5ae0a2,this['updateLoggerState']();}[a58_0x479ea4(0x166)](_0x517707,_0x2013ab,_0x351716){const _0x27771b=a58_0x479ea4,_0x347481=this['getObjectState'](_0x517707);_0x347481[_0x27771b(0x19f)]+=_0x2013ab,_0x347481[_0x27771b(0x16e)]+=_0x351716,this[_0x27771b(0x194)][_0x27771b(0x19f)]+=_0x2013ab,this[_0x27771b(0x194)][_0x27771b(0x16e)]+=_0x351716,this['updateLoggerState']();}[a58_0x479ea4(0x19e)](_0x109fb9){const _0x552339=a58_0x479ea4;var _0x3ffb25;const _0x551429=(_0x3ffb25=this[_0x552339(0x194)]['processed'])===null||_0x3ffb25===void 0x0?void 0x0:_0x3ffb25[_0x552339(0x183)](_0x19757e=>_0x19757e[_0x552339(0x18c)]===_0x109fb9);if(!_0x551429)throw new Error(_0x552339(0x162)+_0x109fb9+'\x27\x20in\x20statistic');return _0x551429;}async[a58_0x479ea4(0x179)](){const _0x10b08d=a58_0x479ea4;if(!await utils_1[_0x10b08d(0x186)][_0x10b08d(0x16a)](this['filePath']))return this['initJobState']();const _0x1b7c28=await(0x0,promises_1[_0x10b08d(0x170)])(job_detail_1[_0x10b08d(0x175)]+'/'+job_1[_0x10b08d(0x1a2)],{'encoding':_0x10b08d(0x19b)});return JSON[_0x10b08d(0x17d)](_0x1b7c28);}[a58_0x479ea4(0x17b)](){const _0x55e514=a58_0x479ea4;return{'id':this[_0x55e514(0x18f)],'status':logger_enums_1['JobStatus']['QUEUED'],'processed':[],'createdDate':new Date()['getTime'](),'successful':0x0,'failed':0x0};}[a58_0x479ea4(0x1a1)](_0x153a57){const _0x2ba498=a58_0x479ea4;return _0x153a57['map'](_0x2edabe=>({'name':_0x2edabe,'status':logger_enums_1[_0x2ba498(0x178)][_0x2ba498(0x172)],'failed':0x0,'successful':0x0}));}['write'](){const _0xeb20e7=a58_0x479ea4;return(0x0,promises_1[_0xeb20e7(0x174)])(this['filePath'],JSON[_0xeb20e7(0x182)](this['_jobState']));}}exports['LoggerJobState']=LoggerJobState;