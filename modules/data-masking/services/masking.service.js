const a99_0x463c3a=a99_0x2674;(function(_0x54c343,_0x39ae67){const _0x1eef3e=a99_0x2674,_0x3d7a36=_0x54c343();while(!![]){try{const _0x527670=-parseInt(_0x1eef3e(0x14c))/0x1*(parseInt(_0x1eef3e(0x14e))/0x2)+parseInt(_0x1eef3e(0x15e))/0x3*(-parseInt(_0x1eef3e(0x135))/0x4)+-parseInt(_0x1eef3e(0x16a))/0x5+-parseInt(_0x1eef3e(0x161))/0x6*(parseInt(_0x1eef3e(0x152))/0x7)+-parseInt(_0x1eef3e(0x12f))/0x8+-parseInt(_0x1eef3e(0x126))/0x9*(parseInt(_0x1eef3e(0x164))/0xa)+parseInt(_0x1eef3e(0x15a))/0xb*(parseInt(_0x1eef3e(0x131))/0xc);if(_0x527670===_0x39ae67)break;else _0x3d7a36['push'](_0x3d7a36['shift']());}catch(_0x16d4ca){_0x3d7a36['push'](_0x3d7a36['shift']());}}}(a99_0x4350,0xedac2));function a99_0x2674(_0x135a4d,_0x2e6b15){const _0x536201=a99_0x4350();return a99_0x2674=function(_0x412b16,_0x24c763){_0x412b16=_0x412b16-0x126;let _0x43508c=_0x536201[_0x412b16];return _0x43508c;},a99_0x2674(_0x135a4d,_0x2e6b15);}const a99_0x24c763=(function(){let _0x529645=!![];return function(_0x55cdfb,_0x3466e9){const _0x504d50=_0x529645?function(){const _0x13d989=a99_0x2674;if(_0x3466e9){const _0x34be5a=_0x3466e9[_0x13d989(0x159)](_0x55cdfb,arguments);return _0x3466e9=null,_0x34be5a;}}:function(){};return _0x529645=![],_0x504d50;};}()),a99_0x412b16=a99_0x24c763(this,function(){const _0x1aba94=a99_0x2674;return a99_0x412b16[_0x1aba94(0x14f)]()[_0x1aba94(0x141)](_0x1aba94(0x13e))[_0x1aba94(0x14f)]()['constructor'](a99_0x412b16)[_0x1aba94(0x141)]('(((.+)+)+)+$');});a99_0x412b16();'use strict';var __createBinding=this&&this[a99_0x463c3a(0x137)]||(Object[a99_0x463c3a(0x13a)]?function(_0x4958a5,_0x49fde4,_0x3390f4,_0x4e271e){const _0x141506=a99_0x463c3a;if(_0x4e271e===undefined)_0x4e271e=_0x3390f4;var _0x143d97=Object[_0x141506(0x16d)](_0x49fde4,_0x3390f4);(!_0x143d97||(_0x141506(0x12c)in _0x143d97?!_0x49fde4[_0x141506(0x153)]:_0x143d97[_0x141506(0x16e)]||_0x143d97[_0x141506(0x148)]))&&(_0x143d97={'enumerable':!![],'get':function(){return _0x49fde4[_0x3390f4];}}),Object[_0x141506(0x140)](_0x4958a5,_0x4e271e,_0x143d97);}:function(_0x5187b8,_0x3bdc29,_0x2e4dd2,_0x28948c){if(_0x28948c===undefined)_0x28948c=_0x2e4dd2;_0x5187b8[_0x28948c]=_0x3bdc29[_0x2e4dd2];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a99_0x463c3a(0x13a)]?function(_0x1e69e4,_0xacd0de){const _0x43b8e4=a99_0x463c3a;Object[_0x43b8e4(0x140)](_0x1e69e4,_0x43b8e4(0x134),{'enumerable':!![],'value':_0xacd0de});}:function(_0x2d9738,_0x342a80){const _0x181a18=a99_0x463c3a;_0x2d9738[_0x181a18(0x134)]=_0x342a80;}),__importStar=this&&this[a99_0x463c3a(0x146)]||function(_0x249362){const _0x5880f=a99_0x463c3a;if(_0x249362&&_0x249362[_0x5880f(0x153)])return _0x249362;var _0x402e95={};if(_0x249362!=null){for(var _0x305104 in _0x249362)if(_0x305104!==_0x5880f(0x134)&&Object[_0x5880f(0x128)][_0x5880f(0x167)][_0x5880f(0x13c)](_0x249362,_0x305104))__createBinding(_0x402e95,_0x249362,_0x305104);}return __setModuleDefault(_0x402e95,_0x249362),_0x402e95;},__importDefault=this&&this[a99_0x463c3a(0x165)]||function(_0x291f1d){const _0x5b2145=a99_0x463c3a;return _0x291f1d&&_0x291f1d[_0x5b2145(0x153)]?_0x291f1d:{'default':_0x291f1d};};function a99_0x4350(){const _0x5b04fd=['__createBinding','kill','successful','create','../job/enums/logger.enums','call','../job/classes/logger/logger-job-state','(((.+)+)+)+$','Job\x20Id\x20not\x20found.','defineProperty','search','createdDate','getJobDetails','getJobState','writeFile','__importStar','status','configurable','JOB_LOG_STATE_FILENAME','MaskingService','sortJobsIds','1107zAKNBx','JobStatus','2618cJCRNS','toString','catch','makeDir','77NHjqVP','__esModule','fs/promises','createMaskingJob','../../shared/utils/job.utils','utf-8','NotFoundError','apply','429cOIcBj','logErrorStartJob','../../shared/utils/fs.utils','getJobsIds','355665vdIQAR','isExistsPath','\x20not\x20found.','395970paLpBx','../../../core/errors/not-found.error','parse','60KcPvjT','__importDefault','JOB_LOG_DETAILS_FILENAME','hasOwnProperty','failed','stringify','2690740RLCLIY','maskingFolderPath','setJobError','getOwnPropertyDescriptor','writable','649476mgMaIy','join','prototype','getJobs','FsUtils','../constants','get','init','csv-parse/sync','13182848CDiJTe','getLog','2248836HdpnFH','LoggerJobState','dataPath','default','52hAnOya','generateJobId'];a99_0x4350=function(){return _0x5b04fd;};return a99_0x4350();}Object[a99_0x463c3a(0x140)](exports,a99_0x463c3a(0x153),{'value':!![]}),exports['MaskingService']=void 0x0;const path_1=__importStar(require('path')),fs_utils_1=require(a99_0x463c3a(0x15c)),promises_1=require(a99_0x463c3a(0x154)),logger_job_state_1=require(a99_0x463c3a(0x13d)),logger_enums_1=require(a99_0x463c3a(0x13b)),sync_1=require(a99_0x463c3a(0x12e)),utils_1=require('@flosum/utils'),not_found_error_1=require(a99_0x463c3a(0x162)),job_1=require('../../../constants/job'),job_utils_1=__importDefault(require(a99_0x463c3a(0x156))),constants_1=require(a99_0x463c3a(0x12b)),path_2=require('../../../configs/path');class MaskingService{static async[a99_0x463c3a(0x155)](_0xdfe25a){const _0x54de9e=a99_0x463c3a,_0x5401b1=job_utils_1[_0x54de9e(0x134)][_0x54de9e(0x136)](),_0x39bc65=(0x0,path_1[_0x54de9e(0x127)])(MaskingService['maskingFolderPath'],_0x5401b1);await(0x0,fs_utils_1[_0x54de9e(0x151)])(_0x39bc65),await(0x0,promises_1[_0x54de9e(0x145)])(_0x39bc65+'/'+job_1['MANIFEST_FILENAME'],JSON[_0x54de9e(0x169)]({'details':_0xdfe25a}));const _0x3ec22e=await new logger_job_state_1[(_0x54de9e(0x132))](_0x39bc65,_0x5401b1)[_0x54de9e(0x12d)]([]);await _0x3ec22e['kill']();const _0x18879d=path_1[_0x54de9e(0x134)]['join'](__dirname,job_1['JOB_PATH']);return job_utils_1['default']['runJob'](_0x18879d,{'jobStorePath':_0x39bc65,'jobId':_0x5401b1})[_0x54de9e(0x150)](_0x38d151=>this['logErrorStartJob'](_0x39bc65,_0x5401b1,_0x38d151)),{'jobId':_0x5401b1};}static async[a99_0x463c3a(0x129)](_0x394cb3,_0x2fd3a9){const _0x93c0a8=a99_0x463c3a,_0x57e88e=await job_utils_1[_0x93c0a8(0x134)][_0x93c0a8(0x15d)](MaskingService['maskingFolderPath']),_0x424048=await job_utils_1[_0x93c0a8(0x134)][_0x93c0a8(0x14b)](MaskingService[_0x93c0a8(0x16b)],_0x57e88e),_0x5d19a0=_0x424048['slice'](_0x2fd3a9,_0x2fd3a9+_0x394cb3),_0x408d26=[];for(const _0x401a6d of _0x5d19a0){const _0x28d315=await this[_0x93c0a8(0x144)](_0x401a6d,![]);_0x408d26['push'](_0x28d315);}return _0x408d26;}static async[a99_0x463c3a(0x144)](_0x40a546,_0x348ae0){const _0x1e70cd=a99_0x463c3a,_0x3c134d=await this[_0x1e70cd(0x130)](_0x40a546,job_1[_0x1e70cd(0x149)],constants_1['JOB_LOG_STATE_NAME']),_0x3645e0=JSON[_0x1e70cd(0x163)](_0x3c134d),_0x3a661d={'id':_0x3645e0['id'],'status':_0x3645e0[_0x1e70cd(0x147)],'createdDate':_0x3645e0[_0x1e70cd(0x142)],'completedDate':_0x3645e0['completedDate'],'successful':_0x3645e0[_0x1e70cd(0x139)],'failed':_0x3645e0[_0x1e70cd(0x168)]};return _0x348ae0?_0x3645e0:_0x3a661d;}static async[a99_0x463c3a(0x143)](_0x32a9ea){const _0x52fb04=a99_0x463c3a,_0x56c80c=await this[_0x52fb04(0x130)](_0x32a9ea,job_1[_0x52fb04(0x166)],constants_1['JOB_LOG_DETAILS_NAME']);return(0x0,sync_1[_0x52fb04(0x163)])(_0x56c80c,{'columns':!![]});}static async[a99_0x463c3a(0x130)](_0x4441ec,_0x513e57,_0x292322){const _0x7af32d=a99_0x463c3a,_0x5b5187=(0x0,path_1[_0x7af32d(0x127)])(MaskingService[_0x7af32d(0x16b)],_0x4441ec),_0x5cc23a=(0x0,path_1[_0x7af32d(0x127)])(_0x5b5187,_0x513e57);if(!await utils_1['FsUtils'][_0x7af32d(0x15f)](_0x5b5187))throw new not_found_error_1['NotFoundError'](_0x7af32d(0x13f));if(!await utils_1[_0x7af32d(0x12a)]['isExistsPath'](_0x5cc23a))throw new not_found_error_1[(_0x7af32d(0x158))](_0x292322+_0x7af32d(0x160));return(0x0,promises_1['readFile'])(_0x5cc23a,{'encoding':_0x7af32d(0x157)});}static async[a99_0x463c3a(0x15b)](_0x5f2cd8,_0x51ab13,_0x4988b3){const _0x50a513=a99_0x463c3a,_0x195238=await new logger_job_state_1[(_0x50a513(0x132))](_0x5f2cd8,_0x51ab13)['init']([]);_0x195238['setJobStatus'](logger_enums_1[_0x50a513(0x14d)]['FAILED']),_0x195238[_0x50a513(0x16c)](_0x4988b3['message']),await _0x195238[_0x50a513(0x138)]();}}exports[a99_0x463c3a(0x14a)]=MaskingService,MaskingService[a99_0x463c3a(0x16b)]=path_1['default'][a99_0x463c3a(0x127)](path_2[a99_0x463c3a(0x133)],constants_1['DATA_MASKING_FOLDER_NAME']);