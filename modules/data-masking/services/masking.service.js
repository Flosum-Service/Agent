const a81_0x5676da=a81_0x20bd;(function(_0x3705ef,_0x4da64b){const _0x4cd5e6=a81_0x20bd,_0xdcadff=_0x3705ef();while(!![]){try{const _0x3f6997=-parseInt(_0x4cd5e6(0x118))/0x1+parseInt(_0x4cd5e6(0x10a))/0x2*(-parseInt(_0x4cd5e6(0x112))/0x3)+-parseInt(_0x4cd5e6(0x104))/0x4*(parseInt(_0x4cd5e6(0x135))/0x5)+parseInt(_0x4cd5e6(0x12e))/0x6*(-parseInt(_0x4cd5e6(0x10b))/0x7)+parseInt(_0x4cd5e6(0xfd))/0x8+-parseInt(_0x4cd5e6(0x138))/0x9*(-parseInt(_0x4cd5e6(0x11b))/0xa)+parseInt(_0x4cd5e6(0x108))/0xb;if(_0x3f6997===_0x4da64b)break;else _0xdcadff['push'](_0xdcadff['shift']());}catch(_0x12c9fe){_0xdcadff['push'](_0xdcadff['shift']());}}}(a81_0x4b27,0xf386e));const a81_0xf422b4=(function(){let _0x549d1d=!![];return function(_0x1a8571,_0x39b81d){const _0x211d1e=_0x549d1d?function(){const _0x3f07df=a81_0x20bd;if(_0x39b81d){const _0x32797a=_0x39b81d[_0x3f07df(0x12f)](_0x1a8571,arguments);return _0x39b81d=null,_0x32797a;}}:function(){};return _0x549d1d=![],_0x211d1e;};}()),a81_0x2928c9=a81_0xf422b4(this,function(){const _0x296d9b=a81_0x20bd;return a81_0x2928c9[_0x296d9b(0xfe)]()['search'](_0x296d9b(0x119))[_0x296d9b(0xfe)]()[_0x296d9b(0x105)](a81_0x2928c9)[_0x296d9b(0x12d)]('(((.+)+)+)+$');});a81_0x2928c9();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a81_0x5676da(0x130)]?function(_0x1db897,_0x3643b9,_0x19481e,_0x5d9f6a){const _0xf8f42e=a81_0x5676da;if(_0x5d9f6a===undefined)_0x5d9f6a=_0x19481e;var _0x5a3465=Object[_0xf8f42e(0x136)](_0x3643b9,_0x19481e);(!_0x5a3465||(_0xf8f42e(0x126)in _0x5a3465?!_0x3643b9[_0xf8f42e(0x114)]:_0x5a3465[_0xf8f42e(0xfa)]||_0x5a3465[_0xf8f42e(0x128)]))&&(_0x5a3465={'enumerable':!![],'get':function(){return _0x3643b9[_0x19481e];}}),Object['defineProperty'](_0x1db897,_0x5d9f6a,_0x5a3465);}:function(_0x4100b7,_0x2fab9a,_0xf6a017,_0x2f4cdf){if(_0x2f4cdf===undefined)_0x2f4cdf=_0xf6a017;_0x4100b7[_0x2f4cdf]=_0x2fab9a[_0xf6a017];}),__setModuleDefault=this&&this[a81_0x5676da(0xf7)]||(Object[a81_0x5676da(0x130)]?function(_0x3afab5,_0x2e8902){const _0x35ec2d=a81_0x5676da;Object[_0x35ec2d(0x120)](_0x3afab5,_0x35ec2d(0x11f),{'enumerable':!![],'value':_0x2e8902});}:function(_0x398d24,_0x2e5f9e){_0x398d24['default']=_0x2e5f9e;}),__importStar=this&&this[a81_0x5676da(0x121)]||function(_0x5ca0a7){const _0x3c8b0d=a81_0x5676da;if(_0x5ca0a7&&_0x5ca0a7[_0x3c8b0d(0x114)])return _0x5ca0a7;var _0x38952d={};if(_0x5ca0a7!=null){for(var _0x257e24 in _0x5ca0a7)if(_0x257e24!==_0x3c8b0d(0x11f)&&Object['prototype']['hasOwnProperty'][_0x3c8b0d(0xfb)](_0x5ca0a7,_0x257e24))__createBinding(_0x38952d,_0x5ca0a7,_0x257e24);}return __setModuleDefault(_0x38952d,_0x5ca0a7),_0x38952d;},__importDefault=this&&this[a81_0x5676da(0x101)]||function(_0x7aa001){const _0x5b0904=a81_0x5676da;return _0x7aa001&&_0x7aa001[_0x5b0904(0x114)]?_0x7aa001:{'default':_0x7aa001};};Object[a81_0x5676da(0x120)](exports,a81_0x5676da(0x114),{'value':!![]}),exports[a81_0x5676da(0xf5)]=void 0x0;function a81_0x4b27(){const _0x391e78=['createMaskingJob','3529419hxfmJa','failed','__esModule','kill','push','isExistsPath','638174qmAlTp','(((.+)+)+)+$','\x20not\x20found.','13691830opMRxH','getJobState','../../../configs/path','FAILED','default','defineProperty','__importStar','NotFoundError','catch','../constants','path','get','generateJobId','configurable','parse','status','makeDir','runJob','search','6oOTGfR','apply','create','stringify','../../shared/utils/job.utils','join','slice','5MjPiKS','getOwnPropertyDescriptor','fs/promises','9feGODc','setJobStatus','createdDate','../../shared/utils/fs.utils','readFile','logErrorStartJob','MaskingService','csv-parse/sync','__setModuleDefault','JOB_LOG_STATE_NAME','init','writable','call','LoggerJobState','15192024baobTV','toString','maskingFolderPath','utf-8','__importDefault','DATA_MASKING_FOLDER_NAME','FsUtils','3404588dEeJQD','constructor','Job\x20Id\x20not\x20found.','JobStatus','13937253ybQJbf','writeFile','2CKDdlD','6103503iKFlQa','JOB_LOG_STATE_FILENAME','../../../constants/job','completedDate','MANIFEST_FILENAME','getLog'];a81_0x4b27=function(){return _0x391e78;};return a81_0x4b27();}const path_1=__importStar(require(a81_0x5676da(0x125))),fs_utils_1=require(a81_0x5676da(0xf2)),promises_1=require(a81_0x5676da(0x137)),logger_job_state_1=require('../job/classes/logger/logger-job-state'),logger_enums_1=require('../job/enums/logger.enums'),sync_1=require(a81_0x5676da(0xf6)),utils_1=require('@flosum/utils'),not_found_error_1=require('../../../core/errors/not-found.error'),job_1=require(a81_0x5676da(0x10d)),job_utils_1=__importDefault(require(a81_0x5676da(0x132))),constants_1=require(a81_0x5676da(0x124)),path_2=require(a81_0x5676da(0x11d));function a81_0x20bd(_0x38ff63,_0x237fb8){const _0x5b4594=a81_0x4b27();return a81_0x20bd=function(_0x2928c9,_0xf422b4){_0x2928c9=_0x2928c9-0xf1;let _0x4b277a=_0x5b4594[_0x2928c9];return _0x4b277a;},a81_0x20bd(_0x38ff63,_0x237fb8);}class MaskingService{static async[a81_0x5676da(0x111)](_0xd1b8b9){const _0x33814f=a81_0x5676da,_0x35cf13=job_utils_1[_0x33814f(0x11f)][_0x33814f(0x127)](),_0x51fd8c=(0x0,path_1[_0x33814f(0x133)])(MaskingService[_0x33814f(0xff)],_0x35cf13);await(0x0,fs_utils_1[_0x33814f(0x12b)])(_0x51fd8c),await(0x0,promises_1[_0x33814f(0x109)])(_0x51fd8c+'/'+job_1[_0x33814f(0x10f)],JSON[_0x33814f(0x131)]({'details':_0xd1b8b9}));const _0x18b7b4=await new logger_job_state_1['LoggerJobState'](_0x51fd8c,_0x35cf13)['init']([]);await _0x18b7b4[_0x33814f(0x115)]();const _0x732d95=path_1[_0x33814f(0x11f)][_0x33814f(0x133)](__dirname,job_1['JOB_PATH']);return job_utils_1[_0x33814f(0x11f)][_0x33814f(0x12c)](_0x732d95,{'jobStorePath':_0x51fd8c,'jobId':_0x35cf13})[_0x33814f(0x123)](_0x1a4770=>this[_0x33814f(0xf4)](_0x51fd8c,_0x35cf13,_0x1a4770)),{'jobId':_0x35cf13};}static async['getJobs'](_0xb309a4,_0x4c8586){const _0x2fcaec=a81_0x5676da,_0x2b6214=await job_utils_1[_0x2fcaec(0x11f)]['getJobsIds'](MaskingService[_0x2fcaec(0xff)]),_0x160492=await job_utils_1[_0x2fcaec(0x11f)]['sortJobsIds'](MaskingService[_0x2fcaec(0xff)],_0x2b6214),_0x270743=_0x160492[_0x2fcaec(0x134)](_0x4c8586,_0x4c8586+_0xb309a4),_0x290c75=[];for(const _0x3045de of _0x270743){const _0x56b57d=await this[_0x2fcaec(0x11c)](_0x3045de,![]);_0x290c75[_0x2fcaec(0x116)](_0x56b57d);}return _0x290c75;}static async[a81_0x5676da(0x11c)](_0x1203ee,_0x75e7b9){const _0x30cefd=a81_0x5676da,_0x38bd65=await this[_0x30cefd(0x110)](_0x1203ee,job_1[_0x30cefd(0x10c)],constants_1[_0x30cefd(0xf8)]),_0x37e212=JSON[_0x30cefd(0x129)](_0x38bd65),_0x264e12={'id':_0x37e212['id'],'status':_0x37e212[_0x30cefd(0x12a)],'createdDate':_0x37e212[_0x30cefd(0xf1)],'completedDate':_0x37e212[_0x30cefd(0x10e)],'successful':_0x37e212['successful'],'failed':_0x37e212[_0x30cefd(0x113)]};return _0x75e7b9?_0x37e212:_0x264e12;}static async['getJobDetails'](_0x1a0c3b){const _0x50f10f=a81_0x5676da,_0x1409d4=await this[_0x50f10f(0x110)](_0x1a0c3b,job_1['JOB_LOG_DETAILS_FILENAME'],constants_1['JOB_LOG_DETAILS_NAME']);return(0x0,sync_1[_0x50f10f(0x129)])(_0x1409d4,{'columns':!![]});}static async[a81_0x5676da(0x110)](_0xb90b37,_0x29ad22,_0x461210){const _0x3d2c71=a81_0x5676da,_0x84d09a=(0x0,path_1['join'])(MaskingService['maskingFolderPath'],_0xb90b37),_0x432e07=(0x0,path_1[_0x3d2c71(0x133)])(_0x84d09a,_0x29ad22);if(!await utils_1[_0x3d2c71(0x103)]['isExistsPath'](_0x84d09a))throw new not_found_error_1[(_0x3d2c71(0x122))](_0x3d2c71(0x106));if(!await utils_1[_0x3d2c71(0x103)][_0x3d2c71(0x117)](_0x432e07))throw new not_found_error_1['NotFoundError'](_0x461210+_0x3d2c71(0x11a));return(0x0,promises_1[_0x3d2c71(0xf3)])(_0x432e07,{'encoding':_0x3d2c71(0x100)});}static async[a81_0x5676da(0xf4)](_0x39fce2,_0x27109b,_0x4ac26d){const _0x4ea0fb=a81_0x5676da,_0x22818c=await new logger_job_state_1[(_0x4ea0fb(0xfc))](_0x39fce2,_0x27109b)[_0x4ea0fb(0xf9)]([]);_0x22818c[_0x4ea0fb(0x139)](logger_enums_1[_0x4ea0fb(0x107)][_0x4ea0fb(0x11e)]),_0x22818c['setJobError'](_0x4ac26d['message']),await _0x22818c[_0x4ea0fb(0x115)]();}}exports[a81_0x5676da(0xf5)]=MaskingService,MaskingService['maskingFolderPath']=path_1[a81_0x5676da(0x11f)][a81_0x5676da(0x133)](path_2['dataPath'],constants_1[a81_0x5676da(0x102)]);