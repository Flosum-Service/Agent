const a96_0x3df554=a96_0x156e;(function(_0x465538,_0x360c62){const _0x460df8=a96_0x156e,_0x2cab80=_0x465538();while(!![]){try{const _0x116930=parseInt(_0x460df8(0x146))/0x1+-parseInt(_0x460df8(0x174))/0x2+parseInt(_0x460df8(0x160))/0x3+parseInt(_0x460df8(0x161))/0x4+-parseInt(_0x460df8(0x181))/0x5+parseInt(_0x460df8(0x180))/0x6+-parseInt(_0x460df8(0x171))/0x7;if(_0x116930===_0x360c62)break;else _0x2cab80['push'](_0x2cab80['shift']());}catch(_0x190500){_0x2cab80['push'](_0x2cab80['shift']());}}}(a96_0x26d1,0xc23a1));const a96_0x13b6b0=(function(){let _0x45bec4=!![];return function(_0x2be4e9,_0x4af15a){const _0x476050=_0x45bec4?function(){const _0x2c125d=a96_0x156e;if(_0x4af15a){const _0x34a8d9=_0x4af15a[_0x2c125d(0x187)](_0x2be4e9,arguments);return _0x4af15a=null,_0x34a8d9;}}:function(){};return _0x45bec4=![],_0x476050;};}()),a96_0x8621d=a96_0x13b6b0(this,function(){const _0x2aad76=a96_0x156e;return a96_0x8621d[_0x2aad76(0x15c)]()['search'](_0x2aad76(0x189))[_0x2aad76(0x15c)]()[_0x2aad76(0x17a)](a96_0x8621d)['search'](_0x2aad76(0x189));});a96_0x8621d();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a96_0x3df554(0x155)]?function(_0x1ad86e,_0x12074e,_0x2271da,_0x2e6e0b){const _0x3f40d5=a96_0x3df554;if(_0x2e6e0b===undefined)_0x2e6e0b=_0x2271da;var _0x1c7dd8=Object[_0x3f40d5(0x184)](_0x12074e,_0x2271da);(!_0x1c7dd8||(_0x3f40d5(0x179)in _0x1c7dd8?!_0x12074e[_0x3f40d5(0x186)]:_0x1c7dd8[_0x3f40d5(0x16b)]||_0x1c7dd8[_0x3f40d5(0x15f)]))&&(_0x1c7dd8={'enumerable':!![],'get':function(){return _0x12074e[_0x2271da];}}),Object[_0x3f40d5(0x16f)](_0x1ad86e,_0x2e6e0b,_0x1c7dd8);}:function(_0x21948f,_0xb62876,_0x5dd430,_0x5d4538){if(_0x5d4538===undefined)_0x5d4538=_0x5dd430;_0x21948f[_0x5d4538]=_0xb62876[_0x5dd430];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a96_0x3df554(0x155)]?function(_0x3cdf0f,_0x218166){const _0x134ff8=a96_0x3df554;Object[_0x134ff8(0x16f)](_0x3cdf0f,_0x134ff8(0x177),{'enumerable':!![],'value':_0x218166});}:function(_0x4e5a74,_0x4c7ed0){_0x4e5a74['default']=_0x4c7ed0;}),__importStar=this&&this[a96_0x3df554(0x15d)]||function(_0x9a3646){const _0x32ce29=a96_0x3df554;if(_0x9a3646&&_0x9a3646[_0x32ce29(0x186)])return _0x9a3646;var _0x2b4832={};if(_0x9a3646!=null){for(var _0x5c70b5 in _0x9a3646)if(_0x5c70b5!=='default'&&Object['prototype'][_0x32ce29(0x173)][_0x32ce29(0x16a)](_0x9a3646,_0x5c70b5))__createBinding(_0x2b4832,_0x9a3646,_0x5c70b5);}return __setModuleDefault(_0x2b4832,_0x9a3646),_0x2b4832;},__importDefault=this&&this[a96_0x3df554(0x17e)]||function(_0xe0ba3e){const _0x3b1d23=a96_0x3df554;return _0xe0ba3e&&_0xe0ba3e[_0x3b1d23(0x186)]?_0xe0ba3e:{'default':_0xe0ba3e};};function a96_0x156e(_0x4cd3c9,_0x11fcf9){const _0x1a13e2=a96_0x26d1();return a96_0x156e=function(_0x8621d,_0x13b6b0){_0x8621d=_0x8621d-0x146;let _0x26d172=_0x1a13e2[_0x8621d];return _0x26d172;},a96_0x156e(_0x4cd3c9,_0x11fcf9);}Object[a96_0x3df554(0x16f)](exports,a96_0x3df554(0x186),{'value':!![]}),exports['MaskingService']=void 0x0;const path_1=__importStar(require(a96_0x3df554(0x17f))),fs_utils_1=require(a96_0x3df554(0x156)),promises_1=require(a96_0x3df554(0x169)),logger_job_state_1=require(a96_0x3df554(0x14b)),logger_enums_1=require('../job/enums/logger.enums'),sync_1=require('csv-parse/sync'),utils_1=require(a96_0x3df554(0x15b)),not_found_error_1=require(a96_0x3df554(0x170)),job_1=require('../../../constants/job'),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),constants_1=require('../constants'),path_2=require(a96_0x3df554(0x148));function a96_0x26d1(){const _0x438b48=['createMaskingJob','init','successful','\x20not\x20found.','completedDate','fs/promises','call','writable','FAILED','Job\x20Id\x20not\x20found.','isExistsPath','defineProperty','../../../core/errors/not-found.error','11796148vtLvod','status','hasOwnProperty','713130SmvhYz','getJobs','NotFoundError','default','failed','get','constructor','JOB_LOG_STATE_NAME','slice','runJob','__importDefault','path','5544864ERdlGH','248295AfkhTB','JOB_LOG_DETAILS_FILENAME','getJobsIds','getOwnPropertyDescriptor','stringify','__esModule','apply','JOB_LOG_DETAILS_NAME','(((.+)+)+)+$','102859ZrIgVJ','readFile','../../../configs/path','kill','LoggerJobState','../job/classes/logger/logger-job-state','utf-8','maskingFolderPath','getLog','join','push','sortJobsIds','logErrorStartJob','setJobStatus','FsUtils','create','../../shared/utils/fs.utils','dataPath','createdDate','JobStatus','JOB_PATH','@flosum/utils','toString','__importStar','message','configurable','1017696joGijF','6082824LukAyL','parse','catch'];a96_0x26d1=function(){return _0x438b48;};return a96_0x26d1();}class MaskingService{static async[a96_0x3df554(0x164)](_0x461b6e){const _0x35bf00=a96_0x3df554,_0x1575e6=job_utils_1['default']['generateJobId'](),_0x2da8db=(0x0,path_1['join'])(MaskingService[_0x35bf00(0x14d)],_0x1575e6);await(0x0,fs_utils_1['makeDir'])(_0x2da8db),await(0x0,promises_1['writeFile'])(_0x2da8db+'/'+job_1['MANIFEST_FILENAME'],JSON[_0x35bf00(0x185)]({'details':_0x461b6e}));const _0x2e506b=await new logger_job_state_1[(_0x35bf00(0x14a))](_0x2da8db,_0x1575e6)['init']([]);await _0x2e506b[_0x35bf00(0x149)]();const _0x4d248b=path_1[_0x35bf00(0x177)][_0x35bf00(0x14f)](__dirname,job_1[_0x35bf00(0x15a)]);return job_utils_1[_0x35bf00(0x177)][_0x35bf00(0x17d)](_0x4d248b,{'jobStorePath':_0x2da8db,'jobId':_0x1575e6})[_0x35bf00(0x163)](_0x30c73b=>this[_0x35bf00(0x152)](_0x2da8db,_0x1575e6,_0x30c73b)),{'jobId':_0x1575e6};}static async[a96_0x3df554(0x175)](_0x302cba,_0xf976af){const _0x26e6aa=a96_0x3df554,_0x3b0d87=await job_utils_1['default'][_0x26e6aa(0x183)](MaskingService[_0x26e6aa(0x14d)]),_0x573db2=await job_utils_1[_0x26e6aa(0x177)][_0x26e6aa(0x151)](MaskingService[_0x26e6aa(0x14d)],_0x3b0d87),_0x1d0da7=_0x573db2[_0x26e6aa(0x17c)](_0xf976af,_0xf976af+_0x302cba),_0x2ea0b3=[];for(const _0xedd8aa of _0x1d0da7){const _0x1484a2=await this['getJobState'](_0xedd8aa,![]);_0x2ea0b3[_0x26e6aa(0x150)](_0x1484a2);}return _0x2ea0b3;}static async['getJobState'](_0x20d81f,_0x4c56a9){const _0x5a569b=a96_0x3df554,_0x24ff2d=await this['getLog'](_0x20d81f,job_1['JOB_LOG_STATE_FILENAME'],constants_1[_0x5a569b(0x17b)]),_0x1a5e47=JSON[_0x5a569b(0x162)](_0x24ff2d),_0x56e493={'id':_0x1a5e47['id'],'status':_0x1a5e47[_0x5a569b(0x172)],'createdDate':_0x1a5e47[_0x5a569b(0x158)],'completedDate':_0x1a5e47[_0x5a569b(0x168)],'successful':_0x1a5e47[_0x5a569b(0x166)],'failed':_0x1a5e47[_0x5a569b(0x178)]};return _0x4c56a9?_0x1a5e47:_0x56e493;}static async['getJobDetails'](_0x20cf34){const _0xeb62d5=a96_0x3df554,_0x4d2f7c=await this[_0xeb62d5(0x14e)](_0x20cf34,job_1[_0xeb62d5(0x182)],constants_1[_0xeb62d5(0x188)]);return(0x0,sync_1[_0xeb62d5(0x162)])(_0x4d2f7c,{'columns':!![]});}static async[a96_0x3df554(0x14e)](_0x424459,_0x37f0d7,_0x2cf726){const _0x279414=a96_0x3df554,_0x2fd645=(0x0,path_1[_0x279414(0x14f)])(MaskingService[_0x279414(0x14d)],_0x424459),_0x5599c5=(0x0,path_1[_0x279414(0x14f)])(_0x2fd645,_0x37f0d7);if(!await utils_1[_0x279414(0x154)][_0x279414(0x16e)](_0x2fd645))throw new not_found_error_1[(_0x279414(0x176))](_0x279414(0x16d));if(!await utils_1[_0x279414(0x154)]['isExistsPath'](_0x5599c5))throw new not_found_error_1[(_0x279414(0x176))](_0x2cf726+_0x279414(0x167));return(0x0,promises_1[_0x279414(0x147)])(_0x5599c5,{'encoding':_0x279414(0x14c)});}static async[a96_0x3df554(0x152)](_0x452380,_0x37a1f1,_0x5b481e){const _0x3c1dd6=a96_0x3df554,_0x43c590=await new logger_job_state_1[(_0x3c1dd6(0x14a))](_0x452380,_0x37a1f1)[_0x3c1dd6(0x165)]([]);_0x43c590[_0x3c1dd6(0x153)](logger_enums_1[_0x3c1dd6(0x159)][_0x3c1dd6(0x16c)]),_0x43c590['setJobError'](_0x5b481e[_0x3c1dd6(0x15e)]),await _0x43c590[_0x3c1dd6(0x149)]();}}exports['MaskingService']=MaskingService,MaskingService[a96_0x3df554(0x14d)]=path_1[a96_0x3df554(0x177)]['join'](path_2[a96_0x3df554(0x157)],constants_1['DATA_MASKING_FOLDER_NAME']);