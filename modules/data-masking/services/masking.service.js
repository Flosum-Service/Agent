const a81_0x4702f9=a81_0x3dd0;(function(_0x2e862a,_0x29fd78){const _0x30c3b5=a81_0x3dd0,_0x3ca698=_0x2e862a();while(!![]){try{const _0x476d84=parseInt(_0x30c3b5(0x181))/0x1+parseInt(_0x30c3b5(0x18b))/0x2*(parseInt(_0x30c3b5(0x15e))/0x3)+parseInt(_0x30c3b5(0x160))/0x4+parseInt(_0x30c3b5(0x17f))/0x5*(parseInt(_0x30c3b5(0x167))/0x6)+parseInt(_0x30c3b5(0x199))/0x7+parseInt(_0x30c3b5(0x18d))/0x8+-parseInt(_0x30c3b5(0x16e))/0x9;if(_0x476d84===_0x29fd78)break;else _0x3ca698['push'](_0x3ca698['shift']());}catch(_0x32a417){_0x3ca698['push'](_0x3ca698['shift']());}}}(a81_0x2ce9,0x5d085));const a81_0xc1bcb0=(function(){let _0x5389f5=!![];return function(_0x4acd20,_0x3fc14c){const _0x397a64=_0x5389f5?function(){const _0x24b728=a81_0x3dd0;if(_0x3fc14c){const _0x86815c=_0x3fc14c[_0x24b728(0x161)](_0x4acd20,arguments);return _0x3fc14c=null,_0x86815c;}}:function(){};return _0x5389f5=![],_0x397a64;};}()),a81_0x1dba57=a81_0xc1bcb0(this,function(){const _0x244944=a81_0x3dd0;return a81_0x1dba57[_0x244944(0x165)]()['search']('(((.+)+)+)+$')['toString']()[_0x244944(0x16a)](a81_0x1dba57)[_0x244944(0x17a)](_0x244944(0x183));});function a81_0x3dd0(_0x30b002,_0x3ffa34){const _0x21040e=a81_0x2ce9();return a81_0x3dd0=function(_0x1dba57,_0xc1bcb0){_0x1dba57=_0x1dba57-0x155;let _0x2ce924=_0x21040e[_0x1dba57];return _0x2ce924;},a81_0x3dd0(_0x30b002,_0x3ffa34);}a81_0x1dba57();'use strict';var __createBinding=this&&this[a81_0x4702f9(0x191)]||(Object['create']?function(_0x4b7f47,_0x3ab940,_0x1aa69d,_0x27a437){const _0x4f6f0a=a81_0x4702f9;if(_0x27a437===undefined)_0x27a437=_0x1aa69d;var _0x150c9f=Object[_0x4f6f0a(0x17c)](_0x3ab940,_0x1aa69d);(!_0x150c9f||(_0x4f6f0a(0x168)in _0x150c9f?!_0x3ab940[_0x4f6f0a(0x19a)]:_0x150c9f[_0x4f6f0a(0x187)]||_0x150c9f['configurable']))&&(_0x150c9f={'enumerable':!![],'get':function(){return _0x3ab940[_0x1aa69d];}}),Object[_0x4f6f0a(0x15f)](_0x4b7f47,_0x27a437,_0x150c9f);}:function(_0x4d146c,_0x504182,_0x1540d9,_0x143931){if(_0x143931===undefined)_0x143931=_0x1540d9;_0x4d146c[_0x143931]=_0x504182[_0x1540d9];}),__setModuleDefault=this&&this[a81_0x4702f9(0x193)]||(Object[a81_0x4702f9(0x188)]?function(_0x5c71fa,_0x3102c0){const _0x170253=a81_0x4702f9;Object['defineProperty'](_0x5c71fa,_0x170253(0x174),{'enumerable':!![],'value':_0x3102c0});}:function(_0x138fae,_0x30ba6e){const _0x1e25e5=a81_0x4702f9;_0x138fae[_0x1e25e5(0x174)]=_0x30ba6e;}),__importStar=this&&this['__importStar']||function(_0x1b6e4a){const _0x268e75=a81_0x4702f9;if(_0x1b6e4a&&_0x1b6e4a[_0x268e75(0x19a)])return _0x1b6e4a;var _0x47fed1={};if(_0x1b6e4a!=null){for(var _0x52af62 in _0x1b6e4a)if(_0x52af62!==_0x268e75(0x174)&&Object[_0x268e75(0x166)][_0x268e75(0x196)][_0x268e75(0x169)](_0x1b6e4a,_0x52af62))__createBinding(_0x47fed1,_0x1b6e4a,_0x52af62);}return __setModuleDefault(_0x47fed1,_0x1b6e4a),_0x47fed1;},__importDefault=this&&this[a81_0x4702f9(0x17e)]||function(_0x5a611d){const _0x104ae9=a81_0x4702f9;return _0x5a611d&&_0x5a611d[_0x104ae9(0x19a)]?_0x5a611d:{'default':_0x5a611d};};Object[a81_0x4702f9(0x15f)](exports,a81_0x4702f9(0x19a),{'value':!![]}),exports[a81_0x4702f9(0x186)]=void 0x0;function a81_0x2ce9(){const _0x2bc873=['JOB_LOG_STATE_NAME','push','join','default','../../../core/errors/not-found.error','generateJobId','parse','catch','getJobDetails','search','successful','getOwnPropertyDescriptor','runJob','__importDefault','35RsNsDl','JOB_PATH','498645fQkdTQ','failed','(((.+)+)+)+$','../../../constants/job','NotFoundError','MaskingService','writable','create','setJobError','FsUtils','2DQRsRb','csv-parse/sync','4682456dCkoMH','createdDate','kill','../constants','__createBinding','getJobsIds','__setModuleDefault','Job\x20Id\x20not\x20found.','\x20not\x20found.','hasOwnProperty','getLog','FAILED','3098186NnAQDa','__esModule','getJobState','message','completedDate','maskingFolderPath','getJobs','../job/enums/logger.enums','MANIFEST_FILENAME','isExistsPath','DATA_MASKING_FOLDER_NAME','JOB_LOG_DETAILS_FILENAME','1519167BrxOFN','defineProperty','2666288PbJcSl','apply','../../shared/utils/fs.utils','init','logErrorStartJob','toString','prototype','236598JfdMma','get','call','constructor','writeFile','sortJobsIds','JOB_LOG_STATE_FILENAME','23350329LuptAX','path','stringify'];a81_0x2ce9=function(){return _0x2bc873;};return a81_0x2ce9();}const path_1=__importStar(require(a81_0x4702f9(0x16f))),fs_utils_1=require(a81_0x4702f9(0x162)),promises_1=require('fs/promises'),logger_job_state_1=require('../job/classes/logger/logger-job-state'),logger_enums_1=require(a81_0x4702f9(0x159)),sync_1=require(a81_0x4702f9(0x18c)),utils_1=require('@flosum/utils'),not_found_error_1=require(a81_0x4702f9(0x175)),job_1=require(a81_0x4702f9(0x184)),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),constants_1=require(a81_0x4702f9(0x190)),path_2=require('../../../configs/path');class MaskingService{static async['createMaskingJob'](_0x4b5203){const _0xb789e3=a81_0x4702f9,_0x41efb8=job_utils_1[_0xb789e3(0x174)][_0xb789e3(0x176)](),_0x30e2a2=(0x0,path_1['join'])(MaskingService[_0xb789e3(0x157)],_0x41efb8);await(0x0,fs_utils_1['makeDir'])(_0x30e2a2),await(0x0,promises_1[_0xb789e3(0x16b)])(_0x30e2a2+'/'+job_1[_0xb789e3(0x15a)],JSON[_0xb789e3(0x170)]({'details':_0x4b5203}));const _0x1a8aac=await new logger_job_state_1['LoggerJobState'](_0x30e2a2,_0x41efb8)[_0xb789e3(0x163)]([]);await _0x1a8aac['kill']();const _0x4bedb4=path_1[_0xb789e3(0x174)][_0xb789e3(0x173)](__dirname,job_1[_0xb789e3(0x180)]);return job_utils_1['default'][_0xb789e3(0x17d)](_0x4bedb4,{'jobStorePath':_0x30e2a2,'jobId':_0x41efb8})[_0xb789e3(0x178)](_0x202cb8=>this[_0xb789e3(0x164)](_0x30e2a2,_0x41efb8,_0x202cb8)),{'jobId':_0x41efb8};}static async[a81_0x4702f9(0x158)](_0x2a28df,_0xa0229){const _0x18c6c3=a81_0x4702f9,_0x2762c2=await job_utils_1[_0x18c6c3(0x174)][_0x18c6c3(0x192)](MaskingService['maskingFolderPath']),_0x3e2db9=await job_utils_1[_0x18c6c3(0x174)][_0x18c6c3(0x16c)](MaskingService[_0x18c6c3(0x157)],_0x2762c2),_0x3be967=_0x3e2db9['slice'](_0xa0229,_0xa0229+_0x2a28df),_0x327be4=[];for(const _0x2981b8 of _0x3be967){const _0x382283=await this[_0x18c6c3(0x19b)](_0x2981b8,![]);_0x327be4[_0x18c6c3(0x172)](_0x382283);}return _0x327be4;}static async[a81_0x4702f9(0x19b)](_0x31e7c2,_0x3cf1d5){const _0x417dee=a81_0x4702f9,_0x538552=await this[_0x417dee(0x197)](_0x31e7c2,job_1[_0x417dee(0x16d)],constants_1[_0x417dee(0x171)]),_0x49e9e5=JSON[_0x417dee(0x177)](_0x538552),_0x6c2ced={'id':_0x49e9e5['id'],'status':_0x49e9e5['status'],'createdDate':_0x49e9e5[_0x417dee(0x18e)],'completedDate':_0x49e9e5[_0x417dee(0x156)],'successful':_0x49e9e5[_0x417dee(0x17b)],'failed':_0x49e9e5[_0x417dee(0x182)]};return _0x3cf1d5?_0x49e9e5:_0x6c2ced;}static async[a81_0x4702f9(0x179)](_0x372aff){const _0x2a6bb1=a81_0x4702f9,_0xbab771=await this[_0x2a6bb1(0x197)](_0x372aff,job_1[_0x2a6bb1(0x15d)],constants_1['JOB_LOG_DETAILS_NAME']);return(0x0,sync_1['parse'])(_0xbab771,{'columns':!![]});}static async[a81_0x4702f9(0x197)](_0x491249,_0x2fb60f,_0x502460){const _0x14b8c9=a81_0x4702f9,_0xc8698e=(0x0,path_1['join'])(MaskingService['maskingFolderPath'],_0x491249),_0x30a104=(0x0,path_1[_0x14b8c9(0x173)])(_0xc8698e,_0x2fb60f);if(!await utils_1[_0x14b8c9(0x18a)][_0x14b8c9(0x15b)](_0xc8698e))throw new not_found_error_1[(_0x14b8c9(0x185))](_0x14b8c9(0x194));if(!await utils_1[_0x14b8c9(0x18a)][_0x14b8c9(0x15b)](_0x30a104))throw new not_found_error_1[(_0x14b8c9(0x185))](_0x502460+_0x14b8c9(0x195));return(0x0,promises_1['readFile'])(_0x30a104,{'encoding':'utf-8'});}static async[a81_0x4702f9(0x164)](_0x238324,_0x229cc9,_0x598cf5){const _0x18742f=a81_0x4702f9,_0xb3794c=await new logger_job_state_1['LoggerJobState'](_0x238324,_0x229cc9)[_0x18742f(0x163)]([]);_0xb3794c['setJobStatus'](logger_enums_1['JobStatus'][_0x18742f(0x198)]),_0xb3794c[_0x18742f(0x189)](_0x598cf5[_0x18742f(0x155)]),await _0xb3794c[_0x18742f(0x18f)]();}}exports['MaskingService']=MaskingService,MaskingService['maskingFolderPath']=path_1[a81_0x4702f9(0x174)][a81_0x4702f9(0x173)](path_2['dataPath'],constants_1[a81_0x4702f9(0x15c)]);