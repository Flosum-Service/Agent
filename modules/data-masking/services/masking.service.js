const a97_0x44710e=a97_0x1a35;function a97_0x5899(){const _0x5d57da=['3033gjUURw','createdDate','message','path','push','init','kill','parse','isExistsPath','332922bLvbob','NotFoundError','8638080aZBPQO','generateJobId','__importStar','JOB_LOG_DETAILS_FILENAME','hasOwnProperty','failed','makeDir','getJobDetails','utf-8','12uWtSUv','constructor','FAILED','create','\x20not\x20found.','successful','../../../constants/job','MaskingService','3971sJXAuw','stringify','dataPath','defineProperty','../job/enums/logger.enums','3080MlaQRJ','prototype','logErrorStartJob','(((.+)+)+)+$','getLog','__importDefault','@flosum/utils','DATA_MASKING_FOLDER_NAME','JOB_PATH','getJobs','../../../configs/path','JOB_LOG_STATE_FILENAME','JOB_LOG_STATE_NAME','fs/promises','JobStatus','__createBinding','join','createMaskingJob','maskingFolderPath','../job/classes/logger/logger-job-state','writeFile','apply','FsUtils','catch','default','LoggerJobState','26290rShfIp','toString','JOB_LOG_DETAILS_NAME','56518kkwTth','../constants','__esModule','27VtcYTQ','3320520uowczC','Job\x20Id\x20not\x20found.','get','../../shared/utils/job.utils','8068858YgHKrX','getJobState','runJob','search','__setModuleDefault'];a97_0x5899=function(){return _0x5d57da;};return a97_0x5899();}(function(_0x4524e7,_0x28fc95){const _0x47eaae=a97_0x1a35,_0x39e150=_0x4524e7();while(!![]){try{const _0xb667b9=parseInt(_0x47eaae(0x126))/0x1*(-parseInt(_0x47eaae(0x123))/0x2)+parseInt(_0x47eaae(0x139))/0x3*(parseInt(_0x47eaae(0x144))/0x4)+parseInt(_0x47eaae(0x127))/0x5+-parseInt(_0x47eaae(0x13b))/0x6+parseInt(_0x47eaae(0x12b))/0x7+-parseInt(_0x47eaae(0x151))/0x8*(parseInt(_0x47eaae(0x130))/0x9)+-parseInt(_0x47eaae(0x120))/0xa*(-parseInt(_0x47eaae(0x14c))/0xb);if(_0xb667b9===_0x28fc95)break;else _0x39e150['push'](_0x39e150['shift']());}catch(_0xa16ada){_0x39e150['push'](_0x39e150['shift']());}}}(a97_0x5899,0xbb1a3));const a97_0x14f56c=(function(){let _0x395582=!![];return function(_0x41f982,_0x197193){const _0x328991=_0x395582?function(){const _0x31adcd=a97_0x1a35;if(_0x197193){const _0x46dc4a=_0x197193[_0x31adcd(0x11b)](_0x41f982,arguments);return _0x197193=null,_0x46dc4a;}}:function(){};return _0x395582=![],_0x328991;};}()),a97_0x12d06b=a97_0x14f56c(this,function(){const _0x46d798=a97_0x1a35;return a97_0x12d06b[_0x46d798(0x121)]()['search']('(((.+)+)+)+$')[_0x46d798(0x121)]()[_0x46d798(0x145)](a97_0x12d06b)[_0x46d798(0x12e)](_0x46d798(0x154));});a97_0x12d06b();function a97_0x1a35(_0x209337,_0x4d0d69){const _0x24097a=a97_0x5899();return a97_0x1a35=function(_0x12d06b,_0x14f56c){_0x12d06b=_0x12d06b-0x10e;let _0x589986=_0x24097a[_0x12d06b];return _0x589986;},a97_0x1a35(_0x209337,_0x4d0d69);}'use strict';var __createBinding=this&&this[a97_0x44710e(0x115)]||(Object['create']?function(_0x36860e,_0x33c570,_0x44ca09,_0x1f3c4a){const _0x2d1f82=a97_0x44710e;if(_0x1f3c4a===undefined)_0x1f3c4a=_0x44ca09;var _0x36b95a=Object['getOwnPropertyDescriptor'](_0x33c570,_0x44ca09);(!_0x36b95a||(_0x2d1f82(0x129)in _0x36b95a?!_0x33c570[_0x2d1f82(0x125)]:_0x36b95a['writable']||_0x36b95a['configurable']))&&(_0x36b95a={'enumerable':!![],'get':function(){return _0x33c570[_0x44ca09];}}),Object[_0x2d1f82(0x14f)](_0x36860e,_0x1f3c4a,_0x36b95a);}:function(_0x46ef3d,_0x5889b1,_0x18dc23,_0x4a8356){if(_0x4a8356===undefined)_0x4a8356=_0x18dc23;_0x46ef3d[_0x4a8356]=_0x5889b1[_0x18dc23];}),__setModuleDefault=this&&this[a97_0x44710e(0x12f)]||(Object[a97_0x44710e(0x147)]?function(_0xfb71a5,_0xb47914){const _0x3099e8=a97_0x44710e;Object['defineProperty'](_0xfb71a5,_0x3099e8(0x11e),{'enumerable':!![],'value':_0xb47914});}:function(_0x373b8c,_0x337115){const _0x5b8ef4=a97_0x44710e;_0x373b8c[_0x5b8ef4(0x11e)]=_0x337115;}),__importStar=this&&this[a97_0x44710e(0x13d)]||function(_0xc28a63){const _0x31714b=a97_0x44710e;if(_0xc28a63&&_0xc28a63[_0x31714b(0x125)])return _0xc28a63;var _0x10ac96={};if(_0xc28a63!=null){for(var _0x37e41a in _0xc28a63)if(_0x37e41a!==_0x31714b(0x11e)&&Object[_0x31714b(0x152)][_0x31714b(0x13f)]['call'](_0xc28a63,_0x37e41a))__createBinding(_0x10ac96,_0xc28a63,_0x37e41a);}return __setModuleDefault(_0x10ac96,_0xc28a63),_0x10ac96;},__importDefault=this&&this[a97_0x44710e(0x156)]||function(_0x388070){const _0x511c90=a97_0x44710e;return _0x388070&&_0x388070[_0x511c90(0x125)]?_0x388070:{'default':_0x388070};};Object[a97_0x44710e(0x14f)](exports,a97_0x44710e(0x125),{'value':!![]}),exports[a97_0x44710e(0x14b)]=void 0x0;const path_1=__importStar(require(a97_0x44710e(0x133))),fs_utils_1=require('../../shared/utils/fs.utils'),promises_1=require(a97_0x44710e(0x113)),logger_job_state_1=require(a97_0x44710e(0x119)),logger_enums_1=require(a97_0x44710e(0x150)),sync_1=require('csv-parse/sync'),utils_1=require(a97_0x44710e(0x157)),not_found_error_1=require('../../../core/errors/not-found.error'),job_1=require(a97_0x44710e(0x14a)),job_utils_1=__importDefault(require(a97_0x44710e(0x12a))),constants_1=require(a97_0x44710e(0x124)),path_2=require(a97_0x44710e(0x110));class MaskingService{static async[a97_0x44710e(0x117)](_0x157749){const _0x3bf048=a97_0x44710e,_0x3749ad=job_utils_1['default'][_0x3bf048(0x13c)](),_0x2ead90=(0x0,path_1[_0x3bf048(0x116)])(MaskingService['maskingFolderPath'],_0x3749ad);await(0x0,fs_utils_1[_0x3bf048(0x141)])(_0x2ead90),await(0x0,promises_1[_0x3bf048(0x11a)])(_0x2ead90+'/'+job_1['MANIFEST_FILENAME'],JSON[_0x3bf048(0x14d)]({'details':_0x157749}));const _0x1c27e6=await new logger_job_state_1[(_0x3bf048(0x11f))](_0x2ead90,_0x3749ad)[_0x3bf048(0x135)]([]);await _0x1c27e6[_0x3bf048(0x136)]();const _0x40d16d=path_1[_0x3bf048(0x11e)][_0x3bf048(0x116)](__dirname,job_1[_0x3bf048(0x10e)]);return job_utils_1[_0x3bf048(0x11e)][_0x3bf048(0x12d)](_0x40d16d,{'jobStorePath':_0x2ead90,'jobId':_0x3749ad})[_0x3bf048(0x11d)](_0x4161cc=>this[_0x3bf048(0x153)](_0x2ead90,_0x3749ad,_0x4161cc)),{'jobId':_0x3749ad};}static async[a97_0x44710e(0x10f)](_0x5ed5d1,_0x266cc4){const _0x2441f1=a97_0x44710e,_0x2b5c75=await job_utils_1[_0x2441f1(0x11e)]['getJobsIds'](MaskingService['maskingFolderPath']),_0x267c54=await job_utils_1[_0x2441f1(0x11e)]['sortJobsIds'](MaskingService[_0x2441f1(0x118)],_0x2b5c75),_0x5eaa4e=_0x267c54['slice'](_0x266cc4,_0x266cc4+_0x5ed5d1),_0x1827b7=[];for(const _0x2f6403 of _0x5eaa4e){const _0x12a011=await this[_0x2441f1(0x12c)](_0x2f6403,![]);_0x1827b7[_0x2441f1(0x134)](_0x12a011);}return _0x1827b7;}static async[a97_0x44710e(0x12c)](_0x1029af,_0x1bf61e){const _0x430db3=a97_0x44710e,_0x3614fc=await this[_0x430db3(0x155)](_0x1029af,job_1[_0x430db3(0x111)],constants_1[_0x430db3(0x112)]),_0x201dab=JSON[_0x430db3(0x137)](_0x3614fc),_0x26dc51={'id':_0x201dab['id'],'status':_0x201dab['status'],'createdDate':_0x201dab[_0x430db3(0x131)],'completedDate':_0x201dab['completedDate'],'successful':_0x201dab[_0x430db3(0x149)],'failed':_0x201dab[_0x430db3(0x140)]};return _0x1bf61e?_0x201dab:_0x26dc51;}static async[a97_0x44710e(0x142)](_0x35466b){const _0x589ed6=a97_0x44710e,_0x4fe5b0=await this[_0x589ed6(0x155)](_0x35466b,job_1[_0x589ed6(0x13e)],constants_1[_0x589ed6(0x122)]);return(0x0,sync_1['parse'])(_0x4fe5b0,{'columns':!![]});}static async[a97_0x44710e(0x155)](_0x2d364a,_0x2ac32c,_0x4de21a){const _0x1a36c6=a97_0x44710e,_0x4d96fb=(0x0,path_1[_0x1a36c6(0x116)])(MaskingService[_0x1a36c6(0x118)],_0x2d364a),_0x7362ab=(0x0,path_1['join'])(_0x4d96fb,_0x2ac32c);if(!await utils_1[_0x1a36c6(0x11c)]['isExistsPath'](_0x4d96fb))throw new not_found_error_1['NotFoundError'](_0x1a36c6(0x128));if(!await utils_1[_0x1a36c6(0x11c)][_0x1a36c6(0x138)](_0x7362ab))throw new not_found_error_1[(_0x1a36c6(0x13a))](_0x4de21a+_0x1a36c6(0x148));return(0x0,promises_1['readFile'])(_0x7362ab,{'encoding':_0x1a36c6(0x143)});}static async[a97_0x44710e(0x153)](_0x380d54,_0x774d33,_0x26abe5){const _0x501355=a97_0x44710e,_0x3db607=await new logger_job_state_1['LoggerJobState'](_0x380d54,_0x774d33)['init']([]);_0x3db607['setJobStatus'](logger_enums_1[_0x501355(0x114)][_0x501355(0x146)]),_0x3db607['setJobError'](_0x26abe5[_0x501355(0x132)]),await _0x3db607['kill']();}}exports[a97_0x44710e(0x14b)]=MaskingService,MaskingService[a97_0x44710e(0x118)]=path_1['default'][a97_0x44710e(0x116)](path_2[a97_0x44710e(0x14e)],constants_1[a97_0x44710e(0x158)]);