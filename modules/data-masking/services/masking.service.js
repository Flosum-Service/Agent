const a81_0x452a68=a81_0x2cc6;(function(_0xcd58b3,_0x5534cb){const _0x2466fc=a81_0x2cc6,_0x1f4bbc=_0xcd58b3();while(!![]){try{const _0xc04e40=parseInt(_0x2466fc(0x186))/0x1+-parseInt(_0x2466fc(0x170))/0x2+-parseInt(_0x2466fc(0x157))/0x3*(-parseInt(_0x2466fc(0x169))/0x4)+-parseInt(_0x2466fc(0x162))/0x5*(parseInt(_0x2466fc(0x15d))/0x6)+-parseInt(_0x2466fc(0x183))/0x7+parseInt(_0x2466fc(0x165))/0x8*(parseInt(_0x2466fc(0x167))/0x9)+parseInt(_0x2466fc(0x189))/0xa;if(_0xc04e40===_0x5534cb)break;else _0x1f4bbc['push'](_0x1f4bbc['shift']());}catch(_0x5809c5){_0x1f4bbc['push'](_0x1f4bbc['shift']());}}}(a81_0x46a0,0xe43f0));const a81_0x423f30=(function(){let _0x43a075=!![];return function(_0x1660f2,_0x2ccd2e){const _0x1944f9=_0x43a075?function(){const _0x2ed46f=a81_0x2cc6;if(_0x2ccd2e){const _0x2ed22e=_0x2ccd2e[_0x2ed46f(0x178)](_0x1660f2,arguments);return _0x2ccd2e=null,_0x2ed22e;}}:function(){};return _0x43a075=![],_0x1944f9;};}()),a81_0x16d97e=a81_0x423f30(this,function(){const _0x7ba9a3=a81_0x2cc6;return a81_0x16d97e[_0x7ba9a3(0x17a)]()['search'](_0x7ba9a3(0x156))[_0x7ba9a3(0x17a)]()[_0x7ba9a3(0x15a)](a81_0x16d97e)['search'](_0x7ba9a3(0x156));});a81_0x16d97e();function a81_0x2cc6(_0x2229f9,_0x521400){const _0x2cb408=a81_0x46a0();return a81_0x2cc6=function(_0x16d97e,_0x423f30){_0x16d97e=_0x16d97e-0x145;let _0x46a059=_0x2cb408[_0x16d97e];return _0x46a059;},a81_0x2cc6(_0x2229f9,_0x521400);}'use strict';var __createBinding=this&&this['__createBinding']||(Object[a81_0x452a68(0x16e)]?function(_0x2c61cc,_0x15544e,_0x39a75a,_0x4c0d2c){const _0x573f0c=a81_0x452a68;if(_0x4c0d2c===undefined)_0x4c0d2c=_0x39a75a;var _0x458d94=Object[_0x573f0c(0x164)](_0x15544e,_0x39a75a);(!_0x458d94||(_0x573f0c(0x15c)in _0x458d94?!_0x15544e[_0x573f0c(0x17f)]:_0x458d94[_0x573f0c(0x17e)]||_0x458d94['configurable']))&&(_0x458d94={'enumerable':!![],'get':function(){return _0x15544e[_0x39a75a];}}),Object['defineProperty'](_0x2c61cc,_0x4c0d2c,_0x458d94);}:function(_0x56e766,_0x5eaf51,_0x49e9d2,_0x32f3dc){if(_0x32f3dc===undefined)_0x32f3dc=_0x49e9d2;_0x56e766[_0x32f3dc]=_0x5eaf51[_0x49e9d2];}),__setModuleDefault=this&&this[a81_0x452a68(0x168)]||(Object['create']?function(_0x119741,_0x128888){const _0x74aa88=a81_0x452a68;Object[_0x74aa88(0x174)](_0x119741,_0x74aa88(0x160),{'enumerable':!![],'value':_0x128888});}:function(_0x572b0b,_0x5b262a){const _0xbd5f46=a81_0x452a68;_0x572b0b[_0xbd5f46(0x160)]=_0x5b262a;}),__importStar=this&&this[a81_0x452a68(0x171)]||function(_0x57eda8){const _0x9990b6=a81_0x452a68;if(_0x57eda8&&_0x57eda8[_0x9990b6(0x17f)])return _0x57eda8;var _0x45b12e={};if(_0x57eda8!=null){for(var _0x2733f4 in _0x57eda8)if(_0x2733f4!==_0x9990b6(0x160)&&Object[_0x9990b6(0x188)][_0x9990b6(0x16f)]['call'](_0x57eda8,_0x2733f4))__createBinding(_0x45b12e,_0x57eda8,_0x2733f4);}return __setModuleDefault(_0x45b12e,_0x57eda8),_0x45b12e;},__importDefault=this&&this[a81_0x452a68(0x14d)]||function(_0x58c8a3){const _0x1ad7ca=a81_0x452a68;return _0x58c8a3&&_0x58c8a3[_0x1ad7ca(0x17f)]?_0x58c8a3:{'default':_0x58c8a3};};Object['defineProperty'](exports,a81_0x452a68(0x17f),{'value':!![]}),exports[a81_0x452a68(0x14a)]=void 0x0;const path_1=__importStar(require('path')),fs_utils_1=require(a81_0x452a68(0x14b)),promises_1=require('fs/promises'),logger_job_state_1=require('../job/classes/logger/logger-job-state'),logger_enums_1=require(a81_0x452a68(0x184)),sync_1=require('csv-parse/sync'),utils_1=require(a81_0x452a68(0x15b)),not_found_error_1=require('../../../core/errors/not-found.error'),job_1=require('../../../constants/job'),job_utils_1=__importDefault(require(a81_0x452a68(0x148))),constants_1=require(a81_0x452a68(0x145)),path_2=require(a81_0x452a68(0x154));class MaskingService{static async['createMaskingJob'](_0x2804aa){const _0x4b3ea5=a81_0x452a68,_0x55dbf3=job_utils_1[_0x4b3ea5(0x160)]['generateJobId'](),_0x3b842f=(0x0,path_1[_0x4b3ea5(0x151)])(MaskingService[_0x4b3ea5(0x14f)],_0x55dbf3);await(0x0,fs_utils_1[_0x4b3ea5(0x175)])(_0x3b842f),await(0x0,promises_1[_0x4b3ea5(0x149)])(_0x3b842f+'/'+job_1[_0x4b3ea5(0x152)],JSON['stringify']({'details':_0x2804aa}));const _0x50cfe8=await new logger_job_state_1[(_0x4b3ea5(0x158))](_0x3b842f,_0x55dbf3)[_0x4b3ea5(0x16b)]([]);await _0x50cfe8[_0x4b3ea5(0x163)]();const _0x5c5057=path_1[_0x4b3ea5(0x160)][_0x4b3ea5(0x151)](__dirname,job_1[_0x4b3ea5(0x159)]);return job_utils_1[_0x4b3ea5(0x160)][_0x4b3ea5(0x155)](_0x5c5057,{'jobStorePath':_0x3b842f,'jobId':_0x55dbf3})['catch'](_0x157493=>this['logErrorStartJob'](_0x3b842f,_0x55dbf3,_0x157493)),{'jobId':_0x55dbf3};}static async[a81_0x452a68(0x17c)](_0x40c377,_0x452e05){const _0x5314e9=a81_0x452a68,_0x2c742c=await job_utils_1['default'][_0x5314e9(0x161)](MaskingService[_0x5314e9(0x14f)]),_0x4d6798=await job_utils_1[_0x5314e9(0x160)][_0x5314e9(0x181)](MaskingService[_0x5314e9(0x14f)],_0x2c742c),_0x2faac9=_0x4d6798[_0x5314e9(0x147)](_0x452e05,_0x452e05+_0x40c377),_0x35c55b=[];for(const _0x2761d0 of _0x2faac9){const _0x5a97cf=await this[_0x5314e9(0x146)](_0x2761d0,![]);_0x35c55b[_0x5314e9(0x177)](_0x5a97cf);}return _0x35c55b;}static async[a81_0x452a68(0x146)](_0x22e493,_0x3e0346){const _0x228461=a81_0x452a68,_0x6dc543=await this[_0x228461(0x153)](_0x22e493,job_1['JOB_LOG_STATE_FILENAME'],constants_1[_0x228461(0x16a)]),_0x12bbcb=JSON[_0x228461(0x16c)](_0x6dc543),_0x2024be={'id':_0x12bbcb['id'],'status':_0x12bbcb[_0x228461(0x182)],'createdDate':_0x12bbcb[_0x228461(0x17d)],'completedDate':_0x12bbcb['completedDate'],'successful':_0x12bbcb[_0x228461(0x172)],'failed':_0x12bbcb['failed']};return _0x3e0346?_0x12bbcb:_0x2024be;}static async[a81_0x452a68(0x187)](_0x2d7275){const _0x1696d7=a81_0x452a68,_0x45b926=await this[_0x1696d7(0x153)](_0x2d7275,job_1[_0x1696d7(0x179)],constants_1[_0x1696d7(0x150)]);return(0x0,sync_1['parse'])(_0x45b926,{'columns':!![]});}static async[a81_0x452a68(0x153)](_0x19ffb0,_0x2a804d,_0x2912c9){const _0x5cd4cf=a81_0x452a68,_0x568e7e=(0x0,path_1[_0x5cd4cf(0x151)])(MaskingService[_0x5cd4cf(0x14f)],_0x19ffb0),_0x13712d=(0x0,path_1[_0x5cd4cf(0x151)])(_0x568e7e,_0x2a804d);if(!await utils_1[_0x5cd4cf(0x14c)][_0x5cd4cf(0x166)](_0x568e7e))throw new not_found_error_1[(_0x5cd4cf(0x16d))]('Job\x20Id\x20not\x20found.');if(!await utils_1['FsUtils'][_0x5cd4cf(0x166)](_0x13712d))throw new not_found_error_1[(_0x5cd4cf(0x16d))](_0x2912c9+_0x5cd4cf(0x180));return(0x0,promises_1['readFile'])(_0x13712d,{'encoding':_0x5cd4cf(0x176)});}static async[a81_0x452a68(0x185)](_0x1dd567,_0x594a4a,_0xc0743e){const _0x468845=a81_0x452a68,_0x2b49c3=await new logger_job_state_1[(_0x468845(0x158))](_0x1dd567,_0x594a4a)[_0x468845(0x16b)]([]);_0x2b49c3[_0x468845(0x14e)](logger_enums_1[_0x468845(0x15f)][_0x468845(0x173)]),_0x2b49c3[_0x468845(0x17b)](_0xc0743e['message']),await _0x2b49c3[_0x468845(0x163)]();}}function a81_0x46a0(){const _0x1e9e26=['__importDefault','setJobStatus','maskingFolderPath','JOB_LOG_DETAILS_NAME','join','MANIFEST_FILENAME','getLog','../../../configs/path','runJob','(((.+)+)+)+$','133059ynpyvp','LoggerJobState','JOB_PATH','constructor','@flosum/utils','get','11018316IpqKOv','DATA_MASKING_FOLDER_NAME','JobStatus','default','getJobsIds','5irZdeD','kill','getOwnPropertyDescriptor','32UkgEyH','isExistsPath','1666053soNGFu','__setModuleDefault','12FiTXOB','JOB_LOG_STATE_NAME','init','parse','NotFoundError','create','hasOwnProperty','623572xuESbH','__importStar','successful','FAILED','defineProperty','makeDir','utf-8','push','apply','JOB_LOG_DETAILS_FILENAME','toString','setJobError','getJobs','createdDate','writable','__esModule','\x20not\x20found.','sortJobsIds','status','3090829ynKwTt','../job/enums/logger.enums','logErrorStartJob','193117iXqmWw','getJobDetails','prototype','24579710JuNLRl','../constants','getJobState','slice','../../shared/utils/job.utils','writeFile','MaskingService','../../shared/utils/fs.utils','FsUtils'];a81_0x46a0=function(){return _0x1e9e26;};return a81_0x46a0();}exports[a81_0x452a68(0x14a)]=MaskingService,MaskingService[a81_0x452a68(0x14f)]=path_1['default']['join'](path_2['dataPath'],constants_1[a81_0x452a68(0x15e)]);