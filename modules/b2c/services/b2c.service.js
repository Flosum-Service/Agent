const a69_0x57da0b=a69_0x4975;(function(_0x1f25c8,_0xa60298){const _0x1d42b6=a69_0x4975,_0x15145b=_0x1f25c8();while(!![]){try{const _0x528438=-parseInt(_0x1d42b6(0x1d5))/0x1+parseInt(_0x1d42b6(0x1ba))/0x2*(-parseInt(_0x1d42b6(0x1bc))/0x3)+-parseInt(_0x1d42b6(0x1bb))/0x4+-parseInt(_0x1d42b6(0x1ac))/0x5*(parseInt(_0x1d42b6(0x1c0))/0x6)+-parseInt(_0x1d42b6(0x1da))/0x7+parseInt(_0x1d42b6(0x1dc))/0x8*(-parseInt(_0x1d42b6(0x1d0))/0x9)+parseInt(_0x1d42b6(0x1d6))/0xa*(parseInt(_0x1d42b6(0x1ae))/0xb);if(_0x528438===_0xa60298)break;else _0x15145b['push'](_0x15145b['shift']());}catch(_0x5dee21){_0x15145b['push'](_0x15145b['shift']());}}}(a69_0x914e,0xd0537));const a69_0x1c69c4=(function(){let _0x5ecdd8=!![];return function(_0x96a538,_0x2df84b){const _0x903daf=_0x5ecdd8?function(){const _0x468fcf=a69_0x4975;if(_0x2df84b){const _0x511aa0=_0x2df84b[_0x468fcf(0x1c7)](_0x96a538,arguments);return _0x2df84b=null,_0x511aa0;}}:function(){};return _0x5ecdd8=![],_0x903daf;};}()),a69_0x127fd8=a69_0x1c69c4(this,function(){const _0x3a93e2=a69_0x4975;return a69_0x127fd8[_0x3a93e2(0x1c8)]()[_0x3a93e2(0x1c2)](_0x3a93e2(0x1d3))[_0x3a93e2(0x1c8)]()[_0x3a93e2(0x1c9)](a69_0x127fd8)[_0x3a93e2(0x1c2)](_0x3a93e2(0x1d3));});a69_0x127fd8();'use strict';var __importDefault=this&&this[a69_0x57da0b(0x1c5)]||function(_0x256aff){return _0x256aff&&_0x256aff['__esModule']?_0x256aff:{'default':_0x256aff};};function a69_0x914e(){const _0x5cbe0f=['getJobsIds','(((.+)+)+)+$','../../shared/utils/fs.utils','362151oZSqkr','14950640UJHQRT','../../shared/utils/csv.utils','catch','readFile','10181871ObPKQT','utf-8','8SGffWg','defineProperty','create','933045EOqSUR','setError','33VpSxpF','__esModule','FsUtils','init','makeDir','join','getJobStatus','finally','runJob','../../shared/managers/state-manger','JOB_PATH','isExistsPath','2zWfdbd','3193664IayaYp','2218107XxypSG','../../../constants/job','getJobState','getJobs','6SxvHzb','fs/promises','search','b2cFolder','default','__importDefault','JOB_LOG_DETAILS_FILENAME','apply','toString','constructor','path','cartridges','../../../core/errors/not-found.error','dataPath','push','sortJobsIds','817119GKWKMy','parse'];a69_0x914e=function(){return _0x5cbe0f;};return a69_0x914e();}function a69_0x4975(_0xa90a0a,_0x36b0ac){const _0x59ecfc=a69_0x914e();return a69_0x4975=function(_0x127fd8,_0x1c69c4){_0x127fd8=_0x127fd8-0x1aa;let _0x914e7e=_0x59ecfc[_0x127fd8];return _0x914e7e;},a69_0x4975(_0xa90a0a,_0x36b0ac);}Object[a69_0x57da0b(0x1aa)](exports,a69_0x57da0b(0x1af),{'value':!![]});const promises_1=require(a69_0x57da0b(0x1c1)),utils_1=require('@flosum/utils'),not_found_error_1=require(a69_0x57da0b(0x1cc)),fs_utils_1=require(a69_0x57da0b(0x1d4)),constants_1=require('../constants'),path_1=require('../../../configs/path'),job_1=require(a69_0x57da0b(0x1bd)),path_2=__importDefault(require(a69_0x57da0b(0x1ca))),manifest_manager_1=__importDefault(require('../job/classes/manifest-manager')),state_manger_1=__importDefault(require(a69_0x57da0b(0x1b7))),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),csv_utils_1=__importDefault(require(a69_0x57da0b(0x1d7)));class B2CService{static async['createJob'](_0x5e06c8){const _0x4ee1c7=a69_0x57da0b,_0x264b7e=job_utils_1['default']['generateJobId'](),_0x96dbb=path_2['default']['join'](B2CService['b2cFolder'],_0x264b7e);await(0x0,fs_utils_1[_0x4ee1c7(0x1b2)])(_0x96dbb),await manifest_manager_1[_0x4ee1c7(0x1c4)][_0x4ee1c7(0x1ab)](_0x96dbb,_0x5e06c8),await state_manger_1['default'][_0x4ee1c7(0x1ab)](_0x96dbb,_0x264b7e);const _0x275feb=path_2['default'][_0x4ee1c7(0x1b3)](__dirname,job_1[_0x4ee1c7(0x1b8)]);return job_utils_1[_0x4ee1c7(0x1c4)][_0x4ee1c7(0x1b6)](_0x275feb,{'jobStorePath':_0x96dbb,'jobId':_0x264b7e})[_0x4ee1c7(0x1d8)](async _0x1a6707=>{const _0x3a991b=_0x4ee1c7,_0x39b3f2=new state_manger_1[(_0x3a991b(0x1c4))](_0x96dbb);await _0x39b3f2[_0x3a991b(0x1b1)](),await _0x39b3f2[_0x3a991b(0x1ad)](_0x1a6707);})[_0x4ee1c7(0x1b5)](async()=>{const _0x15a535=_0x4ee1c7,_0x1368d8=path_2[_0x15a535(0x1c4)]['join'](_0x96dbb,_0x15a535(0x1cb));await(0x0,promises_1['rm'])(_0x1368d8,{'recursive':!![],'force':!![]});}),{'jobId':_0x264b7e};}static async[a69_0x57da0b(0x1bf)](_0x15549a,_0x29cd6b){const _0x9e743=a69_0x57da0b,_0x44dd42=await job_utils_1[_0x9e743(0x1c4)][_0x9e743(0x1d2)](B2CService[_0x9e743(0x1c3)]),_0x5580c1=await job_utils_1[_0x9e743(0x1c4)][_0x9e743(0x1cf)](B2CService[_0x9e743(0x1c3)],_0x44dd42),_0x25cd4a=_0x5580c1['slice'](_0x29cd6b,_0x29cd6b+_0x15549a),_0x17c38b=[];for(const _0x321758 of _0x25cd4a){const _0x1f9f78=await state_manger_1['default'][_0x9e743(0x1be)](path_2[_0x9e743(0x1c4)][_0x9e743(0x1b3)](B2CService[_0x9e743(0x1c3)],_0x321758));_0x17c38b[_0x9e743(0x1ce)](_0x1f9f78);}return _0x17c38b;}static async[a69_0x57da0b(0x1b4)](_0x17e3a6){const _0x167d0c=a69_0x57da0b;try{return state_manger_1[_0x167d0c(0x1c4)][_0x167d0c(0x1be)](path_2[_0x167d0c(0x1c4)]['join'](B2CService['b2cFolder'],_0x17e3a6));}catch(_0x590176){throw new not_found_error_1['NotFoundError'](_0x590176);}}static async['getJobLog'](_0x4cb8d3){const _0x4cb7c2=a69_0x57da0b,_0x56807c=path_2[_0x4cb7c2(0x1c4)][_0x4cb7c2(0x1b3)](B2CService[_0x4cb7c2(0x1c3)],_0x4cb8d3,job_1[_0x4cb7c2(0x1c6)]);if(await utils_1[_0x4cb7c2(0x1b0)][_0x4cb7c2(0x1b9)](_0x56807c))return(0x0,promises_1[_0x4cb7c2(0x1d9)])(_0x56807c,_0x4cb7c2(0x1db))['then'](_0x573586=>csv_utils_1['default'][_0x4cb7c2(0x1d1)](_0x573586,{'columns':!![]}));throw new not_found_error_1['NotFoundError']('Job\x20log\x20not\x20found.');}}exports['default']=B2CService,B2CService['b2cFolder']=path_2[a69_0x57da0b(0x1c4)][a69_0x57da0b(0x1b3)](path_1[a69_0x57da0b(0x1cd)],constants_1['B2C_FOLDER_NAME']);