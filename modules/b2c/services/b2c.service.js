const a69_0x267b04=a69_0x4fda;(function(_0x266b4a,_0x5c12ee){const _0x199af8=a69_0x4fda,_0x270ef1=_0x266b4a();while(!![]){try{const _0x47e4f8=-parseInt(_0x199af8(0xf9))/0x1*(-parseInt(_0x199af8(0xff))/0x2)+parseInt(_0x199af8(0xdf))/0x3+-parseInt(_0x199af8(0x10e))/0x4+-parseInt(_0x199af8(0x10a))/0x5*(parseInt(_0x199af8(0xf3))/0x6)+parseInt(_0x199af8(0x10c))/0x7+-parseInt(_0x199af8(0xfa))/0x8*(parseInt(_0x199af8(0xfe))/0x9)+parseInt(_0x199af8(0xea))/0xa*(parseInt(_0x199af8(0xe8))/0xb);if(_0x47e4f8===_0x5c12ee)break;else _0x270ef1['push'](_0x270ef1['shift']());}catch(_0x1c2231){_0x270ef1['push'](_0x270ef1['shift']());}}}(a69_0x4cb9,0x3f422));const a69_0x36d5ca=(function(){let _0x47e529=!![];return function(_0x69709a,_0x4a7199){const _0x8b15fd=_0x47e529?function(){if(_0x4a7199){const _0x46f38c=_0x4a7199['apply'](_0x69709a,arguments);return _0x4a7199=null,_0x46f38c;}}:function(){};return _0x47e529=![],_0x8b15fd;};}()),a69_0x279c95=a69_0x36d5ca(this,function(){const _0x3ce1cb=a69_0x4fda;return a69_0x279c95['toString']()[_0x3ce1cb(0xde)]('(((.+)+)+)+$')[_0x3ce1cb(0xf8)]()['constructor'](a69_0x279c95)[_0x3ce1cb(0xde)](_0x3ce1cb(0xf4));});a69_0x279c95();'use strict';var __importDefault=this&&this[a69_0x267b04(0xe0)]||function(_0x182c6f){return _0x182c6f&&_0x182c6f['__esModule']?_0x182c6f:{'default':_0x182c6f};};Object['defineProperty'](exports,a69_0x267b04(0xe3),{'value':!![]});function a69_0x4fda(_0x31ffca,_0x421ac7){const _0x248451=a69_0x4cb9();return a69_0x4fda=function(_0x279c95,_0x36d5ca){_0x279c95=_0x279c95-0xda;let _0x4cb969=_0x248451[_0x279c95];return _0x4cb969;},a69_0x4fda(_0x31ffca,_0x421ac7);}function a69_0x4cb9(){const _0x28070b=['then','../../shared/utils/job.utils','slice','NotFoundError','setError','dataPath','create','../../../constants/job','14862pyPczs','(((.+)+)+)+$','JOB_LOG_DETAILS_FILENAME','path','getJobLog','toString','68164atMsSj','72024CWRnUe','generateJobId','readFile','JOB_PATH','261XHgAAh','8upOinN','utf-8','join','makeDir','catch','../constants','getJobStatus','getJobsIds','isExistsPath','getJobs','sortJobsIds','975kFzqwM','Job\x20log\x20not\x20found.','2453878hsNcVp','default','1860568ObgGgO','../../shared/utils/csv.utils','cartridges','getJobState','parse','search','1379253cPIQRQ','__importDefault','B2C_FOLDER_NAME','runJob','__esModule','../../shared/utils/fs.utils','fs/promises','b2cFolder','push','99qvjSEd','../../shared/managers/state-manger','428210ogfkDl'];a69_0x4cb9=function(){return _0x28070b;};return a69_0x4cb9();}const promises_1=require(a69_0x267b04(0xe5)),utils_1=require('@flosum/utils'),not_found_error_1=require('../../../core/errors/not-found.error'),fs_utils_1=require(a69_0x267b04(0xe4)),constants_1=require(a69_0x267b04(0x104)),path_1=require('../../../configs/path'),job_1=require(a69_0x267b04(0xf2)),path_2=__importDefault(require(a69_0x267b04(0xf6))),manifest_manager_1=__importDefault(require('../job/classes/manifest-manager')),state_manger_1=__importDefault(require(a69_0x267b04(0xe9))),job_utils_1=__importDefault(require(a69_0x267b04(0xec))),csv_utils_1=__importDefault(require(a69_0x267b04(0xda)));class B2CService{static async['createJob'](_0x34fee6){const _0x5100e1=a69_0x267b04,_0x58bf95=job_utils_1[_0x5100e1(0x10d)][_0x5100e1(0xfb)](),_0x18ceca=path_2[_0x5100e1(0x10d)]['join'](B2CService[_0x5100e1(0xe6)],_0x58bf95);await(0x0,fs_utils_1[_0x5100e1(0x102)])(_0x18ceca),await manifest_manager_1[_0x5100e1(0x10d)][_0x5100e1(0xf1)](_0x18ceca,_0x34fee6),await state_manger_1['default'][_0x5100e1(0xf1)](_0x18ceca,_0x58bf95);const _0x28cccf=path_2['default'][_0x5100e1(0x101)](__dirname,job_1[_0x5100e1(0xfd)]);return job_utils_1[_0x5100e1(0x10d)][_0x5100e1(0xe2)](_0x28cccf,{'jobStorePath':_0x18ceca,'jobId':_0x58bf95})[_0x5100e1(0x103)](async _0x52b69d=>{const _0x3f55a1=_0x5100e1,_0x3debbf=new state_manger_1['default'](_0x18ceca);await _0x3debbf['init'](),await _0x3debbf[_0x3f55a1(0xef)](_0x52b69d);})['finally'](async()=>{const _0x21376e=_0x5100e1,_0x3c49b6=path_2[_0x21376e(0x10d)]['join'](_0x18ceca,_0x21376e(0xdb));await(0x0,promises_1['rm'])(_0x3c49b6,{'recursive':!![],'force':!![]});}),{'jobId':_0x58bf95};}static async[a69_0x267b04(0x108)](_0x4e1806,_0x58ab68){const _0x467091=a69_0x267b04,_0x574040=await job_utils_1[_0x467091(0x10d)][_0x467091(0x106)](B2CService['b2cFolder']),_0x287cd8=await job_utils_1[_0x467091(0x10d)][_0x467091(0x109)](B2CService['b2cFolder'],_0x574040),_0x18827c=_0x287cd8[_0x467091(0xed)](_0x58ab68,_0x58ab68+_0x4e1806),_0x2d301c=[];for(const _0x5da3d6 of _0x18827c){const _0x234ff9=await state_manger_1[_0x467091(0x10d)][_0x467091(0xdc)](path_2['default'][_0x467091(0x101)](B2CService[_0x467091(0xe6)],_0x5da3d6));_0x2d301c[_0x467091(0xe7)](_0x234ff9);}return _0x2d301c;}static async[a69_0x267b04(0x105)](_0x5eddc4){const _0x54f29f=a69_0x267b04;try{return state_manger_1[_0x54f29f(0x10d)][_0x54f29f(0xdc)](path_2[_0x54f29f(0x10d)][_0x54f29f(0x101)](B2CService['b2cFolder'],_0x5eddc4));}catch(_0x1a96b5){throw new not_found_error_1[(_0x54f29f(0xee))](_0x1a96b5);}}static async[a69_0x267b04(0xf7)](_0xe0fa70){const _0x503893=a69_0x267b04,_0x666a91=path_2[_0x503893(0x10d)][_0x503893(0x101)](B2CService[_0x503893(0xe6)],_0xe0fa70,job_1[_0x503893(0xf5)]);if(await utils_1['FsUtils'][_0x503893(0x107)](_0x666a91))return(0x0,promises_1[_0x503893(0xfc)])(_0x666a91,_0x503893(0x100))[_0x503893(0xeb)](_0x4b0501=>csv_utils_1[_0x503893(0x10d)][_0x503893(0xdd)](_0x4b0501,{'columns':!![]}));throw new not_found_error_1['NotFoundError'](_0x503893(0x10b));}}exports[a69_0x267b04(0x10d)]=B2CService,B2CService[a69_0x267b04(0xe6)]=path_2[a69_0x267b04(0x10d)][a69_0x267b04(0x101)](path_1[a69_0x267b04(0xf0)],constants_1[a69_0x267b04(0xe1)]);