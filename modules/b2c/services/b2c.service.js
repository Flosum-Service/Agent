const a69_0x2e7360=a69_0x3280;(function(_0x326fe9,_0x17573a){const _0x2fe2ec=a69_0x3280,_0x3112a5=_0x326fe9();while(!![]){try{const _0x25925e=-parseInt(_0x2fe2ec(0x19f))/0x1*(-parseInt(_0x2fe2ec(0x1a9))/0x2)+parseInt(_0x2fe2ec(0x1aa))/0x3+-parseInt(_0x2fe2ec(0x199))/0x4+parseInt(_0x2fe2ec(0x19a))/0x5+parseInt(_0x2fe2ec(0x185))/0x6+-parseInt(_0x2fe2ec(0x1b3))/0x7*(-parseInt(_0x2fe2ec(0x1a6))/0x8)+-parseInt(_0x2fe2ec(0x19b))/0x9;if(_0x25925e===_0x17573a)break;else _0x3112a5['push'](_0x3112a5['shift']());}catch(_0xaf6ac){_0x3112a5['push'](_0x3112a5['shift']());}}}(a69_0x1583,0x4d09f));function a69_0x3280(_0x1d6f43,_0x12e3f5){const _0x3f1d86=a69_0x1583();return a69_0x3280=function(_0x14e124,_0x51d4ab){_0x14e124=_0x14e124-0x184;let _0x158357=_0x3f1d86[_0x14e124];return _0x158357;},a69_0x3280(_0x1d6f43,_0x12e3f5);}const a69_0x51d4ab=(function(){let _0x8c361e=!![];return function(_0x583f05,_0x4e9235){const _0x4d6f45=_0x8c361e?function(){if(_0x4e9235){const _0xce0b62=_0x4e9235['apply'](_0x583f05,arguments);return _0x4e9235=null,_0xce0b62;}}:function(){};return _0x8c361e=![],_0x4d6f45;};}()),a69_0x14e124=a69_0x51d4ab(this,function(){const _0x38ad7e=a69_0x3280;return a69_0x14e124[_0x38ad7e(0x1a0)]()['search']('(((.+)+)+)+$')[_0x38ad7e(0x1a0)]()[_0x38ad7e(0x1b1)](a69_0x14e124)[_0x38ad7e(0x18a)]('(((.+)+)+)+$');});function a69_0x1583(){const _0x2744aa=['5772960wyazuz','../../shared/utils/csv.utils','setError','generateJobId','5SZTdiV','toString','catch','create','push','path','B2C_FOLDER_NAME','32CPtAnh','getJobStatus','../../shared/utils/job.utils','108430qATdvS','1278084hGLUmR','getJobLog','fs/promises','join','default','init','../../shared/utils/fs.utils','constructor','cartridges','648487qHFYkm','JOB_PATH','getJobState','Job\x20log\x20not\x20found.','919950Xwexgz','isExistsPath','JOB_LOG_DETAILS_FILENAME','sortJobsIds','FsUtils','search','../job/classes/manifest-manager','then','dataPath','runJob','readFile','../../shared/managers/state-manger','b2cFolder','utf-8','defineProperty','__esModule','slice','parse','makeDir','createJob','2225828MqDQDF','1462280BEOoQs'];a69_0x1583=function(){return _0x2744aa;};return a69_0x1583();}a69_0x14e124();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3b17ef){const _0x123a1f=a69_0x3280;return _0x3b17ef&&_0x3b17ef[_0x123a1f(0x194)]?_0x3b17ef:{'default':_0x3b17ef};};Object[a69_0x2e7360(0x193)](exports,'__esModule',{'value':!![]});const promises_1=require(a69_0x2e7360(0x1ac)),utils_1=require('@flosum/utils'),not_found_error_1=require('../../../core/errors/not-found.error'),fs_utils_1=require(a69_0x2e7360(0x1b0)),constants_1=require('../constants'),path_1=require('../../../configs/path'),job_1=require('../../../constants/job'),path_2=__importDefault(require(a69_0x2e7360(0x1a4))),manifest_manager_1=__importDefault(require(a69_0x2e7360(0x18b))),state_manger_1=__importDefault(require(a69_0x2e7360(0x190))),job_utils_1=__importDefault(require(a69_0x2e7360(0x1a8))),csv_utils_1=__importDefault(require(a69_0x2e7360(0x19c)));class B2CService{static async[a69_0x2e7360(0x198)](_0x55e119){const _0xf82dd8=a69_0x2e7360,_0x18ce33=job_utils_1[_0xf82dd8(0x1ae)][_0xf82dd8(0x19e)](),_0x1766f8=path_2[_0xf82dd8(0x1ae)][_0xf82dd8(0x1ad)](B2CService[_0xf82dd8(0x191)],_0x18ce33);await(0x0,fs_utils_1[_0xf82dd8(0x197)])(_0x1766f8),await manifest_manager_1[_0xf82dd8(0x1ae)][_0xf82dd8(0x1a2)](_0x1766f8,_0x55e119),await state_manger_1[_0xf82dd8(0x1ae)]['create'](_0x1766f8,_0x18ce33);const _0x28a8b8=path_2[_0xf82dd8(0x1ae)][_0xf82dd8(0x1ad)](__dirname,job_1[_0xf82dd8(0x1b4)]);return job_utils_1[_0xf82dd8(0x1ae)][_0xf82dd8(0x18e)](_0x28a8b8,{'jobStorePath':_0x1766f8,'jobId':_0x18ce33})[_0xf82dd8(0x1a1)](async _0x47a6c5=>{const _0x506ec5=_0xf82dd8,_0x1a825c=new state_manger_1[(_0x506ec5(0x1ae))](_0x1766f8);await _0x1a825c[_0x506ec5(0x1af)](),await _0x1a825c[_0x506ec5(0x19d)](_0x47a6c5);})['finally'](async()=>{const _0x33dd85=_0xf82dd8,_0x2a4073=path_2[_0x33dd85(0x1ae)][_0x33dd85(0x1ad)](_0x1766f8,_0x33dd85(0x1b2));await(0x0,promises_1['rm'])(_0x2a4073,{'recursive':!![],'force':!![]});}),{'jobId':_0x18ce33};}static async['getJobs'](_0x373687,_0x47417d){const _0x2df440=a69_0x2e7360,_0x4f33ec=await job_utils_1['default']['getJobsIds'](B2CService['b2cFolder']),_0x5eb711=await job_utils_1[_0x2df440(0x1ae)][_0x2df440(0x188)](B2CService['b2cFolder'],_0x4f33ec),_0x5144fd=_0x5eb711[_0x2df440(0x195)](_0x47417d,_0x47417d+_0x373687),_0x282328=[];for(const _0x2cd5fb of _0x5144fd){const _0x308e8a=await state_manger_1[_0x2df440(0x1ae)][_0x2df440(0x1b5)](path_2[_0x2df440(0x1ae)][_0x2df440(0x1ad)](B2CService[_0x2df440(0x191)],_0x2cd5fb));_0x282328[_0x2df440(0x1a3)](_0x308e8a);}return _0x282328;}static async[a69_0x2e7360(0x1a7)](_0x485f5c){const _0x2a970c=a69_0x2e7360;try{return state_manger_1[_0x2a970c(0x1ae)][_0x2a970c(0x1b5)](path_2[_0x2a970c(0x1ae)]['join'](B2CService['b2cFolder'],_0x485f5c));}catch(_0x43b084){throw new not_found_error_1['NotFoundError'](_0x43b084);}}static async[a69_0x2e7360(0x1ab)](_0x9c82b3){const _0x2aff59=a69_0x2e7360,_0x21ea4a=path_2['default'][_0x2aff59(0x1ad)](B2CService[_0x2aff59(0x191)],_0x9c82b3,job_1[_0x2aff59(0x187)]);if(await utils_1[_0x2aff59(0x189)][_0x2aff59(0x186)](_0x21ea4a))return(0x0,promises_1[_0x2aff59(0x18f)])(_0x21ea4a,_0x2aff59(0x192))[_0x2aff59(0x18c)](_0x197085=>csv_utils_1[_0x2aff59(0x1ae)][_0x2aff59(0x196)](_0x197085,{'columns':!![]}));throw new not_found_error_1['NotFoundError'](_0x2aff59(0x184));}}exports['default']=B2CService,B2CService[a69_0x2e7360(0x191)]=path_2[a69_0x2e7360(0x1ae)][a69_0x2e7360(0x1ad)](path_1[a69_0x2e7360(0x18d)],constants_1[a69_0x2e7360(0x1a5)]);