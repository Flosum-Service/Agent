const a70_0x4d0c14=a70_0x5be4;function a70_0x5be4(_0x3621b2,_0x6b608a){const _0x4fa8ec=a70_0x1222();return a70_0x5be4=function(_0x2afd90,_0x17beec){_0x2afd90=_0x2afd90-0x1a5;let _0x122272=_0x4fa8ec[_0x2afd90];return _0x122272;},a70_0x5be4(_0x3621b2,_0x6b608a);}(function(_0x5b2d5a,_0x2435b5){const _0x234182=a70_0x5be4,_0x3d7fa9=_0x5b2d5a();while(!![]){try{const _0x31d304=parseInt(_0x234182(0x1ae))/0x1+-parseInt(_0x234182(0x1bc))/0x2+parseInt(_0x234182(0x1b4))/0x3*(-parseInt(_0x234182(0x1c8))/0x4)+-parseInt(_0x234182(0x1b9))/0x5*(-parseInt(_0x234182(0x1ab))/0x6)+parseInt(_0x234182(0x1d4))/0x7+parseInt(_0x234182(0x1af))/0x8*(-parseInt(_0x234182(0x1b1))/0x9)+parseInt(_0x234182(0x1b7))/0xa;if(_0x31d304===_0x2435b5)break;else _0x3d7fa9['push'](_0x3d7fa9['shift']());}catch(_0x242ffc){_0x3d7fa9['push'](_0x3d7fa9['shift']());}}}(a70_0x1222,0xbe68a));function a70_0x1222(){const _0x455e11=['JOB_LOG_DETAILS_FILENAME','NotFoundError','defineProperty','../../shared/utils/fs.utils','8HukNjf','then','getJobsIds','parse','search','apply','(((.+)+)+)+$','../job/classes/manifest-manager','../../../constants/job','getJobLog','getJobState','JOB_PATH','4304013CnbZkF','Job\x20log\x20not\x20found.','readFile','isExistsPath','setError','utf-8','default','catch','6aVqekK','init','toString','1062397DuQGcz','8kSvnzO','join','13659921jjdHEg','constructor','__esModule','810987YIVJut','create','push','7164050duljjz','dataPath','3517295RzeANm','__importDefault','../../../configs/path','517558DoAKAh','../../shared/utils/job.utils','generateJobId','makeDir','path','slice','@flosum/utils','b2cFolder'];a70_0x1222=function(){return _0x455e11;};return a70_0x1222();}const a70_0x17beec=(function(){let _0x3a65d2=!![];return function(_0x51350d,_0x367f6e){const _0x2065f4=_0x3a65d2?function(){const _0x1ed99c=a70_0x5be4;if(_0x367f6e){const _0x508087=_0x367f6e[_0x1ed99c(0x1cd)](_0x51350d,arguments);return _0x367f6e=null,_0x508087;}}:function(){};return _0x3a65d2=![],_0x2065f4;};}()),a70_0x2afd90=a70_0x17beec(this,function(){const _0x2b6439=a70_0x5be4;return a70_0x2afd90[_0x2b6439(0x1ad)]()[_0x2b6439(0x1cc)](_0x2b6439(0x1ce))[_0x2b6439(0x1ad)]()[_0x2b6439(0x1b2)](a70_0x2afd90)['search']('(((.+)+)+)+$');});a70_0x2afd90();'use strict';var __importDefault=this&&this[a70_0x4d0c14(0x1ba)]||function(_0x35a3da){const _0xe36dbf=a70_0x4d0c14;return _0x35a3da&&_0x35a3da[_0xe36dbf(0x1b3)]?_0x35a3da:{'default':_0x35a3da};};Object[a70_0x4d0c14(0x1c6)](exports,a70_0x4d0c14(0x1b3),{'value':!![]});const promises_1=require('fs/promises'),utils_1=require(a70_0x4d0c14(0x1c2)),not_found_error_1=require('../../../core/errors/not-found.error'),fs_utils_1=require(a70_0x4d0c14(0x1c7)),constants_1=require('../constants'),path_1=require(a70_0x4d0c14(0x1bb)),job_1=require(a70_0x4d0c14(0x1d0)),path_2=__importDefault(require(a70_0x4d0c14(0x1c0))),manifest_manager_1=__importDefault(require(a70_0x4d0c14(0x1cf))),state_manger_1=__importDefault(require('../../shared/managers/state-manger')),job_utils_1=__importDefault(require(a70_0x4d0c14(0x1bd))),csv_utils_1=__importDefault(require('../../shared/utils/csv.utils'));class B2CService{static async['createJob'](_0x288a72){const _0x128045=a70_0x4d0c14,_0x52e173=job_utils_1[_0x128045(0x1a9)][_0x128045(0x1be)](),_0x23a300=path_2[_0x128045(0x1a9)][_0x128045(0x1b0)](B2CService[_0x128045(0x1c3)],_0x52e173);await(0x0,fs_utils_1[_0x128045(0x1bf)])(_0x23a300),await manifest_manager_1[_0x128045(0x1a9)][_0x128045(0x1b5)](_0x23a300,_0x288a72),await state_manger_1[_0x128045(0x1a9)]['create'](_0x23a300,_0x52e173);const _0x5c35b9=path_2[_0x128045(0x1a9)]['join'](__dirname,job_1[_0x128045(0x1d3)]);return job_utils_1[_0x128045(0x1a9)]['runJob'](_0x5c35b9,{'jobStorePath':_0x23a300,'jobId':_0x52e173})[_0x128045(0x1aa)](async _0x5ff962=>{const _0x5069c2=_0x128045,_0x45d24b=new state_manger_1[(_0x5069c2(0x1a9))](_0x23a300);await _0x45d24b[_0x5069c2(0x1ac)](),await _0x45d24b[_0x5069c2(0x1a7)](_0x5ff962);}),{'jobId':_0x52e173};}static async['getJobs'](_0x2efec6,_0x31fa9a){const _0xeb21ba=a70_0x4d0c14,_0x5c7385=await job_utils_1[_0xeb21ba(0x1a9)][_0xeb21ba(0x1ca)](B2CService['b2cFolder']),_0x27aa18=await job_utils_1[_0xeb21ba(0x1a9)]['sortJobsIds'](B2CService[_0xeb21ba(0x1c3)],_0x5c7385),_0x10bd53=_0x27aa18[_0xeb21ba(0x1c1)](_0x31fa9a,_0x31fa9a+_0x2efec6),_0x2b1a90=[];for(const _0x4c9f37 of _0x10bd53){const _0x2b3fde=await state_manger_1[_0xeb21ba(0x1a9)]['getJobState'](path_2[_0xeb21ba(0x1a9)][_0xeb21ba(0x1b0)](B2CService['b2cFolder'],_0x4c9f37));_0x2b1a90[_0xeb21ba(0x1b6)](_0x2b3fde);}return _0x2b1a90;}static async['getJobStatus'](_0x2f3d76){const _0x11e3ee=a70_0x4d0c14;try{return state_manger_1[_0x11e3ee(0x1a9)][_0x11e3ee(0x1d2)](path_2['default'][_0x11e3ee(0x1b0)](B2CService[_0x11e3ee(0x1c3)],_0x2f3d76));}catch(_0xfb4c4c){throw new not_found_error_1[(_0x11e3ee(0x1c5))](_0xfb4c4c);}}static async[a70_0x4d0c14(0x1d1)](_0x273e1c){const _0x2fe5f1=a70_0x4d0c14,_0x2205b4=path_2[_0x2fe5f1(0x1a9)][_0x2fe5f1(0x1b0)](B2CService[_0x2fe5f1(0x1c3)],_0x273e1c,job_1[_0x2fe5f1(0x1c4)]);if(await utils_1['FsUtils'][_0x2fe5f1(0x1a6)](_0x2205b4))return(0x0,promises_1[_0x2fe5f1(0x1a5)])(_0x2205b4,{'encoding':_0x2fe5f1(0x1a8)})[_0x2fe5f1(0x1c9)](_0xb4db26=>csv_utils_1[_0x2fe5f1(0x1a9)][_0x2fe5f1(0x1cb)](_0xb4db26,{'columns':!![]}));throw new not_found_error_1['NotFoundError'](_0x2fe5f1(0x1d5));}}exports[a70_0x4d0c14(0x1a9)]=B2CService,B2CService[a70_0x4d0c14(0x1c3)]=path_2[a70_0x4d0c14(0x1a9)][a70_0x4d0c14(0x1b0)](path_1[a70_0x4d0c14(0x1b8)],constants_1['B2C_FOLDER_NAME']);