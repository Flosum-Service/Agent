const a69_0x1361c0=a69_0x52de;function a69_0x1eb3(){const _0x335421=['init','cartridges','../../shared/utils/fs.utils','__esModule','toString','(((.+)+)+)+$','../../../configs/path','defineProperty','utf-8','create','5pTIFDn','FsUtils','fs/promises','../job/classes/manifest-manager','../constants','join','isExistsPath','2725916TlYSHq','search','../../shared/utils/csv.utils','NotFoundError','then','439353KymcDj','slice','11076996aWgQHJ','dataPath','sortJobsIds','getJobLog','934685QXosIa','__importDefault','6513474jSkwnw','22QfKNrb','Job\x20log\x20not\x20found.','b2cFolder','makeDir','4700730OSGJdD','setError','JOB_LOG_DETAILS_FILENAME','getJobState','../../../constants/job','getJobStatus','constructor','../../shared/managers/state-manger','default','generateJobId','10509070aFFkvi','getJobs','224pXabNv','2XUbIqp','@flosum/utils','runJob','catch'];a69_0x1eb3=function(){return _0x335421;};return a69_0x1eb3();}(function(_0x101f3e,_0xe9b551){const _0x3e01fd=a69_0x52de,_0x38f1f0=_0x101f3e();while(!![]){try{const _0x2ae9ea=-parseInt(_0x3e01fd(0x89))/0x1*(-parseInt(_0x3e01fd(0x9d))/0x2)+-parseInt(_0x3e01fd(0x90))/0x3+-parseInt(_0x3e01fd(0x7e))/0x4*(-parseInt(_0x3e01fd(0x77))/0x5)+-parseInt(_0x3e01fd(0x8b))/0x6+-parseInt(_0x3e01fd(0x85))/0x7+parseInt(_0x3e01fd(0x9c))/0x8*(parseInt(_0x3e01fd(0x83))/0x9)+-parseInt(_0x3e01fd(0x9a))/0xa*(-parseInt(_0x3e01fd(0x8c))/0xb);if(_0x2ae9ea===_0xe9b551)break;else _0x38f1f0['push'](_0x38f1f0['shift']());}catch(_0x171a83){_0x38f1f0['push'](_0x38f1f0['shift']());}}}(a69_0x1eb3,0xcf811));const a69_0x27ca90=(function(){let _0x1effed=!![];return function(_0x5e5a1b,_0x526a0f){const _0x40c564=_0x1effed?function(){if(_0x526a0f){const _0x25d57b=_0x526a0f['apply'](_0x5e5a1b,arguments);return _0x526a0f=null,_0x25d57b;}}:function(){};return _0x1effed=![],_0x40c564;};}()),a69_0x5203bd=a69_0x27ca90(this,function(){const _0x118fdd=a69_0x52de;return a69_0x5203bd[_0x118fdd(0x71)]()[_0x118fdd(0x7f)](_0x118fdd(0x72))['toString']()[_0x118fdd(0x96)](a69_0x5203bd)[_0x118fdd(0x7f)]('(((.+)+)+)+$');});function a69_0x52de(_0x4262de,_0x5eb302){const _0x1deb3e=a69_0x1eb3();return a69_0x52de=function(_0x5203bd,_0x27ca90){_0x5203bd=_0x5203bd-0x6a;let _0x1eb3b1=_0x1deb3e[_0x5203bd];return _0x1eb3b1;},a69_0x52de(_0x4262de,_0x5eb302);}a69_0x5203bd();'use strict';var __importDefault=this&&this[a69_0x1361c0(0x8a)]||function(_0x4ebfba){return _0x4ebfba&&_0x4ebfba['__esModule']?_0x4ebfba:{'default':_0x4ebfba};};Object[a69_0x1361c0(0x74)](exports,a69_0x1361c0(0x70),{'value':!![]});const promises_1=require(a69_0x1361c0(0x79)),utils_1=require(a69_0x1361c0(0x6a)),not_found_error_1=require('../../../core/errors/not-found.error'),fs_utils_1=require(a69_0x1361c0(0x6f)),constants_1=require(a69_0x1361c0(0x7b)),path_1=require(a69_0x1361c0(0x73)),job_1=require(a69_0x1361c0(0x94)),path_2=__importDefault(require('path')),manifest_manager_1=__importDefault(require(a69_0x1361c0(0x7a))),state_manger_1=__importDefault(require(a69_0x1361c0(0x97))),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),csv_utils_1=__importDefault(require(a69_0x1361c0(0x80)));class B2CService{static async['createJob'](_0x297b9c){const _0x4c3c2f=a69_0x1361c0,_0x268f6a=job_utils_1['default'][_0x4c3c2f(0x99)](),_0x3043df=path_2[_0x4c3c2f(0x98)][_0x4c3c2f(0x7c)](B2CService[_0x4c3c2f(0x8e)],_0x268f6a);await(0x0,fs_utils_1[_0x4c3c2f(0x8f)])(_0x3043df),await manifest_manager_1[_0x4c3c2f(0x98)][_0x4c3c2f(0x76)](_0x3043df,_0x297b9c),await state_manger_1[_0x4c3c2f(0x98)][_0x4c3c2f(0x76)](_0x3043df,_0x268f6a);const _0x4638f0=path_2[_0x4c3c2f(0x98)][_0x4c3c2f(0x7c)](__dirname,job_1['JOB_PATH']);return job_utils_1['default'][_0x4c3c2f(0x6b)](_0x4638f0,{'jobStorePath':_0x3043df,'jobId':_0x268f6a})[_0x4c3c2f(0x6c)](async _0x5bdae2=>{const _0x551a78=_0x4c3c2f,_0x52dc65=new state_manger_1[(_0x551a78(0x98))](_0x3043df);await _0x52dc65[_0x551a78(0x6d)](),await _0x52dc65[_0x551a78(0x91)](_0x5bdae2);})['finally'](async()=>{const _0x2e0510=_0x4c3c2f,_0x37627f=path_2[_0x2e0510(0x98)][_0x2e0510(0x7c)](_0x3043df,_0x2e0510(0x6e));await(0x0,promises_1['rm'])(_0x37627f,{'recursive':!![],'force':!![]});}),{'jobId':_0x268f6a};}static async[a69_0x1361c0(0x9b)](_0x5bf30c,_0x2f83cf){const _0x5b4402=a69_0x1361c0,_0x10f73e=await job_utils_1[_0x5b4402(0x98)]['getJobsIds'](B2CService[_0x5b4402(0x8e)]),_0x371941=await job_utils_1[_0x5b4402(0x98)][_0x5b4402(0x87)](B2CService['b2cFolder'],_0x10f73e),_0x160e33=_0x371941[_0x5b4402(0x84)](_0x2f83cf,_0x2f83cf+_0x5bf30c),_0x931b2=[];for(const _0x5c3ba3 of _0x160e33){const _0x57df9b=await state_manger_1[_0x5b4402(0x98)][_0x5b4402(0x93)](path_2[_0x5b4402(0x98)][_0x5b4402(0x7c)](B2CService[_0x5b4402(0x8e)],_0x5c3ba3));_0x931b2['push'](_0x57df9b);}return _0x931b2;}static async[a69_0x1361c0(0x95)](_0x2958b1){const _0xa3d57c=a69_0x1361c0;try{return state_manger_1[_0xa3d57c(0x98)][_0xa3d57c(0x93)](path_2[_0xa3d57c(0x98)]['join'](B2CService[_0xa3d57c(0x8e)],_0x2958b1));}catch(_0x4c3384){throw new not_found_error_1[(_0xa3d57c(0x81))](_0x4c3384);}}static async[a69_0x1361c0(0x88)](_0x5a2771){const _0x8bb482=a69_0x1361c0,_0xd7eae8=path_2[_0x8bb482(0x98)][_0x8bb482(0x7c)](B2CService[_0x8bb482(0x8e)],_0x5a2771,job_1[_0x8bb482(0x92)]);if(await utils_1[_0x8bb482(0x78)][_0x8bb482(0x7d)](_0xd7eae8))return(0x0,promises_1['readFile'])(_0xd7eae8,_0x8bb482(0x75))[_0x8bb482(0x82)](_0x3edf7e=>csv_utils_1[_0x8bb482(0x98)]['parse'](_0x3edf7e,{'columns':!![]}));throw new not_found_error_1[(_0x8bb482(0x81))](_0x8bb482(0x8d));}}exports[a69_0x1361c0(0x98)]=B2CService,B2CService[a69_0x1361c0(0x8e)]=path_2[a69_0x1361c0(0x98)][a69_0x1361c0(0x7c)](path_1[a69_0x1361c0(0x86)],constants_1['B2C_FOLDER_NAME']);