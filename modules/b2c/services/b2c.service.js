const a69_0x521c77=a69_0x927b;function a69_0x927b(_0x4a1f90,_0x50d559){const _0x4e0d3c=a69_0x2223();return a69_0x927b=function(_0x4fcb87,_0x5149e1){_0x4fcb87=_0x4fcb87-0x1c3;let _0x2223d1=_0x4e0d3c[_0x4fcb87];return _0x2223d1;},a69_0x927b(_0x4a1f90,_0x50d559);}function a69_0x2223(){const _0x4af3c6=['defineProperty','fs/promises','__importDefault','6XtLKZp','../../../core/errors/not-found.error','slice','316737kTbDti','24msUBeV','search','../constants','utf-8','isExistsPath','finally','../../shared/managers/state-manger','B2C_FOLDER_NAME','getJobs','(((.+)+)+)+$','createJob','sortJobsIds','Job\x20log\x20not\x20found.','join','getJobLog','b2cFolder','setError','parse','dataPath','../../../constants/job','../job/classes/manifest-manager','cartridges','446lCGGmK','702572eiuNAi','getJobStatus','../../shared/utils/csv.utils','../../shared/utils/job.utils','486990ZYjyXl','default','catch','../../shared/utils/fs.utils','1606270fKMjUM','5267412zGaEZN','NotFoundError','332vxdSwF','push','@flosum/utils','apply','init','create','__esModule','path','2454295rQziyp','getJobState','makeDir','readFile'];a69_0x2223=function(){return _0x4af3c6;};return a69_0x2223();}(function(_0x43b400,_0x5d7059){const _0x41334b=a69_0x927b,_0x54b01e=_0x43b400();while(!![]){try{const _0xff2ef9=-parseInt(_0x41334b(0x1d7))/0x1*(-parseInt(_0x41334b(0x1e3))/0x2)+parseInt(_0x41334b(0x1f5))/0x3+parseInt(_0x41334b(0x1d8))/0x4+-parseInt(_0x41334b(0x1eb))/0x5*(-parseInt(_0x41334b(0x1f2))/0x6)+parseInt(_0x41334b(0x1dc))/0x7*(parseInt(_0x41334b(0x1f6))/0x8)+-parseInt(_0x41334b(0x1e1))/0x9+-parseInt(_0x41334b(0x1e0))/0xa;if(_0xff2ef9===_0x5d7059)break;else _0x54b01e['push'](_0x54b01e['shift']());}catch(_0x41fed0){_0x54b01e['push'](_0x54b01e['shift']());}}}(a69_0x2223,0x4b6c4));const a69_0x5149e1=(function(){let _0x301b3f=!![];return function(_0x17ffbe,_0x320ed8){const _0x428aab=_0x301b3f?function(){const _0xb35aef=a69_0x927b;if(_0x320ed8){const _0xe07542=_0x320ed8[_0xb35aef(0x1e6)](_0x17ffbe,arguments);return _0x320ed8=null,_0xe07542;}}:function(){};return _0x301b3f=![],_0x428aab;};}()),a69_0x4fcb87=a69_0x5149e1(this,function(){const _0x1b1a38=a69_0x927b;return a69_0x4fcb87['toString']()[_0x1b1a38(0x1f7)]('(((.+)+)+)+$')['toString']()['constructor'](a69_0x4fcb87)[_0x1b1a38(0x1f7)](_0x1b1a38(0x1ca));});a69_0x4fcb87();'use strict';var __importDefault=this&&this[a69_0x521c77(0x1f1)]||function(_0x4e7363){const _0x5f4b1e=a69_0x521c77;return _0x4e7363&&_0x4e7363[_0x5f4b1e(0x1e9)]?_0x4e7363:{'default':_0x4e7363};};Object[a69_0x521c77(0x1ef)](exports,a69_0x521c77(0x1e9),{'value':!![]});const promises_1=require(a69_0x521c77(0x1f0)),utils_1=require(a69_0x521c77(0x1e5)),not_found_error_1=require(a69_0x521c77(0x1f3)),fs_utils_1=require(a69_0x521c77(0x1df)),constants_1=require(a69_0x521c77(0x1c3)),path_1=require('../../../configs/path'),job_1=require(a69_0x521c77(0x1d4)),path_2=__importDefault(require(a69_0x521c77(0x1ea))),manifest_manager_1=__importDefault(require(a69_0x521c77(0x1d5))),state_manger_1=__importDefault(require(a69_0x521c77(0x1c7))),job_utils_1=__importDefault(require(a69_0x521c77(0x1db))),csv_utils_1=__importDefault(require(a69_0x521c77(0x1da)));class B2CService{static async[a69_0x521c77(0x1cb)](_0x2595fe){const _0x51d794=a69_0x521c77,_0xdc15c8=job_utils_1[_0x51d794(0x1dd)]['generateJobId'](),_0x509cc8=path_2[_0x51d794(0x1dd)][_0x51d794(0x1ce)](B2CService[_0x51d794(0x1d0)],_0xdc15c8);await(0x0,fs_utils_1[_0x51d794(0x1ed)])(_0x509cc8),await manifest_manager_1['default'][_0x51d794(0x1e8)](_0x509cc8,_0x2595fe),await state_manger_1[_0x51d794(0x1dd)][_0x51d794(0x1e8)](_0x509cc8,_0xdc15c8);const _0x1faab5=path_2[_0x51d794(0x1dd)][_0x51d794(0x1ce)](__dirname,job_1['JOB_PATH']);return job_utils_1['default']['runJob'](_0x1faab5,{'jobStorePath':_0x509cc8,'jobId':_0xdc15c8})[_0x51d794(0x1de)](async _0x722098=>{const _0x2e62c9=_0x51d794,_0x40123c=new state_manger_1['default'](_0x509cc8);await _0x40123c[_0x2e62c9(0x1e7)](),await _0x40123c[_0x2e62c9(0x1d1)](_0x722098);})[_0x51d794(0x1c6)](async()=>{const _0x40f99b=_0x51d794,_0x4337ca=path_2[_0x40f99b(0x1dd)][_0x40f99b(0x1ce)](_0x509cc8,_0x40f99b(0x1d6));await(0x0,promises_1['rm'])(_0x4337ca,{'recursive':!![],'force':!![]});}),{'jobId':_0xdc15c8};}static async[a69_0x521c77(0x1c9)](_0x52c97b,_0x2d6c84){const _0x5496aa=a69_0x521c77,_0x49d739=await job_utils_1['default']['getJobsIds'](B2CService[_0x5496aa(0x1d0)]),_0x1a74b7=await job_utils_1[_0x5496aa(0x1dd)][_0x5496aa(0x1cc)](B2CService[_0x5496aa(0x1d0)],_0x49d739),_0x2e554f=_0x1a74b7[_0x5496aa(0x1f4)](_0x2d6c84,_0x2d6c84+_0x52c97b),_0x508d5f=[];for(const _0xcea8af of _0x2e554f){const _0x3177fb=await state_manger_1[_0x5496aa(0x1dd)][_0x5496aa(0x1ec)](path_2[_0x5496aa(0x1dd)][_0x5496aa(0x1ce)](B2CService[_0x5496aa(0x1d0)],_0xcea8af));_0x508d5f[_0x5496aa(0x1e4)](_0x3177fb);}return _0x508d5f;}static async[a69_0x521c77(0x1d9)](_0x5b6004){const _0x5bb224=a69_0x521c77;try{return state_manger_1[_0x5bb224(0x1dd)][_0x5bb224(0x1ec)](path_2['default'][_0x5bb224(0x1ce)](B2CService[_0x5bb224(0x1d0)],_0x5b6004));}catch(_0x184fb6){throw new not_found_error_1[(_0x5bb224(0x1e2))](_0x184fb6);}}static async[a69_0x521c77(0x1cf)](_0x4cd72b){const _0x46edb1=a69_0x521c77,_0x478d07=path_2[_0x46edb1(0x1dd)][_0x46edb1(0x1ce)](B2CService[_0x46edb1(0x1d0)],_0x4cd72b,job_1['JOB_LOG_DETAILS_FILENAME']);if(await utils_1['FsUtils'][_0x46edb1(0x1c5)](_0x478d07))return(0x0,promises_1[_0x46edb1(0x1ee)])(_0x478d07,_0x46edb1(0x1c4))['then'](_0x310dbd=>csv_utils_1[_0x46edb1(0x1dd)][_0x46edb1(0x1d2)](_0x310dbd,{'columns':!![]}));throw new not_found_error_1['NotFoundError'](_0x46edb1(0x1cd));}}exports[a69_0x521c77(0x1dd)]=B2CService,B2CService['b2cFolder']=path_2[a69_0x521c77(0x1dd)][a69_0x521c77(0x1ce)](path_1[a69_0x521c77(0x1d3)],constants_1[a69_0x521c77(0x1c8)]);