const a69_0x2e21ca=a69_0xd1d7;(function(_0x5e4ca8,_0x46ae03){const _0x3184bf=a69_0xd1d7,_0x258d78=_0x5e4ca8();while(!![]){try{const _0x2335c8=parseInt(_0x3184bf(0x181))/0x1+parseInt(_0x3184bf(0x173))/0x2+-parseInt(_0x3184bf(0x17f))/0x3*(parseInt(_0x3184bf(0x191))/0x4)+parseInt(_0x3184bf(0x176))/0x5*(parseInt(_0x3184bf(0x188))/0x6)+-parseInt(_0x3184bf(0x197))/0x7+parseInt(_0x3184bf(0x18a))/0x8*(-parseInt(_0x3184bf(0x182))/0x9)+parseInt(_0x3184bf(0x179))/0xa*(parseInt(_0x3184bf(0x16e))/0xb);if(_0x2335c8===_0x46ae03)break;else _0x258d78['push'](_0x258d78['shift']());}catch(_0x520d68){_0x258d78['push'](_0x258d78['shift']());}}}(a69_0x5781,0x91f8d));const a69_0x5bdafd=(function(){let _0x2c8203=!![];return function(_0x5c00cd,_0x4ba46c){const _0x385f7b=_0x2c8203?function(){if(_0x4ba46c){const _0x3419b7=_0x4ba46c['apply'](_0x5c00cd,arguments);return _0x4ba46c=null,_0x3419b7;}}:function(){};return _0x2c8203=![],_0x385f7b;};}()),a69_0x1e0587=a69_0x5bdafd(this,function(){const _0x2507b5=a69_0xd1d7;return a69_0x1e0587['toString']()[_0x2507b5(0x193)]('(((.+)+)+)+$')['toString']()[_0x2507b5(0x172)](a69_0x1e0587)[_0x2507b5(0x193)](_0x2507b5(0x175));});a69_0x1e0587();'use strict';var __importDefault=this&&this[a69_0x2e21ca(0x17c)]||function(_0x343db2){const _0x3e214c=a69_0x2e21ca;return _0x343db2&&_0x343db2[_0x3e214c(0x194)]?_0x343db2:{'default':_0x343db2};};function a69_0x5781(){const _0x404253=['constructor','1213060rdUwpH','parse','(((.+)+)+)+$','115BcdTUN','NotFoundError','create','40JGDGOE','getJobs','../constants','__importDefault','getJobLog','getJobState','408tQfMVH','dataPath','767577VNHaHq','3940803EXGehF','../../../configs/path','../../shared/utils/fs.utils','join','createJob','b2cFolder','45690gZBLXm','JOB_PATH','8EPjzCa','@flosum/utils','getJobsIds','runJob','init','../../shared/utils/job.utils','makeDir','23516XidnPQ','default','search','__esModule','../../../core/errors/not-found.error','isExistsPath','3893288wSTOUK','getJobStatus','JOB_LOG_DETAILS_FILENAME','2316171mAmrsC','sortJobsIds','catch','utf-8'];a69_0x5781=function(){return _0x404253;};return a69_0x5781();}function a69_0xd1d7(_0x387d75,_0x1a756f){const _0x3476cb=a69_0x5781();return a69_0xd1d7=function(_0x1e0587,_0x5bdafd){_0x1e0587=_0x1e0587-0x16d;let _0x578120=_0x3476cb[_0x1e0587];return _0x578120;},a69_0xd1d7(_0x387d75,_0x1a756f);}Object['defineProperty'](exports,a69_0x2e21ca(0x194),{'value':!![]});const promises_1=require('fs/promises'),utils_1=require(a69_0x2e21ca(0x18b)),not_found_error_1=require(a69_0x2e21ca(0x195)),fs_utils_1=require(a69_0x2e21ca(0x184)),constants_1=require(a69_0x2e21ca(0x17b)),path_1=require(a69_0x2e21ca(0x183)),job_1=require('../../../constants/job'),path_2=__importDefault(require('path')),manifest_manager_1=__importDefault(require('../job/classes/manifest-manager')),state_manger_1=__importDefault(require('../../shared/managers/state-manger')),job_utils_1=__importDefault(require(a69_0x2e21ca(0x18f))),csv_utils_1=__importDefault(require('../../shared/utils/csv.utils'));class B2CService{static async[a69_0x2e21ca(0x186)](_0x13b9d4){const _0x2aaed4=a69_0x2e21ca,_0x5bcc0e=job_utils_1[_0x2aaed4(0x192)]['generateJobId'](),_0x4defce=path_2[_0x2aaed4(0x192)][_0x2aaed4(0x185)](B2CService[_0x2aaed4(0x187)],_0x5bcc0e);await(0x0,fs_utils_1[_0x2aaed4(0x190)])(_0x4defce),await manifest_manager_1['default'][_0x2aaed4(0x178)](_0x4defce,_0x13b9d4),await state_manger_1[_0x2aaed4(0x192)][_0x2aaed4(0x178)](_0x4defce,_0x5bcc0e);const _0xeb2e07=path_2['default'][_0x2aaed4(0x185)](__dirname,job_1[_0x2aaed4(0x189)]);return job_utils_1[_0x2aaed4(0x192)][_0x2aaed4(0x18d)](_0xeb2e07,{'jobStorePath':_0x4defce,'jobId':_0x5bcc0e})[_0x2aaed4(0x170)](async _0x554eab=>{const _0x578267=_0x2aaed4,_0x46f092=new state_manger_1[(_0x578267(0x192))](_0x4defce);await _0x46f092[_0x578267(0x18e)](),await _0x46f092['setError'](_0x554eab);}),{'jobId':_0x5bcc0e};}static async[a69_0x2e21ca(0x17a)](_0x43e1bd,_0x5d7197){const _0x3ea257=a69_0x2e21ca,_0x50f9ad=await job_utils_1['default'][_0x3ea257(0x18c)](B2CService[_0x3ea257(0x187)]),_0xc403fe=await job_utils_1[_0x3ea257(0x192)][_0x3ea257(0x16f)](B2CService[_0x3ea257(0x187)],_0x50f9ad),_0x36d724=_0xc403fe['slice'](_0x5d7197,_0x5d7197+_0x43e1bd),_0x359259=[];for(const _0x52fc26 of _0x36d724){const _0x311ebd=await state_manger_1[_0x3ea257(0x192)]['getJobState'](path_2[_0x3ea257(0x192)]['join'](B2CService[_0x3ea257(0x187)],_0x52fc26));_0x359259['push'](_0x311ebd);}return _0x359259;}static async[a69_0x2e21ca(0x198)](_0x26957f){const _0x320b50=a69_0x2e21ca;try{return state_manger_1['default'][_0x320b50(0x17e)](path_2[_0x320b50(0x192)][_0x320b50(0x185)](B2CService['b2cFolder'],_0x26957f));}catch(_0x3af4c8){throw new not_found_error_1[(_0x320b50(0x177))](_0x3af4c8);}}static async[a69_0x2e21ca(0x17d)](_0x10c7c2){const _0x58e7e0=a69_0x2e21ca,_0x46e4dc=path_2[_0x58e7e0(0x192)][_0x58e7e0(0x185)](B2CService[_0x58e7e0(0x187)],_0x10c7c2,job_1[_0x58e7e0(0x16d)]);if(await utils_1['FsUtils'][_0x58e7e0(0x196)](_0x46e4dc))return(0x0,promises_1['readFile'])(_0x46e4dc,_0x58e7e0(0x171))['then'](_0x27c607=>csv_utils_1[_0x58e7e0(0x192)][_0x58e7e0(0x174)](_0x27c607,{'columns':!![]}));throw new not_found_error_1[(_0x58e7e0(0x177))]('Job\x20log\x20not\x20found.');}}exports[a69_0x2e21ca(0x192)]=B2CService,B2CService['b2cFolder']=path_2[a69_0x2e21ca(0x192)][a69_0x2e21ca(0x185)](path_1[a69_0x2e21ca(0x180)],constants_1['B2C_FOLDER_NAME']);