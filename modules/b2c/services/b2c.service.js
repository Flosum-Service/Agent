const a67_0x1feb09=a67_0x3906;(function(_0x32d1a1,_0x1e7de9){const _0x528e93=a67_0x3906,_0x3d69ab=_0x32d1a1();while(!![]){try{const _0x35cde0=parseInt(_0x528e93(0x1af))/0x1*(parseInt(_0x528e93(0x1a0))/0x2)+-parseInt(_0x528e93(0x1b4))/0x3*(parseInt(_0x528e93(0x18c))/0x4)+-parseInt(_0x528e93(0x194))/0x5+parseInt(_0x528e93(0x1a5))/0x6*(parseInt(_0x528e93(0x185))/0x7)+-parseInt(_0x528e93(0x197))/0x8+-parseInt(_0x528e93(0x192))/0x9*(-parseInt(_0x528e93(0x1b0))/0xa)+-parseInt(_0x528e93(0x1ab))/0xb*(parseInt(_0x528e93(0x18e))/0xc);if(_0x35cde0===_0x1e7de9)break;else _0x3d69ab['push'](_0x3d69ab['shift']());}catch(_0x46f1fd){_0x3d69ab['push'](_0x3d69ab['shift']());}}}(a67_0xe61c,0x8d7ff));const a67_0x131840=(function(){let _0x166e6e=!![];return function(_0x18e747,_0x5f561d){const _0x58500e=_0x166e6e?function(){const _0x502aab=a67_0x3906;if(_0x5f561d){const _0x21e2e2=_0x5f561d[_0x502aab(0x184)](_0x18e747,arguments);return _0x5f561d=null,_0x21e2e2;}}:function(){};return _0x166e6e=![],_0x58500e;};}()),a67_0x3d4e54=a67_0x131840(this,function(){const _0x3c1ff5=a67_0x3906;return a67_0x3d4e54[_0x3c1ff5(0x1aa)]()[_0x3c1ff5(0x19e)](_0x3c1ff5(0x1b7))['toString']()[_0x3c1ff5(0x188)](a67_0x3d4e54)['search'](_0x3c1ff5(0x1b7));});function a67_0xe61c(){const _0x8e206e=['B2C_FOLDER_NAME','12CdHbzG','default','path','utf-8','7982325RNmPOQ','__importDefault','369245ojhqKp','dataPath','getJobState','659496NeQekC','NotFoundError','__esModule','Job\x20log\x20not\x20found.','getJobs','then','generateJobId','search','../constants','515288AcldOA','fs/promises','../job/classes/manifest-manager','init','slice','631374TWAQnn','runJob','parse','../../shared/utils/csv.utils','catch','toString','12034286Vzjylo','getJobLog','sortJobsIds','create','1vioUCr','10UddXEU','FsUtils','isExistsPath','defineProperty','3pmPfnb','join','../../../core/errors/not-found.error','(((.+)+)+)+$','apply','63eWaRIm','createJob','readFile','constructor','b2cFolder','getJobStatus','JOB_PATH','1046940pDnJMG'];a67_0xe61c=function(){return _0x8e206e;};return a67_0xe61c();}a67_0x3d4e54();function a67_0x3906(_0xc49c30,_0x5d603f){const _0x3d8b11=a67_0xe61c();return a67_0x3906=function(_0x3d4e54,_0x131840){_0x3d4e54=_0x3d4e54-0x184;let _0xe61c9c=_0x3d8b11[_0x3d4e54];return _0xe61c9c;},a67_0x3906(_0xc49c30,_0x5d603f);}'use strict';var __importDefault=this&&this[a67_0x1feb09(0x193)]||function(_0x1f914f){return _0x1f914f&&_0x1f914f['__esModule']?_0x1f914f:{'default':_0x1f914f};};Object[a67_0x1feb09(0x1b3)](exports,a67_0x1feb09(0x199),{'value':!![]});const promises_1=require(a67_0x1feb09(0x1a1)),utils_1=require('@flosum/utils'),not_found_error_1=require(a67_0x1feb09(0x1b6)),fs_utils_1=require('../../shared/utils/fs.utils'),constants_1=require(a67_0x1feb09(0x19f)),path_1=require('../../../configs/path'),job_1=require('../../../constants/job'),path_2=__importDefault(require(a67_0x1feb09(0x190))),manifest_manager_1=__importDefault(require(a67_0x1feb09(0x1a2))),state_manger_1=__importDefault(require('../../shared/managers/state-manger')),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),csv_utils_1=__importDefault(require(a67_0x1feb09(0x1a8)));class B2CService{static async[a67_0x1feb09(0x186)](_0x8959fc){const _0x240613=a67_0x1feb09,_0x549af1=job_utils_1['default'][_0x240613(0x19d)](),_0x3a4565=path_2[_0x240613(0x18f)]['join'](B2CService[_0x240613(0x189)],_0x549af1);await(0x0,fs_utils_1['makeDir'])(_0x3a4565),await manifest_manager_1[_0x240613(0x18f)][_0x240613(0x1ae)](_0x3a4565,_0x8959fc),await state_manger_1[_0x240613(0x18f)][_0x240613(0x1ae)](_0x3a4565,_0x549af1);const _0x13de1e=path_2['default']['join'](__dirname,job_1[_0x240613(0x18b)]);return job_utils_1[_0x240613(0x18f)][_0x240613(0x1a6)](_0x13de1e,{'jobStorePath':_0x3a4565,'jobId':_0x549af1})[_0x240613(0x1a9)](async _0xfcee88=>{const _0x281f29=_0x240613,_0x139a2f=new state_manger_1[(_0x281f29(0x18f))](_0x3a4565);await _0x139a2f[_0x281f29(0x1a3)](),await _0x139a2f['setError'](_0xfcee88);}),{'jobId':_0x549af1};}static async[a67_0x1feb09(0x19b)](_0x4e94d2,_0x5bb3ee){const _0x3602d2=a67_0x1feb09,_0x549e2b=await job_utils_1['default']['getJobsIds'](B2CService['b2cFolder']),_0x386eb7=await job_utils_1['default'][_0x3602d2(0x1ad)](B2CService[_0x3602d2(0x189)],_0x549e2b),_0x4a7a32=_0x386eb7[_0x3602d2(0x1a4)](_0x5bb3ee,_0x5bb3ee+_0x4e94d2),_0x28722c=[];for(const _0xefae66 of _0x4a7a32){const _0x20b630=await state_manger_1[_0x3602d2(0x18f)][_0x3602d2(0x196)](path_2['default'][_0x3602d2(0x1b5)](B2CService['b2cFolder'],_0xefae66));_0x28722c['push'](_0x20b630);}return _0x28722c;}static async[a67_0x1feb09(0x18a)](_0xa2a0d2){const _0x2f3687=a67_0x1feb09;try{return state_manger_1[_0x2f3687(0x18f)]['getJobState'](path_2[_0x2f3687(0x18f)][_0x2f3687(0x1b5)](B2CService[_0x2f3687(0x189)],_0xa2a0d2));}catch(_0xb0a933){throw new not_found_error_1[(_0x2f3687(0x198))](_0xb0a933);}}static async[a67_0x1feb09(0x1ac)](_0x2eaefc){const _0x301d91=a67_0x1feb09,_0x5e9293=path_2[_0x301d91(0x18f)][_0x301d91(0x1b5)](B2CService[_0x301d91(0x189)],_0x2eaefc,job_1['JOB_LOG_DETAILS_FILENAME']);if(await utils_1[_0x301d91(0x1b1)][_0x301d91(0x1b2)](_0x5e9293))return(0x0,promises_1[_0x301d91(0x187)])(_0x5e9293,_0x301d91(0x191))[_0x301d91(0x19c)](_0x44166b=>csv_utils_1[_0x301d91(0x18f)][_0x301d91(0x1a7)](_0x44166b,{'columns':!![]}));throw new not_found_error_1[(_0x301d91(0x198))](_0x301d91(0x19a));}}exports[a67_0x1feb09(0x18f)]=B2CService,B2CService[a67_0x1feb09(0x189)]=path_2[a67_0x1feb09(0x18f)][a67_0x1feb09(0x1b5)](path_1[a67_0x1feb09(0x195)],constants_1[a67_0x1feb09(0x18d)]);