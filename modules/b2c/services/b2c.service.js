const a67_0x5b3f1e=a67_0x5adb;(function(_0x256c4a,_0x2b07d8){const _0x509219=a67_0x5adb,_0xb4e756=_0x256c4a();while(!![]){try{const _0x21b4ac=-parseInt(_0x509219(0x13b))/0x1*(parseInt(_0x509219(0x11d))/0x2)+-parseInt(_0x509219(0x139))/0x3+parseInt(_0x509219(0x145))/0x4+-parseInt(_0x509219(0x133))/0x5*(-parseInt(_0x509219(0x144))/0x6)+-parseInt(_0x509219(0x132))/0x7*(-parseInt(_0x509219(0x11e))/0x8)+-parseInt(_0x509219(0x128))/0x9*(parseInt(_0x509219(0x11c))/0xa)+-parseInt(_0x509219(0x12e))/0xb;if(_0x21b4ac===_0x2b07d8)break;else _0xb4e756['push'](_0xb4e756['shift']());}catch(_0x4d2e3e){_0xb4e756['push'](_0xb4e756['shift']());}}}(a67_0x504b,0x281e9));function a67_0x504b(){const _0x37c110=['__esModule','path','../../shared/utils/fs.utils','then','getJobsIds','6UbvPPe','686456eNXRkh','setError','default','__importDefault','48590zRdXXz','6RkVkqR','8200BiVxHy','../constants','../../../configs/path','generateJobId','catch','getJobs','FsUtils','utf-8','getJobLog','readFile','63UAwzQL','getJobState','../../shared/managers/state-manger','(((.+)+)+)+$','parse','defineProperty','2326621bfnTxM','push','sortJobsIds','search','1169WkcWfg','921615XTUBEs','isExistsPath','../../../constants/job','makeDir','NotFoundError','create','336909TdvPPD','init','1652CgbjQu','toString','b2cFolder','join'];a67_0x504b=function(){return _0x37c110;};return a67_0x504b();}const a67_0x3ff9d8=(function(){let _0x4aff07=!![];return function(_0x33a1b6,_0x53f7ee){const _0x2245b7=_0x4aff07?function(){if(_0x53f7ee){const _0x4250f5=_0x53f7ee['apply'](_0x33a1b6,arguments);return _0x53f7ee=null,_0x4250f5;}}:function(){};return _0x4aff07=![],_0x2245b7;};}()),a67_0x436cb7=a67_0x3ff9d8(this,function(){const _0x19187c=a67_0x5adb;return a67_0x436cb7[_0x19187c(0x13c)]()[_0x19187c(0x131)]('(((.+)+)+)+$')['toString']()['constructor'](a67_0x436cb7)[_0x19187c(0x131)](_0x19187c(0x12b));});a67_0x436cb7();'use strict';function a67_0x5adb(_0x9e5842,_0x44a564){const _0x512baa=a67_0x504b();return a67_0x5adb=function(_0x436cb7,_0x3ff9d8){_0x436cb7=_0x436cb7-0x11b;let _0x504bca=_0x512baa[_0x436cb7];return _0x504bca;},a67_0x5adb(_0x9e5842,_0x44a564);}var __importDefault=this&&this[a67_0x5b3f1e(0x11b)]||function(_0x4477cd){const _0x1beb6b=a67_0x5b3f1e;return _0x4477cd&&_0x4477cd[_0x1beb6b(0x13f)]?_0x4477cd:{'default':_0x4477cd};};Object[a67_0x5b3f1e(0x12d)](exports,'__esModule',{'value':!![]});const promises_1=require('fs/promises'),utils_1=require('@flosum/utils'),not_found_error_1=require('../../../core/errors/not-found.error'),fs_utils_1=require(a67_0x5b3f1e(0x141)),constants_1=require(a67_0x5b3f1e(0x11f)),path_1=require(a67_0x5b3f1e(0x120)),job_1=require(a67_0x5b3f1e(0x135)),path_2=__importDefault(require(a67_0x5b3f1e(0x140))),manifest_manager_1=__importDefault(require('../job/classes/manifest-manager')),state_manger_1=__importDefault(require(a67_0x5b3f1e(0x12a))),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),csv_utils_1=__importDefault(require('../../shared/utils/csv.utils'));class B2CService{static async['createJob'](_0xed0f){const _0x34dcbb=a67_0x5b3f1e,_0x39fb4b=job_utils_1[_0x34dcbb(0x147)][_0x34dcbb(0x121)](),_0x12c059=path_2[_0x34dcbb(0x147)][_0x34dcbb(0x13e)](B2CService[_0x34dcbb(0x13d)],_0x39fb4b);await(0x0,fs_utils_1[_0x34dcbb(0x136)])(_0x12c059),await manifest_manager_1[_0x34dcbb(0x147)]['create'](_0x12c059,_0xed0f),await state_manger_1[_0x34dcbb(0x147)][_0x34dcbb(0x138)](_0x12c059,_0x39fb4b);const _0x588ee2=path_2[_0x34dcbb(0x147)][_0x34dcbb(0x13e)](__dirname,job_1['JOB_PATH']);return job_utils_1[_0x34dcbb(0x147)]['runJob'](_0x588ee2,{'jobStorePath':_0x12c059,'jobId':_0x39fb4b})[_0x34dcbb(0x122)](async _0x3356da=>{const _0x3216f3=_0x34dcbb,_0x1d9875=new state_manger_1[(_0x3216f3(0x147))](_0x12c059);await _0x1d9875[_0x3216f3(0x13a)](),await _0x1d9875[_0x3216f3(0x146)](_0x3356da);}),{'jobId':_0x39fb4b};}static async[a67_0x5b3f1e(0x123)](_0x24bae1,_0x394ee9){const _0x233b45=a67_0x5b3f1e,_0x42798c=await job_utils_1['default'][_0x233b45(0x143)](B2CService[_0x233b45(0x13d)]),_0x3fbb36=await job_utils_1[_0x233b45(0x147)][_0x233b45(0x130)](B2CService[_0x233b45(0x13d)],_0x42798c),_0x331bc0=_0x3fbb36['slice'](_0x394ee9,_0x394ee9+_0x24bae1),_0x314d22=[];for(const _0x16c1c4 of _0x331bc0){const _0x5870d1=await state_manger_1[_0x233b45(0x147)][_0x233b45(0x129)](path_2[_0x233b45(0x147)][_0x233b45(0x13e)](B2CService[_0x233b45(0x13d)],_0x16c1c4));_0x314d22[_0x233b45(0x12f)](_0x5870d1);}return _0x314d22;}static async['getJobStatus'](_0x368762){const _0x38075f=a67_0x5b3f1e;try{return state_manger_1[_0x38075f(0x147)][_0x38075f(0x129)](path_2['default'][_0x38075f(0x13e)](B2CService[_0x38075f(0x13d)],_0x368762));}catch(_0x42c1b9){throw new not_found_error_1[(_0x38075f(0x137))](_0x42c1b9);}}static async[a67_0x5b3f1e(0x126)](_0x55a565){const _0x46cc96=a67_0x5b3f1e,_0x110635=path_2[_0x46cc96(0x147)][_0x46cc96(0x13e)](B2CService[_0x46cc96(0x13d)],_0x55a565,job_1['JOB_LOG_DETAILS_FILENAME']);if(await utils_1[_0x46cc96(0x124)][_0x46cc96(0x134)](_0x110635))return(0x0,promises_1[_0x46cc96(0x127)])(_0x110635,_0x46cc96(0x125))[_0x46cc96(0x142)](_0x2f59e1=>csv_utils_1[_0x46cc96(0x147)][_0x46cc96(0x12c)](_0x2f59e1,{'columns':!![]}));throw new not_found_error_1[(_0x46cc96(0x137))]('Job\x20log\x20not\x20found.');}}exports[a67_0x5b3f1e(0x147)]=B2CService,B2CService[a67_0x5b3f1e(0x13d)]=path_2[a67_0x5b3f1e(0x147)][a67_0x5b3f1e(0x13e)](path_1['dataPath'],constants_1['B2C_FOLDER_NAME']);