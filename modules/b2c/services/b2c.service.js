const a69_0x472b82=a69_0x2810;(function(_0x57411a,_0x10b6e4){const _0x109e65=a69_0x2810,_0x4f6ba3=_0x57411a();while(!![]){try{const _0x147b56=-parseInt(_0x109e65(0x171))/0x1*(-parseInt(_0x109e65(0x15b))/0x2)+-parseInt(_0x109e65(0x153))/0x3+parseInt(_0x109e65(0x168))/0x4*(parseInt(_0x109e65(0x151))/0x5)+parseInt(_0x109e65(0x14e))/0x6*(-parseInt(_0x109e65(0x14c))/0x7)+parseInt(_0x109e65(0x156))/0x8+-parseInt(_0x109e65(0x14d))/0x9*(-parseInt(_0x109e65(0x164))/0xa)+-parseInt(_0x109e65(0x159))/0xb;if(_0x147b56===_0x10b6e4)break;else _0x4f6ba3['push'](_0x4f6ba3['shift']());}catch(_0x43c48c){_0x4f6ba3['push'](_0x4f6ba3['shift']());}}}(a69_0x2e9a,0x4dc40));function a69_0x2810(_0xb32238,_0x43298e){const _0x246430=a69_0x2e9a();return a69_0x2810=function(_0x3b70cc,_0x2305bc){_0x3b70cc=_0x3b70cc-0x143;let _0x2e9a95=_0x246430[_0x3b70cc];return _0x2e9a95;},a69_0x2810(_0xb32238,_0x43298e);}function a69_0x2e9a(){const _0x163554=['then','createJob','5341490gpmHzj','parse','2AKpsOS','../job/classes/manifest-manager','constructor','makeDir','slice','default','NotFoundError','search','@flosum/utils','30GUcBZT','../../shared/utils/job.utils','defineProperty','../constants','8uOftlt','cartridges','__importDefault','b2cFolder','join','dataPath','setError','path','sortJobsIds','38371rxhWAD','init','readFile','create','JOB_PATH','isExistsPath','__esModule','getJobState','../../../constants/job','toString','../../../core/errors/not-found.error','../../shared/utils/csv.utils','catch','../../shared/utils/fs.utils','getJobsIds','FsUtils','10185ymboIy','816093eMwPwW','354mpPnDO','../../shared/managers/state-manger','push','627695ZZTbiF','apply','559773rGTDyJ','Job\x20log\x20not\x20found.','utf-8','4120592RfoAnu'];a69_0x2e9a=function(){return _0x163554;};return a69_0x2e9a();}const a69_0x2305bc=(function(){let _0x5a43f9=!![];return function(_0x16aa51,_0xf6ca56){const _0x2ad15f=_0x5a43f9?function(){const _0x302bc9=a69_0x2810;if(_0xf6ca56){const _0x35af46=_0xf6ca56[_0x302bc9(0x152)](_0x16aa51,arguments);return _0xf6ca56=null,_0x35af46;}}:function(){};return _0x5a43f9=![],_0x2ad15f;};}()),a69_0x3b70cc=a69_0x2305bc(this,function(){const _0x49333c=a69_0x2810;return a69_0x3b70cc[_0x49333c(0x145)]()[_0x49333c(0x162)]('(((.+)+)+)+$')[_0x49333c(0x145)]()[_0x49333c(0x15d)](a69_0x3b70cc)[_0x49333c(0x162)]('(((.+)+)+)+$');});a69_0x3b70cc();'use strict';var __importDefault=this&&this[a69_0x472b82(0x16a)]||function(_0xb96ba8){const _0x3fedb5=a69_0x472b82;return _0xb96ba8&&_0xb96ba8[_0x3fedb5(0x177)]?_0xb96ba8:{'default':_0xb96ba8};};Object[a69_0x472b82(0x166)](exports,a69_0x472b82(0x177),{'value':!![]});const promises_1=require('fs/promises'),utils_1=require(a69_0x472b82(0x163)),not_found_error_1=require(a69_0x472b82(0x146)),fs_utils_1=require(a69_0x472b82(0x149)),constants_1=require(a69_0x472b82(0x167)),path_1=require('../../../configs/path'),job_1=require(a69_0x472b82(0x144)),path_2=__importDefault(require(a69_0x472b82(0x16f))),manifest_manager_1=__importDefault(require(a69_0x472b82(0x15c))),state_manger_1=__importDefault(require(a69_0x472b82(0x14f))),job_utils_1=__importDefault(require(a69_0x472b82(0x165))),csv_utils_1=__importDefault(require(a69_0x472b82(0x147)));class B2CService{static async[a69_0x472b82(0x158)](_0x93fa47){const _0x336e8c=a69_0x472b82,_0x2e149e=job_utils_1[_0x336e8c(0x160)]['generateJobId'](),_0x3ff709=path_2[_0x336e8c(0x160)][_0x336e8c(0x16c)](B2CService[_0x336e8c(0x16b)],_0x2e149e);await(0x0,fs_utils_1[_0x336e8c(0x15e)])(_0x3ff709),await manifest_manager_1['default']['create'](_0x3ff709,_0x93fa47),await state_manger_1[_0x336e8c(0x160)][_0x336e8c(0x174)](_0x3ff709,_0x2e149e);const _0x4a7c94=path_2[_0x336e8c(0x160)][_0x336e8c(0x16c)](__dirname,job_1[_0x336e8c(0x175)]);return job_utils_1[_0x336e8c(0x160)]['runJob'](_0x4a7c94,{'jobStorePath':_0x3ff709,'jobId':_0x2e149e})[_0x336e8c(0x148)](async _0x2f0619=>{const _0x41c1fe=_0x336e8c,_0x472cba=new state_manger_1[(_0x41c1fe(0x160))](_0x3ff709);await _0x472cba[_0x41c1fe(0x172)](),await _0x472cba[_0x41c1fe(0x16e)](_0x2f0619);})['finally'](async()=>{const _0x406a17=_0x336e8c,_0x1dfb5a=path_2['default'][_0x406a17(0x16c)](_0x3ff709,_0x406a17(0x169));await(0x0,promises_1['rm'])(_0x1dfb5a,{'recursive':!![],'force':!![]});}),{'jobId':_0x2e149e};}static async['getJobs'](_0x50be19,_0x5f01dd){const _0x3f4057=a69_0x472b82,_0x242836=await job_utils_1[_0x3f4057(0x160)][_0x3f4057(0x14a)](B2CService['b2cFolder']),_0x436b8d=await job_utils_1['default'][_0x3f4057(0x170)](B2CService[_0x3f4057(0x16b)],_0x242836),_0x3878ac=_0x436b8d[_0x3f4057(0x15f)](_0x5f01dd,_0x5f01dd+_0x50be19),_0x153468=[];for(const _0x2a1248 of _0x3878ac){const _0x2ffebb=await state_manger_1[_0x3f4057(0x160)][_0x3f4057(0x143)](path_2['default'][_0x3f4057(0x16c)](B2CService[_0x3f4057(0x16b)],_0x2a1248));_0x153468[_0x3f4057(0x150)](_0x2ffebb);}return _0x153468;}static async['getJobStatus'](_0x33db1c){const _0x49c835=a69_0x472b82;try{return state_manger_1[_0x49c835(0x160)]['getJobState'](path_2[_0x49c835(0x160)][_0x49c835(0x16c)](B2CService['b2cFolder'],_0x33db1c));}catch(_0x597d48){throw new not_found_error_1[(_0x49c835(0x161))](_0x597d48);}}static async['getJobLog'](_0x389393){const _0xdfdbbd=a69_0x472b82,_0x68d9c=path_2[_0xdfdbbd(0x160)][_0xdfdbbd(0x16c)](B2CService[_0xdfdbbd(0x16b)],_0x389393,job_1['JOB_LOG_DETAILS_FILENAME']);if(await utils_1[_0xdfdbbd(0x14b)][_0xdfdbbd(0x176)](_0x68d9c))return(0x0,promises_1[_0xdfdbbd(0x173)])(_0x68d9c,_0xdfdbbd(0x155))[_0xdfdbbd(0x157)](_0x47495f=>csv_utils_1[_0xdfdbbd(0x160)][_0xdfdbbd(0x15a)](_0x47495f,{'columns':!![]}));throw new not_found_error_1[(_0xdfdbbd(0x161))](_0xdfdbbd(0x154));}}exports[a69_0x472b82(0x160)]=B2CService,B2CService['b2cFolder']=path_2[a69_0x472b82(0x160)]['join'](path_1[a69_0x472b82(0x16d)],constants_1['B2C_FOLDER_NAME']);