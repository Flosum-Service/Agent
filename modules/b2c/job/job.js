const a67_0x5bb2c2=a67_0x26da;(function(_0x552ff8,_0x33a6e5){const _0x25da16=a67_0x26da,_0x4ed1a0=_0x552ff8();while(!![]){try{const _0x5ab92c=-parseInt(_0x25da16(0x171))/0x1+parseInt(_0x25da16(0x14f))/0x2+parseInt(_0x25da16(0x17c))/0x3+parseInt(_0x25da16(0x163))/0x4*(parseInt(_0x25da16(0x185))/0x5)+-parseInt(_0x25da16(0x17a))/0x6*(-parseInt(_0x25da16(0x158))/0x7)+-parseInt(_0x25da16(0x182))/0x8+parseInt(_0x25da16(0x159))/0x9*(parseInt(_0x25da16(0x186))/0xa);if(_0x5ab92c===_0x33a6e5)break;else _0x4ed1a0['push'](_0x4ed1a0['shift']());}catch(_0x75c2ec){_0x4ed1a0['push'](_0x4ed1a0['shift']());}}}(a67_0x1182,0x74904));const a67_0x545465=(function(){let _0x50877f=!![];return function(_0x5a6a0f,_0x31302f){const _0x5edcd1=_0x50877f?function(){const _0x171fbb=a67_0x26da;if(_0x31302f){const _0x1fa92f=_0x31302f[_0x171fbb(0x183)](_0x5a6a0f,arguments);return _0x31302f=null,_0x1fa92f;}}:function(){};return _0x50877f=![],_0x5edcd1;};}()),a67_0x278db2=a67_0x545465(this,function(){const _0x2eee3b=a67_0x26da;return a67_0x278db2[_0x2eee3b(0x150)]()[_0x2eee3b(0x170)](_0x2eee3b(0x167))[_0x2eee3b(0x150)]()[_0x2eee3b(0x164)](a67_0x278db2)[_0x2eee3b(0x170)](_0x2eee3b(0x167));});a67_0x278db2();'use strict';var __importDefault=this&&this[a67_0x5bb2c2(0x15c)]||function(_0x33cc42){const _0x249892=a67_0x5bb2c2;return _0x33cc42&&_0x33cc42[_0x249892(0x156)]?_0x33cc42:{'default':_0x33cc42};};function a67_0x1182(){const _0x46bd20=['axiosInstance','setError','573556njsAHN','toString','some','FLOSUM_NAMESPACE','./classes/manifest-manager','deployCartridges','./classes/retrieve-sfra','__esModule','./classes/deploy-cartridges','73360ijjJDe','518895ZoZLtR','setCompleted','======\x20Retrieve\x20cartridges\x20','__importDefault','slice','exit','namespace','compileCartridges','retrieveSfra','======\x20Compile\x20cartridges\x20','14544AJxoZX','constructor','error','log','(((.+)+)+)+$','./classes/logger','./classes/compile-cartridges','jobId','Job','compile','codeVersion','env','AxiosInstanceUtils','search','678978IyxMmT','credentials','@flosum/salesforce','defineProperty','logger','init','activateCodeVersion','execute','catch','12tEJwLx','AuthManager','1375482nXwCZy','apiVersion','branchId','create','jobPath','Logger','3402352pCSgWn','apply','cartridges','170fmUCRk','120hTcqOw','B2C\x20job\x20has\x20been\x20failed.','padEnd','getManifestParameters','./classes/salesforce-auth','../../shared/managers/state-manger','retrieveCartridges','./classes/retrieve-cartridges','======\x20Retrieve\x20default\x20SFRA\x20','======\x20Deploy\x20cartridges\x20','message','argv','default'];a67_0x1182=function(){return _0x46bd20;};return a67_0x1182();}function a67_0x26da(_0x46da03,_0x380050){const _0x2377cc=a67_0x1182();return a67_0x26da=function(_0x278db2,_0x545465){_0x278db2=_0x278db2-0x143;let _0x118251=_0x2377cc[_0x278db2];return _0x118251;},a67_0x26da(_0x46da03,_0x380050);}Object[a67_0x5bb2c2(0x174)](exports,a67_0x5bb2c2(0x156),{'value':!![]}),exports[a67_0x5bb2c2(0x16b)]=void 0x0;const core_1=require('../../../core'),salesforce_1=require(a67_0x5bb2c2(0x173)),auth_manager_1=require('../../shared/managers/auth.manager'),constants_1=require('../constants'),minimist_1=__importDefault(require('minimist')),state_manger_1=__importDefault(require(a67_0x5bb2c2(0x145))),logger_1=__importDefault(require(a67_0x5bb2c2(0x168))),retrieve_sfra_1=__importDefault(require(a67_0x5bb2c2(0x155))),retrieve_cartridges_1=__importDefault(require(a67_0x5bb2c2(0x147))),compile_cartridges_1=__importDefault(require(a67_0x5bb2c2(0x169))),deploy_cartridges_1=__importDefault(require(a67_0x5bb2c2(0x157))),manifest_manager_1=__importDefault(require(a67_0x5bb2c2(0x153))),salesforce_auth_1=__importDefault(require(a67_0x5bb2c2(0x144)));class Job{constructor(){const _0xe61690=a67_0x5bb2c2,{jobId:_0x58bc06,jobStorePath:_0x9231d9}=(0x0,minimist_1['default'])(process[_0xe61690(0x14b)][_0xe61690(0x15d)](0x2));this[_0xe61690(0x180)]=_0x9231d9,this['jobId']=_0x58bc06;}async[a67_0x5bb2c2(0x178)](){const _0x2e8089=a67_0x5bb2c2,_0x3f3ed1=new core_1[(_0x2e8089(0x181))](this['jobId']);this[_0x2e8089(0x175)]=new logger_1['default'](this[_0x2e8089(0x16a)],_0x3f3ed1);const _0x4b08fe=await new state_manger_1[(_0x2e8089(0x14c))](this[_0x2e8089(0x180)])[_0x2e8089(0x176)]();await this[_0x2e8089(0x175)][_0x2e8089(0x166)]('B2C\x20job\x20has\x20been\x20started.');try{await _0x4b08fe['setInProgress'](),this[_0x2e8089(0x14d)]=await this['getAxiosInstance'](),this['namespace']=this['getFlosumNamespace'](),await this[_0x2e8089(0x143)](),await this[_0x2e8089(0x161)](),await this[_0x2e8089(0x146)](),this['cartridges'][_0x2e8089(0x151)](_0x49d7ea=>_0x49d7ea===null||_0x49d7ea===void 0x0?void 0x0:_0x49d7ea[_0x2e8089(0x16c)])&&await this[_0x2e8089(0x160)](),await this[_0x2e8089(0x154)](),await _0x4b08fe[_0x2e8089(0x15a)](),await this['logger'][_0x2e8089(0x166)]('B2C\x20job\x20has\x20been\x20completed.');}catch(_0x47d2d2){await _0x4b08fe[_0x2e8089(0x14e)](_0x47d2d2),await this[_0x2e8089(0x175)][_0x2e8089(0x165)](_0x47d2d2[_0x2e8089(0x14a)]),await this[_0x2e8089(0x175)][_0x2e8089(0x165)](_0x2e8089(0x187));}}async[a67_0x5bb2c2(0x143)](){const _0x13f9b5=a67_0x5bb2c2,{credentials:_0x50b273,apiVersion:_0xf5589d,branchId:_0x568a23,cartridges:_0x4bee0d,codeVersion:_0x4d2196,activateCodeVersion:_0x3fdf6f}=await new manifest_manager_1[(_0x13f9b5(0x14c))](this[_0x13f9b5(0x180)])['init']();this[_0x13f9b5(0x172)]=_0x50b273,this['apiVersion']=_0xf5589d,this['branchId']=_0x568a23,this[_0x13f9b5(0x184)]=_0x4bee0d,this[_0x13f9b5(0x16d)]=_0x4d2196,this['activateCodeVersion']=_0x3fdf6f;}async['getAxiosInstance'](){const _0x20931c=a67_0x5bb2c2,_0x5e6d4=await salesforce_auth_1['default']['getAuthDetails']();return salesforce_1[_0x20931c(0x16f)][_0x20931c(0x17f)](new auth_manager_1[(_0x20931c(0x17b))](_0x5e6d4),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a67_0x5bb2c2(0x146)](){const _0x3a5fd0=a67_0x5bb2c2;await this[_0x3a5fd0(0x175)][_0x3a5fd0(0x166)](_0x3a5fd0(0x15b)[_0x3a5fd0(0x188)](0x32,'=')),await new retrieve_cartridges_1[(_0x3a5fd0(0x14c))](this['jobPath'],this[_0x3a5fd0(0x14d)],this[_0x3a5fd0(0x17d)],this[_0x3a5fd0(0x15f)],this[_0x3a5fd0(0x17e)],this[_0x3a5fd0(0x184)],this[_0x3a5fd0(0x175)])[_0x3a5fd0(0x178)]();}async['retrieveSfra'](){const _0x4320ec=a67_0x5bb2c2;await this['logger'][_0x4320ec(0x166)](_0x4320ec(0x148)[_0x4320ec(0x188)](0x32,'=')),await new retrieve_sfra_1['default'](this[_0x4320ec(0x180)],this[_0x4320ec(0x14d)],this['apiVersion'],this[_0x4320ec(0x175)])[_0x4320ec(0x178)]();}async[a67_0x5bb2c2(0x160)](){const _0x32d93f=a67_0x5bb2c2;await this[_0x32d93f(0x175)][_0x32d93f(0x166)](_0x32d93f(0x162)[_0x32d93f(0x188)](0x32,'=')),await new compile_cartridges_1[(_0x32d93f(0x14c))](this[_0x32d93f(0x180)],this[_0x32d93f(0x184)],this[_0x32d93f(0x175)])[_0x32d93f(0x178)]();}async[a67_0x5bb2c2(0x154)](){const _0x5c9f79=a67_0x5bb2c2;await this['logger'][_0x5c9f79(0x166)](_0x5c9f79(0x149)[_0x5c9f79(0x188)](0x32,'=')),await new deploy_cartridges_1[(_0x5c9f79(0x14c))](this[_0x5c9f79(0x180)],this[_0x5c9f79(0x172)],this[_0x5c9f79(0x184)],this['codeVersion'],this[_0x5c9f79(0x177)],this[_0x5c9f79(0x175)])[_0x5c9f79(0x178)]();}['getFlosumNamespace'](){const _0x4c0d66=a67_0x5bb2c2;var _0x353503,_0x3cc5db;return((_0x3cc5db=(_0x353503=process[_0x4c0d66(0x16e)])===null||_0x353503===void 0x0?void 0x0:_0x353503['IGNORE_FLOSUM_NAMESPACE'])===null||_0x3cc5db===void 0x0?void 0x0:_0x3cc5db['toLowerCase']())==='true'?'':constants_1[_0x4c0d66(0x152)];}}exports['Job']=Job,new Job()[a67_0x5bb2c2(0x178)]()['then'](()=>process[a67_0x5bb2c2(0x15e)](0x0))[a67_0x5bb2c2(0x179)](()=>process[a67_0x5bb2c2(0x15e)](0x1));