const a68_0x5d0811=a68_0x2fa1;function a68_0x2fa1(_0x189d33,_0x51b346){const _0x34ec84=a68_0xab65();return a68_0x2fa1=function(_0x35a1c9,_0x17e598){_0x35a1c9=_0x35a1c9-0x12c;let _0xab651=_0x34ec84[_0x35a1c9];return _0xab651;},a68_0x2fa1(_0x189d33,_0x51b346);}(function(_0x557b2c,_0x2b9460){const _0x2fe745=a68_0x2fa1,_0x1f61a9=_0x557b2c();while(!![]){try{const _0x14f7e9=-parseInt(_0x2fe745(0x12f))/0x1+-parseInt(_0x2fe745(0x12e))/0x2*(-parseInt(_0x2fe745(0x13c))/0x3)+-parseInt(_0x2fe745(0x159))/0x4+parseInt(_0x2fe745(0x155))/0x5+-parseInt(_0x2fe745(0x13f))/0x6*(parseInt(_0x2fe745(0x156))/0x7)+parseInt(_0x2fe745(0x16b))/0x8+-parseInt(_0x2fe745(0x134))/0x9*(-parseInt(_0x2fe745(0x163))/0xa);if(_0x14f7e9===_0x2b9460)break;else _0x1f61a9['push'](_0x1f61a9['shift']());}catch(_0x65c665){_0x1f61a9['push'](_0x1f61a9['shift']());}}}(a68_0xab65,0x92572));const a68_0x17e598=(function(){let _0x4f5464=!![];return function(_0x3d022b,_0x20e9ce){const _0x3559eb=_0x4f5464?function(){const _0x2ad13c=a68_0x2fa1;if(_0x20e9ce){const _0x2ae324=_0x20e9ce[_0x2ad13c(0x138)](_0x3d022b,arguments);return _0x20e9ce=null,_0x2ae324;}}:function(){};return _0x4f5464=![],_0x3559eb;};}()),a68_0x35a1c9=a68_0x17e598(this,function(){const _0x5affa0=a68_0x2fa1;return a68_0x35a1c9[_0x5affa0(0x15e)]()[_0x5affa0(0x169)](_0x5affa0(0x168))['toString']()['constructor'](a68_0x35a1c9)[_0x5affa0(0x169)]('(((.+)+)+)+$');});a68_0x35a1c9();'use strict';var __importDefault=this&&this[a68_0x5d0811(0x149)]||function(_0x560680){return _0x560680&&_0x560680['__esModule']?_0x560680:{'default':_0x560680};};Object[a68_0x5d0811(0x141)](exports,a68_0x5d0811(0x13e),{'value':!![]}),exports[a68_0x5d0811(0x167)]=void 0x0;const core_1=require(a68_0x5d0811(0x16c)),salesforce_1=require('@flosum/salesforce'),auth_manager_1=require(a68_0x5d0811(0x12c)),constants_1=require(a68_0x5d0811(0x147)),utils_1=require(a68_0x5d0811(0x136)),minimist_1=__importDefault(require(a68_0x5d0811(0x16d))),path_1=__importDefault(require('path')),state_manger_1=__importDefault(require('../../shared/managers/state-manger')),logger_1=__importDefault(require(a68_0x5d0811(0x142))),retrieve_cartridges_1=__importDefault(require('./classes/retrieve-cartridges')),deploy_cartridges_1=__importDefault(require('./classes/deploy-cartridges')),run_script_1=__importDefault(require(a68_0x5d0811(0x162))),manifest_manager_1=__importDefault(require(a68_0x5d0811(0x132))),salesforce_auth_1=__importDefault(require(a68_0x5d0811(0x139)));class Job{constructor(){const _0x2f3310=a68_0x5d0811,{jobId:_0x15f23d,jobStorePath:_0x4a2845}=(0x0,minimist_1[_0x2f3310(0x15f)])(process[_0x2f3310(0x137)][_0x2f3310(0x154)](0x2));this[_0x2f3310(0x145)]=_0x4a2845,this['jobId']=_0x15f23d;}async['execute'](){const _0x4b40a1=a68_0x5d0811;this['systemLogger']=new core_1[(_0x4b40a1(0x135))](this[_0x4b40a1(0x140)]),this[_0x4b40a1(0x15d)]=new logger_1[(_0x4b40a1(0x15f))](this[_0x4b40a1(0x140)],this[_0x4b40a1(0x130)]);const _0x4fb0ee=await new state_manger_1[(_0x4b40a1(0x15f))](this[_0x4b40a1(0x145)])[_0x4b40a1(0x14b)](),_0x18916c=path_1[_0x4b40a1(0x15f)][_0x4b40a1(0x157)](this['jobPath'],'cartridges',constants_1[_0x4b40a1(0x14c)]);await this['logger'][_0x4b40a1(0x152)]('Job\x20has\x20been\x20started.');try{await _0x4fb0ee[_0x4b40a1(0x15a)](),this[_0x4b40a1(0x151)]=await this[_0x4b40a1(0x13a)](),this['namespace']=this[_0x4b40a1(0x14a)](),await this[_0x4b40a1(0x13d)](),await this[_0x4b40a1(0x15b)](),await utils_1[_0x4b40a1(0x13b)][_0x4b40a1(0x15c)](_0x18916c)?await this['runScript']():await this[_0x4b40a1(0x144)](),await _0x4fb0ee[_0x4b40a1(0x16a)](),await this[_0x4b40a1(0x15d)][_0x4b40a1(0x152)]('Job\x20has\x20been\x20completed.');}catch(_0x5d4c71){await _0x4fb0ee['setError'](_0x5d4c71),await this[_0x4b40a1(0x15d)][_0x4b40a1(0x158)](_0x5d4c71['message']),await this['logger'][_0x4b40a1(0x158)]('Job\x20has\x20been\x20failed.');}}async[a68_0x5d0811(0x13d)](){const _0x123ca9=a68_0x5d0811,{credentials:_0xd8b9d3,apiVersion:_0x41fc61,branchId:_0x7ceb82,codeVersion:_0x4e678d,isCompileCartridges:_0x28ab9f,isActivateCodeVersion:_0x256cf7,variables:_0x65cc7a}=await new manifest_manager_1[(_0x123ca9(0x15f))](this['jobPath'])[_0x123ca9(0x14b)]();this['credentials']=_0xd8b9d3,this[_0x123ca9(0x12d)]=_0x41fc61,this[_0x123ca9(0x153)]=_0x7ceb82,this[_0x123ca9(0x133)]=_0x4e678d,this[_0x123ca9(0x150)]=_0x28ab9f,this['isActivateCodeVersion']=_0x256cf7,this['variables']=_0x65cc7a;}async[a68_0x5d0811(0x13a)](){const _0x2c1ff5=a68_0x5d0811,_0x45119a=await salesforce_auth_1[_0x2c1ff5(0x15f)]['getAuthDetails']();return salesforce_1[_0x2c1ff5(0x16f)][_0x2c1ff5(0x131)](new auth_manager_1[(_0x2c1ff5(0x14f))](_0x45119a),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a68_0x5d0811(0x15b)](){const _0x5298e0=a68_0x5d0811;await this[_0x5298e0(0x15d)]['log'](_0x5298e0(0x170)[_0x5298e0(0x160)](0x32,'=')),await new retrieve_cartridges_1[(_0x5298e0(0x15f))](this[_0x5298e0(0x145)],this['axiosInstance'],this[_0x5298e0(0x12d)],this[_0x5298e0(0x14e)],this[_0x5298e0(0x153)],this['variables'],this['logger'])[_0x5298e0(0x166)]();}async[a68_0x5d0811(0x161)](){const _0x3c8d08=a68_0x5d0811;await this[_0x3c8d08(0x15d)]['log']('======\x20Run\x20script\x20'[_0x3c8d08(0x160)](0x32,'=')),await new run_script_1[(_0x3c8d08(0x15f))](this['jobPath'],this['credentials'],this[_0x3c8d08(0x133)],this[_0x3c8d08(0x150)],this['isActivateCodeVersion'],this[_0x3c8d08(0x130)],this[_0x3c8d08(0x15d)])[_0x3c8d08(0x166)]();}async[a68_0x5d0811(0x144)](){const _0x4720cf=a68_0x5d0811;await this['logger'][_0x4720cf(0x152)](_0x4720cf(0x143)[_0x4720cf(0x160)](0x32,'=')),await new deploy_cartridges_1['default'](this[_0x4720cf(0x145)],this['credentials'],this['codeVersion'],this[_0x4720cf(0x16e)],this[_0x4720cf(0x15d)])[_0x4720cf(0x166)]();}['getFlosumNamespace'](){const _0xae556e=a68_0x5d0811;var _0x43ba97,_0x5750e4;return((_0x5750e4=(_0x43ba97=process[_0xae556e(0x164)])===null||_0x43ba97===void 0x0?void 0x0:_0x43ba97[_0xae556e(0x171)])===null||_0x5750e4===void 0x0?void 0x0:_0x5750e4['toLowerCase']())===_0xae556e(0x148)?'':constants_1[_0xae556e(0x14d)];}}exports[a68_0x5d0811(0x167)]=Job,new Job()[a68_0x5d0811(0x166)]()[a68_0x5d0811(0x146)](()=>process[a68_0x5d0811(0x165)](0x0))['catch'](()=>process[a68_0x5d0811(0x165)](0x1));function a68_0xab65(){const _0x4167ff=['slice','1982750pprlqe','20489qVibUy','join','error','3470988NGidHB','setInProgress','retrieveCartridges','isExistsPath','logger','toString','default','padEnd','runScript','./classes/run-script','30LxNfBN','env','exit','execute','Job','(((.+)+)+)+$','search','setCompleted','4929424QZyqTP','../../../core','minimist','isActivateCodeVersion','AxiosInstanceUtils','======\x20Retrieve\x20cartridges\x20','IGNORE_FLOSUM_NAMESPACE','../../shared/managers/auth.manager','apiVersion','2ikxcRc','405585SGTrMp','systemLogger','create','./classes/manifest-manager','codeVersion','2285775HDDKKQ','Logger','@flosum/utils','argv','apply','./classes/salesforce-auth','getAxiosInstance','FsUtils','2068029amShoG','getManifestParameters','__esModule','1212KIbwqO','jobId','defineProperty','./classes/logger','======\x20Deploy\x20cartridges\x20','deployCartridges','jobPath','then','../constants','true','__importDefault','getFlosumNamespace','init','FLOSUM_SCRIPT_PATH','FLOSUM_NAMESPACE','namespace','AuthManager','isCompileCartridges','axiosInstance','log','branchId'];a68_0xab65=function(){return _0x4167ff;};return a68_0xab65();}