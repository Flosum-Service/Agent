const a66_0x1d6dbe=a66_0x3844;function a66_0x3844(_0xfbf892,_0x45b748){const _0x3506ce=a66_0x2403();return a66_0x3844=function(_0x291012,_0x20277f){_0x291012=_0x291012-0x124;let _0x240384=_0x3506ce[_0x291012];return _0x240384;},a66_0x3844(_0xfbf892,_0x45b748);}(function(_0x263e94,_0x2a841d){const _0x390fd1=a66_0x3844,_0x272c76=_0x263e94();while(!![]){try{const _0x53883b=parseInt(_0x390fd1(0x13a))/0x1+-parseInt(_0x390fd1(0x134))/0x2*(parseInt(_0x390fd1(0x127))/0x3)+-parseInt(_0x390fd1(0x168))/0x4*(-parseInt(_0x390fd1(0x132))/0x5)+-parseInt(_0x390fd1(0x13e))/0x6+parseInt(_0x390fd1(0x124))/0x7*(-parseInt(_0x390fd1(0x14c))/0x8)+parseInt(_0x390fd1(0x136))/0x9*(parseInt(_0x390fd1(0x163))/0xa)+-parseInt(_0x390fd1(0x13c))/0xb*(-parseInt(_0x390fd1(0x139))/0xc);if(_0x53883b===_0x2a841d)break;else _0x272c76['push'](_0x272c76['shift']());}catch(_0x3b565a){_0x272c76['push'](_0x272c76['shift']());}}}(a66_0x2403,0x47820));const a66_0x20277f=(function(){let _0x24c6e4=!![];return function(_0x1ad78e,_0x482d17){const _0x5b48c9=_0x24c6e4?function(){const _0x3955ad=a66_0x3844;if(_0x482d17){const _0xcf7b51=_0x482d17[_0x3955ad(0x159)](_0x1ad78e,arguments);return _0x482d17=null,_0xcf7b51;}}:function(){};return _0x24c6e4=![],_0x5b48c9;};}()),a66_0x291012=a66_0x20277f(this,function(){const _0x5a9956=a66_0x3844;return a66_0x291012[_0x5a9956(0x148)]()[_0x5a9956(0x164)](_0x5a9956(0x145))[_0x5a9956(0x148)]()['constructor'](a66_0x291012)['search'](_0x5a9956(0x145));});a66_0x291012();'use strict';var __importDefault=this&&this[a66_0x1d6dbe(0x156)]||function(_0x1312ec){const _0x582079=a66_0x1d6dbe;return _0x1312ec&&_0x1312ec[_0x582079(0x161)]?_0x1312ec:{'default':_0x1312ec};};Object[a66_0x1d6dbe(0x15c)](exports,'__esModule',{'value':!![]}),exports[a66_0x1d6dbe(0x140)]=void 0x0;const core_1=require('../../../core'),salesforce_1=require('@flosum/salesforce'),auth_manager_1=require(a66_0x1d6dbe(0x16a)),constants_1=require(a66_0x1d6dbe(0x125)),utils_1=require(a66_0x1d6dbe(0x12f)),minimist_1=__importDefault(require(a66_0x1d6dbe(0x14f))),path_1=__importDefault(require(a66_0x1d6dbe(0x151))),state_manger_1=__importDefault(require(a66_0x1d6dbe(0x131))),logger_1=__importDefault(require(a66_0x1d6dbe(0x129))),retrieve_cartridges_1=__importDefault(require(a66_0x1d6dbe(0x166))),deploy_cartridges_1=__importDefault(require(a66_0x1d6dbe(0x165))),run_script_1=__importDefault(require('./classes/run-script')),manifest_manager_1=__importDefault(require(a66_0x1d6dbe(0x128))),salesforce_auth_1=__importDefault(require(a66_0x1d6dbe(0x15f)));class Job{constructor(){const _0x25fd4e=a66_0x1d6dbe,{jobId:_0x389877,jobStorePath:_0x1ef304}=(0x0,minimist_1[_0x25fd4e(0x12a)])(process[_0x25fd4e(0x142)][_0x25fd4e(0x143)](0x2));this['jobPath']=_0x1ef304,this['jobId']=_0x389877;}async[a66_0x1d6dbe(0x13f)](){const _0x2a176c=a66_0x1d6dbe,_0x25aff6=new core_1['Logger'](this[_0x2a176c(0x160)]);this[_0x2a176c(0x12b)]=new logger_1[(_0x2a176c(0x12a))](this[_0x2a176c(0x160)],_0x25aff6);const _0x4ea2bc=await new state_manger_1[(_0x2a176c(0x12a))](this[_0x2a176c(0x138)])[_0x2a176c(0x141)](),_0x262bb1=path_1[_0x2a176c(0x12a)][_0x2a176c(0x150)](this[_0x2a176c(0x138)],_0x2a176c(0x158),constants_1['FLOSUM_SCRIPT_PATH']);await this[_0x2a176c(0x12b)][_0x2a176c(0x12d)](_0x2a176c(0x152));try{await _0x4ea2bc['setInProgress'](),this['axiosInstance']=await this[_0x2a176c(0x146)](),this['namespace']=this[_0x2a176c(0x16c)](),await this[_0x2a176c(0x149)](),await this[_0x2a176c(0x147)](),await utils_1[_0x2a176c(0x169)][_0x2a176c(0x12e)](_0x262bb1)?await this['runScript']():(await this[_0x2a176c(0x15d)](),this[_0x2a176c(0x12c)]&&await this[_0x2a176c(0x130)]()),await _0x4ea2bc[_0x2a176c(0x14a)](),await this[_0x2a176c(0x12b)]['log']('B2C\x20job\x20has\x20been\x20completed.');}catch(_0x1dc840){await _0x4ea2bc['setError'](_0x1dc840),await this[_0x2a176c(0x12b)][_0x2a176c(0x135)](_0x1dc840[_0x2a176c(0x153)]),await this[_0x2a176c(0x12b)][_0x2a176c(0x135)]('B2C\x20job\x20has\x20been\x20failed.');}}async[a66_0x1d6dbe(0x149)](){const _0x889308=a66_0x1d6dbe,{credentials:_0x2b8f3e,apiVersion:_0x47518c,branchId:_0x1772e5,codeVersion:_0x127b75,isCompileCartridges:_0x112ca9,isActivateCodeVersion:_0x30ceab,variables:_0xe42ff}=await new manifest_manager_1[(_0x889308(0x12a))](this[_0x889308(0x138)])['init']();this[_0x889308(0x14b)]=_0x2b8f3e,this['apiVersion']=_0x47518c,this[_0x889308(0x154)]=_0x1772e5,this['codeVersion']=_0x127b75,this['isCompileCartridges']=_0x112ca9,this[_0x889308(0x12c)]=_0x30ceab,this['variables']=_0xe42ff;}async[a66_0x1d6dbe(0x146)](){const _0x1d704d=a66_0x1d6dbe,_0x2eedf8=await salesforce_auth_1[_0x1d704d(0x12a)][_0x1d704d(0x144)]();return salesforce_1['AxiosInstanceUtils']['create'](new auth_manager_1[(_0x1d704d(0x137))](_0x2eedf8),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a66_0x1d6dbe(0x147)](){const _0x7cc452=a66_0x1d6dbe;await this[_0x7cc452(0x12b)]['log'](_0x7cc452(0x15a)[_0x7cc452(0x133)](0x32,'=')),await new retrieve_cartridges_1[(_0x7cc452(0x12a))](this[_0x7cc452(0x138)],this['axiosInstance'],this['apiVersion'],this[_0x7cc452(0x15e)],this[_0x7cc452(0x154)],this[_0x7cc452(0x162)],this[_0x7cc452(0x12b)])[_0x7cc452(0x13f)]();}async[a66_0x1d6dbe(0x167)](){const _0xf248c8=a66_0x1d6dbe;await this[_0xf248c8(0x12b)][_0xf248c8(0x12d)](_0xf248c8(0x157)['padEnd'](0x32,'=')),await new run_script_1['default'](this[_0xf248c8(0x138)],this['credentials'],this['codeVersion'],this[_0xf248c8(0x13d)],this[_0xf248c8(0x12c)],this[_0xf248c8(0x12b)])['execute']();}async[a66_0x1d6dbe(0x15d)](){const _0x237bdf=a66_0x1d6dbe;await this[_0x237bdf(0x12b)]['log'](_0x237bdf(0x16b)[_0x237bdf(0x133)](0x32,'=')),await new deploy_cartridges_1[(_0x237bdf(0x12a))](this[_0x237bdf(0x138)],this[_0x237bdf(0x14b)],this[_0x237bdf(0x15b)],this[_0x237bdf(0x12b)])[_0x237bdf(0x13f)]();}async[a66_0x1d6dbe(0x130)](){const _0x32bf55=a66_0x1d6dbe;await this['logger']['log'](_0x32bf55(0x16b)['padEnd'](0x32,'=')),await new deploy_cartridges_1['default'](this[_0x32bf55(0x138)],this[_0x32bf55(0x14b)],this[_0x32bf55(0x15b)],this[_0x32bf55(0x12b)])[_0x32bf55(0x130)]();}[a66_0x1d6dbe(0x16c)](){const _0x468647=a66_0x1d6dbe;var _0x357a2c,_0x5d1926;return((_0x5d1926=(_0x357a2c=process[_0x468647(0x155)])===null||_0x357a2c===void 0x0?void 0x0:_0x357a2c[_0x468647(0x126)])===null||_0x5d1926===void 0x0?void 0x0:_0x5d1926['toLowerCase']())===_0x468647(0x14e)?'':constants_1[_0x468647(0x14d)];}}exports['Job']=Job,new Job()[a66_0x1d6dbe(0x13f)]()['then'](()=>process[a66_0x1d6dbe(0x13b)](0x0))['catch'](()=>process[a66_0x1d6dbe(0x13b)](0x1));function a66_0x2403(){const _0x659db7=['jobId','__esModule','variables','2937170tziVfd','search','./classes/deploy-cartridges','./classes/retrieve-cartridges','runScript','1108052CspSxO','FsUtils','../../shared/managers/auth.manager','======\x20Deploy\x20cartridges\x20','getFlosumNamespace','14WDaeBB','../constants','IGNORE_FLOSUM_NAMESPACE','182220CqODVn','./classes/manifest-manager','./classes/logger','default','logger','isActivateCodeVersion','log','isExistsPath','@flosum/utils','activateCodeVersion','../../shared/managers/state-manger','5DDbrkR','padEnd','16JXEQdn','error','9IZtexS','AuthManager','jobPath','1272TRodGZ','81865eYcYyN','exit','84238UHMgYB','isCompileCartridges','1911414tEAsfU','execute','Job','init','argv','slice','getAuthDetails','(((.+)+)+)+$','getAxiosInstance','retrieveCartridges','toString','getManifestParameters','setCompleted','credentials','1467832LnJMjK','FLOSUM_NAMESPACE','true','minimist','join','path','B2C\x20job\x20has\x20been\x20started.','message','branchId','env','__importDefault','======\x20Run\x20script\x20','cartridges','apply','======\x20Retrieve\x20cartridges\x20','codeVersion','defineProperty','deployCartridges','namespace','./classes/salesforce-auth'];a66_0x2403=function(){return _0x659db7;};return a66_0x2403();}