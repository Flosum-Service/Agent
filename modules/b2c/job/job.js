const a66_0x59bf15=a66_0x3c93;(function(_0xe6c58b,_0x437ec4){const _0xfeb40a=a66_0x3c93,_0x39d03e=_0xe6c58b();while(!![]){try{const _0x705a04=parseInt(_0xfeb40a(0x117))/0x1+parseInt(_0xfeb40a(0xfe))/0x2*(-parseInt(_0xfeb40a(0xf2))/0x3)+-parseInt(_0xfeb40a(0x109))/0x4+-parseInt(_0xfeb40a(0xf0))/0x5*(parseInt(_0xfeb40a(0xef))/0x6)+-parseInt(_0xfeb40a(0x12f))/0x7+-parseInt(_0xfeb40a(0x12c))/0x8+-parseInt(_0xfeb40a(0x10d))/0x9*(-parseInt(_0xfeb40a(0xfa))/0xa);if(_0x705a04===_0x437ec4)break;else _0x39d03e['push'](_0x39d03e['shift']());}catch(_0x4a2d46){_0x39d03e['push'](_0x39d03e['shift']());}}}(a66_0x2cee,0x272cd));const a66_0x55a1af=(function(){let _0x3e25bb=!![];return function(_0x58b9a2,_0x1687f7){const _0x1c5a00=_0x3e25bb?function(){const _0x4f13c1=a66_0x3c93;if(_0x1687f7){const _0x2dd4a4=_0x1687f7[_0x4f13c1(0x101)](_0x58b9a2,arguments);return _0x1687f7=null,_0x2dd4a4;}}:function(){};return _0x3e25bb=![],_0x1c5a00;};}()),a66_0x4db593=a66_0x55a1af(this,function(){const _0x4a9298=a66_0x3c93;return a66_0x4db593[_0x4a9298(0x115)]()[_0x4a9298(0xf4)](_0x4a9298(0x124))[_0x4a9298(0x115)]()['constructor'](a66_0x4db593)[_0x4a9298(0xf4)](_0x4a9298(0x124));});a66_0x4db593();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x136520){const _0x21b660=a66_0x3c93;return _0x136520&&_0x136520[_0x21b660(0x10a)]?_0x136520:{'default':_0x136520};};Object[a66_0x59bf15(0x128)](exports,'__esModule',{'value':!![]}),exports['Job']=void 0x0;function a66_0x3c93(_0x3a72cb,_0x4f7e5a){const _0x261b52=a66_0x2cee();return a66_0x3c93=function(_0x4db593,_0x55a1af){_0x4db593=_0x4db593-0xe7;let _0x2ceed7=_0x261b52[_0x4db593];return _0x2ceed7;},a66_0x3c93(_0x3a72cb,_0x4f7e5a);}const core_1=require('../../../core'),salesforce_1=require(a66_0x59bf15(0x105)),auth_manager_1=require(a66_0x59bf15(0x11e)),constants_1=require('../constants'),utils_1=require('@flosum/utils'),minimist_1=__importDefault(require(a66_0x59bf15(0xf7))),path_1=__importDefault(require(a66_0x59bf15(0xe7))),state_manger_1=__importDefault(require(a66_0x59bf15(0x10c))),logger_1=__importDefault(require(a66_0x59bf15(0x133))),retrieve_cartridges_1=__importDefault(require(a66_0x59bf15(0x12d))),deploy_cartridges_1=__importDefault(require(a66_0x59bf15(0x12b))),run_script_1=__importDefault(require(a66_0x59bf15(0x118))),manifest_manager_1=__importDefault(require(a66_0x59bf15(0x11f))),salesforce_auth_1=__importDefault(require(a66_0x59bf15(0xff)));function a66_0x2cee(){const _0x68c6e6=['167366hgGfdI','./classes/run-script','codeVersion','retrieveCartridges','error','default','Job','../../shared/managers/auth.manager','./classes/manifest-manager','deployCartridges','namespace','======\x20Run\x20script\x20','credentials','(((.+)+)+)+$','create','setInProgress','B2C\x20job\x20has\x20been\x20completed.','defineProperty','getAuthDetails','branchId','./classes/deploy-cartridges','1046408liPKLs','./classes/retrieve-cartridges','argv','413238DITXCh','padEnd','isCompileCartridges','slice','./classes/logger','path','jobPath','getAxiosInstance','logger','jobId','true','activateCodeVersion','setCompleted','18kuVOdn','226535AigEXI','execute','348345tSQCVP','cartridges','search','env','getManifestParameters','minimist','variables','B2C\x20job\x20has\x20been\x20failed.','230YqygrM','join','isExistsPath','AuthManager','2jPZaFF','./classes/salesforce-auth','apiVersion','apply','message','isActivateCodeVersion','exit','@flosum/salesforce','getFlosumNamespace','Logger','FLOSUM_SCRIPT_PATH','637968vhqhFZ','__esModule','toLowerCase','../../shared/managers/state-manger','232614VFOowN','then','init','log','axiosInstance','======\x20Deploy\x20cartridges\x20','FLOSUM_NAMESPACE','runScript','toString','======\x20Retrieve\x20cartridges\x20'];a66_0x2cee=function(){return _0x68c6e6;};return a66_0x2cee();}class Job{constructor(){const _0x497cc5=a66_0x59bf15,{jobId:_0x5caf7d,jobStorePath:_0x15ae86}=(0x0,minimist_1['default'])(process[_0x497cc5(0x12e)][_0x497cc5(0x132)](0x2));this[_0x497cc5(0xe8)]=_0x15ae86,this[_0x497cc5(0xeb)]=_0x5caf7d;}async[a66_0x59bf15(0xf1)](){const _0x3b9ba3=a66_0x59bf15,_0x25c7a4=new core_1[(_0x3b9ba3(0x107))](this[_0x3b9ba3(0xeb)]);this['logger']=new logger_1['default'](this['jobId'],_0x25c7a4);const _0x51f9dc=await new state_manger_1[(_0x3b9ba3(0x11c))](this[_0x3b9ba3(0xe8)])['init'](),_0xf0b56a=path_1[_0x3b9ba3(0x11c)][_0x3b9ba3(0xfb)](this[_0x3b9ba3(0xe8)],_0x3b9ba3(0xf3),constants_1[_0x3b9ba3(0x108)]);await this[_0x3b9ba3(0xea)]['log']('B2C\x20job\x20has\x20been\x20started.');try{await _0x51f9dc[_0x3b9ba3(0x126)](),this[_0x3b9ba3(0x111)]=await this[_0x3b9ba3(0xe9)](),this[_0x3b9ba3(0x121)]=this[_0x3b9ba3(0x106)](),await this[_0x3b9ba3(0xf6)](),await this[_0x3b9ba3(0x11a)](),await utils_1['FsUtils'][_0x3b9ba3(0xfc)](_0xf0b56a)?await this[_0x3b9ba3(0x114)]():(await this[_0x3b9ba3(0x120)](),this[_0x3b9ba3(0x103)]&&await this[_0x3b9ba3(0xed)]()),await _0x51f9dc[_0x3b9ba3(0xee)](),await this[_0x3b9ba3(0xea)][_0x3b9ba3(0x110)](_0x3b9ba3(0x127));}catch(_0x25e972){await _0x51f9dc['setError'](_0x25e972),await this['logger']['error'](_0x25e972[_0x3b9ba3(0x102)]),await this[_0x3b9ba3(0xea)][_0x3b9ba3(0x11b)](_0x3b9ba3(0xf9));}}async[a66_0x59bf15(0xf6)](){const _0x256848=a66_0x59bf15,{credentials:_0x17c9e2,apiVersion:_0xec2a97,branchId:_0x4ea9e3,codeVersion:_0x56fe6f,isCompileCartridges:_0x253534,isActivateCodeVersion:_0xe8b92,variables:_0x2f140c}=await new manifest_manager_1[(_0x256848(0x11c))](this[_0x256848(0xe8)])[_0x256848(0x10f)]();this[_0x256848(0x123)]=_0x17c9e2,this[_0x256848(0x100)]=_0xec2a97,this['branchId']=_0x4ea9e3,this[_0x256848(0x119)]=_0x56fe6f,this['isCompileCartridges']=_0x253534,this[_0x256848(0x103)]=_0xe8b92,this[_0x256848(0xf8)]=_0x2f140c;}async[a66_0x59bf15(0xe9)](){const _0x37fb8e=a66_0x59bf15,_0x37b176=await salesforce_auth_1[_0x37fb8e(0x11c)][_0x37fb8e(0x129)]();return salesforce_1['AxiosInstanceUtils'][_0x37fb8e(0x125)](new auth_manager_1[(_0x37fb8e(0xfd))](_0x37b176),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity});}async[a66_0x59bf15(0x11a)](){const _0x3b4638=a66_0x59bf15;await this[_0x3b4638(0xea)][_0x3b4638(0x110)](_0x3b4638(0x116)[_0x3b4638(0x130)](0x32,'=')),await new retrieve_cartridges_1[(_0x3b4638(0x11c))](this[_0x3b4638(0xe8)],this[_0x3b4638(0x111)],this[_0x3b4638(0x100)],this[_0x3b4638(0x121)],this[_0x3b4638(0x12a)],this[_0x3b4638(0xf8)],this[_0x3b4638(0xea)])[_0x3b4638(0xf1)]();}async[a66_0x59bf15(0x114)](){const _0xdb8ea9=a66_0x59bf15;await this['logger']['log'](_0xdb8ea9(0x122)[_0xdb8ea9(0x130)](0x32,'=')),await new run_script_1['default'](this[_0xdb8ea9(0xe8)],this[_0xdb8ea9(0x123)],this[_0xdb8ea9(0x119)],this[_0xdb8ea9(0x131)],this[_0xdb8ea9(0x103)],this['logger'])[_0xdb8ea9(0xf1)]();}async[a66_0x59bf15(0x120)](){const _0x3b7d60=a66_0x59bf15;await this[_0x3b7d60(0xea)][_0x3b7d60(0x110)]('======\x20Deploy\x20cartridges\x20'[_0x3b7d60(0x130)](0x32,'=')),await new deploy_cartridges_1[(_0x3b7d60(0x11c))](this[_0x3b7d60(0xe8)],this[_0x3b7d60(0x123)],this[_0x3b7d60(0x119)],this[_0x3b7d60(0xea)])[_0x3b7d60(0xf1)]();}async[a66_0x59bf15(0xed)](){const _0x41ae4d=a66_0x59bf15;await this['logger'][_0x41ae4d(0x110)](_0x41ae4d(0x112)[_0x41ae4d(0x130)](0x32,'=')),await new deploy_cartridges_1[(_0x41ae4d(0x11c))](this[_0x41ae4d(0xe8)],this[_0x41ae4d(0x123)],this[_0x41ae4d(0x119)],this[_0x41ae4d(0xea)])[_0x41ae4d(0xed)]();}['getFlosumNamespace'](){const _0x58ab7a=a66_0x59bf15;var _0x3e24cf,_0x22b945;return((_0x22b945=(_0x3e24cf=process[_0x58ab7a(0xf5)])===null||_0x3e24cf===void 0x0?void 0x0:_0x3e24cf['IGNORE_FLOSUM_NAMESPACE'])===null||_0x22b945===void 0x0?void 0x0:_0x22b945[_0x58ab7a(0x10b)]())===_0x58ab7a(0xec)?'':constants_1[_0x58ab7a(0x113)];}}exports[a66_0x59bf15(0x11d)]=Job,new Job()['execute']()[a66_0x59bf15(0x10e)](()=>process[a66_0x59bf15(0x104)](0x0))['catch'](()=>process[a66_0x59bf15(0x104)](0x1));