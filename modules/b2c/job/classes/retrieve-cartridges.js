const a62_0x3d7207=a62_0x5ed6;(function(_0x39cf6c,_0xb5bd9f){const _0x23fe2d=a62_0x5ed6,_0xe0d542=_0x39cf6c();while(!![]){try{const _0x209adc=parseInt(_0x23fe2d(0x180))/0x1*(-parseInt(_0x23fe2d(0x18f))/0x2)+parseInt(_0x23fe2d(0x18a))/0x3*(parseInt(_0x23fe2d(0x191))/0x4)+parseInt(_0x23fe2d(0x1a9))/0x5+-parseInt(_0x23fe2d(0x1a0))/0x6*(-parseInt(_0x23fe2d(0x184))/0x7)+-parseInt(_0x23fe2d(0x190))/0x8+parseInt(_0x23fe2d(0x193))/0x9+-parseInt(_0x23fe2d(0x18b))/0xa*(-parseInt(_0x23fe2d(0x181))/0xb);if(_0x209adc===_0xb5bd9f)break;else _0xe0d542['push'](_0xe0d542['shift']());}catch(_0x3265c7){_0xe0d542['push'](_0xe0d542['shift']());}}}(a62_0x8ba1,0x9a462));const a62_0x459ddb=(function(){let _0x8335f5=!![];return function(_0x12f1e7,_0x367bf3){const _0x580640=_0x8335f5?function(){if(_0x367bf3){const _0x5e463f=_0x367bf3['apply'](_0x12f1e7,arguments);return _0x367bf3=null,_0x5e463f;}}:function(){};return _0x8335f5=![],_0x580640;};}()),a62_0x317214=a62_0x459ddb(this,function(){const _0x2cd438=a62_0x5ed6;return a62_0x317214['toString']()['search'](_0x2cd438(0x165))[_0x2cd438(0x1a7)]()['constructor'](a62_0x317214)['search'](_0x2cd438(0x165));});a62_0x317214();function a62_0x5ed6(_0x583086,_0x3affbe){const _0x336758=a62_0x8ba1();return a62_0x5ed6=function(_0x317214,_0x459ddb){_0x317214=_0x317214-0x15b;let _0x8ba1c7=_0x336758[_0x317214];return _0x8ba1c7;},a62_0x5ed6(_0x583086,_0x3affbe);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x13eb3d){const _0x9d2b82=a62_0x5ed6;return _0x13eb3d&&_0x13eb3d[_0x9d2b82(0x179)]?_0x13eb3d:{'default':_0x13eb3d};};Object['defineProperty'](exports,a62_0x3d7207(0x179),{'value':!![]});const salesforce_1=require(a62_0x3d7207(0x16b)),salesforce_2=require('@flosum/salesforce'),utils_1=require(a62_0x3d7207(0x185)),adm_zip_1=__importDefault(require(a62_0x3d7207(0x16e))),B2C_CARTRIDGE_TYPE=a62_0x3d7207(0x17c),BINARY_FIELDS=[a62_0x3d7207(0x17f)],EXCLUDED_TYPES=[a62_0x3d7207(0x194),a62_0x3d7207(0x16a),a62_0x3d7207(0x1a3),a62_0x3d7207(0x19a),a62_0x3d7207(0x182),a62_0x3d7207(0x198),a62_0x3d7207(0x183),a62_0x3d7207(0x15d),a62_0x3d7207(0x174),'ico',a62_0x3d7207(0x19d),a62_0x3d7207(0x161),a62_0x3d7207(0x15b),a62_0x3d7207(0x195)];class RetrieveCartridges{constructor(_0x5a1ea8,_0x20b0c3,_0x4681b8,_0x2f9cfc,_0x3f1920,_0x1aec78,_0x115985){const _0x10f113=a62_0x3d7207;this[_0x10f113(0x19f)]=_0x5a1ea8,this['axiosInstance']=_0x20b0c3,this['apiVersion']=_0x4681b8,this[_0x10f113(0x168)]=_0x2f9cfc,this[_0x10f113(0x19e)]=_0x3f1920,this[_0x10f113(0x15e)]=_0x1aec78,this[_0x10f113(0x1a2)]=_0x115985,this[_0x10f113(0x171)]=![],this[_0x10f113(0x171)]=Object[_0x10f113(0x189)](this[_0x10f113(0x15e)])['length']>0x0;}async[a62_0x3d7207(0x163)](_0x5b4bdb){const _0x2a73c8=a62_0x3d7207,_0x97c4bb=new salesforce_2[(_0x2a73c8(0x166))]()[_0x2a73c8(0x188)](_0x2a73c8(0x17f),'Name',_0x2a73c8(0x177))[_0x2a73c8(0x199)](_0x2a73c8(0x19c))[_0x2a73c8(0x1ad)](_0x2a73c8(0x1ac),{'componentHistoryIds':_0x5b4bdb}),_0x449334=new salesforce_1[(_0x2a73c8(0x15c))]({'instance':this[_0x2a73c8(0x17d)],'api':this[_0x2a73c8(0x18c)],'pollInterval':0x1388,'queryBuilder':_0x97c4bb,'objectName':'Attachment','contentType':salesforce_1[_0x2a73c8(0x1a1)][_0x2a73c8(0x1ab)],'jobOperation':salesforce_1[_0x2a73c8(0x18e)][_0x2a73c8(0x169)]});let _0x24b9e3=0x0;do{const _0x4bd0ed=await _0x449334[_0x2a73c8(0x15f)]();if(!_0x4bd0ed)break;const _0x274568=new salesforce_2[(_0x2a73c8(0x187))]({'binaryFields':BINARY_FIELDS});for await(const _0x58dccc of _0x4bd0ed['pipe'](_0x274568)){_0x24b9e3++;const _0x30f95e=new adm_zip_1['default'](_0x58dccc[_0x2a73c8(0x17f)]);this[_0x2a73c8(0x171)]&&await this[_0x2a73c8(0x192)](_0x30f95e),await(0x0,utils_1['extractAllToAsync'])(_0x30f95e,this[_0x2a73c8(0x19f)]);}}while(!_0x449334[_0x2a73c8(0x1a6)]());return _0x24b9e3;}async[a62_0x3d7207(0x192)](_0x2c11ff){const _0x5d54d6=_0x2c11ff['getEntries']();_0x5d54d6['forEach'](_0x23aef0=>{const _0x40bbd8=a62_0x5ed6,_0x2d988e=_0x23aef0[_0x40bbd8(0x172)],_0x5c85c8=_0x2d988e[_0x40bbd8(0x1a8)](_0x2d988e[_0x40bbd8(0x17b)]('.')+0x1);if(!EXCLUDED_TYPES[_0x40bbd8(0x197)](_0x5c85c8)){let _0x521c59=_0x23aef0[_0x40bbd8(0x186)]()[_0x40bbd8(0x1a7)](_0x40bbd8(0x178)),_0x1afa10=![];for(const _0x134a48 in this['variables']){const _0xdf90ca='%%'+_0x134a48+'%%';if(_0x521c59[_0x40bbd8(0x16c)](_0xdf90ca)!==-0x1){const _0x48488d=new RegExp(_0xdf90ca,'ig');_0x521c59=_0x521c59[_0x40bbd8(0x167)](_0x48488d,this[_0x40bbd8(0x15e)][_0x134a48]),_0x1afa10=!![];}}_0x1afa10&&_0x2c11ff[_0x40bbd8(0x1aa)](_0x23aef0,Buffer[_0x40bbd8(0x199)](_0x521c59,_0x40bbd8(0x178)));}});}async[a62_0x3d7207(0x170)](){const _0x20beed=a62_0x3d7207,_0x4a39a2=[],_0x27ec7a=new salesforce_2[(_0x20beed(0x166))]()[_0x20beed(0x188)]('Id')[_0x20beed(0x199)](this[_0x20beed(0x168)]+_0x20beed(0x176))[_0x20beed(0x1ad)](this[_0x20beed(0x168)]+_0x20beed(0x19b),{'branchId':this[_0x20beed(0x19e)]})['andWhere'](this[_0x20beed(0x168)]+_0x20beed(0x16f),{'type':B2C_CARTRIDGE_TYPE})[_0x20beed(0x16d)](),_0x35dbd4=new salesforce_2['QueryBuilder']()['select']('Id')[_0x20beed(0x199)](this[_0x20beed(0x168)]+'Component_History__c')[_0x20beed(0x1ad)](this[_0x20beed(0x168)]+_0x20beed(0x196)+_0x27ec7a+')')[_0x20beed(0x17a)](this[_0x20beed(0x168)]+_0x20beed(0x162),{'isLastVersion':!![]}),_0x5e50c4=new salesforce_2[(_0x20beed(0x173))]({'api':this['apiVersion'],'queryBuilder':_0x35dbd4,'instance':this[_0x20beed(0x17d)],'isTooling':![]});do{const _0x4264e0=await _0x5e50c4[_0x20beed(0x15f)]()[_0x20beed(0x17e)](({records:_0x593a8d})=>_0x593a8d[_0x20beed(0x160)](_0x2e97d1=>_0x2e97d1['Id']));_0x4264e0[_0x20beed(0x1a5)]&&_0x4a39a2[_0x20beed(0x1a4)](_0x4264e0);}while(!_0x5e50c4['getIsDone']());return _0x4a39a2;}async[a62_0x3d7207(0x15f)](){const _0x636cf3=a62_0x3d7207,_0x29eaf5=await this[_0x636cf3(0x170)]();let _0x79fc43=0x0;for(const _0x55e1b6 of _0x29eaf5){_0x79fc43+=await this['retriveAttachments'](_0x55e1b6);}await this[_0x636cf3(0x1a2)][_0x636cf3(0x18d)](_0x636cf3(0x164)+_0x79fc43+'\x20file(s).');}}function a62_0x8ba1(){const _0x12f04d=['namespace','Query','svg','@flosum/salesforce','indexOf','build','adm-zip','Component_Type__c\x20=\x20:type','getComponentHistoryIds','isFlosumVariables','name','CompositeRetrieveData','ttf','default','Component__c','BodyLength','utf8','__esModule','andWhere','lastIndexOf','CartridgeFile','axiosInstance','then','Body','1022602oPMQMz','1549471pDXjPZ','jpeg','woff','1549219yYUTfu','./utils','getData','BulkXmlStreamParser','select','keys','3KQqYgj','40AfByyW','apiVersion','log','Bulk1JobOperation','2zDtDUq','4972272eItDqR','822476TMUdQi','applyFlosumVariables','6870771ZDZeUp','jpg','pdf','Component__c\x20IN\x20(','includes','png','from','otf','Branch__c\x20=\x20:branchId','Attachment','zip','branchId','jobPath','12AVoirb','BulkV1QueryContentType','logger','eot','push','length','getIsDone','toString','substring','1504630BwgpGF','updateFile','APPLICATION_XML','ParentId\x20IN\x20(:componentHistoryIds)','where','gzip','Bulk1RetrieveData','woff2','variables','execute','map','rar','isLastVersion__c\x20=\x20:isLastVersion','retriveAttachments','Retrieved\x20','(((.+)+)+)+$','QueryBuilder','replace'];a62_0x8ba1=function(){return _0x12f04d;};return a62_0x8ba1();}exports[a62_0x3d7207(0x175)]=RetrieveCartridges;