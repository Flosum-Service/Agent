const a62_0x5bd286=a62_0x6e8d;(function(_0x283409,_0x57c7cd){const _0x4798c1=a62_0x6e8d,_0x374d28=_0x283409();while(!![]){try{const _0x1e9214=-parseInt(_0x4798c1(0x1f0))/0x1+parseInt(_0x4798c1(0x22d))/0x2+-parseInt(_0x4798c1(0x1f3))/0x3*(parseInt(_0x4798c1(0x21c))/0x4)+parseInt(_0x4798c1(0x228))/0x5*(-parseInt(_0x4798c1(0x23c))/0x6)+-parseInt(_0x4798c1(0x1fa))/0x7*(parseInt(_0x4798c1(0x202))/0x8)+parseInt(_0x4798c1(0x1f4))/0x9*(parseInt(_0x4798c1(0x220))/0xa)+parseInt(_0x4798c1(0x23a))/0xb;if(_0x1e9214===_0x57c7cd)break;else _0x374d28['push'](_0x374d28['shift']());}catch(_0x89297d){_0x374d28['push'](_0x374d28['shift']());}}}(a62_0x4d6a,0x98120));function a62_0x6e8d(_0x447c4b,_0x439078){const _0x3aa64c=a62_0x4d6a();return a62_0x6e8d=function(_0xdf3e3b,_0x661e98){_0xdf3e3b=_0xdf3e3b-0x1eb;let _0x4d6a33=_0x3aa64c[_0xdf3e3b];return _0x4d6a33;},a62_0x6e8d(_0x447c4b,_0x439078);}const a62_0x661e98=(function(){let _0x17bfb4=!![];return function(_0x35ffe1,_0x45d68a){const _0x430612=_0x17bfb4?function(){if(_0x45d68a){const _0x4f60ba=_0x45d68a['apply'](_0x35ffe1,arguments);return _0x45d68a=null,_0x4f60ba;}}:function(){};return _0x17bfb4=![],_0x430612;};}()),a62_0xdf3e3b=a62_0x661e98(this,function(){const _0x5b0679=a62_0x6e8d;return a62_0xdf3e3b[_0x5b0679(0x21f)]()['search']('(((.+)+)+)+$')[_0x5b0679(0x21f)]()[_0x5b0679(0x20e)](a62_0xdf3e3b)[_0x5b0679(0x21b)](_0x5b0679(0x209));});a62_0xdf3e3b();'use strict';var __importDefault=this&&this[a62_0x5bd286(0x20b)]||function(_0x50b3be){return _0x50b3be&&_0x50b3be['__esModule']?_0x50b3be:{'default':_0x50b3be};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const salesforce_1=require(a62_0x5bd286(0x207)),salesforce_2=require(a62_0x5bd286(0x207)),utils_1=require('./utils'),adm_zip_1=__importDefault(require(a62_0x5bd286(0x22c))),B2C_CARTRIDGE_TYPE=a62_0x5bd286(0x21e),BINARY_FIELDS=[a62_0x5bd286(0x1fd)],EXCLUDED_TYPES=[a62_0x5bd286(0x219),a62_0x5bd286(0x20a),a62_0x5bd286(0x239),a62_0x5bd286(0x23d),a62_0x5bd286(0x218),a62_0x5bd286(0x217),a62_0x5bd286(0x1f1),a62_0x5bd286(0x204),'ttf',a62_0x5bd286(0x20c),a62_0x5bd286(0x208),a62_0x5bd286(0x212),a62_0x5bd286(0x231),a62_0x5bd286(0x1f6)];class RetrieveCartridges{constructor(_0x85b279,_0x40add0,_0x243ff7,_0x3ff8f0,_0x43a12a,_0x177cbf,_0x47e0a6){const _0x270e99=a62_0x5bd286;this['jobPath']=_0x85b279,this[_0x270e99(0x222)]=_0x40add0,this['apiVersion']=_0x243ff7,this['namespace']=_0x3ff8f0,this[_0x270e99(0x1ed)]=_0x43a12a,this[_0x270e99(0x21d)]=_0x177cbf,this[_0x270e99(0x22a)]=_0x47e0a6,this[_0x270e99(0x23b)]=![],this[_0x270e99(0x23b)]=Object[_0x270e99(0x1ec)](this[_0x270e99(0x21d)])['length']>0x0;}async[a62_0x5bd286(0x236)](_0x561901){const _0x2540ed=a62_0x5bd286,_0x238383=new salesforce_2[(_0x2540ed(0x1eb))]()['select'](_0x2540ed(0x1fd),_0x2540ed(0x205),_0x2540ed(0x225))['from'](_0x2540ed(0x229))[_0x2540ed(0x1f9)]('ParentId\x20IN\x20(:componentHistoryIds)',{'componentHistoryIds':_0x561901}),_0x549baf=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x2540ed(0x222)],'api':this[_0x2540ed(0x224)],'pollInterval':0x1388,'queryBuilder':_0x238383,'objectName':_0x2540ed(0x229),'contentType':salesforce_1[_0x2540ed(0x233)][_0x2540ed(0x216)],'jobOperation':salesforce_1[_0x2540ed(0x1fe)][_0x2540ed(0x235)]});let _0x172d10=0x0;do{const _0x1f3935=await _0x549baf[_0x2540ed(0x213)]();if(!_0x1f3935)break;const _0x324ef4=new salesforce_2[(_0x2540ed(0x210))]({'binaryFields':BINARY_FIELDS});for await(const _0x5736b1 of _0x1f3935[_0x2540ed(0x22b)](_0x324ef4)){_0x172d10++;const _0x4b84df=new adm_zip_1[(_0x2540ed(0x1fb))](_0x5736b1[_0x2540ed(0x1fd)]);this[_0x2540ed(0x23b)]&&await this[_0x2540ed(0x1fc)](_0x4b84df),await(0x0,utils_1[_0x2540ed(0x21a)])(_0x4b84df,this[_0x2540ed(0x211)]);}}while(!_0x549baf[_0x2540ed(0x206)]());return _0x172d10;}async['applyFlosumVariables'](_0x89dc86){const _0x903b6e=a62_0x5bd286,_0x2df5f9=_0x89dc86['getEntries']();_0x2df5f9[_0x903b6e(0x226)](_0xea4b89=>{const _0x22b200=_0x903b6e,_0x6eb0ff=_0xea4b89[_0x22b200(0x22f)],_0x52ed76=_0x6eb0ff[_0x22b200(0x1ff)](_0x6eb0ff[_0x22b200(0x1ef)]('.')+0x1);if(!EXCLUDED_TYPES[_0x22b200(0x214)](_0x52ed76)){let _0x763c75=_0xea4b89[_0x22b200(0x223)]()[_0x22b200(0x21f)]('utf8'),_0x445c49=![];for(const _0x511a26 in this[_0x22b200(0x21d)]){const _0x4c81f7='%%'+_0x511a26+'%%';if(_0x763c75[_0x22b200(0x1f7)](_0x4c81f7)!==-0x1){const _0xc8e6d2=new RegExp(_0x4c81f7,'ig');_0x763c75=_0x763c75['replace'](_0xc8e6d2,this[_0x22b200(0x21d)][_0x511a26]),_0x445c49=!![];}}_0x445c49&&_0x89dc86[_0x22b200(0x234)](_0xea4b89,Buffer[_0x22b200(0x20d)](_0x763c75,_0x22b200(0x230)));}});}async[a62_0x5bd286(0x215)](){const _0x4a1e5e=a62_0x5bd286,_0x342c67=[],_0x38068a=new salesforce_2[(_0x4a1e5e(0x1eb))]()['select']('Id')[_0x4a1e5e(0x20d)](this[_0x4a1e5e(0x237)]+_0x4a1e5e(0x1f5))[_0x4a1e5e(0x1f9)](this[_0x4a1e5e(0x237)]+'Branch__c\x20=\x20:branchId',{'branchId':this['branchId']})[_0x4a1e5e(0x203)](this[_0x4a1e5e(0x237)]+_0x4a1e5e(0x221),{'type':B2C_CARTRIDGE_TYPE})[_0x4a1e5e(0x1f2)](),_0x54b972=new salesforce_2['QueryBuilder']()[_0x4a1e5e(0x227)]('Id')['from'](this[_0x4a1e5e(0x237)]+_0x4a1e5e(0x1ee))[_0x4a1e5e(0x1f9)](this['namespace']+_0x4a1e5e(0x22e)+_0x38068a+')')[_0x4a1e5e(0x203)](this[_0x4a1e5e(0x237)]+_0x4a1e5e(0x238),{'isLastVersion':!![]}),_0x8d3a94=new salesforce_2['CompositeRetrieveData']({'api':this['apiVersion'],'queryBuilder':_0x54b972,'instance':this[_0x4a1e5e(0x222)],'isTooling':![]});do{const _0x3a7535=await _0x8d3a94['execute']()[_0x4a1e5e(0x232)](({records:_0x3ccee5})=>_0x3ccee5['map'](_0x6792fa=>_0x6792fa['Id']));_0x3a7535['length']&&_0x342c67[_0x4a1e5e(0x1f8)](_0x3a7535);}while(!_0x8d3a94[_0x4a1e5e(0x206)]());return _0x342c67;}async['execute'](){const _0x1248dc=a62_0x5bd286,_0x305c0c=await this[_0x1248dc(0x215)]();let _0x4abe1a=0x0;for(const _0x3d5563 of _0x305c0c){_0x4abe1a+=await this[_0x1248dc(0x236)](_0x3d5563);}await this['logger'][_0x1248dc(0x200)](_0x1248dc(0x20f)+_0x4abe1a+_0x1248dc(0x201));}}function a62_0x4d6a(){const _0x60851=['355GkIMiY','Attachment','logger','pipe','adm-zip','754906krLOJV','Component__c\x20IN\x20(','name','utf8','gzip','then','BulkV1QueryContentType','updateFile','Query','retriveAttachments','namespace','isLastVersion__c\x20=\x20:isLastVersion','eot','30126646tKIiWB','isFlosumVariables','88674mJczOE','otf','QueryBuilder','keys','branchId','Component_History__c','lastIndexOf','780732MNJrJi','woff','build','195042gyYHrp','126LlClIz','Component__c','pdf','indexOf','push','where','28FzuGvD','default','applyFlosumVariables','Body','Bulk1JobOperation','substring','log','\x20file(s).','1608592ejpSEF','andWhere','woff2','Name','getIsDone','@flosum/salesforce','zip','(((.+)+)+)+$','svg','__importDefault','ico','from','constructor','Retrieved\x20','BulkXmlStreamParser','jobPath','rar','execute','includes','getComponentHistoryIds','APPLICATION_XML','png','jpeg','jpg','extractAllToAsync','search','52FiEsnI','variables','CartridgeFile','toString','704400moYjgP','Component_Type__c\x20=\x20:type','axiosInstance','getData','apiVersion','BodyLength','forEach','select'];a62_0x4d6a=function(){return _0x60851;};return a62_0x4d6a();}exports['default']=RetrieveCartridges;