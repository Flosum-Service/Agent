const a62_0x3d2861=a62_0x1cef;(function(_0x30ff78,_0x447904){const _0x338668=a62_0x1cef,_0x3694b3=_0x30ff78();while(!![]){try{const _0x446934=-parseInt(_0x338668(0x1ce))/0x1+parseInt(_0x338668(0x1f2))/0x2*(-parseInt(_0x338668(0x1eb))/0x3)+-parseInt(_0x338668(0x1ba))/0x4+-parseInt(_0x338668(0x1ea))/0x5*(parseInt(_0x338668(0x1de))/0x6)+-parseInt(_0x338668(0x1f8))/0x7+-parseInt(_0x338668(0x1c8))/0x8*(-parseInt(_0x338668(0x1d1))/0x9)+parseInt(_0x338668(0x1cc))/0xa*(parseInt(_0x338668(0x1f0))/0xb);if(_0x446934===_0x447904)break;else _0x3694b3['push'](_0x3694b3['shift']());}catch(_0x3847b9){_0x3694b3['push'](_0x3694b3['shift']());}}}(a62_0x2efc,0x52c85));const a62_0x18a382=(function(){let _0xa469eb=!![];return function(_0x4de081,_0xcaa756){const _0x1a8eef=_0xa469eb?function(){const _0x2cd6e9=a62_0x1cef;if(_0xcaa756){const _0x4763a2=_0xcaa756[_0x2cd6e9(0x1c3)](_0x4de081,arguments);return _0xcaa756=null,_0x4763a2;}}:function(){};return _0xa469eb=![],_0x1a8eef;};}()),a62_0xc8fc09=a62_0x18a382(this,function(){const _0x3ab3ff=a62_0x1cef;return a62_0xc8fc09[_0x3ab3ff(0x1e6)]()['search'](_0x3ab3ff(0x1d4))[_0x3ab3ff(0x1e6)]()[_0x3ab3ff(0x1dc)](a62_0xc8fc09)[_0x3ab3ff(0x1ca)](_0x3ab3ff(0x1d4));});a62_0xc8fc09();'use strict';var __importDefault=this&&this[a62_0x3d2861(0x1cb)]||function(_0x4aec31){const _0x4d1e85=a62_0x3d2861;return _0x4aec31&&_0x4aec31[_0x4d1e85(0x1e8)]?_0x4aec31:{'default':_0x4aec31};};function a62_0x1cef(_0x3ea71b,_0x24d531){const _0x122e7f=a62_0x2efc();return a62_0x1cef=function(_0xc8fc09,_0x18a382){_0xc8fc09=_0xc8fc09-0x1b1;let _0x2efc4b=_0x122e7f[_0xc8fc09];return _0x2efc4b;},a62_0x1cef(_0x3ea71b,_0x24d531);}Object['defineProperty'](exports,a62_0x3d2861(0x1e8),{'value':!![]});const salesforce_1=require('@flosum/salesforce'),salesforce_2=require(a62_0x3d2861(0x1db)),utils_1=require(a62_0x3d2861(0x1c0)),adm_zip_1=__importDefault(require(a62_0x3d2861(0x1b5))),B2C_CARTRIDGE_TYPE='CartridgeFile',BINARY_FIELDS=[a62_0x3d2861(0x1b1)],EXCLUDED_TYPES=[a62_0x3d2861(0x1df),'svg','eot','otf',a62_0x3d2861(0x1d6),a62_0x3d2861(0x1e7),a62_0x3d2861(0x1fa),a62_0x3d2861(0x1ed),a62_0x3d2861(0x1c6),'ico',a62_0x3d2861(0x1b3),a62_0x3d2861(0x1ee),'gzip',a62_0x3d2861(0x1f6)];class RetrieveCartridges{constructor(_0x12a0d3,_0x5b6233,_0x1644bc,_0x3c52b3,_0x151dae,_0x30fd64,_0x4ba447){const _0x4b1df4=a62_0x3d2861;this['jobPath']=_0x12a0d3,this[_0x4b1df4(0x1c5)]=_0x5b6233,this[_0x4b1df4(0x1e9)]=_0x1644bc,this['namespace']=_0x3c52b3,this[_0x4b1df4(0x1bf)]=_0x151dae,this[_0x4b1df4(0x1d0)]=_0x30fd64,this[_0x4b1df4(0x1b9)]=_0x4ba447,this[_0x4b1df4(0x1f4)]=![],this['isFlosumVariables']=Object['keys'](this[_0x4b1df4(0x1d0)])['length']>0x0;}async[a62_0x3d2861(0x1c9)](_0x300167){const _0x3396dc=a62_0x3d2861,_0x2d5d5f=new salesforce_2[(_0x3396dc(0x1d9))]()[_0x3396dc(0x1f3)](_0x3396dc(0x1b1),_0x3396dc(0x1cd),_0x3396dc(0x1d3))[_0x3396dc(0x1e1)](_0x3396dc(0x1b6))[_0x3396dc(0x1cf)]('ParentId\x20IN\x20(:componentHistoryIds)',{'componentHistoryIds':_0x300167}),_0x51b80a=new salesforce_1[(_0x3396dc(0x1bc))]({'instance':this[_0x3396dc(0x1c5)],'api':this[_0x3396dc(0x1e9)],'pollInterval':0x1388,'queryBuilder':_0x2d5d5f,'objectName':_0x3396dc(0x1b6),'contentType':salesforce_1['BulkV1QueryContentType']['APPLICATION_XML'],'jobOperation':salesforce_1['Bulk1JobOperation']['Query']});let _0x4da6e5=0x0;do{const _0x4daf00=await _0x51b80a[_0x3396dc(0x1d8)]();if(!_0x4daf00)break;const _0x2cf5ed=new salesforce_2[(_0x3396dc(0x1e4))]({'binaryFields':BINARY_FIELDS});for await(const _0x555cf0 of _0x4daf00[_0x3396dc(0x1c2)](_0x2cf5ed)){_0x4da6e5++;const _0x3a536e=new adm_zip_1['default'](_0x555cf0[_0x3396dc(0x1b1)]);this['isFlosumVariables']&&await this[_0x3396dc(0x1fb)](_0x3a536e),await(0x0,utils_1['extractAllToAsync'])(_0x3a536e,this[_0x3396dc(0x1b4)]);}}while(!_0x51b80a[_0x3396dc(0x1f1)]());return _0x4da6e5;}async[a62_0x3d2861(0x1fb)](_0x1907cb){const _0x5500f9=a62_0x3d2861,_0x3a3a0c=_0x1907cb[_0x5500f9(0x1e3)]();_0x3a3a0c[_0x5500f9(0x1f7)](_0x2e596d=>{const _0x25e007=_0x5500f9,_0x38db71=_0x2e596d[_0x25e007(0x1be)],_0x12ff07=_0x38db71[_0x25e007(0x1fc)](_0x38db71[_0x25e007(0x1ef)]('.')+0x1);if(!EXCLUDED_TYPES[_0x25e007(0x1d2)](_0x12ff07)){let _0x4ae47e=_0x2e596d[_0x25e007(0x1ec)]()['toString']('utf8'),_0x49f63f=![];for(const _0x2484b1 in this[_0x25e007(0x1d0)]){const _0x10f913='%%'+_0x2484b1+'%%';if(_0x4ae47e['indexOf'](_0x10f913)!==-0x1){const _0x3d1089=new RegExp(_0x10f913,'ig');_0x4ae47e=_0x4ae47e['replace'](_0x3d1089,this['variables'][_0x2484b1]),_0x49f63f=!![];}}_0x49f63f&&_0x1907cb[_0x25e007(0x1d5)](_0x2e596d,Buffer[_0x25e007(0x1e1)](_0x4ae47e,_0x25e007(0x1f5)));}});}async[a62_0x3d2861(0x1d7)](){const _0x3520b7=a62_0x3d2861,_0x2c50e7=[],_0x2bbe0c=new salesforce_2[(_0x3520b7(0x1d9))]()[_0x3520b7(0x1f3)]('Id')[_0x3520b7(0x1e1)](this[_0x3520b7(0x1c4)]+_0x3520b7(0x1c7))[_0x3520b7(0x1cf)](this[_0x3520b7(0x1c4)]+'Branch__c\x20=\x20:branchId',{'branchId':this[_0x3520b7(0x1bf)]})[_0x3520b7(0x1e0)](this[_0x3520b7(0x1c4)]+_0x3520b7(0x1b8),{'type':B2C_CARTRIDGE_TYPE})[_0x3520b7(0x1f9)](),_0x52f63f=new salesforce_2[(_0x3520b7(0x1d9))]()[_0x3520b7(0x1f3)]('Id')[_0x3520b7(0x1e1)](this[_0x3520b7(0x1c4)]+_0x3520b7(0x1b2))[_0x3520b7(0x1cf)](this[_0x3520b7(0x1c4)]+_0x3520b7(0x1da)+_0x2bbe0c+')')[_0x3520b7(0x1e0)](this[_0x3520b7(0x1c4)]+'isLastVersion__c\x20=\x20:isLastVersion',{'isLastVersion':!![]}),_0xd8e117=new salesforce_2['CompositeRetrieveData']({'api':this[_0x3520b7(0x1e9)],'queryBuilder':_0x52f63f,'instance':this[_0x3520b7(0x1c5)],'isTooling':![]});do{const _0x4263a8=await _0xd8e117['execute']()[_0x3520b7(0x1bb)](({records:_0x37fd8b})=>_0x37fd8b[_0x3520b7(0x1b7)](_0x58f678=>_0x58f678['Id']));_0x4263a8[_0x3520b7(0x1bd)]&&_0x2c50e7[_0x3520b7(0x1c1)](_0x4263a8);}while(!_0xd8e117[_0x3520b7(0x1f1)]());return _0x2c50e7;}async['execute'](){const _0x54ef11=a62_0x3d2861,_0x2f09e9=await this['getComponentHistoryIds']();let _0x1e2c1b=0x0;for(const _0x29342f of _0x2f09e9){_0x1e2c1b+=await this['retriveAttachments'](_0x29342f);}await this['logger'][_0x54ef11(0x1e2)](_0x54ef11(0x1e5)+_0x1e2c1b+_0x54ef11(0x1dd));}}function a62_0x2efc(){const _0x53fc4a=['Component_Type__c\x20=\x20:type','logger','952436GCwCpS','then','Bulk1RetrieveData','length','name','branchId','./utils','push','pipe','apply','namespace','axiosInstance','ttf','Component__c','104CwIeXl','retriveAttachments','search','__importDefault','196780ZGupUs','Name','459746kZGfyt','where','variables','219339nLdKlE','includes','BodyLength','(((.+)+)+)+$','updateFile','jpeg','getComponentHistoryIds','execute','QueryBuilder','Component__c\x20IN\x20(','@flosum/salesforce','constructor','\x20file(s).','51654oVMwGA','jpg','andWhere','from','log','getEntries','BulkXmlStreamParser','Retrieved\x20','toString','png','__esModule','apiVersion','265QJxhgF','187554YvQJwS','getData','woff2','rar','lastIndexOf','1034BphPov','getIsDone','2JGRtih','select','isFlosumVariables','utf8','pdf','forEach','4275796COCAWG','build','woff','applyFlosumVariables','substring','Body','Component_History__c','zip','jobPath','adm-zip','Attachment','map'];a62_0x2efc=function(){return _0x53fc4a;};return a62_0x2efc();}exports['default']=RetrieveCartridges;