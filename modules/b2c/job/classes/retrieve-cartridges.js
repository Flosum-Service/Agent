const a60_0x4ba402=a60_0x4341;(function(_0x554be6,_0x5b3bd7){const _0x3609e6=a60_0x4341,_0x39d523=_0x554be6();while(!![]){try{const _0x41fef5=-parseInt(_0x3609e6(0xf4))/0x1*(parseInt(_0x3609e6(0xdb))/0x2)+parseInt(_0x3609e6(0xef))/0x3*(-parseInt(_0x3609e6(0xde))/0x4)+parseInt(_0x3609e6(0xe7))/0x5*(-parseInt(_0x3609e6(0xfa))/0x6)+-parseInt(_0x3609e6(0x115))/0x7+parseInt(_0x3609e6(0x112))/0x8+parseInt(_0x3609e6(0xe8))/0x9+parseInt(_0x3609e6(0x111))/0xa;if(_0x41fef5===_0x5b3bd7)break;else _0x39d523['push'](_0x39d523['shift']());}catch(_0x4a6248){_0x39d523['push'](_0x39d523['shift']());}}}(a60_0x2dfc,0x42c8b));const a60_0x1b1edf=(function(){let _0x351337=!![];return function(_0xd4f4e1,_0x532512){const _0x35c5ee=_0x351337?function(){const _0x1cb9db=a60_0x4341;if(_0x532512){const _0x20e142=_0x532512[_0x1cb9db(0xf6)](_0xd4f4e1,arguments);return _0x532512=null,_0x20e142;}}:function(){};return _0x351337=![],_0x35c5ee;};}()),a60_0x18d26b=a60_0x1b1edf(this,function(){const _0xeb76eb=a60_0x4341;return a60_0x18d26b[_0xeb76eb(0x10d)]()['search'](_0xeb76eb(0xf7))[_0xeb76eb(0x10d)]()[_0xeb76eb(0xfc)](a60_0x18d26b)[_0xeb76eb(0xf1)](_0xeb76eb(0xf7));});function a60_0x4341(_0x36aec1,_0x4a4762){const _0x15a205=a60_0x2dfc();return a60_0x4341=function(_0x18d26b,_0x1b1edf){_0x18d26b=_0x18d26b-0xcb;let _0x2dfce2=_0x15a205[_0x18d26b];return _0x2dfce2;},a60_0x4341(_0x36aec1,_0x4a4762);}a60_0x18d26b();'use strict';var __importDefault=this&&this[a60_0x4ba402(0xfb)]||function(_0x468f44){const _0x504b1e=a60_0x4ba402;return _0x468f44&&_0x468f44[_0x504b1e(0xfd)]?_0x468f44:{'default':_0x468f44};};Object[a60_0x4ba402(0x10e)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a60_0x4ba402(0xe4)),salesforce_2=require('@flosum/salesforce'),utils_1=require('./utils'),adm_zip_1=__importDefault(require(a60_0x4ba402(0x114))),B2C_CARTRIDGE_TYPE=a60_0x4ba402(0xdf),BINARY_FIELDS=[a60_0x4ba402(0x104)],EXCLUDED_TYPES=['jpg',a60_0x4ba402(0x10b),a60_0x4ba402(0x11b),a60_0x4ba402(0xe2),a60_0x4ba402(0xd1),a60_0x4ba402(0xe5),'woff',a60_0x4ba402(0xd4),'ttf',a60_0x4ba402(0xd5),a60_0x4ba402(0xd7),a60_0x4ba402(0xd0),a60_0x4ba402(0x107),'pdf'];class RetrieveCartridges{constructor(_0x270db3,_0x1d33c6,_0x28a81c,_0x1f1016,_0x294b91,_0x45957d,_0x9443b5){const _0x1ae2d7=a60_0x4ba402;this[_0x1ae2d7(0xea)]=_0x270db3,this[_0x1ae2d7(0x11a)]=_0x1d33c6,this[_0x1ae2d7(0x118)]=_0x28a81c,this[_0x1ae2d7(0xfe)]=_0x1f1016,this[_0x1ae2d7(0x103)]=_0x294b91,this[_0x1ae2d7(0xf2)]=_0x45957d,this['logger']=_0x9443b5,this[_0x1ae2d7(0xf0)]=![],this[_0x1ae2d7(0xf0)]=Object[_0x1ae2d7(0xed)](this[_0x1ae2d7(0xf2)])[_0x1ae2d7(0xf5)]>0x0;}async[a60_0x4ba402(0xcc)](_0x558d6f){const _0x2a4978=a60_0x4ba402,_0x525c12=new salesforce_2[(_0x2a4978(0x106))]()['select'](_0x2a4978(0x104),_0x2a4978(0xff),_0x2a4978(0xcf))[_0x2a4978(0xe6)](_0x2a4978(0xe1))[_0x2a4978(0xd9)]('ParentId\x20IN\x20(:componentHistoryIds)',{'componentHistoryIds':_0x558d6f}),_0x22346e=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x2a4978(0x11a)],'api':this['apiVersion'],'pollInterval':0x1388,'queryBuilder':_0x525c12,'objectName':_0x2a4978(0xe1),'contentType':salesforce_1[_0x2a4978(0xce)]['APPLICATION_XML'],'jobOperation':salesforce_1[_0x2a4978(0xd8)][_0x2a4978(0xf3)]});let _0x1b05de=0x0;do{const _0x468ca2=await _0x22346e[_0x2a4978(0x10c)]();if(!_0x468ca2)break;const _0x2cfceb=new salesforce_2['BulkXmlStreamParser']({'binaryFields':BINARY_FIELDS});for await(const _0x5b61b5 of _0x468ca2[_0x2a4978(0xda)](_0x2cfceb)){_0x1b05de++;const _0x4b8e6b=new adm_zip_1[(_0x2a4978(0x102))](_0x5b61b5[_0x2a4978(0x104)]);this[_0x2a4978(0xf0)]&&await this['applyFlosumVariables'](_0x4b8e6b),await(0x0,utils_1[_0x2a4978(0xeb)])(_0x4b8e6b,this[_0x2a4978(0xea)]);}}while(!_0x22346e[_0x2a4978(0x117)]());return _0x1b05de;}async[a60_0x4ba402(0xe3)](_0x1a9978){const _0x181118=a60_0x4ba402,_0xf32f66=_0x1a9978['getEntries']();_0xf32f66[_0x181118(0x105)](_0x539d1d=>{const _0x233509=_0x181118,_0x441dee=_0x539d1d[_0x233509(0xd3)],_0x15cf91=_0x441dee[_0x233509(0xf8)](_0x441dee[_0x233509(0x10a)]('.')+0x1);if(!EXCLUDED_TYPES['includes'](_0x15cf91)){let _0x1cd310=_0x539d1d[_0x233509(0xd6)]()[_0x233509(0x10d)](_0x233509(0xf9)),_0x738cd=![];for(const _0x3ae50c in this[_0x233509(0xf2)]){const _0x202c0f='%%'+_0x3ae50c+'%%';if(_0x1cd310[_0x233509(0xe9)](_0x202c0f)!==-0x1){const _0x4ee49b=new RegExp(_0x202c0f,'ig');_0x1cd310=_0x1cd310[_0x233509(0x110)](_0x4ee49b,this[_0x233509(0xf2)][_0x3ae50c]),_0x738cd=!![];}}_0x738cd&&_0x1a9978[_0x233509(0xe0)](_0x539d1d,Buffer['from'](_0x1cd310,_0x233509(0xf9)));}});}async['getComponentHistoryIds'](){const _0x5b6ee8=a60_0x4ba402,_0x19ee0d=[],_0x283a35=new salesforce_2['QueryBuilder']()[_0x5b6ee8(0x108)]('Id')['from'](this[_0x5b6ee8(0xfe)]+_0x5b6ee8(0x113))['where'](this[_0x5b6ee8(0xfe)]+_0x5b6ee8(0x119),{'branchId':this[_0x5b6ee8(0x103)]})[_0x5b6ee8(0xec)](this[_0x5b6ee8(0xfe)]+_0x5b6ee8(0x116),{'type':B2C_CARTRIDGE_TYPE})[_0x5b6ee8(0xd2)](),_0x578bb9=new salesforce_2[(_0x5b6ee8(0x106))]()[_0x5b6ee8(0x108)]('Id')[_0x5b6ee8(0xe6)](this['namespace']+_0x5b6ee8(0xdd))['where'](this[_0x5b6ee8(0xfe)]+'Component__c\x20IN\x20('+_0x283a35+')')['andWhere'](this[_0x5b6ee8(0xfe)]+_0x5b6ee8(0x101),{'isLastVersion':!![]}),_0x354e40=new salesforce_2[(_0x5b6ee8(0x10f))]({'api':this[_0x5b6ee8(0x118)],'queryBuilder':_0x578bb9,'instance':this[_0x5b6ee8(0x11a)],'isTooling':![]});do{const _0x119c8b=await _0x354e40[_0x5b6ee8(0x10c)]()[_0x5b6ee8(0x109)](({records:_0xc3c313})=>_0xc3c313['map'](_0x1c68d4=>_0x1c68d4['Id']));_0x119c8b[_0x5b6ee8(0xf5)]&&_0x19ee0d[_0x5b6ee8(0xdc)](_0x119c8b);}while(!_0x354e40[_0x5b6ee8(0x117)]());return _0x19ee0d;}async['execute'](){const _0x1f42df=a60_0x4ba402,_0x1d61d6=await this[_0x1f42df(0x100)]();let _0x4f2a9e=0x0;for(const _0x31ee8d of _0x1d61d6){_0x4f2a9e+=await this[_0x1f42df(0xcc)](_0x31ee8d);}await this[_0x1f42df(0xcd)]['log'](_0x1f42df(0xcb)+_0x4f2a9e+_0x1f42df(0xee));}}function a60_0x2dfc(){const _0x5ae5e8=['rar','jpeg','build','name','woff2','ico','getData','zip','Bulk1JobOperation','where','pipe','696302pHLpwo','push','Component_History__c','12652sePIkK','CartridgeFile','updateFile','Attachment','otf','applyFlosumVariables','@flosum/salesforce','png','from','15ePoNpW','252243mKKGgV','indexOf','jobPath','extractAllToAsync','andWhere','keys','\x20file(s).','393rCXZMr','isFlosumVariables','search','variables','Query','1HSVVZA','length','apply','(((.+)+)+)+$','substring','utf8','118362lsayrn','__importDefault','constructor','__esModule','namespace','Name','getComponentHistoryIds','isLastVersion__c\x20=\x20:isLastVersion','default','branchId','Body','forEach','QueryBuilder','gzip','select','then','lastIndexOf','svg','execute','toString','defineProperty','CompositeRetrieveData','replace','11454470zZTqKa','1513008hBcnOx','Component__c','adm-zip','1871576xFAdZS','Component_Type__c\x20=\x20:type','getIsDone','apiVersion','Branch__c\x20=\x20:branchId','axiosInstance','eot','Retrieved\x20','retriveAttachments','logger','BulkV1QueryContentType','BodyLength'];a60_0x2dfc=function(){return _0x5ae5e8;};return a60_0x2dfc();}exports[a60_0x4ba402(0x102)]=RetrieveCartridges;