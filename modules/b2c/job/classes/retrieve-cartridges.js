function a62_0x38c8(_0x379b4d,_0x3b5680){const _0x2169ff=a62_0x7953();return a62_0x38c8=function(_0x4ec125,_0x131912){_0x4ec125=_0x4ec125-0x1f4;let _0x7953d7=_0x2169ff[_0x4ec125];return _0x7953d7;},a62_0x38c8(_0x379b4d,_0x3b5680);}const a62_0x53c11a=a62_0x38c8;function a62_0x7953(){const _0x37ae26=['pipe','10291390BxnEsU','metadataLogId','354348QsdWOG','isFlosumVariables','getComponentHistoryIds','15eepsCQ','ArrayUtils','348664iFfhsl','60533vOhpcC','getSelectedComponentIds','getIsDone','join','Component__c','348wsjvzl','where','Get\x20list\x20of\x20components.','variables','applyFlosumVariables','ParentId\x20IN\x20(:parentIdIds)','constructor','apply','\x20file(s).','select','parse','toString','namespace','logger','getEntries','utf8','\x22\x20not\x20found.','default','isLastVersion__c\x20=\x20:isLastVersion','jpeg','__esModule','../../constants','from','splitOnChunks','map','length','mkdir','12kcMEaL','ico','extractAllToAsync','Retrieved\x20','FLOSUM_LIST_COMPONENTS_ATTACHMENT_NAME','BodyLength','execute','BulkXmlStreamParser','Id\x20IN\x20(:componentIds)','APPLICATION_XML','adm-zip','name','jobPath','includes','(((.+)+)+)+$','Component__c\x20IN\x20(','9lwbKwJ','eot','File\x20\x22','branchId','136VJoIjk','650547IGQlHY','log','apiVersion','CartridgeFile','substring','jpg','axiosInstance','png','replace','tmpPath','andWhere','indexOf','woff','otf','push','then','retrieveAttachments','Name','pdf','@flosum/utils','svg','path','./utils','exists','Attachment','Component_Type__c\x20=\x20:type','CompositeRetrieveData','../../../../configs/path','QueryBuilder','Query','__importDefault','Body','defineProperty','gzip','Bulk1RetrieveData','lastIndexOf','1379380xUhblz','147994xIYkvZ','@flosum/salesforce','ttf'];a62_0x7953=function(){return _0x37ae26;};return a62_0x7953();}(function(_0x4b972d,_0x2115b5){const _0x3003f2=a62_0x38c8,_0x2a22d6=_0x4b972d();while(!![]){try{const _0x9f9358=parseInt(_0x3003f2(0x23c))/0x1+-parseInt(_0x3003f2(0x206))/0x2*(parseInt(_0x3003f2(0x204))/0x3)+-parseInt(_0x3003f2(0x201))/0x4+parseInt(_0x3003f2(0x1fa))/0x5*(parseInt(_0x3003f2(0x227))/0x6)+-parseInt(_0x3003f2(0x1fb))/0x7*(parseInt(_0x3003f2(0x23b))/0x8)+-parseInt(_0x3003f2(0x237))/0x9*(-parseInt(_0x3003f2(0x1ff))/0xa)+-parseInt(_0x3003f2(0x207))/0xb*(parseInt(_0x3003f2(0x20c))/0xc);if(_0x9f9358===_0x2115b5)break;else _0x2a22d6['push'](_0x2a22d6['shift']());}catch(_0x290743){_0x2a22d6['push'](_0x2a22d6['shift']());}}}(a62_0x7953,0xb7a3e));const a62_0x131912=(function(){let _0x9e775d=!![];return function(_0x58dc9c,_0x263af5){const _0x4753e3=_0x9e775d?function(){const _0x2f0667=a62_0x38c8;if(_0x263af5){const _0x57fbaf=_0x263af5[_0x2f0667(0x213)](_0x58dc9c,arguments);return _0x263af5=null,_0x57fbaf;}}:function(){};return _0x9e775d=![],_0x4753e3;};}()),a62_0x4ec125=a62_0x131912(this,function(){const _0x5d9554=a62_0x38c8;return a62_0x4ec125['toString']()['search'](_0x5d9554(0x235))[_0x5d9554(0x217)]()[_0x5d9554(0x212)](a62_0x4ec125)['search'](_0x5d9554(0x235));});a62_0x4ec125();'use strict';var __importDefault=this&&this[a62_0x53c11a(0x1f4)]||function(_0x36ab4f){const _0x4d40a8=a62_0x53c11a;return _0x36ab4f&&_0x36ab4f[_0x4d40a8(0x220)]?_0x36ab4f:{'default':_0x36ab4f};};Object[a62_0x53c11a(0x1f6)](exports,a62_0x53c11a(0x220),{'value':!![]});const salesforce_1=require(a62_0x53c11a(0x1fc)),salesforce_2=require(a62_0x53c11a(0x1fc)),utils_1=require(a62_0x53c11a(0x252)),fs_internal_1=require('../../../git/internal/fs.internal'),path_1=require(a62_0x53c11a(0x257)),promises_1=require('fs/promises'),constants_1=require(a62_0x53c11a(0x221)),adm_zip_1=__importDefault(require(a62_0x53c11a(0x231))),path_2=__importDefault(require(a62_0x53c11a(0x251))),utils_2=require(a62_0x53c11a(0x24f)),chunkSize=0x1f4,B2C_CARTRIDGE_TYPE=a62_0x53c11a(0x23f),BINARY_FIELDS=[a62_0x53c11a(0x1f5)],EXCLUDED_TYPES=[a62_0x53c11a(0x241),a62_0x53c11a(0x250),a62_0x53c11a(0x238),a62_0x53c11a(0x249),a62_0x53c11a(0x21f),a62_0x53c11a(0x243),a62_0x53c11a(0x248),'woff2',a62_0x53c11a(0x1fd),a62_0x53c11a(0x228),'zip','rar',a62_0x53c11a(0x1f7),a62_0x53c11a(0x24e)];class RetrieveCartridges{constructor(_0x4e3168,_0x40e270,_0x33da97,_0x5c5e2e,_0x50a8ab,_0x15d3d8,_0x1f8ce4,_0x5af12d,_0x5753c5){const _0x2f1669=a62_0x53c11a;this[_0x2f1669(0x233)]=_0x4e3168,this['axiosInstance']=_0x40e270,this[_0x2f1669(0x23e)]=_0x33da97,this['namespace']=_0x5c5e2e,this['branchId']=_0x50a8ab,this[_0x2f1669(0x200)]=_0x15d3d8,this['logger']=_0x1f8ce4,this['systemLogger']=_0x5af12d,this['variables']=_0x5753c5,this[_0x2f1669(0x202)]=![],_0x5753c5&&(this[_0x2f1669(0x202)]=Object['keys'](_0x5753c5)[_0x2f1669(0x225)]>0x0);}async[a62_0x53c11a(0x24c)](_0x52b7da,_0x44a9f2){const _0xe3b6cb=a62_0x53c11a,_0x310a24=new salesforce_2[(_0xe3b6cb(0x258))]()[_0xe3b6cb(0x215)](_0xe3b6cb(0x1f5),_0xe3b6cb(0x24d),_0xe3b6cb(0x22c))['from'](_0xe3b6cb(0x254))[_0xe3b6cb(0x20d)](_0xe3b6cb(0x211),{'parentIdIds':_0x52b7da});_0x44a9f2&&_0x310a24[_0xe3b6cb(0x246)]('Name\x20IN\x20(:names)',{'names':_0x44a9f2});!await fs_internal_1['FS'][_0xe3b6cb(0x253)](path_1[_0xe3b6cb(0x245)])&&await(0x0,promises_1[_0xe3b6cb(0x226)])(path_1['tmpPath'],{'recursive':!![]});const _0x3d5534=new salesforce_1[(_0xe3b6cb(0x1f8))]({'instance':this[_0xe3b6cb(0x242)],'api':this[_0xe3b6cb(0x23e)],'pollInterval':0x1388,'queryBuilder':_0x310a24,'objectName':_0xe3b6cb(0x254),'contentType':salesforce_1['BulkV1QueryContentType'][_0xe3b6cb(0x230)],'jobOperation':salesforce_1['Bulk1JobOperation'][_0xe3b6cb(0x259)],'tmpPath':path_1[_0xe3b6cb(0x245)]}),_0x2c2bba=[];do{const _0x44b467=await _0x3d5534[_0xe3b6cb(0x22d)]();if(!_0x44b467)break;const _0x209e8c=new salesforce_2[(_0xe3b6cb(0x22e))]({'binaryFields':BINARY_FIELDS});for await(const _0x4a9f9b of _0x44b467[_0xe3b6cb(0x1fe)](_0x209e8c)){_0x2c2bba[_0xe3b6cb(0x24a)](_0x4a9f9b[_0xe3b6cb(0x1f5)]);}}while(!_0x3d5534[_0xe3b6cb(0x209)]());return _0x2c2bba;}async['applyFlosumVariables'](_0xb41f7a){const _0x8ac84f=a62_0x53c11a,_0x1221cd=_0xb41f7a[_0x8ac84f(0x21a)]();_0x1221cd['forEach'](_0x2da8dc=>{const _0x4c3d2d=_0x8ac84f,_0x418c9c=_0x2da8dc[_0x4c3d2d(0x232)],_0x4bfccd=_0x418c9c[_0x4c3d2d(0x240)](_0x418c9c[_0x4c3d2d(0x1f9)]('.')+0x1);if(!EXCLUDED_TYPES[_0x4c3d2d(0x234)](_0x4bfccd)){let _0x1c9614=_0x2da8dc['getData']()[_0x4c3d2d(0x217)]('utf8'),_0x567099=![];for(const _0x2e8fed in this[_0x4c3d2d(0x20f)]){const _0x33e32d='%%'+_0x2e8fed+'%%';if(_0x1c9614[_0x4c3d2d(0x247)](_0x33e32d)!==-0x1){const _0x1514fc=new RegExp(_0x33e32d,'ig');_0x1c9614=_0x1c9614[_0x4c3d2d(0x244)](_0x1514fc,this[_0x4c3d2d(0x20f)][_0x2e8fed]),_0x567099=!![];}}_0x567099&&_0xb41f7a['updateFile'](_0x2da8dc,Buffer[_0x4c3d2d(0x222)](_0x1c9614,_0x4c3d2d(0x21b)));}});}async[a62_0x53c11a(0x203)](_0x174739){const _0x188ba5=a62_0x53c11a,_0x195b9f=[];for(const _0xd0e9bf of utils_2[_0x188ba5(0x205)][_0x188ba5(0x223)](_0x174739,chunkSize)){const _0x468540=new salesforce_2[(_0x188ba5(0x258))]()['select']('Id')[_0x188ba5(0x222)](this[_0x188ba5(0x218)]+_0x188ba5(0x20b))['where'](this[_0x188ba5(0x218)]+'Branch__c\x20=\x20:branchId',{'branchId':this[_0x188ba5(0x23a)]})[_0x188ba5(0x246)](this[_0x188ba5(0x218)]+_0x188ba5(0x255),{'type':B2C_CARTRIDGE_TYPE})['andWhere'](_0x188ba5(0x22f),{'componentIds':_0xd0e9bf})['build'](),_0x43a4eb=new salesforce_2[(_0x188ba5(0x258))]()['select']('Id')[_0x188ba5(0x222)](this[_0x188ba5(0x218)]+'Component_History__c')[_0x188ba5(0x20d)](this[_0x188ba5(0x218)]+_0x188ba5(0x236)+_0x468540+')')[_0x188ba5(0x246)](this['namespace']+_0x188ba5(0x21e),{'isLastVersion':!![]}),_0x5b5fab=new salesforce_2[(_0x188ba5(0x256))]({'api':this['apiVersion'],'queryBuilder':_0x43a4eb,'instance':this[_0x188ba5(0x242)],'isTooling':![]});do{const _0x4bb43d=await _0x5b5fab[_0x188ba5(0x22d)]()[_0x188ba5(0x24b)](({records:_0x50451d})=>_0x50451d[_0x188ba5(0x224)](_0x1ca7fc=>_0x1ca7fc['Id']));_0x4bb43d[_0x188ba5(0x225)]&&_0x195b9f[_0x188ba5(0x24a)](_0x4bb43d);}while(!_0x5b5fab[_0x188ba5(0x209)]());}return _0x195b9f;}async[a62_0x53c11a(0x208)](){const _0x3f8f7e=a62_0x53c11a,_0x4c148c=path_2['default'][_0x3f8f7e(0x20a)](this[_0x3f8f7e(0x233)],constants_1['DEFAULT_CARTRIDGES_FOLDER']);await(0x0,promises_1[_0x3f8f7e(0x226)])(_0x4c148c);const [_0x30fe7e]=await this[_0x3f8f7e(0x24c)]([this['metadataLogId']],[constants_1['FLOSUM_LIST_COMPONENTS_ATTACHMENT_NAME']]);if(!_0x30fe7e)throw new Error(_0x3f8f7e(0x239)+constants_1[_0x3f8f7e(0x22b)]+_0x3f8f7e(0x21c));return await(0x0,promises_1['writeFile'])(path_2[_0x3f8f7e(0x21d)][_0x3f8f7e(0x20a)](_0x4c148c,constants_1[_0x3f8f7e(0x22b)]),_0x30fe7e),JSON[_0x3f8f7e(0x216)](_0x30fe7e['toString']());}async[a62_0x53c11a(0x22d)](){const _0x288fe4=a62_0x53c11a;await this[_0x288fe4(0x219)][_0x288fe4(0x23d)](_0x288fe4(0x20e));const _0x5f378a=await this[_0x288fe4(0x208)](),_0x443b94=await this[_0x288fe4(0x203)](_0x5f378a);let _0x5e31db=0x0;for(const _0x459b0f of utils_2['ArrayUtils'][_0x288fe4(0x223)](_0x443b94,chunkSize)){for(const _0x1fa4cb of await this[_0x288fe4(0x24c)](_0x459b0f)){const _0x21a5d8=new adm_zip_1[(_0x288fe4(0x21d))](_0x1fa4cb);this[_0x288fe4(0x202)]&&await this[_0x288fe4(0x210)](_0x21a5d8),await(0x0,utils_1[_0x288fe4(0x229)])(_0x21a5d8,this[_0x288fe4(0x233)]),_0x5e31db++;}}await this[_0x288fe4(0x219)][_0x288fe4(0x23d)](_0x288fe4(0x22a)+_0x5e31db+_0x288fe4(0x214));}}exports[a62_0x53c11a(0x21d)]=RetrieveCartridges;