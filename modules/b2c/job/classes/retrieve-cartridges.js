const a62_0x4090a6=a62_0x1387;(function(_0xb1f0f2,_0x44fd50){const _0x22cae3=a62_0x1387,_0x5091b6=_0xb1f0f2();while(!![]){try{const _0x48d4aa=parseInt(_0x22cae3(0x1d1))/0x1+-parseInt(_0x22cae3(0x19b))/0x2+-parseInt(_0x22cae3(0x1c2))/0x3*(-parseInt(_0x22cae3(0x1a8))/0x4)+-parseInt(_0x22cae3(0x1c1))/0x5*(parseInt(_0x22cae3(0x1a0))/0x6)+parseInt(_0x22cae3(0x1da))/0x7+parseInt(_0x22cae3(0x192))/0x8+-parseInt(_0x22cae3(0x199))/0x9*(parseInt(_0x22cae3(0x198))/0xa);if(_0x48d4aa===_0x44fd50)break;else _0x5091b6['push'](_0x5091b6['shift']());}catch(_0x507550){_0x5091b6['push'](_0x5091b6['shift']());}}}(a62_0x5c5f,0x8d590));const a62_0x37de75=(function(){let _0x39f331=!![];return function(_0x1bb9d4,_0x53b014){const _0x58baf3=_0x39f331?function(){const _0x441b30=a62_0x1387;if(_0x53b014){const _0x1d26da=_0x53b014[_0x441b30(0x191)](_0x1bb9d4,arguments);return _0x53b014=null,_0x1d26da;}}:function(){};return _0x39f331=![],_0x58baf3;};}()),a62_0x768190=a62_0x37de75(this,function(){const _0x24ee06=a62_0x1387;return a62_0x768190[_0x24ee06(0x18f)]()[_0x24ee06(0x1de)](_0x24ee06(0x1b4))[_0x24ee06(0x18f)]()['constructor'](a62_0x768190)[_0x24ee06(0x1de)](_0x24ee06(0x1b4));});a62_0x768190();'use strict';var __importDefault=this&&this[a62_0x4090a6(0x1ca)]||function(_0x1194af){const _0x4d1a05=a62_0x4090a6;return _0x1194af&&_0x1194af[_0x4d1a05(0x1cf)]?_0x1194af:{'default':_0x1194af};};Object['defineProperty'](exports,a62_0x4090a6(0x1cf),{'value':!![]});function a62_0x1387(_0x156b29,_0x5760dd){const _0x146728=a62_0x5c5f();return a62_0x1387=function(_0x768190,_0x37de75){_0x768190=_0x768190-0x18e;let _0x5c5fd0=_0x146728[_0x768190];return _0x5c5fd0;},a62_0x1387(_0x156b29,_0x5760dd);}function a62_0x5c5f(){const _0x550d2a=['\x20file(s).','woff','ico','replace','logger','Component_Type__c\x20=\x20:type','select','Component__c','woff2','getEntries','push','(((.+)+)+)+$','name','execute','Body','Component_History__c','length','includes','pipe','Branch__c\x20=\x20:branchId','zip','otf','from','branchId','280PLOFbz','3rgXUOM','axiosInstance','variables','BodyLength','rar','getIsDone','getComponentHistoryIds','utf8','__importDefault','isFlosumVariables','log','Bulk1RetrieveData','eot','__esModule','apiVersion','134250ZFAIlC','then','jobPath','retriveAttachments','ttf','ParentId\x20IN\x20(:componentHistoryIds)','extractAllToAsync','./utils','indexOf','1695113XOtKuJ','adm-zip','lastIndexOf','APPLICATION_XML','search','Query','toString','andWhere','apply','7462560NjmOdK','pdf','where','substring','@flosum/salesforce','Retrieved\x20','17140IZNcLF','2763FAdRdL','BulkXmlStreamParser','494804lhbCLU','jpg','Attachment','jpeg','forEach','25998LXWsUc','updateFile','gzip','Name','QueryBuilder','default','namespace','png','1143916VvFMEs'];a62_0x5c5f=function(){return _0x550d2a;};return a62_0x5c5f();}const salesforce_1=require(a62_0x4090a6(0x196)),salesforce_2=require('@flosum/salesforce'),utils_1=require(a62_0x4090a6(0x1d8)),adm_zip_1=__importDefault(require(a62_0x4090a6(0x1db))),B2C_CARTRIDGE_TYPE='CartridgeFile',BINARY_FIELDS=[a62_0x4090a6(0x1b7)],EXCLUDED_TYPES=[a62_0x4090a6(0x19c),'svg',a62_0x4090a6(0x1ce),a62_0x4090a6(0x1be),a62_0x4090a6(0x19e),a62_0x4090a6(0x1a7),a62_0x4090a6(0x1aa),a62_0x4090a6(0x1b1),a62_0x4090a6(0x1d5),a62_0x4090a6(0x1ab),a62_0x4090a6(0x1bd),a62_0x4090a6(0x1c6),a62_0x4090a6(0x1a2),a62_0x4090a6(0x193)];class RetrieveCartridges{constructor(_0x12385e,_0x353729,_0x21b3a0,_0x58c881,_0x1d6c15,_0x437a5f,_0x427f39){const _0x27d4e0=a62_0x4090a6;this[_0x27d4e0(0x1d3)]=_0x12385e,this[_0x27d4e0(0x1c3)]=_0x353729,this['apiVersion']=_0x21b3a0,this[_0x27d4e0(0x1a6)]=_0x58c881,this['branchId']=_0x1d6c15,this[_0x27d4e0(0x1c4)]=_0x437a5f,this[_0x27d4e0(0x1ad)]=_0x427f39,this['isFlosumVariables']=![],this[_0x27d4e0(0x1cb)]=Object['keys'](this['variables'])[_0x27d4e0(0x1b9)]>0x0;}async[a62_0x4090a6(0x1d4)](_0x15f5a0){const _0x35e9af=a62_0x4090a6,_0xe5720=new salesforce_2['QueryBuilder']()[_0x35e9af(0x1af)](_0x35e9af(0x1b7),_0x35e9af(0x1a3),_0x35e9af(0x1c5))[_0x35e9af(0x1bf)](_0x35e9af(0x19d))['where'](_0x35e9af(0x1d6),{'componentHistoryIds':_0x15f5a0}),_0x4958af=new salesforce_1[(_0x35e9af(0x1cd))]({'instance':this['axiosInstance'],'api':this['apiVersion'],'pollInterval':0x1388,'queryBuilder':_0xe5720,'objectName':'Attachment','contentType':salesforce_1['BulkV1QueryContentType'][_0x35e9af(0x1dd)],'jobOperation':salesforce_1['Bulk1JobOperation'][_0x35e9af(0x18e)]});let _0x1f46a1=0x0;do{const _0x819e98=await _0x4958af['execute']();if(!_0x819e98)break;const _0x3ab2bd=new salesforce_2[(_0x35e9af(0x19a))]({'binaryFields':BINARY_FIELDS});for await(const _0x30cc68 of _0x819e98[_0x35e9af(0x1bb)](_0x3ab2bd)){_0x1f46a1++;const _0x51f580=new adm_zip_1[(_0x35e9af(0x1a5))](_0x30cc68[_0x35e9af(0x1b7)]);this[_0x35e9af(0x1cb)]&&await this['applyFlosumVariables'](_0x51f580),await(0x0,utils_1[_0x35e9af(0x1d7)])(_0x51f580,this[_0x35e9af(0x1d3)]);}}while(!_0x4958af[_0x35e9af(0x1c7)]());return _0x1f46a1;}async['applyFlosumVariables'](_0x4b0aec){const _0x529499=a62_0x4090a6,_0x5099b0=_0x4b0aec[_0x529499(0x1b2)]();_0x5099b0[_0x529499(0x19f)](_0x3d196e=>{const _0x13fd62=_0x529499,_0x25c053=_0x3d196e[_0x13fd62(0x1b5)],_0x1551d6=_0x25c053[_0x13fd62(0x195)](_0x25c053[_0x13fd62(0x1dc)]('.')+0x1);if(!EXCLUDED_TYPES[_0x13fd62(0x1ba)](_0x1551d6)){let _0x49904f=_0x3d196e['getData']()[_0x13fd62(0x18f)]('utf8'),_0x3c3eb3=![];for(const _0x43c966 in this[_0x13fd62(0x1c4)]){const _0x3761be='%%'+_0x43c966+'%%';if(_0x49904f[_0x13fd62(0x1d9)](_0x3761be)!==-0x1){const _0x4e637f=new RegExp(_0x3761be,'ig');_0x49904f=_0x49904f[_0x13fd62(0x1ac)](_0x4e637f,this[_0x13fd62(0x1c4)][_0x43c966]),_0x3c3eb3=!![];}}_0x3c3eb3&&_0x4b0aec[_0x13fd62(0x1a1)](_0x3d196e,Buffer[_0x13fd62(0x1bf)](_0x49904f,_0x13fd62(0x1c9)));}});}async[a62_0x4090a6(0x1c8)](){const _0x596cb1=a62_0x4090a6,_0x3573f5=[],_0x2b7a8e=new salesforce_2[(_0x596cb1(0x1a4))]()['select']('Id')[_0x596cb1(0x1bf)](this['namespace']+_0x596cb1(0x1b0))['where'](this[_0x596cb1(0x1a6)]+_0x596cb1(0x1bc),{'branchId':this[_0x596cb1(0x1c0)]})[_0x596cb1(0x190)](this[_0x596cb1(0x1a6)]+_0x596cb1(0x1ae),{'type':B2C_CARTRIDGE_TYPE})['build'](),_0x282efc=new salesforce_2[(_0x596cb1(0x1a4))]()[_0x596cb1(0x1af)]('Id')[_0x596cb1(0x1bf)](this[_0x596cb1(0x1a6)]+_0x596cb1(0x1b8))[_0x596cb1(0x194)](this[_0x596cb1(0x1a6)]+'Component__c\x20IN\x20('+_0x2b7a8e+')')['andWhere'](this[_0x596cb1(0x1a6)]+'isLastVersion__c\x20=\x20:isLastVersion',{'isLastVersion':!![]}),_0x515da3=new salesforce_2['CompositeRetrieveData']({'api':this[_0x596cb1(0x1d0)],'queryBuilder':_0x282efc,'instance':this[_0x596cb1(0x1c3)],'isTooling':![]});do{const _0x293fc1=await _0x515da3[_0x596cb1(0x1b6)]()[_0x596cb1(0x1d2)](({records:_0x38190d})=>_0x38190d['map'](_0x2bf4f5=>_0x2bf4f5['Id']));_0x293fc1[_0x596cb1(0x1b9)]&&_0x3573f5[_0x596cb1(0x1b3)](_0x293fc1);}while(!_0x515da3[_0x596cb1(0x1c7)]());return _0x3573f5;}async[a62_0x4090a6(0x1b6)](){const _0x480e8a=a62_0x4090a6,_0x10fd6e=await this[_0x480e8a(0x1c8)]();let _0x392773=0x0;for(const _0x747684 of _0x10fd6e){_0x392773+=await this[_0x480e8a(0x1d4)](_0x747684);}await this[_0x480e8a(0x1ad)][_0x480e8a(0x1cc)](_0x480e8a(0x197)+_0x392773+_0x480e8a(0x1a9));}}exports[a62_0x4090a6(0x1a5)]=RetrieveCartridges;