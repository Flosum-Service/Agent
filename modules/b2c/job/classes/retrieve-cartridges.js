const a62_0x34a9b6=a62_0x99d3;function a62_0x99d3(_0x631c2f,_0x206918){const _0x4b57c6=a62_0x58ef();return a62_0x99d3=function(_0x44e0a8,_0xdfc294){_0x44e0a8=_0x44e0a8-0x173;let _0x58ef32=_0x4b57c6[_0x44e0a8];return _0x58ef32;},a62_0x99d3(_0x631c2f,_0x206918);}(function(_0x4d3c94,_0x5e79aa){const _0x1705d4=a62_0x99d3,_0x1b9b5d=_0x4d3c94();while(!![]){try{const _0x268b01=-parseInt(_0x1705d4(0x1b8))/0x1*(parseInt(_0x1705d4(0x179))/0x2)+parseInt(_0x1705d4(0x190))/0x3*(parseInt(_0x1705d4(0x17c))/0x4)+parseInt(_0x1705d4(0x195))/0x5+parseInt(_0x1705d4(0x186))/0x6+parseInt(_0x1705d4(0x180))/0x7+parseInt(_0x1705d4(0x1a1))/0x8*(-parseInt(_0x1705d4(0x1af))/0x9)+-parseInt(_0x1705d4(0x188))/0xa*(parseInt(_0x1705d4(0x177))/0xb);if(_0x268b01===_0x5e79aa)break;else _0x1b9b5d['push'](_0x1b9b5d['shift']());}catch(_0x2076d1){_0x1b9b5d['push'](_0x1b9b5d['shift']());}}}(a62_0x58ef,0x35100));function a62_0x58ef(){const _0x1bf5b8=['applyFlosumVariables','variables','namespace','woff2','Component__c\x20IN\x20(','andWhere','Body','(((.+)+)+)+$','./utils','24gQqhNB','ParentId\x20IN\x20(:componentHistoryIds)','log','keys','isFlosumVariables','length','ico','BodyLength','utf8','indexOf','substring','jpeg','name','otf','194769ZwJwtG','zip','default','Bulk1RetrieveData','retriveAttachments','pipe','@flosum/salesforce','select','from','13UIhWvs','CompositeRetrieveData','toString','__importDefault','getEntries','woff','BulkXmlStreamParser','replace','Name','Component_Type__c\x20=\x20:type','Attachment','defineProperty','build','2342857nsuXha','lastIndexOf','1234knnjyG','QueryBuilder','extractAllToAsync','596kEmHLM','then','Component_History__c','search','1257235ulrXkF','CartridgeFile','adm-zip','apiVersion','map','Branch__c\x20=\x20:branchId','1227030hPzTBg','svg','20hVPgTK','ttf','axiosInstance','includes','getIsDone','isLastVersion__c\x20=\x20:isLastVersion','jobPath','getData','759YfIHWu','where','jpg','\x20file(s).','apply','1472275HPPfhE','branchId','execute'];a62_0x58ef=function(){return _0x1bf5b8;};return a62_0x58ef();}const a62_0xdfc294=(function(){let _0x1c0e04=!![];return function(_0x5bb10b,_0x23b661){const _0x46e07f=_0x1c0e04?function(){const _0x3548a8=a62_0x99d3;if(_0x23b661){const _0x4b9992=_0x23b661[_0x3548a8(0x194)](_0x5bb10b,arguments);return _0x23b661=null,_0x4b9992;}}:function(){};return _0x1c0e04=![],_0x46e07f;};}()),a62_0x44e0a8=a62_0xdfc294(this,function(){const _0x2bd7a5=a62_0x99d3;return a62_0x44e0a8[_0x2bd7a5(0x1ba)]()['search'](_0x2bd7a5(0x19f))[_0x2bd7a5(0x1ba)]()['constructor'](a62_0x44e0a8)[_0x2bd7a5(0x17f)](_0x2bd7a5(0x19f));});a62_0x44e0a8();'use strict';var __importDefault=this&&this[a62_0x34a9b6(0x1bb)]||function(_0x4a2f56){return _0x4a2f56&&_0x4a2f56['__esModule']?_0x4a2f56:{'default':_0x4a2f56};};Object[a62_0x34a9b6(0x175)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a62_0x34a9b6(0x1b5)),salesforce_2=require('@flosum/salesforce'),utils_1=require(a62_0x34a9b6(0x1a0)),adm_zip_1=__importDefault(require(a62_0x34a9b6(0x182))),B2C_CARTRIDGE_TYPE=a62_0x34a9b6(0x181),BINARY_FIELDS=[a62_0x34a9b6(0x19e)],EXCLUDED_TYPES=[a62_0x34a9b6(0x192),a62_0x34a9b6(0x187),'eot',a62_0x34a9b6(0x1ae),a62_0x34a9b6(0x1ac),'png',a62_0x34a9b6(0x1bd),a62_0x34a9b6(0x19b),a62_0x34a9b6(0x189),a62_0x34a9b6(0x1a7),a62_0x34a9b6(0x1b0),'rar','gzip','pdf'];class RetrieveCartridges{constructor(_0x4290d5,_0x274f11,_0x515044,_0x4d3bc2,_0xc91108,_0x5629dd,_0x4efd3c){const _0x56d84d=a62_0x34a9b6;this['jobPath']=_0x4290d5,this[_0x56d84d(0x18a)]=_0x274f11,this[_0x56d84d(0x183)]=_0x515044,this[_0x56d84d(0x19a)]=_0x4d3bc2,this[_0x56d84d(0x196)]=_0xc91108,this[_0x56d84d(0x199)]=_0x5629dd,this['logger']=_0x4efd3c,this[_0x56d84d(0x1a5)]=![],this['isFlosumVariables']=Object[_0x56d84d(0x1a4)](this[_0x56d84d(0x199)])[_0x56d84d(0x1a6)]>0x0;}async['retriveAttachments'](_0x4a0f2e){const _0x2d2621=a62_0x34a9b6,_0x173947=new salesforce_2[(_0x2d2621(0x17a))]()[_0x2d2621(0x1b6)](_0x2d2621(0x19e),_0x2d2621(0x1c0),_0x2d2621(0x1a8))['from'](_0x2d2621(0x174))['where'](_0x2d2621(0x1a2),{'componentHistoryIds':_0x4a0f2e}),_0x4943b7=new salesforce_1[(_0x2d2621(0x1b2))]({'instance':this[_0x2d2621(0x18a)],'api':this[_0x2d2621(0x183)],'pollInterval':0x1388,'queryBuilder':_0x173947,'objectName':'Attachment','contentType':salesforce_1['BulkV1QueryContentType']['APPLICATION_XML'],'jobOperation':salesforce_1['Bulk1JobOperation']['Query']});let _0x45fb8f=0x0;do{const _0xd14ec8=await _0x4943b7[_0x2d2621(0x197)]();if(!_0xd14ec8)break;const _0x136cda=new salesforce_2[(_0x2d2621(0x1be))]({'binaryFields':BINARY_FIELDS});for await(const _0x47aa56 of _0xd14ec8[_0x2d2621(0x1b4)](_0x136cda)){_0x45fb8f++;const _0x10db64=new adm_zip_1[(_0x2d2621(0x1b1))](_0x47aa56['Body']);this['isFlosumVariables']&&await this[_0x2d2621(0x198)](_0x10db64),await(0x0,utils_1[_0x2d2621(0x17b)])(_0x10db64,this[_0x2d2621(0x18e)]);}}while(!_0x4943b7[_0x2d2621(0x18c)]());return _0x45fb8f;}async['applyFlosumVariables'](_0x332fc4){const _0x1fafc7=a62_0x34a9b6,_0x48012f=_0x332fc4[_0x1fafc7(0x1bc)]();_0x48012f['forEach'](_0x44130d=>{const _0x430240=_0x1fafc7,_0x49f4b8=_0x44130d[_0x430240(0x1ad)],_0x597715=_0x49f4b8[_0x430240(0x1ab)](_0x49f4b8[_0x430240(0x178)]('.')+0x1);if(!EXCLUDED_TYPES[_0x430240(0x18b)](_0x597715)){let _0x7320b7=_0x44130d[_0x430240(0x18f)]()['toString'](_0x430240(0x1a9)),_0x3b314c=![];for(const _0x2f970a in this[_0x430240(0x199)]){const _0x5a87a2='%%'+_0x2f970a+'%%';if(_0x7320b7[_0x430240(0x1aa)](_0x5a87a2)!==-0x1){const _0x4b89b5=new RegExp(_0x5a87a2,'ig');_0x7320b7=_0x7320b7[_0x430240(0x1bf)](_0x4b89b5,this[_0x430240(0x199)][_0x2f970a]),_0x3b314c=!![];}}_0x3b314c&&_0x332fc4['updateFile'](_0x44130d,Buffer[_0x430240(0x1b7)](_0x7320b7,'utf8'));}});}async['getComponentHistoryIds'](){const _0x163b19=a62_0x34a9b6,_0x51d82a=[],_0x1f1acb=new salesforce_2[(_0x163b19(0x17a))]()['select']('Id')[_0x163b19(0x1b7)](this['namespace']+'Component__c')['where'](this['namespace']+_0x163b19(0x185),{'branchId':this[_0x163b19(0x196)]})[_0x163b19(0x19d)](this['namespace']+_0x163b19(0x173),{'type':B2C_CARTRIDGE_TYPE})[_0x163b19(0x176)](),_0xf7a55c=new salesforce_2[(_0x163b19(0x17a))]()[_0x163b19(0x1b6)]('Id')[_0x163b19(0x1b7)](this[_0x163b19(0x19a)]+_0x163b19(0x17e))[_0x163b19(0x191)](this[_0x163b19(0x19a)]+_0x163b19(0x19c)+_0x1f1acb+')')['andWhere'](this[_0x163b19(0x19a)]+_0x163b19(0x18d),{'isLastVersion':!![]}),_0x49d6db=new salesforce_2[(_0x163b19(0x1b9))]({'api':this[_0x163b19(0x183)],'queryBuilder':_0xf7a55c,'instance':this['axiosInstance'],'isTooling':![]});do{const _0x9b128d=await _0x49d6db['execute']()[_0x163b19(0x17d)](({records:_0x4a2ad7})=>_0x4a2ad7[_0x163b19(0x184)](_0x4fa3a2=>_0x4fa3a2['Id']));_0x9b128d[_0x163b19(0x1a6)]&&_0x51d82a['push'](_0x9b128d);}while(!_0x49d6db[_0x163b19(0x18c)]());return _0x51d82a;}async[a62_0x34a9b6(0x197)](){const _0x2d4a72=a62_0x34a9b6,_0x19462c=await this['getComponentHistoryIds']();let _0x57fbe2=0x0;for(const _0x5c7f5a of _0x19462c){_0x57fbe2+=await this[_0x2d4a72(0x1b3)](_0x5c7f5a);}await this['logger'][_0x2d4a72(0x1a3)]('Retrieved\x20'+_0x57fbe2+_0x2d4a72(0x193));}}exports[a62_0x34a9b6(0x1b1)]=RetrieveCartridges;