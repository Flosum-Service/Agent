const a62_0x9d6b95=a62_0x4cac;function a62_0x562e(){const _0x43c371=['Component_Type__c\x20=\x20:type','getData','(((.+)+)+)+$','__esModule','lastIndexOf','indexOf','woff2','getComponentHistoryIds','name','execute','utf8','BodyLength','Branch__c\x20=\x20:branchId','andWhere','updateFile','Retrieved\x20','844336EoRTBf','./utils','keys','\x20file(s).','length','zip','toString','from','variables','55vaIJyc','ParentId\x20IN\x20(:componentHistoryIds)','207PmgcDh','png','retriveAttachments','build','getIsDone','getEntries','pdf','BulkV1QueryContentType','isFlosumVariables','forEach','adm-zip','eot','ttf','woff','namespace','jpg','Bulk1JobOperation','constructor','Attachment','search','extractAllToAsync','CompositeRetrieveData','otf','apiVersion','logger','CartridgeFile','gzip','jobPath','ico','includes','map','@flosum/salesforce','log','APPLICATION_XML','applyFlosumVariables','4398430saJEjM','branchId','2776921FAFPaJ','push','597183wjeSBD','QueryBuilder','Component__c\x20IN\x20(','where','370536dEftgz','default','jpeg','115272WzLxcu','Body','substring','Name','defineProperty','532402EKqlRy','3whnuho','axiosInstance'];a62_0x562e=function(){return _0x43c371;};return a62_0x562e();}(function(_0x46d74a,_0xefa936){const _0x4abc41=a62_0x4cac,_0x38e803=_0x46d74a();while(!![]){try{const _0x3a0b76=parseInt(_0x4abc41(0x127))/0x1+-parseInt(_0x4abc41(0x133))/0x2*(parseInt(_0x4abc41(0x134))/0x3)+-parseInt(_0x4abc41(0x146))/0x4+parseInt(_0x4abc41(0x14f))/0x5*(-parseInt(_0x4abc41(0x12b))/0x6)+parseInt(_0x4abc41(0x125))/0x7+parseInt(_0x4abc41(0x12e))/0x8*(parseInt(_0x4abc41(0x151))/0x9)+parseInt(_0x4abc41(0x123))/0xa;if(_0x3a0b76===_0xefa936)break;else _0x38e803['push'](_0x38e803['shift']());}catch(_0x56573f){_0x38e803['push'](_0x38e803['shift']());}}}(a62_0x562e,0x94917));const a62_0x4a1294=(function(){let _0x4de531=!![];return function(_0x178d23,_0x34dd97){const _0x1fe6f5=_0x4de531?function(){if(_0x34dd97){const _0x27f532=_0x34dd97['apply'](_0x178d23,arguments);return _0x34dd97=null,_0x27f532;}}:function(){};return _0x4de531=![],_0x1fe6f5;};}()),a62_0x224bbc=a62_0x4a1294(this,function(){const _0x27377b=a62_0x4cac;return a62_0x224bbc[_0x27377b(0x14c)]()['search'](_0x27377b(0x138))[_0x27377b(0x14c)]()[_0x27377b(0x162)](a62_0x224bbc)[_0x27377b(0x164)](_0x27377b(0x138));});a62_0x224bbc();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x17defe){return _0x17defe&&_0x17defe['__esModule']?_0x17defe:{'default':_0x17defe};};function a62_0x4cac(_0x3d4ef0,_0xccbbbf){const _0x1b6507=a62_0x562e();return a62_0x4cac=function(_0x224bbc,_0x4a1294){_0x224bbc=_0x224bbc-0x121;let _0x562e04=_0x1b6507[_0x224bbc];return _0x562e04;},a62_0x4cac(_0x3d4ef0,_0xccbbbf);}Object[a62_0x9d6b95(0x132)](exports,a62_0x9d6b95(0x139),{'value':!![]});const salesforce_1=require(a62_0x9d6b95(0x170)),salesforce_2=require(a62_0x9d6b95(0x170)),utils_1=require(a62_0x9d6b95(0x147)),adm_zip_1=__importDefault(require(a62_0x9d6b95(0x15b))),B2C_CARTRIDGE_TYPE=a62_0x9d6b95(0x16a),BINARY_FIELDS=[a62_0x9d6b95(0x12f)],EXCLUDED_TYPES=[a62_0x9d6b95(0x160),'svg',a62_0x9d6b95(0x15c),a62_0x9d6b95(0x167),a62_0x9d6b95(0x12d),a62_0x9d6b95(0x152),a62_0x9d6b95(0x15e),a62_0x9d6b95(0x13c),a62_0x9d6b95(0x15d),a62_0x9d6b95(0x16d),a62_0x9d6b95(0x14b),'rar',a62_0x9d6b95(0x16b),a62_0x9d6b95(0x157)];class RetrieveCartridges{constructor(_0x39c0b6,_0x318bcb,_0x1211bd,_0x57d305,_0x1b8728,_0x448f01,_0x18abc9){const _0x4d5bd3=a62_0x9d6b95;this[_0x4d5bd3(0x16c)]=_0x39c0b6,this[_0x4d5bd3(0x135)]=_0x318bcb,this[_0x4d5bd3(0x168)]=_0x1211bd,this['namespace']=_0x57d305,this[_0x4d5bd3(0x124)]=_0x1b8728,this['variables']=_0x448f01,this[_0x4d5bd3(0x169)]=_0x18abc9,this[_0x4d5bd3(0x159)]=![],this['isFlosumVariables']=Object[_0x4d5bd3(0x148)](this['variables'])[_0x4d5bd3(0x14a)]>0x0;}async[a62_0x9d6b95(0x153)](_0x2ced5d){const _0x3f3ca5=a62_0x9d6b95,_0x3ac94a=new salesforce_2['QueryBuilder']()['select'](_0x3f3ca5(0x12f),_0x3f3ca5(0x131),_0x3f3ca5(0x141))[_0x3f3ca5(0x14d)](_0x3f3ca5(0x163))[_0x3f3ca5(0x12a)](_0x3f3ca5(0x150),{'componentHistoryIds':_0x2ced5d}),_0x22315d=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x3f3ca5(0x135)],'api':this['apiVersion'],'pollInterval':0x1388,'queryBuilder':_0x3ac94a,'objectName':'Attachment','contentType':salesforce_1[_0x3f3ca5(0x158)][_0x3f3ca5(0x121)],'jobOperation':salesforce_1[_0x3f3ca5(0x161)]['Query']});let _0x10b94d=0x0;do{const _0x2e5d51=await _0x22315d[_0x3f3ca5(0x13f)]();if(!_0x2e5d51)break;const _0x3e7191=new salesforce_2['BulkXmlStreamParser']({'binaryFields':BINARY_FIELDS});for await(const _0x51c9e6 of _0x2e5d51['pipe'](_0x3e7191)){_0x10b94d++;const _0x23e1af=new adm_zip_1[(_0x3f3ca5(0x12c))](_0x51c9e6[_0x3f3ca5(0x12f)]);this[_0x3f3ca5(0x159)]&&await this[_0x3f3ca5(0x122)](_0x23e1af),await(0x0,utils_1[_0x3f3ca5(0x165)])(_0x23e1af,this[_0x3f3ca5(0x16c)]);}}while(!_0x22315d['getIsDone']());return _0x10b94d;}async[a62_0x9d6b95(0x122)](_0x58193a){const _0x2dab92=a62_0x9d6b95,_0x49046c=_0x58193a[_0x2dab92(0x156)]();_0x49046c[_0x2dab92(0x15a)](_0x37b231=>{const _0x10ed61=_0x2dab92,_0x1d2aff=_0x37b231[_0x10ed61(0x13e)],_0x5ea181=_0x1d2aff[_0x10ed61(0x130)](_0x1d2aff[_0x10ed61(0x13a)]('.')+0x1);if(!EXCLUDED_TYPES[_0x10ed61(0x16e)](_0x5ea181)){let _0x30eb4e=_0x37b231[_0x10ed61(0x137)]()['toString'](_0x10ed61(0x140)),_0x60b35e=![];for(const _0x2b8c83 in this[_0x10ed61(0x14e)]){const _0x2784a7='%%'+_0x2b8c83+'%%';if(_0x30eb4e[_0x10ed61(0x13b)](_0x2784a7)!==-0x1){const _0x45b122=new RegExp(_0x2784a7,'ig');_0x30eb4e=_0x30eb4e['replace'](_0x45b122,this['variables'][_0x2b8c83]),_0x60b35e=!![];}}_0x60b35e&&_0x58193a[_0x10ed61(0x144)](_0x37b231,Buffer[_0x10ed61(0x14d)](_0x30eb4e,'utf8'));}});}async[a62_0x9d6b95(0x13d)](){const _0x2f174e=a62_0x9d6b95,_0x464708=[],_0x2b7220=new salesforce_2[(_0x2f174e(0x128))]()['select']('Id')[_0x2f174e(0x14d)](this[_0x2f174e(0x15f)]+'Component__c')[_0x2f174e(0x12a)](this['namespace']+_0x2f174e(0x142),{'branchId':this[_0x2f174e(0x124)]})[_0x2f174e(0x143)](this[_0x2f174e(0x15f)]+_0x2f174e(0x136),{'type':B2C_CARTRIDGE_TYPE})[_0x2f174e(0x154)](),_0x3c3a97=new salesforce_2[(_0x2f174e(0x128))]()['select']('Id')[_0x2f174e(0x14d)](this[_0x2f174e(0x15f)]+'Component_History__c')[_0x2f174e(0x12a)](this[_0x2f174e(0x15f)]+_0x2f174e(0x129)+_0x2b7220+')')[_0x2f174e(0x143)](this['namespace']+'isLastVersion__c\x20=\x20:isLastVersion',{'isLastVersion':!![]}),_0x29c7de=new salesforce_2[(_0x2f174e(0x166))]({'api':this[_0x2f174e(0x168)],'queryBuilder':_0x3c3a97,'instance':this[_0x2f174e(0x135)],'isTooling':![]});do{const _0x4b34fc=await _0x29c7de['execute']()['then'](({records:_0x4d970f})=>_0x4d970f[_0x2f174e(0x16f)](_0x383cab=>_0x383cab['Id']));_0x4b34fc[_0x2f174e(0x14a)]&&_0x464708[_0x2f174e(0x126)](_0x4b34fc);}while(!_0x29c7de[_0x2f174e(0x155)]());return _0x464708;}async[a62_0x9d6b95(0x13f)](){const _0x45ed19=a62_0x9d6b95,_0x2c340b=await this['getComponentHistoryIds']();let _0x14ed62=0x0;for(const _0x40b3bc of _0x2c340b){_0x14ed62+=await this['retriveAttachments'](_0x40b3bc);}await this[_0x45ed19(0x169)][_0x45ed19(0x171)](_0x45ed19(0x145)+_0x14ed62+_0x45ed19(0x149));}}exports['default']=RetrieveCartridges;