function a62_0x5bf2(_0x3cb621,_0x1bbd43){const _0x5b2df4=a62_0x150d();return a62_0x5bf2=function(_0x12a987,_0x554168){_0x12a987=_0x12a987-0x6e;let _0x150d65=_0x5b2df4[_0x12a987];return _0x150d65;},a62_0x5bf2(_0x3cb621,_0x1bbd43);}const a62_0x9a64c6=a62_0x5bf2;(function(_0x15155f,_0x512cbb){const _0x2cccd8=a62_0x5bf2,_0x16908e=_0x15155f();while(!![]){try{const _0x21da89=-parseInt(_0x2cccd8(0xbe))/0x1*(-parseInt(_0x2cccd8(0xc1))/0x2)+parseInt(_0x2cccd8(0xb9))/0x3*(parseInt(_0x2cccd8(0xc2))/0x4)+parseInt(_0x2cccd8(0x8d))/0x5*(parseInt(_0x2cccd8(0xa6))/0x6)+-parseInt(_0x2cccd8(0x70))/0x7+parseInt(_0x2cccd8(0x97))/0x8*(parseInt(_0x2cccd8(0x8f))/0x9)+parseInt(_0x2cccd8(0xaa))/0xa*(parseInt(_0x2cccd8(0xa0))/0xb)+-parseInt(_0x2cccd8(0x76))/0xc;if(_0x21da89===_0x512cbb)break;else _0x16908e['push'](_0x16908e['shift']());}catch(_0x140ba7){_0x16908e['push'](_0x16908e['shift']());}}}(a62_0x150d,0xb1bed));const a62_0x554168=(function(){let _0x1ca1e6=!![];return function(_0x64fa50,_0x9d5835){const _0x1b9288=_0x1ca1e6?function(){if(_0x9d5835){const _0x13e1dc=_0x9d5835['apply'](_0x64fa50,arguments);return _0x9d5835=null,_0x13e1dc;}}:function(){};return _0x1ca1e6=![],_0x1b9288;};}()),a62_0x12a987=a62_0x554168(this,function(){const _0x2ea28d=a62_0x5bf2;return a62_0x12a987[_0x2ea28d(0x80)]()['search'](_0x2ea28d(0x7d))[_0x2ea28d(0x80)]()[_0x2ea28d(0xbf)](a62_0x12a987)[_0x2ea28d(0x71)](_0x2ea28d(0x7d));});a62_0x12a987();'use strict';var __importDefault=this&&this[a62_0x9a64c6(0x96)]||function(_0x92b843){const _0x18eeae=a62_0x9a64c6;return _0x92b843&&_0x92b843[_0x18eeae(0x99)]?_0x92b843:{'default':_0x92b843};};Object[a62_0x9a64c6(0x77)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a62_0x9a64c6(0x83)),salesforce_2=require(a62_0x9a64c6(0x83)),utils_1=require('./utils'),adm_zip_1=__importDefault(require('adm-zip')),B2C_CARTRIDGE_TYPE='CartridgeFile',BINARY_FIELDS=[a62_0x9a64c6(0x87)],EXCLUDED_TYPES=[a62_0x9a64c6(0x9b),a62_0x9a64c6(0xa3),a62_0x9a64c6(0x7c),a62_0x9a64c6(0x92),a62_0x9a64c6(0xbb),a62_0x9a64c6(0xad),a62_0x9a64c6(0x9a),a62_0x9a64c6(0x93),a62_0x9a64c6(0xbd),'ico',a62_0x9a64c6(0xb1),a62_0x9a64c6(0xb8),a62_0x9a64c6(0x7f),'pdf'];function a62_0x150d(){const _0x4c941c=['getEntries','utf8','zip','execute','getIsDone','where','indexOf','variables','includes','rar','15ZAvnel','then','jpeg','length','ttf','71ZcPouE','constructor','forEach','24010mzZrXb','269812WlOLNu','logger','push','823669ysjbVT','search','isFlosumVariables','\x20file(s).','lastIndexOf','Branch__c\x20=\x20:branchId','28367004IhYTmL','defineProperty','BulkV1QueryContentType','Bulk1RetrieveData','keys','Attachment','eot','(((.+)+)+)+$','APPLICATION_XML','gzip','toString','retriveAttachments','QueryBuilder','@flosum/salesforce','Bulk1JobOperation','getComponentHistoryIds','branchId','Body','andWhere','ParentId\x20IN\x20(:componentHistoryIds)','select','log','extractAllToAsync','2002985FKhKoc','Query','22509QykYzP','from','isLastVersion__c\x20=\x20:isLastVersion','otf','woff2','name','Component_Type__c\x20=\x20:type','__importDefault','3384GIpzSj','Component_History__c','__esModule','woff','jpg','applyFlosumVariables','default','getData','build','1606yzYfbY','Retrieved\x20','Component__c\x20IN\x20(','svg','Component__c','jobPath','12RfISYe','axiosInstance','pipe','namespace','11020PsXyYL','apiVersion','BodyLength','png','BulkXmlStreamParser'];a62_0x150d=function(){return _0x4c941c;};return a62_0x150d();}class RetrieveCartridges{constructor(_0x1fc7f9,_0x2bc277,_0x3a21af,_0x2d7508,_0xa891b5,_0x581e3a,_0x1c76f4){const _0x29c668=a62_0x9a64c6;this[_0x29c668(0xa5)]=_0x1fc7f9,this[_0x29c668(0xa7)]=_0x2bc277,this['apiVersion']=_0x3a21af,this['namespace']=_0x2d7508,this[_0x29c668(0x86)]=_0xa891b5,this[_0x29c668(0xb6)]=_0x581e3a,this[_0x29c668(0x6e)]=_0x1c76f4,this[_0x29c668(0x72)]=![],this[_0x29c668(0x72)]=Object[_0x29c668(0x7a)](this[_0x29c668(0xb6)])['length']>0x0;}async[a62_0x9a64c6(0x81)](_0x58e316){const _0x313683=a62_0x9a64c6,_0x4196a0=new salesforce_2[(_0x313683(0x82))]()[_0x313683(0x8a)]('Body','Name',_0x313683(0xac))[_0x313683(0x90)](_0x313683(0x7b))[_0x313683(0xb4)](_0x313683(0x89),{'componentHistoryIds':_0x58e316}),_0x2643d9=new salesforce_1[(_0x313683(0x79))]({'instance':this[_0x313683(0xa7)],'api':this[_0x313683(0xab)],'pollInterval':0x1388,'queryBuilder':_0x4196a0,'objectName':_0x313683(0x7b),'contentType':salesforce_1[_0x313683(0x78)][_0x313683(0x7e)],'jobOperation':salesforce_1[_0x313683(0x84)][_0x313683(0x8e)]});let _0xf69aa=0x0;do{const _0x336a60=await _0x2643d9['execute']();if(!_0x336a60)break;const _0x2a4a97=new salesforce_2[(_0x313683(0xae))]({'binaryFields':BINARY_FIELDS});for await(const _0x247202 of _0x336a60[_0x313683(0xa8)](_0x2a4a97)){_0xf69aa++;const _0x20d4d5=new adm_zip_1[(_0x313683(0x9d))](_0x247202[_0x313683(0x87)]);this[_0x313683(0x72)]&&await this[_0x313683(0x9c)](_0x20d4d5),await(0x0,utils_1[_0x313683(0x8c)])(_0x20d4d5,this[_0x313683(0xa5)]);}}while(!_0x2643d9[_0x313683(0xb3)]());return _0xf69aa;}async[a62_0x9a64c6(0x9c)](_0x11395a){const _0x285ccd=a62_0x9a64c6,_0x13b962=_0x11395a[_0x285ccd(0xaf)]();_0x13b962[_0x285ccd(0xc0)](_0x29f936=>{const _0x3edaf3=_0x285ccd,_0x395abd=_0x29f936[_0x3edaf3(0x94)],_0xcbec85=_0x395abd['substring'](_0x395abd[_0x3edaf3(0x74)]('.')+0x1);if(!EXCLUDED_TYPES[_0x3edaf3(0xb7)](_0xcbec85)){let _0x20541f=_0x29f936[_0x3edaf3(0x9e)]()[_0x3edaf3(0x80)]('utf8'),_0x80fdf2=![];for(const _0x26aba3 in this['variables']){const _0x1e7826='%%'+_0x26aba3+'%%';if(_0x20541f[_0x3edaf3(0xb5)](_0x1e7826)!==-0x1){const _0x45d705=new RegExp(_0x1e7826,'ig');_0x20541f=_0x20541f['replace'](_0x45d705,this['variables'][_0x26aba3]),_0x80fdf2=!![];}}_0x80fdf2&&_0x11395a['updateFile'](_0x29f936,Buffer[_0x3edaf3(0x90)](_0x20541f,_0x3edaf3(0xb0)));}});}async[a62_0x9a64c6(0x85)](){const _0x24e610=a62_0x9a64c6,_0x18b433=[],_0x5b9d2b=new salesforce_2['QueryBuilder']()[_0x24e610(0x8a)]('Id')[_0x24e610(0x90)](this[_0x24e610(0xa9)]+_0x24e610(0xa4))[_0x24e610(0xb4)](this['namespace']+_0x24e610(0x75),{'branchId':this[_0x24e610(0x86)]})[_0x24e610(0x88)](this[_0x24e610(0xa9)]+_0x24e610(0x95),{'type':B2C_CARTRIDGE_TYPE})[_0x24e610(0x9f)](),_0x417340=new salesforce_2[(_0x24e610(0x82))]()[_0x24e610(0x8a)]('Id')[_0x24e610(0x90)](this['namespace']+_0x24e610(0x98))['where'](this['namespace']+_0x24e610(0xa2)+_0x5b9d2b+')')[_0x24e610(0x88)](this[_0x24e610(0xa9)]+_0x24e610(0x91),{'isLastVersion':!![]}),_0x337a8c=new salesforce_2['CompositeRetrieveData']({'api':this[_0x24e610(0xab)],'queryBuilder':_0x417340,'instance':this[_0x24e610(0xa7)],'isTooling':![]});do{const _0x433888=await _0x337a8c[_0x24e610(0xb2)]()[_0x24e610(0xba)](({records:_0xfaeecc})=>_0xfaeecc['map'](_0x3224d5=>_0x3224d5['Id']));_0x433888[_0x24e610(0xbc)]&&_0x18b433[_0x24e610(0x6f)](_0x433888);}while(!_0x337a8c[_0x24e610(0xb3)]());return _0x18b433;}async['execute'](){const _0x4ccf42=a62_0x9a64c6,_0x311f58=await this[_0x4ccf42(0x85)]();let _0x2b18bc=0x0;for(const _0x647f0a of _0x311f58){_0x2b18bc+=await this['retriveAttachments'](_0x647f0a);}await this[_0x4ccf42(0x6e)][_0x4ccf42(0x8b)](_0x4ccf42(0xa1)+_0x2b18bc+_0x4ccf42(0x73));}}exports['default']=RetrieveCartridges;