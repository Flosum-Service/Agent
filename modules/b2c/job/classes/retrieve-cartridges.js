const a62_0x2c2e0a=a62_0x3233;(function(_0x219655,_0x503cc6){const _0x4d2306=a62_0x3233,_0x4d303b=_0x219655();while(!![]){try{const _0x4c2689=-parseInt(_0x4d2306(0x17c))/0x1*(parseInt(_0x4d2306(0x18b))/0x2)+-parseInt(_0x4d2306(0x19c))/0x3+-parseInt(_0x4d2306(0x187))/0x4+-parseInt(_0x4d2306(0x1aa))/0x5+-parseInt(_0x4d2306(0x178))/0x6+parseInt(_0x4d2306(0x19d))/0x7*(parseInt(_0x4d2306(0x18f))/0x8)+parseInt(_0x4d2306(0x193))/0x9;if(_0x4c2689===_0x503cc6)break;else _0x4d303b['push'](_0x4d303b['shift']());}catch(_0x4cab3c){_0x4d303b['push'](_0x4d303b['shift']());}}}(a62_0x5fd2,0xa11f0));const a62_0x53a45e=(function(){let _0x1ee232=!![];return function(_0x12ab69,_0x5db6e1){const _0x4756e1=_0x1ee232?function(){const _0x492c0f=a62_0x3233;if(_0x5db6e1){const _0x5e4496=_0x5db6e1[_0x492c0f(0x18e)](_0x12ab69,arguments);return _0x5db6e1=null,_0x5e4496;}}:function(){};return _0x1ee232=![],_0x4756e1;};}()),a62_0xe2050d=a62_0x53a45e(this,function(){const _0x21e79e=a62_0x3233;return a62_0xe2050d[_0x21e79e(0x1b0)]()['search'](_0x21e79e(0x1ad))['toString']()[_0x21e79e(0x17d)](a62_0xe2050d)['search'](_0x21e79e(0x1ad));});a62_0xe2050d();function a62_0x5fd2(){const _0x3bfa89=['keys','isFlosumVariables','@flosum/salesforce','Component_History__c','ParentId\x20IN\x20(:componentHistoryIds)','Body','4197924rIrAsg','getComponentHistoryIds','svg','andWhere','484516OKWVVH','BulkV1QueryContentType','otf','apply','40rgoYNn','__importDefault','indexOf','Attachment','34378776WSEmlD','Component_Type__c\x20=\x20:type','updateFile','jobPath','where','default','replace','from','applyFlosumVariables','3671337yjBPos','1697297SsUuue','ttf','Bulk1RetrieveData','QueryBuilder','select','BulkXmlStreamParser','Query','lastIndexOf','gzip','axiosInstance','logger','zip','retriveAttachments','620070cwubkZ','apiVersion','substring','(((.+)+)+)+$','push','rar','toString','execute','png','APPLICATION_XML','eot','CartridgeFile','adm-zip','__esModule','utf8','Component__c\x20IN\x20(','namespace','jpg','name','variables','branchId','extractAllToAsync','CompositeRetrieveData','getEntries','Bulk1JobOperation','4582218ELqZVX','map','woff','forEach','5AIZvGN','constructor','Branch__c\x20=\x20:branchId','jpeg','length'];a62_0x5fd2=function(){return _0x3bfa89;};return a62_0x5fd2();}'use strict';function a62_0x3233(_0x147a1a,_0x1fbba2){const _0x5df0ec=a62_0x5fd2();return a62_0x3233=function(_0xe2050d,_0x53a45e){_0xe2050d=_0xe2050d-0x171;let _0x5fd23=_0x5df0ec[_0xe2050d];return _0x5fd23;},a62_0x3233(_0x147a1a,_0x1fbba2);}var __importDefault=this&&this[a62_0x2c2e0a(0x190)]||function(_0x2903cf){const _0x265079=a62_0x2c2e0a;return _0x2903cf&&_0x2903cf[_0x265079(0x1b7)]?_0x2903cf:{'default':_0x2903cf};};Object['defineProperty'](exports,a62_0x2c2e0a(0x1b7),{'value':!![]});const salesforce_1=require(a62_0x2c2e0a(0x183)),salesforce_2=require('@flosum/salesforce'),utils_1=require('./utils'),adm_zip_1=__importDefault(require(a62_0x2c2e0a(0x1b6))),B2C_CARTRIDGE_TYPE=a62_0x2c2e0a(0x1b5),BINARY_FIELDS=[a62_0x2c2e0a(0x186)],EXCLUDED_TYPES=[a62_0x2c2e0a(0x1bb),a62_0x2c2e0a(0x189),a62_0x2c2e0a(0x1b4),a62_0x2c2e0a(0x18d),a62_0x2c2e0a(0x17f),a62_0x2c2e0a(0x1b2),a62_0x2c2e0a(0x17a),'woff2',a62_0x2c2e0a(0x19e),'ico',a62_0x2c2e0a(0x1a8),a62_0x2c2e0a(0x1af),a62_0x2c2e0a(0x1a5),'pdf'];class RetrieveCartridges{constructor(_0x5e4314,_0x33a865,_0x467612,_0x3ba874,_0xb1d593,_0x445095,_0x5569fb){const _0x5c2fa4=a62_0x2c2e0a;this[_0x5c2fa4(0x196)]=_0x5e4314,this[_0x5c2fa4(0x1a6)]=_0x33a865,this[_0x5c2fa4(0x1ab)]=_0x467612,this[_0x5c2fa4(0x1ba)]=_0x3ba874,this[_0x5c2fa4(0x173)]=_0xb1d593,this[_0x5c2fa4(0x172)]=_0x445095,this[_0x5c2fa4(0x1a7)]=_0x5569fb,this[_0x5c2fa4(0x182)]=![],this[_0x5c2fa4(0x182)]=Object[_0x5c2fa4(0x181)](this[_0x5c2fa4(0x172)])[_0x5c2fa4(0x180)]>0x0;}async[a62_0x2c2e0a(0x1a9)](_0x49d514){const _0x4d3768=a62_0x2c2e0a,_0xa0a0ea=new salesforce_2[(_0x4d3768(0x1a0))]()[_0x4d3768(0x1a1)](_0x4d3768(0x186),'Name','BodyLength')['from'](_0x4d3768(0x192))[_0x4d3768(0x197)](_0x4d3768(0x185),{'componentHistoryIds':_0x49d514}),_0x45b587=new salesforce_1[(_0x4d3768(0x19f))]({'instance':this[_0x4d3768(0x1a6)],'api':this[_0x4d3768(0x1ab)],'pollInterval':0x1388,'queryBuilder':_0xa0a0ea,'objectName':_0x4d3768(0x192),'contentType':salesforce_1[_0x4d3768(0x18c)][_0x4d3768(0x1b3)],'jobOperation':salesforce_1[_0x4d3768(0x177)][_0x4d3768(0x1a3)]});let _0x1f0de3=0x0;do{const _0x2adc56=await _0x45b587[_0x4d3768(0x1b1)]();if(!_0x2adc56)break;const _0x5d461e=new salesforce_2[(_0x4d3768(0x1a2))]({'binaryFields':BINARY_FIELDS});for await(const _0x18b6db of _0x2adc56['pipe'](_0x5d461e)){_0x1f0de3++;const _0x15076f=new adm_zip_1[(_0x4d3768(0x198))](_0x18b6db[_0x4d3768(0x186)]);this[_0x4d3768(0x182)]&&await this['applyFlosumVariables'](_0x15076f),await(0x0,utils_1[_0x4d3768(0x174)])(_0x15076f,this[_0x4d3768(0x196)]);}}while(!_0x45b587['getIsDone']());return _0x1f0de3;}async[a62_0x2c2e0a(0x19b)](_0x44d837){const _0xf32861=a62_0x2c2e0a,_0x1628cc=_0x44d837[_0xf32861(0x176)]();_0x1628cc[_0xf32861(0x17b)](_0x389542=>{const _0x46c5b7=_0xf32861,_0x599819=_0x389542[_0x46c5b7(0x171)],_0x54a689=_0x599819[_0x46c5b7(0x1ac)](_0x599819[_0x46c5b7(0x1a4)]('.')+0x1);if(!EXCLUDED_TYPES['includes'](_0x54a689)){let _0xd18580=_0x389542['getData']()['toString'](_0x46c5b7(0x1b8)),_0x5e1aa6=![];for(const _0x9d2d2b in this[_0x46c5b7(0x172)]){const _0x5550ed='%%'+_0x9d2d2b+'%%';if(_0xd18580[_0x46c5b7(0x191)](_0x5550ed)!==-0x1){const _0x24e16d=new RegExp(_0x5550ed,'ig');_0xd18580=_0xd18580[_0x46c5b7(0x199)](_0x24e16d,this[_0x46c5b7(0x172)][_0x9d2d2b]),_0x5e1aa6=!![];}}_0x5e1aa6&&_0x44d837[_0x46c5b7(0x195)](_0x389542,Buffer[_0x46c5b7(0x19a)](_0xd18580,_0x46c5b7(0x1b8)));}});}async[a62_0x2c2e0a(0x188)](){const _0x18a826=a62_0x2c2e0a,_0x479f78=[],_0x4d1c92=new salesforce_2['QueryBuilder']()[_0x18a826(0x1a1)]('Id')[_0x18a826(0x19a)](this[_0x18a826(0x1ba)]+'Component__c')[_0x18a826(0x197)](this['namespace']+_0x18a826(0x17e),{'branchId':this[_0x18a826(0x173)]})['andWhere'](this[_0x18a826(0x1ba)]+_0x18a826(0x194),{'type':B2C_CARTRIDGE_TYPE})['build'](),_0x1cae55=new salesforce_2[(_0x18a826(0x1a0))]()[_0x18a826(0x1a1)]('Id')[_0x18a826(0x19a)](this[_0x18a826(0x1ba)]+_0x18a826(0x184))['where'](this[_0x18a826(0x1ba)]+_0x18a826(0x1b9)+_0x4d1c92+')')[_0x18a826(0x18a)](this[_0x18a826(0x1ba)]+'isLastVersion__c\x20=\x20:isLastVersion',{'isLastVersion':!![]}),_0x409beb=new salesforce_2[(_0x18a826(0x175))]({'api':this['apiVersion'],'queryBuilder':_0x1cae55,'instance':this[_0x18a826(0x1a6)],'isTooling':![]});do{const _0x51830c=await _0x409beb[_0x18a826(0x1b1)]()['then'](({records:_0xaae867})=>_0xaae867[_0x18a826(0x179)](_0xfd18ae=>_0xfd18ae['Id']));_0x51830c['length']&&_0x479f78[_0x18a826(0x1ae)](_0x51830c);}while(!_0x409beb['getIsDone']());return _0x479f78;}async[a62_0x2c2e0a(0x1b1)](){const _0x4317d0=a62_0x2c2e0a,_0x3b9538=await this[_0x4317d0(0x188)]();let _0x31c66a=0x0;for(const _0x519435 of _0x3b9538){_0x31c66a+=await this[_0x4317d0(0x1a9)](_0x519435);}await this[_0x4317d0(0x1a7)]['log']('Retrieved\x20'+_0x31c66a+'\x20file(s).');}}exports[a62_0x2c2e0a(0x198)]=RetrieveCartridges;