const a62_0x17e884=a62_0x5c1a;(function(_0x50d31a,_0x44b16f){const _0x1ba7b0=a62_0x5c1a,_0x5b23bf=_0x50d31a();while(!![]){try{const _0x29a556=-parseInt(_0x1ba7b0(0xcb))/0x1*(parseInt(_0x1ba7b0(0xa7))/0x2)+-parseInt(_0x1ba7b0(0xc1))/0x3+parseInt(_0x1ba7b0(0xad))/0x4*(-parseInt(_0x1ba7b0(0xd1))/0x5)+-parseInt(_0x1ba7b0(0xa6))/0x6+-parseInt(_0x1ba7b0(0xe5))/0x7*(parseInt(_0x1ba7b0(0xbb))/0x8)+parseInt(_0x1ba7b0(0xc4))/0x9+-parseInt(_0x1ba7b0(0xc7))/0xa*(-parseInt(_0x1ba7b0(0xc9))/0xb);if(_0x29a556===_0x44b16f)break;else _0x5b23bf['push'](_0x5b23bf['shift']());}catch(_0x408c62){_0x5b23bf['push'](_0x5b23bf['shift']());}}}(a62_0x4c1a,0xd0b1a));const a62_0x359d3a=(function(){let _0x16adb2=!![];return function(_0x372c24,_0x46fc63){const _0x58a3ef=_0x16adb2?function(){const _0x3321d5=a62_0x5c1a;if(_0x46fc63){const _0x1b90dd=_0x46fc63[_0x3321d5(0xcf)](_0x372c24,arguments);return _0x46fc63=null,_0x1b90dd;}}:function(){};return _0x16adb2=![],_0x58a3ef;};}()),a62_0x8f30b3=a62_0x359d3a(this,function(){const _0x27fc48=a62_0x5c1a;return a62_0x8f30b3[_0x27fc48(0xab)]()[_0x27fc48(0xb9)](_0x27fc48(0xa2))[_0x27fc48(0xab)]()['constructor'](a62_0x8f30b3)[_0x27fc48(0xb9)](_0x27fc48(0xa2));});a62_0x8f30b3();'use strict';var __importDefault=this&&this[a62_0x17e884(0xd9)]||function(_0xc393ba){const _0x1862a2=a62_0x17e884;return _0xc393ba&&_0xc393ba[_0x1862a2(0xd6)]?_0xc393ba:{'default':_0xc393ba};};Object[a62_0x17e884(0xbf)](exports,a62_0x17e884(0xd6),{'value':!![]});function a62_0x4c1a(){const _0x55e623=['toString','Name','6492532nuxGUy','Component_History__c','@flosum/salesforce','Component_Type__c\x20=\x20:type','gzip','execute','applyFlosumVariables','select','log','svg','length','includes','search','isLastVersion__c\x20=\x20:isLastVersion','58144dXldSJ','default','extractAllToAsync','CartridgeFile','defineProperty','woff','2131542TYzfiR','woff2','substring','15039351hlmpsR','QueryBuilder','isFlosumVariables','40IaQUhD','Retrieved\x20','7036304LDGxQv','where','159433adIwNS','jobPath','axiosInstance','\x20file(s).','apply','then','5CJemem','andWhere','zip','CompositeRetrieveData','branchId','__esModule','logger','build','__importDefault','ico','BulkV1QueryContentType','getEntries','from','Component__c\x20IN\x20(','getComponentHistoryIds','namespace','utf8','eot','ParentId\x20IN\x20(:componentHistoryIds)','Bulk1JobOperation','707MfJgWP','variables','retriveAttachments','Attachment','Component__c','otf','name','Body','ttf','getIsDone','(((.+)+)+)+$','jpg','updateFile','Query','886422BrOTxD','2cuGQZF','apiVersion','lastIndexOf','Branch__c\x20=\x20:branchId'];a62_0x4c1a=function(){return _0x55e623;};return a62_0x4c1a();}function a62_0x5c1a(_0x488412,_0x344986){const _0x12062b=a62_0x4c1a();return a62_0x5c1a=function(_0x8f30b3,_0x359d3a){_0x8f30b3=_0x8f30b3-0x9d;let _0x4c1a64=_0x12062b[_0x8f30b3];return _0x4c1a64;},a62_0x5c1a(_0x488412,_0x344986);}const salesforce_1=require(a62_0x17e884(0xaf)),salesforce_2=require(a62_0x17e884(0xaf)),utils_1=require('./utils'),adm_zip_1=__importDefault(require('adm-zip')),B2C_CARTRIDGE_TYPE=a62_0x17e884(0xbe),BINARY_FIELDS=[a62_0x17e884(0x9f)],EXCLUDED_TYPES=[a62_0x17e884(0xa3),a62_0x17e884(0xb6),a62_0x17e884(0xe2),a62_0x17e884(0x9d),'jpeg','png',a62_0x17e884(0xc0),a62_0x17e884(0xc2),a62_0x17e884(0xa0),a62_0x17e884(0xda),a62_0x17e884(0xd3),'rar',a62_0x17e884(0xb1),'pdf'];class RetrieveCartridges{constructor(_0x167e1d,_0x261db9,_0x8fc95,_0x5b1ddb,_0x6afef4,_0x3af0e3,_0x2fc192){const _0x30d50a=a62_0x17e884;this[_0x30d50a(0xcc)]=_0x167e1d,this[_0x30d50a(0xcd)]=_0x261db9,this[_0x30d50a(0xa8)]=_0x8fc95,this['namespace']=_0x5b1ddb,this[_0x30d50a(0xd5)]=_0x6afef4,this['variables']=_0x3af0e3,this[_0x30d50a(0xd7)]=_0x2fc192,this['isFlosumVariables']=![],this[_0x30d50a(0xc6)]=Object['keys'](this['variables'])[_0x30d50a(0xb7)]>0x0;}async[a62_0x17e884(0xe7)](_0x3e6bf7){const _0x1148f8=a62_0x17e884,_0x119876=new salesforce_2[(_0x1148f8(0xc5))]()[_0x1148f8(0xb4)](_0x1148f8(0x9f),_0x1148f8(0xac),'BodyLength')['from'](_0x1148f8(0xe8))[_0x1148f8(0xca)](_0x1148f8(0xe3),{'componentHistoryIds':_0x3e6bf7}),_0x552235=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x1148f8(0xcd)],'api':this[_0x1148f8(0xa8)],'pollInterval':0x1388,'queryBuilder':_0x119876,'objectName':_0x1148f8(0xe8),'contentType':salesforce_1[_0x1148f8(0xdb)]['APPLICATION_XML'],'jobOperation':salesforce_1[_0x1148f8(0xe4)][_0x1148f8(0xa5)]});let _0x343277=0x0;do{const _0x24157e=await _0x552235['execute']();if(!_0x24157e)break;const _0x2f6b8c=new salesforce_2['BulkXmlStreamParser']({'binaryFields':BINARY_FIELDS});for await(const _0x35de9d of _0x24157e['pipe'](_0x2f6b8c)){_0x343277++;const _0x222acf=new adm_zip_1[(_0x1148f8(0xbc))](_0x35de9d[_0x1148f8(0x9f)]);this[_0x1148f8(0xc6)]&&await this[_0x1148f8(0xb3)](_0x222acf),await(0x0,utils_1[_0x1148f8(0xbd)])(_0x222acf,this['jobPath']);}}while(!_0x552235[_0x1148f8(0xa1)]());return _0x343277;}async[a62_0x17e884(0xb3)](_0x151d52){const _0x35a546=a62_0x17e884,_0x506b4b=_0x151d52[_0x35a546(0xdc)]();_0x506b4b['forEach'](_0x53e585=>{const _0x944fda=_0x35a546,_0x5206e8=_0x53e585[_0x944fda(0x9e)],_0x69fe4a=_0x5206e8[_0x944fda(0xc3)](_0x5206e8[_0x944fda(0xa9)]('.')+0x1);if(!EXCLUDED_TYPES[_0x944fda(0xb8)](_0x69fe4a)){let _0x530dda=_0x53e585['getData']()[_0x944fda(0xab)](_0x944fda(0xe1)),_0x3b9047=![];for(const _0x14ad6d in this[_0x944fda(0xe6)]){const _0x5cea1e='%%'+_0x14ad6d+'%%';if(_0x530dda['indexOf'](_0x5cea1e)!==-0x1){const _0x47e7ec=new RegExp(_0x5cea1e,'ig');_0x530dda=_0x530dda['replace'](_0x47e7ec,this[_0x944fda(0xe6)][_0x14ad6d]),_0x3b9047=!![];}}_0x3b9047&&_0x151d52[_0x944fda(0xa4)](_0x53e585,Buffer[_0x944fda(0xdd)](_0x530dda,_0x944fda(0xe1)));}});}async[a62_0x17e884(0xdf)](){const _0x10f726=a62_0x17e884,_0xf4b654=[],_0x1b2531=new salesforce_2[(_0x10f726(0xc5))]()[_0x10f726(0xb4)]('Id')[_0x10f726(0xdd)](this[_0x10f726(0xe0)]+_0x10f726(0xe9))[_0x10f726(0xca)](this[_0x10f726(0xe0)]+_0x10f726(0xaa),{'branchId':this['branchId']})[_0x10f726(0xd2)](this[_0x10f726(0xe0)]+_0x10f726(0xb0),{'type':B2C_CARTRIDGE_TYPE})[_0x10f726(0xd8)](),_0x2c9410=new salesforce_2[(_0x10f726(0xc5))]()[_0x10f726(0xb4)]('Id')['from'](this[_0x10f726(0xe0)]+_0x10f726(0xae))[_0x10f726(0xca)](this[_0x10f726(0xe0)]+_0x10f726(0xde)+_0x1b2531+')')[_0x10f726(0xd2)](this['namespace']+_0x10f726(0xba),{'isLastVersion':!![]}),_0x2c8362=new salesforce_2[(_0x10f726(0xd4))]({'api':this[_0x10f726(0xa8)],'queryBuilder':_0x2c9410,'instance':this['axiosInstance'],'isTooling':![]});do{const _0x2f618d=await _0x2c8362[_0x10f726(0xb2)]()[_0x10f726(0xd0)](({records:_0x1e2654})=>_0x1e2654['map'](_0x1cf64b=>_0x1cf64b['Id']));_0x2f618d[_0x10f726(0xb7)]&&_0xf4b654['push'](_0x2f618d);}while(!_0x2c8362[_0x10f726(0xa1)]());return _0xf4b654;}async[a62_0x17e884(0xb2)](){const _0x2c3ac6=a62_0x17e884,_0x810e4e=await this[_0x2c3ac6(0xdf)]();let _0x4abbf7=0x0;for(const _0x20830 of _0x810e4e){_0x4abbf7+=await this[_0x2c3ac6(0xe7)](_0x20830);}await this[_0x2c3ac6(0xd7)][_0x2c3ac6(0xb5)](_0x2c3ac6(0xc8)+_0x4abbf7+_0x2c3ac6(0xce));}}exports[a62_0x17e884(0xbc)]=RetrieveCartridges;