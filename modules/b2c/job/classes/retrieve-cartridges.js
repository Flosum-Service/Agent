const a60_0x287538=a60_0x4a83;(function(_0x34847c,_0x273e72){const _0x4c0ca2=a60_0x4a83,_0x15a3bc=_0x34847c();while(!![]){try{const _0x4c58d0=parseInt(_0x4c0ca2(0x1b3))/0x1*(-parseInt(_0x4c0ca2(0x1b8))/0x2)+parseInt(_0x4c0ca2(0x1a5))/0x3*(-parseInt(_0x4c0ca2(0x1ad))/0x4)+parseInt(_0x4c0ca2(0x18d))/0x5*(parseInt(_0x4c0ca2(0x183))/0x6)+-parseInt(_0x4c0ca2(0x1a4))/0x7*(-parseInt(_0x4c0ca2(0x1a7))/0x8)+parseInt(_0x4c0ca2(0x1b2))/0x9*(-parseInt(_0x4c0ca2(0x17d))/0xa)+-parseInt(_0x4c0ca2(0x193))/0xb*(-parseInt(_0x4c0ca2(0x199))/0xc)+-parseInt(_0x4c0ca2(0x1c8))/0xd;if(_0x4c58d0===_0x273e72)break;else _0x15a3bc['push'](_0x15a3bc['shift']());}catch(_0x4f3651){_0x15a3bc['push'](_0x15a3bc['shift']());}}}(a60_0x2f33,0x48a87));const a60_0x2984ef=(function(){let _0x27428c=!![];return function(_0x67dfc9,_0x563ad1){const _0x29cdcf=_0x27428c?function(){const _0x5daa0b=a60_0x4a83;if(_0x563ad1){const _0xe7f51=_0x563ad1[_0x5daa0b(0x1b5)](_0x67dfc9,arguments);return _0x563ad1=null,_0xe7f51;}}:function(){};return _0x27428c=![],_0x29cdcf;};}()),a60_0x5e758a=a60_0x2984ef(this,function(){const _0x21ed54=a60_0x4a83;return a60_0x5e758a[_0x21ed54(0x180)]()[_0x21ed54(0x1a0)]('(((.+)+)+)+$')[_0x21ed54(0x180)]()['constructor'](a60_0x5e758a)[_0x21ed54(0x1a0)](_0x21ed54(0x1a1));});a60_0x5e758a();'use strict';function a60_0x4a83(_0x5ae581,_0x527ca4){const _0x1b5e25=a60_0x2f33();return a60_0x4a83=function(_0x5e758a,_0x2984ef){_0x5e758a=_0x5e758a-0x17b;let _0x2f337a=_0x1b5e25[_0x5e758a];return _0x2f337a;},a60_0x4a83(_0x5ae581,_0x527ca4);}var __importDefault=this&&this['__importDefault']||function(_0x5bf9b7){const _0x4e58a7=a60_0x4a83;return _0x5bf9b7&&_0x5bf9b7[_0x4e58a7(0x187)]?_0x5bf9b7:{'default':_0x5bf9b7};};Object[a60_0x287538(0x1b9)](exports,a60_0x287538(0x187),{'value':!![]});function a60_0x2f33(){const _0x25b5a9=['build','7diHXUu','282621RrwYss','jpeg','2307976WzrMeB','jpg','svg','Retrieved\x20','gzip','adm-zip','8xMTshI','Body','length','then','map','11835MzMzlm','27884yyKAJX','woff','apply','replace','ico','4clEcEO','defineProperty','isFlosumVariables','Branch__c\x20=\x20:branchId','getComponentHistoryIds','where','applyFlosumVariables','namespace','Component_Type__c\x20=\x20:type','utf8','retriveAttachments','axiosInstance','rar','Bulk1JobOperation','includes','ttf','1423058iNqRYE','CartridgeFile','pipe','forEach','from','updateFile','\x20file(s).','QueryBuilder','png','1440pFbWCu','otf','lastIndexOf','toString','Component__c\x20IN\x20(','apiVersion','12318niGyDa','Attachment','andWhere','select','__esModule','extractAllToAsync','ParentId\x20IN\x20(:componentHistoryIds)','variables','indexOf','name','1020aVBmNb','Query','pdf','execute','logger','branchId','11XDVnqo','getIsDone','jobPath','CompositeRetrieveData','zip','getData','1599672OwEolQ','default','getEntries','@flosum/salesforce','substring','eot','APPLICATION_XML','search','(((.+)+)+)+$','./utils'];a60_0x2f33=function(){return _0x25b5a9;};return a60_0x2f33();}const salesforce_1=require(a60_0x287538(0x19c)),salesforce_2=require('@flosum/salesforce'),utils_1=require(a60_0x287538(0x1a2)),adm_zip_1=__importDefault(require(a60_0x287538(0x1ac))),B2C_CARTRIDGE_TYPE=a60_0x287538(0x1c9),BINARY_FIELDS=[a60_0x287538(0x1ae)],EXCLUDED_TYPES=[a60_0x287538(0x1a8),a60_0x287538(0x1a9),a60_0x287538(0x19e),a60_0x287538(0x17e),a60_0x287538(0x1a6),a60_0x287538(0x17c),a60_0x287538(0x1b4),'woff2',a60_0x287538(0x1c7),a60_0x287538(0x1b7),a60_0x287538(0x197),a60_0x287538(0x1c4),a60_0x287538(0x1ab),a60_0x287538(0x18f)];class RetrieveCartridges{constructor(_0x693fbb,_0x896e3d,_0x1ad089,_0x1f684c,_0x46a98c,_0x5c7f9b,_0x4f2fb8){const _0x4c42a5=a60_0x287538;this[_0x4c42a5(0x195)]=_0x693fbb,this['axiosInstance']=_0x896e3d,this[_0x4c42a5(0x182)]=_0x1ad089,this['namespace']=_0x1f684c,this[_0x4c42a5(0x192)]=_0x46a98c,this[_0x4c42a5(0x18a)]=_0x5c7f9b,this[_0x4c42a5(0x191)]=_0x4f2fb8,this[_0x4c42a5(0x1ba)]=![],this[_0x4c42a5(0x1ba)]=Object['keys'](this[_0x4c42a5(0x18a)])[_0x4c42a5(0x1af)]>0x0;}async[a60_0x287538(0x1c2)](_0x4a18d1){const _0x25cfd0=a60_0x287538,_0x365781=new salesforce_2[(_0x25cfd0(0x17b))]()[_0x25cfd0(0x186)](_0x25cfd0(0x1ae),'Name','BodyLength')['from'](_0x25cfd0(0x184))['where'](_0x25cfd0(0x189),{'componentHistoryIds':_0x4a18d1}),_0x49d326=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x25cfd0(0x1c3)],'api':this[_0x25cfd0(0x182)],'pollInterval':0x1388,'queryBuilder':_0x365781,'objectName':_0x25cfd0(0x184),'contentType':salesforce_1['BulkV1QueryContentType'][_0x25cfd0(0x19f)],'jobOperation':salesforce_1[_0x25cfd0(0x1c5)][_0x25cfd0(0x18e)]});let _0x3e8a2d=0x0;do{const _0x2cb15f=await _0x49d326['execute']();if(!_0x2cb15f)break;const _0x59d8c2=new salesforce_2['BulkXmlStreamParser']({'binaryFields':BINARY_FIELDS});for await(const _0x42da24 of _0x2cb15f[_0x25cfd0(0x1ca)](_0x59d8c2)){_0x3e8a2d++;const _0x5378f2=new adm_zip_1[(_0x25cfd0(0x19a))](_0x42da24[_0x25cfd0(0x1ae)]);this['isFlosumVariables']&&await this['applyFlosumVariables'](_0x5378f2),await(0x0,utils_1[_0x25cfd0(0x188)])(_0x5378f2,this[_0x25cfd0(0x195)]);}}while(!_0x49d326[_0x25cfd0(0x194)]());return _0x3e8a2d;}async[a60_0x287538(0x1be)](_0x555bf0){const _0x4f549c=a60_0x287538,_0x3b6bcc=_0x555bf0[_0x4f549c(0x19b)]();_0x3b6bcc[_0x4f549c(0x1cb)](_0x1c44f4=>{const _0x569d4e=_0x4f549c,_0x2a4197=_0x1c44f4[_0x569d4e(0x18c)],_0x35b611=_0x2a4197[_0x569d4e(0x19d)](_0x2a4197[_0x569d4e(0x17f)]('.')+0x1);if(!EXCLUDED_TYPES[_0x569d4e(0x1c6)](_0x35b611)){let _0x4beb68=_0x1c44f4[_0x569d4e(0x198)]()['toString'](_0x569d4e(0x1c1)),_0x259aae=![];for(const _0x424013 in this[_0x569d4e(0x18a)]){const _0x282a96='%%'+_0x424013+'%%';if(_0x4beb68[_0x569d4e(0x18b)](_0x282a96)!==-0x1){const _0x54c517=new RegExp(_0x282a96,'ig');_0x4beb68=_0x4beb68[_0x569d4e(0x1b6)](_0x54c517,this[_0x569d4e(0x18a)][_0x424013]),_0x259aae=!![];}}_0x259aae&&_0x555bf0[_0x569d4e(0x1cd)](_0x1c44f4,Buffer[_0x569d4e(0x1cc)](_0x4beb68,_0x569d4e(0x1c1)));}});}async['getComponentHistoryIds'](){const _0x434e7e=a60_0x287538,_0x2b5ceb=[],_0x2060b6=new salesforce_2[(_0x434e7e(0x17b))]()[_0x434e7e(0x186)]('Id')['from'](this[_0x434e7e(0x1bf)]+'Component__c')[_0x434e7e(0x1bd)](this[_0x434e7e(0x1bf)]+_0x434e7e(0x1bb),{'branchId':this['branchId']})[_0x434e7e(0x185)](this[_0x434e7e(0x1bf)]+_0x434e7e(0x1c0),{'type':B2C_CARTRIDGE_TYPE})[_0x434e7e(0x1a3)](),_0x31fc38=new salesforce_2[(_0x434e7e(0x17b))]()['select']('Id')[_0x434e7e(0x1cc)](this[_0x434e7e(0x1bf)]+'Component_History__c')[_0x434e7e(0x1bd)](this['namespace']+_0x434e7e(0x181)+_0x2060b6+')')[_0x434e7e(0x185)](this[_0x434e7e(0x1bf)]+'isLastVersion__c\x20=\x20:isLastVersion',{'isLastVersion':!![]}),_0x4c061=new salesforce_2[(_0x434e7e(0x196))]({'api':this[_0x434e7e(0x182)],'queryBuilder':_0x31fc38,'instance':this[_0x434e7e(0x1c3)],'isTooling':![]});do{const _0x160a77=await _0x4c061['execute']()[_0x434e7e(0x1b0)](({records:_0x4f3358})=>_0x4f3358[_0x434e7e(0x1b1)](_0x28e2f0=>_0x28e2f0['Id']));_0x160a77[_0x434e7e(0x1af)]&&_0x2b5ceb['push'](_0x160a77);}while(!_0x4c061['getIsDone']());return _0x2b5ceb;}async[a60_0x287538(0x190)](){const _0x4bc305=a60_0x287538,_0x299f13=await this[_0x4bc305(0x1bc)]();let _0x314892=0x0;for(const _0x2d9d39 of _0x299f13){_0x314892+=await this[_0x4bc305(0x1c2)](_0x2d9d39);}await this[_0x4bc305(0x191)]['log'](_0x4bc305(0x1aa)+_0x314892+_0x4bc305(0x1ce));}}exports['default']=RetrieveCartridges;