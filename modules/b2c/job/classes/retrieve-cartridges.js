function a62_0x55cb(_0x4f727b,_0x1f6630){const _0x182d7a=a62_0x2c85();return a62_0x55cb=function(_0x1e6390,_0x282bff){_0x1e6390=_0x1e6390-0x1ad;let _0x2c85f9=_0x182d7a[_0x1e6390];return _0x2c85f9;},a62_0x55cb(_0x4f727b,_0x1f6630);}const a62_0x15a1d4=a62_0x55cb;(function(_0x4882a5,_0x2a11e5){const _0xe0175f=a62_0x55cb,_0x3d3d3f=_0x4882a5();while(!![]){try{const _0x2560a1=parseInt(_0xe0175f(0x1f6))/0x1*(-parseInt(_0xe0175f(0x1f4))/0x2)+-parseInt(_0xe0175f(0x1cf))/0x3*(-parseInt(_0xe0175f(0x1f9))/0x4)+parseInt(_0xe0175f(0x1b3))/0x5*(-parseInt(_0xe0175f(0x1ce))/0x6)+-parseInt(_0xe0175f(0x1c1))/0x7*(parseInt(_0xe0175f(0x1ef))/0x8)+-parseInt(_0xe0175f(0x1c6))/0x9*(-parseInt(_0xe0175f(0x1c5))/0xa)+-parseInt(_0xe0175f(0x20e))/0xb*(parseInt(_0xe0175f(0x1cb))/0xc)+-parseInt(_0xe0175f(0x210))/0xd*(-parseInt(_0xe0175f(0x1af))/0xe);if(_0x2560a1===_0x2a11e5)break;else _0x3d3d3f['push'](_0x3d3d3f['shift']());}catch(_0x4fa07b){_0x3d3d3f['push'](_0x3d3d3f['shift']());}}}(a62_0x2c85,0x4602a));const a62_0x282bff=(function(){let _0x501db9=!![];return function(_0x41ba51,_0x8c89dc){const _0x9f6ab=_0x501db9?function(){const _0x1c0016=a62_0x55cb;if(_0x8c89dc){const _0x467cfd=_0x8c89dc[_0x1c0016(0x1ad)](_0x41ba51,arguments);return _0x8c89dc=null,_0x467cfd;}}:function(){};return _0x501db9=![],_0x9f6ab;};}()),a62_0x1e6390=a62_0x282bff(this,function(){const _0x3e5c7b=a62_0x55cb;return a62_0x1e6390[_0x3e5c7b(0x203)]()[_0x3e5c7b(0x1b9)](_0x3e5c7b(0x1d7))['toString']()[_0x3e5c7b(0x1df)](a62_0x1e6390)[_0x3e5c7b(0x1b9)](_0x3e5c7b(0x1d7));});function a62_0x2c85(){const _0x32491a=['apiVersion','defineProperty','Body','Attachment','CartridgeFile','./utils','push','14000czRGXT','indexOf','\x22\x20not\x20found.','then','join','2NMlDOi','andWhere','116372jzsnQY','mkdir','Component_History__c','175496ViZHRC','\x20file(s).','pipe','isLastVersion__c\x20=\x20:isLastVersion','adm-zip','variables','jobPath','pdf','FLOSUM_LIST_COMPONENTS_ATTACHMENT_NAME','BodyLength','toString','metadataLogId','map','includes','../../constants','QueryBuilder','isFlosumVariables','getSelectedComponentIds','zip','select','Component__c\x20IN\x20(','253zHblpP','getIsDone','7842718SJthBN','apply','Retrieved\x20','28WDhkIT','logger','from','Bulk1JobOperation','10KBYnfw','exists','utf8','Component_Type__c\x20=\x20:type','path','Id\x20IN\x20(:componentIds)','search','gzip','where','Component__c','png','fs/promises','File\x20\x22','namespace','1953vGtayh','length','tmpPath','execute','9190KTqRge','4869IyJtpR','Get\x20list\x20of\x20components.','getData','Branch__c\x20=\x20:branchId','applyFlosumVariables','239532vbKLWb','DEFAULT_CARTRIDGES_FOLDER','default','1454658LnJkdN','9HHzots','getEntries','axiosInstance','Name\x20IN\x20(:names)','otf','svg','../../../git/internal/fs.internal','__esModule','(((.+)+)+)+$','__importDefault','eot','@flosum/utils','branchId','ttf','replace','forEach','constructor','BulkV1QueryContentType','@flosum/salesforce','jpg','rar','log','retrieveAttachments','splitOnChunks','writeFile'];a62_0x2c85=function(){return _0x32491a;};return a62_0x2c85();}a62_0x1e6390();'use strict';var __importDefault=this&&this[a62_0x15a1d4(0x1d8)]||function(_0x5b1984){const _0x26fbea=a62_0x15a1d4;return _0x5b1984&&_0x5b1984[_0x26fbea(0x1d6)]?_0x5b1984:{'default':_0x5b1984};};Object[a62_0x15a1d4(0x1e9)](exports,a62_0x15a1d4(0x1d6),{'value':!![]});const salesforce_1=require(a62_0x15a1d4(0x1e1)),salesforce_2=require(a62_0x15a1d4(0x1e1)),utils_1=require(a62_0x15a1d4(0x1ed)),fs_internal_1=require(a62_0x15a1d4(0x1d5)),path_1=require('../../../../configs/path'),promises_1=require(a62_0x15a1d4(0x1be)),constants_1=require(a62_0x15a1d4(0x207)),adm_zip_1=__importDefault(require(a62_0x15a1d4(0x1fd))),path_2=__importDefault(require(a62_0x15a1d4(0x1b7))),utils_2=require(a62_0x15a1d4(0x1da)),chunkSize=0x1f4,B2C_CARTRIDGE_TYPE=a62_0x15a1d4(0x1ec),BINARY_FIELDS=[a62_0x15a1d4(0x1ea)],EXCLUDED_TYPES=[a62_0x15a1d4(0x1e2),a62_0x15a1d4(0x1d4),a62_0x15a1d4(0x1d9),a62_0x15a1d4(0x1d3),'jpeg',a62_0x15a1d4(0x1bd),'woff','woff2',a62_0x15a1d4(0x1dc),'ico',a62_0x15a1d4(0x20b),a62_0x15a1d4(0x1e3),a62_0x15a1d4(0x1ba),a62_0x15a1d4(0x200)];class RetrieveCartridges{constructor(_0x57832c,_0x429acc,_0x414da3,_0x4d5895,_0x1a2b8b,_0x18ca7c,_0x34927a,_0x7cc332,_0x28372e){const _0x3b5a7e=a62_0x15a1d4;this[_0x3b5a7e(0x1ff)]=_0x57832c,this[_0x3b5a7e(0x1d1)]=_0x429acc,this[_0x3b5a7e(0x1e8)]=_0x414da3,this[_0x3b5a7e(0x1c0)]=_0x4d5895,this[_0x3b5a7e(0x1db)]=_0x1a2b8b,this[_0x3b5a7e(0x204)]=_0x18ca7c,this[_0x3b5a7e(0x1b0)]=_0x34927a,this['systemLogger']=_0x7cc332,this[_0x3b5a7e(0x1fe)]=_0x28372e,this['isFlosumVariables']=![],_0x28372e&&(this[_0x3b5a7e(0x209)]=Object['keys'](_0x28372e)[_0x3b5a7e(0x1c2)]>0x0);}async[a62_0x15a1d4(0x1e5)](_0x37dcf7,_0xdd51a8){const _0x34e6e5=a62_0x15a1d4,_0x51b8f2=new salesforce_2[(_0x34e6e5(0x208))]()[_0x34e6e5(0x20c)](_0x34e6e5(0x1ea),'Name',_0x34e6e5(0x202))[_0x34e6e5(0x1b1)](_0x34e6e5(0x1eb))[_0x34e6e5(0x1bb)]('ParentId\x20IN\x20(:parentIdIds)',{'parentIdIds':_0x37dcf7});_0xdd51a8&&_0x51b8f2[_0x34e6e5(0x1f5)](_0x34e6e5(0x1d2),{'names':_0xdd51a8});!await fs_internal_1['FS'][_0x34e6e5(0x1b4)](path_1[_0x34e6e5(0x1c3)])&&await(0x0,promises_1[_0x34e6e5(0x1f7)])(path_1['tmpPath'],{'recursive':!![]});const _0x4d8491=new salesforce_1['Bulk1RetrieveData']({'instance':this['axiosInstance'],'api':this[_0x34e6e5(0x1e8)],'pollInterval':0x1388,'queryBuilder':_0x51b8f2,'objectName':_0x34e6e5(0x1eb),'contentType':salesforce_1[_0x34e6e5(0x1e0)]['APPLICATION_XML'],'jobOperation':salesforce_1[_0x34e6e5(0x1b2)]['Query'],'tmpPath':path_1['tmpPath']}),_0x24966b=[];do{const _0x54ecee=await _0x4d8491['execute']();if(!_0x54ecee)break;const _0x3be1e0=new salesforce_2['BulkXmlStreamParser']({'binaryFields':BINARY_FIELDS});for await(const _0x44ab49 of _0x54ecee[_0x34e6e5(0x1fb)](_0x3be1e0)){_0x24966b[_0x34e6e5(0x1ee)](_0x44ab49[_0x34e6e5(0x1ea)]);}}while(!_0x4d8491[_0x34e6e5(0x20f)]());return _0x24966b;}async[a62_0x15a1d4(0x1ca)](_0x5a1a2c){const _0x4a39f2=a62_0x15a1d4,_0x31903b=_0x5a1a2c[_0x4a39f2(0x1d0)]();_0x31903b[_0x4a39f2(0x1de)](_0x3589d0=>{const _0x545fe0=_0x4a39f2,_0x1f71ec=_0x3589d0['name'],_0x4283b3=_0x1f71ec['substring'](_0x1f71ec['lastIndexOf']('.')+0x1);if(!EXCLUDED_TYPES[_0x545fe0(0x206)](_0x4283b3)){let _0x17eadd=_0x3589d0[_0x545fe0(0x1c8)]()[_0x545fe0(0x203)](_0x545fe0(0x1b5)),_0x40997b=![];for(const _0x4f5a97 in this['variables']){const _0x300359='%%'+_0x4f5a97+'%%';if(_0x17eadd[_0x545fe0(0x1f0)](_0x300359)!==-0x1){const _0x1ba072=new RegExp(_0x300359,'ig');_0x17eadd=_0x17eadd[_0x545fe0(0x1dd)](_0x1ba072,this[_0x545fe0(0x1fe)][_0x4f5a97]),_0x40997b=!![];}}_0x40997b&&_0x5a1a2c['updateFile'](_0x3589d0,Buffer[_0x545fe0(0x1b1)](_0x17eadd,_0x545fe0(0x1b5)));}});}async['getComponentHistoryIds'](_0x4a42e7){const _0x440e7e=a62_0x15a1d4,_0x3c6a7f=[];for(const _0x178b78 of utils_2['ArrayUtils'][_0x440e7e(0x1e6)](_0x4a42e7,chunkSize)){const _0xd7182f=new salesforce_2['QueryBuilder']()[_0x440e7e(0x20c)]('Id')[_0x440e7e(0x1b1)](this['namespace']+_0x440e7e(0x1bc))['where'](this[_0x440e7e(0x1c0)]+_0x440e7e(0x1c9),{'branchId':this[_0x440e7e(0x1db)]})['andWhere'](this[_0x440e7e(0x1c0)]+_0x440e7e(0x1b6),{'type':B2C_CARTRIDGE_TYPE})[_0x440e7e(0x1f5)](_0x440e7e(0x1b8),{'componentIds':_0x178b78})['build'](),_0x3d4700=new salesforce_2['QueryBuilder']()[_0x440e7e(0x20c)]('Id')['from'](this[_0x440e7e(0x1c0)]+_0x440e7e(0x1f8))[_0x440e7e(0x1bb)](this['namespace']+_0x440e7e(0x20d)+_0xd7182f+')')[_0x440e7e(0x1f5)](this[_0x440e7e(0x1c0)]+_0x440e7e(0x1fc),{'isLastVersion':!![]}),_0x247ba2=new salesforce_2['CompositeRetrieveData']({'api':this['apiVersion'],'queryBuilder':_0x3d4700,'instance':this[_0x440e7e(0x1d1)],'isTooling':![]});do{const _0x3d5915=await _0x247ba2[_0x440e7e(0x1c4)]()[_0x440e7e(0x1f2)](({records:_0xa5d42b})=>_0xa5d42b[_0x440e7e(0x205)](_0x7b2fd9=>_0x7b2fd9['Id']));_0x3d5915[_0x440e7e(0x1c2)]&&_0x3c6a7f[_0x440e7e(0x1ee)](_0x3d5915);}while(!_0x247ba2[_0x440e7e(0x20f)]());}return _0x3c6a7f;}async[a62_0x15a1d4(0x20a)](){const _0x23070a=a62_0x15a1d4,_0x418c14=path_2['default'][_0x23070a(0x1f3)](this['jobPath'],constants_1[_0x23070a(0x1cc)]);await(0x0,promises_1[_0x23070a(0x1f7)])(_0x418c14);const [_0x4e8acd]=await this[_0x23070a(0x1e5)]([this[_0x23070a(0x204)]],[constants_1[_0x23070a(0x201)]]);if(!_0x4e8acd)throw new Error(_0x23070a(0x1bf)+constants_1['FLOSUM_LIST_COMPONENTS_ATTACHMENT_NAME']+_0x23070a(0x1f1));return await(0x0,promises_1[_0x23070a(0x1e7)])(path_2[_0x23070a(0x1cd)]['join'](_0x418c14,constants_1['FLOSUM_LIST_COMPONENTS_ATTACHMENT_NAME']),_0x4e8acd),JSON['parse'](_0x4e8acd['toString']());}async[a62_0x15a1d4(0x1c4)](){const _0x282f00=a62_0x15a1d4;await this[_0x282f00(0x1b0)][_0x282f00(0x1e4)](_0x282f00(0x1c7));const _0x189dc6=await this[_0x282f00(0x20a)](),_0x53996=await this['getComponentHistoryIds'](_0x189dc6);let _0x405403=0x0;for(const _0x5dbba9 of utils_2['ArrayUtils'][_0x282f00(0x1e6)](_0x53996,chunkSize)){for(const _0x439523 of await this[_0x282f00(0x1e5)](_0x5dbba9)){const _0x41474c=new adm_zip_1[(_0x282f00(0x1cd))](_0x439523);this['isFlosumVariables']&&await this[_0x282f00(0x1ca)](_0x41474c),await(0x0,utils_1['extractAllToAsync'])(_0x41474c,this[_0x282f00(0x1ff)]),_0x405403++;}}await this[_0x282f00(0x1b0)][_0x282f00(0x1e4)](_0x282f00(0x1ae)+_0x405403+_0x282f00(0x1fa));}}exports[a62_0x15a1d4(0x1cd)]=RetrieveCartridges;