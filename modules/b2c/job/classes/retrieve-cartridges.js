const a62_0x2aaa7c=a62_0x49ad;(function(_0x237e95,_0x39253b){const _0x4238a8=a62_0x49ad,_0x304c77=_0x237e95();while(!![]){try{const _0x49c283=-parseInt(_0x4238a8(0x112))/0x1*(parseInt(_0x4238a8(0x109))/0x2)+parseInt(_0x4238a8(0x110))/0x3*(parseInt(_0x4238a8(0x101))/0x4)+parseInt(_0x4238a8(0xf8))/0x5*(-parseInt(_0x4238a8(0xff))/0x6)+-parseInt(_0x4238a8(0xd0))/0x7+-parseInt(_0x4238a8(0x115))/0x8+-parseInt(_0x4238a8(0x10b))/0x9+parseInt(_0x4238a8(0xd9))/0xa*(parseInt(_0x4238a8(0xe3))/0xb);if(_0x49c283===_0x39253b)break;else _0x304c77['push'](_0x304c77['shift']());}catch(_0x3527ed){_0x304c77['push'](_0x304c77['shift']());}}}(a62_0x1513,0x57531));const a62_0x40fe10=(function(){let _0x5a4a4c=!![];return function(_0xf0c707,_0x148cdf){const _0x36ada1=_0x5a4a4c?function(){const _0x2ea20c=a62_0x49ad;if(_0x148cdf){const _0x453a03=_0x148cdf[_0x2ea20c(0xdc)](_0xf0c707,arguments);return _0x148cdf=null,_0x453a03;}}:function(){};return _0x5a4a4c=![],_0x36ada1;};}()),a62_0x1340dd=a62_0x40fe10(this,function(){const _0x1400eb=a62_0x49ad;return a62_0x1340dd[_0x1400eb(0xdd)]()[_0x1400eb(0xef)](_0x1400eb(0xf4))['toString']()[_0x1400eb(0x11e)](a62_0x1340dd)[_0x1400eb(0xef)](_0x1400eb(0xf4));});a62_0x1340dd();function a62_0x1513(){const _0x5b7ed7=['includes','woff','ttf','eot','3gVDEfJ','where','1jKTrEk','Attachment','isLastVersion__c\x20=\x20:isLastVersion','1109144nLkkMX','__importDefault','variables','tmpPath','pipe','applyFlosumVariables','default','Retrieved\x20','getComponentHistoryIds','constructor','axiosInstance','andWhere','__esModule','woff2','zip','\x20file(s).','2705871kxpXlr','CompositeRetrieveData','utf8','getEntries','@flosum/salesforce','Bulk1RetrieveData','ico','Query','QueryBuilder','10UnBeuz','Bulk1JobOperation','svg','apply','toString','BodyLength','execute','./utils','../../../git/internal/fs.internal','ParentId\x20IN\x20(:componentHistoryIds)','13143691XZGDei','isFlosumVariables','lastIndexOf','namespace','logger','rar','map','jpg','select','exists','BulkXmlStreamParser','keys','search','png','apiVersion','Component__c\x20IN\x20(','../../../../configs/path','(((.+)+)+)+$','fs/promises','adm-zip','push','329390HSMIFT','Branch__c\x20=\x20:branchId','jobPath','Body','CartridgeFile','length','then','12DQiDtu','indexOf','1316180MZPOAe','otf','Component_Type__c\x20=\x20:type','BulkV1QueryContentType','forEach','pdf','retriveAttachments','Component_History__c','923354ULwyZa','getData','428544HpXVpS'];a62_0x1513=function(){return _0x5b7ed7;};return a62_0x1513();}'use strict';var __importDefault=this&&this[a62_0x2aaa7c(0x116)]||function(_0x2d1dc1){const _0x2543c3=a62_0x2aaa7c;return _0x2d1dc1&&_0x2d1dc1[_0x2543c3(0x121)]?_0x2d1dc1:{'default':_0x2d1dc1};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const salesforce_1=require(a62_0x2aaa7c(0xd4)),salesforce_2=require(a62_0x2aaa7c(0xd4)),utils_1=require(a62_0x2aaa7c(0xe0)),promises_1=require(a62_0x2aaa7c(0xf5)),fs_internal_1=require(a62_0x2aaa7c(0xe1)),path_1=require(a62_0x2aaa7c(0xf3)),adm_zip_1=__importDefault(require(a62_0x2aaa7c(0xf6))),B2C_CARTRIDGE_TYPE=a62_0x2aaa7c(0xfc),BINARY_FIELDS=['Body'],EXCLUDED_TYPES=[a62_0x2aaa7c(0xea),a62_0x2aaa7c(0xdb),a62_0x2aaa7c(0x10f),a62_0x2aaa7c(0x102),'jpeg',a62_0x2aaa7c(0xf0),a62_0x2aaa7c(0x10d),a62_0x2aaa7c(0x122),a62_0x2aaa7c(0x10e),a62_0x2aaa7c(0xd6),a62_0x2aaa7c(0x123),a62_0x2aaa7c(0xe8),'gzip',a62_0x2aaa7c(0x106)];function a62_0x49ad(_0x59f9b8,_0xc3f2d4){const _0xe7315a=a62_0x1513();return a62_0x49ad=function(_0x1340dd,_0x40fe10){_0x1340dd=_0x1340dd-0xd0;let _0x151392=_0xe7315a[_0x1340dd];return _0x151392;},a62_0x49ad(_0x59f9b8,_0xc3f2d4);}class RetrieveCartridges{constructor(_0x587f7a,_0x56b393,_0x503fd5,_0x37ec4a,_0x4cf89e,_0x1f6d36,_0x205aeb){const _0xb3bcb2=a62_0x2aaa7c;this[_0xb3bcb2(0xfa)]=_0x587f7a,this['axiosInstance']=_0x56b393,this[_0xb3bcb2(0xf1)]=_0x503fd5,this[_0xb3bcb2(0xe6)]=_0x37ec4a,this['branchId']=_0x4cf89e,this['variables']=_0x1f6d36,this[_0xb3bcb2(0xe7)]=_0x205aeb,this['isFlosumVariables']=![],this[_0xb3bcb2(0xe4)]=Object[_0xb3bcb2(0xee)](this[_0xb3bcb2(0x117)])[_0xb3bcb2(0xfd)]>0x0;}async['retriveAttachments'](_0x10fd79){const _0x479318=a62_0x2aaa7c,_0x34b040=new salesforce_2[(_0x479318(0xd8))]()[_0x479318(0xeb)]('Body','Name',_0x479318(0xde))['from'](_0x479318(0x113))[_0x479318(0x111)](_0x479318(0xe2),{'componentHistoryIds':_0x10fd79});!await fs_internal_1['FS'][_0x479318(0xec)](path_1[_0x479318(0x118)])&&await(0x0,promises_1['mkdir'])(path_1[_0x479318(0x118)],{'recursive':!![]});const _0x5b1c9e=new salesforce_1[(_0x479318(0xd5))]({'instance':this[_0x479318(0x11f)],'api':this[_0x479318(0xf1)],'pollInterval':0x1388,'queryBuilder':_0x34b040,'objectName':_0x479318(0x113),'contentType':salesforce_1[_0x479318(0x104)]['APPLICATION_XML'],'jobOperation':salesforce_1[_0x479318(0xda)][_0x479318(0xd7)],'tmpPath':path_1['tmpPath']});let _0x51c556=0x0;do{const _0x4ef941=await _0x5b1c9e[_0x479318(0xdf)]();if(!_0x4ef941)break;const _0x3c029a=new salesforce_2[(_0x479318(0xed))]({'binaryFields':BINARY_FIELDS});for await(const _0x391cd7 of _0x4ef941[_0x479318(0x119)](_0x3c029a)){_0x51c556++;const _0x3afe63=new adm_zip_1[(_0x479318(0x11b))](_0x391cd7[_0x479318(0xfb)]);this[_0x479318(0xe4)]&&await this['applyFlosumVariables'](_0x3afe63),await(0x0,utils_1['extractAllToAsync'])(_0x3afe63,this[_0x479318(0xfa)]);}}while(!_0x5b1c9e['getIsDone']());return _0x51c556;}async[a62_0x2aaa7c(0x11a)](_0x56522e){const _0x373f7f=a62_0x2aaa7c,_0x212efc=_0x56522e[_0x373f7f(0xd3)]();_0x212efc[_0x373f7f(0x105)](_0x2c8dee=>{const _0x9965d=_0x373f7f,_0x12e486=_0x2c8dee['name'],_0x587f8a=_0x12e486['substring'](_0x12e486[_0x9965d(0xe5)]('.')+0x1);if(!EXCLUDED_TYPES[_0x9965d(0x10c)](_0x587f8a)){let _0xa76286=_0x2c8dee[_0x9965d(0x10a)]()[_0x9965d(0xdd)](_0x9965d(0xd2)),_0x62d1e8=![];for(const _0x26d029 in this[_0x9965d(0x117)]){const _0x3b4c2a='%%'+_0x26d029+'%%';if(_0xa76286[_0x9965d(0x100)](_0x3b4c2a)!==-0x1){const _0x116ab6=new RegExp(_0x3b4c2a,'ig');_0xa76286=_0xa76286['replace'](_0x116ab6,this['variables'][_0x26d029]),_0x62d1e8=!![];}}_0x62d1e8&&_0x56522e['updateFile'](_0x2c8dee,Buffer['from'](_0xa76286,_0x9965d(0xd2)));}});}async[a62_0x2aaa7c(0x11d)](){const _0x4413d5=a62_0x2aaa7c,_0x46b1b0=[],_0x44d7a5=new salesforce_2[(_0x4413d5(0xd8))]()[_0x4413d5(0xeb)]('Id')['from'](this[_0x4413d5(0xe6)]+'Component__c')[_0x4413d5(0x111)](this[_0x4413d5(0xe6)]+_0x4413d5(0xf9),{'branchId':this['branchId']})[_0x4413d5(0x120)](this[_0x4413d5(0xe6)]+_0x4413d5(0x103),{'type':B2C_CARTRIDGE_TYPE})['build'](),_0x40e542=new salesforce_2[(_0x4413d5(0xd8))]()[_0x4413d5(0xeb)]('Id')['from'](this[_0x4413d5(0xe6)]+_0x4413d5(0x108))[_0x4413d5(0x111)](this[_0x4413d5(0xe6)]+_0x4413d5(0xf2)+_0x44d7a5+')')[_0x4413d5(0x120)](this[_0x4413d5(0xe6)]+_0x4413d5(0x114),{'isLastVersion':!![]}),_0x511242=new salesforce_2[(_0x4413d5(0xd1))]({'api':this['apiVersion'],'queryBuilder':_0x40e542,'instance':this['axiosInstance'],'isTooling':![]});do{const _0x495cf7=await _0x511242[_0x4413d5(0xdf)]()[_0x4413d5(0xfe)](({records:_0x6f3660})=>_0x6f3660[_0x4413d5(0xe9)](_0x1ae3d5=>_0x1ae3d5['Id']));_0x495cf7[_0x4413d5(0xfd)]&&_0x46b1b0[_0x4413d5(0xf7)](_0x495cf7);}while(!_0x511242['getIsDone']());return _0x46b1b0;}async[a62_0x2aaa7c(0xdf)](){const _0x32867d=a62_0x2aaa7c,_0x65a174=await this[_0x32867d(0x11d)]();let _0x5d34a4=0x0;for(const _0x1bfdbe of _0x65a174){_0x5d34a4+=await this[_0x32867d(0x107)](_0x1bfdbe);}await this[_0x32867d(0xe7)]['log'](_0x32867d(0x11c)+_0x5d34a4+_0x32867d(0x124));}}exports[a62_0x2aaa7c(0x11b)]=RetrieveCartridges;