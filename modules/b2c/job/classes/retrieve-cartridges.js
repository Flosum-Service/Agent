const a62_0x3186ef=a62_0x46d7;(function(_0x440fe5,_0x130310){const _0xf3f113=a62_0x46d7,_0x510c0e=_0x440fe5();while(!![]){try{const _0x446a19=-parseInt(_0xf3f113(0xa8))/0x1*(parseInt(_0xf3f113(0x9d))/0x2)+parseInt(_0xf3f113(0x8b))/0x3+parseInt(_0xf3f113(0xbe))/0x4*(-parseInt(_0xf3f113(0xa4))/0x5)+-parseInt(_0xf3f113(0xc1))/0x6*(parseInt(_0xf3f113(0x8d))/0x7)+-parseInt(_0xf3f113(0xa0))/0x8+parseInt(_0xf3f113(0xab))/0x9*(-parseInt(_0xf3f113(0x8e))/0xa)+parseInt(_0xf3f113(0xbb))/0xb;if(_0x446a19===_0x130310)break;else _0x510c0e['push'](_0x510c0e['shift']());}catch(_0x9087fa){_0x510c0e['push'](_0x510c0e['shift']());}}}(a62_0x367b,0xd0044));const a62_0x454e0a=(function(){let _0x5d1c8f=!![];return function(_0x291ce9,_0x3d7361){const _0x2de4be=_0x5d1c8f?function(){const _0x1c8722=a62_0x46d7;if(_0x3d7361){const _0x2e56f0=_0x3d7361[_0x1c8722(0xb9)](_0x291ce9,arguments);return _0x3d7361=null,_0x2e56f0;}}:function(){};return _0x5d1c8f=![],_0x2de4be;};}()),a62_0xa0e0b3=a62_0x454e0a(this,function(){const _0x3a6266=a62_0x46d7;return a62_0xa0e0b3[_0x3a6266(0xb7)]()[_0x3a6266(0xc9)](_0x3a6266(0x9c))['toString']()[_0x3a6266(0xc4)](a62_0xa0e0b3)[_0x3a6266(0xc9)](_0x3a6266(0x9c));});a62_0xa0e0b3();'use strict';var __importDefault=this&&this[a62_0x3186ef(0x98)]||function(_0x48146b){const _0x51c7fe=a62_0x3186ef;return _0x48146b&&_0x48146b[_0x51c7fe(0xb0)]?_0x48146b:{'default':_0x48146b};};Object[a62_0x3186ef(0xbc)](exports,a62_0x3186ef(0xb0),{'value':!![]});function a62_0x46d7(_0x3066be,_0x3d7d1e){const _0x5e608f=a62_0x367b();return a62_0x46d7=function(_0xa0e0b3,_0x454e0a){_0xa0e0b3=_0xa0e0b3-0x86;let _0x367bba=_0x5e608f[_0xa0e0b3];return _0x367bba;},a62_0x46d7(_0x3066be,_0x3d7d1e);}const salesforce_1=require(a62_0x3186ef(0xbf)),salesforce_2=require(a62_0x3186ef(0xbf)),utils_1=require(a62_0x3186ef(0xd8)),adm_zip_1=__importDefault(require('adm-zip')),B2C_CARTRIDGE_TYPE=a62_0x3186ef(0xa6),BINARY_FIELDS=[a62_0x3186ef(0xd2)],EXCLUDED_TYPES=[a62_0x3186ef(0x9b),a62_0x3186ef(0xaa),a62_0x3186ef(0x88),a62_0x3186ef(0xa2),a62_0x3186ef(0xc7),a62_0x3186ef(0xc5),a62_0x3186ef(0xc0),a62_0x3186ef(0xd4),'ttf',a62_0x3186ef(0x8f),a62_0x3186ef(0x9a),'rar','gzip',a62_0x3186ef(0xa5)];class RetrieveCartridges{constructor(_0x293998,_0x11d642,_0x22434e,_0x13b14c,_0x4007c5,_0x29cca5,_0x5bd9f1){const _0x21264=a62_0x3186ef;this[_0x21264(0xbd)]=_0x293998,this[_0x21264(0xcd)]=_0x11d642,this[_0x21264(0xcf)]=_0x22434e,this[_0x21264(0x90)]=_0x13b14c,this['branchId']=_0x4007c5,this[_0x21264(0xba)]=_0x29cca5,this[_0x21264(0xd6)]=_0x5bd9f1,this['isFlosumVariables']=![],this[_0x21264(0xb4)]=Object['keys'](this[_0x21264(0xba)])[_0x21264(0xd5)]>0x0;}async[a62_0x3186ef(0xc6)](_0x366daa){const _0x2bd330=a62_0x3186ef,_0x57e7e4=new salesforce_2['QueryBuilder']()[_0x2bd330(0xce)]('Body',_0x2bd330(0xc3),'BodyLength')[_0x2bd330(0xb1)](_0x2bd330(0x8c))[_0x2bd330(0xa3)](_0x2bd330(0xd1),{'componentHistoryIds':_0x366daa}),_0x6e5403=new salesforce_1[(_0x2bd330(0xad))]({'instance':this[_0x2bd330(0xcd)],'api':this[_0x2bd330(0xcf)],'pollInterval':0x1388,'queryBuilder':_0x57e7e4,'objectName':_0x2bd330(0x8c),'contentType':salesforce_1[_0x2bd330(0xb8)][_0x2bd330(0x96)],'jobOperation':salesforce_1[_0x2bd330(0xd9)][_0x2bd330(0x99)]});let _0x266b38=0x0;do{const _0x337b6c=await _0x6e5403[_0x2bd330(0x92)]();if(!_0x337b6c)break;const _0x2bd890=new salesforce_2['BulkXmlStreamParser']({'binaryFields':BINARY_FIELDS});for await(const _0x1031a2 of _0x337b6c[_0x2bd330(0xc8)](_0x2bd890)){_0x266b38++;const _0x1194b6=new adm_zip_1['default'](_0x1031a2[_0x2bd330(0xd2)]);this[_0x2bd330(0xb4)]&&await this[_0x2bd330(0xca)](_0x1194b6),await(0x0,utils_1[_0x2bd330(0x87)])(_0x1194b6,this[_0x2bd330(0xbd)]);}}while(!_0x6e5403[_0x2bd330(0xcc)]());return _0x266b38;}async[a62_0x3186ef(0xca)](_0x200a10){const _0x1531ae=a62_0x3186ef,_0x48a7b7=_0x200a10[_0x1531ae(0x93)]();_0x48a7b7['forEach'](_0xdd832a=>{const _0x505901=_0x1531ae,_0x29529d=_0xdd832a[_0x505901(0x91)],_0x25fd85=_0x29529d[_0x505901(0xd7)](_0x29529d[_0x505901(0x97)]('.')+0x1);if(!EXCLUDED_TYPES[_0x505901(0x86)](_0x25fd85)){let _0x5918b4=_0xdd832a[_0x505901(0xa7)]()[_0x505901(0xb7)](_0x505901(0xac)),_0x2453ac=![];for(const _0x42a782 in this[_0x505901(0xba)]){const _0x4a8413='%%'+_0x42a782+'%%';if(_0x5918b4[_0x505901(0xb5)](_0x4a8413)!==-0x1){const _0x37673e=new RegExp(_0x4a8413,'ig');_0x5918b4=_0x5918b4[_0x505901(0x89)](_0x37673e,this[_0x505901(0xba)][_0x42a782]),_0x2453ac=!![];}}_0x2453ac&&_0x200a10[_0x505901(0xb2)](_0xdd832a,Buffer['from'](_0x5918b4,'utf8'));}});}async[a62_0x3186ef(0x95)](){const _0x1603c9=a62_0x3186ef,_0x32c864=[],_0x3053d4=new salesforce_2[(_0x1603c9(0xd3))]()[_0x1603c9(0xce)]('Id')[_0x1603c9(0xb1)](this['namespace']+_0x1603c9(0x9e))[_0x1603c9(0xa3)](this['namespace']+_0x1603c9(0xaf),{'branchId':this[_0x1603c9(0x8a)]})['andWhere'](this[_0x1603c9(0x90)]+'Component_Type__c\x20=\x20:type',{'type':B2C_CARTRIDGE_TYPE})[_0x1603c9(0xa9)](),_0x388bbf=new salesforce_2['QueryBuilder']()[_0x1603c9(0xce)]('Id')[_0x1603c9(0xb1)](this[_0x1603c9(0x90)]+_0x1603c9(0x9f))[_0x1603c9(0xa3)](this[_0x1603c9(0x90)]+_0x1603c9(0xb6)+_0x3053d4+')')['andWhere'](this['namespace']+_0x1603c9(0xc2),{'isLastVersion':!![]}),_0x51bcc7=new salesforce_2[(_0x1603c9(0xd0))]({'api':this[_0x1603c9(0xcf)],'queryBuilder':_0x388bbf,'instance':this[_0x1603c9(0xcd)],'isTooling':![]});do{const _0x15fa63=await _0x51bcc7[_0x1603c9(0x92)]()[_0x1603c9(0xb3)](({records:_0x3eaf9f})=>_0x3eaf9f[_0x1603c9(0xae)](_0x3ed1a3=>_0x3ed1a3['Id']));_0x15fa63[_0x1603c9(0xd5)]&&_0x32c864[_0x1603c9(0x94)](_0x15fa63);}while(!_0x51bcc7['getIsDone']());return _0x32c864;}async[a62_0x3186ef(0x92)](){const _0x10c075=a62_0x3186ef,_0x4cc4f8=await this['getComponentHistoryIds']();let _0x11b5c5=0x0;for(const _0x172f88 of _0x4cc4f8){_0x11b5c5+=await this[_0x10c075(0xc6)](_0x172f88);}await this['logger']['log']('Retrieved\x20'+_0x11b5c5+_0x10c075(0xcb));}}function a62_0x367b(){const _0x5e0b50=['toString','BulkV1QueryContentType','apply','variables','52017174ckWKvw','defineProperty','jobPath','682628HjOkvs','@flosum/salesforce','woff','1584baexPw','isLastVersion__c\x20=\x20:isLastVersion','Name','constructor','png','retriveAttachments','jpeg','pipe','search','applyFlosumVariables','\x20file(s).','getIsDone','axiosInstance','select','apiVersion','CompositeRetrieveData','ParentId\x20IN\x20(:componentHistoryIds)','Body','QueryBuilder','woff2','length','logger','substring','./utils','Bulk1JobOperation','includes','extractAllToAsync','eot','replace','branchId','1806384FRsnFm','Attachment','38682ZvSyPT','344510vgWaPI','ico','namespace','name','execute','getEntries','push','getComponentHistoryIds','APPLICATION_XML','lastIndexOf','__importDefault','Query','zip','jpg','(((.+)+)+)+$','18jQTWiB','Component__c','Component_History__c','8490520eGlhsV','default','otf','where','25holvSJ','pdf','CartridgeFile','getData','57755ltHaXx','build','svg','153rlngQD','utf8','Bulk1RetrieveData','map','Branch__c\x20=\x20:branchId','__esModule','from','updateFile','then','isFlosumVariables','indexOf','Component__c\x20IN\x20('];a62_0x367b=function(){return _0x5e0b50;};return a62_0x367b();}exports[a62_0x3186ef(0xa1)]=RetrieveCartridges;