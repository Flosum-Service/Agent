const a64_0x8641d9=a64_0x42f4;(function(_0x5a4d6e,_0x10f9c5){const _0x309724=a64_0x42f4,_0x503bc8=_0x5a4d6e();while(!![]){try{const _0x326277=parseInt(_0x309724(0x1e7))/0x1+parseInt(_0x309724(0x204))/0x2*(parseInt(_0x309724(0x1f3))/0x3)+-parseInt(_0x309724(0x20b))/0x4*(-parseInt(_0x309724(0x1e0))/0x5)+parseInt(_0x309724(0x1e4))/0x6+parseInt(_0x309724(0x1ef))/0x7+parseInt(_0x309724(0x1fd))/0x8*(-parseInt(_0x309724(0x206))/0x9)+-parseInt(_0x309724(0x1ec))/0xa*(-parseInt(_0x309724(0x1e5))/0xb);if(_0x326277===_0x10f9c5)break;else _0x503bc8['push'](_0x503bc8['shift']());}catch(_0x14d7a4){_0x503bc8['push'](_0x503bc8['shift']());}}}(a64_0x5aeb,0x7fe8b));const a64_0x5edd39=(function(){let _0x48df5d=!![];return function(_0x44a322,_0x504e5f){const _0x1d18fa=_0x48df5d?function(){const _0x2aab96=a64_0x42f4;if(_0x504e5f){const _0xbf4b09=_0x504e5f[_0x2aab96(0x1e8)](_0x44a322,arguments);return _0x504e5f=null,_0xbf4b09;}}:function(){};return _0x48df5d=![],_0x1d18fa;};}()),a64_0x42377b=a64_0x5edd39(this,function(){const _0x31af14=a64_0x42f4;return a64_0x42377b[_0x31af14(0x209)]()[_0x31af14(0x1f4)]('(((.+)+)+)+$')['toString']()[_0x31af14(0x1ea)](a64_0x42377b)['search'](_0x31af14(0x208));});a64_0x42377b();'use strict';var __importDefault=this&&this[a64_0x8641d9(0x1fe)]||function(_0x2cae75){const _0x3ba914=a64_0x8641d9;return _0x2cae75&&_0x2cae75[_0x3ba914(0x207)]?_0x2cae75:{'default':_0x2cae75};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a64_0x8641d9(0x1f8)]=exports[a64_0x8641d9(0x1df)]=exports[a64_0x8641d9(0x1fa)]=exports[a64_0x8641d9(0x203)]=void 0x0;function a64_0x5aeb(){const _0x258004=['nodebuffer','concat','1763041fXeaHa','file','async','resolve','30519CdqhjJ','search','isDirectory','push','fs/promises','getZipFromDir','lstatSync','getStreamAttachments','default','mkdir','8IsmtSv','__importDefault','relative','files','writeFile','readFileSync','getStreamChunks','18aYIBdD','dir','6539706KIhylY','__esModule','(((.+)+)+)+$','toString','filter','4SWLBLn','jszip','join','dirname','XMLParser','unzipAttachments','604530oNooUI','records','loadAsync','Body','2585496GGAYDP','341IcbuZW','length','29652QGPBcd','apply','mode','constructor','isArray','105050xkpfBe'];a64_0x5aeb=function(){return _0x258004;};return a64_0x5aeb();}const promises_1=require(a64_0x8641d9(0x1f7)),fs_1=require('fs'),fast_xml_parser_1=require('fast-xml-parser'),path_1=__importDefault(require('path')),jszip_1=__importDefault(require(a64_0x8641d9(0x20c)));async function getStreamChunks(_0x2ef08b){const _0x1f7596=a64_0x8641d9,_0x524975=[];for await(const _0x5a35ee of _0x2ef08b){_0x524975[_0x1f7596(0x1f6)](_0x5a35ee[_0x1f7596(0x209)]());}return _0x524975;}exports[a64_0x8641d9(0x203)]=getStreamChunks;async function getStreamAttachments(_0xb7d6f7){const _0x21e93e=a64_0x8641d9,_0xd4b501=[],_0x463aa7=await getStreamChunks(_0xb7d6f7),{queryResult:_0xf8b086}=new fast_xml_parser_1[(_0x21e93e(0x20f))]()['parse'](_0x463aa7['join']('')),_0x21dff0=Array[_0x21e93e(0x1eb)](_0xf8b086[_0x21e93e(0x1e1)])?_0xf8b086['records']:[_0xf8b086[_0x21e93e(0x1e1)]];return _0x21dff0[_0x21e93e(0x1e6)]&&_0xd4b501[_0x21e93e(0x1f6)](..._0x21dff0[_0x21e93e(0x20a)](_0x165c12=>!!_0x165c12[_0x21e93e(0x1e3)])),_0xd4b501;}exports['getStreamAttachments']=getStreamAttachments;async function unzipAttachments(_0x37651b,_0x5d004a){const _0x9a0d61=a64_0x8641d9;for(const _0x28d554 of _0x37651b){const _0x489908=new jszip_1[(_0x9a0d61(0x1fb))]();await _0x489908[_0x9a0d61(0x1e2)](_0x28d554['Body'],{'base64':!![]});for(let _0x481385 in _0x489908[_0x9a0d61(0x200)]){const _0x3c3256=_0x489908[_0x9a0d61(0x1f0)](_0x481385);if(_0x3c3256){if(_0x3c3256[_0x9a0d61(0x205)])continue;const _0x86f093=path_1[_0x9a0d61(0x1fb)][_0x9a0d61(0x20e)](path_1[_0x9a0d61(0x1fb)][_0x9a0d61(0x20d)](_0x5d004a,_0x481385));await(0x0,promises_1[_0x9a0d61(0x1fc)])(_0x86f093,{'recursive':!![]});const _0x57e74f=await _0x3c3256[_0x9a0d61(0x1f1)](_0x9a0d61(0x1ed));await(0x0,promises_1[_0x9a0d61(0x201)])(path_1['default'][_0x9a0d61(0x20d)](_0x5d004a,_0x481385),_0x57e74f,{});}}}}function a64_0x42f4(_0x1a0aa2,_0x1e12cc){const _0x4be9cb=a64_0x5aeb();return a64_0x42f4=function(_0x42377b,_0x5edd39){_0x42377b=_0x42377b-0x1df;let _0x5aeb7f=_0x4be9cb[_0x42377b];return _0x5aeb7f;},a64_0x42f4(_0x1a0aa2,_0x1e12cc);}exports['unzipAttachments']=unzipAttachments;const getPathsFromDir=_0x4e488e=>{const _0x48dea0=a64_0x8641d9;let _0x29341b=[];const _0x4160ea=(0x0,fs_1['readdirSync'])(_0x4e488e);let _0x46ea8b=_0x4160ea[_0x48dea0(0x1e6)];if(!_0x46ea8b)return _0x29341b;for(let _0x5c5864 of _0x4160ea){_0x5c5864=path_1[_0x48dea0(0x1fb)][_0x48dea0(0x1f2)](_0x4e488e,_0x5c5864);const _0xa1a085=(0x0,fs_1[_0x48dea0(0x1f9)])(_0x5c5864);_0xa1a085&&_0xa1a085[_0x48dea0(0x1f5)]()?_0x29341b=_0x29341b[_0x48dea0(0x1ee)](getPathsFromDir(_0x5c5864)):_0x29341b[_0x48dea0(0x1f6)](_0x5c5864);if(!--_0x46ea8b)return _0x29341b;}return _0x29341b;};function getZipFromDir(_0x2a719f,_0x39c17f){const _0x5974a7=a64_0x8641d9,_0x25c378=getPathsFromDir(_0x2a719f),_0x133ffe=new jszip_1[(_0x5974a7(0x1fb))]();for(const _0x5004be of _0x25c378){const _0x4f1174=path_1[_0x5974a7(0x1fb)][_0x5974a7(0x20d)](_0x39c17f,path_1[_0x5974a7(0x1fb)][_0x5974a7(0x1ff)](path_1['default']['join'](_0x2a719f,'..'),_0x5004be)),_0x29a7ec=(0x0,fs_1[_0x5974a7(0x202)])(_0x5004be),_0x3fcbe0=(0x0,fs_1[_0x5974a7(0x1f9)])(_0x5004be),_0xc812b1=_0x3fcbe0[_0x5974a7(0x1e9)];!_0x3fcbe0['isSymbolicLink']()&&_0x133ffe[_0x5974a7(0x1f0)](_0x4f1174,_0x29a7ec,{'unixPermissions':_0xc812b1,'dir':_0x3fcbe0[_0x5974a7(0x1f5)]()});}return _0x133ffe;}exports[a64_0x8641d9(0x1f8)]=getZipFromDir;