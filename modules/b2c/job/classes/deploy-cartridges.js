const a58_0x5bc603=a58_0x1f2d;function a58_0x1f2d(_0x4f4b23,_0x434969){const _0x4e3204=a58_0x1899();return a58_0x1f2d=function(_0x238671,_0x8c9880){_0x238671=_0x238671-0xc9;let _0x189992=_0x4e3204[_0x238671];return _0x189992;},a58_0x1f2d(_0x4f4b23,_0x434969);}(function(_0x29b5c1,_0x38368d){const _0x555ab9=a58_0x1f2d,_0x16d846=_0x29b5c1();while(!![]){try{const _0x1ab12c=parseInt(_0x555ab9(0xd6))/0x1+parseInt(_0x555ab9(0xcf))/0x2*(parseInt(_0x555ab9(0xf7))/0x3)+parseInt(_0x555ab9(0xda))/0x4+-parseInt(_0x555ab9(0xf0))/0x5+-parseInt(_0x555ab9(0xfa))/0x6*(-parseInt(_0x555ab9(0xdb))/0x7)+-parseInt(_0x555ab9(0xe7))/0x8*(parseInt(_0x555ab9(0xe8))/0x9)+parseInt(_0x555ab9(0x100))/0xa*(-parseInt(_0x555ab9(0xef))/0xb);if(_0x1ab12c===_0x38368d)break;else _0x16d846['push'](_0x16d846['shift']());}catch(_0x3b8f05){_0x16d846['push'](_0x16d846['shift']());}}}(a58_0x1899,0x634df));function a58_0x1899(){const _0x146e55=['(((.+)+)+)+$','deployCartridges','activate','Access\x20token\x20has\x20','codeVersion','798700VjJBFb','name','__importDefault','instanceUrl','309532VJFvwb','2961McQtIR','clientSecret','been\x20recived.','constructor','\x27\x20=>\x20\x27','activateCodeVersionId','length','search','adm-zip','writeZip','not\x20','credentials','16UsLlVg','3239046qLgYBC','Cartridges\x20not\x20found.','./utils','defineProperty','.zip','default','deploy','33yngGFh','924920Wlgcug','logger','auth','sfcc-ci','getAccessToken','Activating\x20\x27','join','525858QhZNZN','clientId','activateCodeVersion','7806uORtvJ','code','../../constants','Deploying\x20\x27','/cartridges/','accessToken','967230lUKOcW','cartridges','toString','createZipFile','apply','execute','Receiving\x20access\x20token.','log','2hkkBFH','__esModule'];a58_0x1899=function(){return _0x146e55;};return a58_0x1899();}const a58_0x8c9880=(function(){let _0x16f6a0=!![];return function(_0x3e322b,_0xa67915){const _0x4c5c7a=_0x16f6a0?function(){const _0x1a4cea=a58_0x1f2d;if(_0xa67915){const _0xdb5ab0=_0xa67915[_0x1a4cea(0xcb)](_0x3e322b,arguments);return _0xa67915=null,_0xdb5ab0;}}:function(){};return _0x16f6a0=![],_0x4c5c7a;};}()),a58_0x238671=a58_0x8c9880(this,function(){const _0x226b4a=a58_0x1f2d;return a58_0x238671[_0x226b4a(0xc9)]()['search'](_0x226b4a(0xd1))[_0x226b4a(0xc9)]()[_0x226b4a(0xde)](a58_0x238671)[_0x226b4a(0xe2)]('(((.+)+)+)+$');});a58_0x238671();'use strict';var __importDefault=this&&this[a58_0x5bc603(0xd8)]||function(_0x1183fd){const _0x457378=a58_0x5bc603;return _0x1183fd&&_0x1183fd[_0x457378(0xd0)]?_0x1183fd:{'default':_0x1183fd};};Object[a58_0x5bc603(0xeb)](exports,'__esModule',{'value':!![]});const constants_1=require(a58_0x5bc603(0xfc)),utils_1=require(a58_0x5bc603(0xea)),path_1=__importDefault(require('path')),adm_zip_1=__importDefault(require(a58_0x5bc603(0xe3))),SFCC=require(a58_0x5bc603(0xf3));class DeployCartridges{constructor(_0x576409,_0x12e684,_0xfdfd68,_0x1bff28,_0x2fd1e7,_0x2e1652){const _0x11ad81=a58_0x5bc603;this['jobPath']=_0x576409,this[_0x11ad81(0xe6)]=_0x12e684,this[_0x11ad81(0x101)]=_0xfdfd68,this[_0x11ad81(0xd5)]=_0x1bff28,this[_0x11ad81(0xe0)]=_0x2fd1e7,this[_0x11ad81(0xf1)]=_0x2e1652;const {instanceUrl:_0x1b9ca6,clientId:_0x284cc0,clientSecret:_0x3128c5}=this[_0x11ad81(0xe6)];this['instanceUrl']=_0x1b9ca6,this[_0x11ad81(0xf8)]=_0x284cc0,this[_0x11ad81(0xdc)]=_0x3128c5;}async[a58_0x5bc603(0xcc)](){const _0x2569f5=a58_0x5bc603;var _0xcaff2a;if(!((_0xcaff2a=this[_0x2569f5(0x101)])===null||_0xcaff2a===void 0x0?void 0x0:_0xcaff2a[_0x2569f5(0xe1)]))throw new Error(_0x2569f5(0xe9));await this[_0x2569f5(0xf1)]['log'](_0x2569f5(0xcd)),this[_0x2569f5(0xff)]=await this['getAccessToken'](),await this[_0x2569f5(0xf1)]['log'](_0x2569f5(0xd4)+(!this[_0x2569f5(0xff)]?_0x2569f5(0xe5):'')+_0x2569f5(0xdd)),await this['deployCartridges'](),this[_0x2569f5(0xe0)]&&await this[_0x2569f5(0xf9)]();}async[a58_0x5bc603(0xd2)](){const _0x49c1bb=a58_0x5bc603;for(const _0x3c97fe of this[_0x49c1bb(0x101)]){const _0x47eef4=await this[_0x49c1bb(0xca)](_0x3c97fe);await this['logger'][_0x49c1bb(0xce)](_0x49c1bb(0xfd)+(_0x3c97fe[_0x49c1bb(0xd7)]+_0x49c1bb(0xec))+_0x49c1bb(0xdf)+this[_0x49c1bb(0xd9)]+_0x49c1bb(0xfe)+this[_0x49c1bb(0xd5)]+'\x27.'),await this['deploy'](_0x47eef4);}}async['createZipFile'](_0x26d035){const _0x535505=a58_0x5bc603,_0x3af9dc=path_1[_0x535505(0xed)]['join'](constants_1['SFRA_FOLDER_NAME'],'cartridges',_0x26d035['codeVersion']),_0x36b44d=path_1[_0x535505(0xed)][_0x535505(0xf6)](this['jobPath'],_0x3af9dc),_0x440399=_0x26d035[_0x535505(0xd7)]+_0x535505(0xec),_0x4e4503=path_1['default'][_0x535505(0xf6)](_0x36b44d,_0x440399);await this[_0x535505(0xf1)][_0x535505(0xce)]('Compressing\x20\x27'+_0x26d035[_0x535505(0xd7)]+_0x535505(0xdf)+_0x3af9dc+'/'+_0x440399+'\x27.');const _0x44b8dd=new adm_zip_1[(_0x535505(0xed))]();return await(0x0,utils_1['addLocalFolderAsync'])(_0x44b8dd,_0x36b44d,''+this['codeVersion']),await(0x0,utils_1[_0x535505(0xe4)])(_0x44b8dd,_0x4e4503),_0x4e4503;}async[a58_0x5bc603(0xf9)](){const _0x44c456=a58_0x5bc603;await this[_0x44c456(0xf1)]['log'](_0x44c456(0xf5)+this['activateCodeVersionId']+'\x27\x20code\x20version.'),await this[_0x44c456(0xd3)]();}async[a58_0x5bc603(0xf4)](){return new Promise((_0x1a35ec,_0xd0d587)=>{const _0x3c35c1=a58_0x1f2d;SFCC[_0x3c35c1(0xf2)][_0x3c35c1(0xf2)](this[_0x3c35c1(0xf8)],this['clientSecret'],(_0x5d0ba9,_0x3b9e9a)=>{_0x3b9e9a&&_0x1a35ec(_0x3b9e9a),_0x5d0ba9&&_0xd0d587(_0x5d0ba9);});});}async[a58_0x5bc603(0xee)](_0x186db3){return new Promise((_0xb1abf6,_0x313d34)=>{const _0x343ee8=a58_0x1f2d;SFCC['code'][_0x343ee8(0xee)](this[_0x343ee8(0xd9)],_0x186db3,this[_0x343ee8(0xff)],{},_0x443410=>{_0x443410?_0x313d34(_0x443410):_0xb1abf6();});});}async[a58_0x5bc603(0xd3)](){return new Promise((_0x2b5ffc,_0x2c9107)=>{const _0xebceb8=a58_0x1f2d;SFCC[_0xebceb8(0xfb)][_0xebceb8(0xd3)](this[_0xebceb8(0xd9)],this['codeVersion'],this['accessToken'],_0x8c374f=>{_0x8c374f?_0x2c9107(_0x8c374f):_0x2b5ffc();});});}}exports[a58_0x5bc603(0xed)]=DeployCartridges;