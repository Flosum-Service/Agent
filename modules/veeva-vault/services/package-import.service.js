function a404_0x4590(){const _0x176c8c=['package_components','8yThcfd','1732245SUKYbO','ENDPOINT_DEPLOY_PACKAGE','convertDeploymentAction','find','post','VeevaPackageStatus','length','put','4ORMdPa','VeevaResponseStatus','import','_veevaService','getJobResult','packageId','{package_id}','1576tUIqhl','PackageComponentStatus','_logger','href','file','form-data','VeevaConstants','defineProperty','../classes/errors/veeva-error','deployPackage','SUCCESS','includes','deploymentAction','endsWith','Get\x20deploy\x20result','913ZhiMfk','PackageDetailsDto','../dtos/package-component.dto','status','(((.+)+)+)+$','_connection','1320xyKiQP','VERIFIED','../dtos/package-details.dto','url','apply','PackageComponentDto','DEPLOYED','rel','getJobDetailUrl','updateVeevaConnection','41206tdIHni','1262060NvXxfx','packageComponentList','Deployment.log','fillPackageDeploymentAction','deployment_status__v','artifacts','ENDPOINT_VALIDATE_PACKAGE','uniqueName','5613990jBBBDr','map','filename','../constants/veeva.constants','createReadStream','importVpk','__importDefault','VeevaError','4097058EYQZxo','ArrayUtils','groupToMap','constructor','get','responseStatus','log','_saveLog','DEPLOYED_WITH_WARNINGS','text','503385QzKIrC','multipart/form-data','errors','getDeployDetailsAndSaveLog','responseDetails','__esModule','groupUniqueToMap','getValidationDetailsAndSaveLog','Get\x20validation\x20details.','filter','36ZQuCVi','isDeployed','data','vaultPackage','links','getLogResultText','ENDPOINT_EXPORT_IMPORT_PACKAGE','../enums/status.enums','Package\x20not\x20verified','formPackageComponentList','Cannot\x20find\x20deployment\x20results'];a404_0x4590=function(){return _0x176c8c;};return a404_0x4590();}const a404_0x27137f=a404_0x1046;(function(_0x2c3115,_0x163a47){const _0x34ac9e=a404_0x1046,_0x1fe32d=_0x2c3115();while(!![]){try{const _0x274a8b=-parseInt(_0x34ac9e(0x96))/0x1*(-parseInt(_0x34ac9e(0x87))/0x2)+-parseInt(_0x34ac9e(0x78))/0x3+parseInt(_0x34ac9e(0x80))/0x4*(parseInt(_0x34ac9e(0xc1))/0x5)+-parseInt(_0x34ac9e(0xaf))/0x6+-parseInt(_0x34ac9e(0xb7))/0x7*(-parseInt(_0x34ac9e(0x77))/0x8)+parseInt(_0x34ac9e(0x6b))/0x9*(parseInt(_0x34ac9e(0xa7))/0xa)+parseInt(_0x34ac9e(0xa6))/0xb*(parseInt(_0x34ac9e(0x9c))/0xc);if(_0x274a8b===_0x163a47)break;else _0x1fe32d['push'](_0x1fe32d['shift']());}catch(_0x4ad820){_0x1fe32d['push'](_0x1fe32d['shift']());}}}(a404_0x4590,0xc5903));const a404_0x4dba4e=(function(){let _0x59f6d9=!![];return function(_0x46f876,_0x52f5bc){const _0x218a90=_0x59f6d9?function(){const _0x909417=a404_0x1046;if(_0x52f5bc){const _0x58a77c=_0x52f5bc[_0x909417(0xa0)](_0x46f876,arguments);return _0x52f5bc=null,_0x58a77c;}}:function(){};return _0x59f6d9=![],_0x218a90;};}()),a404_0x264715=a404_0x4dba4e(this,function(){const _0x1bd86d=a404_0x1046;return a404_0x264715['toString']()['search'](_0x1bd86d(0x9a))['toString']()[_0x1bd86d(0xba)](a404_0x264715)['search'](_0x1bd86d(0x9a));});a404_0x264715();'use strict';var __importDefault=this&&this[a404_0x27137f(0xb5)]||function(_0x11cf1b){const _0x5bef49=a404_0x27137f;return _0x11cf1b&&_0x11cf1b[_0x5bef49(0xc6)]?_0x11cf1b:{'default':_0x11cf1b};};function a404_0x1046(_0x4fc931,_0x467645){const _0x400c45=a404_0x4590();return a404_0x1046=function(_0x264715,_0x4dba4e){_0x264715=_0x264715-0x6a;let _0x459043=_0x400c45[_0x264715];return _0x459043;},a404_0x1046(_0x4fc931,_0x467645);}Object[a404_0x27137f(0x8e)](exports,a404_0x27137f(0xc6),{'value':!![]}),exports['PackageImportService']=void 0x0;const veeva_constants_1=require(a404_0x27137f(0xb2)),status_enums_1=require(a404_0x27137f(0x72)),veeva_error_1=require(a404_0x27137f(0x8f)),form_data_1=__importDefault(require(a404_0x27137f(0x8c))),fs_1=require('fs'),veeva_auth_utils_1=require('../utils/veeva-auth.utils'),package_details_dto_1=require(a404_0x27137f(0x9e)),package_component_dto_1=require(a404_0x27137f(0x98)),array_utils_1=require('../utils/array.utils');class PackageImportService{constructor({veevaService:_0x5f4120,connection:_0x19a25b,logger:_0x470656,saveLog:_0x4f7c52}){const _0x32c350=a404_0x27137f;this[_0x32c350(0x83)]=_0x5f4120,this[_0x32c350(0x9b)]=_0x19a25b,this[_0x32c350(0x89)]=_0x470656,this[_0x32c350(0xbe)]=_0x4f7c52;}async['importVpk'](_0x5956ab,_0x2a5b4e=0x1){const _0x58ebca=a404_0x27137f;this[_0x58ebca(0x89)][_0x58ebca(0xbd)]('Import\x20package');const _0x918360=new form_data_1['default']();_0x918360['append'](_0x58ebca(0x8b),(0x0,fs_1[_0x58ebca(0xb3)])(_0x5956ab));const _0x77a60d=await this['_connection'][_0x58ebca(0x7f)](veeva_constants_1['VeevaConstants'][_0x58ebca(0x71)],_0x918360,{'headers':{'Content-Type':_0x58ebca(0xc2)}}),_0x52c719=_0x77a60d[_0x58ebca(0x6d)];if(_0x52c719[_0x58ebca(0xbc)]===status_enums_1['VeevaResponseStatus']['SUCCESS'])return _0x52c719[_0x58ebca(0x9f)];else{if(_0x2a5b4e>0x0)return await(0x0,veeva_auth_utils_1[_0x58ebca(0xa5)])(this[_0x58ebca(0x9b)]),await this[_0x58ebca(0xb4)](_0x5956ab,_0x2a5b4e-0x1);throw new veeva_error_1[(_0x58ebca(0xb6))](_0x52c719[_0x58ebca(0xc3)]);}}async['deployPackage'](_0xb97fae){const _0x3f812c=a404_0x27137f;this[_0x3f812c(0x89)][_0x3f812c(0xbd)]('Deploy\x20package');const _0x5538f7=await this[_0x3f812c(0x9b)][_0x3f812c(0x7c)](veeva_constants_1['VeevaConstants'][_0x3f812c(0x79)]['replace'](_0x3f812c(0x86),_0xb97fae)),_0x357fbe=await _0x5538f7[_0x3f812c(0x6d)];if(_0x357fbe[_0x3f812c(0xbc)]===status_enums_1['VeevaResponseStatus'][_0x3f812c(0x91)])return _0x357fbe[_0x3f812c(0x9f)];else throw new veeva_error_1[(_0x3f812c(0xb6))](_0x357fbe[_0x3f812c(0xc3)]);}async[a404_0x27137f(0xa4)](_0x313001){const _0x3c5a65=a404_0x27137f;this[_0x3c5a65(0x89)][_0x3c5a65(0xbd)]('Wait\x20Executing\x20job');const [_0x56670b]=await this[_0x3c5a65(0x83)][_0x3c5a65(0x84)]([_0x313001]);return _0x56670b[_0x3c5a65(0x6f)][_0x3c5a65(0x7b)](_0x299a13=>_0x299a13[_0x3c5a65(0xa3)]===_0x3c5a65(0xac))[_0x3c5a65(0x8a)];}async[a404_0x27137f(0xc8)](_0x2fe15b){const _0xfb3b1=a404_0x27137f;this['_logger']['log'](_0xfb3b1(0xc9));const {data:_0x499074}=await this['_connection'][_0xfb3b1(0xbb)](_0x2fe15b);if(_0x499074[_0xfb3b1(0xbc)]===status_enums_1[_0xfb3b1(0x81)]['SUCCESS']){const _0xded014=new package_details_dto_1[(_0xfb3b1(0x97))](),{log:_0x7bab81,id:_0x490cd7,package_status:_0x5e0570,package_steps:_0x6715a0}=_0x499074[_0xfb3b1(0x6e)],_0x3fc3f3=_0x7bab81[_0xfb3b1(0x6a)](_0x164cdc=>_0x164cdc['filename']['endsWith']('Validation.log')),_0x12a043=await this[_0xfb3b1(0x70)](_0x3fc3f3[0x0][_0xfb3b1(0x9f)]);await this[_0xfb3b1(0xbe)](_0x12a043,'Validation\x20Log'),_0xded014[_0xfb3b1(0x85)]=_0x490cd7,_0xded014[_0xfb3b1(0xa8)]=this[_0xfb3b1(0x74)](_0x6715a0),await this[_0xfb3b1(0xaa)](_0xded014);if(_0x5e0570!==status_enums_1['VeevaPackageStatus']['VERIFIED'])throw new Error(_0xfb3b1(0x73));return _0xded014;}else throw new veeva_error_1['VeevaError'](_0x499074[_0xfb3b1(0xc3)]);}async[a404_0x27137f(0xc4)](_0x530f66,_0x4a080d){const _0x334486=a404_0x27137f;var _0x4720b8;this[_0x334486(0x89)][_0x334486(0xbd)](_0x334486(0x95));const {data:_0x135ce5}=await this['_connection'][_0x334486(0xbb)](_0x530f66);if(_0x135ce5['responseStatus']===status_enums_1[_0x334486(0x81)][_0x334486(0x91)]){const {responseDetails:{deployment_log:_0x21d80c,package_status__v:_0x41dce5},package_steps:_0x2c6677}=_0x135ce5,_0x33d699=_0x21d80c['filter'](_0x49025c=>_0x49025c[_0x334486(0xb1)][_0x334486(0x94)](_0x334486(0xa9))),_0x1d7462=await this[_0x334486(0x70)](_0x33d699[0x0]['url']);await this['_saveLog'](_0x1d7462,'Deploy\x20Log'),_0x4a080d[_0x334486(0x6c)]=[status_enums_1[_0x334486(0x7d)][_0x334486(0xa2)],status_enums_1['VeevaPackageStatus'][_0x334486(0xbf)]][_0x334486(0x92)](_0x41dce5);const _0x1313e9=array_utils_1[_0x334486(0xb8)][_0x334486(0xc7)](this[_0x334486(0x74)](_0x2c6677),({uniqueName:_0x39a693})=>_0x39a693);for(const _0x45288f of _0x4a080d['packageComponentList']){const _0x4160d4=(_0x4720b8=_0x1313e9[_0x334486(0xbb)](_0x45288f[_0x334486(0xae)]))===null||_0x4720b8===void 0x0?void 0x0:_0x4720b8[_0x334486(0x99)];_0x4160d4&&(_0x45288f['status']=_0x4160d4);}_0x4a080d[_0x334486(0xa8)]=_0x4a080d[_0x334486(0xa8)][_0x334486(0x6a)](_0x57752d=>_0x57752d['status']!==status_enums_1[_0x334486(0x88)][_0x334486(0x9d)]);if(!_0x4a080d[_0x334486(0xa8)][_0x334486(0x7e)])throw new Error(_0x334486(0x75));return _0x4a080d;}else throw new veeva_error_1[(_0x334486(0xb6))](_0x135ce5[_0x334486(0xc3)]);}async[a404_0x27137f(0x70)](_0x2e0761){const _0x131cf9=a404_0x27137f,{data:_0x2d27d5}=await this['_connection'][_0x131cf9(0xbb)](_0x2e0761,{'responseType':_0x131cf9(0xc0)});return _0x2d27d5;}[a404_0x27137f(0x74)](_0x485a82){return _0x485a82['reduce']((_0x40c7a2,_0x1659ab)=>{const _0x403aa4=a404_0x1046,_0x4d2c6c=_0x1659ab[_0x403aa4(0x76)][_0x403aa4(0xb0)](_0x3de163=>new package_component_dto_1[(_0x403aa4(0xa1))]({'status':_0x1659ab[_0x403aa4(0xab)],'stepName':_0x1659ab['name__v'],'component':_0x3de163}));return[..._0x40c7a2,..._0x4d2c6c];},[]);}async[a404_0x27137f(0xaa)](_0x1a42d7){const _0x31ae12=a404_0x27137f,{data:_0x2137a8}=await this[_0x31ae12(0x9b)][_0x31ae12(0x7c)](veeva_constants_1[_0x31ae12(0x8d)][_0x31ae12(0xad)]['replace'](_0x31ae12(0x86),_0x1a42d7[_0x31ae12(0x85)]));if(_0x2137a8[_0x31ae12(0xbc)]===status_enums_1[_0x31ae12(0x81)][_0x31ae12(0x91)]){const {package_steps:_0x4ede15}=_0x2137a8[_0x31ae12(0xc5)],_0x4c855b=array_utils_1['ArrayUtils'][_0x31ae12(0xb9)](_0x1a42d7[_0x31ae12(0xa8)],({stepName:_0x45b0c0})=>_0x45b0c0);for(const {name__v:_0x2d094b,deployment_action:_0x4377b3}of _0x4ede15){for(const _0xd197a8 of _0x4c855b['get'](_0x2d094b)||[]){_0xd197a8[_0x31ae12(0x93)]=package_component_dto_1[_0x31ae12(0xa1)][_0x31ae12(0x7a)](_0x4377b3);}}}else throw new veeva_error_1[(_0x31ae12(0xb6))](_0x2137a8[_0x31ae12(0xc3)]);}async[a404_0x27137f(0x82)](_0x555dfb){const _0x5e31c4=a404_0x27137f,_0x487174=await this[_0x5e31c4(0xb4)](_0x555dfb),_0x3f9c0f=await this[_0x5e31c4(0xa4)](_0x487174),_0xdff356=await this[_0x5e31c4(0xc8)](_0x3f9c0f),_0x10189f=await this[_0x5e31c4(0x90)](_0xdff356['packageId']),_0x164dde=await this[_0x5e31c4(0xa4)](_0x10189f);return this[_0x5e31c4(0xc4)](_0x164dde,_0xdff356);}}exports['PackageImportService']=PackageImportService;