const a408_0x45e2f8=a408_0x4977;function a408_0x4977(_0x47fb49,_0x3d6865){const _0x447a47=a408_0x2b08();return a408_0x4977=function(_0x4208a5,_0x14e997){_0x4208a5=_0x4208a5-0x1e7;let _0x2b08ea=_0x447a47[_0x4208a5];return _0x2b08ea;},a408_0x4977(_0x47fb49,_0x3d6865);}(function(_0x5ab9c1,_0x5783a9){const _0x3b54d0=a408_0x4977,_0x357b8d=_0x5ab9c1();while(!![]){try{const _0x4a0917=-parseInt(_0x3b54d0(0x1f4))/0x1*(-parseInt(_0x3b54d0(0x20b))/0x2)+-parseInt(_0x3b54d0(0x1ff))/0x3+-parseInt(_0x3b54d0(0x1fd))/0x4+-parseInt(_0x3b54d0(0x221))/0x5+-parseInt(_0x3b54d0(0x205))/0x6+-parseInt(_0x3b54d0(0x212))/0x7+parseInt(_0x3b54d0(0x21d))/0x8*(parseInt(_0x3b54d0(0x21b))/0x9);if(_0x4a0917===_0x5783a9)break;else _0x357b8d['push'](_0x357b8d['shift']());}catch(_0x539674){_0x357b8d['push'](_0x357b8d['shift']());}}}(a408_0x2b08,0xb6e64));const a408_0x14e997=(function(){let _0x27ed67=!![];return function(_0x3ebae0,_0x37aaf4){const _0x1d9afe=_0x27ed67?function(){if(_0x37aaf4){const _0x174c3f=_0x37aaf4['apply'](_0x3ebae0,arguments);return _0x37aaf4=null,_0x174c3f;}}:function(){};return _0x27ed67=![],_0x1d9afe;};}()),a408_0x4208a5=a408_0x14e997(this,function(){const _0x2aaca2=a408_0x4977;return a408_0x4208a5[_0x2aaca2(0x223)]()[_0x2aaca2(0x200)](_0x2aaca2(0x208))['toString']()[_0x2aaca2(0x1f0)](a408_0x4208a5)[_0x2aaca2(0x200)](_0x2aaca2(0x208));});a408_0x4208a5();'use strict';Object[a408_0x45e2f8(0x1ea)](exports,'__esModule',{'value':!![]}),exports[a408_0x45e2f8(0x1fe)]=void 0x0;const utils_1=require(a408_0x45e2f8(0x1eb)),status_enums_1=require(a408_0x45e2f8(0x216)),veeva_error_1=require(a408_0x45e2f8(0x1f8)),veeva_constants_1=require(a408_0x45e2f8(0x20f));function a408_0x2b08(){const _0x3e0a99=['createVeevaObjectRecords','\x20records.','JOB_STATUS_TIMEOUT','ERRORS_ENCOUNTERED','521286jyjsZL','Creating\x20','DELETE_RECORDS_LIMIT','(((.+)+)+)+$','Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.','VeevaError','17038jvpfnL','get','Unknown\x20Job\x20status\x20:\x20\x27','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','../constants/veeva.constants','ENDPOINT_VQL','application/json','6767264VpWlKy','responseStatus','application/x-www-form-urlencoded','chunkArray','../enums/status.enums','delete','\x20records','SCHEDULED','QUEUED','117ngHgkr','executeVQL','2715256GQKBAl','RUNNING','MISSED_SCHEDULE','map','4969580kplePO','VeevaResponseStatus','toString','length','sleep','CREATE_RECORDS_LIMIT','defineProperty','../../shared/utils','SUCCESS','CANCELLED','post','executeManyVQL','constructor','data','Deleting\x20','_connection','53jITTSc','_logger','status','VeevaJobStatus','../classes/errors/veeva-error','push','errors','log','deleteVeevaObjectRecords','2996976nVVCHr','VeevaService','3953547knPcWE','search'];a408_0x2b08=function(){return _0x3e0a99;};return a408_0x2b08();}class VeevaService{constructor({connection:_0x238965,logger:_0x5b634a}){const _0x205fa0=a408_0x45e2f8;this[_0x205fa0(0x1f3)]=_0x238965,this[_0x205fa0(0x1f5)]=_0x5b634a;}async[a408_0x45e2f8(0x1ef)](_0x1eaf89){const _0x4ca783=a408_0x45e2f8,_0x1d73d0=[];for(const _0x302305 of _0x1eaf89){_0x1d73d0[_0x4ca783(0x1f9)](this[_0x4ca783(0x21c)](_0x302305));}const _0x5e9fab=await Promise['all'](_0x1d73d0);return _0x5e9fab['flat']();}async['executeVQL'](_0x52ff38){const _0x3f7eb1=a408_0x45e2f8,_0x3d7284=[];let _0x1ca0ce=this[_0x3f7eb1(0x1f3)][_0x3f7eb1(0x1ee)](veeva_constants_1['VeevaConstants'][_0x3f7eb1(0x210)],new URLSearchParams([['q',_0x52ff38]]),{'headers':{'Content-Type':_0x3f7eb1(0x214)}}),_0x2b7d89=![];do{const _0x52136e=await _0x1ca0ce,_0x455813=_0x52136e[_0x3f7eb1(0x1f1)];if(_0x455813['responseStatus']!==status_enums_1['VeevaResponseStatus'][_0x3f7eb1(0x1ec)])throw new veeva_error_1[(_0x3f7eb1(0x20a))](_0x455813[_0x3f7eb1(0x1fa)]);const {responseDetails:{next_page:_0x1ee6cc},data:_0x136468}=_0x455813;_0x1ee6cc?_0x1ca0ce=this[_0x3f7eb1(0x1f3)][_0x3f7eb1(0x20c)](_0x1ee6cc):_0x2b7d89=!![],_0x3d7284[_0x3f7eb1(0x1f9)](..._0x136468);}while(!_0x2b7d89);return _0x3d7284;}async[a408_0x45e2f8(0x201)](_0x47a1fa,_0x42f314){const _0x5c1673=a408_0x45e2f8,_0xf1c903=[],_0x1d4e16=(0x0,utils_1[_0x5c1673(0x215)])(_0x42f314,VeevaService[_0x5c1673(0x1e9)]),_0x3e2752=_0x42f314['length'];let _0x14632b=0x0;for(const _0x384061 of _0x1d4e16){_0x14632b+=_0x384061['length'],this['_logger'][_0x5c1673(0x1fb)](_0x5c1673(0x206)+_0x14632b+'/'+_0x3e2752+_0x5c1673(0x202));const _0x55c289=await this[_0x5c1673(0x1f3)][_0x5c1673(0x1ee)](_0x47a1fa,_0x384061),_0xe9e8aa=_0x55c289['data'];if(_0xe9e8aa[_0x5c1673(0x213)]===status_enums_1[_0x5c1673(0x222)][_0x5c1673(0x1ec)])for(const {responseStatus:_0xe39240,data:_0x55388c}of _0xe9e8aa[_0x5c1673(0x1f1)]){if(_0xe39240===status_enums_1[_0x5c1673(0x222)][_0x5c1673(0x1ec)])_0xf1c903[_0x5c1673(0x1f9)](_0x55388c['id']);else throw new veeva_error_1[(_0x5c1673(0x20a))](_0xe9e8aa[_0x5c1673(0x1fa)]);}else throw new veeva_error_1[(_0x5c1673(0x20a))](_0xe9e8aa[_0x5c1673(0x1fa)]);}return _0xf1c903;}async[a408_0x45e2f8(0x1fc)](_0x15fc81,_0x4216ba){const _0x190f94=a408_0x45e2f8,_0x32e8be=_0x4216ba[_0x190f94(0x220)](_0x13a7ce=>({'id':_0x13a7ce})),_0x1008d4=(0x0,utils_1[_0x190f94(0x215)])(_0x32e8be,VeevaService[_0x190f94(0x207)]);let _0x402f1b=0x0;for(const _0x131e6f of _0x1008d4){_0x402f1b+=_0x131e6f[_0x190f94(0x1e7)],this[_0x190f94(0x1f5)][_0x190f94(0x1fb)](_0x190f94(0x1f2)+_0x402f1b+'/'+_0x4216ba['length']+_0x190f94(0x218));const {data:_0x3928b8}=await this[_0x190f94(0x1f3)][_0x190f94(0x217)](_0x15fc81,{'headers':{'Content-Type':_0x190f94(0x211)},'data':_0x131e6f});if(_0x3928b8[_0x190f94(0x213)]===status_enums_1['VeevaResponseStatus'][_0x190f94(0x1ec)])for(const _0x5d135a of _0x3928b8[_0x190f94(0x1f1)]){const {responseStatus:_0x2a4d71,errors:_0x2d4f92}=_0x5d135a;if(_0x2a4d71!==status_enums_1['VeevaResponseStatus'][_0x190f94(0x1ec)])throw new veeva_error_1[(_0x190f94(0x20a))](_0x2d4f92);}else throw new veeva_error_1[(_0x190f94(0x20a))](_0x3928b8[_0x190f94(0x1fa)]);}}async['getJobResult'](_0x1506bc){const _0x444297=a408_0x45e2f8,_0x27b198=[];do{this[_0x444297(0x1f5)]['log'](_0x444297(0x209)),await(0x0,utils_1[_0x444297(0x1e8)])(VeevaService[_0x444297(0x203)]);const _0x21e49a=[];for(const _0x568cab of _0x1506bc){const {data:_0x5dee4d}=await this[_0x444297(0x1f3)]['get'](_0x568cab);if(_0x5dee4d['responseStatus']===status_enums_1[_0x444297(0x222)]['SUCCESS']){const {data:_0xfc758f}=_0x5dee4d;switch(_0xfc758f[_0x444297(0x1f6)]){case status_enums_1[_0x444297(0x1f7)][_0x444297(0x1ec)]:case status_enums_1['VeevaJobStatus'][_0x444297(0x204)]:_0x27b198[_0x444297(0x1f9)](_0xfc758f);break;case status_enums_1[_0x444297(0x1f7)]['QUEUEING']:case status_enums_1[_0x444297(0x1f7)][_0x444297(0x1ed)]:case status_enums_1[_0x444297(0x1f7)][_0x444297(0x21f)]:throw new Error(_0x444297(0x20e)+_0xfc758f[_0x444297(0x1f6)]);case status_enums_1['VeevaJobStatus'][_0x444297(0x21a)]:case status_enums_1[_0x444297(0x1f7)][_0x444297(0x21e)]:case status_enums_1[_0x444297(0x1f7)][_0x444297(0x219)]:_0x21e49a[_0x444297(0x1f9)](_0x568cab);break;default:throw new Error(_0x444297(0x20d)+_0xfc758f[_0x444297(0x1f6)]+'\x27');}}else throw new veeva_error_1['VeevaError'](_0x5dee4d[_0x444297(0x1fa)]);}_0x1506bc=_0x21e49a;}while(_0x1506bc[_0x444297(0x1e7)]);return _0x27b198;}}exports[a408_0x45e2f8(0x1fe)]=VeevaService,VeevaService['JOB_STATUS_TIMEOUT']=0x2710,VeevaService[a408_0x45e2f8(0x1e9)]=0x1f4,VeevaService[a408_0x45e2f8(0x207)]=0x1f4;