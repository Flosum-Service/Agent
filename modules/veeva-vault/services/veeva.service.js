const a379_0x549015=a379_0x2ecf;function a379_0x2ecf(_0x338a75,_0xd0086a){const _0x39031a=a379_0x2df7();return a379_0x2ecf=function(_0x648aae,_0x4ac081){_0x648aae=_0x648aae-0x193;let _0x2df739=_0x39031a[_0x648aae];return _0x2df739;},a379_0x2ecf(_0x338a75,_0xd0086a);}(function(_0x407238,_0x2208c1){const _0x3feb73=a379_0x2ecf,_0x2310ac=_0x407238();while(!![]){try{const _0x3ffb11=-parseInt(_0x3feb73(0x1c0))/0x1*(parseInt(_0x3feb73(0x1a1))/0x2)+-parseInt(_0x3feb73(0x1b5))/0x3+parseInt(_0x3feb73(0x1a0))/0x4*(-parseInt(_0x3feb73(0x1b6))/0x5)+parseInt(_0x3feb73(0x1c9))/0x6*(parseInt(_0x3feb73(0x196))/0x7)+-parseInt(_0x3feb73(0x1be))/0x8+parseInt(_0x3feb73(0x1cd))/0x9+parseInt(_0x3feb73(0x1ca))/0xa*(parseInt(_0x3feb73(0x194))/0xb);if(_0x3ffb11===_0x2208c1)break;else _0x2310ac['push'](_0x2310ac['shift']());}catch(_0x356797){_0x2310ac['push'](_0x2310ac['shift']());}}}(a379_0x2df7,0x27831));const a379_0x4ac081=(function(){let _0x5ec5f6=!![];return function(_0x10b2be,_0x4fb720){const _0x35c0ec=_0x5ec5f6?function(){const _0x39c598=a379_0x2ecf;if(_0x4fb720){const _0x31db7e=_0x4fb720[_0x39c598(0x1b3)](_0x10b2be,arguments);return _0x4fb720=null,_0x31db7e;}}:function(){};return _0x5ec5f6=![],_0x35c0ec;};}()),a379_0x648aae=a379_0x4ac081(this,function(){const _0x40c9f3=a379_0x2ecf;return a379_0x648aae[_0x40c9f3(0x1b9)]()['search']('(((.+)+)+)+$')['toString']()[_0x40c9f3(0x199)](a379_0x648aae)[_0x40c9f3(0x1c5)](_0x40c9f3(0x1c7));});a379_0x648aae();'use strict';function a379_0x2df7(){const _0x279e7=['VeevaService','length','chunkArray','\x20records','QUEUEING','../enums/status.enums','getJobResult','application/x-www-form-urlencoded','apply','ERRORS_ENCOUNTERED','270693CzuPbE','28055riVGzx','MISSED_SCHEDULE','VeevaResponseStatus','toString','VeevaConstants','JOB_STATUS_TIMEOUT','VeevaError','deleteVeevaObjectRecords','2012088JatURv','SUCCESS','112836kZOHUr','flat','QUEUED','_connection','executeManyVQL','search','_logger','(((.+)+)+)+$','DELETE_RECORDS_LIMIT','6SJgtTH','20ZjQkIp','Deleting\x20','defineProperty','240327HyAJKa','errors','responseStatus','ENDPOINT_VQL','map','1598003xQPMBN','Creating\x20','2133467MiMERg','Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.','RUNNING','constructor','createVeevaObjectRecords','executeVQL','Unknown\x20Job\x20status\x20:\x20\x27','status','SCHEDULED','all','4eHPZGJ','2jsXuEr','delete','push','log','VeevaJobStatus','CREATE_RECORDS_LIMIT','data','../constants/veeva.constants','application/json','post'];a379_0x2df7=function(){return _0x279e7;};return a379_0x2df7();}Object[a379_0x549015(0x1cc)](exports,'__esModule',{'value':!![]}),exports['VeevaService']=void 0x0;const utils_1=require('../../shared/utils'),status_enums_1=require(a379_0x549015(0x1b0)),veeva_error_1=require('../classes/errors/veeva-error'),veeva_constants_1=require(a379_0x549015(0x1a8));class VeevaService{constructor({connection:_0x38b1c7,logger:_0xcd19d7}){this['_connection']=_0x38b1c7,this['_logger']=_0xcd19d7;}async[a379_0x549015(0x1c4)](_0x4ed7ba){const _0x6c7e74=a379_0x549015,_0x50c423=[];for(const _0x52212e of _0x4ed7ba){_0x50c423[_0x6c7e74(0x1a3)](this[_0x6c7e74(0x19b)](_0x52212e));}const _0x55f71e=await Promise[_0x6c7e74(0x19f)](_0x50c423);return _0x55f71e[_0x6c7e74(0x1c1)]();}async[a379_0x549015(0x19b)](_0x4130de){const _0x58be11=a379_0x549015,_0x4779f5=[];let _0x9be0c7=this[_0x58be11(0x1c3)]['post'](veeva_constants_1[_0x58be11(0x1ba)][_0x58be11(0x1d0)],new URLSearchParams([['q',_0x4130de]]),{'headers':{'Content-Type':_0x58be11(0x1b2)}}),_0x5f19b2=![];do{const _0x3b063a=await _0x9be0c7,_0x3f0cf6=_0x3b063a[_0x58be11(0x1a7)];if(_0x3f0cf6[_0x58be11(0x1cf)]!==status_enums_1['VeevaResponseStatus']['SUCCESS'])throw new veeva_error_1[(_0x58be11(0x1bc))](_0x3f0cf6[_0x58be11(0x1ce)]);const {responseDetails:{next_page:_0x1121a2},data:_0x52690d}=_0x3f0cf6;_0x1121a2?_0x9be0c7=this['_connection']['get'](_0x1121a2):_0x5f19b2=!![],_0x4779f5['push'](..._0x52690d);}while(!_0x5f19b2);return _0x4779f5;}async[a379_0x549015(0x19a)](_0x4d370,_0x3a3b1f){const _0x2c853f=a379_0x549015,_0x2ba0e6=[],_0x598727=(0x0,utils_1[_0x2c853f(0x1ad)])(_0x3a3b1f,VeevaService['CREATE_RECORDS_LIMIT']),_0x5f0094=_0x3a3b1f[_0x2c853f(0x1ac)];let _0x51fd63=0x0;for(const _0x1048fd of _0x598727){_0x51fd63+=_0x1048fd[_0x2c853f(0x1ac)],this[_0x2c853f(0x1c6)]['log'](_0x2c853f(0x195)+_0x51fd63+'/'+_0x5f0094+'\x20records.');const _0xcc75f=await this[_0x2c853f(0x1c3)][_0x2c853f(0x1aa)](_0x4d370,_0x1048fd),_0x1730e2=_0xcc75f[_0x2c853f(0x1a7)];if(_0x1730e2['responseStatus']===status_enums_1[_0x2c853f(0x1b8)][_0x2c853f(0x1bf)])for(const {responseStatus:_0x5f3fc1,data:_0x10a8ae}of _0x1730e2['data']){if(_0x5f3fc1===status_enums_1[_0x2c853f(0x1b8)][_0x2c853f(0x1bf)])_0x2ba0e6['push'](_0x10a8ae['id']);else throw new veeva_error_1[(_0x2c853f(0x1bc))](_0x1730e2[_0x2c853f(0x1ce)]);}else throw new veeva_error_1[(_0x2c853f(0x1bc))](_0x1730e2[_0x2c853f(0x1ce)]);}return _0x2ba0e6;}async[a379_0x549015(0x1bd)](_0x139701,_0x55ae12){const _0x2f8131=a379_0x549015,_0x56be44=_0x55ae12[_0x2f8131(0x193)](_0x2f8e01=>({'id':_0x2f8e01})),_0x3ca631=(0x0,utils_1[_0x2f8131(0x1ad)])(_0x56be44,VeevaService[_0x2f8131(0x1c8)]);let _0x1143ad=0x0;for(const _0x57937e of _0x3ca631){_0x1143ad+=_0x57937e['length'],this[_0x2f8131(0x1c6)][_0x2f8131(0x1a4)](_0x2f8131(0x1cb)+_0x1143ad+'/'+_0x55ae12[_0x2f8131(0x1ac)]+_0x2f8131(0x1ae));const {data:_0x3187ca}=await this['_connection'][_0x2f8131(0x1a2)](_0x139701,{'headers':{'Content-Type':_0x2f8131(0x1a9)},'data':_0x57937e});if(_0x3187ca[_0x2f8131(0x1cf)]===status_enums_1[_0x2f8131(0x1b8)]['SUCCESS'])for(const _0xb4cf5c of _0x3187ca[_0x2f8131(0x1a7)]){const {responseStatus:_0x12f68,errors:_0x5799c4}=_0xb4cf5c;if(_0x12f68!==status_enums_1[_0x2f8131(0x1b8)][_0x2f8131(0x1bf)])throw new veeva_error_1[(_0x2f8131(0x1bc))](_0x5799c4);}else throw new veeva_error_1[(_0x2f8131(0x1bc))](_0x3187ca[_0x2f8131(0x1ce)]);}}async[a379_0x549015(0x1b1)](_0x58657b){const _0x5dd9dc=a379_0x549015,_0x13daea=[];do{this[_0x5dd9dc(0x1c6)][_0x5dd9dc(0x1a4)](_0x5dd9dc(0x197)),await(0x0,utils_1['sleep'])(VeevaService[_0x5dd9dc(0x1bb)]);const _0xa97116=[];for(const _0x472cff of _0x58657b){const {data:_0x26375d}=await this[_0x5dd9dc(0x1c3)]['get'](_0x472cff);if(_0x26375d[_0x5dd9dc(0x1cf)]===status_enums_1[_0x5dd9dc(0x1b8)][_0x5dd9dc(0x1bf)]){const {data:_0x4c1d1c}=_0x26375d;switch(_0x4c1d1c['status']){case status_enums_1['VeevaJobStatus'][_0x5dd9dc(0x1bf)]:case status_enums_1[_0x5dd9dc(0x1a5)][_0x5dd9dc(0x1b4)]:_0x13daea[_0x5dd9dc(0x1a3)](_0x4c1d1c);break;case status_enums_1[_0x5dd9dc(0x1a5)][_0x5dd9dc(0x1af)]:case status_enums_1[_0x5dd9dc(0x1a5)]['CANCELLED']:case status_enums_1[_0x5dd9dc(0x1a5)][_0x5dd9dc(0x1b7)]:throw new Error('Cannot\x20retrieve\x20job.\x20Job\x20status:\x20'+_0x4c1d1c[_0x5dd9dc(0x19d)]);case status_enums_1[_0x5dd9dc(0x1a5)][_0x5dd9dc(0x1c2)]:case status_enums_1['VeevaJobStatus'][_0x5dd9dc(0x198)]:case status_enums_1['VeevaJobStatus'][_0x5dd9dc(0x19e)]:_0xa97116['push'](_0x472cff);break;default:throw new Error(_0x5dd9dc(0x19c)+_0x4c1d1c[_0x5dd9dc(0x19d)]+'\x27');}}else throw new veeva_error_1[(_0x5dd9dc(0x1bc))](_0x26375d[_0x5dd9dc(0x1ce)]);}_0x58657b=_0xa97116;}while(_0x58657b[_0x5dd9dc(0x1ac)]);return _0x13daea;}}exports[a379_0x549015(0x1ab)]=VeevaService,VeevaService['JOB_STATUS_TIMEOUT']=0x2710,VeevaService[a379_0x549015(0x1a6)]=0x1f4,VeevaService['DELETE_RECORDS_LIMIT']=0x1f4;