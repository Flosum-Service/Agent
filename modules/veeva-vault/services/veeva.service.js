const a408_0x4636c6=a408_0x51f4;(function(_0x12f029,_0x57af6f){const _0xd20806=a408_0x51f4,_0x209a9c=_0x12f029();while(!![]){try{const _0x9da752=parseInt(_0xd20806(0xcd))/0x1*(parseInt(_0xd20806(0xbd))/0x2)+-parseInt(_0xd20806(0xca))/0x3+parseInt(_0xd20806(0xc0))/0x4+parseInt(_0xd20806(0xba))/0x5+parseInt(_0xd20806(0xac))/0x6*(-parseInt(_0xd20806(0xc7))/0x7)+parseInt(_0xd20806(0xbb))/0x8+parseInt(_0xd20806(0xc1))/0x9*(parseInt(_0xd20806(0xe0))/0xa);if(_0x9da752===_0x57af6f)break;else _0x209a9c['push'](_0x209a9c['shift']());}catch(_0x401ad4){_0x209a9c['push'](_0x209a9c['shift']());}}}(a408_0x25f0,0xd8045));function a408_0x25f0(){const _0x61d2f4=['createVeevaObjectRecords','QUEUED','_connection','status','8481350wcBDlp','\x20records.','Deleting\x20','\x20records','delete','defineProperty','SCHEDULED','1862772PiFkJV','post','data','deleteVeevaObjectRecords','push','apply','Unknown\x20Job\x20status\x20:\x20\x27','chunkArray','executeManyVQL','VeevaJobStatus','Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.','JOB_STATUS_TIMEOUT','responseStatus','Creating\x20','2214105ehouEk','7104592OscvIf','map','67178AZzeUs','QUEUEING','application/json','1778228GgwTVx','9PJtUGg','errors','executeVQL','_logger','DELETE_RECORDS_LIMIT','CREATE_RECORDS_LIMIT','7BdAweA','SUCCESS','VeevaConstants','4385727RxaeCr','VeevaService','VeevaResponseStatus','1QsLSlc','sleep','../../shared/utils','search','(((.+)+)+)+$','ENDPOINT_VQL','VeevaError','CANCELLED','get','toString','length','flat','log','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','constructor'];a408_0x25f0=function(){return _0x61d2f4;};return a408_0x25f0();}const a408_0x1f8175=(function(){let _0x3beb20=!![];return function(_0x5a8367,_0x238537){const _0x1863fa=_0x3beb20?function(){const _0x1bdd0a=a408_0x51f4;if(_0x238537){const _0x2c9c36=_0x238537[_0x1bdd0a(0xb1)](_0x5a8367,arguments);return _0x238537=null,_0x2c9c36;}}:function(){};return _0x3beb20=![],_0x1863fa;};}()),a408_0x5ebf10=a408_0x1f8175(this,function(){const _0x824290=a408_0x51f4;return a408_0x5ebf10[_0x824290(0xd6)]()[_0x824290(0xd0)](_0x824290(0xd1))[_0x824290(0xd6)]()[_0x824290(0xdb)](a408_0x5ebf10)[_0x824290(0xd0)]('(((.+)+)+)+$');});a408_0x5ebf10();'use strict';Object[a408_0x4636c6(0xaa)](exports,'__esModule',{'value':!![]}),exports[a408_0x4636c6(0xcb)]=void 0x0;const utils_1=require(a408_0x4636c6(0xcf)),status_enums_1=require('../enums/status.enums'),veeva_error_1=require('../classes/errors/veeva-error'),veeva_constants_1=require('../constants/veeva.constants');function a408_0x51f4(_0x1f2ce3,_0x57f3c3){const _0x4dba1d=a408_0x25f0();return a408_0x51f4=function(_0x5ebf10,_0x1f8175){_0x5ebf10=_0x5ebf10-0xa6;let _0x25f034=_0x4dba1d[_0x5ebf10];return _0x25f034;},a408_0x51f4(_0x1f2ce3,_0x57f3c3);}class VeevaService{constructor({connection:_0x1df30b,logger:_0x1452f7}){const _0x21f903=a408_0x4636c6;this[_0x21f903(0xde)]=_0x1df30b,this[_0x21f903(0xc4)]=_0x1452f7;}async[a408_0x4636c6(0xb4)](_0x4b576a){const _0x2ba4ad=a408_0x4636c6,_0x2f671a=[];for(const _0x186f30 of _0x4b576a){_0x2f671a[_0x2ba4ad(0xb0)](this[_0x2ba4ad(0xc3)](_0x186f30));}const _0x3372ca=await Promise['all'](_0x2f671a);return _0x3372ca[_0x2ba4ad(0xd8)]();}async['executeVQL'](_0x23a62c){const _0x98c0df=a408_0x4636c6,_0x3131ea=[];let _0x407b49=this[_0x98c0df(0xde)][_0x98c0df(0xad)](veeva_constants_1[_0x98c0df(0xc9)][_0x98c0df(0xd2)],new URLSearchParams([['q',_0x23a62c]]),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}}),_0x57469a=![];do{const _0x44daa0=await _0x407b49,_0x4f8f8a=_0x44daa0[_0x98c0df(0xae)];if(_0x4f8f8a[_0x98c0df(0xb8)]!==status_enums_1[_0x98c0df(0xcc)][_0x98c0df(0xc8)])throw new veeva_error_1[(_0x98c0df(0xd3))](_0x4f8f8a[_0x98c0df(0xc2)]);const {responseDetails:{next_page:_0x211a4a},data:_0x262935}=_0x4f8f8a;_0x211a4a?_0x407b49=this[_0x98c0df(0xde)][_0x98c0df(0xd5)](_0x211a4a):_0x57469a=!![],_0x3131ea[_0x98c0df(0xb0)](..._0x262935);}while(!_0x57469a);return _0x3131ea;}async[a408_0x4636c6(0xdc)](_0xd2a78c,_0x4bb2b8){const _0x1e6c1e=a408_0x4636c6,_0xbbc4ab=[],_0xaf4ad4=(0x0,utils_1[_0x1e6c1e(0xb3)])(_0x4bb2b8,VeevaService['CREATE_RECORDS_LIMIT']),_0x461e44=_0x4bb2b8[_0x1e6c1e(0xd7)];let _0x40ee0b=0x0;for(const _0x34e2e8 of _0xaf4ad4){_0x40ee0b+=_0x34e2e8['length'],this[_0x1e6c1e(0xc4)][_0x1e6c1e(0xd9)](_0x1e6c1e(0xb9)+_0x40ee0b+'/'+_0x461e44+_0x1e6c1e(0xa6));const _0x3aaca3=await this[_0x1e6c1e(0xde)][_0x1e6c1e(0xad)](_0xd2a78c,_0x34e2e8),_0x2915b2=_0x3aaca3[_0x1e6c1e(0xae)];if(_0x2915b2['responseStatus']===status_enums_1[_0x1e6c1e(0xcc)]['SUCCESS'])for(const {responseStatus:_0x598a5d,data:_0x254dbd}of _0x2915b2[_0x1e6c1e(0xae)]){if(_0x598a5d===status_enums_1[_0x1e6c1e(0xcc)]['SUCCESS'])_0xbbc4ab['push'](_0x254dbd['id']);else throw new veeva_error_1[(_0x1e6c1e(0xd3))](_0x2915b2[_0x1e6c1e(0xc2)]);}else throw new veeva_error_1[(_0x1e6c1e(0xd3))](_0x2915b2[_0x1e6c1e(0xc2)]);}return _0xbbc4ab;}async[a408_0x4636c6(0xaf)](_0x567f2f,_0x49db6b){const _0x2fb2b9=a408_0x4636c6,_0x2d6ed3=_0x49db6b[_0x2fb2b9(0xbc)](_0xc5b13e=>({'id':_0xc5b13e})),_0x304676=(0x0,utils_1[_0x2fb2b9(0xb3)])(_0x2d6ed3,VeevaService['DELETE_RECORDS_LIMIT']);let _0x10f15d=0x0;for(const _0xdee558 of _0x304676){_0x10f15d+=_0xdee558[_0x2fb2b9(0xd7)],this[_0x2fb2b9(0xc4)][_0x2fb2b9(0xd9)](_0x2fb2b9(0xa7)+_0x10f15d+'/'+_0x49db6b['length']+_0x2fb2b9(0xa8));const {data:_0x384c0a}=await this[_0x2fb2b9(0xde)][_0x2fb2b9(0xa9)](_0x567f2f,{'headers':{'Content-Type':_0x2fb2b9(0xbf)},'data':_0xdee558});if(_0x384c0a[_0x2fb2b9(0xb8)]===status_enums_1[_0x2fb2b9(0xcc)][_0x2fb2b9(0xc8)])for(const _0x4dfdc2 of _0x384c0a[_0x2fb2b9(0xae)]){const {responseStatus:_0xe6891b,errors:_0x4cedcc}=_0x4dfdc2;if(_0xe6891b!==status_enums_1[_0x2fb2b9(0xcc)][_0x2fb2b9(0xc8)])throw new veeva_error_1['VeevaError'](_0x4cedcc);}else throw new veeva_error_1[(_0x2fb2b9(0xd3))](_0x384c0a[_0x2fb2b9(0xc2)]);}}async['getJobResult'](_0x440ce4){const _0x9ee030=a408_0x4636c6,_0xb81c65=[];do{this[_0x9ee030(0xc4)][_0x9ee030(0xd9)](_0x9ee030(0xb6)),await(0x0,utils_1[_0x9ee030(0xce)])(VeevaService[_0x9ee030(0xb7)]);const _0x1c0d4f=[];for(const _0x31cb2c of _0x440ce4){const {data:_0x3c2b59}=await this[_0x9ee030(0xde)][_0x9ee030(0xd5)](_0x31cb2c);if(_0x3c2b59[_0x9ee030(0xb8)]===status_enums_1[_0x9ee030(0xcc)]['SUCCESS']){const {data:_0x1dba4f}=_0x3c2b59;switch(_0x1dba4f['status']){case status_enums_1[_0x9ee030(0xb5)][_0x9ee030(0xc8)]:case status_enums_1['VeevaJobStatus']['ERRORS_ENCOUNTERED']:_0xb81c65['push'](_0x1dba4f);break;case status_enums_1['VeevaJobStatus'][_0x9ee030(0xbe)]:case status_enums_1[_0x9ee030(0xb5)][_0x9ee030(0xd4)]:case status_enums_1[_0x9ee030(0xb5)]['MISSED_SCHEDULE']:throw new Error(_0x9ee030(0xda)+_0x1dba4f[_0x9ee030(0xdf)]);case status_enums_1[_0x9ee030(0xb5)][_0x9ee030(0xdd)]:case status_enums_1[_0x9ee030(0xb5)]['RUNNING']:case status_enums_1[_0x9ee030(0xb5)][_0x9ee030(0xab)]:_0x1c0d4f[_0x9ee030(0xb0)](_0x31cb2c);break;default:throw new Error(_0x9ee030(0xb2)+_0x1dba4f[_0x9ee030(0xdf)]+'\x27');}}else throw new veeva_error_1['VeevaError'](_0x3c2b59[_0x9ee030(0xc2)]);}_0x440ce4=_0x1c0d4f;}while(_0x440ce4[_0x9ee030(0xd7)]);return _0xb81c65;}}exports['VeevaService']=VeevaService,VeevaService[a408_0x4636c6(0xb7)]=0x2710,VeevaService[a408_0x4636c6(0xc6)]=0x1f4,VeevaService[a408_0x4636c6(0xc5)]=0x1f4;