const a356_0x36f3bb=a356_0x5959;(function(_0x2aa497,_0x226101){const _0x5000d7=a356_0x5959,_0x4d0c7c=_0x2aa497();while(!![]){try{const _0x24ec40=parseInt(_0x5000d7(0x8c))/0x1+-parseInt(_0x5000d7(0x95))/0x2*(-parseInt(_0x5000d7(0x88))/0x3)+-parseInt(_0x5000d7(0x6f))/0x4+-parseInt(_0x5000d7(0x7a))/0x5+parseInt(_0x5000d7(0x6a))/0x6+parseInt(_0x5000d7(0x71))/0x7*(parseInt(_0x5000d7(0x69))/0x8)+parseInt(_0x5000d7(0x7d))/0x9;if(_0x24ec40===_0x226101)break;else _0x4d0c7c['push'](_0x4d0c7c['shift']());}catch(_0x4d761a){_0x4d0c7c['push'](_0x4d0c7c['shift']());}}}(a356_0x130f,0x1a775));const a356_0x576873=(function(){let _0xfc75e1=!![];return function(_0x51ddfe,_0xdfafb8){const _0x455038=_0xfc75e1?function(){const _0x47b8a0=a356_0x5959;if(_0xdfafb8){const _0xb5ff18=_0xdfafb8[_0x47b8a0(0x67)](_0x51ddfe,arguments);return _0xdfafb8=null,_0xb5ff18;}}:function(){};return _0xfc75e1=![],_0x455038;};}()),a356_0xbeff12=a356_0x576873(this,function(){const _0x35ce67=a356_0x5959;return a356_0xbeff12[_0x35ce67(0x8b)]()[_0x35ce67(0x74)]('(((.+)+)+)+$')[_0x35ce67(0x8b)]()[_0x35ce67(0x78)](a356_0xbeff12)[_0x35ce67(0x74)](_0x35ce67(0x70));});a356_0xbeff12();'use strict';Object[a356_0x36f3bb(0x6e)](exports,'__esModule',{'value':!![]}),exports[a356_0x36f3bb(0x93)]=void 0x0;const utils_1=require('../../shared/utils'),status_enums_1=require('../enums/status.enums'),veeva_error_1=require(a356_0x36f3bb(0x72));class VeevaService{constructor({connection:_0x3f0e60,logger:_0x28b1fb}){const _0x43462f=a356_0x36f3bb;this[_0x43462f(0x92)]=_0x3f0e60,this[_0x43462f(0x73)]=_0x28b1fb;}async[a356_0x36f3bb(0x86)](_0x3b8dd0){const _0x7a8263=a356_0x36f3bb,_0x31c81d=[];for(const _0x147af6 of _0x3b8dd0){_0x31c81d[_0x7a8263(0x64)](this[_0x7a8263(0x77)](_0x147af6));}const _0x4bf94c=await Promise[_0x7a8263(0x6c)](_0x31c81d);return _0x4bf94c[_0x7a8263(0x7c)]();}async[a356_0x36f3bb(0x77)](_0x7f9b36){const _0x2f02ee=a356_0x36f3bb,_0x13d0af=[];do{const _0x2e1304=await this[_0x2f02ee(0x92)][_0x2f02ee(0x8a)](_0x7f9b36),_0xb53b90=_0x2e1304[_0x2f02ee(0x6b)];if(_0xb53b90['responseStatus']===status_enums_1[_0x2f02ee(0x8f)]['SUCCESS']){const {responseDetails:{next_page:_0x3d64db},data:_0x25a196}=_0xb53b90;_0x7f9b36=_0x3d64db||null,_0x13d0af['push'](..._0x25a196);}else throw new veeva_error_1['VeevaError'](_0xb53b90[_0x2f02ee(0x91)]);}while(_0x7f9b36);return _0x13d0af;}async[a356_0x36f3bb(0x7f)](_0x3fe671,_0x1abb4f){const _0x2b87c6=a356_0x36f3bb,_0x7f1fda=[],_0x1daedb=(0x0,utils_1['chunkArray'])(_0x1abb4f,VeevaService[_0x2b87c6(0x8e)]),_0x1e9457=_0x1abb4f[_0x2b87c6(0x75)];let _0x27fb71=0x0;for(const _0x362212 of _0x1daedb){_0x27fb71+=_0x362212[_0x2b87c6(0x75)],this['_logger'][_0x2b87c6(0x83)](_0x2b87c6(0x68)+_0x27fb71+'/'+_0x1e9457+_0x2b87c6(0x65));const _0x23bf11=await this['_connection'][_0x2b87c6(0x9b)](_0x3fe671,_0x362212),_0x2fd0df=_0x23bf11[_0x2b87c6(0x6b)];if(_0x2fd0df[_0x2b87c6(0x96)]===status_enums_1[_0x2b87c6(0x8f)][_0x2b87c6(0x82)])for(const {responseStatus:_0x5bc66c,data:_0x3281f6}of _0x2fd0df[_0x2b87c6(0x6b)]){if(_0x5bc66c===status_enums_1[_0x2b87c6(0x8f)][_0x2b87c6(0x82)])_0x7f1fda[_0x2b87c6(0x64)](_0x3281f6['id']);else throw new veeva_error_1[(_0x2b87c6(0x98))](_0x2fd0df[_0x2b87c6(0x91)]);}else throw new veeva_error_1['VeevaError'](_0x2fd0df[_0x2b87c6(0x91)]);}return _0x7f1fda;}async[a356_0x36f3bb(0x81)](_0x3e3a26,_0x39a1bb){const _0x4787b6=a356_0x36f3bb,_0x2a08f9=_0x39a1bb[_0x4787b6(0x94)](_0x4906f6=>({'id':_0x4906f6})),_0x31dd2e=(0x0,utils_1['chunkArray'])(_0x2a08f9,VeevaService[_0x4787b6(0x97)]);let _0x4b070a=0x0;for(const _0x3890b7 of _0x31dd2e){_0x4b070a+=_0x3890b7[_0x4787b6(0x75)],this[_0x4787b6(0x73)]['log'](_0x4787b6(0x85)+_0x4b070a+'/'+_0x39a1bb['length']+_0x4787b6(0x76));const {data:_0x5c0e06}=await this[_0x4787b6(0x92)][_0x4787b6(0x84)](_0x3e3a26,{'headers':{'Content-Type':'application/json'},'data':_0x3890b7});if(_0x5c0e06['responseStatus']===status_enums_1[_0x4787b6(0x8f)]['SUCCESS'])for(const _0x4663f5 of _0x5c0e06[_0x4787b6(0x6b)]){const {responseStatus:_0x3a00da,errors:_0x460a6c}=_0x4663f5;if(_0x3a00da!==status_enums_1[_0x4787b6(0x8f)][_0x4787b6(0x82)])throw new veeva_error_1['VeevaError'](_0x460a6c);}else throw new veeva_error_1[(_0x4787b6(0x98))](_0x5c0e06[_0x4787b6(0x91)]);}}async['getJobResult'](_0x464e59){const _0xb66f98=a356_0x36f3bb,_0x2dbe2b=[];do{this[_0xb66f98(0x73)][_0xb66f98(0x83)](_0xb66f98(0x66)),await(0x0,utils_1[_0xb66f98(0x6d)])(VeevaService[_0xb66f98(0x79)]);const _0x2f0926=[];for(const _0x11c32a of _0x464e59){const {data:_0x2b3af1}=await this[_0xb66f98(0x92)]['get'](_0x11c32a);if(_0x2b3af1[_0xb66f98(0x96)]===status_enums_1[_0xb66f98(0x8f)][_0xb66f98(0x82)]){const {data:_0x2353a2}=_0x2b3af1;switch(_0x2353a2['status']){case status_enums_1[_0xb66f98(0x9a)][_0xb66f98(0x82)]:case status_enums_1[_0xb66f98(0x9a)][_0xb66f98(0x80)]:_0x2dbe2b[_0xb66f98(0x64)](_0x2353a2);break;case status_enums_1[_0xb66f98(0x9a)]['QUEUEING']:case status_enums_1['VeevaJobStatus'][_0xb66f98(0x8d)]:case status_enums_1[_0xb66f98(0x9a)]['MISSED_SCHEDULE']:throw new Error(_0xb66f98(0x99)+_0x2353a2['status']);case status_enums_1[_0xb66f98(0x9a)][_0xb66f98(0x7e)]:case status_enums_1[_0xb66f98(0x9a)][_0xb66f98(0x87)]:case status_enums_1[_0xb66f98(0x9a)][_0xb66f98(0x89)]:_0x2f0926['push'](_0x11c32a);break;default:throw new Error(_0xb66f98(0x7b)+_0x2353a2[_0xb66f98(0x90)]+'\x27');}}else throw new veeva_error_1[(_0xb66f98(0x98))](_0x2b3af1['errors']);}_0x464e59=_0x2f0926;}while(_0x464e59[_0xb66f98(0x75)]);return _0x2dbe2b;}}function a356_0x5959(_0x4b856c,_0x6432b8){const _0xcaed0e=a356_0x130f();return a356_0x5959=function(_0xbeff12,_0x576873){_0xbeff12=_0xbeff12-0x64;let _0x130f5d=_0xcaed0e[_0xbeff12];return _0x130f5d;},a356_0x5959(_0x4b856c,_0x6432b8);}exports[a356_0x36f3bb(0x93)]=VeevaService,VeevaService['JOB_STATUS_TIMEOUT']=0x2710,VeevaService['CREATE_RECORDS_LIMIT']=0x1f4,VeevaService[a356_0x36f3bb(0x97)]=0x1f4;function a356_0x130f(){const _0x3b021b=['VeevaError','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','VeevaJobStatus','post','push','\x20records.','Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.','apply','Creating\x20','980456wqUNGl','322254oBUteG','data','all','sleep','defineProperty','664796CXjGSV','(((.+)+)+)+$','7uOmxHN','../classes/errors/veeva-error','_logger','search','length','\x20records','executeVQL','constructor','JOB_STATUS_TIMEOUT','940255ROdAzO','Unknown\x20Job\x20status\x20:\x20\x27','flat','1590030VDjKBq','QUEUED','createVeevaObjectRecords','ERRORS_ENCOUNTERED','deleteVeevaObjectRecords','SUCCESS','log','delete','Deleting\x20','executeManyVQL','RUNNING','3qWZRFR','SCHEDULED','get','toString','109252ZVARrf','CANCELLED','CREATE_RECORDS_LIMIT','VeevaResponseStatus','status','errors','_connection','VeevaService','map','934qxnEGl','responseStatus','DELETE_RECORDS_LIMIT'];a356_0x130f=function(){return _0x3b021b;};return a356_0x130f();}