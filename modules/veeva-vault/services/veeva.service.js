const a407_0x41771d=a407_0x494d;(function(_0x427512,_0x277a33){const _0x2e1745=a407_0x494d,_0x1a7274=_0x427512();while(!![]){try{const _0x25369d=parseInt(_0x2e1745(0x156))/0x1*(-parseInt(_0x2e1745(0x167))/0x2)+parseInt(_0x2e1745(0x16e))/0x3+parseInt(_0x2e1745(0x153))/0x4+parseInt(_0x2e1745(0x159))/0x5+parseInt(_0x2e1745(0x15e))/0x6+parseInt(_0x2e1745(0x162))/0x7*(parseInt(_0x2e1745(0x142))/0x8)+-parseInt(_0x2e1745(0x168))/0x9*(parseInt(_0x2e1745(0x158))/0xa);if(_0x25369d===_0x277a33)break;else _0x1a7274['push'](_0x1a7274['shift']());}catch(_0x41eae7){_0x1a7274['push'](_0x1a7274['shift']());}}}(a407_0x142c,0x74925));const a407_0x47adc2=(function(){let _0x2b4a36=!![];return function(_0x231b72,_0x130464){const _0x56469c=_0x2b4a36?function(){if(_0x130464){const _0xf98af4=_0x130464['apply'](_0x231b72,arguments);return _0x130464=null,_0xf98af4;}}:function(){};return _0x2b4a36=![],_0x56469c;};}()),a407_0x48c801=a407_0x47adc2(this,function(){const _0x1607e4=a407_0x494d;return a407_0x48c801['toString']()[_0x1607e4(0x154)](_0x1607e4(0x17a))[_0x1607e4(0x14a)]()[_0x1607e4(0x161)](a407_0x48c801)['search'](_0x1607e4(0x17a));});a407_0x48c801();'use strict';function a407_0x494d(_0x4f0ce5,_0x2cefdc){const _0x2ee6f9=a407_0x142c();return a407_0x494d=function(_0x48c801,_0x47adc2){_0x48c801=_0x48c801-0x142;let _0x142cd4=_0x2ee6f9[_0x48c801];return _0x142cd4;},a407_0x494d(_0x4f0ce5,_0x2cefdc);}Object[a407_0x41771d(0x15b)](exports,'__esModule',{'value':!![]}),exports['VeevaService']=void 0x0;const utils_1=require('../../shared/utils'),status_enums_1=require(a407_0x41771d(0x14b)),veeva_error_1=require('../classes/errors/veeva-error'),veeva_constants_1=require('../constants/veeva.constants');function a407_0x142c(){const _0x265fd6=['all','SUCCESS','ENDPOINT_VQL','responseStatus','data','delete','log','VeevaJobStatus','RUNNING','QUEUEING','(((.+)+)+)+$','_logger','Unknown\x20Job\x20status\x20:\x20\x27','24fplHBv','CANCELLED','Creating\x20','executeVQL','\x20records.','length','DELETE_RECORDS_LIMIT','Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.','toString','../enums/status.enums','map','getJobResult','deleteVeevaObjectRecords','VeevaResponseStatus','ERRORS_ENCOUNTERED','chunkArray','VeevaService','1483500wTcZMj','search','flat','93244KCZYlx','push','6420wSzzjd','4471745gFNMSV','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','defineProperty','VeevaError','CREATE_RECORDS_LIMIT','2898594hevkvS','application/json','\x20records','constructor','1067584OdfsnZ','_connection','QUEUED','post','application/x-www-form-urlencoded','2aaIYZT','24012GUbGyd','errors','MISSED_SCHEDULE','status','executeManyVQL','get','233154FabiSx','JOB_STATUS_TIMEOUT'];a407_0x142c=function(){return _0x265fd6;};return a407_0x142c();}class VeevaService{constructor({connection:_0x2daf73,logger:_0x23d42d}){const _0x22b817=a407_0x41771d;this[_0x22b817(0x163)]=_0x2daf73,this['_logger']=_0x23d42d;}async[a407_0x41771d(0x16c)](_0x37d6a6){const _0x951e68=a407_0x41771d,_0x472899=[];for(const _0x17c677 of _0x37d6a6){_0x472899['push'](this[_0x951e68(0x145)](_0x17c677));}const _0xc39760=await Promise[_0x951e68(0x170)](_0x472899);return _0xc39760[_0x951e68(0x155)]();}async[a407_0x41771d(0x145)](_0x4c995e){const _0x41f5ce=a407_0x41771d,_0x1ce733=[];let _0x584f98=this['_connection']['post'](veeva_constants_1['VeevaConstants'][_0x41f5ce(0x172)],new URLSearchParams([['q',_0x4c995e]]),{'headers':{'Content-Type':_0x41f5ce(0x166)}}),_0x2faea6=![];do{const _0x140658=await _0x584f98,_0x59cad3=_0x140658[_0x41f5ce(0x174)];if(_0x59cad3[_0x41f5ce(0x173)]!==status_enums_1[_0x41f5ce(0x14f)][_0x41f5ce(0x171)])throw new veeva_error_1[(_0x41f5ce(0x15c))](_0x59cad3[_0x41f5ce(0x169)]);const {responseDetails:{next_page:_0x3f3231},data:_0x558338}=_0x59cad3;_0x3f3231?_0x584f98=this[_0x41f5ce(0x163)]['get'](_0x3f3231):_0x2faea6=!![],_0x1ce733[_0x41f5ce(0x157)](..._0x558338);}while(!_0x2faea6);return _0x1ce733;}async['createVeevaObjectRecords'](_0x4bd97f,_0x181ecf){const _0x53dfe9=a407_0x41771d,_0x3893ea=[],_0x2beb32=(0x0,utils_1['chunkArray'])(_0x181ecf,VeevaService[_0x53dfe9(0x15d)]),_0x123fb1=_0x181ecf[_0x53dfe9(0x147)];let _0x618bdc=0x0;for(const _0x4b768c of _0x2beb32){_0x618bdc+=_0x4b768c[_0x53dfe9(0x147)],this[_0x53dfe9(0x17b)]['log'](_0x53dfe9(0x144)+_0x618bdc+'/'+_0x123fb1+_0x53dfe9(0x146));const _0x3b64cb=await this[_0x53dfe9(0x163)][_0x53dfe9(0x165)](_0x4bd97f,_0x4b768c),_0x3dcae1=_0x3b64cb[_0x53dfe9(0x174)];if(_0x3dcae1[_0x53dfe9(0x173)]===status_enums_1[_0x53dfe9(0x14f)][_0x53dfe9(0x171)])for(const {responseStatus:_0x5e534d,data:_0x133756}of _0x3dcae1['data']){if(_0x5e534d===status_enums_1['VeevaResponseStatus'][_0x53dfe9(0x171)])_0x3893ea['push'](_0x133756['id']);else throw new veeva_error_1[(_0x53dfe9(0x15c))](_0x3dcae1[_0x53dfe9(0x169)]);}else throw new veeva_error_1['VeevaError'](_0x3dcae1[_0x53dfe9(0x169)]);}return _0x3893ea;}async[a407_0x41771d(0x14e)](_0x15d000,_0x1eee9d){const _0x2e58d0=a407_0x41771d,_0x32f326=_0x1eee9d[_0x2e58d0(0x14c)](_0x3afcec=>({'id':_0x3afcec})),_0x359a31=(0x0,utils_1[_0x2e58d0(0x151)])(_0x32f326,VeevaService['DELETE_RECORDS_LIMIT']);let _0xa131a6=0x0;for(const _0x4af002 of _0x359a31){_0xa131a6+=_0x4af002[_0x2e58d0(0x147)],this[_0x2e58d0(0x17b)][_0x2e58d0(0x176)]('Deleting\x20'+_0xa131a6+'/'+_0x1eee9d[_0x2e58d0(0x147)]+_0x2e58d0(0x160));const {data:_0x4ce962}=await this[_0x2e58d0(0x163)][_0x2e58d0(0x175)](_0x15d000,{'headers':{'Content-Type':_0x2e58d0(0x15f)},'data':_0x4af002});if(_0x4ce962[_0x2e58d0(0x173)]===status_enums_1[_0x2e58d0(0x14f)][_0x2e58d0(0x171)])for(const _0xf0505b of _0x4ce962[_0x2e58d0(0x174)]){const {responseStatus:_0x25057f,errors:_0x35609e}=_0xf0505b;if(_0x25057f!==status_enums_1[_0x2e58d0(0x14f)][_0x2e58d0(0x171)])throw new veeva_error_1[(_0x2e58d0(0x15c))](_0x35609e);}else throw new veeva_error_1[(_0x2e58d0(0x15c))](_0x4ce962[_0x2e58d0(0x169)]);}}async[a407_0x41771d(0x14d)](_0x326dee){const _0xe6b52e=a407_0x41771d,_0x3a72ce=[];do{this[_0xe6b52e(0x17b)][_0xe6b52e(0x176)](_0xe6b52e(0x149)),await(0x0,utils_1['sleep'])(VeevaService[_0xe6b52e(0x16f)]);const _0x1fecc2=[];for(const _0x38c1e6 of _0x326dee){const {data:_0x41a132}=await this['_connection'][_0xe6b52e(0x16d)](_0x38c1e6);if(_0x41a132[_0xe6b52e(0x173)]===status_enums_1[_0xe6b52e(0x14f)][_0xe6b52e(0x171)]){const {data:_0x5b1d8e}=_0x41a132;switch(_0x5b1d8e[_0xe6b52e(0x16b)]){case status_enums_1[_0xe6b52e(0x177)][_0xe6b52e(0x171)]:case status_enums_1[_0xe6b52e(0x177)][_0xe6b52e(0x150)]:_0x3a72ce[_0xe6b52e(0x157)](_0x5b1d8e);break;case status_enums_1[_0xe6b52e(0x177)][_0xe6b52e(0x179)]:case status_enums_1['VeevaJobStatus'][_0xe6b52e(0x143)]:case status_enums_1[_0xe6b52e(0x177)][_0xe6b52e(0x16a)]:throw new Error(_0xe6b52e(0x15a)+_0x5b1d8e[_0xe6b52e(0x16b)]);case status_enums_1['VeevaJobStatus'][_0xe6b52e(0x164)]:case status_enums_1[_0xe6b52e(0x177)][_0xe6b52e(0x178)]:case status_enums_1[_0xe6b52e(0x177)]['SCHEDULED']:_0x1fecc2[_0xe6b52e(0x157)](_0x38c1e6);break;default:throw new Error(_0xe6b52e(0x17c)+_0x5b1d8e[_0xe6b52e(0x16b)]+'\x27');}}else throw new veeva_error_1[(_0xe6b52e(0x15c))](_0x41a132[_0xe6b52e(0x169)]);}_0x326dee=_0x1fecc2;}while(_0x326dee[_0xe6b52e(0x147)]);return _0x3a72ce;}}exports[a407_0x41771d(0x152)]=VeevaService,VeevaService[a407_0x41771d(0x16f)]=0x2710,VeevaService[a407_0x41771d(0x15d)]=0x1f4,VeevaService[a407_0x41771d(0x148)]=0x1f4;