const a395_0x40eeee=a395_0x2f82;(function(_0x1eb5fa,_0x5420c4){const _0x577702=a395_0x2f82,_0x1c5807=_0x1eb5fa();while(!![]){try{const _0x1e5a59=parseInt(_0x577702(0x1a2))/0x1+parseInt(_0x577702(0x1ab))/0x2+-parseInt(_0x577702(0x1a6))/0x3+-parseInt(_0x577702(0x191))/0x4+-parseInt(_0x577702(0x19a))/0x5+parseInt(_0x577702(0x18e))/0x6+-parseInt(_0x577702(0x1a5))/0x7*(-parseInt(_0x577702(0x18f))/0x8);if(_0x1e5a59===_0x5420c4)break;else _0x1c5807['push'](_0x1c5807['shift']());}catch(_0xdbe356){_0x1c5807['push'](_0x1c5807['shift']());}}}(a395_0x43c1,0x3c52d));const a395_0x3ab4a5=(function(){let _0xdb15e0=!![];return function(_0x416a20,_0x217f28){const _0x1a81ad=_0xdb15e0?function(){const _0x5d6cae=a395_0x2f82;if(_0x217f28){const _0x375596=_0x217f28[_0x5d6cae(0x185)](_0x416a20,arguments);return _0x217f28=null,_0x375596;}}:function(){};return _0xdb15e0=![],_0x1a81ad;};}()),a395_0x424d94=a395_0x3ab4a5(this,function(){const _0xccf305=a395_0x2f82;return a395_0x424d94[_0xccf305(0x182)]()[_0xccf305(0x1b3)](_0xccf305(0x188))['toString']()[_0xccf305(0x1b2)](a395_0x424d94)[_0xccf305(0x1b3)](_0xccf305(0x188));});a395_0x424d94();'use strict';Object[a395_0x40eeee(0x183)](exports,a395_0x40eeee(0x1a4),{'value':!![]}),exports[a395_0x40eeee(0x197)]=void 0x0;const utils_1=require('../../shared/utils'),status_enums_1=require('../enums/status.enums'),veeva_error_1=require(a395_0x40eeee(0x19f)),veeva_constants_1=require('../constants/veeva.constants');class VeevaService{constructor({connection:_0x31ffc9,logger:_0x47f0be}){const _0x32d6b8=a395_0x40eeee;this[_0x32d6b8(0x1b1)]=_0x31ffc9,this[_0x32d6b8(0x1a8)]=_0x47f0be;}async[a395_0x40eeee(0x1b7)](_0x2f1e89){const _0x2d74e8=a395_0x40eeee,_0x1cb9b7=[];for(const _0x188034 of _0x2f1e89){_0x1cb9b7[_0x2d74e8(0x194)](this[_0x2d74e8(0x196)](_0x188034));}const _0x2a84f5=await Promise[_0x2d74e8(0x19c)](_0x1cb9b7);return _0x2a84f5[_0x2d74e8(0x199)]();}async['executeVQL'](_0x505705){const _0x15388e=a395_0x40eeee,_0x15de86=[];let _0x5f5064=this[_0x15388e(0x1b1)]['post'](veeva_constants_1[_0x15388e(0x1b6)][_0x15388e(0x18c)],new URLSearchParams([['q',_0x505705]]),{'headers':{'Content-Type':_0x15388e(0x1b5)}}),_0x53f7c6=![];do{const _0x1a9623=await _0x5f5064,_0x1ef435=_0x1a9623[_0x15388e(0x18b)];if(_0x1ef435[_0x15388e(0x1b4)]!==status_enums_1['VeevaResponseStatus'][_0x15388e(0x1ac)])throw new veeva_error_1['VeevaError'](_0x1ef435['errors']);const {responseDetails:{next_page:_0x17793c},data:_0x11b21c}=_0x1ef435;_0x17793c?_0x5f5064=this[_0x15388e(0x1b1)][_0x15388e(0x195)](_0x17793c):_0x53f7c6=!![],_0x15de86[_0x15388e(0x194)](..._0x11b21c);}while(!_0x53f7c6);return _0x15de86;}async[a395_0x40eeee(0x1a1)](_0x23f6ea,_0x49850f){const _0x103936=a395_0x40eeee,_0x1c0cc6=[],_0x56e82a=(0x0,utils_1[_0x103936(0x193)])(_0x49850f,VeevaService['CREATE_RECORDS_LIMIT']),_0x5a9139=_0x49850f[_0x103936(0x189)];let _0x227d28=0x0;for(const _0x192e1a of _0x56e82a){_0x227d28+=_0x192e1a[_0x103936(0x189)],this['_logger'][_0x103936(0x1b0)]('Creating\x20'+_0x227d28+'/'+_0x5a9139+_0x103936(0x18a));const _0x7e7de0=await this[_0x103936(0x1b1)]['post'](_0x23f6ea,_0x192e1a),_0x2c1030=_0x7e7de0[_0x103936(0x18b)];if(_0x2c1030[_0x103936(0x1b4)]===status_enums_1[_0x103936(0x181)][_0x103936(0x1ac)])for(const {responseStatus:_0x4ec2bf,data:_0x131a74}of _0x2c1030[_0x103936(0x18b)]){if(_0x4ec2bf===status_enums_1['VeevaResponseStatus'][_0x103936(0x1ac)])_0x1c0cc6[_0x103936(0x194)](_0x131a74['id']);else throw new veeva_error_1[(_0x103936(0x19e))](_0x2c1030[_0x103936(0x1ad)]);}else throw new veeva_error_1[(_0x103936(0x19e))](_0x2c1030['errors']);}return _0x1c0cc6;}async[a395_0x40eeee(0x1a0)](_0x463eb6,_0x52a8b8){const _0x434157=a395_0x40eeee,_0x19f5fc=_0x52a8b8[_0x434157(0x1ae)](_0x216509=>({'id':_0x216509})),_0x3be63c=(0x0,utils_1['chunkArray'])(_0x19f5fc,VeevaService[_0x434157(0x1a9)]);let _0x5944f5=0x0;for(const _0x3c406d of _0x3be63c){_0x5944f5+=_0x3c406d['length'],this[_0x434157(0x1a8)][_0x434157(0x1b0)](_0x434157(0x19b)+_0x5944f5+'/'+_0x52a8b8['length']+'\x20records');const {data:_0x2d4e1b}=await this['_connection']['delete'](_0x463eb6,{'headers':{'Content-Type':_0x434157(0x1af)},'data':_0x3c406d});if(_0x2d4e1b[_0x434157(0x1b4)]===status_enums_1[_0x434157(0x181)]['SUCCESS'])for(const _0x5af4a4 of _0x2d4e1b[_0x434157(0x18b)]){const {responseStatus:_0x1f20f8,errors:_0x564546}=_0x5af4a4;if(_0x1f20f8!==status_enums_1['VeevaResponseStatus'][_0x434157(0x1ac)])throw new veeva_error_1['VeevaError'](_0x564546);}else throw new veeva_error_1[(_0x434157(0x19e))](_0x2d4e1b[_0x434157(0x1ad)]);}}async['getJobResult'](_0x54c2f4){const _0xd74981=a395_0x40eeee,_0x31167a=[];do{this[_0xd74981(0x1a8)][_0xd74981(0x1b0)]('Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.'),await(0x0,utils_1[_0xd74981(0x184)])(VeevaService[_0xd74981(0x198)]);const _0x11e2a6=[];for(const _0x598f57 of _0x54c2f4){const {data:_0x93b542}=await this[_0xd74981(0x1b1)][_0xd74981(0x195)](_0x598f57);if(_0x93b542['responseStatus']===status_enums_1[_0xd74981(0x181)]['SUCCESS']){const {data:_0x43eb93}=_0x93b542;switch(_0x43eb93[_0xd74981(0x1a7)]){case status_enums_1['VeevaJobStatus']['SUCCESS']:case status_enums_1[_0xd74981(0x19d)]['ERRORS_ENCOUNTERED']:_0x31167a['push'](_0x43eb93);break;case status_enums_1[_0xd74981(0x19d)][_0xd74981(0x1aa)]:case status_enums_1[_0xd74981(0x19d)][_0xd74981(0x18d)]:case status_enums_1[_0xd74981(0x19d)][_0xd74981(0x192)]:throw new Error(_0xd74981(0x1a3)+_0x43eb93[_0xd74981(0x1a7)]);case status_enums_1[_0xd74981(0x19d)][_0xd74981(0x190)]:case status_enums_1[_0xd74981(0x19d)]['RUNNING']:case status_enums_1[_0xd74981(0x19d)][_0xd74981(0x186)]:_0x11e2a6[_0xd74981(0x194)](_0x598f57);break;default:throw new Error(_0xd74981(0x187)+_0x43eb93['status']+'\x27');}}else throw new veeva_error_1['VeevaError'](_0x93b542['errors']);}_0x54c2f4=_0x11e2a6;}while(_0x54c2f4[_0xd74981(0x189)]);return _0x31167a;}}exports['VeevaService']=VeevaService,VeevaService[a395_0x40eeee(0x198)]=0x2710,VeevaService['CREATE_RECORDS_LIMIT']=0x1f4,VeevaService[a395_0x40eeee(0x1a9)]=0x1f4;function a395_0x2f82(_0x1d66ea,_0x3c3adf){const _0x1f0327=a395_0x43c1();return a395_0x2f82=function(_0x424d94,_0x3ab4a5){_0x424d94=_0x424d94-0x181;let _0x43c102=_0x1f0327[_0x424d94];return _0x43c102;},a395_0x2f82(_0x1d66ea,_0x3c3adf);}function a395_0x43c1(){const _0x28692c=['search','responseStatus','application/x-www-form-urlencoded','VeevaConstants','executeManyVQL','VeevaResponseStatus','toString','defineProperty','sleep','apply','SCHEDULED','Unknown\x20Job\x20status\x20:\x20\x27','(((.+)+)+)+$','length','\x20records.','data','ENDPOINT_VQL','CANCELLED','2942634pHzkyo','152iysCUf','QUEUED','550984uhKdjb','MISSED_SCHEDULE','chunkArray','push','get','executeVQL','VeevaService','JOB_STATUS_TIMEOUT','flat','590055BvRrxw','Deleting\x20','all','VeevaJobStatus','VeevaError','../classes/errors/veeva-error','deleteVeevaObjectRecords','createVeevaObjectRecords','158093LUyPgz','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','__esModule','20853EcpjeR','929958uWtUZT','status','_logger','DELETE_RECORDS_LIMIT','QUEUEING','215390GNbWMk','SUCCESS','errors','map','application/json','log','_connection','constructor'];a395_0x43c1=function(){return _0x28692c;};return a395_0x43c1();}