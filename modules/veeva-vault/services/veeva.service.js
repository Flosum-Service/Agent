const a407_0x6fb864=a407_0x43c8;(function(_0x1f7be2,_0x3b108d){const _0x598dbf=a407_0x43c8,_0x509f9a=_0x1f7be2();while(!![]){try{const _0xdfe329=-parseInt(_0x598dbf(0x6d))/0x1+parseInt(_0x598dbf(0x8b))/0x2+parseInt(_0x598dbf(0x97))/0x3+parseInt(_0x598dbf(0x79))/0x4+parseInt(_0x598dbf(0x95))/0x5+-parseInt(_0x598dbf(0x88))/0x6+parseInt(_0x598dbf(0x9c))/0x7*(parseInt(_0x598dbf(0x89))/0x8);if(_0xdfe329===_0x3b108d)break;else _0x509f9a['push'](_0x509f9a['shift']());}catch(_0x51345c){_0x509f9a['push'](_0x509f9a['shift']());}}}(a407_0x9c2e,0xa6b57));const a407_0x4e66f7=(function(){let _0x562115=!![];return function(_0x1aacc4,_0x4ecde2){const _0x4d4f56=_0x562115?function(){const _0x2c75c7=a407_0x43c8;if(_0x4ecde2){const _0x3de8ae=_0x4ecde2[_0x2c75c7(0x8c)](_0x1aacc4,arguments);return _0x4ecde2=null,_0x3de8ae;}}:function(){};return _0x562115=![],_0x4d4f56;};}()),a407_0x56268e=a407_0x4e66f7(this,function(){const _0x3c5b5e=a407_0x43c8;return a407_0x56268e['toString']()[_0x3c5b5e(0x7e)](_0x3c5b5e(0x8e))['toString']()[_0x3c5b5e(0x98)](a407_0x56268e)[_0x3c5b5e(0x7e)](_0x3c5b5e(0x8e));});a407_0x56268e();'use strict';Object['defineProperty'](exports,a407_0x6fb864(0x9d),{'value':!![]}),exports[a407_0x6fb864(0x8a)]=void 0x0;const utils_1=require('../../shared/utils'),status_enums_1=require(a407_0x6fb864(0x7f)),veeva_error_1=require(a407_0x6fb864(0x77)),veeva_constants_1=require(a407_0x6fb864(0xa5));function a407_0x9c2e(){const _0x6ba742=['303184ytGrJs','apply','log','(((.+)+)+)+$','\x20records','RUNNING','delete','all','push','flat','5284070KLagMe','map','908814PWsSQC','constructor','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','QUEUEING','application/x-www-form-urlencoded','1659PIPnZn','__esModule','_logger','data','DELETE_RECORDS_LIMIT','SUCCESS','sleep','Creating\x20','post','../constants/veeva.constants','Deleting\x20','912331UqObMP','\x20records.','Unknown\x20Job\x20status\x20:\x20\x27','CREATE_RECORDS_LIMIT','status','VeevaJobStatus','JOB_STATUS_TIMEOUT','CANCELLED','VeevaError','executeVQL','../classes/errors/veeva-error','VeevaConstants','2991456zBReUS','SCHEDULED','_connection','executeManyVQL','createVeevaObjectRecords','search','../enums/status.enums','length','responseStatus','VeevaResponseStatus','ENDPOINT_VQL','get','getJobResult','chunkArray','errors','4096566SPFnfN','632ZsGECR','VeevaService'];a407_0x9c2e=function(){return _0x6ba742;};return a407_0x9c2e();}function a407_0x43c8(_0xb601eb,_0x55afd){const _0x4f44fe=a407_0x9c2e();return a407_0x43c8=function(_0x56268e,_0x4e66f7){_0x56268e=_0x56268e-0x6c;let _0x9c2e07=_0x4f44fe[_0x56268e];return _0x9c2e07;},a407_0x43c8(_0xb601eb,_0x55afd);}class VeevaService{constructor({connection:_0x3e5b67,logger:_0x434911}){const _0x420735=a407_0x6fb864;this[_0x420735(0x7b)]=_0x3e5b67,this[_0x420735(0x9e)]=_0x434911;}async[a407_0x6fb864(0x7c)](_0x35afd8){const _0x153e08=a407_0x6fb864,_0x46fc58=[];for(const _0x1d8ce7 of _0x35afd8){_0x46fc58[_0x153e08(0x93)](this[_0x153e08(0x76)](_0x1d8ce7));}const _0xe7dfb7=await Promise[_0x153e08(0x92)](_0x46fc58);return _0xe7dfb7[_0x153e08(0x94)]();}async['executeVQL'](_0x276f3a){const _0x36098f=a407_0x6fb864,_0x318481=[];let _0x1b090a=this[_0x36098f(0x7b)][_0x36098f(0xa4)](veeva_constants_1[_0x36098f(0x78)][_0x36098f(0x83)],new URLSearchParams([['q',_0x276f3a]]),{'headers':{'Content-Type':_0x36098f(0x9b)}}),_0x28e157=![];do{const _0x1d37e2=await _0x1b090a,_0x17af41=_0x1d37e2[_0x36098f(0x9f)];if(_0x17af41['responseStatus']!==status_enums_1[_0x36098f(0x82)]['SUCCESS'])throw new veeva_error_1[(_0x36098f(0x75))](_0x17af41[_0x36098f(0x87)]);const {responseDetails:{next_page:_0x7c0997},data:_0x5c15a6}=_0x17af41;_0x7c0997?_0x1b090a=this['_connection'][_0x36098f(0x84)](_0x7c0997):_0x28e157=!![],_0x318481[_0x36098f(0x93)](..._0x5c15a6);}while(!_0x28e157);return _0x318481;}async[a407_0x6fb864(0x7d)](_0xedea99,_0x17da10){const _0x3f56a9=a407_0x6fb864,_0x393cd6=[],_0x8eee8f=(0x0,utils_1[_0x3f56a9(0x86)])(_0x17da10,VeevaService[_0x3f56a9(0x70)]),_0x334f6=_0x17da10[_0x3f56a9(0x80)];let _0x34d2c2=0x0;for(const _0x36d9b9 of _0x8eee8f){_0x34d2c2+=_0x36d9b9['length'],this[_0x3f56a9(0x9e)]['log'](_0x3f56a9(0xa3)+_0x34d2c2+'/'+_0x334f6+_0x3f56a9(0x6e));const _0x3ebf93=await this[_0x3f56a9(0x7b)][_0x3f56a9(0xa4)](_0xedea99,_0x36d9b9),_0x67e08d=_0x3ebf93[_0x3f56a9(0x9f)];if(_0x67e08d[_0x3f56a9(0x81)]===status_enums_1['VeevaResponseStatus'][_0x3f56a9(0xa1)])for(const {responseStatus:_0x33a1fc,data:_0x3ee3fc}of _0x67e08d[_0x3f56a9(0x9f)]){if(_0x33a1fc===status_enums_1[_0x3f56a9(0x82)]['SUCCESS'])_0x393cd6[_0x3f56a9(0x93)](_0x3ee3fc['id']);else throw new veeva_error_1['VeevaError'](_0x67e08d[_0x3f56a9(0x87)]);}else throw new veeva_error_1[(_0x3f56a9(0x75))](_0x67e08d[_0x3f56a9(0x87)]);}return _0x393cd6;}async['deleteVeevaObjectRecords'](_0x5e8e91,_0x837687){const _0x2e9e83=a407_0x6fb864,_0x4f1267=_0x837687[_0x2e9e83(0x96)](_0x4521ce=>({'id':_0x4521ce})),_0x2e6eee=(0x0,utils_1[_0x2e9e83(0x86)])(_0x4f1267,VeevaService[_0x2e9e83(0xa0)]);let _0x3f1fe1=0x0;for(const _0x719529 of _0x2e6eee){_0x3f1fe1+=_0x719529['length'],this[_0x2e9e83(0x9e)][_0x2e9e83(0x8d)](_0x2e9e83(0x6c)+_0x3f1fe1+'/'+_0x837687[_0x2e9e83(0x80)]+_0x2e9e83(0x8f));const {data:_0x356c2e}=await this[_0x2e9e83(0x7b)][_0x2e9e83(0x91)](_0x5e8e91,{'headers':{'Content-Type':'application/json'},'data':_0x719529});if(_0x356c2e[_0x2e9e83(0x81)]===status_enums_1[_0x2e9e83(0x82)][_0x2e9e83(0xa1)])for(const _0x49fa6d of _0x356c2e['data']){const {responseStatus:_0x2905d9,errors:_0x2e3d67}=_0x49fa6d;if(_0x2905d9!==status_enums_1['VeevaResponseStatus']['SUCCESS'])throw new veeva_error_1[(_0x2e9e83(0x75))](_0x2e3d67);}else throw new veeva_error_1[(_0x2e9e83(0x75))](_0x356c2e['errors']);}}async[a407_0x6fb864(0x85)](_0x8c6ad4){const _0x3df7de=a407_0x6fb864,_0x5194a8=[];do{this[_0x3df7de(0x9e)][_0x3df7de(0x8d)]('Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.'),await(0x0,utils_1[_0x3df7de(0xa2)])(VeevaService['JOB_STATUS_TIMEOUT']);const _0x3e171a=[];for(const _0x14a25e of _0x8c6ad4){const {data:_0x4fd661}=await this[_0x3df7de(0x7b)]['get'](_0x14a25e);if(_0x4fd661[_0x3df7de(0x81)]===status_enums_1[_0x3df7de(0x82)][_0x3df7de(0xa1)]){const {data:_0x257173}=_0x4fd661;switch(_0x257173['status']){case status_enums_1['VeevaJobStatus'][_0x3df7de(0xa1)]:case status_enums_1['VeevaJobStatus']['ERRORS_ENCOUNTERED']:_0x5194a8[_0x3df7de(0x93)](_0x257173);break;case status_enums_1[_0x3df7de(0x72)][_0x3df7de(0x9a)]:case status_enums_1[_0x3df7de(0x72)][_0x3df7de(0x74)]:case status_enums_1[_0x3df7de(0x72)]['MISSED_SCHEDULE']:throw new Error(_0x3df7de(0x99)+_0x257173['status']);case status_enums_1[_0x3df7de(0x72)]['QUEUED']:case status_enums_1['VeevaJobStatus'][_0x3df7de(0x90)]:case status_enums_1['VeevaJobStatus'][_0x3df7de(0x7a)]:_0x3e171a[_0x3df7de(0x93)](_0x14a25e);break;default:throw new Error(_0x3df7de(0x6f)+_0x257173[_0x3df7de(0x71)]+'\x27');}}else throw new veeva_error_1[(_0x3df7de(0x75))](_0x4fd661[_0x3df7de(0x87)]);}_0x8c6ad4=_0x3e171a;}while(_0x8c6ad4[_0x3df7de(0x80)]);return _0x5194a8;}}exports[a407_0x6fb864(0x8a)]=VeevaService,VeevaService[a407_0x6fb864(0x73)]=0x2710,VeevaService[a407_0x6fb864(0x70)]=0x1f4,VeevaService[a407_0x6fb864(0xa0)]=0x1f4;