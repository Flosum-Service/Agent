const a407_0x5291ba=a407_0x1bca;(function(_0x41002a,_0x4699d0){const _0x3288de=a407_0x1bca,_0x5cf87b=_0x41002a();while(!![]){try{const _0x322df4=parseInt(_0x3288de(0x10a))/0x1*(parseInt(_0x3288de(0x10c))/0x2)+-parseInt(_0x3288de(0x133))/0x3+-parseInt(_0x3288de(0x136))/0x4+-parseInt(_0x3288de(0x118))/0x5+parseInt(_0x3288de(0x123))/0x6+-parseInt(_0x3288de(0x11f))/0x7*(parseInt(_0x3288de(0x116))/0x8)+parseInt(_0x3288de(0x109))/0x9;if(_0x322df4===_0x4699d0)break;else _0x5cf87b['push'](_0x5cf87b['shift']());}catch(_0xac8ca1){_0x5cf87b['push'](_0x5cf87b['shift']());}}}(a407_0x12d3,0xd3cac));const a407_0x5ec2c4=(function(){let _0x499c6f=!![];return function(_0x55a850,_0x52341d){const _0x5d9455=_0x499c6f?function(){const _0x5ef0fa=a407_0x1bca;if(_0x52341d){const _0x15d550=_0x52341d[_0x5ef0fa(0x128)](_0x55a850,arguments);return _0x52341d=null,_0x15d550;}}:function(){};return _0x499c6f=![],_0x5d9455;};}()),a407_0xb9bc1=a407_0x5ec2c4(this,function(){const _0xe96957=a407_0x1bca;return a407_0xb9bc1[_0xe96957(0x135)]()[_0xe96957(0x131)](_0xe96957(0x107))[_0xe96957(0x135)]()['constructor'](a407_0xb9bc1)[_0xe96957(0x131)](_0xe96957(0x107));});a407_0xb9bc1();'use strict';Object[a407_0x5291ba(0x139)](exports,a407_0x5291ba(0x12d),{'value':!![]}),exports['VeevaService']=void 0x0;const utils_1=require(a407_0x5291ba(0x113)),status_enums_1=require(a407_0x5291ba(0x129)),veeva_error_1=require('../classes/errors/veeva-error'),veeva_constants_1=require(a407_0x5291ba(0x102));class VeevaService{constructor({connection:_0x131269,logger:_0x1baa24}){const _0xd7e76f=a407_0x5291ba;this['_connection']=_0x131269,this[_0xd7e76f(0x111)]=_0x1baa24;}async[a407_0x5291ba(0x12b)](_0x4279f2){const _0x2566b6=a407_0x5291ba,_0x5e84ea=[];for(const _0x259091 of _0x4279f2){_0x5e84ea[_0x2566b6(0x138)](this[_0x2566b6(0x119)](_0x259091));}const _0x284313=await Promise[_0x2566b6(0x112)](_0x5e84ea);return _0x284313['flat']();}async['executeVQL'](_0x2cec2d){const _0x591c3f=a407_0x5291ba,_0x51ba8c=[];let _0x1f3423=this[_0x591c3f(0x11a)][_0x591c3f(0x12a)](veeva_constants_1[_0x591c3f(0x10f)][_0x591c3f(0x104)],new URLSearchParams([['q',_0x2cec2d]]),{'headers':{'Content-Type':_0x591c3f(0x11e)}}),_0xc14fdf=![];do{const _0x2052da=await _0x1f3423,_0x3f3264=_0x2052da['data'];if(_0x3f3264[_0x591c3f(0x101)]!==status_enums_1[_0x591c3f(0x115)]['SUCCESS'])throw new veeva_error_1[(_0x591c3f(0x13b))](_0x3f3264[_0x591c3f(0x12c)]);const {responseDetails:{next_page:_0x2f56c1},data:_0x35431c}=_0x3f3264;_0x2f56c1?_0x1f3423=this[_0x591c3f(0x11a)]['get'](_0x2f56c1):_0xc14fdf=!![],_0x51ba8c[_0x591c3f(0x138)](..._0x35431c);}while(!_0xc14fdf);return _0x51ba8c;}async[a407_0x5291ba(0x11b)](_0x42cd79,_0x20e187){const _0x16caec=a407_0x5291ba,_0x68963c=[],_0xb7e48b=(0x0,utils_1[_0x16caec(0x105)])(_0x20e187,VeevaService[_0x16caec(0x137)]),_0x122d5c=_0x20e187[_0x16caec(0x132)];let _0x471743=0x0;for(const _0x237cea of _0xb7e48b){_0x471743+=_0x237cea['length'],this[_0x16caec(0x111)][_0x16caec(0x13a)](_0x16caec(0x121)+_0x471743+'/'+_0x122d5c+_0x16caec(0x110));const _0x2081fe=await this[_0x16caec(0x11a)][_0x16caec(0x12a)](_0x42cd79,_0x237cea),_0x3f5610=_0x2081fe[_0x16caec(0x125)];if(_0x3f5610[_0x16caec(0x101)]===status_enums_1['VeevaResponseStatus'][_0x16caec(0x126)])for(const {responseStatus:_0x465197,data:_0x49f25d}of _0x3f5610[_0x16caec(0x125)]){if(_0x465197===status_enums_1[_0x16caec(0x115)][_0x16caec(0x126)])_0x68963c[_0x16caec(0x138)](_0x49f25d['id']);else throw new veeva_error_1[(_0x16caec(0x13b))](_0x3f5610[_0x16caec(0x12c)]);}else throw new veeva_error_1[(_0x16caec(0x13b))](_0x3f5610[_0x16caec(0x12c)]);}return _0x68963c;}async['deleteVeevaObjectRecords'](_0x17ae37,_0x4982a5){const _0x5b7cdd=a407_0x5291ba,_0x2221ce=_0x4982a5[_0x5b7cdd(0x11c)](_0x823bc1=>({'id':_0x823bc1})),_0x2b0873=(0x0,utils_1[_0x5b7cdd(0x105)])(_0x2221ce,VeevaService['DELETE_RECORDS_LIMIT']);let _0x58f9b9=0x0;for(const _0x58b2c2 of _0x2b0873){_0x58f9b9+=_0x58b2c2['length'],this['_logger'][_0x5b7cdd(0x13a)](_0x5b7cdd(0x130)+_0x58f9b9+'/'+_0x4982a5[_0x5b7cdd(0x132)]+_0x5b7cdd(0x122));const {data:_0x6bd99d}=await this[_0x5b7cdd(0x11a)][_0x5b7cdd(0x10b)](_0x17ae37,{'headers':{'Content-Type':_0x5b7cdd(0x120)},'data':_0x58b2c2});if(_0x6bd99d[_0x5b7cdd(0x101)]===status_enums_1[_0x5b7cdd(0x115)][_0x5b7cdd(0x126)])for(const _0x35e1c0 of _0x6bd99d[_0x5b7cdd(0x125)]){const {responseStatus:_0x1c3aad,errors:_0xd63896}=_0x35e1c0;if(_0x1c3aad!==status_enums_1[_0x5b7cdd(0x115)][_0x5b7cdd(0x126)])throw new veeva_error_1[(_0x5b7cdd(0x13b))](_0xd63896);}else throw new veeva_error_1[(_0x5b7cdd(0x13b))](_0x6bd99d[_0x5b7cdd(0x12c)]);}}async['getJobResult'](_0x3aea55){const _0x56d3a9=a407_0x5291ba,_0x543558=[];do{this[_0x56d3a9(0x111)][_0x56d3a9(0x13a)](_0x56d3a9(0x134)),await(0x0,utils_1[_0x56d3a9(0x10d)])(VeevaService['JOB_STATUS_TIMEOUT']);const _0x29f52c=[];for(const _0x6f57f7 of _0x3aea55){const {data:_0x3fc39d}=await this[_0x56d3a9(0x11a)][_0x56d3a9(0x106)](_0x6f57f7);if(_0x3fc39d['responseStatus']===status_enums_1[_0x56d3a9(0x115)]['SUCCESS']){const {data:_0x502943}=_0x3fc39d;switch(_0x502943[_0x56d3a9(0x108)]){case status_enums_1[_0x56d3a9(0x117)][_0x56d3a9(0x126)]:case status_enums_1['VeevaJobStatus']['ERRORS_ENCOUNTERED']:_0x543558['push'](_0x502943);break;case status_enums_1[_0x56d3a9(0x117)][_0x56d3a9(0x103)]:case status_enums_1[_0x56d3a9(0x117)][_0x56d3a9(0x114)]:case status_enums_1[_0x56d3a9(0x117)]['MISSED_SCHEDULE']:throw new Error(_0x56d3a9(0x124)+_0x502943[_0x56d3a9(0x108)]);case status_enums_1[_0x56d3a9(0x117)][_0x56d3a9(0x12f)]:case status_enums_1['VeevaJobStatus'][_0x56d3a9(0x12e)]:case status_enums_1['VeevaJobStatus'][_0x56d3a9(0x11d)]:_0x29f52c[_0x56d3a9(0x138)](_0x6f57f7);break;default:throw new Error(_0x56d3a9(0x10e)+_0x502943['status']+'\x27');}}else throw new veeva_error_1[(_0x56d3a9(0x13b))](_0x3fc39d['errors']);}_0x3aea55=_0x29f52c;}while(_0x3aea55['length']);return _0x543558;}}function a407_0x1bca(_0xa4771,_0x3ea1ca){const _0x434573=a407_0x12d3();return a407_0x1bca=function(_0xb9bc1,_0x5ec2c4){_0xb9bc1=_0xb9bc1-0x101;let _0x12d31f=_0x434573[_0xb9bc1];return _0x12d31f;},a407_0x1bca(_0xa4771,_0x3ea1ca);}exports[a407_0x5291ba(0x127)]=VeevaService,VeevaService['JOB_STATUS_TIMEOUT']=0x2710,VeevaService[a407_0x5291ba(0x137)]=0x1f4,VeevaService['DELETE_RECORDS_LIMIT']=0x1f4;function a407_0x12d3(){const _0x15adee=['QUEUEING','ENDPOINT_VQL','chunkArray','get','(((.+)+)+)+$','status','18003231wqUjQF','1191979RmCHLh','delete','2kImscM','sleep','Unknown\x20Job\x20status\x20:\x20\x27','VeevaConstants','\x20records.','_logger','all','../../shared/utils','CANCELLED','VeevaResponseStatus','2896yfRsCU','VeevaJobStatus','7241275WuXszN','executeVQL','_connection','createVeevaObjectRecords','map','SCHEDULED','application/x-www-form-urlencoded','19572quwleh','application/json','Creating\x20','\x20records','8857746XoatUd','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','data','SUCCESS','VeevaService','apply','../enums/status.enums','post','executeManyVQL','errors','__esModule','RUNNING','QUEUED','Deleting\x20','search','length','177354IkTMDK','Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.','toString','5126416mtOQnP','CREATE_RECORDS_LIMIT','push','defineProperty','log','VeevaError','responseStatus','../constants/veeva.constants'];a407_0x12d3=function(){return _0x15adee;};return a407_0x12d3();}