const a407_0x560e74=a407_0x34da;(function(_0xff5f03,_0xf0169a){const _0x1d60ab=a407_0x34da,_0x1f7a1b=_0xff5f03();while(!![]){try{const _0x1f9a9a=parseInt(_0x1d60ab(0xfa))/0x1+parseInt(_0x1d60ab(0xf4))/0x2+parseInt(_0x1d60ab(0xf7))/0x3*(parseInt(_0x1d60ab(0xd9))/0x4)+-parseInt(_0x1d60ab(0x103))/0x5+parseInt(_0x1d60ab(0x108))/0x6*(-parseInt(_0x1d60ab(0xf8))/0x7)+-parseInt(_0x1d60ab(0x106))/0x8*(-parseInt(_0x1d60ab(0x10b))/0x9)+parseInt(_0x1d60ab(0xfc))/0xa;if(_0x1f9a9a===_0xf0169a)break;else _0x1f7a1b['push'](_0x1f7a1b['shift']());}catch(_0x59ec35){_0x1f7a1b['push'](_0x1f7a1b['shift']());}}}(a407_0x29fb,0x691e8));function a407_0x29fb(){const _0x1b7a10=['QUEUED','_logger','_connection','search','SUCCESS','VeevaService','(((.+)+)+)+$','executeVQL','push','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','application/x-www-form-urlencoded','VeevaResponseStatus','1052388AgAVay','Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.','ENDPOINT_VQL','201rNRDzQ','1758939clJumV','createVeevaObjectRecords','113651aPQZjb','VeevaJobStatus','1544840rvfxVc','CANCELLED','MISSED_SCHEDULE','../classes/errors/veeva-error','VeevaConstants','VeevaError','getJobResult','2977100KjACtt','toString','../enums/status.enums','16ZPSlDW','constructor','6tDiwGE','log','RUNNING','44019HRCuam','sleep','Creating\x20','Deleting\x20','../constants/veeva.constants','responseStatus','flat','status','executeManyVQL','errors','map','delete','28248nZotyR','\x20records','DELETE_RECORDS_LIMIT','chunkArray','SCHEDULED','all','data','deleteVeevaObjectRecords','length','defineProperty','post','__esModule','application/json','CREATE_RECORDS_LIMIT','JOB_STATUS_TIMEOUT'];a407_0x29fb=function(){return _0x1b7a10;};return a407_0x29fb();}const a407_0x1ca934=(function(){let _0x350e03=!![];return function(_0x37765,_0x2d1ac7){const _0x3269ab=_0x350e03?function(){if(_0x2d1ac7){const _0x22d23c=_0x2d1ac7['apply'](_0x37765,arguments);return _0x2d1ac7=null,_0x22d23c;}}:function(){};return _0x350e03=![],_0x3269ab;};}()),a407_0x2dd097=a407_0x1ca934(this,function(){const _0x327731=a407_0x34da;return a407_0x2dd097[_0x327731(0x104)]()[_0x327731(0xeb)](_0x327731(0xee))[_0x327731(0x104)]()[_0x327731(0x107)](a407_0x2dd097)[_0x327731(0xeb)](_0x327731(0xee));});a407_0x2dd097();function a407_0x34da(_0x445a4b,_0x1e6cca){const _0x238f3a=a407_0x29fb();return a407_0x34da=function(_0x2dd097,_0x1ca934){_0x2dd097=_0x2dd097-0xd5;let _0x29fb9d=_0x238f3a[_0x2dd097];return _0x29fb9d;},a407_0x34da(_0x445a4b,_0x1e6cca);}'use strict';Object[a407_0x560e74(0xe2)](exports,a407_0x560e74(0xe4),{'value':!![]}),exports[a407_0x560e74(0xed)]=void 0x0;const utils_1=require('../../shared/utils'),status_enums_1=require(a407_0x560e74(0x105)),veeva_error_1=require(a407_0x560e74(0xff)),veeva_constants_1=require(a407_0x560e74(0x10f));class VeevaService{constructor({connection:_0x30d098,logger:_0x1cb631}){const _0x14862a=a407_0x560e74;this[_0x14862a(0xea)]=_0x30d098,this[_0x14862a(0xe9)]=_0x1cb631;}async[a407_0x560e74(0xd5)](_0x22a3b1){const _0x116c44=a407_0x560e74,_0x560cd2=[];for(const _0x512077 of _0x22a3b1){_0x560cd2[_0x116c44(0xf0)](this['executeVQL'](_0x512077));}const _0x5e5893=await Promise[_0x116c44(0xde)](_0x560cd2);return _0x5e5893[_0x116c44(0x111)]();}async[a407_0x560e74(0xef)](_0x45f95c){const _0x2631e8=a407_0x560e74,_0xea2c56=[];let _0x15d167=this[_0x2631e8(0xea)][_0x2631e8(0xe3)](veeva_constants_1[_0x2631e8(0x100)][_0x2631e8(0xf6)],new URLSearchParams([['q',_0x45f95c]]),{'headers':{'Content-Type':_0x2631e8(0xf2)}}),_0x4ba7b2=![];do{const _0x20479c=await _0x15d167,_0x30c11d=_0x20479c[_0x2631e8(0xdf)];if(_0x30c11d[_0x2631e8(0x110)]!==status_enums_1[_0x2631e8(0xf3)]['SUCCESS'])throw new veeva_error_1[(_0x2631e8(0x101))](_0x30c11d[_0x2631e8(0xd6)]);const {responseDetails:{next_page:_0x5789c1},data:_0x5aa70f}=_0x30c11d;_0x5789c1?_0x15d167=this['_connection']['get'](_0x5789c1):_0x4ba7b2=!![],_0xea2c56['push'](..._0x5aa70f);}while(!_0x4ba7b2);return _0xea2c56;}async[a407_0x560e74(0xf9)](_0x444494,_0x6835c0){const _0x17d886=a407_0x560e74,_0x62c0f1=[],_0x1a7176=(0x0,utils_1[_0x17d886(0xdc)])(_0x6835c0,VeevaService[_0x17d886(0xe6)]),_0x4ed8d1=_0x6835c0['length'];let _0x20e791=0x0;for(const _0x12a3ca of _0x1a7176){_0x20e791+=_0x12a3ca[_0x17d886(0xe1)],this[_0x17d886(0xe9)][_0x17d886(0x109)](_0x17d886(0x10d)+_0x20e791+'/'+_0x4ed8d1+'\x20records.');const _0x283d77=await this[_0x17d886(0xea)][_0x17d886(0xe3)](_0x444494,_0x12a3ca),_0x199495=_0x283d77[_0x17d886(0xdf)];if(_0x199495[_0x17d886(0x110)]===status_enums_1[_0x17d886(0xf3)][_0x17d886(0xec)])for(const {responseStatus:_0x228c5b,data:_0x13d446}of _0x199495[_0x17d886(0xdf)]){if(_0x228c5b===status_enums_1['VeevaResponseStatus'][_0x17d886(0xec)])_0x62c0f1[_0x17d886(0xf0)](_0x13d446['id']);else throw new veeva_error_1[(_0x17d886(0x101))](_0x199495['errors']);}else throw new veeva_error_1['VeevaError'](_0x199495[_0x17d886(0xd6)]);}return _0x62c0f1;}async[a407_0x560e74(0xe0)](_0x4598e6,_0x5dd385){const _0x2b110e=a407_0x560e74,_0x375706=_0x5dd385[_0x2b110e(0xd7)](_0x555b8d=>({'id':_0x555b8d})),_0x2d0dbb=(0x0,utils_1[_0x2b110e(0xdc)])(_0x375706,VeevaService[_0x2b110e(0xdb)]);let _0x22980d=0x0;for(const _0x5776b1 of _0x2d0dbb){_0x22980d+=_0x5776b1[_0x2b110e(0xe1)],this[_0x2b110e(0xe9)][_0x2b110e(0x109)](_0x2b110e(0x10e)+_0x22980d+'/'+_0x5dd385['length']+_0x2b110e(0xda));const {data:_0x3317a9}=await this[_0x2b110e(0xea)][_0x2b110e(0xd8)](_0x4598e6,{'headers':{'Content-Type':_0x2b110e(0xe5)},'data':_0x5776b1});if(_0x3317a9[_0x2b110e(0x110)]===status_enums_1[_0x2b110e(0xf3)][_0x2b110e(0xec)])for(const _0x25ae15 of _0x3317a9[_0x2b110e(0xdf)]){const {responseStatus:_0x3009af,errors:_0x35d27c}=_0x25ae15;if(_0x3009af!==status_enums_1['VeevaResponseStatus'][_0x2b110e(0xec)])throw new veeva_error_1['VeevaError'](_0x35d27c);}else throw new veeva_error_1[(_0x2b110e(0x101))](_0x3317a9[_0x2b110e(0xd6)]);}}async[a407_0x560e74(0x102)](_0x55d2db){const _0x22d296=a407_0x560e74,_0xa40d43=[];do{this[_0x22d296(0xe9)][_0x22d296(0x109)](_0x22d296(0xf5)),await(0x0,utils_1[_0x22d296(0x10c)])(VeevaService[_0x22d296(0xe7)]);const _0x1bf2f1=[];for(const _0x56c405 of _0x55d2db){const {data:_0x327279}=await this[_0x22d296(0xea)]['get'](_0x56c405);if(_0x327279['responseStatus']===status_enums_1[_0x22d296(0xf3)]['SUCCESS']){const {data:_0x40eee3}=_0x327279;switch(_0x40eee3[_0x22d296(0x112)]){case status_enums_1['VeevaJobStatus']['SUCCESS']:case status_enums_1[_0x22d296(0xfb)]['ERRORS_ENCOUNTERED']:_0xa40d43[_0x22d296(0xf0)](_0x40eee3);break;case status_enums_1[_0x22d296(0xfb)]['QUEUEING']:case status_enums_1[_0x22d296(0xfb)][_0x22d296(0xfd)]:case status_enums_1[_0x22d296(0xfb)][_0x22d296(0xfe)]:throw new Error(_0x22d296(0xf1)+_0x40eee3[_0x22d296(0x112)]);case status_enums_1[_0x22d296(0xfb)][_0x22d296(0xe8)]:case status_enums_1[_0x22d296(0xfb)][_0x22d296(0x10a)]:case status_enums_1[_0x22d296(0xfb)][_0x22d296(0xdd)]:_0x1bf2f1[_0x22d296(0xf0)](_0x56c405);break;default:throw new Error('Unknown\x20Job\x20status\x20:\x20\x27'+_0x40eee3[_0x22d296(0x112)]+'\x27');}}else throw new veeva_error_1['VeevaError'](_0x327279[_0x22d296(0xd6)]);}_0x55d2db=_0x1bf2f1;}while(_0x55d2db['length']);return _0xa40d43;}}exports[a407_0x560e74(0xed)]=VeevaService,VeevaService[a407_0x560e74(0xe7)]=0x2710,VeevaService[a407_0x560e74(0xe6)]=0x1f4,VeevaService[a407_0x560e74(0xdb)]=0x1f4;