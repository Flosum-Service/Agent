const a407_0xd4b731=a407_0x20db;(function(_0x24a30c,_0x37071e){const _0x4af0cf=a407_0x20db,_0x25abe8=_0x24a30c();while(!![]){try{const _0x3dd0b7=parseInt(_0x4af0cf(0x11c))/0x1*(parseInt(_0x4af0cf(0x121))/0x2)+-parseInt(_0x4af0cf(0x116))/0x3+-parseInt(_0x4af0cf(0x146))/0x4+parseInt(_0x4af0cf(0x140))/0x5+parseInt(_0x4af0cf(0x137))/0x6+-parseInt(_0x4af0cf(0x12d))/0x7+parseInt(_0x4af0cf(0x11f))/0x8;if(_0x3dd0b7===_0x37071e)break;else _0x25abe8['push'](_0x25abe8['shift']());}catch(_0x2a04b9){_0x25abe8['push'](_0x25abe8['shift']());}}}(a407_0x32c7,0xa7bb9));function a407_0x20db(_0x2188b7,_0x14cf47){const _0x364bd1=a407_0x32c7();return a407_0x20db=function(_0x276e42,_0x3933ee){_0x276e42=_0x276e42-0x112;let _0x32c79a=_0x364bd1[_0x276e42];return _0x32c79a;},a407_0x20db(_0x2188b7,_0x14cf47);}function a407_0x32c7(){const _0x81804a=['5854723Psgvcc','ENDPOINT_VQL','VeevaResponseStatus','QUEUED','createVeevaObjectRecords','log','VeevaError','deleteVeevaObjectRecords','Creating\x20','(((.+)+)+)+$','4516122uytOcN','executeManyVQL','application/x-www-form-urlencoded','status','_logger','CANCELLED','QUEUEING','getJobResult','SUCCESS','2475445FpzPLY','data','JOB_STATUS_TIMEOUT','post','DELETE_RECORDS_LIMIT','push','175280UyDyVY','chunkArray','VeevaJobStatus','\x20records','flat','193884BCZECW','__esModule','sleep','application/json','../classes/errors/veeva-error','search','25937wNfoNn','toString','responseStatus','2450264npSvAV','Unknown\x20Job\x20status\x20:\x20\x27','6CpeWhJ','VeevaService','errors','../constants/veeva.constants','executeVQL','delete','CREATE_RECORDS_LIMIT','constructor','SCHEDULED','length','apply','_connection'];a407_0x32c7=function(){return _0x81804a;};return a407_0x32c7();}const a407_0x3933ee=(function(){let _0x1567de=!![];return function(_0x50390d,_0x2d3ac6){const _0x524c0b=_0x1567de?function(){const _0x5b4cd5=a407_0x20db;if(_0x2d3ac6){const _0xe2d08d=_0x2d3ac6[_0x5b4cd5(0x12b)](_0x50390d,arguments);return _0x2d3ac6=null,_0xe2d08d;}}:function(){};return _0x1567de=![],_0x524c0b;};}()),a407_0x276e42=a407_0x3933ee(this,function(){const _0x251eee=a407_0x20db;return a407_0x276e42[_0x251eee(0x11d)]()[_0x251eee(0x11b)](_0x251eee(0x136))[_0x251eee(0x11d)]()[_0x251eee(0x128)](a407_0x276e42)['search'](_0x251eee(0x136));});a407_0x276e42();'use strict';Object['defineProperty'](exports,a407_0xd4b731(0x117),{'value':!![]}),exports[a407_0xd4b731(0x122)]=void 0x0;const utils_1=require('../../shared/utils'),status_enums_1=require('../enums/status.enums'),veeva_error_1=require(a407_0xd4b731(0x11a)),veeva_constants_1=require(a407_0xd4b731(0x124));class VeevaService{constructor({connection:_0x1fc278,logger:_0x58918d}){const _0x3c69df=a407_0xd4b731;this[_0x3c69df(0x12c)]=_0x1fc278,this[_0x3c69df(0x13b)]=_0x58918d;}async[a407_0xd4b731(0x138)](_0x22c0f8){const _0x1e54bd=a407_0xd4b731,_0x4f6eac=[];for(const _0x28e164 of _0x22c0f8){_0x4f6eac['push'](this[_0x1e54bd(0x125)](_0x28e164));}const _0x524388=await Promise['all'](_0x4f6eac);return _0x524388[_0x1e54bd(0x115)]();}async[a407_0xd4b731(0x125)](_0x7af2b9){const _0x16ef7f=a407_0xd4b731,_0xa6527e=[];let _0x2ee41a=this[_0x16ef7f(0x12c)]['post'](veeva_constants_1['VeevaConstants'][_0x16ef7f(0x12e)],new URLSearchParams([['q',_0x7af2b9]]),{'headers':{'Content-Type':_0x16ef7f(0x139)}}),_0x403eb2=![];do{const _0x4fa9d6=await _0x2ee41a,_0x2e9bde=_0x4fa9d6[_0x16ef7f(0x141)];if(_0x2e9bde[_0x16ef7f(0x11e)]!==status_enums_1[_0x16ef7f(0x12f)][_0x16ef7f(0x13f)])throw new veeva_error_1[(_0x16ef7f(0x133))](_0x2e9bde[_0x16ef7f(0x123)]);const {responseDetails:{next_page:_0x130df7},data:_0x42e76f}=_0x2e9bde;_0x130df7?_0x2ee41a=this[_0x16ef7f(0x12c)]['get'](_0x130df7):_0x403eb2=!![],_0xa6527e[_0x16ef7f(0x145)](..._0x42e76f);}while(!_0x403eb2);return _0xa6527e;}async[a407_0xd4b731(0x131)](_0x1a248e,_0x3151a0){const _0x86d916=a407_0xd4b731,_0x4db80c=[],_0x347fd7=(0x0,utils_1[_0x86d916(0x112)])(_0x3151a0,VeevaService[_0x86d916(0x127)]),_0x9f9da4=_0x3151a0[_0x86d916(0x12a)];let _0x429ed6=0x0;for(const _0x50b101 of _0x347fd7){_0x429ed6+=_0x50b101[_0x86d916(0x12a)],this['_logger'][_0x86d916(0x132)](_0x86d916(0x135)+_0x429ed6+'/'+_0x9f9da4+'\x20records.');const _0x35f8fc=await this['_connection'][_0x86d916(0x143)](_0x1a248e,_0x50b101),_0x223bdc=_0x35f8fc[_0x86d916(0x141)];if(_0x223bdc[_0x86d916(0x11e)]===status_enums_1[_0x86d916(0x12f)][_0x86d916(0x13f)])for(const {responseStatus:_0x438d1c,data:_0x3a7cee}of _0x223bdc[_0x86d916(0x141)]){if(_0x438d1c===status_enums_1[_0x86d916(0x12f)][_0x86d916(0x13f)])_0x4db80c[_0x86d916(0x145)](_0x3a7cee['id']);else throw new veeva_error_1[(_0x86d916(0x133))](_0x223bdc[_0x86d916(0x123)]);}else throw new veeva_error_1[(_0x86d916(0x133))](_0x223bdc['errors']);}return _0x4db80c;}async[a407_0xd4b731(0x134)](_0x743129,_0x32bb26){const _0x6c03ef=a407_0xd4b731,_0x3d0652=_0x32bb26['map'](_0x1ab23d=>({'id':_0x1ab23d})),_0x231dd3=(0x0,utils_1['chunkArray'])(_0x3d0652,VeevaService[_0x6c03ef(0x144)]);let _0x336a14=0x0;for(const _0x593bb9 of _0x231dd3){_0x336a14+=_0x593bb9['length'],this[_0x6c03ef(0x13b)][_0x6c03ef(0x132)]('Deleting\x20'+_0x336a14+'/'+_0x32bb26[_0x6c03ef(0x12a)]+_0x6c03ef(0x114));const {data:_0x527e0b}=await this['_connection'][_0x6c03ef(0x126)](_0x743129,{'headers':{'Content-Type':_0x6c03ef(0x119)},'data':_0x593bb9});if(_0x527e0b[_0x6c03ef(0x11e)]===status_enums_1['VeevaResponseStatus'][_0x6c03ef(0x13f)])for(const _0xed176f of _0x527e0b[_0x6c03ef(0x141)]){const {responseStatus:_0x158aad,errors:_0x49c5a8}=_0xed176f;if(_0x158aad!==status_enums_1[_0x6c03ef(0x12f)][_0x6c03ef(0x13f)])throw new veeva_error_1[(_0x6c03ef(0x133))](_0x49c5a8);}else throw new veeva_error_1[(_0x6c03ef(0x133))](_0x527e0b[_0x6c03ef(0x123)]);}}async[a407_0xd4b731(0x13e)](_0xa7449e){const _0x4fc8d2=a407_0xd4b731,_0x28a003=[];do{this[_0x4fc8d2(0x13b)][_0x4fc8d2(0x132)]('Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.'),await(0x0,utils_1[_0x4fc8d2(0x118)])(VeevaService['JOB_STATUS_TIMEOUT']);const _0x5ee7f8=[];for(const _0x190c54 of _0xa7449e){const {data:_0xd5a364}=await this[_0x4fc8d2(0x12c)]['get'](_0x190c54);if(_0xd5a364[_0x4fc8d2(0x11e)]===status_enums_1[_0x4fc8d2(0x12f)][_0x4fc8d2(0x13f)]){const {data:_0x3236a7}=_0xd5a364;switch(_0x3236a7['status']){case status_enums_1['VeevaJobStatus'][_0x4fc8d2(0x13f)]:case status_enums_1[_0x4fc8d2(0x113)]['ERRORS_ENCOUNTERED']:_0x28a003[_0x4fc8d2(0x145)](_0x3236a7);break;case status_enums_1['VeevaJobStatus'][_0x4fc8d2(0x13d)]:case status_enums_1[_0x4fc8d2(0x113)][_0x4fc8d2(0x13c)]:case status_enums_1[_0x4fc8d2(0x113)]['MISSED_SCHEDULE']:throw new Error('Cannot\x20retrieve\x20job.\x20Job\x20status:\x20'+_0x3236a7[_0x4fc8d2(0x13a)]);case status_enums_1[_0x4fc8d2(0x113)][_0x4fc8d2(0x130)]:case status_enums_1['VeevaJobStatus']['RUNNING']:case status_enums_1[_0x4fc8d2(0x113)][_0x4fc8d2(0x129)]:_0x5ee7f8[_0x4fc8d2(0x145)](_0x190c54);break;default:throw new Error(_0x4fc8d2(0x120)+_0x3236a7[_0x4fc8d2(0x13a)]+'\x27');}}else throw new veeva_error_1[(_0x4fc8d2(0x133))](_0xd5a364[_0x4fc8d2(0x123)]);}_0xa7449e=_0x5ee7f8;}while(_0xa7449e[_0x4fc8d2(0x12a)]);return _0x28a003;}}exports[a407_0xd4b731(0x122)]=VeevaService,VeevaService[a407_0xd4b731(0x142)]=0x2710,VeevaService[a407_0xd4b731(0x127)]=0x1f4,VeevaService['DELETE_RECORDS_LIMIT']=0x1f4;