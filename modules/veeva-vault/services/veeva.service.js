const a380_0x2f53b8=a380_0xe192;(function(_0xcb124,_0x47e980){const _0x132c6a=a380_0xe192,_0x1eb476=_0xcb124();while(!![]){try{const _0x26ddb8=-parseInt(_0x132c6a(0x118))/0x1+parseInt(_0x132c6a(0x123))/0x2*(-parseInt(_0x132c6a(0x11a))/0x3)+-parseInt(_0x132c6a(0x12b))/0x4*(-parseInt(_0x132c6a(0x13c))/0x5)+-parseInt(_0x132c6a(0x12f))/0x6+parseInt(_0x132c6a(0x143))/0x7*(-parseInt(_0x132c6a(0x144))/0x8)+-parseInt(_0x132c6a(0x12d))/0x9+-parseInt(_0x132c6a(0x115))/0xa*(-parseInt(_0x132c6a(0x142))/0xb);if(_0x26ddb8===_0x47e980)break;else _0x1eb476['push'](_0x1eb476['shift']());}catch(_0x247422){_0x1eb476['push'](_0x1eb476['shift']());}}}(a380_0x44ab,0xddef9));const a380_0x303641=(function(){let _0x2e2c9f=!![];return function(_0x468fae,_0x393e17){const _0x2febc1=_0x2e2c9f?function(){const _0x3a9f20=a380_0xe192;if(_0x393e17){const _0x30e07c=_0x393e17[_0x3a9f20(0x121)](_0x468fae,arguments);return _0x393e17=null,_0x30e07c;}}:function(){};return _0x2e2c9f=![],_0x2febc1;};}()),a380_0x499ffa=a380_0x303641(this,function(){const _0x4a7a52=a380_0xe192;return a380_0x499ffa[_0x4a7a52(0x122)]()['search']('(((.+)+)+)+$')[_0x4a7a52(0x122)]()['constructor'](a380_0x499ffa)['search'](_0x4a7a52(0x111));});function a380_0xe192(_0x349e45,_0x2c5214){const _0x454774=a380_0x44ab();return a380_0xe192=function(_0x499ffa,_0x303641){_0x499ffa=_0x499ffa-0x10c;let _0x44aba6=_0x454774[_0x499ffa];return _0x44aba6;},a380_0xe192(_0x349e45,_0x2c5214);}a380_0x499ffa();'use strict';Object['defineProperty'](exports,a380_0x2f53b8(0x11b),{'value':!![]}),exports['VeevaService']=void 0x0;function a380_0x44ab(){const _0x4e8570=['650947EhYclR','147BWXIbp','207816qeQAaY','log','CANCELLED','application/x-www-form-urlencoded','VeevaError','createVeevaObjectRecords','(((.+)+)+)+$','delete','../classes/errors/veeva-error','push','920vBUHvK','responseStatus','_logger','1751534XzzTYk','post','162kZpVoa','__esModule','../constants/veeva.constants','JOB_STATUS_TIMEOUT','RUNNING','QUEUED','data','apply','toString','64588jdMDHP','length','all','Deleting\x20','VeevaJobStatus','SCHEDULED','QUEUEING','CREATE_RECORDS_LIMIT','512lTJZUA','executeManyVQL','5539167CoNBKF','ERRORS_ENCOUNTERED','5926254YwBWAh','_connection','get','errors','sleep','map','Cannot\x20retrieve\x20job.\x20Job\x20status:\x20','MISSED_SCHEDULE','\x20records','SUCCESS','VeevaResponseStatus','\x20records.','Unknown\x20Job\x20status\x20:\x20\x27','43315nEgoLh','DELETE_RECORDS_LIMIT','status','ENDPOINT_VQL','executeVQL','chunkArray'];a380_0x44ab=function(){return _0x4e8570;};return a380_0x44ab();}const utils_1=require('../../shared/utils'),status_enums_1=require('../enums/status.enums'),veeva_error_1=require(a380_0x2f53b8(0x113)),veeva_constants_1=require(a380_0x2f53b8(0x11c));class VeevaService{constructor({connection:_0x39fb46,logger:_0x10d9b0}){const _0x3727ce=a380_0x2f53b8;this[_0x3727ce(0x130)]=_0x39fb46,this[_0x3727ce(0x117)]=_0x10d9b0;}async[a380_0x2f53b8(0x12c)](_0x267ddd){const _0x1ec735=a380_0x2f53b8,_0x25c32b=[];for(const _0x4fc451 of _0x267ddd){_0x25c32b['push'](this['executeVQL'](_0x4fc451));}const _0x36ea57=await Promise[_0x1ec735(0x125)](_0x25c32b);return _0x36ea57['flat']();}async[a380_0x2f53b8(0x140)](_0x48694a){const _0x30a943=a380_0x2f53b8,_0x3471fd=[];let _0x401656=this['_connection'][_0x30a943(0x119)](veeva_constants_1['VeevaConstants'][_0x30a943(0x13f)],new URLSearchParams([['q',_0x48694a]]),{'headers':{'Content-Type':_0x30a943(0x10e)}}),_0x726d49=![];do{const _0x2da60c=await _0x401656,_0x217848=_0x2da60c[_0x30a943(0x120)];if(_0x217848['responseStatus']!==status_enums_1[_0x30a943(0x139)][_0x30a943(0x138)])throw new veeva_error_1[(_0x30a943(0x10f))](_0x217848['errors']);const {responseDetails:{next_page:_0x8f6c18},data:_0x2e71ff}=_0x217848;_0x8f6c18?_0x401656=this[_0x30a943(0x130)][_0x30a943(0x131)](_0x8f6c18):_0x726d49=!![],_0x3471fd[_0x30a943(0x114)](..._0x2e71ff);}while(!_0x726d49);return _0x3471fd;}async[a380_0x2f53b8(0x110)](_0x6b919c,_0x2772f7){const _0x1bdbc5=a380_0x2f53b8,_0x498b96=[],_0x58dcd8=(0x0,utils_1[_0x1bdbc5(0x141)])(_0x2772f7,VeevaService[_0x1bdbc5(0x12a)]),_0x29ca73=_0x2772f7['length'];let _0x357d15=0x0;for(const _0xed6e01 of _0x58dcd8){_0x357d15+=_0xed6e01[_0x1bdbc5(0x124)],this[_0x1bdbc5(0x117)][_0x1bdbc5(0x10c)]('Creating\x20'+_0x357d15+'/'+_0x29ca73+_0x1bdbc5(0x13a));const _0x35a6f6=await this['_connection'][_0x1bdbc5(0x119)](_0x6b919c,_0xed6e01),_0x17aba1=_0x35a6f6[_0x1bdbc5(0x120)];if(_0x17aba1[_0x1bdbc5(0x116)]===status_enums_1['VeevaResponseStatus'][_0x1bdbc5(0x138)])for(const {responseStatus:_0x3a3be1,data:_0x288c11}of _0x17aba1[_0x1bdbc5(0x120)]){if(_0x3a3be1===status_enums_1[_0x1bdbc5(0x139)]['SUCCESS'])_0x498b96['push'](_0x288c11['id']);else throw new veeva_error_1[(_0x1bdbc5(0x10f))](_0x17aba1[_0x1bdbc5(0x132)]);}else throw new veeva_error_1[(_0x1bdbc5(0x10f))](_0x17aba1[_0x1bdbc5(0x132)]);}return _0x498b96;}async['deleteVeevaObjectRecords'](_0x520479,_0x514f38){const _0x15bd67=a380_0x2f53b8,_0x13ec65=_0x514f38[_0x15bd67(0x134)](_0x14365e=>({'id':_0x14365e})),_0x154291=(0x0,utils_1['chunkArray'])(_0x13ec65,VeevaService[_0x15bd67(0x13d)]);let _0x2ce227=0x0;for(const _0x5a3229 of _0x154291){_0x2ce227+=_0x5a3229[_0x15bd67(0x124)],this[_0x15bd67(0x117)][_0x15bd67(0x10c)](_0x15bd67(0x126)+_0x2ce227+'/'+_0x514f38[_0x15bd67(0x124)]+_0x15bd67(0x137));const {data:_0x206719}=await this['_connection'][_0x15bd67(0x112)](_0x520479,{'headers':{'Content-Type':'application/json'},'data':_0x5a3229});if(_0x206719['responseStatus']===status_enums_1[_0x15bd67(0x139)][_0x15bd67(0x138)])for(const _0x5b2e2a of _0x206719[_0x15bd67(0x120)]){const {responseStatus:_0x3de3e8,errors:_0x508031}=_0x5b2e2a;if(_0x3de3e8!==status_enums_1[_0x15bd67(0x139)][_0x15bd67(0x138)])throw new veeva_error_1['VeevaError'](_0x508031);}else throw new veeva_error_1['VeevaError'](_0x206719[_0x15bd67(0x132)]);}}async['getJobResult'](_0x96a183){const _0x212ab5=a380_0x2f53b8,_0x20d287=[];do{this['_logger'][_0x212ab5(0x10c)]('Check\x20Retrieval\x20Status:\x20Not\x20Completed.\x20Next\x20check\x20after\x2010\x20seconds.'),await(0x0,utils_1[_0x212ab5(0x133)])(VeevaService[_0x212ab5(0x11d)]);const _0x56200f=[];for(const _0x3c0092 of _0x96a183){const {data:_0x48ed0b}=await this[_0x212ab5(0x130)][_0x212ab5(0x131)](_0x3c0092);if(_0x48ed0b[_0x212ab5(0x116)]===status_enums_1['VeevaResponseStatus']['SUCCESS']){const {data:_0x5f1574}=_0x48ed0b;switch(_0x5f1574[_0x212ab5(0x13e)]){case status_enums_1[_0x212ab5(0x127)][_0x212ab5(0x138)]:case status_enums_1[_0x212ab5(0x127)][_0x212ab5(0x12e)]:_0x20d287['push'](_0x5f1574);break;case status_enums_1[_0x212ab5(0x127)][_0x212ab5(0x129)]:case status_enums_1['VeevaJobStatus'][_0x212ab5(0x10d)]:case status_enums_1[_0x212ab5(0x127)][_0x212ab5(0x136)]:throw new Error(_0x212ab5(0x135)+_0x5f1574[_0x212ab5(0x13e)]);case status_enums_1['VeevaJobStatus'][_0x212ab5(0x11f)]:case status_enums_1['VeevaJobStatus'][_0x212ab5(0x11e)]:case status_enums_1[_0x212ab5(0x127)][_0x212ab5(0x128)]:_0x56200f[_0x212ab5(0x114)](_0x3c0092);break;default:throw new Error(_0x212ab5(0x13b)+_0x5f1574[_0x212ab5(0x13e)]+'\x27');}}else throw new veeva_error_1[(_0x212ab5(0x10f))](_0x48ed0b[_0x212ab5(0x132)]);}_0x96a183=_0x56200f;}while(_0x96a183[_0x212ab5(0x124)]);return _0x20d287;}}exports['VeevaService']=VeevaService,VeevaService[a380_0x2f53b8(0x11d)]=0x2710,VeevaService[a380_0x2f53b8(0x12a)]=0x1f4,VeevaService['DELETE_RECORDS_LIMIT']=0x1f4;