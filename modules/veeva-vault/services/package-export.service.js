const a404_0x45c896=a404_0x283c;(function(_0x23bb05,_0x383238){const _0x28bac5=a404_0x283c,_0x4a4a18=_0x23bb05();while(!![]){try{const _0x229fce=parseInt(_0x28bac5(0x206))/0x1+parseInt(_0x28bac5(0x1fc))/0x2*(-parseInt(_0x28bac5(0x1f2))/0x3)+parseInt(_0x28bac5(0x1df))/0x4+-parseInt(_0x28bac5(0x219))/0x5*(-parseInt(_0x28bac5(0x1fe))/0x6)+-parseInt(_0x28bac5(0x1d1))/0x7*(parseInt(_0x28bac5(0x1f3))/0x8)+-parseInt(_0x28bac5(0x1fa))/0x9*(parseInt(_0x28bac5(0x1dd))/0xa)+-parseInt(_0x28bac5(0x1ce))/0xb*(-parseInt(_0x28bac5(0x1e0))/0xc);if(_0x229fce===_0x383238)break;else _0x4a4a18['push'](_0x4a4a18['shift']());}catch(_0x563c2c){_0x4a4a18['push'](_0x4a4a18['shift']());}}}(a404_0x2028,0x38f79));const a404_0x27a36c=(function(){let _0x1b9a74=!![];return function(_0x267d38,_0x5d57a7){const _0x4cf2a5=_0x1b9a74?function(){if(_0x5d57a7){const _0x24cfdf=_0x5d57a7['apply'](_0x267d38,arguments);return _0x5d57a7=null,_0x24cfdf;}}:function(){};return _0x1b9a74=![],_0x4cf2a5;};}()),a404_0x8ec688=a404_0x27a36c(this,function(){const _0x48b052=a404_0x283c;return a404_0x8ec688['toString']()[_0x48b052(0x1d7)](_0x48b052(0x204))[_0x48b052(0x209)]()[_0x48b052(0x214)](a404_0x8ec688)[_0x48b052(0x1d7)]('(((.+)+)+)+$');});function a404_0x2028(){const _0x1787ef=['map','VeevaResponseStatus','includes','createExportOutboundPackages','10UZyumv','errors','122448kcOxvA','1890072YTjOSi','arraybuffer','MAXIMUM_SIZE_OF_PACKAGE','links','post','__esModule','VeevaConstants','deletePackageComponents','name__v','join','push','loadAsync','createOutboundPackages','href','../classes/errors/veeva-error','deleteVeevaObjectRecords','_logger','getEndpointArtifactList','3UEtJni','1049248nuJsep','ceil','deleteOutboundPackages','log','VeevaError','artifacts','responseStatus','90621SgHKfo','default','882260peIAwo','Create\x20Export\x20outbound\x20packages.','126LXpzYp','ENDPOINT_EXPORT_IMPORT_PACKAGE','rel','reduce','Creating\x20outbound\x20packages','SUCCESS','(((.+)+)+)+$','_veevaService','366885oZyBNk','_connection','set','toString','values','ENDPOINT_CREATE_RECORDS','export','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','executeVQL','content-type','createVeevaObjectRecords','getPackageNames','application/x-www-form-urlencoded','get','constructor','fill','Deleting\x20outbound\x20packages.','filter','defineProperty','55795qAjUAU','jszip','outbound_package__v','Adding\x20components\x20to\x20outbound\x20package','22LzZEHg','package_component__v','parse','14EmeBdb','Getting\x20names\x20of\x20outbound\x20packages','__importDefault','getJobResult','retrieveVPKList','all','search','length'];a404_0x2028=function(){return _0x1787ef;};return a404_0x2028();}a404_0x8ec688();'use strict';var __importDefault=this&&this[a404_0x45c896(0x1d3)]||function(_0x277d51){const _0xcd698b=a404_0x45c896;return _0x277d51&&_0x277d51[_0xcd698b(0x1e5)]?_0x277d51:{'default':_0x277d51};};Object[a404_0x45c896(0x218)](exports,a404_0x45c896(0x1e5),{'value':!![]}),exports['PackageExportService']=void 0x0;const veeva_constants_1=require('../constants/veeva.constants'),jszip_1=__importDefault(require(a404_0x45c896(0x21a))),status_enums_1=require('../enums/status.enums'),veeva_error_1=require(a404_0x45c896(0x1ee));class PackageExportService{constructor({veevaService:_0x4d38ef,connection:_0x47937b,logger:_0x3261be}){const _0x562e1f=a404_0x45c896;this['_veevaService']=_0x4d38ef,this[_0x562e1f(0x207)]=_0x47937b,this[_0x562e1f(0x1f0)]=_0x3261be;}async[a404_0x45c896(0x1ec)](_0x35a4d0,_0x91ccea){const _0x5c7e62=a404_0x45c896;this[_0x5c7e62(0x1f0)][_0x5c7e62(0x1f6)](_0x5c7e62(0x202));const _0x29101e=veeva_constants_1['VeevaConstants']['ENDPOINT_CREATE_RECORDS']+_0x5c7e62(0x21b),_0x2b3aa4=new Array(_0x35a4d0)[_0x5c7e62(0x215)]({'summary__v':_0x91ccea,'object_type__v.api__name__v':'migration__sys'});return await this['_veevaService'][_0x5c7e62(0x210)](_0x29101e,_0x2b3aa4);}async['createPackageComponents'](_0x143005,_0x3a574a){const _0x22835d=a404_0x45c896;this[_0x22835d(0x1f0)][_0x22835d(0x1f6)](_0x22835d(0x21c));const _0x242d74=veeva_constants_1[_0x22835d(0x1e6)][_0x22835d(0x20b)]+_0x22835d(0x1cf),_0x5e91e1=_0x143005[_0x22835d(0x1d9)]((_0x33335f,_0x2b96ba)=>({'vault_component__v':_0x33335f['id'],'outbound_package__v':_0x3a574a[Math[_0x22835d(0x1f4)]((_0x2b96ba+0x1)/veeva_constants_1['VeevaConstants'][_0x22835d(0x1e2)])-0x1]}));return await this[_0x22835d(0x205)][_0x22835d(0x210)](_0x242d74,_0x5e91e1);}async[a404_0x45c896(0x211)](_0x4e45af){const _0x4729d8=a404_0x45c896;this[_0x4729d8(0x1f0)][_0x4729d8(0x1f6)](_0x4729d8(0x1d2));const _0x3dff33=_0x4729d8(0x20d)+_0x4e45af[_0x4729d8(0x1e9)]('\x27,\x27')+'\x27)',_0x317524=await this['_veevaService'][_0x4729d8(0x20e)](_0x3dff33);return _0x317524[_0x4729d8(0x201)]((_0x6ee881,_0x49e09b)=>_0x6ee881[_0x4729d8(0x208)](_0x49e09b['id'],_0x49e09b[_0x4729d8(0x1e8)]),new Map());}async[a404_0x45c896(0x1dc)](_0x45dd12){const _0x2eee47=a404_0x45c896;this[_0x2eee47(0x1f0)][_0x2eee47(0x1f6)](_0x2eee47(0x1fd));const _0xeb359c=[],_0x438556=_0x45dd12[_0x2eee47(0x1d9)](_0x370bd7=>{const _0x2cee55=_0x2eee47;return this[_0x2cee55(0x207)][_0x2cee55(0x1e4)](veeva_constants_1['VeevaConstants'][_0x2cee55(0x1ff)],encodeURI('packageName')+'='+encodeURI(_0x370bd7),{'headers':{'Content-Type':_0x2cee55(0x212)}});}),_0x5efe58=await Promise[_0x2eee47(0x1d6)](_0x438556);for(const {data:_0xcb1eb3}of _0x5efe58){if(_0xcb1eb3[_0x2eee47(0x1f9)]===status_enums_1[_0x2eee47(0x1da)][_0x2eee47(0x203)]){const {url:_0x59adac}=_0xcb1eb3;_0xeb359c['push'](_0x59adac);}else throw new veeva_error_1['VeevaError'](_0xcb1eb3['errors']);}return _0xeb359c;}async[a404_0x45c896(0x1f1)](_0x41b2fb){const _0x16476b=a404_0x45c896;this['_logger']['log']('Retrieve\x20Jobs\x20Status');const _0x230ca5=[],_0x507fff=await this['_veevaService'][_0x16476b(0x1d4)](_0x41b2fb);for(const _0x19fa8 of _0x507fff){const _0x3bc430=_0x19fa8[_0x16476b(0x1e3)][_0x16476b(0x217)](_0x881d58=>_0x881d58[_0x16476b(0x200)]===_0x16476b(0x1f8))[_0x16476b(0x1d9)](_0x2a647a=>_0x2a647a[_0x16476b(0x1ed)]);_0x230ca5['push'](..._0x3bc430);}return _0x230ca5;}async[a404_0x45c896(0x1d5)](_0x186e3e){const _0x41014a=a404_0x45c896;var _0x1181e8;const _0x41bf4e=[];this['_logger']['log']('Retrieve\x20Outbound\x20Package\x20zip\x20list');for(const _0x1f0d6e of _0x186e3e){const {data:_0x57478b,headers:_0x39215c}=await this['_connection'][_0x41014a(0x213)](_0x1f0d6e,{'responseType':_0x41014a(0x1e1)}),_0x107db4=(_0x1181e8=_0x39215c[_0x41014a(0x20f)])===null||_0x1181e8===void 0x0?void 0x0:_0x1181e8[_0x41014a(0x1db)]('application/json');if(!_0x107db4){const _0x44f54a=_0x57478b,_0x4fb25b=new jszip_1[(_0x41014a(0x1fb))]();await _0x4fb25b[_0x41014a(0x1eb)](_0x44f54a),_0x41bf4e[_0x41014a(0x1ea)](_0x4fb25b);}else{const _0x2e4d9f=JSON[_0x41014a(0x1d0)](_0x57478b);throw new veeva_error_1[(_0x41014a(0x1f7))](_0x2e4d9f[_0x41014a(0x1de)]);}}return _0x41bf4e;}async[a404_0x45c896(0x1e7)](_0x4454b6){const _0x1d7685=a404_0x45c896;this[_0x1d7685(0x1f0)][_0x1d7685(0x1f6)]('Removing\x20components\x20from\x20outbound\x20packages.');const _0x45ed4a=veeva_constants_1['VeevaConstants'][_0x1d7685(0x20b)]+_0x1d7685(0x1cf);await this[_0x1d7685(0x205)][_0x1d7685(0x1ef)](_0x45ed4a,_0x4454b6);}async[a404_0x45c896(0x1f5)](_0x7c1c2d){const _0x17a7f8=a404_0x45c896;this['_logger']['log'](_0x17a7f8(0x216));const _0x4d1da8=veeva_constants_1[_0x17a7f8(0x1e6)][_0x17a7f8(0x20b)]+'outbound_package__v';await this[_0x17a7f8(0x205)][_0x17a7f8(0x1ef)](_0x4d1da8,_0x7c1c2d);}async[a404_0x45c896(0x20c)](_0x5d6a17,_0x2308b1){const _0xd4e57c=a404_0x45c896,_0x433fa8=await this[_0xd4e57c(0x1ec)](Math[_0xd4e57c(0x1f4)](_0x5d6a17[_0xd4e57c(0x1d8)]/veeva_constants_1[_0xd4e57c(0x1e6)][_0xd4e57c(0x1e2)]),_0x2308b1),_0x4bab2e=await this['createPackageComponents'](_0x5d6a17,_0x433fa8),_0x408e99=await this['getPackageNames'](_0x433fa8),_0x5b31b9=await this[_0xd4e57c(0x1dc)](Array['from'](_0x408e99[_0xd4e57c(0x20a)]())),_0x157a1e=await this['getEndpointArtifactList'](_0x5b31b9),_0x4c421c=await this[_0xd4e57c(0x1d5)](_0x157a1e);return await this[_0xd4e57c(0x1e7)](_0x4bab2e),await this[_0xd4e57c(0x1f5)](_0x433fa8),_0x4c421c;}}function a404_0x283c(_0xb48dfb,_0x50f3e5){const _0x5b0b75=a404_0x2028();return a404_0x283c=function(_0x8ec688,_0x27a36c){_0x8ec688=_0x8ec688-0x1ce;let _0x20287f=_0x5b0b75[_0x8ec688];return _0x20287f;},a404_0x283c(_0xb48dfb,_0x50f3e5);}exports['PackageExportService']=PackageExportService;