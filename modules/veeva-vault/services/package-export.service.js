const a391_0x37a061=a391_0x2389;(function(_0x1f7768,_0x58b825){const _0x12e733=a391_0x2389,_0x64f993=_0x1f7768();while(!![]){try{const _0x31d0a1=-parseInt(_0x12e733(0xcc))/0x1+parseInt(_0x12e733(0xae))/0x2*(-parseInt(_0x12e733(0xaf))/0x3)+parseInt(_0x12e733(0xa8))/0x4+-parseInt(_0x12e733(0x92))/0x5+-parseInt(_0x12e733(0xbe))/0x6+-parseInt(_0x12e733(0x85))/0x7+parseInt(_0x12e733(0x87))/0x8;if(_0x31d0a1===_0x58b825)break;else _0x64f993['push'](_0x64f993['shift']());}catch(_0x1b6ba0){_0x64f993['push'](_0x64f993['shift']());}}}(a391_0x4e10,0x88809));const a391_0x125088=(function(){let _0x59954b=!![];return function(_0x289fe3,_0x1f5950){const _0x409dbd=_0x59954b?function(){const _0x1f35eb=a391_0x2389;if(_0x1f5950){const _0x4b1cd8=_0x1f5950[_0x1f35eb(0xb1)](_0x289fe3,arguments);return _0x1f5950=null,_0x4b1cd8;}}:function(){};return _0x59954b=![],_0x409dbd;};}()),a391_0x4fe797=a391_0x125088(this,function(){const _0xb5d8e1=a391_0x2389;return a391_0x4fe797[_0xb5d8e1(0xbb)]()['search'](_0xb5d8e1(0xca))['toString']()[_0xb5d8e1(0xcb)](a391_0x4fe797)[_0xb5d8e1(0x91)](_0xb5d8e1(0xca));});a391_0x4fe797();'use strict';var __importDefault=this&&this[a391_0x37a061(0xad)]||function(_0xa613d0){const _0xf04c9a=a391_0x37a061;return _0xa613d0&&_0xa613d0[_0xf04c9a(0x99)]?_0xa613d0:{'default':_0xa613d0};};function a391_0x2389(_0x258d2d,_0x3e9817){const _0x1eab57=a391_0x4e10();return a391_0x2389=function(_0x4fe797,_0x125088){_0x4fe797=_0x4fe797-0x83;let _0x4e1068=_0x1eab57[_0x4fe797];return _0x4e1068;},a391_0x2389(_0x258d2d,_0x3e9817);}Object[a391_0x37a061(0xbf)](exports,a391_0x37a061(0x99),{'value':!![]}),exports['PackageExportService']=void 0x0;const veeva_constants_1=require(a391_0x37a061(0x88)),jszip_1=__importDefault(require('jszip')),status_enums_1=require(a391_0x37a061(0xd0)),veeva_error_1=require('../classes/errors/veeva-error');class PackageExportService{constructor({veevaService:_0x179ac6,connection:_0x316fbd,logger:_0x506257}){const _0x37ffbf=a391_0x37a061;this[_0x37ffbf(0xc6)]=_0x179ac6,this[_0x37ffbf(0xb5)]=_0x316fbd,this['_logger']=_0x506257;}async[a391_0x37a061(0x9b)](_0x5aaa99,_0x79bd22){const _0x164ae7=a391_0x37a061;this[_0x164ae7(0xac)][_0x164ae7(0xb8)](_0x164ae7(0xa1));const _0x2deeb2=veeva_constants_1[_0x164ae7(0x95)][_0x164ae7(0xc4)]+_0x164ae7(0x89),_0x177afb=new Array(_0x5aaa99)[_0x164ae7(0xc1)]({'summary__v':_0x79bd22,'object_type__v.api__name__v':_0x164ae7(0xaa)});return await this[_0x164ae7(0xc6)]['createVeevaObjectRecords'](_0x2deeb2,_0x177afb);}async[a391_0x37a061(0x8c)](_0x4be21e,_0x526532){const _0x53bd5e=a391_0x37a061;this[_0x53bd5e(0xac)][_0x53bd5e(0xb8)](_0x53bd5e(0xcf));const _0x45e29a=veeva_constants_1[_0x53bd5e(0x95)][_0x53bd5e(0xc4)]+_0x53bd5e(0x8b),_0x15f7ce=_0x4be21e[_0x53bd5e(0x98)]((_0x1a93ed,_0x1a8590)=>({'vault_component__v':_0x1a93ed['id'],'outbound_package__v':_0x526532[Math[_0x53bd5e(0x97)]((_0x1a8590+0x1)/veeva_constants_1[_0x53bd5e(0x95)][_0x53bd5e(0xb2)])-0x1]}));return await this[_0x53bd5e(0xc6)]['createVeevaObjectRecords'](_0x45e29a,_0x15f7ce);}async['getPackageNames'](_0x2b521d){const _0x15d54f=a391_0x37a061;this[_0x15d54f(0xac)][_0x15d54f(0xb8)](_0x15d54f(0xb6));const _0x3f1f50=_0x15d54f(0x9a)+_0x2b521d[_0x15d54f(0x86)](_0x15d54f(0xc3))+'\x27)',_0x5e113b=await this[_0x15d54f(0xc6)][_0x15d54f(0xc7)](_0x3f1f50);return _0x5e113b[_0x15d54f(0xa0)]((_0x2fcf5e,_0xf6cc5a)=>_0x2fcf5e[_0x15d54f(0x9e)](_0xf6cc5a['id'],_0xf6cc5a[_0x15d54f(0x96)]),new Map());}async[a391_0x37a061(0xcd)](_0x57163e){const _0x2638cf=a391_0x37a061;this[_0x2638cf(0xac)]['log'](_0x2638cf(0xa3));const _0x138f99=[],_0x573c15=_0x57163e[_0x2638cf(0x98)](_0xd86d0e=>{const _0x529c7d=_0x2638cf;return this[_0x529c7d(0xb5)][_0x529c7d(0x9d)](veeva_constants_1[_0x529c7d(0x95)][_0x529c7d(0xa7)],encodeURI(_0x529c7d(0xd1))+'='+encodeURI(_0xd86d0e),{'headers':{'Content-Type':_0x529c7d(0xa4)}});}),_0x492444=await Promise['all'](_0x573c15);for(const {data:_0x4a9707}of _0x492444){if(_0x4a9707[_0x2638cf(0x90)]===status_enums_1[_0x2638cf(0xb3)][_0x2638cf(0xb4)]){const {url:_0xf52d73}=_0x4a9707;_0x138f99[_0x2638cf(0xb0)](_0xf52d73);}else throw new veeva_error_1[(_0x2638cf(0x8d))](_0x4a9707['errors']);}return _0x138f99;}async[a391_0x37a061(0xbc)](_0x26bc54){const _0x3bd718=a391_0x37a061;this[_0x3bd718(0xac)]['log'](_0x3bd718(0xa9));const _0x5ed421=[],_0x33e5e1=await this['_veevaService'][_0x3bd718(0x83)](_0x26bc54);for(const _0x14050a of _0x33e5e1){const _0x49bde8=_0x14050a[_0x3bd718(0xa2)][_0x3bd718(0x93)](_0x390c02=>_0x390c02[_0x3bd718(0xc5)]==='artifacts')[_0x3bd718(0x98)](_0x3a8557=>_0x3a8557[_0x3bd718(0xc0)]);_0x5ed421[_0x3bd718(0xb0)](..._0x49bde8);}return _0x5ed421;}async['retrieveVPKList'](_0xb0832b){const _0x3dd39d=a391_0x37a061;var _0x298a47;const _0x1937cb=[];this[_0x3dd39d(0xac)]['log'](_0x3dd39d(0x8a));for(const _0xbdf84b of _0xb0832b){const {data:_0x24a47b,headers:_0xb3a264}=await this[_0x3dd39d(0xb5)][_0x3dd39d(0xb7)](_0xbdf84b,{'responseType':_0x3dd39d(0xa5)}),_0x177309=(_0x298a47=_0xb3a264['content-type'])===null||_0x298a47===void 0x0?void 0x0:_0x298a47['includes'](_0x3dd39d(0x8e));if(!_0x177309){const _0xdad3a0=_0x24a47b,_0x4cb38f=new jszip_1[(_0x3dd39d(0x8f))]();await _0x4cb38f[_0x3dd39d(0xab)](_0xdad3a0),_0x1937cb[_0x3dd39d(0xb0)](_0x4cb38f);}else{const _0x49deeb=JSON['parse'](_0x24a47b);throw new veeva_error_1[(_0x3dd39d(0x8d))](_0x49deeb[_0x3dd39d(0x94)]);}}return _0x1937cb;}async[a391_0x37a061(0xbd)](_0x16e559){const _0x4ebe05=a391_0x37a061;this[_0x4ebe05(0xac)][_0x4ebe05(0xb8)](_0x4ebe05(0x9f));const _0x2a20e7=veeva_constants_1['VeevaConstants'][_0x4ebe05(0xc4)]+_0x4ebe05(0x8b);await this['_veevaService'][_0x4ebe05(0xce)](_0x2a20e7,_0x16e559);}async[a391_0x37a061(0xa6)](_0x153e0a){const _0x3a7712=a391_0x37a061;this[_0x3a7712(0xac)][_0x3a7712(0xb8)](_0x3a7712(0xc8));const _0x1a8463=veeva_constants_1['VeevaConstants']['ENDPOINT_CREATE_RECORDS']+_0x3a7712(0x89);await this[_0x3a7712(0xc6)][_0x3a7712(0xce)](_0x1a8463,_0x153e0a);}async[a391_0x37a061(0xc9)](_0x5e9872,_0x5dde60){const _0x30eb63=a391_0x37a061,_0x1a470b=await this[_0x30eb63(0x9b)](Math[_0x30eb63(0x97)](_0x5e9872['length']/veeva_constants_1['VeevaConstants'][_0x30eb63(0xb2)]),_0x5dde60),_0x30009f=await this['createPackageComponents'](_0x5e9872,_0x1a470b),_0x1a956d=await this[_0x30eb63(0xba)](_0x1a470b),_0x14810d=await this[_0x30eb63(0xcd)](Array[_0x30eb63(0xb9)](_0x1a956d[_0x30eb63(0x9c)]())),_0x24b36d=await this['getEndpointArtifactList'](_0x14810d),_0x5e38c0=await this[_0x30eb63(0xc2)](_0x24b36d);return await this[_0x30eb63(0xbd)](_0x30009f),await this[_0x30eb63(0xa6)](_0x1a470b),_0x5e38c0;}}function a391_0x4e10(){const _0x57e071=['outbound_package__v','Retrieve\x20Outbound\x20Package\x20zip\x20list','package_component__v','createPackageComponents','VeevaError','application/json','default','responseStatus','search','240600ptivtL','filter','errors','VeevaConstants','name__v','ceil','map','__esModule','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','createOutboundPackages','values','post','set','Removing\x20components\x20from\x20outbound\x20packages.','reduce','Creating\x20outbound\x20packages','links','Create\x20Export\x20outbound\x20packages.','application/x-www-form-urlencoded','arraybuffer','deleteOutboundPackages','ENDPOINT_EXPORT_IMPORT_PACKAGE','1549772wXdLdz','Retrieve\x20Jobs\x20Status','migration__sys','loadAsync','_logger','__importDefault','26KMgdxO','89877TelMIF','push','apply','MAXIMUM_SIZE_OF_PACKAGE','VeevaResponseStatus','SUCCESS','_connection','Getting\x20names\x20of\x20outbound\x20packages','get','log','from','getPackageNames','toString','getEndpointArtifactList','deletePackageComponents','2379354CrHxEb','defineProperty','href','fill','retrieveVPKList','\x27,\x27','ENDPOINT_CREATE_RECORDS','rel','_veevaService','executeVQL','Deleting\x20outbound\x20packages.','export','(((.+)+)+)+$','constructor','389560gPqAKL','createExportOutboundPackages','deleteVeevaObjectRecords','Adding\x20components\x20to\x20outbound\x20package','../enums/status.enums','packageName','getJobResult','PackageExportService','5653088KSBqKt','join','17623680BEFbZF','../constants/veeva.constants'];a391_0x4e10=function(){return _0x57e071;};return a391_0x4e10();}exports[a391_0x37a061(0x84)]=PackageExportService;