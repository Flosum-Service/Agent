function a335_0x2228(){const _0x40b016=['constructor','_veevaService','../enums/status.enums','log','6993455lDHWNE','getPackageNames','responseStatus','VeevaConstants','PackageExportService','packageName','668817HCkAZG','errors','Retrieve\x20Jobs\x20Status','../constants/veeva.constants','ENDPOINT_VQL','artifacts','3351030xaKkhA','fill','Creating\x20outbound\x20packages','search','MAXIMUM_SIZE_OF_PACKAGE','defineProperty','set','VeevaError','deletePackageComponents','application/x-www-form-urlencoded','2HeLWVY','from','Create\x20Export\x20outbound\x20packages.','Getting\x20names\x20of\x20outbound\x20packages','__esModule','all','3843168fiHTQm','migration__sys','../classes/errors/veeva-error','parse','getEndpointArtifactList','name__v','toString','content-type','post','retrieveVPKList','application/json','ceil','Removing\x20components\x20from\x20outbound\x20packages.','ENDPOINT_CREATE_RECORDS','__importDefault','_logger','6Eigwlz','getJobResult','length','package_component__v','push','Adding\x20components\x20to\x20outbound\x20package','createVeevaObjectRecords','deleteVeevaObjectRecords','SUCCESS','9281020RwyhUn','VeevaResponseStatus','deleteOutboundPackages','map','ENDPOINT_EXPORT_IMPORT_PACKAGE','executeVQL','1839740cVsjJX','789899yBLblZ','default','outbound_package__v','createOutboundPackages','export','createPackageComponents','includes','_connection','jszip','(((.+)+)+)+$'];a335_0x2228=function(){return _0x40b016;};return a335_0x2228();}const a335_0x23bb1c=a335_0x3fec;function a335_0x3fec(_0x3c2baf,_0x21d10f){const _0x506704=a335_0x2228();return a335_0x3fec=function(_0x3e7b0e,_0x5e1843){_0x3e7b0e=_0x3e7b0e-0x1e1;let _0x22287a=_0x506704[_0x3e7b0e];return _0x22287a;},a335_0x3fec(_0x3c2baf,_0x21d10f);}(function(_0xf2496a,_0x361877){const _0x262c92=a335_0x3fec,_0x4d637a=_0xf2496a();while(!![]){try{const _0x331428=parseInt(_0x262c92(0x1e4))/0x1*(-parseInt(_0x262c92(0x208))/0x2)+-parseInt(_0x262c92(0x1fe))/0x3+parseInt(_0x262c92(0x1e3))/0x4+-parseInt(_0x262c92(0x1f2))/0x5*(-parseInt(_0x262c92(0x21e))/0x6)+parseInt(_0x262c92(0x227))/0x7+-parseInt(_0x262c92(0x20e))/0x8+parseInt(_0x262c92(0x1f8))/0x9;if(_0x331428===_0x361877)break;else _0x4d637a['push'](_0x4d637a['shift']());}catch(_0x2eca3f){_0x4d637a['push'](_0x4d637a['shift']());}}}(a335_0x2228,0xd4c46));const a335_0x5e1843=(function(){let _0x2d95c6=!![];return function(_0x31fa23,_0x3922ef){const _0x4675ce=_0x2d95c6?function(){if(_0x3922ef){const _0x3c855a=_0x3922ef['apply'](_0x31fa23,arguments);return _0x3922ef=null,_0x3c855a;}}:function(){};return _0x2d95c6=![],_0x4675ce;};}()),a335_0x3e7b0e=a335_0x5e1843(this,function(){const _0x373aa0=a335_0x3fec;return a335_0x3e7b0e['toString']()[_0x373aa0(0x201)](_0x373aa0(0x1ed))[_0x373aa0(0x214)]()[_0x373aa0(0x1ee)](a335_0x3e7b0e)[_0x373aa0(0x201)](_0x373aa0(0x1ed));});a335_0x3e7b0e();'use strict';var __importDefault=this&&this[a335_0x23bb1c(0x21c)]||function(_0x3245c4){const _0x4db5d6=a335_0x23bb1c;return _0x3245c4&&_0x3245c4[_0x4db5d6(0x20c)]?_0x3245c4:{'default':_0x3245c4};};Object[a335_0x23bb1c(0x203)](exports,a335_0x23bb1c(0x20c),{'value':!![]}),exports[a335_0x23bb1c(0x1f6)]=void 0x0;const veeva_constants_1=require(a335_0x23bb1c(0x1fb)),jszip_1=__importDefault(require(a335_0x23bb1c(0x1ec))),status_enums_1=require(a335_0x23bb1c(0x1f0)),veeva_error_1=require(a335_0x23bb1c(0x210));class PackageExportService{constructor({veevaService:_0x36d672,connection:_0x174a18,logger:_0x221b6d}){const _0x233c3e=a335_0x23bb1c;this[_0x233c3e(0x1ef)]=_0x36d672,this['_connection']=_0x174a18,this[_0x233c3e(0x21d)]=_0x221b6d;}async[a335_0x23bb1c(0x1e7)](_0x2f8d19,_0xd796d9){const _0x28b574=a335_0x23bb1c;this[_0x28b574(0x21d)][_0x28b574(0x1f1)](_0x28b574(0x200));const _0x15d808=veeva_constants_1['VeevaConstants'][_0x28b574(0x21b)]+_0x28b574(0x1e6),_0x20c85a=new Array(_0x2f8d19)[_0x28b574(0x1ff)]({'summary__v':_0xd796d9,'object_type__v.api__name__v':_0x28b574(0x20f)});return await this[_0x28b574(0x1ef)][_0x28b574(0x224)](_0x15d808,_0x20c85a);}async[a335_0x23bb1c(0x1e9)](_0x542203,_0x127378){const _0x30ad48=a335_0x23bb1c;this['_logger'][_0x30ad48(0x1f1)](_0x30ad48(0x223));const _0x5a5bee=veeva_constants_1[_0x30ad48(0x1f5)][_0x30ad48(0x21b)]+_0x30ad48(0x221),_0x15c082=_0x542203[_0x30ad48(0x22a)]((_0x15b3cc,_0x8b4baa)=>({'vault_component__v':_0x15b3cc['id'],'outbound_package__v':_0x127378[Math[_0x30ad48(0x219)]((_0x8b4baa+0x1)/veeva_constants_1[_0x30ad48(0x1f5)][_0x30ad48(0x202)])-0x1]}));return await this[_0x30ad48(0x1ef)]['createVeevaObjectRecords'](_0x5a5bee,_0x15c082);}async[a335_0x23bb1c(0x1f3)](_0x24fd06){const _0x4ebbc3=a335_0x23bb1c;this[_0x4ebbc3(0x21d)][_0x4ebbc3(0x1f1)](_0x4ebbc3(0x20b));const _0x5cd5e3='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x24fd06['join']('\x27,\x27')+'\x27)',_0x170f80=veeva_constants_1[_0x4ebbc3(0x1f5)][_0x4ebbc3(0x1fc)]+_0x5cd5e3,_0x425f90=await this[_0x4ebbc3(0x1ef)][_0x4ebbc3(0x1e2)](_0x170f80);return _0x425f90['reduce']((_0x5777f9,_0x400ba6)=>_0x5777f9[_0x4ebbc3(0x204)](_0x400ba6['id'],_0x400ba6[_0x4ebbc3(0x213)]),new Map());}async['createExportOutboundPackages'](_0x118d4d){const _0x500642=a335_0x23bb1c;this['_logger'][_0x500642(0x1f1)](_0x500642(0x20a));const _0x8aab55=[],_0x295313=_0x118d4d[_0x500642(0x22a)](_0x405a79=>{const _0x3bdc8c=_0x500642;return this['_connection'][_0x3bdc8c(0x216)](veeva_constants_1[_0x3bdc8c(0x1f5)][_0x3bdc8c(0x1e1)],encodeURI(_0x3bdc8c(0x1f7))+'='+encodeURI(_0x405a79),{'headers':{'Content-Type':_0x3bdc8c(0x207)}});}),_0x22f75a=await Promise[_0x500642(0x20d)](_0x295313);for(const {data:_0x1892ba}of _0x22f75a){if(_0x1892ba[_0x500642(0x1f4)]===status_enums_1[_0x500642(0x228)][_0x500642(0x226)]){const {url:_0x2b90ea}=_0x1892ba;_0x8aab55[_0x500642(0x222)](_0x2b90ea);}else throw new veeva_error_1[(_0x500642(0x205))](_0x1892ba[_0x500642(0x1f9)]);}return _0x8aab55;}async[a335_0x23bb1c(0x212)](_0x3c7ab5){const _0x2f4aff=a335_0x23bb1c;this['_logger'][_0x2f4aff(0x1f1)](_0x2f4aff(0x1fa));const _0x1a3e23=[],_0x2d3ee0=await this[_0x2f4aff(0x1ef)][_0x2f4aff(0x21f)](_0x3c7ab5);for(const _0x9a01d2 of _0x2d3ee0){const _0x3494f9=_0x9a01d2['links']['filter'](_0x671fdc=>_0x671fdc['rel']===_0x2f4aff(0x1fd))[_0x2f4aff(0x22a)](_0x42e544=>_0x42e544['href']);_0x1a3e23[_0x2f4aff(0x222)](..._0x3494f9);}return _0x1a3e23;}async[a335_0x23bb1c(0x217)](_0x3d05e0){const _0x3e359a=a335_0x23bb1c;var _0x395492;const _0x2bb718=[];this['_logger'][_0x3e359a(0x1f1)]('Retrieve\x20Outbound\x20Package\x20zip\x20list');for(const _0x35b724 of _0x3d05e0){const {data:_0x1cd8da,headers:_0x50d79d}=await this[_0x3e359a(0x1eb)]['get'](_0x35b724,{'responseType':'arraybuffer'}),_0xed0569=(_0x395492=_0x50d79d[_0x3e359a(0x215)])===null||_0x395492===void 0x0?void 0x0:_0x395492[_0x3e359a(0x1ea)](_0x3e359a(0x218));if(!_0xed0569){const _0x8a1952=_0x1cd8da,_0x2c8c6f=new jszip_1[(_0x3e359a(0x1e5))]();await _0x2c8c6f['loadAsync'](_0x8a1952),_0x2bb718[_0x3e359a(0x222)](_0x2c8c6f);}else{const _0x1c0054=JSON[_0x3e359a(0x211)](_0x1cd8da);throw new veeva_error_1[(_0x3e359a(0x205))](_0x1c0054[_0x3e359a(0x1f9)]);}}return _0x2bb718;}async[a335_0x23bb1c(0x206)](_0x8028e2){const _0x584650=a335_0x23bb1c;this[_0x584650(0x21d)][_0x584650(0x1f1)](_0x584650(0x21a));const _0x3ad7db=veeva_constants_1[_0x584650(0x1f5)][_0x584650(0x21b)]+_0x584650(0x221);await this[_0x584650(0x1ef)][_0x584650(0x225)](_0x3ad7db,_0x8028e2);}async[a335_0x23bb1c(0x229)](_0x1e036e){const _0x409815=a335_0x23bb1c;this[_0x409815(0x21d)][_0x409815(0x1f1)]('Deleting\x20outbound\x20packages.');const _0xec66e0=veeva_constants_1[_0x409815(0x1f5)][_0x409815(0x21b)]+_0x409815(0x1e6);await this[_0x409815(0x1ef)][_0x409815(0x225)](_0xec66e0,_0x1e036e);}async[a335_0x23bb1c(0x1e8)](_0x51be51,_0x31bf8d){const _0x1835f6=a335_0x23bb1c,_0x2b672e=await this['createOutboundPackages'](Math[_0x1835f6(0x219)](_0x51be51[_0x1835f6(0x220)]/veeva_constants_1[_0x1835f6(0x1f5)][_0x1835f6(0x202)]),_0x31bf8d),_0x111151=await this[_0x1835f6(0x1e9)](_0x51be51,_0x2b672e),_0x719535=await this[_0x1835f6(0x1f3)](_0x2b672e),_0x3bc4f2=await this['createExportOutboundPackages'](Array[_0x1835f6(0x209)](_0x719535['values']())),_0x2c4b10=await this[_0x1835f6(0x212)](_0x3bc4f2),_0xe26caf=await this[_0x1835f6(0x217)](_0x2c4b10);return await this[_0x1835f6(0x206)](_0x111151),await this['deleteOutboundPackages'](_0x2b672e),_0xe26caf;}}exports[a335_0x23bb1c(0x1f6)]=PackageExportService;