function a359_0x12a5(_0x45fa44,_0x8f4f){const _0x4d15c2=a359_0x5139();return a359_0x12a5=function(_0x53bcbd,_0x3c98e2){_0x53bcbd=_0x53bcbd-0x122;let _0x5139e4=_0x4d15c2[_0x53bcbd];return _0x5139e4;},a359_0x12a5(_0x45fa44,_0x8f4f);}const a359_0x5af1ef=a359_0x12a5;(function(_0x3c99d5,_0x5c18b5){const _0x48e1b8=a359_0x12a5,_0x404bfb=_0x3c99d5();while(!![]){try{const _0x4908f6=-parseInt(_0x48e1b8(0x148))/0x1+-parseInt(_0x48e1b8(0x122))/0x2+parseInt(_0x48e1b8(0x163))/0x3*(-parseInt(_0x48e1b8(0x129))/0x4)+-parseInt(_0x48e1b8(0x161))/0x5*(-parseInt(_0x48e1b8(0x167))/0x6)+-parseInt(_0x48e1b8(0x14d))/0x7+-parseInt(_0x48e1b8(0x140))/0x8+parseInt(_0x48e1b8(0x123))/0x9;if(_0x4908f6===_0x5c18b5)break;else _0x404bfb['push'](_0x404bfb['shift']());}catch(_0x45c424){_0x404bfb['push'](_0x404bfb['shift']());}}}(a359_0x5139,0xe33db));const a359_0x3c98e2=(function(){let _0x22fd37=!![];return function(_0x1a3ea8,_0x50066d){const _0x8cf380=_0x22fd37?function(){const _0x3b0a66=a359_0x12a5;if(_0x50066d){const _0x501056=_0x50066d[_0x3b0a66(0x156)](_0x1a3ea8,arguments);return _0x50066d=null,_0x501056;}}:function(){};return _0x22fd37=![],_0x8cf380;};}()),a359_0x53bcbd=a359_0x3c98e2(this,function(){const _0x31b312=a359_0x12a5;return a359_0x53bcbd[_0x31b312(0x14f)]()[_0x31b312(0x127)]('(((.+)+)+)+$')[_0x31b312(0x14f)]()['constructor'](a359_0x53bcbd)[_0x31b312(0x127)](_0x31b312(0x125));});a359_0x53bcbd();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x14549b){const _0x320979=a359_0x12a5;return _0x14549b&&_0x14549b[_0x320979(0x169)]?_0x14549b:{'default':_0x14549b};};function a359_0x5139(){const _0x3c7512=['3060076kVgiUP','34424397bezJkm','executeVQL','(((.+)+)+)+$','post','search','rel','16XgyUWX','reduce','errors','../constants/veeva.constants','application/x-www-form-urlencoded','Adding\x20components\x20to\x20outbound\x20package','MAXIMUM_SIZE_OF_PACKAGE','log','links','join','outbound_package__v','deletePackageComponents','createVeevaObjectRecords','Creating\x20outbound\x20packages','VeevaConstants','from','VeevaError','../classes/errors/veeva-error','retrieveVPKList','createPackageComponents','PackageExportService','includes','_connection','3119040HiqumI','map','export','getEndpointArtifactList','filter','ceil','_veevaService','push','902571cmrKOI','all','parse','VeevaResponseStatus','Create\x20Export\x20outbound\x20packages.','11751411XTKOKk','application/json','toString','createExportOutboundPackages','fill','deleteOutboundPackages','get','Getting\x20names\x20of\x20outbound\x20packages','SUCCESS','apply','createOutboundPackages','loadAsync','deleteVeevaObjectRecords','defineProperty','responseStatus','Retrieve\x20Outbound\x20Package\x20zip\x20list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','values','set','_logger','14195lGEEam','artifacts','46668DWehSb','getPackageNames','Retrieve\x20Jobs\x20Status','default','3528tetKIY','jszip','__esModule','href','package_component__v','ENDPOINT_CREATE_RECORDS'];a359_0x5139=function(){return _0x3c7512;};return a359_0x5139();}Object[a359_0x5af1ef(0x15a)](exports,a359_0x5af1ef(0x169),{'value':!![]}),exports[a359_0x5af1ef(0x13d)]=void 0x0;const veeva_constants_1=require(a359_0x5af1ef(0x12c)),jszip_1=__importDefault(require(a359_0x5af1ef(0x168))),status_enums_1=require('../enums/status.enums'),veeva_error_1=require(a359_0x5af1ef(0x13a));class PackageExportService{constructor({veevaService:_0x1e0190,connection:_0x3b6901,logger:_0x3e73a2}){const _0x230d19=a359_0x5af1ef;this[_0x230d19(0x146)]=_0x1e0190,this[_0x230d19(0x13f)]=_0x3b6901,this[_0x230d19(0x160)]=_0x3e73a2;}async[a359_0x5af1ef(0x157)](_0x40b54d,_0x3374f1){const _0xb15440=a359_0x5af1ef;this[_0xb15440(0x160)][_0xb15440(0x130)](_0xb15440(0x136));const _0xbc6529=veeva_constants_1[_0xb15440(0x137)]['ENDPOINT_CREATE_RECORDS']+_0xb15440(0x133),_0x517c3e=new Array(_0x40b54d)[_0xb15440(0x151)]({'summary__v':_0x3374f1,'object_type__v.api__name__v':'migration__sys'});return await this[_0xb15440(0x146)][_0xb15440(0x135)](_0xbc6529,_0x517c3e);}async[a359_0x5af1ef(0x13c)](_0x68ed49,_0x2048a6){const _0x89cc8a=a359_0x5af1ef;this[_0x89cc8a(0x160)]['log'](_0x89cc8a(0x12e));const _0x3b6948=veeva_constants_1[_0x89cc8a(0x137)][_0x89cc8a(0x16c)]+_0x89cc8a(0x16b),_0xd3cee2=_0x68ed49[_0x89cc8a(0x141)]((_0x3aca0a,_0x4d10af)=>({'vault_component__v':_0x3aca0a['id'],'outbound_package__v':_0x2048a6[Math[_0x89cc8a(0x145)]((_0x4d10af+0x1)/veeva_constants_1[_0x89cc8a(0x137)][_0x89cc8a(0x12f)])-0x1]}));return await this[_0x89cc8a(0x146)][_0x89cc8a(0x135)](_0x3b6948,_0xd3cee2);}async[a359_0x5af1ef(0x164)](_0x36c69d){const _0x2f0d3b=a359_0x5af1ef;this[_0x2f0d3b(0x160)][_0x2f0d3b(0x130)](_0x2f0d3b(0x154));const _0x5796c3=_0x2f0d3b(0x15d)+_0x36c69d[_0x2f0d3b(0x132)]('\x27,\x27')+'\x27)',_0xe76e1c=await this[_0x2f0d3b(0x146)][_0x2f0d3b(0x124)](_0x5796c3);return _0xe76e1c[_0x2f0d3b(0x12a)]((_0x2eaf38,_0x21de3d)=>_0x2eaf38[_0x2f0d3b(0x15f)](_0x21de3d['id'],_0x21de3d['name__v']),new Map());}async['createExportOutboundPackages'](_0x32f9c4){const _0x95ed0=a359_0x5af1ef;this[_0x95ed0(0x160)][_0x95ed0(0x130)](_0x95ed0(0x14c));const _0x804232=[],_0x23ba39=_0x32f9c4[_0x95ed0(0x141)](_0x138bc6=>{const _0x24a45a=_0x95ed0;return this['_connection'][_0x24a45a(0x126)](veeva_constants_1[_0x24a45a(0x137)]['ENDPOINT_EXPORT_IMPORT_PACKAGE'],encodeURI('packageName')+'='+encodeURI(_0x138bc6),{'headers':{'Content-Type':_0x24a45a(0x12d)}});}),_0x52c187=await Promise[_0x95ed0(0x149)](_0x23ba39);for(const {data:_0x5dfdf0}of _0x52c187){if(_0x5dfdf0[_0x95ed0(0x15b)]===status_enums_1[_0x95ed0(0x14b)][_0x95ed0(0x155)]){const {url:_0x29579b}=_0x5dfdf0;_0x804232[_0x95ed0(0x147)](_0x29579b);}else throw new veeva_error_1[(_0x95ed0(0x139))](_0x5dfdf0['errors']);}return _0x804232;}async[a359_0x5af1ef(0x143)](_0x94ad82){const _0x43e85f=a359_0x5af1ef;this['_logger'][_0x43e85f(0x130)](_0x43e85f(0x165));const _0x34819e=[],_0x5025cc=await this['_veevaService']['getJobResult'](_0x94ad82);for(const _0x3c4c62 of _0x5025cc){const _0x5bf4a6=_0x3c4c62[_0x43e85f(0x131)][_0x43e85f(0x144)](_0x183c82=>_0x183c82[_0x43e85f(0x128)]===_0x43e85f(0x162))['map'](_0x347da1=>_0x347da1[_0x43e85f(0x16a)]);_0x34819e[_0x43e85f(0x147)](..._0x5bf4a6);}return _0x34819e;}async[a359_0x5af1ef(0x13b)](_0x3f0743){const _0x1f0f01=a359_0x5af1ef;var _0x4fffa4;const _0x147b59=[];this[_0x1f0f01(0x160)][_0x1f0f01(0x130)](_0x1f0f01(0x15c));for(const _0x207ebb of _0x3f0743){const {data:_0x3bfbe4,headers:_0x1e49e5}=await this[_0x1f0f01(0x13f)][_0x1f0f01(0x153)](_0x207ebb,{'responseType':'arraybuffer'}),_0xc2eec4=(_0x4fffa4=_0x1e49e5['content-type'])===null||_0x4fffa4===void 0x0?void 0x0:_0x4fffa4[_0x1f0f01(0x13e)](_0x1f0f01(0x14e));if(!_0xc2eec4){const _0x8d5f68=_0x3bfbe4,_0x145d06=new jszip_1[(_0x1f0f01(0x166))]();await _0x145d06[_0x1f0f01(0x158)](_0x8d5f68),_0x147b59[_0x1f0f01(0x147)](_0x145d06);}else{const _0x31df4e=JSON[_0x1f0f01(0x14a)](_0x3bfbe4);throw new veeva_error_1['VeevaError'](_0x31df4e[_0x1f0f01(0x12b)]);}}return _0x147b59;}async[a359_0x5af1ef(0x134)](_0x11b9af){const _0x22a244=a359_0x5af1ef;this[_0x22a244(0x160)][_0x22a244(0x130)]('Removing\x20components\x20from\x20outbound\x20packages.');const _0x570a7d=veeva_constants_1[_0x22a244(0x137)]['ENDPOINT_CREATE_RECORDS']+'package_component__v';await this[_0x22a244(0x146)]['deleteVeevaObjectRecords'](_0x570a7d,_0x11b9af);}async[a359_0x5af1ef(0x152)](_0x483db2){const _0xcbece1=a359_0x5af1ef;this[_0xcbece1(0x160)][_0xcbece1(0x130)]('Deleting\x20outbound\x20packages.');const _0x2bd0fa=veeva_constants_1[_0xcbece1(0x137)][_0xcbece1(0x16c)]+'outbound_package__v';await this[_0xcbece1(0x146)][_0xcbece1(0x159)](_0x2bd0fa,_0x483db2);}async[a359_0x5af1ef(0x142)](_0x84d61d,_0x31756f){const _0x2c8482=a359_0x5af1ef,_0x53b3a9=await this['createOutboundPackages'](Math[_0x2c8482(0x145)](_0x84d61d['length']/veeva_constants_1[_0x2c8482(0x137)][_0x2c8482(0x12f)]),_0x31756f),_0xfa41c0=await this['createPackageComponents'](_0x84d61d,_0x53b3a9),_0x5d1064=await this[_0x2c8482(0x164)](_0x53b3a9),_0x221477=await this[_0x2c8482(0x150)](Array[_0x2c8482(0x138)](_0x5d1064[_0x2c8482(0x15e)]())),_0xf5db70=await this[_0x2c8482(0x143)](_0x221477),_0x3f5df4=await this['retrieveVPKList'](_0xf5db70);return await this[_0x2c8482(0x134)](_0xfa41c0),await this['deleteOutboundPackages'](_0x53b3a9),_0x3f5df4;}}exports[a359_0x5af1ef(0x13d)]=PackageExportService;