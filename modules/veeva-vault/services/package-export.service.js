const a402_0x1ce6ba=a402_0x3f2c;(function(_0x5acd66,_0xe67609){const _0x271033=a402_0x3f2c,_0x4993f0=_0x5acd66();while(!![]){try{const _0x529666=parseInt(_0x271033(0x123))/0x1+parseInt(_0x271033(0x135))/0x2*(-parseInt(_0x271033(0xfe))/0x3)+parseInt(_0x271033(0x11a))/0x4*(-parseInt(_0x271033(0x131))/0x5)+-parseInt(_0x271033(0x118))/0x6*(parseInt(_0x271033(0xf8))/0x7)+parseInt(_0x271033(0x106))/0x8+parseInt(_0x271033(0x119))/0x9+parseInt(_0x271033(0x13c))/0xa;if(_0x529666===_0xe67609)break;else _0x4993f0['push'](_0x4993f0['shift']());}catch(_0x5628cd){_0x4993f0['push'](_0x4993f0['shift']());}}}(a402_0x2a66,0x59bf9));const a402_0x4fc50d=(function(){let _0x55b77a=!![];return function(_0x47fb11,_0x359fb3){const _0x5467f3=_0x55b77a?function(){const _0x46d732=a402_0x3f2c;if(_0x359fb3){const _0x5cfdb2=_0x359fb3[_0x46d732(0x133)](_0x47fb11,arguments);return _0x359fb3=null,_0x5cfdb2;}}:function(){};return _0x55b77a=![],_0x5467f3;};}()),a402_0xc27475=a402_0x4fc50d(this,function(){const _0x25d0f6=a402_0x3f2c;return a402_0xc27475[_0x25d0f6(0x103)]()[_0x25d0f6(0x12b)]('(((.+)+)+)+$')[_0x25d0f6(0x103)]()[_0x25d0f6(0x12c)](a402_0xc27475)[_0x25d0f6(0x12b)](_0x25d0f6(0x110));});a402_0xc27475();'use strict';function a402_0x2a66(){const _0x55d152=['42530pMNjJZ','ENDPOINT_CREATE_RECORDS','apply','post','148kXAgVF','deletePackageComponents','createPackageComponents','jszip','arraybuffer','PackageExportService','values','10907400vNKTWd','../enums/status.enums','includes','log','1675303cMDgYp','createVeevaObjectRecords','get','links','MAXIMUM_SIZE_OF_PACKAGE','all','24459HrlHiW','ceil','push','SUCCESS','getEndpointArtifactList','toString','getJobResult','parse','1136520jdHvMO','migration__sys','deleteOutboundPackages','Creating\x20outbound\x20packages','VeevaError','createOutboundPackages','VeevaConstants','_veevaService','Deleting\x20outbound\x20packages.','__esModule','(((.+)+)+)+$','Getting\x20names\x20of\x20outbound\x20packages','errors','default','packageName','ENDPOINT_EXPORT_IMPORT_PACKAGE','reduce','_connection','6ANjcAS','2169945ahFsUC','192UuyKVE','_logger','\x27,\x27','deleteVeevaObjectRecords','rel','../constants/veeva.constants','map','retrieveVPKList','outbound_package__v','144638MqFjqH','package_component__v','executeVQL','Retrieve\x20Jobs\x20Status','content-type','set','createExportOutboundPackages','export','search','constructor','getPackageNames','responseStatus','join','name__v'];a402_0x2a66=function(){return _0x55d152;};return a402_0x2a66();}var __importDefault=this&&this['__importDefault']||function(_0x4dbb2a){const _0x587bd7=a402_0x3f2c;return _0x4dbb2a&&_0x4dbb2a[_0x587bd7(0x10f)]?_0x4dbb2a:{'default':_0x4dbb2a};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a402_0x1ce6ba(0x13a)]=void 0x0;const veeva_constants_1=require(a402_0x1ce6ba(0x11f)),jszip_1=__importDefault(require(a402_0x1ce6ba(0x138))),status_enums_1=require(a402_0x1ce6ba(0x13d)),veeva_error_1=require('../classes/errors/veeva-error');class PackageExportService{constructor({veevaService:_0x104a34,connection:_0x375930,logger:_0x3eb98b}){const _0x4acac2=a402_0x1ce6ba;this[_0x4acac2(0x10d)]=_0x104a34,this[_0x4acac2(0x117)]=_0x375930,this[_0x4acac2(0x11b)]=_0x3eb98b;}async[a402_0x1ce6ba(0x10b)](_0x5d426f,_0x33b936){const _0x56108d=a402_0x1ce6ba;this[_0x56108d(0x11b)][_0x56108d(0x13f)](_0x56108d(0x109));const _0x2c7583=veeva_constants_1[_0x56108d(0x10c)][_0x56108d(0x132)]+_0x56108d(0x122),_0xd7fb83=new Array(_0x5d426f)['fill']({'summary__v':_0x33b936,'object_type__v.api__name__v':_0x56108d(0x107)});return await this[_0x56108d(0x10d)]['createVeevaObjectRecords'](_0x2c7583,_0xd7fb83);}async[a402_0x1ce6ba(0x137)](_0x363f65,_0x12d921){const _0x199f48=a402_0x1ce6ba;this[_0x199f48(0x11b)][_0x199f48(0x13f)]('Adding\x20components\x20to\x20outbound\x20package');const _0xe225b4=veeva_constants_1[_0x199f48(0x10c)][_0x199f48(0x132)]+_0x199f48(0x124),_0x2e76c2=_0x363f65[_0x199f48(0x120)]((_0x2740be,_0x6a75a7)=>({'vault_component__v':_0x2740be['id'],'outbound_package__v':_0x12d921[Math[_0x199f48(0xff)]((_0x6a75a7+0x1)/veeva_constants_1[_0x199f48(0x10c)][_0x199f48(0xfc)])-0x1]}));return await this[_0x199f48(0x10d)][_0x199f48(0xf9)](_0xe225b4,_0x2e76c2);}async['getPackageNames'](_0x35c2c5){const _0x5ad9f1=a402_0x1ce6ba;this['_logger'][_0x5ad9f1(0x13f)](_0x5ad9f1(0x111));const _0x46c38b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x35c2c5[_0x5ad9f1(0x12f)](_0x5ad9f1(0x11c))+'\x27)',_0x3484d0=await this[_0x5ad9f1(0x10d)][_0x5ad9f1(0x125)](_0x46c38b);return _0x3484d0[_0x5ad9f1(0x116)]((_0x378e88,_0x514a77)=>_0x378e88[_0x5ad9f1(0x128)](_0x514a77['id'],_0x514a77[_0x5ad9f1(0x130)]),new Map());}async[a402_0x1ce6ba(0x129)](_0xab5744){const _0x1e08ab=a402_0x1ce6ba;this[_0x1e08ab(0x11b)][_0x1e08ab(0x13f)]('Create\x20Export\x20outbound\x20packages.');const _0x393e5b=[],_0x2c33d1=_0xab5744[_0x1e08ab(0x120)](_0x48594b=>{const _0x45a395=_0x1e08ab;return this['_connection'][_0x45a395(0x134)](veeva_constants_1[_0x45a395(0x10c)][_0x45a395(0x115)],encodeURI(_0x45a395(0x114))+'='+encodeURI(_0x48594b),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0x1ee814=await Promise[_0x1e08ab(0xfd)](_0x2c33d1);for(const {data:_0xb4552}of _0x1ee814){if(_0xb4552[_0x1e08ab(0x12e)]===status_enums_1['VeevaResponseStatus'][_0x1e08ab(0x101)]){const {url:_0x58c11d}=_0xb4552;_0x393e5b[_0x1e08ab(0x100)](_0x58c11d);}else throw new veeva_error_1['VeevaError'](_0xb4552[_0x1e08ab(0x112)]);}return _0x393e5b;}async[a402_0x1ce6ba(0x102)](_0x48b8c3){const _0x593730=a402_0x1ce6ba;this[_0x593730(0x11b)][_0x593730(0x13f)](_0x593730(0x126));const _0x58c6db=[],_0x37479b=await this[_0x593730(0x10d)][_0x593730(0x104)](_0x48b8c3);for(const _0x42b45d of _0x37479b){const _0x459115=_0x42b45d[_0x593730(0xfb)]['filter'](_0x4a4893=>_0x4a4893[_0x593730(0x11e)]==='artifacts')['map'](_0x11e528=>_0x11e528['href']);_0x58c6db[_0x593730(0x100)](..._0x459115);}return _0x58c6db;}async[a402_0x1ce6ba(0x121)](_0x46a2f7){const _0x1ada0d=a402_0x1ce6ba;var _0x1069b8;const _0x4037a6=[];this[_0x1ada0d(0x11b)][_0x1ada0d(0x13f)]('Retrieve\x20Outbound\x20Package\x20zip\x20list');for(const _0x553c01 of _0x46a2f7){const {data:_0x12d2f3,headers:_0x16dfc9}=await this[_0x1ada0d(0x117)][_0x1ada0d(0xfa)](_0x553c01,{'responseType':_0x1ada0d(0x139)}),_0x2beb48=(_0x1069b8=_0x16dfc9[_0x1ada0d(0x127)])===null||_0x1069b8===void 0x0?void 0x0:_0x1069b8[_0x1ada0d(0x13e)]('application/json');if(!_0x2beb48){const _0x386025=_0x12d2f3,_0x70e55e=new jszip_1[(_0x1ada0d(0x113))]();await _0x70e55e['loadAsync'](_0x386025),_0x4037a6[_0x1ada0d(0x100)](_0x70e55e);}else{const _0x3bb75d=JSON[_0x1ada0d(0x105)](_0x12d2f3);throw new veeva_error_1[(_0x1ada0d(0x10a))](_0x3bb75d['errors']);}}return _0x4037a6;}async[a402_0x1ce6ba(0x136)](_0x4da5e8){const _0x3b55e7=a402_0x1ce6ba;this[_0x3b55e7(0x11b)][_0x3b55e7(0x13f)]('Removing\x20components\x20from\x20outbound\x20packages.');const _0x3ef9b5=veeva_constants_1[_0x3b55e7(0x10c)]['ENDPOINT_CREATE_RECORDS']+_0x3b55e7(0x124);await this[_0x3b55e7(0x10d)][_0x3b55e7(0x11d)](_0x3ef9b5,_0x4da5e8);}async[a402_0x1ce6ba(0x108)](_0x731786){const _0x1ca4f8=a402_0x1ce6ba;this['_logger'][_0x1ca4f8(0x13f)](_0x1ca4f8(0x10e));const _0x2c9dba=veeva_constants_1[_0x1ca4f8(0x10c)][_0x1ca4f8(0x132)]+'outbound_package__v';await this[_0x1ca4f8(0x10d)][_0x1ca4f8(0x11d)](_0x2c9dba,_0x731786);}async[a402_0x1ce6ba(0x12a)](_0x17d257,_0x561d61){const _0x1ed77b=a402_0x1ce6ba,_0x429688=await this[_0x1ed77b(0x10b)](Math['ceil'](_0x17d257['length']/veeva_constants_1[_0x1ed77b(0x10c)][_0x1ed77b(0xfc)]),_0x561d61),_0x4fcd5d=await this[_0x1ed77b(0x137)](_0x17d257,_0x429688),_0x560b14=await this[_0x1ed77b(0x12d)](_0x429688),_0x20c970=await this[_0x1ed77b(0x129)](Array['from'](_0x560b14[_0x1ed77b(0x13b)]())),_0x1befbb=await this['getEndpointArtifactList'](_0x20c970),_0x117c49=await this[_0x1ed77b(0x121)](_0x1befbb);return await this[_0x1ed77b(0x136)](_0x4fcd5d),await this[_0x1ed77b(0x108)](_0x429688),_0x117c49;}}function a402_0x3f2c(_0x4132ac,_0x21a524){const _0x57213c=a402_0x2a66();return a402_0x3f2c=function(_0xc27475,_0x4fc50d){_0xc27475=_0xc27475-0xf8;let _0x2a6613=_0x57213c[_0xc27475];return _0x2a6613;},a402_0x3f2c(_0x4132ac,_0x21a524);}exports['PackageExportService']=PackageExportService;