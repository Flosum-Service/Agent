const a354_0x5dbdec=a354_0x5075;(function(_0x1e95aa,_0x8e9f4e){const _0x6ef6d6=a354_0x5075,_0x4533ec=_0x1e95aa();while(!![]){try{const _0x541670=-parseInt(_0x6ef6d6(0x9a))/0x1*(-parseInt(_0x6ef6d6(0xa5))/0x2)+parseInt(_0x6ef6d6(0xa7))/0x3*(-parseInt(_0x6ef6d6(0x8a))/0x4)+parseInt(_0x6ef6d6(0xb6))/0x5+-parseInt(_0x6ef6d6(0x8c))/0x6*(parseInt(_0x6ef6d6(0x9c))/0x7)+-parseInt(_0x6ef6d6(0x71))/0x8+parseInt(_0x6ef6d6(0x96))/0x9*(parseInt(_0x6ef6d6(0xbf))/0xa)+parseInt(_0x6ef6d6(0xa3))/0xb*(-parseInt(_0x6ef6d6(0x92))/0xc);if(_0x541670===_0x8e9f4e)break;else _0x4533ec['push'](_0x4533ec['shift']());}catch(_0x1e3b4b){_0x4533ec['push'](_0x4533ec['shift']());}}}(a354_0x46f6,0x2d348));function a354_0x5075(_0x5cfb5d,_0xaae3f3){const _0x578569=a354_0x46f6();return a354_0x5075=function(_0x128594,_0x1f67b6){_0x128594=_0x128594-0x6f;let _0x46f68a=_0x578569[_0x128594];return _0x46f68a;},a354_0x5075(_0x5cfb5d,_0xaae3f3);}function a354_0x46f6(){const _0x4c2685=['createPackageComponents','74725qoYbLi','package_component__v','responseStatus','getPackageNames','name__v','createExportOutboundPackages','(((.+)+)+)+$','55aNuILC','__esModule','491066QKOOhi','all','35415gbymaN','application/x-www-form-urlencoded','values','Retrieve\x20Outbound\x20Package\x20zip\x20list','SUCCESS','href','_veevaService','Deleting\x20outbound\x20packages.','log','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','post','ENDPOINT_CREATE_RECORDS','_logger','\x27,\x27','packageName','1121570ilgpZx','__importDefault','executeVQL','constructor','Creating\x20outbound\x20packages','_connection','PackageExportService','map','toString','3477590CaJJze','default','Adding\x20components\x20to\x20outbound\x20package','VeevaConstants','includes','1316248lWcyVH','length','retrieveVPKList','outbound_package__v','Getting\x20names\x20of\x20outbound\x20packages','loadAsync','push','deletePackageComponents','VeevaError','createVeevaObjectRecords','search','content-type','MAXIMUM_SIZE_OF_PACKAGE','Create\x20Export\x20outbound\x20packages.','get','parse','filter','createOutboundPackages','Retrieve\x20Jobs\x20Status','fill','links','../classes/errors/veeva-error','getJobResult','Removing\x20components\x20from\x20outbound\x20packages.','arraybuffer','4HIbAGj','deleteOutboundPackages','6pmBIXk','deleteVeevaObjectRecords','application/json','join','migration__sys','getEndpointArtifactList','1069044TcOAyY','errors','../enums/status.enums','set','9pnNFfv','export','../constants/veeva.constants','VeevaResponseStatus','1GQrAxv'];a354_0x46f6=function(){return _0x4c2685;};return a354_0x46f6();}const a354_0x1f67b6=(function(){let _0x10e947=!![];return function(_0x549cea,_0x23bbee){const _0x5a411f=_0x10e947?function(){if(_0x23bbee){const _0x2e5a44=_0x23bbee['apply'](_0x549cea,arguments);return _0x23bbee=null,_0x2e5a44;}}:function(){};return _0x10e947=![],_0x5a411f;};}()),a354_0x128594=a354_0x1f67b6(this,function(){const _0x518802=a354_0x5075;return a354_0x128594[_0x518802(0xbe)]()[_0x518802(0x7b)](_0x518802(0xa2))[_0x518802(0xbe)]()[_0x518802(0xb9)](a354_0x128594)[_0x518802(0x7b)](_0x518802(0xa2));});a354_0x128594();'use strict';var __importDefault=this&&this[a354_0x5dbdec(0xb7)]||function(_0x4d0c86){return _0x4d0c86&&_0x4d0c86['__esModule']?_0x4d0c86:{'default':_0x4d0c86};};Object['defineProperty'](exports,a354_0x5dbdec(0xa4),{'value':!![]}),exports['PackageExportService']=void 0x0;const veeva_constants_1=require(a354_0x5dbdec(0x98)),jszip_1=__importDefault(require('jszip')),status_enums_1=require(a354_0x5dbdec(0x94)),veeva_error_1=require(a354_0x5dbdec(0x86));class PackageExportService{constructor({veevaService:_0x4cd34f,connection:_0x18262d,logger:_0x2a34cd}){const _0x313948=a354_0x5dbdec;this[_0x313948(0xad)]=_0x4cd34f,this[_0x313948(0xbb)]=_0x18262d,this[_0x313948(0xb3)]=_0x2a34cd;}async['createOutboundPackages'](_0x2a8289,_0x10ad96){const _0x5eb58a=a354_0x5dbdec;this[_0x5eb58a(0xb3)]['log'](_0x5eb58a(0xba));const _0x21aca0=veeva_constants_1[_0x5eb58a(0x6f)][_0x5eb58a(0xb2)]+_0x5eb58a(0x74),_0x148f5c=new Array(_0x2a8289)[_0x5eb58a(0x84)]({'summary__v':_0x10ad96,'object_type__v.api__name__v':_0x5eb58a(0x90)});return await this[_0x5eb58a(0xad)][_0x5eb58a(0x7a)](_0x21aca0,_0x148f5c);}async[a354_0x5dbdec(0x9b)](_0x5d0aae,_0x868423){const _0x2e8161=a354_0x5dbdec;this[_0x2e8161(0xb3)][_0x2e8161(0xaf)](_0x2e8161(0xc1));const _0x47e9ca=veeva_constants_1[_0x2e8161(0x6f)][_0x2e8161(0xb2)]+_0x2e8161(0x9d),_0x11ecde=_0x5d0aae['map']((_0x1a01fa,_0x11c792)=>({'vault_component__v':_0x1a01fa['id'],'outbound_package__v':_0x868423[Math['ceil']((_0x11c792+0x1)/veeva_constants_1['VeevaConstants']['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this[_0x2e8161(0xad)][_0x2e8161(0x7a)](_0x47e9ca,_0x11ecde);}async[a354_0x5dbdec(0x9f)](_0x27a729){const _0xbec844=a354_0x5dbdec;this['_logger'][_0xbec844(0xaf)](_0xbec844(0x75));const _0x582574=_0xbec844(0xb0)+_0x27a729[_0xbec844(0x8f)](_0xbec844(0xb4))+'\x27)',_0x2f0e4c=veeva_constants_1[_0xbec844(0x6f)]['ENDPOINT_VQL']+_0x582574,_0x2f8ff0=await this[_0xbec844(0xad)][_0xbec844(0xb8)](_0x2f0e4c);return _0x2f8ff0['reduce']((_0x244445,_0x4d388b)=>_0x244445[_0xbec844(0x95)](_0x4d388b['id'],_0x4d388b[_0xbec844(0xa0)]),new Map());}async['createExportOutboundPackages'](_0x231fa7){const _0x1233d0=a354_0x5dbdec;this[_0x1233d0(0xb3)][_0x1233d0(0xaf)](_0x1233d0(0x7e));const _0x1ff7bd=[],_0xf1b08b=_0x231fa7[_0x1233d0(0xbd)](_0x44adef=>{const _0x3115db=_0x1233d0;return this[_0x3115db(0xbb)][_0x3115db(0xb1)](veeva_constants_1[_0x3115db(0x6f)]['ENDPOINT_EXPORT_IMPORT_PACKAGE'],encodeURI(_0x3115db(0xb5))+'='+encodeURI(_0x44adef),{'headers':{'Content-Type':_0x3115db(0xa8)}});}),_0x5071d8=await Promise[_0x1233d0(0xa6)](_0xf1b08b);for(const {data:_0x35c2f3}of _0x5071d8){if(_0x35c2f3[_0x1233d0(0x9e)]===status_enums_1[_0x1233d0(0x99)][_0x1233d0(0xab)]){const {url:_0x4383c0}=_0x35c2f3;_0x1ff7bd['push'](_0x4383c0);}else throw new veeva_error_1[(_0x1233d0(0x79))](_0x35c2f3[_0x1233d0(0x93)]);}return _0x1ff7bd;}async['getEndpointArtifactList'](_0x2fa310){const _0x1bbea2=a354_0x5dbdec;this[_0x1bbea2(0xb3)][_0x1bbea2(0xaf)](_0x1bbea2(0x83));const _0x99752b=[],_0xe87ae2=await this['_veevaService'][_0x1bbea2(0x87)](_0x2fa310);for(const _0x5513a9 of _0xe87ae2){const _0x40089d=_0x5513a9[_0x1bbea2(0x85)][_0x1bbea2(0x81)](_0x1bfec5=>_0x1bfec5['rel']==='artifacts')[_0x1bbea2(0xbd)](_0x4cc5ef=>_0x4cc5ef[_0x1bbea2(0xac)]);_0x99752b[_0x1bbea2(0x77)](..._0x40089d);}return _0x99752b;}async['retrieveVPKList'](_0x42b343){const _0x4c1668=a354_0x5dbdec;var _0x20762e;const _0xddf8f8=[];this[_0x4c1668(0xb3)][_0x4c1668(0xaf)](_0x4c1668(0xaa));for(const _0x54e44c of _0x42b343){const {data:_0x467c46,headers:_0x1c38a5}=await this[_0x4c1668(0xbb)][_0x4c1668(0x7f)](_0x54e44c,{'responseType':_0x4c1668(0x89)}),_0x593d14=(_0x20762e=_0x1c38a5[_0x4c1668(0x7c)])===null||_0x20762e===void 0x0?void 0x0:_0x20762e[_0x4c1668(0x70)](_0x4c1668(0x8e));if(!_0x593d14){const _0x347648=_0x467c46,_0x1f920e=new jszip_1[(_0x4c1668(0xc0))]();await _0x1f920e[_0x4c1668(0x76)](_0x347648),_0xddf8f8[_0x4c1668(0x77)](_0x1f920e);}else{const _0x37d09a=JSON[_0x4c1668(0x80)](_0x467c46);throw new veeva_error_1['VeevaError'](_0x37d09a[_0x4c1668(0x93)]);}}return _0xddf8f8;}async[a354_0x5dbdec(0x78)](_0xf7daaf){const _0x1d5012=a354_0x5dbdec;this[_0x1d5012(0xb3)][_0x1d5012(0xaf)](_0x1d5012(0x88));const _0x13b861=veeva_constants_1['VeevaConstants'][_0x1d5012(0xb2)]+_0x1d5012(0x9d);await this[_0x1d5012(0xad)][_0x1d5012(0x8d)](_0x13b861,_0xf7daaf);}async['deleteOutboundPackages'](_0x52e13a){const _0x498086=a354_0x5dbdec;this[_0x498086(0xb3)][_0x498086(0xaf)](_0x498086(0xae));const _0x567267=veeva_constants_1[_0x498086(0x6f)][_0x498086(0xb2)]+_0x498086(0x74);await this[_0x498086(0xad)][_0x498086(0x8d)](_0x567267,_0x52e13a);}async[a354_0x5dbdec(0x97)](_0x311e61,_0x56d271){const _0x1aca3e=a354_0x5dbdec,_0x2774f2=await this[_0x1aca3e(0x82)](Math['ceil'](_0x311e61[_0x1aca3e(0x72)]/veeva_constants_1[_0x1aca3e(0x6f)][_0x1aca3e(0x7d)]),_0x56d271),_0x4a90b9=await this[_0x1aca3e(0x9b)](_0x311e61,_0x2774f2),_0x1c224b=await this[_0x1aca3e(0x9f)](_0x2774f2),_0x19cfa3=await this[_0x1aca3e(0xa1)](Array['from'](_0x1c224b[_0x1aca3e(0xa9)]())),_0x1b4cb2=await this[_0x1aca3e(0x91)](_0x19cfa3),_0x261862=await this[_0x1aca3e(0x73)](_0x1b4cb2);return await this[_0x1aca3e(0x78)](_0x4a90b9),await this[_0x1aca3e(0x8b)](_0x2774f2),_0x261862;}}exports[a354_0x5dbdec(0xbc)]=PackageExportService;