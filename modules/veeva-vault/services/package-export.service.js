function a390_0x4218(){const _0x5d1a20=['filter','VeevaError','Creating\x20outbound\x20packages','export','../enums/status.enums','1346435ccVvwD','2896160NGzwZx','createPackageComponents','length','437037lTHEXB','PackageExportService','apply','SUCCESS','30DWljLs','application/json','parse','createOutboundPackages','deletePackageComponents','log','_logger','package_component__v','defineProperty','\x27,\x27','createExportOutboundPackages','retrieveVPKList','getPackageNames','Adding\x20components\x20to\x20outbound\x20package','set','Getting\x20names\x20of\x20outbound\x20packages','post','fill','from','__importDefault','default','ENDPOINT_CREATE_RECORDS','packageName','search','Create\x20Export\x20outbound\x20packages.','VeevaConstants','createVeevaObjectRecords','MAXIMUM_SIZE_OF_PACKAGE','artifacts','599819AnlYvr','getEndpointArtifactList','ENDPOINT_EXPORT_IMPORT_PACKAGE','1172381BlTGwk','4tKpoiV','map','jszip','deleteVeevaObjectRecords','all','outbound_package__v','deleteOutboundPackages','arraybuffer','toString','href','migration__sys','Removing\x20components\x20from\x20outbound\x20packages.','_veevaService','errors','1138266CGScyH','(((.+)+)+)+$','4066668ArKKwx','responseStatus','../classes/errors/veeva-error','constructor','ceil','Retrieve\x20Jobs\x20Status','join','links','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','__esModule','VeevaResponseStatus','push'];a390_0x4218=function(){return _0x5d1a20;};return a390_0x4218();}const a390_0x2288dc=a390_0x1235;(function(_0x5e0dae,_0x265f4a){const _0x2c1a37=a390_0x1235,_0x16b675=_0x5e0dae();while(!![]){try{const _0x34230e=parseInt(_0x2c1a37(0x1b8))/0x1+-parseInt(_0x2c1a37(0x1ca))/0x2+-parseInt(_0x2c1a37(0x1e1))/0x3*(-parseInt(_0x2c1a37(0x1bc))/0x4)+parseInt(_0x2c1a37(0x1dd))/0x5+-parseInt(_0x2c1a37(0x1e5))/0x6*(-parseInt(_0x2c1a37(0x1bb))/0x7)+-parseInt(_0x2c1a37(0x1de))/0x8+-parseInt(_0x2c1a37(0x1cc))/0x9;if(_0x34230e===_0x265f4a)break;else _0x16b675['push'](_0x16b675['shift']());}catch(_0x472d4d){_0x16b675['push'](_0x16b675['shift']());}}}(a390_0x4218,0x728cb));function a390_0x1235(_0x29df34,_0x1e3e15){const _0x1b2666=a390_0x4218();return a390_0x1235=function(_0x23aa04,_0x1f6420){_0x23aa04=_0x23aa04-0x1a4;let _0x4218b9=_0x1b2666[_0x23aa04];return _0x4218b9;},a390_0x1235(_0x29df34,_0x1e3e15);}const a390_0x1f6420=(function(){let _0x48d399=!![];return function(_0x348f09,_0x5515fa){const _0x15deba=_0x48d399?function(){const _0x125e87=a390_0x1235;if(_0x5515fa){const _0x342c40=_0x5515fa[_0x125e87(0x1e3)](_0x348f09,arguments);return _0x5515fa=null,_0x342c40;}}:function(){};return _0x48d399=![],_0x15deba;};}()),a390_0x23aa04=a390_0x1f6420(this,function(){const _0x3fb9ee=a390_0x1235;return a390_0x23aa04[_0x3fb9ee(0x1c4)]()[_0x3fb9ee(0x1b2)](_0x3fb9ee(0x1cb))['toString']()[_0x3fb9ee(0x1cf)](a390_0x23aa04)[_0x3fb9ee(0x1b2)](_0x3fb9ee(0x1cb));});a390_0x23aa04();'use strict';var __importDefault=this&&this[a390_0x2288dc(0x1ae)]||function(_0x3d074b){const _0x2c19ad=a390_0x2288dc;return _0x3d074b&&_0x3d074b[_0x2c19ad(0x1d5)]?_0x3d074b:{'default':_0x3d074b};};Object[a390_0x2288dc(0x1ed)](exports,a390_0x2288dc(0x1d5),{'value':!![]}),exports[a390_0x2288dc(0x1e2)]=void 0x0;const veeva_constants_1=require('../constants/veeva.constants'),jszip_1=__importDefault(require(a390_0x2288dc(0x1be))),status_enums_1=require(a390_0x2288dc(0x1dc)),veeva_error_1=require(a390_0x2288dc(0x1ce));class PackageExportService{constructor({veevaService:_0x2ba454,connection:_0xfcbc8b,logger:_0x57ed83}){const _0xdd8ce=a390_0x2288dc;this[_0xdd8ce(0x1c8)]=_0x2ba454,this['_connection']=_0xfcbc8b,this['_logger']=_0x57ed83;}async[a390_0x2288dc(0x1e8)](_0x53db41,_0x47d483){const _0x2a8533=a390_0x2288dc;this[_0x2a8533(0x1eb)]['log'](_0x2a8533(0x1da));const _0x3fbdb2=veeva_constants_1[_0x2a8533(0x1b4)]['ENDPOINT_CREATE_RECORDS']+_0x2a8533(0x1c1),_0xcdbc1d=new Array(_0x53db41)[_0x2a8533(0x1ac)]({'summary__v':_0x47d483,'object_type__v.api__name__v':_0x2a8533(0x1c6)});return await this['_veevaService'][_0x2a8533(0x1b5)](_0x3fbdb2,_0xcdbc1d);}async[a390_0x2288dc(0x1df)](_0x557f8f,_0x2085c1){const _0x3563db=a390_0x2288dc;this[_0x3563db(0x1eb)][_0x3563db(0x1ea)](_0x3563db(0x1a8));const _0x4ff47e=veeva_constants_1[_0x3563db(0x1b4)][_0x3563db(0x1b0)]+_0x3563db(0x1ec),_0x3ae90e=_0x557f8f[_0x3563db(0x1bd)]((_0xf26ea6,_0x448373)=>({'vault_component__v':_0xf26ea6['id'],'outbound_package__v':_0x2085c1[Math[_0x3563db(0x1d0)]((_0x448373+0x1)/veeva_constants_1[_0x3563db(0x1b4)][_0x3563db(0x1b6)])-0x1]}));return await this[_0x3563db(0x1c8)][_0x3563db(0x1b5)](_0x4ff47e,_0x3ae90e);}async[a390_0x2288dc(0x1a7)](_0x144e2c){const _0x228e69=a390_0x2288dc;this[_0x228e69(0x1eb)][_0x228e69(0x1ea)](_0x228e69(0x1aa));const _0x5a3514=_0x228e69(0x1d4)+_0x144e2c[_0x228e69(0x1d2)](_0x228e69(0x1a4))+'\x27)',_0xcad50b=await this[_0x228e69(0x1c8)]['executeVQL'](_0x5a3514);return _0xcad50b['reduce']((_0xb4bef5,_0x30b2e7)=>_0xb4bef5[_0x228e69(0x1a9)](_0x30b2e7['id'],_0x30b2e7['name__v']),new Map());}async[a390_0x2288dc(0x1a5)](_0x46941b){const _0x42a3a4=a390_0x2288dc;this['_logger'][_0x42a3a4(0x1ea)](_0x42a3a4(0x1b3));const _0x1637ac=[],_0x50d1c9=_0x46941b['map'](_0x10aeb4=>{const _0x3d860e=_0x42a3a4;return this['_connection'][_0x3d860e(0x1ab)](veeva_constants_1[_0x3d860e(0x1b4)][_0x3d860e(0x1ba)],encodeURI(_0x3d860e(0x1b1))+'='+encodeURI(_0x10aeb4),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0x8948ca=await Promise[_0x42a3a4(0x1c0)](_0x50d1c9);for(const {data:_0x883b87}of _0x8948ca){if(_0x883b87[_0x42a3a4(0x1cd)]===status_enums_1[_0x42a3a4(0x1d6)][_0x42a3a4(0x1e4)]){const {url:_0x4d3c36}=_0x883b87;_0x1637ac['push'](_0x4d3c36);}else throw new veeva_error_1[(_0x42a3a4(0x1d9))](_0x883b87[_0x42a3a4(0x1c9)]);}return _0x1637ac;}async[a390_0x2288dc(0x1b9)](_0x377620){const _0xc375=a390_0x2288dc;this[_0xc375(0x1eb)][_0xc375(0x1ea)](_0xc375(0x1d1));const _0x4af3b1=[],_0x7b62dd=await this['_veevaService']['getJobResult'](_0x377620);for(const _0x3c4a8a of _0x7b62dd){const _0x2b9841=_0x3c4a8a[_0xc375(0x1d3)][_0xc375(0x1d8)](_0x3f57c3=>_0x3f57c3['rel']===_0xc375(0x1b7))[_0xc375(0x1bd)](_0x389e7e=>_0x389e7e[_0xc375(0x1c5)]);_0x4af3b1[_0xc375(0x1d7)](..._0x2b9841);}return _0x4af3b1;}async[a390_0x2288dc(0x1a6)](_0x10a56d){const _0x4d1baf=a390_0x2288dc;var _0x2dbc3c;const _0x2a0a1e=[];this['_logger'][_0x4d1baf(0x1ea)]('Retrieve\x20Outbound\x20Package\x20zip\x20list');for(const _0x25749f of _0x10a56d){const {data:_0x245310,headers:_0x14f25f}=await this['_connection']['get'](_0x25749f,{'responseType':_0x4d1baf(0x1c3)}),_0x5f0360=(_0x2dbc3c=_0x14f25f['content-type'])===null||_0x2dbc3c===void 0x0?void 0x0:_0x2dbc3c['includes'](_0x4d1baf(0x1e6));if(!_0x5f0360){const _0x14b362=_0x245310,_0x5676de=new jszip_1[(_0x4d1baf(0x1af))]();await _0x5676de['loadAsync'](_0x14b362),_0x2a0a1e[_0x4d1baf(0x1d7)](_0x5676de);}else{const _0x5a5136=JSON[_0x4d1baf(0x1e7)](_0x245310);throw new veeva_error_1[(_0x4d1baf(0x1d9))](_0x5a5136[_0x4d1baf(0x1c9)]);}}return _0x2a0a1e;}async[a390_0x2288dc(0x1e9)](_0x5d6e28){const _0x208c44=a390_0x2288dc;this['_logger'][_0x208c44(0x1ea)](_0x208c44(0x1c7));const _0x22b96c=veeva_constants_1[_0x208c44(0x1b4)][_0x208c44(0x1b0)]+_0x208c44(0x1ec);await this['_veevaService']['deleteVeevaObjectRecords'](_0x22b96c,_0x5d6e28);}async[a390_0x2288dc(0x1c2)](_0x386071){const _0x201790=a390_0x2288dc;this[_0x201790(0x1eb)][_0x201790(0x1ea)]('Deleting\x20outbound\x20packages.');const _0x1bab5c=veeva_constants_1[_0x201790(0x1b4)][_0x201790(0x1b0)]+_0x201790(0x1c1);await this[_0x201790(0x1c8)][_0x201790(0x1bf)](_0x1bab5c,_0x386071);}async[a390_0x2288dc(0x1db)](_0x5ed0aa,_0x3cde7c){const _0xd2530d=a390_0x2288dc,_0x6cd315=await this['createOutboundPackages'](Math[_0xd2530d(0x1d0)](_0x5ed0aa[_0xd2530d(0x1e0)]/veeva_constants_1['VeevaConstants'][_0xd2530d(0x1b6)]),_0x3cde7c),_0x267acc=await this[_0xd2530d(0x1df)](_0x5ed0aa,_0x6cd315),_0x20e3e8=await this[_0xd2530d(0x1a7)](_0x6cd315),_0x5b5441=await this[_0xd2530d(0x1a5)](Array[_0xd2530d(0x1ad)](_0x20e3e8['values']())),_0x4c98af=await this['getEndpointArtifactList'](_0x5b5441),_0xdf9b4c=await this[_0xd2530d(0x1a6)](_0x4c98af);return await this[_0xd2530d(0x1e9)](_0x267acc),await this[_0xd2530d(0x1c2)](_0x6cd315),_0xdf9b4c;}}exports[a390_0x2288dc(0x1e2)]=PackageExportService;