const a402_0x52ccdc=a402_0x1111;function a402_0x11e3(){const _0x20c515=['map','log','parse','(((.+)+)+)+$','PackageExportService','VeevaError','retrieveVPKList','export','arraybuffer','all','MAXIMUM_SIZE_OF_PACKAGE','../classes/errors/veeva-error','deleteOutboundPackages','4RGnvgp','errors','push','href','name__v','reduce','application/x-www-form-urlencoded','application/json','1825kwyzOh','__importDefault','getEndpointArtifactList','deleteVeevaObjectRecords','_veevaService','post','Creating\x20outbound\x20packages','60374rtHXcA','Create\x20Export\x20outbound\x20packages.','executeVQL','values','packageName','get','filter','search','ENDPOINT_CREATE_RECORDS','constructor','../constants/veeva.constants','Removing\x20components\x20from\x20outbound\x20packages.','__esModule','Retrieve\x20Outbound\x20Package\x20zip\x20list','\x27,\x27','9778194ONJNYc','Getting\x20names\x20of\x20outbound\x20packages','4187785vMFQyV','loadAsync','createPackageComponents','Adding\x20components\x20to\x20outbound\x20package','set','links','responseStatus','Retrieve\x20Jobs\x20Status','defineProperty','SUCCESS','35213330WiPydl','VeevaConstants','3587904SeWNaA','length','createOutboundPackages','includes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','3580BBqEOS','createVeevaObjectRecords','4182QTMdwC','14130fLTxiB','getPackageNames','VeevaResponseStatus','content-type','Deleting\x20outbound\x20packages.','outbound_package__v','deletePackageComponents','_connection','fill','default','toString','package_component__v','artifacts','join','createExportOutboundPackages','_logger','migration__sys','ceil','jszip'];a402_0x11e3=function(){return _0x20c515;};return a402_0x11e3();}(function(_0x5c85f9,_0x122879){const _0x3ed30c=a402_0x1111,_0x400887=_0x5c85f9();while(!![]){try{const _0x5f50f7=-parseInt(_0x3ed30c(0xe8))/0x1*(parseInt(_0x3ed30c(0x12d))/0x2)+parseInt(_0x3ed30c(0x10c))/0x3*(-parseInt(_0x3ed30c(0x10a))/0x4)+parseInt(_0x3ed30c(0xe1))/0x5*(parseInt(_0x3ed30c(0x10d))/0x6)+-parseInt(_0x3ed30c(0xf9))/0x7+-parseInt(_0x3ed30c(0x105))/0x8+-parseInt(_0x3ed30c(0xf7))/0x9+parseInt(_0x3ed30c(0x103))/0xa;if(_0x5f50f7===_0x122879)break;else _0x400887['push'](_0x400887['shift']());}catch(_0xb4d936){_0x400887['push'](_0x400887['shift']());}}}(a402_0x11e3,0xd6ad9));const a402_0x297bd7=(function(){let _0x53b72f=!![];return function(_0x5bf7f8,_0x4e993a){const _0x365140=_0x53b72f?function(){if(_0x4e993a){const _0x536e35=_0x4e993a['apply'](_0x5bf7f8,arguments);return _0x4e993a=null,_0x536e35;}}:function(){};return _0x53b72f=![],_0x365140;};}()),a402_0x40ec9c=a402_0x297bd7(this,function(){const _0x3a994d=a402_0x1111;return a402_0x40ec9c[_0x3a994d(0x117)]()[_0x3a994d(0xef)](_0x3a994d(0x123))[_0x3a994d(0x117)]()[_0x3a994d(0xf1)](a402_0x40ec9c)[_0x3a994d(0xef)](_0x3a994d(0x123));});a402_0x40ec9c();'use strict';var __importDefault=this&&this[a402_0x52ccdc(0xe2)]||function(_0x1c2355){const _0x3a4a09=a402_0x52ccdc;return _0x1c2355&&_0x1c2355[_0x3a4a09(0xf4)]?_0x1c2355:{'default':_0x1c2355};};Object[a402_0x52ccdc(0x101)](exports,a402_0x52ccdc(0xf4),{'value':!![]}),exports[a402_0x52ccdc(0x124)]=void 0x0;function a402_0x1111(_0x316eb0,_0x18ebd4){const _0x5cddc1=a402_0x11e3();return a402_0x1111=function(_0x40ec9c,_0x297bd7){_0x40ec9c=_0x40ec9c-0xde;let _0x11e3bd=_0x5cddc1[_0x40ec9c];return _0x11e3bd;},a402_0x1111(_0x316eb0,_0x18ebd4);}const veeva_constants_1=require(a402_0x52ccdc(0xf2)),jszip_1=__importDefault(require(a402_0x52ccdc(0x11f))),status_enums_1=require('../enums/status.enums'),veeva_error_1=require(a402_0x52ccdc(0x12b));class PackageExportService{constructor({veevaService:_0x11c0b4,connection:_0x56d210,logger:_0x4a7a86}){const _0x541972=a402_0x52ccdc;this['_veevaService']=_0x11c0b4,this[_0x541972(0x114)]=_0x56d210,this[_0x541972(0x11c)]=_0x4a7a86;}async[a402_0x52ccdc(0x107)](_0x158636,_0x2af175){const _0x3c5068=a402_0x52ccdc;this[_0x3c5068(0x11c)]['log'](_0x3c5068(0xe7));const _0x5338e8=veeva_constants_1[_0x3c5068(0x104)]['ENDPOINT_CREATE_RECORDS']+_0x3c5068(0x112),_0x1fba54=new Array(_0x158636)[_0x3c5068(0x115)]({'summary__v':_0x2af175,'object_type__v.api__name__v':_0x3c5068(0x11d)});return await this[_0x3c5068(0xe5)][_0x3c5068(0x10b)](_0x5338e8,_0x1fba54);}async[a402_0x52ccdc(0xfb)](_0x807e58,_0x1896cb){const _0x28d115=a402_0x52ccdc;this[_0x28d115(0x11c)]['log'](_0x28d115(0xfc));const _0x27c3e6=veeva_constants_1[_0x28d115(0x104)][_0x28d115(0xf0)]+_0x28d115(0x118),_0x5ba3a8=_0x807e58[_0x28d115(0x120)]((_0x183458,_0x3a2ec4)=>({'vault_component__v':_0x183458['id'],'outbound_package__v':_0x1896cb[Math[_0x28d115(0x11e)]((_0x3a2ec4+0x1)/veeva_constants_1[_0x28d115(0x104)][_0x28d115(0x12a)])-0x1]}));return await this['_veevaService']['createVeevaObjectRecords'](_0x27c3e6,_0x5ba3a8);}async[a402_0x52ccdc(0x10e)](_0x2d2611){const _0x47a431=a402_0x52ccdc;this[_0x47a431(0x11c)]['log'](_0x47a431(0xf8));const _0x3eb032=_0x47a431(0x109)+_0x2d2611[_0x47a431(0x11a)](_0x47a431(0xf6))+'\x27)',_0x2c9293=await this[_0x47a431(0xe5)][_0x47a431(0xea)](_0x3eb032);return _0x2c9293[_0x47a431(0xde)]((_0x598d0f,_0x4e8454)=>_0x598d0f[_0x47a431(0xfd)](_0x4e8454['id'],_0x4e8454[_0x47a431(0x131)]),new Map());}async[a402_0x52ccdc(0x11b)](_0x413c0d){const _0x527b98=a402_0x52ccdc;this[_0x527b98(0x11c)][_0x527b98(0x121)](_0x527b98(0xe9));const _0x3c8200=[],_0x54cc50=_0x413c0d[_0x527b98(0x120)](_0x4d3504=>{const _0x4d37d2=_0x527b98;return this[_0x4d37d2(0x114)][_0x4d37d2(0xe6)](veeva_constants_1[_0x4d37d2(0x104)]['ENDPOINT_EXPORT_IMPORT_PACKAGE'],encodeURI(_0x4d37d2(0xec))+'='+encodeURI(_0x4d3504),{'headers':{'Content-Type':_0x4d37d2(0xdf)}});}),_0x36aa1c=await Promise[_0x527b98(0x129)](_0x54cc50);for(const {data:_0x303c79}of _0x36aa1c){if(_0x303c79[_0x527b98(0xff)]===status_enums_1[_0x527b98(0x10f)][_0x527b98(0x102)]){const {url:_0x3c1af2}=_0x303c79;_0x3c8200[_0x527b98(0x12f)](_0x3c1af2);}else throw new veeva_error_1[(_0x527b98(0x125))](_0x303c79[_0x527b98(0x12e)]);}return _0x3c8200;}async[a402_0x52ccdc(0xe3)](_0x1cc382){const _0x2d1495=a402_0x52ccdc;this[_0x2d1495(0x11c)][_0x2d1495(0x121)](_0x2d1495(0x100));const _0x7d9c44=[],_0x530801=await this[_0x2d1495(0xe5)]['getJobResult'](_0x1cc382);for(const _0x16d10b of _0x530801){const _0x445594=_0x16d10b[_0x2d1495(0xfe)][_0x2d1495(0xee)](_0x1150a9=>_0x1150a9['rel']===_0x2d1495(0x119))[_0x2d1495(0x120)](_0x16f875=>_0x16f875[_0x2d1495(0x130)]);_0x7d9c44[_0x2d1495(0x12f)](..._0x445594);}return _0x7d9c44;}async[a402_0x52ccdc(0x126)](_0x47b482){const _0x4d470e=a402_0x52ccdc;var _0x15b2c6;const _0x1b9392=[];this[_0x4d470e(0x11c)]['log'](_0x4d470e(0xf5));for(const _0x408b3d of _0x47b482){const {data:_0x50fc10,headers:_0x57cfa8}=await this[_0x4d470e(0x114)][_0x4d470e(0xed)](_0x408b3d,{'responseType':_0x4d470e(0x128)}),_0x4695b3=(_0x15b2c6=_0x57cfa8[_0x4d470e(0x110)])===null||_0x15b2c6===void 0x0?void 0x0:_0x15b2c6[_0x4d470e(0x108)](_0x4d470e(0xe0));if(!_0x4695b3){const _0x1b7abf=_0x50fc10,_0xe0bf58=new jszip_1[(_0x4d470e(0x116))]();await _0xe0bf58[_0x4d470e(0xfa)](_0x1b7abf),_0x1b9392[_0x4d470e(0x12f)](_0xe0bf58);}else{const _0x148fae=JSON[_0x4d470e(0x122)](_0x50fc10);throw new veeva_error_1[(_0x4d470e(0x125))](_0x148fae[_0x4d470e(0x12e)]);}}return _0x1b9392;}async[a402_0x52ccdc(0x113)](_0x45689b){const _0x56af9b=a402_0x52ccdc;this[_0x56af9b(0x11c)][_0x56af9b(0x121)](_0x56af9b(0xf3));const _0x682e9b=veeva_constants_1[_0x56af9b(0x104)][_0x56af9b(0xf0)]+_0x56af9b(0x118);await this[_0x56af9b(0xe5)][_0x56af9b(0xe4)](_0x682e9b,_0x45689b);}async[a402_0x52ccdc(0x12c)](_0x9e4726){const _0x32388a=a402_0x52ccdc;this['_logger'][_0x32388a(0x121)](_0x32388a(0x111));const _0x5b40e5=veeva_constants_1[_0x32388a(0x104)][_0x32388a(0xf0)]+_0x32388a(0x112);await this[_0x32388a(0xe5)][_0x32388a(0xe4)](_0x5b40e5,_0x9e4726);}async[a402_0x52ccdc(0x127)](_0x58f1ea,_0x528efe){const _0x1e1858=a402_0x52ccdc,_0x502ece=await this[_0x1e1858(0x107)](Math[_0x1e1858(0x11e)](_0x58f1ea[_0x1e1858(0x106)]/veeva_constants_1[_0x1e1858(0x104)][_0x1e1858(0x12a)]),_0x528efe),_0x34b223=await this[_0x1e1858(0xfb)](_0x58f1ea,_0x502ece),_0x1e0db4=await this[_0x1e1858(0x10e)](_0x502ece),_0x41c6b1=await this[_0x1e1858(0x11b)](Array['from'](_0x1e0db4[_0x1e1858(0xeb)]())),_0xb6c27a=await this[_0x1e1858(0xe3)](_0x41c6b1),_0x1b04db=await this['retrieveVPKList'](_0xb6c27a);return await this[_0x1e1858(0x113)](_0x34b223),await this[_0x1e1858(0x12c)](_0x502ece),_0x1b04db;}}exports[a402_0x52ccdc(0x124)]=PackageExportService;