function a402_0x46d4(_0x14f241,_0x20dbc8){const _0x14098c=a402_0x4f0b();return a402_0x46d4=function(_0x57c948,_0x168eaf){_0x57c948=_0x57c948-0x1bc;let _0x4f0b7d=_0x14098c[_0x57c948];return _0x4f0b7d;},a402_0x46d4(_0x14f241,_0x20dbc8);}const a402_0x538803=a402_0x46d4;(function(_0x4ea2e5,_0x2f13c5){const _0x15043f=a402_0x46d4,_0x34580a=_0x4ea2e5();while(!![]){try{const _0x31ca1e=parseInt(_0x15043f(0x1fd))/0x1*(-parseInt(_0x15043f(0x1ca))/0x2)+parseInt(_0x15043f(0x1c4))/0x3*(parseInt(_0x15043f(0x1e3))/0x4)+-parseInt(_0x15043f(0x1c5))/0x5*(parseInt(_0x15043f(0x1e9))/0x6)+-parseInt(_0x15043f(0x1ec))/0x7+-parseInt(_0x15043f(0x1f9))/0x8*(parseInt(_0x15043f(0x1e0))/0x9)+-parseInt(_0x15043f(0x1f2))/0xa*(-parseInt(_0x15043f(0x1cf))/0xb)+parseInt(_0x15043f(0x207))/0xc*(parseInt(_0x15043f(0x1f4))/0xd);if(_0x31ca1e===_0x2f13c5)break;else _0x34580a['push'](_0x34580a['shift']());}catch(_0x283a6b){_0x34580a['push'](_0x34580a['shift']());}}}(a402_0x4f0b,0x8e110));function a402_0x4f0b(){const _0x4717db=['parse','filter','../constants/veeva.constants','MAXIMUM_SIZE_OF_PACKAGE','errors','includes','SUCCESS','../classes/errors/veeva-error','createOutboundPackages','123894jGhjpp','from','fill','291352bmnwHf','createVeevaObjectRecords','VeevaResponseStatus','__importDefault','createPackageComponents','log','258hcImQH','set','loadAsync','7397985UOwdpx','Retrieve\x20Outbound\x20Package\x20zip\x20list','Retrieve\x20Jobs\x20Status','artifacts','migration__sys','reduce','40MzNzLB','href','13VfgEyZ','PackageExportService','getPackageNames','_logger','default','296gOWfhx','all','apply','VeevaError','153702ShFCwN','(((.+)+)+)+$','get','application/json','push','name__v','deleteOutboundPackages','ENDPOINT_CREATE_RECORDS','arraybuffer','deleteVeevaObjectRecords','33430692ZOHfXh','\x27,\x27','retrieveVPKList','constructor','getEndpointArtifactList','VeevaConstants','deletePackageComponents','join','ceil','toString','Removing\x20components\x20from\x20outbound\x20packages.','Create\x20Export\x20outbound\x20packages.','outbound_package__v','search','content-type','12blwVIH','120180yEFnNZ','Creating\x20outbound\x20packages','defineProperty','createExportOutboundPackages','__esModule','2vVKPqS','../enums/status.enums','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','post','responseStatus','709797VGbNpo','_veevaService','ENDPOINT_EXPORT_IMPORT_PACKAGE','map','export','_connection','jszip','package_component__v'];a402_0x4f0b=function(){return _0x4717db;};return a402_0x4f0b();}const a402_0x168eaf=(function(){let _0x35faf4=!![];return function(_0x3643ee,_0x450980){const _0x2ff66=_0x35faf4?function(){const _0x5ccea4=a402_0x46d4;if(_0x450980){const _0x1491ca=_0x450980[_0x5ccea4(0x1fb)](_0x3643ee,arguments);return _0x450980=null,_0x1491ca;}}:function(){};return _0x35faf4=![],_0x2ff66;};}()),a402_0x57c948=a402_0x168eaf(this,function(){const _0xbc4836=a402_0x46d4;return a402_0x57c948[_0xbc4836(0x1be)]()[_0xbc4836(0x1c2)](_0xbc4836(0x1fe))[_0xbc4836(0x1be)]()[_0xbc4836(0x20a)](a402_0x57c948)['search'](_0xbc4836(0x1fe));});a402_0x57c948();'use strict';var __importDefault=this&&this[a402_0x538803(0x1e6)]||function(_0x2d963a){const _0x2e1fa1=a402_0x538803;return _0x2d963a&&_0x2d963a[_0x2e1fa1(0x1c9)]?_0x2d963a:{'default':_0x2d963a};};Object[a402_0x538803(0x1c7)](exports,a402_0x538803(0x1c9),{'value':!![]}),exports[a402_0x538803(0x1f5)]=void 0x0;const veeva_constants_1=require(a402_0x538803(0x1d9)),jszip_1=__importDefault(require(a402_0x538803(0x1d5))),status_enums_1=require(a402_0x538803(0x1cb)),veeva_error_1=require(a402_0x538803(0x1de));class PackageExportService{constructor({veevaService:_0x3ef3f2,connection:_0x16f445,logger:_0x3ba6b7}){const _0x216a2d=a402_0x538803;this[_0x216a2d(0x1d0)]=_0x3ef3f2,this['_connection']=_0x16f445,this['_logger']=_0x3ba6b7;}async[a402_0x538803(0x1df)](_0x415c9f,_0x2dd539){const _0x4aa8d7=a402_0x538803;this[_0x4aa8d7(0x1f7)][_0x4aa8d7(0x1e8)](_0x4aa8d7(0x1c6));const _0xd94c35=veeva_constants_1[_0x4aa8d7(0x20c)][_0x4aa8d7(0x204)]+_0x4aa8d7(0x1c1),_0x11d817=new Array(_0x415c9f)[_0x4aa8d7(0x1e2)]({'summary__v':_0x2dd539,'object_type__v.api__name__v':_0x4aa8d7(0x1f0)});return await this[_0x4aa8d7(0x1d0)][_0x4aa8d7(0x1e4)](_0xd94c35,_0x11d817);}async[a402_0x538803(0x1e7)](_0x3a4744,_0x7512e2){const _0x82b880=a402_0x538803;this[_0x82b880(0x1f7)][_0x82b880(0x1e8)]('Adding\x20components\x20to\x20outbound\x20package');const _0x2f8e7c=veeva_constants_1[_0x82b880(0x20c)]['ENDPOINT_CREATE_RECORDS']+'package_component__v',_0x4a174c=_0x3a4744[_0x82b880(0x1d2)]((_0x350c1c,_0x2d1881)=>({'vault_component__v':_0x350c1c['id'],'outbound_package__v':_0x7512e2[Math[_0x82b880(0x1bd)]((_0x2d1881+0x1)/veeva_constants_1[_0x82b880(0x20c)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this['_veevaService'][_0x82b880(0x1e4)](_0x2f8e7c,_0x4a174c);}async[a402_0x538803(0x1f6)](_0x448db2){const _0x14ffc1=a402_0x538803;this['_logger'][_0x14ffc1(0x1e8)]('Getting\x20names\x20of\x20outbound\x20packages');const _0x3bb05c=_0x14ffc1(0x1cc)+_0x448db2[_0x14ffc1(0x1bc)](_0x14ffc1(0x208))+'\x27)',_0x48445c=await this[_0x14ffc1(0x1d0)]['executeVQL'](_0x3bb05c);return _0x48445c[_0x14ffc1(0x1f1)]((_0x5c37eb,_0x2e8c9f)=>_0x5c37eb[_0x14ffc1(0x1ea)](_0x2e8c9f['id'],_0x2e8c9f[_0x14ffc1(0x202)]),new Map());}async['createExportOutboundPackages'](_0x179e1d){const _0x352cfa=a402_0x538803;this[_0x352cfa(0x1f7)][_0x352cfa(0x1e8)](_0x352cfa(0x1c0));const _0x5bc13f=[],_0x3e8e80=_0x179e1d[_0x352cfa(0x1d2)](_0x12266b=>{const _0x26de5e=_0x352cfa;return this[_0x26de5e(0x1d4)][_0x26de5e(0x1cd)](veeva_constants_1[_0x26de5e(0x20c)][_0x26de5e(0x1d1)],encodeURI('packageName')+'='+encodeURI(_0x12266b),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0x190ab9=await Promise[_0x352cfa(0x1fa)](_0x3e8e80);for(const {data:_0x4765b3}of _0x190ab9){if(_0x4765b3[_0x352cfa(0x1ce)]===status_enums_1[_0x352cfa(0x1e5)][_0x352cfa(0x1dd)]){const {url:_0x2d969b}=_0x4765b3;_0x5bc13f[_0x352cfa(0x201)](_0x2d969b);}else throw new veeva_error_1[(_0x352cfa(0x1fc))](_0x4765b3[_0x352cfa(0x1db)]);}return _0x5bc13f;}async[a402_0x538803(0x20b)](_0x62258d){const _0x1d8822=a402_0x538803;this[_0x1d8822(0x1f7)][_0x1d8822(0x1e8)](_0x1d8822(0x1ee));const _0x34e611=[],_0x431381=await this[_0x1d8822(0x1d0)]['getJobResult'](_0x62258d);for(const _0x2d4207 of _0x431381){const _0x2d42f1=_0x2d4207['links'][_0x1d8822(0x1d8)](_0x78be38=>_0x78be38['rel']===_0x1d8822(0x1ef))[_0x1d8822(0x1d2)](_0x487c56=>_0x487c56[_0x1d8822(0x1f3)]);_0x34e611[_0x1d8822(0x201)](..._0x2d42f1);}return _0x34e611;}async[a402_0x538803(0x209)](_0xa0fbfe){const _0xc269bf=a402_0x538803;var _0x101573;const _0x34775c=[];this['_logger'][_0xc269bf(0x1e8)](_0xc269bf(0x1ed));for(const _0x32cb19 of _0xa0fbfe){const {data:_0x450e38,headers:_0x3abb86}=await this[_0xc269bf(0x1d4)][_0xc269bf(0x1ff)](_0x32cb19,{'responseType':_0xc269bf(0x205)}),_0x438b68=(_0x101573=_0x3abb86[_0xc269bf(0x1c3)])===null||_0x101573===void 0x0?void 0x0:_0x101573[_0xc269bf(0x1dc)](_0xc269bf(0x200));if(!_0x438b68){const _0x2dcba1=_0x450e38,_0x546501=new jszip_1[(_0xc269bf(0x1f8))]();await _0x546501[_0xc269bf(0x1eb)](_0x2dcba1),_0x34775c[_0xc269bf(0x201)](_0x546501);}else{const _0x456445=JSON[_0xc269bf(0x1d7)](_0x450e38);throw new veeva_error_1[(_0xc269bf(0x1fc))](_0x456445['errors']);}}return _0x34775c;}async['deletePackageComponents'](_0x5bcaf0){const _0x473758=a402_0x538803;this[_0x473758(0x1f7)][_0x473758(0x1e8)](_0x473758(0x1bf));const _0x44b792=veeva_constants_1[_0x473758(0x20c)][_0x473758(0x204)]+_0x473758(0x1d6);await this['_veevaService'][_0x473758(0x206)](_0x44b792,_0x5bcaf0);}async[a402_0x538803(0x203)](_0x4d3b14){const _0x51dff5=a402_0x538803;this[_0x51dff5(0x1f7)]['log']('Deleting\x20outbound\x20packages.');const _0x42406d=veeva_constants_1[_0x51dff5(0x20c)]['ENDPOINT_CREATE_RECORDS']+_0x51dff5(0x1c1);await this[_0x51dff5(0x1d0)][_0x51dff5(0x206)](_0x42406d,_0x4d3b14);}async[a402_0x538803(0x1d3)](_0x1b19c4,_0x174f8b){const _0x536704=a402_0x538803,_0x5150e3=await this[_0x536704(0x1df)](Math['ceil'](_0x1b19c4['length']/veeva_constants_1['VeevaConstants'][_0x536704(0x1da)]),_0x174f8b),_0x2c94a0=await this[_0x536704(0x1e7)](_0x1b19c4,_0x5150e3),_0x3a6709=await this[_0x536704(0x1f6)](_0x5150e3),_0x3ba2da=await this[_0x536704(0x1c8)](Array[_0x536704(0x1e1)](_0x3a6709['values']())),_0x36004a=await this[_0x536704(0x20b)](_0x3ba2da),_0xf0e825=await this[_0x536704(0x209)](_0x36004a);return await this[_0x536704(0x20d)](_0x2c94a0),await this[_0x536704(0x203)](_0x5150e3),_0xf0e825;}}exports[a402_0x538803(0x1f5)]=PackageExportService;