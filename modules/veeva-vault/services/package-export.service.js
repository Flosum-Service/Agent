const a358_0x6a8ee5=a358_0x2963;(function(_0x2ee1df,_0x3bdeb4){const _0x826156=a358_0x2963,_0x31cddc=_0x2ee1df();while(!![]){try{const _0x320e5b=parseInt(_0x826156(0x12f))/0x1*(parseInt(_0x826156(0x130))/0x2)+-parseInt(_0x826156(0x137))/0x3*(parseInt(_0x826156(0x147))/0x4)+parseInt(_0x826156(0x157))/0x5*(parseInt(_0x826156(0x11a))/0x6)+parseInt(_0x826156(0x12d))/0x7+parseInt(_0x826156(0x14f))/0x8*(parseInt(_0x826156(0x113))/0x9)+parseInt(_0x826156(0x14e))/0xa*(parseInt(_0x826156(0x11d))/0xb)+parseInt(_0x826156(0x158))/0xc*(-parseInt(_0x826156(0x119))/0xd);if(_0x320e5b===_0x3bdeb4)break;else _0x31cddc['push'](_0x31cddc['shift']());}catch(_0x5e8e49){_0x31cddc['push'](_0x31cddc['shift']());}}}(a358_0x249d,0xdd3b3));const a358_0x1c2fe6=(function(){let _0x2361a1=!![];return function(_0x2b5b4f,_0x52b289){const _0x3e0f79=_0x2361a1?function(){const _0x5984f8=a358_0x2963;if(_0x52b289){const _0x1d4380=_0x52b289[_0x5984f8(0x123)](_0x2b5b4f,arguments);return _0x52b289=null,_0x1d4380;}}:function(){};return _0x2361a1=![],_0x3e0f79;};}()),a358_0x4d95c8=a358_0x1c2fe6(this,function(){const _0x6c77e8=a358_0x2963;return a358_0x4d95c8[_0x6c77e8(0x117)]()[_0x6c77e8(0x115)](_0x6c77e8(0x118))[_0x6c77e8(0x117)]()[_0x6c77e8(0x111)](a358_0x4d95c8)[_0x6c77e8(0x115)](_0x6c77e8(0x118));});a358_0x4d95c8();'use strict';function a358_0x249d(){const _0x3b371b=['_connection','get','ENDPOINT_CREATE_RECORDS','createOutboundPackages','Getting\x20names\x20of\x20outbound\x20packages','3eAQKtq','application/x-www-form-urlencoded','ENDPOINT_VQL','loadAsync','getEndpointArtifactList','values','outbound_package__v','../classes/errors/veeva-error','Deleting\x20outbound\x20packages.','artifacts','deleteVeevaObjectRecords','default','ENDPOINT_EXPORT_IMPORT_PACKAGE','links','_logger','getJobResult','3939188IaJWFK','MAXIMUM_SIZE_OF_PACKAGE','all','packageName','push','includes','errors','398480xxIjfP','8apZNHZ','executeVQL','__esModule','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','createPackageComponents','createExportOutboundPackages','_veevaService','from','275aHHBjo','24tgXbOv','retrieveVPKList','defineProperty','ceil','PackageExportService','../enums/status.enums','Removing\x20components\x20from\x20outbound\x20packages.','content-type','createVeevaObjectRecords','Create\x20Export\x20outbound\x20packages.','VeevaError','VeevaResponseStatus','set','arraybuffer','package_component__v','constructor','Retrieve\x20Jobs\x20Status','10224477adnTFj','deleteOutboundPackages','search','getPackageNames','toString','(((.+)+)+)+$','12816388OwUOEu','924oxYODI','\x27,\x27','Creating\x20outbound\x20packages','396NoKYid','reduce','parse','responseStatus','application/json','Adding\x20components\x20to\x20outbound\x20package','apply','rel','SUCCESS','length','__importDefault','fill','log','VeevaConstants','export','map','171465aRIIfs','deletePackageComponents','1Rouxfh','2518332Redbzj','Retrieve\x20Outbound\x20Package\x20zip\x20list'];a358_0x249d=function(){return _0x3b371b;};return a358_0x249d();}var __importDefault=this&&this[a358_0x6a8ee5(0x127)]||function(_0x1fd7bd){const _0x15e1fd=a358_0x6a8ee5;return _0x1fd7bd&&_0x1fd7bd[_0x15e1fd(0x151)]?_0x1fd7bd:{'default':_0x1fd7bd};};Object[a358_0x6a8ee5(0x15a)](exports,a358_0x6a8ee5(0x151),{'value':!![]}),exports[a358_0x6a8ee5(0x15c)]=void 0x0;const veeva_constants_1=require('../constants/veeva.constants'),jszip_1=__importDefault(require('jszip')),status_enums_1=require(a358_0x6a8ee5(0x15d)),veeva_error_1=require(a358_0x6a8ee5(0x13e));class PackageExportService{constructor({veevaService:_0x156f06,connection:_0xd8fb55,logger:_0x2feccd}){const _0x2d101c=a358_0x6a8ee5;this[_0x2d101c(0x155)]=_0x156f06,this[_0x2d101c(0x132)]=_0xd8fb55,this['_logger']=_0x2feccd;}async[a358_0x6a8ee5(0x135)](_0x155b1d,_0x16ca83){const _0x24fd06=a358_0x6a8ee5;this['_logger'][_0x24fd06(0x129)](_0x24fd06(0x11c));const _0x48da4b=veeva_constants_1[_0x24fd06(0x12a)][_0x24fd06(0x134)]+_0x24fd06(0x13d),_0x121df4=new Array(_0x155b1d)[_0x24fd06(0x128)]({'summary__v':_0x16ca83,'object_type__v.api__name__v':'migration__sys'});return await this[_0x24fd06(0x155)][_0x24fd06(0x160)](_0x48da4b,_0x121df4);}async[a358_0x6a8ee5(0x153)](_0x114da0,_0x59345e){const _0x48f55e=a358_0x6a8ee5;this['_logger'][_0x48f55e(0x129)](_0x48f55e(0x122));const _0x3b22d8=veeva_constants_1[_0x48f55e(0x12a)]['ENDPOINT_CREATE_RECORDS']+_0x48f55e(0x110),_0x1aeaf5=_0x114da0[_0x48f55e(0x12c)]((_0x223c9b,_0x28c4db)=>({'vault_component__v':_0x223c9b['id'],'outbound_package__v':_0x59345e[Math[_0x48f55e(0x15b)]((_0x28c4db+0x1)/veeva_constants_1[_0x48f55e(0x12a)][_0x48f55e(0x148)])-0x1]}));return await this[_0x48f55e(0x155)][_0x48f55e(0x160)](_0x3b22d8,_0x1aeaf5);}async[a358_0x6a8ee5(0x116)](_0x52d28d){const _0x4909d4=a358_0x6a8ee5;this[_0x4909d4(0x145)]['log'](_0x4909d4(0x136));const _0x2bc4de=_0x4909d4(0x152)+_0x52d28d['join'](_0x4909d4(0x11b))+'\x27)',_0x52996c=veeva_constants_1[_0x4909d4(0x12a)][_0x4909d4(0x139)]+_0x2bc4de,_0x448f3c=await this[_0x4909d4(0x155)][_0x4909d4(0x150)](_0x52996c);return _0x448f3c[_0x4909d4(0x11e)]((_0x4ad167,_0x5a35b9)=>_0x4ad167[_0x4909d4(0x10e)](_0x5a35b9['id'],_0x5a35b9['name__v']),new Map());}async[a358_0x6a8ee5(0x154)](_0x5b2b60){const _0x4c154e=a358_0x6a8ee5;this[_0x4c154e(0x145)][_0x4c154e(0x129)](_0x4c154e(0x10b));const _0x106651=[],_0x4883df=_0x5b2b60['map'](_0x375fdd=>{const _0x175da9=_0x4c154e;return this[_0x175da9(0x132)]['post'](veeva_constants_1[_0x175da9(0x12a)][_0x175da9(0x143)],encodeURI(_0x175da9(0x14a))+'='+encodeURI(_0x375fdd),{'headers':{'Content-Type':_0x175da9(0x138)}});}),_0x217ec5=await Promise[_0x4c154e(0x149)](_0x4883df);for(const {data:_0x2e2e10}of _0x217ec5){if(_0x2e2e10[_0x4c154e(0x120)]===status_enums_1[_0x4c154e(0x10d)][_0x4c154e(0x125)]){const {url:_0x14d539}=_0x2e2e10;_0x106651[_0x4c154e(0x14b)](_0x14d539);}else throw new veeva_error_1[(_0x4c154e(0x10c))](_0x2e2e10[_0x4c154e(0x14d)]);}return _0x106651;}async['getEndpointArtifactList'](_0x3e8bf4){const _0x45afcd=a358_0x6a8ee5;this[_0x45afcd(0x145)][_0x45afcd(0x129)](_0x45afcd(0x112));const _0x4641e9=[],_0x100d05=await this[_0x45afcd(0x155)][_0x45afcd(0x146)](_0x3e8bf4);for(const _0x4fa4e8 of _0x100d05){const _0x90a134=_0x4fa4e8[_0x45afcd(0x144)]['filter'](_0x4ea37b=>_0x4ea37b[_0x45afcd(0x124)]===_0x45afcd(0x140))[_0x45afcd(0x12c)](_0x5bdeff=>_0x5bdeff['href']);_0x4641e9[_0x45afcd(0x14b)](..._0x90a134);}return _0x4641e9;}async[a358_0x6a8ee5(0x159)](_0x374a88){const _0x1d403b=a358_0x6a8ee5;var _0x1e0562;const _0x1c7516=[];this[_0x1d403b(0x145)][_0x1d403b(0x129)](_0x1d403b(0x131));for(const _0x43e513 of _0x374a88){const {data:_0x2aab62,headers:_0x19f169}=await this[_0x1d403b(0x132)][_0x1d403b(0x133)](_0x43e513,{'responseType':_0x1d403b(0x10f)}),_0x501597=(_0x1e0562=_0x19f169[_0x1d403b(0x15f)])===null||_0x1e0562===void 0x0?void 0x0:_0x1e0562[_0x1d403b(0x14c)](_0x1d403b(0x121));if(!_0x501597){const _0x370616=_0x2aab62,_0x4cf3d8=new jszip_1[(_0x1d403b(0x142))]();await _0x4cf3d8[_0x1d403b(0x13a)](_0x370616),_0x1c7516[_0x1d403b(0x14b)](_0x4cf3d8);}else{const _0x1c6381=JSON[_0x1d403b(0x11f)](_0x2aab62);throw new veeva_error_1[(_0x1d403b(0x10c))](_0x1c6381['errors']);}}return _0x1c7516;}async[a358_0x6a8ee5(0x12e)](_0x8583a4){const _0x27d597=a358_0x6a8ee5;this['_logger']['log'](_0x27d597(0x15e));const _0x34bc9c=veeva_constants_1[_0x27d597(0x12a)]['ENDPOINT_CREATE_RECORDS']+_0x27d597(0x110);await this[_0x27d597(0x155)][_0x27d597(0x141)](_0x34bc9c,_0x8583a4);}async[a358_0x6a8ee5(0x114)](_0x46aa95){const _0x4f953c=a358_0x6a8ee5;this[_0x4f953c(0x145)][_0x4f953c(0x129)](_0x4f953c(0x13f));const _0x55bedc=veeva_constants_1[_0x4f953c(0x12a)][_0x4f953c(0x134)]+_0x4f953c(0x13d);await this[_0x4f953c(0x155)][_0x4f953c(0x141)](_0x55bedc,_0x46aa95);}async[a358_0x6a8ee5(0x12b)](_0xb67829,_0x6ce191){const _0x5a4b70=a358_0x6a8ee5,_0x555c57=await this[_0x5a4b70(0x135)](Math[_0x5a4b70(0x15b)](_0xb67829[_0x5a4b70(0x126)]/veeva_constants_1[_0x5a4b70(0x12a)][_0x5a4b70(0x148)]),_0x6ce191),_0xec280c=await this[_0x5a4b70(0x153)](_0xb67829,_0x555c57),_0x398bcf=await this['getPackageNames'](_0x555c57),_0x5510d9=await this[_0x5a4b70(0x154)](Array[_0x5a4b70(0x156)](_0x398bcf[_0x5a4b70(0x13c)]())),_0x13908e=await this[_0x5a4b70(0x13b)](_0x5510d9),_0x7b3270=await this[_0x5a4b70(0x159)](_0x13908e);return await this[_0x5a4b70(0x12e)](_0xec280c),await this[_0x5a4b70(0x114)](_0x555c57),_0x7b3270;}}function a358_0x2963(_0x335725,_0x328cc1){const _0x31b939=a358_0x249d();return a358_0x2963=function(_0x4d95c8,_0x1c2fe6){_0x4d95c8=_0x4d95c8-0x10b;let _0x249db4=_0x31b939[_0x4d95c8];return _0x249db4;},a358_0x2963(_0x335725,_0x328cc1);}exports[a358_0x6a8ee5(0x15c)]=PackageExportService;