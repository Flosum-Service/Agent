const a359_0x59487a=a359_0x487c;(function(_0x5bd3bb,_0x5d24be){const _0x586a97=a359_0x487c,_0x190b95=_0x5bd3bb();while(!![]){try{const _0x293897=-parseInt(_0x586a97(0xc1))/0x1*(-parseInt(_0x586a97(0xd1))/0x2)+parseInt(_0x586a97(0xcd))/0x3+-parseInt(_0x586a97(0xee))/0x4*(-parseInt(_0x586a97(0x102))/0x5)+parseInt(_0x586a97(0xc2))/0x6+parseInt(_0x586a97(0xf8))/0x7+-parseInt(_0x586a97(0xe5))/0x8+parseInt(_0x586a97(0xfa))/0x9*(-parseInt(_0x586a97(0xba))/0xa);if(_0x293897===_0x5d24be)break;else _0x190b95['push'](_0x190b95['shift']());}catch(_0x3f49b4){_0x190b95['push'](_0x190b95['shift']());}}}(a359_0x1da5,0x6b3f2));const a359_0x2f8ffb=(function(){let _0x4a3a2c=!![];return function(_0x5e7ea1,_0x3a0998){const _0x43164e=_0x4a3a2c?function(){if(_0x3a0998){const _0x343bb3=_0x3a0998['apply'](_0x5e7ea1,arguments);return _0x3a0998=null,_0x343bb3;}}:function(){};return _0x4a3a2c=![],_0x43164e;};}()),a359_0x441af7=a359_0x2f8ffb(this,function(){const _0x5a9669=a359_0x487c;return a359_0x441af7[_0x5a9669(0xcb)]()[_0x5a9669(0xe4)](_0x5a9669(0xb8))[_0x5a9669(0xcb)]()[_0x5a9669(0xf6)](a359_0x441af7)[_0x5a9669(0xe4)](_0x5a9669(0xb8));});a359_0x441af7();'use strict';function a359_0x1da5(){const _0x2d402a=['29beyKfa','1410486lKPXsG','getJobResult','../enums/status.enums','application/json','__esModule','_logger','package_component__v','href','Create\x20Export\x20outbound\x20packages.','toString','arraybuffer','2165922mLQfTV','jszip','links','_connection','24578HGPweQ','__importDefault','createExportOutboundPackages','SUCCESS','artifacts','createOutboundPackages','ENDPOINT_CREATE_RECORDS','MAXIMUM_SIZE_OF_PACKAGE','PackageExportService','Getting\x20names\x20of\x20outbound\x20packages','createVeevaObjectRecords','get','getEndpointArtifactList','packageName','Retrieve\x20Outbound\x20Package\x20zip\x20list','VeevaError','../classes/errors/veeva-error','map','push','search','2394064JDczSE','ENDPOINT_EXPORT_IMPORT_PACKAGE','log','loadAsync','defineProperty','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','VeevaConstants','Removing\x20components\x20from\x20outbound\x20packages.','responseStatus','16LirmYy','deleteVeevaObjectRecords','from','fill','_veevaService','deleteOutboundPackages','name__v','Deleting\x20outbound\x20packages.','constructor','retrieveVPKList','2723553nkuaaE','getPackageNames','9UVgQqW','createPackageComponents','all','reduce','content-type','ceil','outbound_package__v','join','470410DWrtKX','set','filter','executeVQL','(((.+)+)+)+$','post','13403030NNWauf','../constants/veeva.constants','VeevaResponseStatus','deletePackageComponents','Creating\x20outbound\x20packages','Retrieve\x20Jobs\x20Status','\x27,\x27'];a359_0x1da5=function(){return _0x2d402a;};return a359_0x1da5();}function a359_0x487c(_0x3006b4,_0x4e8f56){const _0xec7b14=a359_0x1da5();return a359_0x487c=function(_0x441af7,_0x2f8ffb){_0x441af7=_0x441af7-0xb5;let _0x1da543=_0xec7b14[_0x441af7];return _0x1da543;},a359_0x487c(_0x3006b4,_0x4e8f56);}var __importDefault=this&&this[a359_0x59487a(0xd2)]||function(_0x282491){const _0x2a8022=a359_0x59487a;return _0x282491&&_0x282491[_0x2a8022(0xc6)]?_0x282491:{'default':_0x282491};};Object[a359_0x59487a(0xe9)](exports,a359_0x59487a(0xc6),{'value':!![]}),exports['PackageExportService']=void 0x0;const veeva_constants_1=require(a359_0x59487a(0xbb)),jszip_1=__importDefault(require(a359_0x59487a(0xce))),status_enums_1=require(a359_0x59487a(0xc4)),veeva_error_1=require(a359_0x59487a(0xe1));class PackageExportService{constructor({veevaService:_0x508605,connection:_0x54734e,logger:_0x4ab5da}){const _0x45aa75=a359_0x59487a;this[_0x45aa75(0xf2)]=_0x508605,this[_0x45aa75(0xd0)]=_0x54734e,this[_0x45aa75(0xc7)]=_0x4ab5da;}async[a359_0x59487a(0xd6)](_0x284803,_0x50c12e){const _0x5507b6=a359_0x59487a;this[_0x5507b6(0xc7)][_0x5507b6(0xe7)](_0x5507b6(0xbe));const _0x8dc05b=veeva_constants_1['VeevaConstants'][_0x5507b6(0xd7)]+_0x5507b6(0x100),_0x352786=new Array(_0x284803)[_0x5507b6(0xf1)]({'summary__v':_0x50c12e,'object_type__v.api__name__v':'migration__sys'});return await this[_0x5507b6(0xf2)]['createVeevaObjectRecords'](_0x8dc05b,_0x352786);}async[a359_0x59487a(0xfb)](_0x2001f6,_0x1b2e65){const _0x565a09=a359_0x59487a;this[_0x565a09(0xc7)][_0x565a09(0xe7)]('Adding\x20components\x20to\x20outbound\x20package');const _0x41b564=veeva_constants_1[_0x565a09(0xeb)][_0x565a09(0xd7)]+'package_component__v',_0x5debd1=_0x2001f6[_0x565a09(0xe2)]((_0x38dc72,_0x30571c)=>({'vault_component__v':_0x38dc72['id'],'outbound_package__v':_0x1b2e65[Math['ceil']((_0x30571c+0x1)/veeva_constants_1['VeevaConstants'][_0x565a09(0xd8)])-0x1]}));return await this['_veevaService'][_0x565a09(0xdb)](_0x41b564,_0x5debd1);}async[a359_0x59487a(0xf9)](_0x4ace65){const _0x21fe67=a359_0x59487a;this['_logger'][_0x21fe67(0xe7)](_0x21fe67(0xda));const _0x3d411c=_0x21fe67(0xea)+_0x4ace65[_0x21fe67(0x101)](_0x21fe67(0xc0))+'\x27)',_0x5779e8=await this['_veevaService'][_0x21fe67(0xb7)](_0x3d411c);return _0x5779e8[_0x21fe67(0xfd)]((_0x308caf,_0x38eee6)=>_0x308caf[_0x21fe67(0xb5)](_0x38eee6['id'],_0x38eee6[_0x21fe67(0xf4)]),new Map());}async[a359_0x59487a(0xd3)](_0x58502f){const _0x4949a6=a359_0x59487a;this['_logger'][_0x4949a6(0xe7)](_0x4949a6(0xca));const _0x1fb863=[],_0x41f42d=_0x58502f[_0x4949a6(0xe2)](_0x3b6915=>{const _0x5d2977=_0x4949a6;return this[_0x5d2977(0xd0)][_0x5d2977(0xb9)](veeva_constants_1['VeevaConstants'][_0x5d2977(0xe6)],encodeURI(_0x5d2977(0xde))+'='+encodeURI(_0x3b6915),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0x5d27ae=await Promise[_0x4949a6(0xfc)](_0x41f42d);for(const {data:_0x7e1c39}of _0x5d27ae){if(_0x7e1c39[_0x4949a6(0xed)]===status_enums_1[_0x4949a6(0xbc)][_0x4949a6(0xd4)]){const {url:_0x312d62}=_0x7e1c39;_0x1fb863[_0x4949a6(0xe3)](_0x312d62);}else throw new veeva_error_1[(_0x4949a6(0xe0))](_0x7e1c39['errors']);}return _0x1fb863;}async['getEndpointArtifactList'](_0x42937a){const _0x2463bf=a359_0x59487a;this['_logger'][_0x2463bf(0xe7)](_0x2463bf(0xbf));const _0x58d07d=[],_0x50869c=await this[_0x2463bf(0xf2)][_0x2463bf(0xc3)](_0x42937a);for(const _0x13bb9a of _0x50869c){const _0xd15ede=_0x13bb9a[_0x2463bf(0xcf)][_0x2463bf(0xb6)](_0x38bc6d=>_0x38bc6d['rel']===_0x2463bf(0xd5))[_0x2463bf(0xe2)](_0x5ebd13=>_0x5ebd13[_0x2463bf(0xc9)]);_0x58d07d[_0x2463bf(0xe3)](..._0xd15ede);}return _0x58d07d;}async[a359_0x59487a(0xf7)](_0x495c2c){const _0x4fb564=a359_0x59487a;var _0x9f0e6b;const _0x1cfeb2=[];this['_logger'][_0x4fb564(0xe7)](_0x4fb564(0xdf));for(const _0x5589dd of _0x495c2c){const {data:_0x48d1e9,headers:_0x133290}=await this['_connection'][_0x4fb564(0xdc)](_0x5589dd,{'responseType':_0x4fb564(0xcc)}),_0x32e729=(_0x9f0e6b=_0x133290[_0x4fb564(0xfe)])===null||_0x9f0e6b===void 0x0?void 0x0:_0x9f0e6b['includes'](_0x4fb564(0xc5));if(!_0x32e729){const _0x12365e=_0x48d1e9,_0x56e32b=new jszip_1['default']();await _0x56e32b[_0x4fb564(0xe8)](_0x12365e),_0x1cfeb2[_0x4fb564(0xe3)](_0x56e32b);}else{const _0x50d222=JSON['parse'](_0x48d1e9);throw new veeva_error_1[(_0x4fb564(0xe0))](_0x50d222['errors']);}}return _0x1cfeb2;}async[a359_0x59487a(0xbd)](_0x46004a){const _0xc9e0ef=a359_0x59487a;this['_logger'][_0xc9e0ef(0xe7)](_0xc9e0ef(0xec));const _0x2ab519=veeva_constants_1[_0xc9e0ef(0xeb)][_0xc9e0ef(0xd7)]+_0xc9e0ef(0xc8);await this[_0xc9e0ef(0xf2)][_0xc9e0ef(0xef)](_0x2ab519,_0x46004a);}async[a359_0x59487a(0xf3)](_0x5508d2){const _0xdcb6cb=a359_0x59487a;this[_0xdcb6cb(0xc7)]['log'](_0xdcb6cb(0xf5));const _0x42174c=veeva_constants_1[_0xdcb6cb(0xeb)][_0xdcb6cb(0xd7)]+_0xdcb6cb(0x100);await this[_0xdcb6cb(0xf2)][_0xdcb6cb(0xef)](_0x42174c,_0x5508d2);}async['export'](_0x56a5b2,_0x3ae249){const _0x312850=a359_0x59487a,_0x21d76f=await this[_0x312850(0xd6)](Math[_0x312850(0xff)](_0x56a5b2['length']/veeva_constants_1['VeevaConstants']['MAXIMUM_SIZE_OF_PACKAGE']),_0x3ae249),_0x2f9e4b=await this['createPackageComponents'](_0x56a5b2,_0x21d76f),_0x3ffc67=await this[_0x312850(0xf9)](_0x21d76f),_0x389827=await this['createExportOutboundPackages'](Array[_0x312850(0xf0)](_0x3ffc67['values']())),_0x3104de=await this[_0x312850(0xdd)](_0x389827),_0x15ea19=await this[_0x312850(0xf7)](_0x3104de);return await this[_0x312850(0xbd)](_0x2f9e4b),await this['deleteOutboundPackages'](_0x21d76f),_0x15ea19;}}exports[a359_0x59487a(0xd9)]=PackageExportService;