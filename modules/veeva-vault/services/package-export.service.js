const a335_0x7b0894=a335_0x100b;(function(_0x35d40b,_0x186ab7){const _0x3214df=a335_0x100b,_0x119462=_0x35d40b();while(!![]){try{const _0x8456cc=parseInt(_0x3214df(0x1a9))/0x1+-parseInt(_0x3214df(0x1e2))/0x2*(-parseInt(_0x3214df(0x1a1))/0x3)+-parseInt(_0x3214df(0x1be))/0x4+parseInt(_0x3214df(0x1c5))/0x5*(-parseInt(_0x3214df(0x1d3))/0x6)+parseInt(_0x3214df(0x1a4))/0x7*(parseInt(_0x3214df(0x1db))/0x8)+parseInt(_0x3214df(0x1da))/0x9*(parseInt(_0x3214df(0x1bb))/0xa)+parseInt(_0x3214df(0x1df))/0xb;if(_0x8456cc===_0x186ab7)break;else _0x119462['push'](_0x119462['shift']());}catch(_0x20e031){_0x119462['push'](_0x119462['shift']());}}}(a335_0x912f,0xbab6e));const a335_0x12f83c=(function(){let _0xe3d62e=!![];return function(_0x55f235,_0x48185a){const _0x171804=_0xe3d62e?function(){const _0x20e234=a335_0x100b;if(_0x48185a){const _0x34383c=_0x48185a[_0x20e234(0x1c3)](_0x55f235,arguments);return _0x48185a=null,_0x34383c;}}:function(){};return _0xe3d62e=![],_0x171804;};}()),a335_0x3494c1=a335_0x12f83c(this,function(){const _0x5136f6=a335_0x100b;return a335_0x3494c1[_0x5136f6(0x1d2)]()[_0x5136f6(0x1dc)](_0x5136f6(0x1dd))['toString']()['constructor'](a335_0x3494c1)[_0x5136f6(0x1dc)](_0x5136f6(0x1dd));});a335_0x3494c1();'use strict';var __importDefault=this&&this[a335_0x7b0894(0x1bc)]||function(_0x12fd6e){const _0x479171=a335_0x7b0894;return _0x12fd6e&&_0x12fd6e[_0x479171(0x197)]?_0x12fd6e:{'default':_0x12fd6e};};Object[a335_0x7b0894(0x1bd)](exports,a335_0x7b0894(0x197),{'value':!![]}),exports[a335_0x7b0894(0x1c8)]=void 0x0;const veeva_constants_1=require(a335_0x7b0894(0x19c)),jszip_1=__importDefault(require(a335_0x7b0894(0x1b4))),status_enums_1=require(a335_0x7b0894(0x1c0)),veeva_error_1=require(a335_0x7b0894(0x1ae));function a335_0x100b(_0x11e0dc,_0xaf66d6){const _0x4d43a8=a335_0x912f();return a335_0x100b=function(_0x3494c1,_0x12f83c){_0x3494c1=_0x3494c1-0x195;let _0x912fa5=_0x4d43a8[_0x3494c1];return _0x912fa5;},a335_0x100b(_0x11e0dc,_0xaf66d6);}class PackageExportService{constructor({veevaService:_0x5ec128,connection:_0x10ba8a,logger:_0x52865b}){const _0x3e5407=a335_0x7b0894;this['_veevaService']=_0x5ec128,this[_0x3e5407(0x1a7)]=_0x10ba8a,this[_0x3e5407(0x1cd)]=_0x52865b;}async[a335_0x7b0894(0x1d1)](_0x240b13,_0x4f4b47){const _0x164666=a335_0x7b0894;this[_0x164666(0x1cd)][_0x164666(0x19b)](_0x164666(0x195));const _0x1d88eb=veeva_constants_1['VeevaConstants']['ENDPOINT_CREATE_RECORDS']+_0x164666(0x1a3),_0x5e3b84=new Array(_0x240b13)[_0x164666(0x1c1)]({'summary__v':_0x4f4b47,'object_type__v.api__name__v':'migration__sys'});return await this[_0x164666(0x1d9)][_0x164666(0x1ba)](_0x1d88eb,_0x5e3b84);}async[a335_0x7b0894(0x1de)](_0x450912,_0x56b1b1){const _0x58a503=a335_0x7b0894;this[_0x58a503(0x1cd)][_0x58a503(0x19b)](_0x58a503(0x1ca));const _0x4b8876=veeva_constants_1[_0x58a503(0x19a)]['ENDPOINT_CREATE_RECORDS']+_0x58a503(0x1a5),_0x24eecd=_0x450912[_0x58a503(0x1cb)]((_0x5c97c2,_0x39f82d)=>({'vault_component__v':_0x5c97c2['id'],'outbound_package__v':_0x56b1b1[Math[_0x58a503(0x1b0)]((_0x39f82d+0x1)/veeva_constants_1[_0x58a503(0x19a)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this[_0x58a503(0x1d9)][_0x58a503(0x1ba)](_0x4b8876,_0x24eecd);}async['getPackageNames'](_0x1b89ed){const _0x21c885=a335_0x7b0894;this[_0x21c885(0x1cd)][_0x21c885(0x19b)](_0x21c885(0x1ad));const _0x576b10='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x1b89ed['join']('\x27,\x27')+'\x27)',_0x1624c3=veeva_constants_1[_0x21c885(0x19a)][_0x21c885(0x1bf)]+_0x576b10,_0x4ee836=await this[_0x21c885(0x1d9)]['executeVQL'](_0x1624c3);return _0x4ee836[_0x21c885(0x1c4)]((_0x5d71c7,_0x552df9)=>_0x5d71c7[_0x21c885(0x196)](_0x552df9['id'],_0x552df9[_0x21c885(0x1ac)]),new Map());}async[a335_0x7b0894(0x1c2)](_0x298f18){const _0x5c33b8=a335_0x7b0894;this[_0x5c33b8(0x1cd)][_0x5c33b8(0x19b)](_0x5c33b8(0x1d5));const _0x5330c7=[],_0x546f36=_0x298f18[_0x5c33b8(0x1cb)](_0x57237a=>{const _0x4904e4=_0x5c33b8;return this['_connection'][_0x4904e4(0x19d)](veeva_constants_1['VeevaConstants'][_0x4904e4(0x1cf)],encodeURI(_0x4904e4(0x1d4))+'='+encodeURI(_0x57237a),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0x321817=await Promise[_0x5c33b8(0x1d8)](_0x546f36);for(const {data:_0xa4ab05}of _0x321817){if(_0xa4ab05[_0x5c33b8(0x1d7)]===status_enums_1[_0x5c33b8(0x199)][_0x5c33b8(0x1b8)]){const {url:_0xb52f7f}=_0xa4ab05;_0x5330c7[_0x5c33b8(0x1a6)](_0xb52f7f);}else throw new veeva_error_1['VeevaError'](_0xa4ab05[_0x5c33b8(0x1b6)]);}return _0x5330c7;}async[a335_0x7b0894(0x1e0)](_0x4de042){const _0x2eae9f=a335_0x7b0894;this[_0x2eae9f(0x1cd)][_0x2eae9f(0x19b)](_0x2eae9f(0x1a0));const _0x49bd5e=[],_0x1171ba=await this[_0x2eae9f(0x1d9)][_0x2eae9f(0x1a2)](_0x4de042);for(const _0xa96815 of _0x1171ba){const _0x152e5a=_0xa96815[_0x2eae9f(0x1e1)][_0x2eae9f(0x1aa)](_0x3f1d15=>_0x3f1d15[_0x2eae9f(0x1c6)]===_0x2eae9f(0x1af))[_0x2eae9f(0x1cb)](_0x5ae438=>_0x5ae438[_0x2eae9f(0x19e)]);_0x49bd5e[_0x2eae9f(0x1a6)](..._0x152e5a);}return _0x49bd5e;}async[a335_0x7b0894(0x1b7)](_0xf5cf62){const _0x2101d8=a335_0x7b0894;var _0x4a2c99;const _0x2394ca=[];this[_0x2101d8(0x1cd)][_0x2101d8(0x19b)]('Retrieve\x20Outbound\x20Package\x20zip\x20list');for(const _0x1df01e of _0xf5cf62){const {data:_0x45dfd5,headers:_0x191777}=await this[_0x2101d8(0x1a7)]['get'](_0x1df01e,{'responseType':'arraybuffer'}),_0xc17d54=(_0x4a2c99=_0x191777['content-type'])===null||_0x4a2c99===void 0x0?void 0x0:_0x4a2c99[_0x2101d8(0x1cc)](_0x2101d8(0x1b9));if(!_0xc17d54){const _0x46374a=_0x45dfd5,_0x3da8c3=new jszip_1['default']();await _0x3da8c3[_0x2101d8(0x1d0)](_0x46374a),_0x2394ca[_0x2101d8(0x1a6)](_0x3da8c3);}else{const _0x2934de=JSON[_0x2101d8(0x1ab)](_0x45dfd5);throw new veeva_error_1['VeevaError'](_0x2934de[_0x2101d8(0x1b6)]);}}return _0x2394ca;}async[a335_0x7b0894(0x198)](_0x322cc1){const _0x162745=a335_0x7b0894;this[_0x162745(0x1cd)][_0x162745(0x19b)](_0x162745(0x1b5));const _0x562010=veeva_constants_1[_0x162745(0x19a)][_0x162745(0x19f)]+_0x162745(0x1a5);await this[_0x162745(0x1d9)][_0x162745(0x1b3)](_0x562010,_0x322cc1);}async[a335_0x7b0894(0x1c9)](_0x33ab51){const _0xdae403=a335_0x7b0894;this[_0xdae403(0x1cd)][_0xdae403(0x19b)](_0xdae403(0x1d6));const _0xfc0877=veeva_constants_1[_0xdae403(0x19a)][_0xdae403(0x19f)]+_0xdae403(0x1a3);await this[_0xdae403(0x1d9)][_0xdae403(0x1b3)](_0xfc0877,_0x33ab51);}async[a335_0x7b0894(0x1ce)](_0x34283c,_0x2d16ff){const _0x58e830=a335_0x7b0894,_0x3c3563=await this[_0x58e830(0x1d1)](Math[_0x58e830(0x1b0)](_0x34283c['length']/veeva_constants_1[_0x58e830(0x19a)][_0x58e830(0x1b2)]),_0x2d16ff),_0x3f0dc6=await this[_0x58e830(0x1de)](_0x34283c,_0x3c3563),_0x35894a=await this[_0x58e830(0x1b1)](_0x3c3563),_0x368867=await this['createExportOutboundPackages'](Array[_0x58e830(0x1c7)](_0x35894a[_0x58e830(0x1a8)]())),_0x193e27=await this[_0x58e830(0x1e0)](_0x368867),_0xc22708=await this['retrieveVPKList'](_0x193e27);return await this[_0x58e830(0x198)](_0x3f0dc6),await this['deleteOutboundPackages'](_0x3c3563),_0xc22708;}}exports[a335_0x7b0894(0x1c8)]=PackageExportService;function a335_0x912f(){const _0x34f6d0=['__esModule','deletePackageComponents','VeevaResponseStatus','VeevaConstants','log','../constants/veeva.constants','post','href','ENDPOINT_CREATE_RECORDS','Retrieve\x20Jobs\x20Status','11172Kyanby','getJobResult','outbound_package__v','203wSireC','package_component__v','push','_connection','values','1065913GjpCrf','filter','parse','name__v','Getting\x20names\x20of\x20outbound\x20packages','../classes/errors/veeva-error','artifacts','ceil','getPackageNames','MAXIMUM_SIZE_OF_PACKAGE','deleteVeevaObjectRecords','jszip','Removing\x20components\x20from\x20outbound\x20packages.','errors','retrieveVPKList','SUCCESS','application/json','createVeevaObjectRecords','460QHqKjU','__importDefault','defineProperty','5696892mtbZHy','ENDPOINT_VQL','../enums/status.enums','fill','createExportOutboundPackages','apply','reduce','415885TKWkJH','rel','from','PackageExportService','deleteOutboundPackages','Adding\x20components\x20to\x20outbound\x20package','map','includes','_logger','export','ENDPOINT_EXPORT_IMPORT_PACKAGE','loadAsync','createOutboundPackages','toString','66OdSrjh','packageName','Create\x20Export\x20outbound\x20packages.','Deleting\x20outbound\x20packages.','responseStatus','all','_veevaService','72189PGlPXU','172840SERKpd','search','(((.+)+)+)+$','createPackageComponents','1595484ZxfsKN','getEndpointArtifactList','links','482kajhlM','Creating\x20outbound\x20packages','set'];a335_0x912f=function(){return _0x34f6d0;};return a335_0x912f();}