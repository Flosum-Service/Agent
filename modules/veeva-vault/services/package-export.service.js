function a358_0xf8a6(){const _0x3719ff=['5241105uhpCWj','all','errors','8534dYQMZT','log','164JLwcvX','createVeevaObjectRecords','jszip','filter','__esModule','content-type','11699870kcyjdI','responseStatus','44013YfSYdZ','(((.+)+)+)+$','executeVQL','createOutboundPackages','Retrieve\x20Jobs\x20Status','default','getPackageNames','deleteOutboundPackages','SUCCESS','getJobResult','package_component__v','outbound_package__v','getEndpointArtifactList','join','artifacts','VeevaError','Creating\x20outbound\x20packages','search','Deleting\x20outbound\x20packages.','deletePackageComponents','post','Getting\x20names\x20of\x20outbound\x20packages','retrieveVPKList','\x27,\x27','deleteVeevaObjectRecords','map','toString','Create\x20Export\x20outbound\x20packages.','ENDPOINT_EXPORT_IMPORT_PACKAGE','reduce','export','includes','_logger','application/json','../enums/status.enums','application/x-www-form-urlencoded','_veevaService','length','1212205JDbefJ','VeevaResponseStatus','createPackageComponents','loadAsync','3219594RlzPkc','from','fill','parse','../constants/veeva.constants','ENDPOINT_VQL','set','name__v','defineProperty','../classes/errors/veeva-error','rel','ceil','apply','3qRshTK','ENDPOINT_CREATE_RECORDS','_connection','createExportOutboundPackages','__importDefault','VeevaConstants','PackageExportService','12xeuDaE','Retrieve\x20Outbound\x20Package\x20zip\x20list','packageName','push','2792152dKvwpa'];a358_0xf8a6=function(){return _0x3719ff;};return a358_0xf8a6();}const a358_0x2de683=a358_0x4564;(function(_0x5577f7,_0x505444){const _0x1162f0=a358_0x4564,_0x324c1f=_0x5577f7();while(!![]){try{const _0xe6c39f=parseInt(_0x1162f0(0x11c))/0x1*(-parseInt(_0x1162f0(0x12b))/0x2)+-parseInt(_0x1162f0(0x135))/0x3*(-parseInt(_0x1162f0(0x12d))/0x4)+parseInt(_0x1162f0(0x10b))/0x5*(-parseInt(_0x1162f0(0x123))/0x6)+parseInt(_0x1162f0(0x10f))/0x7+parseInt(_0x1162f0(0x127))/0x8+parseInt(_0x1162f0(0x128))/0x9+-parseInt(_0x1162f0(0x133))/0xa;if(_0xe6c39f===_0x505444)break;else _0x324c1f['push'](_0x324c1f['shift']());}catch(_0x68c5b5){_0x324c1f['push'](_0x324c1f['shift']());}}}(a358_0xf8a6,0x4f61b));function a358_0x4564(_0x49c4d2,_0x32982a){const _0x2ebbad=a358_0xf8a6();return a358_0x4564=function(_0x1ec6e1,_0x2e2836){_0x1ec6e1=_0x1ec6e1-0xe7;let _0xf8a653=_0x2ebbad[_0x1ec6e1];return _0xf8a653;},a358_0x4564(_0x49c4d2,_0x32982a);}const a358_0x2e2836=(function(){let _0x41c167=!![];return function(_0x4d484f,_0x192b21){const _0x597cf9=_0x41c167?function(){const _0x133b2d=a358_0x4564;if(_0x192b21){const _0x763e60=_0x192b21[_0x133b2d(0x11b)](_0x4d484f,arguments);return _0x192b21=null,_0x763e60;}}:function(){};return _0x41c167=![],_0x597cf9;};}()),a358_0x1ec6e1=a358_0x2e2836(this,function(){const _0x3a9457=a358_0x4564;return a358_0x1ec6e1[_0x3a9457(0xff)]()['search'](_0x3a9457(0x136))[_0x3a9457(0xff)]()['constructor'](a358_0x1ec6e1)[_0x3a9457(0xf6)](_0x3a9457(0x136));});a358_0x1ec6e1();'use strict';var __importDefault=this&&this[a358_0x2de683(0x120)]||function(_0x4aae9b){const _0xb0e538=a358_0x2de683;return _0x4aae9b&&_0x4aae9b[_0xb0e538(0x131)]?_0x4aae9b:{'default':_0x4aae9b};};Object[a358_0x2de683(0x117)](exports,a358_0x2de683(0x131),{'value':!![]}),exports['PackageExportService']=void 0x0;const veeva_constants_1=require(a358_0x2de683(0x113)),jszip_1=__importDefault(require(a358_0x2de683(0x12f))),status_enums_1=require(a358_0x2de683(0x107)),veeva_error_1=require(a358_0x2de683(0x118));class PackageExportService{constructor({veevaService:_0x5ed24b,connection:_0x1c93a5,logger:_0x14a2bd}){const _0x57d1fb=a358_0x2de683;this[_0x57d1fb(0x109)]=_0x5ed24b,this[_0x57d1fb(0x11e)]=_0x1c93a5,this[_0x57d1fb(0x105)]=_0x14a2bd;}async[a358_0x2de683(0xe8)](_0x399833,_0x1b450f){const _0x4ce894=a358_0x2de683;this[_0x4ce894(0x105)]['log'](_0x4ce894(0xf5));const _0x2b4102=veeva_constants_1[_0x4ce894(0x121)][_0x4ce894(0x11d)]+'outbound_package__v',_0x50ec73=new Array(_0x399833)[_0x4ce894(0x111)]({'summary__v':_0x1b450f,'object_type__v.api__name__v':'migration__sys'});return await this['_veevaService'][_0x4ce894(0x12e)](_0x2b4102,_0x50ec73);}async[a358_0x2de683(0x10d)](_0x26b9d9,_0x1c87a4){const _0x49f9d5=a358_0x2de683;this[_0x49f9d5(0x105)]['log']('Adding\x20components\x20to\x20outbound\x20package');const _0x47e90d=veeva_constants_1[_0x49f9d5(0x121)][_0x49f9d5(0x11d)]+_0x49f9d5(0xef),_0x98e9aa=_0x26b9d9[_0x49f9d5(0xfe)]((_0x2bc9c5,_0x150aa7)=>({'vault_component__v':_0x2bc9c5['id'],'outbound_package__v':_0x1c87a4[Math[_0x49f9d5(0x11a)]((_0x150aa7+0x1)/veeva_constants_1[_0x49f9d5(0x121)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this[_0x49f9d5(0x109)][_0x49f9d5(0x12e)](_0x47e90d,_0x98e9aa);}async[a358_0x2de683(0xeb)](_0x30f662){const _0x234a04=a358_0x2de683;this[_0x234a04(0x105)][_0x234a04(0x12c)](_0x234a04(0xfa));const _0x4dbee0='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x30f662[_0x234a04(0xf2)](_0x234a04(0xfc))+'\x27)',_0x5a246c=veeva_constants_1[_0x234a04(0x121)][_0x234a04(0x114)]+_0x4dbee0,_0x31932c=await this[_0x234a04(0x109)][_0x234a04(0xe7)](_0x5a246c);return _0x31932c[_0x234a04(0x102)]((_0x2682bf,_0x452836)=>_0x2682bf[_0x234a04(0x115)](_0x452836['id'],_0x452836[_0x234a04(0x116)]),new Map());}async[a358_0x2de683(0x11f)](_0x7ac3c0){const _0x292bc2=a358_0x2de683;this[_0x292bc2(0x105)]['log'](_0x292bc2(0x100));const _0x523268=[],_0x3143ac=_0x7ac3c0[_0x292bc2(0xfe)](_0xca40c2=>{const _0x129461=_0x292bc2;return this['_connection'][_0x129461(0xf9)](veeva_constants_1[_0x129461(0x121)][_0x129461(0x101)],encodeURI(_0x129461(0x125))+'='+encodeURI(_0xca40c2),{'headers':{'Content-Type':_0x129461(0x108)}});}),_0x3633e5=await Promise[_0x292bc2(0x129)](_0x3143ac);for(const {data:_0x16b786}of _0x3633e5){if(_0x16b786[_0x292bc2(0x134)]===status_enums_1[_0x292bc2(0x10c)][_0x292bc2(0xed)]){const {url:_0x55ebdb}=_0x16b786;_0x523268[_0x292bc2(0x126)](_0x55ebdb);}else throw new veeva_error_1[(_0x292bc2(0xf4))](_0x16b786[_0x292bc2(0x12a)]);}return _0x523268;}async[a358_0x2de683(0xf1)](_0x1509b6){const _0x44be05=a358_0x2de683;this[_0x44be05(0x105)]['log'](_0x44be05(0xe9));const _0x513e32=[],_0x1011f8=await this[_0x44be05(0x109)][_0x44be05(0xee)](_0x1509b6);for(const _0x4b6b75 of _0x1011f8){const _0x4bbf69=_0x4b6b75['links'][_0x44be05(0x130)](_0x3659d8=>_0x3659d8[_0x44be05(0x119)]===_0x44be05(0xf3))[_0x44be05(0xfe)](_0x47bf2a=>_0x47bf2a['href']);_0x513e32['push'](..._0x4bbf69);}return _0x513e32;}async[a358_0x2de683(0xfb)](_0x321115){const _0x45beab=a358_0x2de683;var _0xf5b9d;const _0x1e3d63=[];this[_0x45beab(0x105)][_0x45beab(0x12c)](_0x45beab(0x124));for(const _0x370554 of _0x321115){const {data:_0x135e3d,headers:_0x420e1b}=await this['_connection']['get'](_0x370554,{'responseType':'arraybuffer'}),_0x5acf87=(_0xf5b9d=_0x420e1b[_0x45beab(0x132)])===null||_0xf5b9d===void 0x0?void 0x0:_0xf5b9d[_0x45beab(0x104)](_0x45beab(0x106));if(!_0x5acf87){const _0x51a879=_0x135e3d,_0xbf6f8d=new jszip_1[(_0x45beab(0xea))]();await _0xbf6f8d[_0x45beab(0x10e)](_0x51a879),_0x1e3d63[_0x45beab(0x126)](_0xbf6f8d);}else{const _0x38611c=JSON[_0x45beab(0x112)](_0x135e3d);throw new veeva_error_1['VeevaError'](_0x38611c[_0x45beab(0x12a)]);}}return _0x1e3d63;}async[a358_0x2de683(0xf8)](_0x38b539){const _0x51d8a2=a358_0x2de683;this[_0x51d8a2(0x105)]['log']('Removing\x20components\x20from\x20outbound\x20packages.');const _0xbf3604=veeva_constants_1['VeevaConstants']['ENDPOINT_CREATE_RECORDS']+_0x51d8a2(0xef);await this[_0x51d8a2(0x109)][_0x51d8a2(0xfd)](_0xbf3604,_0x38b539);}async[a358_0x2de683(0xec)](_0x56ac21){const _0x2916ff=a358_0x2de683;this[_0x2916ff(0x105)][_0x2916ff(0x12c)](_0x2916ff(0xf7));const _0x46eee5=veeva_constants_1['VeevaConstants']['ENDPOINT_CREATE_RECORDS']+_0x2916ff(0xf0);await this[_0x2916ff(0x109)]['deleteVeevaObjectRecords'](_0x46eee5,_0x56ac21);}async[a358_0x2de683(0x103)](_0x1bcc98,_0xadfb69){const _0x19d1c6=a358_0x2de683,_0x4da9af=await this['createOutboundPackages'](Math[_0x19d1c6(0x11a)](_0x1bcc98[_0x19d1c6(0x10a)]/veeva_constants_1[_0x19d1c6(0x121)]['MAXIMUM_SIZE_OF_PACKAGE']),_0xadfb69),_0x477a14=await this[_0x19d1c6(0x10d)](_0x1bcc98,_0x4da9af),_0x49fb6a=await this[_0x19d1c6(0xeb)](_0x4da9af),_0x404e0e=await this[_0x19d1c6(0x11f)](Array[_0x19d1c6(0x110)](_0x49fb6a['values']())),_0x5bc4d1=await this[_0x19d1c6(0xf1)](_0x404e0e),_0xde69f5=await this[_0x19d1c6(0xfb)](_0x5bc4d1);return await this[_0x19d1c6(0xf8)](_0x477a14),await this[_0x19d1c6(0xec)](_0x4da9af),_0xde69f5;}}exports[a358_0x2de683(0x122)]=PackageExportService;