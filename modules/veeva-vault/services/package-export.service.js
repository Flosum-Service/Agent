const a359_0x8686c7=a359_0x1bed;(function(_0x2534c9,_0x40c364){const _0x5f2ad1=a359_0x1bed,_0x1bc076=_0x2534c9();while(!![]){try{const _0x2fe5ef=parseInt(_0x5f2ad1(0xd3))/0x1+-parseInt(_0x5f2ad1(0xee))/0x2+parseInt(_0x5f2ad1(0xdb))/0x3+parseInt(_0x5f2ad1(0x103))/0x4*(parseInt(_0x5f2ad1(0xd4))/0x5)+parseInt(_0x5f2ad1(0xf4))/0x6*(parseInt(_0x5f2ad1(0xd8))/0x7)+-parseInt(_0x5f2ad1(0xff))/0x8+-parseInt(_0x5f2ad1(0xcd))/0x9*(parseInt(_0x5f2ad1(0xe4))/0xa);if(_0x2fe5ef===_0x40c364)break;else _0x1bc076['push'](_0x1bc076['shift']());}catch(_0xc41d81){_0x1bc076['push'](_0x1bc076['shift']());}}}(a359_0x5abd,0xeb20e));const a359_0x24114a=(function(){let _0x677bab=!![];return function(_0x1fef20,_0x59569f){const _0x4b42d4=_0x677bab?function(){if(_0x59569f){const _0x5c9f31=_0x59569f['apply'](_0x1fef20,arguments);return _0x59569f=null,_0x5c9f31;}}:function(){};return _0x677bab=![],_0x4b42d4;};}()),a359_0x373af8=a359_0x24114a(this,function(){const _0x9870e0=a359_0x1bed;return a359_0x373af8[_0x9870e0(0xfe)]()[_0x9870e0(0xcc)](_0x9870e0(0x105))[_0x9870e0(0xfe)]()[_0x9870e0(0x102)](a359_0x373af8)[_0x9870e0(0xcc)](_0x9870e0(0x105));});a359_0x373af8();'use strict';function a359_0x1bed(_0x5f0dd2,_0xac9993){const _0x3bf9e5=a359_0x5abd();return a359_0x1bed=function(_0x373af8,_0x24114a){_0x373af8=_0x373af8-0xbd;let _0x5abdeb=_0x3bf9e5[_0x373af8];return _0x5abdeb;},a359_0x1bed(_0x5f0dd2,_0xac9993);}var __importDefault=this&&this[a359_0x8686c7(0xbf)]||function(_0x500772){const _0x500571=a359_0x8686c7;return _0x500772&&_0x500772[_0x500571(0xe1)]?_0x500772:{'default':_0x500772};};Object[a359_0x8686c7(0xe5)](exports,a359_0x8686c7(0xe1),{'value':!![]}),exports[a359_0x8686c7(0xc4)]=void 0x0;const veeva_constants_1=require('../constants/veeva.constants'),jszip_1=__importDefault(require(a359_0x8686c7(0xde))),status_enums_1=require(a359_0x8686c7(0xce)),veeva_error_1=require(a359_0x8686c7(0xf0));function a359_0x5abd(){const _0x146066=['toString','692032KrVjjP','links','Retrieve\x20Jobs\x20Status','constructor','492824hJyLxf','href','(((.+)+)+)+$','deleteVeevaObjectRecords','createExportOutboundPackages','artifacts','ENDPOINT_EXPORT_IMPORT_PACKAGE','retrieveVPKList','application/x-www-form-urlencoded','__importDefault','VeevaConstants','getPackageNames','ceil','all','PackageExportService','outbound_package__v','post','Create\x20Export\x20outbound\x20packages.','includes','MAXIMUM_SIZE_OF_PACKAGE','content-type','createVeevaObjectRecords','search','9VQLuiY','../enums/status.enums','errors','default','Getting\x20names\x20of\x20outbound\x20packages','deletePackageComponents','726537RXyGqf','40rvRAoI','_logger','deleteOutboundPackages','VeevaError','27076yvPmxu','rel','reduce','4686099BaPUfd','package_component__v','getEndpointArtifactList','jszip','getJobResult','values','__esModule','Retrieve\x20Outbound\x20Package\x20zip\x20list','export','21054360SGwGqj','defineProperty','migration__sys','push','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','length','_connection','responseStatus','createOutboundPackages','VeevaResponseStatus','1561240qigJPo','name__v','../classes/errors/veeva-error','log','SUCCESS','Creating\x20outbound\x20packages','1026gusWKI','_veevaService','from','map','arraybuffer','Removing\x20components\x20from\x20outbound\x20packages.','createPackageComponents','ENDPOINT_CREATE_RECORDS','Adding\x20components\x20to\x20outbound\x20package','parse'];a359_0x5abd=function(){return _0x146066;};return a359_0x5abd();}class PackageExportService{constructor({veevaService:_0x420f8d,connection:_0x5403d6,logger:_0x49861e}){const _0x2ee3ea=a359_0x8686c7;this[_0x2ee3ea(0xf5)]=_0x420f8d,this['_connection']=_0x5403d6,this[_0x2ee3ea(0xd5)]=_0x49861e;}async['createOutboundPackages'](_0x1d6221,_0x167e27){const _0x8f39ff=a359_0x8686c7;this[_0x8f39ff(0xd5)][_0x8f39ff(0xf1)](_0x8f39ff(0xf3));const _0x43ad66=veeva_constants_1[_0x8f39ff(0xc0)][_0x8f39ff(0xfb)]+_0x8f39ff(0xc5),_0x36d376=new Array(_0x1d6221)['fill']({'summary__v':_0x167e27,'object_type__v.api__name__v':_0x8f39ff(0xe6)});return await this[_0x8f39ff(0xf5)][_0x8f39ff(0xcb)](_0x43ad66,_0x36d376);}async[a359_0x8686c7(0xfa)](_0x21bd3d,_0xa1995f){const _0x433394=a359_0x8686c7;this['_logger'][_0x433394(0xf1)](_0x433394(0xfc));const _0x11bdac=veeva_constants_1[_0x433394(0xc0)][_0x433394(0xfb)]+_0x433394(0xdc),_0x194715=_0x21bd3d[_0x433394(0xf7)]((_0xbca0d6,_0x5a6aa5)=>({'vault_component__v':_0xbca0d6['id'],'outbound_package__v':_0xa1995f[Math[_0x433394(0xc2)]((_0x5a6aa5+0x1)/veeva_constants_1[_0x433394(0xc0)][_0x433394(0xc9)])-0x1]}));return await this['_veevaService'][_0x433394(0xcb)](_0x11bdac,_0x194715);}async[a359_0x8686c7(0xc1)](_0x52010b){const _0xb7e097=a359_0x8686c7;this[_0xb7e097(0xd5)][_0xb7e097(0xf1)](_0xb7e097(0xd1));const _0x2dbae9=_0xb7e097(0xe8)+_0x52010b['join']('\x27,\x27')+'\x27)',_0x31c7a8=await this[_0xb7e097(0xf5)]['executeVQL'](_0x2dbae9);return _0x31c7a8[_0xb7e097(0xda)]((_0x2ff001,_0x214491)=>_0x2ff001['set'](_0x214491['id'],_0x214491[_0xb7e097(0xef)]),new Map());}async[a359_0x8686c7(0x107)](_0x9fb5a7){const _0x40d20c=a359_0x8686c7;this[_0x40d20c(0xd5)][_0x40d20c(0xf1)](_0x40d20c(0xc7));const _0x2b1e13=[],_0x4962a3=_0x9fb5a7['map'](_0x5bef1d=>{const _0x19931d=_0x40d20c;return this[_0x19931d(0xea)][_0x19931d(0xc6)](veeva_constants_1[_0x19931d(0xc0)][_0x19931d(0x109)],encodeURI('packageName')+'='+encodeURI(_0x5bef1d),{'headers':{'Content-Type':_0x19931d(0xbe)}});}),_0x5cd63e=await Promise[_0x40d20c(0xc3)](_0x4962a3);for(const {data:_0xcd6644}of _0x5cd63e){if(_0xcd6644[_0x40d20c(0xeb)]===status_enums_1[_0x40d20c(0xed)][_0x40d20c(0xf2)]){const {url:_0x2b19f2}=_0xcd6644;_0x2b1e13[_0x40d20c(0xe7)](_0x2b19f2);}else throw new veeva_error_1[(_0x40d20c(0xd7))](_0xcd6644[_0x40d20c(0xcf)]);}return _0x2b1e13;}async['getEndpointArtifactList'](_0x3c51cc){const _0x1e0dd9=a359_0x8686c7;this[_0x1e0dd9(0xd5)][_0x1e0dd9(0xf1)](_0x1e0dd9(0x101));const _0x51e0a4=[],_0x51122a=await this[_0x1e0dd9(0xf5)][_0x1e0dd9(0xdf)](_0x3c51cc);for(const _0x56bec6 of _0x51122a){const _0x3b3601=_0x56bec6[_0x1e0dd9(0x100)]['filter'](_0x5ad26d=>_0x5ad26d[_0x1e0dd9(0xd9)]===_0x1e0dd9(0x108))[_0x1e0dd9(0xf7)](_0x4e8542=>_0x4e8542[_0x1e0dd9(0x104)]);_0x51e0a4[_0x1e0dd9(0xe7)](..._0x3b3601);}return _0x51e0a4;}async['retrieveVPKList'](_0x2f8385){const _0x2ea312=a359_0x8686c7;var _0x316aa8;const _0x247a81=[];this[_0x2ea312(0xd5)][_0x2ea312(0xf1)](_0x2ea312(0xe2));for(const _0x1daef3 of _0x2f8385){const {data:_0x3155a2,headers:_0x1f9962}=await this['_connection']['get'](_0x1daef3,{'responseType':_0x2ea312(0xf8)}),_0x1d4681=(_0x316aa8=_0x1f9962[_0x2ea312(0xca)])===null||_0x316aa8===void 0x0?void 0x0:_0x316aa8[_0x2ea312(0xc8)]('application/json');if(!_0x1d4681){const _0x5d44d8=_0x3155a2,_0x5ed394=new jszip_1[(_0x2ea312(0xd0))]();await _0x5ed394['loadAsync'](_0x5d44d8),_0x247a81[_0x2ea312(0xe7)](_0x5ed394);}else{const _0x1db01a=JSON[_0x2ea312(0xfd)](_0x3155a2);throw new veeva_error_1[(_0x2ea312(0xd7))](_0x1db01a[_0x2ea312(0xcf)]);}}return _0x247a81;}async[a359_0x8686c7(0xd2)](_0x159d67){const _0x47ba29=a359_0x8686c7;this[_0x47ba29(0xd5)][_0x47ba29(0xf1)](_0x47ba29(0xf9));const _0x54c8bc=veeva_constants_1[_0x47ba29(0xc0)][_0x47ba29(0xfb)]+_0x47ba29(0xdc);await this['_veevaService'][_0x47ba29(0x106)](_0x54c8bc,_0x159d67);}async['deleteOutboundPackages'](_0x505699){const _0x80a07f=a359_0x8686c7;this[_0x80a07f(0xd5)]['log']('Deleting\x20outbound\x20packages.');const _0x19ba81=veeva_constants_1[_0x80a07f(0xc0)]['ENDPOINT_CREATE_RECORDS']+_0x80a07f(0xc5);await this[_0x80a07f(0xf5)][_0x80a07f(0x106)](_0x19ba81,_0x505699);}async[a359_0x8686c7(0xe3)](_0x56fcd9,_0x950512){const _0x4d753d=a359_0x8686c7,_0x50cfe9=await this[_0x4d753d(0xec)](Math[_0x4d753d(0xc2)](_0x56fcd9[_0x4d753d(0xe9)]/veeva_constants_1['VeevaConstants'][_0x4d753d(0xc9)]),_0x950512),_0x5be66c=await this[_0x4d753d(0xfa)](_0x56fcd9,_0x50cfe9),_0xc06bbd=await this[_0x4d753d(0xc1)](_0x50cfe9),_0x50a427=await this[_0x4d753d(0x107)](Array[_0x4d753d(0xf6)](_0xc06bbd[_0x4d753d(0xe0)]())),_0x4c43c9=await this[_0x4d753d(0xdd)](_0x50a427),_0x3dc449=await this[_0x4d753d(0xbd)](_0x4c43c9);return await this['deletePackageComponents'](_0x5be66c),await this[_0x4d753d(0xd6)](_0x50cfe9),_0x3dc449;}}exports[a359_0x8686c7(0xc4)]=PackageExportService;