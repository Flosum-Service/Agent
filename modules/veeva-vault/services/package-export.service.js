function a359_0x4060(){const _0x45fa4b=['errors','getJobResult','set','href','\x27,\x27','log','apply','ENDPOINT_VQL','Creating\x20outbound\x20packages','_logger','name__v','Getting\x20names\x20of\x20outbound\x20packages','VeevaResponseStatus','1493730vpazty','SUCCESS','createOutboundPackages','Create\x20Export\x20outbound\x20packages.','_veevaService','application/json','getEndpointArtifactList','search','ENDPOINT_CREATE_RECORDS','all','links','createVeevaObjectRecords','packageName','850231PWVrSi','parse','reduce','toString','9538614FNpYXn','__esModule','../constants/veeva.constants','retrieveVPKList','VeevaConstants','PackageExportService','6699xOhrZV','package_component__v','deletePackageComponents','responseStatus','arraybuffer','join','includes','fill','Adding\x20components\x20to\x20outbound\x20package','rel','from','content-type','__importDefault','Removing\x20components\x20from\x20outbound\x20packages.','(((.+)+)+)+$','8312HdAahR','1963225vuKgiX','ENDPOINT_EXPORT_IMPORT_PACKAGE','1718740lRTXRN','Retrieve\x20Jobs\x20Status','VeevaError','../enums/status.enums','map','get','Retrieve\x20Outbound\x20Package\x20zip\x20list','artifacts','push','application/x-www-form-urlencoded','createPackageComponents','6EXYgxX','deleteOutboundPackages','deleteVeevaObjectRecords','1903120LiAvxr','_connection','filter','defineProperty','createExportOutboundPackages','outbound_package__v'];a359_0x4060=function(){return _0x45fa4b;};return a359_0x4060();}const a359_0x4ff266=a359_0x2531;(function(_0x45dbec,_0x4557e7){const _0x258209=a359_0x2531,_0x17d620=_0x45dbec();while(!![]){try{const _0x73b0da=-parseInt(_0x258209(0x10c))/0x1+parseInt(_0x258209(0x128))/0x2+parseInt(_0x258209(0x149))/0x3+parseInt(_0x258209(0x136))/0x4+parseInt(_0x258209(0x126))/0x5*(-parseInt(_0x258209(0x133))/0x6)+-parseInt(_0x258209(0x116))/0x7*(parseInt(_0x258209(0x125))/0x8)+parseInt(_0x258209(0x110))/0x9;if(_0x73b0da===_0x4557e7)break;else _0x17d620['push'](_0x17d620['shift']());}catch(_0x50c242){_0x17d620['push'](_0x17d620['shift']());}}}(a359_0x4060,0xa015b));const a359_0x55eac8=(function(){let _0x4fa3d2=!![];return function(_0x3f5ddb,_0xfeee87){const _0x5bbabb=_0x4fa3d2?function(){const _0x203ba7=a359_0x2531;if(_0xfeee87){const _0x5b8b79=_0xfeee87[_0x203ba7(0x142)](_0x3f5ddb,arguments);return _0xfeee87=null,_0x5b8b79;}}:function(){};return _0x4fa3d2=![],_0x5bbabb;};}()),a359_0x481455=a359_0x55eac8(this,function(){const _0x1950e6=a359_0x2531;return a359_0x481455[_0x1950e6(0x10f)]()[_0x1950e6(0x106)](_0x1950e6(0x124))[_0x1950e6(0x10f)]()['constructor'](a359_0x481455)[_0x1950e6(0x106)]('(((.+)+)+)+$');});function a359_0x2531(_0x279053,_0x579d47){const _0x39a940=a359_0x4060();return a359_0x2531=function(_0x481455,_0x55eac8){_0x481455=_0x481455-0x103;let _0x40605b=_0x39a940[_0x481455];return _0x40605b;},a359_0x2531(_0x279053,_0x579d47);}a359_0x481455();'use strict';var __importDefault=this&&this[a359_0x4ff266(0x122)]||function(_0x24adfa){const _0x51a27a=a359_0x4ff266;return _0x24adfa&&_0x24adfa[_0x51a27a(0x111)]?_0x24adfa:{'default':_0x24adfa};};Object[a359_0x4ff266(0x139)](exports,a359_0x4ff266(0x111),{'value':!![]}),exports[a359_0x4ff266(0x115)]=void 0x0;const veeva_constants_1=require(a359_0x4ff266(0x112)),jszip_1=__importDefault(require('jszip')),status_enums_1=require(a359_0x4ff266(0x12b)),veeva_error_1=require('../classes/errors/veeva-error');class PackageExportService{constructor({veevaService:_0xf315e7,connection:_0x41ff63,logger:_0xc49062}){const _0x4f3ff1=a359_0x4ff266;this['_veevaService']=_0xf315e7,this[_0x4f3ff1(0x137)]=_0x41ff63,this[_0x4f3ff1(0x145)]=_0xc49062;}async[a359_0x4ff266(0x14b)](_0x52ecb6,_0x3aba55){const _0x27b775=a359_0x4ff266;this[_0x27b775(0x145)][_0x27b775(0x141)](_0x27b775(0x144));const _0x361d85=veeva_constants_1['VeevaConstants'][_0x27b775(0x107)]+_0x27b775(0x13b),_0x5942ea=new Array(_0x52ecb6)[_0x27b775(0x11d)]({'summary__v':_0x3aba55,'object_type__v.api__name__v':'migration__sys'});return await this[_0x27b775(0x103)][_0x27b775(0x10a)](_0x361d85,_0x5942ea);}async[a359_0x4ff266(0x132)](_0x456428,_0x11b5dd){const _0x2ae95e=a359_0x4ff266;this[_0x2ae95e(0x145)][_0x2ae95e(0x141)](_0x2ae95e(0x11e));const _0x4d9f60=veeva_constants_1[_0x2ae95e(0x114)][_0x2ae95e(0x107)]+'package_component__v',_0x2a5ca6=_0x456428[_0x2ae95e(0x12c)]((_0x40130e,_0x3079a5)=>({'vault_component__v':_0x40130e['id'],'outbound_package__v':_0x11b5dd[Math['ceil']((_0x3079a5+0x1)/veeva_constants_1[_0x2ae95e(0x114)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this['_veevaService'][_0x2ae95e(0x10a)](_0x4d9f60,_0x2a5ca6);}async['getPackageNames'](_0x4d85a3){const _0x5c4290=a359_0x4ff266;this[_0x5c4290(0x145)][_0x5c4290(0x141)](_0x5c4290(0x147));const _0x21c5bd='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x4d85a3[_0x5c4290(0x11b)](_0x5c4290(0x140))+'\x27)',_0x1472a5=veeva_constants_1[_0x5c4290(0x114)][_0x5c4290(0x143)]+_0x21c5bd,_0x6ce95=await this['_veevaService']['executeVQL'](_0x1472a5);return _0x6ce95[_0x5c4290(0x10e)]((_0x1b48e9,_0x324622)=>_0x1b48e9[_0x5c4290(0x13e)](_0x324622['id'],_0x324622[_0x5c4290(0x146)]),new Map());}async[a359_0x4ff266(0x13a)](_0x464479){const _0x1284a4=a359_0x4ff266;this[_0x1284a4(0x145)][_0x1284a4(0x141)](_0x1284a4(0x14c));const _0x2c8b9f=[],_0x3e2d8d=_0x464479[_0x1284a4(0x12c)](_0x4b0983=>{const _0x4945a8=_0x1284a4;return this[_0x4945a8(0x137)]['post'](veeva_constants_1[_0x4945a8(0x114)][_0x4945a8(0x127)],encodeURI(_0x4945a8(0x10b))+'='+encodeURI(_0x4b0983),{'headers':{'Content-Type':_0x4945a8(0x131)}});}),_0x3e5aca=await Promise[_0x1284a4(0x108)](_0x3e2d8d);for(const {data:_0x1b145b}of _0x3e5aca){if(_0x1b145b[_0x1284a4(0x119)]===status_enums_1[_0x1284a4(0x148)][_0x1284a4(0x14a)]){const {url:_0x1fcc68}=_0x1b145b;_0x2c8b9f[_0x1284a4(0x130)](_0x1fcc68);}else throw new veeva_error_1[(_0x1284a4(0x12a))](_0x1b145b[_0x1284a4(0x13c)]);}return _0x2c8b9f;}async[a359_0x4ff266(0x105)](_0x3696f9){const _0x4c72dc=a359_0x4ff266;this[_0x4c72dc(0x145)][_0x4c72dc(0x141)](_0x4c72dc(0x129));const _0x77f54a=[],_0x4a7a13=await this[_0x4c72dc(0x103)][_0x4c72dc(0x13d)](_0x3696f9);for(const _0x15d94b of _0x4a7a13){const _0x52ebcc=_0x15d94b[_0x4c72dc(0x109)][_0x4c72dc(0x138)](_0xbf0e41=>_0xbf0e41[_0x4c72dc(0x11f)]===_0x4c72dc(0x12f))[_0x4c72dc(0x12c)](_0x22f635=>_0x22f635[_0x4c72dc(0x13f)]);_0x77f54a['push'](..._0x52ebcc);}return _0x77f54a;}async[a359_0x4ff266(0x113)](_0x57e4a4){const _0x81b7c2=a359_0x4ff266;var _0x3ae748;const _0x476dc1=[];this[_0x81b7c2(0x145)][_0x81b7c2(0x141)](_0x81b7c2(0x12e));for(const _0x3e8bc2 of _0x57e4a4){const {data:_0x334d3a,headers:_0x78a915}=await this[_0x81b7c2(0x137)][_0x81b7c2(0x12d)](_0x3e8bc2,{'responseType':_0x81b7c2(0x11a)}),_0x4cf178=(_0x3ae748=_0x78a915[_0x81b7c2(0x121)])===null||_0x3ae748===void 0x0?void 0x0:_0x3ae748[_0x81b7c2(0x11c)](_0x81b7c2(0x104));if(!_0x4cf178){const _0x21c78f=_0x334d3a,_0x825f8a=new jszip_1['default']();await _0x825f8a['loadAsync'](_0x21c78f),_0x476dc1[_0x81b7c2(0x130)](_0x825f8a);}else{const _0x322d7d=JSON[_0x81b7c2(0x10d)](_0x334d3a);throw new veeva_error_1[(_0x81b7c2(0x12a))](_0x322d7d[_0x81b7c2(0x13c)]);}}return _0x476dc1;}async[a359_0x4ff266(0x118)](_0x37f16b){const _0x211211=a359_0x4ff266;this[_0x211211(0x145)]['log'](_0x211211(0x123));const _0x3b4529=veeva_constants_1[_0x211211(0x114)]['ENDPOINT_CREATE_RECORDS']+_0x211211(0x117);await this['_veevaService'][_0x211211(0x135)](_0x3b4529,_0x37f16b);}async['deleteOutboundPackages'](_0x5d441a){const _0x5a9b16=a359_0x4ff266;this['_logger'][_0x5a9b16(0x141)]('Deleting\x20outbound\x20packages.');const _0x4d3d8d=veeva_constants_1['VeevaConstants'][_0x5a9b16(0x107)]+_0x5a9b16(0x13b);await this[_0x5a9b16(0x103)][_0x5a9b16(0x135)](_0x4d3d8d,_0x5d441a);}async['export'](_0x4d1648,_0x2f6d3d){const _0x2ebb5b=a359_0x4ff266,_0x3d0b3c=await this['createOutboundPackages'](Math['ceil'](_0x4d1648['length']/veeva_constants_1['VeevaConstants']['MAXIMUM_SIZE_OF_PACKAGE']),_0x2f6d3d),_0x38ec9a=await this['createPackageComponents'](_0x4d1648,_0x3d0b3c),_0x41776d=await this['getPackageNames'](_0x3d0b3c),_0x1a8ce1=await this[_0x2ebb5b(0x13a)](Array[_0x2ebb5b(0x120)](_0x41776d['values']())),_0x20ebdd=await this['getEndpointArtifactList'](_0x1a8ce1),_0x4a005c=await this[_0x2ebb5b(0x113)](_0x20ebdd);return await this[_0x2ebb5b(0x118)](_0x38ec9a),await this[_0x2ebb5b(0x134)](_0x3d0b3c),_0x4a005c;}}exports['PackageExportService']=PackageExportService;