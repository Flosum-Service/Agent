const a403_0x5a977c=a403_0x1946;(function(_0x8e1276,_0x1d095e){const _0x5efbe7=a403_0x1946,_0xac4bef=_0x8e1276();while(!![]){try{const _0x19bec4=-parseInt(_0x5efbe7(0xde))/0x1+-parseInt(_0x5efbe7(0xb5))/0x2*(parseInt(_0x5efbe7(0xaf))/0x3)+-parseInt(_0x5efbe7(0xec))/0x4*(-parseInt(_0x5efbe7(0xdd))/0x5)+-parseInt(_0x5efbe7(0xe0))/0x6*(parseInt(_0x5efbe7(0xd0))/0x7)+parseInt(_0x5efbe7(0xd2))/0x8+-parseInt(_0x5efbe7(0xbf))/0x9*(parseInt(_0x5efbe7(0xc1))/0xa)+-parseInt(_0x5efbe7(0xe4))/0xb*(-parseInt(_0x5efbe7(0xa8))/0xc);if(_0x19bec4===_0x1d095e)break;else _0xac4bef['push'](_0xac4bef['shift']());}catch(_0x2ebd1c){_0xac4bef['push'](_0xac4bef['shift']());}}}(a403_0x57fe,0x4907e));const a403_0x27615b=(function(){let _0x3c7c2f=!![];return function(_0x9aa14c,_0x1a314d){const _0x491db3=_0x3c7c2f?function(){if(_0x1a314d){const _0x1e11e4=_0x1a314d['apply'](_0x9aa14c,arguments);return _0x1a314d=null,_0x1e11e4;}}:function(){};return _0x3c7c2f=![],_0x491db3;};}()),a403_0x2665fd=a403_0x27615b(this,function(){const _0x5849ce=a403_0x1946;return a403_0x2665fd[_0x5849ce(0xce)]()[_0x5849ce(0xcc)]('(((.+)+)+)+$')[_0x5849ce(0xce)]()[_0x5849ce(0xb7)](a403_0x2665fd)[_0x5849ce(0xcc)](_0x5849ce(0xe7));});a403_0x2665fd();function a403_0x57fe(){const _0x58cad3=['SUCCESS','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','log','4JZqmbx','push','deletePackageComponents','Removing\x20components\x20from\x20outbound\x20packages.','reduce','includes','links','../enums/status.enums','_logger','getPackageNames','name__v','29772HxUtgX','errors','VeevaConstants','arraybuffer','createPackageComponents','artifacts','Getting\x20names\x20of\x20outbound\x20packages','9PTzVDo','\x27,\x27','Create\x20Export\x20outbound\x20packages.','createVeevaObjectRecords','MAXIMUM_SIZE_OF_PACKAGE','executeVQL','71818lhmLVH','outbound_package__v','constructor','retrieveVPKList','getJobResult','application/x-www-form-urlencoded','ceil','jszip','parse','all','510381CRNUvt','fill','90obIqIm','loadAsync','createOutboundPackages','responseStatus','PackageExportService','createExportOutboundPackages','packageName','set','filter','__esModule','ENDPOINT_EXPORT_IMPORT_PACKAGE','search','Deleting\x20outbound\x20packages.','toString','ENDPOINT_CREATE_RECORDS','8295UgIHvW','Adding\x20components\x20to\x20outbound\x20package','2077360mEMTGD','rel','../constants/veeva.constants','defineProperty','join','Retrieve\x20Jobs\x20Status','VeevaError','deleteOutboundPackages','Retrieve\x20Outbound\x20Package\x20zip\x20list','deleteVeevaObjectRecords','post','2839045ULIYeR','596505KnYbJC','package_component__v','834wqaHUS','map','_connection','from','3773uquLQh','getEndpointArtifactList','VeevaResponseStatus','(((.+)+)+)+$','_veevaService'];a403_0x57fe=function(){return _0x58cad3;};return a403_0x57fe();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x48f787){const _0x4437a0=a403_0x1946;return _0x48f787&&_0x48f787[_0x4437a0(0xca)]?_0x48f787:{'default':_0x48f787};};Object[a403_0x5a977c(0xd5)](exports,a403_0x5a977c(0xca),{'value':!![]}),exports[a403_0x5a977c(0xc5)]=void 0x0;const veeva_constants_1=require(a403_0x5a977c(0xd4)),jszip_1=__importDefault(require(a403_0x5a977c(0xbc))),status_enums_1=require(a403_0x5a977c(0xf3)),veeva_error_1=require('../classes/errors/veeva-error');function a403_0x1946(_0x3d8830,_0x4ff379){const _0x3f7ff3=a403_0x57fe();return a403_0x1946=function(_0x2665fd,_0x27615b){_0x2665fd=_0x2665fd-0xa5;let _0x57fe15=_0x3f7ff3[_0x2665fd];return _0x57fe15;},a403_0x1946(_0x3d8830,_0x4ff379);}class PackageExportService{constructor({veevaService:_0x4a4634,connection:_0x353a75,logger:_0x5b95de}){const _0xa51eca=a403_0x5a977c;this['_veevaService']=_0x4a4634,this[_0xa51eca(0xe2)]=_0x353a75,this[_0xa51eca(0xa5)]=_0x5b95de;}async['createOutboundPackages'](_0x47b72f,_0x1b893d){const _0x1a42f6=a403_0x5a977c;this[_0x1a42f6(0xa5)][_0x1a42f6(0xeb)]('Creating\x20outbound\x20packages');const _0x5c0669=veeva_constants_1[_0x1a42f6(0xaa)][_0x1a42f6(0xcf)]+_0x1a42f6(0xb6),_0x9b1765=new Array(_0x47b72f)[_0x1a42f6(0xc0)]({'summary__v':_0x1b893d,'object_type__v.api__name__v':'migration__sys'});return await this['_veevaService'][_0x1a42f6(0xb2)](_0x5c0669,_0x9b1765);}async[a403_0x5a977c(0xac)](_0x9bbb8c,_0x17638e){const _0x505ec6=a403_0x5a977c;this[_0x505ec6(0xa5)][_0x505ec6(0xeb)](_0x505ec6(0xd1));const _0x5b2bc0=veeva_constants_1[_0x505ec6(0xaa)][_0x505ec6(0xcf)]+_0x505ec6(0xdf),_0x49bd85=_0x9bbb8c[_0x505ec6(0xe1)]((_0x45a17a,_0x3c315f)=>({'vault_component__v':_0x45a17a['id'],'outbound_package__v':_0x17638e[Math[_0x505ec6(0xbb)]((_0x3c315f+0x1)/veeva_constants_1[_0x505ec6(0xaa)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this[_0x505ec6(0xe8)][_0x505ec6(0xb2)](_0x5b2bc0,_0x49bd85);}async[a403_0x5a977c(0xa6)](_0x5277c1){const _0x17130c=a403_0x5a977c;this[_0x17130c(0xa5)][_0x17130c(0xeb)](_0x17130c(0xae));const _0x524de0=_0x17130c(0xea)+_0x5277c1[_0x17130c(0xd6)](_0x17130c(0xb0))+'\x27)',_0x528175=await this[_0x17130c(0xe8)][_0x17130c(0xb4)](_0x524de0);return _0x528175[_0x17130c(0xf0)]((_0x53157c,_0x43e781)=>_0x53157c[_0x17130c(0xc8)](_0x43e781['id'],_0x43e781[_0x17130c(0xa7)]),new Map());}async[a403_0x5a977c(0xc6)](_0x8c7814){const _0x4f8dc9=a403_0x5a977c;this['_logger'][_0x4f8dc9(0xeb)](_0x4f8dc9(0xb1));const _0x3a3a65=[],_0x3c9e69=_0x8c7814[_0x4f8dc9(0xe1)](_0x245840=>{const _0x4d9057=_0x4f8dc9;return this[_0x4d9057(0xe2)][_0x4d9057(0xdc)](veeva_constants_1[_0x4d9057(0xaa)][_0x4d9057(0xcb)],encodeURI(_0x4d9057(0xc7))+'='+encodeURI(_0x245840),{'headers':{'Content-Type':_0x4d9057(0xba)}});}),_0xd7af6d=await Promise[_0x4f8dc9(0xbe)](_0x3c9e69);for(const {data:_0x53a009}of _0xd7af6d){if(_0x53a009[_0x4f8dc9(0xc4)]===status_enums_1[_0x4f8dc9(0xe6)][_0x4f8dc9(0xe9)]){const {url:_0x4571e6}=_0x53a009;_0x3a3a65['push'](_0x4571e6);}else throw new veeva_error_1[(_0x4f8dc9(0xd8))](_0x53a009[_0x4f8dc9(0xa9)]);}return _0x3a3a65;}async[a403_0x5a977c(0xe5)](_0x1b6975){const _0x11b505=a403_0x5a977c;this[_0x11b505(0xa5)]['log'](_0x11b505(0xd7));const _0x336efb=[],_0x315041=await this[_0x11b505(0xe8)][_0x11b505(0xb9)](_0x1b6975);for(const _0x253abb of _0x315041){const _0x130ee0=_0x253abb[_0x11b505(0xf2)][_0x11b505(0xc9)](_0x193432=>_0x193432[_0x11b505(0xd3)]===_0x11b505(0xad))[_0x11b505(0xe1)](_0x99c3fc=>_0x99c3fc['href']);_0x336efb['push'](..._0x130ee0);}return _0x336efb;}async[a403_0x5a977c(0xb8)](_0x20e1b9){const _0x114efa=a403_0x5a977c;var _0x1e8ba7;const _0x1411cb=[];this[_0x114efa(0xa5)]['log'](_0x114efa(0xda));for(const _0x1bcb5b of _0x20e1b9){const {data:_0x2784c0,headers:_0x4ec15a}=await this[_0x114efa(0xe2)]['get'](_0x1bcb5b,{'responseType':_0x114efa(0xab)}),_0x4648e1=(_0x1e8ba7=_0x4ec15a['content-type'])===null||_0x1e8ba7===void 0x0?void 0x0:_0x1e8ba7[_0x114efa(0xf1)]('application/json');if(!_0x4648e1){const _0x1f7673=_0x2784c0,_0x2bcda1=new jszip_1['default']();await _0x2bcda1[_0x114efa(0xc2)](_0x1f7673),_0x1411cb[_0x114efa(0xed)](_0x2bcda1);}else{const _0x2d1849=JSON[_0x114efa(0xbd)](_0x2784c0);throw new veeva_error_1[(_0x114efa(0xd8))](_0x2d1849['errors']);}}return _0x1411cb;}async['deletePackageComponents'](_0x190bce){const _0x115cd9=a403_0x5a977c;this[_0x115cd9(0xa5)][_0x115cd9(0xeb)](_0x115cd9(0xef));const _0x1d0623=veeva_constants_1[_0x115cd9(0xaa)][_0x115cd9(0xcf)]+'package_component__v';await this['_veevaService'][_0x115cd9(0xdb)](_0x1d0623,_0x190bce);}async[a403_0x5a977c(0xd9)](_0x56db97){const _0x5e4579=a403_0x5a977c;this[_0x5e4579(0xa5)][_0x5e4579(0xeb)](_0x5e4579(0xcd));const _0x353913=veeva_constants_1[_0x5e4579(0xaa)][_0x5e4579(0xcf)]+_0x5e4579(0xb6);await this['_veevaService'][_0x5e4579(0xdb)](_0x353913,_0x56db97);}async['export'](_0xec9a98,_0x3a61ac){const _0x306c5d=a403_0x5a977c,_0x238919=await this[_0x306c5d(0xc3)](Math[_0x306c5d(0xbb)](_0xec9a98['length']/veeva_constants_1['VeevaConstants'][_0x306c5d(0xb3)]),_0x3a61ac),_0x3aaf7a=await this[_0x306c5d(0xac)](_0xec9a98,_0x238919),_0x1bf948=await this[_0x306c5d(0xa6)](_0x238919),_0x13a8f2=await this[_0x306c5d(0xc6)](Array[_0x306c5d(0xe3)](_0x1bf948['values']())),_0x32fc92=await this['getEndpointArtifactList'](_0x13a8f2),_0x9cb911=await this[_0x306c5d(0xb8)](_0x32fc92);return await this[_0x306c5d(0xee)](_0x3aaf7a),await this[_0x306c5d(0xd9)](_0x238919),_0x9cb911;}}exports[a403_0x5a977c(0xc5)]=PackageExportService;