function a335_0x6a95(){const _0x17f6c2=['ENDPOINT_EXPORT_IMPORT_PACKAGE','Retrieve\x20Jobs\x20Status','1487984FMVDYy','deleteVeevaObjectRecords','application/x-www-form-urlencoded','jszip','createOutboundPackages','toString','packageName','Retrieve\x20Outbound\x20Package\x20zip\x20list','Removing\x20components\x20from\x20outbound\x20packages.','deletePackageComponents','__esModule','export','filter','Deleting\x20outbound\x20packages.','4906174gUzvrT','all','push','getJobResult','search','deleteOutboundPackages','__importDefault','VeevaConstants','2SyRgvE','Creating\x20outbound\x20packages','ceil','post','errors','href','defineProperty','apply','558296bxoVSg','name__v','MAXIMUM_SIZE_OF_PACKAGE','2698998kMxrts','ENDPOINT_CREATE_RECORDS','4829yXPCjs','../enums/status.enums','application/json','VeevaResponseStatus','_veevaService','log','createPackageComponents','set','links','9cWTMIp','SUCCESS','package_component__v','map','retrieveVPKList','createVeevaObjectRecords','createExportOutboundPackages','getEndpointArtifactList','executeVQL','448832qNoytA','fill','get','outbound_package__v','getPackageNames','constructor','_logger','Create\x20Export\x20outbound\x20packages.','29860cSfPSV','rel','25ZMgXbI','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','migration__sys','PackageExportService','from','_connection','default','(((.+)+)+)+$','length','\x27,\x27','ENDPOINT_VQL','1035030Mtyzmm','reduce'];a335_0x6a95=function(){return _0x17f6c2;};return a335_0x6a95();}const a335_0x2ab2f0=a335_0x52a3;(function(_0x241c1f,_0x2f8086){const _0x18046f=a335_0x52a3,_0x191787=_0x241c1f();while(!![]){try{const _0x2ec985=parseInt(_0x18046f(0x1ad))/0x1+-parseInt(_0x18046f(0x1a5))/0x2*(parseInt(_0x18046f(0x1b0))/0x3)+-parseInt(_0x18046f(0x176))/0x4+parseInt(_0x18046f(0x180))/0x5*(-parseInt(_0x18046f(0x18b))/0x6)+parseInt(_0x18046f(0x19d))/0x7+parseInt(_0x18046f(0x18f))/0x8*(-parseInt(_0x18046f(0x1bb))/0x9)+parseInt(_0x18046f(0x17e))/0xa*(parseInt(_0x18046f(0x1b2))/0xb);if(_0x2ec985===_0x2f8086)break;else _0x191787['push'](_0x191787['shift']());}catch(_0x74070f){_0x191787['push'](_0x191787['shift']());}}}(a335_0x6a95,0x7c6c3));const a335_0x37c856=(function(){let _0xed91b9=!![];return function(_0x4ea8fa,_0x385e98){const _0x6f0997=_0xed91b9?function(){const _0x4e04a5=a335_0x52a3;if(_0x385e98){const _0x3f0cb1=_0x385e98[_0x4e04a5(0x1ac)](_0x4ea8fa,arguments);return _0x385e98=null,_0x3f0cb1;}}:function(){};return _0xed91b9=![],_0x6f0997;};}()),a335_0x391d8f=a335_0x37c856(this,function(){const _0x532e10=a335_0x52a3;return a335_0x391d8f[_0x532e10(0x194)]()[_0x532e10(0x1a1)]('(((.+)+)+)+$')[_0x532e10(0x194)]()[_0x532e10(0x17b)](a335_0x391d8f)[_0x532e10(0x1a1)](_0x532e10(0x187));});a335_0x391d8f();'use strict';var __importDefault=this&&this[a335_0x2ab2f0(0x1a3)]||function(_0x105ab6){const _0x1f4457=a335_0x2ab2f0;return _0x105ab6&&_0x105ab6[_0x1f4457(0x199)]?_0x105ab6:{'default':_0x105ab6};};Object[a335_0x2ab2f0(0x1ab)](exports,a335_0x2ab2f0(0x199),{'value':!![]}),exports['PackageExportService']=void 0x0;const veeva_constants_1=require('../constants/veeva.constants'),jszip_1=__importDefault(require(a335_0x2ab2f0(0x192))),status_enums_1=require(a335_0x2ab2f0(0x1b3)),veeva_error_1=require('../classes/errors/veeva-error');function a335_0x52a3(_0x317e28,_0x364f39){const _0x27dc53=a335_0x6a95();return a335_0x52a3=function(_0x391d8f,_0x37c856){_0x391d8f=_0x391d8f-0x174;let _0x6a951a=_0x27dc53[_0x391d8f];return _0x6a951a;},a335_0x52a3(_0x317e28,_0x364f39);}class PackageExportService{constructor({veevaService:_0x5b0160,connection:_0x74b7f2,logger:_0x54b354}){const _0xe704f1=a335_0x2ab2f0;this[_0xe704f1(0x1b6)]=_0x5b0160,this[_0xe704f1(0x185)]=_0x74b7f2,this[_0xe704f1(0x17c)]=_0x54b354;}async[a335_0x2ab2f0(0x193)](_0x271768,_0x26075f){const _0x5380ee=a335_0x2ab2f0;this[_0x5380ee(0x17c)]['log'](_0x5380ee(0x1a6));const _0x6c6903=veeva_constants_1['VeevaConstants'][_0x5380ee(0x1b1)]+_0x5380ee(0x179),_0x41edd4=new Array(_0x271768)[_0x5380ee(0x177)]({'summary__v':_0x26075f,'object_type__v.api__name__v':_0x5380ee(0x182)});return await this[_0x5380ee(0x1b6)][_0x5380ee(0x1c0)](_0x6c6903,_0x41edd4);}async[a335_0x2ab2f0(0x1b8)](_0x146f37,_0x1d8463){const _0x41fd3d=a335_0x2ab2f0;this['_logger'][_0x41fd3d(0x1b7)]('Adding\x20components\x20to\x20outbound\x20package');const _0x5e2ac4=veeva_constants_1[_0x41fd3d(0x1a4)][_0x41fd3d(0x1b1)]+_0x41fd3d(0x1bd),_0x3808a6=_0x146f37[_0x41fd3d(0x1be)]((_0x2496d3,_0x40d200)=>({'vault_component__v':_0x2496d3['id'],'outbound_package__v':_0x1d8463[Math['ceil']((_0x40d200+0x1)/veeva_constants_1[_0x41fd3d(0x1a4)][_0x41fd3d(0x1af)])-0x1]}));return await this[_0x41fd3d(0x1b6)][_0x41fd3d(0x1c0)](_0x5e2ac4,_0x3808a6);}async[a335_0x2ab2f0(0x17a)](_0x56348d){const _0x3c61af=a335_0x2ab2f0;this[_0x3c61af(0x17c)]['log']('Getting\x20names\x20of\x20outbound\x20packages');const _0x140751=_0x3c61af(0x181)+_0x56348d['join'](_0x3c61af(0x189))+'\x27)',_0x22be94=veeva_constants_1[_0x3c61af(0x1a4)][_0x3c61af(0x18a)]+_0x140751,_0x3be7c8=await this['_veevaService'][_0x3c61af(0x175)](_0x22be94);return _0x3be7c8[_0x3c61af(0x18c)]((_0x438e91,_0x93243)=>_0x438e91[_0x3c61af(0x1b9)](_0x93243['id'],_0x93243[_0x3c61af(0x1ae)]),new Map());}async['createExportOutboundPackages'](_0x19c2ed){const _0x3b1e48=a335_0x2ab2f0;this[_0x3b1e48(0x17c)][_0x3b1e48(0x1b7)](_0x3b1e48(0x17d));const _0x53b5ab=[],_0x429cdd=_0x19c2ed[_0x3b1e48(0x1be)](_0x416bd7=>{const _0x64f4d4=_0x3b1e48;return this['_connection'][_0x64f4d4(0x1a8)](veeva_constants_1[_0x64f4d4(0x1a4)][_0x64f4d4(0x18d)],encodeURI(_0x64f4d4(0x195))+'='+encodeURI(_0x416bd7),{'headers':{'Content-Type':_0x64f4d4(0x191)}});}),_0x531e78=await Promise[_0x3b1e48(0x19e)](_0x429cdd);for(const {data:_0x31324c}of _0x531e78){if(_0x31324c['responseStatus']===status_enums_1[_0x3b1e48(0x1b5)][_0x3b1e48(0x1bc)]){const {url:_0x474add}=_0x31324c;_0x53b5ab[_0x3b1e48(0x19f)](_0x474add);}else throw new veeva_error_1['VeevaError'](_0x31324c[_0x3b1e48(0x1a9)]);}return _0x53b5ab;}async[a335_0x2ab2f0(0x174)](_0x2daae0){const _0x453fb1=a335_0x2ab2f0;this[_0x453fb1(0x17c)][_0x453fb1(0x1b7)](_0x453fb1(0x18e));const _0x3172a7=[],_0xf7d915=await this[_0x453fb1(0x1b6)][_0x453fb1(0x1a0)](_0x2daae0);for(const _0x4d72c5 of _0xf7d915){const _0xba5dc4=_0x4d72c5[_0x453fb1(0x1ba)][_0x453fb1(0x19b)](_0x392e27=>_0x392e27[_0x453fb1(0x17f)]==='artifacts')['map'](_0x17f8b5=>_0x17f8b5[_0x453fb1(0x1aa)]);_0x3172a7[_0x453fb1(0x19f)](..._0xba5dc4);}return _0x3172a7;}async[a335_0x2ab2f0(0x1bf)](_0x3a559a){const _0x216f67=a335_0x2ab2f0;var _0x51f4d9;const _0x14029e=[];this['_logger'][_0x216f67(0x1b7)](_0x216f67(0x196));for(const _0xb9125c of _0x3a559a){const {data:_0x8dc9d3,headers:_0x1cf8bf}=await this[_0x216f67(0x185)][_0x216f67(0x178)](_0xb9125c,{'responseType':'arraybuffer'}),_0x2fed49=(_0x51f4d9=_0x1cf8bf['content-type'])===null||_0x51f4d9===void 0x0?void 0x0:_0x51f4d9['includes'](_0x216f67(0x1b4));if(!_0x2fed49){const _0x26cdae=_0x8dc9d3,_0x5508a6=new jszip_1[(_0x216f67(0x186))]();await _0x5508a6['loadAsync'](_0x26cdae),_0x14029e['push'](_0x5508a6);}else{const _0x72a3b0=JSON['parse'](_0x8dc9d3);throw new veeva_error_1['VeevaError'](_0x72a3b0['errors']);}}return _0x14029e;}async[a335_0x2ab2f0(0x198)](_0x20e177){const _0x26b910=a335_0x2ab2f0;this[_0x26b910(0x17c)][_0x26b910(0x1b7)](_0x26b910(0x197));const _0x108742=veeva_constants_1['VeevaConstants'][_0x26b910(0x1b1)]+'package_component__v';await this[_0x26b910(0x1b6)][_0x26b910(0x190)](_0x108742,_0x20e177);}async['deleteOutboundPackages'](_0x37193f){const _0x514e51=a335_0x2ab2f0;this[_0x514e51(0x17c)]['log'](_0x514e51(0x19c));const _0x39c7b5=veeva_constants_1[_0x514e51(0x1a4)][_0x514e51(0x1b1)]+_0x514e51(0x179);await this['_veevaService'][_0x514e51(0x190)](_0x39c7b5,_0x37193f);}async[a335_0x2ab2f0(0x19a)](_0x3c9819,_0x30ee6c){const _0x5ad787=a335_0x2ab2f0,_0x56caae=await this[_0x5ad787(0x193)](Math[_0x5ad787(0x1a7)](_0x3c9819[_0x5ad787(0x188)]/veeva_constants_1[_0x5ad787(0x1a4)][_0x5ad787(0x1af)]),_0x30ee6c),_0x41f54f=await this[_0x5ad787(0x1b8)](_0x3c9819,_0x56caae),_0x292acb=await this['getPackageNames'](_0x56caae),_0x22f5c1=await this[_0x5ad787(0x1c1)](Array[_0x5ad787(0x184)](_0x292acb['values']())),_0x32109f=await this[_0x5ad787(0x174)](_0x22f5c1),_0x4f1435=await this[_0x5ad787(0x1bf)](_0x32109f);return await this[_0x5ad787(0x198)](_0x41f54f),await this[_0x5ad787(0x1a2)](_0x56caae),_0x4f1435;}}exports[a335_0x2ab2f0(0x183)]=PackageExportService;