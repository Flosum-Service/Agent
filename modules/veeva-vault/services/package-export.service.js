function a359_0x2801(){const _0x5c9075=['loadAsync','default','reduce','../enums/status.enums','arraybuffer','push','../classes/errors/veeva-error','fill','_connection','__esModule','PackageExportService','VeevaConstants','errors','(((.+)+)+)+$','length','parse','__importDefault','from','filter','getEndpointArtifactList','artifacts','log','2366NZBwFD','_logger','package_component__v','migration__sys','ENDPOINT_CREATE_RECORDS','href','deleteOutboundPackages','VeevaError','Create\x20Export\x20outbound\x20packages.','31456ddZgai','executeVQL','Removing\x20components\x20from\x20outbound\x20packages.','getJobResult','deleteVeevaObjectRecords','outbound_package__v','getPackageNames','Deleting\x20outbound\x20packages.','createOutboundPackages','\x27,\x27','createVeevaObjectRecords','defineProperty','_veevaService','Getting\x20names\x20of\x20outbound\x20packages','join','2763666RinSTq','MAXIMUM_SIZE_OF_PACKAGE','apply','1783370OuLEGM','links','export','values','responseStatus','1146910ADJFUu','toString','retrieveVPKList','includes','search','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','Retrieve\x20Outbound\x20Package\x20zip\x20list','jszip','../constants/veeva.constants','createExportOutboundPackages','ENDPOINT_EXPORT_IMPORT_PACKAGE','ceil','153664lkZgOK','184389DzhaKy','map','name__v','608612TypMjn','Retrieve\x20Jobs\x20Status','SUCCESS','get'];a359_0x2801=function(){return _0x5c9075;};return a359_0x2801();}function a359_0x51b1(_0x715daf,_0x3ed364){const _0x3d8a35=a359_0x2801();return a359_0x51b1=function(_0x21d8b0,_0x1fe340){_0x21d8b0=_0x21d8b0-0x72;let _0x28017d=_0x3d8a35[_0x21d8b0];return _0x28017d;},a359_0x51b1(_0x715daf,_0x3ed364);}const a359_0x58cab5=a359_0x51b1;(function(_0xae144a,_0x2f856b){const _0x248cdc=a359_0x51b1,_0x2f5eff=_0xae144a();while(!![]){try{const _0x7ce043=-parseInt(_0x248cdc(0xb1))/0x1+parseInt(_0x248cdc(0x77))/0x2+parseInt(_0x248cdc(0x74))/0x3+parseInt(_0x248cdc(0x73))/0x4+-parseInt(_0x248cdc(0xac))/0x5+parseInt(_0x248cdc(0xa9))/0x6+parseInt(_0x248cdc(0x91))/0x7*(parseInt(_0x248cdc(0x9a))/0x8);if(_0x7ce043===_0x2f856b)break;else _0x2f5eff['push'](_0x2f5eff['shift']());}catch(_0x3d3748){_0x2f5eff['push'](_0x2f5eff['shift']());}}}(a359_0x2801,0xa8834));const a359_0x1fe340=(function(){let _0xf2be3b=!![];return function(_0x58c2f9,_0xd1c19d){const _0x810c5=_0xf2be3b?function(){const _0x1f1084=a359_0x51b1;if(_0xd1c19d){const _0x258dd9=_0xd1c19d[_0x1f1084(0xab)](_0x58c2f9,arguments);return _0xd1c19d=null,_0x258dd9;}}:function(){};return _0xf2be3b=![],_0x810c5;};}()),a359_0x21d8b0=a359_0x1fe340(this,function(){const _0x4ceeb8=a359_0x51b1;return a359_0x21d8b0[_0x4ceeb8(0xb2)]()[_0x4ceeb8(0xb5)](_0x4ceeb8(0x88))[_0x4ceeb8(0xb2)]()['constructor'](a359_0x21d8b0)[_0x4ceeb8(0xb5)](_0x4ceeb8(0x88));});a359_0x21d8b0();'use strict';var __importDefault=this&&this[a359_0x58cab5(0x8b)]||function(_0x266df7){const _0x4e199a=a359_0x58cab5;return _0x266df7&&_0x266df7[_0x4e199a(0x84)]?_0x266df7:{'default':_0x266df7};};Object[a359_0x58cab5(0xa5)](exports,a359_0x58cab5(0x84),{'value':!![]}),exports[a359_0x58cab5(0x85)]=void 0x0;const veeva_constants_1=require(a359_0x58cab5(0xb9)),jszip_1=__importDefault(require(a359_0x58cab5(0xb8))),status_enums_1=require(a359_0x58cab5(0x7e)),veeva_error_1=require(a359_0x58cab5(0x81));class PackageExportService{constructor({veevaService:_0x5ab038,connection:_0x309c25,logger:_0x3bf713}){const _0x30a967=a359_0x58cab5;this[_0x30a967(0xa6)]=_0x5ab038,this[_0x30a967(0x83)]=_0x309c25,this[_0x30a967(0x92)]=_0x3bf713;}async[a359_0x58cab5(0xa2)](_0x5f15bb,_0x21944c){const _0x54a856=a359_0x58cab5;this[_0x54a856(0x92)][_0x54a856(0x90)]('Creating\x20outbound\x20packages');const _0x4604c4=veeva_constants_1[_0x54a856(0x86)]['ENDPOINT_CREATE_RECORDS']+'outbound_package__v',_0x42d0a1=new Array(_0x5f15bb)[_0x54a856(0x82)]({'summary__v':_0x21944c,'object_type__v.api__name__v':_0x54a856(0x94)});return await this[_0x54a856(0xa6)][_0x54a856(0xa4)](_0x4604c4,_0x42d0a1);}async['createPackageComponents'](_0xc4980,_0xccbcfa){const _0xfd8057=a359_0x58cab5;this[_0xfd8057(0x92)][_0xfd8057(0x90)]('Adding\x20components\x20to\x20outbound\x20package');const _0x13a946=veeva_constants_1[_0xfd8057(0x86)][_0xfd8057(0x95)]+'package_component__v',_0x3dfab6=_0xc4980['map']((_0x46cddb,_0x57e2e0)=>({'vault_component__v':_0x46cddb['id'],'outbound_package__v':_0xccbcfa[Math[_0xfd8057(0x72)]((_0x57e2e0+0x1)/veeva_constants_1[_0xfd8057(0x86)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this[_0xfd8057(0xa6)][_0xfd8057(0xa4)](_0x13a946,_0x3dfab6);}async[a359_0x58cab5(0xa0)](_0x2d8050){const _0x176013=a359_0x58cab5;this[_0x176013(0x92)][_0x176013(0x90)](_0x176013(0xa7));const _0x2fe3e7=_0x176013(0xb6)+_0x2d8050[_0x176013(0xa8)](_0x176013(0xa3))+'\x27)',_0x4909e5=await this[_0x176013(0xa6)][_0x176013(0x9b)](_0x2fe3e7);return _0x4909e5[_0x176013(0x7d)]((_0x30442b,_0xc52d35)=>_0x30442b['set'](_0xc52d35['id'],_0xc52d35[_0x176013(0x76)]),new Map());}async[a359_0x58cab5(0xba)](_0x369ada){const _0x28c29e=a359_0x58cab5;this[_0x28c29e(0x92)]['log'](_0x28c29e(0x99));const _0x4f50c0=[],_0xb5a6b1=_0x369ada[_0x28c29e(0x75)](_0x3b7e4a=>{const _0x2a2f75=_0x28c29e;return this[_0x2a2f75(0x83)]['post'](veeva_constants_1['VeevaConstants'][_0x2a2f75(0xbb)],encodeURI('packageName')+'='+encodeURI(_0x3b7e4a),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0x449726=await Promise['all'](_0xb5a6b1);for(const {data:_0x520c63}of _0x449726){if(_0x520c63[_0x28c29e(0xb0)]===status_enums_1['VeevaResponseStatus'][_0x28c29e(0x79)]){const {url:_0x610540}=_0x520c63;_0x4f50c0[_0x28c29e(0x80)](_0x610540);}else throw new veeva_error_1[(_0x28c29e(0x98))](_0x520c63[_0x28c29e(0x87)]);}return _0x4f50c0;}async[a359_0x58cab5(0x8e)](_0x1286bb){const _0x423d8c=a359_0x58cab5;this[_0x423d8c(0x92)][_0x423d8c(0x90)](_0x423d8c(0x78));const _0x3402a0=[],_0x1f0da5=await this[_0x423d8c(0xa6)][_0x423d8c(0x9d)](_0x1286bb);for(const _0x282066 of _0x1f0da5){const _0x53f504=_0x282066[_0x423d8c(0xad)][_0x423d8c(0x8d)](_0x55a11b=>_0x55a11b['rel']===_0x423d8c(0x8f))[_0x423d8c(0x75)](_0x9ca06a=>_0x9ca06a[_0x423d8c(0x96)]);_0x3402a0['push'](..._0x53f504);}return _0x3402a0;}async[a359_0x58cab5(0xb3)](_0x4a0660){const _0x4621af=a359_0x58cab5;var _0x313707;const _0x40bef8=[];this[_0x4621af(0x92)][_0x4621af(0x90)](_0x4621af(0xb7));for(const _0x3cc4db of _0x4a0660){const {data:_0x4af1b0,headers:_0x5c7d1a}=await this['_connection'][_0x4621af(0x7a)](_0x3cc4db,{'responseType':_0x4621af(0x7f)}),_0x562254=(_0x313707=_0x5c7d1a['content-type'])===null||_0x313707===void 0x0?void 0x0:_0x313707[_0x4621af(0xb4)]('application/json');if(!_0x562254){const _0x181fd3=_0x4af1b0,_0x2faff3=new jszip_1[(_0x4621af(0x7c))]();await _0x2faff3[_0x4621af(0x7b)](_0x181fd3),_0x40bef8[_0x4621af(0x80)](_0x2faff3);}else{const _0x175984=JSON[_0x4621af(0x8a)](_0x4af1b0);throw new veeva_error_1['VeevaError'](_0x175984[_0x4621af(0x87)]);}}return _0x40bef8;}async['deletePackageComponents'](_0x3b9f3e){const _0x3b63e5=a359_0x58cab5;this[_0x3b63e5(0x92)][_0x3b63e5(0x90)](_0x3b63e5(0x9c));const _0x53bfe6=veeva_constants_1[_0x3b63e5(0x86)][_0x3b63e5(0x95)]+_0x3b63e5(0x93);await this[_0x3b63e5(0xa6)][_0x3b63e5(0x9e)](_0x53bfe6,_0x3b9f3e);}async['deleteOutboundPackages'](_0x36a576){const _0x54ad15=a359_0x58cab5;this['_logger'][_0x54ad15(0x90)](_0x54ad15(0xa1));const _0x4b8023=veeva_constants_1[_0x54ad15(0x86)][_0x54ad15(0x95)]+_0x54ad15(0x9f);await this[_0x54ad15(0xa6)][_0x54ad15(0x9e)](_0x4b8023,_0x36a576);}async[a359_0x58cab5(0xae)](_0x2fc05e,_0x283290){const _0x36c077=a359_0x58cab5,_0x25bf5f=await this[_0x36c077(0xa2)](Math[_0x36c077(0x72)](_0x2fc05e[_0x36c077(0x89)]/veeva_constants_1[_0x36c077(0x86)][_0x36c077(0xaa)]),_0x283290),_0x219ab7=await this['createPackageComponents'](_0x2fc05e,_0x25bf5f),_0x1a7830=await this[_0x36c077(0xa0)](_0x25bf5f),_0x48bf68=await this[_0x36c077(0xba)](Array[_0x36c077(0x8c)](_0x1a7830[_0x36c077(0xaf)]())),_0x3e8305=await this[_0x36c077(0x8e)](_0x48bf68),_0x433edd=await this[_0x36c077(0xb3)](_0x3e8305);return await this['deletePackageComponents'](_0x219ab7),await this[_0x36c077(0x97)](_0x25bf5f),_0x433edd;}}exports[a359_0x58cab5(0x85)]=PackageExportService;