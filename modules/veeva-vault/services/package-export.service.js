function a403_0xbe5e(){const _0x544cdd=['1761070Azqtqm','1518438kFmZFo','ENDPOINT_CREATE_RECORDS','SUCCESS','jszip','log','2968620XFruqK','createExportOutboundPackages','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','apply','executeVQL','packageName','createVeevaObjectRecords','PackageExportService','length','VeevaError','Creating\x20outbound\x20packages','1IdlPUM','post','65574DdfjWj','search','294835tyTSSw','getEndpointArtifactList','__importDefault','Adding\x20components\x20to\x20outbound\x20package','toString','deleteVeevaObjectRecords','_veevaService','Retrieve\x20Outbound\x20Package\x20zip\x20list','../enums/status.enums','4544520rEQZUj','deleteOutboundPackages','rel','default','ceil','1472AcnRYP','Create\x20Export\x20outbound\x20packages.','filter','retrieveVPKList','\x27,\x27','package_component__v','createOutboundPackages','__esModule','createPackageComponents','responseStatus','includes','values','96IagthP','_connection','MAXIMUM_SIZE_OF_PACKAGE','push','4681062kXIpbu','set','VeevaConstants','get','name__v','reduce','getPackageNames','(((.+)+)+)+$','_logger','outbound_package__v','href','map','loadAsync','constructor','Getting\x20names\x20of\x20outbound\x20packages','getJobResult','errors','../constants/veeva.constants','from','deletePackageComponents','Deleting\x20outbound\x20packages.','33mdFpNK','join','../classes/errors/veeva-error','ENDPOINT_EXPORT_IMPORT_PACKAGE','7bgWYKS'];a403_0xbe5e=function(){return _0x544cdd;};return a403_0xbe5e();}const a403_0x19f51f=a403_0x3d58;function a403_0x3d58(_0x1ba744,_0x474e8f){const _0x3b1cc9=a403_0xbe5e();return a403_0x3d58=function(_0x16709d,_0x3271e1){_0x16709d=_0x16709d-0xa1;let _0xbe5ec6=_0x3b1cc9[_0x16709d];return _0xbe5ec6;},a403_0x3d58(_0x1ba744,_0x474e8f);}(function(_0x1e7287,_0x1a0d96){const _0x3e4bd6=a403_0x3d58,_0x448db2=_0x1e7287();while(!![]){try{const _0x1dc3eb=-parseInt(_0x3e4bd6(0xd5))/0x1*(-parseInt(_0x3e4bd6(0xc5))/0x2)+-parseInt(_0x3e4bd6(0xaa))/0x3+-parseInt(_0x3e4bd6(0xa6))/0x4*(-parseInt(_0x3e4bd6(0xd9))/0x5)+-parseInt(_0x3e4bd6(0xe2))/0x6*(parseInt(_0x3e4bd6(0xc3))/0x7)+-parseInt(_0x3e4bd6(0xe7))/0x8*(-parseInt(_0x3e4bd6(0xd7))/0x9)+-parseInt(_0x3e4bd6(0xc4))/0xa*(parseInt(_0x3e4bd6(0xbf))/0xb)+parseInt(_0x3e4bd6(0xca))/0xc;if(_0x1dc3eb===_0x1a0d96)break;else _0x448db2['push'](_0x448db2['shift']());}catch(_0xb1d5fa){_0x448db2['push'](_0x448db2['shift']());}}}(a403_0xbe5e,0xdfb75));const a403_0x3271e1=(function(){let _0x1f9331=!![];return function(_0x14752d,_0x2f583d){const _0x31c9ca=_0x1f9331?function(){const _0x35f8fc=a403_0x3d58;if(_0x2f583d){const _0x33ada8=_0x2f583d[_0x35f8fc(0xcd)](_0x14752d,arguments);return _0x2f583d=null,_0x33ada8;}}:function(){};return _0x1f9331=![],_0x31c9ca;};}()),a403_0x16709d=a403_0x3271e1(this,function(){const _0x4443f4=a403_0x3d58;return a403_0x16709d[_0x4443f4(0xdd)]()[_0x4443f4(0xd8)](_0x4443f4(0xb1))[_0x4443f4(0xdd)]()[_0x4443f4(0xb7)](a403_0x16709d)['search'](_0x4443f4(0xb1));});a403_0x16709d();'use strict';var __importDefault=this&&this[a403_0x19f51f(0xdb)]||function(_0x206c5e){const _0x37e1c9=a403_0x19f51f;return _0x206c5e&&_0x206c5e[_0x37e1c9(0xa1)]?_0x206c5e:{'default':_0x206c5e};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a403_0x19f51f(0xd1)]=void 0x0;const veeva_constants_1=require(a403_0x19f51f(0xbb)),jszip_1=__importDefault(require(a403_0x19f51f(0xc8))),status_enums_1=require(a403_0x19f51f(0xe1)),veeva_error_1=require(a403_0x19f51f(0xc1));class PackageExportService{constructor({veevaService:_0x45d602,connection:_0x2224e8,logger:_0x57d687}){const _0x3411d7=a403_0x19f51f;this['_veevaService']=_0x45d602,this[_0x3411d7(0xa7)]=_0x2224e8,this[_0x3411d7(0xb2)]=_0x57d687;}async[a403_0x19f51f(0xed)](_0x46b621,_0x5178f3){const _0x16611e=a403_0x19f51f;this[_0x16611e(0xb2)][_0x16611e(0xc9)](_0x16611e(0xd4));const _0x3aba11=veeva_constants_1['VeevaConstants'][_0x16611e(0xc6)]+_0x16611e(0xb3),_0x41fb05=new Array(_0x46b621)['fill']({'summary__v':_0x5178f3,'object_type__v.api__name__v':'migration__sys'});return await this[_0x16611e(0xdf)][_0x16611e(0xd0)](_0x3aba11,_0x41fb05);}async[a403_0x19f51f(0xa2)](_0x4d483c,_0xcbbc){const _0x278937=a403_0x19f51f;this[_0x278937(0xb2)][_0x278937(0xc9)](_0x278937(0xdc));const _0x98f886=veeva_constants_1[_0x278937(0xac)][_0x278937(0xc6)]+'package_component__v',_0x269e6e=_0x4d483c[_0x278937(0xb5)]((_0x346c4f,_0x3dec66)=>({'vault_component__v':_0x346c4f['id'],'outbound_package__v':_0xcbbc[Math[_0x278937(0xe6)]((_0x3dec66+0x1)/veeva_constants_1[_0x278937(0xac)][_0x278937(0xa8)])-0x1]}));return await this['_veevaService'][_0x278937(0xd0)](_0x98f886,_0x269e6e);}async[a403_0x19f51f(0xb0)](_0x80ebe2){const _0x282157=a403_0x19f51f;this[_0x282157(0xb2)][_0x282157(0xc9)](_0x282157(0xb8));const _0x5ddcbe=_0x282157(0xcc)+_0x80ebe2[_0x282157(0xc0)](_0x282157(0xeb))+'\x27)',_0x133537=await this[_0x282157(0xdf)][_0x282157(0xce)](_0x5ddcbe);return _0x133537[_0x282157(0xaf)]((_0x55f8ab,_0x107338)=>_0x55f8ab[_0x282157(0xab)](_0x107338['id'],_0x107338[_0x282157(0xae)]),new Map());}async[a403_0x19f51f(0xcb)](_0x3c232b){const _0x290537=a403_0x19f51f;this['_logger'][_0x290537(0xc9)](_0x290537(0xe8));const _0x3440c4=[],_0x4c6f7d=_0x3c232b['map'](_0x175a91=>{const _0x14ed6c=_0x290537;return this[_0x14ed6c(0xa7)][_0x14ed6c(0xd6)](veeva_constants_1['VeevaConstants'][_0x14ed6c(0xc2)],encodeURI(_0x14ed6c(0xcf))+'='+encodeURI(_0x175a91),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0xe3234d=await Promise['all'](_0x4c6f7d);for(const {data:_0x50efe1}of _0xe3234d){if(_0x50efe1[_0x290537(0xa3)]===status_enums_1['VeevaResponseStatus'][_0x290537(0xc7)]){const {url:_0x5410f0}=_0x50efe1;_0x3440c4[_0x290537(0xa9)](_0x5410f0);}else throw new veeva_error_1[(_0x290537(0xd3))](_0x50efe1[_0x290537(0xba)]);}return _0x3440c4;}async[a403_0x19f51f(0xda)](_0x5cf7ea){const _0x5d5a06=a403_0x19f51f;this[_0x5d5a06(0xb2)][_0x5d5a06(0xc9)]('Retrieve\x20Jobs\x20Status');const _0x170a66=[],_0x4c7119=await this['_veevaService'][_0x5d5a06(0xb9)](_0x5cf7ea);for(const _0x5122f0 of _0x4c7119){const _0x9ea091=_0x5122f0['links'][_0x5d5a06(0xe9)](_0x2c429f=>_0x2c429f[_0x5d5a06(0xe4)]==='artifacts')[_0x5d5a06(0xb5)](_0x23455f=>_0x23455f[_0x5d5a06(0xb4)]);_0x170a66[_0x5d5a06(0xa9)](..._0x9ea091);}return _0x170a66;}async[a403_0x19f51f(0xea)](_0x1527a4){const _0x11b8ea=a403_0x19f51f;var _0x1cd7a3;const _0x32c0df=[];this[_0x11b8ea(0xb2)][_0x11b8ea(0xc9)](_0x11b8ea(0xe0));for(const _0x4c3908 of _0x1527a4){const {data:_0x1f2330,headers:_0x5056ab}=await this['_connection'][_0x11b8ea(0xad)](_0x4c3908,{'responseType':'arraybuffer'}),_0xb18dbb=(_0x1cd7a3=_0x5056ab['content-type'])===null||_0x1cd7a3===void 0x0?void 0x0:_0x1cd7a3[_0x11b8ea(0xa4)]('application/json');if(!_0xb18dbb){const _0x446f3b=_0x1f2330,_0x50f62e=new jszip_1[(_0x11b8ea(0xe5))]();await _0x50f62e[_0x11b8ea(0xb6)](_0x446f3b),_0x32c0df[_0x11b8ea(0xa9)](_0x50f62e);}else{const _0x2bb3cd=JSON['parse'](_0x1f2330);throw new veeva_error_1['VeevaError'](_0x2bb3cd[_0x11b8ea(0xba)]);}}return _0x32c0df;}async[a403_0x19f51f(0xbd)](_0x192489){const _0x7519ca=a403_0x19f51f;this[_0x7519ca(0xb2)][_0x7519ca(0xc9)]('Removing\x20components\x20from\x20outbound\x20packages.');const _0x544c53=veeva_constants_1[_0x7519ca(0xac)]['ENDPOINT_CREATE_RECORDS']+_0x7519ca(0xec);await this['_veevaService']['deleteVeevaObjectRecords'](_0x544c53,_0x192489);}async[a403_0x19f51f(0xe3)](_0x560cbd){const _0x19e70d=a403_0x19f51f;this[_0x19e70d(0xb2)][_0x19e70d(0xc9)](_0x19e70d(0xbe));const _0x448b3f=veeva_constants_1[_0x19e70d(0xac)][_0x19e70d(0xc6)]+_0x19e70d(0xb3);await this[_0x19e70d(0xdf)][_0x19e70d(0xde)](_0x448b3f,_0x560cbd);}async['export'](_0x13217e,_0x10e089){const _0x28572b=a403_0x19f51f,_0x19a0df=await this[_0x28572b(0xed)](Math[_0x28572b(0xe6)](_0x13217e[_0x28572b(0xd2)]/veeva_constants_1[_0x28572b(0xac)]['MAXIMUM_SIZE_OF_PACKAGE']),_0x10e089),_0x1c4175=await this[_0x28572b(0xa2)](_0x13217e,_0x19a0df),_0x20273a=await this['getPackageNames'](_0x19a0df),_0x4b7f95=await this[_0x28572b(0xcb)](Array[_0x28572b(0xbc)](_0x20273a[_0x28572b(0xa5)]())),_0x1af765=await this[_0x28572b(0xda)](_0x4b7f95),_0x12e1e5=await this[_0x28572b(0xea)](_0x1af765);return await this[_0x28572b(0xbd)](_0x1c4175),await this['deleteOutboundPackages'](_0x19a0df),_0x12e1e5;}}exports[a403_0x19f51f(0xd1)]=PackageExportService;