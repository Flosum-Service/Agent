const a359_0x3d9581=a359_0x1431;(function(_0x405aad,_0x51589a){const _0x54cdba=a359_0x1431,_0x1fe80d=_0x405aad();while(!![]){try{const _0x49030b=parseInt(_0x54cdba(0x22b))/0x1+parseInt(_0x54cdba(0x20c))/0x2*(parseInt(_0x54cdba(0x21c))/0x3)+-parseInt(_0x54cdba(0x1de))/0x4+parseInt(_0x54cdba(0x219))/0x5*(parseInt(_0x54cdba(0x1f2))/0x6)+-parseInt(_0x54cdba(0x208))/0x7*(-parseInt(_0x54cdba(0x20f))/0x8)+-parseInt(_0x54cdba(0x203))/0x9*(parseInt(_0x54cdba(0x1fc))/0xa)+parseInt(_0x54cdba(0x224))/0xb*(-parseInt(_0x54cdba(0x1fa))/0xc);if(_0x49030b===_0x51589a)break;else _0x1fe80d['push'](_0x1fe80d['shift']());}catch(_0x530e6f){_0x1fe80d['push'](_0x1fe80d['shift']());}}}(a359_0x4015,0x9923d));const a359_0x3fac9c=(function(){let _0x375f79=!![];return function(_0x35d8ac,_0x1c808c){const _0x4252f5=_0x375f79?function(){const _0x37a7f1=a359_0x1431;if(_0x1c808c){const _0x1ea55d=_0x1c808c[_0x37a7f1(0x213)](_0x35d8ac,arguments);return _0x1c808c=null,_0x1ea55d;}}:function(){};return _0x375f79=![],_0x4252f5;};}()),a359_0x37794b=a359_0x3fac9c(this,function(){const _0x3bb5fc=a359_0x1431;return a359_0x37794b[_0x3bb5fc(0x1e6)]()[_0x3bb5fc(0x1e4)]('(((.+)+)+)+$')[_0x3bb5fc(0x1e6)]()['constructor'](a359_0x37794b)['search'](_0x3bb5fc(0x210));});a359_0x37794b();function a359_0x4015(){const _0x5b021a=['SUCCESS','href','Adding\x20components\x20to\x20outbound\x20package','join','Retrieve\x20Outbound\x20Package\x20zip\x20list','53034PTCIyB','createVeevaObjectRecords','reduce','set','migration__sys','Deleting\x20outbound\x20packages.','VeevaError','getJobResult','8132268aXhOjt','__esModule','3906460nGTlJu','package_component__v','all','ceil','responseStatus','ENDPOINT_EXPORT_IMPORT_PACKAGE','default','9sjxfjF','../classes/errors/veeva-error','jszip','fill','map','15974jFWeyi','../constants/veeva.constants','getEndpointArtifactList','Removing\x20components\x20from\x20outbound\x20packages.','1618518Dyjfix','retrieveVPKList','errors','1640iPsYCM','(((.+)+)+)+$','getPackageNames','push','apply','includes','outbound_package__v','VeevaConstants','executeVQL','createOutboundPackages','85nqlCSz','Creating\x20outbound\x20packages','content-type','3bXbEbC','deletePackageComponents','defineProperty','_veevaService','log','ENDPOINT_CREATE_RECORDS','deleteVeevaObjectRecords','artifacts','11lRyEEu','../enums/status.enums','__importDefault','loadAsync','application/x-www-form-urlencoded','_connection','createPackageComponents','417551dUetai','values','rel','name__v','Create\x20Export\x20outbound\x20packages.','arraybuffer','filter','PackageExportService','597148CiIrVh','_logger','\x27,\x27','MAXIMUM_SIZE_OF_PACKAGE','Getting\x20names\x20of\x20outbound\x20packages','VeevaResponseStatus','search','export','toString','createExportOutboundPackages','from','deleteOutboundPackages','parse','Retrieve\x20Jobs\x20Status','get'];a359_0x4015=function(){return _0x5b021a;};return a359_0x4015();}'use strict';var __importDefault=this&&this[a359_0x3d9581(0x226)]||function(_0x522ea3){const _0x35e5c0=a359_0x3d9581;return _0x522ea3&&_0x522ea3[_0x35e5c0(0x1fb)]?_0x522ea3:{'default':_0x522ea3};};Object[a359_0x3d9581(0x21e)](exports,a359_0x3d9581(0x1fb),{'value':!![]}),exports[a359_0x3d9581(0x1dd)]=void 0x0;function a359_0x1431(_0x1a0ee1,_0x2ec50c){const _0x594eab=a359_0x4015();return a359_0x1431=function(_0x37794b,_0x3fac9c){_0x37794b=_0x37794b-0x1d8;let _0x401567=_0x594eab[_0x37794b];return _0x401567;},a359_0x1431(_0x1a0ee1,_0x2ec50c);}const veeva_constants_1=require(a359_0x3d9581(0x209)),jszip_1=__importDefault(require(a359_0x3d9581(0x205))),status_enums_1=require(a359_0x3d9581(0x225)),veeva_error_1=require(a359_0x3d9581(0x204));class PackageExportService{constructor({veevaService:_0x30c1f8,connection:_0xd0f0a4,logger:_0x4cf996}){const _0x18c7c0=a359_0x3d9581;this[_0x18c7c0(0x21f)]=_0x30c1f8,this['_connection']=_0xd0f0a4,this['_logger']=_0x4cf996;}async[a359_0x3d9581(0x218)](_0x5cd145,_0x5f215b){const _0x47595d=a359_0x3d9581;this['_logger'][_0x47595d(0x220)](_0x47595d(0x21a));const _0x18fa6e=veeva_constants_1[_0x47595d(0x216)]['ENDPOINT_CREATE_RECORDS']+_0x47595d(0x215),_0x3c8648=new Array(_0x5cd145)[_0x47595d(0x206)]({'summary__v':_0x5f215b,'object_type__v.api__name__v':_0x47595d(0x1f6)});return await this[_0x47595d(0x21f)][_0x47595d(0x1f3)](_0x18fa6e,_0x3c8648);}async[a359_0x3d9581(0x22a)](_0x27d28e,_0x33fc9d){const _0x4f9cd5=a359_0x3d9581;this[_0x4f9cd5(0x1df)][_0x4f9cd5(0x220)](_0x4f9cd5(0x1ef));const _0x582ee5=veeva_constants_1[_0x4f9cd5(0x216)][_0x4f9cd5(0x221)]+_0x4f9cd5(0x1fd),_0x56f1d8=_0x27d28e[_0x4f9cd5(0x207)]((_0x357e8e,_0x14d05f)=>({'vault_component__v':_0x357e8e['id'],'outbound_package__v':_0x33fc9d[Math['ceil']((_0x14d05f+0x1)/veeva_constants_1[_0x4f9cd5(0x216)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this[_0x4f9cd5(0x21f)][_0x4f9cd5(0x1f3)](_0x582ee5,_0x56f1d8);}async[a359_0x3d9581(0x211)](_0x4e61e6){const _0xed8e19=a359_0x3d9581;this['_logger'][_0xed8e19(0x220)](_0xed8e19(0x1e2));const _0x16f10c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x4e61e6[_0xed8e19(0x1f0)](_0xed8e19(0x1e0))+'\x27)',_0x320a33=await this[_0xed8e19(0x21f)][_0xed8e19(0x217)](_0x16f10c);return _0x320a33[_0xed8e19(0x1f4)]((_0x1ba1b7,_0x1d8d7a)=>_0x1ba1b7[_0xed8e19(0x1f5)](_0x1d8d7a['id'],_0x1d8d7a[_0xed8e19(0x1d9)]),new Map());}async[a359_0x3d9581(0x1e7)](_0x562cbd){const _0xe41f04=a359_0x3d9581;this[_0xe41f04(0x1df)][_0xe41f04(0x220)](_0xe41f04(0x1da));const _0x29a563=[],_0x384cbe=_0x562cbd[_0xe41f04(0x207)](_0x3ebaef=>{const _0x15d5ff=_0xe41f04;return this['_connection']['post'](veeva_constants_1[_0x15d5ff(0x216)][_0x15d5ff(0x201)],encodeURI('packageName')+'='+encodeURI(_0x3ebaef),{'headers':{'Content-Type':_0x15d5ff(0x228)}});}),_0xc1ee41=await Promise[_0xe41f04(0x1fe)](_0x384cbe);for(const {data:_0x30fd79}of _0xc1ee41){if(_0x30fd79[_0xe41f04(0x200)]===status_enums_1[_0xe41f04(0x1e3)][_0xe41f04(0x1ed)]){const {url:_0x206721}=_0x30fd79;_0x29a563['push'](_0x206721);}else throw new veeva_error_1['VeevaError'](_0x30fd79[_0xe41f04(0x20e)]);}return _0x29a563;}async[a359_0x3d9581(0x20a)](_0x179d54){const _0x3dcba0=a359_0x3d9581;this[_0x3dcba0(0x1df)]['log'](_0x3dcba0(0x1eb));const _0x25ddf6=[],_0x2e9467=await this[_0x3dcba0(0x21f)][_0x3dcba0(0x1f9)](_0x179d54);for(const _0x1e171e of _0x2e9467){const _0x4efc09=_0x1e171e['links'][_0x3dcba0(0x1dc)](_0x44d5a3=>_0x44d5a3[_0x3dcba0(0x1d8)]===_0x3dcba0(0x223))[_0x3dcba0(0x207)](_0x3af0ab=>_0x3af0ab[_0x3dcba0(0x1ee)]);_0x25ddf6[_0x3dcba0(0x212)](..._0x4efc09);}return _0x25ddf6;}async['retrieveVPKList'](_0x5d94e0){const _0x34f903=a359_0x3d9581;var _0x5cd33f;const _0x4c9651=[];this[_0x34f903(0x1df)][_0x34f903(0x220)](_0x34f903(0x1f1));for(const _0x57a74e of _0x5d94e0){const {data:_0x55530c,headers:_0x54fbdb}=await this[_0x34f903(0x229)][_0x34f903(0x1ec)](_0x57a74e,{'responseType':_0x34f903(0x1db)}),_0x42527a=(_0x5cd33f=_0x54fbdb[_0x34f903(0x21b)])===null||_0x5cd33f===void 0x0?void 0x0:_0x5cd33f[_0x34f903(0x214)]('application/json');if(!_0x42527a){const _0x3625d1=_0x55530c,_0x21ecf3=new jszip_1[(_0x34f903(0x202))]();await _0x21ecf3[_0x34f903(0x227)](_0x3625d1),_0x4c9651['push'](_0x21ecf3);}else{const _0x57bc21=JSON[_0x34f903(0x1ea)](_0x55530c);throw new veeva_error_1[(_0x34f903(0x1f8))](_0x57bc21[_0x34f903(0x20e)]);}}return _0x4c9651;}async[a359_0x3d9581(0x21d)](_0x1dbf30){const _0x5d9e10=a359_0x3d9581;this['_logger'][_0x5d9e10(0x220)](_0x5d9e10(0x20b));const _0x4440ee=veeva_constants_1[_0x5d9e10(0x216)][_0x5d9e10(0x221)]+_0x5d9e10(0x1fd);await this[_0x5d9e10(0x21f)][_0x5d9e10(0x222)](_0x4440ee,_0x1dbf30);}async['deleteOutboundPackages'](_0x3dbff8){const _0x316a0a=a359_0x3d9581;this['_logger'][_0x316a0a(0x220)](_0x316a0a(0x1f7));const _0x24e813=veeva_constants_1[_0x316a0a(0x216)][_0x316a0a(0x221)]+_0x316a0a(0x215);await this[_0x316a0a(0x21f)][_0x316a0a(0x222)](_0x24e813,_0x3dbff8);}async[a359_0x3d9581(0x1e5)](_0x5cba31,_0x532b4c){const _0x3a20e5=a359_0x3d9581,_0x4e0517=await this['createOutboundPackages'](Math[_0x3a20e5(0x1ff)](_0x5cba31['length']/veeva_constants_1['VeevaConstants'][_0x3a20e5(0x1e1)]),_0x532b4c),_0x280bfe=await this[_0x3a20e5(0x22a)](_0x5cba31,_0x4e0517),_0x358a1f=await this[_0x3a20e5(0x211)](_0x4e0517),_0x353b86=await this[_0x3a20e5(0x1e7)](Array[_0x3a20e5(0x1e8)](_0x358a1f[_0x3a20e5(0x22c)]())),_0x31c131=await this[_0x3a20e5(0x20a)](_0x353b86),_0x4eafef=await this[_0x3a20e5(0x20d)](_0x31c131);return await this[_0x3a20e5(0x21d)](_0x280bfe),await this[_0x3a20e5(0x1e9)](_0x4e0517),_0x4eafef;}}exports[a359_0x3d9581(0x1dd)]=PackageExportService;