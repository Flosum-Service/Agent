const a402_0xeb3f5c=a402_0x5b55;(function(_0x3cf3a3,_0x24e455){const _0x50271a=a402_0x5b55,_0x10a2fe=_0x3cf3a3();while(!![]){try{const _0xa59ea6=-parseInt(_0x50271a(0x218))/0x1+-parseInt(_0x50271a(0x1cd))/0x2+-parseInt(_0x50271a(0x1fe))/0x3*(-parseInt(_0x50271a(0x1db))/0x4)+parseInt(_0x50271a(0x1e2))/0x5+parseInt(_0x50271a(0x1d5))/0x6+parseInt(_0x50271a(0x1fc))/0x7*(-parseInt(_0x50271a(0x1ee))/0x8)+parseInt(_0x50271a(0x1cc))/0x9*(parseInt(_0x50271a(0x206))/0xa);if(_0xa59ea6===_0x24e455)break;else _0x10a2fe['push'](_0x10a2fe['shift']());}catch(_0x12fae3){_0x10a2fe['push'](_0x10a2fe['shift']());}}}(a402_0x4cef,0xef436));const a402_0x504fc9=(function(){let _0x5abdbc=!![];return function(_0x2da7ce,_0x1e275d){const _0x4090ba=_0x5abdbc?function(){const _0x2121db=a402_0x5b55;if(_0x1e275d){const _0xfec61c=_0x1e275d[_0x2121db(0x20a)](_0x2da7ce,arguments);return _0x1e275d=null,_0xfec61c;}}:function(){};return _0x5abdbc=![],_0x4090ba;};}()),a402_0x44239d=a402_0x504fc9(this,function(){const _0x5aeb12=a402_0x5b55;return a402_0x44239d[_0x5aeb12(0x202)]()['search'](_0x5aeb12(0x1e6))[_0x5aeb12(0x202)]()[_0x5aeb12(0x210)](a402_0x44239d)[_0x5aeb12(0x1d7)](_0x5aeb12(0x1e6));});a402_0x44239d();'use strict';function a402_0x5b55(_0x4c33af,_0x6dfce2){const _0xe0ab8a=a402_0x4cef();return a402_0x5b55=function(_0x44239d,_0x504fc9){_0x44239d=_0x44239d-0x1cc;let _0x4cef8a=_0xe0ab8a[_0x44239d];return _0x4cef8a;},a402_0x5b55(_0x4c33af,_0x6dfce2);}var __importDefault=this&&this[a402_0xeb3f5c(0x1e1)]||function(_0xd95c92){const _0x2be125=a402_0xeb3f5c;return _0xd95c92&&_0xd95c92[_0x2be125(0x201)]?_0xd95c92:{'default':_0xd95c92};};function a402_0x4cef(){const _0x5d75ba=['7jyyhZz','MAXIMUM_SIZE_OF_PACKAGE','3gIJfce','createOutboundPackages','name__v','__esModule','toString','createPackageComponents','push','createExportOutboundPackages','10SQgYEi','errors','SUCCESS','Create\x20Export\x20outbound\x20packages.','apply','getPackageNames','includes','VeevaConstants','values','Retrieve\x20Outbound\x20Package\x20zip\x20list','constructor','VeevaError','../constants/veeva.constants','../classes/errors/veeva-error','Deleting\x20outbound\x20packages.','application/x-www-form-urlencoded','arraybuffer','defineProperty','1136652kQPRgo','16353981KYYhGr','2258578bAbMni','packageName','jszip','deletePackageComponents','get','links','log','_logger','3946932wikBaE','loadAsync','search','href','ENDPOINT_CREATE_RECORDS','_connection','77096LccvNS','join','PackageExportService','reduce','\x27,\x27','all','__importDefault','5397665LWbPFB','filter','responseStatus','outbound_package__v','(((.+)+)+)+$','getEndpointArtifactList','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','rel','default','Creating\x20outbound\x20packages','ceil','ENDPOINT_EXPORT_IMPORT_PACKAGE','2622200OcUvOS','executeVQL','retrieveVPKList','_veevaService','from','VeevaResponseStatus','deleteVeevaObjectRecords','artifacts','Adding\x20components\x20to\x20outbound\x20package','set','createVeevaObjectRecords','../enums/status.enums','export','map'];a402_0x4cef=function(){return _0x5d75ba;};return a402_0x4cef();}Object[a402_0xeb3f5c(0x217)](exports,a402_0xeb3f5c(0x201),{'value':!![]}),exports[a402_0xeb3f5c(0x1dd)]=void 0x0;const veeva_constants_1=require(a402_0xeb3f5c(0x212)),jszip_1=__importDefault(require(a402_0xeb3f5c(0x1cf))),status_enums_1=require(a402_0xeb3f5c(0x1f9)),veeva_error_1=require(a402_0xeb3f5c(0x213));class PackageExportService{constructor({veevaService:_0x20688c,connection:_0x2e7765,logger:_0x11fcde}){const _0x3e5879=a402_0xeb3f5c;this[_0x3e5879(0x1f1)]=_0x20688c,this[_0x3e5879(0x1da)]=_0x2e7765,this[_0x3e5879(0x1d4)]=_0x11fcde;}async[a402_0xeb3f5c(0x1ff)](_0xc57fac,_0x644ff4){const _0x571938=a402_0xeb3f5c;this[_0x571938(0x1d4)][_0x571938(0x1d3)](_0x571938(0x1eb));const _0x491be2=veeva_constants_1[_0x571938(0x20d)]['ENDPOINT_CREATE_RECORDS']+_0x571938(0x1e5),_0x1ef74f=new Array(_0xc57fac)['fill']({'summary__v':_0x644ff4,'object_type__v.api__name__v':'migration__sys'});return await this[_0x571938(0x1f1)][_0x571938(0x1f8)](_0x491be2,_0x1ef74f);}async[a402_0xeb3f5c(0x203)](_0x5c29be,_0x5a5843){const _0x134a04=a402_0xeb3f5c;this[_0x134a04(0x1d4)][_0x134a04(0x1d3)](_0x134a04(0x1f6));const _0xffe295=veeva_constants_1[_0x134a04(0x20d)]['ENDPOINT_CREATE_RECORDS']+'package_component__v',_0x350668=_0x5c29be['map']((_0x33c32e,_0x2b6cd6)=>({'vault_component__v':_0x33c32e['id'],'outbound_package__v':_0x5a5843[Math[_0x134a04(0x1ec)]((_0x2b6cd6+0x1)/veeva_constants_1[_0x134a04(0x20d)][_0x134a04(0x1fd)])-0x1]}));return await this[_0x134a04(0x1f1)][_0x134a04(0x1f8)](_0xffe295,_0x350668);}async[a402_0xeb3f5c(0x20b)](_0x2eb84e){const _0x2fcdd5=a402_0xeb3f5c;this['_logger'][_0x2fcdd5(0x1d3)]('Getting\x20names\x20of\x20outbound\x20packages');const _0x23bdba=_0x2fcdd5(0x1e8)+_0x2eb84e[_0x2fcdd5(0x1dc)](_0x2fcdd5(0x1df))+'\x27)',_0x53fd14=await this[_0x2fcdd5(0x1f1)][_0x2fcdd5(0x1ef)](_0x23bdba);return _0x53fd14[_0x2fcdd5(0x1de)]((_0xa9dd8b,_0x5c737a)=>_0xa9dd8b[_0x2fcdd5(0x1f7)](_0x5c737a['id'],_0x5c737a[_0x2fcdd5(0x200)]),new Map());}async['createExportOutboundPackages'](_0xf60df2){const _0x40a70a=a402_0xeb3f5c;this[_0x40a70a(0x1d4)][_0x40a70a(0x1d3)](_0x40a70a(0x209));const _0xeefaba=[],_0x2e7091=_0xf60df2[_0x40a70a(0x1fb)](_0x51a057=>{const _0x84abb7=_0x40a70a;return this[_0x84abb7(0x1da)]['post'](veeva_constants_1[_0x84abb7(0x20d)][_0x84abb7(0x1ed)],encodeURI(_0x84abb7(0x1ce))+'='+encodeURI(_0x51a057),{'headers':{'Content-Type':_0x84abb7(0x215)}});}),_0x41d512=await Promise[_0x40a70a(0x1e0)](_0x2e7091);for(const {data:_0xb01b07}of _0x41d512){if(_0xb01b07[_0x40a70a(0x1e4)]===status_enums_1[_0x40a70a(0x1f3)][_0x40a70a(0x208)]){const {url:_0x224a83}=_0xb01b07;_0xeefaba[_0x40a70a(0x204)](_0x224a83);}else throw new veeva_error_1['VeevaError'](_0xb01b07[_0x40a70a(0x207)]);}return _0xeefaba;}async['getEndpointArtifactList'](_0x28127a){const _0x7e488d=a402_0xeb3f5c;this[_0x7e488d(0x1d4)][_0x7e488d(0x1d3)]('Retrieve\x20Jobs\x20Status');const _0x2bae10=[],_0x7b6916=await this[_0x7e488d(0x1f1)]['getJobResult'](_0x28127a);for(const _0x120987 of _0x7b6916){const _0x5d3cf0=_0x120987[_0x7e488d(0x1d2)][_0x7e488d(0x1e3)](_0x33a032=>_0x33a032[_0x7e488d(0x1e9)]===_0x7e488d(0x1f5))[_0x7e488d(0x1fb)](_0x14d454=>_0x14d454[_0x7e488d(0x1d8)]);_0x2bae10[_0x7e488d(0x204)](..._0x5d3cf0);}return _0x2bae10;}async[a402_0xeb3f5c(0x1f0)](_0xeae4d5){const _0x430cc0=a402_0xeb3f5c;var _0x2842ac;const _0x25180b=[];this[_0x430cc0(0x1d4)]['log'](_0x430cc0(0x20f));for(const _0x3f9d69 of _0xeae4d5){const {data:_0x2811b4,headers:_0x32612b}=await this[_0x430cc0(0x1da)][_0x430cc0(0x1d1)](_0x3f9d69,{'responseType':_0x430cc0(0x216)}),_0x4cd164=(_0x2842ac=_0x32612b['content-type'])===null||_0x2842ac===void 0x0?void 0x0:_0x2842ac[_0x430cc0(0x20c)]('application/json');if(!_0x4cd164){const _0x3796c3=_0x2811b4,_0xcc705=new jszip_1[(_0x430cc0(0x1ea))]();await _0xcc705[_0x430cc0(0x1d6)](_0x3796c3),_0x25180b[_0x430cc0(0x204)](_0xcc705);}else{const _0x53fbf8=JSON['parse'](_0x2811b4);throw new veeva_error_1[(_0x430cc0(0x211))](_0x53fbf8[_0x430cc0(0x207)]);}}return _0x25180b;}async[a402_0xeb3f5c(0x1d0)](_0x27f172){const _0x2b5d47=a402_0xeb3f5c;this[_0x2b5d47(0x1d4)][_0x2b5d47(0x1d3)]('Removing\x20components\x20from\x20outbound\x20packages.');const _0x56f185=veeva_constants_1[_0x2b5d47(0x20d)][_0x2b5d47(0x1d9)]+'package_component__v';await this[_0x2b5d47(0x1f1)][_0x2b5d47(0x1f4)](_0x56f185,_0x27f172);}async['deleteOutboundPackages'](_0x72976a){const _0xf85988=a402_0xeb3f5c;this[_0xf85988(0x1d4)][_0xf85988(0x1d3)](_0xf85988(0x214));const _0x5b589c=veeva_constants_1['VeevaConstants']['ENDPOINT_CREATE_RECORDS']+_0xf85988(0x1e5);await this[_0xf85988(0x1f1)]['deleteVeevaObjectRecords'](_0x5b589c,_0x72976a);}async[a402_0xeb3f5c(0x1fa)](_0x31c5eb,_0x14446d){const _0x101c8c=a402_0xeb3f5c,_0xb516c0=await this[_0x101c8c(0x1ff)](Math[_0x101c8c(0x1ec)](_0x31c5eb['length']/veeva_constants_1[_0x101c8c(0x20d)][_0x101c8c(0x1fd)]),_0x14446d),_0x16077d=await this[_0x101c8c(0x203)](_0x31c5eb,_0xb516c0),_0x9d6112=await this[_0x101c8c(0x20b)](_0xb516c0),_0x43c948=await this[_0x101c8c(0x205)](Array[_0x101c8c(0x1f2)](_0x9d6112[_0x101c8c(0x20e)]())),_0x4b11b6=await this[_0x101c8c(0x1e7)](_0x43c948),_0x261fbe=await this['retrieveVPKList'](_0x4b11b6);return await this[_0x101c8c(0x1d0)](_0x16077d),await this['deleteOutboundPackages'](_0xb516c0),_0x261fbe;}}exports[a402_0xeb3f5c(0x1dd)]=PackageExportService;