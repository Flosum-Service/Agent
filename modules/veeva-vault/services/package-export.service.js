const a403_0x53a191=a403_0x1d32;(function(_0x114258,_0x6dc2fb){const _0x146b2d=a403_0x1d32,_0x272616=_0x114258();while(!![]){try{const _0x1cc52e=-parseInt(_0x146b2d(0x1a7))/0x1*(parseInt(_0x146b2d(0x1b1))/0x2)+-parseInt(_0x146b2d(0x1aa))/0x3*(-parseInt(_0x146b2d(0x1be))/0x4)+-parseInt(_0x146b2d(0x1c5))/0x5*(-parseInt(_0x146b2d(0x1a0))/0x6)+-parseInt(_0x146b2d(0x1a1))/0x7+parseInt(_0x146b2d(0x1bb))/0x8*(-parseInt(_0x146b2d(0x1c1))/0x9)+-parseInt(_0x146b2d(0x198))/0xa+parseInt(_0x146b2d(0x18e))/0xb;if(_0x1cc52e===_0x6dc2fb)break;else _0x272616['push'](_0x272616['shift']());}catch(_0x3373ec){_0x272616['push'](_0x272616['shift']());}}}(a403_0x370b,0x3be4b));function a403_0x1d32(_0x37b133,_0x248880){const _0x43462a=a403_0x370b();return a403_0x1d32=function(_0x48d568,_0x1f1a91){_0x48d568=_0x48d568-0x17d;let _0x370b2c=_0x43462a[_0x48d568];return _0x370b2c;},a403_0x1d32(_0x37b133,_0x248880);}const a403_0x1f1a91=(function(){let _0x1142bf=!![];return function(_0x225368,_0x300caa){const _0x316f23=_0x1142bf?function(){if(_0x300caa){const _0x4478d1=_0x300caa['apply'](_0x225368,arguments);return _0x300caa=null,_0x4478d1;}}:function(){};return _0x1142bf=![],_0x316f23;};}()),a403_0x48d568=a403_0x1f1a91(this,function(){const _0x222e93=a403_0x1d32;return a403_0x48d568[_0x222e93(0x19a)]()[_0x222e93(0x18f)](_0x222e93(0x180))['toString']()[_0x222e93(0x189)](a403_0x48d568)[_0x222e93(0x18f)](_0x222e93(0x180));});a403_0x48d568();'use strict';function a403_0x370b(){const _0x2138fa=['createVeevaObjectRecords','Getting\x20names\x20of\x20outbound\x20packages','VeevaError','getJobResult','jszip','from','loadAsync','\x27,\x27','680hXmEvn','ceil','parse','84XyvbFY','ENDPOINT_EXPORT_IMPORT_PACKAGE','Retrieve\x20Jobs\x20Status','5787prQkEx','outbound_package__v','deleteOutboundPackages','name__v','5YtOkqZ','package_component__v','createPackageComponents','Retrieve\x20Outbound\x20Package\x20zip\x20list','rel','all','push','join','Create\x20Export\x20outbound\x20packages.','Removing\x20components\x20from\x20outbound\x20packages.','_connection','(((.+)+)+)+$','values','SUCCESS','VeevaResponseStatus','_veevaService','packageName','includes','set','Adding\x20components\x20to\x20outbound\x20package','constructor','deleteVeevaObjectRecords','length','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','createOutboundPackages','3809190azNyvg','search','VeevaConstants','href','artifacts','../constants/veeva.constants','get','errors','createExportOutboundPackages','defineProperty','2520600ZmtBTC','MAXIMUM_SIZE_OF_PACKAGE','toString','getEndpointArtifactList','export','_logger','arraybuffer','application/x-www-form-urlencoded','1749426mBJoVf','885892BScYGP','default','links','deletePackageComponents','ENDPOINT_CREATE_RECORDS','__importDefault','10BSsXZQ','getPackageNames','fill','42159shWEhe','Creating\x20outbound\x20packages','migration__sys','map','__esModule','retrieveVPKList','Deleting\x20outbound\x20packages.','50876KmSsww','log'];a403_0x370b=function(){return _0x2138fa;};return a403_0x370b();}var __importDefault=this&&this[a403_0x53a191(0x1a6)]||function(_0x4c7f4a){const _0x587815=a403_0x53a191;return _0x4c7f4a&&_0x4c7f4a[_0x587815(0x1ae)]?_0x4c7f4a:{'default':_0x4c7f4a};};Object[a403_0x53a191(0x197)](exports,a403_0x53a191(0x1ae),{'value':!![]}),exports['PackageExportService']=void 0x0;const veeva_constants_1=require(a403_0x53a191(0x193)),jszip_1=__importDefault(require(a403_0x53a191(0x1b7))),status_enums_1=require('../enums/status.enums'),veeva_error_1=require('../classes/errors/veeva-error');class PackageExportService{constructor({veevaService:_0x1284ef,connection:_0x4caa27,logger:_0x14f33f}){const _0x1392bd=a403_0x53a191;this[_0x1392bd(0x184)]=_0x1284ef,this[_0x1392bd(0x17f)]=_0x4caa27,this[_0x1392bd(0x19d)]=_0x14f33f;}async['createOutboundPackages'](_0x4bfc41,_0x3d94ea){const _0xe86caa=a403_0x53a191;this[_0xe86caa(0x19d)][_0xe86caa(0x1b2)](_0xe86caa(0x1ab));const _0x2cb550=veeva_constants_1[_0xe86caa(0x190)][_0xe86caa(0x1a5)]+_0xe86caa(0x1c2),_0x5bd3bc=new Array(_0x4bfc41)[_0xe86caa(0x1a9)]({'summary__v':_0x3d94ea,'object_type__v.api__name__v':_0xe86caa(0x1ac)});return await this[_0xe86caa(0x184)][_0xe86caa(0x1b3)](_0x2cb550,_0x5bd3bc);}async[a403_0x53a191(0x1c7)](_0xbe591f,_0x42447e){const _0x440603=a403_0x53a191;this[_0x440603(0x19d)][_0x440603(0x1b2)](_0x440603(0x188));const _0x1f0e4c=veeva_constants_1[_0x440603(0x190)][_0x440603(0x1a5)]+_0x440603(0x1c6),_0x1bcb6a=_0xbe591f[_0x440603(0x1ad)]((_0x51640e,_0x10da17)=>({'vault_component__v':_0x51640e['id'],'outbound_package__v':_0x42447e[Math[_0x440603(0x1bc)]((_0x10da17+0x1)/veeva_constants_1['VeevaConstants']['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await this[_0x440603(0x184)]['createVeevaObjectRecords'](_0x1f0e4c,_0x1bcb6a);}async[a403_0x53a191(0x1a8)](_0x8fbf23){const _0xe96cdb=a403_0x53a191;this['_logger'][_0xe96cdb(0x1b2)](_0xe96cdb(0x1b4));const _0x512406=_0xe96cdb(0x18c)+_0x8fbf23[_0xe96cdb(0x1cc)](_0xe96cdb(0x1ba))+'\x27)',_0x468005=await this[_0xe96cdb(0x184)]['executeVQL'](_0x512406);return _0x468005['reduce']((_0x4ea1b2,_0x382c02)=>_0x4ea1b2[_0xe96cdb(0x187)](_0x382c02['id'],_0x382c02[_0xe96cdb(0x1c4)]),new Map());}async[a403_0x53a191(0x196)](_0x344cc6){const _0x405bb9=a403_0x53a191;this[_0x405bb9(0x19d)][_0x405bb9(0x1b2)](_0x405bb9(0x17d));const _0x1d0706=[],_0x54eb0c=_0x344cc6[_0x405bb9(0x1ad)](_0x2c0d6d=>{const _0x2ee83d=_0x405bb9;return this[_0x2ee83d(0x17f)]['post'](veeva_constants_1['VeevaConstants'][_0x2ee83d(0x1bf)],encodeURI(_0x2ee83d(0x185))+'='+encodeURI(_0x2c0d6d),{'headers':{'Content-Type':_0x2ee83d(0x19f)}});}),_0x4ee988=await Promise[_0x405bb9(0x1ca)](_0x54eb0c);for(const {data:_0x1f6701}of _0x4ee988){if(_0x1f6701['responseStatus']===status_enums_1[_0x405bb9(0x183)][_0x405bb9(0x182)]){const {url:_0x2397cd}=_0x1f6701;_0x1d0706['push'](_0x2397cd);}else throw new veeva_error_1[(_0x405bb9(0x1b5))](_0x1f6701[_0x405bb9(0x195)]);}return _0x1d0706;}async['getEndpointArtifactList'](_0x1809a1){const _0x36862c=a403_0x53a191;this[_0x36862c(0x19d)][_0x36862c(0x1b2)](_0x36862c(0x1c0));const _0x53025a=[],_0x2610cf=await this[_0x36862c(0x184)][_0x36862c(0x1b6)](_0x1809a1);for(const _0x38e9ce of _0x2610cf){const _0x36366b=_0x38e9ce[_0x36862c(0x1a3)]['filter'](_0x10a343=>_0x10a343[_0x36862c(0x1c9)]===_0x36862c(0x192))[_0x36862c(0x1ad)](_0x2d8e34=>_0x2d8e34[_0x36862c(0x191)]);_0x53025a[_0x36862c(0x1cb)](..._0x36366b);}return _0x53025a;}async[a403_0x53a191(0x1af)](_0x5f19bb){const _0x2a07bc=a403_0x53a191;var _0x39d27f;const _0x45b798=[];this['_logger'][_0x2a07bc(0x1b2)](_0x2a07bc(0x1c8));for(const _0x1acaa8 of _0x5f19bb){const {data:_0x215708,headers:_0x1b1098}=await this[_0x2a07bc(0x17f)][_0x2a07bc(0x194)](_0x1acaa8,{'responseType':_0x2a07bc(0x19e)}),_0x3e25eb=(_0x39d27f=_0x1b1098['content-type'])===null||_0x39d27f===void 0x0?void 0x0:_0x39d27f[_0x2a07bc(0x186)]('application/json');if(!_0x3e25eb){const _0x2c2363=_0x215708,_0x16cc5a=new jszip_1[(_0x2a07bc(0x1a2))]();await _0x16cc5a[_0x2a07bc(0x1b9)](_0x2c2363),_0x45b798[_0x2a07bc(0x1cb)](_0x16cc5a);}else{const _0x2501ad=JSON[_0x2a07bc(0x1bd)](_0x215708);throw new veeva_error_1[(_0x2a07bc(0x1b5))](_0x2501ad[_0x2a07bc(0x195)]);}}return _0x45b798;}async[a403_0x53a191(0x1a4)](_0x827ad2){const _0x223ae0=a403_0x53a191;this[_0x223ae0(0x19d)][_0x223ae0(0x1b2)](_0x223ae0(0x17e));const _0x173408=veeva_constants_1['VeevaConstants'][_0x223ae0(0x1a5)]+_0x223ae0(0x1c6);await this[_0x223ae0(0x184)][_0x223ae0(0x18a)](_0x173408,_0x827ad2);}async[a403_0x53a191(0x1c3)](_0x10e889){const _0x7a8b8f=a403_0x53a191;this[_0x7a8b8f(0x19d)]['log'](_0x7a8b8f(0x1b0));const _0x1cc646=veeva_constants_1[_0x7a8b8f(0x190)]['ENDPOINT_CREATE_RECORDS']+_0x7a8b8f(0x1c2);await this['_veevaService'][_0x7a8b8f(0x18a)](_0x1cc646,_0x10e889);}async[a403_0x53a191(0x19c)](_0x91ad28,_0xc714a4){const _0x12b898=a403_0x53a191,_0xf88c40=await this[_0x12b898(0x18d)](Math[_0x12b898(0x1bc)](_0x91ad28[_0x12b898(0x18b)]/veeva_constants_1[_0x12b898(0x190)][_0x12b898(0x199)]),_0xc714a4),_0x4ad3c6=await this['createPackageComponents'](_0x91ad28,_0xf88c40),_0x3202ac=await this[_0x12b898(0x1a8)](_0xf88c40),_0x2dc704=await this[_0x12b898(0x196)](Array[_0x12b898(0x1b8)](_0x3202ac[_0x12b898(0x181)]())),_0x4e5f16=await this[_0x12b898(0x19b)](_0x2dc704),_0x595db0=await this[_0x12b898(0x1af)](_0x4e5f16);return await this[_0x12b898(0x1a4)](_0x4ad3c6),await this['deleteOutboundPackages'](_0xf88c40),_0x595db0;}}exports['PackageExportService']=PackageExportService;