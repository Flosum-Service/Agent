function a335_0x5a87(){const _0x505f8a=['_veevaService','VeevaError','reduce','348DXRpmz','jszip','__esModule','(((.+)+)+)+$','migration__sys','map','PackageExportService','2888065dTDCnz','href','all','constructor','_logger','createExportOutboundPackages','default','722057YOLAPm','MAXIMUM_SIZE_OF_PACKAGE','Creating\x20outbound\x20packages','apply','retrieveVPKList','get','deleteVeevaObjectRecords','Retrieve\x20Outbound\x20Package\x20zip\x20list','toString','push','../constants/veeva.constants','package_component__v','loadAsync','VeevaConstants','export','9kdHDmf','search','../enums/status.enums','includes','6345528aGWiQi','39781siYBKh','post','defineProperty','deletePackageComponents','from','getPackageNames','errors','rel','outbound_package__v','executeVQL','createOutboundPackages','getJobResult','application/x-www-form-urlencoded','filter','Create\x20Export\x20outbound\x20packages.','fill','417740vMIChN','Adding\x20components\x20to\x20outbound\x20package','Removing\x20components\x20from\x20outbound\x20packages.','content-type','name__v','join','artifacts','ENDPOINT_CREATE_RECORDS','ENDPOINT_VQL','parse','1410xbhcBP','Retrieve\x20Jobs\x20Status','createVeevaObjectRecords','ceil','deleteOutboundPackages','log','responseStatus','594106liAiTL','values','Getting\x20names\x20of\x20outbound\x20packages','getEndpointArtifactList','133191RnEpKS','_connection','application/json'];a335_0x5a87=function(){return _0x505f8a;};return a335_0x5a87();}const a335_0x3456b0=a335_0x5103;(function(_0x65f2ce,_0x35c20e){const _0x11748b=a335_0x5103,_0x34a1fe=_0x65f2ce();while(!![]){try{const _0xa21cf=-parseInt(_0x11748b(0x20a))/0x1+parseInt(_0x11748b(0x1f2))/0x2*(-parseInt(_0x11748b(0x1cc))/0x3)+-parseInt(_0x11748b(0x1e1))/0x4+parseInt(_0x11748b(0x203))/0x5+-parseInt(_0x11748b(0x1fc))/0x6*(-parseInt(_0x11748b(0x1d1))/0x7)+-parseInt(_0x11748b(0x1d0))/0x8+-parseInt(_0x11748b(0x1f6))/0x9*(-parseInt(_0x11748b(0x1eb))/0xa);if(_0xa21cf===_0x35c20e)break;else _0x34a1fe['push'](_0x34a1fe['shift']());}catch(_0x322a10){_0x34a1fe['push'](_0x34a1fe['shift']());}}}(a335_0x5a87,0x75ee4));const a335_0x34078e=(function(){let _0x2d82b4=!![];return function(_0x41d675,_0x590456){const _0x21d52b=_0x2d82b4?function(){const _0x125a02=a335_0x5103;if(_0x590456){const _0x3cc8fe=_0x590456[_0x125a02(0x1c0)](_0x41d675,arguments);return _0x590456=null,_0x3cc8fe;}}:function(){};return _0x2d82b4=![],_0x21d52b;};}()),a335_0x245907=a335_0x34078e(this,function(){const _0x1c050d=a335_0x5103;return a335_0x245907[_0x1c050d(0x1c5)]()[_0x1c050d(0x1cd)](_0x1c050d(0x1ff))[_0x1c050d(0x1c5)]()[_0x1c050d(0x206)](a335_0x245907)[_0x1c050d(0x1cd)](_0x1c050d(0x1ff));});a335_0x245907();'use strict';function a335_0x5103(_0x585828,_0x18b0e9){const _0x2d51f6=a335_0x5a87();return a335_0x5103=function(_0x245907,_0x34078e){_0x245907=_0x245907-0x1be;let _0x5a87cd=_0x2d51f6[_0x245907];return _0x5a87cd;},a335_0x5103(_0x585828,_0x18b0e9);}var __importDefault=this&&this['__importDefault']||function(_0x40ba06){return _0x40ba06&&_0x40ba06['__esModule']?_0x40ba06:{'default':_0x40ba06};};Object[a335_0x3456b0(0x1d3)](exports,a335_0x3456b0(0x1fe),{'value':!![]}),exports[a335_0x3456b0(0x202)]=void 0x0;const veeva_constants_1=require(a335_0x3456b0(0x1c7)),jszip_1=__importDefault(require(a335_0x3456b0(0x1fd))),status_enums_1=require(a335_0x3456b0(0x1ce)),veeva_error_1=require('../classes/errors/veeva-error');class PackageExportService{constructor({veevaService:_0x9f0fa7,connection:_0x862760,logger:_0x88b7b5}){const _0x2981b3=a335_0x3456b0;this[_0x2981b3(0x1f9)]=_0x9f0fa7,this[_0x2981b3(0x1f7)]=_0x862760,this[_0x2981b3(0x207)]=_0x88b7b5;}async[a335_0x3456b0(0x1db)](_0x81ac1e,_0x4ee176){const _0x48dfb3=a335_0x3456b0;this[_0x48dfb3(0x207)][_0x48dfb3(0x1f0)](_0x48dfb3(0x1bf));const _0x33a968=veeva_constants_1['VeevaConstants'][_0x48dfb3(0x1e8)]+_0x48dfb3(0x1d9),_0xd879f8=new Array(_0x81ac1e)[_0x48dfb3(0x1e0)]({'summary__v':_0x4ee176,'object_type__v.api__name__v':_0x48dfb3(0x200)});return await this['_veevaService'][_0x48dfb3(0x1ed)](_0x33a968,_0xd879f8);}async['createPackageComponents'](_0x5adecf,_0x44865a){const _0x9b53d2=a335_0x3456b0;this['_logger']['log'](_0x9b53d2(0x1e2));const _0x349108=veeva_constants_1[_0x9b53d2(0x1ca)][_0x9b53d2(0x1e8)]+_0x9b53d2(0x1c8),_0x510959=_0x5adecf['map']((_0xffb219,_0x28eeb8)=>({'vault_component__v':_0xffb219['id'],'outbound_package__v':_0x44865a[Math[_0x9b53d2(0x1ee)]((_0x28eeb8+0x1)/veeva_constants_1[_0x9b53d2(0x1ca)][_0x9b53d2(0x1be)])-0x1]}));return await this[_0x9b53d2(0x1f9)][_0x9b53d2(0x1ed)](_0x349108,_0x510959);}async[a335_0x3456b0(0x1d6)](_0x387965){const _0x2ef62f=a335_0x3456b0;this[_0x2ef62f(0x207)][_0x2ef62f(0x1f0)](_0x2ef62f(0x1f4));const _0x391818='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x387965[_0x2ef62f(0x1e6)]('\x27,\x27')+'\x27)',_0x16874b=veeva_constants_1['VeevaConstants'][_0x2ef62f(0x1e9)]+_0x391818,_0x2a5d51=await this[_0x2ef62f(0x1f9)][_0x2ef62f(0x1da)](_0x16874b);return _0x2a5d51[_0x2ef62f(0x1fb)]((_0x5216ca,_0x53bfcb)=>_0x5216ca['set'](_0x53bfcb['id'],_0x53bfcb[_0x2ef62f(0x1e5)]),new Map());}async[a335_0x3456b0(0x208)](_0x5d041b){const _0x3bd50d=a335_0x3456b0;this[_0x3bd50d(0x207)][_0x3bd50d(0x1f0)](_0x3bd50d(0x1df));const _0x24845e=[],_0x32d66f=_0x5d041b[_0x3bd50d(0x201)](_0x4eec72=>{const _0x3f831e=_0x3bd50d;return this['_connection'][_0x3f831e(0x1d2)](veeva_constants_1['VeevaConstants']['ENDPOINT_EXPORT_IMPORT_PACKAGE'],encodeURI('packageName')+'='+encodeURI(_0x4eec72),{'headers':{'Content-Type':_0x3f831e(0x1dd)}});}),_0x273df3=await Promise[_0x3bd50d(0x205)](_0x32d66f);for(const {data:_0x1f47ca}of _0x273df3){if(_0x1f47ca[_0x3bd50d(0x1f1)]===status_enums_1['VeevaResponseStatus']['SUCCESS']){const {url:_0x9d6a4c}=_0x1f47ca;_0x24845e[_0x3bd50d(0x1c6)](_0x9d6a4c);}else throw new veeva_error_1['VeevaError'](_0x1f47ca['errors']);}return _0x24845e;}async[a335_0x3456b0(0x1f5)](_0x243acc){const _0x1aa2b1=a335_0x3456b0;this['_logger']['log'](_0x1aa2b1(0x1ec));const _0x5d10e0=[],_0x1d8120=await this['_veevaService'][_0x1aa2b1(0x1dc)](_0x243acc);for(const _0x47be0c of _0x1d8120){const _0xcb02bf=_0x47be0c['links'][_0x1aa2b1(0x1de)](_0x415126=>_0x415126[_0x1aa2b1(0x1d8)]===_0x1aa2b1(0x1e7))[_0x1aa2b1(0x201)](_0x13013c=>_0x13013c[_0x1aa2b1(0x204)]);_0x5d10e0['push'](..._0xcb02bf);}return _0x5d10e0;}async[a335_0x3456b0(0x1c1)](_0x3f53f5){const _0x5723b6=a335_0x3456b0;var _0x3329cc;const _0x25e292=[];this[_0x5723b6(0x207)][_0x5723b6(0x1f0)](_0x5723b6(0x1c4));for(const _0xf9d502 of _0x3f53f5){const {data:_0x31e185,headers:_0x3a2ca2}=await this[_0x5723b6(0x1f7)][_0x5723b6(0x1c2)](_0xf9d502,{'responseType':'arraybuffer'}),_0x16707b=(_0x3329cc=_0x3a2ca2[_0x5723b6(0x1e4)])===null||_0x3329cc===void 0x0?void 0x0:_0x3329cc[_0x5723b6(0x1cf)](_0x5723b6(0x1f8));if(!_0x16707b){const _0x4c2a50=_0x31e185,_0x5f4d7e=new jszip_1[(_0x5723b6(0x209))]();await _0x5f4d7e[_0x5723b6(0x1c9)](_0x4c2a50),_0x25e292[_0x5723b6(0x1c6)](_0x5f4d7e);}else{const _0xd5d630=JSON[_0x5723b6(0x1ea)](_0x31e185);throw new veeva_error_1[(_0x5723b6(0x1fa))](_0xd5d630[_0x5723b6(0x1d7)]);}}return _0x25e292;}async[a335_0x3456b0(0x1d4)](_0x4138fa){const _0x2131b1=a335_0x3456b0;this[_0x2131b1(0x207)]['log'](_0x2131b1(0x1e3));const _0x43a38f=veeva_constants_1[_0x2131b1(0x1ca)][_0x2131b1(0x1e8)]+'package_component__v';await this['_veevaService'][_0x2131b1(0x1c3)](_0x43a38f,_0x4138fa);}async[a335_0x3456b0(0x1ef)](_0x345b89){const _0x1e6d4b=a335_0x3456b0;this['_logger']['log']('Deleting\x20outbound\x20packages.');const _0x50146d=veeva_constants_1[_0x1e6d4b(0x1ca)][_0x1e6d4b(0x1e8)]+_0x1e6d4b(0x1d9);await this['_veevaService'][_0x1e6d4b(0x1c3)](_0x50146d,_0x345b89);}async[a335_0x3456b0(0x1cb)](_0x414f35,_0x192982){const _0x22a90b=a335_0x3456b0,_0x58fcce=await this[_0x22a90b(0x1db)](Math[_0x22a90b(0x1ee)](_0x414f35['length']/veeva_constants_1[_0x22a90b(0x1ca)][_0x22a90b(0x1be)]),_0x192982),_0xf3b9ed=await this['createPackageComponents'](_0x414f35,_0x58fcce),_0x3d41f5=await this[_0x22a90b(0x1d6)](_0x58fcce),_0x32d231=await this['createExportOutboundPackages'](Array[_0x22a90b(0x1d5)](_0x3d41f5[_0x22a90b(0x1f3)]())),_0x5ec90f=await this['getEndpointArtifactList'](_0x32d231),_0x515067=await this[_0x22a90b(0x1c1)](_0x5ec90f);return await this[_0x22a90b(0x1d4)](_0xf3b9ed),await this[_0x22a90b(0x1ef)](_0x58fcce),_0x515067;}}exports['PackageExportService']=PackageExportService;