function a310_0x34c0(_0xc8a94a,_0x54d3a9){const _0xa131f7=a310_0x4433();return a310_0x34c0=function(_0x227e0c,_0x324d47){_0x227e0c=_0x227e0c-0x1a7;let _0x4433f7=_0xa131f7[_0x227e0c];return _0x4433f7;},a310_0x34c0(_0xc8a94a,_0x54d3a9);}const a310_0x41d90a=a310_0x34c0;(function(_0x3a58ee,_0x5854fb){const _0x345510=a310_0x34c0,_0x19aa00=_0x3a58ee();while(!![]){try{const _0x5bc1a1=-parseInt(_0x345510(0x1f9))/0x1+-parseInt(_0x345510(0x1e5))/0x2*(-parseInt(_0x345510(0x1c3))/0x3)+parseInt(_0x345510(0x1cf))/0x4*(-parseInt(_0x345510(0x220))/0x5)+parseInt(_0x345510(0x242))/0x6*(-parseInt(_0x345510(0x256))/0x7)+parseInt(_0x345510(0x1cd))/0x8*(parseInt(_0x345510(0x25b))/0x9)+parseInt(_0x345510(0x1c7))/0xa*(parseInt(_0x345510(0x274))/0xb)+parseInt(_0x345510(0x276))/0xc;if(_0x5bc1a1===_0x5854fb)break;else _0x19aa00['push'](_0x19aa00['shift']());}catch(_0x213f45){_0x19aa00['push'](_0x19aa00['shift']());}}}(a310_0x4433,0x4cde5));const a310_0x324d47=(function(){let _0x5e619e=!![];return function(_0x57f912,_0x56c933){const _0x5f3082=_0x5e619e?function(){if(_0x56c933){const _0x5e9cd4=_0x56c933['apply'](_0x57f912,arguments);return _0x56c933=null,_0x5e9cd4;}}:function(){};return _0x5e619e=![],_0x5f3082;};}()),a310_0x227e0c=a310_0x324d47(this,function(){const _0x42785a=a310_0x34c0;return a310_0x227e0c[_0x42785a(0x209)]()['search']('(((.+)+)+)+$')[_0x42785a(0x209)]()[_0x42785a(0x228)](a310_0x227e0c)[_0x42785a(0x1aa)](_0x42785a(0x23d));});function a310_0x4433(){const _0x1a50e9=['FlosumConstants','getValidationDetailsAndSaveLog','PackageComponentStatus','formFlosumDeploymentResults','FLOSUM_NAMESPACE','isDeployed','_logger','toString','deployPackage','lastIndexOf','getDeployDetailsAndSaveLog','status','createReadStream','Succeed__c','patch','updateLog','finishDeploy','Package\x20not\x20verified','files','packageComponentList','_connectionVeeva','VERIFIED','default','data','generateAsync','text','EXCEPTION','Org__c','Branch__c','saveLog','5GkvGuc','_organisationId','VeevaConstants','file','ComponentDto','fetchAttachmentsDetailsByParentId','map','VeevaResponseStatus','constructor','ENDPOINT_EXPORT_IMPORT_PACKAGE','../utils/veeva-auth.utils','Version__c\x20DESC\x20LIMIT\x201)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20','migration__v','base64','PackageComponentDto','.zip','length','SUCCESS','VeevaError','_systemLogger','Retrieving\x20attachments','Component_Name__c,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','../classes/errors/veeva-error','Deployment.log','./salesforce.service','../dtos/package-component.dto','Is_Error__c','flat','_branchId','(((.+)+)+)+$','Action__c','Component_Type__c,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20Id\x20FROM\x20','{package_id}','vaultpackage.xml','258wiuKVM','_metadataLogId','Cannot\x20retrieve\x20all\x20components.','\x20:\x20','Branch__c\x20=\x20\x27','Flosum','Component_History__c','TargetId__c','./veeva.service','form-data','timeZone','attachmentLogId','generateVPK','organisationId','__importDefault','Success','rel','Metadata_Log__c','../dtos/component.dto','../constants/veeva.constants','32858nOoWSe','Component__c\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20','Body','set','responseStatus','2461707GpFden','formPackageComponentList','Components__r\x20ORDER\x20BY\x20','jszip','post','endsWith','_tempFolder','_deploymentName','_connectionSalesforce','isSuccess','\x20</a>','Retrieving\x20components','Deploy\x20package','defineProperty','\x20>\x20','../constants/flosum.constants','get','SalesforceService','Form\x20Deployment\x20Results','Deployment_Result__c','deployment_status__v','retrieveRecords','DEPLOYED','finishDeployWithError','DEPLOYED_WITH_WARNINGS','1400993hVmymJ','componentName','2009556TfXcUr','has','joinAllAttachments','../../../core','shortid','packageId','</a>','search','ENDPOINT_UPSERT_RECORD','_timeZone','retrieveAttachments','content-type','../classes/errors/salesforce-dml-error','MetadataLogStatus','componentIdList','filename','artifacts','Logger','Deploy\x20completed\x20','\x20has\x20been\x20created.','../../../constants','<a\x20href=','importVpk','Activity_Item__c','parse','Branch','VeevaPackageStatus','__esModule','execute','Process_Type__c','ENDPOINT_VALIDATE_PACKAGE','fs/promises','58398iotDvO','name','updateVeevaConnection','errors','10KTioex','headers','Deployment','catch','Get\x20validation\x20details.','error','16SVcUoa','from','749052SZDnYQ','../../shared/utils/fetch-attachments','ENDPOINT_DEPLOY_PACKAGE','url','VeevaJobStatus','getLogResultText','SalesforceDmlError','DeployService','values','Deploy','retrieveComponents','_organisationName','https://veevavault.com/','append','Metadata_Log__c/','/Attachment','getJobResult','detailUrl','Deployment\x20Result','successfully','reduce','Component_Type__c','2EnjCtl','_componentIdList','validateVpk','componentType','application/json','log','Status__c','saveDeploymentResults','insertMultipleRecords','Generate\x20vpk\x20package','Date__c','getJobStatus','_instanceUrl','toLowerCase','JobResultDto','Validation\x20Log','RECREATE','VeevaService','Wait\x20Executing\x20job','Async_Request_Id__c','157380dcVfpH','type','Validation.log','Get\x20deploy\x20result','multipart/form-data','find','filter','with\x20error','branchId'];a310_0x4433=function(){return _0x1a50e9;};return a310_0x4433();}a310_0x227e0c();'use strict';var __importDefault=this&&this[a310_0x41d90a(0x250)]||function(_0x43e8b){const _0x46cb8e=a310_0x41d90a;return _0x43e8b&&_0x43e8b[_0x46cb8e(0x1be)]?_0x43e8b:{'default':_0x43e8b};};Object[a310_0x41d90a(0x268)](exports,a310_0x41d90a(0x1be),{'value':!![]}),exports['DeployService']=void 0x0;const jszip_1=__importDefault(require(a310_0x41d90a(0x25e))),form_data_1=__importDefault(require(a310_0x41d90a(0x24b))),fs_1=require('fs'),promises_1=require(a310_0x41d90a(0x1c2)),constants_1=require(a310_0x41d90a(0x1b7)),flosum_constants_1=require(a310_0x41d90a(0x26a)),veeva_constants_1=require(a310_0x41d90a(0x255)),veeva_service_1=require(a310_0x41d90a(0x24a)),component_dto_1=require(a310_0x41d90a(0x254)),job_result_dto_1=require('../dtos/job-result.dto'),package_component_dto_1=require(a310_0x41d90a(0x239)),salesforce_service_1=require(a310_0x41d90a(0x238)),core_1=require(a310_0x41d90a(0x279)),status_enums_1=require('../enums/status.enums'),salesforce_dml_error_1=require(a310_0x41d90a(0x1af)),veeva_error_1=require(a310_0x41d90a(0x236)),shortid_1=__importDefault(require(a310_0x41d90a(0x1a7))),veeva_auth_utils_1=require(a310_0x41d90a(0x22a)),xml2js_1=require('xml2js'),fetch_attachments_1=require(a310_0x41d90a(0x1d0));class DeployService{constructor(_0x4565a3,_0x3f1295,_0x19f818,_0x4145ae,_0x337019,_0x2b0b05){const _0x367c8a=a310_0x41d90a;this[_0x367c8a(0x263)]=_0x3f1295,this[_0x367c8a(0x216)]=_0x19f818,this[_0x367c8a(0x208)]=_0x4145ae,this[_0x367c8a(0x261)]=_0x337019,this['_instanceUrl']=_0x2b0b05,this[_0x367c8a(0x23c)]=_0x4565a3[_0x367c8a(0x201)],this[_0x367c8a(0x243)]=_0x4565a3['metadataLogId'],this['_attachmentLogId']=_0x4565a3[_0x367c8a(0x24d)],this['_organisationId']=_0x4565a3[_0x367c8a(0x24f)],this[_0x367c8a(0x1ac)]=_0x4565a3[_0x367c8a(0x24c)],this[_0x367c8a(0x1da)]=_0x4565a3['organisationName'],this['_componentIdList']=_0x4565a3[_0x367c8a(0x1b1)],this[_0x367c8a(0x262)]=_0x4565a3['deploymentName'],this[_0x367c8a(0x233)]=new core_1[(_0x367c8a(0x1b4))]('veeva-deploy');}async[a310_0x41d90a(0x1bf)](){const _0x572c85=a310_0x41d90a;try{const _0x9c9f0a=await this[_0x572c85(0x1d9)](),_0x754fea=await this[_0x572c85(0x1ad)](_0x9c9f0a),_0x4a3ee0=await this[_0x572c85(0x278)](_0x754fea),_0x58e569=await this[_0x572c85(0x24e)](_0x4a3ee0);await this[_0x572c85(0x1e7)](_0x58e569);const _0x1521ab=await this[_0x572c85(0x1b9)](_0x58e569),_0x4d777b=await this[_0x572c85(0x1f0)](_0x1521ab);await this[_0x572c85(0x203)](_0x4d777b);const _0x7e1a95=await this[_0x572c85(0x20a)](_0x4d777b[_0x572c85(0x1a8)]),_0x564be0=await this[_0x572c85(0x1f0)](_0x7e1a95);await this[_0x572c85(0x20c)](_0x564be0);const _0x5e42f2=this[_0x572c85(0x205)](_0x9c9f0a,_0x564be0['packageComponentList']);await this[_0x572c85(0x1ec)](_0x5e42f2),await this[_0x572c85(0x212)](_0x564be0['isDeployed'],![],_0x4d777b[_0x572c85(0x1a8)]);}catch(_0x448ef9){await this[_0x572c85(0x272)](_0x448ef9)[_0x572c85(0x1ca)](_0x31f60e=>this[_0x572c85(0x233)][_0x572c85(0x1cc)](_0x31f60e));}}async[a310_0x41d90a(0x1d9)](){const _0x3ffdfb=a310_0x41d90a,_0x288e6e=new Set(this[_0x3ffdfb(0x1e6)]);this['_logger'][_0x3ffdfb(0x1ea)](_0x3ffdfb(0x266));const _0x189e63='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+constants_1[_0x3ffdfb(0x206)]+_0x3ffdfb(0x235)+constants_1[_0x3ffdfb(0x206)]+_0x3ffdfb(0x23f)+constants_1[_0x3ffdfb(0x206)]+_0x3ffdfb(0x25d)+constants_1['FLOSUM_NAMESPACE']+_0x3ffdfb(0x22b)+constants_1['FLOSUM_NAMESPACE']+_0x3ffdfb(0x257)+constants_1[_0x3ffdfb(0x206)]+_0x3ffdfb(0x246)+this[_0x3ffdfb(0x23c)]+'\x27',_0x2ecaed=await salesforce_service_1[_0x3ffdfb(0x26c)][_0x3ffdfb(0x270)](this[_0x3ffdfb(0x263)],_0x189e63);if(!_0x2ecaed[_0x3ffdfb(0x230)])throw new Error(_0x3ffdfb(0x244));const _0x23cc54=_0x2ecaed['map'](_0x467308=>new component_dto_1[(_0x3ffdfb(0x224))](_0x467308))['filter'](_0x2e090d=>_0x288e6e[_0x3ffdfb(0x277)](_0x2e090d['id']));if(_0x23cc54[_0x3ffdfb(0x230)]!==this[_0x3ffdfb(0x1e6)][_0x3ffdfb(0x230)])throw new Error('Cannot\x20retrieve\x20all\x20components.');return _0x23cc54;}async['retrieveAttachments'](_0x47284b){const _0x47f895=a310_0x41d90a;this['_logger']['log'](_0x47f895(0x234));const _0x486415=await(0x0,fetch_attachments_1[_0x47f895(0x225)])(this[_0x47f895(0x263)],_0x47284b[_0x47f895(0x226)](_0x2882c3=>_0x2882c3['componentHistoryId'])),_0x1b863b=await(0x0,fetch_attachments_1['retrieveAttachments'])(_0x486415,this['_connectionSalesforce']);if(_0x1b863b[_0x47f895(0x230)]!==this['_componentIdList']['length'])throw new Error('Cannot\x20retrieve\x20all\x20attachments');return _0x1b863b[_0x47f895(0x226)](_0x23ae8b=>_0x23ae8b[_0x47f895(0x1d7)][_0x47f895(0x258)]);}async[a310_0x41d90a(0x278)](_0x8c05a9){const _0x391b89=a310_0x41d90a;var _0x39e5d6;this['_logger'][_0x391b89(0x1ea)]('Join\x20all\x20mdl\x20into\x20one\x20zip');const _0x55c483=new jszip_1[(_0x391b89(0x218))]();for(const _0x1a6e37 of _0x8c05a9){const _0x3c2f36=new jszip_1[(_0x391b89(0x218))]();await _0x3c2f36['loadAsync'](_0x1a6e37,{'base64':!![]});for(const _0x48ef8e in _0x3c2f36[_0x391b89(0x214)]){const _0x363374=await((_0x39e5d6=_0x3c2f36['file'](_0x48ef8e))===null||_0x39e5d6===void 0x0?void 0x0:_0x39e5d6['async']('string'));_0x363374&&_0x55c483[_0x391b89(0x223)](_0x48ef8e,_0x363374);}}const _0x5c72c5=new xml2js_1['Builder']({'headless':!![]}),_0x2c85d3={'vaultpackage':{'$':{'xmlns':_0x391b89(0x1db)},'name':this['_deploymentName'],'source':{'vault':undefined,'author':_0x391b89(0x247)},'packagetype':_0x391b89(0x22c),'summary':_0x391b89(0x1d8),'description':'null'}};_0x55c483['file'](_0x391b89(0x241),_0x5c72c5['buildObject'](_0x2c85d3));const _0x588a72=this[_0x391b89(0x261)]+'/'+(0x0,shortid_1[_0x391b89(0x218)])()+_0x391b89(0x22f),_0x393169=await _0x55c483[_0x391b89(0x21a)]({'type':'nodebuffer'});return await(0x0,promises_1['writeFile'])(_0x588a72,_0x393169),_0x588a72;}async[a310_0x41d90a(0x24e)](_0x58b7a4,_0x1fbe8a=0x1){const _0x26b7e1=a310_0x41d90a;var _0x57b281;this['_logger'][_0x26b7e1(0x1ea)](_0x26b7e1(0x1ee));const _0x2e6996=new form_data_1['default']();_0x2e6996[_0x26b7e1(0x1dc)](_0x26b7e1(0x223),(0x0,fs_1[_0x26b7e1(0x20e)])(_0x58b7a4));const _0x320f72=await this[_0x26b7e1(0x216)][_0x26b7e1(0x25f)](veeva_constants_1['VeevaConstants'][_0x26b7e1(0x229)],_0x2e6996,{'responseType':'arraybuffer','headers':{'Content-Type':_0x26b7e1(0x1fd)}}),_0x3d341c=(_0x57b281=_0x320f72[_0x26b7e1(0x1c8)][_0x26b7e1(0x1ae)])===null||_0x57b281===void 0x0?void 0x0:_0x57b281['includes'](_0x26b7e1(0x1e9));if(!_0x3d341c){const _0x1328cd=_0x320f72[_0x26b7e1(0x219)],_0x56073f=this[_0x26b7e1(0x261)]+'/vpk__'+_0x58b7a4['slice'](_0x58b7a4[_0x26b7e1(0x20b)]('/')+0x1);return await(0x0,promises_1['writeFile'])(_0x56073f,_0x1328cd),_0x56073f;}else{const _0x3463eb=JSON[_0x26b7e1(0x1bb)](_0x320f72[_0x26b7e1(0x219)]);if(_0x1fbe8a>0x0)return await(0x0,veeva_auth_utils_1[_0x26b7e1(0x1c5)])(this[_0x26b7e1(0x216)]),await this[_0x26b7e1(0x24e)](_0x58b7a4,_0x1fbe8a-0x1);throw new veeva_error_1['VeevaError'](_0x3463eb[_0x26b7e1(0x1c6)]);}}async[a310_0x41d90a(0x1e7)](_0x42c1b9,_0x4c2157=0x1){const _0x468dc1=a310_0x41d90a;this['_logger'][_0x468dc1(0x1ea)]('Validate\x20package');const _0x5d079f=new form_data_1[(_0x468dc1(0x218))]();_0x5d079f['append'](_0x468dc1(0x223),(0x0,fs_1['createReadStream'])(_0x42c1b9));const _0x565481=await this[_0x468dc1(0x216)]['post'](veeva_constants_1[_0x468dc1(0x222)][_0x468dc1(0x1c1)],_0x5d079f,{'headers':{'Content-Type':'multipart/form-data'}}),_0x33e364=_0x565481[_0x468dc1(0x219)];if(_0x33e364[_0x468dc1(0x25a)]===status_enums_1[_0x468dc1(0x227)]['SUCCESS'])return _0x33e364;else{if(_0x4c2157>0x0)return await(0x0,veeva_auth_utils_1['updateVeevaConnection'])(this[_0x468dc1(0x216)]),await this[_0x468dc1(0x1e7)](_0x42c1b9,_0x4c2157-0x1);throw new veeva_error_1[(_0x468dc1(0x232))](_0x33e364['errors']);}}async[a310_0x41d90a(0x1b9)](_0x59816e,_0xddf853=0x1){const _0x5222ce=a310_0x41d90a;this[_0x5222ce(0x208)][_0x5222ce(0x1ea)]('Import\x20package');const _0x2dfb39=new form_data_1[(_0x5222ce(0x218))]();_0x2dfb39[_0x5222ce(0x1dc)]('file',(0x0,fs_1[_0x5222ce(0x20e)])(_0x59816e));const _0x48c2e3=await this[_0x5222ce(0x216)]['put'](veeva_constants_1[_0x5222ce(0x222)][_0x5222ce(0x229)],_0x2dfb39,{'headers':{'Content-Type':'multipart/form-data'}}),_0x2a4812=_0x48c2e3['data'];if(_0x2a4812[_0x5222ce(0x25a)]===status_enums_1[_0x5222ce(0x227)][_0x5222ce(0x231)])return _0x2a4812[_0x5222ce(0x1d2)];else{if(_0xddf853>0x0)return await(0x0,veeva_auth_utils_1[_0x5222ce(0x1c5)])(this[_0x5222ce(0x216)]),await this[_0x5222ce(0x1b9)](_0x59816e,_0xddf853-0x1);throw new veeva_error_1[(_0x5222ce(0x232))](_0x2a4812['errors']);}}async[a310_0x41d90a(0x20a)](_0x12481c){const _0x44e5d6=a310_0x41d90a;this[_0x44e5d6(0x208)]['log'](_0x44e5d6(0x267));const _0x14e087=await this[_0x44e5d6(0x216)][_0x44e5d6(0x25f)](veeva_constants_1[_0x44e5d6(0x222)][_0x44e5d6(0x1d1)]['replace'](_0x44e5d6(0x240),_0x12481c)),_0x73789b=await _0x14e087[_0x44e5d6(0x219)];if(_0x73789b[_0x44e5d6(0x25a)]===status_enums_1[_0x44e5d6(0x227)][_0x44e5d6(0x231)])return _0x73789b[_0x44e5d6(0x1d2)];else throw new veeva_error_1[(_0x44e5d6(0x232))](_0x73789b[_0x44e5d6(0x1c6)]);}async['getJobStatus'](_0x524ee0){const _0x558bc2=a310_0x41d90a;this['_logger'][_0x558bc2(0x1ea)](_0x558bc2(0x1f7));const _0x372276=new job_result_dto_1[(_0x558bc2(0x1f3))](),[_0x134197]=await veeva_service_1[_0x558bc2(0x1f6)][_0x558bc2(0x1df)]([_0x524ee0],this[_0x558bc2(0x216)],this[_0x558bc2(0x208)]);return _0x372276[_0x558bc2(0x264)]=_0x134197[_0x558bc2(0x20d)]===status_enums_1[_0x558bc2(0x1d3)][_0x558bc2(0x231)],_0x372276['detailUrl']=_0x134197['links'][_0x558bc2(0x1fe)](_0x481e98=>_0x481e98[_0x558bc2(0x252)]===_0x558bc2(0x1b3))['href'],_0x372276;}async[a310_0x41d90a(0x203)](_0x5985f2){const _0x82b72e=a310_0x41d90a;this[_0x82b72e(0x208)]['log'](_0x82b72e(0x1cb));const {data:_0x29fcda}=await this[_0x82b72e(0x216)][_0x82b72e(0x26b)](_0x5985f2['detailUrl']);if(_0x29fcda[_0x82b72e(0x25a)]===status_enums_1[_0x82b72e(0x227)]['SUCCESS']){const {log:_0x2240b8,id:_0x39b0da,package_status:_0x261873}=_0x29fcda['vaultPackage'],_0x1ac096=_0x2240b8['filter'](_0x12e4ab=>_0x12e4ab[_0x82b72e(0x1b2)][_0x82b72e(0x260)](_0x82b72e(0x1fb))),_0x2b9da1=await this['getLogResultText'](_0x1ac096[0x0][_0x82b72e(0x1d2)]);await this[_0x82b72e(0x21f)](_0x2b9da1,_0x82b72e(0x1f4)),_0x5985f2['packageId']=_0x39b0da;if(_0x261873!==status_enums_1['VeevaPackageStatus'][_0x82b72e(0x217)])throw new Error(_0x82b72e(0x213));}else throw new veeva_error_1[(_0x82b72e(0x232))](_0x29fcda['errors']);}async[a310_0x41d90a(0x20c)](_0x35da33){const _0x2bb82f=a310_0x41d90a;this[_0x2bb82f(0x208)][_0x2bb82f(0x1ea)](_0x2bb82f(0x1fc));const {data:_0x2d6b97}=await this[_0x2bb82f(0x216)][_0x2bb82f(0x26b)](_0x35da33[_0x2bb82f(0x1e0)]);if(_0x2d6b97[_0x2bb82f(0x25a)]===status_enums_1[_0x2bb82f(0x227)][_0x2bb82f(0x231)]){const {responseDetails:{deployment_log:_0x2611ca,package_status__v:_0x259cb3},package_steps:_0x38bf9f}=_0x2d6b97,_0x577330=_0x2611ca[_0x2bb82f(0x1ff)](_0x56fe36=>_0x56fe36[_0x2bb82f(0x1b2)][_0x2bb82f(0x260)](_0x2bb82f(0x237))),_0x3bcfca=await this[_0x2bb82f(0x1d4)](_0x577330[0x0][_0x2bb82f(0x1d2)]);await this['saveLog'](_0x3bcfca,'Deploy\x20Log'),_0x35da33[_0x2bb82f(0x207)]=[status_enums_1[_0x2bb82f(0x1bd)][_0x2bb82f(0x271)],status_enums_1[_0x2bb82f(0x1bd)][_0x2bb82f(0x273)]]['includes'](_0x259cb3);const _0xce1621=this[_0x2bb82f(0x25c)](_0x38bf9f);_0x35da33['packageComponentList']=_0xce1621[_0x2bb82f(0x1ff)](_0x5bebb3=>_0x5bebb3['status']!==status_enums_1['PackageComponentStatus'][_0x2bb82f(0x217)]);if(!_0x35da33[_0x2bb82f(0x215)][_0x2bb82f(0x230)])throw new Error('Cannot\x20find\x20deployment\x20results');}else throw new veeva_error_1[(_0x2bb82f(0x232))](_0x2d6b97[_0x2bb82f(0x1c6)]);}async[a310_0x41d90a(0x1d4)](_0x1d7253){const _0x35e397=a310_0x41d90a,{data:_0x13c922}=await this[_0x35e397(0x216)][_0x35e397(0x26b)](_0x1d7253,{'responseType':_0x35e397(0x21b)});return _0x13c922;}[a310_0x41d90a(0x25c)](_0xd4f543){const _0x140fbf=a310_0x41d90a;return _0xd4f543[_0x140fbf(0x1e3)]((_0x561165,_0x3d3e03)=>{const _0xd028ac=_0x140fbf,_0x227827=_0x3d3e03['package_components'][_0xd028ac(0x226)](_0x5d7c76=>new package_component_dto_1[(_0xd028ac(0x22e))](_0x5d7c76,_0x3d3e03[_0xd028ac(0x26f)]));return[..._0x561165,..._0x227827];},[]);}async[a310_0x41d90a(0x21f)](_0x398745,_0x25c871){const _0x5dcc99=a310_0x41d90a;this[_0x5dcc99(0x208)]['log']('Save\x20log');const _0x3e4d0b={'Body':Buffer[_0x5dcc99(0x1ce)](_0x398745)[_0x5dcc99(0x209)](_0x5dcc99(0x22d)),'ContentType':'text/plain','ParentId':this[_0x5dcc99(0x243)],'Name':_0x25c871},{data:_0x34bb26}=await this['_connectionSalesforce'][_0x5dcc99(0x25f)](flosum_constants_1[_0x5dcc99(0x202)][_0x5dcc99(0x1ab)]+_0x5dcc99(0x1de),_0x3e4d0b);return _0x34bb26['id'];}[a310_0x41d90a(0x205)](_0x4f20d8,_0x4b8c95){const _0xf0af3b=a310_0x41d90a;this[_0xf0af3b(0x208)][_0xf0af3b(0x1ea)](_0xf0af3b(0x26d));const _0x2c4fab=_0x4f20d8[_0xf0af3b(0x1e3)]((_0x237884,_0x577ad9)=>_0x237884[_0xf0af3b(0x259)]((_0x577ad9[_0xf0af3b(0x1e8)]+'.'+_0x577ad9[_0xf0af3b(0x275)])['toLowerCase'](),_0x577ad9),new Map());return _0x4b8c95[_0xf0af3b(0x226)](_0x473338=>{const _0x2470d9=_0xf0af3b;this[_0x2470d9(0x208)][_0x2470d9(0x1ea)](_0x473338[_0x2470d9(0x1fa)]+'.'+_0x473338[_0x2470d9(0x1c4)]+_0x2470d9(0x245)+_0x473338['status']);const _0x40a5ab=(_0x473338[_0x2470d9(0x1fa)]+'.'+_0x473338[_0x2470d9(0x1c4)])[_0x2470d9(0x1f2)](),_0x4f21da=_0x2c4fab[_0x2470d9(0x26b)](_0x40a5ab);return{[constants_1[_0x2470d9(0x206)]+'Type__c']:_0x2470d9(0x1e1),[constants_1[_0x2470d9(0x206)]+_0x2470d9(0x1eb)]:_0x473338[_0x2470d9(0x20d)]===status_enums_1[_0x2470d9(0x204)][_0x2470d9(0x271)]?_0x2470d9(0x251):'Failure',[constants_1['FLOSUM_NAMESPACE']+'Result__c']:_0x2470d9(0x1f5),[constants_1['FLOSUM_NAMESPACE']+'Component_Name__c']:_0x473338['name'],[constants_1['FLOSUM_NAMESPACE']+_0x2470d9(0x1e4)]:_0x473338['type'],[constants_1[_0x2470d9(0x206)]+_0x2470d9(0x21d)]:this[_0x2470d9(0x221)],[constants_1[_0x2470d9(0x206)]+_0x2470d9(0x253)]:this['_metadataLogId'],[constants_1[_0x2470d9(0x206)]+_0x2470d9(0x248)]:_0x4f21da['componentHistoryId']};});}async[a310_0x41d90a(0x1ec)](_0x2f0457){const _0x459497=a310_0x41d90a;this[_0x459497(0x208)][_0x459497(0x1ea)]('Save\x20Deployment\x20Results');const _0x455a7b=await salesforce_service_1['SalesforceService'][_0x459497(0x1ed)](this[_0x459497(0x263)],constants_1[_0x459497(0x206)]+_0x459497(0x26e),_0x2f0457),_0x5ada01=_0x455a7b[_0x459497(0x1ff)](_0x1886b3=>!_0x1886b3['success'])[_0x459497(0x226)](_0x21c8d3=>_0x21c8d3['errors'])[_0x459497(0x23b)]();if(_0x5ada01[_0x459497(0x230)])throw new salesforce_dml_error_1[(_0x459497(0x1d5))](_0x5ada01);}async[a310_0x41d90a(0x272)](_0x1a1f52){const _0x42bcd7=a310_0x41d90a;this[_0x42bcd7(0x208)]['logError'](_0x1a1f52),await this[_0x42bcd7(0x208)][_0x42bcd7(0x211)](),await this['finishDeploy'](![],!![],'');}async['finishDeploy'](_0x1e8685,_0x461dcb,_0x535d55){const _0x53d9c7=a310_0x41d90a,_0x5b9955=_0x53d9c7(0x1b8)+this[_0x53d9c7(0x1f1)]+'/'+this[_0x53d9c7(0x243)]+_0x53d9c7(0x269)+'Veeva\x20Deployment'+_0x53d9c7(0x265),_0x164bba=_0x53d9c7(0x1b8)+this[_0x53d9c7(0x1f1)]+'/'+this[_0x53d9c7(0x221)]+'\x20>'+this[_0x53d9c7(0x1da)]+_0x53d9c7(0x1a9),_0x180d5e=_0x5b9955+'\x20of\x20branch\x20to\x20Organization\x20'+_0x164bba+_0x53d9c7(0x1b6),_0x58c2eb={[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x23e)]:_0x180d5e,[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x1ef)]:new Date(),[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x21e)]:this[_0x53d9c7(0x23c)],[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x1ba)]:_0x53d9c7(0x1bc),[constants_1[_0x53d9c7(0x206)]+'Activity_Type__c']:_0x53d9c7(0x1c9),[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x249)]:this[_0x53d9c7(0x221)]},_0x220730={[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x23a)]:!_0x1e8685,[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x20f)]:_0x1e8685,[constants_1[_0x53d9c7(0x206)]+'Status__c']:_0x461dcb?status_enums_1[_0x53d9c7(0x1b0)][_0x53d9c7(0x21c)]:status_enums_1['MetadataLogStatus']['COMPLETED'],[constants_1[_0x53d9c7(0x206)]+'Job_Completed__c']:!![],[constants_1['FLOSUM_NAMESPACE']+_0x53d9c7(0x1c0)]:flosum_constants_1[_0x53d9c7(0x202)]['PROCESS_DEPLOYMENT'],[constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x1f8)]:_0x535d55};await this['_connectionSalesforce'][_0x53d9c7(0x210)](flosum_constants_1[_0x53d9c7(0x202)]['ENDPOINT_UPSERT_RECORD']+'/'+constants_1[_0x53d9c7(0x206)]+_0x53d9c7(0x1dd)+this[_0x53d9c7(0x243)],_0x220730),await this[_0x53d9c7(0x263)][_0x53d9c7(0x25f)](flosum_constants_1['FlosumConstants']['ENDPOINT_UPSERT_RECORD']+'/'+constants_1[_0x53d9c7(0x206)]+'Log__c',_0x58c2eb),this[_0x53d9c7(0x208)][_0x53d9c7(0x1ea)](_0x53d9c7(0x1b5)+(_0x1e8685?_0x53d9c7(0x1e2):_0x53d9c7(0x200))+'.'),await this[_0x53d9c7(0x208)][_0x53d9c7(0x211)]();}}exports[a310_0x41d90a(0x1d6)]=DeployService;