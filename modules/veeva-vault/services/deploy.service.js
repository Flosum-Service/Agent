const a255_0x5f1d5d=a255_0x1699;(function(_0x783fb5,_0x55f76b){const _0x16e718=a255_0x1699,_0x19b376=_0x783fb5();while(!![]){try{const _0x603ae3=-parseInt(_0x16e718(0x173))/0x1+-parseInt(_0x16e718(0x187))/0x2+-parseInt(_0x16e718(0x101))/0x3+parseInt(_0x16e718(0x11a))/0x4*(-parseInt(_0x16e718(0x19b))/0x5)+-parseInt(_0x16e718(0x13e))/0x6+parseInt(_0x16e718(0x152))/0x7+parseInt(_0x16e718(0x135))/0x8;if(_0x603ae3===_0x55f76b)break;else _0x19b376['push'](_0x19b376['shift']());}catch(_0x23cd11){_0x19b376['push'](_0x19b376['shift']());}}}(a255_0x1795,0x2035e));const a255_0xa429d4=(function(){let _0x455dc2=!![];return function(_0x4290ed,_0x5d3c9c){const _0x124e7e=_0x455dc2?function(){if(_0x5d3c9c){const _0x58a419=_0x5d3c9c['apply'](_0x4290ed,arguments);return _0x5d3c9c=null,_0x58a419;}}:function(){};return _0x455dc2=![],_0x124e7e;};}()),a255_0xc76457=a255_0xa429d4(this,function(){const _0x2b7976=a255_0x1699;return a255_0xc76457['toString']()[_0x2b7976(0xe0)](_0x2b7976(0x1b8))['toString']()['constructor'](a255_0xc76457)[_0x2b7976(0xe0)](_0x2b7976(0x1b8));});a255_0xc76457();'use strict';function a255_0x1795(){const _0x2f8403=['Date__c','Activity_Item__c','MetadataLogStatus','file','deploymentName','JobResultDto','49628VqQOEh','_tempFolder','generateVPK','Version__c\x20DESC\x20LIMIT\x201)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20','jszip','Process_Type__c','data','null','../../shared/utils/fetch-attachments','replace','formPackageComponentList','VeevaError','.zip','_timeZone','getJobResult','validateVpk','__esModule','</a>','PROCESS_DEPLOYMENT','_connectionSalesforce','Save\x20log','has','Job_Completed__c','Component_Type__c','ENDPOINT_UPSERT_RECORD','toLowerCase','Deployment_Result__c','6104544gFnnsb','Flosum','Deployment','Metadata_Log__c/','filter','get','DEPLOYED','getJobStatus','componentHistoryId','30750LNIPEs','find','updateLog','package_components','Result__c','Validate\x20package','success','error','reduce','FlosumConstants','_metadataLogId','name','async','migration__v','ENDPOINT_VALIDATE_PACKAGE','form-data','/Attachment','vaultpackage.xml','_instanceUrl','{package_id}','498939DmejNK','Succeed__c','finishDeploy','responseStatus','filename','Cannot\x20retrieve\x20all\x20components.','length','retrieveComponents','Validation\x20Log','../enums/status.enums','PackageComponentStatus','Action__c','type','Branch','base64','ComponentDto','isDeployed','detailUrl','updateVeevaConnection','RECREATE','../../../constants','../classes/errors/veeva-error','\x20:\x20','logError','_organisationName','slice','content-type','VeevaResponseStatus','_componentIdList','../../../core','links','url','Form\x20Deployment\x20Results','253882ZqDLZW','Metadata_Log__c','text','importVpk','shortid','set','../utils/veeva-auth.utils','execute','catch','Body','/vpk__','Components__r\x20ORDER\x20BY\x20','../dtos/component.dto','Builder','SUCCESS','_systemLogger','deployPackage','_logger','Type__c','PackageComponentDto','421864ciARac','Activity_Type__c','Retrieving\x20components','multipart/form-data','string','fetchAttachmentsDetailsByParentId','componentIdList','getLogResultText','<a\x20href=','finishDeployWithError','xml2js','Deploy\x20package','EXCEPTION','organisationName','includes','nodebuffer','Component__c\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20','_connectionVeeva','Success','../constants/flosum.constants','80zDlgrq','writeFile','createReadStream','formFlosumDeploymentResults','VeevaConstants','errors','Component_Name__c','\x20has\x20been\x20created.','packageComponentList','Import\x20package','FLOSUM_NAMESPACE','\x20>\x20','Deploy\x20Log','Branch__c\x20=\x20\x27','VeevaJobStatus','Veeva\x20Deployment','map','VERIFIED','Save\x20Deployment\x20Results','ENDPOINT_DEPLOY_PACKAGE','text/plain','_branchId','VeevaPackageStatus','getDeployDetailsAndSaveLog','metadataLogId','successfully','./salesforce.service','headers','Is_Error__c','(((.+)+)+)+$','DeployService','application/json','SalesforceService','flat','__importDefault','saveDeploymentResults','search','Get\x20deploy\x20result','SalesforceDmlError','saveLog','_organisationId','log','default','veeva-deploy','./veeva.service','Get\x20validation\x20details.','\x20of\x20branch\x20to\x20Organization\x20','Status__c','getValidationDetailsAndSaveLog','ENDPOINT_EXPORT_IMPORT_PACKAGE','Cannot\x20find\x20deployment\x20results','parse','endsWith','DEPLOYED_WITH_WARNINGS','https://veevavault.com/','Component_Name__c,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','organisationId','patch','values','defineProperty','../classes/errors/salesforce-dml-error','isSuccess','Deployment.log','generateAsync','Retrieving\x20attachments','packageId','post','Join\x20all\x20mdl\x20into\x20one\x20zip','../dtos/job-result.dto','101880APGZtU','append','buildObject','retrieveRecords','Failure','Package\x20not\x20verified','Branch__c','Component_History__c','from','Cannot\x20retrieve\x20all\x20attachments','attachmentLogId','_deploymentName','../constants/veeva.constants','componentType','componentName','loadAsync','status','_attachmentLogId','Deploy\x20completed\x20'];a255_0x1795=function(){return _0x2f8403;};return a255_0x1795();}var __importDefault=this&&this[a255_0x5f1d5d(0xde)]||function(_0x67912f){return _0x67912f&&_0x67912f['__esModule']?_0x67912f:{'default':_0x67912f};};function a255_0x1699(_0x376cfd,_0x419d57){const _0x3fac83=a255_0x1795();return a255_0x1699=function(_0xc76457,_0xa429d4){_0xc76457=_0xc76457-0xde;let _0x179597=_0x3fac83[_0xc76457];return _0x179597;},a255_0x1699(_0x376cfd,_0x419d57);}Object[a255_0x5f1d5d(0xf7)](exports,a255_0x5f1d5d(0x12a),{'value':!![]}),exports[a255_0x5f1d5d(0x1b9)]=void 0x0;const jszip_1=__importDefault(require(a255_0x5f1d5d(0x11e))),form_data_1=__importDefault(require(a255_0x5f1d5d(0x14d))),fs_1=require('fs'),promises_1=require('fs/promises'),constants_1=require(a255_0x5f1d5d(0x166)),flosum_constants_1=require(a255_0x5f1d5d(0x19a)),veeva_constants_1=require(a255_0x5f1d5d(0x10d)),veeva_service_1=require(a255_0x5f1d5d(0xe8)),component_dto_1=require(a255_0x5f1d5d(0x17f)),job_result_dto_1=require(a255_0x5f1d5d(0x100)),package_component_dto_1=require('../dtos/package-component.dto'),salesforce_service_1=require(a255_0x5f1d5d(0x1b5)),core_1=require(a255_0x5f1d5d(0x16f)),status_enums_1=require(a255_0x5f1d5d(0x15b)),salesforce_dml_error_1=require(a255_0x5f1d5d(0xf8)),veeva_error_1=require(a255_0x5f1d5d(0x167)),shortid_1=__importDefault(require(a255_0x5f1d5d(0x177))),veeva_auth_utils_1=require(a255_0x5f1d5d(0x179)),xml2js_1=require(a255_0x5f1d5d(0x191)),fetch_attachments_1=require(a255_0x5f1d5d(0x122));class DeployService{constructor(_0x58c2cf,_0x579b0f,_0x5ec107,_0x178cf1,_0x36baba,_0x246d44){const _0x4000df=a255_0x5f1d5d;this[_0x4000df(0x12d)]=_0x579b0f,this['_connectionVeeva']=_0x5ec107,this[_0x4000df(0x184)]=_0x178cf1,this[_0x4000df(0x11b)]=_0x36baba,this['_instanceUrl']=_0x246d44,this[_0x4000df(0x1b0)]=_0x58c2cf['branchId'],this[_0x4000df(0x148)]=_0x58c2cf[_0x4000df(0x1b3)],this[_0x4000df(0x112)]=_0x58c2cf[_0x4000df(0x10b)],this[_0x4000df(0xe4)]=_0x58c2cf[_0x4000df(0xf4)],this[_0x4000df(0x127)]=_0x58c2cf['timeZone'],this['_organisationName']=_0x58c2cf[_0x4000df(0x194)],this[_0x4000df(0x16e)]=_0x58c2cf[_0x4000df(0x18d)],this[_0x4000df(0x10c)]=_0x58c2cf[_0x4000df(0x118)],this['_systemLogger']=new core_1['Logger'](_0x4000df(0xe7));}async[a255_0x5f1d5d(0x17a)](){const _0x3b8e73=a255_0x5f1d5d;try{const _0x1d8f30=await this[_0x3b8e73(0x159)](),_0x128473=await this['retrieveAttachments'](_0x1d8f30),_0x2aa385=await this['joinAllAttachments'](_0x128473),_0x4bb298=await this[_0x3b8e73(0x11c)](_0x2aa385);await this['validateVpk'](_0x4bb298);const _0x565e8b=await this[_0x3b8e73(0x176)](_0x4bb298),_0x4f4d03=await this[_0x3b8e73(0x13c)](_0x565e8b);await this[_0x3b8e73(0xec)](_0x4f4d03);const _0x25e636=await this[_0x3b8e73(0x183)](_0x4f4d03[_0x3b8e73(0xfd)]),_0x2ac79b=await this[_0x3b8e73(0x13c)](_0x25e636);await this[_0x3b8e73(0x1b2)](_0x2ac79b);const _0x2fb8bb=this[_0x3b8e73(0x19e)](_0x1d8f30,_0x2ac79b['packageComponentList']);await this['saveDeploymentResults'](_0x2fb8bb),await this[_0x3b8e73(0x154)](_0x2ac79b[_0x3b8e73(0x162)],![],_0x4f4d03[_0x3b8e73(0xfd)]);}catch(_0x5e2568){await this[_0x3b8e73(0x190)](_0x5e2568)[_0x3b8e73(0x17b)](_0x2cd182=>this[_0x3b8e73(0x182)][_0x3b8e73(0x145)](_0x2cd182));}}async[a255_0x5f1d5d(0x159)](){const _0x506881=a255_0x5f1d5d,_0x35f6ea=new Set(this[_0x506881(0x16e)]);this[_0x506881(0x184)][_0x506881(0xe5)](_0x506881(0x189));const _0x10e8a2='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+constants_1['FLOSUM_NAMESPACE']+_0x506881(0xf3)+constants_1[_0x506881(0x1a5)]+'Component_Type__c,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20Id\x20FROM\x20'+constants_1[_0x506881(0x1a5)]+_0x506881(0x17e)+constants_1[_0x506881(0x1a5)]+_0x506881(0x11d)+constants_1['FLOSUM_NAMESPACE']+_0x506881(0x197)+constants_1['FLOSUM_NAMESPACE']+_0x506881(0x1a8)+this[_0x506881(0x1b0)]+'\x27',_0x422415=await salesforce_service_1['SalesforceService'][_0x506881(0x104)](this[_0x506881(0x12d)],_0x10e8a2);if(!_0x422415[_0x506881(0x158)])throw new Error(_0x506881(0x157));const _0x285740=_0x422415['map'](_0x17df51=>new component_dto_1[(_0x506881(0x161))](_0x17df51))[_0x506881(0x139)](_0x53134e=>_0x35f6ea[_0x506881(0x12f)](_0x53134e['id']));if(_0x285740[_0x506881(0x158)]!==this[_0x506881(0x16e)]['length'])throw new Error(_0x506881(0x157));return _0x285740;}async['retrieveAttachments'](_0x96dcb7){const _0x58dd0f=a255_0x5f1d5d;this['_logger'][_0x58dd0f(0xe5)](_0x58dd0f(0xfc));const _0x1f2579=await(0x0,fetch_attachments_1[_0x58dd0f(0x18c)])(this[_0x58dd0f(0x12d)],_0x96dcb7[_0x58dd0f(0x1ab)](_0x451bf4=>_0x451bf4[_0x58dd0f(0x13d)])),_0x514a33=await(0x0,fetch_attachments_1['retrieveAttachments'])(_0x1f2579,this['_connectionSalesforce']);if(_0x514a33['length']!==this[_0x58dd0f(0x16e)][_0x58dd0f(0x158)])throw new Error(_0x58dd0f(0x10a));return _0x514a33['map'](_0xb22de9=>_0xb22de9[_0x58dd0f(0xf6)][_0x58dd0f(0x17c)]);}async['joinAllAttachments'](_0x16de2b){const _0x2fe058=a255_0x5f1d5d;var _0x420cba;this[_0x2fe058(0x184)][_0x2fe058(0xe5)](_0x2fe058(0xff));const _0x28ccc3=new jszip_1['default']();for(const _0x440311 of _0x16de2b){const _0x538106=new jszip_1[(_0x2fe058(0xe6))]();await _0x538106[_0x2fe058(0x110)](_0x440311,{'base64':!![]});for(const _0x1090f8 in _0x538106['files']){const _0x4f2794=await((_0x420cba=_0x538106[_0x2fe058(0x117)](_0x1090f8))===null||_0x420cba===void 0x0?void 0x0:_0x420cba[_0x2fe058(0x14a)](_0x2fe058(0x18b)));_0x4f2794&&_0x28ccc3[_0x2fe058(0x117)](_0x1090f8,_0x4f2794);}}const _0x426f6a=new xml2js_1[(_0x2fe058(0x180))]({'headless':!![]}),_0x12bba4={'vaultpackage':{'$':{'xmlns':_0x2fe058(0xf2)},'name':this[_0x2fe058(0x10c)],'source':{'vault':undefined,'author':_0x2fe058(0x136)},'packagetype':_0x2fe058(0x14b),'summary':'Deploy','description':_0x2fe058(0x121)}};_0x28ccc3['file'](_0x2fe058(0x14f),_0x426f6a[_0x2fe058(0x103)](_0x12bba4));const _0x410c76=this[_0x2fe058(0x11b)]+'/'+(0x0,shortid_1[_0x2fe058(0xe6)])()+_0x2fe058(0x126),_0x6e130f=await _0x28ccc3[_0x2fe058(0xfb)]({'type':_0x2fe058(0x196)});return await(0x0,promises_1[_0x2fe058(0x19c)])(_0x410c76,_0x6e130f),_0x410c76;}async['generateVPK'](_0xc40b8b,_0x25b9d4=0x1){const _0x50b237=a255_0x5f1d5d;var _0xd6990;this['_logger'][_0x50b237(0xe5)]('Generate\x20vpk\x20package');const _0xa4433c=new form_data_1['default']();_0xa4433c[_0x50b237(0x102)](_0x50b237(0x117),(0x0,fs_1[_0x50b237(0x19d)])(_0xc40b8b));const _0x1abf6b=await this[_0x50b237(0x198)][_0x50b237(0xfe)](veeva_constants_1[_0x50b237(0x19f)][_0x50b237(0xed)],_0xa4433c,{'responseType':'arraybuffer','headers':{'Content-Type':_0x50b237(0x18a)}}),_0x371c76=(_0xd6990=_0x1abf6b[_0x50b237(0x1b6)][_0x50b237(0x16c)])===null||_0xd6990===void 0x0?void 0x0:_0xd6990[_0x50b237(0x195)](_0x50b237(0x1ba));if(!_0x371c76){const _0x168ccc=_0x1abf6b[_0x50b237(0x120)],_0xf2938e=this[_0x50b237(0x11b)]+_0x50b237(0x17d)+_0xc40b8b[_0x50b237(0x16b)](_0xc40b8b['lastIndexOf']('/')+0x1);return await(0x0,promises_1['writeFile'])(_0xf2938e,_0x168ccc),_0xf2938e;}else{const _0x3fca81=JSON[_0x50b237(0xef)](_0x1abf6b[_0x50b237(0x120)]);if(_0x25b9d4>0x0)return await(0x0,veeva_auth_utils_1[_0x50b237(0x164)])(this['_connectionVeeva']),await this[_0x50b237(0x11c)](_0xc40b8b,_0x25b9d4-0x1);throw new veeva_error_1[(_0x50b237(0x125))](_0x3fca81[_0x50b237(0x1a0)]);}}async[a255_0x5f1d5d(0x129)](_0xd952f,_0x21b021=0x1){const _0x4babc0=a255_0x5f1d5d;this[_0x4babc0(0x184)]['log'](_0x4babc0(0x143));const _0xba6127=new form_data_1[(_0x4babc0(0xe6))]();_0xba6127['append']('file',(0x0,fs_1['createReadStream'])(_0xd952f));const _0x473a93=await this[_0x4babc0(0x198)][_0x4babc0(0xfe)](veeva_constants_1['VeevaConstants'][_0x4babc0(0x14c)],_0xba6127,{'headers':{'Content-Type':_0x4babc0(0x18a)}}),_0x50b33c=_0x473a93[_0x4babc0(0x120)];if(_0x50b33c[_0x4babc0(0x155)]===status_enums_1[_0x4babc0(0x16d)][_0x4babc0(0x181)])return _0x50b33c;else{if(_0x21b021>0x0)return await(0x0,veeva_auth_utils_1[_0x4babc0(0x164)])(this['_connectionVeeva']),await this['validateVpk'](_0xd952f,_0x21b021-0x1);throw new veeva_error_1[(_0x4babc0(0x125))](_0x50b33c[_0x4babc0(0x1a0)]);}}async[a255_0x5f1d5d(0x176)](_0x579f2d,_0x3c114f=0x1){const _0x544402=a255_0x5f1d5d;this['_logger'][_0x544402(0xe5)](_0x544402(0x1a4));const _0x2f0fd3=new form_data_1[(_0x544402(0xe6))]();_0x2f0fd3[_0x544402(0x102)](_0x544402(0x117),(0x0,fs_1[_0x544402(0x19d)])(_0x579f2d));const _0x16c151=await this['_connectionVeeva']['put'](veeva_constants_1['VeevaConstants'][_0x544402(0xed)],_0x2f0fd3,{'headers':{'Content-Type':_0x544402(0x18a)}}),_0x17548c=_0x16c151['data'];if(_0x17548c[_0x544402(0x155)]===status_enums_1[_0x544402(0x16d)]['SUCCESS'])return _0x17548c[_0x544402(0x171)];else{if(_0x3c114f>0x0)return await(0x0,veeva_auth_utils_1[_0x544402(0x164)])(this[_0x544402(0x198)]),await this[_0x544402(0x176)](_0x579f2d,_0x3c114f-0x1);throw new veeva_error_1['VeevaError'](_0x17548c[_0x544402(0x1a0)]);}}async[a255_0x5f1d5d(0x183)](_0x4beb42){const _0x48a99b=a255_0x5f1d5d;this[_0x48a99b(0x184)][_0x48a99b(0xe5)](_0x48a99b(0x192));const _0x327eef=await this['_connectionVeeva'][_0x48a99b(0xfe)](veeva_constants_1[_0x48a99b(0x19f)][_0x48a99b(0x1ae)][_0x48a99b(0x123)](_0x48a99b(0x151),_0x4beb42)),_0x4fa3f1=await _0x327eef['data'];if(_0x4fa3f1[_0x48a99b(0x155)]===status_enums_1[_0x48a99b(0x16d)]['SUCCESS'])return _0x4fa3f1[_0x48a99b(0x171)];else throw new veeva_error_1[(_0x48a99b(0x125))](_0x4fa3f1['errors']);}async['getJobStatus'](_0x51cd7d){const _0x4981c4=a255_0x5f1d5d;this[_0x4981c4(0x184)][_0x4981c4(0xe5)]('Wait\x20Executing\x20job');const _0x5b7df1=new job_result_dto_1[(_0x4981c4(0x119))](),[_0x8ec50e]=await veeva_service_1['VeevaService'][_0x4981c4(0x128)]([_0x51cd7d],this[_0x4981c4(0x198)],this[_0x4981c4(0x184)]);return _0x5b7df1[_0x4981c4(0xf9)]=_0x8ec50e[_0x4981c4(0x111)]===status_enums_1[_0x4981c4(0x1a9)][_0x4981c4(0x181)],_0x5b7df1[_0x4981c4(0x163)]=_0x8ec50e[_0x4981c4(0x170)][_0x4981c4(0x13f)](_0x1f4961=>_0x1f4961['rel']==='artifacts')['href'],_0x5b7df1;}async[a255_0x5f1d5d(0xec)](_0x400adf){const _0xa305b0=a255_0x5f1d5d;this['_logger'][_0xa305b0(0xe5)](_0xa305b0(0xe9));const {data:_0x54a40d}=await this[_0xa305b0(0x198)][_0xa305b0(0x13a)](_0x400adf[_0xa305b0(0x163)]);if(_0x54a40d['responseStatus']===status_enums_1[_0xa305b0(0x16d)]['SUCCESS']){const {log:_0x271288,id:_0x5820d8,package_status:_0x5d3773}=_0x54a40d['vaultPackage'],_0x21d1fa=_0x271288[_0xa305b0(0x139)](_0x17e60e=>_0x17e60e['filename'][_0xa305b0(0xf0)]('Validation.log')),_0x109fe8=await this[_0xa305b0(0x18e)](_0x21d1fa[0x0][_0xa305b0(0x171)]);await this['saveLog'](_0x109fe8,_0xa305b0(0x15a)),_0x400adf[_0xa305b0(0xfd)]=_0x5820d8;if(_0x5d3773!==status_enums_1[_0xa305b0(0x1b1)][_0xa305b0(0x1ac)])throw new Error(_0xa305b0(0x106));}else throw new veeva_error_1[(_0xa305b0(0x125))](_0x54a40d[_0xa305b0(0x1a0)]);}async[a255_0x5f1d5d(0x1b2)](_0x1cbcac){const _0x360a7c=a255_0x5f1d5d;this['_logger'][_0x360a7c(0xe5)](_0x360a7c(0xe1));const {data:_0x339f82}=await this[_0x360a7c(0x198)][_0x360a7c(0x13a)](_0x1cbcac[_0x360a7c(0x163)]);if(_0x339f82['responseStatus']===status_enums_1[_0x360a7c(0x16d)]['SUCCESS']){const {responseDetails:{deployment_log:_0x43376c,package_status__v:_0x3c2c55},package_steps:_0x4e87b0}=_0x339f82,_0x3b3744=_0x43376c[_0x360a7c(0x139)](_0x437b7e=>_0x437b7e[_0x360a7c(0x156)][_0x360a7c(0xf0)](_0x360a7c(0xfa))),_0x4690c7=await this[_0x360a7c(0x18e)](_0x3b3744[0x0][_0x360a7c(0x171)]);await this[_0x360a7c(0xe3)](_0x4690c7,_0x360a7c(0x1a7)),_0x1cbcac[_0x360a7c(0x162)]=[status_enums_1[_0x360a7c(0x1b1)]['DEPLOYED'],status_enums_1[_0x360a7c(0x1b1)][_0x360a7c(0xf1)]][_0x360a7c(0x195)](_0x3c2c55);const _0x541527=this[_0x360a7c(0x124)](_0x4e87b0);_0x1cbcac['packageComponentList']=_0x541527[_0x360a7c(0x139)](_0x5af31f=>_0x5af31f['status']!==status_enums_1[_0x360a7c(0x15c)][_0x360a7c(0x1ac)]);if(!_0x1cbcac[_0x360a7c(0x1a3)][_0x360a7c(0x158)])throw new Error(_0x360a7c(0xee));}else throw new veeva_error_1['VeevaError'](_0x339f82[_0x360a7c(0x1a0)]);}async['getLogResultText'](_0xbba688){const _0x591f15=a255_0x5f1d5d,{data:_0x15cb55}=await this[_0x591f15(0x198)][_0x591f15(0x13a)](_0xbba688,{'responseType':_0x591f15(0x175)});return _0x15cb55;}['formPackageComponentList'](_0x54066f){return _0x54066f['reduce']((_0x21c598,_0x397ad1)=>{const _0x1a1f4d=a255_0x1699,_0x5f0861=_0x397ad1[_0x1a1f4d(0x141)][_0x1a1f4d(0x1ab)](_0x5599e0=>new package_component_dto_1[(_0x1a1f4d(0x186))](_0x5599e0,_0x397ad1['deployment_status__v']));return[..._0x21c598,..._0x5f0861];},[]);}async[a255_0x5f1d5d(0xe3)](_0xe26cf6,_0x1e02aa){const _0x5a9bd7=a255_0x5f1d5d;this[_0x5a9bd7(0x184)]['log'](_0x5a9bd7(0x12e));const _0x3983ed={'Body':Buffer[_0x5a9bd7(0x109)](_0xe26cf6)['toString'](_0x5a9bd7(0x160)),'ContentType':_0x5a9bd7(0x1af),'ParentId':this[_0x5a9bd7(0x148)],'Name':_0x1e02aa},{data:_0xc20614}=await this['_connectionSalesforce']['post'](flosum_constants_1[_0x5a9bd7(0x147)][_0x5a9bd7(0x132)]+_0x5a9bd7(0x14e),_0x3983ed);return _0xc20614['id'];}['formFlosumDeploymentResults'](_0x14eb3c,_0x4c0494){const _0x46c6d2=a255_0x5f1d5d;this[_0x46c6d2(0x184)][_0x46c6d2(0xe5)](_0x46c6d2(0x172));const _0x18c82b=_0x14eb3c[_0x46c6d2(0x146)]((_0x43e536,_0x1b2f4f)=>_0x43e536[_0x46c6d2(0x178)]((_0x1b2f4f[_0x46c6d2(0x10e)]+'.'+_0x1b2f4f[_0x46c6d2(0x10f)])[_0x46c6d2(0x133)](),_0x1b2f4f),new Map());return _0x4c0494[_0x46c6d2(0x1ab)](_0x2d2699=>{const _0x372f85=_0x46c6d2;this['_logger']['log'](_0x2d2699[_0x372f85(0x15e)]+'.'+_0x2d2699[_0x372f85(0x149)]+_0x372f85(0x168)+_0x2d2699['status']);const _0x58beda=(_0x2d2699[_0x372f85(0x15e)]+'.'+_0x2d2699[_0x372f85(0x149)])[_0x372f85(0x133)](),_0x4bc2ea=_0x18c82b[_0x372f85(0x13a)](_0x58beda);return{[constants_1['FLOSUM_NAMESPACE']+_0x372f85(0x185)]:'Deployment\x20Result',[constants_1['FLOSUM_NAMESPACE']+_0x372f85(0xeb)]:_0x2d2699['status']===status_enums_1['PackageComponentStatus'][_0x372f85(0x13b)]?_0x372f85(0x199):_0x372f85(0x105),[constants_1[_0x372f85(0x1a5)]+_0x372f85(0x142)]:_0x372f85(0x165),[constants_1[_0x372f85(0x1a5)]+_0x372f85(0x1a1)]:_0x2d2699[_0x372f85(0x149)],[constants_1['FLOSUM_NAMESPACE']+_0x372f85(0x131)]:_0x2d2699[_0x372f85(0x15e)],[constants_1['FLOSUM_NAMESPACE']+'Org__c']:this[_0x372f85(0xe4)],[constants_1[_0x372f85(0x1a5)]+_0x372f85(0x174)]:this[_0x372f85(0x148)],[constants_1[_0x372f85(0x1a5)]+_0x372f85(0x108)]:_0x4bc2ea[_0x372f85(0x13d)]};});}async[a255_0x5f1d5d(0xdf)](_0x2300c7){const _0x163a1e=a255_0x5f1d5d;this[_0x163a1e(0x184)]['log'](_0x163a1e(0x1ad));const _0x2509a7=await salesforce_service_1[_0x163a1e(0x1bb)]['insertMultipleRecords'](this[_0x163a1e(0x12d)],constants_1[_0x163a1e(0x1a5)]+_0x163a1e(0x134),_0x2300c7),_0x53891d=_0x2509a7[_0x163a1e(0x139)](_0x1be68e=>!_0x1be68e[_0x163a1e(0x144)])['map'](_0x36405e=>_0x36405e[_0x163a1e(0x1a0)])[_0x163a1e(0x1bc)]();if(_0x53891d[_0x163a1e(0x158)])throw new salesforce_dml_error_1[(_0x163a1e(0xe2))](_0x53891d);}async['finishDeployWithError'](_0x570593){const _0x53271a=a255_0x5f1d5d;this[_0x53271a(0x184)][_0x53271a(0x169)](_0x570593),await this['_logger'][_0x53271a(0x140)](),await this[_0x53271a(0x154)](![],!![],'');}async['finishDeploy'](_0x52f87d,_0x7ab202,_0x36758b){const _0x13e702=a255_0x5f1d5d,_0x1dc098=_0x13e702(0x18f)+this['_instanceUrl']+'/'+this[_0x13e702(0x148)]+_0x13e702(0x1a6)+_0x13e702(0x1aa)+'\x20</a>',_0xc6eb17='<a\x20href='+this[_0x13e702(0x150)]+'/'+this[_0x13e702(0xe4)]+'\x20>'+this[_0x13e702(0x16a)]+_0x13e702(0x12b),_0x2e28a5=_0x1dc098+_0x13e702(0xea)+_0xc6eb17+_0x13e702(0x1a2),_0x3ddefe={[constants_1['FLOSUM_NAMESPACE']+_0x13e702(0x15d)]:_0x2e28a5,[constants_1[_0x13e702(0x1a5)]+_0x13e702(0x114)]:new Date(),[constants_1[_0x13e702(0x1a5)]+_0x13e702(0x107)]:this[_0x13e702(0x1b0)],[constants_1[_0x13e702(0x1a5)]+_0x13e702(0x115)]:_0x13e702(0x15f),[constants_1['FLOSUM_NAMESPACE']+_0x13e702(0x188)]:_0x13e702(0x137),[constants_1[_0x13e702(0x1a5)]+'TargetId__c']:this[_0x13e702(0xe4)]},_0x1cb351={[constants_1[_0x13e702(0x1a5)]+_0x13e702(0x1b7)]:!_0x52f87d,[constants_1[_0x13e702(0x1a5)]+_0x13e702(0x153)]:_0x52f87d,[constants_1[_0x13e702(0x1a5)]+_0x13e702(0xeb)]:_0x7ab202?status_enums_1[_0x13e702(0x116)][_0x13e702(0x193)]:status_enums_1[_0x13e702(0x116)]['COMPLETED'],[constants_1[_0x13e702(0x1a5)]+_0x13e702(0x130)]:!![],[constants_1[_0x13e702(0x1a5)]+_0x13e702(0x11f)]:flosum_constants_1[_0x13e702(0x147)][_0x13e702(0x12c)],[constants_1['FLOSUM_NAMESPACE']+'Async_Request_Id__c']:_0x36758b};await this['_connectionSalesforce'][_0x13e702(0xf5)](flosum_constants_1[_0x13e702(0x147)][_0x13e702(0x132)]+'/'+constants_1[_0x13e702(0x1a5)]+_0x13e702(0x138)+this['_metadataLogId'],_0x1cb351),await this['_connectionSalesforce'][_0x13e702(0xfe)](flosum_constants_1[_0x13e702(0x147)]['ENDPOINT_UPSERT_RECORD']+'/'+constants_1[_0x13e702(0x1a5)]+'Log__c',_0x3ddefe),this['_logger']['log'](_0x13e702(0x113)+(_0x52f87d?_0x13e702(0x1b4):'with\x20error')+'.'),await this['_logger']['updateLog']();}}exports['DeployService']=DeployService;