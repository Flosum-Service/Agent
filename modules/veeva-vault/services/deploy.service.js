const a310_0xacff19=a310_0x446b;(function(_0x40a86a,_0x4f42e){const _0x11a542=a310_0x446b,_0x5a53ee=_0x40a86a();while(!![]){try{const _0x226808=-parseInt(_0x11a542(0x186))/0x1+parseInt(_0x11a542(0x138))/0x2*(parseInt(_0x11a542(0x16c))/0x3)+parseInt(_0x11a542(0xdd))/0x4+parseInt(_0x11a542(0x101))/0x5*(-parseInt(_0x11a542(0x18f))/0x6)+parseInt(_0x11a542(0xf4))/0x7*(-parseInt(_0x11a542(0x16f))/0x8)+parseInt(_0x11a542(0xc5))/0x9+parseInt(_0x11a542(0x122))/0xa;if(_0x226808===_0x4f42e)break;else _0x5a53ee['push'](_0x5a53ee['shift']());}catch(_0x5847db){_0x5a53ee['push'](_0x5a53ee['shift']());}}}(a310_0x4f8c,0x1b20e));const a310_0x1dd228=(function(){let _0x8d2ab9=!![];return function(_0x3665c6,_0x29455c){const _0x56068e=_0x8d2ab9?function(){const _0x3b0e70=a310_0x446b;if(_0x29455c){const _0x52d1c6=_0x29455c[_0x3b0e70(0x115)](_0x3665c6,arguments);return _0x29455c=null,_0x52d1c6;}}:function(){};return _0x8d2ab9=![],_0x56068e;};}()),a310_0x4c82e5=a310_0x1dd228(this,function(){const _0x1f792b=a310_0x446b;return a310_0x4c82e5['toString']()[_0x1f792b(0x137)](_0x1f792b(0xdb))[_0x1f792b(0x17d)]()[_0x1f792b(0x16a)](a310_0x4c82e5)['search']('(((.+)+)+)+$');});a310_0x4c82e5();'use strict';function a310_0x4f8c(){const _0x2c565b=['Flosum','href','SUCCESS','endsWith','1155861hQhMyi','../constants/veeva.constants','includes','branchId','</a>','_connectionSalesforce','Component_Type__c','../classes/errors/salesforce-dml-error','FlosumConstants','Activity_Type__c','responseStatus','vaultpackage.xml','_tempFolder','52105McEMhY','slice','success','VeevaPackageStatus','Branch__c','_deploymentName','Date__c','Join\x20all\x20mdl\x20into\x20one\x20zip','getValidationDetailsAndSaveLog','Package\x20not\x20verified','from','Deployment.log','Metadata_Log__c','filename','log','createReadStream','Deployment','_connectionVeeva','Branch__c\x20=\x20\x27','../enums/status.enums','apply','organisationId','_systemLogger','Components__r\x20ORDER\x20BY\x20','../constants/flosum.constants','Wait\x20Executing\x20job','VeevaError','text','../dtos/package-component.dto','files','file','\x20of\x20branch\x20to\x20Organization\x20','toLowerCase','2850030JDunjY','shortid','updateVeevaConnection','name','Get\x20validation\x20details.','isDeployed','base64','Is_Error__c','componentType','retrieveAttachments','Component_Name__c','default','Component_Type__c,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(SELECT\x20Id\x20FROM\x20','Validate\x20package','ENDPOINT_DEPLOY_PACKAGE','writeFile','../classes/errors/veeva-error','Component_Name__c,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Activity_Item__c','organisationName','TargetId__c','search','4DEcjZZ','reduce','../../shared/utils/fetch-attachments','parse','retrieveComponents','veeva-deploy','application/json','DEPLOYED','packageId','PackageComponentDto','xml2js','_organisationId','saveDeploymentResults','Save\x20Deployment\x20Results','patch','deployment_status__v','filter','DEPLOYED_WITH_WARNINGS','https://veevavault.com/','joinAllAttachments','_logger','_branchId','append','Get\x20deploy\x20result','SalesforceService','SalesforceDmlError','Generate\x20vpk\x20package','package_components','<a\x20href=','Body','Validation.log','put','migration__v','get','\x20:\x20','VeevaConstants','MetadataLogStatus','getJobResult','insertMultipleRecords','getJobStatus','Component_History__c','loadAsync','deployPackage','Action__c','Cannot\x20retrieve\x20all\x20attachments','error','ENDPOINT_VALIDATE_PACKAGE','generateAsync','Type__c','string','constructor','Result__c','26397KFFifG','Logger','url','8kEDSNV','/vpk__','content-type','../dtos/job-result.dto','\x20>\x20','generateVPK','retrieveRecords','Veeva\x20Deployment','text/plain','jszip','Import\x20package','_instanceUrl','values','finishDeployWithError','toString','type','PROCESS_DEPLOYMENT','Failure','links','_organisationName','Save\x20log','__importDefault','FLOSUM_NAMESPACE','58276NgkiFn','formFlosumDeploymentResults','../dtos/component.dto','Deploy','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','multipart/form-data','./veeva.service','EXCEPTION','componentName','84Kfivua','componentHistoryId','./salesforce.service','componentIdList','_metadataLogId','_componentIdList','catch','_timeZone','Status__c','successfully','data','detailUrl','getDeployDetailsAndSaveLog','__esModule','ENDPOINT_UPSERT_RECORD','finishDeploy','1211751UPIGlv','form-data','PackageComponentStatus','map','vaultPackage','packageComponentList','Job_Completed__c','formPackageComponentList','updateLog','Deployment\x20Result','artifacts','Cannot\x20retrieve\x20all\x20components.','Deploy\x20Log','Cannot\x20find\x20deployment\x20results','Org__c','ComponentDto','Async_Request_Id__c','null','saveLog','arraybuffer','post','getLogResultText','(((.+)+)+)+$','DeployService','172684ouaMmU','set','Success','Component__c\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20','validateVpk','JobResultDto','../../../core','VeevaResponseStatus','with\x20error','length','COMPLETED','status','\x20</a>','\x20has\x20been\x20created.','importVpk','Version__c\x20DESC\x20LIMIT\x201)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20','timeZone','errors','ENDPOINT_EXPORT_IMPORT_PACKAGE'];a310_0x4f8c=function(){return _0x2c565b;};return a310_0x4f8c();}var __importDefault=this&&this[a310_0xacff19(0x184)]||function(_0x3bcb37){const _0x483d0c=a310_0xacff19;return _0x3bcb37&&_0x3bcb37[_0x483d0c(0xc2)]?_0x3bcb37:{'default':_0x3bcb37};};Object['defineProperty'](exports,a310_0xacff19(0xc2),{'value':!![]}),exports['DeployService']=void 0x0;const jszip_1=__importDefault(require(a310_0xacff19(0x178))),form_data_1=__importDefault(require(a310_0xacff19(0xc6))),fs_1=require('fs'),promises_1=require('fs/promises'),constants_1=require('../../../constants'),flosum_constants_1=require(a310_0xacff19(0x119)),veeva_constants_1=require(a310_0xacff19(0xf5)),veeva_service_1=require(a310_0xacff19(0x18c)),component_dto_1=require(a310_0xacff19(0x188)),job_result_dto_1=require(a310_0xacff19(0x172)),package_component_dto_1=require(a310_0xacff19(0x11d)),salesforce_service_1=require(a310_0xacff19(0xb7)),core_1=require(a310_0xacff19(0xe3)),status_enums_1=require(a310_0xacff19(0x114)),salesforce_dml_error_1=require(a310_0xacff19(0xfb)),veeva_error_1=require(a310_0xacff19(0x132)),shortid_1=__importDefault(require(a310_0xacff19(0x123))),veeva_auth_utils_1=require('../utils/veeva-auth.utils'),xml2js_1=require(a310_0xacff19(0x142)),fetch_attachments_1=require(a310_0xacff19(0x13a));function a310_0x446b(_0x3d8f27,_0x20f7ac){const _0x238d65=a310_0x4f8c();return a310_0x446b=function(_0x4c82e5,_0x1dd228){_0x4c82e5=_0x4c82e5-0xb6;let _0x4f8c1f=_0x238d65[_0x4c82e5];return _0x4f8c1f;},a310_0x446b(_0x3d8f27,_0x20f7ac);}class DeployService{constructor(_0x5f264e,_0x9e30a1,_0x454573,_0x3a24f1,_0x15ffb4,_0x254426){const _0x391bec=a310_0xacff19;this[_0x391bec(0xf9)]=_0x9e30a1,this['_connectionVeeva']=_0x454573,this[_0x391bec(0x14c)]=_0x3a24f1,this[_0x391bec(0x100)]=_0x15ffb4,this[_0x391bec(0x17a)]=_0x254426,this[_0x391bec(0x14d)]=_0x5f264e[_0x391bec(0xf7)],this[_0x391bec(0xb9)]=_0x5f264e['metadataLogId'],this['_attachmentLogId']=_0x5f264e['attachmentLogId'],this[_0x391bec(0x143)]=_0x5f264e[_0x391bec(0x116)],this[_0x391bec(0xbc)]=_0x5f264e[_0x391bec(0xed)],this[_0x391bec(0x182)]=_0x5f264e[_0x391bec(0x135)],this[_0x391bec(0xba)]=_0x5f264e[_0x391bec(0xb8)],this['_deploymentName']=_0x5f264e['deploymentName'],this[_0x391bec(0x117)]=new core_1[(_0x391bec(0x16d))](_0x391bec(0x13d));}async['execute'](){const _0x2bfb0f=a310_0xacff19;try{const _0x461fed=await this[_0x2bfb0f(0x13c)](),_0x465f67=await this['retrieveAttachments'](_0x461fed),_0xfa91a=await this[_0x2bfb0f(0x14b)](_0x465f67),_0x3d1810=await this[_0x2bfb0f(0x174)](_0xfa91a);await this[_0x2bfb0f(0xe1)](_0x3d1810);const _0x309604=await this[_0x2bfb0f(0xeb)](_0x3d1810),_0x2f92f5=await this[_0x2bfb0f(0x15f)](_0x309604);await this[_0x2bfb0f(0x109)](_0x2f92f5);const _0x39010f=await this[_0x2bfb0f(0x162)](_0x2f92f5[_0x2bfb0f(0x140)]),_0x3721d7=await this[_0x2bfb0f(0x15f)](_0x39010f);await this[_0x2bfb0f(0xc1)](_0x3721d7);const _0x3ef69b=this[_0x2bfb0f(0x187)](_0x461fed,_0x3721d7[_0x2bfb0f(0xca)]);await this[_0x2bfb0f(0x144)](_0x3ef69b),await this[_0x2bfb0f(0xc4)](_0x3721d7['isDeployed'],![],_0x2f92f5['packageId']);}catch(_0x574718){await this[_0x2bfb0f(0x17c)](_0x574718)[_0x2bfb0f(0xbb)](_0x2e1787=>this['_systemLogger'][_0x2bfb0f(0x165)](_0x2e1787));}}async[a310_0xacff19(0x13c)](){const _0x2c3615=a310_0xacff19,_0x4476f8=new Set(this[_0x2c3615(0xba)]);this[_0x2c3615(0x14c)][_0x2c3615(0x10f)]('Retrieving\x20components');const _0x3ad86a=_0x2c3615(0x18a)+constants_1[_0x2c3615(0x185)]+_0x2c3615(0x133)+constants_1[_0x2c3615(0x185)]+_0x2c3615(0x12e)+constants_1['FLOSUM_NAMESPACE']+_0x2c3615(0x118)+constants_1[_0x2c3615(0x185)]+_0x2c3615(0xec)+constants_1[_0x2c3615(0x185)]+_0x2c3615(0xe0)+constants_1[_0x2c3615(0x185)]+_0x2c3615(0x113)+this[_0x2c3615(0x14d)]+'\x27',_0x4c8e2d=await salesforce_service_1['SalesforceService'][_0x2c3615(0x175)](this[_0x2c3615(0xf9)],_0x3ad86a);if(!_0x4c8e2d[_0x2c3615(0xe6)])throw new Error(_0x2c3615(0xd0));const _0x531c50=_0x4c8e2d[_0x2c3615(0xc8)](_0x279d54=>new component_dto_1[(_0x2c3615(0xd4))](_0x279d54))['filter'](_0x4ab452=>_0x4476f8['has'](_0x4ab452['id']));if(_0x531c50[_0x2c3615(0xe6)]!==this['_componentIdList']['length'])throw new Error('Cannot\x20retrieve\x20all\x20components.');return _0x531c50;}async[a310_0xacff19(0x12b)](_0x2ae494){const _0x1e995d=a310_0xacff19;this[_0x1e995d(0x14c)][_0x1e995d(0x10f)]('Retrieving\x20attachments');const _0x314a8a=await(0x0,fetch_attachments_1['fetchAttachmentsDetailsByParentId'])(this[_0x1e995d(0xf9)],_0x2ae494[_0x1e995d(0xc8)](_0x21e713=>_0x21e713[_0x1e995d(0xb6)])),_0xc94054=await(0x0,fetch_attachments_1[_0x1e995d(0x12b)])(_0x314a8a,this[_0x1e995d(0xf9)]);if(_0xc94054[_0x1e995d(0xe6)]!==this['_componentIdList'][_0x1e995d(0xe6)])throw new Error(_0x1e995d(0x164));return _0xc94054[_0x1e995d(0xc8)](_0x4ff6f6=>_0x4ff6f6[_0x1e995d(0x17b)][_0x1e995d(0x155)]);}async['joinAllAttachments'](_0x550e88){const _0xd11f8f=a310_0xacff19;var _0xb2ef42;this[_0xd11f8f(0x14c)][_0xd11f8f(0x10f)](_0xd11f8f(0x108));const _0x3a43c7=new jszip_1[(_0xd11f8f(0x12d))]();for(const _0x2ea420 of _0x550e88){const _0x9ce910=new jszip_1[(_0xd11f8f(0x12d))]();await _0x9ce910[_0xd11f8f(0x161)](_0x2ea420,{'base64':!![]});for(const _0x55c41b in _0x9ce910[_0xd11f8f(0x11e)]){const _0x4ac147=await((_0xb2ef42=_0x9ce910[_0xd11f8f(0x11f)](_0x55c41b))===null||_0xb2ef42===void 0x0?void 0x0:_0xb2ef42['async'](_0xd11f8f(0x169)));_0x4ac147&&_0x3a43c7[_0xd11f8f(0x11f)](_0x55c41b,_0x4ac147);}}const _0x352ddc=new xml2js_1['Builder']({'headless':!![]}),_0x1c4afa={'vaultpackage':{'$':{'xmlns':_0xd11f8f(0x14a)},'name':this[_0xd11f8f(0x106)],'source':{'vault':undefined,'author':_0xd11f8f(0xf0)},'packagetype':_0xd11f8f(0x158),'summary':_0xd11f8f(0x189),'description':_0xd11f8f(0xd6)}};_0x3a43c7[_0xd11f8f(0x11f)](_0xd11f8f(0xff),_0x352ddc['buildObject'](_0x1c4afa));const _0x3be2bf=this[_0xd11f8f(0x100)]+'/'+(0x0,shortid_1[_0xd11f8f(0x12d)])()+'.zip',_0x3c9b16=await _0x3a43c7[_0xd11f8f(0x167)]({'type':'nodebuffer'});return await(0x0,promises_1[_0xd11f8f(0x131)])(_0x3be2bf,_0x3c9b16),_0x3be2bf;}async[a310_0xacff19(0x174)](_0x5df770,_0x2db46b=0x1){const _0x387e32=a310_0xacff19;var _0x1fb6d7;this[_0x387e32(0x14c)][_0x387e32(0x10f)](_0x387e32(0x152));const _0x571f17=new form_data_1[(_0x387e32(0x12d))]();_0x571f17[_0x387e32(0x14e)](_0x387e32(0x11f),(0x0,fs_1['createReadStream'])(_0x5df770));const _0x5f3bbb=await this['_connectionVeeva'][_0x387e32(0xd9)](veeva_constants_1['VeevaConstants'][_0x387e32(0xef)],_0x571f17,{'responseType':_0x387e32(0xd8),'headers':{'Content-Type':'multipart/form-data'}}),_0x20260f=(_0x1fb6d7=_0x5f3bbb['headers'][_0x387e32(0x171)])===null||_0x1fb6d7===void 0x0?void 0x0:_0x1fb6d7[_0x387e32(0xf6)](_0x387e32(0x13e));if(!_0x20260f){const _0xf120af=_0x5f3bbb[_0x387e32(0xbf)],_0x5b9610=this[_0x387e32(0x100)]+_0x387e32(0x170)+_0x5df770[_0x387e32(0x102)](_0x5df770['lastIndexOf']('/')+0x1);return await(0x0,promises_1['writeFile'])(_0x5b9610,_0xf120af),_0x5b9610;}else{const _0x5f4424=JSON[_0x387e32(0x13b)](_0x5f3bbb[_0x387e32(0xbf)]);if(_0x2db46b>0x0)return await(0x0,veeva_auth_utils_1[_0x387e32(0x124)])(this[_0x387e32(0x112)]),await this['generateVPK'](_0x5df770,_0x2db46b-0x1);throw new veeva_error_1[(_0x387e32(0x11b))](_0x5f4424[_0x387e32(0xee)]);}}async[a310_0xacff19(0xe1)](_0x473b79,_0x403720=0x1){const _0x1c6e25=a310_0xacff19;this[_0x1c6e25(0x14c)][_0x1c6e25(0x10f)](_0x1c6e25(0x12f));const _0x34d629=new form_data_1[(_0x1c6e25(0x12d))]();_0x34d629[_0x1c6e25(0x14e)]('file',(0x0,fs_1[_0x1c6e25(0x110)])(_0x473b79));const _0x3b4379=await this[_0x1c6e25(0x112)][_0x1c6e25(0xd9)](veeva_constants_1[_0x1c6e25(0x15b)][_0x1c6e25(0x166)],_0x34d629,{'headers':{'Content-Type':_0x1c6e25(0x18b)}}),_0x4abffb=_0x3b4379[_0x1c6e25(0xbf)];if(_0x4abffb['responseStatus']===status_enums_1[_0x1c6e25(0xe4)][_0x1c6e25(0xf2)])return _0x4abffb;else{if(_0x403720>0x0)return await(0x0,veeva_auth_utils_1[_0x1c6e25(0x124)])(this[_0x1c6e25(0x112)]),await this[_0x1c6e25(0xe1)](_0x473b79,_0x403720-0x1);throw new veeva_error_1[(_0x1c6e25(0x11b))](_0x4abffb['errors']);}}async[a310_0xacff19(0xeb)](_0x4d2759,_0x3652d4=0x1){const _0x1b9fc6=a310_0xacff19;this[_0x1b9fc6(0x14c)][_0x1b9fc6(0x10f)](_0x1b9fc6(0x179));const _0x33d304=new form_data_1['default']();_0x33d304['append']('file',(0x0,fs_1[_0x1b9fc6(0x110)])(_0x4d2759));const _0x2bdd8e=await this[_0x1b9fc6(0x112)][_0x1b9fc6(0x157)](veeva_constants_1[_0x1b9fc6(0x15b)][_0x1b9fc6(0xef)],_0x33d304,{'headers':{'Content-Type':_0x1b9fc6(0x18b)}}),_0x3101f4=_0x2bdd8e[_0x1b9fc6(0xbf)];if(_0x3101f4[_0x1b9fc6(0xfe)]===status_enums_1['VeevaResponseStatus'][_0x1b9fc6(0xf2)])return _0x3101f4[_0x1b9fc6(0x16e)];else{if(_0x3652d4>0x0)return await(0x0,veeva_auth_utils_1['updateVeevaConnection'])(this[_0x1b9fc6(0x112)]),await this['importVpk'](_0x4d2759,_0x3652d4-0x1);throw new veeva_error_1[(_0x1b9fc6(0x11b))](_0x3101f4[_0x1b9fc6(0xee)]);}}async['deployPackage'](_0x23f18c){const _0x4fff0c=a310_0xacff19;this[_0x4fff0c(0x14c)][_0x4fff0c(0x10f)]('Deploy\x20package');const _0x44540c=await this['_connectionVeeva'][_0x4fff0c(0xd9)](veeva_constants_1['VeevaConstants'][_0x4fff0c(0x130)]['replace']('{package_id}',_0x23f18c)),_0x480051=await _0x44540c[_0x4fff0c(0xbf)];if(_0x480051[_0x4fff0c(0xfe)]===status_enums_1[_0x4fff0c(0xe4)][_0x4fff0c(0xf2)])return _0x480051[_0x4fff0c(0x16e)];else throw new veeva_error_1[(_0x4fff0c(0x11b))](_0x480051[_0x4fff0c(0xee)]);}async[a310_0xacff19(0x15f)](_0x383f6e){const _0x4c2d36=a310_0xacff19;this[_0x4c2d36(0x14c)][_0x4c2d36(0x10f)](_0x4c2d36(0x11a));const _0x51fddd=new job_result_dto_1[(_0x4c2d36(0xe2))](),[_0x3fdb38]=await veeva_service_1['VeevaService'][_0x4c2d36(0x15d)]([_0x383f6e],this[_0x4c2d36(0x112)],this[_0x4c2d36(0x14c)]);return _0x51fddd['isSuccess']=_0x3fdb38[_0x4c2d36(0xe8)]===status_enums_1['VeevaJobStatus'][_0x4c2d36(0xf2)],_0x51fddd[_0x4c2d36(0xc0)]=_0x3fdb38[_0x4c2d36(0x181)]['find'](_0x3b00b0=>_0x3b00b0['rel']===_0x4c2d36(0xcf))[_0x4c2d36(0xf1)],_0x51fddd;}async['getValidationDetailsAndSaveLog'](_0x12dfd3){const _0x26f991=a310_0xacff19;this[_0x26f991(0x14c)][_0x26f991(0x10f)](_0x26f991(0x126));const {data:_0x6926af}=await this[_0x26f991(0x112)]['get'](_0x12dfd3['detailUrl']);if(_0x6926af['responseStatus']===status_enums_1['VeevaResponseStatus'][_0x26f991(0xf2)]){const {log:_0x18183b,id:_0x26738a,package_status:_0xcd9416}=_0x6926af[_0x26f991(0xc9)],_0x45ce6a=_0x18183b['filter'](_0x2021e0=>_0x2021e0[_0x26f991(0x10e)]['endsWith'](_0x26f991(0x156))),_0x2ef806=await this['getLogResultText'](_0x45ce6a[0x0][_0x26f991(0x16e)]);await this['saveLog'](_0x2ef806,'Validation\x20Log'),_0x12dfd3[_0x26f991(0x140)]=_0x26738a;if(_0xcd9416!==status_enums_1[_0x26f991(0x104)]['VERIFIED'])throw new Error(_0x26f991(0x10a));}else throw new veeva_error_1['VeevaError'](_0x6926af[_0x26f991(0xee)]);}async[a310_0xacff19(0xc1)](_0x40c821){const _0x5c6fd5=a310_0xacff19;this[_0x5c6fd5(0x14c)][_0x5c6fd5(0x10f)](_0x5c6fd5(0x14f));const {data:_0x5dbc5b}=await this['_connectionVeeva'][_0x5c6fd5(0x159)](_0x40c821[_0x5c6fd5(0xc0)]);if(_0x5dbc5b['responseStatus']===status_enums_1['VeevaResponseStatus'][_0x5c6fd5(0xf2)]){const {responseDetails:{deployment_log:_0x2abd44,package_status__v:_0x4678db},package_steps:_0x10d3be}=_0x5dbc5b,_0x5d349b=_0x2abd44[_0x5c6fd5(0x148)](_0x137771=>_0x137771[_0x5c6fd5(0x10e)][_0x5c6fd5(0xf3)](_0x5c6fd5(0x10c))),_0x3e60fa=await this[_0x5c6fd5(0xda)](_0x5d349b[0x0][_0x5c6fd5(0x16e)]);await this[_0x5c6fd5(0xd7)](_0x3e60fa,_0x5c6fd5(0xd1)),_0x40c821[_0x5c6fd5(0x127)]=[status_enums_1[_0x5c6fd5(0x104)][_0x5c6fd5(0x13f)],status_enums_1[_0x5c6fd5(0x104)][_0x5c6fd5(0x149)]]['includes'](_0x4678db);const _0x4f4382=this[_0x5c6fd5(0xcc)](_0x10d3be);_0x40c821[_0x5c6fd5(0xca)]=_0x4f4382[_0x5c6fd5(0x148)](_0x2d99a3=>_0x2d99a3['status']!==status_enums_1[_0x5c6fd5(0xc7)]['VERIFIED']);if(!_0x40c821[_0x5c6fd5(0xca)][_0x5c6fd5(0xe6)])throw new Error(_0x5c6fd5(0xd2));}else throw new veeva_error_1['VeevaError'](_0x5dbc5b[_0x5c6fd5(0xee)]);}async[a310_0xacff19(0xda)](_0x1d72bb){const _0x577ea7=a310_0xacff19,{data:_0x29776b}=await this['_connectionVeeva']['get'](_0x1d72bb,{'responseType':_0x577ea7(0x11c)});return _0x29776b;}[a310_0xacff19(0xcc)](_0x280c2f){return _0x280c2f['reduce']((_0x19f5ac,_0x5ad1de)=>{const _0x55194b=a310_0x446b,_0x3823ac=_0x5ad1de[_0x55194b(0x153)][_0x55194b(0xc8)](_0x25925d=>new package_component_dto_1[(_0x55194b(0x141))](_0x25925d,_0x5ad1de[_0x55194b(0x147)]));return[..._0x19f5ac,..._0x3823ac];},[]);}async['saveLog'](_0x9f3cec,_0x2ce496){const _0x2172e4=a310_0xacff19;this[_0x2172e4(0x14c)][_0x2172e4(0x10f)](_0x2172e4(0x183));const _0x1fe0cd={'Body':Buffer[_0x2172e4(0x10b)](_0x9f3cec)[_0x2172e4(0x17d)](_0x2172e4(0x128)),'ContentType':_0x2172e4(0x177),'ParentId':this[_0x2172e4(0xb9)],'Name':_0x2ce496},{data:_0x42f317}=await this[_0x2172e4(0xf9)][_0x2172e4(0xd9)](flosum_constants_1[_0x2172e4(0xfc)][_0x2172e4(0xc3)]+'/Attachment',_0x1fe0cd);return _0x42f317['id'];}[a310_0xacff19(0x187)](_0xc0210b,_0x5c5e2c){const _0x53f61e=a310_0xacff19;this['_logger'][_0x53f61e(0x10f)]('Form\x20Deployment\x20Results');const _0x7c7b45=_0xc0210b[_0x53f61e(0x139)]((_0x3ca524,_0x4a9e89)=>_0x3ca524[_0x53f61e(0xde)]((_0x4a9e89[_0x53f61e(0x12a)]+'.'+_0x4a9e89[_0x53f61e(0x18e)])[_0x53f61e(0x121)](),_0x4a9e89),new Map());return _0x5c5e2c[_0x53f61e(0xc8)](_0x146fec=>{const _0x5467de=_0x53f61e;this['_logger'][_0x5467de(0x10f)](_0x146fec[_0x5467de(0x17e)]+'.'+_0x146fec['name']+_0x5467de(0x15a)+_0x146fec[_0x5467de(0xe8)]);const _0x3b3717=(_0x146fec[_0x5467de(0x17e)]+'.'+_0x146fec['name'])[_0x5467de(0x121)](),_0x3414ee=_0x7c7b45[_0x5467de(0x159)](_0x3b3717);return{[constants_1[_0x5467de(0x185)]+_0x5467de(0x168)]:_0x5467de(0xce),[constants_1[_0x5467de(0x185)]+_0x5467de(0xbd)]:_0x146fec[_0x5467de(0xe8)]===status_enums_1['PackageComponentStatus'][_0x5467de(0x13f)]?_0x5467de(0xdf):_0x5467de(0x180),[constants_1[_0x5467de(0x185)]+_0x5467de(0x16b)]:'RECREATE',[constants_1['FLOSUM_NAMESPACE']+_0x5467de(0x12c)]:_0x146fec[_0x5467de(0x125)],[constants_1[_0x5467de(0x185)]+_0x5467de(0xfa)]:_0x146fec[_0x5467de(0x17e)],[constants_1[_0x5467de(0x185)]+_0x5467de(0xd3)]:this[_0x5467de(0x143)],[constants_1[_0x5467de(0x185)]+_0x5467de(0x10d)]:this['_metadataLogId'],[constants_1[_0x5467de(0x185)]+_0x5467de(0x160)]:_0x3414ee[_0x5467de(0xb6)]};});}async[a310_0xacff19(0x144)](_0x55550a){const _0x6c1c8f=a310_0xacff19;this['_logger']['log'](_0x6c1c8f(0x145));const _0x3d4347=await salesforce_service_1[_0x6c1c8f(0x150)][_0x6c1c8f(0x15e)](this[_0x6c1c8f(0xf9)],constants_1[_0x6c1c8f(0x185)]+'Deployment_Result__c',_0x55550a),_0xa93ee1=_0x3d4347[_0x6c1c8f(0x148)](_0x12ade1=>!_0x12ade1[_0x6c1c8f(0x103)])['map'](_0x1bad8d=>_0x1bad8d[_0x6c1c8f(0xee)])['flat']();if(_0xa93ee1[_0x6c1c8f(0xe6)])throw new salesforce_dml_error_1[(_0x6c1c8f(0x151))](_0xa93ee1);}async[a310_0xacff19(0x17c)](_0xf008a3){const _0x32145e=a310_0xacff19;this[_0x32145e(0x14c)]['logError'](_0xf008a3),await this[_0x32145e(0x14c)][_0x32145e(0xcd)](),await this[_0x32145e(0xc4)](![],!![],'');}async[a310_0xacff19(0xc4)](_0x5e6802,_0x35afbf,_0x302d54){const _0x19bb62=a310_0xacff19,_0x35f2b3='<a\x20href='+this[_0x19bb62(0x17a)]+'/'+this[_0x19bb62(0xb9)]+_0x19bb62(0x173)+_0x19bb62(0x176)+_0x19bb62(0xe9),_0x4b992f=_0x19bb62(0x154)+this['_instanceUrl']+'/'+this[_0x19bb62(0x143)]+'\x20>'+this[_0x19bb62(0x182)]+_0x19bb62(0xf8),_0x1df5ba=_0x35f2b3+_0x19bb62(0x120)+_0x4b992f+_0x19bb62(0xea),_0x1b707b={[constants_1[_0x19bb62(0x185)]+_0x19bb62(0x163)]:_0x1df5ba,[constants_1['FLOSUM_NAMESPACE']+_0x19bb62(0x107)]:new Date(),[constants_1[_0x19bb62(0x185)]+_0x19bb62(0x105)]:this[_0x19bb62(0x14d)],[constants_1['FLOSUM_NAMESPACE']+_0x19bb62(0x134)]:'Branch',[constants_1[_0x19bb62(0x185)]+_0x19bb62(0xfd)]:_0x19bb62(0x111),[constants_1[_0x19bb62(0x185)]+_0x19bb62(0x136)]:this[_0x19bb62(0x143)]},_0x358d78={[constants_1[_0x19bb62(0x185)]+_0x19bb62(0x129)]:!_0x5e6802,[constants_1[_0x19bb62(0x185)]+'Succeed__c']:_0x5e6802,[constants_1['FLOSUM_NAMESPACE']+_0x19bb62(0xbd)]:_0x35afbf?status_enums_1[_0x19bb62(0x15c)][_0x19bb62(0x18d)]:status_enums_1[_0x19bb62(0x15c)][_0x19bb62(0xe7)],[constants_1[_0x19bb62(0x185)]+_0x19bb62(0xcb)]:!![],[constants_1['FLOSUM_NAMESPACE']+'Process_Type__c']:flosum_constants_1[_0x19bb62(0xfc)][_0x19bb62(0x17f)],[constants_1[_0x19bb62(0x185)]+_0x19bb62(0xd5)]:_0x302d54};await this[_0x19bb62(0xf9)][_0x19bb62(0x146)](flosum_constants_1[_0x19bb62(0xfc)][_0x19bb62(0xc3)]+'/'+constants_1[_0x19bb62(0x185)]+'Metadata_Log__c/'+this['_metadataLogId'],_0x358d78),await this['_connectionSalesforce'][_0x19bb62(0xd9)](flosum_constants_1[_0x19bb62(0xfc)][_0x19bb62(0xc3)]+'/'+constants_1['FLOSUM_NAMESPACE']+'Log__c',_0x1b707b),this[_0x19bb62(0x14c)][_0x19bb62(0x10f)]('Deploy\x20completed\x20'+(_0x5e6802?_0x19bb62(0xbe):_0x19bb62(0xe5))+'.'),await this[_0x19bb62(0x14c)]['updateLog']();}}exports[a310_0xacff19(0xdc)]=DeployService;