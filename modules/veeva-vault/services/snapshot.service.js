const a312_0x1b9163=a312_0xc53f;function a312_0x1128(){const _0x570ae4=['Last_Modified_Date__c','Cannot\x20Save\x20Metadata\x20Items','../enums/status.enums','type','SUCCESS','rel','formMetadataItemDtoList','_snapshotId','Attachment_ID__c','deleteOutboundPackages','apply','createVeevaObjectRecords','Create\x20Export\x20outbound\x20packages.','ENDPOINT_CREATE_RECORDS','\x20Metadata\x20Items','forEach','success','getComponentsMetadataByTypes','Veeva_Component_Type__c','responseStatus','snapshotId','finishSnapshot','veevaComponentType','length','_connectionVeeva','logError','join','Removing\x20components\x20from\x20outbound\x20packages.','map','lastModifiedDate','66yageoT','ENDPOINT_VQL','SalesforceService','getJobResult','links','reduce','ATTACMENT','values','insertMultipleRecords','_logger','MetadataItemDto','getComponentsMetadataByTypeAndName','push','Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20','Metadata_Log__c/','apiName','Is_Error__c','_timeZone','timeZone','Is_Retrieved__c','post','EXCEPTION','successfully','href','../../shared/utils','deleteVeevaObjectRecords','from','\x27\x20AND\x20component_name__v\x20CONTAINS\x20(\x27','createOutboundPackages','./veeva.service','Saving\x20','1257445gDFMSV','./salesforce.service','20qEKjjB','createMetadataItemListWithBody','OUTBOUND_PACKAGE_NAME','ENDPOINT_EXPORT_IMPORT_PACKAGE','createPackageComponents','Snapshot\x20completed\x20','Retrieve\x20collection\x20metadata\x20of\x20components\x20by\x20type\x20and\x20names','VeevaError','VeevaService','inactive__v','package_component__v','11213hZiMqI','packageName','3451032bmXsVx','attachmentId','149955EqrpIA','isRetrieved','3964716sghjaS','label','API_Name__c','Attachment','errors','selectedComponentMap','migration__sys','Getting\x20names\x20of\x20outbound\x20packages','VeevaComponentDto','Status__c','with\x20error','Deleting\x20outbound\x20packages.','MetadataLogStatus','get','__esModule','\x27,\x27','_systemLogger','exportOutboundPackage','outbound_package__v','arraybuffer','MAXIMUM_SIZE_OF_PACKAGE','defineProperty','../constants/veeva.constants','_connectionSalesforce','SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20=\x27','loadAsync','jszip','file','2kwFWsM','log','_selectedComponentMap','Adding\x20components\x20to\x20outbound\x20package','VeevaConstants','Job_Completed__c','deletePackageComponents','Retrieve\x20Jobs\x20Status','FLOSUM_NAMESPACE','Is_Completed__c','.mdl','Snapshot__c/','set','1621290oBvaYg','Name__c','_attachmentLogId','_metadataLogId','default','application/zip','formAttachments','updateLog','Retrieve\x20collection\x20metadata\x20of\x20components','parse','executeManyVQL','application/json','SnapshotService','executeVQL','body','name','saveAttachments','../../../constants','Snapshot__c','../dtos/veeva-component.dto','../classes/errors/salesforce-dml-error','Cannot\x20retrieve\x20','FlosumConstants','Creating\x20outbound\x20packages','ENDPOINT_UPSERT_RECORD','toString','search','execute','276535hJoTPg','constructor','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20CONTAINS\x20(\x27','(((.+)+)+)+$','getPackageNames','createExportOutboundPackages','catch','filter','Label__c','COMPLETED','saveComponentsInSalesforce','Unpack\x20zip\x20and\x20create\x20metadata\x20items.','includes','Retrieve\x20Outbound\x20Package\x20zip\x20list','artifacts','BUILD_WHERE_BY_NAME_LIMIT','_selectedMetaTypes','getEndpointArtifactList','selectedMetaTypes','retrieveVPKList','metadataLogId'];a312_0x1128=function(){return _0x570ae4;};return a312_0x1128();}(function(_0x34b739,_0x2af2a1){const _0x558a02=a312_0xc53f,_0x51f964=_0x34b739();while(!![]){try{const _0x359314=-parseInt(_0x558a02(0x1d3))/0x1*(-parseInt(_0x558a02(0x1f5))/0x2)+-parseInt(_0x558a02(0x1d7))/0x3*(-parseInt(_0x558a02(0x1c8))/0x4)+parseInt(_0x558a02(0x1c6))/0x5+-parseInt(_0x558a02(0x251))/0x6*(parseInt(_0x558a02(0x21e))/0x7)+parseInt(_0x558a02(0x1d5))/0x8+-parseInt(_0x558a02(0x1d9))/0x9+parseInt(_0x558a02(0x202))/0xa;if(_0x359314===_0x2af2a1)break;else _0x51f964['push'](_0x51f964['shift']());}catch(_0x2b21aa){_0x51f964['push'](_0x51f964['shift']());}}}(a312_0x1128,0x38690));const a312_0x292055=(function(){let _0x39f9f9=!![];return function(_0x3450ba,_0x7b2835){const _0x22e7e2=_0x39f9f9?function(){const _0x1b4cc2=a312_0xc53f;if(_0x7b2835){const _0x4b6d9c=_0x7b2835[_0x1b4cc2(0x23d)](_0x3450ba,arguments);return _0x7b2835=null,_0x4b6d9c;}}:function(){};return _0x39f9f9=![],_0x22e7e2;};}()),a312_0x5e2b7d=a312_0x292055(this,function(){const _0x5a2b6f=a312_0xc53f;return a312_0x5e2b7d['toString']()[_0x5a2b6f(0x21c)](_0x5a2b6f(0x221))[_0x5a2b6f(0x21b)]()[_0x5a2b6f(0x21f)](a312_0x5e2b7d)[_0x5a2b6f(0x21c)](_0x5a2b6f(0x221));});a312_0x5e2b7d();'use strict';function a312_0xc53f(_0x44db39,_0x43a4ca){const _0xd50669=a312_0x1128();return a312_0xc53f=function(_0x5e2b7d,_0x292055){_0x5e2b7d=_0x5e2b7d-0x1b8;let _0x1128b2=_0xd50669[_0x5e2b7d];return _0x1128b2;},a312_0xc53f(_0x44db39,_0x43a4ca);}var __importDefault=this&&this['__importDefault']||function(_0x48ff9e){return _0x48ff9e&&_0x48ff9e['__esModule']?_0x48ff9e:{'default':_0x48ff9e};};Object[a312_0x1b9163(0x1ee)](exports,a312_0x1b9163(0x1e7),{'value':!![]}),exports[a312_0x1b9163(0x20e)]=void 0x0;const jszip_1=__importDefault(require(a312_0x1b9163(0x1f3))),flosum_constants_1=require('../constants/flosum.constants'),veeva_constants_1=require(a312_0x1b9163(0x1ef)),veeva_service_1=require(a312_0x1b9163(0x1c4)),veeva_component_dto_1=require(a312_0x1b9163(0x215)),metadata_item_dto_1=require('../dtos/metadata-item.dto'),utils_1=require(a312_0x1b9163(0x1bf)),constants_1=require(a312_0x1b9163(0x213)),salesforce_service_1=require(a312_0x1b9163(0x1c7)),status_enums_1=require(a312_0x1b9163(0x235)),salesforce_dml_error_1=require(a312_0x1b9163(0x216)),veeva_error_1=require('../classes/errors/veeva-error');class SnapshotService{constructor(_0x353a84,_0x57e474,_0x3d151d,_0x1d9b36){const _0x29c577=a312_0x1b9163;this[_0x29c577(0x1f0)]=_0x57e474,this[_0x29c577(0x24b)]=_0x3d151d,this[_0x29c577(0x25a)]=_0x1d9b36,this[_0x29c577(0x23a)]=_0x353a84[_0x29c577(0x247)],this[_0x29c577(0x205)]=_0x353a84[_0x29c577(0x232)],this[_0x29c577(0x204)]=_0x353a84['attachmentLogId'],this[_0x29c577(0x1b8)]=_0x353a84[_0x29c577(0x1b9)],this[_0x29c577(0x22e)]=_0x353a84[_0x29c577(0x230)],this[_0x29c577(0x1f7)]=_0x353a84[_0x29c577(0x1de)];}async[a312_0x1b9163(0x21d)](){const _0x135c67=a312_0x1b9163;try{this[_0x135c67(0x25a)]['log']('Snapshot\x20started.');const _0x1483bf=Array[_0x135c67(0x1c1)](Object[_0x135c67(0x258)](this[_0x135c67(0x1f7)]))[_0x135c67(0x24a)]?await this[_0x135c67(0x25c)]():await this[_0x135c67(0x244)]();await this[_0x135c67(0x25a)][_0x135c67(0x209)]();const _0x7cea4b=await this[_0x135c67(0x1c3)](Math['ceil'](_0x1483bf['length']/veeva_constants_1['VeevaConstants'][_0x135c67(0x1ed)])),_0x38c1a6=await this[_0x135c67(0x1cc)](_0x1483bf,_0x7cea4b);await this['_logger'][_0x135c67(0x209)]();const _0x144b67=await this[_0x135c67(0x1ea)](_0x7cea4b),_0x269691=await this[_0x135c67(0x1c9)](_0x1483bf,_0x144b67);await this['saveComponentsInSalesforce'](_0x269691),await this[_0x135c67(0x25a)]['updateLog'](),await this[_0x135c67(0x1fb)](_0x38c1a6),await this[_0x135c67(0x23c)](_0x7cea4b),await this['finishSnapshot'](!![]);}catch(_0x244f02){this[_0x135c67(0x25a)][_0x135c67(0x24c)](_0x244f02),await this[_0x135c67(0x248)](![])[_0x135c67(0x224)](_0x26d25e=>this[_0x135c67(0x1e9)]['error'](_0x26d25e));}}async[a312_0x1b9163(0x244)](){const _0x465f74=a312_0x1b9163;this[_0x465f74(0x25a)][_0x465f74(0x1f6)](_0x465f74(0x20a));const _0x10c0c2=[],_0x39a1ee=_0x465f74(0x220)+this[_0x465f74(0x22e)]['join'](_0x465f74(0x1e8))+'\x27)',_0x1ed9e9=veeva_constants_1['VeevaConstants']['ENDPOINT_VQL']+_0x39a1ee,_0x21ded8=await veeva_service_1[_0x465f74(0x1d0)][_0x465f74(0x20f)](_0x1ed9e9,this['_connectionVeeva']);for(const _0x412891 of _0x21ded8){const _0x1d7267=new veeva_component_dto_1[(_0x465f74(0x1e1))](_0x412891),{name:_0x433a29,type:_0xa71476,status:_0x2e9f99}=_0x1d7267;_0x2e9f99[_0x465f74(0x22a)](_0x465f74(0x1d1))?this[_0x465f74(0x25a)][_0x465f74(0x1f6)](_0x465f74(0x25e)+_0xa71476+'.'+_0x433a29):_0x10c0c2[_0x465f74(0x25d)](_0x1d7267);}return _0x10c0c2;}async[a312_0x1b9163(0x25c)](){const _0x4a481f=a312_0x1b9163;this[_0x4a481f(0x25a)][_0x4a481f(0x1f6)](_0x4a481f(0x1ce));const _0x33146c=[];for(const _0xca95eb in this[_0x4a481f(0x1f7)]){const _0x3d6d6d=(0x0,utils_1['chunkArray'])(this[_0x4a481f(0x1f7)][_0xca95eb],veeva_constants_1[_0x4a481f(0x1f9)][_0x4a481f(0x22d)]),_0x410a18=_0x3d6d6d[_0x4a481f(0x24f)](_0x48c94f=>veeva_constants_1[_0x4a481f(0x1f9)][_0x4a481f(0x252)]+(_0x4a481f(0x1f1)+_0xca95eb+_0x4a481f(0x1c2)+_0x48c94f[_0x4a481f(0x24d)]('\x27,\x27')+'\x27)'));_0x33146c[_0x4a481f(0x25d)](..._0x410a18);}const _0x3a85eb=[],_0x565615=await veeva_service_1['VeevaService'][_0x4a481f(0x20c)](_0x33146c,this[_0x4a481f(0x24b)]);for(const _0xbce885 of _0x565615){const _0x2ebe2e=new veeva_component_dto_1[(_0x4a481f(0x1e1))](_0xbce885),{name:_0x2f93b5,type:_0x541cc2,status:_0x63ad8d}=_0x2ebe2e,_0x106d7d=_0x63ad8d[_0x4a481f(0x22a)](_0x4a481f(0x1d1));_0x106d7d?this[_0x4a481f(0x25a)][_0x4a481f(0x1f6)]('Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20'+_0x541cc2+'.'+_0x2f93b5):_0x3a85eb[_0x4a481f(0x25d)](_0x2ebe2e);}return _0x3a85eb;}async[a312_0x1b9163(0x1c3)](_0x5d8c83){const _0x4d66cc=a312_0x1b9163;this[_0x4d66cc(0x25a)]['log'](_0x4d66cc(0x219));const _0xea1858=veeva_constants_1[_0x4d66cc(0x1f9)]['ENDPOINT_CREATE_RECORDS']+_0x4d66cc(0x1eb),_0x8b5b46=new Array(_0x5d8c83)['fill']({'summary__v':SnapshotService[_0x4d66cc(0x1ca)],'object_type__v.api__name__v':_0x4d66cc(0x1df)});return await veeva_service_1[_0x4d66cc(0x1d0)][_0x4d66cc(0x23e)](_0xea1858,this[_0x4d66cc(0x24b)],_0x8b5b46,this['_logger']);}async[a312_0x1b9163(0x1cc)](_0x381f85,_0x2a47d2){const _0x41d96b=a312_0x1b9163;this['_logger'][_0x41d96b(0x1f6)](_0x41d96b(0x1f8));const _0x1c7240=veeva_constants_1[_0x41d96b(0x1f9)][_0x41d96b(0x240)]+_0x41d96b(0x1d2),_0xb71445=_0x381f85[_0x41d96b(0x24f)]((_0x382a8d,_0x2f0c10)=>({'vault_component__v':_0x382a8d['id'],'outbound_package__v':_0x2a47d2[Math['ceil']((_0x2f0c10+0x1)/veeva_constants_1[_0x41d96b(0x1f9)][_0x41d96b(0x1ed)])-0x1]}));return await veeva_service_1[_0x41d96b(0x1d0)][_0x41d96b(0x23e)](_0x1c7240,this[_0x41d96b(0x24b)],_0xb71445,this[_0x41d96b(0x25a)]);}async[a312_0x1b9163(0x1ea)](_0x16333c){const _0x25b8d5=a312_0x1b9163,_0x43a8a8=await this[_0x25b8d5(0x222)](_0x16333c),_0x2c6057=await this[_0x25b8d5(0x223)](Array[_0x25b8d5(0x1c1)](_0x43a8a8['values']())),_0x26a965=await this[_0x25b8d5(0x22f)](_0x2c6057);return await this[_0x25b8d5(0x231)](_0x26a965);}async[a312_0x1b9163(0x222)](_0x4b45fa){const _0x3618e0=a312_0x1b9163;this[_0x3618e0(0x25a)][_0x3618e0(0x1f6)](_0x3618e0(0x1e0));const _0x393376='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27'+_0x4b45fa[_0x3618e0(0x24d)](_0x3618e0(0x1e8))+'\x27)',_0x2d345d=veeva_constants_1['VeevaConstants'][_0x3618e0(0x252)]+_0x393376,_0x56cbc6=await veeva_service_1[_0x3618e0(0x1d0)][_0x3618e0(0x20f)](_0x2d345d,this[_0x3618e0(0x24b)]);return _0x56cbc6[_0x3618e0(0x256)]((_0x25500b,_0x2a49b5)=>_0x25500b[_0x3618e0(0x201)](_0x2a49b5['id'],_0x2a49b5['name__v']),new Map());}async[a312_0x1b9163(0x223)](_0x469b42){const _0xd9c7ba=a312_0x1b9163;this[_0xd9c7ba(0x25a)][_0xd9c7ba(0x1f6)](_0xd9c7ba(0x23f));const _0x549198=[],_0x3824cf=_0x469b42[_0xd9c7ba(0x24f)](_0x22f3c9=>{const _0x354fe1=_0xd9c7ba;return this[_0x354fe1(0x24b)][_0x354fe1(0x1bb)](veeva_constants_1[_0x354fe1(0x1f9)][_0x354fe1(0x1cb)],encodeURI(_0x354fe1(0x1d4))+'='+encodeURI(_0x22f3c9),{'headers':{'Content-Type':'application/x-www-form-urlencoded'}});}),_0x24a9ab=await Promise['all'](_0x3824cf);for(const {data:_0x377a70}of _0x24a9ab){if(_0x377a70[_0xd9c7ba(0x246)]===status_enums_1['VeevaResponseStatus'][_0xd9c7ba(0x237)]){const {url:_0x16cc29}=_0x377a70;_0x549198['push'](_0x16cc29);}else throw new veeva_error_1[(_0xd9c7ba(0x1cf))](_0x377a70[_0xd9c7ba(0x1dd)]);}return _0x549198;}async['getEndpointArtifactList'](_0x8fccc1){const _0x37c230=a312_0x1b9163;this['_logger'][_0x37c230(0x1f6)](_0x37c230(0x1fc));const _0x12065a=[],_0x367b6f=await veeva_service_1[_0x37c230(0x1d0)][_0x37c230(0x254)](_0x8fccc1,this[_0x37c230(0x24b)],this[_0x37c230(0x25a)]);for(const _0xf9221c of _0x367b6f){const _0xf197d5=_0xf9221c[_0x37c230(0x255)][_0x37c230(0x225)](_0x4d961c=>_0x4d961c[_0x37c230(0x238)]===_0x37c230(0x22c))['map'](_0x11d96e=>_0x11d96e[_0x37c230(0x1be)]);_0x12065a[_0x37c230(0x25d)](..._0xf197d5);}return _0x12065a;}async[a312_0x1b9163(0x231)](_0x38a019){const _0x300ac0=a312_0x1b9163;var _0x48f6dc;const _0x36fdc2=[];this[_0x300ac0(0x25a)][_0x300ac0(0x1f6)](_0x300ac0(0x22b));for(const _0x56e273 of _0x38a019){const {data:_0x489372,headers:_0x441fbf}=await this[_0x300ac0(0x24b)][_0x300ac0(0x1e6)](_0x56e273,{'responseType':_0x300ac0(0x1ec)}),_0x5ea69b=(_0x48f6dc=_0x441fbf['content-type'])===null||_0x48f6dc===void 0x0?void 0x0:_0x48f6dc[_0x300ac0(0x22a)](_0x300ac0(0x20d));if(!_0x5ea69b){const _0x3af617=_0x489372,_0x440229=new jszip_1[(_0x300ac0(0x206))]();await _0x440229[_0x300ac0(0x1f2)](_0x3af617),_0x36fdc2['push'](_0x440229);}else{const _0x5bf1ac=JSON[_0x300ac0(0x20b)](_0x489372);throw new veeva_error_1[(_0x300ac0(0x1cf))](_0x5bf1ac[_0x300ac0(0x1dd)]);}}return _0x36fdc2;}async[a312_0x1b9163(0x1c9)](_0x261394,_0x264325){const _0x5c1786=a312_0x1b9163;var _0x506b75;this[_0x5c1786(0x25a)][_0x5c1786(0x1f6)](_0x5c1786(0x229));const _0x424466=this[_0x5c1786(0x239)](_0x261394),_0x1336df=_0x424466['reduce']((_0x2f7940,_0x1b11fb)=>_0x2f7940[_0x5c1786(0x201)](_0x1b11fb[_0x5c1786(0x1da)],_0x1b11fb),new Map());for(const _0x1cb518 of _0x264325){for(const _0x297be7 in _0x1cb518['files']){const _0x43ce76=_0x297be7['split']('/')['at'](-0x1);if(_0x1336df['has'](_0x43ce76)){const _0x30923b=await((_0x506b75=_0x1cb518[_0x5c1786(0x1f4)](_0x297be7))===null||_0x506b75===void 0x0?void 0x0:_0x506b75['async']('string'));if(_0x30923b){const _0x248a26=new jszip_1['default']();_0x248a26[_0x5c1786(0x1f4)](_0x43ce76,_0x30923b),_0x1336df[_0x5c1786(0x1e6)](_0x43ce76)[_0x5c1786(0x210)]=await _0x248a26['generateAsync']({'type':'base64'});}}}}return _0x424466['filter'](_0x4bb230=>!_0x4bb230[_0x5c1786(0x210)])['forEach'](_0x4b273d=>{const _0xa6772c=_0x5c1786;this[_0xa6772c(0x25a)]['log'](_0xa6772c(0x217)+_0x4b273d['veevaComponentType']+'.'+_0x4b273d['name']+'\x20from\x20outbound\x20package');}),_0x424466['filter'](_0x5bcf3d=>_0x5bcf3d[_0x5c1786(0x210)]);}[a312_0x1b9163(0x239)](_0x1a8b2a){const _0x40d760=a312_0x1b9163;return _0x1a8b2a[_0x40d760(0x24f)](_0x25a489=>{const _0xd8359a=_0x40d760,_0x4dc7e1=new metadata_item_dto_1[(_0xd8359a(0x25b))]();return _0x4dc7e1[_0xd8359a(0x211)]=_0x25a489[_0xd8359a(0x211)],_0x4dc7e1[_0xd8359a(0x260)]=_0x25a489[_0xd8359a(0x211)],_0x4dc7e1[_0xd8359a(0x247)]=this[_0xd8359a(0x23a)],_0x4dc7e1[_0xd8359a(0x1da)]=_0x25a489[_0xd8359a(0x236)]+'.'+_0x25a489['name']+_0xd8359a(0x1ff),_0x4dc7e1[_0xd8359a(0x249)]=_0x25a489[_0xd8359a(0x236)],_0x4dc7e1['lastModifiedDate']=_0x25a489[_0xd8359a(0x250)],_0x4dc7e1[_0xd8359a(0x1d8)]=![],_0x4dc7e1;});}async[a312_0x1b9163(0x1fb)](_0x27bdb3){const _0x52653a=a312_0x1b9163;this[_0x52653a(0x25a)][_0x52653a(0x1f6)](_0x52653a(0x24e));const _0x2a9433=veeva_constants_1[_0x52653a(0x1f9)]['ENDPOINT_CREATE_RECORDS']+'package_component__v';await veeva_service_1['VeevaService']['deleteVeevaObjectRecords'](_0x2a9433,this[_0x52653a(0x24b)],_0x27bdb3,this[_0x52653a(0x25a)]);}async[a312_0x1b9163(0x23c)](_0x260da1){const _0x35d170=a312_0x1b9163;this[_0x35d170(0x25a)][_0x35d170(0x1f6)](_0x35d170(0x1e4));const _0x5d9739=veeva_constants_1[_0x35d170(0x1f9)][_0x35d170(0x240)]+_0x35d170(0x1eb);await veeva_service_1['VeevaService'][_0x35d170(0x1c0)](_0x5d9739,this[_0x35d170(0x24b)],_0x260da1,this[_0x35d170(0x25a)]);}async[a312_0x1b9163(0x228)](_0x226132){const _0x5decdc=a312_0x1b9163;this[_0x5decdc(0x25a)][_0x5decdc(0x1f6)]('Saving\x20Attachments.'),await this[_0x5decdc(0x212)](_0x226132),this[_0x5decdc(0x25a)][_0x5decdc(0x1f6)](_0x5decdc(0x1c5)+_0x226132[_0x5decdc(0x24a)]+_0x5decdc(0x241));const _0xb1d7f5=_0x226132['map'](_0x5a9a77=>{const _0x2679c9=_0x5decdc;return{[constants_1[_0x2679c9(0x1fd)]+_0x2679c9(0x203)]:_0x5a9a77['name'],[constants_1[_0x2679c9(0x1fd)]+_0x2679c9(0x1db)]:_0x5a9a77[_0x2679c9(0x260)],[constants_1['FLOSUM_NAMESPACE']+_0x2679c9(0x214)]:_0x5a9a77[_0x2679c9(0x247)],[constants_1[_0x2679c9(0x1fd)]+_0x2679c9(0x226)]:_0x5a9a77[_0x2679c9(0x1da)],[constants_1['FLOSUM_NAMESPACE']+_0x2679c9(0x1ba)]:_0x5a9a77['isRetrieved'],[constants_1['FLOSUM_NAMESPACE']+_0x2679c9(0x245)]:_0x5a9a77[_0x2679c9(0x249)],[constants_1[_0x2679c9(0x1fd)]+_0x2679c9(0x23b)]:_0x5a9a77[_0x2679c9(0x1d6)],[constants_1[_0x2679c9(0x1fd)]+_0x2679c9(0x233)]:_0x5a9a77['lastModifiedDate']};}),_0x234d79=await salesforce_service_1['SalesforceService'][_0x5decdc(0x259)](this[_0x5decdc(0x1f0)],constants_1['FLOSUM_NAMESPACE']+'Metadata_Item__c',_0xb1d7f5);let _0xf71929=!![];_0x234d79[_0x5decdc(0x242)]((_0x49956b,_0x4e7230)=>{const _0x4dbe32=_0x5decdc;this[_0x4dbe32(0x25a)][_0x4dbe32(0x1f6)](_0x4dbe32(0x1c5)+_0x226132[_0x4e7230][_0x4dbe32(0x249)]+'.'+_0x226132[_0x4e7230][_0x4dbe32(0x211)]);if(!_0x49956b[_0x4dbe32(0x243)]){_0xf71929=![];const _0x4c3f21=new salesforce_dml_error_1['SalesforceDmlError'](_0x49956b['errors']);this['_logger'][_0x4dbe32(0x24c)](_0x4c3f21);}});if(!_0xf71929)throw new Error(_0x5decdc(0x234));}async[a312_0x1b9163(0x212)](_0x58529c){const _0x1f872a=a312_0x1b9163,_0x1ce367=this['formAttachments'](_0x58529c),_0x251fbb=await salesforce_service_1[_0x1f872a(0x253)]['insertMultipleRecords'](this['_connectionSalesforce'],SnapshotService['ATTACMENT'],_0x1ce367),_0x537bfc=[];_0x251fbb['forEach']((_0x226dd9,_0x139589)=>{const _0x1aa42a=_0x1f872a;_0x226dd9['success']?(_0x58529c[_0x139589][_0x1aa42a(0x1d6)]=_0x226dd9['id'],_0x58529c[_0x139589][_0x1aa42a(0x1d8)]=!![]):_0x537bfc[_0x1aa42a(0x25d)](..._0x226dd9['errors']);});if(_0x537bfc[_0x1f872a(0x24a)])throw new salesforce_dml_error_1['SalesforceDmlError'](_0x537bfc);}[a312_0x1b9163(0x208)](_0x184383){const _0x3106a8=a312_0x1b9163;return _0x184383['map'](_0x28c41d=>({'ParentId':this['_snapshotId'],'Name':_0x28c41d[_0x3106a8(0x249)],'ContentType':_0x3106a8(0x207),'Body':_0x28c41d[_0x3106a8(0x210)],'Description':_0x28c41d[_0x3106a8(0x249)]}));}async[a312_0x1b9163(0x248)](_0xb92a5d){const _0x252231=a312_0x1b9163,_0x212b8b={[constants_1[_0x252231(0x1fd)]+_0x252231(0x1fe)]:!![],[constants_1['FLOSUM_NAMESPACE']+_0x252231(0x261)]:!_0xb92a5d},_0x14c596={[constants_1[_0x252231(0x1fd)]+_0x252231(0x261)]:!_0xb92a5d,[constants_1[_0x252231(0x1fd)]+'Succeed__c']:_0xb92a5d,[constants_1[_0x252231(0x1fd)]+_0x252231(0x1e2)]:_0xb92a5d?status_enums_1['MetadataLogStatus'][_0x252231(0x227)]:status_enums_1[_0x252231(0x1e5)][_0x252231(0x1bc)],[constants_1[_0x252231(0x1fd)]+_0x252231(0x1fa)]:!![]};await this[_0x252231(0x1f0)]['patch'](flosum_constants_1[_0x252231(0x218)][_0x252231(0x21a)]+'/'+constants_1['FLOSUM_NAMESPACE']+_0x252231(0x200)+this[_0x252231(0x23a)],_0x212b8b),await this['_connectionSalesforce']['patch'](flosum_constants_1['FlosumConstants']['ENDPOINT_UPSERT_RECORD']+'/'+constants_1[_0x252231(0x1fd)]+_0x252231(0x25f)+this['_metadataLogId'],_0x14c596),this['_logger'][_0x252231(0x1f6)](_0x252231(0x1cd)+(_0xb92a5d?_0x252231(0x1bd):_0x252231(0x1e3))+'.'),await this[_0x252231(0x25a)][_0x252231(0x209)]();}}exports[a312_0x1b9163(0x20e)]=SnapshotService,SnapshotService[a312_0x1b9163(0x1ca)]='Snapshot',SnapshotService[a312_0x1b9163(0x257)]=a312_0x1b9163(0x1dc);