const a257_0x31d5ce=a257_0xfb02;(function(_0x4e3bba,_0x374f91){const _0x98bec8=a257_0xfb02,_0x358b16=_0x4e3bba();while(!![]){try{const _0x1cffb9=parseInt(_0x98bec8(0xe5))/0x1+-parseInt(_0x98bec8(0x13a))/0x2+-parseInt(_0x98bec8(0x130))/0x3*(-parseInt(_0x98bec8(0x137))/0x4)+-parseInt(_0x98bec8(0xe0))/0x5+-parseInt(_0x98bec8(0xbd))/0x6*(parseInt(_0x98bec8(0xd4))/0x7)+parseInt(_0x98bec8(0xda))/0x8*(parseInt(_0x98bec8(0x136))/0x9)+-parseInt(_0x98bec8(0x156))/0xa*(-parseInt(_0x98bec8(0x14d))/0xb);if(_0x1cffb9===_0x374f91)break;else _0x358b16['push'](_0x358b16['shift']());}catch(_0xd4c7e1){_0x358b16['push'](_0x358b16['shift']());}}}(a257_0xddb2,0x187db));const a257_0x46ad6c=(function(){let _0x434b42=!![];return function(_0x3338bd,_0x5b5f04){const _0x54121c=_0x434b42?function(){const _0x4a7d7b=a257_0xfb02;if(_0x5b5f04){const _0x17fa6b=_0x5b5f04[_0x4a7d7b(0x109)](_0x3338bd,arguments);return _0x5b5f04=null,_0x17fa6b;}}:function(){};return _0x434b42=![],_0x54121c;};}()),a257_0x3cf15a=a257_0x46ad6c(this,function(){const _0x32524c=a257_0xfb02;return a257_0x3cf15a[_0x32524c(0x131)]()['search'](_0x32524c(0x13f))[_0x32524c(0x131)]()[_0x32524c(0xee)](a257_0x3cf15a)['search']('(((.+)+)+)+$');});a257_0x3cf15a();function a257_0xddb2(){const _0x1aec5f=['successfully','loadAsync','Succeed__c','saveComponentsInSalesforce','errors','name','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','body','VeevaComponentDto','default','_attachmentLogId','apply','formMetadataItemDtoList','base64','push','attachmentLogId','outbound_package__v','forEach','Getting\x20names\x20of\x20outbound\x20packages','saveAttachments','packageName','Snapshot','parse','FlosumConstants','string','error','../../shared/utils','chunkArray','insertMultipleRecords','formAttachments','from','deleteVeevaObjectRecords','rel','logError','\x27\x20AND\x20component_name__v\x20CONTAINS\x20(\x27','application/zip','VeevaConstants','_selectedComponentMap','file','application/x-www-form-urlencoded','fill','VeevaService','createOutboundPackages','artifacts','updateLog','SUCCESS','BUILD_WHERE_BY_NAME_LIMIT','isRetrieved','FLOSUM_NAMESPACE','migration__sys','298101fRLYky','toString','type','.mdl','VeevaResponseStatus','post','41346oiaLpa','4ezxncU','VeevaError','jszip','338532iGexFK','MAXIMUM_SIZE_OF_PACKAGE','createVeevaObjectRecords','Status__c','Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20','(((.+)+)+)+$','./salesforce.service','_metadataLogId','__esModule','Last_Modified_Date__c','Snapshot__c/','getEndpointArtifactList','package_component__v','SalesforceDmlError','Label__c','__importDefault','getJobResult','_snapshotId','getComponentsMetadataByTypes','407LgZnTx','attachmentId','retrieveVPKList','ENDPOINT_EXPORT_IMPORT_PACKAGE','selectedComponentMap','ceil','patch','veevaComponentType','createMetadataItemListWithBody','48390coKWnk','filter','Attachment_ID__c','label','responseStatus','length','Is_Completed__c','Saving\x20','snapshotId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20CONTAINS\x20(\x27','inactive__v','timeZone','_connectionVeeva','_logger','_connectionSalesforce','getPackageNames','ENDPOINT_UPSERT_RECORD','6tkrmNg','../../../constants','Snapshot\x20started.','Veeva_Component_Type__c','finishSnapshot','deletePackageComponents','OUTBOUND_PACKAGE_NAME','ENDPOINT_CREATE_RECORDS','Saving\x20Attachments.','reduce','MetadataItemDto','lastModifiedDate','Retrieve\x20Outbound\x20Package\x20zip\x20list','Retrieve\x20collection\x20metadata\x20of\x20components','Create\x20Export\x20outbound\x20packages.','Snapshot__c','success','../classes/errors/salesforce-dml-error','_selectedMetaTypes','log','all','Snapshot\x20completed\x20','SalesforceService','375102lrzGWe','Is_Error__c','./veeva.service','createExportOutboundPackages','set','Is_Retrieved__c','184YOBHpr','COMPLETED','executeVQL','Creating\x20outbound\x20packages','split','name__v','800035DmXSlr','map','join','Job_Completed__c','getComponentsMetadataByTypeAndName','99102FmUZcT','arraybuffer','SnapshotService','MetadataLogStatus','ENDPOINT_VQL','values','apiName','../enums/status.enums','selectedMetaTypes','constructor','defineProperty','_timeZone','executeManyVQL','SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20=\x27','with\x20error','createPackageComponents','includes','exportOutboundPackage','Unpack\x20zip\x20and\x20create\x20metadata\x20items.','\x20from\x20outbound\x20package','execute','Cannot\x20Save\x20Metadata\x20Items','get','deleteOutboundPackages','\x27,\x27'];a257_0xddb2=function(){return _0x1aec5f;};return a257_0xddb2();}'use strict';var __importDefault=this&&this[a257_0x31d5ce(0x149)]||function(_0x54e689){const _0x1fabed=a257_0x31d5ce;return _0x54e689&&_0x54e689[_0x1fabed(0x142)]?_0x54e689:{'default':_0x54e689};};Object[a257_0x31d5ce(0xef)](exports,a257_0x31d5ce(0x142),{'value':!![]}),exports['SnapshotService']=void 0x0;const jszip_1=__importDefault(require(a257_0x31d5ce(0x139))),flosum_constants_1=require('../constants/flosum.constants'),veeva_constants_1=require('../constants/veeva.constants'),veeva_service_1=require(a257_0x31d5ce(0xd6)),veeva_component_dto_1=require('../dtos/veeva-component.dto'),metadata_item_dto_1=require('../dtos/metadata-item.dto'),utils_1=require(a257_0x31d5ce(0x118)),constants_1=require(a257_0x31d5ce(0xbe)),salesforce_service_1=require(a257_0x31d5ce(0x140)),status_enums_1=require(a257_0x31d5ce(0xec)),salesforce_dml_error_1=require(a257_0x31d5ce(0xce)),veeva_error_1=require('../classes/errors/veeva-error');function a257_0xfb02(_0x13cba9,_0x51a848){const _0x2f026b=a257_0xddb2();return a257_0xfb02=function(_0x3cf15a,_0x46ad6c){_0x3cf15a=_0x3cf15a-0xba;let _0xddb25a=_0x2f026b[_0x3cf15a];return _0xddb25a;},a257_0xfb02(_0x13cba9,_0x51a848);}class SnapshotService{constructor(_0x178564,_0x46adca,_0x7991c2,_0xb3e7d6){const _0x4fdfbe=a257_0x31d5ce;this[_0x4fdfbe(0xba)]=_0x46adca,this[_0x4fdfbe(0x162)]=_0x7991c2,this[_0x4fdfbe(0x163)]=_0xb3e7d6,this[_0x4fdfbe(0x14b)]=_0x178564[_0x4fdfbe(0x15e)],this['_metadataLogId']=_0x178564['metadataLogId'],this[_0x4fdfbe(0x108)]=_0x178564[_0x4fdfbe(0x10d)],this[_0x4fdfbe(0xf0)]=_0x178564[_0x4fdfbe(0x161)],this['_selectedMetaTypes']=_0x178564[_0x4fdfbe(0xed)],this[_0x4fdfbe(0x123)]=_0x178564[_0x4fdfbe(0x151)];}async[a257_0x31d5ce(0xf9)](){const _0x267581=a257_0x31d5ce;try{this['_logger']['log'](_0x267581(0xbf));const _0x327020=Array[_0x267581(0x11c)](Object[_0x267581(0xea)](this[_0x267581(0x123)]))['length']?await this[_0x267581(0xe4)]():await this[_0x267581(0x14c)]();await this['_logger'][_0x267581(0x12a)]();const _0x53d9ba=await this[_0x267581(0x128)](Math['ceil'](_0x327020[_0x267581(0x15b)]/veeva_constants_1['VeevaConstants'][_0x267581(0x13b)])),_0x4c614f=await this[_0x267581(0xf4)](_0x327020,_0x53d9ba);await this[_0x267581(0x163)][_0x267581(0x12a)]();const _0x32495e=await this['exportOutboundPackage'](_0x53d9ba),_0x1dc7e9=await this['createMetadataItemListWithBody'](_0x327020,_0x32495e);await this[_0x267581(0x101)](_0x1dc7e9),await this[_0x267581(0x163)][_0x267581(0x12a)](),await this[_0x267581(0xc2)](_0x4c614f),await this[_0x267581(0xfc)](_0x53d9ba),await this[_0x267581(0xc1)](!![]);}catch(_0x51ae91){this[_0x267581(0x163)][_0x267581(0x11f)](_0x51ae91),await this[_0x267581(0xc1)](![])['catch'](_0x397b01=>this['_systemLogger'][_0x267581(0x117)](_0x397b01));}}async[a257_0x31d5ce(0x14c)](){const _0x9df6c7=a257_0x31d5ce;this[_0x9df6c7(0x163)][_0x9df6c7(0xd0)](_0x9df6c7(0xca));const _0x2e31f6=[],_0x1069e7=_0x9df6c7(0x15f)+this[_0x9df6c7(0xcf)][_0x9df6c7(0xe2)](_0x9df6c7(0xfd))+'\x27)',_0x3f1f8f=veeva_constants_1[_0x9df6c7(0x122)]['ENDPOINT_VQL']+_0x1069e7,_0xb21739=await veeva_service_1['VeevaService'][_0x9df6c7(0xdc)](_0x3f1f8f,this[_0x9df6c7(0x162)]);for(const _0x52635d of _0xb21739){const _0x2f2f7c=new veeva_component_dto_1[(_0x9df6c7(0x106))](_0x52635d),{name:_0x2e20c9,type:_0x232e0c,status:_0x4f553e}=_0x2f2f7c;_0x4f553e[_0x9df6c7(0xf5)](_0x9df6c7(0x160))?this[_0x9df6c7(0x163)][_0x9df6c7(0xd0)](_0x9df6c7(0x13e)+_0x232e0c+'.'+_0x2e20c9):_0x2e31f6[_0x9df6c7(0x10c)](_0x2f2f7c);}return _0x2e31f6;}async['getComponentsMetadataByTypeAndName'](){const _0x5e07d2=a257_0x31d5ce;this[_0x5e07d2(0x163)][_0x5e07d2(0xd0)]('Retrieve\x20collection\x20metadata\x20of\x20components\x20by\x20type\x20and\x20names');const _0x3c4127=[];for(const _0x4e2615 in this[_0x5e07d2(0x123)]){const _0xfe8ea4=(0x0,utils_1[_0x5e07d2(0x119)])(this['_selectedComponentMap'][_0x4e2615],veeva_constants_1[_0x5e07d2(0x122)][_0x5e07d2(0x12c)]),_0x5c8afa=_0xfe8ea4[_0x5e07d2(0xe1)](_0x272df3=>veeva_constants_1[_0x5e07d2(0x122)][_0x5e07d2(0xe9)]+(_0x5e07d2(0xf2)+_0x4e2615+_0x5e07d2(0x120)+_0x272df3['join']('\x27,\x27')+'\x27)'));_0x3c4127[_0x5e07d2(0x10c)](..._0x5c8afa);}const _0x4a8dab=[],_0x11274b=await veeva_service_1[_0x5e07d2(0x127)][_0x5e07d2(0xf1)](_0x3c4127,this['_connectionVeeva']);for(const _0x2b6dd8 of _0x11274b){const _0x42c11f=new veeva_component_dto_1[(_0x5e07d2(0x106))](_0x2b6dd8),{name:_0x407aa1,type:_0x64a260,status:_0x290cbe}=_0x42c11f,_0x5386ef=_0x290cbe[_0x5e07d2(0xf5)](_0x5e07d2(0x160));_0x5386ef?this[_0x5e07d2(0x163)]['log'](_0x5e07d2(0x13e)+_0x64a260+'.'+_0x407aa1):_0x4a8dab['push'](_0x42c11f);}return _0x4a8dab;}async[a257_0x31d5ce(0x128)](_0x23d869){const _0x95a3c5=a257_0x31d5ce;this[_0x95a3c5(0x163)][_0x95a3c5(0xd0)](_0x95a3c5(0xdd));const _0x2d428b=veeva_constants_1[_0x95a3c5(0x122)][_0x95a3c5(0xc4)]+'outbound_package__v',_0x51cfe9=new Array(_0x23d869)[_0x95a3c5(0x126)]({'summary__v':SnapshotService[_0x95a3c5(0xc3)],'object_type__v.api__name__v':_0x95a3c5(0x12f)});return await veeva_service_1[_0x95a3c5(0x127)][_0x95a3c5(0x13c)](_0x2d428b,this[_0x95a3c5(0x162)],_0x51cfe9,this[_0x95a3c5(0x163)]);}async[a257_0x31d5ce(0xf4)](_0x3d48b1,_0x1895f3){const _0x484023=a257_0x31d5ce;this[_0x484023(0x163)][_0x484023(0xd0)]('Adding\x20components\x20to\x20outbound\x20package');const _0x6c9c76=veeva_constants_1['VeevaConstants'][_0x484023(0xc4)]+_0x484023(0x146),_0x5961bb=_0x3d48b1[_0x484023(0xe1)]((_0x22f22c,_0x299714)=>({'vault_component__v':_0x22f22c['id'],'outbound_package__v':_0x1895f3[Math[_0x484023(0x152)]((_0x299714+0x1)/veeva_constants_1['VeevaConstants']['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await veeva_service_1['VeevaService'][_0x484023(0x13c)](_0x6c9c76,this['_connectionVeeva'],_0x5961bb,this[_0x484023(0x163)]);}async[a257_0x31d5ce(0xf6)](_0x25ce03){const _0x119852=a257_0x31d5ce,_0xcd5615=await this[_0x119852(0xbb)](_0x25ce03),_0x38b798=await this['createExportOutboundPackages'](Array[_0x119852(0x11c)](_0xcd5615[_0x119852(0xea)]())),_0x45d15b=await this[_0x119852(0x145)](_0x38b798);return await this[_0x119852(0x14f)](_0x45d15b);}async['getPackageNames'](_0x5f4207){const _0x56a1b6=a257_0x31d5ce;this['_logger'][_0x56a1b6(0xd0)](_0x56a1b6(0x110));const _0x4672c2=_0x56a1b6(0x104)+_0x5f4207['join'](_0x56a1b6(0xfd))+'\x27)',_0x476df7=veeva_constants_1[_0x56a1b6(0x122)][_0x56a1b6(0xe9)]+_0x4672c2,_0x4b1e6a=await veeva_service_1[_0x56a1b6(0x127)]['executeVQL'](_0x476df7,this[_0x56a1b6(0x162)]);return _0x4b1e6a[_0x56a1b6(0xc6)]((_0x354015,_0x3925c7)=>_0x354015[_0x56a1b6(0xd8)](_0x3925c7['id'],_0x3925c7[_0x56a1b6(0xdf)]),new Map());}async[a257_0x31d5ce(0xd7)](_0x4612c9){const _0xb4c63e=a257_0x31d5ce;this[_0xb4c63e(0x163)][_0xb4c63e(0xd0)](_0xb4c63e(0xcb));const _0x495990=[],_0x3be3c1=_0x4612c9['map'](_0x267e46=>{const _0x99d561=_0xb4c63e;return this['_connectionVeeva'][_0x99d561(0x135)](veeva_constants_1[_0x99d561(0x122)][_0x99d561(0x150)],encodeURI(_0x99d561(0x112))+'='+encodeURI(_0x267e46),{'headers':{'Content-Type':_0x99d561(0x125)}});}),_0x5e7633=await Promise[_0xb4c63e(0xd1)](_0x3be3c1);for(const {data:_0x47856b}of _0x5e7633){if(_0x47856b[_0xb4c63e(0x15a)]===status_enums_1[_0xb4c63e(0x134)][_0xb4c63e(0x12b)]){const {url:_0x546c3e}=_0x47856b;_0x495990[_0xb4c63e(0x10c)](_0x546c3e);}else throw new veeva_error_1[(_0xb4c63e(0x138))](_0x47856b[_0xb4c63e(0x102)]);}return _0x495990;}async[a257_0x31d5ce(0x145)](_0x5f1782){const _0x58ec91=a257_0x31d5ce;this[_0x58ec91(0x163)][_0x58ec91(0xd0)]('Retrieve\x20Jobs\x20Status');const _0x38c91f=[],_0x4f48d9=await veeva_service_1['VeevaService'][_0x58ec91(0x14a)](_0x5f1782,this['_connectionVeeva'],this[_0x58ec91(0x163)]);for(const _0x229182 of _0x4f48d9){const _0x3999f8=_0x229182['links'][_0x58ec91(0x157)](_0x38053d=>_0x38053d[_0x58ec91(0x11e)]===_0x58ec91(0x129))[_0x58ec91(0xe1)](_0x58792d=>_0x58792d['href']);_0x38c91f['push'](..._0x3999f8);}return _0x38c91f;}async[a257_0x31d5ce(0x14f)](_0x507889){const _0x449dc5=a257_0x31d5ce;var _0x5cd6ec;const _0x6c71f8=[];this['_logger'][_0x449dc5(0xd0)](_0x449dc5(0xc9));for(const _0x22dcfb of _0x507889){const {data:_0x3a05b5,headers:_0x4e4728}=await this[_0x449dc5(0x162)][_0x449dc5(0xfb)](_0x22dcfb,{'responseType':_0x449dc5(0xe6)}),_0x2f35e3=(_0x5cd6ec=_0x4e4728['content-type'])===null||_0x5cd6ec===void 0x0?void 0x0:_0x5cd6ec[_0x449dc5(0xf5)]('application/json');if(!_0x2f35e3){const _0x4ddf63=_0x3a05b5,_0x36dae9=new jszip_1[(_0x449dc5(0x107))]();await _0x36dae9[_0x449dc5(0xff)](_0x4ddf63),_0x6c71f8[_0x449dc5(0x10c)](_0x36dae9);}else{const _0x5d593e=JSON[_0x449dc5(0x114)](_0x3a05b5);throw new veeva_error_1[(_0x449dc5(0x138))](_0x5d593e[_0x449dc5(0x102)]);}}return _0x6c71f8;}async[a257_0x31d5ce(0x155)](_0x3c3d92,_0x57b5d3){const _0x5c57c1=a257_0x31d5ce;var _0x3312d4;this[_0x5c57c1(0x163)][_0x5c57c1(0xd0)](_0x5c57c1(0xf7));const _0x2e657f=this[_0x5c57c1(0x10a)](_0x3c3d92),_0x487ffe=_0x2e657f[_0x5c57c1(0xc6)]((_0x37bfe0,_0x27634d)=>_0x37bfe0[_0x5c57c1(0xd8)](_0x27634d['label'],_0x27634d),new Map());for(const _0x1f1550 of _0x57b5d3){for(const _0xcea11a in _0x1f1550['files']){const _0x57aa04=_0xcea11a[_0x5c57c1(0xde)]('/')['at'](-0x1);if(_0x487ffe['has'](_0x57aa04)){const _0x563fe0=await((_0x3312d4=_0x1f1550[_0x5c57c1(0x124)](_0xcea11a))===null||_0x3312d4===void 0x0?void 0x0:_0x3312d4['async'](_0x5c57c1(0x116)));if(_0x563fe0){const _0xd17ac1=new jszip_1[(_0x5c57c1(0x107))]();_0xd17ac1[_0x5c57c1(0x124)](_0x57aa04,_0x563fe0),_0x487ffe[_0x5c57c1(0xfb)](_0x57aa04)[_0x5c57c1(0x105)]=await _0xd17ac1['generateAsync']({'type':_0x5c57c1(0x10b)});}}}}return _0x2e657f[_0x5c57c1(0x157)](_0x52a216=>!_0x52a216[_0x5c57c1(0x105)])[_0x5c57c1(0x10f)](_0x441cf3=>{const _0x50fe51=_0x5c57c1;this[_0x50fe51(0x163)][_0x50fe51(0xd0)]('Cannot\x20retrieve\x20'+_0x441cf3[_0x50fe51(0x154)]+'.'+_0x441cf3['name']+_0x50fe51(0xf8));}),_0x2e657f[_0x5c57c1(0x157)](_0x459029=>_0x459029[_0x5c57c1(0x105)]);}[a257_0x31d5ce(0x10a)](_0x2750bd){const _0xb00ca3=a257_0x31d5ce;return _0x2750bd[_0xb00ca3(0xe1)](_0xc5763b=>{const _0x372b6f=_0xb00ca3,_0x1d80a0=new metadata_item_dto_1[(_0x372b6f(0xc7))]();return _0x1d80a0[_0x372b6f(0x103)]=_0xc5763b[_0x372b6f(0x103)],_0x1d80a0['apiName']=_0xc5763b[_0x372b6f(0x103)],_0x1d80a0[_0x372b6f(0x15e)]=this[_0x372b6f(0x14b)],_0x1d80a0[_0x372b6f(0x159)]=_0xc5763b[_0x372b6f(0x132)]+'.'+_0xc5763b[_0x372b6f(0x103)]+_0x372b6f(0x133),_0x1d80a0[_0x372b6f(0x154)]=_0xc5763b[_0x372b6f(0x132)],_0x1d80a0[_0x372b6f(0xc8)]=_0xc5763b[_0x372b6f(0xc8)],_0x1d80a0['isRetrieved']=![],_0x1d80a0;});}async[a257_0x31d5ce(0xc2)](_0x1c132b){const _0x568f2a=a257_0x31d5ce;this['_logger'][_0x568f2a(0xd0)]('Removing\x20components\x20from\x20outbound\x20packages.');const _0x585446=veeva_constants_1[_0x568f2a(0x122)]['ENDPOINT_CREATE_RECORDS']+_0x568f2a(0x146);await veeva_service_1[_0x568f2a(0x127)][_0x568f2a(0x11d)](_0x585446,this[_0x568f2a(0x162)],_0x1c132b,this[_0x568f2a(0x163)]);}async[a257_0x31d5ce(0xfc)](_0x38ea1d){const _0x2aca86=a257_0x31d5ce;this[_0x2aca86(0x163)][_0x2aca86(0xd0)]('Deleting\x20outbound\x20packages.');const _0x2922d5=veeva_constants_1[_0x2aca86(0x122)][_0x2aca86(0xc4)]+_0x2aca86(0x10e);await veeva_service_1[_0x2aca86(0x127)][_0x2aca86(0x11d)](_0x2922d5,this[_0x2aca86(0x162)],_0x38ea1d,this[_0x2aca86(0x163)]);}async[a257_0x31d5ce(0x101)](_0x367d87){const _0x39a1a8=a257_0x31d5ce;this[_0x39a1a8(0x163)][_0x39a1a8(0xd0)](_0x39a1a8(0xc5)),await this[_0x39a1a8(0x111)](_0x367d87),this[_0x39a1a8(0x163)][_0x39a1a8(0xd0)](_0x39a1a8(0x15d)+_0x367d87[_0x39a1a8(0x15b)]+'\x20Metadata\x20Items');const _0x5a1b82=_0x367d87[_0x39a1a8(0xe1)](_0x59ed0e=>{const _0x3f10a5=_0x39a1a8;return{[constants_1[_0x3f10a5(0x12e)]+'Name__c']:_0x59ed0e[_0x3f10a5(0x103)],[constants_1[_0x3f10a5(0x12e)]+'API_Name__c']:_0x59ed0e[_0x3f10a5(0xeb)],[constants_1[_0x3f10a5(0x12e)]+_0x3f10a5(0xcc)]:_0x59ed0e[_0x3f10a5(0x15e)],[constants_1[_0x3f10a5(0x12e)]+_0x3f10a5(0x148)]:_0x59ed0e[_0x3f10a5(0x159)],[constants_1[_0x3f10a5(0x12e)]+_0x3f10a5(0xd9)]:_0x59ed0e[_0x3f10a5(0x12d)],[constants_1[_0x3f10a5(0x12e)]+_0x3f10a5(0xc0)]:_0x59ed0e[_0x3f10a5(0x154)],[constants_1['FLOSUM_NAMESPACE']+_0x3f10a5(0x158)]:_0x59ed0e[_0x3f10a5(0x14e)],[constants_1[_0x3f10a5(0x12e)]+_0x3f10a5(0x143)]:_0x59ed0e[_0x3f10a5(0xc8)]};}),_0xefe687=await salesforce_service_1[_0x39a1a8(0xd3)][_0x39a1a8(0x11a)](this[_0x39a1a8(0xba)],constants_1[_0x39a1a8(0x12e)]+'Metadata_Item__c',_0x5a1b82);let _0x5e3038=!![];_0xefe687[_0x39a1a8(0x10f)]((_0x3576cc,_0xb03629)=>{const _0x35c5cd=_0x39a1a8;this[_0x35c5cd(0x163)][_0x35c5cd(0xd0)](_0x35c5cd(0x15d)+_0x367d87[_0xb03629]['veevaComponentType']+'.'+_0x367d87[_0xb03629][_0x35c5cd(0x103)]);if(!_0x3576cc['success']){_0x5e3038=![];const _0x461b90=new salesforce_dml_error_1[(_0x35c5cd(0x147))](_0x3576cc[_0x35c5cd(0x102)]);this[_0x35c5cd(0x163)]['logError'](_0x461b90);}});if(!_0x5e3038)throw new Error(_0x39a1a8(0xfa));}async[a257_0x31d5ce(0x111)](_0x26cb1e){const _0x3332fa=a257_0x31d5ce,_0x45b96d=this[_0x3332fa(0x11b)](_0x26cb1e),_0x3e724a=await salesforce_service_1['SalesforceService']['insertMultipleRecords'](this[_0x3332fa(0xba)],SnapshotService['ATTACMENT'],_0x45b96d),_0x387f15=[];_0x3e724a[_0x3332fa(0x10f)]((_0x3bffd6,_0x17904c)=>{const _0x213cee=_0x3332fa;_0x3bffd6[_0x213cee(0xcd)]?(_0x26cb1e[_0x17904c][_0x213cee(0x14e)]=_0x3bffd6['id'],_0x26cb1e[_0x17904c][_0x213cee(0x12d)]=!![]):_0x387f15['push'](..._0x3bffd6[_0x213cee(0x102)]);});if(_0x387f15['length'])throw new salesforce_dml_error_1[(_0x3332fa(0x147))](_0x387f15);}[a257_0x31d5ce(0x11b)](_0x476553){const _0x2c728c=a257_0x31d5ce;return _0x476553[_0x2c728c(0xe1)](_0x5ad4c9=>({'ParentId':this[_0x2c728c(0x14b)],'Name':_0x5ad4c9['veevaComponentType'],'ContentType':_0x2c728c(0x121),'Body':_0x5ad4c9['body'],'Description':_0x5ad4c9[_0x2c728c(0x154)]}));}async[a257_0x31d5ce(0xc1)](_0x15355b){const _0x2a2613=a257_0x31d5ce,_0x2ffce4={[constants_1[_0x2a2613(0x12e)]+_0x2a2613(0x15c)]:!![],[constants_1['FLOSUM_NAMESPACE']+_0x2a2613(0xd5)]:!_0x15355b},_0x5df4c0={[constants_1[_0x2a2613(0x12e)]+_0x2a2613(0xd5)]:!_0x15355b,[constants_1[_0x2a2613(0x12e)]+_0x2a2613(0x100)]:_0x15355b,[constants_1[_0x2a2613(0x12e)]+_0x2a2613(0x13d)]:_0x15355b?status_enums_1[_0x2a2613(0xe8)][_0x2a2613(0xdb)]:status_enums_1['MetadataLogStatus']['EXCEPTION'],[constants_1['FLOSUM_NAMESPACE']+_0x2a2613(0xe3)]:!![]};await this[_0x2a2613(0xba)][_0x2a2613(0x153)](flosum_constants_1['FlosumConstants'][_0x2a2613(0xbc)]+'/'+constants_1[_0x2a2613(0x12e)]+_0x2a2613(0x144)+this['_snapshotId'],_0x2ffce4),await this[_0x2a2613(0xba)][_0x2a2613(0x153)](flosum_constants_1[_0x2a2613(0x115)][_0x2a2613(0xbc)]+'/'+constants_1['FLOSUM_NAMESPACE']+'Metadata_Log__c/'+this[_0x2a2613(0x141)],_0x5df4c0),this[_0x2a2613(0x163)][_0x2a2613(0xd0)](_0x2a2613(0xd2)+(_0x15355b?_0x2a2613(0xfe):_0x2a2613(0xf3))+'.'),await this['_logger']['updateLog']();}}exports[a257_0x31d5ce(0xe7)]=SnapshotService,SnapshotService[a257_0x31d5ce(0xc3)]=a257_0x31d5ce(0x113),SnapshotService['ATTACMENT']='Attachment';