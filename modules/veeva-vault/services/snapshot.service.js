const a313_0x38952=a313_0x47ed;(function(_0x352728,_0x113a35){const _0x20bd22=a313_0x47ed,_0x2317f8=_0x352728();while(!![]){try{const _0x369379=-parseInt(_0x20bd22(0x1f4))/0x1*(parseInt(_0x20bd22(0x19e))/0x2)+parseInt(_0x20bd22(0x194))/0x3*(-parseInt(_0x20bd22(0x1be))/0x4)+-parseInt(_0x20bd22(0x1ac))/0x5+-parseInt(_0x20bd22(0x1db))/0x6+parseInt(_0x20bd22(0x20f))/0x7+-parseInt(_0x20bd22(0x1a1))/0x8*(-parseInt(_0x20bd22(0x19f))/0x9)+parseInt(_0x20bd22(0x213))/0xa*(parseInt(_0x20bd22(0x1e9))/0xb);if(_0x369379===_0x113a35)break;else _0x2317f8['push'](_0x2317f8['shift']());}catch(_0x4ad33b){_0x2317f8['push'](_0x2317f8['shift']());}}}(a313_0x54f0,0x39148));const a313_0x4cbe81=(function(){let _0xf4dd83=!![];return function(_0x17551b,_0x2ce1b4){const _0x415de5=_0xf4dd83?function(){const _0x9ccd98=a313_0x47ed;if(_0x2ce1b4){const _0x34f5f1=_0x2ce1b4[_0x9ccd98(0x1de)](_0x17551b,arguments);return _0x2ce1b4=null,_0x34f5f1;}}:function(){};return _0xf4dd83=![],_0x415de5;};}()),a313_0x29512d=a313_0x4cbe81(this,function(){const _0x386caa=a313_0x47ed;return a313_0x29512d[_0x386caa(0x1a2)]()[_0x386caa(0x1d0)](_0x386caa(0x16d))[_0x386caa(0x1a2)]()[_0x386caa(0x17d)](a313_0x29512d)[_0x386caa(0x1d0)](_0x386caa(0x16d));});function a313_0x54f0(){const _0x373018=['successfully','deleteVeevaObjectRecords','77154QeHixZ','27ePbAqi','catch','624392czhUBv','toString','ceil','post','ENDPOINT_UPSERT_RECORD','Attachment','deletePackageComponents','join','_selectedMetaTypes','deleteOutboundPackages','VeevaComponentDto','25400ixepKR','\x27\x20AND\x20component_name__v\x20CONTAINS\x20(\x27','Metadata_Log__c/','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20CONTAINS\x20(\x27','../dtos/veeva-component.dto','get','selectedComponentMap','Attachment_ID__c','Snapshot__c','_snapshotId','MAXIMUM_SIZE_OF_PACKAGE','values','selectedMetaTypes','BUILD_WHERE_BY_NAME_LIMIT','errors','split','body','VeevaResponseStatus','1040084ertVXp','Veeva_Component_Type__c','Job_Completed__c','__esModule','rel','_metadataLogId','_selectedComponentMap','API_Name__c','_logger','name__v','files','reduce','formMetadataItemDtoList','responseStatus','application/x-www-form-urlencoded','packageName','length','veevaComponentType','search','inactive__v','VeevaService','label','map','__importDefault','createMetadataItemListWithBody','filter','has','Unpack\x20zip\x20and\x20create\x20metadata\x20items.','getComponentsMetadataByTypes','2532438PeerRr','./salesforce.service','ENDPOINT_VQL','apply','_attachmentLogId','saveAttachments','name','execute','updateLog','insertMultipleRecords','outbound_package__v','Saving\x20','application/json','arraybuffer','11qJAFJd','Create\x20Export\x20outbound\x20packages.','async','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','_connectionVeeva','base64','Removing\x20components\x20from\x20outbound\x20packages.','VeevaConstants','ENDPOINT_CREATE_RECORDS','migration__sys','chunkArray','3dsvbYF','retrieveVPKList','file','Snapshot__c/','Name__c','lastModifiedDate','executeVQL','Snapshot\x20started.','default','_systemLogger','patch','Label__c','createExportOutboundPackages','includes','Snapshot','log','MetadataLogStatus','../enums/status.enums','\x20from\x20outbound\x20package','Adding\x20components\x20to\x20outbound\x20package','snapshotId','Deleting\x20outbound\x20packages.','success','Getting\x20names\x20of\x20outbound\x20packages','error','Retrieve\x20collection\x20metadata\x20of\x20components\x20by\x20type\x20and\x20names','getJobResult','3076983BsEUzY','createOutboundPackages','Is_Error__c','ENDPOINT_EXPORT_IMPORT_PACKAGE','3629890hfGFTt','set','MetadataItemDto','apiName','logError','ATTACMENT','.mdl','exportOutboundPackage','artifacts','Last_Modified_Date__c','Is_Completed__c','(((.+)+)+)+$','generateAsync','with\x20error','Retrieve\x20Outbound\x20Package\x20zip\x20list','getComponentsMetadataByTypeAndName','formAttachments','./veeva.service','\x27,\x27','VeevaError','content-type','all','Cannot\x20retrieve\x20','getEndpointArtifactList','createPackageComponents','SalesforceDmlError','SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20=\x27','constructor','_connectionSalesforce','forEach','FlosumConstants','loadAsync','fill','isRetrieved','FLOSUM_NAMESPACE','Metadata_Item__c','../../shared/utils','saveComponentsInSalesforce','Succeed__c','Saving\x20Attachments.','SUCCESS','timeZone','createVeevaObjectRecords','SnapshotService','OUTBOUND_PACKAGE_NAME','getPackageNames','COMPLETED','attachmentId','package_component__v','../constants/flosum.constants','3DQqGNE','finishSnapshot','push','\x20Metadata\x20Items','../dtos/metadata-item.dto','executeManyVQL','links','Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20'];a313_0x54f0=function(){return _0x373018;};return a313_0x54f0();}a313_0x29512d();'use strict';var __importDefault=this&&this[a313_0x38952(0x1d5)]||function(_0x5a1ea0){const _0x301dbb=a313_0x38952;return _0x5a1ea0&&_0x5a1ea0[_0x301dbb(0x1c1)]?_0x5a1ea0:{'default':_0x5a1ea0};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a313_0x38952(0x18d)]=void 0x0;function a313_0x47ed(_0x553de5,_0x50c451){const _0x26048e=a313_0x54f0();return a313_0x47ed=function(_0x29512d,_0x4cbe81){_0x29512d=_0x29512d-0x164;let _0x54f029=_0x26048e[_0x29512d];return _0x54f029;},a313_0x47ed(_0x553de5,_0x50c451);}const jszip_1=__importDefault(require('jszip')),flosum_constants_1=require(a313_0x38952(0x193)),veeva_constants_1=require('../constants/veeva.constants'),veeva_service_1=require(a313_0x38952(0x173)),veeva_component_dto_1=require(a313_0x38952(0x1b0)),metadata_item_dto_1=require(a313_0x38952(0x198)),utils_1=require(a313_0x38952(0x186)),constants_1=require('../../../constants'),salesforce_service_1=require(a313_0x38952(0x1dc)),status_enums_1=require(a313_0x38952(0x205)),salesforce_dml_error_1=require('../classes/errors/salesforce-dml-error'),veeva_error_1=require('../classes/errors/veeva-error');class SnapshotService{constructor(_0x33c9b9,_0x7ed4e9,_0x4ce32d,_0x3ec9a1){const _0x2cfb9f=a313_0x38952;this[_0x2cfb9f(0x17e)]=_0x7ed4e9,this[_0x2cfb9f(0x1ed)]=_0x4ce32d,this[_0x2cfb9f(0x1c6)]=_0x3ec9a1,this[_0x2cfb9f(0x1b5)]=_0x33c9b9[_0x2cfb9f(0x208)],this[_0x2cfb9f(0x1c3)]=_0x33c9b9['metadataLogId'],this[_0x2cfb9f(0x1df)]=_0x33c9b9['attachmentLogId'],this['_timeZone']=_0x33c9b9[_0x2cfb9f(0x18b)],this['_selectedMetaTypes']=_0x33c9b9[_0x2cfb9f(0x1b8)],this[_0x2cfb9f(0x1c4)]=_0x33c9b9[_0x2cfb9f(0x1b2)];}async[a313_0x38952(0x1e2)](){const _0x243117=a313_0x38952;try{this[_0x243117(0x1c6)][_0x243117(0x203)](_0x243117(0x1fb));const _0x5d2cce=Array['from'](Object[_0x243117(0x1b7)](this[_0x243117(0x1c4)]))[_0x243117(0x1ce)]?await this['getComponentsMetadataByTypeAndName']():await this[_0x243117(0x1da)]();await this[_0x243117(0x1c6)][_0x243117(0x1e3)]();const _0x450cd5=await this[_0x243117(0x210)](Math[_0x243117(0x1a3)](_0x5d2cce['length']/veeva_constants_1[_0x243117(0x1f0)][_0x243117(0x1b6)])),_0x4a2010=await this[_0x243117(0x17a)](_0x5d2cce,_0x450cd5);await this[_0x243117(0x1c6)][_0x243117(0x1e3)]();const _0x42bc79=await this[_0x243117(0x169)](_0x450cd5),_0x52365a=await this[_0x243117(0x1d6)](_0x5d2cce,_0x42bc79);await this['saveComponentsInSalesforce'](_0x52365a),await this[_0x243117(0x1c6)]['updateLog'](),await this[_0x243117(0x1a7)](_0x4a2010),await this['deleteOutboundPackages'](_0x450cd5),await this['finishSnapshot'](!![]);}catch(_0x1e0e3c){this[_0x243117(0x1c6)]['logError'](_0x1e0e3c),await this[_0x243117(0x195)](![])[_0x243117(0x1a0)](_0x1f0c22=>this[_0x243117(0x1fd)][_0x243117(0x20c)](_0x1f0c22));}}async[a313_0x38952(0x1da)](){const _0xdc6842=a313_0x38952;this['_logger']['log']('Retrieve\x20collection\x20metadata\x20of\x20components');const _0xb66a39=[],_0x1f8851=_0xdc6842(0x1af)+this[_0xdc6842(0x1a9)][_0xdc6842(0x1a8)](_0xdc6842(0x174))+'\x27)',_0x567a4d=veeva_constants_1[_0xdc6842(0x1f0)][_0xdc6842(0x1dd)]+_0x1f8851,_0x432607=await veeva_service_1[_0xdc6842(0x1d2)][_0xdc6842(0x1fa)](_0x567a4d,this[_0xdc6842(0x1ed)]);for(const _0x1105dd of _0x432607){const _0x5a4aa7=new veeva_component_dto_1[(_0xdc6842(0x1ab))](_0x1105dd),{name:_0x4c0869,type:_0x26b263,status:_0xdbd66}=_0x5a4aa7;_0xdbd66['includes'](_0xdc6842(0x1d1))?this['_logger'][_0xdc6842(0x203)](_0xdc6842(0x19b)+_0x26b263+'.'+_0x4c0869):_0xb66a39[_0xdc6842(0x196)](_0x5a4aa7);}return _0xb66a39;}async[a313_0x38952(0x171)](){const _0xa6a987=a313_0x38952;this[_0xa6a987(0x1c6)]['log'](_0xa6a987(0x20d));const _0x188e34=[];for(const _0x4240dc in this['_selectedComponentMap']){const _0xdbc09d=(0x0,utils_1[_0xa6a987(0x1f3)])(this[_0xa6a987(0x1c4)][_0x4240dc],veeva_constants_1[_0xa6a987(0x1f0)][_0xa6a987(0x1b9)]),_0x868581=_0xdbc09d[_0xa6a987(0x1d4)](_0x399445=>veeva_constants_1[_0xa6a987(0x1f0)][_0xa6a987(0x1dd)]+(_0xa6a987(0x17c)+_0x4240dc+_0xa6a987(0x1ad)+_0x399445[_0xa6a987(0x1a8)](_0xa6a987(0x174))+'\x27)'));_0x188e34[_0xa6a987(0x196)](..._0x868581);}const _0x936715=[],_0x52c81e=await veeva_service_1[_0xa6a987(0x1d2)][_0xa6a987(0x199)](_0x188e34,this[_0xa6a987(0x1ed)]);for(const _0x555f96 of _0x52c81e){const _0x58c1c8=new veeva_component_dto_1[(_0xa6a987(0x1ab))](_0x555f96),{name:_0x1aa169,type:_0x59f62d,status:_0x1aecd9}=_0x58c1c8,_0x416497=_0x1aecd9[_0xa6a987(0x201)](_0xa6a987(0x1d1));_0x416497?this[_0xa6a987(0x1c6)][_0xa6a987(0x203)](_0xa6a987(0x19b)+_0x59f62d+'.'+_0x1aa169):_0x936715[_0xa6a987(0x196)](_0x58c1c8);}return _0x936715;}async[a313_0x38952(0x210)](_0x15e3c5){const _0xa14ad9=a313_0x38952;this[_0xa14ad9(0x1c6)][_0xa14ad9(0x203)]('Creating\x20outbound\x20packages');const _0x1d722b=veeva_constants_1[_0xa14ad9(0x1f0)][_0xa14ad9(0x1f1)]+_0xa14ad9(0x1e5),_0xee9eb2=new Array(_0x15e3c5)[_0xa14ad9(0x182)]({'summary__v':SnapshotService[_0xa14ad9(0x18e)],'object_type__v.api__name__v':_0xa14ad9(0x1f2)});return await veeva_service_1[_0xa14ad9(0x1d2)][_0xa14ad9(0x18c)](_0x1d722b,this['_connectionVeeva'],_0xee9eb2,this[_0xa14ad9(0x1c6)]);}async[a313_0x38952(0x17a)](_0x5c5dab,_0x57066c){const _0x44f3cd=a313_0x38952;this['_logger'][_0x44f3cd(0x203)](_0x44f3cd(0x207));const _0x2d0234=veeva_constants_1[_0x44f3cd(0x1f0)][_0x44f3cd(0x1f1)]+_0x44f3cd(0x192),_0x4dc9fe=_0x5c5dab['map']((_0x5311e3,_0x3eb602)=>({'vault_component__v':_0x5311e3['id'],'outbound_package__v':_0x57066c[Math['ceil']((_0x3eb602+0x1)/veeva_constants_1[_0x44f3cd(0x1f0)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await veeva_service_1[_0x44f3cd(0x1d2)][_0x44f3cd(0x18c)](_0x2d0234,this[_0x44f3cd(0x1ed)],_0x4dc9fe,this[_0x44f3cd(0x1c6)]);}async[a313_0x38952(0x169)](_0x36f20d){const _0x3ff88a=a313_0x38952,_0x1671d1=await this['getPackageNames'](_0x36f20d),_0x2a91a1=await this[_0x3ff88a(0x200)](Array['from'](_0x1671d1[_0x3ff88a(0x1b7)]())),_0x533e74=await this[_0x3ff88a(0x179)](_0x2a91a1);return await this['retrieveVPKList'](_0x533e74);}async[a313_0x38952(0x18f)](_0x4255c8){const _0x39c2e0=a313_0x38952;this[_0x39c2e0(0x1c6)][_0x39c2e0(0x203)](_0x39c2e0(0x20b));const _0x53d253=_0x39c2e0(0x1ec)+_0x4255c8['join'](_0x39c2e0(0x174))+'\x27)',_0x47089f=veeva_constants_1[_0x39c2e0(0x1f0)]['ENDPOINT_VQL']+_0x53d253,_0x78a37e=await veeva_service_1[_0x39c2e0(0x1d2)][_0x39c2e0(0x1fa)](_0x47089f,this[_0x39c2e0(0x1ed)]);return _0x78a37e['reduce']((_0x3c6889,_0x1c9e35)=>_0x3c6889[_0x39c2e0(0x214)](_0x1c9e35['id'],_0x1c9e35[_0x39c2e0(0x1c7)]),new Map());}async['createExportOutboundPackages'](_0x5c2c80){const _0x5c9af1=a313_0x38952;this[_0x5c9af1(0x1c6)][_0x5c9af1(0x203)](_0x5c9af1(0x1ea));const _0x4f7571=[],_0x2f21a2=_0x5c2c80[_0x5c9af1(0x1d4)](_0x5d77c1=>{const _0x933f8a=_0x5c9af1;return this[_0x933f8a(0x1ed)][_0x933f8a(0x1a4)](veeva_constants_1[_0x933f8a(0x1f0)][_0x933f8a(0x212)],encodeURI(_0x933f8a(0x1cd))+'='+encodeURI(_0x5d77c1),{'headers':{'Content-Type':_0x933f8a(0x1cc)}});}),_0x5938da=await Promise[_0x5c9af1(0x177)](_0x2f21a2);for(const {data:_0x2fc748}of _0x5938da){if(_0x2fc748[_0x5c9af1(0x1cb)]===status_enums_1[_0x5c9af1(0x1bd)][_0x5c9af1(0x18a)]){const {url:_0x729d6e}=_0x2fc748;_0x4f7571[_0x5c9af1(0x196)](_0x729d6e);}else throw new veeva_error_1['VeevaError'](_0x2fc748[_0x5c9af1(0x1ba)]);}return _0x4f7571;}async[a313_0x38952(0x179)](_0xab9ca6){const _0x46ed9b=a313_0x38952;this[_0x46ed9b(0x1c6)][_0x46ed9b(0x203)]('Retrieve\x20Jobs\x20Status');const _0x88142=[],_0x21a608=await veeva_service_1[_0x46ed9b(0x1d2)][_0x46ed9b(0x20e)](_0xab9ca6,this['_connectionVeeva'],this[_0x46ed9b(0x1c6)]);for(const _0x1b2faf of _0x21a608){const _0x53b557=_0x1b2faf[_0x46ed9b(0x19a)][_0x46ed9b(0x1d7)](_0x1f21e2=>_0x1f21e2[_0x46ed9b(0x1c2)]===_0x46ed9b(0x16a))[_0x46ed9b(0x1d4)](_0x21fc50=>_0x21fc50['href']);_0x88142[_0x46ed9b(0x196)](..._0x53b557);}return _0x88142;}async[a313_0x38952(0x1f5)](_0x3442a4){const _0x4e40cf=a313_0x38952;var _0x1f2b3b;const _0x1c7cbe=[];this[_0x4e40cf(0x1c6)][_0x4e40cf(0x203)](_0x4e40cf(0x170));for(const _0x406da1 of _0x3442a4){const {data:_0x2403e8,headers:_0x1530dd}=await this[_0x4e40cf(0x1ed)][_0x4e40cf(0x1b1)](_0x406da1,{'responseType':_0x4e40cf(0x1e8)}),_0x420cf3=(_0x1f2b3b=_0x1530dd[_0x4e40cf(0x176)])===null||_0x1f2b3b===void 0x0?void 0x0:_0x1f2b3b['includes'](_0x4e40cf(0x1e7));if(!_0x420cf3){const _0x2e7821=_0x2403e8,_0x58b7c1=new jszip_1[(_0x4e40cf(0x1fc))]();await _0x58b7c1[_0x4e40cf(0x181)](_0x2e7821),_0x1c7cbe[_0x4e40cf(0x196)](_0x58b7c1);}else{const _0x129d80=JSON['parse'](_0x2403e8);throw new veeva_error_1[(_0x4e40cf(0x175))](_0x129d80['errors']);}}return _0x1c7cbe;}async['createMetadataItemListWithBody'](_0x470ec6,_0x76529b){const _0x19bc3b=a313_0x38952;var _0x4ad7a8;this[_0x19bc3b(0x1c6)][_0x19bc3b(0x203)](_0x19bc3b(0x1d9));const _0x5ba5ab=this[_0x19bc3b(0x1ca)](_0x470ec6),_0x58190c=_0x5ba5ab[_0x19bc3b(0x1c9)]((_0x584978,_0x11629c)=>_0x584978['set'](_0x11629c['label'],_0x11629c),new Map());for(const _0x578684 of _0x76529b){for(const _0x1f666f in _0x578684[_0x19bc3b(0x1c8)]){const _0x800e04=_0x1f666f[_0x19bc3b(0x1bb)]('/')['at'](-0x1);if(_0x58190c[_0x19bc3b(0x1d8)](_0x800e04)){const _0x47c7b5=await((_0x4ad7a8=_0x578684[_0x19bc3b(0x1f6)](_0x1f666f))===null||_0x4ad7a8===void 0x0?void 0x0:_0x4ad7a8[_0x19bc3b(0x1eb)]('string'));if(_0x47c7b5){const _0x2535d8=new jszip_1[(_0x19bc3b(0x1fc))]();_0x2535d8[_0x19bc3b(0x1f6)](_0x800e04,_0x47c7b5),_0x58190c[_0x19bc3b(0x1b1)](_0x800e04)[_0x19bc3b(0x1bc)]=await _0x2535d8[_0x19bc3b(0x16e)]({'type':_0x19bc3b(0x1ee)});}}}}return _0x5ba5ab[_0x19bc3b(0x1d7)](_0xb5cb5f=>!_0xb5cb5f[_0x19bc3b(0x1bc)])['forEach'](_0x342139=>{const _0x56e125=_0x19bc3b;this[_0x56e125(0x1c6)][_0x56e125(0x203)](_0x56e125(0x178)+_0x342139[_0x56e125(0x1cf)]+'.'+_0x342139['name']+_0x56e125(0x206));}),_0x5ba5ab['filter'](_0x52336e=>_0x52336e['body']);}[a313_0x38952(0x1ca)](_0x1b3c93){return _0x1b3c93['map'](_0x314dda=>{const _0x5046d8=a313_0x47ed,_0x1d8cc0=new metadata_item_dto_1[(_0x5046d8(0x164))]();return _0x1d8cc0[_0x5046d8(0x1e1)]=_0x314dda[_0x5046d8(0x1e1)],_0x1d8cc0['apiName']=_0x314dda['name'],_0x1d8cc0[_0x5046d8(0x208)]=this[_0x5046d8(0x1b5)],_0x1d8cc0[_0x5046d8(0x1d3)]=_0x314dda['type']+'.'+_0x314dda[_0x5046d8(0x1e1)]+_0x5046d8(0x168),_0x1d8cc0[_0x5046d8(0x1cf)]=_0x314dda['type'],_0x1d8cc0['lastModifiedDate']=_0x314dda[_0x5046d8(0x1f9)],_0x1d8cc0['isRetrieved']=![],_0x1d8cc0;});}async[a313_0x38952(0x1a7)](_0x3a49c6){const _0x334be1=a313_0x38952;this['_logger']['log'](_0x334be1(0x1ef));const _0x2ba183=veeva_constants_1[_0x334be1(0x1f0)][_0x334be1(0x1f1)]+'package_component__v';await veeva_service_1[_0x334be1(0x1d2)][_0x334be1(0x19d)](_0x2ba183,this[_0x334be1(0x1ed)],_0x3a49c6,this[_0x334be1(0x1c6)]);}async[a313_0x38952(0x1aa)](_0x1d462a){const _0x5f4ac5=a313_0x38952;this['_logger'][_0x5f4ac5(0x203)](_0x5f4ac5(0x209));const _0x1d9d6d=veeva_constants_1[_0x5f4ac5(0x1f0)][_0x5f4ac5(0x1f1)]+'outbound_package__v';await veeva_service_1['VeevaService'][_0x5f4ac5(0x19d)](_0x1d9d6d,this[_0x5f4ac5(0x1ed)],_0x1d462a,this[_0x5f4ac5(0x1c6)]);}async[a313_0x38952(0x187)](_0x378813){const _0x39e670=a313_0x38952;this[_0x39e670(0x1c6)][_0x39e670(0x203)](_0x39e670(0x189)),await this[_0x39e670(0x1e0)](_0x378813),this[_0x39e670(0x1c6)][_0x39e670(0x203)]('Saving\x20'+_0x378813[_0x39e670(0x1ce)]+_0x39e670(0x197));const _0x8f8397=_0x378813[_0x39e670(0x1d4)](_0x5712c3=>{const _0x4e382e=_0x39e670;return{[constants_1[_0x4e382e(0x184)]+_0x4e382e(0x1f8)]:_0x5712c3[_0x4e382e(0x1e1)],[constants_1[_0x4e382e(0x184)]+_0x4e382e(0x1c5)]:_0x5712c3[_0x4e382e(0x165)],[constants_1[_0x4e382e(0x184)]+_0x4e382e(0x1b4)]:_0x5712c3['snapshotId'],[constants_1['FLOSUM_NAMESPACE']+_0x4e382e(0x1ff)]:_0x5712c3[_0x4e382e(0x1d3)],[constants_1[_0x4e382e(0x184)]+'Is_Retrieved__c']:_0x5712c3['isRetrieved'],[constants_1[_0x4e382e(0x184)]+_0x4e382e(0x1bf)]:_0x5712c3['veevaComponentType'],[constants_1['FLOSUM_NAMESPACE']+_0x4e382e(0x1b3)]:_0x5712c3['attachmentId'],[constants_1['FLOSUM_NAMESPACE']+_0x4e382e(0x16b)]:_0x5712c3[_0x4e382e(0x1f9)]};}),_0xd75346=await salesforce_service_1['SalesforceService'][_0x39e670(0x1e4)](this[_0x39e670(0x17e)],constants_1[_0x39e670(0x184)]+_0x39e670(0x185),_0x8f8397);let _0x1b31a1=!![];_0xd75346[_0x39e670(0x17f)]((_0x48ac54,_0x5adfad)=>{const _0x2d1280=_0x39e670;this[_0x2d1280(0x1c6)][_0x2d1280(0x203)](_0x2d1280(0x1e6)+_0x378813[_0x5adfad][_0x2d1280(0x1cf)]+'.'+_0x378813[_0x5adfad][_0x2d1280(0x1e1)]);if(!_0x48ac54[_0x2d1280(0x20a)]){_0x1b31a1=![];const _0x62ed2b=new salesforce_dml_error_1[(_0x2d1280(0x17b))](_0x48ac54[_0x2d1280(0x1ba)]);this[_0x2d1280(0x1c6)][_0x2d1280(0x166)](_0x62ed2b);}});if(!_0x1b31a1)throw new Error('Cannot\x20Save\x20Metadata\x20Items');}async['saveAttachments'](_0x47e1cc){const _0x847dc1=a313_0x38952,_0x50f6ba=this[_0x847dc1(0x172)](_0x47e1cc),_0x26e582=await salesforce_service_1['SalesforceService']['insertMultipleRecords'](this['_connectionSalesforce'],SnapshotService[_0x847dc1(0x167)],_0x50f6ba),_0x547630=[];_0x26e582[_0x847dc1(0x17f)]((_0x5b5fa3,_0x23a564)=>{const _0x1e8186=_0x847dc1;_0x5b5fa3[_0x1e8186(0x20a)]?(_0x47e1cc[_0x23a564][_0x1e8186(0x191)]=_0x5b5fa3['id'],_0x47e1cc[_0x23a564][_0x1e8186(0x183)]=!![]):_0x547630[_0x1e8186(0x196)](..._0x5b5fa3[_0x1e8186(0x1ba)]);});if(_0x547630[_0x847dc1(0x1ce)])throw new salesforce_dml_error_1['SalesforceDmlError'](_0x547630);}[a313_0x38952(0x172)](_0x552816){const _0x4dad47=a313_0x38952;return _0x552816[_0x4dad47(0x1d4)](_0x29219b=>({'ParentId':this[_0x4dad47(0x1b5)],'Name':_0x29219b['veevaComponentType'],'ContentType':'application/zip','Body':_0x29219b[_0x4dad47(0x1bc)],'Description':_0x29219b['veevaComponentType']}));}async['finishSnapshot'](_0x1e2168){const _0x41d896=a313_0x38952,_0xcc725={[constants_1[_0x41d896(0x184)]+_0x41d896(0x16c)]:!![],[constants_1[_0x41d896(0x184)]+_0x41d896(0x211)]:!_0x1e2168},_0x2825fc={[constants_1[_0x41d896(0x184)]+_0x41d896(0x211)]:!_0x1e2168,[constants_1[_0x41d896(0x184)]+_0x41d896(0x188)]:_0x1e2168,[constants_1[_0x41d896(0x184)]+'Status__c']:_0x1e2168?status_enums_1[_0x41d896(0x204)][_0x41d896(0x190)]:status_enums_1[_0x41d896(0x204)]['EXCEPTION'],[constants_1[_0x41d896(0x184)]+_0x41d896(0x1c0)]:!![]};await this[_0x41d896(0x17e)][_0x41d896(0x1fe)](flosum_constants_1['FlosumConstants'][_0x41d896(0x1a5)]+'/'+constants_1[_0x41d896(0x184)]+_0x41d896(0x1f7)+this[_0x41d896(0x1b5)],_0xcc725),await this[_0x41d896(0x17e)][_0x41d896(0x1fe)](flosum_constants_1[_0x41d896(0x180)]['ENDPOINT_UPSERT_RECORD']+'/'+constants_1[_0x41d896(0x184)]+_0x41d896(0x1ae)+this['_metadataLogId'],_0x2825fc),this[_0x41d896(0x1c6)][_0x41d896(0x203)]('Snapshot\x20completed\x20'+(_0x1e2168?_0x41d896(0x19c):_0x41d896(0x16f))+'.'),await this[_0x41d896(0x1c6)][_0x41d896(0x1e3)]();}}exports[a313_0x38952(0x18d)]=SnapshotService,SnapshotService['OUTBOUND_PACKAGE_NAME']=a313_0x38952(0x202),SnapshotService[a313_0x38952(0x167)]=a313_0x38952(0x1a6);