const a312_0x49e7d6=a312_0xa4ae;(function(_0x339f28,_0x50555e){const _0x1bc64e=a312_0xa4ae,_0x19599b=_0x339f28();while(!![]){try{const _0x3b8297=parseInt(_0x1bc64e(0x11a))/0x1+-parseInt(_0x1bc64e(0x99))/0x2*(parseInt(_0x1bc64e(0x90))/0x3)+parseInt(_0x1bc64e(0xe9))/0x4+parseInt(_0x1bc64e(0xe8))/0x5+parseInt(_0x1bc64e(0xa7))/0x6+-parseInt(_0x1bc64e(0xa8))/0x7+parseInt(_0x1bc64e(0xea))/0x8*(-parseInt(_0x1bc64e(0x11c))/0x9);if(_0x3b8297===_0x50555e)break;else _0x19599b['push'](_0x19599b['shift']());}catch(_0x35907a){_0x19599b['push'](_0x19599b['shift']());}}}(a312_0xee07,0x7982e));const a312_0x14f831=(function(){let _0x6329d4=!![];return function(_0x4905ec,_0x4eb6c8){const _0x58af23=_0x6329d4?function(){if(_0x4eb6c8){const _0x385380=_0x4eb6c8['apply'](_0x4905ec,arguments);return _0x4eb6c8=null,_0x385380;}}:function(){};return _0x6329d4=![],_0x58af23;};}()),a312_0x38057c=a312_0x14f831(this,function(){const _0x156f09=a312_0xa4ae;return a312_0x38057c[_0x156f09(0xd1)]()[_0x156f09(0x126)](_0x156f09(0x12b))[_0x156f09(0xd1)]()[_0x156f09(0xeb)](a312_0x38057c)[_0x156f09(0x126)](_0x156f09(0x12b));});a312_0x38057c();'use strict';function a312_0xee07(){const _0x433c25=['push','\x27,\x27','label','Last_Modified_Date__c','SnapshotService','executeManyVQL','VeevaResponseStatus','Metadata_Log__c/','_attachmentLogId','EXCEPTION','Snapshot__c','parse','name__v','ATTACMENT','../enums/status.enums','_selectedComponentMap','createMetadataItemListWithBody','lastModifiedDate','files','MetadataItemDto','saveComponentsInSalesforce','Name__c','body','package_component__v','VeevaError','Veeva_Component_Type__c','deleteOutboundPackages','async','OUTBOUND_PACKAGE_NAME','Snapshot__c/','getJobResult','all','ENDPOINT_CREATE_RECORDS','length','Creating\x20outbound\x20packages','createVeevaObjectRecords','map','toString','Retrieve\x20Jobs\x20Status','exportOutboundPackage','getPackageNames','_connectionVeeva','FlosumConstants','string','selectedMetaTypes','catch','createOutboundPackages','Retrieve\x20Outbound\x20Package\x20zip\x20list','logError','Deleting\x20outbound\x20packages.','snapshotId','Saving\x20','forEach','filter','successfully','createExportOutboundPackages','attachmentId','rel','formMetadataItemDtoList','\x27\x20AND\x20component_name__v\x20CONTAINS\x20(\x27','165960ZhGEHC','1785412JXjUpp','24aFmjdh','constructor','Succeed__c','Is_Error__c','file','insertMultipleRecords','Cannot\x20Save\x20Metadata\x20Items','../constants/veeva.constants','type','SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20=\x27','getComponentsMetadataByTypeAndName','join','get','_selectedMetaTypes','outbound_package__v','responseStatus','application/x-www-form-urlencoded','with\x20error','Is_Retrieved__c','base64','Create\x20Export\x20outbound\x20packages.','isRetrieved','deleteVeevaObjectRecords','split','Retrieve\x20collection\x20metadata\x20of\x20components\x20by\x20type\x20and\x20names','./salesforce.service','Unpack\x20zip\x20and\x20create\x20metadata\x20items.','executeVQL','from','packageName','errors','Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20','../dtos/veeva-component.dto','jszip','artifacts','_connectionSalesforce','getEndpointArtifactList','BUILD_WHERE_BY_NAME_LIMIT','attachmentLogId','timeZone','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20CONTAINS\x20(\x27','Job_Completed__c','ENDPOINT_VQL','retrieveVPKList','metadataLogId','SalesforceDmlError','./veeva.service','default','684048lwKiEs','SUCCESS','1730682sjQCyF','Attachment','generateAsync','values','patch','VeevaConstants','Removing\x20components\x20from\x20outbound\x20packages.','FLOSUM_NAMESPACE','Attachment_ID__c','_metadataLogId','search','reduce','getComponentsMetadataByTypes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','_snapshotId','(((.+)+)+)+$','log','fill','loadAsync','name','saveAttachments','__esModule','Saving\x20Attachments.','veevaComponentType','updateLog','SalesforceService','formAttachments','15qulsWZ','../classes/errors/veeva-error','inactive__v','ENDPOINT_UPSERT_RECORD','../dtos/metadata-item.dto','Snapshot\x20completed\x20','deletePackageComponents','VeevaService','_logger','68694YoqtMA','ceil','finishSnapshot','includes','Metadata_Item__c','set','apiName','success','\x20from\x20outbound\x20package','post','migration__sys','chunkArray','Snapshot\x20started.','Adding\x20components\x20to\x20outbound\x20package','1759170OIucfU','1473143iQAWop','_timeZone','../constants/flosum.constants','MetadataLogStatus'];a312_0xee07=function(){return _0x433c25;};return a312_0xee07();}var __importDefault=this&&this['__importDefault']||function(_0x9fccf5){const _0x341a24=a312_0xa4ae;return _0x9fccf5&&_0x9fccf5[_0x341a24(0x8a)]?_0x9fccf5:{'default':_0x9fccf5};};Object['defineProperty'](exports,a312_0x49e7d6(0x8a),{'value':!![]}),exports['SnapshotService']=void 0x0;const jszip_1=__importDefault(require(a312_0x49e7d6(0x10b))),flosum_constants_1=require(a312_0x49e7d6(0xaa)),veeva_constants_1=require(a312_0x49e7d6(0xf1)),veeva_service_1=require(a312_0x49e7d6(0x118)),veeva_component_dto_1=require(a312_0x49e7d6(0x10a)),metadata_item_dto_1=require(a312_0x49e7d6(0x94)),utils_1=require('../../shared/utils'),constants_1=require('../../../constants'),salesforce_service_1=require(a312_0x49e7d6(0x103)),status_enums_1=require(a312_0x49e7d6(0xba)),salesforce_dml_error_1=require('../classes/errors/salesforce-dml-error'),veeva_error_1=require(a312_0x49e7d6(0x91));function a312_0xa4ae(_0x1e4dc7,_0x2351bc){const _0xc3d769=a312_0xee07();return a312_0xa4ae=function(_0x38057c,_0x14f831){_0x38057c=_0x38057c-0x85;let _0xee0758=_0xc3d769[_0x38057c];return _0xee0758;},a312_0xa4ae(_0x1e4dc7,_0x2351bc);}class SnapshotService{constructor(_0xb76658,_0x17de74,_0x3af1e2,_0x361313){const _0x4f1129=a312_0x49e7d6;this[_0x4f1129(0x10d)]=_0x17de74,this[_0x4f1129(0xd5)]=_0x3af1e2,this[_0x4f1129(0x98)]=_0x361313,this['_snapshotId']=_0xb76658[_0x4f1129(0xde)],this['_metadataLogId']=_0xb76658[_0x4f1129(0x116)],this[_0x4f1129(0xb4)]=_0xb76658[_0x4f1129(0x110)],this[_0x4f1129(0xa9)]=_0xb76658[_0x4f1129(0x111)],this[_0x4f1129(0xf7)]=_0xb76658[_0x4f1129(0xd8)],this[_0x4f1129(0xbb)]=_0xb76658['selectedComponentMap'];}async['execute'](){const _0x528718=a312_0x49e7d6;try{this[_0x528718(0x98)][_0x528718(0x85)](_0x528718(0xa5));const _0xcb334=Array[_0x528718(0x106)](Object[_0x528718(0x11f)](this[_0x528718(0xbb)]))['length']?await this[_0x528718(0xf4)]():await this[_0x528718(0x128)]();await this['_logger'][_0x528718(0x8d)]();const _0x2ff975=await this[_0x528718(0xda)](Math[_0x528718(0x9a)](_0xcb334['length']/veeva_constants_1[_0x528718(0x121)]['MAXIMUM_SIZE_OF_PACKAGE'])),_0x46d134=await this['createPackageComponents'](_0xcb334,_0x2ff975);await this[_0x528718(0x98)][_0x528718(0x8d)]();const _0x2bfeaa=await this[_0x528718(0xd3)](_0x2ff975),_0x408308=await this[_0x528718(0xbc)](_0xcb334,_0x2bfeaa);await this['saveComponentsInSalesforce'](_0x408308),await this[_0x528718(0x98)][_0x528718(0x8d)](),await this[_0x528718(0x96)](_0x46d134),await this[_0x528718(0xc6)](_0x2ff975),await this['finishSnapshot'](!![]);}catch(_0x3cac90){this[_0x528718(0x98)]['logError'](_0x3cac90),await this[_0x528718(0x9b)](![])[_0x528718(0xd9)](_0x5be4e4=>this['_systemLogger']['error'](_0x5be4e4));}}async[a312_0x49e7d6(0x128)](){const _0x22f000=a312_0x49e7d6;this['_logger'][_0x22f000(0x85)]('Retrieve\x20collection\x20metadata\x20of\x20components');const _0x408e66=[],_0x4ca5c5=_0x22f000(0x112)+this[_0x22f000(0xf7)]['join'](_0x22f000(0xad))+'\x27)',_0x51b99c=veeva_constants_1[_0x22f000(0x121)]['ENDPOINT_VQL']+_0x4ca5c5,_0x2af477=await veeva_service_1[_0x22f000(0x97)][_0x22f000(0x105)](_0x51b99c,this[_0x22f000(0xd5)]);for(const _0xd536c4 of _0x2af477){const _0x12e786=new veeva_component_dto_1['VeevaComponentDto'](_0xd536c4),{name:_0x26c67b,type:_0xd20946,status:_0x3f342a}=_0x12e786;_0x3f342a[_0x22f000(0x9c)](_0x22f000(0x92))?this[_0x22f000(0x98)][_0x22f000(0x85)](_0x22f000(0x109)+_0xd20946+'.'+_0x26c67b):_0x408e66['push'](_0x12e786);}return _0x408e66;}async[a312_0x49e7d6(0xf4)](){const _0xf144ac=a312_0x49e7d6;this[_0xf144ac(0x98)][_0xf144ac(0x85)](_0xf144ac(0x102));const _0x58b91e=[];for(const _0x473270 in this[_0xf144ac(0xbb)]){const _0x53ffb2=(0x0,utils_1[_0xf144ac(0xa4)])(this[_0xf144ac(0xbb)][_0x473270],veeva_constants_1['VeevaConstants'][_0xf144ac(0x10f)]),_0x21e0a0=_0x53ffb2[_0xf144ac(0xd0)](_0x1f6fbb=>veeva_constants_1[_0xf144ac(0x121)][_0xf144ac(0x114)]+(_0xf144ac(0xf3)+_0x473270+_0xf144ac(0xe7)+_0x1f6fbb[_0xf144ac(0xf5)](_0xf144ac(0xad))+'\x27)'));_0x58b91e[_0xf144ac(0xac)](..._0x21e0a0);}const _0xdaf666=[],_0x10bd89=await veeva_service_1['VeevaService'][_0xf144ac(0xb1)](_0x58b91e,this['_connectionVeeva']);for(const _0xab8b81 of _0x10bd89){const _0x4a8530=new veeva_component_dto_1['VeevaComponentDto'](_0xab8b81),{name:_0x5bdbac,type:_0x3b3fb5,status:_0x45e261}=_0x4a8530,_0x273af1=_0x45e261[_0xf144ac(0x9c)](_0xf144ac(0x92));_0x273af1?this[_0xf144ac(0x98)]['log']('Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20'+_0x3b3fb5+'.'+_0x5bdbac):_0xdaf666[_0xf144ac(0xac)](_0x4a8530);}return _0xdaf666;}async[a312_0x49e7d6(0xda)](_0x54ad41){const _0x35d124=a312_0x49e7d6;this[_0x35d124(0x98)][_0x35d124(0x85)](_0x35d124(0xce));const _0x1fb0b1=veeva_constants_1[_0x35d124(0x121)][_0x35d124(0xcc)]+_0x35d124(0xf8),_0x1e143c=new Array(_0x54ad41)[_0x35d124(0x86)]({'summary__v':SnapshotService[_0x35d124(0xc8)],'object_type__v.api__name__v':_0x35d124(0xa3)});return await veeva_service_1[_0x35d124(0x97)][_0x35d124(0xcf)](_0x1fb0b1,this[_0x35d124(0xd5)],_0x1e143c,this[_0x35d124(0x98)]);}async['createPackageComponents'](_0x1db650,_0x2166e9){const _0xb5465=a312_0x49e7d6;this[_0xb5465(0x98)]['log'](_0xb5465(0xa6));const _0x123214=veeva_constants_1['VeevaConstants'][_0xb5465(0xcc)]+'package_component__v',_0x59de45=_0x1db650['map']((_0x17d13f,_0x59de86)=>({'vault_component__v':_0x17d13f['id'],'outbound_package__v':_0x2166e9[Math[_0xb5465(0x9a)]((_0x59de86+0x1)/veeva_constants_1[_0xb5465(0x121)]['MAXIMUM_SIZE_OF_PACKAGE'])-0x1]}));return await veeva_service_1[_0xb5465(0x97)]['createVeevaObjectRecords'](_0x123214,this[_0xb5465(0xd5)],_0x59de45,this[_0xb5465(0x98)]);}async[a312_0x49e7d6(0xd3)](_0x36d0a5){const _0x160bb4=a312_0x49e7d6,_0x3e3bb7=await this['getPackageNames'](_0x36d0a5),_0x2af3b3=await this[_0x160bb4(0xe3)](Array['from'](_0x3e3bb7['values']())),_0x5a35b2=await this['getEndpointArtifactList'](_0x2af3b3);return await this['retrieveVPKList'](_0x5a35b2);}async[a312_0x49e7d6(0xd4)](_0x506283){const _0x2f3f6a=a312_0x49e7d6;this['_logger'][_0x2f3f6a(0x85)]('Getting\x20names\x20of\x20outbound\x20packages');const _0x12d22d=_0x2f3f6a(0x129)+_0x506283[_0x2f3f6a(0xf5)](_0x2f3f6a(0xad))+'\x27)',_0x4e083d=veeva_constants_1[_0x2f3f6a(0x121)][_0x2f3f6a(0x114)]+_0x12d22d,_0x40206c=await veeva_service_1[_0x2f3f6a(0x97)][_0x2f3f6a(0x105)](_0x4e083d,this[_0x2f3f6a(0xd5)]);return _0x40206c[_0x2f3f6a(0x127)]((_0x2efec5,_0x388969)=>_0x2efec5[_0x2f3f6a(0x9e)](_0x388969['id'],_0x388969[_0x2f3f6a(0xb8)]),new Map());}async[a312_0x49e7d6(0xe3)](_0x399d00){const _0x36e640=a312_0x49e7d6;this[_0x36e640(0x98)]['log'](_0x36e640(0xfe));const _0x4472ee=[],_0x12e298=_0x399d00[_0x36e640(0xd0)](_0x3d393d=>{const _0x44f91d=_0x36e640;return this[_0x44f91d(0xd5)][_0x44f91d(0xa2)](veeva_constants_1[_0x44f91d(0x121)]['ENDPOINT_EXPORT_IMPORT_PACKAGE'],encodeURI(_0x44f91d(0x107))+'='+encodeURI(_0x3d393d),{'headers':{'Content-Type':_0x44f91d(0xfa)}});}),_0x2e886=await Promise[_0x36e640(0xcb)](_0x12e298);for(const {data:_0x3145a0}of _0x2e886){if(_0x3145a0[_0x36e640(0xf9)]===status_enums_1[_0x36e640(0xb2)][_0x36e640(0x11b)]){const {url:_0x409164}=_0x3145a0;_0x4472ee[_0x36e640(0xac)](_0x409164);}else throw new veeva_error_1[(_0x36e640(0xc4))](_0x3145a0[_0x36e640(0x108)]);}return _0x4472ee;}async[a312_0x49e7d6(0x10e)](_0x25ca7c){const _0x5b55fc=a312_0x49e7d6;this[_0x5b55fc(0x98)][_0x5b55fc(0x85)](_0x5b55fc(0xd2));const _0x1a286c=[],_0x365b5b=await veeva_service_1['VeevaService'][_0x5b55fc(0xca)](_0x25ca7c,this['_connectionVeeva'],this[_0x5b55fc(0x98)]);for(const _0x560921 of _0x365b5b){const _0x20b6fc=_0x560921['links'][_0x5b55fc(0xe1)](_0x47c582=>_0x47c582[_0x5b55fc(0xe5)]===_0x5b55fc(0x10c))['map'](_0x4f50e1=>_0x4f50e1['href']);_0x1a286c['push'](..._0x20b6fc);}return _0x1a286c;}async[a312_0x49e7d6(0x115)](_0x3d23cc){const _0x2933d9=a312_0x49e7d6;var _0xc9cf32;const _0x45e183=[];this[_0x2933d9(0x98)][_0x2933d9(0x85)](_0x2933d9(0xdb));for(const _0x4d02d8 of _0x3d23cc){const {data:_0x1c64db,headers:_0x43d3d3}=await this['_connectionVeeva'][_0x2933d9(0xf6)](_0x4d02d8,{'responseType':'arraybuffer'}),_0x20a4ce=(_0xc9cf32=_0x43d3d3['content-type'])===null||_0xc9cf32===void 0x0?void 0x0:_0xc9cf32[_0x2933d9(0x9c)]('application/json');if(!_0x20a4ce){const _0x1820ab=_0x1c64db,_0x39c4d8=new jszip_1[(_0x2933d9(0x119))]();await _0x39c4d8[_0x2933d9(0x87)](_0x1820ab),_0x45e183[_0x2933d9(0xac)](_0x39c4d8);}else{const _0x4c23d4=JSON[_0x2933d9(0xb7)](_0x1c64db);throw new veeva_error_1[(_0x2933d9(0xc4))](_0x4c23d4[_0x2933d9(0x108)]);}}return _0x45e183;}async[a312_0x49e7d6(0xbc)](_0x45f6d9,_0x31e202){const _0x57ccd0=a312_0x49e7d6;var _0x25aac4;this[_0x57ccd0(0x98)][_0x57ccd0(0x85)](_0x57ccd0(0x104));const _0x1e75cd=this[_0x57ccd0(0xe6)](_0x45f6d9),_0x338add=_0x1e75cd[_0x57ccd0(0x127)]((_0x3ed461,_0x241d17)=>_0x3ed461[_0x57ccd0(0x9e)](_0x241d17[_0x57ccd0(0xae)],_0x241d17),new Map());for(const _0x2db7a2 of _0x31e202){for(const _0x44a309 in _0x2db7a2[_0x57ccd0(0xbe)]){const _0x726254=_0x44a309[_0x57ccd0(0x101)]('/')['at'](-0x1);if(_0x338add['has'](_0x726254)){const _0x184664=await((_0x25aac4=_0x2db7a2['file'](_0x44a309))===null||_0x25aac4===void 0x0?void 0x0:_0x25aac4[_0x57ccd0(0xc7)](_0x57ccd0(0xd7)));if(_0x184664){const _0x3ba8db=new jszip_1[(_0x57ccd0(0x119))]();_0x3ba8db[_0x57ccd0(0xee)](_0x726254,_0x184664),_0x338add['get'](_0x726254)['body']=await _0x3ba8db[_0x57ccd0(0x11e)]({'type':_0x57ccd0(0xfd)});}}}}return _0x1e75cd[_0x57ccd0(0xe1)](_0x458b27=>!_0x458b27[_0x57ccd0(0xc2)])[_0x57ccd0(0xe0)](_0x5d75e2=>{const _0x2ae80b=_0x57ccd0;this[_0x2ae80b(0x98)][_0x2ae80b(0x85)]('Cannot\x20retrieve\x20'+_0x5d75e2[_0x2ae80b(0x8c)]+'.'+_0x5d75e2[_0x2ae80b(0x88)]+_0x2ae80b(0xa1));}),_0x1e75cd[_0x57ccd0(0xe1)](_0x1dd304=>_0x1dd304['body']);}['formMetadataItemDtoList'](_0x13cb89){const _0x2f8849=a312_0x49e7d6;return _0x13cb89[_0x2f8849(0xd0)](_0x39ecc1=>{const _0x1a138b=_0x2f8849,_0x5d6ce0=new metadata_item_dto_1[(_0x1a138b(0xbf))]();return _0x5d6ce0['name']=_0x39ecc1[_0x1a138b(0x88)],_0x5d6ce0[_0x1a138b(0x9f)]=_0x39ecc1['name'],_0x5d6ce0['snapshotId']=this['_snapshotId'],_0x5d6ce0[_0x1a138b(0xae)]=_0x39ecc1[_0x1a138b(0xf2)]+'.'+_0x39ecc1['name']+'.mdl',_0x5d6ce0[_0x1a138b(0x8c)]=_0x39ecc1[_0x1a138b(0xf2)],_0x5d6ce0[_0x1a138b(0xbd)]=_0x39ecc1[_0x1a138b(0xbd)],_0x5d6ce0['isRetrieved']=![],_0x5d6ce0;});}async[a312_0x49e7d6(0x96)](_0x3e8943){const _0x1078aa=a312_0x49e7d6;this[_0x1078aa(0x98)][_0x1078aa(0x85)](_0x1078aa(0x122));const _0x554701=veeva_constants_1['VeevaConstants'][_0x1078aa(0xcc)]+_0x1078aa(0xc3);await veeva_service_1[_0x1078aa(0x97)]['deleteVeevaObjectRecords'](_0x554701,this[_0x1078aa(0xd5)],_0x3e8943,this[_0x1078aa(0x98)]);}async[a312_0x49e7d6(0xc6)](_0x37326c){const _0x433671=a312_0x49e7d6;this[_0x433671(0x98)][_0x433671(0x85)](_0x433671(0xdd));const _0x1b92dc=veeva_constants_1[_0x433671(0x121)][_0x433671(0xcc)]+'outbound_package__v';await veeva_service_1[_0x433671(0x97)][_0x433671(0x100)](_0x1b92dc,this['_connectionVeeva'],_0x37326c,this[_0x433671(0x98)]);}async[a312_0x49e7d6(0xc0)](_0x21763e){const _0x237b8d=a312_0x49e7d6;this[_0x237b8d(0x98)]['log'](_0x237b8d(0x8b)),await this[_0x237b8d(0x89)](_0x21763e),this[_0x237b8d(0x98)][_0x237b8d(0x85)](_0x237b8d(0xdf)+_0x21763e[_0x237b8d(0xcd)]+'\x20Metadata\x20Items');const _0x268f0e=_0x21763e[_0x237b8d(0xd0)](_0x369743=>{const _0x18fb2b=_0x237b8d;return{[constants_1[_0x18fb2b(0x123)]+_0x18fb2b(0xc1)]:_0x369743[_0x18fb2b(0x88)],[constants_1[_0x18fb2b(0x123)]+'API_Name__c']:_0x369743[_0x18fb2b(0x9f)],[constants_1[_0x18fb2b(0x123)]+_0x18fb2b(0xb6)]:_0x369743[_0x18fb2b(0xde)],[constants_1[_0x18fb2b(0x123)]+'Label__c']:_0x369743[_0x18fb2b(0xae)],[constants_1[_0x18fb2b(0x123)]+_0x18fb2b(0xfc)]:_0x369743['isRetrieved'],[constants_1[_0x18fb2b(0x123)]+_0x18fb2b(0xc5)]:_0x369743['veevaComponentType'],[constants_1[_0x18fb2b(0x123)]+_0x18fb2b(0x124)]:_0x369743[_0x18fb2b(0xe4)],[constants_1[_0x18fb2b(0x123)]+_0x18fb2b(0xaf)]:_0x369743[_0x18fb2b(0xbd)]};}),_0x3823fd=await salesforce_service_1[_0x237b8d(0x8e)][_0x237b8d(0xef)](this['_connectionSalesforce'],constants_1['FLOSUM_NAMESPACE']+_0x237b8d(0x9d),_0x268f0e);let _0x17c8a7=!![];_0x3823fd['forEach']((_0x3229fd,_0x5e66be)=>{const _0xbc8cd8=_0x237b8d;this[_0xbc8cd8(0x98)][_0xbc8cd8(0x85)](_0xbc8cd8(0xdf)+_0x21763e[_0x5e66be][_0xbc8cd8(0x8c)]+'.'+_0x21763e[_0x5e66be]['name']);if(!_0x3229fd['success']){_0x17c8a7=![];const _0x2d1ba0=new salesforce_dml_error_1[(_0xbc8cd8(0x117))](_0x3229fd[_0xbc8cd8(0x108)]);this[_0xbc8cd8(0x98)][_0xbc8cd8(0xdc)](_0x2d1ba0);}});if(!_0x17c8a7)throw new Error(_0x237b8d(0xf0));}async['saveAttachments'](_0x5406ad){const _0x488499=a312_0x49e7d6,_0x47971e=this[_0x488499(0x8f)](_0x5406ad),_0x546c87=await salesforce_service_1[_0x488499(0x8e)][_0x488499(0xef)](this[_0x488499(0x10d)],SnapshotService[_0x488499(0xb9)],_0x47971e),_0x11d67e=[];_0x546c87[_0x488499(0xe0)]((_0x1a1a18,_0x4e28fa)=>{const _0x9bee7a=_0x488499;_0x1a1a18[_0x9bee7a(0xa0)]?(_0x5406ad[_0x4e28fa]['attachmentId']=_0x1a1a18['id'],_0x5406ad[_0x4e28fa][_0x9bee7a(0xff)]=!![]):_0x11d67e[_0x9bee7a(0xac)](..._0x1a1a18[_0x9bee7a(0x108)]);});if(_0x11d67e[_0x488499(0xcd)])throw new salesforce_dml_error_1[(_0x488499(0x117))](_0x11d67e);}[a312_0x49e7d6(0x8f)](_0x383394){const _0x3dd7ea=a312_0x49e7d6;return _0x383394[_0x3dd7ea(0xd0)](_0xacaddf=>({'ParentId':this[_0x3dd7ea(0x12a)],'Name':_0xacaddf[_0x3dd7ea(0x8c)],'ContentType':'application/zip','Body':_0xacaddf[_0x3dd7ea(0xc2)],'Description':_0xacaddf[_0x3dd7ea(0x8c)]}));}async[a312_0x49e7d6(0x9b)](_0x5303ab){const _0x2d853e=a312_0x49e7d6,_0x174d56={[constants_1[_0x2d853e(0x123)]+'Is_Completed__c']:!![],[constants_1[_0x2d853e(0x123)]+_0x2d853e(0xed)]:!_0x5303ab},_0x1fa66e={[constants_1[_0x2d853e(0x123)]+_0x2d853e(0xed)]:!_0x5303ab,[constants_1[_0x2d853e(0x123)]+_0x2d853e(0xec)]:_0x5303ab,[constants_1['FLOSUM_NAMESPACE']+'Status__c']:_0x5303ab?status_enums_1['MetadataLogStatus']['COMPLETED']:status_enums_1[_0x2d853e(0xab)][_0x2d853e(0xb5)],[constants_1[_0x2d853e(0x123)]+_0x2d853e(0x113)]:!![]};await this['_connectionSalesforce']['patch'](flosum_constants_1[_0x2d853e(0xd6)][_0x2d853e(0x93)]+'/'+constants_1[_0x2d853e(0x123)]+_0x2d853e(0xc9)+this['_snapshotId'],_0x174d56),await this[_0x2d853e(0x10d)][_0x2d853e(0x120)](flosum_constants_1[_0x2d853e(0xd6)]['ENDPOINT_UPSERT_RECORD']+'/'+constants_1['FLOSUM_NAMESPACE']+_0x2d853e(0xb3)+this[_0x2d853e(0x125)],_0x1fa66e),this[_0x2d853e(0x98)][_0x2d853e(0x85)](_0x2d853e(0x95)+(_0x5303ab?_0x2d853e(0xe2):_0x2d853e(0xfb))+'.'),await this[_0x2d853e(0x98)]['updateLog']();}}exports[a312_0x49e7d6(0xb0)]=SnapshotService,SnapshotService[a312_0x49e7d6(0xc8)]='Snapshot',SnapshotService['ATTACMENT']=a312_0x49e7d6(0x11d);