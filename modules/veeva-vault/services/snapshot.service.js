const a312_0x487ca4=a312_0x534f;function a312_0x2501(){const _0x5b32eb=['(((.+)+)+)+$','./veeva.service','562967UknOrI','attachmentLogId','256Divuss','values','finishSnapshot','formMetadataItemDtoList','formAttachments','label','Attachment','Job_Completed__c','_snapshotId','Creating\x20outbound\x20packages','href','createVeevaObjectRecords','Status__c','includes','migration__sys','deleteVeevaObjectRecords','executeVQL','SalesforceService','deletePackageComponents','parse','Getting\x20names\x20of\x20outbound\x20packages','7SmBIhO','set','../dtos/metadata-item.dto','filter','Is_Error__c','rel','Retrieve\x20Outbound\x20Package\x20zip\x20list','FLOSUM_NAMESPACE','files','generateAsync','\x27,\x27','log','length','999wgRKQS','BUILD_WHERE_BY_NAME_LIMIT','jszip','VeevaComponentDto','getComponentsMetadataByTypes','2453538fqRIcv','Attachment_ID__c','push','snapshotId','artifacts','_connectionVeeva','_selectedComponentMap','EXCEPTION','Retrieve\x20Jobs\x20Status','API_Name__c','timeZone','OUTBOUND_PACKAGE_NAME','chunkArray','createExportOutboundPackages','getEndpointArtifactList','saveAttachments','_logger','MetadataLogStatus','\x20Metadata\x20Items','2YOEfdc','metadataLogId','Deleting\x20outbound\x20packages.','850341YOIXZl','split','successfully','type','createPackageComponents','2057gPCYwR','responseStatus','14676CBkAgO','4275VqxsAK','\x27\x20AND\x20component_name__v\x20CONTAINS\x20(\x27','SnapshotService','insertMultipleRecords','get','Is_Completed__c','apiName','name','\x20from\x20outbound\x20package','all','body','Is_Retrieved__c','Saving\x20','FlosumConstants','inactive__v','has','errors','selectedComponentMap','lastModifiedDate','forEach','reduce','__importDefault','MAXIMUM_SIZE_OF_PACKAGE','toString','arraybuffer','__esModule','post','apply','logError','Removing\x20components\x20from\x20outbound\x20packages.','Adding\x20components\x20to\x20outbound\x20package','Retrieve\x20collection\x20metadata\x20of\x20components\x20by\x20type\x20and\x20names','../constants/veeva.constants','VeevaConstants','Create\x20Export\x20outbound\x20packages.','getComponentsMetadataByTypeAndName','Unpack\x20zip\x20and\x20create\x20metadata\x20items.','ATTACMENT','Name__c','MetadataItemDto','defineProperty','../../../constants','createMetadataItemListWithBody','content-type','Snapshot\x20started.','executeManyVQL','links','getPackageNames','from','VeevaResponseStatus','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20outbound_package__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20id\x20CONTAINS\x20(\x27','map','Label__c','search','file','constructor','veevaComponentType','4570416xSRpNq','../dtos/veeva-component.dto','execute','retrieveVPKList','VeevaService','async','package_component__v','COMPLETED','ENDPOINT_UPSERT_RECORD','updateLog','string','isRetrieved','default','ENDPOINT_CREATE_RECORDS','Cannot\x20Save\x20Metadata\x20Items','fill','join','_connectionSalesforce','VeevaError','SalesforceDmlError','Snapshot__c','patch','ceil','saveComponentsInSalesforce','Saving\x20Attachments.','_metadataLogId','exportOutboundPackage','Metadata_Log__c/','getJobResult','outbound_package__v','../classes/errors/veeva-error','Snapshot__c/','../classes/errors/salesforce-dml-error','_selectedMetaTypes','attachmentId','Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20','deleteOutboundPackages','11850TnQGOa','application/x-www-form-urlencoded','_attachmentLogId'];a312_0x2501=function(){return _0x5b32eb;};return a312_0x2501();}(function(_0x33df73,_0x147642){const _0x266dec=a312_0x534f,_0x47a0d9=_0x33df73();while(!![]){try{const _0x2a6fc5=-parseInt(_0x266dec(0x17e))/0x1+-parseInt(_0x266dec(0x110))/0x2*(-parseInt(_0x266dec(0x113))/0x3)+-parseInt(_0x266dec(0x180))/0x4*(parseInt(_0x266dec(0x11b))/0x5)+parseInt(_0x266dec(0xfd))/0x6*(parseInt(_0x266dec(0xeb))/0x7)+parseInt(_0x266dec(0x154))/0x8+-parseInt(_0x266dec(0xf8))/0x9*(parseInt(_0x266dec(0x179))/0xa)+-parseInt(_0x266dec(0x118))/0xb*(parseInt(_0x266dec(0x11a))/0xc);if(_0x2a6fc5===_0x147642)break;else _0x47a0d9['push'](_0x47a0d9['shift']());}catch(_0x44b786){_0x47a0d9['push'](_0x47a0d9['shift']());}}}(a312_0x2501,0x45c35));const a312_0x5583b5=(function(){let _0x59e034=!![];return function(_0x278eed,_0x379873){const _0x5bb056=_0x59e034?function(){const _0x4a12f4=a312_0x534f;if(_0x379873){const _0x59fffb=_0x379873[_0x4a12f4(0x136)](_0x278eed,arguments);return _0x379873=null,_0x59fffb;}}:function(){};return _0x59e034=![],_0x5bb056;};}()),a312_0x54e5ce=a312_0x5583b5(this,function(){const _0x179aa3=a312_0x534f;return a312_0x54e5ce[_0x179aa3(0x132)]()[_0x179aa3(0x150)](_0x179aa3(0x17c))[_0x179aa3(0x132)]()[_0x179aa3(0x152)](a312_0x54e5ce)[_0x179aa3(0x150)]('(((.+)+)+)+$');});a312_0x54e5ce();'use strict';var __importDefault=this&&this[a312_0x487ca4(0x130)]||function(_0x1f80b5){return _0x1f80b5&&_0x1f80b5['__esModule']?_0x1f80b5:{'default':_0x1f80b5};};Object[a312_0x487ca4(0x143)](exports,a312_0x487ca4(0x134),{'value':!![]}),exports[a312_0x487ca4(0x11d)]=void 0x0;function a312_0x534f(_0x384f96,_0x5ef4be){const _0x5aa026=a312_0x2501();return a312_0x534f=function(_0x54e5ce,_0x5583b5){_0x54e5ce=_0x54e5ce-0xdc;let _0x2501b1=_0x5aa026[_0x54e5ce];return _0x2501b1;},a312_0x534f(_0x384f96,_0x5ef4be);}const jszip_1=__importDefault(require(a312_0x487ca4(0xfa))),flosum_constants_1=require('../constants/flosum.constants'),veeva_constants_1=require(a312_0x487ca4(0x13b)),veeva_service_1=require(a312_0x487ca4(0x17d)),veeva_component_dto_1=require(a312_0x487ca4(0x155)),metadata_item_dto_1=require(a312_0x487ca4(0xed)),utils_1=require('../../shared/utils'),constants_1=require(a312_0x487ca4(0x144)),salesforce_service_1=require('./salesforce.service'),status_enums_1=require('../enums/status.enums'),salesforce_dml_error_1=require(a312_0x487ca4(0x174)),veeva_error_1=require(a312_0x487ca4(0x172));class SnapshotService{constructor(_0x427734,_0x429d5e,_0x27aba1,_0x360c22){const _0x122a91=a312_0x487ca4;this['_connectionSalesforce']=_0x429d5e,this[_0x122a91(0x102)]=_0x27aba1,this['_logger']=_0x360c22,this[_0x122a91(0xde)]=_0x427734[_0x122a91(0x100)],this[_0x122a91(0x16d)]=_0x427734[_0x122a91(0x111)],this[_0x122a91(0x17b)]=_0x427734[_0x122a91(0x17f)],this['_timeZone']=_0x427734[_0x122a91(0x107)],this[_0x122a91(0x175)]=_0x427734['selectedMetaTypes'],this[_0x122a91(0x103)]=_0x427734[_0x122a91(0x12c)];}async[a312_0x487ca4(0x156)](){const _0x3292c9=a312_0x487ca4;try{this['_logger'][_0x3292c9(0xf6)](_0x3292c9(0x147));const _0x18832e=Array['from'](Object[_0x3292c9(0x181)](this['_selectedComponentMap']))['length']?await this[_0x3292c9(0x13e)]():await this[_0x3292c9(0xfc)]();await this['_logger'][_0x3292c9(0x15d)]();const _0x24887a=await this['createOutboundPackages'](Math[_0x3292c9(0x16a)](_0x18832e[_0x3292c9(0xf7)]/veeva_constants_1['VeevaConstants'][_0x3292c9(0x131)])),_0x54af88=await this['createPackageComponents'](_0x18832e,_0x24887a);await this['_logger']['updateLog']();const _0x4eac88=await this[_0x3292c9(0x16e)](_0x24887a),_0x346032=await this[_0x3292c9(0x145)](_0x18832e,_0x4eac88);await this[_0x3292c9(0x16b)](_0x346032),await this[_0x3292c9(0x10d)]['updateLog'](),await this[_0x3292c9(0xe8)](_0x54af88),await this[_0x3292c9(0x178)](_0x24887a),await this[_0x3292c9(0x182)](!![]);}catch(_0x2e8911){this['_logger']['logError'](_0x2e8911),await this['finishSnapshot'](![])['catch'](_0x443832=>this['_systemLogger']['error'](_0x443832));}}async[a312_0x487ca4(0xfc)](){const _0x445748=a312_0x487ca4;this[_0x445748(0x10d)][_0x445748(0xf6)]('Retrieve\x20collection\x20metadata\x20of\x20components');const _0x3cd0e3=[],_0x596076='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20CONTAINS\x20(\x27'+this[_0x445748(0x175)][_0x445748(0x164)](_0x445748(0xf5))+'\x27)',_0x3b751d=veeva_constants_1[_0x445748(0x13c)]['ENDPOINT_VQL']+_0x596076,_0x29d899=await veeva_service_1[_0x445748(0x158)]['executeVQL'](_0x3b751d,this['_connectionVeeva']);for(const _0x3cc7b2 of _0x29d899){const _0x53351a=new veeva_component_dto_1[(_0x445748(0xfb))](_0x3cc7b2),{name:_0x24826a,type:_0x394752,status:_0x2691e7}=_0x53351a;_0x2691e7[_0x445748(0xe3)]('inactive__v')?this[_0x445748(0x10d)][_0x445748(0xf6)]('Cannot\x20retrieve\x20component\x20with\x20inactive\x20status.\x20Component:\x20'+_0x394752+'.'+_0x24826a):_0x3cd0e3[_0x445748(0xff)](_0x53351a);}return _0x3cd0e3;}async[a312_0x487ca4(0x13e)](){const _0x5e3754=a312_0x487ca4;this[_0x5e3754(0x10d)][_0x5e3754(0xf6)](_0x5e3754(0x13a));const _0x1255a9=[];for(const _0x1f0de5 in this[_0x5e3754(0x103)]){const _0x2743bc=(0x0,utils_1[_0x5e3754(0x109)])(this[_0x5e3754(0x103)][_0x1f0de5],veeva_constants_1[_0x5e3754(0x13c)][_0x5e3754(0xf9)]),_0x4c8bf3=_0x2743bc['map'](_0x52d79a=>veeva_constants_1['VeevaConstants']['ENDPOINT_VQL']+('SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_modified_date__sys,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_name__v,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20component_type__v,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20status__v\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20vault_component__v\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20component_type__v\x20=\x27'+_0x1f0de5+_0x5e3754(0x11c)+_0x52d79a['join'](_0x5e3754(0xf5))+'\x27)'));_0x1255a9[_0x5e3754(0xff)](..._0x4c8bf3);}const _0x2413a0=[],_0x5a479d=await veeva_service_1['VeevaService'][_0x5e3754(0x148)](_0x1255a9,this[_0x5e3754(0x102)]);for(const _0x1e2909 of _0x5a479d){const _0x15943e=new veeva_component_dto_1[(_0x5e3754(0xfb))](_0x1e2909),{name:_0x5bcd4d,type:_0x3b005a,status:_0x5517e4}=_0x15943e,_0x1063c9=_0x5517e4[_0x5e3754(0xe3)](_0x5e3754(0x129));_0x1063c9?this[_0x5e3754(0x10d)][_0x5e3754(0xf6)](_0x5e3754(0x177)+_0x3b005a+'.'+_0x5bcd4d):_0x2413a0[_0x5e3754(0xff)](_0x15943e);}return _0x2413a0;}async['createOutboundPackages'](_0x191e39){const _0x5e6ffb=a312_0x487ca4;this[_0x5e6ffb(0x10d)][_0x5e6ffb(0xf6)](_0x5e6ffb(0xdf));const _0x3b09a2=veeva_constants_1[_0x5e6ffb(0x13c)][_0x5e6ffb(0x161)]+_0x5e6ffb(0x171),_0x504f76=new Array(_0x191e39)[_0x5e6ffb(0x163)]({'summary__v':SnapshotService[_0x5e6ffb(0x108)],'object_type__v.api__name__v':_0x5e6ffb(0xe4)});return await veeva_service_1[_0x5e6ffb(0x158)][_0x5e6ffb(0xe1)](_0x3b09a2,this[_0x5e6ffb(0x102)],_0x504f76,this[_0x5e6ffb(0x10d)]);}async[a312_0x487ca4(0x117)](_0x5ee665,_0x4340f4){const _0xb9e27e=a312_0x487ca4;this[_0xb9e27e(0x10d)]['log'](_0xb9e27e(0x139));const _0xac2aa6=veeva_constants_1[_0xb9e27e(0x13c)][_0xb9e27e(0x161)]+_0xb9e27e(0x15a),_0x38cabb=_0x5ee665[_0xb9e27e(0x14e)]((_0x23dfc1,_0xf024f)=>({'vault_component__v':_0x23dfc1['id'],'outbound_package__v':_0x4340f4[Math[_0xb9e27e(0x16a)]((_0xf024f+0x1)/veeva_constants_1['VeevaConstants'][_0xb9e27e(0x131)])-0x1]}));return await veeva_service_1['VeevaService'][_0xb9e27e(0xe1)](_0xac2aa6,this[_0xb9e27e(0x102)],_0x38cabb,this[_0xb9e27e(0x10d)]);}async[a312_0x487ca4(0x16e)](_0x229027){const _0x40dd2b=a312_0x487ca4,_0x1bee00=await this[_0x40dd2b(0x14a)](_0x229027),_0x5dbdc1=await this[_0x40dd2b(0x10a)](Array[_0x40dd2b(0x14b)](_0x1bee00[_0x40dd2b(0x181)]())),_0x5a10b3=await this[_0x40dd2b(0x10b)](_0x5dbdc1);return await this[_0x40dd2b(0x157)](_0x5a10b3);}async[a312_0x487ca4(0x14a)](_0x3bd5ea){const _0x1c5af9=a312_0x487ca4;this['_logger'][_0x1c5af9(0xf6)](_0x1c5af9(0xea));const _0x51db1f=_0x1c5af9(0x14d)+_0x3bd5ea[_0x1c5af9(0x164)](_0x1c5af9(0xf5))+'\x27)',_0x5e033b=veeva_constants_1['VeevaConstants']['ENDPOINT_VQL']+_0x51db1f,_0x226cf1=await veeva_service_1[_0x1c5af9(0x158)][_0x1c5af9(0xe6)](_0x5e033b,this[_0x1c5af9(0x102)]);return _0x226cf1['reduce']((_0x3aa171,_0x230e87)=>_0x3aa171['set'](_0x230e87['id'],_0x230e87['name__v']),new Map());}async['createExportOutboundPackages'](_0x178ed3){const _0x1172e2=a312_0x487ca4;this[_0x1172e2(0x10d)][_0x1172e2(0xf6)](_0x1172e2(0x13d));const _0x2ed034=[],_0x3ddfcd=_0x178ed3[_0x1172e2(0x14e)](_0x3cca94=>{const _0xdbf689=_0x1172e2;return this[_0xdbf689(0x102)][_0xdbf689(0x135)](veeva_constants_1[_0xdbf689(0x13c)]['ENDPOINT_EXPORT_IMPORT_PACKAGE'],encodeURI('packageName')+'='+encodeURI(_0x3cca94),{'headers':{'Content-Type':_0xdbf689(0x17a)}});}),_0x27be31=await Promise[_0x1172e2(0x124)](_0x3ddfcd);for(const {data:_0x1f8da2}of _0x27be31){if(_0x1f8da2[_0x1172e2(0x119)]===status_enums_1[_0x1172e2(0x14c)]['SUCCESS']){const {url:_0x94c0a9}=_0x1f8da2;_0x2ed034['push'](_0x94c0a9);}else throw new veeva_error_1[(_0x1172e2(0x166))](_0x1f8da2['errors']);}return _0x2ed034;}async['getEndpointArtifactList'](_0x36225c){const _0x123309=a312_0x487ca4;this[_0x123309(0x10d)][_0x123309(0xf6)](_0x123309(0x105));const _0x3d0233=[],_0x1703bc=await veeva_service_1[_0x123309(0x158)][_0x123309(0x170)](_0x36225c,this['_connectionVeeva'],this[_0x123309(0x10d)]);for(const _0x37c384 of _0x1703bc){const _0xac9e44=_0x37c384[_0x123309(0x149)][_0x123309(0xee)](_0xf28bd4=>_0xf28bd4[_0x123309(0xf0)]===_0x123309(0x101))['map'](_0x2508c3=>_0x2508c3[_0x123309(0xe0)]);_0x3d0233['push'](..._0xac9e44);}return _0x3d0233;}async[a312_0x487ca4(0x157)](_0x30e5f8){const _0x74944b=a312_0x487ca4;var _0x1a82fa;const _0x323f24=[];this[_0x74944b(0x10d)][_0x74944b(0xf6)](_0x74944b(0xf1));for(const _0x5c340f of _0x30e5f8){const {data:_0x1771f0,headers:_0x459c5b}=await this[_0x74944b(0x102)][_0x74944b(0x11f)](_0x5c340f,{'responseType':_0x74944b(0x133)}),_0x555a5f=(_0x1a82fa=_0x459c5b[_0x74944b(0x146)])===null||_0x1a82fa===void 0x0?void 0x0:_0x1a82fa[_0x74944b(0xe3)]('application/json');if(!_0x555a5f){const _0x3caa2b=_0x1771f0,_0x85589c=new jszip_1[(_0x74944b(0x160))]();await _0x85589c['loadAsync'](_0x3caa2b),_0x323f24[_0x74944b(0xff)](_0x85589c);}else{const _0x5a1dbe=JSON[_0x74944b(0xe9)](_0x1771f0);throw new veeva_error_1['VeevaError'](_0x5a1dbe['errors']);}}return _0x323f24;}async[a312_0x487ca4(0x145)](_0x297d60,_0x381984){const _0x12d6a5=a312_0x487ca4;var _0x3e29de;this['_logger']['log'](_0x12d6a5(0x13f));const _0x10fa39=this[_0x12d6a5(0x183)](_0x297d60),_0x1fe800=_0x10fa39[_0x12d6a5(0x12f)]((_0x39a5c7,_0xa9a339)=>_0x39a5c7[_0x12d6a5(0xec)](_0xa9a339[_0x12d6a5(0x185)],_0xa9a339),new Map());for(const _0x53261a of _0x381984){for(const _0x1909c9 in _0x53261a[_0x12d6a5(0xf3)]){const _0x4aab95=_0x1909c9[_0x12d6a5(0x114)]('/')['at'](-0x1);if(_0x1fe800[_0x12d6a5(0x12a)](_0x4aab95)){const _0x42761b=await((_0x3e29de=_0x53261a[_0x12d6a5(0x151)](_0x1909c9))===null||_0x3e29de===void 0x0?void 0x0:_0x3e29de[_0x12d6a5(0x159)](_0x12d6a5(0x15e)));if(_0x42761b){const _0x3ce939=new jszip_1[(_0x12d6a5(0x160))]();_0x3ce939[_0x12d6a5(0x151)](_0x4aab95,_0x42761b),_0x1fe800[_0x12d6a5(0x11f)](_0x4aab95)['body']=await _0x3ce939[_0x12d6a5(0xf4)]({'type':'base64'});}}}}return _0x10fa39['filter'](_0x367e1f=>!_0x367e1f[_0x12d6a5(0x125)])[_0x12d6a5(0x12e)](_0x56b395=>{const _0xadb022=_0x12d6a5;this[_0xadb022(0x10d)][_0xadb022(0xf6)]('Cannot\x20retrieve\x20'+_0x56b395[_0xadb022(0x153)]+'.'+_0x56b395[_0xadb022(0x122)]+_0xadb022(0x123));}),_0x10fa39[_0x12d6a5(0xee)](_0x5826c8=>_0x5826c8[_0x12d6a5(0x125)]);}['formMetadataItemDtoList'](_0x385da2){const _0x4d2e35=a312_0x487ca4;return _0x385da2[_0x4d2e35(0x14e)](_0x2c6360=>{const _0x2d4159=_0x4d2e35,_0x222f3d=new metadata_item_dto_1[(_0x2d4159(0x142))]();return _0x222f3d[_0x2d4159(0x122)]=_0x2c6360['name'],_0x222f3d[_0x2d4159(0x121)]=_0x2c6360[_0x2d4159(0x122)],_0x222f3d[_0x2d4159(0x100)]=this['_snapshotId'],_0x222f3d['label']=_0x2c6360[_0x2d4159(0x116)]+'.'+_0x2c6360['name']+'.mdl',_0x222f3d[_0x2d4159(0x153)]=_0x2c6360[_0x2d4159(0x116)],_0x222f3d[_0x2d4159(0x12d)]=_0x2c6360[_0x2d4159(0x12d)],_0x222f3d[_0x2d4159(0x15f)]=![],_0x222f3d;});}async[a312_0x487ca4(0xe8)](_0x80e5c2){const _0xbd825e=a312_0x487ca4;this[_0xbd825e(0x10d)][_0xbd825e(0xf6)](_0xbd825e(0x138));const _0x534a14=veeva_constants_1[_0xbd825e(0x13c)][_0xbd825e(0x161)]+'package_component__v';await veeva_service_1[_0xbd825e(0x158)][_0xbd825e(0xe5)](_0x534a14,this[_0xbd825e(0x102)],_0x80e5c2,this[_0xbd825e(0x10d)]);}async[a312_0x487ca4(0x178)](_0x2192bd){const _0x3653a6=a312_0x487ca4;this['_logger']['log'](_0x3653a6(0x112));const _0x2fad19=veeva_constants_1[_0x3653a6(0x13c)][_0x3653a6(0x161)]+_0x3653a6(0x171);await veeva_service_1[_0x3653a6(0x158)][_0x3653a6(0xe5)](_0x2fad19,this[_0x3653a6(0x102)],_0x2192bd,this[_0x3653a6(0x10d)]);}async[a312_0x487ca4(0x16b)](_0x4df58e){const _0x2a552e=a312_0x487ca4;this[_0x2a552e(0x10d)][_0x2a552e(0xf6)](_0x2a552e(0x16c)),await this[_0x2a552e(0x10c)](_0x4df58e),this[_0x2a552e(0x10d)]['log'](_0x2a552e(0x127)+_0x4df58e[_0x2a552e(0xf7)]+_0x2a552e(0x10f));const _0x12e2e0=_0x4df58e[_0x2a552e(0x14e)](_0x1f8893=>{const _0x56fa37=_0x2a552e;return{[constants_1[_0x56fa37(0xf2)]+_0x56fa37(0x141)]:_0x1f8893[_0x56fa37(0x122)],[constants_1['FLOSUM_NAMESPACE']+_0x56fa37(0x106)]:_0x1f8893[_0x56fa37(0x121)],[constants_1[_0x56fa37(0xf2)]+_0x56fa37(0x168)]:_0x1f8893[_0x56fa37(0x100)],[constants_1['FLOSUM_NAMESPACE']+_0x56fa37(0x14f)]:_0x1f8893[_0x56fa37(0x185)],[constants_1[_0x56fa37(0xf2)]+_0x56fa37(0x126)]:_0x1f8893['isRetrieved'],[constants_1[_0x56fa37(0xf2)]+'Veeva_Component_Type__c']:_0x1f8893[_0x56fa37(0x153)],[constants_1[_0x56fa37(0xf2)]+_0x56fa37(0xfe)]:_0x1f8893[_0x56fa37(0x176)],[constants_1[_0x56fa37(0xf2)]+'Last_Modified_Date__c']:_0x1f8893[_0x56fa37(0x12d)]};}),_0x5e60ce=await salesforce_service_1[_0x2a552e(0xe7)][_0x2a552e(0x11e)](this[_0x2a552e(0x165)],constants_1['FLOSUM_NAMESPACE']+'Metadata_Item__c',_0x12e2e0);let _0x493b4d=!![];_0x5e60ce['forEach']((_0xaeb756,_0x933fc9)=>{const _0x38ce13=_0x2a552e;this[_0x38ce13(0x10d)][_0x38ce13(0xf6)]('Saving\x20'+_0x4df58e[_0x933fc9][_0x38ce13(0x153)]+'.'+_0x4df58e[_0x933fc9]['name']);if(!_0xaeb756['success']){_0x493b4d=![];const _0x50f5aa=new salesforce_dml_error_1[(_0x38ce13(0x167))](_0xaeb756[_0x38ce13(0x12b)]);this[_0x38ce13(0x10d)][_0x38ce13(0x137)](_0x50f5aa);}});if(!_0x493b4d)throw new Error(_0x2a552e(0x162));}async[a312_0x487ca4(0x10c)](_0x31bfe4){const _0x471845=a312_0x487ca4,_0x2e2b04=this[_0x471845(0x184)](_0x31bfe4),_0xb84026=await salesforce_service_1[_0x471845(0xe7)]['insertMultipleRecords'](this['_connectionSalesforce'],SnapshotService[_0x471845(0x140)],_0x2e2b04),_0x55cc2a=[];_0xb84026[_0x471845(0x12e)]((_0x2b45de,_0x218c80)=>{const _0x3864c6=_0x471845;_0x2b45de['success']?(_0x31bfe4[_0x218c80]['attachmentId']=_0x2b45de['id'],_0x31bfe4[_0x218c80]['isRetrieved']=!![]):_0x55cc2a[_0x3864c6(0xff)](..._0x2b45de[_0x3864c6(0x12b)]);});if(_0x55cc2a[_0x471845(0xf7)])throw new salesforce_dml_error_1[(_0x471845(0x167))](_0x55cc2a);}[a312_0x487ca4(0x184)](_0x32bd56){const _0x38508f=a312_0x487ca4;return _0x32bd56[_0x38508f(0x14e)](_0x370e94=>({'ParentId':this[_0x38508f(0xde)],'Name':_0x370e94['veevaComponentType'],'ContentType':'application/zip','Body':_0x370e94['body'],'Description':_0x370e94[_0x38508f(0x153)]}));}async[a312_0x487ca4(0x182)](_0x1e3cac){const _0x4333f0=a312_0x487ca4,_0x188867={[constants_1[_0x4333f0(0xf2)]+_0x4333f0(0x120)]:!![],[constants_1['FLOSUM_NAMESPACE']+'Is_Error__c']:!_0x1e3cac},_0x36bc68={[constants_1['FLOSUM_NAMESPACE']+_0x4333f0(0xef)]:!_0x1e3cac,[constants_1[_0x4333f0(0xf2)]+'Succeed__c']:_0x1e3cac,[constants_1[_0x4333f0(0xf2)]+_0x4333f0(0xe2)]:_0x1e3cac?status_enums_1['MetadataLogStatus'][_0x4333f0(0x15b)]:status_enums_1[_0x4333f0(0x10e)][_0x4333f0(0x104)],[constants_1[_0x4333f0(0xf2)]+_0x4333f0(0xdd)]:!![]};await this[_0x4333f0(0x165)][_0x4333f0(0x169)](flosum_constants_1['FlosumConstants'][_0x4333f0(0x15c)]+'/'+constants_1[_0x4333f0(0xf2)]+_0x4333f0(0x173)+this[_0x4333f0(0xde)],_0x188867),await this[_0x4333f0(0x165)][_0x4333f0(0x169)](flosum_constants_1[_0x4333f0(0x128)]['ENDPOINT_UPSERT_RECORD']+'/'+constants_1[_0x4333f0(0xf2)]+_0x4333f0(0x16f)+this[_0x4333f0(0x16d)],_0x36bc68),this[_0x4333f0(0x10d)][_0x4333f0(0xf6)]('Snapshot\x20completed\x20'+(_0x1e3cac?_0x4333f0(0x115):'with\x20error')+'.'),await this[_0x4333f0(0x10d)][_0x4333f0(0x15d)]();}}exports[a312_0x487ca4(0x11d)]=SnapshotService,SnapshotService[a312_0x487ca4(0x108)]='Snapshot',SnapshotService['ATTACMENT']=a312_0x487ca4(0xdc);