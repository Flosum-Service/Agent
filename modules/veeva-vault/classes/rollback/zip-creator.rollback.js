const a367_0xf0992c=a367_0x599d;(function(_0x1c092c,_0xfe192b){const _0x11fb8a=a367_0x599d,_0x223ae9=_0x1c092c();while(!![]){try{const _0x49cd0b=parseInt(_0x11fb8a(0xf3))/0x1+parseInt(_0x11fb8a(0xec))/0x2+parseInt(_0x11fb8a(0xf9))/0x3+parseInt(_0x11fb8a(0x106))/0x4*(-parseInt(_0x11fb8a(0xfe))/0x5)+parseInt(_0x11fb8a(0x10c))/0x6+-parseInt(_0x11fb8a(0xe5))/0x7*(parseInt(_0x11fb8a(0xff))/0x8)+parseInt(_0x11fb8a(0xf4))/0x9;if(_0x49cd0b===_0xfe192b)break;else _0x223ae9['push'](_0x223ae9['shift']());}catch(_0x509af2){_0x223ae9['push'](_0x223ae9['shift']());}}}(a367_0x4fdd,0xaa6f0));const a367_0x5a8477=(function(){let _0x49a562=!![];return function(_0x303b62,_0x385430){const _0x547167=_0x49a562?function(){const _0x3c3370=a367_0x599d;if(_0x385430){const _0x326788=_0x385430[_0x3c3370(0xf2)](_0x303b62,arguments);return _0x385430=null,_0x326788;}}:function(){};return _0x49a562=![],_0x547167;};}()),a367_0xedb042=a367_0x5a8477(this,function(){const _0x25f01b=a367_0x599d;return a367_0xedb042[_0x25f01b(0xe9)]()[_0x25f01b(0xef)]('(((.+)+)+)+$')[_0x25f01b(0xe9)]()[_0x25f01b(0x104)](a367_0xedb042)[_0x25f01b(0xef)](_0x25f01b(0xea));});a367_0xedb042();'use strict';var __importDefault=this&&this[a367_0xf0992c(0x100)]||function(_0x4651bb){const _0x55a0ac=a367_0xf0992c;return _0x4651bb&&_0x4651bb[_0x55a0ac(0xfd)]?_0x4651bb:{'default':_0x4651bb};};function a367_0x599d(_0x2bbfed,_0x40f9e7){const _0x1e7325=a367_0x4fdd();return a367_0x599d=function(_0xedb042,_0x5a8477){_0xedb042=_0xedb042-0xe5;let _0x4fdd64=_0x1e7325[_0xedb042];return _0x4fdd64;},a367_0x599d(_0x2bbfed,_0x40f9e7);}Object[a367_0xf0992c(0xeb)](exports,a367_0xf0992c(0xfd),{'value':!![]}),exports[a367_0xf0992c(0xed)]=void 0x0;function a367_0x4fdd(){const _0x173473=['__importDefault','file','Builder','null','constructor','nodebuffer','4592fSaTDj','buildObject','_backupZip','sort','createZips','_zip','4123314UjyjYP','_backup','vaultpackage.xml','5696845QyPgnM','FactoryBodyCreatorRollback','default','jszip','toString','(((.+)+)+)+$','defineProperty','8348FqnYmB','ZipCreatorRollback','create','search','fillZip','_rollbackName','apply','1244931WFJcrR','1201824pXZgkQ','stepName','_deploymentResults','sortDeploymentResults','loadAsync','2483121wBMhWr','migration__v','Flosum','https://veevavault.com/','__esModule','6035EnyZSp','8EbpICG'];a367_0x4fdd=function(){return _0x173473;};return a367_0x4fdd();}const jszip_1=__importDefault(require(a367_0xf0992c(0xe8))),factory_body_creator_rollback_1=require('./body-creator/factory.body-creator.rollback'),xml2js_1=require('xml2js');class ZipCreatorRollback{constructor({deploymentResults:_0x42c5d4,backup:_0x3dce53,rollbackName:_0x553503}){const _0x579d68=a367_0xf0992c;this['_deploymentResults']=_0x42c5d4,this[_0x579d68(0xf1)]=_0x553503,this[_0x579d68(0x10d)]=_0x3dce53;}async[a367_0xf0992c(0x10a)](){const _0x18a6ed=a367_0xf0992c;this['_backupZip']=new jszip_1[(_0x18a6ed(0xe7))](),this[_0x18a6ed(0x10b)]=new jszip_1[(_0x18a6ed(0xe7))](),await this[_0x18a6ed(0x108)][_0x18a6ed(0xf8)](this[_0x18a6ed(0x10d)],{'base64':!![]});}[a367_0xf0992c(0xf7)](){const _0x5827aa=a367_0xf0992c;this[_0x5827aa(0xf6)][_0x5827aa(0x109)]((_0x4f0343,_0x52a516)=>_0x4f0343[_0x5827aa(0xf5)]<_0x52a516[_0x5827aa(0xf5)]?0x1:_0x52a516['stepName']<_0x4f0343['stepName']?-0x1:0x0);}async[a367_0xf0992c(0xf0)](){const _0x163ba4=a367_0xf0992c;for(const _0x4607e1 of this[_0x163ba4(0xf6)]){const _0x38280c=await factory_body_creator_rollback_1[_0x163ba4(0xe6)][_0x163ba4(0xee)]({'deploymentResult':_0x4607e1,'backupZip':this[_0x163ba4(0x108)]})[_0x163ba4(0xee)](),{type:_0x152e7d,name:_0x1e849c}=_0x4607e1;this[_0x163ba4(0x10b)][_0x163ba4(0x101)](_0x152e7d+'.'+_0x1e849c+'.mdl',_0x38280c);}const _0x8cccc9=new xml2js_1[(_0x163ba4(0x102))]({'headless':!![]}),_0x52b850={'vaultpackage':{'$':{'xmlns':_0x163ba4(0xfc)},'name':this[_0x163ba4(0xf1)],'source':{'vault':undefined,'author':_0x163ba4(0xfb)},'packagetype':_0x163ba4(0xfa),'summary':'Rollback','description':_0x163ba4(0x103)}};this[_0x163ba4(0x10b)][_0x163ba4(0x101)](_0x163ba4(0x10e),_0x8cccc9[_0x163ba4(0x107)](_0x52b850));}async[a367_0xf0992c(0xee)](){const _0x5bddb3=a367_0xf0992c;return await this[_0x5bddb3(0x10a)](),this[_0x5bddb3(0xf7)](),await this[_0x5bddb3(0xf0)](),this[_0x5bddb3(0x10b)]['generateAsync']({'type':_0x5bddb3(0x105)});}}exports[a367_0xf0992c(0xed)]=ZipCreatorRollback;