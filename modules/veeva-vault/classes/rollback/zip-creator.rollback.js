const a378_0x16a1da=a378_0x1959;(function(_0x4fe5dd,_0x255856){const _0x223ef2=a378_0x1959,_0x256255=_0x4fe5dd();while(!![]){try{const _0x40c5fb=parseInt(_0x223ef2(0x182))/0x1+-parseInt(_0x223ef2(0x19c))/0x2+parseInt(_0x223ef2(0x191))/0x3*(parseInt(_0x223ef2(0x188))/0x4)+parseInt(_0x223ef2(0x189))/0x5+-parseInt(_0x223ef2(0x18d))/0x6+-parseInt(_0x223ef2(0x183))/0x7*(parseInt(_0x223ef2(0x195))/0x8)+-parseInt(_0x223ef2(0x18c))/0x9*(-parseInt(_0x223ef2(0x18e))/0xa);if(_0x40c5fb===_0x255856)break;else _0x256255['push'](_0x256255['shift']());}catch(_0x401b62){_0x256255['push'](_0x256255['shift']());}}}(a378_0x22e5,0x92ee3));const a378_0x78584e=(function(){let _0x47a763=!![];return function(_0x259017,_0x47f12d){const _0x30ab08=_0x47a763?function(){const _0x3ec0db=a378_0x1959;if(_0x47f12d){const _0xd9fd73=_0x47f12d[_0x3ec0db(0x18b)](_0x259017,arguments);return _0x47f12d=null,_0xd9fd73;}}:function(){};return _0x47a763=![],_0x30ab08;};}()),a378_0x2766a8=a378_0x78584e(this,function(){const _0x26f8e3=a378_0x1959;return a378_0x2766a8[_0x26f8e3(0x1a1)]()['search'](_0x26f8e3(0x181))[_0x26f8e3(0x1a1)]()['constructor'](a378_0x2766a8)['search'](_0x26f8e3(0x181));});a378_0x2766a8();'use strict';var __importDefault=this&&this[a378_0x16a1da(0x1a3)]||function(_0x104238){const _0x21efa3=a378_0x16a1da;return _0x104238&&_0x104238[_0x21efa3(0x19b)]?_0x104238:{'default':_0x104238};};function a378_0x22e5(){const _0x118ba8=['xml2js','Rollback','4lgIfqr','1759345kDHsvr','./body-creator/factory.body-creator.rollback','apply','18PJNgwu','6715686hLJeCm','2087330JZwEGX','buildObject','nodebuffer','625836wfPJJB','defineProperty','generateAsync','stepName','8ktfxMt','vaultpackage.xml','Builder','migration__v','null','_backup','__esModule','200280DMreCx','create','_deploymentResults','_zip','default','toString','_backupZip','__importDefault','createZips','_rollbackName','Flosum','.mdl','file','sort','(((.+)+)+)+$','993852tEzozs','1053857CaghVd','sortDeploymentResults','loadAsync'];a378_0x22e5=function(){return _0x118ba8;};return a378_0x22e5();}function a378_0x1959(_0x5f1c05,_0x3fd881){const _0x372d5a=a378_0x22e5();return a378_0x1959=function(_0x2766a8,_0x78584e){_0x2766a8=_0x2766a8-0x17c;let _0x22e5cc=_0x372d5a[_0x2766a8];return _0x22e5cc;},a378_0x1959(_0x5f1c05,_0x3fd881);}Object[a378_0x16a1da(0x192)](exports,'__esModule',{'value':!![]}),exports['ZipCreatorRollback']=void 0x0;const jszip_1=__importDefault(require('jszip')),factory_body_creator_rollback_1=require(a378_0x16a1da(0x18a)),xml2js_1=require(a378_0x16a1da(0x186));class ZipCreatorRollback{constructor({deploymentResults:_0x1304a5,backup:_0x57071b,rollbackName:_0x467db4}){const _0x8a4fca=a378_0x16a1da;this[_0x8a4fca(0x19e)]=_0x1304a5,this[_0x8a4fca(0x17c)]=_0x467db4,this[_0x8a4fca(0x19a)]=_0x57071b;}async[a378_0x16a1da(0x1a4)](){const _0x42d4f4=a378_0x16a1da;this[_0x42d4f4(0x1a2)]=new jszip_1[(_0x42d4f4(0x1a0))](),this[_0x42d4f4(0x19f)]=new jszip_1[(_0x42d4f4(0x1a0))](),await this[_0x42d4f4(0x1a2)][_0x42d4f4(0x185)](this['_backup'],{'base64':!![]});}[a378_0x16a1da(0x184)](){const _0x2db9fc=a378_0x16a1da;this[_0x2db9fc(0x19e)][_0x2db9fc(0x180)]((_0x39e308,_0x431d40)=>_0x39e308['stepName']<_0x431d40['stepName']?0x1:_0x431d40[_0x2db9fc(0x194)]<_0x39e308[_0x2db9fc(0x194)]?-0x1:0x0);}async['fillZip'](){const _0x4972b0=a378_0x16a1da;for(const _0x269012 of this[_0x4972b0(0x19e)]){const _0x1c325d=await factory_body_creator_rollback_1['FactoryBodyCreatorRollback'][_0x4972b0(0x19d)]({'deploymentResult':_0x269012,'backupZip':this['_backupZip']})['create'](),{type:_0x5481e9,name:_0x527051}=_0x269012;this[_0x4972b0(0x19f)][_0x4972b0(0x17f)](_0x5481e9+'.'+_0x527051+_0x4972b0(0x17e),_0x1c325d);}const _0x28832a=new xml2js_1[(_0x4972b0(0x197))]({'headless':!![]}),_0x2c503a={'vaultpackage':{'$':{'xmlns':'https://veevavault.com/'},'name':this[_0x4972b0(0x17c)],'source':{'vault':undefined,'author':_0x4972b0(0x17d)},'packagetype':_0x4972b0(0x198),'summary':_0x4972b0(0x187),'description':_0x4972b0(0x199)}};this[_0x4972b0(0x19f)][_0x4972b0(0x17f)](_0x4972b0(0x196),_0x28832a[_0x4972b0(0x18f)](_0x2c503a));}async[a378_0x16a1da(0x19d)](){const _0x4ac8d2=a378_0x16a1da;return await this['createZips'](),this['sortDeploymentResults'](),await this['fillZip'](),this[_0x4ac8d2(0x19f)][_0x4ac8d2(0x193)]({'type':_0x4ac8d2(0x190)});}}exports['ZipCreatorRollback']=ZipCreatorRollback;