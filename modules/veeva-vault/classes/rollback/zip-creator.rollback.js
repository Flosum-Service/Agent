const a351_0x3fc192=a351_0xf789;function a351_0xf789(_0x1d4992,_0xe230e7){const _0x255a7d=a351_0x45ad();return a351_0xf789=function(_0x41b288,_0x175c1b){_0x41b288=_0x41b288-0x164;let _0x45ad05=_0x255a7d[_0x41b288];return _0x45ad05;},a351_0xf789(_0x1d4992,_0xe230e7);}(function(_0x2fc665,_0x4b6821){const _0x1773ae=a351_0xf789,_0xdca632=_0x2fc665();while(!![]){try{const _0x4660e6=-parseInt(_0x1773ae(0x18d))/0x1+-parseInt(_0x1773ae(0x177))/0x2*(parseInt(_0x1773ae(0x16d))/0x3)+-parseInt(_0x1773ae(0x17e))/0x4+parseInt(_0x1773ae(0x188))/0x5*(-parseInt(_0x1773ae(0x170))/0x6)+-parseInt(_0x1773ae(0x181))/0x7*(parseInt(_0x1773ae(0x168))/0x8)+-parseInt(_0x1773ae(0x16b))/0x9*(-parseInt(_0x1773ae(0x171))/0xa)+-parseInt(_0x1773ae(0x189))/0xb*(-parseInt(_0x1773ae(0x187))/0xc);if(_0x4660e6===_0x4b6821)break;else _0xdca632['push'](_0xdca632['shift']());}catch(_0x393f34){_0xdca632['push'](_0xdca632['shift']());}}}(a351_0x45ad,0xa8741));const a351_0x175c1b=(function(){let _0x2c12f2=!![];return function(_0x211711,_0x435c83){const _0x546ee8=_0x2c12f2?function(){const _0x1c0bcd=a351_0xf789;if(_0x435c83){const _0x429a1a=_0x435c83[_0x1c0bcd(0x17d)](_0x211711,arguments);return _0x435c83=null,_0x429a1a;}}:function(){};return _0x2c12f2=![],_0x546ee8;};}()),a351_0x41b288=a351_0x175c1b(this,function(){const _0x3c653f=a351_0xf789;return a351_0x41b288['toString']()[_0x3c653f(0x180)](_0x3c653f(0x169))['toString']()[_0x3c653f(0x165)](a351_0x41b288)[_0x3c653f(0x180)](_0x3c653f(0x169));});a351_0x41b288();'use strict';var __importDefault=this&&this[a351_0x3fc192(0x183)]||function(_0x2ca3f7){const _0x24d6d4=a351_0x3fc192;return _0x2ca3f7&&_0x2ca3f7[_0x24d6d4(0x184)]?_0x2ca3f7:{'default':_0x2ca3f7};};function a351_0x45ad(){const _0x59a6c4=['null','stepName','apply','178320kWytrT','create','search','973yoKAGN','Builder','__importDefault','__esModule','_deploymentResults','createZips','17840796JEfwDN','10KnHifA','11XWfofq','loadAsync','defineProperty','fillZip','1186005MjctBV','_rollbackName','constructor','sortDeploymentResults','file','32504QDMZQu','(((.+)+)+)+$','vaultpackage.xml','238167trUfTL','sort','6urdkyL','default','FactoryBodyCreatorRollback','331218XHCkyp','440jzLSnr','.mdl','_backup','ZipCreatorRollback','_backupZip','xml2js','55372yizJgH','generateAsync','Rollback','_zip'];a351_0x45ad=function(){return _0x59a6c4;};return a351_0x45ad();}Object[a351_0x3fc192(0x18b)](exports,'__esModule',{'value':!![]}),exports['ZipCreatorRollback']=void 0x0;const jszip_1=__importDefault(require('jszip')),factory_body_creator_rollback_1=require('./body-creator/factory.body-creator.rollback'),xml2js_1=require(a351_0x3fc192(0x176));class ZipCreatorRollback{constructor({deploymentResults:_0x5b6199,backup:_0x3c22fd,rollbackName:_0x126b9b}){const _0x5aab99=a351_0x3fc192;this['_deploymentResults']=_0x5b6199,this[_0x5aab99(0x164)]=_0x126b9b,this[_0x5aab99(0x173)]=_0x3c22fd;}async['createZips'](){const _0x3d891b=a351_0x3fc192;this['_backupZip']=new jszip_1[(_0x3d891b(0x16e))](),this['_zip']=new jszip_1['default'](),await this[_0x3d891b(0x175)][_0x3d891b(0x18a)](this[_0x3d891b(0x173)],{'base64':!![]});}[a351_0x3fc192(0x166)](){const _0x14c473=a351_0x3fc192;this[_0x14c473(0x185)][_0x14c473(0x16c)]((_0x4e9ada,_0x1b71cb)=>_0x4e9ada[_0x14c473(0x17c)]<_0x1b71cb[_0x14c473(0x17c)]?0x1:_0x1b71cb[_0x14c473(0x17c)]<_0x4e9ada[_0x14c473(0x17c)]?-0x1:0x0);}async[a351_0x3fc192(0x18c)](){const _0x5b4b1b=a351_0x3fc192;for(const _0x2bab40 of this[_0x5b4b1b(0x185)]){const _0x3a74a8=await factory_body_creator_rollback_1[_0x5b4b1b(0x16f)][_0x5b4b1b(0x17f)]({'deploymentResult':_0x2bab40,'backupZip':this['_backupZip']})[_0x5b4b1b(0x17f)](),{type:_0x3b3145,name:_0x8e3892}=_0x2bab40;this[_0x5b4b1b(0x17a)][_0x5b4b1b(0x167)](_0x3b3145+'.'+_0x8e3892+_0x5b4b1b(0x172),_0x3a74a8);}const _0x438fec=new xml2js_1[(_0x5b4b1b(0x182))]({'headless':!![]}),_0xb5c0ea={'vaultpackage':{'$':{'xmlns':'https://veevavault.com/'},'name':this[_0x5b4b1b(0x164)],'source':{'vault':undefined,'author':'Flosum'},'packagetype':'migration__v','summary':_0x5b4b1b(0x179),'description':_0x5b4b1b(0x17b)}};this[_0x5b4b1b(0x17a)][_0x5b4b1b(0x167)](_0x5b4b1b(0x16a),_0x438fec['buildObject'](_0xb5c0ea));}async[a351_0x3fc192(0x17f)](){const _0x59938b=a351_0x3fc192;return await this[_0x59938b(0x186)](),this['sortDeploymentResults'](),await this[_0x59938b(0x18c)](),this[_0x59938b(0x17a)][_0x59938b(0x178)]({'type':'nodebuffer'});}}exports[a351_0x3fc192(0x174)]=ZipCreatorRollback;