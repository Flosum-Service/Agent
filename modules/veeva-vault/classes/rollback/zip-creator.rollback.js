const a312_0x4c3a91=a312_0x3acf;(function(_0x203631,_0x1d5e26){const _0x25827f=a312_0x3acf,_0x4b10c0=_0x203631();while(!![]){try{const _0x383561=-parseInt(_0x25827f(0x15e))/0x1*(parseInt(_0x25827f(0x163))/0x2)+parseInt(_0x25827f(0x175))/0x3*(-parseInt(_0x25827f(0x16a))/0x4)+parseInt(_0x25827f(0x159))/0x5*(parseInt(_0x25827f(0x15c))/0x6)+-parseInt(_0x25827f(0x173))/0x7+-parseInt(_0x25827f(0x153))/0x8+-parseInt(_0x25827f(0x172))/0x9*(parseInt(_0x25827f(0x155))/0xa)+-parseInt(_0x25827f(0x168))/0xb*(-parseInt(_0x25827f(0x160))/0xc);if(_0x383561===_0x1d5e26)break;else _0x4b10c0['push'](_0x4b10c0['shift']());}catch(_0x3d9303){_0x4b10c0['push'](_0x4b10c0['shift']());}}}(a312_0x581e,0xa0619));const a312_0x2d020b=(function(){let _0x5bd27f=!![];return function(_0x10abcb,_0x54efbe){const _0x5c29e9=_0x5bd27f?function(){const _0x3402d3=a312_0x3acf;if(_0x54efbe){const _0x5a02cf=_0x54efbe[_0x3402d3(0x170)](_0x10abcb,arguments);return _0x54efbe=null,_0x5a02cf;}}:function(){};return _0x5bd27f=![],_0x5c29e9;};}()),a312_0x2edb4b=a312_0x2d020b(this,function(){const _0x322bbc=a312_0x3acf;return a312_0x2edb4b[_0x322bbc(0x177)]()[_0x322bbc(0x158)]('(((.+)+)+)+$')[_0x322bbc(0x177)]()[_0x322bbc(0x16c)](a312_0x2edb4b)[_0x322bbc(0x158)]('(((.+)+)+)+$');});a312_0x2edb4b();'use strict';var __importDefault=this&&this[a312_0x4c3a91(0x16b)]||function(_0x556230){const _0x27323b=a312_0x4c3a91;return _0x556230&&_0x556230[_0x27323b(0x161)]?_0x556230:{'default':_0x556230};};Object[a312_0x4c3a91(0x169)](exports,a312_0x4c3a91(0x161),{'value':!![]}),exports[a312_0x4c3a91(0x15b)]=void 0x0;const jszip_1=__importDefault(require('jszip')),factory_body_creator_rollback_1=require('./body-creator/factory.body-creator.rollback'),xml2js_1=require(a312_0x4c3a91(0x16d));function a312_0x581e(){const _0x40879c=['FactoryBodyCreatorRollback','migration__v','apply','createZips','31797vOHLpb','110397hQgRtf','sort','408981DoSUUK','vaultpackage.xml','toString','fillZip','_backup','https://veevavault.com/','8022016KlJfco','create','430DyWVwI','_rollbackName','_backupZip','search','40vBVDkI','_deploymentResults','ZipCreatorRollback','790626pgrROR','generateAsync','1KrKCxT','loadAsync','70836mOOsMN','__esModule','_zip','1002590OToKoC','file','Flosum','stepName','default','2629nAwLFc','defineProperty','4TivmvF','__importDefault','constructor','xml2js'];a312_0x581e=function(){return _0x40879c;};return a312_0x581e();}class ZipCreatorRollback{constructor({deploymentResults:_0x17c0b9,backup:_0x4ba4ad,rollbackName:_0x433192}){const _0x4dbe77=a312_0x4c3a91;this[_0x4dbe77(0x15a)]=_0x17c0b9,this[_0x4dbe77(0x156)]=_0x433192,this[_0x4dbe77(0x151)]=_0x4ba4ad;}async[a312_0x4c3a91(0x171)](){const _0x31d3eb=a312_0x4c3a91;this['_backupZip']=new jszip_1[(_0x31d3eb(0x167))](),this[_0x31d3eb(0x162)]=new jszip_1[(_0x31d3eb(0x167))](),await this[_0x31d3eb(0x157)][_0x31d3eb(0x15f)](this['_backup'],{'base64':!![]});}['sortDeploymentResults'](){const _0x188f0d=a312_0x4c3a91;this['_deploymentResults'][_0x188f0d(0x174)]((_0x3b97de,_0x37e7fc)=>_0x3b97de[_0x188f0d(0x166)]<_0x37e7fc[_0x188f0d(0x166)]?0x1:_0x37e7fc[_0x188f0d(0x166)]<_0x3b97de['stepName']?-0x1:0x0);}async[a312_0x4c3a91(0x150)](){const _0xc097de=a312_0x4c3a91;for(const _0x453d46 of this['_deploymentResults']){const _0x1e2d07=await factory_body_creator_rollback_1[_0xc097de(0x16e)]['create']({'deploymentResult':_0x453d46,'backupZip':this[_0xc097de(0x157)]})['create'](),{type:_0x20765a,name:_0x126be4}=_0x453d46;this[_0xc097de(0x162)][_0xc097de(0x164)](_0x20765a+'.'+_0x126be4+'.mdl',_0x1e2d07);}const _0x272725=new xml2js_1['Builder']({'headless':!![]}),_0x4dcf62={'vaultpackage':{'$':{'xmlns':_0xc097de(0x152)},'name':this['_rollbackName'],'source':{'vault':undefined,'author':_0xc097de(0x165)},'packagetype':_0xc097de(0x16f),'summary':'Rollback','description':'null'}};this['_zip']['file'](_0xc097de(0x176),_0x272725['buildObject'](_0x4dcf62));}async[a312_0x4c3a91(0x154)](){const _0x232584=a312_0x4c3a91;return await this['createZips'](),this['sortDeploymentResults'](),await this[_0x232584(0x150)](),this[_0x232584(0x162)][_0x232584(0x15d)]({'type':'nodebuffer'});}}function a312_0x3acf(_0xfe3db5,_0x4ba573){const _0x2336df=a312_0x581e();return a312_0x3acf=function(_0x2edb4b,_0x2d020b){_0x2edb4b=_0x2edb4b-0x150;let _0x581e2b=_0x2336df[_0x2edb4b];return _0x581e2b;},a312_0x3acf(_0xfe3db5,_0x4ba573);}exports[a312_0x4c3a91(0x15b)]=ZipCreatorRollback;