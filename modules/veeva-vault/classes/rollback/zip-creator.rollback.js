const a335_0xc69b6b=a335_0x4343;function a335_0xd402(){const _0x51ee98=['166xCSbiS','213630uBlglx','sortDeploymentResults','fillZip','1679544SoKJMS','file','46100OGVPdy','toString','create','22BIFSYl','nodebuffer','_backupZip','buildObject','stepName','(((.+)+)+)+$','generateAsync','241087DKhOrQ','_backup','xml2js','default','_zip','__esModule','_deploymentResults','FactoryBodyCreatorRollback','162gloTzz','ZipCreatorRollback','jszip','defineProperty','Rollback','sort','_rollbackName','./body-creator/factory.body-creator.rollback','73760MXMPMd','Builder','16800qZWLdd','createZips','search','https://veevavault.com/','3813lPgYGH','512zXIOlZ','__importDefault'];a335_0xd402=function(){return _0x51ee98;};return a335_0xd402();}(function(_0x54443f,_0x5dcb51){const _0x2f169d=a335_0x4343,_0x2db154=_0x54443f();while(!![]){try{const _0x2f529b=-parseInt(_0x2f169d(0x212))/0x1+parseInt(_0x2f169d(0x202))/0x2*(parseInt(_0x2f169d(0x1ff))/0x3)+parseInt(_0x2f169d(0x1f9))/0x4+parseInt(_0x2f169d(0x208))/0x5*(parseInt(_0x2f169d(0x1f1))/0x6)+parseInt(_0x2f169d(0x1fb))/0x7*(parseInt(_0x2f169d(0x200))/0x8)+-parseInt(_0x2f169d(0x206))/0x9+parseInt(_0x2f169d(0x203))/0xa*(parseInt(_0x2f169d(0x20b))/0xb);if(_0x2f529b===_0x5dcb51)break;else _0x2db154['push'](_0x2db154['shift']());}catch(_0x2e6518){_0x2db154['push'](_0x2db154['shift']());}}}(a335_0xd402,0x228b8));const a335_0x288126=(function(){let _0x34dfd8=!![];return function(_0x497e51,_0x2fdc30){const _0x378cfa=_0x34dfd8?function(){if(_0x2fdc30){const _0x496e98=_0x2fdc30['apply'](_0x497e51,arguments);return _0x2fdc30=null,_0x496e98;}}:function(){};return _0x34dfd8=![],_0x378cfa;};}()),a335_0x6493d6=a335_0x288126(this,function(){const _0x3f2868=a335_0x4343;return a335_0x6493d6['toString']()[_0x3f2868(0x1fd)](_0x3f2868(0x210))[_0x3f2868(0x209)]()['constructor'](a335_0x6493d6)['search'](_0x3f2868(0x210));});a335_0x6493d6();'use strict';var __importDefault=this&&this[a335_0xc69b6b(0x201)]||function(_0x412b32){const _0x2feb3d=a335_0xc69b6b;return _0x412b32&&_0x412b32[_0x2feb3d(0x1ee)]?_0x412b32:{'default':_0x412b32};};Object[a335_0xc69b6b(0x1f4)](exports,a335_0xc69b6b(0x1ee),{'value':!![]}),exports[a335_0xc69b6b(0x1f2)]=void 0x0;function a335_0x4343(_0x3f0097,_0x1a0aca){const _0x1621e0=a335_0xd402();return a335_0x4343=function(_0x6493d6,_0x288126){_0x6493d6=_0x6493d6-0x1ed;let _0xd40290=_0x1621e0[_0x6493d6];return _0xd40290;},a335_0x4343(_0x3f0097,_0x1a0aca);}const jszip_1=__importDefault(require(a335_0xc69b6b(0x1f3))),factory_body_creator_rollback_1=require(a335_0xc69b6b(0x1f8)),xml2js_1=require(a335_0xc69b6b(0x214));class ZipCreatorRollback{constructor({deploymentResults:_0x233327,backup:_0x107069,rollbackName:_0x539dad}){const _0x29ff4f=a335_0xc69b6b;this[_0x29ff4f(0x1ef)]=_0x233327,this[_0x29ff4f(0x1f7)]=_0x539dad,this[_0x29ff4f(0x213)]=_0x107069;}async[a335_0xc69b6b(0x1fc)](){const _0x2c9588=a335_0xc69b6b;this[_0x2c9588(0x20d)]=new jszip_1[(_0x2c9588(0x215))](),this[_0x2c9588(0x1ed)]=new jszip_1['default'](),await this['_backupZip']['loadAsync'](this[_0x2c9588(0x213)],{'base64':!![]});}['sortDeploymentResults'](){const _0x3c7e1d=a335_0xc69b6b;this[_0x3c7e1d(0x1ef)][_0x3c7e1d(0x1f6)]((_0x1a1754,_0x17deef)=>_0x1a1754[_0x3c7e1d(0x20f)]<_0x17deef['stepName']?0x1:_0x17deef['stepName']<_0x1a1754[_0x3c7e1d(0x20f)]?-0x1:0x0);}async[a335_0xc69b6b(0x205)](){const _0x11c45e=a335_0xc69b6b;for(const _0x3f1fef of this['_deploymentResults']){const _0x7cfcf3=await factory_body_creator_rollback_1[_0x11c45e(0x1f0)]['create']({'deploymentResult':_0x3f1fef,'backupZip':this[_0x11c45e(0x20d)]})[_0x11c45e(0x20a)](),{type:_0x22f9c8,name:_0x59dd34}=_0x3f1fef;this['_zip'][_0x11c45e(0x207)](_0x22f9c8+'.'+_0x59dd34+'.mdl',_0x7cfcf3);}const _0x1f4069=new xml2js_1[(_0x11c45e(0x1fa))]({'headless':!![]}),_0x31c475={'vaultpackage':{'$':{'xmlns':_0x11c45e(0x1fe)},'name':this[_0x11c45e(0x1f7)],'source':{'vault':undefined,'author':'Flosum'},'packagetype':'migration__v','summary':_0x11c45e(0x1f5),'description':'null'}};this[_0x11c45e(0x1ed)]['file']('vaultpackage.xml',_0x1f4069[_0x11c45e(0x20e)](_0x31c475));}async[a335_0xc69b6b(0x20a)](){const _0x204b02=a335_0xc69b6b;return await this[_0x204b02(0x1fc)](),this[_0x204b02(0x204)](),await this[_0x204b02(0x205)](),this[_0x204b02(0x1ed)][_0x204b02(0x211)]({'type':_0x204b02(0x20c)});}}exports[a335_0xc69b6b(0x1f2)]=ZipCreatorRollback;