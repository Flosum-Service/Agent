const a335_0x4dbec2=a335_0x3253;function a335_0x3253(_0x1edafe,_0x3b75ae){const _0xf4ef9d=a335_0x4b86();return a335_0x3253=function(_0x19fe3b,_0x327dfb){_0x19fe3b=_0x19fe3b-0x17f;let _0x4b865c=_0xf4ef9d[_0x19fe3b];return _0x4b865c;},a335_0x3253(_0x1edafe,_0x3b75ae);}(function(_0x4914f5,_0x52dbff){const _0x18612c=a335_0x3253,_0x19f3b2=_0x4914f5();while(!![]){try{const _0x578599=parseInt(_0x18612c(0x199))/0x1*(parseInt(_0x18612c(0x181))/0x2)+parseInt(_0x18612c(0x1a3))/0x3+parseInt(_0x18612c(0x17f))/0x4*(parseInt(_0x18612c(0x19a))/0x5)+-parseInt(_0x18612c(0x180))/0x6+parseInt(_0x18612c(0x186))/0x7+-parseInt(_0x18612c(0x197))/0x8+parseInt(_0x18612c(0x182))/0x9*(-parseInt(_0x18612c(0x19b))/0xa);if(_0x578599===_0x52dbff)break;else _0x19f3b2['push'](_0x19f3b2['shift']());}catch(_0x4fc26d){_0x19f3b2['push'](_0x19f3b2['shift']());}}}(a335_0x4b86,0xc8e6b));const a335_0x327dfb=(function(){let _0x61198a=!![];return function(_0xc18c91,_0x40dba3){const _0x385974=_0x61198a?function(){const _0x5f1e3f=a335_0x3253;if(_0x40dba3){const _0x130087=_0x40dba3[_0x5f1e3f(0x18c)](_0xc18c91,arguments);return _0x40dba3=null,_0x130087;}}:function(){};return _0x61198a=![],_0x385974;};}()),a335_0x19fe3b=a335_0x327dfb(this,function(){const _0x18f50e=a335_0x3253;return a335_0x19fe3b['toString']()[_0x18f50e(0x188)]('(((.+)+)+)+$')['toString']()[_0x18f50e(0x193)](a335_0x19fe3b)[_0x18f50e(0x188)](_0x18f50e(0x196));});a335_0x19fe3b();function a335_0x4b86(){const _0x4ce80c=['_deploymentResults','9256842PmKHCp','.mdl','search','Builder','__importDefault','vaultpackage.xml','apply','_zip','_backup','__esModule','createZips','migration__v','defineProperty','constructor','nodebuffer','Rollback','(((.+)+)+)+$','5759080hdmjkA','stepName','48679DuqHtV','32645uFaasz','260onvjrX','xml2js','generateAsync','sortDeploymentResults','_rollbackName','Flosum','create','file','25611UgiJbz','null','868HFHXSo','166302gNqqRH','18wOpAEF','559161RanqhZ','_backupZip','ZipCreatorRollback'];a335_0x4b86=function(){return _0x4ce80c;};return a335_0x4b86();}'use strict';var __importDefault=this&&this[a335_0x4dbec2(0x18a)]||function(_0x2c0e7b){const _0x2c639c=a335_0x4dbec2;return _0x2c0e7b&&_0x2c0e7b[_0x2c639c(0x18f)]?_0x2c0e7b:{'default':_0x2c0e7b};};Object[a335_0x4dbec2(0x192)](exports,a335_0x4dbec2(0x18f),{'value':!![]}),exports[a335_0x4dbec2(0x184)]=void 0x0;const jszip_1=__importDefault(require('jszip')),factory_body_creator_rollback_1=require('./body-creator/factory.body-creator.rollback'),xml2js_1=require(a335_0x4dbec2(0x19c));class ZipCreatorRollback{constructor({deploymentResults:_0xd6b920,backup:_0x30f426,rollbackName:_0x351a85}){const _0x57fe3e=a335_0x4dbec2;this[_0x57fe3e(0x185)]=_0xd6b920,this[_0x57fe3e(0x19f)]=_0x351a85,this[_0x57fe3e(0x18e)]=_0x30f426;}async['createZips'](){const _0x581633=a335_0x4dbec2;this[_0x581633(0x183)]=new jszip_1['default'](),this[_0x581633(0x18d)]=new jszip_1['default'](),await this[_0x581633(0x183)]['loadAsync'](this[_0x581633(0x18e)],{'base64':!![]});}[a335_0x4dbec2(0x19e)](){const _0x363c62=a335_0x4dbec2;this[_0x363c62(0x185)]['sort']((_0x260e73,_0x5b6feb)=>_0x260e73[_0x363c62(0x198)]<_0x5b6feb[_0x363c62(0x198)]?0x1:_0x5b6feb['stepName']<_0x260e73[_0x363c62(0x198)]?-0x1:0x0);}async['fillZip'](){const _0x1a1be7=a335_0x4dbec2;for(const _0x5f00e1 of this[_0x1a1be7(0x185)]){const _0x149ae5=await factory_body_creator_rollback_1['FactoryBodyCreatorRollback']['create']({'deploymentResult':_0x5f00e1,'backupZip':this[_0x1a1be7(0x183)]})[_0x1a1be7(0x1a1)](),{type:_0x36fc2b,name:_0x1a6d0b}=_0x5f00e1;this[_0x1a1be7(0x18d)][_0x1a1be7(0x1a2)](_0x36fc2b+'.'+_0x1a6d0b+_0x1a1be7(0x187),_0x149ae5);}const _0x11cd85=new xml2js_1[(_0x1a1be7(0x189))]({'headless':!![]}),_0x132f44={'vaultpackage':{'$':{'xmlns':'https://veevavault.com/'},'name':this['_rollbackName'],'source':{'vault':undefined,'author':_0x1a1be7(0x1a0)},'packagetype':_0x1a1be7(0x191),'summary':_0x1a1be7(0x195),'description':_0x1a1be7(0x1a4)}};this[_0x1a1be7(0x18d)]['file'](_0x1a1be7(0x18b),_0x11cd85['buildObject'](_0x132f44));}async['create'](){const _0xb71dc7=a335_0x4dbec2;return await this[_0xb71dc7(0x190)](),this['sortDeploymentResults'](),await this['fillZip'](),this[_0xb71dc7(0x18d)][_0xb71dc7(0x19d)]({'type':_0xb71dc7(0x194)});}}exports[a335_0x4dbec2(0x184)]=ZipCreatorRollback;