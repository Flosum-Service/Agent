const a312_0x38e5a1=a312_0x26ac;(function(_0x215e25,_0x5d0728){const _0x3079d3=a312_0x26ac,_0x3a7c54=_0x215e25();while(!![]){try{const _0x30f332=parseInt(_0x3079d3(0xdc))/0x1+-parseInt(_0x3079d3(0xf5))/0x2+-parseInt(_0x3079d3(0xef))/0x3*(parseInt(_0x3079d3(0xf1))/0x4)+-parseInt(_0x3079d3(0xe6))/0x5*(-parseInt(_0x3079d3(0xd7))/0x6)+-parseInt(_0x3079d3(0xd8))/0x7*(-parseInt(_0x3079d3(0xf8))/0x8)+parseInt(_0x3079d3(0xec))/0x9+-parseInt(_0x3079d3(0xe0))/0xa*(parseInt(_0x3079d3(0xf3))/0xb);if(_0x30f332===_0x5d0728)break;else _0x3a7c54['push'](_0x3a7c54['shift']());}catch(_0x4866ee){_0x3a7c54['push'](_0x3a7c54['shift']());}}}(a312_0xfe63,0x874c7));const a312_0x49f84a=(function(){let _0x1a39a9=!![];return function(_0x20d35f,_0x5c5e77){const _0x52124e=_0x1a39a9?function(){const _0x397ba1=a312_0x26ac;if(_0x5c5e77){const _0x5bb595=_0x5c5e77[_0x397ba1(0xd6)](_0x20d35f,arguments);return _0x5c5e77=null,_0x5bb595;}}:function(){};return _0x1a39a9=![],_0x52124e;};}()),a312_0x379931=a312_0x49f84a(this,function(){const _0x4dd7f6=a312_0x26ac;return a312_0x379931[_0x4dd7f6(0xee)]()[_0x4dd7f6(0xde)]('(((.+)+)+)+$')['toString']()['constructor'](a312_0x379931)['search']('(((.+)+)+)+$');});a312_0x379931();'use strict';function a312_0xfe63(){const _0x368b0f=['ZipCreatorRollback','__esModule','2273805diQHcn','Rollback','toString','411153TxaIsA','buildObject','28BnNcJq','_rollbackName','33dsoZIF','.mdl','1078456zfhfqp','_backup','loadAsync','2359936hwDgfI','FactoryBodyCreatorRollback','defineProperty','_backupZip','apply','12JsEcnn','7eJmpZt','jszip','Flosum','fillZip','833700oISuaT','file','search','Builder','1275290MKBipi','_zip','createZips','sortDeploymentResults','stepName','migration__v','2635045nYilJR','null','create','_deploymentResults'];a312_0xfe63=function(){return _0x368b0f;};return a312_0xfe63();}var __importDefault=this&&this['__importDefault']||function(_0x30d5b2){const _0x200395=a312_0x26ac;return _0x30d5b2&&_0x30d5b2[_0x200395(0xeb)]?_0x30d5b2:{'default':_0x30d5b2};};Object[a312_0x38e5a1(0xd4)](exports,a312_0x38e5a1(0xeb),{'value':!![]}),exports[a312_0x38e5a1(0xea)]=void 0x0;const jszip_1=__importDefault(require(a312_0x38e5a1(0xd9))),factory_body_creator_rollback_1=require('./body-creator/factory.body-creator.rollback'),xml2js_1=require('xml2js');function a312_0x26ac(_0x595c2e,_0x15d9af){const _0xa0e42e=a312_0xfe63();return a312_0x26ac=function(_0x379931,_0x49f84a){_0x379931=_0x379931-0xd4;let _0xfe63e2=_0xa0e42e[_0x379931];return _0xfe63e2;},a312_0x26ac(_0x595c2e,_0x15d9af);}class ZipCreatorRollback{constructor({deploymentResults:_0x4aa259,backup:_0x51b426,rollbackName:_0xa1e4a1}){const _0x57c684=a312_0x38e5a1;this[_0x57c684(0xe9)]=_0x4aa259,this['_rollbackName']=_0xa1e4a1,this[_0x57c684(0xf6)]=_0x51b426;}async['createZips'](){const _0x134a41=a312_0x38e5a1;this['_backupZip']=new jszip_1['default'](),this[_0x134a41(0xe1)]=new jszip_1['default'](),await this[_0x134a41(0xd5)][_0x134a41(0xf7)](this[_0x134a41(0xf6)],{'base64':!![]});}[a312_0x38e5a1(0xe3)](){const _0x127af7=a312_0x38e5a1;this[_0x127af7(0xe9)]['sort']((_0x33feb1,_0x2f3798)=>_0x33feb1[_0x127af7(0xe4)]<_0x2f3798[_0x127af7(0xe4)]?0x1:_0x2f3798[_0x127af7(0xe4)]<_0x33feb1[_0x127af7(0xe4)]?-0x1:0x0);}async[a312_0x38e5a1(0xdb)](){const _0x135850=a312_0x38e5a1;for(const _0x58cb24 of this['_deploymentResults']){const _0x244c02=await factory_body_creator_rollback_1[_0x135850(0xf9)][_0x135850(0xe8)]({'deploymentResult':_0x58cb24,'backupZip':this[_0x135850(0xd5)]})[_0x135850(0xe8)](),{type:_0x2cd810,name:_0x4c2bf9}=_0x58cb24;this[_0x135850(0xe1)][_0x135850(0xdd)](_0x2cd810+'.'+_0x4c2bf9+_0x135850(0xf4),_0x244c02);}const _0x5a3889=new xml2js_1[(_0x135850(0xdf))]({'headless':!![]}),_0x2d32ab={'vaultpackage':{'$':{'xmlns':'https://veevavault.com/'},'name':this[_0x135850(0xf2)],'source':{'vault':undefined,'author':_0x135850(0xda)},'packagetype':_0x135850(0xe5),'summary':_0x135850(0xed),'description':_0x135850(0xe7)}};this[_0x135850(0xe1)][_0x135850(0xdd)]('vaultpackage.xml',_0x5a3889[_0x135850(0xf0)](_0x2d32ab));}async['create'](){const _0x18ddfb=a312_0x38e5a1;return await this[_0x18ddfb(0xe2)](),this[_0x18ddfb(0xe3)](),await this[_0x18ddfb(0xdb)](),this['_zip']['generateAsync']({'type':'nodebuffer'});}}exports[a312_0x38e5a1(0xea)]=ZipCreatorRollback;