const a335_0xd500de=a335_0xd785;function a335_0x3429(){const _0x473ca0=['105NVLmmc','stepName','Flosum','https://veevavault.com/','search','__esModule','_zip','_deploymentResults','39228jgIsub','loadAsync','_rollbackName','2064SCIDyg','createZips','2151xxHBdA','714684cKWKTw','2365092EmwKds','default','(((.+)+)+)+$','buildObject','_backup','jszip','vaultpackage.xml','__importDefault','sort','40ukPJpl','Rollback','4686vutWvW','_backupZip','generateAsync','toString','2717lDesUb','file','create','524394tfMDJo','10090EWaugf','sortDeploymentResults','xml2js','constructor','2SRqUKD','885145XpYUSj'];a335_0x3429=function(){return _0x473ca0;};return a335_0x3429();}(function(_0x263911,_0x400d00){const _0x1efdd7=a335_0xd785,_0x2af26b=_0x263911();while(!![]){try{const _0x24112b=parseInt(_0x1efdd7(0xd7))/0x1+-parseInt(_0x1efdd7(0xc7))/0x2*(-parseInt(_0x1efdd7(0xd8))/0x3)+parseInt(_0x1efdd7(0xb9))/0x4*(parseInt(_0x1efdd7(0xc8))/0x5)+parseInt(_0x1efdd7(0xc2))/0x6*(-parseInt(_0x1efdd7(0xc9))/0x7)+parseInt(_0x1efdd7(0xd4))/0x8*(parseInt(_0x1efdd7(0xd6))/0x9)+parseInt(_0x1efdd7(0xc3))/0xa*(-parseInt(_0x1efdd7(0xbb))/0xb)+-parseInt(_0x1efdd7(0xd1))/0xc*(parseInt(_0x1efdd7(0xbf))/0xd);if(_0x24112b===_0x400d00)break;else _0x2af26b['push'](_0x2af26b['shift']());}catch(_0x1a14e3){_0x2af26b['push'](_0x2af26b['shift']());}}}(a335_0x3429,0xde670));const a335_0x1bd2b6=(function(){let _0x4a37cc=!![];return function(_0x453304,_0x24f497){const _0x8ec987=_0x4a37cc?function(){if(_0x24f497){const _0x5a1406=_0x24f497['apply'](_0x453304,arguments);return _0x24f497=null,_0x5a1406;}}:function(){};return _0x4a37cc=![],_0x8ec987;};}()),a335_0x26e013=a335_0x1bd2b6(this,function(){const _0x21b42f=a335_0xd785;return a335_0x26e013[_0x21b42f(0xbe)]()['search']('(((.+)+)+)+$')[_0x21b42f(0xbe)]()[_0x21b42f(0xc6)](a335_0x26e013)[_0x21b42f(0xcd)](_0x21b42f(0xda));});a335_0x26e013();'use strict';var __importDefault=this&&this[a335_0xd500de(0xb7)]||function(_0x12d25d){const _0x4cb548=a335_0xd500de;return _0x12d25d&&_0x12d25d[_0x4cb548(0xce)]?_0x12d25d:{'default':_0x12d25d};};function a335_0xd785(_0x10ac4a,_0x2bc71c){const _0x18a63c=a335_0x3429();return a335_0xd785=function(_0x26e013,_0x1bd2b6){_0x26e013=_0x26e013-0xb5;let _0x342985=_0x18a63c[_0x26e013];return _0x342985;},a335_0xd785(_0x10ac4a,_0x2bc71c);}Object['defineProperty'](exports,a335_0xd500de(0xce),{'value':!![]}),exports['ZipCreatorRollback']=void 0x0;const jszip_1=__importDefault(require(a335_0xd500de(0xb5))),factory_body_creator_rollback_1=require('./body-creator/factory.body-creator.rollback'),xml2js_1=require(a335_0xd500de(0xc5));class ZipCreatorRollback{constructor({deploymentResults:_0x37961d,backup:_0x2a3f2d,rollbackName:_0x1de07a}){const _0x3d9d8f=a335_0xd500de;this[_0x3d9d8f(0xd0)]=_0x37961d,this['_rollbackName']=_0x1de07a,this[_0x3d9d8f(0xdc)]=_0x2a3f2d;}async['createZips'](){const _0x5970de=a335_0xd500de;this[_0x5970de(0xbc)]=new jszip_1['default'](),this[_0x5970de(0xcf)]=new jszip_1[(_0x5970de(0xd9))](),await this[_0x5970de(0xbc)][_0x5970de(0xd2)](this[_0x5970de(0xdc)],{'base64':!![]});}[a335_0xd500de(0xc4)](){const _0x199244=a335_0xd500de;this[_0x199244(0xd0)][_0x199244(0xb8)]((_0x5cbd37,_0x4a48eb)=>_0x5cbd37[_0x199244(0xca)]<_0x4a48eb[_0x199244(0xca)]?0x1:_0x4a48eb[_0x199244(0xca)]<_0x5cbd37['stepName']?-0x1:0x0);}async['fillZip'](){const _0x144c11=a335_0xd500de;for(const _0x37d44e of this[_0x144c11(0xd0)]){const _0xf9d832=await factory_body_creator_rollback_1['FactoryBodyCreatorRollback'][_0x144c11(0xc1)]({'deploymentResult':_0x37d44e,'backupZip':this[_0x144c11(0xbc)]})[_0x144c11(0xc1)](),{type:_0x153372,name:_0x175d7a}=_0x37d44e;this[_0x144c11(0xcf)][_0x144c11(0xc0)](_0x153372+'.'+_0x175d7a+'.mdl',_0xf9d832);}const _0x31f1b3=new xml2js_1['Builder']({'headless':!![]}),_0x539fd2={'vaultpackage':{'$':{'xmlns':_0x144c11(0xcc)},'name':this[_0x144c11(0xd3)],'source':{'vault':undefined,'author':_0x144c11(0xcb)},'packagetype':'migration__v','summary':_0x144c11(0xba),'description':'null'}};this[_0x144c11(0xcf)][_0x144c11(0xc0)](_0x144c11(0xb6),_0x31f1b3[_0x144c11(0xdb)](_0x539fd2));}async[a335_0xd500de(0xc1)](){const _0xf49807=a335_0xd500de;return await this[_0xf49807(0xd5)](),this[_0xf49807(0xc4)](),await this['fillZip'](),this[_0xf49807(0xcf)][_0xf49807(0xbd)]({'type':'nodebuffer'});}}exports['ZipCreatorRollback']=ZipCreatorRollback;