const a379_0x59109d=a379_0x3a47;function a379_0x3a47(_0x5d6b3e,_0x9c18ab){const _0x2e63c7=a379_0x3fa8();return a379_0x3a47=function(_0x580fb9,_0x83fb4c){_0x580fb9=_0x580fb9-0x1e9;let _0x3fa893=_0x2e63c7[_0x580fb9];return _0x3fa893;},a379_0x3a47(_0x5d6b3e,_0x9c18ab);}(function(_0x24698c,_0x36341a){const _0x44863c=a379_0x3a47,_0x335ab6=_0x24698c();while(!![]){try{const _0xd7f354=-parseInt(_0x44863c(0x204))/0x1*(-parseInt(_0x44863c(0x1ea))/0x2)+parseInt(_0x44863c(0x1f2))/0x3+-parseInt(_0x44863c(0x1f5))/0x4+parseInt(_0x44863c(0x1f9))/0x5+-parseInt(_0x44863c(0x1f7))/0x6+-parseInt(_0x44863c(0x20e))/0x7*(parseInt(_0x44863c(0x1fc))/0x8)+parseInt(_0x44863c(0x1f0))/0x9*(-parseInt(_0x44863c(0x1f8))/0xa);if(_0xd7f354===_0x36341a)break;else _0x335ab6['push'](_0x335ab6['shift']());}catch(_0x150594){_0x335ab6['push'](_0x335ab6['shift']());}}}(a379_0x3fa8,0xaabaa));const a379_0x83fb4c=(function(){let _0x1331d1=!![];return function(_0x131c1e,_0x2b60e9){const _0x28818e=_0x1331d1?function(){if(_0x2b60e9){const _0x101836=_0x2b60e9['apply'](_0x131c1e,arguments);return _0x2b60e9=null,_0x101836;}}:function(){};return _0x1331d1=![],_0x28818e;};}()),a379_0x580fb9=a379_0x83fb4c(this,function(){const _0x31fc74=a379_0x3a47;return a379_0x580fb9[_0x31fc74(0x201)]()[_0x31fc74(0x1fe)](_0x31fc74(0x1f6))['toString']()[_0x31fc74(0x200)](a379_0x580fb9)[_0x31fc74(0x1fe)](_0x31fc74(0x1f6));});a379_0x580fb9();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2f6081){const _0x3bd769=a379_0x3a47;return _0x2f6081&&_0x2f6081[_0x3bd769(0x211)]?_0x2f6081:{'default':_0x2f6081};};Object[a379_0x59109d(0x1ee)](exports,a379_0x59109d(0x211),{'value':!![]}),exports['ZipCreatorRollback']=void 0x0;function a379_0x3fa8(){const _0x4bb4c8=['Flosum','FactoryBodyCreatorRollback','fillZip','21RRcuXw','.mdl','stepName','__esModule','loadAsync','1914ybtwnW','buildObject','null','default','defineProperty','_deploymentResults','9MbnNht','_backupZip','3807684UbMWor','xml2js','_zip','2323316swzuYf','(((.+)+)+)+$','6020316cqbUJK','3483080zVipsy','5102585niYFPB','create','createZips','1433064JFvkJl','sortDeploymentResults','search','_backup','constructor','toString','Builder','https://veevavault.com/','919nlAMGn','migration__v','jszip','generateAsync','_rollbackName','file','ZipCreatorRollback'];a379_0x3fa8=function(){return _0x4bb4c8;};return a379_0x3fa8();}const jszip_1=__importDefault(require(a379_0x59109d(0x206))),factory_body_creator_rollback_1=require('./body-creator/factory.body-creator.rollback'),xml2js_1=require(a379_0x59109d(0x1f3));class ZipCreatorRollback{constructor({deploymentResults:_0x4b085d,backup:_0x4939ac,rollbackName:_0x250d3e}){const _0x43a385=a379_0x59109d;this['_deploymentResults']=_0x4b085d,this[_0x43a385(0x208)]=_0x250d3e,this['_backup']=_0x4939ac;}async[a379_0x59109d(0x1fb)](){const _0x3bbf2f=a379_0x59109d;this[_0x3bbf2f(0x1f1)]=new jszip_1[(_0x3bbf2f(0x1ed))](),this[_0x3bbf2f(0x1f4)]=new jszip_1[(_0x3bbf2f(0x1ed))](),await this[_0x3bbf2f(0x1f1)][_0x3bbf2f(0x1e9)](this[_0x3bbf2f(0x1ff)],{'base64':!![]});}[a379_0x59109d(0x1fd)](){const _0x3f5455=a379_0x59109d;this[_0x3f5455(0x1ef)]['sort']((_0x1fc0ae,_0x71c1c7)=>_0x1fc0ae[_0x3f5455(0x210)]<_0x71c1c7[_0x3f5455(0x210)]?0x1:_0x71c1c7['stepName']<_0x1fc0ae[_0x3f5455(0x210)]?-0x1:0x0);}async['fillZip'](){const _0x5ae1fa=a379_0x59109d;for(const _0xf5301a of this[_0x5ae1fa(0x1ef)]){const _0x524850=await factory_body_creator_rollback_1[_0x5ae1fa(0x20c)]['create']({'deploymentResult':_0xf5301a,'backupZip':this[_0x5ae1fa(0x1f1)]})[_0x5ae1fa(0x1fa)](),{type:_0x539c0b,name:_0x5c8095}=_0xf5301a;this[_0x5ae1fa(0x1f4)]['file'](_0x539c0b+'.'+_0x5c8095+_0x5ae1fa(0x20f),_0x524850);}const _0xed7a=new xml2js_1[(_0x5ae1fa(0x202))]({'headless':!![]}),_0x238d1c={'vaultpackage':{'$':{'xmlns':_0x5ae1fa(0x203)},'name':this['_rollbackName'],'source':{'vault':undefined,'author':_0x5ae1fa(0x20b)},'packagetype':_0x5ae1fa(0x205),'summary':'Rollback','description':_0x5ae1fa(0x1ec)}};this['_zip'][_0x5ae1fa(0x209)]('vaultpackage.xml',_0xed7a[_0x5ae1fa(0x1eb)](_0x238d1c));}async[a379_0x59109d(0x1fa)](){const _0x282d4f=a379_0x59109d;return await this[_0x282d4f(0x1fb)](),this[_0x282d4f(0x1fd)](),await this[_0x282d4f(0x20d)](),this[_0x282d4f(0x1f4)][_0x282d4f(0x207)]({'type':'nodebuffer'});}}exports[a379_0x59109d(0x20a)]=ZipCreatorRollback;