const a318_0x4dbb71=a318_0x1f4c;(function(_0x22ad84,_0x5be0d6){const _0x1b0d80=a318_0x1f4c,_0x4d820c=_0x22ad84();while(!![]){try{const _0x12424a=-parseInt(_0x1b0d80(0x124))/0x1+parseInt(_0x1b0d80(0x11a))/0x2*(parseInt(_0x1b0d80(0xff))/0x3)+-parseInt(_0x1b0d80(0x138))/0x4+parseInt(_0x1b0d80(0x110))/0x5+-parseInt(_0x1b0d80(0x118))/0x6+parseInt(_0x1b0d80(0x10d))/0x7+parseInt(_0x1b0d80(0x13e))/0x8*(parseInt(_0x1b0d80(0x12d))/0x9);if(_0x12424a===_0x5be0d6)break;else _0x4d820c['push'](_0x4d820c['shift']());}catch(_0x2e9794){_0x4d820c['push'](_0x4d820c['shift']());}}}(a318_0x6aa0,0x3e8c1));const a318_0xdc81c8=(function(){let _0x33362d=!![];return function(_0x17af73,_0x12405f){const _0x571d82=_0x33362d?function(){if(_0x12405f){const _0x371e5b=_0x12405f['apply'](_0x17af73,arguments);return _0x12405f=null,_0x371e5b;}}:function(){};return _0x33362d=![],_0x571d82;};}()),a318_0x4eb931=a318_0xdc81c8(this,function(){const _0x58a019=a318_0x1f4c;return a318_0x4eb931['toString']()['search']('(((.+)+)+)+$')[_0x58a019(0x125)]()[_0x58a019(0x126)](a318_0x4eb931)[_0x58a019(0x10e)](_0x58a019(0x122));});a318_0x4eb931();'use strict';var __decorate=this&&this['__decorate']||function(_0x2015ce,_0x44a5ee,_0x4da385,_0x5833b5){const _0x44d292=a318_0x1f4c;var _0x3df4fb=arguments[_0x44d292(0x100)],_0x107b7d=_0x3df4fb<0x3?_0x44a5ee:_0x5833b5===null?_0x5833b5=Object[_0x44d292(0x131)](_0x44a5ee,_0x4da385):_0x5833b5,_0x364c89;if(typeof Reflect===_0x44d292(0x13d)&&typeof Reflect[_0x44d292(0x119)]===_0x44d292(0x12a))_0x107b7d=Reflect[_0x44d292(0x119)](_0x2015ce,_0x44a5ee,_0x4da385,_0x5833b5);else{for(var _0x1bd96b=_0x2015ce[_0x44d292(0x100)]-0x1;_0x1bd96b>=0x0;_0x1bd96b--)if(_0x364c89=_0x2015ce[_0x1bd96b])_0x107b7d=(_0x3df4fb<0x3?_0x364c89(_0x107b7d):_0x3df4fb>0x3?_0x364c89(_0x44a5ee,_0x4da385,_0x107b7d):_0x364c89(_0x44a5ee,_0x4da385))||_0x107b7d;}return _0x3df4fb>0x3&&_0x107b7d&&Object[_0x44d292(0x107)](_0x44a5ee,_0x4da385,_0x107b7d),_0x107b7d;},__metadata=this&&this[a318_0x4dbb71(0x106)]||function(_0x4e533b,_0x5eacd7){const _0x230425=a318_0x4dbb71;if(typeof Reflect===_0x230425(0x13d)&&typeof Reflect[_0x230425(0x10c)]===_0x230425(0x12a))return Reflect['metadata'](_0x4e533b,_0x5eacd7);},__param=this&&this[a318_0x4dbb71(0x10a)]||function(_0x34ca63,_0x366486){return function(_0x570309,_0x376e3f){_0x366486(_0x570309,_0x376e3f,_0x34ca63);};},__importDefault=this&&this['__importDefault']||function(_0x4d10a0){const _0x4df618=a318_0x4dbb71;return _0x4d10a0&&_0x4d10a0[_0x4df618(0x13f)]?_0x4d10a0:{'default':_0x4d10a0};};function a318_0x6aa0(){const _0x4f6ee8=['./utils/veeva-request.utils','DependencyService','createSalesforceRequest','SnapshotService','object','5208384gFGcjM','__esModule','../../core','./classes/errors/base-veeva-error','design:paramtypes','385311qtecmv','length','./classes/auth/salesforce-auth','message','BaseVeevaError','VeevaAuth','param','__metadata','defineProperty','AppResponseStatus','shortid','__param','default','metadata','232869GqbakS','search','Post','1447480OnNjLb','./classes/auth/veeva-auth','VeevaVaultController','FAILURE','doSnapshot','Controller','instanceUrl','deployFromBranch','73248fewUCt','decorate','4jpbnZM','./services/deploy.service','getAuthDetails','retrieveDependency','prototype','body','./utils/fs-util','./classes/logger','(((.+)+)+)+$','design:type','508356JyVflJ','toString','constructor','veeva-vault','./services/dependency.service','temp/veeva/deploy_','function','DeployService','SUCCESS','9mdldQy','Logger','./enums/status.enums','SalesforceAuth','getOwnPropertyDescriptor','execute','Version','makeDir','getMessages','createVeevaRequest','design:returntype','1815712mTgudY'];a318_0x6aa0=function(){return _0x4f6ee8;};return a318_0x6aa0();}function a318_0x1f4c(_0x2d1ce9,_0x571d29){const _0x12db53=a318_0x6aa0();return a318_0x1f4c=function(_0x4eb931,_0xdc81c8){_0x4eb931=_0x4eb931-0xfc;let _0x6aa07a=_0x12db53[_0x4eb931];return _0x6aa07a;},a318_0x1f4c(_0x2d1ce9,_0x571d29);}Object[a318_0x4dbb71(0x107)](exports,a318_0x4dbb71(0x13f),{'value':!![]}),exports['VeevaVaultController']=void 0x0;const core_1=require(a318_0x4dbb71(0xfc)),dependency_service_1=require(a318_0x4dbb71(0x128)),snapshot_service_1=require('./services/snapshot.service'),deploy_service_1=require(a318_0x4dbb71(0x11b)),veeva_request_utils_1=require(a318_0x4dbb71(0x139)),status_enums_1=require(a318_0x4dbb71(0x12f)),shortid_1=__importDefault(require(a318_0x4dbb71(0x109))),fs_util_1=require(a318_0x4dbb71(0x120)),logger_1=require(a318_0x4dbb71(0x121)),promises_1=require('fs/promises'),base_veeva_error_1=require(a318_0x4dbb71(0xfd)),salesforce_request_utils_1=require('./utils/salesforce-request.utils'),veeva_auth_1=require(a318_0x4dbb71(0x111)),salesforce_auth_1=require(a318_0x4dbb71(0x101)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a318_0x4dbb71(0x114)](_0x38b062){const _0x410f64=a318_0x4dbb71,{veevaAuth:_0xc1c5ef,timeZone:_0x3c71e7,attachmentLogId:_0x5476de}=_0x38b062;try{const _0x1e3001=(0x0,veeva_request_utils_1[_0x410f64(0x136)])(new veeva_auth_1[(_0x410f64(0x104))](_0xc1c5ef,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x56111e=await salesforce_auth_1[_0x410f64(0x130)]['getAuthDetails'](),_0x23fcd2=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x410f64(0x130))](_0x56111e)),_0x208f5f=new logger_1['Logger'](_0x23fcd2,_0x3c71e7,_0x5476de),_0x20074a=new snapshot_service_1[(_0x410f64(0x13c))](_0x38b062,_0x23fcd2,_0x1e3001,_0x208f5f);return _0x20074a['execute']()['then'](),{'responseStatus':status_enums_1[_0x410f64(0x108)][_0x410f64(0x12c)]};}catch(_0x191e7d){return{'responseStatus':status_enums_1[_0x410f64(0x108)][_0x410f64(0x113)],'responseMessage':_0x191e7d[_0x410f64(0x102)]};}}async['deployFromBranch'](_0x118076){const _0xaa5630=a318_0x4dbb71,{veevaAuth:_0xcba80,timeZone:_0x54f835,attachmentLogId:_0x2b49a8}=_0x118076;try{const _0x163f59=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0xaa5630(0x104))](_0xcba80,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x48cd4b=await salesforce_auth_1[_0xaa5630(0x130)][_0xaa5630(0x11c)](),_0x4f9ea5=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0xaa5630(0x130))](_0x48cd4b)),_0x440dae=new logger_1[(_0xaa5630(0x12e))](_0x4f9ea5,_0x54f835,_0x2b49a8),_0xed302f=_0xaa5630(0x129)+(0x0,shortid_1[_0xaa5630(0x10b)])();await(0x0,fs_util_1[_0xaa5630(0x134)])(_0xed302f);const _0x2f3485=new deploy_service_1[(_0xaa5630(0x12b))](_0x118076,_0x4f9ea5,_0x163f59,_0x440dae,_0xed302f,_0x48cd4b[_0xaa5630(0x116)]);return _0x2f3485['execute']()['finally'](()=>(0x0,promises_1['rm'])(_0xed302f,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0xaa5630(0x108)][_0xaa5630(0x12c)]};}catch(_0x7a3ce4){return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x7a3ce4['message']};}}async[a318_0x4dbb71(0x11d)](_0x50c799){const _0x4acf57=a318_0x4dbb71,{veevaAuth:_0x43b6bd}=_0x50c799;try{const _0x15238a=(0x0,veeva_request_utils_1[_0x4acf57(0x136)])(new veeva_auth_1[(_0x4acf57(0x104))](_0x43b6bd)),_0x4f0377=await salesforce_auth_1[_0x4acf57(0x130)][_0x4acf57(0x11c)](),_0x2bfe35=(0x0,salesforce_request_utils_1[_0x4acf57(0x13b)])(new salesforce_auth_1[(_0x4acf57(0x130))](_0x4f0377)),_0x3220df=new dependency_service_1[(_0x4acf57(0x13a))](_0x50c799,_0x2bfe35,_0x15238a);return await _0x3220df[_0x4acf57(0x132)]();}catch(_0x2e682e){const _0x28edad=_0x2e682e instanceof base_veeva_error_1[_0x4acf57(0x103)]?_0x2e682e[_0x4acf57(0x135)]()['join']('\x0a'):_0x2e682e[_0x4acf57(0x102)];return{'responseStatus':status_enums_1[_0x4acf57(0x108)][_0x4acf57(0x113)],'responseMessage':_0x28edad};}}};__decorate([(0x0,core_1[a318_0x4dbb71(0x10f)])('snapshot'),__param(0x0,core_1[a318_0x4dbb71(0x105)]['body']()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(a318_0x4dbb71(0x137),Promise)],VeevaVaultController[a318_0x4dbb71(0x11e)],a318_0x4dbb71(0x114),null),__decorate([(0x0,core_1[a318_0x4dbb71(0x10f)])('deploy'),__param(0x0,core_1[a318_0x4dbb71(0x105)][a318_0x4dbb71(0x11f)]()),__metadata(a318_0x4dbb71(0x123),Function),__metadata(a318_0x4dbb71(0xfe),[Object]),__metadata(a318_0x4dbb71(0x137),Promise)],VeevaVaultController[a318_0x4dbb71(0x11e)],a318_0x4dbb71(0x117),null),__decorate([(0x0,core_1[a318_0x4dbb71(0x10f)])('dependency'),__param(0x0,core_1[a318_0x4dbb71(0x105)][a318_0x4dbb71(0x11f)]()),__metadata('design:type',Function),__metadata(a318_0x4dbb71(0xfe),[Object]),__metadata(a318_0x4dbb71(0x137),Promise)],VeevaVaultController['prototype'],a318_0x4dbb71(0x11d),null),VeevaVaultController=__decorate([(0x0,core_1[a318_0x4dbb71(0x115)])(a318_0x4dbb71(0x127)),(0x0,core_1[a318_0x4dbb71(0x133)])('v1')],VeevaVaultController),exports[a318_0x4dbb71(0x112)]=VeevaVaultController;