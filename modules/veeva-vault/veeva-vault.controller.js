const a415_0x75888d=a415_0x5240;function a415_0x8697(){const _0x30236d=['temp/veeva/deploy_','getAuthDetails','veeva-vault','./services/snapshot.service','shortid','snapshot','561640zuiKFl','BaseVeevaError','v1.1','design:paramtypes','25740162NGnTRn','VeevaAuth','__importDefault','3MbLIyp','search','function','__metadata','./classes/errors/base-veeva-error','temp/veeva/rollback_','FAILURE','Post','default','then','deployFromBranch','toString','1404570OKQeIN','./utils/salesforce-request.utils','object','constructor','design:returntype','retrieveDependency','body','doSnapshot','length','finally','dependency','162538bqcHYH','design:type','Logger','./services/deploy.service','message','prototype','./classes/auth/salesforce-auth','execute','Version','deploy','1874152BfhcsJ','Controller','VeevaVaultController','49oBjnsl','./classes/loggers/logger','instanceUrl','createVeevaRequest','metadata','SUCCESS','__esModule','./services/dependency.service','./utils/veeva-request.utils','5042230TbRJRl','param','fs/promises','3007074LOkBuV','./services/rollback.service','SnapshotService','rollback','DependencyService','__decorate','(((.+)+)+)+$','AppResponseStatus','SalesforceAuth','defineProperty','./enums/status.enums','createSalesforceRequest','../../core','apply'];a415_0x8697=function(){return _0x30236d;};return a415_0x8697();}(function(_0x4d651d,_0x186079){const _0x54f2a2=a415_0x5240,_0xc397e2=_0x4d651d();while(!![]){try{const _0x120c7a=-parseInt(_0x54f2a2(0x1c5))/0x1+-parseInt(_0x54f2a2(0x1ba))/0x2*(parseInt(_0x54f2a2(0x1f9))/0x3)+-parseInt(_0x54f2a2(0x1cf))/0x4+-parseInt(_0x54f2a2(0x1db))/0x5+-parseInt(_0x54f2a2(0x1de))/0x6+parseInt(_0x54f2a2(0x1d2))/0x7*(parseInt(_0x54f2a2(0x1f2))/0x8)+parseInt(_0x54f2a2(0x1f6))/0x9;if(_0x120c7a===_0x186079)break;else _0xc397e2['push'](_0xc397e2['shift']());}catch(_0x1a625a){_0xc397e2['push'](_0xc397e2['shift']());}}}(a415_0x8697,0x7c233));const a415_0x10d3db=(function(){let _0x511396=!![];return function(_0x599b44,_0x233d93){const _0x2674ea=_0x511396?function(){const _0x32e836=a415_0x5240;if(_0x233d93){const _0x1bd5b4=_0x233d93[_0x32e836(0x1eb)](_0x599b44,arguments);return _0x233d93=null,_0x1bd5b4;}}:function(){};return _0x511396=![],_0x2674ea;};}()),a415_0x30349e=a415_0x10d3db(this,function(){const _0x527ebb=a415_0x5240;return a415_0x30349e[_0x527ebb(0x1b9)]()[_0x527ebb(0x1fa)](_0x527ebb(0x1e4))[_0x527ebb(0x1b9)]()[_0x527ebb(0x1bd)](a415_0x30349e)[_0x527ebb(0x1fa)]('(((.+)+)+)+$');});a415_0x30349e();'use strict';var __decorate=this&&this[a415_0x75888d(0x1e3)]||function(_0x19937f,_0x5589fe,_0x514e75,_0xc3e622){const _0x24b27d=a415_0x75888d;var _0x4708c3=arguments[_0x24b27d(0x1c2)],_0x218e8a=_0x4708c3<0x3?_0x5589fe:_0xc3e622===null?_0xc3e622=Object['getOwnPropertyDescriptor'](_0x5589fe,_0x514e75):_0xc3e622,_0x13c7c8;if(typeof Reflect===_0x24b27d(0x1bc)&&typeof Reflect['decorate']===_0x24b27d(0x1b0))_0x218e8a=Reflect['decorate'](_0x19937f,_0x5589fe,_0x514e75,_0xc3e622);else{for(var _0x5c96a3=_0x19937f['length']-0x1;_0x5c96a3>=0x0;_0x5c96a3--)if(_0x13c7c8=_0x19937f[_0x5c96a3])_0x218e8a=(_0x4708c3<0x3?_0x13c7c8(_0x218e8a):_0x4708c3>0x3?_0x13c7c8(_0x5589fe,_0x514e75,_0x218e8a):_0x13c7c8(_0x5589fe,_0x514e75))||_0x218e8a;}return _0x4708c3>0x3&&_0x218e8a&&Object['defineProperty'](_0x5589fe,_0x514e75,_0x218e8a),_0x218e8a;},__metadata=this&&this[a415_0x75888d(0x1b1)]||function(_0xf25c97,_0x2166df){const _0x542859=a415_0x75888d;if(typeof Reflect===_0x542859(0x1bc)&&typeof Reflect[_0x542859(0x1d6)]==='function')return Reflect[_0x542859(0x1d6)](_0xf25c97,_0x2166df);},__param=this&&this['__param']||function(_0x27a112,_0x465048){return function(_0x297af2,_0x291b6f){_0x465048(_0x297af2,_0x291b6f,_0x27a112);};},__importDefault=this&&this[a415_0x75888d(0x1f8)]||function(_0x191aaa){const _0x4b19cd=a415_0x75888d;return _0x191aaa&&_0x191aaa[_0x4b19cd(0x1d8)]?_0x191aaa:{'default':_0x191aaa};};Object[a415_0x75888d(0x1e7)](exports,a415_0x75888d(0x1d8),{'value':!![]}),exports[a415_0x75888d(0x1d1)]=void 0x0;const core_1=require(a415_0x75888d(0x1ea)),dependency_service_1=require(a415_0x75888d(0x1d9)),snapshot_service_1=require(a415_0x75888d(0x1ef)),deploy_service_1=require(a415_0x75888d(0x1c8)),veeva_request_utils_1=require(a415_0x75888d(0x1da)),status_enums_1=require(a415_0x75888d(0x1e8)),shortid_1=__importDefault(require(a415_0x75888d(0x1f0))),fs_util_1=require('./utils/fs-util'),logger_1=require(a415_0x75888d(0x1d3)),promises_1=require(a415_0x75888d(0x1dd)),base_veeva_error_1=require(a415_0x75888d(0x1b2)),salesforce_request_utils_1=require(a415_0x75888d(0x1bb)),veeva_auth_1=require('./classes/auth/veeva-auth'),salesforce_auth_1=require(a415_0x75888d(0x1cb)),rollback_service_1=require(a415_0x75888d(0x1df)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async['doSnapshot'](_0xe5ffd8){const _0x36210=a415_0x75888d,{veevaAuth:_0x1b34d4,timeZone:_0x42d498,attachmentLogId:_0x527366}=_0xe5ffd8;try{const _0x9e1dd8=(0x0,veeva_request_utils_1[_0x36210(0x1d5)])(new veeva_auth_1[(_0x36210(0x1f7))](_0x1b34d4,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x3f136b=await salesforce_auth_1[_0x36210(0x1e6)][_0x36210(0x1ed)](),_0x519bff=(0x0,salesforce_request_utils_1[_0x36210(0x1e9)])(new salesforce_auth_1['SalesforceAuth'](_0x3f136b)),_0x2ca5e3=new logger_1[(_0x36210(0x1c7))](_0x519bff,_0x42d498,_0x527366),_0x74f1f9=new snapshot_service_1[(_0x36210(0x1e0))](_0xe5ffd8,_0x519bff,_0x9e1dd8,_0x2ca5e3);return _0x74f1f9[_0x36210(0x1cc)]()[_0x36210(0x1b7)](),{'responseStatus':status_enums_1[_0x36210(0x1e5)][_0x36210(0x1d7)]};}catch(_0xc354c2){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x36210(0x1b4)],'responseMessage':_0xc354c2[_0x36210(0x1c9)]};}}async[a415_0x75888d(0x1b8)](_0x57a55b){const _0x373d22=a415_0x75888d,{veevaAuth:_0x3509a3,timeZone:_0x264602,attachmentLogId:_0x481421}=_0x57a55b;try{const _0x2e6264=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1['VeevaAuth'](_0x3509a3,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x3da3a6=await salesforce_auth_1[_0x373d22(0x1e6)]['getAuthDetails'](),_0x4cde76=(0x0,salesforce_request_utils_1[_0x373d22(0x1e9)])(new salesforce_auth_1[(_0x373d22(0x1e6))](_0x3da3a6)),_0x114c27=new logger_1['Logger'](_0x4cde76,_0x264602,_0x481421),_0x2cc765=_0x373d22(0x1ec)+(0x0,shortid_1['default'])();await(0x0,fs_util_1['makeDir'])(_0x2cc765);const _0x45cfae=new deploy_service_1['DeployService'](_0x57a55b,_0x4cde76,_0x2e6264,_0x114c27,_0x2cc765,_0x3da3a6[_0x373d22(0x1d4)]);return _0x45cfae[_0x373d22(0x1cc)]()[_0x373d22(0x1c3)](()=>(0x0,promises_1['rm'])(_0x2cc765,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x373d22(0x1e5)]['SUCCESS']};}catch(_0x5ab8a8){return{'responseStatus':status_enums_1[_0x373d22(0x1e5)][_0x373d22(0x1b4)],'responseMessage':_0x5ab8a8[_0x373d22(0x1c9)]};}}async[a415_0x75888d(0x1bf)](_0x40a0b2){const _0x429caa=a415_0x75888d,{veevaAuth:_0x12aa44}=_0x40a0b2;try{const _0x49a930=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x429caa(0x1f7))](_0x12aa44)),_0x164437=await salesforce_auth_1[_0x429caa(0x1e6)]['getAuthDetails'](),_0x5ff471=(0x0,salesforce_request_utils_1[_0x429caa(0x1e9)])(new salesforce_auth_1[(_0x429caa(0x1e6))](_0x164437)),_0x1398a5=new dependency_service_1[(_0x429caa(0x1e2))](_0x40a0b2,_0x5ff471,_0x49a930);return await _0x1398a5[_0x429caa(0x1cc)]();}catch(_0x2444b1){const _0x3a817c=_0x2444b1 instanceof base_veeva_error_1[_0x429caa(0x1f3)]?_0x2444b1['getMessages']()['join']('\x0a'):_0x2444b1[_0x429caa(0x1c9)];return{'responseStatus':status_enums_1[_0x429caa(0x1e5)][_0x429caa(0x1b4)],'responseMessage':_0x3a817c};}}async[a415_0x75888d(0x1e1)](_0x55a012){const _0x7d811c=a415_0x75888d,{veevaAuth:_0x48d369,timeZone:_0x15812a,attachmentLogId:_0x1523d5}=_0x55a012;try{const _0x400434=(0x0,veeva_request_utils_1[_0x7d811c(0x1d5)])(new veeva_auth_1[(_0x7d811c(0x1f7))](_0x48d369,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x332472=await salesforce_auth_1[_0x7d811c(0x1e6)]['getAuthDetails'](),_0x356b57=(0x0,salesforce_request_utils_1[_0x7d811c(0x1e9)])(new salesforce_auth_1[(_0x7d811c(0x1e6))](_0x332472)),_0x5aae31=new logger_1['Logger'](_0x356b57,_0x15812a,_0x1523d5),_0x4fc821=_0x7d811c(0x1b3)+(0x0,shortid_1[_0x7d811c(0x1b6)])();await(0x0,fs_util_1['makeDir'])(_0x4fc821);const _0x12f629=new rollback_service_1['RollbackService']({..._0x55a012,'connectionVeeva':_0x400434,'connectionSalesforce':_0x356b57,'logger':_0x5aae31,'tempFolder':_0x4fc821,'instanceUrl':_0x332472[_0x7d811c(0x1d4)]});return _0x12f629[_0x7d811c(0x1cc)]()[_0x7d811c(0x1c3)](()=>(0x0,promises_1['rm'])(_0x4fc821,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x7d811c(0x1d7)]};}catch(_0x49c9ff){return{'responseStatus':status_enums_1[_0x7d811c(0x1e5)][_0x7d811c(0x1b4)],'responseMessage':_0x49c9ff[_0x7d811c(0x1c9)]};}}};function a415_0x5240(_0x3b27b3,_0x22d7a7){const _0x3d7d1c=a415_0x8697();return a415_0x5240=function(_0x30349e,_0x10d3db){_0x30349e=_0x30349e-0x1b0;let _0x869783=_0x3d7d1c[_0x30349e];return _0x869783;},a415_0x5240(_0x3b27b3,_0x22d7a7);}__decorate([(0x0,core_1['Post'])(a415_0x75888d(0x1f1)),__param(0x0,core_1[a415_0x75888d(0x1dc)][a415_0x75888d(0x1c0)]()),__metadata('design:type',Function),__metadata(a415_0x75888d(0x1f5),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController['prototype'],a415_0x75888d(0x1c1),null),__decorate([(0x0,core_1[a415_0x75888d(0x1b5)])(a415_0x75888d(0x1ce)),__param(0x0,core_1[a415_0x75888d(0x1dc)][a415_0x75888d(0x1c0)]()),__metadata(a415_0x75888d(0x1c6),Function),__metadata(a415_0x75888d(0x1f5),[Object]),__metadata(a415_0x75888d(0x1be),Promise)],VeevaVaultController[a415_0x75888d(0x1ca)],a415_0x75888d(0x1b8),null),__decorate([(0x0,core_1[a415_0x75888d(0x1b5)])(a415_0x75888d(0x1c4)),__param(0x0,core_1[a415_0x75888d(0x1dc)]['body']()),__metadata(a415_0x75888d(0x1c6),Function),__metadata(a415_0x75888d(0x1f5),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController['prototype'],'retrieveDependency',null),__decorate([(0x0,core_1[a415_0x75888d(0x1b5)])(a415_0x75888d(0x1e1)),__param(0x0,core_1[a415_0x75888d(0x1dc)][a415_0x75888d(0x1c0)]()),__metadata(a415_0x75888d(0x1c6),Function),__metadata(a415_0x75888d(0x1f5),[Object]),__metadata(a415_0x75888d(0x1be),Promise)],VeevaVaultController[a415_0x75888d(0x1ca)],'rollback',null),VeevaVaultController=__decorate([(0x0,core_1[a415_0x75888d(0x1d0)])(a415_0x75888d(0x1ee)),(0x0,core_1[a415_0x75888d(0x1cd)])(a415_0x75888d(0x1f4))],VeevaVaultController),exports[a415_0x75888d(0x1d1)]=VeevaVaultController;