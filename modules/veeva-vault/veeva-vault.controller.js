function a415_0x3082(_0x5b68ec,_0x30ea83){const _0x2f28ae=a415_0x375e();return a415_0x3082=function(_0x3a7f17,_0x5b5c6f){_0x3a7f17=_0x3a7f17-0x139;let _0x375e79=_0x2f28ae[_0x3a7f17];return _0x375e79;},a415_0x3082(_0x5b68ec,_0x30ea83);}const a415_0x4dfe90=a415_0x3082;(function(_0x17cc18,_0x335d6e){const _0x513b0d=a415_0x3082,_0x25ed64=_0x17cc18();while(!![]){try{const _0x1277a8=parseInt(_0x513b0d(0x13c))/0x1*(parseInt(_0x513b0d(0x169))/0x2)+parseInt(_0x513b0d(0x161))/0x3+-parseInt(_0x513b0d(0x159))/0x4*(parseInt(_0x513b0d(0x13b))/0x5)+parseInt(_0x513b0d(0x153))/0x6*(-parseInt(_0x513b0d(0x13e))/0x7)+-parseInt(_0x513b0d(0x156))/0x8*(-parseInt(_0x513b0d(0x14a))/0x9)+parseInt(_0x513b0d(0x165))/0xa+-parseInt(_0x513b0d(0x170))/0xb;if(_0x1277a8===_0x335d6e)break;else _0x25ed64['push'](_0x25ed64['shift']());}catch(_0x1b026c){_0x25ed64['push'](_0x25ed64['shift']());}}}(a415_0x375e,0x5b679));const a415_0x5b5c6f=(function(){let _0x12b9d6=!![];return function(_0x5ac3f5,_0x403796){const _0x90d26b=_0x12b9d6?function(){const _0x340ce3=a415_0x3082;if(_0x403796){const _0x5f3c76=_0x403796[_0x340ce3(0x163)](_0x5ac3f5,arguments);return _0x403796=null,_0x5f3c76;}}:function(){};return _0x12b9d6=![],_0x90d26b;};}()),a415_0x3a7f17=a415_0x5b5c6f(this,function(){const _0x48f61e=a415_0x3082;return a415_0x3a7f17[_0x48f61e(0x13d)]()[_0x48f61e(0x14b)](_0x48f61e(0x149))[_0x48f61e(0x13d)]()['constructor'](a415_0x3a7f17)[_0x48f61e(0x14b)]('(((.+)+)+)+$');});a415_0x3a7f17();'use strict';var __decorate=this&&this[a415_0x4dfe90(0x171)]||function(_0x12b55c,_0x204041,_0x31d143,_0x287ded){const _0x2e9518=a415_0x4dfe90;var _0x419a0b=arguments[_0x2e9518(0x15e)],_0x43e7fa=_0x419a0b<0x3?_0x204041:_0x287ded===null?_0x287ded=Object[_0x2e9518(0x13a)](_0x204041,_0x31d143):_0x287ded,_0x2fbb4f;if(typeof Reflect===_0x2e9518(0x180)&&typeof Reflect[_0x2e9518(0x158)]===_0x2e9518(0x17c))_0x43e7fa=Reflect[_0x2e9518(0x158)](_0x12b55c,_0x204041,_0x31d143,_0x287ded);else{for(var _0x54d2cc=_0x12b55c[_0x2e9518(0x15e)]-0x1;_0x54d2cc>=0x0;_0x54d2cc--)if(_0x2fbb4f=_0x12b55c[_0x54d2cc])_0x43e7fa=(_0x419a0b<0x3?_0x2fbb4f(_0x43e7fa):_0x419a0b>0x3?_0x2fbb4f(_0x204041,_0x31d143,_0x43e7fa):_0x2fbb4f(_0x204041,_0x31d143))||_0x43e7fa;}return _0x419a0b>0x3&&_0x43e7fa&&Object[_0x2e9518(0x15c)](_0x204041,_0x31d143,_0x43e7fa),_0x43e7fa;},__metadata=this&&this[a415_0x4dfe90(0x154)]||function(_0x4fc28f,_0x39c2ed){const _0x447aab=a415_0x4dfe90;if(typeof Reflect===_0x447aab(0x180)&&typeof Reflect[_0x447aab(0x186)]===_0x447aab(0x17c))return Reflect['metadata'](_0x4fc28f,_0x39c2ed);},__param=this&&this[a415_0x4dfe90(0x16f)]||function(_0x20ee37,_0x6b7920){return function(_0x5a0adc,_0x5a9149){_0x6b7920(_0x5a0adc,_0x5a9149,_0x20ee37);};},__importDefault=this&&this[a415_0x4dfe90(0x152)]||function(_0x4aad6b){const _0x121162=a415_0x4dfe90;return _0x4aad6b&&_0x4aad6b[_0x121162(0x15b)]?_0x4aad6b:{'default':_0x4aad6b};};Object['defineProperty'](exports,a415_0x4dfe90(0x15b),{'value':!![]}),exports[a415_0x4dfe90(0x175)]=void 0x0;function a415_0x375e(){const _0x608f3c=['default','__importDefault','96mQmCyk','__metadata','doSnapshot','1466104dlkPwN','v1.1','decorate','781336jpIGQi','./enums/status.enums','__esModule','defineProperty','./services/rollback.service','length','message','param','964041tvTojN','finally','apply','shortid','6878720HSBTOS','makeDir','./classes/errors/base-veeva-error','SUCCESS','342410lnvCkY','DependencyService','join','deployFromBranch','./classes/auth/veeva-auth','design:returntype','__param','5502123oOayBf','__decorate','snapshot','then','Logger','VeevaVaultController','execute','veeva-vault','createSalesforceRequest','VeevaAuth','./utils/veeva-request.utils','body','function','Controller','instanceUrl','design:paramtypes','object','retrieveDependency','prototype','RollbackService','./utils/fs-util','createVeevaRequest','metadata','design:type','getOwnPropertyDescriptor','10MwWDta','1ewftRE','toString','123242kvllCq','SalesforceAuth','./utils/salesforce-request.utils','./services/snapshot.service','Post','../../core','rollback','getMessages','dependency','FAILURE','Version','(((.+)+)+)+$','18BMtlnZ','search','./services/dependency.service','getAuthDetails','AppResponseStatus','temp/veeva/rollback_','./services/deploy.service'];a415_0x375e=function(){return _0x608f3c;};return a415_0x375e();}const core_1=require(a415_0x4dfe90(0x143)),dependency_service_1=require(a415_0x4dfe90(0x14c)),snapshot_service_1=require(a415_0x4dfe90(0x141)),deploy_service_1=require(a415_0x4dfe90(0x150)),veeva_request_utils_1=require(a415_0x4dfe90(0x17a)),status_enums_1=require(a415_0x4dfe90(0x15a)),shortid_1=__importDefault(require(a415_0x4dfe90(0x164))),fs_util_1=require(a415_0x4dfe90(0x184)),logger_1=require('./classes/loggers/logger'),promises_1=require('fs/promises'),base_veeva_error_1=require(a415_0x4dfe90(0x167)),salesforce_request_utils_1=require(a415_0x4dfe90(0x140)),veeva_auth_1=require(a415_0x4dfe90(0x16d)),salesforce_auth_1=require('./classes/auth/salesforce-auth'),rollback_service_1=require(a415_0x4dfe90(0x15d)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a415_0x4dfe90(0x155)](_0x2015c8){const _0x8c86fd=a415_0x4dfe90,{veevaAuth:_0x2aabc8,timeZone:_0x920636,attachmentLogId:_0xee5623}=_0x2015c8;try{const _0x42bf24=(0x0,veeva_request_utils_1[_0x8c86fd(0x185)])(new veeva_auth_1[(_0x8c86fd(0x179))](_0x2aabc8,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x370258=await salesforce_auth_1[_0x8c86fd(0x13f)][_0x8c86fd(0x14d)](),_0x290fed=(0x0,salesforce_request_utils_1[_0x8c86fd(0x178)])(new salesforce_auth_1[(_0x8c86fd(0x13f))](_0x370258)),_0x227710=new logger_1[(_0x8c86fd(0x174))](_0x290fed,_0x920636,_0xee5623),_0x686f1a=new snapshot_service_1['SnapshotService'](_0x2015c8,_0x290fed,_0x42bf24,_0x227710);return _0x686f1a['execute']()[_0x8c86fd(0x173)](),{'responseStatus':status_enums_1[_0x8c86fd(0x14e)][_0x8c86fd(0x168)]};}catch(_0x50bece){return{'responseStatus':status_enums_1[_0x8c86fd(0x14e)][_0x8c86fd(0x147)],'responseMessage':_0x50bece[_0x8c86fd(0x15f)]};}}async['deployFromBranch'](_0x144b9c){const _0x35a4bc=a415_0x4dfe90,{veevaAuth:_0x613a2,timeZone:_0x33ef20,attachmentLogId:_0x211099}=_0x144b9c;try{const _0x58b659=(0x0,veeva_request_utils_1[_0x35a4bc(0x185)])(new veeva_auth_1[(_0x35a4bc(0x179))](_0x613a2,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x2a5fd7=await salesforce_auth_1['SalesforceAuth'][_0x35a4bc(0x14d)](),_0x5af214=(0x0,salesforce_request_utils_1[_0x35a4bc(0x178)])(new salesforce_auth_1['SalesforceAuth'](_0x2a5fd7)),_0x16a923=new logger_1[(_0x35a4bc(0x174))](_0x5af214,_0x33ef20,_0x211099),_0x4bfd25='temp/veeva/deploy_'+(0x0,shortid_1[_0x35a4bc(0x151)])();await(0x0,fs_util_1[_0x35a4bc(0x166)])(_0x4bfd25);const _0x1a25dc=new deploy_service_1['DeployService'](_0x144b9c,_0x5af214,_0x58b659,_0x16a923,_0x4bfd25,_0x2a5fd7[_0x35a4bc(0x17e)]);return _0x1a25dc[_0x35a4bc(0x176)]()[_0x35a4bc(0x162)](()=>(0x0,promises_1['rm'])(_0x4bfd25,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x35a4bc(0x14e)][_0x35a4bc(0x168)]};}catch(_0x3d067c){return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x3d067c['message']};}}async[a415_0x4dfe90(0x181)](_0x5e3801){const _0x284831=a415_0x4dfe90,{veevaAuth:_0x45964a}=_0x5e3801;try{const _0x3c8924=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x284831(0x179))](_0x45964a)),_0x3d141b=await salesforce_auth_1[_0x284831(0x13f)]['getAuthDetails'](),_0x1b1760=(0x0,salesforce_request_utils_1[_0x284831(0x178)])(new salesforce_auth_1[(_0x284831(0x13f))](_0x3d141b)),_0xcb96e8=new dependency_service_1[(_0x284831(0x16a))](_0x5e3801,_0x1b1760,_0x3c8924);return await _0xcb96e8[_0x284831(0x176)]();}catch(_0x4bb224){const _0x3f2064=_0x4bb224 instanceof base_veeva_error_1['BaseVeevaError']?_0x4bb224[_0x284831(0x145)]()[_0x284831(0x16b)]('\x0a'):_0x4bb224[_0x284831(0x15f)];return{'responseStatus':status_enums_1[_0x284831(0x14e)][_0x284831(0x147)],'responseMessage':_0x3f2064};}}async[a415_0x4dfe90(0x144)](_0x1df272){const _0x113292=a415_0x4dfe90,{veevaAuth:_0x33db6a,timeZone:_0x4e73a7,attachmentLogId:_0x5496b4}=_0x1df272;try{const _0x3c9f1d=(0x0,veeva_request_utils_1[_0x113292(0x185)])(new veeva_auth_1['VeevaAuth'](_0x33db6a,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x2d9c9b=await salesforce_auth_1['SalesforceAuth']['getAuthDetails'](),_0x143bd3=(0x0,salesforce_request_utils_1[_0x113292(0x178)])(new salesforce_auth_1[(_0x113292(0x13f))](_0x2d9c9b)),_0x57a15a=new logger_1[(_0x113292(0x174))](_0x143bd3,_0x4e73a7,_0x5496b4),_0x2389d5=_0x113292(0x14f)+(0x0,shortid_1[_0x113292(0x151)])();await(0x0,fs_util_1[_0x113292(0x166)])(_0x2389d5);const _0x58ca38=new rollback_service_1[(_0x113292(0x183))]({..._0x1df272,'connectionVeeva':_0x3c9f1d,'connectionSalesforce':_0x143bd3,'logger':_0x57a15a,'tempFolder':_0x2389d5,'instanceUrl':_0x2d9c9b[_0x113292(0x17e)]});return _0x58ca38[_0x113292(0x176)]()[_0x113292(0x162)](()=>(0x0,promises_1['rm'])(_0x2389d5,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x113292(0x168)]};}catch(_0x41d401){return{'responseStatus':status_enums_1[_0x113292(0x14e)]['FAILURE'],'responseMessage':_0x41d401[_0x113292(0x15f)]};}}};__decorate([(0x0,core_1[a415_0x4dfe90(0x142)])(a415_0x4dfe90(0x172)),__param(0x0,core_1['param'][a415_0x4dfe90(0x17b)]()),__metadata(a415_0x4dfe90(0x139),Function),__metadata(a415_0x4dfe90(0x17f),[Object]),__metadata(a415_0x4dfe90(0x16e),Promise)],VeevaVaultController[a415_0x4dfe90(0x182)],a415_0x4dfe90(0x155),null),__decorate([(0x0,core_1['Post'])('deploy'),__param(0x0,core_1[a415_0x4dfe90(0x160)]['body']()),__metadata(a415_0x4dfe90(0x139),Function),__metadata(a415_0x4dfe90(0x17f),[Object]),__metadata(a415_0x4dfe90(0x16e),Promise)],VeevaVaultController['prototype'],a415_0x4dfe90(0x16c),null),__decorate([(0x0,core_1['Post'])(a415_0x4dfe90(0x146)),__param(0x0,core_1['param'][a415_0x4dfe90(0x17b)]()),__metadata(a415_0x4dfe90(0x139),Function),__metadata(a415_0x4dfe90(0x17f),[Object]),__metadata(a415_0x4dfe90(0x16e),Promise)],VeevaVaultController[a415_0x4dfe90(0x182)],a415_0x4dfe90(0x181),null),__decorate([(0x0,core_1['Post'])('rollback'),__param(0x0,core_1[a415_0x4dfe90(0x160)][a415_0x4dfe90(0x17b)]()),__metadata('design:type',Function),__metadata(a415_0x4dfe90(0x17f),[Object]),__metadata(a415_0x4dfe90(0x16e),Promise)],VeevaVaultController[a415_0x4dfe90(0x182)],'rollback',null),VeevaVaultController=__decorate([(0x0,core_1[a415_0x4dfe90(0x17d)])(a415_0x4dfe90(0x177)),(0x0,core_1[a415_0x4dfe90(0x148)])(a415_0x4dfe90(0x157))],VeevaVaultController),exports[a415_0x4dfe90(0x175)]=VeevaVaultController;