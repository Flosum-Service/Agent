const a318_0x39abe1=a318_0x42f7;(function(_0x1c4c65,_0x4555f4){const _0x46e311=a318_0x42f7,_0x4d2706=_0x1c4c65();while(!![]){try{const _0x148f9f=-parseInt(_0x46e311(0x78))/0x1*(parseInt(_0x46e311(0x76))/0x2)+-parseInt(_0x46e311(0xa9))/0x3*(parseInt(_0x46e311(0xb3))/0x4)+parseInt(_0x46e311(0x7a))/0x5*(parseInt(_0x46e311(0x8b))/0x6)+-parseInt(_0x46e311(0xae))/0x7*(-parseInt(_0x46e311(0xb4))/0x8)+parseInt(_0x46e311(0xad))/0x9+-parseInt(_0x46e311(0x92))/0xa+parseInt(_0x46e311(0xb2))/0xb;if(_0x148f9f===_0x4555f4)break;else _0x4d2706['push'](_0x4d2706['shift']());}catch(_0x331d44){_0x4d2706['push'](_0x4d2706['shift']());}}}(a318_0x2b18,0x350cd));function a318_0x42f7(_0x5c40c6,_0xea6152){const _0x552a11=a318_0x2b18();return a318_0x42f7=function(_0x1c89e0,_0x4bcffb){_0x1c89e0=_0x1c89e0-0x71;let _0x2b188a=_0x552a11[_0x1c89e0];return _0x2b188a;},a318_0x42f7(_0x5c40c6,_0xea6152);}function a318_0x2b18(){const _0x1ae234=['3577530mqzVYt','8Daktnb','2008hmevTy','finally','getAuthDetails','design:returntype','body','VeevaAuth','design:type','createVeevaRequest','doSnapshot','veeva-vault','./enums/status.enums','decorate','Post','../../core','SnapshotService','34ikSWLc','constructor','20893crldyF','__decorate','185IYoBjd','./services/dependency.service','(((.+)+)+)+$','defineProperty','./services/deploy.service','execute','./classes/logger','deploy','Controller','shortid','temp/veeva/deploy_','snapshot','__importDefault','makeDir','./classes/auth/veeva-auth','dependency','SUCCESS','27834JkHIyw','message','FAILURE','__metadata','__esModule','Version','AppResponseStatus','2235540qwtwPh','./classes/errors/base-veeva-error','./utils/salesforce-request.utils','param','search','design:paramtypes','./classes/auth/salesforce-auth','./utils/veeva-request.utils','SalesforceAuth','metadata','Logger','deployFromBranch','__param','object','VeevaVaultController','DeployService','instanceUrl','then','prototype','function','toString','length','join','32295lJqwAZ','apply','./services/snapshot.service','default','2653488MyZvDF','721MCPrqi','getOwnPropertyDescriptor','fs/promises','getMessages'];a318_0x2b18=function(){return _0x1ae234;};return a318_0x2b18();}const a318_0x4bcffb=(function(){let _0x279005=!![];return function(_0x538a13,_0x2f76a3){const _0xbc3b0e=_0x279005?function(){const _0x521b0f=a318_0x42f7;if(_0x2f76a3){const _0x70c83b=_0x2f76a3[_0x521b0f(0xaa)](_0x538a13,arguments);return _0x2f76a3=null,_0x70c83b;}}:function(){};return _0x279005=![],_0xbc3b0e;};}()),a318_0x1c89e0=a318_0x4bcffb(this,function(){const _0x3a2a99=a318_0x42f7;return a318_0x1c89e0[_0x3a2a99(0xa6)]()[_0x3a2a99(0x96)](_0x3a2a99(0x7c))[_0x3a2a99(0xa6)]()[_0x3a2a99(0x77)](a318_0x1c89e0)[_0x3a2a99(0x96)](_0x3a2a99(0x7c));});a318_0x1c89e0();'use strict';var __decorate=this&&this[a318_0x39abe1(0x79)]||function(_0x4c0656,_0x501ad0,_0x6c79fd,_0xca07f6){const _0x16c34a=a318_0x39abe1;var _0x302d4a=arguments[_0x16c34a(0xa7)],_0x49698c=_0x302d4a<0x3?_0x501ad0:_0xca07f6===null?_0xca07f6=Object[_0x16c34a(0xaf)](_0x501ad0,_0x6c79fd):_0xca07f6,_0xed2189;if(typeof Reflect===_0x16c34a(0x9f)&&typeof Reflect['decorate']===_0x16c34a(0xa5))_0x49698c=Reflect[_0x16c34a(0x72)](_0x4c0656,_0x501ad0,_0x6c79fd,_0xca07f6);else{for(var _0x3c1de3=_0x4c0656[_0x16c34a(0xa7)]-0x1;_0x3c1de3>=0x0;_0x3c1de3--)if(_0xed2189=_0x4c0656[_0x3c1de3])_0x49698c=(_0x302d4a<0x3?_0xed2189(_0x49698c):_0x302d4a>0x3?_0xed2189(_0x501ad0,_0x6c79fd,_0x49698c):_0xed2189(_0x501ad0,_0x6c79fd))||_0x49698c;}return _0x302d4a>0x3&&_0x49698c&&Object['defineProperty'](_0x501ad0,_0x6c79fd,_0x49698c),_0x49698c;},__metadata=this&&this[a318_0x39abe1(0x8e)]||function(_0x6df86c,_0x570f4e){const _0x3c6671=a318_0x39abe1;if(typeof Reflect==='object'&&typeof Reflect[_0x3c6671(0x9b)]===_0x3c6671(0xa5))return Reflect[_0x3c6671(0x9b)](_0x6df86c,_0x570f4e);},__param=this&&this[a318_0x39abe1(0x9e)]||function(_0x5e647f,_0x229803){return function(_0x1ce674,_0x2083ed){_0x229803(_0x1ce674,_0x2083ed,_0x5e647f);};},__importDefault=this&&this[a318_0x39abe1(0x86)]||function(_0x1ec22a){const _0x218525=a318_0x39abe1;return _0x1ec22a&&_0x1ec22a[_0x218525(0x8f)]?_0x1ec22a:{'default':_0x1ec22a};};Object[a318_0x39abe1(0x7d)](exports,a318_0x39abe1(0x8f),{'value':!![]}),exports['VeevaVaultController']=void 0x0;const core_1=require(a318_0x39abe1(0x74)),dependency_service_1=require(a318_0x39abe1(0x7b)),snapshot_service_1=require(a318_0x39abe1(0xab)),deploy_service_1=require(a318_0x39abe1(0x7e)),veeva_request_utils_1=require(a318_0x39abe1(0x99)),status_enums_1=require(a318_0x39abe1(0x71)),shortid_1=__importDefault(require(a318_0x39abe1(0x83))),fs_util_1=require('./utils/fs-util'),logger_1=require(a318_0x39abe1(0x80)),promises_1=require(a318_0x39abe1(0xb0)),base_veeva_error_1=require(a318_0x39abe1(0x93)),salesforce_request_utils_1=require(a318_0x39abe1(0x94)),veeva_auth_1=require(a318_0x39abe1(0x88)),salesforce_auth_1=require(a318_0x39abe1(0x98)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a318_0x39abe1(0xbc)](_0x20f7f7){const _0x3be89e=a318_0x39abe1,{veevaAuth:_0x249ca6,timeZone:_0x29647d,attachmentLogId:_0x5d5966}=_0x20f7f7;try{const _0x5ec490=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x3be89e(0xb9))](_0x249ca6,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x1fdf8e=await salesforce_auth_1['SalesforceAuth'][_0x3be89e(0xb6)](),_0x50fc5d=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x3be89e(0x9a))](_0x1fdf8e)),_0x25779d=new logger_1[(_0x3be89e(0x9c))](_0x50fc5d,_0x29647d,_0x5d5966),_0x1418c6=new snapshot_service_1[(_0x3be89e(0x75))](_0x20f7f7,_0x50fc5d,_0x5ec490,_0x25779d);return _0x1418c6[_0x3be89e(0x7f)]()[_0x3be89e(0xa3)](),{'responseStatus':status_enums_1[_0x3be89e(0x91)][_0x3be89e(0x8a)]};}catch(_0x5ab005){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x3be89e(0x8d)],'responseMessage':_0x5ab005[_0x3be89e(0x8c)]};}}async[a318_0x39abe1(0x9d)](_0x4c8929){const _0x4e959b=a318_0x39abe1,{veevaAuth:_0x2a89cf,timeZone:_0x3eef5d,attachmentLogId:_0x12aaca}=_0x4c8929;try{const _0x9b830a=(0x0,veeva_request_utils_1[_0x4e959b(0xbb)])(new veeva_auth_1['VeevaAuth'](_0x2a89cf,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x5bd1ad=await salesforce_auth_1[_0x4e959b(0x9a)]['getAuthDetails'](),_0x17d090=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x4e959b(0x9a))](_0x5bd1ad)),_0x3a923a=new logger_1['Logger'](_0x17d090,_0x3eef5d,_0x12aaca),_0x374aec=_0x4e959b(0x84)+(0x0,shortid_1[_0x4e959b(0xac)])();await(0x0,fs_util_1[_0x4e959b(0x87)])(_0x374aec);const _0x24e3df=new deploy_service_1[(_0x4e959b(0xa1))](_0x4c8929,_0x17d090,_0x9b830a,_0x3a923a,_0x374aec,_0x5bd1ad[_0x4e959b(0xa2)]);return _0x24e3df[_0x4e959b(0x7f)]()[_0x4e959b(0xb5)](()=>(0x0,promises_1['rm'])(_0x374aec,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x4e959b(0x91)]['SUCCESS']};}catch(_0x2cfcb6){return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x2cfcb6['message']};}}async['retrieveDependency'](_0x446895){const _0xa39ad5=a318_0x39abe1,{veevaAuth:_0x4066a0}=_0x446895;try{const _0x45aa0e=(0x0,veeva_request_utils_1[_0xa39ad5(0xbb)])(new veeva_auth_1[(_0xa39ad5(0xb9))](_0x4066a0)),_0x3d0cf1=await salesforce_auth_1[_0xa39ad5(0x9a)][_0xa39ad5(0xb6)](),_0x1791ef=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0xa39ad5(0x9a))](_0x3d0cf1)),_0x372d40=new dependency_service_1['DependencyService'](_0x446895,_0x1791ef,_0x45aa0e);return await _0x372d40[_0xa39ad5(0x7f)]();}catch(_0x456481){const _0x4339db=_0x456481 instanceof base_veeva_error_1['BaseVeevaError']?_0x456481[_0xa39ad5(0xb1)]()[_0xa39ad5(0xa8)]('\x0a'):_0x456481[_0xa39ad5(0x8c)];return{'responseStatus':status_enums_1[_0xa39ad5(0x91)][_0xa39ad5(0x8d)],'responseMessage':_0x4339db};}}};__decorate([(0x0,core_1['Post'])(a318_0x39abe1(0x85)),__param(0x0,core_1[a318_0x39abe1(0x95)][a318_0x39abe1(0xb8)]()),__metadata(a318_0x39abe1(0xba),Function),__metadata(a318_0x39abe1(0x97),[Object]),__metadata(a318_0x39abe1(0xb7),Promise)],VeevaVaultController[a318_0x39abe1(0xa4)],'doSnapshot',null),__decorate([(0x0,core_1[a318_0x39abe1(0x73)])(a318_0x39abe1(0x81)),__param(0x0,core_1[a318_0x39abe1(0x95)][a318_0x39abe1(0xb8)]()),__metadata('design:type',Function),__metadata(a318_0x39abe1(0x97),[Object]),__metadata(a318_0x39abe1(0xb7),Promise)],VeevaVaultController['prototype'],a318_0x39abe1(0x9d),null),__decorate([(0x0,core_1['Post'])(a318_0x39abe1(0x89)),__param(0x0,core_1[a318_0x39abe1(0x95)][a318_0x39abe1(0xb8)]()),__metadata(a318_0x39abe1(0xba),Function),__metadata(a318_0x39abe1(0x97),[Object]),__metadata(a318_0x39abe1(0xb7),Promise)],VeevaVaultController[a318_0x39abe1(0xa4)],'retrieveDependency',null),VeevaVaultController=__decorate([(0x0,core_1[a318_0x39abe1(0x82)])(a318_0x39abe1(0xbd)),(0x0,core_1[a318_0x39abe1(0x90)])('v1')],VeevaVaultController),exports[a318_0x39abe1(0xa0)]=VeevaVaultController;