function a318_0x1016(_0x4bb532,_0x11af61){const _0x1569f3=a318_0x5034();return a318_0x1016=function(_0x4fae44,_0x351be0){_0x4fae44=_0x4fae44-0x17e;let _0x50340e=_0x1569f3[_0x4fae44];return _0x50340e;},a318_0x1016(_0x4bb532,_0x11af61);}const a318_0x1417db=a318_0x1016;(function(_0x519c65,_0x1dbfe9){const _0x1a7c51=a318_0x1016,_0x56398a=_0x519c65();while(!![]){try{const _0x2d2668=-parseInt(_0x1a7c51(0x19c))/0x1*(parseInt(_0x1a7c51(0x1b3))/0x2)+-parseInt(_0x1a7c51(0x192))/0x3*(-parseInt(_0x1a7c51(0x1ad))/0x4)+parseInt(_0x1a7c51(0x181))/0x5+-parseInt(_0x1a7c51(0x185))/0x6*(parseInt(_0x1a7c51(0x1bf))/0x7)+-parseInt(_0x1a7c51(0x1af))/0x8+parseInt(_0x1a7c51(0x19b))/0x9*(parseInt(_0x1a7c51(0x18a))/0xa)+parseInt(_0x1a7c51(0x19a))/0xb;if(_0x2d2668===_0x1dbfe9)break;else _0x56398a['push'](_0x56398a['shift']());}catch(_0x2cc930){_0x56398a['push'](_0x56398a['shift']());}}}(a318_0x5034,0xa3d15));const a318_0x351be0=(function(){let _0x11306b=!![];return function(_0x1b558,_0xf39c4e){const _0x16741a=_0x11306b?function(){const _0x73b4b9=a318_0x1016;if(_0xf39c4e){const _0x77d73c=_0xf39c4e[_0x73b4b9(0x18b)](_0x1b558,arguments);return _0xf39c4e=null,_0x77d73c;}}:function(){};return _0x11306b=![],_0x16741a;};}()),a318_0x4fae44=a318_0x351be0(this,function(){const _0x4a3abd=a318_0x1016;return a318_0x4fae44[_0x4a3abd(0x1a2)]()[_0x4a3abd(0x182)]('(((.+)+)+)+$')[_0x4a3abd(0x1a2)]()[_0x4a3abd(0x1b4)](a318_0x4fae44)[_0x4a3abd(0x182)]('(((.+)+)+)+$');});a318_0x4fae44();'use strict';var __decorate=this&&this[a318_0x1417db(0x1bb)]||function(_0x505183,_0x4864a0,_0x34b8d2,_0x3223b3){const _0x4cc23e=a318_0x1417db;var _0x5085c6=arguments[_0x4cc23e(0x198)],_0x1ad0b1=_0x5085c6<0x3?_0x4864a0:_0x3223b3===null?_0x3223b3=Object['getOwnPropertyDescriptor'](_0x4864a0,_0x34b8d2):_0x3223b3,_0x4ad4d1;if(typeof Reflect===_0x4cc23e(0x180)&&typeof Reflect['decorate']==='function')_0x1ad0b1=Reflect[_0x4cc23e(0x1bd)](_0x505183,_0x4864a0,_0x34b8d2,_0x3223b3);else{for(var _0x42ac89=_0x505183['length']-0x1;_0x42ac89>=0x0;_0x42ac89--)if(_0x4ad4d1=_0x505183[_0x42ac89])_0x1ad0b1=(_0x5085c6<0x3?_0x4ad4d1(_0x1ad0b1):_0x5085c6>0x3?_0x4ad4d1(_0x4864a0,_0x34b8d2,_0x1ad0b1):_0x4ad4d1(_0x4864a0,_0x34b8d2))||_0x1ad0b1;}return _0x5085c6>0x3&&_0x1ad0b1&&Object['defineProperty'](_0x4864a0,_0x34b8d2,_0x1ad0b1),_0x1ad0b1;},__metadata=this&&this[a318_0x1417db(0x189)]||function(_0x3be62b,_0x348174){const _0x7a954c=a318_0x1417db;if(typeof Reflect===_0x7a954c(0x180)&&typeof Reflect[_0x7a954c(0x19f)]==='function')return Reflect['metadata'](_0x3be62b,_0x348174);},__param=this&&this['__param']||function(_0x242949,_0x10d89f){return function(_0x31208f,_0xe55df6){_0x10d89f(_0x31208f,_0xe55df6,_0x242949);};},__importDefault=this&&this['__importDefault']||function(_0x8665c6){const _0x3c3100=a318_0x1417db;return _0x8665c6&&_0x8665c6[_0x3c3100(0x1b5)]?_0x8665c6:{'default':_0x8665c6};};Object['defineProperty'](exports,a318_0x1417db(0x1b5),{'value':!![]}),exports[a318_0x1417db(0x190)]=void 0x0;function a318_0x5034(){const _0x2cede6=['__metadata','930mgoVWU','apply','BaseVeevaError','../../core','join','DeployService','VeevaVaultController','dependency','18SRwErW','design:type','getAuthDetails','./utils/veeva-request.utils','makeDir','getMessages','length','Logger','17615114qxIJAn','34758qFzMqB','1dCDYQm','FAILURE','DependencyService','metadata','SnapshotService','AppResponseStatus','toString','temp/veeva/deploy_','veeva-vault','./enums/status.enums','Version','param','prototype','SalesforceAuth','default','./services/deploy.service','doSnapshot','48324yKWBlQ','design:returntype','2619648DzyySM','message','execute','./services/snapshot.service','1856136tzannY','constructor','__esModule','retrieveDependency','design:paramtypes','./utils/salesforce-request.utils','createVeevaRequest','SUCCESS','__decorate','VeevaAuth','decorate','./services/dependency.service','345415XQutwu','snapshot','deployFromBranch','./classes/auth/veeva-auth','object','4648700oTlVSa','search','body','finally','126hsHePM','Post','deploy','createSalesforceRequest'];a318_0x5034=function(){return _0x2cede6;};return a318_0x5034();}const core_1=require(a318_0x1417db(0x18d)),dependency_service_1=require(a318_0x1417db(0x1be)),snapshot_service_1=require(a318_0x1417db(0x1b2)),deploy_service_1=require(a318_0x1417db(0x1ab)),veeva_request_utils_1=require(a318_0x1417db(0x195)),status_enums_1=require(a318_0x1417db(0x1a5)),shortid_1=__importDefault(require('shortid')),fs_util_1=require('./utils/fs-util'),logger_1=require('./classes/logger'),promises_1=require('fs/promises'),base_veeva_error_1=require('./classes/errors/base-veeva-error'),salesforce_request_utils_1=require(a318_0x1417db(0x1b8)),veeva_auth_1=require(a318_0x1417db(0x17f)),salesforce_auth_1=require('./classes/auth/salesforce-auth'),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a318_0x1417db(0x1ac)](_0x5a917b){const _0x24fe00=a318_0x1417db,{veevaAuth:_0x3a7045,timeZone:_0x5634c2,attachmentLogId:_0x44ca37}=_0x5a917b;try{const _0x229320=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1['VeevaAuth'](_0x3a7045,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x44e207=await salesforce_auth_1[_0x24fe00(0x1a9)][_0x24fe00(0x194)](),_0x4ed267=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x24fe00(0x1a9))](_0x44e207)),_0x349edd=new logger_1[(_0x24fe00(0x199))](_0x4ed267,_0x5634c2,_0x44ca37),_0x78827a=new snapshot_service_1[(_0x24fe00(0x1a0))](_0x5a917b,_0x4ed267,_0x229320,_0x349edd);return _0x78827a['execute']()['then'](),{'responseStatus':status_enums_1['AppResponseStatus']['SUCCESS']};}catch(_0x5d68b1){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x24fe00(0x19d)],'responseMessage':_0x5d68b1[_0x24fe00(0x1b0)]};}}async[a318_0x1417db(0x17e)](_0x130997){const _0x3e5e2e=a318_0x1417db,{veevaAuth:_0x4061c9,timeZone:_0x2f00aa,attachmentLogId:_0x580ddf}=_0x130997;try{const _0x2cd15a=(0x0,veeva_request_utils_1[_0x3e5e2e(0x1b9)])(new veeva_auth_1[(_0x3e5e2e(0x1bc))](_0x4061c9,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x36b555=await salesforce_auth_1['SalesforceAuth']['getAuthDetails'](),_0x15de0c=(0x0,salesforce_request_utils_1[_0x3e5e2e(0x188)])(new salesforce_auth_1[(_0x3e5e2e(0x1a9))](_0x36b555)),_0x2772c9=new logger_1[(_0x3e5e2e(0x199))](_0x15de0c,_0x2f00aa,_0x580ddf),_0x53717f=_0x3e5e2e(0x1a3)+(0x0,shortid_1[_0x3e5e2e(0x1aa)])();await(0x0,fs_util_1[_0x3e5e2e(0x196)])(_0x53717f);const _0x1d4bb5=new deploy_service_1[(_0x3e5e2e(0x18f))](_0x130997,_0x15de0c,_0x2cd15a,_0x2772c9,_0x53717f,_0x36b555['instanceUrl']);return _0x1d4bb5[_0x3e5e2e(0x1b1)]()[_0x3e5e2e(0x184)](()=>(0x0,promises_1['rm'])(_0x53717f,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x3e5e2e(0x1ba)]};}catch(_0x261ea5){return{'responseStatus':status_enums_1[_0x3e5e2e(0x1a1)][_0x3e5e2e(0x19d)],'responseMessage':_0x261ea5[_0x3e5e2e(0x1b0)]};}}async[a318_0x1417db(0x1b6)](_0x23604d){const _0x113fad=a318_0x1417db,{veevaAuth:_0x4ab17d}=_0x23604d;try{const _0x5124b2=(0x0,veeva_request_utils_1[_0x113fad(0x1b9)])(new veeva_auth_1['VeevaAuth'](_0x4ab17d)),_0x4f59d2=await salesforce_auth_1[_0x113fad(0x1a9)][_0x113fad(0x194)](),_0x321735=(0x0,salesforce_request_utils_1[_0x113fad(0x188)])(new salesforce_auth_1[(_0x113fad(0x1a9))](_0x4f59d2)),_0x11a400=new dependency_service_1[(_0x113fad(0x19e))](_0x23604d,_0x321735,_0x5124b2);return await _0x11a400[_0x113fad(0x1b1)]();}catch(_0x6123bb){const _0x36ca61=_0x6123bb instanceof base_veeva_error_1[_0x113fad(0x18c)]?_0x6123bb[_0x113fad(0x197)]()[_0x113fad(0x18e)]('\x0a'):_0x6123bb[_0x113fad(0x1b0)];return{'responseStatus':status_enums_1['AppResponseStatus'][_0x113fad(0x19d)],'responseMessage':_0x36ca61};}}};__decorate([(0x0,core_1['Post'])(a318_0x1417db(0x1c0)),__param(0x0,core_1[a318_0x1417db(0x1a7)][a318_0x1417db(0x183)]()),__metadata('design:type',Function),__metadata(a318_0x1417db(0x1b7),[Object]),__metadata(a318_0x1417db(0x1ae),Promise)],VeevaVaultController['prototype'],'doSnapshot',null),__decorate([(0x0,core_1[a318_0x1417db(0x186)])(a318_0x1417db(0x187)),__param(0x0,core_1[a318_0x1417db(0x1a7)][a318_0x1417db(0x183)]()),__metadata('design:type',Function),__metadata(a318_0x1417db(0x1b7),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a318_0x1417db(0x1a8)],a318_0x1417db(0x17e),null),__decorate([(0x0,core_1[a318_0x1417db(0x186)])(a318_0x1417db(0x191)),__param(0x0,core_1[a318_0x1417db(0x1a7)]['body']()),__metadata(a318_0x1417db(0x193),Function),__metadata(a318_0x1417db(0x1b7),[Object]),__metadata(a318_0x1417db(0x1ae),Promise)],VeevaVaultController[a318_0x1417db(0x1a8)],a318_0x1417db(0x1b6),null),VeevaVaultController=__decorate([(0x0,core_1['Controller'])(a318_0x1417db(0x1a4)),(0x0,core_1[a318_0x1417db(0x1a6)])('v1')],VeevaVaultController),exports[a318_0x1417db(0x190)]=VeevaVaultController;