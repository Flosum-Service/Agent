function a386_0x5890(_0x55100c,_0x5e6e6a){const _0x28fb80=a386_0x32f4();return a386_0x5890=function(_0x3bfcd1,_0xfaa3d8){_0x3bfcd1=_0x3bfcd1-0x76;let _0x32f4d4=_0x28fb80[_0x3bfcd1];return _0x32f4d4;},a386_0x5890(_0x55100c,_0x5e6e6a);}const a386_0x100040=a386_0x5890;(function(_0x28d2d1,_0x45f86d){const _0x5a8013=a386_0x5890,_0x4b83bb=_0x28d2d1();while(!![]){try{const _0x27c20a=-parseInt(_0x5a8013(0x79))/0x1*(-parseInt(_0x5a8013(0x7c))/0x2)+-parseInt(_0x5a8013(0x7f))/0x3+parseInt(_0x5a8013(0xb1))/0x4+-parseInt(_0x5a8013(0xa8))/0x5*(parseInt(_0x5a8013(0xb2))/0x6)+-parseInt(_0x5a8013(0x85))/0x7*(parseInt(_0x5a8013(0xb8))/0x8)+-parseInt(_0x5a8013(0xa7))/0x9*(-parseInt(_0x5a8013(0x97))/0xa)+-parseInt(_0x5a8013(0xbd))/0xb*(parseInt(_0x5a8013(0x87))/0xc);if(_0x27c20a===_0x45f86d)break;else _0x4b83bb['push'](_0x4b83bb['shift']());}catch(_0x2e0235){_0x4b83bb['push'](_0x4b83bb['shift']());}}}(a386_0x32f4,0x85d40));function a386_0x32f4(){const _0x2ffd2c=['10539RGaHTL','238025WzJWcF','./utils/salesforce-request.utils','./utils/veeva-request.utils','./services/dependency.service','FAILURE','object','makeDir','VeevaVaultController','Logger','3950348auShjR','24qotqbX','rollback','then','./services/deploy.service','./services/snapshot.service','default','1443368IAurNH','design:returntype','deployFromBranch','getAuthDetails','temp/veeva/deploy_','32692AZDjBr','__metadata','dependency','toString','DependencyService','shortid','decorate','../../core','defineProperty','./classes/loggers/logger','5419INsgmu','getMessages','./classes/auth/veeva-auth','284AJfBPU','metadata','join','2906730RarFqx','./utils/fs-util','DeployService','VeevaAuth','length','execute','7QGJBes','retrieveDependency','2772hgbiUg','SalesforceAuth','instanceUrl','AppResponseStatus','createSalesforceRequest','doSnapshot','param','__importDefault','./enums/status.enums','__esModule','finally','getOwnPropertyDescriptor','message','__decorate','apply','(((.+)+)+)+$','6980WrpJdf','BaseVeevaError','design:type','search','body','prototype','Post','function','SUCCESS','./classes/auth/salesforce-auth','fs/promises','snapshot','Controller','design:paramtypes','createVeevaRequest','temp/veeva/rollback_'];a386_0x32f4=function(){return _0x2ffd2c;};return a386_0x32f4();}const a386_0xfaa3d8=(function(){let _0x1b0a20=!![];return function(_0x4d743b,_0x1c0f90){const _0x27b4ee=_0x1b0a20?function(){const _0x3acca6=a386_0x5890;if(_0x1c0f90){const _0x4cc47d=_0x1c0f90[_0x3acca6(0x95)](_0x4d743b,arguments);return _0x1c0f90=null,_0x4cc47d;}}:function(){};return _0x1b0a20=![],_0x27b4ee;};}()),a386_0x3bfcd1=a386_0xfaa3d8(this,function(){const _0x3fb830=a386_0x5890;return a386_0x3bfcd1[_0x3fb830(0xc0)]()['search'](_0x3fb830(0x96))[_0x3fb830(0xc0)]()['constructor'](a386_0x3bfcd1)[_0x3fb830(0x9a)](_0x3fb830(0x96));});a386_0x3bfcd1();'use strict';var __decorate=this&&this[a386_0x100040(0x94)]||function(_0x36c120,_0x2de4d1,_0x2c8caa,_0x49dd4d){const _0x1e1a41=a386_0x100040;var _0x39d5d8=arguments[_0x1e1a41(0x83)],_0x29fed8=_0x39d5d8<0x3?_0x2de4d1:_0x49dd4d===null?_0x49dd4d=Object[_0x1e1a41(0x92)](_0x2de4d1,_0x2c8caa):_0x49dd4d,_0x4cf16e;if(typeof Reflect===_0x1e1a41(0xad)&&typeof Reflect[_0x1e1a41(0xc3)]===_0x1e1a41(0x9e))_0x29fed8=Reflect[_0x1e1a41(0xc3)](_0x36c120,_0x2de4d1,_0x2c8caa,_0x49dd4d);else{for(var _0x9086db=_0x36c120[_0x1e1a41(0x83)]-0x1;_0x9086db>=0x0;_0x9086db--)if(_0x4cf16e=_0x36c120[_0x9086db])_0x29fed8=(_0x39d5d8<0x3?_0x4cf16e(_0x29fed8):_0x39d5d8>0x3?_0x4cf16e(_0x2de4d1,_0x2c8caa,_0x29fed8):_0x4cf16e(_0x2de4d1,_0x2c8caa))||_0x29fed8;}return _0x39d5d8>0x3&&_0x29fed8&&Object[_0x1e1a41(0x77)](_0x2de4d1,_0x2c8caa,_0x29fed8),_0x29fed8;},__metadata=this&&this[a386_0x100040(0xbe)]||function(_0x300304,_0x5b8eee){const _0x542cb4=a386_0x100040;if(typeof Reflect===_0x542cb4(0xad)&&typeof Reflect['metadata']===_0x542cb4(0x9e))return Reflect[_0x542cb4(0x7d)](_0x300304,_0x5b8eee);},__param=this&&this['__param']||function(_0x247422,_0x32d251){return function(_0x919d4c,_0x49839e){_0x32d251(_0x919d4c,_0x49839e,_0x247422);};},__importDefault=this&&this[a386_0x100040(0x8e)]||function(_0x1d9564){const _0x2e4327=a386_0x100040;return _0x1d9564&&_0x1d9564[_0x2e4327(0x90)]?_0x1d9564:{'default':_0x1d9564};};Object[a386_0x100040(0x77)](exports,a386_0x100040(0x90),{'value':!![]}),exports[a386_0x100040(0xaf)]=void 0x0;const core_1=require(a386_0x100040(0x76)),dependency_service_1=require(a386_0x100040(0xab)),snapshot_service_1=require(a386_0x100040(0xb6)),deploy_service_1=require(a386_0x100040(0xb5)),veeva_request_utils_1=require(a386_0x100040(0xaa)),status_enums_1=require(a386_0x100040(0x8f)),shortid_1=__importDefault(require(a386_0x100040(0xc2))),fs_util_1=require(a386_0x100040(0x80)),logger_1=require(a386_0x100040(0x78)),promises_1=require(a386_0x100040(0xa1)),base_veeva_error_1=require('./classes/errors/base-veeva-error'),salesforce_request_utils_1=require(a386_0x100040(0xa9)),veeva_auth_1=require(a386_0x100040(0x7b)),salesforce_auth_1=require(a386_0x100040(0xa0)),rollback_service_1=require('./services/rollback.service'),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a386_0x100040(0x8c)](_0x11fbb9){const _0x373065=a386_0x100040,{veevaAuth:_0x80efee,timeZone:_0x1d8ea4,attachmentLogId:_0x250102}=_0x11fbb9;try{const _0x2f8014=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x373065(0x82))](_0x80efee,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x36074c=await salesforce_auth_1[_0x373065(0x88)][_0x373065(0xbb)](),_0x5a3f00=(0x0,salesforce_request_utils_1[_0x373065(0x8b)])(new salesforce_auth_1[(_0x373065(0x88))](_0x36074c)),_0xe5d4=new logger_1[(_0x373065(0xb0))](_0x5a3f00,_0x1d8ea4,_0x250102),_0x30ebfc=new snapshot_service_1['SnapshotService'](_0x11fbb9,_0x5a3f00,_0x2f8014,_0xe5d4);return _0x30ebfc['execute']()[_0x373065(0xb4)](),{'responseStatus':status_enums_1[_0x373065(0x8a)]['SUCCESS']};}catch(_0x2c62fc){return{'responseStatus':status_enums_1[_0x373065(0x8a)][_0x373065(0xac)],'responseMessage':_0x2c62fc[_0x373065(0x93)]};}}async[a386_0x100040(0xba)](_0x30697e){const _0x230c44=a386_0x100040,{veevaAuth:_0x535cee,timeZone:_0x2e62a9,attachmentLogId:_0x4b6e31}=_0x30697e;try{const _0x48ade9=(0x0,veeva_request_utils_1[_0x230c44(0xa5)])(new veeva_auth_1[(_0x230c44(0x82))](_0x535cee,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x1776d8=await salesforce_auth_1[_0x230c44(0x88)][_0x230c44(0xbb)](),_0xfc1ffc=(0x0,salesforce_request_utils_1[_0x230c44(0x8b)])(new salesforce_auth_1['SalesforceAuth'](_0x1776d8)),_0xbae490=new logger_1[(_0x230c44(0xb0))](_0xfc1ffc,_0x2e62a9,_0x4b6e31),_0x40d8f0=_0x230c44(0xbc)+(0x0,shortid_1[_0x230c44(0xb7)])();await(0x0,fs_util_1[_0x230c44(0xae)])(_0x40d8f0);const _0x4fb775=new deploy_service_1[(_0x230c44(0x81))](_0x30697e,_0xfc1ffc,_0x48ade9,_0xbae490,_0x40d8f0,_0x1776d8[_0x230c44(0x89)]);return _0x4fb775[_0x230c44(0x84)]()[_0x230c44(0x91)](()=>(0x0,promises_1['rm'])(_0x40d8f0,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x230c44(0x9f)]};}catch(_0x50b6f7){return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x50b6f7[_0x230c44(0x93)]};}}async[a386_0x100040(0x86)](_0x745095){const _0x4fc989=a386_0x100040,{veevaAuth:_0xf93f76}=_0x745095;try{const _0x506d7e=(0x0,veeva_request_utils_1[_0x4fc989(0xa5)])(new veeva_auth_1[(_0x4fc989(0x82))](_0xf93f76)),_0x4c5623=await salesforce_auth_1['SalesforceAuth'][_0x4fc989(0xbb)](),_0x336299=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x4fc989(0x88))](_0x4c5623)),_0x5b9dc3=new dependency_service_1[(_0x4fc989(0xc1))](_0x745095,_0x336299,_0x506d7e);return await _0x5b9dc3[_0x4fc989(0x84)]();}catch(_0x4dd21){const _0x23aca6=_0x4dd21 instanceof base_veeva_error_1[_0x4fc989(0x98)]?_0x4dd21[_0x4fc989(0x7a)]()[_0x4fc989(0x7e)]('\x0a'):_0x4dd21[_0x4fc989(0x93)];return{'responseStatus':status_enums_1['AppResponseStatus'][_0x4fc989(0xac)],'responseMessage':_0x23aca6};}}async['rollback'](_0x25a26f){const _0x1bc8db=a386_0x100040,{veevaAuth:_0x281b8b,timeZone:_0x4451d7,attachmentLogId:_0x50cc3d}=_0x25a26f;try{const _0x14f606=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x1bc8db(0x82))](_0x281b8b,JOB_UPDATE_TOKEN_ATTEMPTS)),_0xdc171c=await salesforce_auth_1['SalesforceAuth'][_0x1bc8db(0xbb)](),_0x392ce2=(0x0,salesforce_request_utils_1[_0x1bc8db(0x8b)])(new salesforce_auth_1[(_0x1bc8db(0x88))](_0xdc171c)),_0x5d43c0=new logger_1[(_0x1bc8db(0xb0))](_0x392ce2,_0x4451d7,_0x50cc3d),_0x5b3c26=_0x1bc8db(0xa6)+(0x0,shortid_1['default'])();await(0x0,fs_util_1[_0x1bc8db(0xae)])(_0x5b3c26);const _0x147fbc=new rollback_service_1['RollbackService']({..._0x25a26f,'connectionVeeva':_0x14f606,'connectionSalesforce':_0x392ce2,'logger':_0x5d43c0,'tempFolder':_0x5b3c26,'instanceUrl':_0xdc171c['instanceUrl']});return _0x147fbc['execute']()[_0x1bc8db(0x91)](()=>(0x0,promises_1['rm'])(_0x5b3c26,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x1bc8db(0x8a)][_0x1bc8db(0x9f)]};}catch(_0x1749d4){return{'responseStatus':status_enums_1[_0x1bc8db(0x8a)][_0x1bc8db(0xac)],'responseMessage':_0x1749d4[_0x1bc8db(0x93)]};}}};__decorate([(0x0,core_1['Post'])(a386_0x100040(0xa2)),__param(0x0,core_1['param'][a386_0x100040(0x9b)]()),__metadata(a386_0x100040(0x99),Function),__metadata(a386_0x100040(0xa4),[Object]),__metadata(a386_0x100040(0xb9),Promise)],VeevaVaultController['prototype'],a386_0x100040(0x8c),null),__decorate([(0x0,core_1['Post'])('deploy'),__param(0x0,core_1[a386_0x100040(0x8d)]['body']()),__metadata(a386_0x100040(0x99),Function),__metadata(a386_0x100040(0xa4),[Object]),__metadata(a386_0x100040(0xb9),Promise)],VeevaVaultController[a386_0x100040(0x9c)],a386_0x100040(0xba),null),__decorate([(0x0,core_1[a386_0x100040(0x9d)])(a386_0x100040(0xbf)),__param(0x0,core_1[a386_0x100040(0x8d)][a386_0x100040(0x9b)]()),__metadata('design:type',Function),__metadata(a386_0x100040(0xa4),[Object]),__metadata(a386_0x100040(0xb9),Promise)],VeevaVaultController['prototype'],'retrieveDependency',null),__decorate([(0x0,core_1[a386_0x100040(0x9d)])(a386_0x100040(0xb3)),__param(0x0,core_1['param'][a386_0x100040(0x9b)]()),__metadata(a386_0x100040(0x99),Function),__metadata(a386_0x100040(0xa4),[Object]),__metadata(a386_0x100040(0xb9),Promise)],VeevaVaultController[a386_0x100040(0x9c)],a386_0x100040(0xb3),null),VeevaVaultController=__decorate([(0x0,core_1[a386_0x100040(0xa3)])('veeva-vault'),(0x0,core_1['Version'])('v1.1')],VeevaVaultController),exports[a386_0x100040(0xaf)]=VeevaVaultController;