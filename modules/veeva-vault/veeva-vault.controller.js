const a318_0x5680dc=a318_0x210f;(function(_0x3c5150,_0x29dee8){const _0x154635=a318_0x210f,_0x1ba5b6=_0x3c5150();while(!![]){try{const _0x5b5c15=-parseInt(_0x154635(0xaa))/0x1+parseInt(_0x154635(0xcd))/0x2+parseInt(_0x154635(0xc3))/0x3*(-parseInt(_0x154635(0xbb))/0x4)+parseInt(_0x154635(0x9f))/0x5+-parseInt(_0x154635(0xc1))/0x6*(-parseInt(_0x154635(0x92))/0x7)+parseInt(_0x154635(0x9d))/0x8+-parseInt(_0x154635(0xa8))/0x9;if(_0x5b5c15===_0x29dee8)break;else _0x1ba5b6['push'](_0x1ba5b6['shift']());}catch(_0x13da18){_0x1ba5b6['push'](_0x1ba5b6['shift']());}}}(a318_0x3f05,0x8e424));const a318_0x1c071d=(function(){let _0x38cd14=!![];return function(_0x54b691,_0x320302){const _0x32f48a=_0x38cd14?function(){const _0x211c06=a318_0x210f;if(_0x320302){const _0x58a415=_0x320302[_0x211c06(0xba)](_0x54b691,arguments);return _0x320302=null,_0x58a415;}}:function(){};return _0x38cd14=![],_0x32f48a;};}()),a318_0x69e290=a318_0x1c071d(this,function(){const _0x3b92ea=a318_0x210f;return a318_0x69e290[_0x3b92ea(0xb9)]()['search'](_0x3b92ea(0xa1))[_0x3b92ea(0xb9)]()[_0x3b92ea(0x95)](a318_0x69e290)[_0x3b92ea(0x9e)](_0x3b92ea(0xa1));});a318_0x69e290();function a318_0x210f(_0x1085f4,_0x3609eb){const _0x4af8e1=a318_0x3f05();return a318_0x210f=function(_0x69e290,_0x1c071d){_0x69e290=_0x69e290-0x8f;let _0x3f0557=_0x4af8e1[_0x69e290];return _0x3f0557;},a318_0x210f(_0x1085f4,_0x3609eb);}'use strict';var __decorate=this&&this[a318_0x5680dc(0xc9)]||function(_0x330a3a,_0x4cdc69,_0xae6d58,_0x274a97){const _0x37d1bd=a318_0x5680dc;var _0x44e953=arguments[_0x37d1bd(0x8f)],_0x4a95bb=_0x44e953<0x3?_0x4cdc69:_0x274a97===null?_0x274a97=Object[_0x37d1bd(0xcb)](_0x4cdc69,_0xae6d58):_0x274a97,_0x51640f;if(typeof Reflect===_0x37d1bd(0x90)&&typeof Reflect[_0x37d1bd(0xb0)]===_0x37d1bd(0xbc))_0x4a95bb=Reflect[_0x37d1bd(0xb0)](_0x330a3a,_0x4cdc69,_0xae6d58,_0x274a97);else{for(var _0x16d57f=_0x330a3a[_0x37d1bd(0x8f)]-0x1;_0x16d57f>=0x0;_0x16d57f--)if(_0x51640f=_0x330a3a[_0x16d57f])_0x4a95bb=(_0x44e953<0x3?_0x51640f(_0x4a95bb):_0x44e953>0x3?_0x51640f(_0x4cdc69,_0xae6d58,_0x4a95bb):_0x51640f(_0x4cdc69,_0xae6d58))||_0x4a95bb;}return _0x44e953>0x3&&_0x4a95bb&&Object[_0x37d1bd(0xa2)](_0x4cdc69,_0xae6d58,_0x4a95bb),_0x4a95bb;},__metadata=this&&this[a318_0x5680dc(0xb8)]||function(_0x4cd59b,_0x26a5d9){const _0x41f332=a318_0x5680dc;if(typeof Reflect===_0x41f332(0x90)&&typeof Reflect['metadata']==='function')return Reflect[_0x41f332(0xa6)](_0x4cd59b,_0x26a5d9);},__param=this&&this[a318_0x5680dc(0xa0)]||function(_0x51e64d,_0x1e5136){return function(_0x42ee79,_0x75f026){_0x1e5136(_0x42ee79,_0x75f026,_0x51e64d);};},__importDefault=this&&this[a318_0x5680dc(0xbe)]||function(_0xa1d60){const _0x4913cb=a318_0x5680dc;return _0xa1d60&&_0xa1d60[_0x4913cb(0x9c)]?_0xa1d60:{'default':_0xa1d60};};function a318_0x3f05(){const _0x4055f1=['deploy','1729UEChgD','getMessages','deployFromBranch','constructor','Controller','Post','./classes/errors/base-veeva-error','createSalesforceRequest','retrieveDependency','temp/veeva/deploy_','__esModule','3184168xviCrf','search','2531960nZpNOD','__param','(((.+)+)+)+$','defineProperty','execute','design:returntype','DeployService','metadata','SalesforceAuth','9612063WdbuWS','doSnapshot','783127KGjKen','design:type','SUCCESS','body','param','fs/promises','decorate','prototype','design:paramtypes','dependency','Logger','VeevaVaultController','./utils/veeva-request.utils','BaseVeevaError','__metadata','toString','apply','268iOzOCh','function','VeevaAuth','__importDefault','./enums/status.enums','createVeevaRequest','23466mYdTOY','getAuthDetails','9519EuBTlj','./classes/auth/salesforce-auth','Version','join','DependencyService','finally','__decorate','SnapshotService','getOwnPropertyDescriptor','FAILURE','1551974JfZNbi','AppResponseStatus','veeva-vault','message','length','object'];a318_0x3f05=function(){return _0x4055f1;};return a318_0x3f05();}Object['defineProperty'](exports,a318_0x5680dc(0x9c),{'value':!![]}),exports[a318_0x5680dc(0xb5)]=void 0x0;const core_1=require('../../core'),dependency_service_1=require('./services/dependency.service'),snapshot_service_1=require('./services/snapshot.service'),deploy_service_1=require('./services/deploy.service'),veeva_request_utils_1=require(a318_0x5680dc(0xb6)),status_enums_1=require(a318_0x5680dc(0xbf)),shortid_1=__importDefault(require('shortid')),fs_util_1=require('./utils/fs-util'),logger_1=require('./classes/logger'),promises_1=require(a318_0x5680dc(0xaf)),base_veeva_error_1=require(a318_0x5680dc(0x98)),salesforce_request_utils_1=require('./utils/salesforce-request.utils'),veeva_auth_1=require('./classes/auth/veeva-auth'),salesforce_auth_1=require(a318_0x5680dc(0xc4)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a318_0x5680dc(0xa9)](_0x4aa1bc){const _0x219581=a318_0x5680dc,{veevaAuth:_0x5af710,timeZone:_0x17166b,attachmentLogId:_0x229bfa}=_0x4aa1bc;try{const _0x102dc4=(0x0,veeva_request_utils_1[_0x219581(0xc0)])(new veeva_auth_1[(_0x219581(0xbd))](_0x5af710,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x360943=await salesforce_auth_1['SalesforceAuth'][_0x219581(0xc2)](),_0x5a3911=(0x0,salesforce_request_utils_1[_0x219581(0x99)])(new salesforce_auth_1['SalesforceAuth'](_0x360943)),_0xb7564d=new logger_1[(_0x219581(0xb4))](_0x5a3911,_0x17166b,_0x229bfa),_0x2965e2=new snapshot_service_1[(_0x219581(0xca))](_0x4aa1bc,_0x5a3911,_0x102dc4,_0xb7564d);return _0x2965e2[_0x219581(0xa3)]()['then'](),{'responseStatus':status_enums_1[_0x219581(0xce)][_0x219581(0xac)]};}catch(_0xb83c17){return{'responseStatus':status_enums_1[_0x219581(0xce)][_0x219581(0xcc)],'responseMessage':_0xb83c17['message']};}}async['deployFromBranch'](_0x42cd12){const _0x3fe2b7=a318_0x5680dc,{veevaAuth:_0x516a3e,timeZone:_0x4a2fd1,attachmentLogId:_0x1b2740}=_0x42cd12;try{const _0x32ac13=(0x0,veeva_request_utils_1[_0x3fe2b7(0xc0)])(new veeva_auth_1[(_0x3fe2b7(0xbd))](_0x516a3e,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x58361a=await salesforce_auth_1[_0x3fe2b7(0xa7)][_0x3fe2b7(0xc2)](),_0x4231c4=(0x0,salesforce_request_utils_1[_0x3fe2b7(0x99)])(new salesforce_auth_1[(_0x3fe2b7(0xa7))](_0x58361a)),_0x27e2fc=new logger_1['Logger'](_0x4231c4,_0x4a2fd1,_0x1b2740),_0x312d71=_0x3fe2b7(0x9b)+(0x0,shortid_1['default'])();await(0x0,fs_util_1['makeDir'])(_0x312d71);const _0x4e3602=new deploy_service_1[(_0x3fe2b7(0xa5))](_0x42cd12,_0x4231c4,_0x32ac13,_0x27e2fc,_0x312d71,_0x58361a['instanceUrl']);return _0x4e3602['execute']()[_0x3fe2b7(0xc8)](()=>(0x0,promises_1['rm'])(_0x312d71,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x3fe2b7(0xac)]};}catch(_0x2caa5a){return{'responseStatus':status_enums_1[_0x3fe2b7(0xce)][_0x3fe2b7(0xcc)],'responseMessage':_0x2caa5a[_0x3fe2b7(0xd0)]};}}async[a318_0x5680dc(0x9a)](_0x491be0){const _0x345cde=a318_0x5680dc,{veevaAuth:_0x3b1461}=_0x491be0;try{const _0x2d804f=(0x0,veeva_request_utils_1[_0x345cde(0xc0)])(new veeva_auth_1[(_0x345cde(0xbd))](_0x3b1461)),_0x5b7301=await salesforce_auth_1[_0x345cde(0xa7)][_0x345cde(0xc2)](),_0x4a401d=(0x0,salesforce_request_utils_1[_0x345cde(0x99)])(new salesforce_auth_1[(_0x345cde(0xa7))](_0x5b7301)),_0x52848a=new dependency_service_1[(_0x345cde(0xc7))](_0x491be0,_0x4a401d,_0x2d804f);return await _0x52848a[_0x345cde(0xa3)]();}catch(_0x1e1537){const _0x22815b=_0x1e1537 instanceof base_veeva_error_1[_0x345cde(0xb7)]?_0x1e1537[_0x345cde(0x93)]()[_0x345cde(0xc6)]('\x0a'):_0x1e1537[_0x345cde(0xd0)];return{'responseStatus':status_enums_1[_0x345cde(0xce)][_0x345cde(0xcc)],'responseMessage':_0x22815b};}}};__decorate([(0x0,core_1[a318_0x5680dc(0x97)])('snapshot'),__param(0x0,core_1[a318_0x5680dc(0xae)][a318_0x5680dc(0xad)]()),__metadata('design:type',Function),__metadata(a318_0x5680dc(0xb2),[Object]),__metadata(a318_0x5680dc(0xa4),Promise)],VeevaVaultController[a318_0x5680dc(0xb1)],a318_0x5680dc(0xa9),null),__decorate([(0x0,core_1['Post'])(a318_0x5680dc(0x91)),__param(0x0,core_1[a318_0x5680dc(0xae)]['body']()),__metadata('design:type',Function),__metadata(a318_0x5680dc(0xb2),[Object]),__metadata(a318_0x5680dc(0xa4),Promise)],VeevaVaultController[a318_0x5680dc(0xb1)],a318_0x5680dc(0x94),null),__decorate([(0x0,core_1[a318_0x5680dc(0x97)])(a318_0x5680dc(0xb3)),__param(0x0,core_1[a318_0x5680dc(0xae)][a318_0x5680dc(0xad)]()),__metadata(a318_0x5680dc(0xab),Function),__metadata(a318_0x5680dc(0xb2),[Object]),__metadata(a318_0x5680dc(0xa4),Promise)],VeevaVaultController[a318_0x5680dc(0xb1)],'retrieveDependency',null),VeevaVaultController=__decorate([(0x0,core_1[a318_0x5680dc(0x96)])(a318_0x5680dc(0xcf)),(0x0,core_1[a318_0x5680dc(0xc5)])('v1')],VeevaVaultController),exports['VeevaVaultController']=VeevaVaultController;