const a263_0x2a3c0f=a263_0x386d;(function(_0x5ea8e1,_0x38543b){const _0x20bd11=a263_0x386d,_0x79480d=_0x5ea8e1();while(!![]){try{const _0x2dd1d4=-parseInt(_0x20bd11(0x181))/0x1+parseInt(_0x20bd11(0x166))/0x2+-parseInt(_0x20bd11(0x145))/0x3*(-parseInt(_0x20bd11(0x187))/0x4)+-parseInt(_0x20bd11(0x140))/0x5*(parseInt(_0x20bd11(0x17f))/0x6)+parseInt(_0x20bd11(0x170))/0x7+-parseInt(_0x20bd11(0x14f))/0x8*(parseInt(_0x20bd11(0x142))/0x9)+parseInt(_0x20bd11(0x151))/0xa;if(_0x2dd1d4===_0x38543b)break;else _0x79480d['push'](_0x79480d['shift']());}catch(_0x3f6e34){_0x79480d['push'](_0x79480d['shift']());}}}(a263_0x548f,0x52eed));const a263_0x1f8cbd=(function(){let _0x468daf=!![];return function(_0x1ec4c1,_0x23b02e){const _0x5aced1=_0x468daf?function(){const _0xfffeec=a263_0x386d;if(_0x23b02e){const _0x3c558b=_0x23b02e[_0xfffeec(0x164)](_0x1ec4c1,arguments);return _0x23b02e=null,_0x3c558b;}}:function(){};return _0x468daf=![],_0x5aced1;};}()),a263_0x3033a9=a263_0x1f8cbd(this,function(){const _0x4e9142=a263_0x386d;return a263_0x3033a9[_0x4e9142(0x175)]()['search'](_0x4e9142(0x17c))[_0x4e9142(0x175)]()[_0x4e9142(0x16c)](a263_0x3033a9)['search'](_0x4e9142(0x17c));});function a263_0x386d(_0x3484a6,_0xfe6328){const _0x59b8e1=a263_0x548f();return a263_0x386d=function(_0x3033a9,_0x1f8cbd){_0x3033a9=_0x3033a9-0x13e;let _0x548f01=_0x59b8e1[_0x3033a9];return _0x548f01;},a263_0x386d(_0x3484a6,_0xfe6328);}a263_0x3033a9();'use strict';var __decorate=this&&this[a263_0x2a3c0f(0x17b)]||function(_0x3f7f1d,_0x1e2f25,_0x55ee5d,_0x1e426a){const _0x530bae=a263_0x2a3c0f;var _0x1662b9=arguments[_0x530bae(0x153)],_0x3fb0d1=_0x1662b9<0x3?_0x1e2f25:_0x1e426a===null?_0x1e426a=Object[_0x530bae(0x183)](_0x1e2f25,_0x55ee5d):_0x1e426a,_0x31970a;if(typeof Reflect===_0x530bae(0x15e)&&typeof Reflect[_0x530bae(0x167)]===_0x530bae(0x161))_0x3fb0d1=Reflect['decorate'](_0x3f7f1d,_0x1e2f25,_0x55ee5d,_0x1e426a);else{for(var _0x1f2063=_0x3f7f1d['length']-0x1;_0x1f2063>=0x0;_0x1f2063--)if(_0x31970a=_0x3f7f1d[_0x1f2063])_0x3fb0d1=(_0x1662b9<0x3?_0x31970a(_0x3fb0d1):_0x1662b9>0x3?_0x31970a(_0x1e2f25,_0x55ee5d,_0x3fb0d1):_0x31970a(_0x1e2f25,_0x55ee5d))||_0x3fb0d1;}return _0x1662b9>0x3&&_0x3fb0d1&&Object[_0x530bae(0x155)](_0x1e2f25,_0x55ee5d,_0x3fb0d1),_0x3fb0d1;},__metadata=this&&this[a263_0x2a3c0f(0x15b)]||function(_0x18c058,_0x93c86){const _0x4dd789=a263_0x2a3c0f;if(typeof Reflect===_0x4dd789(0x15e)&&typeof Reflect[_0x4dd789(0x156)]===_0x4dd789(0x161))return Reflect[_0x4dd789(0x156)](_0x18c058,_0x93c86);},__param=this&&this['__param']||function(_0x1bb010,_0x2d37a8){return function(_0x1fca81,_0x14ec29){_0x2d37a8(_0x1fca81,_0x14ec29,_0x1bb010);};},__importDefault=this&&this[a263_0x2a3c0f(0x182)]||function(_0x11e307){return _0x11e307&&_0x11e307['__esModule']?_0x11e307:{'default':_0x11e307};};Object[a263_0x2a3c0f(0x155)](exports,a263_0x2a3c0f(0x189),{'value':!![]}),exports['VeevaVaultController']=void 0x0;const core_1=require(a263_0x2a3c0f(0x159)),dependency_service_1=require(a263_0x2a3c0f(0x150)),snapshot_service_1=require(a263_0x2a3c0f(0x185)),deploy_service_1=require(a263_0x2a3c0f(0x16f)),veeva_request_utils_1=require('./utils/veeva-request.utils'),status_enums_1=require(a263_0x2a3c0f(0x171)),shortid_1=__importDefault(require(a263_0x2a3c0f(0x16e))),fs_util_1=require(a263_0x2a3c0f(0x13f)),logger_1=require(a263_0x2a3c0f(0x162)),promises_1=require(a263_0x2a3c0f(0x179)),base_veeva_error_1=require(a263_0x2a3c0f(0x152)),salesforce_request_utils_1=require(a263_0x2a3c0f(0x148)),veeva_auth_1=require(a263_0x2a3c0f(0x172)),salesforce_auth_1=require(a263_0x2a3c0f(0x169)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;function a263_0x548f(){const _0x1c4c07=['doSnapshot','object','retrieveDependency','message','function','./classes/logger','prototype','apply','Version','18036EAIbSu','decorate','veeva-vault','./classes/auth/salesforce-auth','SalesforceAuth','Post','constructor','getAuthDetails','shortid','./services/deploy.service','2627422fEgXKA','./enums/status.enums','./classes/auth/veeva-auth','deploy','DependencyService','toString','execute','dependency','AppResponseStatus','fs/promises','Controller','__decorate','(((.+)+)+)+$','createSalesforceRequest','snapshot','16086SThADA','VeevaAuth','95131gNhOzV','__importDefault','getOwnPropertyDescriptor','SnapshotService','./services/snapshot.service','FAILURE','1464saHxHN','makeDir','__esModule','param','./utils/fs-util','200EoWJXY','deployFromBranch','819FrFVEp','getMessages','SUCCESS','2661wtKoDs','BaseVeevaError','then','./utils/salesforce-request.utils','body','design:paramtypes','default','DeployService','VeevaVaultController','design:returntype','47944yOJWga','./services/dependency.service','3784210xKFgiY','./classes/errors/base-veeva-error','length','design:type','defineProperty','metadata','Logger','createVeevaRequest','../../core','join','__metadata','finally'];a263_0x548f=function(){return _0x1c4c07;};return a263_0x548f();}let VeevaVaultController=class VeevaVaultController{async[a263_0x2a3c0f(0x15d)](_0x1b2e40){const _0x27a3be=a263_0x2a3c0f,{veevaAuth:_0x4ba295,timeZone:_0x36384a,attachmentLogId:_0x20d393}=_0x1b2e40;try{const _0x274165=(0x0,veeva_request_utils_1[_0x27a3be(0x158)])(new veeva_auth_1[(_0x27a3be(0x180))](_0x4ba295,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x499d54=await salesforce_auth_1[_0x27a3be(0x16a)]['getAuthDetails'](),_0xac48a0=(0x0,salesforce_request_utils_1[_0x27a3be(0x17d)])(new salesforce_auth_1[(_0x27a3be(0x16a))](_0x499d54)),_0x313645=new logger_1[(_0x27a3be(0x157))](_0xac48a0,_0x36384a,_0x20d393),_0x34e9c2=new snapshot_service_1[(_0x27a3be(0x184))](_0x1b2e40,_0xac48a0,_0x274165,_0x313645);return _0x34e9c2['execute']()[_0x27a3be(0x147)](),{'responseStatus':status_enums_1[_0x27a3be(0x178)][_0x27a3be(0x144)]};}catch(_0x5cd4ca){return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x5cd4ca[_0x27a3be(0x160)]};}}async[a263_0x2a3c0f(0x141)](_0x522739){const _0x3a9886=a263_0x2a3c0f,{veevaAuth:_0x1d0769,timeZone:_0x3f4c3f,attachmentLogId:_0x4b1216}=_0x522739;try{const _0x2c8dd4=(0x0,veeva_request_utils_1[_0x3a9886(0x158)])(new veeva_auth_1['VeevaAuth'](_0x1d0769,JOB_UPDATE_TOKEN_ATTEMPTS)),_0xffab76=await salesforce_auth_1[_0x3a9886(0x16a)][_0x3a9886(0x16d)](),_0x35fa1e=(0x0,salesforce_request_utils_1[_0x3a9886(0x17d)])(new salesforce_auth_1[(_0x3a9886(0x16a))](_0xffab76)),_0x188683=new logger_1[(_0x3a9886(0x157))](_0x35fa1e,_0x3f4c3f,_0x4b1216),_0x21dba7='temp/veeva/deploy_'+(0x0,shortid_1[_0x3a9886(0x14b)])();await(0x0,fs_util_1[_0x3a9886(0x188)])(_0x21dba7);const _0x251027=new deploy_service_1[(_0x3a9886(0x14c))](_0x522739,_0x35fa1e,_0x2c8dd4,_0x188683,_0x21dba7,_0xffab76['instanceUrl']);return _0x251027[_0x3a9886(0x176)]()[_0x3a9886(0x15c)](()=>(0x0,promises_1['rm'])(_0x21dba7,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x3a9886(0x178)][_0x3a9886(0x144)]};}catch(_0x3a0d98){return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x3a0d98[_0x3a9886(0x160)]};}}async[a263_0x2a3c0f(0x15f)](_0xaf6484){const _0x263a09=a263_0x2a3c0f,{veevaAuth:_0x52107e}=_0xaf6484;try{const _0x8ca1e7=(0x0,veeva_request_utils_1[_0x263a09(0x158)])(new veeva_auth_1[(_0x263a09(0x180))](_0x52107e)),_0x379aba=await salesforce_auth_1[_0x263a09(0x16a)][_0x263a09(0x16d)](),_0xcc812a=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x263a09(0x16a))](_0x379aba)),_0x4ea0c7=new dependency_service_1[(_0x263a09(0x174))](_0xaf6484,_0xcc812a,_0x8ca1e7);return await _0x4ea0c7[_0x263a09(0x176)]();}catch(_0x29b590){const _0x850b03=_0x29b590 instanceof base_veeva_error_1[_0x263a09(0x146)]?_0x29b590[_0x263a09(0x143)]()[_0x263a09(0x15a)]('\x0a'):_0x29b590['message'];return{'responseStatus':status_enums_1['AppResponseStatus'][_0x263a09(0x186)],'responseMessage':_0x850b03};}}};__decorate([(0x0,core_1[a263_0x2a3c0f(0x16b)])(a263_0x2a3c0f(0x17e)),__param(0x0,core_1[a263_0x2a3c0f(0x13e)][a263_0x2a3c0f(0x149)]()),__metadata(a263_0x2a3c0f(0x154),Function),__metadata(a263_0x2a3c0f(0x14a),[Object]),__metadata(a263_0x2a3c0f(0x14e),Promise)],VeevaVaultController['prototype'],a263_0x2a3c0f(0x15d),null),__decorate([(0x0,core_1[a263_0x2a3c0f(0x16b)])(a263_0x2a3c0f(0x173)),__param(0x0,core_1[a263_0x2a3c0f(0x13e)]['body']()),__metadata(a263_0x2a3c0f(0x154),Function),__metadata(a263_0x2a3c0f(0x14a),[Object]),__metadata(a263_0x2a3c0f(0x14e),Promise)],VeevaVaultController[a263_0x2a3c0f(0x163)],a263_0x2a3c0f(0x141),null),__decorate([(0x0,core_1[a263_0x2a3c0f(0x16b)])(a263_0x2a3c0f(0x177)),__param(0x0,core_1[a263_0x2a3c0f(0x13e)][a263_0x2a3c0f(0x149)]()),__metadata(a263_0x2a3c0f(0x154),Function),__metadata(a263_0x2a3c0f(0x14a),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController['prototype'],a263_0x2a3c0f(0x15f),null),VeevaVaultController=__decorate([(0x0,core_1[a263_0x2a3c0f(0x17a)])(a263_0x2a3c0f(0x168)),(0x0,core_1[a263_0x2a3c0f(0x165)])('v1')],VeevaVaultController),exports[a263_0x2a3c0f(0x14d)]=VeevaVaultController;