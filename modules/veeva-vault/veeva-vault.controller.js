const a403_0x2823cc=a403_0x4164;(function(_0x23a96e,_0x1a0225){const _0xe9a997=a403_0x4164,_0x5127b9=_0x23a96e();while(!![]){try{const _0x3ab178=parseInt(_0xe9a997(0x186))/0x1+-parseInt(_0xe9a997(0x1b3))/0x2+parseInt(_0xe9a997(0x1c6))/0x3*(-parseInt(_0xe9a997(0x1aa))/0x4)+parseInt(_0xe9a997(0x1c2))/0x5+parseInt(_0xe9a997(0x1ae))/0x6*(parseInt(_0xe9a997(0x1ba))/0x7)+parseInt(_0xe9a997(0x19f))/0x8+-parseInt(_0xe9a997(0x19d))/0x9;if(_0x3ab178===_0x1a0225)break;else _0x5127b9['push'](_0x5127b9['shift']());}catch(_0x2bc6a8){_0x5127b9['push'](_0x5127b9['shift']());}}}(a403_0x2688,0x73305));const a403_0x294099=(function(){let _0x99cdc7=!![];return function(_0xcb8ef9,_0x13da51){const _0x245e2a=_0x99cdc7?function(){const _0x702f9f=a403_0x4164;if(_0x13da51){const _0x175512=_0x13da51[_0x702f9f(0x1ac)](_0xcb8ef9,arguments);return _0x13da51=null,_0x175512;}}:function(){};return _0x99cdc7=![],_0x245e2a;};}()),a403_0x584e65=a403_0x294099(this,function(){const _0x22bf28=a403_0x4164;return a403_0x584e65[_0x22bf28(0x1c0)]()[_0x22bf28(0x1ab)](_0x22bf28(0x189))['toString']()[_0x22bf28(0x1c1)](a403_0x584e65)[_0x22bf28(0x1ab)](_0x22bf28(0x189));});a403_0x584e65();function a403_0x2688(){const _0xf6180c=['apply','rollback','150816wocVGo','object','metadata','design:paramtypes','../../core','1429760mJEYxJ','doSnapshot','RollbackService','VeevaVaultController','prototype','getMessages','__decorate','49ldkUYP','shortid','AppResponseStatus','./classes/loggers/logger','finally','deploy','toString','constructor','4159045LzZAgZ','./services/rollback.service','__esModule','Post','12bvBaGA','createSalesforceRequest','__importDefault','v1.1','param','design:type','temp/veeva/rollback_','FAILURE','veeva-vault','./classes/auth/veeva-auth','makeDir','806776rjhujF','snapshot','getOwnPropertyDescriptor','(((.+)+)+)+$','getAuthDetails','SalesforceAuth','./classes/auth/salesforce-auth','Logger','SUCCESS','VeevaAuth','design:returntype','message','length','deployFromBranch','retrieveDependency','__metadata','./services/snapshot.service','execute','BaseVeevaError','default','DeployService','instanceUrl','body','8646849bLerpe','./classes/errors/base-veeva-error','3186184KOZzmg','./utils/fs-util','./services/dependency.service','function','./services/deploy.service','createVeevaRequest','decorate','join','Version','then','defineProperty','65356bzHwoZ','search'];a403_0x2688=function(){return _0xf6180c;};return a403_0x2688();}function a403_0x4164(_0xffce9a,_0x1766cf){const _0x16adfe=a403_0x2688();return a403_0x4164=function(_0x584e65,_0x294099){_0x584e65=_0x584e65-0x17e;let _0x26889b=_0x16adfe[_0x584e65];return _0x26889b;},a403_0x4164(_0xffce9a,_0x1766cf);}'use strict';var __decorate=this&&this[a403_0x2823cc(0x1b9)]||function(_0x104f34,_0x132805,_0x81bbb,_0x2f7aad){const _0x39d58d=a403_0x2823cc;var _0x3bde19=arguments[_0x39d58d(0x192)],_0x4913b8=_0x3bde19<0x3?_0x132805:_0x2f7aad===null?_0x2f7aad=Object[_0x39d58d(0x188)](_0x132805,_0x81bbb):_0x2f7aad,_0x3139f1;if(typeof Reflect===_0x39d58d(0x1af)&&typeof Reflect[_0x39d58d(0x1a5)]==='function')_0x4913b8=Reflect[_0x39d58d(0x1a5)](_0x104f34,_0x132805,_0x81bbb,_0x2f7aad);else{for(var _0x1d516b=_0x104f34['length']-0x1;_0x1d516b>=0x0;_0x1d516b--)if(_0x3139f1=_0x104f34[_0x1d516b])_0x4913b8=(_0x3bde19<0x3?_0x3139f1(_0x4913b8):_0x3bde19>0x3?_0x3139f1(_0x132805,_0x81bbb,_0x4913b8):_0x3139f1(_0x132805,_0x81bbb))||_0x4913b8;}return _0x3bde19>0x3&&_0x4913b8&&Object[_0x39d58d(0x1a9)](_0x132805,_0x81bbb,_0x4913b8),_0x4913b8;},__metadata=this&&this[a403_0x2823cc(0x195)]||function(_0x3b78b0,_0x5eb386){const _0x2d3d1f=a403_0x2823cc;if(typeof Reflect===_0x2d3d1f(0x1af)&&typeof Reflect[_0x2d3d1f(0x1b0)]===_0x2d3d1f(0x1a2))return Reflect['metadata'](_0x3b78b0,_0x5eb386);},__param=this&&this['__param']||function(_0x39a925,_0x468046){return function(_0x47d254,_0xdf1f02){_0x468046(_0x47d254,_0xdf1f02,_0x39a925);};},__importDefault=this&&this[a403_0x2823cc(0x1c8)]||function(_0x4d3c19){const _0x5dd808=a403_0x2823cc;return _0x4d3c19&&_0x4d3c19[_0x5dd808(0x1c4)]?_0x4d3c19:{'default':_0x4d3c19};};Object[a403_0x2823cc(0x1a9)](exports,'__esModule',{'value':!![]}),exports[a403_0x2823cc(0x1b6)]=void 0x0;const core_1=require(a403_0x2823cc(0x1b2)),dependency_service_1=require(a403_0x2823cc(0x1a1)),snapshot_service_1=require(a403_0x2823cc(0x196)),deploy_service_1=require(a403_0x2823cc(0x1a3)),veeva_request_utils_1=require('./utils/veeva-request.utils'),status_enums_1=require('./enums/status.enums'),shortid_1=__importDefault(require(a403_0x2823cc(0x1bb))),fs_util_1=require(a403_0x2823cc(0x1a0)),logger_1=require(a403_0x2823cc(0x1bd)),promises_1=require('fs/promises'),base_veeva_error_1=require(a403_0x2823cc(0x19e)),salesforce_request_utils_1=require('./utils/salesforce-request.utils'),veeva_auth_1=require(a403_0x2823cc(0x184)),salesforce_auth_1=require(a403_0x2823cc(0x18c)),rollback_service_1=require(a403_0x2823cc(0x1c3)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async['doSnapshot'](_0x43e689){const _0x4067d4=a403_0x2823cc,{veevaAuth:_0x8d386e,timeZone:_0x1ef4c8,attachmentLogId:_0x193461}=_0x43e689;try{const _0x4b8648=(0x0,veeva_request_utils_1[_0x4067d4(0x1a4)])(new veeva_auth_1['VeevaAuth'](_0x8d386e,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x258f10=await salesforce_auth_1[_0x4067d4(0x18b)]['getAuthDetails'](),_0x11acc3=(0x0,salesforce_request_utils_1[_0x4067d4(0x1c7)])(new salesforce_auth_1[(_0x4067d4(0x18b))](_0x258f10)),_0x5d882c=new logger_1[(_0x4067d4(0x18d))](_0x11acc3,_0x1ef4c8,_0x193461),_0x5a768b=new snapshot_service_1['SnapshotService'](_0x43e689,_0x11acc3,_0x4b8648,_0x5d882c);return _0x5a768b[_0x4067d4(0x197)]()[_0x4067d4(0x1a8)](),{'responseStatus':status_enums_1[_0x4067d4(0x1bc)][_0x4067d4(0x18e)]};}catch(_0x5494c6){return{'responseStatus':status_enums_1[_0x4067d4(0x1bc)]['FAILURE'],'responseMessage':_0x5494c6[_0x4067d4(0x191)]};}}async[a403_0x2823cc(0x193)](_0x290d28){const _0x4f8c33=a403_0x2823cc,{veevaAuth:_0x2e6d1a,timeZone:_0x23a23d,attachmentLogId:_0x1dedfb}=_0x290d28;try{const _0x208c49=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x4f8c33(0x18f))](_0x2e6d1a,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x2283c8=await salesforce_auth_1[_0x4f8c33(0x18b)][_0x4f8c33(0x18a)](),_0x2b0cf9=(0x0,salesforce_request_utils_1[_0x4f8c33(0x1c7)])(new salesforce_auth_1[(_0x4f8c33(0x18b))](_0x2283c8)),_0x284ad1=new logger_1[(_0x4f8c33(0x18d))](_0x2b0cf9,_0x23a23d,_0x1dedfb),_0x32e3c8='temp/veeva/deploy_'+(0x0,shortid_1[_0x4f8c33(0x199)])();await(0x0,fs_util_1[_0x4f8c33(0x185)])(_0x32e3c8);const _0x4f6023=new deploy_service_1[(_0x4f8c33(0x19a))](_0x290d28,_0x2b0cf9,_0x208c49,_0x284ad1,_0x32e3c8,_0x2283c8[_0x4f8c33(0x19b)]);return _0x4f6023[_0x4f8c33(0x197)]()[_0x4f8c33(0x1be)](()=>(0x0,promises_1['rm'])(_0x32e3c8,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x4f8c33(0x1bc)][_0x4f8c33(0x18e)]};}catch(_0x2db6fb){return{'responseStatus':status_enums_1[_0x4f8c33(0x1bc)]['FAILURE'],'responseMessage':_0x2db6fb[_0x4f8c33(0x191)]};}}async[a403_0x2823cc(0x194)](_0x5f39f9){const _0x31da6d=a403_0x2823cc,{veevaAuth:_0x46edcc}=_0x5f39f9;try{const _0x46a65e=(0x0,veeva_request_utils_1[_0x31da6d(0x1a4)])(new veeva_auth_1[(_0x31da6d(0x18f))](_0x46edcc)),_0x1d7b86=await salesforce_auth_1[_0x31da6d(0x18b)]['getAuthDetails'](),_0x575060=(0x0,salesforce_request_utils_1[_0x31da6d(0x1c7)])(new salesforce_auth_1[(_0x31da6d(0x18b))](_0x1d7b86)),_0x327635=new dependency_service_1['DependencyService'](_0x5f39f9,_0x575060,_0x46a65e);return await _0x327635[_0x31da6d(0x197)]();}catch(_0x260f3f){const _0x35b293=_0x260f3f instanceof base_veeva_error_1[_0x31da6d(0x198)]?_0x260f3f[_0x31da6d(0x1b8)]()[_0x31da6d(0x1a6)]('\x0a'):_0x260f3f['message'];return{'responseStatus':status_enums_1[_0x31da6d(0x1bc)][_0x31da6d(0x182)],'responseMessage':_0x35b293};}}async[a403_0x2823cc(0x1ad)](_0x9d6425){const _0x1395d6=a403_0x2823cc,{veevaAuth:_0x6da9f6,timeZone:_0x56fd1a,attachmentLogId:_0x1eb1d7}=_0x9d6425;try{const _0x1f859c=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x1395d6(0x18f))](_0x6da9f6,JOB_UPDATE_TOKEN_ATTEMPTS)),_0xbd0ab6=await salesforce_auth_1[_0x1395d6(0x18b)][_0x1395d6(0x18a)](),_0x4c8343=(0x0,salesforce_request_utils_1[_0x1395d6(0x1c7)])(new salesforce_auth_1[(_0x1395d6(0x18b))](_0xbd0ab6)),_0x4a2cac=new logger_1[(_0x1395d6(0x18d))](_0x4c8343,_0x56fd1a,_0x1eb1d7),_0x27be03=_0x1395d6(0x181)+(0x0,shortid_1[_0x1395d6(0x199)])();await(0x0,fs_util_1[_0x1395d6(0x185)])(_0x27be03);const _0x657ab2=new rollback_service_1[(_0x1395d6(0x1b5))]({..._0x9d6425,'connectionVeeva':_0x1f859c,'connectionSalesforce':_0x4c8343,'logger':_0x4a2cac,'tempFolder':_0x27be03,'instanceUrl':_0xbd0ab6[_0x1395d6(0x19b)]});return _0x657ab2[_0x1395d6(0x197)]()[_0x1395d6(0x1be)](()=>(0x0,promises_1['rm'])(_0x27be03,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x1395d6(0x18e)]};}catch(_0x5382aa){return{'responseStatus':status_enums_1[_0x1395d6(0x1bc)][_0x1395d6(0x182)],'responseMessage':_0x5382aa[_0x1395d6(0x191)]};}}};__decorate([(0x0,core_1[a403_0x2823cc(0x1c5)])(a403_0x2823cc(0x187)),__param(0x0,core_1[a403_0x2823cc(0x17f)][a403_0x2823cc(0x19c)]()),__metadata(a403_0x2823cc(0x180),Function),__metadata('design:paramtypes',[Object]),__metadata(a403_0x2823cc(0x190),Promise)],VeevaVaultController['prototype'],a403_0x2823cc(0x1b4),null),__decorate([(0x0,core_1[a403_0x2823cc(0x1c5)])(a403_0x2823cc(0x1bf)),__param(0x0,core_1['param'][a403_0x2823cc(0x19c)]()),__metadata(a403_0x2823cc(0x180),Function),__metadata(a403_0x2823cc(0x1b1),[Object]),__metadata(a403_0x2823cc(0x190),Promise)],VeevaVaultController[a403_0x2823cc(0x1b7)],a403_0x2823cc(0x193),null),__decorate([(0x0,core_1[a403_0x2823cc(0x1c5)])('dependency'),__param(0x0,core_1['param'][a403_0x2823cc(0x19c)]()),__metadata(a403_0x2823cc(0x180),Function),__metadata('design:paramtypes',[Object]),__metadata(a403_0x2823cc(0x190),Promise)],VeevaVaultController[a403_0x2823cc(0x1b7)],a403_0x2823cc(0x194),null),__decorate([(0x0,core_1[a403_0x2823cc(0x1c5)])(a403_0x2823cc(0x1ad)),__param(0x0,core_1[a403_0x2823cc(0x17f)][a403_0x2823cc(0x19c)]()),__metadata(a403_0x2823cc(0x180),Function),__metadata(a403_0x2823cc(0x1b1),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a403_0x2823cc(0x1b7)],a403_0x2823cc(0x1ad),null),VeevaVaultController=__decorate([(0x0,core_1['Controller'])(a403_0x2823cc(0x183)),(0x0,core_1[a403_0x2823cc(0x1a7)])(a403_0x2823cc(0x17e))],VeevaVaultController),exports[a403_0x2823cc(0x1b6)]=VeevaVaultController;