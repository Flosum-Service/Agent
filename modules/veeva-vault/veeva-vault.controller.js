const a318_0x44233d=a318_0x3fcc;(function(_0x1f4f6e,_0x29376e){const _0x4a318b=a318_0x3fcc,_0x42cc5c=_0x1f4f6e();while(!![]){try{const _0x5b84d4=-parseInt(_0x4a318b(0x179))/0x1+parseInt(_0x4a318b(0x191))/0x2*(-parseInt(_0x4a318b(0x19a))/0x3)+-parseInt(_0x4a318b(0x1a5))/0x4+parseInt(_0x4a318b(0x1b4))/0x5+-parseInt(_0x4a318b(0x1b0))/0x6*(-parseInt(_0x4a318b(0x1b6))/0x7)+-parseInt(_0x4a318b(0x19d))/0x8+parseInt(_0x4a318b(0x17b))/0x9;if(_0x5b84d4===_0x29376e)break;else _0x42cc5c['push'](_0x42cc5c['shift']());}catch(_0x284b4c){_0x42cc5c['push'](_0x42cc5c['shift']());}}}(a318_0x346d,0x45159));const a318_0x311230=(function(){let _0x229c83=!![];return function(_0x1e1e38,_0x47ac84){const _0x1cb373=_0x229c83?function(){const _0x275683=a318_0x3fcc;if(_0x47ac84){const _0x4ff926=_0x47ac84[_0x275683(0x1aa)](_0x1e1e38,arguments);return _0x47ac84=null,_0x4ff926;}}:function(){};return _0x229c83=![],_0x1cb373;};}()),a318_0x4ce2b8=a318_0x311230(this,function(){const _0x4c9915=a318_0x3fcc;return a318_0x4ce2b8[_0x4c9915(0x1a3)]()[_0x4c9915(0x1a7)]('(((.+)+)+)+$')[_0x4c9915(0x1a3)]()[_0x4c9915(0x1b3)](a318_0x4ce2b8)['search'](_0x4c9915(0x178));});a318_0x4ce2b8();'use strict';function a318_0x346d(){const _0x5ec344=['apply','../../core','__importDefault','./classes/auth/veeva-auth','./services/deploy.service','body','1059762ipxFUm','./utils/fs-util','execute','constructor','2621790EQpHTF','./classes/logger','14iCConI','__decorate','default','snapshot','createSalesforceRequest','defineProperty','instanceUrl','__param','(((.+)+)+)+$','159524whYabI','FAILURE','6042033QQYabo','retrieveDependency','then','SUCCESS','deploy','length','VeevaAuth','function','getOwnPropertyDescriptor','__esModule','SnapshotService','veeva-vault','getAuthDetails','prototype','AppResponseStatus','./utils/salesforce-request.utils','shortid','createVeevaRequest','DeployService','./utils/veeva-request.utils','./services/dependency.service','BaseVeevaError','664JeUzLz','deployFromBranch','fs/promises','VeevaVaultController','Post','Logger','design:type','param','__metadata','501KCTMth','object','design:paramtypes','4114368xBhfUP','decorate','join','message','DependencyService','SalesforceAuth','toString','metadata','2146864bzHsvf','./classes/auth/salesforce-auth','search','Controller','./classes/errors/base-veeva-error'];a318_0x346d=function(){return _0x5ec344;};return a318_0x346d();}var __decorate=this&&this[a318_0x44233d(0x1b7)]||function(_0x12d0b1,_0x1a1a0b,_0x3fa24b,_0x4ff265){const _0x146685=a318_0x44233d;var _0x1ed919=arguments[_0x146685(0x180)],_0x2158aa=_0x1ed919<0x3?_0x1a1a0b:_0x4ff265===null?_0x4ff265=Object[_0x146685(0x183)](_0x1a1a0b,_0x3fa24b):_0x4ff265,_0x4ee951;if(typeof Reflect===_0x146685(0x19b)&&typeof Reflect['decorate']===_0x146685(0x182))_0x2158aa=Reflect[_0x146685(0x19e)](_0x12d0b1,_0x1a1a0b,_0x3fa24b,_0x4ff265);else{for(var _0x36e812=_0x12d0b1[_0x146685(0x180)]-0x1;_0x36e812>=0x0;_0x36e812--)if(_0x4ee951=_0x12d0b1[_0x36e812])_0x2158aa=(_0x1ed919<0x3?_0x4ee951(_0x2158aa):_0x1ed919>0x3?_0x4ee951(_0x1a1a0b,_0x3fa24b,_0x2158aa):_0x4ee951(_0x1a1a0b,_0x3fa24b))||_0x2158aa;}return _0x1ed919>0x3&&_0x2158aa&&Object[_0x146685(0x175)](_0x1a1a0b,_0x3fa24b,_0x2158aa),_0x2158aa;},__metadata=this&&this[a318_0x44233d(0x199)]||function(_0x35187c,_0x115ed5){const _0x4f220d=a318_0x44233d;if(typeof Reflect==='object'&&typeof Reflect[_0x4f220d(0x1a4)]==='function')return Reflect[_0x4f220d(0x1a4)](_0x35187c,_0x115ed5);},__param=this&&this[a318_0x44233d(0x177)]||function(_0x27c85f,_0xe25079){return function(_0x4c7863,_0x4ec3bd){_0xe25079(_0x4c7863,_0x4ec3bd,_0x27c85f);};},__importDefault=this&&this[a318_0x44233d(0x1ac)]||function(_0x3594f2){const _0x281b51=a318_0x44233d;return _0x3594f2&&_0x3594f2[_0x281b51(0x184)]?_0x3594f2:{'default':_0x3594f2};};Object[a318_0x44233d(0x175)](exports,a318_0x44233d(0x184),{'value':!![]}),exports[a318_0x44233d(0x194)]=void 0x0;function a318_0x3fcc(_0x2078b5,_0x3a4e36){const _0x4c9b31=a318_0x346d();return a318_0x3fcc=function(_0x4ce2b8,_0x311230){_0x4ce2b8=_0x4ce2b8-0x175;let _0x346d74=_0x4c9b31[_0x4ce2b8];return _0x346d74;},a318_0x3fcc(_0x2078b5,_0x3a4e36);}const core_1=require(a318_0x44233d(0x1ab)),dependency_service_1=require(a318_0x44233d(0x18f)),snapshot_service_1=require('./services/snapshot.service'),deploy_service_1=require(a318_0x44233d(0x1ae)),veeva_request_utils_1=require(a318_0x44233d(0x18e)),status_enums_1=require('./enums/status.enums'),shortid_1=__importDefault(require(a318_0x44233d(0x18b))),fs_util_1=require(a318_0x44233d(0x1b1)),logger_1=require(a318_0x44233d(0x1b5)),promises_1=require(a318_0x44233d(0x193)),base_veeva_error_1=require(a318_0x44233d(0x1a9)),salesforce_request_utils_1=require(a318_0x44233d(0x18a)),veeva_auth_1=require(a318_0x44233d(0x1ad)),salesforce_auth_1=require(a318_0x44233d(0x1a6)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async['doSnapshot'](_0x487501){const _0x4ec48a=a318_0x44233d,{veevaAuth:_0x4ff1cc,timeZone:_0x23c6da,attachmentLogId:_0x4fc575}=_0x487501;try{const _0x66d0a1=(0x0,veeva_request_utils_1[_0x4ec48a(0x18c)])(new veeva_auth_1[(_0x4ec48a(0x181))](_0x4ff1cc,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x2e5a41=await salesforce_auth_1['SalesforceAuth'][_0x4ec48a(0x187)](),_0x5d9978=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x4ec48a(0x1a2))](_0x2e5a41)),_0x474b0b=new logger_1[(_0x4ec48a(0x196))](_0x5d9978,_0x23c6da,_0x4fc575),_0x51e902=new snapshot_service_1[(_0x4ec48a(0x185))](_0x487501,_0x5d9978,_0x66d0a1,_0x474b0b);return _0x51e902['execute']()[_0x4ec48a(0x17d)](),{'responseStatus':status_enums_1[_0x4ec48a(0x189)]['SUCCESS']};}catch(_0x49348c){return{'responseStatus':status_enums_1[_0x4ec48a(0x189)]['FAILURE'],'responseMessage':_0x49348c[_0x4ec48a(0x1a0)]};}}async[a318_0x44233d(0x192)](_0x4657cf){const _0x3389fc=a318_0x44233d,{veevaAuth:_0x6b1a0c,timeZone:_0x30953c,attachmentLogId:_0x4e8cb1}=_0x4657cf;try{const _0x3223e8=(0x0,veeva_request_utils_1[_0x3389fc(0x18c)])(new veeva_auth_1[(_0x3389fc(0x181))](_0x6b1a0c,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x192c1e=await salesforce_auth_1[_0x3389fc(0x1a2)]['getAuthDetails'](),_0x5e68b8=(0x0,salesforce_request_utils_1[_0x3389fc(0x1ba)])(new salesforce_auth_1[(_0x3389fc(0x1a2))](_0x192c1e)),_0x3a171e=new logger_1[(_0x3389fc(0x196))](_0x5e68b8,_0x30953c,_0x4e8cb1),_0x1db94c='temp/veeva/deploy_'+(0x0,shortid_1[_0x3389fc(0x1b8)])();await(0x0,fs_util_1['makeDir'])(_0x1db94c);const _0x1f55ec=new deploy_service_1[(_0x3389fc(0x18d))](_0x4657cf,_0x5e68b8,_0x3223e8,_0x3a171e,_0x1db94c,_0x192c1e[_0x3389fc(0x176)]);return _0x1f55ec[_0x3389fc(0x1b2)]()['finally'](()=>(0x0,promises_1['rm'])(_0x1db94c,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x3389fc(0x189)][_0x3389fc(0x17e)]};}catch(_0x22d828){return{'responseStatus':status_enums_1[_0x3389fc(0x189)][_0x3389fc(0x17a)],'responseMessage':_0x22d828['message']};}}async[a318_0x44233d(0x17c)](_0x4b4c29){const _0x4c81f1=a318_0x44233d,{veevaAuth:_0x4ddf66}=_0x4b4c29;try{const _0x2e44e7=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x4c81f1(0x181))](_0x4ddf66)),_0x5de18e=await salesforce_auth_1[_0x4c81f1(0x1a2)][_0x4c81f1(0x187)](),_0x559307=(0x0,salesforce_request_utils_1[_0x4c81f1(0x1ba)])(new salesforce_auth_1[(_0x4c81f1(0x1a2))](_0x5de18e)),_0x262faa=new dependency_service_1[(_0x4c81f1(0x1a1))](_0x4b4c29,_0x559307,_0x2e44e7);return await _0x262faa[_0x4c81f1(0x1b2)]();}catch(_0x5c3817){const _0x5b5424=_0x5c3817 instanceof base_veeva_error_1[_0x4c81f1(0x190)]?_0x5c3817['getMessages']()[_0x4c81f1(0x19f)]('\x0a'):_0x5c3817[_0x4c81f1(0x1a0)];return{'responseStatus':status_enums_1[_0x4c81f1(0x189)][_0x4c81f1(0x17a)],'responseMessage':_0x5b5424};}}};__decorate([(0x0,core_1[a318_0x44233d(0x195)])(a318_0x44233d(0x1b9)),__param(0x0,core_1[a318_0x44233d(0x198)][a318_0x44233d(0x1af)]()),__metadata(a318_0x44233d(0x197),Function),__metadata(a318_0x44233d(0x19c),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a318_0x44233d(0x188)],'doSnapshot',null),__decorate([(0x0,core_1[a318_0x44233d(0x195)])(a318_0x44233d(0x17f)),__param(0x0,core_1['param'][a318_0x44233d(0x1af)]()),__metadata(a318_0x44233d(0x197),Function),__metadata(a318_0x44233d(0x19c),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a318_0x44233d(0x188)],a318_0x44233d(0x192),null),__decorate([(0x0,core_1[a318_0x44233d(0x195)])('dependency'),__param(0x0,core_1[a318_0x44233d(0x198)]['body']()),__metadata('design:type',Function),__metadata(a318_0x44233d(0x19c),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a318_0x44233d(0x188)],a318_0x44233d(0x17c),null),VeevaVaultController=__decorate([(0x0,core_1[a318_0x44233d(0x1a8)])(a318_0x44233d(0x186)),(0x0,core_1['Version'])('v1')],VeevaVaultController),exports[a318_0x44233d(0x194)]=VeevaVaultController;