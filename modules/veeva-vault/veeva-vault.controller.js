const a414_0xcc20cf=a414_0x1063;(function(_0x4c9e57,_0x2b9293){const _0xae4d=a414_0x1063,_0x194767=_0x4c9e57();while(!![]){try{const _0x5adb68=-parseInt(_0xae4d(0x12c))/0x1+-parseInt(_0xae4d(0x150))/0x2*(parseInt(_0xae4d(0x12b))/0x3)+parseInt(_0xae4d(0x127))/0x4*(-parseInt(_0xae4d(0x147))/0x5)+-parseInt(_0xae4d(0x11c))/0x6+-parseInt(_0xae4d(0x158))/0x7*(parseInt(_0xae4d(0x12d))/0x8)+-parseInt(_0xae4d(0x159))/0x9+parseInt(_0xae4d(0x121))/0xa*(parseInt(_0xae4d(0x122))/0xb);if(_0x5adb68===_0x2b9293)break;else _0x194767['push'](_0x194767['shift']());}catch(_0x1d334e){_0x194767['push'](_0x194767['shift']());}}}(a414_0x334d,0x64597));const a414_0x476f53=(function(){let _0x4a429d=!![];return function(_0x4b446d,_0x102efd){const _0x49a594=_0x4a429d?function(){const _0x4300f0=a414_0x1063;if(_0x102efd){const _0x551ec4=_0x102efd[_0x4300f0(0x144)](_0x4b446d,arguments);return _0x102efd=null,_0x551ec4;}}:function(){};return _0x4a429d=![],_0x49a594;};}()),a414_0x52a53f=a414_0x476f53(this,function(){const _0x50249f=a414_0x1063;return a414_0x52a53f[_0x50249f(0x13e)]()[_0x50249f(0x151)](_0x50249f(0x154))[_0x50249f(0x13e)]()[_0x50249f(0x13b)](a414_0x52a53f)[_0x50249f(0x151)]('(((.+)+)+)+$');});function a414_0x1063(_0x5e5e72,_0x400ea8){const _0x5a47d6=a414_0x334d();return a414_0x1063=function(_0x52a53f,_0x476f53){_0x52a53f=_0x52a53f-0x114;let _0x334d89=_0x5a47d6[_0x52a53f];return _0x334d89;},a414_0x1063(_0x5e5e72,_0x400ea8);}a414_0x52a53f();'use strict';function a414_0x334d(){const _0x1b6191=['DeployService','design:returntype','23288010SgNikg','11nlTFDJ','metadata','./enums/status.enums','fs/promises','join','4wEGEgW','function','../../core','Version','501nixYsp','216409ZlQcDF','2581736BYutsE','deployFromBranch','AppResponseStatus','./utils/veeva-request.utils','createSalesforceRequest','length','then','rollback','DependencyService','deploy','body','v1.1','BaseVeevaError','SUCCESS','constructor','VeevaAuth','default','toString','getAuthDetails','snapshot','RollbackService','makeDir','decorate','apply','./services/deploy.service','./classes/errors/base-veeva-error','34225fdgTXU','./services/snapshot.service','__metadata','SalesforceAuth','./classes/loggers/logger','Logger','getOwnPropertyDescriptor','message','design:paramtypes','706rhUMkw','search','FAILURE','./classes/auth/salesforce-auth','(((.+)+)+)+$','__param','Post','prototype','14jcNydC','2201985QPndVS','./classes/auth/veeva-auth','execute','__decorate','shortid','instanceUrl','param','doSnapshot','temp/veeva/rollback_','__importDefault','SnapshotService','veeva-vault','./services/rollback.service','./services/dependency.service','defineProperty','retrieveDependency','__esModule','createVeevaRequest','VeevaVaultController','getMessages','4472796dwqsWO','object','design:type'];a414_0x334d=function(){return _0x1b6191;};return a414_0x334d();}var __decorate=this&&this[a414_0xcc20cf(0x15c)]||function(_0x1e8095,_0x5f5b16,_0x29a19f,_0x4c37ba){const _0x59c33e=a414_0xcc20cf;var _0x3f0791=arguments['length'],_0x20140c=_0x3f0791<0x3?_0x5f5b16:_0x4c37ba===null?_0x4c37ba=Object[_0x59c33e(0x14d)](_0x5f5b16,_0x29a19f):_0x4c37ba,_0x4c038c;if(typeof Reflect===_0x59c33e(0x11d)&&typeof Reflect[_0x59c33e(0x143)]===_0x59c33e(0x128))_0x20140c=Reflect[_0x59c33e(0x143)](_0x1e8095,_0x5f5b16,_0x29a19f,_0x4c37ba);else{for(var _0x146a58=_0x1e8095[_0x59c33e(0x132)]-0x1;_0x146a58>=0x0;_0x146a58--)if(_0x4c038c=_0x1e8095[_0x146a58])_0x20140c=(_0x3f0791<0x3?_0x4c038c(_0x20140c):_0x3f0791>0x3?_0x4c038c(_0x5f5b16,_0x29a19f,_0x20140c):_0x4c038c(_0x5f5b16,_0x29a19f))||_0x20140c;}return _0x3f0791>0x3&&_0x20140c&&Object[_0x59c33e(0x116)](_0x5f5b16,_0x29a19f,_0x20140c),_0x20140c;},__metadata=this&&this[a414_0xcc20cf(0x149)]||function(_0xae8104,_0x57a71b){const _0x3186f9=a414_0xcc20cf;if(typeof Reflect===_0x3186f9(0x11d)&&typeof Reflect['metadata']===_0x3186f9(0x128))return Reflect[_0x3186f9(0x123)](_0xae8104,_0x57a71b);},__param=this&&this[a414_0xcc20cf(0x155)]||function(_0x180734,_0x53b49a){return function(_0x2a5ef9,_0x2465ef){_0x53b49a(_0x2a5ef9,_0x2465ef,_0x180734);};},__importDefault=this&&this[a414_0xcc20cf(0x162)]||function(_0x43f3c3){const _0x19e6f4=a414_0xcc20cf;return _0x43f3c3&&_0x43f3c3[_0x19e6f4(0x118)]?_0x43f3c3:{'default':_0x43f3c3};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['VeevaVaultController']=void 0x0;const core_1=require(a414_0xcc20cf(0x129)),dependency_service_1=require(a414_0xcc20cf(0x115)),snapshot_service_1=require(a414_0xcc20cf(0x148)),deploy_service_1=require(a414_0xcc20cf(0x145)),veeva_request_utils_1=require(a414_0xcc20cf(0x130)),status_enums_1=require(a414_0xcc20cf(0x124)),shortid_1=__importDefault(require(a414_0xcc20cf(0x15d))),fs_util_1=require('./utils/fs-util'),logger_1=require(a414_0xcc20cf(0x14b)),promises_1=require(a414_0xcc20cf(0x125)),base_veeva_error_1=require(a414_0xcc20cf(0x146)),salesforce_request_utils_1=require('./utils/salesforce-request.utils'),veeva_auth_1=require(a414_0xcc20cf(0x15a)),salesforce_auth_1=require(a414_0xcc20cf(0x153)),rollback_service_1=require(a414_0xcc20cf(0x114)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a414_0xcc20cf(0x160)](_0x4299b0){const _0x4fd3a7=a414_0xcc20cf,{veevaAuth:_0x5cbe08,timeZone:_0x5f5162,attachmentLogId:_0x53231c}=_0x4299b0;try{const _0xe995f2=(0x0,veeva_request_utils_1[_0x4fd3a7(0x119)])(new veeva_auth_1[(_0x4fd3a7(0x13c))](_0x5cbe08,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x6b6a31=await salesforce_auth_1['SalesforceAuth'][_0x4fd3a7(0x13f)](),_0x59b8e4=(0x0,salesforce_request_utils_1[_0x4fd3a7(0x131)])(new salesforce_auth_1[(_0x4fd3a7(0x14a))](_0x6b6a31)),_0x1cc51b=new logger_1[(_0x4fd3a7(0x14c))](_0x59b8e4,_0x5f5162,_0x53231c),_0x18166f=new snapshot_service_1[(_0x4fd3a7(0x163))](_0x4299b0,_0x59b8e4,_0xe995f2,_0x1cc51b);return _0x18166f['execute']()[_0x4fd3a7(0x133)](),{'responseStatus':status_enums_1[_0x4fd3a7(0x12f)]['SUCCESS']};}catch(_0x159f17){return{'responseStatus':status_enums_1[_0x4fd3a7(0x12f)][_0x4fd3a7(0x152)],'responseMessage':_0x159f17[_0x4fd3a7(0x14e)]};}}async[a414_0xcc20cf(0x12e)](_0xe262bd){const _0x3581c7=a414_0xcc20cf,{veevaAuth:_0x570a64,timeZone:_0x1a7aa5,attachmentLogId:_0x328d7f}=_0xe262bd;try{const _0x2240ed=(0x0,veeva_request_utils_1[_0x3581c7(0x119)])(new veeva_auth_1['VeevaAuth'](_0x570a64,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x25b963=await salesforce_auth_1[_0x3581c7(0x14a)][_0x3581c7(0x13f)](),_0x35034c=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1['SalesforceAuth'](_0x25b963)),_0x16fd61=new logger_1[(_0x3581c7(0x14c))](_0x35034c,_0x1a7aa5,_0x328d7f),_0x1daa51='temp/veeva/deploy_'+(0x0,shortid_1[_0x3581c7(0x13d)])();await(0x0,fs_util_1[_0x3581c7(0x142)])(_0x1daa51);const _0xb7a2e2=new deploy_service_1[(_0x3581c7(0x11f))](_0xe262bd,_0x35034c,_0x2240ed,_0x16fd61,_0x1daa51,_0x25b963[_0x3581c7(0x15e)]);return _0xb7a2e2['execute']()['finally'](()=>(0x0,promises_1['rm'])(_0x1daa51,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x3581c7(0x12f)][_0x3581c7(0x13a)]};}catch(_0x2f719b){return{'responseStatus':status_enums_1[_0x3581c7(0x12f)][_0x3581c7(0x152)],'responseMessage':_0x2f719b['message']};}}async[a414_0xcc20cf(0x117)](_0x3e540d){const _0x1728e2=a414_0xcc20cf,{veevaAuth:_0x230aff}=_0x3e540d;try{const _0x340606=(0x0,veeva_request_utils_1[_0x1728e2(0x119)])(new veeva_auth_1[(_0x1728e2(0x13c))](_0x230aff)),_0x5be44b=await salesforce_auth_1['SalesforceAuth'][_0x1728e2(0x13f)](),_0x447980=(0x0,salesforce_request_utils_1[_0x1728e2(0x131)])(new salesforce_auth_1['SalesforceAuth'](_0x5be44b)),_0x3b13f3=new dependency_service_1[(_0x1728e2(0x135))](_0x3e540d,_0x447980,_0x340606);return await _0x3b13f3['execute']();}catch(_0x22d3f2){const _0x314024=_0x22d3f2 instanceof base_veeva_error_1[_0x1728e2(0x139)]?_0x22d3f2[_0x1728e2(0x11b)]()[_0x1728e2(0x126)]('\x0a'):_0x22d3f2[_0x1728e2(0x14e)];return{'responseStatus':status_enums_1[_0x1728e2(0x12f)][_0x1728e2(0x152)],'responseMessage':_0x314024};}}async[a414_0xcc20cf(0x134)](_0x2df1e4){const _0x5c6692=a414_0xcc20cf,{veevaAuth:_0xb5da7c,timeZone:_0x56393d,attachmentLogId:_0x63784c}=_0x2df1e4;try{const _0x1eaa2c=(0x0,veeva_request_utils_1[_0x5c6692(0x119)])(new veeva_auth_1[(_0x5c6692(0x13c))](_0xb5da7c,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x3a104b=await salesforce_auth_1['SalesforceAuth'][_0x5c6692(0x13f)](),_0x2fb26d=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1['SalesforceAuth'](_0x3a104b)),_0x4e895d=new logger_1['Logger'](_0x2fb26d,_0x56393d,_0x63784c),_0x476516=_0x5c6692(0x161)+(0x0,shortid_1[_0x5c6692(0x13d)])();await(0x0,fs_util_1[_0x5c6692(0x142)])(_0x476516);const _0x1fd9e7=new rollback_service_1[(_0x5c6692(0x141))]({..._0x2df1e4,'connectionVeeva':_0x1eaa2c,'connectionSalesforce':_0x2fb26d,'logger':_0x4e895d,'tempFolder':_0x476516,'instanceUrl':_0x3a104b[_0x5c6692(0x15e)]});return _0x1fd9e7[_0x5c6692(0x15b)]()['finally'](()=>(0x0,promises_1['rm'])(_0x476516,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x5c6692(0x12f)][_0x5c6692(0x13a)]};}catch(_0x30bf40){return{'responseStatus':status_enums_1[_0x5c6692(0x12f)][_0x5c6692(0x152)],'responseMessage':_0x30bf40[_0x5c6692(0x14e)]};}}};__decorate([(0x0,core_1[a414_0xcc20cf(0x156)])(a414_0xcc20cf(0x140)),__param(0x0,core_1[a414_0xcc20cf(0x15f)][a414_0xcc20cf(0x137)]()),__metadata(a414_0xcc20cf(0x11e),Function),__metadata(a414_0xcc20cf(0x14f),[Object]),__metadata(a414_0xcc20cf(0x120),Promise)],VeevaVaultController[a414_0xcc20cf(0x157)],a414_0xcc20cf(0x160),null),__decorate([(0x0,core_1['Post'])(a414_0xcc20cf(0x136)),__param(0x0,core_1[a414_0xcc20cf(0x15f)]['body']()),__metadata('design:type',Function),__metadata(a414_0xcc20cf(0x14f),[Object]),__metadata(a414_0xcc20cf(0x120),Promise)],VeevaVaultController[a414_0xcc20cf(0x157)],a414_0xcc20cf(0x12e),null),__decorate([(0x0,core_1[a414_0xcc20cf(0x156)])('dependency'),__param(0x0,core_1[a414_0xcc20cf(0x15f)][a414_0xcc20cf(0x137)]()),__metadata(a414_0xcc20cf(0x11e),Function),__metadata(a414_0xcc20cf(0x14f),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a414_0xcc20cf(0x157)],a414_0xcc20cf(0x117),null),__decorate([(0x0,core_1[a414_0xcc20cf(0x156)])(a414_0xcc20cf(0x134)),__param(0x0,core_1[a414_0xcc20cf(0x15f)][a414_0xcc20cf(0x137)]()),__metadata(a414_0xcc20cf(0x11e),Function),__metadata(a414_0xcc20cf(0x14f),[Object]),__metadata(a414_0xcc20cf(0x120),Promise)],VeevaVaultController['prototype'],a414_0xcc20cf(0x134),null),VeevaVaultController=__decorate([(0x0,core_1['Controller'])(a414_0xcc20cf(0x164)),(0x0,core_1[a414_0xcc20cf(0x12a)])(a414_0xcc20cf(0x138))],VeevaVaultController),exports[a414_0xcc20cf(0x11a)]=VeevaVaultController;