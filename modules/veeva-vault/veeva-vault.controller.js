function a415_0x4835(){const _0x348d6b=['99430sPWJaQ','doSnapshot','VeevaVaultController','SnapshotService','object','toString','temp/veeva/deploy_','./enums/status.enums','RollbackService','Logger','execute','design:paramtypes','FAILURE','SalesforceAuth','createVeevaRequest','rollback','getOwnPropertyDescriptor','DeployService','./utils/salesforce-request.utils','body','VeevaAuth','9aDbGLr','finally','4fREYbX','then','3726670WsLCxG','default','design:returntype','getAuthDetails','createSalesforceRequest','Version','param','./services/snapshot.service','__param','6145Hmvjrz','622956ltrnFO','apply','message','dependency','678DgRlvG','../../core','shortid','retrieveDependency','./classes/auth/salesforce-auth','__metadata','instanceUrl','function','length','metadata','deployFromBranch','makeDir','1051400zdytzW','BaseVeevaError','__esModule','search','defineProperty','SUCCESS','120650LzeECH','Controller','DependencyService','1049398lvdTnO','(((.+)+)+)+$','snapshot','Post','design:type','AppResponseStatus','getMessages','./classes/auth/veeva-auth','veeva-vault','v1.1','./services/dependency.service','./utils/veeva-request.utils','./classes/errors/base-veeva-error','__decorate','prototype','__importDefault'];a415_0x4835=function(){return _0x348d6b;};return a415_0x4835();}const a415_0x262c49=a415_0x4706;(function(_0x1c7aa1,_0xda9a51){const _0x30ec5c=a415_0x4706,_0x4421eb=_0x1c7aa1();while(!![]){try{const _0x1ec7af=parseInt(_0x30ec5c(0x147))/0x1+parseInt(_0x30ec5c(0x15a))/0x2+-parseInt(_0x30ec5c(0x131))/0x3*(-parseInt(_0x30ec5c(0x171))/0x4)+-parseInt(_0x30ec5c(0x130))/0x5*(-parseInt(_0x30ec5c(0x135))/0x6)+-parseInt(_0x30ec5c(0x14a))/0x7+parseInt(_0x30ec5c(0x141))/0x8+-parseInt(_0x30ec5c(0x16f))/0x9*(parseInt(_0x30ec5c(0x173))/0xa);if(_0x1ec7af===_0xda9a51)break;else _0x4421eb['push'](_0x4421eb['shift']());}catch(_0x19bfa5){_0x4421eb['push'](_0x4421eb['shift']());}}}(a415_0x4835,0x1eb2a));const a415_0x49bde9=(function(){let _0x315b5b=!![];return function(_0xbccfa1,_0x28d4fe){const _0x24573e=_0x315b5b?function(){const _0x354952=a415_0x4706;if(_0x28d4fe){const _0x4cab3a=_0x28d4fe[_0x354952(0x132)](_0xbccfa1,arguments);return _0x28d4fe=null,_0x4cab3a;}}:function(){};return _0x315b5b=![],_0x24573e;};}()),a415_0x1e2f83=a415_0x49bde9(this,function(){const _0x1cddfe=a415_0x4706;return a415_0x1e2f83[_0x1cddfe(0x15f)]()[_0x1cddfe(0x144)]('(((.+)+)+)+$')['toString']()['constructor'](a415_0x1e2f83)['search'](_0x1cddfe(0x14b));});a415_0x1e2f83();'use strict';var __decorate=this&&this[a415_0x262c49(0x157)]||function(_0x10ec2b,_0x1c7821,_0x30333a,_0x541994){const _0x4a6159=a415_0x262c49;var _0x5c4b07=arguments['length'],_0x1e52ff=_0x5c4b07<0x3?_0x1c7821:_0x541994===null?_0x541994=Object[_0x4a6159(0x16a)](_0x1c7821,_0x30333a):_0x541994,_0x4461e1;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x4a6159(0x13c))_0x1e52ff=Reflect['decorate'](_0x10ec2b,_0x1c7821,_0x30333a,_0x541994);else{for(var _0x46dff8=_0x10ec2b[_0x4a6159(0x13d)]-0x1;_0x46dff8>=0x0;_0x46dff8--)if(_0x4461e1=_0x10ec2b[_0x46dff8])_0x1e52ff=(_0x5c4b07<0x3?_0x4461e1(_0x1e52ff):_0x5c4b07>0x3?_0x4461e1(_0x1c7821,_0x30333a,_0x1e52ff):_0x4461e1(_0x1c7821,_0x30333a))||_0x1e52ff;}return _0x5c4b07>0x3&&_0x1e52ff&&Object['defineProperty'](_0x1c7821,_0x30333a,_0x1e52ff),_0x1e52ff;},__metadata=this&&this[a415_0x262c49(0x13a)]||function(_0x4c56cc,_0x4fe57a){const _0x1fc078=a415_0x262c49;if(typeof Reflect===_0x1fc078(0x15e)&&typeof Reflect['metadata']==='function')return Reflect[_0x1fc078(0x13e)](_0x4c56cc,_0x4fe57a);},__param=this&&this[a415_0x262c49(0x12f)]||function(_0x2bd7bc,_0x3fea2a){return function(_0x384b84,_0x3d49ef){_0x3fea2a(_0x384b84,_0x3d49ef,_0x2bd7bc);};},__importDefault=this&&this[a415_0x262c49(0x159)]||function(_0x316d33){const _0x5626a0=a415_0x262c49;return _0x316d33&&_0x316d33[_0x5626a0(0x143)]?_0x316d33:{'default':_0x316d33};};function a415_0x4706(_0x565bdf,_0x23f6e7){const _0x47d5a1=a415_0x4835();return a415_0x4706=function(_0x1e2f83,_0x49bde9){_0x1e2f83=_0x1e2f83-0x129;let _0x483523=_0x47d5a1[_0x1e2f83];return _0x483523;},a415_0x4706(_0x565bdf,_0x23f6e7);}Object[a415_0x262c49(0x145)](exports,a415_0x262c49(0x143),{'value':!![]}),exports[a415_0x262c49(0x15c)]=void 0x0;const core_1=require(a415_0x262c49(0x136)),dependency_service_1=require(a415_0x262c49(0x154)),snapshot_service_1=require(a415_0x262c49(0x12e)),deploy_service_1=require('./services/deploy.service'),veeva_request_utils_1=require(a415_0x262c49(0x155)),status_enums_1=require(a415_0x262c49(0x161)),shortid_1=__importDefault(require(a415_0x262c49(0x137))),fs_util_1=require('./utils/fs-util'),logger_1=require('./classes/loggers/logger'),promises_1=require('fs/promises'),base_veeva_error_1=require(a415_0x262c49(0x156)),salesforce_request_utils_1=require(a415_0x262c49(0x16c)),veeva_auth_1=require(a415_0x262c49(0x151)),salesforce_auth_1=require(a415_0x262c49(0x139)),rollback_service_1=require('./services/rollback.service'),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a415_0x262c49(0x15b)](_0x9e71a7){const _0xb8f48f=a415_0x262c49,{veevaAuth:_0x2d944d,timeZone:_0x4b1ad8,attachmentLogId:_0x24a71e}=_0x9e71a7;try{const _0x1926ea=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0xb8f48f(0x16e))](_0x2d944d,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x53bd36=await salesforce_auth_1['SalesforceAuth']['getAuthDetails'](),_0x3deaf3=(0x0,salesforce_request_utils_1[_0xb8f48f(0x12b)])(new salesforce_auth_1[(_0xb8f48f(0x167))](_0x53bd36)),_0x5597ee=new logger_1[(_0xb8f48f(0x163))](_0x3deaf3,_0x4b1ad8,_0x24a71e),_0x2d0052=new snapshot_service_1[(_0xb8f48f(0x15d))](_0x9e71a7,_0x3deaf3,_0x1926ea,_0x5597ee);return _0x2d0052['execute']()[_0xb8f48f(0x172)](),{'responseStatus':status_enums_1[_0xb8f48f(0x14f)][_0xb8f48f(0x146)]};}catch(_0x59d97e){return{'responseStatus':status_enums_1['AppResponseStatus'][_0xb8f48f(0x166)],'responseMessage':_0x59d97e[_0xb8f48f(0x133)]};}}async['deployFromBranch'](_0xdcaeda){const _0x118e98=a415_0x262c49,{veevaAuth:_0x219bad,timeZone:_0x3d1ff0,attachmentLogId:_0x42cf08}=_0xdcaeda;try{const _0x1f75a1=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x118e98(0x16e))](_0x219bad,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x22790e=await salesforce_auth_1[_0x118e98(0x167)]['getAuthDetails'](),_0x5df39c=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x118e98(0x167))](_0x22790e)),_0x574bb4=new logger_1['Logger'](_0x5df39c,_0x3d1ff0,_0x42cf08),_0x2fc6f1=_0x118e98(0x160)+(0x0,shortid_1[_0x118e98(0x174)])();await(0x0,fs_util_1[_0x118e98(0x140)])(_0x2fc6f1);const _0x3f0272=new deploy_service_1[(_0x118e98(0x16b))](_0xdcaeda,_0x5df39c,_0x1f75a1,_0x574bb4,_0x2fc6f1,_0x22790e[_0x118e98(0x13b)]);return _0x3f0272[_0x118e98(0x164)]()[_0x118e98(0x170)](()=>(0x0,promises_1['rm'])(_0x2fc6f1,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x118e98(0x14f)][_0x118e98(0x146)]};}catch(_0x36ac25){return{'responseStatus':status_enums_1[_0x118e98(0x14f)][_0x118e98(0x166)],'responseMessage':_0x36ac25[_0x118e98(0x133)]};}}async[a415_0x262c49(0x138)](_0x3ad4d2){const _0x55c151=a415_0x262c49,{veevaAuth:_0x4a049}=_0x3ad4d2;try{const _0x30065a=(0x0,veeva_request_utils_1[_0x55c151(0x168)])(new veeva_auth_1[(_0x55c151(0x16e))](_0x4a049)),_0x1b5593=await salesforce_auth_1[_0x55c151(0x167)][_0x55c151(0x12a)](),_0x56d209=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x55c151(0x167))](_0x1b5593)),_0x2cd277=new dependency_service_1[(_0x55c151(0x149))](_0x3ad4d2,_0x56d209,_0x30065a);return await _0x2cd277['execute']();}catch(_0x30a1b7){const _0x5a86e1=_0x30a1b7 instanceof base_veeva_error_1[_0x55c151(0x142)]?_0x30a1b7[_0x55c151(0x150)]()['join']('\x0a'):_0x30a1b7[_0x55c151(0x133)];return{'responseStatus':status_enums_1[_0x55c151(0x14f)][_0x55c151(0x166)],'responseMessage':_0x5a86e1};}}async[a415_0x262c49(0x169)](_0x776fb){const _0x373084=a415_0x262c49,{veevaAuth:_0xc96962,timeZone:_0x406c58,attachmentLogId:_0x392cc3}=_0x776fb;try{const _0x156948=(0x0,veeva_request_utils_1[_0x373084(0x168)])(new veeva_auth_1[(_0x373084(0x16e))](_0xc96962,JOB_UPDATE_TOKEN_ATTEMPTS)),_0xb6df93=await salesforce_auth_1[_0x373084(0x167)][_0x373084(0x12a)](),_0x1ddac4=(0x0,salesforce_request_utils_1[_0x373084(0x12b)])(new salesforce_auth_1[(_0x373084(0x167))](_0xb6df93)),_0x4b8ae0=new logger_1[(_0x373084(0x163))](_0x1ddac4,_0x406c58,_0x392cc3),_0x5f53ee='temp/veeva/rollback_'+(0x0,shortid_1[_0x373084(0x174)])();await(0x0,fs_util_1['makeDir'])(_0x5f53ee);const _0x5f19b7=new rollback_service_1[(_0x373084(0x162))]({..._0x776fb,'connectionVeeva':_0x156948,'connectionSalesforce':_0x1ddac4,'logger':_0x4b8ae0,'tempFolder':_0x5f53ee,'instanceUrl':_0xb6df93['instanceUrl']});return _0x5f19b7[_0x373084(0x164)]()[_0x373084(0x170)](()=>(0x0,promises_1['rm'])(_0x5f53ee,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x373084(0x14f)][_0x373084(0x146)]};}catch(_0x282eb0){return{'responseStatus':status_enums_1[_0x373084(0x14f)][_0x373084(0x166)],'responseMessage':_0x282eb0['message']};}}};__decorate([(0x0,core_1[a415_0x262c49(0x14d)])(a415_0x262c49(0x14c)),__param(0x0,core_1[a415_0x262c49(0x12d)][a415_0x262c49(0x16d)]()),__metadata(a415_0x262c49(0x14e),Function),__metadata(a415_0x262c49(0x165),[Object]),__metadata(a415_0x262c49(0x129),Promise)],VeevaVaultController[a415_0x262c49(0x158)],'doSnapshot',null),__decorate([(0x0,core_1[a415_0x262c49(0x14d)])('deploy'),__param(0x0,core_1['param'][a415_0x262c49(0x16d)]()),__metadata(a415_0x262c49(0x14e),Function),__metadata(a415_0x262c49(0x165),[Object]),__metadata(a415_0x262c49(0x129),Promise)],VeevaVaultController[a415_0x262c49(0x158)],a415_0x262c49(0x13f),null),__decorate([(0x0,core_1[a415_0x262c49(0x14d)])(a415_0x262c49(0x134)),__param(0x0,core_1[a415_0x262c49(0x12d)]['body']()),__metadata(a415_0x262c49(0x14e),Function),__metadata(a415_0x262c49(0x165),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a415_0x262c49(0x158)],a415_0x262c49(0x138),null),__decorate([(0x0,core_1[a415_0x262c49(0x14d)])(a415_0x262c49(0x169)),__param(0x0,core_1[a415_0x262c49(0x12d)][a415_0x262c49(0x16d)]()),__metadata(a415_0x262c49(0x14e),Function),__metadata(a415_0x262c49(0x165),[Object]),__metadata(a415_0x262c49(0x129),Promise)],VeevaVaultController[a415_0x262c49(0x158)],a415_0x262c49(0x169),null),VeevaVaultController=__decorate([(0x0,core_1[a415_0x262c49(0x148)])(a415_0x262c49(0x152)),(0x0,core_1[a415_0x262c49(0x12c)])(a415_0x262c49(0x153))],VeevaVaultController),exports[a415_0x262c49(0x15c)]=VeevaVaultController;