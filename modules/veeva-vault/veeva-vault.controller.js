const a370_0x49c890=a370_0x1772;(function(_0x7a02d3,_0x1d6247){const _0x823702=a370_0x1772,_0xa85654=_0x7a02d3();while(!![]){try{const _0xd5c528=parseInt(_0x823702(0xa0))/0x1*(parseInt(_0x823702(0xbd))/0x2)+-parseInt(_0x823702(0xb2))/0x3+parseInt(_0x823702(0x8a))/0x4+-parseInt(_0x823702(0xc3))/0x5+-parseInt(_0x823702(0xc6))/0x6+parseInt(_0x823702(0xb6))/0x7+-parseInt(_0x823702(0x9f))/0x8;if(_0xd5c528===_0x1d6247)break;else _0xa85654['push'](_0xa85654['shift']());}catch(_0xd29105){_0xa85654['push'](_0xa85654['shift']());}}}(a370_0x105e,0x7e635));const a370_0x381631=(function(){let _0x24954c=!![];return function(_0x5e4ec8,_0x3fd69f){const _0x5ed120=_0x24954c?function(){const _0x46fcdc=a370_0x1772;if(_0x3fd69f){const _0x34aea6=_0x3fd69f[_0x46fcdc(0xc2)](_0x5e4ec8,arguments);return _0x3fd69f=null,_0x34aea6;}}:function(){};return _0x24954c=![],_0x5ed120;};}()),a370_0x2755ee=a370_0x381631(this,function(){const _0x5b911a=a370_0x1772;return a370_0x2755ee[_0x5b911a(0x99)]()[_0x5b911a(0x92)](_0x5b911a(0x89))['toString']()[_0x5b911a(0xce)](a370_0x2755ee)['search'](_0x5b911a(0x89));});a370_0x2755ee();'use strict';var __decorate=this&&this[a370_0x49c890(0xba)]||function(_0x26b503,_0x24d0fd,_0x4c3c51,_0x48b73e){const _0x561146=a370_0x49c890;var _0x2f31e3=arguments[_0x561146(0x96)],_0x41a657=_0x2f31e3<0x3?_0x24d0fd:_0x48b73e===null?_0x48b73e=Object[_0x561146(0x9e)](_0x24d0fd,_0x4c3c51):_0x48b73e,_0x4e755d;if(typeof Reflect===_0x561146(0x8d)&&typeof Reflect['decorate']==='function')_0x41a657=Reflect[_0x561146(0xa9)](_0x26b503,_0x24d0fd,_0x4c3c51,_0x48b73e);else{for(var _0x34d014=_0x26b503[_0x561146(0x96)]-0x1;_0x34d014>=0x0;_0x34d014--)if(_0x4e755d=_0x26b503[_0x34d014])_0x41a657=(_0x2f31e3<0x3?_0x4e755d(_0x41a657):_0x2f31e3>0x3?_0x4e755d(_0x24d0fd,_0x4c3c51,_0x41a657):_0x4e755d(_0x24d0fd,_0x4c3c51))||_0x41a657;}return _0x2f31e3>0x3&&_0x41a657&&Object[_0x561146(0x90)](_0x24d0fd,_0x4c3c51,_0x41a657),_0x41a657;},__metadata=this&&this[a370_0x49c890(0xa7)]||function(_0x367d23,_0x5088c3){const _0x56bedf=a370_0x49c890;if(typeof Reflect===_0x56bedf(0x8d)&&typeof Reflect[_0x56bedf(0xa4)]===_0x56bedf(0xcf))return Reflect['metadata'](_0x367d23,_0x5088c3);},__param=this&&this[a370_0x49c890(0xa6)]||function(_0x10ce6b,_0x113249){return function(_0x4dba56,_0x4b04c9){_0x113249(_0x4dba56,_0x4b04c9,_0x10ce6b);};},__importDefault=this&&this[a370_0x49c890(0x9b)]||function(_0x141903){const _0x16e24d=a370_0x49c890;return _0x141903&&_0x141903[_0x16e24d(0xc8)]?_0x141903:{'default':_0x141903};};Object[a370_0x49c890(0x90)](exports,'__esModule',{'value':!![]}),exports[a370_0x49c890(0xa2)]=void 0x0;const core_1=require(a370_0x49c890(0x94)),dependency_service_1=require(a370_0x49c890(0xa1)),snapshot_service_1=require(a370_0x49c890(0xd0)),deploy_service_1=require(a370_0x49c890(0x9d)),veeva_request_utils_1=require(a370_0x49c890(0xbb)),status_enums_1=require(a370_0x49c890(0xac)),shortid_1=__importDefault(require(a370_0x49c890(0xca))),fs_util_1=require(a370_0x49c890(0x88)),logger_1=require('./classes/loggers/logger'),promises_1=require(a370_0x49c890(0xad)),base_veeva_error_1=require(a370_0x49c890(0xa8)),salesforce_request_utils_1=require(a370_0x49c890(0x91)),veeva_auth_1=require(a370_0x49c890(0xb9)),salesforce_auth_1=require(a370_0x49c890(0x8c)),rollback_service_1=require(a370_0x49c890(0xa5)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async['doSnapshot'](_0x139a92){const _0x8e32ff=a370_0x49c890,{veevaAuth:_0x4793f4,timeZone:_0x419770,attachmentLogId:_0x397c97}=_0x139a92;try{const _0x2f8435=(0x0,veeva_request_utils_1[_0x8e32ff(0xd1)])(new veeva_auth_1[(_0x8e32ff(0x93))](_0x4793f4,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x21339f=await salesforce_auth_1[_0x8e32ff(0xb4)][_0x8e32ff(0x87)](),_0x8ca90f=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x8e32ff(0xb4))](_0x21339f)),_0x141720=new logger_1[(_0x8e32ff(0xc1))](_0x8ca90f,_0x419770,_0x397c97),_0x2f928c=new snapshot_service_1[(_0x8e32ff(0xae))](_0x139a92,_0x8ca90f,_0x2f8435,_0x141720);return _0x2f928c[_0x8e32ff(0xb0)]()[_0x8e32ff(0xc5)](),{'responseStatus':status_enums_1[_0x8e32ff(0xc7)][_0x8e32ff(0x8f)]};}catch(_0xf1b80a){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x8e32ff(0xd2)],'responseMessage':_0xf1b80a[_0x8e32ff(0xd3)]};}}async[a370_0x49c890(0x86)](_0x3651d6){const _0x3ec269=a370_0x49c890,{veevaAuth:_0x46c738,timeZone:_0x386d38,attachmentLogId:_0x5b50a4}=_0x3651d6;try{const _0x3f59eb=(0x0,veeva_request_utils_1[_0x3ec269(0xd1)])(new veeva_auth_1[(_0x3ec269(0x93))](_0x46c738,JOB_UPDATE_TOKEN_ATTEMPTS)),_0xed7c30=await salesforce_auth_1[_0x3ec269(0xb4)][_0x3ec269(0x87)](),_0xd0454=(0x0,salesforce_request_utils_1[_0x3ec269(0xb1)])(new salesforce_auth_1[(_0x3ec269(0xb4))](_0xed7c30)),_0x482027=new logger_1['Logger'](_0xd0454,_0x386d38,_0x5b50a4),_0x24f78e=_0x3ec269(0x9a)+(0x0,shortid_1[_0x3ec269(0xa3)])();await(0x0,fs_util_1[_0x3ec269(0xbe)])(_0x24f78e);const _0x272a29=new deploy_service_1['DeployService'](_0x3651d6,_0xd0454,_0x3f59eb,_0x482027,_0x24f78e,_0xed7c30[_0x3ec269(0xbf)]);return _0x272a29[_0x3ec269(0xb0)]()[_0x3ec269(0xb5)](()=>(0x0,promises_1['rm'])(_0x24f78e,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x3ec269(0xc7)][_0x3ec269(0x8f)]};}catch(_0x13278c){return{'responseStatus':status_enums_1[_0x3ec269(0xc7)][_0x3ec269(0xd2)],'responseMessage':_0x13278c[_0x3ec269(0xd3)]};}}async[a370_0x49c890(0xc0)](_0x567f8c){const _0x21bc7e=a370_0x49c890,{veevaAuth:_0x4653d6}=_0x567f8c;try{const _0x484ef4=(0x0,veeva_request_utils_1[_0x21bc7e(0xd1)])(new veeva_auth_1[(_0x21bc7e(0x93))](_0x4653d6)),_0x49c52a=await salesforce_auth_1[_0x21bc7e(0xb4)][_0x21bc7e(0x87)](),_0x8fe89f=(0x0,salesforce_request_utils_1[_0x21bc7e(0xb1)])(new salesforce_auth_1[(_0x21bc7e(0xb4))](_0x49c52a)),_0xeb0d0d=new dependency_service_1[(_0x21bc7e(0x8e))](_0x567f8c,_0x8fe89f,_0x484ef4);return await _0xeb0d0d[_0x21bc7e(0xb0)]();}catch(_0x4674cf){const _0x2b71bd=_0x4674cf instanceof base_veeva_error_1[_0x21bc7e(0xab)]?_0x4674cf[_0x21bc7e(0xbc)]()['join']('\x0a'):_0x4674cf[_0x21bc7e(0xd3)];return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x2b71bd};}}async[a370_0x49c890(0x97)](_0x470b19){const _0xfbd34e=a370_0x49c890,{veevaAuth:_0x3f885f,timeZone:_0x236555,attachmentLogId:_0x4329d5}=_0x470b19;try{const _0x10522e=(0x0,veeva_request_utils_1[_0xfbd34e(0xd1)])(new veeva_auth_1[(_0xfbd34e(0x93))](_0x3f885f,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x57763d=await salesforce_auth_1[_0xfbd34e(0xb4)]['getAuthDetails'](),_0x2e9055=(0x0,salesforce_request_utils_1[_0xfbd34e(0xb1)])(new salesforce_auth_1[(_0xfbd34e(0xb4))](_0x57763d)),_0x38a2da=new logger_1['Logger'](_0x2e9055,_0x236555,_0x4329d5),_0x59d52d=_0xfbd34e(0xcb)+(0x0,shortid_1[_0xfbd34e(0xa3)])();await(0x0,fs_util_1[_0xfbd34e(0xbe)])(_0x59d52d);const _0x4fa30e=new rollback_service_1['RollbackService']({..._0x470b19,'connectionVeeva':_0x10522e,'connectionSalesforce':_0x2e9055,'logger':_0x38a2da,'tempFolder':_0x59d52d,'instanceUrl':_0x57763d['instanceUrl']});return _0x4fa30e['execute']()[_0xfbd34e(0xb5)](()=>(0x0,promises_1['rm'])(_0x59d52d,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0xfbd34e(0xc7)]['SUCCESS']};}catch(_0xbc892){return{'responseStatus':status_enums_1[_0xfbd34e(0xc7)][_0xfbd34e(0xd2)],'responseMessage':_0xbc892[_0xfbd34e(0xd3)]};}}};function a370_0x1772(_0x8a9059,_0x54043d){const _0x4bc75e=a370_0x105e();return a370_0x1772=function(_0x2755ee,_0x381631){_0x2755ee=_0x2755ee-0x86;let _0x105e7a=_0x4bc75e[_0x2755ee];return _0x105e7a;},a370_0x1772(_0x8a9059,_0x54043d);}__decorate([(0x0,core_1[a370_0x49c890(0xb3)])('snapshot'),__param(0x0,core_1[a370_0x49c890(0xb8)][a370_0x49c890(0x9c)]()),__metadata('design:type',Function),__metadata(a370_0x49c890(0x8b),[Object]),__metadata(a370_0x49c890(0xaf),Promise)],VeevaVaultController[a370_0x49c890(0xc9)],a370_0x49c890(0xc4),null),__decorate([(0x0,core_1[a370_0x49c890(0xb3)])('deploy'),__param(0x0,core_1[a370_0x49c890(0xb8)][a370_0x49c890(0x9c)]()),__metadata(a370_0x49c890(0xaa),Function),__metadata(a370_0x49c890(0x8b),[Object]),__metadata(a370_0x49c890(0xaf),Promise)],VeevaVaultController[a370_0x49c890(0xc9)],a370_0x49c890(0x86),null),__decorate([(0x0,core_1[a370_0x49c890(0xb3)])(a370_0x49c890(0xcd)),__param(0x0,core_1[a370_0x49c890(0xb8)]['body']()),__metadata('design:type',Function),__metadata(a370_0x49c890(0x8b),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a370_0x49c890(0xc9)],a370_0x49c890(0xc0),null),__decorate([(0x0,core_1['Post'])(a370_0x49c890(0x97)),__param(0x0,core_1[a370_0x49c890(0xb8)][a370_0x49c890(0x9c)]()),__metadata(a370_0x49c890(0xaa),Function),__metadata(a370_0x49c890(0x8b),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a370_0x49c890(0xc9)],a370_0x49c890(0x97),null),VeevaVaultController=__decorate([(0x0,core_1[a370_0x49c890(0xcc)])(a370_0x49c890(0x98)),(0x0,core_1[a370_0x49c890(0xb7)])(a370_0x49c890(0x95))],VeevaVaultController),exports[a370_0x49c890(0xa2)]=VeevaVaultController;function a370_0x105e(){const _0x2cc3a8=['./utils/veeva-request.utils','getMessages','773522BlEHhN','makeDir','instanceUrl','retrieveDependency','Logger','apply','407590zaAZrF','doSnapshot','then','4963380llABgK','AppResponseStatus','__esModule','prototype','shortid','temp/veeva/rollback_','Controller','dependency','constructor','function','./services/snapshot.service','createVeevaRequest','FAILURE','message','deployFromBranch','getAuthDetails','./utils/fs-util','(((.+)+)+)+$','3242744zutFOq','design:paramtypes','./classes/auth/salesforce-auth','object','DependencyService','SUCCESS','defineProperty','./utils/salesforce-request.utils','search','VeevaAuth','../../core','v1.1','length','rollback','veeva-vault','toString','temp/veeva/deploy_','__importDefault','body','./services/deploy.service','getOwnPropertyDescriptor','3354448UwocZh','2VrhKLx','./services/dependency.service','VeevaVaultController','default','metadata','./services/rollback.service','__param','__metadata','./classes/errors/base-veeva-error','decorate','design:type','BaseVeevaError','./enums/status.enums','fs/promises','SnapshotService','design:returntype','execute','createSalesforceRequest','1909371jtkbfP','Post','SalesforceAuth','finally','6285916bsenLZ','Version','param','./classes/auth/veeva-auth','__decorate'];a370_0x105e=function(){return _0x2cc3a8;};return a370_0x105e();}