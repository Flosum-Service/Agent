const a371_0x428bdb=a371_0x26d0;(function(_0x4ade9e,_0x1ae37b){const _0xa7d1f9=a371_0x26d0,_0x1fc11f=_0x4ade9e();while(!![]){try{const _0x4cd5de=parseInt(_0xa7d1f9(0x183))/0x1*(parseInt(_0xa7d1f9(0x17f))/0x2)+-parseInt(_0xa7d1f9(0x18f))/0x3+parseInt(_0xa7d1f9(0x152))/0x4+-parseInt(_0xa7d1f9(0x18a))/0x5*(-parseInt(_0xa7d1f9(0x185))/0x6)+-parseInt(_0xa7d1f9(0x181))/0x7*(parseInt(_0xa7d1f9(0x192))/0x8)+parseInt(_0xa7d1f9(0x146))/0x9*(parseInt(_0xa7d1f9(0x178))/0xa)+-parseInt(_0xa7d1f9(0x189))/0xb;if(_0x4cd5de===_0x1ae37b)break;else _0x1fc11f['push'](_0x1fc11f['shift']());}catch(_0x588c67){_0x1fc11f['push'](_0x1fc11f['shift']());}}}(a371_0x2751,0x459cd));const a371_0x9a1bde=(function(){let _0x7251c7=!![];return function(_0x9c7f4,_0x399c8d){const _0x267b0c=_0x7251c7?function(){const _0x573fec=a371_0x26d0;if(_0x399c8d){const _0x159251=_0x399c8d[_0x573fec(0x14d)](_0x9c7f4,arguments);return _0x399c8d=null,_0x159251;}}:function(){};return _0x7251c7=![],_0x267b0c;};}()),a371_0x9a58bc=a371_0x9a1bde(this,function(){const _0x565e8d=a371_0x26d0;return a371_0x9a58bc['toString']()[_0x565e8d(0x15c)]('(((.+)+)+)+$')[_0x565e8d(0x151)]()[_0x565e8d(0x154)](a371_0x9a58bc)['search'](_0x565e8d(0x16d));});a371_0x9a58bc();'use strict';var __decorate=this&&this['__decorate']||function(_0x4253c9,_0x383b94,_0x185c96,_0x25eb9b){const _0x328f26=a371_0x26d0;var _0x798da5=arguments[_0x328f26(0x187)],_0x5be151=_0x798da5<0x3?_0x383b94:_0x25eb9b===null?_0x25eb9b=Object[_0x328f26(0x15f)](_0x383b94,_0x185c96):_0x25eb9b,_0x155a89;if(typeof Reflect===_0x328f26(0x180)&&typeof Reflect[_0x328f26(0x18e)]===_0x328f26(0x149))_0x5be151=Reflect[_0x328f26(0x18e)](_0x4253c9,_0x383b94,_0x185c96,_0x25eb9b);else{for(var _0x4367b2=_0x4253c9['length']-0x1;_0x4367b2>=0x0;_0x4367b2--)if(_0x155a89=_0x4253c9[_0x4367b2])_0x5be151=(_0x798da5<0x3?_0x155a89(_0x5be151):_0x798da5>0x3?_0x155a89(_0x383b94,_0x185c96,_0x5be151):_0x155a89(_0x383b94,_0x185c96))||_0x5be151;}return _0x798da5>0x3&&_0x5be151&&Object[_0x328f26(0x186)](_0x383b94,_0x185c96,_0x5be151),_0x5be151;},__metadata=this&&this[a371_0x428bdb(0x184)]||function(_0x3350f9,_0x313930){const _0x4e8eef=a371_0x428bdb;if(typeof Reflect===_0x4e8eef(0x180)&&typeof Reflect[_0x4e8eef(0x15a)]==='function')return Reflect['metadata'](_0x3350f9,_0x313930);},__param=this&&this[a371_0x428bdb(0x16f)]||function(_0x56e150,_0x949766){return function(_0x49dd7d,_0x4a8f40){_0x949766(_0x49dd7d,_0x4a8f40,_0x56e150);};},__importDefault=this&&this[a371_0x428bdb(0x18c)]||function(_0x18b062){const _0x3b3c08=a371_0x428bdb;return _0x18b062&&_0x18b062[_0x3b3c08(0x153)]?_0x18b062:{'default':_0x18b062};};Object[a371_0x428bdb(0x186)](exports,a371_0x428bdb(0x153),{'value':!![]}),exports[a371_0x428bdb(0x190)]=void 0x0;const core_1=require(a371_0x428bdb(0x17b)),dependency_service_1=require('./services/dependency.service'),snapshot_service_1=require('./services/snapshot.service'),deploy_service_1=require(a371_0x428bdb(0x158)),veeva_request_utils_1=require(a371_0x428bdb(0x14a)),status_enums_1=require('./enums/status.enums'),shortid_1=__importDefault(require(a371_0x428bdb(0x156))),fs_util_1=require(a371_0x428bdb(0x150)),logger_1=require('./classes/loggers/logger'),promises_1=require(a371_0x428bdb(0x148)),base_veeva_error_1=require(a371_0x428bdb(0x16c)),salesforce_request_utils_1=require(a371_0x428bdb(0x17e)),veeva_auth_1=require(a371_0x428bdb(0x155)),salesforce_auth_1=require(a371_0x428bdb(0x166)),rollback_service_1=require(a371_0x428bdb(0x15e)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;function a371_0x26d0(_0x34c872,_0x5a962a){const _0x1fe7af=a371_0x2751();return a371_0x26d0=function(_0x9a58bc,_0x9a1bde){_0x9a58bc=_0x9a58bc-0x146;let _0x275146=_0x1fe7af[_0x9a58bc];return _0x275146;},a371_0x26d0(_0x34c872,_0x5a962a);}let VeevaVaultController=class VeevaVaultController{async['doSnapshot'](_0x41e8b5){const _0x9d5759=a371_0x428bdb,{veevaAuth:_0x448a26,timeZone:_0x22dafe,attachmentLogId:_0xcef2a9}=_0x41e8b5;try{const _0x4b079c=(0x0,veeva_request_utils_1[_0x9d5759(0x15b)])(new veeva_auth_1[(_0x9d5759(0x179))](_0x448a26,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x65346d=await salesforce_auth_1[_0x9d5759(0x169)][_0x9d5759(0x165)](),_0x1fb5bf=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1['SalesforceAuth'](_0x65346d)),_0x404ccf=new logger_1[(_0x9d5759(0x160))](_0x1fb5bf,_0x22dafe,_0xcef2a9),_0x536f5d=new snapshot_service_1[(_0x9d5759(0x168))](_0x41e8b5,_0x1fb5bf,_0x4b079c,_0x404ccf);return _0x536f5d[_0x9d5759(0x16a)]()[_0x9d5759(0x147)](),{'responseStatus':status_enums_1[_0x9d5759(0x18b)]['SUCCESS']};}catch(_0x2e13a0){return{'responseStatus':status_enums_1[_0x9d5759(0x18b)][_0x9d5759(0x14f)],'responseMessage':_0x2e13a0[_0x9d5759(0x17d)]};}}async['deployFromBranch'](_0x3fa421){const _0x4f2a16=a371_0x428bdb,{veevaAuth:_0x1640c5,timeZone:_0x324d5f,attachmentLogId:_0x1edfe3}=_0x3fa421;try{const _0x24897f=(0x0,veeva_request_utils_1[_0x4f2a16(0x15b)])(new veeva_auth_1[(_0x4f2a16(0x179))](_0x1640c5,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x13d2e8=await salesforce_auth_1[_0x4f2a16(0x169)][_0x4f2a16(0x165)](),_0x263587=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1['SalesforceAuth'](_0x13d2e8)),_0x352fbe=new logger_1[(_0x4f2a16(0x160))](_0x263587,_0x324d5f,_0x1edfe3),_0x4e4489='temp/veeva/deploy_'+(0x0,shortid_1[_0x4f2a16(0x175)])();await(0x0,fs_util_1[_0x4f2a16(0x171)])(_0x4e4489);const _0x5ece23=new deploy_service_1[(_0x4f2a16(0x16e))](_0x3fa421,_0x263587,_0x24897f,_0x352fbe,_0x4e4489,_0x13d2e8['instanceUrl']);return _0x5ece23[_0x4f2a16(0x16a)]()['finally'](()=>(0x0,promises_1['rm'])(_0x4e4489,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x4f2a16(0x18b)][_0x4f2a16(0x17c)]};}catch(_0x34118d){return{'responseStatus':status_enums_1[_0x4f2a16(0x18b)][_0x4f2a16(0x14f)],'responseMessage':_0x34118d[_0x4f2a16(0x17d)]};}}async['retrieveDependency'](_0x336bc2){const _0x5dc68c=a371_0x428bdb,{veevaAuth:_0x1692a2}=_0x336bc2;try{const _0x4b848b=(0x0,veeva_request_utils_1[_0x5dc68c(0x15b)])(new veeva_auth_1[(_0x5dc68c(0x179))](_0x1692a2)),_0x5479dd=await salesforce_auth_1[_0x5dc68c(0x169)][_0x5dc68c(0x165)](),_0x8e99a2=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x5dc68c(0x169))](_0x5479dd)),_0x20e74d=new dependency_service_1[(_0x5dc68c(0x174))](_0x336bc2,_0x8e99a2,_0x4b848b);return await _0x20e74d[_0x5dc68c(0x16a)]();}catch(_0x3d5ca5){const _0x1b65f1=_0x3d5ca5 instanceof base_veeva_error_1[_0x5dc68c(0x167)]?_0x3d5ca5[_0x5dc68c(0x188)]()[_0x5dc68c(0x15d)]('\x0a'):_0x3d5ca5[_0x5dc68c(0x17d)];return{'responseStatus':status_enums_1[_0x5dc68c(0x18b)][_0x5dc68c(0x14f)],'responseMessage':_0x1b65f1};}}async[a371_0x428bdb(0x176)](_0x42b04e){const _0x4bd818=a371_0x428bdb,{veevaAuth:_0x565916,timeZone:_0x3b8c4f,attachmentLogId:_0x4dc11d}=_0x42b04e;try{const _0x4b56d5=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x4bd818(0x179))](_0x565916,JOB_UPDATE_TOKEN_ATTEMPTS)),_0xd54bb=await salesforce_auth_1[_0x4bd818(0x169)][_0x4bd818(0x165)](),_0x459f5a=(0x0,salesforce_request_utils_1[_0x4bd818(0x193)])(new salesforce_auth_1[(_0x4bd818(0x169))](_0xd54bb)),_0x38586c=new logger_1['Logger'](_0x459f5a,_0x3b8c4f,_0x4dc11d),_0x5b7ece=_0x4bd818(0x170)+(0x0,shortid_1[_0x4bd818(0x175)])();await(0x0,fs_util_1[_0x4bd818(0x171)])(_0x5b7ece);const _0x54fa94=new rollback_service_1['RollbackService']({..._0x42b04e,'connectionVeeva':_0x4b56d5,'connectionSalesforce':_0x459f5a,'logger':_0x38586c,'tempFolder':_0x5b7ece,'instanceUrl':_0xd54bb[_0x4bd818(0x191)]});return _0x54fa94['execute']()['finally'](()=>(0x0,promises_1['rm'])(_0x5b7ece,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x4bd818(0x18b)][_0x4bd818(0x17c)]};}catch(_0x2fddad){return{'responseStatus':status_enums_1[_0x4bd818(0x18b)][_0x4bd818(0x14f)],'responseMessage':_0x2fddad[_0x4bd818(0x17d)]};}}};function a371_0x2751(){const _0x1082f3=['doSnapshot','design:paramtypes','getAuthDetails','./classes/auth/salesforce-auth','BaseVeevaError','SnapshotService','SalesforceAuth','execute','deploy','./classes/errors/base-veeva-error','(((.+)+)+)+$','DeployService','__param','temp/veeva/rollback_','makeDir','veeva-vault','v1.1','DependencyService','default','rollback','deployFromBranch','10eBLPLZ','VeevaAuth','body','../../core','SUCCESS','message','./utils/salesforce-request.utils','237662fnlBLX','object','175IGOanv','design:returntype','4XBAZZW','__metadata','102TOFAyY','defineProperty','length','getMessages','1850178ZUYpJv','64505jEsMrX','AppResponseStatus','__importDefault','retrieveDependency','decorate','1332858uabRWD','VeevaVaultController','instanceUrl','109464rKMCIY','createSalesforceRequest','4770621cZUppo','then','fs/promises','function','./utils/veeva-request.utils','design:type','Post','apply','param','FAILURE','./utils/fs-util','toString','59928ZjTcft','__esModule','constructor','./classes/auth/veeva-auth','shortid','prototype','./services/deploy.service','Controller','metadata','createVeevaRequest','search','join','./services/rollback.service','getOwnPropertyDescriptor','Logger','snapshot','dependency'];a371_0x2751=function(){return _0x1082f3;};return a371_0x2751();}__decorate([(0x0,core_1['Post'])(a371_0x428bdb(0x161)),__param(0x0,core_1[a371_0x428bdb(0x14e)][a371_0x428bdb(0x17a)]()),__metadata(a371_0x428bdb(0x14b),Function),__metadata(a371_0x428bdb(0x164),[Object]),__metadata(a371_0x428bdb(0x182),Promise)],VeevaVaultController['prototype'],a371_0x428bdb(0x163),null),__decorate([(0x0,core_1[a371_0x428bdb(0x14c)])(a371_0x428bdb(0x16b)),__param(0x0,core_1[a371_0x428bdb(0x14e)][a371_0x428bdb(0x17a)]()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(a371_0x428bdb(0x182),Promise)],VeevaVaultController[a371_0x428bdb(0x157)],a371_0x428bdb(0x177),null),__decorate([(0x0,core_1[a371_0x428bdb(0x14c)])(a371_0x428bdb(0x162)),__param(0x0,core_1[a371_0x428bdb(0x14e)][a371_0x428bdb(0x17a)]()),__metadata('design:type',Function),__metadata(a371_0x428bdb(0x164),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController['prototype'],a371_0x428bdb(0x18d),null),__decorate([(0x0,core_1[a371_0x428bdb(0x14c)])(a371_0x428bdb(0x176)),__param(0x0,core_1[a371_0x428bdb(0x14e)][a371_0x428bdb(0x17a)]()),__metadata(a371_0x428bdb(0x14b),Function),__metadata(a371_0x428bdb(0x164),[Object]),__metadata(a371_0x428bdb(0x182),Promise)],VeevaVaultController[a371_0x428bdb(0x157)],a371_0x428bdb(0x176),null),VeevaVaultController=__decorate([(0x0,core_1[a371_0x428bdb(0x159)])(a371_0x428bdb(0x172)),(0x0,core_1['Version'])(a371_0x428bdb(0x173))],VeevaVaultController),exports[a371_0x428bdb(0x190)]=VeevaVaultController;