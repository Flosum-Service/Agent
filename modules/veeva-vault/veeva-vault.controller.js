const a370_0x5812cb=a370_0x1031;(function(_0x48afa5,_0x3dd033){const _0x48fd7f=a370_0x1031,_0x16cc85=_0x48afa5();while(!![]){try{const _0x1c8bca=parseInt(_0x48fd7f(0x202))/0x1*(parseInt(_0x48fd7f(0x1ea))/0x2)+parseInt(_0x48fd7f(0x214))/0x3+-parseInt(_0x48fd7f(0x1d7))/0x4*(parseInt(_0x48fd7f(0x1ee))/0x5)+parseInt(_0x48fd7f(0x1d9))/0x6*(parseInt(_0x48fd7f(0x20f))/0x7)+parseInt(_0x48fd7f(0x210))/0x8+-parseInt(_0x48fd7f(0x1d6))/0x9*(-parseInt(_0x48fd7f(0x20c))/0xa)+-parseInt(_0x48fd7f(0x1fa))/0xb;if(_0x1c8bca===_0x3dd033)break;else _0x16cc85['push'](_0x16cc85['shift']());}catch(_0x4028c7){_0x16cc85['push'](_0x16cc85['shift']());}}}(a370_0x4fd9,0x41dc3));const a370_0x4d3469=(function(){let _0x1946d0=!![];return function(_0x28d4e7,_0x14f1dd){const _0xb9e435=_0x1946d0?function(){const _0x457831=a370_0x1031;if(_0x14f1dd){const _0x395cf7=_0x14f1dd[_0x457831(0x207)](_0x28d4e7,arguments);return _0x14f1dd=null,_0x395cf7;}}:function(){};return _0x1946d0=![],_0xb9e435;};}()),a370_0x4b5f79=a370_0x4d3469(this,function(){const _0x11263c=a370_0x1031;return a370_0x4b5f79[_0x11263c(0x1f6)]()[_0x11263c(0x1f8)](_0x11263c(0x1e0))[_0x11263c(0x1f6)]()[_0x11263c(0x1f5)](a370_0x4b5f79)['search'](_0x11263c(0x1e0));});a370_0x4b5f79();'use strict';function a370_0x1031(_0x2649ef,_0x1a7b60){const _0x3eb47b=a370_0x4fd9();return a370_0x1031=function(_0x4b5f79,_0x4d3469){_0x4b5f79=_0x4b5f79-0x1d5;let _0x4fd9e6=_0x3eb47b[_0x4b5f79];return _0x4fd9e6;},a370_0x1031(_0x2649ef,_0x1a7b60);}var __decorate=this&&this[a370_0x5812cb(0x21e)]||function(_0xb031e3,_0x297b44,_0x121c43,_0x947944){const _0x573d04=a370_0x5812cb;var _0x39e70d=arguments[_0x573d04(0x1e6)],_0x4947c5=_0x39e70d<0x3?_0x297b44:_0x947944===null?_0x947944=Object[_0x573d04(0x20d)](_0x297b44,_0x121c43):_0x947944,_0x2cd5e7;if(typeof Reflect===_0x573d04(0x208)&&typeof Reflect[_0x573d04(0x1e7)]===_0x573d04(0x221))_0x4947c5=Reflect[_0x573d04(0x1e7)](_0xb031e3,_0x297b44,_0x121c43,_0x947944);else{for(var _0x479062=_0xb031e3['length']-0x1;_0x479062>=0x0;_0x479062--)if(_0x2cd5e7=_0xb031e3[_0x479062])_0x4947c5=(_0x39e70d<0x3?_0x2cd5e7(_0x4947c5):_0x39e70d>0x3?_0x2cd5e7(_0x297b44,_0x121c43,_0x4947c5):_0x2cd5e7(_0x297b44,_0x121c43))||_0x4947c5;}return _0x39e70d>0x3&&_0x4947c5&&Object['defineProperty'](_0x297b44,_0x121c43,_0x4947c5),_0x4947c5;},__metadata=this&&this[a370_0x5812cb(0x1f4)]||function(_0x37ea22,_0x230071){const _0x2e3fcc=a370_0x5812cb;if(typeof Reflect===_0x2e3fcc(0x208)&&typeof Reflect[_0x2e3fcc(0x1df)]===_0x2e3fcc(0x221))return Reflect['metadata'](_0x37ea22,_0x230071);},__param=this&&this[a370_0x5812cb(0x203)]||function(_0x1d6394,_0xc8a8f6){return function(_0x1546ca,_0x2a955d){_0xc8a8f6(_0x1546ca,_0x2a955d,_0x1d6394);};},__importDefault=this&&this['__importDefault']||function(_0xed4835){const _0x107482=a370_0x5812cb;return _0xed4835&&_0xed4835[_0x107482(0x1f7)]?_0xed4835:{'default':_0xed4835};};Object[a370_0x5812cb(0x1f3)](exports,a370_0x5812cb(0x1f7),{'value':!![]}),exports[a370_0x5812cb(0x220)]=void 0x0;const core_1=require(a370_0x5812cb(0x20e)),dependency_service_1=require(a370_0x5812cb(0x1e9)),snapshot_service_1=require(a370_0x5812cb(0x1eb)),deploy_service_1=require(a370_0x5812cb(0x1fd)),veeva_request_utils_1=require('./utils/veeva-request.utils'),status_enums_1=require(a370_0x5812cb(0x21b)),shortid_1=__importDefault(require(a370_0x5812cb(0x20a))),fs_util_1=require(a370_0x5812cb(0x1e5)),logger_1=require('./classes/loggers/logger'),promises_1=require(a370_0x5812cb(0x21a)),base_veeva_error_1=require(a370_0x5812cb(0x1dd)),salesforce_request_utils_1=require(a370_0x5812cb(0x206)),veeva_auth_1=require(a370_0x5812cb(0x1ed)),salesforce_auth_1=require('./classes/auth/salesforce-auth'),rollback_service_1=require(a370_0x5812cb(0x1e8)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;function a370_0x4fd9(){const _0x51629e=['34FeHxHg','./services/snapshot.service','Version','./classes/auth/veeva-auth','2490uXLRuu','createSalesforceRequest','then','instanceUrl','temp/veeva/deploy_','defineProperty','__metadata','constructor','toString','__esModule','search','message','5099710TxEhzM','retrieveDependency','DeployService','./services/deploy.service','default','Logger','SalesforceAuth','design:type','16275VRlbqx','__param','BaseVeevaError','dependency','./utils/salesforce-request.utils','apply','object','FAILURE','shortid','SUCCESS','420urHfXb','getOwnPropertyDescriptor','../../core','284452BvOOvn','1711968swngce','deployFromBranch','doSnapshot','param','332736AQycvD','getAuthDetails','rollback','design:paramtypes','execute','veeva-vault','fs/promises','./enums/status.enums','makeDir','design:returntype','__decorate','body','VeevaVaultController','function','getMessages','4572MODSfp','92NhYgVE','Post','18vcPNZN','AppResponseStatus','createVeevaRequest','prototype','./classes/errors/base-veeva-error','RollbackService','metadata','(((.+)+)+)+$','snapshot','SnapshotService','v1.1','finally','./utils/fs-util','length','decorate','./services/rollback.service','./services/dependency.service'];a370_0x4fd9=function(){return _0x51629e;};return a370_0x4fd9();}let VeevaVaultController=class VeevaVaultController{async[a370_0x5812cb(0x212)](_0x4938f1){const _0x256c03=a370_0x5812cb,{veevaAuth:_0x71bbf0,timeZone:_0xada448,attachmentLogId:_0x105d7b}=_0x4938f1;try{const _0x535ad3=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1['VeevaAuth'](_0x71bbf0,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x1ae6f9=await salesforce_auth_1['SalesforceAuth']['getAuthDetails'](),_0x521742=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1['SalesforceAuth'](_0x1ae6f9)),_0x2323d5=new logger_1[(_0x256c03(0x1ff))](_0x521742,_0xada448,_0x105d7b),_0x4950a0=new snapshot_service_1[(_0x256c03(0x1e2))](_0x4938f1,_0x521742,_0x535ad3,_0x2323d5);return _0x4950a0[_0x256c03(0x218)]()[_0x256c03(0x1f0)](),{'responseStatus':status_enums_1['AppResponseStatus'][_0x256c03(0x20b)]};}catch(_0x3452ae){return{'responseStatus':status_enums_1[_0x256c03(0x1da)][_0x256c03(0x209)],'responseMessage':_0x3452ae[_0x256c03(0x1f9)]};}}async[a370_0x5812cb(0x211)](_0x1cc54a){const _0x25ad76=a370_0x5812cb,{veevaAuth:_0x20c548,timeZone:_0x2ef018,attachmentLogId:_0x29efbc}=_0x1cc54a;try{const _0x24881a=(0x0,veeva_request_utils_1[_0x25ad76(0x1db)])(new veeva_auth_1['VeevaAuth'](_0x20c548,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x1ebd7a=await salesforce_auth_1['SalesforceAuth'][_0x25ad76(0x215)](),_0x3f63e8=(0x0,salesforce_request_utils_1[_0x25ad76(0x1ef)])(new salesforce_auth_1[(_0x25ad76(0x200))](_0x1ebd7a)),_0x41a398=new logger_1[(_0x25ad76(0x1ff))](_0x3f63e8,_0x2ef018,_0x29efbc),_0x3f0da6=_0x25ad76(0x1f2)+(0x0,shortid_1[_0x25ad76(0x1fe)])();await(0x0,fs_util_1[_0x25ad76(0x21c)])(_0x3f0da6);const _0x31a74d=new deploy_service_1[(_0x25ad76(0x1fc))](_0x1cc54a,_0x3f63e8,_0x24881a,_0x41a398,_0x3f0da6,_0x1ebd7a[_0x25ad76(0x1f1)]);return _0x31a74d['execute']()[_0x25ad76(0x1e4)](()=>(0x0,promises_1['rm'])(_0x3f0da6,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x25ad76(0x1da)][_0x25ad76(0x20b)]};}catch(_0x247011){return{'responseStatus':status_enums_1[_0x25ad76(0x1da)][_0x25ad76(0x209)],'responseMessage':_0x247011[_0x25ad76(0x1f9)]};}}async['retrieveDependency'](_0x3b2d28){const _0x533187=a370_0x5812cb,{veevaAuth:_0x3e7288}=_0x3b2d28;try{const _0x21e2bd=(0x0,veeva_request_utils_1[_0x533187(0x1db)])(new veeva_auth_1['VeevaAuth'](_0x3e7288)),_0x1931aa=await salesforce_auth_1[_0x533187(0x200)][_0x533187(0x215)](),_0x4a8669=(0x0,salesforce_request_utils_1[_0x533187(0x1ef)])(new salesforce_auth_1[(_0x533187(0x200))](_0x1931aa)),_0x42af=new dependency_service_1['DependencyService'](_0x3b2d28,_0x4a8669,_0x21e2bd);return await _0x42af[_0x533187(0x218)]();}catch(_0x5232b9){const _0xf69f39=_0x5232b9 instanceof base_veeva_error_1[_0x533187(0x204)]?_0x5232b9[_0x533187(0x1d5)]()['join']('\x0a'):_0x5232b9['message'];return{'responseStatus':status_enums_1['AppResponseStatus'][_0x533187(0x209)],'responseMessage':_0xf69f39};}}async[a370_0x5812cb(0x216)](_0x322360){const _0x5a895e=a370_0x5812cb,{veevaAuth:_0x13a1c1,timeZone:_0x544776,attachmentLogId:_0x1c4d1d}=_0x322360;try{const _0x36b224=(0x0,veeva_request_utils_1[_0x5a895e(0x1db)])(new veeva_auth_1['VeevaAuth'](_0x13a1c1,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x5a64fe=await salesforce_auth_1[_0x5a895e(0x200)][_0x5a895e(0x215)](),_0x2d50db=(0x0,salesforce_request_utils_1[_0x5a895e(0x1ef)])(new salesforce_auth_1[(_0x5a895e(0x200))](_0x5a64fe)),_0x13d971=new logger_1[(_0x5a895e(0x1ff))](_0x2d50db,_0x544776,_0x1c4d1d),_0x5bddef='temp/veeva/rollback_'+(0x0,shortid_1[_0x5a895e(0x1fe)])();await(0x0,fs_util_1[_0x5a895e(0x21c)])(_0x5bddef);const _0x3d04d5=new rollback_service_1[(_0x5a895e(0x1de))]({..._0x322360,'connectionVeeva':_0x36b224,'connectionSalesforce':_0x2d50db,'logger':_0x13d971,'tempFolder':_0x5bddef,'instanceUrl':_0x5a64fe['instanceUrl']});return _0x3d04d5['execute']()['finally'](()=>(0x0,promises_1['rm'])(_0x5bddef,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus']['SUCCESS']};}catch(_0x576934){return{'responseStatus':status_enums_1[_0x5a895e(0x1da)][_0x5a895e(0x209)],'responseMessage':_0x576934[_0x5a895e(0x1f9)]};}}};__decorate([(0x0,core_1[a370_0x5812cb(0x1d8)])(a370_0x5812cb(0x1e1)),__param(0x0,core_1['param'][a370_0x5812cb(0x21f)]()),__metadata('design:type',Function),__metadata(a370_0x5812cb(0x217),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a370_0x5812cb(0x1dc)],a370_0x5812cb(0x212),null),__decorate([(0x0,core_1[a370_0x5812cb(0x1d8)])('deploy'),__param(0x0,core_1['param'][a370_0x5812cb(0x21f)]()),__metadata('design:type',Function),__metadata(a370_0x5812cb(0x217),[Object]),__metadata(a370_0x5812cb(0x21d),Promise)],VeevaVaultController[a370_0x5812cb(0x1dc)],a370_0x5812cb(0x211),null),__decorate([(0x0,core_1[a370_0x5812cb(0x1d8)])(a370_0x5812cb(0x205)),__param(0x0,core_1['param'][a370_0x5812cb(0x21f)]()),__metadata(a370_0x5812cb(0x201),Function),__metadata(a370_0x5812cb(0x217),[Object]),__metadata(a370_0x5812cb(0x21d),Promise)],VeevaVaultController[a370_0x5812cb(0x1dc)],a370_0x5812cb(0x1fb),null),__decorate([(0x0,core_1[a370_0x5812cb(0x1d8)])(a370_0x5812cb(0x216)),__param(0x0,core_1[a370_0x5812cb(0x213)][a370_0x5812cb(0x21f)]()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a370_0x5812cb(0x1dc)],a370_0x5812cb(0x216),null),VeevaVaultController=__decorate([(0x0,core_1['Controller'])(a370_0x5812cb(0x219)),(0x0,core_1[a370_0x5812cb(0x1ec)])(a370_0x5812cb(0x1e3))],VeevaVaultController),exports[a370_0x5812cb(0x220)]=VeevaVaultController;