function a347_0x43ac(_0x1acbd2,_0x3bb09f){const _0x40b63c=a347_0x590b();return a347_0x43ac=function(_0x6172c6,_0x109fd3){_0x6172c6=_0x6172c6-0x74;let _0x590b76=_0x40b63c[_0x6172c6];return _0x590b76;},a347_0x43ac(_0x1acbd2,_0x3bb09f);}const a347_0x134d18=a347_0x43ac;(function(_0x3a7e3e,_0x8316ce){const _0x37fb03=a347_0x43ac,_0x22436c=_0x3a7e3e();while(!![]){try{const _0x440b03=parseInt(_0x37fb03(0xab))/0x1+-parseInt(_0x37fb03(0x9a))/0x2*(parseInt(_0x37fb03(0xb2))/0x3)+parseInt(_0x37fb03(0x87))/0x4*(-parseInt(_0x37fb03(0x86))/0x5)+-parseInt(_0x37fb03(0x8f))/0x6+-parseInt(_0x37fb03(0xbb))/0x7*(parseInt(_0x37fb03(0x81))/0x8)+parseInt(_0x37fb03(0x93))/0x9*(parseInt(_0x37fb03(0x8a))/0xa)+parseInt(_0x37fb03(0xa2))/0xb;if(_0x440b03===_0x8316ce)break;else _0x22436c['push'](_0x22436c['shift']());}catch(_0x456c54){_0x22436c['push'](_0x22436c['shift']());}}}(a347_0x590b,0x5cb6f));function a347_0x590b(){const _0x5ad1f1=['./classes/loggers/logger','./classes/errors/base-veeva-error','doSnapshot','prototype','instanceUrl','search','3JfQcUw','toString','DependencyService','body','execute','../../core','length','deployFromBranch','getMessages','1631OKgkUM','defineProperty','VeevaAuth','getAuthDetails','./utils/veeva-request.utils','createSalesforceRequest','./services/snapshot.service','./services/deploy.service','veeva-vault','deploy','VeevaVaultController','object','temp/veeva/rollback_','Post','AppResponseStatus','SUCCESS','getOwnPropertyDescriptor','FAILURE','RollbackService','16440oxfbxF','./enums/status.enums','design:paramtypes','createVeevaRequest','./utils/fs-util','3551755iKYRCr','4spndXn','message','metadata','70nPQkhQ','(((.+)+)+)+$','default','temp/veeva/deploy_','rollback','2036616niqnSl','param','./utils/salesforce-request.utils','./services/rollback.service','360108NNJfgo','join','design:type','finally','design:returntype','__metadata','SalesforceAuth','1154806vmJsrd','./classes/auth/salesforce-auth','Controller','__importDefault','__param','./classes/auth/veeva-auth','__esModule','function','19465413FXGzli','./services/dependency.service','v1.1','retrieveDependency','decorate','Logger','Version','makeDir','snapshot','436097EAeEST'];a347_0x590b=function(){return _0x5ad1f1;};return a347_0x590b();}const a347_0x109fd3=(function(){let _0x2857d1=!![];return function(_0x21030e,_0x4c4336){const _0x1449c7=_0x2857d1?function(){if(_0x4c4336){const _0x47b379=_0x4c4336['apply'](_0x21030e,arguments);return _0x4c4336=null,_0x47b379;}}:function(){};return _0x2857d1=![],_0x1449c7;};}()),a347_0x6172c6=a347_0x109fd3(this,function(){const _0x3c8bd9=a347_0x43ac;return a347_0x6172c6[_0x3c8bd9(0xb3)]()[_0x3c8bd9(0xb1)]('(((.+)+)+)+$')[_0x3c8bd9(0xb3)]()['constructor'](a347_0x6172c6)[_0x3c8bd9(0xb1)](_0x3c8bd9(0x8b));});a347_0x6172c6();'use strict';var __decorate=this&&this['__decorate']||function(_0x12f352,_0x53d414,_0x35efe0,_0x1b0037){const _0x12fd34=a347_0x43ac;var _0x190e05=arguments['length'],_0x1ebe41=_0x190e05<0x3?_0x53d414:_0x1b0037===null?_0x1b0037=Object[_0x12fd34(0x7e)](_0x53d414,_0x35efe0):_0x1b0037,_0x4437e6;if(typeof Reflect===_0x12fd34(0x79)&&typeof Reflect[_0x12fd34(0xa6)]===_0x12fd34(0xa1))_0x1ebe41=Reflect[_0x12fd34(0xa6)](_0x12f352,_0x53d414,_0x35efe0,_0x1b0037);else{for(var _0x3c4136=_0x12f352[_0x12fd34(0xb8)]-0x1;_0x3c4136>=0x0;_0x3c4136--)if(_0x4437e6=_0x12f352[_0x3c4136])_0x1ebe41=(_0x190e05<0x3?_0x4437e6(_0x1ebe41):_0x190e05>0x3?_0x4437e6(_0x53d414,_0x35efe0,_0x1ebe41):_0x4437e6(_0x53d414,_0x35efe0))||_0x1ebe41;}return _0x190e05>0x3&&_0x1ebe41&&Object[_0x12fd34(0xbc)](_0x53d414,_0x35efe0,_0x1ebe41),_0x1ebe41;},__metadata=this&&this[a347_0x134d18(0x98)]||function(_0x41cad4,_0x1fa01a){const _0x5ad72b=a347_0x134d18;if(typeof Reflect===_0x5ad72b(0x79)&&typeof Reflect['metadata']===_0x5ad72b(0xa1))return Reflect[_0x5ad72b(0x89)](_0x41cad4,_0x1fa01a);},__param=this&&this[a347_0x134d18(0x9e)]||function(_0x51df78,_0x5d219a){return function(_0x642b58,_0x1129b6){_0x5d219a(_0x642b58,_0x1129b6,_0x51df78);};},__importDefault=this&&this[a347_0x134d18(0x9d)]||function(_0x3d7bb0){return _0x3d7bb0&&_0x3d7bb0['__esModule']?_0x3d7bb0:{'default':_0x3d7bb0};};Object[a347_0x134d18(0xbc)](exports,a347_0x134d18(0xa0),{'value':!![]}),exports[a347_0x134d18(0x78)]=void 0x0;const core_1=require(a347_0x134d18(0xb7)),dependency_service_1=require(a347_0x134d18(0xa3)),snapshot_service_1=require(a347_0x134d18(0x74)),deploy_service_1=require(a347_0x134d18(0x75)),veeva_request_utils_1=require(a347_0x134d18(0xbf)),status_enums_1=require(a347_0x134d18(0x82)),shortid_1=__importDefault(require('shortid')),fs_util_1=require(a347_0x134d18(0x85)),logger_1=require(a347_0x134d18(0xac)),promises_1=require('fs/promises'),base_veeva_error_1=require(a347_0x134d18(0xad)),salesforce_request_utils_1=require(a347_0x134d18(0x91)),veeva_auth_1=require(a347_0x134d18(0x9f)),salesforce_auth_1=require(a347_0x134d18(0x9b)),rollback_service_1=require(a347_0x134d18(0x92)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a347_0x134d18(0xae)](_0x6cf1f1){const _0x49d6d9=a347_0x134d18,{veevaAuth:_0xfa5125,timeZone:_0x8637b1,attachmentLogId:_0x5a269a}=_0x6cf1f1;try{const _0x196047=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x49d6d9(0xbd))](_0xfa5125,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x39c1ad=await salesforce_auth_1[_0x49d6d9(0x99)][_0x49d6d9(0xbe)](),_0x948bc5=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x49d6d9(0x99))](_0x39c1ad)),_0xb4bcb2=new logger_1[(_0x49d6d9(0xa7))](_0x948bc5,_0x8637b1,_0x5a269a),_0x1019db=new snapshot_service_1['SnapshotService'](_0x6cf1f1,_0x948bc5,_0x196047,_0xb4bcb2);return _0x1019db['execute']()['then'](),{'responseStatus':status_enums_1[_0x49d6d9(0x7c)][_0x49d6d9(0x7d)]};}catch(_0x49261a){return{'responseStatus':status_enums_1[_0x49d6d9(0x7c)][_0x49d6d9(0x7f)],'responseMessage':_0x49261a[_0x49d6d9(0x88)]};}}async[a347_0x134d18(0xb9)](_0x36b3b5){const _0x491a98=a347_0x134d18,{veevaAuth:_0x46d5e1,timeZone:_0x5c1e99,attachmentLogId:_0x382775}=_0x36b3b5;try{const _0x731f3b=(0x0,veeva_request_utils_1[_0x491a98(0x84)])(new veeva_auth_1[(_0x491a98(0xbd))](_0x46d5e1,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x5bae37=await salesforce_auth_1[_0x491a98(0x99)][_0x491a98(0xbe)](),_0xebcfd2=(0x0,salesforce_request_utils_1[_0x491a98(0xc0)])(new salesforce_auth_1[(_0x491a98(0x99))](_0x5bae37)),_0x1484d7=new logger_1[(_0x491a98(0xa7))](_0xebcfd2,_0x5c1e99,_0x382775),_0x4960ff=_0x491a98(0x8d)+(0x0,shortid_1[_0x491a98(0x8c)])();await(0x0,fs_util_1[_0x491a98(0xa9)])(_0x4960ff);const _0x26eda3=new deploy_service_1['DeployService'](_0x36b3b5,_0xebcfd2,_0x731f3b,_0x1484d7,_0x4960ff,_0x5bae37[_0x491a98(0xb0)]);return _0x26eda3['execute']()[_0x491a98(0x96)](()=>(0x0,promises_1['rm'])(_0x4960ff,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x491a98(0x7d)]};}catch(_0x226460){return{'responseStatus':status_enums_1[_0x491a98(0x7c)][_0x491a98(0x7f)],'responseMessage':_0x226460[_0x491a98(0x88)]};}}async[a347_0x134d18(0xa5)](_0x5ce128){const _0x573391=a347_0x134d18,{veevaAuth:_0x265afe}=_0x5ce128;try{const _0x135a6f=(0x0,veeva_request_utils_1[_0x573391(0x84)])(new veeva_auth_1[(_0x573391(0xbd))](_0x265afe)),_0x400364=await salesforce_auth_1[_0x573391(0x99)]['getAuthDetails'](),_0x3de359=(0x0,salesforce_request_utils_1[_0x573391(0xc0)])(new salesforce_auth_1[(_0x573391(0x99))](_0x400364)),_0x4fb7e8=new dependency_service_1[(_0x573391(0xb4))](_0x5ce128,_0x3de359,_0x135a6f);return await _0x4fb7e8[_0x573391(0xb6)]();}catch(_0x4d9428){const _0x5afa39=_0x4d9428 instanceof base_veeva_error_1['BaseVeevaError']?_0x4d9428[_0x573391(0xba)]()[_0x573391(0x94)]('\x0a'):_0x4d9428[_0x573391(0x88)];return{'responseStatus':status_enums_1['AppResponseStatus'][_0x573391(0x7f)],'responseMessage':_0x5afa39};}}async['rollback'](_0x54fd4f){const _0xdf480c=a347_0x134d18,{veevaAuth:_0x2d0a88,timeZone:_0x1ee795,attachmentLogId:_0x4cb362}=_0x54fd4f;try{const _0x5d0e4c=(0x0,veeva_request_utils_1[_0xdf480c(0x84)])(new veeva_auth_1[(_0xdf480c(0xbd))](_0x2d0a88,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x244be6=await salesforce_auth_1[_0xdf480c(0x99)][_0xdf480c(0xbe)](),_0x256e38=(0x0,salesforce_request_utils_1[_0xdf480c(0xc0)])(new salesforce_auth_1[(_0xdf480c(0x99))](_0x244be6)),_0x252712=new logger_1[(_0xdf480c(0xa7))](_0x256e38,_0x1ee795,_0x4cb362),_0xd60d9e=_0xdf480c(0x7a)+(0x0,shortid_1['default'])();await(0x0,fs_util_1['makeDir'])(_0xd60d9e);const _0x2e5157=new rollback_service_1[(_0xdf480c(0x80))]({..._0x54fd4f,'connectionVeeva':_0x5d0e4c,'connectionSalesforce':_0x256e38,'logger':_0x252712,'tempFolder':_0xd60d9e,'instanceUrl':_0x244be6[_0xdf480c(0xb0)]});return _0x2e5157[_0xdf480c(0xb6)]()[_0xdf480c(0x96)](()=>(0x0,promises_1['rm'])(_0xd60d9e,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0xdf480c(0x7d)]};}catch(_0x2b8492){return{'responseStatus':status_enums_1['AppResponseStatus']['FAILURE'],'responseMessage':_0x2b8492[_0xdf480c(0x88)]};}}};__decorate([(0x0,core_1['Post'])(a347_0x134d18(0xaa)),__param(0x0,core_1[a347_0x134d18(0x90)]['body']()),__metadata('design:type',Function),__metadata(a347_0x134d18(0x83),[Object]),__metadata(a347_0x134d18(0x97),Promise)],VeevaVaultController[a347_0x134d18(0xaf)],a347_0x134d18(0xae),null),__decorate([(0x0,core_1[a347_0x134d18(0x7b)])(a347_0x134d18(0x77)),__param(0x0,core_1[a347_0x134d18(0x90)]['body']()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(a347_0x134d18(0x97),Promise)],VeevaVaultController['prototype'],'deployFromBranch',null),__decorate([(0x0,core_1[a347_0x134d18(0x7b)])('dependency'),__param(0x0,core_1[a347_0x134d18(0x90)][a347_0x134d18(0xb5)]()),__metadata(a347_0x134d18(0x95),Function),__metadata(a347_0x134d18(0x83),[Object]),__metadata(a347_0x134d18(0x97),Promise)],VeevaVaultController[a347_0x134d18(0xaf)],a347_0x134d18(0xa5),null),__decorate([(0x0,core_1[a347_0x134d18(0x7b)])('rollback'),__param(0x0,core_1[a347_0x134d18(0x90)][a347_0x134d18(0xb5)]()),__metadata(a347_0x134d18(0x95),Function),__metadata(a347_0x134d18(0x83),[Object]),__metadata(a347_0x134d18(0x97),Promise)],VeevaVaultController[a347_0x134d18(0xaf)],a347_0x134d18(0x8e),null),VeevaVaultController=__decorate([(0x0,core_1[a347_0x134d18(0x9c)])(a347_0x134d18(0x76)),(0x0,core_1[a347_0x134d18(0xa8)])(a347_0x134d18(0xa4))],VeevaVaultController),exports[a347_0x134d18(0x78)]=VeevaVaultController;