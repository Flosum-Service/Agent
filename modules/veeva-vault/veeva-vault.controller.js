function a370_0x2052(){const _0x3408b4=['then','./classes/errors/base-veeva-error','param','execute','./utils/veeva-request.utils','getMessages','search','4531440BWqTYm','./classes/auth/salesforce-auth','join','SnapshotService','getOwnPropertyDescriptor','decorate','retrieveDependency','__esModule','__metadata','function','defineProperty','temp/veeva/rollback_','makeDir','prototype','length','./utils/salesforce-request.utils','308666FRjUZU','1157810jTCQap','VeevaAuth','BaseVeevaError','design:type','(((.+)+)+)+$','./utils/fs-util','temp/veeva/deploy_','5970840EMobiK','snapshot','design:paramtypes','veeva-vault','metadata','createVeevaRequest','FAILURE','message','design:returntype','./enums/status.enums','__decorate','deployFromBranch','createSalesforceRequest','./services/rollback.service','./services/deploy.service','object','doSnapshot','apply','getAuthDetails','body','shortid','RollbackService','Version','instanceUrl','AppResponseStatus','finally','fs/promises','4988274kIialv','2385047tSWLJA','dependency','default','__importDefault','__param','4472520QySAYA','rollback','SalesforceAuth','../../core','Post','Logger','SUCCESS'];a370_0x2052=function(){return _0x3408b4;};return a370_0x2052();}const a370_0x3ebb53=a370_0x499c;(function(_0x227c04,_0x4471b4){const _0x68e7e6=a370_0x499c,_0x5f4ea5=_0x227c04();while(!![]){try{const _0x5428ce=parseInt(_0x68e7e6(0x93))/0x1+parseInt(_0x68e7e6(0x94))/0x2+parseInt(_0x68e7e6(0xb6))/0x3+-parseInt(_0x68e7e6(0x9b))/0x4+parseInt(_0x68e7e6(0xca))/0x5+-parseInt(_0x68e7e6(0xbc))/0x6+-parseInt(_0x68e7e6(0xb7))/0x7;if(_0x5428ce===_0x4471b4)break;else _0x5f4ea5['push'](_0x5f4ea5['shift']());}catch(_0x4b584d){_0x5f4ea5['push'](_0x5f4ea5['shift']());}}}(a370_0x2052,0xd64c6));const a370_0x4f0245=(function(){let _0x199178=!![];return function(_0xf1c703,_0x44c658){const _0x1504e0=_0x199178?function(){const _0x3e0fd9=a370_0x499c;if(_0x44c658){const _0x44c886=_0x44c658[_0x3e0fd9(0xac)](_0xf1c703,arguments);return _0x44c658=null,_0x44c886;}}:function(){};return _0x199178=![],_0x1504e0;};}()),a370_0x2f71e9=a370_0x4f0245(this,function(){const _0xe35d45=a370_0x499c;return a370_0x2f71e9['toString']()[_0xe35d45(0xc9)](_0xe35d45(0x98))['toString']()['constructor'](a370_0x2f71e9)['search'](_0xe35d45(0x98));});a370_0x2f71e9();'use strict';var __decorate=this&&this[a370_0x3ebb53(0xa5)]||function(_0x2ca207,_0xc1bd65,_0x2ea2e3,_0x4fa0a2){const _0x4d58b1=a370_0x3ebb53;var _0x5166df=arguments[_0x4d58b1(0x91)],_0x224917=_0x5166df<0x3?_0xc1bd65:_0x4fa0a2===null?_0x4fa0a2=Object[_0x4d58b1(0xce)](_0xc1bd65,_0x2ea2e3):_0x4fa0a2,_0x4f333f;if(typeof Reflect===_0x4d58b1(0xaa)&&typeof Reflect[_0x4d58b1(0xcf)]===_0x4d58b1(0x8c))_0x224917=Reflect['decorate'](_0x2ca207,_0xc1bd65,_0x2ea2e3,_0x4fa0a2);else{for(var _0x39a4de=_0x2ca207[_0x4d58b1(0x91)]-0x1;_0x39a4de>=0x0;_0x39a4de--)if(_0x4f333f=_0x2ca207[_0x39a4de])_0x224917=(_0x5166df<0x3?_0x4f333f(_0x224917):_0x5166df>0x3?_0x4f333f(_0xc1bd65,_0x2ea2e3,_0x224917):_0x4f333f(_0xc1bd65,_0x2ea2e3))||_0x224917;}return _0x5166df>0x3&&_0x224917&&Object['defineProperty'](_0xc1bd65,_0x2ea2e3,_0x224917),_0x224917;},__metadata=this&&this[a370_0x3ebb53(0x8b)]||function(_0x48e592,_0x366559){const _0x4d97a6=a370_0x3ebb53;if(typeof Reflect==='object'&&typeof Reflect[_0x4d97a6(0x9f)]===_0x4d97a6(0x8c))return Reflect[_0x4d97a6(0x9f)](_0x48e592,_0x366559);},__param=this&&this[a370_0x3ebb53(0xbb)]||function(_0x548f59,_0x74060b){return function(_0xc3fa5a,_0x4878ac){_0x74060b(_0xc3fa5a,_0x4878ac,_0x548f59);};},__importDefault=this&&this[a370_0x3ebb53(0xba)]||function(_0x30fd74){const _0x881c45=a370_0x3ebb53;return _0x30fd74&&_0x30fd74[_0x881c45(0x8a)]?_0x30fd74:{'default':_0x30fd74};};Object[a370_0x3ebb53(0x8d)](exports,a370_0x3ebb53(0x8a),{'value':!![]}),exports['VeevaVaultController']=void 0x0;const core_1=require(a370_0x3ebb53(0xbf)),dependency_service_1=require('./services/dependency.service'),snapshot_service_1=require('./services/snapshot.service'),deploy_service_1=require(a370_0x3ebb53(0xa9)),veeva_request_utils_1=require(a370_0x3ebb53(0xc7)),status_enums_1=require(a370_0x3ebb53(0xa4)),shortid_1=__importDefault(require(a370_0x3ebb53(0xaf))),fs_util_1=require(a370_0x3ebb53(0x99)),logger_1=require('./classes/loggers/logger'),promises_1=require(a370_0x3ebb53(0xb5)),base_veeva_error_1=require(a370_0x3ebb53(0xc4)),salesforce_request_utils_1=require(a370_0x3ebb53(0x92)),veeva_auth_1=require('./classes/auth/veeva-auth'),salesforce_auth_1=require(a370_0x3ebb53(0xcb)),rollback_service_1=require(a370_0x3ebb53(0xa8)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a370_0x3ebb53(0xab)](_0x50f4ec){const _0x48a7f6=a370_0x3ebb53,{veevaAuth:_0x33892a,timeZone:_0x4d6789,attachmentLogId:_0x28b574}=_0x50f4ec;try{const _0x2693d6=(0x0,veeva_request_utils_1[_0x48a7f6(0xa0)])(new veeva_auth_1['VeevaAuth'](_0x33892a,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x5eaf26=await salesforce_auth_1[_0x48a7f6(0xbe)][_0x48a7f6(0xad)](),_0x535152=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x48a7f6(0xbe))](_0x5eaf26)),_0x2c87c2=new logger_1[(_0x48a7f6(0xc1))](_0x535152,_0x4d6789,_0x28b574),_0x183e60=new snapshot_service_1[(_0x48a7f6(0xcd))](_0x50f4ec,_0x535152,_0x2693d6,_0x2c87c2);return _0x183e60[_0x48a7f6(0xc6)]()[_0x48a7f6(0xc3)](),{'responseStatus':status_enums_1[_0x48a7f6(0xb3)]['SUCCESS']};}catch(_0x3409dd){return{'responseStatus':status_enums_1[_0x48a7f6(0xb3)][_0x48a7f6(0xa1)],'responseMessage':_0x3409dd[_0x48a7f6(0xa2)]};}}async[a370_0x3ebb53(0xa6)](_0x32d38d){const _0x4412f6=a370_0x3ebb53,{veevaAuth:_0x629005,timeZone:_0x2bb6be,attachmentLogId:_0x119688}=_0x32d38d;try{const _0x5c21be=(0x0,veeva_request_utils_1[_0x4412f6(0xa0)])(new veeva_auth_1[(_0x4412f6(0x95))](_0x629005,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x5b83a1=await salesforce_auth_1['SalesforceAuth'][_0x4412f6(0xad)](),_0xd5e97b=(0x0,salesforce_request_utils_1[_0x4412f6(0xa7)])(new salesforce_auth_1['SalesforceAuth'](_0x5b83a1)),_0x5526ef=new logger_1[(_0x4412f6(0xc1))](_0xd5e97b,_0x2bb6be,_0x119688),_0x2546ce=_0x4412f6(0x9a)+(0x0,shortid_1[_0x4412f6(0xb9)])();await(0x0,fs_util_1[_0x4412f6(0x8f)])(_0x2546ce);const _0x1a8d88=new deploy_service_1['DeployService'](_0x32d38d,_0xd5e97b,_0x5c21be,_0x5526ef,_0x2546ce,_0x5b83a1['instanceUrl']);return _0x1a8d88[_0x4412f6(0xc6)]()[_0x4412f6(0xb4)](()=>(0x0,promises_1['rm'])(_0x2546ce,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x4412f6(0xb3)][_0x4412f6(0xc2)]};}catch(_0x3c0f92){return{'responseStatus':status_enums_1[_0x4412f6(0xb3)][_0x4412f6(0xa1)],'responseMessage':_0x3c0f92['message']};}}async[a370_0x3ebb53(0x89)](_0x371016){const _0x363443=a370_0x3ebb53,{veevaAuth:_0x48b8c6}=_0x371016;try{const _0x3d3908=(0x0,veeva_request_utils_1[_0x363443(0xa0)])(new veeva_auth_1[(_0x363443(0x95))](_0x48b8c6)),_0x31f9c9=await salesforce_auth_1[_0x363443(0xbe)][_0x363443(0xad)](),_0x3caaf9=(0x0,salesforce_request_utils_1[_0x363443(0xa7)])(new salesforce_auth_1[(_0x363443(0xbe))](_0x31f9c9)),_0x5ccf13=new dependency_service_1['DependencyService'](_0x371016,_0x3caaf9,_0x3d3908);return await _0x5ccf13[_0x363443(0xc6)]();}catch(_0x366b6f){const _0xc923af=_0x366b6f instanceof base_veeva_error_1[_0x363443(0x96)]?_0x366b6f[_0x363443(0xc8)]()[_0x363443(0xcc)]('\x0a'):_0x366b6f[_0x363443(0xa2)];return{'responseStatus':status_enums_1[_0x363443(0xb3)][_0x363443(0xa1)],'responseMessage':_0xc923af};}}async[a370_0x3ebb53(0xbd)](_0x37eb12){const _0x2beac4=a370_0x3ebb53,{veevaAuth:_0x2bb9e1,timeZone:_0x12857d,attachmentLogId:_0xbde04a}=_0x37eb12;try{const _0x29b706=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1['VeevaAuth'](_0x2bb9e1,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x495a20=await salesforce_auth_1[_0x2beac4(0xbe)][_0x2beac4(0xad)](),_0x1e1d6b=(0x0,salesforce_request_utils_1[_0x2beac4(0xa7)])(new salesforce_auth_1[(_0x2beac4(0xbe))](_0x495a20)),_0x5a7872=new logger_1[(_0x2beac4(0xc1))](_0x1e1d6b,_0x12857d,_0xbde04a),_0x24da1b=_0x2beac4(0x8e)+(0x0,shortid_1['default'])();await(0x0,fs_util_1[_0x2beac4(0x8f)])(_0x24da1b);const _0x500599=new rollback_service_1[(_0x2beac4(0xb0))]({..._0x37eb12,'connectionVeeva':_0x29b706,'connectionSalesforce':_0x1e1d6b,'logger':_0x5a7872,'tempFolder':_0x24da1b,'instanceUrl':_0x495a20[_0x2beac4(0xb2)]});return _0x500599['execute']()[_0x2beac4(0xb4)](()=>(0x0,promises_1['rm'])(_0x24da1b,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x2beac4(0xb3)]['SUCCESS']};}catch(_0x2d7745){return{'responseStatus':status_enums_1[_0x2beac4(0xb3)][_0x2beac4(0xa1)],'responseMessage':_0x2d7745[_0x2beac4(0xa2)]};}}};function a370_0x499c(_0x437923,_0x1bf086){const _0x264fd2=a370_0x2052();return a370_0x499c=function(_0x2f71e9,_0x4f0245){_0x2f71e9=_0x2f71e9-0x89;let _0x205299=_0x264fd2[_0x2f71e9];return _0x205299;},a370_0x499c(_0x437923,_0x1bf086);}__decorate([(0x0,core_1[a370_0x3ebb53(0xc0)])(a370_0x3ebb53(0x9c)),__param(0x0,core_1[a370_0x3ebb53(0xc5)][a370_0x3ebb53(0xae)]()),__metadata(a370_0x3ebb53(0x97),Function),__metadata(a370_0x3ebb53(0x9d),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a370_0x3ebb53(0x90)],a370_0x3ebb53(0xab),null),__decorate([(0x0,core_1['Post'])('deploy'),__param(0x0,core_1[a370_0x3ebb53(0xc5)][a370_0x3ebb53(0xae)]()),__metadata(a370_0x3ebb53(0x97),Function),__metadata('design:paramtypes',[Object]),__metadata(a370_0x3ebb53(0xa3),Promise)],VeevaVaultController[a370_0x3ebb53(0x90)],a370_0x3ebb53(0xa6),null),__decorate([(0x0,core_1[a370_0x3ebb53(0xc0)])(a370_0x3ebb53(0xb8)),__param(0x0,core_1[a370_0x3ebb53(0xc5)][a370_0x3ebb53(0xae)]()),__metadata(a370_0x3ebb53(0x97),Function),__metadata('design:paramtypes',[Object]),__metadata(a370_0x3ebb53(0xa3),Promise)],VeevaVaultController['prototype'],a370_0x3ebb53(0x89),null),__decorate([(0x0,core_1[a370_0x3ebb53(0xc0)])(a370_0x3ebb53(0xbd)),__param(0x0,core_1[a370_0x3ebb53(0xc5)]['body']()),__metadata(a370_0x3ebb53(0x97),Function),__metadata(a370_0x3ebb53(0x9d),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a370_0x3ebb53(0x90)],'rollback',null),VeevaVaultController=__decorate([(0x0,core_1['Controller'])(a370_0x3ebb53(0x9e)),(0x0,core_1[a370_0x3ebb53(0xb1)])('v1.1')],VeevaVaultController),exports['VeevaVaultController']=VeevaVaultController;