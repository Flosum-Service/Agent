function a347_0xb8d5(){const _0x1ec730=['__esModule','deploy','__metadata','./classes/loggers/logger','temp/veeva/deploy_','instanceUrl','dependency','design:paramtypes','getAuthDetails','prototype','rollback','49UsYapq','Logger','message','design:type','92ExFiLY','decorate','SnapshotService','temp/veeva/rollback_','deployFromBranch','AppResponseStatus','param','veeva-vault','constructor','metadata','shortid','getOwnPropertyDescriptor','v1.1','FAILURE','4138jdvlUM','Version','SalesforceAuth','./classes/errors/base-veeva-error','doSnapshot','object','function','join','Post','Controller','__importDefault','apply','default','VeevaVaultController','./services/deploy.service','./utils/veeva-request.utils','length','finally','1873212zEKYrT','execute','fs/promises','1988410xXrxvA','330uVFxGk','retrieveDependency','./services/rollback.service','createVeevaRequest','537fZcHwZ','search','./services/dependency.service','./classes/auth/salesforce-auth','140853UFTAxm','./services/snapshot.service','design:returntype','VeevaAuth','SUCCESS','1337872DlCjri','body','1913747NXvqpf','__param','RollbackService','../../core','then','getMessages','createSalesforceRequest','(((.+)+)+)+$','12471885jxqlGl','__decorate'];a347_0xb8d5=function(){return _0x1ec730;};return a347_0xb8d5();}const a347_0x125cc9=a347_0x195f;(function(_0x334784,_0x257792){const _0x1ce5ca=a347_0x195f,_0x318585=_0x334784();while(!![]){try{const _0x5b3b4c=parseInt(_0x1ce5ca(0x135))/0x1*(-parseInt(_0x1ce5ca(0x167))/0x2)+-parseInt(_0x1ce5ca(0x139))/0x3*(parseInt(_0x1ce5ca(0x159))/0x4)+-parseInt(_0x1ce5ca(0x130))/0x5+parseInt(_0x1ce5ca(0x12d))/0x6+parseInt(_0x1ce5ca(0x155))/0x7*(-parseInt(_0x1ce5ca(0x13e))/0x8)+-parseInt(_0x1ce5ca(0x148))/0x9+-parseInt(_0x1ce5ca(0x131))/0xa*(-parseInt(_0x1ce5ca(0x140))/0xb);if(_0x5b3b4c===_0x257792)break;else _0x318585['push'](_0x318585['shift']());}catch(_0x5ba499){_0x318585['push'](_0x318585['shift']());}}}(a347_0xb8d5,0xddc90));const a347_0x154483=(function(){let _0x5e3503=!![];return function(_0x1296f7,_0xa8321d){const _0x8dfb4c=_0x5e3503?function(){const _0x489279=a347_0x195f;if(_0xa8321d){const _0x455de3=_0xa8321d[_0x489279(0x172)](_0x1296f7,arguments);return _0xa8321d=null,_0x455de3;}}:function(){};return _0x5e3503=![],_0x8dfb4c;};}()),a347_0x4d0bd0=a347_0x154483(this,function(){const _0x481bd5=a347_0x195f;return a347_0x4d0bd0['toString']()[_0x481bd5(0x136)](_0x481bd5(0x147))['toString']()[_0x481bd5(0x161)](a347_0x4d0bd0)[_0x481bd5(0x136)](_0x481bd5(0x147));});a347_0x4d0bd0();'use strict';function a347_0x195f(_0x250850,_0x5e834a){const _0x1a0a30=a347_0xb8d5();return a347_0x195f=function(_0x4d0bd0,_0x154483){_0x4d0bd0=_0x4d0bd0-0x12a;let _0xb8d5d4=_0x1a0a30[_0x4d0bd0];return _0xb8d5d4;},a347_0x195f(_0x250850,_0x5e834a);}var __decorate=this&&this[a347_0x125cc9(0x149)]||function(_0xd40da9,_0x2ca7e9,_0x57607f,_0x36bc45){const _0x1fc056=a347_0x125cc9;var _0xbbf1f4=arguments[_0x1fc056(0x12b)],_0x5bd53a=_0xbbf1f4<0x3?_0x2ca7e9:_0x36bc45===null?_0x36bc45=Object[_0x1fc056(0x164)](_0x2ca7e9,_0x57607f):_0x36bc45,_0x46aef6;if(typeof Reflect===_0x1fc056(0x16c)&&typeof Reflect[_0x1fc056(0x15a)]===_0x1fc056(0x16d))_0x5bd53a=Reflect['decorate'](_0xd40da9,_0x2ca7e9,_0x57607f,_0x36bc45);else{for(var _0x3dbf8b=_0xd40da9[_0x1fc056(0x12b)]-0x1;_0x3dbf8b>=0x0;_0x3dbf8b--)if(_0x46aef6=_0xd40da9[_0x3dbf8b])_0x5bd53a=(_0xbbf1f4<0x3?_0x46aef6(_0x5bd53a):_0xbbf1f4>0x3?_0x46aef6(_0x2ca7e9,_0x57607f,_0x5bd53a):_0x46aef6(_0x2ca7e9,_0x57607f))||_0x5bd53a;}return _0xbbf1f4>0x3&&_0x5bd53a&&Object['defineProperty'](_0x2ca7e9,_0x57607f,_0x5bd53a),_0x5bd53a;},__metadata=this&&this[a347_0x125cc9(0x14c)]||function(_0x2a2c18,_0x8bdfb2){const _0x4a8ba2=a347_0x125cc9;if(typeof Reflect===_0x4a8ba2(0x16c)&&typeof Reflect['metadata']===_0x4a8ba2(0x16d))return Reflect[_0x4a8ba2(0x162)](_0x2a2c18,_0x8bdfb2);},__param=this&&this[a347_0x125cc9(0x141)]||function(_0xc4cb1e,_0x45bbd2){return function(_0x5d698b,_0x1f1fa1){_0x45bbd2(_0x5d698b,_0x1f1fa1,_0xc4cb1e);};},__importDefault=this&&this[a347_0x125cc9(0x171)]||function(_0xab6a72){const _0x42f7e5=a347_0x125cc9;return _0xab6a72&&_0xab6a72[_0x42f7e5(0x14a)]?_0xab6a72:{'default':_0xab6a72};};Object['defineProperty'](exports,a347_0x125cc9(0x14a),{'value':!![]}),exports['VeevaVaultController']=void 0x0;const core_1=require(a347_0x125cc9(0x143)),dependency_service_1=require(a347_0x125cc9(0x137)),snapshot_service_1=require(a347_0x125cc9(0x13a)),deploy_service_1=require(a347_0x125cc9(0x175)),veeva_request_utils_1=require(a347_0x125cc9(0x12a)),status_enums_1=require('./enums/status.enums'),shortid_1=__importDefault(require(a347_0x125cc9(0x163))),fs_util_1=require('./utils/fs-util'),logger_1=require(a347_0x125cc9(0x14d)),promises_1=require(a347_0x125cc9(0x12f)),base_veeva_error_1=require(a347_0x125cc9(0x16a)),salesforce_request_utils_1=require('./utils/salesforce-request.utils'),veeva_auth_1=require('./classes/auth/veeva-auth'),salesforce_auth_1=require(a347_0x125cc9(0x138)),rollback_service_1=require(a347_0x125cc9(0x133)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a347_0x125cc9(0x16b)](_0x491cdd){const _0x21707e=a347_0x125cc9,{veevaAuth:_0x3b58f3,timeZone:_0x49b333,attachmentLogId:_0x395b64}=_0x491cdd;try{const _0x4d051d=(0x0,veeva_request_utils_1[_0x21707e(0x134)])(new veeva_auth_1[(_0x21707e(0x13c))](_0x3b58f3,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x4fd4cc=await salesforce_auth_1[_0x21707e(0x169)][_0x21707e(0x152)](),_0x4e5070=(0x0,salesforce_request_utils_1[_0x21707e(0x146)])(new salesforce_auth_1[(_0x21707e(0x169))](_0x4fd4cc)),_0xe95f9d=new logger_1[(_0x21707e(0x156))](_0x4e5070,_0x49b333,_0x395b64),_0x2fb38f=new snapshot_service_1[(_0x21707e(0x15b))](_0x491cdd,_0x4e5070,_0x4d051d,_0xe95f9d);return _0x2fb38f[_0x21707e(0x12e)]()[_0x21707e(0x144)](),{'responseStatus':status_enums_1[_0x21707e(0x15e)][_0x21707e(0x13d)]};}catch(_0x2a02ee){return{'responseStatus':status_enums_1[_0x21707e(0x15e)][_0x21707e(0x166)],'responseMessage':_0x2a02ee[_0x21707e(0x157)]};}}async[a347_0x125cc9(0x15d)](_0x474b2d){const _0x53ac36=a347_0x125cc9,{veevaAuth:_0x54cf49,timeZone:_0x30d1cb,attachmentLogId:_0x46ec9b}=_0x474b2d;try{const _0x5b3beb=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x53ac36(0x13c))](_0x54cf49,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x4ff193=await salesforce_auth_1['SalesforceAuth']['getAuthDetails'](),_0x287cf0=(0x0,salesforce_request_utils_1[_0x53ac36(0x146)])(new salesforce_auth_1['SalesforceAuth'](_0x4ff193)),_0x4af4ec=new logger_1['Logger'](_0x287cf0,_0x30d1cb,_0x46ec9b),_0x4dff8a=_0x53ac36(0x14e)+(0x0,shortid_1[_0x53ac36(0x173)])();await(0x0,fs_util_1['makeDir'])(_0x4dff8a);const _0x538593=new deploy_service_1['DeployService'](_0x474b2d,_0x287cf0,_0x5b3beb,_0x4af4ec,_0x4dff8a,_0x4ff193['instanceUrl']);return _0x538593[_0x53ac36(0x12e)]()[_0x53ac36(0x12c)](()=>(0x0,promises_1['rm'])(_0x4dff8a,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x53ac36(0x13d)]};}catch(_0x64ec6){return{'responseStatus':status_enums_1[_0x53ac36(0x15e)][_0x53ac36(0x166)],'responseMessage':_0x64ec6[_0x53ac36(0x157)]};}}async[a347_0x125cc9(0x132)](_0x291927){const _0x5d5a48=a347_0x125cc9,{veevaAuth:_0x273f58}=_0x291927;try{const _0x4beba2=(0x0,veeva_request_utils_1[_0x5d5a48(0x134)])(new veeva_auth_1['VeevaAuth'](_0x273f58)),_0x3188af=await salesforce_auth_1[_0x5d5a48(0x169)]['getAuthDetails'](),_0x19e9e5=(0x0,salesforce_request_utils_1[_0x5d5a48(0x146)])(new salesforce_auth_1['SalesforceAuth'](_0x3188af)),_0x4320cc=new dependency_service_1['DependencyService'](_0x291927,_0x19e9e5,_0x4beba2);return await _0x4320cc['execute']();}catch(_0x442db9){const _0x56a7b1=_0x442db9 instanceof base_veeva_error_1['BaseVeevaError']?_0x442db9[_0x5d5a48(0x145)]()[_0x5d5a48(0x16e)]('\x0a'):_0x442db9[_0x5d5a48(0x157)];return{'responseStatus':status_enums_1[_0x5d5a48(0x15e)][_0x5d5a48(0x166)],'responseMessage':_0x56a7b1};}}async[a347_0x125cc9(0x154)](_0xb5cbf7){const _0x1e23f6=a347_0x125cc9,{veevaAuth:_0x2a705d,timeZone:_0x3c0022,attachmentLogId:_0x2d3950}=_0xb5cbf7;try{const _0x5ede8e=(0x0,veeva_request_utils_1[_0x1e23f6(0x134)])(new veeva_auth_1[(_0x1e23f6(0x13c))](_0x2a705d,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x5c24e3=await salesforce_auth_1[_0x1e23f6(0x169)][_0x1e23f6(0x152)](),_0x36671d=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x1e23f6(0x169))](_0x5c24e3)),_0x42ba4d=new logger_1[(_0x1e23f6(0x156))](_0x36671d,_0x3c0022,_0x2d3950),_0x4191ca=_0x1e23f6(0x15c)+(0x0,shortid_1['default'])();await(0x0,fs_util_1['makeDir'])(_0x4191ca);const _0x55a097=new rollback_service_1[(_0x1e23f6(0x142))]({..._0xb5cbf7,'connectionVeeva':_0x5ede8e,'connectionSalesforce':_0x36671d,'logger':_0x42ba4d,'tempFolder':_0x4191ca,'instanceUrl':_0x5c24e3[_0x1e23f6(0x14f)]});return _0x55a097[_0x1e23f6(0x12e)]()[_0x1e23f6(0x12c)](()=>(0x0,promises_1['rm'])(_0x4191ca,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x1e23f6(0x13d)]};}catch(_0x38caa8){return{'responseStatus':status_enums_1[_0x1e23f6(0x15e)][_0x1e23f6(0x166)],'responseMessage':_0x38caa8[_0x1e23f6(0x157)]};}}};__decorate([(0x0,core_1['Post'])('snapshot'),__param(0x0,core_1[a347_0x125cc9(0x15f)][a347_0x125cc9(0x13f)]()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(a347_0x125cc9(0x13b),Promise)],VeevaVaultController['prototype'],a347_0x125cc9(0x16b),null),__decorate([(0x0,core_1[a347_0x125cc9(0x16f)])(a347_0x125cc9(0x14b)),__param(0x0,core_1['param'][a347_0x125cc9(0x13f)]()),__metadata('design:type',Function),__metadata(a347_0x125cc9(0x151),[Object]),__metadata(a347_0x125cc9(0x13b),Promise)],VeevaVaultController[a347_0x125cc9(0x153)],a347_0x125cc9(0x15d),null),__decorate([(0x0,core_1[a347_0x125cc9(0x16f)])(a347_0x125cc9(0x150)),__param(0x0,core_1[a347_0x125cc9(0x15f)][a347_0x125cc9(0x13f)]()),__metadata(a347_0x125cc9(0x158),Function),__metadata(a347_0x125cc9(0x151),[Object]),__metadata(a347_0x125cc9(0x13b),Promise)],VeevaVaultController['prototype'],a347_0x125cc9(0x132),null),__decorate([(0x0,core_1[a347_0x125cc9(0x16f)])(a347_0x125cc9(0x154)),__param(0x0,core_1[a347_0x125cc9(0x15f)][a347_0x125cc9(0x13f)]()),__metadata(a347_0x125cc9(0x158),Function),__metadata('design:paramtypes',[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a347_0x125cc9(0x153)],'rollback',null),VeevaVaultController=__decorate([(0x0,core_1[a347_0x125cc9(0x170)])(a347_0x125cc9(0x160)),(0x0,core_1[a347_0x125cc9(0x168)])(a347_0x125cc9(0x165))],VeevaVaultController),exports[a347_0x125cc9(0x174)]=VeevaVaultController;