const a319_0x119504=a319_0x2365;(function(_0x5f002f,_0x5a0338){const _0x498b63=a319_0x2365,_0x55ea6e=_0x5f002f();while(!![]){try{const _0x32c391=parseInt(_0x498b63(0x171))/0x1*(-parseInt(_0x498b63(0x147))/0x2)+-parseInt(_0x498b63(0x143))/0x3*(-parseInt(_0x498b63(0x162))/0x4)+parseInt(_0x498b63(0x159))/0x5+parseInt(_0x498b63(0x174))/0x6+parseInt(_0x498b63(0x161))/0x7+-parseInt(_0x498b63(0x182))/0x8+parseInt(_0x498b63(0x157))/0x9;if(_0x32c391===_0x5a0338)break;else _0x55ea6e['push'](_0x55ea6e['shift']());}catch(_0x6bc525){_0x55ea6e['push'](_0x55ea6e['shift']());}}}(a319_0x530e,0xe1ffe));const a319_0x836fc1=(function(){let _0x364d0e=!![];return function(_0x479e9e,_0x1a1c30){const _0x28a02b=_0x364d0e?function(){if(_0x1a1c30){const _0x391928=_0x1a1c30['apply'](_0x479e9e,arguments);return _0x1a1c30=null,_0x391928;}}:function(){};return _0x364d0e=![],_0x28a02b;};}()),a319_0x20b636=a319_0x836fc1(this,function(){const _0x20c5ea=a319_0x2365;return a319_0x20b636[_0x20c5ea(0x16f)]()['search']('(((.+)+)+)+$')[_0x20c5ea(0x16f)]()[_0x20c5ea(0x15f)](a319_0x20b636)[_0x20c5ea(0x15e)]('(((.+)+)+)+$');});a319_0x20b636();'use strict';var __decorate=this&&this[a319_0x119504(0x16d)]||function(_0x356554,_0x30a178,_0x1b7d5b,_0x543ec4){const _0x590c16=a319_0x119504;var _0x57f087=arguments['length'],_0x38070f=_0x57f087<0x3?_0x30a178:_0x543ec4===null?_0x543ec4=Object[_0x590c16(0x149)](_0x30a178,_0x1b7d5b):_0x543ec4,_0x1702e0;if(typeof Reflect===_0x590c16(0x181)&&typeof Reflect['decorate']==='function')_0x38070f=Reflect['decorate'](_0x356554,_0x30a178,_0x1b7d5b,_0x543ec4);else{for(var _0x539910=_0x356554['length']-0x1;_0x539910>=0x0;_0x539910--)if(_0x1702e0=_0x356554[_0x539910])_0x38070f=(_0x57f087<0x3?_0x1702e0(_0x38070f):_0x57f087>0x3?_0x1702e0(_0x30a178,_0x1b7d5b,_0x38070f):_0x1702e0(_0x30a178,_0x1b7d5b))||_0x38070f;}return _0x57f087>0x3&&_0x38070f&&Object[_0x590c16(0x17e)](_0x30a178,_0x1b7d5b,_0x38070f),_0x38070f;},__metadata=this&&this[a319_0x119504(0x163)]||function(_0x4bbe3e,_0x100a7c){const _0x391feb=a319_0x119504;if(typeof Reflect===_0x391feb(0x181)&&typeof Reflect[_0x391feb(0x14e)]===_0x391feb(0x153))return Reflect[_0x391feb(0x14e)](_0x4bbe3e,_0x100a7c);},__param=this&&this[a319_0x119504(0x14f)]||function(_0xcd7bd0,_0x8501f1){return function(_0x3d1e33,_0x2a108b){_0x8501f1(_0x3d1e33,_0x2a108b,_0xcd7bd0);};},__importDefault=this&&this[a319_0x119504(0x146)]||function(_0x494e68){const _0x601973=a319_0x119504;return _0x494e68&&_0x494e68[_0x601973(0x176)]?_0x494e68:{'default':_0x494e68};};function a319_0x2365(_0x1b385d,_0x46b61c){const _0x4b12d7=a319_0x530e();return a319_0x2365=function(_0x20b636,_0x836fc1){_0x20b636=_0x20b636-0x13f;let _0x530eb5=_0x4b12d7[_0x20b636];return _0x530eb5;},a319_0x2365(_0x1b385d,_0x46b61c);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a319_0x119504(0x14d)]=void 0x0;const core_1=require('../../core'),dependency_service_1=require('./services/dependency.service'),snapshot_service_1=require(a319_0x119504(0x168)),deploy_service_1=require(a319_0x119504(0x141)),veeva_request_utils_1=require(a319_0x119504(0x140)),status_enums_1=require('./enums/status.enums'),shortid_1=__importDefault(require(a319_0x119504(0x144))),fs_util_1=require(a319_0x119504(0x16b)),logger_1=require('./classes/logger'),promises_1=require(a319_0x119504(0x14b)),base_veeva_error_1=require('./classes/errors/base-veeva-error'),salesforce_request_utils_1=require(a319_0x119504(0x15b)),veeva_auth_1=require(a319_0x119504(0x169)),salesforce_auth_1=require('./classes/auth/salesforce-auth'),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;function a319_0x530e(){const _0xfbc29b=['param','6310248lcUjoo','10524PEcgJJ','__metadata','getAuthDetails','message','getMessages','doSnapshot','./services/snapshot.service','./classes/auth/veeva-auth','design:returntype','./utils/fs-util','DeployService','__decorate','prototype','toString','then','252169iZPivT','AppResponseStatus','deployFromBranch','2393022mrpoHj','FAILURE','__esModule','execute','default','body','Logger','Controller','design:paramtypes','SalesforceAuth','defineProperty','veeva-vault','SnapshotService','object','8586320JbRtEK','join','./utils/veeva-request.utils','./services/deploy.service','VeevaAuth','813vIhnBQ','shortid','finally','__importDefault','14ooBrcW','DependencyService','getOwnPropertyDescriptor','retrieveDependency','fs/promises','snapshot','VeevaVaultController','metadata','__param','deploy','instanceUrl','dependency','function','createSalesforceRequest','SUCCESS','temp/veeva/deploy_','14328810anNfIh','createVeevaRequest','793875BEMeri','Post','./utils/salesforce-request.utils','makeDir','design:type','search','constructor'];a319_0x530e=function(){return _0xfbc29b;};return a319_0x530e();}let VeevaVaultController=class VeevaVaultController{async[a319_0x119504(0x167)](_0x503293){const _0x571fd5=a319_0x119504,{veevaAuth:_0x33af9b,timeZone:_0x5a6391,attachmentLogId:_0x3cb757}=_0x503293;try{const _0x2ce8fe=(0x0,veeva_request_utils_1[_0x571fd5(0x158)])(new veeva_auth_1[(_0x571fd5(0x142))](_0x33af9b,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x1765d9=await salesforce_auth_1[_0x571fd5(0x17d)][_0x571fd5(0x164)](),_0x4f726e=(0x0,salesforce_request_utils_1[_0x571fd5(0x154)])(new salesforce_auth_1[(_0x571fd5(0x17d))](_0x1765d9)),_0x5f2534=new logger_1[(_0x571fd5(0x17a))](_0x4f726e,_0x5a6391,_0x3cb757),_0x57af3d=new snapshot_service_1[(_0x571fd5(0x180))](_0x503293,_0x4f726e,_0x2ce8fe,_0x5f2534);return _0x57af3d[_0x571fd5(0x177)]()[_0x571fd5(0x170)](),{'responseStatus':status_enums_1[_0x571fd5(0x172)][_0x571fd5(0x155)]};}catch(_0x4c3f57){return{'responseStatus':status_enums_1[_0x571fd5(0x172)][_0x571fd5(0x175)],'responseMessage':_0x4c3f57[_0x571fd5(0x165)]};}}async[a319_0x119504(0x173)](_0x3c7130){const _0x36165b=a319_0x119504,{veevaAuth:_0x51bd92,timeZone:_0xb7811e,attachmentLogId:_0x126e2c}=_0x3c7130;try{const _0x454868=(0x0,veeva_request_utils_1[_0x36165b(0x158)])(new veeva_auth_1[(_0x36165b(0x142))](_0x51bd92,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x5f378f=await salesforce_auth_1[_0x36165b(0x17d)][_0x36165b(0x164)](),_0x338456=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x36165b(0x17d))](_0x5f378f)),_0x514fbc=new logger_1[(_0x36165b(0x17a))](_0x338456,_0xb7811e,_0x126e2c),_0x233c77=_0x36165b(0x156)+(0x0,shortid_1[_0x36165b(0x178)])();await(0x0,fs_util_1[_0x36165b(0x15c)])(_0x233c77);const _0x3bf48a=new deploy_service_1[(_0x36165b(0x16c))](_0x3c7130,_0x338456,_0x454868,_0x514fbc,_0x233c77,_0x5f378f[_0x36165b(0x151)]);return _0x3bf48a['execute']()[_0x36165b(0x145)](()=>(0x0,promises_1['rm'])(_0x233c77,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1['AppResponseStatus'][_0x36165b(0x155)]};}catch(_0x5eb72d){return{'responseStatus':status_enums_1[_0x36165b(0x172)][_0x36165b(0x175)],'responseMessage':_0x5eb72d[_0x36165b(0x165)]};}}async['retrieveDependency'](_0x3565e6){const _0x5077cc=a319_0x119504,{veevaAuth:_0xbd4378}=_0x3565e6;try{const _0x53d2b7=(0x0,veeva_request_utils_1[_0x5077cc(0x158)])(new veeva_auth_1[(_0x5077cc(0x142))](_0xbd4378)),_0x3bdc4c=await salesforce_auth_1[_0x5077cc(0x17d)][_0x5077cc(0x164)](),_0x1bed92=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1['SalesforceAuth'](_0x3bdc4c)),_0x370c69=new dependency_service_1[(_0x5077cc(0x148))](_0x3565e6,_0x1bed92,_0x53d2b7);return await _0x370c69['execute']();}catch(_0x3f746d){const _0x1b48e1=_0x3f746d instanceof base_veeva_error_1['BaseVeevaError']?_0x3f746d[_0x5077cc(0x166)]()[_0x5077cc(0x13f)]('\x0a'):_0x3f746d[_0x5077cc(0x165)];return{'responseStatus':status_enums_1['AppResponseStatus'][_0x5077cc(0x175)],'responseMessage':_0x1b48e1};}}};__decorate([(0x0,core_1[a319_0x119504(0x15a)])(a319_0x119504(0x14c)),__param(0x0,core_1[a319_0x119504(0x160)][a319_0x119504(0x179)]()),__metadata('design:type',Function),__metadata(a319_0x119504(0x17c),[Object]),__metadata(a319_0x119504(0x16a),Promise)],VeevaVaultController[a319_0x119504(0x16e)],a319_0x119504(0x167),null),__decorate([(0x0,core_1[a319_0x119504(0x15a)])(a319_0x119504(0x150)),__param(0x0,core_1[a319_0x119504(0x160)][a319_0x119504(0x179)]()),__metadata(a319_0x119504(0x15d),Function),__metadata(a319_0x119504(0x17c),[Object]),__metadata(a319_0x119504(0x16a),Promise)],VeevaVaultController[a319_0x119504(0x16e)],a319_0x119504(0x173),null),__decorate([(0x0,core_1[a319_0x119504(0x15a)])(a319_0x119504(0x152)),__param(0x0,core_1[a319_0x119504(0x160)][a319_0x119504(0x179)]()),__metadata(a319_0x119504(0x15d),Function),__metadata(a319_0x119504(0x17c),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController['prototype'],a319_0x119504(0x14a),null),VeevaVaultController=__decorate([(0x0,core_1[a319_0x119504(0x17b)])(a319_0x119504(0x17f)),(0x0,core_1['Version'])('v1')],VeevaVaultController),exports['VeevaVaultController']=VeevaVaultController;