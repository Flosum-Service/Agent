const a347_0x33b71c=a347_0x993e;(function(_0x44c75f,_0x5f30d6){const _0x46d5f8=a347_0x993e,_0x37b75e=_0x44c75f();while(!![]){try{const _0x35dff9=parseInt(_0x46d5f8(0x12f))/0x1*(parseInt(_0x46d5f8(0x131))/0x2)+parseInt(_0x46d5f8(0x16a))/0x3*(parseInt(_0x46d5f8(0x143))/0x4)+parseInt(_0x46d5f8(0x12d))/0x5+parseInt(_0x46d5f8(0x153))/0x6+-parseInt(_0x46d5f8(0x13a))/0x7*(parseInt(_0x46d5f8(0x164))/0x8)+parseInt(_0x46d5f8(0x127))/0x9*(-parseInt(_0x46d5f8(0x151))/0xa)+parseInt(_0x46d5f8(0x12c))/0xb;if(_0x35dff9===_0x5f30d6)break;else _0x37b75e['push'](_0x37b75e['shift']());}catch(_0x55ceb7){_0x37b75e['push'](_0x37b75e['shift']());}}}(a347_0x3448,0xace0e));const a347_0x4ce129=(function(){let _0x5f0692=!![];return function(_0x53f029,_0x5e20de){const _0x493af0=_0x5f0692?function(){const _0x14d34f=a347_0x993e;if(_0x5e20de){const _0x2c4f89=_0x5e20de[_0x14d34f(0x158)](_0x53f029,arguments);return _0x5e20de=null,_0x2c4f89;}}:function(){};return _0x5f0692=![],_0x493af0;};}()),a347_0x30c6f5=a347_0x4ce129(this,function(){const _0xfdb0e=a347_0x993e;return a347_0x30c6f5['toString']()[_0xfdb0e(0x12b)](_0xfdb0e(0x130))[_0xfdb0e(0x165)]()[_0xfdb0e(0x154)](a347_0x30c6f5)[_0xfdb0e(0x12b)]('(((.+)+)+)+$');});function a347_0x3448(){const _0x119201=['retrieveDependency','./classes/errors/base-veeva-error','../../core','makeDir','__param','./services/snapshot.service','design:type','Post','AppResponseStatus','design:paramtypes','477VAjLRa','body','createVeevaRequest','./enums/status.enums','search','7464688bUHAjS','2579365UQkbaz','execute','503521tfnCsc','(((.+)+)+)+$','2YLPzCH','getMessages','decorate','defineProperty','VeevaAuth','doSnapshot','./services/dependency.service','VeevaVaultController','message','4781ZUzYHJ','temp/veeva/deploy_','./classes/loggers/logger','SalesforceAuth','veeva-vault','join','prototype','fs/promises','finally','28LIPbql','SUCCESS','deploy','./utils/salesforce-request.utils','design:returntype','metadata','rollback','__decorate','default','temp/veeva/rollback_','./classes/auth/salesforce-auth','object','Version','RollbackService','41450EwTCTf','./services/deploy.service','1626774HjojJe','constructor','__importDefault','BaseVeevaError','length','apply','__metadata','FAILURE','getOwnPropertyDescriptor','./services/rollback.service','dependency','getAuthDetails','instanceUrl','shortid','v1.1','__esModule','deployFromBranch','14312Ggsxkr','toString','function','createSalesforceRequest','Logger','param','77379KBnAUo'];a347_0x3448=function(){return _0x119201;};return a347_0x3448();}a347_0x30c6f5();'use strict';var __decorate=this&&this[a347_0x33b71c(0x14a)]||function(_0x4a8f0e,_0x541be6,_0x4b9a18,_0x3fc46b){const _0x2bf178=a347_0x33b71c;var _0x4a6c87=arguments[_0x2bf178(0x157)],_0x4481bb=_0x4a6c87<0x3?_0x541be6:_0x3fc46b===null?_0x3fc46b=Object[_0x2bf178(0x15b)](_0x541be6,_0x4b9a18):_0x3fc46b,_0x56af82;if(typeof Reflect===_0x2bf178(0x14e)&&typeof Reflect[_0x2bf178(0x133)]===_0x2bf178(0x166))_0x4481bb=Reflect[_0x2bf178(0x133)](_0x4a8f0e,_0x541be6,_0x4b9a18,_0x3fc46b);else{for(var _0x382690=_0x4a8f0e[_0x2bf178(0x157)]-0x1;_0x382690>=0x0;_0x382690--)if(_0x56af82=_0x4a8f0e[_0x382690])_0x4481bb=(_0x4a6c87<0x3?_0x56af82(_0x4481bb):_0x4a6c87>0x3?_0x56af82(_0x541be6,_0x4b9a18,_0x4481bb):_0x56af82(_0x541be6,_0x4b9a18))||_0x4481bb;}return _0x4a6c87>0x3&&_0x4481bb&&Object[_0x2bf178(0x134)](_0x541be6,_0x4b9a18,_0x4481bb),_0x4481bb;},__metadata=this&&this[a347_0x33b71c(0x159)]||function(_0x362014,_0x58e604){const _0xb86375=a347_0x33b71c;if(typeof Reflect===_0xb86375(0x14e)&&typeof Reflect[_0xb86375(0x148)]===_0xb86375(0x166))return Reflect[_0xb86375(0x148)](_0x362014,_0x58e604);},__param=this&&this[a347_0x33b71c(0x121)]||function(_0x181577,_0x24b7a4){return function(_0x5120f3,_0x52cb83){_0x24b7a4(_0x5120f3,_0x52cb83,_0x181577);};},__importDefault=this&&this[a347_0x33b71c(0x155)]||function(_0x3647c4){const _0x144ffa=a347_0x33b71c;return _0x3647c4&&_0x3647c4[_0x144ffa(0x162)]?_0x3647c4:{'default':_0x3647c4};};function a347_0x993e(_0xe014ae,_0x3a1ec2){const _0x5ef207=a347_0x3448();return a347_0x993e=function(_0x30c6f5,_0x4ce129){_0x30c6f5=_0x30c6f5-0x11e;let _0x344851=_0x5ef207[_0x30c6f5];return _0x344851;},a347_0x993e(_0xe014ae,_0x3a1ec2);}Object[a347_0x33b71c(0x134)](exports,'__esModule',{'value':!![]}),exports[a347_0x33b71c(0x138)]=void 0x0;const core_1=require(a347_0x33b71c(0x11f)),dependency_service_1=require(a347_0x33b71c(0x137)),snapshot_service_1=require(a347_0x33b71c(0x122)),deploy_service_1=require(a347_0x33b71c(0x152)),veeva_request_utils_1=require('./utils/veeva-request.utils'),status_enums_1=require(a347_0x33b71c(0x12a)),shortid_1=__importDefault(require(a347_0x33b71c(0x160))),fs_util_1=require('./utils/fs-util'),logger_1=require(a347_0x33b71c(0x13c)),promises_1=require(a347_0x33b71c(0x141)),base_veeva_error_1=require(a347_0x33b71c(0x11e)),salesforce_request_utils_1=require(a347_0x33b71c(0x146)),veeva_auth_1=require('./classes/auth/veeva-auth'),salesforce_auth_1=require(a347_0x33b71c(0x14d)),rollback_service_1=require(a347_0x33b71c(0x15c)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a347_0x33b71c(0x136)](_0x45bddf){const _0x129d82=a347_0x33b71c,{veevaAuth:_0x171f18,timeZone:_0x204142,attachmentLogId:_0xd8b8e2}=_0x45bddf;try{const _0x4da7ac=(0x0,veeva_request_utils_1[_0x129d82(0x129)])(new veeva_auth_1[(_0x129d82(0x135))](_0x171f18,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x3184ea=await salesforce_auth_1[_0x129d82(0x13d)][_0x129d82(0x15e)](),_0x27c48b=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1['SalesforceAuth'](_0x3184ea)),_0x434be8=new logger_1[(_0x129d82(0x168))](_0x27c48b,_0x204142,_0xd8b8e2),_0x2be62a=new snapshot_service_1['SnapshotService'](_0x45bddf,_0x27c48b,_0x4da7ac,_0x434be8);return _0x2be62a[_0x129d82(0x12e)]()['then'](),{'responseStatus':status_enums_1[_0x129d82(0x125)]['SUCCESS']};}catch(_0x3d6ca1){return{'responseStatus':status_enums_1[_0x129d82(0x125)][_0x129d82(0x15a)],'responseMessage':_0x3d6ca1[_0x129d82(0x139)]};}}async[a347_0x33b71c(0x163)](_0x1401d7){const _0x56c269=a347_0x33b71c,{veevaAuth:_0x587d45,timeZone:_0x38ae68,attachmentLogId:_0x75d97e}=_0x1401d7;try{const _0x250ddd=(0x0,veeva_request_utils_1[_0x56c269(0x129)])(new veeva_auth_1['VeevaAuth'](_0x587d45,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x515a5f=await salesforce_auth_1['SalesforceAuth'][_0x56c269(0x15e)](),_0x37bf5c=(0x0,salesforce_request_utils_1[_0x56c269(0x167)])(new salesforce_auth_1[(_0x56c269(0x13d))](_0x515a5f)),_0x400096=new logger_1[(_0x56c269(0x168))](_0x37bf5c,_0x38ae68,_0x75d97e),_0x1eb3a3=_0x56c269(0x13b)+(0x0,shortid_1['default'])();await(0x0,fs_util_1[_0x56c269(0x120)])(_0x1eb3a3);const _0xbb963f=new deploy_service_1['DeployService'](_0x1401d7,_0x37bf5c,_0x250ddd,_0x400096,_0x1eb3a3,_0x515a5f[_0x56c269(0x15f)]);return _0xbb963f[_0x56c269(0x12e)]()[_0x56c269(0x142)](()=>(0x0,promises_1['rm'])(_0x1eb3a3,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x56c269(0x125)][_0x56c269(0x144)]};}catch(_0x273f5){return{'responseStatus':status_enums_1[_0x56c269(0x125)]['FAILURE'],'responseMessage':_0x273f5[_0x56c269(0x139)]};}}async[a347_0x33b71c(0x16b)](_0x57738c){const _0x3b6b6b=a347_0x33b71c,{veevaAuth:_0x29a1e2}=_0x57738c;try{const _0x5b38fb=(0x0,veeva_request_utils_1[_0x3b6b6b(0x129)])(new veeva_auth_1[(_0x3b6b6b(0x135))](_0x29a1e2)),_0x4786c6=await salesforce_auth_1[_0x3b6b6b(0x13d)][_0x3b6b6b(0x15e)](),_0x4546a7=(0x0,salesforce_request_utils_1[_0x3b6b6b(0x167)])(new salesforce_auth_1[(_0x3b6b6b(0x13d))](_0x4786c6)),_0x3915a0=new dependency_service_1['DependencyService'](_0x57738c,_0x4546a7,_0x5b38fb);return await _0x3915a0[_0x3b6b6b(0x12e)]();}catch(_0x11a620){const _0x36c7a7=_0x11a620 instanceof base_veeva_error_1[_0x3b6b6b(0x156)]?_0x11a620[_0x3b6b6b(0x132)]()[_0x3b6b6b(0x13f)]('\x0a'):_0x11a620[_0x3b6b6b(0x139)];return{'responseStatus':status_enums_1[_0x3b6b6b(0x125)][_0x3b6b6b(0x15a)],'responseMessage':_0x36c7a7};}}async[a347_0x33b71c(0x149)](_0x54fa61){const _0x4a4d5f=a347_0x33b71c,{veevaAuth:_0x1db0bd,timeZone:_0x22b598,attachmentLogId:_0x3468a3}=_0x54fa61;try{const _0x1f9fad=(0x0,veeva_request_utils_1[_0x4a4d5f(0x129)])(new veeva_auth_1[(_0x4a4d5f(0x135))](_0x1db0bd,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x3f9c23=await salesforce_auth_1[_0x4a4d5f(0x13d)][_0x4a4d5f(0x15e)](),_0x5e046f=(0x0,salesforce_request_utils_1[_0x4a4d5f(0x167)])(new salesforce_auth_1[(_0x4a4d5f(0x13d))](_0x3f9c23)),_0xb81b5d=new logger_1[(_0x4a4d5f(0x168))](_0x5e046f,_0x22b598,_0x3468a3),_0x14219e=_0x4a4d5f(0x14c)+(0x0,shortid_1[_0x4a4d5f(0x14b)])();await(0x0,fs_util_1['makeDir'])(_0x14219e);const _0x448d7c=new rollback_service_1[(_0x4a4d5f(0x150))]({..._0x54fa61,'connectionVeeva':_0x1f9fad,'connectionSalesforce':_0x5e046f,'logger':_0xb81b5d,'tempFolder':_0x14219e,'instanceUrl':_0x3f9c23[_0x4a4d5f(0x15f)]});return _0x448d7c[_0x4a4d5f(0x12e)]()[_0x4a4d5f(0x142)](()=>(0x0,promises_1['rm'])(_0x14219e,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x4a4d5f(0x125)][_0x4a4d5f(0x144)]};}catch(_0x167888){return{'responseStatus':status_enums_1[_0x4a4d5f(0x125)][_0x4a4d5f(0x15a)],'responseMessage':_0x167888[_0x4a4d5f(0x139)]};}}};__decorate([(0x0,core_1[a347_0x33b71c(0x124)])('snapshot'),__param(0x0,core_1['param'][a347_0x33b71c(0x128)]()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(a347_0x33b71c(0x147),Promise)],VeevaVaultController['prototype'],a347_0x33b71c(0x136),null),__decorate([(0x0,core_1[a347_0x33b71c(0x124)])(a347_0x33b71c(0x145)),__param(0x0,core_1[a347_0x33b71c(0x169)][a347_0x33b71c(0x128)]()),__metadata(a347_0x33b71c(0x123),Function),__metadata(a347_0x33b71c(0x126),[Object]),__metadata(a347_0x33b71c(0x147),Promise)],VeevaVaultController[a347_0x33b71c(0x140)],a347_0x33b71c(0x163),null),__decorate([(0x0,core_1['Post'])(a347_0x33b71c(0x15d)),__param(0x0,core_1[a347_0x33b71c(0x169)]['body']()),__metadata(a347_0x33b71c(0x123),Function),__metadata('design:paramtypes',[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a347_0x33b71c(0x140)],'retrieveDependency',null),__decorate([(0x0,core_1['Post'])(a347_0x33b71c(0x149)),__param(0x0,core_1[a347_0x33b71c(0x169)][a347_0x33b71c(0x128)]()),__metadata(a347_0x33b71c(0x123),Function),__metadata('design:paramtypes',[Object]),__metadata(a347_0x33b71c(0x147),Promise)],VeevaVaultController[a347_0x33b71c(0x140)],a347_0x33b71c(0x149),null),VeevaVaultController=__decorate([(0x0,core_1['Controller'])(a347_0x33b71c(0x13e)),(0x0,core_1[a347_0x33b71c(0x14f)])(a347_0x33b71c(0x161))],VeevaVaultController),exports[a347_0x33b71c(0x138)]=VeevaVaultController;