const a347_0x3ac45d=a347_0xd132;(function(_0x127a63,_0x5f125f){const _0x411ede=a347_0xd132,_0x2e26b4=_0x127a63();while(!![]){try{const _0x1624b7=-parseInt(_0x411ede(0x1f4))/0x1*(parseInt(_0x411ede(0x1ef))/0x2)+-parseInt(_0x411ede(0x1f7))/0x3+parseInt(_0x411ede(0x232))/0x4*(-parseInt(_0x411ede(0x207))/0x5)+-parseInt(_0x411ede(0x22d))/0x6*(-parseInt(_0x411ede(0x1f9))/0x7)+parseInt(_0x411ede(0x1fc))/0x8*(parseInt(_0x411ede(0x1f5))/0x9)+-parseInt(_0x411ede(0x215))/0xa*(-parseInt(_0x411ede(0x211))/0xb)+-parseInt(_0x411ede(0x225))/0xc*(-parseInt(_0x411ede(0x222))/0xd);if(_0x1624b7===_0x5f125f)break;else _0x2e26b4['push'](_0x2e26b4['shift']());}catch(_0x141565){_0x2e26b4['push'](_0x2e26b4['shift']());}}}(a347_0x518d,0xa133f));function a347_0x518d(){const _0x584d58=['deployFromBranch','instanceUrl','AppResponseStatus','length','16328URiWSI','deploy','makeDir','1512bQpOHQ','./classes/loggers/logger','function','./enums/status.enums','toString','createSalesforceRequest','apply','FAILURE','55758qriIVa','param','SUCCESS','__importDefault','__esModule','247448miXxlO','retrieveDependency','getMessages','./classes/auth/veeva-auth','message','getAuthDetails','Version','object','2676sfkIFN','join','search','fs/promises','design:returntype','638ykFSRi','75888GxIkVs','VeevaVaultController','132138tDOkmr','../../core','784aLbTQQ','design:type','temp/veeva/rollback_','664xiVjIO','default','veeva-vault','shortid','./utils/fs-util','finally','defineProperty','prototype','snapshot','./services/dependency.service','doSnapshot','85exBgFL','SalesforceAuth','execute','decorate','body','__metadata','RollbackService','Logger','getOwnPropertyDescriptor','(((.+)+)+)+$','12837LCUzxU','VeevaAuth','design:paramtypes','Post','6090cOgffY','v1.1','createVeevaRequest','rollback','constructor','BaseVeevaError','metadata','./services/deploy.service','DeployService'];a347_0x518d=function(){return _0x584d58;};return a347_0x518d();}function a347_0xd132(_0x344a9e,_0x5f46cd){const _0x1bde87=a347_0x518d();return a347_0xd132=function(_0x489c53,_0x326cfd){_0x489c53=_0x489c53-0x1ea;let _0x518da6=_0x1bde87[_0x489c53];return _0x518da6;},a347_0xd132(_0x344a9e,_0x5f46cd);}const a347_0x326cfd=(function(){let _0x415c61=!![];return function(_0x109b10,_0x4f6a4d){const _0x53f64c=_0x415c61?function(){const _0x388c60=a347_0xd132;if(_0x4f6a4d){const _0x4e3735=_0x4f6a4d[_0x388c60(0x22b)](_0x109b10,arguments);return _0x4f6a4d=null,_0x4e3735;}}:function(){};return _0x415c61=![],_0x53f64c;};}()),a347_0x489c53=a347_0x326cfd(this,function(){const _0x1f08ed=a347_0xd132;return a347_0x489c53['toString']()[_0x1f08ed(0x1f1)](_0x1f08ed(0x210))[_0x1f08ed(0x229)]()[_0x1f08ed(0x219)](a347_0x489c53)[_0x1f08ed(0x1f1)]('(((.+)+)+)+$');});a347_0x489c53();'use strict';var __decorate=this&&this['__decorate']||function(_0x531192,_0x36fe0a,_0x157179,_0x365ac1){const _0x1031b4=a347_0xd132;var _0x4f0047=arguments['length'],_0x5ccb34=_0x4f0047<0x3?_0x36fe0a:_0x365ac1===null?_0x365ac1=Object[_0x1031b4(0x20f)](_0x36fe0a,_0x157179):_0x365ac1,_0x41254b;if(typeof Reflect===_0x1031b4(0x1ee)&&typeof Reflect['decorate']==='function')_0x5ccb34=Reflect[_0x1031b4(0x20a)](_0x531192,_0x36fe0a,_0x157179,_0x365ac1);else{for(var _0x39ea43=_0x531192[_0x1031b4(0x221)]-0x1;_0x39ea43>=0x0;_0x39ea43--)if(_0x41254b=_0x531192[_0x39ea43])_0x5ccb34=(_0x4f0047<0x3?_0x41254b(_0x5ccb34):_0x4f0047>0x3?_0x41254b(_0x36fe0a,_0x157179,_0x5ccb34):_0x41254b(_0x36fe0a,_0x157179))||_0x5ccb34;}return _0x4f0047>0x3&&_0x5ccb34&&Object[_0x1031b4(0x202)](_0x36fe0a,_0x157179,_0x5ccb34),_0x5ccb34;},__metadata=this&&this[a347_0x3ac45d(0x20c)]||function(_0x1df09d,_0xfce93){const _0x226fda=a347_0x3ac45d;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x226fda(0x227))return Reflect[_0x226fda(0x21b)](_0x1df09d,_0xfce93);},__param=this&&this['__param']||function(_0x296574,_0xb6915f){return function(_0x529d65,_0x1f7254){_0xb6915f(_0x529d65,_0x1f7254,_0x296574);};},__importDefault=this&&this[a347_0x3ac45d(0x230)]||function(_0x26d91c){const _0x17d9cc=a347_0x3ac45d;return _0x26d91c&&_0x26d91c[_0x17d9cc(0x231)]?_0x26d91c:{'default':_0x26d91c};};Object[a347_0x3ac45d(0x202)](exports,a347_0x3ac45d(0x231),{'value':!![]}),exports['VeevaVaultController']=void 0x0;const core_1=require(a347_0x3ac45d(0x1f8)),dependency_service_1=require(a347_0x3ac45d(0x205)),snapshot_service_1=require('./services/snapshot.service'),deploy_service_1=require(a347_0x3ac45d(0x21c)),veeva_request_utils_1=require('./utils/veeva-request.utils'),status_enums_1=require(a347_0x3ac45d(0x228)),shortid_1=__importDefault(require(a347_0x3ac45d(0x1ff))),fs_util_1=require(a347_0x3ac45d(0x200)),logger_1=require(a347_0x3ac45d(0x226)),promises_1=require(a347_0x3ac45d(0x1f2)),base_veeva_error_1=require('./classes/errors/base-veeva-error'),salesforce_request_utils_1=require('./utils/salesforce-request.utils'),veeva_auth_1=require(a347_0x3ac45d(0x1ea)),salesforce_auth_1=require('./classes/auth/salesforce-auth'),rollback_service_1=require('./services/rollback.service'),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;let VeevaVaultController=class VeevaVaultController{async[a347_0x3ac45d(0x206)](_0x46ec52){const _0x377dba=a347_0x3ac45d,{veevaAuth:_0x4fbcf3,timeZone:_0x305acf,attachmentLogId:_0x186c3d}=_0x46ec52;try{const _0x3b6839=(0x0,veeva_request_utils_1[_0x377dba(0x217)])(new veeva_auth_1[(_0x377dba(0x212))](_0x4fbcf3,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x395495=await salesforce_auth_1[_0x377dba(0x208)][_0x377dba(0x1ec)](),_0xb74479=(0x0,salesforce_request_utils_1[_0x377dba(0x22a)])(new salesforce_auth_1[(_0x377dba(0x208))](_0x395495)),_0x118a6e=new logger_1[(_0x377dba(0x20e))](_0xb74479,_0x305acf,_0x186c3d),_0x3ebefb=new snapshot_service_1['SnapshotService'](_0x46ec52,_0xb74479,_0x3b6839,_0x118a6e);return _0x3ebefb[_0x377dba(0x209)]()['then'](),{'responseStatus':status_enums_1[_0x377dba(0x220)][_0x377dba(0x22f)]};}catch(_0x33cf8b){return{'responseStatus':status_enums_1[_0x377dba(0x220)]['FAILURE'],'responseMessage':_0x33cf8b[_0x377dba(0x1eb)]};}}async[a347_0x3ac45d(0x21e)](_0x425a08){const _0x5ad951=a347_0x3ac45d,{veevaAuth:_0x5806ab,timeZone:_0x3c75d9,attachmentLogId:_0x4431ec}=_0x425a08;try{const _0x4ab8e0=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x5ad951(0x212))](_0x5806ab,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x434531=await salesforce_auth_1[_0x5ad951(0x208)][_0x5ad951(0x1ec)](),_0x5a7c8a=(0x0,salesforce_request_utils_1[_0x5ad951(0x22a)])(new salesforce_auth_1[(_0x5ad951(0x208))](_0x434531)),_0x534dc4=new logger_1['Logger'](_0x5a7c8a,_0x3c75d9,_0x4431ec),_0x421449='temp/veeva/deploy_'+(0x0,shortid_1[_0x5ad951(0x1fd)])();await(0x0,fs_util_1[_0x5ad951(0x224)])(_0x421449);const _0x23ae72=new deploy_service_1[(_0x5ad951(0x21d))](_0x425a08,_0x5a7c8a,_0x4ab8e0,_0x534dc4,_0x421449,_0x434531[_0x5ad951(0x21f)]);return _0x23ae72[_0x5ad951(0x209)]()[_0x5ad951(0x201)](()=>(0x0,promises_1['rm'])(_0x421449,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x5ad951(0x220)][_0x5ad951(0x22f)]};}catch(_0x4ec60b){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x5ad951(0x22c)],'responseMessage':_0x4ec60b[_0x5ad951(0x1eb)]};}}async[a347_0x3ac45d(0x233)](_0x58954e){const _0x391e44=a347_0x3ac45d,{veevaAuth:_0x5be0b0}=_0x58954e;try{const _0xffdde0=(0x0,veeva_request_utils_1[_0x391e44(0x217)])(new veeva_auth_1[(_0x391e44(0x212))](_0x5be0b0)),_0x86b2e0=await salesforce_auth_1[_0x391e44(0x208)]['getAuthDetails'](),_0x204670=(0x0,salesforce_request_utils_1[_0x391e44(0x22a)])(new salesforce_auth_1[(_0x391e44(0x208))](_0x86b2e0)),_0x12f5e8=new dependency_service_1['DependencyService'](_0x58954e,_0x204670,_0xffdde0);return await _0x12f5e8[_0x391e44(0x209)]();}catch(_0x484abe){const _0x277082=_0x484abe instanceof base_veeva_error_1[_0x391e44(0x21a)]?_0x484abe[_0x391e44(0x234)]()[_0x391e44(0x1f0)]('\x0a'):_0x484abe[_0x391e44(0x1eb)];return{'responseStatus':status_enums_1[_0x391e44(0x220)]['FAILURE'],'responseMessage':_0x277082};}}async[a347_0x3ac45d(0x218)](_0x2218b8){const _0x3730eb=a347_0x3ac45d,{veevaAuth:_0x5be219,timeZone:_0x251368,attachmentLogId:_0x5a6ec4}=_0x2218b8;try{const _0x4e015d=(0x0,veeva_request_utils_1[_0x3730eb(0x217)])(new veeva_auth_1['VeevaAuth'](_0x5be219,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x240be8=await salesforce_auth_1[_0x3730eb(0x208)][_0x3730eb(0x1ec)](),_0x174d9b=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x3730eb(0x208))](_0x240be8)),_0x1f8558=new logger_1[(_0x3730eb(0x20e))](_0x174d9b,_0x251368,_0x5a6ec4),_0x2caaa2=_0x3730eb(0x1fb)+(0x0,shortid_1[_0x3730eb(0x1fd)])();await(0x0,fs_util_1[_0x3730eb(0x224)])(_0x2caaa2);const _0x76eb1=new rollback_service_1[(_0x3730eb(0x20d))]({..._0x2218b8,'connectionVeeva':_0x4e015d,'connectionSalesforce':_0x174d9b,'logger':_0x1f8558,'tempFolder':_0x2caaa2,'instanceUrl':_0x240be8['instanceUrl']});return _0x76eb1[_0x3730eb(0x209)]()[_0x3730eb(0x201)](()=>(0x0,promises_1['rm'])(_0x2caaa2,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x3730eb(0x220)]['SUCCESS']};}catch(_0x3f35ef){return{'responseStatus':status_enums_1[_0x3730eb(0x220)][_0x3730eb(0x22c)],'responseMessage':_0x3f35ef['message']};}}};__decorate([(0x0,core_1[a347_0x3ac45d(0x214)])(a347_0x3ac45d(0x204)),__param(0x0,core_1['param'][a347_0x3ac45d(0x20b)]()),__metadata(a347_0x3ac45d(0x1fa),Function),__metadata(a347_0x3ac45d(0x213),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController['prototype'],a347_0x3ac45d(0x206),null),__decorate([(0x0,core_1[a347_0x3ac45d(0x214)])(a347_0x3ac45d(0x223)),__param(0x0,core_1[a347_0x3ac45d(0x22e)][a347_0x3ac45d(0x20b)]()),__metadata('design:type',Function),__metadata(a347_0x3ac45d(0x213),[Object]),__metadata(a347_0x3ac45d(0x1f3),Promise)],VeevaVaultController[a347_0x3ac45d(0x203)],a347_0x3ac45d(0x21e),null),__decorate([(0x0,core_1[a347_0x3ac45d(0x214)])('dependency'),__param(0x0,core_1[a347_0x3ac45d(0x22e)][a347_0x3ac45d(0x20b)]()),__metadata('design:type',Function),__metadata(a347_0x3ac45d(0x213),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController['prototype'],a347_0x3ac45d(0x233),null),__decorate([(0x0,core_1[a347_0x3ac45d(0x214)])(a347_0x3ac45d(0x218)),__param(0x0,core_1['param'][a347_0x3ac45d(0x20b)]()),__metadata('design:type',Function),__metadata(a347_0x3ac45d(0x213),[Object]),__metadata(a347_0x3ac45d(0x1f3),Promise)],VeevaVaultController['prototype'],a347_0x3ac45d(0x218),null),VeevaVaultController=__decorate([(0x0,core_1['Controller'])(a347_0x3ac45d(0x1fe)),(0x0,core_1[a347_0x3ac45d(0x1ed)])(a347_0x3ac45d(0x216))],VeevaVaultController),exports[a347_0x3ac45d(0x1f6)]=VeevaVaultController;