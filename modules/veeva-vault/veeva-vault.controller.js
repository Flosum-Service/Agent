const a415_0x6af628=a415_0x2677;(function(_0x40389c,_0x3c6fa8){const _0x32f660=a415_0x2677,_0x1ae739=_0x40389c();while(!![]){try{const _0x39de35=parseInt(_0x32f660(0x1ad))/0x1+parseInt(_0x32f660(0x1c4))/0x2+-parseInt(_0x32f660(0x18c))/0x3+parseInt(_0x32f660(0x1b6))/0x4*(-parseInt(_0x32f660(0x1bb))/0x5)+-parseInt(_0x32f660(0x18d))/0x6*(-parseInt(_0x32f660(0x1c6))/0x7)+-parseInt(_0x32f660(0x19a))/0x8*(parseInt(_0x32f660(0x1b9))/0x9)+-parseInt(_0x32f660(0x1a9))/0xa*(-parseInt(_0x32f660(0x196))/0xb);if(_0x39de35===_0x3c6fa8)break;else _0x1ae739['push'](_0x1ae739['shift']());}catch(_0x1e6add){_0x1ae739['push'](_0x1ae739['shift']());}}}(a415_0x40de,0xd95f1));const a415_0x3cac2b=(function(){let _0x7b93e=!![];return function(_0x3895e6,_0x146a02){const _0x52429f=_0x7b93e?function(){const _0x5cdd6c=a415_0x2677;if(_0x146a02){const _0x245a10=_0x146a02[_0x5cdd6c(0x1b0)](_0x3895e6,arguments);return _0x146a02=null,_0x245a10;}}:function(){};return _0x7b93e=![],_0x52429f;};}()),a415_0xe70b3f=a415_0x3cac2b(this,function(){const _0x40eec8=a415_0x2677;return a415_0xe70b3f[_0x40eec8(0x1cb)]()[_0x40eec8(0x19b)]('(((.+)+)+)+$')[_0x40eec8(0x1cb)]()[_0x40eec8(0x1ca)](a415_0xe70b3f)[_0x40eec8(0x19b)](_0x40eec8(0x1c5));});function a415_0x40de(){const _0x13932b=['./classes/loggers/logger','./services/dependency.service','SUCCESS','shortid','BaseVeevaError','DeployService','decorate','32860RBuEkO','function','./utils/salesforce-request.utils','join','1506240ECSFBA','SnapshotService','SalesforceAuth','apply','fs/promises','instanceUrl','Logger','./services/deploy.service','temp/veeva/deploy_','68VdISVA','VeevaVaultController','prototype','1066617xmHYuc','snapshot','438775tctDmV','object','then','param','Version','Post','execute','doSnapshot','design:returntype','962568WkHgRN','(((.+)+)+)+$','259hKgSPv','metadata','./classes/auth/salesforce-auth','../../core','constructor','toString','createSalesforceRequest','FAILURE','rollback','design:paramtypes','length','__decorate','getAuthDetails','makeDir','DependencyService','Controller','AppResponseStatus','design:type','body','./services/rollback.service','4314792zOJPEM','2130vtnpgW','__importDefault','retrieveDependency','createVeevaRequest','getMessages','__param','./services/snapshot.service','defineProperty','RollbackService','7282CmoTAq','deployFromBranch','./enums/status.enums','message','24DFXlBv','search','deploy','getOwnPropertyDescriptor','__esModule','VeevaAuth','finally','./utils/veeva-request.utils'];a415_0x40de=function(){return _0x13932b;};return a415_0x40de();}a415_0xe70b3f();'use strict';var __decorate=this&&this[a415_0x6af628(0x1d1)]||function(_0x3432be,_0x533be8,_0x16fd96,_0x292348){const _0x4c9e0e=a415_0x6af628;var _0x176bdc=arguments[_0x4c9e0e(0x1d0)],_0x20491f=_0x176bdc<0x3?_0x533be8:_0x292348===null?_0x292348=Object[_0x4c9e0e(0x19d)](_0x533be8,_0x16fd96):_0x292348,_0x83a19a;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x20491f=Reflect[_0x4c9e0e(0x1a8)](_0x3432be,_0x533be8,_0x16fd96,_0x292348);else{for(var _0x2e1fe5=_0x3432be[_0x4c9e0e(0x1d0)]-0x1;_0x2e1fe5>=0x0;_0x2e1fe5--)if(_0x83a19a=_0x3432be[_0x2e1fe5])_0x20491f=(_0x176bdc<0x3?_0x83a19a(_0x20491f):_0x176bdc>0x3?_0x83a19a(_0x533be8,_0x16fd96,_0x20491f):_0x83a19a(_0x533be8,_0x16fd96))||_0x20491f;}return _0x176bdc>0x3&&_0x20491f&&Object[_0x4c9e0e(0x194)](_0x533be8,_0x16fd96,_0x20491f),_0x20491f;},__metadata=this&&this['__metadata']||function(_0x5a6524,_0x116b30){const _0x57d7fe=a415_0x6af628;if(typeof Reflect===_0x57d7fe(0x1bc)&&typeof Reflect[_0x57d7fe(0x1c7)]===_0x57d7fe(0x1aa))return Reflect[_0x57d7fe(0x1c7)](_0x5a6524,_0x116b30);},__param=this&&this[a415_0x6af628(0x192)]||function(_0x278ea1,_0x746499){return function(_0x224740,_0x44406b){_0x746499(_0x224740,_0x44406b,_0x278ea1);};},__importDefault=this&&this[a415_0x6af628(0x18e)]||function(_0x19fc4e){const _0x396c9b=a415_0x6af628;return _0x19fc4e&&_0x19fc4e[_0x396c9b(0x19e)]?_0x19fc4e:{'default':_0x19fc4e};};Object[a415_0x6af628(0x194)](exports,a415_0x6af628(0x19e),{'value':!![]}),exports[a415_0x6af628(0x1b7)]=void 0x0;const core_1=require(a415_0x6af628(0x1c9)),dependency_service_1=require(a415_0x6af628(0x1a3)),snapshot_service_1=require(a415_0x6af628(0x193)),deploy_service_1=require(a415_0x6af628(0x1b4)),veeva_request_utils_1=require(a415_0x6af628(0x1a1)),status_enums_1=require(a415_0x6af628(0x198)),shortid_1=__importDefault(require(a415_0x6af628(0x1a5))),fs_util_1=require('./utils/fs-util'),logger_1=require(a415_0x6af628(0x1a2)),promises_1=require(a415_0x6af628(0x1b1)),base_veeva_error_1=require('./classes/errors/base-veeva-error'),salesforce_request_utils_1=require(a415_0x6af628(0x1ab)),veeva_auth_1=require('./classes/auth/veeva-auth'),salesforce_auth_1=require(a415_0x6af628(0x1c8)),rollback_service_1=require(a415_0x6af628(0x1d9)),JOB_UPDATE_TOKEN_ATTEMPTS=0x1;function a415_0x2677(_0x67779b,_0x4113f5){const _0x293e37=a415_0x40de();return a415_0x2677=function(_0xe70b3f,_0x3cac2b){_0xe70b3f=_0xe70b3f-0x18c;let _0x40defc=_0x293e37[_0xe70b3f];return _0x40defc;},a415_0x2677(_0x67779b,_0x4113f5);}let VeevaVaultController=class VeevaVaultController{async[a415_0x6af628(0x1c2)](_0x5d1138){const _0x491718=a415_0x6af628,{veevaAuth:_0x5dde22,timeZone:_0x15cdde,attachmentLogId:_0x462154}=_0x5d1138;try{const _0x11df94=(0x0,veeva_request_utils_1[_0x491718(0x190)])(new veeva_auth_1[(_0x491718(0x19f))](_0x5dde22,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x38b45f=await salesforce_auth_1[_0x491718(0x1af)]['getAuthDetails'](),_0x21cc0a=(0x0,salesforce_request_utils_1['createSalesforceRequest'])(new salesforce_auth_1[(_0x491718(0x1af))](_0x38b45f)),_0x498df6=new logger_1[(_0x491718(0x1b3))](_0x21cc0a,_0x15cdde,_0x462154),_0x219047=new snapshot_service_1[(_0x491718(0x1ae))](_0x5d1138,_0x21cc0a,_0x11df94,_0x498df6);return _0x219047[_0x491718(0x1c1)]()[_0x491718(0x1bd)](),{'responseStatus':status_enums_1[_0x491718(0x1d6)]['SUCCESS']};}catch(_0x5a558d){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x491718(0x1cd)],'responseMessage':_0x5a558d[_0x491718(0x199)]};}}async[a415_0x6af628(0x197)](_0x83cbe6){const _0x2fcb9c=a415_0x6af628,{veevaAuth:_0x334ce4,timeZone:_0x53e170,attachmentLogId:_0x421d97}=_0x83cbe6;try{const _0xacd8c0=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x2fcb9c(0x19f))](_0x334ce4,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x191d7e=await salesforce_auth_1[_0x2fcb9c(0x1af)][_0x2fcb9c(0x1d2)](),_0x36a4af=(0x0,salesforce_request_utils_1[_0x2fcb9c(0x1cc)])(new salesforce_auth_1['SalesforceAuth'](_0x191d7e)),_0x3a1070=new logger_1[(_0x2fcb9c(0x1b3))](_0x36a4af,_0x53e170,_0x421d97),_0x362636=_0x2fcb9c(0x1b5)+(0x0,shortid_1['default'])();await(0x0,fs_util_1[_0x2fcb9c(0x1d3)])(_0x362636);const _0x59baf5=new deploy_service_1[(_0x2fcb9c(0x1a7))](_0x83cbe6,_0x36a4af,_0xacd8c0,_0x3a1070,_0x362636,_0x191d7e[_0x2fcb9c(0x1b2)]);return _0x59baf5[_0x2fcb9c(0x1c1)]()[_0x2fcb9c(0x1a0)](()=>(0x0,promises_1['rm'])(_0x362636,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x2fcb9c(0x1d6)][_0x2fcb9c(0x1a4)]};}catch(_0x114497){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x2fcb9c(0x1cd)],'responseMessage':_0x114497['message']};}}async[a415_0x6af628(0x18f)](_0x22ed99){const _0x3f71ca=a415_0x6af628,{veevaAuth:_0xc4dd4}=_0x22ed99;try{const _0x20ff59=(0x0,veeva_request_utils_1[_0x3f71ca(0x190)])(new veeva_auth_1[(_0x3f71ca(0x19f))](_0xc4dd4)),_0x233458=await salesforce_auth_1[_0x3f71ca(0x1af)]['getAuthDetails'](),_0x736998=(0x0,salesforce_request_utils_1[_0x3f71ca(0x1cc)])(new salesforce_auth_1[(_0x3f71ca(0x1af))](_0x233458)),_0x311ae2=new dependency_service_1[(_0x3f71ca(0x1d4))](_0x22ed99,_0x736998,_0x20ff59);return await _0x311ae2[_0x3f71ca(0x1c1)]();}catch(_0x2fafa1){const _0x2818fa=_0x2fafa1 instanceof base_veeva_error_1[_0x3f71ca(0x1a6)]?_0x2fafa1[_0x3f71ca(0x191)]()[_0x3f71ca(0x1ac)]('\x0a'):_0x2fafa1[_0x3f71ca(0x199)];return{'responseStatus':status_enums_1[_0x3f71ca(0x1d6)][_0x3f71ca(0x1cd)],'responseMessage':_0x2818fa};}}async['rollback'](_0x49c125){const _0x606920=a415_0x6af628,{veevaAuth:_0x32eb4e,timeZone:_0x42fc5c,attachmentLogId:_0xafd5fc}=_0x49c125;try{const _0x33dda0=(0x0,veeva_request_utils_1['createVeevaRequest'])(new veeva_auth_1[(_0x606920(0x19f))](_0x32eb4e,JOB_UPDATE_TOKEN_ATTEMPTS)),_0x2c5d56=await salesforce_auth_1[_0x606920(0x1af)]['getAuthDetails'](),_0x26cecf=(0x0,salesforce_request_utils_1[_0x606920(0x1cc)])(new salesforce_auth_1[(_0x606920(0x1af))](_0x2c5d56)),_0x15fc50=new logger_1[(_0x606920(0x1b3))](_0x26cecf,_0x42fc5c,_0xafd5fc),_0x365e4e='temp/veeva/rollback_'+(0x0,shortid_1['default'])();await(0x0,fs_util_1[_0x606920(0x1d3)])(_0x365e4e);const _0x52d38e=new rollback_service_1[(_0x606920(0x195))]({..._0x49c125,'connectionVeeva':_0x33dda0,'connectionSalesforce':_0x26cecf,'logger':_0x15fc50,'tempFolder':_0x365e4e,'instanceUrl':_0x2c5d56[_0x606920(0x1b2)]});return _0x52d38e['execute']()[_0x606920(0x1a0)](()=>(0x0,promises_1['rm'])(_0x365e4e,{'recursive':!![],'force':!![]})),{'responseStatus':status_enums_1[_0x606920(0x1d6)][_0x606920(0x1a4)]};}catch(_0x4a2659){return{'responseStatus':status_enums_1['AppResponseStatus'][_0x606920(0x1cd)],'responseMessage':_0x4a2659['message']};}}};__decorate([(0x0,core_1[a415_0x6af628(0x1c0)])(a415_0x6af628(0x1ba)),__param(0x0,core_1[a415_0x6af628(0x1be)][a415_0x6af628(0x1d8)]()),__metadata(a415_0x6af628(0x1d7),Function),__metadata(a415_0x6af628(0x1cf),[Object]),__metadata(a415_0x6af628(0x1c3),Promise)],VeevaVaultController[a415_0x6af628(0x1b8)],a415_0x6af628(0x1c2),null),__decorate([(0x0,core_1['Post'])(a415_0x6af628(0x19c)),__param(0x0,core_1['param'][a415_0x6af628(0x1d8)]()),__metadata(a415_0x6af628(0x1d7),Function),__metadata(a415_0x6af628(0x1cf),[Object]),__metadata(a415_0x6af628(0x1c3),Promise)],VeevaVaultController[a415_0x6af628(0x1b8)],a415_0x6af628(0x197),null),__decorate([(0x0,core_1[a415_0x6af628(0x1c0)])('dependency'),__param(0x0,core_1['param']['body']()),__metadata(a415_0x6af628(0x1d7),Function),__metadata(a415_0x6af628(0x1cf),[Object]),__metadata('design:returntype',Promise)],VeevaVaultController[a415_0x6af628(0x1b8)],a415_0x6af628(0x18f),null),__decorate([(0x0,core_1['Post'])(a415_0x6af628(0x1ce)),__param(0x0,core_1[a415_0x6af628(0x1be)][a415_0x6af628(0x1d8)]()),__metadata(a415_0x6af628(0x1d7),Function),__metadata(a415_0x6af628(0x1cf),[Object]),__metadata(a415_0x6af628(0x1c3),Promise)],VeevaVaultController[a415_0x6af628(0x1b8)],a415_0x6af628(0x1ce),null),VeevaVaultController=__decorate([(0x0,core_1[a415_0x6af628(0x1d5)])('veeva-vault'),(0x0,core_1[a415_0x6af628(0x1bf)])('v1.1')],VeevaVaultController),exports[a415_0x6af628(0x1b7)]=VeevaVaultController;