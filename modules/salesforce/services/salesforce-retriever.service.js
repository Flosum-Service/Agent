const a135_0x205055=a135_0x484e;(function(_0x2e311c,_0x429d84){const _0x31c528=a135_0x484e,_0x2682d6=_0x2e311c();while(!![]){try{const _0x301746=parseInt(_0x31c528(0xfd))/0x1*(-parseInt(_0x31c528(0xc7))/0x2)+-parseInt(_0x31c528(0xdc))/0x3*(-parseInt(_0x31c528(0xf3))/0x4)+parseInt(_0x31c528(0xd2))/0x5*(parseInt(_0x31c528(0xe6))/0x6)+-parseInt(_0x31c528(0xea))/0x7+parseInt(_0x31c528(0xcc))/0x8*(-parseInt(_0x31c528(0xef))/0x9)+parseInt(_0x31c528(0xe9))/0xa*(-parseInt(_0x31c528(0xf6))/0xb)+parseInt(_0x31c528(0xdf))/0xc;if(_0x301746===_0x429d84)break;else _0x2682d6['push'](_0x2682d6['shift']());}catch(_0x2c211e){_0x2682d6['push'](_0x2682d6['shift']());}}}(a135_0x10e1,0x4dcda));const a135_0x3ed4bb=(function(){let _0x50dd24=!![];return function(_0x31f3aa,_0x134f50){const _0x56cdc3=_0x50dd24?function(){if(_0x134f50){const _0xbedc22=_0x134f50['apply'](_0x31f3aa,arguments);return _0x134f50=null,_0xbedc22;}}:function(){};return _0x50dd24=![],_0x56cdc3;};}()),a135_0x14d524=a135_0x3ed4bb(this,function(){const _0x930b89=a135_0x484e;return a135_0x14d524['toString']()[_0x930b89(0x101)]('(((.+)+)+)+$')[_0x930b89(0xf1)]()[_0x930b89(0xee)](a135_0x14d524)[_0x930b89(0x101)](_0x930b89(0xf8));});a135_0x14d524();'use strict';var __importDefault=this&&this[a135_0x205055(0xed)]||function(_0x32fd03){const _0x96339d=a135_0x205055;return _0x32fd03&&_0x32fd03[_0x96339d(0xd8)]?_0x32fd03:{'default':_0x32fd03};};Object[a135_0x205055(0x100)](exports,a135_0x205055(0xd8),{'value':!![]}),exports[a135_0x205055(0xe4)]=void 0x0;const core_1=require('../../../core'),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a135_0x205055(0xc8)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');function a135_0x484e(_0x80f227,_0x3a35e1){const _0x575371=a135_0x10e1();return a135_0x484e=function(_0x14d524,_0x3ed4bb){_0x14d524=_0x14d524-0xc6;let _0x10e102=_0x575371[_0x14d524];return _0x10e102;},a135_0x484e(_0x80f227,_0x3a35e1);}class SalesforceRetrieverService{constructor(_0xc1a8b8){const _0x3b7311=a135_0x205055;this[_0x3b7311(0xf0)]=_0xc1a8b8,this[_0x3b7311(0xe8)]=new core_1[(_0x3b7311(0xcb))](SalesforceRetrieverService['name']),this['COMPONENTS_PER_REQUEST']=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async[a135_0x205055(0xfb)](_0x35b8b3){const _0xa9f20b=a135_0x205055;this['logger'][_0xa9f20b(0xcf)](_0xa9f20b(0xf2),_0x35b8b3['length']);const _0x55f8e9=typedi_1[_0xa9f20b(0xde)][_0xa9f20b(0xfa)](salesforce_query_service_1[_0xa9f20b(0xca)]),_0x4c7380=_0x35b8b3[_0xa9f20b(0xd5)](_0x38cb69=>'\x27'+_0x38cb69+'\x27'),_0x47d1ff=[];while(_0x4c7380['length']){const _0xec96e2=_0x4c7380[_0xa9f20b(0xf4)](0x0,this[_0xa9f20b(0xdb)]),_0xfbb52d=_0x55f8e9[_0xa9f20b(0xfc)](queries_1[_0xa9f20b(0xd9)][_0xa9f20b(0xf9)](_0xa9f20b(0xd1),_0xec96e2[_0xa9f20b(0xc6)]())),_0x4eb590=_0x55f8e9['query'](queries_1[_0xa9f20b(0xdd)]['replace'](_0xa9f20b(0xc9),_0xec96e2['join']()))[_0xa9f20b(0xe3)](_0xe894da=>_0xe894da['map'](_0x4193df=>flosum_component_history_dto_1[_0xa9f20b(0xe0)][_0xa9f20b(0xd3)](_0x4193df))),[_0x5cc79f,_0x22d729]=await Promise['all']([_0xfbb52d,_0x4eb590]);for(const _0x2ade2f of _0x22d729){const _0x4d91b1=_0x5cc79f[_0xa9f20b(0xe7)](_0x34a385=>_0x34a385[_0xa9f20b(0xe2)]===_0x2ade2f['id']);_0x4d91b1&&_0x47d1ff[_0xa9f20b(0xf5)]({'fileType':_0x4d91b1[_0xa9f20b(0xe5)],'fileName':_0x2ade2f[_0xa9f20b(0xf7)],'attachmentId':_0x4d91b1['Id']});}}return _0x47d1ff;}async[a135_0x205055(0xcd)](_0x3357a0){const _0x59d0b4=a135_0x205055,_0x6641e8=await this['retrieveComponentIdsFromHistoryIds'](_0x3357a0);this[_0x59d0b4(0xe8)]['info'](_0x59d0b4(0xeb));const _0x570fd8=[];for(const _0x5f49d8 of _0x6641e8){const _0xe6231f=await this[_0x59d0b4(0xf0)][_0x59d0b4(0xfe)](_0x5f49d8['attachmentId'],!![]);_0x570fd8[_0x59d0b4(0xf5)]({'body':_0xe6231f[_0x59d0b4(0xf1)](_0x59d0b4(0xda)),'fileName':_0x5f49d8['fileName'],'fileType':_0x5f49d8[_0x59d0b4(0xec)]}),this[_0x59d0b4(0xe8)][_0x59d0b4(0xcf)](_0x59d0b4(0xce),_0x570fd8[_0x59d0b4(0xe1)],_0x3357a0[_0x59d0b4(0xe1)]);}return _0x570fd8;}async['run'](_0x130a34){const _0x132b15=a135_0x205055,_0x583a17=[..._0x130a34],_0x594f76=[],_0x18f740=[];while(_0x583a17[_0x132b15(0xe1)]){const _0x575f57=_0x583a17[_0x132b15(0xf4)](0x0,this[_0x132b15(0xd4)]),_0xc9d317=await this[_0x132b15(0xf0)]['retrieveComponents'](_0x575f57);_0x575f57[_0x132b15(0xe1)]!==_0xc9d317['ids'][_0x132b15(0xe1)]?(_0x583a17[_0x132b15(0xf5)](..._0xc9d317[_0x132b15(0xff)]),_0x594f76[_0x132b15(0xf5)](..._0xc9d317[_0x132b15(0xd0)])):_0x18f740[_0x132b15(0xf5)](..._0x575f57),this[_0x132b15(0xe8)][_0x132b15(0xd6)](_0x132b15(0xd7),_0x130a34['length']-_0x583a17['length'],_0x130a34[_0x132b15(0xe1)]);}if(_0x18f740['length']){const _0x5a5353=await this[_0x132b15(0xcd)](_0x18f740);_0x594f76['push'](..._0x5a5353);}return _0x594f76;}}exports[a135_0x205055(0xe4)]=SalesforceRetrieverService;function a135_0x10e1(){const _0x35325e=['Name','6oxlYIy','find','logger','917660KiBfcf','625765BSLjEi','manually\x20retrieving\x20components\x20from\x20salesforce','fileType','__importDefault','constructor','288891mEjxlX','salesforceService','toString','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','224ZSpqPg','splice','push','33JDDFqA','filename','(((.+)+)+)+$','replace','get','retrieveComponentIdsFromHistoryIds','query','3vNrmil','retrieveAttachment','ids','defineProperty','search','join','27998VqGiGV','../queries','%ids%','SalesforceQueryService','Logger','96VglYDQ','retrieveLastComponents','manually\x20retrieved\x20%d/%d\x20components','info','components','%parent_ids%','1032105JLsSMa','fromSalesforce','COMPONENTS_PER_REQUEST','map','log','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','__esModule','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','base64','COMPONENTS_PER_QUERY','9204QybHfw','GET_COMPONENT_HISTORIES_BY_IDS','default','8787972DnPJSt','FlosumComponentHistoryDto','length','ParentId','then','SalesforceRetrieverService'];a135_0x10e1=function(){return _0x35325e;};return a135_0x10e1();}