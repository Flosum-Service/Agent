const a135_0x530877=a135_0x42b1;(function(_0x5baf51,_0x3d2fca){const _0x4fe4dc=a135_0x42b1,_0x2f2dd3=_0x5baf51();while(!![]){try{const _0x52cde0=parseInt(_0x4fe4dc(0x198))/0x1*(-parseInt(_0x4fe4dc(0x19c))/0x2)+parseInt(_0x4fe4dc(0x1b4))/0x3+parseInt(_0x4fe4dc(0x1bd))/0x4*(parseInt(_0x4fe4dc(0x1b0))/0x5)+-parseInt(_0x4fe4dc(0x1b5))/0x6+parseInt(_0x4fe4dc(0x197))/0x7*(parseInt(_0x4fe4dc(0x1ad))/0x8)+-parseInt(_0x4fe4dc(0x190))/0x9+parseInt(_0x4fe4dc(0x1a8))/0xa;if(_0x52cde0===_0x3d2fca)break;else _0x2f2dd3['push'](_0x2f2dd3['shift']());}catch(_0x19c4f6){_0x2f2dd3['push'](_0x2f2dd3['shift']());}}}(a135_0x49d1,0x41f1b));function a135_0x42b1(_0x39a23d,_0x48032c){const _0x235b38=a135_0x49d1();return a135_0x42b1=function(_0x575b5f,_0x24e797){_0x575b5f=_0x575b5f-0x18f;let _0x49d1dd=_0x235b38[_0x575b5f];return _0x49d1dd;},a135_0x42b1(_0x39a23d,_0x48032c);}const a135_0x24e797=(function(){let _0x1e9106=!![];return function(_0x83ccc5,_0x389709){const _0x182d0a=_0x1e9106?function(){const _0x1c54d0=a135_0x42b1;if(_0x389709){const _0x255dec=_0x389709[_0x1c54d0(0x1b2)](_0x83ccc5,arguments);return _0x389709=null,_0x255dec;}}:function(){};return _0x1e9106=![],_0x182d0a;};}()),a135_0x575b5f=a135_0x24e797(this,function(){const _0xf46909=a135_0x42b1;return a135_0x575b5f[_0xf46909(0x1a1)]()[_0xf46909(0x1bb)]('(((.+)+)+)+$')['toString']()[_0xf46909(0x19a)](a135_0x575b5f)[_0xf46909(0x1bb)]('(((.+)+)+)+$');});function a135_0x49d1(){const _0x4e5715=['filename','ids','%parent_ids%','1955400VoMqkG','retrieveLastComponents','get','../dto/flosum-component-history.dto','replace','699704NLmpur','COMPONENTS_PER_REQUEST','Logger','65FNrzlK','defineProperty','apply','manually\x20retrieving\x20components\x20from\x20salesforce','831270eyEQac','2952072tRAUqf','info','Name','splice','typedi','retrieveComponents','search','../../../core','160332Vzyndk','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','__importDefault','ParentId','run','../queries','salesforceService','length','COMPONENTS_PER_QUERY','%ids%','logger','3876264FYudwc','log','retrieveComponentIdsFromHistoryIds','manually\x20retrieved\x20%d/%d\x20components','SalesforceQueryService','join','then','21FCpRWo','1bvynOg','SalesforceRetrieverService','constructor','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','126566dRDtCH','base64','default','push','./salesforce-query.service','toString','__esModule','query','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)'];a135_0x49d1=function(){return _0x4e5715;};return a135_0x49d1();}a135_0x575b5f();'use strict';var __importDefault=this&&this[a135_0x530877(0x1bf)]||function(_0x20d2e7){const _0xb9f381=a135_0x530877;return _0x20d2e7&&_0x20d2e7[_0xb9f381(0x1a2)]?_0x20d2e7:{'default':_0x20d2e7};};Object[a135_0x530877(0x1b1)](exports,a135_0x530877(0x1a2),{'value':!![]}),exports[a135_0x530877(0x199)]=void 0x0;const core_1=require(a135_0x530877(0x1bc)),typedi_1=__importDefault(require(a135_0x530877(0x1b9))),salesforce_query_service_1=require(a135_0x530877(0x1a0)),queries_1=require(a135_0x530877(0x1c2)),flosum_component_history_dto_1=require(a135_0x530877(0x1ab));class SalesforceRetrieverService{constructor(_0x54fc22){const _0x47d3bc=a135_0x530877;this[_0x47d3bc(0x1c3)]=_0x54fc22,this[_0x47d3bc(0x18f)]=new core_1[(_0x47d3bc(0x1af))](SalesforceRetrieverService['name']),this[_0x47d3bc(0x1ae)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async[a135_0x530877(0x192)](_0x3c8364){const _0x7ad2f3=a135_0x530877;this[_0x7ad2f3(0x18f)]['info'](_0x7ad2f3(0x1a4),_0x3c8364[_0x7ad2f3(0x1c4)]);const _0x54fd3=typedi_1[_0x7ad2f3(0x19e)][_0x7ad2f3(0x1aa)](salesforce_query_service_1[_0x7ad2f3(0x194)]),_0x2310c9=_0x3c8364['map'](_0x1cfcec=>'\x27'+_0x1cfcec+'\x27'),_0x178a01=[];while(_0x2310c9[_0x7ad2f3(0x1c4)]){const _0x4bf98c=_0x2310c9[_0x7ad2f3(0x1b8)](0x0,this[_0x7ad2f3(0x1c5)]),_0x3dd174=_0x54fd3[_0x7ad2f3(0x1a3)](queries_1[_0x7ad2f3(0x19b)]['replace'](_0x7ad2f3(0x1a7),_0x4bf98c[_0x7ad2f3(0x195)]())),_0x3d9d70=_0x54fd3[_0x7ad2f3(0x1a3)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x7ad2f3(0x1ac)](_0x7ad2f3(0x1c6),_0x4bf98c['join']()))[_0x7ad2f3(0x196)](_0x5c6975=>_0x5c6975['map'](_0x58f5c7=>flosum_component_history_dto_1['FlosumComponentHistoryDto']['fromSalesforce'](_0x58f5c7))),[_0x7fa2c3,_0x338725]=await Promise['all']([_0x3dd174,_0x3d9d70]);for(const _0x35120a of _0x338725){const _0x458e82=_0x7fa2c3['find'](_0x3baba8=>_0x3baba8[_0x7ad2f3(0x1c0)]===_0x35120a['id']);_0x458e82&&_0x178a01[_0x7ad2f3(0x19f)]({'fileType':_0x458e82[_0x7ad2f3(0x1b7)],'fileName':_0x35120a[_0x7ad2f3(0x1a5)],'attachmentId':_0x458e82['Id']});}}return _0x178a01;}async[a135_0x530877(0x1a9)](_0xf0133d){const _0x36d17b=a135_0x530877,_0x4920b9=await this['retrieveComponentIdsFromHistoryIds'](_0xf0133d);this[_0x36d17b(0x18f)][_0x36d17b(0x1b6)](_0x36d17b(0x1b3));const _0x58a792=[];for(const _0x168bcc of _0x4920b9){const _0x22c255=await this[_0x36d17b(0x1c3)]['retrieveAttachment'](_0x168bcc['attachmentId'],!![]);_0x58a792[_0x36d17b(0x19f)]({'body':_0x22c255[_0x36d17b(0x1a1)](_0x36d17b(0x19d)),'fileName':_0x168bcc['fileName'],'fileType':_0x168bcc['fileType']}),this[_0x36d17b(0x18f)]['info'](_0x36d17b(0x193),_0x58a792[_0x36d17b(0x1c4)],_0xf0133d['length']);}return _0x58a792;}async[a135_0x530877(0x1c1)](_0x3acb84){const _0x48f5df=a135_0x530877,_0x26ff13=[..._0x3acb84],_0xbf01a1=[],_0x5e0692=[];while(_0x26ff13[_0x48f5df(0x1c4)]){const _0x10500c=_0x26ff13[_0x48f5df(0x1b8)](0x0,this[_0x48f5df(0x1ae)]),_0x319f02=await this[_0x48f5df(0x1c3)][_0x48f5df(0x1ba)](_0x10500c);_0x10500c['length']!==_0x319f02['ids'][_0x48f5df(0x1c4)]?(_0x26ff13['push'](..._0x319f02[_0x48f5df(0x1a6)]),_0xbf01a1[_0x48f5df(0x19f)](..._0x319f02['components'])):_0x5e0692[_0x48f5df(0x19f)](..._0x10500c),this[_0x48f5df(0x18f)][_0x48f5df(0x191)](_0x48f5df(0x1be),_0x3acb84[_0x48f5df(0x1c4)]-_0x26ff13[_0x48f5df(0x1c4)],_0x3acb84['length']);}if(_0x5e0692['length']){const _0x587a97=await this[_0x48f5df(0x1a9)](_0x5e0692);_0xbf01a1[_0x48f5df(0x19f)](..._0x587a97);}return _0xbf01a1;}}exports[a135_0x530877(0x199)]=SalesforceRetrieverService;