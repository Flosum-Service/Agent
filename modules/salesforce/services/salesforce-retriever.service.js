const a135_0x2f309c=a135_0x25e9;(function(_0xca78e8,_0xaaecbb){const _0x4edac2=a135_0x25e9,_0x5b2280=_0xca78e8();while(!![]){try{const _0x461eb9=parseInt(_0x4edac2(0xe2))/0x1*(parseInt(_0x4edac2(0x102))/0x2)+parseInt(_0x4edac2(0x10c))/0x3+-parseInt(_0x4edac2(0xf5))/0x4+-parseInt(_0x4edac2(0xe3))/0x5*(-parseInt(_0x4edac2(0x111))/0x6)+-parseInt(_0x4edac2(0x10e))/0x7+parseInt(_0x4edac2(0x104))/0x8*(parseInt(_0x4edac2(0xfe))/0x9)+parseInt(_0x4edac2(0xfc))/0xa*(parseInt(_0x4edac2(0xff))/0xb);if(_0x461eb9===_0xaaecbb)break;else _0x5b2280['push'](_0x5b2280['shift']());}catch(_0x89b594){_0x5b2280['push'](_0x5b2280['shift']());}}}(a135_0x2cc2,0xbf062));const a135_0x4a8c99=(function(){let _0x5c2ef4=!![];return function(_0x3a4df8,_0x139faf){const _0x4a46ed=_0x5c2ef4?function(){const _0x2cabba=a135_0x25e9;if(_0x139faf){const _0x185cf9=_0x139faf[_0x2cabba(0xe7)](_0x3a4df8,arguments);return _0x139faf=null,_0x185cf9;}}:function(){};return _0x5c2ef4=![],_0x4a46ed;};}()),a135_0x1c6b8a=a135_0x4a8c99(this,function(){const _0x493229=a135_0x25e9;return a135_0x1c6b8a[_0x493229(0x101)]()[_0x493229(0x103)]('(((.+)+)+)+$')[_0x493229(0x101)]()[_0x493229(0x108)](a135_0x1c6b8a)['search'](_0x493229(0xe9));});a135_0x1c6b8a();function a135_0x25e9(_0xae34a4,_0x1a039c){const _0x59aa17=a135_0x2cc2();return a135_0x25e9=function(_0x1c6b8a,_0x4a8c99){_0x1c6b8a=_0x1c6b8a-0xdc;let _0x2cc23d=_0x59aa17[_0x1c6b8a];return _0x2cc23d;},a135_0x25e9(_0xae34a4,_0x1a039c);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x42b88b){return _0x42b88b&&_0x42b88b['__esModule']?_0x42b88b:{'default':_0x42b88b};};function a135_0x2cc2(){const _0x2af078=['4783388uVpBiz','replace','default','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','SalesforceQueryService','retrieveComponentIdsFromHistoryIds','query','11510cpSduX','ids','3528cbySJx','1210EqmHMA','manually\x20retrieved\x20%d/%d\x20components','toString','46GgzXvQ','search','25104tdQwOu','filename','length','SalesforceRetrieverService','constructor','push','splice','info','2595813wUwYQo','map','8365490Gdkrqx','components','fromSalesforce','3540126uBwKhe','attachmentId','base64','COMPONENTS_PER_QUERY','../queries','join','ParentId','__esModule','then','all','../../../core','logger','15711sngLCk','5ZOdTRg','%parent_ids%','fileType','name','apply','retrieveLastComponents','(((.+)+)+)+$','COMPONENTS_PER_REQUEST','manually\x20retrieving\x20components\x20from\x20salesforce','Logger','typedi','retrieveComponents','%ids%','find','get','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','salesforceService','fileName'];a135_0x2cc2=function(){return _0x2af078;};return a135_0x2cc2();}Object['defineProperty'](exports,a135_0x2f309c(0xdd),{'value':!![]}),exports[a135_0x2f309c(0x107)]=void 0x0;const core_1=require(a135_0x2f309c(0xe0)),typedi_1=__importDefault(require(a135_0x2f309c(0xed))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a135_0x2f309c(0x115)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x31e50e){const _0x22f0d7=a135_0x2f309c;this['salesforceService']=_0x31e50e,this[_0x22f0d7(0xe1)]=new core_1[(_0x22f0d7(0xec))](SalesforceRetrieverService[_0x22f0d7(0xe6)]),this[_0x22f0d7(0xea)]=0xbb8,this[_0x22f0d7(0x114)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x32e443){const _0xf256fd=a135_0x2f309c;this[_0xf256fd(0xe1)][_0xf256fd(0x10b)](_0xf256fd(0xf8),_0x32e443[_0xf256fd(0x106)]);const _0x1e5f14=typedi_1[_0xf256fd(0xf7)][_0xf256fd(0xf1)](salesforce_query_service_1[_0xf256fd(0xf9)]),_0x29241b=_0x32e443[_0xf256fd(0x10d)](_0x49ce8d=>'\x27'+_0x49ce8d+'\x27'),_0x423b0f=[];while(_0x29241b['length']){const _0x4c50ae=_0x29241b['splice'](0x0,this[_0xf256fd(0x114)]),_0x4d02a7=_0x1e5f14[_0xf256fd(0xfb)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0xf256fd(0xf6)](_0xf256fd(0xe4),_0x4c50ae[_0xf256fd(0x116)]())),_0x32a2f1=_0x1e5f14[_0xf256fd(0xfb)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS']['replace'](_0xf256fd(0xef),_0x4c50ae[_0xf256fd(0x116)]()))[_0xf256fd(0xde)](_0x45091b=>_0x45091b[_0xf256fd(0x10d)](_0x2e6d5b=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0xf256fd(0x110)](_0x2e6d5b))),[_0x448d10,_0x5a7a44]=await Promise[_0xf256fd(0xdf)]([_0x4d02a7,_0x32a2f1]);for(const _0x1d311a of _0x5a7a44){const _0x4af8d2=_0x448d10[_0xf256fd(0xf0)](_0x57d3c3=>_0x57d3c3[_0xf256fd(0xdc)]===_0x1d311a['id']);_0x4af8d2&&_0x423b0f[_0xf256fd(0x109)]({'fileType':_0x4af8d2['Name'],'fileName':_0x1d311a[_0xf256fd(0x105)],'attachmentId':_0x4af8d2['Id']});}}return _0x423b0f;}async[a135_0x2f309c(0xe8)](_0xc8546a){const _0x489bb1=a135_0x2f309c,_0x49a76d=await this[_0x489bb1(0xfa)](_0xc8546a);this[_0x489bb1(0xe1)][_0x489bb1(0x10b)](_0x489bb1(0xeb));const _0x29cc40=[];for(const _0x25c468 of _0x49a76d){const _0xec8f03=await this[_0x489bb1(0xf3)]['retrieveAttachment'](_0x25c468[_0x489bb1(0x112)],!![]);_0x29cc40[_0x489bb1(0x109)]({'body':_0xec8f03[_0x489bb1(0x101)](_0x489bb1(0x113)),'fileName':_0x25c468[_0x489bb1(0xf4)],'fileType':_0x25c468[_0x489bb1(0xe5)]}),this['logger'][_0x489bb1(0x10b)](_0x489bb1(0x100),_0x29cc40[_0x489bb1(0x106)],_0xc8546a[_0x489bb1(0x106)]);}return _0x29cc40;}async['run'](_0x57864f){const _0x32d6b0=a135_0x2f309c,_0x12b22e=[..._0x57864f],_0x45c7cb=[],_0x3f1375=[];while(_0x12b22e[_0x32d6b0(0x106)]){const _0x4e9e7a=_0x12b22e[_0x32d6b0(0x10a)](0x0,this[_0x32d6b0(0xea)]),_0x2fb68b=await this[_0x32d6b0(0xf3)][_0x32d6b0(0xee)](_0x4e9e7a);_0x4e9e7a[_0x32d6b0(0x106)]!==_0x2fb68b[_0x32d6b0(0xfd)][_0x32d6b0(0x106)]?(_0x12b22e['push'](..._0x2fb68b[_0x32d6b0(0xfd)]),_0x45c7cb[_0x32d6b0(0x109)](..._0x2fb68b[_0x32d6b0(0x10f)])):_0x3f1375[_0x32d6b0(0x109)](..._0x4e9e7a),this['logger']['log'](_0x32d6b0(0xf2),_0x57864f[_0x32d6b0(0x106)]-_0x12b22e[_0x32d6b0(0x106)],_0x57864f[_0x32d6b0(0x106)]);}if(_0x3f1375[_0x32d6b0(0x106)]){const _0x4d7e1b=await this[_0x32d6b0(0xe8)](_0x3f1375);_0x45c7cb[_0x32d6b0(0x109)](..._0x4d7e1b);}return _0x45c7cb;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;