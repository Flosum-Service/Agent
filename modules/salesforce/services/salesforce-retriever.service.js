function a135_0x3552(_0x13dc7b,_0x2637a9){const _0x1ba4a0=a135_0x2d8c();return a135_0x3552=function(_0x36a808,_0x11ef08){_0x36a808=_0x36a808-0x15c;let _0x2d8cfc=_0x1ba4a0[_0x36a808];return _0x2d8cfc;},a135_0x3552(_0x13dc7b,_0x2637a9);}const a135_0x4dad14=a135_0x3552;function a135_0x2d8c(){const _0x9edf35=['4275492SFfOCR','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','%parent_ids%','get','default','%ids%','attachmentId','toString','name','ParentId','318094eyGUCG','GET_COMPONENT_HISTORIES_BY_IDS','components','retrieveLastComponents','log','../../../core','search','typedi','__importDefault','logger','run','FlosumComponentHistoryDto','6190767ULhDWB','push','COMPONENTS_PER_QUERY','ids','6403716ysqrZR','Name','constructor','join','16330LoDMul','(((.+)+)+)+$','./salesforce-query.service','3aAOhMO','59885klNrLU','map','apply','base64','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','56OMRdWQ','../dto/flosum-component-history.dto','../queries','retrieveAttachment','splice','10UnykGL','query','COMPONENTS_PER_REQUEST','salesforceService','2124JMWegC','find','fileName','__esModule','retrieveComponents','SalesforceQueryService','SalesforceRetrieverService','446281UWkvfm','length','Logger'];a135_0x2d8c=function(){return _0x9edf35;};return a135_0x2d8c();}(function(_0x1808f8,_0x5a837f){const _0x4e837d=a135_0x3552,_0x14d900=_0x1808f8();while(!![]){try{const _0x2351a6=parseInt(_0x4e837d(0x170))/0x1+parseInt(_0x4e837d(0x17d))/0x2*(parseInt(_0x4e837d(0x194))/0x3)+parseInt(_0x4e837d(0x173))/0x4+parseInt(_0x4e837d(0x191))/0x5*(-parseInt(_0x4e837d(0x169))/0x6)+parseInt(_0x4e837d(0x195))/0x7*(parseInt(_0x4e837d(0x160))/0x8)+parseInt(_0x4e837d(0x189))/0x9*(parseInt(_0x4e837d(0x165))/0xa)+-parseInt(_0x4e837d(0x18d))/0xb;if(_0x2351a6===_0x5a837f)break;else _0x14d900['push'](_0x14d900['shift']());}catch(_0x3044a1){_0x14d900['push'](_0x14d900['shift']());}}}(a135_0x2d8c,0xa6e6d));const a135_0x11ef08=(function(){let _0x3a86c4=!![];return function(_0x2211fc,_0x70b352){const _0x5bf943=_0x3a86c4?function(){const _0x1e2761=a135_0x3552;if(_0x70b352){const _0x1ee343=_0x70b352[_0x1e2761(0x15d)](_0x2211fc,arguments);return _0x70b352=null,_0x1ee343;}}:function(){};return _0x3a86c4=![],_0x5bf943;};}()),a135_0x36a808=a135_0x11ef08(this,function(){const _0x20025a=a135_0x3552;return a135_0x36a808[_0x20025a(0x17a)]()[_0x20025a(0x183)]('(((.+)+)+)+$')[_0x20025a(0x17a)]()[_0x20025a(0x18f)](a135_0x36a808)['search'](_0x20025a(0x192));});a135_0x36a808();'use strict';var __importDefault=this&&this[a135_0x4dad14(0x185)]||function(_0x41bf8b){return _0x41bf8b&&_0x41bf8b['__esModule']?_0x41bf8b:{'default':_0x41bf8b};};Object['defineProperty'](exports,a135_0x4dad14(0x16c),{'value':!![]}),exports[a135_0x4dad14(0x16f)]=void 0x0;const core_1=require(a135_0x4dad14(0x182)),typedi_1=__importDefault(require(a135_0x4dad14(0x184))),salesforce_query_service_1=require(a135_0x4dad14(0x193)),queries_1=require(a135_0x4dad14(0x162)),flosum_component_history_dto_1=require(a135_0x4dad14(0x161));class SalesforceRetrieverService{constructor(_0x2c3952){const _0x224958=a135_0x4dad14;this[_0x224958(0x168)]=_0x2c3952,this[_0x224958(0x186)]=new core_1[(_0x224958(0x172))](SalesforceRetrieverService[_0x224958(0x17b)]),this[_0x224958(0x167)]=0xbb8,this[_0x224958(0x18b)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x4277ca){const _0x4d324d=a135_0x4dad14;this[_0x4d324d(0x186)]['info'](_0x4d324d(0x15f),_0x4277ca[_0x4d324d(0x171)]);const _0x2d223d=typedi_1[_0x4d324d(0x177)][_0x4d324d(0x176)](salesforce_query_service_1[_0x4d324d(0x16e)]),_0x346087=_0x4277ca[_0x4d324d(0x15c)](_0x20bf67=>'\x27'+_0x20bf67+'\x27'),_0x5a610a=[];while(_0x346087[_0x4d324d(0x171)]){const _0xf249f1=_0x346087['splice'](0x0,this[_0x4d324d(0x18b)]),_0x5089e2=_0x2d223d[_0x4d324d(0x166)](queries_1[_0x4d324d(0x174)]['replace'](_0x4d324d(0x175),_0xf249f1[_0x4d324d(0x190)]())),_0x41df76=_0x2d223d[_0x4d324d(0x166)](queries_1[_0x4d324d(0x17e)]['replace'](_0x4d324d(0x178),_0xf249f1['join']()))['then'](_0x82a2f3=>_0x82a2f3[_0x4d324d(0x15c)](_0x5d8155=>flosum_component_history_dto_1[_0x4d324d(0x188)]['fromSalesforce'](_0x5d8155))),[_0x3b9b64,_0x5a17d6]=await Promise['all']([_0x5089e2,_0x41df76]);for(const _0x2f791f of _0x5a17d6){const _0x4a133a=_0x3b9b64[_0x4d324d(0x16a)](_0x40c42e=>_0x40c42e[_0x4d324d(0x17c)]===_0x2f791f['id']);_0x4a133a&&_0x5a610a[_0x4d324d(0x18a)]({'fileType':_0x4a133a[_0x4d324d(0x18e)],'fileName':_0x2f791f['filename'],'attachmentId':_0x4a133a['Id']});}}return _0x5a610a;}async['retrieveLastComponents'](_0x4b83e0){const _0x5b3719=a135_0x4dad14,_0x2ac10f=await this['retrieveComponentIdsFromHistoryIds'](_0x4b83e0);this['logger']['info']('manually\x20retrieving\x20components\x20from\x20salesforce');const _0x32faac=[];for(const _0x21de42 of _0x2ac10f){const _0x45aa7f=await this[_0x5b3719(0x168)][_0x5b3719(0x163)](_0x21de42[_0x5b3719(0x179)],!![]);_0x32faac[_0x5b3719(0x18a)]({'body':_0x45aa7f[_0x5b3719(0x17a)](_0x5b3719(0x15e)),'fileName':_0x21de42[_0x5b3719(0x16b)],'fileType':_0x21de42['fileType']}),this[_0x5b3719(0x186)]['info']('manually\x20retrieved\x20%d/%d\x20components',_0x32faac['length'],_0x4b83e0[_0x5b3719(0x171)]);}return _0x32faac;}async[a135_0x4dad14(0x187)](_0xb5432d){const _0x3a960c=a135_0x4dad14,_0x5e2ef4=[..._0xb5432d],_0x4e6e8c=[],_0x2555a0=[];while(_0x5e2ef4[_0x3a960c(0x171)]){const _0x342af4=_0x5e2ef4[_0x3a960c(0x164)](0x0,this[_0x3a960c(0x167)]),_0x1e6a6d=await this[_0x3a960c(0x168)][_0x3a960c(0x16d)](_0x342af4);_0x342af4[_0x3a960c(0x171)]!==_0x1e6a6d[_0x3a960c(0x18c)][_0x3a960c(0x171)]?(_0x5e2ef4[_0x3a960c(0x18a)](..._0x1e6a6d[_0x3a960c(0x18c)]),_0x4e6e8c[_0x3a960c(0x18a)](..._0x1e6a6d[_0x3a960c(0x17f)])):_0x2555a0['push'](..._0x342af4),this['logger'][_0x3a960c(0x181)]('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0xb5432d[_0x3a960c(0x171)]-_0x5e2ef4[_0x3a960c(0x171)],_0xb5432d[_0x3a960c(0x171)]);}if(_0x2555a0[_0x3a960c(0x171)]){const _0x1fc8da=await this[_0x3a960c(0x180)](_0x2555a0);_0x4e6e8c['push'](..._0x1fc8da);}return _0x4e6e8c;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;