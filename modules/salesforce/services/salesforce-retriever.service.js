function a135_0x7aaf(_0x13d628,_0xaa048f){const _0x27429f=a135_0x21db();return a135_0x7aaf=function(_0x189077,_0x3be270){_0x189077=_0x189077-0x120;let _0x21dbbd=_0x27429f[_0x189077];return _0x21dbbd;},a135_0x7aaf(_0x13d628,_0xaa048f);}const a135_0x1a958c=a135_0x7aaf;(function(_0x505274,_0xdf7fba){const _0x1633b8=a135_0x7aaf,_0x236210=_0x505274();while(!![]){try{const _0x1f9c9b=-parseInt(_0x1633b8(0x144))/0x1+-parseInt(_0x1633b8(0x123))/0x2*(-parseInt(_0x1633b8(0x12a))/0x3)+parseInt(_0x1633b8(0x12c))/0x4*(parseInt(_0x1633b8(0x122))/0x5)+-parseInt(_0x1633b8(0x141))/0x6*(parseInt(_0x1633b8(0x137))/0x7)+-parseInt(_0x1633b8(0x146))/0x8*(-parseInt(_0x1633b8(0x14a))/0x9)+-parseInt(_0x1633b8(0x152))/0xa+-parseInt(_0x1633b8(0x125))/0xb*(parseInt(_0x1633b8(0x129))/0xc);if(_0x1f9c9b===_0xdf7fba)break;else _0x236210['push'](_0x236210['shift']());}catch(_0x139310){_0x236210['push'](_0x236210['shift']());}}}(a135_0x21db,0xdf803));function a135_0x21db(){const _0x49d5f1=['retrieveComponentIdsFromHistoryIds','1138056AirnKq','75wSFBbQ','replace','2286556blcmjw','toString','ids','SalesforceQueryService','retrieveLastComponents','Logger','salesforceService','push','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','components','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','56yFyKBt','apply','default','fromSalesforce','get','COMPONENTS_PER_REQUEST','__importDefault','run','length','FlosumComponentHistoryDto','1240632cVcidk','map','../dto/flosum-component-history.dto','191212zyOPJm','retrieveComponents','6776824xfJMgJ','__esModule','COMPONENTS_PER_QUERY','fileName','18TXGAQq','log','../../../core','search','all','./salesforce-query.service','SalesforceRetrieverService','manually\x20retrieving\x20components\x20from\x20salesforce','2754060visIvR','logger','%ids%','defineProperty','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','then','(((.+)+)+)+$','retrieveAttachment','info','constructor','10byqNfx','106946pKAyKX','query','132CeFOZn','splice','manually\x20retrieved\x20%d/%d\x20components'];a135_0x21db=function(){return _0x49d5f1;};return a135_0x21db();}const a135_0x3be270=(function(){let _0x575cd4=!![];return function(_0x37d34d,_0x13ef0a){const _0x13850c=_0x575cd4?function(){const _0x22ffc0=a135_0x7aaf;if(_0x13ef0a){const _0xacf35=_0x13ef0a[_0x22ffc0(0x138)](_0x37d34d,arguments);return _0x13ef0a=null,_0xacf35;}}:function(){};return _0x575cd4=![],_0x13850c;};}()),a135_0x189077=a135_0x3be270(this,function(){const _0xfb23e4=a135_0x7aaf;return a135_0x189077[_0xfb23e4(0x12d)]()['search'](_0xfb23e4(0x158))[_0xfb23e4(0x12d)]()[_0xfb23e4(0x121)](a135_0x189077)[_0xfb23e4(0x14d)](_0xfb23e4(0x158));});a135_0x189077();'use strict';var __importDefault=this&&this[a135_0x1a958c(0x13d)]||function(_0x51409d){const _0xf3160d=a135_0x1a958c;return _0x51409d&&_0x51409d[_0xf3160d(0x147)]?_0x51409d:{'default':_0x51409d};};Object[a135_0x1a958c(0x155)](exports,'__esModule',{'value':!![]}),exports[a135_0x1a958c(0x150)]=void 0x0;const core_1=require(a135_0x1a958c(0x14c)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a135_0x1a958c(0x14f)),queries_1=require('../queries'),flosum_component_history_dto_1=require(a135_0x1a958c(0x143));class SalesforceRetrieverService{constructor(_0x1f4255){const _0x49bad8=a135_0x1a958c;this['salesforceService']=_0x1f4255,this[_0x49bad8(0x153)]=new core_1[(_0x49bad8(0x131))](SalesforceRetrieverService['name']),this[_0x49bad8(0x13c)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x39c345){const _0x4796ea=a135_0x1a958c;this[_0x4796ea(0x153)]['info'](_0x4796ea(0x134),_0x39c345[_0x4796ea(0x13f)]);const _0x5362a6=typedi_1[_0x4796ea(0x139)][_0x4796ea(0x13b)](salesforce_query_service_1[_0x4796ea(0x12f)]),_0x24c275=_0x39c345[_0x4796ea(0x142)](_0x65c3ce=>'\x27'+_0x65c3ce+'\x27'),_0x31fd01=[];while(_0x24c275['length']){const _0x12afaa=_0x24c275[_0x4796ea(0x126)](0x0,this[_0x4796ea(0x148)]),_0x13bde8=_0x5362a6['query'](queries_1[_0x4796ea(0x156)][_0x4796ea(0x12b)]('%parent_ids%',_0x12afaa['join']())),_0x1f16d8=_0x5362a6[_0x4796ea(0x124)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x4796ea(0x12b)](_0x4796ea(0x154),_0x12afaa['join']()))[_0x4796ea(0x157)](_0x3e8b55=>_0x3e8b55['map'](_0x3bac3f=>flosum_component_history_dto_1[_0x4796ea(0x140)][_0x4796ea(0x13a)](_0x3bac3f))),[_0x1d3500,_0x1758be]=await Promise[_0x4796ea(0x14e)]([_0x13bde8,_0x1f16d8]);for(const _0x45f403 of _0x1758be){const _0x1d1f61=_0x1d3500['find'](_0x453a41=>_0x453a41['ParentId']===_0x45f403['id']);_0x1d1f61&&_0x31fd01['push']({'fileType':_0x1d1f61['Name'],'fileName':_0x45f403['filename'],'attachmentId':_0x1d1f61['Id']});}}return _0x31fd01;}async[a135_0x1a958c(0x130)](_0x2f8a6a){const _0x484e7f=a135_0x1a958c,_0x5b6611=await this[_0x484e7f(0x128)](_0x2f8a6a);this[_0x484e7f(0x153)][_0x484e7f(0x120)](_0x484e7f(0x151));const _0x48d453=[];for(const _0x4fd9b7 of _0x5b6611){const _0xff870=await this['salesforceService'][_0x484e7f(0x159)](_0x4fd9b7['attachmentId'],!![]);_0x48d453[_0x484e7f(0x133)]({'body':_0xff870[_0x484e7f(0x12d)]('base64'),'fileName':_0x4fd9b7[_0x484e7f(0x149)],'fileType':_0x4fd9b7['fileType']}),this[_0x484e7f(0x153)][_0x484e7f(0x120)](_0x484e7f(0x127),_0x48d453[_0x484e7f(0x13f)],_0x2f8a6a[_0x484e7f(0x13f)]);}return _0x48d453;}async[a135_0x1a958c(0x13e)](_0x5a7538){const _0x1e0308=a135_0x1a958c,_0x40eec2=[..._0x5a7538],_0xd1e0a0=[],_0x4a837b=[];while(_0x40eec2[_0x1e0308(0x13f)]){const _0x5ca904=_0x40eec2[_0x1e0308(0x126)](0x0,this['COMPONENTS_PER_REQUEST']),_0x307ce3=await this[_0x1e0308(0x132)][_0x1e0308(0x145)](_0x5ca904);_0x5ca904[_0x1e0308(0x13f)]!==_0x307ce3[_0x1e0308(0x12e)][_0x1e0308(0x13f)]?(_0x40eec2[_0x1e0308(0x133)](..._0x307ce3[_0x1e0308(0x12e)]),_0xd1e0a0[_0x1e0308(0x133)](..._0x307ce3[_0x1e0308(0x135)])):_0x4a837b[_0x1e0308(0x133)](..._0x5ca904),this[_0x1e0308(0x153)][_0x1e0308(0x14b)](_0x1e0308(0x136),_0x5a7538['length']-_0x40eec2[_0x1e0308(0x13f)],_0x5a7538[_0x1e0308(0x13f)]);}if(_0x4a837b[_0x1e0308(0x13f)]){const _0x12df77=await this[_0x1e0308(0x130)](_0x4a837b);_0xd1e0a0[_0x1e0308(0x133)](..._0x12df77);}return _0xd1e0a0;}}exports[a135_0x1a958c(0x150)]=SalesforceRetrieverService;