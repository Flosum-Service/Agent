const a135_0x16bf99=a135_0x386c;(function(_0x28dd8a,_0x390897){const _0x561962=a135_0x386c,_0x45b0f2=_0x28dd8a();while(!![]){try{const _0x5e3bc4=-parseInt(_0x561962(0x151))/0x1*(parseInt(_0x561962(0x162))/0x2)+-parseInt(_0x561962(0x156))/0x3*(parseInt(_0x561962(0x14a))/0x4)+-parseInt(_0x561962(0x148))/0x5*(parseInt(_0x561962(0x174))/0x6)+parseInt(_0x561962(0x16a))/0x7*(parseInt(_0x561962(0x166))/0x8)+-parseInt(_0x561962(0x177))/0x9*(-parseInt(_0x561962(0x15d))/0xa)+parseInt(_0x561962(0x14c))/0xb*(-parseInt(_0x561962(0x173))/0xc)+parseInt(_0x561962(0x15b))/0xd;if(_0x5e3bc4===_0x390897)break;else _0x45b0f2['push'](_0x45b0f2['shift']());}catch(_0x3c995f){_0x45b0f2['push'](_0x45b0f2['shift']());}}}(a135_0x2894,0x4bfdb));const a135_0x73f7c7=(function(){let _0x45e8a2=!![];return function(_0xfae445,_0x2d36d8){const _0x6e5015=_0x45e8a2?function(){const _0x1ac50b=a135_0x386c;if(_0x2d36d8){const _0x182b9f=_0x2d36d8[_0x1ac50b(0x15f)](_0xfae445,arguments);return _0x2d36d8=null,_0x182b9f;}}:function(){};return _0x45e8a2=![],_0x6e5015;};}()),a135_0x1109a9=a135_0x73f7c7(this,function(){const _0x359d71=a135_0x386c;return a135_0x1109a9[_0x359d71(0x16d)]()[_0x359d71(0x13c)]('(((.+)+)+)+$')[_0x359d71(0x16d)]()[_0x359d71(0x16e)](a135_0x1109a9)['search'](_0x359d71(0x163));});a135_0x1109a9();function a135_0x386c(_0x3e9fac,_0x4798e0){const _0x9644af=a135_0x2894();return a135_0x386c=function(_0x1109a9,_0x73f7c7){_0x1109a9=_0x1109a9-0x139;let _0x289481=_0x9644af[_0x1109a9];return _0x289481;},a135_0x386c(_0x3e9fac,_0x4798e0);}function a135_0x2894(){const _0x4c49b9=['apply','splice','FlosumComponentHistoryDto','118yhvzJQ','(((.+)+)+)+$','ParentId','length','829904DgZnMG','../../../core','info','base64','21SrCXTp','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','toString','constructor','find','%ids%','default','%parent_ids%','34764oMVnyi','3678NfAPMt','fileName','fileType','9PdwfSk','COMPONENTS_PER_QUERY','attachmentId','COMPONENTS_PER_REQUEST','salesforceService','__importDefault','typedi','filename','search','SalesforceQueryService','logger','map','all','../dto/flosum-component-history.dto','defineProperty','SalesforceRetrieverService','query','components','ids','name','10KTXZfh','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','48968udpXha','retrieveLastComponents','836IQkRqk','./salesforce-query.service','manually\x20retrieving\x20components\x20from\x20salesforce','retrieveComponentIdsFromHistoryIds','Logger','5087xPtBnK','fromSalesforce','manually\x20retrieved\x20%d/%d\x20components','retrieveAttachment','__esModule','138CImykS','push','../queries','join','log','10496252iMVrzQ','then','2773040uIInwU','replace'];a135_0x2894=function(){return _0x4c49b9;};return a135_0x2894();}'use strict';var __importDefault=this&&this[a135_0x16bf99(0x139)]||function(_0x5ab104){const _0x2075ed=a135_0x16bf99;return _0x5ab104&&_0x5ab104[_0x2075ed(0x155)]?_0x5ab104:{'default':_0x5ab104};};Object[a135_0x16bf99(0x142)](exports,a135_0x16bf99(0x155),{'value':!![]}),exports[a135_0x16bf99(0x143)]=void 0x0;const core_1=require(a135_0x16bf99(0x167)),typedi_1=__importDefault(require(a135_0x16bf99(0x13a))),salesforce_query_service_1=require(a135_0x16bf99(0x14d)),queries_1=require(a135_0x16bf99(0x158)),flosum_component_history_dto_1=require(a135_0x16bf99(0x141));class SalesforceRetrieverService{constructor(_0x458d90){const _0x529dec=a135_0x16bf99;this['salesforceService']=_0x458d90,this['logger']=new core_1[(_0x529dec(0x150))](SalesforceRetrieverService[_0x529dec(0x147)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x529dec(0x178)]=0x1f4;}async[a135_0x16bf99(0x14f)](_0x5bb0cb){const _0x1daadc=a135_0x16bf99;this[_0x1daadc(0x13e)][_0x1daadc(0x168)](_0x1daadc(0x149),_0x5bb0cb['length']);const _0x43d30a=typedi_1[_0x1daadc(0x171)]['get'](salesforce_query_service_1[_0x1daadc(0x13d)]),_0x57516b=_0x5bb0cb['map'](_0x31fa9f=>'\x27'+_0x31fa9f+'\x27'),_0x4e55cf=[];while(_0x57516b[_0x1daadc(0x165)]){const _0x2855fc=_0x57516b[_0x1daadc(0x160)](0x0,this['COMPONENTS_PER_QUERY']),_0x385a6e=_0x43d30a[_0x1daadc(0x144)](queries_1[_0x1daadc(0x16b)][_0x1daadc(0x15e)](_0x1daadc(0x172),_0x2855fc['join']())),_0x52f584=_0x43d30a[_0x1daadc(0x144)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS']['replace'](_0x1daadc(0x170),_0x2855fc[_0x1daadc(0x159)]()))[_0x1daadc(0x15c)](_0x16817b=>_0x16817b[_0x1daadc(0x13f)](_0x5e6508=>flosum_component_history_dto_1[_0x1daadc(0x161)][_0x1daadc(0x152)](_0x5e6508))),[_0x325f18,_0x4db3bd]=await Promise[_0x1daadc(0x140)]([_0x385a6e,_0x52f584]);for(const _0x41c428 of _0x4db3bd){const _0xd74343=_0x325f18[_0x1daadc(0x16f)](_0x70cf2d=>_0x70cf2d[_0x1daadc(0x164)]===_0x41c428['id']);_0xd74343&&_0x4e55cf[_0x1daadc(0x157)]({'fileType':_0xd74343['Name'],'fileName':_0x41c428[_0x1daadc(0x13b)],'attachmentId':_0xd74343['Id']});}}return _0x4e55cf;}async['retrieveLastComponents'](_0x13dee7){const _0x583075=a135_0x16bf99,_0x3438d9=await this[_0x583075(0x14f)](_0x13dee7);this[_0x583075(0x13e)]['info'](_0x583075(0x14e));const _0x5c1acd=[];for(const _0x5e12a0 of _0x3438d9){const _0x2743d3=await this[_0x583075(0x17b)][_0x583075(0x154)](_0x5e12a0[_0x583075(0x179)],!![]);_0x5c1acd[_0x583075(0x157)]({'body':_0x2743d3[_0x583075(0x16d)](_0x583075(0x169)),'fileName':_0x5e12a0[_0x583075(0x175)],'fileType':_0x5e12a0[_0x583075(0x176)]}),this['logger'][_0x583075(0x168)](_0x583075(0x153),_0x5c1acd[_0x583075(0x165)],_0x13dee7[_0x583075(0x165)]);}return _0x5c1acd;}async['run'](_0x153b8a){const _0x422cca=a135_0x16bf99,_0xb509b9=[..._0x153b8a],_0x2ba2d2=[],_0x598cd4=[];while(_0xb509b9[_0x422cca(0x165)]){const _0x210466=_0xb509b9[_0x422cca(0x160)](0x0,this[_0x422cca(0x17a)]),_0x828c6b=await this['salesforceService']['retrieveComponents'](_0x210466);_0x210466[_0x422cca(0x165)]!==_0x828c6b[_0x422cca(0x146)]['length']?(_0xb509b9['push'](..._0x828c6b['ids']),_0x2ba2d2[_0x422cca(0x157)](..._0x828c6b[_0x422cca(0x145)])):_0x598cd4['push'](..._0x210466),this[_0x422cca(0x13e)][_0x422cca(0x15a)](_0x422cca(0x16c),_0x153b8a[_0x422cca(0x165)]-_0xb509b9[_0x422cca(0x165)],_0x153b8a[_0x422cca(0x165)]);}if(_0x598cd4[_0x422cca(0x165)]){const _0x1c5fb4=await this[_0x422cca(0x14b)](_0x598cd4);_0x2ba2d2[_0x422cca(0x157)](..._0x1c5fb4);}return _0x2ba2d2;}}exports[a135_0x16bf99(0x143)]=SalesforceRetrieverService;