function a134_0x516c(){const _0x271786=['GET_COMPONENT_HISTORIES_BY_IDS','logger','apply','length','(((.+)+)+)+$','info','retrieveLastComponents','push','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','Logger','attachmentId','%parent_ids%','replace','get','COMPONENTS_PER_QUERY','join','then','5EFVUcc','3495280SbfwRg','base64','all','name','defineProperty','9rkGBSV','default','130638oCaAEX','typedi','3244635teGjzJ','retrieveAttachment','retrieveComponentIdsFromHistoryIds','./salesforce-query.service','FlosumComponentHistoryDto','fileName','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','COMPONENTS_PER_REQUEST','SalesforceRetrieverService','364395gBmjvO','14148150EtyFiO','log','search','__importDefault','../../../core','1265068LxHdRc','toString','Name','../queries','manually\x20retrieving\x20components\x20from\x20salesforce','133yXWQAY','query','fileType','salesforceService','splice','fromSalesforce','SalesforceQueryService','map','2957412teHnVM'];a134_0x516c=function(){return _0x271786;};return a134_0x516c();}const a134_0x1e07a6=a134_0x2ce7;(function(_0x5b9ca3,_0xeccae5){const _0x377dfc=a134_0x2ce7,_0xc2ef87=_0x5b9ca3();while(!![]){try{const _0x37b0fc=parseInt(_0x377dfc(0x177))/0x1+parseInt(_0x377dfc(0x17d))/0x2+parseInt(_0x377dfc(0x16e))/0x3+-parseInt(_0x377dfc(0x152))/0x4*(-parseInt(_0x377dfc(0x164))/0x5)+parseInt(_0x377dfc(0x16c))/0x6*(-parseInt(_0x377dfc(0x182))/0x7)+-parseInt(_0x377dfc(0x165))/0x8*(parseInt(_0x377dfc(0x16a))/0x9)+-parseInt(_0x377dfc(0x178))/0xa;if(_0x37b0fc===_0xeccae5)break;else _0xc2ef87['push'](_0xc2ef87['shift']());}catch(_0xafadd5){_0xc2ef87['push'](_0xc2ef87['shift']());}}}(a134_0x516c,0x86ddf));const a134_0x11adaa=(function(){let _0x35569e=!![];return function(_0x49ef33,_0x49883e){const _0x23e117=_0x35569e?function(){const _0x364b6e=a134_0x2ce7;if(_0x49883e){const _0x3f8350=_0x49883e[_0x364b6e(0x155)](_0x49ef33,arguments);return _0x49883e=null,_0x3f8350;}}:function(){};return _0x35569e=![],_0x23e117;};}()),a134_0x5cf47b=a134_0x11adaa(this,function(){const _0x191dcc=a134_0x2ce7;return a134_0x5cf47b[_0x191dcc(0x17e)]()[_0x191dcc(0x17a)](_0x191dcc(0x157))[_0x191dcc(0x17e)]()['constructor'](a134_0x5cf47b)[_0x191dcc(0x17a)](_0x191dcc(0x157));});a134_0x5cf47b();function a134_0x2ce7(_0x5df976,_0x18674a){const _0x25ad4c=a134_0x516c();return a134_0x2ce7=function(_0x5cf47b,_0x11adaa){_0x5cf47b=_0x5cf47b-0x14d;let _0x516c9a=_0x25ad4c[_0x5cf47b];return _0x516c9a;},a134_0x2ce7(_0x5df976,_0x18674a);}'use strict';var __importDefault=this&&this[a134_0x1e07a6(0x17b)]||function(_0x3453b5){return _0x3453b5&&_0x3453b5['__esModule']?_0x3453b5:{'default':_0x3453b5};};Object[a134_0x1e07a6(0x169)](exports,'__esModule',{'value':!![]}),exports[a134_0x1e07a6(0x176)]=void 0x0;const core_1=require(a134_0x1e07a6(0x17c)),typedi_1=__importDefault(require(a134_0x1e07a6(0x16d))),salesforce_query_service_1=require(a134_0x1e07a6(0x171)),queries_1=require(a134_0x1e07a6(0x180)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x47cb28){const _0x2e80cd=a134_0x1e07a6;this[_0x2e80cd(0x14d)]=_0x47cb28,this['logger']=new core_1[(_0x2e80cd(0x15c))](SalesforceRetrieverService[_0x2e80cd(0x168)]),this[_0x2e80cd(0x175)]=0xbb8,this[_0x2e80cd(0x161)]=0x1f4;}async[a134_0x1e07a6(0x170)](_0x1a3ade){const _0x9226d6=a134_0x1e07a6;this[_0x9226d6(0x154)][_0x9226d6(0x158)](_0x9226d6(0x15b),_0x1a3ade[_0x9226d6(0x156)]);const _0x30bddd=typedi_1[_0x9226d6(0x16b)][_0x9226d6(0x160)](salesforce_query_service_1[_0x9226d6(0x150)]),_0x551322=_0x1a3ade[_0x9226d6(0x151)](_0x5a3a3c=>'\x27'+_0x5a3a3c+'\x27'),_0x34327d=[];while(_0x551322[_0x9226d6(0x156)]){const _0x42c3d4=_0x551322[_0x9226d6(0x14e)](0x0,this[_0x9226d6(0x161)]),_0x1a885b=_0x30bddd[_0x9226d6(0x183)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x9226d6(0x15f)](_0x9226d6(0x15e),_0x42c3d4[_0x9226d6(0x162)]())),_0x3a5348=_0x30bddd[_0x9226d6(0x183)](queries_1[_0x9226d6(0x153)][_0x9226d6(0x15f)]('%ids%',_0x42c3d4[_0x9226d6(0x162)]()))[_0x9226d6(0x163)](_0x4d2eb9=>_0x4d2eb9[_0x9226d6(0x151)](_0x419293=>flosum_component_history_dto_1[_0x9226d6(0x172)][_0x9226d6(0x14f)](_0x419293))),[_0x5329c5,_0x330ab0]=await Promise[_0x9226d6(0x167)]([_0x1a885b,_0x3a5348]);for(const _0x49eae8 of _0x330ab0){const _0x3921b6=_0x5329c5['find'](_0x185717=>_0x185717['ParentId']===_0x49eae8['id']);_0x3921b6&&_0x34327d[_0x9226d6(0x15a)]({'fileType':_0x3921b6[_0x9226d6(0x17f)],'fileName':_0x49eae8['filename'],'attachmentId':_0x3921b6['Id']});}}return _0x34327d;}async[a134_0x1e07a6(0x159)](_0x5d094a){const _0x3f326d=a134_0x1e07a6,_0x3674ff=await this[_0x3f326d(0x170)](_0x5d094a);this['logger']['info'](_0x3f326d(0x181));const _0x47d46e=[];for(const _0x471176 of _0x3674ff){const _0x17cd2f=await this['salesforceService'][_0x3f326d(0x16f)](_0x471176[_0x3f326d(0x15d)],!![]);_0x47d46e['push']({'body':_0x17cd2f[_0x3f326d(0x17e)](_0x3f326d(0x166)),'fileName':_0x471176[_0x3f326d(0x173)],'fileType':_0x471176[_0x3f326d(0x184)]}),this[_0x3f326d(0x154)][_0x3f326d(0x158)]('manually\x20retrieved\x20%d/%d\x20components',_0x47d46e[_0x3f326d(0x156)],_0x5d094a[_0x3f326d(0x156)]);}return _0x47d46e;}async['run'](_0x423740){const _0x406e61=a134_0x1e07a6,_0x29a41c=[..._0x423740],_0x29b5cd=[],_0x4e1538=[];while(_0x29a41c['length']){const _0x2c1558=_0x29a41c[_0x406e61(0x14e)](0x0,this['COMPONENTS_PER_REQUEST']),_0x512916=await this[_0x406e61(0x14d)]['retrieveComponents'](_0x2c1558);_0x2c1558[_0x406e61(0x156)]!==_0x512916['ids'][_0x406e61(0x156)]?(_0x29a41c['push'](..._0x512916['ids']),_0x29b5cd[_0x406e61(0x15a)](..._0x512916['components'])):_0x4e1538['push'](..._0x2c1558),this[_0x406e61(0x154)][_0x406e61(0x179)](_0x406e61(0x174),_0x423740[_0x406e61(0x156)]-_0x29a41c[_0x406e61(0x156)],_0x423740[_0x406e61(0x156)]);}if(_0x4e1538['length']){const _0x1c3bf8=await this[_0x406e61(0x159)](_0x4e1538);_0x29b5cd['push'](..._0x1c3bf8);}return _0x29b5cd;}}exports[a134_0x1e07a6(0x176)]=SalesforceRetrieverService;