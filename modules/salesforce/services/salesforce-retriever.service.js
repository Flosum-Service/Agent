const a135_0xdb7f2c=a135_0x3425;(function(_0x11d5d3,_0x46a8ac){const _0x30e665=a135_0x3425,_0xc6cb24=_0x11d5d3();while(!![]){try{const _0x1bb00d=-parseInt(_0x30e665(0xb6))/0x1+-parseInt(_0x30e665(0xc9))/0x2*(-parseInt(_0x30e665(0xc0))/0x3)+-parseInt(_0x30e665(0xd0))/0x4*(-parseInt(_0x30e665(0xc5))/0x5)+-parseInt(_0x30e665(0xa8))/0x6+-parseInt(_0x30e665(0xbc))/0x7+-parseInt(_0x30e665(0xb2))/0x8+-parseInt(_0x30e665(0xcb))/0x9*(-parseInt(_0x30e665(0xc1))/0xa);if(_0x1bb00d===_0x46a8ac)break;else _0xc6cb24['push'](_0xc6cb24['shift']());}catch(_0x9e3cec){_0xc6cb24['push'](_0xc6cb24['shift']());}}}(a135_0x3230,0x3d325));const a135_0x5b4f65=(function(){let _0x481180=!![];return function(_0x13cd59,_0xf33363){const _0x4b8189=_0x481180?function(){const _0xf1b554=a135_0x3425;if(_0xf33363){const _0x548729=_0xf33363[_0xf1b554(0xa6)](_0x13cd59,arguments);return _0xf33363=null,_0x548729;}}:function(){};return _0x481180=![],_0x4b8189;};}()),a135_0x2acd77=a135_0x5b4f65(this,function(){const _0x454031=a135_0x3425;return a135_0x2acd77[_0x454031(0xb0)]()[_0x454031(0xdb)](_0x454031(0xd6))[_0x454031(0xb0)]()[_0x454031(0xb8)](a135_0x2acd77)['search'](_0x454031(0xd6));});a135_0x2acd77();function a135_0x3425(_0x15f642,_0x5c2445){const _0x15d244=a135_0x3230();return a135_0x3425=function(_0x2acd77,_0x5b4f65){_0x2acd77=_0x2acd77-0xa3;let _0x323059=_0x15d244[_0x2acd77];return _0x323059;},a135_0x3425(_0x15f642,_0x5c2445);}'use strict';var __importDefault=this&&this[a135_0xdb7f2c(0xc8)]||function(_0x5ecef9){const _0x2edc9=a135_0xdb7f2c;return _0x5ecef9&&_0x5ecef9[_0x2edc9(0xd5)]?_0x5ecef9:{'default':_0x5ecef9};};function a135_0x3230(){const _0x8d26c8=['log','./salesforce-query.service','5eYFGqO','replace','join','__importDefault','86Cbnzns','ids','324MhqZUB','get','retrieveAttachment','Name','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','1109140IeFjXO','manually\x20retrieved\x20%d/%d\x20components','FlosumComponentHistoryDto','find','Logger','__esModule','(((.+)+)+)+$','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','map','GET_COMPONENT_HISTORIES_BY_IDS','salesforceService','search','name','typedi','info','manually\x20retrieving\x20components\x20from\x20salesforce','default','ParentId','retrieveComponents','apply','COMPONENTS_PER_QUERY','2529786PDoNsj','defineProperty','retrieveLastComponents','fileName','fromSalesforce','then','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','%parent_ids%','toString','logger','3051160shmpwF','attachmentId','query','length','217553mAnhFO','push','constructor','%ids%','fileType','base64','795949XYHtks','run','COMPONENTS_PER_REQUEST','SalesforceRetrieverService','24306weeSoT','210910uugIIr','retrieveComponentIdsFromHistoryIds'];a135_0x3230=function(){return _0x8d26c8;};return a135_0x3230();}Object[a135_0xdb7f2c(0xa9)](exports,a135_0xdb7f2c(0xd5),{'value':!![]}),exports[a135_0xdb7f2c(0xbf)]=void 0x0;const core_1=require('../../../core'),typedi_1=__importDefault(require(a135_0xdb7f2c(0xdd))),salesforce_query_service_1=require(a135_0xdb7f2c(0xc4)),queries_1=require('../queries'),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x2864b3){const _0x506ce7=a135_0xdb7f2c;this[_0x506ce7(0xda)]=_0x2864b3,this['logger']=new core_1[(_0x506ce7(0xd4))](SalesforceRetrieverService[_0x506ce7(0xdc)]),this[_0x506ce7(0xbe)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async[a135_0xdb7f2c(0xc2)](_0x534bfc){const _0x25858b=a135_0xdb7f2c;this[_0x25858b(0xb1)][_0x25858b(0xde)](_0x25858b(0xcf),_0x534bfc[_0x25858b(0xb5)]);const _0x4605f7=typedi_1[_0x25858b(0xa3)][_0x25858b(0xcc)](salesforce_query_service_1['SalesforceQueryService']),_0x16d049=_0x534bfc['map'](_0x57e845=>'\x27'+_0x57e845+'\x27'),_0x5ec2f5=[];while(_0x16d049[_0x25858b(0xb5)]){const _0xd0361a=_0x16d049['splice'](0x0,this[_0x25858b(0xa7)]),_0x46f115=_0x4605f7[_0x25858b(0xb4)](queries_1[_0x25858b(0xd7)][_0x25858b(0xc6)](_0x25858b(0xaf),_0xd0361a[_0x25858b(0xc7)]())),_0x2d0895=_0x4605f7[_0x25858b(0xb4)](queries_1[_0x25858b(0xd9)]['replace'](_0x25858b(0xb9),_0xd0361a[_0x25858b(0xc7)]()))[_0x25858b(0xad)](_0x520356=>_0x520356[_0x25858b(0xd8)](_0x2d0783=>flosum_component_history_dto_1[_0x25858b(0xd2)][_0x25858b(0xac)](_0x2d0783))),[_0x1ba4d1,_0x555de6]=await Promise['all']([_0x46f115,_0x2d0895]);for(const _0x124b1e of _0x555de6){const _0x57c631=_0x1ba4d1[_0x25858b(0xd3)](_0x27f29c=>_0x27f29c[_0x25858b(0xa4)]===_0x124b1e['id']);_0x57c631&&_0x5ec2f5[_0x25858b(0xb7)]({'fileType':_0x57c631[_0x25858b(0xce)],'fileName':_0x124b1e['filename'],'attachmentId':_0x57c631['Id']});}}return _0x5ec2f5;}async[a135_0xdb7f2c(0xaa)](_0x3ceddd){const _0x80f622=a135_0xdb7f2c,_0x5bc45b=await this['retrieveComponentIdsFromHistoryIds'](_0x3ceddd);this[_0x80f622(0xb1)]['info'](_0x80f622(0xdf));const _0x2e6dcc=[];for(const _0x13275b of _0x5bc45b){const _0x50ff57=await this[_0x80f622(0xda)][_0x80f622(0xcd)](_0x13275b[_0x80f622(0xb3)],!![]);_0x2e6dcc['push']({'body':_0x50ff57['toString'](_0x80f622(0xbb)),'fileName':_0x13275b[_0x80f622(0xab)],'fileType':_0x13275b[_0x80f622(0xba)]}),this[_0x80f622(0xb1)][_0x80f622(0xde)](_0x80f622(0xd1),_0x2e6dcc[_0x80f622(0xb5)],_0x3ceddd[_0x80f622(0xb5)]);}return _0x2e6dcc;}async[a135_0xdb7f2c(0xbd)](_0x5b86db){const _0x294f63=a135_0xdb7f2c,_0xb4a915=[..._0x5b86db],_0x28d329=[],_0x330b6b=[];while(_0xb4a915['length']){const _0x52e962=_0xb4a915['splice'](0x0,this[_0x294f63(0xbe)]),_0x428dfa=await this['salesforceService'][_0x294f63(0xa5)](_0x52e962);_0x52e962[_0x294f63(0xb5)]!==_0x428dfa[_0x294f63(0xca)][_0x294f63(0xb5)]?(_0xb4a915[_0x294f63(0xb7)](..._0x428dfa[_0x294f63(0xca)]),_0x28d329[_0x294f63(0xb7)](..._0x428dfa['components'])):_0x330b6b['push'](..._0x52e962),this[_0x294f63(0xb1)][_0x294f63(0xc3)](_0x294f63(0xae),_0x5b86db[_0x294f63(0xb5)]-_0xb4a915[_0x294f63(0xb5)],_0x5b86db['length']);}if(_0x330b6b[_0x294f63(0xb5)]){const _0x13fee9=await this['retrieveLastComponents'](_0x330b6b);_0x28d329[_0x294f63(0xb7)](..._0x13fee9);}return _0x28d329;}}exports[a135_0xdb7f2c(0xbf)]=SalesforceRetrieverService;