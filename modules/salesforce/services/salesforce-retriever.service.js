const a134_0xd9c8c5=a134_0x352c;(function(_0x4d8427,_0x3cf2c1){const _0x316e65=a134_0x352c,_0x1a824b=_0x4d8427();while(!![]){try{const _0x55c6e3=parseInt(_0x316e65(0x104))/0x1+-parseInt(_0x316e65(0x110))/0x2+parseInt(_0x316e65(0x120))/0x3+parseInt(_0x316e65(0x10c))/0x4+-parseInt(_0x316e65(0xfc))/0x5*(parseInt(_0x316e65(0x12d))/0x6)+-parseInt(_0x316e65(0x112))/0x7+parseInt(_0x316e65(0x129))/0x8;if(_0x55c6e3===_0x3cf2c1)break;else _0x1a824b['push'](_0x1a824b['shift']());}catch(_0x6e20d3){_0x1a824b['push'](_0x1a824b['shift']());}}}(a134_0x2eed,0x9d36c));function a134_0x2eed(){const _0x1198b8=['1410576GjprrY','run','4476948qpFRsW','all','retrieveComponents','then','find','%parent_ids%','salesforceService','../../../core','defineProperty','splice','apply','FlosumComponentHistoryDto','COMPONENTS_PER_QUERY','logger','1957614vPMnPT','components','push','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','typedi','map','../dto/flosum-component-history.dto','./salesforce-query.service','GET_COMPONENT_HISTORIES_BY_IDS','1887712XAaFND','fromSalesforce','info','%ids%','50904bhPSpF','../queries','Name','log','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','__esModule','name','manually\x20retrieved\x20%d/%d\x20components','length','ids','SalesforceQueryService','SalesforceRetrieverService','335zQohtO','fileType','manually\x20retrieving\x20components\x20from\x20salesforce','search','constructor','ParentId','retrieveLastComponents','filename','626239bbIgRR','default','query','(((.+)+)+)+$','retrieveComponentIdsFromHistoryIds','toString','get','__importDefault','4169948gcElJO','replace','Logger','COMPONENTS_PER_REQUEST'];a134_0x2eed=function(){return _0x1198b8;};return a134_0x2eed();}const a134_0x2a2ae5=(function(){let _0x144bab=!![];return function(_0x7e4238,_0x31830c){const _0x4d72e8=_0x144bab?function(){const _0x361675=a134_0x352c;if(_0x31830c){const _0x556c25=_0x31830c[_0x361675(0x11c)](_0x7e4238,arguments);return _0x31830c=null,_0x556c25;}}:function(){};return _0x144bab=![],_0x4d72e8;};}()),a134_0x146fba=a134_0x2a2ae5(this,function(){const _0x5abd81=a134_0x352c;return a134_0x146fba[_0x5abd81(0x109)]()[_0x5abd81(0xff)]('(((.+)+)+)+$')[_0x5abd81(0x109)]()[_0x5abd81(0x100)](a134_0x146fba)['search'](_0x5abd81(0x107));});a134_0x146fba();'use strict';var __importDefault=this&&this[a134_0xd9c8c5(0x10b)]||function(_0x5bc9cd){const _0x27671b=a134_0xd9c8c5;return _0x5bc9cd&&_0x5bc9cd[_0x27671b(0x132)]?_0x5bc9cd:{'default':_0x5bc9cd};};Object[a134_0xd9c8c5(0x11a)](exports,a134_0xd9c8c5(0x132),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a134_0xd9c8c5(0x119)),typedi_1=__importDefault(require(a134_0xd9c8c5(0x124))),salesforce_query_service_1=require(a134_0xd9c8c5(0x127)),queries_1=require(a134_0xd9c8c5(0x12e)),flosum_component_history_dto_1=require(a134_0xd9c8c5(0x126));function a134_0x352c(_0x37e950,_0x5c8928){const _0x1a15e0=a134_0x2eed();return a134_0x352c=function(_0x146fba,_0x2a2ae5){_0x146fba=_0x146fba-0xfb;let _0x2eed1f=_0x1a15e0[_0x146fba];return _0x2eed1f;},a134_0x352c(_0x37e950,_0x5c8928);}class SalesforceRetrieverService{constructor(_0x5cf7d6){const _0x336e5f=a134_0xd9c8c5;this[_0x336e5f(0x118)]=_0x5cf7d6,this[_0x336e5f(0x11f)]=new core_1[(_0x336e5f(0x10e))](SalesforceRetrieverService[_0x336e5f(0x133)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x336e5f(0x11e)]=0x1f4;}async[a134_0xd9c8c5(0x108)](_0x5a5cf9){const _0x3d2a1e=a134_0xd9c8c5;this[_0x3d2a1e(0x11f)]['info']('manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)',_0x5a5cf9['length']);const _0x1902b5=typedi_1[_0x3d2a1e(0x105)][_0x3d2a1e(0x10a)](salesforce_query_service_1[_0x3d2a1e(0x137)]),_0x1727fd=_0x5a5cf9[_0x3d2a1e(0x125)](_0x4fdb75=>'\x27'+_0x4fdb75+'\x27'),_0x590f8a=[];while(_0x1727fd[_0x3d2a1e(0x135)]){const _0x19b890=_0x1727fd[_0x3d2a1e(0x11b)](0x0,this[_0x3d2a1e(0x11e)]),_0x1e8a3c=_0x1902b5[_0x3d2a1e(0x106)](queries_1[_0x3d2a1e(0x123)]['replace'](_0x3d2a1e(0x117),_0x19b890['join']())),_0x588391=_0x1902b5[_0x3d2a1e(0x106)](queries_1[_0x3d2a1e(0x128)][_0x3d2a1e(0x10d)](_0x3d2a1e(0x12c),_0x19b890['join']()))[_0x3d2a1e(0x115)](_0x57f25d=>_0x57f25d[_0x3d2a1e(0x125)](_0x19875f=>flosum_component_history_dto_1[_0x3d2a1e(0x11d)][_0x3d2a1e(0x12a)](_0x19875f))),[_0x49d551,_0x15cc4d]=await Promise[_0x3d2a1e(0x113)]([_0x1e8a3c,_0x588391]);for(const _0x4273a9 of _0x15cc4d){const _0x417abe=_0x49d551[_0x3d2a1e(0x116)](_0x5d6487=>_0x5d6487[_0x3d2a1e(0x101)]===_0x4273a9['id']);_0x417abe&&_0x590f8a[_0x3d2a1e(0x122)]({'fileType':_0x417abe[_0x3d2a1e(0x12f)],'fileName':_0x4273a9[_0x3d2a1e(0x103)],'attachmentId':_0x417abe['Id']});}}return _0x590f8a;}async[a134_0xd9c8c5(0x102)](_0x452d46){const _0x15d74f=a134_0xd9c8c5,_0x48b5fd=await this[_0x15d74f(0x108)](_0x452d46);this['logger'][_0x15d74f(0x12b)](_0x15d74f(0xfe));const _0xa0570=[];for(const _0x257cd2 of _0x48b5fd){const _0x5a7594=await this[_0x15d74f(0x118)]['retrieveAttachment'](_0x257cd2['attachmentId'],!![]);_0xa0570[_0x15d74f(0x122)]({'body':_0x5a7594[_0x15d74f(0x109)]('base64'),'fileName':_0x257cd2['fileName'],'fileType':_0x257cd2[_0x15d74f(0xfd)]}),this[_0x15d74f(0x11f)][_0x15d74f(0x12b)](_0x15d74f(0x134),_0xa0570[_0x15d74f(0x135)],_0x452d46[_0x15d74f(0x135)]);}return _0xa0570;}async[a134_0xd9c8c5(0x111)](_0x3ad470){const _0x4348be=a134_0xd9c8c5,_0x39bfd1=[..._0x3ad470],_0x26ca05=[],_0xf5aa1e=[];while(_0x39bfd1[_0x4348be(0x135)]){const _0x45d0a2=_0x39bfd1['splice'](0x0,this[_0x4348be(0x10f)]),_0x47ccca=await this[_0x4348be(0x118)][_0x4348be(0x114)](_0x45d0a2);_0x45d0a2[_0x4348be(0x135)]!==_0x47ccca[_0x4348be(0x136)][_0x4348be(0x135)]?(_0x39bfd1['push'](..._0x47ccca['ids']),_0x26ca05[_0x4348be(0x122)](..._0x47ccca[_0x4348be(0x121)])):_0xf5aa1e[_0x4348be(0x122)](..._0x45d0a2),this[_0x4348be(0x11f)][_0x4348be(0x130)](_0x4348be(0x131),_0x3ad470['length']-_0x39bfd1[_0x4348be(0x135)],_0x3ad470[_0x4348be(0x135)]);}if(_0xf5aa1e['length']){const _0x2849f4=await this[_0x4348be(0x102)](_0xf5aa1e);_0x26ca05[_0x4348be(0x122)](..._0x2849f4);}return _0x26ca05;}}exports[a134_0xd9c8c5(0xfb)]=SalesforceRetrieverService;