const a135_0x5a9119=a135_0x4fcc;(function(_0x4cf9ea,_0x4f270d){const _0x2c6223=a135_0x4fcc,_0x4ba162=_0x4cf9ea();while(!![]){try{const _0x3812c7=parseInt(_0x2c6223(0x1f0))/0x1*(-parseInt(_0x2c6223(0x1ea))/0x2)+parseInt(_0x2c6223(0x209))/0x3*(-parseInt(_0x2c6223(0x201))/0x4)+-parseInt(_0x2c6223(0x1f5))/0x5+-parseInt(_0x2c6223(0x1ef))/0x6+parseInt(_0x2c6223(0x203))/0x7+-parseInt(_0x2c6223(0x1fd))/0x8+-parseInt(_0x2c6223(0x21d))/0x9*(-parseInt(_0x2c6223(0x211))/0xa);if(_0x3812c7===_0x4f270d)break;else _0x4ba162['push'](_0x4ba162['shift']());}catch(_0x9f6b04){_0x4ba162['push'](_0x4ba162['shift']());}}}(a135_0x507e,0x65fc1));const a135_0x53791f=(function(){let _0x307385=!![];return function(_0x49c9df,_0x5da954){const _0x45b151=_0x307385?function(){const _0x5cb7c2=a135_0x4fcc;if(_0x5da954){const _0xf98803=_0x5da954[_0x5cb7c2(0x20a)](_0x49c9df,arguments);return _0x5da954=null,_0xf98803;}}:function(){};return _0x307385=![],_0x45b151;};}()),a135_0x45e701=a135_0x53791f(this,function(){const _0x2e94ff=a135_0x4fcc;return a135_0x45e701[_0x2e94ff(0x212)]()['search'](_0x2e94ff(0x1f7))[_0x2e94ff(0x212)]()['constructor'](a135_0x45e701)[_0x2e94ff(0x206)](_0x2e94ff(0x1f7));});a135_0x45e701();'use strict';var __importDefault=this&&this[a135_0x5a9119(0x202)]||function(_0x358b05){const _0x1a293c=a135_0x5a9119;return _0x358b05&&_0x358b05[_0x1a293c(0x205)]?_0x358b05:{'default':_0x358b05};};function a135_0x4fcc(_0x183722,_0x342880){const _0x1ffe95=a135_0x507e();return a135_0x4fcc=function(_0x45e701,_0x53791f){_0x45e701=_0x45e701-0x1e8;let _0x507edc=_0x1ffe95[_0x45e701];return _0x507edc;},a135_0x4fcc(_0x183722,_0x342880);}Object['defineProperty'](exports,a135_0x5a9119(0x205),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a135_0x5a9119(0x216)),typedi_1=__importDefault(require(a135_0x5a9119(0x21c))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a135_0x5a9119(0x204)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x4ff969){const _0x409fbc=a135_0x5a9119;this[_0x409fbc(0x21b)]=_0x4ff969,this[_0x409fbc(0x1f3)]=new core_1[(_0x409fbc(0x1fb))](SalesforceRetrieverService[_0x409fbc(0x20e)]),this[_0x409fbc(0x219)]=0xbb8,this[_0x409fbc(0x210)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x6e7eea){const _0x5a5622=a135_0x5a9119;this['logger']['info'](_0x5a5622(0x208),_0x6e7eea['length']);const _0x1be5c1=typedi_1['default'][_0x5a5622(0x221)](salesforce_query_service_1[_0x5a5622(0x215)]),_0x1bc99=_0x6e7eea[_0x5a5622(0x21f)](_0x37e9de=>'\x27'+_0x37e9de+'\x27'),_0x363883=[];while(_0x1bc99['length']){const _0xcecbec=_0x1bc99[_0x5a5622(0x1eb)](0x0,this[_0x5a5622(0x210)]),_0x43dbbb=_0x1be5c1[_0x5a5622(0x218)](queries_1[_0x5a5622(0x1ec)][_0x5a5622(0x1f8)](_0x5a5622(0x1e8),_0xcecbec[_0x5a5622(0x20c)]())),_0x3870e0=_0x1be5c1[_0x5a5622(0x218)](queries_1[_0x5a5622(0x1f4)][_0x5a5622(0x1f8)](_0x5a5622(0x1e9),_0xcecbec[_0x5a5622(0x20c)]()))['then'](_0x4685b5=>_0x4685b5['map'](_0x3e12a6=>flosum_component_history_dto_1[_0x5a5622(0x1f1)][_0x5a5622(0x20f)](_0x3e12a6))),[_0x5bf9cb,_0x183ebe]=await Promise[_0x5a5622(0x1fa)]([_0x43dbbb,_0x3870e0]);for(const _0x2f338e of _0x183ebe){const _0x25229a=_0x5bf9cb[_0x5a5622(0x200)](_0x1d6f96=>_0x1d6f96[_0x5a5622(0x1f6)]===_0x2f338e['id']);_0x25229a&&_0x363883[_0x5a5622(0x20d)]({'fileType':_0x25229a['Name'],'fileName':_0x2f338e['filename'],'attachmentId':_0x25229a['Id']});}}return _0x363883;}async[a135_0x5a9119(0x214)](_0x427107){const _0x3e86eb=a135_0x5a9119,_0x52c3a6=await this[_0x3e86eb(0x220)](_0x427107);this['logger'][_0x3e86eb(0x1ee)](_0x3e86eb(0x207));const _0x3248a9=[];for(const _0x42b1e9 of _0x52c3a6){const _0x528da8=await this['salesforceService'][_0x3e86eb(0x213)](_0x42b1e9[_0x3e86eb(0x20b)],!![]);_0x3248a9[_0x3e86eb(0x20d)]({'body':_0x528da8[_0x3e86eb(0x212)]('base64'),'fileName':_0x42b1e9[_0x3e86eb(0x1ff)],'fileType':_0x42b1e9[_0x3e86eb(0x1f9)]}),this[_0x3e86eb(0x1f3)][_0x3e86eb(0x1ee)](_0x3e86eb(0x21e),_0x3248a9['length'],_0x427107[_0x3e86eb(0x1fe)]);}return _0x3248a9;}async['run'](_0x292761){const _0x30f879=a135_0x5a9119,_0x4cc856=[..._0x292761],_0x5ee230=[],_0x1d4c13=[];while(_0x4cc856[_0x30f879(0x1fe)]){const _0x11cb0a=_0x4cc856[_0x30f879(0x1eb)](0x0,this[_0x30f879(0x219)]),_0x5cbe9e=await this['salesforceService'][_0x30f879(0x21a)](_0x11cb0a);_0x11cb0a[_0x30f879(0x1fe)]!==_0x5cbe9e[_0x30f879(0x1f2)][_0x30f879(0x1fe)]?(_0x4cc856[_0x30f879(0x20d)](..._0x5cbe9e[_0x30f879(0x1f2)]),_0x5ee230['push'](..._0x5cbe9e['components'])):_0x1d4c13[_0x30f879(0x20d)](..._0x11cb0a),this[_0x30f879(0x1f3)][_0x30f879(0x1ed)](_0x30f879(0x1fc),_0x292761[_0x30f879(0x1fe)]-_0x4cc856[_0x30f879(0x1fe)],_0x292761[_0x30f879(0x1fe)]);}if(_0x1d4c13['length']){const _0x1714c9=await this[_0x30f879(0x214)](_0x1d4c13);_0x5ee230[_0x30f879(0x20d)](..._0x1714c9);}return _0x5ee230;}}function a135_0x507e(){const _0x14b3e9=['GET_COMPONENT_HISTORIES_BY_IDS','940725OkELBb','ParentId','(((.+)+)+)+$','replace','fileType','all','Logger','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','6473296zbJnGq','length','fileName','find','4rThCKR','__importDefault','4434843wGMWSF','../queries','__esModule','search','manually\x20retrieving\x20components\x20from\x20salesforce','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','1463757kYWIku','apply','attachmentId','join','push','name','fromSalesforce','COMPONENTS_PER_QUERY','110smFdnF','toString','retrieveAttachment','retrieveLastComponents','SalesforceQueryService','../../../core','SalesforceRetrieverService','query','COMPONENTS_PER_REQUEST','retrieveComponents','salesforceService','typedi','1651437ZBsKKT','manually\x20retrieved\x20%d/%d\x20components','map','retrieveComponentIdsFromHistoryIds','get','%parent_ids%','%ids%','816502ueqqFv','splice','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','log','info','2044596teNenD','1QTDsxk','FlosumComponentHistoryDto','ids','logger'];a135_0x507e=function(){return _0x14b3e9;};return a135_0x507e();}exports[a135_0x5a9119(0x217)]=SalesforceRetrieverService;