const a135_0x422197=a135_0x1f59;(function(_0x33b9c1,_0x448281){const _0x51eadc=a135_0x1f59,_0x1b0eb8=_0x33b9c1();while(!![]){try{const _0x1293b5=parseInt(_0x51eadc(0x174))/0x1+parseInt(_0x51eadc(0x188))/0x2+-parseInt(_0x51eadc(0x18d))/0x3*(parseInt(_0x51eadc(0x148))/0x4)+-parseInt(_0x51eadc(0x18a))/0x5+parseInt(_0x51eadc(0x156))/0x6+parseInt(_0x51eadc(0x15a))/0x7*(parseInt(_0x51eadc(0x13c))/0x8)+-parseInt(_0x51eadc(0x18f))/0x9*(parseInt(_0x51eadc(0x14d))/0xa);if(_0x1293b5===_0x448281)break;else _0x1b0eb8['push'](_0x1b0eb8['shift']());}catch(_0x1fb396){_0x1b0eb8['push'](_0x1b0eb8['shift']());}}}(a135_0x15f4,0xb8ae2));function a135_0x1f59(_0x365887,_0x43a22c){const _0x1a5684=a135_0x15f4();return a135_0x1f59=function(_0x2ce83d,_0x16275f){_0x2ce83d=_0x2ce83d-0x13a;let _0x15f4b7=_0x1a5684[_0x2ce83d];return _0x15f4b7;},a135_0x1f59(_0x365887,_0x43a22c);}const a135_0x16275f=(function(){let _0xaca8b4=!![];return function(_0x54cce0,_0x3a56fe){const _0x4a0a5f=_0xaca8b4?function(){if(_0x3a56fe){const _0x428679=_0x3a56fe['apply'](_0x54cce0,arguments);return _0x3a56fe=null,_0x428679;}}:function(){};return _0xaca8b4=![],_0x4a0a5f;};}()),a135_0x2ce83d=a135_0x16275f(this,function(){const _0x14c04a=a135_0x1f59;return a135_0x2ce83d[_0x14c04a(0x13e)]()[_0x14c04a(0x173)](_0x14c04a(0x13f))[_0x14c04a(0x13e)]()[_0x14c04a(0x14f)](a135_0x2ce83d)[_0x14c04a(0x173)]('(((.+)+)+)+$');});a135_0x2ce83d();'use strict';var __decorate=this&&this['__decorate']||function(_0x4648e8,_0x5e0c8d,_0x3fb17b,_0xb00c47){const _0x28919f=a135_0x1f59;var _0x139bd7=arguments[_0x28919f(0x18e)],_0x30a1f4=_0x139bd7<0x3?_0x5e0c8d:_0xb00c47===null?_0xb00c47=Object[_0x28919f(0x163)](_0x5e0c8d,_0x3fb17b):_0xb00c47,_0x48832a;if(typeof Reflect===_0x28919f(0x179)&&typeof Reflect[_0x28919f(0x141)]==='function')_0x30a1f4=Reflect['decorate'](_0x4648e8,_0x5e0c8d,_0x3fb17b,_0xb00c47);else{for(var _0x824dd=_0x4648e8[_0x28919f(0x18e)]-0x1;_0x824dd>=0x0;_0x824dd--)if(_0x48832a=_0x4648e8[_0x824dd])_0x30a1f4=(_0x139bd7<0x3?_0x48832a(_0x30a1f4):_0x139bd7>0x3?_0x48832a(_0x5e0c8d,_0x3fb17b,_0x30a1f4):_0x48832a(_0x5e0c8d,_0x3fb17b))||_0x30a1f4;}return _0x139bd7>0x3&&_0x30a1f4&&Object[_0x28919f(0x170)](_0x5e0c8d,_0x3fb17b,_0x30a1f4),_0x30a1f4;},__metadata=this&&this['__metadata']||function(_0x3914e0,_0xefd814){const _0x26d927=a135_0x1f59;if(typeof Reflect==='object'&&typeof Reflect[_0x26d927(0x182)]===_0x26d927(0x183))return Reflect['metadata'](_0x3914e0,_0xefd814);};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a135_0x422197(0x164)]=void 0x0;function a135_0x15f4(){const _0x259b4b=['text/plain','GET_WAITING_REPOSITORIES_QUERY','GET_WAITING_BRANCHES_QUERY','getOwnPropertyDescriptor','SalesforceSyncService','patchObject','SYNC_ATTACHMENT_FOR_BRANCH_NAME','../queries','stringify','getRepositoryRecordByName','GET_COMPONENTS_QUERY','getRepositoryRecord','getComponentsFromRepository','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','setStatus','%id%','defineProperty','Sync_In_Progress__c','getBranchRecord','search','1487041PXmwYR','disableSync','Repository\x20','fromRepositoryRecord','../../../constants','object','catch','Service','map','salesforceQuery','getComponents','../dto/flosum-repository-sync.dto','../../shared/utils','repositoryId','metadata','function','ERR_INVALID_ATTACHMENT_ID','salesforceService','FLOSUM_NAMESPACE','design:paramtypes','2966956lvEuHh','fromBranchRecord','2382335gDaIGH','getBranchComponents','objectType','27srRLYs','length','3258036XhOifF','FLOSUM_GIT_NAMESPACE','./salesforce-query.service','typedi','8dNCBvx','createObject','toString','(((.+)+)+)+$','encodeBase64','decorate','getRepositoryRecords','Synchronization_Status__c','push','%name%','getAttachmentId','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','302844iynGsV','FlosumRepositorySyncDto','records','getBranchRecords','SalesforceNotFoundError','70hQxCdT','query','constructor','../../../constants/errors','../errors/not-found.error','getRemoteStateAttachmentId','Git_Settings__c','replace','\x20not\x20found\x20on\x20salesforce','1208268LtkBvF','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','SalesforceService','Repository\x20with\x20Id\x20','8935129BBqDsC','./salesforce.service','GET_REPOSITORY_QUERY','Attachment','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','objectId'];a135_0x15f4=function(){return _0x259b4b;};return a135_0x15f4();}const typedi_1=require(a135_0x422197(0x13b)),constants_1=require(a135_0x422197(0x178)),errors_1=require(a135_0x422197(0x150)),utils_1=require(a135_0x422197(0x180)),flosum_repository_sync_dto_1=require(a135_0x422197(0x17f)),not_found_error_1=require(a135_0x422197(0x151)),queries_1=require(a135_0x422197(0x167)),salesforce_query_service_1=require(a135_0x422197(0x13a)),salesforce_service_1=require(a135_0x422197(0x15b));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x2cae16,_0x5e18d7){const _0x2fd8e8=a135_0x422197;this[_0x2fd8e8(0x17d)]=_0x2cae16,this[_0x2fd8e8(0x185)]=_0x5e18d7;}async[a135_0x422197(0x17e)](_0x3051f4){const _0x1da2fa=a135_0x422197;var _0x4cc879;const _0x23c4fa=await this[_0x1da2fa(0x17d)][_0x1da2fa(0x14e)](_0x3051f4),_0x17fd4a=[];for(const _0x39aefb of _0x23c4fa){const _0x4361cd=(_0x4cc879=_0x39aefb[constants_1[_0x1da2fa(0x186)]+'Components__r'])===null||_0x4cc879===void 0x0?void 0x0:_0x4cc879[_0x1da2fa(0x14a)];_0x4361cd&&_0x4361cd[_0x1da2fa(0x18e)]&&_0x17fd4a[_0x1da2fa(0x144)](_0x4361cd[0x0]['Id']);}return _0x17fd4a;}async[a135_0x422197(0x142)](){const _0x14c777=a135_0x422197,_0x21af8b=await this[_0x14c777(0x17d)]['query'](queries_1[_0x14c777(0x161)]);return _0x21af8b[_0x14c777(0x17c)](_0x23d852=>flosum_repository_sync_dto_1[_0x14c777(0x149)][_0x14c777(0x177)](_0x23d852));}async[a135_0x422197(0x14b)](){const _0x7a07ce=a135_0x422197,_0x2debc2=await this[_0x7a07ce(0x17d)][_0x7a07ce(0x14e)](queries_1[_0x7a07ce(0x162)]);return _0x2debc2[_0x7a07ce(0x17c)](_0x47c184=>flosum_repository_sync_dto_1[_0x7a07ce(0x149)][_0x7a07ce(0x189)](_0x47c184));}async[a135_0x422197(0x16b)](_0x29cc8b){const _0x1b1857=a135_0x422197,_0x469f76=await this[_0x1b1857(0x17d)][_0x1b1857(0x14e)](queries_1[_0x1b1857(0x15c)][_0x1b1857(0x154)](_0x1b1857(0x16f),_0x29cc8b));if(_0x469f76[_0x1b1857(0x18e)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x1b1857(0x159)+_0x29cc8b+_0x1b1857(0x155));return flosum_repository_sync_dto_1[_0x1b1857(0x149)][_0x1b1857(0x177)](_0x469f76[0x0]);}async[a135_0x422197(0x172)](_0x295e15){const _0x589055=a135_0x422197,_0x3e037f=await this[_0x589055(0x17d)][_0x589055(0x14e)](queries_1['GET_BRANCH_QUERY'][_0x589055(0x154)](_0x589055(0x16f),_0x295e15));if(_0x3e037f['length']===0x0)throw new not_found_error_1[(_0x589055(0x14c))]('Branch\x20with\x20Id\x20'+_0x295e15+_0x589055(0x155));return flosum_repository_sync_dto_1[_0x589055(0x149)][_0x589055(0x189)](_0x3e037f[0x0]);}async['getBranchRecordByName'](_0x620ee1){const _0x43021f=a135_0x422197,_0x34979a=await this[_0x43021f(0x17d)][_0x43021f(0x14e)](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x43021f(0x154)](_0x43021f(0x145),_0x620ee1));if(_0x34979a['length']===0x0)throw new not_found_error_1[(_0x43021f(0x14c))]('Branch\x20'+_0x620ee1+_0x43021f(0x155));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x43021f(0x189)](_0x34979a[0x0]);}async[a135_0x422197(0x169)](_0x23673d){const _0x5d235a=a135_0x422197,_0x3e687c=await this['salesforceQuery'][_0x5d235a(0x14e)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x5d235a(0x154)](_0x5d235a(0x145),_0x23673d));if(_0x3e687c[_0x5d235a(0x18e)]===0x0)throw new not_found_error_1[(_0x5d235a(0x14c))](_0x5d235a(0x176)+_0x23673d+_0x5d235a(0x155));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x5d235a(0x177)](_0x3e687c[0x0]);}async[a135_0x422197(0x16c)](_0x586247){const _0x471629=a135_0x422197,_0x17fd3b='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x471629(0x16a)]+_0x471629(0x157)+_0x586247+'\x27';return this[_0x471629(0x17e)](_0x17fd3b);}async[a135_0x422197(0x18b)](_0x1cfc58){const _0x3ea718=a135_0x422197,_0x30a8ab='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x3ea718(0x16a)]+_0x3ea718(0x15e)+_0x1cfc58+'\x27';return this[_0x3ea718(0x17e)](_0x30a8ab);}async[a135_0x422197(0x146)](_0x3ebdd4){const _0x27cbd9=a135_0x422197;var _0xb439fe;const _0x15e072=queries_1[_0x27cbd9(0x147)]['replace']('%parentId%',_0x3ebdd4[_0x27cbd9(0x15f)])[_0x27cbd9(0x154)]('%name%',_0x3ebdd4['repositoryId']?constants_1[_0x27cbd9(0x16d)]:constants_1[_0x27cbd9(0x166)]),_0x31bfae=await this['salesforceQuery'][_0x27cbd9(0x14e)](_0x15e072),_0x384dbc=(_0xb439fe=_0x31bfae[0x0])===null||_0xb439fe===void 0x0?void 0x0:_0xb439fe['Id'];if(!_0x384dbc)throw new Error(errors_1[_0x27cbd9(0x184)]);return _0x384dbc;}async['getRemoteStateAttachmentId'](_0x231683){const _0x41c7ab=a135_0x422197;let _0x23a551=await this[_0x41c7ab(0x146)](_0x231683)[_0x41c7ab(0x17a)](()=>null);return!_0x23a551&&(_0x23a551=await this[_0x41c7ab(0x185)][_0x41c7ab(0x13d)](_0x41c7ab(0x15d),{'Body':utils_1[_0x41c7ab(0x140)]('{}'),'ParentId':_0x231683['objectId'],'ContentType':_0x41c7ab(0x160),'Name':_0x231683[_0x41c7ab(0x181)]?constants_1[_0x41c7ab(0x16d)]:constants_1[_0x41c7ab(0x166)]})),_0x23a551;}async['updateRemoteState'](_0x19cadd,_0x36a1b3){const _0x18e38a=a135_0x422197,_0x1c3f7b=await this[_0x18e38a(0x152)](_0x19cadd);await this[_0x18e38a(0x185)][_0x18e38a(0x165)]('Attachment',_0x1c3f7b,{'Body':utils_1[_0x18e38a(0x140)](JSON[_0x18e38a(0x168)](_0x36a1b3))});}async[a135_0x422197(0x16e)](_0x16d793,_0x416257){const _0x595156=a135_0x422197;await this[_0x595156(0x185)][_0x595156(0x165)](_0x16d793[_0x595156(0x18c)],_0x16d793['objectId'],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x595156(0x143)]:_0x416257});}async[a135_0x422197(0x175)](_0x939bb0){const _0x46e11d=a135_0x422197;await this[_0x46e11d(0x185)][_0x46e11d(0x165)](constants_1[_0x46e11d(0x190)]+_0x46e11d(0x153),_0x939bb0,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x46e11d(0x171)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a135_0x422197(0x17b)](),__metadata(a135_0x422197(0x187),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a135_0x422197(0x158)]])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;