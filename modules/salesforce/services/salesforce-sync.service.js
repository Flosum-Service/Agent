const a136_0x49aeb2=a136_0x1141;(function(_0x458d64,_0x254e75){const _0x3adfca=a136_0x1141,_0x393979=_0x458d64();while(!![]){try{const _0x311ad4=-parseInt(_0x3adfca(0x97))/0x1*(-parseInt(_0x3adfca(0xb9))/0x2)+parseInt(_0x3adfca(0xa0))/0x3*(parseInt(_0x3adfca(0xa7))/0x4)+-parseInt(_0x3adfca(0xa4))/0x5*(parseInt(_0x3adfca(0xa5))/0x6)+-parseInt(_0x3adfca(0x83))/0x7*(-parseInt(_0x3adfca(0xce))/0x8)+-parseInt(_0x3adfca(0xb8))/0x9*(-parseInt(_0x3adfca(0xaf))/0xa)+parseInt(_0x3adfca(0xb4))/0xb*(-parseInt(_0x3adfca(0xb1))/0xc)+parseInt(_0x3adfca(0x8f))/0xd*(-parseInt(_0x3adfca(0x96))/0xe);if(_0x311ad4===_0x254e75)break;else _0x393979['push'](_0x393979['shift']());}catch(_0x308288){_0x393979['push'](_0x393979['shift']());}}}(a136_0x30e0,0xec80e));const a136_0x13a7e0=(function(){let _0x2bb8d0=!![];return function(_0x487287,_0x1e82e8){const _0x17ae7b=_0x2bb8d0?function(){const _0x1c1725=a136_0x1141;if(_0x1e82e8){const _0x3c3ff1=_0x1e82e8[_0x1c1725(0xca)](_0x487287,arguments);return _0x1e82e8=null,_0x3c3ff1;}}:function(){};return _0x2bb8d0=![],_0x17ae7b;};}()),a136_0x5cdc06=a136_0x13a7e0(this,function(){const _0x12db4c=a136_0x1141;return a136_0x5cdc06['toString']()[_0x12db4c(0x78)](_0x12db4c(0x89))[_0x12db4c(0x84)]()[_0x12db4c(0xc8)](a136_0x5cdc06)[_0x12db4c(0x78)](_0x12db4c(0x89));});function a136_0x1141(_0x47af09,_0x28fb53){const _0x554299=a136_0x30e0();return a136_0x1141=function(_0x5cdc06,_0x13a7e0){_0x5cdc06=_0x5cdc06-0x77;let _0x30e04c=_0x554299[_0x5cdc06];return _0x30e04c;},a136_0x1141(_0x47af09,_0x28fb53);}a136_0x5cdc06();'use strict';var __decorate=this&&this[a136_0x49aeb2(0xba)]||function(_0x3293f9,_0x46fc5d,_0x2248d2,_0x367fb9){const _0x19943e=a136_0x49aeb2;var _0x9dd29e=arguments[_0x19943e(0xbe)],_0x4b4219=_0x9dd29e<0x3?_0x46fc5d:_0x367fb9===null?_0x367fb9=Object[_0x19943e(0xa9)](_0x46fc5d,_0x2248d2):_0x367fb9,_0x989856;if(typeof Reflect===_0x19943e(0x9f)&&typeof Reflect[_0x19943e(0x8c)]===_0x19943e(0xd3))_0x4b4219=Reflect[_0x19943e(0x8c)](_0x3293f9,_0x46fc5d,_0x2248d2,_0x367fb9);else{for(var _0x457c6d=_0x3293f9['length']-0x1;_0x457c6d>=0x0;_0x457c6d--)if(_0x989856=_0x3293f9[_0x457c6d])_0x4b4219=(_0x9dd29e<0x3?_0x989856(_0x4b4219):_0x9dd29e>0x3?_0x989856(_0x46fc5d,_0x2248d2,_0x4b4219):_0x989856(_0x46fc5d,_0x2248d2))||_0x4b4219;}return _0x9dd29e>0x3&&_0x4b4219&&Object[_0x19943e(0x81)](_0x46fc5d,_0x2248d2,_0x4b4219),_0x4b4219;},__metadata=this&&this['__metadata']||function(_0x3b2282,_0x1e5121){const _0x55fed8=a136_0x49aeb2;if(typeof Reflect===_0x55fed8(0x9f)&&typeof Reflect[_0x55fed8(0x7c)]===_0x55fed8(0xd3))return Reflect[_0x55fed8(0x7c)](_0x3b2282,_0x1e5121);};Object['defineProperty'](exports,a136_0x49aeb2(0x77),{'value':!![]}),exports[a136_0x49aeb2(0x91)]=void 0x0;function a136_0x30e0(){const _0x1e0882=['push','839482dBGoRf','197479AYKLWf','Synchronization_Status__c','fromRepositoryRecord','typedi','./salesforce.service','%name%','FLOSUM_NAMESPACE','SalesforceQueryService','object','88971uaRuzt','records','text/plain','fromBranchRecord','957140FVaQNu','30korRyW','encodeBase64','176iejhnT','GET_WAITING_BRANCHES_QUERY','getOwnPropertyDescriptor','Service','getAttachmentId','FlosumRepositorySyncDto','Attachment','query','1364830yiNnOD','catch','670164QlyYGu','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','stringify','275mqkMxB','getRemoteStateAttachmentId','../../../constants/errors','salesforceQuery','99eZTVaE','6cqbzue','__decorate','../../../constants','GET_BRANCH_QUERY','Branch\x20','length','GET_WAITING_REPOSITORIES_QUERY','objectType','%id%','setStatus','SalesforceNotFoundError','../errors/not-found.error','map','../dto/flosum-repository-sync.dto','../queries','constructor','Components__r','apply','patchObject','disableSync','getRepositoryRecords','8tFWfIE','SYNC_ATTACHMENT_FOR_BRANCH_NAME','Repository\x20','design:paramtypes','replace','function','GET_REPOSITORY_QUERY','__esModule','search','../../shared/utils','createObject','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','metadata','GET_COMPONENTS_QUERY','repositoryId','getBranchComponents','Git_Settings__c','defineProperty','getRepositoryRecord','2821553erctJh','toString','salesforceService','getComponents','FLOSUM_GIT_NAMESPACE','./salesforce-query.service','(((.+)+)+)+$','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','objectId','decorate','ERR_INVALID_ATTACHMENT_ID','\x20not\x20found\x20on\x20salesforce','104NVsMyg','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','SalesforceSyncService','Sync_In_Progress__c','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','GET_REPOSITORY_BY_NAME_QUERY'];a136_0x30e0=function(){return _0x1e0882;};return a136_0x30e0();}const typedi_1=require(a136_0x49aeb2(0x9a)),constants_1=require(a136_0x49aeb2(0xbb)),errors_1=require(a136_0x49aeb2(0xb6)),utils_1=require(a136_0x49aeb2(0x79)),flosum_repository_sync_dto_1=require(a136_0x49aeb2(0xc6)),not_found_error_1=require(a136_0x49aeb2(0xc4)),queries_1=require(a136_0x49aeb2(0xc7)),salesforce_query_service_1=require(a136_0x49aeb2(0x88)),salesforce_service_1=require(a136_0x49aeb2(0x9b));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x1d352f,_0xec2dfe){const _0x3d93aa=a136_0x49aeb2;this[_0x3d93aa(0xb7)]=_0x1d352f,this[_0x3d93aa(0x85)]=_0xec2dfe;}async[a136_0x49aeb2(0x86)](_0x15e237){const _0x29b258=a136_0x49aeb2;var _0x3b8f60;const _0x489810=await this[_0x29b258(0xb7)][_0x29b258(0xae)](_0x15e237),_0x9aec3d=[];for(const _0x40fac6 of _0x489810){const _0x18005c=(_0x3b8f60=_0x40fac6[constants_1[_0x29b258(0x9d)]+_0x29b258(0xc9)])===null||_0x3b8f60===void 0x0?void 0x0:_0x3b8f60[_0x29b258(0xa1)];_0x18005c&&_0x18005c[_0x29b258(0xbe)]&&_0x9aec3d[_0x29b258(0x95)](_0x18005c[0x0]['Id']);}return _0x9aec3d;}async[a136_0x49aeb2(0xcd)](){const _0x287bd6=a136_0x49aeb2,_0x4fdb32=await this[_0x287bd6(0xb7)][_0x287bd6(0xae)](queries_1[_0x287bd6(0xbf)]);return _0x4fdb32[_0x287bd6(0xc5)](_0x1f6d58=>flosum_repository_sync_dto_1[_0x287bd6(0xac)][_0x287bd6(0x99)](_0x1f6d58));}async['getBranchRecords'](){const _0x3bd3d0=a136_0x49aeb2,_0x38934e=await this[_0x3bd3d0(0xb7)][_0x3bd3d0(0xae)](queries_1[_0x3bd3d0(0xa8)]);return _0x38934e['map'](_0x80b8f5=>flosum_repository_sync_dto_1[_0x3bd3d0(0xac)][_0x3bd3d0(0xa3)](_0x80b8f5));}async[a136_0x49aeb2(0x82)](_0x4559a9){const _0x191135=a136_0x49aeb2,_0x6fd110=await this[_0x191135(0xb7)][_0x191135(0xae)](queries_1[_0x191135(0xd4)][_0x191135(0xd2)](_0x191135(0xc1),_0x4559a9));if(_0x6fd110[_0x191135(0xbe)]===0x0)throw new not_found_error_1[(_0x191135(0xc3))]('Repository\x20with\x20Id\x20'+_0x4559a9+_0x191135(0x8e));return flosum_repository_sync_dto_1[_0x191135(0xac)]['fromRepositoryRecord'](_0x6fd110[0x0]);}async['getBranchRecord'](_0x54e1cf){const _0x32546d=a136_0x49aeb2,_0x13dc1e=await this[_0x32546d(0xb7)][_0x32546d(0xae)](queries_1[_0x32546d(0xbc)][_0x32546d(0xd2)](_0x32546d(0xc1),_0x54e1cf));if(_0x13dc1e[_0x32546d(0xbe)]===0x0)throw new not_found_error_1[(_0x32546d(0xc3))]('Branch\x20with\x20Id\x20'+_0x54e1cf+_0x32546d(0x8e));return flosum_repository_sync_dto_1[_0x32546d(0xac)]['fromBranchRecord'](_0x13dc1e[0x0]);}async['getBranchRecordByName'](_0xa71f99){const _0x47ef7d=a136_0x49aeb2,_0x3142b6=await this[_0x47ef7d(0xb7)][_0x47ef7d(0xae)](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x47ef7d(0xd2)]('%name%',_0xa71f99));if(_0x3142b6[_0x47ef7d(0xbe)]===0x0)throw new not_found_error_1[(_0x47ef7d(0xc3))](_0x47ef7d(0xbd)+_0xa71f99+_0x47ef7d(0x8e));return flosum_repository_sync_dto_1[_0x47ef7d(0xac)][_0x47ef7d(0xa3)](_0x3142b6[0x0]);}async['getRepositoryRecordByName'](_0xcd6b4c){const _0x3341de=a136_0x49aeb2,_0x596bd6=await this[_0x3341de(0xb7)][_0x3341de(0xae)](queries_1[_0x3341de(0x94)][_0x3341de(0xd2)](_0x3341de(0x9c),_0xcd6b4c));if(_0x596bd6[_0x3341de(0xbe)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x3341de(0xd0)+_0xcd6b4c+_0x3341de(0x8e));return flosum_repository_sync_dto_1[_0x3341de(0xac)]['fromRepositoryRecord'](_0x596bd6[0x0]);}async['getComponentsFromRepository'](_0x3fa096){const _0x3b46d3=a136_0x49aeb2,_0x1be1b8='\x0a\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+_0x3b46d3(0x90)+_0x3fa096+'\x27';return this[_0x3b46d3(0x86)](_0x1be1b8);}async[a136_0x49aeb2(0x7f)](_0x4f4543){const _0x20e196=a136_0x49aeb2,_0x3192ec=_0x20e196(0x8a)+queries_1[_0x20e196(0x7d)]+_0x20e196(0xb2)+_0x4f4543+'\x27';return this[_0x20e196(0x86)](_0x3192ec);}async[a136_0x49aeb2(0xab)](_0x522887){const _0x3cd87d=a136_0x49aeb2;var _0x4fb424;const _0x210cbc=queries_1[_0x3cd87d(0x93)][_0x3cd87d(0xd2)]('%parentId%',_0x522887[_0x3cd87d(0x8b)])[_0x3cd87d(0xd2)](_0x3cd87d(0x9c),_0x522887['repositoryId']?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x3cd87d(0xcf)]),_0x175198=await this[_0x3cd87d(0xb7)][_0x3cd87d(0xae)](_0x210cbc),_0x121784=(_0x4fb424=_0x175198[0x0])===null||_0x4fb424===void 0x0?void 0x0:_0x4fb424['Id'];if(!_0x121784)throw new Error(errors_1[_0x3cd87d(0x8d)]);return _0x121784;}async[a136_0x49aeb2(0xb5)](_0x1b99ac){const _0x1b6b16=a136_0x49aeb2;let _0x550498=await this[_0x1b6b16(0xab)](_0x1b99ac)[_0x1b6b16(0xb0)](()=>null);return!_0x550498&&(_0x550498=await this[_0x1b6b16(0x85)][_0x1b6b16(0x7a)]('Attachment',{'Body':utils_1[_0x1b6b16(0xa6)]('{}'),'ParentId':_0x1b99ac[_0x1b6b16(0x8b)],'ContentType':_0x1b6b16(0xa2),'Name':_0x1b99ac[_0x1b6b16(0x7e)]?constants_1[_0x1b6b16(0x7b)]:constants_1[_0x1b6b16(0xcf)]})),_0x550498;}async['updateRemoteState'](_0x6f4d30,_0x9b90b1){const _0x1cb43e=a136_0x49aeb2,_0x5e0f81=await this[_0x1cb43e(0xb5)](_0x6f4d30);await this[_0x1cb43e(0x85)][_0x1cb43e(0xcb)](_0x1cb43e(0xad),_0x5e0f81,{'Body':utils_1[_0x1cb43e(0xa6)](JSON[_0x1cb43e(0xb3)](_0x9b90b1))});}async[a136_0x49aeb2(0xc2)](_0x2bf903,_0x2ce473){const _0x417740=a136_0x49aeb2;await this['salesforceService'][_0x417740(0xcb)](_0x2bf903[_0x417740(0xc0)],_0x2bf903[_0x417740(0x8b)],{[constants_1[_0x417740(0x87)]+_0x417740(0x98)]:_0x2ce473});}async[a136_0x49aeb2(0xcc)](_0x57ceaf){const _0x4fa462=a136_0x49aeb2;await this[_0x4fa462(0x85)][_0x4fa462(0xcb)](constants_1[_0x4fa462(0x87)]+_0x4fa462(0x80),_0x57ceaf,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x4fa462(0x92)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a136_0x49aeb2(0xaa)](),__metadata(a136_0x49aeb2(0xd1),[salesforce_query_service_1[a136_0x49aeb2(0x9e)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;