const a136_0x256ab7=a136_0x2741;(function(_0x2ee5f2,_0x3f1b14){const _0x565920=a136_0x2741,_0x1644af=_0x2ee5f2();while(!![]){try{const _0x10bfeb=-parseInt(_0x565920(0x1b6))/0x1*(parseInt(_0x565920(0x1c0))/0x2)+-parseInt(_0x565920(0x17e))/0x3+-parseInt(_0x565920(0x194))/0x4*(-parseInt(_0x565920(0x169))/0x5)+-parseInt(_0x565920(0x183))/0x6+parseInt(_0x565920(0x1ac))/0x7+-parseInt(_0x565920(0x175))/0x8+parseInt(_0x565920(0x190))/0x9;if(_0x10bfeb===_0x3f1b14)break;else _0x1644af['push'](_0x1644af['shift']());}catch(_0x422163){_0x1644af['push'](_0x1644af['shift']());}}}(a136_0x3513,0xee6b9));function a136_0x2741(_0xbb21bf,_0x460805){const _0x53ca3f=a136_0x3513();return a136_0x2741=function(_0x3130aa,_0x34567e){_0x3130aa=_0x3130aa-0x169;let _0x351375=_0x53ca3f[_0x3130aa];return _0x351375;},a136_0x2741(_0xbb21bf,_0x460805);}const a136_0x34567e=(function(){let _0x197166=!![];return function(_0x4be5a2,_0x5cb5e6){const _0x128154=_0x197166?function(){const _0x169801=a136_0x2741;if(_0x5cb5e6){const _0x3f6621=_0x5cb5e6[_0x169801(0x18a)](_0x4be5a2,arguments);return _0x5cb5e6=null,_0x3f6621;}}:function(){};return _0x197166=![],_0x128154;};}()),a136_0x3130aa=a136_0x34567e(this,function(){const _0x1babd5=a136_0x2741;return a136_0x3130aa[_0x1babd5(0x170)]()[_0x1babd5(0x182)](_0x1babd5(0x173))[_0x1babd5(0x170)]()[_0x1babd5(0x1a7)](a136_0x3130aa)['search'](_0x1babd5(0x173));});a136_0x3130aa();function a136_0x3513(){const _0x4024fe=['Sync_In_Progress__c','1657712xAjMZO','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','%id%','Repository\x20','function','decorate','push','GET_REPOSITORY_BY_NAME_QUERY','defineProperty','fromRepositoryRecord','309131INHUri','FLOSUM_NAMESPACE','patchObject','FLOSUM_GIT_NAMESPACE','length','objectType','ERR_INVALID_ATTACHMENT_ID','typedi','%name%','Attachment','6aSPndl','655vfhthj','createObject','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','text/plain','getRepositoryRecords','encodeBase64','../../../constants/errors','toString','__esModule','salesforceQuery','(((.+)+)+)+$','replace','2562672sQEwbj','%parentId%','Branch\x20with\x20Id\x20','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','records','__metadata','metadata','getOwnPropertyDescriptor','Synchronization_Status__c','2752992NXiPcw','getAttachmentId','SalesforceSyncService','repositoryId','search','2087700Hcgnqx','./salesforce-query.service','__decorate','getRepositoryRecordByName','salesforceService','disableSync','map','apply','../errors/not-found.error','objectId','GET_BRANCH_BY_NAME_QUERY','getBranchComponents','getBranchRecord','19815192HqgIdW','query','../../shared/utils','setStatus','32104AFYbmF','GET_REPOSITORY_QUERY','\x20not\x20found\x20on\x20salesforce','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','FlosumRepositorySyncDto','GET_COMPONENTS_QUERY','./salesforce.service','SalesforceNotFoundError','../queries','getComponents','updateRemoteState','getRepositoryRecord','Service','getComponentsFromRepository','getRemoteStateAttachmentId','getBranchRecords','Components__r','design:paramtypes','SYNC_ATTACHMENT_FOR_BRANCH_NAME','constructor','stringify','getBranchRecordByName','fromBranchRecord'];a136_0x3513=function(){return _0x4024fe;};return a136_0x3513();}'use strict';var __decorate=this&&this[a136_0x256ab7(0x185)]||function(_0x14c12c,_0x568624,_0x54567e,_0x190ce7){const _0x4db645=a136_0x256ab7;var _0xc7a09a=arguments[_0x4db645(0x1ba)],_0x3b9cbe=_0xc7a09a<0x3?_0x568624:_0x190ce7===null?_0x190ce7=Object[_0x4db645(0x17c)](_0x568624,_0x54567e):_0x190ce7,_0x2cd34b;if(typeof Reflect==='object'&&typeof Reflect[_0x4db645(0x1b1)]===_0x4db645(0x1b0))_0x3b9cbe=Reflect[_0x4db645(0x1b1)](_0x14c12c,_0x568624,_0x54567e,_0x190ce7);else{for(var _0x5c5425=_0x14c12c[_0x4db645(0x1ba)]-0x1;_0x5c5425>=0x0;_0x5c5425--)if(_0x2cd34b=_0x14c12c[_0x5c5425])_0x3b9cbe=(_0xc7a09a<0x3?_0x2cd34b(_0x3b9cbe):_0xc7a09a>0x3?_0x2cd34b(_0x568624,_0x54567e,_0x3b9cbe):_0x2cd34b(_0x568624,_0x54567e))||_0x3b9cbe;}return _0xc7a09a>0x3&&_0x3b9cbe&&Object[_0x4db645(0x1b4)](_0x568624,_0x54567e,_0x3b9cbe),_0x3b9cbe;},__metadata=this&&this[a136_0x256ab7(0x17a)]||function(_0x28d097,_0x326ca4){const _0x2a9e66=a136_0x256ab7;if(typeof Reflect==='object'&&typeof Reflect[_0x2a9e66(0x17b)]===_0x2a9e66(0x1b0))return Reflect[_0x2a9e66(0x17b)](_0x28d097,_0x326ca4);};Object['defineProperty'](exports,a136_0x256ab7(0x171),{'value':!![]}),exports[a136_0x256ab7(0x180)]=void 0x0;const typedi_1=require(a136_0x256ab7(0x1bd)),constants_1=require('../../../constants'),errors_1=require(a136_0x256ab7(0x16f)),utils_1=require(a136_0x256ab7(0x192)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a136_0x256ab7(0x18b)),queries_1=require(a136_0x256ab7(0x19c)),salesforce_query_service_1=require(a136_0x256ab7(0x184)),salesforce_service_1=require(a136_0x256ab7(0x19a));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x35049d,_0x2f0851){const _0x56067a=a136_0x256ab7;this[_0x56067a(0x172)]=_0x35049d,this[_0x56067a(0x187)]=_0x2f0851;}async[a136_0x256ab7(0x19d)](_0x5636ee){const _0x4fc225=a136_0x256ab7;var _0x577138;const _0x55a0ca=await this[_0x4fc225(0x172)][_0x4fc225(0x191)](_0x5636ee),_0x2de0e3=[];for(const _0x4fb1bf of _0x55a0ca){const _0x17bf98=(_0x577138=_0x4fb1bf[constants_1[_0x4fc225(0x1b7)]+_0x4fc225(0x1a4)])===null||_0x577138===void 0x0?void 0x0:_0x577138[_0x4fc225(0x179)];_0x17bf98&&_0x17bf98[_0x4fc225(0x1ba)]&&_0x2de0e3[_0x4fc225(0x1b2)](_0x17bf98[0x0]['Id']);}return _0x2de0e3;}async[a136_0x256ab7(0x16d)](){const _0x190166=a136_0x256ab7,_0x47b608=await this[_0x190166(0x172)]['query'](queries_1['GET_WAITING_REPOSITORIES_QUERY']);return _0x47b608[_0x190166(0x189)](_0x57c112=>flosum_repository_sync_dto_1[_0x190166(0x198)][_0x190166(0x1b5)](_0x57c112));}async[a136_0x256ab7(0x1a3)](){const _0x3227ba=a136_0x256ab7,_0x2698b3=await this[_0x3227ba(0x172)][_0x3227ba(0x191)](queries_1['GET_WAITING_BRANCHES_QUERY']);return _0x2698b3['map'](_0x588e48=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x3227ba(0x1aa)](_0x588e48));}async[a136_0x256ab7(0x19f)](_0x368308){const _0x4fdcc2=a136_0x256ab7,_0x990d38=await this[_0x4fdcc2(0x172)]['query'](queries_1[_0x4fdcc2(0x195)]['replace'](_0x4fdcc2(0x1ae),_0x368308));if(_0x990d38[_0x4fdcc2(0x1ba)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Repository\x20with\x20Id\x20'+_0x368308+_0x4fdcc2(0x196));return flosum_repository_sync_dto_1[_0x4fdcc2(0x198)]['fromRepositoryRecord'](_0x990d38[0x0]);}async[a136_0x256ab7(0x18f)](_0x161528){const _0x5141be=a136_0x256ab7,_0x28db06=await this['salesforceQuery'][_0x5141be(0x191)](queries_1['GET_BRANCH_QUERY'][_0x5141be(0x174)](_0x5141be(0x1ae),_0x161528));if(_0x28db06[_0x5141be(0x1ba)]===0x0)throw new not_found_error_1[(_0x5141be(0x19b))](_0x5141be(0x177)+_0x161528+_0x5141be(0x196));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x28db06[0x0]);}async[a136_0x256ab7(0x1a9)](_0x57e6c3){const _0x58b10d=a136_0x256ab7,_0x29bcac=await this[_0x58b10d(0x172)][_0x58b10d(0x191)](queries_1[_0x58b10d(0x18d)]['replace']('%name%',_0x57e6c3));if(_0x29bcac[_0x58b10d(0x1ba)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Branch\x20'+_0x57e6c3+_0x58b10d(0x196));return flosum_repository_sync_dto_1[_0x58b10d(0x198)]['fromBranchRecord'](_0x29bcac[0x0]);}async[a136_0x256ab7(0x186)](_0x7d5d69){const _0x2518c8=a136_0x256ab7,_0x887b0b=await this[_0x2518c8(0x172)][_0x2518c8(0x191)](queries_1[_0x2518c8(0x1b3)][_0x2518c8(0x174)](_0x2518c8(0x1be),_0x7d5d69));if(_0x887b0b[_0x2518c8(0x1ba)]===0x0)throw new not_found_error_1[(_0x2518c8(0x19b))](_0x2518c8(0x1af)+_0x7d5d69+_0x2518c8(0x196));return flosum_repository_sync_dto_1[_0x2518c8(0x198)][_0x2518c8(0x1b5)](_0x887b0b[0x0]);}async[a136_0x256ab7(0x1a1)](_0x186b9d){const _0x4aecba=a136_0x256ab7,_0x38fae9='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x4aecba(0x199)]+_0x4aecba(0x197)+_0x186b9d+'\x27';return this[_0x4aecba(0x19d)](_0x38fae9);}async[a136_0x256ab7(0x18e)](_0x3e1427){const _0x1b57fc=a136_0x256ab7,_0x3d2f2e='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x1b57fc(0x199)]+_0x1b57fc(0x1ad)+_0x3e1427+'\x27';return this['getComponents'](_0x3d2f2e);}async['getAttachmentId'](_0x9184fc){const _0x4412c6=a136_0x256ab7;var _0x405448;const _0xc6658c=queries_1[_0x4412c6(0x178)][_0x4412c6(0x174)](_0x4412c6(0x176),_0x9184fc[_0x4412c6(0x18c)])[_0x4412c6(0x174)](_0x4412c6(0x1be),_0x9184fc[_0x4412c6(0x181)]?constants_1[_0x4412c6(0x16b)]:constants_1[_0x4412c6(0x1a6)]),_0x2bfb37=await this[_0x4412c6(0x172)][_0x4412c6(0x191)](_0xc6658c),_0x2b2433=(_0x405448=_0x2bfb37[0x0])===null||_0x405448===void 0x0?void 0x0:_0x405448['Id'];if(!_0x2b2433)throw new Error(errors_1[_0x4412c6(0x1bc)]);return _0x2b2433;}async['getRemoteStateAttachmentId'](_0x184a10){const _0x1b0e67=a136_0x256ab7;let _0x1f0186=await this[_0x1b0e67(0x17f)](_0x184a10)['catch'](()=>null);return!_0x1f0186&&(_0x1f0186=await this[_0x1b0e67(0x187)][_0x1b0e67(0x16a)](_0x1b0e67(0x1bf),{'Body':utils_1['encodeBase64']('{}'),'ParentId':_0x184a10[_0x1b0e67(0x18c)],'ContentType':_0x1b0e67(0x16c),'Name':_0x184a10['repositoryId']?constants_1[_0x1b0e67(0x16b)]:constants_1[_0x1b0e67(0x1a6)]})),_0x1f0186;}async[a136_0x256ab7(0x19e)](_0x35c360,_0x30fd36){const _0x493896=a136_0x256ab7,_0x1e38fa=await this[_0x493896(0x1a2)](_0x35c360);await this[_0x493896(0x187)][_0x493896(0x1b8)]('Attachment',_0x1e38fa,{'Body':utils_1[_0x493896(0x16e)](JSON[_0x493896(0x1a8)](_0x30fd36))});}async[a136_0x256ab7(0x193)](_0x3725ce,_0x4af0e5){const _0x3973d7=a136_0x256ab7;await this[_0x3973d7(0x187)][_0x3973d7(0x1b8)](_0x3725ce[_0x3973d7(0x1bb)],_0x3725ce['objectId'],{[constants_1[_0x3973d7(0x1b9)]+_0x3973d7(0x17d)]:_0x4af0e5});}async[a136_0x256ab7(0x188)](_0x511411){const _0x4e9fd0=a136_0x256ab7;await this[_0x4e9fd0(0x187)]['patchObject'](constants_1[_0x4e9fd0(0x1b9)]+'Git_Settings__c',_0x511411,{[constants_1[_0x4e9fd0(0x1b9)]+_0x4e9fd0(0x1ab)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a136_0x256ab7(0x1a0)](),__metadata(a136_0x256ab7(0x1a5),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports[a136_0x256ab7(0x180)]=SalesforceSyncService;