const a136_0x51fdf2=a136_0x355d;(function(_0x47b840,_0x1c1429){const _0x118f57=a136_0x355d,_0x5af8e7=_0x47b840();while(!![]){try{const _0x570047=-parseInt(_0x118f57(0x117))/0x1*(parseInt(_0x118f57(0xdc))/0x2)+-parseInt(_0x118f57(0xd9))/0x3+parseInt(_0x118f57(0xda))/0x4+parseInt(_0x118f57(0xfd))/0x5*(parseInt(_0x118f57(0x130))/0x6)+-parseInt(_0x118f57(0x12b))/0x7*(parseInt(_0x118f57(0x101))/0x8)+-parseInt(_0x118f57(0x10e))/0x9+parseInt(_0x118f57(0xf9))/0xa*(parseInt(_0x118f57(0xe3))/0xb);if(_0x570047===_0x1c1429)break;else _0x5af8e7['push'](_0x5af8e7['shift']());}catch(_0x506c22){_0x5af8e7['push'](_0x5af8e7['shift']());}}}(a136_0x3709,0xc453b));const a136_0x318c7d=(function(){let _0x395395=!![];return function(_0xb28e2b,_0x126515){const _0x4209de=_0x395395?function(){const _0x413241=a136_0x355d;if(_0x126515){const _0x405da9=_0x126515[_0x413241(0x113)](_0xb28e2b,arguments);return _0x126515=null,_0x405da9;}}:function(){};return _0x395395=![],_0x4209de;};}()),a136_0x334996=a136_0x318c7d(this,function(){const _0x3f3a1e=a136_0x355d;return a136_0x334996[_0x3f3a1e(0xe8)]()[_0x3f3a1e(0xed)](_0x3f3a1e(0xf7))[_0x3f3a1e(0xe8)]()[_0x3f3a1e(0x122)](a136_0x334996)['search'](_0x3f3a1e(0xf7));});a136_0x334996();'use strict';var __decorate=this&&this[a136_0x51fdf2(0x128)]||function(_0x695e62,_0xf06bec,_0x15b633,_0x19cc6){const _0x1994f0=a136_0x51fdf2;var _0x267c49=arguments[_0x1994f0(0xfa)],_0x921e28=_0x267c49<0x3?_0xf06bec:_0x19cc6===null?_0x19cc6=Object[_0x1994f0(0x125)](_0xf06bec,_0x15b633):_0x19cc6,_0x5b7915;if(typeof Reflect===_0x1994f0(0xf4)&&typeof Reflect[_0x1994f0(0x109)]===_0x1994f0(0x12c))_0x921e28=Reflect['decorate'](_0x695e62,_0xf06bec,_0x15b633,_0x19cc6);else{for(var _0x1c2748=_0x695e62[_0x1994f0(0xfa)]-0x1;_0x1c2748>=0x0;_0x1c2748--)if(_0x5b7915=_0x695e62[_0x1c2748])_0x921e28=(_0x267c49<0x3?_0x5b7915(_0x921e28):_0x267c49>0x3?_0x5b7915(_0xf06bec,_0x15b633,_0x921e28):_0x5b7915(_0xf06bec,_0x15b633))||_0x921e28;}return _0x267c49>0x3&&_0x921e28&&Object[_0x1994f0(0x104)](_0xf06bec,_0x15b633,_0x921e28),_0x921e28;},__metadata=this&&this[a136_0x51fdf2(0xe1)]||function(_0x199ede,_0x4d7528){const _0x32f83b=a136_0x51fdf2;if(typeof Reflect===_0x32f83b(0xf4)&&typeof Reflect[_0x32f83b(0x11f)]===_0x32f83b(0x12c))return Reflect['metadata'](_0x199ede,_0x4d7528);};Object[a136_0x51fdf2(0x104)](exports,a136_0x51fdf2(0xf1),{'value':!![]}),exports[a136_0x51fdf2(0x103)]=void 0x0;const typedi_1=require(a136_0x51fdf2(0xe4)),constants_1=require(a136_0x51fdf2(0x102)),errors_1=require(a136_0x51fdf2(0x115)),utils_1=require('../../shared/utils'),flosum_repository_sync_dto_1=require(a136_0x51fdf2(0x126)),not_found_error_1=require(a136_0x51fdf2(0xf6)),queries_1=require('../queries'),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a136_0x51fdf2(0xeb));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x2003ba,_0x394e04){const _0x52cfa3=a136_0x51fdf2;this[_0x52cfa3(0xf3)]=_0x2003ba,this['salesforceService']=_0x394e04;}async[a136_0x51fdf2(0xff)](_0x4c59cf){const _0x1c112a=a136_0x51fdf2;var _0x3b9bc4;const _0x17ae2a=await this[_0x1c112a(0xf3)][_0x1c112a(0xe2)](_0x4c59cf),_0x36039c=[];for(const _0xe87abd of _0x17ae2a){const _0x208e78=(_0x3b9bc4=_0xe87abd[constants_1[_0x1c112a(0xe7)]+_0x1c112a(0xf2)])===null||_0x3b9bc4===void 0x0?void 0x0:_0x3b9bc4[_0x1c112a(0x12d)];_0x208e78&&_0x208e78['length']&&_0x36039c['push'](_0x208e78[0x0]['Id']);}return _0x36039c;}async[a136_0x51fdf2(0x108)](){const _0x1e68e6=a136_0x51fdf2,_0x3e78d9=await this['salesforceQuery'][_0x1e68e6(0xe2)](queries_1['GET_WAITING_REPOSITORIES_QUERY']);return _0x3e78d9[_0x1e68e6(0x124)](_0x48d8c1=>flosum_repository_sync_dto_1[_0x1e68e6(0xfb)]['fromRepositoryRecord'](_0x48d8c1));}async['getBranchRecords'](){const _0x22dcc0=a136_0x51fdf2,_0x598176=await this[_0x22dcc0(0xf3)][_0x22dcc0(0xe2)](queries_1[_0x22dcc0(0xe5)]);return _0x598176[_0x22dcc0(0x124)](_0x422f94=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x22dcc0(0x11a)](_0x422f94));}async[a136_0x51fdf2(0x121)](_0x3955b6){const _0x460b98=a136_0x51fdf2,_0x250274=await this['salesforceQuery'][_0x460b98(0xe2)](queries_1[_0x460b98(0x127)]['replace'](_0x460b98(0x107),_0x3955b6));if(_0x250274[_0x460b98(0xfa)]===0x0)throw new not_found_error_1[(_0x460b98(0x11b))](_0x460b98(0xe0)+_0x3955b6+_0x460b98(0x111));return flosum_repository_sync_dto_1[_0x460b98(0xfb)]['fromRepositoryRecord'](_0x250274[0x0]);}async[a136_0x51fdf2(0x10d)](_0x25ef20){const _0x4cc9d0=a136_0x51fdf2,_0x40e553=await this[_0x4cc9d0(0xf3)][_0x4cc9d0(0xe2)](queries_1[_0x4cc9d0(0xea)][_0x4cc9d0(0xfc)](_0x4cc9d0(0x107),_0x25ef20));if(_0x40e553[_0x4cc9d0(0xfa)]===0x0)throw new not_found_error_1[(_0x4cc9d0(0x11b))](_0x4cc9d0(0x105)+_0x25ef20+_0x4cc9d0(0x111));return flosum_repository_sync_dto_1[_0x4cc9d0(0xfb)][_0x4cc9d0(0x11a)](_0x40e553[0x0]);}async[a136_0x51fdf2(0x129)](_0x1aad04){const _0x4945ef=a136_0x51fdf2,_0x59014f=await this[_0x4945ef(0xf3)]['query'](queries_1[_0x4945ef(0x11e)][_0x4945ef(0xfc)](_0x4945ef(0x112),_0x1aad04));if(_0x59014f[_0x4945ef(0xfa)]===0x0)throw new not_found_error_1[(_0x4945ef(0x11b))](_0x4945ef(0xdb)+_0x1aad04+_0x4945ef(0x111));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4945ef(0x11a)](_0x59014f[0x0]);}async['getRepositoryRecordByName'](_0x2fdba5){const _0x936b6=a136_0x51fdf2,_0x22231e=await this['salesforceQuery']['query'](queries_1[_0x936b6(0x110)][_0x936b6(0xfc)]('%name%',_0x2fdba5));if(_0x22231e[_0x936b6(0xfa)]===0x0)throw new not_found_error_1[(_0x936b6(0x11b))]('Repository\x20'+_0x2fdba5+_0x936b6(0x111));return flosum_repository_sync_dto_1[_0x936b6(0xfb)][_0x936b6(0x12e)](_0x22231e[0x0]);}async[a136_0x51fdf2(0xdd)](_0x2305bc){const _0x1e3c6c=a136_0x51fdf2,_0x709bcd='\x0a\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+_0x1e3c6c(0x10f)+_0x2305bc+'\x27';return this['getComponents'](_0x709bcd);}async[a136_0x51fdf2(0xf8)](_0x3d25d3){const _0x245dbb='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x3d25d3+'\x27';return this['getComponents'](_0x245dbb);}async[a136_0x51fdf2(0x118)](_0x164c6e){const _0x15979a=a136_0x51fdf2;var _0x4865f0;const _0x13fa6c=queries_1[_0x15979a(0xfe)][_0x15979a(0xfc)](_0x15979a(0x11c),_0x164c6e[_0x15979a(0x10b)])[_0x15979a(0xfc)](_0x15979a(0x112),_0x164c6e[_0x15979a(0x120)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x15979a(0x132)]),_0xc6cc5a=await this[_0x15979a(0xf3)][_0x15979a(0xe2)](_0x13fa6c),_0x32a808=(_0x4865f0=_0xc6cc5a[0x0])===null||_0x4865f0===void 0x0?void 0x0:_0x4865f0['Id'];if(!_0x32a808)throw new Error(errors_1[_0x15979a(0x131)]);return _0x32a808;}async[a136_0x51fdf2(0x12f)](_0x1599dd){const _0x10aa11=a136_0x51fdf2;let _0x4a82d0=await this[_0x10aa11(0x118)](_0x1599dd)[_0x10aa11(0x11d)](()=>null);return!_0x4a82d0&&(_0x4a82d0=await this[_0x10aa11(0xf5)][_0x10aa11(0xe6)](_0x10aa11(0x116),{'Body':utils_1[_0x10aa11(0x10a)]('{}'),'ParentId':_0x1599dd[_0x10aa11(0x10b)],'ContentType':_0x10aa11(0x119),'Name':_0x1599dd[_0x10aa11(0x120)]?constants_1[_0x10aa11(0xec)]:constants_1[_0x10aa11(0x132)]})),_0x4a82d0;}async['updateRemoteState'](_0x30508a,_0x4c0c22){const _0x46c1c7=a136_0x51fdf2,_0x2b2b74=await this[_0x46c1c7(0x12f)](_0x30508a);await this[_0x46c1c7(0xf5)][_0x46c1c7(0xee)](_0x46c1c7(0x116),_0x2b2b74,{'Body':utils_1[_0x46c1c7(0x10a)](JSON[_0x46c1c7(0xe9)](_0x4c0c22))});}async[a136_0x51fdf2(0x10c)](_0x415a4c,_0x355813){const _0xe33064=a136_0x51fdf2;await this['salesforceService'][_0xe33064(0xee)](_0x415a4c[_0xe33064(0xdf)],_0x415a4c[_0xe33064(0x10b)],{[constants_1['FLOSUM_GIT_NAMESPACE']+'Synchronization_Status__c']:_0x355813});}async[a136_0x51fdf2(0x106)](_0x357f05){const _0x460d53=a136_0x51fdf2;await this[_0x460d53(0xf5)][_0x460d53(0xee)](constants_1[_0x460d53(0x100)]+_0x460d53(0x12a),_0x357f05,{[constants_1[_0x460d53(0x100)]+_0x460d53(0x114)]:![]});}};function a136_0x355d(_0x2fda4b,_0x1655f1){const _0x5fb359=a136_0x3709();return a136_0x355d=function(_0x334996,_0x318c7d){_0x334996=_0x334996-0xd9;let _0x3709d7=_0x5fb359[_0x334996];return _0x3709d7;},a136_0x355d(_0x2fda4b,_0x1655f1);}function a136_0x3709(){const _0x5e2ae1=['SalesforceService','map','getOwnPropertyDescriptor','../dto/flosum-repository-sync.dto','GET_REPOSITORY_QUERY','__decorate','getBranchRecordByName','Git_Settings__c','119SHqKFe','function','records','fromRepositoryRecord','getRemoteStateAttachmentId','6yOzbFi','ERR_INVALID_ATTACHMENT_ID','SYNC_ATTACHMENT_FOR_BRANCH_NAME','2259654RpDCRq','5824612gqokvI','Branch\x20','2714744MXvlnv','getComponentsFromRepository','design:paramtypes','objectType','Repository\x20with\x20Id\x20','__metadata','query','11BfEwKZ','typedi','GET_WAITING_BRANCHES_QUERY','createObject','FLOSUM_NAMESPACE','toString','stringify','GET_BRANCH_QUERY','./salesforce.service','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','search','patchObject','Service','SalesforceQueryService','__esModule','Components__r','salesforceQuery','object','salesforceService','../errors/not-found.error','(((.+)+)+)+$','getBranchComponents','20822820aokhKE','length','FlosumRepositorySyncDto','replace','4755795DoFHej','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','getComponents','FLOSUM_GIT_NAMESPACE','355344mqDJBI','../../../constants','SalesforceSyncService','defineProperty','Branch\x20with\x20Id\x20','disableSync','%id%','getRepositoryRecords','decorate','encodeBase64','objectId','setStatus','getBranchRecord','7377687LIjaKq','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','GET_REPOSITORY_BY_NAME_QUERY','\x20not\x20found\x20on\x20salesforce','%name%','apply','Sync_In_Progress__c','../../../constants/errors','Attachment','1zoefcX','getAttachmentId','text/plain','fromBranchRecord','SalesforceNotFoundError','%parentId%','catch','GET_BRANCH_BY_NAME_QUERY','metadata','repositoryId','getRepositoryRecord','constructor'];a136_0x3709=function(){return _0x5e2ae1;};return a136_0x3709();}SalesforceSyncService=__decorate([typedi_1[a136_0x51fdf2(0xef)](),__metadata(a136_0x51fdf2(0xde),[salesforce_query_service_1[a136_0x51fdf2(0xf0)],salesforce_service_1[a136_0x51fdf2(0x123)]])],SalesforceSyncService),exports[a136_0x51fdf2(0x103)]=SalesforceSyncService;