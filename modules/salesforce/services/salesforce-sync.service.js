const a136_0x156945=a136_0x1d9b;(function(_0x3416de,_0x25a473){const _0x56d672=a136_0x1d9b,_0x28cf5d=_0x3416de();while(!![]){try{const _0xe8a472=-parseInt(_0x56d672(0xe1))/0x1+-parseInt(_0x56d672(0xeb))/0x2*(parseInt(_0x56d672(0xfc))/0x3)+-parseInt(_0x56d672(0xf9))/0x4*(-parseInt(_0x56d672(0x121))/0x5)+parseInt(_0x56d672(0x101))/0x6*(parseInt(_0x56d672(0x111))/0x7)+parseInt(_0x56d672(0x106))/0x8*(parseInt(_0x56d672(0xd3))/0x9)+parseInt(_0x56d672(0xe2))/0xa*(parseInt(_0x56d672(0xd7))/0xb)+parseInt(_0x56d672(0x10a))/0xc;if(_0xe8a472===_0x25a473)break;else _0x28cf5d['push'](_0x28cf5d['shift']());}catch(_0xd9818c){_0x28cf5d['push'](_0x28cf5d['shift']());}}}(a136_0x5414,0x45cb8));const a136_0x3225ad=(function(){let _0x171f64=!![];return function(_0x400b7f,_0x43c77f){const _0x40df3c=_0x171f64?function(){const _0x101fab=a136_0x1d9b;if(_0x43c77f){const _0x2b652c=_0x43c77f[_0x101fab(0x116)](_0x400b7f,arguments);return _0x43c77f=null,_0x2b652c;}}:function(){};return _0x171f64=![],_0x40df3c;};}()),a136_0x20d34e=a136_0x3225ad(this,function(){const _0x42f326=a136_0x1d9b;return a136_0x20d34e['toString']()[_0x42f326(0x109)](_0x42f326(0xf3))[_0x42f326(0x108)]()['constructor'](a136_0x20d34e)['search'](_0x42f326(0xf3));});a136_0x20d34e();'use strict';var __decorate=this&&this[a136_0x156945(0xf8)]||function(_0x19465a,_0x3f78ea,_0x1ee29d,_0x3d2296){const _0xc5a53d=a136_0x156945;var _0x2a598c=arguments[_0xc5a53d(0xd4)],_0x4fb2bd=_0x2a598c<0x3?_0x3f78ea:_0x3d2296===null?_0x3d2296=Object[_0xc5a53d(0xed)](_0x3f78ea,_0x1ee29d):_0x3d2296,_0x365944;if(typeof Reflect==='object'&&typeof Reflect[_0xc5a53d(0xe6)]===_0xc5a53d(0xec))_0x4fb2bd=Reflect[_0xc5a53d(0xe6)](_0x19465a,_0x3f78ea,_0x1ee29d,_0x3d2296);else{for(var _0x413e8e=_0x19465a['length']-0x1;_0x413e8e>=0x0;_0x413e8e--)if(_0x365944=_0x19465a[_0x413e8e])_0x4fb2bd=(_0x2a598c<0x3?_0x365944(_0x4fb2bd):_0x2a598c>0x3?_0x365944(_0x3f78ea,_0x1ee29d,_0x4fb2bd):_0x365944(_0x3f78ea,_0x1ee29d))||_0x4fb2bd;}return _0x2a598c>0x3&&_0x4fb2bd&&Object[_0xc5a53d(0x114)](_0x3f78ea,_0x1ee29d,_0x4fb2bd),_0x4fb2bd;},__metadata=this&&this[a136_0x156945(0xf7)]||function(_0x257f69,_0x4c30e5){const _0xd75ca6=a136_0x156945;if(typeof Reflect===_0xd75ca6(0x103)&&typeof Reflect[_0xd75ca6(0xf5)]===_0xd75ca6(0xec))return Reflect[_0xd75ca6(0xf5)](_0x257f69,_0x4c30e5);};function a136_0x5414(){const _0x137ce9=['../../../constants/errors','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','patchObject','GET_WAITING_REPOSITORIES_QUERY','Synchronization_Status__c','createObject','__esModule','fromBranchRecord','110695eYciTO','2212640AMmVwn','../errors/not-found.error','FLOSUM_GIT_NAMESPACE','SalesforceNotFoundError','decorate','query','salesforceQuery','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','objectId','1011238iRRWEW','function','getOwnPropertyDescriptor','SYNC_ATTACHMENT_FOR_BRANCH_NAME','GET_BRANCH_BY_NAME_QUERY','getAttachmentId','SalesforceSyncService','GET_COMPONENTS_QUERY','(((.+)+)+)+$','Repository\x20with\x20Id\x20','metadata','replace','__metadata','__decorate','4agQBkG','ERR_INVALID_ATTACHMENT_ID','../../shared/utils','3AddJWD','../dto/flosum-repository-sync.dto','./salesforce.service','Service','../queries','87480yJEXtq','./salesforce-query.service','object','stringify','fromRepositoryRecord','9624CWtEYX','encodeBase64','toString','search','2380344jBSFkq','Git_Settings__c','repositoryId','Repository\x20','getRepositoryRecordByName','%name%','Sync_In_Progress__c','77LegnpN','\x20not\x20found\x20on\x20salesforce','design:paramtypes','defineProperty','FlosumRepositorySyncDto','apply','SalesforceQueryService','typedi','Attachment','GET_REPOSITORY_QUERY','getRemoteStateAttachmentId','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','text/plain','setStatus','GET_BRANCH_QUERY','../../../constants','1502670EVXsNs','map','getComponentsFromRepository','\x0a\x20\x20\x20\x20\x20\x20','Branch\x20','records','GET_WAITING_BRANCHES_QUERY','push','salesforceService','getComponents','disableSync','GET_REPOSITORY_BY_NAME_QUERY','162wCdGca','length','getBranchRecords','%parentId%','11AMcLxc','getBranchRecordByName'];a136_0x5414=function(){return _0x137ce9;};return a136_0x5414();}function a136_0x1d9b(_0x456889,_0x395bfd){const _0x5a32f2=a136_0x5414();return a136_0x1d9b=function(_0x20d34e,_0x3225ad){_0x20d34e=_0x20d34e-0xcd;let _0x541480=_0x5a32f2[_0x20d34e];return _0x541480;},a136_0x1d9b(_0x456889,_0x395bfd);}Object[a136_0x156945(0x114)](exports,a136_0x156945(0xdf),{'value':!![]}),exports[a136_0x156945(0xf1)]=void 0x0;const typedi_1=require(a136_0x156945(0x118)),constants_1=require(a136_0x156945(0x120)),errors_1=require(a136_0x156945(0xd9)),utils_1=require(a136_0x156945(0xfb)),flosum_repository_sync_dto_1=require(a136_0x156945(0xfd)),not_found_error_1=require(a136_0x156945(0xe3)),queries_1=require(a136_0x156945(0x100)),salesforce_query_service_1=require(a136_0x156945(0x102)),salesforce_service_1=require(a136_0x156945(0xfe));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x372bee,_0x1ff2c0){const _0x1cda29=a136_0x156945;this['salesforceQuery']=_0x372bee,this[_0x1cda29(0xcf)]=_0x1ff2c0;}async[a136_0x156945(0xd0)](_0x2ba187){const _0x24ae21=a136_0x156945;var _0x21d735;const _0x546e77=await this[_0x24ae21(0xe8)][_0x24ae21(0xe7)](_0x2ba187),_0x198407=[];for(const _0x36b754 of _0x546e77){const _0x1d6f66=(_0x21d735=_0x36b754[constants_1['FLOSUM_NAMESPACE']+'Components__r'])===null||_0x21d735===void 0x0?void 0x0:_0x21d735[_0x24ae21(0x126)];_0x1d6f66&&_0x1d6f66[_0x24ae21(0xd4)]&&_0x198407[_0x24ae21(0xce)](_0x1d6f66[0x0]['Id']);}return _0x198407;}async['getRepositoryRecords'](){const _0x3060bf=a136_0x156945,_0x43dfc8=await this[_0x3060bf(0xe8)]['query'](queries_1[_0x3060bf(0xdc)]);return _0x43dfc8[_0x3060bf(0x122)](_0x30ec01=>flosum_repository_sync_dto_1[_0x3060bf(0x115)]['fromRepositoryRecord'](_0x30ec01));}async[a136_0x156945(0xd5)](){const _0x48a04f=a136_0x156945,_0x39251e=await this[_0x48a04f(0xe8)][_0x48a04f(0xe7)](queries_1[_0x48a04f(0xcd)]);return _0x39251e[_0x48a04f(0x122)](_0x5bc62c=>flosum_repository_sync_dto_1[_0x48a04f(0x115)][_0x48a04f(0xe0)](_0x5bc62c));}async['getRepositoryRecord'](_0x585bc1){const _0x4abb4a=a136_0x156945,_0x37164=await this['salesforceQuery']['query'](queries_1[_0x4abb4a(0x11a)][_0x4abb4a(0xf6)]('%id%',_0x585bc1));if(_0x37164[_0x4abb4a(0xd4)]===0x0)throw new not_found_error_1[(_0x4abb4a(0xe5))](_0x4abb4a(0xf4)+_0x585bc1+_0x4abb4a(0x112));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4abb4a(0x105)](_0x37164[0x0]);}async['getBranchRecord'](_0x19ca99){const _0x2962cf=a136_0x156945,_0x7e2e51=await this[_0x2962cf(0xe8)][_0x2962cf(0xe7)](queries_1[_0x2962cf(0x11f)][_0x2962cf(0xf6)]('%id%',_0x19ca99));if(_0x7e2e51[_0x2962cf(0xd4)]===0x0)throw new not_found_error_1[(_0x2962cf(0xe5))]('Branch\x20with\x20Id\x20'+_0x19ca99+_0x2962cf(0x112));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x2962cf(0xe0)](_0x7e2e51[0x0]);}async[a136_0x156945(0xd8)](_0x1ee569){const _0x1e18d1=a136_0x156945,_0x272ca8=await this[_0x1e18d1(0xe8)][_0x1e18d1(0xe7)](queries_1[_0x1e18d1(0xef)]['replace']('%name%',_0x1ee569));if(_0x272ca8[_0x1e18d1(0xd4)]===0x0)throw new not_found_error_1[(_0x1e18d1(0xe5))](_0x1e18d1(0x125)+_0x1ee569+_0x1e18d1(0x112));return flosum_repository_sync_dto_1[_0x1e18d1(0x115)][_0x1e18d1(0xe0)](_0x272ca8[0x0]);}async[a136_0x156945(0x10e)](_0x14d04f){const _0x28ac42=a136_0x156945,_0x561bc8=await this[_0x28ac42(0xe8)][_0x28ac42(0xe7)](queries_1[_0x28ac42(0xd2)][_0x28ac42(0xf6)](_0x28ac42(0x10f),_0x14d04f));if(_0x561bc8[_0x28ac42(0xd4)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x28ac42(0x10d)+_0x14d04f+_0x28ac42(0x112));return flosum_repository_sync_dto_1[_0x28ac42(0x115)]['fromRepositoryRecord'](_0x561bc8[0x0]);}async[a136_0x156945(0x123)](_0x57a10f){const _0x3e87b3=a136_0x156945,_0x2ea0de=_0x3e87b3(0x124)+queries_1[_0x3e87b3(0xf2)]+_0x3e87b3(0x11c)+_0x57a10f+'\x27';return this[_0x3e87b3(0xd0)](_0x2ea0de);}async['getBranchComponents'](_0x538e93){const _0x5d329b=a136_0x156945,_0x51b8e7=_0x5d329b(0xda)+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x538e93+'\x27';return this['getComponents'](_0x51b8e7);}async[a136_0x156945(0xf0)](_0x5cacb4){const _0x368e46=a136_0x156945;var _0x315df9;const _0x22d77a=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x368e46(0xf6)](_0x368e46(0xd6),_0x5cacb4[_0x368e46(0xea)])['replace'](_0x368e46(0x10f),_0x5cacb4[_0x368e46(0x10c)]?constants_1[_0x368e46(0xe9)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x9da240=await this[_0x368e46(0xe8)][_0x368e46(0xe7)](_0x22d77a),_0x567182=(_0x315df9=_0x9da240[0x0])===null||_0x315df9===void 0x0?void 0x0:_0x315df9['Id'];if(!_0x567182)throw new Error(errors_1[_0x368e46(0xfa)]);return _0x567182;}async[a136_0x156945(0x11b)](_0x289d5f){const _0x4c696b=a136_0x156945;let _0x40fa36=await this['getAttachmentId'](_0x289d5f)['catch'](()=>null);return!_0x40fa36&&(_0x40fa36=await this[_0x4c696b(0xcf)][_0x4c696b(0xde)](_0x4c696b(0x119),{'Body':utils_1[_0x4c696b(0x107)]('{}'),'ParentId':_0x289d5f[_0x4c696b(0xea)],'ContentType':_0x4c696b(0x11d),'Name':_0x289d5f['repositoryId']?constants_1[_0x4c696b(0xe9)]:constants_1[_0x4c696b(0xee)]})),_0x40fa36;}async['updateRemoteState'](_0x6bee53,_0x11ac1f){const _0x2709c3=a136_0x156945,_0x1cfd77=await this[_0x2709c3(0x11b)](_0x6bee53);await this[_0x2709c3(0xcf)][_0x2709c3(0xdb)]('Attachment',_0x1cfd77,{'Body':utils_1[_0x2709c3(0x107)](JSON[_0x2709c3(0x104)](_0x11ac1f))});}async[a136_0x156945(0x11e)](_0x2264d8,_0x1519a2){const _0x118334=a136_0x156945;await this[_0x118334(0xcf)][_0x118334(0xdb)](_0x2264d8['objectType'],_0x2264d8[_0x118334(0xea)],{[constants_1[_0x118334(0xe4)]+_0x118334(0xdd)]:_0x1519a2});}async[a136_0x156945(0xd1)](_0x547072){const _0x330a05=a136_0x156945;await this[_0x330a05(0xcf)]['patchObject'](constants_1['FLOSUM_GIT_NAMESPACE']+_0x330a05(0x10b),_0x547072,{[constants_1[_0x330a05(0xe4)]+_0x330a05(0x110)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a136_0x156945(0xff)](),__metadata(a136_0x156945(0x113),[salesforce_query_service_1[a136_0x156945(0x117)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;