const a135_0x4f03f1=a135_0x5cdd;(function(_0x2c42de,_0x239148){const _0x532035=a135_0x5cdd,_0x530f86=_0x2c42de();while(!![]){try{const _0x20de93=-parseInt(_0x532035(0x1de))/0x1+-parseInt(_0x532035(0x1d5))/0x2+-parseInt(_0x532035(0x1d0))/0x3*(parseInt(_0x532035(0x20c))/0x4)+-parseInt(_0x532035(0x1e1))/0x5+parseInt(_0x532035(0x1d4))/0x6*(parseInt(_0x532035(0x1fc))/0x7)+-parseInt(_0x532035(0x1f8))/0x8+parseInt(_0x532035(0x1ff))/0x9*(parseInt(_0x532035(0x1f9))/0xa);if(_0x20de93===_0x239148)break;else _0x530f86['push'](_0x530f86['shift']());}catch(_0x1449e1){_0x530f86['push'](_0x530f86['shift']());}}}(a135_0x6b99,0xe1202));const a135_0x2e0f0d=(function(){let _0x5b4db6=!![];return function(_0x2933b1,_0x252f9e){const _0x421ac1=_0x5b4db6?function(){if(_0x252f9e){const _0x4a229d=_0x252f9e['apply'](_0x2933b1,arguments);return _0x252f9e=null,_0x4a229d;}}:function(){};return _0x5b4db6=![],_0x421ac1;};}()),a135_0xe39181=a135_0x2e0f0d(this,function(){const _0x5d4705=a135_0x5cdd;return a135_0xe39181[_0x5d4705(0x211)]()[_0x5d4705(0x222)](_0x5d4705(0x1f7))[_0x5d4705(0x211)]()[_0x5d4705(0x1fe)](a135_0xe39181)[_0x5d4705(0x222)](_0x5d4705(0x1f7));});function a135_0x5cdd(_0x26def1,_0x5ebfe9){const _0x857bce=a135_0x6b99();return a135_0x5cdd=function(_0xe39181,_0x2e0f0d){_0xe39181=_0xe39181-0x1cb;let _0x6b990f=_0x857bce[_0xe39181];return _0x6b990f;},a135_0x5cdd(_0x26def1,_0x5ebfe9);}a135_0xe39181();'use strict';function a135_0x6b99(){const _0x42427c=['SalesforceNotFoundError','getRepositoryRecords','getOwnPropertyDescriptor','FLOSUM_GIT_NAMESPACE','174585KvnAYd','setStatus','Repository\x20','341760tvGhpR','stringify','objectId','getBranchRecordByName','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','length','getRepositoryRecord','GET_BRANCH_BY_NAME_QUERY','GET_WAITING_REPOSITORIES_QUERY','repositoryId','getRemoteStateAttachmentId','Branch\x20','Synchronization_Status__c','../queries','getComponentsFromRepository','encodeBase64','GET_REPOSITORY_QUERY','object','getComponents','push','./salesforce.service','text/plain','(((.+)+)+)+$','13777480NpYfIt','347680NxaOCz','getBranchComponents','salesforceService','9527qgtYrd','GET_COMPONENTS_QUERY','constructor','1485UNLwWD','getAttachmentId','../../../constants','typedi','SalesforceService','\x0a\x20\x20\x20\x20\x20\x20','Repository\x20with\x20Id\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','metadata','%id%','getBranchRecords','patchObject','%parentId%','1911512eXWEGx','getBranchRecord','defineProperty','__metadata','__decorate','toString','records','SalesforceQueryService','catch','salesforceQuery','Branch\x20with\x20Id\x20','../../shared/utils','replace','updateRemoteState','GET_WAITING_BRANCHES_QUERY','decorate','__esModule','\x20not\x20found\x20on\x20salesforce','Attachment','query','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','FlosumRepositorySyncDto','search','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','design:paramtypes','fromBranchRecord','%name%','map','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','9WGdPUq','fromRepositoryRecord','function','../../../constants/errors','642VddVmm','3122954GlUAMX','createObject','Sync_In_Progress__c','../errors/not-found.error','Git_Settings__c'];a135_0x6b99=function(){return _0x42427c;};return a135_0x6b99();}var __decorate=this&&this[a135_0x4f03f1(0x210)]||function(_0xb8ecc,_0x30a1e7,_0xf44ce1,_0x4d1945){const _0x474b3d=a135_0x4f03f1;var _0x26cae2=arguments[_0x474b3d(0x1e6)],_0x58e0e7=_0x26cae2<0x3?_0x30a1e7:_0x4d1945===null?_0x4d1945=Object[_0x474b3d(0x1dc)](_0x30a1e7,_0xf44ce1):_0x4d1945,_0x244af5;if(typeof Reflect===_0x474b3d(0x1f2)&&typeof Reflect[_0x474b3d(0x21b)]===_0x474b3d(0x1d2))_0x58e0e7=Reflect['decorate'](_0xb8ecc,_0x30a1e7,_0xf44ce1,_0x4d1945);else{for(var _0x2d7769=_0xb8ecc[_0x474b3d(0x1e6)]-0x1;_0x2d7769>=0x0;_0x2d7769--)if(_0x244af5=_0xb8ecc[_0x2d7769])_0x58e0e7=(_0x26cae2<0x3?_0x244af5(_0x58e0e7):_0x26cae2>0x3?_0x244af5(_0x30a1e7,_0xf44ce1,_0x58e0e7):_0x244af5(_0x30a1e7,_0xf44ce1))||_0x58e0e7;}return _0x26cae2>0x3&&_0x58e0e7&&Object['defineProperty'](_0x30a1e7,_0xf44ce1,_0x58e0e7),_0x58e0e7;},__metadata=this&&this[a135_0x4f03f1(0x20f)]||function(_0x157ff6,_0x5c8758){const _0x539633=a135_0x4f03f1;if(typeof Reflect===_0x539633(0x1f2)&&typeof Reflect[_0x539633(0x207)]==='function')return Reflect[_0x539633(0x207)](_0x157ff6,_0x5c8758);};Object[a135_0x4f03f1(0x20e)](exports,a135_0x4f03f1(0x21c),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a135_0x4f03f1(0x202)),constants_1=require(a135_0x4f03f1(0x201)),errors_1=require(a135_0x4f03f1(0x1d3)),utils_1=require(a135_0x4f03f1(0x217)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a135_0x4f03f1(0x1d8)),queries_1=require(a135_0x4f03f1(0x1ee)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a135_0x4f03f1(0x1f5));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x257066,_0x57e56a){const _0x3d4a3f=a135_0x4f03f1;this[_0x3d4a3f(0x215)]=_0x257066,this[_0x3d4a3f(0x1fb)]=_0x57e56a;}async[a135_0x4f03f1(0x1f3)](_0x520662){const _0x5d2213=a135_0x4f03f1;var _0x366769;const _0x3852d7=await this[_0x5d2213(0x215)]['query'](_0x520662),_0x278191=[];for(const _0x5ca787 of _0x3852d7){const _0x4ce1c0=(_0x366769=_0x5ca787[constants_1['FLOSUM_NAMESPACE']+'Components__r'])===null||_0x366769===void 0x0?void 0x0:_0x366769[_0x5d2213(0x212)];_0x4ce1c0&&_0x4ce1c0['length']&&_0x278191[_0x5d2213(0x1f4)](_0x4ce1c0[0x0]['Id']);}return _0x278191;}async[a135_0x4f03f1(0x1db)](){const _0x1e1955=a135_0x4f03f1,_0x5758ad=await this[_0x1e1955(0x215)]['query'](queries_1[_0x1e1955(0x1e9)]);return _0x5758ad[_0x1e1955(0x1ce)](_0x58d9dd=>flosum_repository_sync_dto_1[_0x1e1955(0x221)][_0x1e1955(0x1d1)](_0x58d9dd));}async[a135_0x4f03f1(0x209)](){const _0x38f764=a135_0x4f03f1,_0x1a1a45=await this[_0x38f764(0x215)]['query'](queries_1[_0x38f764(0x21a)]);return _0x1a1a45[_0x38f764(0x1ce)](_0x5e5c60=>flosum_repository_sync_dto_1[_0x38f764(0x221)][_0x38f764(0x1cc)](_0x5e5c60));}async[a135_0x4f03f1(0x1e7)](_0x227a5e){const _0x4c6b97=a135_0x4f03f1,_0x38274f=await this[_0x4c6b97(0x215)][_0x4c6b97(0x21f)](queries_1[_0x4c6b97(0x1f1)][_0x4c6b97(0x218)](_0x4c6b97(0x208),_0x227a5e));if(_0x38274f[_0x4c6b97(0x1e6)]===0x0)throw new not_found_error_1[(_0x4c6b97(0x1da))](_0x4c6b97(0x205)+_0x227a5e+_0x4c6b97(0x21d));return flosum_repository_sync_dto_1[_0x4c6b97(0x221)][_0x4c6b97(0x1d1)](_0x38274f[0x0]);}async[a135_0x4f03f1(0x20d)](_0x2a91ca){const _0x39bf2a=a135_0x4f03f1,_0x23161a=await this[_0x39bf2a(0x215)]['query'](queries_1['GET_BRANCH_QUERY']['replace']('%id%',_0x2a91ca));if(_0x23161a['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x39bf2a(0x216)+_0x2a91ca+_0x39bf2a(0x21d));return flosum_repository_sync_dto_1[_0x39bf2a(0x221)][_0x39bf2a(0x1cc)](_0x23161a[0x0]);}async[a135_0x4f03f1(0x1e4)](_0x5eacf0){const _0x236a49=a135_0x4f03f1,_0x52235b=await this[_0x236a49(0x215)][_0x236a49(0x21f)](queries_1[_0x236a49(0x1e8)][_0x236a49(0x218)](_0x236a49(0x1cd),_0x5eacf0));if(_0x52235b[_0x236a49(0x1e6)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x236a49(0x1ec)+_0x5eacf0+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x236a49(0x1cc)](_0x52235b[0x0]);}async['getRepositoryRecordByName'](_0x597f33){const _0x565c4d=a135_0x4f03f1,_0x20f7a1=await this[_0x565c4d(0x215)]['query'](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x565c4d(0x218)]('%name%',_0x597f33));if(_0x20f7a1[_0x565c4d(0x1e6)]===0x0)throw new not_found_error_1[(_0x565c4d(0x1da))](_0x565c4d(0x1e0)+_0x597f33+_0x565c4d(0x21d));return flosum_repository_sync_dto_1[_0x565c4d(0x221)][_0x565c4d(0x1d1)](_0x20f7a1[0x0]);}async[a135_0x4f03f1(0x1ef)](_0x5ccfc5){const _0x577591=a135_0x4f03f1,_0x52b8e3=_0x577591(0x204)+queries_1[_0x577591(0x1fd)]+_0x577591(0x223)+_0x5ccfc5+'\x27';return this[_0x577591(0x1f3)](_0x52b8e3);}async[a135_0x4f03f1(0x1fa)](_0x25189d){const _0x226981=a135_0x4f03f1,_0x2b75d4=_0x226981(0x1cf)+queries_1[_0x226981(0x1fd)]+_0x226981(0x206)+_0x25189d+'\x27';return this[_0x226981(0x1f3)](_0x2b75d4);}async[a135_0x4f03f1(0x200)](_0x426ba7){const _0x12e18a=a135_0x4f03f1;var _0x2137cf;const _0x13d343=queries_1[_0x12e18a(0x220)]['replace'](_0x12e18a(0x20b),_0x426ba7['objectId'])[_0x12e18a(0x218)](_0x12e18a(0x1cd),_0x426ba7[_0x12e18a(0x1ea)]?constants_1[_0x12e18a(0x1e5)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x395957=await this[_0x12e18a(0x215)][_0x12e18a(0x21f)](_0x13d343),_0x3aafc5=(_0x2137cf=_0x395957[0x0])===null||_0x2137cf===void 0x0?void 0x0:_0x2137cf['Id'];if(!_0x3aafc5)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x3aafc5;}async[a135_0x4f03f1(0x1eb)](_0x120fc5){const _0x34dfa8=a135_0x4f03f1;let _0x484259=await this['getAttachmentId'](_0x120fc5)[_0x34dfa8(0x214)](()=>null);return!_0x484259&&(_0x484259=await this[_0x34dfa8(0x1fb)][_0x34dfa8(0x1d6)](_0x34dfa8(0x21e),{'Body':utils_1[_0x34dfa8(0x1f0)]('{}'),'ParentId':_0x120fc5[_0x34dfa8(0x1e3)],'ContentType':_0x34dfa8(0x1f6),'Name':_0x120fc5[_0x34dfa8(0x1ea)]?constants_1[_0x34dfa8(0x1e5)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x484259;}async[a135_0x4f03f1(0x219)](_0x3e426e,_0x565527){const _0x2b7cc4=a135_0x4f03f1,_0x6ad165=await this[_0x2b7cc4(0x1eb)](_0x3e426e);await this['salesforceService'][_0x2b7cc4(0x20a)](_0x2b7cc4(0x21e),_0x6ad165,{'Body':utils_1['encodeBase64'](JSON[_0x2b7cc4(0x1e2)](_0x565527))});}async[a135_0x4f03f1(0x1df)](_0x125251,_0x5e4fe4){const _0xf61fda=a135_0x4f03f1;await this[_0xf61fda(0x1fb)][_0xf61fda(0x20a)](_0x125251['objectType'],_0x125251['objectId'],{[constants_1[_0xf61fda(0x1dd)]+_0xf61fda(0x1ed)]:_0x5e4fe4});}async['disableSync'](_0x31525d){const _0x18d33f=a135_0x4f03f1;await this['salesforceService']['patchObject'](constants_1[_0x18d33f(0x1dd)]+_0x18d33f(0x1d9),_0x31525d,{[constants_1[_0x18d33f(0x1dd)]+_0x18d33f(0x1d7)]:![]});}};SalesforceSyncService=__decorate([typedi_1['Service'](),__metadata(a135_0x4f03f1(0x1cb),[salesforce_query_service_1[a135_0x4f03f1(0x213)],salesforce_service_1[a135_0x4f03f1(0x203)]])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;