const a135_0x3ec652=a135_0x3c01;(function(_0x7dc6c1,_0x35095a){const _0x10830d=a135_0x3c01,_0xa62ed7=_0x7dc6c1();while(!![]){try{const _0x5edb5d=parseInt(_0x10830d(0x1be))/0x1*(-parseInt(_0x10830d(0x1cf))/0x2)+parseInt(_0x10830d(0x1ca))/0x3+parseInt(_0x10830d(0x1c4))/0x4*(-parseInt(_0x10830d(0x1f2))/0x5)+parseInt(_0x10830d(0x1b7))/0x6*(parseInt(_0x10830d(0x1a2))/0x7)+parseInt(_0x10830d(0x1e5))/0x8*(-parseInt(_0x10830d(0x1c8))/0x9)+-parseInt(_0x10830d(0x1ba))/0xa*(parseInt(_0x10830d(0x1b1))/0xb)+parseInt(_0x10830d(0x1f4))/0xc;if(_0x5edb5d===_0x35095a)break;else _0xa62ed7['push'](_0xa62ed7['shift']());}catch(_0x5b2f80){_0xa62ed7['push'](_0xa62ed7['shift']());}}}(a135_0x4533,0x804e5));const a135_0x7b59b=(function(){let _0x3a8405=!![];return function(_0x35ff5b,_0x279bc3){const _0x2c9d63=_0x3a8405?function(){const _0x26925a=a135_0x3c01;if(_0x279bc3){const _0x40ef44=_0x279bc3[_0x26925a(0x1ed)](_0x35ff5b,arguments);return _0x279bc3=null,_0x40ef44;}}:function(){};return _0x3a8405=![],_0x2c9d63;};}()),a135_0x46d6db=a135_0x7b59b(this,function(){const _0x1b27ce=a135_0x3c01;return a135_0x46d6db[_0x1b27ce(0x1d1)]()['search']('(((.+)+)+)+$')[_0x1b27ce(0x1d1)]()[_0x1b27ce(0x1d4)](a135_0x46d6db)[_0x1b27ce(0x1af)](_0x1b27ce(0x1c3));});a135_0x46d6db();'use strict';function a135_0x3c01(_0x70875b,_0x50bb62){const _0x2ba068=a135_0x4533();return a135_0x3c01=function(_0x46d6db,_0x7b59b){_0x46d6db=_0x46d6db-0x1a1;let _0x45333b=_0x2ba068[_0x46d6db];return _0x45333b;},a135_0x3c01(_0x70875b,_0x50bb62);}var __decorate=this&&this[a135_0x3ec652(0x1ea)]||function(_0x1ff5ce,_0x3273aa,_0x13ac7c,_0x210402){const _0x33ffd4=a135_0x3ec652;var _0x1c4039=arguments[_0x33ffd4(0x1e0)],_0x35f1f7=_0x1c4039<0x3?_0x3273aa:_0x210402===null?_0x210402=Object[_0x33ffd4(0x1e4)](_0x3273aa,_0x13ac7c):_0x210402,_0x4cff2a;if(typeof Reflect===_0x33ffd4(0x1c2)&&typeof Reflect[_0x33ffd4(0x1db)]===_0x33ffd4(0x1a1))_0x35f1f7=Reflect[_0x33ffd4(0x1db)](_0x1ff5ce,_0x3273aa,_0x13ac7c,_0x210402);else{for(var _0x3bf7e6=_0x1ff5ce[_0x33ffd4(0x1e0)]-0x1;_0x3bf7e6>=0x0;_0x3bf7e6--)if(_0x4cff2a=_0x1ff5ce[_0x3bf7e6])_0x35f1f7=(_0x1c4039<0x3?_0x4cff2a(_0x35f1f7):_0x1c4039>0x3?_0x4cff2a(_0x3273aa,_0x13ac7c,_0x35f1f7):_0x4cff2a(_0x3273aa,_0x13ac7c))||_0x35f1f7;}return _0x1c4039>0x3&&_0x35f1f7&&Object[_0x33ffd4(0x1a3)](_0x3273aa,_0x13ac7c,_0x35f1f7),_0x35f1f7;},__metadata=this&&this[a135_0x3ec652(0x1dc)]||function(_0x4aefd3,_0x40c49e){const _0x1bfd0d=a135_0x3ec652;if(typeof Reflect===_0x1bfd0d(0x1c2)&&typeof Reflect[_0x1bfd0d(0x1b6)]===_0x1bfd0d(0x1a1))return Reflect[_0x1bfd0d(0x1b6)](_0x4aefd3,_0x40c49e);};Object[a135_0x3ec652(0x1a3)](exports,'__esModule',{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a135_0x3ec652(0x1ad)),constants_1=require('../../../constants'),errors_1=require(a135_0x3ec652(0x1d0)),utils_1=require(a135_0x3ec652(0x1b2)),flosum_repository_sync_dto_1=require(a135_0x3ec652(0x1a6)),not_found_error_1=require(a135_0x3ec652(0x1e2)),queries_1=require(a135_0x3ec652(0x1bf)),salesforce_query_service_1=require(a135_0x3ec652(0x1c1)),salesforce_service_1=require(a135_0x3ec652(0x1ec));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x33d579,_0x4747f6){const _0x50a01f=a135_0x3ec652;this['salesforceQuery']=_0x33d579,this[_0x50a01f(0x1e1)]=_0x4747f6;}async[a135_0x3ec652(0x1ce)](_0xa84ec1){const _0x4cba5e=a135_0x3ec652;var _0x48da7e;const _0x22b721=await this[_0x4cba5e(0x1fa)]['query'](_0xa84ec1),_0x330d52=[];for(const _0x3371c5 of _0x22b721){const _0x96f98b=(_0x48da7e=_0x3371c5[constants_1[_0x4cba5e(0x1d2)]+_0x4cba5e(0x1d6)])===null||_0x48da7e===void 0x0?void 0x0:_0x48da7e['records'];_0x96f98b&&_0x96f98b[_0x4cba5e(0x1e0)]&&_0x330d52[_0x4cba5e(0x1f8)](_0x96f98b[0x0]['Id']);}return _0x330d52;}async['getRepositoryRecords'](){const _0x29ea39=a135_0x3ec652,_0x3743ac=await this[_0x29ea39(0x1fa)][_0x29ea39(0x1aa)](queries_1[_0x29ea39(0x1f3)]);return _0x3743ac[_0x29ea39(0x1e6)](_0x5eea60=>flosum_repository_sync_dto_1[_0x29ea39(0x1ef)][_0x29ea39(0x1c7)](_0x5eea60));}async[a135_0x3ec652(0x1cc)](){const _0x3fc665=a135_0x3ec652,_0x12f874=await this[_0x3fc665(0x1fa)][_0x3fc665(0x1aa)](queries_1[_0x3fc665(0x1a7)]);return _0x12f874[_0x3fc665(0x1e6)](_0x4fde79=>flosum_repository_sync_dto_1[_0x3fc665(0x1ef)][_0x3fc665(0x1c0)](_0x4fde79));}async[a135_0x3ec652(0x1e7)](_0x39c003){const _0x18dd7b=a135_0x3ec652,_0x202477=await this[_0x18dd7b(0x1fa)]['query'](queries_1[_0x18dd7b(0x1d5)][_0x18dd7b(0x1b5)](_0x18dd7b(0x1dd),_0x39c003));if(_0x202477[_0x18dd7b(0x1e0)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x18dd7b(0x1c5)+_0x39c003+_0x18dd7b(0x1ae));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x18dd7b(0x1c7)](_0x202477[0x0]);}async[a135_0x3ec652(0x1da)](_0x3b8b89){const _0xf03760=a135_0x3ec652,_0x5f2de0=await this['salesforceQuery'][_0xf03760(0x1aa)](queries_1[_0xf03760(0x1f6)]['replace'](_0xf03760(0x1dd),_0x3b8b89));if(_0x5f2de0[_0xf03760(0x1e0)]===0x0)throw new not_found_error_1[(_0xf03760(0x1d3))](_0xf03760(0x1f9)+_0x3b8b89+_0xf03760(0x1ae));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x5f2de0[0x0]);}async[a135_0x3ec652(0x1b0)](_0x19f19a){const _0x3fd7f9=a135_0x3ec652,_0x4d653f=await this['salesforceQuery'][_0x3fd7f9(0x1aa)](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x3fd7f9(0x1b5)](_0x3fd7f9(0x1f0),_0x19f19a));if(_0x4d653f[_0x3fd7f9(0x1e0)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x3fd7f9(0x1a9)+_0x19f19a+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x3fd7f9(0x1ef)][_0x3fd7f9(0x1c0)](_0x4d653f[0x0]);}async[a135_0x3ec652(0x1f7)](_0x3033ba){const _0x54d1a0=a135_0x3ec652,_0x431181=await this[_0x54d1a0(0x1fa)]['query'](queries_1[_0x54d1a0(0x1c9)]['replace'](_0x54d1a0(0x1f0),_0x3033ba));if(_0x431181[_0x54d1a0(0x1e0)]===0x0)throw new not_found_error_1[(_0x54d1a0(0x1d3))]('Repository\x20'+_0x3033ba+_0x54d1a0(0x1ae));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x54d1a0(0x1c7)](_0x431181[0x0]);}async['getComponentsFromRepository'](_0x2781b0){const _0xe44f90=a135_0x3ec652,_0x544bae=_0xe44f90(0x1c6)+queries_1['GET_COMPONENTS_QUERY']+_0xe44f90(0x1d9)+_0x2781b0+'\x27';return this[_0xe44f90(0x1ce)](_0x544bae);}async['getBranchComponents'](_0x8f604b){const _0x49783b=a135_0x3ec652,_0x29f6b7=_0x49783b(0x1b8)+queries_1['GET_COMPONENTS_QUERY']+_0x49783b(0x1bd)+_0x8f604b+'\x27';return this[_0x49783b(0x1ce)](_0x29f6b7);}async[a135_0x3ec652(0x1b4)](_0x4f1100){const _0x2e20f4=a135_0x3ec652;var _0x5ebc3c;const _0x492715=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x2e20f4(0x1b5)](_0x2e20f4(0x1b9),_0x4f1100[_0x2e20f4(0x1f5)])[_0x2e20f4(0x1b5)](_0x2e20f4(0x1f0),_0x4f1100[_0x2e20f4(0x1d8)]?constants_1[_0x2e20f4(0x1a8)]:constants_1[_0x2e20f4(0x1df)]),_0x2cd110=await this[_0x2e20f4(0x1fa)]['query'](_0x492715),_0x2363a8=(_0x5ebc3c=_0x2cd110[0x0])===null||_0x5ebc3c===void 0x0?void 0x0:_0x5ebc3c['Id'];if(!_0x2363a8)throw new Error(errors_1[_0x2e20f4(0x1eb)]);return _0x2363a8;}async[a135_0x3ec652(0x1ac)](_0xe7892f){const _0x4c5c04=a135_0x3ec652;let _0x8da610=await this['getAttachmentId'](_0xe7892f)[_0x4c5c04(0x1e8)](()=>null);return!_0x8da610&&(_0x8da610=await this[_0x4c5c04(0x1e1)][_0x4c5c04(0x1ab)]('Attachment',{'Body':utils_1[_0x4c5c04(0x1bb)]('{}'),'ParentId':_0xe7892f[_0x4c5c04(0x1f5)],'ContentType':_0x4c5c04(0x1ee),'Name':_0xe7892f[_0x4c5c04(0x1d8)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x4c5c04(0x1df)]})),_0x8da610;}async[a135_0x3ec652(0x1b3)](_0x5cae89,_0x552af0){const _0x568330=a135_0x3ec652,_0x1fcff5=await this[_0x568330(0x1ac)](_0x5cae89);await this['salesforceService'][_0x568330(0x1bc)]('Attachment',_0x1fcff5,{'Body':utils_1[_0x568330(0x1bb)](JSON['stringify'](_0x552af0))});}async['setStatus'](_0xb2ad23,_0x495743){const _0x1a5b3d=a135_0x3ec652;await this[_0x1a5b3d(0x1e1)][_0x1a5b3d(0x1bc)](_0xb2ad23[_0x1a5b3d(0x1e3)],_0xb2ad23[_0x1a5b3d(0x1f5)],{[constants_1[_0x1a5b3d(0x1de)]+_0x1a5b3d(0x1a5)]:_0x495743});}async[a135_0x3ec652(0x1a4)](_0x2f909f){const _0x4ed46f=a135_0x3ec652;await this['salesforceService'][_0x4ed46f(0x1bc)](constants_1['FLOSUM_GIT_NAMESPACE']+'Git_Settings__c',_0x2f909f,{[constants_1[_0x4ed46f(0x1de)]+_0x4ed46f(0x1d7)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a135_0x3ec652(0x1cd)](),__metadata('design:paramtypes',[salesforce_query_service_1[a135_0x3ec652(0x1e9)],salesforce_service_1[a135_0x3ec652(0x1f1)]])],SalesforceSyncService),exports[a135_0x3ec652(0x1cb)]=SalesforceSyncService;function a135_0x4533(){const _0xd3945f=['891849ThSeBK','SalesforceSyncService','getBranchRecords','Service','getComponents','2kpeYyf','../../../constants/errors','toString','FLOSUM_NAMESPACE','SalesforceNotFoundError','constructor','GET_REPOSITORY_QUERY','Components__r','Sync_In_Progress__c','repositoryId','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','getBranchRecord','decorate','__metadata','%id%','FLOSUM_GIT_NAMESPACE','SYNC_ATTACHMENT_FOR_BRANCH_NAME','length','salesforceService','../errors/not-found.error','objectType','getOwnPropertyDescriptor','192GeSwhj','map','getRepositoryRecord','catch','SalesforceQueryService','__decorate','ERR_INVALID_ATTACHMENT_ID','./salesforce.service','apply','text/plain','FlosumRepositorySyncDto','%name%','SalesforceService','1666195KVXlLE','GET_WAITING_REPOSITORIES_QUERY','21382140JBLELz','objectId','GET_BRANCH_QUERY','getRepositoryRecordByName','push','Branch\x20with\x20Id\x20','salesforceQuery','function','427322cOhPAF','defineProperty','disableSync','Synchronization_Status__c','../dto/flosum-repository-sync.dto','GET_WAITING_BRANCHES_QUERY','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','Branch\x20','query','createObject','getRemoteStateAttachmentId','typedi','\x20not\x20found\x20on\x20salesforce','search','getBranchRecordByName','7980841pTaSqk','../../shared/utils','updateRemoteState','getAttachmentId','replace','metadata','6SNjXdQ','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','%parentId%','10qvgaUd','encodeBase64','patchObject','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','104519pjRUjs','../queries','fromBranchRecord','./salesforce-query.service','object','(((.+)+)+)+$','4ejqLyK','Repository\x20with\x20Id\x20','\x0a\x20\x20\x20\x20\x20\x20','fromRepositoryRecord','169254OBYmar','GET_REPOSITORY_BY_NAME_QUERY'];a135_0x4533=function(){return _0xd3945f;};return a135_0x4533();}