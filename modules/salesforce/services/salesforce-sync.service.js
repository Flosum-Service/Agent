const a135_0xfdbb9d=a135_0x2936;(function(_0x27c1fc,_0x5adf84){const _0x53f75a=a135_0x2936,_0x3eeb6c=_0x27c1fc();while(!![]){try{const _0x986cc2=-parseInt(_0x53f75a(0x159))/0x1+-parseInt(_0x53f75a(0x13a))/0x2*(parseInt(_0x53f75a(0x128))/0x3)+-parseInt(_0x53f75a(0x158))/0x4*(parseInt(_0x53f75a(0x129))/0x5)+parseInt(_0x53f75a(0x125))/0x6*(parseInt(_0x53f75a(0x169))/0x7)+parseInt(_0x53f75a(0x137))/0x8*(parseInt(_0x53f75a(0x16d))/0x9)+parseInt(_0x53f75a(0x14a))/0xa*(parseInt(_0x53f75a(0x14d))/0xb)+parseInt(_0x53f75a(0x139))/0xc*(-parseInt(_0x53f75a(0x144))/0xd);if(_0x986cc2===_0x5adf84)break;else _0x3eeb6c['push'](_0x3eeb6c['shift']());}catch(_0x2ff242){_0x3eeb6c['push'](_0x3eeb6c['shift']());}}}(a135_0x2ab9,0x8015f));const a135_0x37d56b=(function(){let _0x53a6a2=!![];return function(_0x2c6786,_0x4ec9f5){const _0x2cbbbb=_0x53a6a2?function(){const _0xe310d7=a135_0x2936;if(_0x4ec9f5){const _0xa865f1=_0x4ec9f5[_0xe310d7(0x14c)](_0x2c6786,arguments);return _0x4ec9f5=null,_0xa865f1;}}:function(){};return _0x53a6a2=![],_0x2cbbbb;};}()),a135_0x23409c=a135_0x37d56b(this,function(){const _0x44aa99=a135_0x2936;return a135_0x23409c[_0x44aa99(0x16e)]()['search']('(((.+)+)+)+$')['toString']()[_0x44aa99(0x168)](a135_0x23409c)['search']('(((.+)+)+)+$');});a135_0x23409c();'use strict';var __decorate=this&&this['__decorate']||function(_0x2a2518,_0x426acc,_0x168b8d,_0x1a4418){const _0x2cdaff=a135_0x2936;var _0xc8c00c=arguments[_0x2cdaff(0x11e)],_0x18d1aa=_0xc8c00c<0x3?_0x426acc:_0x1a4418===null?_0x1a4418=Object[_0x2cdaff(0x132)](_0x426acc,_0x168b8d):_0x1a4418,_0x48d5f9;if(typeof Reflect===_0x2cdaff(0x131)&&typeof Reflect[_0x2cdaff(0x140)]===_0x2cdaff(0x124))_0x18d1aa=Reflect['decorate'](_0x2a2518,_0x426acc,_0x168b8d,_0x1a4418);else{for(var _0x5196e6=_0x2a2518[_0x2cdaff(0x11e)]-0x1;_0x5196e6>=0x0;_0x5196e6--)if(_0x48d5f9=_0x2a2518[_0x5196e6])_0x18d1aa=(_0xc8c00c<0x3?_0x48d5f9(_0x18d1aa):_0xc8c00c>0x3?_0x48d5f9(_0x426acc,_0x168b8d,_0x18d1aa):_0x48d5f9(_0x426acc,_0x168b8d))||_0x18d1aa;}return _0xc8c00c>0x3&&_0x18d1aa&&Object[_0x2cdaff(0x152)](_0x426acc,_0x168b8d,_0x18d1aa),_0x18d1aa;},__metadata=this&&this['__metadata']||function(_0x226e6d,_0x26100c){const _0x5a8165=a135_0x2936;if(typeof Reflect===_0x5a8165(0x131)&&typeof Reflect[_0x5a8165(0x12d)]===_0x5a8165(0x124))return Reflect[_0x5a8165(0x12d)](_0x226e6d,_0x26100c);};function a135_0x2936(_0x244eae,_0x45d121){const _0x21ed99=a135_0x2ab9();return a135_0x2936=function(_0x23409c,_0x37d56b){_0x23409c=_0x23409c-0x11e;let _0x2ab938=_0x21ed99[_0x23409c];return _0x2ab938;},a135_0x2936(_0x244eae,_0x45d121);}Object[a135_0xfdbb9d(0x152)](exports,a135_0xfdbb9d(0x16c),{'value':!![]}),exports[a135_0xfdbb9d(0x151)]=void 0x0;const typedi_1=require(a135_0xfdbb9d(0x130)),constants_1=require(a135_0xfdbb9d(0x156)),errors_1=require(a135_0xfdbb9d(0x174)),utils_1=require(a135_0xfdbb9d(0x121)),flosum_repository_sync_dto_1=require(a135_0xfdbb9d(0x175)),not_found_error_1=require(a135_0xfdbb9d(0x135)),queries_1=require(a135_0xfdbb9d(0x120)),salesforce_query_service_1=require(a135_0xfdbb9d(0x172)),salesforce_service_1=require(a135_0xfdbb9d(0x166));let SalesforceSyncService=class SalesforceSyncService{constructor(_0xa0287a,_0x27ffd1){const _0x266758=a135_0xfdbb9d;this[_0x266758(0x134)]=_0xa0287a,this[_0x266758(0x147)]=_0x27ffd1;}async[a135_0xfdbb9d(0x12c)](_0x1071aa){const _0x3ff4a0=a135_0xfdbb9d;var _0x500e2d;const _0x56bb8c=await this['salesforceQuery'][_0x3ff4a0(0x133)](_0x1071aa),_0x83c06e=[];for(const _0x29261a of _0x56bb8c){const _0x59338c=(_0x500e2d=_0x29261a[constants_1['FLOSUM_NAMESPACE']+_0x3ff4a0(0x150)])===null||_0x500e2d===void 0x0?void 0x0:_0x500e2d[_0x3ff4a0(0x126)];_0x59338c&&_0x59338c[_0x3ff4a0(0x11e)]&&_0x83c06e[_0x3ff4a0(0x171)](_0x59338c[0x0]['Id']);}return _0x83c06e;}async['getRepositoryRecords'](){const _0x44d234=a135_0xfdbb9d,_0x22936e=await this[_0x44d234(0x134)]['query'](queries_1['GET_WAITING_REPOSITORIES_QUERY']);return _0x22936e['map'](_0x5c3173=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x44d234(0x13c)](_0x5c3173));}async[a135_0xfdbb9d(0x123)](){const _0x166f90=a135_0xfdbb9d,_0x4fe33f=await this[_0x166f90(0x134)][_0x166f90(0x133)](queries_1[_0x166f90(0x148)]);return _0x4fe33f['map'](_0x2e1f54=>flosum_repository_sync_dto_1[_0x166f90(0x12f)][_0x166f90(0x13b)](_0x2e1f54));}async[a135_0xfdbb9d(0x164)](_0x599c9e){const _0x391a61=a135_0xfdbb9d,_0x3a1bd1=await this[_0x391a61(0x134)][_0x391a61(0x133)](queries_1[_0x391a61(0x16b)][_0x391a61(0x15d)](_0x391a61(0x149),_0x599c9e));if(_0x3a1bd1[_0x391a61(0x11e)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x391a61(0x177)+_0x599c9e+_0x391a61(0x165));return flosum_repository_sync_dto_1[_0x391a61(0x12f)][_0x391a61(0x13c)](_0x3a1bd1[0x0]);}async[a135_0xfdbb9d(0x170)](_0x1e4767){const _0x21a9a7=a135_0xfdbb9d,_0x3d3668=await this[_0x21a9a7(0x134)]['query'](queries_1[_0x21a9a7(0x127)]['replace'](_0x21a9a7(0x149),_0x1e4767));if(_0x3d3668['length']===0x0)throw new not_found_error_1[(_0x21a9a7(0x122))](_0x21a9a7(0x155)+_0x1e4767+_0x21a9a7(0x165));return flosum_repository_sync_dto_1[_0x21a9a7(0x12f)]['fromBranchRecord'](_0x3d3668[0x0]);}async[a135_0xfdbb9d(0x161)](_0x2bf7dc){const _0x1383da=a135_0xfdbb9d,_0x2ba0f3=await this[_0x1383da(0x134)]['query'](queries_1[_0x1383da(0x16a)][_0x1383da(0x15d)](_0x1383da(0x146),_0x2bf7dc));if(_0x2ba0f3[_0x1383da(0x11e)]===0x0)throw new not_found_error_1[(_0x1383da(0x122))]('Branch\x20'+_0x2bf7dc+_0x1383da(0x165));return flosum_repository_sync_dto_1[_0x1383da(0x12f)][_0x1383da(0x13b)](_0x2ba0f3[0x0]);}async[a135_0xfdbb9d(0x15c)](_0xfb935c){const _0x5ec4b0=a135_0xfdbb9d,_0x1c30c6=await this[_0x5ec4b0(0x134)][_0x5ec4b0(0x133)](queries_1[_0x5ec4b0(0x160)][_0x5ec4b0(0x15d)](_0x5ec4b0(0x146),_0xfb935c));if(_0x1c30c6[_0x5ec4b0(0x11e)]===0x0)throw new not_found_error_1[(_0x5ec4b0(0x122))](_0x5ec4b0(0x142)+_0xfb935c+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x5ec4b0(0x12f)][_0x5ec4b0(0x13c)](_0x1c30c6[0x0]);}async['getComponentsFromRepository'](_0x3516fc){const _0x2845cc=a135_0xfdbb9d,_0x116215=_0x2845cc(0x13e)+queries_1['GET_COMPONENTS_QUERY']+_0x2845cc(0x14b)+_0x3516fc+'\x27';return this[_0x2845cc(0x12c)](_0x116215);}async[a135_0xfdbb9d(0x145)](_0x59f1b7){const _0x14b9d9=a135_0xfdbb9d,_0x1d9382=_0x14b9d9(0x12a)+queries_1[_0x14b9d9(0x13d)]+_0x14b9d9(0x138)+_0x59f1b7+'\x27';return this[_0x14b9d9(0x12c)](_0x1d9382);}async['getAttachmentId'](_0x4a34bd){const _0x418023=a135_0xfdbb9d;var _0x193de4;const _0x5a4dee=queries_1[_0x418023(0x163)]['replace']('%parentId%',_0x4a34bd[_0x418023(0x153)])[_0x418023(0x15d)](_0x418023(0x146),_0x4a34bd['repositoryId']?constants_1[_0x418023(0x136)]:constants_1[_0x418023(0x11f)]),_0x4259d4=await this[_0x418023(0x134)]['query'](_0x5a4dee),_0x53838d=(_0x193de4=_0x4259d4[0x0])===null||_0x193de4===void 0x0?void 0x0:_0x193de4['Id'];if(!_0x53838d)throw new Error(errors_1[_0x418023(0x141)]);return _0x53838d;}async[a135_0xfdbb9d(0x14e)](_0xe501cf){const _0x351b28=a135_0xfdbb9d;let _0x1a6937=await this[_0x351b28(0x15e)](_0xe501cf)['catch'](()=>null);return!_0x1a6937&&(_0x1a6937=await this[_0x351b28(0x147)][_0x351b28(0x167)](_0x351b28(0x154),{'Body':utils_1[_0x351b28(0x12e)]('{}'),'ParentId':_0xe501cf[_0x351b28(0x153)],'ContentType':'text/plain','Name':_0xe501cf[_0x351b28(0x143)]?constants_1[_0x351b28(0x136)]:constants_1[_0x351b28(0x11f)]})),_0x1a6937;}async['updateRemoteState'](_0x39fadb,_0x221c48){const _0x384791=a135_0xfdbb9d,_0x49238f=await this[_0x384791(0x14e)](_0x39fadb);await this[_0x384791(0x147)]['patchObject']('Attachment',_0x49238f,{'Body':utils_1[_0x384791(0x12e)](JSON[_0x384791(0x162)](_0x221c48))});}async[a135_0xfdbb9d(0x12b)](_0x257fd7,_0x27e086){const _0x47d58c=a135_0xfdbb9d;await this[_0x47d58c(0x147)][_0x47d58c(0x16f)](_0x257fd7[_0x47d58c(0x15a)],_0x257fd7[_0x47d58c(0x153)],{[constants_1[_0x47d58c(0x15f)]+_0x47d58c(0x15b)]:_0x27e086});}async['disableSync'](_0xe5fb7d){const _0x411232=a135_0xfdbb9d;await this[_0x411232(0x147)][_0x411232(0x16f)](constants_1[_0x411232(0x15f)]+'Git_Settings__c',_0xe5fb7d,{[constants_1[_0x411232(0x15f)]+_0x411232(0x173)]:![]});}};function a135_0x2ab9(){const _0x55684d=['createObject','constructor','288883SqUHcg','GET_BRANCH_BY_NAME_QUERY','GET_REPOSITORY_QUERY','__esModule','102681ksXzEJ','toString','patchObject','getBranchRecord','push','./salesforce-query.service','Sync_In_Progress__c','../../../constants/errors','../dto/flosum-repository-sync.dto','SalesforceService','Repository\x20with\x20Id\x20','length','SYNC_ATTACHMENT_FOR_BRANCH_NAME','../queries','../../shared/utils','SalesforceNotFoundError','getBranchRecords','function','132CNWizv','records','GET_BRANCH_QUERY','1437FlDYLI','5YFIQak','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','setStatus','getComponents','metadata','encodeBase64','FlosumRepositorySyncDto','typedi','object','getOwnPropertyDescriptor','query','salesforceQuery','../errors/not-found.error','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','272LCaguR','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','276KDnmfz','2446ECPfPK','fromBranchRecord','fromRepositoryRecord','GET_COMPONENTS_QUERY','\x0a\x20\x20\x20\x20\x20\x20','Service','decorate','ERR_INVALID_ATTACHMENT_ID','Repository\x20','repositoryId','10049MFvoAz','getBranchComponents','%name%','salesforceService','GET_WAITING_BRANCHES_QUERY','%id%','10kLsYLd','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','apply','1651826NleHdU','getRemoteStateAttachmentId','design:paramtypes','Components__r','SalesforceSyncService','defineProperty','objectId','Attachment','Branch\x20with\x20Id\x20','../../../constants','SalesforceQueryService','1195828QlZqfV','18798hOjeUr','objectType','Synchronization_Status__c','getRepositoryRecordByName','replace','getAttachmentId','FLOSUM_GIT_NAMESPACE','GET_REPOSITORY_BY_NAME_QUERY','getBranchRecordByName','stringify','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','getRepositoryRecord','\x20not\x20found\x20on\x20salesforce','./salesforce.service'];a135_0x2ab9=function(){return _0x55684d;};return a135_0x2ab9();}SalesforceSyncService=__decorate([typedi_1[a135_0xfdbb9d(0x13f)](),__metadata(a135_0xfdbb9d(0x14f),[salesforce_query_service_1[a135_0xfdbb9d(0x157)],salesforce_service_1[a135_0xfdbb9d(0x176)]])],SalesforceSyncService),exports[a135_0xfdbb9d(0x151)]=SalesforceSyncService;