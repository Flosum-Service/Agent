const a136_0x520405=a136_0x4812;function a136_0x4812(_0x2679cb,_0x273ebc){const _0x5043eb=a136_0x41f0();return a136_0x4812=function(_0x1be01f,_0x9e611a){_0x1be01f=_0x1be01f-0x1b5;let _0x41f043=_0x5043eb[_0x1be01f];return _0x41f043;},a136_0x4812(_0x2679cb,_0x273ebc);}(function(_0x32b89e,_0x287a15){const _0x507e88=a136_0x4812,_0x56190e=_0x32b89e();while(!![]){try{const _0x518839=parseInt(_0x507e88(0x1c4))/0x1*(parseInt(_0x507e88(0x1bf))/0x2)+parseInt(_0x507e88(0x1c5))/0x3+-parseInt(_0x507e88(0x1bb))/0x4+-parseInt(_0x507e88(0x1cc))/0x5*(-parseInt(_0x507e88(0x1d0))/0x6)+parseInt(_0x507e88(0x1df))/0x7*(-parseInt(_0x507e88(0x1e9))/0x8)+parseInt(_0x507e88(0x1e0))/0x9*(parseInt(_0x507e88(0x1ff))/0xa)+-parseInt(_0x507e88(0x1ec))/0xb*(parseInt(_0x507e88(0x205))/0xc);if(_0x518839===_0x287a15)break;else _0x56190e['push'](_0x56190e['shift']());}catch(_0x25c596){_0x56190e['push'](_0x56190e['shift']());}}}(a136_0x41f0,0xc0406));const a136_0x9e611a=(function(){let _0x511b4d=!![];return function(_0x43f52b,_0x3f17ca){const _0x4d7270=_0x511b4d?function(){if(_0x3f17ca){const _0x3ab1bf=_0x3f17ca['apply'](_0x43f52b,arguments);return _0x3f17ca=null,_0x3ab1bf;}}:function(){};return _0x511b4d=![],_0x4d7270;};}()),a136_0x1be01f=a136_0x9e611a(this,function(){const _0x1f5771=a136_0x4812;return a136_0x1be01f[_0x1f5771(0x1d7)]()['search'](_0x1f5771(0x1be))[_0x1f5771(0x1d7)]()[_0x1f5771(0x1ba)](a136_0x1be01f)['search'](_0x1f5771(0x1be));});function a136_0x41f0(){const _0x1c48f=['16583vcxzpl','472221IUQtxQ','ERR_INVALID_ATTACHMENT_ID','../errors/not-found.error','getAttachmentId','Sync_In_Progress__c','encodeBase64','fromRepositoryRecord','__esModule','FlosumRepositorySyncDto','3088VLUPCU','GET_COMPONENTS_QUERY','GET_REPOSITORY_BY_NAME_QUERY','1353bgepzw','Attachment','\x0a\x20\x20\x20\x20\x20\x20','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','SalesforceNotFoundError','decorate','patchObject','Git_Settings__c','__decorate','metadata','SYNC_ATTACHMENT_FOR_BRANCH_NAME','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','getRemoteStateAttachmentId','%name%','Repository\x20with\x20Id\x20','FLOSUM_NAMESPACE','GET_WAITING_BRANCHES_QUERY','object','Branch\x20with\x20Id\x20','260JPRTGb','../../../constants','defineProperty','function','%id%','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','11052cGkbpt','fromBranchRecord','records','disableSync','getComponents','updateRemoteState','repositoryId','Synchronization_Status__c','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','setStatus','getBranchComponents','constructor','5620476sstwXu','salesforceQuery','FLOSUM_GIT_NAMESPACE','(((.+)+)+)+$','2256818QjCNyr','map','./salesforce.service','getComponentsFromRepository','__metadata','1qFYJZK','631488dOLXWj','../../../constants/errors','objectType','GET_BRANCH_QUERY','./salesforce-query.service','SalesforceService','GET_BRANCH_BY_NAME_QUERY','835sOsSzT','Branch\x20','objectId','getBranchRecordByName','18582OJQxIK','\x20not\x20found\x20on\x20salesforce','SalesforceQueryService','GET_WAITING_REPOSITORIES_QUERY','Repository\x20','query','getOwnPropertyDescriptor','toString','%parentId%','length','replace','salesforceService','getBranchRecord','design:paramtypes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20'];a136_0x41f0=function(){return _0x1c48f;};return a136_0x41f0();}a136_0x1be01f();'use strict';var __decorate=this&&this[a136_0x520405(0x1f4)]||function(_0x4cd0d6,_0x57f775,_0x5d4455,_0x2ed85e){const _0x134e91=a136_0x520405;var _0x350084=arguments[_0x134e91(0x1d9)],_0x50dbd7=_0x350084<0x3?_0x57f775:_0x2ed85e===null?_0x2ed85e=Object[_0x134e91(0x1d6)](_0x57f775,_0x5d4455):_0x2ed85e,_0x431a13;if(typeof Reflect===_0x134e91(0x1fd)&&typeof Reflect[_0x134e91(0x1f1)]===_0x134e91(0x202))_0x50dbd7=Reflect['decorate'](_0x4cd0d6,_0x57f775,_0x5d4455,_0x2ed85e);else{for(var _0x1047a8=_0x4cd0d6[_0x134e91(0x1d9)]-0x1;_0x1047a8>=0x0;_0x1047a8--)if(_0x431a13=_0x4cd0d6[_0x1047a8])_0x50dbd7=(_0x350084<0x3?_0x431a13(_0x50dbd7):_0x350084>0x3?_0x431a13(_0x57f775,_0x5d4455,_0x50dbd7):_0x431a13(_0x57f775,_0x5d4455))||_0x50dbd7;}return _0x350084>0x3&&_0x50dbd7&&Object[_0x134e91(0x201)](_0x57f775,_0x5d4455,_0x50dbd7),_0x50dbd7;},__metadata=this&&this[a136_0x520405(0x1c3)]||function(_0x272deb,_0xec482f){const _0x4b9642=a136_0x520405;if(typeof Reflect==='object'&&typeof Reflect[_0x4b9642(0x1f5)]===_0x4b9642(0x202))return Reflect[_0x4b9642(0x1f5)](_0x272deb,_0xec482f);};Object[a136_0x520405(0x201)](exports,a136_0x520405(0x1e7),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require('typedi'),constants_1=require(a136_0x520405(0x200)),errors_1=require(a136_0x520405(0x1c6)),utils_1=require('../../shared/utils'),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a136_0x520405(0x1e2)),queries_1=require('../queries'),salesforce_query_service_1=require(a136_0x520405(0x1c9)),salesforce_service_1=require(a136_0x520405(0x1c1));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x5f0ca0,_0x3037a6){const _0x42ffab=a136_0x520405;this[_0x42ffab(0x1bc)]=_0x5f0ca0,this['salesforceService']=_0x3037a6;}async['getComponents'](_0x27c494){const _0x49c525=a136_0x520405;var _0x484d36;const _0x2c553e=await this[_0x49c525(0x1bc)][_0x49c525(0x1d5)](_0x27c494),_0x3b9d56=[];for(const _0x192e66 of _0x2c553e){const _0x4fc1e2=(_0x484d36=_0x192e66[constants_1[_0x49c525(0x1fb)]+'Components__r'])===null||_0x484d36===void 0x0?void 0x0:_0x484d36[_0x49c525(0x207)];_0x4fc1e2&&_0x4fc1e2[_0x49c525(0x1d9)]&&_0x3b9d56['push'](_0x4fc1e2[0x0]['Id']);}return _0x3b9d56;}async['getRepositoryRecords'](){const _0xe4b353=a136_0x520405,_0x651cdf=await this['salesforceQuery'][_0xe4b353(0x1d5)](queries_1[_0xe4b353(0x1d3)]);return _0x651cdf[_0xe4b353(0x1c0)](_0x4b0d42=>flosum_repository_sync_dto_1[_0xe4b353(0x1e8)][_0xe4b353(0x1e6)](_0x4b0d42));}async['getBranchRecords'](){const _0x227540=a136_0x520405,_0x2d756c=await this[_0x227540(0x1bc)][_0x227540(0x1d5)](queries_1[_0x227540(0x1fc)]);return _0x2d756c[_0x227540(0x1c0)](_0x544d3d=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x227540(0x206)](_0x544d3d));}async['getRepositoryRecord'](_0x5edc97){const _0x3c0de0=a136_0x520405,_0x2a6ccf=await this[_0x3c0de0(0x1bc)][_0x3c0de0(0x1d5)](queries_1['GET_REPOSITORY_QUERY'][_0x3c0de0(0x1da)](_0x3c0de0(0x203),_0x5edc97));if(_0x2a6ccf[_0x3c0de0(0x1d9)]===0x0)throw new not_found_error_1[(_0x3c0de0(0x1f0))](_0x3c0de0(0x1fa)+_0x5edc97+_0x3c0de0(0x1d1));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x3c0de0(0x1e6)](_0x2a6ccf[0x0]);}async[a136_0x520405(0x1dc)](_0x529e58){const _0x391cf3=a136_0x520405,_0x4d0f08=await this[_0x391cf3(0x1bc)][_0x391cf3(0x1d5)](queries_1[_0x391cf3(0x1c8)][_0x391cf3(0x1da)](_0x391cf3(0x203),_0x529e58));if(_0x4d0f08[_0x391cf3(0x1d9)]===0x0)throw new not_found_error_1[(_0x391cf3(0x1f0))](_0x391cf3(0x1fe)+_0x529e58+_0x391cf3(0x1d1));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x391cf3(0x206)](_0x4d0f08[0x0]);}async[a136_0x520405(0x1cf)](_0x342d07){const _0x2dd92e=a136_0x520405,_0x593d62=await this['salesforceQuery'][_0x2dd92e(0x1d5)](queries_1[_0x2dd92e(0x1cb)][_0x2dd92e(0x1da)]('%name%',_0x342d07));if(_0x593d62[_0x2dd92e(0x1d9)]===0x0)throw new not_found_error_1[(_0x2dd92e(0x1f0))](_0x2dd92e(0x1cd)+_0x342d07+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x2dd92e(0x206)](_0x593d62[0x0]);}async['getRepositoryRecordByName'](_0x2f370e){const _0x1a6a34=a136_0x520405,_0x40e057=await this[_0x1a6a34(0x1bc)]['query'](queries_1[_0x1a6a34(0x1eb)][_0x1a6a34(0x1da)](_0x1a6a34(0x1f9),_0x2f370e));if(_0x40e057[_0x1a6a34(0x1d9)]===0x0)throw new not_found_error_1[(_0x1a6a34(0x1f0))](_0x1a6a34(0x1d4)+_0x2f370e+_0x1a6a34(0x1d1));return flosum_repository_sync_dto_1[_0x1a6a34(0x1e8)][_0x1a6a34(0x1e6)](_0x40e057[0x0]);}async[a136_0x520405(0x1c2)](_0x3a01da){const _0x43ab57=a136_0x520405,_0x55d3ae=_0x43ab57(0x1ee)+queries_1[_0x43ab57(0x1ea)]+_0x43ab57(0x1f7)+_0x3a01da+'\x27';return this[_0x43ab57(0x209)](_0x55d3ae);}async[a136_0x520405(0x1b9)](_0x5e8189){const _0x5028b5=a136_0x520405,_0x57850e=_0x5028b5(0x1de)+queries_1[_0x5028b5(0x1ea)]+_0x5028b5(0x204)+_0x5e8189+'\x27';return this['getComponents'](_0x57850e);}async[a136_0x520405(0x1e3)](_0x539345){const _0x5f2a96=a136_0x520405;var _0x4d990f;const _0x26d808=queries_1[_0x5f2a96(0x1b7)][_0x5f2a96(0x1da)](_0x5f2a96(0x1d8),_0x539345[_0x5f2a96(0x1ce)])[_0x5f2a96(0x1da)]('%name%',_0x539345['repositoryId']?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x5f2a96(0x1f6)]),_0x58ebb9=await this[_0x5f2a96(0x1bc)][_0x5f2a96(0x1d5)](_0x26d808),_0x3a2971=(_0x4d990f=_0x58ebb9[0x0])===null||_0x4d990f===void 0x0?void 0x0:_0x4d990f['Id'];if(!_0x3a2971)throw new Error(errors_1[_0x5f2a96(0x1e1)]);return _0x3a2971;}async[a136_0x520405(0x1f8)](_0x120331){const _0x588c65=a136_0x520405;let _0x3ff17c=await this[_0x588c65(0x1e3)](_0x120331)['catch'](()=>null);return!_0x3ff17c&&(_0x3ff17c=await this[_0x588c65(0x1db)]['createObject'](_0x588c65(0x1ed),{'Body':utils_1[_0x588c65(0x1e5)]('{}'),'ParentId':_0x120331[_0x588c65(0x1ce)],'ContentType':'text/plain','Name':_0x120331[_0x588c65(0x1b5)]?constants_1[_0x588c65(0x1ef)]:constants_1[_0x588c65(0x1f6)]})),_0x3ff17c;}async[a136_0x520405(0x20a)](_0x385916,_0x3727b1){const _0x2b3c97=a136_0x520405,_0x8150c5=await this[_0x2b3c97(0x1f8)](_0x385916);await this[_0x2b3c97(0x1db)][_0x2b3c97(0x1f2)](_0x2b3c97(0x1ed),_0x8150c5,{'Body':utils_1['encodeBase64'](JSON['stringify'](_0x3727b1))});}async[a136_0x520405(0x1b8)](_0x3d9e0e,_0x366aef){const _0xf5f769=a136_0x520405;await this[_0xf5f769(0x1db)][_0xf5f769(0x1f2)](_0x3d9e0e[_0xf5f769(0x1c7)],_0x3d9e0e['objectId'],{[constants_1[_0xf5f769(0x1bd)]+_0xf5f769(0x1b6)]:_0x366aef});}async[a136_0x520405(0x208)](_0x338a64){const _0x4fe3e6=a136_0x520405;await this[_0x4fe3e6(0x1db)][_0x4fe3e6(0x1f2)](constants_1[_0x4fe3e6(0x1bd)]+_0x4fe3e6(0x1f3),_0x338a64,{[constants_1[_0x4fe3e6(0x1bd)]+_0x4fe3e6(0x1e4)]:![]});}};SalesforceSyncService=__decorate([typedi_1['Service'](),__metadata(a136_0x520405(0x1dd),[salesforce_query_service_1[a136_0x520405(0x1d2)],salesforce_service_1[a136_0x520405(0x1ca)]])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;