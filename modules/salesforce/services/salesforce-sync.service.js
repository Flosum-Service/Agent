const a136_0x1c8424=a136_0x1c82;(function(_0x374a9a,_0x49ba06){const _0x3e73a4=a136_0x1c82,_0xb7739c=_0x374a9a();while(!![]){try{const _0x52eb72=-parseInt(_0x3e73a4(0x178))/0x1*(-parseInt(_0x3e73a4(0x182))/0x2)+-parseInt(_0x3e73a4(0x1a4))/0x3+parseInt(_0x3e73a4(0x191))/0x4+parseInt(_0x3e73a4(0x170))/0x5+-parseInt(_0x3e73a4(0x1af))/0x6*(parseInt(_0x3e73a4(0x19c))/0x7)+parseInt(_0x3e73a4(0x1b9))/0x8*(parseInt(_0x3e73a4(0x19f))/0x9)+-parseInt(_0x3e73a4(0x18a))/0xa*(parseInt(_0x3e73a4(0x1a1))/0xb);if(_0x52eb72===_0x49ba06)break;else _0xb7739c['push'](_0xb7739c['shift']());}catch(_0x5152ae){_0xb7739c['push'](_0xb7739c['shift']());}}}(a136_0x197a,0xe9baf));const a136_0x3e8b49=(function(){let _0x35ebc4=!![];return function(_0x5a3bea,_0x423a96){const _0x21ff08=_0x35ebc4?function(){const _0x5ceb42=a136_0x1c82;if(_0x423a96){const _0x550d7e=_0x423a96[_0x5ceb42(0x196)](_0x5a3bea,arguments);return _0x423a96=null,_0x550d7e;}}:function(){};return _0x35ebc4=![],_0x21ff08;};}()),a136_0x2d103a=a136_0x3e8b49(this,function(){const _0x2da0a9=a136_0x1c82;return a136_0x2d103a[_0x2da0a9(0x1a2)]()['search']('(((.+)+)+)+$')[_0x2da0a9(0x1a2)]()[_0x2da0a9(0x1b1)](a136_0x2d103a)[_0x2da0a9(0x17e)](_0x2da0a9(0x1b2));});a136_0x2d103a();function a136_0x1c82(_0x28bf91,_0x2fe1e6){const _0x3c35a9=a136_0x197a();return a136_0x1c82=function(_0x2d103a,_0x3e8b49){_0x2d103a=_0x2d103a-0x170;let _0x197a6f=_0x3c35a9[_0x2d103a];return _0x197a6f;},a136_0x1c82(_0x28bf91,_0x2fe1e6);}'use strict';var __decorate=this&&this[a136_0x1c8424(0x1b5)]||function(_0x128537,_0x498653,_0x4fc8d2,_0x56b339){const _0x2e34c6=a136_0x1c8424;var _0x531425=arguments['length'],_0x300c86=_0x531425<0x3?_0x498653:_0x56b339===null?_0x56b339=Object[_0x2e34c6(0x179)](_0x498653,_0x4fc8d2):_0x56b339,_0x583da3;if(typeof Reflect==='object'&&typeof Reflect[_0x2e34c6(0x18d)]===_0x2e34c6(0x1ab))_0x300c86=Reflect['decorate'](_0x128537,_0x498653,_0x4fc8d2,_0x56b339);else{for(var _0x2c60bb=_0x128537['length']-0x1;_0x2c60bb>=0x0;_0x2c60bb--)if(_0x583da3=_0x128537[_0x2c60bb])_0x300c86=(_0x531425<0x3?_0x583da3(_0x300c86):_0x531425>0x3?_0x583da3(_0x498653,_0x4fc8d2,_0x300c86):_0x583da3(_0x498653,_0x4fc8d2))||_0x300c86;}return _0x531425>0x3&&_0x300c86&&Object[_0x2e34c6(0x189)](_0x498653,_0x4fc8d2,_0x300c86),_0x300c86;},__metadata=this&&this[a136_0x1c8424(0x172)]||function(_0x5d10aa,_0x51cb88){const _0x12bb3e=a136_0x1c8424;if(typeof Reflect==='object'&&typeof Reflect[_0x12bb3e(0x197)]==='function')return Reflect['metadata'](_0x5d10aa,_0x51cb88);};function a136_0x197a(){const _0x298caf=['11DpTBJg','toString','records','1605360XaxLKv','../dto/flosum-repository-sync.dto','SalesforceNotFoundError','SalesforceQueryService','%id%','SalesforceSyncService','FLOSUM_GIT_NAMESPACE','function','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','%parentId%','SYNC_ATTACHMENT_FOR_BRANCH_NAME','2765808IwrzWi','replace','constructor','(((.+)+)+)+$','salesforceQuery','getComponents','__decorate','../../../constants/errors','design:paramtypes','GET_BRANCH_QUERY','16ypOnfO','\x0a\x20\x20\x20\x20\x20\x20','Attachment','push','getRemoteStateAttachmentId','setStatus','\x20not\x20found\x20on\x20salesforce','Repository\x20','getBranchRecord','getBranchComponents','8168375PeClnN','length','__metadata','fromBranchRecord','repositoryId','getAttachmentId','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','getRepositoryRecords','5795BTqBne','getOwnPropertyDescriptor','getComponentsFromRepository','salesforceService','patchObject','Git_Settings__c','search','Branch\x20with\x20Id\x20','fromRepositoryRecord','./salesforce.service','194rwcGoY','objectId','getBranchRecords','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','ERR_INVALID_ATTACHMENT_ID','typedi','Components__r','defineProperty','9637700BOhSma','%name%','getRepositoryRecord','decorate','objectType','createObject','disableSync','6037428TyPODi','updateRemoteState','query','FlosumRepositorySyncDto','map','apply','metadata','GET_BRANCH_BY_NAME_QUERY','catch','getRepositoryRecordByName','encodeBase64','21KLGeyM','stringify','SalesforceService','603027rQUQEz','FLOSUM_NAMESPACE'];a136_0x197a=function(){return _0x298caf;};return a136_0x197a();}Object[a136_0x1c8424(0x189)](exports,'__esModule',{'value':!![]}),exports[a136_0x1c8424(0x1a9)]=void 0x0;const typedi_1=require(a136_0x1c8424(0x187)),constants_1=require('../../../constants'),errors_1=require(a136_0x1c8424(0x1b6)),utils_1=require('../../shared/utils'),flosum_repository_sync_dto_1=require(a136_0x1c8424(0x1a5)),not_found_error_1=require('../errors/not-found.error'),queries_1=require('../queries'),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a136_0x1c8424(0x181));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x14dea6,_0x97bc3e){const _0xe30f91=a136_0x1c8424;this[_0xe30f91(0x1b3)]=_0x14dea6,this[_0xe30f91(0x17b)]=_0x97bc3e;}async[a136_0x1c8424(0x1b4)](_0x294fd0){const _0x480b67=a136_0x1c8424;var _0x12b8ca;const _0xc573b8=await this[_0x480b67(0x1b3)][_0x480b67(0x193)](_0x294fd0),_0x11c2a9=[];for(const _0x3b315f of _0xc573b8){const _0x183d02=(_0x12b8ca=_0x3b315f[constants_1[_0x480b67(0x1a0)]+_0x480b67(0x188)])===null||_0x12b8ca===void 0x0?void 0x0:_0x12b8ca[_0x480b67(0x1a3)];_0x183d02&&_0x183d02[_0x480b67(0x171)]&&_0x11c2a9[_0x480b67(0x1bc)](_0x183d02[0x0]['Id']);}return _0x11c2a9;}async[a136_0x1c8424(0x177)](){const _0x552ed8=a136_0x1c8424,_0x104bc6=await this[_0x552ed8(0x1b3)][_0x552ed8(0x193)](queries_1['GET_WAITING_REPOSITORIES_QUERY']);return _0x104bc6[_0x552ed8(0x195)](_0x537bcc=>flosum_repository_sync_dto_1[_0x552ed8(0x194)][_0x552ed8(0x180)](_0x537bcc));}async[a136_0x1c8424(0x184)](){const _0x24628e=a136_0x1c8424,_0x2d2648=await this[_0x24628e(0x1b3)]['query'](queries_1['GET_WAITING_BRANCHES_QUERY']);return _0x2d2648[_0x24628e(0x195)](_0x29d8cc=>flosum_repository_sync_dto_1[_0x24628e(0x194)][_0x24628e(0x173)](_0x29d8cc));}async[a136_0x1c8424(0x18c)](_0x69de70){const _0x1d2b28=a136_0x1c8424,_0x53a7dd=await this[_0x1d2b28(0x1b3)]['query'](queries_1['GET_REPOSITORY_QUERY'][_0x1d2b28(0x1b0)]('%id%',_0x69de70));if(_0x53a7dd['length']===0x0)throw new not_found_error_1[(_0x1d2b28(0x1a6))]('Repository\x20with\x20Id\x20'+_0x69de70+_0x1d2b28(0x1bf));return flosum_repository_sync_dto_1[_0x1d2b28(0x194)][_0x1d2b28(0x180)](_0x53a7dd[0x0]);}async[a136_0x1c8424(0x1c1)](_0x52751e){const _0x5c7799=a136_0x1c8424,_0x5abcd8=await this[_0x5c7799(0x1b3)][_0x5c7799(0x193)](queries_1[_0x5c7799(0x1b8)][_0x5c7799(0x1b0)](_0x5c7799(0x1a8),_0x52751e));if(_0x5abcd8[_0x5c7799(0x171)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x5c7799(0x17f)+_0x52751e+_0x5c7799(0x1bf));return flosum_repository_sync_dto_1[_0x5c7799(0x194)][_0x5c7799(0x173)](_0x5abcd8[0x0]);}async['getBranchRecordByName'](_0x36cbdc){const _0x1503c9=a136_0x1c8424,_0x586733=await this[_0x1503c9(0x1b3)][_0x1503c9(0x193)](queries_1[_0x1503c9(0x198)][_0x1503c9(0x1b0)](_0x1503c9(0x18b),_0x36cbdc));if(_0x586733[_0x1503c9(0x171)]===0x0)throw new not_found_error_1[(_0x1503c9(0x1a6))]('Branch\x20'+_0x36cbdc+_0x1503c9(0x1bf));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x1503c9(0x173)](_0x586733[0x0]);}async[a136_0x1c8424(0x19a)](_0x3ca4e2){const _0x4bb973=a136_0x1c8424,_0x2f8022=await this[_0x4bb973(0x1b3)][_0x4bb973(0x193)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x4bb973(0x1b0)](_0x4bb973(0x18b),_0x3ca4e2));if(_0x2f8022['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x4bb973(0x1c0)+_0x3ca4e2+_0x4bb973(0x1bf));return flosum_repository_sync_dto_1[_0x4bb973(0x194)][_0x4bb973(0x180)](_0x2f8022[0x0]);}async[a136_0x1c8424(0x17a)](_0x182ab8){const _0x598e8d=a136_0x1c8424,_0x4d35fd=_0x598e8d(0x1ba)+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x182ab8+'\x27';return this[_0x598e8d(0x1b4)](_0x4d35fd);}async[a136_0x1c8424(0x1c2)](_0x54fef1){const _0x1c8eb1=a136_0x1c8424,_0x3f80e0=_0x1c8eb1(0x1ac)+queries_1['GET_COMPONENTS_QUERY']+_0x1c8eb1(0x185)+_0x54fef1+'\x27';return this[_0x1c8eb1(0x1b4)](_0x3f80e0);}async['getAttachmentId'](_0x339c59){const _0x55fd71=a136_0x1c8424;var _0x512797;const _0x2086a2=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x55fd71(0x1b0)](_0x55fd71(0x1ad),_0x339c59[_0x55fd71(0x183)])['replace'](_0x55fd71(0x18b),_0x339c59[_0x55fd71(0x174)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x55fd71(0x1ae)]),_0x296229=await this[_0x55fd71(0x1b3)][_0x55fd71(0x193)](_0x2086a2),_0x356648=(_0x512797=_0x296229[0x0])===null||_0x512797===void 0x0?void 0x0:_0x512797['Id'];if(!_0x356648)throw new Error(errors_1[_0x55fd71(0x186)]);return _0x356648;}async[a136_0x1c8424(0x1bd)](_0x1c5ee0){const _0x17952b=a136_0x1c8424;let _0xc5ba48=await this[_0x17952b(0x175)](_0x1c5ee0)[_0x17952b(0x199)](()=>null);return!_0xc5ba48&&(_0xc5ba48=await this[_0x17952b(0x17b)][_0x17952b(0x18f)](_0x17952b(0x1bb),{'Body':utils_1[_0x17952b(0x19b)]('{}'),'ParentId':_0x1c5ee0['objectId'],'ContentType':'text/plain','Name':_0x1c5ee0['repositoryId']?constants_1[_0x17952b(0x176)]:constants_1[_0x17952b(0x1ae)]})),_0xc5ba48;}async[a136_0x1c8424(0x192)](_0x50ae3b,_0x59dc9a){const _0x1c3d86=a136_0x1c8424,_0x5dfe4f=await this[_0x1c3d86(0x1bd)](_0x50ae3b);await this[_0x1c3d86(0x17b)]['patchObject']('Attachment',_0x5dfe4f,{'Body':utils_1[_0x1c3d86(0x19b)](JSON[_0x1c3d86(0x19d)](_0x59dc9a))});}async[a136_0x1c8424(0x1be)](_0x2f8ecb,_0x2c8c27){const _0x1389df=a136_0x1c8424;await this[_0x1389df(0x17b)]['patchObject'](_0x2f8ecb[_0x1389df(0x18e)],_0x2f8ecb[_0x1389df(0x183)],{[constants_1[_0x1389df(0x1aa)]+'Synchronization_Status__c']:_0x2c8c27});}async[a136_0x1c8424(0x190)](_0x15d8a6){const _0xefcfcf=a136_0x1c8424;await this[_0xefcfcf(0x17b)][_0xefcfcf(0x17c)](constants_1['FLOSUM_GIT_NAMESPACE']+_0xefcfcf(0x17d),_0x15d8a6,{[constants_1[_0xefcfcf(0x1aa)]+'Sync_In_Progress__c']:![]});}};SalesforceSyncService=__decorate([typedi_1['Service'](),__metadata(a136_0x1c8424(0x1b7),[salesforce_query_service_1[a136_0x1c8424(0x1a7)],salesforce_service_1[a136_0x1c8424(0x19e)]])],SalesforceSyncService),exports[a136_0x1c8424(0x1a9)]=SalesforceSyncService;