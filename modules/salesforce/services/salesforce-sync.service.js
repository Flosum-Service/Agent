const a136_0x3a7bcc=a136_0x485d;(function(_0x2d440e,_0xd77a08){const _0x1feec5=a136_0x485d,_0x27bb04=_0x2d440e();while(!![]){try{const _0x22749d=parseInt(_0x1feec5(0xc7))/0x1+parseInt(_0x1feec5(0xa1))/0x2+parseInt(_0x1feec5(0xbd))/0x3+parseInt(_0x1feec5(0x9d))/0x4+-parseInt(_0x1feec5(0x9f))/0x5+parseInt(_0x1feec5(0xc9))/0x6+-parseInt(_0x1feec5(0xe8))/0x7;if(_0x22749d===_0xd77a08)break;else _0x27bb04['push'](_0x27bb04['shift']());}catch(_0x5aa460){_0x27bb04['push'](_0x27bb04['shift']());}}}(a136_0x40cb,0x9d3a3));function a136_0x485d(_0x380641,_0x5d2c3e){const _0x53bf94=a136_0x40cb();return a136_0x485d=function(_0x18808b,_0x4cebe0){_0x18808b=_0x18808b-0x9a;let _0x40cb77=_0x53bf94[_0x18808b];return _0x40cb77;},a136_0x485d(_0x380641,_0x5d2c3e);}const a136_0x4cebe0=(function(){let _0x3b3a70=!![];return function(_0x169229,_0x2aaba1){const _0x2b6159=_0x3b3a70?function(){const _0xa4adfc=a136_0x485d;if(_0x2aaba1){const _0x47bfad=_0x2aaba1[_0xa4adfc(0xc8)](_0x169229,arguments);return _0x2aaba1=null,_0x47bfad;}}:function(){};return _0x3b3a70=![],_0x2b6159;};}()),a136_0x18808b=a136_0x4cebe0(this,function(){const _0x329391=a136_0x485d;return a136_0x18808b[_0x329391(0xa6)]()[_0x329391(0xe9)](_0x329391(0xe1))[_0x329391(0xa6)]()[_0x329391(0xc6)](a136_0x18808b)[_0x329391(0xe9)](_0x329391(0xe1));});a136_0x18808b();'use strict';var __decorate=this&&this[a136_0x3a7bcc(0xcc)]||function(_0x208b5c,_0x42148a,_0x1a344a,_0x1ce12a){const _0x27e87c=a136_0x3a7bcc;var _0x3d56bc=arguments['length'],_0x73f56c=_0x3d56bc<0x3?_0x42148a:_0x1ce12a===null?_0x1ce12a=Object[_0x27e87c(0xc1)](_0x42148a,_0x1a344a):_0x1ce12a,_0x366263;if(typeof Reflect===_0x27e87c(0xb4)&&typeof Reflect[_0x27e87c(0xd5)]===_0x27e87c(0xb2))_0x73f56c=Reflect[_0x27e87c(0xd5)](_0x208b5c,_0x42148a,_0x1a344a,_0x1ce12a);else{for(var _0x26f2a5=_0x208b5c[_0x27e87c(0xc5)]-0x1;_0x26f2a5>=0x0;_0x26f2a5--)if(_0x366263=_0x208b5c[_0x26f2a5])_0x73f56c=(_0x3d56bc<0x3?_0x366263(_0x73f56c):_0x3d56bc>0x3?_0x366263(_0x42148a,_0x1a344a,_0x73f56c):_0x366263(_0x42148a,_0x1a344a))||_0x73f56c;}return _0x3d56bc>0x3&&_0x73f56c&&Object[_0x27e87c(0xbc)](_0x42148a,_0x1a344a,_0x73f56c),_0x73f56c;},__metadata=this&&this[a136_0x3a7bcc(0xee)]||function(_0x2f5e8c,_0x967590){const _0x232387=a136_0x3a7bcc;if(typeof Reflect===_0x232387(0xb4)&&typeof Reflect['metadata']===_0x232387(0xb2))return Reflect['metadata'](_0x2f5e8c,_0x967590);};Object[a136_0x3a7bcc(0xbc)](exports,a136_0x3a7bcc(0xaf),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a136_0x3a7bcc(0xb3)),constants_1=require(a136_0x3a7bcc(0xc2)),errors_1=require('../../../constants/errors'),utils_1=require('../../shared/utils'),flosum_repository_sync_dto_1=require(a136_0x3a7bcc(0xc0)),not_found_error_1=require(a136_0x3a7bcc(0xcf)),queries_1=require(a136_0x3a7bcc(0x9c)),salesforce_query_service_1=require(a136_0x3a7bcc(0xd2)),salesforce_service_1=require(a136_0x3a7bcc(0xd0));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x2cc8d9,_0x200604){const _0x46e929=a136_0x3a7bcc;this[_0x46e929(0xe0)]=_0x2cc8d9,this[_0x46e929(0xaa)]=_0x200604;}async[a136_0x3a7bcc(0xcb)](_0x4d58f4){const _0x4252e2=a136_0x3a7bcc;var _0x3f2492;const _0x424b54=await this[_0x4252e2(0xe0)][_0x4252e2(0x9a)](_0x4d58f4),_0x20b8aa=[];for(const _0x48c8e5 of _0x424b54){const _0x354edd=(_0x3f2492=_0x48c8e5[constants_1['FLOSUM_NAMESPACE']+'Components__r'])===null||_0x3f2492===void 0x0?void 0x0:_0x3f2492[_0x4252e2(0xae)];_0x354edd&&_0x354edd[_0x4252e2(0xc5)]&&_0x20b8aa[_0x4252e2(0xdd)](_0x354edd[0x0]['Id']);}return _0x20b8aa;}async[a136_0x3a7bcc(0xce)](){const _0x4b06ab=a136_0x3a7bcc,_0x29f69b=await this[_0x4b06ab(0xe0)][_0x4b06ab(0x9a)](queries_1[_0x4b06ab(0xd1)]);return _0x29f69b[_0x4b06ab(0xa4)](_0x4a876c=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4b06ab(0xb6)](_0x4a876c));}async[a136_0x3a7bcc(0xbb)](){const _0x14fced=a136_0x3a7bcc,_0x3c933a=await this['salesforceQuery'][_0x14fced(0x9a)](queries_1[_0x14fced(0xd3)]);return _0x3c933a['map'](_0x3d58af=>flosum_repository_sync_dto_1[_0x14fced(0xb8)][_0x14fced(0xdc)](_0x3d58af));}async[a136_0x3a7bcc(0xd7)](_0x4f610d){const _0x5e0ce7=a136_0x3a7bcc,_0x3cdefb=await this['salesforceQuery']['query'](queries_1[_0x5e0ce7(0xc4)][_0x5e0ce7(0xda)]('%id%',_0x4f610d));if(_0x3cdefb['length']===0x0)throw new not_found_error_1[(_0x5e0ce7(0xe4))](_0x5e0ce7(0xbe)+_0x4f610d+_0x5e0ce7(0xab));return flosum_repository_sync_dto_1[_0x5e0ce7(0xb8)][_0x5e0ce7(0xb6)](_0x3cdefb[0x0]);}async[a136_0x3a7bcc(0xb7)](_0x35b7a2){const _0x52095a=a136_0x3a7bcc,_0x50ea19=await this[_0x52095a(0xe0)][_0x52095a(0x9a)](queries_1[_0x52095a(0xe6)][_0x52095a(0xda)](_0x52095a(0xad),_0x35b7a2));if(_0x50ea19[_0x52095a(0xc5)]===0x0)throw new not_found_error_1[(_0x52095a(0xe4))]('Branch\x20with\x20Id\x20'+_0x35b7a2+_0x52095a(0xab));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x52095a(0xdc)](_0x50ea19[0x0]);}async[a136_0x3a7bcc(0xb5)](_0x17a2b5){const _0x2d7625=a136_0x3a7bcc,_0x30d6c2=await this[_0x2d7625(0xe0)]['query'](queries_1[_0x2d7625(0xd9)]['replace']('%name%',_0x17a2b5));if(_0x30d6c2[_0x2d7625(0xc5)]===0x0)throw new not_found_error_1[(_0x2d7625(0xe4))](_0x2d7625(0xa9)+_0x17a2b5+_0x2d7625(0xab));return flosum_repository_sync_dto_1[_0x2d7625(0xb8)][_0x2d7625(0xdc)](_0x30d6c2[0x0]);}async[a136_0x3a7bcc(0xac)](_0x3a4731){const _0x45834e=a136_0x3a7bcc,_0x131bc8=await this[_0x45834e(0xe0)]['query'](queries_1[_0x45834e(0xd4)][_0x45834e(0xda)]('%name%',_0x3a4731));if(_0x131bc8[_0x45834e(0xc5)]===0x0)throw new not_found_error_1[(_0x45834e(0xe4))](_0x45834e(0x9b)+_0x3a4731+_0x45834e(0xab));return flosum_repository_sync_dto_1[_0x45834e(0xb8)][_0x45834e(0xb6)](_0x131bc8[0x0]);}async[a136_0x3a7bcc(0xba)](_0x387882){const _0x503f4f=a136_0x3a7bcc,_0x1fd019=_0x503f4f(0xe2)+queries_1['GET_COMPONENTS_QUERY']+_0x503f4f(0xde)+_0x387882+'\x27';return this[_0x503f4f(0xcb)](_0x1fd019);}async[a136_0x3a7bcc(0xea)](_0x4a0b32){const _0x3b9b66=a136_0x3a7bcc,_0xb53e64='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x3b9b66(0xe7)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x4a0b32+'\x27';return this[_0x3b9b66(0xcb)](_0xb53e64);}async[a136_0x3a7bcc(0xa0)](_0xe9eca0){const _0x1e2760=a136_0x3a7bcc;var _0x3ef579;const _0x5ece39=queries_1[_0x1e2760(0xed)][_0x1e2760(0xda)](_0x1e2760(0xb1),_0xe9eca0[_0x1e2760(0xb0)])[_0x1e2760(0xda)]('%name%',_0xe9eca0[_0x1e2760(0xa2)]?constants_1[_0x1e2760(0xeb)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x5f3e4e=await this[_0x1e2760(0xe0)][_0x1e2760(0x9a)](_0x5ece39),_0x238662=(_0x3ef579=_0x5f3e4e[0x0])===null||_0x3ef579===void 0x0?void 0x0:_0x3ef579['Id'];if(!_0x238662)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x238662;}async[a136_0x3a7bcc(0xe5)](_0x1faf1b){const _0x5d94ce=a136_0x3a7bcc;let _0x2f69f1=await this['getAttachmentId'](_0x1faf1b)[_0x5d94ce(0xb9)](()=>null);return!_0x2f69f1&&(_0x2f69f1=await this['salesforceService'][_0x5d94ce(0xa7)](_0x5d94ce(0xcd),{'Body':utils_1[_0x5d94ce(0xdf)]('{}'),'ParentId':_0x1faf1b[_0x5d94ce(0xb0)],'ContentType':_0x5d94ce(0xa3),'Name':_0x1faf1b[_0x5d94ce(0xa2)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x5d94ce(0xf0)]})),_0x2f69f1;}async['updateRemoteState'](_0x47a4f3,_0x52d8aa){const _0x1eae57=a136_0x3a7bcc,_0x517c70=await this['getRemoteStateAttachmentId'](_0x47a4f3);await this[_0x1eae57(0xaa)][_0x1eae57(0xc3)]('Attachment',_0x517c70,{'Body':utils_1[_0x1eae57(0xdf)](JSON['stringify'](_0x52d8aa))});}async[a136_0x3a7bcc(0xec)](_0xa62e60,_0x292665){const _0x670147=a136_0x3a7bcc;await this[_0x670147(0xaa)]['patchObject'](_0xa62e60[_0x670147(0xef)],_0xa62e60[_0x670147(0xb0)],{[constants_1[_0x670147(0xbf)]+_0x670147(0xdb)]:_0x292665});}async[a136_0x3a7bcc(0x9e)](_0x1fa7db){const _0x3a74a1=a136_0x3a7bcc;await this[_0x3a74a1(0xaa)][_0x3a74a1(0xc3)](constants_1[_0x3a74a1(0xbf)]+_0x3a74a1(0xe3),_0x1fa7db,{[constants_1[_0x3a74a1(0xbf)]+_0x3a74a1(0xca)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a136_0x3a7bcc(0xd8)](),__metadata(a136_0x3a7bcc(0xa8),[salesforce_query_service_1[a136_0x3a7bcc(0xf1)],salesforce_service_1[a136_0x3a7bcc(0xd6)]])],SalesforceSyncService),exports[a136_0x3a7bcc(0xa5)]=SalesforceSyncService;function a136_0x40cb(){const _0x184550=['Sync_In_Progress__c','getComponents','__decorate','Attachment','getRepositoryRecords','../errors/not-found.error','./salesforce.service','GET_WAITING_REPOSITORIES_QUERY','./salesforce-query.service','GET_WAITING_BRANCHES_QUERY','GET_REPOSITORY_BY_NAME_QUERY','decorate','SalesforceService','getRepositoryRecord','Service','GET_BRANCH_BY_NAME_QUERY','replace','Synchronization_Status__c','fromBranchRecord','push','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','encodeBase64','salesforceQuery','(((.+)+)+)+$','\x0a\x20\x20\x20\x20\x20\x20','Git_Settings__c','SalesforceNotFoundError','getRemoteStateAttachmentId','GET_BRANCH_QUERY','GET_COMPONENTS_QUERY','11658528ZYYXLO','search','getBranchComponents','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','setStatus','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','__metadata','objectType','SYNC_ATTACHMENT_FOR_BRANCH_NAME','SalesforceQueryService','query','Repository\x20','../queries','5123272viNVcv','disableSync','2808145icTSLQ','getAttachmentId','574428YBzKYV','repositoryId','text/plain','map','SalesforceSyncService','toString','createObject','design:paramtypes','Branch\x20','salesforceService','\x20not\x20found\x20on\x20salesforce','getRepositoryRecordByName','%id%','records','__esModule','objectId','%parentId%','function','typedi','object','getBranchRecordByName','fromRepositoryRecord','getBranchRecord','FlosumRepositorySyncDto','catch','getComponentsFromRepository','getBranchRecords','defineProperty','1906422TBjmAQ','Repository\x20with\x20Id\x20','FLOSUM_GIT_NAMESPACE','../dto/flosum-repository-sync.dto','getOwnPropertyDescriptor','../../../constants','patchObject','GET_REPOSITORY_QUERY','length','constructor','42492RkrLYs','apply','3750828MavHwc'];a136_0x40cb=function(){return _0x184550;};return a136_0x40cb();}