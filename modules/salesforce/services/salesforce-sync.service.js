const a136_0x3c1d4e=a136_0x4789;function a136_0x4789(_0x4569bc,_0x159372){const _0x1ceba5=a136_0x3dd8();return a136_0x4789=function(_0x4dd565,_0x2ac150){_0x4dd565=_0x4dd565-0xcf;let _0x3dd8e6=_0x1ceba5[_0x4dd565];return _0x3dd8e6;},a136_0x4789(_0x4569bc,_0x159372);}(function(_0x8da60f,_0x3259a9){const _0x100c83=a136_0x4789,_0x182950=_0x8da60f();while(!![]){try{const _0x2a5362=parseInt(_0x100c83(0x105))/0x1*(parseInt(_0x100c83(0x121))/0x2)+-parseInt(_0x100c83(0xe1))/0x3+-parseInt(_0x100c83(0xe6))/0x4+parseInt(_0x100c83(0x11c))/0x5+parseInt(_0x100c83(0x114))/0x6+-parseInt(_0x100c83(0xf5))/0x7+-parseInt(_0x100c83(0xd3))/0x8*(-parseInt(_0x100c83(0xd7))/0x9);if(_0x2a5362===_0x3259a9)break;else _0x182950['push'](_0x182950['shift']());}catch(_0x38c2fe){_0x182950['push'](_0x182950['shift']());}}}(a136_0x3dd8,0x935d8));const a136_0x2ac150=(function(){let _0xb25c4e=!![];return function(_0x17a921,_0x487723){const _0x2ed6f8=_0xb25c4e?function(){const _0x2c6eb3=a136_0x4789;if(_0x487723){const _0x49d814=_0x487723[_0x2c6eb3(0xdb)](_0x17a921,arguments);return _0x487723=null,_0x49d814;}}:function(){};return _0xb25c4e=![],_0x2ed6f8;};}()),a136_0x4dd565=a136_0x2ac150(this,function(){const _0x372961=a136_0x4789;return a136_0x4dd565[_0x372961(0x10c)]()['search']('(((.+)+)+)+$')[_0x372961(0x10c)]()[_0x372961(0x112)](a136_0x4dd565)[_0x372961(0xcf)](_0x372961(0xe5));});a136_0x4dd565();'use strict';var __decorate=this&&this[a136_0x3c1d4e(0x124)]||function(_0x530414,_0x43308d,_0x1c68ab,_0x4bde5a){const _0x4ff2f8=a136_0x3c1d4e;var _0x384239=arguments['length'],_0x1b157c=_0x384239<0x3?_0x43308d:_0x4bde5a===null?_0x4bde5a=Object['getOwnPropertyDescriptor'](_0x43308d,_0x1c68ab):_0x4bde5a,_0x338223;if(typeof Reflect===_0x4ff2f8(0xd2)&&typeof Reflect[_0x4ff2f8(0x10d)]===_0x4ff2f8(0xdd))_0x1b157c=Reflect[_0x4ff2f8(0x10d)](_0x530414,_0x43308d,_0x1c68ab,_0x4bde5a);else{for(var _0xf99382=_0x530414[_0x4ff2f8(0x103)]-0x1;_0xf99382>=0x0;_0xf99382--)if(_0x338223=_0x530414[_0xf99382])_0x1b157c=(_0x384239<0x3?_0x338223(_0x1b157c):_0x384239>0x3?_0x338223(_0x43308d,_0x1c68ab,_0x1b157c):_0x338223(_0x43308d,_0x1c68ab))||_0x1b157c;}return _0x384239>0x3&&_0x1b157c&&Object[_0x4ff2f8(0xe3)](_0x43308d,_0x1c68ab,_0x1b157c),_0x1b157c;},__metadata=this&&this[a136_0x3c1d4e(0xed)]||function(_0x403c20,_0xb82f6d){const _0xcb582=a136_0x3c1d4e;if(typeof Reflect===_0xcb582(0xd2)&&typeof Reflect[_0xcb582(0x11f)]===_0xcb582(0xdd))return Reflect['metadata'](_0x403c20,_0xb82f6d);};function a136_0x3dd8(){const _0x2ebff3=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20','../queries','updateRemoteState','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','typedi','./salesforce-query.service','salesforceService','query','length','patchObject','1039895kjZzWj','Branch\x20with\x20Id\x20','getBranchRecordByName','GET_WAITING_REPOSITORIES_QUERY','__esModule','setStatus','SalesforceSyncService','toString','decorate','salesforceQuery','Synchronization_Status__c','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','SalesforceQueryService','constructor','%id%','294564WLOUMc','Components__r','encodeBase64','%parentId%','../../../constants','SalesforceNotFoundError','objectId','Repository\x20','302245PccgJM','%name%','design:paramtypes','metadata','getComponents','2SfcehL','Branch\x20','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','__decorate','../../shared/utils','getBranchRecords','GET_WAITING_BRANCHES_QUERY','GET_COMPONENTS_QUERY','search','getRemoteStateAttachmentId','Sync_In_Progress__c','object','8CGHliS','objectType','../../../constants/errors','../dto/flosum-repository-sync.dto','21628881HiWiam','GET_BRANCH_BY_NAME_QUERY','Git_Settings__c','Repository\x20with\x20Id\x20','apply','getBranchComponents','function','SalesforceService','FlosumRepositorySyncDto','fromRepositoryRecord','3014895CYzTgV','SYNC_ATTACHMENT_FOR_BRANCH_NAME','defineProperty','catch','(((.+)+)+)+$','4758344nsjDAl','disableSync','\x0a\x20\x20\x20\x20\x20\x20','getBranchRecord','Attachment','repositoryId','replace','__metadata','ERR_INVALID_ATTACHMENT_ID','./salesforce.service','records','getRepositoryRecord','FLOSUM_GIT_NAMESPACE','getAttachmentId','\x20not\x20found\x20on\x20salesforce','5281416EPnYuQ','getRepositoryRecordByName','GET_REPOSITORY_QUERY','fromBranchRecord','push','map'];a136_0x3dd8=function(){return _0x2ebff3;};return a136_0x3dd8();}Object['defineProperty'](exports,a136_0x3c1d4e(0x109),{'value':!![]}),exports[a136_0x3c1d4e(0x10b)]=void 0x0;const typedi_1=require(a136_0x3c1d4e(0xff)),constants_1=require(a136_0x3c1d4e(0x118)),errors_1=require(a136_0x3c1d4e(0xd5)),utils_1=require(a136_0x3c1d4e(0x125)),flosum_repository_sync_dto_1=require(a136_0x3c1d4e(0xd6)),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a136_0x3c1d4e(0xfc)),salesforce_query_service_1=require(a136_0x3c1d4e(0x100)),salesforce_service_1=require(a136_0x3c1d4e(0xef));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x43272d,_0x40e94b){const _0x2af8ac=a136_0x3c1d4e;this[_0x2af8ac(0x10e)]=_0x43272d,this[_0x2af8ac(0x101)]=_0x40e94b;}async[a136_0x3c1d4e(0x120)](_0x1e8e35){const _0x3df891=a136_0x3c1d4e;var _0x4a147b;const _0x298679=await this[_0x3df891(0x10e)][_0x3df891(0x102)](_0x1e8e35),_0x42cc15=[];for(const _0xa4416e of _0x298679){const _0x314dd1=(_0x4a147b=_0xa4416e[constants_1['FLOSUM_NAMESPACE']+_0x3df891(0x115)])===null||_0x4a147b===void 0x0?void 0x0:_0x4a147b[_0x3df891(0xf0)];_0x314dd1&&_0x314dd1[_0x3df891(0x103)]&&_0x42cc15[_0x3df891(0xf9)](_0x314dd1[0x0]['Id']);}return _0x42cc15;}async['getRepositoryRecords'](){const _0x1047df=a136_0x3c1d4e,_0x3954f2=await this[_0x1047df(0x10e)][_0x1047df(0x102)](queries_1[_0x1047df(0x108)]);return _0x3954f2[_0x1047df(0xfa)](_0x205432=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x1047df(0xe0)](_0x205432));}async[a136_0x3c1d4e(0x126)](){const _0x47c7eb=a136_0x3c1d4e,_0x9bcd5b=await this['salesforceQuery'][_0x47c7eb(0x102)](queries_1[_0x47c7eb(0x127)]);return _0x9bcd5b[_0x47c7eb(0xfa)](_0xd51ba8=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x47c7eb(0xf8)](_0xd51ba8));}async[a136_0x3c1d4e(0xf1)](_0x5497c0){const _0x29cf26=a136_0x3c1d4e,_0x159d29=await this[_0x29cf26(0x10e)][_0x29cf26(0x102)](queries_1[_0x29cf26(0xf7)][_0x29cf26(0xec)](_0x29cf26(0x113),_0x5497c0));if(_0x159d29[_0x29cf26(0x103)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x29cf26(0xda)+_0x5497c0+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x29cf26(0xdf)]['fromRepositoryRecord'](_0x159d29[0x0]);}async[a136_0x3c1d4e(0xe9)](_0x33a05c){const _0x31ca4a=a136_0x3c1d4e,_0xffc6f=await this[_0x31ca4a(0x10e)]['query'](queries_1['GET_BRANCH_QUERY'][_0x31ca4a(0xec)](_0x31ca4a(0x113),_0x33a05c));if(_0xffc6f[_0x31ca4a(0x103)]===0x0)throw new not_found_error_1[(_0x31ca4a(0x119))](_0x31ca4a(0x106)+_0x33a05c+_0x31ca4a(0xf4));return flosum_repository_sync_dto_1[_0x31ca4a(0xdf)][_0x31ca4a(0xf8)](_0xffc6f[0x0]);}async[a136_0x3c1d4e(0x107)](_0xb7354c){const _0x3b5b86=a136_0x3c1d4e,_0x156dd6=await this[_0x3b5b86(0x10e)][_0x3b5b86(0x102)](queries_1[_0x3b5b86(0xd8)][_0x3b5b86(0xec)](_0x3b5b86(0x11d),_0xb7354c));if(_0x156dd6[_0x3b5b86(0x103)]===0x0)throw new not_found_error_1[(_0x3b5b86(0x119))](_0x3b5b86(0x122)+_0xb7354c+_0x3b5b86(0xf4));return flosum_repository_sync_dto_1[_0x3b5b86(0xdf)][_0x3b5b86(0xf8)](_0x156dd6[0x0]);}async[a136_0x3c1d4e(0xf6)](_0x233b2d){const _0x1268c3=a136_0x3c1d4e,_0x143800=await this[_0x1268c3(0x10e)][_0x1268c3(0x102)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x1268c3(0xec)]('%name%',_0x233b2d));if(_0x143800[_0x1268c3(0x103)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x1268c3(0x11b)+_0x233b2d+_0x1268c3(0xf4));return flosum_repository_sync_dto_1[_0x1268c3(0xdf)][_0x1268c3(0xe0)](_0x143800[0x0]);}async['getComponentsFromRepository'](_0x386d6c){const _0x6411cd=a136_0x3c1d4e,_0x38da63=_0x6411cd(0xe8)+queries_1[_0x6411cd(0x128)]+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x386d6c+'\x27';return this[_0x6411cd(0x120)](_0x38da63);}async[a136_0x3c1d4e(0xdc)](_0x35bf98){const _0x107c82=a136_0x3c1d4e,_0x416f35=_0x107c82(0xfb)+queries_1['GET_COMPONENTS_QUERY']+_0x107c82(0xfe)+_0x35bf98+'\x27';return this[_0x107c82(0x120)](_0x416f35);}async['getAttachmentId'](_0x28083f){const _0x3a8610=a136_0x3c1d4e;var _0x37d6d8;const _0x581d5a=queries_1[_0x3a8610(0x123)]['replace'](_0x3a8610(0x117),_0x28083f[_0x3a8610(0x11a)])['replace'](_0x3a8610(0x11d),_0x28083f[_0x3a8610(0xeb)]?constants_1[_0x3a8610(0x110)]:constants_1[_0x3a8610(0xe2)]),_0x3f20cb=await this[_0x3a8610(0x10e)][_0x3a8610(0x102)](_0x581d5a),_0x19775a=(_0x37d6d8=_0x3f20cb[0x0])===null||_0x37d6d8===void 0x0?void 0x0:_0x37d6d8['Id'];if(!_0x19775a)throw new Error(errors_1[_0x3a8610(0xee)]);return _0x19775a;}async[a136_0x3c1d4e(0xd0)](_0x461346){const _0x212824=a136_0x3c1d4e;let _0x5106dd=await this[_0x212824(0xf3)](_0x461346)[_0x212824(0xe4)](()=>null);return!_0x5106dd&&(_0x5106dd=await this[_0x212824(0x101)]['createObject'](_0x212824(0xea),{'Body':utils_1[_0x212824(0x116)]('{}'),'ParentId':_0x461346[_0x212824(0x11a)],'ContentType':'text/plain','Name':_0x461346[_0x212824(0xeb)]?constants_1[_0x212824(0x110)]:constants_1[_0x212824(0xe2)]})),_0x5106dd;}async[a136_0x3c1d4e(0xfd)](_0x3dcf85,_0x1cf3bb){const _0x2f9c81=a136_0x3c1d4e,_0x149ce6=await this[_0x2f9c81(0xd0)](_0x3dcf85);await this['salesforceService'][_0x2f9c81(0x104)]('Attachment',_0x149ce6,{'Body':utils_1['encodeBase64'](JSON['stringify'](_0x1cf3bb))});}async[a136_0x3c1d4e(0x10a)](_0x5b9215,_0x18265e){const _0x1121b5=a136_0x3c1d4e;await this[_0x1121b5(0x101)][_0x1121b5(0x104)](_0x5b9215[_0x1121b5(0xd4)],_0x5b9215[_0x1121b5(0x11a)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x1121b5(0x10f)]:_0x18265e});}async[a136_0x3c1d4e(0xe7)](_0x5c9642){const _0x61bb01=a136_0x3c1d4e;await this[_0x61bb01(0x101)][_0x61bb01(0x104)](constants_1['FLOSUM_GIT_NAMESPACE']+_0x61bb01(0xd9),_0x5c9642,{[constants_1[_0x61bb01(0xf2)]+_0x61bb01(0xd1)]:![]});}};SalesforceSyncService=__decorate([typedi_1['Service'](),__metadata(a136_0x3c1d4e(0x11e),[salesforce_query_service_1[a136_0x3c1d4e(0x111)],salesforce_service_1[a136_0x3c1d4e(0xde)]])],SalesforceSyncService),exports[a136_0x3c1d4e(0x10b)]=SalesforceSyncService;