const a127_0x570185=a127_0x5134;function a127_0x5886(){const _0x2c81d4=['ContentType','find','prepareComponentRecord','componentsToDelete','10798048zvoUqI','fetchCommitManifestsByComponentIds','insert','__esModule','../utils/composite.utils','createDeleteRequest','1291308dJBAGa','search','prepareComponentAttachmentRecord','Repository','keys','createPatchRequest','map','getProceededComponentsMeta','repositoryId','Is_From_Agent__c','componentId','file','../utils/flosum-naming.utils','Source__c','componentType','./salesforce-git-sync.service','4436860RHiTat','Branch__c','Branch','FLOSUM_COMMIT_MANIFEST','Component_History__c','(((.+)+)+)+$','toISOString','componentName','Last_Updated_By__c','Component_Name__c','typedi','name','update','default','Last_Modified_Date__c','body','FLOSUM_NAMESPACE','FLOSUM_COMPONENT_HISTORY','files','version','crc','FLOSUM_ATTACHMENT','gitSync','.id}','../../../core','SalesforceError','logger','request','Component__c','ParentId','reference','createPostRequest','../../parsers/utils/zip','../../../constants','Component_Type__c','username','RecordTypeId','application/zip','Commit__c','2389982VvmqKe','CRC32__c','delete','Committed_On__c','base64','../errors/salesforce.error','filePath','FLOSUM_COMPONENT','Version__c','proceededComponentsMeta','Changed_On__c','__importDefault','prepareCommitManifest','File_Name__c','constructor','createZip','1610648tnnyTL','Could\x20not\x20proceed\x20component\x20','489ERAMpF',']\x20-\x20meta\x20not\x20found','recordTypes','get','type','Deletion_By_Agent__c','Last_Modified_By__c','275791DWEVLg','extractFieldsFromRecord','SalesforceComponentsManager','prepareComponentHistoryRecord','42IGNXvy','push','proceedComponentMeta','branchId','Body'];a127_0x5886=function(){return _0x2c81d4;};return a127_0x5886();}(function(_0x14953d,_0x2edb20){const _0x3d587d=a127_0x5134,_0x5bcddf=_0x14953d();while(!![]){try{const _0x248863=-parseInt(_0x3d587d(0x20c))/0x1+-parseInt(_0x3d587d(0x1ad))/0x2*(parseInt(_0x3d587d(0x205))/0x3)+parseInt(_0x3d587d(0x203))/0x4+-parseInt(_0x3d587d(0x1cc))/0x5+parseInt(_0x3d587d(0x1bc))/0x6+-parseInt(_0x3d587d(0x1f3))/0x7+parseInt(_0x3d587d(0x1b6))/0x8;if(_0x248863===_0x2edb20)break;else _0x5bcddf['push'](_0x5bcddf['shift']());}catch(_0x3eed50){_0x5bcddf['push'](_0x5bcddf['shift']());}}}(a127_0x5886,0x70368));const a127_0x1bdeb6=(function(){let _0xffdb31=!![];return function(_0x59582e,_0x3dcd9c){const _0x52d6f4=_0xffdb31?function(){if(_0x3dcd9c){const _0x158455=_0x3dcd9c['apply'](_0x59582e,arguments);return _0x3dcd9c=null,_0x158455;}}:function(){};return _0xffdb31=![],_0x52d6f4;};}()),a127_0x27c4d5=a127_0x1bdeb6(this,function(){const _0x21e93c=a127_0x5134;return a127_0x27c4d5['toString']()[_0x21e93c(0x1bd)](_0x21e93c(0x1d1))['toString']()[_0x21e93c(0x201)](a127_0x27c4d5)[_0x21e93c(0x1bd)](_0x21e93c(0x1d1));});a127_0x27c4d5();'use strict';var __importDefault=this&&this[a127_0x570185(0x1fe)]||function(_0x119784){const _0x543aa5=a127_0x570185;return _0x119784&&_0x119784[_0x543aa5(0x1b9)]?_0x119784:{'default':_0x119784};};Object['defineProperty'](exports,a127_0x570185(0x1b9),{'value':!![]}),exports[a127_0x570185(0x1ab)]=void 0x0;const constants_1=require(a127_0x570185(0x1ed)),core_1=require(a127_0x570185(0x1e4)),zip_1=require(a127_0x570185(0x1ec)),typedi_1=__importDefault(require(a127_0x570185(0x1d6))),salesforce_error_1=require(a127_0x570185(0x1f8)),composite_utils_1=require(a127_0x570185(0x1ba)),flosum_naming_utils_1=require(a127_0x570185(0x1c8)),salesforce_git_sync_service_1=require(a127_0x570185(0x1cb));class SalesforceComponentsManager{constructor(_0x531c3f,_0x3fd885,_0x32dce9,_0x20ea83,_0x7cae53){const _0x27505a=a127_0x570185;this[_0x27505a(0x1c4)]=_0x531c3f,this[_0x27505a(0x1b0)]=_0x3fd885,this[_0x27505a(0x1ef)]=_0x32dce9,this[_0x27505a(0x207)]=_0x20ea83,this[_0x27505a(0x1fc)]=_0x7cae53,this[_0x27505a(0x1e6)]=new core_1['Logger'](SalesforceComponentsManager[_0x27505a(0x1d7)]),this['gitSync']=typedi_1[_0x27505a(0x1d9)][_0x27505a(0x208)](salesforce_git_sync_service_1['SalesforceGitSyncService']);}[a127_0x570185(0x1af)](_0x4c3c64,_0x2d9d75){const _0x30eeff=a127_0x570185,_0x11eac9=flosum_naming_utils_1[_0x30eeff(0x1aa)](_0x4c3c64,['Component_Type__c',_0x30eeff(0x1d5),_0x30eeff(0x1fb)]);this['proceededComponentsMeta'][_0x30eeff(0x1ae)]({'componentId':'','reference':_0x2d9d75,'version':_0x11eac9[_0x30eeff(0x1fb)],'componentName':_0x11eac9[_0x30eeff(0x1d5)],'componentType':_0x11eac9[_0x30eeff(0x1ee)]});}['prepareCommitManifest'](_0x2f8d7d,_0x42c2d0){const _0x5ac758=a127_0x570185,{request:_0x1fcc5c}=composite_utils_1[_0x5ac758(0x1eb)](constants_1[_0x5ac758(0x1cf)],{[constants_1[_0x5ac758(0x1dc)]+_0x5ac758(0x1f2)]:_0x2f8d7d,[constants_1[_0x5ac758(0x1dc)]+_0x5ac758(0x1d0)]:_0x42c2d0});return _0x1fcc5c;}async[a127_0x570185(0x1be)](_0x5af5a1,_0x436f62){const _0x11e8fc=a127_0x570185,_0x2fe179={},_0x4827b7=zip_1['Zip'][_0x11e8fc(0x202)]();for(const _0xd5f9c6 of Object[_0x11e8fc(0x1c0)](_0x5af5a1[_0x11e8fc(0x1de)])){_0x4827b7[_0x11e8fc(0x1c7)](_0xd5f9c6,_0x5af5a1['files'][_0xd5f9c6],{'createFolders':!![]});}return _0x2fe179[_0x11e8fc(0x1b2)]=_0x11e8fc(0x1f1),_0x2fe179['Name']=_0x5af5a1[_0x11e8fc(0x209)],_0x2fe179['Description']=_0x5af5a1[_0x11e8fc(0x209)],_0x2fe179[_0x11e8fc(0x1e9)]=_0x436f62,_0x2fe179[_0x11e8fc(0x1b1)]=await _0x4827b7['generateAsync']({'type':_0x11e8fc(0x1f7),'compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x2fe179;}[a127_0x570185(0x1ac)](_0x4806d6,_0x3de8d7,_0x2b1d47){const _0x43f745=a127_0x570185,_0x3410de=new Date()[_0x43f745(0x1d2)](),_0xdbdcf5={};return _0xdbdcf5[constants_1[_0x43f745(0x1dc)]+_0x43f745(0x1e8)]=_0x3de8d7,_0xdbdcf5[constants_1[_0x43f745(0x1dc)]+_0x43f745(0x1f4)]=_0x4806d6[_0x43f745(0x1e0)],_0xdbdcf5[constants_1[_0x43f745(0x1dc)]+_0x43f745(0x1fd)]=_0x3410de,_0xdbdcf5[constants_1[_0x43f745(0x1dc)]+'Changed_By__c']=this['username'],_0xdbdcf5[constants_1['FLOSUM_NAMESPACE']+'Version__c']=_0x2b1d47?_0x2b1d47+0x1:0x1,_0xdbdcf5[constants_1['FLOSUM_GIT_NAMESPACE']+_0x43f745(0x1c5)]=!![],_0xdbdcf5;}[a127_0x570185(0x1b4)](_0x326dad,_0x4dbe2b){const _0x58352b=a127_0x570185;var _0x24ab05,_0x3908ae;const _0x223f1f=new Date()[_0x58352b(0x1d2)](),_0x5424ef={};return!_0x4dbe2b?(this[_0x58352b(0x1b0)]?(_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x1cd)]=this[_0x58352b(0x1b0)],_0x5424ef[constants_1['FLOSUM_NAMESPACE']+_0x58352b(0x1c9)]=_0x58352b(0x1ce),_0x5424ef[_0x58352b(0x1f0)]=(_0x24ab05=this[_0x58352b(0x207)]['find'](_0x135be6=>_0x135be6[_0x58352b(0x1d7)]===_0x58352b(0x1ce)))===null||_0x24ab05===void 0x0?void 0x0:_0x24ab05['id']):(_0x5424ef[constants_1[_0x58352b(0x1dc)]+'Repository__c']=this[_0x58352b(0x1c4)],_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x1c9)]=_0x58352b(0x1bf),_0x5424ef[_0x58352b(0x1f0)]=(_0x3908ae=this[_0x58352b(0x207)][_0x58352b(0x1b3)](_0x11fe46=>_0x11fe46['name']==='Repository'))===null||_0x3908ae===void 0x0?void 0x0:_0x3908ae['id']),_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x1fb)]=0x1):_0x5424ef[constants_1['FLOSUM_NAMESPACE']+_0x58352b(0x1fb)]=_0x4dbe2b[_0x58352b(0x1df)]+0x1,_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x1ee)]=_0x326dad[_0x58352b(0x209)],_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x1d5)]=_0x326dad[_0x58352b(0x1d7)],_0x5424ef[constants_1['FLOSUM_NAMESPACE']+_0x58352b(0x200)]=_0x326dad[_0x58352b(0x1f9)],_0x5424ef[constants_1['FLOSUM_NAMESPACE']+_0x58352b(0x1d4)]=this[_0x58352b(0x1ef)],_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x20b)]=this[_0x58352b(0x1ef)],_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x1da)]=_0x223f1f,_0x5424ef[constants_1[_0x58352b(0x1dc)]+_0x58352b(0x1f6)]=_0x223f1f,_0x5424ef[constants_1['FLOSUM_NAMESPACE']+_0x58352b(0x1f4)]=_0x326dad['crc'],_0x5424ef;}[a127_0x570185(0x1c3)](){const _0x343104=a127_0x570185;return this[_0x343104(0x1fc)];}async[a127_0x570185(0x1b8)](_0x2abfad,_0x258f42){const _0x37ee21=a127_0x570185,_0x511c21=[];for(const _0x13cdd3 of _0x2abfad){const _0x27d31b=composite_utils_1[_0x37ee21(0x1eb)](constants_1[_0x37ee21(0x1fa)],this[_0x37ee21(0x1b4)](_0x13cdd3)),_0x47297b=composite_utils_1[_0x37ee21(0x1eb)](constants_1['FLOSUM_COMPONENT_HISTORY'],this['prepareComponentHistoryRecord'](_0x13cdd3,'@{'+_0x27d31b['reference']+_0x37ee21(0x1e3))),_0x42acbc=composite_utils_1[_0x37ee21(0x1eb)](constants_1[_0x37ee21(0x1e1)],await this[_0x37ee21(0x1be)](_0x13cdd3,'@{'+_0x47297b['reference']+_0x37ee21(0x1e3)));this[_0x37ee21(0x1af)](_0x27d31b['request'][_0x37ee21(0x1db)],_0x27d31b[_0x37ee21(0x1ea)]),_0x511c21[_0x37ee21(0x1ae)](_0x27d31b[_0x37ee21(0x1e7)],_0x47297b[_0x37ee21(0x1e7)],_0x42acbc[_0x37ee21(0x1e7)]),_0x258f42&&_0x511c21[_0x37ee21(0x1ae)](this[_0x37ee21(0x1ff)](_0x258f42,'@{'+_0x47297b[_0x37ee21(0x1ea)]+_0x37ee21(0x1e3)));}return _0x511c21;}async[a127_0x570185(0x1d8)](_0x3a1ddb,_0x428e71=''){const _0x3a6068=a127_0x570185,_0xed14a5=[];for(const {component:_0x30c071,meta:_0x3a3ca1}of _0x3a1ddb){if(!_0x3a3ca1['id']){const _0x5b6e88=this[_0x3a6068(0x1fc)][_0x3a6068(0x1b3)](_0x26e0c2=>_0x26e0c2[_0x3a6068(0x1d3)]===_0x30c071[_0x3a6068(0x1d7)]&&_0x26e0c2[_0x3a6068(0x1ca)]===_0x30c071[_0x3a6068(0x209)]);if(!_0x5b6e88)throw new salesforce_error_1[(_0x3a6068(0x1e5))](new Error(_0x3a6068(0x204)+_0x30c071[_0x3a6068(0x1d7)]+'\x20['+_0x30c071['type']+_0x3a6068(0x206)));_0x3a3ca1['id']=_0x5b6e88['componentId'];}const _0x53eca9=composite_utils_1[_0x3a6068(0x1c1)](constants_1[_0x3a6068(0x1fa)],_0x3a3ca1['id'],this[_0x3a6068(0x1b4)](_0x30c071,_0x3a3ca1)),_0xf1397e=composite_utils_1[_0x3a6068(0x1eb)](constants_1[_0x3a6068(0x1dd)],this['prepareComponentHistoryRecord'](_0x30c071,_0x3a3ca1['id'],_0x3a3ca1[_0x3a6068(0x1df)])),_0x244929=composite_utils_1['createPostRequest'](constants_1[_0x3a6068(0x1e1)],await this[_0x3a6068(0x1be)](_0x30c071,'@{'+_0xf1397e[_0x3a6068(0x1ea)]+_0x3a6068(0x1e3)));this[_0x3a6068(0x1af)](_0x53eca9[_0x3a6068(0x1e7)][_0x3a6068(0x1db)],_0x53eca9['reference']),_0xed14a5[_0x3a6068(0x1ae)](_0x53eca9[_0x3a6068(0x1e7)],_0xf1397e[_0x3a6068(0x1e7)],_0x244929[_0x3a6068(0x1e7)]),_0x428e71&&_0xed14a5[_0x3a6068(0x1ae)](this[_0x3a6068(0x1ff)](_0x428e71,'@{'+_0xf1397e[_0x3a6068(0x1ea)]+'.id}'));}return _0xed14a5;}async[a127_0x570185(0x1f5)](_0x583dca,_0x461a7b=![]){const _0xdd597f=a127_0x570185,_0x4a3e47={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x1b6dbd=[];for(const _0x398cb2 of _0x583dca){if(_0x398cb2['id'])_0x1b6dbd['push'](_0x398cb2['id']);else{const _0x1a9796=this[_0xdd597f(0x1fc)][_0xdd597f(0x1b3)](_0x56f7c9=>_0x56f7c9[_0xdd597f(0x1d3)]===_0x398cb2[_0xdd597f(0x1d7)]&&_0x56f7c9[_0xdd597f(0x1ca)]===_0x398cb2[_0xdd597f(0x209)]);if(!_0x1a9796||!_0x1a9796['componentId'])continue;_0x1b6dbd['push'](_0x1a9796[_0xdd597f(0x1c6)]);}}if(_0x461a7b){const _0x38f40a=await this[_0xdd597f(0x1e2)][_0xdd597f(0x1b7)](_0x1b6dbd);_0x4a3e47['manifests']=_0x38f40a[_0xdd597f(0x1c2)](_0x26c5df=>composite_utils_1[_0xdd597f(0x1bb)](constants_1[_0xdd597f(0x1cf)],_0x26c5df)['request']);}return _0x4a3e47['componentsToUpdate']=_0x1b6dbd[_0xdd597f(0x1c2)](_0x2e6e7f=>composite_utils_1['createPatchRequest'](constants_1[_0xdd597f(0x1fa)],_0x2e6e7f,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0xdd597f(0x20a)]:!![]})[_0xdd597f(0x1e7)]),_0x4a3e47[_0xdd597f(0x1b5)]=_0x1b6dbd['map'](_0x20988c=>composite_utils_1[_0xdd597f(0x1bb)](constants_1[_0xdd597f(0x1fa)],_0x20988c)[_0xdd597f(0x1e7)]),_0x4a3e47;}}function a127_0x5134(_0x255c5e,_0x4d864e){const _0x244c5e=a127_0x5886();return a127_0x5134=function(_0x27c4d5,_0x1bdeb6){_0x27c4d5=_0x27c4d5-0x1aa;let _0x5886ba=_0x244c5e[_0x27c4d5];return _0x5886ba;},a127_0x5134(_0x255c5e,_0x4d864e);}exports[a127_0x570185(0x1ab)]=SalesforceComponentsManager;