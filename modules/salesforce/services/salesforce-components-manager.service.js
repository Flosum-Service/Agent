const a128_0x45b94e=a128_0x3dd2;(function(_0xb1c5a0,_0x2bb176){const _0x5af5b5=a128_0x3dd2,_0xccc318=_0xb1c5a0();while(!![]){try{const _0x4b333b=-parseInt(_0x5af5b5(0x164))/0x1+parseInt(_0x5af5b5(0x1c7))/0x2*(parseInt(_0x5af5b5(0x195))/0x3)+-parseInt(_0x5af5b5(0x19f))/0x4*(parseInt(_0x5af5b5(0x181))/0x5)+parseInt(_0x5af5b5(0x1c8))/0x6*(parseInt(_0x5af5b5(0x1a4))/0x7)+parseInt(_0x5af5b5(0x196))/0x8*(-parseInt(_0x5af5b5(0x16b))/0x9)+-parseInt(_0x5af5b5(0x178))/0xa*(parseInt(_0x5af5b5(0x1b2))/0xb)+parseInt(_0x5af5b5(0x192))/0xc*(parseInt(_0x5af5b5(0x1d1))/0xd);if(_0x4b333b===_0x2bb176)break;else _0xccc318['push'](_0xccc318['shift']());}catch(_0x2598e5){_0xccc318['push'](_0xccc318['shift']());}}}(a128_0xa2ab,0xb4324));function a128_0xa2ab(){const _0x496573=[']\x20-\x20meta\x20not\x20found','FLOSUM_ATTACHMENT','crc','componentName','Is_From_Agent__c','10vBvUlD','generateAsync','__importDefault','FLOSUM_COMMIT_MANIFEST','FLOSUM_NAMESPACE','constructor','filePath','SalesforceError','keys','92935GOwTlk','prepareComponentRecord','insert','createZip','repositoryId','createPostRequest','ParentId','find','prepareCommitManifest','apply','version','.id}','default','proceededComponentsMeta','reference','Source__c','prepareComponentAttachmentRecord','9480zZmumK','toString','Body','3729537bjThjb','549664enmFPb','search','Version__c','manifests','createDeleteRequest','Last_Modified_By__c','update','(((.+)+)+)+$','SalesforceComponentsManager','8xPvcct','push','gitSync','createPatchRequest','logger','3985618JtdSHN','Component__c','Commit__c','proceedComponentMeta','Branch','FLOSUM_GIT_NAMESPACE','ContentType','CRC32__c','Logger','Committed_On__c','extractFieldsFromRecord','username','application/zip','typedi','4159430swCwnq','Repository','base64','SalesforceGitSyncService','../utils/flosum-naming.utils','name','../errors/salesforce.error','prepareComponentHistoryRecord','Changed_By__c','Component_History__c','toISOString','Could\x20not\x20proceed\x20component\x20','getProceededComponentsMeta','../utils/composite.utils','request','fetchCommitManifestsByComponentIds','branchId','Last_Updated_By__c','Repository__c','map','File_Name__c','2ZcxxEJ','6UlWCiW','__esModule','FLOSUM_COMPONENT_HISTORY','files','componentId','body','../../../core','file','componentType','2899qZtgPr','697919hTtVYy','../../../constants','get','Zip','Description','type','Component_Name__c','18kRLGmv','Component_Type__c','Name','RecordTypeId','recordTypes','Changed_On__c','Last_Modified_Date__c','FLOSUM_COMPONENT'];a128_0xa2ab=function(){return _0x496573;};return a128_0xa2ab();}const a128_0x2f635d=(function(){let _0x5f0bef=!![];return function(_0x4e2859,_0x49e6ac){const _0x3fa116=_0x5f0bef?function(){const _0xc89464=a128_0x3dd2;if(_0x49e6ac){const _0x32d55f=_0x49e6ac[_0xc89464(0x18a)](_0x4e2859,arguments);return _0x49e6ac=null,_0x32d55f;}}:function(){};return _0x5f0bef=![],_0x3fa116;};}()),a128_0x1925cc=a128_0x2f635d(this,function(){const _0x2d484b=a128_0x3dd2;return a128_0x1925cc[_0x2d484b(0x193)]()[_0x2d484b(0x197)]('(((.+)+)+)+$')[_0x2d484b(0x193)]()[_0x2d484b(0x17d)](a128_0x1925cc)['search'](_0x2d484b(0x19d));});a128_0x1925cc();function a128_0x3dd2(_0x8afe6c,_0x322e18){const _0x10469a=a128_0xa2ab();return a128_0x3dd2=function(_0x1925cc,_0x2f635d){_0x1925cc=_0x1925cc-0x164;let _0xa2abed=_0x10469a[_0x1925cc];return _0xa2abed;},a128_0x3dd2(_0x8afe6c,_0x322e18);}'use strict';var __importDefault=this&&this[a128_0x45b94e(0x17a)]||function(_0x3067a3){const _0x4c9c70=a128_0x45b94e;return _0x3067a3&&_0x3067a3[_0x4c9c70(0x1c9)]?_0x3067a3:{'default':_0x3067a3};};Object['defineProperty'](exports,a128_0x45b94e(0x1c9),{'value':!![]}),exports[a128_0x45b94e(0x19e)]=void 0x0;const constants_1=require(a128_0x45b94e(0x165)),core_1=require(a128_0x45b94e(0x1ce)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require(a128_0x45b94e(0x1b1))),salesforce_error_1=require(a128_0x45b94e(0x1b8)),composite_utils_1=require(a128_0x45b94e(0x1bf)),flosum_naming_utils_1=require(a128_0x45b94e(0x1b6)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceComponentsManager{constructor(_0x32180a,_0x36f16e,_0xd2fe5c,_0x471122,_0x5541e9){const _0x2a7adc=a128_0x45b94e;this['repositoryId']=_0x32180a,this[_0x2a7adc(0x1c2)]=_0x36f16e,this[_0x2a7adc(0x1af)]=_0xd2fe5c,this[_0x2a7adc(0x16f)]=_0x471122,this[_0x2a7adc(0x18e)]=_0x5541e9,this[_0x2a7adc(0x1a3)]=new core_1[(_0x2a7adc(0x1ac))](SalesforceComponentsManager['name']),this['gitSync']=typedi_1[_0x2a7adc(0x18d)][_0x2a7adc(0x166)](salesforce_git_sync_service_1[_0x2a7adc(0x1b5)]);}[a128_0x45b94e(0x1a7)](_0x2f48ba,_0xb51594){const _0x42303a=a128_0x45b94e,_0x47ce2e=flosum_naming_utils_1[_0x42303a(0x1ae)](_0x2f48ba,[_0x42303a(0x16c),_0x42303a(0x16a),_0x42303a(0x198)]);this[_0x42303a(0x18e)][_0x42303a(0x1a0)]({'componentId':'','reference':_0xb51594,'version':_0x47ce2e[_0x42303a(0x198)],'componentName':_0x47ce2e[_0x42303a(0x16a)],'componentType':_0x47ce2e['Component_Type__c']});}['prepareCommitManifest'](_0x49799d,_0x269be2){const _0xf25db0=a128_0x45b94e,{request:_0x1a1963}=composite_utils_1[_0xf25db0(0x186)](constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1[_0xf25db0(0x17c)]+_0xf25db0(0x1a6)]:_0x49799d,[constants_1[_0xf25db0(0x17c)]+_0xf25db0(0x1bb)]:_0x269be2});return _0x1a1963;}async[a128_0x45b94e(0x191)](_0x3037e9,_0xa6bdd3){const _0x2c6915=a128_0x45b94e,_0x36a623={},_0x30dec3=zip_1[_0x2c6915(0x167)][_0x2c6915(0x184)]();for(const _0x4dbd36 of Object[_0x2c6915(0x180)](_0x3037e9[_0x2c6915(0x1cb)])){_0x30dec3[_0x2c6915(0x1cf)](_0x4dbd36,_0x3037e9[_0x2c6915(0x1cb)][_0x4dbd36],{'createFolders':!![]});}return _0x36a623[_0x2c6915(0x1aa)]=_0x2c6915(0x1b0),_0x36a623[_0x2c6915(0x16d)]=_0x3037e9[_0x2c6915(0x169)],_0x36a623[_0x2c6915(0x168)]=_0x3037e9[_0x2c6915(0x169)],_0x36a623[_0x2c6915(0x187)]=_0xa6bdd3,_0x36a623[_0x2c6915(0x194)]=await _0x30dec3[_0x2c6915(0x179)]({'type':_0x2c6915(0x1b4),'compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x36a623;}[a128_0x45b94e(0x1b9)](_0x412296,_0x4da862,_0x4f423c){const _0xabb5=a128_0x45b94e,_0x11f0d6=new Date()[_0xabb5(0x1bc)](),_0x36a96d={};return _0x36a96d[constants_1['FLOSUM_NAMESPACE']+_0xabb5(0x1a5)]=_0x4da862,_0x36a96d[constants_1[_0xabb5(0x17c)]+_0xabb5(0x1ab)]=_0x412296[_0xabb5(0x175)],_0x36a96d[constants_1[_0xabb5(0x17c)]+_0xabb5(0x170)]=_0x11f0d6,_0x36a96d[constants_1[_0xabb5(0x17c)]+_0xabb5(0x1ba)]=this[_0xabb5(0x1af)],_0x36a96d[constants_1[_0xabb5(0x17c)]+_0xabb5(0x198)]=_0x4f423c?_0x4f423c+0x1:0x1,_0x36a96d[constants_1[_0xabb5(0x1a9)]+_0xabb5(0x177)]=!![],_0x36a96d;}[a128_0x45b94e(0x182)](_0x35859f,_0x492208){const _0xf3a0fe=a128_0x45b94e;var _0x4daec7,_0x5da258;const _0x1aa1c3=new Date()['toISOString'](),_0x18fd33={};return!_0x492208?(this['branchId']?(_0x18fd33[constants_1['FLOSUM_NAMESPACE']+'Branch__c']=this[_0xf3a0fe(0x1c2)],_0x18fd33[constants_1['FLOSUM_NAMESPACE']+_0xf3a0fe(0x190)]=_0xf3a0fe(0x1a8),_0x18fd33[_0xf3a0fe(0x16e)]=(_0x4daec7=this[_0xf3a0fe(0x16f)]['find'](_0x357ce3=>_0x357ce3[_0xf3a0fe(0x1b7)]==='Branch'))===null||_0x4daec7===void 0x0?void 0x0:_0x4daec7['id']):(_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+_0xf3a0fe(0x1c4)]=this[_0xf3a0fe(0x185)],_0x18fd33[constants_1['FLOSUM_NAMESPACE']+_0xf3a0fe(0x190)]=_0xf3a0fe(0x1b3),_0x18fd33[_0xf3a0fe(0x16e)]=(_0x5da258=this[_0xf3a0fe(0x16f)][_0xf3a0fe(0x188)](_0x35df41=>_0x35df41[_0xf3a0fe(0x1b7)]===_0xf3a0fe(0x1b3)))===null||_0x5da258===void 0x0?void 0x0:_0x5da258['id']),_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+_0xf3a0fe(0x198)]=0x1):_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+_0xf3a0fe(0x198)]=_0x492208[_0xf3a0fe(0x18b)]+0x1,_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+_0xf3a0fe(0x16c)]=_0x35859f['type'],_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+_0xf3a0fe(0x16a)]=_0x35859f[_0xf3a0fe(0x1b7)],_0x18fd33[constants_1['FLOSUM_NAMESPACE']+_0xf3a0fe(0x1c6)]=_0x35859f[_0xf3a0fe(0x17e)],_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+_0xf3a0fe(0x1c3)]=this[_0xf3a0fe(0x1af)],_0x18fd33[constants_1['FLOSUM_NAMESPACE']+_0xf3a0fe(0x19b)]=this[_0xf3a0fe(0x1af)],_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+_0xf3a0fe(0x171)]=_0x1aa1c3,_0x18fd33[constants_1['FLOSUM_NAMESPACE']+_0xf3a0fe(0x1ad)]=_0x1aa1c3,_0x18fd33[constants_1[_0xf3a0fe(0x17c)]+'CRC32__c']=_0x35859f['crc'],_0x18fd33;}[a128_0x45b94e(0x1be)](){const _0xe280a2=a128_0x45b94e;return this[_0xe280a2(0x18e)];}async[a128_0x45b94e(0x183)](_0xfaf411,_0x261894){const _0x1ff655=a128_0x45b94e,_0x48d9ee=[];for(const _0x2f9beb of _0xfaf411){const _0x39ad36=composite_utils_1['createPostRequest'](constants_1[_0x1ff655(0x172)],this['prepareComponentRecord'](_0x2f9beb)),_0x12a4b5=composite_utils_1[_0x1ff655(0x186)](constants_1[_0x1ff655(0x1ca)],this[_0x1ff655(0x1b9)](_0x2f9beb,'@{'+_0x39ad36[_0x1ff655(0x18f)]+_0x1ff655(0x18c))),_0x415989=composite_utils_1[_0x1ff655(0x186)](constants_1[_0x1ff655(0x174)],await this[_0x1ff655(0x191)](_0x2f9beb,'@{'+_0x12a4b5[_0x1ff655(0x18f)]+_0x1ff655(0x18c)));this['proceedComponentMeta'](_0x39ad36[_0x1ff655(0x1c0)][_0x1ff655(0x1cd)],_0x39ad36[_0x1ff655(0x18f)]),_0x48d9ee[_0x1ff655(0x1a0)](_0x39ad36[_0x1ff655(0x1c0)],_0x12a4b5['request'],_0x415989[_0x1ff655(0x1c0)]),_0x261894&&_0x48d9ee[_0x1ff655(0x1a0)](this[_0x1ff655(0x189)](_0x261894,'@{'+_0x12a4b5[_0x1ff655(0x18f)]+_0x1ff655(0x18c)));}return _0x48d9ee;}async[a128_0x45b94e(0x19c)](_0x672804,_0x5ee123=''){const _0x200c68=a128_0x45b94e,_0x328445=[];for(const {component:_0x17c86c,meta:_0x42a974}of _0x672804){if(!_0x42a974['id']){const _0x5d5c97=this[_0x200c68(0x18e)]['find'](_0x3cbce4=>_0x3cbce4[_0x200c68(0x176)]===_0x17c86c[_0x200c68(0x1b7)]&&_0x3cbce4[_0x200c68(0x1d0)]===_0x17c86c[_0x200c68(0x169)]);if(!_0x5d5c97)throw new salesforce_error_1[(_0x200c68(0x17f))](new Error(_0x200c68(0x1bd)+_0x17c86c[_0x200c68(0x1b7)]+'\x20['+_0x17c86c['type']+_0x200c68(0x173)));_0x42a974['id']=_0x5d5c97[_0x200c68(0x1cc)];}const _0x58f96b=composite_utils_1[_0x200c68(0x1a2)](constants_1[_0x200c68(0x172)],_0x42a974['id'],this[_0x200c68(0x182)](_0x17c86c,_0x42a974)),_0x137a47=composite_utils_1[_0x200c68(0x186)](constants_1[_0x200c68(0x1ca)],this[_0x200c68(0x1b9)](_0x17c86c,_0x42a974['id'],_0x42a974[_0x200c68(0x18b)])),_0x1ea75a=composite_utils_1[_0x200c68(0x186)](constants_1['FLOSUM_ATTACHMENT'],await this['prepareComponentAttachmentRecord'](_0x17c86c,'@{'+_0x137a47['reference']+'.id}'));this['proceedComponentMeta'](_0x58f96b[_0x200c68(0x1c0)][_0x200c68(0x1cd)],_0x58f96b['reference']),_0x328445[_0x200c68(0x1a0)](_0x58f96b['request'],_0x137a47[_0x200c68(0x1c0)],_0x1ea75a[_0x200c68(0x1c0)]),_0x5ee123&&_0x328445[_0x200c68(0x1a0)](this[_0x200c68(0x189)](_0x5ee123,'@{'+_0x137a47[_0x200c68(0x18f)]+_0x200c68(0x18c)));}return _0x328445;}async['delete'](_0x5968bc,_0x4c3f03=![]){const _0x35518d=a128_0x45b94e,_0x49c7bd={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x264727=[];for(const _0x53aa69 of _0x5968bc){if(_0x53aa69['id'])_0x264727[_0x35518d(0x1a0)](_0x53aa69['id']);else{const _0x31481a=this[_0x35518d(0x18e)][_0x35518d(0x188)](_0x8616a=>_0x8616a[_0x35518d(0x176)]===_0x53aa69[_0x35518d(0x1b7)]&&_0x8616a['componentType']===_0x53aa69[_0x35518d(0x169)]);if(!_0x31481a||!_0x31481a[_0x35518d(0x1cc)])continue;_0x264727[_0x35518d(0x1a0)](_0x31481a['componentId']);}}if(_0x4c3f03){const _0xca320f=await this[_0x35518d(0x1a1)][_0x35518d(0x1c1)](_0x264727);_0x49c7bd[_0x35518d(0x199)]=_0xca320f[_0x35518d(0x1c5)](_0x1add1e=>composite_utils_1['createDeleteRequest'](constants_1[_0x35518d(0x17b)],_0x1add1e)['request']);}return _0x49c7bd['componentsToUpdate']=_0x264727[_0x35518d(0x1c5)](_0x4bb07a=>composite_utils_1['createPatchRequest'](constants_1['FLOSUM_COMPONENT'],_0x4bb07a,{[constants_1[_0x35518d(0x1a9)]+'Deletion_By_Agent__c']:!![]})[_0x35518d(0x1c0)]),_0x49c7bd['componentsToDelete']=_0x264727[_0x35518d(0x1c5)](_0x5bf8da=>composite_utils_1[_0x35518d(0x19a)](constants_1[_0x35518d(0x172)],_0x5bf8da)[_0x35518d(0x1c0)]),_0x49c7bd;}}exports[a128_0x45b94e(0x19e)]=SalesforceComponentsManager;