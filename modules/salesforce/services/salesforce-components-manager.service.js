const a128_0x3b3875=a128_0x471f;(function(_0x543586,_0x1d1a95){const _0x27b782=a128_0x471f,_0x447be4=_0x543586();while(!![]){try{const _0x1ba3a3=parseInt(_0x27b782(0xf4))/0x1+-parseInt(_0x27b782(0xb2))/0x2+parseInt(_0x27b782(0xd3))/0x3+parseInt(_0x27b782(0xb8))/0x4*(-parseInt(_0x27b782(0xdc))/0x5)+parseInt(_0x27b782(0xcf))/0x6+parseInt(_0x27b782(0xda))/0x7*(-parseInt(_0x27b782(0xc4))/0x8)+-parseInt(_0x27b782(0xe0))/0x9;if(_0x1ba3a3===_0x1d1a95)break;else _0x447be4['push'](_0x447be4['shift']());}catch(_0x137562){_0x447be4['push'](_0x447be4['shift']());}}}(a128_0x48db,0x2a52b));const a128_0x540cc5=(function(){let _0x48e842=!![];return function(_0x286623,_0x5b8cd4){const _0x4bb40d=_0x48e842?function(){const _0x3fb9b2=a128_0x471f;if(_0x5b8cd4){const _0x37afbe=_0x5b8cd4[_0x3fb9b2(0xb0)](_0x286623,arguments);return _0x5b8cd4=null,_0x37afbe;}}:function(){};return _0x48e842=![],_0x4bb40d;};}()),a128_0x1e981d=a128_0x540cc5(this,function(){const _0x4dd200=a128_0x471f;return a128_0x1e981d[_0x4dd200(0xe8)]()['search'](_0x4dd200(0xd9))['toString']()[_0x4dd200(0xa9)](a128_0x1e981d)[_0x4dd200(0xa4)]('(((.+)+)+)+$');});a128_0x1e981d();'use strict';function a128_0x48db(){const _0x229537=['apply','componentsToDelete','324656kbvrmk','logger','Source__c','type','../../../core','componentsToUpdate','3544UQTadZ','Component_Type__c',']\x20-\x20meta\x20not\x20found','recordTypes','Logger','update','files','Component_Name__c','get','branchId','crc','Last_Updated_By__c','1587064oRBcQV','Committed_On__c','request','proceededComponentsMeta','__esModule','Last_Modified_By__c','body','reference','prepareComponentRecord','SalesforceError','FLOSUM_COMPONENT','1239528ltAlVo','Zip','FLOSUM_ATTACHMENT','createPatchRequest','956550hLhfNL','generateAsync','Changed_By__c','manifests','CRC32__c','repositoryId','(((.+)+)+)+$','7BKOlvb','prepareComponentHistoryRecord','45tVGTFF','fetchCommitManifestsByComponentIds','Last_Modified_Date__c','Repository__c','2405700AKtYIC','Body','typedi','../errors/salesforce.error','createPostRequest','getProceededComponentsMeta','__importDefault','keys','toString','createDeleteRequest','push','version','Branch__c','.id}','Version__c','../../../constants','../../parsers/utils/zip','default','Could\x20not\x20proceed\x20component\x20','proceedComponentMeta','283902qbYvrl','FLOSUM_NAMESPACE','map','prepareCommitManifest','FLOSUM_COMPONENT_HISTORY','FLOSUM_GIT_NAMESPACE','ParentId','prepareComponentAttachmentRecord','componentId','SalesforceComponentsManager','../utils/flosum-naming.utils','delete','username','application/zip','./salesforce-git-sync.service','RecordTypeId','File_Name__c','defineProperty','insert','Deletion_By_Agent__c','name','ContentType','search','find','extractFieldsFromRecord','Changed_On__c','Repository','constructor','../utils/composite.utils','base64','Component__c','Branch','FLOSUM_COMMIT_MANIFEST','SalesforceGitSyncService'];a128_0x48db=function(){return _0x229537;};return a128_0x48db();}function a128_0x471f(_0x58b4b2,_0x149ab7){const _0x48dbdb=a128_0x48db();return a128_0x471f=function(_0x1e981d,_0x540cc5){_0x1e981d=_0x1e981d-0x92;let _0x48dba4=_0x48dbdb[_0x1e981d];return _0x48dba4;},a128_0x471f(_0x58b4b2,_0x149ab7);}var __importDefault=this&&this[a128_0x3b3875(0xe6)]||function(_0x3a0daf){return _0x3a0daf&&_0x3a0daf['__esModule']?_0x3a0daf:{'default':_0x3a0daf};};Object[a128_0x3b3875(0x9f)](exports,a128_0x3b3875(0xc8),{'value':!![]}),exports[a128_0x3b3875(0x97)]=void 0x0;const constants_1=require(a128_0x3b3875(0xef)),core_1=require(a128_0x3b3875(0xb6)),zip_1=require(a128_0x3b3875(0xf0)),typedi_1=__importDefault(require(a128_0x3b3875(0xe2))),salesforce_error_1=require(a128_0x3b3875(0xe3)),composite_utils_1=require(a128_0x3b3875(0xaa)),flosum_naming_utils_1=require(a128_0x3b3875(0x98)),salesforce_git_sync_service_1=require(a128_0x3b3875(0x9c));class SalesforceComponentsManager{constructor(_0xcc5d83,_0x532e8a,_0x5613ef,_0x5213d5,_0x35a493){const _0x5114af=a128_0x3b3875;this[_0x5114af(0xd8)]=_0xcc5d83,this[_0x5114af(0xc1)]=_0x532e8a,this[_0x5114af(0x9a)]=_0x5613ef,this[_0x5114af(0xbb)]=_0x5213d5,this['proceededComponentsMeta']=_0x35a493,this[_0x5114af(0xb3)]=new core_1[(_0x5114af(0xbc))](SalesforceComponentsManager[_0x5114af(0xa2)]),this['gitSync']=typedi_1[_0x5114af(0xf1)][_0x5114af(0xc0)](salesforce_git_sync_service_1[_0x5114af(0xaf)]);}['proceedComponentMeta'](_0x3eeb93,_0x4d429e){const _0x274662=a128_0x3b3875,_0x1e522c=flosum_naming_utils_1[_0x274662(0xa6)](_0x3eeb93,[_0x274662(0xb9),_0x274662(0xbf),_0x274662(0xee)]);this[_0x274662(0xc7)][_0x274662(0xea)]({'componentId':'','reference':_0x4d429e,'version':_0x1e522c[_0x274662(0xee)],'componentName':_0x1e522c[_0x274662(0xbf)],'componentType':_0x1e522c[_0x274662(0xb9)]});}[a128_0x3b3875(0xf7)](_0x538b4,_0x2c0101){const _0x202509=a128_0x3b3875,{request:_0x1d882b}=composite_utils_1[_0x202509(0xe4)](constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1[_0x202509(0xf5)]+'Commit__c']:_0x538b4,[constants_1['FLOSUM_NAMESPACE']+'Component_History__c']:_0x2c0101});return _0x1d882b;}async[a128_0x3b3875(0x95)](_0x3ca66f,_0x3d73dc){const _0x3db04b=a128_0x3b3875,_0x49024b={},_0x284201=zip_1[_0x3db04b(0xd0)]['createZip']();for(const _0x3ce0e5 of Object[_0x3db04b(0xe7)](_0x3ca66f[_0x3db04b(0xbe)])){_0x284201['file'](_0x3ce0e5,_0x3ca66f['files'][_0x3ce0e5],{'createFolders':!![]});}return _0x49024b[_0x3db04b(0xa3)]=_0x3db04b(0x9b),_0x49024b['Name']=_0x3ca66f[_0x3db04b(0xb5)],_0x49024b['Description']=_0x3ca66f[_0x3db04b(0xb5)],_0x49024b[_0x3db04b(0x94)]=_0x3d73dc,_0x49024b[_0x3db04b(0xe1)]=await _0x284201[_0x3db04b(0xd4)]({'type':_0x3db04b(0xab),'compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x49024b;}[a128_0x3b3875(0xdb)](_0x4dfbe3,_0x4e8f5f,_0x9c4dc6){const _0x20f42b=a128_0x3b3875,_0x313502=new Date()['toISOString'](),_0x555099={};return _0x555099[constants_1[_0x20f42b(0xf5)]+_0x20f42b(0xac)]=_0x4e8f5f,_0x555099[constants_1[_0x20f42b(0xf5)]+_0x20f42b(0xd7)]=_0x4dfbe3[_0x20f42b(0xc2)],_0x555099[constants_1['FLOSUM_NAMESPACE']+_0x20f42b(0xa7)]=_0x313502,_0x555099[constants_1[_0x20f42b(0xf5)]+_0x20f42b(0xd5)]=this[_0x20f42b(0x9a)],_0x555099[constants_1[_0x20f42b(0xf5)]+_0x20f42b(0xee)]=_0x9c4dc6?_0x9c4dc6+0x1:0x1,_0x555099[constants_1[_0x20f42b(0x93)]+'Is_From_Agent__c']=!![],_0x555099;}[a128_0x3b3875(0xcc)](_0x43f83a,_0x6613f8){const _0x3858fc=a128_0x3b3875;var _0x48eaab,_0x34f850;const _0x38b81a=new Date()['toISOString'](),_0x17046d={};return!_0x6613f8?(this[_0x3858fc(0xc1)]?(_0x17046d[constants_1['FLOSUM_NAMESPACE']+_0x3858fc(0xec)]=this[_0x3858fc(0xc1)],_0x17046d[constants_1[_0x3858fc(0xf5)]+_0x3858fc(0xb4)]=_0x3858fc(0xad),_0x17046d[_0x3858fc(0x9d)]=(_0x48eaab=this[_0x3858fc(0xbb)]['find'](_0x4e1714=>_0x4e1714[_0x3858fc(0xa2)]===_0x3858fc(0xad)))===null||_0x48eaab===void 0x0?void 0x0:_0x48eaab['id']):(_0x17046d[constants_1['FLOSUM_NAMESPACE']+_0x3858fc(0xdf)]=this[_0x3858fc(0xd8)],_0x17046d[constants_1['FLOSUM_NAMESPACE']+_0x3858fc(0xb4)]=_0x3858fc(0xa8),_0x17046d[_0x3858fc(0x9d)]=(_0x34f850=this[_0x3858fc(0xbb)]['find'](_0x44cc01=>_0x44cc01['name']==='Repository'))===null||_0x34f850===void 0x0?void 0x0:_0x34f850['id']),_0x17046d[constants_1[_0x3858fc(0xf5)]+'Version__c']=0x1):_0x17046d[constants_1[_0x3858fc(0xf5)]+_0x3858fc(0xee)]=_0x6613f8[_0x3858fc(0xeb)]+0x1,_0x17046d[constants_1['FLOSUM_NAMESPACE']+_0x3858fc(0xb9)]=_0x43f83a[_0x3858fc(0xb5)],_0x17046d[constants_1[_0x3858fc(0xf5)]+'Component_Name__c']=_0x43f83a[_0x3858fc(0xa2)],_0x17046d[constants_1['FLOSUM_NAMESPACE']+_0x3858fc(0x9e)]=_0x43f83a['filePath'],_0x17046d[constants_1[_0x3858fc(0xf5)]+_0x3858fc(0xc3)]=this[_0x3858fc(0x9a)],_0x17046d[constants_1[_0x3858fc(0xf5)]+_0x3858fc(0xc9)]=this[_0x3858fc(0x9a)],_0x17046d[constants_1[_0x3858fc(0xf5)]+_0x3858fc(0xde)]=_0x38b81a,_0x17046d[constants_1['FLOSUM_NAMESPACE']+_0x3858fc(0xc5)]=_0x38b81a,_0x17046d[constants_1['FLOSUM_NAMESPACE']+'CRC32__c']=_0x43f83a[_0x3858fc(0xc2)],_0x17046d;}[a128_0x3b3875(0xe5)](){const _0x2dfeb6=a128_0x3b3875;return this[_0x2dfeb6(0xc7)];}async[a128_0x3b3875(0xa0)](_0x57c802,_0x1a3283){const _0x30398a=a128_0x3b3875,_0x12b4cd=[];for(const _0x7039f7 of _0x57c802){const _0x1f4314=composite_utils_1[_0x30398a(0xe4)](constants_1['FLOSUM_COMPONENT'],this[_0x30398a(0xcc)](_0x7039f7)),_0x5bada6=composite_utils_1[_0x30398a(0xe4)](constants_1[_0x30398a(0x92)],this[_0x30398a(0xdb)](_0x7039f7,'@{'+_0x1f4314[_0x30398a(0xcb)]+_0x30398a(0xed))),_0x5a7d57=composite_utils_1[_0x30398a(0xe4)](constants_1[_0x30398a(0xd1)],await this[_0x30398a(0x95)](_0x7039f7,'@{'+_0x5bada6[_0x30398a(0xcb)]+_0x30398a(0xed)));this['proceedComponentMeta'](_0x1f4314[_0x30398a(0xc6)][_0x30398a(0xca)],_0x1f4314[_0x30398a(0xcb)]),_0x12b4cd[_0x30398a(0xea)](_0x1f4314[_0x30398a(0xc6)],_0x5bada6[_0x30398a(0xc6)],_0x5a7d57[_0x30398a(0xc6)]),_0x1a3283&&_0x12b4cd[_0x30398a(0xea)](this['prepareCommitManifest'](_0x1a3283,'@{'+_0x5bada6[_0x30398a(0xcb)]+_0x30398a(0xed)));}return _0x12b4cd;}async[a128_0x3b3875(0xbd)](_0x575f1c,_0xe0a04c=''){const _0x20d661=a128_0x3b3875,_0x4d4779=[];for(const {component:_0xa6edae,meta:_0x267fe0}of _0x575f1c){if(!_0x267fe0['id']){const _0x4fcc6a=this['proceededComponentsMeta'][_0x20d661(0xa5)](_0x451086=>_0x451086['componentName']===_0xa6edae[_0x20d661(0xa2)]&&_0x451086['componentType']===_0xa6edae['type']);if(!_0x4fcc6a)throw new salesforce_error_1[(_0x20d661(0xcd))](new Error(_0x20d661(0xf2)+_0xa6edae['name']+'\x20['+_0xa6edae[_0x20d661(0xb5)]+_0x20d661(0xba)));_0x267fe0['id']=_0x4fcc6a['componentId'];}const _0x3abde2=composite_utils_1[_0x20d661(0xd2)](constants_1[_0x20d661(0xce)],_0x267fe0['id'],this[_0x20d661(0xcc)](_0xa6edae,_0x267fe0)),_0x2161c6=composite_utils_1[_0x20d661(0xe4)](constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x20d661(0xdb)](_0xa6edae,_0x267fe0['id'],_0x267fe0[_0x20d661(0xeb)])),_0x45f54b=composite_utils_1[_0x20d661(0xe4)](constants_1[_0x20d661(0xd1)],await this[_0x20d661(0x95)](_0xa6edae,'@{'+_0x2161c6[_0x20d661(0xcb)]+_0x20d661(0xed)));this[_0x20d661(0xf3)](_0x3abde2['request']['body'],_0x3abde2[_0x20d661(0xcb)]),_0x4d4779['push'](_0x3abde2[_0x20d661(0xc6)],_0x2161c6['request'],_0x45f54b[_0x20d661(0xc6)]),_0xe0a04c&&_0x4d4779[_0x20d661(0xea)](this[_0x20d661(0xf7)](_0xe0a04c,'@{'+_0x2161c6['reference']+'.id}'));}return _0x4d4779;}async[a128_0x3b3875(0x99)](_0x240b1f,_0xdd3fb=![]){const _0x2d449d=a128_0x3b3875,_0x177aec={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x2d0639=[];for(const _0x40f683 of _0x240b1f){if(_0x40f683['id'])_0x2d0639['push'](_0x40f683['id']);else{const _0xd64b48=this[_0x2d449d(0xc7)]['find'](_0x234134=>_0x234134['componentName']===_0x40f683[_0x2d449d(0xa2)]&&_0x234134['componentType']===_0x40f683[_0x2d449d(0xb5)]);if(!_0xd64b48||!_0xd64b48[_0x2d449d(0x96)])continue;_0x2d0639[_0x2d449d(0xea)](_0xd64b48[_0x2d449d(0x96)]);}}if(_0xdd3fb){const _0x756256=await this['gitSync'][_0x2d449d(0xdd)](_0x2d0639);_0x177aec[_0x2d449d(0xd6)]=_0x756256['map'](_0x2fd2f1=>composite_utils_1[_0x2d449d(0xe9)](constants_1[_0x2d449d(0xae)],_0x2fd2f1)[_0x2d449d(0xc6)]);}return _0x177aec[_0x2d449d(0xb7)]=_0x2d0639[_0x2d449d(0xf6)](_0x4a9568=>composite_utils_1[_0x2d449d(0xd2)](constants_1[_0x2d449d(0xce)],_0x4a9568,{[constants_1[_0x2d449d(0x93)]+_0x2d449d(0xa1)]:!![]})['request']),_0x177aec[_0x2d449d(0xb1)]=_0x2d0639[_0x2d449d(0xf6)](_0x5d73d8=>composite_utils_1[_0x2d449d(0xe9)](constants_1['FLOSUM_COMPONENT'],_0x5d73d8)[_0x2d449d(0xc6)]),_0x177aec;}}exports[a128_0x3b3875(0x97)]=SalesforceComponentsManager;