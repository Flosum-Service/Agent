function a128_0x5911(_0x6cdb72,_0x2d4f33){const _0x3e18d5=a128_0x5c61();return a128_0x5911=function(_0x288365,_0x43fabc){_0x288365=_0x288365-0xba;let _0x5c6175=_0x3e18d5[_0x288365];return _0x5c6175;},a128_0x5911(_0x6cdb72,_0x2d4f33);}const a128_0x489215=a128_0x5911;(function(_0x32aa85,_0xc01ec6){const _0x4b5b4e=a128_0x5911,_0x19e87b=_0x32aa85();while(!![]){try{const _0x348845=-parseInt(_0x4b5b4e(0xf8))/0x1*(-parseInt(_0x4b5b4e(0x121))/0x2)+-parseInt(_0x4b5b4e(0x10a))/0x3+-parseInt(_0x4b5b4e(0xc4))/0x4+parseInt(_0x4b5b4e(0xc0))/0x5*(-parseInt(_0x4b5b4e(0xd5))/0x6)+parseInt(_0x4b5b4e(0xd1))/0x7*(parseInt(_0x4b5b4e(0xd4))/0x8)+parseInt(_0x4b5b4e(0xee))/0x9*(-parseInt(_0x4b5b4e(0xda))/0xa)+parseInt(_0x4b5b4e(0x11c))/0xb*(parseInt(_0x4b5b4e(0xe4))/0xc);if(_0x348845===_0xc01ec6)break;else _0x19e87b['push'](_0x19e87b['shift']());}catch(_0xdf68c){_0x19e87b['push'](_0x19e87b['shift']());}}}(a128_0x5c61,0xc5878));const a128_0x43fabc=(function(){let _0x2aa07d=!![];return function(_0x4c3a82,_0x281084){const _0x2e0f38=_0x2aa07d?function(){if(_0x281084){const _0x410f2a=_0x281084['apply'](_0x4c3a82,arguments);return _0x281084=null,_0x410f2a;}}:function(){};return _0x2aa07d=![],_0x2e0f38;};}()),a128_0x288365=a128_0x43fabc(this,function(){const _0x541b30=a128_0x5911;return a128_0x288365[_0x541b30(0x111)]()[_0x541b30(0x108)](_0x541b30(0xd3))[_0x541b30(0x111)]()[_0x541b30(0xc9)](a128_0x288365)[_0x541b30(0x108)](_0x541b30(0xd3));});a128_0x288365();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x647035){return _0x647035&&_0x647035['__esModule']?_0x647035:{'default':_0x647035};};Object['defineProperty'](exports,a128_0x489215(0xbc),{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;const constants_1=require(a128_0x489215(0x11a)),core_1=require(a128_0x489215(0xe0)),zip_1=require(a128_0x489215(0xf4)),typedi_1=__importDefault(require(a128_0x489215(0xed))),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a128_0x489215(0xc3)),flosum_naming_utils_1=require(a128_0x489215(0xd2)),salesforce_git_sync_service_1=require(a128_0x489215(0xd8));function a128_0x5c61(){const _0x2a92a3=['Component__c','98CAxhfs','../utils/flosum-naming.utils','(((.+)+)+)+$','802904ueOPje','60fWAYYc','manifests','Could\x20not\x20proceed\x20component\x20','./salesforce-git-sync.service','createDeleteRequest','30KmkGXz','DEFLATE','prepareComponentRecord','repositoryId','SalesforceComponentsManager','CRC32__c','../../../core','body','file','toISOString','68148mhhmdl','Changed_By__c','FLOSUM_COMPONENT_HISTORY','Component_Name__c','createPostRequest','gitSync','Deletion_By_Agent__c','FLOSUM_COMPONENT','username','typedi','337266FdTxxT','getProceededComponentsMeta','get','Commit__c','Logger','request','../../parsers/utils/zip','Last_Modified_Date__c','componentId','version','491VuZxTB','push','insert','base64','createPatchRequest','name','recordTypes','RecordTypeId','reference','Component_Type__c','Branch__c','proceedComponentMeta','Committed_On__c','Branch','find','proceededComponentsMeta','search','prepareComponentAttachmentRecord','247185AJtjtR','createZip','map','fetchCommitManifestsByComponentIds','Name','Body','ParentId','toString','Changed_On__c','branchId','Repository','FLOSUM_GIT_NAMESPACE','FLOSUM_NAMESPACE','Zip','Component_History__c','extractFieldsFromRecord','../../../constants','componentName','2662nfkiSL','prepareComponentHistoryRecord','Description','FLOSUM_COMMIT_MANIFEST','.id}','166voiBAM','componentsToDelete','prepareCommitManifest','__esModule','type','Last_Updated_By__c','Last_Modified_By__c','361180XSBsXw','logger','crc','../utils/composite.utils','4375584eNFfKL','componentsToUpdate','Source__c','files','ContentType','constructor','Version__c','Repository__c','FLOSUM_ATTACHMENT','File_Name__c','delete','SalesforceGitSyncService'];a128_0x5c61=function(){return _0x2a92a3;};return a128_0x5c61();}class SalesforceComponentsManager{constructor(_0x52e7da,_0x315e42,_0x41371c,_0x12b85d,_0x1de588){const _0xd9b377=a128_0x489215;this[_0xd9b377(0xdd)]=_0x52e7da,this['branchId']=_0x315e42,this[_0xd9b377(0xec)]=_0x41371c,this[_0xd9b377(0xfe)]=_0x12b85d,this[_0xd9b377(0x107)]=_0x1de588,this[_0xd9b377(0xc1)]=new core_1[(_0xd9b377(0xf2))](SalesforceComponentsManager[_0xd9b377(0xfd)]),this[_0xd9b377(0xe9)]=typedi_1['default'][_0xd9b377(0xf0)](salesforce_git_sync_service_1[_0xd9b377(0xcf)]);}['proceedComponentMeta'](_0x91167a,_0x1eb7e6){const _0x2289a3=a128_0x489215,_0x3086d0=flosum_naming_utils_1[_0x2289a3(0x119)](_0x91167a,['Component_Type__c',_0x2289a3(0xe7),_0x2289a3(0xca)]);this['proceededComponentsMeta'][_0x2289a3(0xf9)]({'componentId':'','reference':_0x1eb7e6,'version':_0x3086d0['Version__c'],'componentName':_0x3086d0[_0x2289a3(0xe7)],'componentType':_0x3086d0[_0x2289a3(0x101)]});}[a128_0x489215(0xbb)](_0x5645bb,_0xb574f6){const _0x131817=a128_0x489215,{request:_0x5a94b1}=composite_utils_1[_0x131817(0xe8)](constants_1[_0x131817(0x11f)],{[constants_1['FLOSUM_NAMESPACE']+_0x131817(0xf1)]:_0x5645bb,[constants_1[_0x131817(0x116)]+_0x131817(0x118)]:_0xb574f6});return _0x5a94b1;}async[a128_0x489215(0x109)](_0x4e8579,_0x33962b){const _0x14acf7=a128_0x489215,_0x1dd966={},_0x5d4add=zip_1[_0x14acf7(0x117)][_0x14acf7(0x10b)]();for(const _0x56498e of Object['keys'](_0x4e8579[_0x14acf7(0xc7)])){_0x5d4add[_0x14acf7(0xe2)](_0x56498e,_0x4e8579['files'][_0x56498e],{'createFolders':!![]});}return _0x1dd966[_0x14acf7(0xc8)]='application/zip',_0x1dd966[_0x14acf7(0x10e)]=_0x4e8579['type'],_0x1dd966[_0x14acf7(0x11e)]=_0x4e8579['type'],_0x1dd966[_0x14acf7(0x110)]=_0x33962b,_0x1dd966[_0x14acf7(0x10f)]=await _0x5d4add['generateAsync']({'type':_0x14acf7(0xfb),'compression':_0x14acf7(0xdb),'compressionOptions':{'level':0x6}}),_0x1dd966;}[a128_0x489215(0x11d)](_0x535ca4,_0x241e78,_0x48d01e){const _0x2298d9=a128_0x489215,_0x2fc674=new Date()[_0x2298d9(0xe3)](),_0x91987f={};return _0x91987f[constants_1[_0x2298d9(0x116)]+_0x2298d9(0xd0)]=_0x241e78,_0x91987f[constants_1[_0x2298d9(0x116)]+_0x2298d9(0xdf)]=_0x535ca4[_0x2298d9(0xc2)],_0x91987f[constants_1[_0x2298d9(0x116)]+_0x2298d9(0x112)]=_0x2fc674,_0x91987f[constants_1[_0x2298d9(0x116)]+_0x2298d9(0xe5)]=this[_0x2298d9(0xec)],_0x91987f[constants_1[_0x2298d9(0x116)]+_0x2298d9(0xca)]=_0x48d01e?_0x48d01e+0x1:0x1,_0x91987f[constants_1[_0x2298d9(0x115)]+'Is_From_Agent__c']=!![],_0x91987f;}[a128_0x489215(0xdc)](_0x18e9d3,_0x3362a6){const _0x26bbca=a128_0x489215;var _0x14c9c8,_0x8fe8f7;const _0x5f5dc4=new Date()[_0x26bbca(0xe3)](),_0x5c8387={};return!_0x3362a6?(this[_0x26bbca(0x113)]?(_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0x102)]=this[_0x26bbca(0x113)],_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xc6)]='Branch',_0x5c8387[_0x26bbca(0xff)]=(_0x14c9c8=this[_0x26bbca(0xfe)][_0x26bbca(0x106)](_0x3e2628=>_0x3e2628[_0x26bbca(0xfd)]===_0x26bbca(0x105)))===null||_0x14c9c8===void 0x0?void 0x0:_0x14c9c8['id']):(_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xcb)]=this[_0x26bbca(0xdd)],_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xc6)]=_0x26bbca(0x114),_0x5c8387[_0x26bbca(0xff)]=(_0x8fe8f7=this[_0x26bbca(0xfe)][_0x26bbca(0x106)](_0x482556=>_0x482556[_0x26bbca(0xfd)]===_0x26bbca(0x114)))===null||_0x8fe8f7===void 0x0?void 0x0:_0x8fe8f7['id']),_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xca)]=0x1):_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xca)]=_0x3362a6[_0x26bbca(0xf7)]+0x1,_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0x101)]=_0x18e9d3[_0x26bbca(0xbd)],_0x5c8387[constants_1[_0x26bbca(0x116)]+'Component_Name__c']=_0x18e9d3[_0x26bbca(0xfd)],_0x5c8387[constants_1['FLOSUM_NAMESPACE']+_0x26bbca(0xcd)]=_0x18e9d3['filePath'],_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xbe)]=this['username'],_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xbf)]=this[_0x26bbca(0xec)],_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xf5)]=_0x5f5dc4,_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0x104)]=_0x5f5dc4,_0x5c8387[constants_1[_0x26bbca(0x116)]+_0x26bbca(0xdf)]=_0x18e9d3['crc'],_0x5c8387;}[a128_0x489215(0xef)](){return this['proceededComponentsMeta'];}async[a128_0x489215(0xfa)](_0x48f019,_0x1bf39a){const _0x2bd833=a128_0x489215,_0x3e1d69=[];for(const _0x294b97 of _0x48f019){const _0x26eaba=composite_utils_1[_0x2bd833(0xe8)](constants_1[_0x2bd833(0xeb)],this['prepareComponentRecord'](_0x294b97)),_0xbcbf7b=composite_utils_1['createPostRequest'](constants_1[_0x2bd833(0xe6)],this[_0x2bd833(0x11d)](_0x294b97,'@{'+_0x26eaba[_0x2bd833(0x100)]+_0x2bd833(0x120))),_0x32bac5=composite_utils_1[_0x2bd833(0xe8)](constants_1[_0x2bd833(0xcc)],await this[_0x2bd833(0x109)](_0x294b97,'@{'+_0xbcbf7b[_0x2bd833(0x100)]+_0x2bd833(0x120)));this[_0x2bd833(0x103)](_0x26eaba[_0x2bd833(0xf3)]['body'],_0x26eaba['reference']),_0x3e1d69[_0x2bd833(0xf9)](_0x26eaba[_0x2bd833(0xf3)],_0xbcbf7b[_0x2bd833(0xf3)],_0x32bac5['request']),_0x1bf39a&&_0x3e1d69[_0x2bd833(0xf9)](this[_0x2bd833(0xbb)](_0x1bf39a,'@{'+_0xbcbf7b['reference']+'.id}'));}return _0x3e1d69;}async['update'](_0x14b1d7,_0x50b977=''){const _0x153eaa=a128_0x489215,_0xf0a638=[];for(const {component:_0x32d9e5,meta:_0x666fd4}of _0x14b1d7){if(!_0x666fd4['id']){const _0x7256c6=this[_0x153eaa(0x107)][_0x153eaa(0x106)](_0x9747d5=>_0x9747d5['componentName']===_0x32d9e5['name']&&_0x9747d5['componentType']===_0x32d9e5['type']);if(!_0x7256c6)throw new salesforce_error_1['SalesforceError'](new Error(_0x153eaa(0xd7)+_0x32d9e5['name']+'\x20['+_0x32d9e5[_0x153eaa(0xbd)]+']\x20-\x20meta\x20not\x20found'));_0x666fd4['id']=_0x7256c6[_0x153eaa(0xf6)];}const _0x291492=composite_utils_1[_0x153eaa(0xfc)](constants_1[_0x153eaa(0xeb)],_0x666fd4['id'],this[_0x153eaa(0xdc)](_0x32d9e5,_0x666fd4)),_0x28be6c=composite_utils_1[_0x153eaa(0xe8)](constants_1[_0x153eaa(0xe6)],this[_0x153eaa(0x11d)](_0x32d9e5,_0x666fd4['id'],_0x666fd4[_0x153eaa(0xf7)])),_0xd90be4=composite_utils_1[_0x153eaa(0xe8)](constants_1[_0x153eaa(0xcc)],await this[_0x153eaa(0x109)](_0x32d9e5,'@{'+_0x28be6c[_0x153eaa(0x100)]+_0x153eaa(0x120)));this['proceedComponentMeta'](_0x291492['request'][_0x153eaa(0xe1)],_0x291492[_0x153eaa(0x100)]),_0xf0a638[_0x153eaa(0xf9)](_0x291492['request'],_0x28be6c[_0x153eaa(0xf3)],_0xd90be4[_0x153eaa(0xf3)]),_0x50b977&&_0xf0a638[_0x153eaa(0xf9)](this['prepareCommitManifest'](_0x50b977,'@{'+_0x28be6c[_0x153eaa(0x100)]+_0x153eaa(0x120)));}return _0xf0a638;}async[a128_0x489215(0xce)](_0x6c4ad,_0x5b053f=![]){const _0x2c5498=a128_0x489215,_0xc224cc={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x6c6961=[];for(const _0x9d17a6 of _0x6c4ad){if(_0x9d17a6['id'])_0x6c6961[_0x2c5498(0xf9)](_0x9d17a6['id']);else{const _0x5a46f2=this['proceededComponentsMeta'][_0x2c5498(0x106)](_0x193fd3=>_0x193fd3[_0x2c5498(0x11b)]===_0x9d17a6['name']&&_0x193fd3['componentType']===_0x9d17a6[_0x2c5498(0xbd)]);if(!_0x5a46f2||!_0x5a46f2[_0x2c5498(0xf6)])continue;_0x6c6961[_0x2c5498(0xf9)](_0x5a46f2[_0x2c5498(0xf6)]);}}if(_0x5b053f){const _0x3b1dbc=await this[_0x2c5498(0xe9)][_0x2c5498(0x10d)](_0x6c6961);_0xc224cc[_0x2c5498(0xd6)]=_0x3b1dbc[_0x2c5498(0x10c)](_0x58af61=>composite_utils_1['createDeleteRequest'](constants_1[_0x2c5498(0x11f)],_0x58af61)[_0x2c5498(0xf3)]);}return _0xc224cc[_0x2c5498(0xc5)]=_0x6c6961[_0x2c5498(0x10c)](_0x107881=>composite_utils_1[_0x2c5498(0xfc)](constants_1['FLOSUM_COMPONENT'],_0x107881,{[constants_1[_0x2c5498(0x115)]+_0x2c5498(0xea)]:!![]})['request']),_0xc224cc[_0x2c5498(0xba)]=_0x6c6961[_0x2c5498(0x10c)](_0x4e1cb4=>composite_utils_1[_0x2c5498(0xd9)](constants_1['FLOSUM_COMPONENT'],_0x4e1cb4)[_0x2c5498(0xf3)]),_0xc224cc;}}exports[a128_0x489215(0xde)]=SalesforceComponentsManager;