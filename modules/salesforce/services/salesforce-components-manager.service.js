function a127_0x33e4(_0x23e643,_0x231468){const _0x34031a=a127_0x5e81();return a127_0x33e4=function(_0x24b1fa,_0x1422c0){_0x24b1fa=_0x24b1fa-0x1b6;let _0x5e81c3=_0x34031a[_0x24b1fa];return _0x5e81c3;},a127_0x33e4(_0x23e643,_0x231468);}const a127_0x3545c0=a127_0x33e4;(function(_0x254e21,_0x55bc54){const _0x5cbd3e=a127_0x33e4,_0x271c50=_0x254e21();while(!![]){try{const _0xb13ddb=parseInt(_0x5cbd3e(0x1d6))/0x1+parseInt(_0x5cbd3e(0x211))/0x2+parseInt(_0x5cbd3e(0x20f))/0x3+parseInt(_0x5cbd3e(0x1ff))/0x4+parseInt(_0x5cbd3e(0x205))/0x5+parseInt(_0x5cbd3e(0x1dd))/0x6+parseInt(_0x5cbd3e(0x1f5))/0x7*(-parseInt(_0x5cbd3e(0x1dc))/0x8);if(_0xb13ddb===_0x55bc54)break;else _0x271c50['push'](_0x271c50['shift']());}catch(_0x5ad9bd){_0x271c50['push'](_0x271c50['shift']());}}}(a127_0x5e81,0x45099));const a127_0x1422c0=(function(){let _0x13ab7a=!![];return function(_0x22d498,_0x188276){const _0x2ea3af=_0x13ab7a?function(){const _0x49cf3b=a127_0x33e4;if(_0x188276){const _0x5065af=_0x188276[_0x49cf3b(0x1ef)](_0x22d498,arguments);return _0x188276=null,_0x5065af;}}:function(){};return _0x13ab7a=![],_0x2ea3af;};}()),a127_0x24b1fa=a127_0x1422c0(this,function(){const _0xd9629=a127_0x33e4;return a127_0x24b1fa[_0xd9629(0x1bb)]()[_0xd9629(0x1fb)](_0xd9629(0x1cf))['toString']()['constructor'](a127_0x24b1fa)[_0xd9629(0x1fb)](_0xd9629(0x1cf));});a127_0x24b1fa();'use strict';var __importDefault=this&&this[a127_0x3545c0(0x200)]||function(_0xe19211){const _0x3b2528=a127_0x3545c0;return _0xe19211&&_0xe19211[_0x3b2528(0x1c9)]?_0xe19211:{'default':_0xe19211};};Object[a127_0x3545c0(0x1cc)](exports,'__esModule',{'value':!![]}),exports[a127_0x3545c0(0x1ee)]=void 0x0;const constants_1=require(a127_0x3545c0(0x1e2)),core_1=require('../../../core'),zip_1=require(a127_0x3545c0(0x203)),typedi_1=__importDefault(require(a127_0x3545c0(0x207))),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a127_0x3545c0(0x202)),salesforce_git_sync_service_1=require(a127_0x3545c0(0x1c6));class SalesforceComponentsManager{constructor(_0x4d659f,_0x315f37,_0x43ccb7,_0x6f2ac3,_0x46abbf){const _0x141764=a127_0x3545c0;this['repositoryId']=_0x4d659f,this[_0x141764(0x1d0)]=_0x315f37,this[_0x141764(0x1c2)]=_0x43ccb7,this[_0x141764(0x1bf)]=_0x6f2ac3,this[_0x141764(0x1ca)]=_0x46abbf,this[_0x141764(0x1fd)]=new core_1[(_0x141764(0x1e9))](SalesforceComponentsManager[_0x141764(0x1d7)]),this[_0x141764(0x209)]=typedi_1[_0x141764(0x1f8)][_0x141764(0x1ba)](salesforce_git_sync_service_1[_0x141764(0x20a)]);}[a127_0x3545c0(0x1c0)](_0x285b0a,_0x4e65d3){const _0x4ad48f=a127_0x3545c0,_0x483f31=flosum_naming_utils_1[_0x4ad48f(0x1de)](_0x285b0a,[_0x4ad48f(0x1f9),_0x4ad48f(0x1d2),_0x4ad48f(0x1e4)]);this[_0x4ad48f(0x1ca)][_0x4ad48f(0x1cb)]({'componentId':'','reference':_0x4e65d3,'version':_0x483f31[_0x4ad48f(0x1e4)],'componentName':_0x483f31[_0x4ad48f(0x1d2)],'componentType':_0x483f31['Component_Type__c']});}[a127_0x3545c0(0x212)](_0xdd9fdc,_0x175424){const _0x5872c4=a127_0x3545c0,{request:_0x34bcf5}=composite_utils_1[_0x5872c4(0x1bc)](constants_1[_0x5872c4(0x1f7)],{[constants_1['FLOSUM_NAMESPACE']+_0x5872c4(0x210)]:_0xdd9fdc,[constants_1[_0x5872c4(0x1da)]+'Component_History__c']:_0x175424});return _0x34bcf5;}async[a127_0x3545c0(0x1f3)](_0x1e32cb,_0x19ffb1){const _0xa4ea5d=a127_0x3545c0,_0x16d6c7={},_0x592b14=zip_1['Zip'][_0xa4ea5d(0x20d)]();for(const _0x2ecdba of Object['keys'](_0x1e32cb['files'])){_0x592b14['file'](_0x2ecdba,_0x1e32cb[_0xa4ea5d(0x1e3)][_0x2ecdba],{'createFolders':!![]});}return _0x16d6c7['ContentType']=_0xa4ea5d(0x1d9),_0x16d6c7['Name']=_0x1e32cb[_0xa4ea5d(0x1c5)],_0x16d6c7[_0xa4ea5d(0x213)]=_0x1e32cb[_0xa4ea5d(0x1c5)],_0x16d6c7[_0xa4ea5d(0x1bd)]=_0x19ffb1,_0x16d6c7[_0xa4ea5d(0x1c7)]=await _0x592b14[_0xa4ea5d(0x1d5)]({'type':_0xa4ea5d(0x1f0),'compression':_0xa4ea5d(0x1f4),'compressionOptions':{'level':0x6}}),_0x16d6c7;}[a127_0x3545c0(0x1df)](_0x33af5e,_0x10087f,_0x13bcd5){const _0x2079ca=a127_0x3545c0,_0x3901bf=new Date()[_0x2079ca(0x201)](),_0x4d8303={};return _0x4d8303[constants_1[_0x2079ca(0x1da)]+_0x2079ca(0x1d4)]=_0x10087f,_0x4d8303[constants_1[_0x2079ca(0x1da)]+'CRC32__c']=_0x33af5e[_0x2079ca(0x1ce)],_0x4d8303[constants_1[_0x2079ca(0x1da)]+_0x2079ca(0x20c)]=_0x3901bf,_0x4d8303[constants_1[_0x2079ca(0x1da)]+_0x2079ca(0x1e8)]=this[_0x2079ca(0x1c2)],_0x4d8303[constants_1[_0x2079ca(0x1da)]+_0x2079ca(0x1e4)]=_0x13bcd5?_0x13bcd5+0x1:0x1,_0x4d8303[constants_1['FLOSUM_GIT_NAMESPACE']+_0x2079ca(0x1b8)]=!![],_0x4d8303;}['prepareComponentRecord'](_0x1e3ab3,_0x46610e){const _0xadb466=a127_0x3545c0;var _0xf66716,_0x5a0024;const _0x96c4ec=new Date()['toISOString'](),_0x29790c={};return!_0x46610e?(this[_0xadb466(0x1d0)]?(_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1f2)]=this[_0xadb466(0x1d0)],_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1c8)]=_0xadb466(0x1e0),_0x29790c['RecordTypeId']=(_0xf66716=this[_0xadb466(0x1bf)][_0xadb466(0x1be)](_0x121d21=>_0x121d21[_0xadb466(0x1d7)]===_0xadb466(0x1e0)))===null||_0xf66716===void 0x0?void 0x0:_0xf66716['id']):(_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1d8)]=this['repositoryId'],_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1c8)]='Repository',_0x29790c[_0xadb466(0x208)]=(_0x5a0024=this[_0xadb466(0x1bf)]['find'](_0x414526=>_0x414526[_0xadb466(0x1d7)]===_0xadb466(0x1ea)))===null||_0x5a0024===void 0x0?void 0x0:_0x5a0024['id']),_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1e4)]=0x1):_0x29790c[constants_1['FLOSUM_NAMESPACE']+_0xadb466(0x1e4)]=_0x46610e[_0xadb466(0x1ed)]+0x1,_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1f9)]=_0x1e3ab3[_0xadb466(0x1c5)],_0x29790c[constants_1['FLOSUM_NAMESPACE']+_0xadb466(0x1d2)]=_0x1e3ab3[_0xadb466(0x1d7)],_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1eb)]=_0x1e3ab3['filePath'],_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x206)]=this[_0xadb466(0x1c2)],_0x29790c[constants_1['FLOSUM_NAMESPACE']+_0xadb466(0x1d1)]=this[_0xadb466(0x1c2)],_0x29790c[constants_1[_0xadb466(0x1da)]+'Last_Modified_Date__c']=_0x96c4ec,_0x29790c[constants_1[_0xadb466(0x1da)]+'Committed_On__c']=_0x96c4ec,_0x29790c[constants_1[_0xadb466(0x1da)]+_0xadb466(0x1e6)]=_0x1e3ab3[_0xadb466(0x1ce)],_0x29790c;}[a127_0x3545c0(0x1fa)](){const _0x124c97=a127_0x3545c0;return this[_0x124c97(0x1ca)];}async['insert'](_0x12aea6,_0x539adb){const _0x1d21c1=a127_0x3545c0,_0x48db83=[];for(const _0x2aa11c of _0x12aea6){const _0x2c4020=composite_utils_1[_0x1d21c1(0x1bc)](constants_1[_0x1d21c1(0x1b9)],this[_0x1d21c1(0x20e)](_0x2aa11c)),_0x488b7c=composite_utils_1[_0x1d21c1(0x1bc)](constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x1d21c1(0x1df)](_0x2aa11c,'@{'+_0x2c4020['reference']+_0x1d21c1(0x1f1))),_0x438f7d=composite_utils_1[_0x1d21c1(0x1bc)](constants_1['FLOSUM_ATTACHMENT'],await this[_0x1d21c1(0x1f3)](_0x2aa11c,'@{'+_0x488b7c[_0x1d21c1(0x1db)]+_0x1d21c1(0x1f1)));this[_0x1d21c1(0x1c0)](_0x2c4020[_0x1d21c1(0x1b7)]['body'],_0x2c4020[_0x1d21c1(0x1db)]),_0x48db83[_0x1d21c1(0x1cb)](_0x2c4020[_0x1d21c1(0x1b7)],_0x488b7c[_0x1d21c1(0x1b7)],_0x438f7d[_0x1d21c1(0x1b7)]),_0x539adb&&_0x48db83[_0x1d21c1(0x1cb)](this[_0x1d21c1(0x212)](_0x539adb,'@{'+_0x488b7c[_0x1d21c1(0x1db)]+_0x1d21c1(0x1f1)));}return _0x48db83;}async[a127_0x3545c0(0x1e7)](_0x296be5,_0x25978c=''){const _0x439271=a127_0x3545c0,_0x4dde19=[];for(const {component:_0x5a2ab8,meta:_0x5d6fff}of _0x296be5){if(!_0x5d6fff['id']){const _0x36662b=this[_0x439271(0x1ca)][_0x439271(0x1be)](_0x5643c3=>_0x5643c3[_0x439271(0x204)]===_0x5a2ab8[_0x439271(0x1d7)]&&_0x5643c3['componentType']===_0x5a2ab8[_0x439271(0x1c5)]);if(!_0x36662b)throw new salesforce_error_1[(_0x439271(0x1fc))](new Error('Could\x20not\x20proceed\x20component\x20'+_0x5a2ab8[_0x439271(0x1d7)]+'\x20['+_0x5a2ab8[_0x439271(0x1c5)]+_0x439271(0x1c4)));_0x5d6fff['id']=_0x36662b[_0x439271(0x1e5)];}const _0x31944e=composite_utils_1[_0x439271(0x1e1)](constants_1[_0x439271(0x1b9)],_0x5d6fff['id'],this['prepareComponentRecord'](_0x5a2ab8,_0x5d6fff)),_0x4c07a2=composite_utils_1[_0x439271(0x1bc)](constants_1[_0x439271(0x1f6)],this[_0x439271(0x1df)](_0x5a2ab8,_0x5d6fff['id'],_0x5d6fff[_0x439271(0x1ed)])),_0x5ab839=composite_utils_1[_0x439271(0x1bc)](constants_1[_0x439271(0x1b6)],await this[_0x439271(0x1f3)](_0x5a2ab8,'@{'+_0x4c07a2[_0x439271(0x1db)]+_0x439271(0x1f1)));this[_0x439271(0x1c0)](_0x31944e[_0x439271(0x1b7)][_0x439271(0x1fe)],_0x31944e[_0x439271(0x1db)]),_0x4dde19[_0x439271(0x1cb)](_0x31944e[_0x439271(0x1b7)],_0x4c07a2[_0x439271(0x1b7)],_0x5ab839[_0x439271(0x1b7)]),_0x25978c&&_0x4dde19[_0x439271(0x1cb)](this[_0x439271(0x212)](_0x25978c,'@{'+_0x4c07a2[_0x439271(0x1db)]+_0x439271(0x1f1)));}return _0x4dde19;}async['delete'](_0x3631cb,_0xaa7036=![]){const _0xaaa835=a127_0x3545c0,_0x581fb2={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x92566=[];for(const _0x5cba7f of _0x3631cb){if(_0x5cba7f['id'])_0x92566[_0xaaa835(0x1cb)](_0x5cba7f['id']);else{const _0x22a557=this[_0xaaa835(0x1ca)][_0xaaa835(0x1be)](_0x3ccf2a=>_0x3ccf2a[_0xaaa835(0x204)]===_0x5cba7f[_0xaaa835(0x1d7)]&&_0x3ccf2a['componentType']===_0x5cba7f[_0xaaa835(0x1c5)]);if(!_0x22a557||!_0x22a557[_0xaaa835(0x1e5)])continue;_0x92566[_0xaaa835(0x1cb)](_0x22a557[_0xaaa835(0x1e5)]);}}if(_0xaa7036){const _0x382a81=await this[_0xaaa835(0x209)][_0xaaa835(0x1d3)](_0x92566);_0x581fb2['manifests']=_0x382a81[_0xaaa835(0x20b)](_0x142352=>composite_utils_1[_0xaaa835(0x1cd)](constants_1['FLOSUM_COMMIT_MANIFEST'],_0x142352)['request']);}return _0x581fb2[_0xaaa835(0x1c3)]=_0x92566[_0xaaa835(0x20b)](_0x4b33a0=>composite_utils_1[_0xaaa835(0x1e1)](constants_1[_0xaaa835(0x1b9)],_0x4b33a0,{[constants_1[_0xaaa835(0x214)]+_0xaaa835(0x1ec)]:!![]})[_0xaaa835(0x1b7)]),_0x581fb2[_0xaaa835(0x1c1)]=_0x92566[_0xaaa835(0x20b)](_0x1cfb0c=>composite_utils_1[_0xaaa835(0x1cd)](constants_1[_0xaaa835(0x1b9)],_0x1cfb0c)[_0xaaa835(0x1b7)]),_0x581fb2;}}exports['SalesforceComponentsManager']=SalesforceComponentsManager;function a127_0x5e81(){const _0x5226bb=['RecordTypeId','gitSync','SalesforceGitSyncService','map','Changed_On__c','createZip','prepareComponentRecord','1277595BFiOlT','Commit__c','273026eoSexQ','prepareCommitManifest','Description','FLOSUM_GIT_NAMESPACE','FLOSUM_ATTACHMENT','request','Is_From_Agent__c','FLOSUM_COMPONENT','get','toString','createPostRequest','ParentId','find','recordTypes','proceedComponentMeta','componentsToDelete','username','componentsToUpdate',']\x20-\x20meta\x20not\x20found','type','./salesforce-git-sync.service','Body','Source__c','__esModule','proceededComponentsMeta','push','defineProperty','createDeleteRequest','crc','(((.+)+)+)+$','branchId','Last_Modified_By__c','Component_Name__c','fetchCommitManifestsByComponentIds','Component__c','generateAsync','357534kgnDfo','name','Repository__c','application/zip','FLOSUM_NAMESPACE','reference','8nOfOuB','1242006LvCqfa','extractFieldsFromRecord','prepareComponentHistoryRecord','Branch','createPatchRequest','../../../constants','files','Version__c','componentId','CRC32__c','update','Changed_By__c','Logger','Repository','File_Name__c','Deletion_By_Agent__c','version','SalesforceComponentsManager','apply','base64','.id}','Branch__c','prepareComponentAttachmentRecord','DEFLATE','9931306YOqQuM','FLOSUM_COMPONENT_HISTORY','FLOSUM_COMMIT_MANIFEST','default','Component_Type__c','getProceededComponentsMeta','search','SalesforceError','logger','body','915808FIoxvE','__importDefault','toISOString','../utils/flosum-naming.utils','../../parsers/utils/zip','componentName','1728350xQRoOR','Last_Updated_By__c','typedi'];a127_0x5e81=function(){return _0x5226bb;};return a127_0x5e81();}