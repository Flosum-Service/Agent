const a125_0x5bdc43=a125_0x4502;(function(_0x61ba76,_0x45f845){const _0x43f378=a125_0x4502,_0x3c74ee=_0x61ba76();while(!![]){try{const _0x48beb3=parseInt(_0x43f378(0xc4))/0x1*(-parseInt(_0x43f378(0xb2))/0x2)+-parseInt(_0x43f378(0xe1))/0x3+parseInt(_0x43f378(0xc1))/0x4*(-parseInt(_0x43f378(0xe3))/0x5)+parseInt(_0x43f378(0xb1))/0x6+-parseInt(_0x43f378(0xc2))/0x7*(parseInt(_0x43f378(0x9a))/0x8)+-parseInt(_0x43f378(0xda))/0x9+-parseInt(_0x43f378(0xc9))/0xa*(-parseInt(_0x43f378(0x9b))/0xb);if(_0x48beb3===_0x45f845)break;else _0x3c74ee['push'](_0x3c74ee['shift']());}catch(_0x422024){_0x3c74ee['push'](_0x3c74ee['shift']());}}}(a125_0x318c,0xa4932));const a125_0x4cfa28=(function(){let _0x5cafca=!![];return function(_0x3520d4,_0x30af49){const _0xd779a2=_0x5cafca?function(){const _0x57ce53=a125_0x4502;if(_0x30af49){const _0x275cc1=_0x30af49[_0x57ce53(0xdb)](_0x3520d4,arguments);return _0x30af49=null,_0x275cc1;}}:function(){};return _0x5cafca=![],_0xd779a2;};}()),a125_0x292113=a125_0x4cfa28(this,function(){const _0x23d4a3=a125_0x4502;return a125_0x292113[_0x23d4a3(0x94)]()[_0x23d4a3(0x96)](_0x23d4a3(0xd3))[_0x23d4a3(0x94)]()[_0x23d4a3(0xdd)](a125_0x292113)['search'](_0x23d4a3(0xd3));});a125_0x292113();function a125_0x4502(_0x16290e,_0xed45ca){const _0x456da9=a125_0x318c();return a125_0x4502=function(_0x292113,_0x4cfa28){_0x292113=_0x292113-0x90;let _0x318c2c=_0x456da9[_0x292113];return _0x318c2c;},a125_0x4502(_0x16290e,_0xed45ca);}'use strict';function a125_0x318c(){const _0x2c5bb4=['../../shared/services/salesforce-settings.service','application/json','message','../../../constants','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','setAuthDetails','access_token','joinURL','SalesforceAuthService','waitAuth','SALESFORCE_API_VERSION','updateAccessToken','instance_url','getAuthData','4HVRGTG','21ileIIQ','../enums/auth-state.enum','1XVkArL','instanceUrl','force\x20update\x20token','getOwnPropertyDescriptor','error','10CUvzFd','defineProperty','typedi','update\x20access\x20token\x20failed:\x20%s','token_type','post','../../../constants/errors','object','create\x20authorized\x20request\x20failed:\x20authorization\x20error','../../shared/utils','(((.+)+)+)+$','__decorate','get','update\x20access\x20token','accessToken','InvalidRefreshTokenError','data','9022482nEmeNh','apply','requestConfig','constructor','Active','authState','salesforseSettings','899181uMJQGz','log','325250tcQNgf','access\x20token\x20updated\x20for\x20%s','Idle','UnauthorizedSalesforceError','forceUpdateToken','response','toString','name','search','Service','__esModule','metadata','1530376MuZcjS','29550367GXoVqF','ERR_INVALID_SALESFORCE_TOKEN','decorate','length','Logger','catch','check\x20auth:\x20current\x20state\x20-\x20%s','default','Updating','../errors/invalid-refresh-token.error','services/data/','design:paramtypes','Error','logger','../errors/unauthorized-salesforce.error','__importDefault','AuthState','settings','axios','AUTH_WAIT_TIME','SalesforceSettingsService','sleep','2183844dHEOvJ','870214NYLXhw'];a125_0x318c=function(){return _0x2c5bb4;};return a125_0x318c();}var __decorate=this&&this[a125_0x5bdc43(0xd4)]||function(_0x2702b3,_0x25ff8f,_0x51eb0a,_0x21732f){const _0x26573f=a125_0x5bdc43;var _0xba450c=arguments[_0x26573f(0x9e)],_0x264294=_0xba450c<0x3?_0x25ff8f:_0x21732f===null?_0x21732f=Object[_0x26573f(0xc7)](_0x25ff8f,_0x51eb0a):_0x21732f,_0x51ba91;if(typeof Reflect===_0x26573f(0xd0)&&typeof Reflect[_0x26573f(0x9d)]==='function')_0x264294=Reflect[_0x26573f(0x9d)](_0x2702b3,_0x25ff8f,_0x51eb0a,_0x21732f);else{for(var _0xf2642=_0x2702b3[_0x26573f(0x9e)]-0x1;_0xf2642>=0x0;_0xf2642--)if(_0x51ba91=_0x2702b3[_0xf2642])_0x264294=(_0xba450c<0x3?_0x51ba91(_0x264294):_0xba450c>0x3?_0x51ba91(_0x25ff8f,_0x51eb0a,_0x264294):_0x51ba91(_0x25ff8f,_0x51eb0a))||_0x264294;}return _0xba450c>0x3&&_0x264294&&Object[_0x26573f(0xca)](_0x25ff8f,_0x51eb0a,_0x264294),_0x264294;},__metadata=this&&this['__metadata']||function(_0x3b63bf,_0x2a2507){const _0x261a49=a125_0x5bdc43;if(typeof Reflect==='object'&&typeof Reflect[_0x261a49(0x99)]==='function')return Reflect['metadata'](_0x3b63bf,_0x2a2507);},__importDefault=this&&this[a125_0x5bdc43(0xaa)]||function(_0x364f34){const _0x453645=a125_0x5bdc43;return _0x364f34&&_0x364f34[_0x453645(0x98)]?_0x364f34:{'default':_0x364f34};},SalesforceAuthService_1;Object[a125_0x5bdc43(0xca)](exports,a125_0x5bdc43(0x98),{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=require(a125_0x5bdc43(0xcb)),errors_1=require(a125_0x5bdc43(0xcf)),core_1=require('../../../core'),salesforce_settings_service_1=require(a125_0x5bdc43(0xb3)),axios_1=__importDefault(require(a125_0x5bdc43(0xad))),utils_1=require(a125_0x5bdc43(0xd2)),invalid_refresh_token_error_1=require(a125_0x5bdc43(0xa4)),auth_state_enum_1=require(a125_0x5bdc43(0xc3)),unauthorized_salesforce_error_1=require(a125_0x5bdc43(0xa9)),constants_1=require(a125_0x5bdc43(0xb6));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x59e13b){const _0x385387=a125_0x5bdc43;this[_0x385387(0xe0)]=_0x59e13b,this[_0x385387(0xae)]=0x1388,this['authState']=auth_state_enum_1[_0x385387(0xab)]['Idle'],this[_0x385387(0xa8)]=new core_1[(_0x385387(0x9f))](SalesforceAuthService_1[_0x385387(0x95)]),this[_0x385387(0xb8)]();}get[a125_0x5bdc43(0xac)](){const _0x2e8ff4=a125_0x5bdc43;return this[_0x2e8ff4(0xe0)]['settings'];}async[a125_0x5bdc43(0xb8)](){const _0xc3e6f7=a125_0x5bdc43;this[_0xc3e6f7(0xa8)][_0xc3e6f7(0xe2)](_0xc3e6f7(0xa1),auth_state_enum_1[_0xc3e6f7(0xab)][this[_0xc3e6f7(0xdf)]]);try{if(this[_0xc3e6f7(0xdf)]===auth_state_enum_1[_0xc3e6f7(0xab)][_0xc3e6f7(0xa7)])return;if(this[_0xc3e6f7(0xdf)]===auth_state_enum_1[_0xc3e6f7(0xab)]['Idle'])await this[_0xc3e6f7(0xbe)]();else{const _0x1508af=await this[_0xc3e6f7(0xdc)](),_0x10100a=await axios_1[_0xc3e6f7(0xa2)][_0xc3e6f7(0xd5)](_0xc3e6f7(0xa5)+constants_1[_0xc3e6f7(0xbd)],_0x1508af)['then'](()=>!![])[_0xc3e6f7(0xa0)](()=>![]);!_0x10100a&&await this['updateAccessToken']();}}catch(_0x3ea342){}}async[a125_0x5bdc43(0xbe)](){const _0x37ec06=a125_0x5bdc43;var _0xb9a593,_0x444fa3,_0x4b9491;this[_0x37ec06(0xa8)][_0x37ec06(0xe2)](_0x37ec06(0xd6));try{this[_0x37ec06(0xdf)]=auth_state_enum_1[_0x37ec06(0xab)][_0x37ec06(0xa3)];const {refreshToken:_0x3aed64,clientId:_0x542da1,clientSecret:_0x3f546c}=this[_0x37ec06(0xac)],{data:_0x379daf}=await axios_1[_0x37ec06(0xa2)][_0x37ec06(0xce)](utils_1[_0x37ec06(0xba)](this[_0x37ec06(0xe0)]['loginUrl'],'/services/oauth2/token'),null,{'params':{'grant_type':'refresh_token','refresh_token':_0x3aed64,'client_id':_0x542da1,'client_secret':_0x3f546c}});this[_0x37ec06(0xc5)]=_0x379daf[_0x37ec06(0xbf)],this[_0x37ec06(0xd7)]=_0x379daf[_0x37ec06(0xb9)],this['tokenType']=_0x379daf[_0x37ec06(0xcd)],this[_0x37ec06(0xdf)]=auth_state_enum_1[_0x37ec06(0xab)]['Active'],this[_0x37ec06(0xa8)][_0x37ec06(0xe2)](_0x37ec06(0xe4),this[_0x37ec06(0xc5)]);}catch(_0x1fdfd6){const _0xdb41c5=((_0x444fa3=(_0xb9a593=_0x1fdfd6===null||_0x1fdfd6===void 0x0?void 0x0:_0x1fdfd6['response'])===null||_0xb9a593===void 0x0?void 0x0:_0xb9a593[_0x37ec06(0xd9)])===null||_0x444fa3===void 0x0?void 0x0:_0x444fa3['error'])||((_0x4b9491=_0x1fdfd6===null||_0x1fdfd6===void 0x0?void 0x0:_0x1fdfd6[_0x37ec06(0x93)])===null||_0x4b9491===void 0x0?void 0x0:_0x4b9491[_0x37ec06(0xd9)])||_0x1fdfd6[_0x37ec06(0xb5)];this[_0x37ec06(0xa8)][_0x37ec06(0xc8)](_0x37ec06(0xcc),_0xdb41c5),this[_0x37ec06(0xdf)]=auth_state_enum_1[_0x37ec06(0xab)][_0x37ec06(0xa7)];throw new invalid_refresh_token_error_1[(_0x37ec06(0xd8))](errors_1[_0x37ec06(0x9c)]);}}async[a125_0x5bdc43(0x92)](){const _0x51fa21=a125_0x5bdc43;this[_0x51fa21(0xa8)]['log'](_0x51fa21(0xc6));if(this['authState']===auth_state_enum_1['AuthState'][_0x51fa21(0xa3)]||this[_0x51fa21(0xdf)]===auth_state_enum_1[_0x51fa21(0xab)][_0x51fa21(0x90)])return await utils_1[_0x51fa21(0xb0)](this['AUTH_WAIT_TIME']),this[_0x51fa21(0x92)]();if(this['authState']===auth_state_enum_1[_0x51fa21(0xab)]['Error'])throw new invalid_refresh_token_error_1[(_0x51fa21(0xd8))](errors_1[_0x51fa21(0x9c)]);await this[_0x51fa21(0xbe)]();}async[a125_0x5bdc43(0xbc)](){const _0x2e882e=a125_0x5bdc43;if(this[_0x2e882e(0xdf)]===auth_state_enum_1[_0x2e882e(0xab)][_0x2e882e(0xa7)]){this[_0x2e882e(0xa8)][_0x2e882e(0xe2)](_0x2e882e(0xd1));throw new unauthorized_salesforce_error_1[(_0x2e882e(0x91))]();}if(this[_0x2e882e(0xdf)]!==auth_state_enum_1['AuthState'][_0x2e882e(0xde)])return this[_0x2e882e(0xa8)][_0x2e882e(0xe2)](_0x2e882e(0xb7)),await utils_1[_0x2e882e(0xb0)](this[_0x2e882e(0xae)]),this['waitAuth']();}[a125_0x5bdc43(0xc0)](){const _0x38965e=a125_0x5bdc43;return{'orgId':this['orgId'],'accessToken':this[_0x38965e(0xd7)],'instanceUrl':this[_0x38965e(0xc5)]};}async[a125_0x5bdc43(0xdc)](){const _0x22df06=a125_0x5bdc43;return await this[_0x22df06(0xbc)](),{'baseURL':this['instanceUrl'],'headers':{'accept':_0x22df06(0xb4),'authorization':this['tokenType']+'\x20'+this[_0x22df06(0xd7)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1[a125_0x5bdc43(0x97)](),__metadata(a125_0x5bdc43(0xa6),[salesforce_settings_service_1[a125_0x5bdc43(0xaf)]])],SalesforceAuthService),exports[a125_0x5bdc43(0xbb)]=SalesforceAuthService;