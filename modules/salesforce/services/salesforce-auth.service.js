function a126_0x31bd(_0x5d82b8,_0x10b319){const _0x3c2dd5=a126_0x2cc7();return a126_0x31bd=function(_0xcdcc26,_0x49c069){_0xcdcc26=_0xcdcc26-0x1be;let _0x2cc78a=_0x3c2dd5[_0xcdcc26];return _0x2cc78a;},a126_0x31bd(_0x5d82b8,_0x10b319);}const a126_0x2e3f41=a126_0x31bd;(function(_0x286ccf,_0x218145){const _0x531ab5=a126_0x31bd,_0x14eb9b=_0x286ccf();while(!![]){try{const _0x5a99e5=parseInt(_0x531ab5(0x1df))/0x1+parseInt(_0x531ab5(0x1f7))/0x2+parseInt(_0x531ab5(0x206))/0x3*(-parseInt(_0x531ab5(0x1c5))/0x4)+parseInt(_0x531ab5(0x1cd))/0x5*(-parseInt(_0x531ab5(0x205))/0x6)+parseInt(_0x531ab5(0x1d7))/0x7*(parseInt(_0x531ab5(0x1d5))/0x8)+parseInt(_0x531ab5(0x1be))/0x9+parseInt(_0x531ab5(0x1c0))/0xa*(parseInt(_0x531ab5(0x1ec))/0xb);if(_0x5a99e5===_0x218145)break;else _0x14eb9b['push'](_0x14eb9b['shift']());}catch(_0x36d55b){_0x14eb9b['push'](_0x14eb9b['shift']());}}}(a126_0x2cc7,0xd740b));const a126_0x49c069=(function(){let _0x2ff2da=!![];return function(_0x473b2f,_0x559df6){const _0x436b87=_0x2ff2da?function(){const _0x31d1b7=a126_0x31bd;if(_0x559df6){const _0x133436=_0x559df6[_0x31d1b7(0x1da)](_0x473b2f,arguments);return _0x559df6=null,_0x133436;}}:function(){};return _0x2ff2da=![],_0x436b87;};}()),a126_0xcdcc26=a126_0x49c069(this,function(){const _0x35e460=a126_0x31bd;return a126_0xcdcc26[_0x35e460(0x1eb)]()[_0x35e460(0x1f1)]('(((.+)+)+)+$')[_0x35e460(0x1eb)]()[_0x35e460(0x203)](a126_0xcdcc26)[_0x35e460(0x1f1)]('(((.+)+)+)+$');});a126_0xcdcc26();function a126_0x2cc7(){const _0x4e859e=['apply','create\x20authorized\x20request\x20failed:\x20authorization\x20error','ERR_INVALID_SALESFORCE_TOKEN','defineProperty','instanceUrl','949363UhzuuE','requestConfig','default','data','__esModule','logger','accessToken','Error','SalesforceAuthService','salesforseSettings','Active','waitAuth','toString','59081GSJLKN','Logger','Service','setAuthDetails','services/data/','search','updateAccessToken','object','loginUrl','forceUpdateToken','../../shared/utils','1915544eyLdcX','token_type','force\x20update\x20token','Idle','AUTH_WAIT_TIME','access\x20token\x20updated\x20for\x20%s','../../shared/services/salesforce-settings.service','response','axios','instance_url','SalesforceSettingsService','sleep','constructor','settings','822dnbXuR','3caOjBr','decorate','function','10997793STDQbZ','orgId','800IOeZzR','message','metadata','SALESFORCE_API_VERSION','../errors/unauthorized-salesforce.error','6415696jaZAbC','joinURL','AuthState','access_token','../../../constants/errors','Updating','InvalidRefreshTokenError','refresh_token','55255WGutOH','__importDefault','authState','update\x20access\x20token\x20failed:\x20%s','error','log','tokenType','check\x20auth:\x20current\x20state\x20-\x20%s','8144lSkJme','length','3031gBKBix','../errors/invalid-refresh-token.error','getAuthData'];a126_0x2cc7=function(){return _0x4e859e;};return a126_0x2cc7();}'use strict';var __decorate=this&&this['__decorate']||function(_0xf33373,_0xf10399,_0x57424d,_0x31a1c7){const _0xd8cd4c=a126_0x31bd;var _0x55a450=arguments[_0xd8cd4c(0x1d6)],_0x303720=_0x55a450<0x3?_0xf10399:_0x31a1c7===null?_0x31a1c7=Object['getOwnPropertyDescriptor'](_0xf10399,_0x57424d):_0x31a1c7,_0x19e4f7;if(typeof Reflect===_0xd8cd4c(0x1f3)&&typeof Reflect[_0xd8cd4c(0x207)]==='function')_0x303720=Reflect[_0xd8cd4c(0x207)](_0xf33373,_0xf10399,_0x57424d,_0x31a1c7);else{for(var _0x3904fc=_0xf33373[_0xd8cd4c(0x1d6)]-0x1;_0x3904fc>=0x0;_0x3904fc--)if(_0x19e4f7=_0xf33373[_0x3904fc])_0x303720=(_0x55a450<0x3?_0x19e4f7(_0x303720):_0x55a450>0x3?_0x19e4f7(_0xf10399,_0x57424d,_0x303720):_0x19e4f7(_0xf10399,_0x57424d))||_0x303720;}return _0x55a450>0x3&&_0x303720&&Object[_0xd8cd4c(0x1dd)](_0xf10399,_0x57424d,_0x303720),_0x303720;},__metadata=this&&this['__metadata']||function(_0x12f673,_0xfe41b9){const _0x55fa05=a126_0x31bd;if(typeof Reflect===_0x55fa05(0x1f3)&&typeof Reflect[_0x55fa05(0x1c2)]===_0x55fa05(0x208))return Reflect[_0x55fa05(0x1c2)](_0x12f673,_0xfe41b9);},__importDefault=this&&this[a126_0x2e3f41(0x1ce)]||function(_0x42f16f){return _0x42f16f&&_0x42f16f['__esModule']?_0x42f16f:{'default':_0x42f16f};},SalesforceAuthService_1;Object[a126_0x2e3f41(0x1dd)](exports,a126_0x2e3f41(0x1e3),{'value':!![]}),exports[a126_0x2e3f41(0x1e7)]=void 0x0;const typedi_1=require('typedi'),errors_1=require(a126_0x2e3f41(0x1c9)),core_1=require('../../../core'),salesforce_settings_service_1=require(a126_0x2e3f41(0x1fd)),axios_1=__importDefault(require(a126_0x2e3f41(0x1ff))),utils_1=require(a126_0x2e3f41(0x1f6)),invalid_refresh_token_error_1=require(a126_0x2e3f41(0x1d8)),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require(a126_0x2e3f41(0x1c4)),constants_1=require('../../../constants');let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x1f20c0){const _0x13a712=a126_0x2e3f41;this['salesforseSettings']=_0x1f20c0,this[_0x13a712(0x1fb)]=0x1388,this[_0x13a712(0x1cf)]=auth_state_enum_1['AuthState'][_0x13a712(0x1fa)],this[_0x13a712(0x1e4)]=new core_1[(_0x13a712(0x1ed))](SalesforceAuthService_1['name']),this[_0x13a712(0x1ef)]();}get[a126_0x2e3f41(0x204)](){const _0x3b81bc=a126_0x2e3f41;return this['salesforseSettings'][_0x3b81bc(0x204)];}async[a126_0x2e3f41(0x1ef)](){const _0x2411af=a126_0x2e3f41;this[_0x2411af(0x1e4)]['log'](_0x2411af(0x1d4),auth_state_enum_1['AuthState'][this[_0x2411af(0x1cf)]]);try{if(this[_0x2411af(0x1cf)]===auth_state_enum_1[_0x2411af(0x1c7)][_0x2411af(0x1e6)])return;if(this[_0x2411af(0x1cf)]===auth_state_enum_1['AuthState'][_0x2411af(0x1fa)])await this[_0x2411af(0x1f2)]();else{const _0x25dc57=await this[_0x2411af(0x1e0)](),_0x5a9f3b=await axios_1[_0x2411af(0x1e1)]['get'](_0x2411af(0x1f0)+constants_1[_0x2411af(0x1c3)],_0x25dc57)['then'](()=>!![])['catch'](()=>![]);!_0x5a9f3b&&await this['updateAccessToken']();}}catch(_0x743d64){}}async['updateAccessToken'](){const _0x154f4f=a126_0x2e3f41;var _0x888473,_0x1b70dd,_0xe248b4;this[_0x154f4f(0x1e4)][_0x154f4f(0x1d2)]('update\x20access\x20token');try{this[_0x154f4f(0x1cf)]=auth_state_enum_1[_0x154f4f(0x1c7)][_0x154f4f(0x1ca)];const {refreshToken:_0x3f79b0,clientId:_0x12d49e,clientSecret:_0xda39ac}=this[_0x154f4f(0x204)],{data:_0x8ed74e}=await axios_1[_0x154f4f(0x1e1)]['post'](utils_1[_0x154f4f(0x1c6)](this[_0x154f4f(0x1e8)][_0x154f4f(0x1f4)],'/services/oauth2/token'),null,{'params':{'grant_type':_0x154f4f(0x1cc),'refresh_token':_0x3f79b0,'client_id':_0x12d49e,'client_secret':_0xda39ac}});this[_0x154f4f(0x1de)]=_0x8ed74e[_0x154f4f(0x200)],this[_0x154f4f(0x1e5)]=_0x8ed74e[_0x154f4f(0x1c8)],this[_0x154f4f(0x1d3)]=_0x8ed74e[_0x154f4f(0x1f8)],this[_0x154f4f(0x1cf)]=auth_state_enum_1['AuthState'][_0x154f4f(0x1e9)],this[_0x154f4f(0x1e4)][_0x154f4f(0x1d2)](_0x154f4f(0x1fc),this[_0x154f4f(0x1de)]);}catch(_0x35f9fe){const _0x4b9aa0=((_0x1b70dd=(_0x888473=_0x35f9fe===null||_0x35f9fe===void 0x0?void 0x0:_0x35f9fe[_0x154f4f(0x1fe)])===null||_0x888473===void 0x0?void 0x0:_0x888473[_0x154f4f(0x1e2)])===null||_0x1b70dd===void 0x0?void 0x0:_0x1b70dd['error'])||((_0xe248b4=_0x35f9fe===null||_0x35f9fe===void 0x0?void 0x0:_0x35f9fe[_0x154f4f(0x1fe)])===null||_0xe248b4===void 0x0?void 0x0:_0xe248b4[_0x154f4f(0x1e2)])||_0x35f9fe[_0x154f4f(0x1c1)];this[_0x154f4f(0x1e4)][_0x154f4f(0x1d1)](_0x154f4f(0x1d0),_0x4b9aa0),this[_0x154f4f(0x1cf)]=auth_state_enum_1[_0x154f4f(0x1c7)][_0x154f4f(0x1e6)];throw new invalid_refresh_token_error_1[(_0x154f4f(0x1cb))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async['forceUpdateToken'](){const _0x599c88=a126_0x2e3f41;this['logger']['log'](_0x599c88(0x1f9));if(this['authState']===auth_state_enum_1[_0x599c88(0x1c7)][_0x599c88(0x1ca)]||this[_0x599c88(0x1cf)]===auth_state_enum_1['AuthState'][_0x599c88(0x1fa)])return await utils_1[_0x599c88(0x202)](this[_0x599c88(0x1fb)]),this[_0x599c88(0x1f5)]();if(this['authState']===auth_state_enum_1['AuthState'][_0x599c88(0x1e6)])throw new invalid_refresh_token_error_1[(_0x599c88(0x1cb))](errors_1[_0x599c88(0x1dc)]);await this[_0x599c88(0x1f2)]();}async[a126_0x2e3f41(0x1ea)](){const _0x4d11bf=a126_0x2e3f41;if(this[_0x4d11bf(0x1cf)]===auth_state_enum_1[_0x4d11bf(0x1c7)][_0x4d11bf(0x1e6)]){this[_0x4d11bf(0x1e4)][_0x4d11bf(0x1d2)](_0x4d11bf(0x1db));throw new unauthorized_salesforce_error_1['UnauthorizedSalesforceError']();}if(this[_0x4d11bf(0x1cf)]!==auth_state_enum_1['AuthState'][_0x4d11bf(0x1e9)])return this[_0x4d11bf(0x1e4)][_0x4d11bf(0x1d2)]('create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done'),await utils_1[_0x4d11bf(0x202)](this[_0x4d11bf(0x1fb)]),this[_0x4d11bf(0x1ea)]();}[a126_0x2e3f41(0x1d9)](){const _0x51b291=a126_0x2e3f41;return{'orgId':this[_0x51b291(0x1bf)],'accessToken':this[_0x51b291(0x1e5)],'instanceUrl':this[_0x51b291(0x1de)]};}async['requestConfig'](){const _0x4f7aae=a126_0x2e3f41;return await this[_0x4f7aae(0x1ea)](),{'baseURL':this[_0x4f7aae(0x1de)],'headers':{'accept':'application/json','authorization':this[_0x4f7aae(0x1d3)]+'\x20'+this[_0x4f7aae(0x1e5)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1[a126_0x2e3f41(0x1ee)](),__metadata('design:paramtypes',[salesforce_settings_service_1[a126_0x2e3f41(0x201)]])],SalesforceAuthService),exports[a126_0x2e3f41(0x1e7)]=SalesforceAuthService;