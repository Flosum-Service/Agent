const a126_0x2e8891=a126_0x43e3;(function(_0x140d9d,_0x6ea9a5){const _0x1cf91c=a126_0x43e3,_0xe89fd5=_0x140d9d();while(!![]){try{const _0x554259=-parseInt(_0x1cf91c(0xd7))/0x1*(parseInt(_0x1cf91c(0x107))/0x2)+parseInt(_0x1cf91c(0x105))/0x3*(-parseInt(_0x1cf91c(0xfe))/0x4)+parseInt(_0x1cf91c(0xfc))/0x5+-parseInt(_0x1cf91c(0xcc))/0x6*(-parseInt(_0x1cf91c(0xcb))/0x7)+-parseInt(_0x1cf91c(0xd3))/0x8+parseInt(_0x1cf91c(0xc9))/0x9+parseInt(_0x1cf91c(0xbd))/0xa*(parseInt(_0x1cf91c(0x106))/0xb);if(_0x554259===_0x6ea9a5)break;else _0xe89fd5['push'](_0xe89fd5['shift']());}catch(_0xb164e6){_0xe89fd5['push'](_0xe89fd5['shift']());}}}(a126_0x4d5c,0xaedff));function a126_0x4d5c(){const _0x209882=['sleep','instance_url','defineProperty','waitAuth','SALESFORCE_API_VERSION','Idle','Error','constructor','88260SXpLHG','then','4HWbETb','typedi','loginUrl','../enums/auth-state.enum','catch','AUTH_WAIT_TIME','toString','2723814Xisypx','12996467xRTpvA','78mXrBLu','default','__esModule','update\x20access\x20token','requestConfig','length','axios','create\x20authorized\x20request\x20failed:\x20authorization\x20error','application/json','message','design:paramtypes','10NOratN','../../shared/utils','__importDefault','SalesforceSettingsService','../../../core','updateAccessToken','logger','accessToken','Updating','Active','(((.+)+)+)+$','search','7075620ymotgi','joinURL','312536TPAqWV','168cotBRT','orgId','data','../../../constants','error','settings','name','4534936NLeCCE','forceUpdateToken','decorate','response','26779PrSbXZ','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','getAuthData','../../../constants/errors','update\x20access\x20token\x20failed:\x20%s','__decorate','tokenType','InvalidRefreshTokenError','__metadata','/services/oauth2/token','force\x20update\x20token','token_type','UnauthorizedSalesforceError','access\x20token\x20updated\x20for\x20%s','refresh_token','function','metadata','SalesforceAuthService','AuthState','../errors/unauthorized-salesforce.error','access_token','instanceUrl','object','ERR_INVALID_SALESFORCE_TOKEN','log','authState','salesforseSettings','../../shared/services/salesforce-settings.service','services/data/'];a126_0x4d5c=function(){return _0x209882;};return a126_0x4d5c();}const a126_0x44988b=(function(){let _0x2f60c9=!![];return function(_0x2f9e5e,_0xca2175){const _0x19ebd4=_0x2f60c9?function(){if(_0xca2175){const _0x59d0db=_0xca2175['apply'](_0x2f9e5e,arguments);return _0xca2175=null,_0x59d0db;}}:function(){};return _0x2f60c9=![],_0x19ebd4;};}()),a126_0x426aad=a126_0x44988b(this,function(){const _0x3ebc47=a126_0x43e3;return a126_0x426aad[_0x3ebc47(0x104)]()[_0x3ebc47(0xc8)](_0x3ebc47(0xc7))[_0x3ebc47(0x104)]()[_0x3ebc47(0xfb)](a126_0x426aad)[_0x3ebc47(0xc8)](_0x3ebc47(0xc7));});a126_0x426aad();function a126_0x43e3(_0x49cbc7,_0x41e3ef){const _0x365757=a126_0x4d5c();return a126_0x43e3=function(_0x426aad,_0x44988b){_0x426aad=_0x426aad-0xb4;let _0x4d5cc6=_0x365757[_0x426aad];return _0x4d5cc6;},a126_0x43e3(_0x49cbc7,_0x41e3ef);}'use strict';var __decorate=this&&this[a126_0x2e8891(0xdc)]||function(_0x25d4f5,_0x4b1208,_0x3f7539,_0x5cba61){const _0x5e54ee=a126_0x2e8891;var _0x4b8265=arguments['length'],_0x57ef5d=_0x4b8265<0x3?_0x4b1208:_0x5cba61===null?_0x5cba61=Object['getOwnPropertyDescriptor'](_0x4b1208,_0x3f7539):_0x5cba61,_0x5270c9;if(typeof Reflect===_0x5e54ee(0xed)&&typeof Reflect[_0x5e54ee(0xd5)]===_0x5e54ee(0xe6))_0x57ef5d=Reflect['decorate'](_0x25d4f5,_0x4b1208,_0x3f7539,_0x5cba61);else{for(var _0xcd1713=_0x25d4f5[_0x5e54ee(0xb7)]-0x1;_0xcd1713>=0x0;_0xcd1713--)if(_0x5270c9=_0x25d4f5[_0xcd1713])_0x57ef5d=(_0x4b8265<0x3?_0x5270c9(_0x57ef5d):_0x4b8265>0x3?_0x5270c9(_0x4b1208,_0x3f7539,_0x57ef5d):_0x5270c9(_0x4b1208,_0x3f7539))||_0x57ef5d;}return _0x4b8265>0x3&&_0x57ef5d&&Object[_0x5e54ee(0xf6)](_0x4b1208,_0x3f7539,_0x57ef5d),_0x57ef5d;},__metadata=this&&this[a126_0x2e8891(0xdf)]||function(_0x572b31,_0x4a9003){const _0x5182b9=a126_0x2e8891;if(typeof Reflect===_0x5182b9(0xed)&&typeof Reflect[_0x5182b9(0xe7)]===_0x5182b9(0xe6))return Reflect[_0x5182b9(0xe7)](_0x572b31,_0x4a9003);},__importDefault=this&&this[a126_0x2e8891(0xbf)]||function(_0x544ac9){const _0x20e458=a126_0x2e8891;return _0x544ac9&&_0x544ac9[_0x20e458(0xb4)]?_0x544ac9:{'default':_0x544ac9};},SalesforceAuthService_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a126_0x2e8891(0xe8)]=void 0x0;const typedi_1=require(a126_0x2e8891(0xff)),errors_1=require(a126_0x2e8891(0xda)),core_1=require(a126_0x2e8891(0xc1)),salesforce_settings_service_1=require(a126_0x2e8891(0xf2)),axios_1=__importDefault(require(a126_0x2e8891(0xb8))),utils_1=require(a126_0x2e8891(0xbe)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require(a126_0x2e8891(0x101)),unauthorized_salesforce_error_1=require(a126_0x2e8891(0xea)),constants_1=require(a126_0x2e8891(0xcf));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x746126){const _0xdcc12d=a126_0x2e8891;this[_0xdcc12d(0xf1)]=_0x746126,this['AUTH_WAIT_TIME']=0x1388,this[_0xdcc12d(0xf0)]=auth_state_enum_1['AuthState'][_0xdcc12d(0xf9)],this[_0xdcc12d(0xc3)]=new core_1['Logger'](SalesforceAuthService_1[_0xdcc12d(0xd2)]),this['setAuthDetails']();}get['settings'](){const _0x2c85e4=a126_0x2e8891;return this['salesforseSettings'][_0x2c85e4(0xd1)];}async['setAuthDetails'](){const _0x1e7e33=a126_0x2e8891;this[_0x1e7e33(0xc3)][_0x1e7e33(0xef)]('check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1['AuthState'][this[_0x1e7e33(0xf0)]]);try{if(this['authState']===auth_state_enum_1['AuthState'][_0x1e7e33(0xfa)])return;if(this[_0x1e7e33(0xf0)]===auth_state_enum_1[_0x1e7e33(0xe9)]['Idle'])await this[_0x1e7e33(0xc2)]();else{const _0x4e22a6=await this[_0x1e7e33(0xb6)](),_0x5f0cc3=await axios_1[_0x1e7e33(0x108)]['get'](_0x1e7e33(0xf3)+constants_1[_0x1e7e33(0xf8)],_0x4e22a6)[_0x1e7e33(0xfd)](()=>!![])[_0x1e7e33(0x102)](()=>![]);!_0x5f0cc3&&await this[_0x1e7e33(0xc2)]();}}catch(_0xd16832){}}async[a126_0x2e8891(0xc2)](){const _0x54b334=a126_0x2e8891;var _0x1a9829,_0x3b4f83,_0x37e0ce;this['logger']['log'](_0x54b334(0xb5));try{this[_0x54b334(0xf0)]=auth_state_enum_1['AuthState'][_0x54b334(0xc5)];const {refreshToken:_0x6941e2,clientId:_0x278f90,clientSecret:_0x191180}=this['settings'],{data:_0x486680}=await axios_1[_0x54b334(0x108)]['post'](utils_1[_0x54b334(0xca)](this[_0x54b334(0xf1)][_0x54b334(0x100)],_0x54b334(0xe0)),null,{'params':{'grant_type':_0x54b334(0xe5),'refresh_token':_0x6941e2,'client_id':_0x278f90,'client_secret':_0x191180}});this[_0x54b334(0xec)]=_0x486680[_0x54b334(0xf5)],this[_0x54b334(0xc4)]=_0x486680[_0x54b334(0xeb)],this[_0x54b334(0xdd)]=_0x486680[_0x54b334(0xe2)],this[_0x54b334(0xf0)]=auth_state_enum_1[_0x54b334(0xe9)][_0x54b334(0xc6)],this[_0x54b334(0xc3)][_0x54b334(0xef)](_0x54b334(0xe4),this[_0x54b334(0xec)]);}catch(_0x22e977){const _0x4719fc=((_0x3b4f83=(_0x1a9829=_0x22e977===null||_0x22e977===void 0x0?void 0x0:_0x22e977['response'])===null||_0x1a9829===void 0x0?void 0x0:_0x1a9829[_0x54b334(0xce)])===null||_0x3b4f83===void 0x0?void 0x0:_0x3b4f83[_0x54b334(0xd0)])||((_0x37e0ce=_0x22e977===null||_0x22e977===void 0x0?void 0x0:_0x22e977[_0x54b334(0xd6)])===null||_0x37e0ce===void 0x0?void 0x0:_0x37e0ce[_0x54b334(0xce)])||_0x22e977[_0x54b334(0xbb)];this['logger']['error'](_0x54b334(0xdb),_0x4719fc),this[_0x54b334(0xf0)]=auth_state_enum_1['AuthState'][_0x54b334(0xfa)];throw new invalid_refresh_token_error_1[(_0x54b334(0xde))](errors_1[_0x54b334(0xee)]);}}async[a126_0x2e8891(0xd4)](){const _0x57f89b=a126_0x2e8891;this[_0x57f89b(0xc3)]['log'](_0x57f89b(0xe1));if(this[_0x57f89b(0xf0)]===auth_state_enum_1[_0x57f89b(0xe9)]['Updating']||this[_0x57f89b(0xf0)]===auth_state_enum_1[_0x57f89b(0xe9)][_0x57f89b(0xf9)])return await utils_1[_0x57f89b(0xf4)](this[_0x57f89b(0x103)]),this[_0x57f89b(0xd4)]();if(this[_0x57f89b(0xf0)]===auth_state_enum_1[_0x57f89b(0xe9)][_0x57f89b(0xfa)])throw new invalid_refresh_token_error_1[(_0x57f89b(0xde))](errors_1[_0x57f89b(0xee)]);await this[_0x57f89b(0xc2)]();}async[a126_0x2e8891(0xf7)](){const _0x1c2fd4=a126_0x2e8891;if(this[_0x1c2fd4(0xf0)]===auth_state_enum_1[_0x1c2fd4(0xe9)][_0x1c2fd4(0xfa)]){this['logger'][_0x1c2fd4(0xef)](_0x1c2fd4(0xb9));throw new unauthorized_salesforce_error_1[(_0x1c2fd4(0xe3))]();}if(this[_0x1c2fd4(0xf0)]!==auth_state_enum_1['AuthState'][_0x1c2fd4(0xc6)])return this[_0x1c2fd4(0xc3)][_0x1c2fd4(0xef)](_0x1c2fd4(0xd8)),await utils_1[_0x1c2fd4(0xf4)](this[_0x1c2fd4(0x103)]),this[_0x1c2fd4(0xf7)]();}[a126_0x2e8891(0xd9)](){const _0x510cf6=a126_0x2e8891;return{'orgId':this[_0x510cf6(0xcd)],'accessToken':this[_0x510cf6(0xc4)],'instanceUrl':this['instanceUrl']};}async[a126_0x2e8891(0xb6)](){const _0x4e5a8a=a126_0x2e8891;return await this[_0x4e5a8a(0xf7)](),{'baseURL':this[_0x4e5a8a(0xec)],'headers':{'accept':_0x4e5a8a(0xba),'authorization':this[_0x4e5a8a(0xdd)]+'\x20'+this['accessToken']}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1['Service'](),__metadata(a126_0x2e8891(0xbc),[salesforce_settings_service_1[a126_0x2e8891(0xc0)]])],SalesforceAuthService),exports[a126_0x2e8891(0xe8)]=SalesforceAuthService;