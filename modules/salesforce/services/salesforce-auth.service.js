function a125_0x51fb(_0x46222b,_0x4b69f4){const _0x568e73=a125_0x39a3();return a125_0x51fb=function(_0x3b6323,_0x4cf939){_0x3b6323=_0x3b6323-0xed;let _0x39a3ec=_0x568e73[_0x3b6323];return _0x39a3ec;},a125_0x51fb(_0x46222b,_0x4b69f4);}const a125_0x4f772e=a125_0x51fb;(function(_0x124bab,_0x430f93){const _0x1b161f=a125_0x51fb,_0xe3a6c5=_0x124bab();while(!![]){try{const _0x2b03f3=-parseInt(_0x1b161f(0x127))/0x1+-parseInt(_0x1b161f(0x10e))/0x2*(-parseInt(_0x1b161f(0x12f))/0x3)+parseInt(_0x1b161f(0x12d))/0x4+parseInt(_0x1b161f(0x100))/0x5*(-parseInt(_0x1b161f(0xfa))/0x6)+-parseInt(_0x1b161f(0x103))/0x7+-parseInt(_0x1b161f(0x135))/0x8+parseInt(_0x1b161f(0x11e))/0x9*(parseInt(_0x1b161f(0x107))/0xa);if(_0x2b03f3===_0x430f93)break;else _0xe3a6c5['push'](_0xe3a6c5['shift']());}catch(_0x518e43){_0xe3a6c5['push'](_0xe3a6c5['shift']());}}}(a125_0x39a3,0xc5b24));const a125_0x4cf939=(function(){let _0x2dd03d=!![];return function(_0x5de617,_0x36fc9d){const _0x15aabd=_0x2dd03d?function(){const _0x5d84a4=a125_0x51fb;if(_0x36fc9d){const _0x3acbe1=_0x36fc9d[_0x5d84a4(0xed)](_0x5de617,arguments);return _0x36fc9d=null,_0x3acbe1;}}:function(){};return _0x2dd03d=![],_0x15aabd;};}()),a125_0x3b6323=a125_0x4cf939(this,function(){const _0x23c130=a125_0x51fb;return a125_0x3b6323[_0x23c130(0x121)]()[_0x23c130(0x102)](_0x23c130(0x112))[_0x23c130(0x121)]()['constructor'](a125_0x3b6323)['search']('(((.+)+)+)+$');});a125_0x3b6323();'use strict';function a125_0x39a3(){const _0x1d8e04=['__importDefault','getAuthData','name','forceUpdateToken','logger','../../../constants','application/json','joinURL','Updating','6782634fBzeGq','typedi','../../../core','toString','waitAuth','orgId','AuthState','refresh_token','settings','1187848XVohwh','AUTH_WAIT_TIME','InvalidRefreshTokenError','function','token_type','access\x20token\x20updated\x20for\x20%s','396236bLlojD','default','9THZEUJ','salesforseSettings','catch','Idle','decorate','__metadata','7767376BDOfES','length','/services/oauth2/token','design:paramtypes','instanceUrl','response','check\x20auth:\x20current\x20state\x20-\x20%s','apply','../errors/invalid-refresh-token.error','defineProperty','force\x20update\x20token','__esModule','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','get','instance_url','object','log','update\x20access\x20token','updateAccessToken','services/data/','918pwcNoj','SalesforceAuthService','ERR_INVALID_SALESFORCE_TOKEN','../../shared/services/salesforce-settings.service','data','Error','46590CbPSdQ','tokenType','search','528024axhjsb','axios','../../shared/utils','sleep','40QgGTLB','Service','loginUrl','metadata','update\x20access\x20token\x20failed:\x20%s','getOwnPropertyDescriptor','requestConfig','904038zEPyOv','authState','accessToken','../errors/unauthorized-salesforce.error','(((.+)+)+)+$','error','access_token'];a125_0x39a3=function(){return _0x1d8e04;};return a125_0x39a3();}var __decorate=this&&this['__decorate']||function(_0x1cc9f9,_0x44a0e5,_0x22c95e,_0x37a2fc){const _0x56ddf8=a125_0x51fb;var _0x858eed=arguments['length'],_0x1c00db=_0x858eed<0x3?_0x44a0e5:_0x37a2fc===null?_0x37a2fc=Object[_0x56ddf8(0x10c)](_0x44a0e5,_0x22c95e):_0x37a2fc,_0x3ba6f1;if(typeof Reflect==='object'&&typeof Reflect[_0x56ddf8(0x133)]===_0x56ddf8(0x12a))_0x1c00db=Reflect[_0x56ddf8(0x133)](_0x1cc9f9,_0x44a0e5,_0x22c95e,_0x37a2fc);else{for(var _0x4cfd03=_0x1cc9f9[_0x56ddf8(0x136)]-0x1;_0x4cfd03>=0x0;_0x4cfd03--)if(_0x3ba6f1=_0x1cc9f9[_0x4cfd03])_0x1c00db=(_0x858eed<0x3?_0x3ba6f1(_0x1c00db):_0x858eed>0x3?_0x3ba6f1(_0x44a0e5,_0x22c95e,_0x1c00db):_0x3ba6f1(_0x44a0e5,_0x22c95e))||_0x1c00db;}return _0x858eed>0x3&&_0x1c00db&&Object['defineProperty'](_0x44a0e5,_0x22c95e,_0x1c00db),_0x1c00db;},__metadata=this&&this[a125_0x4f772e(0x134)]||function(_0x4503f7,_0x3fe72c){const _0x595c2d=a125_0x4f772e;if(typeof Reflect===_0x595c2d(0xf5)&&typeof Reflect[_0x595c2d(0x10a)]===_0x595c2d(0x12a))return Reflect[_0x595c2d(0x10a)](_0x4503f7,_0x3fe72c);},__importDefault=this&&this[a125_0x4f772e(0x115)]||function(_0x3936cc){const _0x1d8cd2=a125_0x4f772e;return _0x3936cc&&_0x3936cc[_0x1d8cd2(0xf1)]?_0x3936cc:{'default':_0x3936cc};},SalesforceAuthService_1;Object[a125_0x4f772e(0xef)](exports,a125_0x4f772e(0xf1),{'value':!![]}),exports[a125_0x4f772e(0xfb)]=void 0x0;const typedi_1=require(a125_0x4f772e(0x11f)),errors_1=require('../../../constants/errors'),core_1=require(a125_0x4f772e(0x120)),salesforce_settings_service_1=require(a125_0x4f772e(0xfd)),axios_1=__importDefault(require(a125_0x4f772e(0x104))),utils_1=require(a125_0x4f772e(0x105)),invalid_refresh_token_error_1=require(a125_0x4f772e(0xee)),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require(a125_0x4f772e(0x111)),constants_1=require(a125_0x4f772e(0x11a));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x1923b8){const _0x147453=a125_0x4f772e;this['salesforseSettings']=_0x1923b8,this[_0x147453(0x128)]=0x1388,this[_0x147453(0x10f)]=auth_state_enum_1[_0x147453(0x124)]['Idle'],this[_0x147453(0x119)]=new core_1['Logger'](SalesforceAuthService_1[_0x147453(0x117)]),this['setAuthDetails']();}get[a125_0x4f772e(0x126)](){const _0x4bea9b=a125_0x4f772e;return this[_0x4bea9b(0x130)][_0x4bea9b(0x126)];}async['setAuthDetails'](){const _0x4a69fe=a125_0x4f772e;this[_0x4a69fe(0x119)][_0x4a69fe(0xf6)](_0x4a69fe(0x13b),auth_state_enum_1[_0x4a69fe(0x124)][this[_0x4a69fe(0x10f)]]);try{if(this[_0x4a69fe(0x10f)]===auth_state_enum_1[_0x4a69fe(0x124)][_0x4a69fe(0xff)])return;if(this[_0x4a69fe(0x10f)]===auth_state_enum_1[_0x4a69fe(0x124)]['Idle'])await this[_0x4a69fe(0xf8)]();else{const _0x5bcaed=await this[_0x4a69fe(0x10d)](),_0x34815a=await axios_1[_0x4a69fe(0x12e)][_0x4a69fe(0xf3)](_0x4a69fe(0xf9)+constants_1['SALESFORCE_API_VERSION'],_0x5bcaed)['then'](()=>!![])[_0x4a69fe(0x131)](()=>![]);!_0x34815a&&await this['updateAccessToken']();}}catch(_0x2c4dd9){}}async['updateAccessToken'](){const _0x314c56=a125_0x4f772e;var _0x3be8bb,_0x439ba5,_0x3f73c7;this[_0x314c56(0x119)][_0x314c56(0xf6)](_0x314c56(0xf7));try{this['authState']=auth_state_enum_1[_0x314c56(0x124)]['Updating'];const {refreshToken:_0x4618f3,clientId:_0x31cdb5,clientSecret:_0x5b6b73}=this[_0x314c56(0x126)],{data:_0xfb1d76}=await axios_1['default']['post'](utils_1[_0x314c56(0x11c)](this[_0x314c56(0x130)][_0x314c56(0x109)],_0x314c56(0x137)),null,{'params':{'grant_type':_0x314c56(0x125),'refresh_token':_0x4618f3,'client_id':_0x31cdb5,'client_secret':_0x5b6b73}});this['instanceUrl']=_0xfb1d76[_0x314c56(0xf4)],this[_0x314c56(0x110)]=_0xfb1d76[_0x314c56(0x114)],this['tokenType']=_0xfb1d76[_0x314c56(0x12b)],this[_0x314c56(0x10f)]=auth_state_enum_1[_0x314c56(0x124)]['Active'],this[_0x314c56(0x119)][_0x314c56(0xf6)](_0x314c56(0x12c),this[_0x314c56(0x139)]);}catch(_0x36e9cc){const _0x5f4c99=((_0x439ba5=(_0x3be8bb=_0x36e9cc===null||_0x36e9cc===void 0x0?void 0x0:_0x36e9cc['response'])===null||_0x3be8bb===void 0x0?void 0x0:_0x3be8bb['data'])===null||_0x439ba5===void 0x0?void 0x0:_0x439ba5[_0x314c56(0x113)])||((_0x3f73c7=_0x36e9cc===null||_0x36e9cc===void 0x0?void 0x0:_0x36e9cc[_0x314c56(0x13a)])===null||_0x3f73c7===void 0x0?void 0x0:_0x3f73c7[_0x314c56(0xfe)])||_0x36e9cc['message'];this['logger'][_0x314c56(0x113)](_0x314c56(0x10b),_0x5f4c99),this[_0x314c56(0x10f)]=auth_state_enum_1[_0x314c56(0x124)][_0x314c56(0xff)];throw new invalid_refresh_token_error_1[(_0x314c56(0x129))](errors_1[_0x314c56(0xfc)]);}}async['forceUpdateToken'](){const _0x5825da=a125_0x4f772e;this[_0x5825da(0x119)]['log'](_0x5825da(0xf0));if(this[_0x5825da(0x10f)]===auth_state_enum_1['AuthState'][_0x5825da(0x11d)]||this[_0x5825da(0x10f)]===auth_state_enum_1[_0x5825da(0x124)][_0x5825da(0x132)])return await utils_1[_0x5825da(0x106)](this['AUTH_WAIT_TIME']),this[_0x5825da(0x118)]();if(this[_0x5825da(0x10f)]===auth_state_enum_1[_0x5825da(0x124)][_0x5825da(0xff)])throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this['updateAccessToken']();}async[a125_0x4f772e(0x122)](){const _0x3aaca2=a125_0x4f772e;if(this[_0x3aaca2(0x10f)]===auth_state_enum_1[_0x3aaca2(0x124)]['Error']){this['logger']['log']('create\x20authorized\x20request\x20failed:\x20authorization\x20error');throw new unauthorized_salesforce_error_1['UnauthorizedSalesforceError']();}if(this[_0x3aaca2(0x10f)]!==auth_state_enum_1['AuthState']['Active'])return this[_0x3aaca2(0x119)]['log'](_0x3aaca2(0xf2)),await utils_1[_0x3aaca2(0x106)](this['AUTH_WAIT_TIME']),this[_0x3aaca2(0x122)]();}[a125_0x4f772e(0x116)](){const _0x2e1a86=a125_0x4f772e;return{'orgId':this[_0x2e1a86(0x123)],'accessToken':this[_0x2e1a86(0x110)],'instanceUrl':this['instanceUrl']};}async[a125_0x4f772e(0x10d)](){const _0x1f8c0c=a125_0x4f772e;return await this[_0x1f8c0c(0x122)](),{'baseURL':this[_0x1f8c0c(0x139)],'headers':{'accept':_0x1f8c0c(0x11b),'authorization':this[_0x1f8c0c(0x101)]+'\x20'+this[_0x1f8c0c(0x110)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1[a125_0x4f772e(0x108)](),__metadata(a125_0x4f772e(0x138),[salesforce_settings_service_1['SalesforceSettingsService']])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;