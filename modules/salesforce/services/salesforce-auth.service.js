const a126_0x1fed49=a126_0x592c;function a126_0x592c(_0x506218,_0x25fa88){const _0x339cf5=a126_0x29d2();return a126_0x592c=function(_0x575209,_0x97b3d8){_0x575209=_0x575209-0x15a;let _0x29d2ac=_0x339cf5[_0x575209];return _0x29d2ac;},a126_0x592c(_0x506218,_0x25fa88);}(function(_0x1dba4c,_0x4a4f9c){const _0x558f81=a126_0x592c,_0x5719a4=_0x1dba4c();while(!![]){try{const _0x5c5012=-parseInt(_0x558f81(0x160))/0x1+parseInt(_0x558f81(0x193))/0x2*(-parseInt(_0x558f81(0x1a4))/0x3)+-parseInt(_0x558f81(0x16d))/0x4+parseInt(_0x558f81(0x186))/0x5*(-parseInt(_0x558f81(0x188))/0x6)+-parseInt(_0x558f81(0x16c))/0x7+-parseInt(_0x558f81(0x195))/0x8+parseInt(_0x558f81(0x163))/0x9*(parseInt(_0x558f81(0x19c))/0xa);if(_0x5c5012===_0x4a4f9c)break;else _0x5719a4['push'](_0x5719a4['shift']());}catch(_0x3095a2){_0x5719a4['push'](_0x5719a4['shift']());}}}(a126_0x29d2,0xd14ba));const a126_0x97b3d8=(function(){let _0x2ca1d9=!![];return function(_0x45430a,_0x481498){const _0x2f73b8=_0x2ca1d9?function(){const _0x1094e6=a126_0x592c;if(_0x481498){const _0xe0f8f2=_0x481498[_0x1094e6(0x15d)](_0x45430a,arguments);return _0x481498=null,_0xe0f8f2;}}:function(){};return _0x2ca1d9=![],_0x2f73b8;};}()),a126_0x575209=a126_0x97b3d8(this,function(){const _0x1fe59b=a126_0x592c;return a126_0x575209[_0x1fe59b(0x1a5)]()[_0x1fe59b(0x15c)](_0x1fe59b(0x176))['toString']()[_0x1fe59b(0x199)](a126_0x575209)['search'](_0x1fe59b(0x176));});function a126_0x29d2(){const _0x1a4f4b=['instance_url','31150AUuLcj','metadata','762QhwtKR','Error','error','settings','authState','SalesforceSettingsService','typedi','log','AuthState','getOwnPropertyDescriptor','accessToken','6278PuunQn','length','6369152OLthhz','data','__decorate','SalesforceAuthService','constructor','decorate','post','60970430NTBACJ','tokenType','access\x20token\x20updated\x20for\x20%s','Updating','function','services/data/','force\x20update\x20token','check\x20auth:\x20current\x20state\x20-\x20%s','1002IqyMuR','toString','create\x20authorized\x20request\x20failed:\x20authorization\x20error','requestConfig','object','updateAccessToken','../../../core','../../../constants','token_type','search','apply','../../shared/services/salesforce-settings.service','UnauthorizedSalesforceError','81665QosBpK','ERR_INVALID_SALESFORCE_TOKEN','__importDefault','9iSTgpU','waitAuth','Active','response','joinURL','defineProperty','sleep','Logger','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','6756589iJyUaP','6228388ZzHuDO','orgId','AUTH_WAIT_TIME','loginUrl','get','SALESFORCE_API_VERSION','salesforseSettings','InvalidRefreshTokenError','__metadata','(((.+)+)+)+$','catch','update\x20access\x20token\x20failed:\x20%s','instanceUrl','name','__esModule','message','../../../constants/errors','application/json','../../shared/utils','/services/oauth2/token','setAuthDetails','default','logger','Idle'];a126_0x29d2=function(){return _0x1a4f4b;};return a126_0x29d2();}a126_0x575209();'use strict';var __decorate=this&&this[a126_0x1fed49(0x197)]||function(_0x3e3261,_0x9127e5,_0x2aeea,_0x5f18ed){const _0xafe460=a126_0x1fed49;var _0x3539=arguments[_0xafe460(0x194)],_0x27d719=_0x3539<0x3?_0x9127e5:_0x5f18ed===null?_0x5f18ed=Object[_0xafe460(0x191)](_0x9127e5,_0x2aeea):_0x5f18ed,_0x8c34a3;if(typeof Reflect===_0xafe460(0x1a8)&&typeof Reflect[_0xafe460(0x19a)]===_0xafe460(0x1a0))_0x27d719=Reflect[_0xafe460(0x19a)](_0x3e3261,_0x9127e5,_0x2aeea,_0x5f18ed);else{for(var _0x40c7ad=_0x3e3261['length']-0x1;_0x40c7ad>=0x0;_0x40c7ad--)if(_0x8c34a3=_0x3e3261[_0x40c7ad])_0x27d719=(_0x3539<0x3?_0x8c34a3(_0x27d719):_0x3539>0x3?_0x8c34a3(_0x9127e5,_0x2aeea,_0x27d719):_0x8c34a3(_0x9127e5,_0x2aeea))||_0x27d719;}return _0x3539>0x3&&_0x27d719&&Object[_0xafe460(0x168)](_0x9127e5,_0x2aeea,_0x27d719),_0x27d719;},__metadata=this&&this[a126_0x1fed49(0x175)]||function(_0xc5bb8d,_0x29ed25){const _0x3f8bb9=a126_0x1fed49;if(typeof Reflect===_0x3f8bb9(0x1a8)&&typeof Reflect['metadata']===_0x3f8bb9(0x1a0))return Reflect[_0x3f8bb9(0x187)](_0xc5bb8d,_0x29ed25);},__importDefault=this&&this[a126_0x1fed49(0x162)]||function(_0x387d95){return _0x387d95&&_0x387d95['__esModule']?_0x387d95:{'default':_0x387d95};},SalesforceAuthService_1;Object['defineProperty'](exports,a126_0x1fed49(0x17b),{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=require(a126_0x1fed49(0x18e)),errors_1=require(a126_0x1fed49(0x17d)),core_1=require(a126_0x1fed49(0x1aa)),salesforce_settings_service_1=require(a126_0x1fed49(0x15e)),axios_1=__importDefault(require('axios')),utils_1=require(a126_0x1fed49(0x17f)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a126_0x1fed49(0x15a));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x842ef8){const _0x34bdeb=a126_0x1fed49;this[_0x34bdeb(0x173)]=_0x842ef8,this[_0x34bdeb(0x16f)]=0x1388,this[_0x34bdeb(0x18c)]=auth_state_enum_1[_0x34bdeb(0x190)][_0x34bdeb(0x184)],this['logger']=new core_1[(_0x34bdeb(0x16a))](SalesforceAuthService_1[_0x34bdeb(0x17a)]),this[_0x34bdeb(0x181)]();}get[a126_0x1fed49(0x18b)](){const _0x17feeb=a126_0x1fed49;return this['salesforseSettings'][_0x17feeb(0x18b)];}async[a126_0x1fed49(0x181)](){const _0x228d79=a126_0x1fed49;this[_0x228d79(0x183)][_0x228d79(0x18f)](_0x228d79(0x1a3),auth_state_enum_1['AuthState'][this[_0x228d79(0x18c)]]);try{if(this[_0x228d79(0x18c)]===auth_state_enum_1[_0x228d79(0x190)][_0x228d79(0x189)])return;if(this[_0x228d79(0x18c)]===auth_state_enum_1['AuthState'][_0x228d79(0x184)])await this[_0x228d79(0x1a9)]();else{const _0x45e62a=await this[_0x228d79(0x1a7)](),_0x466d8f=await axios_1[_0x228d79(0x182)][_0x228d79(0x171)](_0x228d79(0x1a1)+constants_1[_0x228d79(0x172)],_0x45e62a)['then'](()=>!![])[_0x228d79(0x177)](()=>![]);!_0x466d8f&&await this[_0x228d79(0x1a9)]();}}catch(_0x830e87){}}async[a126_0x1fed49(0x1a9)](){const _0x352b9d=a126_0x1fed49;var _0x2a08be,_0x45f2d5,_0x5aca38;this[_0x352b9d(0x183)][_0x352b9d(0x18f)]('update\x20access\x20token');try{this[_0x352b9d(0x18c)]=auth_state_enum_1[_0x352b9d(0x190)][_0x352b9d(0x19f)];const {refreshToken:_0x27cc88,clientId:_0x5bb77c,clientSecret:_0x2542dd}=this[_0x352b9d(0x18b)],{data:_0x271d8a}=await axios_1[_0x352b9d(0x182)][_0x352b9d(0x19b)](utils_1[_0x352b9d(0x167)](this[_0x352b9d(0x173)][_0x352b9d(0x170)],_0x352b9d(0x180)),null,{'params':{'grant_type':'refresh_token','refresh_token':_0x27cc88,'client_id':_0x5bb77c,'client_secret':_0x2542dd}});this['instanceUrl']=_0x271d8a[_0x352b9d(0x185)],this['accessToken']=_0x271d8a['access_token'],this[_0x352b9d(0x19d)]=_0x271d8a[_0x352b9d(0x15b)],this['authState']=auth_state_enum_1[_0x352b9d(0x190)][_0x352b9d(0x165)],this[_0x352b9d(0x183)][_0x352b9d(0x18f)](_0x352b9d(0x19e),this[_0x352b9d(0x179)]);}catch(_0x119c52){const _0x3222c2=((_0x45f2d5=(_0x2a08be=_0x119c52===null||_0x119c52===void 0x0?void 0x0:_0x119c52[_0x352b9d(0x166)])===null||_0x2a08be===void 0x0?void 0x0:_0x2a08be['data'])===null||_0x45f2d5===void 0x0?void 0x0:_0x45f2d5['error'])||((_0x5aca38=_0x119c52===null||_0x119c52===void 0x0?void 0x0:_0x119c52[_0x352b9d(0x166)])===null||_0x5aca38===void 0x0?void 0x0:_0x5aca38[_0x352b9d(0x196)])||_0x119c52[_0x352b9d(0x17c)];this[_0x352b9d(0x183)][_0x352b9d(0x18a)](_0x352b9d(0x178),_0x3222c2),this[_0x352b9d(0x18c)]=auth_state_enum_1['AuthState']['Error'];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x352b9d(0x161)]);}}async['forceUpdateToken'](){const _0x3a4f28=a126_0x1fed49;this[_0x3a4f28(0x183)]['log'](_0x3a4f28(0x1a2));if(this['authState']===auth_state_enum_1[_0x3a4f28(0x190)][_0x3a4f28(0x19f)]||this[_0x3a4f28(0x18c)]===auth_state_enum_1[_0x3a4f28(0x190)][_0x3a4f28(0x184)])return await utils_1['sleep'](this[_0x3a4f28(0x16f)]),this['forceUpdateToken']();if(this[_0x3a4f28(0x18c)]===auth_state_enum_1[_0x3a4f28(0x190)][_0x3a4f28(0x189)])throw new invalid_refresh_token_error_1[(_0x3a4f28(0x174))](errors_1[_0x3a4f28(0x161)]);await this[_0x3a4f28(0x1a9)]();}async[a126_0x1fed49(0x164)](){const _0x2ea7b4=a126_0x1fed49;if(this[_0x2ea7b4(0x18c)]===auth_state_enum_1['AuthState'][_0x2ea7b4(0x189)]){this['logger'][_0x2ea7b4(0x18f)](_0x2ea7b4(0x1a6));throw new unauthorized_salesforce_error_1[(_0x2ea7b4(0x15f))]();}if(this[_0x2ea7b4(0x18c)]!==auth_state_enum_1['AuthState'][_0x2ea7b4(0x165)])return this['logger']['log'](_0x2ea7b4(0x16b)),await utils_1[_0x2ea7b4(0x169)](this[_0x2ea7b4(0x16f)]),this[_0x2ea7b4(0x164)]();}['getAuthData'](){const _0x30ef2e=a126_0x1fed49;return{'orgId':this[_0x30ef2e(0x16e)],'accessToken':this[_0x30ef2e(0x192)],'instanceUrl':this[_0x30ef2e(0x179)]};}async[a126_0x1fed49(0x1a7)](){const _0x38d886=a126_0x1fed49;return await this['waitAuth'](),{'baseURL':this['instanceUrl'],'headers':{'accept':_0x38d886(0x17e),'authorization':this[_0x38d886(0x19d)]+'\x20'+this[_0x38d886(0x192)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1['Service'](),__metadata('design:paramtypes',[salesforce_settings_service_1[a126_0x1fed49(0x18d)]])],SalesforceAuthService),exports[a126_0x1fed49(0x198)]=SalesforceAuthService;