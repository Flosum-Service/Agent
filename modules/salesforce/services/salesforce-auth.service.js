function a125_0x2d50(){const _0x114676=['SalesforceAuthService','305501xIixRg','Idle','6455530FbxbLc','__esModule','search','salesforseSettings','toString','UnauthorizedSalesforceError','waitAuth','loginUrl','__decorate','constructor','../enums/auth-state.enum','SALESFORCE_API_VERSION','__importDefault','66izXUlf','../../../constants','create\x20authorized\x20request\x20failed:\x20authorization\x20error','function','requestConfig','Logger','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','check\x20auth:\x20current\x20state\x20-\x20%s','length','Active','defineProperty','post','authState','setAuthDetails','ERR_INVALID_SALESFORCE_TOKEN','forceUpdateToken','log','../../../core','2468559mpkmyJ','AUTH_WAIT_TIME','apply','8MFApzD','catch','typedi','InvalidRefreshTokenError','4951512nrHDji','1362314GBIluL','../../shared/services/salesforce-settings.service','../../../constants/errors','Updating','application/json','axios','AuthState','849777eqwSEz','orgId','tokenType','../errors/unauthorized-salesforce.error','3896748psIzUK','SalesforceSettingsService','update\x20access\x20token','joinURL','access\x20token\x20updated\x20for\x20%s','instance_url','settings','/services/oauth2/token','response','default','Error','get','message','services/data/','error','data','sleep','instanceUrl','design:paramtypes','logger','__metadata','decorate','(((.+)+)+)+$','metadata','accessToken','update\x20access\x20token\x20failed:\x20%s','updateAccessToken','object'];a125_0x2d50=function(){return _0x114676;};return a125_0x2d50();}const a125_0x5e99c2=a125_0x38e4;(function(_0x3f65e7,_0x1d6f8a){const _0x5271fc=a125_0x38e4,_0x3389d2=_0x3f65e7();while(!![]){try{const _0x21a5f2=-parseInt(_0x5271fc(0x17b))/0x1+parseInt(_0x5271fc(0x174))/0x2+parseInt(_0x5271fc(0x16c))/0x3+-parseInt(_0x5271fc(0x12e))/0x4+parseInt(_0x5271fc(0x14d))/0x5+-parseInt(_0x5271fc(0x15a))/0x6*(-parseInt(_0x5271fc(0x14b))/0x7)+-parseInt(_0x5271fc(0x16f))/0x8*(parseInt(_0x5271fc(0x173))/0x9);if(_0x21a5f2===_0x1d6f8a)break;else _0x3389d2['push'](_0x3389d2['shift']());}catch(_0x309b0f){_0x3389d2['push'](_0x3389d2['shift']());}}}(a125_0x2d50,0xdbfc1));const a125_0x427687=(function(){let _0x169e18=!![];return function(_0x43d970,_0x231056){const _0x23f23e=_0x169e18?function(){const _0x2ffb3a=a125_0x38e4;if(_0x231056){const _0x2fae98=_0x231056[_0x2ffb3a(0x16e)](_0x43d970,arguments);return _0x231056=null,_0x2fae98;}}:function(){};return _0x169e18=![],_0x23f23e;};}()),a125_0x4c0aca=a125_0x427687(this,function(){const _0x18d99d=a125_0x38e4;return a125_0x4c0aca[_0x18d99d(0x151)]()[_0x18d99d(0x14f)](_0x18d99d(0x144))[_0x18d99d(0x151)]()[_0x18d99d(0x156)](a125_0x4c0aca)[_0x18d99d(0x14f)](_0x18d99d(0x144));});function a125_0x38e4(_0x552202,_0x5815fb){const _0x1892a2=a125_0x2d50();return a125_0x38e4=function(_0x4c0aca,_0x427687){_0x4c0aca=_0x4c0aca-0x12e;let _0x2d50f7=_0x1892a2[_0x4c0aca];return _0x2d50f7;},a125_0x38e4(_0x552202,_0x5815fb);}a125_0x4c0aca();'use strict';var __decorate=this&&this[a125_0x5e99c2(0x155)]||function(_0x48b4bf,_0x53f720,_0x2c8a18,_0x314606){const _0x47077c=a125_0x5e99c2;var _0x2dfb74=arguments['length'],_0xe583b0=_0x2dfb74<0x3?_0x53f720:_0x314606===null?_0x314606=Object['getOwnPropertyDescriptor'](_0x53f720,_0x2c8a18):_0x314606,_0x46dbe1;if(typeof Reflect===_0x47077c(0x149)&&typeof Reflect[_0x47077c(0x143)]===_0x47077c(0x15d))_0xe583b0=Reflect[_0x47077c(0x143)](_0x48b4bf,_0x53f720,_0x2c8a18,_0x314606);else{for(var _0x36efac=_0x48b4bf[_0x47077c(0x162)]-0x1;_0x36efac>=0x0;_0x36efac--)if(_0x46dbe1=_0x48b4bf[_0x36efac])_0xe583b0=(_0x2dfb74<0x3?_0x46dbe1(_0xe583b0):_0x2dfb74>0x3?_0x46dbe1(_0x53f720,_0x2c8a18,_0xe583b0):_0x46dbe1(_0x53f720,_0x2c8a18))||_0xe583b0;}return _0x2dfb74>0x3&&_0xe583b0&&Object[_0x47077c(0x164)](_0x53f720,_0x2c8a18,_0xe583b0),_0xe583b0;},__metadata=this&&this[a125_0x5e99c2(0x142)]||function(_0x35f681,_0x13acbe){const _0x4adf21=a125_0x5e99c2;if(typeof Reflect===_0x4adf21(0x149)&&typeof Reflect[_0x4adf21(0x145)]==='function')return Reflect[_0x4adf21(0x145)](_0x35f681,_0x13acbe);},__importDefault=this&&this[a125_0x5e99c2(0x159)]||function(_0x2ca76c){const _0x585c30=a125_0x5e99c2;return _0x2ca76c&&_0x2ca76c[_0x585c30(0x14e)]?_0x2ca76c:{'default':_0x2ca76c};},SalesforceAuthService_1;Object[a125_0x5e99c2(0x164)](exports,'__esModule',{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=require(a125_0x5e99c2(0x171)),errors_1=require(a125_0x5e99c2(0x176)),core_1=require(a125_0x5e99c2(0x16b)),salesforce_settings_service_1=require(a125_0x5e99c2(0x175)),axios_1=__importDefault(require(a125_0x5e99c2(0x179))),utils_1=require('../../shared/utils'),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require(a125_0x5e99c2(0x157)),unauthorized_salesforce_error_1=require(a125_0x5e99c2(0x17e)),constants_1=require(a125_0x5e99c2(0x15b));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x434f5e){const _0x143cbe=a125_0x5e99c2;this['salesforseSettings']=_0x434f5e,this[_0x143cbe(0x16d)]=0x1388,this['authState']=auth_state_enum_1['AuthState'][_0x143cbe(0x14c)],this[_0x143cbe(0x141)]=new core_1[(_0x143cbe(0x15f))](SalesforceAuthService_1['name']),this[_0x143cbe(0x167)]();}get[a125_0x5e99c2(0x134)](){const _0x2bebac=a125_0x5e99c2;return this[_0x2bebac(0x150)]['settings'];}async[a125_0x5e99c2(0x167)](){const _0x32f919=a125_0x5e99c2;this[_0x32f919(0x141)][_0x32f919(0x16a)](_0x32f919(0x161),auth_state_enum_1['AuthState'][this[_0x32f919(0x166)]]);try{if(this[_0x32f919(0x166)]===auth_state_enum_1[_0x32f919(0x17a)][_0x32f919(0x138)])return;if(this['authState']===auth_state_enum_1[_0x32f919(0x17a)][_0x32f919(0x14c)])await this[_0x32f919(0x148)]();else{const _0x1cd982=await this[_0x32f919(0x15e)](),_0x3648eb=await axios_1[_0x32f919(0x137)][_0x32f919(0x139)](_0x32f919(0x13b)+constants_1[_0x32f919(0x158)],_0x1cd982)['then'](()=>!![])[_0x32f919(0x170)](()=>![]);!_0x3648eb&&await this[_0x32f919(0x148)]();}}catch(_0x28b494){}}async[a125_0x5e99c2(0x148)](){const _0x5b24af=a125_0x5e99c2;var _0x33d729,_0x52cd80,_0x200033;this[_0x5b24af(0x141)][_0x5b24af(0x16a)](_0x5b24af(0x130));try{this['authState']=auth_state_enum_1[_0x5b24af(0x17a)][_0x5b24af(0x177)];const {refreshToken:_0x30b9c0,clientId:_0x2e6bba,clientSecret:_0x48686b}=this[_0x5b24af(0x134)],{data:_0x21780f}=await axios_1[_0x5b24af(0x137)][_0x5b24af(0x165)](utils_1[_0x5b24af(0x131)](this[_0x5b24af(0x150)][_0x5b24af(0x154)],_0x5b24af(0x135)),null,{'params':{'grant_type':'refresh_token','refresh_token':_0x30b9c0,'client_id':_0x2e6bba,'client_secret':_0x48686b}});this[_0x5b24af(0x13f)]=_0x21780f[_0x5b24af(0x133)],this[_0x5b24af(0x146)]=_0x21780f['access_token'],this['tokenType']=_0x21780f['token_type'],this['authState']=auth_state_enum_1[_0x5b24af(0x17a)]['Active'],this[_0x5b24af(0x141)][_0x5b24af(0x16a)](_0x5b24af(0x132),this[_0x5b24af(0x13f)]);}catch(_0x57ddc3){const _0x3fc68b=((_0x52cd80=(_0x33d729=_0x57ddc3===null||_0x57ddc3===void 0x0?void 0x0:_0x57ddc3[_0x5b24af(0x136)])===null||_0x33d729===void 0x0?void 0x0:_0x33d729[_0x5b24af(0x13d)])===null||_0x52cd80===void 0x0?void 0x0:_0x52cd80[_0x5b24af(0x13c)])||((_0x200033=_0x57ddc3===null||_0x57ddc3===void 0x0?void 0x0:_0x57ddc3[_0x5b24af(0x136)])===null||_0x200033===void 0x0?void 0x0:_0x200033[_0x5b24af(0x13d)])||_0x57ddc3[_0x5b24af(0x13a)];this[_0x5b24af(0x141)]['error'](_0x5b24af(0x147),_0x3fc68b),this[_0x5b24af(0x166)]=auth_state_enum_1[_0x5b24af(0x17a)][_0x5b24af(0x138)];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x5b24af(0x168)]);}}async['forceUpdateToken'](){const _0x10a1dd=a125_0x5e99c2;this[_0x10a1dd(0x141)]['log']('force\x20update\x20token');if(this[_0x10a1dd(0x166)]===auth_state_enum_1[_0x10a1dd(0x17a)][_0x10a1dd(0x177)]||this[_0x10a1dd(0x166)]===auth_state_enum_1[_0x10a1dd(0x17a)][_0x10a1dd(0x14c)])return await utils_1[_0x10a1dd(0x13e)](this[_0x10a1dd(0x16d)]),this[_0x10a1dd(0x169)]();if(this['authState']===auth_state_enum_1[_0x10a1dd(0x17a)]['Error'])throw new invalid_refresh_token_error_1[(_0x10a1dd(0x172))](errors_1[_0x10a1dd(0x168)]);await this[_0x10a1dd(0x148)]();}async[a125_0x5e99c2(0x153)](){const _0x1fd666=a125_0x5e99c2;if(this[_0x1fd666(0x166)]===auth_state_enum_1[_0x1fd666(0x17a)][_0x1fd666(0x138)]){this[_0x1fd666(0x141)]['log'](_0x1fd666(0x15c));throw new unauthorized_salesforce_error_1[(_0x1fd666(0x152))]();}if(this[_0x1fd666(0x166)]!==auth_state_enum_1[_0x1fd666(0x17a)][_0x1fd666(0x163)])return this[_0x1fd666(0x141)][_0x1fd666(0x16a)](_0x1fd666(0x160)),await utils_1[_0x1fd666(0x13e)](this[_0x1fd666(0x16d)]),this['waitAuth']();}['getAuthData'](){const _0x20280b=a125_0x5e99c2;return{'orgId':this[_0x20280b(0x17c)],'accessToken':this[_0x20280b(0x146)],'instanceUrl':this[_0x20280b(0x13f)]};}async['requestConfig'](){const _0x7791c8=a125_0x5e99c2;return await this[_0x7791c8(0x153)](),{'baseURL':this[_0x7791c8(0x13f)],'headers':{'accept':_0x7791c8(0x178),'authorization':this[_0x7791c8(0x17d)]+'\x20'+this[_0x7791c8(0x146)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1['Service'](),__metadata(a125_0x5e99c2(0x140),[salesforce_settings_service_1[a125_0x5e99c2(0x12f)]])],SalesforceAuthService),exports[a125_0x5e99c2(0x14a)]=SalesforceAuthService;