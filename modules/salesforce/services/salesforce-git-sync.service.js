const a130_0xd8769e=a130_0x1c12;(function(_0x3042b6,_0x534a44){const _0x5f24ce=a130_0x1c12,_0x27dade=_0x3042b6();while(!![]){try{const _0x45aa82=parseInt(_0x5f24ce(0x1d2))/0x1+-parseInt(_0x5f24ce(0x1a8))/0x2+parseInt(_0x5f24ce(0x1b7))/0x3+parseInt(_0x5f24ce(0x1a1))/0x4+parseInt(_0x5f24ce(0x1c8))/0x5+-parseInt(_0x5f24ce(0x1af))/0x6*(parseInt(_0x5f24ce(0x1c0))/0x7)+parseInt(_0x5f24ce(0x1bf))/0x8*(parseInt(_0x5f24ce(0x1aa))/0x9);if(_0x45aa82===_0x534a44)break;else _0x27dade['push'](_0x27dade['shift']());}catch(_0x206c6c){_0x27dade['push'](_0x27dade['shift']());}}}(a130_0x45e4,0x4e744));const a130_0x6ddf29=(function(){let _0x5a00ab=!![];return function(_0x2fc74a,_0x3524f1){const _0xb78af7=_0x5a00ab?function(){if(_0x3524f1){const _0x3f13f5=_0x3524f1['apply'](_0x2fc74a,arguments);return _0x3524f1=null,_0x3f13f5;}}:function(){};return _0x5a00ab=![],_0xb78af7;};}()),a130_0x23f2eb=a130_0x6ddf29(this,function(){const _0x18797e=a130_0x1c12;return a130_0x23f2eb['toString']()[_0x18797e(0x199)]('(((.+)+)+)+$')[_0x18797e(0x1a0)]()['constructor'](a130_0x23f2eb)[_0x18797e(0x199)]('(((.+)+)+)+$');});a130_0x23f2eb();'use strict';var __decorate=this&&this[a130_0xd8769e(0x1c6)]||function(_0x274481,_0x404700,_0xe74618,_0x566b5a){const _0x383a97=a130_0xd8769e;var _0x2aa8ba=arguments[_0x383a97(0x197)],_0x4a09d0=_0x2aa8ba<0x3?_0x404700:_0x566b5a===null?_0x566b5a=Object['getOwnPropertyDescriptor'](_0x404700,_0xe74618):_0x566b5a,_0x1084b2;if(typeof Reflect===_0x383a97(0x1b1)&&typeof Reflect['decorate']===_0x383a97(0x1a5))_0x4a09d0=Reflect[_0x383a97(0x1d1)](_0x274481,_0x404700,_0xe74618,_0x566b5a);else{for(var _0x46ee2f=_0x274481[_0x383a97(0x197)]-0x1;_0x46ee2f>=0x0;_0x46ee2f--)if(_0x1084b2=_0x274481[_0x46ee2f])_0x4a09d0=(_0x2aa8ba<0x3?_0x1084b2(_0x4a09d0):_0x2aa8ba>0x3?_0x1084b2(_0x404700,_0xe74618,_0x4a09d0):_0x1084b2(_0x404700,_0xe74618))||_0x4a09d0;}return _0x2aa8ba>0x3&&_0x4a09d0&&Object[_0x383a97(0x19a)](_0x404700,_0xe74618,_0x4a09d0),_0x4a09d0;},__metadata=this&&this[a130_0xd8769e(0x1c7)]||function(_0x685c7e,_0x2d3810){const _0x553a3d=a130_0xd8769e;if(typeof Reflect===_0x553a3d(0x1b1)&&typeof Reflect[_0x553a3d(0x19d)]===_0x553a3d(0x1a5))return Reflect['metadata'](_0x685c7e,_0x2d3810);};Object[a130_0xd8769e(0x19a)](exports,a130_0xd8769e(0x1ad),{'value':!![]}),exports[a130_0xd8769e(0x1c9)]=void 0x0;const not_found_error_1=require('../../../core/errors/not-found.error'),typedi_1=require(a130_0xd8769e(0x19b)),constants_1=require('../../../constants'),queries_1=require('../queries'),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_rest_service_1=require(a130_0xd8769e(0x1bb));function a130_0x45e4(){const _0x6f22d=['__metadata','1677015gVOpsR','SalesforceGitSyncService','getRepositoryIdByName','Status__c','GET_COMPONENT_RECORD_TYPES_QUERY','Is_From_Agent__c','substr','getComponentRecordTypes','Name','decorate','172855xFIIWA','extractComponentMetadataFromRecord','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','getBranchIdByName','%name%','fetchBranchComponents','push','fetchRepositoryComponents','FLOSUM_GIT_NAMESPACE','query','Service','SalesforceQueryService','map','length','join','search','defineProperty','typedi','fetchBranchComponentsByFilenames','metadata','post','extractFieldsFromRecord','toString','349276aNbApU','fetchRepositoryComponentsByFilenames','GET_BRANCH_COMPONENTS_QUERY','%fileNames%','function','%componentIds%','Component_Name__c','546352drsSGs','%repositoryId%','1251NnRQky','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY','SalesforceRestService','__esModule','NotFoundError','529014EYzUJK','\x22\x20not\x20found\x20in\x20flosum.','object','Version__c','queryService','GET_BRANCH_BY_NAME_QUERY','FLOSUM_COMMIT','splice','1460034qGXuCf','fetchCommitManifestsByComponentIds','GET_REPOSITORY_BY_NAME_QUERY','MAX_QUERY_ARRAY_ITEMS','./salesforce-rest.service','FLOSUM_NAMESPACE','CRC32__c','replace','2376gpmzzy','42GZYfEm','File_Name__c','Repository__c','GET_REPOSITORY_COMPONENTS_QUERY','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','Repository\x20\x22','__decorate'];a130_0x45e4=function(){return _0x6f22d;};return a130_0x45e4();}function a130_0x1c12(_0xacda82,_0xcda57c){const _0x30fb02=a130_0x45e4();return a130_0x1c12=function(_0x23f2eb,_0x6ddf29){_0x23f2eb=_0x23f2eb-0x18e;let _0x45e48b=_0x30fb02[_0x23f2eb];return _0x45e48b;},a130_0x1c12(_0xacda82,_0xcda57c);}let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x5475ac,_0x463814){const _0x24a64a=a130_0xd8769e;this[_0x24a64a(0x1b3)]=_0x5475ac,this['restService']=_0x463814,this[_0x24a64a(0x1ba)]=0xc8;}[a130_0xd8769e(0x1d3)](_0x3750e2){const _0x5176e1=a130_0xd8769e,_0x7ff966=flosum_naming_utils_1[_0x5176e1(0x19f)](_0x3750e2,[_0x5176e1(0x1a7),'Component_Type__c',_0x5176e1(0x1bd),'File_Name__c',_0x5176e1(0x1b2),'Id']);return{'id':_0x7ff966['Id'],'name':_0x7ff966[_0x5176e1(0x1a7)],'type':_0x7ff966['Component_Type__c'],'fileName':_0x7ff966[_0x5176e1(0x1c1)],'crc32':_0x7ff966[_0x5176e1(0x1bd)],'version':+_0x7ff966[_0x5176e1(0x1b2)]};}async[a130_0xd8769e(0x1ca)](_0x4d3951){const _0x53bc31=a130_0xd8769e,[_0x1474dc]=await this[_0x53bc31(0x1b3)][_0x53bc31(0x193)](queries_1[_0x53bc31(0x1b9)]['replace'](_0x53bc31(0x18e),_0x4d3951));if(!_0x1474dc)throw new not_found_error_1[(_0x53bc31(0x1ae))](_0x53bc31(0x1c5)+_0x4d3951+_0x53bc31(0x1b0));return _0x1474dc['Id'];}async[a130_0xd8769e(0x1d5)](_0x1ec354){const _0x4f7143=a130_0xd8769e,[_0x56152a]=await this[_0x4f7143(0x1b3)]['query'](queries_1[_0x4f7143(0x1b4)][_0x4f7143(0x1be)]('%name%',_0x1ec354));if(!_0x56152a)throw new not_found_error_1[(_0x4f7143(0x1ae))]('Branch\x20\x22'+_0x1ec354+'\x22\x20not\x20found\x20in\x20flosum.');return _0x56152a['Id'];}async[a130_0xd8769e(0x1cf)](){const _0x2261ed=a130_0xd8769e,_0x5c677c=await this[_0x2261ed(0x1b3)][_0x2261ed(0x193)](queries_1[_0x2261ed(0x1cc)]);return _0x5c677c['map'](_0x3611b0=>flosum_naming_utils_1[_0x2261ed(0x19f)](_0x3611b0,['Id',_0x2261ed(0x1d0)]))[_0x2261ed(0x196)](_0x25497f=>({'id':_0x25497f['Id'],'name':_0x25497f[_0x2261ed(0x1d0)]}));}async[a130_0xd8769e(0x1a2)](_0x4f65ac,_0x49653e){const _0x4cf961=a130_0xd8769e,_0x16bcfe=[];while(_0x4f65ac['length']){const _0x2b6074=queries_1[_0x4cf961(0x1d4)][_0x4cf961(0x1be)](_0x4cf961(0x1a4),_0x4f65ac[_0x4cf961(0x1b6)](0x0,this[_0x4cf961(0x1ba)])[_0x4cf961(0x196)](_0x33be5b=>'\x27'+_0x33be5b+'\x27')[_0x4cf961(0x198)](','))[_0x4cf961(0x1be)]('%repositoryId%',_0x49653e),_0x1595ae=await this[_0x4cf961(0x1b3)][_0x4cf961(0x193)](_0x2b6074);_0x16bcfe['push'](..._0x1595ae);}return _0x16bcfe['map'](_0x34c3d3=>this[_0x4cf961(0x1d3)](_0x34c3d3));}async[a130_0xd8769e(0x19c)](_0x3e97c1,_0x2e6cff){const _0x4f0105=a130_0xd8769e,_0x9ccd09=[];while(_0x3e97c1[_0x4f0105(0x197)]){const _0x58f5a1=queries_1[_0x4f0105(0x1ab)][_0x4f0105(0x1be)]('%fileNames%',_0x3e97c1['splice'](0x0,this[_0x4f0105(0x1ba)])[_0x4f0105(0x196)](_0x423fbc=>'\x27'+_0x423fbc+'\x27')[_0x4f0105(0x198)](','))[_0x4f0105(0x1be)]('%branchId%',_0x2e6cff),_0x3f7e31=await this[_0x4f0105(0x1b3)][_0x4f0105(0x193)](_0x58f5a1);_0x9ccd09[_0x4f0105(0x190)](..._0x3f7e31);}return _0x9ccd09['map'](_0x29717c=>this[_0x4f0105(0x1d3)](_0x29717c));}async[a130_0xd8769e(0x191)](_0x105071){const _0x2df3d9=a130_0xd8769e,_0x492189=queries_1[_0x2df3d9(0x1c3)][_0x2df3d9(0x1be)](_0x2df3d9(0x1a9),_0x105071),_0x4e3ef9=await this[_0x2df3d9(0x1b3)][_0x2df3d9(0x193)](_0x492189);return _0x4e3ef9['map'](_0x4c3b4e=>this['extractComponentMetadataFromRecord'](_0x4c3b4e));}async[a130_0xd8769e(0x18f)](_0x175475){const _0x526b97=a130_0xd8769e,_0x297e74=queries_1[_0x526b97(0x1a3)][_0x526b97(0x1be)]('%branchId%',_0x175475),_0x2a98a0=await this['queryService'][_0x526b97(0x193)](_0x297e74);return _0x2a98a0[_0x526b97(0x196)](_0x4d892b=>this[_0x526b97(0x1d3)](_0x4d892b));}async[a130_0xd8769e(0x1b8)](_0x16d985){const _0x5ed5ae=a130_0xd8769e,_0x133a5d=[..._0x16d985],_0x2b0a3d=[];while(_0x133a5d[_0x5ed5ae(0x197)]){const _0x4735a5=queries_1[_0x5ed5ae(0x1c4)][_0x5ed5ae(0x1be)](_0x5ed5ae(0x1a6),_0x133a5d[_0x5ed5ae(0x1b6)](0x0,this['MAX_QUERY_ARRAY_ITEMS'])[_0x5ed5ae(0x196)](_0x245f2d=>'\x27'+_0x245f2d+'\x27')[_0x5ed5ae(0x198)](',')),_0x3afe9c=await this['queryService'][_0x5ed5ae(0x193)](_0x4735a5);_0x2b0a3d['push'](..._0x3afe9c[_0x5ed5ae(0x196)](_0x264480=>_0x264480['Id']));}return _0x2b0a3d;}async['createCommit'](_0x31b3fd,_0x2d8b2a){const _0x4464bb=a130_0xd8769e;return this['restService'][_0x4464bb(0x19e)](constants_1[_0x4464bb(0x1b5)],{[constants_1[_0x4464bb(0x1bc)]+_0x4464bb(0x1c2)]:_0x2d8b2a,[constants_1[_0x4464bb(0x1bc)]+'Commit_Name__c']:_0x31b3fd[_0x4464bb(0x1ce)](0x0,0xff),[constants_1['FLOSUM_NAMESPACE']+_0x4464bb(0x1cb)]:'Completed',[constants_1[_0x4464bb(0x192)]+_0x4464bb(0x1cd)]:!![]});}};SalesforceGitSyncService=__decorate([typedi_1[a130_0xd8769e(0x194)](),__metadata('design:paramtypes',[salesforce_query_service_1[a130_0xd8769e(0x195)],salesforce_rest_service_1[a130_0xd8769e(0x1ac)]])],SalesforceGitSyncService),exports[a130_0xd8769e(0x1c9)]=SalesforceGitSyncService;