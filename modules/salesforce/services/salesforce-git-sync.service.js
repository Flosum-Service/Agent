const a130_0x55ab92=a130_0x95a7;(function(_0x403c66,_0x6e675c){const _0x6ec84b=a130_0x95a7,_0x4f25c8=_0x403c66();while(!![]){try{const _0xe09a39=-parseInt(_0x6ec84b(0xbf))/0x1+parseInt(_0x6ec84b(0xa1))/0x2*(parseInt(_0x6ec84b(0x86))/0x3)+parseInt(_0x6ec84b(0xc7))/0x4*(-parseInt(_0x6ec84b(0x9f))/0x5)+parseInt(_0x6ec84b(0xb4))/0x6+-parseInt(_0x6ec84b(0x8e))/0x7+parseInt(_0x6ec84b(0xad))/0x8*(parseInt(_0x6ec84b(0xca))/0x9)+-parseInt(_0x6ec84b(0x9c))/0xa*(parseInt(_0x6ec84b(0x8d))/0xb);if(_0xe09a39===_0x6e675c)break;else _0x4f25c8['push'](_0x4f25c8['shift']());}catch(_0x1471e8){_0x4f25c8['push'](_0x4f25c8['shift']());}}}(a130_0x5b12,0xc2a9c));const a130_0x3af9a0=(function(){let _0x23e74c=!![];return function(_0x5dda29,_0x3cc789){const _0x2494f5=_0x23e74c?function(){const _0x172935=a130_0x95a7;if(_0x3cc789){const _0x1a110a=_0x3cc789[_0x172935(0x99)](_0x5dda29,arguments);return _0x3cc789=null,_0x1a110a;}}:function(){};return _0x23e74c=![],_0x2494f5;};}()),a130_0x4e0a3a=a130_0x3af9a0(this,function(){const _0x326168=a130_0x95a7;return a130_0x4e0a3a[_0x326168(0xa7)]()[_0x326168(0xc0)](_0x326168(0xae))[_0x326168(0xa7)]()[_0x326168(0xcb)](a130_0x4e0a3a)['search'](_0x326168(0xae));});function a130_0x95a7(_0x5da60e,_0x4027ae){const _0x62536f=a130_0x5b12();return a130_0x95a7=function(_0x4e0a3a,_0x3af9a0){_0x4e0a3a=_0x4e0a3a-0x7f;let _0x5b124f=_0x62536f[_0x4e0a3a];return _0x5b124f;},a130_0x95a7(_0x5da60e,_0x4027ae);}a130_0x4e0a3a();'use strict';var __decorate=this&&this[a130_0x55ab92(0xbe)]||function(_0x29baee,_0x15df41,_0xa21b7a,_0x206f2a){const _0x1989ec=a130_0x55ab92;var _0x2d5506=arguments[_0x1989ec(0x89)],_0x51cda9=_0x2d5506<0x3?_0x15df41:_0x206f2a===null?_0x206f2a=Object['getOwnPropertyDescriptor'](_0x15df41,_0xa21b7a):_0x206f2a,_0x1ee97a;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x1989ec(0xa2))_0x51cda9=Reflect[_0x1989ec(0xa6)](_0x29baee,_0x15df41,_0xa21b7a,_0x206f2a);else{for(var _0x4659ac=_0x29baee['length']-0x1;_0x4659ac>=0x0;_0x4659ac--)if(_0x1ee97a=_0x29baee[_0x4659ac])_0x51cda9=(_0x2d5506<0x3?_0x1ee97a(_0x51cda9):_0x2d5506>0x3?_0x1ee97a(_0x15df41,_0xa21b7a,_0x51cda9):_0x1ee97a(_0x15df41,_0xa21b7a))||_0x51cda9;}return _0x2d5506>0x3&&_0x51cda9&&Object[_0x1989ec(0xbc)](_0x15df41,_0xa21b7a,_0x51cda9),_0x51cda9;},__metadata=this&&this['__metadata']||function(_0x23927b,_0x15f767){const _0x307dd2=a130_0x55ab92;if(typeof Reflect===_0x307dd2(0x83)&&typeof Reflect[_0x307dd2(0x87)]===_0x307dd2(0xa2))return Reflect[_0x307dd2(0x87)](_0x23927b,_0x15f767);};Object[a130_0x55ab92(0xbc)](exports,a130_0x55ab92(0x8b),{'value':!![]}),exports[a130_0x55ab92(0xab)]=void 0x0;function a130_0x5b12(){const _0x3b934c=['constructor','map','Repository__c','FLOSUM_GIT_NAMESPACE','../utils/flosum-naming.utils','object','query','./salesforce-rest.service','3MGkaDp','metadata','createCommit','length','FLOSUM_COMMIT','__esModule','substr','2027135qdCsRT','7351743ALYiJQ','push','fetchBranchComponentsByFilenames','getRepositoryIdByName','../../../core/errors/not-found.error','MAX_QUERY_ARRAY_ITEMS','FLOSUM_NAMESPACE','fetchCommitManifestsByComponentIds','GET_REPOSITORY_COMPONENTS_QUERY','Component_Type__c','%repositoryId%','apply','design:paramtypes','GET_BRANCH_COMPONENTS_QUERY','10CBXlga','Service','restService','115HUprpk','CRC32__c','2155168vUUYrD','function','replace','GET_BRANCH_BY_NAME_QUERY','getComponentRecordTypes','decorate','toString','%branchId%','Completed','%name%','SalesforceGitSyncService','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','13768acTYah','(((.+)+)+)+$','join','getBranchIdByName','SalesforceRestService','SalesforceQueryService','Name','9033024iPPnSU','post','Version__c','Component_Name__c','fetchRepositoryComponentsByFilenames','%fileNames%','\x22\x20not\x20found\x20in\x20flosum.','NotFoundError','defineProperty','typedi','__decorate','1098067sPRtoj','search','File_Name__c','extractComponentMetadataFromRecord','queryService','extractFieldsFromRecord','Commit_Name__c','GET_REPOSITORY_BY_NAME_QUERY','136856OflutI','Repository\x20\x22','splice','6975vZwfhW'];a130_0x5b12=function(){return _0x3b934c;};return a130_0x5b12();}const not_found_error_1=require(a130_0x55ab92(0x92)),typedi_1=require(a130_0x55ab92(0xbd)),constants_1=require('../../../constants'),queries_1=require('../queries'),flosum_naming_utils_1=require(a130_0x55ab92(0x82)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_rest_service_1=require(a130_0x55ab92(0x85));let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x2c87f1,_0x1dc7ba){const _0x52d0da=a130_0x55ab92;this[_0x52d0da(0xc3)]=_0x2c87f1,this[_0x52d0da(0x9e)]=_0x1dc7ba,this['MAX_QUERY_ARRAY_ITEMS']=0xc8;}[a130_0x55ab92(0xc2)](_0x358b88){const _0x3b9898=a130_0x55ab92,_0x46bab3=flosum_naming_utils_1[_0x3b9898(0xc4)](_0x358b88,['Component_Name__c',_0x3b9898(0x97),_0x3b9898(0xa0),_0x3b9898(0xc1),_0x3b9898(0xb6),'Id']);return{'id':_0x46bab3['Id'],'name':_0x46bab3[_0x3b9898(0xb7)],'type':_0x46bab3[_0x3b9898(0x97)],'fileName':_0x46bab3['File_Name__c'],'crc32':_0x46bab3[_0x3b9898(0xa0)],'version':+_0x46bab3[_0x3b9898(0xb6)]};}async[a130_0x55ab92(0x91)](_0x569911){const _0x5d0bbb=a130_0x55ab92,[_0x3e0258]=await this[_0x5d0bbb(0xc3)]['query'](queries_1[_0x5d0bbb(0xc6)][_0x5d0bbb(0xa3)](_0x5d0bbb(0xaa),_0x569911));if(!_0x3e0258)throw new not_found_error_1[(_0x5d0bbb(0xbb))](_0x5d0bbb(0xc8)+_0x569911+_0x5d0bbb(0xba));return _0x3e0258['Id'];}async[a130_0x55ab92(0xb0)](_0x166d0e){const _0x5551e5=a130_0x55ab92,[_0x2f28d7]=await this[_0x5551e5(0xc3)][_0x5551e5(0x84)](queries_1[_0x5551e5(0xa4)][_0x5551e5(0xa3)](_0x5551e5(0xaa),_0x166d0e));if(!_0x2f28d7)throw new not_found_error_1[(_0x5551e5(0xbb))]('Branch\x20\x22'+_0x166d0e+_0x5551e5(0xba));return _0x2f28d7['Id'];}async[a130_0x55ab92(0xa5)](){const _0x19085c=a130_0x55ab92,_0x2ea335=await this['queryService']['query'](queries_1['GET_COMPONENT_RECORD_TYPES_QUERY']);return _0x2ea335['map'](_0x34562d=>flosum_naming_utils_1[_0x19085c(0xc4)](_0x34562d,['Id',_0x19085c(0xb3)]))[_0x19085c(0x7f)](_0x38a829=>({'id':_0x38a829['Id'],'name':_0x38a829[_0x19085c(0xb3)]}));}async[a130_0x55ab92(0xb8)](_0x8ca691,_0x1440bb){const _0x5b977e=a130_0x55ab92,_0x21a389=[];while(_0x8ca691['length']){const _0x40195e=queries_1['GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY'][_0x5b977e(0xa3)](_0x5b977e(0xb9),_0x8ca691[_0x5b977e(0xc9)](0x0,this[_0x5b977e(0x93)])[_0x5b977e(0x7f)](_0x14f6dc=>'\x27'+_0x14f6dc+'\x27')[_0x5b977e(0xaf)](','))[_0x5b977e(0xa3)](_0x5b977e(0x98),_0x1440bb),_0x4030e8=await this['queryService'][_0x5b977e(0x84)](_0x40195e);_0x21a389[_0x5b977e(0x8f)](..._0x4030e8);}return _0x21a389[_0x5b977e(0x7f)](_0x109b78=>this['extractComponentMetadataFromRecord'](_0x109b78));}async[a130_0x55ab92(0x90)](_0x238157,_0x17f845){const _0x310423=a130_0x55ab92,_0x5d5ff2=[];while(_0x238157[_0x310423(0x89)]){const _0x351bd0=queries_1['GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY'][_0x310423(0xa3)]('%fileNames%',_0x238157[_0x310423(0xc9)](0x0,this[_0x310423(0x93)])['map'](_0x1b6868=>'\x27'+_0x1b6868+'\x27')[_0x310423(0xaf)](','))['replace'](_0x310423(0xa8),_0x17f845),_0x9120d6=await this['queryService'][_0x310423(0x84)](_0x351bd0);_0x5d5ff2['push'](..._0x9120d6);}return _0x5d5ff2[_0x310423(0x7f)](_0x3b94c8=>this['extractComponentMetadataFromRecord'](_0x3b94c8));}async['fetchRepositoryComponents'](_0x5266c4){const _0x1d5a6e=a130_0x55ab92,_0x2d4ac0=[],_0x3a050e=queries_1[_0x1d5a6e(0x96)][_0x1d5a6e(0xa3)](_0x1d5a6e(0x98),_0x5266c4),_0x36b000=await this[_0x1d5a6e(0xc3)][_0x1d5a6e(0x84)](_0x3a050e);return _0x2d4ac0[_0x1d5a6e(0x8f)](..._0x36b000),_0x2d4ac0[_0x1d5a6e(0x7f)](_0x4fca50=>this[_0x1d5a6e(0xc2)](_0x4fca50));}async['fetchBranchComponents'](_0x30955c){const _0x2b8301=a130_0x55ab92,_0xbe696=[],_0x573ec6=queries_1[_0x2b8301(0x9b)][_0x2b8301(0xa3)]('%branchId%',_0x30955c),_0x13e422=await this['queryService'][_0x2b8301(0x84)](_0x573ec6);return _0xbe696[_0x2b8301(0x8f)](..._0x13e422),_0xbe696['map'](_0x14b2e2=>this[_0x2b8301(0xc2)](_0x14b2e2));}async[a130_0x55ab92(0x95)](_0x4e5b47){const _0x5c6a4b=a130_0x55ab92,_0x4a2130=[..._0x4e5b47],_0x9e66fe=[];while(_0x4a2130['length']){const _0x34e0fe=queries_1[_0x5c6a4b(0xac)][_0x5c6a4b(0xa3)]('%componentIds%',_0x4a2130[_0x5c6a4b(0xc9)](0x0,this[_0x5c6a4b(0x93)])[_0x5c6a4b(0x7f)](_0x8c742d=>'\x27'+_0x8c742d+'\x27')[_0x5c6a4b(0xaf)](',')),_0xa512fc=await this[_0x5c6a4b(0xc3)][_0x5c6a4b(0x84)](_0x34e0fe);_0x9e66fe[_0x5c6a4b(0x8f)](..._0xa512fc[_0x5c6a4b(0x7f)](_0x332a1e=>_0x332a1e['Id']));}return _0x9e66fe;}async[a130_0x55ab92(0x88)](_0x28d1a9,_0xe720b1){const _0x36d46c=a130_0x55ab92;return this['restService'][_0x36d46c(0xb5)](constants_1[_0x36d46c(0x8a)],{[constants_1[_0x36d46c(0x94)]+_0x36d46c(0x80)]:_0xe720b1,[constants_1[_0x36d46c(0x94)]+_0x36d46c(0xc5)]:_0x28d1a9[_0x36d46c(0x8c)](0x0,0xff),[constants_1[_0x36d46c(0x94)]+'Status__c']:_0x36d46c(0xa9),[constants_1[_0x36d46c(0x81)]+'Is_From_Agent__c']:!![]});}};SalesforceGitSyncService=__decorate([typedi_1[a130_0x55ab92(0x9d)](),__metadata(a130_0x55ab92(0x9a),[salesforce_query_service_1[a130_0x55ab92(0xb2)],salesforce_rest_service_1[a130_0x55ab92(0xb1)]])],SalesforceGitSyncService),exports[a130_0x55ab92(0xab)]=SalesforceGitSyncService;