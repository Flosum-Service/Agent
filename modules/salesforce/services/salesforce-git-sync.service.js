const a130_0x3f773e=a130_0xcbff;(function(_0x349a6f,_0x2c424b){const _0x230f6a=a130_0xcbff,_0x5c5a49=_0x349a6f();while(!![]){try{const _0x4eb7ae=parseInt(_0x230f6a(0x10b))/0x1+parseInt(_0x230f6a(0x128))/0x2+parseInt(_0x230f6a(0x148))/0x3+-parseInt(_0x230f6a(0x12b))/0x4+-parseInt(_0x230f6a(0x126))/0x5+parseInt(_0x230f6a(0x13f))/0x6+-parseInt(_0x230f6a(0x14e))/0x7*(parseInt(_0x230f6a(0x11c))/0x8);if(_0x4eb7ae===_0x2c424b)break;else _0x5c5a49['push'](_0x5c5a49['shift']());}catch(_0x2a734a){_0x5c5a49['push'](_0x5c5a49['shift']());}}}(a130_0x5001,0xb6a80));const a130_0x19df1e=(function(){let _0x2c6d3c=!![];return function(_0x243e8f,_0x32f2a8){const _0x2ecaa6=_0x2c6d3c?function(){const _0x3942e0=a130_0xcbff;if(_0x32f2a8){const _0x1943f5=_0x32f2a8[_0x3942e0(0x110)](_0x243e8f,arguments);return _0x32f2a8=null,_0x1943f5;}}:function(){};return _0x2c6d3c=![],_0x2ecaa6;};}()),a130_0xc7177a=a130_0x19df1e(this,function(){const _0x4bc9fd=a130_0xcbff;return a130_0xc7177a['toString']()['search'](_0x4bc9fd(0x14d))[_0x4bc9fd(0x151)]()[_0x4bc9fd(0x11b)](a130_0xc7177a)['search'](_0x4bc9fd(0x14d));});a130_0xc7177a();'use strict';var __decorate=this&&this[a130_0x3f773e(0x125)]||function(_0x428c6b,_0x424f3f,_0x402fcc,_0x2bab25){const _0x54086d=a130_0x3f773e;var _0x435698=arguments[_0x54086d(0x12f)],_0x5651aa=_0x435698<0x3?_0x424f3f:_0x2bab25===null?_0x2bab25=Object[_0x54086d(0x10c)](_0x424f3f,_0x402fcc):_0x2bab25,_0x2588c0;if(typeof Reflect===_0x54086d(0x13b)&&typeof Reflect[_0x54086d(0x10d)]==='function')_0x5651aa=Reflect[_0x54086d(0x10d)](_0x428c6b,_0x424f3f,_0x402fcc,_0x2bab25);else{for(var _0x33161d=_0x428c6b[_0x54086d(0x12f)]-0x1;_0x33161d>=0x0;_0x33161d--)if(_0x2588c0=_0x428c6b[_0x33161d])_0x5651aa=(_0x435698<0x3?_0x2588c0(_0x5651aa):_0x435698>0x3?_0x2588c0(_0x424f3f,_0x402fcc,_0x5651aa):_0x2588c0(_0x424f3f,_0x402fcc))||_0x5651aa;}return _0x435698>0x3&&_0x5651aa&&Object[_0x54086d(0x132)](_0x424f3f,_0x402fcc,_0x5651aa),_0x5651aa;},__metadata=this&&this[a130_0x3f773e(0x139)]||function(_0x38553f,_0x24dfe0){const _0x3a7ddb=a130_0x3f773e;if(typeof Reflect===_0x3a7ddb(0x13b)&&typeof Reflect[_0x3a7ddb(0x108)]===_0x3a7ddb(0x14c))return Reflect[_0x3a7ddb(0x108)](_0x38553f,_0x24dfe0);};function a130_0xcbff(_0x446f6e,_0x54cd23){const _0x49918f=a130_0x5001();return a130_0xcbff=function(_0xc7177a,_0x19df1e){_0xc7177a=_0xc7177a-0x108;let _0x5001ad=_0x49918f[_0xc7177a];return _0x5001ad;},a130_0xcbff(_0x446f6e,_0x54cd23);}Object[a130_0x3f773e(0x132)](exports,'__esModule',{'value':!![]}),exports[a130_0x3f773e(0x137)]=void 0x0;const not_found_error_1=require('../../../core/errors/not-found.error'),typedi_1=require(a130_0x3f773e(0x13e)),constants_1=require(a130_0x3f773e(0x10f)),queries_1=require(a130_0x3f773e(0x149)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_query_service_1=require(a130_0x3f773e(0x12c)),salesforce_rest_service_1=require(a130_0x3f773e(0x11d));function a130_0x5001(){const _0x2fe36b=['772216JtrrBR','./salesforce-rest.service','%repositoryId%','queryService','fetchBranchComponents','FLOSUM_COMMIT','getRepositoryIdByName','fetchRepositoryComponents','GET_BRANCH_COMPONENTS_QUERY','__decorate','517055tWZYOE','FLOSUM_GIT_NAMESPACE','2360550HBKNAb','Repository__c','push','3457192TroqQS','./salesforce-query.service','Component_Type__c','FLOSUM_NAMESPACE','length','extractFieldsFromRecord','getBranchIdByName','defineProperty','File_Name__c','query','map','fetchCommitManifestsByComponentIds','SalesforceGitSyncService','Version__c','__metadata','\x22\x20not\x20found\x20in\x20flosum.','object','MAX_QUERY_ARRAY_ITEMS','restService','typedi','1250436mJJQEf','GET_REPOSITORY_COMPONENTS_QUERY','join','replace','splice','Repository\x20\x22','%branchId%','Component_Name__c','GET_COMPONENT_RECORD_TYPES_QUERY','3220488ZWCepD','../queries','design:paramtypes','Is_From_Agent__c','function','(((.+)+)+)+$','77AsuBaa','CRC32__c','Name','toString','metadata','SalesforceQueryService','%name%','315489MakKZW','getOwnPropertyDescriptor','decorate','Commit_Name__c','../../../constants','apply','substr','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','createCommit','Branch\x20\x22','%componentIds%','Status__c','Completed','fetchRepositoryComponentsByFilenames','extractComponentMetadataFromRecord','getComponentRecordTypes','constructor'];a130_0x5001=function(){return _0x2fe36b;};return a130_0x5001();}let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x25ed07,_0x417409){const _0x3e5fd3=a130_0x3f773e;this['queryService']=_0x25ed07,this[_0x3e5fd3(0x13d)]=_0x417409,this[_0x3e5fd3(0x13c)]=0xc8;}[a130_0x3f773e(0x119)](_0x576cd3){const _0x476898=a130_0x3f773e,_0x287e12=flosum_naming_utils_1[_0x476898(0x130)](_0x576cd3,[_0x476898(0x146),_0x476898(0x12d),_0x476898(0x14f),_0x476898(0x133),_0x476898(0x138),'Id']);return{'id':_0x287e12['Id'],'name':_0x287e12[_0x476898(0x146)],'type':_0x287e12['Component_Type__c'],'fileName':_0x287e12[_0x476898(0x133)],'crc32':_0x287e12['CRC32__c'],'version':+_0x287e12[_0x476898(0x138)]};}async[a130_0x3f773e(0x122)](_0x4ec423){const _0x2dcfab=a130_0x3f773e,[_0x28390]=await this[_0x2dcfab(0x11f)][_0x2dcfab(0x134)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x2dcfab(0x142)](_0x2dcfab(0x10a),_0x4ec423));if(!_0x28390)throw new not_found_error_1['NotFoundError'](_0x2dcfab(0x144)+_0x4ec423+'\x22\x20not\x20found\x20in\x20flosum.');return _0x28390['Id'];}async[a130_0x3f773e(0x131)](_0x27c012){const _0x1f92a5=a130_0x3f773e,[_0x28a871]=await this['queryService']['query'](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x1f92a5(0x142)](_0x1f92a5(0x10a),_0x27c012));if(!_0x28a871)throw new not_found_error_1['NotFoundError'](_0x1f92a5(0x114)+_0x27c012+_0x1f92a5(0x13a));return _0x28a871['Id'];}async[a130_0x3f773e(0x11a)](){const _0x1660d7=a130_0x3f773e,_0x5bff65=await this[_0x1660d7(0x11f)]['query'](queries_1[_0x1660d7(0x147)]);return _0x5bff65[_0x1660d7(0x135)](_0x589d1c=>flosum_naming_utils_1[_0x1660d7(0x130)](_0x589d1c,['Id',_0x1660d7(0x150)]))[_0x1660d7(0x135)](_0x3a58e0=>({'id':_0x3a58e0['Id'],'name':_0x3a58e0[_0x1660d7(0x150)]}));}async[a130_0x3f773e(0x118)](_0x2d892b,_0x117b22){const _0x5edae3=a130_0x3f773e,_0x2c8198=[];while(_0x2d892b[_0x5edae3(0x12f)]){const _0x14a65b=queries_1['GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY']['replace']('%fileNames%',_0x2d892b[_0x5edae3(0x143)](0x0,this['MAX_QUERY_ARRAY_ITEMS'])[_0x5edae3(0x135)](_0x5db293=>'\x27'+_0x5db293+'\x27')['join'](','))[_0x5edae3(0x142)](_0x5edae3(0x11e),_0x117b22),_0x53c7cf=await this['queryService'][_0x5edae3(0x134)](_0x14a65b);_0x2c8198[_0x5edae3(0x12a)](..._0x53c7cf);}return _0x2c8198[_0x5edae3(0x135)](_0x21ea06=>this[_0x5edae3(0x119)](_0x21ea06));}async['fetchBranchComponentsByFilenames'](_0xf3ae9a,_0x160944){const _0x196b9e=a130_0x3f773e,_0x34420a=[];while(_0xf3ae9a[_0x196b9e(0x12f)]){const _0x27389d=queries_1['GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY'][_0x196b9e(0x142)]('%fileNames%',_0xf3ae9a[_0x196b9e(0x143)](0x0,this[_0x196b9e(0x13c)])[_0x196b9e(0x135)](_0x4b9aea=>'\x27'+_0x4b9aea+'\x27')[_0x196b9e(0x141)](','))[_0x196b9e(0x142)](_0x196b9e(0x145),_0x160944),_0xa0604c=await this[_0x196b9e(0x11f)][_0x196b9e(0x134)](_0x27389d);_0x34420a[_0x196b9e(0x12a)](..._0xa0604c);}return _0x34420a['map'](_0x488e73=>this[_0x196b9e(0x119)](_0x488e73));}async[a130_0x3f773e(0x123)](_0x4606ee){const _0x4abb1c=a130_0x3f773e,_0x17802f=[],_0x4fe474=queries_1[_0x4abb1c(0x140)][_0x4abb1c(0x142)](_0x4abb1c(0x11e),_0x4606ee),_0x21409c=await this[_0x4abb1c(0x11f)][_0x4abb1c(0x134)](_0x4fe474);return _0x17802f['push'](..._0x21409c),_0x17802f[_0x4abb1c(0x135)](_0x1b7605=>this[_0x4abb1c(0x119)](_0x1b7605));}async[a130_0x3f773e(0x120)](_0x53a9cf){const _0x173bcf=a130_0x3f773e,_0x469276=[],_0x381aa6=queries_1[_0x173bcf(0x124)][_0x173bcf(0x142)](_0x173bcf(0x145),_0x53a9cf),_0x1cb87d=await this[_0x173bcf(0x11f)]['query'](_0x381aa6);return _0x469276[_0x173bcf(0x12a)](..._0x1cb87d),_0x469276[_0x173bcf(0x135)](_0x2231b0=>this['extractComponentMetadataFromRecord'](_0x2231b0));}async[a130_0x3f773e(0x136)](_0x7b4d9a){const _0x67b509=a130_0x3f773e,_0xedf1b7=[..._0x7b4d9a],_0x4d2230=[];while(_0xedf1b7[_0x67b509(0x12f)]){const _0x4107a5=queries_1[_0x67b509(0x112)][_0x67b509(0x142)](_0x67b509(0x115),_0xedf1b7[_0x67b509(0x143)](0x0,this[_0x67b509(0x13c)])[_0x67b509(0x135)](_0x2810b1=>'\x27'+_0x2810b1+'\x27')[_0x67b509(0x141)](',')),_0x1b4b6f=await this[_0x67b509(0x11f)][_0x67b509(0x134)](_0x4107a5);_0x4d2230['push'](..._0x1b4b6f['map'](_0x559bc0=>_0x559bc0['Id']));}return _0x4d2230;}async[a130_0x3f773e(0x113)](_0x453752,_0x5a2cc4){const _0x4d2d04=a130_0x3f773e;return this['restService']['post'](constants_1[_0x4d2d04(0x121)],{[constants_1[_0x4d2d04(0x12e)]+_0x4d2d04(0x129)]:_0x5a2cc4,[constants_1[_0x4d2d04(0x12e)]+_0x4d2d04(0x10e)]:_0x453752[_0x4d2d04(0x111)](0x0,0xff),[constants_1['FLOSUM_NAMESPACE']+_0x4d2d04(0x116)]:_0x4d2d04(0x117),[constants_1[_0x4d2d04(0x127)]+_0x4d2d04(0x14b)]:!![]});}};SalesforceGitSyncService=__decorate([typedi_1['Service'](),__metadata(a130_0x3f773e(0x14a),[salesforce_query_service_1[a130_0x3f773e(0x109)],salesforce_rest_service_1['SalesforceRestService']])],SalesforceGitSyncService),exports[a130_0x3f773e(0x137)]=SalesforceGitSyncService;