const a130_0x544c4a=a130_0x2fef;function a130_0x5c2e(){const _0x2cdad4=['NotFoundError','push','metadata','FLOSUM_NAMESPACE','GET_REPOSITORY_BY_NAME_QUERY','Repository\x20\x22','151412yHpyRR','\x22\x20not\x20found\x20in\x20flosum.','FLOSUM_GIT_NAMESPACE','CRC32__c','93TRpXpM','GET_BRANCH_COMPONENTS_QUERY','1069262rJjbGL','fetchBranchComponents','substr','350guuzgC','query','Version__c','11939748SpkBnr','GET_REPOSITORY_COMPONENTS_QUERY','SalesforceGitSyncService','queryService','Component_Type__c','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','getOwnPropertyDescriptor','decorate','replace','%branchId%','search','splice','File_Name__c','Component_Name__c','object','./salesforce-query.service','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','defineProperty','5808407mWHSQJ','(((.+)+)+)+$','fetchBranchComponentsByFilenames','map','Service','typedi','getRepositoryIdByName','Repository__c','%name%','post','Name','length','restService','FLOSUM_COMMIT','./salesforce-rest.service','extractFieldsFromRecord','fetchCommitManifestsByComponentIds','join','getComponentRecordTypes','%fileNames%','10146780qIfMWV','constructor','MAX_QUERY_ARRAY_ITEMS','fetchRepositoryComponents','Completed','14SOjvVq','Commit_Name__c','2PTRHwO','toString','fetchRepositoryComponentsByFilenames','10kpBdzw','1472072dUMjyn','GET_COMPONENT_RECORD_TYPES_QUERY','SalesforceQueryService','30234OiyQZY','extractComponentMetadataFromRecord','function','%repositoryId%'];a130_0x5c2e=function(){return _0x2cdad4;};return a130_0x5c2e();}(function(_0x563a49,_0x32b983){const _0x2099c3=a130_0x2fef,_0x460727=_0x563a49();while(!![]){try{const _0x5da3b8=parseInt(_0x2099c3(0x18f))/0x1*(parseInt(_0x2099c3(0x178))/0x2)+parseInt(_0x2099c3(0x18d))/0x3*(-parseInt(_0x2099c3(0x189))/0x4)+parseInt(_0x2099c3(0x192))/0x5*(-parseInt(_0x2099c3(0x17f))/0x6)+parseInt(_0x2099c3(0x176))/0x7*(-parseInt(_0x2099c3(0x17c))/0x8)+parseInt(_0x2099c3(0x171))/0x9*(parseInt(_0x2099c3(0x17b))/0xa)+-parseInt(_0x2099c3(0x15d))/0xb+parseInt(_0x2099c3(0x195))/0xc;if(_0x5da3b8===_0x32b983)break;else _0x460727['push'](_0x460727['shift']());}catch(_0x847e07){_0x460727['push'](_0x460727['shift']());}}}(a130_0x5c2e,0xbbd99));const a130_0x5a7199=(function(){let _0x43e1fa=!![];return function(_0xe7bc75,_0x565994){const _0x1bda65=_0x43e1fa?function(){if(_0x565994){const _0x3a1946=_0x565994['apply'](_0xe7bc75,arguments);return _0x565994=null,_0x3a1946;}}:function(){};return _0x43e1fa=![],_0x1bda65;};}()),a130_0x595128=a130_0x5a7199(this,function(){const _0x388a61=a130_0x2fef;return a130_0x595128[_0x388a61(0x179)]()[_0x388a61(0x19f)](_0x388a61(0x15e))[_0x388a61(0x179)]()[_0x388a61(0x172)](a130_0x595128)[_0x388a61(0x19f)](_0x388a61(0x15e));});a130_0x595128();'use strict';var __decorate=this&&this['__decorate']||function(_0x20bdd6,_0x2b06c7,_0x2ea304,_0x4a52a7){const _0x5a494e=a130_0x2fef;var _0x5dff69=arguments[_0x5a494e(0x168)],_0x5216e2=_0x5dff69<0x3?_0x2b06c7:_0x4a52a7===null?_0x4a52a7=Object[_0x5a494e(0x19b)](_0x2b06c7,_0x2ea304):_0x4a52a7,_0x2a7f9c;if(typeof Reflect==='object'&&typeof Reflect[_0x5a494e(0x19c)]===_0x5a494e(0x181))_0x5216e2=Reflect['decorate'](_0x20bdd6,_0x2b06c7,_0x2ea304,_0x4a52a7);else{for(var _0x14f786=_0x20bdd6['length']-0x1;_0x14f786>=0x0;_0x14f786--)if(_0x2a7f9c=_0x20bdd6[_0x14f786])_0x5216e2=(_0x5dff69<0x3?_0x2a7f9c(_0x5216e2):_0x5dff69>0x3?_0x2a7f9c(_0x2b06c7,_0x2ea304,_0x5216e2):_0x2a7f9c(_0x2b06c7,_0x2ea304))||_0x5216e2;}return _0x5dff69>0x3&&_0x5216e2&&Object[_0x5a494e(0x15c)](_0x2b06c7,_0x2ea304,_0x5216e2),_0x5216e2;},__metadata=this&&this['__metadata']||function(_0x21f266,_0x269fe9){const _0x548ccc=a130_0x2fef;if(typeof Reflect===_0x548ccc(0x1a3)&&typeof Reflect['metadata']===_0x548ccc(0x181))return Reflect[_0x548ccc(0x185)](_0x21f266,_0x269fe9);};Object[a130_0x544c4a(0x15c)](exports,'__esModule',{'value':!![]}),exports[a130_0x544c4a(0x197)]=void 0x0;function a130_0x2fef(_0x9d7a1d,_0x34f010){const _0x9e3091=a130_0x5c2e();return a130_0x2fef=function(_0x595128,_0x5a7199){_0x595128=_0x595128-0x15a;let _0x5c2e8c=_0x9e3091[_0x595128];return _0x5c2e8c;},a130_0x2fef(_0x9d7a1d,_0x34f010);}const not_found_error_1=require('../../../core/errors/not-found.error'),typedi_1=require(a130_0x544c4a(0x162)),constants_1=require('../../../constants'),queries_1=require('../queries'),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_query_service_1=require(a130_0x544c4a(0x15a)),salesforce_rest_service_1=require(a130_0x544c4a(0x16b));let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x2218fd,_0x15895c){const _0x3c9677=a130_0x544c4a;this[_0x3c9677(0x198)]=_0x2218fd,this[_0x3c9677(0x169)]=_0x15895c,this[_0x3c9677(0x173)]=0xc8;}['extractComponentMetadataFromRecord'](_0x5b9e77){const _0x57a6e4=a130_0x544c4a,_0x2b2d9e=flosum_naming_utils_1['extractFieldsFromRecord'](_0x5b9e77,[_0x57a6e4(0x1a2),'Component_Type__c',_0x57a6e4(0x18c),_0x57a6e4(0x1a1),'Version__c','Id']);return{'id':_0x2b2d9e['Id'],'name':_0x2b2d9e[_0x57a6e4(0x1a2)],'type':_0x2b2d9e[_0x57a6e4(0x199)],'fileName':_0x2b2d9e[_0x57a6e4(0x1a1)],'crc32':_0x2b2d9e[_0x57a6e4(0x18c)],'version':+_0x2b2d9e[_0x57a6e4(0x194)]};}async[a130_0x544c4a(0x163)](_0x3bc276){const _0x16b420=a130_0x544c4a,[_0x31eb8f]=await this['queryService'][_0x16b420(0x193)](queries_1[_0x16b420(0x187)][_0x16b420(0x19d)](_0x16b420(0x165),_0x3bc276));if(!_0x31eb8f)throw new not_found_error_1['NotFoundError'](_0x16b420(0x188)+_0x3bc276+'\x22\x20not\x20found\x20in\x20flosum.');return _0x31eb8f['Id'];}async['getBranchIdByName'](_0x28d56c){const _0x377313=a130_0x544c4a,[_0x1cddad]=await this[_0x377313(0x198)]['query'](queries_1['GET_BRANCH_BY_NAME_QUERY']['replace'](_0x377313(0x165),_0x28d56c));if(!_0x1cddad)throw new not_found_error_1[(_0x377313(0x183))]('Branch\x20\x22'+_0x28d56c+_0x377313(0x18a));return _0x1cddad['Id'];}async[a130_0x544c4a(0x16f)](){const _0x5d2456=a130_0x544c4a,_0x18b313=await this[_0x5d2456(0x198)][_0x5d2456(0x193)](queries_1[_0x5d2456(0x17d)]);return _0x18b313['map'](_0x7d2b59=>flosum_naming_utils_1[_0x5d2456(0x16c)](_0x7d2b59,['Id',_0x5d2456(0x167)]))[_0x5d2456(0x160)](_0x3f2819=>({'id':_0x3f2819['Id'],'name':_0x3f2819[_0x5d2456(0x167)]}));}async[a130_0x544c4a(0x17a)](_0x455f0d,_0x59ca82){const _0x4d2c7d=a130_0x544c4a,_0x399350=[];while(_0x455f0d[_0x4d2c7d(0x168)]){const _0xe25779=queries_1[_0x4d2c7d(0x15b)]['replace'](_0x4d2c7d(0x170),_0x455f0d[_0x4d2c7d(0x1a0)](0x0,this[_0x4d2c7d(0x173)])[_0x4d2c7d(0x160)](_0x34bd6a=>'\x27'+_0x34bd6a+'\x27')['join'](','))[_0x4d2c7d(0x19d)]('%repositoryId%',_0x59ca82),_0x34073b=await this[_0x4d2c7d(0x198)][_0x4d2c7d(0x193)](_0xe25779);_0x399350[_0x4d2c7d(0x184)](..._0x34073b);}return _0x399350['map'](_0xc32a9=>this['extractComponentMetadataFromRecord'](_0xc32a9));}async[a130_0x544c4a(0x15f)](_0x1759dc,_0x2a4984){const _0x2d0148=a130_0x544c4a,_0xb22daa=[];while(_0x1759dc['length']){const _0x29596f=queries_1['GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY'][_0x2d0148(0x19d)]('%fileNames%',_0x1759dc[_0x2d0148(0x1a0)](0x0,this[_0x2d0148(0x173)])['map'](_0x5ed72c=>'\x27'+_0x5ed72c+'\x27')[_0x2d0148(0x16e)](','))[_0x2d0148(0x19d)](_0x2d0148(0x19e),_0x2a4984),_0x14b73f=await this[_0x2d0148(0x198)]['query'](_0x29596f);_0xb22daa[_0x2d0148(0x184)](..._0x14b73f);}return _0xb22daa[_0x2d0148(0x160)](_0x173232=>this[_0x2d0148(0x180)](_0x173232));}async[a130_0x544c4a(0x174)](_0x2d8c5a){const _0x4c24c5=a130_0x544c4a,_0x311ed9=queries_1[_0x4c24c5(0x196)][_0x4c24c5(0x19d)](_0x4c24c5(0x182),_0x2d8c5a),_0x5efae6=await this[_0x4c24c5(0x198)][_0x4c24c5(0x193)](_0x311ed9);return _0x5efae6[_0x4c24c5(0x160)](_0x48a0a8=>this['extractComponentMetadataFromRecord'](_0x48a0a8));}async[a130_0x544c4a(0x190)](_0xc436ef){const _0x5d2876=a130_0x544c4a,_0x2b3c25=queries_1[_0x5d2876(0x18e)][_0x5d2876(0x19d)](_0x5d2876(0x19e),_0xc436ef),_0x12d899=await this[_0x5d2876(0x198)][_0x5d2876(0x193)](_0x2b3c25);return _0x12d899[_0x5d2876(0x160)](_0x567e48=>this[_0x5d2876(0x180)](_0x567e48));}async[a130_0x544c4a(0x16d)](_0xb3d7d){const _0x2eef8c=a130_0x544c4a,_0x2f3389=[..._0xb3d7d],_0x10b711=[];while(_0x2f3389['length']){const _0x22cd65=queries_1[_0x2eef8c(0x19a)][_0x2eef8c(0x19d)]('%componentIds%',_0x2f3389[_0x2eef8c(0x1a0)](0x0,this[_0x2eef8c(0x173)])[_0x2eef8c(0x160)](_0x2ba561=>'\x27'+_0x2ba561+'\x27')['join'](',')),_0x48600e=await this[_0x2eef8c(0x198)][_0x2eef8c(0x193)](_0x22cd65);_0x10b711[_0x2eef8c(0x184)](..._0x48600e[_0x2eef8c(0x160)](_0x1b4c0d=>_0x1b4c0d['Id']));}return _0x10b711;}async['createCommit'](_0xdb325a,_0x431e10){const _0x313a43=a130_0x544c4a;return this[_0x313a43(0x169)][_0x313a43(0x166)](constants_1[_0x313a43(0x16a)],{[constants_1[_0x313a43(0x186)]+_0x313a43(0x164)]:_0x431e10,[constants_1['FLOSUM_NAMESPACE']+_0x313a43(0x177)]:_0xdb325a[_0x313a43(0x191)](0x0,0xff),[constants_1[_0x313a43(0x186)]+'Status__c']:_0x313a43(0x175),[constants_1[_0x313a43(0x18b)]+'Is_From_Agent__c']:!![]});}};SalesforceGitSyncService=__decorate([typedi_1[a130_0x544c4a(0x161)](),__metadata('design:paramtypes',[salesforce_query_service_1[a130_0x544c4a(0x17e)],salesforce_rest_service_1['SalesforceRestService']])],SalesforceGitSyncService),exports[a130_0x544c4a(0x197)]=SalesforceGitSyncService;