const a130_0x359bb6=a130_0xcb97;(function(_0x2624e1,_0x1a91db){const _0x58cb86=a130_0xcb97,_0x4cc022=_0x2624e1();while(!![]){try{const _0x55323a=parseInt(_0x58cb86(0x19b))/0x1*(-parseInt(_0x58cb86(0x181))/0x2)+parseInt(_0x58cb86(0x18e))/0x3*(-parseInt(_0x58cb86(0x174))/0x4)+-parseInt(_0x58cb86(0x18c))/0x5+parseInt(_0x58cb86(0x15c))/0x6+parseInt(_0x58cb86(0x162))/0x7+-parseInt(_0x58cb86(0x15d))/0x8*(parseInt(_0x58cb86(0x16c))/0x9)+parseInt(_0x58cb86(0x17f))/0xa;if(_0x55323a===_0x1a91db)break;else _0x4cc022['push'](_0x4cc022['shift']());}catch(_0x24bbed){_0x4cc022['push'](_0x4cc022['shift']());}}}(a130_0x7ad9,0x7b606));const a130_0x13e096=(function(){let _0x240899=!![];return function(_0x1920c2,_0x2001f6){const _0x4be84e=_0x240899?function(){const _0x487c0f=a130_0xcb97;if(_0x2001f6){const _0x274bfe=_0x2001f6[_0x487c0f(0x184)](_0x1920c2,arguments);return _0x2001f6=null,_0x274bfe;}}:function(){};return _0x240899=![],_0x4be84e;};}()),a130_0x26765a=a130_0x13e096(this,function(){const _0x36865e=a130_0xcb97;return a130_0x26765a[_0x36865e(0x17a)]()['search'](_0x36865e(0x191))[_0x36865e(0x17a)]()[_0x36865e(0x171)](a130_0x26765a)['search']('(((.+)+)+)+$');});a130_0x26765a();function a130_0xcb97(_0x3477a,_0x386113){const _0x57b795=a130_0x7ad9();return a130_0xcb97=function(_0x26765a,_0x13e096){_0x26765a=_0x26765a-0x15c;let _0x7ad92c=_0x57b795[_0x26765a];return _0x7ad92c;},a130_0xcb97(_0x3477a,_0x386113);}'use strict';var __decorate=this&&this[a130_0x359bb6(0x185)]||function(_0x29e754,_0x4d2ec7,_0x5526b0,_0x546e6e){const _0x22444e=a130_0x359bb6;var _0x41781a=arguments['length'],_0x10fcc4=_0x41781a<0x3?_0x4d2ec7:_0x546e6e===null?_0x546e6e=Object[_0x22444e(0x18f)](_0x4d2ec7,_0x5526b0):_0x546e6e,_0x2d5bbf;if(typeof Reflect===_0x22444e(0x172)&&typeof Reflect[_0x22444e(0x175)]===_0x22444e(0x182))_0x10fcc4=Reflect['decorate'](_0x29e754,_0x4d2ec7,_0x5526b0,_0x546e6e);else{for(var _0x7ad592=_0x29e754[_0x22444e(0x19f)]-0x1;_0x7ad592>=0x0;_0x7ad592--)if(_0x2d5bbf=_0x29e754[_0x7ad592])_0x10fcc4=(_0x41781a<0x3?_0x2d5bbf(_0x10fcc4):_0x41781a>0x3?_0x2d5bbf(_0x4d2ec7,_0x5526b0,_0x10fcc4):_0x2d5bbf(_0x4d2ec7,_0x5526b0))||_0x10fcc4;}return _0x41781a>0x3&&_0x10fcc4&&Object['defineProperty'](_0x4d2ec7,_0x5526b0,_0x10fcc4),_0x10fcc4;},__metadata=this&&this[a130_0x359bb6(0x16d)]||function(_0x31163a,_0x16672e){const _0x428850=a130_0x359bb6;if(typeof Reflect===_0x428850(0x172)&&typeof Reflect[_0x428850(0x15f)]===_0x428850(0x182))return Reflect[_0x428850(0x15f)](_0x31163a,_0x16672e);};Object['defineProperty'](exports,a130_0x359bb6(0x190),{'value':!![]}),exports[a130_0x359bb6(0x179)]=void 0x0;const not_found_error_1=require(a130_0x359bb6(0x188)),typedi_1=require(a130_0x359bb6(0x173)),constants_1=require(a130_0x359bb6(0x170)),queries_1=require(a130_0x359bb6(0x16a)),flosum_naming_utils_1=require(a130_0x359bb6(0x169)),salesforce_query_service_1=require(a130_0x359bb6(0x189)),salesforce_rest_service_1=require('./salesforce-rest.service');function a130_0x7ad9(){const _0x59c9f6=['398380zGgZzG','decorate','Service','%branchId%','query','SalesforceGitSyncService','toString','design:paramtypes','Repository__c','%fileNames%','getBranchIdByName','18166550DMthRy','extractFieldsFromRecord','2LzYSdX','function','Completed','apply','__decorate','createCommit','SalesforceQueryService','../../../core/errors/not-found.error','./salesforce-query.service','%repositoryId%','MAX_QUERY_ARRAY_ITEMS','4731645MBfTtO','FLOSUM_NAMESPACE','12oRwCpc','getOwnPropertyDescriptor','__esModule','(((.+)+)+)+$','SalesforceRestService','GET_BRANCH_BY_NAME_QUERY','getComponentRecordTypes','CRC32__c','replace','post','\x22\x20not\x20found\x20in\x20flosum.','fetchBranchComponentsByFilenames','FLOSUM_COMMIT','691788XiQPPr','GET_COMPONENT_RECORD_TYPES_QUERY','map','Name','length','Component_Name__c','push','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','GET_BRANCH_COMPONENTS_QUERY','3517728SzbFEY','80gYQmnr','join','metadata','queryService','Repository\x20\x22','2498258NkdrrC','Branch\x20\x22','GET_REPOSITORY_COMPONENTS_QUERY','%name%','extractComponentMetadataFromRecord','restService','splice','../utils/flosum-naming.utils','../queries','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY','196191RwKGjq','__metadata','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','Component_Type__c','../../../constants','constructor','object','typedi'];a130_0x7ad9=function(){return _0x59c9f6;};return a130_0x7ad9();}let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x3d3e6a,_0x13b5ef){const _0x16e133=a130_0x359bb6;this[_0x16e133(0x160)]=_0x3d3e6a,this[_0x16e133(0x167)]=_0x13b5ef,this[_0x16e133(0x18b)]=0xc8;}[a130_0x359bb6(0x166)](_0x45a28e){const _0x4d0c88=a130_0x359bb6,_0x1412ae=flosum_naming_utils_1['extractFieldsFromRecord'](_0x45a28e,[_0x4d0c88(0x1a0),_0x4d0c88(0x16f),_0x4d0c88(0x195),'File_Name__c','Version__c','Id']);return{'id':_0x1412ae['Id'],'name':_0x1412ae[_0x4d0c88(0x1a0)],'type':_0x1412ae['Component_Type__c'],'fileName':_0x1412ae['File_Name__c'],'crc32':_0x1412ae[_0x4d0c88(0x195)],'version':+_0x1412ae['Version__c']};}async['getRepositoryIdByName'](_0x5b9587){const _0x559789=a130_0x359bb6,[_0x1f92cc]=await this[_0x559789(0x160)][_0x559789(0x178)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x559789(0x196)](_0x559789(0x165),_0x5b9587));if(!_0x1f92cc)throw new not_found_error_1['NotFoundError'](_0x559789(0x161)+_0x5b9587+_0x559789(0x198));return _0x1f92cc['Id'];}async[a130_0x359bb6(0x17e)](_0x5df815){const _0xb3184c=a130_0x359bb6,[_0x304ea5]=await this[_0xb3184c(0x160)]['query'](queries_1[_0xb3184c(0x193)]['replace'](_0xb3184c(0x165),_0x5df815));if(!_0x304ea5)throw new not_found_error_1['NotFoundError'](_0xb3184c(0x163)+_0x5df815+'\x22\x20not\x20found\x20in\x20flosum.');return _0x304ea5['Id'];}async[a130_0x359bb6(0x194)](){const _0x325bd2=a130_0x359bb6,_0x389710=await this[_0x325bd2(0x160)][_0x325bd2(0x178)](queries_1[_0x325bd2(0x19c)]);return _0x389710['map'](_0x28d93a=>flosum_naming_utils_1[_0x325bd2(0x180)](_0x28d93a,['Id',_0x325bd2(0x19e)]))[_0x325bd2(0x19d)](_0x626620=>({'id':_0x626620['Id'],'name':_0x626620[_0x325bd2(0x19e)]}));}async['fetchRepositoryComponentsByFilenames'](_0x1f5a4d,_0x3789e3){const _0x2fee9a=a130_0x359bb6,_0x579184=[];while(_0x1f5a4d[_0x2fee9a(0x19f)]){const _0x2890f4=queries_1[_0x2fee9a(0x16e)][_0x2fee9a(0x196)](_0x2fee9a(0x17d),_0x1f5a4d[_0x2fee9a(0x168)](0x0,this[_0x2fee9a(0x18b)])[_0x2fee9a(0x19d)](_0x362221=>'\x27'+_0x362221+'\x27')['join'](','))[_0x2fee9a(0x196)](_0x2fee9a(0x18a),_0x3789e3),_0x23727e=await this['queryService'][_0x2fee9a(0x178)](_0x2890f4);_0x579184[_0x2fee9a(0x1a1)](..._0x23727e);}return _0x579184[_0x2fee9a(0x19d)](_0xd3c1ad=>this['extractComponentMetadataFromRecord'](_0xd3c1ad));}async[a130_0x359bb6(0x199)](_0x5d1933,_0x3f7b32){const _0x28bfe3=a130_0x359bb6,_0x48612a=[];while(_0x5d1933[_0x28bfe3(0x19f)]){const _0x421626=queries_1[_0x28bfe3(0x16b)][_0x28bfe3(0x196)](_0x28bfe3(0x17d),_0x5d1933['splice'](0x0,this[_0x28bfe3(0x18b)])['map'](_0x362de1=>'\x27'+_0x362de1+'\x27')['join'](','))[_0x28bfe3(0x196)](_0x28bfe3(0x177),_0x3f7b32),_0x37f4bd=await this[_0x28bfe3(0x160)]['query'](_0x421626);_0x48612a[_0x28bfe3(0x1a1)](..._0x37f4bd);}return _0x48612a[_0x28bfe3(0x19d)](_0x513899=>this[_0x28bfe3(0x166)](_0x513899));}async['fetchRepositoryComponents'](_0x2fef03){const _0x2d46f3=a130_0x359bb6,_0x1a9925=[],_0x4130b2=queries_1[_0x2d46f3(0x164)][_0x2d46f3(0x196)](_0x2d46f3(0x18a),_0x2fef03),_0x5e3cab=await this[_0x2d46f3(0x160)]['query'](_0x4130b2);return _0x1a9925['push'](..._0x5e3cab),_0x1a9925[_0x2d46f3(0x19d)](_0x536f83=>this[_0x2d46f3(0x166)](_0x536f83));}async['fetchBranchComponents'](_0x34edea){const _0x1faf8e=a130_0x359bb6,_0x485073=[],_0x5bcf4d=queries_1[_0x1faf8e(0x1a3)][_0x1faf8e(0x196)](_0x1faf8e(0x177),_0x34edea),_0x4e991c=await this[_0x1faf8e(0x160)][_0x1faf8e(0x178)](_0x5bcf4d);return _0x485073[_0x1faf8e(0x1a1)](..._0x4e991c),_0x485073[_0x1faf8e(0x19d)](_0x4a82f4=>this[_0x1faf8e(0x166)](_0x4a82f4));}async['fetchCommitManifestsByComponentIds'](_0x5095ef){const _0x42823c=a130_0x359bb6,_0x50fb4a=[..._0x5095ef],_0x495c63=[];while(_0x50fb4a['length']){const _0x164f5d=queries_1[_0x42823c(0x1a2)]['replace']('%componentIds%',_0x50fb4a[_0x42823c(0x168)](0x0,this['MAX_QUERY_ARRAY_ITEMS'])[_0x42823c(0x19d)](_0x4e841c=>'\x27'+_0x4e841c+'\x27')[_0x42823c(0x15e)](',')),_0x25c09a=await this[_0x42823c(0x160)][_0x42823c(0x178)](_0x164f5d);_0x495c63['push'](..._0x25c09a[_0x42823c(0x19d)](_0x5d85e1=>_0x5d85e1['Id']));}return _0x495c63;}async[a130_0x359bb6(0x186)](_0x5f1dca,_0x3736e8){const _0x251a55=a130_0x359bb6;return this[_0x251a55(0x167)][_0x251a55(0x197)](constants_1[_0x251a55(0x19a)],{[constants_1[_0x251a55(0x18d)]+_0x251a55(0x17c)]:_0x3736e8,[constants_1[_0x251a55(0x18d)]+'Commit_Name__c']:_0x5f1dca['substr'](0x0,0xff),[constants_1[_0x251a55(0x18d)]+'Status__c']:_0x251a55(0x183),[constants_1['FLOSUM_GIT_NAMESPACE']+'Is_From_Agent__c']:!![]});}};SalesforceGitSyncService=__decorate([typedi_1[a130_0x359bb6(0x176)](),__metadata(a130_0x359bb6(0x17b),[salesforce_query_service_1[a130_0x359bb6(0x187)],salesforce_rest_service_1[a130_0x359bb6(0x192)]])],SalesforceGitSyncService),exports['SalesforceGitSyncService']=SalesforceGitSyncService;