const a127_0x3769e1=a127_0x55c0;(function(_0xfb0c3,_0x3cdae2){const _0xa7603a=a127_0x55c0,_0x5c0746=_0xfb0c3();while(!![]){try{const _0x3122a0=parseInt(_0xa7603a(0xee))/0x1+parseInt(_0xa7603a(0x105))/0x2*(-parseInt(_0xa7603a(0xeb))/0x3)+-parseInt(_0xa7603a(0xf3))/0x4*(-parseInt(_0xa7603a(0xf7))/0x5)+-parseInt(_0xa7603a(0x11c))/0x6+parseInt(_0xa7603a(0xff))/0x7+-parseInt(_0xa7603a(0x131))/0x8+parseInt(_0xa7603a(0x102))/0x9*(-parseInt(_0xa7603a(0xe5))/0xa);if(_0x3122a0===_0x3cdae2)break;else _0x5c0746['push'](_0x5c0746['shift']());}catch(_0x4a4975){_0x5c0746['push'](_0x5c0746['shift']());}}}(a127_0x220e,0xa796a));const a127_0x5e9d7d=(function(){let _0x25334a=!![];return function(_0x28386f,_0x3261ed){const _0x568aaa=_0x25334a?function(){const _0x3af055=a127_0x55c0;if(_0x3261ed){const _0x1bedad=_0x3261ed[_0x3af055(0x11f)](_0x28386f,arguments);return _0x3261ed=null,_0x1bedad;}}:function(){};return _0x25334a=![],_0x568aaa;};}()),a127_0x31a76b=a127_0x5e9d7d(this,function(){const _0x3afd09=a127_0x55c0;return a127_0x31a76b[_0x3afd09(0x101)]()['search'](_0x3afd09(0xfc))[_0x3afd09(0x101)]()[_0x3afd09(0x107)](a127_0x31a76b)[_0x3afd09(0xf4)]('(((.+)+)+)+$');});a127_0x31a76b();'use strict';var __importDefault=this&&this[a127_0x3769e1(0x12d)]||function(_0x56240e){const _0x5a2ad9=a127_0x3769e1;return _0x56240e&&_0x56240e[_0x5a2ad9(0xfe)]?_0x56240e:{'default':_0x56240e};};Object[a127_0x3769e1(0xed)](exports,a127_0x3769e1(0xfe),{'value':!![]}),exports[a127_0x3769e1(0x128)]=void 0x0;function a127_0x55c0(_0x4727a6,_0x410680){const _0x7efd82=a127_0x220e();return a127_0x55c0=function(_0x31a76b,_0x5e9d7d){_0x31a76b=_0x31a76b-0xe5;let _0x220eee=_0x7efd82[_0x31a76b];return _0x220eee;},a127_0x55c0(_0x4727a6,_0x410680);}const core_1=require(a127_0x3769e1(0x10f)),typedi_1=__importDefault(require(a127_0x3769e1(0xec))),constants_1=require(a127_0x3769e1(0xf2)),utils_1=require(a127_0x3769e1(0xe7)),salesforce_error_1=require(a127_0x3769e1(0x12f)),composite_utils_1=require(a127_0x3769e1(0xf5)),salesforce_components_manager_service_1=require(a127_0x3769e1(0x120)),salesforce_composite_service_1=require('./salesforce-composite.service'),salesforce_git_sync_service_1=require(a127_0x3769e1(0x10b));class SalesforceCommitsManager{constructor(_0xe1b907){const _0x9beb6e=a127_0x3769e1;this['options']=_0xe1b907,this[_0x9beb6e(0x112)]=0x3,this[_0x9beb6e(0x114)]=new core_1[(_0x9beb6e(0x10d))](SalesforceCommitsManager['name']),this[_0x9beb6e(0x109)]=this[_0x9beb6e(0x111)]['logger'],this['composite']=typedi_1[_0x9beb6e(0x125)][_0x9beb6e(0xfa)](salesforce_composite_service_1[_0x9beb6e(0x12b)]),this[_0x9beb6e(0x11b)]=typedi_1['default'][_0x9beb6e(0xfa)](salesforce_git_sync_service_1[_0x9beb6e(0xfd)]),this['proceededComponentsMeta']=[];}async['proceedRequests'](_0x257376,_0x30365d=![]){const _0x4dc23b=a127_0x3769e1,_0x3bb653=(this[_0x4dc23b(0x112)]+ +_0x30365d)*0x3,_0xeae4ca=utils_1[_0x4dc23b(0xe9)](_0x257376,_0x3bb653);try{while(_0xeae4ca['length']){const _0x531077=_0xeae4ca[_0x4dc23b(0x104)](0x0,Math[_0x4dc23b(0x110)](constants_1[_0x4dc23b(0x122)]/_0x3bb653));await this['sfLogger'][_0x4dc23b(0x121)](_0x4dc23b(0xf1)+_0x531077['length']*_0x3bb653+'\x20requests\x20to\x20composite\x20api.')['send']();const _0x3465f3=_0x531077[_0x4dc23b(0x115)]((_0x3dbde1,_0x17a82b)=>({'graphId':_0x4dc23b(0x100)+_0x17a82b,'compositeRequest':_0x3dbde1})),_0x5ab925=await this[_0x4dc23b(0x119)][_0x4dc23b(0xe8)](_0x3465f3);if(_0x30365d){const _0x1b7a9c=composite_utils_1['extractComponentIdsFromGraphsResponse'](_0x5ab925);for(const {id:_0x3df21d,ref:_0x1466b9}of _0x1b7a9c){const _0x4f3078=this['proceededComponentsMeta'][_0x4dc23b(0x118)](_0x14748a=>_0x14748a[_0x4dc23b(0xf0)]===_0x1466b9);_0x4f3078&&(_0x4f3078[_0x4dc23b(0x130)]=_0x3df21d);}}}}catch(_0x4ad6c3){this[_0x4dc23b(0x114)]['error'](_0x4ad6c3 instanceof salesforce_error_1[_0x4dc23b(0x108)]?JSON['stringify'](_0x4ad6c3[_0x4dc23b(0x10e)](),null,0x2):_0x4ad6c3),this['sfLogger'][_0x4dc23b(0x121)](_0x4ad6c3 instanceof salesforce_error_1[_0x4dc23b(0x108)]?JSON[_0x4dc23b(0x10c)](_0x4ad6c3[_0x4dc23b(0x10e)](),null,0x2):_0x4ad6c3[_0x4dc23b(0x101)]());throw _0x4ad6c3;}}async[a127_0x3769e1(0x127)](_0x14d328){const _0x152a88=a127_0x3769e1;for(const _0x57375a of _0x14d328){if(!_0x57375a[_0x152a88(0xf8)][_0x152a88(0xea)]&&!_0x57375a[_0x152a88(0x103)][_0x152a88(0xea)]&&!_0x57375a[_0x152a88(0x124)][_0x152a88(0xea)])continue;const _0x30925c=[],_0x1e296f=[],_0x3d3353=new salesforce_components_manager_service_1[(_0x152a88(0xf9))](this[_0x152a88(0x111)][_0x152a88(0x12c)],this[_0x152a88(0x111)][_0x152a88(0x117)],_0x57375a[_0x152a88(0xfb)],this['options']['recordTypes'],this[_0x152a88(0x129)]);_0x30925c[_0x152a88(0x106)](...await _0x3d3353['insert'](_0x57375a[_0x152a88(0xf8)],this[_0x152a88(0x111)]['commitId'])),_0x30925c['push'](...await _0x3d3353[_0x152a88(0x116)](_0x57375a[_0x152a88(0x103)],this[_0x152a88(0x111)][_0x152a88(0x11d)])),_0x1e296f[_0x152a88(0x106)](await _0x3d3353[_0x152a88(0x12e)](_0x57375a[_0x152a88(0x124)],!![])),this['proceededComponentsMeta']=_0x3d3353[_0x152a88(0x11a)](),await this[_0x152a88(0xe6)](_0x30925c,!![]);for(const _0x523dd4 of _0x1e296f){_0x523dd4[_0x152a88(0xef)][_0x152a88(0xea)]&&await this['proceedRequests'](_0x523dd4[_0x152a88(0xef)],!![]),_0x523dd4[_0x152a88(0x10a)][_0x152a88(0xea)]&&await this[_0x152a88(0xe6)](_0x523dd4[_0x152a88(0x10a)],!![]),_0x523dd4[_0x152a88(0xf6)][_0x152a88(0xea)]&&await this[_0x152a88(0xe6)](_0x523dd4[_0x152a88(0xf6)],!![]);}this[_0x152a88(0x114)][_0x152a88(0x121)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x30925c['length']);}}async[a127_0x3769e1(0x126)](_0x5eba37){const _0x420695=a127_0x3769e1,_0x49cc88=[],_0x2c12b1=[];for(const _0x3be856 of _0x5eba37){if(!_0x3be856[_0x420695(0xf8)]['length']&&!_0x3be856[_0x420695(0x103)][_0x420695(0xea)]&&!_0x3be856[_0x420695(0x124)]['length'])continue;const _0x3414b8=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x420695(0x111)][_0x420695(0x12c)],this[_0x420695(0x111)]['branchId'],_0x3be856[_0x420695(0xfb)],this[_0x420695(0x111)][_0x420695(0x11e)],[]);_0x49cc88[_0x420695(0x106)](...await _0x3414b8[_0x420695(0x123)](_0x3be856[_0x420695(0xf8)])),_0x49cc88[_0x420695(0x106)](...await _0x3414b8[_0x420695(0x116)](_0x3be856[_0x420695(0x103)])),_0x2c12b1[_0x420695(0x106)](await _0x3414b8[_0x420695(0x12e)](_0x3be856[_0x420695(0x124)]));}this[_0x420695(0x114)][_0x420695(0x121)](_0x420695(0x12a),_0x49cc88[_0x420695(0xea)]),await this['proceedRequests'](_0x49cc88);const _0x4af459=_0x2c12b1['reduce']((_0x3f6cf9,_0xebac20)=>({'manifests':[..._0x3f6cf9[_0x420695(0xef)],..._0xebac20[_0x420695(0xef)]],'componentsToDelete':[..._0x3f6cf9[_0x420695(0xf6)],..._0xebac20[_0x420695(0xf6)]],'componentsToUpdate':[..._0x3f6cf9[_0x420695(0x10a)],..._0xebac20[_0x420695(0x10a)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x4af459[_0x420695(0xef)][_0x420695(0xea)]&&await this[_0x420695(0xe6)](_0x4af459[_0x420695(0xef)],!![]),_0x4af459[_0x420695(0x10a)][_0x420695(0xea)]&&await this[_0x420695(0xe6)](_0x4af459[_0x420695(0x10a)],!![]),_0x4af459[_0x420695(0xf6)][_0x420695(0xea)]&&await this[_0x420695(0xe6)](_0x4af459[_0x420695(0xf6)],!![]);}async[a127_0x3769e1(0x113)](_0x5355d5){const _0x1a555e=a127_0x3769e1;this['options'][_0x1a555e(0x117)]?await this[_0x1a555e(0x126)](_0x5355d5):await this[_0x1a555e(0x127)](_0x5355d5);}}function a127_0x220e(){const _0x3da11a=['executeGraphs','chunkArray','length','428394hOfOCC','typedi','defineProperty','279086UtVggE','manifests','reference','[INFO]\x20Sending\x20','../../../constants','1720aXyqTH','search','../utils/composite.utils','componentsToDelete','6485Ttwybg','inserted','SalesforceComponentsManager','get','author','(((.+)+)+)+$','SalesforceGitSyncService','__esModule','8998906CYvfOb','graph','toString','173997TgNpyF','modified','splice','4sARMBr','push','constructor','SalesforceError','sfLogger','componentsToUpdate','./salesforce-git-sync.service','stringify','Logger','toJSON','../../../core','floor','options','COMPONENTS_PER_CHUNK','proceedCommits','logger','map','update','branchId','find','composite','getProceededComponentsMeta','gitSync','6529938BPqUUx','commitId','recordTypes','apply','./salesforce-components-manager.service','log','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','insert','removed','default','proceedCommitsToBranch','proceedCommitsToRepository','SalesforceCommitsManager','proceededComponentsMeta','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','SalesforceCompositeService','repositoryId','__importDefault','delete','../errors/salesforce.error','componentId','31952DHQyfx','30oTHeLc','proceedRequests','../../shared/utils'];a127_0x220e=function(){return _0x3da11a;};return a127_0x220e();}exports[a127_0x3769e1(0x128)]=SalesforceCommitsManager;