const a126_0x1ad591=a126_0x1ac1;(function(_0x1d76be,_0x4b99bd){const _0x307436=a126_0x1ac1,_0x1b689b=_0x1d76be();while(!![]){try{const _0x13c6a0=-parseInt(_0x307436(0x108))/0x1+parseInt(_0x307436(0x118))/0x2*(parseInt(_0x307436(0x11d))/0x3)+parseInt(_0x307436(0x128))/0x4+-parseInt(_0x307436(0x106))/0x5*(parseInt(_0x307436(0x114))/0x6)+parseInt(_0x307436(0xf4))/0x7+parseInt(_0x307436(0x129))/0x8*(-parseInt(_0x307436(0x10e))/0x9)+parseInt(_0x307436(0x110))/0xa;if(_0x13c6a0===_0x4b99bd)break;else _0x1b689b['push'](_0x1b689b['shift']());}catch(_0x5764fd){_0x1b689b['push'](_0x1b689b['shift']());}}}(a126_0x3eb1,0xcc9d0));const a126_0x32a18a=(function(){let _0x5a2ab9=!![];return function(_0x52e786,_0x25e7ac){const _0x55ec3a=_0x5a2ab9?function(){if(_0x25e7ac){const _0x26627a=_0x25e7ac['apply'](_0x52e786,arguments);return _0x25e7ac=null,_0x26627a;}}:function(){};return _0x5a2ab9=![],_0x55ec3a;};}()),a126_0x2028f1=a126_0x32a18a(this,function(){const _0x5aa71d=a126_0x1ac1;return a126_0x2028f1[_0x5aa71d(0xf6)]()['search'](_0x5aa71d(0x11e))[_0x5aa71d(0xf6)]()[_0x5aa71d(0x11c)](a126_0x2028f1)['search'](_0x5aa71d(0x11e));});a126_0x2028f1();function a126_0x3eb1(){const _0x389a2c=['../../shared/utils','[INFO]\x20Sending\x20','../utils/composite.utils','map','proceedCommitsToBranch','manifests','toJSON','executeGraphs','8380190bhKDqD','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','toString','Logger','removed','repositoryId','componentsToDelete','logger','chunkArray','modified','__esModule','delete','proceededComponentsMeta','SalesforceCommitsManager','update','./salesforce-composite.service','get','reference','25QHZzCX','insert','1649890ELIvYv','composite','author','getProceededComponentsMeta','../errors/salesforce.error','inserted','252RLymlS','gitSync','24779400ofOOWC','../../../core','./salesforce-git-sync.service','reduce','1301052hqPtWe','./salesforce-components-manager.service','componentsToUpdate','defineProperty','352EQEobP','error','stringify','default','constructor','1212OETFaQ','(((.+)+)+)+$','proceedCommitsToRepository','push','proceedCommits','componentId','recordTypes','find','SalesforceError','options','branchId','3012136FbmLBx','264872dPFUPl','floor','SalesforceGitSyncService','log','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','SalesforceComponentsManager','proceedRequests','length','\x20requests\x20to\x20composite\x20api.','sfLogger','COMPONENTS_PER_CHUNK'];a126_0x3eb1=function(){return _0x389a2c;};return a126_0x3eb1();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x12d0ce){const _0x170e45=a126_0x1ac1;return _0x12d0ce&&_0x12d0ce[_0x170e45(0xfe)]?_0x12d0ce:{'default':_0x12d0ce};};function a126_0x1ac1(_0x3e704d,_0x14e375){const _0x4fe862=a126_0x3eb1();return a126_0x1ac1=function(_0x2028f1,_0x32a18a){_0x2028f1=_0x2028f1-0xe4;let _0x3eb17f=_0x4fe862[_0x2028f1];return _0x3eb17f;},a126_0x1ac1(_0x3e704d,_0x14e375);}Object[a126_0x1ad591(0x117)](exports,'__esModule',{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require(a126_0x1ad591(0x111)),typedi_1=__importDefault(require('typedi')),constants_1=require('../../../constants'),utils_1=require(a126_0x1ad591(0xec)),salesforce_error_1=require(a126_0x1ad591(0x10c)),composite_utils_1=require(a126_0x1ad591(0xee)),salesforce_components_manager_service_1=require(a126_0x1ad591(0x115)),salesforce_composite_service_1=require(a126_0x1ad591(0x103)),salesforce_git_sync_service_1=require(a126_0x1ad591(0x112));class SalesforceCommitsManager{constructor(_0x59b5be){const _0xd8c4ce=a126_0x1ad591;this[_0xd8c4ce(0x126)]=_0x59b5be,this[_0xd8c4ce(0xeb)]=0x3,this[_0xd8c4ce(0xfb)]=new core_1[(_0xd8c4ce(0xf7))](SalesforceCommitsManager['name']),this[_0xd8c4ce(0xea)]=this[_0xd8c4ce(0x126)][_0xd8c4ce(0xfb)],this[_0xd8c4ce(0x109)]=typedi_1[_0xd8c4ce(0x11b)][_0xd8c4ce(0x104)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0xd8c4ce(0x10f)]=typedi_1[_0xd8c4ce(0x11b)]['get'](salesforce_git_sync_service_1[_0xd8c4ce(0x12b)]),this[_0xd8c4ce(0x100)]=[];}async['proceedRequests'](_0x2793f3,_0x196f13=![]){const _0x30301f=a126_0x1ad591,_0x1ccbf3=(this['COMPONENTS_PER_CHUNK']+ +_0x196f13)*0x3,_0x40664e=utils_1[_0x30301f(0xfc)](_0x2793f3,_0x1ccbf3);try{while(_0x40664e[_0x30301f(0xe8)]){const _0x29d13a=_0x40664e['splice'](0x0,Math[_0x30301f(0x12a)](constants_1[_0x30301f(0xe5)]/_0x1ccbf3));await this[_0x30301f(0xea)][_0x30301f(0xe4)](_0x30301f(0xed)+_0x29d13a[_0x30301f(0xe8)]*_0x1ccbf3+_0x30301f(0xe9))['send']();const _0x978bb0=_0x29d13a[_0x30301f(0xef)]((_0x3851fa,_0x619bdd)=>({'graphId':'graph'+_0x619bdd,'compositeRequest':_0x3851fa})),_0x192d35=await this['composite'][_0x30301f(0xf3)](_0x978bb0);if(_0x196f13){const _0x5aca62=composite_utils_1['extractComponentIdsFromGraphsResponse'](_0x192d35);for(const {id:_0x4c319d,ref:_0x2f40a3}of _0x5aca62){const _0x1bdca3=this[_0x30301f(0x100)][_0x30301f(0x124)](_0x3c6390=>_0x3c6390[_0x30301f(0x105)]===_0x2f40a3);_0x1bdca3&&(_0x1bdca3[_0x30301f(0x122)]=_0x4c319d);}}}}catch(_0x4e5e18){this[_0x30301f(0xfb)][_0x30301f(0x119)](_0x4e5e18 instanceof salesforce_error_1['SalesforceError']?JSON[_0x30301f(0x11a)](_0x4e5e18[_0x30301f(0xf2)](),null,0x2):_0x4e5e18),this[_0x30301f(0xea)][_0x30301f(0xe4)](_0x4e5e18 instanceof salesforce_error_1[_0x30301f(0x125)]?JSON['stringify'](_0x4e5e18[_0x30301f(0xf2)](),null,0x2):_0x4e5e18['toString']());throw _0x4e5e18;}}async[a126_0x1ad591(0x11f)](_0x19e50b){const _0x2285ac=a126_0x1ad591;for(const _0x507804 of _0x19e50b){if(!_0x507804[_0x2285ac(0x10d)]['length']&&!_0x507804[_0x2285ac(0xfd)][_0x2285ac(0xe8)]&&!_0x507804[_0x2285ac(0xf8)][_0x2285ac(0xe8)])continue;const _0x1cff3c=[],_0x1a6aae=[],_0x476526=new salesforce_components_manager_service_1[(_0x2285ac(0xe6))](this[_0x2285ac(0x126)][_0x2285ac(0xf9)],this[_0x2285ac(0x126)]['branchId'],_0x507804[_0x2285ac(0x10a)],this[_0x2285ac(0x126)][_0x2285ac(0x123)],this[_0x2285ac(0x100)]);_0x1cff3c[_0x2285ac(0x120)](...await _0x476526[_0x2285ac(0x107)](_0x507804[_0x2285ac(0x10d)],this[_0x2285ac(0x126)]['commitId'])),_0x1cff3c[_0x2285ac(0x120)](...await _0x476526['update'](_0x507804[_0x2285ac(0xfd)],this[_0x2285ac(0x126)]['commitId'])),_0x1a6aae['push'](await _0x476526[_0x2285ac(0xff)](_0x507804[_0x2285ac(0xf8)],!![])),this[_0x2285ac(0x100)]=_0x476526[_0x2285ac(0x10b)](),await this['proceedRequests'](_0x1cff3c,!![]);for(const _0x23ac86 of _0x1a6aae){_0x23ac86[_0x2285ac(0xf1)]['length']&&await this[_0x2285ac(0xe7)](_0x23ac86[_0x2285ac(0xf1)],!![]),_0x23ac86['componentsToUpdate'][_0x2285ac(0xe8)]&&await this[_0x2285ac(0xe7)](_0x23ac86[_0x2285ac(0x116)],!![]),_0x23ac86[_0x2285ac(0xfa)][_0x2285ac(0xe8)]&&await this[_0x2285ac(0xe7)](_0x23ac86[_0x2285ac(0xfa)],!![]);}this[_0x2285ac(0xfb)][_0x2285ac(0xe4)](_0x2285ac(0xf5),_0x1cff3c[_0x2285ac(0xe8)]);}}async['proceedCommitsToBranch'](_0x16e160){const _0x418b71=a126_0x1ad591,_0x425e97=[],_0x37ae89=[];for(const _0x21b100 of _0x16e160){if(!_0x21b100['inserted'][_0x418b71(0xe8)]&&!_0x21b100['modified'][_0x418b71(0xe8)]&&!_0x21b100[_0x418b71(0xf8)][_0x418b71(0xe8)])continue;const _0x11bed6=new salesforce_components_manager_service_1[(_0x418b71(0xe6))](this[_0x418b71(0x126)][_0x418b71(0xf9)],this[_0x418b71(0x126)][_0x418b71(0x127)],_0x21b100[_0x418b71(0x10a)],this['options'][_0x418b71(0x123)],[]);_0x425e97[_0x418b71(0x120)](...await _0x11bed6[_0x418b71(0x107)](_0x21b100['inserted'])),_0x425e97[_0x418b71(0x120)](...await _0x11bed6[_0x418b71(0x102)](_0x21b100[_0x418b71(0xfd)])),_0x37ae89[_0x418b71(0x120)](await _0x11bed6[_0x418b71(0xff)](_0x21b100[_0x418b71(0xf8)]));}this[_0x418b71(0xfb)][_0x418b71(0xe4)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x425e97[_0x418b71(0xe8)]),await this[_0x418b71(0xe7)](_0x425e97);const _0x4790e9=_0x37ae89[_0x418b71(0x113)]((_0x5c2bf5,_0x28891e)=>({'manifests':[..._0x5c2bf5[_0x418b71(0xf1)],..._0x28891e[_0x418b71(0xf1)]],'componentsToDelete':[..._0x5c2bf5['componentsToDelete'],..._0x28891e[_0x418b71(0xfa)]],'componentsToUpdate':[..._0x5c2bf5[_0x418b71(0x116)],..._0x28891e[_0x418b71(0x116)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x4790e9[_0x418b71(0xf1)][_0x418b71(0xe8)]&&await this['proceedRequests'](_0x4790e9[_0x418b71(0xf1)],!![]),_0x4790e9[_0x418b71(0x116)]['length']&&await this['proceedRequests'](_0x4790e9[_0x418b71(0x116)],!![]),_0x4790e9[_0x418b71(0xfa)][_0x418b71(0xe8)]&&await this[_0x418b71(0xe7)](_0x4790e9[_0x418b71(0xfa)],!![]);}async[a126_0x1ad591(0x121)](_0x3d2ac7){const _0x397a3a=a126_0x1ad591;this[_0x397a3a(0x126)]['branchId']?await this[_0x397a3a(0xf0)](_0x3d2ac7):await this[_0x397a3a(0x11f)](_0x3d2ac7);}}exports[a126_0x1ad591(0x101)]=SalesforceCommitsManager;