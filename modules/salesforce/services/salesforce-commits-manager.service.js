const a127_0x5d3201=a127_0x4d96;(function(_0x3694c0,_0x496654){const _0x35df17=a127_0x4d96,_0x10938b=_0x3694c0();while(!![]){try{const _0x46344b=parseInt(_0x35df17(0x1db))/0x1+parseInt(_0x35df17(0x1e0))/0x2+parseInt(_0x35df17(0x1c9))/0x3*(parseInt(_0x35df17(0x1ce))/0x4)+parseInt(_0x35df17(0x1b2))/0x5*(-parseInt(_0x35df17(0x1f2))/0x6)+-parseInt(_0x35df17(0x1e1))/0x7+-parseInt(_0x35df17(0x1b5))/0x8+parseInt(_0x35df17(0x1b6))/0x9;if(_0x46344b===_0x496654)break;else _0x10938b['push'](_0x10938b['shift']());}catch(_0x50f283){_0x10938b['push'](_0x10938b['shift']());}}}(a127_0x2f72,0x4c92c));const a127_0x288775=(function(){let _0xdc0750=!![];return function(_0x437c9a,_0x27ad89){const _0x485be3=_0xdc0750?function(){const _0x40c32b=a127_0x4d96;if(_0x27ad89){const _0x146be7=_0x27ad89[_0x40c32b(0x1d6)](_0x437c9a,arguments);return _0x27ad89=null,_0x146be7;}}:function(){};return _0xdc0750=![],_0x485be3;};}()),a127_0x2ebbc0=a127_0x288775(this,function(){const _0x254263=a127_0x4d96;return a127_0x2ebbc0['toString']()[_0x254263(0x1b0)](_0x254263(0x1f7))[_0x254263(0x1c3)]()[_0x254263(0x1ee)](a127_0x2ebbc0)[_0x254263(0x1b0)](_0x254263(0x1f7));});function a127_0x2f72(){const _0x26c6c1=['search','./salesforce-components-manager.service','5NklIoK','error','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','1774168soTKaO','3519369XmNxcy','[INFO]\x20Sending\x20','author','extractComponentIdsFromGraphsResponse','SalesforceError','removed','inserted','insert','logger','componentsToUpdate','__esModule','defineProperty','typedi','toString','push','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','SalesforceCompositeService','proceedCommitsToRepository','send','598569wZpAYT','proceedRequests','../../../constants','commitId','map','8eiyVYc','../../../core','floor','composite','componentsToDelete','__importDefault','executeGraphs','delete','apply','modified','../../shared/utils','proceedCommitsToBranch','SalesforceComponentsManager','269167JhtniI','Logger','manifests','log','graph','885956sMmHHd','4193028frLdMF','proceedCommits','options','default','../errors/salesforce.error','recordTypes','branchId','getProceededComponentsMeta','proceededComponentsMeta','SalesforceCommitsManager','get','splice','sfLogger','constructor','find','componentId','../utils/composite.utils','2206878BAVcEo','./salesforce-composite.service','./salesforce-git-sync.service','length','update','(((.+)+)+)+$','COMPONENTS_PER_CHUNK'];a127_0x2f72=function(){return _0x26c6c1;};return a127_0x2f72();}function a127_0x4d96(_0x6746aa,_0x330ed7){const _0x29b30d=a127_0x2f72();return a127_0x4d96=function(_0x2ebbc0,_0x288775){_0x2ebbc0=_0x2ebbc0-0x1af;let _0x2f72ce=_0x29b30d[_0x2ebbc0];return _0x2f72ce;},a127_0x4d96(_0x6746aa,_0x330ed7);}a127_0x2ebbc0();'use strict';var __importDefault=this&&this[a127_0x5d3201(0x1d3)]||function(_0x30f732){const _0x313392=a127_0x5d3201;return _0x30f732&&_0x30f732[_0x313392(0x1c0)]?_0x30f732:{'default':_0x30f732};};Object[a127_0x5d3201(0x1c1)](exports,a127_0x5d3201(0x1c0),{'value':!![]}),exports[a127_0x5d3201(0x1ea)]=void 0x0;const core_1=require(a127_0x5d3201(0x1cf)),typedi_1=__importDefault(require(a127_0x5d3201(0x1c2))),constants_1=require(a127_0x5d3201(0x1cb)),utils_1=require(a127_0x5d3201(0x1d8)),salesforce_error_1=require(a127_0x5d3201(0x1e5)),composite_utils_1=require(a127_0x5d3201(0x1f1)),salesforce_components_manager_service_1=require(a127_0x5d3201(0x1b1)),salesforce_composite_service_1=require(a127_0x5d3201(0x1f3)),salesforce_git_sync_service_1=require(a127_0x5d3201(0x1f4));class SalesforceCommitsManager{constructor(_0x186ef0){const _0x4c702d=a127_0x5d3201;this['options']=_0x186ef0,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x4c702d(0x1be)]=new core_1[(_0x4c702d(0x1dc))](SalesforceCommitsManager['name']),this[_0x4c702d(0x1ed)]=this['options'][_0x4c702d(0x1be)],this['composite']=typedi_1[_0x4c702d(0x1e4)]['get'](salesforce_composite_service_1[_0x4c702d(0x1c6)]),this['gitSync']=typedi_1['default'][_0x4c702d(0x1eb)](salesforce_git_sync_service_1['SalesforceGitSyncService']),this[_0x4c702d(0x1e9)]=[];}async[a127_0x5d3201(0x1ca)](_0x3fdf88,_0x1beeff=![]){const _0x47432f=a127_0x5d3201,_0x354e44=(this[_0x47432f(0x1af)]+ +_0x1beeff)*0x3,_0x1b8435=utils_1['chunkArray'](_0x3fdf88,_0x354e44);try{while(_0x1b8435[_0x47432f(0x1f5)]){const _0x2ae82e=_0x1b8435[_0x47432f(0x1ec)](0x0,Math[_0x47432f(0x1d0)](constants_1[_0x47432f(0x1b4)]/_0x354e44));await this[_0x47432f(0x1ed)]['log'](_0x47432f(0x1b7)+_0x2ae82e[_0x47432f(0x1f5)]*_0x354e44+'\x20requests\x20to\x20composite\x20api.')[_0x47432f(0x1c8)]();const _0x24f7a9=_0x2ae82e[_0x47432f(0x1cd)]((_0x17ac88,_0x24ef70)=>({'graphId':_0x47432f(0x1df)+_0x24ef70,'compositeRequest':_0x17ac88})),_0x1b4850=await this[_0x47432f(0x1d1)][_0x47432f(0x1d4)](_0x24f7a9);if(_0x1beeff){const _0x3195bc=composite_utils_1[_0x47432f(0x1b9)](_0x1b4850);for(const {id:_0x52b842,ref:_0x3a599a}of _0x3195bc){const _0x331002=this[_0x47432f(0x1e9)][_0x47432f(0x1ef)](_0x1c70fe=>_0x1c70fe['reference']===_0x3a599a);_0x331002&&(_0x331002[_0x47432f(0x1f0)]=_0x52b842);}}}}catch(_0x49c49b){this[_0x47432f(0x1be)][_0x47432f(0x1b3)](_0x49c49b instanceof salesforce_error_1[_0x47432f(0x1ba)]?JSON['stringify'](_0x49c49b['toJSON'](),null,0x2):_0x49c49b),this[_0x47432f(0x1ed)]['log'](_0x49c49b instanceof salesforce_error_1[_0x47432f(0x1ba)]?JSON['stringify'](_0x49c49b['toJSON'](),null,0x2):_0x49c49b[_0x47432f(0x1c3)]());throw _0x49c49b;}}async[a127_0x5d3201(0x1c7)](_0x5e12df){const _0x2731d8=a127_0x5d3201;for(const _0x32a132 of _0x5e12df){if(!_0x32a132[_0x2731d8(0x1bc)][_0x2731d8(0x1f5)]&&!_0x32a132[_0x2731d8(0x1d7)][_0x2731d8(0x1f5)]&&!_0x32a132[_0x2731d8(0x1bb)]['length'])continue;const _0x48a4ec=[],_0xbeb9fd=[],_0x26a5f8=new salesforce_components_manager_service_1[(_0x2731d8(0x1da))](this['options']['repositoryId'],this[_0x2731d8(0x1e3)]['branchId'],_0x32a132['author'],this[_0x2731d8(0x1e3)][_0x2731d8(0x1e6)],this[_0x2731d8(0x1e9)]);_0x48a4ec[_0x2731d8(0x1c4)](...await _0x26a5f8[_0x2731d8(0x1bd)](_0x32a132['inserted'],this[_0x2731d8(0x1e3)][_0x2731d8(0x1cc)])),_0x48a4ec['push'](...await _0x26a5f8[_0x2731d8(0x1f6)](_0x32a132['modified'],this[_0x2731d8(0x1e3)][_0x2731d8(0x1cc)])),_0xbeb9fd[_0x2731d8(0x1c4)](await _0x26a5f8[_0x2731d8(0x1d5)](_0x32a132[_0x2731d8(0x1bb)],!![])),this[_0x2731d8(0x1e9)]=_0x26a5f8[_0x2731d8(0x1e8)](),await this[_0x2731d8(0x1ca)](_0x48a4ec,!![]);for(const _0x1d7fca of _0xbeb9fd){_0x1d7fca[_0x2731d8(0x1dd)][_0x2731d8(0x1f5)]&&await this[_0x2731d8(0x1ca)](_0x1d7fca[_0x2731d8(0x1dd)],!![]),_0x1d7fca['componentsToUpdate']['length']&&await this[_0x2731d8(0x1ca)](_0x1d7fca[_0x2731d8(0x1bf)],!![]),_0x1d7fca[_0x2731d8(0x1d2)]['length']&&await this[_0x2731d8(0x1ca)](_0x1d7fca[_0x2731d8(0x1d2)],!![]);}this[_0x2731d8(0x1be)][_0x2731d8(0x1de)](_0x2731d8(0x1c5),_0x48a4ec[_0x2731d8(0x1f5)]);}}async[a127_0x5d3201(0x1d9)](_0x4f29c6){const _0x2f2ce1=a127_0x5d3201,_0x57b7b6=[],_0x2a90c1=[];for(const _0x581f30 of _0x4f29c6){if(!_0x581f30[_0x2f2ce1(0x1bc)][_0x2f2ce1(0x1f5)]&&!_0x581f30[_0x2f2ce1(0x1d7)][_0x2f2ce1(0x1f5)]&&!_0x581f30['removed'][_0x2f2ce1(0x1f5)])continue;const _0x15632d=new salesforce_components_manager_service_1[(_0x2f2ce1(0x1da))](this[_0x2f2ce1(0x1e3)]['repositoryId'],this[_0x2f2ce1(0x1e3)][_0x2f2ce1(0x1e7)],_0x581f30[_0x2f2ce1(0x1b8)],this[_0x2f2ce1(0x1e3)][_0x2f2ce1(0x1e6)],[]);_0x57b7b6['push'](...await _0x15632d[_0x2f2ce1(0x1bd)](_0x581f30[_0x2f2ce1(0x1bc)])),_0x57b7b6[_0x2f2ce1(0x1c4)](...await _0x15632d[_0x2f2ce1(0x1f6)](_0x581f30[_0x2f2ce1(0x1d7)])),_0x2a90c1[_0x2f2ce1(0x1c4)](await _0x15632d[_0x2f2ce1(0x1d5)](_0x581f30[_0x2f2ce1(0x1bb)]));}this[_0x2f2ce1(0x1be)][_0x2f2ce1(0x1de)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x57b7b6[_0x2f2ce1(0x1f5)]),await this[_0x2f2ce1(0x1ca)](_0x57b7b6);const _0x1a61e4=_0x2a90c1['reduce']((_0x4bcf9b,_0x1b9426)=>({'manifests':[..._0x4bcf9b[_0x2f2ce1(0x1dd)],..._0x1b9426[_0x2f2ce1(0x1dd)]],'componentsToDelete':[..._0x4bcf9b[_0x2f2ce1(0x1d2)],..._0x1b9426['componentsToDelete']],'componentsToUpdate':[..._0x4bcf9b['componentsToUpdate'],..._0x1b9426[_0x2f2ce1(0x1bf)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x1a61e4[_0x2f2ce1(0x1dd)][_0x2f2ce1(0x1f5)]&&await this[_0x2f2ce1(0x1ca)](_0x1a61e4[_0x2f2ce1(0x1dd)],!![]),_0x1a61e4[_0x2f2ce1(0x1bf)][_0x2f2ce1(0x1f5)]&&await this[_0x2f2ce1(0x1ca)](_0x1a61e4['componentsToUpdate'],!![]),_0x1a61e4[_0x2f2ce1(0x1d2)][_0x2f2ce1(0x1f5)]&&await this[_0x2f2ce1(0x1ca)](_0x1a61e4['componentsToDelete'],!![]);}async[a127_0x5d3201(0x1e2)](_0x101b9e){const _0x18be3c=a127_0x5d3201;this['options'][_0x18be3c(0x1e7)]?await this[_0x18be3c(0x1d9)](_0x101b9e):await this['proceedCommitsToRepository'](_0x101b9e);}}exports[a127_0x5d3201(0x1ea)]=SalesforceCommitsManager;