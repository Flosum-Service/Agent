const a127_0x198d8e=a127_0x322c;(function(_0x1187d6,_0x3e9424){const _0x167176=a127_0x322c,_0x26e895=_0x1187d6();while(!![]){try{const _0xfb90aa=-parseInt(_0x167176(0x1d2))/0x1+-parseInt(_0x167176(0x1a3))/0x2+-parseInt(_0x167176(0x1a8))/0x3*(-parseInt(_0x167176(0x1a9))/0x4)+-parseInt(_0x167176(0x1dc))/0x5*(-parseInt(_0x167176(0x1c8))/0x6)+parseInt(_0x167176(0x1bc))/0x7*(-parseInt(_0x167176(0x1b1))/0x8)+parseInt(_0x167176(0x1d5))/0x9+parseInt(_0x167176(0x1cb))/0xa*(parseInt(_0x167176(0x1d9))/0xb);if(_0xfb90aa===_0x3e9424)break;else _0x26e895['push'](_0x26e895['shift']());}catch(_0xfe5697){_0x26e895['push'](_0x26e895['shift']());}}}(a127_0x4772,0x5ec83));const a127_0x11935b=(function(){let _0x3221bb=!![];return function(_0x1dcd25,_0x1827e6){const _0x102ea7=_0x3221bb?function(){const _0x41a9b8=a127_0x322c;if(_0x1827e6){const _0x11c28a=_0x1827e6[_0x41a9b8(0x1bb)](_0x1dcd25,arguments);return _0x1827e6=null,_0x11c28a;}}:function(){};return _0x3221bb=![],_0x102ea7;};}()),a127_0x422e10=a127_0x11935b(this,function(){const _0x420cd3=a127_0x322c;return a127_0x422e10[_0x420cd3(0x1e2)]()[_0x420cd3(0x1ad)]('(((.+)+)+)+$')[_0x420cd3(0x1e2)]()[_0x420cd3(0x1d3)](a127_0x422e10)[_0x420cd3(0x1ad)](_0x420cd3(0x1d7));});a127_0x422e10();function a127_0x322c(_0x29d40a,_0x5469a1){const _0x119e23=a127_0x4772();return a127_0x322c=function(_0x422e10,_0x11935b){_0x422e10=_0x422e10-0x1a3;let _0x477279=_0x119e23[_0x422e10];return _0x477279;},a127_0x322c(_0x29d40a,_0x5469a1);}'use strict';var __importDefault=this&&this[a127_0x198d8e(0x1ca)]||function(_0x32366f){return _0x32366f&&_0x32366f['__esModule']?_0x32366f:{'default':_0x32366f};};function a127_0x4772(){const _0x1a8894=['extractComponentIdsFromGraphsResponse','SalesforceComponentsManager','COMPONENTS_PER_CHUNK','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','componentsToUpdate','inserted','apply','3767743LFzliw','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','floor','removed','proceedCommitsToRepository','commitId','error','modified','SalesforceGitSyncService','proceedCommitsToBranch','proceedCommits','componentId','63912jKqdXP','send','__importDefault','30220cuNAAW','proceedRequests','../../../core','name','log','reference','get','521513pSZkjs','constructor','__esModule','6682338cMOytK','proceededComponentsMeta','(((.+)+)+)+$','find','517JFzXVY','componentsToDelete','options','95UXqzdl','stringify','map','../../shared/utils','manifests','push','toString','default','repositoryId','branchId','logger','SalesforceError','./salesforce-components-manager.service','SalesforceCommitsManager','splice','graph','update','executeGraphs','chunkArray','author','length','66854vrjSbC','sfLogger','recordTypes','Logger','reduce','73971vPTXXu','64jWUKym','insert','composite','gitSync','search','toJSON','defineProperty','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','8LqHCJR','../../../constants','../errors/salesforce.error','delete'];a127_0x4772=function(){return _0x1a8894;};return a127_0x4772();}Object[a127_0x198d8e(0x1af)](exports,a127_0x198d8e(0x1d4),{'value':!![]}),exports[a127_0x198d8e(0x1e9)]=void 0x0;const core_1=require(a127_0x198d8e(0x1cd)),typedi_1=__importDefault(require('typedi')),constants_1=require(a127_0x198d8e(0x1b2)),utils_1=require(a127_0x198d8e(0x1df)),salesforce_error_1=require(a127_0x198d8e(0x1b3)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a127_0x198d8e(0x1e8)),salesforce_composite_service_1=require('./salesforce-composite.service'),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceCommitsManager{constructor(_0x534d09){const _0xc8c3f8=a127_0x198d8e;this[_0xc8c3f8(0x1db)]=_0x534d09,this[_0xc8c3f8(0x1b7)]=0x3,this['logger']=new core_1[(_0xc8c3f8(0x1a6))](SalesforceCommitsManager[_0xc8c3f8(0x1ce)]),this[_0xc8c3f8(0x1a4)]=this[_0xc8c3f8(0x1db)][_0xc8c3f8(0x1e6)],this[_0xc8c3f8(0x1ab)]=typedi_1['default'][_0xc8c3f8(0x1d1)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0xc8c3f8(0x1ac)]=typedi_1[_0xc8c3f8(0x1e3)]['get'](salesforce_git_sync_service_1[_0xc8c3f8(0x1c4)]),this[_0xc8c3f8(0x1d6)]=[];}async[a127_0x198d8e(0x1cc)](_0x580407,_0x454513=![]){const _0x35cca4=a127_0x198d8e,_0x23ab39=(this[_0x35cca4(0x1b7)]+ +_0x454513)*0x3,_0x18a18d=utils_1[_0x35cca4(0x1ee)](_0x580407,_0x23ab39);try{while(_0x18a18d[_0x35cca4(0x1f0)]){const _0x25d932=_0x18a18d[_0x35cca4(0x1ea)](0x0,Math[_0x35cca4(0x1be)](constants_1[_0x35cca4(0x1b0)]/_0x23ab39));await this[_0x35cca4(0x1a4)]['log']('[INFO]\x20Sending\x20'+_0x25d932[_0x35cca4(0x1f0)]*_0x23ab39+'\x20requests\x20to\x20composite\x20api.')[_0x35cca4(0x1c9)]();const _0x5dc752=_0x25d932[_0x35cca4(0x1de)]((_0x46c948,_0x349c0a)=>({'graphId':_0x35cca4(0x1eb)+_0x349c0a,'compositeRequest':_0x46c948})),_0x35f430=await this[_0x35cca4(0x1ab)][_0x35cca4(0x1ed)](_0x5dc752);if(_0x454513){const _0x20cb3b=composite_utils_1[_0x35cca4(0x1b5)](_0x35f430);for(const {id:_0xf722ae,ref:_0x1ec3be}of _0x20cb3b){const _0x4f2f9b=this['proceededComponentsMeta'][_0x35cca4(0x1d8)](_0x4bae81=>_0x4bae81[_0x35cca4(0x1d0)]===_0x1ec3be);_0x4f2f9b&&(_0x4f2f9b[_0x35cca4(0x1c7)]=_0xf722ae);}}}}catch(_0x36f875){this[_0x35cca4(0x1e6)][_0x35cca4(0x1c2)](_0x36f875 instanceof salesforce_error_1[_0x35cca4(0x1e7)]?JSON[_0x35cca4(0x1dd)](_0x36f875[_0x35cca4(0x1ae)](),null,0x2):_0x36f875),this[_0x35cca4(0x1a4)][_0x35cca4(0x1cf)](_0x36f875 instanceof salesforce_error_1['SalesforceError']?JSON[_0x35cca4(0x1dd)](_0x36f875[_0x35cca4(0x1ae)](),null,0x2):_0x36f875[_0x35cca4(0x1e2)]());throw _0x36f875;}}async['proceedCommitsToRepository'](_0x513e13){const _0xcf6ea9=a127_0x198d8e;for(const _0x3e2462 of _0x513e13){if(!_0x3e2462[_0xcf6ea9(0x1ba)][_0xcf6ea9(0x1f0)]&&!_0x3e2462[_0xcf6ea9(0x1c3)][_0xcf6ea9(0x1f0)]&&!_0x3e2462['removed'][_0xcf6ea9(0x1f0)])continue;const _0x4d39ea=[],_0x22f682=[],_0x39a58d=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0xcf6ea9(0x1db)][_0xcf6ea9(0x1e4)],this[_0xcf6ea9(0x1db)][_0xcf6ea9(0x1e5)],_0x3e2462['author'],this[_0xcf6ea9(0x1db)]['recordTypes'],this[_0xcf6ea9(0x1d6)]);_0x4d39ea[_0xcf6ea9(0x1e1)](...await _0x39a58d[_0xcf6ea9(0x1aa)](_0x3e2462[_0xcf6ea9(0x1ba)],this['options'][_0xcf6ea9(0x1c1)])),_0x4d39ea[_0xcf6ea9(0x1e1)](...await _0x39a58d[_0xcf6ea9(0x1ec)](_0x3e2462[_0xcf6ea9(0x1c3)],this['options'][_0xcf6ea9(0x1c1)])),_0x22f682['push'](await _0x39a58d[_0xcf6ea9(0x1b4)](_0x3e2462[_0xcf6ea9(0x1bf)],!![])),this[_0xcf6ea9(0x1d6)]=_0x39a58d['getProceededComponentsMeta'](),await this[_0xcf6ea9(0x1cc)](_0x4d39ea,!![]);for(const _0x2f7d90 of _0x22f682){_0x2f7d90[_0xcf6ea9(0x1e0)][_0xcf6ea9(0x1f0)]&&await this[_0xcf6ea9(0x1cc)](_0x2f7d90[_0xcf6ea9(0x1e0)],!![]),_0x2f7d90[_0xcf6ea9(0x1b9)][_0xcf6ea9(0x1f0)]&&await this[_0xcf6ea9(0x1cc)](_0x2f7d90[_0xcf6ea9(0x1b9)],!![]),_0x2f7d90[_0xcf6ea9(0x1da)][_0xcf6ea9(0x1f0)]&&await this['proceedRequests'](_0x2f7d90['componentsToDelete'],!![]);}this[_0xcf6ea9(0x1e6)][_0xcf6ea9(0x1cf)](_0xcf6ea9(0x1bd),_0x4d39ea[_0xcf6ea9(0x1f0)]);}}async[a127_0x198d8e(0x1c5)](_0x3abac8){const _0x59d649=a127_0x198d8e,_0x4e475b=[],_0x5a6b67=[];for(const _0x5368ba of _0x3abac8){if(!_0x5368ba[_0x59d649(0x1ba)][_0x59d649(0x1f0)]&&!_0x5368ba[_0x59d649(0x1c3)][_0x59d649(0x1f0)]&&!_0x5368ba[_0x59d649(0x1bf)][_0x59d649(0x1f0)])continue;const _0x14a9f8=new salesforce_components_manager_service_1[(_0x59d649(0x1b6))](this[_0x59d649(0x1db)]['repositoryId'],this['options'][_0x59d649(0x1e5)],_0x5368ba[_0x59d649(0x1ef)],this[_0x59d649(0x1db)][_0x59d649(0x1a5)],[]);_0x4e475b[_0x59d649(0x1e1)](...await _0x14a9f8['insert'](_0x5368ba['inserted'])),_0x4e475b[_0x59d649(0x1e1)](...await _0x14a9f8[_0x59d649(0x1ec)](_0x5368ba['modified'])),_0x5a6b67[_0x59d649(0x1e1)](await _0x14a9f8[_0x59d649(0x1b4)](_0x5368ba[_0x59d649(0x1bf)]));}this[_0x59d649(0x1e6)][_0x59d649(0x1cf)](_0x59d649(0x1b8),_0x4e475b[_0x59d649(0x1f0)]),await this[_0x59d649(0x1cc)](_0x4e475b);const _0x5b0d99=_0x5a6b67[_0x59d649(0x1a7)]((_0x531934,_0x383fec)=>({'manifests':[..._0x531934[_0x59d649(0x1e0)],..._0x383fec[_0x59d649(0x1e0)]],'componentsToDelete':[..._0x531934[_0x59d649(0x1da)],..._0x383fec['componentsToDelete']],'componentsToUpdate':[..._0x531934['componentsToUpdate'],..._0x383fec[_0x59d649(0x1b9)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x5b0d99['manifests']['length']&&await this[_0x59d649(0x1cc)](_0x5b0d99['manifests'],!![]),_0x5b0d99[_0x59d649(0x1b9)][_0x59d649(0x1f0)]&&await this[_0x59d649(0x1cc)](_0x5b0d99[_0x59d649(0x1b9)],!![]),_0x5b0d99[_0x59d649(0x1da)][_0x59d649(0x1f0)]&&await this[_0x59d649(0x1cc)](_0x5b0d99[_0x59d649(0x1da)],!![]);}async[a127_0x198d8e(0x1c6)](_0x29d892){const _0x138564=a127_0x198d8e;this[_0x138564(0x1db)][_0x138564(0x1e5)]?await this[_0x138564(0x1c5)](_0x29d892):await this[_0x138564(0x1c0)](_0x29d892);}}exports[a127_0x198d8e(0x1e9)]=SalesforceCommitsManager;