const a127_0x44c4ad=a127_0x2dbe;(function(_0x484267,_0x445a51){const _0x16c836=a127_0x2dbe,_0x23e8fd=_0x484267();while(!![]){try{const _0x339d65=parseInt(_0x16c836(0x96))/0x1+parseInt(_0x16c836(0xbe))/0x2*(-parseInt(_0x16c836(0xa1))/0x3)+parseInt(_0x16c836(0xa6))/0x4+-parseInt(_0x16c836(0x9d))/0x5+-parseInt(_0x16c836(0x93))/0x6+-parseInt(_0x16c836(0x83))/0x7+parseInt(_0x16c836(0xb4))/0x8;if(_0x339d65===_0x445a51)break;else _0x23e8fd['push'](_0x23e8fd['shift']());}catch(_0x305755){_0x23e8fd['push'](_0x23e8fd['shift']());}}}(a127_0x1089,0x2363a));const a127_0xb71bb1=(function(){let _0x46d06d=!![];return function(_0xcf6597,_0x6c4769){const _0x5d3b44=_0x46d06d?function(){const _0x5208a9=a127_0x2dbe;if(_0x6c4769){const _0xa4b19e=_0x6c4769[_0x5208a9(0x88)](_0xcf6597,arguments);return _0x6c4769=null,_0xa4b19e;}}:function(){};return _0x46d06d=![],_0x5d3b44;};}()),a127_0x1bb8ec=a127_0xb71bb1(this,function(){const _0x2e654b=a127_0x2dbe;return a127_0x1bb8ec['toString']()[_0x2e654b(0xc0)](_0x2e654b(0x8b))[_0x2e654b(0xba)]()[_0x2e654b(0xaf)](a127_0x1bb8ec)[_0x2e654b(0xc0)]('(((.+)+)+)+$');});a127_0x1bb8ec();function a127_0x2dbe(_0x136b8f,_0x391ab2){const _0x1219f4=a127_0x1089();return a127_0x2dbe=function(_0x1bb8ec,_0xb71bb1){_0x1bb8ec=_0x1bb8ec-0x80;let _0x108998=_0x1219f4[_0x1bb8ec];return _0x108998;},a127_0x2dbe(_0x136b8f,_0x391ab2);}'use strict';var __importDefault=this&&this[a127_0x44c4ad(0xb9)]||function(_0x22a952){const _0x265e69=a127_0x44c4ad;return _0x22a952&&_0x22a952[_0x265e69(0xab)]?_0x22a952:{'default':_0x22a952};};function a127_0x1089(){const _0x39f197=['proceedCommitsToBranch','repositoryId','(((.+)+)+)+$','chunkArray','componentId','../../shared/utils','./salesforce-composite.service','get','../../../constants','insert','696174oBasRl','SalesforceComponentsManager','reduce','279656rEclKk','name','manifests','logger','length','options','stringify','302245PMMkgD','modified','removed','reference','51hiMzgf','COMPONENTS_PER_CHUNK','delete','componentsToUpdate','update','925444HLwXFV','componentsToDelete','typedi','../utils/composite.utils','recordTypes','__esModule','sfLogger','log','SalesforceCompositeService','constructor','\x20requests\x20to\x20composite\x20api.','floor','proceedRequests','proceededComponentsMeta','1673872gfSzDr','../errors/salesforce.error','composite','proceedCommits','./salesforce-git-sync.service','__importDefault','toString','author','find','proceedCommitsToRepository','28192pRmAOt','defineProperty','search','error','inserted','SalesforceGitSyncService','default','push','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','SalesforceError','1114309lHwNzH','executeGraphs','SalesforceCommitsManager','[INFO]\x20Sending\x20','map','apply'];a127_0x1089=function(){return _0x39f197;};return a127_0x1089();}Object[a127_0x44c4ad(0xbf)](exports,a127_0x44c4ad(0xab),{'value':!![]}),exports[a127_0x44c4ad(0x85)]=void 0x0;const core_1=require('../../../core'),typedi_1=__importDefault(require(a127_0x44c4ad(0xa8))),constants_1=require(a127_0x44c4ad(0x91)),utils_1=require(a127_0x44c4ad(0x8e)),salesforce_error_1=require(a127_0x44c4ad(0xb5)),composite_utils_1=require(a127_0x44c4ad(0xa9)),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a127_0x44c4ad(0x8f)),salesforce_git_sync_service_1=require(a127_0x44c4ad(0xb8));class SalesforceCommitsManager{constructor(_0x488cc9){const _0x4e37e4=a127_0x44c4ad;this[_0x4e37e4(0x9b)]=_0x488cc9,this[_0x4e37e4(0xa2)]=0x3,this[_0x4e37e4(0x99)]=new core_1['Logger'](SalesforceCommitsManager[_0x4e37e4(0x97)]),this[_0x4e37e4(0xac)]=this['options'][_0x4e37e4(0x99)],this[_0x4e37e4(0xb6)]=typedi_1[_0x4e37e4(0xc4)]['get'](salesforce_composite_service_1[_0x4e37e4(0xae)]),this['gitSync']=typedi_1['default'][_0x4e37e4(0x90)](salesforce_git_sync_service_1[_0x4e37e4(0xc3)]),this[_0x4e37e4(0xb3)]=[];}async[a127_0x44c4ad(0xb2)](_0x489d98,_0x2cca88=![]){const _0x530306=a127_0x44c4ad,_0x129049=(this[_0x530306(0xa2)]+ +_0x2cca88)*0x3,_0xd17c00=utils_1[_0x530306(0x8c)](_0x489d98,_0x129049);try{while(_0xd17c00[_0x530306(0x9a)]){const _0xe69dfe=_0xd17c00['splice'](0x0,Math[_0x530306(0xb1)](constants_1[_0x530306(0x81)]/_0x129049));await this[_0x530306(0xac)][_0x530306(0xad)](_0x530306(0x86)+_0xe69dfe[_0x530306(0x9a)]*_0x129049+_0x530306(0xb0))['send']();const _0x566d0a=_0xe69dfe[_0x530306(0x87)]((_0x462260,_0x9f132c)=>({'graphId':'graph'+_0x9f132c,'compositeRequest':_0x462260})),_0x552746=await this['composite'][_0x530306(0x84)](_0x566d0a);if(_0x2cca88){const _0x25a1dc=composite_utils_1['extractComponentIdsFromGraphsResponse'](_0x552746);for(const {id:_0x32f663,ref:_0x28dd4f}of _0x25a1dc){const _0x2f2981=this[_0x530306(0xb3)][_0x530306(0xbc)](_0x59c018=>_0x59c018[_0x530306(0xa0)]===_0x28dd4f);_0x2f2981&&(_0x2f2981[_0x530306(0x8d)]=_0x32f663);}}}}catch(_0x5076d5){this['logger'][_0x530306(0xc1)](_0x5076d5 instanceof salesforce_error_1[_0x530306(0x82)]?JSON[_0x530306(0x9c)](_0x5076d5['toJSON'](),null,0x2):_0x5076d5),this[_0x530306(0xac)][_0x530306(0xad)](_0x5076d5 instanceof salesforce_error_1[_0x530306(0x82)]?JSON[_0x530306(0x9c)](_0x5076d5['toJSON'](),null,0x2):_0x5076d5[_0x530306(0xba)]());throw _0x5076d5;}}async['proceedCommitsToRepository'](_0x5284c4){const _0x2df8a4=a127_0x44c4ad;for(const _0x44748c of _0x5284c4){if(!_0x44748c[_0x2df8a4(0xc2)][_0x2df8a4(0x9a)]&&!_0x44748c[_0x2df8a4(0x9e)][_0x2df8a4(0x9a)]&&!_0x44748c[_0x2df8a4(0x9f)]['length'])continue;const _0x561861=[],_0x1acbf0=[],_0x10c0b6=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x2df8a4(0x9b)][_0x2df8a4(0x8a)],this[_0x2df8a4(0x9b)]['branchId'],_0x44748c[_0x2df8a4(0xbb)],this[_0x2df8a4(0x9b)]['recordTypes'],this[_0x2df8a4(0xb3)]);_0x561861[_0x2df8a4(0x80)](...await _0x10c0b6[_0x2df8a4(0x92)](_0x44748c[_0x2df8a4(0xc2)],this[_0x2df8a4(0x9b)]['commitId'])),_0x561861['push'](...await _0x10c0b6[_0x2df8a4(0xa5)](_0x44748c[_0x2df8a4(0x9e)],this[_0x2df8a4(0x9b)]['commitId'])),_0x1acbf0[_0x2df8a4(0x80)](await _0x10c0b6['delete'](_0x44748c[_0x2df8a4(0x9f)],!![])),this[_0x2df8a4(0xb3)]=_0x10c0b6['getProceededComponentsMeta'](),await this[_0x2df8a4(0xb2)](_0x561861,!![]);for(const _0x5974c4 of _0x1acbf0){_0x5974c4[_0x2df8a4(0x98)][_0x2df8a4(0x9a)]&&await this[_0x2df8a4(0xb2)](_0x5974c4['manifests'],!![]),_0x5974c4[_0x2df8a4(0xa4)][_0x2df8a4(0x9a)]&&await this[_0x2df8a4(0xb2)](_0x5974c4[_0x2df8a4(0xa4)],!![]),_0x5974c4[_0x2df8a4(0xa7)][_0x2df8a4(0x9a)]&&await this['proceedRequests'](_0x5974c4[_0x2df8a4(0xa7)],!![]);}this[_0x2df8a4(0x99)][_0x2df8a4(0xad)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x561861[_0x2df8a4(0x9a)]);}}async[a127_0x44c4ad(0x89)](_0x401a74){const _0x13cfb5=a127_0x44c4ad,_0x384135=[],_0x3a042c=[];for(const _0x388974 of _0x401a74){if(!_0x388974[_0x13cfb5(0xc2)][_0x13cfb5(0x9a)]&&!_0x388974[_0x13cfb5(0x9e)][_0x13cfb5(0x9a)]&&!_0x388974['removed'][_0x13cfb5(0x9a)])continue;const _0x7beaff=new salesforce_components_manager_service_1[(_0x13cfb5(0x94))](this[_0x13cfb5(0x9b)][_0x13cfb5(0x8a)],this[_0x13cfb5(0x9b)]['branchId'],_0x388974[_0x13cfb5(0xbb)],this['options'][_0x13cfb5(0xaa)],[]);_0x384135[_0x13cfb5(0x80)](...await _0x7beaff['insert'](_0x388974[_0x13cfb5(0xc2)])),_0x384135[_0x13cfb5(0x80)](...await _0x7beaff[_0x13cfb5(0xa5)](_0x388974[_0x13cfb5(0x9e)])),_0x3a042c[_0x13cfb5(0x80)](await _0x7beaff[_0x13cfb5(0xa3)](_0x388974[_0x13cfb5(0x9f)]));}this[_0x13cfb5(0x99)][_0x13cfb5(0xad)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x384135[_0x13cfb5(0x9a)]),await this[_0x13cfb5(0xb2)](_0x384135);const _0x1af229=_0x3a042c[_0x13cfb5(0x95)]((_0x5272c2,_0x1e6275)=>({'manifests':[..._0x5272c2[_0x13cfb5(0x98)],..._0x1e6275[_0x13cfb5(0x98)]],'componentsToDelete':[..._0x5272c2['componentsToDelete'],..._0x1e6275[_0x13cfb5(0xa7)]],'componentsToUpdate':[..._0x5272c2[_0x13cfb5(0xa4)],..._0x1e6275[_0x13cfb5(0xa4)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x1af229[_0x13cfb5(0x98)][_0x13cfb5(0x9a)]&&await this[_0x13cfb5(0xb2)](_0x1af229[_0x13cfb5(0x98)],!![]),_0x1af229[_0x13cfb5(0xa4)][_0x13cfb5(0x9a)]&&await this[_0x13cfb5(0xb2)](_0x1af229['componentsToUpdate'],!![]),_0x1af229[_0x13cfb5(0xa7)][_0x13cfb5(0x9a)]&&await this['proceedRequests'](_0x1af229[_0x13cfb5(0xa7)],!![]);}async[a127_0x44c4ad(0xb7)](_0xb41bb9){const _0x59fc96=a127_0x44c4ad;this[_0x59fc96(0x9b)]['branchId']?await this['proceedCommitsToBranch'](_0xb41bb9):await this[_0x59fc96(0xbd)](_0xb41bb9);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;