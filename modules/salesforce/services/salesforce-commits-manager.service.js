const a126_0x561214=a126_0x1b54;(function(_0x20efbf,_0x59e614){const _0x9ec7c5=a126_0x1b54,_0x4d404e=_0x20efbf();while(!![]){try{const _0x2afbe2=-parseInt(_0x9ec7c5(0x111))/0x1*(-parseInt(_0x9ec7c5(0x113))/0x2)+parseInt(_0x9ec7c5(0x132))/0x3+parseInt(_0x9ec7c5(0x14f))/0x4*(parseInt(_0x9ec7c5(0x117))/0x5)+-parseInt(_0x9ec7c5(0x11d))/0x6+parseInt(_0x9ec7c5(0x144))/0x7+parseInt(_0x9ec7c5(0x146))/0x8+-parseInt(_0x9ec7c5(0x116))/0x9;if(_0x2afbe2===_0x59e614)break;else _0x4d404e['push'](_0x4d404e['shift']());}catch(_0x231221){_0x4d404e['push'](_0x4d404e['shift']());}}}(a126_0x3128,0x55ab5));function a126_0x1b54(_0x23010e,_0x4253ee){const _0x188b19=a126_0x3128();return a126_0x1b54=function(_0x2f43cd,_0x54e6ec){_0x2f43cd=_0x2f43cd-0x110;let _0x312861=_0x188b19[_0x2f43cd];return _0x312861;},a126_0x1b54(_0x23010e,_0x4253ee);}const a126_0x54e6ec=(function(){let _0xd4e6ce=!![];return function(_0x2e0f67,_0x2fc2fe){const _0x2d5435=_0xd4e6ce?function(){const _0x53e19a=a126_0x1b54;if(_0x2fc2fe){const _0x45ccdc=_0x2fc2fe[_0x53e19a(0x130)](_0x2e0f67,arguments);return _0x2fc2fe=null,_0x45ccdc;}}:function(){};return _0xd4e6ce=![],_0x2d5435;};}()),a126_0x2f43cd=a126_0x54e6ec(this,function(){const _0x361df3=a126_0x1b54;return a126_0x2f43cd[_0x361df3(0x13d)]()[_0x361df3(0x110)](_0x361df3(0x14d))[_0x361df3(0x13d)]()[_0x361df3(0x141)](a126_0x2f43cd)[_0x361df3(0x110)](_0x361df3(0x14d));});a126_0x2f43cd();'use strict';var __importDefault=this&&this[a126_0x561214(0x152)]||function(_0x22ac7e){const _0x59200c=a126_0x561214;return _0x22ac7e&&_0x22ac7e[_0x59200c(0x139)]?_0x22ac7e:{'default':_0x22ac7e};};function a126_0x3128(){const _0x20ff27=['[INFO]\x20Sending\x20','../utils/composite.utils','stringify','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','reduce','log','(((.+)+)+)+$','proceededComponentsMeta','13084JjgqAS','error','./salesforce-git-sync.service','__importDefault','author','reference','../../../core','inserted','gitSync','extractComponentIdsFromGraphsResponse','manifests','insert','search','42085zuPUgM','proceedCommitsToRepository','12nsYOBn','graph','SalesforceCommitsManager','12418830tQyURq','285dLmEMS','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','composite','getProceededComponentsMeta','./salesforce-components-manager.service','SalesforceComponentsManager','1086258SzTrmw','options','executeGraphs','\x20requests\x20to\x20composite\x20api.','chunkArray','removed','send','delete','proceedRequests','branchId','default','Logger','modified','logger','proceedCommitsToBranch','componentId','length','./salesforce-composite.service','commitId','apply','toJSON','1646970QeLkfj','componentsToDelete','name','push','typedi','SalesforceError','../../shared/utils','__esModule','sfLogger','componentsToUpdate','floor','toString','SalesforceCompositeService','find','update','constructor','COMPONENTS_PER_CHUNK','recordTypes','4289040JoTNhu','repositoryId','2489176WRDqci'];a126_0x3128=function(){return _0x20ff27;};return a126_0x3128();}Object['defineProperty'](exports,a126_0x561214(0x139),{'value':!![]}),exports[a126_0x561214(0x115)]=void 0x0;const core_1=require(a126_0x561214(0x155)),typedi_1=__importDefault(require(a126_0x561214(0x136))),constants_1=require('../../../constants'),utils_1=require(a126_0x561214(0x138)),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a126_0x561214(0x148)),salesforce_components_manager_service_1=require(a126_0x561214(0x11b)),salesforce_composite_service_1=require(a126_0x561214(0x12e)),salesforce_git_sync_service_1=require(a126_0x561214(0x151));class SalesforceCommitsManager{constructor(_0x187fc6){const _0x206a07=a126_0x561214;this[_0x206a07(0x11e)]=_0x187fc6,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x206a07(0x12a)]=new core_1[(_0x206a07(0x128))](SalesforceCommitsManager[_0x206a07(0x134)]),this['sfLogger']=this[_0x206a07(0x11e)]['logger'],this['composite']=typedi_1[_0x206a07(0x127)]['get'](salesforce_composite_service_1[_0x206a07(0x13e)]),this[_0x206a07(0x157)]=typedi_1[_0x206a07(0x127)]['get'](salesforce_git_sync_service_1['SalesforceGitSyncService']),this['proceededComponentsMeta']=[];}async[a126_0x561214(0x125)](_0x18fb87,_0xa827b0=![]){const _0x3733af=a126_0x561214,_0x2eac63=(this[_0x3733af(0x142)]+ +_0xa827b0)*0x3,_0x1d9106=utils_1[_0x3733af(0x121)](_0x18fb87,_0x2eac63);try{while(_0x1d9106[_0x3733af(0x12d)]){const _0x419884=_0x1d9106['splice'](0x0,Math[_0x3733af(0x13c)](constants_1[_0x3733af(0x118)]/_0x2eac63));await this[_0x3733af(0x13a)][_0x3733af(0x14c)](_0x3733af(0x147)+_0x419884[_0x3733af(0x12d)]*_0x2eac63+_0x3733af(0x120))[_0x3733af(0x123)]();const _0x3d4f17=_0x419884['map']((_0x219f94,_0x14cc9b)=>({'graphId':_0x3733af(0x114)+_0x14cc9b,'compositeRequest':_0x219f94})),_0x2786ac=await this[_0x3733af(0x119)][_0x3733af(0x11f)](_0x3d4f17);if(_0xa827b0){const _0x355058=composite_utils_1[_0x3733af(0x158)](_0x2786ac);for(const {id:_0x4e4d67,ref:_0x352bea}of _0x355058){const _0x29088b=this[_0x3733af(0x14e)][_0x3733af(0x13f)](_0x5a8fd5=>_0x5a8fd5[_0x3733af(0x154)]===_0x352bea);_0x29088b&&(_0x29088b[_0x3733af(0x12c)]=_0x4e4d67);}}}}catch(_0x1b3c79){this[_0x3733af(0x12a)][_0x3733af(0x150)](_0x1b3c79 instanceof salesforce_error_1[_0x3733af(0x137)]?JSON[_0x3733af(0x149)](_0x1b3c79[_0x3733af(0x131)](),null,0x2):_0x1b3c79),this['sfLogger']['log'](_0x1b3c79 instanceof salesforce_error_1[_0x3733af(0x137)]?JSON[_0x3733af(0x149)](_0x1b3c79[_0x3733af(0x131)](),null,0x2):_0x1b3c79[_0x3733af(0x13d)]());throw _0x1b3c79;}}async[a126_0x561214(0x112)](_0xb486b0){const _0x338cbb=a126_0x561214;for(const _0x4971ec of _0xb486b0){if(!_0x4971ec[_0x338cbb(0x156)][_0x338cbb(0x12d)]&&!_0x4971ec[_0x338cbb(0x129)][_0x338cbb(0x12d)]&&!_0x4971ec[_0x338cbb(0x122)]['length'])continue;const _0x214c91=[],_0x242027=[],_0x570a94=new salesforce_components_manager_service_1[(_0x338cbb(0x11c))](this[_0x338cbb(0x11e)][_0x338cbb(0x145)],this['options'][_0x338cbb(0x126)],_0x4971ec[_0x338cbb(0x153)],this[_0x338cbb(0x11e)][_0x338cbb(0x143)],this[_0x338cbb(0x14e)]);_0x214c91[_0x338cbb(0x135)](...await _0x570a94[_0x338cbb(0x15a)](_0x4971ec[_0x338cbb(0x156)],this[_0x338cbb(0x11e)][_0x338cbb(0x12f)])),_0x214c91['push'](...await _0x570a94[_0x338cbb(0x140)](_0x4971ec[_0x338cbb(0x129)],this[_0x338cbb(0x11e)][_0x338cbb(0x12f)])),_0x242027[_0x338cbb(0x135)](await _0x570a94[_0x338cbb(0x124)](_0x4971ec[_0x338cbb(0x122)],!![])),this[_0x338cbb(0x14e)]=_0x570a94[_0x338cbb(0x11a)](),await this['proceedRequests'](_0x214c91,!![]);for(const _0x169fba of _0x242027){_0x169fba[_0x338cbb(0x159)][_0x338cbb(0x12d)]&&await this['proceedRequests'](_0x169fba[_0x338cbb(0x159)],!![]),_0x169fba['componentsToUpdate']['length']&&await this['proceedRequests'](_0x169fba[_0x338cbb(0x13b)],!![]),_0x169fba[_0x338cbb(0x133)][_0x338cbb(0x12d)]&&await this['proceedRequests'](_0x169fba[_0x338cbb(0x133)],!![]);}this[_0x338cbb(0x12a)][_0x338cbb(0x14c)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x214c91['length']);}}async['proceedCommitsToBranch'](_0x432c86){const _0x322642=a126_0x561214,_0x131df4=[],_0x5ab1b4=[];for(const _0x5cc351 of _0x432c86){if(!_0x5cc351['inserted']['length']&&!_0x5cc351['modified'][_0x322642(0x12d)]&&!_0x5cc351[_0x322642(0x122)][_0x322642(0x12d)])continue;const _0x384aa8=new salesforce_components_manager_service_1[(_0x322642(0x11c))](this[_0x322642(0x11e)][_0x322642(0x145)],this['options'][_0x322642(0x126)],_0x5cc351['author'],this[_0x322642(0x11e)][_0x322642(0x143)],[]);_0x131df4[_0x322642(0x135)](...await _0x384aa8['insert'](_0x5cc351[_0x322642(0x156)])),_0x131df4[_0x322642(0x135)](...await _0x384aa8[_0x322642(0x140)](_0x5cc351[_0x322642(0x129)])),_0x5ab1b4[_0x322642(0x135)](await _0x384aa8['delete'](_0x5cc351['removed']));}this[_0x322642(0x12a)][_0x322642(0x14c)](_0x322642(0x14a),_0x131df4[_0x322642(0x12d)]),await this[_0x322642(0x125)](_0x131df4);const _0x534a2b=_0x5ab1b4[_0x322642(0x14b)]((_0x1630d0,_0x38682b)=>({'manifests':[..._0x1630d0['manifests'],..._0x38682b['manifests']],'componentsToDelete':[..._0x1630d0['componentsToDelete'],..._0x38682b[_0x322642(0x133)]],'componentsToUpdate':[..._0x1630d0[_0x322642(0x13b)],..._0x38682b[_0x322642(0x13b)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x534a2b['manifests'][_0x322642(0x12d)]&&await this[_0x322642(0x125)](_0x534a2b['manifests'],!![]),_0x534a2b[_0x322642(0x13b)][_0x322642(0x12d)]&&await this['proceedRequests'](_0x534a2b[_0x322642(0x13b)],!![]),_0x534a2b['componentsToDelete'][_0x322642(0x12d)]&&await this[_0x322642(0x125)](_0x534a2b[_0x322642(0x133)],!![]);}async['proceedCommits'](_0x57cad0){const _0x1eb398=a126_0x561214;this['options'][_0x1eb398(0x126)]?await this[_0x1eb398(0x12b)](_0x57cad0):await this['proceedCommitsToRepository'](_0x57cad0);}}exports[a126_0x561214(0x115)]=SalesforceCommitsManager;