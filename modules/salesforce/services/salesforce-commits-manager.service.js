const a126_0xb69ca7=a126_0x15ac;(function(_0x593591,_0x57cbb7){const _0x27965b=a126_0x15ac,_0x1a53d2=_0x593591();while(!![]){try{const _0x565823=-parseInt(_0x27965b(0x132))/0x1+-parseInt(_0x27965b(0x140))/0x2*(-parseInt(_0x27965b(0x113))/0x3)+-parseInt(_0x27965b(0x10f))/0x4+parseInt(_0x27965b(0x145))/0x5+parseInt(_0x27965b(0x111))/0x6+parseInt(_0x27965b(0x14d))/0x7+-parseInt(_0x27965b(0x13c))/0x8;if(_0x565823===_0x57cbb7)break;else _0x1a53d2['push'](_0x1a53d2['shift']());}catch(_0x1b6f54){_0x1a53d2['push'](_0x1a53d2['shift']());}}}(a126_0x293a,0x5d04c));const a126_0x5a1610=(function(){let _0x1c548f=!![];return function(_0x91d06e,_0x2d9cbc){const _0x35824f=_0x1c548f?function(){const _0xf26362=a126_0x15ac;if(_0x2d9cbc){const _0x5cbed9=_0x2d9cbc[_0xf26362(0x144)](_0x91d06e,arguments);return _0x2d9cbc=null,_0x5cbed9;}}:function(){};return _0x1c548f=![],_0x35824f;};}()),a126_0x5b3620=a126_0x5a1610(this,function(){const _0x316088=a126_0x15ac;return a126_0x5b3620[_0x316088(0x13d)]()[_0x316088(0x12b)](_0x316088(0x127))[_0x316088(0x13d)]()[_0x316088(0x131)](a126_0x5b3620)[_0x316088(0x12b)](_0x316088(0x127));});a126_0x5b3620();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x297bbc){const _0x3f4deb=a126_0x15ac;return _0x297bbc&&_0x297bbc[_0x3f4deb(0x14c)]?_0x297bbc:{'default':_0x297bbc};};Object[a126_0xb69ca7(0x13a)](exports,'__esModule',{'value':!![]}),exports[a126_0xb69ca7(0x124)]=void 0x0;function a126_0x293a(){const _0x5c7eba=['(((.+)+)+)+$','send','chunkArray','getProceededComponentsMeta','search','get','SalesforceGitSyncService','length','delete','insert','constructor','401071SUYfnj','proceedRequests','../../shared/utils','modified','floor','manifests','COMPONENTS_PER_CHUNK','typedi','defineProperty','proceedCommits','6667616Bimnpg','toString','default','./salesforce-components-manager.service','307244rJPDxJ','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','[INFO]\x20Sending\x20','proceedCommitsToBranch','apply','450910xEdULW','componentsToDelete','proceedCommitsToRepository','SalesforceComponentsManager','push','composite','repositoryId','__esModule','1561343XSCeON','SalesforceCompositeService','gitSync','toJSON','reduce','sfLogger','map','commitId','proceededComponentsMeta','error','executeGraphs','97756UVLMYU','./salesforce-composite.service','4273482BhgnwK','find','12ICsiQJ','../errors/salesforce.error','./salesforce-git-sync.service','graph','logger','options','log','extractComponentIdsFromGraphsResponse','removed','componentsToUpdate','\x20requests\x20to\x20composite\x20api.','reference','branchId','stringify','recordTypes','update','SalesforceError','SalesforceCommitsManager','inserted','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST'];a126_0x293a=function(){return _0x5c7eba;};return a126_0x293a();}function a126_0x15ac(_0xb34370,_0xc744a1){const _0x460b50=a126_0x293a();return a126_0x15ac=function(_0x5b3620,_0x5a1610){_0x5b3620=_0x5b3620-0x10c;let _0x293a2d=_0x460b50[_0x5b3620];return _0x293a2d;},a126_0x15ac(_0xb34370,_0xc744a1);}const core_1=require('../../../core'),typedi_1=__importDefault(require(a126_0xb69ca7(0x139))),constants_1=require('../../../constants'),utils_1=require(a126_0xb69ca7(0x134)),salesforce_error_1=require(a126_0xb69ca7(0x114)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a126_0xb69ca7(0x13f)),salesforce_composite_service_1=require(a126_0xb69ca7(0x110)),salesforce_git_sync_service_1=require(a126_0xb69ca7(0x115));class SalesforceCommitsManager{constructor(_0x6f237a){const _0x2a69de=a126_0xb69ca7;this[_0x2a69de(0x118)]=_0x6f237a,this[_0x2a69de(0x138)]=0x3,this[_0x2a69de(0x117)]=new core_1['Logger'](SalesforceCommitsManager['name']),this[_0x2a69de(0x152)]=this[_0x2a69de(0x118)]['logger'],this[_0x2a69de(0x14a)]=typedi_1[_0x2a69de(0x13e)][_0x2a69de(0x12c)](salesforce_composite_service_1[_0x2a69de(0x14e)]),this[_0x2a69de(0x14f)]=typedi_1['default'][_0x2a69de(0x12c)](salesforce_git_sync_service_1[_0x2a69de(0x12d)]),this[_0x2a69de(0x10c)]=[];}async[a126_0xb69ca7(0x133)](_0x32b4db,_0x5cbde4=![]){const _0xb31032=a126_0xb69ca7,_0xcef2c1=(this[_0xb31032(0x138)]+ +_0x5cbde4)*0x3,_0x55debf=utils_1[_0xb31032(0x129)](_0x32b4db,_0xcef2c1);try{while(_0x55debf[_0xb31032(0x12e)]){const _0x5f41bb=_0x55debf['splice'](0x0,Math[_0xb31032(0x136)](constants_1[_0xb31032(0x126)]/_0xcef2c1));await this[_0xb31032(0x152)][_0xb31032(0x119)](_0xb31032(0x142)+_0x5f41bb[_0xb31032(0x12e)]*_0xcef2c1+_0xb31032(0x11d))[_0xb31032(0x128)]();const _0xcce86e=_0x5f41bb[_0xb31032(0x153)]((_0x4ea00f,_0x3bfc57)=>({'graphId':_0xb31032(0x116)+_0x3bfc57,'compositeRequest':_0x4ea00f})),_0x3dfae3=await this['composite'][_0xb31032(0x10e)](_0xcce86e);if(_0x5cbde4){const _0x2622f3=composite_utils_1[_0xb31032(0x11a)](_0x3dfae3);for(const {id:_0x3eef52,ref:_0x22b193}of _0x2622f3){const _0x3f776d=this[_0xb31032(0x10c)][_0xb31032(0x112)](_0xcf9c0a=>_0xcf9c0a[_0xb31032(0x11e)]===_0x22b193);_0x3f776d&&(_0x3f776d['componentId']=_0x3eef52);}}}}catch(_0xcd0ee0){this[_0xb31032(0x117)][_0xb31032(0x10d)](_0xcd0ee0 instanceof salesforce_error_1['SalesforceError']?JSON[_0xb31032(0x120)](_0xcd0ee0[_0xb31032(0x150)](),null,0x2):_0xcd0ee0),this[_0xb31032(0x152)][_0xb31032(0x119)](_0xcd0ee0 instanceof salesforce_error_1[_0xb31032(0x123)]?JSON[_0xb31032(0x120)](_0xcd0ee0[_0xb31032(0x150)](),null,0x2):_0xcd0ee0[_0xb31032(0x13d)]());throw _0xcd0ee0;}}async['proceedCommitsToRepository'](_0xab9cb7){const _0x566904=a126_0xb69ca7;for(const _0x3b5f73 of _0xab9cb7){if(!_0x3b5f73[_0x566904(0x125)][_0x566904(0x12e)]&&!_0x3b5f73[_0x566904(0x135)][_0x566904(0x12e)]&&!_0x3b5f73[_0x566904(0x11b)]['length'])continue;const _0x31e05d=[],_0x458ff7=[],_0x31a720=new salesforce_components_manager_service_1[(_0x566904(0x148))](this[_0x566904(0x118)][_0x566904(0x14b)],this[_0x566904(0x118)][_0x566904(0x11f)],_0x3b5f73['author'],this[_0x566904(0x118)][_0x566904(0x121)],this[_0x566904(0x10c)]);_0x31e05d['push'](...await _0x31a720[_0x566904(0x130)](_0x3b5f73[_0x566904(0x125)],this['options'][_0x566904(0x154)])),_0x31e05d[_0x566904(0x149)](...await _0x31a720[_0x566904(0x122)](_0x3b5f73[_0x566904(0x135)],this[_0x566904(0x118)]['commitId'])),_0x458ff7[_0x566904(0x149)](await _0x31a720[_0x566904(0x12f)](_0x3b5f73[_0x566904(0x11b)],!![])),this['proceededComponentsMeta']=_0x31a720[_0x566904(0x12a)](),await this['proceedRequests'](_0x31e05d,!![]);for(const _0x5548e2 of _0x458ff7){_0x5548e2['manifests'][_0x566904(0x12e)]&&await this[_0x566904(0x133)](_0x5548e2['manifests'],!![]),_0x5548e2[_0x566904(0x11c)][_0x566904(0x12e)]&&await this['proceedRequests'](_0x5548e2['componentsToUpdate'],!![]),_0x5548e2['componentsToDelete'][_0x566904(0x12e)]&&await this[_0x566904(0x133)](_0x5548e2['componentsToDelete'],!![]);}this[_0x566904(0x117)]['log'](_0x566904(0x141),_0x31e05d[_0x566904(0x12e)]);}}async[a126_0xb69ca7(0x143)](_0x56a57f){const _0x56555c=a126_0xb69ca7,_0x3a356e=[],_0x23ca90=[];for(const _0x50e371 of _0x56a57f){if(!_0x50e371[_0x56555c(0x125)][_0x56555c(0x12e)]&&!_0x50e371[_0x56555c(0x135)][_0x56555c(0x12e)]&&!_0x50e371[_0x56555c(0x11b)][_0x56555c(0x12e)])continue;const _0x5297b1=new salesforce_components_manager_service_1[(_0x56555c(0x148))](this[_0x56555c(0x118)][_0x56555c(0x14b)],this[_0x56555c(0x118)]['branchId'],_0x50e371['author'],this['options'][_0x56555c(0x121)],[]);_0x3a356e[_0x56555c(0x149)](...await _0x5297b1[_0x56555c(0x130)](_0x50e371[_0x56555c(0x125)])),_0x3a356e[_0x56555c(0x149)](...await _0x5297b1[_0x56555c(0x122)](_0x50e371['modified'])),_0x23ca90[_0x56555c(0x149)](await _0x5297b1['delete'](_0x50e371['removed']));}this[_0x56555c(0x117)][_0x56555c(0x119)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x3a356e[_0x56555c(0x12e)]),await this[_0x56555c(0x133)](_0x3a356e);const _0x304a10=_0x23ca90[_0x56555c(0x151)]((_0x160ee1,_0x40b004)=>({'manifests':[..._0x160ee1[_0x56555c(0x137)],..._0x40b004['manifests']],'componentsToDelete':[..._0x160ee1[_0x56555c(0x146)],..._0x40b004[_0x56555c(0x146)]],'componentsToUpdate':[..._0x160ee1[_0x56555c(0x11c)],..._0x40b004['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x304a10[_0x56555c(0x137)][_0x56555c(0x12e)]&&await this[_0x56555c(0x133)](_0x304a10[_0x56555c(0x137)],!![]),_0x304a10[_0x56555c(0x11c)][_0x56555c(0x12e)]&&await this[_0x56555c(0x133)](_0x304a10['componentsToUpdate'],!![]),_0x304a10[_0x56555c(0x146)][_0x56555c(0x12e)]&&await this['proceedRequests'](_0x304a10['componentsToDelete'],!![]);}async[a126_0xb69ca7(0x13b)](_0x5594a8){const _0x5d9919=a126_0xb69ca7;this[_0x5d9919(0x118)][_0x5d9919(0x11f)]?await this[_0x5d9919(0x143)](_0x5594a8):await this[_0x5d9919(0x147)](_0x5594a8);}}exports[a126_0xb69ca7(0x124)]=SalesforceCommitsManager;