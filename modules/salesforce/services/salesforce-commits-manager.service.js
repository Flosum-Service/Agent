const a127_0x3d7c1b=a127_0x4254;function a127_0x4254(_0x264376,_0x4726ca){const _0x3cbae4=a127_0x1ce0();return a127_0x4254=function(_0x107014,_0x4d01f3){_0x107014=_0x107014-0x18b;let _0x1ce0cb=_0x3cbae4[_0x107014];return _0x1ce0cb;},a127_0x4254(_0x264376,_0x4726ca);}(function(_0x348f72,_0x4a2b3e){const _0x43f85f=a127_0x4254,_0x50474c=_0x348f72();while(!![]){try{const _0x54e3e9=-parseInt(_0x43f85f(0x1c1))/0x1*(parseInt(_0x43f85f(0x1a5))/0x2)+-parseInt(_0x43f85f(0x19c))/0x3*(-parseInt(_0x43f85f(0x1a8))/0x4)+-parseInt(_0x43f85f(0x1b9))/0x5+parseInt(_0x43f85f(0x1bc))/0x6+parseInt(_0x43f85f(0x19e))/0x7*(-parseInt(_0x43f85f(0x1af))/0x8)+parseInt(_0x43f85f(0x1b1))/0x9+parseInt(_0x43f85f(0x1ad))/0xa*(-parseInt(_0x43f85f(0x195))/0xb);if(_0x54e3e9===_0x4a2b3e)break;else _0x50474c['push'](_0x50474c['shift']());}catch(_0x210a82){_0x50474c['push'](_0x50474c['shift']());}}}(a127_0x1ce0,0x6e2f5));const a127_0x4d01f3=(function(){let _0x31d3bb=!![];return function(_0xf87c49,_0x42d95e){const _0x2c6851=_0x31d3bb?function(){const _0x16f6e7=a127_0x4254;if(_0x42d95e){const _0x3fb267=_0x42d95e[_0x16f6e7(0x192)](_0xf87c49,arguments);return _0x42d95e=null,_0x3fb267;}}:function(){};return _0x31d3bb=![],_0x2c6851;};}()),a127_0x107014=a127_0x4d01f3(this,function(){const _0xb6351a=a127_0x4254;return a127_0x107014[_0xb6351a(0x1a4)]()[_0xb6351a(0x196)](_0xb6351a(0x197))['toString']()[_0xb6351a(0x1cf)](a127_0x107014)['search'](_0xb6351a(0x197));});a127_0x107014();'use strict';var __importDefault=this&&this[a127_0x3d7c1b(0x19f)]||function(_0x5715de){const _0x30823b=a127_0x3d7c1b;return _0x5715de&&_0x5715de[_0x30823b(0x1c7)]?_0x5715de:{'default':_0x5715de};};Object[a127_0x3d7c1b(0x1d6)](exports,'__esModule',{'value':!![]}),exports[a127_0x3d7c1b(0x1c3)]=void 0x0;const core_1=require(a127_0x3d7c1b(0x1ab)),typedi_1=__importDefault(require(a127_0x3d7c1b(0x1b7))),constants_1=require(a127_0x3d7c1b(0x1b8)),utils_1=require(a127_0x3d7c1b(0x18e)),salesforce_error_1=require(a127_0x3d7c1b(0x1a1)),composite_utils_1=require(a127_0x3d7c1b(0x190)),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a127_0x3d7c1b(0x18f)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceCommitsManager{constructor(_0x5d16e9){const _0x52d31=a127_0x3d7c1b;this[_0x52d31(0x191)]=_0x5d16e9,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x52d31(0x1be)]=new core_1['Logger'](SalesforceCommitsManager[_0x52d31(0x1a7)]),this[_0x52d31(0x1c6)]=this[_0x52d31(0x191)][_0x52d31(0x1be)],this[_0x52d31(0x1cb)]=typedi_1[_0x52d31(0x1a0)][_0x52d31(0x1a6)](salesforce_composite_service_1[_0x52d31(0x1b2)]),this[_0x52d31(0x1b5)]=typedi_1[_0x52d31(0x1a0)]['get'](salesforce_git_sync_service_1[_0x52d31(0x1c8)]),this[_0x52d31(0x1ae)]=[];}async['proceedRequests'](_0x4c551d,_0x264d7c=![]){const _0xcb32fc=a127_0x3d7c1b,_0x4a2252=(this[_0xcb32fc(0x1a3)]+ +_0x264d7c)*0x3,_0x36317c=utils_1[_0xcb32fc(0x1b3)](_0x4c551d,_0x4a2252);try{while(_0x36317c['length']){const _0x5eb664=_0x36317c[_0xcb32fc(0x198)](0x0,Math[_0xcb32fc(0x1c2)](constants_1[_0xcb32fc(0x1bf)]/_0x4a2252));await this['sfLogger'][_0xcb32fc(0x1d4)](_0xcb32fc(0x199)+_0x5eb664[_0xcb32fc(0x18c)]*_0x4a2252+_0xcb32fc(0x1b0))[_0xcb32fc(0x1cd)]();const _0xb62150=_0x5eb664['map']((_0x44e958,_0x56f436)=>({'graphId':'graph'+_0x56f436,'compositeRequest':_0x44e958})),_0x89e9c7=await this[_0xcb32fc(0x1cb)]['executeGraphs'](_0xb62150);if(_0x264d7c){const _0x25d68a=composite_utils_1[_0xcb32fc(0x1c5)](_0x89e9c7);for(const {id:_0x53c9ab,ref:_0x3518f9}of _0x25d68a){const _0x4a66a5=this[_0xcb32fc(0x1ae)]['find'](_0x39c748=>_0x39c748[_0xcb32fc(0x1d3)]===_0x3518f9);_0x4a66a5&&(_0x4a66a5['componentId']=_0x53c9ab);}}}}catch(_0x58c534){this[_0xcb32fc(0x1be)][_0xcb32fc(0x1b4)](_0x58c534 instanceof salesforce_error_1['SalesforceError']?JSON[_0xcb32fc(0x1ba)](_0x58c534[_0xcb32fc(0x1ce)](),null,0x2):_0x58c534),this['sfLogger']['log'](_0x58c534 instanceof salesforce_error_1[_0xcb32fc(0x18d)]?JSON[_0xcb32fc(0x1ba)](_0x58c534['toJSON'](),null,0x2):_0x58c534['toString']());throw _0x58c534;}}async[a127_0x3d7c1b(0x1c9)](_0x369d29){const _0x491c11=a127_0x3d7c1b;for(const _0x351fc9 of _0x369d29){if(!_0x351fc9[_0x491c11(0x1aa)]['length']&&!_0x351fc9[_0x491c11(0x1d5)][_0x491c11(0x18c)]&&!_0x351fc9[_0x491c11(0x1c0)][_0x491c11(0x18c)])continue;const _0xe517af=[],_0x6a1359=[],_0x244776=new salesforce_components_manager_service_1[(_0x491c11(0x1bb))](this[_0x491c11(0x191)][_0x491c11(0x1a2)],this[_0x491c11(0x191)][_0x491c11(0x193)],_0x351fc9[_0x491c11(0x1c4)],this[_0x491c11(0x191)]['recordTypes'],this['proceededComponentsMeta']);_0xe517af[_0x491c11(0x1cc)](...await _0x244776[_0x491c11(0x1a9)](_0x351fc9['inserted'],this[_0x491c11(0x191)]['commitId'])),_0xe517af['push'](...await _0x244776[_0x491c11(0x1ac)](_0x351fc9[_0x491c11(0x1d5)],this[_0x491c11(0x191)][_0x491c11(0x19d)])),_0x6a1359[_0x491c11(0x1cc)](await _0x244776[_0x491c11(0x19a)](_0x351fc9[_0x491c11(0x1c0)],!![])),this[_0x491c11(0x1ae)]=_0x244776[_0x491c11(0x194)](),await this[_0x491c11(0x19b)](_0xe517af,!![]);for(const _0x5ea79f of _0x6a1359){_0x5ea79f[_0x491c11(0x1d1)][_0x491c11(0x18c)]&&await this[_0x491c11(0x19b)](_0x5ea79f[_0x491c11(0x1d1)],!![]),_0x5ea79f['componentsToUpdate'][_0x491c11(0x18c)]&&await this['proceedRequests'](_0x5ea79f[_0x491c11(0x1d2)],!![]),_0x5ea79f['componentsToDelete'][_0x491c11(0x18c)]&&await this[_0x491c11(0x19b)](_0x5ea79f[_0x491c11(0x1ca)],!![]);}this[_0x491c11(0x1be)]['log']('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0xe517af[_0x491c11(0x18c)]);}}async['proceedCommitsToBranch'](_0x6a6885){const _0x3fc63a=a127_0x3d7c1b,_0x1b7ae0=[],_0x29c476=[];for(const _0x431204 of _0x6a6885){if(!_0x431204[_0x3fc63a(0x1aa)]['length']&&!_0x431204['modified']['length']&&!_0x431204[_0x3fc63a(0x1c0)][_0x3fc63a(0x18c)])continue;const _0x28bd59=new salesforce_components_manager_service_1[(_0x3fc63a(0x1bb))](this['options'][_0x3fc63a(0x1a2)],this[_0x3fc63a(0x191)]['branchId'],_0x431204[_0x3fc63a(0x1c4)],this[_0x3fc63a(0x191)][_0x3fc63a(0x18b)],[]);_0x1b7ae0['push'](...await _0x28bd59[_0x3fc63a(0x1a9)](_0x431204[_0x3fc63a(0x1aa)])),_0x1b7ae0['push'](...await _0x28bd59['update'](_0x431204[_0x3fc63a(0x1d5)])),_0x29c476[_0x3fc63a(0x1cc)](await _0x28bd59[_0x3fc63a(0x19a)](_0x431204[_0x3fc63a(0x1c0)]));}this[_0x3fc63a(0x1be)][_0x3fc63a(0x1d4)](_0x3fc63a(0x1d0),_0x1b7ae0[_0x3fc63a(0x18c)]),await this['proceedRequests'](_0x1b7ae0);const _0x2b731e=_0x29c476[_0x3fc63a(0x1b6)]((_0x74ffbe,_0x12e631)=>({'manifests':[..._0x74ffbe['manifests'],..._0x12e631[_0x3fc63a(0x1d1)]],'componentsToDelete':[..._0x74ffbe[_0x3fc63a(0x1ca)],..._0x12e631['componentsToDelete']],'componentsToUpdate':[..._0x74ffbe['componentsToUpdate'],..._0x12e631[_0x3fc63a(0x1d2)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x2b731e[_0x3fc63a(0x1d1)][_0x3fc63a(0x18c)]&&await this[_0x3fc63a(0x19b)](_0x2b731e[_0x3fc63a(0x1d1)],!![]),_0x2b731e[_0x3fc63a(0x1d2)]['length']&&await this[_0x3fc63a(0x19b)](_0x2b731e[_0x3fc63a(0x1d2)],!![]),_0x2b731e[_0x3fc63a(0x1ca)][_0x3fc63a(0x18c)]&&await this[_0x3fc63a(0x19b)](_0x2b731e[_0x3fc63a(0x1ca)],!![]);}async[a127_0x3d7c1b(0x1bd)](_0x542574){const _0x568625=a127_0x3d7c1b;this[_0x568625(0x191)][_0x568625(0x193)]?await this['proceedCommitsToBranch'](_0x542574):await this[_0x568625(0x1c9)](_0x542574);}}exports[a127_0x3d7c1b(0x1c3)]=SalesforceCommitsManager;function a127_0x1ce0(){const _0x18af62=['componentsToUpdate','reference','log','modified','defineProperty','recordTypes','length','SalesforceError','../../shared/utils','./salesforce-composite.service','../utils/composite.utils','options','apply','branchId','getProceededComponentsMeta','129294Nkvunb','search','(((.+)+)+)+$','splice','[INFO]\x20Sending\x20','delete','proceedRequests','2155767IodTgv','commitId','1082473udBdnc','__importDefault','default','../errors/salesforce.error','repositoryId','COMPONENTS_PER_CHUNK','toString','2RlkdyJ','get','name','4NvTWnC','insert','inserted','../../../core','update','270GXMLOM','proceededComponentsMeta','16zHDazS','\x20requests\x20to\x20composite\x20api.','7437186OwSWgl','SalesforceCompositeService','chunkArray','error','gitSync','reduce','typedi','../../../constants','3360730OpEHDh','stringify','SalesforceComponentsManager','2703558tzvrcU','proceedCommits','logger','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','removed','245437vsyGzh','floor','SalesforceCommitsManager','author','extractComponentIdsFromGraphsResponse','sfLogger','__esModule','SalesforceGitSyncService','proceedCommitsToRepository','componentsToDelete','composite','push','send','toJSON','constructor','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','manifests'];a127_0x1ce0=function(){return _0x18af62;};return a127_0x1ce0();}