const a127_0x2ac1a2=a127_0x9394;(function(_0x14cb6f,_0x1b7f9b){const _0x460325=a127_0x9394,_0x3a6ded=_0x14cb6f();while(!![]){try{const _0xddfa68=-parseInt(_0x460325(0x116))/0x1*(parseInt(_0x460325(0x114))/0x2)+-parseInt(_0x460325(0x141))/0x3*(parseInt(_0x460325(0x11f))/0x4)+-parseInt(_0x460325(0x128))/0x5+parseInt(_0x460325(0x12a))/0x6*(-parseInt(_0x460325(0x14a))/0x7)+parseInt(_0x460325(0x151))/0x8+parseInt(_0x460325(0x149))/0x9*(-parseInt(_0x460325(0x142))/0xa)+parseInt(_0x460325(0x11a))/0xb*(parseInt(_0x460325(0x13f))/0xc);if(_0xddfa68===_0x1b7f9b)break;else _0x3a6ded['push'](_0x3a6ded['shift']());}catch(_0x2f0726){_0x3a6ded['push'](_0x3a6ded['shift']());}}}(a127_0x2dce,0xd22ad));const a127_0x3d9f8d=(function(){let _0x1230db=!![];return function(_0xb88efc,_0x50e3cf){const _0xcb3ed2=_0x1230db?function(){const _0x5f5ce1=a127_0x9394;if(_0x50e3cf){const _0xfeaeac=_0x50e3cf[_0x5f5ce1(0x148)](_0xb88efc,arguments);return _0x50e3cf=null,_0xfeaeac;}}:function(){};return _0x1230db=![],_0xcb3ed2;};}()),a127_0x34cc6b=a127_0x3d9f8d(this,function(){const _0x2470bc=a127_0x9394;return a127_0x34cc6b[_0x2470bc(0x130)]()[_0x2470bc(0x143)](_0x2470bc(0x111))[_0x2470bc(0x130)]()[_0x2470bc(0x11b)](a127_0x34cc6b)[_0x2470bc(0x143)](_0x2470bc(0x111));});function a127_0x2dce(){const _0x587d23=['floor','reduce','name','map','composite','removed','graph','201745LhlvKP','SalesforceCompositeService','162kXSVzu','../../../constants','SalesforceError','./salesforce-git-sync.service','../errors/salesforce.error','typedi','toString','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','sfLogger','componentsToDelete','componentsToUpdate','repositoryId','send','proceedCommits','author','toJSON','branchId','proceedCommitsToBranch','log','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','update','36efjoSz','../../../core','6981qWTNBR','22730WhMtXe','search','executeGraphs','modified','SalesforceCommitsManager','proceededComponentsMeta','apply','2349uAIUKq','71673OKzubV','SalesforceComponentsManager','error','commitId','insert','proceedRequests','options','3665520PwpSGD','SalesforceGitSyncService','default','getProceededComponentsMeta','manifests','[INFO]\x20Sending\x20','get','length','./salesforce-components-manager.service','proceedCommitsToRepository','reference','__esModule','(((.+)+)+)+$','recordTypes','gitSync','783152ckoFzD','../../shared/utils','2tfObSk','inserted','stringify','chunkArray','11464651DghyEo','constructor','push','logger','delete','1772sjcvdP','./salesforce-composite.service'];a127_0x2dce=function(){return _0x587d23;};return a127_0x2dce();}a127_0x34cc6b();'use strict';function a127_0x9394(_0x390455,_0x46c993){const _0x1bb33a=a127_0x2dce();return a127_0x9394=function(_0x34cc6b,_0x3d9f8d){_0x34cc6b=_0x34cc6b-0x108;let _0x2dce36=_0x1bb33a[_0x34cc6b];return _0x2dce36;},a127_0x9394(_0x390455,_0x46c993);}var __importDefault=this&&this['__importDefault']||function(_0x133b69){const _0x436574=a127_0x9394;return _0x133b69&&_0x133b69[_0x436574(0x110)]?_0x133b69:{'default':_0x133b69};};Object['defineProperty'](exports,a127_0x2ac1a2(0x110),{'value':!![]}),exports[a127_0x2ac1a2(0x146)]=void 0x0;const core_1=require(a127_0x2ac1a2(0x140)),typedi_1=__importDefault(require(a127_0x2ac1a2(0x12f))),constants_1=require(a127_0x2ac1a2(0x12b)),utils_1=require(a127_0x2ac1a2(0x115)),salesforce_error_1=require(a127_0x2ac1a2(0x12e)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a127_0x2ac1a2(0x10d)),salesforce_composite_service_1=require(a127_0x2ac1a2(0x120)),salesforce_git_sync_service_1=require(a127_0x2ac1a2(0x12d));class SalesforceCommitsManager{constructor(_0x2a86a0){const _0x2ecaeb=a127_0x2ac1a2;this['options']=_0x2a86a0,this['COMPONENTS_PER_CHUNK']=0x3,this['logger']=new core_1['Logger'](SalesforceCommitsManager[_0x2ecaeb(0x123)]),this[_0x2ecaeb(0x132)]=this[_0x2ecaeb(0x150)][_0x2ecaeb(0x11d)],this[_0x2ecaeb(0x125)]=typedi_1[_0x2ecaeb(0x153)]['get'](salesforce_composite_service_1[_0x2ecaeb(0x129)]),this[_0x2ecaeb(0x113)]=typedi_1[_0x2ecaeb(0x153)][_0x2ecaeb(0x10b)](salesforce_git_sync_service_1[_0x2ecaeb(0x152)]),this[_0x2ecaeb(0x147)]=[];}async['proceedRequests'](_0x554778,_0x89f06e=![]){const _0x817e02=a127_0x2ac1a2,_0x3c8250=(this['COMPONENTS_PER_CHUNK']+ +_0x89f06e)*0x3,_0x494efc=utils_1[_0x817e02(0x119)](_0x554778,_0x3c8250);try{while(_0x494efc[_0x817e02(0x10c)]){const _0x4599f5=_0x494efc['splice'](0x0,Math[_0x817e02(0x121)](constants_1[_0x817e02(0x13d)]/_0x3c8250));await this[_0x817e02(0x132)]['log'](_0x817e02(0x10a)+_0x4599f5[_0x817e02(0x10c)]*_0x3c8250+'\x20requests\x20to\x20composite\x20api.')[_0x817e02(0x136)]();const _0x248d87=_0x4599f5[_0x817e02(0x124)]((_0x4be06a,_0x1a65a2)=>({'graphId':_0x817e02(0x127)+_0x1a65a2,'compositeRequest':_0x4be06a})),_0x504ea7=await this[_0x817e02(0x125)][_0x817e02(0x144)](_0x248d87);if(_0x89f06e){const _0xbddac0=composite_utils_1['extractComponentIdsFromGraphsResponse'](_0x504ea7);for(const {id:_0x4dfad8,ref:_0x925933}of _0xbddac0){const _0x3dd7a5=this['proceededComponentsMeta']['find'](_0x13749f=>_0x13749f[_0x817e02(0x10f)]===_0x925933);_0x3dd7a5&&(_0x3dd7a5['componentId']=_0x4dfad8);}}}}catch(_0x17dfa1){this[_0x817e02(0x11d)][_0x817e02(0x14c)](_0x17dfa1 instanceof salesforce_error_1['SalesforceError']?JSON['stringify'](_0x17dfa1[_0x817e02(0x139)](),null,0x2):_0x17dfa1),this[_0x817e02(0x132)][_0x817e02(0x13c)](_0x17dfa1 instanceof salesforce_error_1[_0x817e02(0x12c)]?JSON[_0x817e02(0x118)](_0x17dfa1['toJSON'](),null,0x2):_0x17dfa1[_0x817e02(0x130)]());throw _0x17dfa1;}}async[a127_0x2ac1a2(0x10e)](_0x57d301){const _0x56e03c=a127_0x2ac1a2;for(const _0x3b648f of _0x57d301){if(!_0x3b648f[_0x56e03c(0x117)][_0x56e03c(0x10c)]&&!_0x3b648f[_0x56e03c(0x145)][_0x56e03c(0x10c)]&&!_0x3b648f[_0x56e03c(0x126)][_0x56e03c(0x10c)])continue;const _0xbbb3d4=[],_0x1ef282=[],_0x4c1c36=new salesforce_components_manager_service_1[(_0x56e03c(0x14b))](this[_0x56e03c(0x150)][_0x56e03c(0x135)],this['options']['branchId'],_0x3b648f[_0x56e03c(0x138)],this['options'][_0x56e03c(0x112)],this['proceededComponentsMeta']);_0xbbb3d4['push'](...await _0x4c1c36[_0x56e03c(0x14e)](_0x3b648f[_0x56e03c(0x117)],this['options'][_0x56e03c(0x14d)])),_0xbbb3d4[_0x56e03c(0x11c)](...await _0x4c1c36[_0x56e03c(0x13e)](_0x3b648f[_0x56e03c(0x145)],this[_0x56e03c(0x150)]['commitId'])),_0x1ef282['push'](await _0x4c1c36[_0x56e03c(0x11e)](_0x3b648f[_0x56e03c(0x126)],!![])),this[_0x56e03c(0x147)]=_0x4c1c36[_0x56e03c(0x108)](),await this[_0x56e03c(0x14f)](_0xbbb3d4,!![]);for(const _0x4e2d31 of _0x1ef282){_0x4e2d31[_0x56e03c(0x109)]['length']&&await this['proceedRequests'](_0x4e2d31[_0x56e03c(0x109)],!![]),_0x4e2d31[_0x56e03c(0x134)][_0x56e03c(0x10c)]&&await this[_0x56e03c(0x14f)](_0x4e2d31[_0x56e03c(0x134)],!![]),_0x4e2d31[_0x56e03c(0x133)][_0x56e03c(0x10c)]&&await this[_0x56e03c(0x14f)](_0x4e2d31[_0x56e03c(0x133)],!![]);}this['logger'][_0x56e03c(0x13c)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0xbbb3d4[_0x56e03c(0x10c)]);}}async[a127_0x2ac1a2(0x13b)](_0x228a19){const _0x3a0d95=a127_0x2ac1a2,_0x4762ef=[],_0x156156=[];for(const _0x3efdd4 of _0x228a19){if(!_0x3efdd4['inserted'][_0x3a0d95(0x10c)]&&!_0x3efdd4[_0x3a0d95(0x145)]['length']&&!_0x3efdd4[_0x3a0d95(0x126)]['length'])continue;const _0x4b8534=new salesforce_components_manager_service_1[(_0x3a0d95(0x14b))](this['options'][_0x3a0d95(0x135)],this[_0x3a0d95(0x150)]['branchId'],_0x3efdd4['author'],this['options'][_0x3a0d95(0x112)],[]);_0x4762ef[_0x3a0d95(0x11c)](...await _0x4b8534['insert'](_0x3efdd4[_0x3a0d95(0x117)])),_0x4762ef[_0x3a0d95(0x11c)](...await _0x4b8534[_0x3a0d95(0x13e)](_0x3efdd4[_0x3a0d95(0x145)])),_0x156156['push'](await _0x4b8534[_0x3a0d95(0x11e)](_0x3efdd4[_0x3a0d95(0x126)]));}this[_0x3a0d95(0x11d)][_0x3a0d95(0x13c)](_0x3a0d95(0x131),_0x4762ef[_0x3a0d95(0x10c)]),await this[_0x3a0d95(0x14f)](_0x4762ef);const _0x2e0339=_0x156156[_0x3a0d95(0x122)]((_0x299884,_0x416077)=>({'manifests':[..._0x299884[_0x3a0d95(0x109)],..._0x416077['manifests']],'componentsToDelete':[..._0x299884[_0x3a0d95(0x133)],..._0x416077[_0x3a0d95(0x133)]],'componentsToUpdate':[..._0x299884[_0x3a0d95(0x134)],..._0x416077[_0x3a0d95(0x134)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x2e0339[_0x3a0d95(0x109)][_0x3a0d95(0x10c)]&&await this[_0x3a0d95(0x14f)](_0x2e0339[_0x3a0d95(0x109)],!![]),_0x2e0339[_0x3a0d95(0x134)]['length']&&await this['proceedRequests'](_0x2e0339[_0x3a0d95(0x134)],!![]),_0x2e0339[_0x3a0d95(0x133)]['length']&&await this[_0x3a0d95(0x14f)](_0x2e0339['componentsToDelete'],!![]);}async[a127_0x2ac1a2(0x137)](_0x1df6b){const _0x13828e=a127_0x2ac1a2;this[_0x13828e(0x150)][_0x13828e(0x13a)]?await this[_0x13828e(0x13b)](_0x1df6b):await this['proceedCommitsToRepository'](_0x1df6b);}}exports[a127_0x2ac1a2(0x146)]=SalesforceCommitsManager;