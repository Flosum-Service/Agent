const a126_0x55cff4=a126_0x1705;(function(_0x1c27bf,_0x28de2a){const _0x5e12cf=a126_0x1705,_0xad74c8=_0x1c27bf();while(!![]){try{const _0x40ea89=parseInt(_0x5e12cf(0x85))/0x1+parseInt(_0x5e12cf(0x9d))/0x2*(-parseInt(_0x5e12cf(0x9c))/0x3)+-parseInt(_0x5e12cf(0x91))/0x4*(-parseInt(_0x5e12cf(0xb4))/0x5)+parseInt(_0x5e12cf(0x8d))/0x6*(-parseInt(_0x5e12cf(0x77))/0x7)+parseInt(_0x5e12cf(0x9e))/0x8*(parseInt(_0x5e12cf(0xae))/0x9)+parseInt(_0x5e12cf(0x8c))/0xa*(-parseInt(_0x5e12cf(0x7f))/0xb)+-parseInt(_0x5e12cf(0xa9))/0xc*(parseInt(_0x5e12cf(0x79))/0xd);if(_0x40ea89===_0x28de2a)break;else _0xad74c8['push'](_0xad74c8['shift']());}catch(_0x395929){_0xad74c8['push'](_0xad74c8['shift']());}}}(a126_0x148d,0xa9c81));function a126_0x148d(){const _0x21dbdc=['139630wfugzX','push','log','../../../constants','getProceededComponentsMeta','logger','inserted','componentsToUpdate','typedi','[INFO]\x20Sending\x20','../../shared/utils','constructor','defineProperty','35MuHEHo','repositoryId','169EnnVKV','toJSON','SalesforceComponentsManager','length','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','../../../core','121rXqGTB','composite','removed','recordTypes','author','reference','40816LAhmlP','reduce','search','extractComponentIdsFromGraphsResponse','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','gitSync','default','103110owUfwG','1006890rfnXig','toString','__importDefault','name','172bRvLaI','componentId','insert','error','./salesforce-composite.service','floor','send','find','proceedRequests','(((.+)+)+)+$','COMPONENTS_PER_CHUNK','6BvPjGO','89144ZtoUIE','16608gReHeK','sfLogger','update','stringify','branchId','proceedCommitsToBranch','options','proceedCommits','message','apply','modified','221052SHbKeY','splice','Logger','SalesforceError','map','3186IHeonu','manifests','proceedCommitsToRepository','componentsToDelete','proceededComponentsMeta','createCommit'];a126_0x148d=function(){return _0x21dbdc;};return a126_0x148d();}const a126_0x336495=(function(){let _0x333ac7=!![];return function(_0x569c3c,_0xbf2c4b){const _0x29fd73=_0x333ac7?function(){const _0x474faa=a126_0x1705;if(_0xbf2c4b){const _0x4b664d=_0xbf2c4b[_0x474faa(0xa7)](_0x569c3c,arguments);return _0xbf2c4b=null,_0x4b664d;}}:function(){};return _0x333ac7=![],_0x29fd73;};}()),a126_0x30cb03=a126_0x336495(this,function(){const _0x563e50=a126_0x1705;return a126_0x30cb03['toString']()[_0x563e50(0x87)]('(((.+)+)+)+$')[_0x563e50(0x8e)]()[_0x563e50(0x75)](a126_0x30cb03)[_0x563e50(0x87)](_0x563e50(0x9a));});a126_0x30cb03();function a126_0x1705(_0x20f975,_0x56aa89){const _0x52aec7=a126_0x148d();return a126_0x1705=function(_0x30cb03,_0x336495){_0x30cb03=_0x30cb03-0x72;let _0x148d0a=_0x52aec7[_0x30cb03];return _0x148d0a;},a126_0x1705(_0x20f975,_0x56aa89);}'use strict';var __importDefault=this&&this[a126_0x55cff4(0x8f)]||function(_0x4d29a0){return _0x4d29a0&&_0x4d29a0['__esModule']?_0x4d29a0:{'default':_0x4d29a0};};Object[a126_0x55cff4(0x76)](exports,'__esModule',{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require(a126_0x55cff4(0x7e)),typedi_1=__importDefault(require(a126_0x55cff4(0x72))),constants_1=require(a126_0x55cff4(0xb7)),utils_1=require(a126_0x55cff4(0x74)),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a126_0x55cff4(0x95)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceCommitsManager{constructor(_0x1647ba){const _0x4039bc=a126_0x55cff4;this[_0x4039bc(0xa4)]=_0x1647ba,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x4039bc(0xb9)]=new core_1[(_0x4039bc(0xab))](SalesforceCommitsManager[_0x4039bc(0x90)]),this[_0x4039bc(0x9f)]=this[_0x4039bc(0xa4)]['logger'],this[_0x4039bc(0x80)]=typedi_1[_0x4039bc(0x8b)]['get'](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x4039bc(0x8a)]=typedi_1[_0x4039bc(0x8b)]['get'](salesforce_git_sync_service_1['SalesforceGitSyncService']),this[_0x4039bc(0xb2)]=[];}async[a126_0x55cff4(0x99)](_0x2f387b,_0x5e1983=![]){const _0x110e0e=a126_0x55cff4,_0x2f4e1a=(this[_0x110e0e(0x9b)]+ +_0x5e1983)*0x3,_0x1504cc=utils_1['chunkArray'](_0x2f387b,_0x2f4e1a);try{while(_0x1504cc[_0x110e0e(0x7c)]){const _0x53cba3=_0x1504cc[_0x110e0e(0xaa)](0x0,Math[_0x110e0e(0x96)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x2f4e1a));await this[_0x110e0e(0x9f)][_0x110e0e(0xb6)](_0x110e0e(0x73)+_0x53cba3[_0x110e0e(0x7c)]*_0x2f4e1a+'\x20requests\x20to\x20composite\x20api.')[_0x110e0e(0x97)]();const _0x4465fd=_0x53cba3[_0x110e0e(0xad)]((_0x225aa7,_0x5d893d)=>({'graphId':'graph'+_0x5d893d,'compositeRequest':_0x225aa7})),_0x41290e=await this[_0x110e0e(0x80)]['executeGraphs'](_0x4465fd);if(_0x5e1983){const _0xb0cda4=composite_utils_1[_0x110e0e(0x88)](_0x41290e);for(const {id:_0x1bce87,ref:_0x488fa3}of _0xb0cda4){const _0x45848a=this['proceededComponentsMeta'][_0x110e0e(0x98)](_0x6f097a=>_0x6f097a[_0x110e0e(0x84)]===_0x488fa3);_0x45848a&&(_0x45848a[_0x110e0e(0x92)]=_0x1bce87);}}}}catch(_0x473828){this[_0x110e0e(0xb9)][_0x110e0e(0x94)](_0x473828 instanceof salesforce_error_1[_0x110e0e(0xac)]?JSON['stringify'](_0x473828[_0x110e0e(0x7a)](),null,0x2):_0x473828),this[_0x110e0e(0x9f)][_0x110e0e(0xb6)](_0x473828 instanceof salesforce_error_1[_0x110e0e(0xac)]?JSON[_0x110e0e(0xa1)](_0x473828['toJSON'](),null,0x2):_0x473828[_0x110e0e(0x8e)]());throw _0x473828;}}async['proceedCommitsToRepository'](_0x1af8b8){const _0x239abc=a126_0x55cff4;for(const _0x42ac8a of _0x1af8b8){if(!_0x42ac8a['inserted']['length']&&!_0x42ac8a[_0x239abc(0xa8)][_0x239abc(0x7c)]&&!_0x42ac8a[_0x239abc(0x81)][_0x239abc(0x7c)])continue;let _0x33b349='';(_0x42ac8a['modified']['length']||_0x42ac8a[_0x239abc(0xba)][_0x239abc(0x7c)])&&(_0x33b349=await this[_0x239abc(0x8a)][_0x239abc(0xb3)](_0x42ac8a[_0x239abc(0xa6)],this['options'][_0x239abc(0x78)]));const _0x2f9825=[],_0xbd3fbb=[],_0x4dca98=new salesforce_components_manager_service_1[(_0x239abc(0x7b))](this[_0x239abc(0xa4)][_0x239abc(0x78)],this[_0x239abc(0xa4)][_0x239abc(0xa2)],_0x42ac8a[_0x239abc(0x83)],this[_0x239abc(0xa4)]['recordTypes'],this[_0x239abc(0xb2)]);_0x2f9825[_0x239abc(0xb5)](...await _0x4dca98[_0x239abc(0x93)](_0x42ac8a[_0x239abc(0xba)],_0x33b349)),_0x2f9825[_0x239abc(0xb5)](...await _0x4dca98[_0x239abc(0xa0)](_0x42ac8a[_0x239abc(0xa8)],_0x33b349)),_0xbd3fbb[_0x239abc(0xb5)](await _0x4dca98['delete'](_0x42ac8a['removed'],!![])),this[_0x239abc(0xb2)]=_0x4dca98[_0x239abc(0xb8)](),await this[_0x239abc(0x99)](_0x2f9825,!![]);for(const _0x3da84f of _0xbd3fbb){_0x3da84f[_0x239abc(0xaf)][_0x239abc(0x7c)]&&await this['proceedRequests'](_0x3da84f[_0x239abc(0xaf)],!![]),_0x3da84f[_0x239abc(0xbb)][_0x239abc(0x7c)]&&await this['proceedRequests'](_0x3da84f['componentsToUpdate'],!![]),_0x3da84f[_0x239abc(0xb1)][_0x239abc(0x7c)]&&await this[_0x239abc(0x99)](_0x3da84f[_0x239abc(0xb1)],!![]);}this[_0x239abc(0xb9)][_0x239abc(0xb6)](_0x239abc(0x89),_0x2f9825[_0x239abc(0x7c)]);}}async['proceedCommitsToBranch'](_0x551924){const _0x1e4a22=a126_0x55cff4,_0x371300=[],_0xc19367=[];for(const _0x1c7709 of _0x551924){if(!_0x1c7709['inserted'][_0x1e4a22(0x7c)]&&!_0x1c7709['modified'][_0x1e4a22(0x7c)]&&!_0x1c7709['removed'][_0x1e4a22(0x7c)])continue;const _0x3af551=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x1e4a22(0xa4)]['repositoryId'],this[_0x1e4a22(0xa4)][_0x1e4a22(0xa2)],_0x1c7709[_0x1e4a22(0x83)],this[_0x1e4a22(0xa4)][_0x1e4a22(0x82)],[]);_0x371300[_0x1e4a22(0xb5)](...await _0x3af551[_0x1e4a22(0x93)](_0x1c7709[_0x1e4a22(0xba)])),_0x371300[_0x1e4a22(0xb5)](...await _0x3af551[_0x1e4a22(0xa0)](_0x1c7709[_0x1e4a22(0xa8)])),_0xc19367['push'](await _0x3af551['delete'](_0x1c7709[_0x1e4a22(0x81)]));}this[_0x1e4a22(0xb9)][_0x1e4a22(0xb6)](_0x1e4a22(0x7d),_0x371300[_0x1e4a22(0x7c)]),await this[_0x1e4a22(0x99)](_0x371300);const _0x3f9a25=_0xc19367[_0x1e4a22(0x86)]((_0x511af1,_0x120510)=>({'manifests':[..._0x511af1[_0x1e4a22(0xaf)],..._0x120510[_0x1e4a22(0xaf)]],'componentsToDelete':[..._0x511af1[_0x1e4a22(0xb1)],..._0x120510[_0x1e4a22(0xb1)]],'componentsToUpdate':[..._0x511af1[_0x1e4a22(0xbb)],..._0x120510[_0x1e4a22(0xbb)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x3f9a25[_0x1e4a22(0xaf)][_0x1e4a22(0x7c)]&&await this['proceedRequests'](_0x3f9a25['manifests'],!![]),_0x3f9a25[_0x1e4a22(0xbb)][_0x1e4a22(0x7c)]&&await this[_0x1e4a22(0x99)](_0x3f9a25[_0x1e4a22(0xbb)],!![]),_0x3f9a25[_0x1e4a22(0xb1)]['length']&&await this[_0x1e4a22(0x99)](_0x3f9a25['componentsToDelete'],!![]);}async[a126_0x55cff4(0xa5)](_0x39303c){const _0x4c5d8a=a126_0x55cff4;this[_0x4c5d8a(0xa4)]['branchId']?await this[_0x4c5d8a(0xa3)](_0x39303c):await this[_0x4c5d8a(0xb0)](_0x39303c);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;