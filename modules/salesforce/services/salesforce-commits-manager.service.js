const a127_0xcb32c5=a127_0x3eb6;(function(_0x40ce80,_0x4c68f5){const _0x3b25f2=a127_0x3eb6,_0x46f386=_0x40ce80();while(!![]){try{const _0x1f4025=parseInt(_0x3b25f2(0x163))/0x1*(-parseInt(_0x3b25f2(0x185))/0x2)+-parseInt(_0x3b25f2(0x14b))/0x3*(parseInt(_0x3b25f2(0x147))/0x4)+-parseInt(_0x3b25f2(0x159))/0x5+parseInt(_0x3b25f2(0x14c))/0x6*(parseInt(_0x3b25f2(0x16e))/0x7)+-parseInt(_0x3b25f2(0x161))/0x8+-parseInt(_0x3b25f2(0x166))/0x9*(parseInt(_0x3b25f2(0x17b))/0xa)+-parseInt(_0x3b25f2(0x15f))/0xb*(-parseInt(_0x3b25f2(0x187))/0xc);if(_0x1f4025===_0x4c68f5)break;else _0x46f386['push'](_0x46f386['shift']());}catch(_0xcae7d0){_0x46f386['push'](_0x46f386['shift']());}}}(a127_0x51d2,0xd66ec));const a127_0x4f29a7=(function(){let _0x1d8a71=!![];return function(_0x488154,_0x5a3ddd){const _0x351ee=_0x1d8a71?function(){const _0x29890a=a127_0x3eb6;if(_0x5a3ddd){const _0x5b6a83=_0x5a3ddd[_0x29890a(0x170)](_0x488154,arguments);return _0x5a3ddd=null,_0x5b6a83;}}:function(){};return _0x1d8a71=![],_0x351ee;};}()),a127_0xe6c00f=a127_0x4f29a7(this,function(){const _0x25feeb=a127_0x3eb6;return a127_0xe6c00f[_0x25feeb(0x144)]()[_0x25feeb(0x16f)]('(((.+)+)+)+$')[_0x25feeb(0x144)]()[_0x25feeb(0x17e)](a127_0xe6c00f)[_0x25feeb(0x16f)](_0x25feeb(0x158));});a127_0xe6c00f();'use strict';var __importDefault=this&&this[a127_0xcb32c5(0x14e)]||function(_0x4973cb){const _0x48a2e0=a127_0xcb32c5;return _0x4973cb&&_0x4973cb[_0x48a2e0(0x17c)]?_0x4973cb:{'default':_0x4973cb};};Object[a127_0xcb32c5(0x151)](exports,'__esModule',{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;function a127_0x3eb6(_0x2b1e32,_0x104c55){const _0x5f0104=a127_0x51d2();return a127_0x3eb6=function(_0xe6c00f,_0x4f29a7){_0xe6c00f=_0xe6c00f-0x143;let _0x51d2b0=_0x5f0104[_0xe6c00f];return _0x51d2b0;},a127_0x3eb6(_0x2b1e32,_0x104c55);}const core_1=require(a127_0xcb32c5(0x17a)),typedi_1=__importDefault(require('typedi')),constants_1=require('../../../constants'),utils_1=require(a127_0xcb32c5(0x165)),salesforce_error_1=require(a127_0xcb32c5(0x173)),composite_utils_1=require(a127_0xcb32c5(0x172)),salesforce_components_manager_service_1=require(a127_0xcb32c5(0x15e)),salesforce_composite_service_1=require(a127_0xcb32c5(0x149)),salesforce_git_sync_service_1=require(a127_0xcb32c5(0x145));function a127_0x51d2(){const _0x3290f4=['componentId','options','SalesforceCompositeService','extractComponentIdsFromGraphsResponse','301OjuVUe','search','apply','removed','../utils/composite.utils','../errors/salesforce.error','error','delete','SalesforceError','manifests','SalesforceGitSyncService','find','../../../core','110oFkgUn','__esModule','\x20requests\x20to\x20composite\x20api.','constructor','recordTypes','update','repositoryId','reference','componentsToDelete','author','1210310ssMAdr','send','9924REcDjt','graph','toString','./salesforce-git-sync.service','inserted','52hyqHfd','toJSON','./salesforce-composite.service','log','69867evLQID','22254HqFyCQ','logger','__importDefault','componentsToUpdate','commitId','defineProperty','composite','insert','chunkArray','length','proceedCommitsToRepository','default','(((.+)+)+)+$','2876970vDuZSs','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','proceedCommitsToBranch','proceedRequests','proceededComponentsMeta','./salesforce-components-manager.service','65483eiYTBl','push','9219080gLNXOT','modified','1jFMCQf','get','../../shared/utils','1283409JZxFAX','SalesforceComponentsManager','Logger','sfLogger'];a127_0x51d2=function(){return _0x3290f4;};return a127_0x51d2();}class SalesforceCommitsManager{constructor(_0x1e7c1c){const _0xdb60b5=a127_0xcb32c5;this[_0xdb60b5(0x16b)]=_0x1e7c1c,this['COMPONENTS_PER_CHUNK']=0x3,this[_0xdb60b5(0x14d)]=new core_1[(_0xdb60b5(0x168))](SalesforceCommitsManager['name']),this['sfLogger']=this[_0xdb60b5(0x16b)][_0xdb60b5(0x14d)],this[_0xdb60b5(0x152)]=typedi_1[_0xdb60b5(0x157)][_0xdb60b5(0x164)](salesforce_composite_service_1[_0xdb60b5(0x16c)]),this['gitSync']=typedi_1['default'][_0xdb60b5(0x164)](salesforce_git_sync_service_1[_0xdb60b5(0x178)]),this[_0xdb60b5(0x15d)]=[];}async[a127_0xcb32c5(0x15c)](_0xb2194b,_0x44eefa=![]){const _0x16e01b=a127_0xcb32c5,_0x2afb3b=(this['COMPONENTS_PER_CHUNK']+ +_0x44eefa)*0x3,_0x4884c1=utils_1[_0x16e01b(0x154)](_0xb2194b,_0x2afb3b);try{while(_0x4884c1['length']){const _0x20c8b8=_0x4884c1['splice'](0x0,Math['floor'](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x2afb3b));await this[_0x16e01b(0x169)]['log']('[INFO]\x20Sending\x20'+_0x20c8b8[_0x16e01b(0x155)]*_0x2afb3b+_0x16e01b(0x17d))[_0x16e01b(0x186)]();const _0x30df9d=_0x20c8b8['map']((_0x261704,_0x4514c2)=>({'graphId':_0x16e01b(0x143)+_0x4514c2,'compositeRequest':_0x261704})),_0x42b77b=await this[_0x16e01b(0x152)]['executeGraphs'](_0x30df9d);if(_0x44eefa){const _0x2d0c29=composite_utils_1[_0x16e01b(0x16d)](_0x42b77b);for(const {id:_0x46fe21,ref:_0x331111}of _0x2d0c29){const _0x1a6a29=this[_0x16e01b(0x15d)][_0x16e01b(0x179)](_0x111643=>_0x111643[_0x16e01b(0x182)]===_0x331111);_0x1a6a29&&(_0x1a6a29[_0x16e01b(0x16a)]=_0x46fe21);}}}}catch(_0x336041){this['logger'][_0x16e01b(0x174)](_0x336041 instanceof salesforce_error_1[_0x16e01b(0x176)]?JSON['stringify'](_0x336041[_0x16e01b(0x148)](),null,0x2):_0x336041),this[_0x16e01b(0x169)]['log'](_0x336041 instanceof salesforce_error_1[_0x16e01b(0x176)]?JSON['stringify'](_0x336041[_0x16e01b(0x148)](),null,0x2):_0x336041[_0x16e01b(0x144)]());throw _0x336041;}}async['proceedCommitsToRepository'](_0x53680c){const _0x52256b=a127_0xcb32c5;for(const _0x44e023 of _0x53680c){if(!_0x44e023[_0x52256b(0x146)][_0x52256b(0x155)]&&!_0x44e023[_0x52256b(0x162)][_0x52256b(0x155)]&&!_0x44e023['removed'][_0x52256b(0x155)])continue;const _0x582126=[],_0x4afc7a=[],_0x1e2776=new salesforce_components_manager_service_1[(_0x52256b(0x167))](this[_0x52256b(0x16b)][_0x52256b(0x181)],this[_0x52256b(0x16b)]['branchId'],_0x44e023[_0x52256b(0x184)],this[_0x52256b(0x16b)]['recordTypes'],this['proceededComponentsMeta']);_0x582126[_0x52256b(0x160)](...await _0x1e2776['insert'](_0x44e023[_0x52256b(0x146)],this[_0x52256b(0x16b)]['commitId'])),_0x582126[_0x52256b(0x160)](...await _0x1e2776['update'](_0x44e023[_0x52256b(0x162)],this[_0x52256b(0x16b)][_0x52256b(0x150)])),_0x4afc7a[_0x52256b(0x160)](await _0x1e2776[_0x52256b(0x175)](_0x44e023['removed'],!![])),this['proceededComponentsMeta']=_0x1e2776['getProceededComponentsMeta'](),await this[_0x52256b(0x15c)](_0x582126,!![]);for(const _0x44706d of _0x4afc7a){_0x44706d[_0x52256b(0x177)]['length']&&await this[_0x52256b(0x15c)](_0x44706d[_0x52256b(0x177)],!![]),_0x44706d['componentsToUpdate'][_0x52256b(0x155)]&&await this[_0x52256b(0x15c)](_0x44706d[_0x52256b(0x14f)],!![]),_0x44706d['componentsToDelete'][_0x52256b(0x155)]&&await this[_0x52256b(0x15c)](_0x44706d[_0x52256b(0x183)],!![]);}this[_0x52256b(0x14d)]['log']('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x582126['length']);}}async[a127_0xcb32c5(0x15b)](_0x16f902){const _0xa49c81=a127_0xcb32c5,_0x5a3e74=[],_0x1a87de=[];for(const _0x366af9 of _0x16f902){if(!_0x366af9[_0xa49c81(0x146)][_0xa49c81(0x155)]&&!_0x366af9[_0xa49c81(0x162)]['length']&&!_0x366af9[_0xa49c81(0x171)][_0xa49c81(0x155)])continue;const _0x1e7992=new salesforce_components_manager_service_1[(_0xa49c81(0x167))](this[_0xa49c81(0x16b)][_0xa49c81(0x181)],this[_0xa49c81(0x16b)]['branchId'],_0x366af9[_0xa49c81(0x184)],this[_0xa49c81(0x16b)][_0xa49c81(0x17f)],[]);_0x5a3e74[_0xa49c81(0x160)](...await _0x1e7992[_0xa49c81(0x153)](_0x366af9[_0xa49c81(0x146)])),_0x5a3e74[_0xa49c81(0x160)](...await _0x1e7992[_0xa49c81(0x180)](_0x366af9[_0xa49c81(0x162)])),_0x1a87de[_0xa49c81(0x160)](await _0x1e7992[_0xa49c81(0x175)](_0x366af9[_0xa49c81(0x171)]));}this[_0xa49c81(0x14d)][_0xa49c81(0x14a)](_0xa49c81(0x15a),_0x5a3e74[_0xa49c81(0x155)]),await this['proceedRequests'](_0x5a3e74);const _0x445a11=_0x1a87de['reduce']((_0x46941c,_0x4a0d45)=>({'manifests':[..._0x46941c[_0xa49c81(0x177)],..._0x4a0d45[_0xa49c81(0x177)]],'componentsToDelete':[..._0x46941c[_0xa49c81(0x183)],..._0x4a0d45[_0xa49c81(0x183)]],'componentsToUpdate':[..._0x46941c[_0xa49c81(0x14f)],..._0x4a0d45[_0xa49c81(0x14f)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x445a11[_0xa49c81(0x177)][_0xa49c81(0x155)]&&await this['proceedRequests'](_0x445a11[_0xa49c81(0x177)],!![]),_0x445a11[_0xa49c81(0x14f)][_0xa49c81(0x155)]&&await this[_0xa49c81(0x15c)](_0x445a11[_0xa49c81(0x14f)],!![]),_0x445a11[_0xa49c81(0x183)][_0xa49c81(0x155)]&&await this[_0xa49c81(0x15c)](_0x445a11[_0xa49c81(0x183)],!![]);}async['proceedCommits'](_0x342011){const _0x12bc55=a127_0xcb32c5;this[_0x12bc55(0x16b)]['branchId']?await this['proceedCommitsToBranch'](_0x342011):await this[_0x12bc55(0x156)](_0x342011);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;