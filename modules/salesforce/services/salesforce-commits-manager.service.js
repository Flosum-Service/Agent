const a127_0x55d2e6=a127_0x59b2;function a127_0x2e72(){const _0xeb5c4f=['./salesforce-components-manager.service','commitId','toString','componentId','recordTypes','send','manifests','\x20requests\x20to\x20composite\x20api.','extractComponentIdsFromGraphsResponse','../errors/salesforce.error','SalesforceError','length','proceedCommitsToBranch','find','691425wrfEEE','../../../constants','insert','author','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','reference','SalesforceComponentsManager','graph','313980SZMHqP','stringify','../utils/composite.utils','4873JNHJgQ','name','proceedCommitsToRepository','chunkArray','repositoryId','componentsToUpdate','SalesforceCommitsManager','toJSON','defineProperty','inserted','componentsToDelete','__importDefault','constructor','SalesforceGitSyncService','../../../core','get','search','composite','359848Daohnh','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','splice','Logger','./salesforce-git-sync.service','log','gitSync','37408vRuinG','140ndvXgK','getProceededComponentsMeta','562421IygPXt','24BcaGKg','executeGraphs','234dVtaVz','proceededComponentsMeta','options','reduce','typedi','map','branchId','modified','42252YSSwjZ','push','SalesforceCompositeService','6ScwXLD','sfLogger','COMPONENTS_PER_CHUNK','removed','proceedRequests','1063410lGekmu','error','proceedCommits','logger'];a127_0x2e72=function(){return _0xeb5c4f;};return a127_0x2e72();}(function(_0x5ece38,_0x33724c){const _0x184912=a127_0x59b2,_0x3bc314=_0x5ece38();while(!![]){try{const _0x175507=-parseInt(_0x184912(0x217))/0x1+-parseInt(_0x184912(0x22a))/0x2+-parseInt(_0x184912(0x218))/0x3*(parseInt(_0x184912(0x20d))/0x4)+parseInt(_0x184912(0x1f0))/0x5*(-parseInt(_0x184912(0x225))/0x6)+parseInt(_0x184912(0x215))/0x7*(parseInt(_0x184912(0x214))/0x8)+-parseInt(_0x184912(0x21a))/0x9*(-parseInt(_0x184912(0x1f8))/0xa)+parseInt(_0x184912(0x1fb))/0xb*(parseInt(_0x184912(0x222))/0xc);if(_0x175507===_0x33724c)break;else _0x3bc314['push'](_0x3bc314['shift']());}catch(_0x237a43){_0x3bc314['push'](_0x3bc314['shift']());}}}(a127_0x2e72,0x7e5bc));const a127_0x115e5d=(function(){let _0x18f350=!![];return function(_0x4b9db1,_0x5b9a24){const _0x2c2dda=_0x18f350?function(){if(_0x5b9a24){const _0x2b32d=_0x5b9a24['apply'](_0x4b9db1,arguments);return _0x5b9a24=null,_0x2b32d;}}:function(){};return _0x18f350=![],_0x2c2dda;};}()),a127_0x29fb9a=a127_0x115e5d(this,function(){const _0x386fef=a127_0x59b2;return a127_0x29fb9a[_0x386fef(0x230)]()[_0x386fef(0x20b)]('(((.+)+)+)+$')['toString']()[_0x386fef(0x207)](a127_0x29fb9a)[_0x386fef(0x20b)]('(((.+)+)+)+$');});a127_0x29fb9a();'use strict';var __importDefault=this&&this[a127_0x55d2e6(0x206)]||function(_0x83fc07){return _0x83fc07&&_0x83fc07['__esModule']?_0x83fc07:{'default':_0x83fc07};};Object[a127_0x55d2e6(0x203)](exports,'__esModule',{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;function a127_0x59b2(_0x1e9178,_0x494913){const _0x6d6b79=a127_0x2e72();return a127_0x59b2=function(_0x29fb9a,_0x115e5d){_0x29fb9a=_0x29fb9a-0x1e8;let _0x2e720c=_0x6d6b79[_0x29fb9a];return _0x2e720c;},a127_0x59b2(_0x1e9178,_0x494913);}const core_1=require(a127_0x55d2e6(0x209)),typedi_1=__importDefault(require(a127_0x55d2e6(0x21e))),constants_1=require(a127_0x55d2e6(0x1f1)),utils_1=require('../../shared/utils'),salesforce_error_1=require(a127_0x55d2e6(0x1eb)),composite_utils_1=require(a127_0x55d2e6(0x1fa)),salesforce_components_manager_service_1=require(a127_0x55d2e6(0x22e)),salesforce_composite_service_1=require('./salesforce-composite.service'),salesforce_git_sync_service_1=require(a127_0x55d2e6(0x211));class SalesforceCommitsManager{constructor(_0x12fdb0){const _0x2c04ae=a127_0x55d2e6;this['options']=_0x12fdb0,this[_0x2c04ae(0x227)]=0x3,this[_0x2c04ae(0x22d)]=new core_1[(_0x2c04ae(0x210))](SalesforceCommitsManager[_0x2c04ae(0x1fc)]),this[_0x2c04ae(0x226)]=this['options']['logger'],this[_0x2c04ae(0x20c)]=typedi_1['default'][_0x2c04ae(0x20a)](salesforce_composite_service_1[_0x2c04ae(0x224)]),this[_0x2c04ae(0x213)]=typedi_1['default']['get'](salesforce_git_sync_service_1[_0x2c04ae(0x208)]),this[_0x2c04ae(0x21b)]=[];}async[a127_0x55d2e6(0x229)](_0x29a8c6,_0x4b2af8=![]){const _0x476346=a127_0x55d2e6,_0x269f03=(this[_0x476346(0x227)]+ +_0x4b2af8)*0x3,_0x102e01=utils_1[_0x476346(0x1fe)](_0x29a8c6,_0x269f03);try{while(_0x102e01[_0x476346(0x1ed)]){const _0x49e373=_0x102e01[_0x476346(0x20f)](0x0,Math['floor'](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x269f03));await this[_0x476346(0x226)]['log']('[INFO]\x20Sending\x20'+_0x49e373[_0x476346(0x1ed)]*_0x269f03+_0x476346(0x1e9))[_0x476346(0x233)]();const _0x140482=_0x49e373[_0x476346(0x21f)]((_0x739b57,_0xd81b4e)=>({'graphId':_0x476346(0x1f7)+_0xd81b4e,'compositeRequest':_0x739b57})),_0x3280c9=await this[_0x476346(0x20c)][_0x476346(0x219)](_0x140482);if(_0x4b2af8){const _0x506497=composite_utils_1[_0x476346(0x1ea)](_0x3280c9);for(const {id:_0xa271df,ref:_0x45224c}of _0x506497){const _0x48d530=this['proceededComponentsMeta'][_0x476346(0x1ef)](_0x4788cf=>_0x4788cf[_0x476346(0x1f5)]===_0x45224c);_0x48d530&&(_0x48d530[_0x476346(0x231)]=_0xa271df);}}}}catch(_0x382e46){this['logger'][_0x476346(0x22b)](_0x382e46 instanceof salesforce_error_1[_0x476346(0x1ec)]?JSON[_0x476346(0x1f9)](_0x382e46['toJSON'](),null,0x2):_0x382e46),this['sfLogger']['log'](_0x382e46 instanceof salesforce_error_1[_0x476346(0x1ec)]?JSON[_0x476346(0x1f9)](_0x382e46[_0x476346(0x202)](),null,0x2):_0x382e46['toString']());throw _0x382e46;}}async[a127_0x55d2e6(0x1fd)](_0x4ec787){const _0x36674b=a127_0x55d2e6;for(const _0x588179 of _0x4ec787){if(!_0x588179['inserted'][_0x36674b(0x1ed)]&&!_0x588179['modified'][_0x36674b(0x1ed)]&&!_0x588179[_0x36674b(0x228)]['length'])continue;const _0x365122=[],_0x11774c=[],_0x101e3f=new salesforce_components_manager_service_1[(_0x36674b(0x1f6))](this[_0x36674b(0x21c)]['repositoryId'],this[_0x36674b(0x21c)]['branchId'],_0x588179['author'],this[_0x36674b(0x21c)]['recordTypes'],this[_0x36674b(0x21b)]);_0x365122[_0x36674b(0x223)](...await _0x101e3f[_0x36674b(0x1f2)](_0x588179[_0x36674b(0x204)],this[_0x36674b(0x21c)]['commitId'])),_0x365122[_0x36674b(0x223)](...await _0x101e3f['update'](_0x588179[_0x36674b(0x221)],this[_0x36674b(0x21c)][_0x36674b(0x22f)])),_0x11774c[_0x36674b(0x223)](await _0x101e3f['delete'](_0x588179[_0x36674b(0x228)],!![])),this[_0x36674b(0x21b)]=_0x101e3f[_0x36674b(0x216)](),await this[_0x36674b(0x229)](_0x365122,!![]);for(const _0x2c3697 of _0x11774c){_0x2c3697[_0x36674b(0x1e8)][_0x36674b(0x1ed)]&&await this['proceedRequests'](_0x2c3697[_0x36674b(0x1e8)],!![]),_0x2c3697[_0x36674b(0x200)]['length']&&await this[_0x36674b(0x229)](_0x2c3697[_0x36674b(0x200)],!![]),_0x2c3697[_0x36674b(0x205)][_0x36674b(0x1ed)]&&await this[_0x36674b(0x229)](_0x2c3697[_0x36674b(0x205)],!![]);}this[_0x36674b(0x22d)][_0x36674b(0x212)](_0x36674b(0x20e),_0x365122[_0x36674b(0x1ed)]);}}async[a127_0x55d2e6(0x1ee)](_0x5bd6aa){const _0x10e2a6=a127_0x55d2e6,_0x32600c=[],_0x27bc07=[];for(const _0x335daa of _0x5bd6aa){if(!_0x335daa[_0x10e2a6(0x204)][_0x10e2a6(0x1ed)]&&!_0x335daa[_0x10e2a6(0x221)][_0x10e2a6(0x1ed)]&&!_0x335daa[_0x10e2a6(0x228)][_0x10e2a6(0x1ed)])continue;const _0x2cb128=new salesforce_components_manager_service_1[(_0x10e2a6(0x1f6))](this['options'][_0x10e2a6(0x1ff)],this[_0x10e2a6(0x21c)]['branchId'],_0x335daa[_0x10e2a6(0x1f3)],this[_0x10e2a6(0x21c)][_0x10e2a6(0x232)],[]);_0x32600c[_0x10e2a6(0x223)](...await _0x2cb128[_0x10e2a6(0x1f2)](_0x335daa[_0x10e2a6(0x204)])),_0x32600c['push'](...await _0x2cb128['update'](_0x335daa[_0x10e2a6(0x221)])),_0x27bc07['push'](await _0x2cb128['delete'](_0x335daa[_0x10e2a6(0x228)]));}this[_0x10e2a6(0x22d)]['log'](_0x10e2a6(0x1f4),_0x32600c['length']),await this[_0x10e2a6(0x229)](_0x32600c);const _0x32c0a4=_0x27bc07[_0x10e2a6(0x21d)]((_0x225b41,_0xe375d5)=>({'manifests':[..._0x225b41[_0x10e2a6(0x1e8)],..._0xe375d5[_0x10e2a6(0x1e8)]],'componentsToDelete':[..._0x225b41[_0x10e2a6(0x205)],..._0xe375d5[_0x10e2a6(0x205)]],'componentsToUpdate':[..._0x225b41[_0x10e2a6(0x200)],..._0xe375d5[_0x10e2a6(0x200)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x32c0a4[_0x10e2a6(0x1e8)]['length']&&await this[_0x10e2a6(0x229)](_0x32c0a4[_0x10e2a6(0x1e8)],!![]),_0x32c0a4['componentsToUpdate']['length']&&await this[_0x10e2a6(0x229)](_0x32c0a4[_0x10e2a6(0x200)],!![]),_0x32c0a4[_0x10e2a6(0x205)][_0x10e2a6(0x1ed)]&&await this['proceedRequests'](_0x32c0a4[_0x10e2a6(0x205)],!![]);}async[a127_0x55d2e6(0x22c)](_0x925525){const _0x3290b1=a127_0x55d2e6;this[_0x3290b1(0x21c)][_0x3290b1(0x220)]?await this[_0x3290b1(0x1ee)](_0x925525):await this[_0x3290b1(0x1fd)](_0x925525);}}exports[a127_0x55d2e6(0x201)]=SalesforceCommitsManager;