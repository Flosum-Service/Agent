const a187_0x308723=a187_0x85fa;(function(_0x4dee47,_0x2d2fed){const _0x744be1=a187_0x85fa,_0x5be059=_0x4dee47();while(!![]){try{const _0x476fbc=-parseInt(_0x744be1(0x1c1))/0x1+-parseInt(_0x744be1(0x1c2))/0x2*(-parseInt(_0x744be1(0x1f9))/0x3)+parseInt(_0x744be1(0x1aa))/0x4*(-parseInt(_0x744be1(0x1e2))/0x5)+-parseInt(_0x744be1(0x1cd))/0x6+-parseInt(_0x744be1(0x1e0))/0x7+parseInt(_0x744be1(0x1bc))/0x8+-parseInt(_0x744be1(0x1d8))/0x9*(-parseInt(_0x744be1(0x1e5))/0xa);if(_0x476fbc===_0x2d2fed)break;else _0x5be059['push'](_0x5be059['shift']());}catch(_0x185a3a){_0x5be059['push'](_0x5be059['shift']());}}}(a187_0xd376,0x69d3c));const a187_0x1a5bd2=(function(){let _0x88e864=!![];return function(_0x1e0815,_0xc258b1){const _0x5d0f08=_0x88e864?function(){const _0x2f4328=a187_0x85fa;if(_0xc258b1){const _0x241524=_0xc258b1[_0x2f4328(0x1da)](_0x1e0815,arguments);return _0xc258b1=null,_0x241524;}}:function(){};return _0x88e864=![],_0x5d0f08;};}()),a187_0x464298=a187_0x1a5bd2(this,function(){const _0x3a95f1=a187_0x85fa;return a187_0x464298[_0x3a95f1(0x1bd)]()[_0x3a95f1(0x1d9)]('(((.+)+)+)+$')[_0x3a95f1(0x1bd)]()['constructor'](a187_0x464298)[_0x3a95f1(0x1d9)](_0x3a95f1(0x1f2));});a187_0x464298();function a187_0x85fa(_0x1d2d3d,_0x332b32){const _0x53f82b=a187_0xd376();return a187_0x85fa=function(_0x464298,_0x1a5bd2){_0x464298=_0x464298-0x1aa;let _0xd37610=_0x53f82b[_0x464298];return _0xd37610;},a187_0x85fa(_0x1d2d3d,_0x332b32);}'use strict';var __decorate=this&&this[a187_0x308723(0x1fb)]||function(_0x145eb7,_0x320c77,_0x586dd9,_0x545cb2){const _0x549b7f=a187_0x308723;var _0x57f3fe=arguments[_0x549b7f(0x1b0)],_0x4146c8=_0x57f3fe<0x3?_0x320c77:_0x545cb2===null?_0x545cb2=Object['getOwnPropertyDescriptor'](_0x320c77,_0x586dd9):_0x545cb2,_0xd83de8;if(typeof Reflect===_0x549b7f(0x1be)&&typeof Reflect[_0x549b7f(0x1ce)]===_0x549b7f(0x1b9))_0x4146c8=Reflect[_0x549b7f(0x1ce)](_0x145eb7,_0x320c77,_0x586dd9,_0x545cb2);else{for(var _0x32d74c=_0x145eb7[_0x549b7f(0x1b0)]-0x1;_0x32d74c>=0x0;_0x32d74c--)if(_0xd83de8=_0x145eb7[_0x32d74c])_0x4146c8=(_0x57f3fe<0x3?_0xd83de8(_0x4146c8):_0x57f3fe>0x3?_0xd83de8(_0x320c77,_0x586dd9,_0x4146c8):_0xd83de8(_0x320c77,_0x586dd9))||_0x4146c8;}return _0x57f3fe>0x3&&_0x4146c8&&Object['defineProperty'](_0x320c77,_0x586dd9,_0x4146c8),_0x4146c8;},__metadata=this&&this[a187_0x308723(0x1bf)]||function(_0x3f6140,_0x3ad5bf){const _0x13e3a0=a187_0x308723;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x13e3a0(0x1b9))return Reflect['metadata'](_0x3f6140,_0x3ad5bf);};function a187_0xd376(){const _0x19ec4f=['fetchBranchComponentsByFilenames','patch','typedi','FLOSUM_REPOSITORY','repositoryGit','getBranchId','FLOSUM_GIT_NAMESPACE','salesforceGitSync','salesforceRest','fileNames','string','(((.+)+)+)+$','gitCommit','filter','componentsMetadata','../../salesforce/services/salesforce-git-sync.service','type','FLOSUM_NAMESPACE','410898WFbgJi','getRemoteStateAttachmentId','__decorate','getBranchRecordByName','includes','branch','668EvbWUX','getRecordTypes','fetchBranchComponents','../../salesforce/services/salesforce-sync.service','push','../../parsers/mdapi/parser','length','then','fetchComponentsMetadata','map','GitCommitService','repositoryId','fileName','getRepositoryId','TASKS_PER_TICK','function','syncRecord','getRepositoryRecordByName','679600UaRUAx','toString','object','__metadata','fetchRepositoryOrBranchData','4907TBIKOd','4SPcZpG','proceedFile','__esModule','crc32','now','isPathsEquals','salesforceSync','fetchRepositoryComponents','Last_Updated_On__c','getComponentRecordTypes','../../salesforce/services/salesforce-rest.service','5196630KMqbNa','decorate','find','createCommit','defineProperty','name','SalesforceRestService','Synchronization_Status__c','updateRemoteState','MDApiParser','design:paramtypes','5922KduMrW','search','apply','parse','FLOSUM_BRANCH','catch','recordTypes','Service','102648LDsmnF','branchId','12680idyjNj','filePath','../../salesforce/services/salesforce.service','21030kCCBdm','SalesforceService'];a187_0xd376=function(){return _0x19ec4f;};return a187_0xd376();}Object[a187_0x308723(0x1d1)](exports,a187_0x308723(0x1c4),{'value':!![]}),exports[a187_0x308723(0x1b4)]=void 0x0;const constants_1=require('../../../constants'),parser_1=require(a187_0x308723(0x1af)),salesforce_git_sync_service_1=require(a187_0x308723(0x1f6)),salesforce_rest_service_1=require(a187_0x308723(0x1cc)),typedi_1=require(a187_0x308723(0x1e9)),salesforce_sync_service_1=require(a187_0x308723(0x1ad)),salesforce_service_1=require(a187_0x308723(0x1e4)),git_commit_utils_1=require('../utils/git-commit.utils');let GitCommitService=class GitCommitService{constructor(_0x28d488,_0x36f574,_0x883a1b,_0x429659){const _0x2a9860=a187_0x308723;this['salesforceGitSync']=_0x28d488,this['salesforceRest']=_0x36f574,this[_0x2a9860(0x1c8)]=_0x883a1b,this['salesforce']=_0x429659,this[_0x2a9860(0x1b8)]=0xc8;}get[a187_0x308723(0x1b5)](){const _0xcecf54=a187_0x308723;var _0x46501d;return((_0x46501d=this[_0xcecf54(0x1ba)])===null||_0x46501d===void 0x0?void 0x0:_0x46501d[_0xcecf54(0x1b5)])||'';}get[a187_0x308723(0x1e1)](){const _0x775088=a187_0x308723;var _0x2ef9f6;return((_0x2ef9f6=this[_0x775088(0x1ba)])===null||_0x2ef9f6===void 0x0?void 0x0:_0x2ef9f6[_0x775088(0x1e1)])||'';}async[a187_0x308723(0x1d0)](_0x26d939){const _0x133e6c=a187_0x308723;return this[_0x133e6c(0x1ee)]['createCommit'](_0x26d939,this['repositoryId']);}async['checkSyncStatus'](_0x19f841){const _0x525c63=a187_0x308723;if(this[_0x525c63(0x1ba)]){const _0x2a22cc=await this['salesforceSync'][_0x525c63(0x1fa)](this[_0x525c63(0x1ba)]),_0x470235=await this['salesforce']['retrieveAttachment'](_0x2a22cc)[_0x525c63(0x1b1)](_0x137411=>typeof _0x137411===_0x525c63(0x1f1)?JSON[_0x525c63(0x1db)](_0x137411):_0x137411)[_0x525c63(0x1dd)](()=>({}));if(_0x470235[this[_0x525c63(0x1f3)][_0x525c63(0x1eb)]]){if(_0x470235[this[_0x525c63(0x1f3)][_0x525c63(0x1eb)]]['lastCommit']===_0x19f841)return!![];}return![];}return![];}async[a187_0x308723(0x1d5)](_0x3908a2){const _0x3c29f2=a187_0x308723;this['syncRecord']&&await this[_0x3c29f2(0x1c8)][_0x3c29f2(0x1d5)](this[_0x3c29f2(0x1ba)],_0x3908a2);}async[a187_0x308723(0x1c3)](_0x40bf18,_0x17d5c1,_0x202889){const _0x429305=a187_0x308723,_0x5428f3=this['componentsMetadata']['filter'](_0x3b4c2a=>git_commit_utils_1[_0x429305(0x1c7)](_0x3b4c2a[_0x429305(0x1b6)],_0x40bf18)),_0x503fc2=[],_0x1f2263=[],_0x3a8265=[],_0x1b1b7b=new parser_1[(_0x429305(0x1d6))](_0x17d5c1,[_0x40bf18],_0x202889),_0x4b04f8=await _0x1b1b7b[_0x429305(0x1db)](),_0x28f7c3=_0x4b04f8[_0x429305(0x1b3)](_0x1cd3ce=>{const _0x596da2=_0x429305,_0xf6ee3b=_0x5428f3[_0x596da2(0x1cf)](_0x508d89=>_0x508d89[_0x596da2(0x1d2)]===_0x1cd3ce[_0x596da2(0x1d2)]&&_0x508d89['type']===_0x1cd3ce[_0x596da2(0x1f7)]);if(!_0xf6ee3b){const _0x101b2c={'crc32':_0x1cd3ce['crc'],'fileName':_0x1cd3ce[_0x596da2(0x1e3)],'id':null,'version':0x1,'name':_0x1cd3ce['name'],'type':_0x1cd3ce[_0x596da2(0x1f7)]};return this[_0x596da2(0x1f5)][_0x596da2(0x1ae)](_0x101b2c),_0x5428f3['push'](_0x101b2c),_0x3a8265[_0x596da2(0x1ae)](_0x101b2c),_0x1f2263[_0x596da2(0x1ae)](_0x1cd3ce),null;}_0x3a8265[_0x596da2(0x1ae)](_0xf6ee3b);if(_0x1cd3ce['crc']===_0xf6ee3b[_0x596da2(0x1c5)])return null;return{'component':_0x1cd3ce,'meta':_0xf6ee3b};})[_0x429305(0x1f4)](_0x5c4307=>!!_0x5c4307);_0x503fc2[_0x429305(0x1ae)](..._0x28f7c3);const _0x579334=_0x5428f3['filter'](_0x90bcc6=>!_0x3a8265['includes'](_0x90bcc6));return this[_0x429305(0x1f5)]=this[_0x429305(0x1f5)]['filter'](_0x4e6b95=>!_0x579334[_0x429305(0x1fd)](_0x4e6b95)),{'inserted':_0x1f2263,'modified':_0x503fc2,'removed':_0x579334['map'](({id:_0x51e6ba,name:_0x362b0f,type:_0x1cf3d1})=>({'id':_0x51e6ba,'name':_0x362b0f,'type':_0x1cf3d1}))};}async[a187_0x308723(0x1c0)](){const _0x4794e3=a187_0x308723;this['syncRecord']=this[_0x4794e3(0x1f3)]['branch']==='master'?await this[_0x4794e3(0x1c8)][_0x4794e3(0x1bb)](this[_0x4794e3(0x1f3)]['repository']):await this[_0x4794e3(0x1c8)][_0x4794e3(0x1fc)](this[_0x4794e3(0x1f3)][_0x4794e3(0x1fe)]),this[_0x4794e3(0x1de)]=await this[_0x4794e3(0x1ee)][_0x4794e3(0x1cb)]();}async[a187_0x308723(0x1b2)](_0x380221){const _0x2325af=a187_0x308723,_0x3b0e3c=[...this[_0x2325af(0x1f3)][_0x2325af(0x1f0)]];if(this[_0x2325af(0x1f3)]['force']||_0x380221){this['componentsMetadata']=this[_0x2325af(0x1e1)]?await this['salesforceGitSync'][_0x2325af(0x1ac)](this['branchId']):await this[_0x2325af(0x1ee)][_0x2325af(0x1c9)](this[_0x2325af(0x1b5)]);return;}this[_0x2325af(0x1f5)]=[];while(_0x3b0e3c[_0x2325af(0x1b0)]){const _0xcff6ec=_0x3b0e3c['splice'](0x0,this['TASKS_PER_TICK']),_0x305e9c=this['branchId']?await this[_0x2325af(0x1ee)][_0x2325af(0x1e7)](_0xcff6ec,this[_0x2325af(0x1e1)]):await this[_0x2325af(0x1ee)]['fetchRepositoryComponentsByFilenames'](_0xcff6ec,this[_0x2325af(0x1b5)]);this[_0x2325af(0x1f5)][_0x2325af(0x1ae)](..._0x305e9c);}}async['updateStatus'](_0xd4f6d8){const _0x5453d3=a187_0x308723;this[_0x5453d3(0x1e1)]?await this['salesforceRest']['patch'](constants_1[_0x5453d3(0x1dc)],this['branchId'],{[constants_1['FLOSUM_GIT_NAMESPACE']+'Synchronization_Status__c']:_0xd4f6d8,[constants_1[_0x5453d3(0x1f8)]+_0x5453d3(0x1ca)]:Date[_0x5453d3(0x1c6)]()}):await this[_0x5453d3(0x1ef)][_0x5453d3(0x1e8)](constants_1[_0x5453d3(0x1ea)],this[_0x5453d3(0x1b5)],{[constants_1[_0x5453d3(0x1ed)]+_0x5453d3(0x1d4)]:_0xd4f6d8});}['setCommitDto'](_0x41e340){const _0x3b6bcf=a187_0x308723;this[_0x3b6bcf(0x1f3)]=_0x41e340;}[a187_0x308723(0x1ab)](){const _0xd493f8=a187_0x308723;return this[_0xd493f8(0x1de)];}[a187_0x308723(0x1b7)](){const _0x3e0b54=a187_0x308723;return this[_0x3e0b54(0x1b5)];}[a187_0x308723(0x1ec)](){return this['branchId'];}};GitCommitService=__decorate([typedi_1[a187_0x308723(0x1df)]({'transient':!![]}),__metadata(a187_0x308723(0x1d7),[salesforce_git_sync_service_1['SalesforceGitSyncService'],salesforce_rest_service_1[a187_0x308723(0x1d3)],salesforce_sync_service_1['SalesforceSyncService'],salesforce_service_1[a187_0x308723(0x1e6)]])],GitCommitService),exports['GitCommitService']=GitCommitService;