const a188_0x7a47a1=a188_0x59c8;(function(_0x563c89,_0x3d6702){const _0x5cc8ff=a188_0x59c8,_0x2c0656=_0x563c89();while(!![]){try{const _0x5e9326=-parseInt(_0x5cc8ff(0x1ac))/0x1*(parseInt(_0x5cc8ff(0x16a))/0x2)+-parseInt(_0x5cc8ff(0x1ca))/0x3*(parseInt(_0x5cc8ff(0x1a2))/0x4)+parseInt(_0x5cc8ff(0x1d4))/0x5+parseInt(_0x5cc8ff(0x1ba))/0x6+parseInt(_0x5cc8ff(0x19a))/0x7*(-parseInt(_0x5cc8ff(0x1d0))/0x8)+parseInt(_0x5cc8ff(0x1da))/0x9*(-parseInt(_0x5cc8ff(0x1a5))/0xa)+parseInt(_0x5cc8ff(0x1b3))/0xb;if(_0x5e9326===_0x3d6702)break;else _0x2c0656['push'](_0x2c0656['shift']());}catch(_0x3f96cc){_0x2c0656['push'](_0x2c0656['shift']());}}}(a188_0x3f5e,0xa3b24));function a188_0x3f5e(){const _0x327b41=['HooksUtils','salesforceSync','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','convertToSFDX','\x27\x20in\x20repository\x20\x27','2jIYdnO','gitManager','find','log','hooks','constructor','../../../constants','20309300QOHliV','gitUrl','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','__esModule','apply','getBranchRecords','../jobs/flosum-sync.job','4614198jBjveP','name','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','SyncService','checkValidNaming','isIntersects','GitProviderManager','__metadata','test','[INFO]\x20Start\x20sync\x20job','repoService','handleRecordSyncError','prototype','have\x20to\x20synchronize\x20%d\x20branches','SalesforceError','getRepositoryRecords','2340mVLcUA','SalesforceLogger2','setLoggerId','default','repositoryName','Logger','88nOPbYq','getOwnPropertyDescriptor','getAll',']\x20[','4712535bHIjBq','__setModuleDefault','../../salesforce/services/salesforce-sync.service','TooManyRequests','SyncDirection','toLowerCase','1732491sjcHKD','../../shared/git-provider.manager','getOrCreateRepo','create','../../salesforce/services/salesforce-logger-v2.service','search','toString','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','function','(((.+)+)+)+$','233052WHDRcq','repoList','../../shared/utils','disableSync','decorate','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','logger','\x27\x20[','[INFO]\x20Sync\x20job\x20done.','metadata','hasOwnProperty','FlosumSyncJob','\x27\x20-\x20\x27','defineProperty','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','push','send','../../hooks/hooks.utils','FlosumToGit','repositoryId','../../../core/errors/too-many-requests.error','call','branchId','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','sleep','syncDto','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','createHooks','../../salesforce/errors/salesforce.error','toUpperCase','branchName','__importStar','object','salesforceService','Not\x20Synchronized','getRepoService','setStatus','../../salesforce/dto/flosum-repository-sync.dto','__createBinding','getHookLinkFor','GitSyncJob','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','../../../core','createHookPayload','Service','get','direction','813113KzYtee','run','catch','length','sfLogger','Error','[INFO]\x20Repository\x20\x22','Unable\x20to\x20synchronize\x20repository\x20\x27','6072mUphyN','repositoriesIntersections','SalesforceService','10LOUHrb','all'];a188_0x3f5e=function(){return _0x327b41;};return a188_0x3f5e();}const a188_0x29e43f=(function(){let _0x345776=!![];return function(_0x1e9221,_0x55ef5b){const _0x4fb244=_0x345776?function(){const _0x401ba8=a188_0x59c8;if(_0x55ef5b){const _0x59f26e=_0x55ef5b[_0x401ba8(0x1b7)](_0x1e9221,arguments);return _0x55ef5b=null,_0x59f26e;}}:function(){};return _0x345776=![],_0x4fb244;};}()),a188_0x2e7bb5=a188_0x29e43f(this,function(){const _0x2ca1c3=a188_0x59c8;return a188_0x2e7bb5[_0x2ca1c3(0x166)]()[_0x2ca1c3(0x165)](_0x2ca1c3(0x169))[_0x2ca1c3(0x166)]()[_0x2ca1c3(0x1b1)](a188_0x2e7bb5)[_0x2ca1c3(0x165)]('(((.+)+)+)+$');});a188_0x2e7bb5();'use strict';var __createBinding=this&&this[a188_0x7a47a1(0x190)]||(Object[a188_0x7a47a1(0x1dd)]?function(_0x48fee3,_0x4eaba7,_0x24e7d9,_0x2beece){const _0xe4987f=a188_0x7a47a1;if(_0x2beece===undefined)_0x2beece=_0x24e7d9;Object[_0xe4987f(0x177)](_0x48fee3,_0x2beece,{'enumerable':!![],'get':function(){return _0x4eaba7[_0x24e7d9];}});}:function(_0x5107c7,_0x608de,_0x339536,_0x4ae393){if(_0x4ae393===undefined)_0x4ae393=_0x339536;_0x5107c7[_0x4ae393]=_0x608de[_0x339536];}),__setModuleDefault=this&&this[a188_0x7a47a1(0x1d5)]||(Object[a188_0x7a47a1(0x1dd)]?function(_0x47608a,_0x45065d){const _0x3bb819=a188_0x7a47a1;Object[_0x3bb819(0x177)](_0x47608a,_0x3bb819(0x1cd),{'enumerable':!![],'value':_0x45065d});}:function(_0x34e1fc,_0x5a590d){const _0x35ad53=a188_0x7a47a1;_0x34e1fc[_0x35ad53(0x1cd)]=_0x5a590d;}),__decorate=this&&this['__decorate']||function(_0x467d23,_0x56ae18,_0x4e54e5,_0x952530){const _0x1b4b4b=a188_0x7a47a1;var _0x5db0df=arguments[_0x1b4b4b(0x19d)],_0xaa395d=_0x5db0df<0x3?_0x56ae18:_0x952530===null?_0x952530=Object[_0x1b4b4b(0x1d1)](_0x56ae18,_0x4e54e5):_0x952530,_0x43dc24;if(typeof Reflect===_0x1b4b4b(0x18a)&&typeof Reflect[_0x1b4b4b(0x16e)]===_0x1b4b4b(0x168))_0xaa395d=Reflect['decorate'](_0x467d23,_0x56ae18,_0x4e54e5,_0x952530);else{for(var _0x25a616=_0x467d23[_0x1b4b4b(0x19d)]-0x1;_0x25a616>=0x0;_0x25a616--)if(_0x43dc24=_0x467d23[_0x25a616])_0xaa395d=(_0x5db0df<0x3?_0x43dc24(_0xaa395d):_0x5db0df>0x3?_0x43dc24(_0x56ae18,_0x4e54e5,_0xaa395d):_0x43dc24(_0x56ae18,_0x4e54e5))||_0xaa395d;}return _0x5db0df>0x3&&_0xaa395d&&Object[_0x1b4b4b(0x177)](_0x56ae18,_0x4e54e5,_0xaa395d),_0xaa395d;},__importStar=this&&this[a188_0x7a47a1(0x189)]||function(_0x54e7cd){const _0x27bb08=a188_0x7a47a1;if(_0x54e7cd&&_0x54e7cd[_0x27bb08(0x1b6)])return _0x54e7cd;var _0x5bcb5a={};if(_0x54e7cd!=null){for(var _0x36720c in _0x54e7cd)if(_0x36720c!==_0x27bb08(0x1cd)&&Object[_0x27bb08(0x1c6)][_0x27bb08(0x174)][_0x27bb08(0x17f)](_0x54e7cd,_0x36720c))__createBinding(_0x5bcb5a,_0x54e7cd,_0x36720c);}return __setModuleDefault(_0x5bcb5a,_0x54e7cd),_0x5bcb5a;},__metadata=this&&this[a188_0x7a47a1(0x1c1)]||function(_0x41ba61,_0xc725be){const _0x29b244=a188_0x7a47a1;if(typeof Reflect===_0x29b244(0x18a)&&typeof Reflect[_0x29b244(0x173)]==='function')return Reflect[_0x29b244(0x173)](_0x41ba61,_0xc725be);},SyncService_1;Object[a188_0x7a47a1(0x177)](exports,'__esModule',{'value':!![]}),exports[a188_0x7a47a1(0x1bd)]=void 0x0;const constants_1=require(a188_0x7a47a1(0x1b2)),core_1=require(a188_0x7a47a1(0x195)),too_many_requests_error_1=require(a188_0x7a47a1(0x17e)),flosum_repository_sync_dto_1=require(a188_0x7a47a1(0x18f)),salesforce_error_1=require(a188_0x7a47a1(0x186)),salesforce_logger_v2_service_1=require(a188_0x7a47a1(0x1de)),salesforce_sync_service_1=require(a188_0x7a47a1(0x1d6)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a188_0x7a47a1(0x1db)),utils_1=require(a188_0x7a47a1(0x16c)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a188_0x7a47a1(0x17b)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require(a188_0x7a47a1(0x1b9)),git_sync_job_1=require('../jobs/git-sync.job');let SyncService=SyncService_1=class SyncService{constructor(_0x2f046a,_0x5293a1,_0x47deae){const _0x267387=a188_0x7a47a1;this[_0x267387(0x18b)]=_0x2f046a,this['salesforceSync']=_0x5293a1,this[_0x267387(0x1ad)]=_0x47deae,this[_0x267387(0x170)]=new core_1[(_0x267387(0x1cf))](SyncService_1[_0x267387(0x1bb)]),this[_0x267387(0x1a3)]={},this[_0x267387(0x16b)]=[];}async[a188_0x7a47a1(0x1c5)](_0x110597,_0x242004){const _0x58a1b9=a188_0x7a47a1;if(_0x242004 instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this[_0x58a1b9(0x1a8)][_0x58a1b9(0x18e)](_0x110597,_0x58a1b9(0x18c));return;}if(_0x242004 instanceof too_many_requests_error_1[_0x58a1b9(0x1d7)]){await this[_0x58a1b9(0x1a8)]['setStatus'](_0x110597,'Waiting');throw _0x242004;}try{await this[_0x58a1b9(0x19e)][_0x58a1b9(0x1af)](_0x58a1b9(0x16f)+_0x110597['repositoryName']+_0x58a1b9(0x171)+_0x110597['branchName']+']\x20due\x20error\x20-\x20'+_0x242004)[_0x58a1b9(0x17a)](),await this[_0x58a1b9(0x1a8)]['updateRemoteState'](_0x110597,{}),await this['salesforceSync'][_0x58a1b9(0x18e)](_0x110597,_0x58a1b9(0x19f));}catch(_0x4b2c33){if(_0x4b2c33 instanceof salesforce_error_1[_0x58a1b9(0x1c8)])throw _0x4b2c33;}}async[a188_0x7a47a1(0x1bf)](_0x1a7331){const _0x18d4c7=a188_0x7a47a1;if(_0x1a7331['repositoryId']){const _0x5a5416=_0x1a7331['repositoryName'][_0x18d4c7(0x1d9)](),_0xf45e5c=this['repositoriesIntersections'][_0x5a5416];if(!_0xf45e5c)this['repositoriesIntersections'][_0x5a5416]=_0x1a7331[_0x18d4c7(0x1ce)];else{if(_0xf45e5c&&_0xf45e5c!==_0x1a7331[_0x18d4c7(0x1ce)])return await this[_0x18d4c7(0x1c5)](_0x1a7331,new Error(_0x18d4c7(0x1a1)+_0x1a7331[_0x18d4c7(0x1ce)]+_0x18d4c7(0x1a9)+_0x5a5416+_0x18d4c7(0x176)+_0xf45e5c+'\x27')),!![];}}return![];}async[a188_0x7a47a1(0x1be)](_0x158a92){const _0x12ce3d=a188_0x7a47a1;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x12ce3d(0x1c2)](_0x158a92[_0x12ce3d(0x1ce)]))return await this[_0x12ce3d(0x1c5)](_0x158a92,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x158a92[_0x12ce3d(0x1ce)]+_0x12ce3d(0x178))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x12ce3d(0x1c2)](_0x158a92[_0x12ce3d(0x188)]))return await this['handleRecordSyncError'](_0x158a92,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x158a92['branchName']+_0x12ce3d(0x1ab)+_0x158a92[_0x12ce3d(0x1ce)]+_0x12ce3d(0x184))),![];return!![];}async[a188_0x7a47a1(0x1dc)](_0x561d12,_0x503293,_0x182f7c){const _0xebff23=a188_0x7a47a1;let _0x1789d4=this['repoList'][_0xebff23(0x1ae)](_0x5a1e52=>_0x561d12[_0xebff23(0x1ce)]===_0x5a1e52[_0xebff23(0x1bb)]);!_0x1789d4&&(this[_0xebff23(0x19e)][_0xebff23(0x1af)](_0xebff23(0x1a0)+_0x561d12[_0xebff23(0x1ce)]+_0xebff23(0x167)),_0x1789d4=await this[_0xebff23(0x1c4)][_0xebff23(0x1dd)]({'name':_0x561d12[_0xebff23(0x1ce)],'autoInit':!![],'defaultBranch':_0x561d12[_0xebff23(0x188)],'private':!![],'createHook':this[_0xebff23(0x183)][_0xebff23(0x185)]}));if(this[_0xebff23(0x183)][_0xebff23(0x185)]){const _0x38f026=await _0x1789d4[_0xebff23(0x1b0)][_0xebff23(0x1d2)]();!_0x38f026['find'](_0x4a4781=>_0x4a4781['url']===hooks_utils_1[_0xebff23(0x1a7)][_0xebff23(0x191)](_0x503293,_0x182f7c))&&(this[_0xebff23(0x19e)][_0xebff23(0x1af)]('[INFO]\x20Repository\x20\x22'+_0x561d12['repositoryName']+_0xebff23(0x181)),await _0x1789d4['hooks'][_0xebff23(0x1dd)](hooks_utils_1[_0xebff23(0x1a7)][_0xebff23(0x196)](_0x503293,_0x1789d4[_0xebff23(0x1b0)],_0x182f7c)));}return this[_0xebff23(0x16b)][_0xebff23(0x179)](_0x1789d4),_0x1789d4;}async[a188_0x7a47a1(0x19b)](_0x83f4a9,_0x386d77,_0x18596d,_0x50db01){const _0x4aec1a=a188_0x7a47a1;this[_0x4aec1a(0x18b)][_0x4aec1a(0x1cc)](_0x386d77),this['repoService']=this['gitManager'][_0x4aec1a(0x18d)](_0x18596d),this[_0x4aec1a(0x19e)]=new salesforce_logger_v2_service_1[(_0x4aec1a(0x1cb))](_0x386d77,'['+SyncService_1['name']+_0x4aec1a(0x1d3)+_0x18596d[_0x4aec1a(0x187)]()+']'),this[_0x4aec1a(0x183)]=_0x83f4a9;try{await this[_0x4aec1a(0x19e)][_0x4aec1a(0x1af)](_0x4aec1a(0x1c3))[_0x4aec1a(0x17a)]();const [_0x1d00c8,_0x522fbd]=await Promise[_0x4aec1a(0x1a6)]([this[_0x4aec1a(0x1a8)][_0x4aec1a(0x1b8)](),this[_0x4aec1a(0x1a8)][_0x4aec1a(0x1c9)]()]);this[_0x4aec1a(0x16b)]=await this[_0x4aec1a(0x1c4)][_0x4aec1a(0x1d2)]();const _0x2c2a75=[..._0x522fbd,..._0x1d00c8];this[_0x4aec1a(0x170)][_0x4aec1a(0x1af)](_0x4aec1a(0x1c7),_0x2c2a75[_0x4aec1a(0x19d)]);for(const _0x448593 of _0x2c2a75){this[_0x4aec1a(0x170)][_0x4aec1a(0x1af)](_0x4aec1a(0x1b5),_0x448593[_0x4aec1a(0x1ce)],_0x448593[_0x4aec1a(0x17d)],_0x448593['branchName'],_0x448593[_0x4aec1a(0x180)]);const _0x680f76=await this['checkValidNaming'](_0x448593);if(!_0x680f76)continue;const _0x47f22e=await this['isIntersects'](_0x448593);if(_0x47f22e)continue;let _0x5538ca;try{_0x5538ca=await this[_0x4aec1a(0x1dc)](_0x448593,_0x18596d,_0x50db01);}catch(_0x2fd9c0){await this[_0x4aec1a(0x1c5)](_0x448593,_0x2fd9c0 instanceof too_many_requests_error_1[_0x4aec1a(0x1d7)]?_0x2fd9c0:new Error(_0x4aec1a(0x194)+_0x2fd9c0));continue;}await this[_0x4aec1a(0x19e)][_0x4aec1a(0x17a)]();if(_0x448593[_0x4aec1a(0x199)]===flosum_repository_sync_dto_1[_0x4aec1a(0x1d8)][_0x4aec1a(0x17c)]){const _0x547868=typedi_1[_0x4aec1a(0x1cd)][_0x4aec1a(0x198)](flosum_sync_job_1[_0x4aec1a(0x175)]);await _0x547868['run']({'repository':_0x5538ca,'convertToSFDX':_0x83f4a9[_0x4aec1a(0x1aa)],'syncRecord':_0x448593,'provider':_0x18596d,'logger':this[_0x4aec1a(0x19e)]})[_0x4aec1a(0x19c)](_0x23971b=>this['handleRecordSyncError'](_0x448593,_0x23971b));}else{const _0x26bdbb=typedi_1['default'][_0x4aec1a(0x198)](git_sync_job_1[_0x4aec1a(0x192)]);await _0x26bdbb[_0x4aec1a(0x19b)]({'repository':_0x5538ca,'branch':_0x448593[_0x4aec1a(0x188)],'provider':_0x18596d,'repositoryGit':_0x5538ca[_0x4aec1a(0x1b4)],'syncRecord':_0x448593,'logger':this[_0x4aec1a(0x19e)]})[_0x4aec1a(0x19c)](_0x2ae408=>this[_0x4aec1a(0x1c5)](_0x448593,_0x2ae408));}}}catch(_0x12728c){this[_0x4aec1a(0x170)]['error'](_0x12728c);_0x12728c instanceof too_many_requests_error_1[_0x4aec1a(0x1d7)]?(await this[_0x4aec1a(0x19e)][_0x4aec1a(0x1af)](_0x4aec1a(0x1bc))['send'](),await utils_1[_0x4aec1a(0x182)](0x3c*0x3c*0x3e8),this['run'](_0x83f4a9,_0x386d77,_0x18596d,_0x50db01)):await this[_0x4aec1a(0x19e)][_0x4aec1a(0x1af)](_0x4aec1a(0x193)+_0x12728c)['send']();return;}await this['sfLogger'][_0x4aec1a(0x1af)](_0x4aec1a(0x172))[_0x4aec1a(0x17a)](),await this[_0x4aec1a(0x1a8)][_0x4aec1a(0x16d)](_0x83f4a9['syncID'])[_0x4aec1a(0x19c)](()=>null);}};function a188_0x59c8(_0x1ae513,_0x3fac55){const _0x22e12e=a188_0x3f5e();return a188_0x59c8=function(_0x2e7bb5,_0x29e43f){_0x2e7bb5=_0x2e7bb5-0x165;let _0x3f5e33=_0x22e12e[_0x2e7bb5];return _0x3f5e33;},a188_0x59c8(_0x1ae513,_0x3fac55);}SyncService=SyncService_1=__decorate([typedi_1[a188_0x7a47a1(0x197)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a188_0x7a47a1(0x1a4)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a188_0x7a47a1(0x1c0)]])],SyncService),exports['SyncService']=SyncService;