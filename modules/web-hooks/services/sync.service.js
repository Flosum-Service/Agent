const a188_0xc73dc2=a188_0x45cb;function a188_0x1126(){const _0x96fb48=['../../salesforce/dto/flosum-repository-sync.dto','TooManyRequests','../../../core','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','10DcwCfp','__metadata','gitUrl','url','8000019XTruIb','branchName','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','hasOwnProperty','checkValidNaming','toString','__decorate','Unable\x20to\x20synchronize\x20branch\x20\x27','apply','repositoriesIntersections','run','logger','setStatus','BRANCH_NAME_REGEXP','../errors/git-branch-not-found.error','setLoggerId','decorate','../../shared/utils','../jobs/flosum-sync.job','257369rwXKaL','catch','have\x20to\x20synchronize\x20%d\x20branches','gitManager','\x27\x20-\x20\x27','FlosumSyncJob','updateRemoteState','default','metadata','3210385bywTxZ','log','send','repositoryName','1798419NeGgoP','Unable\x20to\x20synchronize\x20repository\x20\x27','__esModule','salesforceService','syncID','syncDto','name','find','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','[INFO]\x20Start\x20sync\x20job','8hrUsTw','salesforceSync','getBranchRecords','1371428rSwltS','SyncDirection','Logger','create','repoService','push','repositoryId','[INFO]\x20Sync\x20job\x20done.','call','function','HooksUtils','SalesforceSyncService','641513sZCSWm','search','getAll','sfLogger','constructor','toLowerCase','../../../constants','Not\x20Synchronized','../../salesforce/services/salesforce.service','object','toUpperCase','__createBinding','prototype','(((.+)+)+)+$','../../shared/git-provider.manager','SyncService','REPOSITORY_NAME_REGEXP','__setModuleDefault','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','all','hooks','Waiting','FlosumToGit','handleRecordSyncError','getHookLinkFor','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','getOrCreateRepo','__importStar','createHookPayload','../../salesforce/errors/salesforce.error','GitBranchNotFoundError','error','isIntersects','../../salesforce/services/salesforce-logger-v2.service',']\x20[','4KJIizB','\x27\x20[','[INFO]\x20Repository\x20\x22','SalesforceLogger2','convertToSFDX','repoList','defineProperty','length','2901438fCbgYk','get'];a188_0x1126=function(){return _0x96fb48;};return a188_0x1126();}(function(_0x33ca90,_0x2ffb18){const _0x5b59c2=a188_0x45cb,_0x502a05=_0x33ca90();while(!![]){try{const _0x507d84=parseInt(_0x5b59c2(0xae))/0x1+-parseInt(_0x5b59c2(0xa2))/0x2+parseInt(_0x5b59c2(0x95))/0x3+parseInt(_0x5b59c2(0xd1))/0x4*(-parseInt(_0x5b59c2(0x91))/0x5)+-parseInt(_0x5b59c2(0xd9))/0x6+-parseInt(_0x5b59c2(0x88))/0x7*(-parseInt(_0x5b59c2(0x9f))/0x8)+parseInt(_0x5b59c2(0xe3))/0x9*(parseInt(_0x5b59c2(0xdf))/0xa);if(_0x507d84===_0x2ffb18)break;else _0x502a05['push'](_0x502a05['shift']());}catch(_0x218869){_0x502a05['push'](_0x502a05['shift']());}}}(a188_0x1126,0x56bd0));const a188_0x363fc1=(function(){let _0x1c9b4f=!![];return function(_0x45d261,_0x4d439c){const _0x3cd0ec=_0x1c9b4f?function(){const _0x52f50a=a188_0x45cb;if(_0x4d439c){const _0x4cfb77=_0x4d439c[_0x52f50a(0xeb)](_0x45d261,arguments);return _0x4d439c=null,_0x4cfb77;}}:function(){};return _0x1c9b4f=![],_0x3cd0ec;};}()),a188_0x462370=a188_0x363fc1(this,function(){const _0x3098d7=a188_0x45cb;return a188_0x462370[_0x3098d7(0xe8)]()[_0x3098d7(0xaf)]('(((.+)+)+)+$')[_0x3098d7(0xe8)]()[_0x3098d7(0xb2)](a188_0x462370)[_0x3098d7(0xaf)](_0x3098d7(0xbb));});a188_0x462370();'use strict';var __createBinding=this&&this[a188_0xc73dc2(0xb9)]||(Object[a188_0xc73dc2(0xa5)]?function(_0x52e200,_0x4c4669,_0x491801,_0x337be3){const _0x37cfac=a188_0xc73dc2;if(_0x337be3===undefined)_0x337be3=_0x491801;Object[_0x37cfac(0xd7)](_0x52e200,_0x337be3,{'enumerable':!![],'get':function(){return _0x4c4669[_0x491801];}});}:function(_0x5a21b7,_0x106615,_0x33b37d,_0x49d827){if(_0x49d827===undefined)_0x49d827=_0x33b37d;_0x5a21b7[_0x49d827]=_0x106615[_0x33b37d];}),__setModuleDefault=this&&this[a188_0xc73dc2(0xbf)]||(Object[a188_0xc73dc2(0xa5)]?function(_0x99448c,_0x167e45){const _0x4121f9=a188_0xc73dc2;Object[_0x4121f9(0xd7)](_0x99448c,'default',{'enumerable':!![],'value':_0x167e45});}:function(_0x5b8a06,_0x128cef){_0x5b8a06['default']=_0x128cef;}),__decorate=this&&this[a188_0xc73dc2(0xe9)]||function(_0x1e494c,_0x1befed,_0x3f3a45,_0x10bc55){const _0x1472ae=a188_0xc73dc2;var _0x2b0a9f=arguments[_0x1472ae(0xd8)],_0x365032=_0x2b0a9f<0x3?_0x1befed:_0x10bc55===null?_0x10bc55=Object['getOwnPropertyDescriptor'](_0x1befed,_0x3f3a45):_0x10bc55,_0x138846;if(typeof Reflect===_0x1472ae(0xb7)&&typeof Reflect[_0x1472ae(0x85)]===_0x1472ae(0xab))_0x365032=Reflect[_0x1472ae(0x85)](_0x1e494c,_0x1befed,_0x3f3a45,_0x10bc55);else{for(var _0x2389bb=_0x1e494c[_0x1472ae(0xd8)]-0x1;_0x2389bb>=0x0;_0x2389bb--)if(_0x138846=_0x1e494c[_0x2389bb])_0x365032=(_0x2b0a9f<0x3?_0x138846(_0x365032):_0x2b0a9f>0x3?_0x138846(_0x1befed,_0x3f3a45,_0x365032):_0x138846(_0x1befed,_0x3f3a45))||_0x365032;}return _0x2b0a9f>0x3&&_0x365032&&Object[_0x1472ae(0xd7)](_0x1befed,_0x3f3a45,_0x365032),_0x365032;},__importStar=this&&this[a188_0xc73dc2(0xc9)]||function(_0x3d50b7){const _0x1412d7=a188_0xc73dc2;if(_0x3d50b7&&_0x3d50b7[_0x1412d7(0x97)])return _0x3d50b7;var _0x2ff9d6={};if(_0x3d50b7!=null){for(var _0x5b41ee in _0x3d50b7)if(_0x5b41ee!==_0x1412d7(0x8f)&&Object[_0x1412d7(0xba)][_0x1412d7(0xe6)][_0x1412d7(0xaa)](_0x3d50b7,_0x5b41ee))__createBinding(_0x2ff9d6,_0x3d50b7,_0x5b41ee);}return __setModuleDefault(_0x2ff9d6,_0x3d50b7),_0x2ff9d6;},__metadata=this&&this[a188_0xc73dc2(0xe0)]||function(_0x3a456d,_0x363102){const _0x436af4=a188_0xc73dc2;if(typeof Reflect===_0x436af4(0xb7)&&typeof Reflect['metadata']===_0x436af4(0xab))return Reflect[_0x436af4(0x90)](_0x3a456d,_0x363102);},SyncService_1;function a188_0x45cb(_0x40c168,_0x215e58){const _0x7add87=a188_0x1126();return a188_0x45cb=function(_0x462370,_0x363fc1){_0x462370=_0x462370-0x85;let _0x1126b4=_0x7add87[_0x462370];return _0x1126b4;},a188_0x45cb(_0x40c168,_0x215e58);}Object[a188_0xc73dc2(0xd7)](exports,a188_0xc73dc2(0x97),{'value':!![]}),exports[a188_0xc73dc2(0xbd)]=void 0x0;const constants_1=require(a188_0xc73dc2(0xb4)),core_1=require(a188_0xc73dc2(0xdd)),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require(a188_0xc73dc2(0xdb)),salesforce_error_1=require(a188_0xc73dc2(0xcb)),salesforce_logger_v2_service_1=require(a188_0xc73dc2(0xcf)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a188_0xc73dc2(0xb6)),git_provider_manager_1=require(a188_0xc73dc2(0xbc)),utils_1=require(a188_0xc73dc2(0x86)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require('../../hooks/hooks.utils'),git_branch_not_found_error_1=require(a188_0xc73dc2(0xf1)),flosum_sync_job_1=require(a188_0xc73dc2(0x87)),git_sync_job_1=require('../jobs/git-sync.job');let SyncService=SyncService_1=class SyncService{constructor(_0x29e082,_0x1d7a59,_0x3ae9ee){const _0x3a80c1=a188_0xc73dc2;this['salesforceService']=_0x29e082,this[_0x3a80c1(0xa0)]=_0x1d7a59,this['gitManager']=_0x3ae9ee,this[_0x3a80c1(0xee)]=new core_1[(_0x3a80c1(0xa4))](SyncService_1[_0x3a80c1(0x9b)]),this[_0x3a80c1(0xec)]={},this['repoList']=[];}async[a188_0xc73dc2(0xc5)](_0x2a8e85,_0x4f9ede){const _0x35cce9=a188_0xc73dc2;if(_0x4f9ede instanceof git_branch_not_found_error_1[_0x35cce9(0xcc)]){await this[_0x35cce9(0xa0)][_0x35cce9(0xef)](_0x2a8e85,_0x35cce9(0xb5));return;}if(_0x4f9ede instanceof too_many_requests_error_1[_0x35cce9(0xdc)]){await this[_0x35cce9(0xa0)][_0x35cce9(0xef)](_0x2a8e85,_0x35cce9(0xc3));throw _0x4f9ede;}try{await this[_0x35cce9(0xb1)]['log']('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x2a8e85['repositoryName']+_0x35cce9(0xd2)+_0x2a8e85[_0x35cce9(0xe4)]+']\x20due\x20error\x20-\x20'+_0x4f9ede)[_0x35cce9(0x93)](),await this[_0x35cce9(0xa0)][_0x35cce9(0x8e)](_0x2a8e85,{}),await this[_0x35cce9(0xa0)][_0x35cce9(0xef)](_0x2a8e85,'Error');}catch(_0x3be766){if(_0x3be766 instanceof salesforce_error_1['SalesforceError'])throw _0x3be766;}}async[a188_0xc73dc2(0xce)](_0x7e4648){const _0x3f77ff=a188_0xc73dc2;if(_0x7e4648[_0x3f77ff(0xa8)]){const _0x51aa9a=_0x7e4648[_0x3f77ff(0x94)][_0x3f77ff(0xb3)](),_0x238e31=this[_0x3f77ff(0xec)][_0x51aa9a];if(!_0x238e31)this[_0x3f77ff(0xec)][_0x51aa9a]=_0x7e4648[_0x3f77ff(0x94)];else{if(_0x238e31&&_0x238e31!==_0x7e4648['repositoryName'])return await this[_0x3f77ff(0xc5)](_0x7e4648,new Error(_0x3f77ff(0x96)+_0x7e4648[_0x3f77ff(0x94)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x51aa9a+_0x3f77ff(0x8c)+_0x238e31+'\x27')),!![];}}return![];}async[a188_0xc73dc2(0xe7)](_0x296bf9){const _0x278fa6=a188_0xc73dc2;if(!constants_1[_0x278fa6(0xbe)]['test'](_0x296bf9[_0x278fa6(0x94)]))return await this[_0x278fa6(0xc5)](_0x296bf9,new Error(_0x278fa6(0x96)+_0x296bf9[_0x278fa6(0x94)]+_0x278fa6(0xde))),![];if(!constants_1[_0x278fa6(0xf0)]['test'](_0x296bf9[_0x278fa6(0xe4)]))return await this['handleRecordSyncError'](_0x296bf9,new Error(_0x278fa6(0xea)+_0x296bf9[_0x278fa6(0xe4)]+'\x27\x20in\x20repository\x20\x27'+_0x296bf9[_0x278fa6(0x94)]+_0x278fa6(0xc0))),![];return!![];}async[a188_0xc73dc2(0xc8)](_0x7151df,_0x307c7c,_0x4a8b5a){const _0x11e553=a188_0xc73dc2;let _0x1aa5f4=this[_0x11e553(0xd6)][_0x11e553(0x9c)](_0xb12592=>_0x7151df[_0x11e553(0x94)]===_0xb12592['name']);!_0x1aa5f4&&(this[_0x11e553(0xb1)][_0x11e553(0x92)](_0x11e553(0xd3)+_0x7151df[_0x11e553(0x94)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x1aa5f4=await this[_0x11e553(0xa6)]['create']({'name':_0x7151df[_0x11e553(0x94)],'autoInit':!![],'defaultBranch':_0x7151df[_0x11e553(0xe4)],'private':!![],'createHook':this[_0x11e553(0x9a)]['createHooks']}));if(this[_0x11e553(0x9a)]['createHooks']){const _0xe70f0=await _0x1aa5f4[_0x11e553(0xc2)][_0x11e553(0xb0)]();!_0xe70f0[_0x11e553(0x9c)](_0x16e60a=>_0x16e60a[_0x11e553(0xe2)]===hooks_utils_1[_0x11e553(0xac)][_0x11e553(0xc6)](_0x307c7c,_0x4a8b5a))&&(this[_0x11e553(0xb1)][_0x11e553(0x92)]('[INFO]\x20Repository\x20\x22'+_0x7151df[_0x11e553(0x94)]+'\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.'),await _0x1aa5f4[_0x11e553(0xc2)][_0x11e553(0xa5)](hooks_utils_1[_0x11e553(0xac)][_0x11e553(0xca)](_0x307c7c,_0x1aa5f4[_0x11e553(0xc2)],_0x4a8b5a)));}return this['repoList'][_0x11e553(0xa7)](_0x1aa5f4),_0x1aa5f4;}async[a188_0xc73dc2(0xed)](_0x5e8192,_0x3ad4b5,_0x27871c,_0x4c4185){const _0x2e8b41=a188_0xc73dc2;this[_0x2e8b41(0x98)][_0x2e8b41(0xf2)](_0x3ad4b5),this[_0x2e8b41(0xa6)]=this[_0x2e8b41(0x8b)]['getRepoService'](_0x27871c),this[_0x2e8b41(0xb1)]=new salesforce_logger_v2_service_1[(_0x2e8b41(0xd4))](_0x3ad4b5,'['+SyncService_1[_0x2e8b41(0x9b)]+_0x2e8b41(0xd0)+_0x27871c[_0x2e8b41(0xb8)]()+']'),this[_0x2e8b41(0x9a)]=_0x5e8192;try{await this[_0x2e8b41(0xb1)][_0x2e8b41(0x92)](_0x2e8b41(0x9e))['send']();const [_0x2c806b,_0x4fa9ad]=await Promise[_0x2e8b41(0xc1)]([this[_0x2e8b41(0xa0)][_0x2e8b41(0xa1)](),this['salesforceSync']['getRepositoryRecords']()]);this['repoList']=await this[_0x2e8b41(0xa6)][_0x2e8b41(0xb0)]();const _0x44b6eb=[..._0x4fa9ad,..._0x2c806b];this[_0x2e8b41(0xee)][_0x2e8b41(0x92)](_0x2e8b41(0x8a),_0x44b6eb[_0x2e8b41(0xd8)]);for(const _0x2474de of _0x44b6eb){this[_0x2e8b41(0xee)][_0x2e8b41(0x92)](_0x2e8b41(0x9d),_0x2474de['repositoryName'],_0x2474de['repositoryId'],_0x2474de[_0x2e8b41(0xe4)],_0x2474de['branchId']);const _0x57ec0e=await this[_0x2e8b41(0xe7)](_0x2474de);if(!_0x57ec0e)continue;const _0x2e1fef=await this[_0x2e8b41(0xce)](_0x2474de);if(_0x2e1fef)continue;let _0x2eb0b5;try{_0x2eb0b5=await this[_0x2e8b41(0xc8)](_0x2474de,_0x27871c,_0x4c4185);}catch(_0x1ba86b){await this[_0x2e8b41(0xc5)](_0x2474de,_0x1ba86b instanceof too_many_requests_error_1[_0x2e8b41(0xdc)]?_0x1ba86b:new Error(_0x2e8b41(0xe5)+_0x1ba86b));continue;}await this[_0x2e8b41(0xb1)][_0x2e8b41(0x93)]();if(_0x2474de['direction']===flosum_repository_sync_dto_1[_0x2e8b41(0xa3)][_0x2e8b41(0xc4)]){const _0x13b66a=typedi_1[_0x2e8b41(0x8f)][_0x2e8b41(0xda)](flosum_sync_job_1[_0x2e8b41(0x8d)]);await _0x13b66a[_0x2e8b41(0xed)]({'repository':_0x2eb0b5,'convertToSFDX':_0x5e8192[_0x2e8b41(0xd5)],'syncRecord':_0x2474de,'provider':_0x27871c,'logger':this[_0x2e8b41(0xb1)]})[_0x2e8b41(0x89)](_0x5c13f5=>this[_0x2e8b41(0xc5)](_0x2474de,_0x5c13f5));}else{const _0x2a9fab=typedi_1[_0x2e8b41(0x8f)][_0x2e8b41(0xda)](git_sync_job_1['GitSyncJob']);await _0x2a9fab['run']({'repository':_0x2eb0b5,'branch':_0x2474de[_0x2e8b41(0xe4)],'provider':_0x27871c,'repositoryGit':_0x2eb0b5[_0x2e8b41(0xe1)],'syncRecord':_0x2474de,'logger':this[_0x2e8b41(0xb1)]})[_0x2e8b41(0x89)](_0x1e2a21=>this[_0x2e8b41(0xc5)](_0x2474de,_0x1e2a21));}}}catch(_0x120805){this[_0x2e8b41(0xee)][_0x2e8b41(0xcd)](_0x120805);_0x120805 instanceof too_many_requests_error_1[_0x2e8b41(0xdc)]?(await this[_0x2e8b41(0xb1)][_0x2e8b41(0x92)](_0x2e8b41(0xc7))[_0x2e8b41(0x93)](),await utils_1['sleep'](0x3c*0x3c*0x3e8),this[_0x2e8b41(0xed)](_0x5e8192,_0x3ad4b5,_0x27871c,_0x4c4185)):await this[_0x2e8b41(0xb1)][_0x2e8b41(0x92)]('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x120805)[_0x2e8b41(0x93)]();return;}await this['sfLogger'][_0x2e8b41(0x92)](_0x2e8b41(0xa9))[_0x2e8b41(0x93)](),await this[_0x2e8b41(0xa0)]['disableSync'](_0x5e8192[_0x2e8b41(0x99)])[_0x2e8b41(0x89)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1['Service']({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a188_0xc73dc2(0xad)],git_provider_manager_1['GitProviderManager']])],SyncService),exports['SyncService']=SyncService;