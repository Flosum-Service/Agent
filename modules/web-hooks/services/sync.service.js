const a188_0x2e5f47=a188_0xa506;(function(_0x20a4c9,_0x4e09b0){const _0x398e5b=a188_0xa506,_0x46ea1f=_0x20a4c9();while(!![]){try{const _0x51e24c=-parseInt(_0x398e5b(0x104))/0x1+parseInt(_0x398e5b(0x167))/0x2+-parseInt(_0x398e5b(0x148))/0x3+-parseInt(_0x398e5b(0x136))/0x4*(parseInt(_0x398e5b(0x137))/0x5)+parseInt(_0x398e5b(0x152))/0x6+-parseInt(_0x398e5b(0x161))/0x7+parseInt(_0x398e5b(0x13c))/0x8;if(_0x51e24c===_0x4e09b0)break;else _0x46ea1f['push'](_0x46ea1f['shift']());}catch(_0xa5d5ac){_0x46ea1f['push'](_0x46ea1f['shift']());}}}(a188_0x32c2,0x5e08c));const a188_0x55cba9=(function(){let _0x2b18ab=!![];return function(_0x50c30a,_0x163ddb){const _0x252a41=_0x2b18ab?function(){const _0x57c399=a188_0xa506;if(_0x163ddb){const _0x444f8a=_0x163ddb[_0x57c399(0x114)](_0x50c30a,arguments);return _0x163ddb=null,_0x444f8a;}}:function(){};return _0x2b18ab=![],_0x252a41;};}()),a188_0x3c6757=a188_0x55cba9(this,function(){const _0x52713f=a188_0xa506;return a188_0x3c6757[_0x52713f(0x139)]()[_0x52713f(0x141)](_0x52713f(0x126))[_0x52713f(0x139)]()['constructor'](a188_0x3c6757)['search'](_0x52713f(0x126));});a188_0x3c6757();function a188_0x32c2(){const _0x38380b=['67500ZOLQKo','repositoryName','toUpperCase','../errors/git-branch-not-found.error','SyncService','Error','find','SyncDirection','[INFO]\x20Repository\x20\x22','430501hxSagm','createHookPayload','salesforceService','typedi','repoList','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x27\x20[','repoService','HooksUtils','metadata','SalesforceSyncService','../../../core','defineProperty','Service','hasOwnProperty','BRANCH_NAME_REGEXP','apply','setStatus','__metadata','REPOSITORY_NAME_REGEXP','GitBranchNotFoundError','get','hooks','gitUrl','SalesforceError','logger','isIntersects',']\x20[','object','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','getOrCreateRepo','../../../constants','Not\x20Synchronized','url','(((.+)+)+)+$','../../../core/errors/too-many-requests.error','createHooks','../../hooks/hooks.utils','sleep','direction','default','../../salesforce/services/salesforce-sync.service','getAll','function','run','handleRecordSyncError','syncID','toLowerCase','Unable\x20to\x20synchronize\x20repository\x20\x27','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','12unhbOp','435980XXrXPN','SalesforceLogger2','toString','setLoggerId','sfLogger','12104024BRgnmv','../../salesforce/services/salesforce-logger-v2.service','disableSync','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','\x27\x20-\x20\x27','search','have\x20to\x20synchronize\x20%d\x20branches','Logger','convertToSFDX','name','push','GitProviderManager','2057166plSDNf','[INFO]\x20Start\x20sync\x20job','getBranchRecords','test','create','repositoriesIntersections','branchName','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','__esModule','decorate','3595242PyppJa','salesforceSync','__importStar','getRepositoryRecords','gitManager','branchId','catch','checkValidNaming','GitSyncJob','FlosumToGit','syncDto','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','length','__createBinding','send','2680895huwJXc','log','__setModuleDefault','prototype','../../shared/utils','TooManyRequests'];a188_0x32c2=function(){return _0x38380b;};return a188_0x32c2();}'use strict';var __createBinding=this&&this[a188_0x2e5f47(0x15f)]||(Object[a188_0x2e5f47(0x14c)]?function(_0x59163d,_0x32fd9b,_0x371717,_0x1ae315){const _0x2d1814=a188_0x2e5f47;if(_0x1ae315===undefined)_0x1ae315=_0x371717;Object[_0x2d1814(0x110)](_0x59163d,_0x1ae315,{'enumerable':!![],'get':function(){return _0x32fd9b[_0x371717];}});}:function(_0x196c7,_0x34b52c,_0x5ace6d,_0x472c1e){if(_0x472c1e===undefined)_0x472c1e=_0x5ace6d;_0x196c7[_0x472c1e]=_0x34b52c[_0x5ace6d];}),__setModuleDefault=this&&this[a188_0x2e5f47(0x163)]||(Object['create']?function(_0x293a01,_0xaf7fc8){const _0x54f77e=a188_0x2e5f47;Object[_0x54f77e(0x110)](_0x293a01,_0x54f77e(0x12c),{'enumerable':!![],'value':_0xaf7fc8});}:function(_0xf29e7b,_0x5e767a){const _0x4b6943=a188_0x2e5f47;_0xf29e7b[_0x4b6943(0x12c)]=_0x5e767a;}),__decorate=this&&this['__decorate']||function(_0x1c838e,_0x7cf63a,_0x5ccd04,_0x551520){const _0x54519b=a188_0x2e5f47;var _0x41fa3c=arguments[_0x54519b(0x15e)],_0x3ac3c9=_0x41fa3c<0x3?_0x7cf63a:_0x551520===null?_0x551520=Object['getOwnPropertyDescriptor'](_0x7cf63a,_0x5ccd04):_0x551520,_0x4fc49a;if(typeof Reflect===_0x54519b(0x120)&&typeof Reflect[_0x54519b(0x151)]===_0x54519b(0x12f))_0x3ac3c9=Reflect[_0x54519b(0x151)](_0x1c838e,_0x7cf63a,_0x5ccd04,_0x551520);else{for(var _0x23d93a=_0x1c838e[_0x54519b(0x15e)]-0x1;_0x23d93a>=0x0;_0x23d93a--)if(_0x4fc49a=_0x1c838e[_0x23d93a])_0x3ac3c9=(_0x41fa3c<0x3?_0x4fc49a(_0x3ac3c9):_0x41fa3c>0x3?_0x4fc49a(_0x7cf63a,_0x5ccd04,_0x3ac3c9):_0x4fc49a(_0x7cf63a,_0x5ccd04))||_0x3ac3c9;}return _0x41fa3c>0x3&&_0x3ac3c9&&Object[_0x54519b(0x110)](_0x7cf63a,_0x5ccd04,_0x3ac3c9),_0x3ac3c9;},__importStar=this&&this[a188_0x2e5f47(0x154)]||function(_0x9832b0){const _0x491fe2=a188_0x2e5f47;if(_0x9832b0&&_0x9832b0[_0x491fe2(0x150)])return _0x9832b0;var _0x552112={};if(_0x9832b0!=null){for(var _0x484bc5 in _0x9832b0)if(_0x484bc5!==_0x491fe2(0x12c)&&Object[_0x491fe2(0x164)][_0x491fe2(0x112)]['call'](_0x9832b0,_0x484bc5))__createBinding(_0x552112,_0x9832b0,_0x484bc5);}return __setModuleDefault(_0x552112,_0x9832b0),_0x552112;},__metadata=this&&this[a188_0x2e5f47(0x116)]||function(_0x2de70d,_0x150da6){const _0x1c472e=a188_0x2e5f47;if(typeof Reflect==='object'&&typeof Reflect[_0x1c472e(0x10d)]==='function')return Reflect[_0x1c472e(0x10d)](_0x2de70d,_0x150da6);},SyncService_1;function a188_0xa506(_0x57f01e,_0x57b8e4){const _0x3bfd7f=a188_0x32c2();return a188_0xa506=function(_0x3c6757,_0x55cba9){_0x3c6757=_0x3c6757-0x101;let _0x32c242=_0x3bfd7f[_0x3c6757];return _0x32c242;},a188_0xa506(_0x57f01e,_0x57b8e4);}Object[a188_0x2e5f47(0x110)](exports,'__esModule',{'value':!![]}),exports[a188_0x2e5f47(0x16b)]=void 0x0;const constants_1=require(a188_0x2e5f47(0x123)),core_1=require(a188_0x2e5f47(0x10f)),too_many_requests_error_1=require(a188_0x2e5f47(0x127)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_logger_v2_service_1=require(a188_0x2e5f47(0x13d)),salesforce_sync_service_1=require(a188_0x2e5f47(0x12d)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a188_0x2e5f47(0x165)),typedi_1=__importStar(require(a188_0x2e5f47(0x107))),hooks_utils_1=require(a188_0x2e5f47(0x129)),git_branch_not_found_error_1=require(a188_0x2e5f47(0x16a)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require('../jobs/git-sync.job');let SyncService=SyncService_1=class SyncService{constructor(_0x5f4acd,_0x29b090,_0x4977ae){const _0x43f5a6=a188_0x2e5f47;this['salesforceService']=_0x5f4acd,this[_0x43f5a6(0x153)]=_0x29b090,this[_0x43f5a6(0x156)]=_0x4977ae,this[_0x43f5a6(0x11d)]=new core_1[(_0x43f5a6(0x143))](SyncService_1[_0x43f5a6(0x145)]),this[_0x43f5a6(0x14d)]={},this[_0x43f5a6(0x108)]=[];}async[a188_0x2e5f47(0x131)](_0x10bef8,_0x425dac){const _0x49d5cc=a188_0x2e5f47;if(_0x425dac instanceof git_branch_not_found_error_1[_0x49d5cc(0x118)]){await this[_0x49d5cc(0x153)][_0x49d5cc(0x115)](_0x10bef8,_0x49d5cc(0x124));return;}if(_0x425dac instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x49d5cc(0x153)][_0x49d5cc(0x115)](_0x10bef8,'Waiting');throw _0x425dac;}try{await this['sfLogger'][_0x49d5cc(0x162)](_0x49d5cc(0x13f)+_0x10bef8[_0x49d5cc(0x168)]+_0x49d5cc(0x10a)+_0x10bef8[_0x49d5cc(0x14e)]+']\x20due\x20error\x20-\x20'+_0x425dac)[_0x49d5cc(0x160)](),await this[_0x49d5cc(0x153)]['updateRemoteState'](_0x10bef8,{}),await this[_0x49d5cc(0x153)][_0x49d5cc(0x115)](_0x10bef8,_0x49d5cc(0x16c));}catch(_0x4ce099){if(_0x4ce099 instanceof salesforce_error_1[_0x49d5cc(0x11c)])throw _0x4ce099;}}async[a188_0x2e5f47(0x11e)](_0x21d385){const _0x879ce1=a188_0x2e5f47;if(_0x21d385['repositoryId']){const _0x4d9dca=_0x21d385[_0x879ce1(0x168)][_0x879ce1(0x133)](),_0x3b1612=this[_0x879ce1(0x14d)][_0x4d9dca];if(!_0x3b1612)this['repositoriesIntersections'][_0x4d9dca]=_0x21d385[_0x879ce1(0x168)];else{if(_0x3b1612&&_0x3b1612!==_0x21d385[_0x879ce1(0x168)])return await this[_0x879ce1(0x131)](_0x21d385,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x21d385['repositoryName']+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x4d9dca+_0x879ce1(0x140)+_0x3b1612+'\x27')),!![];}}return![];}async[a188_0x2e5f47(0x159)](_0x468d40){const _0x2a3719=a188_0x2e5f47;if(!constants_1[_0x2a3719(0x117)][_0x2a3719(0x14b)](_0x468d40[_0x2a3719(0x168)]))return await this[_0x2a3719(0x131)](_0x468d40,new Error(_0x2a3719(0x134)+_0x468d40['repositoryName']+_0x2a3719(0x109))),![];if(!constants_1[_0x2a3719(0x113)][_0x2a3719(0x14b)](_0x468d40[_0x2a3719(0x14e)]))return await this[_0x2a3719(0x131)](_0x468d40,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x468d40[_0x2a3719(0x14e)]+'\x27\x20in\x20repository\x20\x27'+_0x468d40['repositoryName']+_0x2a3719(0x14f))),![];return!![];}async[a188_0x2e5f47(0x122)](_0xfd60bb,_0x13e4d5,_0x1f97d0){const _0x4ac02d=a188_0x2e5f47;let _0x5a8159=this[_0x4ac02d(0x108)][_0x4ac02d(0x101)](_0x1a482d=>_0xfd60bb[_0x4ac02d(0x168)]===_0x1a482d['name']);!_0x5a8159&&(this['sfLogger']['log'](_0x4ac02d(0x103)+_0xfd60bb[_0x4ac02d(0x168)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x5a8159=await this[_0x4ac02d(0x10b)][_0x4ac02d(0x14c)]({'name':_0xfd60bb['repositoryName'],'autoInit':!![],'defaultBranch':_0xfd60bb['branchName'],'private':!![],'createHook':this['syncDto'][_0x4ac02d(0x128)]}));if(this[_0x4ac02d(0x15c)][_0x4ac02d(0x128)]){const _0x3f0a5e=await _0x5a8159[_0x4ac02d(0x11a)][_0x4ac02d(0x12e)]();!_0x3f0a5e[_0x4ac02d(0x101)](_0x1c0392=>_0x1c0392[_0x4ac02d(0x125)]===hooks_utils_1[_0x4ac02d(0x10c)]['getHookLinkFor'](_0x13e4d5,_0x1f97d0))&&(this[_0x4ac02d(0x13b)][_0x4ac02d(0x162)](_0x4ac02d(0x103)+_0xfd60bb[_0x4ac02d(0x168)]+'\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.'),await _0x5a8159['hooks'][_0x4ac02d(0x14c)](hooks_utils_1[_0x4ac02d(0x10c)][_0x4ac02d(0x105)](_0x13e4d5,_0x5a8159[_0x4ac02d(0x11a)],_0x1f97d0)));}return this[_0x4ac02d(0x108)][_0x4ac02d(0x146)](_0x5a8159),_0x5a8159;}async[a188_0x2e5f47(0x130)](_0x57da31,_0x1d7a0f,_0x242fe3,_0x10b495){const _0x5f3a25=a188_0x2e5f47;this[_0x5f3a25(0x106)][_0x5f3a25(0x13a)](_0x1d7a0f),this[_0x5f3a25(0x10b)]=this['gitManager']['getRepoService'](_0x242fe3),this[_0x5f3a25(0x13b)]=new salesforce_logger_v2_service_1[(_0x5f3a25(0x138))](_0x1d7a0f,'['+SyncService_1['name']+_0x5f3a25(0x11f)+_0x242fe3[_0x5f3a25(0x169)]()+']'),this[_0x5f3a25(0x15c)]=_0x57da31;try{await this[_0x5f3a25(0x13b)][_0x5f3a25(0x162)](_0x5f3a25(0x149))[_0x5f3a25(0x160)]();const [_0x24f715,_0x19bacd]=await Promise['all']([this['salesforceSync'][_0x5f3a25(0x14a)](),this[_0x5f3a25(0x153)][_0x5f3a25(0x155)]()]);this['repoList']=await this[_0x5f3a25(0x10b)][_0x5f3a25(0x12e)]();const _0x440ecb=[..._0x19bacd,..._0x24f715];this['logger']['log'](_0x5f3a25(0x142),_0x440ecb[_0x5f3a25(0x15e)]);for(const _0x2d7d3b of _0x440ecb){this[_0x5f3a25(0x11d)]['log']('syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch',_0x2d7d3b[_0x5f3a25(0x168)],_0x2d7d3b['repositoryId'],_0x2d7d3b['branchName'],_0x2d7d3b[_0x5f3a25(0x157)]);const _0x1feb3e=await this[_0x5f3a25(0x159)](_0x2d7d3b);if(!_0x1feb3e)continue;const _0x296c2b=await this[_0x5f3a25(0x11e)](_0x2d7d3b);if(_0x296c2b)continue;let _0x14762b;try{_0x14762b=await this['getOrCreateRepo'](_0x2d7d3b,_0x242fe3,_0x10b495);}catch(_0x4950f0){await this['handleRecordSyncError'](_0x2d7d3b,_0x4950f0 instanceof too_many_requests_error_1[_0x5f3a25(0x166)]?_0x4950f0:new Error(_0x5f3a25(0x135)+_0x4950f0));continue;}await this['sfLogger'][_0x5f3a25(0x160)]();if(_0x2d7d3b[_0x5f3a25(0x12b)]===flosum_repository_sync_dto_1[_0x5f3a25(0x102)][_0x5f3a25(0x15b)]){const _0x302f79=typedi_1[_0x5f3a25(0x12c)][_0x5f3a25(0x119)](flosum_sync_job_1['FlosumSyncJob']);await _0x302f79[_0x5f3a25(0x130)]({'repository':_0x14762b,'convertToSFDX':_0x57da31[_0x5f3a25(0x144)],'syncRecord':_0x2d7d3b,'provider':_0x242fe3,'logger':this[_0x5f3a25(0x13b)]})['catch'](_0x524cc1=>this[_0x5f3a25(0x131)](_0x2d7d3b,_0x524cc1));}else{const _0x5081e4=typedi_1[_0x5f3a25(0x12c)][_0x5f3a25(0x119)](git_sync_job_1[_0x5f3a25(0x15a)]);await _0x5081e4[_0x5f3a25(0x130)]({'repository':_0x14762b,'branch':_0x2d7d3b['branchName'],'provider':_0x242fe3,'repositoryGit':_0x14762b[_0x5f3a25(0x11b)],'syncRecord':_0x2d7d3b,'logger':this[_0x5f3a25(0x13b)]})[_0x5f3a25(0x158)](_0x570c41=>this[_0x5f3a25(0x131)](_0x2d7d3b,_0x570c41));}}}catch(_0x1427dc){this[_0x5f3a25(0x11d)]['error'](_0x1427dc);_0x1427dc instanceof too_many_requests_error_1['TooManyRequests']?(await this['sfLogger'][_0x5f3a25(0x162)](_0x5f3a25(0x121))[_0x5f3a25(0x160)](),await utils_1[_0x5f3a25(0x12a)](0x3c*0x3c*0x3e8),this[_0x5f3a25(0x130)](_0x57da31,_0x1d7a0f,_0x242fe3,_0x10b495)):await this[_0x5f3a25(0x13b)][_0x5f3a25(0x162)](_0x5f3a25(0x15d)+_0x1427dc)['send']();return;}await this[_0x5f3a25(0x13b)]['log']('[INFO]\x20Sync\x20job\x20done.')['send'](),await this[_0x5f3a25(0x153)][_0x5f3a25(0x13e)](_0x57da31[_0x5f3a25(0x132)])['catch'](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x2e5f47(0x111)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a188_0x2e5f47(0x10e)],git_provider_manager_1[a188_0x2e5f47(0x147)]])],SyncService),exports[a188_0x2e5f47(0x16b)]=SyncService;