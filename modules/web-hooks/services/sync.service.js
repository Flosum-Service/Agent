const a188_0x539fbf=a188_0x517f;(function(_0x5d9d23,_0x308239){const _0x272d37=a188_0x517f,_0xe315b8=_0x5d9d23();while(!![]){try{const _0x3a88ba=parseInt(_0x272d37(0x1bc))/0x1+-parseInt(_0x272d37(0x1a6))/0x2*(-parseInt(_0x272d37(0x1b4))/0x3)+parseInt(_0x272d37(0x1aa))/0x4*(-parseInt(_0x272d37(0x1d5))/0x5)+-parseInt(_0x272d37(0x1b8))/0x6+parseInt(_0x272d37(0x199))/0x7*(parseInt(_0x272d37(0x1cc))/0x8)+parseInt(_0x272d37(0x1fa))/0x9+-parseInt(_0x272d37(0x1ea))/0xa;if(_0x3a88ba===_0x308239)break;else _0xe315b8['push'](_0xe315b8['shift']());}catch(_0x41bbe7){_0xe315b8['push'](_0xe315b8['shift']());}}}(a188_0x5ae6,0xe9d54));function a188_0x517f(_0x423e9d,_0x9d58b3){const _0x20c52a=a188_0x5ae6();return a188_0x517f=function(_0xbba646,_0x434461){_0xbba646=_0xbba646-0x192;let _0x5ae67d=_0x20c52a[_0xbba646];return _0x5ae67d;},a188_0x517f(_0x423e9d,_0x9d58b3);}const a188_0x434461=(function(){let _0x1b6dbc=!![];return function(_0x271760,_0x2938c7){const _0x16c61f=_0x1b6dbc?function(){const _0x31170c=a188_0x517f;if(_0x2938c7){const _0x336354=_0x2938c7[_0x31170c(0x1b7)](_0x271760,arguments);return _0x2938c7=null,_0x336354;}}:function(){};return _0x1b6dbc=![],_0x16c61f;};}()),a188_0xbba646=a188_0x434461(this,function(){const _0x418ad6=a188_0x517f;return a188_0xbba646['toString']()[_0x418ad6(0x1b9)]('(((.+)+)+)+$')[_0x418ad6(0x1e5)]()[_0x418ad6(0x1a1)](a188_0xbba646)[_0x418ad6(0x1b9)](_0x418ad6(0x200));});function a188_0x5ae6(){const _0x188bf4=['syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','toLowerCase','gitManager','13988750YhSDas','Error','repositoriesIntersections','run','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','../../shared/utils','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','HooksUtils','all','decorate','send','handleRecordSyncError','GitSyncJob','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20',']\x20due\x20error\x20-\x20','5438025NBZZuq','Unable\x20to\x20synchronize\x20repository\x20\x27','[INFO]\x20Repository\x20\x22','name','SyncService','repoList','(((.+)+)+)+$','repoService','setStatus','../../salesforce/services/salesforce-sync.service','[INFO]\x20Start\x20sync\x20job','setLoggerId','getBranchRecords','__importStar','../../salesforce/errors/salesforce.error','../../salesforce/dto/flosum-repository-sync.dto','direction','function','checkValidNaming','metadata','branchName','../jobs/flosum-sync.job','62524nqujVt','repositoryId','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','logger','\x27\x20[','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','\x27\x20-\x20\x27','../../salesforce/services/salesforce.service','constructor','branchId','salesforceSync','length','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','4WTTuUp','design:paramtypes','__esModule','../../hooks/hooks.utils','552088JsNQNC','default','have\x20to\x20synchronize\x20%d\x20branches','getRepositoryRecords','getAll','defineProperty','createHooks','create','salesforceService','SyncDirection','2529087JODKhn','../jobs/git-sync.job','[INFO]\x20Sync\x20job\x20done.','apply','577824qNyBgu','search','Not\x20Synchronized','FlosumSyncJob','694356xeYRlT','__metadata','../errors/git-branch-not-found.error','syncDto','../../../core','repositoryName','test','Logger','__createBinding','__decorate','../../shared/git-provider.manager','SalesforceService','hooks','push','log','catch','760nBSjgu','../../../core/errors/too-many-requests.error','typedi','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','GitProviderManager','../../salesforce/services/salesforce-logger-v2.service','SalesforceLogger2','Waiting','Service','50swTMYk','updateRemoteState','SalesforceError','getOrCreateRepo','Unable\x20to\x20synchronize\x20branch\x20\x27','disableSync','url','FlosumToGit','TooManyRequests','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','sfLogger','gitUrl','getHookLinkFor','convertToSFDX','call','object','toString','createHookPayload'];a188_0x5ae6=function(){return _0x188bf4;};return a188_0x5ae6();}a188_0xbba646();'use strict';var __createBinding=this&&this[a188_0x539fbf(0x1c4)]||(Object['create']?function(_0x5ced8f,_0x3e2484,_0x16236f,_0x554b12){const _0x1f7981=a188_0x539fbf;if(_0x554b12===undefined)_0x554b12=_0x16236f;Object[_0x1f7981(0x1af)](_0x5ced8f,_0x554b12,{'enumerable':!![],'get':function(){return _0x3e2484[_0x16236f];}});}:function(_0x23b3dc,_0xab80c2,_0x3b11e4,_0x59fa5a){if(_0x59fa5a===undefined)_0x59fa5a=_0x3b11e4;_0x23b3dc[_0x59fa5a]=_0xab80c2[_0x3b11e4];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a188_0x539fbf(0x1b1)]?function(_0x187fdb,_0xac6f5e){const _0xf87641=a188_0x539fbf;Object[_0xf87641(0x1af)](_0x187fdb,_0xf87641(0x1ab),{'enumerable':!![],'value':_0xac6f5e});}:function(_0x34e42a,_0x3406aa){const _0x293d19=a188_0x539fbf;_0x34e42a[_0x293d19(0x1ab)]=_0x3406aa;}),__decorate=this&&this[a188_0x539fbf(0x1c5)]||function(_0x14ed16,_0xb1cb2c,_0x2bce0d,_0x3040c4){const _0x2d9b9a=a188_0x539fbf;var _0x144ba0=arguments[_0x2d9b9a(0x1a4)],_0x266af1=_0x144ba0<0x3?_0xb1cb2c:_0x3040c4===null?_0x3040c4=Object['getOwnPropertyDescriptor'](_0xb1cb2c,_0x2bce0d):_0x3040c4,_0x251a86;if(typeof Reflect===_0x2d9b9a(0x1e4)&&typeof Reflect[_0x2d9b9a(0x1f4)]===_0x2d9b9a(0x194))_0x266af1=Reflect[_0x2d9b9a(0x1f4)](_0x14ed16,_0xb1cb2c,_0x2bce0d,_0x3040c4);else{for(var _0x68885f=_0x14ed16[_0x2d9b9a(0x1a4)]-0x1;_0x68885f>=0x0;_0x68885f--)if(_0x251a86=_0x14ed16[_0x68885f])_0x266af1=(_0x144ba0<0x3?_0x251a86(_0x266af1):_0x144ba0>0x3?_0x251a86(_0xb1cb2c,_0x2bce0d,_0x266af1):_0x251a86(_0xb1cb2c,_0x2bce0d))||_0x266af1;}return _0x144ba0>0x3&&_0x266af1&&Object['defineProperty'](_0xb1cb2c,_0x2bce0d,_0x266af1),_0x266af1;},__importStar=this&&this[a188_0x539fbf(0x207)]||function(_0x13fe0d){const _0xe07be6=a188_0x539fbf;if(_0x13fe0d&&_0x13fe0d[_0xe07be6(0x1a8)])return _0x13fe0d;var _0xbeaf17={};if(_0x13fe0d!=null){for(var _0x58bdcd in _0x13fe0d)if(_0x58bdcd!==_0xe07be6(0x1ab)&&Object['prototype']['hasOwnProperty'][_0xe07be6(0x1e3)](_0x13fe0d,_0x58bdcd))__createBinding(_0xbeaf17,_0x13fe0d,_0x58bdcd);}return __setModuleDefault(_0xbeaf17,_0x13fe0d),_0xbeaf17;},__metadata=this&&this[a188_0x539fbf(0x1bd)]||function(_0x214237,_0x1404d0){const _0x5ce9fe=a188_0x539fbf;if(typeof Reflect===_0x5ce9fe(0x1e4)&&typeof Reflect[_0x5ce9fe(0x196)]===_0x5ce9fe(0x194))return Reflect[_0x5ce9fe(0x196)](_0x214237,_0x1404d0);},SyncService_1;Object['defineProperty'](exports,a188_0x539fbf(0x1a8),{'value':!![]}),exports[a188_0x539fbf(0x1fe)]=void 0x0;const constants_1=require('../../../constants'),core_1=require(a188_0x539fbf(0x1c0)),too_many_requests_error_1=require(a188_0x539fbf(0x1cd)),flosum_repository_sync_dto_1=require(a188_0x539fbf(0x192)),salesforce_error_1=require(a188_0x539fbf(0x208)),salesforce_logger_v2_service_1=require(a188_0x539fbf(0x1d1)),salesforce_sync_service_1=require(a188_0x539fbf(0x203)),salesforce_service_1=require(a188_0x539fbf(0x1a0)),git_provider_manager_1=require(a188_0x539fbf(0x1c6)),utils_1=require(a188_0x539fbf(0x1ef)),typedi_1=__importStar(require(a188_0x539fbf(0x1ce))),hooks_utils_1=require(a188_0x539fbf(0x1a9)),git_branch_not_found_error_1=require(a188_0x539fbf(0x1be)),flosum_sync_job_1=require(a188_0x539fbf(0x198)),git_sync_job_1=require(a188_0x539fbf(0x1b5));let SyncService=SyncService_1=class SyncService{constructor(_0x3ccdff,_0x2ecf8c,_0x9298d0){const _0x5103e8=a188_0x539fbf;this[_0x5103e8(0x1b2)]=_0x3ccdff,this['salesforceSync']=_0x2ecf8c,this[_0x5103e8(0x1e9)]=_0x9298d0,this['logger']=new core_1[(_0x5103e8(0x1c3))](SyncService_1[_0x5103e8(0x1fd)]),this['repositoriesIntersections']={},this['repoList']=[];}async[a188_0x539fbf(0x1f6)](_0x5d204c,_0x2d3425){const _0xd08d7e=a188_0x539fbf;if(_0x2d3425 instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this[_0xd08d7e(0x1a3)]['setStatus'](_0x5d204c,_0xd08d7e(0x1ba));return;}if(_0x2d3425 instanceof too_many_requests_error_1['TooManyRequests']){await this['salesforceSync'][_0xd08d7e(0x202)](_0x5d204c,_0xd08d7e(0x1d3));throw _0x2d3425;}try{await this[_0xd08d7e(0x1df)]['log'](_0xd08d7e(0x1ee)+_0x5d204c[_0xd08d7e(0x1c1)]+_0xd08d7e(0x19d)+_0x5d204c['branchName']+_0xd08d7e(0x1f9)+_0x2d3425)[_0xd08d7e(0x1f5)](),await this[_0xd08d7e(0x1a3)][_0xd08d7e(0x1d6)](_0x5d204c,{}),await this[_0xd08d7e(0x1a3)][_0xd08d7e(0x202)](_0x5d204c,_0xd08d7e(0x1eb));}catch(_0x8f5a21){if(_0x8f5a21 instanceof salesforce_error_1[_0xd08d7e(0x1d7)])throw _0x8f5a21;}}async['isIntersects'](_0x775120){const _0x4f0d4e=a188_0x539fbf;if(_0x775120[_0x4f0d4e(0x19a)]){const _0xdd9939=_0x775120[_0x4f0d4e(0x1c1)][_0x4f0d4e(0x1e8)](),_0x4ba934=this[_0x4f0d4e(0x1ec)][_0xdd9939];if(!_0x4ba934)this[_0x4f0d4e(0x1ec)][_0xdd9939]=_0x775120[_0x4f0d4e(0x1c1)];else{if(_0x4ba934&&_0x4ba934!==_0x775120[_0x4f0d4e(0x1c1)])return await this[_0x4f0d4e(0x1f6)](_0x775120,new Error(_0x4f0d4e(0x1fb)+_0x775120['repositoryName']+_0x4f0d4e(0x1a5)+_0xdd9939+_0x4f0d4e(0x19f)+_0x4ba934+'\x27')),!![];}}return![];}async[a188_0x539fbf(0x195)](_0x5ca5e0){const _0x330e00=a188_0x539fbf;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x330e00(0x1c2)](_0x5ca5e0[_0x330e00(0x1c1)]))return await this['handleRecordSyncError'](_0x5ca5e0,new Error(_0x330e00(0x1fb)+_0x5ca5e0[_0x330e00(0x1c1)]+_0x330e00(0x1f1))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x330e00(0x1c2)](_0x5ca5e0[_0x330e00(0x197)]))return await this[_0x330e00(0x1f6)](_0x5ca5e0,new Error(_0x330e00(0x1d9)+_0x5ca5e0['branchName']+'\x27\x20in\x20repository\x20\x27'+_0x5ca5e0[_0x330e00(0x1c1)]+_0x330e00(0x19b))),![];return!![];}async[a188_0x539fbf(0x1d8)](_0x368e0d,_0x40bbb9,_0x92f547){const _0x3d0984=a188_0x539fbf;let _0x1c034d=this['repoList']['find'](_0x1617d0=>_0x368e0d[_0x3d0984(0x1c1)]===_0x1617d0[_0x3d0984(0x1fd)]);!_0x1c034d&&(this[_0x3d0984(0x1df)][_0x3d0984(0x1ca)](_0x3d0984(0x1fc)+_0x368e0d[_0x3d0984(0x1c1)]+_0x3d0984(0x19e)),_0x1c034d=await this[_0x3d0984(0x201)]['create']({'name':_0x368e0d['repositoryName'],'autoInit':!![],'defaultBranch':_0x368e0d[_0x3d0984(0x197)],'private':!![],'createHook':this['syncDto'][_0x3d0984(0x1b0)]}));if(this[_0x3d0984(0x1bf)][_0x3d0984(0x1b0)]){const _0x130c63=await _0x1c034d[_0x3d0984(0x1c8)][_0x3d0984(0x1ae)]();!_0x130c63['find'](_0x583224=>_0x583224[_0x3d0984(0x1db)]===hooks_utils_1[_0x3d0984(0x1f2)][_0x3d0984(0x1e1)](_0x40bbb9,_0x92f547))&&(this[_0x3d0984(0x1df)]['log'](_0x3d0984(0x1fc)+_0x368e0d['repositoryName']+_0x3d0984(0x1f0)),await _0x1c034d[_0x3d0984(0x1c8)][_0x3d0984(0x1b1)](hooks_utils_1['HooksUtils'][_0x3d0984(0x1e6)](_0x40bbb9,_0x1c034d['hooks'],_0x92f547)));}return this[_0x3d0984(0x1ff)][_0x3d0984(0x1c9)](_0x1c034d),_0x1c034d;}async[a188_0x539fbf(0x1ed)](_0x327af8,_0x176a07,_0x4aec73,_0x1c0856){const _0x4d1221=a188_0x539fbf;this[_0x4d1221(0x1b2)][_0x4d1221(0x205)](_0x176a07),this[_0x4d1221(0x201)]=this['gitManager']['getRepoService'](_0x4aec73),this[_0x4d1221(0x1df)]=new salesforce_logger_v2_service_1[(_0x4d1221(0x1d2))](_0x176a07,'['+SyncService_1['name']+']\x20['+_0x4aec73['toUpperCase']()+']'),this[_0x4d1221(0x1bf)]=_0x327af8;try{await this[_0x4d1221(0x1df)][_0x4d1221(0x1ca)](_0x4d1221(0x204))[_0x4d1221(0x1f5)]();const [_0x29e138,_0x57af5d]=await Promise[_0x4d1221(0x1f3)]([this['salesforceSync'][_0x4d1221(0x206)](),this[_0x4d1221(0x1a3)][_0x4d1221(0x1ad)]()]);this[_0x4d1221(0x1ff)]=await this[_0x4d1221(0x201)][_0x4d1221(0x1ae)]();const _0x101cab=[..._0x57af5d,..._0x29e138];this[_0x4d1221(0x19c)][_0x4d1221(0x1ca)](_0x4d1221(0x1ac),_0x101cab['length']);for(const _0x37891d of _0x101cab){this['logger'][_0x4d1221(0x1ca)](_0x4d1221(0x1e7),_0x37891d[_0x4d1221(0x1c1)],_0x37891d['repositoryId'],_0x37891d[_0x4d1221(0x197)],_0x37891d[_0x4d1221(0x1a2)]);const _0x1a8842=await this['checkValidNaming'](_0x37891d);if(!_0x1a8842)continue;const _0x57efc5=await this['isIntersects'](_0x37891d);if(_0x57efc5)continue;let _0x29d01f;try{_0x29d01f=await this[_0x4d1221(0x1d8)](_0x37891d,_0x4aec73,_0x1c0856);}catch(_0x5a0ffe){await this[_0x4d1221(0x1f6)](_0x37891d,_0x5a0ffe instanceof too_many_requests_error_1[_0x4d1221(0x1dd)]?_0x5a0ffe:new Error(_0x4d1221(0x1cf)+_0x5a0ffe));continue;}await this[_0x4d1221(0x1df)][_0x4d1221(0x1f5)]();if(_0x37891d[_0x4d1221(0x193)]===flosum_repository_sync_dto_1[_0x4d1221(0x1b3)][_0x4d1221(0x1dc)]){const _0x2284bd=typedi_1[_0x4d1221(0x1ab)]['get'](flosum_sync_job_1[_0x4d1221(0x1bb)]);await _0x2284bd[_0x4d1221(0x1ed)]({'repository':_0x29d01f,'convertToSFDX':_0x327af8[_0x4d1221(0x1e2)],'syncRecord':_0x37891d,'provider':_0x4aec73,'logger':this['sfLogger']})['catch'](_0x580858=>this[_0x4d1221(0x1f6)](_0x37891d,_0x580858));}else{const _0x2a8ee5=typedi_1[_0x4d1221(0x1ab)]['get'](git_sync_job_1[_0x4d1221(0x1f7)]);await _0x2a8ee5[_0x4d1221(0x1ed)]({'repository':_0x29d01f,'branch':_0x37891d['branchName'],'provider':_0x4aec73,'repositoryGit':_0x29d01f[_0x4d1221(0x1e0)],'syncRecord':_0x37891d,'logger':this[_0x4d1221(0x1df)]})[_0x4d1221(0x1cb)](_0x57bbc9=>this['handleRecordSyncError'](_0x37891d,_0x57bbc9));}}}catch(_0x50243c){this['logger']['error'](_0x50243c);_0x50243c instanceof too_many_requests_error_1[_0x4d1221(0x1dd)]?(await this[_0x4d1221(0x1df)][_0x4d1221(0x1ca)](_0x4d1221(0x1de))[_0x4d1221(0x1f5)](),await utils_1['sleep'](0x3c*0x3c*0x3e8),this[_0x4d1221(0x1ed)](_0x327af8,_0x176a07,_0x4aec73,_0x1c0856)):await this[_0x4d1221(0x1df)][_0x4d1221(0x1ca)](_0x4d1221(0x1f8)+_0x50243c)[_0x4d1221(0x1f5)]();return;}await this[_0x4d1221(0x1df)][_0x4d1221(0x1ca)](_0x4d1221(0x1b6))[_0x4d1221(0x1f5)](),await this['salesforceSync'][_0x4d1221(0x1da)](_0x327af8['syncID'])[_0x4d1221(0x1cb)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x539fbf(0x1d4)]({'transient':!![]}),__metadata(a188_0x539fbf(0x1a7),[salesforce_service_1[a188_0x539fbf(0x1c7)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a188_0x539fbf(0x1d0)]])],SyncService),exports[a188_0x539fbf(0x1fe)]=SyncService;