const a188_0x44e63f=a188_0x2b2f;(function(_0x5e4112,_0x1be23d){const _0x33258e=a188_0x2b2f,_0x5cfc74=_0x5e4112();while(!![]){try{const _0x535fd8=parseInt(_0x33258e(0xbb))/0x1+-parseInt(_0x33258e(0xd1))/0x2*(parseInt(_0x33258e(0x10a))/0x3)+parseInt(_0x33258e(0xb1))/0x4*(-parseInt(_0x33258e(0xdb))/0x5)+-parseInt(_0x33258e(0xd4))/0x6*(-parseInt(_0x33258e(0xdc))/0x7)+parseInt(_0x33258e(0x100))/0x8+-parseInt(_0x33258e(0xbd))/0x9+parseInt(_0x33258e(0xf7))/0xa;if(_0x535fd8===_0x1be23d)break;else _0x5cfc74['push'](_0x5cfc74['shift']());}catch(_0x387ffa){_0x5cfc74['push'](_0x5cfc74['shift']());}}}(a188_0x74d3,0xa8d16));function a188_0x2b2f(_0x308c27,_0x213ef9){const _0x46c83b=a188_0x74d3();return a188_0x2b2f=function(_0x26377a,_0x38a26e){_0x26377a=_0x26377a-0xad;let _0x74d3a4=_0x46c83b[_0x26377a];return _0x74d3a4;},a188_0x2b2f(_0x308c27,_0x213ef9);}function a188_0x74d3(){const _0x3d5bd1=['url','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','../../../core','Service','../../salesforce/services/salesforce-sync.service','SalesforceLogger2','name','updateRemoteState','gitManager',']\x20due\x20error\x20-\x20','Unable\x20to\x20synchronize\x20repository\x20\x27','Waiting','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','search','Logger','GitBranchNotFoundError','getAll','typedi','metadata','79028FDzEFI','\x27\x20-\x20\x27','run','getRepoService','apply','repositoryId','HooksUtils','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','__importStar','find','264614KoOwuT','getBranchRecords','1906155tfcoxw','(((.+)+)+)+$','FlosumToGit','../errors/git-branch-not-found.error','../../shared/utils','logger','setLoggerId','create','object','\x27\x20in\x20repository\x20\x27','FlosumSyncJob','log','salesforceService','toString','Unable\x20to\x20synchronize\x20branch\x20\x27','have\x20to\x20synchronize\x20%d\x20branches','getOrCreateRepo','constructor','syncID','handleRecordSyncError','2471384EDvGfK','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','isIntersects','6wUGoOU','length','hasOwnProperty','repoList','[INFO]\x20Start\x20sync\x20job','syncDto','repositoriesIntersections','85saCsbd','1466297KWDJhF','call','getHookLinkFor','sfLogger','default','decorate','../../../constants','sleep','../jobs/git-sync.job','GitProviderManager','SyncService','TooManyRequests','../../salesforce/dto/flosum-repository-sync.dto','createHooks','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','toUpperCase','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','salesforceSync','../../hooks/hooks.utils','../../shared/git-provider.manager','error','hooks','SalesforceError','Error','repositoryName','SyncDirection','10002440bxjSYa','direction','__setModuleDefault','../../salesforce/errors/salesforce.error','getOwnPropertyDescriptor','setStatus','Not\x20Synchronized','__createBinding','send','8004040GUPMVS','__esModule','BRANCH_NAME_REGEXP','defineProperty','[INFO]\x20Repository\x20\x22','toLowerCase','__decorate','gitUrl','catch','\x27\x20[','3uVVbQl','convertToSFDX','SalesforceService','get','../../salesforce/services/salesforce.service','branchName','prototype','repoService'];a188_0x74d3=function(){return _0x3d5bd1;};return a188_0x74d3();}const a188_0x38a26e=(function(){let _0x3bfe04=!![];return function(_0x11f21,_0x2d567d){const _0x5abbeb=_0x3bfe04?function(){const _0x506c10=a188_0x2b2f;if(_0x2d567d){const _0x5c7762=_0x2d567d[_0x506c10(0xb5)](_0x11f21,arguments);return _0x2d567d=null,_0x5c7762;}}:function(){};return _0x3bfe04=![],_0x5abbeb;};}()),a188_0x26377a=a188_0x38a26e(this,function(){const _0x5e2a18=a188_0x2b2f;return a188_0x26377a['toString']()[_0x5e2a18(0x11f)]('(((.+)+)+)+$')[_0x5e2a18(0xca)]()[_0x5e2a18(0xce)](a188_0x26377a)['search'](_0x5e2a18(0xbe));});a188_0x26377a();'use strict';var __createBinding=this&&this[a188_0x44e63f(0xfe)]||(Object[a188_0x44e63f(0xc4)]?function(_0x1f8a28,_0x3a0810,_0x336691,_0x459c35){const _0x2daa04=a188_0x44e63f;if(_0x459c35===undefined)_0x459c35=_0x336691;Object[_0x2daa04(0x103)](_0x1f8a28,_0x459c35,{'enumerable':!![],'get':function(){return _0x3a0810[_0x336691];}});}:function(_0x3ce60c,_0x2d40fc,_0x1a63af,_0x5836c0){if(_0x5836c0===undefined)_0x5836c0=_0x1a63af;_0x3ce60c[_0x5836c0]=_0x2d40fc[_0x1a63af];}),__setModuleDefault=this&&this[a188_0x44e63f(0xf9)]||(Object['create']?function(_0x5ec505,_0x30ea68){const _0x283598=a188_0x44e63f;Object[_0x283598(0x103)](_0x5ec505,_0x283598(0xe0),{'enumerable':!![],'value':_0x30ea68});}:function(_0x20f947,_0x31737f){const _0x439bca=a188_0x44e63f;_0x20f947[_0x439bca(0xe0)]=_0x31737f;}),__decorate=this&&this[a188_0x44e63f(0x106)]||function(_0xcac804,_0x5dd736,_0x4cc1ff,_0xf7d0b8){const _0x26c23a=a188_0x44e63f;var _0x1ab2ea=arguments[_0x26c23a(0xd5)],_0x19b0f9=_0x1ab2ea<0x3?_0x5dd736:_0xf7d0b8===null?_0xf7d0b8=Object[_0x26c23a(0xfb)](_0x5dd736,_0x4cc1ff):_0xf7d0b8,_0x441f1b;if(typeof Reflect===_0x26c23a(0xc5)&&typeof Reflect[_0x26c23a(0xe1)]==='function')_0x19b0f9=Reflect[_0x26c23a(0xe1)](_0xcac804,_0x5dd736,_0x4cc1ff,_0xf7d0b8);else{for(var _0x55de3d=_0xcac804[_0x26c23a(0xd5)]-0x1;_0x55de3d>=0x0;_0x55de3d--)if(_0x441f1b=_0xcac804[_0x55de3d])_0x19b0f9=(_0x1ab2ea<0x3?_0x441f1b(_0x19b0f9):_0x1ab2ea>0x3?_0x441f1b(_0x5dd736,_0x4cc1ff,_0x19b0f9):_0x441f1b(_0x5dd736,_0x4cc1ff))||_0x19b0f9;}return _0x1ab2ea>0x3&&_0x19b0f9&&Object[_0x26c23a(0x103)](_0x5dd736,_0x4cc1ff,_0x19b0f9),_0x19b0f9;},__importStar=this&&this[a188_0x44e63f(0xb9)]||function(_0x4a31ae){const _0xfe08ad=a188_0x44e63f;if(_0x4a31ae&&_0x4a31ae[_0xfe08ad(0x101)])return _0x4a31ae;var _0x3a36d7={};if(_0x4a31ae!=null){for(var _0x16ddde in _0x4a31ae)if(_0x16ddde!==_0xfe08ad(0xe0)&&Object[_0xfe08ad(0x110)][_0xfe08ad(0xd6)][_0xfe08ad(0xdd)](_0x4a31ae,_0x16ddde))__createBinding(_0x3a36d7,_0x4a31ae,_0x16ddde);}return __setModuleDefault(_0x3a36d7,_0x4a31ae),_0x3a36d7;},__metadata=this&&this['__metadata']||function(_0xf3c7dc,_0x74a223){const _0x404e00=a188_0x44e63f;if(typeof Reflect==='object'&&typeof Reflect[_0x404e00(0xb0)]==='function')return Reflect['metadata'](_0xf3c7dc,_0x74a223);},SyncService_1;Object[a188_0x44e63f(0x103)](exports,'__esModule',{'value':!![]}),exports[a188_0x44e63f(0xe6)]=void 0x0;const constants_1=require(a188_0x44e63f(0xe2)),core_1=require(a188_0x44e63f(0x114)),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require(a188_0x44e63f(0xe8)),salesforce_error_1=require(a188_0x44e63f(0xfa)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_sync_service_1=require(a188_0x44e63f(0x116)),salesforce_service_1=require(a188_0x44e63f(0x10e)),git_provider_manager_1=require(a188_0x44e63f(0xf0)),utils_1=require(a188_0x44e63f(0xc1)),typedi_1=__importStar(require(a188_0x44e63f(0xaf))),hooks_utils_1=require(a188_0x44e63f(0xef)),git_branch_not_found_error_1=require(a188_0x44e63f(0xc0)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a188_0x44e63f(0xe4));let SyncService=SyncService_1=class SyncService{constructor(_0x1290e8,_0x1380d6,_0xbc3046){const _0x42771a=a188_0x44e63f;this[_0x42771a(0xc9)]=_0x1290e8,this[_0x42771a(0xee)]=_0x1380d6,this[_0x42771a(0x11a)]=_0xbc3046,this[_0x42771a(0xc2)]=new core_1[(_0x42771a(0x120))](SyncService_1[_0x42771a(0x118)]),this[_0x42771a(0xda)]={},this[_0x42771a(0xd7)]=[];}async[a188_0x44e63f(0xd0)](_0x1bd15a,_0x3ae360){const _0xcd2831=a188_0x44e63f;if(_0x3ae360 instanceof git_branch_not_found_error_1[_0xcd2831(0xad)]){await this[_0xcd2831(0xee)][_0xcd2831(0xfc)](_0x1bd15a,_0xcd2831(0xfd));return;}if(_0x3ae360 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0xcd2831(0xee)][_0xcd2831(0xfc)](_0x1bd15a,_0xcd2831(0x11d));throw _0x3ae360;}try{await this[_0xcd2831(0xdf)]['log']('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x1bd15a['repositoryName']+_0xcd2831(0x109)+_0x1bd15a['branchName']+_0xcd2831(0x11b)+_0x3ae360)[_0xcd2831(0xff)](),await this[_0xcd2831(0xee)][_0xcd2831(0x119)](_0x1bd15a,{}),await this[_0xcd2831(0xee)][_0xcd2831(0xfc)](_0x1bd15a,_0xcd2831(0xf4));}catch(_0x129ede){if(_0x129ede instanceof salesforce_error_1[_0xcd2831(0xf3)])throw _0x129ede;}}async[a188_0x44e63f(0xd3)](_0x20b067){const _0x3ebde0=a188_0x44e63f;if(_0x20b067[_0x3ebde0(0xb6)]){const _0x207070=_0x20b067[_0x3ebde0(0xf5)][_0x3ebde0(0x105)](),_0x588c5f=this[_0x3ebde0(0xda)][_0x207070];if(!_0x588c5f)this[_0x3ebde0(0xda)][_0x207070]=_0x20b067[_0x3ebde0(0xf5)];else{if(_0x588c5f&&_0x588c5f!==_0x20b067['repositoryName'])return await this[_0x3ebde0(0xd0)](_0x20b067,new Error(_0x3ebde0(0x11c)+_0x20b067[_0x3ebde0(0xf5)]+_0x3ebde0(0xd2)+_0x207070+_0x3ebde0(0xb2)+_0x588c5f+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x23a340){const _0x3c39c8=a188_0x44e63f;if(!constants_1['REPOSITORY_NAME_REGEXP']['test'](_0x23a340[_0x3c39c8(0xf5)]))return await this['handleRecordSyncError'](_0x23a340,new Error(_0x3c39c8(0x11c)+_0x23a340[_0x3c39c8(0xf5)]+_0x3c39c8(0xb8))),![];if(!constants_1[_0x3c39c8(0x102)]['test'](_0x23a340[_0x3c39c8(0x10f)]))return await this['handleRecordSyncError'](_0x23a340,new Error(_0x3c39c8(0xcb)+_0x23a340[_0x3c39c8(0x10f)]+_0x3c39c8(0xc6)+_0x23a340[_0x3c39c8(0xf5)]+_0x3c39c8(0xed))),![];return!![];}async[a188_0x44e63f(0xcd)](_0x56e1dd,_0x4a2ff8,_0x4fa61a){const _0x39b257=a188_0x44e63f;let _0x54b999=this[_0x39b257(0xd7)][_0x39b257(0xba)](_0x151cce=>_0x56e1dd['repositoryName']===_0x151cce[_0x39b257(0x118)]);!_0x54b999&&(this[_0x39b257(0xdf)][_0x39b257(0xc8)](_0x39b257(0x104)+_0x56e1dd[_0x39b257(0xf5)]+_0x39b257(0x113)),_0x54b999=await this[_0x39b257(0x111)][_0x39b257(0xc4)]({'name':_0x56e1dd[_0x39b257(0xf5)],'autoInit':!![],'defaultBranch':_0x56e1dd[_0x39b257(0x10f)],'private':!![],'createHook':this[_0x39b257(0xd9)][_0x39b257(0xe9)]}));if(this['syncDto'][_0x39b257(0xe9)]){const _0x164e86=await _0x54b999[_0x39b257(0xf2)][_0x39b257(0xae)]();!_0x164e86['find'](_0x274dd3=>_0x274dd3[_0x39b257(0x112)]===hooks_utils_1[_0x39b257(0xb7)][_0x39b257(0xde)](_0x4a2ff8,_0x4fa61a))&&(this[_0x39b257(0xdf)]['log'](_0x39b257(0x104)+_0x56e1dd[_0x39b257(0xf5)]+_0x39b257(0xec)),await _0x54b999[_0x39b257(0xf2)][_0x39b257(0xc4)](hooks_utils_1[_0x39b257(0xb7)]['createHookPayload'](_0x4a2ff8,_0x54b999['hooks'],_0x4fa61a)));}return this[_0x39b257(0xd7)]['push'](_0x54b999),_0x54b999;}async[a188_0x44e63f(0xb3)](_0x336d0c,_0x5256c0,_0x3a1411,_0x12603a){const _0x3b7a13=a188_0x44e63f;this['salesforceService'][_0x3b7a13(0xc3)](_0x5256c0),this['repoService']=this['gitManager'][_0x3b7a13(0xb4)](_0x3a1411),this[_0x3b7a13(0xdf)]=new salesforce_logger_v2_service_1[(_0x3b7a13(0x117))](_0x5256c0,'['+SyncService_1[_0x3b7a13(0x118)]+']\x20['+_0x3a1411[_0x3b7a13(0xeb)]()+']'),this[_0x3b7a13(0xd9)]=_0x336d0c;try{await this['sfLogger'][_0x3b7a13(0xc8)](_0x3b7a13(0xd8))[_0x3b7a13(0xff)]();const [_0x265377,_0x20fbd4]=await Promise['all']([this[_0x3b7a13(0xee)][_0x3b7a13(0xbc)](),this['salesforceSync']['getRepositoryRecords']()]);this['repoList']=await this[_0x3b7a13(0x111)][_0x3b7a13(0xae)]();const _0x1d4470=[..._0x20fbd4,..._0x265377];this[_0x3b7a13(0xc2)][_0x3b7a13(0xc8)](_0x3b7a13(0xcc),_0x1d4470[_0x3b7a13(0xd5)]);for(const _0x270832 of _0x1d4470){this[_0x3b7a13(0xc2)][_0x3b7a13(0xc8)](_0x3b7a13(0x11e),_0x270832[_0x3b7a13(0xf5)],_0x270832['repositoryId'],_0x270832[_0x3b7a13(0x10f)],_0x270832['branchId']);const _0x2486d1=await this['checkValidNaming'](_0x270832);if(!_0x2486d1)continue;const _0x3466c9=await this[_0x3b7a13(0xd3)](_0x270832);if(_0x3466c9)continue;let _0xf2d514;try{_0xf2d514=await this[_0x3b7a13(0xcd)](_0x270832,_0x3a1411,_0x12603a);}catch(_0x3464e1){await this[_0x3b7a13(0xd0)](_0x270832,_0x3464e1 instanceof too_many_requests_error_1[_0x3b7a13(0xe7)]?_0x3464e1:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x3464e1));continue;}await this[_0x3b7a13(0xdf)][_0x3b7a13(0xff)]();if(_0x270832[_0x3b7a13(0xf8)]===flosum_repository_sync_dto_1[_0x3b7a13(0xf6)][_0x3b7a13(0xbf)]){const _0x2f5f1a=typedi_1[_0x3b7a13(0xe0)][_0x3b7a13(0x10d)](flosum_sync_job_1[_0x3b7a13(0xc7)]);await _0x2f5f1a[_0x3b7a13(0xb3)]({'repository':_0xf2d514,'convertToSFDX':_0x336d0c[_0x3b7a13(0x10b)],'syncRecord':_0x270832,'provider':_0x3a1411,'logger':this[_0x3b7a13(0xdf)]})[_0x3b7a13(0x108)](_0x228217=>this[_0x3b7a13(0xd0)](_0x270832,_0x228217));}else{const _0x554473=typedi_1[_0x3b7a13(0xe0)][_0x3b7a13(0x10d)](git_sync_job_1['GitSyncJob']);await _0x554473[_0x3b7a13(0xb3)]({'repository':_0xf2d514,'branch':_0x270832['branchName'],'provider':_0x3a1411,'repositoryGit':_0xf2d514[_0x3b7a13(0x107)],'syncRecord':_0x270832,'logger':this[_0x3b7a13(0xdf)]})[_0x3b7a13(0x108)](_0x53618a=>this[_0x3b7a13(0xd0)](_0x270832,_0x53618a));}}}catch(_0x442e73){this['logger'][_0x3b7a13(0xf1)](_0x442e73);_0x442e73 instanceof too_many_requests_error_1[_0x3b7a13(0xe7)]?(await this[_0x3b7a13(0xdf)]['log'](_0x3b7a13(0xea))[_0x3b7a13(0xff)](),await utils_1[_0x3b7a13(0xe3)](0x3c*0x3c*0x3e8),this['run'](_0x336d0c,_0x5256c0,_0x3a1411,_0x12603a)):await this[_0x3b7a13(0xdf)][_0x3b7a13(0xc8)]('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x442e73)[_0x3b7a13(0xff)]();return;}await this[_0x3b7a13(0xdf)]['log']('[INFO]\x20Sync\x20job\x20done.')[_0x3b7a13(0xff)](),await this[_0x3b7a13(0xee)]['disableSync'](_0x336d0c[_0x3b7a13(0xcf)])[_0x3b7a13(0x108)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x44e63f(0x115)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a188_0x44e63f(0x10c)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a188_0x44e63f(0xe5)]])],SyncService),exports[a188_0x44e63f(0xe6)]=SyncService;