const a188_0x142400=a188_0x1482;(function(_0x47639d,_0x3e132e){const _0x47711a=a188_0x1482,_0x3f8bac=_0x47639d();while(!![]){try{const _0x2dcb29=-parseInt(_0x47711a(0x1b8))/0x1*(-parseInt(_0x47711a(0x1c1))/0x2)+-parseInt(_0x47711a(0x1d2))/0x3+parseInt(_0x47711a(0x1ea))/0x4+parseInt(_0x47711a(0x196))/0x5*(parseInt(_0x47711a(0x1b0))/0x6)+parseInt(_0x47711a(0x1de))/0x7*(-parseInt(_0x47711a(0x1e7))/0x8)+parseInt(_0x47711a(0x1d0))/0x9+parseInt(_0x47711a(0x1e2))/0xa;if(_0x2dcb29===_0x3e132e)break;else _0x3f8bac['push'](_0x3f8bac['shift']());}catch(_0x24bac5){_0x3f8bac['push'](_0x3f8bac['shift']());}}}(a188_0x2f2e,0xcda71));function a188_0x1482(_0x5ea63a,_0x3faf8c){const _0xfc0dfc=a188_0x2f2e();return a188_0x1482=function(_0x27e171,_0x3f0da9){_0x27e171=_0x27e171-0x18b;let _0x2f2ed9=_0xfc0dfc[_0x27e171];return _0x2f2ed9;},a188_0x1482(_0x5ea63a,_0x3faf8c);}function a188_0x2f2e(){const _0x43dfe0=['salesforceSync','createHookPayload','../../shared/utils','[INFO]\x20Start\x20sync\x20job','gitUrl','SalesforceLogger2','decorate','2486KfMrZA','FlosumSyncJob','../../../core/errors/too-many-requests.error','SalesforceError','repositoryName','GitBranchNotFoundError','apply','../../salesforce/services/salesforce-sync.service','getRepoService','[INFO]\x20Sync\x20job\x20done.','GitSyncJob','\x27\x20[','hasOwnProperty','HooksUtils','handleRecordSyncError','5673222JikIrU','syncDto','3208662skNHsB','create','repoList','all','Not\x20Synchronized','../../hooks/hooks.utils','syncID','repositoriesIntersections','\x27\x20-\x20\x27','Error','[INFO]\x20Repository\x20\x22','__setModuleDefault','7826189czqpCA','gitManager','getOwnPropertyDescriptor','convertToSFDX','7982700MpXoWB','SalesforceSyncService','prototype','find','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','8UxiMQW',']\x20[','Unable\x20to\x20synchronize\x20branch\x20\x27','908248KSRvAx','disableSync','sleep','__decorate','Waiting','Service',']\x20due\x20error\x20-\x20','get','push','GitProviderManager','__metadata','function','run','../jobs/git-sync.job','salesforceService','Unable\x20to\x20synchronize\x20repository\x20\x27','send','logger','toString','(((.+)+)+)+$','isIntersects','default','SyncService','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','log','../jobs/flosum-sync.job','constructor','getOrCreateRepo','catch','3484045DplLdu','../../shared/git-provider.manager','setLoggerId','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','../../salesforce/services/salesforce-logger-v2.service','search','updateRemoteState','call','setStatus','object','defineProperty','length','url','../errors/git-branch-not-found.error','getAll','sfLogger','FlosumToGit','repoService','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','error','__esModule','name','../../salesforce/services/salesforce.service','have\x20to\x20synchronize\x20%d\x20branches','TooManyRequests','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','6CVIQEB','../../../core','branchName','hooks','repositoryId','test','../../salesforce/dto/flosum-repository-sync.dto','getHookLinkFor','545duDoPg','design:paramtypes'];a188_0x2f2e=function(){return _0x43dfe0;};return a188_0x2f2e();}const a188_0x3f0da9=(function(){let _0x1da843=!![];return function(_0x40213c,_0x44ef07){const _0x2c0855=_0x1da843?function(){const _0x186b76=a188_0x1482;if(_0x44ef07){const _0x280716=_0x44ef07[_0x186b76(0x1c7)](_0x40213c,arguments);return _0x44ef07=null,_0x280716;}}:function(){};return _0x1da843=![],_0x2c0855;};}()),a188_0x27e171=a188_0x3f0da9(this,function(){const _0x1193cd=a188_0x1482;return a188_0x27e171['toString']()[_0x1193cd(0x19b)](_0x1193cd(0x18c))[_0x1193cd(0x18b)]()[_0x1193cd(0x193)](a188_0x27e171)[_0x1193cd(0x19b)](_0x1193cd(0x18c));});a188_0x27e171();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x322cfd,_0xeb4382,_0x1fa784,_0x557737){const _0xdca196=a188_0x1482;if(_0x557737===undefined)_0x557737=_0x1fa784;Object[_0xdca196(0x1a0)](_0x322cfd,_0x557737,{'enumerable':!![],'get':function(){return _0xeb4382[_0x1fa784];}});}:function(_0x203937,_0x29ac5a,_0x2cd3e7,_0x317725){if(_0x317725===undefined)_0x317725=_0x2cd3e7;_0x203937[_0x317725]=_0x29ac5a[_0x2cd3e7];}),__setModuleDefault=this&&this[a188_0x142400(0x1dd)]||(Object[a188_0x142400(0x1d3)]?function(_0x2d39c9,_0x3191b5){const _0x3a4633=a188_0x142400;Object[_0x3a4633(0x1a0)](_0x2d39c9,_0x3a4633(0x18e),{'enumerable':!![],'value':_0x3191b5});}:function(_0x34f7fa,_0x22277d){const _0x3de245=a188_0x142400;_0x34f7fa[_0x3de245(0x18e)]=_0x22277d;}),__decorate=this&&this[a188_0x142400(0x1ed)]||function(_0x38fc87,_0x277f05,_0x53e819,_0x3d851b){const _0x2fd439=a188_0x142400;var _0x1a5cc5=arguments[_0x2fd439(0x1a1)],_0x545de3=_0x1a5cc5<0x3?_0x277f05:_0x3d851b===null?_0x3d851b=Object[_0x2fd439(0x1e0)](_0x277f05,_0x53e819):_0x3d851b,_0x2b6e75;if(typeof Reflect===_0x2fd439(0x19f)&&typeof Reflect[_0x2fd439(0x1c0)]===_0x2fd439(0x1f5))_0x545de3=Reflect[_0x2fd439(0x1c0)](_0x38fc87,_0x277f05,_0x53e819,_0x3d851b);else{for(var _0x5e0ebc=_0x38fc87[_0x2fd439(0x1a1)]-0x1;_0x5e0ebc>=0x0;_0x5e0ebc--)if(_0x2b6e75=_0x38fc87[_0x5e0ebc])_0x545de3=(_0x1a5cc5<0x3?_0x2b6e75(_0x545de3):_0x1a5cc5>0x3?_0x2b6e75(_0x277f05,_0x53e819,_0x545de3):_0x2b6e75(_0x277f05,_0x53e819))||_0x545de3;}return _0x1a5cc5>0x3&&_0x545de3&&Object[_0x2fd439(0x1a0)](_0x277f05,_0x53e819,_0x545de3),_0x545de3;},__importStar=this&&this['__importStar']||function(_0x3dee3f){const _0x45dbd6=a188_0x142400;if(_0x3dee3f&&_0x3dee3f[_0x45dbd6(0x1aa)])return _0x3dee3f;var _0x5a44d6={};if(_0x3dee3f!=null){for(var _0x4145a6 in _0x3dee3f)if(_0x4145a6!==_0x45dbd6(0x18e)&&Object[_0x45dbd6(0x1e4)][_0x45dbd6(0x1cd)][_0x45dbd6(0x19d)](_0x3dee3f,_0x4145a6))__createBinding(_0x5a44d6,_0x3dee3f,_0x4145a6);}return __setModuleDefault(_0x5a44d6,_0x3dee3f),_0x5a44d6;},__metadata=this&&this[a188_0x142400(0x1f4)]||function(_0x4304ce,_0x1f1d64){const _0x1a1141=a188_0x142400;if(typeof Reflect===_0x1a1141(0x19f)&&typeof Reflect['metadata']===_0x1a1141(0x1f5))return Reflect['metadata'](_0x4304ce,_0x1f1d64);},SyncService_1;Object[a188_0x142400(0x1a0)](exports,a188_0x142400(0x1aa),{'value':!![]}),exports['SyncService']=void 0x0;const constants_1=require('../../../constants'),core_1=require(a188_0x142400(0x1b1)),too_many_requests_error_1=require(a188_0x142400(0x1c3)),flosum_repository_sync_dto_1=require(a188_0x142400(0x1b6)),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_logger_v2_service_1=require(a188_0x142400(0x19a)),salesforce_sync_service_1=require(a188_0x142400(0x1c8)),salesforce_service_1=require(a188_0x142400(0x1ac)),git_provider_manager_1=require(a188_0x142400(0x197)),utils_1=require(a188_0x142400(0x1bc)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a188_0x142400(0x1d7)),git_branch_not_found_error_1=require(a188_0x142400(0x1a3)),flosum_sync_job_1=require(a188_0x142400(0x192)),git_sync_job_1=require(a188_0x142400(0x1f7));let SyncService=SyncService_1=class SyncService{constructor(_0x9ce700,_0x2ed06f,_0xb1caa6){const _0x375ebe=a188_0x142400;this[_0x375ebe(0x1f8)]=_0x9ce700,this['salesforceSync']=_0x2ed06f,this['gitManager']=_0xb1caa6,this[_0x375ebe(0x1fb)]=new core_1['Logger'](SyncService_1[_0x375ebe(0x1ab)]),this[_0x375ebe(0x1d9)]={},this[_0x375ebe(0x1d4)]=[];}async[a188_0x142400(0x1cf)](_0x102bfc,_0x47fdad){const _0x12ea6c=a188_0x142400;if(_0x47fdad instanceof git_branch_not_found_error_1[_0x12ea6c(0x1c6)]){await this[_0x12ea6c(0x1ba)][_0x12ea6c(0x19e)](_0x102bfc,_0x12ea6c(0x1d6));return;}if(_0x47fdad instanceof too_many_requests_error_1[_0x12ea6c(0x1ae)]){await this[_0x12ea6c(0x1ba)][_0x12ea6c(0x19e)](_0x102bfc,_0x12ea6c(0x1ee));throw _0x47fdad;}try{await this[_0x12ea6c(0x1a5)][_0x12ea6c(0x191)](_0x12ea6c(0x199)+_0x102bfc['repositoryName']+_0x12ea6c(0x1cc)+_0x102bfc['branchName']+_0x12ea6c(0x1f0)+_0x47fdad)['send'](),await this[_0x12ea6c(0x1ba)][_0x12ea6c(0x19c)](_0x102bfc,{}),await this[_0x12ea6c(0x1ba)]['setStatus'](_0x102bfc,_0x12ea6c(0x1db));}catch(_0x5a6247){if(_0x5a6247 instanceof salesforce_error_1[_0x12ea6c(0x1c4)])throw _0x5a6247;}}async[a188_0x142400(0x18d)](_0x35d478){const _0xd6dfc2=a188_0x142400;if(_0x35d478[_0xd6dfc2(0x1b4)]){const _0x1cd728=_0x35d478['repositoryName']['toLowerCase'](),_0x567e0e=this[_0xd6dfc2(0x1d9)][_0x1cd728];if(!_0x567e0e)this[_0xd6dfc2(0x1d9)][_0x1cd728]=_0x35d478[_0xd6dfc2(0x1c5)];else{if(_0x567e0e&&_0x567e0e!==_0x35d478[_0xd6dfc2(0x1c5)])return await this[_0xd6dfc2(0x1cf)](_0x35d478,new Error(_0xd6dfc2(0x1f9)+_0x35d478[_0xd6dfc2(0x1c5)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x1cd728+_0xd6dfc2(0x1da)+_0x567e0e+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x39a4e9){const _0x537860=a188_0x142400;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x537860(0x1b5)](_0x39a4e9['repositoryName']))return await this[_0x537860(0x1cf)](_0x39a4e9,new Error(_0x537860(0x1f9)+_0x39a4e9[_0x537860(0x1c5)]+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x537860(0x1b5)](_0x39a4e9[_0x537860(0x1b2)]))return await this[_0x537860(0x1cf)](_0x39a4e9,new Error(_0x537860(0x1e9)+_0x39a4e9[_0x537860(0x1b2)]+'\x27\x20in\x20repository\x20\x27'+_0x39a4e9[_0x537860(0x1c5)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async['getOrCreateRepo'](_0x443056,_0x496141,_0x4fd0b0){const _0x16e176=a188_0x142400;let _0x1159a8=this['repoList'][_0x16e176(0x1e5)](_0xe17bc9=>_0x443056['repositoryName']===_0xe17bc9['name']);!_0x1159a8&&(this['sfLogger'][_0x16e176(0x191)](_0x16e176(0x1dc)+_0x443056[_0x16e176(0x1c5)]+_0x16e176(0x1e6)),_0x1159a8=await this[_0x16e176(0x1a7)][_0x16e176(0x1d3)]({'name':_0x443056[_0x16e176(0x1c5)],'autoInit':!![],'defaultBranch':_0x443056['branchName'],'private':!![],'createHook':this[_0x16e176(0x1d1)]['createHooks']}));if(this[_0x16e176(0x1d1)]['createHooks']){const _0x5d8aad=await _0x1159a8[_0x16e176(0x1b3)][_0x16e176(0x1a4)]();!_0x5d8aad[_0x16e176(0x1e5)](_0x35c0cd=>_0x35c0cd[_0x16e176(0x1a2)]===hooks_utils_1[_0x16e176(0x1ce)][_0x16e176(0x1b7)](_0x496141,_0x4fd0b0))&&(this[_0x16e176(0x1a5)][_0x16e176(0x191)](_0x16e176(0x1dc)+_0x443056[_0x16e176(0x1c5)]+_0x16e176(0x1a8)),await _0x1159a8[_0x16e176(0x1b3)][_0x16e176(0x1d3)](hooks_utils_1[_0x16e176(0x1ce)][_0x16e176(0x1bb)](_0x496141,_0x1159a8[_0x16e176(0x1b3)],_0x4fd0b0)));}return this[_0x16e176(0x1d4)][_0x16e176(0x1f2)](_0x1159a8),_0x1159a8;}async[a188_0x142400(0x1f6)](_0x28849a,_0x56b694,_0x5715b5,_0x3286b1){const _0x4560bf=a188_0x142400;this['salesforceService'][_0x4560bf(0x198)](_0x56b694),this[_0x4560bf(0x1a7)]=this[_0x4560bf(0x1df)][_0x4560bf(0x1c9)](_0x5715b5),this[_0x4560bf(0x1a5)]=new salesforce_logger_v2_service_1[(_0x4560bf(0x1bf))](_0x56b694,'['+SyncService_1[_0x4560bf(0x1ab)]+_0x4560bf(0x1e8)+_0x5715b5['toUpperCase']()+']'),this[_0x4560bf(0x1d1)]=_0x28849a;try{await this[_0x4560bf(0x1a5)][_0x4560bf(0x191)](_0x4560bf(0x1bd))['send']();const [_0x26b439,_0x437c6c]=await Promise[_0x4560bf(0x1d5)]([this[_0x4560bf(0x1ba)]['getBranchRecords'](),this[_0x4560bf(0x1ba)]['getRepositoryRecords']()]);this[_0x4560bf(0x1d4)]=await this[_0x4560bf(0x1a7)]['getAll']();const _0x4d806c=[..._0x437c6c,..._0x26b439];this['logger']['log'](_0x4560bf(0x1ad),_0x4d806c[_0x4560bf(0x1a1)]);for(const _0x36c932 of _0x4d806c){this[_0x4560bf(0x1fb)]['log'](_0x4560bf(0x1af),_0x36c932[_0x4560bf(0x1c5)],_0x36c932[_0x4560bf(0x1b4)],_0x36c932[_0x4560bf(0x1b2)],_0x36c932['branchId']);const _0x541eb8=await this['checkValidNaming'](_0x36c932);if(!_0x541eb8)continue;const _0x5f017d=await this['isIntersects'](_0x36c932);if(_0x5f017d)continue;let _0x20926d;try{_0x20926d=await this[_0x4560bf(0x194)](_0x36c932,_0x5715b5,_0x3286b1);}catch(_0x2320ba){await this[_0x4560bf(0x1cf)](_0x36c932,_0x2320ba instanceof too_many_requests_error_1['TooManyRequests']?_0x2320ba:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x2320ba));continue;}await this[_0x4560bf(0x1a5)][_0x4560bf(0x1fa)]();if(_0x36c932['direction']===flosum_repository_sync_dto_1['SyncDirection'][_0x4560bf(0x1a6)]){const _0x24f1b1=typedi_1[_0x4560bf(0x18e)]['get'](flosum_sync_job_1[_0x4560bf(0x1c2)]);await _0x24f1b1[_0x4560bf(0x1f6)]({'repository':_0x20926d,'convertToSFDX':_0x28849a[_0x4560bf(0x1e1)],'syncRecord':_0x36c932,'provider':_0x5715b5,'logger':this['sfLogger']})[_0x4560bf(0x195)](_0x26fd4e=>this[_0x4560bf(0x1cf)](_0x36c932,_0x26fd4e));}else{const _0x1fff8a=typedi_1['default'][_0x4560bf(0x1f1)](git_sync_job_1[_0x4560bf(0x1cb)]);await _0x1fff8a[_0x4560bf(0x1f6)]({'repository':_0x20926d,'branch':_0x36c932[_0x4560bf(0x1b2)],'provider':_0x5715b5,'repositoryGit':_0x20926d[_0x4560bf(0x1be)],'syncRecord':_0x36c932,'logger':this[_0x4560bf(0x1a5)]})['catch'](_0x2aea52=>this[_0x4560bf(0x1cf)](_0x36c932,_0x2aea52));}}}catch(_0x212b07){this[_0x4560bf(0x1fb)][_0x4560bf(0x1a9)](_0x212b07);_0x212b07 instanceof too_many_requests_error_1[_0x4560bf(0x1ae)]?(await this[_0x4560bf(0x1a5)]['log']('[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')[_0x4560bf(0x1fa)](),await utils_1[_0x4560bf(0x1ec)](0x3c*0x3c*0x3e8),this[_0x4560bf(0x1f6)](_0x28849a,_0x56b694,_0x5715b5,_0x3286b1)):await this[_0x4560bf(0x1a5)][_0x4560bf(0x191)](_0x4560bf(0x190)+_0x212b07)[_0x4560bf(0x1fa)]();return;}await this[_0x4560bf(0x1a5)][_0x4560bf(0x191)](_0x4560bf(0x1ca))['send'](),await this[_0x4560bf(0x1ba)][_0x4560bf(0x1eb)](_0x28849a[_0x4560bf(0x1d8)])['catch'](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x142400(0x1ef)]({'transient':!![]}),__metadata(a188_0x142400(0x1b9),[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a188_0x142400(0x1e3)],git_provider_manager_1[a188_0x142400(0x1f3)]])],SyncService),exports[a188_0x142400(0x18f)]=SyncService;