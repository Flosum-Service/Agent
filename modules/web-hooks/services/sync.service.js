function a187_0x2746(_0x30b33d,_0x31ca42){const _0x4e6d0e=a187_0x45ae();return a187_0x2746=function(_0x3e20e5,_0x25161b){_0x3e20e5=_0x3e20e5-0x90;let _0x45ae9e=_0x4e6d0e[_0x3e20e5];return _0x45ae9e;},a187_0x2746(_0x30b33d,_0x31ca42);}const a187_0x5cf4b1=a187_0x2746;(function(_0xa72b3,_0x5518d1){const _0x295c3e=a187_0x2746,_0x2712cf=_0xa72b3();while(!![]){try{const _0x831fb5=-parseInt(_0x295c3e(0xb2))/0x1+parseInt(_0x295c3e(0xc9))/0x2*(parseInt(_0x295c3e(0xc0))/0x3)+-parseInt(_0x295c3e(0xcb))/0x4+-parseInt(_0x295c3e(0x9b))/0x5*(-parseInt(_0x295c3e(0xd3))/0x6)+-parseInt(_0x295c3e(0xb5))/0x7*(-parseInt(_0x295c3e(0xdd))/0x8)+parseInt(_0x295c3e(0xef))/0x9*(-parseInt(_0x295c3e(0xd0))/0xa)+parseInt(_0x295c3e(0x9f))/0xb;if(_0x831fb5===_0x5518d1)break;else _0x2712cf['push'](_0x2712cf['shift']());}catch(_0x6d7b13){_0x2712cf['push'](_0x2712cf['shift']());}}}(a187_0x45ae,0x4ed88));const a187_0x25161b=(function(){let _0x3af899=!![];return function(_0x36d8bf,_0x226fe9){const _0x2b540b=_0x3af899?function(){const _0x47b613=a187_0x2746;if(_0x226fe9){const _0x4966f6=_0x226fe9[_0x47b613(0xff)](_0x36d8bf,arguments);return _0x226fe9=null,_0x4966f6;}}:function(){};return _0x3af899=![],_0x2b540b;};}()),a187_0x3e20e5=a187_0x25161b(this,function(){const _0x5b201b=a187_0x2746;return a187_0x3e20e5[_0x5b201b(0x92)]()[_0x5b201b(0xca)](_0x5b201b(0xb4))[_0x5b201b(0x92)]()[_0x5b201b(0x93)](a187_0x3e20e5)[_0x5b201b(0xca)]('(((.+)+)+)+$');});a187_0x3e20e5();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x534da3,_0x352670,_0x1c5ed4,_0x2ff96){if(_0x2ff96===undefined)_0x2ff96=_0x1c5ed4;Object['defineProperty'](_0x534da3,_0x2ff96,{'enumerable':!![],'get':function(){return _0x352670[_0x1c5ed4];}});}:function(_0x2553e6,_0x3acdd2,_0x3c7510,_0x4c4403){if(_0x4c4403===undefined)_0x4c4403=_0x3c7510;_0x2553e6[_0x4c4403]=_0x3acdd2[_0x3c7510];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0xf5fb1f,_0x4775c2){const _0x580b41=a187_0x2746;Object['defineProperty'](_0xf5fb1f,_0x580b41(0xe9),{'enumerable':!![],'value':_0x4775c2});}:function(_0x3d3e2a,_0x801bcc){const _0x41087c=a187_0x2746;_0x3d3e2a[_0x41087c(0xe9)]=_0x801bcc;}),__decorate=this&&this[a187_0x5cf4b1(0xda)]||function(_0x4c0367,_0x4d0d37,_0x1ab152,_0x20e534){const _0x237cc2=a187_0x5cf4b1;var _0x13f042=arguments[_0x237cc2(0x9c)],_0x5b1559=_0x13f042<0x3?_0x4d0d37:_0x20e534===null?_0x20e534=Object[_0x237cc2(0xd4)](_0x4d0d37,_0x1ab152):_0x20e534,_0x3140db;if(typeof Reflect===_0x237cc2(0xc2)&&typeof Reflect[_0x237cc2(0xa7)]==='function')_0x5b1559=Reflect[_0x237cc2(0xa7)](_0x4c0367,_0x4d0d37,_0x1ab152,_0x20e534);else{for(var _0x573c47=_0x4c0367['length']-0x1;_0x573c47>=0x0;_0x573c47--)if(_0x3140db=_0x4c0367[_0x573c47])_0x5b1559=(_0x13f042<0x3?_0x3140db(_0x5b1559):_0x13f042>0x3?_0x3140db(_0x4d0d37,_0x1ab152,_0x5b1559):_0x3140db(_0x4d0d37,_0x1ab152))||_0x5b1559;}return _0x13f042>0x3&&_0x5b1559&&Object[_0x237cc2(0xfd)](_0x4d0d37,_0x1ab152,_0x5b1559),_0x5b1559;},__importStar=this&&this[a187_0x5cf4b1(0x98)]||function(_0x29e231){const _0xff0496=a187_0x5cf4b1;if(_0x29e231&&_0x29e231['__esModule'])return _0x29e231;var _0x574e01={};if(_0x29e231!=null){for(var _0x2c80a0 in _0x29e231)if(_0x2c80a0!==_0xff0496(0xe9)&&Object[_0xff0496(0xbd)][_0xff0496(0xb8)]['call'](_0x29e231,_0x2c80a0))__createBinding(_0x574e01,_0x29e231,_0x2c80a0);}return __setModuleDefault(_0x574e01,_0x29e231),_0x574e01;},__metadata=this&&this[a187_0x5cf4b1(0xd9)]||function(_0x3157c0,_0x226974){const _0x1466d7=a187_0x5cf4b1;if(typeof Reflect==='object'&&typeof Reflect[_0x1466d7(0xed)]===_0x1466d7(0xad))return Reflect[_0x1466d7(0xed)](_0x3157c0,_0x226974);},SyncService_1;Object[a187_0x5cf4b1(0xfd)](exports,a187_0x5cf4b1(0x100),{'value':!![]}),exports[a187_0x5cf4b1(0xd6)]=void 0x0;const constants_1=require(a187_0x5cf4b1(0xd7)),core_1=require(a187_0x5cf4b1(0x101)),too_many_requests_error_1=require(a187_0x5cf4b1(0xf9)),flosum_repository_sync_dto_1=require(a187_0x5cf4b1(0xc3)),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_logger_v2_service_1=require(a187_0x5cf4b1(0xa3)),salesforce_sync_service_1=require(a187_0x5cf4b1(0xa6)),salesforce_service_1=require(a187_0x5cf4b1(0xb7)),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a187_0x5cf4b1(0xa0)),typedi_1=__importStar(require(a187_0x5cf4b1(0xa5))),hooks_utils_1=require(a187_0x5cf4b1(0xf5)),git_branch_not_found_error_1=require(a187_0x5cf4b1(0xbb)),flosum_sync_job_1=require(a187_0x5cf4b1(0xc8)),git_sync_job_1=require(a187_0x5cf4b1(0xdc));function a187_0x45ae(){const _0x542eeb=['190kJphzq','getRepoService','repositoryId','11274DExvcX','getOwnPropertyDescriptor','getAll','SyncService','../../../constants',']\x20due\x20error\x20-\x20','__metadata','__decorate','catch','../jobs/git-sync.job','279632RutuNM','Not\x20Synchronized','updateRemoteState','Unable\x20to\x20synchronize\x20branch\x20\x27','gitUrl','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','setStatus','SalesforceService','test','syncDto','repoList','getBranchRecords','default','\x27\x20[','gitManager','repositoryName','metadata','Unable\x20to\x20synchronize\x20repository\x20\x27','202635wnqGum','sfLogger','name','createHooks','Service','isIntersects','../../hooks/hooks.utils','create','salesforceService','salesforceSync','../../../core/errors/too-many-requests.error','all','sleep','FlosumToGit','defineProperty','handleRecordSyncError','apply','__esModule','../../../core','GitSyncJob','BRANCH_NAME_REGEXP','toString','constructor','\x27\x20-\x20\x27','design:paramtypes','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','url','__importStar','GitBranchNotFoundError','branchId','45dWUnRW','length','hooks','get','6490803moHooN','../../shared/utils','toLowerCase','SalesforceError','../../salesforce/services/salesforce-logger-v2.service','Waiting','typedi','../../salesforce/services/salesforce-sync.service','decorate','getOrCreateRepo','run','\x27\x20in\x20repository\x20\x27','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','branchName','function','repoService','[INFO]\x20Start\x20sync\x20job','TooManyRequests','Error','629556yGnoRp','log','(((.+)+)+)+$','98eeIJue','toUpperCase','../../salesforce/services/salesforce.service','hasOwnProperty','send','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','../errors/git-branch-not-found.error',']\x20[','prototype','getHookLinkFor','find','10932pYRaoa','SyncDirection','object','../../salesforce/dto/flosum-repository-sync.dto','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','checkValidNaming','convertToSFDX','logger','../jobs/flosum-sync.job','314fBxMHd','search','1152620hWCsWa','FlosumSyncJob','HooksUtils','error','repositoriesIntersections'];a187_0x45ae=function(){return _0x542eeb;};return a187_0x45ae();}let SyncService=SyncService_1=class SyncService{constructor(_0x4ee863,_0x53f8f2,_0xbfbe95){const _0x1b49ed=a187_0x5cf4b1;this[_0x1b49ed(0xf7)]=_0x4ee863,this[_0x1b49ed(0xf8)]=_0x53f8f2,this[_0x1b49ed(0xeb)]=_0xbfbe95,this['logger']=new core_1['Logger'](SyncService_1[_0x1b49ed(0xf1)]),this[_0x1b49ed(0xcf)]={},this[_0x1b49ed(0xe7)]=[];}async[a187_0x5cf4b1(0xfe)](_0x4592e1,_0x59434c){const _0x11ed1a=a187_0x5cf4b1;if(_0x59434c instanceof git_branch_not_found_error_1[_0x11ed1a(0x99)]){await this[_0x11ed1a(0xf8)][_0x11ed1a(0xe3)](_0x4592e1,_0x11ed1a(0xde));return;}if(_0x59434c instanceof too_many_requests_error_1[_0x11ed1a(0xb0)]){await this[_0x11ed1a(0xf8)]['setStatus'](_0x4592e1,_0x11ed1a(0xa4));throw _0x59434c;}try{await this['sfLogger'][_0x11ed1a(0xb3)]('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x4592e1[_0x11ed1a(0xec)]+_0x11ed1a(0xea)+_0x4592e1[_0x11ed1a(0xac)]+_0x11ed1a(0xd8)+_0x59434c)[_0x11ed1a(0xb9)](),await this['salesforceSync'][_0x11ed1a(0xdf)](_0x4592e1,{}),await this[_0x11ed1a(0xf8)][_0x11ed1a(0xe3)](_0x4592e1,_0x11ed1a(0xb1));}catch(_0x4c4218){if(_0x4c4218 instanceof salesforce_error_1[_0x11ed1a(0xa2)])throw _0x4c4218;}}async[a187_0x5cf4b1(0xf4)](_0x3816c4){const _0x29ff99=a187_0x5cf4b1;if(_0x3816c4['repositoryId']){const _0x389dd3=_0x3816c4['repositoryName'][_0x29ff99(0xa1)](),_0x5dd9de=this['repositoriesIntersections'][_0x389dd3];if(!_0x5dd9de)this[_0x29ff99(0xcf)][_0x389dd3]=_0x3816c4[_0x29ff99(0xec)];else{if(_0x5dd9de&&_0x5dd9de!==_0x3816c4[_0x29ff99(0xec)])return await this[_0x29ff99(0xfe)](_0x3816c4,new Error(_0x29ff99(0xee)+_0x3816c4[_0x29ff99(0xec)]+_0x29ff99(0xba)+_0x389dd3+_0x29ff99(0x94)+_0x5dd9de+'\x27')),!![];}}return![];}async[a187_0x5cf4b1(0xc5)](_0x4911ab){const _0x1b661b=a187_0x5cf4b1;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x1b661b(0xe5)](_0x4911ab[_0x1b661b(0xec)]))return await this[_0x1b661b(0xfe)](_0x4911ab,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x4911ab[_0x1b661b(0xec)]+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1[_0x1b661b(0x91)][_0x1b661b(0xe5)](_0x4911ab[_0x1b661b(0xac)]))return await this[_0x1b661b(0xfe)](_0x4911ab,new Error(_0x1b661b(0xe0)+_0x4911ab['branchName']+_0x1b661b(0xaa)+_0x4911ab[_0x1b661b(0xec)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a187_0x5cf4b1(0xa8)](_0x40965e,_0x34f2fb,_0xf5dd35){const _0x14919f=a187_0x5cf4b1;let _0x2e2807=this[_0x14919f(0xe7)][_0x14919f(0xbf)](_0x4e9560=>_0x40965e['repositoryName']===_0x4e9560[_0x14919f(0xf1)]);!_0x2e2807&&(this[_0x14919f(0xf0)][_0x14919f(0xb3)]('[INFO]\x20Repository\x20\x22'+_0x40965e[_0x14919f(0xec)]+_0x14919f(0xe2)),_0x2e2807=await this[_0x14919f(0xae)][_0x14919f(0xf6)]({'name':_0x40965e[_0x14919f(0xec)],'autoInit':!![],'defaultBranch':_0x40965e['branchName'],'private':!![],'createHook':this[_0x14919f(0xe6)]['createHooks']}));if(this[_0x14919f(0xe6)][_0x14919f(0xf2)]){const _0x33c39f=await _0x2e2807[_0x14919f(0x9d)][_0x14919f(0xd5)]();!_0x33c39f[_0x14919f(0xbf)](_0x30fd31=>_0x30fd31[_0x14919f(0x97)]===hooks_utils_1[_0x14919f(0xcd)][_0x14919f(0xbe)](_0x34f2fb,_0xf5dd35))&&(this[_0x14919f(0xf0)][_0x14919f(0xb3)]('[INFO]\x20Repository\x20\x22'+_0x40965e[_0x14919f(0xec)]+'\x22\x20does\x20not\x20has\x20the\x20agent\x20webhook.\x20Creating\x20a\x20new\x20one.'),await _0x2e2807[_0x14919f(0x9d)][_0x14919f(0xf6)](hooks_utils_1[_0x14919f(0xcd)]['createHookPayload'](_0x34f2fb,_0x2e2807[_0x14919f(0x9d)],_0xf5dd35)));}return this[_0x14919f(0xe7)]['push'](_0x2e2807),_0x2e2807;}async['run'](_0x36c81d,_0x3a717f,_0x5c6f4d,_0x4fec79){const _0x167921=a187_0x5cf4b1;this[_0x167921(0xf7)]['setLoggerId'](_0x3a717f),this['repoService']=this[_0x167921(0xeb)][_0x167921(0xd1)](_0x5c6f4d),this[_0x167921(0xf0)]=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x3a717f,'['+SyncService_1[_0x167921(0xf1)]+_0x167921(0xbc)+_0x5c6f4d[_0x167921(0xb6)]()+']'),this[_0x167921(0xe6)]=_0x36c81d;try{await this[_0x167921(0xf0)]['log'](_0x167921(0xaf))[_0x167921(0xb9)]();const [_0x2843ad,_0x8167f4]=await Promise[_0x167921(0xfa)]([this[_0x167921(0xf8)][_0x167921(0xe8)](),this[_0x167921(0xf8)]['getRepositoryRecords']()]);this[_0x167921(0xe7)]=await this['repoService'][_0x167921(0xd5)]();const _0x3955d0=[..._0x8167f4,..._0x2843ad];this[_0x167921(0xc7)][_0x167921(0xb3)]('have\x20to\x20synchronize\x20%d\x20branches',_0x3955d0[_0x167921(0x9c)]);for(const _0x4a2d13 of _0x3955d0){this['logger'][_0x167921(0xb3)](_0x167921(0xc4),_0x4a2d13[_0x167921(0xec)],_0x4a2d13[_0x167921(0xd2)],_0x4a2d13['branchName'],_0x4a2d13[_0x167921(0x9a)]);const _0x4d6a51=await this[_0x167921(0xc5)](_0x4a2d13);if(!_0x4d6a51)continue;const _0x2a7946=await this['isIntersects'](_0x4a2d13);if(_0x2a7946)continue;let _0x2eae46;try{_0x2eae46=await this[_0x167921(0xa8)](_0x4a2d13,_0x5c6f4d,_0x4fec79);}catch(_0x3f5239){await this[_0x167921(0xfe)](_0x4a2d13,_0x3f5239 instanceof too_many_requests_error_1['TooManyRequests']?_0x3f5239:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x3f5239));continue;}await this[_0x167921(0xf0)][_0x167921(0xb9)]();if(_0x4a2d13['direction']===flosum_repository_sync_dto_1[_0x167921(0xc1)][_0x167921(0xfc)]){const _0x4ecf8e=typedi_1[_0x167921(0xe9)][_0x167921(0x9e)](flosum_sync_job_1[_0x167921(0xcc)]);await _0x4ecf8e[_0x167921(0xa9)]({'repository':_0x2eae46,'convertToSFDX':_0x36c81d[_0x167921(0xc6)],'syncRecord':_0x4a2d13,'provider':_0x5c6f4d,'logger':this[_0x167921(0xf0)]})['catch'](_0x474395=>this[_0x167921(0xfe)](_0x4a2d13,_0x474395));}else{const _0x2cec85=typedi_1[_0x167921(0xe9)][_0x167921(0x9e)](git_sync_job_1[_0x167921(0x90)]);await _0x2cec85['run']({'repository':_0x2eae46,'branch':_0x4a2d13['branchName'],'provider':_0x5c6f4d,'repositoryGit':_0x2eae46[_0x167921(0xe1)],'syncRecord':_0x4a2d13,'logger':this[_0x167921(0xf0)]})[_0x167921(0xdb)](_0x5b0b4d=>this[_0x167921(0xfe)](_0x4a2d13,_0x5b0b4d));}}}catch(_0x371775){this[_0x167921(0xc7)][_0x167921(0xce)](_0x371775);_0x371775 instanceof too_many_requests_error_1[_0x167921(0xb0)]?(await this[_0x167921(0xf0)][_0x167921(0xb3)](_0x167921(0x96))['send'](),await utils_1[_0x167921(0xfb)](0x3c*0x3c*0x3e8),this[_0x167921(0xa9)](_0x36c81d,_0x3a717f,_0x5c6f4d,_0x4fec79)):await this['sfLogger'][_0x167921(0xb3)](_0x167921(0xab)+_0x371775)[_0x167921(0xb9)]();return;}await this[_0x167921(0xf0)][_0x167921(0xb3)]('[INFO]\x20Sync\x20job\x20done.')[_0x167921(0xb9)](),await this[_0x167921(0xf8)]['disableSync'](_0x36c81d['syncID'])[_0x167921(0xdb)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a187_0x5cf4b1(0xf3)]({'transient':!![]}),__metadata(a187_0x5cf4b1(0x95),[salesforce_service_1[a187_0x5cf4b1(0xe4)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1['GitProviderManager']])],SyncService),exports['SyncService']=SyncService;