const a188_0x29f942=a188_0x2bca;(function(_0x1532de,_0x2d0ea8){const _0x45f517=a188_0x2bca,_0x4d1a68=_0x1532de();while(!![]){try{const _0x47b0e1=parseInt(_0x45f517(0x10d))/0x1*(parseInt(_0x45f517(0xca))/0x2)+parseInt(_0x45f517(0x109))/0x3*(parseInt(_0x45f517(0xd4))/0x4)+parseInt(_0x45f517(0xae))/0x5*(-parseInt(_0x45f517(0xab))/0x6)+parseInt(_0x45f517(0xc4))/0x7+parseInt(_0x45f517(0x102))/0x8*(-parseInt(_0x45f517(0xe7))/0x9)+-parseInt(_0x45f517(0xdf))/0xa*(-parseInt(_0x45f517(0xda))/0xb)+-parseInt(_0x45f517(0xbb))/0xc*(parseInt(_0x45f517(0xe2))/0xd);if(_0x47b0e1===_0x2d0ea8)break;else _0x4d1a68['push'](_0x4d1a68['shift']());}catch(_0x1788ed){_0x4d1a68['push'](_0x4d1a68['shift']());}}}(a188_0x566c,0x7191c));const a188_0x339b36=(function(){let _0x136399=!![];return function(_0x3da30e,_0x3c8277){const _0x316bec=_0x136399?function(){const _0x5b7776=a188_0x2bca;if(_0x3c8277){const _0x369f9c=_0x3c8277[_0x5b7776(0xd9)](_0x3da30e,arguments);return _0x3c8277=null,_0x369f9c;}}:function(){};return _0x136399=![],_0x316bec;};}()),a188_0x1a607d=a188_0x339b36(this,function(){const _0x5ad866=a188_0x2bca;return a188_0x1a607d['toString']()[_0x5ad866(0xf8)](_0x5ad866(0xea))[_0x5ad866(0xd0)]()[_0x5ad866(0xf6)](a188_0x1a607d)[_0x5ad866(0xf8)](_0x5ad866(0xea));});function a188_0x2bca(_0x206199,_0x1adf11){const _0x549045=a188_0x566c();return a188_0x2bca=function(_0x1a607d,_0x339b36){_0x1a607d=_0x1a607d-0xa1;let _0x566cc5=_0x549045[_0x1a607d];return _0x566cc5;},a188_0x2bca(_0x206199,_0x1adf11);}a188_0x1a607d();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a188_0x29f942(0xe8)]?function(_0x4d5b95,_0x45f172,_0x2da0a7,_0x1dc024){const _0x4e43a7=a188_0x29f942;if(_0x1dc024===undefined)_0x1dc024=_0x2da0a7;Object[_0x4e43a7(0x104)](_0x4d5b95,_0x1dc024,{'enumerable':!![],'get':function(){return _0x45f172[_0x2da0a7];}});}:function(_0x24129f,_0x3375e4,_0x30ada4,_0x1c273c){if(_0x1c273c===undefined)_0x1c273c=_0x30ada4;_0x24129f[_0x1c273c]=_0x3375e4[_0x30ada4];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0xbfe644,_0x56ab5e){const _0x1883a5=a188_0x29f942;Object['defineProperty'](_0xbfe644,_0x1883a5(0xa7),{'enumerable':!![],'value':_0x56ab5e});}:function(_0x26f1b3,_0x2ddb8b){_0x26f1b3['default']=_0x2ddb8b;}),__decorate=this&&this[a188_0x29f942(0x101)]||function(_0x54e2b8,_0x1e1c35,_0x5bd861,_0x7bcf2a){const _0x5c6597=a188_0x29f942;var _0x2aef75=arguments['length'],_0x181add=_0x2aef75<0x3?_0x1e1c35:_0x7bcf2a===null?_0x7bcf2a=Object[_0x5c6597(0xe0)](_0x1e1c35,_0x5bd861):_0x7bcf2a,_0x163c33;if(typeof Reflect==='object'&&typeof Reflect[_0x5c6597(0xd7)]===_0x5c6597(0xde))_0x181add=Reflect[_0x5c6597(0xd7)](_0x54e2b8,_0x1e1c35,_0x5bd861,_0x7bcf2a);else{for(var _0x32bbaf=_0x54e2b8[_0x5c6597(0x10c)]-0x1;_0x32bbaf>=0x0;_0x32bbaf--)if(_0x163c33=_0x54e2b8[_0x32bbaf])_0x181add=(_0x2aef75<0x3?_0x163c33(_0x181add):_0x2aef75>0x3?_0x163c33(_0x1e1c35,_0x5bd861,_0x181add):_0x163c33(_0x1e1c35,_0x5bd861))||_0x181add;}return _0x2aef75>0x3&&_0x181add&&Object['defineProperty'](_0x1e1c35,_0x5bd861,_0x181add),_0x181add;},__importStar=this&&this[a188_0x29f942(0xb7)]||function(_0x176bb4){const _0x41b991=a188_0x29f942;if(_0x176bb4&&_0x176bb4[_0x41b991(0xb9)])return _0x176bb4;var _0x26f57f={};if(_0x176bb4!=null){for(var _0xea1706 in _0x176bb4)if(_0xea1706!==_0x41b991(0xa7)&&Object[_0x41b991(0xc6)][_0x41b991(0xc9)][_0x41b991(0x106)](_0x176bb4,_0xea1706))__createBinding(_0x26f57f,_0x176bb4,_0xea1706);}return __setModuleDefault(_0x26f57f,_0x176bb4),_0x26f57f;},__metadata=this&&this[a188_0x29f942(0xa6)]||function(_0x36fce7,_0x5af359){const _0xb8bf34=a188_0x29f942;if(typeof Reflect==='object'&&typeof Reflect[_0xb8bf34(0xeb)]===_0xb8bf34(0xde))return Reflect['metadata'](_0x36fce7,_0x5af359);},SyncService_1;function a188_0x566c(){const _0x2428ed=['salesforceSync','168aulGWT','Logger','\x27\x20in\x20repository\x20\x27','length','29707UGyPVc','send','handleRecordSyncError','TooManyRequests','getOrCreateRepo','repositoriesIntersections','hooks','getHookLinkFor','toLowerCase','setLoggerId','repoService','__metadata','default','SyncDirection','[INFO]\x20Start\x20sync\x20job','Service','258ZiRLAh','SyncService','have\x20to\x20synchronize\x20%d\x20branches','65510iuzvZM',']\x20due\x20error\x20-\x20','catch','toUpperCase','FlosumSyncJob','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','../../../core/errors/too-many-requests.error','SalesforceSyncService','disableSync','__importStar','design:paramtypes','__esModule','get','12UmwUOH','getRepoService','setStatus','checkValidNaming','../../hooks/hooks.utils','Unable\x20to\x20synchronize\x20repository\x20\x27','syncDto','SalesforceLogger2','log','244909mlUavG','getAll','prototype','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','HooksUtils','hasOwnProperty','52ODJBWQ','logger','salesforceService','getBranchRecords','isIntersects','run','toString','gitManager','Not\x20Synchronized','../../../core','18416JXKFqP','../jobs/git-sync.job','\x27\x20[','decorate','test','apply','22RuyuKB','createHooks','BRANCH_NAME_REGEXP','repoList','function','2831170uvCrzU','getOwnPropertyDescriptor','push','2700646XuZeCE','../errors/git-branch-not-found.error','../../shared/utils','sfLogger','all','3556071imjNSt','create','../../salesforce/services/salesforce.service','(((.+)+)+)+$','metadata','../../shared/git-provider.manager','sleep','../../salesforce/services/salesforce-logger-v2.service','FlosumToGit','error','name','REPOSITORY_NAME_REGEXP','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','direction','getRepositoryRecords','constructor','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','search','../../../constants','Error','repositoryId','GitBranchNotFoundError','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','repositoryName','syncID','GitSyncJob','__decorate','8cRSqxl','convertToSFDX','defineProperty','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','call','branchName'];a188_0x566c=function(){return _0x2428ed;};return a188_0x566c();}Object[a188_0x29f942(0x104)](exports,a188_0x29f942(0xb9),{'value':!![]}),exports[a188_0x29f942(0xac)]=void 0x0;const constants_1=require(a188_0x29f942(0xf9)),core_1=require(a188_0x29f942(0xd3)),too_many_requests_error_1=require(a188_0x29f942(0xb4)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_logger_v2_service_1=require(a188_0x29f942(0xee)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a188_0x29f942(0xe9)),git_provider_manager_1=require(a188_0x29f942(0xec)),utils_1=require(a188_0x29f942(0xe4)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a188_0x29f942(0xbf)),git_branch_not_found_error_1=require(a188_0x29f942(0xe3)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a188_0x29f942(0xd5));let SyncService=SyncService_1=class SyncService{constructor(_0x52e6bf,_0xf04dda,_0x5695a3){const _0x3046c1=a188_0x29f942;this[_0x3046c1(0xcc)]=_0x52e6bf,this[_0x3046c1(0x108)]=_0xf04dda,this[_0x3046c1(0xd1)]=_0x5695a3,this[_0x3046c1(0xcb)]=new core_1[(_0x3046c1(0x10a))](SyncService_1[_0x3046c1(0xf1)]),this[_0x3046c1(0x112)]={},this[_0x3046c1(0xdd)]=[];}async[a188_0x29f942(0x10f)](_0x44a100,_0x16a0fa){const _0x4ed57b=a188_0x29f942;if(_0x16a0fa instanceof git_branch_not_found_error_1[_0x4ed57b(0xfc)]){await this['salesforceSync'][_0x4ed57b(0xbd)](_0x44a100,_0x4ed57b(0xd2));return;}if(_0x16a0fa instanceof too_many_requests_error_1[_0x4ed57b(0x110)]){await this[_0x4ed57b(0x108)][_0x4ed57b(0xbd)](_0x44a100,'Waiting');throw _0x16a0fa;}try{await this[_0x4ed57b(0xe5)]['log']('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x44a100[_0x4ed57b(0xfe)]+_0x4ed57b(0xd6)+_0x44a100['branchName']+_0x4ed57b(0xaf)+_0x16a0fa)[_0x4ed57b(0x10e)](),await this[_0x4ed57b(0x108)]['updateRemoteState'](_0x44a100,{}),await this[_0x4ed57b(0x108)][_0x4ed57b(0xbd)](_0x44a100,_0x4ed57b(0xfa));}catch(_0x3af1fd){if(_0x3af1fd instanceof salesforce_error_1['SalesforceError'])throw _0x3af1fd;}}async[a188_0x29f942(0xce)](_0x16b94a){const _0x524abd=a188_0x29f942;if(_0x16b94a[_0x524abd(0xfb)]){const _0x5dc137=_0x16b94a[_0x524abd(0xfe)][_0x524abd(0xa3)](),_0x1315d7=this[_0x524abd(0x112)][_0x5dc137];if(!_0x1315d7)this[_0x524abd(0x112)][_0x5dc137]=_0x16b94a[_0x524abd(0xfe)];else{if(_0x1315d7&&_0x1315d7!==_0x16b94a[_0x524abd(0xfe)])return await this[_0x524abd(0x10f)](_0x16b94a,new Error(_0x524abd(0xc0)+_0x16b94a[_0x524abd(0xfe)]+_0x524abd(0xf3)+_0x5dc137+'\x27\x20-\x20\x27'+_0x1315d7+'\x27')),!![];}}return![];}async[a188_0x29f942(0xbe)](_0x3a644b){const _0x52c192=a188_0x29f942;if(!constants_1[_0x52c192(0xf2)]['test'](_0x3a644b[_0x52c192(0xfe)]))return await this[_0x52c192(0x10f)](_0x3a644b,new Error(_0x52c192(0xc0)+_0x3a644b['repositoryName']+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1[_0x52c192(0xdc)][_0x52c192(0xd8)](_0x3a644b[_0x52c192(0x107)]))return await this[_0x52c192(0x10f)](_0x3a644b,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x3a644b[_0x52c192(0x107)]+_0x52c192(0x10b)+_0x3a644b[_0x52c192(0xfe)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a188_0x29f942(0x111)](_0x3a13b6,_0x345c72,_0xa0eb30){const _0x28d317=a188_0x29f942;let _0x4b33fe=this[_0x28d317(0xdd)]['find'](_0x4ea4e4=>_0x3a13b6['repositoryName']===_0x4ea4e4[_0x28d317(0xf1)]);!_0x4b33fe&&(this[_0x28d317(0xe5)][_0x28d317(0xc3)]('[INFO]\x20Repository\x20\x22'+_0x3a13b6[_0x28d317(0xfe)]+_0x28d317(0xb3)),_0x4b33fe=await this[_0x28d317(0xa5)]['create']({'name':_0x3a13b6['repositoryName'],'autoInit':!![],'defaultBranch':_0x3a13b6['branchName'],'private':!![],'createHook':this[_0x28d317(0xc1)]['createHooks']}));if(this[_0x28d317(0xc1)][_0x28d317(0xdb)]){const _0x3d88cb=await _0x4b33fe[_0x28d317(0xa1)][_0x28d317(0xc5)]();!_0x3d88cb['find'](_0x56c51e=>_0x56c51e['url']===hooks_utils_1[_0x28d317(0xc8)][_0x28d317(0xa2)](_0x345c72,_0xa0eb30))&&(this['sfLogger'][_0x28d317(0xc3)]('[INFO]\x20Repository\x20\x22'+_0x3a13b6[_0x28d317(0xfe)]+_0x28d317(0xfd)),await _0x4b33fe['hooks']['create'](hooks_utils_1[_0x28d317(0xc8)]['createHookPayload'](_0x345c72,_0x4b33fe[_0x28d317(0xa1)],_0xa0eb30)));}return this[_0x28d317(0xdd)][_0x28d317(0xe1)](_0x4b33fe),_0x4b33fe;}async[a188_0x29f942(0xcf)](_0x4cd0bb,_0x2fcdc7,_0x2eef7e,_0x188c3f){const _0x3b22e3=a188_0x29f942;this['salesforceService'][_0x3b22e3(0xa4)](_0x2fcdc7),this[_0x3b22e3(0xa5)]=this[_0x3b22e3(0xd1)][_0x3b22e3(0xbc)](_0x2eef7e),this[_0x3b22e3(0xe5)]=new salesforce_logger_v2_service_1[(_0x3b22e3(0xc2))](_0x2fcdc7,'['+SyncService_1['name']+']\x20['+_0x2eef7e[_0x3b22e3(0xb1)]()+']'),this[_0x3b22e3(0xc1)]=_0x4cd0bb;try{await this[_0x3b22e3(0xe5)][_0x3b22e3(0xc3)](_0x3b22e3(0xa9))[_0x3b22e3(0x10e)]();const [_0x5da645,_0x53077c]=await Promise[_0x3b22e3(0xe6)]([this[_0x3b22e3(0x108)][_0x3b22e3(0xcd)](),this[_0x3b22e3(0x108)][_0x3b22e3(0xf5)]()]);this[_0x3b22e3(0xdd)]=await this[_0x3b22e3(0xa5)][_0x3b22e3(0xc5)]();const _0x3eeefa=[..._0x53077c,..._0x5da645];this['logger'][_0x3b22e3(0xc3)](_0x3b22e3(0xad),_0x3eeefa[_0x3b22e3(0x10c)]);for(const _0x124018 of _0x3eeefa){this[_0x3b22e3(0xcb)][_0x3b22e3(0xc3)](_0x3b22e3(0xc7),_0x124018[_0x3b22e3(0xfe)],_0x124018[_0x3b22e3(0xfb)],_0x124018[_0x3b22e3(0x107)],_0x124018['branchId']);const _0x418c91=await this[_0x3b22e3(0xbe)](_0x124018);if(!_0x418c91)continue;const _0x1d915b=await this['isIntersects'](_0x124018);if(_0x1d915b)continue;let _0x3b4ab3;try{_0x3b4ab3=await this[_0x3b22e3(0x111)](_0x124018,_0x2eef7e,_0x188c3f);}catch(_0x5f5db6){await this['handleRecordSyncError'](_0x124018,_0x5f5db6 instanceof too_many_requests_error_1[_0x3b22e3(0x110)]?_0x5f5db6:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x5f5db6));continue;}await this['sfLogger'][_0x3b22e3(0x10e)]();if(_0x124018[_0x3b22e3(0xf4)]===flosum_repository_sync_dto_1[_0x3b22e3(0xa8)][_0x3b22e3(0xef)]){const _0x20e19a=typedi_1[_0x3b22e3(0xa7)][_0x3b22e3(0xba)](flosum_sync_job_1[_0x3b22e3(0xb2)]);await _0x20e19a[_0x3b22e3(0xcf)]({'repository':_0x3b4ab3,'convertToSFDX':_0x4cd0bb[_0x3b22e3(0x103)],'syncRecord':_0x124018,'provider':_0x2eef7e,'logger':this[_0x3b22e3(0xe5)]})['catch'](_0x3e5a92=>this['handleRecordSyncError'](_0x124018,_0x3e5a92));}else{const _0x348d7d=typedi_1[_0x3b22e3(0xa7)]['get'](git_sync_job_1[_0x3b22e3(0x100)]);await _0x348d7d[_0x3b22e3(0xcf)]({'repository':_0x3b4ab3,'branch':_0x124018['branchName'],'provider':_0x2eef7e,'repositoryGit':_0x3b4ab3['gitUrl'],'syncRecord':_0x124018,'logger':this[_0x3b22e3(0xe5)]})[_0x3b22e3(0xb0)](_0x4114ab=>this[_0x3b22e3(0x10f)](_0x124018,_0x4114ab));}}}catch(_0x3489c1){this[_0x3b22e3(0xcb)][_0x3b22e3(0xf0)](_0x3489c1);_0x3489c1 instanceof too_many_requests_error_1[_0x3b22e3(0x110)]?(await this[_0x3b22e3(0xe5)][_0x3b22e3(0xc3)](_0x3b22e3(0x105))[_0x3b22e3(0x10e)](),await utils_1[_0x3b22e3(0xed)](0x3c*0x3c*0x3e8),this['run'](_0x4cd0bb,_0x2fcdc7,_0x2eef7e,_0x188c3f)):await this['sfLogger'][_0x3b22e3(0xc3)](_0x3b22e3(0xf7)+_0x3489c1)[_0x3b22e3(0x10e)]();return;}await this[_0x3b22e3(0xe5)][_0x3b22e3(0xc3)]('[INFO]\x20Sync\x20job\x20done.')[_0x3b22e3(0x10e)](),await this[_0x3b22e3(0x108)][_0x3b22e3(0xb6)](_0x4cd0bb[_0x3b22e3(0xff)])[_0x3b22e3(0xb0)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x29f942(0xaa)]({'transient':!![]}),__metadata(a188_0x29f942(0xb8),[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a188_0x29f942(0xb5)],git_provider_manager_1['GitProviderManager']])],SyncService),exports[a188_0x29f942(0xac)]=SyncService;