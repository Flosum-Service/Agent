const a188_0x51528a=a188_0x4b9b;(function(_0x390923,_0x7f3c7b){const _0x462821=a188_0x4b9b,_0x367090=_0x390923();while(!![]){try{const _0x2c4b4b=parseInt(_0x462821(0x117))/0x1+parseInt(_0x462821(0x143))/0x2*(parseInt(_0x462821(0x122))/0x3)+parseInt(_0x462821(0xfa))/0x4+-parseInt(_0x462821(0x138))/0x5*(-parseInt(_0x462821(0x114))/0x6)+parseInt(_0x462821(0xd0))/0x7*(parseInt(_0x462821(0x10d))/0x8)+-parseInt(_0x462821(0x12b))/0x9*(-parseInt(_0x462821(0xf8))/0xa)+parseInt(_0x462821(0x109))/0xb*(-parseInt(_0x462821(0xf4))/0xc);if(_0x2c4b4b===_0x7f3c7b)break;else _0x367090['push'](_0x367090['shift']());}catch(_0x38b931){_0x367090['push'](_0x367090['shift']());}}}(a188_0x82d9,0x2a031));function a188_0x4b9b(_0x461518,_0x35d3a7){const _0x531d40=a188_0x82d9();return a188_0x4b9b=function(_0x183732,_0x766c31){_0x183732=_0x183732-0xc7;let _0x82d92a=_0x531d40[_0x183732];return _0x82d92a;},a188_0x4b9b(_0x461518,_0x35d3a7);}const a188_0x766c31=(function(){let _0x5d4717=!![];return function(_0x741ee5,_0x46e747){const _0xdc0e91=_0x5d4717?function(){const _0x3ab939=a188_0x4b9b;if(_0x46e747){const _0x2ab7b0=_0x46e747[_0x3ab939(0x11a)](_0x741ee5,arguments);return _0x46e747=null,_0x2ab7b0;}}:function(){};return _0x5d4717=![],_0xdc0e91;};}()),a188_0x183732=a188_0x766c31(this,function(){const _0x5b9403=a188_0x4b9b;return a188_0x183732[_0x5b9403(0xd5)]()[_0x5b9403(0xd1)](_0x5b9403(0x13e))['toString']()['constructor'](a188_0x183732)[_0x5b9403(0xd1)]('(((.+)+)+)+$');});a188_0x183732();'use strict';function a188_0x82d9(){const _0x43531a=['direction','BRANCH_NAME_REGEXP','getAll','toUpperCase','REPOSITORY_NAME_REGEXP','(((.+)+)+)+$','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','object','prototype','../../salesforce/services/salesforce.service','120898iYcgzw','../../shared/git-provider.manager','SyncDirection','send','../../hooks/hooks.utils','__esModule','[INFO]\x20Repository\x20\x22','createHookPayload','default','getHookLinkFor','750197XeiHpl','search','TooManyRequests','logger','disableSync','toString','hasOwnProperty','[INFO]\x20Start\x20sync\x20job','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','gitUrl','SalesforceService','isIntersects','\x27\x20in\x20repository\x20\x27','SalesforceError','url','../../../core','getRepositoryRecords','Waiting','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','\x27\x20[','[INFO]\x20Sync\x20job\x20done.','GitSyncJob','SyncService','setStatus','decorate','../../../constants','test',']\x20due\x20error\x20-\x20','branchId','metadata','function','repositoriesIntersections','../../salesforce/errors/salesforce.error','../jobs/git-sync.job','run','2892PbnUzb','salesforceService','find','catch','729020VxlRYm','get','904112tGBPWk','../../salesforce/services/salesforce-sync.service','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','../errors/git-branch-not-found.error','setLoggerId','../../shared/utils','design:paramtypes','repositoryName','defineProperty','../../salesforce/dto/flosum-repository-sync.dto','gitManager','getRepoService','checkValidNaming','Error','26763RnnCUi','syncDto','\x27\x20-\x20\x27','Unable\x20to\x20synchronize\x20branch\x20\x27','8XyYVHe','error','../../salesforce/services/salesforce-logger-v2.service','name','getOwnPropertyDescriptor','syncID','Not\x20Synchronized','126RKlwBi','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','getBranchRecords','8109OliWlL','createHooks','all','apply','FlosumSyncJob','Service','GitProviderManager','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.',']\x20[','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','__createBinding','9mTWWpw','have\x20to\x20synchronize\x20%d\x20branches','Unable\x20to\x20synchronize\x20repository\x20\x27','length','create','log','Logger','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','repositoryId','27KvqrZT','repoService','../../../core/errors/too-many-requests.error','__decorate','getOrCreateRepo','branchName','handleRecordSyncError','sfLogger','hooks','push','repoList','__setModuleDefault','salesforceSync','4065zZWKGJ'];a188_0x82d9=function(){return _0x43531a;};return a188_0x82d9();}var __createBinding=this&&this[a188_0x51528a(0x121)]||(Object[a188_0x51528a(0x126)]?function(_0x32f736,_0x35b31d,_0x158d27,_0x236bfb){const _0x29cb12=a188_0x51528a;if(_0x236bfb===undefined)_0x236bfb=_0x158d27;Object[_0x29cb12(0x103)](_0x32f736,_0x236bfb,{'enumerable':!![],'get':function(){return _0x35b31d[_0x158d27];}});}:function(_0x58938d,_0x636941,_0x37d069,_0x3d7788){if(_0x3d7788===undefined)_0x3d7788=_0x37d069;_0x58938d[_0x3d7788]=_0x636941[_0x37d069];}),__setModuleDefault=this&&this[a188_0x51528a(0x136)]||(Object[a188_0x51528a(0x126)]?function(_0x1479ae,_0x116a4a){const _0x5e1fbb=a188_0x51528a;Object[_0x5e1fbb(0x103)](_0x1479ae,_0x5e1fbb(0xce),{'enumerable':!![],'value':_0x116a4a});}:function(_0xb35e78,_0x4f77a7){const _0x3578de=a188_0x51528a;_0xb35e78[_0x3578de(0xce)]=_0x4f77a7;}),__decorate=this&&this[a188_0x51528a(0x12e)]||function(_0xf36d77,_0x140d23,_0x50f6ae,_0x127e3d){const _0x397bbb=a188_0x51528a;var _0x1b760e=arguments['length'],_0x102546=_0x1b760e<0x3?_0x140d23:_0x127e3d===null?_0x127e3d=Object[_0x397bbb(0x111)](_0x140d23,_0x50f6ae):_0x127e3d,_0x31106c;if(typeof Reflect===_0x397bbb(0x140)&&typeof Reflect[_0x397bbb(0xe9)]===_0x397bbb(0xef))_0x102546=Reflect[_0x397bbb(0xe9)](_0xf36d77,_0x140d23,_0x50f6ae,_0x127e3d);else{for(var _0x23cc55=_0xf36d77[_0x397bbb(0x125)]-0x1;_0x23cc55>=0x0;_0x23cc55--)if(_0x31106c=_0xf36d77[_0x23cc55])_0x102546=(_0x1b760e<0x3?_0x31106c(_0x102546):_0x1b760e>0x3?_0x31106c(_0x140d23,_0x50f6ae,_0x102546):_0x31106c(_0x140d23,_0x50f6ae))||_0x102546;}return _0x1b760e>0x3&&_0x102546&&Object[_0x397bbb(0x103)](_0x140d23,_0x50f6ae,_0x102546),_0x102546;},__importStar=this&&this['__importStar']||function(_0x2bfa2c){const _0x20eca2=a188_0x51528a;if(_0x2bfa2c&&_0x2bfa2c['__esModule'])return _0x2bfa2c;var _0x41d64d={};if(_0x2bfa2c!=null){for(var _0x2885d4 in _0x2bfa2c)if(_0x2885d4!==_0x20eca2(0xce)&&Object[_0x20eca2(0x141)][_0x20eca2(0xd6)]['call'](_0x2bfa2c,_0x2885d4))__createBinding(_0x41d64d,_0x2bfa2c,_0x2885d4);}return __setModuleDefault(_0x41d64d,_0x2bfa2c),_0x41d64d;},__metadata=this&&this['__metadata']||function(_0x38e022,_0x3c0dbb){const _0x5a6658=a188_0x51528a;if(typeof Reflect===_0x5a6658(0x140)&&typeof Reflect[_0x5a6658(0xee)]===_0x5a6658(0xef))return Reflect['metadata'](_0x38e022,_0x3c0dbb);},SyncService_1;Object[a188_0x51528a(0x103)](exports,a188_0x51528a(0xcb),{'value':!![]}),exports[a188_0x51528a(0xe7)]=void 0x0;const constants_1=require(a188_0x51528a(0xea)),core_1=require(a188_0x51528a(0xdf)),too_many_requests_error_1=require(a188_0x51528a(0x12d)),flosum_repository_sync_dto_1=require(a188_0x51528a(0x104)),salesforce_error_1=require(a188_0x51528a(0xf1)),salesforce_logger_v2_service_1=require(a188_0x51528a(0x10f)),salesforce_sync_service_1=require(a188_0x51528a(0xfb)),salesforce_service_1=require(a188_0x51528a(0x142)),git_provider_manager_1=require(a188_0x51528a(0xc7)),utils_1=require(a188_0x51528a(0x100)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a188_0x51528a(0xca)),git_branch_not_found_error_1=require(a188_0x51528a(0xfe)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a188_0x51528a(0xf2));let SyncService=SyncService_1=class SyncService{constructor(_0x23ccaf,_0x4e387a,_0x27b07a){const _0x3083ac=a188_0x51528a;this[_0x3083ac(0xf5)]=_0x23ccaf,this[_0x3083ac(0x137)]=_0x4e387a,this[_0x3083ac(0x105)]=_0x27b07a,this['logger']=new core_1[(_0x3083ac(0x128))](SyncService_1[_0x3083ac(0x110)]),this[_0x3083ac(0xf0)]={},this[_0x3083ac(0x135)]=[];}async['handleRecordSyncError'](_0x46a15a,_0x936ecf){const _0x488b86=a188_0x51528a;if(_0x936ecf instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this[_0x488b86(0x137)][_0x488b86(0xe8)](_0x46a15a,_0x488b86(0x113));return;}if(_0x936ecf instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x488b86(0x137)][_0x488b86(0xe8)](_0x46a15a,_0x488b86(0xe1));throw _0x936ecf;}try{await this[_0x488b86(0x132)][_0x488b86(0x127)](_0x488b86(0xd8)+_0x46a15a[_0x488b86(0x102)]+_0x488b86(0xe4)+_0x46a15a[_0x488b86(0x130)]+_0x488b86(0xec)+_0x936ecf)[_0x488b86(0xc9)](),await this[_0x488b86(0x137)]['updateRemoteState'](_0x46a15a,{}),await this['salesforceSync'][_0x488b86(0xe8)](_0x46a15a,_0x488b86(0x108));}catch(_0x4fc183){if(_0x4fc183 instanceof salesforce_error_1[_0x488b86(0xdd)])throw _0x4fc183;}}async[a188_0x51528a(0xdb)](_0x3c5e65){const _0x57ca84=a188_0x51528a;if(_0x3c5e65[_0x57ca84(0x12a)]){const _0x2ba29d=_0x3c5e65[_0x57ca84(0x102)]['toLowerCase'](),_0x363d7b=this[_0x57ca84(0xf0)][_0x2ba29d];if(!_0x363d7b)this[_0x57ca84(0xf0)][_0x2ba29d]=_0x3c5e65[_0x57ca84(0x102)];else{if(_0x363d7b&&_0x363d7b!==_0x3c5e65['repositoryName'])return await this['handleRecordSyncError'](_0x3c5e65,new Error(_0x57ca84(0x124)+_0x3c5e65[_0x57ca84(0x102)]+_0x57ca84(0xe3)+_0x2ba29d+_0x57ca84(0x10b)+_0x363d7b+'\x27')),!![];}}return![];}async[a188_0x51528a(0x107)](_0x1808bf){const _0x4c14d6=a188_0x51528a;if(!constants_1[_0x4c14d6(0x13d)][_0x4c14d6(0xeb)](_0x1808bf[_0x4c14d6(0x102)]))return await this[_0x4c14d6(0x131)](_0x1808bf,new Error(_0x4c14d6(0x124)+_0x1808bf[_0x4c14d6(0x102)]+_0x4c14d6(0xfc))),![];if(!constants_1[_0x4c14d6(0x13a)]['test'](_0x1808bf[_0x4c14d6(0x130)]))return await this[_0x4c14d6(0x131)](_0x1808bf,new Error(_0x4c14d6(0x10c)+_0x1808bf[_0x4c14d6(0x130)]+_0x4c14d6(0xdc)+_0x1808bf[_0x4c14d6(0x102)]+_0x4c14d6(0x129))),![];return!![];}async[a188_0x51528a(0x12f)](_0x3fb248,_0xee4e1f,_0x1de92f){const _0xb99d2f=a188_0x51528a;let _0x50b235=this[_0xb99d2f(0x135)][_0xb99d2f(0xf6)](_0x1a1e59=>_0x3fb248[_0xb99d2f(0x102)]===_0x1a1e59[_0xb99d2f(0x110)]);!_0x50b235&&(this[_0xb99d2f(0x132)][_0xb99d2f(0x127)]('[INFO]\x20Repository\x20\x22'+_0x3fb248[_0xb99d2f(0x102)]+_0xb99d2f(0x120)),_0x50b235=await this['repoService']['create']({'name':_0x3fb248[_0xb99d2f(0x102)],'autoInit':!![],'defaultBranch':_0x3fb248[_0xb99d2f(0x130)],'private':!![],'createHook':this[_0xb99d2f(0x10a)][_0xb99d2f(0x118)]}));if(this['syncDto'][_0xb99d2f(0x118)]){const _0x83d42f=await _0x50b235[_0xb99d2f(0x133)][_0xb99d2f(0x13b)]();!_0x83d42f[_0xb99d2f(0xf6)](_0x495592=>_0x495592[_0xb99d2f(0xde)]===hooks_utils_1['HooksUtils'][_0xb99d2f(0xcf)](_0xee4e1f,_0x1de92f))&&(this['sfLogger'][_0xb99d2f(0x127)](_0xb99d2f(0xcc)+_0x3fb248[_0xb99d2f(0x102)]+_0xb99d2f(0xfd)),await _0x50b235['hooks'][_0xb99d2f(0x126)](hooks_utils_1['HooksUtils'][_0xb99d2f(0xcd)](_0xee4e1f,_0x50b235[_0xb99d2f(0x133)],_0x1de92f)));}return this[_0xb99d2f(0x135)][_0xb99d2f(0x134)](_0x50b235),_0x50b235;}async['run'](_0x4ed8c9,_0x53dada,_0x9afdeb,_0x173c66){const _0x39d9d7=a188_0x51528a;this['salesforceService'][_0x39d9d7(0xff)](_0x53dada),this[_0x39d9d7(0x12c)]=this['gitManager'][_0x39d9d7(0x106)](_0x9afdeb),this['sfLogger']=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x53dada,'['+SyncService_1[_0x39d9d7(0x110)]+_0x39d9d7(0x11f)+_0x9afdeb[_0x39d9d7(0x13c)]()+']'),this['syncDto']=_0x4ed8c9;try{await this['sfLogger'][_0x39d9d7(0x127)](_0x39d9d7(0xd7))[_0x39d9d7(0xc9)]();const [_0x5e312d,_0x176df9]=await Promise[_0x39d9d7(0x119)]([this[_0x39d9d7(0x137)][_0x39d9d7(0x116)](),this[_0x39d9d7(0x137)][_0x39d9d7(0xe0)]()]);this['repoList']=await this['repoService'][_0x39d9d7(0x13b)]();const _0x9aee87=[..._0x176df9,..._0x5e312d];this[_0x39d9d7(0xd3)][_0x39d9d7(0x127)](_0x39d9d7(0x123),_0x9aee87[_0x39d9d7(0x125)]);for(const _0x5f2a32 of _0x9aee87){this[_0x39d9d7(0xd3)]['log'](_0x39d9d7(0x13f),_0x5f2a32['repositoryName'],_0x5f2a32['repositoryId'],_0x5f2a32[_0x39d9d7(0x130)],_0x5f2a32[_0x39d9d7(0xed)]);const _0x413db9=await this[_0x39d9d7(0x107)](_0x5f2a32);if(!_0x413db9)continue;const _0x453667=await this[_0x39d9d7(0xdb)](_0x5f2a32);if(_0x453667)continue;let _0x574e7a;try{_0x574e7a=await this[_0x39d9d7(0x12f)](_0x5f2a32,_0x9afdeb,_0x173c66);}catch(_0x447681){await this[_0x39d9d7(0x131)](_0x5f2a32,_0x447681 instanceof too_many_requests_error_1['TooManyRequests']?_0x447681:new Error(_0x39d9d7(0x115)+_0x447681));continue;}await this[_0x39d9d7(0x132)][_0x39d9d7(0xc9)]();if(_0x5f2a32[_0x39d9d7(0x139)]===flosum_repository_sync_dto_1[_0x39d9d7(0xc8)]['FlosumToGit']){const _0x2c9cb0=typedi_1[_0x39d9d7(0xce)]['get'](flosum_sync_job_1[_0x39d9d7(0x11b)]);await _0x2c9cb0[_0x39d9d7(0xf3)]({'repository':_0x574e7a,'convertToSFDX':_0x4ed8c9['convertToSFDX'],'syncRecord':_0x5f2a32,'provider':_0x9afdeb,'logger':this[_0x39d9d7(0x132)]})[_0x39d9d7(0xf7)](_0x170322=>this['handleRecordSyncError'](_0x5f2a32,_0x170322));}else{const _0x32d28b=typedi_1[_0x39d9d7(0xce)][_0x39d9d7(0xf9)](git_sync_job_1[_0x39d9d7(0xe6)]);await _0x32d28b[_0x39d9d7(0xf3)]({'repository':_0x574e7a,'branch':_0x5f2a32['branchName'],'provider':_0x9afdeb,'repositoryGit':_0x574e7a[_0x39d9d7(0xd9)],'syncRecord':_0x5f2a32,'logger':this[_0x39d9d7(0x132)]})[_0x39d9d7(0xf7)](_0x582692=>this[_0x39d9d7(0x131)](_0x5f2a32,_0x582692));}}}catch(_0x1a960f){this['logger'][_0x39d9d7(0x10e)](_0x1a960f);_0x1a960f instanceof too_many_requests_error_1[_0x39d9d7(0xd2)]?(await this[_0x39d9d7(0x132)][_0x39d9d7(0x127)](_0x39d9d7(0x11e))[_0x39d9d7(0xc9)](),await utils_1['sleep'](0x3c*0x3c*0x3e8),this[_0x39d9d7(0xf3)](_0x4ed8c9,_0x53dada,_0x9afdeb,_0x173c66)):await this['sfLogger']['log'](_0x39d9d7(0xe2)+_0x1a960f)[_0x39d9d7(0xc9)]();return;}await this[_0x39d9d7(0x132)][_0x39d9d7(0x127)](_0x39d9d7(0xe5))['send'](),await this[_0x39d9d7(0x137)][_0x39d9d7(0xd4)](_0x4ed8c9[_0x39d9d7(0x112)])[_0x39d9d7(0xf7)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x51528a(0x11c)]({'transient':!![]}),__metadata(a188_0x51528a(0x101),[salesforce_service_1[a188_0x51528a(0xda)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a188_0x51528a(0x11d)]])],SyncService),exports[a188_0x51528a(0xe7)]=SyncService;