const a187_0x570eb3=a187_0x174e;(function(_0x3df1b6,_0x5aa1dc){const _0x54558a=a187_0x174e,_0x103438=_0x3df1b6();while(!![]){try{const _0x1cc35b=parseInt(_0x54558a(0x133))/0x1+-parseInt(_0x54558a(0x15c))/0x2+parseInt(_0x54558a(0x19e))/0x3+parseInt(_0x54558a(0x17c))/0x4*(parseInt(_0x54558a(0x18f))/0x5)+parseInt(_0x54558a(0x198))/0x6+parseInt(_0x54558a(0x140))/0x7+-parseInt(_0x54558a(0x18e))/0x8;if(_0x1cc35b===_0x5aa1dc)break;else _0x103438['push'](_0x103438['shift']());}catch(_0x3a804c){_0x103438['push'](_0x103438['shift']());}}}(a187_0x5443,0x349bb));const a187_0x4ce257=(function(){let _0x4a67f5=!![];return function(_0x30f70f,_0x57a38a){const _0x333263=_0x4a67f5?function(){const _0x55180b=a187_0x174e;if(_0x57a38a){const _0x2a7d47=_0x57a38a[_0x55180b(0x176)](_0x30f70f,arguments);return _0x57a38a=null,_0x2a7d47;}}:function(){};return _0x4a67f5=![],_0x333263;};}()),a187_0x264791=a187_0x4ce257(this,function(){const _0x3e836a=a187_0x174e;return a187_0x264791[_0x3e836a(0x17f)]()[_0x3e836a(0x158)]('(((.+)+)+)+$')[_0x3e836a(0x17f)]()[_0x3e836a(0x195)](a187_0x264791)[_0x3e836a(0x158)]('(((.+)+)+)+$');});function a187_0x5443(){const _0x2bfa49=['[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','decorate','search','length','run','convertToSFDX','374684zysRFG','hasOwnProperty','REPOSITORY_NAME_REGEXP',']\x20due\x20error\x20-\x20','../errors/git-branch-not-found.error','get','gitManager','checkValidNaming','getOrCreateRepo','handleRecordSyncError','__createBinding','salesforceSync','__metadata','GitBranchNotFoundError','gitUrl','../jobs/git-sync.job','[INFO]\x20Start\x20sync\x20job','HooksUtils','getRepositoryRecords','repositoryName','Unable\x20to\x20synchronize\x20repository\x20\x27','TooManyRequests','createHooks','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','disableSync','\x27\x20[','apply',']\x20[','url','all','test','create','500FgXvBB','FlosumSyncJob','catch','toString','../../salesforce/errors/salesforce.error','../../../constants','default','Error','branchId','repositoriesIntersections','../../salesforce/services/salesforce.service','SyncService','syncID','log','Logger','SalesforceSyncService','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','hooks','7858728JEaoka','9595hHsdxi','__setModuleDefault','SyncDirection','design:paramtypes','typedi','updateRemoteState','constructor','SalesforceLogger2','syncDto','1654824zboQLi','setLoggerId','createHookPayload','push','getRepoService','name','1069875GEQmzW','metadata','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','salesforceService','sfLogger','repoService','getAll','defineProperty','325193uieNMS','error','toLowerCase','__esModule','Unable\x20to\x20synchronize\x20branch\x20\x27','logger','../jobs/flosum-sync.job','repoList','[INFO]\x20Repository\x20\x22','isIntersects','find','getHookLinkFor','object','1313683mxRVgs','../../hooks/hooks.utils','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','\x27\x20in\x20repository\x20\x27','BRANCH_NAME_REGEXP','send','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','sleep','setStatus','../../shared/utils','have\x20to\x20synchronize\x20%d\x20branches','SalesforceError','../../../core','FlosumToGit','__importStar','function','direction','[INFO]\x20Sync\x20job\x20done.','repositoryId','GitProviderManager','SalesforceService','branchName'];a187_0x5443=function(){return _0x2bfa49;};return a187_0x5443();}a187_0x264791();'use strict';var __createBinding=this&&this[a187_0x570eb3(0x166)]||(Object['create']?function(_0x31acb0,_0x37cf6d,_0x4140b8,_0x4b952a){const _0x303c0a=a187_0x570eb3;if(_0x4b952a===undefined)_0x4b952a=_0x4140b8;Object[_0x303c0a(0x132)](_0x31acb0,_0x4b952a,{'enumerable':!![],'get':function(){return _0x37cf6d[_0x4140b8];}});}:function(_0x274fe3,_0x3f9231,_0x1982c8,_0x550833){if(_0x550833===undefined)_0x550833=_0x1982c8;_0x274fe3[_0x550833]=_0x3f9231[_0x1982c8];}),__setModuleDefault=this&&this[a187_0x570eb3(0x190)]||(Object[a187_0x570eb3(0x17b)]?function(_0x1b6286,_0x8302db){const _0x3a14ab=a187_0x570eb3;Object[_0x3a14ab(0x132)](_0x1b6286,_0x3a14ab(0x182),{'enumerable':!![],'value':_0x8302db});}:function(_0x5285a4,_0x261316){const _0x2106c4=a187_0x570eb3;_0x5285a4[_0x2106c4(0x182)]=_0x261316;}),__decorate=this&&this['__decorate']||function(_0x5d40bb,_0x460dc0,_0x296648,_0x11d2b8){const _0x212151=a187_0x570eb3;var _0xfae29d=arguments[_0x212151(0x159)],_0x2bdec0=_0xfae29d<0x3?_0x460dc0:_0x11d2b8===null?_0x11d2b8=Object['getOwnPropertyDescriptor'](_0x460dc0,_0x296648):_0x11d2b8,_0x28257e;if(typeof Reflect===_0x212151(0x13f)&&typeof Reflect['decorate']===_0x212151(0x14f))_0x2bdec0=Reflect[_0x212151(0x157)](_0x5d40bb,_0x460dc0,_0x296648,_0x11d2b8);else{for(var _0x42f113=_0x5d40bb[_0x212151(0x159)]-0x1;_0x42f113>=0x0;_0x42f113--)if(_0x28257e=_0x5d40bb[_0x42f113])_0x2bdec0=(_0xfae29d<0x3?_0x28257e(_0x2bdec0):_0xfae29d>0x3?_0x28257e(_0x460dc0,_0x296648,_0x2bdec0):_0x28257e(_0x460dc0,_0x296648))||_0x2bdec0;}return _0xfae29d>0x3&&_0x2bdec0&&Object[_0x212151(0x132)](_0x460dc0,_0x296648,_0x2bdec0),_0x2bdec0;},__importStar=this&&this[a187_0x570eb3(0x14e)]||function(_0x5375a7){const _0x186a05=a187_0x570eb3;if(_0x5375a7&&_0x5375a7[_0x186a05(0x136)])return _0x5375a7;var _0x4337f9={};if(_0x5375a7!=null){for(var _0x418486 in _0x5375a7)if(_0x418486!==_0x186a05(0x182)&&Object['prototype'][_0x186a05(0x15d)]['call'](_0x5375a7,_0x418486))__createBinding(_0x4337f9,_0x5375a7,_0x418486);}return __setModuleDefault(_0x4337f9,_0x5375a7),_0x4337f9;},__metadata=this&&this[a187_0x570eb3(0x168)]||function(_0x39d6e1,_0x6b06e8){const _0xac8a50=a187_0x570eb3;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0xac8a50(0x19f)](_0x39d6e1,_0x6b06e8);},SyncService_1;function a187_0x174e(_0x37d6a4,_0x1e7dd7){const _0x3f65fe=a187_0x5443();return a187_0x174e=function(_0x264791,_0x4ce257){_0x264791=_0x264791-0x12e;let _0x54432c=_0x3f65fe[_0x264791];return _0x54432c;},a187_0x174e(_0x37d6a4,_0x1e7dd7);}Object[a187_0x570eb3(0x132)](exports,'__esModule',{'value':!![]}),exports[a187_0x570eb3(0x187)]=void 0x0;const constants_1=require(a187_0x570eb3(0x181)),core_1=require(a187_0x570eb3(0x14c)),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a187_0x570eb3(0x180)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a187_0x570eb3(0x186)),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a187_0x570eb3(0x149)),typedi_1=__importStar(require(a187_0x570eb3(0x193))),hooks_utils_1=require(a187_0x570eb3(0x141)),git_branch_not_found_error_1=require(a187_0x570eb3(0x160)),flosum_sync_job_1=require(a187_0x570eb3(0x139)),git_sync_job_1=require(a187_0x570eb3(0x16b));let SyncService=SyncService_1=class SyncService{constructor(_0x3c873c,_0x2c93ec,_0x2b92a5){const _0xb39edf=a187_0x570eb3;this[_0xb39edf(0x12e)]=_0x3c873c,this[_0xb39edf(0x167)]=_0x2c93ec,this[_0xb39edf(0x162)]=_0x2b92a5,this[_0xb39edf(0x138)]=new core_1[(_0xb39edf(0x18a))](SyncService_1[_0xb39edf(0x19d)]),this[_0xb39edf(0x185)]={},this[_0xb39edf(0x13a)]=[];}async[a187_0x570eb3(0x165)](_0x26d341,_0x3d3546){const _0x246729=a187_0x570eb3;if(_0x3d3546 instanceof git_branch_not_found_error_1[_0x246729(0x169)]){await this['salesforceSync'][_0x246729(0x148)](_0x26d341,'Not\x20Synchronized');return;}if(_0x3d3546 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x246729(0x167)][_0x246729(0x148)](_0x26d341,'Waiting');throw _0x3d3546;}try{await this[_0x246729(0x12f)]['log'](_0x246729(0x142)+_0x26d341['repositoryName']+_0x246729(0x175)+_0x26d341[_0x246729(0x155)]+_0x246729(0x15f)+_0x3d3546)[_0x246729(0x145)](),await this['salesforceSync'][_0x246729(0x194)](_0x26d341,{}),await this['salesforceSync'][_0x246729(0x148)](_0x26d341,_0x246729(0x183));}catch(_0xd6538e){if(_0xd6538e instanceof salesforce_error_1[_0x246729(0x14b)])throw _0xd6538e;}}async[a187_0x570eb3(0x13c)](_0x39a27f){const _0x5f2b94=a187_0x570eb3;if(_0x39a27f[_0x5f2b94(0x152)]){const _0x46285a=_0x39a27f[_0x5f2b94(0x16f)][_0x5f2b94(0x135)](),_0x3b1f56=this['repositoriesIntersections'][_0x46285a];if(!_0x3b1f56)this[_0x5f2b94(0x185)][_0x46285a]=_0x39a27f[_0x5f2b94(0x16f)];else{if(_0x3b1f56&&_0x3b1f56!==_0x39a27f['repositoryName'])return await this[_0x5f2b94(0x165)](_0x39a27f,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x39a27f[_0x5f2b94(0x16f)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x46285a+'\x27\x20-\x20\x27'+_0x3b1f56+'\x27')),!![];}}return![];}async[a187_0x570eb3(0x163)](_0x3d61f8){const _0x411d85=a187_0x570eb3;if(!constants_1[_0x411d85(0x15e)][_0x411d85(0x17a)](_0x3d61f8[_0x411d85(0x16f)]))return await this['handleRecordSyncError'](_0x3d61f8,new Error(_0x411d85(0x170)+_0x3d61f8[_0x411d85(0x16f)]+_0x411d85(0x173))),![];if(!constants_1[_0x411d85(0x144)][_0x411d85(0x17a)](_0x3d61f8['branchName']))return await this['handleRecordSyncError'](_0x3d61f8,new Error(_0x411d85(0x137)+_0x3d61f8[_0x411d85(0x155)]+_0x411d85(0x143)+_0x3d61f8[_0x411d85(0x16f)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a187_0x570eb3(0x164)](_0x21e7c4,_0x46eb96,_0x2139b4){const _0x173edb=a187_0x570eb3;let _0x5c44df=this['repoList'][_0x173edb(0x13d)](_0x25a05d=>_0x21e7c4[_0x173edb(0x16f)]===_0x25a05d[_0x173edb(0x19d)]);!_0x5c44df&&(this['sfLogger'][_0x173edb(0x189)](_0x173edb(0x13b)+_0x21e7c4[_0x173edb(0x16f)]+_0x173edb(0x1a0)),_0x5c44df=await this['repoService']['create']({'name':_0x21e7c4[_0x173edb(0x16f)],'autoInit':!![],'defaultBranch':_0x21e7c4[_0x173edb(0x155)],'private':!![],'createHook':this[_0x173edb(0x197)][_0x173edb(0x172)]}));if(this['syncDto'][_0x173edb(0x172)]){const _0x45229b=await _0x5c44df[_0x173edb(0x18d)][_0x173edb(0x131)]();!_0x45229b[_0x173edb(0x13d)](_0xd91b40=>_0xd91b40[_0x173edb(0x178)]===hooks_utils_1[_0x173edb(0x16d)][_0x173edb(0x13e)](_0x46eb96,_0x2139b4))&&(this[_0x173edb(0x12f)][_0x173edb(0x189)](_0x173edb(0x13b)+_0x21e7c4[_0x173edb(0x16f)]+'\x22\x20does\x20not\x20has\x20the\x20agent\x20webhook.\x20Creating\x20a\x20new\x20one.'),await _0x5c44df['hooks']['create'](hooks_utils_1[_0x173edb(0x16d)][_0x173edb(0x19a)](_0x46eb96,_0x5c44df[_0x173edb(0x18d)],_0x2139b4)));}return this['repoList'][_0x173edb(0x19b)](_0x5c44df),_0x5c44df;}async[a187_0x570eb3(0x15a)](_0x417a83,_0xa8b600,_0x5705b0,_0x42334f){const _0x59ecb4=a187_0x570eb3;this[_0x59ecb4(0x12e)][_0x59ecb4(0x199)](_0xa8b600),this[_0x59ecb4(0x130)]=this[_0x59ecb4(0x162)][_0x59ecb4(0x19c)](_0x5705b0),this[_0x59ecb4(0x12f)]=new salesforce_logger_v2_service_1[(_0x59ecb4(0x196))](_0xa8b600,'['+SyncService_1['name']+_0x59ecb4(0x177)+_0x5705b0['toUpperCase']()+']'),this['syncDto']=_0x417a83;try{await this[_0x59ecb4(0x12f)][_0x59ecb4(0x189)](_0x59ecb4(0x16c))[_0x59ecb4(0x145)]();const [_0x200d13,_0x290e9c]=await Promise[_0x59ecb4(0x179)]([this[_0x59ecb4(0x167)]['getBranchRecords'](),this[_0x59ecb4(0x167)][_0x59ecb4(0x16e)]()]);this['repoList']=await this[_0x59ecb4(0x130)][_0x59ecb4(0x131)]();const _0xc60c92=[..._0x290e9c,..._0x200d13];this['logger'][_0x59ecb4(0x189)](_0x59ecb4(0x14a),_0xc60c92['length']);for(const _0x18bf9 of _0xc60c92){this['logger'][_0x59ecb4(0x189)](_0x59ecb4(0x146),_0x18bf9['repositoryName'],_0x18bf9[_0x59ecb4(0x152)],_0x18bf9['branchName'],_0x18bf9[_0x59ecb4(0x184)]);const _0xa7f3af=await this['checkValidNaming'](_0x18bf9);if(!_0xa7f3af)continue;const _0x5f12fc=await this[_0x59ecb4(0x13c)](_0x18bf9);if(_0x5f12fc)continue;let _0x484e37;try{_0x484e37=await this[_0x59ecb4(0x164)](_0x18bf9,_0x5705b0,_0x42334f);}catch(_0x56aae8){await this[_0x59ecb4(0x165)](_0x18bf9,_0x56aae8 instanceof too_many_requests_error_1[_0x59ecb4(0x171)]?_0x56aae8:new Error(_0x59ecb4(0x18c)+_0x56aae8));continue;}await this[_0x59ecb4(0x12f)][_0x59ecb4(0x145)]();if(_0x18bf9[_0x59ecb4(0x150)]===flosum_repository_sync_dto_1[_0x59ecb4(0x191)][_0x59ecb4(0x14d)]){const _0x17976c=typedi_1['default'][_0x59ecb4(0x161)](flosum_sync_job_1[_0x59ecb4(0x17d)]);await _0x17976c[_0x59ecb4(0x15a)]({'repository':_0x484e37,'convertToSFDX':_0x417a83[_0x59ecb4(0x15b)],'syncRecord':_0x18bf9,'provider':_0x5705b0,'logger':this[_0x59ecb4(0x12f)]})['catch'](_0x530caf=>this[_0x59ecb4(0x165)](_0x18bf9,_0x530caf));}else{const _0x2ea34c=typedi_1['default'][_0x59ecb4(0x161)](git_sync_job_1['GitSyncJob']);await _0x2ea34c[_0x59ecb4(0x15a)]({'repository':_0x484e37,'branch':_0x18bf9[_0x59ecb4(0x155)],'provider':_0x5705b0,'repositoryGit':_0x484e37[_0x59ecb4(0x16a)],'syncRecord':_0x18bf9,'logger':this[_0x59ecb4(0x12f)]})['catch'](_0x546f1e=>this[_0x59ecb4(0x165)](_0x18bf9,_0x546f1e));}}}catch(_0x422e92){this[_0x59ecb4(0x138)][_0x59ecb4(0x134)](_0x422e92);_0x422e92 instanceof too_many_requests_error_1[_0x59ecb4(0x171)]?(await this['sfLogger'][_0x59ecb4(0x189)](_0x59ecb4(0x156))[_0x59ecb4(0x145)](),await utils_1[_0x59ecb4(0x147)](0x3c*0x3c*0x3e8),this[_0x59ecb4(0x15a)](_0x417a83,_0xa8b600,_0x5705b0,_0x42334f)):await this[_0x59ecb4(0x12f)]['log']('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x422e92)[_0x59ecb4(0x145)]();return;}await this[_0x59ecb4(0x12f)][_0x59ecb4(0x189)](_0x59ecb4(0x151))['send'](),await this[_0x59ecb4(0x167)][_0x59ecb4(0x174)](_0x417a83[_0x59ecb4(0x188)])[_0x59ecb4(0x17e)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a187_0x570eb3(0x192),[salesforce_service_1[a187_0x570eb3(0x154)],salesforce_sync_service_1[a187_0x570eb3(0x18b)],git_provider_manager_1[a187_0x570eb3(0x153)]])],SyncService),exports[a187_0x570eb3(0x187)]=SyncService;