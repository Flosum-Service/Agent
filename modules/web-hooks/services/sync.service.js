const a188_0x2a470d=a188_0x4240;(function(_0x2f6223,_0x540d22){const _0x3ce854=a188_0x4240,_0x387da6=_0x2f6223();while(!![]){try{const _0x135bb6=-parseInt(_0x3ce854(0x146))/0x1*(parseInt(_0x3ce854(0x1b3))/0x2)+-parseInt(_0x3ce854(0x193))/0x3+parseInt(_0x3ce854(0x180))/0x4*(parseInt(_0x3ce854(0x1a0))/0x5)+-parseInt(_0x3ce854(0x18a))/0x6*(-parseInt(_0x3ce854(0x1a5))/0x7)+-parseInt(_0x3ce854(0x171))/0x8*(parseInt(_0x3ce854(0x164))/0x9)+parseInt(_0x3ce854(0x15a))/0xa*(parseInt(_0x3ce854(0x16e))/0xb)+parseInt(_0x3ce854(0x1ad))/0xc;if(_0x135bb6===_0x540d22)break;else _0x387da6['push'](_0x387da6['shift']());}catch(_0x31ca6a){_0x387da6['push'](_0x387da6['shift']());}}}(a188_0x399f,0x38e82));const a188_0x5c5f4a=(function(){let _0x3231f6=!![];return function(_0x38c60d,_0x3180ba){const _0x431c9a=_0x3231f6?function(){const _0x504156=a188_0x4240;if(_0x3180ba){const _0x24d421=_0x3180ba[_0x504156(0x1b7)](_0x38c60d,arguments);return _0x3180ba=null,_0x24d421;}}:function(){};return _0x3231f6=![],_0x431c9a;};}()),a188_0x54c8f3=a188_0x5c5f4a(this,function(){const _0x1f6844=a188_0x4240;return a188_0x54c8f3[_0x1f6844(0x1bb)]()[_0x1f6844(0x17f)]('(((.+)+)+)+$')[_0x1f6844(0x1bb)]()[_0x1f6844(0x16c)](a188_0x54c8f3)[_0x1f6844(0x17f)]('(((.+)+)+)+$');});function a188_0x399f(){const _0x109cb6=['\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','REPOSITORY_NAME_REGEXP','getRepositoryRecords','defineProperty','getOrCreateRepo','9560rGuWzo','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','../errors/git-branch-not-found.error','setStatus','toUpperCase','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','updateRemoteState','GitSyncJob','call','BRANCH_NAME_REGEXP','969876LxtMGE','create','hooks','HooksUtils','logger','../../../core','../../salesforce/services/salesforce.service','../../salesforce/services/salesforce-sync.service','constructor','function','5126QdveRE','hasOwnProperty','typedi','8kkRPdN','gitManager','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','get','SalesforceLogger2','Unable\x20to\x20synchronize\x20repository\x20\x27','createHookPayload','SalesforceError','getBranchRecords','branchId','find','Not\x20Synchronized','checkValidNaming','getHookLinkFor','search','101300klqYJB','FlosumToGit','Logger','__esModule','FlosumSyncJob','Waiting','../../../core/errors/too-many-requests.error','run','SyncService','[INFO]\x20Start\x20sync\x20job','6hyUoZA','default','all','SalesforceService','repositoriesIntersections','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','repoList','direction','prototype','290949lbJyId','salesforceSync','getRepoService','length','repositoryId','design:paramtypes','repoService','push','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','test','createHooks','Unable\x20to\x20synchronize\x20branch\x20\x27','handleRecordSyncError','5YvcyCe','../../salesforce/services/salesforce-logger-v2.service','getAll','syncDto','toLowerCase','598045pZpXKJ','getOwnPropertyDescriptor','../../salesforce/errors/salesforce.error','salesforceService','repositoryName',']\x20[','../../shared/git-provider.manager','SalesforceSyncService','474564hgjVZB','GitBranchNotFoundError','name','sleep','[INFO]\x20Sync\x20job\x20done.','../jobs/flosum-sync.job','315932zoqEZL','url','__importStar','send','apply','__setModuleDefault','branchName','../../salesforce/dto/flosum-repository-sync.dto','toString','syncID','Service','decorate','SyncDirection','../../../constants','[INFO]\x20Repository\x20\x22','sfLogger','1vILIKS','../../hooks/hooks.utils','log','catch','object','__createBinding','have\x20to\x20synchronize\x20%d\x20branches','metadata','../jobs/git-sync.job','\x27\x20[','TooManyRequests','setLoggerId','\x27\x20in\x20repository\x20\x27','disableSync','isIntersects'];a188_0x399f=function(){return _0x109cb6;};return a188_0x399f();}a188_0x54c8f3();function a188_0x4240(_0x1adf59,_0x2007f4){const _0x30d9ca=a188_0x399f();return a188_0x4240=function(_0x54c8f3,_0x5c5f4a){_0x54c8f3=_0x54c8f3-0x141;let _0x399fe2=_0x30d9ca[_0x54c8f3];return _0x399fe2;},a188_0x4240(_0x1adf59,_0x2007f4);}'use strict';var __createBinding=this&&this[a188_0x2a470d(0x14b)]||(Object['create']?function(_0x84ddde,_0x486c7d,_0x1010b5,_0x25c4a8){if(_0x25c4a8===undefined)_0x25c4a8=_0x1010b5;Object['defineProperty'](_0x84ddde,_0x25c4a8,{'enumerable':!![],'get':function(){return _0x486c7d[_0x1010b5];}});}:function(_0x46f082,_0x87122e,_0x37ad43,_0x557570){if(_0x557570===undefined)_0x557570=_0x37ad43;_0x46f082[_0x557570]=_0x87122e[_0x37ad43];}),__setModuleDefault=this&&this[a188_0x2a470d(0x1b8)]||(Object[a188_0x2a470d(0x165)]?function(_0x20818a,_0x5a5188){const _0x448ec0=a188_0x2a470d;Object[_0x448ec0(0x158)](_0x20818a,_0x448ec0(0x18b),{'enumerable':!![],'value':_0x5a5188});}:function(_0x2d795d,_0x24539d){_0x2d795d['default']=_0x24539d;}),__decorate=this&&this['__decorate']||function(_0x5be738,_0x26210b,_0x24b412,_0x27978d){const _0xe8b2c9=a188_0x2a470d;var _0x430cae=arguments['length'],_0x4f8617=_0x430cae<0x3?_0x26210b:_0x27978d===null?_0x27978d=Object[_0xe8b2c9(0x1a6)](_0x26210b,_0x24b412):_0x27978d,_0x266ec3;if(typeof Reflect==='object'&&typeof Reflect[_0xe8b2c9(0x141)]==='function')_0x4f8617=Reflect[_0xe8b2c9(0x141)](_0x5be738,_0x26210b,_0x24b412,_0x27978d);else{for(var _0x3e67d1=_0x5be738[_0xe8b2c9(0x196)]-0x1;_0x3e67d1>=0x0;_0x3e67d1--)if(_0x266ec3=_0x5be738[_0x3e67d1])_0x4f8617=(_0x430cae<0x3?_0x266ec3(_0x4f8617):_0x430cae>0x3?_0x266ec3(_0x26210b,_0x24b412,_0x4f8617):_0x266ec3(_0x26210b,_0x24b412))||_0x4f8617;}return _0x430cae>0x3&&_0x4f8617&&Object[_0xe8b2c9(0x158)](_0x26210b,_0x24b412,_0x4f8617),_0x4f8617;},__importStar=this&&this[a188_0x2a470d(0x1b5)]||function(_0x12d1ab){const _0x57cd65=a188_0x2a470d;if(_0x12d1ab&&_0x12d1ab[_0x57cd65(0x183)])return _0x12d1ab;var _0x3584f4={};if(_0x12d1ab!=null){for(var _0x14e6af in _0x12d1ab)if(_0x14e6af!=='default'&&Object[_0x57cd65(0x192)][_0x57cd65(0x16f)][_0x57cd65(0x162)](_0x12d1ab,_0x14e6af))__createBinding(_0x3584f4,_0x12d1ab,_0x14e6af);}return __setModuleDefault(_0x3584f4,_0x12d1ab),_0x3584f4;},__metadata=this&&this['__metadata']||function(_0x230fe0,_0x42e25e){const _0x39fe8e=a188_0x2a470d;if(typeof Reflect===_0x39fe8e(0x14a)&&typeof Reflect[_0x39fe8e(0x14d)]===_0x39fe8e(0x16d))return Reflect['metadata'](_0x230fe0,_0x42e25e);},SyncService_1;Object['defineProperty'](exports,a188_0x2a470d(0x183),{'value':!![]}),exports['SyncService']=void 0x0;const constants_1=require(a188_0x2a470d(0x143)),core_1=require(a188_0x2a470d(0x169)),too_many_requests_error_1=require(a188_0x2a470d(0x186)),flosum_repository_sync_dto_1=require(a188_0x2a470d(0x1ba)),salesforce_error_1=require(a188_0x2a470d(0x1a7)),salesforce_logger_v2_service_1=require(a188_0x2a470d(0x1a1)),salesforce_sync_service_1=require(a188_0x2a470d(0x16b)),salesforce_service_1=require(a188_0x2a470d(0x16a)),git_provider_manager_1=require(a188_0x2a470d(0x1ab)),utils_1=require('../../shared/utils'),typedi_1=__importStar(require(a188_0x2a470d(0x170))),hooks_utils_1=require(a188_0x2a470d(0x147)),git_branch_not_found_error_1=require(a188_0x2a470d(0x15c)),flosum_sync_job_1=require(a188_0x2a470d(0x1b2)),git_sync_job_1=require(a188_0x2a470d(0x14e));let SyncService=SyncService_1=class SyncService{constructor(_0x5a9e2a,_0x1f046f,_0x520f33){const _0x3a402c=a188_0x2a470d;this['salesforceService']=_0x5a9e2a,this[_0x3a402c(0x194)]=_0x1f046f,this['gitManager']=_0x520f33,this[_0x3a402c(0x168)]=new core_1[(_0x3a402c(0x182))](SyncService_1[_0x3a402c(0x1af)]),this['repositoriesIntersections']={},this['repoList']=[];}async[a188_0x2a470d(0x19f)](_0x3331cd,_0x132cf7){const _0x27a8e0=a188_0x2a470d;if(_0x132cf7 instanceof git_branch_not_found_error_1[_0x27a8e0(0x1ae)]){await this[_0x27a8e0(0x194)][_0x27a8e0(0x15d)](_0x3331cd,_0x27a8e0(0x17c));return;}if(_0x132cf7 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x27a8e0(0x194)][_0x27a8e0(0x15d)](_0x3331cd,_0x27a8e0(0x185));throw _0x132cf7;}try{await this[_0x27a8e0(0x145)][_0x27a8e0(0x148)]('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x3331cd[_0x27a8e0(0x1a9)]+_0x27a8e0(0x14f)+_0x3331cd[_0x27a8e0(0x1b9)]+']\x20due\x20error\x20-\x20'+_0x132cf7)['send'](),await this[_0x27a8e0(0x194)][_0x27a8e0(0x160)](_0x3331cd,{}),await this['salesforceSync'][_0x27a8e0(0x15d)](_0x3331cd,'Error');}catch(_0x4ccfac){if(_0x4ccfac instanceof salesforce_error_1[_0x27a8e0(0x178)])throw _0x4ccfac;}}async['isIntersects'](_0x3d0776){const _0x176611=a188_0x2a470d;if(_0x3d0776['repositoryId']){const _0x6a1403=_0x3d0776['repositoryName'][_0x176611(0x1a4)](),_0x3c8682=this[_0x176611(0x18e)][_0x6a1403];if(!_0x3c8682)this['repositoriesIntersections'][_0x6a1403]=_0x3d0776[_0x176611(0x1a9)];else{if(_0x3c8682&&_0x3c8682!==_0x3d0776[_0x176611(0x1a9)])return await this[_0x176611(0x19f)](_0x3d0776,new Error(_0x176611(0x176)+_0x3d0776[_0x176611(0x1a9)]+_0x176611(0x155)+_0x6a1403+'\x27\x20-\x20\x27'+_0x3c8682+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x508524){const _0x403afb=a188_0x2a470d;if(!constants_1[_0x403afb(0x156)][_0x403afb(0x19c)](_0x508524['repositoryName']))return await this[_0x403afb(0x19f)](_0x508524,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x508524['repositoryName']+_0x403afb(0x15b))),![];if(!constants_1[_0x403afb(0x163)][_0x403afb(0x19c)](_0x508524[_0x403afb(0x1b9)]))return await this['handleRecordSyncError'](_0x508524,new Error(_0x403afb(0x19e)+_0x508524[_0x403afb(0x1b9)]+_0x403afb(0x152)+_0x508524[_0x403afb(0x1a9)]+_0x403afb(0x19b))),![];return!![];}async['getOrCreateRepo'](_0x2a56c9,_0x538356,_0x3a14e0){const _0x47c82e=a188_0x2a470d;let _0x4238f9=this['repoList'][_0x47c82e(0x17b)](_0x14c875=>_0x2a56c9[_0x47c82e(0x1a9)]===_0x14c875[_0x47c82e(0x1af)]);!_0x4238f9&&(this['sfLogger']['log'](_0x47c82e(0x144)+_0x2a56c9['repositoryName']+_0x47c82e(0x18f)),_0x4238f9=await this['repoService'][_0x47c82e(0x165)]({'name':_0x2a56c9[_0x47c82e(0x1a9)],'autoInit':!![],'defaultBranch':_0x2a56c9[_0x47c82e(0x1b9)],'private':!![],'createHook':this['syncDto'][_0x47c82e(0x19d)]}));if(this[_0x47c82e(0x1a3)][_0x47c82e(0x19d)]){const _0x237059=await _0x4238f9['hooks'][_0x47c82e(0x1a2)]();!_0x237059['find'](_0x26b299=>_0x26b299[_0x47c82e(0x1b4)]===hooks_utils_1[_0x47c82e(0x167)][_0x47c82e(0x17e)](_0x538356,_0x3a14e0))&&(this[_0x47c82e(0x145)][_0x47c82e(0x148)](_0x47c82e(0x144)+_0x2a56c9[_0x47c82e(0x1a9)]+_0x47c82e(0x173)),await _0x4238f9[_0x47c82e(0x166)][_0x47c82e(0x165)](hooks_utils_1['HooksUtils'][_0x47c82e(0x177)](_0x538356,_0x4238f9[_0x47c82e(0x166)],_0x3a14e0)));}return this[_0x47c82e(0x190)][_0x47c82e(0x19a)](_0x4238f9),_0x4238f9;}async['run'](_0x5b349f,_0x31f224,_0x15f617,_0xfcf9ec){const _0x368803=a188_0x2a470d;this[_0x368803(0x1a8)][_0x368803(0x151)](_0x31f224),this[_0x368803(0x199)]=this[_0x368803(0x172)][_0x368803(0x195)](_0x15f617),this[_0x368803(0x145)]=new salesforce_logger_v2_service_1[(_0x368803(0x175))](_0x31f224,'['+SyncService_1[_0x368803(0x1af)]+_0x368803(0x1aa)+_0x15f617[_0x368803(0x15e)]()+']'),this[_0x368803(0x1a3)]=_0x5b349f;try{await this[_0x368803(0x145)][_0x368803(0x148)](_0x368803(0x189))[_0x368803(0x1b6)]();const [_0x233422,_0x466428]=await Promise[_0x368803(0x18c)]([this['salesforceSync'][_0x368803(0x179)](),this[_0x368803(0x194)][_0x368803(0x157)]()]);this[_0x368803(0x190)]=await this['repoService'][_0x368803(0x1a2)]();const _0x399f90=[..._0x466428,..._0x233422];this[_0x368803(0x168)]['log'](_0x368803(0x14c),_0x399f90[_0x368803(0x196)]);for(const _0x4eb609 of _0x399f90){this[_0x368803(0x168)]['log']('syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch',_0x4eb609[_0x368803(0x1a9)],_0x4eb609[_0x368803(0x197)],_0x4eb609[_0x368803(0x1b9)],_0x4eb609[_0x368803(0x17a)]);const _0x2c8710=await this[_0x368803(0x17d)](_0x4eb609);if(!_0x2c8710)continue;const _0x3baf01=await this[_0x368803(0x154)](_0x4eb609);if(_0x3baf01)continue;let _0x320c41;try{_0x320c41=await this[_0x368803(0x159)](_0x4eb609,_0x15f617,_0xfcf9ec);}catch(_0x18691f){await this['handleRecordSyncError'](_0x4eb609,_0x18691f instanceof too_many_requests_error_1[_0x368803(0x150)]?_0x18691f:new Error(_0x368803(0x15f)+_0x18691f));continue;}await this[_0x368803(0x145)]['send']();if(_0x4eb609[_0x368803(0x191)]===flosum_repository_sync_dto_1[_0x368803(0x142)][_0x368803(0x181)]){const _0x1d5c3f=typedi_1[_0x368803(0x18b)]['get'](flosum_sync_job_1[_0x368803(0x184)]);await _0x1d5c3f[_0x368803(0x187)]({'repository':_0x320c41,'convertToSFDX':_0x5b349f['convertToSFDX'],'syncRecord':_0x4eb609,'provider':_0x15f617,'logger':this[_0x368803(0x145)]})[_0x368803(0x149)](_0x36ac9b=>this[_0x368803(0x19f)](_0x4eb609,_0x36ac9b));}else{const _0x445c4f=typedi_1[_0x368803(0x18b)][_0x368803(0x174)](git_sync_job_1[_0x368803(0x161)]);await _0x445c4f[_0x368803(0x187)]({'repository':_0x320c41,'branch':_0x4eb609['branchName'],'provider':_0x15f617,'repositoryGit':_0x320c41['gitUrl'],'syncRecord':_0x4eb609,'logger':this[_0x368803(0x145)]})[_0x368803(0x149)](_0x407eda=>this[_0x368803(0x19f)](_0x4eb609,_0x407eda));}}}catch(_0x5d3602){this[_0x368803(0x168)]['error'](_0x5d3602);_0x5d3602 instanceof too_many_requests_error_1[_0x368803(0x150)]?(await this[_0x368803(0x145)][_0x368803(0x148)]('[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')[_0x368803(0x1b6)](),await utils_1[_0x368803(0x1b0)](0x3c*0x3c*0x3e8),this['run'](_0x5b349f,_0x31f224,_0x15f617,_0xfcf9ec)):await this[_0x368803(0x145)]['log']('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x5d3602)[_0x368803(0x1b6)]();return;}await this[_0x368803(0x145)]['log'](_0x368803(0x1b1))[_0x368803(0x1b6)](),await this[_0x368803(0x194)][_0x368803(0x153)](_0x5b349f[_0x368803(0x1bc)])[_0x368803(0x149)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x2a470d(0x1bd)]({'transient':!![]}),__metadata(a188_0x2a470d(0x198),[salesforce_service_1[a188_0x2a470d(0x18d)],salesforce_sync_service_1[a188_0x2a470d(0x1ac)],git_provider_manager_1['GitProviderManager']])],SyncService),exports[a188_0x2a470d(0x188)]=SyncService;