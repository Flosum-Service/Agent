const a188_0x48c10e=a188_0x5651;function a188_0x13ff(){const _0x44118c=['2255496plQDoH','../../hooks/hooks.utils','../../../core','TooManyRequests','updateRemoteState','salesforceSync','../jobs/git-sync.job','log','FlosumToGit','defineProperty','metadata','(((.+)+)+)+$','typedi','hooks','toString','syncID','call','setLoggerId','getAll','SalesforceService','../../shared/utils','Error','design:paramtypes','41531gdykWl',']\x20[','function','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','repoList','repositoryId','getBranchRecords','GitBranchNotFoundError','default','3414064vZGdWl','createHooks','4lxTyRj','sfLogger','get','HooksUtils','gitUrl','50PHWMWp','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','__importStar','test','create','SalesforceLogger2','2810164GfuUvg','handleRecordSyncError','search','../../../constants','GitSyncJob','checkValidNaming','length','getHookLinkFor','Not\x20Synchronized','sleep','__esModule','logger','repoService','send','../../salesforce/errors/salesforce.error','catch','find','getOrCreateRepo','SyncDirection','__metadata','hasOwnProperty','apply','4658247ysFlFk','isIntersects','386028nqPKQV','[INFO]\x20Repository\x20\x22','disableSync','Service','branchName','__decorate','Unable\x20to\x20synchronize\x20repository\x20\x27','FlosumSyncJob','name','SalesforceSyncService','../jobs/flosum-sync.job','3430926EBeWUX','\x27\x20in\x20repository\x20\x27','run','prototype','SyncService','repositoriesIntersections','__setModuleDefault','../../salesforce/dto/flosum-repository-sync.dto','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','branchId','getOwnPropertyDescriptor','have\x20to\x20synchronize\x20%d\x20branches',']\x20due\x20error\x20-\x20','repositoryName','REPOSITORY_NAME_REGEXP','Waiting','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','../../salesforce/services/salesforce-sync.service','syncDto','BRANCH_NAME_REGEXP','salesforceService','../../../core/errors/too-many-requests.error','GitProviderManager','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','setStatus','SalesforceError','decorate','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','createHookPayload'];a188_0x13ff=function(){return _0x44118c;};return a188_0x13ff();}(function(_0xa17fa5,_0x4592e2){const _0x92f55a=a188_0x5651,_0x5db013=_0xa17fa5();while(!![]){try{const _0x133945=-parseInt(_0x92f55a(0x195))/0x1*(-parseInt(_0x92f55a(0x1a0))/0x2)+parseInt(_0x92f55a(0x1ce))/0x3+-parseInt(_0x92f55a(0x19e))/0x4+-parseInt(_0x92f55a(0x1a5))/0x5*(-parseInt(_0x92f55a(0x1c3))/0x6)+parseInt(_0x92f55a(0x1ab))/0x7+-parseInt(_0x92f55a(0x1eb))/0x8+-parseInt(_0x92f55a(0x1c1))/0x9;if(_0x133945===_0x4592e2)break;else _0x5db013['push'](_0x5db013['shift']());}catch(_0x4ff282){_0x5db013['push'](_0x5db013['shift']());}}}(a188_0x13ff,0x97004));const a188_0x4a45db=(function(){let _0xebe9a5=!![];return function(_0x1252b4,_0x15367c){const _0x43b8c3=_0xebe9a5?function(){const _0x457c68=a188_0x5651;if(_0x15367c){const _0x1ebe10=_0x15367c[_0x457c68(0x1c0)](_0x1252b4,arguments);return _0x15367c=null,_0x1ebe10;}}:function(){};return _0xebe9a5=![],_0x43b8c3;};}()),a188_0x5633be=a188_0x4a45db(this,function(){const _0x4b25b4=a188_0x5651;return a188_0x5633be['toString']()[_0x4b25b4(0x1ad)](_0x4b25b4(0x1f6))[_0x4b25b4(0x1f9)]()['constructor'](a188_0x5633be)[_0x4b25b4(0x1ad)](_0x4b25b4(0x1f6));});a188_0x5633be();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a188_0x48c10e(0x1a9)]?function(_0x572453,_0x5b5e78,_0x44f063,_0x1e001d){const _0x2964be=a188_0x48c10e;if(_0x1e001d===undefined)_0x1e001d=_0x44f063;Object[_0x2964be(0x1f4)](_0x572453,_0x1e001d,{'enumerable':!![],'get':function(){return _0x5b5e78[_0x44f063];}});}:function(_0x5f3ba1,_0x13198e,_0xa9bcd,_0xa48d73){if(_0xa48d73===undefined)_0xa48d73=_0xa9bcd;_0x5f3ba1[_0xa48d73]=_0x13198e[_0xa9bcd];}),__setModuleDefault=this&&this[a188_0x48c10e(0x1d4)]||(Object['create']?function(_0x2612ed,_0x2fecb6){const _0x131e5e=a188_0x48c10e;Object[_0x131e5e(0x1f4)](_0x2612ed,'default',{'enumerable':!![],'value':_0x2fecb6});}:function(_0x2e79cc,_0xb4d7e4){_0x2e79cc['default']=_0xb4d7e4;}),__decorate=this&&this[a188_0x48c10e(0x1c8)]||function(_0x5cbe62,_0x2e7de4,_0x55ed7a,_0x272d98){const _0x1c70dd=a188_0x48c10e;var _0x52014f=arguments[_0x1c70dd(0x1b1)],_0x36f3fc=_0x52014f<0x3?_0x2e7de4:_0x272d98===null?_0x272d98=Object[_0x1c70dd(0x1d8)](_0x2e7de4,_0x55ed7a):_0x272d98,_0x1b6489;if(typeof Reflect==='object'&&typeof Reflect[_0x1c70dd(0x1e8)]===_0x1c70dd(0x197))_0x36f3fc=Reflect[_0x1c70dd(0x1e8)](_0x5cbe62,_0x2e7de4,_0x55ed7a,_0x272d98);else{for(var _0x4b1021=_0x5cbe62['length']-0x1;_0x4b1021>=0x0;_0x4b1021--)if(_0x1b6489=_0x5cbe62[_0x4b1021])_0x36f3fc=(_0x52014f<0x3?_0x1b6489(_0x36f3fc):_0x52014f>0x3?_0x1b6489(_0x2e7de4,_0x55ed7a,_0x36f3fc):_0x1b6489(_0x2e7de4,_0x55ed7a))||_0x36f3fc;}return _0x52014f>0x3&&_0x36f3fc&&Object['defineProperty'](_0x2e7de4,_0x55ed7a,_0x36f3fc),_0x36f3fc;},__importStar=this&&this[a188_0x48c10e(0x1a7)]||function(_0x47e505){const _0x4020cf=a188_0x48c10e;if(_0x47e505&&_0x47e505[_0x4020cf(0x1b5)])return _0x47e505;var _0x39800d={};if(_0x47e505!=null){for(var _0x3b48f5 in _0x47e505)if(_0x3b48f5!==_0x4020cf(0x19d)&&Object[_0x4020cf(0x1d1)][_0x4020cf(0x1bf)][_0x4020cf(0x18e)](_0x47e505,_0x3b48f5))__createBinding(_0x39800d,_0x47e505,_0x3b48f5);}return __setModuleDefault(_0x39800d,_0x47e505),_0x39800d;},__metadata=this&&this[a188_0x48c10e(0x1be)]||function(_0x5e5f18,_0x7429eb){const _0x4d9247=a188_0x48c10e;if(typeof Reflect==='object'&&typeof Reflect[_0x4d9247(0x1f5)]==='function')return Reflect[_0x4d9247(0x1f5)](_0x5e5f18,_0x7429eb);},SyncService_1;Object['defineProperty'](exports,a188_0x48c10e(0x1b5),{'value':!![]}),exports[a188_0x48c10e(0x1d2)]=void 0x0;function a188_0x5651(_0xfcf76a,_0x5d771a){const _0x4e43da=a188_0x13ff();return a188_0x5651=function(_0x5633be,_0x4a45db){_0x5633be=_0x5633be-0x18d;let _0x13ffc2=_0x4e43da[_0x5633be];return _0x13ffc2;},a188_0x5651(_0xfcf76a,_0x5d771a);}const constants_1=require(a188_0x48c10e(0x1ae)),core_1=require(a188_0x48c10e(0x1ed)),too_many_requests_error_1=require(a188_0x48c10e(0x1e3)),flosum_repository_sync_dto_1=require(a188_0x48c10e(0x1d5)),salesforce_error_1=require(a188_0x48c10e(0x1b9)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_sync_service_1=require(a188_0x48c10e(0x1df)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a188_0x48c10e(0x192)),typedi_1=__importStar(require(a188_0x48c10e(0x1f7))),hooks_utils_1=require(a188_0x48c10e(0x1ec)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require(a188_0x48c10e(0x1cd)),git_sync_job_1=require(a188_0x48c10e(0x1f1));let SyncService=SyncService_1=class SyncService{constructor(_0x18a81f,_0x29c9ac,_0x484318){const _0x2c7c6b=a188_0x48c10e;this['salesforceService']=_0x18a81f,this['salesforceSync']=_0x29c9ac,this['gitManager']=_0x484318,this['logger']=new core_1['Logger'](SyncService_1['name']),this[_0x2c7c6b(0x1d3)]={},this[_0x2c7c6b(0x199)]=[];}async[a188_0x48c10e(0x1ac)](_0x53930a,_0x3f1e7b){const _0x49756e=a188_0x48c10e;if(_0x3f1e7b instanceof git_branch_not_found_error_1[_0x49756e(0x19c)]){await this[_0x49756e(0x1f0)][_0x49756e(0x1e6)](_0x53930a,_0x49756e(0x1b3));return;}if(_0x3f1e7b instanceof too_many_requests_error_1[_0x49756e(0x1ee)]){await this[_0x49756e(0x1f0)][_0x49756e(0x1e6)](_0x53930a,_0x49756e(0x1dd));throw _0x3f1e7b;}try{await this[_0x49756e(0x1a1)][_0x49756e(0x1f2)]('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x53930a[_0x49756e(0x1db)]+'\x27\x20['+_0x53930a[_0x49756e(0x1c7)]+_0x49756e(0x1da)+_0x3f1e7b)[_0x49756e(0x1b8)](),await this[_0x49756e(0x1f0)][_0x49756e(0x1ef)](_0x53930a,{}),await this[_0x49756e(0x1f0)][_0x49756e(0x1e6)](_0x53930a,_0x49756e(0x193));}catch(_0x197606){if(_0x197606 instanceof salesforce_error_1[_0x49756e(0x1e7)])throw _0x197606;}}async[a188_0x48c10e(0x1c2)](_0x5b91cf){const _0x2399c1=a188_0x48c10e;if(_0x5b91cf[_0x2399c1(0x19a)]){const _0x27adfb=_0x5b91cf[_0x2399c1(0x1db)]['toLowerCase'](),_0x8202ef=this[_0x2399c1(0x1d3)][_0x27adfb];if(!_0x8202ef)this[_0x2399c1(0x1d3)][_0x27adfb]=_0x5b91cf[_0x2399c1(0x1db)];else{if(_0x8202ef&&_0x8202ef!==_0x5b91cf[_0x2399c1(0x1db)])return await this[_0x2399c1(0x1ac)](_0x5b91cf,new Error(_0x2399c1(0x1c9)+_0x5b91cf[_0x2399c1(0x1db)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x27adfb+'\x27\x20-\x20\x27'+_0x8202ef+'\x27')),!![];}}return![];}async[a188_0x48c10e(0x1b0)](_0x47d5e9){const _0x455d59=a188_0x48c10e;if(!constants_1[_0x455d59(0x1dc)][_0x455d59(0x1a8)](_0x47d5e9[_0x455d59(0x1db)]))return await this[_0x455d59(0x1ac)](_0x47d5e9,new Error(_0x455d59(0x1c9)+_0x47d5e9['repositoryName']+_0x455d59(0x198))),![];if(!constants_1[_0x455d59(0x1e1)]['test'](_0x47d5e9[_0x455d59(0x1c7)]))return await this[_0x455d59(0x1ac)](_0x47d5e9,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x47d5e9[_0x455d59(0x1c7)]+_0x455d59(0x1cf)+_0x47d5e9[_0x455d59(0x1db)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a188_0x48c10e(0x1bc)](_0x4d76d2,_0x34f194,_0x1d49ca){const _0x4f547b=a188_0x48c10e;let _0x137c26=this[_0x4f547b(0x199)][_0x4f547b(0x1bb)](_0x2139e8=>_0x4d76d2[_0x4f547b(0x1db)]===_0x2139e8[_0x4f547b(0x1cb)]);!_0x137c26&&(this[_0x4f547b(0x1a1)][_0x4f547b(0x1f2)](_0x4f547b(0x1c4)+_0x4d76d2[_0x4f547b(0x1db)]+_0x4f547b(0x1e9)),_0x137c26=await this[_0x4f547b(0x1b7)][_0x4f547b(0x1a9)]({'name':_0x4d76d2[_0x4f547b(0x1db)],'autoInit':!![],'defaultBranch':_0x4d76d2['branchName'],'private':!![],'createHook':this[_0x4f547b(0x1e0)][_0x4f547b(0x19f)]}));if(this[_0x4f547b(0x1e0)][_0x4f547b(0x19f)]){const _0x3a1c0f=await _0x137c26[_0x4f547b(0x1f8)][_0x4f547b(0x190)]();!_0x3a1c0f[_0x4f547b(0x1bb)](_0x5d3b1a=>_0x5d3b1a['url']===hooks_utils_1[_0x4f547b(0x1a3)][_0x4f547b(0x1b2)](_0x34f194,_0x1d49ca))&&(this[_0x4f547b(0x1a1)][_0x4f547b(0x1f2)]('[INFO]\x20Repository\x20\x22'+_0x4d76d2[_0x4f547b(0x1db)]+_0x4f547b(0x1de)),await _0x137c26[_0x4f547b(0x1f8)][_0x4f547b(0x1a9)](hooks_utils_1[_0x4f547b(0x1a3)][_0x4f547b(0x1ea)](_0x34f194,_0x137c26[_0x4f547b(0x1f8)],_0x1d49ca)));}return this['repoList']['push'](_0x137c26),_0x137c26;}async[a188_0x48c10e(0x1d0)](_0x3d757c,_0x526241,_0x573fc9,_0x28d159){const _0x4c7c7e=a188_0x48c10e;this[_0x4c7c7e(0x1e2)][_0x4c7c7e(0x18f)](_0x526241),this[_0x4c7c7e(0x1b7)]=this['gitManager']['getRepoService'](_0x573fc9),this[_0x4c7c7e(0x1a1)]=new salesforce_logger_v2_service_1[(_0x4c7c7e(0x1aa))](_0x526241,'['+SyncService_1[_0x4c7c7e(0x1cb)]+_0x4c7c7e(0x196)+_0x573fc9['toUpperCase']()+']'),this[_0x4c7c7e(0x1e0)]=_0x3d757c;try{await this[_0x4c7c7e(0x1a1)][_0x4c7c7e(0x1f2)]('[INFO]\x20Start\x20sync\x20job')[_0x4c7c7e(0x1b8)]();const [_0x3a5194,_0x531817]=await Promise['all']([this[_0x4c7c7e(0x1f0)][_0x4c7c7e(0x19b)](),this[_0x4c7c7e(0x1f0)]['getRepositoryRecords']()]);this[_0x4c7c7e(0x199)]=await this[_0x4c7c7e(0x1b7)][_0x4c7c7e(0x190)]();const _0x1b8276=[..._0x531817,..._0x3a5194];this[_0x4c7c7e(0x1b6)]['log'](_0x4c7c7e(0x1d9),_0x1b8276[_0x4c7c7e(0x1b1)]);for(const _0x2c40de of _0x1b8276){this['logger'][_0x4c7c7e(0x1f2)]('syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch',_0x2c40de[_0x4c7c7e(0x1db)],_0x2c40de[_0x4c7c7e(0x19a)],_0x2c40de['branchName'],_0x2c40de[_0x4c7c7e(0x1d7)]);const _0x2917bd=await this[_0x4c7c7e(0x1b0)](_0x2c40de);if(!_0x2917bd)continue;const _0x1237c1=await this[_0x4c7c7e(0x1c2)](_0x2c40de);if(_0x1237c1)continue;let _0x1f38e9;try{_0x1f38e9=await this[_0x4c7c7e(0x1bc)](_0x2c40de,_0x573fc9,_0x28d159);}catch(_0x40acbb){await this[_0x4c7c7e(0x1ac)](_0x2c40de,_0x40acbb instanceof too_many_requests_error_1[_0x4c7c7e(0x1ee)]?_0x40acbb:new Error(_0x4c7c7e(0x1d6)+_0x40acbb));continue;}await this[_0x4c7c7e(0x1a1)]['send']();if(_0x2c40de['direction']===flosum_repository_sync_dto_1[_0x4c7c7e(0x1bd)][_0x4c7c7e(0x1f3)]){const _0x1ba6fa=typedi_1[_0x4c7c7e(0x19d)][_0x4c7c7e(0x1a2)](flosum_sync_job_1[_0x4c7c7e(0x1ca)]);await _0x1ba6fa[_0x4c7c7e(0x1d0)]({'repository':_0x1f38e9,'convertToSFDX':_0x3d757c['convertToSFDX'],'syncRecord':_0x2c40de,'provider':_0x573fc9,'logger':this[_0x4c7c7e(0x1a1)]})[_0x4c7c7e(0x1ba)](_0x4c4053=>this[_0x4c7c7e(0x1ac)](_0x2c40de,_0x4c4053));}else{const _0x27a840=typedi_1['default']['get'](git_sync_job_1[_0x4c7c7e(0x1af)]);await _0x27a840[_0x4c7c7e(0x1d0)]({'repository':_0x1f38e9,'branch':_0x2c40de[_0x4c7c7e(0x1c7)],'provider':_0x573fc9,'repositoryGit':_0x1f38e9[_0x4c7c7e(0x1a4)],'syncRecord':_0x2c40de,'logger':this['sfLogger']})[_0x4c7c7e(0x1ba)](_0x50773e=>this[_0x4c7c7e(0x1ac)](_0x2c40de,_0x50773e));}}}catch(_0x325464){this[_0x4c7c7e(0x1b6)]['error'](_0x325464);_0x325464 instanceof too_many_requests_error_1[_0x4c7c7e(0x1ee)]?(await this[_0x4c7c7e(0x1a1)][_0x4c7c7e(0x1f2)](_0x4c7c7e(0x1e5))['send'](),await utils_1[_0x4c7c7e(0x1b4)](0x3c*0x3c*0x3e8),this['run'](_0x3d757c,_0x526241,_0x573fc9,_0x28d159)):await this['sfLogger']['log'](_0x4c7c7e(0x1a6)+_0x325464)['send']();return;}await this[_0x4c7c7e(0x1a1)][_0x4c7c7e(0x1f2)]('[INFO]\x20Sync\x20job\x20done.')[_0x4c7c7e(0x1b8)](),await this[_0x4c7c7e(0x1f0)][_0x4c7c7e(0x1c5)](_0x3d757c[_0x4c7c7e(0x18d)])[_0x4c7c7e(0x1ba)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x48c10e(0x1c6)]({'transient':!![]}),__metadata(a188_0x48c10e(0x194),[salesforce_service_1[a188_0x48c10e(0x191)],salesforce_sync_service_1[a188_0x48c10e(0x1cc)],git_provider_manager_1[a188_0x48c10e(0x1e4)]])],SyncService),exports[a188_0x48c10e(0x1d2)]=SyncService;