const a188_0x3f5e71=a188_0x1bc4;(function(_0x33fb92,_0x4d085b){const _0x106d11=a188_0x1bc4,_0x9d52f0=_0x33fb92();while(!![]){try{const _0x4f54bb=-parseInt(_0x106d11(0x1b0))/0x1*(-parseInt(_0x106d11(0x212))/0x2)+parseInt(_0x106d11(0x206))/0x3+parseInt(_0x106d11(0x1d1))/0x4+-parseInt(_0x106d11(0x1b3))/0x5+parseInt(_0x106d11(0x1ec))/0x6*(parseInt(_0x106d11(0x1c2))/0x7)+-parseInt(_0x106d11(0x21c))/0x8+-parseInt(_0x106d11(0x218))/0x9;if(_0x4f54bb===_0x4d085b)break;else _0x9d52f0['push'](_0x9d52f0['shift']());}catch(_0x37b6ac){_0x9d52f0['push'](_0x9d52f0['shift']());}}}(a188_0x5c86,0x7333e));const a188_0x5dd011=(function(){let _0x334657=!![];return function(_0x148cd9,_0x153d53){const _0x20499b=_0x334657?function(){if(_0x153d53){const _0x23058b=_0x153d53['apply'](_0x148cd9,arguments);return _0x153d53=null,_0x23058b;}}:function(){};return _0x334657=![],_0x20499b;};}()),a188_0xe85a6a=a188_0x5dd011(this,function(){const _0x3698bd=a188_0x1bc4;return a188_0xe85a6a['toString']()[_0x3698bd(0x1c9)](_0x3698bd(0x208))[_0x3698bd(0x1df)]()[_0x3698bd(0x1d4)](a188_0xe85a6a)[_0x3698bd(0x1c9)](_0x3698bd(0x208));});function a188_0x5c86(){const _0xa35223=['design:paramtypes','1815532uqvYXO','send','../../salesforce/dto/flosum-repository-sync.dto','constructor','../../salesforce/services/salesforce-logger-v2.service','salesforceSync','Not\x20Synchronized','default','create','../jobs/flosum-sync.job','syncDto','name','call','gitUrl','toString','getAll','__importStar','__createBinding','toUpperCase','logger','SalesforceLogger2','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','Waiting','createHooks','GitProviderManager','url','1592538vkTiur','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','catch','SalesforceError','__decorate','test',']\x20due\x20error\x20-\x20','../../salesforce/errors/salesforce.error','gitManager','../../salesforce/services/salesforce.service','updateRemoteState','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','log','getRepoService','push','repositoriesIntersections','FlosumToGit','handleRecordSyncError','TooManyRequests','../../../constants','isIntersects','checkValidNaming','sfLogger','defineProperty','salesforceService','setStatus','2572095iZYWzo','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','(((.+)+)+)+$','../errors/git-branch-not-found.error','repoList','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','branchName','Service','[INFO]\x20Repository\x20\x22','[INFO]\x20Start\x20sync\x20job','toLowerCase','Logger','8oQaUcR','../../hooks/hooks.utils','Unable\x20to\x20synchronize\x20repository\x20\x27','function','get','SalesforceSyncService','9150867DLlrYv','sleep','metadata','find','2228256ebhCVT','BRANCH_NAME_REGEXP','all','__setModuleDefault','\x27\x20in\x20repository\x20\x27','decorate','SyncService','98099idPmMJ','object','createHookPayload','1009510EbjQAu','FlosumSyncJob','repositoryName','../../shared/utils','direction','repoService','GitBranchNotFoundError','error','getOrCreateRepo','setLoggerId','hasOwnProperty','syncID','[INFO]\x20Sync\x20job\x20done.','\x27\x20-\x20\x27','hooks','7WGFhRA','__esModule','Error','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','HooksUtils','../../salesforce/services/salesforce-sync.service','repositoryId','search','../jobs/git-sync.job','length','have\x20to\x20synchronize\x20%d\x20branches','../../../core/errors/too-many-requests.error','run','SalesforceService'];a188_0x5c86=function(){return _0xa35223;};return a188_0x5c86();}a188_0xe85a6a();function a188_0x1bc4(_0x322102,_0x330edb){const _0x4190e3=a188_0x5c86();return a188_0x1bc4=function(_0xe85a6a,_0x5dd011){_0xe85a6a=_0xe85a6a-0x1ae;let _0x5c869f=_0x4190e3[_0xe85a6a];return _0x5c869f;},a188_0x1bc4(_0x322102,_0x330edb);}'use strict';var __createBinding=this&&this[a188_0x3f5e71(0x1e2)]||(Object[a188_0x3f5e71(0x1d9)]?function(_0x2df701,_0x17f0e7,_0x3d4d6c,_0x170a82){if(_0x170a82===undefined)_0x170a82=_0x3d4d6c;Object['defineProperty'](_0x2df701,_0x170a82,{'enumerable':!![],'get':function(){return _0x17f0e7[_0x3d4d6c];}});}:function(_0x3ee47b,_0xc5f8b4,_0x4eb1df,_0x18b467){if(_0x18b467===undefined)_0x18b467=_0x4eb1df;_0x3ee47b[_0x18b467]=_0xc5f8b4[_0x4eb1df];}),__setModuleDefault=this&&this[a188_0x3f5e71(0x21f)]||(Object[a188_0x3f5e71(0x1d9)]?function(_0x5e4053,_0x1314d3){const _0x3cd092=a188_0x3f5e71;Object[_0x3cd092(0x203)](_0x5e4053,_0x3cd092(0x1d8),{'enumerable':!![],'value':_0x1314d3});}:function(_0x4d66e4,_0x484131){_0x4d66e4['default']=_0x484131;}),__decorate=this&&this[a188_0x3f5e71(0x1f0)]||function(_0x478dd5,_0x2344cb,_0x4bf93b,_0xc287f8){const _0x7464e1=a188_0x3f5e71;var _0x1a5b9a=arguments[_0x7464e1(0x1cb)],_0x36af2a=_0x1a5b9a<0x3?_0x2344cb:_0xc287f8===null?_0xc287f8=Object['getOwnPropertyDescriptor'](_0x2344cb,_0x4bf93b):_0xc287f8,_0x640cd6;if(typeof Reflect===_0x7464e1(0x1b1)&&typeof Reflect[_0x7464e1(0x1ae)]==='function')_0x36af2a=Reflect['decorate'](_0x478dd5,_0x2344cb,_0x4bf93b,_0xc287f8);else{for(var _0x154bff=_0x478dd5['length']-0x1;_0x154bff>=0x0;_0x154bff--)if(_0x640cd6=_0x478dd5[_0x154bff])_0x36af2a=(_0x1a5b9a<0x3?_0x640cd6(_0x36af2a):_0x1a5b9a>0x3?_0x640cd6(_0x2344cb,_0x4bf93b,_0x36af2a):_0x640cd6(_0x2344cb,_0x4bf93b))||_0x36af2a;}return _0x1a5b9a>0x3&&_0x36af2a&&Object[_0x7464e1(0x203)](_0x2344cb,_0x4bf93b,_0x36af2a),_0x36af2a;},__importStar=this&&this[a188_0x3f5e71(0x1e1)]||function(_0x2aba17){const _0x647350=a188_0x3f5e71;if(_0x2aba17&&_0x2aba17[_0x647350(0x1c3)])return _0x2aba17;var _0x186455={};if(_0x2aba17!=null){for(var _0x97536f in _0x2aba17)if(_0x97536f!==_0x647350(0x1d8)&&Object['prototype'][_0x647350(0x1bd)][_0x647350(0x1dd)](_0x2aba17,_0x97536f))__createBinding(_0x186455,_0x2aba17,_0x97536f);}return __setModuleDefault(_0x186455,_0x2aba17),_0x186455;},__metadata=this&&this['__metadata']||function(_0x28147d,_0x872cff){const _0x584b5f=a188_0x3f5e71;if(typeof Reflect===_0x584b5f(0x1b1)&&typeof Reflect[_0x584b5f(0x21a)]===_0x584b5f(0x215))return Reflect['metadata'](_0x28147d,_0x872cff);},SyncService_1;Object[a188_0x3f5e71(0x203)](exports,a188_0x3f5e71(0x1c3),{'value':!![]}),exports[a188_0x3f5e71(0x1af)]=void 0x0;const constants_1=require(a188_0x3f5e71(0x1ff)),core_1=require('../../../core'),too_many_requests_error_1=require(a188_0x3f5e71(0x1cd)),flosum_repository_sync_dto_1=require(a188_0x3f5e71(0x1d3)),salesforce_error_1=require(a188_0x3f5e71(0x1f3)),salesforce_logger_v2_service_1=require(a188_0x3f5e71(0x1d5)),salesforce_sync_service_1=require(a188_0x3f5e71(0x1c7)),salesforce_service_1=require(a188_0x3f5e71(0x1f5)),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a188_0x3f5e71(0x1b6)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a188_0x3f5e71(0x213)),git_branch_not_found_error_1=require(a188_0x3f5e71(0x209)),flosum_sync_job_1=require(a188_0x3f5e71(0x1da)),git_sync_job_1=require(a188_0x3f5e71(0x1ca));let SyncService=SyncService_1=class SyncService{constructor(_0x435d91,_0x2c2fdc,_0x2cc120){const _0x3c64fb=a188_0x3f5e71;this[_0x3c64fb(0x204)]=_0x435d91,this[_0x3c64fb(0x1d6)]=_0x2c2fdc,this['gitManager']=_0x2cc120,this[_0x3c64fb(0x1e4)]=new core_1[(_0x3c64fb(0x211))](SyncService_1[_0x3c64fb(0x1dc)]),this[_0x3c64fb(0x1fb)]={},this[_0x3c64fb(0x20a)]=[];}async[a188_0x3f5e71(0x1fd)](_0x18803b,_0xd00a6b){const _0x133f41=a188_0x3f5e71;if(_0xd00a6b instanceof git_branch_not_found_error_1[_0x133f41(0x1b9)]){await this['salesforceSync'][_0x133f41(0x205)](_0x18803b,_0x133f41(0x1d7));return;}if(_0xd00a6b instanceof too_many_requests_error_1[_0x133f41(0x1fe)]){await this[_0x133f41(0x1d6)][_0x133f41(0x205)](_0x18803b,_0x133f41(0x1e8));throw _0xd00a6b;}try{await this[_0x133f41(0x202)][_0x133f41(0x1f8)](_0x133f41(0x1f7)+_0x18803b[_0x133f41(0x1b5)]+'\x27\x20['+_0x18803b[_0x133f41(0x20c)]+_0x133f41(0x1f2)+_0xd00a6b)['send'](),await this[_0x133f41(0x1d6)][_0x133f41(0x1f6)](_0x18803b,{}),await this[_0x133f41(0x1d6)][_0x133f41(0x205)](_0x18803b,_0x133f41(0x1c4));}catch(_0x4b62c3){if(_0x4b62c3 instanceof salesforce_error_1[_0x133f41(0x1ef)])throw _0x4b62c3;}}async[a188_0x3f5e71(0x200)](_0x6a6e4){const _0x5b03c5=a188_0x3f5e71;if(_0x6a6e4[_0x5b03c5(0x1c8)]){const _0x61b99b=_0x6a6e4[_0x5b03c5(0x1b5)][_0x5b03c5(0x210)](),_0x58e4a9=this[_0x5b03c5(0x1fb)][_0x61b99b];if(!_0x58e4a9)this['repositoriesIntersections'][_0x61b99b]=_0x6a6e4['repositoryName'];else{if(_0x58e4a9&&_0x58e4a9!==_0x6a6e4[_0x5b03c5(0x1b5)])return await this['handleRecordSyncError'](_0x6a6e4,new Error(_0x5b03c5(0x214)+_0x6a6e4[_0x5b03c5(0x1b5)]+_0x5b03c5(0x20b)+_0x61b99b+_0x5b03c5(0x1c0)+_0x58e4a9+'\x27')),!![];}}return![];}async[a188_0x3f5e71(0x201)](_0xd1a5e9){const _0x279fc7=a188_0x3f5e71;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x279fc7(0x1f1)](_0xd1a5e9[_0x279fc7(0x1b5)]))return await this[_0x279fc7(0x1fd)](_0xd1a5e9,new Error(_0x279fc7(0x214)+_0xd1a5e9['repositoryName']+_0x279fc7(0x1e6))),![];if(!constants_1[_0x279fc7(0x21d)][_0x279fc7(0x1f1)](_0xd1a5e9[_0x279fc7(0x20c)]))return await this[_0x279fc7(0x1fd)](_0xd1a5e9,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0xd1a5e9['branchName']+_0x279fc7(0x220)+_0xd1a5e9[_0x279fc7(0x1b5)]+_0x279fc7(0x1ed))),![];return!![];}async[a188_0x3f5e71(0x1bb)](_0x159bc0,_0xdd5cb8,_0x9ea43e){const _0x3def54=a188_0x3f5e71;let _0x12ad05=this['repoList'][_0x3def54(0x21b)](_0x2080ef=>_0x159bc0['repositoryName']===_0x2080ef[_0x3def54(0x1dc)]);!_0x12ad05&&(this['sfLogger'][_0x3def54(0x1f8)](_0x3def54(0x20e)+_0x159bc0[_0x3def54(0x1b5)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x12ad05=await this[_0x3def54(0x1b8)][_0x3def54(0x1d9)]({'name':_0x159bc0[_0x3def54(0x1b5)],'autoInit':!![],'defaultBranch':_0x159bc0[_0x3def54(0x20c)],'private':!![],'createHook':this[_0x3def54(0x1db)]['createHooks']}));if(this[_0x3def54(0x1db)][_0x3def54(0x1e9)]){const _0x49f2a8=await _0x12ad05[_0x3def54(0x1c1)][_0x3def54(0x1e0)]();!_0x49f2a8[_0x3def54(0x21b)](_0x4eb190=>_0x4eb190[_0x3def54(0x1eb)]===hooks_utils_1[_0x3def54(0x1c6)]['getHookLinkFor'](_0xdd5cb8,_0x9ea43e))&&(this[_0x3def54(0x202)][_0x3def54(0x1f8)](_0x3def54(0x20e)+_0x159bc0[_0x3def54(0x1b5)]+_0x3def54(0x207)),await _0x12ad05[_0x3def54(0x1c1)][_0x3def54(0x1d9)](hooks_utils_1['HooksUtils'][_0x3def54(0x1b2)](_0xdd5cb8,_0x12ad05['hooks'],_0x9ea43e)));}return this[_0x3def54(0x20a)][_0x3def54(0x1fa)](_0x12ad05),_0x12ad05;}async[a188_0x3f5e71(0x1ce)](_0x3e8911,_0x40422c,_0x9bc0f5,_0x2bfe35){const _0x190bbd=a188_0x3f5e71;this[_0x190bbd(0x204)][_0x190bbd(0x1bc)](_0x40422c),this[_0x190bbd(0x1b8)]=this[_0x190bbd(0x1f4)][_0x190bbd(0x1f9)](_0x9bc0f5),this[_0x190bbd(0x202)]=new salesforce_logger_v2_service_1[(_0x190bbd(0x1e5))](_0x40422c,'['+SyncService_1['name']+']\x20['+_0x9bc0f5[_0x190bbd(0x1e3)]()+']'),this['syncDto']=_0x3e8911;try{await this[_0x190bbd(0x202)][_0x190bbd(0x1f8)](_0x190bbd(0x20f))[_0x190bbd(0x1d2)]();const [_0x42aef3,_0x225e52]=await Promise[_0x190bbd(0x21e)]([this[_0x190bbd(0x1d6)]['getBranchRecords'](),this['salesforceSync']['getRepositoryRecords']()]);this[_0x190bbd(0x20a)]=await this[_0x190bbd(0x1b8)][_0x190bbd(0x1e0)]();const _0x23c079=[..._0x225e52,..._0x42aef3];this['logger'][_0x190bbd(0x1f8)](_0x190bbd(0x1cc),_0x23c079['length']);for(const _0x11cd75 of _0x23c079){this[_0x190bbd(0x1e4)][_0x190bbd(0x1f8)](_0x190bbd(0x1c5),_0x11cd75[_0x190bbd(0x1b5)],_0x11cd75['repositoryId'],_0x11cd75[_0x190bbd(0x20c)],_0x11cd75['branchId']);const _0x2df6b0=await this['checkValidNaming'](_0x11cd75);if(!_0x2df6b0)continue;const _0x8e1ef6=await this[_0x190bbd(0x200)](_0x11cd75);if(_0x8e1ef6)continue;let _0x176b6e;try{_0x176b6e=await this[_0x190bbd(0x1bb)](_0x11cd75,_0x9bc0f5,_0x2bfe35);}catch(_0xe5ee39){await this[_0x190bbd(0x1fd)](_0x11cd75,_0xe5ee39 instanceof too_many_requests_error_1[_0x190bbd(0x1fe)]?_0xe5ee39:new Error(_0x190bbd(0x1e7)+_0xe5ee39));continue;}await this[_0x190bbd(0x202)]['send']();if(_0x11cd75[_0x190bbd(0x1b7)]===flosum_repository_sync_dto_1['SyncDirection'][_0x190bbd(0x1fc)]){const _0x284532=typedi_1[_0x190bbd(0x1d8)][_0x190bbd(0x216)](flosum_sync_job_1[_0x190bbd(0x1b4)]);await _0x284532[_0x190bbd(0x1ce)]({'repository':_0x176b6e,'convertToSFDX':_0x3e8911['convertToSFDX'],'syncRecord':_0x11cd75,'provider':_0x9bc0f5,'logger':this[_0x190bbd(0x202)]})[_0x190bbd(0x1ee)](_0x202b87=>this[_0x190bbd(0x1fd)](_0x11cd75,_0x202b87));}else{const _0x314cca=typedi_1[_0x190bbd(0x1d8)][_0x190bbd(0x216)](git_sync_job_1['GitSyncJob']);await _0x314cca[_0x190bbd(0x1ce)]({'repository':_0x176b6e,'branch':_0x11cd75[_0x190bbd(0x20c)],'provider':_0x9bc0f5,'repositoryGit':_0x176b6e[_0x190bbd(0x1de)],'syncRecord':_0x11cd75,'logger':this[_0x190bbd(0x202)]})['catch'](_0x2efc34=>this['handleRecordSyncError'](_0x11cd75,_0x2efc34));}}}catch(_0x480246){this['logger'][_0x190bbd(0x1ba)](_0x480246);_0x480246 instanceof too_many_requests_error_1[_0x190bbd(0x1fe)]?(await this[_0x190bbd(0x202)]['log']('[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')['send'](),await utils_1[_0x190bbd(0x219)](0x3c*0x3c*0x3e8),this[_0x190bbd(0x1ce)](_0x3e8911,_0x40422c,_0x9bc0f5,_0x2bfe35)):await this[_0x190bbd(0x202)][_0x190bbd(0x1f8)]('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x480246)[_0x190bbd(0x1d2)]();return;}await this[_0x190bbd(0x202)]['log'](_0x190bbd(0x1bf))[_0x190bbd(0x1d2)](),await this['salesforceSync']['disableSync'](_0x3e8911[_0x190bbd(0x1be)])[_0x190bbd(0x1ee)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x3f5e71(0x20d)]({'transient':!![]}),__metadata(a188_0x3f5e71(0x1d0),[salesforce_service_1[a188_0x3f5e71(0x1cf)],salesforce_sync_service_1[a188_0x3f5e71(0x217)],git_provider_manager_1[a188_0x3f5e71(0x1ea)]])],SyncService),exports[a188_0x3f5e71(0x1af)]=SyncService;