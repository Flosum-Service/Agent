const a188_0x2cf358=a188_0x36c6;(function(_0x55b1fe,_0x22d827){const _0x415039=a188_0x36c6,_0x4f800d=_0x55b1fe();while(!![]){try{const _0x5402e9=parseInt(_0x415039(0x189))/0x1*(parseInt(_0x415039(0x186))/0x2)+parseInt(_0x415039(0x1dc))/0x3+-parseInt(_0x415039(0x1bb))/0x4*(parseInt(_0x415039(0x1f1))/0x5)+-parseInt(_0x415039(0x1ec))/0x6+-parseInt(_0x415039(0x1f7))/0x7+parseInt(_0x415039(0x1ca))/0x8*(parseInt(_0x415039(0x1bc))/0x9)+-parseInt(_0x415039(0x1ad))/0xa*(parseInt(_0x415039(0x1e0))/0xb);if(_0x5402e9===_0x22d827)break;else _0x4f800d['push'](_0x4f800d['shift']());}catch(_0x2fc74f){_0x4f800d['push'](_0x4f800d['shift']());}}}(a188_0x9e84,0x1eec6));const a188_0x3061f9=(function(){let _0x420068=!![];return function(_0x46d7e9,_0x1fb79f){const _0x299ef3=_0x420068?function(){const _0x11a434=a188_0x36c6;if(_0x1fb79f){const _0x38624c=_0x1fb79f[_0x11a434(0x1da)](_0x46d7e9,arguments);return _0x1fb79f=null,_0x38624c;}}:function(){};return _0x420068=![],_0x299ef3;};}()),a188_0x2bbebf=a188_0x3061f9(this,function(){const _0x2c0014=a188_0x36c6;return a188_0x2bbebf['toString']()['search']('(((.+)+)+)+$')[_0x2c0014(0x1ae)]()[_0x2c0014(0x1b2)](a188_0x2bbebf)[_0x2c0014(0x1a9)](_0x2c0014(0x180));});a188_0x2bbebf();'use strict';var __createBinding=this&&this[a188_0x2cf358(0x18d)]||(Object[a188_0x2cf358(0x1a8)]?function(_0x46d2bc,_0x17da1e,_0x4ff7be,_0x5d057a){const _0x5582ae=a188_0x2cf358;if(_0x5d057a===undefined)_0x5d057a=_0x4ff7be;Object[_0x5582ae(0x19d)](_0x46d2bc,_0x5d057a,{'enumerable':!![],'get':function(){return _0x17da1e[_0x4ff7be];}});}:function(_0x1a6a02,_0x2dd977,_0x514e1c,_0x24069f){if(_0x24069f===undefined)_0x24069f=_0x514e1c;_0x1a6a02[_0x24069f]=_0x2dd977[_0x514e1c];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a188_0x2cf358(0x1a8)]?function(_0x736490,_0x1e867b){const _0x48af34=a188_0x2cf358;Object['defineProperty'](_0x736490,_0x48af34(0x1a3),{'enumerable':!![],'value':_0x1e867b});}:function(_0x3f87ef,_0x3218c8){const _0x46362d=a188_0x2cf358;_0x3f87ef[_0x46362d(0x1a3)]=_0x3218c8;}),__decorate=this&&this[a188_0x2cf358(0x191)]||function(_0x1e9185,_0x26b2fd,_0x380518,_0x2ab2d4){const _0x48e315=a188_0x2cf358;var _0x40abfd=arguments[_0x48e315(0x1c0)],_0x285b75=_0x40abfd<0x3?_0x26b2fd:_0x2ab2d4===null?_0x2ab2d4=Object[_0x48e315(0x1c7)](_0x26b2fd,_0x380518):_0x2ab2d4,_0x2aa82b;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x285b75=Reflect[_0x48e315(0x1e4)](_0x1e9185,_0x26b2fd,_0x380518,_0x2ab2d4);else{for(var _0x3a0c0d=_0x1e9185[_0x48e315(0x1c0)]-0x1;_0x3a0c0d>=0x0;_0x3a0c0d--)if(_0x2aa82b=_0x1e9185[_0x3a0c0d])_0x285b75=(_0x40abfd<0x3?_0x2aa82b(_0x285b75):_0x40abfd>0x3?_0x2aa82b(_0x26b2fd,_0x380518,_0x285b75):_0x2aa82b(_0x26b2fd,_0x380518))||_0x285b75;}return _0x40abfd>0x3&&_0x285b75&&Object[_0x48e315(0x19d)](_0x26b2fd,_0x380518,_0x285b75),_0x285b75;},__importStar=this&&this[a188_0x2cf358(0x1a0)]||function(_0x328155){const _0x4d055c=a188_0x2cf358;if(_0x328155&&_0x328155[_0x4d055c(0x1b7)])return _0x328155;var _0x2e967a={};if(_0x328155!=null){for(var _0x4baedd in _0x328155)if(_0x4baedd!==_0x4d055c(0x1a3)&&Object[_0x4d055c(0x1f9)][_0x4d055c(0x1c5)][_0x4d055c(0x1a7)](_0x328155,_0x4baedd))__createBinding(_0x2e967a,_0x328155,_0x4baedd);}return __setModuleDefault(_0x2e967a,_0x328155),_0x2e967a;},__metadata=this&&this[a188_0x2cf358(0x1cf)]||function(_0xfbbc6c,_0x105871){const _0x21dd7b=a188_0x2cf358;if(typeof Reflect===_0x21dd7b(0x1f6)&&typeof Reflect[_0x21dd7b(0x1d9)]==='function')return Reflect[_0x21dd7b(0x1d9)](_0xfbbc6c,_0x105871);},SyncService_1;Object[a188_0x2cf358(0x19d)](exports,a188_0x2cf358(0x1b7),{'value':!![]}),exports[a188_0x2cf358(0x1b3)]=void 0x0;function a188_0x36c6(_0x53df44,_0x2cd393){const _0x4267d9=a188_0x9e84();return a188_0x36c6=function(_0x2bbebf,_0x3061f9){_0x2bbebf=_0x2bbebf-0x180;let _0x9e8491=_0x4267d9[_0x2bbebf];return _0x9e8491;},a188_0x36c6(_0x53df44,_0x2cd393);}const constants_1=require(a188_0x2cf358(0x1a1)),core_1=require(a188_0x2cf358(0x18b)),too_many_requests_error_1=require(a188_0x2cf358(0x1ac)),flosum_repository_sync_dto_1=require(a188_0x2cf358(0x1be)),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_logger_v2_service_1=require(a188_0x2cf358(0x1ef)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a188_0x2cf358(0x1d6)),git_provider_manager_1=require(a188_0x2cf358(0x1d0)),utils_1=require(a188_0x2cf358(0x19a)),typedi_1=__importStar(require(a188_0x2cf358(0x1ab))),hooks_utils_1=require(a188_0x2cf358(0x199)),git_branch_not_found_error_1=require(a188_0x2cf358(0x1db)),flosum_sync_job_1=require(a188_0x2cf358(0x1e5)),git_sync_job_1=require(a188_0x2cf358(0x1e6));let SyncService=SyncService_1=class SyncService{constructor(_0x1c7fb9,_0x5073c5,_0x3a0710){const _0x249a90=a188_0x2cf358;this[_0x249a90(0x198)]=_0x1c7fb9,this[_0x249a90(0x19e)]=_0x5073c5,this['gitManager']=_0x3a0710,this[_0x249a90(0x1c4)]=new core_1[(_0x249a90(0x1c9))](SyncService_1[_0x249a90(0x1dd)]),this['repositoriesIntersections']={},this[_0x249a90(0x1ed)]=[];}async['handleRecordSyncError'](_0x12ac0b,_0x368d06){const _0x2213fc=a188_0x2cf358;if(_0x368d06 instanceof git_branch_not_found_error_1[_0x2213fc(0x1b9)]){await this[_0x2213fc(0x19e)][_0x2213fc(0x1c1)](_0x12ac0b,'Not\x20Synchronized');return;}if(_0x368d06 instanceof too_many_requests_error_1[_0x2213fc(0x1bd)]){await this['salesforceSync'][_0x2213fc(0x1c1)](_0x12ac0b,_0x2213fc(0x1d4));throw _0x368d06;}try{await this[_0x2213fc(0x1cd)][_0x2213fc(0x19c)](_0x2213fc(0x1e2)+_0x12ac0b[_0x2213fc(0x1bf)]+_0x2213fc(0x1d7)+_0x12ac0b[_0x2213fc(0x1e8)]+_0x2213fc(0x1a6)+_0x368d06)[_0x2213fc(0x183)](),await this['salesforceSync']['updateRemoteState'](_0x12ac0b,{}),await this[_0x2213fc(0x19e)]['setStatus'](_0x12ac0b,'Error');}catch(_0x372ce6){if(_0x372ce6 instanceof salesforce_error_1[_0x2213fc(0x190)])throw _0x372ce6;}}async[a188_0x2cf358(0x192)](_0x5b4c64){const _0x35978e=a188_0x2cf358;if(_0x5b4c64[_0x35978e(0x1e3)]){const _0x54929d=_0x5b4c64[_0x35978e(0x1bf)][_0x35978e(0x1d2)](),_0x555a6b=this[_0x35978e(0x1aa)][_0x54929d];if(!_0x555a6b)this[_0x35978e(0x1aa)][_0x54929d]=_0x5b4c64[_0x35978e(0x1bf)];else{if(_0x555a6b&&_0x555a6b!==_0x5b4c64['repositoryName'])return await this[_0x35978e(0x1d5)](_0x5b4c64,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x5b4c64[_0x35978e(0x1bf)]+_0x35978e(0x1ea)+_0x54929d+_0x35978e(0x1cc)+_0x555a6b+'\x27')),!![];}}return![];}async[a188_0x2cf358(0x1b0)](_0x55ecee){const _0x171a37=a188_0x2cf358;if(!constants_1[_0x171a37(0x1c2)]['test'](_0x55ecee[_0x171a37(0x1bf)]))return await this[_0x171a37(0x1d5)](_0x55ecee,new Error(_0x171a37(0x185)+_0x55ecee['repositoryName']+_0x171a37(0x1f0))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x171a37(0x1f2)](_0x55ecee[_0x171a37(0x1e8)]))return await this[_0x171a37(0x1d5)](_0x55ecee,new Error(_0x171a37(0x18f)+_0x55ecee['branchName']+_0x171a37(0x184)+_0x55ecee[_0x171a37(0x1bf)]+_0x171a37(0x1f8))),![];return!![];}async['getOrCreateRepo'](_0x282767,_0xb7532a,_0x15b772){const _0x2566d0=a188_0x2cf358;let _0x1409af=this[_0x2566d0(0x1ed)][_0x2566d0(0x1a2)](_0x451978=>_0x282767[_0x2566d0(0x1bf)]===_0x451978['name']);!_0x1409af&&(this[_0x2566d0(0x1cd)][_0x2566d0(0x19c)](_0x2566d0(0x195)+_0x282767[_0x2566d0(0x1bf)]+_0x2566d0(0x1eb)),_0x1409af=await this[_0x2566d0(0x1ba)][_0x2566d0(0x1a8)]({'name':_0x282767[_0x2566d0(0x1bf)],'autoInit':!![],'defaultBranch':_0x282767[_0x2566d0(0x1e8)],'private':!![],'createHook':this[_0x2566d0(0x1e7)]['createHooks']}));if(this['syncDto'][_0x2566d0(0x1af)]){const _0x1431c7=await _0x1409af[_0x2566d0(0x18c)][_0x2566d0(0x196)]();!_0x1431c7['find'](_0x3333ec=>_0x3333ec[_0x2566d0(0x1cb)]===hooks_utils_1['HooksUtils']['getHookLinkFor'](_0xb7532a,_0x15b772))&&(this['sfLogger']['log']('[INFO]\x20Repository\x20\x22'+_0x282767[_0x2566d0(0x1bf)]+_0x2566d0(0x1d8)),await _0x1409af[_0x2566d0(0x18c)]['create'](hooks_utils_1[_0x2566d0(0x1c3)][_0x2566d0(0x1e9)](_0xb7532a,_0x1409af[_0x2566d0(0x18c)],_0x15b772)));}return this[_0x2566d0(0x1ed)][_0x2566d0(0x18e)](_0x1409af),_0x1409af;}async[a188_0x2cf358(0x1d1)](_0x9d0a0c,_0x211cb1,_0x2b207e,_0x47a6a9){const _0x4e7c9d=a188_0x2cf358;this['salesforceService'][_0x4e7c9d(0x194)](_0x211cb1),this[_0x4e7c9d(0x1ba)]=this['gitManager'][_0x4e7c9d(0x1b6)](_0x2b207e),this[_0x4e7c9d(0x1cd)]=new salesforce_logger_v2_service_1[(_0x4e7c9d(0x1b8))](_0x211cb1,'['+SyncService_1[_0x4e7c9d(0x1dd)]+_0x4e7c9d(0x1f4)+_0x2b207e['toUpperCase']()+']'),this['syncDto']=_0x9d0a0c;try{await this[_0x4e7c9d(0x1cd)][_0x4e7c9d(0x19c)](_0x4e7c9d(0x182))[_0x4e7c9d(0x183)]();const [_0x47bd83,_0x2eb0ea]=await Promise[_0x4e7c9d(0x187)]([this[_0x4e7c9d(0x19e)][_0x4e7c9d(0x18a)](),this['salesforceSync']['getRepositoryRecords']()]);this[_0x4e7c9d(0x1ed)]=await this[_0x4e7c9d(0x1ba)][_0x4e7c9d(0x196)]();const _0x42a9cf=[..._0x2eb0ea,..._0x47bd83];this['logger'][_0x4e7c9d(0x19c)](_0x4e7c9d(0x1b5),_0x42a9cf['length']);for(const _0x5dfed8 of _0x42a9cf){this[_0x4e7c9d(0x1c4)][_0x4e7c9d(0x19c)](_0x4e7c9d(0x1f5),_0x5dfed8['repositoryName'],_0x5dfed8[_0x4e7c9d(0x1e3)],_0x5dfed8[_0x4e7c9d(0x1e8)],_0x5dfed8[_0x4e7c9d(0x181)]);const _0x504ac9=await this[_0x4e7c9d(0x1b0)](_0x5dfed8);if(!_0x504ac9)continue;const _0x5d9463=await this['isIntersects'](_0x5dfed8);if(_0x5d9463)continue;let _0x1953f6;try{_0x1953f6=await this[_0x4e7c9d(0x1d3)](_0x5dfed8,_0x2b207e,_0x47a6a9);}catch(_0x2a5726){await this[_0x4e7c9d(0x1d5)](_0x5dfed8,_0x2a5726 instanceof too_many_requests_error_1[_0x4e7c9d(0x1bd)]?_0x2a5726:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x2a5726));continue;}await this['sfLogger']['send']();if(_0x5dfed8[_0x4e7c9d(0x1a4)]===flosum_repository_sync_dto_1[_0x4e7c9d(0x1ce)][_0x4e7c9d(0x1ee)]){const _0x3d9b00=typedi_1[_0x4e7c9d(0x1a3)][_0x4e7c9d(0x197)](flosum_sync_job_1[_0x4e7c9d(0x19f)]);await _0x3d9b00[_0x4e7c9d(0x1d1)]({'repository':_0x1953f6,'convertToSFDX':_0x9d0a0c['convertToSFDX'],'syncRecord':_0x5dfed8,'provider':_0x2b207e,'logger':this['sfLogger']})[_0x4e7c9d(0x1b4)](_0x5b36ae=>this[_0x4e7c9d(0x1d5)](_0x5dfed8,_0x5b36ae));}else{const _0x13f536=typedi_1['default'][_0x4e7c9d(0x197)](git_sync_job_1[_0x4e7c9d(0x1a5)]);await _0x13f536[_0x4e7c9d(0x1d1)]({'repository':_0x1953f6,'branch':_0x5dfed8[_0x4e7c9d(0x1e8)],'provider':_0x2b207e,'repositoryGit':_0x1953f6[_0x4e7c9d(0x1c8)],'syncRecord':_0x5dfed8,'logger':this[_0x4e7c9d(0x1cd)]})[_0x4e7c9d(0x1b4)](_0x54275d=>this['handleRecordSyncError'](_0x5dfed8,_0x54275d));}}}catch(_0x5d62f5){this[_0x4e7c9d(0x1c4)][_0x4e7c9d(0x1df)](_0x5d62f5);_0x5d62f5 instanceof too_many_requests_error_1['TooManyRequests']?(await this[_0x4e7c9d(0x1cd)][_0x4e7c9d(0x19c)](_0x4e7c9d(0x1f3))[_0x4e7c9d(0x183)](),await utils_1[_0x4e7c9d(0x1b1)](0x3c*0x3c*0x3e8),this[_0x4e7c9d(0x1d1)](_0x9d0a0c,_0x211cb1,_0x2b207e,_0x47a6a9)):await this['sfLogger'][_0x4e7c9d(0x19c)](_0x4e7c9d(0x19b)+_0x5d62f5)[_0x4e7c9d(0x183)]();return;}await this['sfLogger']['log']('[INFO]\x20Sync\x20job\x20done.')[_0x4e7c9d(0x183)](),await this[_0x4e7c9d(0x19e)][_0x4e7c9d(0x188)](_0x9d0a0c['syncID'])[_0x4e7c9d(0x1b4)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x2cf358(0x1de)]({'transient':!![]}),__metadata(a188_0x2cf358(0x1c6),[salesforce_service_1[a188_0x2cf358(0x1e1)],salesforce_sync_service_1[a188_0x2cf358(0x193)],git_provider_manager_1['GitProviderManager']])],SyncService),exports['SyncService']=SyncService;function a188_0x9e84(){const _0x3d70d2=['push','Unable\x20to\x20synchronize\x20branch\x20\x27','SalesforceError','__decorate','isIntersects','SalesforceSyncService','setLoggerId','[INFO]\x20Repository\x20\x22','getAll','get','salesforceService','../../hooks/hooks.utils','../../shared/utils','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','log','defineProperty','salesforceSync','FlosumSyncJob','__importStar','../../../constants','find','default','direction','GitSyncJob',']\x20due\x20error\x20-\x20','call','create','search','repositoriesIntersections','typedi','../../../core/errors/too-many-requests.error','775240ojEPFR','toString','createHooks','checkValidNaming','sleep','constructor','SyncService','catch','have\x20to\x20synchronize\x20%d\x20branches','getRepoService','__esModule','SalesforceLogger2','GitBranchNotFoundError','repoService','1364nXEnKQ','11970wVtBAH','TooManyRequests','../../salesforce/dto/flosum-repository-sync.dto','repositoryName','length','setStatus','REPOSITORY_NAME_REGEXP','HooksUtils','logger','hasOwnProperty','design:paramtypes','getOwnPropertyDescriptor','gitUrl','Logger','1168vtLMlg','url','\x27\x20-\x20\x27','sfLogger','SyncDirection','__metadata','../../shared/git-provider.manager','run','toLowerCase','getOrCreateRepo','Waiting','handleRecordSyncError','../../salesforce/services/salesforce.service','\x27\x20[','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','metadata','apply','../errors/git-branch-not-found.error','750495kaWeUr','name','Service','error','11gmzWGQ','SalesforceService','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','repositoryId','decorate','../jobs/flosum-sync.job','../jobs/git-sync.job','syncDto','branchName','createHookPayload','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','152340TLbMaW','repoList','FlosumToGit','../../salesforce/services/salesforce-logger-v2.service','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','1970JkOxuf','test','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.',']\x20[','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','object','1348676zSeuDp','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','prototype','(((.+)+)+)+$','branchId','[INFO]\x20Start\x20sync\x20job','send','\x27\x20in\x20repository\x20\x27','Unable\x20to\x20synchronize\x20repository\x20\x27','224506KvatyY','all','disableSync','1tDlimt','getBranchRecords','../../../core','hooks','__createBinding'];a188_0x9e84=function(){return _0x3d70d2;};return a188_0x9e84();}