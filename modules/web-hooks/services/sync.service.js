const a188_0x49c351=a188_0x5963;(function(_0x444d22,_0x294683){const _0x223e66=a188_0x5963,_0x32b21b=_0x444d22();while(!![]){try{const _0x1aeb2f=parseInt(_0x223e66(0xbd))/0x1*(-parseInt(_0x223e66(0xee))/0x2)+parseInt(_0x223e66(0xf0))/0x3*(parseInt(_0x223e66(0x111))/0x4)+-parseInt(_0x223e66(0xb9))/0x5*(-parseInt(_0x223e66(0xdf))/0x6)+parseInt(_0x223e66(0xe7))/0x7*(parseInt(_0x223e66(0xf8))/0x8)+-parseInt(_0x223e66(0xe0))/0x9+-parseInt(_0x223e66(0x106))/0xa+-parseInt(_0x223e66(0x103))/0xb;if(_0x1aeb2f===_0x294683)break;else _0x32b21b['push'](_0x32b21b['shift']());}catch(_0xf7add2){_0x32b21b['push'](_0x32b21b['shift']());}}}(a188_0x5b75,0x94576));const a188_0x3c480b=(function(){let _0x10ea17=!![];return function(_0x1fb0f4,_0x442eaa){const _0x593bd8=_0x10ea17?function(){if(_0x442eaa){const _0x1112f4=_0x442eaa['apply'](_0x1fb0f4,arguments);return _0x442eaa=null,_0x1112f4;}}:function(){};return _0x10ea17=![],_0x593bd8;};}()),a188_0x63a6e8=a188_0x3c480b(this,function(){const _0x51b3a6=a188_0x5963;return a188_0x63a6e8[_0x51b3a6(0xb1)]()['search']('(((.+)+)+)+$')[_0x51b3a6(0xb1)]()[_0x51b3a6(0xfe)](a188_0x63a6e8)[_0x51b3a6(0xd7)](_0x51b3a6(0xdb));});function a188_0x5b75(){const _0x5c6c56=['getOrCreateRepo','1924510ISKuVz','branchName','repositoriesIntersections','../errors/git-branch-not-found.error','getOwnPropertyDescriptor','../../shared/utils','get','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','Unable\x20to\x20synchronize\x20branch\x20\x27','../../hooks/hooks.utils','GitProviderManager','12bZnTPM','../../salesforce/dto/flosum-repository-sync.dto','direction','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','SalesforceService','gitManager','repositoryId','[INFO]\x20Start\x20sync\x20job','Error','../../salesforce/errors/salesforce.error','defineProperty','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','run','../../shared/git-provider.manager','GitSyncJob','__decorate','../../../core','\x27\x20in\x20repository\x20\x27','salesforceService','updateRemoteState','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','__esModule','call','logger','toString','[INFO]\x20Repository\x20\x22','log','getRepositoryRecords','hasOwnProperty','GitBranchNotFoundError','typedi','name','460770NxnxTP','disableSync','convertToSFDX','repositoryName','93eVRHTp','getAll','decorate','getBranchRecords','checkValidNaming','metadata','SalesforceError','createHooks','SalesforceLogger2','getRepoService','../../salesforce/services/salesforce.service','../jobs/flosum-sync.job','Logger','prototype',']\x20[','../../salesforce/services/salesforce-sync.service','../../salesforce/services/salesforce-logger-v2.service','setStatus','length','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','__metadata','handleRecordSyncError','function','toUpperCase','error','create','search','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','isIntersects','catch','(((.+)+)+)+$','setLoggerId','__setModuleDefault','Unable\x20to\x20synchronize\x20repository\x20\x27','66sdgEiO','1294083TjyIpW',']\x20due\x20error\x20-\x20','TooManyRequests','repoService','syncDto','sfLogger','HooksUtils','23793ZQECdB','__importStar','BRANCH_NAME_REGEXP','createHookPayload','\x27\x20[','SyncService','send','654jlnrEP','object','975417mxGbow','all','gitUrl','default','salesforceSync','Waiting','repoList','__createBinding','344whXUqX','find','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','push','[INFO]\x20Sync\x20job\x20done.','FlosumToGit','constructor','FlosumSyncJob','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','hooks','test','12771143dlzUSw','Service'];a188_0x5b75=function(){return _0x5c6c56;};return a188_0x5b75();}a188_0x63a6e8();'use strict';var __createBinding=this&&this[a188_0x49c351(0xf7)]||(Object[a188_0x49c351(0xd6)]?function(_0x495e09,_0x5adb0a,_0x119926,_0x4d7dfc){const _0x14d5b2=a188_0x49c351;if(_0x4d7dfc===undefined)_0x4d7dfc=_0x119926;Object[_0x14d5b2(0x11b)](_0x495e09,_0x4d7dfc,{'enumerable':!![],'get':function(){return _0x5adb0a[_0x119926];}});}:function(_0x406dba,_0x49936c,_0x531198,_0x48f33c){if(_0x48f33c===undefined)_0x48f33c=_0x531198;_0x406dba[_0x48f33c]=_0x49936c[_0x531198];}),__setModuleDefault=this&&this[a188_0x49c351(0xdd)]||(Object[a188_0x49c351(0xd6)]?function(_0x3f9a70,_0x3a4b8b){const _0x1e4756=a188_0x49c351;Object[_0x1e4756(0x11b)](_0x3f9a70,'default',{'enumerable':!![],'value':_0x3a4b8b});}:function(_0x154900,_0x3a7666){_0x154900['default']=_0x3a7666;}),__decorate=this&&this[a188_0x49c351(0x120)]||function(_0x4ea312,_0x253ebd,_0x1178bb,_0x470485){const _0x414fed=a188_0x49c351;var _0x4eab00=arguments['length'],_0x5c62b1=_0x4eab00<0x3?_0x253ebd:_0x470485===null?_0x470485=Object[_0x414fed(0x10a)](_0x253ebd,_0x1178bb):_0x470485,_0x1ef95b;if(typeof Reflect==='object'&&typeof Reflect[_0x414fed(0xbf)]===_0x414fed(0xd3))_0x5c62b1=Reflect[_0x414fed(0xbf)](_0x4ea312,_0x253ebd,_0x1178bb,_0x470485);else{for(var _0x3f217a=_0x4ea312[_0x414fed(0xcf)]-0x1;_0x3f217a>=0x0;_0x3f217a--)if(_0x1ef95b=_0x4ea312[_0x3f217a])_0x5c62b1=(_0x4eab00<0x3?_0x1ef95b(_0x5c62b1):_0x4eab00>0x3?_0x1ef95b(_0x253ebd,_0x1178bb,_0x5c62b1):_0x1ef95b(_0x253ebd,_0x1178bb))||_0x5c62b1;}return _0x4eab00>0x3&&_0x5c62b1&&Object[_0x414fed(0x11b)](_0x253ebd,_0x1178bb,_0x5c62b1),_0x5c62b1;},__importStar=this&&this[a188_0x49c351(0xe8)]||function(_0x262473){const _0xac1d1f=a188_0x49c351;if(_0x262473&&_0x262473[_0xac1d1f(0xae)])return _0x262473;var _0x4dd156={};if(_0x262473!=null){for(var _0x88264b in _0x262473)if(_0x88264b!==_0xac1d1f(0xf3)&&Object[_0xac1d1f(0xca)][_0xac1d1f(0xb5)][_0xac1d1f(0xaf)](_0x262473,_0x88264b))__createBinding(_0x4dd156,_0x262473,_0x88264b);}return __setModuleDefault(_0x4dd156,_0x262473),_0x4dd156;},__metadata=this&&this[a188_0x49c351(0xd1)]||function(_0x251428,_0x4ecb5f){const _0x55d183=a188_0x49c351;if(typeof Reflect===_0x55d183(0xef)&&typeof Reflect['metadata']===_0x55d183(0xd3))return Reflect[_0x55d183(0xc2)](_0x251428,_0x4ecb5f);},SyncService_1;function a188_0x5963(_0xf759e2,_0x341de5){const _0xc669b5=a188_0x5b75();return a188_0x5963=function(_0x63a6e8,_0x3c480b){_0x63a6e8=_0x63a6e8-0xae;let _0x5b755e=_0xc669b5[_0x63a6e8];return _0x5b755e;},a188_0x5963(_0xf759e2,_0x341de5);}Object[a188_0x49c351(0x11b)](exports,a188_0x49c351(0xae),{'value':!![]}),exports[a188_0x49c351(0xec)]=void 0x0;const constants_1=require('../../../constants'),core_1=require(a188_0x49c351(0x121)),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require(a188_0x49c351(0x112)),salesforce_error_1=require(a188_0x49c351(0x11a)),salesforce_logger_v2_service_1=require(a188_0x49c351(0xcd)),salesforce_sync_service_1=require(a188_0x49c351(0xcc)),salesforce_service_1=require(a188_0x49c351(0xc7)),git_provider_manager_1=require(a188_0x49c351(0x11e)),utils_1=require(a188_0x49c351(0x10b)),typedi_1=__importStar(require(a188_0x49c351(0xb7))),hooks_utils_1=require(a188_0x49c351(0x10f)),git_branch_not_found_error_1=require(a188_0x49c351(0x109)),flosum_sync_job_1=require(a188_0x49c351(0xc8)),git_sync_job_1=require('../jobs/git-sync.job');let SyncService=SyncService_1=class SyncService{constructor(_0x29dd4d,_0x1b4100,_0x4cb6a4){const _0x2bc2bf=a188_0x49c351;this['salesforceService']=_0x29dd4d,this[_0x2bc2bf(0xf4)]=_0x1b4100,this[_0x2bc2bf(0x116)]=_0x4cb6a4,this[_0x2bc2bf(0xb0)]=new core_1[(_0x2bc2bf(0xc9))](SyncService_1[_0x2bc2bf(0xb8)]),this[_0x2bc2bf(0x108)]={},this[_0x2bc2bf(0xf6)]=[];}async['handleRecordSyncError'](_0x3783bf,_0x3aa9f7){const _0x4158fa=a188_0x49c351;if(_0x3aa9f7 instanceof git_branch_not_found_error_1[_0x4158fa(0xb6)]){await this[_0x4158fa(0xf4)]['setStatus'](_0x3783bf,'Not\x20Synchronized');return;}if(_0x3aa9f7 instanceof too_many_requests_error_1[_0x4158fa(0xe2)]){await this[_0x4158fa(0xf4)][_0x4158fa(0xce)](_0x3783bf,_0x4158fa(0xf5));throw _0x3aa9f7;}try{await this[_0x4158fa(0xe5)][_0x4158fa(0xb3)](_0x4158fa(0x100)+_0x3783bf['repositoryName']+_0x4158fa(0xeb)+_0x3783bf[_0x4158fa(0x107)]+_0x4158fa(0xe1)+_0x3aa9f7)[_0x4158fa(0xed)](),await this[_0x4158fa(0xf4)][_0x4158fa(0x124)](_0x3783bf,{}),await this['salesforceSync'][_0x4158fa(0xce)](_0x3783bf,_0x4158fa(0x119));}catch(_0x27ed66){if(_0x27ed66 instanceof salesforce_error_1[_0x4158fa(0xc3)])throw _0x27ed66;}}async[a188_0x49c351(0xd9)](_0xaeafd2){const _0x1aceda=a188_0x49c351;if(_0xaeafd2[_0x1aceda(0x117)]){const _0x3bfa58=_0xaeafd2[_0x1aceda(0xbc)]['toLowerCase'](),_0x484c77=this[_0x1aceda(0x108)][_0x3bfa58];if(!_0x484c77)this[_0x1aceda(0x108)][_0x3bfa58]=_0xaeafd2[_0x1aceda(0xbc)];else{if(_0x484c77&&_0x484c77!==_0xaeafd2[_0x1aceda(0xbc)])return await this[_0x1aceda(0xd2)](_0xaeafd2,new Error(_0x1aceda(0xde)+_0xaeafd2[_0x1aceda(0xbc)]+_0x1aceda(0xd8)+_0x3bfa58+'\x27\x20-\x20\x27'+_0x484c77+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x50c9bf){const _0x204865=a188_0x49c351;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x204865(0x102)](_0x50c9bf[_0x204865(0xbc)]))return await this[_0x204865(0xd2)](_0x50c9bf,new Error(_0x204865(0xde)+_0x50c9bf[_0x204865(0xbc)]+_0x204865(0x114))),![];if(!constants_1[_0x204865(0xe9)][_0x204865(0x102)](_0x50c9bf['branchName']))return await this[_0x204865(0xd2)](_0x50c9bf,new Error(_0x204865(0x10e)+_0x50c9bf[_0x204865(0x107)]+_0x204865(0x122)+_0x50c9bf[_0x204865(0xbc)]+_0x204865(0xd0))),![];return!![];}async['getOrCreateRepo'](_0x2ab0c7,_0x48355d,_0x133e39){const _0x3244bb=a188_0x49c351;let _0x5cbbbd=this[_0x3244bb(0xf6)][_0x3244bb(0xf9)](_0x14e5ca=>_0x2ab0c7[_0x3244bb(0xbc)]===_0x14e5ca[_0x3244bb(0xb8)]);!_0x5cbbbd&&(this[_0x3244bb(0xe5)][_0x3244bb(0xb3)](_0x3244bb(0xb2)+_0x2ab0c7[_0x3244bb(0xbc)]+_0x3244bb(0x125)),_0x5cbbbd=await this['repoService']['create']({'name':_0x2ab0c7[_0x3244bb(0xbc)],'autoInit':!![],'defaultBranch':_0x2ab0c7['branchName'],'private':!![],'createHook':this[_0x3244bb(0xe4)][_0x3244bb(0xc4)]}));if(this['syncDto'][_0x3244bb(0xc4)]){const _0x2a1b34=await _0x5cbbbd[_0x3244bb(0x101)]['getAll']();!_0x2a1b34['find'](_0x31e795=>_0x31e795['url']===hooks_utils_1[_0x3244bb(0xe6)]['getHookLinkFor'](_0x48355d,_0x133e39))&&(this['sfLogger'][_0x3244bb(0xb3)](_0x3244bb(0xb2)+_0x2ab0c7['repositoryName']+_0x3244bb(0xfa)),await _0x5cbbbd[_0x3244bb(0x101)][_0x3244bb(0xd6)](hooks_utils_1[_0x3244bb(0xe6)][_0x3244bb(0xea)](_0x48355d,_0x5cbbbd[_0x3244bb(0x101)],_0x133e39)));}return this[_0x3244bb(0xf6)][_0x3244bb(0xfb)](_0x5cbbbd),_0x5cbbbd;}async[a188_0x49c351(0x11d)](_0x1b5e43,_0x3e4768,_0x33a8d9,_0x142269){const _0x3e0eba=a188_0x49c351;this[_0x3e0eba(0x123)][_0x3e0eba(0xdc)](_0x3e4768),this[_0x3e0eba(0xe3)]=this[_0x3e0eba(0x116)][_0x3e0eba(0xc6)](_0x33a8d9),this[_0x3e0eba(0xe5)]=new salesforce_logger_v2_service_1[(_0x3e0eba(0xc5))](_0x3e4768,'['+SyncService_1[_0x3e0eba(0xb8)]+_0x3e0eba(0xcb)+_0x33a8d9[_0x3e0eba(0xd4)]()+']'),this[_0x3e0eba(0xe4)]=_0x1b5e43;try{await this[_0x3e0eba(0xe5)][_0x3e0eba(0xb3)](_0x3e0eba(0x118))[_0x3e0eba(0xed)]();const [_0x2ca00a,_0x5d2831]=await Promise[_0x3e0eba(0xf1)]([this[_0x3e0eba(0xf4)][_0x3e0eba(0xc0)](),this[_0x3e0eba(0xf4)][_0x3e0eba(0xb4)]()]);this[_0x3e0eba(0xf6)]=await this[_0x3e0eba(0xe3)][_0x3e0eba(0xbe)]();const _0x19517e=[..._0x5d2831,..._0x2ca00a];this['logger']['log']('have\x20to\x20synchronize\x20%d\x20branches',_0x19517e[_0x3e0eba(0xcf)]);for(const _0xad0854 of _0x19517e){this[_0x3e0eba(0xb0)]['log']('syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch',_0xad0854[_0x3e0eba(0xbc)],_0xad0854[_0x3e0eba(0x117)],_0xad0854[_0x3e0eba(0x107)],_0xad0854['branchId']);const _0x23869b=await this[_0x3e0eba(0xc1)](_0xad0854);if(!_0x23869b)continue;const _0x374d87=await this[_0x3e0eba(0xd9)](_0xad0854);if(_0x374d87)continue;let _0x367178;try{_0x367178=await this[_0x3e0eba(0x105)](_0xad0854,_0x33a8d9,_0x142269);}catch(_0x2afaad){await this['handleRecordSyncError'](_0xad0854,_0x2afaad instanceof too_many_requests_error_1[_0x3e0eba(0xe2)]?_0x2afaad:new Error(_0x3e0eba(0x10d)+_0x2afaad));continue;}await this[_0x3e0eba(0xe5)][_0x3e0eba(0xed)]();if(_0xad0854[_0x3e0eba(0x113)]===flosum_repository_sync_dto_1['SyncDirection'][_0x3e0eba(0xfd)]){const _0x2e7e34=typedi_1[_0x3e0eba(0xf3)][_0x3e0eba(0x10c)](flosum_sync_job_1[_0x3e0eba(0xff)]);await _0x2e7e34['run']({'repository':_0x367178,'convertToSFDX':_0x1b5e43[_0x3e0eba(0xbb)],'syncRecord':_0xad0854,'provider':_0x33a8d9,'logger':this[_0x3e0eba(0xe5)]})[_0x3e0eba(0xda)](_0x3474af=>this[_0x3e0eba(0xd2)](_0xad0854,_0x3474af));}else{const _0xbb113a=typedi_1['default'][_0x3e0eba(0x10c)](git_sync_job_1[_0x3e0eba(0x11f)]);await _0xbb113a[_0x3e0eba(0x11d)]({'repository':_0x367178,'branch':_0xad0854[_0x3e0eba(0x107)],'provider':_0x33a8d9,'repositoryGit':_0x367178[_0x3e0eba(0xf2)],'syncRecord':_0xad0854,'logger':this['sfLogger']})[_0x3e0eba(0xda)](_0x355ed5=>this[_0x3e0eba(0xd2)](_0xad0854,_0x355ed5));}}}catch(_0x585a83){this[_0x3e0eba(0xb0)][_0x3e0eba(0xd5)](_0x585a83);_0x585a83 instanceof too_many_requests_error_1[_0x3e0eba(0xe2)]?(await this[_0x3e0eba(0xe5)]['log']('[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')['send'](),await utils_1['sleep'](0x3c*0x3c*0x3e8),this[_0x3e0eba(0x11d)](_0x1b5e43,_0x3e4768,_0x33a8d9,_0x142269)):await this[_0x3e0eba(0xe5)][_0x3e0eba(0xb3)](_0x3e0eba(0x11c)+_0x585a83)[_0x3e0eba(0xed)]();return;}await this[_0x3e0eba(0xe5)]['log'](_0x3e0eba(0xfc))[_0x3e0eba(0xed)](),await this[_0x3e0eba(0xf4)][_0x3e0eba(0xba)](_0x1b5e43['syncID'])[_0x3e0eba(0xda)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x49c351(0x104)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a188_0x49c351(0x115)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a188_0x49c351(0x110)]])],SyncService),exports[a188_0x49c351(0xec)]=SyncService;