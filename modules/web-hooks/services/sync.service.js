const a188_0x2a2e29=a188_0x3edb;(function(_0x46ad4a,_0x4b5b88){const _0x2c10fb=a188_0x3edb,_0x153833=_0x46ad4a();while(!![]){try{const _0xd60fae=-parseInt(_0x2c10fb(0xc2))/0x1*(parseInt(_0x2c10fb(0x119))/0x2)+parseInt(_0x2c10fb(0xde))/0x3*(-parseInt(_0x2c10fb(0xfc))/0x4)+parseInt(_0x2c10fb(0x10a))/0x5*(parseInt(_0x2c10fb(0xcf))/0x6)+parseInt(_0x2c10fb(0x114))/0x7*(parseInt(_0x2c10fb(0xea))/0x8)+-parseInt(_0x2c10fb(0xf7))/0x9*(parseInt(_0x2c10fb(0x124))/0xa)+-parseInt(_0x2c10fb(0xd0))/0xb+-parseInt(_0x2c10fb(0xc4))/0xc*(-parseInt(_0x2c10fb(0xc7))/0xd);if(_0xd60fae===_0x4b5b88)break;else _0x153833['push'](_0x153833['shift']());}catch(_0x44dd54){_0x153833['push'](_0x153833['shift']());}}}(a188_0x331b,0xb678b));const a188_0x126360=(function(){let _0x375a3a=!![];return function(_0x4bdcf5,_0x279fba){const _0x1865c3=_0x375a3a?function(){const _0x1e9cab=a188_0x3edb;if(_0x279fba){const _0x4ba88e=_0x279fba[_0x1e9cab(0xdc)](_0x4bdcf5,arguments);return _0x279fba=null,_0x4ba88e;}}:function(){};return _0x375a3a=![],_0x1865c3;};}()),a188_0x1da859=a188_0x126360(this,function(){const _0xdd990e=a188_0x3edb;return a188_0x1da859[_0xdd990e(0xd1)]()[_0xdd990e(0xb9)](_0xdd990e(0xe3))[_0xdd990e(0xd1)]()[_0xdd990e(0xe2)](a188_0x1da859)[_0xdd990e(0xb9)](_0xdd990e(0xe3));});function a188_0x331b(){const _0x387698=['../jobs/git-sync.job','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','name','SalesforceService','send','catch','have\x20to\x20synchronize\x20%d\x20branches','232878UGVQDw',']\x20[','396quOJyS','find','run','1237379NVceDd','sfLogger','repositoryId','branchName','repositoriesIntersections','Unable\x20to\x20synchronize\x20branch\x20\x27','defineProperty','get','3115446fETlZB','15932345JeLQCU','toString','syncID','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','Waiting','../errors/git-branch-not-found.error','FlosumToGit','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','test','Error','all','Not\x20Synchronized','apply','GitProviderManager','36537xrFaSR','../../salesforce/services/salesforce.service','salesforceSync','getRepositoryRecords','constructor','(((.+)+)+)+$','gitManager','getOrCreateRepo','\x27\x20[','length','[INFO]\x20Start\x20sync\x20job','metadata','8OVkjEy','isIntersects','__esModule','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','decorate','GitSyncJob','[INFO]\x20Sync\x20job\x20done.','__setModuleDefault','__createBinding','error','repoList','../../salesforce/errors/salesforce.error','object','36ashiru','create','syncDto','__metadata','SyncService','4vffCnP','design:paramtypes','repositoryName','../../salesforce/services/salesforce-logger-v2.service','TooManyRequests','getBranchRecords','createHookPayload','toUpperCase','handleRecordSyncError','url','default','hooks','branchId','../../shared/git-provider.manager','5SdHpgX','\x27\x20-\x20\x27','log','push','REPOSITORY_NAME_REGEXP','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','checkValidNaming',']\x20due\x20error\x20-\x20','Service','getHookLinkFor','4318195OUnSWU','sleep','function','../../shared/utils','Unable\x20to\x20synchronize\x20repository\x20\x27','12xOwxyD','__decorate','[INFO]\x20Repository\x20\x22','../../salesforce/services/salesforce-sync.service','updateRemoteState','logger','createHooks','HooksUtils','../../hooks/hooks.utils','prototype','BRANCH_NAME_REGEXP','1679800BROryY','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','repoService','SalesforceLogger2','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','setStatus','\x27\x20in\x20repository\x20\x27','FlosumSyncJob','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','SalesforceError','getAll','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','search','hasOwnProperty'];a188_0x331b=function(){return _0x387698;};return a188_0x331b();}a188_0x1da859();function a188_0x3edb(_0x2d1f08,_0x305c1a){const _0x20c39e=a188_0x331b();return a188_0x3edb=function(_0x1da859,_0x126360){_0x1da859=_0x1da859-0xae;let _0x331b8c=_0x20c39e[_0x1da859];return _0x331b8c;},a188_0x3edb(_0x2d1f08,_0x305c1a);}'use strict';var __createBinding=this&&this[a188_0x2a2e29(0xf2)]||(Object[a188_0x2a2e29(0xf8)]?function(_0x3c8ea6,_0x1cb1a2,_0x572ac9,_0x26f8ae){const _0x145761=a188_0x2a2e29;if(_0x26f8ae===undefined)_0x26f8ae=_0x572ac9;Object[_0x145761(0xcd)](_0x3c8ea6,_0x26f8ae,{'enumerable':!![],'get':function(){return _0x1cb1a2[_0x572ac9];}});}:function(_0x3a07fa,_0x2b22d5,_0x249d17,_0x4bb906){if(_0x4bb906===undefined)_0x4bb906=_0x249d17;_0x3a07fa[_0x4bb906]=_0x2b22d5[_0x249d17];}),__setModuleDefault=this&&this[a188_0x2a2e29(0xf1)]||(Object[a188_0x2a2e29(0xf8)]?function(_0x3fd4ca,_0x4f71ba){const _0x49cf90=a188_0x2a2e29;Object['defineProperty'](_0x3fd4ca,_0x49cf90(0x106),{'enumerable':!![],'value':_0x4f71ba});}:function(_0x5b6d93,_0x6dc457){const _0x21204a=a188_0x2a2e29;_0x5b6d93[_0x21204a(0x106)]=_0x6dc457;}),__decorate=this&&this[a188_0x2a2e29(0x11a)]||function(_0x239ef2,_0x5a0701,_0x2fa0df,_0x3cbda7){const _0x3022a3=a188_0x2a2e29;var _0x172c7b=arguments[_0x3022a3(0xe7)],_0x3c35c7=_0x172c7b<0x3?_0x5a0701:_0x3cbda7===null?_0x3cbda7=Object['getOwnPropertyDescriptor'](_0x5a0701,_0x2fa0df):_0x3cbda7,_0x46735b;if(typeof Reflect==='object'&&typeof Reflect[_0x3022a3(0xee)]===_0x3022a3(0x116))_0x3c35c7=Reflect[_0x3022a3(0xee)](_0x239ef2,_0x5a0701,_0x2fa0df,_0x3cbda7);else{for(var _0x45bc4e=_0x239ef2['length']-0x1;_0x45bc4e>=0x0;_0x45bc4e--)if(_0x46735b=_0x239ef2[_0x45bc4e])_0x3c35c7=(_0x172c7b<0x3?_0x46735b(_0x3c35c7):_0x172c7b>0x3?_0x46735b(_0x5a0701,_0x2fa0df,_0x3c35c7):_0x46735b(_0x5a0701,_0x2fa0df))||_0x3c35c7;}return _0x172c7b>0x3&&_0x3c35c7&&Object[_0x3022a3(0xcd)](_0x5a0701,_0x2fa0df,_0x3c35c7),_0x3c35c7;},__importStar=this&&this['__importStar']||function(_0x2cc2b8){const _0x44d09a=a188_0x2a2e29;if(_0x2cc2b8&&_0x2cc2b8['__esModule'])return _0x2cc2b8;var _0x193732={};if(_0x2cc2b8!=null){for(var _0x1a5d81 in _0x2cc2b8)if(_0x1a5d81!==_0x44d09a(0x106)&&Object[_0x44d09a(0x122)][_0x44d09a(0xba)]['call'](_0x2cc2b8,_0x1a5d81))__createBinding(_0x193732,_0x2cc2b8,_0x1a5d81);}return __setModuleDefault(_0x193732,_0x2cc2b8),_0x193732;},__metadata=this&&this[a188_0x2a2e29(0xfa)]||function(_0x5766de,_0x4a2143){const _0x36a385=a188_0x2a2e29;if(typeof Reflect===_0x36a385(0xf6)&&typeof Reflect[_0x36a385(0xe9)]==='function')return Reflect['metadata'](_0x5766de,_0x4a2143);},SyncService_1;Object['defineProperty'](exports,a188_0x2a2e29(0xec),{'value':!![]}),exports[a188_0x2a2e29(0xfb)]=void 0x0;const constants_1=require('../../../constants'),core_1=require('../../../core'),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a188_0x2a2e29(0xf5)),salesforce_logger_v2_service_1=require(a188_0x2a2e29(0xff)),salesforce_sync_service_1=require(a188_0x2a2e29(0x11c)),salesforce_service_1=require(a188_0x2a2e29(0xdf)),git_provider_manager_1=require(a188_0x2a2e29(0x109)),utils_1=require(a188_0x2a2e29(0x117)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a188_0x2a2e29(0x121)),git_branch_not_found_error_1=require(a188_0x2a2e29(0xd5)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a188_0x2a2e29(0xbb));let SyncService=SyncService_1=class SyncService{constructor(_0x486aec,_0x336a39,_0x36a628){const _0x56aba3=a188_0x2a2e29;this['salesforceService']=_0x486aec,this[_0x56aba3(0xe0)]=_0x336a39,this['gitManager']=_0x36a628,this['logger']=new core_1['Logger'](SyncService_1[_0x56aba3(0xbd)]),this[_0x56aba3(0xcb)]={},this['repoList']=[];}async[a188_0x2a2e29(0x104)](_0x2d0533,_0x533b99){const _0x18253c=a188_0x2a2e29;if(_0x533b99 instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this[_0x18253c(0xe0)][_0x18253c(0xb2)](_0x2d0533,_0x18253c(0xdb));return;}if(_0x533b99 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x18253c(0xe0)][_0x18253c(0xb2)](_0x2d0533,_0x18253c(0xd4));throw _0x533b99;}try{await this[_0x18253c(0xc8)][_0x18253c(0x10c)]('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x2d0533[_0x18253c(0xfe)]+_0x18253c(0xe6)+_0x2d0533[_0x18253c(0xca)]+_0x18253c(0x111)+_0x533b99)['send'](),await this['salesforceSync'][_0x18253c(0x11d)](_0x2d0533,{}),await this['salesforceSync']['setStatus'](_0x2d0533,_0x18253c(0xd9));}catch(_0x52f0d1){if(_0x52f0d1 instanceof salesforce_error_1[_0x18253c(0xb6)])throw _0x52f0d1;}}async[a188_0x2a2e29(0xeb)](_0x3ce0d3){const _0x3e6834=a188_0x2a2e29;if(_0x3ce0d3[_0x3e6834(0xc9)]){const _0x506b86=_0x3ce0d3[_0x3e6834(0xfe)]['toLowerCase'](),_0x1c9895=this[_0x3e6834(0xcb)][_0x506b86];if(!_0x1c9895)this[_0x3e6834(0xcb)][_0x506b86]=_0x3ce0d3[_0x3e6834(0xfe)];else{if(_0x1c9895&&_0x1c9895!==_0x3ce0d3['repositoryName'])return await this['handleRecordSyncError'](_0x3ce0d3,new Error(_0x3e6834(0x118)+_0x3ce0d3[_0x3e6834(0xfe)]+_0x3e6834(0xd7)+_0x506b86+_0x3e6834(0x10b)+_0x1c9895+'\x27')),!![];}}return![];}async[a188_0x2a2e29(0x110)](_0x18b9f7){const _0x37ae37=a188_0x2a2e29;if(!constants_1[_0x37ae37(0x10e)][_0x37ae37(0xd8)](_0x18b9f7['repositoryName']))return await this['handleRecordSyncError'](_0x18b9f7,new Error(_0x37ae37(0x118)+_0x18b9f7[_0x37ae37(0xfe)]+_0x37ae37(0xb8))),![];if(!constants_1[_0x37ae37(0x123)][_0x37ae37(0xd8)](_0x18b9f7[_0x37ae37(0xca)]))return await this[_0x37ae37(0x104)](_0x18b9f7,new Error(_0x37ae37(0xcc)+_0x18b9f7[_0x37ae37(0xca)]+_0x37ae37(0xb3)+_0x18b9f7[_0x37ae37(0xfe)]+_0x37ae37(0xb5))),![];return!![];}async[a188_0x2a2e29(0xe5)](_0x29faba,_0x32ea73,_0xdd88fb){const _0x31bc2d=a188_0x2a2e29;let _0x2bcc0d=this[_0x31bc2d(0xf4)][_0x31bc2d(0xc5)](_0x333007=>_0x29faba[_0x31bc2d(0xfe)]===_0x333007[_0x31bc2d(0xbd)]);!_0x2bcc0d&&(this[_0x31bc2d(0xc8)][_0x31bc2d(0x10c)](_0x31bc2d(0x11b)+_0x29faba[_0x31bc2d(0xfe)]+_0x31bc2d(0xbc)),_0x2bcc0d=await this[_0x31bc2d(0xaf)][_0x31bc2d(0xf8)]({'name':_0x29faba['repositoryName'],'autoInit':!![],'defaultBranch':_0x29faba[_0x31bc2d(0xca)],'private':!![],'createHook':this[_0x31bc2d(0xf9)][_0x31bc2d(0x11f)]}));if(this[_0x31bc2d(0xf9)][_0x31bc2d(0x11f)]){const _0x38be3a=await _0x2bcc0d['hooks'][_0x31bc2d(0xb7)]();!_0x38be3a[_0x31bc2d(0xc5)](_0x168f93=>_0x168f93[_0x31bc2d(0x105)]===hooks_utils_1['HooksUtils'][_0x31bc2d(0x113)](_0x32ea73,_0xdd88fb))&&(this[_0x31bc2d(0xc8)]['log'](_0x31bc2d(0x11b)+_0x29faba['repositoryName']+_0x31bc2d(0x10f)),await _0x2bcc0d['hooks'][_0x31bc2d(0xf8)](hooks_utils_1[_0x31bc2d(0x120)][_0x31bc2d(0x102)](_0x32ea73,_0x2bcc0d[_0x31bc2d(0x107)],_0xdd88fb)));}return this[_0x31bc2d(0xf4)][_0x31bc2d(0x10d)](_0x2bcc0d),_0x2bcc0d;}async[a188_0x2a2e29(0xc6)](_0x3ae28b,_0x125a40,_0x5626a4,_0x3dda83){const _0xad09c3=a188_0x2a2e29;this['salesforceService']['setLoggerId'](_0x125a40),this[_0xad09c3(0xaf)]=this[_0xad09c3(0xe4)]['getRepoService'](_0x5626a4),this[_0xad09c3(0xc8)]=new salesforce_logger_v2_service_1[(_0xad09c3(0xb0))](_0x125a40,'['+SyncService_1[_0xad09c3(0xbd)]+_0xad09c3(0xc3)+_0x5626a4[_0xad09c3(0x103)]()+']'),this[_0xad09c3(0xf9)]=_0x3ae28b;try{await this['sfLogger'][_0xad09c3(0x10c)](_0xad09c3(0xe8))[_0xad09c3(0xbf)]();const [_0x9273bb,_0xda251]=await Promise[_0xad09c3(0xda)]([this['salesforceSync'][_0xad09c3(0x101)](),this[_0xad09c3(0xe0)][_0xad09c3(0xe1)]()]);this[_0xad09c3(0xf4)]=await this['repoService'][_0xad09c3(0xb7)]();const _0x3a6ec1=[..._0xda251,..._0x9273bb];this[_0xad09c3(0x11e)]['log'](_0xad09c3(0xc1),_0x3a6ec1[_0xad09c3(0xe7)]);for(const _0x497fc2 of _0x3a6ec1){this[_0xad09c3(0x11e)][_0xad09c3(0x10c)](_0xad09c3(0xb1),_0x497fc2[_0xad09c3(0xfe)],_0x497fc2[_0xad09c3(0xc9)],_0x497fc2[_0xad09c3(0xca)],_0x497fc2[_0xad09c3(0x108)]);const _0x3ddaab=await this[_0xad09c3(0x110)](_0x497fc2);if(!_0x3ddaab)continue;const _0x370ddb=await this['isIntersects'](_0x497fc2);if(_0x370ddb)continue;let _0xbd3f0c;try{_0xbd3f0c=await this[_0xad09c3(0xe5)](_0x497fc2,_0x5626a4,_0x3dda83);}catch(_0x1c4e9c){await this[_0xad09c3(0x104)](_0x497fc2,_0x1c4e9c instanceof too_many_requests_error_1[_0xad09c3(0x100)]?_0x1c4e9c:new Error(_0xad09c3(0xae)+_0x1c4e9c));continue;}await this[_0xad09c3(0xc8)]['send']();if(_0x497fc2['direction']===flosum_repository_sync_dto_1['SyncDirection'][_0xad09c3(0xd6)]){const _0x13dfa=typedi_1[_0xad09c3(0x106)]['get'](flosum_sync_job_1[_0xad09c3(0xb4)]);await _0x13dfa[_0xad09c3(0xc6)]({'repository':_0xbd3f0c,'convertToSFDX':_0x3ae28b['convertToSFDX'],'syncRecord':_0x497fc2,'provider':_0x5626a4,'logger':this['sfLogger']})[_0xad09c3(0xc0)](_0x3389f6=>this[_0xad09c3(0x104)](_0x497fc2,_0x3389f6));}else{const _0x5c01d3=typedi_1[_0xad09c3(0x106)][_0xad09c3(0xce)](git_sync_job_1[_0xad09c3(0xef)]);await _0x5c01d3[_0xad09c3(0xc6)]({'repository':_0xbd3f0c,'branch':_0x497fc2[_0xad09c3(0xca)],'provider':_0x5626a4,'repositoryGit':_0xbd3f0c['gitUrl'],'syncRecord':_0x497fc2,'logger':this[_0xad09c3(0xc8)]})[_0xad09c3(0xc0)](_0x4fb9f8=>this[_0xad09c3(0x104)](_0x497fc2,_0x4fb9f8));}}}catch(_0x3dc4cc){this[_0xad09c3(0x11e)][_0xad09c3(0xf3)](_0x3dc4cc);_0x3dc4cc instanceof too_many_requests_error_1[_0xad09c3(0x100)]?(await this[_0xad09c3(0xc8)][_0xad09c3(0x10c)](_0xad09c3(0xd3))[_0xad09c3(0xbf)](),await utils_1[_0xad09c3(0x115)](0x3c*0x3c*0x3e8),this[_0xad09c3(0xc6)](_0x3ae28b,_0x125a40,_0x5626a4,_0x3dda83)):await this[_0xad09c3(0xc8)]['log'](_0xad09c3(0xed)+_0x3dc4cc)[_0xad09c3(0xbf)]();return;}await this['sfLogger'][_0xad09c3(0x10c)](_0xad09c3(0xf0))['send'](),await this[_0xad09c3(0xe0)]['disableSync'](_0x3ae28b[_0xad09c3(0xd2)])[_0xad09c3(0xc0)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a188_0x2a2e29(0x112)]({'transient':!![]}),__metadata(a188_0x2a2e29(0xfd),[salesforce_service_1[a188_0x2a2e29(0xbe)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a188_0x2a2e29(0xdd)]])],SyncService),exports[a188_0x2a2e29(0xfb)]=SyncService;