const a181_0x4663fb=a181_0x54c3;(function(_0x1a6a8c,_0x419b5c){const _0x49fb1a=a181_0x54c3,_0xb5e7f9=_0x1a6a8c();while(!![]){try{const _0x36f56e=parseInt(_0x49fb1a(0xe8))/0x1*(parseInt(_0x49fb1a(0x12e))/0x2)+-parseInt(_0x49fb1a(0x12f))/0x3+parseInt(_0x49fb1a(0x12b))/0x4*(-parseInt(_0x49fb1a(0xf6))/0x5)+parseInt(_0x49fb1a(0x10d))/0x6+-parseInt(_0x49fb1a(0xd3))/0x7*(parseInt(_0x49fb1a(0xf5))/0x8)+parseInt(_0x49fb1a(0x11a))/0x9*(-parseInt(_0x49fb1a(0xff))/0xa)+-parseInt(_0x49fb1a(0xfe))/0xb*(-parseInt(_0x49fb1a(0xf7))/0xc);if(_0x36f56e===_0x419b5c)break;else _0xb5e7f9['push'](_0xb5e7f9['shift']());}catch(_0x339a72){_0xb5e7f9['push'](_0xb5e7f9['shift']());}}}(a181_0xd1d1,0x265b6));const a181_0x2f74c6=(function(){let _0xd9b5d9=!![];return function(_0x9996ab,_0xfc493b){const _0x33fc91=_0xd9b5d9?function(){const _0x8c59fa=a181_0x54c3;if(_0xfc493b){const _0x21c511=_0xfc493b[_0x8c59fa(0xdf)](_0x9996ab,arguments);return _0xfc493b=null,_0x21c511;}}:function(){};return _0xd9b5d9=![],_0x33fc91;};}()),a181_0x9bcce3=a181_0x2f74c6(this,function(){const _0x55afbf=a181_0x54c3;return a181_0x9bcce3[_0x55afbf(0xc9)]()[_0x55afbf(0xd0)](_0x55afbf(0x109))['toString']()[_0x55afbf(0xce)](a181_0x9bcce3)[_0x55afbf(0xd0)]('(((.+)+)+)+$');});a181_0x9bcce3();'use strict';function a181_0x54c3(_0x31ef36,_0x3d214f){const _0x3a786f=a181_0xd1d1();return a181_0x54c3=function(_0x9bcce3,_0x2f74c6){_0x9bcce3=_0x9bcce3-0xb8;let _0xd1d1b=_0x3a786f[_0x9bcce3];return _0xd1d1b;},a181_0x54c3(_0x31ef36,_0x3d214f);}function a181_0xd1d1(){const _0x3388b4=['writeComponents','../../salesforce/services/salesforce-logger-v2.service','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','getRemote','../utils/git.utils','toString','deleted','copyMdapiTo','clearDir','MDApiUtils','constructor','mdapiUtils','search','COMPONENTS_PER_TICK','SFDXUtils','7pvWxEH','__importDefault','provider','SalesforceLogger2','log','getProtocol','call','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','startTime','copyProjectTo','sfLogger','removeDir','apply','writed','join','[INFO]\x20Preparing\x20to\x20delete\x20components','[INFO]\x20Deleted\x20','push','fileName','authSettings','writeFlosumComponents','188059LKoOgn','[INFO]\x20Wrote\x20','object','decorate','function','../utils/sfdx.utils','../dto/commit-components.dto','includes','BitbucketApiService','name','design:paramtypes','values','dir','1438096ZKdVHz','1100CWSeZV','7368UWpNDL','getOwnPropertyDescriptor','gitUrl','cleanUp','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','prepareMdapi','../../salesforce/utils/sfdx.utils','13684XHWXOt','506680ewSRNz','commitData','__setModuleDefault','send','force-app','ms.\x20Committed\x20components\x20-\x20','../../../constants','getPrefix','GitUtils','SFDX','(((.+)+)+)+$','groupComponentsByFileName','../../shared/utils','reduce','649986inZCPa','run','catch','fileType','CommitComponentsDto','__esModule','clone','isLoggedIn','Service','metadata','gitUtils','[INFO]\x20Preparing\x20to\x20write\x20components','isEmptyDir','27mbXuuF','get','removeComponents','typedi','branch','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','default','componentsToWrite','defineProperty','componentsToDelete','length','getLoggerId','sfdxUtils','AuthSettingsService','components','__importStar','exec','4832uYdQdA','\x20components','__decorate','2rQatMH','916710snooya','type','splice','../../internal/fs.internal','hasOwnProperty','../utils/mdapi.utils','events','now','[ERROR]\x20','create','__createBinding','getCredentialsFor','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','master','CommitComponentsJob','commitAndPush'];a181_0xd1d1=function(){return _0x3388b4;};return a181_0xd1d1();}var __createBinding=this&&this[a181_0x4663fb(0xbe)]||(Object[a181_0x4663fb(0xbd)]?function(_0x37ce3e,_0xe6962,_0x8001e3,_0x3473c2){const _0x4d5f67=a181_0x4663fb;if(_0x3473c2===undefined)_0x3473c2=_0x8001e3;Object[_0x4d5f67(0x122)](_0x37ce3e,_0x3473c2,{'enumerable':!![],'get':function(){return _0xe6962[_0x8001e3];}});}:function(_0x858708,_0x399f5a,_0x170377,_0x2ffd52){if(_0x2ffd52===undefined)_0x2ffd52=_0x170377;_0x858708[_0x2ffd52]=_0x399f5a[_0x170377];}),__setModuleDefault=this&&this[a181_0x4663fb(0x101)]||(Object[a181_0x4663fb(0xbd)]?function(_0x3e49c8,_0x28c724){const _0x26dfbc=a181_0x4663fb;Object['defineProperty'](_0x3e49c8,_0x26dfbc(0x120),{'enumerable':!![],'value':_0x28c724});}:function(_0x34c37a,_0x5659db){const _0x2c5c73=a181_0x4663fb;_0x34c37a[_0x2c5c73(0x120)]=_0x5659db;}),__decorate=this&&this[a181_0x4663fb(0x12d)]||function(_0x2c1514,_0x504a96,_0x33fcd9,_0xb967ee){const _0x48938e=a181_0x4663fb;var _0xf28a0c=arguments['length'],_0x5e8d06=_0xf28a0c<0x3?_0x504a96:_0xb967ee===null?_0xb967ee=Object[_0x48938e(0xf8)](_0x504a96,_0x33fcd9):_0xb967ee,_0x188ba7;if(typeof Reflect==='object'&&typeof Reflect[_0x48938e(0xeb)]===_0x48938e(0xec))_0x5e8d06=Reflect['decorate'](_0x2c1514,_0x504a96,_0x33fcd9,_0xb967ee);else{for(var _0x52cdb6=_0x2c1514['length']-0x1;_0x52cdb6>=0x0;_0x52cdb6--)if(_0x188ba7=_0x2c1514[_0x52cdb6])_0x5e8d06=(_0xf28a0c<0x3?_0x188ba7(_0x5e8d06):_0xf28a0c>0x3?_0x188ba7(_0x504a96,_0x33fcd9,_0x5e8d06):_0x188ba7(_0x504a96,_0x33fcd9))||_0x5e8d06;}return _0xf28a0c>0x3&&_0x5e8d06&&Object['defineProperty'](_0x504a96,_0x33fcd9,_0x5e8d06),_0x5e8d06;},__importStar=this&&this[a181_0x4663fb(0x129)]||function(_0x24b609){const _0x26104b=a181_0x4663fb;if(_0x24b609&&_0x24b609['__esModule'])return _0x24b609;var _0x46153f={};if(_0x24b609!=null){for(var _0x3934f7 in _0x24b609)if(_0x3934f7!==_0x26104b(0x120)&&Object['prototype'][_0x26104b(0xb8)][_0x26104b(0xd9)](_0x24b609,_0x3934f7))__createBinding(_0x46153f,_0x24b609,_0x3934f7);}return __setModuleDefault(_0x46153f,_0x24b609),_0x46153f;},__metadata=this&&this['__metadata']||function(_0x406195,_0x329dd5){const _0x4aa30d=a181_0x4663fb;if(typeof Reflect===_0x4aa30d(0xea)&&typeof Reflect[_0x4aa30d(0x116)]===_0x4aa30d(0xec))return Reflect['metadata'](_0x406195,_0x329dd5);},__importDefault=this&&this[a181_0x4663fb(0xd4)]||function(_0x43eabe){const _0x1a2921=a181_0x4663fb;return _0x43eabe&&_0x43eabe[_0x1a2921(0x112)]?_0x43eabe:{'default':_0x43eabe};};Object['defineProperty'](exports,a181_0x4663fb(0x112),{'value':!![]}),exports[a181_0x4663fb(0xc2)]=void 0x0;const auth_settings_service_1=require('../../shared/services/auth-settings.service'),commit_components_dto_1=require(a181_0x4663fb(0xee)),events_1=__importDefault(require(a181_0x4663fb(0xba))),git_utils_1=require(a181_0x4663fb(0xc8)),mdapi_utils_1=require(a181_0x4663fb(0xb9)),sfdx_utils_1=require(a181_0x4663fb(0xed)),typedi_1=__importStar(require(a181_0x4663fb(0x11d))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a181_0x4663fb(0x10b)),salesforce_logger_v2_service_1=require(a181_0x4663fb(0xc5)),constants_1=require(a181_0x4663fb(0x105)),bitbucket_api_service_1=require('../../git-api/services/bitbucket-api.service'),sfdx_utils_2=require(a181_0x4663fb(0xfd)),fs_internal_1=require(a181_0x4663fb(0x132)),path_1=require('path');let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x4663fb(0x120)]{constructor(_0x1bf265){const _0x40bc9c=a181_0x4663fb;super(),this[_0x40bc9c(0xe6)]=_0x1bf265,this[_0x40bc9c(0xd1)]=0x3e8,this['componentsToWrite']=0x0,this['componentsToDelete']=0x0,this[_0x40bc9c(0xdb)]=Date[_0x40bc9c(0xbb)]();}async[a181_0x4663fb(0xc7)](){const _0x437d0e=a181_0x4663fb,{repo:_0x4ba100}=this[_0x437d0e(0x100)];let _0x21a567=this[_0x437d0e(0xe6)][_0x437d0e(0xbf)](this['commitData'][_0x437d0e(0xd5)]);if(this['commitData']['provider']==='bitbucket'){const _0x5c81e8=typedi_1['default'][_0x437d0e(0x11b)](bitbucket_api_service_1[_0x437d0e(0xf0)]);await _0x5c81e8[_0x437d0e(0x114)](),_0x21a567+=encodeURIComponent(_0x5c81e8['getAccessToken']());}return _0x4ba100[_0x437d0e(0xf9)]['replace'](/http(s)?\:\/\/(.+@)?/,utils_1[_0x437d0e(0xd8)](_0x4ba100[_0x437d0e(0xf9)])+'://'+_0x21a567+'@');}['groupComponentsByFileName'](_0x5e672a){const _0xbb8bad=a181_0x4663fb;var _0x7f10e1;_0x5e672a['sort'](_0xdf6106=>child_types_1[_0xbb8bad(0x120)][_0xbb8bad(0xef)](_0xdf6106[_0xbb8bad(0x110)])?0x1:-0x1);const _0x5a861e={};for(const _0x2ebfcc of _0x5e672a){_0x5a861e[_0x7f10e1=_0x2ebfcc[_0xbb8bad(0xe5)]]||(_0x5a861e[_0x7f10e1]=[]),_0x5a861e[_0x2ebfcc['fileName']][_0xbb8bad(0xe4)](_0x2ebfcc);}return Object[_0xbb8bad(0xf3)](_0x5a861e)[_0xbb8bad(0x10c)]((_0x1068b6,_0x26d006)=>[..._0x1068b6,..._0x26d006],[]);}async[a181_0x4663fb(0xc4)](_0xa8c064){const _0x33afa6=a181_0x4663fb;_0xa8c064=this[_0x33afa6(0x10a)](_0xa8c064);let _0x356269=0x0;while(_0xa8c064[_0x33afa6(0x124)]){const _0x17795a=_0xa8c064['splice'](0x0,this[_0x33afa6(0xd1)]);await this[_0x33afa6(0xcf)][_0x33afa6(0xe7)](_0x17795a,{'skipChildErrors':this[_0x33afa6(0x100)][_0x33afa6(0x11e)]['name']===_0x33afa6(0xc1)}),_0x356269+=_0x17795a[_0x33afa6(0x124)],this[_0x33afa6(0xdd)][_0x33afa6(0xd7)](_0x33afa6(0xe9)+_0x356269+'/'+this[_0x33afa6(0x121)]+_0x33afa6(0x12c)),await this['sfLogger']['send']();}}async[a181_0x4663fb(0x11c)](_0x5ccb4c){const _0x2d8d52=a181_0x4663fb;_0x5ccb4c['sort'](_0xd0b186=>child_types_1[_0x2d8d52(0x120)][_0x2d8d52(0xef)](_0xd0b186[_0x2d8d52(0x130)])?-0x1:0x1);let _0x4d0817=0x0;while(_0x5ccb4c[_0x2d8d52(0x124)]){const _0xea67fe=_0x5ccb4c[_0x2d8d52(0x131)](0x0,this[_0x2d8d52(0xd1)]);await this[_0x2d8d52(0xcf)][_0x2d8d52(0x11c)](_0xea67fe),_0x4d0817+=_0xea67fe[_0x2d8d52(0x124)],this[_0x2d8d52(0xdd)][_0x2d8d52(0xd7)](_0x2d8d52(0xe3)+_0x4d0817+'/'+this[_0x2d8d52(0x123)]+_0x2d8d52(0x12c)),await this[_0x2d8d52(0xdd)]['send']();}}async[a181_0x4663fb(0xfa)](){const _0x3bc2b7=a181_0x4663fb;this[_0x3bc2b7(0x117)]&&await this[_0x3bc2b7(0x117)][_0x3bc2b7(0xde)]()['catch'](()=>void 0x0),this['mdapiUtils']&&await this[_0x3bc2b7(0xcf)][_0x3bc2b7(0xde)]()[_0x3bc2b7(0x10f)](()=>void 0x0),this['sfdxUtils']&&await this[_0x3bc2b7(0x126)][_0x3bc2b7(0xde)]()['catch'](()=>void 0x0);}async['exec'](){const _0x2f25d6=a181_0x4663fb,{repo:_0xc779e7,branch:_0x183ece,components:_0x2b8a46,convertToSFDX:_0x15f733,message:_0x5ae4a0,user:_0x12f37b}=this[_0x2f25d6(0x100)];this[_0x2f25d6(0xcf)]=new mdapi_utils_1[(_0x2f25d6(0xcd))](_0xc779e7['name'],_0x183ece[_0x2f25d6(0xf1)]),this[_0x2f25d6(0x117)]=new git_utils_1[(_0x2f25d6(0x107))](await this[_0x2f25d6(0xc7)]()),this[_0x2f25d6(0x126)]=new sfdx_utils_1[(_0x2f25d6(0xd2))](_0xc779e7[_0x2f25d6(0xf1)],_0x183ece[_0x2f25d6(0xf1)]);let _0x57315d=_0x15f733;try{this['sfLogger']['log']('[INFO]\x20Start\x20clonning\x20repository'),await this[_0x2f25d6(0x117)][_0x2f25d6(0x113)](_0x183ece[_0x2f25d6(0xf1)],_0xc779e7[_0x2f25d6(0xf1)]);!this[_0x2f25d6(0x100)]['force']?(this[_0x2f25d6(0xdd)]['log']('[INFO]\x20Prepare\x20mdapi\x20files'),await this[_0x2f25d6(0xcf)][_0x2f25d6(0xfc)](this[_0x2f25d6(0x117)][_0x2f25d6(0xf4)])):this['sfLogger']['log'](_0x2f25d6(0xc0));_0x2b8a46[_0x2f25d6(0xe0)]&&(this[_0x2f25d6(0xdd)]['log'](_0x2f25d6(0x118)),this[_0x2f25d6(0x121)]=_0x2b8a46[_0x2f25d6(0xe0)][_0x2f25d6(0x124)],await this[_0x2f25d6(0xc4)](_0x2b8a46['writed']),await this['sfLogger'][_0x2f25d6(0x102)]());_0x2b8a46['deleted']&&(this['sfLogger'][_0x2f25d6(0xd7)](_0x2f25d6(0xe2)),this[_0x2f25d6(0x123)]=_0x2b8a46[_0x2f25d6(0xca)][_0x2f25d6(0x124)],await this['removeComponents'](_0x2b8a46['deleted']),await this[_0x2f25d6(0xdd)][_0x2f25d6(0x102)]());await this[_0x2f25d6(0xdd)]['send']();await sfdx_utils_2[_0x2f25d6(0x108)]['isSFDXProject'](this[_0x2f25d6(0x117)][_0x2f25d6(0xf4)])?(_0x57315d=!![],await fs_internal_1['FS'][_0x2f25d6(0xde)](path_1[_0x2f25d6(0xe1)](this[_0x2f25d6(0x117)][_0x2f25d6(0xf4)],_0x2f25d6(0x103)))):(_0x57315d&&(!await fs_internal_1['FS'][_0x2f25d6(0x119)](this['gitUtils']['dir'])&&(_0x57315d=![])),await this[_0x2f25d6(0x117)][_0x2f25d6(0xcc)]());_0x57315d?(this[_0x2f25d6(0xdd)][_0x2f25d6(0xd7)]('[INFO]\x20Start\x20converting\x20to\x20SFDX'),await this[_0x2f25d6(0x126)]['createProjectFrom'](this['mdapiUtils'][_0x2f25d6(0xf4)]),await this[_0x2f25d6(0x126)][_0x2f25d6(0xdc)](this[_0x2f25d6(0x117)][_0x2f25d6(0xf4)]),await this[_0x2f25d6(0x126)][_0x2f25d6(0xde)](),await this[_0x2f25d6(0xdd)][_0x2f25d6(0x102)]()):(this['sfLogger'][_0x2f25d6(0xd7)](_0x2f25d6(0xc6)),await this[_0x2f25d6(0xcf)][_0x2f25d6(0xcb)](this[_0x2f25d6(0x117)][_0x2f25d6(0xf4)]),await this[_0x2f25d6(0xdd)][_0x2f25d6(0x102)]());this['sfLogger'][_0x2f25d6(0xd7)](_0x2f25d6(0xfb)),await this['gitUtils'][_0x2f25d6(0xc3)](_0x5ae4a0,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x12f37b[_0x2f25d6(0xf1)]},_0x183ece[_0x2f25d6(0xf1)]),await this[_0x2f25d6(0x117)][_0x2f25d6(0xde)](),await this[_0x2f25d6(0xcf)]['removeDir']();const _0x5ba367=this[_0x2f25d6(0x121)]+this[_0x2f25d6(0x123)];this[_0x2f25d6(0xdd)][_0x2f25d6(0xd7)](_0x2f25d6(0xda)+(Date[_0x2f25d6(0xbb)]()-this[_0x2f25d6(0xdb)])+_0x2f25d6(0x104)+_0x5ba367),await this['sfLogger'][_0x2f25d6(0x102)]();}catch(_0x373dcb){await this[_0x2f25d6(0xfa)](),this[_0x2f25d6(0xdd)][_0x2f25d6(0xd7)](_0x2f25d6(0xbc)+_0x373dcb),await this[_0x2f25d6(0xdd)]['send']();throw _0x373dcb;}}async[a181_0x4663fb(0x10e)](_0x24fb5d,_0x2b03a0){const _0x39fad8=a181_0x4663fb;var _0x3ed487,_0x3701b4;this['sfLogger']=new salesforce_logger_v2_service_1[(_0x39fad8(0xd6))](_0x2b03a0[_0x39fad8(0x125)](),_0x2b03a0[_0x39fad8(0x106)]()+'\x20['+commit_components_dto_1[_0x39fad8(0x111)][_0x39fad8(0xf1)]+']');const _0x3547fe=!!((_0x3ed487=_0x24fb5d[_0x39fad8(0x128)])===null||_0x3ed487===void 0x0?void 0x0:_0x3ed487[_0x39fad8(0xe0)])||!!((_0x3701b4=_0x24fb5d[_0x39fad8(0x128)])===null||_0x3701b4===void 0x0?void 0x0:_0x3701b4['deleted']);if(!_0x3547fe){this[_0x39fad8(0xdd)][_0x39fad8(0xd7)](_0x39fad8(0x11f)),await this[_0x39fad8(0xdd)][_0x39fad8(0x102)]();return;}this['commitData']=_0x24fb5d,await this[_0x39fad8(0x12a)]();}};CommitComponentsJob=__decorate([typedi_1[a181_0x4663fb(0x115)]({'transient':!![]}),__metadata(a181_0x4663fb(0xf2),[auth_settings_service_1[a181_0x4663fb(0x127)]])],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;