const a181_0x5af48c=a181_0x33db;function a181_0x33db(_0xe3ca10,_0x26ad5c){const _0x3cec02=a181_0x523c();return a181_0x33db=function(_0x549ec5,_0x25edb4){_0x549ec5=_0x549ec5-0xef;let _0x523caf=_0x3cec02[_0x549ec5];return _0x523caf;},a181_0x33db(_0xe3ca10,_0x26ad5c);}(function(_0x2e8c32,_0x367956){const _0x39aaf8=a181_0x33db,_0x4cfab3=_0x2e8c32();while(!![]){try{const _0x1f7db6=parseInt(_0x39aaf8(0x165))/0x1+-parseInt(_0x39aaf8(0x130))/0x2*(parseInt(_0x39aaf8(0x143))/0x3)+-parseInt(_0x39aaf8(0x147))/0x4+parseInt(_0x39aaf8(0xf0))/0x5*(-parseInt(_0x39aaf8(0x127))/0x6)+parseInt(_0x39aaf8(0x145))/0x7+parseInt(_0x39aaf8(0x126))/0x8*(parseInt(_0x39aaf8(0x13b))/0x9)+parseInt(_0x39aaf8(0xf7))/0xa;if(_0x1f7db6===_0x367956)break;else _0x4cfab3['push'](_0x4cfab3['shift']());}catch(_0x5de7cd){_0x4cfab3['push'](_0x4cfab3['shift']());}}}(a181_0x523c,0xd8c7a));const a181_0x25edb4=(function(){let _0x3e7d0e=!![];return function(_0x284a98,_0x44e9b3){const _0x787d=_0x3e7d0e?function(){const _0xaebc0f=a181_0x33db;if(_0x44e9b3){const _0xa58d06=_0x44e9b3[_0xaebc0f(0x146)](_0x284a98,arguments);return _0x44e9b3=null,_0xa58d06;}}:function(){};return _0x3e7d0e=![],_0x787d;};}()),a181_0x549ec5=a181_0x25edb4(this,function(){const _0x409ae8=a181_0x33db;return a181_0x549ec5[_0x409ae8(0x14f)]()['search']('(((.+)+)+)+$')[_0x409ae8(0x14f)]()['constructor'](a181_0x549ec5)[_0x409ae8(0x118)](_0x409ae8(0x10d));});a181_0x549ec5();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a181_0x5af48c(0x110)]?function(_0x10c248,_0x3f1462,_0x426d9c,_0x16cb01){if(_0x16cb01===undefined)_0x16cb01=_0x426d9c;Object['defineProperty'](_0x10c248,_0x16cb01,{'enumerable':!![],'get':function(){return _0x3f1462[_0x426d9c];}});}:function(_0xf62f2e,_0x499bd8,_0x211070,_0x5cacb5){if(_0x5cacb5===undefined)_0x5cacb5=_0x211070;_0xf62f2e[_0x5cacb5]=_0x499bd8[_0x211070];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a181_0x5af48c(0x110)]?function(_0x3f726f,_0x518933){const _0x7a23dd=a181_0x5af48c;Object[_0x7a23dd(0x132)](_0x3f726f,_0x7a23dd(0x166),{'enumerable':!![],'value':_0x518933});}:function(_0x2a88e1,_0x38d0f4){_0x2a88e1['default']=_0x38d0f4;}),__decorate=this&&this[a181_0x5af48c(0x124)]||function(_0x2a0f0c,_0x406206,_0x3eb0aa,_0x4acc8f){const _0x3c297e=a181_0x5af48c;var _0x4a52d4=arguments[_0x3c297e(0xf2)],_0x1f8de1=_0x4a52d4<0x3?_0x406206:_0x4acc8f===null?_0x4acc8f=Object[_0x3c297e(0xef)](_0x406206,_0x3eb0aa):_0x4acc8f,_0x5d7f8f;if(typeof Reflect===_0x3c297e(0x111)&&typeof Reflect[_0x3c297e(0x125)]===_0x3c297e(0x13f))_0x1f8de1=Reflect[_0x3c297e(0x125)](_0x2a0f0c,_0x406206,_0x3eb0aa,_0x4acc8f);else{for(var _0x3e3270=_0x2a0f0c[_0x3c297e(0xf2)]-0x1;_0x3e3270>=0x0;_0x3e3270--)if(_0x5d7f8f=_0x2a0f0c[_0x3e3270])_0x1f8de1=(_0x4a52d4<0x3?_0x5d7f8f(_0x1f8de1):_0x4a52d4>0x3?_0x5d7f8f(_0x406206,_0x3eb0aa,_0x1f8de1):_0x5d7f8f(_0x406206,_0x3eb0aa))||_0x1f8de1;}return _0x4a52d4>0x3&&_0x1f8de1&&Object[_0x3c297e(0x132)](_0x406206,_0x3eb0aa,_0x1f8de1),_0x1f8de1;},__importStar=this&&this[a181_0x5af48c(0xf8)]||function(_0x23619d){const _0x46e675=a181_0x5af48c;if(_0x23619d&&_0x23619d[_0x46e675(0x121)])return _0x23619d;var _0x48d720={};if(_0x23619d!=null){for(var _0x1bdd26 in _0x23619d)if(_0x1bdd26!==_0x46e675(0x166)&&Object['prototype'][_0x46e675(0x119)][_0x46e675(0x152)](_0x23619d,_0x1bdd26))__createBinding(_0x48d720,_0x23619d,_0x1bdd26);}return __setModuleDefault(_0x48d720,_0x23619d),_0x48d720;},__metadata=this&&this[a181_0x5af48c(0x158)]||function(_0x5c7164,_0x3b58f4){const _0x21cd62=a181_0x5af48c;if(typeof Reflect===_0x21cd62(0x111)&&typeof Reflect[_0x21cd62(0x144)]===_0x21cd62(0x13f))return Reflect['metadata'](_0x5c7164,_0x3b58f4);},__importDefault=this&&this['__importDefault']||function(_0x595428){const _0x41cdab=a181_0x5af48c;return _0x595428&&_0x595428[_0x41cdab(0x121)]?_0x595428:{'default':_0x595428};};Object[a181_0x5af48c(0x132)](exports,a181_0x5af48c(0x121),{'value':!![]}),exports[a181_0x5af48c(0x160)]=void 0x0;const auth_settings_service_1=require(a181_0x5af48c(0x106)),commit_components_dto_1=require(a181_0x5af48c(0x11b)),events_1=__importDefault(require(a181_0x5af48c(0x155))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a181_0x5af48c(0x13c)),typedi_1=__importStar(require(a181_0x5af48c(0x150))),child_types_1=__importDefault(require(a181_0x5af48c(0xf9))),utils_1=require('../../shared/utils'),salesforce_logger_v2_service_1=require(a181_0x5af48c(0x13e)),constants_1=require(a181_0x5af48c(0x13a)),bitbucket_api_service_1=require('../../git-api/services/bitbucket-api.service'),sfdx_utils_2=require(a181_0x5af48c(0x10f)),fs_internal_1=require(a181_0x5af48c(0x112)),path_1=require(a181_0x5af48c(0x156));function a181_0x523c(){const _0x528bb9=['1219823epESrb','default','getOwnPropertyDescriptor','625haSRJl','createProjectFrom','length','COMPONENTS_PER_TICK','gitUtils','reduce','sfLogger','4946500axREVU','__importStar','../../parsers/data/child-types','removeComponents','sort','componentsToWrite','fileType','send','dir','isLoggedIn','removeDir','\x20components','force-app','isEmptyDir','gitUrl','../../shared/services/auth-settings.service','exec','SalesforceLogger2','MDApiUtils','[INFO]\x20Start\x20converting\x20to\x20SFDX','cleanUp','SFDXUtils','(((.+)+)+)+$','writeComponents','../../salesforce/utils/sfdx.utils','create','object','../../internal/fs.internal','fileName','componentsToDelete','[INFO]\x20Prepare\x20mdapi\x20files','commitAndPush','clearDir','search','hasOwnProperty','SFDX','../dto/commit-components.dto','get','type','name','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','[INFO]\x20Preparing\x20to\x20delete\x20components','__esModule','[INFO]\x20Preparing\x20to\x20write\x20components','bitbucket','__decorate','decorate','94504NJfBVy','2754ZnoKJE','getRemote','getPrefix','deleted','prepareMdapi','push','Service','log','getProtocol','6TozdNs','GitUtils','defineProperty','sfdxUtils','replace','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','isSFDXProject','[INFO]\x20Wrote\x20','now','CommitComponentsDto','../../../constants','1296YXFLXV','../utils/sfdx.utils','commitData','../../salesforce/services/salesforce-logger-v2.service','function','join','clone','startTime','1550007Xmgfxy','metadata','1850660RAVPMg','apply','4738452FGtEDI','catch','design:paramtypes','authSettings','mdapiUtils','components','includes','[ERROR]\x20','toString','typedi','provider','call','getLoggerId','groupComponentsByFileName','events','path','splice','__metadata','BitbucketApiService','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','AuthSettingsService','://','[INFO]\x20Deleted\x20','values','copyProjectTo','CommitComponentsJob','DEFAULT_GIT_USER_EMAIL','writed','getAccessToken','getCredentialsFor'];a181_0x523c=function(){return _0x528bb9;};return a181_0x523c();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x5af48c(0x166)]{constructor(_0x30ae8a){const _0xf2045d=a181_0x5af48c;super(),this[_0xf2045d(0x14a)]=_0x30ae8a,this['COMPONENTS_PER_TICK']=0x3e8,this[_0xf2045d(0xfc)]=0x0,this[_0xf2045d(0x114)]=0x0,this[_0xf2045d(0x142)]=Date[_0xf2045d(0x138)]();}async[a181_0x5af48c(0x128)](){const _0x5a4550=a181_0x5af48c,{repo:_0x1d1a4f}=this[_0x5a4550(0x13d)];let _0xbc075b=this[_0x5a4550(0x14a)][_0x5a4550(0x164)](this['commitData']['provider']);if(this[_0x5a4550(0x13d)][_0x5a4550(0x151)]===_0x5a4550(0x123)){const _0x30945e=typedi_1[_0x5a4550(0x166)][_0x5a4550(0x11c)](bitbucket_api_service_1[_0x5a4550(0x159)]);await _0x30945e[_0x5a4550(0x100)](),_0xbc075b+=encodeURIComponent(_0x30945e[_0x5a4550(0x163)]());}return _0x1d1a4f[_0x5a4550(0x105)][_0x5a4550(0x134)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x5a4550(0x12f)](_0x1d1a4f[_0x5a4550(0x105)])+_0x5a4550(0x15c)+_0xbc075b+'@');}['groupComponentsByFileName'](_0x287429){const _0x8a3515=a181_0x5af48c;var _0x471145;_0x287429[_0x8a3515(0xfb)](_0x180992=>child_types_1[_0x8a3515(0x166)][_0x8a3515(0x14d)](_0x180992[_0x8a3515(0xfd)])?0x1:-0x1);const _0x91d132={};for(const _0x1de301 of _0x287429){_0x91d132[_0x471145=_0x1de301['fileName']]||(_0x91d132[_0x471145]=[]),_0x91d132[_0x1de301[_0x8a3515(0x113)]][_0x8a3515(0x12c)](_0x1de301);}return Object[_0x8a3515(0x15e)](_0x91d132)[_0x8a3515(0xf5)]((_0x34d176,_0x2f1035)=>[..._0x34d176,..._0x2f1035],[]);}async['writeComponents'](_0x1e6517){const _0x40c84d=a181_0x5af48c;_0x1e6517=this[_0x40c84d(0x154)](_0x1e6517);let _0x16be9a=0x0;while(_0x1e6517[_0x40c84d(0xf2)]){const _0x5d01bd=_0x1e6517[_0x40c84d(0x157)](0x0,this[_0x40c84d(0xf3)]);await this[_0x40c84d(0x14b)]['writeFlosumComponents'](_0x5d01bd,{'skipChildErrors':this[_0x40c84d(0x13d)]['branch']['name']==='master'}),_0x16be9a+=_0x5d01bd[_0x40c84d(0xf2)],this['sfLogger'][_0x40c84d(0x12e)](_0x40c84d(0x137)+_0x16be9a+'/'+this[_0x40c84d(0xfc)]+_0x40c84d(0x102)),await this[_0x40c84d(0xf6)][_0x40c84d(0xfe)]();}}async[a181_0x5af48c(0xfa)](_0xe00167){const _0x31a85e=a181_0x5af48c;_0xe00167[_0x31a85e(0xfb)](_0x3daf95=>child_types_1[_0x31a85e(0x166)][_0x31a85e(0x14d)](_0x3daf95[_0x31a85e(0x11d)])?-0x1:0x1);let _0x217617=0x0;while(_0xe00167[_0x31a85e(0xf2)]){const _0x1a353d=_0xe00167[_0x31a85e(0x157)](0x0,this[_0x31a85e(0xf3)]);await this[_0x31a85e(0x14b)]['removeComponents'](_0x1a353d),_0x217617+=_0x1a353d[_0x31a85e(0xf2)],this[_0x31a85e(0xf6)][_0x31a85e(0x12e)](_0x31a85e(0x15d)+_0x217617+'/'+this['componentsToDelete']+_0x31a85e(0x102)),await this[_0x31a85e(0xf6)]['send']();}}async['cleanUp'](){const _0xdc95c7=a181_0x5af48c;this[_0xdc95c7(0xf4)]&&await this[_0xdc95c7(0xf4)][_0xdc95c7(0x101)]()[_0xdc95c7(0x148)](()=>void 0x0),this['mdapiUtils']&&await this[_0xdc95c7(0x14b)][_0xdc95c7(0x101)]()[_0xdc95c7(0x148)](()=>void 0x0),this[_0xdc95c7(0x133)]&&await this[_0xdc95c7(0x133)][_0xdc95c7(0x101)]()[_0xdc95c7(0x148)](()=>void 0x0);}async[a181_0x5af48c(0x107)](){const _0x28786d=a181_0x5af48c,{repo:_0x340954,branch:_0x303768,components:_0x2ea17c,convertToSFDX:_0x4888b9,message:_0x293487,user:_0x9d1ac0}=this['commitData'];this[_0x28786d(0x14b)]=new mdapi_utils_1[(_0x28786d(0x109))](_0x340954[_0x28786d(0x11e)],_0x303768['name']),this['gitUtils']=new git_utils_1[(_0x28786d(0x131))](await this[_0x28786d(0x128)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x28786d(0x10c))](_0x340954[_0x28786d(0x11e)],_0x303768[_0x28786d(0x11e)]);let _0x225cc8=_0x4888b9;try{this[_0x28786d(0xf6)][_0x28786d(0x12e)]('[INFO]\x20Start\x20clonning\x20repository'),await this['gitUtils'][_0x28786d(0x141)](_0x303768[_0x28786d(0x11e)],_0x340954[_0x28786d(0x11e)]);!this['commitData']['force']?(this[_0x28786d(0xf6)]['log'](_0x28786d(0x115)),await this[_0x28786d(0x14b)][_0x28786d(0x12b)](this['gitUtils'][_0x28786d(0xff)])):this[_0x28786d(0xf6)][_0x28786d(0x12e)](_0x28786d(0x135));_0x2ea17c[_0x28786d(0x162)]&&(this[_0x28786d(0xf6)][_0x28786d(0x12e)](_0x28786d(0x122)),this[_0x28786d(0xfc)]=_0x2ea17c[_0x28786d(0x162)][_0x28786d(0xf2)],await this[_0x28786d(0x10e)](_0x2ea17c[_0x28786d(0x162)]),await this[_0x28786d(0xf6)][_0x28786d(0xfe)]());_0x2ea17c[_0x28786d(0x12a)]&&(this[_0x28786d(0xf6)][_0x28786d(0x12e)](_0x28786d(0x120)),this['componentsToDelete']=_0x2ea17c[_0x28786d(0x12a)][_0x28786d(0xf2)],await this[_0x28786d(0xfa)](_0x2ea17c[_0x28786d(0x12a)]),await this['sfLogger'][_0x28786d(0xfe)]());await this[_0x28786d(0xf6)][_0x28786d(0xfe)]();await sfdx_utils_2[_0x28786d(0x11a)][_0x28786d(0x136)](this[_0x28786d(0xf4)][_0x28786d(0xff)])?(_0x225cc8=!![],await fs_internal_1['FS'][_0x28786d(0x101)](path_1[_0x28786d(0x140)](this[_0x28786d(0xf4)]['dir'],_0x28786d(0x103)))):(_0x225cc8&&(!await fs_internal_1['FS'][_0x28786d(0x104)](this[_0x28786d(0xf4)]['dir'])&&(_0x225cc8=![])),await this[_0x28786d(0xf4)][_0x28786d(0x117)]());_0x225cc8?(this[_0x28786d(0xf6)]['log'](_0x28786d(0x10a)),await this[_0x28786d(0x133)][_0x28786d(0xf1)](this[_0x28786d(0x14b)][_0x28786d(0xff)]),await this['sfdxUtils'][_0x28786d(0x15f)](this[_0x28786d(0xf4)][_0x28786d(0xff)]),await this[_0x28786d(0x133)][_0x28786d(0x101)](),await this['sfLogger'][_0x28786d(0xfe)]()):(this['sfLogger'][_0x28786d(0x12e)](_0x28786d(0x11f)),await this['mdapiUtils']['copyMdapiTo'](this[_0x28786d(0xf4)][_0x28786d(0xff)]),await this[_0x28786d(0xf6)][_0x28786d(0xfe)]());this[_0x28786d(0xf6)][_0x28786d(0x12e)]('[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git'),await this['gitUtils'][_0x28786d(0x116)](_0x293487,{'email':constants_1[_0x28786d(0x161)],'name':_0x9d1ac0['name']},_0x303768['name']),await this[_0x28786d(0xf4)][_0x28786d(0x101)](),await this[_0x28786d(0x14b)][_0x28786d(0x101)]();const _0x39805b=this['componentsToWrite']+this[_0x28786d(0x114)];this[_0x28786d(0xf6)][_0x28786d(0x12e)](_0x28786d(0x15a)+(Date[_0x28786d(0x138)]()-this['startTime'])+'ms.\x20Committed\x20components\x20-\x20'+_0x39805b),await this[_0x28786d(0xf6)][_0x28786d(0xfe)]();}catch(_0x456d63){await this[_0x28786d(0x10b)](),this[_0x28786d(0xf6)][_0x28786d(0x12e)](_0x28786d(0x14e)+_0x456d63),await this[_0x28786d(0xf6)][_0x28786d(0xfe)]();throw _0x456d63;}}async['run'](_0x2f9e38,_0x1f4cd4){const _0x4525d8=a181_0x5af48c;var _0x3d28f4,_0x189016;this[_0x4525d8(0xf6)]=new salesforce_logger_v2_service_1[(_0x4525d8(0x108))](_0x1f4cd4[_0x4525d8(0x153)](),_0x1f4cd4[_0x4525d8(0x129)]()+'\x20['+commit_components_dto_1[_0x4525d8(0x139)][_0x4525d8(0x11e)]+']');const _0x711c2d=!!((_0x3d28f4=_0x2f9e38[_0x4525d8(0x14c)])===null||_0x3d28f4===void 0x0?void 0x0:_0x3d28f4[_0x4525d8(0x162)])||!!((_0x189016=_0x2f9e38[_0x4525d8(0x14c)])===null||_0x189016===void 0x0?void 0x0:_0x189016[_0x4525d8(0x12a)]);if(!_0x711c2d){this[_0x4525d8(0xf6)]['log']('[INFO]\x20Nothing\x20to\x20commit.\x20Skip.'),await this[_0x4525d8(0xf6)][_0x4525d8(0xfe)]();return;}this['commitData']=_0x2f9e38,await this[_0x4525d8(0x107)]();}};CommitComponentsJob=__decorate([typedi_1[a181_0x5af48c(0x12d)]({'transient':!![]}),__metadata(a181_0x5af48c(0x149),[auth_settings_service_1[a181_0x5af48c(0x15b)]])],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;