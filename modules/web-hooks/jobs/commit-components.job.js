const a180_0x4c36a5=a180_0xb64a;function a180_0x1f79(){const _0x1d394d=['push','cleanUp','deleted','177640egONbL','components','run','provider','../utils/sfdx.utils','getPrefix','force','groupComponentsByFileName','fileName','CommitComponentsJob','[INFO]\x20Prepare\x20mdapi\x20files','SFDXUtils','clearDir','constructor','18XhDcai','default','object','design:paramtypes','exec','componentsToWrite','../utils/mdapi.utils','commitData','createProjectFrom','bitbucket','isEmptyDir','join','removeComponents','getOwnPropertyDescriptor','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','toString','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','commitAndPush','send','__importDefault','[INFO]\x20Start\x20converting\x20to\x20SFDX','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','__metadata','copyProjectTo','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','646959cEFtrG','BitbucketApiService','replace','../../shared/services/auth-settings.service','getLoggerId','getCredentialsFor','fileType','function','force-app','../../../constants','authSettings','call','__createBinding','values','dir','4427704bSfAsn','40yHhIWm','18Jlroti','typedi','removeDir','apply','[INFO]\x20Preparing\x20to\x20delete\x20components','mdapiUtils','ms.\x20Committed\x20components\x20-\x20','events','length','COMPONENTS_PER_TICK','get','writed','(((.+)+)+)+$','__decorate','11tewvhs','metadata','79487QDLvOD','startTime','../../shared/utils','sfLogger','defineProperty','decorate','AuthSettingsService','GitUtils','Service','gitUtils','[ERROR]\x20','hasOwnProperty','MDApiUtils','branch','master','[INFO]\x20Start\x20clonning\x20repository','isLoggedIn','name','[INFO]\x20Preparing\x20to\x20write\x20components','type','sfdxUtils','writeFlosumComponents','114fwMTpv','now','../../internal/fs.internal','\x20components','path','reduce','isSFDXProject','2605570cyHGvd','../../git-api/services/bitbucket-api.service','getRemote','sort','componentsToDelete','__esModule','gitUrl','splice','log','includes','6663672iERguL','../dto/commit-components.dto','217133yQUVoN','writeComponents'];a180_0x1f79=function(){return _0x1d394d;};return a180_0x1f79();}(function(_0x59f3b3,_0x48e710){const _0x2c9dbc=a180_0xb64a,_0xc8cf0b=_0x59f3b3();while(!![]){try{const _0x3447d5=parseInt(_0x2c9dbc(0x1be))/0x1*(parseInt(_0x2c9dbc(0x184))/0x2)+-parseInt(_0x2c9dbc(0x19d))/0x3+parseInt(_0x2c9dbc(0x1ad))/0x4*(parseInt(_0x2c9dbc(0x1ec))/0x5)+parseInt(_0x2c9dbc(0x1d4))/0x6*(-parseInt(_0x2c9dbc(0x1e7))/0x7)+parseInt(_0x2c9dbc(0x1ac))/0x8*(parseInt(_0x2c9dbc(0x1ae))/0x9)+-parseInt(_0x2c9dbc(0x1db))/0xa+-parseInt(_0x2c9dbc(0x1bc))/0xb*(parseInt(_0x2c9dbc(0x1e5))/0xc);if(_0x3447d5===_0x48e710)break;else _0xc8cf0b['push'](_0xc8cf0b['shift']());}catch(_0x1fcd76){_0xc8cf0b['push'](_0xc8cf0b['shift']());}}}(a180_0x1f79,0x87ea8));const a180_0xa71b0=(function(){let _0xbddbda=!![];return function(_0x59dbfa,_0xc2b8d6){const _0x582b85=_0xbddbda?function(){const _0x238c41=a180_0xb64a;if(_0xc2b8d6){const _0x44e18d=_0xc2b8d6[_0x238c41(0x1b1)](_0x59dbfa,arguments);return _0xc2b8d6=null,_0x44e18d;}}:function(){};return _0xbddbda=![],_0x582b85;};}()),a180_0x1b92ad=a180_0xa71b0(this,function(){const _0x255e1b=a180_0xb64a;return a180_0x1b92ad[_0x255e1b(0x193)]()['search'](_0x255e1b(0x1ba))[_0x255e1b(0x193)]()[_0x255e1b(0x183)](a180_0x1b92ad)['search']('(((.+)+)+)+$');});a180_0x1b92ad();'use strict';var __createBinding=this&&this[a180_0x4c36a5(0x1a9)]||(Object['create']?function(_0x982c61,_0x416a66,_0x2d3700,_0x3497dd){const _0x116b61=a180_0x4c36a5;if(_0x3497dd===undefined)_0x3497dd=_0x2d3700;Object[_0x116b61(0x1c2)](_0x982c61,_0x3497dd,{'enumerable':!![],'get':function(){return _0x416a66[_0x2d3700];}});}:function(_0xf06d39,_0x30574f,_0x22e71d,_0x532065){if(_0x532065===undefined)_0x532065=_0x22e71d;_0xf06d39[_0x532065]=_0x30574f[_0x22e71d];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x23e9e2,_0x1677cf){const _0x4b82dd=a180_0x4c36a5;Object[_0x4b82dd(0x1c2)](_0x23e9e2,_0x4b82dd(0x185),{'enumerable':!![],'value':_0x1677cf});}:function(_0x47d5c0,_0x325534){_0x47d5c0['default']=_0x325534;}),__decorate=this&&this[a180_0x4c36a5(0x1bb)]||function(_0x3e3316,_0x268427,_0x15a849,_0x3dde65){const _0x450d32=a180_0x4c36a5;var _0x3a29dc=arguments[_0x450d32(0x1b6)],_0x2f6685=_0x3a29dc<0x3?_0x268427:_0x3dde65===null?_0x3dde65=Object[_0x450d32(0x191)](_0x268427,_0x15a849):_0x3dde65,_0x2c57a6;if(typeof Reflect===_0x450d32(0x186)&&typeof Reflect[_0x450d32(0x1c3)]===_0x450d32(0x1a4))_0x2f6685=Reflect[_0x450d32(0x1c3)](_0x3e3316,_0x268427,_0x15a849,_0x3dde65);else{for(var _0x40d3d0=_0x3e3316['length']-0x1;_0x40d3d0>=0x0;_0x40d3d0--)if(_0x2c57a6=_0x3e3316[_0x40d3d0])_0x2f6685=(_0x3a29dc<0x3?_0x2c57a6(_0x2f6685):_0x3a29dc>0x3?_0x2c57a6(_0x268427,_0x15a849,_0x2f6685):_0x2c57a6(_0x268427,_0x15a849))||_0x2f6685;}return _0x3a29dc>0x3&&_0x2f6685&&Object[_0x450d32(0x1c2)](_0x268427,_0x15a849,_0x2f6685),_0x2f6685;},__importStar=this&&this['__importStar']||function(_0x58b3d4){const _0x200937=a180_0x4c36a5;if(_0x58b3d4&&_0x58b3d4['__esModule'])return _0x58b3d4;var _0x1ac292={};if(_0x58b3d4!=null){for(var _0x45e897 in _0x58b3d4)if(_0x45e897!==_0x200937(0x185)&&Object['prototype'][_0x200937(0x1c9)][_0x200937(0x1a8)](_0x58b3d4,_0x45e897))__createBinding(_0x1ac292,_0x58b3d4,_0x45e897);}return __setModuleDefault(_0x1ac292,_0x58b3d4),_0x1ac292;},__metadata=this&&this[a180_0x4c36a5(0x19a)]||function(_0x525620,_0x2b397f){const _0x3ef0cf=a180_0x4c36a5;if(typeof Reflect===_0x3ef0cf(0x186)&&typeof Reflect[_0x3ef0cf(0x1bd)]==='function')return Reflect['metadata'](_0x525620,_0x2b397f);},__importDefault=this&&this[a180_0x4c36a5(0x197)]||function(_0x46261e){const _0x108c1c=a180_0x4c36a5;return _0x46261e&&_0x46261e[_0x108c1c(0x1e0)]?_0x46261e:{'default':_0x46261e};};Object[a180_0x4c36a5(0x1c2)](exports,'__esModule',{'value':!![]}),exports['CommitComponentsJob']=void 0x0;function a180_0xb64a(_0x3454d8,_0x45f811){const _0x12238a=a180_0x1f79();return a180_0xb64a=function(_0x1b92ad,_0xa71b0){_0x1b92ad=_0x1b92ad-0x178;let _0x1f7984=_0x12238a[_0x1b92ad];return _0x1f7984;},a180_0xb64a(_0x3454d8,_0x45f811);}const auth_settings_service_1=require(a180_0x4c36a5(0x1a0)),commit_components_dto_1=require(a180_0x4c36a5(0x1e6)),events_1=__importDefault(require(a180_0x4c36a5(0x1b5))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a180_0x4c36a5(0x18a)),sfdx_utils_1=require(a180_0x4c36a5(0x17a)),typedi_1=__importStar(require(a180_0x4c36a5(0x1af))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a180_0x4c36a5(0x1c0)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),constants_1=require(a180_0x4c36a5(0x1a6)),bitbucket_api_service_1=require(a180_0x4c36a5(0x1dc)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a180_0x4c36a5(0x1d6)),path_1=require(a180_0x4c36a5(0x1d8));let CommitComponentsJob=class CommitComponentsJob extends events_1[a180_0x4c36a5(0x185)]{constructor(_0x411a30){const _0x51dba6=a180_0x4c36a5;super(),this[_0x51dba6(0x1a7)]=_0x411a30,this[_0x51dba6(0x1b7)]=0x3e8,this[_0x51dba6(0x189)]=0x0,this[_0x51dba6(0x1df)]=0x0,this['startTime']=Date[_0x51dba6(0x1d5)]();}async['getRemote'](){const _0x3f0d52=a180_0x4c36a5,{repo:_0x223987}=this[_0x3f0d52(0x18b)];let _0x303688=this['authSettings'][_0x3f0d52(0x1a2)](this['commitData'][_0x3f0d52(0x179)]);if(this[_0x3f0d52(0x18b)][_0x3f0d52(0x179)]===_0x3f0d52(0x18d)){const _0x2934de=typedi_1[_0x3f0d52(0x185)][_0x3f0d52(0x1b8)](bitbucket_api_service_1[_0x3f0d52(0x19e)]);await _0x2934de[_0x3f0d52(0x1ce)](),_0x303688+=encodeURIComponent(_0x2934de['getAccessToken']());}return _0x223987['gitUrl'][_0x3f0d52(0x19f)](/http(s)?\:\/\/(.+@)?/,utils_1['getProtocol'](_0x223987[_0x3f0d52(0x1e1)])+'://'+_0x303688+'@');}[a180_0x4c36a5(0x17d)](_0x419e5b){const _0x22c0ac=a180_0x4c36a5;var _0x1b1350;_0x419e5b[_0x22c0ac(0x1de)](_0xe4b46c=>child_types_1['default'][_0x22c0ac(0x1e4)](_0xe4b46c[_0x22c0ac(0x1a3)])?0x1:-0x1);const _0x10f7c2={};for(const _0x120af3 of _0x419e5b){_0x10f7c2[_0x1b1350=_0x120af3['fileName']]||(_0x10f7c2[_0x1b1350]=[]),_0x10f7c2[_0x120af3[_0x22c0ac(0x17e)]][_0x22c0ac(0x1e9)](_0x120af3);}return Object[_0x22c0ac(0x1aa)](_0x10f7c2)[_0x22c0ac(0x1d9)]((_0x55347b,_0x467179)=>[..._0x55347b,..._0x467179],[]);}async[a180_0x4c36a5(0x1e8)](_0x125135){const _0x19ec60=a180_0x4c36a5;_0x125135=this[_0x19ec60(0x17d)](_0x125135);let _0x455444=0x0;while(_0x125135['length']){const _0x17c105=_0x125135[_0x19ec60(0x1e2)](0x0,this[_0x19ec60(0x1b7)]);await this[_0x19ec60(0x1b3)][_0x19ec60(0x1d3)](_0x17c105,{'skipChildErrors':this[_0x19ec60(0x18b)][_0x19ec60(0x1cb)][_0x19ec60(0x1cf)]===_0x19ec60(0x1cc)}),_0x455444+=_0x17c105['length'],this[_0x19ec60(0x1c1)][_0x19ec60(0x1e3)]('[INFO]\x20Wrote\x20'+_0x455444+'/'+this['componentsToWrite']+_0x19ec60(0x1d7)),await this['sfLogger'][_0x19ec60(0x196)]();}}async[a180_0x4c36a5(0x190)](_0x5c41e8){const _0x45ffef=a180_0x4c36a5;_0x5c41e8['sort'](_0x2cfc55=>child_types_1[_0x45ffef(0x185)]['includes'](_0x2cfc55[_0x45ffef(0x1d1)])?-0x1:0x1);let _0x3adae9=0x0;while(_0x5c41e8[_0x45ffef(0x1b6)]){const _0x5d944e=_0x5c41e8[_0x45ffef(0x1e2)](0x0,this[_0x45ffef(0x1b7)]);await this[_0x45ffef(0x1b3)][_0x45ffef(0x190)](_0x5d944e),_0x3adae9+=_0x5d944e[_0x45ffef(0x1b6)],this[_0x45ffef(0x1c1)]['log']('[INFO]\x20Deleted\x20'+_0x3adae9+'/'+this[_0x45ffef(0x1df)]+'\x20components'),await this[_0x45ffef(0x1c1)][_0x45ffef(0x196)]();}}async[a180_0x4c36a5(0x1ea)](){const _0x456bac=a180_0x4c36a5;this['gitUtils']&&await this['gitUtils'][_0x456bac(0x1b0)]()['catch'](()=>void 0x0),this[_0x456bac(0x1b3)]&&await this[_0x456bac(0x1b3)]['removeDir']()['catch'](()=>void 0x0),this[_0x456bac(0x1d2)]&&await this[_0x456bac(0x1d2)][_0x456bac(0x1b0)]()['catch'](()=>void 0x0);}async[a180_0x4c36a5(0x188)](){const _0x37dab9=a180_0x4c36a5,{repo:_0x50e511,branch:_0x3f23c0,components:_0x1f2415,convertToSFDX:_0x3615c9,message:_0x262651,user:_0x5ee2ba}=this[_0x37dab9(0x18b)];this['mdapiUtils']=new mdapi_utils_1[(_0x37dab9(0x1ca))](_0x50e511[_0x37dab9(0x1cf)],_0x3f23c0[_0x37dab9(0x1cf)]),this['gitUtils']=new git_utils_1[(_0x37dab9(0x1c5))](await this[_0x37dab9(0x1dd)]()),this[_0x37dab9(0x1d2)]=new sfdx_utils_1[(_0x37dab9(0x181))](_0x50e511[_0x37dab9(0x1cf)],_0x3f23c0[_0x37dab9(0x1cf)]);let _0x120484=_0x3615c9;try{this[_0x37dab9(0x1c1)][_0x37dab9(0x1e3)](_0x37dab9(0x1cd)),await this['gitUtils']['clone'](_0x3f23c0['name'],_0x50e511[_0x37dab9(0x1cf)]);!this['commitData'][_0x37dab9(0x17c)]?(this[_0x37dab9(0x1c1)][_0x37dab9(0x1e3)](_0x37dab9(0x180)),await this[_0x37dab9(0x1b3)]['prepareMdapi'](this[_0x37dab9(0x1c7)]['dir'])):this[_0x37dab9(0x1c1)][_0x37dab9(0x1e3)]('[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');_0x1f2415[_0x37dab9(0x1b9)]&&(this[_0x37dab9(0x1c1)][_0x37dab9(0x1e3)](_0x37dab9(0x1d0)),this[_0x37dab9(0x189)]=_0x1f2415['writed']['length'],await this[_0x37dab9(0x1e8)](_0x1f2415[_0x37dab9(0x1b9)]),await this['sfLogger'][_0x37dab9(0x196)]());_0x1f2415['deleted']&&(this[_0x37dab9(0x1c1)][_0x37dab9(0x1e3)](_0x37dab9(0x1b2)),this[_0x37dab9(0x1df)]=_0x1f2415[_0x37dab9(0x1eb)][_0x37dab9(0x1b6)],await this['removeComponents'](_0x1f2415[_0x37dab9(0x1eb)]),await this[_0x37dab9(0x1c1)][_0x37dab9(0x196)]());await this[_0x37dab9(0x1c1)][_0x37dab9(0x196)]();await sfdx_utils_2['SFDX'][_0x37dab9(0x1da)](this[_0x37dab9(0x1c7)][_0x37dab9(0x1ab)])?(_0x120484=!![],await fs_internal_1['FS']['removeDir'](path_1[_0x37dab9(0x18f)](this[_0x37dab9(0x1c7)]['dir'],_0x37dab9(0x1a5)))):(_0x120484&&(!await fs_internal_1['FS'][_0x37dab9(0x18e)](this['gitUtils']['dir'])&&(_0x120484=![])),await this[_0x37dab9(0x1c7)][_0x37dab9(0x182)]());_0x120484?(this[_0x37dab9(0x1c1)][_0x37dab9(0x1e3)](_0x37dab9(0x198)),await this['sfdxUtils'][_0x37dab9(0x18c)](this['mdapiUtils'][_0x37dab9(0x1ab)]),await this[_0x37dab9(0x1d2)][_0x37dab9(0x19b)](this[_0x37dab9(0x1c7)][_0x37dab9(0x1ab)]),await this['sfdxUtils'][_0x37dab9(0x1b0)](),await this[_0x37dab9(0x1c1)][_0x37dab9(0x196)]()):(this[_0x37dab9(0x1c1)]['log'](_0x37dab9(0x192)),await this['mdapiUtils']['copyMdapiTo'](this[_0x37dab9(0x1c7)][_0x37dab9(0x1ab)]),await this[_0x37dab9(0x1c1)][_0x37dab9(0x196)]());this['sfLogger'][_0x37dab9(0x1e3)](_0x37dab9(0x19c)),await this[_0x37dab9(0x1c7)][_0x37dab9(0x195)](_0x262651,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x5ee2ba[_0x37dab9(0x1cf)]},_0x3f23c0[_0x37dab9(0x1cf)]),await this[_0x37dab9(0x1c7)]['removeDir'](),await this['mdapiUtils'][_0x37dab9(0x1b0)]();const _0x3635db=this[_0x37dab9(0x189)]+this[_0x37dab9(0x1df)];this[_0x37dab9(0x1c1)][_0x37dab9(0x1e3)](_0x37dab9(0x199)+(Date[_0x37dab9(0x1d5)]()-this[_0x37dab9(0x1bf)])+_0x37dab9(0x1b4)+_0x3635db),await this[_0x37dab9(0x1c1)]['send']();}catch(_0x1c07d8){await this[_0x37dab9(0x1ea)](),this['sfLogger'][_0x37dab9(0x1e3)](_0x37dab9(0x1c8)+_0x1c07d8),await this[_0x37dab9(0x1c1)][_0x37dab9(0x196)]();throw _0x1c07d8;}}async[a180_0x4c36a5(0x178)](_0x45d2c2,_0x204bd2){const _0x3ffd31=a180_0x4c36a5;var _0x2a10b1,_0x521030;this['sfLogger']=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x204bd2[_0x3ffd31(0x1a1)](),_0x204bd2[_0x3ffd31(0x17b)]()+'\x20['+commit_components_dto_1['CommitComponentsDto'][_0x3ffd31(0x1cf)]+']');const _0x53946d=!!((_0x2a10b1=_0x45d2c2[_0x3ffd31(0x1ed)])===null||_0x2a10b1===void 0x0?void 0x0:_0x2a10b1[_0x3ffd31(0x1b9)])||!!((_0x521030=_0x45d2c2[_0x3ffd31(0x1ed)])===null||_0x521030===void 0x0?void 0x0:_0x521030[_0x3ffd31(0x1eb)]);if(!_0x53946d){this['sfLogger'][_0x3ffd31(0x1e3)](_0x3ffd31(0x194)),await this[_0x3ffd31(0x1c1)][_0x3ffd31(0x196)]();return;}this['commitData']=_0x45d2c2,await this['exec']();}};CommitComponentsJob=__decorate([typedi_1[a180_0x4c36a5(0x1c6)]({'transient':!![]}),__metadata(a180_0x4c36a5(0x187),[auth_settings_service_1[a180_0x4c36a5(0x1c4)]])],CommitComponentsJob),exports[a180_0x4c36a5(0x17f)]=CommitComponentsJob;