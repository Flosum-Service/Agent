const a181_0x4cdccc=a181_0x40b1;(function(_0x4e067c,_0x4839e0){const _0x15d08d=a181_0x40b1,_0x11d6c5=_0x4e067c();while(!![]){try{const _0xbbe708=-parseInt(_0x15d08d(0xff))/0x1+parseInt(_0x15d08d(0x134))/0x2+-parseInt(_0x15d08d(0x139))/0x3+-parseInt(_0x15d08d(0x145))/0x4*(parseInt(_0x15d08d(0x116))/0x5)+parseInt(_0x15d08d(0x102))/0x6*(parseInt(_0x15d08d(0x130))/0x7)+parseInt(_0x15d08d(0x131))/0x8+parseInt(_0x15d08d(0x12f))/0x9;if(_0xbbe708===_0x4839e0)break;else _0x11d6c5['push'](_0x11d6c5['shift']());}catch(_0x4593d0){_0x11d6c5['push'](_0x11d6c5['shift']());}}}(a181_0x1090,0x5b4a3));const a181_0x944027=(function(){let _0x5c1cb=!![];return function(_0x51b107,_0x139fc7){const _0x251b52=_0x5c1cb?function(){const _0x500256=a181_0x40b1;if(_0x139fc7){const _0x59e210=_0x139fc7[_0x500256(0x149)](_0x51b107,arguments);return _0x139fc7=null,_0x59e210;}}:function(){};return _0x5c1cb=![],_0x251b52;};}()),a181_0x4e69f5=a181_0x944027(this,function(){const _0x2c5a0c=a181_0x40b1;return a181_0x4e69f5[_0x2c5a0c(0x155)]()['search'](_0x2c5a0c(0x128))[_0x2c5a0c(0x155)]()[_0x2c5a0c(0x12b)](a181_0x4e69f5)['search'](_0x2c5a0c(0x128));});a181_0x4e69f5();'use strict';var __createBinding=this&&this[a181_0x4cdccc(0x144)]||(Object[a181_0x4cdccc(0x11d)]?function(_0x3538a8,_0x435baf,_0x40f861,_0x4d2ca6){const _0x19af0a=a181_0x4cdccc;if(_0x4d2ca6===undefined)_0x4d2ca6=_0x40f861;Object[_0x19af0a(0x100)](_0x3538a8,_0x4d2ca6,{'enumerable':!![],'get':function(){return _0x435baf[_0x40f861];}});}:function(_0xc84a30,_0x397857,_0xcd456,_0x1830cb){if(_0x1830cb===undefined)_0x1830cb=_0xcd456;_0xc84a30[_0x1830cb]=_0x397857[_0xcd456];}),__setModuleDefault=this&&this[a181_0x4cdccc(0x104)]||(Object[a181_0x4cdccc(0x11d)]?function(_0x136f86,_0x408830){const _0x2ef306=a181_0x4cdccc;Object[_0x2ef306(0x100)](_0x136f86,_0x2ef306(0x11c),{'enumerable':!![],'value':_0x408830});}:function(_0x43d71e,_0x2bdef8){const _0x2a12ff=a181_0x4cdccc;_0x43d71e[_0x2a12ff(0x11c)]=_0x2bdef8;}),__decorate=this&&this[a181_0x4cdccc(0xf8)]||function(_0x51188c,_0x270f2a,_0x53b464,_0x3aede5){const _0x271c66=a181_0x4cdccc;var _0x12f55f=arguments['length'],_0x385946=_0x12f55f<0x3?_0x270f2a:_0x3aede5===null?_0x3aede5=Object['getOwnPropertyDescriptor'](_0x270f2a,_0x53b464):_0x3aede5,_0x4431e9;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x385946=Reflect[_0x271c66(0x152)](_0x51188c,_0x270f2a,_0x53b464,_0x3aede5);else{for(var _0x4bfdbd=_0x51188c[_0x271c66(0xf0)]-0x1;_0x4bfdbd>=0x0;_0x4bfdbd--)if(_0x4431e9=_0x51188c[_0x4bfdbd])_0x385946=(_0x12f55f<0x3?_0x4431e9(_0x385946):_0x12f55f>0x3?_0x4431e9(_0x270f2a,_0x53b464,_0x385946):_0x4431e9(_0x270f2a,_0x53b464))||_0x385946;}return _0x12f55f>0x3&&_0x385946&&Object['defineProperty'](_0x270f2a,_0x53b464,_0x385946),_0x385946;},__importStar=this&&this[a181_0x4cdccc(0x10b)]||function(_0xafca4a){const _0x503888=a181_0x4cdccc;if(_0xafca4a&&_0xafca4a[_0x503888(0x11e)])return _0xafca4a;var _0x9e8f59={};if(_0xafca4a!=null){for(var _0x5b815b in _0xafca4a)if(_0x5b815b!==_0x503888(0x11c)&&Object[_0x503888(0xfd)][_0x503888(0x109)][_0x503888(0x10d)](_0xafca4a,_0x5b815b))__createBinding(_0x9e8f59,_0xafca4a,_0x5b815b);}return __setModuleDefault(_0x9e8f59,_0xafca4a),_0x9e8f59;},__metadata=this&&this[a181_0x4cdccc(0xea)]||function(_0x2ed290,_0x3bc2c6){const _0xa2cb8b=a181_0x4cdccc;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0xa2cb8b(0x148))return Reflect['metadata'](_0x2ed290,_0x3bc2c6);},__importDefault=this&&this[a181_0x4cdccc(0x14c)]||function(_0x1dfd26){const _0x4c21f8=a181_0x4cdccc;return _0x1dfd26&&_0x1dfd26[_0x4c21f8(0x11e)]?_0x1dfd26:{'default':_0x1dfd26};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a181_0x4cdccc(0x113)]=void 0x0;const auth_settings_service_1=require('../../shared/services/auth-settings.service'),commit_components_dto_1=require(a181_0x4cdccc(0x142)),events_1=__importDefault(require('events')),git_utils_1=require(a181_0x4cdccc(0x13f)),mdapi_utils_1=require(a181_0x4cdccc(0xed)),sfdx_utils_1=require(a181_0x4cdccc(0x10f)),typedi_1=__importStar(require(a181_0x4cdccc(0x154))),child_types_1=__importDefault(require(a181_0x4cdccc(0x11a))),utils_1=require('../../shared/utils'),salesforce_logger_v2_service_1=require(a181_0x4cdccc(0x12c)),constants_1=require(a181_0x4cdccc(0xf1)),bitbucket_api_service_1=require(a181_0x4cdccc(0xeb)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a181_0x4cdccc(0xf5)),path_1=require(a181_0x4cdccc(0x110));function a181_0x40b1(_0x11d3cc,_0x446b53){const _0x55f2ae=a181_0x1090();return a181_0x40b1=function(_0x4e69f5,_0x944027){_0x4e69f5=_0x4e69f5-0xe8;let _0x10905f=_0x55f2ae[_0x4e69f5];return _0x10905f;},a181_0x40b1(_0x11d3cc,_0x446b53);}let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x4cdccc(0x11c)]{constructor(_0x23242f){const _0x4a0d77=a181_0x4cdccc;super(),this[_0x4a0d77(0x122)]=_0x23242f,this['COMPONENTS_PER_TICK']=0x3e8,this[_0x4a0d77(0x10a)]=0x0,this[_0x4a0d77(0x119)]=0x0,this[_0x4a0d77(0x120)]=Date[_0x4a0d77(0x127)]();}async['getRemote'](){const _0x556dd6=a181_0x4cdccc,{repo:_0x37e734}=this[_0x556dd6(0x115)];let _0x162561=this[_0x556dd6(0x122)][_0x556dd6(0xe8)](this[_0x556dd6(0x115)]['provider']);if(this[_0x556dd6(0x115)][_0x556dd6(0x11f)]===_0x556dd6(0x14f)){const _0xd98892=typedi_1[_0x556dd6(0x11c)]['get'](bitbucket_api_service_1[_0x556dd6(0xee)]);await _0xd98892['isLoggedIn'](),_0x162561+=encodeURIComponent(_0xd98892[_0x556dd6(0x118)]());}return _0x37e734[_0x556dd6(0x141)][_0x556dd6(0x150)](/http(s)?\:\/\/(.+@)?/,utils_1['getProtocol'](_0x37e734[_0x556dd6(0x141)])+_0x556dd6(0xe9)+_0x162561+'@');}[a181_0x4cdccc(0x140)](_0x2fb671){const _0x36d3ed=a181_0x4cdccc;var _0x2c03ed;_0x2fb671[_0x36d3ed(0x10e)](_0x8c17f4=>child_types_1['default'][_0x36d3ed(0x153)](_0x8c17f4['fileType'])?0x1:-0x1);const _0x3c5d86={};for(const _0xf4c5f3 of _0x2fb671){_0x3c5d86[_0x2c03ed=_0xf4c5f3['fileName']]||(_0x3c5d86[_0x2c03ed]=[]),_0x3c5d86[_0xf4c5f3['fileName']]['push'](_0xf4c5f3);}return Object[_0x36d3ed(0x14e)](_0x3c5d86)[_0x36d3ed(0x135)]((_0x5480a5,_0xef458a)=>[..._0x5480a5,..._0xef458a],[]);}async[a181_0x4cdccc(0x106)](_0x2a74a3){const _0x3a1be7=a181_0x4cdccc;_0x2a74a3=this[_0x3a1be7(0x140)](_0x2a74a3);let _0x5f2cea=0x0;while(_0x2a74a3[_0x3a1be7(0xf0)]){const _0x101f89=_0x2a74a3['splice'](0x0,this[_0x3a1be7(0x14b)]);await this[_0x3a1be7(0x151)][_0x3a1be7(0x143)](_0x101f89,{'skipChildErrors':this[_0x3a1be7(0x115)][_0x3a1be7(0xf9)][_0x3a1be7(0xfe)]==='master'}),_0x5f2cea+=_0x101f89[_0x3a1be7(0xf0)],this[_0x3a1be7(0xef)]['log'](_0x3a1be7(0x105)+_0x5f2cea+'/'+this[_0x3a1be7(0x10a)]+_0x3a1be7(0xf3)),await this[_0x3a1be7(0xef)][_0x3a1be7(0x13e)]();}}async['removeComponents'](_0x5bb78a){const _0x1c90a4=a181_0x4cdccc;_0x5bb78a['sort'](_0x20984e=>child_types_1[_0x1c90a4(0x11c)]['includes'](_0x20984e[_0x1c90a4(0x156)])?-0x1:0x1);let _0x38ee13=0x0;while(_0x5bb78a['length']){const _0xa7f890=_0x5bb78a[_0x1c90a4(0x13a)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x1c90a4(0x151)][_0x1c90a4(0x111)](_0xa7f890),_0x38ee13+=_0xa7f890[_0x1c90a4(0xf0)],this[_0x1c90a4(0xef)]['log'](_0x1c90a4(0xfa)+_0x38ee13+'/'+this[_0x1c90a4(0x119)]+_0x1c90a4(0xf3)),await this[_0x1c90a4(0xef)][_0x1c90a4(0x13e)]();}}async[a181_0x4cdccc(0x133)](){const _0x1ceb7e=a181_0x4cdccc;this['gitUtils']&&await this['gitUtils'][_0x1ceb7e(0x107)]()[_0x1ceb7e(0xf7)](()=>void 0x0),this[_0x1ceb7e(0x151)]&&await this[_0x1ceb7e(0x151)]['removeDir']()[_0x1ceb7e(0xf7)](()=>void 0x0),this['sfdxUtils']&&await this['sfdxUtils'][_0x1ceb7e(0x107)]()[_0x1ceb7e(0xf7)](()=>void 0x0);}async['exec'](){const _0x4b84fc=a181_0x4cdccc,{repo:_0x535cf4,branch:_0x2b5b15,components:_0x3b1c95,convertToSFDX:_0x5c032f,message:_0xa4602,user:_0xaba84a}=this[_0x4b84fc(0x115)];this[_0x4b84fc(0x151)]=new mdapi_utils_1[(_0x4b84fc(0xec))](_0x535cf4[_0x4b84fc(0xfe)],_0x2b5b15[_0x4b84fc(0xfe)]),this[_0x4b84fc(0x132)]=new git_utils_1[(_0x4b84fc(0x103))](await this['getRemote']()),this['sfdxUtils']=new sfdx_utils_1[(_0x4b84fc(0x13d))](_0x535cf4[_0x4b84fc(0xfe)],_0x2b5b15['name']);let _0x3a0d8d=_0x5c032f;try{this[_0x4b84fc(0xef)]['log'](_0x4b84fc(0x147)),await this[_0x4b84fc(0x132)]['clone'](_0x2b5b15[_0x4b84fc(0xfe)],_0x535cf4[_0x4b84fc(0xfe)]);!this[_0x4b84fc(0x115)][_0x4b84fc(0x146)]?(this['sfLogger'][_0x4b84fc(0x125)](_0x4b84fc(0xfc)),await this[_0x4b84fc(0x151)][_0x4b84fc(0x121)](this[_0x4b84fc(0x132)][_0x4b84fc(0x137)])):this[_0x4b84fc(0xef)][_0x4b84fc(0x125)](_0x4b84fc(0x14d));_0x3b1c95['writed']&&(this['sfLogger'][_0x4b84fc(0x125)](_0x4b84fc(0xfb)),this['componentsToWrite']=_0x3b1c95[_0x4b84fc(0x13c)]['length'],await this[_0x4b84fc(0x106)](_0x3b1c95[_0x4b84fc(0x13c)]),await this[_0x4b84fc(0xef)][_0x4b84fc(0x13e)]());_0x3b1c95[_0x4b84fc(0x129)]&&(this[_0x4b84fc(0xef)]['log'](_0x4b84fc(0x108)),this[_0x4b84fc(0x119)]=_0x3b1c95[_0x4b84fc(0x129)][_0x4b84fc(0xf0)],await this[_0x4b84fc(0x111)](_0x3b1c95[_0x4b84fc(0x129)]),await this[_0x4b84fc(0xef)][_0x4b84fc(0x13e)]());await this[_0x4b84fc(0xef)][_0x4b84fc(0x13e)]();await sfdx_utils_2[_0x4b84fc(0xf6)][_0x4b84fc(0x114)](this[_0x4b84fc(0x132)][_0x4b84fc(0x137)])?(_0x3a0d8d=!![],await fs_internal_1['FS']['removeDir'](path_1[_0x4b84fc(0x123)](this[_0x4b84fc(0x132)][_0x4b84fc(0x137)],'force-app'))):(_0x3a0d8d&&(!await fs_internal_1['FS']['isEmptyDir'](this['gitUtils'][_0x4b84fc(0x137)])&&(_0x3a0d8d=![])),await this[_0x4b84fc(0x132)][_0x4b84fc(0xf2)]());_0x3a0d8d?(this[_0x4b84fc(0xef)]['log']('[INFO]\x20Start\x20converting\x20to\x20SFDX'),await this[_0x4b84fc(0x12a)]['createProjectFrom'](this[_0x4b84fc(0x151)][_0x4b84fc(0x137)]),await this['sfdxUtils'][_0x4b84fc(0x138)](this[_0x4b84fc(0x132)]['dir']),await this[_0x4b84fc(0x12a)][_0x4b84fc(0x107)](),await this[_0x4b84fc(0xef)][_0x4b84fc(0x13e)]()):(this[_0x4b84fc(0xef)][_0x4b84fc(0x125)](_0x4b84fc(0x126)),await this['mdapiUtils'][_0x4b84fc(0x11b)](this[_0x4b84fc(0x132)][_0x4b84fc(0x137)]),await this[_0x4b84fc(0xef)][_0x4b84fc(0x13e)]());this[_0x4b84fc(0xef)]['log']('[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git'),await this[_0x4b84fc(0x132)][_0x4b84fc(0x112)](_0xa4602,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0xaba84a['name']},_0x2b5b15['name']),await this[_0x4b84fc(0x132)][_0x4b84fc(0x107)](),await this[_0x4b84fc(0x151)][_0x4b84fc(0x107)]();const _0x47734e=this[_0x4b84fc(0x10a)]+this[_0x4b84fc(0x119)];this[_0x4b84fc(0xef)][_0x4b84fc(0x125)](_0x4b84fc(0x14a)+(Date['now']()-this['startTime'])+_0x4b84fc(0x101)+_0x47734e),await this[_0x4b84fc(0xef)][_0x4b84fc(0x13e)]();}catch(_0x2ed60d){await this[_0x4b84fc(0x133)](),this[_0x4b84fc(0xef)][_0x4b84fc(0x125)](_0x4b84fc(0xf4)+_0x2ed60d),await this['sfLogger'][_0x4b84fc(0x13e)]();throw _0x2ed60d;}}async['run'](_0x38d312,_0x379a29){const _0x3d27f4=a181_0x4cdccc;var _0x3a9453,_0x94ef11;this['sfLogger']=new salesforce_logger_v2_service_1[(_0x3d27f4(0x10c))](_0x379a29[_0x3d27f4(0x12e)](),_0x379a29[_0x3d27f4(0x136)]()+'\x20['+commit_components_dto_1[_0x3d27f4(0x117)][_0x3d27f4(0xfe)]+']');const _0x542b79=!!((_0x3a9453=_0x38d312['components'])===null||_0x3a9453===void 0x0?void 0x0:_0x3a9453[_0x3d27f4(0x13c)])||!!((_0x94ef11=_0x38d312[_0x3d27f4(0x124)])===null||_0x94ef11===void 0x0?void 0x0:_0x94ef11[_0x3d27f4(0x129)]);if(!_0x542b79){this[_0x3d27f4(0xef)][_0x3d27f4(0x125)](_0x3d27f4(0x12d)),await this[_0x3d27f4(0xef)]['send']();return;}this[_0x3d27f4(0x115)]=_0x38d312,await this['exec']();}};CommitComponentsJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a181_0x4cdccc(0x13b),[auth_settings_service_1['AuthSettingsService']])],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;function a181_0x1090(){const _0x5e0d7d=['__metadata','../../git-api/services/bitbucket-api.service','MDApiUtils','../utils/mdapi.utils','BitbucketApiService','sfLogger','length','../../../constants','clearDir','\x20components','[ERROR]\x20','../../internal/fs.internal','SFDX','catch','__decorate','branch','[INFO]\x20Deleted\x20','[INFO]\x20Preparing\x20to\x20write\x20components','[INFO]\x20Prepare\x20mdapi\x20files','prototype','name','634961WgfUzX','defineProperty','ms.\x20Committed\x20components\x20-\x20','24078xIMYLt','GitUtils','__setModuleDefault','[INFO]\x20Wrote\x20','writeComponents','removeDir','[INFO]\x20Preparing\x20to\x20delete\x20components','hasOwnProperty','componentsToWrite','__importStar','SalesforceLogger2','call','sort','../utils/sfdx.utils','path','removeComponents','commitAndPush','CommitComponentsJob','isSFDXProject','commitData','1255MiImhh','CommitComponentsDto','getAccessToken','componentsToDelete','../../parsers/data/child-types','copyMdapiTo','default','create','__esModule','provider','startTime','prepareMdapi','authSettings','join','components','log','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','now','(((.+)+)+)+$','deleted','sfdxUtils','constructor','../../salesforce/services/salesforce-logger-v2.service','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','getLoggerId','9433251UXfkju','287LSbsnC','3559520dFZNSR','gitUtils','cleanUp','122122zpTdhF','reduce','getPrefix','dir','copyProjectTo','1282995UXjNYM','splice','design:paramtypes','writed','SFDXUtils','send','../utils/git.utils','groupComponentsByFileName','gitUrl','../dto/commit-components.dto','writeFlosumComponents','__createBinding','4496ZZEdRO','force','[INFO]\x20Start\x20clonning\x20repository','function','apply','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','COMPONENTS_PER_TICK','__importDefault','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','values','bitbucket','replace','mdapiUtils','decorate','includes','typedi','toString','type','getCredentialsFor','://'];a181_0x1090=function(){return _0x5e0d7d;};return a181_0x1090();}