const a181_0x218f63=a181_0x9214;(function(_0x18fa7f,_0x5bf7e0){const _0x23e751=a181_0x9214,_0x3b1c61=_0x18fa7f();while(!![]){try{const _0x413f67=-parseInt(_0x23e751(0x1be))/0x1*(-parseInt(_0x23e751(0x1ba))/0x2)+parseInt(_0x23e751(0x184))/0x3+-parseInt(_0x23e751(0x18f))/0x4*(-parseInt(_0x23e751(0x189))/0x5)+parseInt(_0x23e751(0x199))/0x6+parseInt(_0x23e751(0x1b5))/0x7+parseInt(_0x23e751(0x17b))/0x8+-parseInt(_0x23e751(0x18b))/0x9;if(_0x413f67===_0x5bf7e0)break;else _0x3b1c61['push'](_0x3b1c61['shift']());}catch(_0x56853d){_0x3b1c61['push'](_0x3b1c61['shift']());}}}(a181_0x214c,0x9f6bb));const a181_0x4ff871=(function(){let _0x1f7327=!![];return function(_0x10f23e,_0x151637){const _0x6392c1=_0x1f7327?function(){const _0x272231=a181_0x9214;if(_0x151637){const _0x3a44b0=_0x151637[_0x272231(0x1a4)](_0x10f23e,arguments);return _0x151637=null,_0x3a44b0;}}:function(){};return _0x1f7327=![],_0x6392c1;};}()),a181_0x104a2a=a181_0x4ff871(this,function(){const _0x293315=a181_0x9214;return a181_0x104a2a[_0x293315(0x1cb)]()[_0x293315(0x177)](_0x293315(0x1aa))['toString']()['constructor'](a181_0x104a2a)['search'](_0x293315(0x1aa));});a181_0x104a2a();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x552932,_0x364012,_0x5413bf,_0x402099){const _0x194646=a181_0x9214;if(_0x402099===undefined)_0x402099=_0x5413bf;Object[_0x194646(0x165)](_0x552932,_0x402099,{'enumerable':!![],'get':function(){return _0x364012[_0x5413bf];}});}:function(_0x2d5e36,_0x34f463,_0x4b7740,_0x380660){if(_0x380660===undefined)_0x380660=_0x4b7740;_0x2d5e36[_0x380660]=_0x34f463[_0x4b7740];}),__setModuleDefault=this&&this[a181_0x218f63(0x19c)]||(Object[a181_0x218f63(0x1c1)]?function(_0x3447ee,_0x2dd74a){const _0x77c1b8=a181_0x218f63;Object[_0x77c1b8(0x165)](_0x3447ee,'default',{'enumerable':!![],'value':_0x2dd74a});}:function(_0x4f57b4,_0x43a011){const _0x36c940=a181_0x218f63;_0x4f57b4[_0x36c940(0x16e)]=_0x43a011;}),__decorate=this&&this[a181_0x218f63(0x1a6)]||function(_0x15a12e,_0x50b9d9,_0x29f052,_0x36ebdd){const _0xbd5f33=a181_0x218f63;var _0x16bf4a=arguments[_0xbd5f33(0x1b2)],_0x36fd65=_0x16bf4a<0x3?_0x50b9d9:_0x36ebdd===null?_0x36ebdd=Object[_0xbd5f33(0x1cd)](_0x50b9d9,_0x29f052):_0x36ebdd,_0x29c5ac;if(typeof Reflect===_0xbd5f33(0x1b3)&&typeof Reflect[_0xbd5f33(0x19e)]===_0xbd5f33(0x1bf))_0x36fd65=Reflect[_0xbd5f33(0x19e)](_0x15a12e,_0x50b9d9,_0x29f052,_0x36ebdd);else{for(var _0x17ffdd=_0x15a12e[_0xbd5f33(0x1b2)]-0x1;_0x17ffdd>=0x0;_0x17ffdd--)if(_0x29c5ac=_0x15a12e[_0x17ffdd])_0x36fd65=(_0x16bf4a<0x3?_0x29c5ac(_0x36fd65):_0x16bf4a>0x3?_0x29c5ac(_0x50b9d9,_0x29f052,_0x36fd65):_0x29c5ac(_0x50b9d9,_0x29f052))||_0x36fd65;}return _0x16bf4a>0x3&&_0x36fd65&&Object[_0xbd5f33(0x165)](_0x50b9d9,_0x29f052,_0x36fd65),_0x36fd65;},__importStar=this&&this[a181_0x218f63(0x1c6)]||function(_0x1334bd){const _0x3f92aa=a181_0x218f63;if(_0x1334bd&&_0x1334bd[_0x3f92aa(0x1c3)])return _0x1334bd;var _0x3c0cc1={};if(_0x1334bd!=null){for(var _0x1960e0 in _0x1334bd)if(_0x1960e0!==_0x3f92aa(0x16e)&&Object['prototype']['hasOwnProperty'][_0x3f92aa(0x166)](_0x1334bd,_0x1960e0))__createBinding(_0x3c0cc1,_0x1334bd,_0x1960e0);}return __setModuleDefault(_0x3c0cc1,_0x1334bd),_0x3c0cc1;},__metadata=this&&this[a181_0x218f63(0x181)]||function(_0x443bb1,_0x93358d){const _0x219433=a181_0x218f63;if(typeof Reflect===_0x219433(0x1b3)&&typeof Reflect[_0x219433(0x1a8)]==='function')return Reflect[_0x219433(0x1a8)](_0x443bb1,_0x93358d);},__importDefault=this&&this['__importDefault']||function(_0x332ece){return _0x332ece&&_0x332ece['__esModule']?_0x332ece:{'default':_0x332ece};};Object['defineProperty'](exports,a181_0x218f63(0x1c3),{'value':!![]}),exports[a181_0x218f63(0x1c8)]=void 0x0;function a181_0x9214(_0x4d0156,_0x5c7e0a){const _0x1762b1=a181_0x214c();return a181_0x9214=function(_0x104a2a,_0x4ff871){_0x104a2a=_0x104a2a-0x163;let _0x214c0a=_0x1762b1[_0x104a2a];return _0x214c0a;},a181_0x9214(_0x4d0156,_0x5c7e0a);}const auth_settings_service_1=require(a181_0x218f63(0x16f)),commit_components_dto_1=require(a181_0x218f63(0x1b7)),events_1=__importDefault(require(a181_0x218f63(0x17a))),git_utils_1=require(a181_0x218f63(0x1c9)),mdapi_utils_1=require(a181_0x218f63(0x19f)),sfdx_utils_1=require(a181_0x218f63(0x1c0)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a181_0x218f63(0x1c5))),utils_1=require(a181_0x218f63(0x1c7)),salesforce_logger_v2_service_1=require(a181_0x218f63(0x194)),constants_1=require(a181_0x218f63(0x167)),bitbucket_api_service_1=require(a181_0x218f63(0x1b0)),sfdx_utils_2=require(a181_0x218f63(0x190)),fs_internal_1=require(a181_0x218f63(0x19b)),path_1=require(a181_0x218f63(0x1a5));let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(_0x37c157){const _0x46a137=a181_0x218f63;super(),this[_0x46a137(0x170)]=_0x37c157,this[_0x46a137(0x1a0)]=0x3e8,this[_0x46a137(0x179)]=0x0,this[_0x46a137(0x1bb)]=0x0,this[_0x46a137(0x1d2)]=Date[_0x46a137(0x186)]();}async[a181_0x218f63(0x1ad)](){const _0x295080=a181_0x218f63,{repo:_0x47d343}=this['commitData'];let _0x99437a=this[_0x295080(0x170)]['getCredentialsFor'](this[_0x295080(0x1c4)][_0x295080(0x19a)]);if(this[_0x295080(0x1c4)][_0x295080(0x19a)]===_0x295080(0x16a)){const _0x3d0a8c=typedi_1[_0x295080(0x16e)]['get'](bitbucket_api_service_1[_0x295080(0x168)]);await _0x3d0a8c['isLoggedIn'](),_0x99437a+=encodeURIComponent(_0x3d0a8c[_0x295080(0x18a)]());}return _0x47d343[_0x295080(0x1a7)]['replace'](/http(s)?\:\/\/(.+@)?/,utils_1[_0x295080(0x1d4)](_0x47d343[_0x295080(0x1a7)])+'://'+_0x99437a+'@');}['groupComponentsByFileName'](_0x3eb292){const _0x5a6571=a181_0x218f63;var _0x2f0f20;_0x3eb292[_0x5a6571(0x193)](_0x338275=>child_types_1['default'][_0x5a6571(0x192)](_0x338275[_0x5a6571(0x197)])?0x1:-0x1);const _0x51da90={};for(const _0x55e6e6 of _0x3eb292){_0x51da90[_0x2f0f20=_0x55e6e6[_0x5a6571(0x187)]]||(_0x51da90[_0x2f0f20]=[]),_0x51da90[_0x55e6e6[_0x5a6571(0x187)]][_0x5a6571(0x1cf)](_0x55e6e6);}return Object[_0x5a6571(0x1d7)](_0x51da90)[_0x5a6571(0x1b9)]((_0x31c937,_0x24748a)=>[..._0x31c937,..._0x24748a],[]);}async[a181_0x218f63(0x1b6)](_0x364896){const _0x4ed4fd=a181_0x218f63;_0x364896=this[_0x4ed4fd(0x1ce)](_0x364896);let _0x5c348a=0x0;while(_0x364896['length']){const _0x5dd77b=_0x364896['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x4ed4fd(0x1af)][_0x4ed4fd(0x18c)](_0x5dd77b,{'skipChildErrors':this[_0x4ed4fd(0x1c4)][_0x4ed4fd(0x185)]['name']===_0x4ed4fd(0x175)}),_0x5c348a+=_0x5dd77b[_0x4ed4fd(0x1b2)],this['sfLogger']['log'](_0x4ed4fd(0x17c)+_0x5c348a+'/'+this[_0x4ed4fd(0x179)]+_0x4ed4fd(0x198)),await this[_0x4ed4fd(0x1ae)][_0x4ed4fd(0x191)]();}}async['removeComponents'](_0x4a930c){const _0x6b6df=a181_0x218f63;_0x4a930c[_0x6b6df(0x193)](_0x3c18ab=>child_types_1[_0x6b6df(0x16e)][_0x6b6df(0x192)](_0x3c18ab[_0x6b6df(0x1ab)])?-0x1:0x1);let _0x1a55d2=0x0;while(_0x4a930c[_0x6b6df(0x1b2)]){const _0x5a9911=_0x4a930c['splice'](0x0,this[_0x6b6df(0x1a0)]);await this[_0x6b6df(0x1af)][_0x6b6df(0x16b)](_0x5a9911),_0x1a55d2+=_0x5a9911[_0x6b6df(0x1b2)],this[_0x6b6df(0x1ae)]['log'](_0x6b6df(0x196)+_0x1a55d2+'/'+this[_0x6b6df(0x1bb)]+_0x6b6df(0x198)),await this[_0x6b6df(0x1ae)][_0x6b6df(0x191)]();}}async[a181_0x218f63(0x1d0)](){const _0x2aca0f=a181_0x218f63;this['gitUtils']&&await this[_0x2aca0f(0x164)][_0x2aca0f(0x188)]()[_0x2aca0f(0x1bc)](()=>void 0x0),this[_0x2aca0f(0x1af)]&&await this[_0x2aca0f(0x1af)][_0x2aca0f(0x188)]()['catch'](()=>void 0x0),this[_0x2aca0f(0x1bd)]&&await this[_0x2aca0f(0x1bd)][_0x2aca0f(0x188)]()[_0x2aca0f(0x1bc)](()=>void 0x0);}async['exec'](){const _0x1d2995=a181_0x218f63,{repo:_0x19e618,branch:_0x465175,components:_0x20d7cf,convertToSFDX:_0x429707,message:_0x560726,user:_0x204753}=this['commitData'];this['mdapiUtils']=new mdapi_utils_1[(_0x1d2995(0x173))](_0x19e618[_0x1d2995(0x182)],_0x465175[_0x1d2995(0x182)]),this['gitUtils']=new git_utils_1[(_0x1d2995(0x17e))](await this[_0x1d2995(0x1ad)]()),this[_0x1d2995(0x1bd)]=new sfdx_utils_1[(_0x1d2995(0x1b1))](_0x19e618[_0x1d2995(0x182)],_0x465175[_0x1d2995(0x182)]);let _0x2a7011=_0x429707;try{this[_0x1d2995(0x1ae)]['log']('[INFO]\x20Start\x20clonning\x20repository'),await this[_0x1d2995(0x164)][_0x1d2995(0x1a2)](_0x465175['name'],_0x19e618[_0x1d2995(0x182)]);!this[_0x1d2995(0x1c4)][_0x1d2995(0x1b8)]?(this['sfLogger'][_0x1d2995(0x1d6)]('[INFO]\x20Prepare\x20mdapi\x20files'),await this[_0x1d2995(0x1af)][_0x1d2995(0x172)](this['gitUtils']['dir'])):this[_0x1d2995(0x1ae)]['log']('[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');_0x20d7cf[_0x1d2995(0x17d)]&&(this['sfLogger'][_0x1d2995(0x1d6)](_0x1d2995(0x19d)),this['componentsToWrite']=_0x20d7cf[_0x1d2995(0x17d)]['length'],await this[_0x1d2995(0x1b6)](_0x20d7cf[_0x1d2995(0x17d)]),await this['sfLogger'][_0x1d2995(0x191)]());_0x20d7cf[_0x1d2995(0x183)]&&(this[_0x1d2995(0x1ae)]['log'](_0x1d2995(0x171)),this[_0x1d2995(0x1bb)]=_0x20d7cf[_0x1d2995(0x183)]['length'],await this[_0x1d2995(0x16b)](_0x20d7cf['deleted']),await this[_0x1d2995(0x1ae)]['send']());await this[_0x1d2995(0x1ae)]['send']();await sfdx_utils_2[_0x1d2995(0x1ac)][_0x1d2995(0x195)](this['gitUtils'][_0x1d2995(0x1d5)])?(_0x2a7011=!![],await fs_internal_1['FS'][_0x1d2995(0x188)](path_1['join'](this[_0x1d2995(0x164)][_0x1d2995(0x1d5)],'force-app'))):(_0x2a7011&&(!await fs_internal_1['FS'][_0x1d2995(0x16c)](this[_0x1d2995(0x164)][_0x1d2995(0x1d5)])&&(_0x2a7011=![])),await this['gitUtils']['clearDir']());_0x2a7011?(this[_0x1d2995(0x1ae)][_0x1d2995(0x1d6)]('[INFO]\x20Start\x20converting\x20to\x20SFDX'),await this['sfdxUtils'][_0x1d2995(0x174)](this[_0x1d2995(0x1af)][_0x1d2995(0x1d5)]),await this[_0x1d2995(0x1bd)][_0x1d2995(0x176)](this[_0x1d2995(0x164)][_0x1d2995(0x1d5)]),await this[_0x1d2995(0x1bd)][_0x1d2995(0x188)](),await this[_0x1d2995(0x1ae)][_0x1d2995(0x191)]()):(this[_0x1d2995(0x1ae)][_0x1d2995(0x1d6)](_0x1d2995(0x178)),await this[_0x1d2995(0x1af)]['copyMdapiTo'](this['gitUtils']['dir']),await this[_0x1d2995(0x1ae)][_0x1d2995(0x191)]());this[_0x1d2995(0x1ae)]['log'](_0x1d2995(0x17f)),await this[_0x1d2995(0x164)][_0x1d2995(0x163)](_0x560726,{'email':constants_1[_0x1d2995(0x1a1)],'name':_0x204753[_0x1d2995(0x182)]},_0x465175[_0x1d2995(0x182)]),await this[_0x1d2995(0x164)][_0x1d2995(0x188)](),await this[_0x1d2995(0x1af)][_0x1d2995(0x188)]();const _0x192b47=this[_0x1d2995(0x179)]+this[_0x1d2995(0x1bb)];this['sfLogger'][_0x1d2995(0x1d6)](_0x1d2995(0x1d3)+(Date[_0x1d2995(0x186)]()-this[_0x1d2995(0x1d2)])+_0x1d2995(0x169)+_0x192b47),await this[_0x1d2995(0x1ae)][_0x1d2995(0x191)]();}catch(_0x40d098){await this['cleanUp'](),this[_0x1d2995(0x1ae)]['log'](_0x1d2995(0x1b4)+_0x40d098),await this[_0x1d2995(0x1ae)]['send']();throw _0x40d098;}}async['run'](_0x566baf,_0x1c3692){const _0x2e3f70=a181_0x218f63;var _0x4bafac,_0x315757;this[_0x2e3f70(0x1ae)]=new salesforce_logger_v2_service_1[(_0x2e3f70(0x1cc))](_0x1c3692[_0x2e3f70(0x18e)](),_0x1c3692[_0x2e3f70(0x16d)]()+'\x20['+commit_components_dto_1[_0x2e3f70(0x180)][_0x2e3f70(0x182)]+']');const _0x1c8aca=!!((_0x4bafac=_0x566baf[_0x2e3f70(0x1d1)])===null||_0x4bafac===void 0x0?void 0x0:_0x4bafac['writed'])||!!((_0x315757=_0x566baf['components'])===null||_0x315757===void 0x0?void 0x0:_0x315757[_0x2e3f70(0x183)]);if(!_0x1c8aca){this['sfLogger'][_0x2e3f70(0x1d6)](_0x2e3f70(0x1ca)),await this[_0x2e3f70(0x1ae)]['send']();return;}this['commitData']=_0x566baf,await this[_0x2e3f70(0x1a9)]();}};function a181_0x214c(){const _0x261f8c=['MDApiUtils','createProjectFrom','master','copyProjectTo','search','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','componentsToWrite','events','2923168zofSBW','[INFO]\x20Wrote\x20','writed','GitUtils','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','CommitComponentsDto','__metadata','name','deleted','3368922hCUoOA','branch','now','fileName','removeDir','25OxOKlq','getAccessToken','26885241sGkbxM','writeFlosumComponents','AuthSettingsService','getLoggerId','737012EnYNWf','../../salesforce/utils/sfdx.utils','send','includes','sort','../../salesforce/services/salesforce-logger-v2.service','isSFDXProject','[INFO]\x20Deleted\x20','fileType','\x20components','2302956HJmrkL','provider','../../internal/fs.internal','__setModuleDefault','[INFO]\x20Preparing\x20to\x20write\x20components','decorate','../utils/mdapi.utils','COMPONENTS_PER_TICK','DEFAULT_GIT_USER_EMAIL','clone','Service','apply','path','__decorate','gitUrl','metadata','exec','(((.+)+)+)+$','type','SFDX','getRemote','sfLogger','mdapiUtils','../../git-api/services/bitbucket-api.service','SFDXUtils','length','object','[ERROR]\x20','5389097kqMUZK','writeComponents','../dto/commit-components.dto','force','reduce','8iTThty','componentsToDelete','catch','sfdxUtils','19226pMhrwE','function','../utils/sfdx.utils','create','design:paramtypes','__esModule','commitData','../../parsers/data/child-types','__importStar','../../shared/utils','CommitComponentsJob','../utils/git.utils','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','toString','SalesforceLogger2','getOwnPropertyDescriptor','groupComponentsByFileName','push','cleanUp','components','startTime','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','getProtocol','dir','log','values','commitAndPush','gitUtils','defineProperty','call','../../../constants','BitbucketApiService','ms.\x20Committed\x20components\x20-\x20','bitbucket','removeComponents','isEmptyDir','getPrefix','default','../../shared/services/auth-settings.service','authSettings','[INFO]\x20Preparing\x20to\x20delete\x20components','prepareMdapi'];a181_0x214c=function(){return _0x261f8c;};return a181_0x214c();}CommitComponentsJob=__decorate([typedi_1[a181_0x218f63(0x1a3)]({'transient':!![]}),__metadata(a181_0x218f63(0x1c2),[auth_settings_service_1[a181_0x218f63(0x18d)]])],CommitComponentsJob),exports[a181_0x218f63(0x1c8)]=CommitComponentsJob;