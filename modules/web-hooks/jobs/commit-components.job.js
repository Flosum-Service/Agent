const a181_0x2fb3d0=a181_0x3b6b;(function(_0x4d97f5,_0x2ef474){const _0x50d24f=a181_0x3b6b,_0x46f6a9=_0x4d97f5();while(!![]){try{const _0x43f401=-parseInt(_0x50d24f(0x14d))/0x1*(parseInt(_0x50d24f(0x140))/0x2)+-parseInt(_0x50d24f(0x14a))/0x3+parseInt(_0x50d24f(0x135))/0x4*(parseInt(_0x50d24f(0x13f))/0x5)+-parseInt(_0x50d24f(0x120))/0x6*(-parseInt(_0x50d24f(0x16d))/0x7)+parseInt(_0x50d24f(0x132))/0x8*(parseInt(_0x50d24f(0x141))/0x9)+-parseInt(_0x50d24f(0x16e))/0xa*(-parseInt(_0x50d24f(0x136))/0xb)+-parseInt(_0x50d24f(0x18d))/0xc*(-parseInt(_0x50d24f(0x15c))/0xd);if(_0x43f401===_0x2ef474)break;else _0x46f6a9['push'](_0x46f6a9['shift']());}catch(_0xe8e2f7){_0x46f6a9['push'](_0x46f6a9['shift']());}}}(a181_0x49d6,0xa14b4));function a181_0x49d6(){const _0x6046a9=['constructor','clone','decorate','MDApiUtils','reduce','AuthSettingsService','copyProjectTo','get','getLoggerId','master','__metadata','SFDXUtils','length','2675959BsobUB','push','type','\x20components','metadata','sfdxUtils','mdapiUtils','[INFO]\x20Wrote\x20','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','exec','branch','__setModuleDefault','copyMdapiTo','writeFlosumComponents','removeComponents','design:paramtypes','join','7XWzZSC','10NcKLfN','gitUtils','writed','getRemote','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','removeDir','provider','getCredentialsFor','now','search','deleted','includes','defineProperty','__importStar','gitUrl','clearDir','componentsToDelete','cleanUp','name','commitAndPush','create','dir','groupComponentsByFileName','log','[INFO]\x20Deleted\x20','startTime','default','run','writeComponents','../../internal/fs.internal','__decorate','24sdoAcl','authSettings','call','[INFO]\x20Start\x20converting\x20to\x20SFDX','[INFO]\x20Preparing\x20to\x20delete\x20components','force','../../git-api/services/bitbucket-api.service','commitData','../../shared/services/auth-settings.service','[ERROR]\x20','(((.+)+)+)+$','../../salesforce/services/salesforce-logger-v2.service','1944024ltApcX','function','getOwnPropertyDescriptor','BitbucketApiService','ms.\x20Committed\x20components\x20-\x20','splice','getPrefix','sort','typedi','toString','prepareMdapi','SalesforceLogger2','hasOwnProperty','CommitComponentsJob','://','getProtocol','../utils/git.utils','COMPONENTS_PER_TICK','9982064inLwCJ','object','DEFAULT_GIT_USER_EMAIL','2136UrFwYO','503569cfbCZA','isSFDXProject','bitbucket','replace','../dto/commit-components.dto','components','../utils/mdapi.utils','../utils/sfdx.utils','componentsToWrite','4795cAVWfL','14GvNieL','9iccEhd','catch','__esModule','send','path','../../salesforce/utils/sfdx.utils','[INFO]\x20Prepare\x20mdapi\x20files','../../shared/utils','isLoggedIn','3183906PJSBgR','fileType','sfLogger','117053zSLJMP','[INFO]\x20Preparing\x20to\x20write\x20components'];a181_0x49d6=function(){return _0x6046a9;};return a181_0x49d6();}const a181_0x3b603a=(function(){let _0x3612ca=!![];return function(_0x3b87c7,_0x591e7a){const _0x468e91=_0x3612ca?function(){if(_0x591e7a){const _0xda4583=_0x591e7a['apply'](_0x3b87c7,arguments);return _0x591e7a=null,_0xda4583;}}:function(){};return _0x3612ca=![],_0x468e91;};}()),a181_0x1a4e01=a181_0x3b603a(this,function(){const _0x12729f=a181_0x3b6b;return a181_0x1a4e01[_0x12729f(0x129)]()[_0x12729f(0x177)](_0x12729f(0x197))[_0x12729f(0x129)]()[_0x12729f(0x14f)](a181_0x1a4e01)[_0x12729f(0x177)]('(((.+)+)+)+$');});a181_0x1a4e01();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x961a79,_0x98211d,_0x33a1a1,_0x240321){const _0x806c04=a181_0x3b6b;if(_0x240321===undefined)_0x240321=_0x33a1a1;Object[_0x806c04(0x17a)](_0x961a79,_0x240321,{'enumerable':!![],'get':function(){return _0x98211d[_0x33a1a1];}});}:function(_0x2859ba,_0x5f3515,_0x58d3fb,_0x39deaf){if(_0x39deaf===undefined)_0x39deaf=_0x58d3fb;_0x2859ba[_0x39deaf]=_0x5f3515[_0x58d3fb];}),__setModuleDefault=this&&this[a181_0x2fb3d0(0x167)]||(Object[a181_0x2fb3d0(0x182)]?function(_0x95204e,_0x4fbff3){const _0x3956b2=a181_0x2fb3d0;Object[_0x3956b2(0x17a)](_0x95204e,_0x3956b2(0x188),{'enumerable':!![],'value':_0x4fbff3});}:function(_0x2dc800,_0x457f5a){_0x2dc800['default']=_0x457f5a;}),__decorate=this&&this[a181_0x2fb3d0(0x18c)]||function(_0x5f49a8,_0x446589,_0x5a5245,_0x598e7f){const _0x490897=a181_0x2fb3d0;var _0x223ac5=arguments[_0x490897(0x15b)],_0x5d2bd8=_0x223ac5<0x3?_0x446589:_0x598e7f===null?_0x598e7f=Object[_0x490897(0x122)](_0x446589,_0x5a5245):_0x598e7f,_0x177b4a;if(typeof Reflect===_0x490897(0x133)&&typeof Reflect[_0x490897(0x151)]===_0x490897(0x121))_0x5d2bd8=Reflect[_0x490897(0x151)](_0x5f49a8,_0x446589,_0x5a5245,_0x598e7f);else{for(var _0x4435e6=_0x5f49a8[_0x490897(0x15b)]-0x1;_0x4435e6>=0x0;_0x4435e6--)if(_0x177b4a=_0x5f49a8[_0x4435e6])_0x5d2bd8=(_0x223ac5<0x3?_0x177b4a(_0x5d2bd8):_0x223ac5>0x3?_0x177b4a(_0x446589,_0x5a5245,_0x5d2bd8):_0x177b4a(_0x446589,_0x5a5245))||_0x5d2bd8;}return _0x223ac5>0x3&&_0x5d2bd8&&Object[_0x490897(0x17a)](_0x446589,_0x5a5245,_0x5d2bd8),_0x5d2bd8;},__importStar=this&&this[a181_0x2fb3d0(0x17b)]||function(_0x351473){const _0x163a3b=a181_0x2fb3d0;if(_0x351473&&_0x351473['__esModule'])return _0x351473;var _0x71e2cc={};if(_0x351473!=null){for(var _0x9af3e in _0x351473)if(_0x9af3e!==_0x163a3b(0x188)&&Object['prototype'][_0x163a3b(0x12c)][_0x163a3b(0x18f)](_0x351473,_0x9af3e))__createBinding(_0x71e2cc,_0x351473,_0x9af3e);}return __setModuleDefault(_0x71e2cc,_0x351473),_0x71e2cc;},__metadata=this&&this[a181_0x2fb3d0(0x159)]||function(_0x4f8d6e,_0xfc1d80){const _0x56e516=a181_0x2fb3d0;if(typeof Reflect===_0x56e516(0x133)&&typeof Reflect[_0x56e516(0x160)]===_0x56e516(0x121))return Reflect[_0x56e516(0x160)](_0x4f8d6e,_0xfc1d80);},__importDefault=this&&this['__importDefault']||function(_0x31b3a1){const _0x39ab1c=a181_0x2fb3d0;return _0x31b3a1&&_0x31b3a1[_0x39ab1c(0x143)]?_0x31b3a1:{'default':_0x31b3a1};};Object[a181_0x2fb3d0(0x17a)](exports,a181_0x2fb3d0(0x143),{'value':!![]}),exports[a181_0x2fb3d0(0x12d)]=void 0x0;const auth_settings_service_1=require(a181_0x2fb3d0(0x195)),commit_components_dto_1=require(a181_0x2fb3d0(0x13a)),events_1=__importDefault(require('events')),git_utils_1=require(a181_0x2fb3d0(0x130)),mdapi_utils_1=require(a181_0x2fb3d0(0x13c)),sfdx_utils_1=require(a181_0x2fb3d0(0x13d)),typedi_1=__importStar(require(a181_0x2fb3d0(0x128))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a181_0x2fb3d0(0x148)),salesforce_logger_v2_service_1=require(a181_0x2fb3d0(0x198)),constants_1=require('../../../constants'),bitbucket_api_service_1=require(a181_0x2fb3d0(0x193)),sfdx_utils_2=require(a181_0x2fb3d0(0x146)),fs_internal_1=require(a181_0x2fb3d0(0x18b)),path_1=require(a181_0x2fb3d0(0x145));function a181_0x3b6b(_0xdc68d6,_0x366da8){const _0x239537=a181_0x49d6();return a181_0x3b6b=function(_0x1a4e01,_0x3b603a){_0x1a4e01=_0x1a4e01-0x120;let _0x49d6c1=_0x239537[_0x1a4e01];return _0x49d6c1;},a181_0x3b6b(_0xdc68d6,_0x366da8);}let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x2fb3d0(0x188)]{constructor(_0x402457){const _0x5b2523=a181_0x2fb3d0;super(),this[_0x5b2523(0x18e)]=_0x402457,this['COMPONENTS_PER_TICK']=0x3e8,this[_0x5b2523(0x13e)]=0x0,this[_0x5b2523(0x17e)]=0x0,this[_0x5b2523(0x187)]=Date[_0x5b2523(0x176)]();}async[a181_0x2fb3d0(0x171)](){const _0x4ff00a=a181_0x2fb3d0,{repo:_0x978a67}=this['commitData'];let _0x502e2e=this['authSettings'][_0x4ff00a(0x175)](this['commitData'][_0x4ff00a(0x174)]);if(this[_0x4ff00a(0x194)][_0x4ff00a(0x174)]===_0x4ff00a(0x138)){const _0x156b32=typedi_1[_0x4ff00a(0x188)][_0x4ff00a(0x156)](bitbucket_api_service_1[_0x4ff00a(0x123)]);await _0x156b32[_0x4ff00a(0x149)](),_0x502e2e+=encodeURIComponent(_0x156b32['getAccessToken']());}return _0x978a67[_0x4ff00a(0x17c)][_0x4ff00a(0x139)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x4ff00a(0x12f)](_0x978a67[_0x4ff00a(0x17c)])+_0x4ff00a(0x12e)+_0x502e2e+'@');}[a181_0x2fb3d0(0x184)](_0x5b1d0c){const _0x30c742=a181_0x2fb3d0;var _0x3f07d8;_0x5b1d0c[_0x30c742(0x127)](_0x13ec9e=>child_types_1[_0x30c742(0x188)][_0x30c742(0x179)](_0x13ec9e[_0x30c742(0x14b)])?0x1:-0x1);const _0x2722ac={};for(const _0x54e80e of _0x5b1d0c){_0x2722ac[_0x3f07d8=_0x54e80e['fileName']]||(_0x2722ac[_0x3f07d8]=[]),_0x2722ac[_0x54e80e['fileName']][_0x30c742(0x15d)](_0x54e80e);}return Object['values'](_0x2722ac)[_0x30c742(0x153)]((_0x578b50,_0x27f1e0)=>[..._0x578b50,..._0x27f1e0],[]);}async['writeComponents'](_0x33337b){const _0x32843c=a181_0x2fb3d0;_0x33337b=this[_0x32843c(0x184)](_0x33337b);let _0x48af95=0x0;while(_0x33337b[_0x32843c(0x15b)]){const _0xded062=_0x33337b[_0x32843c(0x125)](0x0,this[_0x32843c(0x131)]);await this[_0x32843c(0x162)][_0x32843c(0x169)](_0xded062,{'skipChildErrors':this[_0x32843c(0x194)][_0x32843c(0x166)][_0x32843c(0x180)]===_0x32843c(0x158)}),_0x48af95+=_0xded062[_0x32843c(0x15b)],this[_0x32843c(0x14c)][_0x32843c(0x185)](_0x32843c(0x163)+_0x48af95+'/'+this['componentsToWrite']+_0x32843c(0x15f)),await this['sfLogger']['send']();}}async[a181_0x2fb3d0(0x16a)](_0x72c22b){const _0x2ecdf2=a181_0x2fb3d0;_0x72c22b['sort'](_0x3cc097=>child_types_1[_0x2ecdf2(0x188)][_0x2ecdf2(0x179)](_0x3cc097[_0x2ecdf2(0x15e)])?-0x1:0x1);let _0xf2a022=0x0;while(_0x72c22b[_0x2ecdf2(0x15b)]){const _0x131aab=_0x72c22b[_0x2ecdf2(0x125)](0x0,this[_0x2ecdf2(0x131)]);await this[_0x2ecdf2(0x162)][_0x2ecdf2(0x16a)](_0x131aab),_0xf2a022+=_0x131aab[_0x2ecdf2(0x15b)],this[_0x2ecdf2(0x14c)]['log'](_0x2ecdf2(0x186)+_0xf2a022+'/'+this[_0x2ecdf2(0x17e)]+'\x20components'),await this[_0x2ecdf2(0x14c)][_0x2ecdf2(0x144)]();}}async[a181_0x2fb3d0(0x17f)](){const _0x2dbb6a=a181_0x2fb3d0;this[_0x2dbb6a(0x16f)]&&await this[_0x2dbb6a(0x16f)][_0x2dbb6a(0x173)]()[_0x2dbb6a(0x142)](()=>void 0x0),this[_0x2dbb6a(0x162)]&&await this[_0x2dbb6a(0x162)]['removeDir']()['catch'](()=>void 0x0),this[_0x2dbb6a(0x161)]&&await this[_0x2dbb6a(0x161)][_0x2dbb6a(0x173)]()[_0x2dbb6a(0x142)](()=>void 0x0);}async['exec'](){const _0x70e36c=a181_0x2fb3d0,{repo:_0x44d670,branch:_0x1a6a79,components:_0x73e2e4,convertToSFDX:_0x1a3c8,message:_0x2d3059,user:_0x578c94}=this[_0x70e36c(0x194)];this['mdapiUtils']=new mdapi_utils_1[(_0x70e36c(0x152))](_0x44d670[_0x70e36c(0x180)],_0x1a6a79[_0x70e36c(0x180)]),this['gitUtils']=new git_utils_1['GitUtils'](await this['getRemote']()),this[_0x70e36c(0x161)]=new sfdx_utils_1[(_0x70e36c(0x15a))](_0x44d670[_0x70e36c(0x180)],_0x1a6a79[_0x70e36c(0x180)]);let _0x21b394=_0x1a3c8;try{this[_0x70e36c(0x14c)][_0x70e36c(0x185)]('[INFO]\x20Start\x20clonning\x20repository'),await this[_0x70e36c(0x16f)][_0x70e36c(0x150)](_0x1a6a79['name'],_0x44d670['name']);!this['commitData'][_0x70e36c(0x192)]?(this[_0x70e36c(0x14c)][_0x70e36c(0x185)](_0x70e36c(0x147)),await this[_0x70e36c(0x162)][_0x70e36c(0x12a)](this[_0x70e36c(0x16f)][_0x70e36c(0x183)])):this[_0x70e36c(0x14c)][_0x70e36c(0x185)]('[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');_0x73e2e4[_0x70e36c(0x170)]&&(this[_0x70e36c(0x14c)][_0x70e36c(0x185)](_0x70e36c(0x14e)),this['componentsToWrite']=_0x73e2e4[_0x70e36c(0x170)][_0x70e36c(0x15b)],await this[_0x70e36c(0x18a)](_0x73e2e4[_0x70e36c(0x170)]),await this[_0x70e36c(0x14c)][_0x70e36c(0x144)]());_0x73e2e4[_0x70e36c(0x178)]&&(this[_0x70e36c(0x14c)]['log'](_0x70e36c(0x191)),this['componentsToDelete']=_0x73e2e4[_0x70e36c(0x178)]['length'],await this[_0x70e36c(0x16a)](_0x73e2e4[_0x70e36c(0x178)]),await this[_0x70e36c(0x14c)][_0x70e36c(0x144)]());await this[_0x70e36c(0x14c)]['send']();await sfdx_utils_2['SFDX'][_0x70e36c(0x137)](this[_0x70e36c(0x16f)][_0x70e36c(0x183)])?(_0x21b394=!![],await fs_internal_1['FS']['removeDir'](path_1[_0x70e36c(0x16c)](this[_0x70e36c(0x16f)][_0x70e36c(0x183)],'force-app'))):(_0x21b394&&(!await fs_internal_1['FS']['isEmptyDir'](this[_0x70e36c(0x16f)][_0x70e36c(0x183)])&&(_0x21b394=![])),await this[_0x70e36c(0x16f)][_0x70e36c(0x17d)]());_0x21b394?(this[_0x70e36c(0x14c)][_0x70e36c(0x185)](_0x70e36c(0x190)),await this[_0x70e36c(0x161)]['createProjectFrom'](this[_0x70e36c(0x162)][_0x70e36c(0x183)]),await this[_0x70e36c(0x161)][_0x70e36c(0x155)](this[_0x70e36c(0x16f)][_0x70e36c(0x183)]),await this[_0x70e36c(0x161)][_0x70e36c(0x173)](),await this['sfLogger'][_0x70e36c(0x144)]()):(this[_0x70e36c(0x14c)][_0x70e36c(0x185)]('[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder'),await this[_0x70e36c(0x162)][_0x70e36c(0x168)](this[_0x70e36c(0x16f)][_0x70e36c(0x183)]),await this['sfLogger'][_0x70e36c(0x144)]());this[_0x70e36c(0x14c)][_0x70e36c(0x185)]('[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git'),await this['gitUtils'][_0x70e36c(0x181)](_0x2d3059,{'email':constants_1[_0x70e36c(0x134)],'name':_0x578c94[_0x70e36c(0x180)]},_0x1a6a79['name']),await this['gitUtils']['removeDir'](),await this[_0x70e36c(0x162)][_0x70e36c(0x173)]();const _0x393367=this[_0x70e36c(0x13e)]+this[_0x70e36c(0x17e)];this[_0x70e36c(0x14c)][_0x70e36c(0x185)](_0x70e36c(0x164)+(Date[_0x70e36c(0x176)]()-this[_0x70e36c(0x187)])+_0x70e36c(0x124)+_0x393367),await this['sfLogger']['send']();}catch(_0x34e122){await this[_0x70e36c(0x17f)](),this[_0x70e36c(0x14c)][_0x70e36c(0x185)](_0x70e36c(0x196)+_0x34e122),await this[_0x70e36c(0x14c)]['send']();throw _0x34e122;}}async[a181_0x2fb3d0(0x189)](_0x496250,_0x451181){const _0x207375=a181_0x2fb3d0;var _0x220486,_0x1755c2;this[_0x207375(0x14c)]=new salesforce_logger_v2_service_1[(_0x207375(0x12b))](_0x451181[_0x207375(0x157)](),_0x451181[_0x207375(0x126)]()+'\x20['+commit_components_dto_1['CommitComponentsDto']['name']+']');const _0xfea675=!!((_0x220486=_0x496250[_0x207375(0x13b)])===null||_0x220486===void 0x0?void 0x0:_0x220486[_0x207375(0x170)])||!!((_0x1755c2=_0x496250['components'])===null||_0x1755c2===void 0x0?void 0x0:_0x1755c2['deleted']);if(!_0xfea675){this[_0x207375(0x14c)][_0x207375(0x185)](_0x207375(0x172)),await this['sfLogger'][_0x207375(0x144)]();return;}this[_0x207375(0x194)]=_0x496250,await this[_0x207375(0x165)]();}};CommitComponentsJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a181_0x2fb3d0(0x16b),[auth_settings_service_1[a181_0x2fb3d0(0x154)]])],CommitComponentsJob),exports[a181_0x2fb3d0(0x12d)]=CommitComponentsJob;