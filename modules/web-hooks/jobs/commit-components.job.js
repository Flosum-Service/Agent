const a180_0x51131c=a180_0x71bb;(function(_0xcab53e,_0x972e0b){const _0x1ec1ba=a180_0x71bb,_0x5b7b05=_0xcab53e();while(!![]){try{const _0x3ba182=-parseInt(_0x1ec1ba(0x90))/0x1*(parseInt(_0x1ec1ba(0xcd))/0x2)+parseInt(_0x1ec1ba(0xab))/0x3+parseInt(_0x1ec1ba(0xf7))/0x4*(parseInt(_0x1ec1ba(0x103))/0x5)+-parseInt(_0x1ec1ba(0xcf))/0x6*(-parseInt(_0x1ec1ba(0xc9))/0x7)+-parseInt(_0x1ec1ba(0xd8))/0x8+-parseInt(_0x1ec1ba(0xd3))/0x9*(parseInt(_0x1ec1ba(0xd5))/0xa)+parseInt(_0x1ec1ba(0xbd))/0xb*(parseInt(_0x1ec1ba(0xaa))/0xc);if(_0x3ba182===_0x972e0b)break;else _0x5b7b05['push'](_0x5b7b05['shift']());}catch(_0x51457a){_0x5b7b05['push'](_0x5b7b05['shift']());}}}(a180_0x309d,0x7bce3));const a180_0x116057=(function(){let _0x13ae53=!![];return function(_0x27156c,_0x3e614f){const _0x4715d7=_0x13ae53?function(){const _0x3fa75a=a180_0x71bb;if(_0x3e614f){const _0x22066d=_0x3e614f[_0x3fa75a(0xa9)](_0x27156c,arguments);return _0x3e614f=null,_0x22066d;}}:function(){};return _0x13ae53=![],_0x4715d7;};}()),a180_0x4f1006=a180_0x116057(this,function(){const _0x3a6617=a180_0x71bb;return a180_0x4f1006[_0x3a6617(0xbc)]()[_0x3a6617(0xe6)](_0x3a6617(0xd0))[_0x3a6617(0xbc)]()['constructor'](a180_0x4f1006)[_0x3a6617(0xe6)](_0x3a6617(0xd0));});a180_0x4f1006();'use strict';var __createBinding=this&&this[a180_0x51131c(0xcb)]||(Object['create']?function(_0x1a5fdc,_0x4de3e3,_0x1f3f35,_0x476de3){if(_0x476de3===undefined)_0x476de3=_0x1f3f35;Object['defineProperty'](_0x1a5fdc,_0x476de3,{'enumerable':!![],'get':function(){return _0x4de3e3[_0x1f3f35];}});}:function(_0xf875ec,_0x1f2b7d,_0x29051e,_0x3bb799){if(_0x3bb799===undefined)_0x3bb799=_0x29051e;_0xf875ec[_0x3bb799]=_0x1f2b7d[_0x29051e];}),__setModuleDefault=this&&this[a180_0x51131c(0xc6)]||(Object[a180_0x51131c(0xac)]?function(_0x19ebe1,_0x48b534){Object['defineProperty'](_0x19ebe1,'default',{'enumerable':!![],'value':_0x48b534});}:function(_0x422135,_0x6d0692){const _0x37b1f4=a180_0x51131c;_0x422135[_0x37b1f4(0xfc)]=_0x6d0692;}),__decorate=this&&this[a180_0x51131c(0xde)]||function(_0x2f70ee,_0x5ac7d5,_0x346c2f,_0x50d528){const _0x40c135=a180_0x51131c;var _0x580f4b=arguments[_0x40c135(0xb8)],_0x3c82f6=_0x580f4b<0x3?_0x5ac7d5:_0x50d528===null?_0x50d528=Object[_0x40c135(0xa3)](_0x5ac7d5,_0x346c2f):_0x50d528,_0x277553;if(typeof Reflect===_0x40c135(0xbf)&&typeof Reflect['decorate']==='function')_0x3c82f6=Reflect[_0x40c135(0xb5)](_0x2f70ee,_0x5ac7d5,_0x346c2f,_0x50d528);else{for(var _0xddee38=_0x2f70ee[_0x40c135(0xb8)]-0x1;_0xddee38>=0x0;_0xddee38--)if(_0x277553=_0x2f70ee[_0xddee38])_0x3c82f6=(_0x580f4b<0x3?_0x277553(_0x3c82f6):_0x580f4b>0x3?_0x277553(_0x5ac7d5,_0x346c2f,_0x3c82f6):_0x277553(_0x5ac7d5,_0x346c2f))||_0x3c82f6;}return _0x580f4b>0x3&&_0x3c82f6&&Object[_0x40c135(0x93)](_0x5ac7d5,_0x346c2f,_0x3c82f6),_0x3c82f6;},__importStar=this&&this[a180_0x51131c(0xf0)]||function(_0x3369b0){const _0x104074=a180_0x51131c;if(_0x3369b0&&_0x3369b0['__esModule'])return _0x3369b0;var _0x48a2c9={};if(_0x3369b0!=null){for(var _0x1f8ecb in _0x3369b0)if(_0x1f8ecb!==_0x104074(0xfc)&&Object[_0x104074(0xca)][_0x104074(0xb6)][_0x104074(0xdf)](_0x3369b0,_0x1f8ecb))__createBinding(_0x48a2c9,_0x3369b0,_0x1f8ecb);}return __setModuleDefault(_0x48a2c9,_0x3369b0),_0x48a2c9;},__metadata=this&&this['__metadata']||function(_0x63dd32,_0x4db09f){const _0x1fc846=a180_0x51131c;if(typeof Reflect===_0x1fc846(0xbf)&&typeof Reflect[_0x1fc846(0xce)]===_0x1fc846(0xf5))return Reflect[_0x1fc846(0xce)](_0x63dd32,_0x4db09f);},__importDefault=this&&this[a180_0x51131c(0xa8)]||function(_0x31697e){const _0xea02c=a180_0x51131c;return _0x31697e&&_0x31697e[_0xea02c(0xe9)]?_0x31697e:{'default':_0x31697e};};function a180_0x309d(){const _0x2458cf=['replace','mdapiUtils','values','dir','sfdxUtils','now','copyProjectTo','isLoggedIn','type','../utils/mdapi.utils','createProjectFrom','deleted','getOwnPropertyDescriptor','../../salesforce/utils/sfdx.utils','../../git-api/services/bitbucket-api.service','cleanUp','getProtocol','__importDefault','apply','12TUroWB','2554536mfvHTu','create','typedi','authSettings','getLoggerId','push','[INFO]\x20Wrote\x20','sort','clearDir','getAccessToken','decorate','hasOwnProperty','startTime','length','catch','path','log','toString','1766501NXgxwL','SalesforceLogger2','object','isSFDXProject','gitUrl','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','../../shared/utils','clone','../dto/commit-components.dto','__setModuleDefault','exec','[ERROR]\x20','4419359JyiaMa','prototype','__createBinding','name','927046ldVmAv','metadata','6ugyQPO','(((.+)+)+)+$','send','master','9ZpvfPv','isEmptyDir','7131490fHrAMS','components','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','749184pFXlTT','componentsToDelete','run','../../salesforce/services/salesforce-logger-v2.service','getRemote','../../shared/services/auth-settings.service','__decorate','call','gitUtils','://','commitData','get','\x20components','force-app','search','[INFO]\x20Start\x20converting\x20to\x20SFDX','force','__esModule','SFDXUtils','CommitComponentsJob','[INFO]\x20Deleted\x20','[INFO]\x20Preparing\x20to\x20write\x20components','fileType','removeDir','__importStar','getCredentialsFor','includes','splice','writed','function','removeComponents','28AEELZa','CommitComponentsDto','writeFlosumComponents','getPrefix','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','default','sfLogger','DEFAULT_GIT_USER_EMAIL','[INFO]\x20Prepare\x20mdapi\x20files','SFDX','../../../constants','../utils/sfdx.utils','95705AAAXlB','[INFO]\x20Preparing\x20to\x20delete\x20components','COMPONENTS_PER_TICK','events','BitbucketApiService','Service','1gNJdhD','join','componentsToWrite','defineProperty','GitUtils','provider','MDApiUtils'];a180_0x309d=function(){return _0x2458cf;};return a180_0x309d();}Object[a180_0x51131c(0x93)](exports,'__esModule',{'value':!![]}),exports[a180_0x51131c(0xeb)]=void 0x0;const auth_settings_service_1=require(a180_0x51131c(0xdd)),commit_components_dto_1=require(a180_0x51131c(0xc5)),events_1=__importDefault(require(a180_0x51131c(0x8d))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a180_0x51131c(0xa0)),sfdx_utils_1=require(a180_0x51131c(0x102)),typedi_1=__importStar(require(a180_0x51131c(0xad))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a180_0x51131c(0xc3)),salesforce_logger_v2_service_1=require(a180_0x51131c(0xdb)),constants_1=require(a180_0x51131c(0x101)),bitbucket_api_service_1=require(a180_0x51131c(0xa5)),sfdx_utils_2=require(a180_0x51131c(0xa4)),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a180_0x51131c(0xba));function a180_0x71bb(_0x1356d4,_0x5ccbb7){const _0x111ece=a180_0x309d();return a180_0x71bb=function(_0x4f1006,_0x116057){_0x4f1006=_0x4f1006-0x8c;let _0x309d00=_0x111ece[_0x4f1006];return _0x309d00;},a180_0x71bb(_0x1356d4,_0x5ccbb7);}let CommitComponentsJob=class CommitComponentsJob extends events_1[a180_0x51131c(0xfc)]{constructor(_0x4bf219){const _0x505976=a180_0x51131c;super(),this['authSettings']=_0x4bf219,this[_0x505976(0x8c)]=0x3e8,this[_0x505976(0x92)]=0x0,this[_0x505976(0xd9)]=0x0,this[_0x505976(0xb7)]=Date[_0x505976(0x9c)]();}async[a180_0x51131c(0xdc)](){const _0xa57ef1=a180_0x51131c,{repo:_0x36c142}=this[_0xa57ef1(0xe2)];let _0x45fa40=this[_0xa57ef1(0xae)][_0xa57ef1(0xf1)](this[_0xa57ef1(0xe2)]['provider']);if(this[_0xa57ef1(0xe2)][_0xa57ef1(0x95)]==='bitbucket'){const _0x53fdd5=typedi_1[_0xa57ef1(0xfc)][_0xa57ef1(0xe3)](bitbucket_api_service_1[_0xa57ef1(0x8e)]);await _0x53fdd5[_0xa57ef1(0x9e)](),_0x45fa40+=encodeURIComponent(_0x53fdd5[_0xa57ef1(0xb4)]());}return _0x36c142['gitUrl'][_0xa57ef1(0x97)](/http(s)?\:\/\/(.+@)?/,utils_1[_0xa57ef1(0xa7)](_0x36c142[_0xa57ef1(0xc1)])+_0xa57ef1(0xe1)+_0x45fa40+'@');}['groupComponentsByFileName'](_0x487c2c){const _0x195cc5=a180_0x51131c;var _0x53a381;_0x487c2c['sort'](_0x22a569=>child_types_1[_0x195cc5(0xfc)][_0x195cc5(0xf2)](_0x22a569[_0x195cc5(0xee)])?0x1:-0x1);const _0x29fbea={};for(const _0x2bddc4 of _0x487c2c){_0x29fbea[_0x53a381=_0x2bddc4['fileName']]||(_0x29fbea[_0x53a381]=[]),_0x29fbea[_0x2bddc4['fileName']][_0x195cc5(0xb0)](_0x2bddc4);}return Object[_0x195cc5(0x99)](_0x29fbea)['reduce']((_0x3d6920,_0x1e7cee)=>[..._0x3d6920,..._0x1e7cee],[]);}async['writeComponents'](_0x1470fa){const _0x1f87b0=a180_0x51131c;_0x1470fa=this['groupComponentsByFileName'](_0x1470fa);let _0x2c5210=0x0;while(_0x1470fa[_0x1f87b0(0xb8)]){const _0x4a3414=_0x1470fa[_0x1f87b0(0xf3)](0x0,this[_0x1f87b0(0x8c)]);await this[_0x1f87b0(0x98)][_0x1f87b0(0xf9)](_0x4a3414,{'skipChildErrors':this[_0x1f87b0(0xe2)]['branch'][_0x1f87b0(0xcc)]===_0x1f87b0(0xd2)}),_0x2c5210+=_0x4a3414[_0x1f87b0(0xb8)],this[_0x1f87b0(0xfd)]['log'](_0x1f87b0(0xb1)+_0x2c5210+'/'+this[_0x1f87b0(0x92)]+_0x1f87b0(0xe4)),await this[_0x1f87b0(0xfd)][_0x1f87b0(0xd1)]();}}async[a180_0x51131c(0xf6)](_0x36278c){const _0x5744d3=a180_0x51131c;_0x36278c[_0x5744d3(0xb2)](_0x395a0f=>child_types_1['default'][_0x5744d3(0xf2)](_0x395a0f[_0x5744d3(0x9f)])?-0x1:0x1);let _0x1a0c0c=0x0;while(_0x36278c[_0x5744d3(0xb8)]){const _0x52927a=_0x36278c[_0x5744d3(0xf3)](0x0,this[_0x5744d3(0x8c)]);await this[_0x5744d3(0x98)]['removeComponents'](_0x52927a),_0x1a0c0c+=_0x52927a[_0x5744d3(0xb8)],this[_0x5744d3(0xfd)][_0x5744d3(0xbb)](_0x5744d3(0xec)+_0x1a0c0c+'/'+this[_0x5744d3(0xd9)]+_0x5744d3(0xe4)),await this[_0x5744d3(0xfd)][_0x5744d3(0xd1)]();}}async[a180_0x51131c(0xa6)](){const _0x3ec2d6=a180_0x51131c;this[_0x3ec2d6(0xe0)]&&await this['gitUtils'][_0x3ec2d6(0xef)]()[_0x3ec2d6(0xb9)](()=>void 0x0),this[_0x3ec2d6(0x98)]&&await this[_0x3ec2d6(0x98)][_0x3ec2d6(0xef)]()['catch'](()=>void 0x0),this[_0x3ec2d6(0x9b)]&&await this['sfdxUtils'][_0x3ec2d6(0xef)]()[_0x3ec2d6(0xb9)](()=>void 0x0);}async[a180_0x51131c(0xc7)](){const _0x4965a1=a180_0x51131c,{repo:_0x4a0c6c,branch:_0x450a53,components:_0xa53a1,convertToSFDX:_0x114b70,message:_0x12d492,user:_0x1f35d1}=this[_0x4965a1(0xe2)];this[_0x4965a1(0x98)]=new mdapi_utils_1[(_0x4965a1(0x96))](_0x4a0c6c[_0x4965a1(0xcc)],_0x450a53[_0x4965a1(0xcc)]),this[_0x4965a1(0xe0)]=new git_utils_1[(_0x4965a1(0x94))](await this[_0x4965a1(0xdc)]()),this[_0x4965a1(0x9b)]=new sfdx_utils_1[(_0x4965a1(0xea))](_0x4a0c6c[_0x4965a1(0xcc)],_0x450a53[_0x4965a1(0xcc)]);let _0x104e17=_0x114b70;try{this[_0x4965a1(0xfd)][_0x4965a1(0xbb)]('[INFO]\x20Start\x20clonning\x20repository'),await this[_0x4965a1(0xe0)][_0x4965a1(0xc4)](_0x450a53[_0x4965a1(0xcc)],_0x4a0c6c[_0x4965a1(0xcc)]);!this[_0x4965a1(0xe2)][_0x4965a1(0xe8)]?(this[_0x4965a1(0xfd)][_0x4965a1(0xbb)](_0x4965a1(0xff)),await this[_0x4965a1(0x98)]['prepareMdapi'](this[_0x4965a1(0xe0)][_0x4965a1(0x9a)])):this[_0x4965a1(0xfd)][_0x4965a1(0xbb)](_0x4965a1(0xd7));_0xa53a1['writed']&&(this[_0x4965a1(0xfd)][_0x4965a1(0xbb)](_0x4965a1(0xed)),this[_0x4965a1(0x92)]=_0xa53a1[_0x4965a1(0xf4)][_0x4965a1(0xb8)],await this['writeComponents'](_0xa53a1['writed']),await this[_0x4965a1(0xfd)][_0x4965a1(0xd1)]());_0xa53a1[_0x4965a1(0xa2)]&&(this['sfLogger'][_0x4965a1(0xbb)](_0x4965a1(0x104)),this['componentsToDelete']=_0xa53a1[_0x4965a1(0xa2)][_0x4965a1(0xb8)],await this[_0x4965a1(0xf6)](_0xa53a1[_0x4965a1(0xa2)]),await this[_0x4965a1(0xfd)]['send']());await this[_0x4965a1(0xfd)][_0x4965a1(0xd1)]();await sfdx_utils_2[_0x4965a1(0x100)][_0x4965a1(0xc0)](this[_0x4965a1(0xe0)][_0x4965a1(0x9a)])?(_0x104e17=!![],await fs_internal_1['FS'][_0x4965a1(0xef)](path_1[_0x4965a1(0x91)](this[_0x4965a1(0xe0)][_0x4965a1(0x9a)],_0x4965a1(0xe5)))):(_0x104e17&&(!await fs_internal_1['FS'][_0x4965a1(0xd4)](this[_0x4965a1(0xe0)][_0x4965a1(0x9a)])&&(_0x104e17=![])),await this['gitUtils'][_0x4965a1(0xb3)]());_0x104e17?(this[_0x4965a1(0xfd)][_0x4965a1(0xbb)](_0x4965a1(0xe7)),await this[_0x4965a1(0x9b)][_0x4965a1(0xa1)](this['mdapiUtils'][_0x4965a1(0x9a)]),await this[_0x4965a1(0x9b)][_0x4965a1(0x9d)](this['gitUtils'][_0x4965a1(0x9a)]),await this['sfdxUtils']['removeDir'](),await this['sfLogger']['send']()):(this[_0x4965a1(0xfd)][_0x4965a1(0xbb)]('[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder'),await this[_0x4965a1(0x98)]['copyMdapiTo'](this['gitUtils'][_0x4965a1(0x9a)]),await this[_0x4965a1(0xfd)][_0x4965a1(0xd1)]());this[_0x4965a1(0xfd)][_0x4965a1(0xbb)](_0x4965a1(0xc2)),await this[_0x4965a1(0xe0)]['commitAndPush'](_0x12d492,{'email':constants_1[_0x4965a1(0xfe)],'name':_0x1f35d1['name']},_0x450a53[_0x4965a1(0xcc)]),await this[_0x4965a1(0xe0)][_0x4965a1(0xef)](),await this[_0x4965a1(0x98)]['removeDir']();const _0x2aa1f6=this[_0x4965a1(0x92)]+this[_0x4965a1(0xd9)];this['sfLogger'][_0x4965a1(0xbb)]('[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date['now']()-this[_0x4965a1(0xb7)])+'ms.\x20Committed\x20components\x20-\x20'+_0x2aa1f6),await this['sfLogger'][_0x4965a1(0xd1)]();}catch(_0x4f7e2f){await this['cleanUp'](),this[_0x4965a1(0xfd)]['log'](_0x4965a1(0xc8)+_0x4f7e2f),await this[_0x4965a1(0xfd)]['send']();throw _0x4f7e2f;}}async[a180_0x51131c(0xda)](_0x405732,_0x442b99){const _0x49e6d7=a180_0x51131c;var _0x2716ae,_0x3d4f3a;this['sfLogger']=new salesforce_logger_v2_service_1[(_0x49e6d7(0xbe))](_0x442b99[_0x49e6d7(0xaf)](),_0x442b99[_0x49e6d7(0xfa)]()+'\x20['+commit_components_dto_1[_0x49e6d7(0xf8)]['name']+']');const _0x570e7e=!!((_0x2716ae=_0x405732[_0x49e6d7(0xd6)])===null||_0x2716ae===void 0x0?void 0x0:_0x2716ae[_0x49e6d7(0xf4)])||!!((_0x3d4f3a=_0x405732[_0x49e6d7(0xd6)])===null||_0x3d4f3a===void 0x0?void 0x0:_0x3d4f3a[_0x49e6d7(0xa2)]);if(!_0x570e7e){this[_0x49e6d7(0xfd)][_0x49e6d7(0xbb)](_0x49e6d7(0xfb)),await this[_0x49e6d7(0xfd)][_0x49e6d7(0xd1)]();return;}this[_0x49e6d7(0xe2)]=_0x405732,await this[_0x49e6d7(0xc7)]();}};CommitComponentsJob=__decorate([typedi_1[a180_0x51131c(0x8f)]({'transient':!![]}),__metadata('design:paramtypes',[auth_settings_service_1['AuthSettingsService']])],CommitComponentsJob),exports[a180_0x51131c(0xeb)]=CommitComponentsJob;