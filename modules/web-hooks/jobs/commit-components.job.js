const a181_0x21ee63=a181_0x2f60;(function(_0xc10d2,_0x545834){const _0x32064f=a181_0x2f60,_0xa9fcea=_0xc10d2();while(!![]){try{const _0x18a55d=-parseInt(_0x32064f(0xac))/0x1*(parseInt(_0x32064f(0xd6))/0x2)+parseInt(_0x32064f(0xd7))/0x3+-parseInt(_0x32064f(0x83))/0x4+parseInt(_0x32064f(0xce))/0x5+-parseInt(_0x32064f(0xa6))/0x6*(-parseInt(_0x32064f(0x9e))/0x7)+-parseInt(_0x32064f(0xdc))/0x8+-parseInt(_0x32064f(0xa1))/0x9*(parseInt(_0x32064f(0x97))/0xa);if(_0x18a55d===_0x545834)break;else _0xa9fcea['push'](_0xa9fcea['shift']());}catch(_0x2047c3){_0xa9fcea['push'](_0xa9fcea['shift']());}}}(a181_0x2eac,0x2d020));const a181_0x1a2f87=(function(){let _0x5e96cc=!![];return function(_0x143710,_0x2c640d){const _0xee53d2=_0x5e96cc?function(){const _0x2c9b69=a181_0x2f60;if(_0x2c640d){const _0x187d5b=_0x2c640d[_0x2c9b69(0xa8)](_0x143710,arguments);return _0x2c640d=null,_0x187d5b;}}:function(){};return _0x5e96cc=![],_0xee53d2;};}()),a181_0x527fdd=a181_0x1a2f87(this,function(){const _0x1e8d1f=a181_0x2f60;return a181_0x527fdd[_0x1e8d1f(0x98)]()['search']('(((.+)+)+)+$')[_0x1e8d1f(0x98)]()[_0x1e8d1f(0x9f)](a181_0x527fdd)[_0x1e8d1f(0xb2)](_0x1e8d1f(0xeb));});function a181_0x2eac(){const _0x12af62=['[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','isEmptyDir','dir','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','CommitComponentsJob','commitAndPush','deleted','authSettings','metadata','create','getCredentialsFor','../dto/commit-components.dto','getLoggerId','clearDir','fileName','683295FhScPB','groupComponentsByFileName','copyMdapiTo','://','[INFO]\x20Wrote\x20','replace','isLoggedIn','includes','44282ezrsvH','242574tNJhKq','length','__esModule','\x20components','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','349376hryQVY','path','prepareMdapi','MDApiUtils','__importDefault','name','isSFDXProject','type','splice','../../shared/utils','ms.\x20Committed\x20components\x20-\x20','branch','object','writed','call','(((.+)+)+)+$','gitUtils','typedi','default','../../shared/services/auth-settings.service','decorate','hasOwnProperty','../../git-api/services/bitbucket-api.service','gitUrl','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','401256cDbNvZ','[ERROR]\x20','__createBinding','AuthSettingsService','removeDir','[INFO]\x20Prepare\x20mdapi\x20files','design:paramtypes','writeFlosumComponents','../../parsers/data/child-types','commitData','push','__decorate','sort','getRemote','SalesforceLogger2','get','componentsToWrite','writeComponents','fileType','CommitComponentsDto','67790uWjAmW','toString','__setModuleDefault','componentsToDelete','sfdxUtils','send','COMPONENTS_PER_TICK','2022153oQwHRR','constructor','defineProperty','207kayvSi','cleanUp','log','sfLogger','getPrefix','6LOOPzc','startTime','apply','catch','removeComponents','Service','1RWqPvo','createProjectFrom','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','bitbucket','provider','DEFAULT_GIT_USER_EMAIL','search','force-app','__metadata','mdapiUtils','exec','events','function','../utils/git.utils','now','components','../../internal/fs.internal','getAccessToken','BitbucketApiService'];a181_0x2eac=function(){return _0x12af62;};return a181_0x2eac();}a181_0x527fdd();'use strict';var __createBinding=this&&this[a181_0x21ee63(0x85)]||(Object[a181_0x21ee63(0xc8)]?function(_0x5e3cba,_0x140300,_0xc849b8,_0x881616){const _0x4543fc=a181_0x21ee63;if(_0x881616===undefined)_0x881616=_0xc849b8;Object[_0x4543fc(0xa0)](_0x5e3cba,_0x881616,{'enumerable':!![],'get':function(){return _0x140300[_0xc849b8];}});}:function(_0x39ceb6,_0x2c9f8a,_0x561f83,_0x2e8cef){if(_0x2e8cef===undefined)_0x2e8cef=_0x561f83;_0x39ceb6[_0x2e8cef]=_0x2c9f8a[_0x561f83];}),__setModuleDefault=this&&this[a181_0x21ee63(0x99)]||(Object[a181_0x21ee63(0xc8)]?function(_0x5d7503,_0x36a4f8){const _0x4725cb=a181_0x21ee63;Object['defineProperty'](_0x5d7503,_0x4725cb(0xee),{'enumerable':!![],'value':_0x36a4f8});}:function(_0x3fceb3,_0x399b6e){const _0x5e95d8=a181_0x21ee63;_0x3fceb3[_0x5e95d8(0xee)]=_0x399b6e;}),__decorate=this&&this[a181_0x21ee63(0x8e)]||function(_0x5a0763,_0x11b143,_0x2877bc,_0x4b04f4){const _0x5aa3f8=a181_0x21ee63;var _0x21ab3d=arguments[_0x5aa3f8(0xd8)],_0xce127e=_0x21ab3d<0x3?_0x11b143:_0x4b04f4===null?_0x4b04f4=Object['getOwnPropertyDescriptor'](_0x11b143,_0x2877bc):_0x4b04f4,_0x449101;if(typeof Reflect===_0x5aa3f8(0xe8)&&typeof Reflect[_0x5aa3f8(0xf0)]==='function')_0xce127e=Reflect[_0x5aa3f8(0xf0)](_0x5a0763,_0x11b143,_0x2877bc,_0x4b04f4);else{for(var _0x523c8e=_0x5a0763[_0x5aa3f8(0xd8)]-0x1;_0x523c8e>=0x0;_0x523c8e--)if(_0x449101=_0x5a0763[_0x523c8e])_0xce127e=(_0x21ab3d<0x3?_0x449101(_0xce127e):_0x21ab3d>0x3?_0x449101(_0x11b143,_0x2877bc,_0xce127e):_0x449101(_0x11b143,_0x2877bc))||_0xce127e;}return _0x21ab3d>0x3&&_0xce127e&&Object[_0x5aa3f8(0xa0)](_0x11b143,_0x2877bc,_0xce127e),_0xce127e;},__importStar=this&&this['__importStar']||function(_0x51629d){const _0x4a8380=a181_0x21ee63;if(_0x51629d&&_0x51629d[_0x4a8380(0xd9)])return _0x51629d;var _0x552cb9={};if(_0x51629d!=null){for(var _0x3a7260 in _0x51629d)if(_0x3a7260!==_0x4a8380(0xee)&&Object['prototype'][_0x4a8380(0xf1)][_0x4a8380(0xea)](_0x51629d,_0x3a7260))__createBinding(_0x552cb9,_0x51629d,_0x3a7260);}return __setModuleDefault(_0x552cb9,_0x51629d),_0x552cb9;},__metadata=this&&this[a181_0x21ee63(0xb4)]||function(_0x19895a,_0xa168ed){const _0x337f12=a181_0x21ee63;if(typeof Reflect===_0x337f12(0xe8)&&typeof Reflect['metadata']===_0x337f12(0xb8))return Reflect[_0x337f12(0xc7)](_0x19895a,_0xa168ed);},__importDefault=this&&this[a181_0x21ee63(0xe0)]||function(_0x558b46){const _0x352a2c=a181_0x21ee63;return _0x558b46&&_0x558b46[_0x352a2c(0xd9)]?_0x558b46:{'default':_0x558b46};};Object[a181_0x21ee63(0xa0)](exports,a181_0x21ee63(0xd9),{'value':!![]}),exports[a181_0x21ee63(0xc3)]=void 0x0;const auth_settings_service_1=require(a181_0x21ee63(0xef)),commit_components_dto_1=require(a181_0x21ee63(0xca)),events_1=__importDefault(require(a181_0x21ee63(0xb7))),git_utils_1=require(a181_0x21ee63(0xb9)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a181_0x21ee63(0xed))),child_types_1=__importDefault(require(a181_0x21ee63(0x8b))),utils_1=require(a181_0x21ee63(0xe5)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),constants_1=require('../../../constants'),bitbucket_api_service_1=require(a181_0x21ee63(0xf2)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a181_0x21ee63(0xbc)),path_1=require(a181_0x21ee63(0xdd));let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x21ee63(0xee)]{constructor(_0x58d2fa){const _0x5ac8c5=a181_0x21ee63;super(),this[_0x5ac8c5(0xc6)]=_0x58d2fa,this[_0x5ac8c5(0x9d)]=0x3e8,this[_0x5ac8c5(0x93)]=0x0,this[_0x5ac8c5(0x9a)]=0x0,this[_0x5ac8c5(0xa7)]=Date[_0x5ac8c5(0xba)]();}async['getRemote'](){const _0x2cab85=a181_0x21ee63,{repo:_0x3c4f16}=this['commitData'];let _0x5d1f1d=this['authSettings'][_0x2cab85(0xc9)](this[_0x2cab85(0x8c)][_0x2cab85(0xb0)]);if(this[_0x2cab85(0x8c)][_0x2cab85(0xb0)]===_0x2cab85(0xaf)){const _0x1fcc7a=typedi_1['default'][_0x2cab85(0x92)](bitbucket_api_service_1[_0x2cab85(0xbe)]);await _0x1fcc7a[_0x2cab85(0xd4)](),_0x5d1f1d+=encodeURIComponent(_0x1fcc7a[_0x2cab85(0xbd)]());}return _0x3c4f16['gitUrl'][_0x2cab85(0xd3)](/http(s)?\:\/\/(.+@)?/,utils_1['getProtocol'](_0x3c4f16[_0x2cab85(0x81)])+_0x2cab85(0xd1)+_0x5d1f1d+'@');}[a181_0x21ee63(0xcf)](_0x29274e){const _0x13c0cc=a181_0x21ee63;var _0x197df6;_0x29274e[_0x13c0cc(0x8f)](_0x447e1e=>child_types_1['default'][_0x13c0cc(0xd5)](_0x447e1e[_0x13c0cc(0x95)])?0x1:-0x1);const _0x36daba={};for(const _0x2cc28a of _0x29274e){_0x36daba[_0x197df6=_0x2cc28a[_0x13c0cc(0xcd)]]||(_0x36daba[_0x197df6]=[]),_0x36daba[_0x2cc28a[_0x13c0cc(0xcd)]][_0x13c0cc(0x8d)](_0x2cc28a);}return Object['values'](_0x36daba)['reduce']((_0x2587aa,_0x90ee97)=>[..._0x2587aa,..._0x90ee97],[]);}async[a181_0x21ee63(0x94)](_0x2bc811){const _0x1a37f9=a181_0x21ee63;_0x2bc811=this['groupComponentsByFileName'](_0x2bc811);let _0x274737=0x0;while(_0x2bc811[_0x1a37f9(0xd8)]){const _0x50c033=_0x2bc811[_0x1a37f9(0xe4)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x1a37f9(0xb5)][_0x1a37f9(0x8a)](_0x50c033,{'skipChildErrors':this['commitData'][_0x1a37f9(0xe7)]['name']==='master'}),_0x274737+=_0x50c033['length'],this[_0x1a37f9(0xa4)][_0x1a37f9(0xa3)](_0x1a37f9(0xd2)+_0x274737+'/'+this[_0x1a37f9(0x93)]+_0x1a37f9(0xda)),await this[_0x1a37f9(0xa4)][_0x1a37f9(0x9c)]();}}async[a181_0x21ee63(0xaa)](_0x10d731){const _0x35159c=a181_0x21ee63;_0x10d731['sort'](_0x3e4dd4=>child_types_1['default']['includes'](_0x3e4dd4[_0x35159c(0xe3)])?-0x1:0x1);let _0x1a4be7=0x0;while(_0x10d731['length']){const _0x56d6da=_0x10d731[_0x35159c(0xe4)](0x0,this[_0x35159c(0x9d)]);await this[_0x35159c(0xb5)][_0x35159c(0xaa)](_0x56d6da),_0x1a4be7+=_0x56d6da['length'],this[_0x35159c(0xa4)][_0x35159c(0xa3)]('[INFO]\x20Deleted\x20'+_0x1a4be7+'/'+this[_0x35159c(0x9a)]+_0x35159c(0xda)),await this[_0x35159c(0xa4)]['send']();}}async['cleanUp'](){const _0x15e355=a181_0x21ee63;this[_0x15e355(0xec)]&&await this[_0x15e355(0xec)][_0x15e355(0x87)]()[_0x15e355(0xa9)](()=>void 0x0),this['mdapiUtils']&&await this[_0x15e355(0xb5)]['removeDir']()[_0x15e355(0xa9)](()=>void 0x0),this[_0x15e355(0x9b)]&&await this[_0x15e355(0x9b)]['removeDir']()['catch'](()=>void 0x0);}async['exec'](){const _0x58da4b=a181_0x21ee63,{repo:_0x2eca59,branch:_0x577e02,components:_0x2a1085,convertToSFDX:_0x347802,message:_0x26599d,user:_0x5d2707}=this['commitData'];this[_0x58da4b(0xb5)]=new mdapi_utils_1[(_0x58da4b(0xdf))](_0x2eca59[_0x58da4b(0xe1)],_0x577e02['name']),this[_0x58da4b(0xec)]=new git_utils_1['GitUtils'](await this[_0x58da4b(0x90)]()),this[_0x58da4b(0x9b)]=new sfdx_utils_1['SFDXUtils'](_0x2eca59[_0x58da4b(0xe1)],_0x577e02[_0x58da4b(0xe1)]);let _0xf8e122=_0x347802;try{this[_0x58da4b(0xa4)][_0x58da4b(0xa3)]('[INFO]\x20Start\x20clonning\x20repository'),await this[_0x58da4b(0xec)]['clone'](_0x577e02[_0x58da4b(0xe1)],_0x2eca59['name']);!this[_0x58da4b(0x8c)]['force']?(this['sfLogger']['log'](_0x58da4b(0x88)),await this[_0x58da4b(0xb5)][_0x58da4b(0xde)](this[_0x58da4b(0xec)][_0x58da4b(0xc1)])):this[_0x58da4b(0xa4)][_0x58da4b(0xa3)](_0x58da4b(0xae));_0x2a1085['writed']&&(this[_0x58da4b(0xa4)]['log']('[INFO]\x20Preparing\x20to\x20write\x20components'),this[_0x58da4b(0x93)]=_0x2a1085[_0x58da4b(0xe9)]['length'],await this[_0x58da4b(0x94)](_0x2a1085[_0x58da4b(0xe9)]),await this[_0x58da4b(0xa4)][_0x58da4b(0x9c)]());_0x2a1085[_0x58da4b(0xc5)]&&(this[_0x58da4b(0xa4)][_0x58da4b(0xa3)]('[INFO]\x20Preparing\x20to\x20delete\x20components'),this[_0x58da4b(0x9a)]=_0x2a1085[_0x58da4b(0xc5)]['length'],await this[_0x58da4b(0xaa)](_0x2a1085[_0x58da4b(0xc5)]),await this['sfLogger'][_0x58da4b(0x9c)]());await this[_0x58da4b(0xa4)][_0x58da4b(0x9c)]();await sfdx_utils_2['SFDX'][_0x58da4b(0xe2)](this[_0x58da4b(0xec)][_0x58da4b(0xc1)])?(_0xf8e122=!![],await fs_internal_1['FS']['removeDir'](path_1['join'](this[_0x58da4b(0xec)][_0x58da4b(0xc1)],_0x58da4b(0xb3)))):(_0xf8e122&&(!await fs_internal_1['FS'][_0x58da4b(0xc0)](this[_0x58da4b(0xec)][_0x58da4b(0xc1)])&&(_0xf8e122=![])),await this[_0x58da4b(0xec)][_0x58da4b(0xcc)]());_0xf8e122?(this[_0x58da4b(0xa4)]['log']('[INFO]\x20Start\x20converting\x20to\x20SFDX'),await this[_0x58da4b(0x9b)][_0x58da4b(0xad)](this['mdapiUtils'][_0x58da4b(0xc1)]),await this[_0x58da4b(0x9b)]['copyProjectTo'](this[_0x58da4b(0xec)][_0x58da4b(0xc1)]),await this['sfdxUtils'][_0x58da4b(0x87)](),await this[_0x58da4b(0xa4)][_0x58da4b(0x9c)]()):(this[_0x58da4b(0xa4)][_0x58da4b(0xa3)](_0x58da4b(0xdb)),await this[_0x58da4b(0xb5)][_0x58da4b(0xd0)](this[_0x58da4b(0xec)]['dir']),await this[_0x58da4b(0xa4)][_0x58da4b(0x9c)]());this[_0x58da4b(0xa4)][_0x58da4b(0xa3)](_0x58da4b(0xbf)),await this[_0x58da4b(0xec)][_0x58da4b(0xc4)](_0x26599d,{'email':constants_1[_0x58da4b(0xb1)],'name':_0x5d2707[_0x58da4b(0xe1)]},_0x577e02[_0x58da4b(0xe1)]),await this[_0x58da4b(0xec)][_0x58da4b(0x87)](),await this[_0x58da4b(0xb5)][_0x58da4b(0x87)]();const _0x5b3ca2=this['componentsToWrite']+this[_0x58da4b(0x9a)];this['sfLogger'][_0x58da4b(0xa3)](_0x58da4b(0xc2)+(Date[_0x58da4b(0xba)]()-this[_0x58da4b(0xa7)])+_0x58da4b(0xe6)+_0x5b3ca2),await this['sfLogger'][_0x58da4b(0x9c)]();}catch(_0x54cd49){await this[_0x58da4b(0xa2)](),this['sfLogger'][_0x58da4b(0xa3)](_0x58da4b(0x84)+_0x54cd49),await this[_0x58da4b(0xa4)][_0x58da4b(0x9c)]();throw _0x54cd49;}}async['run'](_0x585194,_0x6bd723){const _0x28552c=a181_0x21ee63;var _0x447e0e,_0x381914;this[_0x28552c(0xa4)]=new salesforce_logger_v2_service_1[(_0x28552c(0x91))](_0x6bd723[_0x28552c(0xcb)](),_0x6bd723[_0x28552c(0xa5)]()+'\x20['+commit_components_dto_1[_0x28552c(0x96)]['name']+']');const _0x126b98=!!((_0x447e0e=_0x585194[_0x28552c(0xbb)])===null||_0x447e0e===void 0x0?void 0x0:_0x447e0e[_0x28552c(0xe9)])||!!((_0x381914=_0x585194[_0x28552c(0xbb)])===null||_0x381914===void 0x0?void 0x0:_0x381914[_0x28552c(0xc5)]);if(!_0x126b98){this['sfLogger'][_0x28552c(0xa3)](_0x28552c(0x82)),await this[_0x28552c(0xa4)]['send']();return;}this[_0x28552c(0x8c)]=_0x585194,await this[_0x28552c(0xb6)]();}};function a181_0x2f60(_0x5a0e5b,_0x1b5eed){const _0x52a463=a181_0x2eac();return a181_0x2f60=function(_0x527fdd,_0x1a2f87){_0x527fdd=_0x527fdd-0x81;let _0x2eac3b=_0x52a463[_0x527fdd];return _0x2eac3b;},a181_0x2f60(_0x5a0e5b,_0x1b5eed);}CommitComponentsJob=__decorate([typedi_1[a181_0x21ee63(0xab)]({'transient':!![]}),__metadata(a181_0x21ee63(0x89),[auth_settings_service_1[a181_0x21ee63(0x86)]])],CommitComponentsJob),exports[a181_0x21ee63(0xc3)]=CommitComponentsJob;