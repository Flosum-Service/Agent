const a181_0x436049=a181_0x1f0f;(function(_0x43d928,_0x4d4548){const _0x3679df=a181_0x1f0f,_0x4a0fff=_0x43d928();while(!![]){try{const _0xd49c23=-parseInt(_0x3679df(0x163))/0x1*(parseInt(_0x3679df(0x12d))/0x2)+parseInt(_0x3679df(0x15a))/0x3*(parseInt(_0x3679df(0x15c))/0x4)+-parseInt(_0x3679df(0x165))/0x5+parseInt(_0x3679df(0x131))/0x6*(-parseInt(_0x3679df(0x16f))/0x7)+parseInt(_0x3679df(0x141))/0x8*(-parseInt(_0x3679df(0x198))/0x9)+parseInt(_0x3679df(0x16c))/0xa*(-parseInt(_0x3679df(0x186))/0xb)+-parseInt(_0x3679df(0x17f))/0xc*(-parseInt(_0x3679df(0x11f))/0xd);if(_0xd49c23===_0x4d4548)break;else _0x4a0fff['push'](_0x4a0fff['shift']());}catch(_0x569251){_0x4a0fff['push'](_0x4a0fff['shift']());}}}(a181_0x4e1e,0x656e1));function a181_0x1f0f(_0x524baa,_0x5422de){const _0x842252=a181_0x4e1e();return a181_0x1f0f=function(_0x57ee04,_0x36fc7d){_0x57ee04=_0x57ee04-0x11f;let _0x4e1e01=_0x842252[_0x57ee04];return _0x4e1e01;},a181_0x1f0f(_0x524baa,_0x5422de);}const a181_0x36fc7d=(function(){let _0x4f4537=!![];return function(_0xa7499b,_0x288329){const _0x184d65=_0x4f4537?function(){const _0x1544f4=a181_0x1f0f;if(_0x288329){const _0x14d30e=_0x288329[_0x1544f4(0x132)](_0xa7499b,arguments);return _0x288329=null,_0x14d30e;}}:function(){};return _0x4f4537=![],_0x184d65;};}()),a181_0x57ee04=a181_0x36fc7d(this,function(){const _0x308591=a181_0x1f0f;return a181_0x57ee04[_0x308591(0x12b)]()['search'](_0x308591(0x14d))['toString']()[_0x308591(0x137)](a181_0x57ee04)[_0x308591(0x14f)](_0x308591(0x14d));});a181_0x57ee04();'use strict';var __createBinding=this&&this[a181_0x436049(0x126)]||(Object['create']?function(_0x2a40bf,_0x40bb12,_0x23f3b0,_0x2069e7){const _0x4c2ad4=a181_0x436049;if(_0x2069e7===undefined)_0x2069e7=_0x23f3b0;Object[_0x4c2ad4(0x195)](_0x2a40bf,_0x2069e7,{'enumerable':!![],'get':function(){return _0x40bb12[_0x23f3b0];}});}:function(_0x1764a1,_0x497ed1,_0x14e0f3,_0x307258){if(_0x307258===undefined)_0x307258=_0x14e0f3;_0x1764a1[_0x307258]=_0x497ed1[_0x14e0f3];}),__setModuleDefault=this&&this[a181_0x436049(0x12f)]||(Object[a181_0x436049(0x164)]?function(_0x41c3fb,_0x3c7984){const _0x114116=a181_0x436049;Object['defineProperty'](_0x41c3fb,_0x114116(0x16a),{'enumerable':!![],'value':_0x3c7984});}:function(_0x4d49f6,_0x1fdd0d){const _0x579a96=a181_0x436049;_0x4d49f6[_0x579a96(0x16a)]=_0x1fdd0d;}),__decorate=this&&this[a181_0x436049(0x176)]||function(_0x1be09b,_0x19fad8,_0x2f2708,_0x1a92ad){const _0x3b17e2=a181_0x436049;var _0x418cd9=arguments[_0x3b17e2(0x168)],_0x215bc3=_0x418cd9<0x3?_0x19fad8:_0x1a92ad===null?_0x1a92ad=Object[_0x3b17e2(0x133)](_0x19fad8,_0x2f2708):_0x1a92ad,_0x400269;if(typeof Reflect===_0x3b17e2(0x196)&&typeof Reflect[_0x3b17e2(0x17b)]===_0x3b17e2(0x127))_0x215bc3=Reflect[_0x3b17e2(0x17b)](_0x1be09b,_0x19fad8,_0x2f2708,_0x1a92ad);else{for(var _0x4118b2=_0x1be09b[_0x3b17e2(0x168)]-0x1;_0x4118b2>=0x0;_0x4118b2--)if(_0x400269=_0x1be09b[_0x4118b2])_0x215bc3=(_0x418cd9<0x3?_0x400269(_0x215bc3):_0x418cd9>0x3?_0x400269(_0x19fad8,_0x2f2708,_0x215bc3):_0x400269(_0x19fad8,_0x2f2708))||_0x215bc3;}return _0x418cd9>0x3&&_0x215bc3&&Object['defineProperty'](_0x19fad8,_0x2f2708,_0x215bc3),_0x215bc3;},__importStar=this&&this[a181_0x436049(0x142)]||function(_0xa15584){const _0x1ccfc8=a181_0x436049;if(_0xa15584&&_0xa15584[_0x1ccfc8(0x167)])return _0xa15584;var _0x57d280={};if(_0xa15584!=null){for(var _0x343981 in _0xa15584)if(_0x343981!==_0x1ccfc8(0x16a)&&Object['prototype'][_0x1ccfc8(0x184)][_0x1ccfc8(0x121)](_0xa15584,_0x343981))__createBinding(_0x57d280,_0xa15584,_0x343981);}return __setModuleDefault(_0x57d280,_0xa15584),_0x57d280;},__metadata=this&&this['__metadata']||function(_0x177a0b,_0x59ba7d){const _0x1aadb6=a181_0x436049;if(typeof Reflect===_0x1aadb6(0x196)&&typeof Reflect[_0x1aadb6(0x13f)]===_0x1aadb6(0x127))return Reflect[_0x1aadb6(0x13f)](_0x177a0b,_0x59ba7d);},__importDefault=this&&this['__importDefault']||function(_0x53f2c7){const _0x490772=a181_0x436049;return _0x53f2c7&&_0x53f2c7[_0x490772(0x167)]?_0x53f2c7:{'default':_0x53f2c7};};Object[a181_0x436049(0x195)](exports,a181_0x436049(0x167),{'value':!![]}),exports[a181_0x436049(0x154)]=void 0x0;const auth_settings_service_1=require(a181_0x436049(0x16b)),commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require('events')),git_utils_1=require(a181_0x436049(0x148)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a181_0x436049(0x190)),typedi_1=__importStar(require(a181_0x436049(0x146))),child_types_1=__importDefault(require(a181_0x436049(0x15f))),utils_1=require(a181_0x436049(0x13d)),salesforce_logger_v2_service_1=require(a181_0x436049(0x18b)),constants_1=require(a181_0x436049(0x16d)),bitbucket_api_service_1=require(a181_0x436049(0x138)),sfdx_utils_2=require(a181_0x436049(0x14a)),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a181_0x436049(0x13e));let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x436049(0x16a)]{constructor(_0x16ae2e){const _0x2a3def=a181_0x436049;super(),this['authSettings']=_0x16ae2e,this[_0x2a3def(0x197)]=0x3e8,this[_0x2a3def(0x150)]=0x0,this[_0x2a3def(0x17a)]=0x0,this[_0x2a3def(0x183)]=Date['now']();}async['getRemote'](){const _0x148a44=a181_0x436049,{repo:_0x370174}=this[_0x148a44(0x15d)];let _0x444e4a=this[_0x148a44(0x13c)][_0x148a44(0x14c)](this[_0x148a44(0x15d)][_0x148a44(0x153)]);if(this['commitData']['provider']===_0x148a44(0x145)){const _0x422990=typedi_1[_0x148a44(0x16a)][_0x148a44(0x159)](bitbucket_api_service_1['BitbucketApiService']);await _0x422990['isLoggedIn'](),_0x444e4a+=encodeURIComponent(_0x422990[_0x148a44(0x17c)]());}return _0x370174[_0x148a44(0x185)][_0x148a44(0x188)](/http(s)?:\/\/(.+@)?/,utils_1['getProtocol'](_0x370174[_0x148a44(0x185)])+'://'+_0x444e4a+'@');}[a181_0x436049(0x192)](_0x417ea9){const _0x36c6c7=a181_0x436049;var _0x22a7fb;_0x417ea9['sort'](_0x5f56c8=>child_types_1['default'][_0x36c6c7(0x169)](_0x5f56c8[_0x36c6c7(0x166)])?0x1:-0x1);const _0x59e19e={};for(const _0x4a5393 of _0x417ea9){_0x59e19e[_0x22a7fb=_0x4a5393['fileName']]||(_0x59e19e[_0x22a7fb]=[]),_0x59e19e[_0x4a5393[_0x36c6c7(0x18c)]][_0x36c6c7(0x134)](_0x4a5393);}return Object[_0x36c6c7(0x125)](_0x59e19e)['reduce']((_0x268700,_0x41c41c)=>[..._0x268700,..._0x41c41c],[]);}async[a181_0x436049(0x13a)](_0x1e453a){const _0x2544fb=a181_0x436049;_0x1e453a=this['groupComponentsByFileName'](_0x1e453a);let _0x592ac5=0x0;while(_0x1e453a[_0x2544fb(0x168)]){const _0x3c39ed=_0x1e453a[_0x2544fb(0x12e)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils'][_0x2544fb(0x187)](_0x3c39ed,{'skipChildErrors':this[_0x2544fb(0x15d)]['branch']['name']===_0x2544fb(0x122)}),_0x592ac5+=_0x3c39ed['length'],this['sfLogger'][_0x2544fb(0x180)](_0x2544fb(0x18f)+_0x592ac5+'/'+this[_0x2544fb(0x150)]+_0x2544fb(0x152)),await this['sfLogger'][_0x2544fb(0x124)]();}}async[a181_0x436049(0x194)](_0x5cb731){const _0x1e1d37=a181_0x436049;_0x5cb731[_0x1e1d37(0x129)](_0x2bd2aa=>child_types_1['default'][_0x1e1d37(0x169)](_0x2bd2aa[_0x1e1d37(0x14e)])?-0x1:0x1);let _0x424379=0x0;while(_0x5cb731[_0x1e1d37(0x168)]){const _0x2d779a=_0x5cb731[_0x1e1d37(0x12e)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x1e1d37(0x161)][_0x1e1d37(0x194)](_0x2d779a),_0x424379+=_0x2d779a[_0x1e1d37(0x168)],this['sfLogger'][_0x1e1d37(0x180)](_0x1e1d37(0x155)+_0x424379+'/'+this[_0x1e1d37(0x17a)]+_0x1e1d37(0x152)),await this[_0x1e1d37(0x15e)][_0x1e1d37(0x124)]();}}async[a181_0x436049(0x140)](){const _0x4ee636=a181_0x436049;this[_0x4ee636(0x151)]&&await this['gitUtils']['removeDir']()[_0x4ee636(0x179)](()=>void 0x0),this[_0x4ee636(0x161)]&&await this[_0x4ee636(0x161)][_0x4ee636(0x189)]()[_0x4ee636(0x179)](()=>void 0x0),this['sfdxUtils']&&await this[_0x4ee636(0x173)]['removeDir']()['catch'](()=>void 0x0);}async[a181_0x436049(0x18d)](){const _0x2ef6e3=a181_0x436049,{repo:_0x2f0d60,branch:_0x49c3ac,components:_0x57c1b3,convertToSFDX:_0x3a74a8,message:_0x274389,user:_0x343140}=this[_0x2ef6e3(0x15d)];this[_0x2ef6e3(0x161)]=new mdapi_utils_1[(_0x2ef6e3(0x157))](),this[_0x2ef6e3(0x151)]=new git_utils_1[(_0x2ef6e3(0x170))](await this['getRemote']()),this[_0x2ef6e3(0x173)]=new sfdx_utils_1[(_0x2ef6e3(0x147))]();let _0x5536df=_0x3a74a8;try{this['sfLogger'][_0x2ef6e3(0x180)](_0x2ef6e3(0x193)),await this['gitUtils'][_0x2ef6e3(0x12a)](_0x49c3ac[_0x2ef6e3(0x13b)],_0x2f0d60[_0x2ef6e3(0x13b)]);!this[_0x2ef6e3(0x15d)][_0x2ef6e3(0x17d)]?(this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x180)](_0x2ef6e3(0x171)),await this[_0x2ef6e3(0x161)]['prepareMdapi'](this['gitUtils'][_0x2ef6e3(0x149)])):this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x180)](_0x2ef6e3(0x143));_0x57c1b3[_0x2ef6e3(0x181)]&&(this['sfLogger'][_0x2ef6e3(0x180)](_0x2ef6e3(0x156)),this[_0x2ef6e3(0x150)]=_0x57c1b3[_0x2ef6e3(0x181)][_0x2ef6e3(0x168)],await this[_0x2ef6e3(0x13a)](_0x57c1b3[_0x2ef6e3(0x181)]),await this['sfLogger']['send']());_0x57c1b3[_0x2ef6e3(0x130)]&&(this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x180)](_0x2ef6e3(0x18e)),this[_0x2ef6e3(0x17a)]=_0x57c1b3[_0x2ef6e3(0x130)][_0x2ef6e3(0x168)],await this['removeComponents'](_0x57c1b3[_0x2ef6e3(0x130)]),await this['sfLogger'][_0x2ef6e3(0x124)]());await this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x124)]();const _0x2d6cc2=await fs_internal_1['FS'][_0x2ef6e3(0x18a)](this['gitUtils'][_0x2ef6e3(0x149)]);await sfdx_utils_2[_0x2ef6e3(0x158)][_0x2ef6e3(0x172)](this[_0x2ef6e3(0x151)][_0x2ef6e3(0x149)])?(_0x5536df=!![],await fs_internal_1['FS'][_0x2ef6e3(0x189)](path_1[_0x2ef6e3(0x16e)](this[_0x2ef6e3(0x151)][_0x2ef6e3(0x149)],_0x2ef6e3(0x139)))):(_0x5536df&&(!_0x2d6cc2&&(_0x5536df=![])),await this[_0x2ef6e3(0x151)][_0x2ef6e3(0x14b)]());_0x5536df?(this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x180)](_0x2ef6e3(0x175)),await this[_0x2ef6e3(0x173)][_0x2ef6e3(0x199)](this[_0x2ef6e3(0x161)]['dir']),await this[_0x2ef6e3(0x173)][_0x2ef6e3(0x120)](this[_0x2ef6e3(0x151)][_0x2ef6e3(0x149)],!_0x2d6cc2),await this[_0x2ef6e3(0x173)][_0x2ef6e3(0x189)](),await this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x124)]()):(this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x180)](_0x2ef6e3(0x123)),await this[_0x2ef6e3(0x161)][_0x2ef6e3(0x191)](this[_0x2ef6e3(0x151)]['dir']),await this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x124)]());this['sfLogger'][_0x2ef6e3(0x180)]('[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git'),await this[_0x2ef6e3(0x151)]['commitAndPush'](_0x274389,{'email':constants_1[_0x2ef6e3(0x174)],'name':_0x343140[_0x2ef6e3(0x13b)]},_0x49c3ac[_0x2ef6e3(0x13b)]),await this[_0x2ef6e3(0x151)]['removeDir'](),await this['mdapiUtils']['removeDir']();const _0x3de464=this[_0x2ef6e3(0x150)]+this[_0x2ef6e3(0x17a)];this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x180)](_0x2ef6e3(0x178)+(Date['now']()-this[_0x2ef6e3(0x183)])+'ms.\x20Committed\x20components\x20-\x20'+_0x3de464),await this['sfLogger'][_0x2ef6e3(0x124)]();}catch(_0x3f3373){await this[_0x2ef6e3(0x140)](),this['sfLogger']['log'](_0x2ef6e3(0x128)+_0x3f3373),await this[_0x2ef6e3(0x15e)][_0x2ef6e3(0x124)]();throw _0x3f3373;}}async[a181_0x436049(0x136)](_0x20fbc3,_0x4782f9){const _0x3d3f2e=a181_0x436049;var _0x59769b,_0x4c2ce5;this[_0x3d3f2e(0x15e)]=new salesforce_logger_v2_service_1[(_0x3d3f2e(0x12c))](_0x4782f9[_0x3d3f2e(0x144)](),_0x4782f9[_0x3d3f2e(0x17e)]()+'\x20['+commit_components_dto_1[_0x3d3f2e(0x177)][_0x3d3f2e(0x13b)]+']');const _0xf5409b=!!((_0x59769b=_0x20fbc3[_0x3d3f2e(0x15b)])===null||_0x59769b===void 0x0?void 0x0:_0x59769b[_0x3d3f2e(0x181)])||!!((_0x4c2ce5=_0x20fbc3['components'])===null||_0x4c2ce5===void 0x0?void 0x0:_0x4c2ce5[_0x3d3f2e(0x130)]);if(!_0xf5409b){this['sfLogger'][_0x3d3f2e(0x180)](_0x3d3f2e(0x182)),await this[_0x3d3f2e(0x15e)]['send']();return;}this[_0x3d3f2e(0x15d)]=_0x20fbc3,await this['exec']();}};function a181_0x4e1e(){const _0x4f7402=['639cNackv','createProjectFrom','13tvACve','copyProjectTo','call','master','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','send','values','__createBinding','function','[ERROR]\x20','sort','clone','toString','SalesforceLogger2','2OIucUI','splice','__setModuleDefault','deleted','24OQoVAM','apply','getOwnPropertyDescriptor','push','Service','run','constructor','../../git-api/services/bitbucket-api.service','force-app','writeComponents','name','authSettings','../../shared/utils','path','metadata','cleanUp','81560wcWEFA','__importStar','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','getLoggerId','bitbucket','typedi','SFDXUtils','../utils/git.utils','dir','../../salesforce/utils/sfdx.utils','clearDir','getCredentialsFor','(((.+)+)+)+$','type','search','componentsToWrite','gitUtils','\x20components','provider','CommitComponentsJob','[INFO]\x20Deleted\x20','[INFO]\x20Preparing\x20to\x20write\x20components','MDApiUtils','SFDX','get','3BOPpnR','components','1983500fUCzhS','commitData','sfLogger','../../parsers/data/child-types','design:paramtypes','mdapiUtils','AuthSettingsService','160229FUwBDl','create','1391600HQWkfV','fileType','__esModule','length','includes','default','../../shared/services/auth-settings.service','23610WvlvHB','../../../constants','join','765541ufDnGd','GitUtils','[INFO]\x20Prepare\x20mdapi\x20files','isSFDXProject','sfdxUtils','DEFAULT_GIT_USER_EMAIL','[INFO]\x20Start\x20converting\x20to\x20SFDX','__decorate','CommitComponentsDto','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','catch','componentsToDelete','decorate','getAccessToken','force','getPrefix','22171284tRqxLF','log','writed','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','startTime','hasOwnProperty','gitUrl','1529pDAwzj','writeFlosumComponents','replace','removeDir','isEmptyDir','../../salesforce/services/salesforce-logger-v2.service','fileName','exec','[INFO]\x20Preparing\x20to\x20delete\x20components','[INFO]\x20Wrote\x20','../utils/sfdx.utils','copyMdapiTo','groupComponentsByFileName','[INFO]\x20Start\x20clonning\x20repository','removeComponents','defineProperty','object','COMPONENTS_PER_TICK'];a181_0x4e1e=function(){return _0x4f7402;};return a181_0x4e1e();}CommitComponentsJob=__decorate([typedi_1[a181_0x436049(0x135)]({'transient':!![]}),__metadata(a181_0x436049(0x160),[auth_settings_service_1[a181_0x436049(0x162)]])],CommitComponentsJob),exports[a181_0x436049(0x154)]=CommitComponentsJob;