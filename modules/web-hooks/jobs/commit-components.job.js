const a181_0x656293=a181_0x3e84;(function(_0x290045,_0x417318){const _0x1c69da=a181_0x3e84,_0x9e50c1=_0x290045();while(!![]){try{const _0x4fd13b=parseInt(_0x1c69da(0xed))/0x1+-parseInt(_0x1c69da(0xda))/0x2+parseInt(_0x1c69da(0xea))/0x3*(parseInt(_0x1c69da(0x121))/0x4)+-parseInt(_0x1c69da(0x105))/0x5+parseInt(_0x1c69da(0xcc))/0x6+-parseInt(_0x1c69da(0x132))/0x7*(parseInt(_0x1c69da(0x122))/0x8)+parseInt(_0x1c69da(0x12f))/0x9;if(_0x4fd13b===_0x417318)break;else _0x9e50c1['push'](_0x9e50c1['shift']());}catch(_0x9bad65){_0x9e50c1['push'](_0x9e50c1['shift']());}}}(a181_0x3405,0xeacb0));const a181_0x31acb5=(function(){let _0x2a2500=!![];return function(_0x328a74,_0x9ce2b9){const _0x564a86=_0x2a2500?function(){const _0x5b57cf=a181_0x3e84;if(_0x9ce2b9){const _0x1e2e42=_0x9ce2b9[_0x5b57cf(0x113)](_0x328a74,arguments);return _0x9ce2b9=null,_0x1e2e42;}}:function(){};return _0x2a2500=![],_0x564a86;};}()),a181_0x3f3105=a181_0x31acb5(this,function(){const _0x1b51b8=a181_0x3e84;return a181_0x3f3105[_0x1b51b8(0xcb)]()['search'](_0x1b51b8(0xd5))[_0x1b51b8(0xcb)]()[_0x1b51b8(0x140)](a181_0x3f3105)[_0x1b51b8(0xec)]('(((.+)+)+)+$');});a181_0x3f3105();'use strict';var __createBinding=this&&this[a181_0x656293(0x109)]||(Object[a181_0x656293(0xe2)]?function(_0x5b9e77,_0x3d7874,_0x2b85c2,_0x38e337){const _0x2d8d62=a181_0x656293;if(_0x38e337===undefined)_0x38e337=_0x2b85c2;Object[_0x2d8d62(0x137)](_0x5b9e77,_0x38e337,{'enumerable':!![],'get':function(){return _0x3d7874[_0x2b85c2];}});}:function(_0x1d68bb,_0x3e7337,_0x28ec93,_0x51fc69){if(_0x51fc69===undefined)_0x51fc69=_0x28ec93;_0x1d68bb[_0x51fc69]=_0x3e7337[_0x28ec93];}),__setModuleDefault=this&&this[a181_0x656293(0x13b)]||(Object[a181_0x656293(0xe2)]?function(_0x1a72ae,_0x4eab93){const _0x52e06d=a181_0x656293;Object[_0x52e06d(0x137)](_0x1a72ae,'default',{'enumerable':!![],'value':_0x4eab93});}:function(_0x1b62f3,_0x4dff33){_0x1b62f3['default']=_0x4dff33;}),__decorate=this&&this[a181_0x656293(0x107)]||function(_0x350015,_0x2db01d,_0x1a588c,_0x529ee2){const _0x4a5609=a181_0x656293;var _0x384380=arguments[_0x4a5609(0x11d)],_0x55ad7c=_0x384380<0x3?_0x2db01d:_0x529ee2===null?_0x529ee2=Object[_0x4a5609(0xcd)](_0x2db01d,_0x1a588c):_0x529ee2,_0x28c18e;if(typeof Reflect==='object'&&typeof Reflect[_0x4a5609(0xf5)]==='function')_0x55ad7c=Reflect[_0x4a5609(0xf5)](_0x350015,_0x2db01d,_0x1a588c,_0x529ee2);else{for(var _0x5051fd=_0x350015[_0x4a5609(0x11d)]-0x1;_0x5051fd>=0x0;_0x5051fd--)if(_0x28c18e=_0x350015[_0x5051fd])_0x55ad7c=(_0x384380<0x3?_0x28c18e(_0x55ad7c):_0x384380>0x3?_0x28c18e(_0x2db01d,_0x1a588c,_0x55ad7c):_0x28c18e(_0x2db01d,_0x1a588c))||_0x55ad7c;}return _0x384380>0x3&&_0x55ad7c&&Object[_0x4a5609(0x137)](_0x2db01d,_0x1a588c,_0x55ad7c),_0x55ad7c;},__importStar=this&&this[a181_0x656293(0xdf)]||function(_0x2d46df){const _0x339730=a181_0x656293;if(_0x2d46df&&_0x2d46df[_0x339730(0xf6)])return _0x2d46df;var _0x3d0653={};if(_0x2d46df!=null){for(var _0x4a43ad in _0x2d46df)if(_0x4a43ad!=='default'&&Object[_0x339730(0xfa)][_0x339730(0x111)][_0x339730(0x127)](_0x2d46df,_0x4a43ad))__createBinding(_0x3d0653,_0x2d46df,_0x4a43ad);}return __setModuleDefault(_0x3d0653,_0x2d46df),_0x3d0653;},__metadata=this&&this['__metadata']||function(_0x5381e0,_0x11ca27){const _0x2521d0=a181_0x656293;if(typeof Reflect===_0x2521d0(0xdc)&&typeof Reflect[_0x2521d0(0x11f)]===_0x2521d0(0x141))return Reflect[_0x2521d0(0x11f)](_0x5381e0,_0x11ca27);},__importDefault=this&&this['__importDefault']||function(_0x16e185){const _0x5c5e99=a181_0x656293;return _0x16e185&&_0x16e185[_0x5c5e99(0xf6)]?_0x16e185:{'default':_0x16e185};};Object[a181_0x656293(0x137)](exports,a181_0x656293(0xf6),{'value':!![]}),exports[a181_0x656293(0x115)]=void 0x0;const auth_settings_service_1=require(a181_0x656293(0xe6)),commit_components_dto_1=require(a181_0x656293(0xcf)),events_1=__importDefault(require(a181_0x656293(0xf8))),git_utils_1=require(a181_0x656293(0xd8)),mdapi_utils_1=require(a181_0x656293(0xdd)),sfdx_utils_1=require(a181_0x656293(0x10c)),typedi_1=__importStar(require(a181_0x656293(0x11a))),child_types_1=__importDefault(require(a181_0x656293(0xf7))),utils_1=require(a181_0x656293(0xf2)),salesforce_logger_v2_service_1=require(a181_0x656293(0x112)),constants_1=require(a181_0x656293(0xe0)),bitbucket_api_service_1=require('../../git-api/services/bitbucket-api.service'),sfdx_utils_2=require(a181_0x656293(0x13d)),fs_internal_1=require('../../internal/fs.internal'),path_1=require('path');function a181_0x3405(){const _0x7bac50=['gitUtils','master','clearDir','hasOwnProperty','../../salesforce/services/salesforce-logger-v2.service','apply','startTime','CommitComponentsJob','MDApiUtils','COMPONENTS_PER_TICK','removeDir','sfLogger','typedi','run','isSFDXProject','length','now','metadata','mdapiUtils','60EICyxE','4614960wQQqSr','[INFO]\x20Preparing\x20to\x20write\x20components','fileName','ms.\x20Committed\x20components\x20-\x20','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','call','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','groupComponentsByFileName','[INFO]\x20Start\x20converting\x20to\x20SFDX','deleted','replace','force-app','branch','10886400wvhJES','type','cleanUp','14wwdCLU','gitUrl','GitUtils','getProtocol','provider','defineProperty','[INFO]\x20Wrote\x20','writeComponents','[INFO]\x20Start\x20clonning\x20repository','__setModuleDefault','splice','../../salesforce/utils/sfdx.utils','removeComponents','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','constructor','function','includes','dir','componentsToDelete','toString','5250588UtevTR','getOwnPropertyDescriptor','get','../dto/commit-components.dto','SFDX','copyMdapiTo','design:paramtypes','[INFO]\x20Preparing\x20to\x20delete\x20components','writed','(((.+)+)+)+$','force','AuthSettingsService','../utils/git.utils','send','1233566nETsTj','bitbucket','object','../utils/mdapi.utils','writeFlosumComponents','__importStar','../../../constants','getLoggerId','create','fileType','getRemote','BitbucketApiService','../../shared/services/auth-settings.service','CommitComponentsDto','catch','components','86289QYJQMG','default','search','666695WQGDND','sfdxUtils','push','sort','Service','../../shared/utils','reduce','name','decorate','__esModule','../../parsers/data/child-types','events','getCredentialsFor','prototype','getPrefix','[INFO]\x20Deleted\x20','componentsToWrite','authSettings','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','SalesforceLogger2','exec','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','\x20components','commitData','2253015ULHGte','log','__decorate','SFDXUtils','__createBinding','prepareMdapi','copyProjectTo','../utils/sfdx.utils','://'];a181_0x3405=function(){return _0x7bac50;};return a181_0x3405();}let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(_0x3d2acc){const _0x1334a4=a181_0x656293;super(),this[_0x1334a4(0xfe)]=_0x3d2acc,this['COMPONENTS_PER_TICK']=0x3e8,this[_0x1334a4(0xfd)]=0x0,this[_0x1334a4(0xca)]=0x0,this[_0x1334a4(0x114)]=Date[_0x1334a4(0x11e)]();}async[a181_0x656293(0xe4)](){const _0x2601b3=a181_0x656293,{repo:_0xe45163}=this[_0x2601b3(0x104)];let _0x35727d=this[_0x2601b3(0xfe)][_0x2601b3(0xf9)](this['commitData'][_0x2601b3(0x136)]);if(this[_0x2601b3(0x104)][_0x2601b3(0x136)]===_0x2601b3(0xdb)){const _0x4060dd=typedi_1[_0x2601b3(0xeb)][_0x2601b3(0xce)](bitbucket_api_service_1[_0x2601b3(0xe5)]);await _0x4060dd['isLoggedIn'](),_0x35727d+=encodeURIComponent(_0x4060dd['getAccessToken']());}return _0xe45163[_0x2601b3(0x133)][_0x2601b3(0x12c)](/http(s)?:\/\/(.+@)?/,utils_1[_0x2601b3(0x135)](_0xe45163[_0x2601b3(0x133)])+_0x2601b3(0x10d)+_0x35727d+'@');}[a181_0x656293(0x129)](_0x1fc60e){const _0x35875e=a181_0x656293;var _0x44a666;_0x1fc60e['sort'](_0x2191f2=>child_types_1['default'][_0x35875e(0x142)](_0x2191f2[_0x35875e(0xe3)])?0x1:-0x1);const _0x56f570={};for(const _0xd4e55e of _0x1fc60e){_0x56f570[_0x44a666=_0xd4e55e[_0x35875e(0x124)]]||(_0x56f570[_0x44a666]=[]),_0x56f570[_0xd4e55e[_0x35875e(0x124)]][_0x35875e(0xef)](_0xd4e55e);}return Object['values'](_0x56f570)[_0x35875e(0xf3)]((_0x31a8a7,_0x3acbe9)=>[..._0x31a8a7,..._0x3acbe9],[]);}async['writeComponents'](_0x3136d8){const _0x1f0fb9=a181_0x656293;_0x3136d8=this[_0x1f0fb9(0x129)](_0x3136d8);let _0x4f1b84=0x0;while(_0x3136d8[_0x1f0fb9(0x11d)]){const _0x463bcb=_0x3136d8['splice'](0x0,this[_0x1f0fb9(0x117)]);await this['mdapiUtils'][_0x1f0fb9(0xde)](_0x463bcb,{'skipChildErrors':this[_0x1f0fb9(0x104)][_0x1f0fb9(0x12e)][_0x1f0fb9(0xf4)]===_0x1f0fb9(0x10f)}),_0x4f1b84+=_0x463bcb[_0x1f0fb9(0x11d)],this['sfLogger'][_0x1f0fb9(0x106)](_0x1f0fb9(0x138)+_0x4f1b84+'/'+this[_0x1f0fb9(0xfd)]+_0x1f0fb9(0x103)),await this['sfLogger']['send']();}}async[a181_0x656293(0x13e)](_0x4c085b){const _0x6a0ffe=a181_0x656293;_0x4c085b[_0x6a0ffe(0xf0)](_0x4101de=>child_types_1[_0x6a0ffe(0xeb)][_0x6a0ffe(0x142)](_0x4101de[_0x6a0ffe(0x130)])?-0x1:0x1);let _0x371f92=0x0;while(_0x4c085b[_0x6a0ffe(0x11d)]){const _0x1cbd57=_0x4c085b[_0x6a0ffe(0x13c)](0x0,this[_0x6a0ffe(0x117)]);await this[_0x6a0ffe(0x120)][_0x6a0ffe(0x13e)](_0x1cbd57),_0x371f92+=_0x1cbd57['length'],this[_0x6a0ffe(0x119)]['log'](_0x6a0ffe(0xfc)+_0x371f92+'/'+this[_0x6a0ffe(0xca)]+'\x20components'),await this['sfLogger'][_0x6a0ffe(0xd9)]();}}async['cleanUp'](){const _0x208f30=a181_0x656293;this[_0x208f30(0x10e)]&&await this[_0x208f30(0x10e)]['removeDir']()[_0x208f30(0xe8)](()=>void 0x0),this[_0x208f30(0x120)]&&await this[_0x208f30(0x120)][_0x208f30(0x118)]()['catch'](()=>void 0x0),this[_0x208f30(0xee)]&&await this[_0x208f30(0xee)][_0x208f30(0x118)]()[_0x208f30(0xe8)](()=>void 0x0);}async[a181_0x656293(0x101)](){const _0x4f8f8d=a181_0x656293,{repo:_0x3ec603,branch:_0x408f05,components:_0x5cfd92,convertToSFDX:_0x1cae39,message:_0x1e8b63,user:_0x25490e}=this[_0x4f8f8d(0x104)];this[_0x4f8f8d(0x120)]=new mdapi_utils_1[(_0x4f8f8d(0x116))](),this[_0x4f8f8d(0x10e)]=new git_utils_1[(_0x4f8f8d(0x134))](await this[_0x4f8f8d(0xe4)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x4f8f8d(0x108))]();let _0x1564af=_0x1cae39;try{this['sfLogger'][_0x4f8f8d(0x106)](_0x4f8f8d(0x13a)),await this[_0x4f8f8d(0x10e)]['clone'](_0x408f05[_0x4f8f8d(0xf4)],_0x3ec603['name']);!this[_0x4f8f8d(0x104)][_0x4f8f8d(0xd6)]?(this[_0x4f8f8d(0x119)]['log']('[INFO]\x20Prepare\x20mdapi\x20files'),await this[_0x4f8f8d(0x120)][_0x4f8f8d(0x10a)](this[_0x4f8f8d(0x10e)][_0x4f8f8d(0xc9)])):this[_0x4f8f8d(0x119)][_0x4f8f8d(0x106)](_0x4f8f8d(0x102));_0x5cfd92[_0x4f8f8d(0xd4)]&&(this['sfLogger'][_0x4f8f8d(0x106)](_0x4f8f8d(0x123)),this[_0x4f8f8d(0xfd)]=_0x5cfd92[_0x4f8f8d(0xd4)]['length'],await this[_0x4f8f8d(0x139)](_0x5cfd92[_0x4f8f8d(0xd4)]),await this[_0x4f8f8d(0x119)]['send']());_0x5cfd92['deleted']&&(this['sfLogger'][_0x4f8f8d(0x106)](_0x4f8f8d(0xd3)),this[_0x4f8f8d(0xca)]=_0x5cfd92[_0x4f8f8d(0x12b)][_0x4f8f8d(0x11d)],await this[_0x4f8f8d(0x13e)](_0x5cfd92[_0x4f8f8d(0x12b)]),await this[_0x4f8f8d(0x119)][_0x4f8f8d(0xd9)]());await this[_0x4f8f8d(0x119)][_0x4f8f8d(0xd9)]();const _0xefc7c0=await fs_internal_1['FS']['isEmptyDir'](this[_0x4f8f8d(0x10e)][_0x4f8f8d(0xc9)]);await sfdx_utils_2[_0x4f8f8d(0xd0)][_0x4f8f8d(0x11c)](this['gitUtils'][_0x4f8f8d(0xc9)])?(_0x1564af=!![],await fs_internal_1['FS'][_0x4f8f8d(0x118)](path_1['join'](this['gitUtils'][_0x4f8f8d(0xc9)],_0x4f8f8d(0x12d)))):(_0x1564af&&(!_0xefc7c0&&(_0x1564af=![])),await this['gitUtils'][_0x4f8f8d(0x110)]());_0x1564af?(this['sfLogger'][_0x4f8f8d(0x106)](_0x4f8f8d(0x12a)),await this[_0x4f8f8d(0xee)]['createProjectFrom'](this[_0x4f8f8d(0x120)][_0x4f8f8d(0xc9)]),await this[_0x4f8f8d(0xee)][_0x4f8f8d(0x10b)](this[_0x4f8f8d(0x10e)][_0x4f8f8d(0xc9)],!_0xefc7c0),await this[_0x4f8f8d(0xee)][_0x4f8f8d(0x118)](),await this[_0x4f8f8d(0x119)][_0x4f8f8d(0xd9)]()):(this[_0x4f8f8d(0x119)][_0x4f8f8d(0x106)](_0x4f8f8d(0x13f)),await this['mdapiUtils'][_0x4f8f8d(0xd1)](this['gitUtils'][_0x4f8f8d(0xc9)]),await this[_0x4f8f8d(0x119)][_0x4f8f8d(0xd9)]());this['sfLogger'][_0x4f8f8d(0x106)](_0x4f8f8d(0x126)),await this['gitUtils']['commitAndPush'](_0x1e8b63,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x25490e[_0x4f8f8d(0xf4)]},_0x408f05[_0x4f8f8d(0xf4)]),await this['gitUtils'][_0x4f8f8d(0x118)](),await this[_0x4f8f8d(0x120)][_0x4f8f8d(0x118)]();const _0x1c3ca1=this['componentsToWrite']+this[_0x4f8f8d(0xca)];this[_0x4f8f8d(0x119)][_0x4f8f8d(0x106)](_0x4f8f8d(0x128)+(Date[_0x4f8f8d(0x11e)]()-this[_0x4f8f8d(0x114)])+_0x4f8f8d(0x125)+_0x1c3ca1),await this[_0x4f8f8d(0x119)][_0x4f8f8d(0xd9)]();}catch(_0x3ec4b7){await this[_0x4f8f8d(0x131)](),this[_0x4f8f8d(0x119)][_0x4f8f8d(0x106)]('[ERROR]\x20'+_0x3ec4b7),await this[_0x4f8f8d(0x119)]['send']();throw _0x3ec4b7;}}async[a181_0x656293(0x11b)](_0x3c61a7,_0x50ff5c){const _0x55de97=a181_0x656293;var _0x285375,_0x4ac3e3;this[_0x55de97(0x119)]=new salesforce_logger_v2_service_1[(_0x55de97(0x100))](_0x50ff5c[_0x55de97(0xe1)](),_0x50ff5c[_0x55de97(0xfb)]()+'\x20['+commit_components_dto_1[_0x55de97(0xe7)]['name']+']');const _0x3c4443=!!((_0x285375=_0x3c61a7[_0x55de97(0xe9)])===null||_0x285375===void 0x0?void 0x0:_0x285375['writed'])||!!((_0x4ac3e3=_0x3c61a7[_0x55de97(0xe9)])===null||_0x4ac3e3===void 0x0?void 0x0:_0x4ac3e3[_0x55de97(0x12b)]);if(!_0x3c4443){this[_0x55de97(0x119)][_0x55de97(0x106)](_0x55de97(0xff)),await this[_0x55de97(0x119)][_0x55de97(0xd9)]();return;}this[_0x55de97(0x104)]=_0x3c61a7,await this['exec']();}};function a181_0x3e84(_0x299c62,_0x503acf){const _0x5b3995=a181_0x3405();return a181_0x3e84=function(_0x3f3105,_0x31acb5){_0x3f3105=_0x3f3105-0xc9;let _0x340587=_0x5b3995[_0x3f3105];return _0x340587;},a181_0x3e84(_0x299c62,_0x503acf);}CommitComponentsJob=__decorate([typedi_1[a181_0x656293(0xf1)]({'transient':!![]}),__metadata(a181_0x656293(0xd2),[auth_settings_service_1[a181_0x656293(0xd7)]])],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;