const a181_0x28a75b=a181_0xd5bf;(function(_0x26e1be,_0x89b695){const _0x562b02=a181_0xd5bf,_0xee37c0=_0x26e1be();while(!![]){try{const _0x55f2e0=parseInt(_0x562b02(0x1c8))/0x1+parseInt(_0x562b02(0x1d0))/0x2*(-parseInt(_0x562b02(0x192))/0x3)+parseInt(_0x562b02(0x1e6))/0x4*(parseInt(_0x562b02(0x1e0))/0x5)+-parseInt(_0x562b02(0x18a))/0x6*(parseInt(_0x562b02(0x1d3))/0x7)+parseInt(_0x562b02(0x193))/0x8*(-parseInt(_0x562b02(0x1cb))/0x9)+parseInt(_0x562b02(0x1fa))/0xa*(parseInt(_0x562b02(0x1b6))/0xb)+-parseInt(_0x562b02(0x1a2))/0xc*(parseInt(_0x562b02(0x1d7))/0xd);if(_0x55f2e0===_0x89b695)break;else _0xee37c0['push'](_0xee37c0['shift']());}catch(_0x77e08b){_0xee37c0['push'](_0xee37c0['shift']());}}}(a181_0x5a87,0xe4eb0));const a181_0xa47ad=(function(){let _0x28789e=!![];return function(_0x47f950,_0x15e1ed){const _0x5504c7=_0x28789e?function(){const _0x33b5c1=a181_0xd5bf;if(_0x15e1ed){const _0x26375b=_0x15e1ed[_0x33b5c1(0x1c9)](_0x47f950,arguments);return _0x15e1ed=null,_0x26375b;}}:function(){};return _0x28789e=![],_0x5504c7;};}()),a181_0x1b0982=a181_0xa47ad(this,function(){const _0x503cf8=a181_0xd5bf;return a181_0x1b0982['toString']()[_0x503cf8(0x1ed)]('(((.+)+)+)+$')[_0x503cf8(0x1a8)]()[_0x503cf8(0x1c4)](a181_0x1b0982)[_0x503cf8(0x1ed)](_0x503cf8(0x1f7));});a181_0x1b0982();'use strict';var __createBinding=this&&this[a181_0x28a75b(0x1f8)]||(Object[a181_0x28a75b(0x19f)]?function(_0x1009fd,_0x47b228,_0x459e0b,_0x267dcb){if(_0x267dcb===undefined)_0x267dcb=_0x459e0b;Object['defineProperty'](_0x1009fd,_0x267dcb,{'enumerable':!![],'get':function(){return _0x47b228[_0x459e0b];}});}:function(_0x480cce,_0x260e2a,_0x4c3963,_0x500771){if(_0x500771===undefined)_0x500771=_0x4c3963;_0x480cce[_0x500771]=_0x260e2a[_0x4c3963];}),__setModuleDefault=this&&this[a181_0x28a75b(0x1d4)]||(Object[a181_0x28a75b(0x19f)]?function(_0x54bee9,_0x38491b){const _0x28e9d8=a181_0x28a75b;Object[_0x28e9d8(0x1ad)](_0x54bee9,_0x28e9d8(0x1f0),{'enumerable':!![],'value':_0x38491b});}:function(_0x5317b1,_0xd3da6f){_0x5317b1['default']=_0xd3da6f;}),__decorate=this&&this[a181_0x28a75b(0x18d)]||function(_0x3a0969,_0x24da28,_0xa8a115,_0x408ba5){const _0x45a355=a181_0x28a75b;var _0x44f732=arguments[_0x45a355(0x1e9)],_0x11cd7c=_0x44f732<0x3?_0x24da28:_0x408ba5===null?_0x408ba5=Object['getOwnPropertyDescriptor'](_0x24da28,_0xa8a115):_0x408ba5,_0x4ec04a;if(typeof Reflect==='object'&&typeof Reflect[_0x45a355(0x1af)]===_0x45a355(0x182))_0x11cd7c=Reflect[_0x45a355(0x1af)](_0x3a0969,_0x24da28,_0xa8a115,_0x408ba5);else{for(var _0x599118=_0x3a0969[_0x45a355(0x1e9)]-0x1;_0x599118>=0x0;_0x599118--)if(_0x4ec04a=_0x3a0969[_0x599118])_0x11cd7c=(_0x44f732<0x3?_0x4ec04a(_0x11cd7c):_0x44f732>0x3?_0x4ec04a(_0x24da28,_0xa8a115,_0x11cd7c):_0x4ec04a(_0x24da28,_0xa8a115))||_0x11cd7c;}return _0x44f732>0x3&&_0x11cd7c&&Object[_0x45a355(0x1ad)](_0x24da28,_0xa8a115,_0x11cd7c),_0x11cd7c;},__importStar=this&&this[a181_0x28a75b(0x1bb)]||function(_0x3f9d66){const _0x476200=a181_0x28a75b;if(_0x3f9d66&&_0x3f9d66[_0x476200(0x197)])return _0x3f9d66;var _0x4180c5={};if(_0x3f9d66!=null){for(var _0xf7dc93 in _0x3f9d66)if(_0xf7dc93!==_0x476200(0x1f0)&&Object['prototype'][_0x476200(0x18f)][_0x476200(0x190)](_0x3f9d66,_0xf7dc93))__createBinding(_0x4180c5,_0x3f9d66,_0xf7dc93);}return __setModuleDefault(_0x4180c5,_0x3f9d66),_0x4180c5;},__metadata=this&&this[a181_0x28a75b(0x17e)]||function(_0x418037,_0x1b9b49){const _0x63f3c6=a181_0x28a75b;if(typeof Reflect===_0x63f3c6(0x18c)&&typeof Reflect[_0x63f3c6(0x1e2)]===_0x63f3c6(0x182))return Reflect[_0x63f3c6(0x1e2)](_0x418037,_0x1b9b49);},__importDefault=this&&this[a181_0x28a75b(0x1b1)]||function(_0x455ed0){const _0x166aba=a181_0x28a75b;return _0x455ed0&&_0x455ed0[_0x166aba(0x197)]?_0x455ed0:{'default':_0x455ed0};};Object[a181_0x28a75b(0x1ad)](exports,'__esModule',{'value':!![]}),exports[a181_0x28a75b(0x194)]=void 0x0;function a181_0x5a87(){const _0x4a25fa=['SFDXUtils','constructor','\x20components','getRemote','writeFlosumComponents','1714673wlFgTn','apply','gitUrl','18haelbF','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','../../../constants','isLoggedIn','typedi','1138fujArH','SalesforceLogger2','../utils/mdapi.utils','3381NWCyAX','__setModuleDefault','removeDir','send','78qxzWcj','now','getPrefix','mdapiUtils','getAccessToken','COMPONENTS_PER_TICK','path','../../shared/services/auth-settings.service','[INFO]\x20Start\x20converting\x20to\x20SFDX','4755325IxwpuI','startTime','metadata','ms.\x20Committed\x20components\x20-\x20','exec','getProtocol','4uZyQWL','splice','branch','length','[INFO]\x20Preparing\x20to\x20write\x20components','../../internal/fs.internal','design:paramtypes','search','[INFO]\x20Prepare\x20mdapi\x20files','writeComponents','default','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','dir','sort','get','name','[INFO]\x20Preparing\x20to\x20delete\x20components','(((.+)+)+)+$','__createBinding','getCredentialsFor','20IgAhrM','Service','__metadata','deleted','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','[ERROR]\x20','function','SFDX','groupComponentsByFileName','prepareMdapi','componentsToWrite','reduce','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','../utils/git.utils','21282hwoPQR','fileName','object','__decorate','copyMdapiTo','hasOwnProperty','call','sfLogger','3063kuvikh','2524216XStwkL','CommitComponentsJob','../../salesforce/utils/sfdx.utils','../dto/commit-components.dto','__esModule','[INFO]\x20Start\x20clonning\x20repository','getLoggerId','[INFO]\x20Deleted\x20','authSettings','createProjectFrom','isEmptyDir','log','create','sfdxUtils','gitUtils','1173384FJRVuZ','../../parsers/data/child-types','includes','://','fileType','values','toString','isSFDXProject','cleanUp','push','removeComponents','defineProperty','catch','decorate','MDApiUtils','__importDefault','clone','DEFAULT_GIT_USER_EMAIL','commitData','writed','9810933iWUWhS','[INFO]\x20Wrote\x20','../../git-api/services/bitbucket-api.service','copyProjectTo','provider','__importStar','componentsToDelete','components','force','bitbucket','master','GitUtils','force-app'];a181_0x5a87=function(){return _0x4a25fa;};return a181_0x5a87();}const auth_settings_service_1=require(a181_0x28a75b(0x1de)),commit_components_dto_1=require(a181_0x28a75b(0x196)),events_1=__importDefault(require('events')),git_utils_1=require(a181_0x28a75b(0x189)),mdapi_utils_1=require(a181_0x28a75b(0x1d2)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a181_0x28a75b(0x1cf))),child_types_1=__importDefault(require(a181_0x28a75b(0x1a3))),utils_1=require('../../shared/utils'),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),constants_1=require(a181_0x28a75b(0x1cd)),bitbucket_api_service_1=require(a181_0x28a75b(0x1b8)),sfdx_utils_2=require(a181_0x28a75b(0x195)),fs_internal_1=require(a181_0x28a75b(0x1eb)),path_1=require(a181_0x28a75b(0x1dd));let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(_0xd18310){const _0x496fed=a181_0x28a75b;super(),this[_0x496fed(0x19b)]=_0xd18310,this['COMPONENTS_PER_TICK']=0x3e8,this['componentsToWrite']=0x0,this[_0x496fed(0x1bc)]=0x0,this[_0x496fed(0x1e1)]=Date[_0x496fed(0x1d8)]();}async['getRemote'](){const _0x7f2a6c=a181_0x28a75b,{repo:_0x21c1eb}=this[_0x7f2a6c(0x1b4)];let _0x4e1875=this[_0x7f2a6c(0x19b)][_0x7f2a6c(0x1f9)](this[_0x7f2a6c(0x1b4)][_0x7f2a6c(0x1ba)]);if(this[_0x7f2a6c(0x1b4)][_0x7f2a6c(0x1ba)]===_0x7f2a6c(0x1bf)){const _0x506c4f=typedi_1[_0x7f2a6c(0x1f0)][_0x7f2a6c(0x1f4)](bitbucket_api_service_1['BitbucketApiService']);await _0x506c4f[_0x7f2a6c(0x1ce)](),_0x4e1875+=encodeURIComponent(_0x506c4f[_0x7f2a6c(0x1db)]());}return _0x21c1eb[_0x7f2a6c(0x1ca)]['replace'](/http(s)?\:\/\/(.+@)?/,utils_1[_0x7f2a6c(0x1e5)](_0x21c1eb[_0x7f2a6c(0x1ca)])+_0x7f2a6c(0x1a5)+_0x4e1875+'@');}['groupComponentsByFileName'](_0x3d9f5a){const _0x4cb2a6=a181_0x28a75b;var _0x43b92b;_0x3d9f5a[_0x4cb2a6(0x1f3)](_0x24c8cb=>child_types_1[_0x4cb2a6(0x1f0)]['includes'](_0x24c8cb[_0x4cb2a6(0x1a6)])?0x1:-0x1);const _0x4e8ed1={};for(const _0x48c66a of _0x3d9f5a){_0x4e8ed1[_0x43b92b=_0x48c66a[_0x4cb2a6(0x18b)]]||(_0x4e8ed1[_0x43b92b]=[]),_0x4e8ed1[_0x48c66a['fileName']][_0x4cb2a6(0x1ab)](_0x48c66a);}return Object[_0x4cb2a6(0x1a7)](_0x4e8ed1)[_0x4cb2a6(0x187)]((_0xd41569,_0x14a992)=>[..._0xd41569,..._0x14a992],[]);}async[a181_0x28a75b(0x1ef)](_0x15a98a){const _0x227012=a181_0x28a75b;_0x15a98a=this[_0x227012(0x184)](_0x15a98a);let _0x5db413=0x0;while(_0x15a98a[_0x227012(0x1e9)]){const _0x25ee32=_0x15a98a[_0x227012(0x1e7)](0x0,this[_0x227012(0x1dc)]);await this[_0x227012(0x1da)][_0x227012(0x1c7)](_0x25ee32,{'skipChildErrors':this['commitData'][_0x227012(0x1e8)][_0x227012(0x1f5)]===_0x227012(0x1c0)}),_0x5db413+=_0x25ee32['length'],this['sfLogger'][_0x227012(0x19e)](_0x227012(0x1b7)+_0x5db413+'/'+this[_0x227012(0x186)]+_0x227012(0x1c5)),await this[_0x227012(0x191)][_0x227012(0x1d6)]();}}async[a181_0x28a75b(0x1ac)](_0x2503b6){const _0x59c17a=a181_0x28a75b;_0x2503b6[_0x59c17a(0x1f3)](_0x2b5cc3=>child_types_1[_0x59c17a(0x1f0)][_0x59c17a(0x1a4)](_0x2b5cc3['type'])?-0x1:0x1);let _0x196075=0x0;while(_0x2503b6['length']){const _0x257630=_0x2503b6[_0x59c17a(0x1e7)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils'][_0x59c17a(0x1ac)](_0x257630),_0x196075+=_0x257630[_0x59c17a(0x1e9)],this[_0x59c17a(0x191)][_0x59c17a(0x19e)](_0x59c17a(0x19a)+_0x196075+'/'+this[_0x59c17a(0x1bc)]+_0x59c17a(0x1c5)),await this['sfLogger'][_0x59c17a(0x1d6)]();}}async[a181_0x28a75b(0x1aa)](){const _0x2c70d5=a181_0x28a75b;this[_0x2c70d5(0x1a1)]&&await this[_0x2c70d5(0x1a1)][_0x2c70d5(0x1d5)]()[_0x2c70d5(0x1ae)](()=>void 0x0),this['mdapiUtils']&&await this[_0x2c70d5(0x1da)][_0x2c70d5(0x1d5)]()[_0x2c70d5(0x1ae)](()=>void 0x0),this[_0x2c70d5(0x1a0)]&&await this[_0x2c70d5(0x1a0)][_0x2c70d5(0x1d5)]()[_0x2c70d5(0x1ae)](()=>void 0x0);}async['exec'](){const _0x2bb464=a181_0x28a75b,{repo:_0x45e98b,branch:_0x4dcb6d,components:_0x582a56,convertToSFDX:_0x127411,message:_0x2f6263,user:_0x1c380f}=this[_0x2bb464(0x1b4)];this[_0x2bb464(0x1da)]=new mdapi_utils_1[(_0x2bb464(0x1b0))](_0x45e98b[_0x2bb464(0x1f5)],_0x4dcb6d['name']),this[_0x2bb464(0x1a1)]=new git_utils_1[(_0x2bb464(0x1c1))](await this[_0x2bb464(0x1c6)]()),this[_0x2bb464(0x1a0)]=new sfdx_utils_1[(_0x2bb464(0x1c3))](_0x45e98b[_0x2bb464(0x1f5)],_0x4dcb6d[_0x2bb464(0x1f5)]);let _0xbd5586=_0x127411;try{this[_0x2bb464(0x191)]['log'](_0x2bb464(0x198)),await this['gitUtils'][_0x2bb464(0x1b2)](_0x4dcb6d[_0x2bb464(0x1f5)],_0x45e98b[_0x2bb464(0x1f5)]);!this[_0x2bb464(0x1b4)][_0x2bb464(0x1be)]?(this['sfLogger'][_0x2bb464(0x19e)](_0x2bb464(0x1ee)),await this[_0x2bb464(0x1da)][_0x2bb464(0x185)](this[_0x2bb464(0x1a1)][_0x2bb464(0x1f2)])):this[_0x2bb464(0x191)][_0x2bb464(0x19e)]('[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');_0x582a56[_0x2bb464(0x1b5)]&&(this['sfLogger'][_0x2bb464(0x19e)](_0x2bb464(0x1ea)),this[_0x2bb464(0x186)]=_0x582a56[_0x2bb464(0x1b5)]['length'],await this[_0x2bb464(0x1ef)](_0x582a56['writed']),await this[_0x2bb464(0x191)]['send']());_0x582a56[_0x2bb464(0x17f)]&&(this[_0x2bb464(0x191)][_0x2bb464(0x19e)](_0x2bb464(0x1f6)),this[_0x2bb464(0x1bc)]=_0x582a56[_0x2bb464(0x17f)]['length'],await this[_0x2bb464(0x1ac)](_0x582a56[_0x2bb464(0x17f)]),await this[_0x2bb464(0x191)][_0x2bb464(0x1d6)]());await this[_0x2bb464(0x191)]['send']();await sfdx_utils_2[_0x2bb464(0x183)][_0x2bb464(0x1a9)](this[_0x2bb464(0x1a1)]['dir'])?(_0xbd5586=!![],await fs_internal_1['FS'][_0x2bb464(0x1d5)](path_1['join'](this[_0x2bb464(0x1a1)][_0x2bb464(0x1f2)],_0x2bb464(0x1c2)))):(_0xbd5586&&(!await fs_internal_1['FS'][_0x2bb464(0x19d)](this['gitUtils'][_0x2bb464(0x1f2)])&&(_0xbd5586=![])),await this['gitUtils']['clearDir']());_0xbd5586?(this[_0x2bb464(0x191)][_0x2bb464(0x19e)](_0x2bb464(0x1df)),await this[_0x2bb464(0x1a0)][_0x2bb464(0x19c)](this[_0x2bb464(0x1da)][_0x2bb464(0x1f2)]),await this[_0x2bb464(0x1a0)][_0x2bb464(0x1b9)](this[_0x2bb464(0x1a1)]['dir']),await this[_0x2bb464(0x1a0)]['removeDir'](),await this['sfLogger'][_0x2bb464(0x1d6)]()):(this['sfLogger']['log'](_0x2bb464(0x1f1)),await this[_0x2bb464(0x1da)][_0x2bb464(0x18e)](this[_0x2bb464(0x1a1)][_0x2bb464(0x1f2)]),await this['sfLogger'][_0x2bb464(0x1d6)]());this[_0x2bb464(0x191)][_0x2bb464(0x19e)](_0x2bb464(0x1cc)),await this[_0x2bb464(0x1a1)]['commitAndPush'](_0x2f6263,{'email':constants_1[_0x2bb464(0x1b3)],'name':_0x1c380f[_0x2bb464(0x1f5)]},_0x4dcb6d[_0x2bb464(0x1f5)]),await this[_0x2bb464(0x1a1)][_0x2bb464(0x1d5)](),await this[_0x2bb464(0x1da)]['removeDir']();const _0x309e7c=this[_0x2bb464(0x186)]+this[_0x2bb464(0x1bc)];this['sfLogger'][_0x2bb464(0x19e)](_0x2bb464(0x180)+(Date[_0x2bb464(0x1d8)]()-this[_0x2bb464(0x1e1)])+_0x2bb464(0x1e3)+_0x309e7c),await this['sfLogger']['send']();}catch(_0x22fecf){await this[_0x2bb464(0x1aa)](),this['sfLogger']['log'](_0x2bb464(0x181)+_0x22fecf),await this[_0x2bb464(0x191)]['send']();throw _0x22fecf;}}async['run'](_0x413f7a,_0x3e4bf8){const _0x335e2c=a181_0x28a75b;var _0x1f91d9,_0x4f4608;this[_0x335e2c(0x191)]=new salesforce_logger_v2_service_1[(_0x335e2c(0x1d1))](_0x3e4bf8[_0x335e2c(0x199)](),_0x3e4bf8[_0x335e2c(0x1d9)]()+'\x20['+commit_components_dto_1['CommitComponentsDto']['name']+']');const _0x1e4333=!!((_0x1f91d9=_0x413f7a[_0x335e2c(0x1bd)])===null||_0x1f91d9===void 0x0?void 0x0:_0x1f91d9[_0x335e2c(0x1b5)])||!!((_0x4f4608=_0x413f7a[_0x335e2c(0x1bd)])===null||_0x4f4608===void 0x0?void 0x0:_0x4f4608['deleted']);if(!_0x1e4333){this[_0x335e2c(0x191)][_0x335e2c(0x19e)](_0x335e2c(0x188)),await this[_0x335e2c(0x191)][_0x335e2c(0x1d6)]();return;}this[_0x335e2c(0x1b4)]=_0x413f7a,await this[_0x335e2c(0x1e4)]();}};function a181_0xd5bf(_0x25af81,_0x22d99d){const _0x1750f7=a181_0x5a87();return a181_0xd5bf=function(_0x1b0982,_0xa47ad){_0x1b0982=_0x1b0982-0x17d;let _0x5a87ba=_0x1750f7[_0x1b0982];return _0x5a87ba;},a181_0xd5bf(_0x25af81,_0x22d99d);}CommitComponentsJob=__decorate([typedi_1[a181_0x28a75b(0x17d)]({'transient':!![]}),__metadata(a181_0x28a75b(0x1ec),[auth_settings_service_1['AuthSettingsService']])],CommitComponentsJob),exports[a181_0x28a75b(0x194)]=CommitComponentsJob;