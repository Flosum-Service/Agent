function a181_0x3695(_0x59a8e5,_0xb996d3){const _0x11d7bb=a181_0x2ef8();return a181_0x3695=function(_0x1ecb6a,_0x8f4638){_0x1ecb6a=_0x1ecb6a-0xdf;let _0x2ef81b=_0x11d7bb[_0x1ecb6a];return _0x2ef81b;},a181_0x3695(_0x59a8e5,_0xb996d3);}const a181_0x32036c=a181_0x3695;(function(_0x56d67c,_0x50a04b){const _0x2c1515=a181_0x3695,_0x547c34=_0x56d67c();while(!![]){try{const _0x11e30a=-parseInt(_0x2c1515(0xe5))/0x1+parseInt(_0x2c1515(0x106))/0x2+parseInt(_0x2c1515(0x125))/0x3*(parseInt(_0x2c1515(0x11b))/0x4)+parseInt(_0x2c1515(0x10f))/0x5*(parseInt(_0x2c1515(0xf8))/0x6)+parseInt(_0x2c1515(0xe7))/0x7+parseInt(_0x2c1515(0x133))/0x8*(-parseInt(_0x2c1515(0xfd))/0x9)+-parseInt(_0x2c1515(0x122))/0xa;if(_0x11e30a===_0x50a04b)break;else _0x547c34['push'](_0x547c34['shift']());}catch(_0x2e8631){_0x547c34['push'](_0x547c34['shift']());}}}(a181_0x2ef8,0x82c79));const a181_0x8f4638=(function(){let _0x4ddc86=!![];return function(_0x96df5d,_0x554ac2){const _0x3c530a=_0x4ddc86?function(){const _0x397a5e=a181_0x3695;if(_0x554ac2){const _0x5ef00=_0x554ac2[_0x397a5e(0xea)](_0x96df5d,arguments);return _0x554ac2=null,_0x5ef00;}}:function(){};return _0x4ddc86=![],_0x3c530a;};}()),a181_0x1ecb6a=a181_0x8f4638(this,function(){const _0x2f4e5e=a181_0x3695;return a181_0x1ecb6a[_0x2f4e5e(0xf4)]()[_0x2f4e5e(0x113)]('(((.+)+)+)+$')[_0x2f4e5e(0xf4)]()[_0x2f4e5e(0x108)](a181_0x1ecb6a)[_0x2f4e5e(0x113)](_0x2f4e5e(0x13c));});a181_0x1ecb6a();'use strict';var __createBinding=this&&this[a181_0x32036c(0x101)]||(Object[a181_0x32036c(0xe3)]?function(_0x2c8438,_0x2738fd,_0x299cff,_0x302cf3){const _0x3381d8=a181_0x32036c;if(_0x302cf3===undefined)_0x302cf3=_0x299cff;Object[_0x3381d8(0x128)](_0x2c8438,_0x302cf3,{'enumerable':!![],'get':function(){return _0x2738fd[_0x299cff];}});}:function(_0x2dfaef,_0x4c6671,_0x3f4feb,_0x3ecfe2){if(_0x3ecfe2===undefined)_0x3ecfe2=_0x3f4feb;_0x2dfaef[_0x3ecfe2]=_0x4c6671[_0x3f4feb];}),__setModuleDefault=this&&this[a181_0x32036c(0x154)]||(Object['create']?function(_0x9ee171,_0x1d5f52){const _0x5edac0=a181_0x32036c;Object[_0x5edac0(0x128)](_0x9ee171,_0x5edac0(0x12e),{'enumerable':!![],'value':_0x1d5f52});}:function(_0x3032b1,_0x439307){const _0x425425=a181_0x32036c;_0x3032b1[_0x425425(0x12e)]=_0x439307;}),__decorate=this&&this[a181_0x32036c(0x115)]||function(_0x359143,_0x5d8245,_0x141b9a,_0x566898){const _0x1b6e07=a181_0x32036c;var _0x199c4c=arguments[_0x1b6e07(0xf3)],_0xcc8f08=_0x199c4c<0x3?_0x5d8245:_0x566898===null?_0x566898=Object[_0x1b6e07(0x114)](_0x5d8245,_0x141b9a):_0x566898,_0x15b354;if(typeof Reflect==='object'&&typeof Reflect[_0x1b6e07(0xed)]===_0x1b6e07(0x10c))_0xcc8f08=Reflect['decorate'](_0x359143,_0x5d8245,_0x141b9a,_0x566898);else{for(var _0x43972c=_0x359143[_0x1b6e07(0xf3)]-0x1;_0x43972c>=0x0;_0x43972c--)if(_0x15b354=_0x359143[_0x43972c])_0xcc8f08=(_0x199c4c<0x3?_0x15b354(_0xcc8f08):_0x199c4c>0x3?_0x15b354(_0x5d8245,_0x141b9a,_0xcc8f08):_0x15b354(_0x5d8245,_0x141b9a))||_0xcc8f08;}return _0x199c4c>0x3&&_0xcc8f08&&Object[_0x1b6e07(0x128)](_0x5d8245,_0x141b9a,_0xcc8f08),_0xcc8f08;},__importStar=this&&this[a181_0x32036c(0x138)]||function(_0x5071fa){const _0x4d6db1=a181_0x32036c;if(_0x5071fa&&_0x5071fa[_0x4d6db1(0xf9)])return _0x5071fa;var _0x2503ea={};if(_0x5071fa!=null){for(var _0x57d76d in _0x5071fa)if(_0x57d76d!==_0x4d6db1(0x12e)&&Object[_0x4d6db1(0x12c)][_0x4d6db1(0x152)]['call'](_0x5071fa,_0x57d76d))__createBinding(_0x2503ea,_0x5071fa,_0x57d76d);}return __setModuleDefault(_0x2503ea,_0x5071fa),_0x2503ea;},__metadata=this&&this[a181_0x32036c(0xe1)]||function(_0x408f4f,_0x2802dd){const _0x544f6d=a181_0x32036c;if(typeof Reflect==='object'&&typeof Reflect[_0x544f6d(0x134)]==='function')return Reflect['metadata'](_0x408f4f,_0x2802dd);},__importDefault=this&&this[a181_0x32036c(0x13d)]||function(_0x2c1aba){const _0x12e1b3=a181_0x32036c;return _0x2c1aba&&_0x2c1aba[_0x12e1b3(0xf9)]?_0x2c1aba:{'default':_0x2c1aba};};Object[a181_0x32036c(0x128)](exports,a181_0x32036c(0xf9),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const auth_settings_service_1=require('../../shared/services/auth-settings.service'),commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a181_0x32036c(0x146))),git_utils_1=require(a181_0x32036c(0xe8)),mdapi_utils_1=require(a181_0x32036c(0xef)),sfdx_utils_1=require(a181_0x32036c(0xec)),typedi_1=__importStar(require(a181_0x32036c(0x10d))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require('../../shared/utils'),salesforce_logger_v2_service_1=require(a181_0x32036c(0x109)),constants_1=require('../../../constants'),bitbucket_api_service_1=require(a181_0x32036c(0x130)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a181_0x32036c(0x111)),path_1=require('path');function a181_0x2ef8(){const _0x109c26=['metadata','clearDir','getRemote','design:paramtypes','__importStar','values','[INFO]\x20Wrote\x20','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','(((.+)+)+)+$','__importDefault','CommitComponentsJob','isLoggedIn','BitbucketApiService','sfLogger','authSettings','\x20components','force-app','gitUtils','events','COMPONENTS_PER_TICK','SFDXUtils','ms.\x20Committed\x20components\x20-\x20','clone','deleted','SalesforceLogger2','groupComponentsByFileName','CommitComponentsDto','commitAndPush','mdapiUtils','catch','hasOwnProperty','fileType','__setModuleDefault','componentsToWrite','includes','__metadata','dir','create','[INFO]\x20Prepare\x20mdapi\x20files','537204pxRcxM','://','7286993ZoozGW','../utils/git.utils','writeComponents','apply','getAccessToken','../utils/sfdx.utils','decorate','componentsToDelete','../utils/mdapi.utils','run','provider','getLoggerId','length','toString','name','getCredentialsFor','getProtocol','8172AFTAKl','__esModule','fileName','log','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','9OiDQqU','cleanUp','startTime','commitData','__createBinding','DEFAULT_GIT_USER_EMAIL','removeComponents','MDApiUtils','[INFO]\x20Start\x20clonning\x20repository','2042736kSZTmL','now','constructor','../../salesforce/services/salesforce-logger-v2.service','gitUrl','splice','function','typedi','sort','3845SNyQaA','master','../../internal/fs.internal','replace','search','getOwnPropertyDescriptor','__decorate','reduce','createProjectFrom','send','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','sfdxUtils','92840dViiCq','force','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','branch','exec','copyMdapiTo','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','25596570tlvVjn','removeDir','writeFlosumComponents','69UqbNfi','[INFO]\x20Start\x20converting\x20to\x20SFDX','getPrefix','defineProperty','bitbucket','push','isEmptyDir','prototype','GitUtils','default','isSFDXProject','../../git-api/services/bitbucket-api.service','writed','Service','88328ZlYIgN'];a181_0x2ef8=function(){return _0x109c26;};return a181_0x2ef8();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x32036c(0x12e)]{constructor(_0x55aa18){const _0x1d28ed=a181_0x32036c;super(),this[_0x1d28ed(0x142)]=_0x55aa18,this['COMPONENTS_PER_TICK']=0x3e8,this[_0x1d28ed(0xdf)]=0x0,this[_0x1d28ed(0xee)]=0x0,this[_0x1d28ed(0xff)]=Date[_0x1d28ed(0x107)]();}async[a181_0x32036c(0x136)](){const _0x111ba0=a181_0x32036c,{repo:_0xe6b531}=this[_0x111ba0(0x100)];let _0xfca3b9=this[_0x111ba0(0x142)][_0x111ba0(0xf6)](this[_0x111ba0(0x100)][_0x111ba0(0xf1)]);if(this[_0x111ba0(0x100)][_0x111ba0(0xf1)]===_0x111ba0(0x129)){const _0x1a3fc8=typedi_1[_0x111ba0(0x12e)]['get'](bitbucket_api_service_1[_0x111ba0(0x140)]);await _0x1a3fc8[_0x111ba0(0x13f)](),_0xfca3b9+=encodeURIComponent(_0x1a3fc8[_0x111ba0(0xeb)]());}return _0xe6b531['gitUrl'][_0x111ba0(0x112)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x111ba0(0xf7)](_0xe6b531[_0x111ba0(0x10a)])+_0x111ba0(0xe6)+_0xfca3b9+'@');}[a181_0x32036c(0x14d)](_0x19e37f){const _0xabc873=a181_0x32036c;var _0x2af1e2;_0x19e37f['sort'](_0x5cca24=>child_types_1[_0xabc873(0x12e)][_0xabc873(0xe0)](_0x5cca24[_0xabc873(0x153)])?0x1:-0x1);const _0x2220c0={};for(const _0x162f66 of _0x19e37f){_0x2220c0[_0x2af1e2=_0x162f66[_0xabc873(0xfa)]]||(_0x2220c0[_0x2af1e2]=[]),_0x2220c0[_0x162f66['fileName']][_0xabc873(0x12a)](_0x162f66);}return Object[_0xabc873(0x139)](_0x2220c0)[_0xabc873(0x116)]((_0x21cc41,_0x44f7d9)=>[..._0x21cc41,..._0x44f7d9],[]);}async[a181_0x32036c(0xe9)](_0x39bc50){const _0x2207f7=a181_0x32036c;_0x39bc50=this[_0x2207f7(0x14d)](_0x39bc50);let _0x12b937=0x0;while(_0x39bc50['length']){const _0x48acb6=_0x39bc50[_0x2207f7(0x10b)](0x0,this[_0x2207f7(0x147)]);await this[_0x2207f7(0x150)][_0x2207f7(0x124)](_0x48acb6,{'skipChildErrors':this[_0x2207f7(0x100)][_0x2207f7(0x11e)][_0x2207f7(0xf5)]===_0x2207f7(0x110)}),_0x12b937+=_0x48acb6['length'],this[_0x2207f7(0x141)][_0x2207f7(0xfb)](_0x2207f7(0x13a)+_0x12b937+'/'+this[_0x2207f7(0xdf)]+_0x2207f7(0x143)),await this[_0x2207f7(0x141)][_0x2207f7(0x118)]();}}async[a181_0x32036c(0x103)](_0x48688c){const _0x2eb30d=a181_0x32036c;_0x48688c[_0x2eb30d(0x10e)](_0x1430cd=>child_types_1[_0x2eb30d(0x12e)][_0x2eb30d(0xe0)](_0x1430cd['type'])?-0x1:0x1);let _0x3cb685=0x0;while(_0x48688c[_0x2eb30d(0xf3)]){const _0x4f42f0=_0x48688c[_0x2eb30d(0x10b)](0x0,this[_0x2eb30d(0x147)]);await this[_0x2eb30d(0x150)][_0x2eb30d(0x103)](_0x4f42f0),_0x3cb685+=_0x4f42f0['length'],this['sfLogger'][_0x2eb30d(0xfb)]('[INFO]\x20Deleted\x20'+_0x3cb685+'/'+this['componentsToDelete']+_0x2eb30d(0x143)),await this[_0x2eb30d(0x141)][_0x2eb30d(0x118)]();}}async[a181_0x32036c(0xfe)](){const _0x2bd7d3=a181_0x32036c;this[_0x2bd7d3(0x145)]&&await this[_0x2bd7d3(0x145)][_0x2bd7d3(0x123)]()[_0x2bd7d3(0x151)](()=>void 0x0),this[_0x2bd7d3(0x150)]&&await this['mdapiUtils'][_0x2bd7d3(0x123)]()['catch'](()=>void 0x0),this[_0x2bd7d3(0x11a)]&&await this[_0x2bd7d3(0x11a)]['removeDir']()[_0x2bd7d3(0x151)](()=>void 0x0);}async['exec'](){const _0x574f48=a181_0x32036c,{repo:_0x55dbe9,branch:_0x398772,components:_0x5cc714,convertToSFDX:_0x3a482e,message:_0x5a5cc5,user:_0x1b9a9b}=this[_0x574f48(0x100)];this[_0x574f48(0x150)]=new mdapi_utils_1[(_0x574f48(0x104))](_0x55dbe9[_0x574f48(0xf5)],_0x398772[_0x574f48(0xf5)]),this[_0x574f48(0x145)]=new git_utils_1[(_0x574f48(0x12d))](await this[_0x574f48(0x136)]()),this[_0x574f48(0x11a)]=new sfdx_utils_1[(_0x574f48(0x148))](_0x55dbe9[_0x574f48(0xf5)],_0x398772[_0x574f48(0xf5)]);let _0x6106fc=_0x3a482e;try{this['sfLogger'][_0x574f48(0xfb)](_0x574f48(0x105)),await this[_0x574f48(0x145)][_0x574f48(0x14a)](_0x398772[_0x574f48(0xf5)],_0x55dbe9[_0x574f48(0xf5)]);!this[_0x574f48(0x100)][_0x574f48(0x11c)]?(this['sfLogger'][_0x574f48(0xfb)](_0x574f48(0xe4)),await this[_0x574f48(0x150)]['prepareMdapi'](this[_0x574f48(0x145)][_0x574f48(0xe2)])):this[_0x574f48(0x141)][_0x574f48(0xfb)](_0x574f48(0x11d));_0x5cc714[_0x574f48(0x131)]&&(this[_0x574f48(0x141)][_0x574f48(0xfb)]('[INFO]\x20Preparing\x20to\x20write\x20components'),this[_0x574f48(0xdf)]=_0x5cc714[_0x574f48(0x131)][_0x574f48(0xf3)],await this[_0x574f48(0xe9)](_0x5cc714[_0x574f48(0x131)]),await this[_0x574f48(0x141)][_0x574f48(0x118)]());_0x5cc714['deleted']&&(this[_0x574f48(0x141)][_0x574f48(0xfb)]('[INFO]\x20Preparing\x20to\x20delete\x20components'),this['componentsToDelete']=_0x5cc714[_0x574f48(0x14b)][_0x574f48(0xf3)],await this[_0x574f48(0x103)](_0x5cc714[_0x574f48(0x14b)]),await this[_0x574f48(0x141)][_0x574f48(0x118)]());await this[_0x574f48(0x141)][_0x574f48(0x118)]();await sfdx_utils_2['SFDX'][_0x574f48(0x12f)](this[_0x574f48(0x145)][_0x574f48(0xe2)])?(_0x6106fc=!![],await fs_internal_1['FS'][_0x574f48(0x123)](path_1['join'](this[_0x574f48(0x145)][_0x574f48(0xe2)],_0x574f48(0x144)))):(_0x6106fc&&(!await fs_internal_1['FS'][_0x574f48(0x12b)](this[_0x574f48(0x145)][_0x574f48(0xe2)])&&(_0x6106fc=![])),await this[_0x574f48(0x145)][_0x574f48(0x135)]());_0x6106fc?(this['sfLogger'][_0x574f48(0xfb)](_0x574f48(0x126)),await this[_0x574f48(0x11a)][_0x574f48(0x117)](this[_0x574f48(0x150)][_0x574f48(0xe2)]),await this[_0x574f48(0x11a)]['copyProjectTo'](this[_0x574f48(0x145)][_0x574f48(0xe2)]),await this['sfdxUtils']['removeDir'](),await this[_0x574f48(0x141)]['send']()):(this[_0x574f48(0x141)][_0x574f48(0xfb)](_0x574f48(0x119)),await this[_0x574f48(0x150)][_0x574f48(0x120)](this[_0x574f48(0x145)]['dir']),await this[_0x574f48(0x141)][_0x574f48(0x118)]());this[_0x574f48(0x141)]['log'](_0x574f48(0x121)),await this[_0x574f48(0x145)][_0x574f48(0x14f)](_0x5a5cc5,{'email':constants_1[_0x574f48(0x102)],'name':_0x1b9a9b[_0x574f48(0xf5)]},_0x398772[_0x574f48(0xf5)]),await this[_0x574f48(0x145)][_0x574f48(0x123)](),await this[_0x574f48(0x150)][_0x574f48(0x123)]();const _0x39ec01=this[_0x574f48(0xdf)]+this[_0x574f48(0xee)];this['sfLogger'][_0x574f48(0xfb)](_0x574f48(0xfc)+(Date['now']()-this[_0x574f48(0xff)])+_0x574f48(0x149)+_0x39ec01),await this[_0x574f48(0x141)][_0x574f48(0x118)]();}catch(_0x267c9a){await this[_0x574f48(0xfe)](),this['sfLogger'][_0x574f48(0xfb)]('[ERROR]\x20'+_0x267c9a),await this[_0x574f48(0x141)][_0x574f48(0x118)]();throw _0x267c9a;}}async[a181_0x32036c(0xf0)](_0x18a323,_0x411ecf){const _0x2fde1f=a181_0x32036c;var _0x4d2b4a,_0x42b6c5;this[_0x2fde1f(0x141)]=new salesforce_logger_v2_service_1[(_0x2fde1f(0x14c))](_0x411ecf[_0x2fde1f(0xf2)](),_0x411ecf[_0x2fde1f(0x127)]()+'\x20['+commit_components_dto_1[_0x2fde1f(0x14e)]['name']+']');const _0x5494f6=!!((_0x4d2b4a=_0x18a323['components'])===null||_0x4d2b4a===void 0x0?void 0x0:_0x4d2b4a[_0x2fde1f(0x131)])||!!((_0x42b6c5=_0x18a323['components'])===null||_0x42b6c5===void 0x0?void 0x0:_0x42b6c5[_0x2fde1f(0x14b)]);if(!_0x5494f6){this['sfLogger'][_0x2fde1f(0xfb)](_0x2fde1f(0x13b)),await this[_0x2fde1f(0x141)]['send']();return;}this[_0x2fde1f(0x100)]=_0x18a323,await this[_0x2fde1f(0x11f)]();}};CommitComponentsJob=__decorate([typedi_1[a181_0x32036c(0x132)]({'transient':!![]}),__metadata(a181_0x32036c(0x137),[auth_settings_service_1['AuthSettingsService']])],CommitComponentsJob),exports[a181_0x32036c(0x13e)]=CommitComponentsJob;