const a182_0x37f488=a182_0xbb0a;(function(_0x1fe29d,_0x1b202e){const _0x1da0f8=a182_0xbb0a,_0x4e2ec1=_0x1fe29d();while(!![]){try{const _0x36190a=parseInt(_0x1da0f8(0x124))/0x1+-parseInt(_0x1da0f8(0x143))/0x2*(parseInt(_0x1da0f8(0x161))/0x3)+-parseInt(_0x1da0f8(0x12d))/0x4*(parseInt(_0x1da0f8(0x11b))/0x5)+-parseInt(_0x1da0f8(0x153))/0x6+parseInt(_0x1da0f8(0x116))/0x7*(parseInt(_0x1da0f8(0x156))/0x8)+parseInt(_0x1da0f8(0x17e))/0x9+-parseInt(_0x1da0f8(0x154))/0xa*(-parseInt(_0x1da0f8(0x148))/0xb);if(_0x36190a===_0x1b202e)break;else _0x4e2ec1['push'](_0x4e2ec1['shift']());}catch(_0x4cae67){_0x4e2ec1['push'](_0x4e2ec1['shift']());}}}(a182_0x47af,0x81f39));function a182_0x47af(){const _0x2b6a57=['commitData','../../shared/utils','SFDXUtils','values','reduce','groupComponentsByFileName','copyMdapiTo','385tVAOty','AuthSettingsService','design:paramtypes','hasOwnProperty','fileName','2592505DizWJK','__metadata','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','exec','getRemote','defineProperty','gitUrl','mdapiUtils','fileType','773993CfpWrF','events','startTime','run','getCredentialsFor','getAccessToken','push','ms.\x20Committed\x20components\x20-\x20','../../shared/services/auth-settings.service','8YXEwyE','length','SalesforceLogger2','componentsToWrite','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','SFDX','(((.+)+)+)+$','../../salesforce/utils/sfdx.utils','../../parsers/data/child-types','CommitComponentsDto','object','__decorate','removeComponents','metadata','getProtocol','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','__importStar','__esModule','../utils/mdapi.utils','getOwnPropertyDescriptor','\x20components','splice','28MpVUAu','prototype','send','DEFAULT_GIT_USER_EMAIL','[INFO]\x20Deleted\x20','496474nPIRim','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','sfLogger','replace','writed','log','apply','BitbucketApiService','toString','dir','function','799998lWSSaB','190BFSkwO','components','95792mdATGa','default','GitUtils','force-app','authSettings','__createBinding','catch','://','decorate','typedi','[INFO]\x20Wrote\x20','143628HjMYHL','__importDefault','../../salesforce/services/salesforce-logger-v2.service','[ERROR]\x20','isEmptyDir','sort','bitbucket','includes','[INFO]\x20Start\x20converting\x20to\x20SFDX','gitUtils','isLoggedIn','../utils/git.utils','deleted','COMPONENTS_PER_TICK','isSFDXProject','search','sfdxUtils','name','getPrefix','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','CommitComponentsJob','provider','[INFO]\x20Preparing\x20to\x20write\x20components','now','removeDir','get','join','../dto/commit-components.dto','componentsToDelete','744939pBXQSD'];a182_0x47af=function(){return _0x2b6a57;};return a182_0x47af();}const a182_0x16a95d=(function(){let _0x761274=!![];return function(_0x2a58c8,_0x4adf6a){const _0xd46c18=_0x761274?function(){const _0x2f9eb8=a182_0xbb0a;if(_0x4adf6a){const _0x20d136=_0x4adf6a[_0x2f9eb8(0x14e)](_0x2a58c8,arguments);return _0x4adf6a=null,_0x20d136;}}:function(){};return _0x761274=![],_0xd46c18;};}()),a182_0x4bb0cc=a182_0x16a95d(this,function(){const _0x1c1157=a182_0xbb0a;return a182_0x4bb0cc[_0x1c1157(0x150)]()[_0x1c1157(0x170)](_0x1c1157(0x133))[_0x1c1157(0x150)]()['constructor'](a182_0x4bb0cc)[_0x1c1157(0x170)](_0x1c1157(0x133));});function a182_0xbb0a(_0x4c7e4c,_0x28e34c){const _0x586d25=a182_0x47af();return a182_0xbb0a=function(_0x4bb0cc,_0x16a95d){_0x4bb0cc=_0x4bb0cc-0x112;let _0x47afe3=_0x586d25[_0x4bb0cc];return _0x47afe3;},a182_0xbb0a(_0x4c7e4c,_0x28e34c);}a182_0x4bb0cc();'use strict';var __createBinding=this&&this[a182_0x37f488(0x15b)]||(Object['create']?function(_0x81fd79,_0x94fda,_0xbc20be,_0x1fb07a){const _0xed8cad=a182_0x37f488;if(_0x1fb07a===undefined)_0x1fb07a=_0xbc20be;Object[_0xed8cad(0x120)](_0x81fd79,_0x1fb07a,{'enumerable':!![],'get':function(){return _0x94fda[_0xbc20be];}});}:function(_0xc79d76,_0x30bd8b,_0x3ecfc3,_0x48ecad){if(_0x48ecad===undefined)_0x48ecad=_0x3ecfc3;_0xc79d76[_0x48ecad]=_0x30bd8b[_0x3ecfc3];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x110a42,_0xb425d3){const _0x51056b=a182_0x37f488;Object[_0x51056b(0x120)](_0x110a42,'default',{'enumerable':!![],'value':_0xb425d3});}:function(_0x23adbd,_0x54e00b){const _0x178b04=a182_0x37f488;_0x23adbd[_0x178b04(0x157)]=_0x54e00b;}),__decorate=this&&this[a182_0x37f488(0x138)]||function(_0x1e5b4c,_0x2ab931,_0x2c2301,_0x23916a){const _0x174c5a=a182_0x37f488;var _0x57a122=arguments[_0x174c5a(0x12e)],_0x5a6264=_0x57a122<0x3?_0x2ab931:_0x23916a===null?_0x23916a=Object[_0x174c5a(0x140)](_0x2ab931,_0x2c2301):_0x23916a,_0x5c720c;if(typeof Reflect===_0x174c5a(0x137)&&typeof Reflect[_0x174c5a(0x15e)]===_0x174c5a(0x152))_0x5a6264=Reflect[_0x174c5a(0x15e)](_0x1e5b4c,_0x2ab931,_0x2c2301,_0x23916a);else{for(var _0x2672c2=_0x1e5b4c[_0x174c5a(0x12e)]-0x1;_0x2672c2>=0x0;_0x2672c2--)if(_0x5c720c=_0x1e5b4c[_0x2672c2])_0x5a6264=(_0x57a122<0x3?_0x5c720c(_0x5a6264):_0x57a122>0x3?_0x5c720c(_0x2ab931,_0x2c2301,_0x5a6264):_0x5c720c(_0x2ab931,_0x2c2301))||_0x5a6264;}return _0x57a122>0x3&&_0x5a6264&&Object[_0x174c5a(0x120)](_0x2ab931,_0x2c2301,_0x5a6264),_0x5a6264;},__importStar=this&&this[a182_0x37f488(0x13d)]||function(_0x475364){const _0x20992b=a182_0x37f488;if(_0x475364&&_0x475364[_0x20992b(0x13e)])return _0x475364;var _0x483004={};if(_0x475364!=null){for(var _0x341a79 in _0x475364)if(_0x341a79!=='default'&&Object[_0x20992b(0x144)][_0x20992b(0x119)]['call'](_0x475364,_0x341a79))__createBinding(_0x483004,_0x475364,_0x341a79);}return __setModuleDefault(_0x483004,_0x475364),_0x483004;},__metadata=this&&this[a182_0x37f488(0x11c)]||function(_0x5ef06a,_0x3f4f52){const _0x5c589a=a182_0x37f488;if(typeof Reflect===_0x5c589a(0x137)&&typeof Reflect[_0x5c589a(0x13a)]===_0x5c589a(0x152))return Reflect['metadata'](_0x5ef06a,_0x3f4f52);},__importDefault=this&&this[a182_0x37f488(0x162)]||function(_0x3c0e22){const _0x1dc988=a182_0x37f488;return _0x3c0e22&&_0x3c0e22[_0x1dc988(0x13e)]?_0x3c0e22:{'default':_0x3c0e22};};Object[a182_0x37f488(0x120)](exports,a182_0x37f488(0x13e),{'value':!![]}),exports[a182_0x37f488(0x175)]=void 0x0;const auth_settings_service_1=require(a182_0x37f488(0x12c)),commit_components_dto_1=require(a182_0x37f488(0x17c)),events_1=__importDefault(require(a182_0x37f488(0x125))),git_utils_1=require(a182_0x37f488(0x16c)),mdapi_utils_1=require(a182_0x37f488(0x13f)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a182_0x37f488(0x15f))),child_types_1=__importDefault(require(a182_0x37f488(0x135))),utils_1=require(a182_0x37f488(0x180)),salesforce_logger_v2_service_1=require(a182_0x37f488(0x163)),constants_1=require('../../../constants'),bitbucket_api_service_1=require('../../git-api/services/bitbucket-api.service'),sfdx_utils_2=require(a182_0x37f488(0x134)),fs_internal_1=require('../../internal/fs.internal'),path_1=require('path');let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(_0x9e6e45){const _0x29a3f8=a182_0x37f488;super(),this[_0x29a3f8(0x15a)]=_0x9e6e45,this[_0x29a3f8(0x16e)]=0x3e8,this['componentsToWrite']=0x0,this[_0x29a3f8(0x17d)]=0x0,this[_0x29a3f8(0x126)]=Date['now']();}async['getRemote'](){const _0x22de5e=a182_0x37f488,{repo:_0x3b99d2}=this[_0x22de5e(0x17f)];let _0x49796f=this['authSettings'][_0x22de5e(0x128)](this[_0x22de5e(0x17f)][_0x22de5e(0x176)]);if(this['commitData']['provider']===_0x22de5e(0x167)){const _0x276e31=typedi_1[_0x22de5e(0x157)][_0x22de5e(0x17a)](bitbucket_api_service_1[_0x22de5e(0x14f)]);await _0x276e31[_0x22de5e(0x16b)](),_0x49796f+=encodeURIComponent(_0x276e31[_0x22de5e(0x129)]());}return _0x3b99d2[_0x22de5e(0x121)][_0x22de5e(0x14b)](/http(s)?:\/\/(.+@)?/,utils_1[_0x22de5e(0x13b)](_0x3b99d2[_0x22de5e(0x121)])+_0x22de5e(0x15d)+_0x49796f+'@');}[a182_0x37f488(0x114)](_0x65a2c6){const _0x2356aa=a182_0x37f488;var _0x61408a;_0x65a2c6[_0x2356aa(0x166)](_0x2ccadb=>child_types_1[_0x2356aa(0x157)][_0x2356aa(0x168)](_0x2ccadb[_0x2356aa(0x123)])?0x1:-0x1);const _0x37c4e5={};for(const _0x36983d of _0x65a2c6){_0x37c4e5[_0x61408a=_0x36983d[_0x2356aa(0x11a)]]||(_0x37c4e5[_0x61408a]=[]),_0x37c4e5[_0x36983d[_0x2356aa(0x11a)]][_0x2356aa(0x12a)](_0x36983d);}return Object[_0x2356aa(0x112)](_0x37c4e5)[_0x2356aa(0x113)]((_0x3b6e7b,_0x55287f)=>[..._0x3b6e7b,..._0x55287f],[]);}async['writeComponents'](_0x58765d){const _0x4c2508=a182_0x37f488;_0x58765d=this[_0x4c2508(0x114)](_0x58765d);let _0x44ed40=0x0;while(_0x58765d[_0x4c2508(0x12e)]){const _0x46e3a3=_0x58765d[_0x4c2508(0x142)](0x0,this[_0x4c2508(0x16e)]);await this[_0x4c2508(0x122)]['writeFlosumComponents'](_0x46e3a3,{'skipChildErrors':this['commitData']['branch'][_0x4c2508(0x172)]==='master'}),_0x44ed40+=_0x46e3a3[_0x4c2508(0x12e)],this[_0x4c2508(0x14a)][_0x4c2508(0x14d)](_0x4c2508(0x160)+_0x44ed40+'/'+this[_0x4c2508(0x130)]+'\x20components'),await this[_0x4c2508(0x14a)][_0x4c2508(0x145)]();}}async[a182_0x37f488(0x139)](_0x49179f){const _0xca184d=a182_0x37f488;_0x49179f[_0xca184d(0x166)](_0x3de15a=>child_types_1['default'][_0xca184d(0x168)](_0x3de15a['type'])?-0x1:0x1);let _0x27d638=0x0;while(_0x49179f[_0xca184d(0x12e)]){const _0x318d4d=_0x49179f[_0xca184d(0x142)](0x0,this[_0xca184d(0x16e)]);await this['mdapiUtils'][_0xca184d(0x139)](_0x318d4d),_0x27d638+=_0x318d4d['length'],this[_0xca184d(0x14a)]['log'](_0xca184d(0x147)+_0x27d638+'/'+this[_0xca184d(0x17d)]+_0xca184d(0x141)),await this[_0xca184d(0x14a)]['send']();}}async['cleanUp'](){const _0x36f0e0=a182_0x37f488;this[_0x36f0e0(0x16a)]&&await this['gitUtils'][_0x36f0e0(0x179)]()[_0x36f0e0(0x15c)](()=>void 0x0),this['mdapiUtils']&&await this[_0x36f0e0(0x122)][_0x36f0e0(0x179)]()[_0x36f0e0(0x15c)](()=>void 0x0),this['sfdxUtils']&&await this[_0x36f0e0(0x171)][_0x36f0e0(0x179)]()[_0x36f0e0(0x15c)](()=>void 0x0);}async['exec'](){const _0x28f40d=a182_0x37f488,{repo:_0x8fd2b1,branch:_0x1dff86,components:_0x21fc92,convertToSFDX:_0x4027b4,message:_0x16c268,user:_0x954eff}=this[_0x28f40d(0x17f)];this['mdapiUtils']=new mdapi_utils_1['MDApiUtils'](),this[_0x28f40d(0x16a)]=new git_utils_1[(_0x28f40d(0x158))](await this[_0x28f40d(0x11f)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x28f40d(0x181))]();let _0x286571=_0x4027b4;try{this[_0x28f40d(0x14a)][_0x28f40d(0x14d)]('[INFO]\x20Start\x20clonning\x20repository'),await this[_0x28f40d(0x16a)]['clone'](_0x1dff86[_0x28f40d(0x172)],_0x8fd2b1['name']);!this[_0x28f40d(0x17f)]['force']?(this[_0x28f40d(0x14a)][_0x28f40d(0x14d)]('[INFO]\x20Prepare\x20mdapi\x20files'),await this[_0x28f40d(0x122)]['prepareMdapi'](this[_0x28f40d(0x16a)]['dir'])):this['sfLogger']['log'](_0x28f40d(0x13c));_0x21fc92[_0x28f40d(0x14c)]&&(this[_0x28f40d(0x14a)][_0x28f40d(0x14d)](_0x28f40d(0x177)),this['componentsToWrite']=_0x21fc92[_0x28f40d(0x14c)]['length'],await this['writeComponents'](_0x21fc92[_0x28f40d(0x14c)]),await this[_0x28f40d(0x14a)][_0x28f40d(0x145)]());_0x21fc92[_0x28f40d(0x16d)]&&(this['sfLogger'][_0x28f40d(0x14d)]('[INFO]\x20Preparing\x20to\x20delete\x20components'),this[_0x28f40d(0x17d)]=_0x21fc92[_0x28f40d(0x16d)]['length'],await this['removeComponents'](_0x21fc92[_0x28f40d(0x16d)]),await this[_0x28f40d(0x14a)]['send']());await this[_0x28f40d(0x14a)][_0x28f40d(0x145)]();const _0x4b9c3e=await fs_internal_1['FS'][_0x28f40d(0x165)](this[_0x28f40d(0x16a)][_0x28f40d(0x151)]);await sfdx_utils_2[_0x28f40d(0x132)][_0x28f40d(0x16f)](this[_0x28f40d(0x16a)][_0x28f40d(0x151)])?(_0x286571=!![],await fs_internal_1['FS'][_0x28f40d(0x179)](path_1[_0x28f40d(0x17b)](this[_0x28f40d(0x16a)][_0x28f40d(0x151)],_0x28f40d(0x159)))):(_0x286571&&(!_0x4b9c3e&&(_0x286571=![])),await this['gitUtils']['clearDir']());_0x286571?(this[_0x28f40d(0x14a)]['log'](_0x28f40d(0x169)),await this[_0x28f40d(0x171)]['createProjectFrom'](this['mdapiUtils'][_0x28f40d(0x151)]),await this['sfdxUtils']['copyProjectTo'](this[_0x28f40d(0x16a)][_0x28f40d(0x151)],!_0x4b9c3e),await this[_0x28f40d(0x171)][_0x28f40d(0x179)](),await this[_0x28f40d(0x14a)][_0x28f40d(0x145)]()):(this[_0x28f40d(0x14a)][_0x28f40d(0x14d)](_0x28f40d(0x131)),await this[_0x28f40d(0x122)][_0x28f40d(0x115)](this['gitUtils']['dir']),await this[_0x28f40d(0x14a)][_0x28f40d(0x145)]());this['sfLogger'][_0x28f40d(0x14d)](_0x28f40d(0x149)),await this[_0x28f40d(0x16a)]['commitAndPush'](_0x16c268,{'email':constants_1[_0x28f40d(0x146)],'name':_0x954eff['name']},_0x1dff86['name']),await this[_0x28f40d(0x16a)][_0x28f40d(0x179)](),await this[_0x28f40d(0x122)][_0x28f40d(0x179)]();const _0x2fb727=this['componentsToWrite']+this['componentsToDelete'];this[_0x28f40d(0x14a)][_0x28f40d(0x14d)](_0x28f40d(0x174)+(Date[_0x28f40d(0x178)]()-this['startTime'])+_0x28f40d(0x12b)+_0x2fb727),await this[_0x28f40d(0x14a)]['send']();}catch(_0x50d8bc){await this['cleanUp'](),this[_0x28f40d(0x14a)]['log'](_0x28f40d(0x164)+_0x50d8bc),await this[_0x28f40d(0x14a)][_0x28f40d(0x145)]();throw _0x50d8bc;}}async[a182_0x37f488(0x127)](_0x5011a9,_0xf01839){const _0x2f2d39=a182_0x37f488;var _0x21b3dc,_0x507149;this[_0x2f2d39(0x14a)]=new salesforce_logger_v2_service_1[(_0x2f2d39(0x12f))](_0xf01839['getLoggerId'](),_0xf01839[_0x2f2d39(0x173)]()+'\x20['+commit_components_dto_1[_0x2f2d39(0x136)]['name']+']');const _0x3d4529=!!((_0x21b3dc=_0x5011a9['components'])===null||_0x21b3dc===void 0x0?void 0x0:_0x21b3dc['writed'])||!!((_0x507149=_0x5011a9[_0x2f2d39(0x155)])===null||_0x507149===void 0x0?void 0x0:_0x507149[_0x2f2d39(0x16d)]);if(!_0x3d4529){this['sfLogger'][_0x2f2d39(0x14d)](_0x2f2d39(0x11d)),await this['sfLogger'][_0x2f2d39(0x145)]();return;}this['commitData']=_0x5011a9,await this[_0x2f2d39(0x11e)]();}};CommitComponentsJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a182_0x37f488(0x118),[auth_settings_service_1[a182_0x37f488(0x117)]])],CommitComponentsJob),exports[a182_0x37f488(0x175)]=CommitComponentsJob;