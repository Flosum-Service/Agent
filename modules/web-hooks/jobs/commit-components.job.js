const a181_0x3c9553=a181_0x2f08;function a181_0x4235(){const _0x2268f3=['SalesforceLogger2','function','../../internal/fs.internal','__importStar','deleted','fileName','../../git-api/services/bitbucket-api.service','splice','toString','log','BitbucketApiService','constructor','mdapiUtils','[ERROR]\x20','4455356WcTYrA','values','../../../constants','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','[INFO]\x20Deleted\x20','../../shared/utils','writed','run','authSettings','isLoggedIn','groupComponentsByFileName','prepareMdapi','clearDir','startTime','commitData','force','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','replace','getPrefix','reduce','apply','COMPONENTS_PER_TICK','type','push','../utils/git.utils','CommitComponentsDto','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','__decorate','AuthSettingsService','name','7uNoQTV','../utils/sfdx.utils','provider','DEFAULT_GIT_USER_EMAIL','(((.+)+)+)+$','getCredentialsFor','10DmSTzR','componentsToDelete','SFDX','length','MDApiUtils','componentsToWrite','send','copyProjectTo','968685bZNUjn','sfLogger','isEmptyDir','get','default','sfdxUtils','[INFO]\x20Start\x20converting\x20to\x20SFDX','defineProperty','\x20components','decorate','54270lfKrzo','10242256Dhteyf','now','cleanUp','writeComponents','master','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','../dto/commit-components.dto','1549914tNQqas','getOwnPropertyDescriptor','../../shared/services/auth-settings.service','removeComponents','dir','isSFDXProject','search','GitUtils','metadata','gitUrl','call','components','join','createProjectFrom','removeDir','create','copyMdapiTo','bitbucket','fileType','[INFO]\x20Wrote\x20','1109tJpTdC','object','includes','design:paramtypes','1978uxykZW','__setModuleDefault','getAccessToken','sort','getRemote','ms.\x20Committed\x20components\x20-\x20','catch','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','[INFO]\x20Prepare\x20mdapi\x20files','gitUtils','../../salesforce/utils/sfdx.utils','hasOwnProperty','22789422cXvOST','typedi','commitAndPush','__esModule','CommitComponentsJob','__createBinding','prototype','SFDXUtils','force-app'];a181_0x4235=function(){return _0x2268f3;};return a181_0x4235();}(function(_0x9db44,_0x3dec4a){const _0x150d32=a181_0x2f08,_0x102813=_0x9db44();while(!![]){try{const _0x5f3526=parseInt(_0x150d32(0x92))/0x1*(parseInt(_0x150d32(0x96))/0x2)+-parseInt(_0x150d32(0xe5))/0x3+-parseInt(_0x150d32(0xb9))/0x4+parseInt(_0x150d32(0xef))/0x5+-parseInt(_0x150d32(0xf7))/0x6*(parseInt(_0x150d32(0xd7))/0x7)+-parseInt(_0x150d32(0xf0))/0x8+-parseInt(_0x150d32(0xa2))/0x9*(-parseInt(_0x150d32(0xdd))/0xa);if(_0x5f3526===_0x3dec4a)break;else _0x102813['push'](_0x102813['shift']());}catch(_0xaa0f7a){_0x102813['push'](_0x102813['shift']());}}}(a181_0x4235,0xa239e));const a181_0x9e0a80=(function(){let _0x2cc6d4=!![];return function(_0x1e9d38,_0xc54992){const _0x20621a=_0x2cc6d4?function(){const _0x3597bc=a181_0x2f08;if(_0xc54992){const _0x3674bf=_0xc54992[_0x3597bc(0xcd)](_0x1e9d38,arguments);return _0xc54992=null,_0x3674bf;}}:function(){};return _0x2cc6d4=![],_0x20621a;};}()),a181_0x776eef=a181_0x9e0a80(this,function(){const _0x26e143=a181_0x2f08;return a181_0x776eef[_0x26e143(0xb3)]()[_0x26e143(0xfd)](_0x26e143(0xdb))['toString']()[_0x26e143(0xb6)](a181_0x776eef)[_0x26e143(0xfd)]('(((.+)+)+)+$');});a181_0x776eef();'use strict';var __createBinding=this&&this[a181_0x3c9553(0xa7)]||(Object[a181_0x3c9553(0x106)]?function(_0x241740,_0x293f79,_0x35204e,_0x15d4aa){if(_0x15d4aa===undefined)_0x15d4aa=_0x35204e;Object['defineProperty'](_0x241740,_0x15d4aa,{'enumerable':!![],'get':function(){return _0x293f79[_0x35204e];}});}:function(_0x1dc8a8,_0x41caca,_0x43e136,_0x31a09e){if(_0x31a09e===undefined)_0x31a09e=_0x43e136;_0x1dc8a8[_0x31a09e]=_0x41caca[_0x43e136];}),__setModuleDefault=this&&this[a181_0x3c9553(0x97)]||(Object[a181_0x3c9553(0x106)]?function(_0x185da3,_0x1db87a){const _0x996d54=a181_0x3c9553;Object[_0x996d54(0xec)](_0x185da3,_0x996d54(0xe9),{'enumerable':!![],'value':_0x1db87a});}:function(_0x295bdb,_0x32006c){const _0x2c4c92=a181_0x3c9553;_0x295bdb[_0x2c4c92(0xe9)]=_0x32006c;}),__decorate=this&&this[a181_0x3c9553(0xd4)]||function(_0x2bc766,_0x2e1695,_0x39be4d,_0x53f38d){const _0xf98389=a181_0x3c9553;var _0x357e20=arguments['length'],_0x3cdbdf=_0x357e20<0x3?_0x2e1695:_0x53f38d===null?_0x53f38d=Object[_0xf98389(0xf8)](_0x2e1695,_0x39be4d):_0x53f38d,_0x1c8052;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0xf98389(0xac))_0x3cdbdf=Reflect[_0xf98389(0xee)](_0x2bc766,_0x2e1695,_0x39be4d,_0x53f38d);else{for(var _0x85c141=_0x2bc766[_0xf98389(0xe0)]-0x1;_0x85c141>=0x0;_0x85c141--)if(_0x1c8052=_0x2bc766[_0x85c141])_0x3cdbdf=(_0x357e20<0x3?_0x1c8052(_0x3cdbdf):_0x357e20>0x3?_0x1c8052(_0x2e1695,_0x39be4d,_0x3cdbdf):_0x1c8052(_0x2e1695,_0x39be4d))||_0x3cdbdf;}return _0x357e20>0x3&&_0x3cdbdf&&Object[_0xf98389(0xec)](_0x2e1695,_0x39be4d,_0x3cdbdf),_0x3cdbdf;},__importStar=this&&this[a181_0x3c9553(0xae)]||function(_0x27b69b){const _0x4467dc=a181_0x3c9553;if(_0x27b69b&&_0x27b69b[_0x4467dc(0xa5)])return _0x27b69b;var _0x17a599={};if(_0x27b69b!=null){for(var _0x602ec9 in _0x27b69b)if(_0x602ec9!=='default'&&Object[_0x4467dc(0xa8)][_0x4467dc(0xa1)][_0x4467dc(0x101)](_0x27b69b,_0x602ec9))__createBinding(_0x17a599,_0x27b69b,_0x602ec9);}return __setModuleDefault(_0x17a599,_0x27b69b),_0x17a599;},__metadata=this&&this['__metadata']||function(_0x1acd7c,_0x45ee10){const _0x529892=a181_0x3c9553;if(typeof Reflect===_0x529892(0x93)&&typeof Reflect['metadata']===_0x529892(0xac))return Reflect[_0x529892(0xff)](_0x1acd7c,_0x45ee10);},__importDefault=this&&this['__importDefault']||function(_0xdfe68d){const _0x5d22b8=a181_0x3c9553;return _0xdfe68d&&_0xdfe68d[_0x5d22b8(0xa5)]?_0xdfe68d:{'default':_0xdfe68d};};Object[a181_0x3c9553(0xec)](exports,a181_0x3c9553(0xa5),{'value':!![]}),exports[a181_0x3c9553(0xa6)]=void 0x0;const auth_settings_service_1=require(a181_0x3c9553(0xf9)),commit_components_dto_1=require(a181_0x3c9553(0xf6)),events_1=__importDefault(require('events')),git_utils_1=require(a181_0x3c9553(0xd1)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a181_0x3c9553(0xd8)),typedi_1=__importStar(require(a181_0x3c9553(0xa3))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a181_0x3c9553(0xbe)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),constants_1=require(a181_0x3c9553(0xbb)),bitbucket_api_service_1=require(a181_0x3c9553(0xb1)),sfdx_utils_2=require(a181_0x3c9553(0xa0)),fs_internal_1=require(a181_0x3c9553(0xad)),path_1=require('path');function a181_0x2f08(_0x26629f,_0x4bf454){const _0x2442eb=a181_0x4235();return a181_0x2f08=function(_0x776eef,_0x9e0a80){_0x776eef=_0x776eef-0x91;let _0x4235c2=_0x2442eb[_0x776eef];return _0x4235c2;},a181_0x2f08(_0x26629f,_0x4bf454);}let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x3c9553(0xe9)]{constructor(_0x1dbe5b){const _0x20405c=a181_0x3c9553;super(),this[_0x20405c(0xc1)]=_0x1dbe5b,this['COMPONENTS_PER_TICK']=0x3e8,this[_0x20405c(0xe2)]=0x0,this[_0x20405c(0xde)]=0x0,this['startTime']=Date[_0x20405c(0xf1)]();}async[a181_0x3c9553(0x9a)](){const _0x53f30a=a181_0x3c9553,{repo:_0x109c9c}=this[_0x53f30a(0xc7)];let _0x22a038=this[_0x53f30a(0xc1)][_0x53f30a(0xdc)](this[_0x53f30a(0xc7)][_0x53f30a(0xd9)]);if(this['commitData'][_0x53f30a(0xd9)]===_0x53f30a(0x108)){const _0x239ae4=typedi_1[_0x53f30a(0xe9)][_0x53f30a(0xe8)](bitbucket_api_service_1[_0x53f30a(0xb5)]);await _0x239ae4[_0x53f30a(0xc2)](),_0x22a038+=encodeURIComponent(_0x239ae4[_0x53f30a(0x98)]());}return _0x109c9c['gitUrl'][_0x53f30a(0xca)](/http(s)?:\/\/(.+@)?/,utils_1['getProtocol'](_0x109c9c[_0x53f30a(0x100)])+'://'+_0x22a038+'@');}[a181_0x3c9553(0xc3)](_0x29fd5c){const _0xa129ed=a181_0x3c9553;var _0x1130b1;_0x29fd5c[_0xa129ed(0x99)](_0x371205=>child_types_1[_0xa129ed(0xe9)][_0xa129ed(0x94)](_0x371205[_0xa129ed(0x109)])?0x1:-0x1);const _0x46fa0b={};for(const _0x1d9575 of _0x29fd5c){_0x46fa0b[_0x1130b1=_0x1d9575['fileName']]||(_0x46fa0b[_0x1130b1]=[]),_0x46fa0b[_0x1d9575[_0xa129ed(0xb0)]][_0xa129ed(0xd0)](_0x1d9575);}return Object[_0xa129ed(0xba)](_0x46fa0b)[_0xa129ed(0xcc)]((_0x2b4783,_0x46b020)=>[..._0x2b4783,..._0x46b020],[]);}async[a181_0x3c9553(0xf3)](_0x8d5cc9){const _0x165099=a181_0x3c9553;_0x8d5cc9=this[_0x165099(0xc3)](_0x8d5cc9);let _0x1c607f=0x0;while(_0x8d5cc9[_0x165099(0xe0)]){const _0x233c6f=_0x8d5cc9[_0x165099(0xb2)](0x0,this[_0x165099(0xce)]);await this['mdapiUtils']['writeFlosumComponents'](_0x233c6f,{'skipChildErrors':this[_0x165099(0xc7)]['branch'][_0x165099(0xd6)]===_0x165099(0xf4)}),_0x1c607f+=_0x233c6f['length'],this['sfLogger'][_0x165099(0xb4)](_0x165099(0x91)+_0x1c607f+'/'+this[_0x165099(0xe2)]+_0x165099(0xed)),await this['sfLogger'][_0x165099(0xe3)]();}}async[a181_0x3c9553(0xfa)](_0x17f274){const _0x318b45=a181_0x3c9553;_0x17f274[_0x318b45(0x99)](_0x17e1d9=>child_types_1[_0x318b45(0xe9)][_0x318b45(0x94)](_0x17e1d9[_0x318b45(0xcf)])?-0x1:0x1);let _0x564c97=0x0;while(_0x17f274[_0x318b45(0xe0)]){const _0x458495=_0x17f274[_0x318b45(0xb2)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils'][_0x318b45(0xfa)](_0x458495),_0x564c97+=_0x458495[_0x318b45(0xe0)],this['sfLogger']['log'](_0x318b45(0xbd)+_0x564c97+'/'+this[_0x318b45(0xde)]+_0x318b45(0xed)),await this[_0x318b45(0xe6)][_0x318b45(0xe3)]();}}async[a181_0x3c9553(0xf2)](){const _0x2e8fbd=a181_0x3c9553;this[_0x2e8fbd(0x9f)]&&await this['gitUtils']['removeDir']()[_0x2e8fbd(0x9c)](()=>void 0x0),this[_0x2e8fbd(0xb7)]&&await this[_0x2e8fbd(0xb7)]['removeDir']()[_0x2e8fbd(0x9c)](()=>void 0x0),this[_0x2e8fbd(0xea)]&&await this['sfdxUtils'][_0x2e8fbd(0x105)]()[_0x2e8fbd(0x9c)](()=>void 0x0);}async['exec'](){const _0x59de80=a181_0x3c9553,{repo:_0x35ab95,branch:_0x26190f,components:_0x9ac04a,convertToSFDX:_0x57e619,message:_0x54d016,user:_0x1f99bc}=this[_0x59de80(0xc7)];this[_0x59de80(0xb7)]=new mdapi_utils_1[(_0x59de80(0xe1))](),this[_0x59de80(0x9f)]=new git_utils_1[(_0x59de80(0xfe))](await this['getRemote']()),this[_0x59de80(0xea)]=new sfdx_utils_1[(_0x59de80(0xa9))]();let _0x304278=_0x57e619;try{this['sfLogger'][_0x59de80(0xb4)]('[INFO]\x20Start\x20clonning\x20repository'),await this[_0x59de80(0x9f)]['clone'](_0x26190f[_0x59de80(0xd6)],_0x35ab95[_0x59de80(0xd6)]);!this[_0x59de80(0xc7)][_0x59de80(0xc8)]?(this[_0x59de80(0xe6)]['log'](_0x59de80(0x9e)),await this[_0x59de80(0xb7)][_0x59de80(0xc4)](this[_0x59de80(0x9f)]['dir'])):this[_0x59de80(0xe6)][_0x59de80(0xb4)](_0x59de80(0xc9));_0x9ac04a[_0x59de80(0xbf)]&&(this[_0x59de80(0xe6)]['log']('[INFO]\x20Preparing\x20to\x20write\x20components'),this[_0x59de80(0xe2)]=_0x9ac04a[_0x59de80(0xbf)][_0x59de80(0xe0)],await this[_0x59de80(0xf3)](_0x9ac04a['writed']),await this['sfLogger'][_0x59de80(0xe3)]());_0x9ac04a[_0x59de80(0xaf)]&&(this[_0x59de80(0xe6)][_0x59de80(0xb4)]('[INFO]\x20Preparing\x20to\x20delete\x20components'),this[_0x59de80(0xde)]=_0x9ac04a[_0x59de80(0xaf)][_0x59de80(0xe0)],await this[_0x59de80(0xfa)](_0x9ac04a[_0x59de80(0xaf)]),await this[_0x59de80(0xe6)][_0x59de80(0xe3)]());await this[_0x59de80(0xe6)][_0x59de80(0xe3)]();const _0x531986=await fs_internal_1['FS'][_0x59de80(0xe7)](this[_0x59de80(0x9f)][_0x59de80(0xfb)]);await sfdx_utils_2[_0x59de80(0xdf)][_0x59de80(0xfc)](this[_0x59de80(0x9f)]['dir'])?(_0x304278=!![],await fs_internal_1['FS']['removeDir'](path_1[_0x59de80(0x103)](this[_0x59de80(0x9f)][_0x59de80(0xfb)],_0x59de80(0xaa)))):(_0x304278&&(!_0x531986&&(_0x304278=![])),await this[_0x59de80(0x9f)][_0x59de80(0xc5)]());_0x304278?(this[_0x59de80(0xe6)][_0x59de80(0xb4)](_0x59de80(0xeb)),await this[_0x59de80(0xea)][_0x59de80(0x104)](this[_0x59de80(0xb7)]['dir']),await this[_0x59de80(0xea)][_0x59de80(0xe4)](this[_0x59de80(0x9f)][_0x59de80(0xfb)],!_0x531986),await this['sfdxUtils'][_0x59de80(0x105)](),await this[_0x59de80(0xe6)][_0x59de80(0xe3)]()):(this[_0x59de80(0xe6)][_0x59de80(0xb4)](_0x59de80(0x9d)),await this[_0x59de80(0xb7)][_0x59de80(0x107)](this[_0x59de80(0x9f)]['dir']),await this[_0x59de80(0xe6)][_0x59de80(0xe3)]());this['sfLogger'][_0x59de80(0xb4)](_0x59de80(0xf5)),await this[_0x59de80(0x9f)][_0x59de80(0xa4)](_0x54d016,{'email':constants_1[_0x59de80(0xda)],'name':_0x1f99bc['name']},_0x26190f[_0x59de80(0xd6)]),await this[_0x59de80(0x9f)]['removeDir'](),await this['mdapiUtils'][_0x59de80(0x105)]();const _0x48b26e=this[_0x59de80(0xe2)]+this[_0x59de80(0xde)];this['sfLogger']['log'](_0x59de80(0xbc)+(Date[_0x59de80(0xf1)]()-this[_0x59de80(0xc6)])+_0x59de80(0x9b)+_0x48b26e),await this[_0x59de80(0xe6)]['send']();}catch(_0x1252dc){await this[_0x59de80(0xf2)](),this[_0x59de80(0xe6)]['log'](_0x59de80(0xb8)+_0x1252dc),await this[_0x59de80(0xe6)][_0x59de80(0xe3)]();throw _0x1252dc;}}async[a181_0x3c9553(0xc0)](_0x4019a4,_0x18e6a0){const _0x1ede19=a181_0x3c9553;var _0x5d341d,_0x1c4386;this[_0x1ede19(0xe6)]=new salesforce_logger_v2_service_1[(_0x1ede19(0xab))](_0x18e6a0['getLoggerId'](),_0x18e6a0[_0x1ede19(0xcb)]()+'\x20['+commit_components_dto_1[_0x1ede19(0xd2)][_0x1ede19(0xd6)]+']');const _0xf3d261=!!((_0x5d341d=_0x4019a4[_0x1ede19(0x102)])===null||_0x5d341d===void 0x0?void 0x0:_0x5d341d[_0x1ede19(0xbf)])||!!((_0x1c4386=_0x4019a4['components'])===null||_0x1c4386===void 0x0?void 0x0:_0x1c4386[_0x1ede19(0xaf)]);if(!_0xf3d261){this['sfLogger'][_0x1ede19(0xb4)](_0x1ede19(0xd3)),await this['sfLogger']['send']();return;}this[_0x1ede19(0xc7)]=_0x4019a4,await this['exec']();}};CommitComponentsJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a181_0x3c9553(0x95),[auth_settings_service_1[a181_0x3c9553(0xd5)]])],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;