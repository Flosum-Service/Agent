const a181_0x1ebc47=a181_0x5d7e;function a181_0x5d7e(_0x1c2dfd,_0x5c1d76){const _0x24fdc2=a181_0x29db();return a181_0x5d7e=function(_0xb6a408,_0x20cd5f){_0xb6a408=_0xb6a408-0xf6;let _0x29db15=_0x24fdc2[_0xb6a408];return _0x29db15;},a181_0x5d7e(_0x1c2dfd,_0x5c1d76);}function a181_0x29db(){const _0x265984=['bitbucket','apply','metadata','MDApiUtils','__importStar','type','824hlHzCI','sfLogger','../dto/commit-components.dto','SalesforceLogger2','events','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','2087130UBkklD','../utils/sfdx.utils','createProjectFrom','componentsToDelete','dir','../../parsers/data/child-types','isLoggedIn','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','includes','gitUrl','provider','__metadata','getProtocol','catch','removeDir','getOwnPropertyDescriptor','gitUtils','master','../../shared/utils','SFDXUtils','path','[ERROR]\x20','componentsToWrite','__decorate','splice','prototype','commitData','force','125757oNXtSX','now','getLoggerId','run','57174KBFuqa','(((.+)+)+)+$','COMPONENTS_PER_TICK','../../salesforce/services/salesforce-logger-v2.service','deleted','call','isSFDXProject','__esModule','[INFO]\x20Prepare\x20mdapi\x20files','8865864loJhub','../../internal/fs.internal','writeComponents','get','groupComponentsByFileName','object','ms.\x20Committed\x20components\x20-\x20','__importDefault','__setModuleDefault','getRemote','authSettings','create','sort','replace','398472WMtshB','startTime','isEmptyDir','decorate','mdapiUtils','../../git-api/services/bitbucket-api.service','[INFO]\x20Start\x20clonning\x20repository','__createBinding','join','components','../../../constants','[INFO]\x20Wrote\x20','AuthSettingsService','[INFO]\x20Preparing\x20to\x20delete\x20components','BitbucketApiService','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','search','clearDir','GitUtils','force-app','fileName','CommitComponentsDto','getCredentialsFor','hasOwnProperty','../../shared/services/auth-settings.service','defineProperty','design:paramtypes','sfdxUtils','function','../../salesforce/utils/sfdx.utils','100RvFhWu','exec','send','writeFlosumComponents','://','toString','length','log','CommitComponentsJob','removeComponents','writed','\x20components','cleanUp','../utils/git.utils','copyMdapiTo','default','653076DwCkyn','values','257493zYqBqo','name','getPrefix'];a181_0x29db=function(){return _0x265984;};return a181_0x29db();}(function(_0x120280,_0x3f41fa){const _0x1719d4=a181_0x5d7e,_0x9cd9cf=_0x120280();while(!![]){try{const _0x511e0e=-parseInt(_0x1719d4(0x11f))/0x1+-parseInt(_0x1719d4(0x12e))/0x2+-parseInt(_0x1719d4(0x11d))/0x3+-parseInt(_0x1719d4(0x165))/0x4+parseInt(_0x1719d4(0x10d))/0x5*(-parseInt(_0x1719d4(0x14e))/0x6)+parseInt(_0x1719d4(0x157))/0x7+-parseInt(_0x1719d4(0x128))/0x8*(-parseInt(_0x1719d4(0x14a))/0x9);if(_0x511e0e===_0x3f41fa)break;else _0x9cd9cf['push'](_0x9cd9cf['shift']());}catch(_0x26e6e4){_0x9cd9cf['push'](_0x9cd9cf['shift']());}}}(a181_0x29db,0xdaf37));const a181_0x20cd5f=(function(){let _0x3cad92=!![];return function(_0x1ef712,_0x48d1a0){const _0x2fc5c5=_0x3cad92?function(){const _0x2a6bdf=a181_0x5d7e;if(_0x48d1a0){const _0x12105c=_0x48d1a0[_0x2a6bdf(0x123)](_0x1ef712,arguments);return _0x48d1a0=null,_0x12105c;}}:function(){};return _0x3cad92=![],_0x2fc5c5;};}()),a181_0xb6a408=a181_0x20cd5f(this,function(){const _0x3d0280=a181_0x5d7e;return a181_0xb6a408[_0x3d0280(0x112)]()[_0x3d0280(0xff)](_0x3d0280(0x14f))[_0x3d0280(0x112)]()['constructor'](a181_0xb6a408)[_0x3d0280(0xff)](_0x3d0280(0x14f));});a181_0xb6a408();'use strict';var __createBinding=this&&this[a181_0x1ebc47(0xf6)]||(Object[a181_0x1ebc47(0x162)]?function(_0x5be86b,_0x347af7,_0x20b4de,_0x21ae53){if(_0x21ae53===undefined)_0x21ae53=_0x20b4de;Object['defineProperty'](_0x5be86b,_0x21ae53,{'enumerable':!![],'get':function(){return _0x347af7[_0x20b4de];}});}:function(_0x42feae,_0x67d2ce,_0x4cbad6,_0x4a6dad){if(_0x4a6dad===undefined)_0x4a6dad=_0x4cbad6;_0x42feae[_0x4a6dad]=_0x67d2ce[_0x4cbad6];}),__setModuleDefault=this&&this[a181_0x1ebc47(0x15f)]||(Object[a181_0x1ebc47(0x162)]?function(_0x3fc874,_0x2889a6){const _0x33a8ca=a181_0x1ebc47;Object[_0x33a8ca(0x108)](_0x3fc874,_0x33a8ca(0x11c),{'enumerable':!![],'value':_0x2889a6});}:function(_0x3c792d,_0x1baed9){const _0x57cd3e=a181_0x1ebc47;_0x3c792d[_0x57cd3e(0x11c)]=_0x1baed9;}),__decorate=this&&this[a181_0x1ebc47(0x145)]||function(_0xe3c3b0,_0x595308,_0x99e84a,_0x1c070f){const _0x189ada=a181_0x1ebc47;var _0x9d3367=arguments[_0x189ada(0x113)],_0x4285c1=_0x9d3367<0x3?_0x595308:_0x1c070f===null?_0x1c070f=Object[_0x189ada(0x13d)](_0x595308,_0x99e84a):_0x1c070f,_0x360e29;if(typeof Reflect===_0x189ada(0x15c)&&typeof Reflect[_0x189ada(0x168)]===_0x189ada(0x10b))_0x4285c1=Reflect[_0x189ada(0x168)](_0xe3c3b0,_0x595308,_0x99e84a,_0x1c070f);else{for(var _0x526c6a=_0xe3c3b0[_0x189ada(0x113)]-0x1;_0x526c6a>=0x0;_0x526c6a--)if(_0x360e29=_0xe3c3b0[_0x526c6a])_0x4285c1=(_0x9d3367<0x3?_0x360e29(_0x4285c1):_0x9d3367>0x3?_0x360e29(_0x595308,_0x99e84a,_0x4285c1):_0x360e29(_0x595308,_0x99e84a))||_0x4285c1;}return _0x9d3367>0x3&&_0x4285c1&&Object[_0x189ada(0x108)](_0x595308,_0x99e84a,_0x4285c1),_0x4285c1;},__importStar=this&&this[a181_0x1ebc47(0x126)]||function(_0x9711c6){const _0x15e069=a181_0x1ebc47;if(_0x9711c6&&_0x9711c6[_0x15e069(0x155)])return _0x9711c6;var _0x4c1aa8={};if(_0x9711c6!=null){for(var _0x3d04d7 in _0x9711c6)if(_0x3d04d7!==_0x15e069(0x11c)&&Object[_0x15e069(0x147)][_0x15e069(0x106)][_0x15e069(0x153)](_0x9711c6,_0x3d04d7))__createBinding(_0x4c1aa8,_0x9711c6,_0x3d04d7);}return __setModuleDefault(_0x4c1aa8,_0x9711c6),_0x4c1aa8;},__metadata=this&&this[a181_0x1ebc47(0x139)]||function(_0x2df0aa,_0x52d1a2){const _0x20fe84=a181_0x1ebc47;if(typeof Reflect===_0x20fe84(0x15c)&&typeof Reflect['metadata']==='function')return Reflect[_0x20fe84(0x124)](_0x2df0aa,_0x52d1a2);},__importDefault=this&&this[a181_0x1ebc47(0x15e)]||function(_0x585962){const _0x50b944=a181_0x1ebc47;return _0x585962&&_0x585962[_0x50b944(0x155)]?_0x585962:{'default':_0x585962};};Object[a181_0x1ebc47(0x108)](exports,a181_0x1ebc47(0x155),{'value':!![]}),exports[a181_0x1ebc47(0x115)]=void 0x0;const auth_settings_service_1=require(a181_0x1ebc47(0x107)),commit_components_dto_1=require(a181_0x1ebc47(0x12a)),events_1=__importDefault(require(a181_0x1ebc47(0x12c))),git_utils_1=require(a181_0x1ebc47(0x11a)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a181_0x1ebc47(0x12f)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a181_0x1ebc47(0x133))),utils_1=require(a181_0x1ebc47(0x140)),salesforce_logger_v2_service_1=require(a181_0x1ebc47(0x151)),constants_1=require(a181_0x1ebc47(0xf9)),bitbucket_api_service_1=require(a181_0x1ebc47(0x16a)),sfdx_utils_2=require(a181_0x1ebc47(0x10c)),fs_internal_1=require(a181_0x1ebc47(0x158)),path_1=require(a181_0x1ebc47(0x142));let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(_0x72386b){const _0x5cf268=a181_0x1ebc47;super(),this[_0x5cf268(0x161)]=_0x72386b,this[_0x5cf268(0x150)]=0x3e8,this[_0x5cf268(0x144)]=0x0,this[_0x5cf268(0x131)]=0x0,this[_0x5cf268(0x166)]=Date[_0x5cf268(0x14b)]();}async[a181_0x1ebc47(0x160)](){const _0x54c0b7=a181_0x1ebc47,{repo:_0x2c2018}=this[_0x54c0b7(0x148)];let _0x548348=this['authSettings'][_0x54c0b7(0x105)](this[_0x54c0b7(0x148)]['provider']);if(this[_0x54c0b7(0x148)][_0x54c0b7(0x138)]===_0x54c0b7(0x122)){const _0x1ecbbc=typedi_1[_0x54c0b7(0x11c)][_0x54c0b7(0x15a)](bitbucket_api_service_1[_0x54c0b7(0xfd)]);await _0x1ecbbc[_0x54c0b7(0x134)](),_0x548348+=encodeURIComponent(_0x1ecbbc['getAccessToken']());}return _0x2c2018[_0x54c0b7(0x137)][_0x54c0b7(0x164)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x54c0b7(0x13a)](_0x2c2018[_0x54c0b7(0x137)])+_0x54c0b7(0x111)+_0x548348+'@');}[a181_0x1ebc47(0x15b)](_0x98f212){const _0x598165=a181_0x1ebc47;var _0x4edca7;_0x98f212['sort'](_0x30184e=>child_types_1[_0x598165(0x11c)][_0x598165(0x136)](_0x30184e['fileType'])?0x1:-0x1);const _0x231ba0={};for(const _0x3a9817 of _0x98f212){_0x231ba0[_0x4edca7=_0x3a9817[_0x598165(0x103)]]||(_0x231ba0[_0x4edca7]=[]),_0x231ba0[_0x3a9817[_0x598165(0x103)]]['push'](_0x3a9817);}return Object[_0x598165(0x11e)](_0x231ba0)['reduce']((_0x1de69b,_0x2a2464)=>[..._0x1de69b,..._0x2a2464],[]);}async[a181_0x1ebc47(0x159)](_0x1b44bd){const _0x1fc2cc=a181_0x1ebc47;_0x1b44bd=this[_0x1fc2cc(0x15b)](_0x1b44bd);let _0xdaa29=0x0;while(_0x1b44bd[_0x1fc2cc(0x113)]){const _0x93f2a1=_0x1b44bd[_0x1fc2cc(0x146)](0x0,this[_0x1fc2cc(0x150)]);await this['mdapiUtils'][_0x1fc2cc(0x110)](_0x93f2a1,{'skipChildErrors':this[_0x1fc2cc(0x148)]['branch'][_0x1fc2cc(0x120)]===_0x1fc2cc(0x13f)}),_0xdaa29+=_0x93f2a1[_0x1fc2cc(0x113)],this[_0x1fc2cc(0x129)][_0x1fc2cc(0x114)](_0x1fc2cc(0xfa)+_0xdaa29+'/'+this['componentsToWrite']+_0x1fc2cc(0x118)),await this['sfLogger'][_0x1fc2cc(0x10f)]();}}async[a181_0x1ebc47(0x116)](_0x3fb8d1){const _0x43296b=a181_0x1ebc47;_0x3fb8d1[_0x43296b(0x163)](_0x4e1b79=>child_types_1['default']['includes'](_0x4e1b79[_0x43296b(0x127)])?-0x1:0x1);let _0x449615=0x0;while(_0x3fb8d1[_0x43296b(0x113)]){const _0x324b6d=_0x3fb8d1[_0x43296b(0x146)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x43296b(0x169)][_0x43296b(0x116)](_0x324b6d),_0x449615+=_0x324b6d[_0x43296b(0x113)],this[_0x43296b(0x129)][_0x43296b(0x114)]('[INFO]\x20Deleted\x20'+_0x449615+'/'+this[_0x43296b(0x131)]+'\x20components'),await this[_0x43296b(0x129)][_0x43296b(0x10f)]();}}async[a181_0x1ebc47(0x119)](){const _0x3a5469=a181_0x1ebc47;this[_0x3a5469(0x13e)]&&await this[_0x3a5469(0x13e)][_0x3a5469(0x13c)]()[_0x3a5469(0x13b)](()=>void 0x0),this[_0x3a5469(0x169)]&&await this[_0x3a5469(0x169)][_0x3a5469(0x13c)]()[_0x3a5469(0x13b)](()=>void 0x0),this['sfdxUtils']&&await this[_0x3a5469(0x10a)]['removeDir']()[_0x3a5469(0x13b)](()=>void 0x0);}async[a181_0x1ebc47(0x10e)](){const _0x3dddc2=a181_0x1ebc47,{repo:_0x44c300,branch:_0x3b618a,components:_0x27ea0a,convertToSFDX:_0x249598,message:_0x54603c,user:_0x39fbc6}=this[_0x3dddc2(0x148)];this[_0x3dddc2(0x169)]=new mdapi_utils_1[(_0x3dddc2(0x125))](_0x44c300[_0x3dddc2(0x120)],_0x3b618a['name']),this[_0x3dddc2(0x13e)]=new git_utils_1[(_0x3dddc2(0x101))](await this[_0x3dddc2(0x160)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x3dddc2(0x141))](_0x44c300[_0x3dddc2(0x120)],_0x3b618a[_0x3dddc2(0x120)]);let _0x7f0a17=_0x249598;try{this[_0x3dddc2(0x129)][_0x3dddc2(0x114)](_0x3dddc2(0x16b)),await this[_0x3dddc2(0x13e)]['clone'](_0x3b618a[_0x3dddc2(0x120)],_0x44c300['name']);!this['commitData'][_0x3dddc2(0x149)]?(this[_0x3dddc2(0x129)][_0x3dddc2(0x114)](_0x3dddc2(0x156)),await this['mdapiUtils']['prepareMdapi'](this[_0x3dddc2(0x13e)]['dir'])):this[_0x3dddc2(0x129)][_0x3dddc2(0x114)]('[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');_0x27ea0a['writed']&&(this[_0x3dddc2(0x129)][_0x3dddc2(0x114)]('[INFO]\x20Preparing\x20to\x20write\x20components'),this[_0x3dddc2(0x144)]=_0x27ea0a[_0x3dddc2(0x117)][_0x3dddc2(0x113)],await this[_0x3dddc2(0x159)](_0x27ea0a[_0x3dddc2(0x117)]),await this[_0x3dddc2(0x129)][_0x3dddc2(0x10f)]());_0x27ea0a[_0x3dddc2(0x152)]&&(this[_0x3dddc2(0x129)][_0x3dddc2(0x114)](_0x3dddc2(0xfc)),this[_0x3dddc2(0x131)]=_0x27ea0a[_0x3dddc2(0x152)][_0x3dddc2(0x113)],await this['removeComponents'](_0x27ea0a['deleted']),await this[_0x3dddc2(0x129)]['send']());await this['sfLogger'][_0x3dddc2(0x10f)]();await sfdx_utils_2['SFDX'][_0x3dddc2(0x154)](this[_0x3dddc2(0x13e)][_0x3dddc2(0x132)])?(_0x7f0a17=!![],await fs_internal_1['FS'][_0x3dddc2(0x13c)](path_1[_0x3dddc2(0xf7)](this[_0x3dddc2(0x13e)][_0x3dddc2(0x132)],_0x3dddc2(0x102)))):(_0x7f0a17&&(!await fs_internal_1['FS'][_0x3dddc2(0x167)](this['gitUtils'][_0x3dddc2(0x132)])&&(_0x7f0a17=![])),await this[_0x3dddc2(0x13e)][_0x3dddc2(0x100)]());_0x7f0a17?(this['sfLogger']['log']('[INFO]\x20Start\x20converting\x20to\x20SFDX'),await this[_0x3dddc2(0x10a)][_0x3dddc2(0x130)](this[_0x3dddc2(0x169)][_0x3dddc2(0x132)]),await this['sfdxUtils']['copyProjectTo'](this[_0x3dddc2(0x13e)][_0x3dddc2(0x132)]),await this[_0x3dddc2(0x10a)][_0x3dddc2(0x13c)](),await this[_0x3dddc2(0x129)]['send']()):(this[_0x3dddc2(0x129)][_0x3dddc2(0x114)](_0x3dddc2(0x135)),await this[_0x3dddc2(0x169)][_0x3dddc2(0x11b)](this[_0x3dddc2(0x13e)][_0x3dddc2(0x132)]),await this[_0x3dddc2(0x129)][_0x3dddc2(0x10f)]());this[_0x3dddc2(0x129)]['log'](_0x3dddc2(0xfe)),await this[_0x3dddc2(0x13e)]['commitAndPush'](_0x54603c,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x39fbc6[_0x3dddc2(0x120)]},_0x3b618a['name']),await this[_0x3dddc2(0x13e)]['removeDir'](),await this[_0x3dddc2(0x169)][_0x3dddc2(0x13c)]();const _0x1aebb6=this[_0x3dddc2(0x144)]+this[_0x3dddc2(0x131)];this[_0x3dddc2(0x129)]['log']('[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x3dddc2(0x14b)]()-this['startTime'])+_0x3dddc2(0x15d)+_0x1aebb6),await this[_0x3dddc2(0x129)]['send']();}catch(_0x328e72){await this[_0x3dddc2(0x119)](),this[_0x3dddc2(0x129)][_0x3dddc2(0x114)](_0x3dddc2(0x143)+_0x328e72),await this['sfLogger'][_0x3dddc2(0x10f)]();throw _0x328e72;}}async[a181_0x1ebc47(0x14d)](_0x37b8a9,_0x5de017){const _0x407743=a181_0x1ebc47;var _0x5beb9f,_0x297fb9;this[_0x407743(0x129)]=new salesforce_logger_v2_service_1[(_0x407743(0x12b))](_0x5de017[_0x407743(0x14c)](),_0x5de017[_0x407743(0x121)]()+'\x20['+commit_components_dto_1[_0x407743(0x104)]['name']+']');const _0xaef384=!!((_0x5beb9f=_0x37b8a9[_0x407743(0xf8)])===null||_0x5beb9f===void 0x0?void 0x0:_0x5beb9f[_0x407743(0x117)])||!!((_0x297fb9=_0x37b8a9[_0x407743(0xf8)])===null||_0x297fb9===void 0x0?void 0x0:_0x297fb9[_0x407743(0x152)]);if(!_0xaef384){this['sfLogger'][_0x407743(0x114)](_0x407743(0x12d)),await this[_0x407743(0x129)][_0x407743(0x10f)]();return;}this['commitData']=_0x37b8a9,await this[_0x407743(0x10e)]();}};CommitComponentsJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a181_0x1ebc47(0x109),[auth_settings_service_1[a181_0x1ebc47(0xfb)]])],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;