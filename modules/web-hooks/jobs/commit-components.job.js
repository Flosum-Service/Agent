const a181_0x23389f=a181_0x31eb;(function(_0x3c2a8c,_0x457c03){const _0x2ba845=a181_0x31eb,_0x3ceeaf=_0x3c2a8c();while(!![]){try{const _0x1a6685=parseInt(_0x2ba845(0x13e))/0x1*(-parseInt(_0x2ba845(0x183))/0x2)+-parseInt(_0x2ba845(0x146))/0x3+-parseInt(_0x2ba845(0x148))/0x4+parseInt(_0x2ba845(0x16e))/0x5+parseInt(_0x2ba845(0x15d))/0x6*(-parseInt(_0x2ba845(0x170))/0x7)+parseInt(_0x2ba845(0x19a))/0x8+parseInt(_0x2ba845(0x141))/0x9;if(_0x1a6685===_0x457c03)break;else _0x3ceeaf['push'](_0x3ceeaf['shift']());}catch(_0x3eb2fa){_0x3ceeaf['push'](_0x3ceeaf['shift']());}}}(a181_0x5872,0xbeec3));function a181_0x5872(){const _0x483f4b=['create','push','../../../constants','getPrefix','../../internal/fs.internal','copyMdapiTo','getProtocol','MDApiUtils','3592920goDvvi','__metadata','7yhPbkQ','CommitComponentsJob','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','name','(((.+)+)+)+$','hasOwnProperty','[INFO]\x20Start\x20converting\x20to\x20SFDX','sfLogger','log','SFDXUtils','isEmptyDir','../utils/git.utils','://','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','SalesforceLogger2','componentsToDelete','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','defineProperty','fileName','802JEXwSr','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','includes','decorate','componentsToWrite','[INFO]\x20Preparing\x20to\x20delete\x20components','CommitComponentsDto','mdapiUtils','writeComponents','[INFO]\x20Preparing\x20to\x20write\x20components','force','writed','../utils/mdapi.utils','metadata','__createBinding','__setModuleDefault','master','components','__esModule','reduce','COMPONENTS_PER_TICK','cleanUp','splice','8807120QqIwKT','toString','[INFO]\x20Deleted\x20','groupComponentsByFileName','../utils/sfdx.utils','get','join','clone','__importStar','values','type','gitUtils','prepareMdapi','../../parsers/data/child-types','[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','catch','events','default','apply','Service','getOwnPropertyDescriptor','AuthSettingsService','call','[INFO]\x20Prepare\x20mdapi\x20files','branch','getAccessToken','startTime','typedi','3740RDcMXi','exec','function','18427644UthKlq','now','[INFO]\x20Start\x20clonning\x20repository','search','ms.\x20Committed\x20components\x20-\x20','2993175ymbffa','GitUtils','1894008ztBThQ','sort','createProjectFrom','clearDir','authSettings','writeFlosumComponents','constructor','../../salesforce/services/salesforce-logger-v2.service','getRemote','gitUrl','deleted','\x20components','removeDir','fileType','send','[ERROR]\x20','isLoggedIn','[INFO]\x20Wrote\x20','object','../../git-api/services/bitbucket-api.service','dir','684024qzpfWA','run','length','commitData','sfdxUtils','provider','bitbucket','../../salesforce/utils/sfdx.utils','removeComponents'];a181_0x5872=function(){return _0x483f4b;};return a181_0x5872();}const a181_0xc83196=(function(){let _0x354408=!![];return function(_0x34a1a9,_0x319835){const _0x429ddb=_0x354408?function(){const _0x368268=a181_0x31eb;if(_0x319835){const _0x3fe599=_0x319835[_0x368268(0x134)](_0x34a1a9,arguments);return _0x319835=null,_0x3fe599;}}:function(){};return _0x354408=![],_0x429ddb;};}()),a181_0x53cfcc=a181_0xc83196(this,function(){const _0xe6da9f=a181_0x31eb;return a181_0x53cfcc['toString']()[_0xe6da9f(0x144)](_0xe6da9f(0x174))[_0xe6da9f(0x19b)]()[_0xe6da9f(0x14e)](a181_0x53cfcc)[_0xe6da9f(0x144)]('(((.+)+)+)+$');});a181_0x53cfcc();'use strict';var __createBinding=this&&this[a181_0x23389f(0x191)]||(Object[a181_0x23389f(0x166)]?function(_0x1a481f,_0x587884,_0x4e1dc3,_0x5e11df){if(_0x5e11df===undefined)_0x5e11df=_0x4e1dc3;Object['defineProperty'](_0x1a481f,_0x5e11df,{'enumerable':!![],'get':function(){return _0x587884[_0x4e1dc3];}});}:function(_0x2cd6dd,_0x34905b,_0x3b4980,_0xe51253){if(_0xe51253===undefined)_0xe51253=_0x3b4980;_0x2cd6dd[_0xe51253]=_0x34905b[_0x3b4980];}),__setModuleDefault=this&&this[a181_0x23389f(0x192)]||(Object[a181_0x23389f(0x166)]?function(_0x40a621,_0xfee0d8){const _0x5736f9=a181_0x23389f;Object[_0x5736f9(0x181)](_0x40a621,_0x5736f9(0x133),{'enumerable':!![],'value':_0xfee0d8});}:function(_0x5726d0,_0xd150a9){_0x5726d0['default']=_0xd150a9;}),__decorate=this&&this['__decorate']||function(_0x40bcc1,_0x3d286b,_0xba56c,_0x276c32){const _0x3622e7=a181_0x23389f;var _0x528988=arguments['length'],_0x30ecce=_0x528988<0x3?_0x3d286b:_0x276c32===null?_0x276c32=Object[_0x3622e7(0x136)](_0x3d286b,_0xba56c):_0x276c32,_0x423080;if(typeof Reflect===_0x3622e7(0x15a)&&typeof Reflect[_0x3622e7(0x186)]===_0x3622e7(0x140))_0x30ecce=Reflect[_0x3622e7(0x186)](_0x40bcc1,_0x3d286b,_0xba56c,_0x276c32);else{for(var _0x27e6c4=_0x40bcc1[_0x3622e7(0x15f)]-0x1;_0x27e6c4>=0x0;_0x27e6c4--)if(_0x423080=_0x40bcc1[_0x27e6c4])_0x30ecce=(_0x528988<0x3?_0x423080(_0x30ecce):_0x528988>0x3?_0x423080(_0x3d286b,_0xba56c,_0x30ecce):_0x423080(_0x3d286b,_0xba56c))||_0x30ecce;}return _0x528988>0x3&&_0x30ecce&&Object[_0x3622e7(0x181)](_0x3d286b,_0xba56c,_0x30ecce),_0x30ecce;},__importStar=this&&this[a181_0x23389f(0x1a2)]||function(_0x3dfdb8){const _0x5cb422=a181_0x23389f;if(_0x3dfdb8&&_0x3dfdb8[_0x5cb422(0x195)])return _0x3dfdb8;var _0x487a7e={};if(_0x3dfdb8!=null){for(var _0x5852fa in _0x3dfdb8)if(_0x5852fa!==_0x5cb422(0x133)&&Object['prototype'][_0x5cb422(0x175)][_0x5cb422(0x138)](_0x3dfdb8,_0x5852fa))__createBinding(_0x487a7e,_0x3dfdb8,_0x5852fa);}return __setModuleDefault(_0x487a7e,_0x3dfdb8),_0x487a7e;},__metadata=this&&this[a181_0x23389f(0x16f)]||function(_0x3fc325,_0x1e53b9){const _0x40cbdb=a181_0x23389f;if(typeof Reflect===_0x40cbdb(0x15a)&&typeof Reflect[_0x40cbdb(0x190)]==='function')return Reflect[_0x40cbdb(0x190)](_0x3fc325,_0x1e53b9);},__importDefault=this&&this['__importDefault']||function(_0x2f40a1){const _0x232aed=a181_0x23389f;return _0x2f40a1&&_0x2f40a1[_0x232aed(0x195)]?_0x2f40a1:{'default':_0x2f40a1};};function a181_0x31eb(_0x31bc77,_0x49697e){const _0x438d1b=a181_0x5872();return a181_0x31eb=function(_0x53cfcc,_0xc83196){_0x53cfcc=_0x53cfcc-0x132;let _0x5872d1=_0x438d1b[_0x53cfcc];return _0x5872d1;},a181_0x31eb(_0x31bc77,_0x49697e);}Object[a181_0x23389f(0x181)](exports,'__esModule',{'value':!![]}),exports[a181_0x23389f(0x171)]=void 0x0;const auth_settings_service_1=require('../../shared/services/auth-settings.service'),commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a181_0x23389f(0x132))),git_utils_1=require(a181_0x23389f(0x17b)),mdapi_utils_1=require(a181_0x23389f(0x18f)),sfdx_utils_1=require(a181_0x23389f(0x19e)),typedi_1=__importStar(require(a181_0x23389f(0x13d))),child_types_1=__importDefault(require(a181_0x23389f(0x1a7))),utils_1=require('../../shared/utils'),salesforce_logger_v2_service_1=require(a181_0x23389f(0x14f)),constants_1=require(a181_0x23389f(0x168)),bitbucket_api_service_1=require(a181_0x23389f(0x15b)),sfdx_utils_2=require(a181_0x23389f(0x164)),fs_internal_1=require(a181_0x23389f(0x16a)),path_1=require('path');let CommitComponentsJob=class CommitComponentsJob extends events_1[a181_0x23389f(0x133)]{constructor(_0x34eb74){const _0x4a2e7e=a181_0x23389f;super(),this[_0x4a2e7e(0x14c)]=_0x34eb74,this['COMPONENTS_PER_TICK']=0x3e8,this[_0x4a2e7e(0x187)]=0x0,this[_0x4a2e7e(0x17f)]=0x0,this[_0x4a2e7e(0x13c)]=Date[_0x4a2e7e(0x142)]();}async[a181_0x23389f(0x150)](){const _0x1fc8e7=a181_0x23389f,{repo:_0x44d58b}=this[_0x1fc8e7(0x160)];let _0x54f3ef=this['authSettings']['getCredentialsFor'](this[_0x1fc8e7(0x160)]['provider']);if(this['commitData'][_0x1fc8e7(0x162)]===_0x1fc8e7(0x163)){const _0x5c19f2=typedi_1[_0x1fc8e7(0x133)][_0x1fc8e7(0x19f)](bitbucket_api_service_1['BitbucketApiService']);await _0x5c19f2[_0x1fc8e7(0x158)](),_0x54f3ef+=encodeURIComponent(_0x5c19f2[_0x1fc8e7(0x13b)]());}return _0x44d58b['gitUrl']['replace'](/http(s)?\:\/\/(.+@)?/,utils_1[_0x1fc8e7(0x16c)](_0x44d58b[_0x1fc8e7(0x151)])+_0x1fc8e7(0x17c)+_0x54f3ef+'@');}[a181_0x23389f(0x19d)](_0x34e7f6){const _0x19e82c=a181_0x23389f;var _0x1cc9cb;_0x34e7f6[_0x19e82c(0x149)](_0x58d6c4=>child_types_1[_0x19e82c(0x133)][_0x19e82c(0x185)](_0x58d6c4[_0x19e82c(0x155)])?0x1:-0x1);const _0x319892={};for(const _0x476cd0 of _0x34e7f6){_0x319892[_0x1cc9cb=_0x476cd0['fileName']]||(_0x319892[_0x1cc9cb]=[]),_0x319892[_0x476cd0[_0x19e82c(0x182)]][_0x19e82c(0x167)](_0x476cd0);}return Object[_0x19e82c(0x1a3)](_0x319892)[_0x19e82c(0x196)]((_0x26ef44,_0x509804)=>[..._0x26ef44,..._0x509804],[]);}async[a181_0x23389f(0x18b)](_0x5e5015){const _0x4663b9=a181_0x23389f;_0x5e5015=this[_0x4663b9(0x19d)](_0x5e5015);let _0x551389=0x0;while(_0x5e5015[_0x4663b9(0x15f)]){const _0x5f14e1=_0x5e5015[_0x4663b9(0x199)](0x0,this[_0x4663b9(0x197)]);await this[_0x4663b9(0x18a)][_0x4663b9(0x14d)](_0x5f14e1,{'skipChildErrors':this[_0x4663b9(0x160)][_0x4663b9(0x13a)][_0x4663b9(0x173)]===_0x4663b9(0x193)}),_0x551389+=_0x5f14e1[_0x4663b9(0x15f)],this[_0x4663b9(0x177)][_0x4663b9(0x178)](_0x4663b9(0x159)+_0x551389+'/'+this[_0x4663b9(0x187)]+_0x4663b9(0x153)),await this['sfLogger'][_0x4663b9(0x156)]();}}async[a181_0x23389f(0x165)](_0x1c9db7){const _0x33b02e=a181_0x23389f;_0x1c9db7[_0x33b02e(0x149)](_0x4339cb=>child_types_1['default'][_0x33b02e(0x185)](_0x4339cb[_0x33b02e(0x1a4)])?-0x1:0x1);let _0x458ee1=0x0;while(_0x1c9db7[_0x33b02e(0x15f)]){const _0x440612=_0x1c9db7[_0x33b02e(0x199)](0x0,this[_0x33b02e(0x197)]);await this['mdapiUtils']['removeComponents'](_0x440612),_0x458ee1+=_0x440612[_0x33b02e(0x15f)],this[_0x33b02e(0x177)][_0x33b02e(0x178)](_0x33b02e(0x19c)+_0x458ee1+'/'+this[_0x33b02e(0x17f)]+_0x33b02e(0x153)),await this[_0x33b02e(0x177)][_0x33b02e(0x156)]();}}async[a181_0x23389f(0x198)](){const _0x122c73=a181_0x23389f;this[_0x122c73(0x1a5)]&&await this[_0x122c73(0x1a5)]['removeDir']()[_0x122c73(0x1a9)](()=>void 0x0),this[_0x122c73(0x18a)]&&await this[_0x122c73(0x18a)][_0x122c73(0x154)]()[_0x122c73(0x1a9)](()=>void 0x0),this[_0x122c73(0x161)]&&await this['sfdxUtils']['removeDir']()[_0x122c73(0x1a9)](()=>void 0x0);}async['exec'](){const _0x6a2228=a181_0x23389f,{repo:_0x455f7a,branch:_0x51dda2,components:_0x8ea075,convertToSFDX:_0xa533a5,message:_0x44ec30,user:_0x45dc1b}=this[_0x6a2228(0x160)];this[_0x6a2228(0x18a)]=new mdapi_utils_1[(_0x6a2228(0x16d))](_0x455f7a[_0x6a2228(0x173)],_0x51dda2[_0x6a2228(0x173)]),this['gitUtils']=new git_utils_1[(_0x6a2228(0x147))](await this[_0x6a2228(0x150)]()),this[_0x6a2228(0x161)]=new sfdx_utils_1[(_0x6a2228(0x179))](_0x455f7a[_0x6a2228(0x173)],_0x51dda2['name']);let _0x29db5c=_0xa533a5;try{this['sfLogger'][_0x6a2228(0x178)](_0x6a2228(0x143)),await this[_0x6a2228(0x1a5)][_0x6a2228(0x1a1)](_0x51dda2[_0x6a2228(0x173)],_0x455f7a[_0x6a2228(0x173)]);!this[_0x6a2228(0x160)][_0x6a2228(0x18d)]?(this[_0x6a2228(0x177)][_0x6a2228(0x178)](_0x6a2228(0x139)),await this['mdapiUtils'][_0x6a2228(0x1a6)](this[_0x6a2228(0x1a5)]['dir'])):this[_0x6a2228(0x177)][_0x6a2228(0x178)](_0x6a2228(0x17d));_0x8ea075['writed']&&(this[_0x6a2228(0x177)][_0x6a2228(0x178)](_0x6a2228(0x18c)),this[_0x6a2228(0x187)]=_0x8ea075['writed'][_0x6a2228(0x15f)],await this['writeComponents'](_0x8ea075[_0x6a2228(0x18e)]),await this[_0x6a2228(0x177)][_0x6a2228(0x156)]());_0x8ea075[_0x6a2228(0x152)]&&(this['sfLogger']['log'](_0x6a2228(0x188)),this[_0x6a2228(0x17f)]=_0x8ea075[_0x6a2228(0x152)]['length'],await this[_0x6a2228(0x165)](_0x8ea075[_0x6a2228(0x152)]),await this[_0x6a2228(0x177)][_0x6a2228(0x156)]());await this[_0x6a2228(0x177)][_0x6a2228(0x156)]();await sfdx_utils_2['SFDX']['isSFDXProject'](this[_0x6a2228(0x1a5)][_0x6a2228(0x15c)])?(_0x29db5c=!![],await fs_internal_1['FS']['removeDir'](path_1[_0x6a2228(0x1a0)](this['gitUtils'][_0x6a2228(0x15c)],'force-app'))):(_0x29db5c&&(!await fs_internal_1['FS'][_0x6a2228(0x17a)](this[_0x6a2228(0x1a5)]['dir'])&&(_0x29db5c=![])),await this['gitUtils'][_0x6a2228(0x14b)]());_0x29db5c?(this['sfLogger'][_0x6a2228(0x178)](_0x6a2228(0x176)),await this[_0x6a2228(0x161)][_0x6a2228(0x14a)](this[_0x6a2228(0x18a)][_0x6a2228(0x15c)]),await this[_0x6a2228(0x161)]['copyProjectTo'](this[_0x6a2228(0x1a5)][_0x6a2228(0x15c)]),await this[_0x6a2228(0x161)]['removeDir'](),await this[_0x6a2228(0x177)]['send']()):(this[_0x6a2228(0x177)][_0x6a2228(0x178)](_0x6a2228(0x172)),await this[_0x6a2228(0x18a)][_0x6a2228(0x16b)](this['gitUtils'][_0x6a2228(0x15c)]),await this['sfLogger'][_0x6a2228(0x156)]());this['sfLogger'][_0x6a2228(0x178)](_0x6a2228(0x184)),await this['gitUtils']['commitAndPush'](_0x44ec30,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x45dc1b[_0x6a2228(0x173)]},_0x51dda2['name']),await this[_0x6a2228(0x1a5)][_0x6a2228(0x154)](),await this[_0x6a2228(0x18a)][_0x6a2228(0x154)]();const _0xac4089=this[_0x6a2228(0x187)]+this[_0x6a2228(0x17f)];this[_0x6a2228(0x177)][_0x6a2228(0x178)](_0x6a2228(0x1a8)+(Date[_0x6a2228(0x142)]()-this[_0x6a2228(0x13c)])+_0x6a2228(0x145)+_0xac4089),await this['sfLogger']['send']();}catch(_0x581cb7){await this['cleanUp'](),this[_0x6a2228(0x177)]['log'](_0x6a2228(0x157)+_0x581cb7),await this['sfLogger'][_0x6a2228(0x156)]();throw _0x581cb7;}}async[a181_0x23389f(0x15e)](_0x39ac57,_0x25dc5a){const _0x59dcd2=a181_0x23389f;var _0x46c7eb,_0x4a1a6f;this['sfLogger']=new salesforce_logger_v2_service_1[(_0x59dcd2(0x17e))](_0x25dc5a['getLoggerId'](),_0x25dc5a[_0x59dcd2(0x169)]()+'\x20['+commit_components_dto_1[_0x59dcd2(0x189)][_0x59dcd2(0x173)]+']');const _0x36dc0a=!!((_0x46c7eb=_0x39ac57[_0x59dcd2(0x194)])===null||_0x46c7eb===void 0x0?void 0x0:_0x46c7eb[_0x59dcd2(0x18e)])||!!((_0x4a1a6f=_0x39ac57[_0x59dcd2(0x194)])===null||_0x4a1a6f===void 0x0?void 0x0:_0x4a1a6f['deleted']);if(!_0x36dc0a){this[_0x59dcd2(0x177)][_0x59dcd2(0x178)](_0x59dcd2(0x180)),await this[_0x59dcd2(0x177)][_0x59dcd2(0x156)]();return;}this[_0x59dcd2(0x160)]=_0x39ac57,await this[_0x59dcd2(0x13f)]();}};CommitComponentsJob=__decorate([typedi_1[a181_0x23389f(0x135)]({'transient':!![]}),__metadata('design:paramtypes',[auth_settings_service_1[a181_0x23389f(0x137)]])],CommitComponentsJob),exports[a181_0x23389f(0x171)]=CommitComponentsJob;