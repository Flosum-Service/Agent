const a183_0x113de5=a183_0x4fc6;(function(_0x2750e4,_0x39699f){const _0x27f97b=a183_0x4fc6,_0x3559d1=_0x2750e4();while(!![]){try{const _0x3d435b=parseInt(_0x27f97b(0x172))/0x1+parseInt(_0x27f97b(0x19e))/0x2+parseInt(_0x27f97b(0x133))/0x3+-parseInt(_0x27f97b(0x17b))/0x4+-parseInt(_0x27f97b(0x120))/0x5+parseInt(_0x27f97b(0x146))/0x6*(parseInt(_0x27f97b(0x167))/0x7)+-parseInt(_0x27f97b(0x145))/0x8;if(_0x3d435b===_0x39699f)break;else _0x3559d1['push'](_0x3559d1['shift']());}catch(_0x24f351){_0x3559d1['push'](_0x3559d1['shift']());}}}(a183_0x1d66,0xd8c53));const a183_0x3c4714=(function(){let _0x333480=!![];return function(_0x240bd1,_0x313fbf){const _0xffb48e=_0x333480?function(){const _0x3a5c96=a183_0x4fc6;if(_0x313fbf){const _0x26ccc2=_0x313fbf[_0x3a5c96(0x164)](_0x240bd1,arguments);return _0x313fbf=null,_0x26ccc2;}}:function(){};return _0x333480=![],_0xffb48e;};}()),a183_0x5eae68=a183_0x3c4714(this,function(){const _0x147a08=a183_0x4fc6;return a183_0x5eae68['toString']()[_0x147a08(0x17f)](_0x147a08(0x191))[_0x147a08(0x13f)]()[_0x147a08(0x14b)](a183_0x5eae68)[_0x147a08(0x17f)](_0x147a08(0x191));});a183_0x5eae68();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a183_0x113de5(0x17d)]?function(_0x10a846,_0xc21a24,_0x3fb347,_0x28303a){const _0x561daa=a183_0x113de5;if(_0x28303a===undefined)_0x28303a=_0x3fb347;Object[_0x561daa(0x13c)](_0x10a846,_0x28303a,{'enumerable':!![],'get':function(){return _0xc21a24[_0x3fb347];}});}:function(_0x46dba2,_0x4cfee5,_0x289d65,_0x3e362d){if(_0x3e362d===undefined)_0x3e362d=_0x289d65;_0x46dba2[_0x3e362d]=_0x4cfee5[_0x289d65];}),__setModuleDefault=this&&this[a183_0x113de5(0x186)]||(Object['create']?function(_0x5b1f76,_0x27726e){const _0x3a2699=a183_0x113de5;Object[_0x3a2699(0x13c)](_0x5b1f76,_0x3a2699(0x189),{'enumerable':!![],'value':_0x27726e});}:function(_0x4076c6,_0x21577b){const _0x2567f8=a183_0x113de5;_0x4076c6[_0x2567f8(0x189)]=_0x21577b;}),__decorate=this&&this[a183_0x113de5(0x171)]||function(_0x563854,_0x122ea6,_0x4491dd,_0x4bda6e){const _0x5d4522=a183_0x113de5;var _0x49b212=arguments[_0x5d4522(0x15c)],_0x275f54=_0x49b212<0x3?_0x122ea6:_0x4bda6e===null?_0x4bda6e=Object[_0x5d4522(0x152)](_0x122ea6,_0x4491dd):_0x4bda6e,_0x3a614b;if(typeof Reflect==='object'&&typeof Reflect[_0x5d4522(0x181)]===_0x5d4522(0x12e))_0x275f54=Reflect[_0x5d4522(0x181)](_0x563854,_0x122ea6,_0x4491dd,_0x4bda6e);else{for(var _0x1e8cd2=_0x563854['length']-0x1;_0x1e8cd2>=0x0;_0x1e8cd2--)if(_0x3a614b=_0x563854[_0x1e8cd2])_0x275f54=(_0x49b212<0x3?_0x3a614b(_0x275f54):_0x49b212>0x3?_0x3a614b(_0x122ea6,_0x4491dd,_0x275f54):_0x3a614b(_0x122ea6,_0x4491dd))||_0x275f54;}return _0x49b212>0x3&&_0x275f54&&Object['defineProperty'](_0x122ea6,_0x4491dd,_0x275f54),_0x275f54;},__importStar=this&&this[a183_0x113de5(0x14e)]||function(_0x5ac9c0){const _0x4e3394=a183_0x113de5;if(_0x5ac9c0&&_0x5ac9c0[_0x4e3394(0x169)])return _0x5ac9c0;var _0x5f4258={};if(_0x5ac9c0!=null){for(var _0x286c78 in _0x5ac9c0)if(_0x286c78!==_0x4e3394(0x189)&&Object[_0x4e3394(0x127)][_0x4e3394(0x163)][_0x4e3394(0x140)](_0x5ac9c0,_0x286c78))__createBinding(_0x5f4258,_0x5ac9c0,_0x286c78);}return __setModuleDefault(_0x5f4258,_0x5ac9c0),_0x5f4258;},__metadata=this&&this[a183_0x113de5(0x12d)]||function(_0x4b62ef,_0x591b30){const _0x3165fb=a183_0x113de5;if(typeof Reflect==='object'&&typeof Reflect[_0x3165fb(0x121)]===_0x3165fb(0x12e))return Reflect[_0x3165fb(0x121)](_0x4b62ef,_0x591b30);},GitCommitJob_1;function a183_0x1d66(){const _0x4f3863=['defineProperty','Completed','checkoutTo','toString','call','../../salesforce/utils/sfdx.utils','mdapiUtils','GitCommitService','email','16850008YNPqko','66YneKSl','MDApiUtils','setLoggerId','catch','git\x20commit\x20job\x20done\x20(´･ω･`)','constructor','typedi','fileNames','__importStar','sfLogger','SFDX','getCredentialsFor','getOwnPropertyDescriptor','SalesforceLogger2','../../shared/utils','cleanUp','values','gitUtils','getCurrentHash','GitCommitJob','proceedCommits','branch','length','start\x20force\x20commit\x20job\x20to\x20sync\x20repository','://','../../shared/services/auth-settings.service','authSettings','DEFAULT_GIT_USER_NAME','flat','hasOwnProperty','apply','[INFO]\x20Download\x20components\x20metadata\x20from\x20flosum.','DEFAULT_GIT_USER_EMAIL','725480slpHld','lastCommitHash','__esModule','BitbucketApiService','prepareGitChangedPaths','author','send','logger','[INFO]\x20Branch\x20synchronized.\x20Skip','\x20before\x20sync.','__decorate','1746772zOKhiu','getRemote','map','clone','[ERROR]\x20Error\x20has\x20occurred\x20when\x20commit\x20from\x20git\x20to\x20flosum\x20-\x20','username','readDir','design:paramtypes','../../salesforce/errors/salesforce.error','3270584VZcoFV','fetchCommits','create','removeDir','search','fetching\x20git\x20commits','decorate',']\x20[Branch:\x20','repository','../../internal/fs.internal','isSFDXProject','__setModuleDefault','changes','updateRemoteState','default','files','[GIT\x20->\x20FLOSUM]\x20[Repository:\x20','provider','[INFO]\x20Proceeded\x20','force','push','[INFO]\x20Force\x20commit.\x20Have\x20to\x20parse\x20','(((.+)+)+)+$','../services/git-commit.service','run','getProtocol','log',']\x20Start\x20proceeding\x20git\x20commits.\x20','Logger','../utils/mdapi.utils','updateStatus','removeLogger','../../../core','message','gitCommitData','3031824rYygrS','fetchRepositoryOrBranchData','getBranchId','sync\x20components','repositoryGit','shift','get','setCommitDto','GitUtils','Service','5624870YcNTuG','metadata','replace','path','dir','../../../constants','../../salesforce/errors/not-found.error','prototype','AuthSettingsService','../utils/git.utils','[INFO]\x20Fetch\x20changes\x20files\x20from\x20git\x20commits.','checkSyncStatus','name','__metadata','function','Error','SalesforceError','../../salesforce/services/salesforce-commits-manager.service','clone\x20repository\x20from\x20%s','1602114gzRcnG','getRepositoryId','../../git-api/services/bitbucket-api.service','proceed\x20git\x20commits\x20to\x20flosum','SalesforceCommitsManager','getLoggerId','FlosumCommitError','gitCommit','[INFO]\x20Fetch\x20salesforce\x20data.'];a183_0x1d66=function(){return _0x4f3863;};return a183_0x1d66();}Object['defineProperty'](exports,a183_0x113de5(0x169),{'value':!![]}),exports[a183_0x113de5(0x159)]=void 0x0;const core_1=require(a183_0x113de5(0x19b)),fs_internal_1=require(a183_0x113de5(0x184)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),auth_settings_service_1=require(a183_0x113de5(0x15f)),utils_1=require(a183_0x113de5(0x154)),path_1=require(a183_0x113de5(0x123)),typedi_1=__importStar(require(a183_0x113de5(0x14c))),constants_1=require(a183_0x113de5(0x125)),salesforce_commits_manager_service_1=require(a183_0x113de5(0x131)),git_commit_utils_1=require('../utils/git-commit.utils'),git_utils_1=require(a183_0x113de5(0x129)),mdapi_utils_1=require(a183_0x113de5(0x198)),api_error_1=require('../../../core/errors/api.error'),salesforce_error_1=require(a183_0x113de5(0x17a)),git_commit_service_1=require(a183_0x113de5(0x192)),flosum_commit_error_1=require('../errors/flosum-commit.error'),not_found_error_1=require(a183_0x113de5(0x126)),bitbucket_api_service_1=require(a183_0x113de5(0x135)),sfdx_utils_1=require(a183_0x113de5(0x141));let GitCommitJob=GitCommitJob_1=class GitCommitJob{constructor(_0x17f9da,_0x42c7e5){const _0x44cf51=a183_0x113de5;this[_0x44cf51(0x160)]=_0x17f9da,this[_0x44cf51(0x13a)]=_0x42c7e5,this['logger']=new core_1[(_0x44cf51(0x197))](GitCommitJob_1[_0x44cf51(0x12c)]);}async[a183_0x113de5(0x173)](){const _0x3378c2=a183_0x113de5,{repositoryGit:_0xc720c8}=this['gitCommitData'];let _0x1b002f=this[_0x3378c2(0x160)][_0x3378c2(0x151)](this[_0x3378c2(0x19d)][_0x3378c2(0x18c)]);if(this[_0x3378c2(0x19d)][_0x3378c2(0x18c)]==='bitbucket'){const _0xea70c5=typedi_1[_0x3378c2(0x189)][_0x3378c2(0x11c)](bitbucket_api_service_1[_0x3378c2(0x16a)]);await _0xea70c5['isLoggedIn'](),_0x1b002f+=encodeURIComponent(_0xea70c5['getAccessToken']());}return _0xc720c8[_0x3378c2(0x122)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x3378c2(0x194)](_0xc720c8)+_0x3378c2(0x15e)+_0x1b002f+'@');}async['fetchCommits'](){const _0x50fd46=a183_0x113de5;if(this[_0x50fd46(0x19d)][_0x50fd46(0x18e)])return;const _0x4160b3=[];for(const _0x36f60e of this[_0x50fd46(0x19d)]['commits']){const _0x9a09d5=await this[_0x50fd46(0x157)]['describeCommit'](_0x36f60e['id']);_0x36f60e[_0x50fd46(0x177)]=_0x9a09d5[_0x50fd46(0x16c)],_0x36f60e[_0x50fd46(0x19c)]=_0x9a09d5['message'],_0x36f60e[_0x50fd46(0x18a)]=_0x9a09d5[_0x50fd46(0x187)],_0x36f60e[_0x50fd46(0x144)]=_0x9a09d5[_0x50fd46(0x144)];if(_0x36f60e[_0x50fd46(0x144)]===constants_1[_0x50fd46(0x166)])throw new flosum_commit_error_1[(_0x50fd46(0x139))]();_0x4160b3[_0x50fd46(0x18f)](...Object[_0x50fd46(0x156)](_0x36f60e[_0x50fd46(0x18a)])[_0x50fd46(0x162)]());}this['gitCommitData'][_0x50fd46(0x14d)]=git_commit_utils_1[_0x50fd46(0x16b)]([...new Set(_0x4160b3)]);}async[a183_0x113de5(0x15a)](_0x40a9f3){const _0x32b35f=a183_0x113de5,_0x41107c=[...this['gitCommitData']['commits']],_0x27547b=_0x41107c[_0x32b35f(0x15c)],_0x2eb56f=[];while(_0x41107c[_0x32b35f(0x15c)]){const _0x1916a8=_0x41107c[_0x32b35f(0x11b)]();!this[_0x32b35f(0x19d)][_0x32b35f(0x18e)]&&(this[_0x32b35f(0x13a)][_0x32b35f(0x134)]()?await this['gitUtils'][_0x32b35f(0x13e)](_0x1916a8['id']):await this[_0x32b35f(0x157)][_0x32b35f(0x13e)](this[_0x32b35f(0x168)])),_0x2eb56f['push'](await this[_0x32b35f(0x13a)]['proceedGitCommit'](_0x1916a8,this[_0x32b35f(0x142)]['dir'],_0x40a9f3)),await this[_0x32b35f(0x14f)][_0x32b35f(0x195)](_0x32b35f(0x18d)+_0x2eb56f[_0x32b35f(0x15c)]+'/'+_0x27547b)[_0x32b35f(0x16d)]();}const _0x25883a=new salesforce_commits_manager_service_1[(_0x32b35f(0x137))]({'recordTypes':this[_0x32b35f(0x13a)]['getRecordTypes'](),'branchId':this[_0x32b35f(0x13a)][_0x32b35f(0x1a0)](),'repositoryId':this[_0x32b35f(0x13a)][_0x32b35f(0x134)](),'logger':this[_0x32b35f(0x14f)]});await _0x25883a[_0x32b35f(0x15a)](_0x2eb56f);}async[a183_0x113de5(0x155)](){const _0x9985f6=a183_0x113de5;this[_0x9985f6(0x157)]&&await this[_0x9985f6(0x157)][_0x9985f6(0x17e)]()[_0x9985f6(0x149)](()=>void 0x0),this[_0x9985f6(0x142)]&&await this[_0x9985f6(0x142)]['removeDir']()['catch'](()=>void 0x0);}async[a183_0x113de5(0x193)](_0x39c899,_0x305521){const _0x2bd149=a183_0x113de5;this[_0x2bd149(0x19d)]=_0x39c899,this[_0x2bd149(0x13a)][_0x2bd149(0x11d)](this[_0x2bd149(0x19d)]),this[_0x2bd149(0x14f)]=new salesforce_logger_v2_service_1[(_0x2bd149(0x153))](_0x305521?_0x305521[_0x2bd149(0x138)]():undefined,(_0x305521&&_0x305521['getPrefix']()||_0x2bd149(0x18b)+_0x39c899[_0x2bd149(0x183)]+_0x2bd149(0x182)+_0x39c899[_0x2bd149(0x15b)]+']')+'\x20['+GitCommitJob_1[_0x2bd149(0x12c)]+']'),this[_0x2bd149(0x157)]=new git_utils_1[(_0x2bd149(0x11e))](await this['getRemote']()),this[_0x2bd149(0x142)]=new mdapi_utils_1[(_0x2bd149(0x147))](this[_0x2bd149(0x19d)]['repository'],this[_0x2bd149(0x19d)][_0x2bd149(0x15b)]);try{this['logger'][_0x2bd149(0x195)]('fetch\x20repository/branch\x20data'),this[_0x2bd149(0x14f)]['log'](_0x2bd149(0x13b)),await this[_0x2bd149(0x13a)][_0x2bd149(0x19f)](),this[_0x2bd149(0x16e)][_0x2bd149(0x195)](_0x2bd149(0x132),this['gitCommitData']['repositoryGit']),this[_0x2bd149(0x14f)][_0x2bd149(0x195)]('[INFO]\x20Clone\x20git\x20repository.'),await this['gitUtils'][_0x2bd149(0x175)](this[_0x2bd149(0x19d)][_0x2bd149(0x15b)],this[_0x2bd149(0x19d)]['repository']),this[_0x2bd149(0x16e)][_0x2bd149(0x195)](_0x2bd149(0x180)),this[_0x2bd149(0x14f)][_0x2bd149(0x195)](_0x2bd149(0x12a)),await this[_0x2bd149(0x17c)]();!this[_0x2bd149(0x14f)][_0x2bd149(0x138)]()&&this[_0x2bd149(0x14f)][_0x2bd149(0x148)]((await salesforce_logger_v2_service_1['SalesforceLogger2']['createLogger']())[_0x2bd149(0x138)]());await this[_0x2bd149(0x13a)][_0x2bd149(0x199)]('In\x20Progress'),this[_0x2bd149(0x16e)][_0x2bd149(0x195)]('prepare\x20mdapi\x20to\x20parse'),await this[_0x2bd149(0x142)]['prepareMdapi'](this[_0x2bd149(0x157)][_0x2bd149(0x124)]);if(_0x39c899[_0x2bd149(0x18e)]){this[_0x2bd149(0x16e)][_0x2bd149(0x195)](_0x2bd149(0x15d));const _0x259489=(await fs_internal_1['FS'][_0x2bd149(0x178)](this[_0x2bd149(0x142)][_0x2bd149(0x124)],!![]))[_0x2bd149(0x174)](_0x1a158e=>path_1['relative'](this[_0x2bd149(0x142)]['dir'],_0x1a158e));this[_0x2bd149(0x14f)]['log'](_0x2bd149(0x190)+_0x259489[_0x2bd149(0x15c)]+_0x2bd149(0x170)),this['gitCommitData'][_0x2bd149(0x14d)]=[],this['gitCommitData']['commits']=[{'files':{'modified':_0x259489,'added':[],'removed':[]},'id':await this[_0x2bd149(0x157)][_0x2bd149(0x158)](),'message':_0x2bd149(0x1a1),'username':constants_1[_0x2bd149(0x161)]}];}this[_0x2bd149(0x168)]=this[_0x2bd149(0x19d)]['commits'][this[_0x2bd149(0x19d)]['commits'][_0x2bd149(0x15c)]-0x1]['id'];const _0x1f2f86=await this[_0x2bd149(0x13a)][_0x2bd149(0x12b)](this[_0x2bd149(0x168)]);if(_0x1f2f86){await this[_0x2bd149(0x14f)][_0x2bd149(0x195)](_0x2bd149(0x16f))[_0x2bd149(0x16d)](),await this[_0x2bd149(0x13a)]['updateStatus']('Completed');return;}const _0x5b126e=await sfdx_utils_1[_0x2bd149(0x150)][_0x2bd149(0x185)](this[_0x2bd149(0x157)][_0x2bd149(0x124)]);this[_0x2bd149(0x16e)][_0x2bd149(0x195)]('fetch\x20components\x20metadata'),await this[_0x2bd149(0x14f)][_0x2bd149(0x195)](_0x2bd149(0x165)),await this[_0x2bd149(0x13a)]['fetchComponentsMetadata'](_0x5b126e),await this[_0x2bd149(0x13a)][_0x2bd149(0x188)]({[this['gitCommitData'][_0x2bd149(0x1a2)]]:{'lastCommit':this[_0x2bd149(0x168)]}}),this[_0x2bd149(0x16e)][_0x2bd149(0x195)](_0x2bd149(0x136)),this[_0x2bd149(0x14f)][_0x2bd149(0x195)]('[INFO]\x20[SFDX:\x20'+(_0x5b126e?'YES':'NO')+_0x2bd149(0x196)),await this[_0x2bd149(0x15a)](_0x5b126e),this[_0x2bd149(0x16e)][_0x2bd149(0x195)](_0x2bd149(0x14a)),await this[_0x2bd149(0x14f)][_0x2bd149(0x195)]('[INFO]\x20Job\x20done.'),await this[_0x2bd149(0x13a)][_0x2bd149(0x199)](_0x2bd149(0x13d));}catch(_0x46b887){await this[_0x2bd149(0x155)](),this['logger']['error'](_0x46b887);if(_0x46b887 instanceof not_found_error_1['SalesforceNotFoundError']){await this[_0x2bd149(0x14f)][_0x2bd149(0x19a)]();return;}if(_0x46b887 instanceof flosum_commit_error_1['FlosumCommitError']){await this['sfLogger'][_0x2bd149(0x19a)]();return;}this[_0x2bd149(0x14f)][_0x2bd149(0x195)](_0x2bd149(0x176)+(_0x46b887 instanceof api_error_1['ApiError']||_0x46b887 instanceof salesforce_error_1[_0x2bd149(0x130)]?_0x46b887[_0x2bd149(0x13f)]():_0x46b887)),await this[_0x2bd149(0x13a)][_0x2bd149(0x188)]({}),await this['gitCommit'][_0x2bd149(0x199)](_0x2bd149(0x12f))['catch'](()=>void 0x0);throw _0x46b887;}finally{await this[_0x2bd149(0x155)](),await this[_0x2bd149(0x14f)]['send']()[_0x2bd149(0x149)](()=>void 0x0);}}};function a183_0x4fc6(_0x5cd32d,_0x95e4f7){const _0x37a94f=a183_0x1d66();return a183_0x4fc6=function(_0x5eae68,_0x3c4714){_0x5eae68=_0x5eae68-0x11b;let _0x1d669c=_0x37a94f[_0x5eae68];return _0x1d669c;},a183_0x4fc6(_0x5cd32d,_0x95e4f7);}GitCommitJob=GitCommitJob_1=__decorate([typedi_1[a183_0x113de5(0x11f)]({'transient':!![]}),__metadata(a183_0x113de5(0x179),[auth_settings_service_1[a183_0x113de5(0x128)],git_commit_service_1[a183_0x113de5(0x143)]])],GitCommitJob),exports[a183_0x113de5(0x159)]=GitCommitJob;