const a183_0xeac3b3=a183_0x260e;function a183_0x5ca6(){const _0xb3a7b6=['metadata','then','create','gitUrl','../../salesforce/services/salesforce.service','DEFAULT_GIT_USER_NAME','8041140mftoKW','7xmZVPs','createBranchIfNotExists','apply','syncData','provider','194692LMbztF','716SybLhq','salesforceService','[INFO]\x20Update\x20remote\x20state.','branch','branchId','search','[INFO]\x20Branch\x20synchronized.\x20Skip','log','updateLastCommit','../../salesforce/services/salesforce-retriever.service','CommitComponentsDto','typedi','toString','SalesforceLogger2','convertToSFDX','repositoryName','__esModule','function','FlosumSyncJob','sha','length','Sync\x20repository','design:paramtypes','getLoggerId','run','../../salesforce/services/salesforce-sync.service','getOwnPropertyDescriptor','defineProperty',']\x20[Branch:\x20','__decorate','repo','sfLogger','retrieveAttachment','2215146kHNfaa','getComponentsFromRepository','1202547YlxVLn','getCommitDto','updateRemoteState','branchName','user','SalesforceSyncService','object','24rMKGEQ','2yPBNSp','11rORrnE','Logger','decorate','string','DEFAULT_GIT_USER_EMAIL','components','constructor','[INFO]\x20Start\x20sync\x20job','send','setStatus','catch','repository','salesforceSync','1124289VhOAze','1835xnVbbH','getOne','../dto/commit-components.dto','repositoryId','../../salesforce/services/salesforce-logger-v2.service','getBranchComponents','__metadata','lastCommit','checkSyncStatus','getComponentIds','Completed','getPrefix','3439730oijDnh','Service','branches','parse','In\x20Progress','commitJob'];a183_0x5ca6=function(){return _0xb3a7b6;};return a183_0x5ca6();}function a183_0x260e(_0x5c0527,_0x6c8851){const _0x1e96a8=a183_0x5ca6();return a183_0x260e=function(_0x17fc88,_0x4bcd57){_0x17fc88=_0x17fc88-0x19f;let _0x5ca69d=_0x1e96a8[_0x17fc88];return _0x5ca69d;},a183_0x260e(_0x5c0527,_0x6c8851);}(function(_0x211350,_0x452010){const _0x54234c=a183_0x260e,_0xbafca8=_0x211350();while(!![]){try{const _0x55234a=parseInt(_0x54234c(0x1ca))/0x1*(parseInt(_0x54234c(0x1f6))/0x2)+parseInt(_0x54234c(0x1ee))/0x3+parseInt(_0x54234c(0x1cb))/0x4*(-parseInt(_0x54234c(0x1ac))/0x5)+-parseInt(_0x54234c(0x1ec))/0x6*(parseInt(_0x54234c(0x1c5))/0x7)+parseInt(_0x54234c(0x1f5))/0x8*(parseInt(_0x54234c(0x1ab))/0x9)+parseInt(_0x54234c(0x1b8))/0xa*(parseInt(_0x54234c(0x1f7))/0xb)+-parseInt(_0x54234c(0x1c4))/0xc;if(_0x55234a===_0x452010)break;else _0xbafca8['push'](_0xbafca8['shift']());}catch(_0x3cfef3){_0xbafca8['push'](_0xbafca8['shift']());}}}(a183_0x5ca6,0x33192));const a183_0x4bcd57=(function(){let _0x376ec0=!![];return function(_0x7c90b8,_0x4e131a){const _0x3ad970=_0x376ec0?function(){const _0x29a21b=a183_0x260e;if(_0x4e131a){const _0x1f50db=_0x4e131a[_0x29a21b(0x1c7)](_0x7c90b8,arguments);return _0x4e131a=null,_0x1f50db;}}:function(){};return _0x376ec0=![],_0x3ad970;};}()),a183_0x17fc88=a183_0x4bcd57(this,function(){const _0x1f7927=a183_0x260e;return a183_0x17fc88[_0x1f7927(0x1d7)]()[_0x1f7927(0x1d0)]('(((.+)+)+)+$')['toString']()[_0x1f7927(0x1a4)](a183_0x17fc88)['search']('(((.+)+)+)+$');});a183_0x17fc88();'use strict';var __decorate=this&&this[a183_0xeac3b3(0x1e8)]||function(_0x1b465a,_0x30e5a1,_0x446bd4,_0xb42a9d){const _0xb20393=a183_0xeac3b3;var _0x314605=arguments[_0xb20393(0x1df)],_0xb45ca0=_0x314605<0x3?_0x30e5a1:_0xb42a9d===null?_0xb42a9d=Object[_0xb20393(0x1e5)](_0x30e5a1,_0x446bd4):_0xb42a9d,_0x4d96c1;if(typeof Reflect===_0xb20393(0x1f4)&&typeof Reflect[_0xb20393(0x1a0)]===_0xb20393(0x1dc))_0xb45ca0=Reflect[_0xb20393(0x1a0)](_0x1b465a,_0x30e5a1,_0x446bd4,_0xb42a9d);else{for(var _0x2cacd1=_0x1b465a['length']-0x1;_0x2cacd1>=0x0;_0x2cacd1--)if(_0x4d96c1=_0x1b465a[_0x2cacd1])_0xb45ca0=(_0x314605<0x3?_0x4d96c1(_0xb45ca0):_0x314605>0x3?_0x4d96c1(_0x30e5a1,_0x446bd4,_0xb45ca0):_0x4d96c1(_0x30e5a1,_0x446bd4))||_0xb45ca0;}return _0x314605>0x3&&_0xb45ca0&&Object[_0xb20393(0x1e6)](_0x30e5a1,_0x446bd4,_0xb45ca0),_0xb45ca0;},__metadata=this&&this[a183_0xeac3b3(0x1b2)]||function(_0x3dc812,_0x531aa7){const _0x4def66=a183_0xeac3b3;if(typeof Reflect===_0x4def66(0x1f4)&&typeof Reflect[_0x4def66(0x1be)]===_0x4def66(0x1dc))return Reflect[_0x4def66(0x1be)](_0x3dc812,_0x531aa7);},FlosumSyncJob_1;Object[a183_0xeac3b3(0x1e6)](exports,a183_0xeac3b3(0x1db),{'value':!![]}),exports[a183_0xeac3b3(0x1dd)]=void 0x0;const core_1=require('../../../core'),salesforce_logger_v2_service_1=require(a183_0xeac3b3(0x1b0)),typedi_1=require(a183_0xeac3b3(0x1d6)),constants_1=require('../../../constants'),salesforce_retriever_service_1=require(a183_0xeac3b3(0x1d4)),salesforce_sync_service_1=require(a183_0xeac3b3(0x1e4)),salesforce_service_1=require(a183_0xeac3b3(0x1c2)),commit_components_dto_1=require(a183_0xeac3b3(0x1ae)),commit_components_job_1=require('./commit-components.job');let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0x1dded6,_0x20af39,_0x2a32ba){const _0x2d3e30=a183_0xeac3b3;this[_0x2d3e30(0x1aa)]=_0x1dded6,this[_0x2d3e30(0x1cc)]=_0x20af39,this['commitJob']=_0x2a32ba,this['logger']=new core_1[(_0x2d3e30(0x19f))](FlosumSyncJob_1['name']);}[a183_0xeac3b3(0x1d2)](_0x18ecb0){const _0x4da677=a183_0xeac3b3;return this[_0x4da677(0x1ea)][_0x4da677(0x1d2)]('[FLOSUM\x20->\x20GIT]\x20[Repository:\x20'+this[_0x4da677(0x1c8)]['repositoryName']+_0x4da677(0x1e7)+this['syncData'][_0x4da677(0x1f1)]+']\x20'+_0x18ecb0);}async['createBranchIfNotExists'](){const _0x30d4f4=a183_0xeac3b3;let _0x593957=await this[_0x30d4f4(0x1a9)][_0x30d4f4(0x1ba)]['getOne'](this[_0x30d4f4(0x1c8)][_0x30d4f4(0x1f1)])[_0x30d4f4(0x1a8)](()=>null);!_0x593957&&(_0x593957=await this[_0x30d4f4(0x1a9)]['branches'][_0x30d4f4(0x1c0)]({'name':this[_0x30d4f4(0x1c8)]['branchName']})),this[_0x30d4f4(0x1ce)]=_0x593957;}async['getComponentIds'](){const _0x34db8b=a183_0xeac3b3;return this[_0x34db8b(0x1c8)]['repositoryId']?this[_0x34db8b(0x1aa)][_0x34db8b(0x1ed)](this[_0x34db8b(0x1c8)][_0x34db8b(0x1af)]):this['salesforceSync'][_0x34db8b(0x1b1)](this[_0x34db8b(0x1c8)][_0x34db8b(0x1cf)]);}async['getComponents'](){const _0x32eca7=a183_0xeac3b3,_0x1b8dd3=await this[_0x32eca7(0x1b5)](),_0x16ad36=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x32eca7(0x1cc)]),_0x5974e7=await _0x16ad36[_0x32eca7(0x1e3)](_0x1b8dd3);return _0x5974e7;}async[a183_0xeac3b3(0x1ef)](_0x511c63){const _0x1e1e73=a183_0xeac3b3,_0x5ac449=new commit_components_dto_1[(_0x1e1e73(0x1d5))]();return _0x5ac449['message']=_0x1e1e73(0x1e0),_0x5ac449[_0x1e1e73(0x1f2)]={'name':constants_1[_0x1e1e73(0x1c3)],'email':constants_1[_0x1e1e73(0x1a2)]},_0x5ac449[_0x1e1e73(0x1a3)]={'writed':await this['getComponents']()},_0x5ac449[_0x1e1e73(0x1d9)]=_0x511c63,_0x5ac449[_0x1e1e73(0x1e9)]=this[_0x1e1e73(0x1a9)],_0x5ac449[_0x1e1e73(0x1ce)]=this['branch'],_0x5ac449['force']=!![],_0x5ac449[_0x1e1e73(0x1c9)]=this[_0x1e1e73(0x1c9)],_0x5ac449;}async[a183_0xeac3b3(0x1b4)](){const _0x4ab1ee=a183_0xeac3b3,_0x517253=await this[_0x4ab1ee(0x1aa)]['getRemoteStateAttachmentId'](this['syncData']),_0x18e0ee=await this['salesforceService'][_0x4ab1ee(0x1eb)](_0x517253)[_0x4ab1ee(0x1bf)](_0x44abe3=>typeof _0x44abe3===_0x4ab1ee(0x1a1)?JSON[_0x4ab1ee(0x1bb)](_0x44abe3):_0x44abe3)[_0x4ab1ee(0x1a8)](()=>({}));if(_0x18e0ee[this[_0x4ab1ee(0x1a9)][_0x4ab1ee(0x1c1)]]){if(_0x18e0ee[this[_0x4ab1ee(0x1a9)][_0x4ab1ee(0x1c1)]][_0x4ab1ee(0x1b3)]===this[_0x4ab1ee(0x1ce)]['sha'])return!![];}return![];}async[a183_0xeac3b3(0x1d3)](){const _0x24e5d7=a183_0xeac3b3,_0x3da0e3=await this[_0x24e5d7(0x1a9)][_0x24e5d7(0x1ba)][_0x24e5d7(0x1ad)](this[_0x24e5d7(0x1ce)]['name']);await this[_0x24e5d7(0x1d2)](_0x24e5d7(0x1cd));const _0x34030c={[this[_0x24e5d7(0x1a9)]['gitUrl']]:{'lastCommit':_0x3da0e3[_0x24e5d7(0x1de)]}};await this['salesforceSync'][_0x24e5d7(0x1f0)](this[_0x24e5d7(0x1c8)],_0x34030c);}async[a183_0xeac3b3(0x1e3)]({syncRecord:_0xa795c3,repository:_0x58fda9,logger:_0x24d56b,convertToSFDX:_0x454454,provider:_0x4ef389}){const _0xebe2cf=a183_0xeac3b3;this[_0xebe2cf(0x1c8)]=_0xa795c3,this['provider']=_0x4ef389,this[_0xebe2cf(0x1a9)]=_0x58fda9,this[_0xebe2cf(0x1ea)]=new salesforce_logger_v2_service_1[(_0xebe2cf(0x1d8))](_0x24d56b[_0xebe2cf(0x1e2)](),_0x24d56b[_0xebe2cf(0x1b7)]()+'\x20[FLOSUM\x20->\x20GIT]\x20[Repository:\x20'+this[_0xebe2cf(0x1c8)][_0xebe2cf(0x1da)]+_0xebe2cf(0x1e7)+this[_0xebe2cf(0x1c8)][_0xebe2cf(0x1f1)]+']');try{await this[_0xebe2cf(0x1aa)][_0xebe2cf(0x1a7)](this[_0xebe2cf(0x1c8)],_0xebe2cf(0x1bc)),this[_0xebe2cf(0x1d2)](_0xebe2cf(0x1a5)),await this[_0xebe2cf(0x1c6)]();const _0x2ba259=await this[_0xebe2cf(0x1b4)]();if(_0x2ba259){await this[_0xebe2cf(0x1aa)][_0xebe2cf(0x1a7)](this[_0xebe2cf(0x1c8)],_0xebe2cf(0x1b6)),await this[_0xebe2cf(0x1d2)](_0xebe2cf(0x1d1))[_0xebe2cf(0x1a6)]();return;}const _0x2e8ce0=await this[_0xebe2cf(0x1ef)](_0x454454);await this[_0xebe2cf(0x1bd)][_0xebe2cf(0x1e3)](_0x2e8ce0,this[_0xebe2cf(0x1ea)]),await this['salesforceSync'][_0xebe2cf(0x1a7)](this[_0xebe2cf(0x1c8)],'Completed'),await this[_0xebe2cf(0x1d3)](),this[_0xebe2cf(0x1d2)]('[INFO]\x20Sync\x20job\x20done.');}catch(_0x348954){throw _0x348954;}finally{await this[_0xebe2cf(0x1ea)][_0xebe2cf(0x1a6)]();}}};FlosumSyncJob=FlosumSyncJob_1=__decorate([typedi_1[a183_0xeac3b3(0x1b9)]({'transient':!![]}),__metadata(a183_0xeac3b3(0x1e1),[salesforce_sync_service_1[a183_0xeac3b3(0x1f3)],salesforce_service_1['SalesforceService'],commit_components_job_1['CommitComponentsJob']])],FlosumSyncJob),exports[a183_0xeac3b3(0x1dd)]=FlosumSyncJob;