function a181_0x1de7(_0x171b72,_0x3b914f){const _0x16ba4f=a181_0x3a1f();return a181_0x1de7=function(_0x4a45dd,_0x565ca1){_0x4a45dd=_0x4a45dd-0x17e;let _0x3a1f7f=_0x16ba4f[_0x4a45dd];return _0x3a1f7f;},a181_0x1de7(_0x171b72,_0x3b914f);}const a181_0x122719=a181_0x1de7;(function(_0x4c3465,_0x1cc5f8){const _0x2de5af=a181_0x1de7,_0x2ad849=_0x4c3465();while(!![]){try{const _0x5da4ed=parseInt(_0x2de5af(0x1a9))/0x1*(parseInt(_0x2de5af(0x1c7))/0x2)+parseInt(_0x2de5af(0x1d4))/0x3*(parseInt(_0x2de5af(0x18a))/0x4)+-parseInt(_0x2de5af(0x18e))/0x5*(parseInt(_0x2de5af(0x19b))/0x6)+-parseInt(_0x2de5af(0x1af))/0x7*(-parseInt(_0x2de5af(0x1a7))/0x8)+-parseInt(_0x2de5af(0x1ad))/0x9+parseInt(_0x2de5af(0x1b0))/0xa*(-parseInt(_0x2de5af(0x1b7))/0xb)+-parseInt(_0x2de5af(0x1d7))/0xc*(-parseInt(_0x2de5af(0x197))/0xd);if(_0x5da4ed===_0x1cc5f8)break;else _0x2ad849['push'](_0x2ad849['shift']());}catch(_0x31d20f){_0x2ad849['push'](_0x2ad849['shift']());}}}(a181_0x3a1f,0x46290));const a181_0x565ca1=(function(){let _0x59ddd2=!![];return function(_0x5e9118,_0x8b3b51){const _0x2e00c8=_0x59ddd2?function(){const _0x3ad32f=a181_0x1de7;if(_0x8b3b51){const _0x438488=_0x8b3b51[_0x3ad32f(0x1c2)](_0x5e9118,arguments);return _0x8b3b51=null,_0x438488;}}:function(){};return _0x59ddd2=![],_0x2e00c8;};}()),a181_0x4a45dd=a181_0x565ca1(this,function(){const _0x469158=a181_0x1de7;return a181_0x4a45dd[_0x469158(0x188)]()[_0x469158(0x1d2)]('(((.+)+)+)+$')[_0x469158(0x188)]()[_0x469158(0x187)](a181_0x4a45dd)[_0x469158(0x1d2)](_0x469158(0x182));});a181_0x4a45dd();'use strict';var __decorate=this&&this[a181_0x122719(0x1a8)]||function(_0x32ba3c,_0x17156e,_0x1e1158,_0x2cbcdb){const _0x3fd9a7=a181_0x122719;var _0x2978a5=arguments[_0x3fd9a7(0x193)],_0x308a18=_0x2978a5<0x3?_0x17156e:_0x2cbcdb===null?_0x2cbcdb=Object['getOwnPropertyDescriptor'](_0x17156e,_0x1e1158):_0x2cbcdb,_0x3926a2;if(typeof Reflect==='object'&&typeof Reflect[_0x3fd9a7(0x19f)]===_0x3fd9a7(0x1df))_0x308a18=Reflect['decorate'](_0x32ba3c,_0x17156e,_0x1e1158,_0x2cbcdb);else{for(var _0x35a225=_0x32ba3c[_0x3fd9a7(0x193)]-0x1;_0x35a225>=0x0;_0x35a225--)if(_0x3926a2=_0x32ba3c[_0x35a225])_0x308a18=(_0x2978a5<0x3?_0x3926a2(_0x308a18):_0x2978a5>0x3?_0x3926a2(_0x17156e,_0x1e1158,_0x308a18):_0x3926a2(_0x17156e,_0x1e1158))||_0x308a18;}return _0x2978a5>0x3&&_0x308a18&&Object[_0x3fd9a7(0x184)](_0x17156e,_0x1e1158,_0x308a18),_0x308a18;},__metadata=this&&this[a181_0x122719(0x183)]||function(_0x1fa31f,_0x23ec4c){const _0x5333c9=a181_0x122719;if(typeof Reflect==='object'&&typeof Reflect[_0x5333c9(0x1de)]===_0x5333c9(0x1df))return Reflect[_0x5333c9(0x1de)](_0x1fa31f,_0x23ec4c);},FlosumCommitJob_1;Object[a181_0x122719(0x184)](exports,a181_0x122719(0x19a),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;const core_1=require(a181_0x122719(0x1c8)),salesforce_logger_v2_service_1=require(a181_0x122719(0x1a2)),salesforce_service_1=require(a181_0x122719(0x19c)),git_provider_manager_1=require(a181_0x122719(0x1b2)),typedi_1=require(a181_0x122719(0x1a6)),errors_1=require(a181_0x122719(0x1d3)),bad_request_error_1=require('../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a181_0x122719(0x192)),salesforce_sync_service_1=require(a181_0x122719(0x1c1)),commit_components_dto_1=require(a181_0x122719(0x18f)),commit_components_job_1=require(a181_0x122719(0x18d));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x31f474,_0x3f9336,_0x31d364,_0x320918){const _0x22be07=a181_0x122719;this[_0x22be07(0x1ab)]=_0x31f474,this['commitJob']=_0x3f9336,this[_0x22be07(0x1bd)]=_0x31d364,this['gitManager']=_0x320918,this[_0x22be07(0x1e0)]=this[_0x22be07(0x195)][_0x22be07(0x196)](),this[_0x22be07(0x1b9)]=new core_1[(_0x22be07(0x1d6))](FlosumCommitJob_1[_0x22be07(0x1ae)]);}async[a181_0x122719(0x1a0)](){const _0x5279e2=a181_0x122719;try{if(this['commitData'][_0x5279e2(0x1b6)])this[_0x5279e2(0x1e5)]=await this['salesforceSync']['getRepositoryRecord'](this[_0x5279e2(0x180)][_0x5279e2(0x1b6)]);else this[_0x5279e2(0x180)]['syncBranchId']&&(this[_0x5279e2(0x1e5)]=await this['salesforceSync'][_0x5279e2(0x1b5)](this[_0x5279e2(0x180)][_0x5279e2(0x1cd)]));}catch(_0x188fba){throw new bad_request_error_1[(_0x5279e2(0x1b1))](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async[a181_0x122719(0x1d1)](){const _0x1e83b3=a181_0x122719;if(!this['commitData'][_0x1e83b3(0x1e1)])return[];const _0x4f58fb=await this[_0x1e83b3(0x1ab)]['retrieveAttachment'](this[_0x1e83b3(0x180)][_0x1e83b3(0x1e1)])[_0x1e83b3(0x1d9)](_0x19580b=>_0x19580b[_0x1e83b3(0x1d8)]('\x20')[_0x1e83b3(0x1e4)](_0x219072=>_0x219072[_0x1e83b3(0x1bc)]())),_0x29a3f8=new salesforce_retriever_service_1[(_0x1e83b3(0x1c5))](this[_0x1e83b3(0x1ab)]),_0x2c8db9=await _0x29a3f8['run'](_0x4f58fb);return _0x2c8db9;}async[a181_0x122719(0x1b3)](){const _0x2e4093=a181_0x122719;if(!this['commitData'][_0x2e4093(0x1be)])return[];const _0x2b77b6=await this['salesforceService'][_0x2e4093(0x1dc)](this[_0x2e4093(0x180)][_0x2e4093(0x1be)]);return _0x2b77b6;}async['getCommitDto'](){const _0x377414=a181_0x122719,_0x1cbefe=new commit_components_dto_1[(_0x377414(0x199))](),[_0x389e99,_0x4026d7]=await Promise[_0x377414(0x18c)]([this[_0x377414(0x1d1)](),this[_0x377414(0x1b3)]()]);return _0x1cbefe[_0x377414(0x1a5)]=this['commitData'][_0x377414(0x1a5)],_0x1cbefe[_0x377414(0x1dd)]=this[_0x377414(0x180)][_0x377414(0x1dd)],_0x1cbefe['components']={'writed':_0x389e99,'deleted':_0x4026d7},_0x1cbefe['convertToSFDX']=this['commitData']['convertToSFDX'],_0x1cbefe[_0x377414(0x1aa)]=this['repository'],_0x1cbefe[_0x377414(0x1ac)]=this[_0x377414(0x1ac)],_0x1cbefe[_0x377414(0x1cc)]=this['provider'],_0x1cbefe;}async[a181_0x122719(0x1cf)](_0x3b346c=![]){const _0x5bf940=a181_0x122719;if(_0x3b346c)await this['salesforceSync']['updateRemoteState'](this[_0x5bf940(0x1e5)],{});else{const _0x578d8b=await this[_0x5bf940(0x1b4)][_0x5bf940(0x1c9)][_0x5bf940(0x1bf)](this['branch'][_0x5bf940(0x1ae)]);this['sfLogger'][_0x5bf940(0x190)](_0x5bf940(0x1da));const _0x4cb71e={[this['repository'][_0x5bf940(0x185)]]:{'lastCommit':_0x578d8b[_0x5bf940(0x1e2)]}};await this[_0x5bf940(0x1bd)][_0x5bf940(0x17f)](this[_0x5bf940(0x1e5)],_0x4cb71e);}}async['exec'](){const _0x2ddf5a=a181_0x122719,_0x4f7f3f=await this['getCommitDto']();await this['salesforceSync']['setStatus'](this[_0x2ddf5a(0x1e5)],_0x2ddf5a(0x1ca)),await this[_0x2ddf5a(0x17e)][_0x2ddf5a(0x194)](_0x4f7f3f,this[_0x2ddf5a(0x1db)]),await this[_0x2ddf5a(0x1cf)](),this[_0x2ddf5a(0x180)][_0x2ddf5a(0x1e1)]&&await this[_0x2ddf5a(0x1ab)][_0x2ddf5a(0x19d)](this[_0x2ddf5a(0x180)][_0x2ddf5a(0x1e1)]),this[_0x2ddf5a(0x180)][_0x2ddf5a(0x1be)]&&await this[_0x2ddf5a(0x1ab)][_0x2ddf5a(0x19d)](this[_0x2ddf5a(0x180)][_0x2ddf5a(0x1be)]),await this[_0x2ddf5a(0x1bd)]['setStatus'](this[_0x2ddf5a(0x1e5)],'Completed');}async[a181_0x122719(0x1ce)](_0x1efdb3){const _0x4ffcac=a181_0x122719;try{this['sfLogger'][_0x4ffcac(0x190)]('[ERROR]\x20'+_0x1efdb3),await this['sfLogger'][_0x4ffcac(0x1a1)](),await this[_0x4ffcac(0x1cf)](!![]),await this[_0x4ffcac(0x1bd)][_0x4ffcac(0x1cb)](this[_0x4ffcac(0x1e5)],_0x4ffcac(0x1c4));}catch(_0xf4271a){this['logger'][_0x4ffcac(0x1a4)](_0xf4271a);}}async['run'](_0x5085cb,_0x383327,_0x663336){const _0x21c08a=a181_0x122719;try{this[_0x21c08a(0x180)]=_0x5085cb,this[_0x21c08a(0x1cc)]=_0x663336,await this[_0x21c08a(0x1a0)](),this['repository']=await this[_0x21c08a(0x1e0)]['getOne'](this[_0x21c08a(0x1e5)][_0x21c08a(0x1b8)]),this['branch']=await this[_0x21c08a(0x1b4)][_0x21c08a(0x1c9)][_0x21c08a(0x1bf)](this[_0x21c08a(0x1e5)]['branchName']),this[_0x21c08a(0x1db)]=new salesforce_logger_v2_service_1[(_0x21c08a(0x1ba))](_0x383327[_0x21c08a(0x191)](),(_0x383327['getPrefix']()||_0x21c08a(0x19e)+_0x663336[_0x21c08a(0x1a3)]()+_0x21c08a(0x18b)+this[_0x21c08a(0x1e5)]['repositoryName']+']\x20[Branch:\x20'+this[_0x21c08a(0x1e5)]['branchName']+']')+'\x20['+FlosumCommitJob_1['name']+']');if(!this[_0x21c08a(0x1e5)])throw new bad_request_error_1[(_0x21c08a(0x1b1))](errors_1[_0x21c08a(0x181)]);await this['sfLogger'][_0x21c08a(0x190)](_0x21c08a(0x1e3))['send'](),await this[_0x21c08a(0x1bb)]()[_0x21c08a(0x1c3)](_0x45ef94=>this['handleCommitJobError'](_0x45ef94));}catch(_0x30dbed){this[_0x21c08a(0x180)]=undefined,this['logger']['error'](_0x30dbed);throw _0x30dbed;}}};function a181_0x3a1f(){const _0x3161bf=['SalesforceService','constructor','toString','Service','110576YHvPjb',']\x20[Repository:\x20','all','./commit-components.job','68345DelYkH','../dto/commit-components.dto','log','getLoggerId','../../salesforce/services/salesforce-retriever.service','length','run','gitManager','getRepoService','13eyBsoK','GitProviderManager','CommitComponentsDto','__esModule','114UqkUlE','../../salesforce/services/salesforce.service','deleteAttachment','[FLOSUM\x20->\x20GIT]\x20[','decorate','fetchRepositoryData','send','../../salesforce/services/salesforce-logger-v2.service','toUpperCase','error','message','typedi','776vUQzkN','__decorate','269897DkaRfT','repo','salesforceService','branch','3004992tWJbBC','name','26894dnhzVT','30rzpMha','BadRequestError','../../shared/git-provider.manager','getComponentsToDelete','repository','getBranchRecord','syncRepositoryId','862807FupkJD','repositoryName','logger','SalesforceLogger2','exec','trim','salesforceSync','deleteAttachmentId','getOne','SalesforceSyncService','../../salesforce/services/salesforce-sync.service','apply','catch','Error','SalesforceRetrieverService','design:paramtypes','2PnunyS','../../../core','branches','In\x20Progress','setStatus','provider','syncBranchId','handleCommitJobError','updateLastCommit','CommitComponentsJob','getComponentsToWrite','search','../../../constants/errors','51BEQCAe','FlosumCommitJob','Logger','45204yxolks','split','then','[INFO]\x20Update\x20remote\x20state.','sfLogger','retrieveAttachment','user','metadata','function','repoService','commitAttachmentId','sha','[INFO]\x20Start\x20commit\x20job','map','repositoryData','commitJob','updateRemoteState','commitData','ERR_UNKNOWN_SYNC_RECORD_ID','(((.+)+)+)+$','__metadata','defineProperty','gitUrl'];a181_0x3a1f=function(){return _0x3161bf;};return a181_0x3a1f();}FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a181_0x122719(0x189)]({'transient':!![]}),__metadata(a181_0x122719(0x1c6),[salesforce_service_1[a181_0x122719(0x186)],commit_components_job_1[a181_0x122719(0x1d0)],salesforce_sync_service_1[a181_0x122719(0x1c0)],git_provider_manager_1[a181_0x122719(0x198)]])],FlosumCommitJob),exports[a181_0x122719(0x1d5)]=FlosumCommitJob;