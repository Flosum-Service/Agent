const a182_0x40417d=a182_0x2104;(function(_0x15d130,_0x167dba){const _0x873795=a182_0x2104,_0x2d19c5=_0x15d130();while(!![]){try{const _0x551c81=-parseInt(_0x873795(0x19b))/0x1+parseInt(_0x873795(0x1b7))/0x2*(parseInt(_0x873795(0x19a))/0x3)+-parseInt(_0x873795(0x1a6))/0x4+-parseInt(_0x873795(0x17b))/0x5+-parseInt(_0x873795(0x190))/0x6+parseInt(_0x873795(0x174))/0x7*(parseInt(_0x873795(0x18e))/0x8)+parseInt(_0x873795(0x1ae))/0x9;if(_0x551c81===_0x167dba)break;else _0x2d19c5['push'](_0x2d19c5['shift']());}catch(_0xa8a17b){_0x2d19c5['push'](_0x2d19c5['shift']());}}}(a182_0x2534,0x639bc));const a182_0x4779d4=(function(){let _0x56fa14=!![];return function(_0x42ee7d,_0x9e37b){const _0x4c2742=_0x56fa14?function(){if(_0x9e37b){const _0x58e66c=_0x9e37b['apply'](_0x42ee7d,arguments);return _0x9e37b=null,_0x58e66c;}}:function(){};return _0x56fa14=![],_0x4c2742;};}()),a182_0x2745ce=a182_0x4779d4(this,function(){const _0x2f0b95=a182_0x2104;return a182_0x2745ce[_0x2f0b95(0x182)]()[_0x2f0b95(0x170)]('(((.+)+)+)+$')['toString']()['constructor'](a182_0x2745ce)[_0x2f0b95(0x170)](_0x2f0b95(0x199));});a182_0x2745ce();'use strict';function a182_0x2534(){const _0x527de1=['SalesforceService','getRepositoryRecord','(((.+)+)+)+$','3183bXjyte','568424JotDRV','name','updateLastCommit','SalesforceLogger2','repositoryData','[ERROR]\x20','sfLogger','updateRemoteState','../../salesforce/services/salesforce-retriever.service','../../../core/errors/bad-request.error','getCommitDto','778144AfoUlt','[FLOSUM\x20->\x20GIT]\x20[','run','getOne','getComponentsToWrite','branch','deleteAttachmentId','setStatus','9504837LHvUHA','decorate','user','__esModule','../../salesforce/services/salesforce-logger-v2.service','getOwnPropertyDescriptor','Error','__decorate','branches','158vNQJPk','repository','../../salesforce/services/salesforce.service','CommitComponentsDto','../../../core','retrieveAttachment','../dto/commit-components.dto','function','Logger','deleteAttachment','SalesforceSyncService','repositoryName','../../../constants/errors','FlosumCommitJob','defineProperty','length','branchName','metadata','map','getComponentsToDelete','error','Completed','handleCommitJobError','convertToSFDX','search','commitAttachmentId','exec','ERR_UNKNOWN_SYNC_RECORD_ID','252CmOKqm','SalesforceRetrieverService','object','commitJob','__metadata',']\x20[Repository:\x20','getBranchRecord','2898190WAsaFX','Service',']\x20[Branch:\x20','syncBranchId','BadRequestError','catch','syncRepositoryId','toString','salesforceService','repoService','getRepoService','../../shared/git-provider.manager','design:paramtypes','salesforceSync','gitManager','../../salesforce/services/salesforce-sync.service','split','logger','./commit-components.job','137552tbmNZd','log','49812VLxfKU','commitData','provider','sha','message','then','gitUrl'];a182_0x2534=function(){return _0x527de1;};return a182_0x2534();}var __decorate=this&&this[a182_0x40417d(0x1b5)]||function(_0x5c9c8f,_0x1b0ded,_0x1f8bfa,_0xe911f1){const _0x71e27c=a182_0x40417d;var _0x57baf3=arguments[_0x71e27c(0x167)],_0x3855c3=_0x57baf3<0x3?_0x1b0ded:_0xe911f1===null?_0xe911f1=Object[_0x71e27c(0x1b3)](_0x1b0ded,_0x1f8bfa):_0xe911f1,_0x317e67;if(typeof Reflect===_0x71e27c(0x176)&&typeof Reflect[_0x71e27c(0x1af)]===_0x71e27c(0x1be))_0x3855c3=Reflect[_0x71e27c(0x1af)](_0x5c9c8f,_0x1b0ded,_0x1f8bfa,_0xe911f1);else{for(var _0x15d4fa=_0x5c9c8f[_0x71e27c(0x167)]-0x1;_0x15d4fa>=0x0;_0x15d4fa--)if(_0x317e67=_0x5c9c8f[_0x15d4fa])_0x3855c3=(_0x57baf3<0x3?_0x317e67(_0x3855c3):_0x57baf3>0x3?_0x317e67(_0x1b0ded,_0x1f8bfa,_0x3855c3):_0x317e67(_0x1b0ded,_0x1f8bfa))||_0x3855c3;}return _0x57baf3>0x3&&_0x3855c3&&Object[_0x71e27c(0x1c5)](_0x1b0ded,_0x1f8bfa,_0x3855c3),_0x3855c3;},__metadata=this&&this[a182_0x40417d(0x178)]||function(_0x42518c,_0x265086){const _0x232934=a182_0x40417d;if(typeof Reflect==='object'&&typeof Reflect[_0x232934(0x169)]===_0x232934(0x1be))return Reflect['metadata'](_0x42518c,_0x265086);},FlosumCommitJob_1;Object['defineProperty'](exports,a182_0x40417d(0x1b1),{'value':!![]}),exports[a182_0x40417d(0x1c4)]=void 0x0;const core_1=require(a182_0x40417d(0x1bb)),salesforce_logger_v2_service_1=require(a182_0x40417d(0x1b2)),salesforce_service_1=require(a182_0x40417d(0x1b9)),git_provider_manager_1=require(a182_0x40417d(0x186)),typedi_1=require('typedi'),errors_1=require(a182_0x40417d(0x1c3)),bad_request_error_1=require(a182_0x40417d(0x1a4)),salesforce_retriever_service_1=require(a182_0x40417d(0x1a3)),salesforce_sync_service_1=require(a182_0x40417d(0x18a)),commit_components_dto_1=require(a182_0x40417d(0x1bd)),commit_components_job_1=require(a182_0x40417d(0x18d));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x53551b,_0x1429cb,_0x131037,_0x338521){const _0x15edef=a182_0x40417d;this[_0x15edef(0x183)]=_0x53551b,this[_0x15edef(0x177)]=_0x1429cb,this[_0x15edef(0x188)]=_0x131037,this['gitManager']=_0x338521,this[_0x15edef(0x184)]=this[_0x15edef(0x189)][_0x15edef(0x185)](),this[_0x15edef(0x18c)]=new core_1[(_0x15edef(0x1bf))](FlosumCommitJob_1['name']);}async['fetchRepositoryData'](){const _0x5c64d2=a182_0x40417d;try{if(this[_0x5c64d2(0x191)][_0x5c64d2(0x181)])this[_0x5c64d2(0x19f)]=await this[_0x5c64d2(0x188)][_0x5c64d2(0x198)](this['commitData'][_0x5c64d2(0x181)]);else this['commitData'][_0x5c64d2(0x17e)]&&(this[_0x5c64d2(0x19f)]=await this[_0x5c64d2(0x188)][_0x5c64d2(0x17a)](this[_0x5c64d2(0x191)]['syncBranchId']));}catch(_0x50bdf2){throw new bad_request_error_1[(_0x5c64d2(0x17f))](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async[a182_0x40417d(0x1aa)](){const _0xa362b3=a182_0x40417d;if(!this['commitData']['commitAttachmentId'])return[];const _0x2a39fd=await this[_0xa362b3(0x183)][_0xa362b3(0x1bc)](this['commitData'][_0xa362b3(0x171)])[_0xa362b3(0x195)](_0x120aa1=>_0x120aa1[_0xa362b3(0x18b)]('\x20')[_0xa362b3(0x16a)](_0x53ef78=>_0x53ef78['trim']())),_0x2da56b=new salesforce_retriever_service_1[(_0xa362b3(0x175))](this[_0xa362b3(0x183)]),_0x8375e9=await _0x2da56b[_0xa362b3(0x1a8)](_0x2a39fd);return _0x8375e9;}async[a182_0x40417d(0x16b)](){const _0x15a5be=a182_0x40417d;if(!this[_0x15a5be(0x191)][_0x15a5be(0x1ac)])return[];const _0x34a708=await this[_0x15a5be(0x183)][_0x15a5be(0x1bc)](this[_0x15a5be(0x191)]['deleteAttachmentId']);return _0x34a708;}async[a182_0x40417d(0x1a5)](){const _0xe06354=a182_0x40417d,_0x10c40c=new commit_components_dto_1[(_0xe06354(0x1ba))](),[_0x37484f,_0x1569b4]=await Promise['all']([this['getComponentsToWrite'](),this[_0xe06354(0x16b)]()]);return _0x10c40c[_0xe06354(0x194)]=this['commitData'][_0xe06354(0x194)],_0x10c40c[_0xe06354(0x1b0)]=this[_0xe06354(0x191)][_0xe06354(0x1b0)],_0x10c40c['components']={'writed':_0x37484f,'deleted':_0x1569b4},_0x10c40c[_0xe06354(0x16f)]=this['commitData'][_0xe06354(0x16f)],_0x10c40c['repo']=this[_0xe06354(0x1b8)],_0x10c40c[_0xe06354(0x1ab)]=this[_0xe06354(0x1ab)],_0x10c40c[_0xe06354(0x192)]=this[_0xe06354(0x192)],_0x10c40c;}async['updateLastCommit'](_0x1f8804=![]){const _0x4b6ca1=a182_0x40417d;if(_0x1f8804)await this[_0x4b6ca1(0x188)][_0x4b6ca1(0x1a2)](this['repositoryData'],{});else{const _0x1ad3b5=await this[_0x4b6ca1(0x1b8)][_0x4b6ca1(0x1b6)][_0x4b6ca1(0x1a9)](this[_0x4b6ca1(0x1ab)]['name']);this[_0x4b6ca1(0x1a1)][_0x4b6ca1(0x18f)]('[INFO]\x20Update\x20remote\x20state.');const _0x42c7db={[this['repository'][_0x4b6ca1(0x196)]]:{'lastCommit':_0x1ad3b5[_0x4b6ca1(0x193)]}};await this[_0x4b6ca1(0x188)][_0x4b6ca1(0x1a2)](this['repositoryData'],_0x42c7db);}}async['exec'](){const _0x1d3f54=a182_0x40417d,_0x3c5f72=await this['getCommitDto']();await this['salesforceSync'][_0x1d3f54(0x1ad)](this[_0x1d3f54(0x19f)],'In\x20Progress'),await this[_0x1d3f54(0x177)]['run'](_0x3c5f72,this[_0x1d3f54(0x1a1)]),await this[_0x1d3f54(0x19d)](),this[_0x1d3f54(0x191)][_0x1d3f54(0x171)]&&await this[_0x1d3f54(0x183)][_0x1d3f54(0x1c0)](this[_0x1d3f54(0x191)]['commitAttachmentId']),this['commitData'][_0x1d3f54(0x1ac)]&&await this[_0x1d3f54(0x183)][_0x1d3f54(0x1c0)](this[_0x1d3f54(0x191)][_0x1d3f54(0x1ac)]),await this[_0x1d3f54(0x188)][_0x1d3f54(0x1ad)](this['repositoryData'],_0x1d3f54(0x16d));}async[a182_0x40417d(0x16e)](_0x308af0){const _0x4e03af=a182_0x40417d;try{this[_0x4e03af(0x1a1)][_0x4e03af(0x18f)](_0x4e03af(0x1a0)+_0x308af0),await this[_0x4e03af(0x1a1)]['send'](),await this[_0x4e03af(0x19d)](!![]),await this[_0x4e03af(0x188)][_0x4e03af(0x1ad)](this[_0x4e03af(0x19f)],_0x4e03af(0x1b4));}catch(_0x4da9b1){this['logger']['error'](_0x4da9b1);}}async[a182_0x40417d(0x1a8)](_0x32738f,_0x13939b,_0x484f0c){const _0x11afc1=a182_0x40417d;try{this[_0x11afc1(0x191)]=_0x32738f,this['provider']=_0x484f0c,await this['fetchRepositoryData'](),this['repository']=await this[_0x11afc1(0x184)][_0x11afc1(0x1a9)](this[_0x11afc1(0x19f)][_0x11afc1(0x1c2)]),this[_0x11afc1(0x1ab)]=await this['repository']['branches'][_0x11afc1(0x1a9)](this[_0x11afc1(0x19f)][_0x11afc1(0x168)]),this['sfLogger']=new salesforce_logger_v2_service_1[(_0x11afc1(0x19e))](_0x13939b['getLoggerId'](),(_0x13939b['getPrefix']()||_0x11afc1(0x1a7)+_0x484f0c['toUpperCase']()+_0x11afc1(0x179)+this[_0x11afc1(0x19f)]['repositoryName']+_0x11afc1(0x17d)+this[_0x11afc1(0x19f)][_0x11afc1(0x168)]+']')+'\x20['+FlosumCommitJob_1[_0x11afc1(0x19c)]+']');if(!this[_0x11afc1(0x19f)])throw new bad_request_error_1[(_0x11afc1(0x17f))](errors_1[_0x11afc1(0x173)]);await this[_0x11afc1(0x1a1)][_0x11afc1(0x18f)]('[INFO]\x20Start\x20commit\x20job')['send'](),await this[_0x11afc1(0x172)]()[_0x11afc1(0x180)](_0x1a5ec1=>this[_0x11afc1(0x16e)](_0x1a5ec1));}catch(_0xb124a5){this[_0x11afc1(0x191)]=undefined,this['logger'][_0x11afc1(0x16c)](_0xb124a5);throw _0xb124a5;}}};function a182_0x2104(_0x3fbd99,_0x31032e){const _0x2b1bab=a182_0x2534();return a182_0x2104=function(_0x2745ce,_0x4779d4){_0x2745ce=_0x2745ce-0x167;let _0x253474=_0x2b1bab[_0x2745ce];return _0x253474;},a182_0x2104(_0x3fbd99,_0x31032e);}FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a182_0x40417d(0x17c)]({'transient':!![]}),__metadata(a182_0x40417d(0x187),[salesforce_service_1[a182_0x40417d(0x197)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a182_0x40417d(0x1c1)],git_provider_manager_1['GitProviderManager']])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;