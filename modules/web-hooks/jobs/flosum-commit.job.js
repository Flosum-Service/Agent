const a182_0x4ed095=a182_0x609b;(function(_0x2f664a,_0x35dfe2){const _0x2fcac1=a182_0x609b,_0x5a399d=_0x2f664a();while(!![]){try{const _0x2c23a0=parseInt(_0x2fcac1(0x1eb))/0x1+-parseInt(_0x2fcac1(0x21c))/0x2*(parseInt(_0x2fcac1(0x1d9))/0x3)+-parseInt(_0x2fcac1(0x200))/0x4+-parseInt(_0x2fcac1(0x1ee))/0x5*(parseInt(_0x2fcac1(0x210))/0x6)+-parseInt(_0x2fcac1(0x216))/0x7+-parseInt(_0x2fcac1(0x207))/0x8*(-parseInt(_0x2fcac1(0x21e))/0x9)+parseInt(_0x2fcac1(0x1f4))/0xa;if(_0x2c23a0===_0x35dfe2)break;else _0x5a399d['push'](_0x5a399d['shift']());}catch(_0x48cb80){_0x5a399d['push'](_0x5a399d['shift']());}}}(a182_0x128d,0x4d823));const a182_0x11af9f=(function(){let _0x22ed77=!![];return function(_0x3c8335,_0x4e8271){const _0x5e0540=_0x22ed77?function(){const _0x18f1ac=a182_0x609b;if(_0x4e8271){const _0x109256=_0x4e8271[_0x18f1ac(0x1d7)](_0x3c8335,arguments);return _0x4e8271=null,_0x109256;}}:function(){};return _0x22ed77=![],_0x5e0540;};}()),a182_0x4efa9d=a182_0x11af9f(this,function(){const _0x52d3db=a182_0x609b;return a182_0x4efa9d['toString']()[_0x52d3db(0x22f)](_0x52d3db(0x1f9))['toString']()[_0x52d3db(0x20e)](a182_0x4efa9d)['search']('(((.+)+)+)+$');});a182_0x4efa9d();'use strict';var __decorate=this&&this[a182_0x4ed095(0x1dd)]||function(_0x1c2ab2,_0x293619,_0x534c66,_0x2166e1){const _0x175661=a182_0x4ed095;var _0x1d1eae=arguments['length'],_0xfb48e=_0x1d1eae<0x3?_0x293619:_0x2166e1===null?_0x2166e1=Object[_0x175661(0x1f8)](_0x293619,_0x534c66):_0x2166e1,_0xe8790b;if(typeof Reflect===_0x175661(0x206)&&typeof Reflect[_0x175661(0x202)]===_0x175661(0x230))_0xfb48e=Reflect[_0x175661(0x202)](_0x1c2ab2,_0x293619,_0x534c66,_0x2166e1);else{for(var _0xe68365=_0x1c2ab2[_0x175661(0x1cc)]-0x1;_0xe68365>=0x0;_0xe68365--)if(_0xe8790b=_0x1c2ab2[_0xe68365])_0xfb48e=(_0x1d1eae<0x3?_0xe8790b(_0xfb48e):_0x1d1eae>0x3?_0xe8790b(_0x293619,_0x534c66,_0xfb48e):_0xe8790b(_0x293619,_0x534c66))||_0xfb48e;}return _0x1d1eae>0x3&&_0xfb48e&&Object[_0x175661(0x21d)](_0x293619,_0x534c66,_0xfb48e),_0xfb48e;},__metadata=this&&this[a182_0x4ed095(0x1e4)]||function(_0x39e1e1,_0x2f62b7){const _0x24bb9a=a182_0x4ed095;if(typeof Reflect===_0x24bb9a(0x206)&&typeof Reflect[_0x24bb9a(0x1cd)]===_0x24bb9a(0x230))return Reflect[_0x24bb9a(0x1cd)](_0x39e1e1,_0x2f62b7);},__importDefault=this&&this[a182_0x4ed095(0x1d3)]||function(_0x4bc9ba){const _0x8c059c=a182_0x4ed095;return _0x4bc9ba&&_0x4bc9ba[_0x8c059c(0x22c)]?_0x4bc9ba:{'default':_0x4bc9ba};},FlosumCommitJob_1;Object[a182_0x4ed095(0x21d)](exports,a182_0x4ed095(0x22c),{'value':!![]}),exports[a182_0x4ed095(0x20c)]=void 0x0;function a182_0x609b(_0x5736a7,_0x1f6d4f){const _0x193a28=a182_0x128d();return a182_0x609b=function(_0x4efa9d,_0x11af9f){_0x4efa9d=_0x4efa9d-0x1cc;let _0x128db3=_0x193a28[_0x4efa9d];return _0x128db3;},a182_0x609b(_0x5736a7,_0x1f6d4f);}function a182_0x128d(){const _0x3b4386=['608262BQLnnT','defineProperty','191385CyYQdw','fetchRepositoryData','setStatus','branchName','Service','repositoryData','salesforceSync','convertToSFDX','../../../core','commitAttachmentId','deleteAttachmentId','exec','ERR_UNKNOWN_SYNC_RECORD_ID','getRepoService','__esModule','then','message','search','function','Logger','getCommitDto','updateLastCommit','length','metadata','typedi','getOne','shortid','getLoggerId','patchObject','__importDefault','gitManager',']\x20[Branch:\x20','BadRequestError','apply','design:paramtypes','6HFRrRo','repoService','run','getRepositoryRecord','__decorate','SalesforceLogger2','repository','error','../../shared/git-provider.manager','getBranchRecord','../../salesforce/services/salesforce-sync.service','__metadata','log','ERR_INVALID_SYNC_RECORD_ID','catch','commitJob','../../../constants','toUpperCase','143421uITeUU','getPrefix','[ERROR]\x20','1835TMEswR','CommitComponentsJob','syncBranchId','user','commitData','name','8364750TytbdG','deleteAttachment','getComponentsToDelete','[INFO]\x20Update\x20remote\x20state.','getOwnPropertyDescriptor','(((.+)+)+)+$','salesforceService','updateRemoteState','syncRepositoryId','./commit-components.job','getComponentsToWrite','map','1106500ThkDiv','SalesforceRetrieverService','decorate','branch','../../salesforce/services/salesforce-retriever.service','split','object','184HNVIKY','logger',']\x20[Repository:\x20','provider','gitUrl','FlosumCommitJob','branches','constructor','sha','1626laeUnq','sfLogger','CommitComponentsDto','[FLOSUM\x20->\x20GIT]\x20[','repositoryName','FLOSUM_ATTACHMENT','1170204EjgBnz','In\x20Progress','handleCommitJobError','components','[INFO]\x20Start\x20commit\x20job','../dto/commit-components.dto'];a182_0x128d=function(){return _0x3b4386;};return a182_0x128d();}const core_1=require(a182_0x4ed095(0x226)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a182_0x4ed095(0x1e1)),typedi_1=require(a182_0x4ed095(0x1ce)),errors_1=require('../../../constants/errors'),bad_request_error_1=require('../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a182_0x4ed095(0x204)),salesforce_sync_service_1=require(a182_0x4ed095(0x1e3)),commit_components_dto_1=require(a182_0x4ed095(0x21b)),commit_components_job_1=require(a182_0x4ed095(0x1fd)),constants_1=require(a182_0x4ed095(0x1e9)),shortid_1=__importDefault(require(a182_0x4ed095(0x1d0)));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x27dff3,_0x3efaf8,_0xa71e5b,_0x54c87e){const _0x5b71f1=a182_0x4ed095;this[_0x5b71f1(0x1fa)]=_0x27dff3,this[_0x5b71f1(0x1e8)]=_0x3efaf8,this[_0x5b71f1(0x224)]=_0xa71e5b,this[_0x5b71f1(0x1d4)]=_0x54c87e,this[_0x5b71f1(0x1da)]=this[_0x5b71f1(0x1d4)][_0x5b71f1(0x22b)](),this[_0x5b71f1(0x208)]=new core_1[(_0x5b71f1(0x231))](FlosumCommitJob_1[_0x5b71f1(0x1f3)]);}async[a182_0x4ed095(0x21f)](){const _0x2ba988=a182_0x4ed095;try{if(this['commitData'][_0x2ba988(0x1fc)])this['repositoryData']=await this[_0x2ba988(0x224)][_0x2ba988(0x1dc)](this[_0x2ba988(0x1f2)][_0x2ba988(0x1fc)]);else this[_0x2ba988(0x1f2)][_0x2ba988(0x1f0)]&&(this[_0x2ba988(0x223)]=await this['salesforceSync'][_0x2ba988(0x1e2)](this[_0x2ba988(0x1f2)][_0x2ba988(0x1f0)]));}catch(_0x373f09){throw new bad_request_error_1['BadRequestError'](errors_1[_0x2ba988(0x1e6)]);}}async[a182_0x4ed095(0x1fe)](){const _0x2e3f90=a182_0x4ed095;if(!this['commitData']['commitAttachmentId'])return[];await this['salesforceService'][_0x2e3f90(0x1d2)](constants_1['FLOSUM_ATTACHMENT'],this['commitData'][_0x2e3f90(0x227)],{'Name':shortid_1['default']()});const _0x5726ed=await this[_0x2e3f90(0x1fa)]['retrieveAttachment'](this[_0x2e3f90(0x1f2)]['commitAttachmentId'])[_0x2e3f90(0x22d)](_0x14263e=>_0x14263e[_0x2e3f90(0x205)]('\x20')[_0x2e3f90(0x1ff)](_0x2081fe=>_0x2081fe['trim']()));await this[_0x2e3f90(0x1fa)][_0x2e3f90(0x1f5)](this[_0x2e3f90(0x1f2)]['commitAttachmentId']);const _0x22aada=new salesforce_retriever_service_1[(_0x2e3f90(0x201))](this[_0x2e3f90(0x1fa)]);return await _0x22aada[_0x2e3f90(0x1db)](_0x5726ed);}async['getComponentsToDelete'](){const _0x369b70=a182_0x4ed095;if(!this['commitData']['deleteAttachmentId'])return[];await this[_0x369b70(0x1fa)][_0x369b70(0x1d2)](constants_1[_0x369b70(0x215)],this[_0x369b70(0x1f2)][_0x369b70(0x228)],{'Name':shortid_1['default']()});const _0x51d23a=await this[_0x369b70(0x1fa)]['retrieveAttachment'](this[_0x369b70(0x1f2)]['deleteAttachmentId']);return await this[_0x369b70(0x1fa)][_0x369b70(0x1f5)](this[_0x369b70(0x1f2)][_0x369b70(0x228)]),_0x51d23a;}async[a182_0x4ed095(0x232)](){const _0x5ecb6a=a182_0x4ed095,_0x269f86=new commit_components_dto_1[(_0x5ecb6a(0x212))](),[_0x3e3379,_0x1a08b5]=await Promise['all']([this[_0x5ecb6a(0x1fe)](),this[_0x5ecb6a(0x1f6)]()]);return _0x269f86[_0x5ecb6a(0x22e)]=this[_0x5ecb6a(0x1f2)]['message'],_0x269f86[_0x5ecb6a(0x1f1)]=this[_0x5ecb6a(0x1f2)][_0x5ecb6a(0x1f1)],_0x269f86[_0x5ecb6a(0x219)]={'writed':_0x3e3379,'deleted':_0x1a08b5},_0x269f86[_0x5ecb6a(0x225)]=this['commitData']['convertToSFDX'],_0x269f86['repo']=this['repository'],_0x269f86[_0x5ecb6a(0x203)]=this[_0x5ecb6a(0x203)],_0x269f86[_0x5ecb6a(0x20a)]=this[_0x5ecb6a(0x20a)],_0x269f86;}async[a182_0x4ed095(0x233)](_0x232440=![]){const _0x4d623a=a182_0x4ed095;if(_0x232440)await this[_0x4d623a(0x224)][_0x4d623a(0x1fb)](this[_0x4d623a(0x223)],{});else{const _0x1a3b56=await this[_0x4d623a(0x1df)]['branches'][_0x4d623a(0x1cf)](this[_0x4d623a(0x203)][_0x4d623a(0x1f3)]);this[_0x4d623a(0x211)][_0x4d623a(0x1e5)](_0x4d623a(0x1f7));const _0x3b82ad={[this[_0x4d623a(0x1df)][_0x4d623a(0x20b)]]:{'lastCommit':_0x1a3b56[_0x4d623a(0x20f)]}};await this[_0x4d623a(0x224)][_0x4d623a(0x1fb)](this[_0x4d623a(0x223)],_0x3b82ad);}}async[a182_0x4ed095(0x229)](){const _0x366e84=a182_0x4ed095,_0x446514=await this['getCommitDto']();await this['salesforceSync'][_0x366e84(0x220)](this[_0x366e84(0x223)],_0x366e84(0x217)),await this[_0x366e84(0x1e8)]['run'](_0x446514,this[_0x366e84(0x211)]),await this['updateLastCommit'](),await this[_0x366e84(0x224)][_0x366e84(0x220)](this[_0x366e84(0x223)],'Completed');}async[a182_0x4ed095(0x218)](_0x2f67ee){const _0x4f0368=a182_0x4ed095;try{this[_0x4f0368(0x211)][_0x4f0368(0x1e5)](_0x4f0368(0x1ed)+_0x2f67ee),await this[_0x4f0368(0x211)]['send'](),await this['updateLastCommit'](!![]),await this[_0x4f0368(0x224)][_0x4f0368(0x220)](this[_0x4f0368(0x223)],'Error');}catch(_0x4c580c){this['logger'][_0x4f0368(0x1e0)](_0x4c580c);}}async[a182_0x4ed095(0x1db)](_0x12badf,_0x51241b,_0x278a2a){const _0x515c5c=a182_0x4ed095;try{this[_0x515c5c(0x1f2)]=_0x12badf,this[_0x515c5c(0x20a)]=_0x278a2a,await this[_0x515c5c(0x21f)](),this['repository']=await this[_0x515c5c(0x1da)]['getOne'](this['repositoryData'][_0x515c5c(0x214)]),this[_0x515c5c(0x203)]=await this[_0x515c5c(0x1df)][_0x515c5c(0x20d)]['getOne'](this[_0x515c5c(0x223)][_0x515c5c(0x221)]),this[_0x515c5c(0x211)]=new salesforce_logger_v2_service_1[(_0x515c5c(0x1de))](_0x51241b[_0x515c5c(0x1d1)](),(_0x51241b[_0x515c5c(0x1ec)]()||_0x515c5c(0x213)+_0x278a2a[_0x515c5c(0x1ea)]()+_0x515c5c(0x209)+this[_0x515c5c(0x223)][_0x515c5c(0x214)]+_0x515c5c(0x1d5)+this[_0x515c5c(0x223)][_0x515c5c(0x221)]+']')+'\x20['+FlosumCommitJob_1[_0x515c5c(0x1f3)]+']');if(!this[_0x515c5c(0x223)])throw new bad_request_error_1[(_0x515c5c(0x1d6))](errors_1[_0x515c5c(0x22a)]);await this[_0x515c5c(0x211)][_0x515c5c(0x1e5)](_0x515c5c(0x21a))['send'](),await this[_0x515c5c(0x229)]()[_0x515c5c(0x1e7)](_0x17f8b0=>this[_0x515c5c(0x218)](_0x17f8b0));}catch(_0x5ebfcc){this[_0x515c5c(0x1f2)]=undefined,this[_0x515c5c(0x208)][_0x515c5c(0x1e0)](_0x5ebfcc);throw _0x5ebfcc;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a182_0x4ed095(0x222)]({'transient':!![]}),__metadata(a182_0x4ed095(0x1d8),[salesforce_service_1['SalesforceService'],commit_components_job_1[a182_0x4ed095(0x1ef)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1['GitProviderManager']])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;