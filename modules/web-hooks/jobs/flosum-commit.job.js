const a182_0x4677fa=a182_0x2382;function a182_0x19d0(){const _0x26e7f2=['repo','logger','deleteAttachment','error','components','ERR_UNKNOWN_SYNC_RECORD_ID','__metadata','CommitComponentsDto','run','salesforceService','repositoryName','defineProperty','retrieveAttachment','57502yJRAeD','deleteAttachmentId','constructor','repositoryData','metadata','decorate','1055280PEpwPy','syncRepositoryId','exec','fetchRepositoryData','[INFO]\x20Update\x20remote\x20state.','getCommitDto','typedi','repository','getComponentsToDelete','../../../core/errors/bad-request.error','5aeVfrd','11paxOSm','../../salesforce/services/salesforce-logger-v2.service','getRepoService','setStatus','branch','(((.+)+)+)+$','design:paramtypes','6ZYkfNS','5674016QXRpIz','680435ntKNNh','search','[FLOSUM\x20->\x20GIT]\x20[','toString','commitData','toUpperCase','apply','9nnKfYa','updateRemoteState','BadRequestError','all','syncBranchId','SalesforceService','FlosumCommitJob','convertToSFDX','17972412GCAuZB','getOne','Error','6ZwYpbg','sfLogger','Completed','length','../../salesforce/services/salesforce-retriever.service','commitAttachmentId','../../../constants/errors','salesforceSync','send','getRepositoryRecord','repoService','handleCommitJobError','provider','[INFO]\x20Start\x20commit\x20job','531796ZiYMAX','gitUrl','branchName','object','1811690PRyTWh','sha',']\x20[Repository:\x20','updateLastCommit','SalesforceRetrieverService','Service','../../salesforce/services/salesforce.service','CommitComponentsJob','gitManager','name','branches','__esModule','catch','getComponentsToWrite','then','../../salesforce/services/salesforce-sync.service','./commit-components.job','log','function','getBranchRecord','user','trim'];a182_0x19d0=function(){return _0x26e7f2;};return a182_0x19d0();}(function(_0x126dc8,_0x49e86e){const _0xe2868=a182_0x2382,_0x40c531=_0x126dc8();while(!![]){try{const _0x149ac0=-parseInt(_0xe2868(0x163))/0x1*(parseInt(_0xe2868(0x12e))/0x2)+-parseInt(_0xe2868(0x169))/0x3+-parseInt(_0xe2868(0x13c))/0x4*(-parseInt(_0xe2868(0x173))/0x5)+parseInt(_0xe2868(0x11a))/0x6*(-parseInt(_0xe2868(0x11c))/0x7)+-parseInt(_0xe2868(0x11b))/0x8+-parseInt(_0xe2868(0x123))/0x9*(-parseInt(_0xe2868(0x140))/0xa)+parseInt(_0xe2868(0x174))/0xb*(parseInt(_0xe2868(0x12b))/0xc);if(_0x149ac0===_0x49e86e)break;else _0x40c531['push'](_0x40c531['shift']());}catch(_0x1f722f){_0x40c531['push'](_0x40c531['shift']());}}}(a182_0x19d0,0x75748));const a182_0x2077b4=(function(){let _0xb1b0c8=!![];return function(_0x286cfc,_0x2c5ef5){const _0x20c6c7=_0xb1b0c8?function(){const _0xcff1b=a182_0x2382;if(_0x2c5ef5){const _0x2d4030=_0x2c5ef5[_0xcff1b(0x122)](_0x286cfc,arguments);return _0x2c5ef5=null,_0x2d4030;}}:function(){};return _0xb1b0c8=![],_0x20c6c7;};}()),a182_0x2eefc3=a182_0x2077b4(this,function(){const _0x108148=a182_0x2382;return a182_0x2eefc3[_0x108148(0x11f)]()[_0x108148(0x11d)](_0x108148(0x118))[_0x108148(0x11f)]()[_0x108148(0x165)](a182_0x2eefc3)['search'](_0x108148(0x118));});a182_0x2eefc3();'use strict';var __decorate=this&&this['__decorate']||function(_0x13c7a6,_0x403a52,_0x2b7e76,_0x592a43){const _0x1a9c20=a182_0x2382;var _0x40dd21=arguments[_0x1a9c20(0x131)],_0x3c9436=_0x40dd21<0x3?_0x403a52:_0x592a43===null?_0x592a43=Object['getOwnPropertyDescriptor'](_0x403a52,_0x2b7e76):_0x592a43,_0x4da5a5;if(typeof Reflect===_0x1a9c20(0x13f)&&typeof Reflect[_0x1a9c20(0x168)]===_0x1a9c20(0x152))_0x3c9436=Reflect[_0x1a9c20(0x168)](_0x13c7a6,_0x403a52,_0x2b7e76,_0x592a43);else{for(var _0x4b82ec=_0x13c7a6[_0x1a9c20(0x131)]-0x1;_0x4b82ec>=0x0;_0x4b82ec--)if(_0x4da5a5=_0x13c7a6[_0x4b82ec])_0x3c9436=(_0x40dd21<0x3?_0x4da5a5(_0x3c9436):_0x40dd21>0x3?_0x4da5a5(_0x403a52,_0x2b7e76,_0x3c9436):_0x4da5a5(_0x403a52,_0x2b7e76))||_0x3c9436;}return _0x40dd21>0x3&&_0x3c9436&&Object['defineProperty'](_0x403a52,_0x2b7e76,_0x3c9436),_0x3c9436;},__metadata=this&&this[a182_0x4677fa(0x15c)]||function(_0x18c544,_0x196647){const _0x2f55d0=a182_0x4677fa;if(typeof Reflect===_0x2f55d0(0x13f)&&typeof Reflect[_0x2f55d0(0x167)]===_0x2f55d0(0x152))return Reflect[_0x2f55d0(0x167)](_0x18c544,_0x196647);},FlosumCommitJob_1;Object[a182_0x4677fa(0x161)](exports,a182_0x4677fa(0x14b),{'value':!![]}),exports[a182_0x4677fa(0x129)]=void 0x0;const core_1=require('../../../core'),salesforce_logger_v2_service_1=require(a182_0x4677fa(0x175)),salesforce_service_1=require(a182_0x4677fa(0x146)),git_provider_manager_1=require('../../shared/git-provider.manager'),typedi_1=require(a182_0x4677fa(0x16f)),errors_1=require(a182_0x4677fa(0x134)),bad_request_error_1=require(a182_0x4677fa(0x172)),salesforce_retriever_service_1=require(a182_0x4677fa(0x132)),salesforce_sync_service_1=require(a182_0x4677fa(0x14f)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a182_0x4677fa(0x150));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x4abd26,_0x200ac1,_0xe00161,_0x45894c){const _0x57c713=a182_0x4677fa;this[_0x57c713(0x15f)]=_0x4abd26,this['commitJob']=_0x200ac1,this['salesforceSync']=_0xe00161,this[_0x57c713(0x148)]=_0x45894c,this[_0x57c713(0x138)]=this[_0x57c713(0x148)][_0x57c713(0x176)](),this[_0x57c713(0x157)]=new core_1['Logger'](FlosumCommitJob_1[_0x57c713(0x149)]);}async[a182_0x4677fa(0x16c)](){const _0xa6d79f=a182_0x4677fa;try{if(this[_0xa6d79f(0x120)][_0xa6d79f(0x16a)])this[_0xa6d79f(0x166)]=await this[_0xa6d79f(0x135)][_0xa6d79f(0x137)](this[_0xa6d79f(0x120)][_0xa6d79f(0x16a)]);else this[_0xa6d79f(0x120)]['syncBranchId']&&(this[_0xa6d79f(0x166)]=await this[_0xa6d79f(0x135)][_0xa6d79f(0x153)](this[_0xa6d79f(0x120)][_0xa6d79f(0x127)]));}catch(_0x1a7e36){throw new bad_request_error_1[(_0xa6d79f(0x125))](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async[a182_0x4677fa(0x14d)](){const _0x1b0177=a182_0x4677fa;if(!this[_0x1b0177(0x120)][_0x1b0177(0x133)])return[];const _0x4f3d56=await this[_0x1b0177(0x15f)][_0x1b0177(0x162)](this[_0x1b0177(0x120)][_0x1b0177(0x133)])[_0x1b0177(0x14e)](_0x3cd2f2=>_0x3cd2f2['split']('\x20')['map'](_0x38578c=>_0x38578c[_0x1b0177(0x155)]())),_0x44152a=new salesforce_retriever_service_1[(_0x1b0177(0x144))](this[_0x1b0177(0x15f)]),_0x947fc8=await _0x44152a['run'](_0x4f3d56);return _0x947fc8;}async[a182_0x4677fa(0x171)](){const _0x42a30f=a182_0x4677fa;if(!this[_0x42a30f(0x120)][_0x42a30f(0x164)])return[];const _0x2951f4=await this[_0x42a30f(0x15f)][_0x42a30f(0x162)](this[_0x42a30f(0x120)][_0x42a30f(0x164)]);return _0x2951f4;}async[a182_0x4677fa(0x16e)](){const _0x3fdf65=a182_0x4677fa,_0x46b2db=new commit_components_dto_1[(_0x3fdf65(0x15d))](),[_0x2902b1,_0xeaaf1f]=await Promise[_0x3fdf65(0x126)]([this[_0x3fdf65(0x14d)](),this[_0x3fdf65(0x171)]()]);return _0x46b2db['message']=this['commitData']['message'],_0x46b2db[_0x3fdf65(0x154)]=this[_0x3fdf65(0x120)][_0x3fdf65(0x154)],_0x46b2db[_0x3fdf65(0x15a)]={'writed':_0x2902b1,'deleted':_0xeaaf1f},_0x46b2db[_0x3fdf65(0x12a)]=this['commitData'][_0x3fdf65(0x12a)],_0x46b2db[_0x3fdf65(0x156)]=this[_0x3fdf65(0x170)],_0x46b2db[_0x3fdf65(0x178)]=this[_0x3fdf65(0x178)],_0x46b2db['provider']=this[_0x3fdf65(0x13a)],_0x46b2db;}async[a182_0x4677fa(0x143)](_0x12dea6=![]){const _0x291d0b=a182_0x4677fa;if(_0x12dea6)await this[_0x291d0b(0x135)][_0x291d0b(0x124)](this['repositoryData'],{});else{const _0x6e444b=await this[_0x291d0b(0x170)][_0x291d0b(0x14a)][_0x291d0b(0x12c)](this[_0x291d0b(0x178)][_0x291d0b(0x149)]);this[_0x291d0b(0x12f)][_0x291d0b(0x151)](_0x291d0b(0x16d));const _0x28fe48={[this[_0x291d0b(0x170)][_0x291d0b(0x13d)]]:{'lastCommit':_0x6e444b[_0x291d0b(0x141)]}};await this[_0x291d0b(0x135)][_0x291d0b(0x124)](this[_0x291d0b(0x166)],_0x28fe48);}}async[a182_0x4677fa(0x16b)](){const _0x3813f6=a182_0x4677fa,_0x35ab11=await this[_0x3813f6(0x16e)]();await this[_0x3813f6(0x135)][_0x3813f6(0x177)](this[_0x3813f6(0x166)],'In\x20Progress'),await this['commitJob'][_0x3813f6(0x15e)](_0x35ab11,this['sfLogger']),await this[_0x3813f6(0x143)](),this[_0x3813f6(0x120)][_0x3813f6(0x133)]&&await this['salesforceService'][_0x3813f6(0x158)](this[_0x3813f6(0x120)]['commitAttachmentId']),this[_0x3813f6(0x120)]['deleteAttachmentId']&&await this['salesforceService'][_0x3813f6(0x158)](this[_0x3813f6(0x120)]['deleteAttachmentId']),await this[_0x3813f6(0x135)]['setStatus'](this['repositoryData'],_0x3813f6(0x130));}async[a182_0x4677fa(0x139)](_0x108a50){const _0x414112=a182_0x4677fa;try{this['sfLogger'][_0x414112(0x151)]('[ERROR]\x20'+_0x108a50),await this[_0x414112(0x12f)][_0x414112(0x136)](),await this[_0x414112(0x143)](!![]),await this[_0x414112(0x135)]['setStatus'](this[_0x414112(0x166)],_0x414112(0x12d));}catch(_0x168fc3){this[_0x414112(0x157)][_0x414112(0x159)](_0x168fc3);}}async[a182_0x4677fa(0x15e)](_0x6705f3,_0x4a3ed8,_0x5728ff){const _0x19afb3=a182_0x4677fa;try{this[_0x19afb3(0x120)]=_0x6705f3,this[_0x19afb3(0x13a)]=_0x5728ff,await this[_0x19afb3(0x16c)](),this['repository']=await this[_0x19afb3(0x138)][_0x19afb3(0x12c)](this[_0x19afb3(0x166)]['repositoryName']),this[_0x19afb3(0x178)]=await this[_0x19afb3(0x170)]['branches'][_0x19afb3(0x12c)](this[_0x19afb3(0x166)]['branchName']),this['sfLogger']=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x4a3ed8['getLoggerId'](),(_0x4a3ed8['getPrefix']()||_0x19afb3(0x11e)+_0x5728ff[_0x19afb3(0x121)]()+_0x19afb3(0x142)+this['repositoryData'][_0x19afb3(0x160)]+']\x20[Branch:\x20'+this[_0x19afb3(0x166)][_0x19afb3(0x13e)]+']')+'\x20['+FlosumCommitJob_1[_0x19afb3(0x149)]+']');if(!this[_0x19afb3(0x166)])throw new bad_request_error_1[(_0x19afb3(0x125))](errors_1[_0x19afb3(0x15b)]);await this[_0x19afb3(0x12f)][_0x19afb3(0x151)](_0x19afb3(0x13b))[_0x19afb3(0x136)](),await this[_0x19afb3(0x16b)]()[_0x19afb3(0x14c)](_0x13bf4e=>this[_0x19afb3(0x139)](_0x13bf4e));}catch(_0x5a8fde){this['commitData']=undefined,this[_0x19afb3(0x157)][_0x19afb3(0x159)](_0x5a8fde);throw _0x5a8fde;}}};function a182_0x2382(_0x1d3ef7,_0x541bc6){const _0xec840c=a182_0x19d0();return a182_0x2382=function(_0x2eefc3,_0x2077b4){_0x2eefc3=_0x2eefc3-0x118;let _0x19d001=_0xec840c[_0x2eefc3];return _0x19d001;},a182_0x2382(_0x1d3ef7,_0x541bc6);}FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a182_0x4677fa(0x145)]({'transient':!![]}),__metadata(a182_0x4677fa(0x119),[salesforce_service_1[a182_0x4677fa(0x128)],commit_components_job_1[a182_0x4677fa(0x147)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1['GitProviderManager']])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;