const a182_0x325258=a182_0xb6d4;function a182_0xb6d4(_0x22b7d3,_0x1acd90){const _0x2fdfb5=a182_0x39db();return a182_0xb6d4=function(_0x18883c,_0x33e28a){_0x18883c=_0x18883c-0x1d3;let _0x39db21=_0x2fdfb5[_0x18883c];return _0x39db21;},a182_0xb6d4(_0x22b7d3,_0x1acd90);}(function(_0x593978,_0x332a86){const _0x11f8f8=a182_0xb6d4,_0x55c615=_0x593978();while(!![]){try{const _0x5e5b99=parseInt(_0x11f8f8(0x202))/0x1*(parseInt(_0x11f8f8(0x1d6))/0x2)+-parseInt(_0x11f8f8(0x1dc))/0x3*(parseInt(_0x11f8f8(0x20c))/0x4)+-parseInt(_0x11f8f8(0x1fb))/0x5+-parseInt(_0x11f8f8(0x1ed))/0x6*(-parseInt(_0x11f8f8(0x223))/0x7)+parseInt(_0x11f8f8(0x1f7))/0x8*(parseInt(_0x11f8f8(0x233))/0x9)+parseInt(_0x11f8f8(0x1e3))/0xa+parseInt(_0x11f8f8(0x230))/0xb;if(_0x5e5b99===_0x332a86)break;else _0x55c615['push'](_0x55c615['shift']());}catch(_0x421fbc){_0x55c615['push'](_0x55c615['shift']());}}}(a182_0x39db,0xec38d));const a182_0x33e28a=(function(){let _0x1e832e=!![];return function(_0x106e38,_0x4dc877){const _0x4b0c08=_0x1e832e?function(){const _0x2d5bcc=a182_0xb6d4;if(_0x4dc877){const _0x1f5e77=_0x4dc877[_0x2d5bcc(0x235)](_0x106e38,arguments);return _0x4dc877=null,_0x1f5e77;}}:function(){};return _0x1e832e=![],_0x4b0c08;};}()),a182_0x18883c=a182_0x33e28a(this,function(){const _0xb95073=a182_0xb6d4;return a182_0x18883c[_0xb95073(0x22f)]()['search'](_0xb95073(0x201))[_0xb95073(0x22f)]()[_0xb95073(0x239)](a182_0x18883c)[_0xb95073(0x1f3)](_0xb95073(0x201));});a182_0x18883c();'use strict';var __decorate=this&&this[a182_0x325258(0x229)]||function(_0x287beb,_0x8a41cf,_0x2f3cba,_0x50f6c3){const _0x45e87d=a182_0x325258;var _0x2c67a0=arguments['length'],_0x1e5c2a=_0x2c67a0<0x3?_0x8a41cf:_0x50f6c3===null?_0x50f6c3=Object[_0x45e87d(0x1d4)](_0x8a41cf,_0x2f3cba):_0x50f6c3,_0x36397a;if(typeof Reflect===_0x45e87d(0x1fe)&&typeof Reflect[_0x45e87d(0x20b)]===_0x45e87d(0x200))_0x1e5c2a=Reflect['decorate'](_0x287beb,_0x8a41cf,_0x2f3cba,_0x50f6c3);else{for(var _0x1f402e=_0x287beb[_0x45e87d(0x1fa)]-0x1;_0x1f402e>=0x0;_0x1f402e--)if(_0x36397a=_0x287beb[_0x1f402e])_0x1e5c2a=(_0x2c67a0<0x3?_0x36397a(_0x1e5c2a):_0x2c67a0>0x3?_0x36397a(_0x8a41cf,_0x2f3cba,_0x1e5c2a):_0x36397a(_0x8a41cf,_0x2f3cba))||_0x1e5c2a;}return _0x2c67a0>0x3&&_0x1e5c2a&&Object[_0x45e87d(0x218)](_0x8a41cf,_0x2f3cba,_0x1e5c2a),_0x1e5c2a;},__metadata=this&&this['__metadata']||function(_0x1f0688,_0x2ac29a){const _0x1c818a=a182_0x325258;if(typeof Reflect===_0x1c818a(0x1fe)&&typeof Reflect[_0x1c818a(0x1e7)]===_0x1c818a(0x200))return Reflect['metadata'](_0x1f0688,_0x2ac29a);},__importDefault=this&&this[a182_0x325258(0x21a)]||function(_0x1bc6ba){const _0x1749d9=a182_0x325258;return _0x1bc6ba&&_0x1bc6ba[_0x1749d9(0x20a)]?_0x1bc6ba:{'default':_0x1bc6ba};},FlosumCommitJob_1;function a182_0x39db(){const _0x5a1511=['../../../core','fetchRepositoryData','getComponentsToWrite','deleteAttachmentId','send','provider','catch','branch','commitData','defineProperty','log','__importDefault','repositoryData','setStatus','updateLastCommit','SalesforceSyncService','../dto/commit-components.dto','syncBranchId','salesforceSync','retrieveAttachment','594881gIfWKr','getLoggerId','name','gitManager','repositoryName','../../salesforce/services/salesforce-sync.service','__decorate','sfLogger','patchObject','SalesforceRetrieverService','getPrefix','GitProviderManager','toString','2329184CULvtd',']\x20[Branch:\x20','CommitComponentsDto','243wIPOpz','branchName','apply','typedi','getCommitDto','user','constructor','convertToSFDX','shortid','./commit-components.job','sha','getOwnPropertyDescriptor','[ERROR]\x20','2DilOxC','all','logger','Error','handleCommitJobError','SalesforceService','6hnBKPg','commitJob','getOne','branches','exec','../../salesforce/services/salesforce.service','[INFO]\x20Start\x20commit\x20job','6499190udKOii','message','toUpperCase','Service','metadata','[INFO]\x20Update\x20remote\x20state.','updateRemoteState','salesforceService','trim','ERR_UNKNOWN_SYNC_RECORD_ID','84miuxXG','SalesforceLogger2','Completed','run','CommitComponentsJob','error','search','getComponentsToDelete','ERR_INVALID_SYNC_RECORD_ID','map','408672JmyRIi',']\x20[Repository:\x20','gitUrl','length','8106435GQVoYz','repoService','then','object','FLOSUM_ATTACHMENT','function','(((.+)+)+)+$','22067iJUVFU','FlosumCommitJob','commitAttachmentId','components','../../../constants/errors','../../../constants','default','repository','__esModule','decorate','1727816xhhpfm','repo','[FLOSUM\x20->\x20GIT]\x20['];a182_0x39db=function(){return _0x5a1511;};return a182_0x39db();}Object[a182_0x325258(0x218)](exports,a182_0x325258(0x20a),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;const core_1=require(a182_0x325258(0x20f)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_service_1=require(a182_0x325258(0x1e1)),git_provider_manager_1=require('../../shared/git-provider.manager'),typedi_1=require(a182_0x325258(0x236)),errors_1=require(a182_0x325258(0x206)),bad_request_error_1=require('../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a182_0x325258(0x228)),commit_components_dto_1=require(a182_0x325258(0x21f)),commit_components_job_1=require(a182_0x325258(0x23c)),constants_1=require(a182_0x325258(0x207)),shortid_1=__importDefault(require(a182_0x325258(0x23b)));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x55b901,_0x2813db,_0xc5297d,_0x55c0f9){const _0x569423=a182_0x325258;this[_0x569423(0x1ea)]=_0x55b901,this[_0x569423(0x1dd)]=_0x2813db,this[_0x569423(0x221)]=_0xc5297d,this['gitManager']=_0x55c0f9,this[_0x569423(0x1fc)]=this[_0x569423(0x226)]['getRepoService'](),this[_0x569423(0x1d8)]=new core_1['Logger'](FlosumCommitJob_1['name']);}async[a182_0x325258(0x210)](){const _0x53d71b=a182_0x325258;try{if(this[_0x53d71b(0x217)]['syncRepositoryId'])this[_0x53d71b(0x21b)]=await this[_0x53d71b(0x221)]['getRepositoryRecord'](this['commitData']['syncRepositoryId']);else this[_0x53d71b(0x217)][_0x53d71b(0x220)]&&(this[_0x53d71b(0x21b)]=await this[_0x53d71b(0x221)]['getBranchRecord'](this[_0x53d71b(0x217)][_0x53d71b(0x220)]));}catch(_0x3d1fe7){throw new bad_request_error_1['BadRequestError'](errors_1[_0x53d71b(0x1f5)]);}}async['getComponentsToWrite'](){const _0x360c3e=a182_0x325258;if(!this['commitData'][_0x360c3e(0x204)])return[];await this[_0x360c3e(0x1ea)][_0x360c3e(0x22b)](constants_1[_0x360c3e(0x1ff)],this[_0x360c3e(0x217)][_0x360c3e(0x204)],{'Name':shortid_1['default']()});const _0x2ec42f=await this[_0x360c3e(0x1ea)][_0x360c3e(0x222)](this['commitData'][_0x360c3e(0x204)])[_0x360c3e(0x1fd)](_0x48caf9=>_0x48caf9['split']('\x20')[_0x360c3e(0x1f6)](_0x20ecca=>_0x20ecca[_0x360c3e(0x1eb)]()));await this[_0x360c3e(0x1ea)]['deleteAttachment'](this[_0x360c3e(0x217)][_0x360c3e(0x204)]);const _0x1bd208=new salesforce_retriever_service_1[(_0x360c3e(0x22c))](this[_0x360c3e(0x1ea)]);return await _0x1bd208[_0x360c3e(0x1f0)](_0x2ec42f);}async['getComponentsToDelete'](){const _0x5a714a=a182_0x325258;if(!this[_0x5a714a(0x217)]['deleteAttachmentId'])return[];await this[_0x5a714a(0x1ea)]['patchObject'](constants_1['FLOSUM_ATTACHMENT'],this['commitData'][_0x5a714a(0x212)],{'Name':shortid_1[_0x5a714a(0x208)]()});const _0x244ea7=await this[_0x5a714a(0x1ea)][_0x5a714a(0x222)](this[_0x5a714a(0x217)]['deleteAttachmentId']);return await this[_0x5a714a(0x1ea)]['deleteAttachment'](this[_0x5a714a(0x217)][_0x5a714a(0x212)]),_0x244ea7;}async[a182_0x325258(0x237)](){const _0x46fd2a=a182_0x325258,_0x54a7f1=new commit_components_dto_1[(_0x46fd2a(0x232))](),[_0xd1601f,_0x5e88a3]=await Promise[_0x46fd2a(0x1d7)]([this[_0x46fd2a(0x211)](),this[_0x46fd2a(0x1f4)]()]);return _0x54a7f1[_0x46fd2a(0x1e4)]=this['commitData'][_0x46fd2a(0x1e4)],_0x54a7f1[_0x46fd2a(0x238)]=this['commitData'][_0x46fd2a(0x238)],_0x54a7f1[_0x46fd2a(0x205)]={'writed':_0xd1601f,'deleted':_0x5e88a3},_0x54a7f1[_0x46fd2a(0x23a)]=this[_0x46fd2a(0x217)][_0x46fd2a(0x23a)],_0x54a7f1[_0x46fd2a(0x20d)]=this['repository'],_0x54a7f1[_0x46fd2a(0x216)]=this[_0x46fd2a(0x216)],_0x54a7f1[_0x46fd2a(0x214)]=this[_0x46fd2a(0x214)],_0x54a7f1;}async[a182_0x325258(0x21d)](_0x15d29b=![]){const _0x5e7609=a182_0x325258;if(_0x15d29b)await this[_0x5e7609(0x221)][_0x5e7609(0x1e9)](this['repositoryData'],{});else{const _0x3a3114=await this[_0x5e7609(0x209)][_0x5e7609(0x1df)][_0x5e7609(0x1de)](this[_0x5e7609(0x216)][_0x5e7609(0x225)]);this[_0x5e7609(0x22a)]['log'](_0x5e7609(0x1e8));const _0x28c5c0={[this[_0x5e7609(0x209)][_0x5e7609(0x1f9)]]:{'lastCommit':_0x3a3114[_0x5e7609(0x1d3)]}};await this[_0x5e7609(0x221)][_0x5e7609(0x1e9)](this[_0x5e7609(0x21b)],_0x28c5c0);}}async['exec'](){const _0x2cd3df=a182_0x325258,_0x1e7d24=await this[_0x2cd3df(0x237)]();await this[_0x2cd3df(0x221)][_0x2cd3df(0x21c)](this[_0x2cd3df(0x21b)],'In\x20Progress'),await this['commitJob'][_0x2cd3df(0x1f0)](_0x1e7d24,this[_0x2cd3df(0x22a)]),await this[_0x2cd3df(0x21d)](),await this[_0x2cd3df(0x221)][_0x2cd3df(0x21c)](this[_0x2cd3df(0x21b)],_0x2cd3df(0x1ef));}async[a182_0x325258(0x1da)](_0x1ba881){const _0x298ed0=a182_0x325258;try{this[_0x298ed0(0x22a)][_0x298ed0(0x219)](_0x298ed0(0x1d5)+_0x1ba881),await this[_0x298ed0(0x22a)][_0x298ed0(0x213)](),await this[_0x298ed0(0x21d)](!![]),await this[_0x298ed0(0x221)]['setStatus'](this['repositoryData'],_0x298ed0(0x1d9));}catch(_0x15a929){this[_0x298ed0(0x1d8)][_0x298ed0(0x1f2)](_0x15a929);}}async[a182_0x325258(0x1f0)](_0x54c753,_0x5adf80,_0x43c258){const _0x34e582=a182_0x325258;try{this[_0x34e582(0x217)]=_0x54c753,this['provider']=_0x43c258,await this[_0x34e582(0x210)](),this[_0x34e582(0x209)]=await this[_0x34e582(0x1fc)][_0x34e582(0x1de)](this[_0x34e582(0x21b)][_0x34e582(0x227)]),this[_0x34e582(0x216)]=await this[_0x34e582(0x209)]['branches'][_0x34e582(0x1de)](this[_0x34e582(0x21b)][_0x34e582(0x234)]),this['sfLogger']=new salesforce_logger_v2_service_1[(_0x34e582(0x1ee))](_0x5adf80[_0x34e582(0x224)](),(_0x5adf80[_0x34e582(0x22d)]()||_0x34e582(0x20e)+_0x43c258[_0x34e582(0x1e5)]()+_0x34e582(0x1f8)+this[_0x34e582(0x21b)]['repositoryName']+_0x34e582(0x231)+this[_0x34e582(0x21b)][_0x34e582(0x234)]+']')+'\x20['+FlosumCommitJob_1[_0x34e582(0x225)]+']');if(!this['repositoryData'])throw new bad_request_error_1['BadRequestError'](errors_1[_0x34e582(0x1ec)]);await this[_0x34e582(0x22a)][_0x34e582(0x219)](_0x34e582(0x1e2))[_0x34e582(0x213)](),await this[_0x34e582(0x1e0)]()[_0x34e582(0x215)](_0x899572=>this['handleCommitJobError'](_0x899572));}catch(_0x45b325){this[_0x34e582(0x217)]=undefined,this[_0x34e582(0x1d8)][_0x34e582(0x1f2)](_0x45b325);throw _0x45b325;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a182_0x325258(0x1e6)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a182_0x325258(0x1db)],commit_components_job_1[a182_0x325258(0x1f1)],salesforce_sync_service_1[a182_0x325258(0x21e)],git_provider_manager_1[a182_0x325258(0x22e)]])],FlosumCommitJob),exports[a182_0x325258(0x203)]=FlosumCommitJob;