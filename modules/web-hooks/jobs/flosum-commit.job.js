const a182_0x3eacac=a182_0x4767;(function(_0x2e41a3,_0x305bbe){const _0x25dee6=a182_0x4767,_0x47e60c=_0x2e41a3();while(!![]){try{const _0x716113=parseInt(_0x25dee6(0x1b1))/0x1*(-parseInt(_0x25dee6(0x1a9))/0x2)+-parseInt(_0x25dee6(0x189))/0x3*(-parseInt(_0x25dee6(0x169))/0x4)+-parseInt(_0x25dee6(0x160))/0x5+parseInt(_0x25dee6(0x18a))/0x6*(parseInt(_0x25dee6(0x156))/0x7)+parseInt(_0x25dee6(0x1b0))/0x8*(-parseInt(_0x25dee6(0x163))/0x9)+-parseInt(_0x25dee6(0x1a7))/0xa*(parseInt(_0x25dee6(0x1a2))/0xb)+parseInt(_0x25dee6(0x187))/0xc;if(_0x716113===_0x305bbe)break;else _0x47e60c['push'](_0x47e60c['shift']());}catch(_0x45ddef){_0x47e60c['push'](_0x47e60c['shift']());}}}(a182_0x5624,0x56995));function a182_0x5624(){const _0x4de1d0=['getLoggerId','../../salesforce/services/salesforce-logger-v2.service','getOne','SalesforceRetrieverService','defineProperty','syncBranchId','search','FLOSUM_ATTACHMENT','provider','getComponentsToWrite','FlosumCommitJob',']\x20[Branch:\x20','ERR_INVALID_SYNC_RECORD_ID','branch','sfLogger','length','convertToSFDX','salesforceSync','branches','repository','gitManager','SalesforceService','decorate','user','__esModule','In\x20Progress','syncRepositoryId','salesforceService','apply','10110360lqwUiZ','retrieveAttachment','2493mmZDCT','2086242KUsPiu','BadRequestError','split','message','Error','run','../../../core/errors/bad-request.error','function','../../../core','getOwnPropertyDescriptor','../../shared/git-provider.manager','CommitComponentsJob','../../salesforce/services/salesforce.service','repo','name','./commit-components.job','exec','__importDefault','[ERROR]\x20','GitProviderManager','CommitComponentsDto','log','setStatus','deleteAttachment','2182785aEdEoV','send','repoService','deleteAttachmentId','fetchRepositoryData','10ebHHoO','[FLOSUM\x20->\x20GIT]\x20[','114754RnIrsG','updateRemoteState','commitJob','default','SalesforceSyncService','../../salesforce/services/salesforce-retriever.service','metadata','8vNAMQR','11HrqDkR','handleCommitJobError','sha','shortid','../../../constants','Service','error','object','../dto/commit-components.dto','[INFO]\x20Update\x20remote\x20state.','getRepositoryRecord','getCommitDto','typedi','__metadata','logger','repositoryData','7hMYXXV','(((.+)+)+)+$','trim','catch','commitAttachmentId','ERR_UNKNOWN_SYNC_RECORD_ID','updateLastCommit','components','gitUrl','design:paramtypes','1588510kSrxxl','__decorate','toString','1935882QBUCqL','map','Logger','commitData','repositoryName','[INFO]\x20Start\x20commit\x20job','2536SqxIQE'];a182_0x5624=function(){return _0x4de1d0;};return a182_0x5624();}const a182_0x56b921=(function(){let _0x5c094a=!![];return function(_0x475065,_0x36a6db){const _0x5e9775=_0x5c094a?function(){const _0x3b1c70=a182_0x4767;if(_0x36a6db){const _0x2c57f4=_0x36a6db[_0x3b1c70(0x186)](_0x475065,arguments);return _0x36a6db=null,_0x2c57f4;}}:function(){};return _0x5c094a=![],_0x5e9775;};}()),a182_0x25da70=a182_0x56b921(this,function(){const _0x406ac6=a182_0x4767;return a182_0x25da70[_0x406ac6(0x162)]()[_0x406ac6(0x170)](_0x406ac6(0x157))[_0x406ac6(0x162)]()['constructor'](a182_0x25da70)[_0x406ac6(0x170)](_0x406ac6(0x157));});a182_0x25da70();'use strict';var __decorate=this&&this[a182_0x3eacac(0x161)]||function(_0x5ce929,_0x4531e0,_0x318f2d,_0x29ebda){const _0x3e34e7=a182_0x3eacac;var _0x3663f2=arguments[_0x3e34e7(0x179)],_0x2f5a34=_0x3663f2<0x3?_0x4531e0:_0x29ebda===null?_0x29ebda=Object[_0x3e34e7(0x193)](_0x4531e0,_0x318f2d):_0x29ebda,_0x27d6d6;if(typeof Reflect==='object'&&typeof Reflect[_0x3e34e7(0x180)]===_0x3e34e7(0x191))_0x2f5a34=Reflect[_0x3e34e7(0x180)](_0x5ce929,_0x4531e0,_0x318f2d,_0x29ebda);else{for(var _0x25bc68=_0x5ce929['length']-0x1;_0x25bc68>=0x0;_0x25bc68--)if(_0x27d6d6=_0x5ce929[_0x25bc68])_0x2f5a34=(_0x3663f2<0x3?_0x27d6d6(_0x2f5a34):_0x3663f2>0x3?_0x27d6d6(_0x4531e0,_0x318f2d,_0x2f5a34):_0x27d6d6(_0x4531e0,_0x318f2d))||_0x2f5a34;}return _0x3663f2>0x3&&_0x2f5a34&&Object[_0x3e34e7(0x16e)](_0x4531e0,_0x318f2d,_0x2f5a34),_0x2f5a34;},__metadata=this&&this[a182_0x3eacac(0x1be)]||function(_0xf839b5,_0xc541ac){const _0x4db7bd=a182_0x3eacac;if(typeof Reflect===_0x4db7bd(0x1b8)&&typeof Reflect[_0x4db7bd(0x1af)]==='function')return Reflect[_0x4db7bd(0x1af)](_0xf839b5,_0xc541ac);},__importDefault=this&&this[a182_0x3eacac(0x19b)]||function(_0x187802){const _0x233086=a182_0x3eacac;return _0x187802&&_0x187802[_0x233086(0x182)]?_0x187802:{'default':_0x187802};},FlosumCommitJob_1;Object[a182_0x3eacac(0x16e)](exports,'__esModule',{'value':!![]}),exports[a182_0x3eacac(0x174)]=void 0x0;const core_1=require(a182_0x3eacac(0x192)),salesforce_logger_v2_service_1=require(a182_0x3eacac(0x16b)),salesforce_service_1=require(a182_0x3eacac(0x196)),git_provider_manager_1=require(a182_0x3eacac(0x194)),typedi_1=require(a182_0x3eacac(0x1bd)),errors_1=require('../../../constants/errors'),bad_request_error_1=require(a182_0x3eacac(0x190)),salesforce_retriever_service_1=require(a182_0x3eacac(0x1ae)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require(a182_0x3eacac(0x1b9)),commit_components_job_1=require(a182_0x3eacac(0x199)),constants_1=require(a182_0x3eacac(0x1b5)),shortid_1=__importDefault(require(a182_0x3eacac(0x1b4)));function a182_0x4767(_0x4ba982,_0x109019){const _0x13dd64=a182_0x5624();return a182_0x4767=function(_0x25da70,_0x56b921){_0x25da70=_0x25da70-0x156;let _0x56240d=_0x13dd64[_0x25da70];return _0x56240d;},a182_0x4767(_0x4ba982,_0x109019);}let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x1aa183,_0x5cf6b4,_0x4a2ad0,_0x29e37d){const _0x5239fa=a182_0x3eacac;this[_0x5239fa(0x185)]=_0x1aa183,this['commitJob']=_0x5cf6b4,this['salesforceSync']=_0x4a2ad0,this[_0x5239fa(0x17e)]=_0x29e37d,this[_0x5239fa(0x1a4)]=this[_0x5239fa(0x17e)]['getRepoService'](),this[_0x5239fa(0x1bf)]=new core_1[(_0x5239fa(0x165))](FlosumCommitJob_1[_0x5239fa(0x198)]);}async[a182_0x3eacac(0x1a6)](){const _0x4154af=a182_0x3eacac;try{if(this['commitData'][_0x4154af(0x184)])this[_0x4154af(0x1c0)]=await this[_0x4154af(0x17b)][_0x4154af(0x1bb)](this[_0x4154af(0x166)][_0x4154af(0x184)]);else this[_0x4154af(0x166)][_0x4154af(0x16f)]&&(this[_0x4154af(0x1c0)]=await this[_0x4154af(0x17b)]['getBranchRecord'](this[_0x4154af(0x166)][_0x4154af(0x16f)]));}catch(_0x4b246e){throw new bad_request_error_1[(_0x4154af(0x18b))](errors_1[_0x4154af(0x176)]);}}async[a182_0x3eacac(0x173)](){const _0x353703=a182_0x3eacac;if(!this['commitData'][_0x353703(0x15a)])return[];await this[_0x353703(0x185)]['patchObject'](constants_1[_0x353703(0x171)],this[_0x353703(0x166)][_0x353703(0x15a)],{'Name':shortid_1[_0x353703(0x1ac)]()});const _0x29af21=await this[_0x353703(0x185)][_0x353703(0x188)](this[_0x353703(0x166)][_0x353703(0x15a)])['then'](_0x436b70=>_0x436b70[_0x353703(0x18c)]('\x20')[_0x353703(0x164)](_0x5e0a82=>_0x5e0a82[_0x353703(0x158)]()));await this[_0x353703(0x185)][_0x353703(0x1a1)](this[_0x353703(0x166)][_0x353703(0x15a)]);const _0x3abd86=new salesforce_retriever_service_1[(_0x353703(0x16d))](this[_0x353703(0x185)]);return await _0x3abd86[_0x353703(0x18f)](_0x29af21);}async['getComponentsToDelete'](){const _0x23f21c=a182_0x3eacac;if(!this['commitData'][_0x23f21c(0x1a5)])return[];await this['salesforceService']['patchObject'](constants_1[_0x23f21c(0x171)],this['commitData'][_0x23f21c(0x1a5)],{'Name':shortid_1[_0x23f21c(0x1ac)]()});const _0x5d2cb4=await this[_0x23f21c(0x185)][_0x23f21c(0x188)](this[_0x23f21c(0x166)][_0x23f21c(0x1a5)]);return await this[_0x23f21c(0x185)]['deleteAttachment'](this[_0x23f21c(0x166)][_0x23f21c(0x1a5)]),_0x5d2cb4;}async['getCommitDto'](){const _0x2e39f4=a182_0x3eacac,_0x9958c=new commit_components_dto_1[(_0x2e39f4(0x19e))](),[_0x4682a8,_0x59162f]=await Promise['all']([this['getComponentsToWrite'](),this['getComponentsToDelete']()]);return _0x9958c[_0x2e39f4(0x18d)]=this[_0x2e39f4(0x166)][_0x2e39f4(0x18d)],_0x9958c['user']=this[_0x2e39f4(0x166)][_0x2e39f4(0x181)],_0x9958c[_0x2e39f4(0x15d)]={'writed':_0x4682a8,'deleted':_0x59162f},_0x9958c[_0x2e39f4(0x17a)]=this[_0x2e39f4(0x166)][_0x2e39f4(0x17a)],_0x9958c[_0x2e39f4(0x197)]=this['repository'],_0x9958c['branch']=this['branch'],_0x9958c[_0x2e39f4(0x172)]=this['provider'],_0x9958c;}async[a182_0x3eacac(0x15c)](_0x716b57=![]){const _0x7f649c=a182_0x3eacac;if(_0x716b57)await this['salesforceSync']['updateRemoteState'](this[_0x7f649c(0x1c0)],{});else{const _0xa04092=await this[_0x7f649c(0x17d)][_0x7f649c(0x17c)][_0x7f649c(0x16c)](this[_0x7f649c(0x177)]['name']);this[_0x7f649c(0x178)][_0x7f649c(0x19f)](_0x7f649c(0x1ba));const _0xde1ea8={[this[_0x7f649c(0x17d)][_0x7f649c(0x15e)]]:{'lastCommit':_0xa04092[_0x7f649c(0x1b3)]}};await this[_0x7f649c(0x17b)][_0x7f649c(0x1aa)](this[_0x7f649c(0x1c0)],_0xde1ea8);}}async['exec'](){const _0xfc0807=a182_0x3eacac,_0x3eff28=await this[_0xfc0807(0x1bc)]();await this[_0xfc0807(0x17b)][_0xfc0807(0x1a0)](this[_0xfc0807(0x1c0)],_0xfc0807(0x183)),await this[_0xfc0807(0x1ab)][_0xfc0807(0x18f)](_0x3eff28,this['sfLogger']),await this[_0xfc0807(0x15c)](),await this[_0xfc0807(0x17b)][_0xfc0807(0x1a0)](this[_0xfc0807(0x1c0)],'Completed');}async[a182_0x3eacac(0x1b2)](_0x48fcc0){const _0x5de718=a182_0x3eacac;try{this[_0x5de718(0x178)]['log'](_0x5de718(0x19c)+_0x48fcc0),await this[_0x5de718(0x178)][_0x5de718(0x1a3)](),await this[_0x5de718(0x15c)](!![]),await this['salesforceSync'][_0x5de718(0x1a0)](this[_0x5de718(0x1c0)],_0x5de718(0x18e));}catch(_0x2b046c){this[_0x5de718(0x1bf)][_0x5de718(0x1b7)](_0x2b046c);}}async[a182_0x3eacac(0x18f)](_0x18df12,_0x253f03,_0x5c7655){const _0x2b7143=a182_0x3eacac;try{this[_0x2b7143(0x166)]=_0x18df12,this[_0x2b7143(0x172)]=_0x5c7655,await this['fetchRepositoryData'](),this[_0x2b7143(0x17d)]=await this['repoService'][_0x2b7143(0x16c)](this[_0x2b7143(0x1c0)][_0x2b7143(0x167)]),this[_0x2b7143(0x177)]=await this[_0x2b7143(0x17d)][_0x2b7143(0x17c)][_0x2b7143(0x16c)](this[_0x2b7143(0x1c0)]['branchName']),this[_0x2b7143(0x178)]=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x253f03[_0x2b7143(0x16a)](),(_0x253f03['getPrefix']()||_0x2b7143(0x1a8)+_0x5c7655['toUpperCase']()+']\x20[Repository:\x20'+this[_0x2b7143(0x1c0)]['repositoryName']+_0x2b7143(0x175)+this['repositoryData']['branchName']+']')+'\x20['+FlosumCommitJob_1[_0x2b7143(0x198)]+']');if(!this[_0x2b7143(0x1c0)])throw new bad_request_error_1['BadRequestError'](errors_1[_0x2b7143(0x15b)]);await this['sfLogger'][_0x2b7143(0x19f)](_0x2b7143(0x168))[_0x2b7143(0x1a3)](),await this[_0x2b7143(0x19a)]()[_0x2b7143(0x159)](_0x93d79b=>this[_0x2b7143(0x1b2)](_0x93d79b));}catch(_0xf725dd){this['commitData']=undefined,this[_0x2b7143(0x1bf)]['error'](_0xf725dd);throw _0xf725dd;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a182_0x3eacac(0x1b6)]({'transient':!![]}),__metadata(a182_0x3eacac(0x15f),[salesforce_service_1[a182_0x3eacac(0x17f)],commit_components_job_1[a182_0x3eacac(0x195)],salesforce_sync_service_1[a182_0x3eacac(0x1ad)],git_provider_manager_1[a182_0x3eacac(0x19d)]])],FlosumCommitJob),exports[a182_0x3eacac(0x174)]=FlosumCommitJob;