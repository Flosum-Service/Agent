const a182_0x223ef5=a182_0x269f;(function(_0x182f6c,_0x385af4){const _0x619d66=a182_0x269f,_0x55b9a2=_0x182f6c();while(!![]){try{const _0x5765b2=parseInt(_0x619d66(0x129))/0x1+parseInt(_0x619d66(0x11d))/0x2*(parseInt(_0x619d66(0x10b))/0x3)+parseInt(_0x619d66(0x127))/0x4*(parseInt(_0x619d66(0x130))/0x5)+-parseInt(_0x619d66(0x109))/0x6+-parseInt(_0x619d66(0x15a))/0x7*(-parseInt(_0x619d66(0x15c))/0x8)+parseInt(_0x619d66(0x134))/0x9+-parseInt(_0x619d66(0x156))/0xa*(parseInt(_0x619d66(0x13f))/0xb);if(_0x5765b2===_0x385af4)break;else _0x55b9a2['push'](_0x55b9a2['shift']());}catch(_0xa1fab9){_0x55b9a2['push'](_0x55b9a2['shift']());}}}(a182_0x1fab,0x9863d));const a182_0x508883=(function(){let _0xb954b4=!![];return function(_0x5c44d6,_0x505b36){const _0x26b8fd=_0xb954b4?function(){const _0x9e00a5=a182_0x269f;if(_0x505b36){const _0x1263a6=_0x505b36[_0x9e00a5(0x113)](_0x5c44d6,arguments);return _0x505b36=null,_0x1263a6;}}:function(){};return _0xb954b4=![],_0x26b8fd;};}()),a182_0x4f8d91=a182_0x508883(this,function(){const _0x241af1=a182_0x269f;return a182_0x4f8d91['toString']()[_0x241af1(0x131)](_0x241af1(0x143))[_0x241af1(0x132)]()['constructor'](a182_0x4f8d91)['search'](_0x241af1(0x143));});a182_0x4f8d91();'use strict';var __decorate=this&&this[a182_0x223ef5(0x169)]||function(_0x3938af,_0xa17677,_0x8e7314,_0x5ee453){const _0x1dd711=a182_0x223ef5;var _0x1787d2=arguments[_0x1dd711(0x128)],_0x37b494=_0x1787d2<0x3?_0xa17677:_0x5ee453===null?_0x5ee453=Object[_0x1dd711(0x116)](_0xa17677,_0x8e7314):_0x5ee453,_0x1fa7f0;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x1dd711(0x151))_0x37b494=Reflect['decorate'](_0x3938af,_0xa17677,_0x8e7314,_0x5ee453);else{for(var _0x1576ef=_0x3938af[_0x1dd711(0x128)]-0x1;_0x1576ef>=0x0;_0x1576ef--)if(_0x1fa7f0=_0x3938af[_0x1576ef])_0x37b494=(_0x1787d2<0x3?_0x1fa7f0(_0x37b494):_0x1787d2>0x3?_0x1fa7f0(_0xa17677,_0x8e7314,_0x37b494):_0x1fa7f0(_0xa17677,_0x8e7314))||_0x37b494;}return _0x1787d2>0x3&&_0x37b494&&Object[_0x1dd711(0x118)](_0xa17677,_0x8e7314,_0x37b494),_0x37b494;},__metadata=this&&this['__metadata']||function(_0x586e69,_0x418c98){const _0x233019=a182_0x223ef5;if(typeof Reflect===_0x233019(0x155)&&typeof Reflect[_0x233019(0x124)]===_0x233019(0x151))return Reflect[_0x233019(0x124)](_0x586e69,_0x418c98);},FlosumCommitJob_1;Object[a182_0x223ef5(0x118)](exports,a182_0x223ef5(0x117),{'value':!![]}),exports[a182_0x223ef5(0x12e)]=void 0x0;function a182_0x1fab(){const _0x4fd4a7=['747839MmEuBh','[FLOSUM\x20->\x20GIT]\x20[','getComponentsToWrite','sfLogger','deleteAttachmentId','FlosumCommitJob','In\x20Progress','3359495AripDi','search','toString','run','5487363tbbSTZ','syncBranchId','syncRepositoryId',']\x20[Branch:\x20','setStatus','Logger','commitData','exec','../../salesforce/services/salesforce-sync.service','handleCommitJobError','catch','76505eHzpZV','getBranchRecord','name','map','(((.+)+)+)+$','getRepositoryRecord','Service','repositoryData','ERR_UNKNOWN_SYNC_RECORD_ID','SalesforceLogger2','logger','error','user','BadRequestError','branchName','gitUrl','deleteAttachment','Completed','function','GitProviderManager','salesforceService','getLoggerId','object','1640PTldny','convertToSFDX','[ERROR]\x20','CommitComponentsDto','21YAbJPX','updateLastCommit','850664ilByTS','getOne','salesforceSync','SalesforceRetrieverService','../../shared/git-provider.manager','../../../core/errors/bad-request.error','provider','typedi','repoService','log','then','gitManager','trim','__decorate','updateRemoteState','SalesforceService','7224726KhzNPr','branch','1861458jbWNrM','repository','design:paramtypes','repositoryName','../../salesforce/services/salesforce-logger-v2.service','branches','getComponentsToDelete','message','apply',']\x20[Repository:\x20','sha','getOwnPropertyDescriptor','__esModule','defineProperty','getCommitDto','retrieveAttachment','./commit-components.job','[INFO]\x20Update\x20remote\x20state.','2PsuVvt','getRepoService','fetchRepositoryData','send','../dto/commit-components.dto','commitJob','../../salesforce/services/salesforce-retriever.service','metadata','commitAttachmentId','CommitComponentsJob','4bqfjJq','length'];a182_0x1fab=function(){return _0x4fd4a7;};return a182_0x1fab();}function a182_0x269f(_0x1468ff,_0xe017b2){const _0x16dc27=a182_0x1fab();return a182_0x269f=function(_0x4f8d91,_0x508883){_0x4f8d91=_0x4f8d91-0x109;let _0x1fabf7=_0x16dc27[_0x4f8d91];return _0x1fabf7;},a182_0x269f(_0x1468ff,_0xe017b2);}const core_1=require('../../../core'),salesforce_logger_v2_service_1=require(a182_0x223ef5(0x10f)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a182_0x223ef5(0x160)),typedi_1=require(a182_0x223ef5(0x163)),errors_1=require('../../../constants/errors'),bad_request_error_1=require(a182_0x223ef5(0x161)),salesforce_retriever_service_1=require(a182_0x223ef5(0x123)),salesforce_sync_service_1=require(a182_0x223ef5(0x13c)),commit_components_dto_1=require(a182_0x223ef5(0x121)),commit_components_job_1=require(a182_0x223ef5(0x11b));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x2c57ae,_0x574fcb,_0x5e539b,_0x28e8c6){const _0x246c16=a182_0x223ef5;this[_0x246c16(0x153)]=_0x2c57ae,this[_0x246c16(0x122)]=_0x574fcb,this[_0x246c16(0x15e)]=_0x5e539b,this[_0x246c16(0x167)]=_0x28e8c6,this[_0x246c16(0x164)]=this[_0x246c16(0x167)][_0x246c16(0x11e)](),this[_0x246c16(0x149)]=new core_1[(_0x246c16(0x139))](FlosumCommitJob_1[_0x246c16(0x141)]);}async[a182_0x223ef5(0x11f)](){const _0x33d67c=a182_0x223ef5;try{if(this['commitData'][_0x33d67c(0x136)])this[_0x33d67c(0x146)]=await this[_0x33d67c(0x15e)][_0x33d67c(0x144)](this[_0x33d67c(0x13a)]['syncRepositoryId']);else this[_0x33d67c(0x13a)]['syncBranchId']&&(this[_0x33d67c(0x146)]=await this['salesforceSync'][_0x33d67c(0x140)](this[_0x33d67c(0x13a)][_0x33d67c(0x135)]));}catch(_0x3456ac){throw new bad_request_error_1['BadRequestError'](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async[a182_0x223ef5(0x12b)](){const _0x106634=a182_0x223ef5;if(!this[_0x106634(0x13a)][_0x106634(0x125)])return[];const _0x596892=await this[_0x106634(0x153)][_0x106634(0x11a)](this[_0x106634(0x13a)][_0x106634(0x125)])[_0x106634(0x166)](_0x5999b8=>_0x5999b8['split']('\x20')[_0x106634(0x142)](_0x12aa6d=>_0x12aa6d[_0x106634(0x168)]())),_0x173535=new salesforce_retriever_service_1[(_0x106634(0x15f))](this[_0x106634(0x153)]),_0x3e0b20=await _0x173535[_0x106634(0x133)](_0x596892);return _0x3e0b20;}async[a182_0x223ef5(0x111)](){const _0x405b60=a182_0x223ef5;if(!this[_0x405b60(0x13a)][_0x405b60(0x12d)])return[];const _0x4c4fda=await this[_0x405b60(0x153)][_0x405b60(0x11a)](this['commitData']['deleteAttachmentId']);return _0x4c4fda;}async[a182_0x223ef5(0x119)](){const _0xe6180c=a182_0x223ef5,_0x297c05=new commit_components_dto_1[(_0xe6180c(0x159))](),[_0x4f60b7,_0x4f9c2d]=await Promise['all']([this['getComponentsToWrite'](),this[_0xe6180c(0x111)]()]);return _0x297c05[_0xe6180c(0x112)]=this['commitData'][_0xe6180c(0x112)],_0x297c05[_0xe6180c(0x14b)]=this[_0xe6180c(0x13a)][_0xe6180c(0x14b)],_0x297c05['components']={'writed':_0x4f60b7,'deleted':_0x4f9c2d},_0x297c05[_0xe6180c(0x157)]=this['commitData'][_0xe6180c(0x157)],_0x297c05['repo']=this[_0xe6180c(0x10c)],_0x297c05[_0xe6180c(0x10a)]=this[_0xe6180c(0x10a)],_0x297c05[_0xe6180c(0x162)]=this[_0xe6180c(0x162)],_0x297c05;}async[a182_0x223ef5(0x15b)](_0x1163b7=![]){const _0x4f7f32=a182_0x223ef5;if(_0x1163b7)await this[_0x4f7f32(0x15e)][_0x4f7f32(0x16a)](this[_0x4f7f32(0x146)],{});else{const _0x2daa7b=await this[_0x4f7f32(0x10c)][_0x4f7f32(0x110)]['getOne'](this[_0x4f7f32(0x10a)]['name']);this[_0x4f7f32(0x12c)]['log'](_0x4f7f32(0x11c));const _0x4d4e25={[this[_0x4f7f32(0x10c)][_0x4f7f32(0x14e)]]:{'lastCommit':_0x2daa7b[_0x4f7f32(0x115)]}};await this[_0x4f7f32(0x15e)][_0x4f7f32(0x16a)](this['repositoryData'],_0x4d4e25);}}async[a182_0x223ef5(0x13b)](){const _0xe773c1=a182_0x223ef5,_0x51320a=await this[_0xe773c1(0x119)]();await this[_0xe773c1(0x15e)][_0xe773c1(0x138)](this['repositoryData'],_0xe773c1(0x12f)),await this[_0xe773c1(0x122)][_0xe773c1(0x133)](_0x51320a,this['sfLogger']),await this['updateLastCommit'](),this[_0xe773c1(0x13a)]['commitAttachmentId']&&await this[_0xe773c1(0x153)][_0xe773c1(0x14f)](this[_0xe773c1(0x13a)][_0xe773c1(0x125)]),this[_0xe773c1(0x13a)][_0xe773c1(0x12d)]&&await this[_0xe773c1(0x153)][_0xe773c1(0x14f)](this[_0xe773c1(0x13a)][_0xe773c1(0x12d)]),await this[_0xe773c1(0x15e)][_0xe773c1(0x138)](this[_0xe773c1(0x146)],_0xe773c1(0x150));}async[a182_0x223ef5(0x13d)](_0x2b7cae){const _0x38f140=a182_0x223ef5;try{this[_0x38f140(0x12c)][_0x38f140(0x165)](_0x38f140(0x158)+_0x2b7cae),await this[_0x38f140(0x12c)]['send'](),await this[_0x38f140(0x15b)](!![]),await this[_0x38f140(0x15e)][_0x38f140(0x138)](this[_0x38f140(0x146)],'Error');}catch(_0x44f75b){this[_0x38f140(0x149)][_0x38f140(0x14a)](_0x44f75b);}}async[a182_0x223ef5(0x133)](_0x445ab5,_0x373b10,_0xa59643){const _0x4f6c83=a182_0x223ef5;try{this[_0x4f6c83(0x13a)]=_0x445ab5,this[_0x4f6c83(0x162)]=_0xa59643,await this[_0x4f6c83(0x11f)](),this[_0x4f6c83(0x10c)]=await this[_0x4f6c83(0x164)][_0x4f6c83(0x15d)](this[_0x4f6c83(0x146)][_0x4f6c83(0x10e)]),this[_0x4f6c83(0x10a)]=await this[_0x4f6c83(0x10c)][_0x4f6c83(0x110)][_0x4f6c83(0x15d)](this[_0x4f6c83(0x146)][_0x4f6c83(0x14d)]),this[_0x4f6c83(0x12c)]=new salesforce_logger_v2_service_1[(_0x4f6c83(0x148))](_0x373b10[_0x4f6c83(0x154)](),(_0x373b10['getPrefix']()||_0x4f6c83(0x12a)+_0xa59643['toUpperCase']()+_0x4f6c83(0x114)+this[_0x4f6c83(0x146)][_0x4f6c83(0x10e)]+_0x4f6c83(0x137)+this['repositoryData'][_0x4f6c83(0x14d)]+']')+'\x20['+FlosumCommitJob_1[_0x4f6c83(0x141)]+']');if(!this[_0x4f6c83(0x146)])throw new bad_request_error_1[(_0x4f6c83(0x14c))](errors_1[_0x4f6c83(0x147)]);await this[_0x4f6c83(0x12c)][_0x4f6c83(0x165)]('[INFO]\x20Start\x20commit\x20job')[_0x4f6c83(0x120)](),await this['exec']()[_0x4f6c83(0x13e)](_0x295389=>this['handleCommitJobError'](_0x295389));}catch(_0x22ea47){this[_0x4f6c83(0x13a)]=undefined,this[_0x4f6c83(0x149)][_0x4f6c83(0x14a)](_0x22ea47);throw _0x22ea47;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a182_0x223ef5(0x145)]({'transient':!![]}),__metadata(a182_0x223ef5(0x10d),[salesforce_service_1[a182_0x223ef5(0x16b)],commit_components_job_1[a182_0x223ef5(0x126)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a182_0x223ef5(0x152)]])],FlosumCommitJob),exports[a182_0x223ef5(0x12e)]=FlosumCommitJob;