const a181_0x5284f6=a181_0x4b29;function a181_0x4b29(_0x3dbb0d,_0x4e65d4){const _0x313756=a181_0x1f24();return a181_0x4b29=function(_0x452259,_0x250753){_0x452259=_0x452259-0x158;let _0x1f2449=_0x313756[_0x452259];return _0x1f2449;},a181_0x4b29(_0x3dbb0d,_0x4e65d4);}(function(_0x3d3558,_0x3e12c6){const _0x47a97c=a181_0x4b29,_0x266312=_0x3d3558();while(!![]){try{const _0xcede92=parseInt(_0x47a97c(0x193))/0x1+-parseInt(_0x47a97c(0x161))/0x2+parseInt(_0x47a97c(0x15d))/0x3*(parseInt(_0x47a97c(0x1ac))/0x4)+-parseInt(_0x47a97c(0x1a7))/0x5*(-parseInt(_0x47a97c(0x194))/0x6)+-parseInt(_0x47a97c(0x1a0))/0x7+parseInt(_0x47a97c(0x177))/0x8*(parseInt(_0x47a97c(0x1a9))/0x9)+-parseInt(_0x47a97c(0x19f))/0xa;if(_0xcede92===_0x3e12c6)break;else _0x266312['push'](_0x266312['shift']());}catch(_0x1709e0){_0x266312['push'](_0x266312['shift']());}}}(a181_0x1f24,0x68d25));const a181_0x250753=(function(){let _0x206c70=!![];return function(_0x274eb5,_0x346433){const _0x9d08d3=_0x206c70?function(){const _0x45a7da=a181_0x4b29;if(_0x346433){const _0xeea6ff=_0x346433[_0x45a7da(0x176)](_0x274eb5,arguments);return _0x346433=null,_0xeea6ff;}}:function(){};return _0x206c70=![],_0x9d08d3;};}()),a181_0x452259=a181_0x250753(this,function(){const _0x38d4f5=a181_0x4b29;return a181_0x452259['toString']()[_0x38d4f5(0x1b1)](_0x38d4f5(0x1ab))[_0x38d4f5(0x18c)]()[_0x38d4f5(0x178)](a181_0x452259)[_0x38d4f5(0x1b1)](_0x38d4f5(0x1ab));});function a181_0x1f24(){const _0xc80914=['exec','object','getOwnPropertyDescriptor','decorate','Service','toString','design:paramtypes','error','commitJob','branch','handleCommitJobError','commitData','431063HuYqjv','7278OxKwuk','provider','repositoryName','getComponentsToWrite','sha','BadRequestError','../../../core/errors/bad-request.error','trim','../dto/commit-components.dto','setStatus',']\x20[Branch:\x20','9315140hXJORx','94206eMBupg','fetchRepositoryData','logger','../../../constants/errors','run','GitProviderManager','../../salesforce/services/salesforce-sync.service','1775tjXJsS','[INFO]\x20Update\x20remote\x20state.','180JDOVDZ','repositoryData','(((.+)+)+)+$','2446972QezPaA','branchName','sfLogger','FlosumCommitJob','syncBranchId','search','components','function','metadata','salesforceSync','syncRepositoryId','[FLOSUM\x20->\x20GIT]\x20[','[INFO]\x20Start\x20commit\x20job','gitUrl',']\x20[Repository:\x20','3heVfAb','CommitComponentsJob','then','length','1362560VeKqlD','ERR_UNKNOWN_SYNC_RECORD_ID','all','deleteAttachmentId','getPrefix','getCommitDto','Completed','branches','CommitComponentsDto','getBranchRecord','gitManager','split','message','repository','getComponentsToDelete','SalesforceRetrieverService','name','getLoggerId','updateLastCommit','getOne','repo','apply','232872DwfVDh','constructor','salesforceService','repoService','getRepoService','toUpperCase','convertToSFDX','[ERROR]\x20','log','typedi','ERR_INVALID_SYNC_RECORD_ID','user','In\x20Progress','retrieveAttachment','commitAttachmentId','Error'];a181_0x1f24=function(){return _0xc80914;};return a181_0x1f24();}a181_0x452259();'use strict';var __decorate=this&&this['__decorate']||function(_0x467252,_0x58868e,_0x47d4ab,_0x222303){const _0x15c94b=a181_0x4b29;var _0x3ea774=arguments[_0x15c94b(0x160)],_0x2ad096=_0x3ea774<0x3?_0x58868e:_0x222303===null?_0x222303=Object[_0x15c94b(0x189)](_0x58868e,_0x47d4ab):_0x222303,_0x40d38d;if(typeof Reflect==='object'&&typeof Reflect[_0x15c94b(0x18a)]===_0x15c94b(0x1b3))_0x2ad096=Reflect[_0x15c94b(0x18a)](_0x467252,_0x58868e,_0x47d4ab,_0x222303);else{for(var _0x2e9bca=_0x467252[_0x15c94b(0x160)]-0x1;_0x2e9bca>=0x0;_0x2e9bca--)if(_0x40d38d=_0x467252[_0x2e9bca])_0x2ad096=(_0x3ea774<0x3?_0x40d38d(_0x2ad096):_0x3ea774>0x3?_0x40d38d(_0x58868e,_0x47d4ab,_0x2ad096):_0x40d38d(_0x58868e,_0x47d4ab))||_0x2ad096;}return _0x3ea774>0x3&&_0x2ad096&&Object['defineProperty'](_0x58868e,_0x47d4ab,_0x2ad096),_0x2ad096;},__metadata=this&&this['__metadata']||function(_0x1b5ed3,_0x3313fa){const _0x44d27a=a181_0x4b29;if(typeof Reflect===_0x44d27a(0x188)&&typeof Reflect[_0x44d27a(0x1b4)]==='function')return Reflect[_0x44d27a(0x1b4)](_0x1b5ed3,_0x3313fa);},FlosumCommitJob_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a181_0x5284f6(0x1af)]=void 0x0;const core_1=require('../../../core'),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require('../../shared/git-provider.manager'),typedi_1=require(a181_0x5284f6(0x180)),errors_1=require(a181_0x5284f6(0x1a3)),bad_request_error_1=require(a181_0x5284f6(0x19a)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a181_0x5284f6(0x1a6)),commit_components_dto_1=require(a181_0x5284f6(0x19c)),commit_components_job_1=require('./commit-components.job');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x246b7c,_0x42b1ca,_0x561b80,_0x536cb1){const _0x46f932=a181_0x5284f6;this[_0x46f932(0x179)]=_0x246b7c,this['commitJob']=_0x42b1ca,this[_0x46f932(0x1b5)]=_0x561b80,this['gitManager']=_0x536cb1,this[_0x46f932(0x17a)]=this[_0x46f932(0x16b)][_0x46f932(0x17b)](),this[_0x46f932(0x1a2)]=new core_1['Logger'](FlosumCommitJob_1['name']);}async[a181_0x5284f6(0x1a1)](){const _0x1f05fd=a181_0x5284f6;try{if(this[_0x1f05fd(0x192)][_0x1f05fd(0x158)])this['repositoryData']=await this[_0x1f05fd(0x1b5)]['getRepositoryRecord'](this[_0x1f05fd(0x192)]['syncRepositoryId']);else this[_0x1f05fd(0x192)][_0x1f05fd(0x1b0)]&&(this[_0x1f05fd(0x1aa)]=await this['salesforceSync'][_0x1f05fd(0x16a)](this[_0x1f05fd(0x192)][_0x1f05fd(0x1b0)]));}catch(_0x2789d5){throw new bad_request_error_1[(_0x1f05fd(0x199))](errors_1[_0x1f05fd(0x181)]);}}async[a181_0x5284f6(0x197)](){const _0x3bdcb3=a181_0x5284f6;if(!this[_0x3bdcb3(0x192)][_0x3bdcb3(0x185)])return[];const _0xc68ae2=await this[_0x3bdcb3(0x179)][_0x3bdcb3(0x184)](this[_0x3bdcb3(0x192)]['commitAttachmentId'])[_0x3bdcb3(0x15f)](_0x41b7d4=>_0x41b7d4[_0x3bdcb3(0x16c)]('\x20')['map'](_0x2482bb=>_0x2482bb[_0x3bdcb3(0x19b)]())),_0x2f92c0=new salesforce_retriever_service_1[(_0x3bdcb3(0x170))](this[_0x3bdcb3(0x179)]),_0x5b7209=await _0x2f92c0[_0x3bdcb3(0x1a4)](_0xc68ae2);return _0x5b7209;}async[a181_0x5284f6(0x16f)](){const _0x55eaa7=a181_0x5284f6;if(!this['commitData'][_0x55eaa7(0x164)])return[];const _0x282f18=await this[_0x55eaa7(0x179)]['retrieveAttachment'](this[_0x55eaa7(0x192)][_0x55eaa7(0x164)]);return _0x282f18;}async['getCommitDto'](){const _0x589539=a181_0x5284f6,_0x10a7cb=new commit_components_dto_1[(_0x589539(0x169))](),[_0x4f9d36,_0x443929]=await Promise[_0x589539(0x163)]([this['getComponentsToWrite'](),this[_0x589539(0x16f)]()]);return _0x10a7cb[_0x589539(0x16d)]=this['commitData'][_0x589539(0x16d)],_0x10a7cb[_0x589539(0x182)]=this[_0x589539(0x192)]['user'],_0x10a7cb[_0x589539(0x1b2)]={'writed':_0x4f9d36,'deleted':_0x443929},_0x10a7cb[_0x589539(0x17d)]=this['commitData'][_0x589539(0x17d)],_0x10a7cb[_0x589539(0x175)]=this[_0x589539(0x16e)],_0x10a7cb[_0x589539(0x190)]=this[_0x589539(0x190)],_0x10a7cb[_0x589539(0x195)]=this['provider'],_0x10a7cb;}async['updateLastCommit'](_0x2255fe=![]){const _0x356810=a181_0x5284f6;if(_0x2255fe)await this[_0x356810(0x1b5)]['updateRemoteState'](this[_0x356810(0x1aa)],{});else{const _0x35e0f9=await this[_0x356810(0x16e)][_0x356810(0x168)][_0x356810(0x174)](this[_0x356810(0x190)]['name']);this[_0x356810(0x1ae)][_0x356810(0x17f)](_0x356810(0x1a8));const _0x4e379e={[this[_0x356810(0x16e)][_0x356810(0x15b)]]:{'lastCommit':_0x35e0f9[_0x356810(0x198)]}};await this[_0x356810(0x1b5)]['updateRemoteState'](this[_0x356810(0x1aa)],_0x4e379e);}}async[a181_0x5284f6(0x187)](){const _0x17fff8=a181_0x5284f6,_0x560869=await this[_0x17fff8(0x166)]();await this[_0x17fff8(0x1b5)][_0x17fff8(0x19d)](this[_0x17fff8(0x1aa)],_0x17fff8(0x183)),await this[_0x17fff8(0x18f)]['run'](_0x560869,this[_0x17fff8(0x1ae)]),await this[_0x17fff8(0x173)](),this[_0x17fff8(0x192)][_0x17fff8(0x185)]&&await this[_0x17fff8(0x179)]['deleteAttachment'](this[_0x17fff8(0x192)][_0x17fff8(0x185)]),this['commitData']['deleteAttachmentId']&&await this[_0x17fff8(0x179)]['deleteAttachment'](this[_0x17fff8(0x192)][_0x17fff8(0x164)]),await this['salesforceSync']['setStatus'](this[_0x17fff8(0x1aa)],_0x17fff8(0x167));}async[a181_0x5284f6(0x191)](_0x3b2a5c){const _0x327f52=a181_0x5284f6;try{this[_0x327f52(0x1ae)][_0x327f52(0x17f)](_0x327f52(0x17e)+_0x3b2a5c),await this['sfLogger']['send'](),await this['updateLastCommit'](!![]),await this['salesforceSync'][_0x327f52(0x19d)](this['repositoryData'],_0x327f52(0x186));}catch(_0x3d3bd6){this[_0x327f52(0x1a2)][_0x327f52(0x18e)](_0x3d3bd6);}}async['run'](_0x1a623b,_0x1a310d,_0x4c7de8){const _0x5ecfea=a181_0x5284f6;try{this[_0x5ecfea(0x192)]=_0x1a623b,this[_0x5ecfea(0x195)]=_0x4c7de8,await this[_0x5ecfea(0x1a1)](),this[_0x5ecfea(0x16e)]=await this['repoService'][_0x5ecfea(0x174)](this[_0x5ecfea(0x1aa)][_0x5ecfea(0x196)]),this[_0x5ecfea(0x190)]=await this['repository'][_0x5ecfea(0x168)][_0x5ecfea(0x174)](this['repositoryData'][_0x5ecfea(0x1ad)]),this[_0x5ecfea(0x1ae)]=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x1a310d[_0x5ecfea(0x172)](),(_0x1a310d[_0x5ecfea(0x165)]()||_0x5ecfea(0x159)+_0x4c7de8[_0x5ecfea(0x17c)]()+_0x5ecfea(0x15c)+this['repositoryData'][_0x5ecfea(0x196)]+_0x5ecfea(0x19e)+this[_0x5ecfea(0x1aa)][_0x5ecfea(0x1ad)]+']')+'\x20['+FlosumCommitJob_1[_0x5ecfea(0x171)]+']');if(!this[_0x5ecfea(0x1aa)])throw new bad_request_error_1[(_0x5ecfea(0x199))](errors_1[_0x5ecfea(0x162)]);await this[_0x5ecfea(0x1ae)][_0x5ecfea(0x17f)](_0x5ecfea(0x15a))['send'](),await this[_0x5ecfea(0x187)]()['catch'](_0xb09a13=>this['handleCommitJobError'](_0xb09a13));}catch(_0xe7dd47){this[_0x5ecfea(0x192)]=undefined,this[_0x5ecfea(0x1a2)][_0x5ecfea(0x18e)](_0xe7dd47);throw _0xe7dd47;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a181_0x5284f6(0x18b)]({'transient':!![]}),__metadata(a181_0x5284f6(0x18d),[salesforce_service_1['SalesforceService'],commit_components_job_1[a181_0x5284f6(0x15e)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a181_0x5284f6(0x1a5)]])],FlosumCommitJob),exports[a181_0x5284f6(0x1af)]=FlosumCommitJob;