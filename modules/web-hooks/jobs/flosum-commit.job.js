function a183_0x3fc5(){const _0x40c99c=['__decorate','syncBranchId','repository','commitAttachmentId','../dto/commit-components.dto','ERR_INVALID_SYNC_RECORD_ID',']\x20[Repository:\x20','commitJob','length','[ERROR]\x20','getComponentsToDelete','6375018jvwTKc','repositoryName','gitUrl','5910136rgurBJ','../../salesforce/services/salesforce.service','repo','(((.+)+)+)+$','search','SalesforceSyncService','log','1235912xldrVu','patchObject','all','message','user','commitData','Service','getLoggerId','getComponentsToWrite','deleteAttachmentId','convertToSFDX','logger','FlosumCommitJob','setStatus','2060802VbnZzc','[INFO]\x20Start\x20commit\x20job','branch','trim','Completed','2285710nLSvlI','[FLOSUM\x20->\x20GIT]\x20[','default','FLOSUM_ATTACHMENT','getPrefix','apply','defineProperty','CommitComponentsDto','name','../../../constants/errors','Error','2362251vVOGUF','run','374081yBkkTE','send','getCommitDto','catch','branches','[INFO]\x20Update\x20remote\x20state.','shortid','components','gitManager','updateRemoteState','__esModule','7xyQzCQ','SalesforceLogger2','sha','handleCommitJobError','getOwnPropertyDescriptor','branchName','salesforceService',']\x20[Branch:\x20','object','error','repositoryData','CommitComponentsJob','retrieveAttachment','exec','../../../constants','In\x20Progress','sfLogger','decorate','split','../../../core','getOne','deleteAttachment','function','updateLastCommit','fetchRepositoryData','getBranchRecord','salesforceSync','then','metadata','map','typedi','provider','../../../core/errors/bad-request.error'];a183_0x3fc5=function(){return _0x40c99c;};return a183_0x3fc5();}const a183_0x54a459=a183_0x4923;(function(_0x45f2de,_0x23317b){const _0x18e2e3=a183_0x4923,_0x4dcb5f=_0x45f2de();while(!![]){try{const _0x4e889f=parseInt(_0x18e2e3(0x1a6))/0x1+-parseInt(_0x18e2e3(0x194))/0x2+-parseInt(_0x18e2e3(0x1a4))/0x3+parseInt(_0x18e2e3(0x1e0))/0x4+-parseInt(_0x18e2e3(0x199))/0x5+parseInt(_0x18e2e3(0x1dd))/0x6+parseInt(_0x18e2e3(0x1b1))/0x7*(parseInt(_0x18e2e3(0x186))/0x8);if(_0x4e889f===_0x23317b)break;else _0x4dcb5f['push'](_0x4dcb5f['shift']());}catch(_0x3511ee){_0x4dcb5f['push'](_0x4dcb5f['shift']());}}}(a183_0x3fc5,0xc1c2f));const a183_0xcf1a0=(function(){let _0x1224ec=!![];return function(_0x35d4cd,_0x4c86c1){const _0x3ffecb=_0x1224ec?function(){const _0x302675=a183_0x4923;if(_0x4c86c1){const _0x48ec2a=_0x4c86c1[_0x302675(0x19e)](_0x35d4cd,arguments);return _0x4c86c1=null,_0x48ec2a;}}:function(){};return _0x1224ec=![],_0x3ffecb;};}()),a183_0x23dfde=a183_0xcf1a0(this,function(){const _0x28daa5=a183_0x4923;return a183_0x23dfde['toString']()[_0x28daa5(0x183)](_0x28daa5(0x182))['toString']()['constructor'](a183_0x23dfde)[_0x28daa5(0x183)](_0x28daa5(0x182));});a183_0x23dfde();'use strict';var __decorate=this&&this[a183_0x54a459(0x1d2)]||function(_0x4817a1,_0x4bac00,_0x51de37,_0x311548){const _0x168efb=a183_0x54a459;var _0x584906=arguments[_0x168efb(0x1da)],_0x17c0f8=_0x584906<0x3?_0x4bac00:_0x311548===null?_0x311548=Object[_0x168efb(0x1b5)](_0x4bac00,_0x51de37):_0x311548,_0x297618;if(typeof Reflect===_0x168efb(0x1b9)&&typeof Reflect[_0x168efb(0x1c2)]===_0x168efb(0x1c7))_0x17c0f8=Reflect[_0x168efb(0x1c2)](_0x4817a1,_0x4bac00,_0x51de37,_0x311548);else{for(var _0x6aa25b=_0x4817a1[_0x168efb(0x1da)]-0x1;_0x6aa25b>=0x0;_0x6aa25b--)if(_0x297618=_0x4817a1[_0x6aa25b])_0x17c0f8=(_0x584906<0x3?_0x297618(_0x17c0f8):_0x584906>0x3?_0x297618(_0x4bac00,_0x51de37,_0x17c0f8):_0x297618(_0x4bac00,_0x51de37))||_0x17c0f8;}return _0x584906>0x3&&_0x17c0f8&&Object[_0x168efb(0x19f)](_0x4bac00,_0x51de37,_0x17c0f8),_0x17c0f8;},__metadata=this&&this['__metadata']||function(_0x558958,_0x3250de){const _0xd0ba82=a183_0x54a459;if(typeof Reflect===_0xd0ba82(0x1b9)&&typeof Reflect['metadata']===_0xd0ba82(0x1c7))return Reflect[_0xd0ba82(0x1cd)](_0x558958,_0x3250de);},__importDefault=this&&this['__importDefault']||function(_0x3d6a04){return _0x3d6a04&&_0x3d6a04['__esModule']?_0x3d6a04:{'default':_0x3d6a04};},FlosumCommitJob_1;Object[a183_0x54a459(0x19f)](exports,a183_0x54a459(0x1b0),{'value':!![]}),exports[a183_0x54a459(0x192)]=void 0x0;const core_1=require(a183_0x54a459(0x1c4)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_service_1=require(a183_0x54a459(0x1e1)),git_provider_manager_1=require('../../shared/git-provider.manager'),typedi_1=require(a183_0x54a459(0x1cf)),errors_1=require(a183_0x54a459(0x1a2)),bad_request_error_1=require(a183_0x54a459(0x1d1)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require(a183_0x54a459(0x1d6)),commit_components_job_1=require('./commit-components.job'),constants_1=require(a183_0x54a459(0x1bf)),shortid_1=__importDefault(require(a183_0x54a459(0x1ac)));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x323a58,_0x2bdb33,_0x325991,_0x3e5cbc){const _0x1372cd=a183_0x54a459;this['salesforceService']=_0x323a58,this[_0x1372cd(0x1d9)]=_0x2bdb33,this[_0x1372cd(0x1cb)]=_0x325991,this[_0x1372cd(0x1ae)]=_0x3e5cbc,this['repoService']=this[_0x1372cd(0x1ae)]['getRepoService'](),this[_0x1372cd(0x191)]=new core_1['Logger'](FlosumCommitJob_1[_0x1372cd(0x1a1)]);}async['fetchRepositoryData'](){const _0x439a1b=a183_0x54a459;try{if(this[_0x439a1b(0x18b)]['syncRepositoryId'])this['repositoryData']=await this[_0x439a1b(0x1cb)]['getRepositoryRecord'](this[_0x439a1b(0x18b)]['syncRepositoryId']);else this[_0x439a1b(0x18b)][_0x439a1b(0x1d3)]&&(this[_0x439a1b(0x1bb)]=await this[_0x439a1b(0x1cb)][_0x439a1b(0x1ca)](this['commitData'][_0x439a1b(0x1d3)]));}catch(_0x12df11){throw new bad_request_error_1['BadRequestError'](errors_1[_0x439a1b(0x1d7)]);}}async['getComponentsToWrite'](){const _0x39dd7d=a183_0x54a459;if(!this[_0x39dd7d(0x18b)][_0x39dd7d(0x1d5)])return[];await this[_0x39dd7d(0x1b7)][_0x39dd7d(0x187)](constants_1[_0x39dd7d(0x19c)],this[_0x39dd7d(0x18b)]['commitAttachmentId'],{'Name':shortid_1['default']()});const _0x3945c2=await this[_0x39dd7d(0x1b7)][_0x39dd7d(0x1bd)](this[_0x39dd7d(0x18b)][_0x39dd7d(0x1d5)])[_0x39dd7d(0x1cc)](_0x45a099=>_0x45a099[_0x39dd7d(0x1c3)]('\x20')[_0x39dd7d(0x1ce)](_0x3fec92=>_0x3fec92[_0x39dd7d(0x197)]()));await this[_0x39dd7d(0x1b7)][_0x39dd7d(0x1c6)](this['commitData'][_0x39dd7d(0x1d5)]);const _0x3a74c1=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x39dd7d(0x1b7)]);return await _0x3a74c1[_0x39dd7d(0x1a5)](_0x3945c2);}async[a183_0x54a459(0x1dc)](){const _0x2728aa=a183_0x54a459;if(!this[_0x2728aa(0x18b)]['deleteAttachmentId'])return[];await this[_0x2728aa(0x1b7)]['patchObject'](constants_1[_0x2728aa(0x19c)],this['commitData'][_0x2728aa(0x18f)],{'Name':shortid_1[_0x2728aa(0x19b)]()});const _0x2ef4e1=await this[_0x2728aa(0x1b7)][_0x2728aa(0x1bd)](this[_0x2728aa(0x18b)]['deleteAttachmentId']);return await this[_0x2728aa(0x1b7)][_0x2728aa(0x1c6)](this['commitData'][_0x2728aa(0x18f)]),_0x2ef4e1;}async[a183_0x54a459(0x1a8)](){const _0x35f11b=a183_0x54a459,_0x4df639=new commit_components_dto_1[(_0x35f11b(0x1a0))](),[_0x4df6f8,_0x3a2b16]=await Promise[_0x35f11b(0x188)]([this[_0x35f11b(0x18e)](),this[_0x35f11b(0x1dc)]()]);return _0x4df639[_0x35f11b(0x189)]=this[_0x35f11b(0x18b)][_0x35f11b(0x189)],_0x4df639[_0x35f11b(0x18a)]=this[_0x35f11b(0x18b)]['user'],_0x4df639[_0x35f11b(0x1ad)]={'writed':_0x4df6f8,'deleted':_0x3a2b16},_0x4df639[_0x35f11b(0x190)]=this[_0x35f11b(0x18b)]['convertToSFDX'],_0x4df639[_0x35f11b(0x1e2)]=this['repository'],_0x4df639[_0x35f11b(0x196)]=this[_0x35f11b(0x196)],_0x4df639[_0x35f11b(0x1d0)]=this[_0x35f11b(0x1d0)],_0x4df639;}async[a183_0x54a459(0x1c8)](_0x186481=![]){const _0x4c0433=a183_0x54a459;if(_0x186481)await this[_0x4c0433(0x1cb)][_0x4c0433(0x1af)](this['repositoryData'],{});else{const _0x267445=await this[_0x4c0433(0x1d4)][_0x4c0433(0x1aa)][_0x4c0433(0x1c5)](this[_0x4c0433(0x196)][_0x4c0433(0x1a1)]);this['sfLogger'][_0x4c0433(0x185)](_0x4c0433(0x1ab));const _0xda5905={[this[_0x4c0433(0x1d4)][_0x4c0433(0x1df)]]:{'lastCommit':_0x267445[_0x4c0433(0x1b3)]}};await this[_0x4c0433(0x1cb)][_0x4c0433(0x1af)](this[_0x4c0433(0x1bb)],_0xda5905);}}async[a183_0x54a459(0x1be)](){const _0x395f3e=a183_0x54a459,_0x47e8e4=await this[_0x395f3e(0x1a8)]();await this['salesforceSync'][_0x395f3e(0x193)](this[_0x395f3e(0x1bb)],_0x395f3e(0x1c0)),await this[_0x395f3e(0x1d9)][_0x395f3e(0x1a5)](_0x47e8e4,this['sfLogger']),await this[_0x395f3e(0x1c8)](),await this[_0x395f3e(0x1cb)][_0x395f3e(0x193)](this[_0x395f3e(0x1bb)],_0x395f3e(0x198));}async['handleCommitJobError'](_0x14efb8){const _0x48ceea=a183_0x54a459;try{this['sfLogger'][_0x48ceea(0x185)](_0x48ceea(0x1db)+_0x14efb8),await this[_0x48ceea(0x1c1)][_0x48ceea(0x1a7)](),await this['updateLastCommit'](!![]),await this[_0x48ceea(0x1cb)]['setStatus'](this['repositoryData'],_0x48ceea(0x1a3));}catch(_0x914c4c){this[_0x48ceea(0x191)][_0x48ceea(0x1ba)](_0x914c4c);}}async['run'](_0x117f14,_0x55813a,_0x173b69){const _0x21c9ce=a183_0x54a459;try{this['commitData']=_0x117f14,this[_0x21c9ce(0x1d0)]=_0x173b69,await this[_0x21c9ce(0x1c9)](),this[_0x21c9ce(0x1d4)]=await this['repoService'][_0x21c9ce(0x1c5)](this['repositoryData']['repositoryName']),this[_0x21c9ce(0x196)]=await this['repository']['branches']['getOne'](this[_0x21c9ce(0x1bb)][_0x21c9ce(0x1b6)]),this[_0x21c9ce(0x1c1)]=new salesforce_logger_v2_service_1[(_0x21c9ce(0x1b2))](_0x55813a[_0x21c9ce(0x18d)](),(_0x55813a[_0x21c9ce(0x19d)]()||_0x21c9ce(0x19a)+_0x173b69['toUpperCase']()+_0x21c9ce(0x1d8)+this[_0x21c9ce(0x1bb)][_0x21c9ce(0x1de)]+_0x21c9ce(0x1b8)+this[_0x21c9ce(0x1bb)][_0x21c9ce(0x1b6)]+']')+'\x20['+FlosumCommitJob_1[_0x21c9ce(0x1a1)]+']');if(!this[_0x21c9ce(0x1bb)])throw new bad_request_error_1['BadRequestError'](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this[_0x21c9ce(0x1c1)]['log'](_0x21c9ce(0x195))[_0x21c9ce(0x1a7)](),await this[_0x21c9ce(0x1be)]()[_0x21c9ce(0x1a9)](_0x230946=>this[_0x21c9ce(0x1b4)](_0x230946));}catch(_0x21a0bb){this[_0x21c9ce(0x18b)]=undefined,this[_0x21c9ce(0x191)][_0x21c9ce(0x1ba)](_0x21a0bb);throw _0x21a0bb;}}};function a183_0x4923(_0x198d9e,_0x436605){const _0x21767f=a183_0x3fc5();return a183_0x4923=function(_0x23dfde,_0xcf1a0){_0x23dfde=_0x23dfde-0x182;let _0x3fc555=_0x21767f[_0x23dfde];return _0x3fc555;},a183_0x4923(_0x198d9e,_0x436605);}FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a183_0x54a459(0x18c)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1['SalesforceService'],commit_components_job_1[a183_0x54a459(0x1bc)],salesforce_sync_service_1[a183_0x54a459(0x184)],git_provider_manager_1['GitProviderManager']])],FlosumCommitJob),exports[a183_0x54a459(0x192)]=FlosumCommitJob;