const a87_0x28b5bd=a87_0x43a6;(function(_0x5f4253,_0x696178){const _0x26bac3=a87_0x43a6,_0x52c798=_0x5f4253();while(!![]){try{const _0x1eb868=-parseInt(_0x26bac3(0xc5))/0x1*(parseInt(_0x26bac3(0xb3))/0x2)+parseInt(_0x26bac3(0xce))/0x3+-parseInt(_0x26bac3(0xc3))/0x4+-parseInt(_0x26bac3(0xbc))/0x5+-parseInt(_0x26bac3(0xda))/0x6+-parseInt(_0x26bac3(0xd7))/0x7*(parseInt(_0x26bac3(0xd3))/0x8)+parseInt(_0x26bac3(0xa4))/0x9;if(_0x1eb868===_0x696178)break;else _0x52c798['push'](_0x52c798['shift']());}catch(_0x188121){_0x52c798['push'](_0x52c798['shift']());}}}(a87_0x468e,0xdae02));const a87_0x468c50=(function(){let _0x3c6f8e=!![];return function(_0x6f45fd,_0x5baf3a){const _0x2452c5=_0x3c6f8e?function(){const _0x3b42bc=a87_0x43a6;if(_0x5baf3a){const _0x2e54c0=_0x5baf3a[_0x3b42bc(0xb5)](_0x6f45fd,arguments);return _0x5baf3a=null,_0x2e54c0;}}:function(){};return _0x3c6f8e=![],_0x2452c5;};}()),a87_0x4c2622=a87_0x468c50(this,function(){const _0xd6dc05=a87_0x43a6;return a87_0x4c2622[_0xd6dc05(0xb9)]()[_0xd6dc05(0xae)](_0xd6dc05(0xa7))[_0xd6dc05(0xb9)]()[_0xd6dc05(0xac)](a87_0x4c2622)[_0xd6dc05(0xae)](_0xd6dc05(0xa7));});a87_0x4c2622();function a87_0x468e(){const _0x2d69ac=['--jobid\x20','799eGiugY','exists','updateAccessToken','retrieveZip','/services/data/','getEntry','__importDefault','isAuthorizationError','path','5131080bDLdif','default','MAX_ZIP_SIZE','accessToken','SALESFORCE_API_VERSION','760ylBEPB','uuid','catch','base64','74795wBDJiQ','.temp/','--json\x20','6318594lXeFmF','mkdir','getData','33401565JGdqeW','defineProperty','refreshToken','(((.+)+)+)+$','AuthUtils','spawn','../../git/salesforce/utils/sfdx.utils','addFile','constructor','toBuffer','search','SFDX','src','SFDXUtils','post','2506bWABhE','../../git/internal/fs.internal','apply','BACKUP\x20ZIP','/sobjects/Attachment','createSFDXProject','toString','-u\x20','__esModule','108580lAIcCB','splitZip','ComponentsApi','../utils/auth.utils','../utils/sfdx.utils','-r\x20.temp/','instanceUrl','5736376JemGlW'];a87_0x468e=function(){return _0x2d69ac;};return a87_0x468e();}'use strict';var __importDefault=this&&this[a87_0x28b5bd(0xcb)]||function(_0x1153e9){return _0x1153e9&&_0x1153e9['__esModule']?_0x1153e9:{'default':_0x1153e9};};Object[a87_0x28b5bd(0xa5)](exports,a87_0x28b5bd(0xbb),{'value':!![]}),exports[a87_0x28b5bd(0xc8)]=void 0x0;function a87_0x43a6(_0x93a006,_0x4f2500){const _0x2e02ba=a87_0x468e();return a87_0x43a6=function(_0x4c2622,_0x468c50){_0x4c2622=_0x4c2622-0xa2;let _0x468ee8=_0x2e02ba[_0x4c2622];return _0x468ee8;},a87_0x43a6(_0x93a006,_0x4f2500);}const constants_1=require('../../../constants'),promises_1=require('fs/promises'),sfdx_utils_1=require(a87_0x28b5bd(0xaa)),fs_internal_1=require(a87_0x28b5bd(0xb4)),sfdx_utils_2=require(a87_0x28b5bd(0xc0)),auth_utils_1=require(a87_0x28b5bd(0xbf)),adm_zip_1=__importDefault(require('adm-zip')),uuid_1=require(a87_0x28b5bd(0xd4)),components_api_1=require('../utils/components-api'),path_1=require(a87_0x28b5bd(0xcd));async function retrieveZip({backupAsyncId:_0xc93fd6,credentials:_0x16d8af,metadataLogId:_0x2ed4ed},_0x3272bc){const _0x3367e1=a87_0x28b5bd;var _0x3566ab;const _0x4e25bc=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x3367e1(0xc6)]('.temp/'+_0x4e25bc)&&await(0x0,promises_1[_0x3367e1(0xa2)])(_0x3367e1(0xd8)+_0x4e25bc,{'recursive':!![]});await sfdx_utils_2[_0x3367e1(0xb1)][_0x3367e1(0xb8)](_0xc93fd6,_0x4e25bc),await sfdx_utils_2[_0x3367e1(0xb1)]['setInstanceUrl'](_0x16d8af[_0x3367e1(0xc2)],_0xc93fd6,_0x4e25bc),await retrieveReport(_0xc93fd6,_0x16d8af,_0x4e25bc);const _0x2b74bf=new adm_zip_1[(_0x3367e1(0xcf))](await(0x0,promises_1['readFile'])(_0x3367e1(0xd8)+_0x4e25bc+'/'+_0xc93fd6+'/unpackaged.zip')),_0x380a94=new adm_zip_1[(_0x3367e1(0xcf))]();for(const {entryName:_0xb0cfca}of _0x2b74bf['getEntries']()){const _0x11139f=(_0x3566ab=_0x2b74bf[_0x3367e1(0xca)](_0xb0cfca))===null||_0x3566ab===void 0x0?void 0x0:_0x3566ab[_0x3367e1(0xa3)]();_0x380a94[_0x3367e1(0xab)]((0x0,path_1['join'])(_0x3367e1(0xb0),_0xb0cfca),_0x11139f);}const _0x5105e0=_0x380a94[_0x3367e1(0xad)]()[_0x3367e1(0xb9)](_0x3367e1(0xd6))['length'];if(_0x5105e0>=components_api_1[_0x3367e1(0xd0)]){const [_0x2ca6ec,_0x6dde56]=await components_api_1[_0x3367e1(0xbe)][_0x3367e1(0xbd)](_0x380a94,_0x5105e0),_0x37f3b7={'ParentId':_0x2ed4ed,'Name':_0x3367e1(0xb6),'Description':_0x3367e1(0xb6),'Body':_0x2ca6ec['toBuffer']()[_0x3367e1(0xb9)](_0x3367e1(0xd6))};await _0x3272bc['post'](_0x3367e1(0xc9)+constants_1[_0x3367e1(0xd2)]+_0x3367e1(0xb7),_0x37f3b7),_0x37f3b7['Body']=_0x6dde56[_0x3367e1(0xad)]()[_0x3367e1(0xb9)](_0x3367e1(0xd6)),await _0x3272bc[_0x3367e1(0xb2)](_0x3367e1(0xc9)+constants_1[_0x3367e1(0xd2)]+_0x3367e1(0xb7),_0x37f3b7);}else{const _0xc74ed2={'ParentId':_0x2ed4ed,'Name':_0x3367e1(0xb6),'Description':_0x3367e1(0xb6),'Body':_0x380a94[_0x3367e1(0xad)]()[_0x3367e1(0xb9)](_0x3367e1(0xd6))};await _0x3272bc['post'](_0x3367e1(0xc9)+constants_1[_0x3367e1(0xd2)]+_0x3367e1(0xb7),_0xc74ed2);}}catch(_0x49cc6c){throw _0x49cc6c;}finally{await(0x0,promises_1['rm'])('.temp/'+_0x4e25bc+'/'+_0xc93fd6,{'recursive':!![]});}}exports[a87_0x28b5bd(0xc8)]=retrieveZip;async function retrieveReport(_0x11a912,_0x54244d,_0x34e47d){const _0x5d06a0=a87_0x28b5bd,_0x3951a7='force:mdapi:retrieve:report\x20'+_0x5d06a0(0xd9)+(_0x5d06a0(0xc4)+_0x11a912+'\x20')+(_0x5d06a0(0xc1)+_0x34e47d+'/'+_0x11a912+'\x20')+(_0x5d06a0(0xba)+_0x54244d['accessToken']);await sfdx_utils_1[_0x5d06a0(0xaf)][_0x5d06a0(0xa9)](_0x3951a7)[_0x5d06a0(0xd5)](async _0x4d0f91=>{const _0x3742e9=_0x5d06a0;if(sfdx_utils_2[_0x3742e9(0xb1)][_0x3742e9(0xcc)](_0x4d0f91))return _0x54244d[_0x3742e9(0xd1)]=await auth_utils_1[_0x3742e9(0xa8)][_0x3742e9(0xc7)](_0x54244d[_0x3742e9(0xc2)],_0x54244d[_0x3742e9(0xa6)],_0x54244d['clientId'],_0x54244d['clientSecret']),retrieveReport(_0x11a912,_0x54244d,_0x34e47d);throw _0x4d0f91;});}