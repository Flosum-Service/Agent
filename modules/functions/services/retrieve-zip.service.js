const a87_0x58db84=a87_0x14ee;(function(_0x4991aa,_0x38a98d){const _0x35baaf=a87_0x14ee,_0x44ad84=_0x4991aa();while(!![]){try{const _0x26b3fd=-parseInt(_0x35baaf(0x187))/0x1+-parseInt(_0x35baaf(0x172))/0x2+-parseInt(_0x35baaf(0x159))/0x3*(-parseInt(_0x35baaf(0x15c))/0x4)+parseInt(_0x35baaf(0x186))/0x5+parseInt(_0x35baaf(0x171))/0x6+-parseInt(_0x35baaf(0x157))/0x7+-parseInt(_0x35baaf(0x15a))/0x8*(-parseInt(_0x35baaf(0x161))/0x9);if(_0x26b3fd===_0x38a98d)break;else _0x44ad84['push'](_0x44ad84['shift']());}catch(_0x31bf01){_0x44ad84['push'](_0x44ad84['shift']());}}}(a87_0x4625,0xbf353));const a87_0x330fef=(function(){let _0x25fbc0=!![];return function(_0x27f44a,_0x35dcb6){const _0x2fa9c6=_0x25fbc0?function(){const _0x3cc75a=a87_0x14ee;if(_0x35dcb6){const _0x1f97c3=_0x35dcb6[_0x3cc75a(0x153)](_0x27f44a,arguments);return _0x35dcb6=null,_0x1f97c3;}}:function(){};return _0x25fbc0=![],_0x2fa9c6;};}()),a87_0x14ab7e=a87_0x330fef(this,function(){const _0x4d5a42=a87_0x14ee;return a87_0x14ab7e[_0x4d5a42(0x166)]()['search'](_0x4d5a42(0x163))['toString']()[_0x4d5a42(0x164)](a87_0x14ab7e)['search'](_0x4d5a42(0x163));});a87_0x14ab7e();'use strict';var __importDefault=this&&this[a87_0x58db84(0x179)]||function(_0x2a3c1e){const _0x24b4e1=a87_0x58db84;return _0x2a3c1e&&_0x2a3c1e[_0x24b4e1(0x16a)]?_0x2a3c1e:{'default':_0x2a3c1e};};Object[a87_0x58db84(0x183)](exports,a87_0x58db84(0x16a),{'value':!![]}),exports['retrieveZip']=void 0x0;const constants_1=require(a87_0x58db84(0x16d)),promises_1=require('fs/promises'),sfdx_utils_1=require('../../git/salesforce/utils/sfdx.utils'),fs_internal_1=require(a87_0x58db84(0x15d)),sfdx_utils_2=require(a87_0x58db84(0x173)),auth_utils_1=require('../utils/auth.utils'),adm_zip_1=__importDefault(require(a87_0x58db84(0x15b))),uuid_1=require(a87_0x58db84(0x182)),components_api_1=require(a87_0x58db84(0x175)),path_1=require(a87_0x58db84(0x184));async function retrieveZip({backupAsyncId:_0x5e823b,credentials:_0x444e66,metadataLogId:_0x456723},_0xd52682){const _0x3d6cf5=a87_0x58db84;var _0x281b3c;const _0x4151dd=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS']['exists']('.temp/'+_0x4151dd)&&await(0x0,promises_1[_0x3d6cf5(0x156)])(_0x3d6cf5(0x178)+_0x4151dd,{'recursive':!![]});await sfdx_utils_2['SFDXUtils']['createSFDXProject'](_0x5e823b,_0x4151dd),await sfdx_utils_2['SFDXUtils'][_0x3d6cf5(0x16f)](_0x444e66[_0x3d6cf5(0x15e)],_0x5e823b,_0x4151dd),await retrieveReport(_0x5e823b,_0x444e66,_0x4151dd);const _0x2d7913=new adm_zip_1[(_0x3d6cf5(0x174))](await(0x0,promises_1[_0x3d6cf5(0x17c)])('.temp/'+_0x4151dd+'/'+_0x5e823b+'/unpackaged.zip')),_0x9cb2fe=new adm_zip_1['default']();for(const {entryName:_0x2c62c6}of _0x2d7913['getEntries']()){const _0x23636d=(_0x281b3c=_0x2d7913[_0x3d6cf5(0x167)](_0x2c62c6))===null||_0x281b3c===void 0x0?void 0x0:_0x281b3c[_0x3d6cf5(0x180)]();_0x9cb2fe[_0x3d6cf5(0x16c)]((0x0,path_1['join'])(_0x3d6cf5(0x160),_0x2c62c6),_0x23636d);}const _0x21fe3f=_0x9cb2fe[_0x3d6cf5(0x16e)]()[_0x3d6cf5(0x166)](_0x3d6cf5(0x188))['length'];if(_0x21fe3f>=components_api_1[_0x3d6cf5(0x17a)]){const [_0x253935,_0x3f3aa3]=await components_api_1[_0x3d6cf5(0x155)]['splitZip'](_0x9cb2fe,_0x21fe3f),_0x14fae5={'ParentId':_0x456723,'Name':_0x3d6cf5(0x168),'Description':_0x3d6cf5(0x168),'Body':_0x253935['toBuffer']()[_0x3d6cf5(0x166)](_0x3d6cf5(0x188))};await _0xd52682['post'](_0x3d6cf5(0x169)+constants_1[_0x3d6cf5(0x181)]+_0x3d6cf5(0x17f),_0x14fae5),_0x14fae5[_0x3d6cf5(0x151)]=_0x3f3aa3[_0x3d6cf5(0x16e)]()['toString'](_0x3d6cf5(0x188)),await _0xd52682['post'](_0x3d6cf5(0x169)+constants_1[_0x3d6cf5(0x181)]+'/sobjects/Attachment',_0x14fae5);}else{const _0x1e5d31={'ParentId':_0x456723,'Name':_0x3d6cf5(0x168),'Description':_0x3d6cf5(0x168),'Body':_0x9cb2fe[_0x3d6cf5(0x16e)]()[_0x3d6cf5(0x166)](_0x3d6cf5(0x188))};await _0xd52682['post'](_0x3d6cf5(0x169)+constants_1[_0x3d6cf5(0x181)]+_0x3d6cf5(0x17f),_0x1e5d31);}}catch(_0x5dbace){throw _0x5dbace;}finally{await(0x0,promises_1['rm'])(_0x3d6cf5(0x178)+_0x4151dd+'/'+_0x5e823b,{'recursive':!![]});}}function a87_0x4625(){const _0x5e05ea=['9EcCthH','catch','(((.+)+)+)+$','constructor','clientId','toString','getEntry','BACKUP\x20ZIP','/services/data/','__esModule','accessToken','addFile','../../../constants','toBuffer','setInstanceUrl','isAuthorizationError','5779146oUMTFf','89810fsFcZh','../utils/sfdx.utils','default','../utils/components-api','AuthUtils','-r\x20.temp/','.temp/','__importDefault','MAX_ZIP_SIZE','force:mdapi:retrieve:report\x20','readFile','refreshToken','--jobid\x20','/sobjects/Attachment','getData','SALESFORCE_API_VERSION','uuid','defineProperty','path','spawnPromise','1356005kfRMJh','528119QkCWwT','base64','Body','updateAccessToken','apply','clientSecret','ComponentsApi','mkdir','7453523earamY','SFDXUtils','4839eddwvX','7363704zNkBNi','adm-zip','660yWZSwT','../../git/internal/fs.internal','instanceUrl','SFDX','src'];a87_0x4625=function(){return _0x5e05ea;};return a87_0x4625();}exports['retrieveZip']=retrieveZip;function a87_0x14ee(_0xb76972,_0x5e49eb){const _0x542efc=a87_0x4625();return a87_0x14ee=function(_0x14ab7e,_0x330fef){_0x14ab7e=_0x14ab7e-0x151;let _0x4625a2=_0x542efc[_0x14ab7e];return _0x4625a2;},a87_0x14ee(_0xb76972,_0x5e49eb);}async function retrieveReport(_0x24be2e,_0x504845,_0x4d0055){const _0x325de3=a87_0x58db84,_0x3da720=_0x325de3(0x17b)+'--json\x20'+(_0x325de3(0x17e)+_0x24be2e+'\x20')+(_0x325de3(0x177)+_0x4d0055+'/'+_0x24be2e+'\x20')+('-u\x20'+_0x504845[_0x325de3(0x16b)]);await sfdx_utils_1[_0x325de3(0x15f)][_0x325de3(0x185)]('sfdx',_0x3da720)[_0x325de3(0x162)](async _0x5852ee=>{const _0x2014d0=_0x325de3;if(sfdx_utils_2[_0x2014d0(0x158)][_0x2014d0(0x170)](_0x5852ee))return _0x504845['accessToken']=await auth_utils_1[_0x2014d0(0x176)][_0x2014d0(0x152)](_0x504845[_0x2014d0(0x15e)],_0x504845[_0x2014d0(0x17d)],_0x504845[_0x2014d0(0x165)],_0x504845[_0x2014d0(0x154)]),retrieveReport(_0x24be2e,_0x504845,_0x4d0055);throw _0x5852ee;});}