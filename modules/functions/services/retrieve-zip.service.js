const a87_0x159e48=a87_0x1de2;(function(_0x508440,_0x19c374){const _0x15107d=a87_0x1de2,_0x420375=_0x508440();while(!![]){try{const _0xaf71c8=-parseInt(_0x15107d(0x1d1))/0x1+-parseInt(_0x15107d(0x1e9))/0x2*(-parseInt(_0x15107d(0x1e6))/0x3)+-parseInt(_0x15107d(0x1ea))/0x4+parseInt(_0x15107d(0x1eb))/0x5*(-parseInt(_0x15107d(0x1fc))/0x6)+-parseInt(_0x15107d(0x1ed))/0x7*(-parseInt(_0x15107d(0x1e8))/0x8)+-parseInt(_0x15107d(0x1f2))/0x9+parseInt(_0x15107d(0x1e3))/0xa;if(_0xaf71c8===_0x19c374)break;else _0x420375['push'](_0x420375['shift']());}catch(_0x173978){_0x420375['push'](_0x420375['shift']());}}}(a87_0x533f,0x2bbbe));const a87_0x1e70d5=(function(){let _0x38765e=!![];return function(_0x23b5ff,_0x2d53da){const _0x5c17c5=_0x38765e?function(){const _0x4ee7ab=a87_0x1de2;if(_0x2d53da){const _0x357bb9=_0x2d53da[_0x4ee7ab(0x1c9)](_0x23b5ff,arguments);return _0x2d53da=null,_0x357bb9;}}:function(){};return _0x38765e=![],_0x5c17c5;};}()),a87_0x306dac=a87_0x1e70d5(this,function(){const _0x20e312=a87_0x1de2;return a87_0x306dac[_0x20e312(0x204)]()[_0x20e312(0x1e7)](_0x20e312(0x1cf))[_0x20e312(0x204)]()[_0x20e312(0x1ff)](a87_0x306dac)['search'](_0x20e312(0x1cf));});a87_0x306dac();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x532577){return _0x532577&&_0x532577['__esModule']?_0x532577:{'default':_0x532577};};function a87_0x1de2(_0x192be6,_0x4b5a40){const _0x83b334=a87_0x533f();return a87_0x1de2=function(_0x306dac,_0x1e70d5){_0x306dac=_0x306dac-0x1c9;let _0x533f01=_0x83b334[_0x306dac];return _0x533f01;},a87_0x1de2(_0x192be6,_0x4b5a40);}Object[a87_0x159e48(0x1d9)](exports,a87_0x159e48(0x1cb),{'value':!![]}),exports[a87_0x159e48(0x1cc)]=void 0x0;const constants_1=require('../../../constants'),promises_1=require(a87_0x159e48(0x1ee)),sfdx_utils_1=require(a87_0x159e48(0x1fd)),fs_internal_1=require(a87_0x159e48(0x1ef)),sfdx_utils_2=require(a87_0x159e48(0x1d4)),auth_utils_1=require('../utils/auth.utils'),adm_zip_1=__importDefault(require(a87_0x159e48(0x1f3))),uuid_1=require(a87_0x159e48(0x1f6)),components_api_1=require(a87_0x159e48(0x200)),path_1=require(a87_0x159e48(0x1f8));function a87_0x533f(){const _0x291863=['../utils/components-api','length','getData','/sobjects/Attachment','toString','apply','exists','__esModule','retrieveZip','splitZip','src','(((.+)+)+)+$','Body','70480pSxCBR','AuthUtils','base64','../utils/sfdx.utils','toBuffer','ComponentsApi','spawnPromise','instanceUrl','defineProperty','MAX_ZIP_SIZE','/services/data/','default','post','--json\x20','-u\x20','/unpackaged.zip','refreshToken','accessToken','1131000HYcoIb','clientSecret','getEntry','6ePIWoJ','search','8IwUWYy','181822fDRLDx','412824FArLlZ','5NTfRjE','-r\x20.temp/','2252201xzVMGL','fs/promises','../../git/internal/fs.internal','.temp/','SFDXUtils','1740474CwXYaI','adm-zip','SFDX','sfdx','uuid','SALESFORCE_API_VERSION','path','BACKUP\x20ZIP','--jobid\x20','setInstanceUrl','422754ucaQoX','../../git/salesforce/utils/sfdx.utils','mkdir','constructor'];a87_0x533f=function(){return _0x291863;};return a87_0x533f();}async function retrieveZip({backupAsyncId:_0x18e970,credentials:_0x3dfb94,metadataLogId:_0x58ddfa},_0x48fb85){const _0x4ba5a6=a87_0x159e48;var _0x14b3c2;const _0x24179e=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x4ba5a6(0x1ca)](_0x4ba5a6(0x1f0)+_0x24179e)&&await(0x0,promises_1[_0x4ba5a6(0x1fe)])('.temp/'+_0x24179e,{'recursive':!![]});await sfdx_utils_2['SFDXUtils']['createSFDXProject'](_0x18e970,_0x24179e),await sfdx_utils_2[_0x4ba5a6(0x1f1)][_0x4ba5a6(0x1fb)](_0x3dfb94['instanceUrl'],_0x18e970,_0x24179e),await retrieveReport(_0x18e970,_0x3dfb94,_0x24179e);const _0x71029f=new adm_zip_1[(_0x4ba5a6(0x1dc))](await(0x0,promises_1['readFile'])(_0x4ba5a6(0x1f0)+_0x24179e+'/'+_0x18e970+_0x4ba5a6(0x1e0))),_0x5c51d8=new adm_zip_1['default']();for(const {entryName:_0x18d1ba}of _0x71029f['getEntries']()){const _0x5d69af=(_0x14b3c2=_0x71029f[_0x4ba5a6(0x1e5)](_0x18d1ba))===null||_0x14b3c2===void 0x0?void 0x0:_0x14b3c2[_0x4ba5a6(0x202)]();_0x5c51d8['addFile']((0x0,path_1['join'])(_0x4ba5a6(0x1ce),_0x18d1ba),_0x5d69af);}const _0x74c1a1=_0x5c51d8['toBuffer']()[_0x4ba5a6(0x204)](_0x4ba5a6(0x1d3))[_0x4ba5a6(0x201)];if(_0x74c1a1>=components_api_1[_0x4ba5a6(0x1da)]){const [_0x1cd957,_0x2061be]=await components_api_1[_0x4ba5a6(0x1d6)][_0x4ba5a6(0x1cd)](_0x5c51d8,_0x74c1a1),_0x396dbc={'ParentId':_0x58ddfa,'Name':_0x4ba5a6(0x1f9),'Description':'BACKUP\x20ZIP','Body':_0x1cd957[_0x4ba5a6(0x1d5)]()['toString'](_0x4ba5a6(0x1d3))};await _0x48fb85['post'](_0x4ba5a6(0x1db)+constants_1[_0x4ba5a6(0x1f7)]+_0x4ba5a6(0x203),_0x396dbc),_0x396dbc[_0x4ba5a6(0x1d0)]=_0x2061be[_0x4ba5a6(0x1d5)]()[_0x4ba5a6(0x204)]('base64'),await _0x48fb85[_0x4ba5a6(0x1dd)](_0x4ba5a6(0x1db)+constants_1['SALESFORCE_API_VERSION']+_0x4ba5a6(0x203),_0x396dbc);}else{const _0x50b7cb={'ParentId':_0x58ddfa,'Name':_0x4ba5a6(0x1f9),'Description':_0x4ba5a6(0x1f9),'Body':_0x5c51d8[_0x4ba5a6(0x1d5)]()[_0x4ba5a6(0x204)](_0x4ba5a6(0x1d3))};await _0x48fb85['post']('/services/data/'+constants_1[_0x4ba5a6(0x1f7)]+_0x4ba5a6(0x203),_0x50b7cb);}}catch(_0x12cb48){throw _0x12cb48;}finally{await(0x0,promises_1['rm'])(_0x4ba5a6(0x1f0)+_0x24179e+'/'+_0x18e970,{'recursive':!![]});}}exports[a87_0x159e48(0x1cc)]=retrieveZip;async function retrieveReport(_0x4903a6,_0x330254,_0x42c3f7){const _0x32c7c6=a87_0x159e48,_0x3d039a='force:mdapi:retrieve:report\x20'+_0x32c7c6(0x1de)+(_0x32c7c6(0x1fa)+_0x4903a6+'\x20')+(_0x32c7c6(0x1ec)+_0x42c3f7+'/'+_0x4903a6+'\x20')+(_0x32c7c6(0x1df)+_0x330254[_0x32c7c6(0x1e2)]);await sfdx_utils_1[_0x32c7c6(0x1f4)][_0x32c7c6(0x1d7)](_0x32c7c6(0x1f5),_0x3d039a)['catch'](async _0x4ef3ad=>{const _0x6babdc=_0x32c7c6;if(sfdx_utils_2[_0x6babdc(0x1f1)]['isAuthorizationError'](_0x4ef3ad))return _0x330254[_0x6babdc(0x1e2)]=await auth_utils_1[_0x6babdc(0x1d2)]['updateAccessToken'](_0x330254[_0x6babdc(0x1d8)],_0x330254[_0x6babdc(0x1e1)],_0x330254['clientId'],_0x330254[_0x6babdc(0x1e4)]),retrieveReport(_0x4903a6,_0x330254,_0x42c3f7);throw _0x4ef3ad;});}