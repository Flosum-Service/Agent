const a87_0x27e67d=a87_0x1de0;(function(_0x4950bc,_0x839c43){const _0x538c40=a87_0x1de0,_0x3d88d9=_0x4950bc();while(!![]){try{const _0x2ce52c=parseInt(_0x538c40(0x1fa))/0x1+-parseInt(_0x538c40(0x217))/0x2*(parseInt(_0x538c40(0x211))/0x3)+parseInt(_0x538c40(0x1fe))/0x4+parseInt(_0x538c40(0x1ef))/0x5+-parseInt(_0x538c40(0x1e9))/0x6+-parseInt(_0x538c40(0x1ec))/0x7+parseInt(_0x538c40(0x21c))/0x8;if(_0x2ce52c===_0x839c43)break;else _0x3d88d9['push'](_0x3d88d9['shift']());}catch(_0x4ce29d){_0x3d88d9['push'](_0x3d88d9['shift']());}}}(a87_0x52f5,0x19a25));const a87_0x5b3a93=(function(){let _0x26ea96=!![];return function(_0x5f970e,_0x49a62e){const _0x41525e=_0x26ea96?function(){const _0x1612c1=a87_0x1de0;if(_0x49a62e){const _0x1143d5=_0x49a62e[_0x1612c1(0x1e7)](_0x5f970e,arguments);return _0x49a62e=null,_0x1143d5;}}:function(){};return _0x26ea96=![],_0x41525e;};}()),a87_0x9085ad=a87_0x5b3a93(this,function(){const _0x365dc9=a87_0x1de0;return a87_0x9085ad[_0x365dc9(0x203)]()[_0x365dc9(0x20c)](_0x365dc9(0x215))[_0x365dc9(0x203)]()[_0x365dc9(0x206)](a87_0x9085ad)[_0x365dc9(0x20c)](_0x365dc9(0x215));});function a87_0x52f5(){const _0x9264fd=['catch','1174894tQdVhA','fs/promises','../../git/internal/fs.internal','323960UwzUjA','SFDXUtils','spawnPromise','getEntries','/unpackaged.zip','post','updateAccessToken','-u\x20','clientSecret','toBuffer','setInstanceUrl','36756CQUhNz','mkdir','readFile','base64','371064NLLSFc','../../../constants','/services/data/','adm-zip','/sobjects/Attachment','toString','join','uuid','constructor','SALESFORCE_API_VERSION','length','addFile','__importDefault','refreshToken','search','exists','../../git/salesforce/utils/sfdx.utils','ComponentsApi','sfdx','69tgUKUQ','accessToken','.temp/','BACKUP\x20ZIP','(((.+)+)+)+$','__esModule','4362ZPtpoy','../utils/sfdx.utils','retrieveZip','getEntry','splitZip','1303424izFiLx','default','MAX_ZIP_SIZE','apply','clientId','205440jWLFOJ','isAuthorizationError'];a87_0x52f5=function(){return _0x9264fd;};return a87_0x52f5();}a87_0x9085ad();function a87_0x1de0(_0x4496e0,_0x241b88){const _0x598075=a87_0x52f5();return a87_0x1de0=function(_0x9085ad,_0x5b3a93){_0x9085ad=_0x9085ad-0x1e6;let _0x52f5f5=_0x598075[_0x9085ad];return _0x52f5f5;},a87_0x1de0(_0x4496e0,_0x241b88);}'use strict';var __importDefault=this&&this[a87_0x27e67d(0x20a)]||function(_0x2abce3){const _0xebf40b=a87_0x27e67d;return _0x2abce3&&_0x2abce3[_0xebf40b(0x216)]?_0x2abce3:{'default':_0x2abce3};};Object['defineProperty'](exports,a87_0x27e67d(0x216),{'value':!![]}),exports[a87_0x27e67d(0x219)]=void 0x0;const constants_1=require(a87_0x27e67d(0x1ff)),promises_1=require(a87_0x27e67d(0x1ed)),sfdx_utils_1=require(a87_0x27e67d(0x20e)),fs_internal_1=require(a87_0x27e67d(0x1ee)),sfdx_utils_2=require(a87_0x27e67d(0x218)),auth_utils_1=require('../utils/auth.utils'),adm_zip_1=__importDefault(require(a87_0x27e67d(0x201))),uuid_1=require(a87_0x27e67d(0x205)),components_api_1=require('../utils/components-api'),path_1=require('path');async function retrieveZip({backupAsyncId:_0x3be798,credentials:_0x5428c4,metadataLogId:_0x64b223},_0x586cd4){const _0x1707e7=a87_0x27e67d;var _0x3096b7;const _0x4bf8fa=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x1707e7(0x20d)](_0x1707e7(0x213)+_0x4bf8fa)&&await(0x0,promises_1[_0x1707e7(0x1fb)])(_0x1707e7(0x213)+_0x4bf8fa,{'recursive':!![]});await sfdx_utils_2['SFDXUtils']['createSFDXProject'](_0x3be798,_0x4bf8fa),await sfdx_utils_2[_0x1707e7(0x1f0)][_0x1707e7(0x1f9)](_0x5428c4['instanceUrl'],_0x3be798,_0x4bf8fa),await retrieveReport(_0x3be798,_0x5428c4,_0x4bf8fa);const _0x6b5faa=new adm_zip_1[(_0x1707e7(0x21d))](await(0x0,promises_1[_0x1707e7(0x1fc)])('.temp/'+_0x4bf8fa+'/'+_0x3be798+_0x1707e7(0x1f3))),_0x329b00=new adm_zip_1[(_0x1707e7(0x21d))]();for(const {entryName:_0x544df0}of _0x6b5faa[_0x1707e7(0x1f2)]()){const _0x1c9255=(_0x3096b7=_0x6b5faa[_0x1707e7(0x21a)](_0x544df0))===null||_0x3096b7===void 0x0?void 0x0:_0x3096b7['getData']();_0x329b00[_0x1707e7(0x209)]((0x0,path_1[_0x1707e7(0x204)])('src',_0x544df0),_0x1c9255);}const _0x506fd1=_0x329b00[_0x1707e7(0x1f8)]()[_0x1707e7(0x203)](_0x1707e7(0x1fd))[_0x1707e7(0x208)];if(_0x506fd1>=components_api_1[_0x1707e7(0x1e6)]){const [_0x5d932e,_0xdeac02]=await components_api_1[_0x1707e7(0x20f)][_0x1707e7(0x21b)](_0x329b00,_0x506fd1),_0xc4b46f={'ParentId':_0x64b223,'Name':'BACKUP\x20ZIP','Description':'BACKUP\x20ZIP','Body':_0x5d932e['toBuffer']()[_0x1707e7(0x203)]('base64')};await _0x586cd4[_0x1707e7(0x1f4)](_0x1707e7(0x200)+constants_1[_0x1707e7(0x207)]+'/sobjects/Attachment',_0xc4b46f),_0xc4b46f['Body']=_0xdeac02[_0x1707e7(0x1f8)]()['toString'](_0x1707e7(0x1fd)),await _0x586cd4[_0x1707e7(0x1f4)]('/services/data/'+constants_1['SALESFORCE_API_VERSION']+_0x1707e7(0x202),_0xc4b46f);}else{const _0x3fd6a3={'ParentId':_0x64b223,'Name':_0x1707e7(0x214),'Description':_0x1707e7(0x214),'Body':_0x329b00[_0x1707e7(0x1f8)]()[_0x1707e7(0x203)](_0x1707e7(0x1fd))};await _0x586cd4[_0x1707e7(0x1f4)](_0x1707e7(0x200)+constants_1[_0x1707e7(0x207)]+_0x1707e7(0x202),_0x3fd6a3);}}catch(_0x3f1adf){throw _0x3f1adf;}finally{await(0x0,promises_1['rm'])(_0x1707e7(0x213)+_0x4bf8fa+'/'+_0x3be798,{'recursive':!![]});}}exports['retrieveZip']=retrieveZip;async function retrieveReport(_0x2835ca,_0x5d5aec,_0x50e4e2){const _0x197e35=a87_0x27e67d,_0x45de5d='force:mdapi:retrieve:report\x20'+'--json\x20'+('--jobid\x20'+_0x2835ca+'\x20')+('-r\x20.temp/'+_0x50e4e2+'/'+_0x2835ca+'\x20')+(_0x197e35(0x1f6)+_0x5d5aec[_0x197e35(0x212)]);await sfdx_utils_1['SFDX'][_0x197e35(0x1f1)](_0x197e35(0x210),_0x45de5d)[_0x197e35(0x1eb)](async _0xf69a56=>{const _0x5aaf30=_0x197e35;if(sfdx_utils_2[_0x5aaf30(0x1f0)][_0x5aaf30(0x1ea)](_0xf69a56))return _0x5d5aec['accessToken']=await auth_utils_1['AuthUtils'][_0x5aaf30(0x1f5)](_0x5d5aec['instanceUrl'],_0x5d5aec[_0x5aaf30(0x20b)],_0x5d5aec[_0x5aaf30(0x1e8)],_0x5d5aec[_0x5aaf30(0x1f7)]),retrieveReport(_0x2835ca,_0x5d5aec,_0x50e4e2);throw _0xf69a56;});}