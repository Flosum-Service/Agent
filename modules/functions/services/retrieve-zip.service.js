const a87_0x3b0d40=a87_0x440b;(function(_0x509569,_0x1cfe14){const _0x47b1a1=a87_0x440b,_0xa9a1e6=_0x509569();while(!![]){try{const _0x1abe5f=parseInt(_0x47b1a1(0x9e))/0x1+-parseInt(_0x47b1a1(0xa9))/0x2*(parseInt(_0x47b1a1(0x9b))/0x3)+parseInt(_0x47b1a1(0xd2))/0x4+parseInt(_0x47b1a1(0x9f))/0x5*(parseInt(_0x47b1a1(0x9d))/0x6)+-parseInt(_0x47b1a1(0xd9))/0x7*(parseInt(_0x47b1a1(0xbe))/0x8)+parseInt(_0x47b1a1(0xa2))/0x9*(parseInt(_0x47b1a1(0xc6))/0xa)+-parseInt(_0x47b1a1(0xcf))/0xb;if(_0x1abe5f===_0x1cfe14)break;else _0xa9a1e6['push'](_0xa9a1e6['shift']());}catch(_0xb07df5){_0xa9a1e6['push'](_0xa9a1e6['shift']());}}}(a87_0x37e2,0x91506));function a87_0x37e2(){const _0x3866e0=['getEntries','ComponentsApi','accessToken','search','toString','14eQuuGA','SALESFORCE_API_VERSION','27RQxLvh','uuid','1981326tftPAK','1103355eoqlPO','5iWTsPx','../../../constants','clientSecret','657UcEryB','__importDefault','.temp/','../utils/components-api','catch','-r\x20.temp/','force:mdapi:retrieve:report\x20','256426vfqTRO','Body','/services/data/','splitZip','MAX_ZIP_SIZE','src','path','../../git/internal/fs.internal','exists','refreshToken','setInstanceUrl','readFile','base64','../utils/auth.utils','retrieveZip','/sobjects/Attachment','__esModule','spawnPromise','mkdir','constructor','clientId','2505992mVUXLy','join','default','BACKUP\x20ZIP','../utils/sfdx.utils','getEntry','--json\x20','length','151730WSZRgj','--jobid\x20','SFDXUtils','apply','updateAccessToken','toBuffer','SFDX','AuthUtils','instanceUrl','8799153wmbNVN','addFile','getData','2537356yHcDwA','post'];a87_0x37e2=function(){return _0x3866e0;};return a87_0x37e2();}function a87_0x440b(_0x5d6913,_0x13f6c4){const _0x5e567d=a87_0x37e2();return a87_0x440b=function(_0x45ba66,_0x25304e){_0x45ba66=_0x45ba66-0x9a;let _0x37e26b=_0x5e567d[_0x45ba66];return _0x37e26b;},a87_0x440b(_0x5d6913,_0x13f6c4);}const a87_0x25304e=(function(){let _0x25382c=!![];return function(_0x51eb05,_0x11af67){const _0x4cca23=_0x25382c?function(){const _0x19a1bd=a87_0x440b;if(_0x11af67){const _0x2919d4=_0x11af67[_0x19a1bd(0xc9)](_0x51eb05,arguments);return _0x11af67=null,_0x2919d4;}}:function(){};return _0x25382c=![],_0x4cca23;};}()),a87_0x45ba66=a87_0x25304e(this,function(){const _0x5cc907=a87_0x440b;return a87_0x45ba66['toString']()[_0x5cc907(0xd7)]('(((.+)+)+)+$')[_0x5cc907(0xd8)]()[_0x5cc907(0xbc)](a87_0x45ba66)[_0x5cc907(0xd7)]('(((.+)+)+)+$');});a87_0x45ba66();'use strict';var __importDefault=this&&this[a87_0x3b0d40(0xa3)]||function(_0x4519a2){const _0x3124e3=a87_0x3b0d40;return _0x4519a2&&_0x4519a2[_0x3124e3(0xb9)]?_0x4519a2:{'default':_0x4519a2};};Object['defineProperty'](exports,a87_0x3b0d40(0xb9),{'value':!![]}),exports[a87_0x3b0d40(0xb7)]=void 0x0;const constants_1=require(a87_0x3b0d40(0xa0)),promises_1=require('fs/promises'),sfdx_utils_1=require('../../git/salesforce/utils/sfdx.utils'),fs_internal_1=require(a87_0x3b0d40(0xb0)),sfdx_utils_2=require(a87_0x3b0d40(0xc2)),auth_utils_1=require(a87_0x3b0d40(0xb6)),adm_zip_1=__importDefault(require('adm-zip')),uuid_1=require(a87_0x3b0d40(0x9c)),components_api_1=require(a87_0x3b0d40(0xa5)),path_1=require(a87_0x3b0d40(0xaf));async function retrieveZip({backupAsyncId:_0x4d688f,credentials:_0x48fb66,metadataLogId:_0x5f7a1b},_0x3932ef){const _0x5829c8=a87_0x3b0d40;var _0x2ea985;const _0x247493=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x5829c8(0xb1)]('.temp/'+_0x247493)&&await(0x0,promises_1[_0x5829c8(0xbb)])(_0x5829c8(0xa4)+_0x247493,{'recursive':!![]});await sfdx_utils_2['SFDXUtils']['createSFDXProject'](_0x4d688f,_0x247493),await sfdx_utils_2['SFDXUtils'][_0x5829c8(0xb3)](_0x48fb66[_0x5829c8(0xce)],_0x4d688f,_0x247493),await retrieveReport(_0x4d688f,_0x48fb66,_0x247493);const _0x2681e9=new adm_zip_1[(_0x5829c8(0xc0))](await(0x0,promises_1[_0x5829c8(0xb4)])(_0x5829c8(0xa4)+_0x247493+'/'+_0x4d688f+'/unpackaged.zip')),_0x140717=new adm_zip_1[(_0x5829c8(0xc0))]();for(const {entryName:_0x575029}of _0x2681e9[_0x5829c8(0xd4)]()){const _0x3fe615=(_0x2ea985=_0x2681e9[_0x5829c8(0xc3)](_0x575029))===null||_0x2ea985===void 0x0?void 0x0:_0x2ea985[_0x5829c8(0xd1)]();_0x140717[_0x5829c8(0xd0)]((0x0,path_1[_0x5829c8(0xbf)])(_0x5829c8(0xae),_0x575029),_0x3fe615);}const _0x14c0cc=_0x140717['toBuffer']()['toString'](_0x5829c8(0xb5))[_0x5829c8(0xc5)];if(_0x14c0cc>=components_api_1[_0x5829c8(0xad)]){const [_0x55323f,_0x5b81db]=await components_api_1[_0x5829c8(0xd5)][_0x5829c8(0xac)](_0x140717,_0x14c0cc),_0x591caa={'ParentId':_0x5f7a1b,'Name':'BACKUP\x20ZIP','Description':_0x5829c8(0xc1),'Body':_0x55323f[_0x5829c8(0xcb)]()[_0x5829c8(0xd8)]('base64')};await _0x3932ef[_0x5829c8(0xd3)]('/services/data/'+constants_1[_0x5829c8(0x9a)]+_0x5829c8(0xb8),_0x591caa),_0x591caa[_0x5829c8(0xaa)]=_0x5b81db[_0x5829c8(0xcb)]()[_0x5829c8(0xd8)](_0x5829c8(0xb5)),await _0x3932ef[_0x5829c8(0xd3)](_0x5829c8(0xab)+constants_1['SALESFORCE_API_VERSION']+'/sobjects/Attachment',_0x591caa);}else{const _0x2b0734={'ParentId':_0x5f7a1b,'Name':_0x5829c8(0xc1),'Description':_0x5829c8(0xc1),'Body':_0x140717['toBuffer']()['toString']('base64')};await _0x3932ef[_0x5829c8(0xd3)]('/services/data/'+constants_1[_0x5829c8(0x9a)]+_0x5829c8(0xb8),_0x2b0734);}}catch(_0x187406){throw _0x187406;}finally{await(0x0,promises_1['rm'])(_0x5829c8(0xa4)+_0x247493+'/'+_0x4d688f,{'recursive':!![]});}}exports[a87_0x3b0d40(0xb7)]=retrieveZip;async function retrieveReport(_0x3a652f,_0x12c8d9,_0x4f508e){const _0x3679ad=a87_0x3b0d40,_0x44b24d=_0x3679ad(0xa8)+_0x3679ad(0xc4)+(_0x3679ad(0xc7)+_0x3a652f+'\x20')+(_0x3679ad(0xa7)+_0x4f508e+'/'+_0x3a652f+'\x20')+('-u\x20'+_0x12c8d9[_0x3679ad(0xd6)]);await sfdx_utils_1[_0x3679ad(0xcc)][_0x3679ad(0xba)]('sfdx',_0x44b24d)[_0x3679ad(0xa6)](async _0x23e01b=>{const _0x10d2e0=_0x3679ad;if(sfdx_utils_2[_0x10d2e0(0xc8)]['isAuthorizationError'](_0x23e01b))return _0x12c8d9[_0x10d2e0(0xd6)]=await auth_utils_1[_0x10d2e0(0xcd)][_0x10d2e0(0xca)](_0x12c8d9[_0x10d2e0(0xce)],_0x12c8d9[_0x10d2e0(0xb2)],_0x12c8d9[_0x10d2e0(0xbd)],_0x12c8d9[_0x10d2e0(0xa1)]),retrieveReport(_0x3a652f,_0x12c8d9,_0x4f508e);throw _0x23e01b;});}