const a86_0x2f8306=a86_0x7826;(function(_0x25a49c,_0x32b4f8){const _0x482003=a86_0x7826,_0x2ec21d=_0x25a49c();while(!![]){try{const _0x38d9d9=parseInt(_0x482003(0x130))/0x1+parseInt(_0x482003(0x141))/0x2+parseInt(_0x482003(0x114))/0x3*(parseInt(_0x482003(0x138))/0x4)+parseInt(_0x482003(0x127))/0x5+parseInt(_0x482003(0x133))/0x6+-parseInt(_0x482003(0x128))/0x7+parseInt(_0x482003(0x11f))/0x8*(-parseInt(_0x482003(0x12f))/0x9);if(_0x38d9d9===_0x32b4f8)break;else _0x2ec21d['push'](_0x2ec21d['shift']());}catch(_0x5a9627){_0x2ec21d['push'](_0x2ec21d['shift']());}}}(a86_0x3a07,0xac7d6));const a86_0xe1f40b=(function(){let _0x18dc5a=!![];return function(_0x6cf37e,_0x276b6a){const _0x4fa79d=_0x18dc5a?function(){const _0x4a9751=a86_0x7826;if(_0x276b6a){const _0x2eb3d2=_0x276b6a[_0x4a9751(0x142)](_0x6cf37e,arguments);return _0x276b6a=null,_0x2eb3d2;}}:function(){};return _0x18dc5a=![],_0x4fa79d;};}()),a86_0x3cab97=a86_0xe1f40b(this,function(){const _0x2a2cbe=a86_0x7826;return a86_0x3cab97['toString']()['search']('(((.+)+)+)+$')[_0x2a2cbe(0x10e)]()[_0x2a2cbe(0x118)](a86_0x3cab97)['search']('(((.+)+)+)+$');});a86_0x3cab97();'use strict';var __importDefault=this&&this[a86_0x2f8306(0x134)]||function(_0xd836d){const _0x5556ea=a86_0x2f8306;return _0xd836d&&_0xd836d[_0x5556ea(0x12c)]?_0xd836d:{'default':_0xd836d};};Object[a86_0x2f8306(0x122)](exports,a86_0x2f8306(0x12c),{'value':!![]}),exports[a86_0x2f8306(0x13d)]=void 0x0;function a86_0x3a07(){const _0x32bd03=['5464592svFksX','toBuffer','/sobjects/Attachment','SFDXUtils','__esModule','clientSecret','post','2368899lpyqEJ','973842OxPQVk','ComponentsApi','/services/data/','1445064QILisM','__importDefault','exists','refreshToken','-u\x20','392dxEcNf','getEntry','../utils/sfdx.utils','join','../../git/internal/fs.internal','retrieveZip','sfdx','-r\x20.temp/','updateAccessToken','682174VeZNiN','apply','readFile','src','--json\x20','default','SALESFORCE_API_VERSION','instanceUrl','toString','BACKUP\x20ZIP','splitZip','uuid','base64','AuthUtils','23691VlFpKz','../utils/auth.utils','clientId','mkdir','constructor','accessToken','../../../constants','setInstanceUrl','getData','adm-zip','path','40fHiaph','MAX_ZIP_SIZE','length','defineProperty','isAuthorizationError','force:mdapi:retrieve:report\x20','.temp/','addFile','2367750CfhgtJ'];a86_0x3a07=function(){return _0x32bd03;};return a86_0x3a07();}function a86_0x7826(_0x446a67,_0x1a8142){const _0xacddbb=a86_0x3a07();return a86_0x7826=function(_0x3cab97,_0xe1f40b){_0x3cab97=_0x3cab97-0x10d;let _0x3a073d=_0xacddbb[_0x3cab97];return _0x3a073d;},a86_0x7826(_0x446a67,_0x1a8142);}const constants_1=require(a86_0x2f8306(0x11a)),promises_1=require('fs/promises'),sfdx_utils_1=require('../../git/salesforce/utils/sfdx.utils'),fs_internal_1=require(a86_0x2f8306(0x13c)),sfdx_utils_2=require(a86_0x2f8306(0x13a)),auth_utils_1=require(a86_0x2f8306(0x115)),adm_zip_1=__importDefault(require(a86_0x2f8306(0x11d))),uuid_1=require(a86_0x2f8306(0x111)),components_api_1=require('../utils/components-api'),path_1=require(a86_0x2f8306(0x11e));async function retrieveZip({backupAsyncId:_0x13e30b,credentials:_0x5dd288,metadataLogId:_0xef3c97},_0x2f9b3d){const _0x3bebd5=a86_0x2f8306;var _0x1dcb0f;const _0x1f232b=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x3bebd5(0x135)](_0x3bebd5(0x125)+_0x1f232b)&&await(0x0,promises_1[_0x3bebd5(0x117)])(_0x3bebd5(0x125)+_0x1f232b,{'recursive':!![]});await sfdx_utils_2[_0x3bebd5(0x12b)]['createSFDXProject'](_0x13e30b,_0x1f232b),await sfdx_utils_2['SFDXUtils'][_0x3bebd5(0x11b)](_0x5dd288[_0x3bebd5(0x10d)],_0x13e30b,_0x1f232b),await retrieveReport(_0x13e30b,_0x5dd288,_0x1f232b);const _0x299c8a=new adm_zip_1[(_0x3bebd5(0x146))](await(0x0,promises_1[_0x3bebd5(0x143)])(_0x3bebd5(0x125)+_0x1f232b+'/'+_0x13e30b+'/unpackaged.zip')),_0x4e1786=new adm_zip_1['default']();for(const {entryName:_0x280047}of _0x299c8a['getEntries']()){const _0x2005b7=(_0x1dcb0f=_0x299c8a[_0x3bebd5(0x139)](_0x280047))===null||_0x1dcb0f===void 0x0?void 0x0:_0x1dcb0f[_0x3bebd5(0x11c)]();_0x4e1786[_0x3bebd5(0x126)]((0x0,path_1[_0x3bebd5(0x13b)])(_0x3bebd5(0x144),_0x280047),_0x2005b7);}const _0x2d9dba=_0x4e1786[_0x3bebd5(0x129)]()['toString'](_0x3bebd5(0x112))[_0x3bebd5(0x121)];if(_0x2d9dba>=components_api_1[_0x3bebd5(0x120)]){const [_0x21d38a,_0x4b7512]=await components_api_1[_0x3bebd5(0x131)][_0x3bebd5(0x110)](_0x4e1786,_0x2d9dba),_0x593072={'ParentId':_0xef3c97,'Name':_0x3bebd5(0x10f),'Description':_0x3bebd5(0x10f),'Body':_0x21d38a[_0x3bebd5(0x129)]()[_0x3bebd5(0x10e)](_0x3bebd5(0x112))};await _0x2f9b3d[_0x3bebd5(0x12e)](_0x3bebd5(0x132)+constants_1[_0x3bebd5(0x147)]+'/sobjects/Attachment',_0x593072),_0x593072['Body']=_0x4b7512[_0x3bebd5(0x129)]()[_0x3bebd5(0x10e)](_0x3bebd5(0x112)),await _0x2f9b3d[_0x3bebd5(0x12e)](_0x3bebd5(0x132)+constants_1['SALESFORCE_API_VERSION']+_0x3bebd5(0x12a),_0x593072);}else{const _0x58d68c={'ParentId':_0xef3c97,'Name':'BACKUP\x20ZIP','Description':_0x3bebd5(0x10f),'Body':_0x4e1786['toBuffer']()[_0x3bebd5(0x10e)]('base64')};await _0x2f9b3d[_0x3bebd5(0x12e)](_0x3bebd5(0x132)+constants_1[_0x3bebd5(0x147)]+_0x3bebd5(0x12a),_0x58d68c);}}catch(_0x42fe9a){throw _0x42fe9a;}finally{await(0x0,promises_1['rm'])(_0x3bebd5(0x125)+_0x1f232b+'/'+_0x13e30b,{'recursive':!![]});}}exports[a86_0x2f8306(0x13d)]=retrieveZip;async function retrieveReport(_0x5815c9,_0x361ed6,_0x113c89){const _0x371ada=a86_0x2f8306,_0x4499c4=_0x371ada(0x124)+_0x371ada(0x145)+('--jobid\x20'+_0x5815c9+'\x20')+(_0x371ada(0x13f)+_0x113c89+'/'+_0x5815c9+'\x20')+(_0x371ada(0x137)+_0x361ed6[_0x371ada(0x119)]);await sfdx_utils_1['SFDX']['spawnPromise'](_0x371ada(0x13e),_0x4499c4)['catch'](async _0x3db73c=>{const _0x1476c2=_0x371ada;if(sfdx_utils_2[_0x1476c2(0x12b)][_0x1476c2(0x123)](_0x3db73c))return _0x361ed6['accessToken']=await auth_utils_1[_0x1476c2(0x113)][_0x1476c2(0x140)](_0x361ed6[_0x1476c2(0x10d)],_0x361ed6[_0x1476c2(0x136)],_0x361ed6[_0x1476c2(0x116)],_0x361ed6[_0x1476c2(0x12d)]),retrieveReport(_0x5815c9,_0x361ed6,_0x113c89);throw _0x3db73c;});}