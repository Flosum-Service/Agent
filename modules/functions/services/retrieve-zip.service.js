const a87_0xe7541c=a87_0x2be6;function a87_0x2be6(_0x143318,_0x369c9a){const _0x3f417b=a87_0x26d4();return a87_0x2be6=function(_0x578c33,_0x1fb42e){_0x578c33=_0x578c33-0x10d;let _0x26d4f0=_0x3f417b[_0x578c33];return _0x26d4f0;},a87_0x2be6(_0x143318,_0x369c9a);}(function(_0x4d8749,_0x3ed5d9){const _0x1460be=a87_0x2be6,_0x44f884=_0x4d8749();while(!![]){try{const _0x1bde48=-parseInt(_0x1460be(0x145))/0x1+parseInt(_0x1460be(0x129))/0x2+-parseInt(_0x1460be(0x123))/0x3+parseInt(_0x1460be(0x141))/0x4+-parseInt(_0x1460be(0x13d))/0x5*(parseInt(_0x1460be(0x13a))/0x6)+parseInt(_0x1460be(0x12c))/0x7+-parseInt(_0x1460be(0x111))/0x8;if(_0x1bde48===_0x3ed5d9)break;else _0x44f884['push'](_0x44f884['shift']());}catch(_0x39020d){_0x44f884['push'](_0x44f884['shift']());}}}(a87_0x26d4,0x430eb));const a87_0x1fb42e=(function(){let _0x5dbe79=!![];return function(_0x144c9d,_0x4be955){const _0x51fae8=_0x5dbe79?function(){const _0x3d7688=a87_0x2be6;if(_0x4be955){const _0x34c2ef=_0x4be955[_0x3d7688(0x139)](_0x144c9d,arguments);return _0x4be955=null,_0x34c2ef;}}:function(){};return _0x5dbe79=![],_0x51fae8;};}()),a87_0x578c33=a87_0x1fb42e(this,function(){const _0x2bd0ae=a87_0x2be6;return a87_0x578c33[_0x2bd0ae(0x13c)]()['search'](_0x2bd0ae(0x12f))[_0x2bd0ae(0x13c)]()[_0x2bd0ae(0x117)](a87_0x578c33)['search'](_0x2bd0ae(0x12f));});a87_0x578c33();'use strict';var __importDefault=this&&this[a87_0xe7541c(0x126)]||function(_0x732a1){const _0x219bc6=a87_0xe7541c;return _0x732a1&&_0x732a1[_0x219bc6(0x12a)]?_0x732a1:{'default':_0x732a1};};Object[a87_0xe7541c(0x10e)](exports,a87_0xe7541c(0x12a),{'value':!![]}),exports['retrieveZip']=void 0x0;const promises_1=require('fs/promises'),sfdx_utils_1=require(a87_0xe7541c(0x125)),fs_internal_1=require(a87_0xe7541c(0x142)),sfdx_utils_2=require(a87_0xe7541c(0x11e)),auth_utils_1=require(a87_0xe7541c(0x133)),adm_zip_1=__importDefault(require(a87_0xe7541c(0x13b))),uuid_1=require(a87_0xe7541c(0x119)),components_api_1=require(a87_0xe7541c(0x113)),path_1=require('path');async function retrieveZip({backupAsyncId:_0x47bf19,credentials:_0xcd5b7e,metadataLogId:_0x52ea45,apiVersion:_0x42bd43},_0x332ef9){const _0x9b7928=a87_0xe7541c;var _0x3b5969;const _0x143fd0=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS']['exists'](_0x9b7928(0x132)+_0x143fd0)&&await(0x0,promises_1[_0x9b7928(0x11d)])(_0x9b7928(0x132)+_0x143fd0,{'recursive':!![]});await sfdx_utils_2[_0x9b7928(0x121)][_0x9b7928(0x138)](_0x47bf19,_0x143fd0),await sfdx_utils_2['SFDXUtils'][_0x9b7928(0x144)](_0xcd5b7e[_0x9b7928(0x10f)],_0x47bf19,_0x143fd0),await retrieveReport(_0x47bf19,_0xcd5b7e,_0x143fd0);const _0x271c39=new adm_zip_1['default'](await(0x0,promises_1[_0x9b7928(0x135)])(_0x9b7928(0x132)+_0x143fd0+'/'+_0x47bf19+_0x9b7928(0x127))),_0x25f3ff=new adm_zip_1[(_0x9b7928(0x137))]();for(const {entryName:_0x44fdbe}of _0x271c39[_0x9b7928(0x122)]()){const _0x38813f=(_0x3b5969=_0x271c39[_0x9b7928(0x136)](_0x44fdbe))===null||_0x3b5969===void 0x0?void 0x0:_0x3b5969[_0x9b7928(0x12d)]();_0x25f3ff[_0x9b7928(0x12e)]((0x0,path_1[_0x9b7928(0x11c)])(_0x9b7928(0x13e),_0x44fdbe),_0x38813f);}const _0x335d8d=_0x25f3ff[_0x9b7928(0x116)]()[_0x9b7928(0x13c)](_0x9b7928(0x10d))[_0x9b7928(0x143)];if(_0x335d8d>=components_api_1[_0x9b7928(0x128)]){const [_0x1d37b1,_0x465459]=await components_api_1['ComponentsApi'][_0x9b7928(0x146)](_0x25f3ff,_0x335d8d),_0x5adb8b={'ParentId':_0x52ea45,'Name':'BACKUP\x20ZIP','Description':_0x9b7928(0x11b),'Body':_0x1d37b1[_0x9b7928(0x116)]()[_0x9b7928(0x13c)](_0x9b7928(0x10d))};await _0x332ef9[_0x9b7928(0x110)](_0x9b7928(0x134)+_0x42bd43+'/sobjects/Attachment',_0x5adb8b),_0x5adb8b[_0x9b7928(0x13f)]=_0x465459[_0x9b7928(0x116)]()[_0x9b7928(0x13c)]('base64'),await _0x332ef9[_0x9b7928(0x110)](_0x9b7928(0x134)+_0x42bd43+_0x9b7928(0x115),_0x5adb8b);}else{const _0x3e255e={'ParentId':_0x52ea45,'Name':_0x9b7928(0x11b),'Description':_0x9b7928(0x11b),'Body':_0x25f3ff[_0x9b7928(0x116)]()[_0x9b7928(0x13c)](_0x9b7928(0x10d))};await _0x332ef9['post'](_0x9b7928(0x134)+_0x42bd43+_0x9b7928(0x115),_0x3e255e);}}catch(_0x4ff44d){throw _0x4ff44d;}finally{await(0x0,promises_1['rm'])('.temp/'+_0x143fd0+'/'+_0x47bf19,{'recursive':!![]});}}exports[a87_0xe7541c(0x140)]=retrieveZip;function a87_0x26d4(){const _0xb77afc=['../utils/auth.utils','/services/data/v','readFile','getEntry','default','createSFDXProject','apply','6DtQimK','adm-zip','toString','1242295pnyJGa','src','Body','retrieveZip','1157724UhLnfd','../../git/internal/fs.internal','length','setInstanceUrl','183342KHGrgb','splitZip','updateAccessToken','base64','defineProperty','instanceUrl','post','316880kCVwsN','--json\x20','../utils/components-api','clientSecret','/sobjects/Attachment','toBuffer','constructor','clientId','uuid','SFDX','BACKUP\x20ZIP','join','mkdir','../utils/sfdx.utils','catch','force:mdapi:retrieve:report\x20','SFDXUtils','getEntries','260079gyiFBj','AuthUtils','../../git/salesforce/utils/sfdx.utils','__importDefault','/unpackaged.zip','MAX_ZIP_SIZE','1077450AmlaUc','__esModule','accessToken','32305IHezQN','getData','addFile','(((.+)+)+)+$','isAuthorizationError','refreshToken','.temp/'];a87_0x26d4=function(){return _0xb77afc;};return a87_0x26d4();}async function retrieveReport(_0xadc421,_0x11daf9,_0x580d1a){const _0x32c7bb=a87_0xe7541c,_0x20a4c8=_0x32c7bb(0x120)+_0x32c7bb(0x112)+('--jobid\x20'+_0xadc421+'\x20')+('-r\x20.temp/'+_0x580d1a+'/'+_0xadc421+'\x20')+('-u\x20'+_0x11daf9[_0x32c7bb(0x12b)]);await sfdx_utils_1[_0x32c7bb(0x11a)]['spawn'](_0x20a4c8)[_0x32c7bb(0x11f)](async _0x2d9268=>{const _0x15a2ef=_0x32c7bb;if(sfdx_utils_2['SFDXUtils'][_0x15a2ef(0x130)](_0x2d9268))return _0x11daf9[_0x15a2ef(0x12b)]=await auth_utils_1[_0x15a2ef(0x124)][_0x15a2ef(0x147)](_0x11daf9['instanceUrl'],_0x11daf9[_0x15a2ef(0x131)],_0x11daf9[_0x15a2ef(0x118)],_0x11daf9[_0x15a2ef(0x114)]),retrieveReport(_0xadc421,_0x11daf9,_0x580d1a);throw _0x2d9268;});}