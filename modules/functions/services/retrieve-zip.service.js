const a87_0x152278=a87_0x3c13;(function(_0x5585ec,_0x3036fc){const _0x17e698=a87_0x3c13,_0x118448=_0x5585ec();while(!![]){try{const _0x3c0a48=parseInt(_0x17e698(0x1cd))/0x1+parseInt(_0x17e698(0x1a5))/0x2+-parseInt(_0x17e698(0x1a7))/0x3+parseInt(_0x17e698(0x1b3))/0x4+parseInt(_0x17e698(0x1c6))/0x5*(-parseInt(_0x17e698(0x1b1))/0x6)+parseInt(_0x17e698(0x1be))/0x7+-parseInt(_0x17e698(0x1c9))/0x8;if(_0x3c0a48===_0x3036fc)break;else _0x118448['push'](_0x118448['shift']());}catch(_0x28786e){_0x118448['push'](_0x118448['shift']());}}}(a87_0x39bb,0x94f88));const a87_0x3cd584=(function(){let _0x2b9e08=!![];return function(_0x1f124b,_0x23ca44){const _0x512fa1=_0x2b9e08?function(){const _0x44d413=a87_0x3c13;if(_0x23ca44){const _0x4b61fe=_0x23ca44[_0x44d413(0x1b7)](_0x1f124b,arguments);return _0x23ca44=null,_0x4b61fe;}}:function(){};return _0x2b9e08=![],_0x512fa1;};}()),a87_0x365cce=a87_0x3cd584(this,function(){const _0x56c8e5=a87_0x3c13;return a87_0x365cce[_0x56c8e5(0x1ca)]()['search']('(((.+)+)+)+$')[_0x56c8e5(0x1ca)]()[_0x56c8e5(0x197)](a87_0x365cce)[_0x56c8e5(0x1c8)](_0x56c8e5(0x1b9));});a87_0x365cce();function a87_0x3c13(_0x57f271,_0x470f8d){const _0x3112b9=a87_0x39bb();return a87_0x3c13=function(_0x365cce,_0x3cd584){_0x365cce=_0x365cce-0x197;let _0x39bbd3=_0x3112b9[_0x365cce];return _0x39bbd3;},a87_0x3c13(_0x57f271,_0x470f8d);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2c1612){const _0x2586ed=a87_0x3c13;return _0x2c1612&&_0x2c1612[_0x2586ed(0x1b6)]?_0x2c1612:{'default':_0x2c1612};};Object[a87_0x152278(0x1a0)](exports,a87_0x152278(0x1b6),{'value':!![]}),exports['retrieveZip']=void 0x0;const constants_1=require('../../../constants'),promises_1=require(a87_0x152278(0x1c1)),sfdx_utils_1=require(a87_0x152278(0x1b8)),fs_internal_1=require(a87_0x152278(0x199)),sfdx_utils_2=require(a87_0x152278(0x1aa)),auth_utils_1=require('../utils/auth.utils'),adm_zip_1=__importDefault(require('adm-zip')),uuid_1=require('uuid'),components_api_1=require(a87_0x152278(0x1ab)),path_1=require('path');function a87_0x39bb(){const _0x1dcfc8=['exists','/sobjects/Attachment','instanceUrl','7714231KswisI','mkdir','setInstanceUrl','fs/promises','isAuthorizationError','join','--jobid\x20','AuthUtils','7835KsaRED','default','search','6330416BtgZgN','toString','/unpackaged.zip','ComponentsApi','1104718ybEnxY','BACKUP\x20ZIP','MAX_ZIP_SIZE','--json\x20','-u\x20','post','constructor','readFile','../../git/internal/fs.internal','getEntry','base64','getEntries','createSFDXProject','splitZip','spawnPromise','defineProperty','Body','SFDX','accessToken','sfdx','385880WeuNoB','toBuffer','3639942kcAUYx','/services/data/','clientId','../utils/sfdx.utils','../utils/components-api','getData','SFDXUtils','catch','updateAccessToken','.temp/','1776hUwaWJ','addFile','2715764vrbTAx','SALESFORCE_API_VERSION','refreshToken','__esModule','apply','../../git/salesforce/utils/sfdx.utils','(((.+)+)+)+$','src'];a87_0x39bb=function(){return _0x1dcfc8;};return a87_0x39bb();}async function retrieveZip({backupAsyncId:_0x5295d2,credentials:_0x1b7950,metadataLogId:_0x5c82f6},_0x491ac5){const _0x5398a1=a87_0x152278;var _0x2a5c15;const _0x3c8047=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x5398a1(0x1bb)](_0x5398a1(0x1b0)+_0x3c8047)&&await(0x0,promises_1[_0x5398a1(0x1bf)])(_0x5398a1(0x1b0)+_0x3c8047,{'recursive':!![]});await sfdx_utils_2[_0x5398a1(0x1ad)][_0x5398a1(0x19d)](_0x5295d2,_0x3c8047),await sfdx_utils_2[_0x5398a1(0x1ad)][_0x5398a1(0x1c0)](_0x1b7950[_0x5398a1(0x1bd)],_0x5295d2,_0x3c8047),await retrieveReport(_0x5295d2,_0x1b7950,_0x3c8047);const _0x1fa403=new adm_zip_1[(_0x5398a1(0x1c7))](await(0x0,promises_1[_0x5398a1(0x198)])(_0x5398a1(0x1b0)+_0x3c8047+'/'+_0x5295d2+_0x5398a1(0x1cb))),_0x42fec0=new adm_zip_1[(_0x5398a1(0x1c7))]();for(const {entryName:_0x249a7d}of _0x1fa403[_0x5398a1(0x19c)]()){const _0x331993=(_0x2a5c15=_0x1fa403[_0x5398a1(0x19a)](_0x249a7d))===null||_0x2a5c15===void 0x0?void 0x0:_0x2a5c15[_0x5398a1(0x1ac)]();_0x42fec0[_0x5398a1(0x1b2)]((0x0,path_1[_0x5398a1(0x1c3)])(_0x5398a1(0x1ba),_0x249a7d),_0x331993);}const _0x35aa66=_0x42fec0[_0x5398a1(0x1a6)]()['toString'](_0x5398a1(0x19b))['length'];if(_0x35aa66>=components_api_1[_0x5398a1(0x1cf)]){const [_0x37a3a0,_0x14c123]=await components_api_1[_0x5398a1(0x1cc)][_0x5398a1(0x19e)](_0x42fec0,_0x35aa66),_0x442384={'ParentId':_0x5c82f6,'Name':'BACKUP\x20ZIP','Description':_0x5398a1(0x1ce),'Body':_0x37a3a0['toBuffer']()['toString'](_0x5398a1(0x19b))};await _0x491ac5[_0x5398a1(0x1d2)](_0x5398a1(0x1a8)+constants_1[_0x5398a1(0x1b4)]+_0x5398a1(0x1bc),_0x442384),_0x442384[_0x5398a1(0x1a1)]=_0x14c123[_0x5398a1(0x1a6)]()[_0x5398a1(0x1ca)](_0x5398a1(0x19b)),await _0x491ac5[_0x5398a1(0x1d2)](_0x5398a1(0x1a8)+constants_1[_0x5398a1(0x1b4)]+_0x5398a1(0x1bc),_0x442384);}else{const _0xcd8302={'ParentId':_0x5c82f6,'Name':_0x5398a1(0x1ce),'Description':_0x5398a1(0x1ce),'Body':_0x42fec0[_0x5398a1(0x1a6)]()['toString'](_0x5398a1(0x19b))};await _0x491ac5[_0x5398a1(0x1d2)](_0x5398a1(0x1a8)+constants_1[_0x5398a1(0x1b4)]+_0x5398a1(0x1bc),_0xcd8302);}}catch(_0x4daf77){throw _0x4daf77;}finally{await(0x0,promises_1['rm'])('.temp/'+_0x3c8047+'/'+_0x5295d2,{'recursive':!![]});}}exports['retrieveZip']=retrieveZip;async function retrieveReport(_0x1c084a,_0x5fbd6a,_0x4e15bf){const _0x11c7d5=a87_0x152278,_0x1793c3='force:mdapi:retrieve:report\x20'+_0x11c7d5(0x1d0)+(_0x11c7d5(0x1c4)+_0x1c084a+'\x20')+('-r\x20.temp/'+_0x4e15bf+'/'+_0x1c084a+'\x20')+(_0x11c7d5(0x1d1)+_0x5fbd6a['accessToken']);await sfdx_utils_1[_0x11c7d5(0x1a2)][_0x11c7d5(0x19f)](_0x11c7d5(0x1a4),_0x1793c3)[_0x11c7d5(0x1ae)](async _0x28adaf=>{const _0x4934e7=_0x11c7d5;if(sfdx_utils_2['SFDXUtils'][_0x4934e7(0x1c2)](_0x28adaf))return _0x5fbd6a[_0x4934e7(0x1a3)]=await auth_utils_1[_0x4934e7(0x1c5)][_0x4934e7(0x1af)](_0x5fbd6a[_0x4934e7(0x1bd)],_0x5fbd6a[_0x4934e7(0x1b5)],_0x5fbd6a[_0x4934e7(0x1a9)],_0x5fbd6a['clientSecret']),retrieveReport(_0x1c084a,_0x5fbd6a,_0x4e15bf);throw _0x28adaf;});}