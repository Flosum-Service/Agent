const a87_0x5d41ed=a87_0x1ed1;(function(_0x3eda8d,_0x24a939){const _0x277a66=a87_0x1ed1,_0x1f6bea=_0x3eda8d();while(!![]){try{const _0x1938ce=parseInt(_0x277a66(0x13b))/0x1+-parseInt(_0x277a66(0x10b))/0x2*(parseInt(_0x277a66(0x133))/0x3)+parseInt(_0x277a66(0x134))/0x4+parseInt(_0x277a66(0x10e))/0x5+parseInt(_0x277a66(0x10a))/0x6*(-parseInt(_0x277a66(0x140))/0x7)+-parseInt(_0x277a66(0x118))/0x8*(-parseInt(_0x277a66(0x11d))/0x9)+-parseInt(_0x277a66(0x138))/0xa;if(_0x1938ce===_0x24a939)break;else _0x1f6bea['push'](_0x1f6bea['shift']());}catch(_0x15fc90){_0x1f6bea['push'](_0x1f6bea['shift']());}}}(a87_0x1f40,0xdf9db));function a87_0x1f40(){const _0x2e0dbc=['Body','12317109tAsTZm','search','path','clientSecret','post','(((.+)+)+)+$','6cnHNhm','162CGtDav','SALESFORCE_API_VERSION','__esModule','7650895fLQZvr','getEntry','uuid','createSFDXProject','../utils/sfdx.utils','defineProperty','default','adm-zip','length','splitZip','16Uqcjyc','accessToken','join','spawnPromise','-u\x20','5180265yubXNh','/sobjects/Attachment','toString','ComponentsApi','base64','--json\x20','setInstanceUrl','retrieveZip','fs/promises','.temp/','SFDXUtils','exists','refreshToken','catch','../utils/auth.utils','toBuffer','clientId','sfdx','readFile','force:mdapi:retrieve:report\x20','--jobid\x20','/services/data/','6264xlBoDQ','2663800esraGJ','mkdir','MAX_ZIP_SIZE','BACKUP\x20ZIP','5270930mfKUAZ','getEntries','__importDefault','24440SwJfgl','../../git/salesforce/utils/sfdx.utils','constructor','instanceUrl'];a87_0x1f40=function(){return _0x2e0dbc;};return a87_0x1f40();}const a87_0x267839=(function(){let _0x4c48d2=!![];return function(_0x427bec,_0x15bcee){const _0x42bd63=_0x4c48d2?function(){if(_0x15bcee){const _0x3d6f49=_0x15bcee['apply'](_0x427bec,arguments);return _0x15bcee=null,_0x3d6f49;}}:function(){};return _0x4c48d2=![],_0x42bd63;};}()),a87_0x40dfbf=a87_0x267839(this,function(){const _0x3ca9ae=a87_0x1ed1;return a87_0x40dfbf['toString']()[_0x3ca9ae(0x141)](_0x3ca9ae(0x109))[_0x3ca9ae(0x11f)]()[_0x3ca9ae(0x13d)](a87_0x40dfbf)['search'](_0x3ca9ae(0x109));});function a87_0x1ed1(_0x576bc9,_0x266b6c){const _0x584ff4=a87_0x1f40();return a87_0x1ed1=function(_0x40dfbf,_0x267839){_0x40dfbf=_0x40dfbf-0x108;let _0x1f4088=_0x584ff4[_0x40dfbf];return _0x1f4088;},a87_0x1ed1(_0x576bc9,_0x266b6c);}a87_0x40dfbf();'use strict';var __importDefault=this&&this[a87_0x5d41ed(0x13a)]||function(_0xb537d4){const _0x57475d=a87_0x5d41ed;return _0xb537d4&&_0xb537d4[_0x57475d(0x10d)]?_0xb537d4:{'default':_0xb537d4};};Object[a87_0x5d41ed(0x113)](exports,a87_0x5d41ed(0x10d),{'value':!![]}),exports[a87_0x5d41ed(0x124)]=void 0x0;const constants_1=require('../../../constants'),promises_1=require(a87_0x5d41ed(0x125)),sfdx_utils_1=require(a87_0x5d41ed(0x13c)),fs_internal_1=require('../../git/internal/fs.internal'),sfdx_utils_2=require(a87_0x5d41ed(0x112)),auth_utils_1=require(a87_0x5d41ed(0x12b)),adm_zip_1=__importDefault(require(a87_0x5d41ed(0x115))),uuid_1=require(a87_0x5d41ed(0x110)),components_api_1=require('../utils/components-api'),path_1=require(a87_0x5d41ed(0x142));async function retrieveZip({backupAsyncId:_0x2e41f0,credentials:_0x234afe,metadataLogId:_0x469372},_0x55950f){const _0x1a2073=a87_0x5d41ed;var _0x200d0a;const _0x3ac2a7=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x1a2073(0x128)](_0x1a2073(0x126)+_0x3ac2a7)&&await(0x0,promises_1[_0x1a2073(0x135)])(_0x1a2073(0x126)+_0x3ac2a7,{'recursive':!![]});await sfdx_utils_2['SFDXUtils'][_0x1a2073(0x111)](_0x2e41f0,_0x3ac2a7),await sfdx_utils_2[_0x1a2073(0x127)][_0x1a2073(0x123)](_0x234afe[_0x1a2073(0x13e)],_0x2e41f0,_0x3ac2a7),await retrieveReport(_0x2e41f0,_0x234afe,_0x3ac2a7);const _0x249344=new adm_zip_1['default'](await(0x0,promises_1[_0x1a2073(0x12f)])('.temp/'+_0x3ac2a7+'/'+_0x2e41f0+'/unpackaged.zip')),_0x1938e2=new adm_zip_1[(_0x1a2073(0x114))]();for(const {entryName:_0x43ca58}of _0x249344[_0x1a2073(0x139)]()){const _0x4410f0=(_0x200d0a=_0x249344[_0x1a2073(0x10f)](_0x43ca58))===null||_0x200d0a===void 0x0?void 0x0:_0x200d0a['getData']();_0x1938e2['addFile']((0x0,path_1[_0x1a2073(0x11a)])('src',_0x43ca58),_0x4410f0);}const _0x249027=_0x1938e2[_0x1a2073(0x12c)]()[_0x1a2073(0x11f)](_0x1a2073(0x121))[_0x1a2073(0x116)];if(_0x249027>=components_api_1[_0x1a2073(0x136)]){const [_0x11ae86,_0x17a78a]=await components_api_1[_0x1a2073(0x120)][_0x1a2073(0x117)](_0x1938e2,_0x249027),_0xb04374={'ParentId':_0x469372,'Name':_0x1a2073(0x137),'Description':'BACKUP\x20ZIP','Body':_0x11ae86[_0x1a2073(0x12c)]()[_0x1a2073(0x11f)]('base64')};await _0x55950f[_0x1a2073(0x108)](_0x1a2073(0x132)+constants_1['SALESFORCE_API_VERSION']+_0x1a2073(0x11e),_0xb04374),_0xb04374[_0x1a2073(0x13f)]=_0x17a78a[_0x1a2073(0x12c)]()['toString'](_0x1a2073(0x121)),await _0x55950f['post'](_0x1a2073(0x132)+constants_1[_0x1a2073(0x10c)]+_0x1a2073(0x11e),_0xb04374);}else{const _0x59094d={'ParentId':_0x469372,'Name':_0x1a2073(0x137),'Description':_0x1a2073(0x137),'Body':_0x1938e2['toBuffer']()[_0x1a2073(0x11f)](_0x1a2073(0x121))};await _0x55950f[_0x1a2073(0x108)](_0x1a2073(0x132)+constants_1['SALESFORCE_API_VERSION']+'/sobjects/Attachment',_0x59094d);}}catch(_0xb7331d){throw _0xb7331d;}finally{await(0x0,promises_1['rm'])(_0x1a2073(0x126)+_0x3ac2a7+'/'+_0x2e41f0,{'recursive':!![]});}}exports['retrieveZip']=retrieveZip;async function retrieveReport(_0x5cdd96,_0x3bf6cc,_0xe390ab){const _0x46ca05=a87_0x5d41ed,_0x2b5d76=_0x46ca05(0x130)+_0x46ca05(0x122)+(_0x46ca05(0x131)+_0x5cdd96+'\x20')+('-r\x20.temp/'+_0xe390ab+'/'+_0x5cdd96+'\x20')+(_0x46ca05(0x11c)+_0x3bf6cc[_0x46ca05(0x119)]);await sfdx_utils_1['SFDX'][_0x46ca05(0x11b)](_0x46ca05(0x12e),_0x2b5d76)[_0x46ca05(0x12a)](async _0x13e080=>{const _0x55f83a=_0x46ca05;if(sfdx_utils_2[_0x55f83a(0x127)]['isAuthorizationError'](_0x13e080))return _0x3bf6cc['accessToken']=await auth_utils_1['AuthUtils']['updateAccessToken'](_0x3bf6cc['instanceUrl'],_0x3bf6cc[_0x55f83a(0x129)],_0x3bf6cc[_0x55f83a(0x12d)],_0x3bf6cc[_0x55f83a(0x143)]),retrieveReport(_0x5cdd96,_0x3bf6cc,_0xe390ab);throw _0x13e080;});}