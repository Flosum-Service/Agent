const a55_0x1f3cfb=a55_0x569a;function a55_0x3a8c(){const _0x537741=['retrieveZip','/sobjects/Attachment','readFile','49uJuHGs','mkdir','instanceUrl','base64','(((.+)+)+)+$','166lPVSgU','catch','addFile','getEntry','--json\x20','1221070RZmdkc','toString','1006027myivAa','sfdx','Body','BACKUP\x20ZIP','uuid','toBuffer','../utils/auth.utils','/services/data/','-r\x20.temp/','1223718wuIWrb','getData','exists','../../git/salesforce/utils/sfdx.utils','ComponentsApi','SFDX','../../git/internal/fs.internal','spawnPromise','adm-zip','join','../utils/components-api','__esModule','accessToken','clientId','defineProperty','updateAccessToken','splitZip','setInstanceUrl','apply','.temp/','18bNdSYg','post','AuthUtils','isAuthorizationError','default','SALESFORCE_API_VERSION','--jobid\x20','439GcUFpE','1044064AlLnBz','constructor','src','5rCIrHY','__importDefault','search','../../../constants','getEntries','MAX_ZIP_SIZE','64568RHwRMY','-u\x20','SFDXUtils','path','712422fIwYXb'];a55_0x3a8c=function(){return _0x537741;};return a55_0x3a8c();}(function(_0xccae8d,_0xdae44e){const _0x337eaa=a55_0x569a,_0x3fb731=_0xccae8d();while(!![]){try{const _0x35e122=-parseInt(_0x337eaa(0xca))/0x1*(-parseInt(_0x337eaa(0xe1))/0x2)+-parseInt(_0x337eaa(0xd8))/0x3+parseInt(_0x337eaa(0xcb))/0x4+parseInt(_0x337eaa(0xce))/0x5*(parseInt(_0x337eaa(0xf1))/0x6)+-parseInt(_0x337eaa(0xdc))/0x7*(-parseInt(_0x337eaa(0xd4))/0x8)+-parseInt(_0x337eaa(0xc3))/0x9*(parseInt(_0x337eaa(0xe6))/0xa)+parseInt(_0x337eaa(0xe8))/0xb;if(_0x35e122===_0xdae44e)break;else _0x3fb731['push'](_0x3fb731['shift']());}catch(_0x330745){_0x3fb731['push'](_0x3fb731['shift']());}}}(a55_0x3a8c,0x28ef8));const a55_0x29a168=(function(){let _0x18c499=!![];return function(_0x3da3eb,_0x26067e){const _0x12b539=_0x18c499?function(){const _0xeb8b3b=a55_0x569a;if(_0x26067e){const _0x3f5506=_0x26067e[_0xeb8b3b(0xc1)](_0x3da3eb,arguments);return _0x26067e=null,_0x3f5506;}}:function(){};return _0x18c499=![],_0x12b539;};}()),a55_0x4a9e6d=a55_0x29a168(this,function(){const _0x148f44=a55_0x569a;return a55_0x4a9e6d[_0x148f44(0xe7)]()[_0x148f44(0xd0)](_0x148f44(0xe0))[_0x148f44(0xe7)]()[_0x148f44(0xcc)](a55_0x4a9e6d)[_0x148f44(0xd0)](_0x148f44(0xe0));});a55_0x4a9e6d();'use strict';function a55_0x569a(_0x2b6dd8,_0x43d5de){const _0x1bdf9a=a55_0x3a8c();return a55_0x569a=function(_0x4a9e6d,_0x29a168){_0x4a9e6d=_0x4a9e6d-0xb9;let _0x3a8cd2=_0x1bdf9a[_0x4a9e6d];return _0x3a8cd2;},a55_0x569a(_0x2b6dd8,_0x43d5de);}var __importDefault=this&&this[a55_0x1f3cfb(0xcf)]||function(_0x134ec8){const _0x3f4d78=a55_0x1f3cfb;return _0x134ec8&&_0x134ec8[_0x3f4d78(0xba)]?_0x134ec8:{'default':_0x134ec8};};Object[a55_0x1f3cfb(0xbd)](exports,a55_0x1f3cfb(0xba),{'value':!![]}),exports['retrieveZip']=void 0x0;const constants_1=require(a55_0x1f3cfb(0xd1)),promises_1=require('fs/promises'),sfdx_utils_1=require(a55_0x1f3cfb(0xf4)),fs_internal_1=require(a55_0x1f3cfb(0xf7)),sfdx_utils_2=require('../utils/sfdx.utils'),auth_utils_1=require(a55_0x1f3cfb(0xee)),adm_zip_1=__importDefault(require(a55_0x1f3cfb(0xf9))),uuid_1=require(a55_0x1f3cfb(0xec)),components_api_1=require(a55_0x1f3cfb(0xb9)),path_1=require(a55_0x1f3cfb(0xd7));async function retrieveZip({backupAsyncId:_0x3e71d7,credentials:_0x3463da,metadataLogId:_0x284714},_0x4b28d1){const _0x324594=a55_0x1f3cfb;var _0x16e53e;const _0x152e6a=(0x0,uuid_1['v4'])();try{!await fs_internal_1['FS'][_0x324594(0xf3)](_0x324594(0xc2)+_0x152e6a)&&await(0x0,promises_1[_0x324594(0xdd)])(_0x324594(0xc2)+_0x152e6a,{'recursive':!![]});await sfdx_utils_2[_0x324594(0xd6)]['createSFDXProject'](_0x3e71d7,_0x152e6a),await sfdx_utils_2[_0x324594(0xd6)][_0x324594(0xc0)](_0x3463da[_0x324594(0xde)],_0x3e71d7,_0x152e6a),await retrieveReport(_0x3e71d7,_0x3463da,_0x152e6a);const _0x4aa06b=new adm_zip_1[(_0x324594(0xc7))](await(0x0,promises_1[_0x324594(0xdb)])(_0x324594(0xc2)+_0x152e6a+'/'+_0x3e71d7+'/unpackaged.zip')),_0x59543d=new adm_zip_1[(_0x324594(0xc7))]();for(const {entryName:_0x3fad49}of _0x4aa06b[_0x324594(0xd2)]()){const _0x3f1653=(_0x16e53e=_0x4aa06b[_0x324594(0xe4)](_0x3fad49))===null||_0x16e53e===void 0x0?void 0x0:_0x16e53e[_0x324594(0xf2)]();_0x59543d[_0x324594(0xe3)]((0x0,path_1[_0x324594(0xfa)])(_0x324594(0xcd),_0x3fad49),_0x3f1653);}const _0x46db71=_0x59543d['toBuffer']()[_0x324594(0xe7)]('base64')['length'];if(_0x46db71>=components_api_1[_0x324594(0xd3)]){const [_0x2824d4,_0x3f1ac3]=await components_api_1[_0x324594(0xf5)][_0x324594(0xbf)](_0x59543d,_0x46db71),_0x52c477={'ParentId':_0x284714,'Name':_0x324594(0xeb),'Description':'BACKUP\x20ZIP','Body':_0x2824d4[_0x324594(0xed)]()[_0x324594(0xe7)](_0x324594(0xdf))};await _0x4b28d1[_0x324594(0xc4)](_0x324594(0xef)+constants_1[_0x324594(0xc8)]+_0x324594(0xda),_0x52c477),_0x52c477[_0x324594(0xea)]=_0x3f1ac3[_0x324594(0xed)]()[_0x324594(0xe7)](_0x324594(0xdf)),await _0x4b28d1['post'](_0x324594(0xef)+constants_1[_0x324594(0xc8)]+_0x324594(0xda),_0x52c477);}else{const _0x212720={'ParentId':_0x284714,'Name':'BACKUP\x20ZIP','Description':'BACKUP\x20ZIP','Body':_0x59543d[_0x324594(0xed)]()[_0x324594(0xe7)](_0x324594(0xdf))};await _0x4b28d1[_0x324594(0xc4)](_0x324594(0xef)+constants_1['SALESFORCE_API_VERSION']+_0x324594(0xda),_0x212720);}}catch(_0xa16d78){throw _0xa16d78;}finally{await(0x0,promises_1['rm'])(_0x324594(0xc2)+_0x152e6a+'/'+_0x3e71d7,{'recursive':!![]});}}exports[a55_0x1f3cfb(0xd9)]=retrieveZip;async function retrieveReport(_0x25f6b3,_0x5c186e,_0x17a7fa){const _0x5b9d07=a55_0x1f3cfb,_0x1ada90='force:mdapi:retrieve:report\x20'+_0x5b9d07(0xe5)+(_0x5b9d07(0xc9)+_0x25f6b3+'\x20')+(_0x5b9d07(0xf0)+_0x17a7fa+'/'+_0x25f6b3+'\x20')+(_0x5b9d07(0xd5)+_0x5c186e[_0x5b9d07(0xbb)]);await sfdx_utils_1[_0x5b9d07(0xf6)][_0x5b9d07(0xf8)](_0x5b9d07(0xe9),_0x1ada90)[_0x5b9d07(0xe2)](async _0x3ac9dd=>{const _0x5e0959=_0x5b9d07;if(sfdx_utils_2[_0x5e0959(0xd6)][_0x5e0959(0xc6)](_0x3ac9dd))return _0x5c186e[_0x5e0959(0xbb)]=await auth_utils_1[_0x5e0959(0xc5)][_0x5e0959(0xbe)](_0x5c186e['instanceUrl'],_0x5c186e['refreshToken'],_0x5c186e[_0x5e0959(0xbc)],_0x5c186e['clientSecret']),retrieveReport(_0x25f6b3,_0x5c186e,_0x17a7fa);throw _0x3ac9dd;});}