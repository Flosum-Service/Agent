const a59_0x496ee7=a59_0xf984;function a59_0x5e69(){const _0x2d73b0=['SALESFORCE_API_VERSION','Body','getEntries','join','constructor','sort','fetchAttachmentBody','/services/apexrest','toBuffer','splitZip','Component__r.','2408082SWZBlu','toString','20694652HgfmdR','__importDefault','../../git/salesforce/utils/flosum-naming.utils','Component_History__c\x0a\x20\x20\x20\x20\x20\x20WHERE\x20Id\x20IN\x20(','search','FLOSUM_NAMESPACE','(((.+)+)+)+$','Component_Name__c,\x20','14rHUHyN','arraybuffer','../../shared/utils','/query/','Component__r','Component_Type__c\x0a\x20\x20\x20\x20\x20\x20FROM\x20','639gQFSqm','base64','138790rXAIzy','Component_Type__c','3695968DQeLbq','fetchComponentsDetailsByComponentsHistory','map','apply','Component_Name__c','4rvLbca','ComponentsApi','filter','713226Uhfymv','1270552LKVbQb','default','removeNamespacePrefix','fetchAttachmentsDetails','\x27,\x27','addFile','namespace','length','60ZrhZUC','chunkArray','records','get','BodyLength','defineProperty','Attachment','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20Id,\x20','MAX_ZIP_SIZE','/services/data/','push','/retrieveAttachments/','post','/body','extractFieldsFromRecord','isDirectory','getData','retrieveAttachments','fetchAttachments','getEntry','178335vCYaWT'];a59_0x5e69=function(){return _0x2d73b0;};return a59_0x5e69();}(function(_0x423b0a,_0x1a16ee){const _0x1672ef=a59_0xf984,_0x2960e5=_0x423b0a();while(!![]){try{const _0x1dfbf7=parseInt(_0x1672ef(0xad))/0x1+-parseInt(_0x1672ef(0xae))/0x2+parseInt(_0x1672ef(0x91))/0x3*(parseInt(_0x1672ef(0xaa))/0x4)+parseInt(_0x1672ef(0x85))/0x5*(-parseInt(_0x1672ef(0xb6))/0x6)+parseInt(_0x1672ef(0x9b))/0x7*(-parseInt(_0x1672ef(0xa5))/0x8)+-parseInt(_0x1672ef(0xa1))/0x9*(parseInt(_0x1672ef(0xa3))/0xa)+parseInt(_0x1672ef(0x93))/0xb;if(_0x1dfbf7===_0x1a16ee)break;else _0x2960e5['push'](_0x2960e5['shift']());}catch(_0x3f1f2a){_0x2960e5['push'](_0x2960e5['shift']());}}}(a59_0x5e69,0x79121));function a59_0xf984(_0x1c62f7,_0x374706){const _0x5a518b=a59_0x5e69();return a59_0xf984=function(_0x511d67,_0x56f3a0){_0x511d67=_0x511d67-0x76;let _0x5e6974=_0x5a518b[_0x511d67];return _0x5e6974;},a59_0xf984(_0x1c62f7,_0x374706);}const a59_0x56f3a0=(function(){let _0x2837ad=!![];return function(_0x3cdef5,_0x4bce35){const _0x19d1df=_0x2837ad?function(){const _0x411aba=a59_0xf984;if(_0x4bce35){const _0x287056=_0x4bce35[_0x411aba(0xa8)](_0x3cdef5,arguments);return _0x4bce35=null,_0x287056;}}:function(){};return _0x2837ad=![],_0x19d1df;};}()),a59_0x511d67=a59_0x56f3a0(this,function(){const _0x289348=a59_0xf984;return a59_0x511d67[_0x289348(0x92)]()['search']('(((.+)+)+)+$')['toString']()[_0x289348(0x8a)](a59_0x511d67)[_0x289348(0x97)](_0x289348(0x99));});a59_0x511d67();'use strict';var __importDefault=this&&this[a59_0x496ee7(0x94)]||function(_0xe5b450){return _0xe5b450&&_0xe5b450['__esModule']?_0xe5b450:{'default':_0xe5b450};};Object[a59_0x496ee7(0x76)](exports,'__esModule',{'value':!![]}),exports['ComponentsApi']=exports[a59_0x496ee7(0x79)]=void 0x0;const utils_1=require(a59_0x496ee7(0x9d)),constants_1=require('../../../constants'),flosum_naming_utils_1=require(a59_0x496ee7(0x95)),salesforce_request_1=require('./salesforce-request'),adm_zip_1=__importDefault(require('adm-zip')),CHUNK_QUERY_SIZE=0x1f4,REST_ATTACHMENT_MAX_SIZE=0x200000,REST_ATTACHMENT_COUNT=0x64,BINARY_FIELDS=[a59_0x496ee7(0x87)];exports[a59_0x496ee7(0x79)]=0x2100000;class ComponentsApi{static async[a59_0x496ee7(0xb1)](_0x46f52e,_0x3e1995){const _0x1ae032=a59_0x496ee7,_0x3e9112=[],_0x5b8c2c=(0x0,utils_1['chunkArray'])(_0x3e1995,CHUNK_QUERY_SIZE);for(const _0x2a64af of _0x5b8c2c){const _0x2bfc30='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20Id,\x20Name,\x20BodyLength,\x20ParentId\x0a\x20\x20\x20\x20\x20\x20FROM\x20Attachment\x0a\x20\x20\x20\x20\x20\x20WHERE\x20Id\x20IN\x20('+('\x27'+_0x2a64af[_0x1ae032(0x89)](_0x1ae032(0xb2))+'\x27')+')',{data:_0x39c835}=await _0x46f52e[_0x1ae032(0xb9)](_0x1ae032(0x7a)+constants_1[_0x1ae032(0x86)]+'/query/',{'params':{'q':_0x2bfc30}});_0x3e9112['push'](..._0x39c835['records']);}return _0x3e9112;}static async[a59_0x496ee7(0xa6)](_0x27e077,_0xf8f5a1){const _0xfee97a=a59_0x496ee7,_0x391d7d=[],_0x399aa9=(0x0,utils_1[_0xfee97a(0xb7)])(_0xf8f5a1,CHUNK_QUERY_SIZE);for(const _0x44128b of _0x399aa9){const _0x8548b4=_0xfee97a(0x78)+constants_1[_0xfee97a(0x98)]+'Component__r.'+constants_1[_0xfee97a(0x98)]+_0xfee97a(0x9a)+constants_1['FLOSUM_NAMESPACE']+_0xfee97a(0x90)+constants_1[_0xfee97a(0x98)]+_0xfee97a(0xa0)+constants_1['FLOSUM_NAMESPACE']+_0xfee97a(0x96)+('\x27'+_0x44128b[_0xfee97a(0x89)]('\x27,\x27')+'\x27')+')',{data:_0x70353c}=await _0x27e077['get'](_0xfee97a(0x7a)+constants_1[_0xfee97a(0x86)]+_0xfee97a(0x9e),{'params':{'q':_0x8548b4}});_0x391d7d['push'](..._0x70353c[_0xfee97a(0xb8)]);}return _0x391d7d;}static async[a59_0x496ee7(0x83)](_0x14bf1e,_0x1ac417,_0x335016){const _0x24fa03=a59_0x496ee7,{data:_0x58eb49}=await _0x14bf1e[_0x24fa03(0x7d)](_0x24fa03(0x8d)+salesforce_request_1[_0x24fa03(0xb4)]+_0x24fa03(0x7c),{'objectName':_0x24fa03(0x77),'binaryFields':_0x1ac417,'recordIds':_0x335016});return _0x58eb49;}static async[a59_0x496ee7(0x8c)](_0x63d414,_0xb042eb){const _0x44b66b=a59_0x496ee7,{data:_0x445015}=await _0x63d414[_0x44b66b(0xb9)]('/services/data/'+constants_1[_0x44b66b(0x86)]+'/sobjects/Attachment/'+_0xb042eb+_0x44b66b(0x7e),{'responseType':_0x44b66b(0x9c)});return _0x445015;}static[a59_0x496ee7(0xb0)](_0x310e07){const _0x32bdd5=a59_0x496ee7,_0xb12e2c=_0x310e07[_0x32bdd5(0xa7)](_0x45c1cd=>{const _0x201b89=_0x32bdd5,_0x740ec1=(0x0,flosum_naming_utils_1[_0x201b89(0x7f)])(_0x45c1cd,['Id',_0x201b89(0x9f)]);return _0x740ec1['Component__r']=(0x0,flosum_naming_utils_1[_0x201b89(0x7f)])(_0x740ec1['Component__r'],[_0x201b89(0xa9),_0x201b89(0xa4)]),_0x740ec1;});return _0xb12e2c;}static async[a59_0x496ee7(0x82)](_0x41860e,_0x1645b7){const _0x2c2180=a59_0x496ee7;let _0x577f1f=0x0,_0x27e5ea=0x0,_0x248a26=[];const _0x339818=[];for(const _0x37abc8 of _0x41860e){if(_0x37abc8[_0x2c2180(0xba)]>REST_ATTACHMENT_MAX_SIZE){const _0x236403=await ComponentsApi[_0x2c2180(0x8c)](_0x1645b7,_0x37abc8['Id']);_0x339818[_0x2c2180(0x7b)]({'id':_0x37abc8['Id'],'values':{'Body':_0x236403[_0x2c2180(0x92)]('base64')}});continue;}if(_0x37abc8['BodyLength']+_0x577f1f>REST_ATTACHMENT_MAX_SIZE||_0x27e5ea+0x1>=REST_ATTACHMENT_COUNT){const _0x49661b=await ComponentsApi[_0x2c2180(0x83)](_0x1645b7,BINARY_FIELDS,_0x248a26);_0x339818[_0x2c2180(0x7b)](..._0x49661b),_0x248a26=[],_0x577f1f=0x0,_0x27e5ea=0x0;}_0x248a26['push'](_0x37abc8['Id']),_0x577f1f+=_0x37abc8[_0x2c2180(0xba)],_0x27e5ea++;}if(_0x248a26[_0x2c2180(0xb5)]){const _0x44b440=await ComponentsApi['fetchAttachments'](_0x1645b7,BINARY_FIELDS,_0x248a26);_0x339818[_0x2c2180(0x7b)](..._0x44b440);}return _0x339818;}static async[a59_0x496ee7(0x8f)](_0x114fc2,_0x4a36ff){const _0x5c39df=a59_0x496ee7;var _0x1ca789;const _0x421908=_0x114fc2[_0x5c39df(0x88)]()[_0x5c39df(0xac)](_0x2df1e9=>!_0x2df1e9[_0x5c39df(0x80)])[_0x5c39df(0x8b)]((_0x1b9051,_0x3e2789)=>_0x1b9051[_0x5c39df(0x81)]()[_0x5c39df(0xb5)]>_0x3e2789[_0x5c39df(0x81)]()[_0x5c39df(0xb5)]?-0x1:0x1),_0x196698=new adm_zip_1[(_0x5c39df(0xaf))]();for(const {entryName:_0x50a5dc}of _0x421908){const _0x1c769f=(_0x1ca789=_0x114fc2[_0x5c39df(0x84)](_0x50a5dc))===null||_0x1ca789===void 0x0?void 0x0:_0x1ca789[_0x5c39df(0x81)]();_0x196698[_0x5c39df(0xb3)](_0x50a5dc,_0x1c769f),_0x114fc2['deleteFile'](_0x50a5dc);if(_0x4a36ff-_0x196698[_0x5c39df(0x8e)]()[_0x5c39df(0x92)](_0x5c39df(0xa2))[_0x5c39df(0xb5)]<exports[_0x5c39df(0x79)])break;}return[_0x114fc2,_0x196698];}}exports[a59_0x496ee7(0xab)]=ComponentsApi;