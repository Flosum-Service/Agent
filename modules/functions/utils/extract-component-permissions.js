'use strict';const a109_0x2f3ada=a109_0x453f;function a109_0x453f(_0x7c7698,_0x4374b3){const _0x1cafe0=a109_0x53ff();return a109_0x453f=function(_0x15b225,_0x47b3b6){_0x15b225=_0x15b225-0x8a;let _0x53ff28=_0x1cafe0[_0x15b225];return _0x53ff28;},a109_0x453f(_0x7c7698,_0x4374b3);}(function(_0x1ca4ee,_0x2241f3){const _0x365e38=a109_0x453f,_0x2538ab=_0x1ca4ee();while(!![]){try{const _0x16c8d6=-parseInt(_0x365e38(0xba))/0x1+-parseInt(_0x365e38(0xc8))/0x2+parseInt(_0x365e38(0x97))/0x3*(-parseInt(_0x365e38(0x8e))/0x4)+-parseInt(_0x365e38(0xaf))/0x5*(parseInt(_0x365e38(0xa9))/0x6)+-parseInt(_0x365e38(0x98))/0x7*(parseInt(_0x365e38(0xb1))/0x8)+-parseInt(_0x365e38(0x95))/0x9*(parseInt(_0x365e38(0xa7))/0xa)+parseInt(_0x365e38(0x9f))/0xb;if(_0x16c8d6===_0x2241f3)break;else _0x2538ab['push'](_0x2538ab['shift']());}catch(_0x4fc8f0){_0x2538ab['push'](_0x2538ab['shift']());}}}(a109_0x53ff,0x26686));Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a109_0x2f3ada(0x96)]=exports['extractComponentPermissions']=void 0x0;const xml_1=require('../../git/parsers/utils/xml'),xml2js_1=require(a109_0x2f3ada(0xad)),PERMISSIONS_MAP=new Map([[a109_0x2f3ada(0x90),a109_0x2f3ada(0x99)],[a109_0x2f3ada(0x8a),'apexPage'],[a109_0x2f3ada(0x9c),'tab'],[a109_0x2f3ada(0xc6),a109_0x2f3ada(0xbe)],[a109_0x2f3ada(0xb0),a109_0x2f3ada(0xb3)],[a109_0x2f3ada(0xbb),a109_0x2f3ada(0xa3)],[a109_0x2f3ada(0xae),'object'],[a109_0x2f3ada(0x9b),a109_0x2f3ada(0xa2)],[a109_0x2f3ada(0xc1),a109_0x2f3ada(0xa2)],[a109_0x2f3ada(0xab),a109_0x2f3ada(0xa5)],[a109_0x2f3ada(0x9e),'externalDataSource'],[a109_0x2f3ada(0xc4),a109_0x2f3ada(0xa2)],['flowAccesses',a109_0x2f3ada(0xb8)],[a109_0x2f3ada(0xc0),a109_0x2f3ada(0xca)],[a109_0x2f3ada(0xb2),a109_0x2f3ada(0x9a)],[a109_0x2f3ada(0xb5),a109_0x2f3ada(0xb9)]]);function a109_0x53ff(){const _0x4dcd8d=['tab','PermissionSet','layoutAssignments','customSettingAccesses','description','Builder','customPermissions','Xml','tabVisibilities','get','11394MHupJp','push','layout','pageAccesses','search','UTF-8','1.0','4rFVvYs','hasActivationRequired','classAccesses','userPermissions','parse','includes','some','477756ZzPwdS','mergeComponentPermissions','360399AxWikv','1488011TuKrwb','apexClass','recordType','customMetadataTypeAccesses','tabSettings','findIndex','externalDataSourceAccesses','10832712MIxXUB','Component_Name__c','custom','name','dataCategoryGroup','toString','application','Component__r','30EtuPGA','isArray','30DENQjg','label','applicationVisibilities','(((.+)+)+)+$','xml2js','objectPermissions','291865AXIXXP','profileActionOverrides','8QBrNMY','recordTypeVisibilities','content','loginIpRanges','fieldPermissions','constructor','apply','flow','field','37954uozySZ','categoryGroupVisibilities','Profile','http://soap.sforce.com/2006/04/metadata'];a109_0x53ff=function(){return _0x4dcd8d;};return a109_0x53ff();}var UNREMOVE_PERMISSION;(function(_0x3dda9b){const _0x28e72e=a109_0x2f3ada,_0x4b9eed=(function(){let _0x3e9176=!![];return function(_0x2530cd,_0x451a00){const _0x50069d=_0x3e9176?function(){const _0x548766=a109_0x453f;if(_0x451a00){const _0x313e3c=_0x451a00[_0x548766(0xb7)](_0x2530cd,arguments);return _0x451a00=null,_0x313e3c;}}:function(){};return _0x3e9176=![],_0x50069d;};}()),_0x1465d7=_0x4b9eed(this,function(){const _0x1a3885=a109_0x453f;return _0x1465d7['toString']()['search']('(((.+)+)+)+$')[_0x1a3885(0xa4)]()[_0x1a3885(0xb6)](_0x1465d7)[_0x1a3885(0x8b)](_0x1a3885(0xac));});_0x1465d7(),_0x3dda9b[_0x28e72e(0x8f)]='hasActivationRequired',_0x3dda9b[_0x28e72e(0xaa)]='label',_0x3dda9b['custom']=_0x28e72e(0xa1),_0x3dda9b[_0x28e72e(0xc2)]=_0x28e72e(0xc2);}(UNREMOVE_PERMISSION||(UNREMOVE_PERMISSION={})));const prepareDeleteComponent={'Profile':_0x3f6d0e=>{const _0x5a9215=a109_0x2f3ada;var _0x4f8a73,_0x2f917c;return(_0x4f8a73=_0x3f6d0e[_0x5a9215(0xbc)])===null||_0x4f8a73===void 0x0?!![]:delete _0x4f8a73['userPermissions'],(_0x2f917c=_0x3f6d0e[_0x5a9215(0xbc)])===null||_0x2f917c===void 0x0?!![]:delete _0x2f917c[_0x5a9215(0xb4)],_0x3f6d0e;},'PermissionSet':_0x566d61=>{const _0xb1e350=a109_0x2f3ada;var _0x339a40,_0x535e61;return(_0x339a40=_0x566d61['PermissionSet'])===null||_0x339a40===void 0x0?!![]:delete _0x339a40[_0xb1e350(0x91)],(_0x535e61=_0x566d61[_0xb1e350(0xbf)])===null||_0x535e61===void 0x0?!![]:delete _0x535e61['loginIpRanges'],_0x566d61;}};async function extractComponentPermissions(_0x1c7b58,_0x45c579,_0x9818f2){const _0x102536=a109_0x2f3ada,_0x28b1e0=await getReadyComponent(_0x1c7b58,_0x9818f2),_0x3db8ec=_0x28b1e0[_0x9818f2];if(!_0x3db8ec)return _0x28b1e0;for(const _0x28709e in _0x3db8ec){if(UNREMOVE_PERMISSION[_0x28709e])continue;const _0x301d9a=_0x3db8ec[_0x28709e],_0x132458=getValidPermission(_0x301d9a,_0x28709e,_0x45c579);_0x132458['length']?_0x3db8ec[_0x28709e]=_0x132458:delete _0x3db8ec[_0x28709e];}return _0x28b1e0[_0x9818f2]['$']={'xmlns':_0x102536(0xbd)},_0x28b1e0;}exports['extractComponentPermissions']=extractComponentPermissions;async function mergeComponentPermissions(_0x421551,_0x1bb34c,_0x36b3c3){const _0x199ba0=a109_0x2f3ada,_0x4c83c8=await xml_1[_0x199ba0(0xc5)][_0x199ba0(0x92)](_0x421551),_0x4d8b70=await xml_1[_0x199ba0(0xc5)][_0x199ba0(0x92)](_0x1bb34c),_0x1754c4=_0x4c83c8[_0x36b3c3],_0x3f902d=_0x4d8b70[_0x36b3c3];if(!_0x1754c4)return _0x1bb34c;for(const _0x5d09cc in _0x1754c4){const _0x4e5e1d=PERMISSIONS_MAP['get'](_0x5d09cc);if(!_0x4e5e1d||!_0x3f902d[_0x5d09cc]){_0x3f902d[_0x5d09cc]=_0x1754c4[_0x5d09cc];continue;}for(const _0x230e26 of _0x1754c4[_0x5d09cc]){const _0x3625ac=_0x3f902d[_0x5d09cc][_0x199ba0(0x9d)](_0x2e66d6=>_0x230e26[_0x4e5e1d][0x0]===_0x2e66d6[_0x4e5e1d][0x0]);_0x3625ac!==-0x1?_0x3f902d[_0x5d09cc][_0x3625ac]=_0x230e26:_0x3f902d[_0x5d09cc][_0x199ba0(0xc9)](_0x230e26);}}_0x4d8b70[_0x36b3c3]['$']={'xmlns':_0x199ba0(0xbd)};const _0x26f0f3=new xml2js_1[(_0x199ba0(0xc3))]({'xmldec':{'version':_0x199ba0(0x8d),'encoding':_0x199ba0(0x8c)}});return _0x26f0f3['buildObject'](_0x4d8b70);}exports['mergeComponentPermissions']=mergeComponentPermissions;function getValidPermission(_0x11bd59,_0x18796d,_0x50b1d5){const _0x32b834=a109_0x2f3ada;let _0x43d4cb=[];if(_0x18796d===_0x32b834(0xc0))_0x43d4cb=getValidLayout(_0x11bd59,_0x18796d,_0x50b1d5);else{const _0x1a2407=Array[_0x32b834(0xa8)](_0x11bd59)?_0x11bd59:[_0x11bd59];for(const _0x37a36f of _0x1a2407){isValidPermission(_0x37a36f,_0x18796d,_0x50b1d5)&&_0x43d4cb['push'](_0x37a36f);}}return _0x43d4cb;}function isValidPermission(_0xec6c38,_0x595632,_0x354e04){const _0x5a61cf=a109_0x2f3ada,_0x320da2=PERMISSIONS_MAP[_0x5a61cf(0xc7)](_0x595632);return _0xec6c38[_0x320da2]&&_0x354e04[_0x5a61cf(0x94)](_0x241ba8=>_0x241ba8[_0x5a61cf(0xa6)][_0x5a61cf(0xa0)][_0x5a61cf(0x93)](_0xec6c38[_0x320da2]));}function getValidLayout(_0x1ecfad,_0x49d997,_0x1aaf8c){const _0x237d3c=a109_0x2f3ada,_0x56bea8=[],_0x5282c0=Array[_0x237d3c(0xa8)](_0x1ecfad)?_0x1ecfad:[_0x1ecfad];for(const _0x5df336 in _0x5282c0){isValidPermission(_0x5282c0[_0x5df336],_0x49d997,_0x1aaf8c)&&(!_0x5282c0[_0x5df336][_0x237d3c(0x9a)]&&_0x56bea8['push'](_0x5282c0[_0x5df336]),isValidPermission(_0x5282c0[_0x5df336],_0x237d3c(0xb2),_0x1aaf8c)&&_0x56bea8[_0x237d3c(0xc9)](_0x5282c0[_0x5df336]));}return _0x56bea8;}async function getReadyComponent(_0x114da9,_0x3dfa74){const _0x192db6=a109_0x2f3ada,_0x13709b=await xml_1['Xml'][_0x192db6(0x92)](_0x114da9);return prepareDeleteComponent[_0x3dfa74](_0x13709b);}