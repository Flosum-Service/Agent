function a258_0xcb76(){const _0x804858=['MaskingService','completedDate','5573827vvWYEf','defineProperty','1878jXOjfZ','parse','FsUtils','search','@flosum/utils','(((.+)+)+)+$','filterExpiredJobs','900848PTRpNp','1044731lJQWwQ','utf-8','../../shared/utils/job.utils','name','getJobCompletedDate','Logger','push','1381360rZnpgf','toString','DataMaskingRetentionPolicy','__esModule','20PQddiv','isExpiredDate','readFile','maskingFolderPath','apply','path','join','../../../constants/job','__importDefault','../../../core','execute','getTime','logger','JOB_LOG_STATE_FILENAME','EXPIRED_RANGE_DATE','4658454mWORpU','8eqyBCF','default','deleteJob','../../data-masking/services/masking.service','fs/promises','22236hWqEWl','8610GKpdvf'];a258_0xcb76=function(){return _0x804858;};return a258_0xcb76();}function a258_0x8d70(_0x507dc4,_0x434b87){const _0x240936=a258_0xcb76();return a258_0x8d70=function(_0x3348b6,_0x3cf4af){_0x3348b6=_0x3348b6-0x7d;let _0xcb76c7=_0x240936[_0x3348b6];return _0xcb76c7;},a258_0x8d70(_0x507dc4,_0x434b87);}const a258_0x4661ee=a258_0x8d70;(function(_0x38e8e0,_0x1c8406){const _0x4414bc=a258_0x8d70,_0x4ee2a8=_0x38e8e0();while(!![]){try{const _0x470fc7=-parseInt(_0x4414bc(0x7f))/0x1+parseInt(_0x4414bc(0x7e))/0x2+parseInt(_0x4414bc(0x9f))/0x3+parseInt(_0x4414bc(0x86))/0x4+-parseInt(_0x4414bc(0xa0))/0x5*(-parseInt(_0x4414bc(0xa5))/0x6)+-parseInt(_0x4414bc(0xa3))/0x7*(parseInt(_0x4414bc(0x9a))/0x8)+-parseInt(_0x4414bc(0x99))/0x9*(-parseInt(_0x4414bc(0x8a))/0xa);if(_0x470fc7===_0x1c8406)break;else _0x4ee2a8['push'](_0x4ee2a8['shift']());}catch(_0x11167a){_0x4ee2a8['push'](_0x4ee2a8['shift']());}}}(a258_0xcb76,0x82f3e));const a258_0x3cf4af=(function(){let _0x260f08=!![];return function(_0x1d0160,_0x51c8b0){const _0x3a47c0=_0x260f08?function(){const _0x3af63e=a258_0x8d70;if(_0x51c8b0){const _0xdad60=_0x51c8b0[_0x3af63e(0x8e)](_0x1d0160,arguments);return _0x51c8b0=null,_0xdad60;}}:function(){};return _0x260f08=![],_0x3a47c0;};}()),a258_0x3348b6=a258_0x3cf4af(this,function(){const _0x57ba6d=a258_0x8d70;return a258_0x3348b6[_0x57ba6d(0x87)]()['search'](_0x57ba6d(0xaa))[_0x57ba6d(0x87)]()['constructor'](a258_0x3348b6)[_0x57ba6d(0xa8)]('(((.+)+)+)+$');});a258_0x3348b6();'use strict';var __importDefault=this&&this[a258_0x4661ee(0x92)]||function(_0x36e60f){const _0x46aa13=a258_0x4661ee;return _0x36e60f&&_0x36e60f[_0x46aa13(0x89)]?_0x36e60f:{'default':_0x36e60f};};Object[a258_0x4661ee(0xa4)](exports,a258_0x4661ee(0x89),{'value':!![]}),exports[a258_0x4661ee(0x88)]=void 0x0;const promises_1=require(a258_0x4661ee(0x9e)),core_1=require(a258_0x4661ee(0x93)),utils_1=require(a258_0x4661ee(0xa9)),job_1=require(a258_0x4661ee(0x91)),job_utils_1=__importDefault(require(a258_0x4661ee(0x81))),masking_service_1=require(a258_0x4661ee(0x9d)),path_1=__importDefault(require(a258_0x4661ee(0x8f)));class DataMaskingRetentionPolicy{constructor(){const _0x5db30d=a258_0x4661ee;this[_0x5db30d(0x98)]=0x9a7ec800,this[_0x5db30d(0x96)]=new core_1[(_0x5db30d(0x84))](DataMaskingRetentionPolicy[_0x5db30d(0x82)]);}async[a258_0x4661ee(0x94)](){const _0x1ad7f0=a258_0x4661ee;try{const _0x2d9eeb=await job_utils_1['default']['getJobsIds'](masking_service_1[_0x1ad7f0(0xa1)][_0x1ad7f0(0x8d)]),_0x32d299=await this[_0x1ad7f0(0x7d)](_0x2d9eeb);for(const _0x125f7b of _0x32d299){await this[_0x1ad7f0(0x9c)](_0x125f7b);}}catch(_0x49d41b){this[_0x1ad7f0(0x96)]['error'](_0x49d41b);}}async['filterExpiredJobs'](_0x1a2f05){const _0x167feb=a258_0x4661ee,_0x4716b8=[];for(const _0x9c0a0c of _0x1a2f05){const _0x129590=await this[_0x167feb(0x83)](_0x9c0a0c),_0x183fbd=_0x129590&&this['isExpiredDate'](_0x129590);_0x183fbd&&_0x4716b8[_0x167feb(0x85)](_0x9c0a0c);}return _0x4716b8;}async['getJobCompletedDate'](_0x3651f0){const _0x5c4104=a258_0x4661ee;var _0x1fd8e0;const _0x1c2d40=path_1['default'][_0x5c4104(0x90)](masking_service_1[_0x5c4104(0xa1)][_0x5c4104(0x8d)],_0x3651f0,job_1[_0x5c4104(0x97)]);if(!await utils_1[_0x5c4104(0xa7)]['isExistsPath'](_0x1c2d40))return null;const _0x158370=await(0x0,promises_1[_0x5c4104(0x8c)])(_0x1c2d40,{'encoding':_0x5c4104(0x80)});return(_0x1fd8e0=JSON[_0x5c4104(0xa6)](_0x158370)[_0x5c4104(0xa2)])!==null&&_0x1fd8e0!==void 0x0?_0x1fd8e0:null;}[a258_0x4661ee(0x8b)](_0xdbc5e6){const _0x9f60d8=a258_0x4661ee;return new Date()[_0x9f60d8(0x95)]()-_0xdbc5e6>this[_0x9f60d8(0x98)];}[a258_0x4661ee(0x9c)](_0xa44d34){const _0x2aa891=a258_0x4661ee,_0x3d3a55=path_1[_0x2aa891(0x9b)]['join'](masking_service_1['MaskingService'][_0x2aa891(0x8d)],_0xa44d34);return(0x0,promises_1['rm'])(_0x3d3a55,{'recursive':!![],'force':!![]});}}exports[a258_0x4661ee(0x88)]=DataMaskingRetentionPolicy;