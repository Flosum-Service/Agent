const a279_0x37832a=a279_0x5b95;function a279_0x14f2(){const _0x51062c=['../../shared/utils/job.utils','toString','constructor','isExistsPath','isExpiredDate','EXPIRED_RANGE_DATE','42WYUiTt','getJobCompletedDate','__importDefault','apply','parse','default','defineProperty','utf-8','8tTwfbc','search','19700730xmiyto','maskingFolderPath','2818845oUwHTs','readFile','../../../constants/job','execute','../../data-masking/services/masking.service','error','name','DataMaskingRetentionPolicy','join','(((.+)+)+)+$','MaskingService','8305443lVANDO','deleteJob','FsUtils','completedDate','6woOonw','fs/promises','__esModule','logger','JOB_LOG_STATE_FILENAME','path','3321816ZXulsr','859806tBIjKK','8228353goYIQg','64272iFtMGc','filterExpiredJobs','@flosum/utils','Logger'];a279_0x14f2=function(){return _0x51062c;};return a279_0x14f2();}(function(_0x75ab4a,_0x4eedfa){const _0x3794fb=a279_0x5b95,_0x2fb8a8=_0x75ab4a();while(!![]){try{const _0x4a056f=-parseInt(_0x3794fb(0x1c8))/0x1+-parseInt(_0x3794fb(0x1d4))/0x2*(parseInt(_0x3794fb(0x1ca))/0x3)+-parseInt(_0x3794fb(0x1c7))/0x4+parseInt(_0x3794fb(0x1b2))/0x5+parseInt(_0x3794fb(0x1c1))/0x6*(parseInt(_0x3794fb(0x1c9))/0x7)+parseInt(_0x3794fb(0x1ae))/0x8*(-parseInt(_0x3794fb(0x1bd))/0x9)+parseInt(_0x3794fb(0x1b0))/0xa;if(_0x4a056f===_0x4eedfa)break;else _0x2fb8a8['push'](_0x2fb8a8['shift']());}catch(_0x21600f){_0x2fb8a8['push'](_0x2fb8a8['shift']());}}}(a279_0x14f2,0x9dcba));const a279_0x5ec305=(function(){let _0x2c01de=!![];return function(_0x2604b0,_0x37de9f){const _0x286616=_0x2c01de?function(){const _0x55aa19=a279_0x5b95;if(_0x37de9f){const _0x3fd31f=_0x37de9f[_0x55aa19(0x1d7)](_0x2604b0,arguments);return _0x37de9f=null,_0x3fd31f;}}:function(){};return _0x2c01de=![],_0x286616;};}()),a279_0x4d4469=a279_0x5ec305(this,function(){const _0x5dd132=a279_0x5b95;return a279_0x4d4469[_0x5dd132(0x1cf)]()[_0x5dd132(0x1af)](_0x5dd132(0x1bb))[_0x5dd132(0x1cf)]()[_0x5dd132(0x1d0)](a279_0x4d4469)['search'](_0x5dd132(0x1bb));});a279_0x4d4469();'use strict';function a279_0x5b95(_0x89b031,_0x6da16a){const _0x13bfc1=a279_0x14f2();return a279_0x5b95=function(_0x4d4469,_0x5ec305){_0x4d4469=_0x4d4469-0x1ae;let _0x14f286=_0x13bfc1[_0x4d4469];return _0x14f286;},a279_0x5b95(_0x89b031,_0x6da16a);}var __importDefault=this&&this[a279_0x37832a(0x1d6)]||function(_0x3aa004){const _0x4485d0=a279_0x37832a;return _0x3aa004&&_0x3aa004[_0x4485d0(0x1c3)]?_0x3aa004:{'default':_0x3aa004};};Object[a279_0x37832a(0x1da)](exports,a279_0x37832a(0x1c3),{'value':!![]}),exports[a279_0x37832a(0x1b9)]=void 0x0;const promises_1=require(a279_0x37832a(0x1c2)),core_1=require('../../../core'),utils_1=require(a279_0x37832a(0x1cc)),job_1=require(a279_0x37832a(0x1b4)),job_utils_1=__importDefault(require(a279_0x37832a(0x1ce))),masking_service_1=require(a279_0x37832a(0x1b6)),path_1=__importDefault(require(a279_0x37832a(0x1c6)));class DataMaskingRetentionPolicy{constructor(){const _0x151077=a279_0x37832a;this['EXPIRED_RANGE_DATE']=0x9a7ec800,this[_0x151077(0x1c4)]=new core_1[(_0x151077(0x1cd))](DataMaskingRetentionPolicy[_0x151077(0x1b8)]);}async[a279_0x37832a(0x1b5)](){const _0x143a8b=a279_0x37832a;try{const _0x2ea23c=await job_utils_1[_0x143a8b(0x1d9)]['getJobsIds'](masking_service_1[_0x143a8b(0x1bc)][_0x143a8b(0x1b1)]),_0x4de54d=await this[_0x143a8b(0x1cb)](_0x2ea23c);for(const _0x5b50b3 of _0x4de54d){await this[_0x143a8b(0x1be)](_0x5b50b3);}}catch(_0x47ed52){this[_0x143a8b(0x1c4)][_0x143a8b(0x1b7)](_0x47ed52);}}async[a279_0x37832a(0x1cb)](_0xa17c40){const _0x4365e9=a279_0x37832a,_0x271419=[];for(const _0xea07f3 of _0xa17c40){const _0x2133d7=await this[_0x4365e9(0x1d5)](_0xea07f3),_0x4b9167=_0x2133d7&&this[_0x4365e9(0x1d2)](_0x2133d7);_0x4b9167&&_0x271419['push'](_0xea07f3);}return _0x271419;}async['getJobCompletedDate'](_0x114545){const _0x3a2189=a279_0x37832a;var _0x325e49;const _0x1c5cab=path_1[_0x3a2189(0x1d9)][_0x3a2189(0x1ba)](masking_service_1[_0x3a2189(0x1bc)][_0x3a2189(0x1b1)],_0x114545,job_1[_0x3a2189(0x1c5)]);if(!await utils_1[_0x3a2189(0x1bf)][_0x3a2189(0x1d1)](_0x1c5cab))return null;const _0x1a46fe=await(0x0,promises_1[_0x3a2189(0x1b3)])(_0x1c5cab,{'encoding':_0x3a2189(0x1db)});return(_0x325e49=JSON[_0x3a2189(0x1d8)](_0x1a46fe)[_0x3a2189(0x1c0)])!==null&&_0x325e49!==void 0x0?_0x325e49:null;}[a279_0x37832a(0x1d2)](_0x10fb6d){const _0x5a2b22=a279_0x37832a;return new Date()['getTime']()-_0x10fb6d>this[_0x5a2b22(0x1d3)];}['deleteJob'](_0x3b1242){const _0x4cd8f2=a279_0x37832a,_0x2a6f68=path_1['default']['join'](masking_service_1[_0x4cd8f2(0x1bc)][_0x4cd8f2(0x1b1)],_0x3b1242);return(0x0,promises_1['rm'])(_0x2a6f68,{'recursive':!![],'force':!![]});}}exports[a279_0x37832a(0x1b9)]=DataMaskingRetentionPolicy;