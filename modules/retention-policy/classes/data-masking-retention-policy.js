const a296_0x558665=a296_0x3834;function a296_0x41e5(){const _0x175621=['347166BDCvDa','join','DataMaskingRetentionPolicy','FsUtils','parse','toString','20783KFYzwA','error','deleteJob','search','../../data-masking/services/masking.service','name','1060623iCaQDF','../../../constants/job','apply','../../shared/utils/job.utils','@flosum/utils','616oimSVH','73240VSachx','2707815SqHWVM','completedDate','constructor','948ZdigHv','944070EPDfVT','8bDLVww','isExpiredDate','EXPIRED_RANGE_DATE','__esModule','default','maskingFolderPath','getTime','logger','filterExpiredJobs','path','MaskingService','Logger','../../../core','JOB_LOG_STATE_FILENAME','getJobCompletedDate','readFile','push','fs/promises','363uHvprm','6952BgYVkB','getJobsIds','execute'];a296_0x41e5=function(){return _0x175621;};return a296_0x41e5();}(function(_0x297b13,_0xb3c4ab){const _0x2ae851=a296_0x3834,_0x1f79f2=_0x297b13();while(!![]){try{const _0x2ebab7=-parseInt(_0x2ae851(0xdb))/0x1+parseInt(_0x2ae851(0xf2))/0x2+-parseInt(_0x2ae851(0xd7))/0x3*(parseInt(_0x2ae851(0xd8))/0x4)+parseInt(_0x2ae851(0xee))/0x5+-parseInt(_0x2ae851(0xf1))/0x6*(parseInt(_0x2ae851(0xe1))/0x7)+parseInt(_0x2ae851(0xf3))/0x8*(-parseInt(_0x2ae851(0xe7))/0x9)+-parseInt(_0x2ae851(0xed))/0xa*(-parseInt(_0x2ae851(0xec))/0xb);if(_0x2ebab7===_0xb3c4ab)break;else _0x1f79f2['push'](_0x1f79f2['shift']());}catch(_0x4e6a50){_0x1f79f2['push'](_0x1f79f2['shift']());}}}(a296_0x41e5,0x44321));function a296_0x3834(_0x33aa0a,_0x506674){const _0x2584ea=a296_0x41e5();return a296_0x3834=function(_0x3bce09,_0x585c5f){_0x3bce09=_0x3bce09-0xca;let _0x41e5cf=_0x2584ea[_0x3bce09];return _0x41e5cf;},a296_0x3834(_0x33aa0a,_0x506674);}const a296_0x585c5f=(function(){let _0x110122=!![];return function(_0x15fead,_0x431959){const _0x384276=_0x110122?function(){const _0xa044a6=a296_0x3834;if(_0x431959){const _0x39776d=_0x431959[_0xa044a6(0xe9)](_0x15fead,arguments);return _0x431959=null,_0x39776d;}}:function(){};return _0x110122=![],_0x384276;};}()),a296_0x3bce09=a296_0x585c5f(this,function(){const _0x4997a3=a296_0x3834;return a296_0x3bce09[_0x4997a3(0xe0)]()[_0x4997a3(0xe4)]('(((.+)+)+)+$')[_0x4997a3(0xe0)]()[_0x4997a3(0xf0)](a296_0x3bce09)[_0x4997a3(0xe4)]('(((.+)+)+)+$');});a296_0x3bce09();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x594ffc){const _0x3ca759=a296_0x3834;return _0x594ffc&&_0x594ffc[_0x3ca759(0xf6)]?_0x594ffc:{'default':_0x594ffc};};Object['defineProperty'](exports,a296_0x558665(0xf6),{'value':!![]}),exports[a296_0x558665(0xdd)]=void 0x0;const promises_1=require(a296_0x558665(0xd6)),core_1=require(a296_0x558665(0xd1)),utils_1=require(a296_0x558665(0xeb)),job_1=require(a296_0x558665(0xe8)),job_utils_1=__importDefault(require(a296_0x558665(0xea))),masking_service_1=require(a296_0x558665(0xe5)),path_1=__importDefault(require(a296_0x558665(0xce)));class DataMaskingRetentionPolicy{constructor(){const _0x1f9e88=a296_0x558665;this['EXPIRED_RANGE_DATE']=0x9a7ec800,this[_0x1f9e88(0xcc)]=new core_1[(_0x1f9e88(0xd0))](DataMaskingRetentionPolicy[_0x1f9e88(0xe6)]);}async[a296_0x558665(0xda)](){const _0x9793c3=a296_0x558665;try{const _0x338338=await job_utils_1[_0x9793c3(0xf7)][_0x9793c3(0xd9)](masking_service_1['MaskingService'][_0x9793c3(0xca)]),_0x3fcddd=await this[_0x9793c3(0xcd)](_0x338338);for(const _0x1cba1f of _0x3fcddd){await this[_0x9793c3(0xe3)](_0x1cba1f);}}catch(_0x376117){this['logger'][_0x9793c3(0xe2)](_0x376117);}}async['filterExpiredJobs'](_0x2dd348){const _0x1fe61a=a296_0x558665,_0x2a2fa8=[];for(const _0x1c6e2d of _0x2dd348){const _0x1ddb8e=await this[_0x1fe61a(0xd3)](_0x1c6e2d),_0x226af7=_0x1ddb8e&&this[_0x1fe61a(0xf4)](_0x1ddb8e);_0x226af7&&_0x2a2fa8[_0x1fe61a(0xd5)](_0x1c6e2d);}return _0x2a2fa8;}async[a296_0x558665(0xd3)](_0x3be2d0){const _0x2e9325=a296_0x558665;var _0x88d373;const _0x3e84ed=path_1[_0x2e9325(0xf7)][_0x2e9325(0xdc)](masking_service_1['MaskingService'][_0x2e9325(0xca)],_0x3be2d0,job_1[_0x2e9325(0xd2)]);if(!await utils_1[_0x2e9325(0xde)]['isExistsPath'](_0x3e84ed))return null;const _0x12af76=await(0x0,promises_1[_0x2e9325(0xd4)])(_0x3e84ed,{'encoding':'utf-8'});return(_0x88d373=JSON[_0x2e9325(0xdf)](_0x12af76)[_0x2e9325(0xef)])!==null&&_0x88d373!==void 0x0?_0x88d373:null;}[a296_0x558665(0xf4)](_0x59628b){const _0x33b634=a296_0x558665;return new Date()[_0x33b634(0xcb)]()-_0x59628b>this[_0x33b634(0xf5)];}[a296_0x558665(0xe3)](_0x1e5718){const _0x3e8078=a296_0x558665,_0x4a8c47=path_1[_0x3e8078(0xf7)][_0x3e8078(0xdc)](masking_service_1[_0x3e8078(0xcf)][_0x3e8078(0xca)],_0x1e5718);return(0x0,promises_1['rm'])(_0x4a8c47,{'recursive':!![],'force':!![]});}}exports[a296_0x558665(0xdd)]=DataMaskingRetentionPolicy;