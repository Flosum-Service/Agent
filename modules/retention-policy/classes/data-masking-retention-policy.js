const a296_0x3f06f2=a296_0x4e67;(function(_0x35b038,_0x1e41ba){const _0x4f463b=a296_0x4e67,_0x27c3c3=_0x35b038();while(!![]){try{const _0xb2ca96=-parseInt(_0x4f463b(0x199))/0x1*(-parseInt(_0x4f463b(0x18b))/0x2)+-parseInt(_0x4f463b(0x17b))/0x3*(-parseInt(_0x4f463b(0x19b))/0x4)+parseInt(_0x4f463b(0x177))/0x5*(-parseInt(_0x4f463b(0x17f))/0x6)+-parseInt(_0x4f463b(0x19a))/0x7+parseInt(_0x4f463b(0x188))/0x8*(-parseInt(_0x4f463b(0x184))/0x9)+-parseInt(_0x4f463b(0x18f))/0xa+-parseInt(_0x4f463b(0x189))/0xb*(-parseInt(_0x4f463b(0x183))/0xc);if(_0xb2ca96===_0x1e41ba)break;else _0x27c3c3['push'](_0x27c3c3['shift']());}catch(_0x34d9b9){_0x27c3c3['push'](_0x27c3c3['shift']());}}}(a296_0x5664,0xd87a4));function a296_0x4e67(_0x122fdb,_0x477d0e){const _0xc08545=a296_0x5664();return a296_0x4e67=function(_0xbb16fb,_0x533e22){_0xbb16fb=_0xbb16fb-0x173;let _0x566453=_0xc08545[_0xbb16fb];return _0x566453;},a296_0x4e67(_0x122fdb,_0x477d0e);}const a296_0x533e22=(function(){let _0x4631cc=!![];return function(_0x2ec748,_0x5a76cd){const _0x45a84c=_0x4631cc?function(){const _0x58a6e8=a296_0x4e67;if(_0x5a76cd){const _0x51ae0d=_0x5a76cd[_0x58a6e8(0x19d)](_0x2ec748,arguments);return _0x5a76cd=null,_0x51ae0d;}}:function(){};return _0x4631cc=![],_0x45a84c;};}()),a296_0xbb16fb=a296_0x533e22(this,function(){const _0x3bde4d=a296_0x4e67;return a296_0xbb16fb[_0x3bde4d(0x197)]()[_0x3bde4d(0x186)](_0x3bde4d(0x192))[_0x3bde4d(0x197)]()[_0x3bde4d(0x195)](a296_0xbb16fb)['search'](_0x3bde4d(0x192));});a296_0xbb16fb();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x30ce85){const _0x29b3ce=a296_0x4e67;return _0x30ce85&&_0x30ce85[_0x29b3ce(0x190)]?_0x30ce85:{'default':_0x30ce85};};Object[a296_0x3f06f2(0x18e)](exports,a296_0x3f06f2(0x190),{'value':!![]}),exports[a296_0x3f06f2(0x17e)]=void 0x0;const promises_1=require('fs/promises'),core_1=require(a296_0x3f06f2(0x194)),utils_1=require(a296_0x3f06f2(0x196)),job_1=require(a296_0x3f06f2(0x18a)),job_utils_1=__importDefault(require(a296_0x3f06f2(0x174))),masking_service_1=require(a296_0x3f06f2(0x193)),path_1=__importDefault(require(a296_0x3f06f2(0x191)));function a296_0x5664(){const _0x197587=['27tpvnbu','getTime','search','error','3247912DfgbCq','11OKruro','../../../constants/job','180ohnkmm','JOB_LOG_STATE_FILENAME','maskingFolderPath','defineProperty','5631020ynHFNv','__esModule','path','(((.+)+)+)+$','../../data-masking/services/masking.service','../../../core','constructor','@flosum/utils','toString','join','8629CtmaSb','459242ldpZaG','4ZoqCwm','isExpiredDate','apply','getJobsIds','EXPIRED_RANGE_DATE','parse','../../shared/utils/job.utils','execute','logger','3045665oXxQdV','isExistsPath','completedDate','filterExpiredJobs','1556754ovGdIv','default','Logger','DataMaskingRetentionPolicy','6cJZQrz','name','utf-8','push','24563664OLgHWd'];a296_0x5664=function(){return _0x197587;};return a296_0x5664();}class DataMaskingRetentionPolicy{constructor(){const _0x4f71a4=a296_0x3f06f2;this['EXPIRED_RANGE_DATE']=0x9a7ec800,this['logger']=new core_1[(_0x4f71a4(0x17d))](DataMaskingRetentionPolicy[_0x4f71a4(0x180)]);}async[a296_0x3f06f2(0x175)](){const _0x7575b8=a296_0x3f06f2;try{const _0x5b5698=await job_utils_1[_0x7575b8(0x17c)][_0x7575b8(0x19e)](masking_service_1['MaskingService'][_0x7575b8(0x18d)]),_0x35d639=await this[_0x7575b8(0x17a)](_0x5b5698);for(const _0x36ef8 of _0x35d639){await this['deleteJob'](_0x36ef8);}}catch(_0x2414c2){this[_0x7575b8(0x176)][_0x7575b8(0x187)](_0x2414c2);}}async[a296_0x3f06f2(0x17a)](_0x52557b){const _0x509cdb=a296_0x3f06f2,_0x179162=[];for(const _0x400b20 of _0x52557b){const _0x2af28a=await this['getJobCompletedDate'](_0x400b20),_0x396ae7=_0x2af28a&&this[_0x509cdb(0x19c)](_0x2af28a);_0x396ae7&&_0x179162[_0x509cdb(0x182)](_0x400b20);}return _0x179162;}async['getJobCompletedDate'](_0x40c599){const _0x245cf2=a296_0x3f06f2;var _0xd2ae69;const _0x293b2e=path_1[_0x245cf2(0x17c)][_0x245cf2(0x198)](masking_service_1['MaskingService'][_0x245cf2(0x18d)],_0x40c599,job_1[_0x245cf2(0x18c)]);if(!await utils_1['FsUtils'][_0x245cf2(0x178)](_0x293b2e))return null;const _0x329c00=await(0x0,promises_1['readFile'])(_0x293b2e,{'encoding':_0x245cf2(0x181)});return(_0xd2ae69=JSON[_0x245cf2(0x173)](_0x329c00)[_0x245cf2(0x179)])!==null&&_0xd2ae69!==void 0x0?_0xd2ae69:null;}[a296_0x3f06f2(0x19c)](_0x218872){const _0x2cccc0=a296_0x3f06f2;return new Date()[_0x2cccc0(0x185)]()-_0x218872>this[_0x2cccc0(0x19f)];}['deleteJob'](_0x477c8e){const _0x18c9ce=a296_0x3f06f2,_0x363452=path_1[_0x18c9ce(0x17c)]['join'](masking_service_1['MaskingService'][_0x18c9ce(0x18d)],_0x477c8e);return(0x0,promises_1['rm'])(_0x363452,{'recursive':!![],'force':!![]});}}exports['DataMaskingRetentionPolicy']=DataMaskingRetentionPolicy;