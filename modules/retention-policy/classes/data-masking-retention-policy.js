const a259_0xc1c8d3=a259_0x45d5;(function(_0x45ec89,_0x54851b){const _0x5c5b5f=a259_0x45d5,_0x1d863d=_0x45ec89();while(!![]){try{const _0x117b07=-parseInt(_0x5c5b5f(0x206))/0x1*(-parseInt(_0x5c5b5f(0x1f4))/0x2)+-parseInt(_0x5c5b5f(0x203))/0x3+parseInt(_0x5c5b5f(0x1f7))/0x4*(parseInt(_0x5c5b5f(0x20b))/0x5)+parseInt(_0x5c5b5f(0x1fa))/0x6+-parseInt(_0x5c5b5f(0x1f0))/0x7+-parseInt(_0x5c5b5f(0x20d))/0x8+parseInt(_0x5c5b5f(0x200))/0x9;if(_0x117b07===_0x54851b)break;else _0x1d863d['push'](_0x1d863d['shift']());}catch(_0x3dd2a1){_0x1d863d['push'](_0x1d863d['shift']());}}}(a259_0x97a4,0x59520));const a259_0x2aff15=(function(){let _0x5a0ebe=!![];return function(_0x15e6e9,_0x5aa99c){const _0x3f443d=_0x5a0ebe?function(){const _0x1b93f0=a259_0x45d5;if(_0x5aa99c){const _0xaae354=_0x5aa99c[_0x1b93f0(0x20c)](_0x15e6e9,arguments);return _0x5aa99c=null,_0xaae354;}}:function(){};return _0x5a0ebe=![],_0x3f443d;};}()),a259_0xef3c5f=a259_0x2aff15(this,function(){const _0x504048=a259_0x45d5;return a259_0xef3c5f[_0x504048(0x1f5)]()[_0x504048(0x217)]('(((.+)+)+)+$')[_0x504048(0x1f5)]()[_0x504048(0x212)](a259_0xef3c5f)[_0x504048(0x217)]('(((.+)+)+)+$');});a259_0xef3c5f();'use strict';function a259_0x45d5(_0x48477f,_0x52432f){const _0x44728b=a259_0x97a4();return a259_0x45d5=function(_0xef3c5f,_0x2aff15){_0xef3c5f=_0xef3c5f-0x1ef;let _0x97a4c1=_0x44728b[_0xef3c5f];return _0x97a4c1;},a259_0x45d5(_0x48477f,_0x52432f);}var __importDefault=this&&this[a259_0xc1c8d3(0x1f6)]||function(_0x2b1dd2){const _0x224a87=a259_0xc1c8d3;return _0x2b1dd2&&_0x2b1dd2[_0x224a87(0x20a)]?_0x2b1dd2:{'default':_0x2b1dd2};};Object[a259_0xc1c8d3(0x20f)](exports,a259_0xc1c8d3(0x20a),{'value':!![]}),exports['DataMaskingRetentionPolicy']=void 0x0;const promises_1=require(a259_0xc1c8d3(0x215)),core_1=require('../../../core'),utils_1=require(a259_0xc1c8d3(0x216)),job_1=require(a259_0xc1c8d3(0x1ff)),job_utils_1=__importDefault(require(a259_0xc1c8d3(0x1fe))),masking_service_1=require('../../data-masking/services/masking.service'),path_1=__importDefault(require(a259_0xc1c8d3(0x202)));class DataMaskingRetentionPolicy{constructor(){const _0x272bb9=a259_0xc1c8d3;this[_0x272bb9(0x207)]=0x9a7ec800,this[_0x272bb9(0x205)]=new core_1[(_0x272bb9(0x1f2))](DataMaskingRetentionPolicy[_0x272bb9(0x20e)]);}async[a259_0xc1c8d3(0x1f8)](){const _0x337a23=a259_0xc1c8d3;try{const _0x521528=await job_utils_1['default'][_0x337a23(0x218)](masking_service_1[_0x337a23(0x1f1)][_0x337a23(0x1fd)]),_0x4e5cba=await this['filterExpiredJobs'](_0x521528);for(const _0x1fc58d of _0x4e5cba){await this[_0x337a23(0x1fc)](_0x1fc58d);}}catch(_0x1e4e70){this[_0x337a23(0x205)]['error'](_0x1e4e70);}}async[a259_0xc1c8d3(0x214)](_0x4fa446){const _0x466bb5=a259_0xc1c8d3,_0x5a8513=[];for(const _0x11b2c7 of _0x4fa446){const _0x46a48f=await this['getJobCompletedDate'](_0x11b2c7),_0x5b72be=_0x46a48f&&this[_0x466bb5(0x1f9)](_0x46a48f);_0x5b72be&&_0x5a8513[_0x466bb5(0x210)](_0x11b2c7);}return _0x5a8513;}async['getJobCompletedDate'](_0xbd39a5){const _0x140b3d=a259_0xc1c8d3;var _0x30060a;const _0x3f3f7d=path_1[_0x140b3d(0x211)][_0x140b3d(0x209)](masking_service_1[_0x140b3d(0x1f1)][_0x140b3d(0x1fd)],_0xbd39a5,job_1[_0x140b3d(0x1fb)]);if(!await utils_1[_0x140b3d(0x204)][_0x140b3d(0x1ef)](_0x3f3f7d))return null;const _0x58a766=await(0x0,promises_1[_0x140b3d(0x208)])(_0x3f3f7d,{'encoding':'utf-8'});return(_0x30060a=JSON[_0x140b3d(0x1f3)](_0x58a766)[_0x140b3d(0x213)])!==null&&_0x30060a!==void 0x0?_0x30060a:null;}[a259_0xc1c8d3(0x1f9)](_0x49d393){const _0x122834=a259_0xc1c8d3;return new Date()[_0x122834(0x201)]()-_0x49d393>this[_0x122834(0x207)];}[a259_0xc1c8d3(0x1fc)](_0x1ae2f3){const _0x17560f=a259_0xc1c8d3,_0x2d885d=path_1[_0x17560f(0x211)]['join'](masking_service_1[_0x17560f(0x1f1)][_0x17560f(0x1fd)],_0x1ae2f3);return(0x0,promises_1['rm'])(_0x2d885d,{'recursive':!![],'force':!![]});}}function a259_0x97a4(){const _0x54e5f7=['Logger','parse','46FgjWaZ','toString','__importDefault','1953420JrHBNu','execute','isExpiredDate','2368212dOErBL','JOB_LOG_STATE_FILENAME','deleteJob','maskingFolderPath','../../shared/utils/job.utils','../../../constants/job','1059309gpvidk','getTime','path','1420293MjMlaJ','FsUtils','logger','7890rRImit','EXPIRED_RANGE_DATE','readFile','join','__esModule','5GrvsHb','apply','1428264GSyhbh','name','defineProperty','push','default','constructor','completedDate','filterExpiredJobs','fs/promises','@flosum/utils','search','getJobsIds','DataMaskingRetentionPolicy','isExistsPath','1150856cSimwu','MaskingService'];a259_0x97a4=function(){return _0x54e5f7;};return a259_0x97a4();}exports[a259_0xc1c8d3(0x219)]=DataMaskingRetentionPolicy;