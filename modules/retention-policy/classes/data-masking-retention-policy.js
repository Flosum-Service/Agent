const a307_0x7fc99c=a307_0x51d3;(function(_0x2a5058,_0x421adb){const _0x88456f=a307_0x51d3,_0x14b588=_0x2a5058();while(!![]){try{const _0x123d56=-parseInt(_0x88456f(0xbc))/0x1+-parseInt(_0x88456f(0xd2))/0x2+-parseInt(_0x88456f(0xc8))/0x3+parseInt(_0x88456f(0xb2))/0x4*(-parseInt(_0x88456f(0xba))/0x5)+-parseInt(_0x88456f(0xbe))/0x6+-parseInt(_0x88456f(0xcc))/0x7+parseInt(_0x88456f(0xbb))/0x8;if(_0x123d56===_0x421adb)break;else _0x14b588['push'](_0x14b588['shift']());}catch(_0x252d07){_0x14b588['push'](_0x14b588['shift']());}}}(a307_0x450d,0xdffad));const a307_0x4ce9a3=(function(){let _0x57d1e0=!![];return function(_0x332ead,_0x637348){const _0x2548a0=_0x57d1e0?function(){const _0x304c94=a307_0x51d3;if(_0x637348){const _0x34c0dd=_0x637348[_0x304c94(0xc5)](_0x332ead,arguments);return _0x637348=null,_0x34c0dd;}}:function(){};return _0x57d1e0=![],_0x2548a0;};}()),a307_0x3df5d6=a307_0x4ce9a3(this,function(){const _0x5d3d23=a307_0x51d3;return a307_0x3df5d6[_0x5d3d23(0xc3)]()[_0x5d3d23(0xb6)](_0x5d3d23(0xcd))[_0x5d3d23(0xc3)]()[_0x5d3d23(0xc4)](a307_0x3df5d6)['search'](_0x5d3d23(0xcd));});function a307_0x51d3(_0x563cbb,_0x16b8e2){const _0x265d27=a307_0x450d();return a307_0x51d3=function(_0x3df5d6,_0x4ce9a3){_0x3df5d6=_0x3df5d6-0xad;let _0x450d75=_0x265d27[_0x3df5d6];return _0x450d75;},a307_0x51d3(_0x563cbb,_0x16b8e2);}a307_0x3df5d6();'use strict';var __importDefault=this&&this[a307_0x7fc99c(0xd6)]||function(_0x40d56e){const _0x27bb27=a307_0x7fc99c;return _0x40d56e&&_0x40d56e[_0x27bb27(0xbd)]?_0x40d56e:{'default':_0x40d56e};};Object[a307_0x7fc99c(0xb7)](exports,a307_0x7fc99c(0xbd),{'value':!![]}),exports[a307_0x7fc99c(0xc0)]=void 0x0;const promises_1=require(a307_0x7fc99c(0xce)),core_1=require('../../../core'),utils_1=require(a307_0x7fc99c(0xca)),job_1=require(a307_0x7fc99c(0xd5)),job_utils_1=__importDefault(require(a307_0x7fc99c(0xcb))),masking_service_1=require(a307_0x7fc99c(0xd0)),path_1=__importDefault(require(a307_0x7fc99c(0xc2)));function a307_0x450d(){const _0x29dd20=['__importDefault','logger','utf-8','maskingFolderPath','parse','completedDate','deleteJob','Logger','EXPIRED_RANGE_DATE','1405840EzvAWT','MaskingService','isExpiredDate','filterExpiredJobs','search','defineProperty','readFile','isExistsPath','20SOYcru','76100640MHVOMe','1547027PEVqcP','__esModule','9147168wuQyTX','execute','DataMaskingRetentionPolicy','default','path','toString','constructor','apply','FsUtils','join','3845934XTrwFe','getJobsIds','@flosum/utils','../../shared/utils/job.utils','8066884FYXvSZ','(((.+)+)+)+$','fs/promises','push','../../data-masking/services/masking.service','JOB_LOG_STATE_FILENAME','3366748WHlHxo','name','getJobCompletedDate','../../../constants/job'];a307_0x450d=function(){return _0x29dd20;};return a307_0x450d();}class DataMaskingRetentionPolicy{constructor(){const _0x1d027c=a307_0x7fc99c;this[_0x1d027c(0xb1)]=0x9a7ec800,this[_0x1d027c(0xd7)]=new core_1[(_0x1d027c(0xb0))](DataMaskingRetentionPolicy[_0x1d027c(0xd3)]);}async[a307_0x7fc99c(0xbf)](){const _0xc9da2e=a307_0x7fc99c;try{const _0x4dd403=await job_utils_1['default'][_0xc9da2e(0xc9)](masking_service_1['MaskingService'][_0xc9da2e(0xd9)]),_0x36ac86=await this['filterExpiredJobs'](_0x4dd403);for(const _0x4bc3aa of _0x36ac86){await this['deleteJob'](_0x4bc3aa);}}catch(_0x555f6e){this['logger']['error'](_0x555f6e);}}async[a307_0x7fc99c(0xb5)](_0x340137){const _0x69f577=a307_0x7fc99c,_0x23a9fb=[];for(const _0x39ff1f of _0x340137){const _0x149f0d=await this[_0x69f577(0xd4)](_0x39ff1f),_0x77605f=_0x149f0d&&this[_0x69f577(0xb4)](_0x149f0d);_0x77605f&&_0x23a9fb[_0x69f577(0xcf)](_0x39ff1f);}return _0x23a9fb;}async[a307_0x7fc99c(0xd4)](_0x4f92d1){const _0x129182=a307_0x7fc99c;var _0x20bfdf;const _0x71fbe6=path_1[_0x129182(0xc1)]['join'](masking_service_1[_0x129182(0xb3)][_0x129182(0xd9)],_0x4f92d1,job_1[_0x129182(0xd1)]);if(!await utils_1[_0x129182(0xc6)][_0x129182(0xb9)](_0x71fbe6))return null;const _0x35ebb5=await(0x0,promises_1[_0x129182(0xb8)])(_0x71fbe6,{'encoding':_0x129182(0xd8)});return(_0x20bfdf=JSON[_0x129182(0xad)](_0x35ebb5)[_0x129182(0xae)])!==null&&_0x20bfdf!==void 0x0?_0x20bfdf:null;}[a307_0x7fc99c(0xb4)](_0x549262){const _0x5c6750=a307_0x7fc99c;return new Date()['getTime']()-_0x549262>this[_0x5c6750(0xb1)];}[a307_0x7fc99c(0xaf)](_0x5e3e70){const _0x261ec0=a307_0x7fc99c,_0x4bed74=path_1['default'][_0x261ec0(0xc7)](masking_service_1[_0x261ec0(0xb3)]['maskingFolderPath'],_0x5e3e70);return(0x0,promises_1['rm'])(_0x4bed74,{'recursive':!![],'force':!![]});}}exports[a307_0x7fc99c(0xc0)]=DataMaskingRetentionPolicy;