const a258_0x593d02=a258_0x1e17;(function(_0x10680b,_0x3628be){const _0x4c4d4f=a258_0x1e17,_0x2a39fc=_0x10680b();while(!![]){try{const _0x246343=parseInt(_0x4c4d4f(0x13e))/0x1+-parseInt(_0x4c4d4f(0x12a))/0x2+-parseInt(_0x4c4d4f(0x12d))/0x3+-parseInt(_0x4c4d4f(0x140))/0x4+parseInt(_0x4c4d4f(0x145))/0x5*(-parseInt(_0x4c4d4f(0x135))/0x6)+parseInt(_0x4c4d4f(0x151))/0x7+-parseInt(_0x4c4d4f(0x12e))/0x8*(-parseInt(_0x4c4d4f(0x139))/0x9);if(_0x246343===_0x3628be)break;else _0x2a39fc['push'](_0x2a39fc['shift']());}catch(_0x83ea00){_0x2a39fc['push'](_0x2a39fc['shift']());}}}(a258_0x3bf1,0xe8f49));const a258_0x2a2554=(function(){let _0x5e9e33=!![];return function(_0x2917ac,_0x3d22d0){const _0x52638b=_0x5e9e33?function(){const _0x5a1f47=a258_0x1e17;if(_0x3d22d0){const _0x1e890b=_0x3d22d0[_0x5a1f47(0x149)](_0x2917ac,arguments);return _0x3d22d0=null,_0x1e890b;}}:function(){};return _0x5e9e33=![],_0x52638b;};}()),a258_0x1b3f7d=a258_0x2a2554(this,function(){const _0xd442d=a258_0x1e17;return a258_0x1b3f7d[_0xd442d(0x13b)]()[_0xd442d(0x13c)](_0xd442d(0x12f))[_0xd442d(0x13b)]()[_0xd442d(0x13d)](a258_0x1b3f7d)[_0xd442d(0x13c)](_0xd442d(0x12f));});a258_0x1b3f7d();'use strict';var __importDefault=this&&this[a258_0x593d02(0x141)]||function(_0x178ca6){const _0x3a5611=a258_0x593d02;return _0x178ca6&&_0x178ca6[_0x3a5611(0x14a)]?_0x178ca6:{'default':_0x178ca6};};function a258_0x3bf1(){const _0x5b8be4=['11535720LsQrOw','completedDate','3350506DLLTbC','JOB_LOG_STATE_FILENAME','utf-8','327222GppmEC','758920vPcCfX','(((.+)+)+)+$','default','filterExpiredJobs','../../shared/utils/job.utils','deleteJob','maskingFolderPath','6MYHtdd','error','fs/promises','../../data-masking/services/masking.service','27AnCbJo','logger','toString','search','constructor','1098128VWzIAW','execute','395000pxeFvz','__importDefault','getJobsIds','Logger','name','967105KQqHko','push','MaskingService','isExpiredDate','apply','__esModule','FsUtils','join','../../../core','getJobCompletedDate','defineProperty','DataMaskingRetentionPolicy'];a258_0x3bf1=function(){return _0x5b8be4;};return a258_0x3bf1();}Object[a258_0x593d02(0x14f)](exports,'__esModule',{'value':!![]}),exports[a258_0x593d02(0x150)]=void 0x0;function a258_0x1e17(_0x1b921f,_0x565c36){const _0x1bf14c=a258_0x3bf1();return a258_0x1e17=function(_0x1b3f7d,_0x2a2554){_0x1b3f7d=_0x1b3f7d-0x12a;let _0x3bf1ac=_0x1bf14c[_0x1b3f7d];return _0x3bf1ac;},a258_0x1e17(_0x1b921f,_0x565c36);}const promises_1=require(a258_0x593d02(0x137)),core_1=require(a258_0x593d02(0x14d)),utils_1=require('@flosum/utils'),job_1=require('../../../constants/job'),job_utils_1=__importDefault(require(a258_0x593d02(0x132))),masking_service_1=require(a258_0x593d02(0x138)),path_1=__importDefault(require('path'));class DataMaskingRetentionPolicy{constructor(){const _0x36bbe3=a258_0x593d02;this['EXPIRED_RANGE_DATE']=0x9a7ec800,this[_0x36bbe3(0x13a)]=new core_1[(_0x36bbe3(0x143))](DataMaskingRetentionPolicy[_0x36bbe3(0x144)]);}async[a258_0x593d02(0x13f)](){const _0x2e0b2e=a258_0x593d02;try{const _0x50e82b=await job_utils_1[_0x2e0b2e(0x130)][_0x2e0b2e(0x142)](masking_service_1[_0x2e0b2e(0x147)]['maskingFolderPath']),_0x558259=await this[_0x2e0b2e(0x131)](_0x50e82b);for(const _0xb4744c of _0x558259){await this['deleteJob'](_0xb4744c);}}catch(_0xe89a2c){this[_0x2e0b2e(0x13a)][_0x2e0b2e(0x136)](_0xe89a2c);}}async[a258_0x593d02(0x131)](_0xec6d53){const _0x26b620=a258_0x593d02,_0x18661a=[];for(const _0x535aaf of _0xec6d53){const _0x35a7e3=await this['getJobCompletedDate'](_0x535aaf),_0x677e96=_0x35a7e3&&this['isExpiredDate'](_0x35a7e3);_0x677e96&&_0x18661a[_0x26b620(0x146)](_0x535aaf);}return _0x18661a;}async[a258_0x593d02(0x14e)](_0x21601b){const _0x236772=a258_0x593d02;var _0x1dd2fc;const _0x5464a0=path_1['default'][_0x236772(0x14c)](masking_service_1['MaskingService'][_0x236772(0x134)],_0x21601b,job_1[_0x236772(0x12b)]);if(!await utils_1[_0x236772(0x14b)]['isExistsPath'](_0x5464a0))return null;const _0x2ed98e=await(0x0,promises_1['readFile'])(_0x5464a0,{'encoding':_0x236772(0x12c)});return(_0x1dd2fc=JSON['parse'](_0x2ed98e)[_0x236772(0x152)])!==null&&_0x1dd2fc!==void 0x0?_0x1dd2fc:null;}[a258_0x593d02(0x148)](_0x2a4eff){return new Date()['getTime']()-_0x2a4eff>this['EXPIRED_RANGE_DATE'];}[a258_0x593d02(0x133)](_0x526953){const _0x1a5dd7=a258_0x593d02,_0x4980b8=path_1['default'][_0x1a5dd7(0x14c)](masking_service_1[_0x1a5dd7(0x147)][_0x1a5dd7(0x134)],_0x526953);return(0x0,promises_1['rm'])(_0x4980b8,{'recursive':!![],'force':!![]});}}exports['DataMaskingRetentionPolicy']=DataMaskingRetentionPolicy;