const a296_0x1e03e2=a296_0xeb96;(function(_0x1e80d8,_0x22718b){const _0x323085=a296_0xeb96,_0x1a147e=_0x1e80d8();while(!![]){try{const _0x292515=parseInt(_0x323085(0xb0))/0x1+parseInt(_0x323085(0xc1))/0x2+-parseInt(_0x323085(0xb8))/0x3+parseInt(_0x323085(0xba))/0x4+-parseInt(_0x323085(0xb6))/0x5*(parseInt(_0x323085(0xc3))/0x6)+-parseInt(_0x323085(0xb3))/0x7+-parseInt(_0x323085(0xaf))/0x8*(-parseInt(_0x323085(0xd7))/0x9);if(_0x292515===_0x22718b)break;else _0x1a147e['push'](_0x1a147e['shift']());}catch(_0x1f85e0){_0x1a147e['push'](_0x1a147e['shift']());}}}(a296_0x5b8a,0xdf68a));function a296_0xeb96(_0x4c8eb1,_0x3d74b5){const _0xa56f3c=a296_0x5b8a();return a296_0xeb96=function(_0x3b3678,_0x5e6814){_0x3b3678=_0x3b3678-0xae;let _0x5b8af5=_0xa56f3c[_0x3b3678];return _0x5b8af5;},a296_0xeb96(_0x4c8eb1,_0x3d74b5);}const a296_0x5e6814=(function(){let _0x3f85bc=!![];return function(_0x36894d,_0x3a0260){const _0x2f08c5=_0x3f85bc?function(){const _0x30920c=a296_0xeb96;if(_0x3a0260){const _0x1b109d=_0x3a0260[_0x30920c(0xd4)](_0x36894d,arguments);return _0x3a0260=null,_0x1b109d;}}:function(){};return _0x3f85bc=![],_0x2f08c5;};}()),a296_0x3b3678=a296_0x5e6814(this,function(){const _0x722067=a296_0xeb96;return a296_0x3b3678[_0x722067(0xb4)]()['search'](_0x722067(0xc7))[_0x722067(0xb4)]()['constructor'](a296_0x3b3678)[_0x722067(0xc5)](_0x722067(0xc7));});a296_0x3b3678();'use strict';function a296_0x5b8a(){const _0x432283=['fs/promises','getTime','DataMaskingRetentionPolicy','maskingFolderPath','apply','../../../core','logger','70047bjHOvo','completedDate','1208uJseaK','1169262OuSpPD','FsUtils','EXPIRED_RANGE_DATE','8772001FASARO','toString','../../../constants/job','2255kyBwvA','JOB_LOG_STATE_FILENAME','4567659rCipeH','default','4675576YJRlmR','getJobCompletedDate','path','Logger','isExistsPath','name','isExpiredDate','1640128KLRgZN','__esModule','8550eOdRyY','MaskingService','search','utf-8','(((.+)+)+)+$','join','error','filterExpiredJobs','deleteJob','execute','__importDefault','getJobsIds','parse'];a296_0x5b8a=function(){return _0x432283;};return a296_0x5b8a();}var __importDefault=this&&this[a296_0x1e03e2(0xcd)]||function(_0x4093a4){return _0x4093a4&&_0x4093a4['__esModule']?_0x4093a4:{'default':_0x4093a4};};Object['defineProperty'](exports,a296_0x1e03e2(0xc2),{'value':!![]}),exports[a296_0x1e03e2(0xd2)]=void 0x0;const promises_1=require(a296_0x1e03e2(0xd0)),core_1=require(a296_0x1e03e2(0xd5)),utils_1=require('@flosum/utils'),job_1=require(a296_0x1e03e2(0xb5)),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),masking_service_1=require('../../data-masking/services/masking.service'),path_1=__importDefault(require(a296_0x1e03e2(0xbc)));class DataMaskingRetentionPolicy{constructor(){const _0x5e7624=a296_0x1e03e2;this[_0x5e7624(0xb2)]=0x9a7ec800,this[_0x5e7624(0xd6)]=new core_1[(_0x5e7624(0xbd))](DataMaskingRetentionPolicy[_0x5e7624(0xbf)]);}async[a296_0x1e03e2(0xcc)](){const _0x175577=a296_0x1e03e2;try{const _0x40f3ad=await job_utils_1['default'][_0x175577(0xce)](masking_service_1[_0x175577(0xc4)][_0x175577(0xd3)]),_0x52287a=await this[_0x175577(0xca)](_0x40f3ad);for(const _0x3e1c80 of _0x52287a){await this[_0x175577(0xcb)](_0x3e1c80);}}catch(_0x579a1d){this['logger'][_0x175577(0xc9)](_0x579a1d);}}async[a296_0x1e03e2(0xca)](_0x12a524){const _0x17a481=a296_0x1e03e2,_0x427e46=[];for(const _0x369593 of _0x12a524){const _0x2bc85b=await this['getJobCompletedDate'](_0x369593),_0x344d71=_0x2bc85b&&this[_0x17a481(0xc0)](_0x2bc85b);_0x344d71&&_0x427e46['push'](_0x369593);}return _0x427e46;}async[a296_0x1e03e2(0xbb)](_0x1a62a4){const _0x507db9=a296_0x1e03e2;var _0x49d021;const _0x585580=path_1[_0x507db9(0xb9)][_0x507db9(0xc8)](masking_service_1[_0x507db9(0xc4)][_0x507db9(0xd3)],_0x1a62a4,job_1[_0x507db9(0xb7)]);if(!await utils_1[_0x507db9(0xb1)][_0x507db9(0xbe)](_0x585580))return null;const _0x46414a=await(0x0,promises_1['readFile'])(_0x585580,{'encoding':_0x507db9(0xc6)});return(_0x49d021=JSON[_0x507db9(0xcf)](_0x46414a)[_0x507db9(0xae)])!==null&&_0x49d021!==void 0x0?_0x49d021:null;}[a296_0x1e03e2(0xc0)](_0x2b0bf5){const _0x4e4a6f=a296_0x1e03e2;return new Date()[_0x4e4a6f(0xd1)]()-_0x2b0bf5>this[_0x4e4a6f(0xb2)];}[a296_0x1e03e2(0xcb)](_0x114188){const _0x388fba=a296_0x1e03e2,_0x56eab8=path_1[_0x388fba(0xb9)]['join'](masking_service_1[_0x388fba(0xc4)][_0x388fba(0xd3)],_0x114188);return(0x0,promises_1['rm'])(_0x56eab8,{'recursive':!![],'force':!![]});}}exports[a296_0x1e03e2(0xd2)]=DataMaskingRetentionPolicy;