const a258_0x4c31c7=a258_0x3b78;(function(_0x3abebe,_0xf26f65){const _0x382ebf=a258_0x3b78,_0x45d0e4=_0x3abebe();while(!![]){try{const _0x403b26=parseInt(_0x382ebf(0x13f))/0x1+parseInt(_0x382ebf(0x14d))/0x2+-parseInt(_0x382ebf(0x13a))/0x3+parseInt(_0x382ebf(0x144))/0x4*(-parseInt(_0x382ebf(0x139))/0x5)+-parseInt(_0x382ebf(0x13c))/0x6*(parseInt(_0x382ebf(0x134))/0x7)+-parseInt(_0x382ebf(0x145))/0x8*(parseInt(_0x382ebf(0x140))/0x9)+parseInt(_0x382ebf(0x138))/0xa;if(_0x403b26===_0xf26f65)break;else _0x45d0e4['push'](_0x45d0e4['shift']());}catch(_0x5893dd){_0x45d0e4['push'](_0x45d0e4['shift']());}}}(a258_0x1345,0x26c07));const a258_0x5633d2=(function(){let _0x3dbc39=!![];return function(_0x10d27d,_0x1fd58c){const _0x3975b3=_0x3dbc39?function(){const _0x1c4c33=a258_0x3b78;if(_0x1fd58c){const _0x105772=_0x1fd58c[_0x1c4c33(0x148)](_0x10d27d,arguments);return _0x1fd58c=null,_0x105772;}}:function(){};return _0x3dbc39=![],_0x3975b3;};}()),a258_0x27100f=a258_0x5633d2(this,function(){const _0x4badb6=a258_0x3b78;return a258_0x27100f[_0x4badb6(0x130)]()[_0x4badb6(0x14a)](_0x4badb6(0x149))[_0x4badb6(0x130)]()[_0x4badb6(0x125)](a258_0x27100f)[_0x4badb6(0x14a)](_0x4badb6(0x149));});function a258_0x3b78(_0x55e66c,_0x5a305d){const _0x1eb4af=a258_0x1345();return a258_0x3b78=function(_0x27100f,_0x5633d2){_0x27100f=_0x27100f-0x125;let _0x134546=_0x1eb4af[_0x27100f];return _0x134546;},a258_0x3b78(_0x55e66c,_0x5a305d);}a258_0x27100f();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2c8c65){return _0x2c8c65&&_0x2c8c65['__esModule']?_0x2c8c65:{'default':_0x2c8c65};};function a258_0x1345(){const _0x4647c1=['toString','JOB_LOG_STATE_FILENAME','completedDate','maskingFolderPath','21NOUaEg','parse','readFile','push','4765830yuKrih','25zLbtTg','592059GErffT','defineProperty','285174lRQjvF','../../data-masking/services/masking.service','DataMaskingRetentionPolicy','83320CkSmZA','2516274YcpAEc','default','__esModule','filterExpiredJobs','50936ThEqlW','8RMAlaQ','../../../core','getJobCompletedDate','apply','(((.+)+)+)+$','search','getJobsIds','../../shared/utils/job.utils','564040elvYTG','constructor','../../../constants/job','join','error','EXPIRED_RANGE_DATE','@flosum/utils','MaskingService','Logger','FsUtils','isExpiredDate','execute'];a258_0x1345=function(){return _0x4647c1;};return a258_0x1345();}Object[a258_0x4c31c7(0x13b)](exports,a258_0x4c31c7(0x142),{'value':!![]}),exports['DataMaskingRetentionPolicy']=void 0x0;const promises_1=require('fs/promises'),core_1=require(a258_0x4c31c7(0x146)),utils_1=require(a258_0x4c31c7(0x12a)),job_1=require(a258_0x4c31c7(0x126)),job_utils_1=__importDefault(require(a258_0x4c31c7(0x14c))),masking_service_1=require(a258_0x4c31c7(0x13d)),path_1=__importDefault(require('path'));class DataMaskingRetentionPolicy{constructor(){const _0x4dc939=a258_0x4c31c7;this[_0x4dc939(0x129)]=0x9a7ec800,this['logger']=new core_1[(_0x4dc939(0x12c))](DataMaskingRetentionPolicy['name']);}async[a258_0x4c31c7(0x12f)](){const _0x17dc96=a258_0x4c31c7;try{const _0x4ef2b1=await job_utils_1[_0x17dc96(0x141)][_0x17dc96(0x14b)](masking_service_1[_0x17dc96(0x12b)][_0x17dc96(0x133)]),_0x4aac91=await this[_0x17dc96(0x143)](_0x4ef2b1);for(const _0x5ee5db of _0x4aac91){await this['deleteJob'](_0x5ee5db);}}catch(_0x55816d){this['logger'][_0x17dc96(0x128)](_0x55816d);}}async['filterExpiredJobs'](_0x2c9dce){const _0x4dabac=a258_0x4c31c7,_0x335306=[];for(const _0x1b45d7 of _0x2c9dce){const _0x176927=await this['getJobCompletedDate'](_0x1b45d7),_0x2a235e=_0x176927&&this[_0x4dabac(0x12e)](_0x176927);_0x2a235e&&_0x335306[_0x4dabac(0x137)](_0x1b45d7);}return _0x335306;}async[a258_0x4c31c7(0x147)](_0x37e5c6){const _0x18ef78=a258_0x4c31c7;var _0x1f32d9;const _0x36ebd2=path_1[_0x18ef78(0x141)][_0x18ef78(0x127)](masking_service_1[_0x18ef78(0x12b)][_0x18ef78(0x133)],_0x37e5c6,job_1[_0x18ef78(0x131)]);if(!await utils_1[_0x18ef78(0x12d)]['isExistsPath'](_0x36ebd2))return null;const _0x4a03f8=await(0x0,promises_1[_0x18ef78(0x136)])(_0x36ebd2,{'encoding':'utf-8'});return(_0x1f32d9=JSON[_0x18ef78(0x135)](_0x4a03f8)[_0x18ef78(0x132)])!==null&&_0x1f32d9!==void 0x0?_0x1f32d9:null;}[a258_0x4c31c7(0x12e)](_0x31f547){const _0xd3ad4=a258_0x4c31c7;return new Date()['getTime']()-_0x31f547>this[_0xd3ad4(0x129)];}['deleteJob'](_0xd8af81){const _0x381f23=a258_0x4c31c7,_0x5a3072=path_1[_0x381f23(0x141)]['join'](masking_service_1[_0x381f23(0x12b)][_0x381f23(0x133)],_0xd8af81);return(0x0,promises_1['rm'])(_0x5a3072,{'recursive':!![],'force':!![]});}}exports[a258_0x4c31c7(0x13e)]=DataMaskingRetentionPolicy;