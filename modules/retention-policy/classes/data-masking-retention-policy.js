const a306_0x2a35ad=a306_0x5c27;(function(_0x5220f0,_0x2c6dcf){const _0x2fdab7=a306_0x5c27,_0x1e99d1=_0x5220f0();while(!![]){try{const _0x2735cc=-parseInt(_0x2fdab7(0x126))/0x1+-parseInt(_0x2fdab7(0x141))/0x2+-parseInt(_0x2fdab7(0x120))/0x3*(parseInt(_0x2fdab7(0x132))/0x4)+-parseInt(_0x2fdab7(0x123))/0x5+parseInt(_0x2fdab7(0x13e))/0x6*(parseInt(_0x2fdab7(0x121))/0x7)+-parseInt(_0x2fdab7(0x140))/0x8+parseInt(_0x2fdab7(0x137))/0x9*(parseInt(_0x2fdab7(0x11f))/0xa);if(_0x2735cc===_0x2c6dcf)break;else _0x1e99d1['push'](_0x1e99d1['shift']());}catch(_0x4a8b6b){_0x1e99d1['push'](_0x1e99d1['shift']());}}}(a306_0x33ca,0x23621));const a306_0x55c01e=(function(){let _0xe6e8bc=!![];return function(_0x37bf10,_0x74b5a6){const _0x544fb3=_0xe6e8bc?function(){if(_0x74b5a6){const _0xb949ee=_0x74b5a6['apply'](_0x37bf10,arguments);return _0x74b5a6=null,_0xb949ee;}}:function(){};return _0xe6e8bc=![],_0x544fb3;};}()),a306_0x305c80=a306_0x55c01e(this,function(){const _0x3cda21=a306_0x5c27;return a306_0x305c80[_0x3cda21(0x127)]()['search'](_0x3cda21(0x12a))[_0x3cda21(0x127)]()[_0x3cda21(0x129)](a306_0x305c80)[_0x3cda21(0x134)](_0x3cda21(0x12a));});a306_0x305c80();'use strict';var __importDefault=this&&this[a306_0x2a35ad(0x133)]||function(_0x578320){const _0x5616e1=a306_0x2a35ad;return _0x578320&&_0x578320[_0x5616e1(0x139)]?_0x578320:{'default':_0x578320};};Object['defineProperty'](exports,a306_0x2a35ad(0x139),{'value':!![]}),exports['DataMaskingRetentionPolicy']=void 0x0;const promises_1=require('fs/promises'),core_1=require('../../../core'),utils_1=require(a306_0x2a35ad(0x143)),job_1=require(a306_0x2a35ad(0x138)),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),masking_service_1=require(a306_0x2a35ad(0x13a)),path_1=__importDefault(require(a306_0x2a35ad(0x122)));function a306_0x33ca(){const _0x20fa62=['445752CQluaC','push','@flosum/utils','deleteJob','default','utf-8','filterExpiredJobs','JOB_LOG_STATE_FILENAME','readFile','10pnReML','3zVrFao','1692005ZjSnfR','path','940785nJrNVK','getJobCompletedDate','FsUtils','109365rErkdp','toString','maskingFolderPath','constructor','(((.+)+)+)+$','DataMaskingRetentionPolicy','name','Logger','isExpiredDate','execute','EXPIRED_RANGE_DATE','MaskingService','49460NbNkvU','__importDefault','search','parse','getJobsIds','3948444HAhXRl','../../../constants/job','__esModule','../../data-masking/services/masking.service','error','logger','join','6ljdYbM','completedDate','21912pMIFmA'];a306_0x33ca=function(){return _0x20fa62;};return a306_0x33ca();}class DataMaskingRetentionPolicy{constructor(){const _0x5a0669=a306_0x2a35ad;this[_0x5a0669(0x130)]=0x9a7ec800,this[_0x5a0669(0x13c)]=new core_1[(_0x5a0669(0x12d))](DataMaskingRetentionPolicy[_0x5a0669(0x12c)]);}async[a306_0x2a35ad(0x12f)](){const _0x49a3c2=a306_0x2a35ad;try{const _0x5932c2=await job_utils_1[_0x49a3c2(0x11a)][_0x49a3c2(0x136)](masking_service_1[_0x49a3c2(0x131)][_0x49a3c2(0x128)]),_0x2f2708=await this[_0x49a3c2(0x11c)](_0x5932c2);for(const _0x5ebdc9 of _0x2f2708){await this[_0x49a3c2(0x144)](_0x5ebdc9);}}catch(_0x49dfb2){this[_0x49a3c2(0x13c)][_0x49a3c2(0x13b)](_0x49dfb2);}}async['filterExpiredJobs'](_0x266a25){const _0x47f3c1=a306_0x2a35ad,_0x1ef87a=[];for(const _0x45f628 of _0x266a25){const _0x4cd760=await this['getJobCompletedDate'](_0x45f628),_0x164984=_0x4cd760&&this[_0x47f3c1(0x12e)](_0x4cd760);_0x164984&&_0x1ef87a[_0x47f3c1(0x142)](_0x45f628);}return _0x1ef87a;}async[a306_0x2a35ad(0x124)](_0x542a5e){const _0x3d6b68=a306_0x2a35ad;var _0x462af2;const _0x495f65=path_1['default'][_0x3d6b68(0x13d)](masking_service_1['MaskingService'][_0x3d6b68(0x128)],_0x542a5e,job_1[_0x3d6b68(0x11d)]);if(!await utils_1[_0x3d6b68(0x125)]['isExistsPath'](_0x495f65))return null;const _0x1e53ea=await(0x0,promises_1[_0x3d6b68(0x11e)])(_0x495f65,{'encoding':_0x3d6b68(0x11b)});return(_0x462af2=JSON[_0x3d6b68(0x135)](_0x1e53ea)[_0x3d6b68(0x13f)])!==null&&_0x462af2!==void 0x0?_0x462af2:null;}[a306_0x2a35ad(0x12e)](_0x4ec8ca){const _0x133c9f=a306_0x2a35ad;return new Date()['getTime']()-_0x4ec8ca>this[_0x133c9f(0x130)];}[a306_0x2a35ad(0x144)](_0x286653){const _0x54e1b0=a306_0x2a35ad,_0x1fa554=path_1[_0x54e1b0(0x11a)][_0x54e1b0(0x13d)](masking_service_1[_0x54e1b0(0x131)][_0x54e1b0(0x128)],_0x286653);return(0x0,promises_1['rm'])(_0x1fa554,{'recursive':!![],'force':!![]});}}function a306_0x5c27(_0x32f8eb,_0x46743b){const _0x556688=a306_0x33ca();return a306_0x5c27=function(_0x305c80,_0x55c01e){_0x305c80=_0x305c80-0x11a;let _0x33cac5=_0x556688[_0x305c80];return _0x33cac5;},a306_0x5c27(_0x32f8eb,_0x46743b);}exports[a306_0x2a35ad(0x12b)]=DataMaskingRetentionPolicy;