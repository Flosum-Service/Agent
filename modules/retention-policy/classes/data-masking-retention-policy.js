const a295_0x549a92=a295_0x3e5c;(function(_0x58075a,_0x3700b2){const _0x35a0c8=a295_0x3e5c,_0xb05337=_0x58075a();while(!![]){try{const _0x6271d8=parseInt(_0x35a0c8(0xb9))/0x1*(parseInt(_0x35a0c8(0xc3))/0x2)+parseInt(_0x35a0c8(0xb8))/0x3*(parseInt(_0x35a0c8(0xcc))/0x4)+parseInt(_0x35a0c8(0xb7))/0x5+-parseInt(_0x35a0c8(0xb5))/0x6*(-parseInt(_0x35a0c8(0xba))/0x7)+-parseInt(_0x35a0c8(0xae))/0x8+-parseInt(_0x35a0c8(0xc7))/0x9+-parseInt(_0x35a0c8(0xb1))/0xa;if(_0x6271d8===_0x3700b2)break;else _0xb05337['push'](_0xb05337['shift']());}catch(_0x49f47b){_0xb05337['push'](_0xb05337['shift']());}}}(a295_0xae2a,0x300b6));const a295_0x562163=(function(){let _0x4443a0=!![];return function(_0x4d9dfc,_0xd9a3e0){const _0x2dac3e=_0x4443a0?function(){if(_0xd9a3e0){const _0x3717fc=_0xd9a3e0['apply'](_0x4d9dfc,arguments);return _0xd9a3e0=null,_0x3717fc;}}:function(){};return _0x4443a0=![],_0x2dac3e;};}()),a295_0x5dfc3a=a295_0x562163(this,function(){const _0x3685e7=a295_0x3e5c;return a295_0x5dfc3a[_0x3685e7(0xbd)]()['search'](_0x3685e7(0xab))[_0x3685e7(0xbd)]()[_0x3685e7(0xbf)](a295_0x5dfc3a)[_0x3685e7(0xa7)](_0x3685e7(0xab));});a295_0x5dfc3a();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5de719){const _0x569819=a295_0x3e5c;return _0x5de719&&_0x5de719[_0x569819(0xbb)]?_0x5de719:{'default':_0x5de719};};Object[a295_0x549a92(0xc8)](exports,a295_0x549a92(0xbb),{'value':!![]}),exports[a295_0x549a92(0xc4)]=void 0x0;function a295_0x3e5c(_0x470994,_0x186051){const _0x146f22=a295_0xae2a();return a295_0x3e5c=function(_0x5dfc3a,_0x562163){_0x5dfc3a=_0x5dfc3a-0xa7;let _0xae2a58=_0x146f22[_0x5dfc3a];return _0xae2a58;},a295_0x3e5c(_0x470994,_0x186051);}const promises_1=require(a295_0x549a92(0xaf)),core_1=require(a295_0x549a92(0xc5)),utils_1=require(a295_0x549a92(0xc2)),job_1=require('../../../constants/job'),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),masking_service_1=require(a295_0x549a92(0xcf)),path_1=__importDefault(require(a295_0x549a92(0xcb)));function a295_0xae2a(){const _0x127c4f=['maskingFolderPath','4613830MOGqDH','push','MaskingService','logger','59580RwRYmX','Logger','1173845rAZSfn','51siEcQr','19wikjSe','49ekLNoD','__esModule','completedDate','toString','deleteJob','constructor','JOB_LOG_STATE_FILENAME','isExpiredDate','@flosum/utils','24380GEQdOL','DataMaskingRetentionPolicy','../../../core','default','301824kLHSko','defineProperty','EXPIRED_RANGE_DATE','getJobCompletedDate','path','77964YcdmeJ','name','execute','../../data-masking/services/masking.service','FsUtils','search','filterExpiredJobs','parse','error','(((.+)+)+)+$','isExistsPath','join','1404216csbYsA','fs/promises'];a295_0xae2a=function(){return _0x127c4f;};return a295_0xae2a();}class DataMaskingRetentionPolicy{constructor(){const _0x431762=a295_0x549a92;this[_0x431762(0xc9)]=0x9a7ec800,this['logger']=new core_1[(_0x431762(0xb6))](DataMaskingRetentionPolicy[_0x431762(0xcd)]);}async[a295_0x549a92(0xce)](){const _0x3d70d5=a295_0x549a92;try{const _0x1c2d73=await job_utils_1[_0x3d70d5(0xc6)]['getJobsIds'](masking_service_1[_0x3d70d5(0xb3)][_0x3d70d5(0xb0)]),_0x27ba9d=await this['filterExpiredJobs'](_0x1c2d73);for(const _0x50562d of _0x27ba9d){await this[_0x3d70d5(0xbe)](_0x50562d);}}catch(_0x3e22fe){this[_0x3d70d5(0xb4)][_0x3d70d5(0xaa)](_0x3e22fe);}}async[a295_0x549a92(0xa8)](_0x1d5977){const _0x5b87b2=a295_0x549a92,_0x19c348=[];for(const _0x3b0d12 of _0x1d5977){const _0x2b91f1=await this[_0x5b87b2(0xca)](_0x3b0d12),_0x55a993=_0x2b91f1&&this[_0x5b87b2(0xc1)](_0x2b91f1);_0x55a993&&_0x19c348[_0x5b87b2(0xb2)](_0x3b0d12);}return _0x19c348;}async[a295_0x549a92(0xca)](_0x16d709){const _0xd51e7=a295_0x549a92;var _0x2e558a;const _0x4b6753=path_1[_0xd51e7(0xc6)][_0xd51e7(0xad)](masking_service_1[_0xd51e7(0xb3)][_0xd51e7(0xb0)],_0x16d709,job_1[_0xd51e7(0xc0)]);if(!await utils_1[_0xd51e7(0xd0)][_0xd51e7(0xac)](_0x4b6753))return null;const _0x30f27b=await(0x0,promises_1['readFile'])(_0x4b6753,{'encoding':'utf-8'});return(_0x2e558a=JSON[_0xd51e7(0xa9)](_0x30f27b)[_0xd51e7(0xbc)])!==null&&_0x2e558a!==void 0x0?_0x2e558a:null;}[a295_0x549a92(0xc1)](_0x27c5d5){const _0x5d117d=a295_0x549a92;return new Date()['getTime']()-_0x27c5d5>this[_0x5d117d(0xc9)];}['deleteJob'](_0xf49ffe){const _0x151cbf=a295_0x549a92,_0x1ecbe4=path_1[_0x151cbf(0xc6)][_0x151cbf(0xad)](masking_service_1['MaskingService'][_0x151cbf(0xb0)],_0xf49ffe);return(0x0,promises_1['rm'])(_0x1ecbe4,{'recursive':!![],'force':!![]});}}exports[a295_0x549a92(0xc4)]=DataMaskingRetentionPolicy;