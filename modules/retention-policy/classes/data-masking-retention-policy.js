const a307_0x355e77=a307_0x182e;(function(_0x412c33,_0x451025){const _0x11c965=a307_0x182e,_0x2dd4e4=_0x412c33();while(!![]){try{const _0x33a150=-parseInt(_0x11c965(0xd7))/0x1+-parseInt(_0x11c965(0xce))/0x2+parseInt(_0x11c965(0xb4))/0x3*(parseInt(_0x11c965(0xc0))/0x4)+-parseInt(_0x11c965(0xd0))/0x5+parseInt(_0x11c965(0xb3))/0x6+-parseInt(_0x11c965(0xd6))/0x7+parseInt(_0x11c965(0xc9))/0x8*(parseInt(_0x11c965(0xcf))/0x9);if(_0x33a150===_0x451025)break;else _0x2dd4e4['push'](_0x2dd4e4['shift']());}catch(_0x48d904){_0x2dd4e4['push'](_0x2dd4e4['shift']());}}}(a307_0x2af8,0xa4287));const a307_0x4a6046=(function(){let _0x49e3fd=!![];return function(_0x22aa96,_0x3b75ce){const _0x12710d=_0x49e3fd?function(){const _0x49e723=a307_0x182e;if(_0x3b75ce){const _0x470790=_0x3b75ce[_0x49e723(0xd4)](_0x22aa96,arguments);return _0x3b75ce=null,_0x470790;}}:function(){};return _0x49e3fd=![],_0x12710d;};}()),a307_0x1afac1=a307_0x4a6046(this,function(){const _0x2ac5bb=a307_0x182e;return a307_0x1afac1[_0x2ac5bb(0xc1)]()['search'](_0x2ac5bb(0xcc))['toString']()[_0x2ac5bb(0xbf)](a307_0x1afac1)[_0x2ac5bb(0xc8)]('(((.+)+)+)+$');});a307_0x1afac1();'use strict';var __importDefault=this&&this[a307_0x355e77(0xd5)]||function(_0x569967){const _0x5548b1=a307_0x355e77;return _0x569967&&_0x569967[_0x5548b1(0xcd)]?_0x569967:{'default':_0x569967};};Object[a307_0x355e77(0xbe)](exports,a307_0x355e77(0xcd),{'value':!![]}),exports['DataMaskingRetentionPolicy']=void 0x0;const promises_1=require(a307_0x355e77(0xc3)),core_1=require('../../../core'),utils_1=require(a307_0x355e77(0xbb)),job_1=require(a307_0x355e77(0xb7)),job_utils_1=__importDefault(require(a307_0x355e77(0xc7))),masking_service_1=require('../../data-masking/services/masking.service'),path_1=__importDefault(require(a307_0x355e77(0xca)));class DataMaskingRetentionPolicy{constructor(){const _0x36ffea=a307_0x355e77;this[_0x36ffea(0xb2)]=0x9a7ec800,this[_0x36ffea(0xb9)]=new core_1['Logger'](DataMaskingRetentionPolicy[_0x36ffea(0xcb)]);}async[a307_0x355e77(0xd3)](){const _0x27d5fd=a307_0x355e77;try{const _0x44dc63=await job_utils_1[_0x27d5fd(0xba)]['getJobsIds'](masking_service_1['MaskingService']['maskingFolderPath']),_0x523b6f=await this[_0x27d5fd(0xdb)](_0x44dc63);for(const _0x5f1187 of _0x523b6f){await this[_0x27d5fd(0xda)](_0x5f1187);}}catch(_0x39ee3a){this[_0x27d5fd(0xb9)][_0x27d5fd(0xb5)](_0x39ee3a);}}async[a307_0x355e77(0xdb)](_0x1919c6){const _0x296068=a307_0x355e77,_0x267ab2=[];for(const _0x134c34 of _0x1919c6){const _0x7896d2=await this['getJobCompletedDate'](_0x134c34),_0x11a236=_0x7896d2&&this['isExpiredDate'](_0x7896d2);_0x11a236&&_0x267ab2[_0x296068(0xbd)](_0x134c34);}return _0x267ab2;}async[a307_0x355e77(0xc4)](_0x437ba5){const _0xf68ad7=a307_0x355e77;var _0x3c9969;const _0x3c82dc=path_1[_0xf68ad7(0xba)]['join'](masking_service_1[_0xf68ad7(0xb6)][_0xf68ad7(0xd9)],_0x437ba5,job_1[_0xf68ad7(0xc5)]);if(!await utils_1['FsUtils'][_0xf68ad7(0xc6)](_0x3c82dc))return null;const _0x26fafd=await(0x0,promises_1['readFile'])(_0x3c82dc,{'encoding':_0xf68ad7(0xd2)});return(_0x3c9969=JSON[_0xf68ad7(0xb8)](_0x26fafd)[_0xf68ad7(0xc2)])!==null&&_0x3c9969!==void 0x0?_0x3c9969:null;}[a307_0x355e77(0xd8)](_0x2c9067){const _0x173589=a307_0x355e77;return new Date()[_0x173589(0xb1)]()-_0x2c9067>this[_0x173589(0xb2)];}[a307_0x355e77(0xda)](_0x55fcf5){const _0x3b94f9=a307_0x355e77,_0x39748a=path_1[_0x3b94f9(0xba)][_0x3b94f9(0xbc)](masking_service_1['MaskingService'][_0x3b94f9(0xd9)],_0x55fcf5);return(0x0,promises_1['rm'])(_0x39748a,{'recursive':!![],'force':!![]});}}exports[a307_0x355e77(0xd1)]=DataMaskingRetentionPolicy;function a307_0x182e(_0x28bbe4,_0x208734){const _0x227c90=a307_0x2af8();return a307_0x182e=function(_0x1afac1,_0x4a6046){_0x1afac1=_0x1afac1-0xb1;let _0x2af813=_0x227c90[_0x1afac1];return _0x2af813;},a307_0x182e(_0x28bbe4,_0x208734);}function a307_0x2af8(){const _0x3fac17=['toString','completedDate','fs/promises','getJobCompletedDate','JOB_LOG_STATE_FILENAME','isExistsPath','../../shared/utils/job.utils','search','3353944znBLJP','path','name','(((.+)+)+)+$','__esModule','1949070pYoxGl','27UYcIHm','4300590DvdYOF','DataMaskingRetentionPolicy','utf-8','execute','apply','__importDefault','2802296qeMLpL','865175XQDpiM','isExpiredDate','maskingFolderPath','deleteJob','filterExpiredJobs','getTime','EXPIRED_RANGE_DATE','7661760JZCGlG','3713574zVlfXS','error','MaskingService','../../../constants/job','parse','logger','default','@flosum/utils','join','push','defineProperty','constructor','4cCvlOc'];a307_0x2af8=function(){return _0x3fac17;};return a307_0x2af8();}