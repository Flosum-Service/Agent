const a259_0x3b4ed1=a259_0x5cb0;(function(_0x3c989f,_0x25eed8){const _0x363ec2=a259_0x5cb0,_0x502184=_0x3c989f();while(!![]){try{const _0x1ad6ca=-parseInt(_0x363ec2(0x1b3))/0x1+parseInt(_0x363ec2(0x1af))/0x2+parseInt(_0x363ec2(0x1bb))/0x3*(-parseInt(_0x363ec2(0x1a4))/0x4)+-parseInt(_0x363ec2(0x1b5))/0x5+parseInt(_0x363ec2(0x1c0))/0x6+parseInt(_0x363ec2(0x1c4))/0x7+parseInt(_0x363ec2(0x1b8))/0x8;if(_0x1ad6ca===_0x25eed8)break;else _0x502184['push'](_0x502184['shift']());}catch(_0x5dd8b2){_0x502184['push'](_0x502184['shift']());}}}(a259_0x25ef,0x7f7bf));function a259_0x5cb0(_0x372c7f,_0x2584bf){const _0x2efab9=a259_0x25ef();return a259_0x5cb0=function(_0x10a3bb,_0x36f8d0){_0x10a3bb=_0x10a3bb-0x1a1;let _0x25ef23=_0x2efab9[_0x10a3bb];return _0x25ef23;},a259_0x5cb0(_0x372c7f,_0x2584bf);}const a259_0x36f8d0=(function(){let _0x2548d4=!![];return function(_0x2f9a94,_0x259178){const _0x247a44=_0x2548d4?function(){if(_0x259178){const _0x1a2d8c=_0x259178['apply'](_0x2f9a94,arguments);return _0x259178=null,_0x1a2d8c;}}:function(){};return _0x2548d4=![],_0x247a44;};}()),a259_0x10a3bb=a259_0x36f8d0(this,function(){const _0x248f7b=a259_0x5cb0;return a259_0x10a3bb[_0x248f7b(0x1a3)]()['search'](_0x248f7b(0x1ab))[_0x248f7b(0x1a3)]()[_0x248f7b(0x1bd)](a259_0x10a3bb)['search'](_0x248f7b(0x1ab));});a259_0x10a3bb();function a259_0x25ef(){const _0x2f1455=['completedDate','constructor','default','isExistsPath','1564950HxgXfl','getTime','error','deleteJob','1586088PrmlqO','join','logger','toString','4ExTDBt','FsUtils','isExpiredDate','parse','../../shared/utils/job.utils','push','getJobCompletedDate','(((.+)+)+)+$','maskingFolderPath','EXPIRED_RANGE_DATE','DataMaskingRetentionPolicy','55346OTHKnS','../../../constants/job','JOB_LOG_STATE_FILENAME','Logger','951751AMVzqT','../../data-masking/services/masking.service','3183310PiVSDv','MaskingService','filterExpiredJobs','14646504FELdLl','readFile','__esModule','705921HaiYHo'];a259_0x25ef=function(){return _0x2f1455;};return a259_0x25ef();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x51745c){const _0x3db996=a259_0x5cb0;return _0x51745c&&_0x51745c[_0x3db996(0x1ba)]?_0x51745c:{'default':_0x51745c};};Object['defineProperty'](exports,a259_0x3b4ed1(0x1ba),{'value':!![]}),exports[a259_0x3b4ed1(0x1ae)]=void 0x0;const promises_1=require('fs/promises'),core_1=require('../../../core'),utils_1=require('@flosum/utils'),job_1=require(a259_0x3b4ed1(0x1b0)),job_utils_1=__importDefault(require(a259_0x3b4ed1(0x1a8))),masking_service_1=require(a259_0x3b4ed1(0x1b4)),path_1=__importDefault(require('path'));class DataMaskingRetentionPolicy{constructor(){const _0x3f8a98=a259_0x3b4ed1;this[_0x3f8a98(0x1ad)]=0x9a7ec800,this[_0x3f8a98(0x1a2)]=new core_1[(_0x3f8a98(0x1b2))](DataMaskingRetentionPolicy['name']);}async['execute'](){const _0x5b20f6=a259_0x3b4ed1;try{const _0x353804=await job_utils_1[_0x5b20f6(0x1be)]['getJobsIds'](masking_service_1[_0x5b20f6(0x1b6)][_0x5b20f6(0x1ac)]),_0x334e1a=await this['filterExpiredJobs'](_0x353804);for(const _0x3ae2a3 of _0x334e1a){await this[_0x5b20f6(0x1c3)](_0x3ae2a3);}}catch(_0x5871fc){this[_0x5b20f6(0x1a2)][_0x5b20f6(0x1c2)](_0x5871fc);}}async[a259_0x3b4ed1(0x1b7)](_0x1f2837){const _0x5a4055=a259_0x3b4ed1,_0x25b9fb=[];for(const _0x5adbc6 of _0x1f2837){const _0x2113ce=await this[_0x5a4055(0x1aa)](_0x5adbc6),_0x5914fa=_0x2113ce&&this['isExpiredDate'](_0x2113ce);_0x5914fa&&_0x25b9fb[_0x5a4055(0x1a9)](_0x5adbc6);}return _0x25b9fb;}async[a259_0x3b4ed1(0x1aa)](_0x5a3f15){const _0x8daabe=a259_0x3b4ed1;var _0x43e891;const _0x4557ab=path_1[_0x8daabe(0x1be)][_0x8daabe(0x1a1)](masking_service_1[_0x8daabe(0x1b6)][_0x8daabe(0x1ac)],_0x5a3f15,job_1[_0x8daabe(0x1b1)]);if(!await utils_1[_0x8daabe(0x1a5)][_0x8daabe(0x1bf)](_0x4557ab))return null;const _0x12159b=await(0x0,promises_1[_0x8daabe(0x1b9)])(_0x4557ab,{'encoding':'utf-8'});return(_0x43e891=JSON[_0x8daabe(0x1a7)](_0x12159b)[_0x8daabe(0x1bc)])!==null&&_0x43e891!==void 0x0?_0x43e891:null;}[a259_0x3b4ed1(0x1a6)](_0x36bbb0){const _0x34da3d=a259_0x3b4ed1;return new Date()[_0x34da3d(0x1c1)]()-_0x36bbb0>this[_0x34da3d(0x1ad)];}['deleteJob'](_0x5516e1){const _0x7bb66d=a259_0x3b4ed1,_0x28f95b=path_1[_0x7bb66d(0x1be)]['join'](masking_service_1[_0x7bb66d(0x1b6)]['maskingFolderPath'],_0x5516e1);return(0x0,promises_1['rm'])(_0x28f95b,{'recursive':!![],'force':!![]});}}exports[a259_0x3b4ed1(0x1ae)]=DataMaskingRetentionPolicy;