const a308_0x896863=a308_0x1f1c;(function(_0x23282,_0x137da1){const _0x52d9bc=a308_0x1f1c,_0x1ef224=_0x23282();while(!![]){try{const _0x54e6c2=-parseInt(_0x52d9bc(0x198))/0x1+-parseInt(_0x52d9bc(0x1a4))/0x2+-parseInt(_0x52d9bc(0x181))/0x3*(-parseInt(_0x52d9bc(0x183))/0x4)+-parseInt(_0x52d9bc(0x184))/0x5*(-parseInt(_0x52d9bc(0x18a))/0x6)+parseInt(_0x52d9bc(0x197))/0x7+parseInt(_0x52d9bc(0x19b))/0x8+-parseInt(_0x52d9bc(0x1a9))/0x9*(parseInt(_0x52d9bc(0x1a5))/0xa);if(_0x54e6c2===_0x137da1)break;else _0x1ef224['push'](_0x1ef224['shift']());}catch(_0x5684f4){_0x1ef224['push'](_0x1ef224['shift']());}}}(a308_0x4a68,0xbdbf3));function a308_0x4a68(){const _0x19be26=['push','__esModule','utf-8','Logger','fs/promises','10873583jUQSNA','622661pcKpPl','error','MaskingService','11032016cQAkzr','getJobCompletedDate','DataMaskingRetentionPolicy','logger','toString','name','isExistsPath','../../shared/utils/job.utils','execute','549714RQhXsc','10oxexFo','../../../constants/job','__importDefault','join','20403261xxirbi','../../../core','../../data-masking/services/masking.service','453dfUEgq','getTime','6212HdeTbZ','322865RmqCWc','default','(((.+)+)+)+$','maskingFolderPath','JOB_LOG_STATE_FILENAME','EXPIRED_RANGE_DATE','72BlCTiQ','deleteJob','search','FsUtils','apply','getJobsIds','readFile','isExpiredDate'];a308_0x4a68=function(){return _0x19be26;};return a308_0x4a68();}const a308_0x5bc403=(function(){let _0x3183db=!![];return function(_0x427011,_0x14062e){const _0x79462f=_0x3183db?function(){const _0x25b583=a308_0x1f1c;if(_0x14062e){const _0x43ce91=_0x14062e[_0x25b583(0x18e)](_0x427011,arguments);return _0x14062e=null,_0x43ce91;}}:function(){};return _0x3183db=![],_0x79462f;};}()),a308_0x1247d4=a308_0x5bc403(this,function(){const _0x18d93a=a308_0x1f1c;return a308_0x1247d4[_0x18d93a(0x19f)]()[_0x18d93a(0x18c)](_0x18d93a(0x186))[_0x18d93a(0x19f)]()['constructor'](a308_0x1247d4)[_0x18d93a(0x18c)](_0x18d93a(0x186));});a308_0x1247d4();'use strict';var __importDefault=this&&this[a308_0x896863(0x1a7)]||function(_0x153d9d){const _0x560435=a308_0x896863;return _0x153d9d&&_0x153d9d[_0x560435(0x193)]?_0x153d9d:{'default':_0x153d9d};};Object['defineProperty'](exports,a308_0x896863(0x193),{'value':!![]}),exports[a308_0x896863(0x19d)]=void 0x0;const promises_1=require(a308_0x896863(0x196)),core_1=require(a308_0x896863(0x17f)),utils_1=require('@flosum/utils'),job_1=require(a308_0x896863(0x1a6)),job_utils_1=__importDefault(require(a308_0x896863(0x1a2))),masking_service_1=require(a308_0x896863(0x180)),path_1=__importDefault(require('path'));class DataMaskingRetentionPolicy{constructor(){const _0x5d0693=a308_0x896863;this[_0x5d0693(0x189)]=0x9a7ec800,this[_0x5d0693(0x19e)]=new core_1[(_0x5d0693(0x195))](DataMaskingRetentionPolicy[_0x5d0693(0x1a0)]);}async[a308_0x896863(0x1a3)](){const _0x1f72c4=a308_0x896863;try{const _0x3ec9a5=await job_utils_1[_0x1f72c4(0x185)][_0x1f72c4(0x18f)](masking_service_1[_0x1f72c4(0x19a)]['maskingFolderPath']),_0x3f6a9b=await this['filterExpiredJobs'](_0x3ec9a5);for(const _0x3c59e8 of _0x3f6a9b){await this['deleteJob'](_0x3c59e8);}}catch(_0x36dc20){this[_0x1f72c4(0x19e)][_0x1f72c4(0x199)](_0x36dc20);}}async['filterExpiredJobs'](_0x109356){const _0x236503=a308_0x896863,_0x3b7cf7=[];for(const _0x79e898 of _0x109356){const _0x4ee764=await this[_0x236503(0x19c)](_0x79e898),_0x39f2b1=_0x4ee764&&this['isExpiredDate'](_0x4ee764);_0x39f2b1&&_0x3b7cf7[_0x236503(0x192)](_0x79e898);}return _0x3b7cf7;}async[a308_0x896863(0x19c)](_0x79007f){const _0x59eb84=a308_0x896863;var _0x94c372;const _0x4fc093=path_1[_0x59eb84(0x185)][_0x59eb84(0x1a8)](masking_service_1['MaskingService'][_0x59eb84(0x187)],_0x79007f,job_1[_0x59eb84(0x188)]);if(!await utils_1[_0x59eb84(0x18d)][_0x59eb84(0x1a1)](_0x4fc093))return null;const _0x213525=await(0x0,promises_1[_0x59eb84(0x190)])(_0x4fc093,{'encoding':_0x59eb84(0x194)});return(_0x94c372=JSON['parse'](_0x213525)['completedDate'])!==null&&_0x94c372!==void 0x0?_0x94c372:null;}[a308_0x896863(0x191)](_0x54ed04){const _0x3a2470=a308_0x896863;return new Date()[_0x3a2470(0x182)]()-_0x54ed04>this[_0x3a2470(0x189)];}[a308_0x896863(0x18b)](_0x4bdd4b){const _0x41825b=a308_0x896863,_0x280196=path_1[_0x41825b(0x185)]['join'](masking_service_1[_0x41825b(0x19a)][_0x41825b(0x187)],_0x4bdd4b);return(0x0,promises_1['rm'])(_0x280196,{'recursive':!![],'force':!![]});}}function a308_0x1f1c(_0x5109a0,_0x65569){const _0x1c101e=a308_0x4a68();return a308_0x1f1c=function(_0x1247d4,_0x5bc403){_0x1247d4=_0x1247d4-0x17f;let _0x4a688a=_0x1c101e[_0x1247d4];return _0x4a688a;},a308_0x1f1c(_0x5109a0,_0x65569);}exports[a308_0x896863(0x19d)]=DataMaskingRetentionPolicy;