const a264_0xc74ec1=a264_0x15b5;(function(_0x50da89,_0x26df3e){const _0x902537=a264_0x15b5,_0x415641=_0x50da89();while(!![]){try{const _0x1d7975=parseInt(_0x902537(0xd4))/0x1+-parseInt(_0x902537(0xd6))/0x2*(parseInt(_0x902537(0xca))/0x3)+parseInt(_0x902537(0xcf))/0x4*(parseInt(_0x902537(0xc8))/0x5)+parseInt(_0x902537(0xc5))/0x6+parseInt(_0x902537(0xc3))/0x7+parseInt(_0x902537(0xb5))/0x8*(-parseInt(_0x902537(0xb2))/0x9)+-parseInt(_0x902537(0xb0))/0xa*(parseInt(_0x902537(0xbc))/0xb);if(_0x1d7975===_0x26df3e)break;else _0x415641['push'](_0x415641['shift']());}catch(_0x146293){_0x415641['push'](_0x415641['shift']());}}}(a264_0xbdf6,0x5197e));function a264_0xbdf6(){const _0x21ebdf=['DataMaskingRetentionPolicy','286970NoOkIr','push','11709ubtSiN','filterExpiredJobs','../../../constants/job','2968LdvnuF','default','toString','getJobCompletedDate','execute','join','path','55KprboQ','MaskingService','../../shared/utils/job.utils','constructor','parse','getJobsIds','maskingFolderPath','965503pdUSBK','utf-8','2827416sDLKaa','logger','defineProperty','5dQsVVQ','completedDate','79308GLrHsk','../../data-masking/services/masking.service','JOB_LOG_STATE_FILENAME','error','search','2068608dZrhHX','isExistsPath','deleteJob','__esModule','Logger','283457JjwQrI','EXPIRED_RANGE_DATE','34LuLFhu','readFile','FsUtils','isExpiredDate','(((.+)+)+)+$'];a264_0xbdf6=function(){return _0x21ebdf;};return a264_0xbdf6();}const a264_0x32df74=(function(){let _0x43969d=!![];return function(_0x5c10dd,_0x17e454){const _0x2b19fd=_0x43969d?function(){if(_0x17e454){const _0x455d60=_0x17e454['apply'](_0x5c10dd,arguments);return _0x17e454=null,_0x455d60;}}:function(){};return _0x43969d=![],_0x2b19fd;};}()),a264_0x59f30c=a264_0x32df74(this,function(){const _0x24e314=a264_0x15b5;return a264_0x59f30c[_0x24e314(0xb7)]()[_0x24e314(0xce)](_0x24e314(0xda))['toString']()[_0x24e314(0xbf)](a264_0x59f30c)[_0x24e314(0xce)](_0x24e314(0xda));});a264_0x59f30c();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x593836){const _0x3bae53=a264_0x15b5;return _0x593836&&_0x593836[_0x3bae53(0xd2)]?_0x593836:{'default':_0x593836};};Object[a264_0xc74ec1(0xc7)](exports,a264_0xc74ec1(0xd2),{'value':!![]}),exports['DataMaskingRetentionPolicy']=void 0x0;function a264_0x15b5(_0x439202,_0x263716){const _0x39b386=a264_0xbdf6();return a264_0x15b5=function(_0x59f30c,_0x32df74){_0x59f30c=_0x59f30c-0xb0;let _0xbdf69a=_0x39b386[_0x59f30c];return _0xbdf69a;},a264_0x15b5(_0x439202,_0x263716);}const promises_1=require('fs/promises'),core_1=require('../../../core'),utils_1=require('@flosum/utils'),job_1=require(a264_0xc74ec1(0xb4)),job_utils_1=__importDefault(require(a264_0xc74ec1(0xbe))),masking_service_1=require(a264_0xc74ec1(0xcb)),path_1=__importDefault(require(a264_0xc74ec1(0xbb)));class DataMaskingRetentionPolicy{constructor(){const _0x1adb27=a264_0xc74ec1;this[_0x1adb27(0xd5)]=0x9a7ec800,this[_0x1adb27(0xc6)]=new core_1[(_0x1adb27(0xd3))](DataMaskingRetentionPolicy['name']);}async[a264_0xc74ec1(0xb9)](){const _0x1ede61=a264_0xc74ec1;try{const _0x5df828=await job_utils_1[_0x1ede61(0xb6)][_0x1ede61(0xc1)](masking_service_1['MaskingService'][_0x1ede61(0xc2)]),_0x8305ae=await this[_0x1ede61(0xb3)](_0x5df828);for(const _0x169cbd of _0x8305ae){await this[_0x1ede61(0xd1)](_0x169cbd);}}catch(_0x5b50c1){this[_0x1ede61(0xc6)][_0x1ede61(0xcd)](_0x5b50c1);}}async[a264_0xc74ec1(0xb3)](_0x32d696){const _0x524b8f=a264_0xc74ec1,_0x2b303c=[];for(const _0x361656 of _0x32d696){const _0x57a968=await this[_0x524b8f(0xb8)](_0x361656),_0x5490f6=_0x57a968&&this[_0x524b8f(0xd9)](_0x57a968);_0x5490f6&&_0x2b303c[_0x524b8f(0xb1)](_0x361656);}return _0x2b303c;}async[a264_0xc74ec1(0xb8)](_0xf36426){const _0xac4432=a264_0xc74ec1;var _0x364a8d;const _0x5daef7=path_1['default'][_0xac4432(0xba)](masking_service_1[_0xac4432(0xbd)][_0xac4432(0xc2)],_0xf36426,job_1[_0xac4432(0xcc)]);if(!await utils_1[_0xac4432(0xd8)][_0xac4432(0xd0)](_0x5daef7))return null;const _0x49fb83=await(0x0,promises_1[_0xac4432(0xd7)])(_0x5daef7,{'encoding':_0xac4432(0xc4)});return(_0x364a8d=JSON[_0xac4432(0xc0)](_0x49fb83)[_0xac4432(0xc9)])!==null&&_0x364a8d!==void 0x0?_0x364a8d:null;}['isExpiredDate'](_0x1757f7){const _0x321732=a264_0xc74ec1;return new Date()['getTime']()-_0x1757f7>this[_0x321732(0xd5)];}['deleteJob'](_0x3540d8){const _0x2c10d7=a264_0xc74ec1,_0x1fdf55=path_1[_0x2c10d7(0xb6)]['join'](masking_service_1[_0x2c10d7(0xbd)]['maskingFolderPath'],_0x3540d8);return(0x0,promises_1['rm'])(_0x1fdf55,{'recursive':!![],'force':!![]});}}exports[a264_0xc74ec1(0xdb)]=DataMaskingRetentionPolicy;