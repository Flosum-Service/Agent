const a264_0x4db4ed=a264_0x123c;(function(_0x46000e,_0x161a57){const _0x547cfa=a264_0x123c,_0x26defd=_0x46000e();while(!![]){try{const _0x26043c=parseInt(_0x547cfa(0x112))/0x1+-parseInt(_0x547cfa(0x120))/0x2+-parseInt(_0x547cfa(0x123))/0x3+parseInt(_0x547cfa(0x11d))/0x4+-parseInt(_0x547cfa(0x12b))/0x5*(-parseInt(_0x547cfa(0x129))/0x6)+parseInt(_0x547cfa(0x12d))/0x7*(-parseInt(_0x547cfa(0x10e))/0x8)+parseInt(_0x547cfa(0x126))/0x9*(parseInt(_0x547cfa(0x119))/0xa);if(_0x26043c===_0x161a57)break;else _0x26defd['push'](_0x26defd['shift']());}catch(_0x26828d){_0x26defd['push'](_0x26defd['shift']());}}}(a264_0x354f,0x1acba));const a264_0x2b885d=(function(){let _0x493cce=!![];return function(_0x47aef0,_0x41c41c){const _0x29a82c=_0x493cce?function(){if(_0x41c41c){const _0x12ff80=_0x41c41c['apply'](_0x47aef0,arguments);return _0x41c41c=null,_0x12ff80;}}:function(){};return _0x493cce=![],_0x29a82c;};}()),a264_0x3d599e=a264_0x2b885d(this,function(){const _0x282e3e=a264_0x123c;return a264_0x3d599e[_0x282e3e(0x115)]()[_0x282e3e(0x118)](_0x282e3e(0x117))[_0x282e3e(0x115)]()[_0x282e3e(0x11f)](a264_0x3d599e)[_0x282e3e(0x118)](_0x282e3e(0x117));});function a264_0x354f(){const _0x2ce53e=['search','30DitlXj','push','getTime','../../data-masking/services/masking.service','445356vtnpAG','EXPIRED_RANGE_DATE','constructor','85220zEndYI','Logger','isExpiredDate','506808NVpQqQ','error','isExistsPath','245394yfJqKa','maskingFolderPath','FsUtils','338916ezXvjS','MaskingService','15kSUaCc','join','7672JxZSky','default','logger','../../shared/utils/job.utils','DataMaskingRetentionPolicy','name','filterExpiredJobs','getJobCompletedDate','1528kyPsdQ','execute','getJobsIds','__esModule','168041tszStq','readFile','../../../core','toString','parse','(((.+)+)+)+$'];a264_0x354f=function(){return _0x2ce53e;};return a264_0x354f();}a264_0x3d599e();function a264_0x123c(_0x3c1edb,_0x3d85fd){const _0x116d3=a264_0x354f();return a264_0x123c=function(_0x3d599e,_0x2b885d){_0x3d599e=_0x3d599e-0x108;let _0x354f06=_0x116d3[_0x3d599e];return _0x354f06;},a264_0x123c(_0x3c1edb,_0x3d85fd);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0xec1fa4){const _0x3ce16e=a264_0x123c;return _0xec1fa4&&_0xec1fa4[_0x3ce16e(0x111)]?_0xec1fa4:{'default':_0xec1fa4};};Object['defineProperty'](exports,a264_0x4db4ed(0x111),{'value':!![]}),exports[a264_0x4db4ed(0x10a)]=void 0x0;const promises_1=require('fs/promises'),core_1=require(a264_0x4db4ed(0x114)),utils_1=require('@flosum/utils'),job_1=require('../../../constants/job'),job_utils_1=__importDefault(require(a264_0x4db4ed(0x109))),masking_service_1=require(a264_0x4db4ed(0x11c)),path_1=__importDefault(require('path'));class DataMaskingRetentionPolicy{constructor(){const _0x31b637=a264_0x4db4ed;this[_0x31b637(0x11e)]=0x9a7ec800,this[_0x31b637(0x108)]=new core_1[(_0x31b637(0x121))](DataMaskingRetentionPolicy[_0x31b637(0x10b)]);}async[a264_0x4db4ed(0x10f)](){const _0x3a6164=a264_0x4db4ed;try{const _0x3a84e2=await job_utils_1[_0x3a6164(0x12e)][_0x3a6164(0x110)](masking_service_1[_0x3a6164(0x12a)][_0x3a6164(0x127)]),_0x4e62a8=await this[_0x3a6164(0x10c)](_0x3a84e2);for(const _0xdf1edc of _0x4e62a8){await this['deleteJob'](_0xdf1edc);}}catch(_0x3b5f03){this['logger'][_0x3a6164(0x124)](_0x3b5f03);}}async['filterExpiredJobs'](_0x265fe5){const _0x531782=a264_0x4db4ed,_0x18dedc=[];for(const _0x37a752 of _0x265fe5){const _0x34ef0f=await this[_0x531782(0x10d)](_0x37a752),_0x53e101=_0x34ef0f&&this[_0x531782(0x122)](_0x34ef0f);_0x53e101&&_0x18dedc[_0x531782(0x11a)](_0x37a752);}return _0x18dedc;}async['getJobCompletedDate'](_0x4df84b){const _0x337a29=a264_0x4db4ed;var _0x44b1c3;const _0x1fe2c9=path_1[_0x337a29(0x12e)][_0x337a29(0x12c)](masking_service_1['MaskingService']['maskingFolderPath'],_0x4df84b,job_1['JOB_LOG_STATE_FILENAME']);if(!await utils_1[_0x337a29(0x128)][_0x337a29(0x125)](_0x1fe2c9))return null;const _0x3c5def=await(0x0,promises_1[_0x337a29(0x113)])(_0x1fe2c9,{'encoding':'utf-8'});return(_0x44b1c3=JSON[_0x337a29(0x116)](_0x3c5def)['completedDate'])!==null&&_0x44b1c3!==void 0x0?_0x44b1c3:null;}[a264_0x4db4ed(0x122)](_0x41d14c){const _0x56c717=a264_0x4db4ed;return new Date()[_0x56c717(0x11b)]()-_0x41d14c>this[_0x56c717(0x11e)];}['deleteJob'](_0x5d11e8){const _0x281a2d=a264_0x4db4ed,_0x2a2a57=path_1['default'][_0x281a2d(0x12c)](masking_service_1[_0x281a2d(0x12a)]['maskingFolderPath'],_0x5d11e8);return(0x0,promises_1['rm'])(_0x2a2a57,{'recursive':!![],'force':!![]});}}exports['DataMaskingRetentionPolicy']=DataMaskingRetentionPolicy;