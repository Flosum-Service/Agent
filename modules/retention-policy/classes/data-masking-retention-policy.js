const a259_0xe37a39=a259_0x3924;(function(_0x49c906,_0x1b90e1){const _0x243418=a259_0x3924,_0x1990a0=_0x49c906();while(!![]){try{const _0x21dabd=-parseInt(_0x243418(0x1a8))/0x1*(-parseInt(_0x243418(0x1a1))/0x2)+-parseInt(_0x243418(0x19d))/0x3+parseInt(_0x243418(0x1af))/0x4*(parseInt(_0x243418(0x19f))/0x5)+-parseInt(_0x243418(0x1b6))/0x6*(parseInt(_0x243418(0x194))/0x7)+-parseInt(_0x243418(0x1b7))/0x8*(parseInt(_0x243418(0x191))/0x9)+parseInt(_0x243418(0x1a9))/0xa*(-parseInt(_0x243418(0x19e))/0xb)+parseInt(_0x243418(0x1a0))/0xc;if(_0x21dabd===_0x1b90e1)break;else _0x1990a0['push'](_0x1990a0['shift']());}catch(_0x18d566){_0x1990a0['push'](_0x1990a0['shift']());}}}(a259_0x5983,0x21cf2));const a259_0x35e9b4=(function(){let _0xe164cc=!![];return function(_0x443711,_0x238f85){const _0x4ddf6e=_0xe164cc?function(){if(_0x238f85){const _0x5e03d0=_0x238f85['apply'](_0x443711,arguments);return _0x238f85=null,_0x5e03d0;}}:function(){};return _0xe164cc=![],_0x4ddf6e;};}()),a259_0xba1d69=a259_0x35e9b4(this,function(){const _0x169da8=a259_0x3924;return a259_0xba1d69[_0x169da8(0x1b1)]()[_0x169da8(0x1b2)]('(((.+)+)+)+$')[_0x169da8(0x1b1)]()[_0x169da8(0x192)](a259_0xba1d69)['search']('(((.+)+)+)+$');});a259_0xba1d69();'use strict';var __importDefault=this&&this[a259_0xe37a39(0x1a7)]||function(_0x4741a3){const _0x4b9980=a259_0xe37a39;return _0x4741a3&&_0x4741a3[_0x4b9980(0x1a2)]?_0x4741a3:{'default':_0x4741a3};};Object[a259_0xe37a39(0x1ae)](exports,a259_0xe37a39(0x1a2),{'value':!![]}),exports[a259_0xe37a39(0x1ac)]=void 0x0;const promises_1=require(a259_0xe37a39(0x1ba)),core_1=require(a259_0xe37a39(0x1aa)),utils_1=require(a259_0xe37a39(0x198)),job_1=require(a259_0xe37a39(0x1a6)),job_utils_1=__importDefault(require(a259_0xe37a39(0x190))),masking_service_1=require(a259_0xe37a39(0x18f)),path_1=__importDefault(require(a259_0xe37a39(0x1b8)));class DataMaskingRetentionPolicy{constructor(){const _0x3b1b24=a259_0xe37a39;this[_0x3b1b24(0x1a3)]=0x9a7ec800,this['logger']=new core_1['Logger'](DataMaskingRetentionPolicy[_0x3b1b24(0x1a5)]);}async[a259_0xe37a39(0x199)](){const _0x1bfce1=a259_0xe37a39;try{const _0x1f5111=await job_utils_1[_0x1bfce1(0x1b3)][_0x1bfce1(0x1a4)](masking_service_1[_0x1bfce1(0x1ab)][_0x1bfce1(0x196)]),_0x31a65c=await this['filterExpiredJobs'](_0x1f5111);for(const _0x901931 of _0x31a65c){await this[_0x1bfce1(0x1b0)](_0x901931);}}catch(_0x323bab){this[_0x1bfce1(0x197)][_0x1bfce1(0x1b9)](_0x323bab);}}async[a259_0xe37a39(0x195)](_0x1abb2e){const _0x125c8=a259_0xe37a39,_0x5ece17=[];for(const _0x3b1a39 of _0x1abb2e){const _0x1d59c7=await this[_0x125c8(0x1b5)](_0x3b1a39),_0x33ac79=_0x1d59c7&&this['isExpiredDate'](_0x1d59c7);_0x33ac79&&_0x5ece17[_0x125c8(0x1ad)](_0x3b1a39);}return _0x5ece17;}async['getJobCompletedDate'](_0x185ec5){const _0x184aa1=a259_0xe37a39;var _0x5ae487;const _0x37073a=path_1[_0x184aa1(0x1b3)][_0x184aa1(0x19c)](masking_service_1['MaskingService']['maskingFolderPath'],_0x185ec5,job_1['JOB_LOG_STATE_FILENAME']);if(!await utils_1[_0x184aa1(0x18e)][_0x184aa1(0x1b4)](_0x37073a))return null;const _0x5a4709=await(0x0,promises_1['readFile'])(_0x37073a,{'encoding':_0x184aa1(0x19b)});return(_0x5ae487=JSON['parse'](_0x5a4709)['completedDate'])!==null&&_0x5ae487!==void 0x0?_0x5ae487:null;}[a259_0xe37a39(0x193)](_0x2791c8){const _0x5cde96=a259_0xe37a39;return new Date()[_0x5cde96(0x19a)]()-_0x2791c8>this[_0x5cde96(0x1a3)];}[a259_0xe37a39(0x1b0)](_0x8a3a85){const _0x45fe4c=a259_0xe37a39,_0x108ca0=path_1['default']['join'](masking_service_1[_0x45fe4c(0x1ab)][_0x45fe4c(0x196)],_0x8a3a85);return(0x0,promises_1['rm'])(_0x108ca0,{'recursive':!![],'force':!![]});}}function a259_0x3924(_0x19684e,_0x2a8c80){const _0x23c1f3=a259_0x5983();return a259_0x3924=function(_0xba1d69,_0x35e9b4){_0xba1d69=_0xba1d69-0x18e;let _0x598374=_0x23c1f3[_0xba1d69];return _0x598374;},a259_0x3924(_0x19684e,_0x2a8c80);}function a259_0x5983(){const _0x5f8023=['getTime','utf-8','join','794196VGQcoE','776116tqbXXw','10lOWiNF','7860336qQdeRM','8926zcdGCF','__esModule','EXPIRED_RANGE_DATE','getJobsIds','name','../../../constants/job','__importDefault','17wuwICx','10JqvhVV','../../../core','MaskingService','DataMaskingRetentionPolicy','push','defineProperty','7184NdueaP','deleteJob','toString','search','default','isExistsPath','getJobCompletedDate','36FSONiJ','1030488SyiwvT','path','error','fs/promises','FsUtils','../../data-masking/services/masking.service','../../shared/utils/job.utils','9rWlAtK','constructor','isExpiredDate','153895oBWwPL','filterExpiredJobs','maskingFolderPath','logger','@flosum/utils','execute'];a259_0x5983=function(){return _0x5f8023;};return a259_0x5983();}exports[a259_0xe37a39(0x1ac)]=DataMaskingRetentionPolicy;