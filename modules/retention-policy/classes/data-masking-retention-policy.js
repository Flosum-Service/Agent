const a308_0x32c0bd=a308_0x3ade;(function(_0x5202d3,_0x2be59b){const _0x2c4f97=a308_0x3ade,_0x4eea14=_0x5202d3();while(!![]){try{const _0x2b3022=parseInt(_0x2c4f97(0x18d))/0x1+parseInt(_0x2c4f97(0x18f))/0x2+parseInt(_0x2c4f97(0x186))/0x3+-parseInt(_0x2c4f97(0x191))/0x4+-parseInt(_0x2c4f97(0x194))/0x5*(-parseInt(_0x2c4f97(0x184))/0x6)+-parseInt(_0x2c4f97(0x18a))/0x7+-parseInt(_0x2c4f97(0x176))/0x8;if(_0x2b3022===_0x2be59b)break;else _0x4eea14['push'](_0x4eea14['shift']());}catch(_0x40d775){_0x4eea14['push'](_0x4eea14['shift']());}}}(a308_0x1bfb,0x77188));const a308_0x50ce8f=(function(){let _0x259b7b=!![];return function(_0x56578b,_0x4aa87a){const _0x1887eb=_0x259b7b?function(){const _0x3eaf70=a308_0x3ade;if(_0x4aa87a){const _0x5c25be=_0x4aa87a[_0x3eaf70(0x179)](_0x56578b,arguments);return _0x4aa87a=null,_0x5c25be;}}:function(){};return _0x259b7b=![],_0x1887eb;};}()),a308_0x456182=a308_0x50ce8f(this,function(){const _0x5139ff=a308_0x3ade;return a308_0x456182[_0x5139ff(0x195)]()[_0x5139ff(0x187)](_0x5139ff(0x16e))['toString']()[_0x5139ff(0x190)](a308_0x456182)[_0x5139ff(0x187)]('(((.+)+)+)+$');});a308_0x456182();function a308_0x3ade(_0x1431ac,_0x415767){const _0x1c21f7=a308_0x1bfb();return a308_0x3ade=function(_0x456182,_0x50ce8f){_0x456182=_0x456182-0x16e;let _0x1bfbf3=_0x1c21f7[_0x456182];return _0x1bfbf3;},a308_0x3ade(_0x1431ac,_0x415767);}'use strict';var __importDefault=this&&this[a308_0x32c0bd(0x181)]||function(_0x21ab60){const _0x1a09e6=a308_0x32c0bd;return _0x21ab60&&_0x21ab60[_0x1a09e6(0x172)]?_0x21ab60:{'default':_0x21ab60};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a308_0x32c0bd(0x182)]=void 0x0;function a308_0x1bfb(){const _0x436c10=['default','1647744ohAyQl','@flosum/utils','execute','714780vqETIa','join','957586DYQIpJ','constructor','27728aCxnHX','../../../constants/job','completedDate','5hlJIoN','toString','(((.+)+)+)+$','FsUtils','getJobsIds','EXPIRED_RANGE_DATE','__esModule','deleteJob','getTime','path','14296752bNgBcN','utf-8','maskingFolderPath','apply','JOB_LOG_STATE_FILENAME','isExpiredDate','name','isExistsPath','logger','MaskingService','getJobCompletedDate','__importDefault','DataMaskingRetentionPolicy','parse','5526798WYNkeq','filterExpiredJobs','1207584QKnFqA','search','../../data-masking/services/masking.service'];a308_0x1bfb=function(){return _0x436c10;};return a308_0x1bfb();}const promises_1=require('fs/promises'),core_1=require('../../../core'),utils_1=require(a308_0x32c0bd(0x18b)),job_1=require(a308_0x32c0bd(0x192)),job_utils_1=__importDefault(require('../../shared/utils/job.utils')),masking_service_1=require(a308_0x32c0bd(0x188)),path_1=__importDefault(require(a308_0x32c0bd(0x175)));class DataMaskingRetentionPolicy{constructor(){const _0x249a11=a308_0x32c0bd;this[_0x249a11(0x171)]=0x9a7ec800,this[_0x249a11(0x17e)]=new core_1['Logger'](DataMaskingRetentionPolicy[_0x249a11(0x17c)]);}async[a308_0x32c0bd(0x18c)](){const _0x527b54=a308_0x32c0bd;try{const _0x528e24=await job_utils_1[_0x527b54(0x189)][_0x527b54(0x170)](masking_service_1[_0x527b54(0x17f)][_0x527b54(0x178)]),_0x4a93e7=await this[_0x527b54(0x185)](_0x528e24);for(const _0x5ffd8b of _0x4a93e7){await this['deleteJob'](_0x5ffd8b);}}catch(_0x1ed23d){this[_0x527b54(0x17e)]['error'](_0x1ed23d);}}async[a308_0x32c0bd(0x185)](_0x518b86){const _0x49474c=a308_0x32c0bd,_0x20a2da=[];for(const _0x421ff5 of _0x518b86){const _0x22c319=await this['getJobCompletedDate'](_0x421ff5),_0x4c167e=_0x22c319&&this[_0x49474c(0x17b)](_0x22c319);_0x4c167e&&_0x20a2da['push'](_0x421ff5);}return _0x20a2da;}async[a308_0x32c0bd(0x180)](_0x46988d){const _0x3799dd=a308_0x32c0bd;var _0x3d82fe;const _0x2bc9d9=path_1['default']['join'](masking_service_1[_0x3799dd(0x17f)][_0x3799dd(0x178)],_0x46988d,job_1[_0x3799dd(0x17a)]);if(!await utils_1[_0x3799dd(0x16f)][_0x3799dd(0x17d)](_0x2bc9d9))return null;const _0x1d1dd3=await(0x0,promises_1['readFile'])(_0x2bc9d9,{'encoding':_0x3799dd(0x177)});return(_0x3d82fe=JSON[_0x3799dd(0x183)](_0x1d1dd3)[_0x3799dd(0x193)])!==null&&_0x3d82fe!==void 0x0?_0x3d82fe:null;}[a308_0x32c0bd(0x17b)](_0x3fe3f5){const _0x588e53=a308_0x32c0bd;return new Date()[_0x588e53(0x174)]()-_0x3fe3f5>this['EXPIRED_RANGE_DATE'];}[a308_0x32c0bd(0x173)](_0x47c4a8){const _0x19c886=a308_0x32c0bd,_0x319296=path_1[_0x19c886(0x189)][_0x19c886(0x18e)](masking_service_1[_0x19c886(0x17f)][_0x19c886(0x178)],_0x47c4a8);return(0x0,promises_1['rm'])(_0x319296,{'recursive':!![],'force':!![]});}}exports[a308_0x32c0bd(0x182)]=DataMaskingRetentionPolicy;