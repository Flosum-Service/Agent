const a259_0x37f438=a259_0x59d4;(function(_0x92a8da,_0x5ccb29){const _0x34ce9d=a259_0x59d4,_0x36002a=_0x92a8da();while(!![]){try{const _0x134e53=-parseInt(_0x34ce9d(0xe5))/0x1+-parseInt(_0x34ce9d(0xeb))/0x2*(parseInt(_0x34ce9d(0xdd))/0x3)+-parseInt(_0x34ce9d(0xdb))/0x4+parseInt(_0x34ce9d(0xd8))/0x5*(-parseInt(_0x34ce9d(0xcb))/0x6)+parseInt(_0x34ce9d(0xdc))/0x7+parseInt(_0x34ce9d(0xcc))/0x8*(parseInt(_0x34ce9d(0xd9))/0x9)+-parseInt(_0x34ce9d(0xd7))/0xa*(-parseInt(_0x34ce9d(0xda))/0xb);if(_0x134e53===_0x5ccb29)break;else _0x36002a['push'](_0x36002a['shift']());}catch(_0x4e0ad1){_0x36002a['push'](_0x36002a['shift']());}}}(a259_0x5f08,0x3148b));const a259_0x1891fb=(function(){let _0x3b773d=!![];return function(_0x5a2932,_0x4e338b){const _0x131ccd=_0x3b773d?function(){const _0x269316=a259_0x59d4;if(_0x4e338b){const _0xc1e32d=_0x4e338b[_0x269316(0xe7)](_0x5a2932,arguments);return _0x4e338b=null,_0xc1e32d;}}:function(){};return _0x3b773d=![],_0x131ccd;};}()),a259_0x2cd9b0=a259_0x1891fb(this,function(){const _0x5d908d=a259_0x59d4;return a259_0x2cd9b0[_0x5d908d(0xec)]()['search'](_0x5d908d(0xcd))[_0x5d908d(0xec)]()[_0x5d908d(0xc2)](a259_0x2cd9b0)[_0x5d908d(0xe3)](_0x5d908d(0xcd));});a259_0x2cd9b0();function a259_0x5f08(){const _0x1e2132=['Logger','apply','parse','DataMaskingRetentionPolicy','filterExpiredJobs','591758VfDvFQ','toString','FsUtils','JOB_LOG_STATE_FILENAME','constructor','getJobCompletedDate','@flosum/utils','default','__importDefault','maskingFolderPath','execute','MaskingService','deleteJob','19884fotwBU','870392plZIxG','(((.+)+)+)+$','../../../core','join','error','getTime','__esModule','../../../constants/job','defineProperty','utf-8','fs/promises','10HOCAfp','265JeFdhU','9ZhTMxI','9576611SrgPjg','1577216mcHGcr','2128518sNJIrp','3JfNUkK','../../shared/utils/job.utils','logger','EXPIRED_RANGE_DATE','isExpiredDate','isExistsPath','search','completedDate','215782MkLeaR'];a259_0x5f08=function(){return _0x1e2132;};return a259_0x5f08();}'use strict';function a259_0x59d4(_0x46feb1,_0x444199){const _0x3ca41b=a259_0x5f08();return a259_0x59d4=function(_0x2cd9b0,_0x1891fb){_0x2cd9b0=_0x2cd9b0-0xc0;let _0x5f08d0=_0x3ca41b[_0x2cd9b0];return _0x5f08d0;},a259_0x59d4(_0x46feb1,_0x444199);}var __importDefault=this&&this[a259_0x37f438(0xc6)]||function(_0x18cd90){const _0x2468b6=a259_0x37f438;return _0x18cd90&&_0x18cd90[_0x2468b6(0xd2)]?_0x18cd90:{'default':_0x18cd90};};Object[a259_0x37f438(0xd4)](exports,a259_0x37f438(0xd2),{'value':!![]}),exports['DataMaskingRetentionPolicy']=void 0x0;const promises_1=require(a259_0x37f438(0xd6)),core_1=require(a259_0x37f438(0xce)),utils_1=require(a259_0x37f438(0xc4)),job_1=require(a259_0x37f438(0xd3)),job_utils_1=__importDefault(require(a259_0x37f438(0xde))),masking_service_1=require('../../data-masking/services/masking.service'),path_1=__importDefault(require('path'));class DataMaskingRetentionPolicy{constructor(){const _0x962731=a259_0x37f438;this[_0x962731(0xe0)]=0x9a7ec800,this[_0x962731(0xdf)]=new core_1[(_0x962731(0xe6))](DataMaskingRetentionPolicy['name']);}async[a259_0x37f438(0xc8)](){const _0x48320e=a259_0x37f438;try{const _0x50370c=await job_utils_1['default']['getJobsIds'](masking_service_1[_0x48320e(0xc9)]['maskingFolderPath']),_0x12e284=await this['filterExpiredJobs'](_0x50370c);for(const _0xe5e02a of _0x12e284){await this[_0x48320e(0xca)](_0xe5e02a);}}catch(_0x358adb){this[_0x48320e(0xdf)][_0x48320e(0xd0)](_0x358adb);}}async[a259_0x37f438(0xea)](_0x5f69ee){const _0x1edc5b=a259_0x37f438,_0x2183cd=[];for(const _0x21e8b5 of _0x5f69ee){const _0x7109ff=await this[_0x1edc5b(0xc3)](_0x21e8b5),_0x39b068=_0x7109ff&&this[_0x1edc5b(0xe1)](_0x7109ff);_0x39b068&&_0x2183cd['push'](_0x21e8b5);}return _0x2183cd;}async[a259_0x37f438(0xc3)](_0x416d96){const _0x4e9b97=a259_0x37f438;var _0x29719d;const _0x586404=path_1[_0x4e9b97(0xc5)][_0x4e9b97(0xcf)](masking_service_1['MaskingService'][_0x4e9b97(0xc7)],_0x416d96,job_1[_0x4e9b97(0xc1)]);if(!await utils_1[_0x4e9b97(0xc0)][_0x4e9b97(0xe2)](_0x586404))return null;const _0x5b0c27=await(0x0,promises_1['readFile'])(_0x586404,{'encoding':_0x4e9b97(0xd5)});return(_0x29719d=JSON[_0x4e9b97(0xe8)](_0x5b0c27)[_0x4e9b97(0xe4)])!==null&&_0x29719d!==void 0x0?_0x29719d:null;}[a259_0x37f438(0xe1)](_0x45b697){const _0x5f41df=a259_0x37f438;return new Date()[_0x5f41df(0xd1)]()-_0x45b697>this[_0x5f41df(0xe0)];}['deleteJob'](_0x4a37de){const _0x484d72=a259_0x37f438,_0x2cb9c1=path_1[_0x484d72(0xc5)]['join'](masking_service_1['MaskingService'][_0x484d72(0xc7)],_0x4a37de);return(0x0,promises_1['rm'])(_0x2cb9c1,{'recursive':!![],'force':!![]});}}exports[a259_0x37f438(0xe9)]=DataMaskingRetentionPolicy;