const a258_0x3dfc95=a258_0x4aed;(function(_0x429e2f,_0x99748b){const _0x33da54=a258_0x4aed,_0x230f6c=_0x429e2f();while(!![]){try{const _0x5a1d7a=parseInt(_0x33da54(0x130))/0x1+parseInt(_0x33da54(0x137))/0x2*(-parseInt(_0x33da54(0x12d))/0x3)+parseInt(_0x33da54(0x11f))/0x4+-parseInt(_0x33da54(0x12e))/0x5+parseInt(_0x33da54(0x12a))/0x6+parseInt(_0x33da54(0x13d))/0x7+parseInt(_0x33da54(0x12c))/0x8*(-parseInt(_0x33da54(0x120))/0x9);if(_0x5a1d7a===_0x99748b)break;else _0x230f6c['push'](_0x230f6c['shift']());}catch(_0xd29dd6){_0x230f6c['push'](_0x230f6c['shift']());}}}(a258_0x1633,0x31bb7));function a258_0x1633(){const _0xfa942c=['106854GEVWGQ','1586600bqqTiw','getTime','28399RtoyBm','(((.+)+)+)+$','error','default','toString','MaskingService','fs/promises','18OGjtHL','Logger','name','search','EXPIRED_RANGE_DATE','parse','2595558aKrbak','filterExpiredJobs','../../../core','maskingFolderPath','getJobCompletedDate','../../shared/utils/job.utils','FsUtils','push','1171128sETNiS','59931UAooCr','join','isExistsPath','getJobsIds','isExpiredDate','DataMaskingRetentionPolicy','logger','__esModule','path','apply','1457016uJdXGt','utf-8','112dAOlvH'];a258_0x1633=function(){return _0xfa942c;};return a258_0x1633();}const a258_0x51f672=(function(){let _0x21ef85=!![];return function(_0x2e5ad7,_0x225932){const _0x42dcd7=_0x21ef85?function(){const _0x244314=a258_0x4aed;if(_0x225932){const _0x5a01f5=_0x225932[_0x244314(0x129)](_0x2e5ad7,arguments);return _0x225932=null,_0x5a01f5;}}:function(){};return _0x21ef85=![],_0x42dcd7;};}()),a258_0x470d05=a258_0x51f672(this,function(){const _0x85baf9=a258_0x4aed;return a258_0x470d05['toString']()[_0x85baf9(0x13a)](_0x85baf9(0x131))[_0x85baf9(0x134)]()['constructor'](a258_0x470d05)[_0x85baf9(0x13a)]('(((.+)+)+)+$');});function a258_0x4aed(_0x33fb50,_0x16190f){const _0x49dedf=a258_0x1633();return a258_0x4aed=function(_0x470d05,_0x51f672){_0x470d05=_0x470d05-0x11b;let _0x163393=_0x49dedf[_0x470d05];return _0x163393;},a258_0x4aed(_0x33fb50,_0x16190f);}a258_0x470d05();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x24bbb6){const _0x28b115=a258_0x4aed;return _0x24bbb6&&_0x24bbb6[_0x28b115(0x127)]?_0x24bbb6:{'default':_0x24bbb6};};Object['defineProperty'](exports,a258_0x3dfc95(0x127),{'value':!![]}),exports[a258_0x3dfc95(0x125)]=void 0x0;const promises_1=require(a258_0x3dfc95(0x136)),core_1=require(a258_0x3dfc95(0x13f)),utils_1=require('@flosum/utils'),job_1=require('../../../constants/job'),job_utils_1=__importDefault(require(a258_0x3dfc95(0x11c))),masking_service_1=require('../../data-masking/services/masking.service'),path_1=__importDefault(require(a258_0x3dfc95(0x128)));class DataMaskingRetentionPolicy{constructor(){const _0x1bbd43=a258_0x3dfc95;this[_0x1bbd43(0x13b)]=0x9a7ec800,this[_0x1bbd43(0x126)]=new core_1[(_0x1bbd43(0x138))](DataMaskingRetentionPolicy[_0x1bbd43(0x139)]);}async['execute'](){const _0x318847=a258_0x3dfc95;try{const _0x12df34=await job_utils_1[_0x318847(0x133)][_0x318847(0x123)](masking_service_1[_0x318847(0x135)][_0x318847(0x140)]),_0x136435=await this['filterExpiredJobs'](_0x12df34);for(const _0x574dd6 of _0x136435){await this['deleteJob'](_0x574dd6);}}catch(_0x24c645){this[_0x318847(0x126)][_0x318847(0x132)](_0x24c645);}}async[a258_0x3dfc95(0x13e)](_0x87482d){const _0x1b23cd=a258_0x3dfc95,_0x530dd4=[];for(const _0x2e372a of _0x87482d){const _0x411816=await this[_0x1b23cd(0x11b)](_0x2e372a),_0x35401a=_0x411816&&this[_0x1b23cd(0x124)](_0x411816);_0x35401a&&_0x530dd4[_0x1b23cd(0x11e)](_0x2e372a);}return _0x530dd4;}async[a258_0x3dfc95(0x11b)](_0x3b646c){const _0x52687f=a258_0x3dfc95;var _0x5823dd;const _0xd63947=path_1[_0x52687f(0x133)][_0x52687f(0x121)](masking_service_1[_0x52687f(0x135)][_0x52687f(0x140)],_0x3b646c,job_1['JOB_LOG_STATE_FILENAME']);if(!await utils_1[_0x52687f(0x11d)][_0x52687f(0x122)](_0xd63947))return null;const _0xf37154=await(0x0,promises_1['readFile'])(_0xd63947,{'encoding':_0x52687f(0x12b)});return(_0x5823dd=JSON[_0x52687f(0x13c)](_0xf37154)['completedDate'])!==null&&_0x5823dd!==void 0x0?_0x5823dd:null;}[a258_0x3dfc95(0x124)](_0x499f86){const _0x430a15=a258_0x3dfc95;return new Date()[_0x430a15(0x12f)]()-_0x499f86>this[_0x430a15(0x13b)];}['deleteJob'](_0x58fc47){const _0x56449e=a258_0x3dfc95,_0x97547b=path_1[_0x56449e(0x133)][_0x56449e(0x121)](masking_service_1[_0x56449e(0x135)][_0x56449e(0x140)],_0x58fc47);return(0x0,promises_1['rm'])(_0x97547b,{'recursive':!![],'force':!![]});}}exports[a258_0x3dfc95(0x125)]=DataMaskingRetentionPolicy;