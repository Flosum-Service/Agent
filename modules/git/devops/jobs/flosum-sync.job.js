const a107_0x46a6e8=a107_0x4651;(function(_0x594922,_0x582a42){const _0x2da9f9=a107_0x4651,_0x4290d4=_0x594922();while(!![]){try{const _0x5bddde=-parseInt(_0x2da9f9(0x163))/0x1*(parseInt(_0x2da9f9(0x15d))/0x2)+parseInt(_0x2da9f9(0x194))/0x3+parseInt(_0x2da9f9(0x179))/0x4*(-parseInt(_0x2da9f9(0x169))/0x5)+-parseInt(_0x2da9f9(0x15b))/0x6*(-parseInt(_0x2da9f9(0x183))/0x7)+parseInt(_0x2da9f9(0x160))/0x8*(-parseInt(_0x2da9f9(0x17a))/0x9)+parseInt(_0x2da9f9(0x156))/0xa*(-parseInt(_0x2da9f9(0x190))/0xb)+parseInt(_0x2da9f9(0x180))/0xc*(parseInt(_0x2da9f9(0x19a))/0xd);if(_0x5bddde===_0x582a42)break;else _0x4290d4['push'](_0x4290d4['shift']());}catch(_0x5f3c60){_0x4290d4['push'](_0x4290d4['shift']());}}}(a107_0x52ea,0xa03dc));const a107_0x26e811=(function(){let _0x5b4c0c=!![];return function(_0x1a14af,_0xe8942){const _0x3f1a64=_0x5b4c0c?function(){const _0x48c4bf=a107_0x4651;if(_0xe8942){const _0x1a60b2=_0xe8942[_0x48c4bf(0x185)](_0x1a14af,arguments);return _0xe8942=null,_0x1a60b2;}}:function(){};return _0x5b4c0c=![],_0x3f1a64;};}()),a107_0x2cbf20=a107_0x26e811(this,function(){const _0x4d9cbb=a107_0x4651;return a107_0x2cbf20[_0x4d9cbb(0x145)]()[_0x4d9cbb(0x162)](_0x4d9cbb(0x167))['toString']()[_0x4d9cbb(0x16b)](a107_0x2cbf20)[_0x4d9cbb(0x162)](_0x4d9cbb(0x167));});a107_0x2cbf20();function a107_0x4651(_0x3cd272,_0x45dc83){const _0x5ed76e=a107_0x52ea();return a107_0x4651=function(_0x2cbf20,_0x26e811){_0x2cbf20=_0x2cbf20-0x13e;let _0x52ea0d=_0x5ed76e[_0x2cbf20];return _0x52ea0d;},a107_0x4651(_0x3cd272,_0x45dc83);}'use strict';var __decorate=this&&this[a107_0x46a6e8(0x186)]||function(_0x39cedc,_0x264fc4,_0x191fc1,_0x7620f9){const _0x52d0f6=a107_0x46a6e8;var _0x4d95b3=arguments[_0x52d0f6(0x148)],_0x58cc36=_0x4d95b3<0x3?_0x264fc4:_0x7620f9===null?_0x7620f9=Object[_0x52d0f6(0x17e)](_0x264fc4,_0x191fc1):_0x7620f9,_0x17085e;if(typeof Reflect===_0x52d0f6(0x181)&&typeof Reflect[_0x52d0f6(0x14a)]===_0x52d0f6(0x143))_0x58cc36=Reflect[_0x52d0f6(0x14a)](_0x39cedc,_0x264fc4,_0x191fc1,_0x7620f9);else{for(var _0x151714=_0x39cedc[_0x52d0f6(0x148)]-0x1;_0x151714>=0x0;_0x151714--)if(_0x17085e=_0x39cedc[_0x151714])_0x58cc36=(_0x4d95b3<0x3?_0x17085e(_0x58cc36):_0x4d95b3>0x3?_0x17085e(_0x264fc4,_0x191fc1,_0x58cc36):_0x17085e(_0x264fc4,_0x191fc1))||_0x58cc36;}return _0x4d95b3>0x3&&_0x58cc36&&Object['defineProperty'](_0x264fc4,_0x191fc1,_0x58cc36),_0x58cc36;},__metadata=this&&this[a107_0x46a6e8(0x18f)]||function(_0x15fdff,_0x1df942){const _0x26f620=a107_0x46a6e8;if(typeof Reflect===_0x26f620(0x181)&&typeof Reflect[_0x26f620(0x19c)]==='function')return Reflect['metadata'](_0x15fdff,_0x1df942);};Object[a107_0x46a6e8(0x155)](exports,a107_0x46a6e8(0x149),{'value':!![]}),exports[a107_0x46a6e8(0x141)]=void 0x0;function a107_0x52ea(){const _0xb7d99f=['repositoryName','SalesforceService','getRemoteStateAttachmentId','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','salesforceSync','log','./commit-components.job','8iFtlJI','5332347DFHhEd','syncData','message','setStatus','getOwnPropertyDescriptor','then','22181736XYpTGa','object','components','46333fNXoMb','string','apply','__decorate','salesforceService','repo','sfLogger','user','lastCommit','\x20Start\x20Flosum\x20sync\x20job','force','DEFAULT_GIT_USER_NAME','__metadata','239569RiOzVJ','repository','\x20Flosum\x20sync\x20job\x20done.','updateRemoteState','3592731GtrSGB','../../salesforce/services/salesforce-retriever.service','getCommitDto','send','Container','prefix','13pyiGsC','\x20Checking\x20sync\x20status.','metadata','getBranchComponents','commitJob','Service','FlosumSyncJob','design:paramtypes','function','SalesforceRetrieverService','toString','branch','\x20Checking\x20repository\x20on\x20Flosum\x20side.','length','__esModule','decorate','branches','updateLastCommit','checkSyncStatus','Sync\x20repository','getComponents','gitUrl','../../salesforce/services/salesforce-logger-v3.service',']\x20[Branch:\x20','createBranchIfNotExists','CommitComponentsJob','defineProperty','130IUxLLW','\x20Update\x20remote\x20state.','\x20Branch\x20synchronized.\x20Skip','provider','CommitComponentsDto','186fPZZtT','branchName','12xNLjwD','In\x20Progress','SalesforceSyncService','8ysYUzt','getComponentsFromRepository','search','218510VNfpdw','sha','../../../../constants','getOne','(((.+)+)+)+$','catch','1020565oSOguT','branchId','constructor','repositoryId','getComponentIds','recordTypeName','run','../../salesforce/services/salesforce.service','convertToSFDX'];a107_0x52ea=function(){return _0xb7d99f;};return a107_0x52ea();}const salesforce_logger_v3_service_1=require(a107_0x46a6e8(0x151)),typedi_1=require('typedi'),constants_1=require(a107_0x46a6e8(0x165)),salesforce_retriever_service_1=require(a107_0x46a6e8(0x195)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a107_0x46a6e8(0x170)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a107_0x46a6e8(0x178));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x2c7ad4,_0x573169,_0xe94196){const _0x1c2164=a107_0x46a6e8;this[_0x1c2164(0x176)]=_0x2c7ad4,this['salesforceService']=_0x573169,this[_0x1c2164(0x13f)]=_0xe94196;}async['createBranchIfNotExists'](){const _0x16bc44=a107_0x46a6e8;let _0xa8350b=await this[_0x16bc44(0x191)][_0x16bc44(0x14b)]['getOne'](this[_0x16bc44(0x17b)][_0x16bc44(0x15c)])[_0x16bc44(0x168)](()=>null);!_0xa8350b&&(_0xa8350b=await this['repository']['branches']['create']({'name':this['syncData'][_0x16bc44(0x15c)]})),this[_0x16bc44(0x146)]=_0xa8350b;}async[a107_0x46a6e8(0x16d)](){const _0x16a2c2=a107_0x46a6e8;return this[_0x16a2c2(0x17b)][_0x16a2c2(0x16c)]?this[_0x16a2c2(0x176)][_0x16a2c2(0x161)](this['syncData']['repositoryId']):this['salesforceSync'][_0x16a2c2(0x13e)](this[_0x16a2c2(0x17b)][_0x16a2c2(0x16a)]);}async['getComponents'](){const _0x3c4879=a107_0x46a6e8,_0x42fbcc=await this[_0x3c4879(0x16d)](),_0x43c139=new salesforce_retriever_service_1[(_0x3c4879(0x144))](this[_0x3c4879(0x187)]),_0x2deaec=await _0x43c139[_0x3c4879(0x16f)](_0x42fbcc);return _0x2deaec;}async[a107_0x46a6e8(0x196)](_0x3cce02){const _0x463f2a=a107_0x46a6e8,_0xa1b4e1=new commit_components_dto_1[(_0x463f2a(0x15a))]();return _0xa1b4e1[_0x463f2a(0x17c)]=_0x463f2a(0x14e),_0xa1b4e1[_0x463f2a(0x18a)]={'name':constants_1[_0x463f2a(0x18e)],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0xa1b4e1[_0x463f2a(0x182)]={'writed':await this[_0x463f2a(0x14f)]()},_0xa1b4e1[_0x463f2a(0x171)]=_0x3cce02,_0xa1b4e1[_0x463f2a(0x188)]=this['repository'],_0xa1b4e1[_0x463f2a(0x146)]=this[_0x463f2a(0x146)],_0xa1b4e1[_0x463f2a(0x18d)]=!![],_0xa1b4e1[_0x463f2a(0x159)]=this[_0x463f2a(0x159)],_0xa1b4e1['recordType']=this[_0x463f2a(0x17b)][_0x463f2a(0x16e)],_0xa1b4e1;}async[a107_0x46a6e8(0x14d)](){const _0x56d6ee=a107_0x46a6e8,_0x2bb1ac=await this[_0x56d6ee(0x176)][_0x56d6ee(0x174)](this[_0x56d6ee(0x17b)]),_0x5ac9a4=await this['salesforceService']['retrieveAttachment'](_0x2bb1ac)[_0x56d6ee(0x17f)](_0x575c6b=>typeof _0x575c6b===_0x56d6ee(0x184)?JSON['parse'](_0x575c6b):_0x575c6b)[_0x56d6ee(0x168)](()=>({}));if(_0x5ac9a4[this[_0x56d6ee(0x191)][_0x56d6ee(0x150)]]){if(_0x5ac9a4[this[_0x56d6ee(0x191)][_0x56d6ee(0x150)]][_0x56d6ee(0x18b)]===this[_0x56d6ee(0x146)]['sha'])return!![];}return![];}async['updateLastCommit'](){const _0x241f97=a107_0x46a6e8,_0x23dff6=await this[_0x241f97(0x191)][_0x241f97(0x14b)][_0x241f97(0x166)](this[_0x241f97(0x146)]['name']);await this[_0x241f97(0x189)]['log'](this[_0x241f97(0x199)]+_0x241f97(0x157));const _0x503477={[this[_0x241f97(0x191)][_0x241f97(0x150)]]:{'lastCommit':_0x23dff6[_0x241f97(0x164)]}};await this[_0x241f97(0x176)][_0x241f97(0x193)](this[_0x241f97(0x17b)],_0x503477);}async[a107_0x46a6e8(0x16f)]({syncRecord:_0x2a1517,repository:_0x46407e,convertToSFDX:_0xfd8fd2,provider:_0x3c2967}){const _0x4ec831=a107_0x46a6e8;this['syncData']=_0x2a1517,this['provider']=_0x3c2967,this[_0x4ec831(0x191)]=_0x46407e,this['sfLogger']=typedi_1[_0x4ec831(0x198)]['get'](salesforce_logger_v3_service_1['SalesforceLogger3']),this['prefix']=_0x4ec831(0x175)+this[_0x4ec831(0x17b)][_0x4ec831(0x172)]+_0x4ec831(0x152)+this['syncData'][_0x4ec831(0x15c)]+']';try{await this[_0x4ec831(0x189)]['log'](this['prefix']+_0x4ec831(0x18c))[_0x4ec831(0x197)](),await this[_0x4ec831(0x176)][_0x4ec831(0x17d)](this[_0x4ec831(0x17b)],_0x4ec831(0x15e)),this[_0x4ec831(0x189)][_0x4ec831(0x177)](this[_0x4ec831(0x199)]+_0x4ec831(0x147)),await this[_0x4ec831(0x153)](),await this[_0x4ec831(0x189)]['log'](this[_0x4ec831(0x199)]+_0x4ec831(0x19b))['send']();const _0x5940fd=await this[_0x4ec831(0x14d)]();this[_0x4ec831(0x189)][_0x4ec831(0x177)](this['prefix']+'\x20Sync\x20status\x20'+_0x5940fd+'.');if(_0x5940fd){await this[_0x4ec831(0x176)][_0x4ec831(0x17d)](this[_0x4ec831(0x17b)],'Completed'),await this[_0x4ec831(0x189)][_0x4ec831(0x177)](this['prefix']+_0x4ec831(0x158))[_0x4ec831(0x197)]();return;}const _0x4dd3be=await this['getCommitDto'](_0xfd8fd2);await this['commitJob'][_0x4ec831(0x16f)](_0x4dd3be,this[_0x4ec831(0x199)]),await this['salesforceSync'][_0x4ec831(0x17d)](this[_0x4ec831(0x17b)],'Completed'),await this[_0x4ec831(0x14c)](),this[_0x4ec831(0x189)][_0x4ec831(0x177)](this[_0x4ec831(0x199)]+_0x4ec831(0x192));}catch(_0x5af748){throw _0x5af748;}finally{await this[_0x4ec831(0x189)]['send']();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a107_0x46a6e8(0x140)])({'transient':!![]}),__metadata(a107_0x46a6e8(0x142),[salesforce_sync_service_1[a107_0x46a6e8(0x15f)],salesforce_service_1[a107_0x46a6e8(0x173)],commit_components_job_1[a107_0x46a6e8(0x154)]])],FlosumSyncJob),exports['FlosumSyncJob']=FlosumSyncJob;