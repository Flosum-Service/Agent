const a106_0x3d59f0=a106_0x13de;(function(_0x188e08,_0x4f3fe3){const _0x3ee79e=a106_0x13de,_0x542cf9=_0x188e08();while(!![]){try{const _0x1be80d=parseInt(_0x3ee79e(0xdb))/0x1*(parseInt(_0x3ee79e(0xf7))/0x2)+-parseInt(_0x3ee79e(0xf4))/0x3+-parseInt(_0x3ee79e(0xe2))/0x4+-parseInt(_0x3ee79e(0xe1))/0x5*(parseInt(_0x3ee79e(0xd4))/0x6)+parseInt(_0x3ee79e(0xc1))/0x7+-parseInt(_0x3ee79e(0xe8))/0x8+parseInt(_0x3ee79e(0xe0))/0x9*(parseInt(_0x3ee79e(0xae))/0xa);if(_0x1be80d===_0x4f3fe3)break;else _0x542cf9['push'](_0x542cf9['shift']());}catch(_0x5ecdd6){_0x542cf9['push'](_0x542cf9['shift']());}}}(a106_0x40ee,0xb859e));const a106_0x58ba8a=(function(){let _0xf9a9d5=!![];return function(_0x10887f,_0x38233c){const _0x153f97=_0xf9a9d5?function(){const _0x5b0a72=a106_0x13de;if(_0x38233c){const _0xb035d7=_0x38233c[_0x5b0a72(0xec)](_0x10887f,arguments);return _0x38233c=null,_0xb035d7;}}:function(){};return _0xf9a9d5=![],_0x153f97;};}()),a106_0x1999a6=a106_0x58ba8a(this,function(){const _0x3086ad=a106_0x13de;return a106_0x1999a6[_0x3086ad(0xf5)]()[_0x3086ad(0xd2)]('(((.+)+)+)+$')['toString']()[_0x3086ad(0xf9)](a106_0x1999a6)[_0x3086ad(0xd2)](_0x3086ad(0xc4));});function a106_0x13de(_0x3d30e2,_0x5efc6d){const _0x181d4f=a106_0x40ee();return a106_0x13de=function(_0x1999a6,_0x58ba8a){_0x1999a6=_0x1999a6-0xac;let _0x40ee66=_0x181d4f[_0x1999a6];return _0x40ee66;},a106_0x13de(_0x3d30e2,_0x5efc6d);}a106_0x1999a6();'use strict';var __decorate=this&&this[a106_0x3d59f0(0xfa)]||function(_0x5657e5,_0x4ed8be,_0x397e60,_0x55b2d1){const _0x46e5d7=a106_0x3d59f0;var _0xb10397=arguments[_0x46e5d7(0xb6)],_0x438d0e=_0xb10397<0x3?_0x4ed8be:_0x55b2d1===null?_0x55b2d1=Object[_0x46e5d7(0xe6)](_0x4ed8be,_0x397e60):_0x55b2d1,_0x192647;if(typeof Reflect==='object'&&typeof Reflect[_0x46e5d7(0xbf)]==='function')_0x438d0e=Reflect['decorate'](_0x5657e5,_0x4ed8be,_0x397e60,_0x55b2d1);else{for(var _0x540e8c=_0x5657e5['length']-0x1;_0x540e8c>=0x0;_0x540e8c--)if(_0x192647=_0x5657e5[_0x540e8c])_0x438d0e=(_0xb10397<0x3?_0x192647(_0x438d0e):_0xb10397>0x3?_0x192647(_0x4ed8be,_0x397e60,_0x438d0e):_0x192647(_0x4ed8be,_0x397e60))||_0x438d0e;}return _0xb10397>0x3&&_0x438d0e&&Object[_0x46e5d7(0xe5)](_0x4ed8be,_0x397e60,_0x438d0e),_0x438d0e;},__metadata=this&&this[a106_0x3d59f0(0xc6)]||function(_0x4bacda,_0x233248){const _0x244123=a106_0x3d59f0;if(typeof Reflect==='object'&&typeof Reflect[_0x244123(0xb5)]===_0x244123(0xcc))return Reflect[_0x244123(0xb5)](_0x4bacda,_0x233248);};Object[a106_0x3d59f0(0xe5)](exports,a106_0x3d59f0(0xdd),{'value':!![]}),exports[a106_0x3d59f0(0xd1)]=void 0x0;const salesforce_logger_v3_service_1=require('../../salesforce/services/salesforce-logger-v3.service'),typedi_1=require('typedi'),constants_1=require(a106_0x3d59f0(0xd9)),salesforce_retriever_service_1=require(a106_0x3d59f0(0xfe)),salesforce_sync_service_1=require(a106_0x3d59f0(0xda)),salesforce_service_1=require(a106_0x3d59f0(0xf2)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a106_0x3d59f0(0xd8));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x3aaac6,_0x19114e,_0x51af3b){const _0x2f6beb=a106_0x3d59f0;this[_0x2f6beb(0x102)]=_0x3aaac6,this['salesforceService']=_0x19114e,this[_0x2f6beb(0xb4)]=_0x51af3b;}async[a106_0x3d59f0(0xdc)](){const _0x28e34d=a106_0x3d59f0;let _0x24aea9=await this['repository'][_0x28e34d(0xf6)][_0x28e34d(0xce)](this[_0x28e34d(0x100)][_0x28e34d(0xc2)])[_0x28e34d(0xba)](()=>null);!_0x24aea9&&(_0x24aea9=await this[_0x28e34d(0xc5)][_0x28e34d(0xf6)]['create']({'name':this[_0x28e34d(0x100)][_0x28e34d(0xc2)]})),this[_0x28e34d(0xd3)]=_0x24aea9;}async[a106_0x3d59f0(0xea)](){const _0x41e0e2=a106_0x3d59f0;return this[_0x41e0e2(0x100)][_0x41e0e2(0xf1)]?this[_0x41e0e2(0x102)][_0x41e0e2(0xde)](this[_0x41e0e2(0x100)]['repositoryId']):this[_0x41e0e2(0x102)][_0x41e0e2(0xfd)](this[_0x41e0e2(0x100)]['branchId']);}async[a106_0x3d59f0(0xb3)](){const _0x53be66=a106_0x3d59f0,_0x3fbf6f=await this[_0x53be66(0xea)](),_0x2ef3d6=new salesforce_retriever_service_1[(_0x53be66(0xb2))](this[_0x53be66(0xb7)]),_0x4e155c=await _0x2ef3d6['run'](_0x3fbf6f);return _0x4e155c;}async[a106_0x3d59f0(0xe3)](_0x324f2b){const _0x3cece9=a106_0x3d59f0,_0x534900=new commit_components_dto_1['CommitComponentsDto']();return _0x534900['message']=_0x3cece9(0xbc),_0x534900[_0x3cece9(0xbb)]={'name':constants_1[_0x3cece9(0xdf)],'email':constants_1[_0x3cece9(0xfb)]},_0x534900[_0x3cece9(0xb9)]={'writed':await this['getComponents']()},_0x534900[_0x3cece9(0xca)]=_0x324f2b,_0x534900[_0x3cece9(0xfc)]=this['repository'],_0x534900['branch']=this[_0x3cece9(0xd3)],_0x534900[_0x3cece9(0xc7)]=!![],_0x534900[_0x3cece9(0xac)]=this['provider'],_0x534900;}async[a106_0x3d59f0(0xf0)](){const _0x53b593=a106_0x3d59f0,_0x5e2c50=await this['salesforceSync'][_0x53b593(0xe9)](this[_0x53b593(0x100)]),_0x491305=await this['salesforceService'][_0x53b593(0xcd)](_0x5e2c50)[_0x53b593(0xcb)](_0x170bdd=>typeof _0x170bdd===_0x53b593(0xd7)?JSON[_0x53b593(0xf8)](_0x170bdd):_0x170bdd)[_0x53b593(0xba)](()=>({}));if(_0x491305[this['repository'][_0x53b593(0xff)]]){if(_0x491305[this[_0x53b593(0xc5)][_0x53b593(0xff)]]['lastCommit']===this[_0x53b593(0xd3)][_0x53b593(0xe4)])return!![];}return![];}async[a106_0x3d59f0(0xb1)](){const _0x568426=a106_0x3d59f0,_0x52888b=await this['repository'][_0x568426(0xf6)][_0x568426(0xce)](this[_0x568426(0xd3)][_0x568426(0xcf)]);await this['sfLogger']['log'](this['prefix']+_0x568426(0xb8));const _0x17078f={[this[_0x568426(0xc5)][_0x568426(0xff)]]:{'lastCommit':_0x52888b[_0x568426(0xe4)]}};await this['salesforceSync']['updateRemoteState'](this[_0x568426(0x100)],_0x17078f);}async[a106_0x3d59f0(0xe7)]({syncRecord:_0x3a8a38,repository:_0x527830,convertToSFDX:_0x465e03,provider:_0x463ea9}){const _0xdff698=a106_0x3d59f0;this[_0xdff698(0x100)]=_0x3a8a38,this['provider']=_0x463ea9,this[_0xdff698(0xc5)]=_0x527830,this[_0xdff698(0xd5)]=typedi_1[_0xdff698(0xd6)][_0xdff698(0xed)](salesforce_logger_v3_service_1['SalesforceLogger3']),this[_0xdff698(0xbd)]=_0xdff698(0xef)+this[_0xdff698(0x100)][_0xdff698(0xc3)]+_0xdff698(0xbe)+this[_0xdff698(0x100)][_0xdff698(0xc2)]+']';try{await this[_0xdff698(0xd5)][_0xdff698(0xd0)](this[_0xdff698(0xbd)]+'\x20Start\x20Flosum\x20sync\x20job')[_0xdff698(0xc0)](),await this[_0xdff698(0x102)][_0xdff698(0xad)](this[_0xdff698(0x100)],'In\x20Progress'),this[_0xdff698(0xd5)]['log'](this[_0xdff698(0xbd)]+_0xdff698(0xaf)),await this[_0xdff698(0xdc)](),await this[_0xdff698(0xd5)][_0xdff698(0xd0)](this[_0xdff698(0xbd)]+_0xdff698(0xb0))['send']();const _0x4f6b21=await this['checkSyncStatus']();this[_0xdff698(0xd5)][_0xdff698(0xd0)](this[_0xdff698(0xbd)]+'\x20Sync\x20status\x20'+_0x4f6b21+'.');if(_0x4f6b21){await this['salesforceSync'][_0xdff698(0xad)](this[_0xdff698(0x100)],_0xdff698(0xc8)),await this[_0xdff698(0xd5)][_0xdff698(0xd0)](this['prefix']+_0xdff698(0xeb))[_0xdff698(0xc0)]();return;}const _0x34cadc=await this[_0xdff698(0xe3)](_0x465e03);await this['commitJob'][_0xdff698(0xe7)](_0x34cadc,this[_0xdff698(0xbd)]),await this['salesforceSync']['setStatus'](this[_0xdff698(0x100)],_0xdff698(0xc8)),await this[_0xdff698(0xb1)](),this[_0xdff698(0xd5)][_0xdff698(0xd0)](this['prefix']+'\x20Flosum\x20sync\x20job\x20done.');}catch(_0x2ab25e){throw _0x2ab25e;}finally{await this[_0xdff698(0xd5)][_0xdff698(0xc0)]();}}};function a106_0x40ee(){const _0x483796=['prefix',']\x20[Branch:\x20','decorate','send','904610LTDzNI','branchName','repositoryName','(((.+)+)+)+$','repository','__metadata','force','Completed','design:paramtypes','convertToSFDX','then','function','retrieveAttachment','getOne','name','log','FlosumSyncJob','search','branch','6uugVPa','sfLogger','Container','string','./commit-components.job','../../../../constants','../../salesforce/services/salesforce-sync.service','350066ldAgWH','createBranchIfNotExists','__esModule','getComponentsFromRepository','DEFAULT_GIT_USER_NAME','9SpEGCW','6370955OcgDqd','1853160HovvpW','getCommitDto','sha','defineProperty','getOwnPropertyDescriptor','run','7789184hhurfX','getRemoteStateAttachmentId','getComponentIds','\x20Branch\x20synchronized.\x20Skip','apply','get','Service','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','checkSyncStatus','repositoryId','../../salesforce/services/salesforce.service','SalesforceService','154404HYPfjn','toString','branches','4pNcPQS','parse','constructor','__decorate','DEFAULT_GIT_USER_EMAIL','repo','getBranchComponents','../../salesforce/services/salesforce-retriever.service','gitUrl','syncData','SalesforceSyncService','salesforceSync','provider','setStatus','26883370dSqrdv','\x20Checking\x20repository\x20on\x20Flosum\x20side.','\x20Checking\x20sync\x20status.','updateLastCommit','SalesforceRetrieverService','getComponents','commitJob','metadata','length','salesforceService','\x20Update\x20remote\x20state.','components','catch','user','Sync\x20repository'];a106_0x40ee=function(){return _0x483796;};return a106_0x40ee();}FlosumSyncJob=__decorate([(0x0,typedi_1[a106_0x3d59f0(0xee)])({'transient':!![]}),__metadata(a106_0x3d59f0(0xc9),[salesforce_sync_service_1[a106_0x3d59f0(0x101)],salesforce_service_1[a106_0x3d59f0(0xf3)],commit_components_job_1['CommitComponentsJob']])],FlosumSyncJob),exports['FlosumSyncJob']=FlosumSyncJob;