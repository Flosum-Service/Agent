const a106_0x9f8da2=a106_0x5340;(function(_0x172b16,_0x332e2e){const _0x124cff=a106_0x5340,_0x480fdd=_0x172b16();while(!![]){try{const _0xb8650=parseInt(_0x124cff(0x1f6))/0x1+-parseInt(_0x124cff(0x21d))/0x2*(parseInt(_0x124cff(0x204))/0x3)+parseInt(_0x124cff(0x225))/0x4*(parseInt(_0x124cff(0x1ef))/0x5)+-parseInt(_0x124cff(0x238))/0x6*(parseInt(_0x124cff(0x1f2))/0x7)+-parseInt(_0x124cff(0x22c))/0x8*(-parseInt(_0x124cff(0x1dc))/0x9)+-parseInt(_0x124cff(0x1df))/0xa*(parseInt(_0x124cff(0x1e9))/0xb)+-parseInt(_0x124cff(0x21a))/0xc*(-parseInt(_0x124cff(0x1f9))/0xd);if(_0xb8650===_0x332e2e)break;else _0x480fdd['push'](_0x480fdd['shift']());}catch(_0x4fc45c){_0x480fdd['push'](_0x480fdd['shift']());}}}(a106_0x1c54,0x1d15c));const a106_0x105e85=(function(){let _0x5232d2=!![];return function(_0x31c579,_0x4b295e){const _0x3cab8d=_0x5232d2?function(){const _0x2b3031=a106_0x5340;if(_0x4b295e){const _0x495a7b=_0x4b295e[_0x2b3031(0x227)](_0x31c579,arguments);return _0x4b295e=null,_0x495a7b;}}:function(){};return _0x5232d2=![],_0x3cab8d;};}()),a106_0x5e4282=a106_0x105e85(this,function(){const _0x2c6ba9=a106_0x5340;return a106_0x5e4282[_0x2c6ba9(0x22a)]()[_0x2c6ba9(0x214)](_0x2c6ba9(0x1ec))[_0x2c6ba9(0x22a)]()[_0x2c6ba9(0x208)](a106_0x5e4282)[_0x2c6ba9(0x214)](_0x2c6ba9(0x1ec));});function a106_0x1c54(){const _0xed83b3=['Completed','6BkgRrO','typedi','9giyxZD','./commit-components.job','\x20Update\x20remote\x20state.','10hWBMWx','create','CommitComponentsDto','../dto/commit-components.dto','getOne','getCommitDto','getOwnPropertyDescriptor','__esModule','getComponentIds','DEFAULT_GIT_USER_EMAIL','1620982ewxxIf','log','length','(((.+)+)+)+$','catch','../../salesforce/services/salesforce-logger-v3.service','322585HBUfaf','design:paramtypes','string','416920WZWBkw','SalesforceRetrieverService','repositoryName','In\x20Progress','60761vCpzFY','createBranchIfNotExists','commitJob','117qowqsh','decorate','defineProperty','SalesforceService','sfLogger','prefix','getRemoteStateAttachmentId','parse','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','\x20Flosum\x20sync\x20job\x20done.','getComponentsFromRepository','18ZiUDmN','setStatus','\x20Branch\x20synchronized.\x20Skip','DEFAULT_GIT_USER_NAME','constructor','run','lastCommit','force','updateLastCommit','../../salesforce/services/salesforce-retriever.service','gitUrl','repository','branches','name','then','SalesforceSyncService','search','\x20Checking\x20sync\x20status.','Container','__metadata','\x20Sync\x20status\x20','salesforceSync','198852bkgOZt','../../salesforce/services/salesforce-sync.service','../../salesforce/services/salesforce.service','55698YgsgIf','object','repositoryId','FlosumSyncJob','send','provider','checkSyncStatus','branchName','4UFDCdo','metadata','apply',']\x20[Branch:\x20','components','toString','salesforceService','1749848JklydU','../../../../constants','repo','branchId','SalesforceLogger3','get','CommitComponentsJob','sha','branch','getComponents','syncData'];a106_0x1c54=function(){return _0xed83b3;};return a106_0x1c54();}a106_0x5e4282();'use strict';var __decorate=this&&this['__decorate']||function(_0x2514fe,_0x2c3fc9,_0x20cdea,_0x3d9ee4){const _0x4efdfd=a106_0x5340;var _0x593bdf=arguments[_0x4efdfd(0x1eb)],_0x13acc4=_0x593bdf<0x3?_0x2c3fc9:_0x3d9ee4===null?_0x3d9ee4=Object[_0x4efdfd(0x1e5)](_0x2c3fc9,_0x20cdea):_0x3d9ee4,_0x2d702b;if(typeof Reflect===_0x4efdfd(0x21e)&&typeof Reflect[_0x4efdfd(0x1fa)]==='function')_0x13acc4=Reflect['decorate'](_0x2514fe,_0x2c3fc9,_0x20cdea,_0x3d9ee4);else{for(var _0x2cb440=_0x2514fe[_0x4efdfd(0x1eb)]-0x1;_0x2cb440>=0x0;_0x2cb440--)if(_0x2d702b=_0x2514fe[_0x2cb440])_0x13acc4=(_0x593bdf<0x3?_0x2d702b(_0x13acc4):_0x593bdf>0x3?_0x2d702b(_0x2c3fc9,_0x20cdea,_0x13acc4):_0x2d702b(_0x2c3fc9,_0x20cdea))||_0x13acc4;}return _0x593bdf>0x3&&_0x13acc4&&Object[_0x4efdfd(0x1fb)](_0x2c3fc9,_0x20cdea,_0x13acc4),_0x13acc4;},__metadata=this&&this[a106_0x9f8da2(0x217)]||function(_0x59b26b,_0x4ce163){const _0x570de5=a106_0x9f8da2;if(typeof Reflect===_0x570de5(0x21e)&&typeof Reflect[_0x570de5(0x226)]==='function')return Reflect[_0x570de5(0x226)](_0x59b26b,_0x4ce163);};function a106_0x5340(_0x16c829,_0xddec1b){const _0x992ee9=a106_0x1c54();return a106_0x5340=function(_0x5e4282,_0x105e85){_0x5e4282=_0x5e4282-0x1dc;let _0x1c5421=_0x992ee9[_0x5e4282];return _0x1c5421;},a106_0x5340(_0x16c829,_0xddec1b);}Object['defineProperty'](exports,a106_0x9f8da2(0x1e6),{'value':!![]}),exports[a106_0x9f8da2(0x220)]=void 0x0;const salesforce_logger_v3_service_1=require(a106_0x9f8da2(0x1ee)),typedi_1=require(a106_0x9f8da2(0x239)),constants_1=require(a106_0x9f8da2(0x22d)),salesforce_retriever_service_1=require(a106_0x9f8da2(0x20d)),salesforce_sync_service_1=require(a106_0x9f8da2(0x21b)),salesforce_service_1=require(a106_0x9f8da2(0x21c)),commit_components_dto_1=require(a106_0x9f8da2(0x1e2)),commit_components_job_1=require(a106_0x9f8da2(0x1dd));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x474c70,_0x4622e4,_0x532ee5){const _0x3e4b15=a106_0x9f8da2;this[_0x3e4b15(0x219)]=_0x474c70,this[_0x3e4b15(0x22b)]=_0x4622e4,this[_0x3e4b15(0x1f8)]=_0x532ee5;}async[a106_0x9f8da2(0x1f7)](){const _0xb6fa80=a106_0x9f8da2;let _0x48fa3d=await this['repository'][_0xb6fa80(0x210)]['getOne'](this[_0xb6fa80(0x236)][_0xb6fa80(0x224)])['catch'](()=>null);!_0x48fa3d&&(_0x48fa3d=await this[_0xb6fa80(0x20f)]['branches'][_0xb6fa80(0x1e0)]({'name':this[_0xb6fa80(0x236)][_0xb6fa80(0x224)]})),this['branch']=_0x48fa3d;}async[a106_0x9f8da2(0x1e7)](){const _0x2f567e=a106_0x9f8da2;return this['syncData'][_0x2f567e(0x21f)]?this['salesforceSync'][_0x2f567e(0x203)](this[_0x2f567e(0x236)][_0x2f567e(0x21f)]):this[_0x2f567e(0x219)]['getBranchComponents'](this[_0x2f567e(0x236)][_0x2f567e(0x22f)]);}async[a106_0x9f8da2(0x235)](){const _0x1ad6cf=a106_0x9f8da2,_0x57fced=await this['getComponentIds'](),_0x587d01=new salesforce_retriever_service_1[(_0x1ad6cf(0x1f3))](this[_0x1ad6cf(0x22b)]),_0x20663e=await _0x587d01[_0x1ad6cf(0x209)](_0x57fced);return _0x20663e;}async[a106_0x9f8da2(0x1e4)](_0x283492){const _0x1f7b00=a106_0x9f8da2,_0x5e9f1a=new commit_components_dto_1[(_0x1f7b00(0x1e1))]();return _0x5e9f1a['message']='Sync\x20repository',_0x5e9f1a['user']={'name':constants_1[_0x1f7b00(0x207)],'email':constants_1[_0x1f7b00(0x1e8)]},_0x5e9f1a[_0x1f7b00(0x229)]={'writed':await this[_0x1f7b00(0x235)]()},_0x5e9f1a['convertToSFDX']=_0x283492,_0x5e9f1a[_0x1f7b00(0x22e)]=this[_0x1f7b00(0x20f)],_0x5e9f1a[_0x1f7b00(0x234)]=this[_0x1f7b00(0x234)],_0x5e9f1a[_0x1f7b00(0x20b)]=!![],_0x5e9f1a[_0x1f7b00(0x222)]=this[_0x1f7b00(0x222)],_0x5e9f1a;}async[a106_0x9f8da2(0x223)](){const _0x75bda7=a106_0x9f8da2,_0x443fea=await this['salesforceSync'][_0x75bda7(0x1ff)](this[_0x75bda7(0x236)]),_0x182aa7=await this['salesforceService']['retrieveAttachment'](_0x443fea)[_0x75bda7(0x212)](_0x1e07b3=>typeof _0x1e07b3===_0x75bda7(0x1f1)?JSON[_0x75bda7(0x200)](_0x1e07b3):_0x1e07b3)[_0x75bda7(0x1ed)](()=>({}));if(_0x182aa7[this['repository'][_0x75bda7(0x20e)]]){if(_0x182aa7[this[_0x75bda7(0x20f)]['gitUrl']][_0x75bda7(0x20a)]===this[_0x75bda7(0x234)][_0x75bda7(0x233)])return!![];}return![];}async[a106_0x9f8da2(0x20c)](){const _0x40dc89=a106_0x9f8da2,_0x4b7748=await this['repository'][_0x40dc89(0x210)][_0x40dc89(0x1e3)](this[_0x40dc89(0x234)][_0x40dc89(0x211)]);await this[_0x40dc89(0x1fd)]['log'](this[_0x40dc89(0x1fe)]+_0x40dc89(0x1de));const _0x7a17d9={[this[_0x40dc89(0x20f)][_0x40dc89(0x20e)]]:{'lastCommit':_0x4b7748[_0x40dc89(0x233)]}};await this[_0x40dc89(0x219)]['updateRemoteState'](this[_0x40dc89(0x236)],_0x7a17d9);}async['run']({syncRecord:_0x318832,repository:_0x547942,convertToSFDX:_0x3ca02f,provider:_0x64be46}){const _0x45936d=a106_0x9f8da2;this[_0x45936d(0x236)]=_0x318832,this[_0x45936d(0x222)]=_0x64be46,this[_0x45936d(0x20f)]=_0x547942,this['sfLogger']=typedi_1[_0x45936d(0x216)][_0x45936d(0x231)](salesforce_logger_v3_service_1[_0x45936d(0x230)]),this['prefix']=_0x45936d(0x201)+this[_0x45936d(0x236)][_0x45936d(0x1f4)]+_0x45936d(0x228)+this[_0x45936d(0x236)]['branchName']+']';try{await this['sfLogger'][_0x45936d(0x1ea)](this[_0x45936d(0x1fe)]+'\x20Start\x20Flosum\x20sync\x20job')['send'](),await this[_0x45936d(0x219)]['setStatus'](this[_0x45936d(0x236)],_0x45936d(0x1f5)),this['sfLogger'][_0x45936d(0x1ea)](this[_0x45936d(0x1fe)]+'\x20Checking\x20repository\x20on\x20Flosum\x20side.'),await this['createBranchIfNotExists'](),await this[_0x45936d(0x1fd)][_0x45936d(0x1ea)](this[_0x45936d(0x1fe)]+_0x45936d(0x215))[_0x45936d(0x221)]();const _0x3eefad=await this[_0x45936d(0x223)]();this[_0x45936d(0x1fd)][_0x45936d(0x1ea)](this[_0x45936d(0x1fe)]+_0x45936d(0x218)+_0x3eefad+'.');if(_0x3eefad){await this[_0x45936d(0x219)]['setStatus'](this['syncData'],_0x45936d(0x237)),await this['sfLogger'][_0x45936d(0x1ea)](this[_0x45936d(0x1fe)]+_0x45936d(0x206))[_0x45936d(0x221)]();return;}const _0x112ac1=await this[_0x45936d(0x1e4)](_0x3ca02f);await this[_0x45936d(0x1f8)][_0x45936d(0x209)](_0x112ac1,this[_0x45936d(0x1fe)]),await this[_0x45936d(0x219)][_0x45936d(0x205)](this[_0x45936d(0x236)],_0x45936d(0x237)),await this['updateLastCommit'](),this['sfLogger'][_0x45936d(0x1ea)](this['prefix']+_0x45936d(0x202));}catch(_0x40bd7c){throw _0x40bd7c;}finally{await this[_0x45936d(0x1fd)][_0x45936d(0x221)]();}}};FlosumSyncJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a106_0x9f8da2(0x1f0),[salesforce_sync_service_1[a106_0x9f8da2(0x213)],salesforce_service_1[a106_0x9f8da2(0x1fc)],commit_components_job_1[a106_0x9f8da2(0x232)]])],FlosumSyncJob),exports[a106_0x9f8da2(0x220)]=FlosumSyncJob;