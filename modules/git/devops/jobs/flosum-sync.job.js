const a106_0x4ec77b=a106_0x509b;(function(_0x353fc7,_0x25e294){const _0x44e6f6=a106_0x509b,_0x23c4c1=_0x353fc7();while(!![]){try{const _0x2c2dc4=parseInt(_0x44e6f6(0x16f))/0x1+parseInt(_0x44e6f6(0x17e))/0x2*(-parseInt(_0x44e6f6(0x16a))/0x3)+parseInt(_0x44e6f6(0x180))/0x4*(parseInt(_0x44e6f6(0x14e))/0x5)+parseInt(_0x44e6f6(0x150))/0x6+-parseInt(_0x44e6f6(0x164))/0x7*(parseInt(_0x44e6f6(0x13d))/0x8)+parseInt(_0x44e6f6(0x147))/0x9*(parseInt(_0x44e6f6(0x175))/0xa)+parseInt(_0x44e6f6(0x163))/0xb;if(_0x2c2dc4===_0x25e294)break;else _0x23c4c1['push'](_0x23c4c1['shift']());}catch(_0x323ab3){_0x23c4c1['push'](_0x23c4c1['shift']());}}}(a106_0x18a5,0x1d949));function a106_0x18a5(){const _0xff88fb=['function','sha','getRemoteStateAttachmentId','branchName','\x20Checking\x20sync\x20status.','../../salesforce/services/salesforce-logger-v3.service','\x20Checking\x20repository\x20on\x20Flosum\x20side.','parse','Container','defineProperty','prefix','then','961950qzEAgk','174825eGhyhi','Sync\x20repository','send','branchId','typedi','FlosumSyncJob','2265UOKQzs','In\x20Progress','getOwnPropertyDescriptor','../../../../constants','createBranchIfNotExists','216187SOcHTF','salesforceSync','../../salesforce/services/salesforce-sync.service','salesforceService','getComponentIds','log','10fECFrg','gitUrl','convertToSFDX',']\x20[Branch:\x20','apply','DEFAULT_GIT_USER_EMAIL','decorate','branch','run','622OZBzyh','getComponentsFromRepository','3372TCxsEF','Completed','branches','(((.+)+)+)+$','length','repository','SalesforceLogger3','Service','./commit-components.job','__esModule','provider','updateLastCommit','commitJob','repositoryId','\x20Start\x20Flosum\x20sync\x20job','get','SalesforceService','metadata','getCommitDto','56AGuqjR','../../salesforce/services/salesforce.service','force','\x20Sync\x20status\x20','SalesforceSyncService','setStatus','SalesforceRetrieverService','getOne','__decorate','sfLogger','653706bjzHtf','catch','name','DEFAULT_GIT_USER_NAME','components','CommitComponentsJob','syncData','465BDTbcP','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','456726CFOqou','getComponents','repo','search','string','lastCommit','object'];a106_0x18a5=function(){return _0xff88fb;};return a106_0x18a5();}const a106_0xed4cdf=(function(){let _0x97e255=!![];return function(_0x31a6af,_0x151db8){const _0x2393ec=_0x97e255?function(){const _0x5f0f88=a106_0x509b;if(_0x151db8){const _0xf55993=_0x151db8[_0x5f0f88(0x179)](_0x31a6af,arguments);return _0x151db8=null,_0xf55993;}}:function(){};return _0x97e255=![],_0x2393ec;};}()),a106_0xa00847=a106_0xed4cdf(this,function(){const _0x1ffb19=a106_0x509b;return a106_0xa00847['toString']()[_0x1ffb19(0x153)](_0x1ffb19(0x183))['toString']()['constructor'](a106_0xa00847)[_0x1ffb19(0x153)](_0x1ffb19(0x183));});a106_0xa00847();'use strict';var __decorate=this&&this[a106_0x4ec77b(0x145)]||function(_0x46ca8d,_0x5ad49b,_0x2dae07,_0x1e305f){const _0x50bd7e=a106_0x4ec77b;var _0x215ec9=arguments[_0x50bd7e(0x184)],_0x359d9e=_0x215ec9<0x3?_0x5ad49b:_0x1e305f===null?_0x1e305f=Object[_0x50bd7e(0x16c)](_0x5ad49b,_0x2dae07):_0x1e305f,_0x475259;if(typeof Reflect==='object'&&typeof Reflect[_0x50bd7e(0x17b)]===_0x50bd7e(0x157))_0x359d9e=Reflect[_0x50bd7e(0x17b)](_0x46ca8d,_0x5ad49b,_0x2dae07,_0x1e305f);else{for(var _0x28d16f=_0x46ca8d['length']-0x1;_0x28d16f>=0x0;_0x28d16f--)if(_0x475259=_0x46ca8d[_0x28d16f])_0x359d9e=(_0x215ec9<0x3?_0x475259(_0x359d9e):_0x215ec9>0x3?_0x475259(_0x5ad49b,_0x2dae07,_0x359d9e):_0x475259(_0x5ad49b,_0x2dae07))||_0x359d9e;}return _0x215ec9>0x3&&_0x359d9e&&Object[_0x50bd7e(0x160)](_0x5ad49b,_0x2dae07,_0x359d9e),_0x359d9e;},__metadata=this&&this['__metadata']||function(_0x48fb36,_0x5626f6){const _0x326542=a106_0x4ec77b;if(typeof Reflect===_0x326542(0x156)&&typeof Reflect[_0x326542(0x13b)]===_0x326542(0x157))return Reflect[_0x326542(0x13b)](_0x48fb36,_0x5626f6);};function a106_0x509b(_0x27a198,_0x3a6fb0){const _0x205008=a106_0x18a5();return a106_0x509b=function(_0xa00847,_0xed4cdf){_0xa00847=_0xa00847-0x135;let _0x18a5b4=_0x205008[_0xa00847];return _0x18a5b4;},a106_0x509b(_0x27a198,_0x3a6fb0);}Object[a106_0x4ec77b(0x160)](exports,a106_0x4ec77b(0x189),{'value':!![]}),exports[a106_0x4ec77b(0x169)]=void 0x0;const salesforce_logger_v3_service_1=require(a106_0x4ec77b(0x15c)),typedi_1=require(a106_0x4ec77b(0x168)),constants_1=require(a106_0x4ec77b(0x16d)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a106_0x4ec77b(0x171)),salesforce_service_1=require(a106_0x4ec77b(0x13e)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a106_0x4ec77b(0x188));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x3fe833,_0x113d2b,_0xfa1b3e){const _0x2b14ce=a106_0x4ec77b;this[_0x2b14ce(0x170)]=_0x3fe833,this[_0x2b14ce(0x172)]=_0x113d2b,this[_0x2b14ce(0x136)]=_0xfa1b3e;}async[a106_0x4ec77b(0x16e)](){const _0x5d88ca=a106_0x4ec77b;let _0x1a6dd4=await this['repository'][_0x5d88ca(0x182)][_0x5d88ca(0x144)](this[_0x5d88ca(0x14d)][_0x5d88ca(0x15a)])[_0x5d88ca(0x148)](()=>null);!_0x1a6dd4&&(_0x1a6dd4=await this[_0x5d88ca(0x185)][_0x5d88ca(0x182)]['create']({'name':this[_0x5d88ca(0x14d)][_0x5d88ca(0x15a)]})),this['branch']=_0x1a6dd4;}async[a106_0x4ec77b(0x173)](){const _0x5456c1=a106_0x4ec77b;return this[_0x5456c1(0x14d)][_0x5456c1(0x137)]?this['salesforceSync'][_0x5456c1(0x17f)](this[_0x5456c1(0x14d)][_0x5456c1(0x137)]):this['salesforceSync']['getBranchComponents'](this[_0x5456c1(0x14d)][_0x5456c1(0x167)]);}async[a106_0x4ec77b(0x151)](){const _0x5b1d8b=a106_0x4ec77b,_0x4f8cf4=await this[_0x5b1d8b(0x173)](),_0x1ef394=new salesforce_retriever_service_1[(_0x5b1d8b(0x143))](this[_0x5b1d8b(0x172)]),_0x3cda82=await _0x1ef394[_0x5b1d8b(0x17d)](_0x4f8cf4);return _0x3cda82;}async[a106_0x4ec77b(0x13c)](_0x542cb1){const _0x324d8c=a106_0x4ec77b,_0x49dc50=new commit_components_dto_1['CommitComponentsDto']();return _0x49dc50['message']=_0x324d8c(0x165),_0x49dc50['user']={'name':constants_1[_0x324d8c(0x14a)],'email':constants_1[_0x324d8c(0x17a)]},_0x49dc50[_0x324d8c(0x14b)]={'writed':await this['getComponents']()},_0x49dc50[_0x324d8c(0x177)]=_0x542cb1,_0x49dc50[_0x324d8c(0x152)]=this[_0x324d8c(0x185)],_0x49dc50['branch']=this[_0x324d8c(0x17c)],_0x49dc50[_0x324d8c(0x13f)]=!![],_0x49dc50[_0x324d8c(0x18a)]=this[_0x324d8c(0x18a)],_0x49dc50;}async['checkSyncStatus'](){const _0x4b5142=a106_0x4ec77b,_0x3bbbec=await this[_0x4b5142(0x170)][_0x4b5142(0x159)](this['syncData']),_0x55dfc2=await this[_0x4b5142(0x172)]['retrieveAttachment'](_0x3bbbec)[_0x4b5142(0x162)](_0x1cb540=>typeof _0x1cb540===_0x4b5142(0x154)?JSON[_0x4b5142(0x15e)](_0x1cb540):_0x1cb540)[_0x4b5142(0x148)](()=>({}));if(_0x55dfc2[this[_0x4b5142(0x185)][_0x4b5142(0x176)]]){if(_0x55dfc2[this['repository']['gitUrl']][_0x4b5142(0x155)]===this['branch']['sha'])return!![];}return![];}async[a106_0x4ec77b(0x135)](){const _0x416d8d=a106_0x4ec77b,_0x2bf49a=await this[_0x416d8d(0x185)][_0x416d8d(0x182)][_0x416d8d(0x144)](this[_0x416d8d(0x17c)][_0x416d8d(0x149)]);await this['sfLogger']['log'](this['prefix']+'\x20Update\x20remote\x20state.');const _0x2517f4={[this[_0x416d8d(0x185)][_0x416d8d(0x176)]]:{'lastCommit':_0x2bf49a[_0x416d8d(0x158)]}};await this[_0x416d8d(0x170)]['updateRemoteState'](this['syncData'],_0x2517f4);}async[a106_0x4ec77b(0x17d)]({syncRecord:_0x196f6c,repository:_0x366da0,convertToSFDX:_0x4b7796,provider:_0x4fac0f}){const _0x3e2bca=a106_0x4ec77b;this[_0x3e2bca(0x14d)]=_0x196f6c,this[_0x3e2bca(0x18a)]=_0x4fac0f,this['repository']=_0x366da0,this[_0x3e2bca(0x146)]=typedi_1[_0x3e2bca(0x15f)][_0x3e2bca(0x139)](salesforce_logger_v3_service_1[_0x3e2bca(0x186)]),this['prefix']=_0x3e2bca(0x14f)+this[_0x3e2bca(0x14d)]['repositoryName']+_0x3e2bca(0x178)+this[_0x3e2bca(0x14d)][_0x3e2bca(0x15a)]+']';try{await this[_0x3e2bca(0x146)][_0x3e2bca(0x174)](this[_0x3e2bca(0x161)]+_0x3e2bca(0x138))[_0x3e2bca(0x166)](),await this[_0x3e2bca(0x170)][_0x3e2bca(0x142)](this[_0x3e2bca(0x14d)],_0x3e2bca(0x16b)),this['sfLogger'][_0x3e2bca(0x174)](this[_0x3e2bca(0x161)]+_0x3e2bca(0x15d)),await this[_0x3e2bca(0x16e)](),await this[_0x3e2bca(0x146)]['log'](this[_0x3e2bca(0x161)]+_0x3e2bca(0x15b))['send']();const _0x59e853=await this['checkSyncStatus']();this[_0x3e2bca(0x146)][_0x3e2bca(0x174)](this['prefix']+_0x3e2bca(0x140)+_0x59e853+'.');if(_0x59e853){await this[_0x3e2bca(0x170)]['setStatus'](this[_0x3e2bca(0x14d)],_0x3e2bca(0x181)),await this[_0x3e2bca(0x146)]['log'](this[_0x3e2bca(0x161)]+'\x20Branch\x20synchronized.\x20Skip')['send']();return;}const _0xd3a5b7=await this[_0x3e2bca(0x13c)](_0x4b7796);await this[_0x3e2bca(0x136)][_0x3e2bca(0x17d)](_0xd3a5b7,this[_0x3e2bca(0x161)]),await this[_0x3e2bca(0x170)][_0x3e2bca(0x142)](this[_0x3e2bca(0x14d)],_0x3e2bca(0x181)),await this['updateLastCommit'](),this[_0x3e2bca(0x146)][_0x3e2bca(0x174)](this[_0x3e2bca(0x161)]+'\x20Flosum\x20sync\x20job\x20done.');}catch(_0x12f73b){throw _0x12f73b;}finally{await this[_0x3e2bca(0x146)]['send']();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a106_0x4ec77b(0x187)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_sync_service_1[a106_0x4ec77b(0x141)],salesforce_service_1[a106_0x4ec77b(0x13a)],commit_components_job_1[a106_0x4ec77b(0x14c)]])],FlosumSyncJob),exports[a106_0x4ec77b(0x169)]=FlosumSyncJob;