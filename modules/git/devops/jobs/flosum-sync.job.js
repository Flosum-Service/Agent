const a106_0x333485=a106_0x3847;(function(_0x39a225,_0x4cb6cb){const _0x4f8857=a106_0x3847,_0x3706a0=_0x39a225();while(!![]){try{const _0x13f358=parseInt(_0x4f8857(0x12f))/0x1*(-parseInt(_0x4f8857(0x140))/0x2)+-parseInt(_0x4f8857(0x144))/0x3+parseInt(_0x4f8857(0x138))/0x4*(-parseInt(_0x4f8857(0x150))/0x5)+-parseInt(_0x4f8857(0x178))/0x6*(-parseInt(_0x4f8857(0x183))/0x7)+-parseInt(_0x4f8857(0x174))/0x8*(-parseInt(_0x4f8857(0x147))/0x9)+-parseInt(_0x4f8857(0x145))/0xa+parseInt(_0x4f8857(0x159))/0xb;if(_0x13f358===_0x4cb6cb)break;else _0x3706a0['push'](_0x3706a0['shift']());}catch(_0x3f6f7e){_0x3706a0['push'](_0x3706a0['shift']());}}}(a106_0x45dc,0x530ba));function a106_0x3847(_0x4d04d4,_0x21a21d){const _0x2facbd=a106_0x45dc();return a106_0x3847=function(_0x342a82,_0x168154){_0x342a82=_0x342a82-0x12b;let _0x45dce1=_0x2facbd[_0x342a82];return _0x45dce1;},a106_0x3847(_0x4d04d4,_0x21a21d);}const a106_0x168154=(function(){let _0x353501=!![];return function(_0x479a3b,_0xecdc9a){const _0x41f563=_0x353501?function(){const _0x8b9e90=a106_0x3847;if(_0xecdc9a){const _0x4ff657=_0xecdc9a[_0x8b9e90(0x12d)](_0x479a3b,arguments);return _0xecdc9a=null,_0x4ff657;}}:function(){};return _0x353501=![],_0x41f563;};}()),a106_0x342a82=a106_0x168154(this,function(){const _0x1be563=a106_0x3847;return a106_0x342a82[_0x1be563(0x15a)]()[_0x1be563(0x171)](_0x1be563(0x13d))[_0x1be563(0x15a)]()['constructor'](a106_0x342a82)[_0x1be563(0x171)](_0x1be563(0x13d));});function a106_0x45dc(){const _0x2446e0=['3367958HEFIJk','toString','__decorate','__esModule','commitJob','components','getCommitDto','SalesforceLogger3','function','createBranchIfNotExists','length','metadata','getComponentIds','gitUrl','DEFAULT_GIT_USER_NAME','sha','provider','\x20Branch\x20synchronized.\x20Skip','log','Sync\x20repository','then','branchName','FlosumSyncJob','message','search','getBranchComponents','CommitComponentsDto','8NUeyqa',']\x20[Branch:\x20','../dto/commit-components.dto','branch','6OBolOr','repository','repositoryId','send','\x20Sync\x20status\x20','Service','retrieveAttachment','setStatus','salesforceService','sfLogger','DEFAULT_GIT_USER_EMAIL','2673356dvndvW','../../salesforce/services/salesforce-sync.service','defineProperty','apply','getComponents','709eJaRus','branches','object','force','syncData','user','updateRemoteState','getOne','SalesforceRetrieverService','77264Llpbwm','\x20Checking\x20repository\x20on\x20Flosum\x20side.','lastCommit','../../../../constants','run','(((.+)+)+)+$','repo','getComponentsFromRepository','582aCQlIj','In\x20Progress','catch','salesforceSync','286329qvJWHV','778090KrdfTn','\x20Start\x20Flosum\x20sync\x20job','1675503OlHkOt','repositoryName','prefix','name','updateLastCommit','checkSyncStatus','SalesforceSyncService','Container','convertToSFDX','40jkppqv','Completed','decorate','CommitComponentsJob','SalesforceService','getOwnPropertyDescriptor','branchId','get','\x20Flosum\x20sync\x20job\x20done.'];a106_0x45dc=function(){return _0x2446e0;};return a106_0x45dc();}a106_0x342a82();'use strict';var __decorate=this&&this[a106_0x333485(0x15b)]||function(_0x3b6676,_0x24f677,_0xf2f9f0,_0x54c802){const _0x428344=a106_0x333485;var _0x358851=arguments[_0x428344(0x163)],_0x2ca246=_0x358851<0x3?_0x24f677:_0x54c802===null?_0x54c802=Object[_0x428344(0x155)](_0x24f677,_0xf2f9f0):_0x54c802,_0x12bf7a;if(typeof Reflect==='object'&&typeof Reflect[_0x428344(0x152)]==='function')_0x2ca246=Reflect[_0x428344(0x152)](_0x3b6676,_0x24f677,_0xf2f9f0,_0x54c802);else{for(var _0x328f14=_0x3b6676[_0x428344(0x163)]-0x1;_0x328f14>=0x0;_0x328f14--)if(_0x12bf7a=_0x3b6676[_0x328f14])_0x2ca246=(_0x358851<0x3?_0x12bf7a(_0x2ca246):_0x358851>0x3?_0x12bf7a(_0x24f677,_0xf2f9f0,_0x2ca246):_0x12bf7a(_0x24f677,_0xf2f9f0))||_0x2ca246;}return _0x358851>0x3&&_0x2ca246&&Object[_0x428344(0x12c)](_0x24f677,_0xf2f9f0,_0x2ca246),_0x2ca246;},__metadata=this&&this['__metadata']||function(_0xdcff08,_0x2b5e44){const _0x383907=a106_0x333485;if(typeof Reflect===_0x383907(0x131)&&typeof Reflect[_0x383907(0x164)]===_0x383907(0x161))return Reflect[_0x383907(0x164)](_0xdcff08,_0x2b5e44);};Object[a106_0x333485(0x12c)](exports,a106_0x333485(0x15c),{'value':!![]}),exports[a106_0x333485(0x16f)]=void 0x0;const salesforce_logger_v3_service_1=require('../../salesforce/services/salesforce-logger-v3.service'),typedi_1=require('typedi'),constants_1=require(a106_0x333485(0x13b)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a106_0x333485(0x12b)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),commit_components_dto_1=require(a106_0x333485(0x176)),commit_components_job_1=require('./commit-components.job');let FlosumSyncJob=class FlosumSyncJob{constructor(_0x147016,_0x454770,_0x12a732){const _0x373e7f=a106_0x333485;this[_0x373e7f(0x143)]=_0x147016,this['salesforceService']=_0x454770,this['commitJob']=_0x12a732;}async[a106_0x333485(0x162)](){const _0x498881=a106_0x333485;let _0x1a732f=await this['repository'][_0x498881(0x130)][_0x498881(0x136)](this['syncData'][_0x498881(0x16e)])['catch'](()=>null);!_0x1a732f&&(_0x1a732f=await this[_0x498881(0x179)][_0x498881(0x130)]['create']({'name':this[_0x498881(0x133)][_0x498881(0x16e)]})),this[_0x498881(0x177)]=_0x1a732f;}async[a106_0x333485(0x165)](){const _0x3b8691=a106_0x333485;return this[_0x3b8691(0x133)][_0x3b8691(0x17a)]?this['salesforceSync'][_0x3b8691(0x13f)](this[_0x3b8691(0x133)][_0x3b8691(0x17a)]):this[_0x3b8691(0x143)][_0x3b8691(0x172)](this['syncData'][_0x3b8691(0x156)]);}async[a106_0x333485(0x12e)](){const _0x38069a=a106_0x333485,_0x458c9c=await this[_0x38069a(0x165)](),_0x44ea23=new salesforce_retriever_service_1[(_0x38069a(0x137))](this[_0x38069a(0x180)]),_0x5d04b6=await _0x44ea23['run'](_0x458c9c);return _0x5d04b6;}async['getCommitDto'](_0x65c888){const _0x9af728=a106_0x333485,_0x43d703=new commit_components_dto_1[(_0x9af728(0x173))]();return _0x43d703[_0x9af728(0x170)]=_0x9af728(0x16c),_0x43d703[_0x9af728(0x134)]={'name':constants_1[_0x9af728(0x167)],'email':constants_1[_0x9af728(0x182)]},_0x43d703[_0x9af728(0x15e)]={'writed':await this['getComponents']()},_0x43d703[_0x9af728(0x14f)]=_0x65c888,_0x43d703[_0x9af728(0x13e)]=this['repository'],_0x43d703[_0x9af728(0x177)]=this[_0x9af728(0x177)],_0x43d703[_0x9af728(0x132)]=!![],_0x43d703[_0x9af728(0x169)]=this[_0x9af728(0x169)],_0x43d703;}async['checkSyncStatus'](){const _0x3751dc=a106_0x333485,_0x262307=await this['salesforceSync']['getRemoteStateAttachmentId'](this[_0x3751dc(0x133)]),_0x4bd755=await this['salesforceService'][_0x3751dc(0x17e)](_0x262307)[_0x3751dc(0x16d)](_0x425411=>typeof _0x425411==='string'?JSON['parse'](_0x425411):_0x425411)[_0x3751dc(0x142)](()=>({}));if(_0x4bd755[this[_0x3751dc(0x179)][_0x3751dc(0x166)]]){if(_0x4bd755[this['repository'][_0x3751dc(0x166)]][_0x3751dc(0x13a)]===this[_0x3751dc(0x177)][_0x3751dc(0x168)])return!![];}return![];}async[a106_0x333485(0x14b)](){const _0x1e93ff=a106_0x333485,_0x22b215=await this[_0x1e93ff(0x179)][_0x1e93ff(0x130)][_0x1e93ff(0x136)](this[_0x1e93ff(0x177)][_0x1e93ff(0x14a)]);await this['sfLogger'][_0x1e93ff(0x16b)](this['prefix']+'\x20Update\x20remote\x20state.');const _0x3d79f9={[this[_0x1e93ff(0x179)][_0x1e93ff(0x166)]]:{'lastCommit':_0x22b215[_0x1e93ff(0x168)]}};await this[_0x1e93ff(0x143)][_0x1e93ff(0x135)](this[_0x1e93ff(0x133)],_0x3d79f9);}async[a106_0x333485(0x13c)]({syncRecord:_0x5cd813,repository:_0xbd6f46,convertToSFDX:_0x465fb1,provider:_0xfc25fd}){const _0x2cfbed=a106_0x333485;this['syncData']=_0x5cd813,this[_0x2cfbed(0x169)]=_0xfc25fd,this['repository']=_0xbd6f46,this[_0x2cfbed(0x181)]=typedi_1[_0x2cfbed(0x14e)][_0x2cfbed(0x157)](salesforce_logger_v3_service_1[_0x2cfbed(0x160)]),this[_0x2cfbed(0x149)]='[FLOSUM\x20->\x20GIT]\x20[Repository:\x20'+this[_0x2cfbed(0x133)][_0x2cfbed(0x148)]+_0x2cfbed(0x175)+this[_0x2cfbed(0x133)][_0x2cfbed(0x16e)]+']';try{await this[_0x2cfbed(0x181)][_0x2cfbed(0x16b)](this[_0x2cfbed(0x149)]+_0x2cfbed(0x146))['send'](),await this['salesforceSync'][_0x2cfbed(0x17f)](this[_0x2cfbed(0x133)],_0x2cfbed(0x141)),this['sfLogger']['log'](this[_0x2cfbed(0x149)]+_0x2cfbed(0x139)),await this[_0x2cfbed(0x162)](),await this[_0x2cfbed(0x181)][_0x2cfbed(0x16b)](this[_0x2cfbed(0x149)]+'\x20Checking\x20sync\x20status.')[_0x2cfbed(0x17b)]();const _0x4b9b2f=await this[_0x2cfbed(0x14c)]();this[_0x2cfbed(0x181)][_0x2cfbed(0x16b)](this[_0x2cfbed(0x149)]+_0x2cfbed(0x17c)+_0x4b9b2f+'.');if(_0x4b9b2f){await this[_0x2cfbed(0x143)][_0x2cfbed(0x17f)](this['syncData'],_0x2cfbed(0x151)),await this[_0x2cfbed(0x181)][_0x2cfbed(0x16b)](this[_0x2cfbed(0x149)]+_0x2cfbed(0x16a))['send']();return;}const _0xf0604b=await this[_0x2cfbed(0x15f)](_0x465fb1);await this[_0x2cfbed(0x15d)]['run'](_0xf0604b,this['prefix']),await this[_0x2cfbed(0x143)]['setStatus'](this[_0x2cfbed(0x133)],_0x2cfbed(0x151)),await this['updateLastCommit'](),this['sfLogger'][_0x2cfbed(0x16b)](this[_0x2cfbed(0x149)]+_0x2cfbed(0x158));}catch(_0x280c03){throw _0x280c03;}finally{await this[_0x2cfbed(0x181)]['send']();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a106_0x333485(0x17d)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_sync_service_1[a106_0x333485(0x14d)],salesforce_service_1[a106_0x333485(0x154)],commit_components_job_1[a106_0x333485(0x153)]])],FlosumSyncJob),exports[a106_0x333485(0x16f)]=FlosumSyncJob;