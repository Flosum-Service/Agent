const a106_0x4f4765=a106_0x19c8;(function(_0x4d3b89,_0x199ed7){const _0x33bb28=a106_0x19c8,_0x5c9641=_0x4d3b89();while(!![]){try{const _0x140253=-parseInt(_0x33bb28(0xfc))/0x1+-parseInt(_0x33bb28(0x13a))/0x2*(parseInt(_0x33bb28(0x13c))/0x3)+parseInt(_0x33bb28(0x14c))/0x4*(-parseInt(_0x33bb28(0x108))/0x5)+parseInt(_0x33bb28(0x11e))/0x6*(parseInt(_0x33bb28(0x10a))/0x7)+-parseInt(_0x33bb28(0x137))/0x8+parseInt(_0x33bb28(0x10b))/0x9+-parseInt(_0x33bb28(0xfe))/0xa*(-parseInt(_0x33bb28(0x14b))/0xb);if(_0x140253===_0x199ed7)break;else _0x5c9641['push'](_0x5c9641['shift']());}catch(_0x1ffec4){_0x5c9641['push'](_0x5c9641['shift']());}}}(a106_0x4aec,0x98ea2));const a106_0x175110=(function(){let _0x4aaa90=!![];return function(_0x2acc16,_0x5d0a91){const _0x13b456=_0x4aaa90?function(){const _0x160d9a=a106_0x19c8;if(_0x5d0a91){const _0x51c4fa=_0x5d0a91[_0x160d9a(0x133)](_0x2acc16,arguments);return _0x5d0a91=null,_0x51c4fa;}}:function(){};return _0x4aaa90=![],_0x13b456;};}()),a106_0x5ad8de=a106_0x175110(this,function(){const _0xb8f32a=a106_0x19c8;return a106_0x5ad8de[_0xb8f32a(0xf9)]()['search'](_0xb8f32a(0x113))['toString']()['constructor'](a106_0x5ad8de)[_0xb8f32a(0xff)](_0xb8f32a(0x113));});function a106_0x19c8(_0x2893be,_0x2bfffb){const _0x3533a4=a106_0x4aec();return a106_0x19c8=function(_0x5ad8de,_0x175110){_0x5ad8de=_0x5ad8de-0xf8;let _0x4aecd4=_0x3533a4[_0x5ad8de];return _0x4aecd4;},a106_0x19c8(_0x2893be,_0x2bfffb);}a106_0x5ad8de();'use strict';var __decorate=this&&this[a106_0x4f4765(0x13d)]||function(_0x3f6baf,_0x16d16f,_0x21e0e1,_0x3f92de){const _0x407ec8=a106_0x4f4765;var _0x13792a=arguments[_0x407ec8(0x141)],_0x214d2b=_0x13792a<0x3?_0x16d16f:_0x3f92de===null?_0x3f92de=Object[_0x407ec8(0x142)](_0x16d16f,_0x21e0e1):_0x3f92de,_0x48c4e2;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x407ec8(0x116))_0x214d2b=Reflect[_0x407ec8(0x102)](_0x3f6baf,_0x16d16f,_0x21e0e1,_0x3f92de);else{for(var _0x4f81ed=_0x3f6baf[_0x407ec8(0x141)]-0x1;_0x4f81ed>=0x0;_0x4f81ed--)if(_0x48c4e2=_0x3f6baf[_0x4f81ed])_0x214d2b=(_0x13792a<0x3?_0x48c4e2(_0x214d2b):_0x13792a>0x3?_0x48c4e2(_0x16d16f,_0x21e0e1,_0x214d2b):_0x48c4e2(_0x16d16f,_0x21e0e1))||_0x214d2b;}return _0x13792a>0x3&&_0x214d2b&&Object[_0x407ec8(0x148)](_0x16d16f,_0x21e0e1,_0x214d2b),_0x214d2b;},__metadata=this&&this[a106_0x4f4765(0x121)]||function(_0x151f32,_0x5d7ef8){const _0x335fc4=a106_0x4f4765;if(typeof Reflect===_0x335fc4(0x10d)&&typeof Reflect[_0x335fc4(0x11a)]===_0x335fc4(0x116))return Reflect['metadata'](_0x151f32,_0x5d7ef8);};Object[a106_0x4f4765(0x148)](exports,a106_0x4f4765(0x101),{'value':!![]}),exports[a106_0x4f4765(0x149)]=void 0x0;function a106_0x4aec(){const _0x3305d8=['../../salesforce/services/salesforce-retriever.service','createBranchIfNotExists','repositoryId','CommitComponentsDto','defineProperty','FlosumSyncJob','getComponents','55VnvdSD','412dyNZdk','../../salesforce/services/salesforce-sync.service','getBranchComponents','log','checkSyncStatus','Container','toString','getCommitDto','branchId','353852lypnsB','SalesforceLogger3','2363050wpRYwr','search','Service','__esModule','decorate','getComponentIds','typedi','salesforceSync','sfLogger','getComponentsFromRepository','20970PWceXO','send','205303WOlobr','3123333xmlpqj','create','object','branches','parse','CommitComponentsJob','\x20Update\x20remote\x20state.','setStatus','(((.+)+)+)+$','run','updateLastCommit','function','gitUrl','../../../../constants','get','metadata','then','getRemoteStateAttachmentId','message','150JwXOLP','name','\x20Sync\x20status\x20','__metadata','../../salesforce/services/salesforce-logger-v3.service','components','branchName','DEFAULT_GIT_USER_NAME','SalesforceService','\x20Branch\x20synchronized.\x20Skip','syncData','sha','Sync\x20repository','Completed','branch','salesforceService','\x20Checking\x20sync\x20status.','prefix','catch','user','../dto/commit-components.dto','apply','\x20Checking\x20repository\x20on\x20Flosum\x20side.','commitJob','design:paramtypes','4484056TNtNzS','repositoryName','\x20Start\x20Flosum\x20sync\x20job','2DbzTln','string','867324UeaYWV','__decorate','convertToSFDX','repository','provider','length','getOwnPropertyDescriptor','DEFAULT_GIT_USER_EMAIL'];a106_0x4aec=function(){return _0x3305d8;};return a106_0x4aec();}const salesforce_logger_v3_service_1=require(a106_0x4f4765(0x122)),typedi_1=require(a106_0x4f4765(0x104)),constants_1=require(a106_0x4f4765(0x118)),salesforce_retriever_service_1=require(a106_0x4f4765(0x144)),salesforce_sync_service_1=require(a106_0x4f4765(0x14d)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),commit_components_dto_1=require(a106_0x4f4765(0x132)),commit_components_job_1=require('./commit-components.job');let FlosumSyncJob=class FlosumSyncJob{constructor(_0x99cab6,_0x12c7fc,_0x5ef04e){const _0x7ade=a106_0x4f4765;this[_0x7ade(0x105)]=_0x99cab6,this['salesforceService']=_0x12c7fc,this['commitJob']=_0x5ef04e;}async['createBranchIfNotExists'](){const _0xae12aa=a106_0x4f4765;let _0x5c8a50=await this[_0xae12aa(0x13f)][_0xae12aa(0x10e)]['getOne'](this['syncData']['branchName'])['catch'](()=>null);!_0x5c8a50&&(_0x5c8a50=await this['repository'][_0xae12aa(0x10e)][_0xae12aa(0x10c)]({'name':this[_0xae12aa(0x128)][_0xae12aa(0x124)]})),this[_0xae12aa(0x12c)]=_0x5c8a50;}async[a106_0x4f4765(0x103)](){const _0x1211ca=a106_0x4f4765;return this['syncData'][_0x1211ca(0x146)]?this[_0x1211ca(0x105)][_0x1211ca(0x107)](this[_0x1211ca(0x128)][_0x1211ca(0x146)]):this[_0x1211ca(0x105)][_0x1211ca(0x14e)](this['syncData'][_0x1211ca(0xfb)]);}async[a106_0x4f4765(0x14a)](){const _0x20c38f=a106_0x4f4765,_0x4fd0c6=await this['getComponentIds'](),_0x1c86d6=new salesforce_retriever_service_1['SalesforceRetrieverService'](this['salesforceService']),_0x3d7300=await _0x1c86d6[_0x20c38f(0x114)](_0x4fd0c6);return _0x3d7300;}async[a106_0x4f4765(0xfa)](_0x1ab571){const _0x3a470d=a106_0x4f4765,_0x2c1c9d=new commit_components_dto_1[(_0x3a470d(0x147))]();return _0x2c1c9d[_0x3a470d(0x11d)]=_0x3a470d(0x12a),_0x2c1c9d[_0x3a470d(0x131)]={'name':constants_1[_0x3a470d(0x125)],'email':constants_1[_0x3a470d(0x143)]},_0x2c1c9d[_0x3a470d(0x123)]={'writed':await this[_0x3a470d(0x14a)]()},_0x2c1c9d[_0x3a470d(0x13e)]=_0x1ab571,_0x2c1c9d['repo']=this['repository'],_0x2c1c9d[_0x3a470d(0x12c)]=this[_0x3a470d(0x12c)],_0x2c1c9d['force']=!![],_0x2c1c9d[_0x3a470d(0x140)]=this[_0x3a470d(0x140)],_0x2c1c9d;}async[a106_0x4f4765(0x150)](){const _0x42345c=a106_0x4f4765,_0x301f61=await this['salesforceSync'][_0x42345c(0x11c)](this[_0x42345c(0x128)]),_0x36451c=await this[_0x42345c(0x12d)]['retrieveAttachment'](_0x301f61)[_0x42345c(0x11b)](_0x11493c=>typeof _0x11493c===_0x42345c(0x13b)?JSON[_0x42345c(0x10f)](_0x11493c):_0x11493c)[_0x42345c(0x130)](()=>({}));if(_0x36451c[this[_0x42345c(0x13f)][_0x42345c(0x117)]]){if(_0x36451c[this[_0x42345c(0x13f)][_0x42345c(0x117)]]['lastCommit']===this['branch'][_0x42345c(0x129)])return!![];}return![];}async[a106_0x4f4765(0x115)](){const _0x4a2cf5=a106_0x4f4765,_0xce959a=await this['repository'][_0x4a2cf5(0x10e)]['getOne'](this[_0x4a2cf5(0x12c)][_0x4a2cf5(0x11f)]);await this[_0x4a2cf5(0x106)]['log'](this[_0x4a2cf5(0x12f)]+_0x4a2cf5(0x111));const _0x55c398={[this[_0x4a2cf5(0x13f)]['gitUrl']]:{'lastCommit':_0xce959a[_0x4a2cf5(0x129)]}};await this['salesforceSync']['updateRemoteState'](this[_0x4a2cf5(0x128)],_0x55c398);}async[a106_0x4f4765(0x114)]({syncRecord:_0x41a2a7,repository:_0x3bb733,convertToSFDX:_0x9b681e,provider:_0x579506}){const _0x34cfdb=a106_0x4f4765;this[_0x34cfdb(0x128)]=_0x41a2a7,this[_0x34cfdb(0x140)]=_0x579506,this['repository']=_0x3bb733,this[_0x34cfdb(0x106)]=typedi_1[_0x34cfdb(0xf8)][_0x34cfdb(0x119)](salesforce_logger_v3_service_1[_0x34cfdb(0xfd)]),this[_0x34cfdb(0x12f)]='[FLOSUM\x20->\x20GIT]\x20[Repository:\x20'+this['syncData'][_0x34cfdb(0x138)]+']\x20[Branch:\x20'+this[_0x34cfdb(0x128)][_0x34cfdb(0x124)]+']';try{await this[_0x34cfdb(0x106)][_0x34cfdb(0x14f)](this['prefix']+_0x34cfdb(0x139))[_0x34cfdb(0x109)](),await this[_0x34cfdb(0x105)][_0x34cfdb(0x112)](this['syncData'],'In\x20Progress'),this[_0x34cfdb(0x106)][_0x34cfdb(0x14f)](this[_0x34cfdb(0x12f)]+_0x34cfdb(0x134)),await this[_0x34cfdb(0x145)](),await this['sfLogger']['log'](this[_0x34cfdb(0x12f)]+_0x34cfdb(0x12e))[_0x34cfdb(0x109)]();const _0x486fc0=await this[_0x34cfdb(0x150)]();this[_0x34cfdb(0x106)]['log'](this[_0x34cfdb(0x12f)]+_0x34cfdb(0x120)+_0x486fc0+'.');if(_0x486fc0){await this[_0x34cfdb(0x105)][_0x34cfdb(0x112)](this[_0x34cfdb(0x128)],'Completed'),await this[_0x34cfdb(0x106)]['log'](this[_0x34cfdb(0x12f)]+_0x34cfdb(0x127))[_0x34cfdb(0x109)]();return;}const _0x3a8b9a=await this['getCommitDto'](_0x9b681e);await this[_0x34cfdb(0x135)][_0x34cfdb(0x114)](_0x3a8b9a,this[_0x34cfdb(0x12f)]),await this[_0x34cfdb(0x105)]['setStatus'](this[_0x34cfdb(0x128)],_0x34cfdb(0x12b)),await this[_0x34cfdb(0x115)](),this[_0x34cfdb(0x106)][_0x34cfdb(0x14f)](this[_0x34cfdb(0x12f)]+'\x20Flosum\x20sync\x20job\x20done.');}catch(_0x59270f){throw _0x59270f;}finally{await this['sfLogger']['send']();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a106_0x4f4765(0x100)])({'transient':!![]}),__metadata(a106_0x4f4765(0x136),[salesforce_sync_service_1['SalesforceSyncService'],salesforce_service_1[a106_0x4f4765(0x126)],commit_components_job_1[a106_0x4f4765(0x110)]])],FlosumSyncJob),exports[a106_0x4f4765(0x149)]=FlosumSyncJob;