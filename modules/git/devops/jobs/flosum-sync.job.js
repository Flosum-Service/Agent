const a105_0x46a0ad=a105_0x563d;function a105_0x2ada(){const _0x415a5f=['repository','salesforceSync','gitUrl','../../salesforce/services/salesforce.service','../../../../constants','prefix','Sync\x20repository','8289sPMQoQ','4377ZLwCLz','function','SalesforceSyncService','send','commitJob','search','repositoryName','SalesforceService','\x20Flosum\x20sync\x20job\x20done.','then','getOne','287398KBGjmU','name','getComponentsFromRepository','run','CommitComponentsDto','sha','SalesforceRetrieverService','setStatus','retrieveAttachment','provider','getComponentIds','defineProperty','branch','catch','__decorate','object','toString','Container','../../salesforce/services/salesforce-logger-v3.service','__esModule','\x20Branch\x20synchronized.\x20Skip','create','constructor','branchId','1062544sArdQJ','branches','branchName','SalesforceLogger3','DEFAULT_GIT_USER_NAME','getRemoteStateAttachmentId','29510TwAjBo','getOwnPropertyDescriptor','Completed','log','../dto/commit-components.dto','get','121dfMdQw','decorate','6536HGWiUQ','checkSyncStatus','3647880AhcQQM','sfLogger','message','updateLastCommit','parse','../../salesforce/services/salesforce-retriever.service','getComponents','apply','CommitComponentsJob','metadata','getCommitDto','1640GVIDGw','repositoryId','createBranchIfNotExists','components','9371355TawvLK','design:paramtypes','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','Service','salesforceService','__metadata','user','syncData','1314OQsqJU','convertToSFDX','(((.+)+)+)+$','In\x20Progress','\x20Checking\x20repository\x20on\x20Flosum\x20side.','repo'];a105_0x2ada=function(){return _0x415a5f;};return a105_0x2ada();}(function(_0x157f50,_0x44bc52){const _0x24f0d5=a105_0x563d,_0x559429=_0x157f50();while(!![]){try{const _0x156440=parseInt(_0x24f0d5(0x185))/0x1+parseInt(_0x24f0d5(0x19d))/0x2+-parseInt(_0x24f0d5(0x17a))/0x3*(parseInt(_0x24f0d5(0x160))/0x4)+-parseInt(_0x24f0d5(0x1a3))/0x5*(parseInt(_0x24f0d5(0x16c))/0x6)+-parseInt(_0x24f0d5(0x164))/0x7+parseInt(_0x24f0d5(0x1ab))/0x8*(-parseInt(_0x24f0d5(0x179))/0x9)+-parseInt(_0x24f0d5(0x1ad))/0xa*(-parseInt(_0x24f0d5(0x1a9))/0xb);if(_0x156440===_0x44bc52)break;else _0x559429['push'](_0x559429['shift']());}catch(_0x358216){_0x559429['push'](_0x559429['shift']());}}}(a105_0x2ada,0xcf5ec));const a105_0x11b4dd=(function(){let _0x4f22f4=!![];return function(_0x4a1234,_0x549cf4){const _0x320690=_0x4f22f4?function(){const _0x31c1ae=a105_0x563d;if(_0x549cf4){const _0x5adf7e=_0x549cf4[_0x31c1ae(0x15c)](_0x4a1234,arguments);return _0x549cf4=null,_0x5adf7e;}}:function(){};return _0x4f22f4=![],_0x320690;};}()),a105_0x31c3da=a105_0x11b4dd(this,function(){const _0x30fddf=a105_0x563d;return a105_0x31c3da[_0x30fddf(0x195)]()[_0x30fddf(0x17f)]('(((.+)+)+)+$')[_0x30fddf(0x195)]()[_0x30fddf(0x19b)](a105_0x31c3da)[_0x30fddf(0x17f)](_0x30fddf(0x16e));});a105_0x31c3da();'use strict';function a105_0x563d(_0x2c8923,_0x3ba260){const _0x36deec=a105_0x2ada();return a105_0x563d=function(_0x31c3da,_0x11b4dd){_0x31c3da=_0x31c3da-0x15c;let _0x2ada7b=_0x36deec[_0x31c3da];return _0x2ada7b;},a105_0x563d(_0x2c8923,_0x3ba260);}var __decorate=this&&this[a105_0x46a0ad(0x193)]||function(_0x47d595,_0x4b23bd,_0x5bc8b1,_0x349b87){const _0x31146e=a105_0x46a0ad;var _0x1b19f5=arguments['length'],_0x41f7b2=_0x1b19f5<0x3?_0x4b23bd:_0x349b87===null?_0x349b87=Object[_0x31146e(0x1a4)](_0x4b23bd,_0x5bc8b1):_0x349b87,_0x5ea0d8;if(typeof Reflect==='object'&&typeof Reflect[_0x31146e(0x1aa)]===_0x31146e(0x17b))_0x41f7b2=Reflect[_0x31146e(0x1aa)](_0x47d595,_0x4b23bd,_0x5bc8b1,_0x349b87);else{for(var _0x5da2f7=_0x47d595['length']-0x1;_0x5da2f7>=0x0;_0x5da2f7--)if(_0x5ea0d8=_0x47d595[_0x5da2f7])_0x41f7b2=(_0x1b19f5<0x3?_0x5ea0d8(_0x41f7b2):_0x1b19f5>0x3?_0x5ea0d8(_0x4b23bd,_0x5bc8b1,_0x41f7b2):_0x5ea0d8(_0x4b23bd,_0x5bc8b1))||_0x41f7b2;}return _0x1b19f5>0x3&&_0x41f7b2&&Object[_0x31146e(0x190)](_0x4b23bd,_0x5bc8b1,_0x41f7b2),_0x41f7b2;},__metadata=this&&this[a105_0x46a0ad(0x169)]||function(_0x5e1ca1,_0x9be7d6){const _0xe61a54=a105_0x46a0ad;if(typeof Reflect===_0xe61a54(0x194)&&typeof Reflect[_0xe61a54(0x15e)]===_0xe61a54(0x17b))return Reflect[_0xe61a54(0x15e)](_0x5e1ca1,_0x9be7d6);};Object[a105_0x46a0ad(0x190)](exports,a105_0x46a0ad(0x198),{'value':!![]}),exports['FlosumSyncJob']=void 0x0;const salesforce_logger_v3_service_1=require(a105_0x46a0ad(0x197)),typedi_1=require('typedi'),constants_1=require(a105_0x46a0ad(0x176)),salesforce_retriever_service_1=require(a105_0x46a0ad(0x1b2)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a105_0x46a0ad(0x175)),commit_components_dto_1=require(a105_0x46a0ad(0x1a7)),commit_components_job_1=require('./commit-components.job');let FlosumSyncJob=class FlosumSyncJob{constructor(_0x1e62da,_0x416db8,_0x33ed81){const _0x479140=a105_0x46a0ad;this[_0x479140(0x173)]=_0x1e62da,this[_0x479140(0x168)]=_0x416db8,this[_0x479140(0x17e)]=_0x33ed81;}async[a105_0x46a0ad(0x162)](){const _0x402c68=a105_0x46a0ad;let _0x3a292c=await this[_0x402c68(0x172)][_0x402c68(0x19e)][_0x402c68(0x184)](this[_0x402c68(0x16b)][_0x402c68(0x19f)])[_0x402c68(0x192)](()=>null);!_0x3a292c&&(_0x3a292c=await this['repository'][_0x402c68(0x19e)][_0x402c68(0x19a)]({'name':this['syncData'][_0x402c68(0x19f)]})),this[_0x402c68(0x191)]=_0x3a292c;}async[a105_0x46a0ad(0x18f)](){const _0x47e1cc=a105_0x46a0ad;return this[_0x47e1cc(0x16b)][_0x47e1cc(0x161)]?this[_0x47e1cc(0x173)][_0x47e1cc(0x187)](this['syncData']['repositoryId']):this[_0x47e1cc(0x173)]['getBranchComponents'](this[_0x47e1cc(0x16b)][_0x47e1cc(0x19c)]);}async[a105_0x46a0ad(0x1b3)](){const _0x3655fd=a105_0x46a0ad,_0x4cfec5=await this[_0x3655fd(0x18f)](),_0x4cf5f7=new salesforce_retriever_service_1[(_0x3655fd(0x18b))](this[_0x3655fd(0x168)]),_0x353d97=await _0x4cf5f7[_0x3655fd(0x188)](_0x4cfec5);return _0x353d97;}async[a105_0x46a0ad(0x15f)](_0x182d5f){const _0x5db436=a105_0x46a0ad,_0x32720c=new commit_components_dto_1[(_0x5db436(0x189))]();return _0x32720c[_0x5db436(0x1af)]=_0x5db436(0x178),_0x32720c[_0x5db436(0x16a)]={'name':constants_1[_0x5db436(0x1a1)],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x32720c[_0x5db436(0x163)]={'writed':await this['getComponents']()},_0x32720c[_0x5db436(0x16d)]=_0x182d5f,_0x32720c[_0x5db436(0x171)]=this['repository'],_0x32720c[_0x5db436(0x191)]=this[_0x5db436(0x191)],_0x32720c['force']=!![],_0x32720c[_0x5db436(0x18e)]=this[_0x5db436(0x18e)],_0x32720c;}async[a105_0x46a0ad(0x1ac)](){const _0x1573b9=a105_0x46a0ad,_0x27ebfe=await this[_0x1573b9(0x173)][_0x1573b9(0x1a2)](this[_0x1573b9(0x16b)]),_0x55e344=await this[_0x1573b9(0x168)][_0x1573b9(0x18d)](_0x27ebfe)[_0x1573b9(0x183)](_0x1069d4=>typeof _0x1069d4==='string'?JSON[_0x1573b9(0x1b1)](_0x1069d4):_0x1069d4)[_0x1573b9(0x192)](()=>({}));if(_0x55e344[this[_0x1573b9(0x172)][_0x1573b9(0x174)]]){if(_0x55e344[this[_0x1573b9(0x172)][_0x1573b9(0x174)]]['lastCommit']===this[_0x1573b9(0x191)][_0x1573b9(0x18a)])return!![];}return![];}async[a105_0x46a0ad(0x1b0)](){const _0x274c98=a105_0x46a0ad,_0x4cc05d=await this['repository'][_0x274c98(0x19e)]['getOne'](this[_0x274c98(0x191)][_0x274c98(0x186)]);await this[_0x274c98(0x1ae)]['log'](this['prefix']+'\x20Update\x20remote\x20state.');const _0x6afe4d={[this[_0x274c98(0x172)][_0x274c98(0x174)]]:{'lastCommit':_0x4cc05d[_0x274c98(0x18a)]}};await this[_0x274c98(0x173)]['updateRemoteState'](this['syncData'],_0x6afe4d);}async[a105_0x46a0ad(0x188)]({syncRecord:_0x6f433f,repository:_0x2cdd48,convertToSFDX:_0x4d65e8,provider:_0x1ee3c4}){const _0x4957bd=a105_0x46a0ad;this[_0x4957bd(0x16b)]=_0x6f433f,this[_0x4957bd(0x18e)]=_0x1ee3c4,this['repository']=_0x2cdd48,this[_0x4957bd(0x1ae)]=typedi_1[_0x4957bd(0x196)][_0x4957bd(0x1a8)](salesforce_logger_v3_service_1[_0x4957bd(0x1a0)]),this[_0x4957bd(0x177)]=_0x4957bd(0x166)+this[_0x4957bd(0x16b)][_0x4957bd(0x180)]+']\x20[Branch:\x20'+this[_0x4957bd(0x16b)][_0x4957bd(0x19f)]+']';try{await this[_0x4957bd(0x1ae)]['log'](this['prefix']+'\x20Start\x20Flosum\x20sync\x20job')[_0x4957bd(0x17d)](),await this['salesforceSync'][_0x4957bd(0x18c)](this[_0x4957bd(0x16b)],_0x4957bd(0x16f)),this[_0x4957bd(0x1ae)][_0x4957bd(0x1a6)](this[_0x4957bd(0x177)]+_0x4957bd(0x170)),await this[_0x4957bd(0x162)](),await this[_0x4957bd(0x1ae)][_0x4957bd(0x1a6)](this[_0x4957bd(0x177)]+'\x20Checking\x20sync\x20status.')[_0x4957bd(0x17d)]();const _0x48ad53=await this['checkSyncStatus']();this[_0x4957bd(0x1ae)][_0x4957bd(0x1a6)](this['prefix']+'\x20Sync\x20status\x20'+_0x48ad53+'.');if(_0x48ad53){await this['salesforceSync']['setStatus'](this[_0x4957bd(0x16b)],_0x4957bd(0x1a5)),await this[_0x4957bd(0x1ae)][_0x4957bd(0x1a6)](this[_0x4957bd(0x177)]+_0x4957bd(0x199))[_0x4957bd(0x17d)]();return;}const _0x104416=await this[_0x4957bd(0x15f)](_0x4d65e8);await this['commitJob'][_0x4957bd(0x188)](_0x104416,this[_0x4957bd(0x177)]),await this[_0x4957bd(0x173)][_0x4957bd(0x18c)](this[_0x4957bd(0x16b)],_0x4957bd(0x1a5)),await this['updateLastCommit'](),this[_0x4957bd(0x1ae)][_0x4957bd(0x1a6)](this[_0x4957bd(0x177)]+_0x4957bd(0x182));}catch(_0x3a54cc){throw _0x3a54cc;}finally{await this[_0x4957bd(0x1ae)]['send']();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a105_0x46a0ad(0x167)])({'transient':!![]}),__metadata(a105_0x46a0ad(0x165),[salesforce_sync_service_1[a105_0x46a0ad(0x17c)],salesforce_service_1[a105_0x46a0ad(0x181)],commit_components_job_1[a105_0x46a0ad(0x15d)]])],FlosumSyncJob),exports['FlosumSyncJob']=FlosumSyncJob;