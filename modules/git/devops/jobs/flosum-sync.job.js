const a126_0x3b95f3=a126_0x34c0;(function(_0x2619f1,_0x382bfe){const _0x46588d=a126_0x34c0,_0x3ccd57=_0x2619f1();while(!![]){try{const _0x22c958=parseInt(_0x46588d(0x11a))/0x1*(parseInt(_0x46588d(0x115))/0x2)+-parseInt(_0x46588d(0x13d))/0x3+parseInt(_0x46588d(0x140))/0x4+parseInt(_0x46588d(0xf9))/0x5+-parseInt(_0x46588d(0x13e))/0x6*(-parseInt(_0x46588d(0x12b))/0x7)+-parseInt(_0x46588d(0x13b))/0x8*(-parseInt(_0x46588d(0x106))/0x9)+-parseInt(_0x46588d(0x125))/0xa*(parseInt(_0x46588d(0x10b))/0xb);if(_0x22c958===_0x382bfe)break;else _0x3ccd57['push'](_0x3ccd57['shift']());}catch(_0x3f344a){_0x3ccd57['push'](_0x3ccd57['shift']());}}}(a126_0x1dbb,0x9b695));function a126_0x1dbb(){const _0x40e209=['toString','16pPwApK','getOne','1199628ykFQaK','54oHbFpQ','Sync\x20repository','1089972aYMlym','branch','__esModule','branchName','provider','salesforceSync','lastCommit','\x20Checking\x20repository\x20on\x20Flosum\x20side.','getOwnPropertyDescriptor','metadata','SalesforceRetrieverService','getComponentIds','setStatus','commitJob','user','salesforceService','getRemoteStateAttachmentId','search','components','\x20Start\x20Flosum\x20sync\x20job','create','\x20Branch\x20synchronized.\x20Skip','branchId','5489050yQriYq','__metadata','getComponentsFromRepository','constructor','repository','length','defineProperty','force','apply','Container','repositoryId','prefix','branches','2230173KvtMPl','string','function','log','run','2626096MmONyk','\x20Update\x20remote\x20state.','SalesforceService','convertToSFDX','recordTypeName','decorate','catch','createBranchIfNotExists','getBranchComponents','../dto/commit-components.dto','159074suItMZ','SalesforceSyncService','../../salesforce/services/salesforce-sync.service','../../salesforce/services/salesforce-logger-v3.service','updateLastCommit','10gVtPyl','object','\x20Sync\x20status\x20','send','FlosumSyncJob','DEFAULT_GIT_USER_EMAIL','__decorate','\x20Flosum\x20sync\x20job\x20done.','DEFAULT_GIT_USER_NAME','../../salesforce/services/salesforce-retriever.service','parse','100egAyii','Service','design:paramtypes','\x20Checking\x20sync\x20status.','In\x20Progress','name','593082mODOcc','message','checkSyncStatus','SalesforceLogger3','(((.+)+)+)+$','then','sfLogger','Completed','retrieveAttachment','syncData','gitUrl','get','repo','getCommitDto','../../salesforce/services/salesforce.service'];a126_0x1dbb=function(){return _0x40e209;};return a126_0x1dbb();}const a126_0x17b6c0=(function(){let _0x2e104c=!![];return function(_0x18b709,_0xa41fa5){const _0x29ee8f=_0x2e104c?function(){const _0x1ccdf7=a126_0x34c0;if(_0xa41fa5){const _0xdd4e18=_0xa41fa5[_0x1ccdf7(0x101)](_0x18b709,arguments);return _0xa41fa5=null,_0xdd4e18;}}:function(){};return _0x2e104c=![],_0x29ee8f;};}()),a126_0x45814d=a126_0x17b6c0(this,function(){const _0x4ae907=a126_0x34c0;return a126_0x45814d[_0x4ae907(0x13a)]()[_0x4ae907(0xf3)](_0x4ae907(0x12f))[_0x4ae907(0x13a)]()[_0x4ae907(0xfc)](a126_0x45814d)[_0x4ae907(0xf3)](_0x4ae907(0x12f));});a126_0x45814d();'use strict';var __decorate=this&&this[a126_0x3b95f3(0x120)]||function(_0x418dc3,_0x111aa7,_0x4b9807,_0x20221f){const _0xe56ecc=a126_0x3b95f3;var _0x12b8ee=arguments[_0xe56ecc(0xfe)],_0x4e131d=_0x12b8ee<0x3?_0x111aa7:_0x20221f===null?_0x20221f=Object[_0xe56ecc(0xea)](_0x111aa7,_0x4b9807):_0x20221f,_0x1f2559;if(typeof Reflect===_0xe56ecc(0x11b)&&typeof Reflect[_0xe56ecc(0x110)]===_0xe56ecc(0x108))_0x4e131d=Reflect[_0xe56ecc(0x110)](_0x418dc3,_0x111aa7,_0x4b9807,_0x20221f);else{for(var _0x1cb1a9=_0x418dc3['length']-0x1;_0x1cb1a9>=0x0;_0x1cb1a9--)if(_0x1f2559=_0x418dc3[_0x1cb1a9])_0x4e131d=(_0x12b8ee<0x3?_0x1f2559(_0x4e131d):_0x12b8ee>0x3?_0x1f2559(_0x111aa7,_0x4b9807,_0x4e131d):_0x1f2559(_0x111aa7,_0x4b9807))||_0x4e131d;}return _0x12b8ee>0x3&&_0x4e131d&&Object[_0xe56ecc(0xff)](_0x111aa7,_0x4b9807,_0x4e131d),_0x4e131d;},__metadata=this&&this[a126_0x3b95f3(0xfa)]||function(_0x334c32,_0x4b49c1){const _0x5432f2=a126_0x3b95f3;if(typeof Reflect===_0x5432f2(0x11b)&&typeof Reflect[_0x5432f2(0xeb)]===_0x5432f2(0x108))return Reflect[_0x5432f2(0xeb)](_0x334c32,_0x4b49c1);};Object['defineProperty'](exports,a126_0x3b95f3(0x142),{'value':!![]}),exports[a126_0x3b95f3(0x11e)]=void 0x0;const salesforce_logger_v3_service_1=require(a126_0x3b95f3(0x118)),typedi_1=require('typedi'),constants_1=require('../../../../constants'),salesforce_retriever_service_1=require(a126_0x3b95f3(0x123)),salesforce_sync_service_1=require(a126_0x3b95f3(0x117)),salesforce_service_1=require(a126_0x3b95f3(0x139)),commit_components_dto_1=require(a126_0x3b95f3(0x114)),commit_components_job_1=require('./commit-components.job');function a126_0x34c0(_0x2454a2,_0x25f215){const _0x394ad0=a126_0x1dbb();return a126_0x34c0=function(_0x45814d,_0x17b6c0){_0x45814d=_0x45814d-0xe6;let _0x1dbb9d=_0x394ad0[_0x45814d];return _0x1dbb9d;},a126_0x34c0(_0x2454a2,_0x25f215);}let FlosumSyncJob=class FlosumSyncJob{constructor(_0x15637f,_0x5202ff,_0x7a8e06){const _0x5a22af=a126_0x3b95f3;this[_0x5a22af(0xe7)]=_0x15637f,this[_0x5a22af(0xf1)]=_0x5202ff,this[_0x5a22af(0xef)]=_0x7a8e06;}async[a126_0x3b95f3(0x112)](){const _0x134f95=a126_0x3b95f3;let _0x4c9222=await this[_0x134f95(0xfd)][_0x134f95(0x105)]['getOne'](this['syncData'][_0x134f95(0x143)])[_0x134f95(0x111)](()=>null);!_0x4c9222&&(_0x4c9222=await this[_0x134f95(0xfd)][_0x134f95(0x105)][_0x134f95(0xf6)]({'name':this[_0x134f95(0x134)]['branchName']})),this[_0x134f95(0x141)]=_0x4c9222;}async[a126_0x3b95f3(0xed)](){const _0x2edc20=a126_0x3b95f3;return this[_0x2edc20(0x134)][_0x2edc20(0x103)]?this[_0x2edc20(0xe7)][_0x2edc20(0xfb)](this[_0x2edc20(0x134)]['repositoryId']):this[_0x2edc20(0xe7)][_0x2edc20(0x113)](this['syncData'][_0x2edc20(0xf8)]);}async['getComponents'](){const _0x483ff8=a126_0x3b95f3,_0x4c9d2c=await this[_0x483ff8(0xed)](),_0x5aa191=new salesforce_retriever_service_1[(_0x483ff8(0xec))](this[_0x483ff8(0xf1)]),_0xab7f62=await _0x5aa191[_0x483ff8(0x10a)](_0x4c9d2c);return _0xab7f62;}async[a126_0x3b95f3(0x138)](_0x2ed049){const _0x538c5b=a126_0x3b95f3,_0x472cef=new commit_components_dto_1['CommitComponentsDto']();return _0x472cef[_0x538c5b(0x12c)]=_0x538c5b(0x13f),_0x472cef[_0x538c5b(0xf0)]={'name':constants_1[_0x538c5b(0x122)],'email':constants_1[_0x538c5b(0x11f)]},_0x472cef[_0x538c5b(0xf4)]={'writed':await this['getComponents']()},_0x472cef[_0x538c5b(0x10e)]=_0x2ed049,_0x472cef[_0x538c5b(0x137)]=this[_0x538c5b(0xfd)],_0x472cef[_0x538c5b(0x141)]=this[_0x538c5b(0x141)],_0x472cef[_0x538c5b(0x100)]=!![],_0x472cef[_0x538c5b(0xe6)]=this['provider'],_0x472cef['recordType']=this['syncData'][_0x538c5b(0x10f)],_0x472cef;}async[a126_0x3b95f3(0x12d)](){const _0x4acc70=a126_0x3b95f3,_0x35f02b=await this[_0x4acc70(0xe7)][_0x4acc70(0xf2)](this[_0x4acc70(0x134)]),_0x5fdc00=await this[_0x4acc70(0xf1)][_0x4acc70(0x133)](_0x35f02b)[_0x4acc70(0x130)](_0x4cb5fa=>typeof _0x4cb5fa===_0x4acc70(0x107)?JSON[_0x4acc70(0x124)](_0x4cb5fa):_0x4cb5fa)['catch'](()=>({}));if(_0x5fdc00[this[_0x4acc70(0xfd)][_0x4acc70(0x135)]]){if(_0x5fdc00[this[_0x4acc70(0xfd)][_0x4acc70(0x135)]][_0x4acc70(0xe8)]===this[_0x4acc70(0x141)]['sha'])return!![];}return![];}async[a126_0x3b95f3(0x119)](){const _0x4505b3=a126_0x3b95f3,_0x45ad37=await this[_0x4505b3(0xfd)][_0x4505b3(0x105)][_0x4505b3(0x13c)](this[_0x4505b3(0x141)][_0x4505b3(0x12a)]);await this['sfLogger'][_0x4505b3(0x109)](this['prefix']+_0x4505b3(0x10c));const _0x5e3322={[this[_0x4505b3(0xfd)][_0x4505b3(0x135)]]:{'lastCommit':_0x45ad37['sha']}};await this[_0x4505b3(0xe7)]['updateRemoteState'](this[_0x4505b3(0x134)],_0x5e3322);}async['run']({syncRecord:_0x5c442b,repository:_0x3dca46,convertToSFDX:_0x38b87d,provider:_0x21cef9}){const _0x2fdb28=a126_0x3b95f3;this['syncData']=_0x5c442b,this[_0x2fdb28(0xe6)]=_0x21cef9,this[_0x2fdb28(0xfd)]=_0x3dca46,this[_0x2fdb28(0x131)]=typedi_1[_0x2fdb28(0x102)][_0x2fdb28(0x136)](salesforce_logger_v3_service_1[_0x2fdb28(0x12e)]),this[_0x2fdb28(0x104)]='[FLOSUM\x20->\x20GIT]\x20[Repository:\x20'+this['syncData']['repositoryName']+']\x20[Branch:\x20'+this[_0x2fdb28(0x134)][_0x2fdb28(0x143)]+']';try{await this['sfLogger'][_0x2fdb28(0x109)](this['prefix']+_0x2fdb28(0xf5))[_0x2fdb28(0x11d)](),await this[_0x2fdb28(0xe7)]['setStatus'](this[_0x2fdb28(0x134)],_0x2fdb28(0x129)),this[_0x2fdb28(0x131)][_0x2fdb28(0x109)](this['prefix']+_0x2fdb28(0xe9)),await this['createBranchIfNotExists'](),await this[_0x2fdb28(0x131)][_0x2fdb28(0x109)](this[_0x2fdb28(0x104)]+_0x2fdb28(0x128))['send']();const _0x30cfdc=await this[_0x2fdb28(0x12d)]();this[_0x2fdb28(0x131)][_0x2fdb28(0x109)](this[_0x2fdb28(0x104)]+_0x2fdb28(0x11c)+_0x30cfdc+'.');if(_0x30cfdc){await this['salesforceSync'][_0x2fdb28(0xee)](this[_0x2fdb28(0x134)],_0x2fdb28(0x132)),await this[_0x2fdb28(0x131)]['log'](this[_0x2fdb28(0x104)]+_0x2fdb28(0xf7))[_0x2fdb28(0x11d)]();return;}const _0xe3a24d=await this['getCommitDto'](_0x38b87d);await this[_0x2fdb28(0xef)][_0x2fdb28(0x10a)](_0xe3a24d,this[_0x2fdb28(0x104)]),await this[_0x2fdb28(0xe7)][_0x2fdb28(0xee)](this[_0x2fdb28(0x134)],'Completed'),await this[_0x2fdb28(0x119)](),this['sfLogger'][_0x2fdb28(0x109)](this[_0x2fdb28(0x104)]+_0x2fdb28(0x121));}catch(_0x3a5101){throw _0x3a5101;}finally{await this[_0x2fdb28(0x131)][_0x2fdb28(0x11d)]();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a126_0x3b95f3(0x126)])({'transient':!![]}),__metadata(a126_0x3b95f3(0x127),[salesforce_sync_service_1[a126_0x3b95f3(0x116)],salesforce_service_1[a126_0x3b95f3(0x10d)],commit_components_job_1['CommitComponentsJob']])],FlosumSyncJob),exports[a126_0x3b95f3(0x11e)]=FlosumSyncJob;