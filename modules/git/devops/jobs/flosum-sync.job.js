const a127_0x15e9e0=a127_0x2d1b;function a127_0x4dca(){const _0x4dfac0=['82OVFFss','repositoryId','parse','getComponents','updateRemoteState','salesforceSync','prefix','components','setStatus',']\x20[Branch:\x20','Container','../../salesforce/services/salesforce-logger-v3.service','getBranchComponents','getCommitDto','apply','length','../../salesforce/services/salesforce-retriever.service','\x20Sync\x20status\x20','2682135HIdsMG','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','9yFwAVi','force','\x20Update\x20remote\x20state.','message','then','typedi','log','SalesforceLogger3','./commit-components.job','convertToSFDX','provider','defineProperty','commitJob','salesforceService','design:paramtypes','retrieveAttachment','\x20Checking\x20repository\x20on\x20Flosum\x20side.','9207fDzjOC','SalesforceService','\x20Checking\x20sync\x20status.','FlosumSyncJob','getOne','\x20Flosum\x20sync\x20job\x20done.','8864838Djjeui','sfLogger','lastCommit','\x20Start\x20Flosum\x20sync\x20job','__esModule','branchName','toString','58111790BbDCBW','Completed','6665740HtXPhF','getRemoteStateAttachmentId','CommitComponentsDto','(((.+)+)+)+$','userName','string','DEFAULT_GIT_USER_NAME','function','updateLastCommit','checkSyncStatus','SalesforceRetrieverService','SalesforceSyncService','repo','catch','branch','../../salesforce/services/salesforce-sync.service','send','../../../../constants','5YtsGHF','301nbNCRz','name','6902124yYHKMu','repository','repositoryName','sha','gitUrl','getComponentIds','108256nfRXYN','decorate','branches','run','__metadata','object','syncData','metadata'];a127_0x4dca=function(){return _0x4dfac0;};return a127_0x4dca();}(function(_0x4a1c15,_0x3cf5bc){const _0x7da247=a127_0x2d1b,_0x379bbd=_0x4a1c15();while(!![]){try{const _0x29ad61=-parseInt(_0x7da247(0x1eb))/0x1*(parseInt(_0x7da247(0x21d))/0x2)+-parseInt(_0x7da247(0x22f))/0x3+parseInt(_0x7da247(0x20f))/0x4*(-parseInt(_0x7da247(0x20c))/0x5)+-parseInt(_0x7da247(0x1f1))/0x6+-parseInt(_0x7da247(0x20d))/0x7*(parseInt(_0x7da247(0x215))/0x8)+parseInt(_0x7da247(0x231))/0x9*(parseInt(_0x7da247(0x1fa))/0xa)+parseInt(_0x7da247(0x1f8))/0xb;if(_0x29ad61===_0x3cf5bc)break;else _0x379bbd['push'](_0x379bbd['shift']());}catch(_0xacc16b){_0x379bbd['push'](_0x379bbd['shift']());}}}(a127_0x4dca,0xda07c));function a127_0x2d1b(_0x5d4342,_0x311aa1){const _0xadfad0=a127_0x4dca();return a127_0x2d1b=function(_0x408923,_0x28ab67){_0x408923=_0x408923-0x1e1;let _0x4dca5e=_0xadfad0[_0x408923];return _0x4dca5e;},a127_0x2d1b(_0x5d4342,_0x311aa1);}const a127_0x28ab67=(function(){let _0x51b5ee=!![];return function(_0x17a7f5,_0x20e2d4){const _0x560e74=_0x51b5ee?function(){const _0x4db433=a127_0x2d1b;if(_0x20e2d4){const _0x590e04=_0x20e2d4[_0x4db433(0x22b)](_0x17a7f5,arguments);return _0x20e2d4=null,_0x590e04;}}:function(){};return _0x51b5ee=![],_0x560e74;};}()),a127_0x408923=a127_0x28ab67(this,function(){const _0x29d7d0=a127_0x2d1b;return a127_0x408923[_0x29d7d0(0x1f7)]()['search']('(((.+)+)+)+$')['toString']()['constructor'](a127_0x408923)['search'](_0x29d7d0(0x1fd));});a127_0x408923();'use strict';var __decorate=this&&this['__decorate']||function(_0x3fce97,_0x3575ed,_0x7c47d1,_0x2e0ecc){const _0x22e9fa=a127_0x2d1b;var _0x46d8ac=arguments[_0x22e9fa(0x22c)],_0x34a6a1=_0x46d8ac<0x3?_0x3575ed:_0x2e0ecc===null?_0x2e0ecc=Object['getOwnPropertyDescriptor'](_0x3575ed,_0x7c47d1):_0x2e0ecc,_0x3f4973;if(typeof Reflect===_0x22e9fa(0x21a)&&typeof Reflect[_0x22e9fa(0x216)]===_0x22e9fa(0x201))_0x34a6a1=Reflect[_0x22e9fa(0x216)](_0x3fce97,_0x3575ed,_0x7c47d1,_0x2e0ecc);else{for(var _0x5bf7a0=_0x3fce97[_0x22e9fa(0x22c)]-0x1;_0x5bf7a0>=0x0;_0x5bf7a0--)if(_0x3f4973=_0x3fce97[_0x5bf7a0])_0x34a6a1=(_0x46d8ac<0x3?_0x3f4973(_0x34a6a1):_0x46d8ac>0x3?_0x3f4973(_0x3575ed,_0x7c47d1,_0x34a6a1):_0x3f4973(_0x3575ed,_0x7c47d1))||_0x34a6a1;}return _0x46d8ac>0x3&&_0x34a6a1&&Object['defineProperty'](_0x3575ed,_0x7c47d1,_0x34a6a1),_0x34a6a1;},__metadata=this&&this[a127_0x15e9e0(0x219)]||function(_0x1a76e0,_0x38b9a6){const _0x28d6af=a127_0x15e9e0;if(typeof Reflect===_0x28d6af(0x21a)&&typeof Reflect[_0x28d6af(0x21c)]===_0x28d6af(0x201))return Reflect[_0x28d6af(0x21c)](_0x1a76e0,_0x38b9a6);};Object[a127_0x15e9e0(0x1e5)](exports,a127_0x15e9e0(0x1f5),{'value':!![]}),exports[a127_0x15e9e0(0x1ee)]=void 0x0;const salesforce_logger_v3_service_1=require(a127_0x15e9e0(0x228)),typedi_1=require(a127_0x15e9e0(0x236)),constants_1=require(a127_0x15e9e0(0x20b)),salesforce_retriever_service_1=require(a127_0x15e9e0(0x22d)),salesforce_sync_service_1=require(a127_0x15e9e0(0x209)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a127_0x15e9e0(0x1e2));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x299adc,_0x6d1f18,_0x2f1bd6){const _0x3ceec1=a127_0x15e9e0;this[_0x3ceec1(0x222)]=_0x299adc,this[_0x3ceec1(0x1e7)]=_0x6d1f18,this[_0x3ceec1(0x1e6)]=_0x2f1bd6;}async['createBranchIfNotExists'](){const _0x210d64=a127_0x15e9e0;let _0x303a38=await this[_0x210d64(0x210)]['branches'][_0x210d64(0x1ef)](this[_0x210d64(0x21b)][_0x210d64(0x1f6)])['catch'](()=>null);!_0x303a38&&(_0x303a38=await this['repository'][_0x210d64(0x217)]['create']({'name':this[_0x210d64(0x21b)][_0x210d64(0x1f6)],'user':{'name':this['syncData'][_0x210d64(0x1fe)],'email':this[_0x210d64(0x21b)]['userEmail']}})),this[_0x210d64(0x208)]=_0x303a38;}async[a127_0x15e9e0(0x214)](){const _0x28e8f1=a127_0x15e9e0;return this[_0x28e8f1(0x21b)][_0x28e8f1(0x21e)]?this[_0x28e8f1(0x222)]['getComponentsFromRepository'](this[_0x28e8f1(0x21b)]['repositoryId']):this['salesforceSync'][_0x28e8f1(0x229)](this[_0x28e8f1(0x21b)]['branchId']);}async[a127_0x15e9e0(0x220)](){const _0x3985c3=a127_0x15e9e0,_0x124771=await this[_0x3985c3(0x214)](),_0x593431=new salesforce_retriever_service_1[(_0x3985c3(0x204))](this[_0x3985c3(0x1e7)]),_0x3d4435=await _0x593431[_0x3985c3(0x218)](_0x124771);return _0x3d4435;}async['getCommitDto'](_0x18c5c8){const _0x37cf44=a127_0x15e9e0,_0x4e5c82=new commit_components_dto_1[(_0x37cf44(0x1fc))]();return _0x4e5c82[_0x37cf44(0x234)]='Sync\x20repository',_0x4e5c82['user']={'name':constants_1[_0x37cf44(0x200)],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x4e5c82[_0x37cf44(0x224)]={'writed':await this[_0x37cf44(0x220)]()},_0x4e5c82[_0x37cf44(0x1e3)]=_0x18c5c8,_0x4e5c82[_0x37cf44(0x206)]=this[_0x37cf44(0x210)],_0x4e5c82[_0x37cf44(0x208)]=this[_0x37cf44(0x208)],_0x4e5c82[_0x37cf44(0x232)]=!![],_0x4e5c82[_0x37cf44(0x1e4)]=this[_0x37cf44(0x1e4)],_0x4e5c82['recordType']=this['syncData']['recordTypeName'],_0x4e5c82;}async[a127_0x15e9e0(0x203)](){const _0x2302e0=a127_0x15e9e0,_0xc1bb6b=await this[_0x2302e0(0x222)][_0x2302e0(0x1fb)](this[_0x2302e0(0x21b)]),_0x44a008=await this[_0x2302e0(0x1e7)][_0x2302e0(0x1e9)](_0xc1bb6b)[_0x2302e0(0x235)](_0x51e55b=>typeof _0x51e55b===_0x2302e0(0x1ff)?JSON[_0x2302e0(0x21f)](_0x51e55b):_0x51e55b)[_0x2302e0(0x207)](()=>({}));if(_0x44a008[this[_0x2302e0(0x210)][_0x2302e0(0x213)]]){if(_0x44a008[this[_0x2302e0(0x210)][_0x2302e0(0x213)]][_0x2302e0(0x1f3)]===this['branch'][_0x2302e0(0x212)])return!![];}return![];}async['updateLastCommit'](){const _0x47c965=a127_0x15e9e0,_0x3b67a8=await this[_0x47c965(0x210)][_0x47c965(0x217)][_0x47c965(0x1ef)](this[_0x47c965(0x208)][_0x47c965(0x20e)]);await this[_0x47c965(0x1f2)][_0x47c965(0x237)](this[_0x47c965(0x223)]+_0x47c965(0x233));const _0xa0f043={[this[_0x47c965(0x210)]['gitUrl']]:{'lastCommit':_0x3b67a8[_0x47c965(0x212)]}};await this[_0x47c965(0x222)][_0x47c965(0x221)](this['syncData'],_0xa0f043);}async[a127_0x15e9e0(0x218)]({syncRecord:_0x5bf400,repository:_0x392b14,convertToSFDX:_0x499de6,provider:_0x11b8e7}){const _0xd0f122=a127_0x15e9e0;this['syncData']=_0x5bf400,this[_0xd0f122(0x1e4)]=_0x11b8e7,this[_0xd0f122(0x210)]=_0x392b14,this[_0xd0f122(0x1f2)]=typedi_1[_0xd0f122(0x227)]['get'](salesforce_logger_v3_service_1[_0xd0f122(0x1e1)]),this[_0xd0f122(0x223)]=_0xd0f122(0x230)+this[_0xd0f122(0x21b)][_0xd0f122(0x211)]+_0xd0f122(0x226)+this[_0xd0f122(0x21b)][_0xd0f122(0x1f6)]+']';try{await this[_0xd0f122(0x1f2)][_0xd0f122(0x237)](this[_0xd0f122(0x223)]+_0xd0f122(0x1f4))['send'](),await this[_0xd0f122(0x222)]['setStatus'](this[_0xd0f122(0x21b)],'In\x20Progress'),this[_0xd0f122(0x1f2)][_0xd0f122(0x237)](this[_0xd0f122(0x223)]+_0xd0f122(0x1ea)),await this['createBranchIfNotExists'](),await this[_0xd0f122(0x1f2)]['log'](this[_0xd0f122(0x223)]+_0xd0f122(0x1ed))[_0xd0f122(0x20a)]();const _0x2bb01a=await this['checkSyncStatus']();this[_0xd0f122(0x1f2)][_0xd0f122(0x237)](this[_0xd0f122(0x223)]+_0xd0f122(0x22e)+_0x2bb01a+'.');if(_0x2bb01a){await this[_0xd0f122(0x222)]['setStatus'](this[_0xd0f122(0x21b)],_0xd0f122(0x1f9)),await this[_0xd0f122(0x1f2)][_0xd0f122(0x237)](this[_0xd0f122(0x223)]+'\x20Branch\x20synchronized.\x20Skip')[_0xd0f122(0x20a)]();return;}const _0x45388f=await this[_0xd0f122(0x22a)](_0x499de6);await this[_0xd0f122(0x1e6)]['run'](_0x45388f,this[_0xd0f122(0x223)]),await this['salesforceSync'][_0xd0f122(0x225)](this['syncData'],_0xd0f122(0x1f9)),await this[_0xd0f122(0x202)](),this[_0xd0f122(0x1f2)][_0xd0f122(0x237)](this[_0xd0f122(0x223)]+_0xd0f122(0x1f0));}catch(_0xc5c2b5){throw _0xc5c2b5;}finally{await this[_0xd0f122(0x1f2)][_0xd0f122(0x20a)]();}}};FlosumSyncJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a127_0x15e9e0(0x1e8),[salesforce_sync_service_1[a127_0x15e9e0(0x205)],salesforce_service_1[a127_0x15e9e0(0x1ec)],commit_components_job_1['CommitComponentsJob']])],FlosumSyncJob),exports[a127_0x15e9e0(0x1ee)]=FlosumSyncJob;