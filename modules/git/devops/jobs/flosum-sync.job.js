const a106_0x151bda=a106_0x4c52;(function(_0x2b1e8c,_0x448775){const _0x9843a=a106_0x4c52,_0x27af71=_0x2b1e8c();while(!![]){try{const _0x305a64=parseInt(_0x9843a(0x1f9))/0x1*(-parseInt(_0x9843a(0x1f2))/0x2)+-parseInt(_0x9843a(0x1c5))/0x3+parseInt(_0x9843a(0x1ee))/0x4+parseInt(_0x9843a(0x1d5))/0x5*(parseInt(_0x9843a(0x1c0))/0x6)+parseInt(_0x9843a(0x200))/0x7+parseInt(_0x9843a(0x1b9))/0x8*(-parseInt(_0x9843a(0x1fa))/0x9)+-parseInt(_0x9843a(0x206))/0xa;if(_0x305a64===_0x448775)break;else _0x27af71['push'](_0x27af71['shift']());}catch(_0x24525d){_0x27af71['push'](_0x27af71['shift']());}}}(a106_0x2e6c,0xa57ea));const a106_0x4d3951=(function(){let _0xdf0d6f=!![];return function(_0x56447a,_0x32035c){const _0x30e877=_0xdf0d6f?function(){const _0x52f3ac=a106_0x4c52;if(_0x32035c){const _0x15bce4=_0x32035c[_0x52f3ac(0x1d3)](_0x56447a,arguments);return _0x32035c=null,_0x15bce4;}}:function(){};return _0xdf0d6f=![],_0x30e877;};}()),a106_0x45ac93=a106_0x4d3951(this,function(){const _0x3dc4a8=a106_0x4c52;return a106_0x45ac93[_0x3dc4a8(0x1c4)]()[_0x3dc4a8(0x1bd)]('(((.+)+)+)+$')[_0x3dc4a8(0x1c4)]()[_0x3dc4a8(0x1da)](a106_0x45ac93)[_0x3dc4a8(0x1bd)]('(((.+)+)+)+$');});a106_0x45ac93();'use strict';var __decorate=this&&this['__decorate']||function(_0x3f2f35,_0x338ff5,_0x358da0,_0x32f156){const _0x533a0d=a106_0x4c52;var _0x350e0b=arguments[_0x533a0d(0x1eb)],_0x46c57e=_0x350e0b<0x3?_0x338ff5:_0x32f156===null?_0x32f156=Object[_0x533a0d(0x1b2)](_0x338ff5,_0x358da0):_0x32f156,_0x544a87;if(typeof Reflect===_0x533a0d(0x1ed)&&typeof Reflect[_0x533a0d(0x1b7)]==='function')_0x46c57e=Reflect[_0x533a0d(0x1b7)](_0x3f2f35,_0x338ff5,_0x358da0,_0x32f156);else{for(var _0xa5a0c0=_0x3f2f35['length']-0x1;_0xa5a0c0>=0x0;_0xa5a0c0--)if(_0x544a87=_0x3f2f35[_0xa5a0c0])_0x46c57e=(_0x350e0b<0x3?_0x544a87(_0x46c57e):_0x350e0b>0x3?_0x544a87(_0x338ff5,_0x358da0,_0x46c57e):_0x544a87(_0x338ff5,_0x358da0))||_0x46c57e;}return _0x350e0b>0x3&&_0x46c57e&&Object[_0x533a0d(0x1c1)](_0x338ff5,_0x358da0,_0x46c57e),_0x46c57e;},__metadata=this&&this[a106_0x151bda(0x1c7)]||function(_0x499d3c,_0x4c1b3c){const _0x5490ac=a106_0x151bda;if(typeof Reflect===_0x5490ac(0x1ed)&&typeof Reflect['metadata']===_0x5490ac(0x1fb))return Reflect[_0x5490ac(0x1b1)](_0x499d3c,_0x4c1b3c);};function a106_0x2e6c(){const _0x4732cd=['function','name','user','FlosumSyncJob','getCommitDto','6301533hmOiKI','log','updateRemoteState','\x20Update\x20remote\x20state.','CommitComponentsJob','string','4944310hPfsvv','lastCommit','syncData','metadata','getOwnPropertyDescriptor','salesforceSync','../../salesforce/services/salesforce.service','branch','\x20Checking\x20repository\x20on\x20Flosum\x20side.','decorate','\x20Start\x20Flosum\x20sync\x20job','176RWuVnQ','DEFAULT_GIT_USER_EMAIL','SalesforceSyncService','\x20Checking\x20sync\x20status.','search','catch','repositoryName','6KQKSAy','defineProperty','getComponents','__esModule','toString','1299348uAcknc','repository','__metadata','typedi','provider','create','Container','CommitComponentsDto','prefix','../../salesforce/services/salesforce-logger-v3.service','SalesforceService','send','../../../../constants','parse','apply','\x20Sync\x20status\x20','3103795mtbEuc','In\x20Progress','SalesforceRetrieverService','gitUrl','sfLogger','constructor','branches','../../salesforce/services/salesforce-sync.service','createBranchIfNotExists','branchName','getBranchComponents','components','run','sha','then','DEFAULT_GIT_USER_NAME','getComponentsFromRepository','Sync\x20repository','checkSyncStatus','Completed','../dto/commit-components.dto','salesforceService','length','repositoryId','object','3011728FVIGFp',']\x20[Branch:\x20','../../salesforce/services/salesforce-retriever.service','\x20Flosum\x20sync\x20job\x20done.','1494xTibqr','getComponentIds','setStatus','commitJob','get','repo','getOne','633EPTiEL','80037sNWIpB'];a106_0x2e6c=function(){return _0x4732cd;};return a106_0x2e6c();}Object[a106_0x151bda(0x1c1)](exports,a106_0x151bda(0x1c3),{'value':!![]}),exports['FlosumSyncJob']=void 0x0;function a106_0x4c52(_0x5c4704,_0x75c789){const _0x4117eb=a106_0x2e6c();return a106_0x4c52=function(_0x45ac93,_0x4d3951){_0x45ac93=_0x45ac93-0x1b0;let _0x2e6c01=_0x4117eb[_0x45ac93];return _0x2e6c01;},a106_0x4c52(_0x5c4704,_0x75c789);}const salesforce_logger_v3_service_1=require(a106_0x151bda(0x1ce)),typedi_1=require(a106_0x151bda(0x1c8)),constants_1=require(a106_0x151bda(0x1d1)),salesforce_retriever_service_1=require(a106_0x151bda(0x1f0)),salesforce_sync_service_1=require(a106_0x151bda(0x1dc)),salesforce_service_1=require(a106_0x151bda(0x1b4)),commit_components_dto_1=require(a106_0x151bda(0x1e9)),commit_components_job_1=require('./commit-components.job');let FlosumSyncJob=class FlosumSyncJob{constructor(_0x1f9ca3,_0xa9a320,_0x2943b0){const _0x13ed9c=a106_0x151bda;this['salesforceSync']=_0x1f9ca3,this['salesforceService']=_0xa9a320,this[_0x13ed9c(0x1f5)]=_0x2943b0;}async[a106_0x151bda(0x1dd)](){const _0x3530c4=a106_0x151bda;let _0x3ec558=await this[_0x3530c4(0x1c6)]['branches'][_0x3530c4(0x1f8)](this[_0x3530c4(0x1b0)][_0x3530c4(0x1de)])[_0x3530c4(0x1be)](()=>null);!_0x3ec558&&(_0x3ec558=await this[_0x3530c4(0x1c6)][_0x3530c4(0x1db)][_0x3530c4(0x1ca)]({'name':this['syncData']['branchName']})),this[_0x3530c4(0x1b5)]=_0x3ec558;}async[a106_0x151bda(0x1f3)](){const _0x51d521=a106_0x151bda;return this[_0x51d521(0x1b0)][_0x51d521(0x1ec)]?this[_0x51d521(0x1b3)][_0x51d521(0x1e5)](this[_0x51d521(0x1b0)][_0x51d521(0x1ec)]):this['salesforceSync'][_0x51d521(0x1df)](this['syncData']['branchId']);}async[a106_0x151bda(0x1c2)](){const _0x377995=a106_0x151bda,_0x306951=await this[_0x377995(0x1f3)](),_0x58e993=new salesforce_retriever_service_1[(_0x377995(0x1d7))](this[_0x377995(0x1ea)]),_0x301493=await _0x58e993[_0x377995(0x1e1)](_0x306951);return _0x301493;}async[a106_0x151bda(0x1ff)](_0x117010){const _0xfbff98=a106_0x151bda,_0x3fff8f=new commit_components_dto_1[(_0xfbff98(0x1cc))]();return _0x3fff8f['message']=_0xfbff98(0x1e6),_0x3fff8f[_0xfbff98(0x1fd)]={'name':constants_1[_0xfbff98(0x1e4)],'email':constants_1[_0xfbff98(0x1ba)]},_0x3fff8f[_0xfbff98(0x1e0)]={'writed':await this['getComponents']()},_0x3fff8f['convertToSFDX']=_0x117010,_0x3fff8f[_0xfbff98(0x1f7)]=this[_0xfbff98(0x1c6)],_0x3fff8f[_0xfbff98(0x1b5)]=this[_0xfbff98(0x1b5)],_0x3fff8f['force']=!![],_0x3fff8f['provider']=this[_0xfbff98(0x1c9)],_0x3fff8f;}async[a106_0x151bda(0x1e7)](){const _0x356578=a106_0x151bda,_0x3082df=await this[_0x356578(0x1b3)]['getRemoteStateAttachmentId'](this[_0x356578(0x1b0)]),_0x1b2595=await this[_0x356578(0x1ea)]['retrieveAttachment'](_0x3082df)[_0x356578(0x1e3)](_0x1a147d=>typeof _0x1a147d===_0x356578(0x205)?JSON[_0x356578(0x1d2)](_0x1a147d):_0x1a147d)[_0x356578(0x1be)](()=>({}));if(_0x1b2595[this['repository'][_0x356578(0x1d8)]]){if(_0x1b2595[this[_0x356578(0x1c6)][_0x356578(0x1d8)]][_0x356578(0x207)]===this[_0x356578(0x1b5)]['sha'])return!![];}return![];}async['updateLastCommit'](){const _0x2d7063=a106_0x151bda,_0x268d5a=await this['repository'][_0x2d7063(0x1db)][_0x2d7063(0x1f8)](this['branch'][_0x2d7063(0x1fc)]);await this[_0x2d7063(0x1d9)][_0x2d7063(0x201)](this[_0x2d7063(0x1cd)]+_0x2d7063(0x203));const _0x190281={[this[_0x2d7063(0x1c6)][_0x2d7063(0x1d8)]]:{'lastCommit':_0x268d5a[_0x2d7063(0x1e2)]}};await this['salesforceSync'][_0x2d7063(0x202)](this[_0x2d7063(0x1b0)],_0x190281);}async[a106_0x151bda(0x1e1)]({syncRecord:_0xf93869,repository:_0x37c783,convertToSFDX:_0x5c3bfa,provider:_0x3e9fc2}){const _0x26c248=a106_0x151bda;this[_0x26c248(0x1b0)]=_0xf93869,this[_0x26c248(0x1c9)]=_0x3e9fc2,this[_0x26c248(0x1c6)]=_0x37c783,this[_0x26c248(0x1d9)]=typedi_1[_0x26c248(0x1cb)][_0x26c248(0x1f6)](salesforce_logger_v3_service_1['SalesforceLogger3']),this[_0x26c248(0x1cd)]='[FLOSUM\x20->\x20GIT]\x20[Repository:\x20'+this[_0x26c248(0x1b0)][_0x26c248(0x1bf)]+_0x26c248(0x1ef)+this['syncData']['branchName']+']';try{await this[_0x26c248(0x1d9)]['log'](this[_0x26c248(0x1cd)]+_0x26c248(0x1b8))[_0x26c248(0x1d0)](),await this[_0x26c248(0x1b3)][_0x26c248(0x1f4)](this['syncData'],_0x26c248(0x1d6)),this[_0x26c248(0x1d9)][_0x26c248(0x201)](this['prefix']+_0x26c248(0x1b6)),await this['createBranchIfNotExists'](),await this[_0x26c248(0x1d9)][_0x26c248(0x201)](this['prefix']+_0x26c248(0x1bc))[_0x26c248(0x1d0)]();const _0x559aa9=await this[_0x26c248(0x1e7)]();this[_0x26c248(0x1d9)][_0x26c248(0x201)](this[_0x26c248(0x1cd)]+_0x26c248(0x1d4)+_0x559aa9+'.');if(_0x559aa9){await this['salesforceSync'][_0x26c248(0x1f4)](this[_0x26c248(0x1b0)],'Completed'),await this[_0x26c248(0x1d9)][_0x26c248(0x201)](this[_0x26c248(0x1cd)]+'\x20Branch\x20synchronized.\x20Skip')[_0x26c248(0x1d0)]();return;}const _0x8b2a23=await this[_0x26c248(0x1ff)](_0x5c3bfa);await this[_0x26c248(0x1f5)][_0x26c248(0x1e1)](_0x8b2a23,this[_0x26c248(0x1cd)]),await this['salesforceSync'][_0x26c248(0x1f4)](this[_0x26c248(0x1b0)],_0x26c248(0x1e8)),await this['updateLastCommit'](),this[_0x26c248(0x1d9)]['log'](this[_0x26c248(0x1cd)]+_0x26c248(0x1f1));}catch(_0x2eed83){throw _0x2eed83;}finally{await this[_0x26c248(0x1d9)][_0x26c248(0x1d0)]();}}};FlosumSyncJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_sync_service_1[a106_0x151bda(0x1bb)],salesforce_service_1[a106_0x151bda(0x1cf)],commit_components_job_1[a106_0x151bda(0x204)]])],FlosumSyncJob),exports[a106_0x151bda(0x1fe)]=FlosumSyncJob;