const a74_0x2da7df=a74_0x5d67;(function(_0x110d5e,_0x3d0d13){const _0xd3a247=a74_0x5d67,_0x212c68=_0x110d5e();while(!![]){try{const _0x423fd6=parseInt(_0xd3a247(0x1f1))/0x1+parseInt(_0xd3a247(0x1f8))/0x2+-parseInt(_0xd3a247(0x1c3))/0x3+parseInt(_0xd3a247(0x1c9))/0x4*(-parseInt(_0xd3a247(0x1fe))/0x5)+-parseInt(_0xd3a247(0x1b6))/0x6+-parseInt(_0xd3a247(0x1d4))/0x7+parseInt(_0xd3a247(0x1d3))/0x8*(parseInt(_0xd3a247(0x1a9))/0x9);if(_0x423fd6===_0x3d0d13)break;else _0x212c68['push'](_0x212c68['shift']());}catch(_0x189e50){_0x212c68['push'](_0x212c68['shift']());}}}(a74_0x2528,0xdca3d));function a74_0x5d67(_0x362638,_0x54f51f){const _0x19a4b1=a74_0x2528();return a74_0x5d67=function(_0x2fdf62,_0x415318){_0x2fdf62=_0x2fdf62-0x1a9;let _0x25287b=_0x19a4b1[_0x2fdf62];return _0x25287b;},a74_0x5d67(_0x362638,_0x54f51f);}const a74_0x415318=(function(){let _0x1d14f7=!![];return function(_0x552030,_0x34bda1){const _0x10481d=_0x1d14f7?function(){const _0x5004bd=a74_0x5d67;if(_0x34bda1){const _0x4d40dd=_0x34bda1[_0x5004bd(0x1fd)](_0x552030,arguments);return _0x34bda1=null,_0x4d40dd;}}:function(){};return _0x1d14f7=![],_0x10481d;};}()),a74_0x2fdf62=a74_0x415318(this,function(){const _0x1dddd7=a74_0x5d67;return a74_0x2fdf62[_0x1dddd7(0x1ad)]()[_0x1dddd7(0x1af)](_0x1dddd7(0x1b5))['toString']()[_0x1dddd7(0x1fa)](a74_0x2fdf62)['search'](_0x1dddd7(0x1b5));});a74_0x2fdf62();'use strict';var __decorate=this&&this[a74_0x2da7df(0x1df)]||function(_0x1b9ead,_0x4bdc0c,_0x1cc94c,_0x8cf6c6){const _0x55d099=a74_0x2da7df;var _0x7ad1e3=arguments[_0x55d099(0x1bd)],_0x2efd87=_0x7ad1e3<0x3?_0x4bdc0c:_0x8cf6c6===null?_0x8cf6c6=Object[_0x55d099(0x1ca)](_0x4bdc0c,_0x1cc94c):_0x8cf6c6,_0x30e3bd;if(typeof Reflect===_0x55d099(0x1b1)&&typeof Reflect[_0x55d099(0x1b0)]==='function')_0x2efd87=Reflect[_0x55d099(0x1b0)](_0x1b9ead,_0x4bdc0c,_0x1cc94c,_0x8cf6c6);else{for(var _0x3a76d8=_0x1b9ead[_0x55d099(0x1bd)]-0x1;_0x3a76d8>=0x0;_0x3a76d8--)if(_0x30e3bd=_0x1b9ead[_0x3a76d8])_0x2efd87=(_0x7ad1e3<0x3?_0x30e3bd(_0x2efd87):_0x7ad1e3>0x3?_0x30e3bd(_0x4bdc0c,_0x1cc94c,_0x2efd87):_0x30e3bd(_0x4bdc0c,_0x1cc94c))||_0x2efd87;}return _0x7ad1e3>0x3&&_0x2efd87&&Object[_0x55d099(0x1e5)](_0x4bdc0c,_0x1cc94c,_0x2efd87),_0x2efd87;},__metadata=this&&this[a74_0x2da7df(0x1c1)]||function(_0x5a823c,_0x370658){const _0x315b1e=a74_0x2da7df;if(typeof Reflect===_0x315b1e(0x1b1)&&typeof Reflect[_0x315b1e(0x1f6)]===_0x315b1e(0x1c2))return Reflect[_0x315b1e(0x1f6)](_0x5a823c,_0x370658);};function a74_0x2528(){const _0x3677fd=['design:paramtypes','send','FlosumSyncJob','\x20Checking\x20sync\x20status.','Sync\x20repository','get','prefix','gitUrl','8JkOfZI','9671788vsglqV','../../salesforce/services/salesforce-logger-v3.service','\x20Branch\x20synchronized.\x20Skip','getRemoteStateAttachmentId','CommitComponentsDto','repo','\x20Checking\x20repository\x20on\x20Flosum\x20side.','string','getComponentIds','getCommitDto','user','__decorate','salesforceService','convertToSFDX','getBranchComponents','Service','updateRemoteState','defineProperty','\x20Sync\x20status\x20','../../salesforce/services/salesforce-sync.service','DEFAULT_GIT_USER_EMAIL','branch','__esModule','../../salesforce/services/salesforce-retriever.service','createBranchIfNotExists','typedi','then','repositoryId','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','1170691IvIbSz','getOne','lastCommit',']\x20[Branch:\x20','syncData','metadata','components','598740BfZowx','salesforceSync','constructor','sfLogger','CommitComponentsJob','apply','5zYxoEM','29459304nqHnvU','log','provider','Completed','toString','repository','search','decorate','object','catch','./commit-components.job','SalesforceRetrieverService','(((.+)+)+)+$','3683844DxHFGm','branchName','In\x20Progress','../../../../constants','getComponentsFromRepository','branchId','\x20Update\x20remote\x20state.','length','branches','SalesforceSyncService','sha','__metadata','function','1957695GKRuig','checkSyncStatus','updateLastCommit','name','run','setStatus','4765412VETbAN','getOwnPropertyDescriptor'];a74_0x2528=function(){return _0x3677fd;};return a74_0x2528();}Object[a74_0x2da7df(0x1e5)](exports,a74_0x2da7df(0x1ea),{'value':!![]}),exports['FlosumSyncJob']=void 0x0;const salesforce_logger_v3_service_1=require(a74_0x2da7df(0x1d5)),typedi_1=require(a74_0x2da7df(0x1ed)),constants_1=require(a74_0x2da7df(0x1b9)),salesforce_retriever_service_1=require(a74_0x2da7df(0x1eb)),salesforce_sync_service_1=require(a74_0x2da7df(0x1e7)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a74_0x2da7df(0x1b3));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x15ca11,_0xd3e90,_0x1df34c){const _0xd2a0b8=a74_0x2da7df;this[_0xd2a0b8(0x1f9)]=_0x15ca11,this['salesforceService']=_0xd3e90,this['commitJob']=_0x1df34c;}async[a74_0x2da7df(0x1ec)](){const _0x1de800=a74_0x2da7df;let _0x1907ca=await this[_0x1de800(0x1ae)]['branches'][_0x1de800(0x1f2)](this[_0x1de800(0x1f5)][_0x1de800(0x1b7)])[_0x1de800(0x1b2)](()=>null);!_0x1907ca&&(_0x1907ca=await this['repository'][_0x1de800(0x1be)]['create']({'name':this[_0x1de800(0x1f5)][_0x1de800(0x1b7)]})),this[_0x1de800(0x1e9)]=_0x1907ca;}async['getComponentIds'](){const _0x674228=a74_0x2da7df;return this['syncData'][_0x674228(0x1ef)]?this[_0x674228(0x1f9)][_0x674228(0x1ba)](this[_0x674228(0x1f5)]['repositoryId']):this['salesforceSync'][_0x674228(0x1e2)](this[_0x674228(0x1f5)][_0x674228(0x1bb)]);}async['getComponents'](){const _0x17ec1a=a74_0x2da7df,_0x2a3525=await this[_0x17ec1a(0x1dc)](),_0x466f84=new salesforce_retriever_service_1[(_0x17ec1a(0x1b4))](this[_0x17ec1a(0x1e0)]),_0x319fe6=await _0x466f84[_0x17ec1a(0x1c7)](_0x2a3525);return _0x319fe6;}async[a74_0x2da7df(0x1dd)](_0x1a3491){const _0x2c9509=a74_0x2da7df,_0x4f727a=new commit_components_dto_1[(_0x2c9509(0x1d8))]();return _0x4f727a['message']=_0x2c9509(0x1cf),_0x4f727a[_0x2c9509(0x1de)]={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1[_0x2c9509(0x1e8)]},_0x4f727a[_0x2c9509(0x1f7)]={'writed':await this['getComponents']()},_0x4f727a[_0x2c9509(0x1e1)]=_0x1a3491,_0x4f727a[_0x2c9509(0x1d9)]=this[_0x2c9509(0x1ae)],_0x4f727a[_0x2c9509(0x1e9)]=this['branch'],_0x4f727a['force']=!![],_0x4f727a[_0x2c9509(0x1ab)]=this[_0x2c9509(0x1ab)],_0x4f727a;}async[a74_0x2da7df(0x1c4)](){const _0x27ff0c=a74_0x2da7df,_0x220711=await this[_0x27ff0c(0x1f9)][_0x27ff0c(0x1d7)](this[_0x27ff0c(0x1f5)]),_0x406679=await this['salesforceService']['retrieveAttachment'](_0x220711)[_0x27ff0c(0x1ee)](_0x528345=>typeof _0x528345===_0x27ff0c(0x1db)?JSON['parse'](_0x528345):_0x528345)[_0x27ff0c(0x1b2)](()=>({}));if(_0x406679[this[_0x27ff0c(0x1ae)][_0x27ff0c(0x1d2)]]){if(_0x406679[this[_0x27ff0c(0x1ae)][_0x27ff0c(0x1d2)]][_0x27ff0c(0x1f3)]===this[_0x27ff0c(0x1e9)][_0x27ff0c(0x1c0)])return!![];}return![];}async[a74_0x2da7df(0x1c5)](){const _0x2e53ac=a74_0x2da7df,_0x32eaea=await this[_0x2e53ac(0x1ae)]['branches'][_0x2e53ac(0x1f2)](this['branch'][_0x2e53ac(0x1c6)]);await this[_0x2e53ac(0x1fb)][_0x2e53ac(0x1aa)](this[_0x2e53ac(0x1d1)]+_0x2e53ac(0x1bc));const _0x1d3083={[this['repository'][_0x2e53ac(0x1d2)]]:{'lastCommit':_0x32eaea[_0x2e53ac(0x1c0)]}};await this['salesforceSync'][_0x2e53ac(0x1e4)](this['syncData'],_0x1d3083);}async['run']({syncRecord:_0x33dcae,repository:_0x5ed517,convertToSFDX:_0x1ed4c0,provider:_0x4729ee}){const _0x4379a4=a74_0x2da7df;this['syncData']=_0x33dcae,this[_0x4379a4(0x1ab)]=_0x4729ee,this[_0x4379a4(0x1ae)]=_0x5ed517,this[_0x4379a4(0x1fb)]=typedi_1['Container'][_0x4379a4(0x1d0)](salesforce_logger_v3_service_1['SalesforceLogger3']),this[_0x4379a4(0x1d1)]=_0x4379a4(0x1f0)+this[_0x4379a4(0x1f5)]['repositoryName']+_0x4379a4(0x1f4)+this[_0x4379a4(0x1f5)]['branchName']+']';try{await this[_0x4379a4(0x1fb)][_0x4379a4(0x1aa)](this[_0x4379a4(0x1d1)]+'\x20Start\x20Flosum\x20sync\x20job')[_0x4379a4(0x1cc)](),await this[_0x4379a4(0x1f9)][_0x4379a4(0x1c8)](this[_0x4379a4(0x1f5)],_0x4379a4(0x1b8)),this['sfLogger']['log'](this[_0x4379a4(0x1d1)]+_0x4379a4(0x1da)),await this[_0x4379a4(0x1ec)](),await this[_0x4379a4(0x1fb)][_0x4379a4(0x1aa)](this[_0x4379a4(0x1d1)]+_0x4379a4(0x1ce))[_0x4379a4(0x1cc)]();const _0x2503ba=await this['checkSyncStatus']();this[_0x4379a4(0x1fb)][_0x4379a4(0x1aa)](this[_0x4379a4(0x1d1)]+_0x4379a4(0x1e6)+_0x2503ba+'.');if(_0x2503ba){await this[_0x4379a4(0x1f9)]['setStatus'](this[_0x4379a4(0x1f5)],_0x4379a4(0x1ac)),await this['sfLogger'][_0x4379a4(0x1aa)](this[_0x4379a4(0x1d1)]+_0x4379a4(0x1d6))[_0x4379a4(0x1cc)]();return;}const _0x2cc84f=await this['getCommitDto'](_0x1ed4c0);await this['commitJob']['run'](_0x2cc84f,this[_0x4379a4(0x1d1)]),await this[_0x4379a4(0x1f9)][_0x4379a4(0x1c8)](this[_0x4379a4(0x1f5)],_0x4379a4(0x1ac)),await this[_0x4379a4(0x1c5)](),this['sfLogger'][_0x4379a4(0x1aa)](this[_0x4379a4(0x1d1)]+'\x20Flosum\x20sync\x20job\x20done.');}catch(_0x47af83){throw _0x47af83;}finally{await this[_0x4379a4(0x1fb)]['send']();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a74_0x2da7df(0x1e3)])({'transient':!![]}),__metadata(a74_0x2da7df(0x1cb),[salesforce_sync_service_1[a74_0x2da7df(0x1bf)],salesforce_service_1['SalesforceService'],commit_components_job_1[a74_0x2da7df(0x1fc)]])],FlosumSyncJob),exports[a74_0x2da7df(0x1cd)]=FlosumSyncJob;