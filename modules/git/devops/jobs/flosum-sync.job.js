const a108_0xa0233b=a108_0x54d2;(function(_0x2c8cd7,_0x28a131){const _0x133145=a108_0x54d2,_0x36778d=_0x2c8cd7();while(!![]){try{const _0x4a2053=parseInt(_0x133145(0x177))/0x1+parseInt(_0x133145(0x16a))/0x2+parseInt(_0x133145(0x143))/0x3*(parseInt(_0x133145(0x14c))/0x4)+-parseInt(_0x133145(0x197))/0x5+-parseInt(_0x133145(0x189))/0x6+-parseInt(_0x133145(0x16c))/0x7*(parseInt(_0x133145(0x190))/0x8)+-parseInt(_0x133145(0x191))/0x9*(-parseInt(_0x133145(0x196))/0xa);if(_0x4a2053===_0x28a131)break;else _0x36778d['push'](_0x36778d['shift']());}catch(_0x3e9640){_0x36778d['push'](_0x36778d['shift']());}}}(a108_0xcae2,0xb92f7));const a108_0x3bde94=(function(){let _0xce3632=!![];return function(_0x239184,_0x14fe77){const _0x399ef6=_0xce3632?function(){if(_0x14fe77){const _0x26c9ca=_0x14fe77['apply'](_0x239184,arguments);return _0x14fe77=null,_0x26c9ca;}}:function(){};return _0xce3632=![],_0x399ef6;};}()),a108_0x53695e=a108_0x3bde94(this,function(){const _0x98edd6=a108_0x54d2;return a108_0x53695e[_0x98edd6(0x163)]()[_0x98edd6(0x17f)](_0x98edd6(0x199))[_0x98edd6(0x163)]()[_0x98edd6(0x16e)](a108_0x53695e)[_0x98edd6(0x17f)]('(((.+)+)+)+$');});function a108_0xcae2(){const _0x5e6c5c=['\x20Sync\x20status\x20','../../../../constants','recordType','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','parse','\x20Flosum\x20sync\x20job\x20done.','branch','gitUrl','user','commitJob','getOwnPropertyDescriptor',']\x20[Branch:\x20','branches','salesforceService','defineProperty','../../salesforce/services/salesforce-logger-v3.service','\x20Checking\x20repository\x20on\x20Flosum\x20side.','toString','prefix','design:paramtypes','decorate','__decorate','send','getOne','2794772MRiVwE','provider','14399lfgxtx','Container','constructor','../dto/commit-components.dto','__esModule','../../salesforce/services/salesforce.service','createBranchIfNotExists','\x20Branch\x20synchronized.\x20Skip','create','updateLastCommit','getComponents','536890rhQgka','getBranchComponents','repo','length','\x20Start\x20Flosum\x20sync\x20job','./commit-components.job','convertToSFDX','getComponentIds','search','branchId','sha','getComponentsFromRepository','Completed','repositoryId','checkSyncStatus','metadata','SalesforceRetrieverService','Sync\x20repository','5123082VYhhiI','__metadata','run','recordTypeName','log','../../salesforce/services/salesforce-retriever.service','In\x20Progress','3608ArVMVf','4149AgmkPJ','getRemoteStateAttachmentId','typedi','force','SalesforceLogger3','5830HjLjeh','3118100DyKIku','object','(((.+)+)+)+$','salesforceSync','\x20Update\x20remote\x20state.','message','18THAFdh','name','Service','SalesforceSyncService','setStatus','syncData','lastCommit','repository','DEFAULT_GIT_USER_EMAIL','640436lgaZit','branchName','components','string','getCommitDto','sfLogger'];a108_0xcae2=function(){return _0x5e6c5c;};return a108_0xcae2();}a108_0x53695e();'use strict';var __decorate=this&&this[a108_0xa0233b(0x167)]||function(_0x2e92f8,_0x1034d7,_0xfb5b29,_0x7a7a01){const _0x56be37=a108_0xa0233b;var _0x4d7298=arguments[_0x56be37(0x17a)],_0x410b98=_0x4d7298<0x3?_0x1034d7:_0x7a7a01===null?_0x7a7a01=Object[_0x56be37(0x15c)](_0x1034d7,_0xfb5b29):_0x7a7a01,_0x4c5289;if(typeof Reflect===_0x56be37(0x198)&&typeof Reflect[_0x56be37(0x166)]==='function')_0x410b98=Reflect['decorate'](_0x2e92f8,_0x1034d7,_0xfb5b29,_0x7a7a01);else{for(var _0x5db02c=_0x2e92f8[_0x56be37(0x17a)]-0x1;_0x5db02c>=0x0;_0x5db02c--)if(_0x4c5289=_0x2e92f8[_0x5db02c])_0x410b98=(_0x4d7298<0x3?_0x4c5289(_0x410b98):_0x4d7298>0x3?_0x4c5289(_0x1034d7,_0xfb5b29,_0x410b98):_0x4c5289(_0x1034d7,_0xfb5b29))||_0x410b98;}return _0x4d7298>0x3&&_0x410b98&&Object[_0x56be37(0x160)](_0x1034d7,_0xfb5b29,_0x410b98),_0x410b98;},__metadata=this&&this[a108_0xa0233b(0x18a)]||function(_0x3329aa,_0x2e6d0c){const _0x2a76cb=a108_0xa0233b;if(typeof Reflect===_0x2a76cb(0x198)&&typeof Reflect[_0x2a76cb(0x186)]==='function')return Reflect[_0x2a76cb(0x186)](_0x3329aa,_0x2e6d0c);};Object['defineProperty'](exports,a108_0xa0233b(0x170),{'value':!![]}),exports['FlosumSyncJob']=void 0x0;const salesforce_logger_v3_service_1=require(a108_0xa0233b(0x161)),typedi_1=require(a108_0xa0233b(0x193)),constants_1=require(a108_0xa0233b(0x153)),salesforce_retriever_service_1=require(a108_0xa0233b(0x18e)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a108_0xa0233b(0x171)),commit_components_dto_1=require(a108_0xa0233b(0x16f)),commit_components_job_1=require(a108_0xa0233b(0x17c));function a108_0x54d2(_0x1515b5,_0x58592){const _0x21f2b5=a108_0xcae2();return a108_0x54d2=function(_0x53695e,_0x3bde94){_0x53695e=_0x53695e-0x142;let _0xcae2f3=_0x21f2b5[_0x53695e];return _0xcae2f3;},a108_0x54d2(_0x1515b5,_0x58592);}let FlosumSyncJob=class FlosumSyncJob{constructor(_0x1d0165,_0x13f161,_0x501d62){const _0x4f15d0=a108_0xa0233b;this[_0x4f15d0(0x19a)]=_0x1d0165,this[_0x4f15d0(0x15f)]=_0x13f161,this['commitJob']=_0x501d62;}async['createBranchIfNotExists'](){const _0x570753=a108_0xa0233b;let _0x52bcbe=await this[_0x570753(0x14a)][_0x570753(0x15e)][_0x570753(0x169)](this['syncData'][_0x570753(0x14d)])['catch'](()=>null);!_0x52bcbe&&(_0x52bcbe=await this[_0x570753(0x14a)][_0x570753(0x15e)][_0x570753(0x174)]({'name':this['syncData'][_0x570753(0x14d)]})),this[_0x570753(0x158)]=_0x52bcbe;}async[a108_0xa0233b(0x17e)](){const _0x5f29a5=a108_0xa0233b;return this[_0x5f29a5(0x148)][_0x5f29a5(0x184)]?this[_0x5f29a5(0x19a)][_0x5f29a5(0x182)](this['syncData'][_0x5f29a5(0x184)]):this[_0x5f29a5(0x19a)][_0x5f29a5(0x178)](this['syncData'][_0x5f29a5(0x180)]);}async[a108_0xa0233b(0x176)](){const _0x5bd3f3=a108_0xa0233b,_0x10e819=await this[_0x5bd3f3(0x17e)](),_0x322f87=new salesforce_retriever_service_1[(_0x5bd3f3(0x187))](this[_0x5bd3f3(0x15f)]),_0x5018a7=await _0x322f87[_0x5bd3f3(0x18b)](_0x10e819);return _0x5018a7;}async[a108_0xa0233b(0x150)](_0x5b9bfd){const _0x33dbc5=a108_0xa0233b,_0x27ed33=new commit_components_dto_1['CommitComponentsDto']();return _0x27ed33[_0x33dbc5(0x142)]=_0x33dbc5(0x188),_0x27ed33[_0x33dbc5(0x15a)]={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1[_0x33dbc5(0x14b)]},_0x27ed33[_0x33dbc5(0x14e)]={'writed':await this['getComponents']()},_0x27ed33[_0x33dbc5(0x17d)]=_0x5b9bfd,_0x27ed33[_0x33dbc5(0x179)]=this[_0x33dbc5(0x14a)],_0x27ed33[_0x33dbc5(0x158)]=this[_0x33dbc5(0x158)],_0x27ed33[_0x33dbc5(0x194)]=!![],_0x27ed33['provider']=this[_0x33dbc5(0x16b)],_0x27ed33[_0x33dbc5(0x154)]=this[_0x33dbc5(0x148)][_0x33dbc5(0x18c)],_0x27ed33;}async[a108_0xa0233b(0x185)](){const _0x421fd1=a108_0xa0233b,_0x16aa80=await this[_0x421fd1(0x19a)][_0x421fd1(0x192)](this['syncData']),_0x1cddc5=await this[_0x421fd1(0x15f)]['retrieveAttachment'](_0x16aa80)['then'](_0x54dd76=>typeof _0x54dd76===_0x421fd1(0x14f)?JSON[_0x421fd1(0x156)](_0x54dd76):_0x54dd76)['catch'](()=>({}));if(_0x1cddc5[this['repository'][_0x421fd1(0x159)]]){if(_0x1cddc5[this['repository'][_0x421fd1(0x159)]][_0x421fd1(0x149)]===this[_0x421fd1(0x158)][_0x421fd1(0x181)])return!![];}return![];}async[a108_0xa0233b(0x175)](){const _0x2e192a=a108_0xa0233b,_0x2c5e4d=await this[_0x2e192a(0x14a)][_0x2e192a(0x15e)][_0x2e192a(0x169)](this['branch'][_0x2e192a(0x144)]);await this[_0x2e192a(0x151)]['log'](this['prefix']+_0x2e192a(0x19b));const _0x142b97={[this[_0x2e192a(0x14a)]['gitUrl']]:{'lastCommit':_0x2c5e4d[_0x2e192a(0x181)]}};await this['salesforceSync']['updateRemoteState'](this[_0x2e192a(0x148)],_0x142b97);}async[a108_0xa0233b(0x18b)]({syncRecord:_0x5dd23e,repository:_0xa77edf,convertToSFDX:_0x259c59,provider:_0x2f5218}){const _0x37f699=a108_0xa0233b;this[_0x37f699(0x148)]=_0x5dd23e,this[_0x37f699(0x16b)]=_0x2f5218,this[_0x37f699(0x14a)]=_0xa77edf,this[_0x37f699(0x151)]=typedi_1[_0x37f699(0x16d)]['get'](salesforce_logger_v3_service_1[_0x37f699(0x195)]),this[_0x37f699(0x164)]=_0x37f699(0x155)+this[_0x37f699(0x148)]['repositoryName']+_0x37f699(0x15d)+this['syncData'][_0x37f699(0x14d)]+']';try{await this[_0x37f699(0x151)][_0x37f699(0x18d)](this[_0x37f699(0x164)]+_0x37f699(0x17b))[_0x37f699(0x168)](),await this[_0x37f699(0x19a)]['setStatus'](this[_0x37f699(0x148)],_0x37f699(0x18f)),this[_0x37f699(0x151)][_0x37f699(0x18d)](this[_0x37f699(0x164)]+_0x37f699(0x162)),await this[_0x37f699(0x172)](),await this[_0x37f699(0x151)][_0x37f699(0x18d)](this['prefix']+'\x20Checking\x20sync\x20status.')[_0x37f699(0x168)]();const _0x4d0391=await this[_0x37f699(0x185)]();this[_0x37f699(0x151)][_0x37f699(0x18d)](this[_0x37f699(0x164)]+_0x37f699(0x152)+_0x4d0391+'.');if(_0x4d0391){await this[_0x37f699(0x19a)]['setStatus'](this[_0x37f699(0x148)],'Completed'),await this[_0x37f699(0x151)][_0x37f699(0x18d)](this['prefix']+_0x37f699(0x173))['send']();return;}const _0x13e58c=await this['getCommitDto'](_0x259c59);await this[_0x37f699(0x15b)][_0x37f699(0x18b)](_0x13e58c,this[_0x37f699(0x164)]),await this[_0x37f699(0x19a)][_0x37f699(0x147)](this[_0x37f699(0x148)],_0x37f699(0x183)),await this[_0x37f699(0x175)](),this[_0x37f699(0x151)][_0x37f699(0x18d)](this[_0x37f699(0x164)]+_0x37f699(0x157));}catch(_0x304bc3){throw _0x304bc3;}finally{await this[_0x37f699(0x151)][_0x37f699(0x168)]();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a108_0xa0233b(0x145)])({'transient':!![]}),__metadata(a108_0xa0233b(0x165),[salesforce_sync_service_1[a108_0xa0233b(0x146)],salesforce_service_1['SalesforceService'],commit_components_job_1['CommitComponentsJob']])],FlosumSyncJob),exports['FlosumSyncJob']=FlosumSyncJob;