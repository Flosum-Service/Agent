const a125_0x493a52=a125_0x4e3d;function a125_0x4e3d(_0x11161e,_0x200a4f){const _0x33a499=a125_0x5c47();return a125_0x4e3d=function(_0x5d89ec,_0x7c7d15){_0x5d89ec=_0x5d89ec-0xc5;let _0x5c4710=_0x33a499[_0x5d89ec];return _0x5c4710;},a125_0x4e3d(_0x11161e,_0x200a4f);}(function(_0x459eef,_0x16167b){const _0x488b2d=a125_0x4e3d,_0x1b5bbd=_0x459eef();while(!![]){try{const _0xdfdadf=parseInt(_0x488b2d(0xd4))/0x1+parseInt(_0x488b2d(0x104))/0x2+parseInt(_0x488b2d(0x101))/0x3+-parseInt(_0x488b2d(0x11a))/0x4*(parseInt(_0x488b2d(0xe8))/0x5)+-parseInt(_0x488b2d(0xdb))/0x6*(parseInt(_0x488b2d(0xee))/0x7)+-parseInt(_0x488b2d(0xc7))/0x8+-parseInt(_0x488b2d(0xd3))/0x9;if(_0xdfdadf===_0x16167b)break;else _0x1b5bbd['push'](_0x1b5bbd['shift']());}catch(_0x534215){_0x1b5bbd['push'](_0x1b5bbd['shift']());}}}(a125_0x5c47,0xc0a7b));const a125_0x7c7d15=(function(){let _0x57703e=!![];return function(_0x43dc7d,_0x36ab06){const _0x4ebcd0=_0x57703e?function(){if(_0x36ab06){const _0x255cd4=_0x36ab06['apply'](_0x43dc7d,arguments);return _0x36ab06=null,_0x255cd4;}}:function(){};return _0x57703e=![],_0x4ebcd0;};}()),a125_0x5d89ec=a125_0x7c7d15(this,function(){const _0x47568d=a125_0x4e3d;return a125_0x5d89ec['toString']()[_0x47568d(0xc6)](_0x47568d(0xc5))[_0x47568d(0xe0)]()[_0x47568d(0x10d)](a125_0x5d89ec)[_0x47568d(0xc6)](_0x47568d(0xc5));});a125_0x5d89ec();'use strict';var __decorate=this&&this[a125_0x493a52(0x115)]||function(_0x5ccf6c,_0x356fb5,_0x2c3e88,_0x42aca6){const _0x21a014=a125_0x493a52;var _0x1f67eb=arguments[_0x21a014(0xf3)],_0x2653bc=_0x1f67eb<0x3?_0x356fb5:_0x42aca6===null?_0x42aca6=Object[_0x21a014(0x103)](_0x356fb5,_0x2c3e88):_0x42aca6,_0x4cf545;if(typeof Reflect===_0x21a014(0x106)&&typeof Reflect[_0x21a014(0xf8)]===_0x21a014(0x111))_0x2653bc=Reflect[_0x21a014(0xf8)](_0x5ccf6c,_0x356fb5,_0x2c3e88,_0x42aca6);else{for(var _0x3178b6=_0x5ccf6c['length']-0x1;_0x3178b6>=0x0;_0x3178b6--)if(_0x4cf545=_0x5ccf6c[_0x3178b6])_0x2653bc=(_0x1f67eb<0x3?_0x4cf545(_0x2653bc):_0x1f67eb>0x3?_0x4cf545(_0x356fb5,_0x2c3e88,_0x2653bc):_0x4cf545(_0x356fb5,_0x2c3e88))||_0x2653bc;}return _0x1f67eb>0x3&&_0x2653bc&&Object['defineProperty'](_0x356fb5,_0x2c3e88,_0x2653bc),_0x2653bc;},__metadata=this&&this[a125_0x493a52(0xfb)]||function(_0x274c72,_0x2ee91b){const _0x5b0581=a125_0x493a52;if(typeof Reflect==='object'&&typeof Reflect[_0x5b0581(0xfd)]===_0x5b0581(0x111))return Reflect['metadata'](_0x274c72,_0x2ee91b);};Object[a125_0x493a52(0xe6)](exports,'__esModule',{'value':!![]}),exports[a125_0x493a52(0x11b)]=void 0x0;function a125_0x5c47(){const _0x437606=['getBranchComponents','\x20Sync\x20status\x20','../../../../constants','typedi','getComponentIds','recordTypeName','6hQLVnI','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20',']\x20[Branch:\x20','branchName','repository','toString','SalesforceSyncService','components','recordType','SalesforceService','repositoryId','defineProperty','Completed','427385truwKR','createBranchIfNotExists','SalesforceRetrieverService','getComponentsFromRepository','salesforceSync','gitUrl','8368507pWyVGH','design:paramtypes','catch','checkSyncStatus','prefix','length','branch','send','\x20Branch\x20synchronized.\x20Skip','SalesforceLogger3','decorate','In\x20Progress','DEFAULT_GIT_USER_NAME','__metadata','syncData','metadata','./commit-components.job','repo','parse','3903666nNzmOn','\x20Checking\x20sync\x20status.','getOwnPropertyDescriptor','2498524epUuxQ','updateRemoteState','object','CommitComponentsDto','getCommitDto','getOne','user','provider','then','constructor','CommitComponentsJob','force','branches','function','setStatus','../../salesforce/services/salesforce.service','\x20Checking\x20repository\x20on\x20Flosum\x20side.','__decorate','create','commitJob','updateLastCommit','sha','28hTzZqv','FlosumSyncJob','../../salesforce/services/salesforce-sync.service','retrieveAttachment','(((.+)+)+)+$','search','7442432MUCcBL','run','convertToSFDX','\x20Start\x20Flosum\x20sync\x20job','Service','get','../../salesforce/services/salesforce-retriever.service','string','sfLogger','salesforceService','log','message','5228451GjTbDo','1543714IPItHu'];a125_0x5c47=function(){return _0x437606;};return a125_0x5c47();}const salesforce_logger_v3_service_1=require('../../salesforce/services/salesforce-logger-v3.service'),typedi_1=require(a125_0x493a52(0xd8)),constants_1=require(a125_0x493a52(0xd7)),salesforce_retriever_service_1=require(a125_0x493a52(0xcd)),salesforce_sync_service_1=require(a125_0x493a52(0x11c)),salesforce_service_1=require(a125_0x493a52(0x113)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a125_0x493a52(0xfe));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x5abbab,_0x5f0220,_0x1faee6){const _0x2c8146=a125_0x493a52;this[_0x2c8146(0xec)]=_0x5abbab,this['salesforceService']=_0x5f0220,this[_0x2c8146(0x117)]=_0x1faee6;}async['createBranchIfNotExists'](){const _0x24b1bf=a125_0x493a52;let _0x490a9f=await this[_0x24b1bf(0xdf)][_0x24b1bf(0x110)]['getOne'](this[_0x24b1bf(0xfc)]['branchName'])[_0x24b1bf(0xf0)](()=>null);!_0x490a9f&&(_0x490a9f=await this[_0x24b1bf(0xdf)][_0x24b1bf(0x110)][_0x24b1bf(0x116)]({'name':this[_0x24b1bf(0xfc)]['branchName']})),this[_0x24b1bf(0xf4)]=_0x490a9f;}async[a125_0x493a52(0xd9)](){const _0x1b6fb2=a125_0x493a52;return this['syncData'][_0x1b6fb2(0xe5)]?this[_0x1b6fb2(0xec)][_0x1b6fb2(0xeb)](this[_0x1b6fb2(0xfc)][_0x1b6fb2(0xe5)]):this['salesforceSync'][_0x1b6fb2(0xd5)](this[_0x1b6fb2(0xfc)]['branchId']);}async['getComponents'](){const _0xbdd05=a125_0x493a52,_0x3e8132=await this[_0xbdd05(0xd9)](),_0x247167=new salesforce_retriever_service_1[(_0xbdd05(0xea))](this[_0xbdd05(0xd0)]),_0x4c1afe=await _0x247167[_0xbdd05(0xc8)](_0x3e8132);return _0x4c1afe;}async[a125_0x493a52(0x108)](_0x388178){const _0x110867=a125_0x493a52,_0x1d0564=new commit_components_dto_1[(_0x110867(0x107))]();return _0x1d0564[_0x110867(0xd2)]='Sync\x20repository',_0x1d0564[_0x110867(0x10a)]={'name':constants_1[_0x110867(0xfa)],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x1d0564[_0x110867(0xe2)]={'writed':await this['getComponents']()},_0x1d0564[_0x110867(0xc9)]=_0x388178,_0x1d0564[_0x110867(0xff)]=this['repository'],_0x1d0564[_0x110867(0xf4)]=this[_0x110867(0xf4)],_0x1d0564[_0x110867(0x10f)]=!![],_0x1d0564[_0x110867(0x10b)]=this[_0x110867(0x10b)],_0x1d0564[_0x110867(0xe3)]=this[_0x110867(0xfc)][_0x110867(0xda)],_0x1d0564;}async[a125_0x493a52(0xf1)](){const _0x2f368e=a125_0x493a52,_0x20af85=await this['salesforceSync']['getRemoteStateAttachmentId'](this['syncData']),_0x14494d=await this['salesforceService'][_0x2f368e(0x11d)](_0x20af85)[_0x2f368e(0x10c)](_0x20674b=>typeof _0x20674b===_0x2f368e(0xce)?JSON[_0x2f368e(0x100)](_0x20674b):_0x20674b)[_0x2f368e(0xf0)](()=>({}));if(_0x14494d[this[_0x2f368e(0xdf)][_0x2f368e(0xed)]]){if(_0x14494d[this[_0x2f368e(0xdf)][_0x2f368e(0xed)]]['lastCommit']===this[_0x2f368e(0xf4)][_0x2f368e(0x119)])return!![];}return![];}async[a125_0x493a52(0x118)](){const _0x4762fd=a125_0x493a52,_0x55df03=await this[_0x4762fd(0xdf)][_0x4762fd(0x110)][_0x4762fd(0x109)](this[_0x4762fd(0xf4)]['name']);await this[_0x4762fd(0xcf)][_0x4762fd(0xd1)](this[_0x4762fd(0xf2)]+'\x20Update\x20remote\x20state.');const _0xec68ac={[this[_0x4762fd(0xdf)][_0x4762fd(0xed)]]:{'lastCommit':_0x55df03[_0x4762fd(0x119)]}};await this['salesforceSync'][_0x4762fd(0x105)](this[_0x4762fd(0xfc)],_0xec68ac);}async[a125_0x493a52(0xc8)]({syncRecord:_0x2733ba,repository:_0x433f58,convertToSFDX:_0x4bf46c,provider:_0x4c13be}){const _0x497078=a125_0x493a52;this[_0x497078(0xfc)]=_0x2733ba,this[_0x497078(0x10b)]=_0x4c13be,this['repository']=_0x433f58,this[_0x497078(0xcf)]=typedi_1['Container'][_0x497078(0xcc)](salesforce_logger_v3_service_1[_0x497078(0xf7)]),this[_0x497078(0xf2)]=_0x497078(0xdc)+this[_0x497078(0xfc)]['repositoryName']+_0x497078(0xdd)+this[_0x497078(0xfc)][_0x497078(0xde)]+']';try{await this['sfLogger'][_0x497078(0xd1)](this['prefix']+_0x497078(0xca))[_0x497078(0xf5)](),await this['salesforceSync'][_0x497078(0x112)](this['syncData'],_0x497078(0xf9)),this[_0x497078(0xcf)][_0x497078(0xd1)](this[_0x497078(0xf2)]+_0x497078(0x114)),await this[_0x497078(0xe9)](),await this[_0x497078(0xcf)]['log'](this[_0x497078(0xf2)]+_0x497078(0x102))[_0x497078(0xf5)]();const _0x1f9270=await this[_0x497078(0xf1)]();this[_0x497078(0xcf)][_0x497078(0xd1)](this[_0x497078(0xf2)]+_0x497078(0xd6)+_0x1f9270+'.');if(_0x1f9270){await this[_0x497078(0xec)]['setStatus'](this[_0x497078(0xfc)],_0x497078(0xe7)),await this[_0x497078(0xcf)]['log'](this[_0x497078(0xf2)]+_0x497078(0xf6))['send']();return;}const _0x3c3af9=await this[_0x497078(0x108)](_0x4bf46c);await this[_0x497078(0x117)]['run'](_0x3c3af9,this[_0x497078(0xf2)]),await this[_0x497078(0xec)]['setStatus'](this['syncData'],_0x497078(0xe7)),await this['updateLastCommit'](),this[_0x497078(0xcf)]['log'](this['prefix']+'\x20Flosum\x20sync\x20job\x20done.');}catch(_0x3bee4e){throw _0x3bee4e;}finally{await this[_0x497078(0xcf)][_0x497078(0xf5)]();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a125_0x493a52(0xcb)])({'transient':!![]}),__metadata(a125_0x493a52(0xef),[salesforce_sync_service_1[a125_0x493a52(0xe1)],salesforce_service_1[a125_0x493a52(0xe4)],commit_components_job_1[a125_0x493a52(0x10e)]])],FlosumSyncJob),exports[a125_0x493a52(0x11b)]=FlosumSyncJob;