const a123_0x2ffcec=a123_0xcc94;function a123_0x58c2(){const _0x282507=['repo','constructor','prefix','salesforceService','24279ILgoxf','CommitComponentsDto','toString','\x20Branch\x20synchronized.\x20Skip','setStatus','repositoryId','444GEhoYt','../../salesforce/services/salesforce-sync.service','defineProperty','commitJob','function','SalesforceService','branchName','__metadata','\x20Sync\x20status\x20','6228150hwmOjE','getOne','metadata','create','In\x20Progress','sfLogger','sha','getRemoteStateAttachmentId','\x20Checking\x20repository\x20on\x20Flosum\x20side.','salesforceSync','branchId','syncData','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','getComponentIds','10YXfMHo','force','SalesforceRetrieverService','repository','recordType','send','branches','convertToSFDX','(((.+)+)+)+$','object','SalesforceSyncService','then','log','updateLastCommit','createBranchIfNotExists','components','../../salesforce/services/salesforce-logger-v3.service','Sync\x20repository','branch','run','11283XhxCcG','lastCommit','121SVCkvR','CommitComponentsJob','6JsHbyA','getComponents','getCommitDto','1341168HElKDO',']\x20[Branch:\x20','22328046RZsEDK','\x20Start\x20Flosum\x20sync\x20job','247240aOGsBj','length','212nIXJRs','../../salesforce/services/salesforce-retriever.service','gitUrl','user','__esModule','\x20Flosum\x20sync\x20job\x20done.','182umWRbp','provider','decorate','getOwnPropertyDescriptor','name','../dto/commit-components.dto','__decorate','search','9715986JVWDqL','catch','string','checkSyncStatus','Container','parse','FlosumSyncJob','updateRemoteState','Service','SalesforceLogger3','message'];a123_0x58c2=function(){return _0x282507;};return a123_0x58c2();}(function(_0x33e181,_0x30ba63){const _0x23ca19=a123_0xcc94,_0x72cf0e=_0x33e181();while(!![]){try{const _0x5995ba=-parseInt(_0x23ca19(0x175))/0x1*(-parseInt(_0x23ca19(0x127))/0x2)+parseInt(_0x23ca19(0x144))/0x3*(parseInt(_0x23ca19(0x14a))/0x4)+parseInt(_0x23ca19(0x153))/0x5*(parseInt(_0x23ca19(0x11e))/0x6)+parseInt(_0x23ca19(0x12d))/0x7*(-parseInt(_0x23ca19(0x125))/0x8)+parseInt(_0x23ca19(0x135))/0x9*(parseInt(_0x23ca19(0x161))/0xa)+-parseInt(_0x23ca19(0x11c))/0xb*(parseInt(_0x23ca19(0x121))/0xc)+-parseInt(_0x23ca19(0x123))/0xd;if(_0x5995ba===_0x30ba63)break;else _0x72cf0e['push'](_0x72cf0e['shift']());}catch(_0x59a8d3){_0x72cf0e['push'](_0x72cf0e['shift']());}}}(a123_0x58c2,0xa3565));const a123_0x44a658=(function(){let _0x5d4b5e=!![];return function(_0x364120,_0x300acf){const _0x3f5a0f=_0x5d4b5e?function(){if(_0x300acf){const _0x2a3864=_0x300acf['apply'](_0x364120,arguments);return _0x300acf=null,_0x2a3864;}}:function(){};return _0x5d4b5e=![],_0x3f5a0f;};}()),a123_0x5ea306=a123_0x44a658(this,function(){const _0x2641fd=a123_0xcc94;return a123_0x5ea306[_0x2641fd(0x146)]()[_0x2641fd(0x134)](_0x2641fd(0x169))['toString']()[_0x2641fd(0x141)](a123_0x5ea306)['search'](_0x2641fd(0x169));});a123_0x5ea306();'use strict';var __decorate=this&&this[a123_0x2ffcec(0x133)]||function(_0x285865,_0x1a16ed,_0x354bbd,_0x5ef61a){const _0x3cea08=a123_0x2ffcec;var _0x4438c1=arguments['length'],_0x483b55=_0x4438c1<0x3?_0x1a16ed:_0x5ef61a===null?_0x5ef61a=Object[_0x3cea08(0x130)](_0x1a16ed,_0x354bbd):_0x5ef61a,_0x10edd2;if(typeof Reflect===_0x3cea08(0x16a)&&typeof Reflect[_0x3cea08(0x12f)]===_0x3cea08(0x14e))_0x483b55=Reflect[_0x3cea08(0x12f)](_0x285865,_0x1a16ed,_0x354bbd,_0x5ef61a);else{for(var _0x3a170c=_0x285865[_0x3cea08(0x126)]-0x1;_0x3a170c>=0x0;_0x3a170c--)if(_0x10edd2=_0x285865[_0x3a170c])_0x483b55=(_0x4438c1<0x3?_0x10edd2(_0x483b55):_0x4438c1>0x3?_0x10edd2(_0x1a16ed,_0x354bbd,_0x483b55):_0x10edd2(_0x1a16ed,_0x354bbd))||_0x483b55;}return _0x4438c1>0x3&&_0x483b55&&Object[_0x3cea08(0x14c)](_0x1a16ed,_0x354bbd,_0x483b55),_0x483b55;},__metadata=this&&this[a123_0x2ffcec(0x151)]||function(_0x4adde8,_0x58655d){const _0x5e7d50=a123_0x2ffcec;if(typeof Reflect==='object'&&typeof Reflect[_0x5e7d50(0x155)]===_0x5e7d50(0x14e))return Reflect[_0x5e7d50(0x155)](_0x4adde8,_0x58655d);};Object[a123_0x2ffcec(0x14c)](exports,a123_0x2ffcec(0x12b),{'value':!![]}),exports[a123_0x2ffcec(0x13b)]=void 0x0;function a123_0xcc94(_0x3d5ca3,_0x34ac09){const _0x3e1696=a123_0x58c2();return a123_0xcc94=function(_0x5ea306,_0x44a658){_0x5ea306=_0x5ea306-0x11c;let _0x58c299=_0x3e1696[_0x5ea306];return _0x58c299;},a123_0xcc94(_0x3d5ca3,_0x34ac09);}const salesforce_logger_v3_service_1=require(a123_0x2ffcec(0x171)),typedi_1=require('typedi'),constants_1=require('../../../../constants'),salesforce_retriever_service_1=require(a123_0x2ffcec(0x128)),salesforce_sync_service_1=require(a123_0x2ffcec(0x14b)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),commit_components_dto_1=require(a123_0x2ffcec(0x132)),commit_components_job_1=require('./commit-components.job');let FlosumSyncJob=class FlosumSyncJob{constructor(_0x548d2d,_0x52cebb,_0x27c329){const _0x422c9d=a123_0x2ffcec;this[_0x422c9d(0x15c)]=_0x548d2d,this[_0x422c9d(0x143)]=_0x52cebb,this[_0x422c9d(0x14d)]=_0x27c329;}async['createBranchIfNotExists'](){const _0x4cfddb=a123_0x2ffcec;let _0x4a5414=await this[_0x4cfddb(0x164)][_0x4cfddb(0x167)][_0x4cfddb(0x154)](this[_0x4cfddb(0x15e)]['branchName'])[_0x4cfddb(0x136)](()=>null);!_0x4a5414&&(_0x4a5414=await this['repository'][_0x4cfddb(0x167)][_0x4cfddb(0x156)]({'name':this[_0x4cfddb(0x15e)][_0x4cfddb(0x150)]})),this['branch']=_0x4a5414;}async[a123_0x2ffcec(0x160)](){const _0x22ed0b=a123_0x2ffcec;return this[_0x22ed0b(0x15e)][_0x22ed0b(0x149)]?this[_0x22ed0b(0x15c)]['getComponentsFromRepository'](this['syncData'][_0x22ed0b(0x149)]):this[_0x22ed0b(0x15c)]['getBranchComponents'](this[_0x22ed0b(0x15e)][_0x22ed0b(0x15d)]);}async[a123_0x2ffcec(0x11f)](){const _0x4b9cb1=a123_0x2ffcec,_0x471047=await this[_0x4b9cb1(0x160)](),_0x4500f9=new salesforce_retriever_service_1[(_0x4b9cb1(0x163))](this[_0x4b9cb1(0x143)]),_0x7f4baf=await _0x4500f9[_0x4b9cb1(0x174)](_0x471047);return _0x7f4baf;}async[a123_0x2ffcec(0x120)](_0x2cca5b){const _0x226165=a123_0x2ffcec,_0x5a6d95=new commit_components_dto_1[(_0x226165(0x145))]();return _0x5a6d95[_0x226165(0x13f)]=_0x226165(0x172),_0x5a6d95[_0x226165(0x12a)]={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x5a6d95[_0x226165(0x170)]={'writed':await this[_0x226165(0x11f)]()},_0x5a6d95[_0x226165(0x168)]=_0x2cca5b,_0x5a6d95[_0x226165(0x140)]=this['repository'],_0x5a6d95[_0x226165(0x173)]=this['branch'],_0x5a6d95[_0x226165(0x162)]=!![],_0x5a6d95[_0x226165(0x12e)]=this['provider'],_0x5a6d95[_0x226165(0x165)]=this['syncData']['recordTypeName'],_0x5a6d95;}async[a123_0x2ffcec(0x138)](){const _0x2859f8=a123_0x2ffcec,_0x12ccf2=await this[_0x2859f8(0x15c)][_0x2859f8(0x15a)](this['syncData']),_0x2ff791=await this['salesforceService']['retrieveAttachment'](_0x12ccf2)[_0x2859f8(0x16c)](_0x32eec5=>typeof _0x32eec5===_0x2859f8(0x137)?JSON[_0x2859f8(0x13a)](_0x32eec5):_0x32eec5)['catch'](()=>({}));if(_0x2ff791[this[_0x2859f8(0x164)][_0x2859f8(0x129)]]){if(_0x2ff791[this[_0x2859f8(0x164)][_0x2859f8(0x129)]][_0x2859f8(0x176)]===this['branch'][_0x2859f8(0x159)])return!![];}return![];}async[a123_0x2ffcec(0x16e)](){const _0x3ab975=a123_0x2ffcec,_0x27a5ff=await this['repository']['branches'][_0x3ab975(0x154)](this[_0x3ab975(0x173)][_0x3ab975(0x131)]);await this['sfLogger'][_0x3ab975(0x16d)](this['prefix']+'\x20Update\x20remote\x20state.');const _0x3feb14={[this[_0x3ab975(0x164)]['gitUrl']]:{'lastCommit':_0x27a5ff[_0x3ab975(0x159)]}};await this[_0x3ab975(0x15c)][_0x3ab975(0x13c)](this[_0x3ab975(0x15e)],_0x3feb14);}async['run']({syncRecord:_0x595eec,repository:_0x4f2d9f,convertToSFDX:_0x427348,provider:_0x34019a}){const _0x1eae26=a123_0x2ffcec;this[_0x1eae26(0x15e)]=_0x595eec,this[_0x1eae26(0x12e)]=_0x34019a,this[_0x1eae26(0x164)]=_0x4f2d9f,this['sfLogger']=typedi_1[_0x1eae26(0x139)]['get'](salesforce_logger_v3_service_1[_0x1eae26(0x13e)]),this['prefix']=_0x1eae26(0x15f)+this['syncData']['repositoryName']+_0x1eae26(0x122)+this['syncData']['branchName']+']';try{await this[_0x1eae26(0x158)][_0x1eae26(0x16d)](this[_0x1eae26(0x142)]+_0x1eae26(0x124))[_0x1eae26(0x166)](),await this[_0x1eae26(0x15c)][_0x1eae26(0x148)](this['syncData'],_0x1eae26(0x157)),this[_0x1eae26(0x158)][_0x1eae26(0x16d)](this[_0x1eae26(0x142)]+_0x1eae26(0x15b)),await this[_0x1eae26(0x16f)](),await this['sfLogger']['log'](this[_0x1eae26(0x142)]+'\x20Checking\x20sync\x20status.')[_0x1eae26(0x166)]();const _0x23911b=await this[_0x1eae26(0x138)]();this[_0x1eae26(0x158)][_0x1eae26(0x16d)](this['prefix']+_0x1eae26(0x152)+_0x23911b+'.');if(_0x23911b){await this[_0x1eae26(0x15c)]['setStatus'](this[_0x1eae26(0x15e)],'Completed'),await this[_0x1eae26(0x158)][_0x1eae26(0x16d)](this['prefix']+_0x1eae26(0x147))[_0x1eae26(0x166)]();return;}const _0x41318e=await this[_0x1eae26(0x120)](_0x427348);await this[_0x1eae26(0x14d)][_0x1eae26(0x174)](_0x41318e,this['prefix']),await this[_0x1eae26(0x15c)][_0x1eae26(0x148)](this[_0x1eae26(0x15e)],'Completed'),await this[_0x1eae26(0x16e)](),this['sfLogger'][_0x1eae26(0x16d)](this[_0x1eae26(0x142)]+_0x1eae26(0x12c));}catch(_0x2bc0df){throw _0x2bc0df;}finally{await this[_0x1eae26(0x158)]['send']();}}};FlosumSyncJob=__decorate([(0x0,typedi_1[a123_0x2ffcec(0x13d)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_sync_service_1[a123_0x2ffcec(0x16b)],salesforce_service_1[a123_0x2ffcec(0x14f)],commit_components_job_1[a123_0x2ffcec(0x11d)]])],FlosumSyncJob),exports['FlosumSyncJob']=FlosumSyncJob;