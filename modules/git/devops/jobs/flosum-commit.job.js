function a125_0xf50e(_0x21d786,_0x26356a){const _0x54ac0f=a125_0x405a();return a125_0xf50e=function(_0x34f97e,_0x2f68ff){_0x34f97e=_0x34f97e-0x1de;let _0x405ad7=_0x54ac0f[_0x34f97e];return _0x405ad7;},a125_0xf50e(_0x21d786,_0x26356a);}function a125_0x405a(){const _0x23dbe6=['./commit-components.job','../dto/commit-components.dto','repositoryName','patchObject','getBranchRecord','run','deleteAttachmentId','Completed','errorNotification','\x20Start\x20Flosum\x20commit\x20job.','typedi','toUpperCase','getCommitDto','5120980iIoiRB','updateLastCommit','error','updateRemoteState','gitProvider','__esModule','getRepositoryRecord','Tokens','../../salesforce/services/salesforce-retriever.service','ERR_UNKNOWN_SYNC_RECORD_ID','toString','331312LWMSHM','length','branch','repo','retrieveAttachment','../../providers/providers.tokens','gitRepoService','function','decorate','all','../../notifications/commit-to-git-error.notification','config','SalesforceSyncService','send',']\x20[Repository:\x20','__importDefault','trim','commitData','parse','salesforceService','(((.+)+)+)+$','recordTypeName','FLOSUM_ATTACHMENT','Email\x20notifications\x20are\x20disabled.','components','default','object','CommitToGitErrorNotification','repoService','getComponentsToWrite','54163iIvrrs','320504TdSbij','9dMdImk','repositoryData','info','branchName','provider','Container','handleCommitJobError','logger','convertToSFDX','shortid','repository','email','setStatus','__metadata','1292403fdgmNX','6wrdxDy',']\x20[','prefix','commitAttachmentId','metadata','completeNotification','fetchRepositoryData','isConvertToSfdx','sfLogger','exec','FlosumCommitJob','get','name','SalesforceService','CommitComponentsJob','salesforceSync','[FLOSUM\x20->\x20GIT]\x20[','then','split','log','gitApiService','search','message','../../salesforce/services/salesforce-sync.service','syncBranchId','5430akcrsc','Error','../../notifications/commit-to-git-completed.notification','user','commitJob','syncRepositoryId','__decorate','getOwnPropertyDescriptor','deleteAttachment','isEmailNotificationsEnabled','ERR_INVALID_SYNC_RECORD_ID','branches','sha','map','gitUrl','getOne','1915090fotxxI','6OLGHtz',']\x20[Branch:\x20'];a125_0x405a=function(){return _0x23dbe6;};return a125_0x405a();}const a125_0x42f7ef=a125_0xf50e;(function(_0x4526d5,_0x2d2d97){const _0x3263d0=a125_0xf50e,_0x10a581=_0x4526d5();while(!![]){try{const _0x4c56e2=parseInt(_0x3263d0(0x227))/0x1+-parseInt(_0x3263d0(0x1de))/0x2+parseInt(_0x3263d0(0x1ef))/0x3*(parseInt(_0x3263d0(0x209))/0x4)+parseInt(_0x3263d0(0x1ee))/0x5*(-parseInt(_0x3263d0(0x238))/0x6)+-parseInt(_0x3263d0(0x237))/0x7+-parseInt(_0x3263d0(0x228))/0x8*(-parseInt(_0x3263d0(0x229))/0x9)+parseInt(_0x3263d0(0x1fe))/0xa;if(_0x4c56e2===_0x2d2d97)break;else _0x10a581['push'](_0x10a581['shift']());}catch(_0x4978de){_0x10a581['push'](_0x10a581['shift']());}}}(a125_0x405a,0x31392));const a125_0x2f68ff=(function(){let _0x48f452=!![];return function(_0x57dda2,_0xf349aa){const _0x5cae4a=_0x48f452?function(){if(_0xf349aa){const _0x57607b=_0xf349aa['apply'](_0x57dda2,arguments);return _0xf349aa=null,_0x57607b;}}:function(){};return _0x48f452=![],_0x5cae4a;};}()),a125_0x34f97e=a125_0x2f68ff(this,function(){const _0x26a287=a125_0xf50e;return a125_0x34f97e[_0x26a287(0x208)]()[_0x26a287(0x24d)](_0x26a287(0x21d))['toString']()['constructor'](a125_0x34f97e)['search'](_0x26a287(0x21d));});a125_0x34f97e();'use strict';var __decorate=this&&this[a125_0x42f7ef(0x1e4)]||function(_0x32a86e,_0x203a62,_0x53a7bd,_0x350911){const _0x7d9bc6=a125_0x42f7ef;var _0x5242ed=arguments[_0x7d9bc6(0x20a)],_0x20e912=_0x5242ed<0x3?_0x203a62:_0x350911===null?_0x350911=Object[_0x7d9bc6(0x1e5)](_0x203a62,_0x53a7bd):_0x350911,_0x1182b4;if(typeof Reflect===_0x7d9bc6(0x223)&&typeof Reflect['decorate']==='function')_0x20e912=Reflect[_0x7d9bc6(0x211)](_0x32a86e,_0x203a62,_0x53a7bd,_0x350911);else{for(var _0x497b1b=_0x32a86e[_0x7d9bc6(0x20a)]-0x1;_0x497b1b>=0x0;_0x497b1b--)if(_0x1182b4=_0x32a86e[_0x497b1b])_0x20e912=(_0x5242ed<0x3?_0x1182b4(_0x20e912):_0x5242ed>0x3?_0x1182b4(_0x203a62,_0x53a7bd,_0x20e912):_0x1182b4(_0x203a62,_0x53a7bd))||_0x20e912;}return _0x5242ed>0x3&&_0x20e912&&Object['defineProperty'](_0x203a62,_0x53a7bd,_0x20e912),_0x20e912;},__metadata=this&&this[a125_0x42f7ef(0x236)]||function(_0x2bc94e,_0x3961c9){const _0x175fd9=a125_0x42f7ef;if(typeof Reflect===_0x175fd9(0x223)&&typeof Reflect[_0x175fd9(0x23c)]===_0x175fd9(0x210))return Reflect[_0x175fd9(0x23c)](_0x2bc94e,_0x3961c9);},__importDefault=this&&this[a125_0x42f7ef(0x218)]||function(_0x46adf0){const _0xb88c80=a125_0x42f7ef;return _0x46adf0&&_0x46adf0[_0xb88c80(0x203)]?_0x46adf0:{'default':_0x46adf0};},FlosumCommitJob_1;Object['defineProperty'](exports,a125_0x42f7ef(0x203),{'value':!![]}),exports[a125_0x42f7ef(0x242)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a125_0x42f7ef(0x1fb)),errors_1=require('../../../../constants/errors'),bad_request_error_1=require('../../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a125_0x42f7ef(0x206)),salesforce_sync_service_1=require(a125_0x42f7ef(0x24f)),commit_components_dto_1=require(a125_0x42f7ef(0x1f2)),commit_components_job_1=require(a125_0x42f7ef(0x1f1)),constants_1=require('../../../../constants'),shortid_1=__importDefault(require(a125_0x42f7ef(0x232))),providers_tokens_1=require(a125_0x42f7ef(0x20e)),commit_to_git_completed_notification_1=require(a125_0x42f7ef(0x1e0)),commit_to_git_error_notification_1=require(a125_0x42f7ef(0x213));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x16457e,_0x57ae4d,_0x4bc7a6){const _0x3a6c7d=a125_0x42f7ef;this[_0x3a6c7d(0x21c)]=_0x16457e,this[_0x3a6c7d(0x1e2)]=_0x57ae4d,this['salesforceSync']=_0x4bc7a6,this[_0x3a6c7d(0x230)]=new core_1['Logger'](FlosumCommitJob_1[_0x3a6c7d(0x244)]);}async[a125_0x42f7ef(0x23d)](_0x5ecb3e,_0x24f654,_0x3d1195,_0x5334ab){const _0xf720d5=a125_0x42f7ef;if(!this['commitData'][_0xf720d5(0x1e7)]){this[_0xf720d5(0x230)][_0xf720d5(0x22b)](_0xf720d5(0x220));return;}await new commit_to_git_completed_notification_1['CommitToGitCompletedNotification']({'emails':_0x5ecb3e,'gitProvider':_0x24f654,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1['CommitToGitCompletedNotification'][_0xf720d5(0x244)],'repositoryName':_0x3d1195,'branchName':_0x5334ab})['execute']();}async['errorNotification'](_0x43ce8e,_0x41823b,_0x46dcb8,_0x48966a){const _0x13407e=a125_0x42f7ef;if(!this['commitData']['isEmailNotificationsEnabled']){this[_0x13407e(0x230)]['info']('Email\x20notifications\x20are\x20disabled.');return;}await new commit_to_git_error_notification_1[(_0x13407e(0x224))]({'emails':_0x43ce8e,'gitProvider':_0x41823b,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0x13407e(0x224)][_0x13407e(0x244)],'repositoryName':_0x46dcb8,'branchName':_0x48966a})['execute']();}async[a125_0x42f7ef(0x23e)](){const _0x2e9f01=a125_0x42f7ef;try{if(this[_0x2e9f01(0x21a)][_0x2e9f01(0x1e3)])this['repositoryData']=await this[_0x2e9f01(0x247)][_0x2e9f01(0x204)](this[_0x2e9f01(0x21a)][_0x2e9f01(0x1e3)]);else this[_0x2e9f01(0x21a)][_0x2e9f01(0x250)]&&(this[_0x2e9f01(0x22a)]=await this['salesforceSync'][_0x2e9f01(0x1f5)](this['commitData']['syncBranchId']));}catch(_0x3a4b13){throw new bad_request_error_1['BadRequestError'](errors_1[_0x2e9f01(0x1e8)]);}}async[a125_0x42f7ef(0x226)](){const _0x5c1161=a125_0x42f7ef;if(!this['commitData'][_0x5c1161(0x23b)])return[];await this['salesforceService'][_0x5c1161(0x1f4)](constants_1[_0x5c1161(0x21f)],this['commitData'][_0x5c1161(0x23b)],{'Name':(0x0,shortid_1['default'])()});const _0x127170=await this['salesforceService'][_0x5c1161(0x20d)](this['commitData'][_0x5c1161(0x23b)])[_0x5c1161(0x249)](_0xb8d7b1=>_0xb8d7b1[_0x5c1161(0x24a)]('\x20')[_0x5c1161(0x1eb)](_0x4d9315=>_0x4d9315[_0x5c1161(0x219)]()));await this['salesforceService'][_0x5c1161(0x1e6)](this[_0x5c1161(0x21a)]['commitAttachmentId']);const _0x5ee1c6=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x5c1161(0x21c)]);return await _0x5ee1c6[_0x5c1161(0x1f6)](_0x127170);}async['getComponentsToDelete'](){const _0x285f52=a125_0x42f7ef;if(!this['commitData'][_0x285f52(0x1f7)])return[];await this[_0x285f52(0x21c)][_0x285f52(0x1f4)](constants_1[_0x285f52(0x21f)],this[_0x285f52(0x21a)]['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0x285f52(0x222)])()});const _0x1f9c93=await this['salesforceService']['retrieveAttachment'](this[_0x285f52(0x21a)][_0x285f52(0x1f7)]),_0x3d9081=JSON[_0x285f52(0x21b)](_0x1f9c93);return await this[_0x285f52(0x21c)][_0x285f52(0x1e6)](this[_0x285f52(0x21a)][_0x285f52(0x1f7)]),_0x3d9081;}async[a125_0x42f7ef(0x1fd)](){const _0x4729b4=a125_0x42f7ef,_0x24991b=new commit_components_dto_1['CommitComponentsDto'](),[_0x56d3dd,_0x55673b]=await Promise[_0x4729b4(0x212)]([this['getComponentsToWrite'](),this['getComponentsToDelete']()]);return _0x24991b[_0x4729b4(0x24e)]=this[_0x4729b4(0x21a)][_0x4729b4(0x24e)],_0x24991b['user']=this[_0x4729b4(0x21a)][_0x4729b4(0x1e1)],_0x24991b[_0x4729b4(0x221)]={'writed':_0x56d3dd,'deleted':_0x55673b},_0x24991b[_0x4729b4(0x231)]=this['config'][_0x4729b4(0x23f)],_0x24991b[_0x4729b4(0x20c)]=this['repository'],_0x24991b[_0x4729b4(0x20b)]=this['branch'],_0x24991b[_0x4729b4(0x22d)]=this['config'][_0x4729b4(0x202)],_0x24991b['recordType']=this[_0x4729b4(0x22a)][_0x4729b4(0x21e)],_0x24991b;}async['updateLastCommit'](_0x1bba6b=![]){const _0x165248=a125_0x42f7ef;if(_0x1bba6b)await this['salesforceSync'][_0x165248(0x201)](this[_0x165248(0x22a)],{});else{const _0x59aaf3=await this[_0x165248(0x233)][_0x165248(0x1e9)]['getOne'](this[_0x165248(0x20b)][_0x165248(0x244)]);this[_0x165248(0x240)][_0x165248(0x24b)](this[_0x165248(0x23a)]+'\x20Update\x20remote\x20state.');const _0x2b5a1f={[this[_0x165248(0x233)][_0x165248(0x1ec)]]:{'lastCommit':_0x59aaf3[_0x165248(0x1ea)]}};await this[_0x165248(0x247)][_0x165248(0x201)](this[_0x165248(0x22a)],_0x2b5a1f);}}async[a125_0x42f7ef(0x241)](){const _0x42fad8=a125_0x42f7ef,_0x12135d=await this[_0x42fad8(0x1fd)]();await this[_0x42fad8(0x247)]['setStatus'](this[_0x42fad8(0x22a)],'In\x20Progress'),await this['commitJob']['run'](_0x12135d,this[_0x42fad8(0x23a)]),await this['updateLastCommit'](),await this['salesforceSync'][_0x42fad8(0x235)](this[_0x42fad8(0x22a)],_0x42fad8(0x1f8));}async[a125_0x42f7ef(0x22f)](_0x47aa02){const _0x2c4022=a125_0x42f7ef;try{this['sfLogger'][_0x2c4022(0x200)](''+_0x47aa02),await this['sfLogger'][_0x2c4022(0x216)](),await this[_0x2c4022(0x1ff)](!![]),await this[_0x2c4022(0x247)][_0x2c4022(0x235)](this[_0x2c4022(0x22a)],_0x2c4022(0x1df)),await this['completeNotification']([this['commitData'][_0x2c4022(0x1e1)][_0x2c4022(0x234)]],this[_0x2c4022(0x214)][_0x2c4022(0x202)],this[_0x2c4022(0x233)][_0x2c4022(0x244)],this[_0x2c4022(0x20b)]['name']);}catch(_0x16ec21){this['logger'][_0x2c4022(0x200)](_0x16ec21),await this[_0x2c4022(0x1f9)]([this[_0x2c4022(0x21a)][_0x2c4022(0x1e1)]['email']],this[_0x2c4022(0x214)]['gitProvider'],this[_0x2c4022(0x233)][_0x2c4022(0x244)],this[_0x2c4022(0x20b)][_0x2c4022(0x244)]);}}async['run'](_0x52416c){const _0x3dfc45=a125_0x42f7ef;try{this[_0x3dfc45(0x21a)]=_0x52416c,this[_0x3dfc45(0x24c)]=typedi_1[_0x3dfc45(0x22e)][_0x3dfc45(0x243)](providers_tokens_1[_0x3dfc45(0x205)][_0x3dfc45(0x24c)]),this[_0x3dfc45(0x225)]=typedi_1[_0x3dfc45(0x22e)]['get'](providers_tokens_1[_0x3dfc45(0x205)][_0x3dfc45(0x20f)]),this[_0x3dfc45(0x214)]=typedi_1['Container'][_0x3dfc45(0x243)](providers_tokens_1[_0x3dfc45(0x205)][_0x3dfc45(0x214)]),await this[_0x3dfc45(0x23e)](),this[_0x3dfc45(0x233)]=await this[_0x3dfc45(0x225)][_0x3dfc45(0x1ed)](this[_0x3dfc45(0x22a)]['repositoryName']),this[_0x3dfc45(0x20b)]=await this[_0x3dfc45(0x233)][_0x3dfc45(0x1e9)][_0x3dfc45(0x1ed)](this[_0x3dfc45(0x22a)]['branchName']),this[_0x3dfc45(0x240)]=typedi_1[_0x3dfc45(0x22e)]['get'](providers_tokens_1['Tokens'][_0x3dfc45(0x230)]),this[_0x3dfc45(0x23a)]=_0x3dfc45(0x248)+this[_0x3dfc45(0x214)][_0x3dfc45(0x202)][_0x3dfc45(0x1fc)]()+_0x3dfc45(0x217)+this[_0x3dfc45(0x22a)][_0x3dfc45(0x1f3)]+_0x3dfc45(0x1f0)+this['repositoryData'][_0x3dfc45(0x22c)]+_0x3dfc45(0x239)+FlosumCommitJob_1[_0x3dfc45(0x244)]+']';if(!this[_0x3dfc45(0x22a)])throw new bad_request_error_1['BadRequestError'](errors_1[_0x3dfc45(0x207)]);await this['sfLogger'][_0x3dfc45(0x24b)](this[_0x3dfc45(0x23a)]+_0x3dfc45(0x1fa))['send'](),await this[_0x3dfc45(0x241)]()['catch'](_0x4fb711=>this[_0x3dfc45(0x22f)](_0x4fb711)),await this[_0x3dfc45(0x23d)]([this[_0x3dfc45(0x21a)]['user'][_0x3dfc45(0x234)]],this[_0x3dfc45(0x214)]['gitProvider'],this['repository'][_0x3dfc45(0x244)],this['branch'][_0x3dfc45(0x244)]);}catch(_0x2e6713){this['commitData']=undefined,this[_0x3dfc45(0x230)]['error'](_0x2e6713),await this[_0x3dfc45(0x1f9)]([this[_0x3dfc45(0x21a)][_0x3dfc45(0x1e1)][_0x3dfc45(0x234)]],this[_0x3dfc45(0x214)][_0x3dfc45(0x202)],this['repository'][_0x3dfc45(0x244)],this['branch'][_0x3dfc45(0x244)]);throw _0x2e6713;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a125_0x42f7ef(0x245)],commit_components_job_1[a125_0x42f7ef(0x246)],salesforce_sync_service_1[a125_0x42f7ef(0x215)]])],FlosumCommitJob),exports[a125_0x42f7ef(0x242)]=FlosumCommitJob;