const a105_0x473834=a105_0x4de9;(function(_0x5d1fa7,_0x102144){const _0x29d7b1=a105_0x4de9,_0xf1d549=_0x5d1fa7();while(!![]){try{const _0x4bfecf=-parseInt(_0x29d7b1(0x17c))/0x1*(parseInt(_0x29d7b1(0x15b))/0x2)+parseInt(_0x29d7b1(0x166))/0x3*(parseInt(_0x29d7b1(0x156))/0x4)+parseInt(_0x29d7b1(0x155))/0x5+-parseInt(_0x29d7b1(0x17a))/0x6+parseInt(_0x29d7b1(0x15d))/0x7+parseInt(_0x29d7b1(0x1ad))/0x8*(-parseInt(_0x29d7b1(0x1a4))/0x9)+-parseInt(_0x29d7b1(0x1a7))/0xa*(parseInt(_0x29d7b1(0x159))/0xb);if(_0x4bfecf===_0x102144)break;else _0xf1d549['push'](_0xf1d549['shift']());}catch(_0x3f9534){_0xf1d549['push'](_0xf1d549['shift']());}}}(a105_0x1c98,0xc1110));function a105_0x4de9(_0x5f2197,_0x5d889d){const _0x23bb0a=a105_0x1c98();return a105_0x4de9=function(_0x321820,_0x540941){_0x321820=_0x321820-0x145;let _0x1c9867=_0x23bb0a[_0x321820];return _0x1c9867;},a105_0x4de9(_0x5f2197,_0x5d889d);}const a105_0x540941=(function(){let _0x328429=!![];return function(_0x1cd7f3,_0x56bfff){const _0x21690c=_0x328429?function(){const _0x467bae=a105_0x4de9;if(_0x56bfff){const _0x22b2db=_0x56bfff[_0x467bae(0x1a2)](_0x1cd7f3,arguments);return _0x56bfff=null,_0x22b2db;}}:function(){};return _0x328429=![],_0x21690c;};}()),a105_0x321820=a105_0x540941(this,function(){const _0x6944fc=a105_0x4de9;return a105_0x321820[_0x6944fc(0x17d)]()[_0x6944fc(0x192)](_0x6944fc(0x145))[_0x6944fc(0x17d)]()[_0x6944fc(0x176)](a105_0x321820)[_0x6944fc(0x192)]('(((.+)+)+)+$');});a105_0x321820();'use strict';var __decorate=this&&this[a105_0x473834(0x181)]||function(_0x1ff2db,_0x5cf413,_0x75fe82,_0x15dcaf){const _0x19587c=a105_0x473834;var _0x4281b3=arguments[_0x19587c(0x196)],_0x19cb9f=_0x4281b3<0x3?_0x5cf413:_0x15dcaf===null?_0x15dcaf=Object[_0x19587c(0x163)](_0x5cf413,_0x75fe82):_0x15dcaf,_0x599024;if(typeof Reflect===_0x19587c(0x14d)&&typeof Reflect[_0x19587c(0x18b)]===_0x19587c(0x194))_0x19cb9f=Reflect[_0x19587c(0x18b)](_0x1ff2db,_0x5cf413,_0x75fe82,_0x15dcaf);else{for(var _0x4900ac=_0x1ff2db[_0x19587c(0x196)]-0x1;_0x4900ac>=0x0;_0x4900ac--)if(_0x599024=_0x1ff2db[_0x4900ac])_0x19cb9f=(_0x4281b3<0x3?_0x599024(_0x19cb9f):_0x4281b3>0x3?_0x599024(_0x5cf413,_0x75fe82,_0x19cb9f):_0x599024(_0x5cf413,_0x75fe82))||_0x19cb9f;}return _0x4281b3>0x3&&_0x19cb9f&&Object['defineProperty'](_0x5cf413,_0x75fe82,_0x19cb9f),_0x19cb9f;},__metadata=this&&this[a105_0x473834(0x14e)]||function(_0x5bf09d,_0x5999c0){const _0x2bee7f=a105_0x473834;if(typeof Reflect===_0x2bee7f(0x14d)&&typeof Reflect[_0x2bee7f(0x165)]==='function')return Reflect[_0x2bee7f(0x165)](_0x5bf09d,_0x5999c0);},__importDefault=this&&this[a105_0x473834(0x161)]||function(_0x5181da){const _0x304122=a105_0x473834;return _0x5181da&&_0x5181da[_0x304122(0x190)]?_0x5181da:{'default':_0x5181da};},FlosumCommitJob_1;Object['defineProperty'](exports,a105_0x473834(0x190),{'value':!![]}),exports[a105_0x473834(0x18e)]=void 0x0;function a105_0x1c98(){const _0x551c58=[']\x20[','split','15944PFrfIl','[FLOSUM\x20->\x20GIT]\x20[','../../../../constants/errors','(((.+)+)+)+$','repository',']\x20[Repository:\x20','../dto/commit-components.dto','repositoryName','exec','gitRepoService','getCommitDto','object','__metadata','Logger','map','CommitComponentsJob','../../salesforce/services/salesforce.service','toUpperCase','updateLastCommit','649370ZBnKiS','3682752wreHkj','salesforceSync','salesforceService','562518gpYFbO','../../salesforce/services/salesforce-retriever.service','1138NkUeZl','log','9869398SFDVag','repo','branchName','commitAttachmentId','__importDefault','syncBranchId','getOwnPropertyDescriptor','deleteAttachmentId','metadata','3WLXHlr','branch','error','ERR_INVALID_SYNC_RECORD_ID','../../salesforce/services/salesforce-sync.service','catch','../../../../constants','handleCommitJobError','getBranchRecord','gitApiService','deleteAttachment','\x20Update\x20remote\x20state.','repoService','Tokens','convertToSFDX','commitJob','constructor','config','fetchRepositoryData','commitData','4589040wiIfkW','setStatus','6xtNtXT','toString','default','gitProvider','./commit-components.job','__decorate','send','gitUrl','getOne','syncRepositoryId','getComponentsToDelete','logger','Service','branches','updateRemoteState','decorate','repositoryData',']\x20[Branch:\x20','FlosumCommitJob','get','__esModule','then','search','BadRequestError','function','components','length','getComponentsToWrite','Container','message','user','FLOSUM_ATTACHMENT','../../../../core','SalesforceSyncService','../../providers/providers.tokens','ERR_UNKNOWN_SYNC_RECORD_ID','all','design:paramtypes','apply','prefix','2916OklOAL','name','sfLogger','50usppsu','retrieveAttachment','Error','patchObject'];a105_0x1c98=function(){return _0x551c58;};return a105_0x1c98();}const core_1=require(a105_0x473834(0x19c)),salesforce_service_1=require(a105_0x473834(0x152)),typedi_1=require('typedi'),errors_1=require(a105_0x473834(0x1af)),bad_request_error_1=require('../../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a105_0x473834(0x15a)),salesforce_sync_service_1=require(a105_0x473834(0x16a)),commit_components_dto_1=require(a105_0x473834(0x148)),commit_components_job_1=require(a105_0x473834(0x180)),constants_1=require(a105_0x473834(0x16c)),shortid_1=__importDefault(require('shortid')),providers_tokens_1=require(a105_0x473834(0x19e));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x5b9288,_0x4b27b0,_0x3db18e){const _0x3b4c2f=a105_0x473834;this[_0x3b4c2f(0x158)]=_0x5b9288,this[_0x3b4c2f(0x175)]=_0x4b27b0,this['salesforceSync']=_0x3db18e,this[_0x3b4c2f(0x187)]=new core_1[(_0x3b4c2f(0x14f))](FlosumCommitJob_1[_0x3b4c2f(0x1a5)]);}async[a105_0x473834(0x178)](){const _0x2445e0=a105_0x473834;try{if(this[_0x2445e0(0x179)]['syncRepositoryId'])this['repositoryData']=await this[_0x2445e0(0x157)]['getRepositoryRecord'](this[_0x2445e0(0x179)][_0x2445e0(0x185)]);else this[_0x2445e0(0x179)][_0x2445e0(0x162)]&&(this[_0x2445e0(0x18c)]=await this['salesforceSync'][_0x2445e0(0x16e)](this[_0x2445e0(0x179)][_0x2445e0(0x162)]));}catch(_0x3f91df){throw new bad_request_error_1['BadRequestError'](errors_1[_0x2445e0(0x169)]);}}async[a105_0x473834(0x197)](){const _0x46cd77=a105_0x473834;if(!this['commitData'][_0x46cd77(0x160)])return[];await this[_0x46cd77(0x158)][_0x46cd77(0x1aa)](constants_1['FLOSUM_ATTACHMENT'],this['commitData'][_0x46cd77(0x160)],{'Name':(0x0,shortid_1[_0x46cd77(0x17e)])()});const _0x5148a2=await this[_0x46cd77(0x158)]['retrieveAttachment'](this[_0x46cd77(0x179)][_0x46cd77(0x160)])[_0x46cd77(0x191)](_0x5a460c=>_0x5a460c[_0x46cd77(0x1ac)]('\x20')[_0x46cd77(0x150)](_0x4e879f=>_0x4e879f['trim']()));await this[_0x46cd77(0x158)][_0x46cd77(0x170)](this[_0x46cd77(0x179)][_0x46cd77(0x160)]);const _0x3da554=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x46cd77(0x158)]);return await _0x3da554['run'](_0x5148a2);}async[a105_0x473834(0x186)](){const _0xa3c351=a105_0x473834;if(!this[_0xa3c351(0x179)][_0xa3c351(0x164)])return[];await this[_0xa3c351(0x158)][_0xa3c351(0x1aa)](constants_1[_0xa3c351(0x19b)],this['commitData']['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0xa3c351(0x17e)])()});const _0x2858a1=await this[_0xa3c351(0x158)][_0xa3c351(0x1a8)](this[_0xa3c351(0x179)][_0xa3c351(0x164)]);return await this[_0xa3c351(0x158)]['deleteAttachment'](this[_0xa3c351(0x179)][_0xa3c351(0x164)]),_0x2858a1;}async[a105_0x473834(0x14c)](){const _0x21affb=a105_0x473834,_0x1a4ce2=new commit_components_dto_1['CommitComponentsDto'](),[_0x3b89a3,_0x506b98]=await Promise[_0x21affb(0x1a0)]([this[_0x21affb(0x197)](),this[_0x21affb(0x186)]()]);return _0x1a4ce2['message']=this[_0x21affb(0x179)][_0x21affb(0x199)],_0x1a4ce2[_0x21affb(0x19a)]=this[_0x21affb(0x179)][_0x21affb(0x19a)],_0x1a4ce2[_0x21affb(0x195)]={'writed':_0x3b89a3,'deleted':_0x506b98},_0x1a4ce2[_0x21affb(0x174)]=this['config']['isConvertToSfdx'],_0x1a4ce2[_0x21affb(0x15e)]=this[_0x21affb(0x146)],_0x1a4ce2['branch']=this[_0x21affb(0x167)],_0x1a4ce2['provider']=this[_0x21affb(0x177)][_0x21affb(0x17f)],_0x1a4ce2;}async[a105_0x473834(0x154)](_0x27ec05=![]){const _0x3dcf41=a105_0x473834;if(_0x27ec05)await this[_0x3dcf41(0x157)][_0x3dcf41(0x18a)](this[_0x3dcf41(0x18c)],{});else{const _0x254d28=await this[_0x3dcf41(0x146)][_0x3dcf41(0x189)][_0x3dcf41(0x184)](this[_0x3dcf41(0x167)]['name']);this[_0x3dcf41(0x1a6)][_0x3dcf41(0x15c)](this[_0x3dcf41(0x1a3)]+_0x3dcf41(0x171));const _0x189fdc={[this[_0x3dcf41(0x146)][_0x3dcf41(0x183)]]:{'lastCommit':_0x254d28['sha']}};await this[_0x3dcf41(0x157)][_0x3dcf41(0x18a)](this[_0x3dcf41(0x18c)],_0x189fdc);}}async[a105_0x473834(0x14a)](){const _0x3d3940=a105_0x473834,_0x69ec0=await this['getCommitDto']();await this['salesforceSync'][_0x3d3940(0x17b)](this[_0x3d3940(0x18c)],'In\x20Progress'),await this['commitJob']['run'](_0x69ec0,this[_0x3d3940(0x1a3)]),await this['updateLastCommit'](),await this['salesforceSync'][_0x3d3940(0x17b)](this[_0x3d3940(0x18c)],'Completed');}async[a105_0x473834(0x16d)](_0x15dd0a){const _0x311cc7=a105_0x473834;try{this[_0x311cc7(0x1a6)][_0x311cc7(0x168)](''+_0x15dd0a),await this[_0x311cc7(0x1a6)]['send'](),await this[_0x311cc7(0x154)](!![]),await this[_0x311cc7(0x157)][_0x311cc7(0x17b)](this[_0x311cc7(0x18c)],_0x311cc7(0x1a9));}catch(_0xd11f9d){this['logger'][_0x311cc7(0x168)](_0xd11f9d);}}async['run'](_0x2bb491){const _0x33d35c=a105_0x473834;try{this[_0x33d35c(0x179)]=_0x2bb491,this[_0x33d35c(0x16f)]=typedi_1['Container']['get'](providers_tokens_1['Tokens'][_0x33d35c(0x16f)]),this[_0x33d35c(0x172)]=typedi_1[_0x33d35c(0x198)][_0x33d35c(0x18f)](providers_tokens_1[_0x33d35c(0x173)][_0x33d35c(0x14b)]),this[_0x33d35c(0x177)]=typedi_1[_0x33d35c(0x198)][_0x33d35c(0x18f)](providers_tokens_1[_0x33d35c(0x173)]['config']),await this['fetchRepositoryData'](),this[_0x33d35c(0x146)]=await this[_0x33d35c(0x172)]['getOne'](this[_0x33d35c(0x18c)][_0x33d35c(0x149)]),this[_0x33d35c(0x167)]=await this['repository']['branches'][_0x33d35c(0x184)](this[_0x33d35c(0x18c)][_0x33d35c(0x15f)]),this[_0x33d35c(0x1a6)]=typedi_1['Container']['get'](providers_tokens_1['Tokens'][_0x33d35c(0x187)]),this[_0x33d35c(0x1a3)]=_0x33d35c(0x1ae)+this[_0x33d35c(0x177)][_0x33d35c(0x17f)][_0x33d35c(0x153)]()+_0x33d35c(0x147)+this[_0x33d35c(0x18c)][_0x33d35c(0x149)]+_0x33d35c(0x18d)+this['repositoryData'][_0x33d35c(0x15f)]+_0x33d35c(0x1ab)+FlosumCommitJob_1[_0x33d35c(0x1a5)]+']';if(!this[_0x33d35c(0x18c)])throw new bad_request_error_1[(_0x33d35c(0x193))](errors_1[_0x33d35c(0x19f)]);await this[_0x33d35c(0x1a6)][_0x33d35c(0x15c)](this[_0x33d35c(0x1a3)]+'\x20Start\x20Flosum\x20commit\x20job.')[_0x33d35c(0x182)](),await this[_0x33d35c(0x14a)]()[_0x33d35c(0x16b)](_0x106a84=>this[_0x33d35c(0x16d)](_0x106a84));}catch(_0x46a6ae){this[_0x33d35c(0x179)]=undefined,this['logger']['error'](_0x46a6ae);throw _0x46a6ae;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a105_0x473834(0x188)])({'transient':!![]}),__metadata(a105_0x473834(0x1a1),[salesforce_service_1['SalesforceService'],commit_components_job_1[a105_0x473834(0x151)],salesforce_sync_service_1[a105_0x473834(0x19d)]])],FlosumCommitJob),exports[a105_0x473834(0x18e)]=FlosumCommitJob;