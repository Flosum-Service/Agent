function a122_0x3ce5(_0x4000d0,_0x29c31e){const _0x37f10d=a122_0x5477();return a122_0x3ce5=function(_0x35d8d7,_0x18dc68){_0x35d8d7=_0x35d8d7-0x153;let _0x5477f1=_0x37f10d[_0x35d8d7];return _0x5477f1;},a122_0x3ce5(_0x4000d0,_0x29c31e);}const a122_0x53923f=a122_0x3ce5;(function(_0x253259,_0x19ff12){const _0x1abd1a=a122_0x3ce5,_0x538912=_0x253259();while(!![]){try{const _0x20097e=parseInt(_0x1abd1a(0x157))/0x1*(-parseInt(_0x1abd1a(0x1b1))/0x2)+parseInt(_0x1abd1a(0x173))/0x3*(-parseInt(_0x1abd1a(0x16e))/0x4)+-parseInt(_0x1abd1a(0x16c))/0x5+parseInt(_0x1abd1a(0x158))/0x6+-parseInt(_0x1abd1a(0x19b))/0x7+parseInt(_0x1abd1a(0x1a8))/0x8+parseInt(_0x1abd1a(0x15e))/0x9;if(_0x20097e===_0x19ff12)break;else _0x538912['push'](_0x538912['shift']());}catch(_0x11f58e){_0x538912['push'](_0x538912['shift']());}}}(a122_0x5477,0x2a6d1));const a122_0x18dc68=(function(){let _0xac63c=!![];return function(_0x563293,_0x588cf3){const _0x46dfbf=_0xac63c?function(){if(_0x588cf3){const _0x257ec7=_0x588cf3['apply'](_0x563293,arguments);return _0x588cf3=null,_0x257ec7;}}:function(){};return _0xac63c=![],_0x46dfbf;};}()),a122_0x35d8d7=a122_0x18dc68(this,function(){const _0x9ef64c=a122_0x3ce5;return a122_0x35d8d7[_0x9ef64c(0x199)]()[_0x9ef64c(0x191)](_0x9ef64c(0x1af))[_0x9ef64c(0x199)]()['constructor'](a122_0x35d8d7)[_0x9ef64c(0x191)](_0x9ef64c(0x1af));});a122_0x35d8d7();'use strict';var __decorate=this&&this[a122_0x53923f(0x156)]||function(_0x18d4ca,_0x1da803,_0xdb7cfa,_0x26423e){const _0x31a71f=a122_0x53923f;var _0x12fdeb=arguments[_0x31a71f(0x165)],_0x346836=_0x12fdeb<0x3?_0x1da803:_0x26423e===null?_0x26423e=Object[_0x31a71f(0x18e)](_0x1da803,_0xdb7cfa):_0x26423e,_0x5081c3;if(typeof Reflect==='object'&&typeof Reflect[_0x31a71f(0x178)]==='function')_0x346836=Reflect[_0x31a71f(0x178)](_0x18d4ca,_0x1da803,_0xdb7cfa,_0x26423e);else{for(var _0xe66004=_0x18d4ca[_0x31a71f(0x165)]-0x1;_0xe66004>=0x0;_0xe66004--)if(_0x5081c3=_0x18d4ca[_0xe66004])_0x346836=(_0x12fdeb<0x3?_0x5081c3(_0x346836):_0x12fdeb>0x3?_0x5081c3(_0x1da803,_0xdb7cfa,_0x346836):_0x5081c3(_0x1da803,_0xdb7cfa))||_0x346836;}return _0x12fdeb>0x3&&_0x346836&&Object['defineProperty'](_0x1da803,_0xdb7cfa,_0x346836),_0x346836;},__metadata=this&&this[a122_0x53923f(0x1b8)]||function(_0x4cb9fb,_0x200c41){const _0x27d938=a122_0x53923f;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x27d938(0x193))return Reflect[_0x27d938(0x183)](_0x4cb9fb,_0x200c41);},__importDefault=this&&this[a122_0x53923f(0x177)]||function(_0x3e8a5a){const _0x1c91a5=a122_0x53923f;return _0x3e8a5a&&_0x3e8a5a[_0x1c91a5(0x179)]?_0x3e8a5a:{'default':_0x3e8a5a};},FlosumCommitJob_1;Object['defineProperty'](exports,a122_0x53923f(0x179),{'value':!![]}),exports[a122_0x53923f(0x154)]=void 0x0;function a122_0x5477(){const _0x31b905=['repository','name','branch','toString','setStatus','1793659LfLHbm','\x20Update\x20remote\x20state.',']\x20[','gitProvider','../../../../constants/errors','send','deleteAttachmentId','design:paramtypes','getBranchRecord','salesforceSync','repoService','commitJob','../../salesforce/services/salesforce-retriever.service','1019064KbtOag','user',']\x20[Branch:\x20','syncBranchId','parse','syncRepositoryId','sha','(((.+)+)+)+$','Completed','16TLGqMq','sfLogger','branches','salesforceService','Service','run','FLOSUM_ATTACHMENT','__metadata','toUpperCase','FlosumCommitJob','getComponentsToWrite','__decorate','7434VzpaVb','1855836HudVPb','Error','repositoryName','ERR_INVALID_SYNC_RECORD_ID','\x20Start\x20Flosum\x20commit\x20job.','commitData','3433185qtUAug','get','deleteAttachment','map','../dto/commit-components.dto','gitUrl','log','length','repositoryData','patchObject','getOne','then','updateRemoteState','CommitComponentsDto','239860KguhNU','recordTypeName','52gwaqCz','split','Tokens','typedi','Logger','64776rtmmEi','../../salesforce/services/salesforce-sync.service','prefix','branchName','__importDefault','decorate','__esModule','updateLastCommit','recordType','config','SalesforceService','retrieveAttachment','Container','default','getRepositoryRecord','exec','metadata','BadRequestError','gitApiService','SalesforceRetrieverService','../../../../core',']\x20[Repository:\x20','handleCommitJobError','../../providers/providers.tokens','ERR_UNKNOWN_SYNC_RECORD_ID','convertToSFDX','fetchRepositoryData','getOwnPropertyDescriptor','commitAttachmentId','components','search','logger','function','getCommitDto','error'];a122_0x5477=function(){return _0x31b905;};return a122_0x5477();}const core_1=require(a122_0x53923f(0x187)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a122_0x53923f(0x171)),errors_1=require(a122_0x53923f(0x19f)),bad_request_error_1=require('../../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a122_0x53923f(0x1a7)),salesforce_sync_service_1=require(a122_0x53923f(0x174)),commit_components_dto_1=require(a122_0x53923f(0x162)),commit_components_job_1=require('./commit-components.job'),constants_1=require('../../../../constants'),shortid_1=__importDefault(require('shortid')),providers_tokens_1=require(a122_0x53923f(0x18a));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x19c1fa,_0x228e25,_0x47f042){const _0x2ae608=a122_0x53923f;this['salesforceService']=_0x19c1fa,this[_0x2ae608(0x1a6)]=_0x228e25,this[_0x2ae608(0x1a4)]=_0x47f042,this[_0x2ae608(0x192)]=new core_1[(_0x2ae608(0x172))](FlosumCommitJob_1[_0x2ae608(0x197)]);}async[a122_0x53923f(0x18d)](){const _0x5648fb=a122_0x53923f;try{if(this[_0x5648fb(0x15d)][_0x5648fb(0x1ad)])this['repositoryData']=await this[_0x5648fb(0x1a4)][_0x5648fb(0x181)](this[_0x5648fb(0x15d)][_0x5648fb(0x1ad)]);else this[_0x5648fb(0x15d)][_0x5648fb(0x1ab)]&&(this[_0x5648fb(0x166)]=await this[_0x5648fb(0x1a4)][_0x5648fb(0x1a3)](this['commitData'][_0x5648fb(0x1ab)]));}catch(_0x1ea3c1){throw new bad_request_error_1[(_0x5648fb(0x184))](errors_1[_0x5648fb(0x15b)]);}}async['getComponentsToWrite'](){const _0x1f1ab6=a122_0x53923f;if(!this[_0x1f1ab6(0x15d)][_0x1f1ab6(0x18f)])return[];await this[_0x1f1ab6(0x1b4)][_0x1f1ab6(0x167)](constants_1[_0x1f1ab6(0x1b7)],this[_0x1f1ab6(0x15d)]['commitAttachmentId'],{'Name':(0x0,shortid_1[_0x1f1ab6(0x180)])()});const _0x3bf12c=await this[_0x1f1ab6(0x1b4)]['retrieveAttachment'](this[_0x1f1ab6(0x15d)][_0x1f1ab6(0x18f)])[_0x1f1ab6(0x169)](_0x5739d9=>_0x5739d9[_0x1f1ab6(0x16f)]('\x20')[_0x1f1ab6(0x161)](_0x12693f=>_0x12693f['trim']()));await this[_0x1f1ab6(0x1b4)][_0x1f1ab6(0x160)](this['commitData'][_0x1f1ab6(0x18f)]);const _0x3b3cbd=new salesforce_retriever_service_1[(_0x1f1ab6(0x186))](this[_0x1f1ab6(0x1b4)]);return await _0x3b3cbd[_0x1f1ab6(0x1b6)](_0x3bf12c);}async['getComponentsToDelete'](){const _0x1012e3=a122_0x53923f;if(!this[_0x1012e3(0x15d)][_0x1012e3(0x1a1)])return[];await this[_0x1012e3(0x1b4)]['patchObject'](constants_1['FLOSUM_ATTACHMENT'],this['commitData']['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0x1012e3(0x180)])()});const _0x48a1cb=await this[_0x1012e3(0x1b4)][_0x1012e3(0x17e)](this[_0x1012e3(0x15d)][_0x1012e3(0x1a1)]),_0x3e53a0=JSON[_0x1012e3(0x1ac)](_0x48a1cb);return await this[_0x1012e3(0x1b4)][_0x1012e3(0x160)](this[_0x1012e3(0x15d)][_0x1012e3(0x1a1)]),_0x3e53a0;}async['getCommitDto'](){const _0x19c9a6=a122_0x53923f,_0x3c655e=new commit_components_dto_1[(_0x19c9a6(0x16b))](),[_0x455667,_0x52b3a3]=await Promise['all']([this[_0x19c9a6(0x155)](),this['getComponentsToDelete']()]);return _0x3c655e['message']=this[_0x19c9a6(0x15d)]['message'],_0x3c655e['user']=this[_0x19c9a6(0x15d)][_0x19c9a6(0x1a9)],_0x3c655e[_0x19c9a6(0x190)]={'writed':_0x455667,'deleted':_0x52b3a3},_0x3c655e[_0x19c9a6(0x18c)]=this[_0x19c9a6(0x17c)]['isConvertToSfdx'],_0x3c655e['repo']=this[_0x19c9a6(0x196)],_0x3c655e[_0x19c9a6(0x198)]=this[_0x19c9a6(0x198)],_0x3c655e['provider']=this[_0x19c9a6(0x17c)][_0x19c9a6(0x19e)],_0x3c655e[_0x19c9a6(0x17b)]=this[_0x19c9a6(0x166)][_0x19c9a6(0x16d)],_0x3c655e;}async[a122_0x53923f(0x17a)](_0x14b541=![]){const _0x35db32=a122_0x53923f;if(_0x14b541)await this['salesforceSync']['updateRemoteState'](this[_0x35db32(0x166)],{});else{const _0x4030c8=await this[_0x35db32(0x196)]['branches'][_0x35db32(0x168)](this[_0x35db32(0x198)][_0x35db32(0x197)]);this[_0x35db32(0x1b2)][_0x35db32(0x164)](this[_0x35db32(0x175)]+_0x35db32(0x19c));const _0x466538={[this[_0x35db32(0x196)][_0x35db32(0x163)]]:{'lastCommit':_0x4030c8[_0x35db32(0x1ae)]}};await this[_0x35db32(0x1a4)][_0x35db32(0x16a)](this[_0x35db32(0x166)],_0x466538);}}async[a122_0x53923f(0x182)](){const _0x17863c=a122_0x53923f,_0x450bba=await this[_0x17863c(0x194)]();await this[_0x17863c(0x1a4)][_0x17863c(0x19a)](this[_0x17863c(0x166)],'In\x20Progress'),await this['commitJob'][_0x17863c(0x1b6)](_0x450bba,this[_0x17863c(0x175)]),await this[_0x17863c(0x17a)](),await this['salesforceSync'][_0x17863c(0x19a)](this['repositoryData'],_0x17863c(0x1b0));}async['handleCommitJobError'](_0x4346d3){const _0x41179c=a122_0x53923f;try{this[_0x41179c(0x1b2)]['error'](''+_0x4346d3),await this[_0x41179c(0x1b2)][_0x41179c(0x1a0)](),await this['updateLastCommit'](!![]),await this[_0x41179c(0x1a4)][_0x41179c(0x19a)](this[_0x41179c(0x166)],_0x41179c(0x159));}catch(_0xaa64b3){this[_0x41179c(0x192)][_0x41179c(0x195)](_0xaa64b3);}}async[a122_0x53923f(0x1b6)](_0x53d8dd){const _0x57b0d3=a122_0x53923f;try{this[_0x57b0d3(0x15d)]=_0x53d8dd,this['gitApiService']=typedi_1['Container'][_0x57b0d3(0x15f)](providers_tokens_1[_0x57b0d3(0x170)][_0x57b0d3(0x185)]),this['repoService']=typedi_1[_0x57b0d3(0x17f)][_0x57b0d3(0x15f)](providers_tokens_1[_0x57b0d3(0x170)]['gitRepoService']),this['config']=typedi_1['Container'][_0x57b0d3(0x15f)](providers_tokens_1[_0x57b0d3(0x170)][_0x57b0d3(0x17c)]),await this[_0x57b0d3(0x18d)](),this[_0x57b0d3(0x196)]=await this[_0x57b0d3(0x1a5)]['getOne'](this[_0x57b0d3(0x166)][_0x57b0d3(0x15a)]),this[_0x57b0d3(0x198)]=await this[_0x57b0d3(0x196)][_0x57b0d3(0x1b3)]['getOne'](this[_0x57b0d3(0x166)][_0x57b0d3(0x176)]),this[_0x57b0d3(0x1b2)]=typedi_1[_0x57b0d3(0x17f)][_0x57b0d3(0x15f)](providers_tokens_1[_0x57b0d3(0x170)]['logger']),this[_0x57b0d3(0x175)]='[FLOSUM\x20->\x20GIT]\x20['+this[_0x57b0d3(0x17c)][_0x57b0d3(0x19e)][_0x57b0d3(0x153)]()+_0x57b0d3(0x188)+this[_0x57b0d3(0x166)][_0x57b0d3(0x15a)]+_0x57b0d3(0x1aa)+this[_0x57b0d3(0x166)][_0x57b0d3(0x176)]+_0x57b0d3(0x19d)+FlosumCommitJob_1[_0x57b0d3(0x197)]+']';if(!this[_0x57b0d3(0x166)])throw new bad_request_error_1[(_0x57b0d3(0x184))](errors_1[_0x57b0d3(0x18b)]);await this[_0x57b0d3(0x1b2)][_0x57b0d3(0x164)](this[_0x57b0d3(0x175)]+_0x57b0d3(0x15c))[_0x57b0d3(0x1a0)](),await this[_0x57b0d3(0x182)]()['catch'](_0x565ccd=>this[_0x57b0d3(0x189)](_0x565ccd));}catch(_0x82a83b){this['commitData']=undefined,this[_0x57b0d3(0x192)][_0x57b0d3(0x195)](_0x82a83b);throw _0x82a83b;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a122_0x53923f(0x1b5)])({'transient':!![]}),__metadata(a122_0x53923f(0x1a2),[salesforce_service_1[a122_0x53923f(0x17d)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1['SalesforceSyncService']])],FlosumCommitJob),exports[a122_0x53923f(0x154)]=FlosumCommitJob;