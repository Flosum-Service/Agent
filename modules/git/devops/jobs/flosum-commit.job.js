const a125_0x40879a=a125_0x37ca;(function(_0x353cb5,_0x1fd677){const _0x290fb4=a125_0x37ca,_0xfa5baa=_0x353cb5();while(!![]){try{const _0x267703=-parseInt(_0x290fb4(0x20d))/0x1*(-parseInt(_0x290fb4(0x1f8))/0x2)+-parseInt(_0x290fb4(0x1af))/0x3*(-parseInt(_0x290fb4(0x1d3))/0x4)+parseInt(_0x290fb4(0x1b1))/0x5+parseInt(_0x290fb4(0x1fd))/0x6*(-parseInt(_0x290fb4(0x1c3))/0x7)+-parseInt(_0x290fb4(0x1a2))/0x8+-parseInt(_0x290fb4(0x203))/0x9*(parseInt(_0x290fb4(0x1ca))/0xa)+parseInt(_0x290fb4(0x1f6))/0xb;if(_0x267703===_0x1fd677)break;else _0xfa5baa['push'](_0xfa5baa['shift']());}catch(_0x1f1724){_0xfa5baa['push'](_0xfa5baa['shift']());}}}(a125_0x3096,0x900e6));const a125_0x2b8a11=(function(){let _0x556803=!![];return function(_0x421eb5,_0xb04c38){const _0x22396f=_0x556803?function(){const _0x19e049=a125_0x37ca;if(_0xb04c38){const _0x2dc9c6=_0xb04c38[_0x19e049(0x202)](_0x421eb5,arguments);return _0xb04c38=null,_0x2dc9c6;}}:function(){};return _0x556803=![],_0x22396f;};}()),a125_0x4bdd96=a125_0x2b8a11(this,function(){const _0x13f88f=a125_0x37ca;return a125_0x4bdd96[_0x13f88f(0x1b7)]()[_0x13f88f(0x1f7)]('(((.+)+)+)+$')[_0x13f88f(0x1b7)]()['constructor'](a125_0x4bdd96)['search'](_0x13f88f(0x1e5));});a125_0x4bdd96();'use strict';function a125_0x37ca(_0x966870,_0x9ed75c){const _0x4ae26b=a125_0x3096();return a125_0x37ca=function(_0x4bdd96,_0x2b8a11){_0x4bdd96=_0x4bdd96-0x1a1;let _0x3096d6=_0x4ae26b[_0x4bdd96];return _0x3096d6;},a125_0x37ca(_0x966870,_0x9ed75c);}var __decorate=this&&this['__decorate']||function(_0x1a9885,_0x287e7e,_0x1ccebb,_0x563254){const _0x3aa994=a125_0x37ca;var _0x28ed1d=arguments[_0x3aa994(0x20e)],_0x507efa=_0x28ed1d<0x3?_0x287e7e:_0x563254===null?_0x563254=Object[_0x3aa994(0x209)](_0x287e7e,_0x1ccebb):_0x563254,_0xb59123;if(typeof Reflect===_0x3aa994(0x1f2)&&typeof Reflect[_0x3aa994(0x1a9)]===_0x3aa994(0x211))_0x507efa=Reflect['decorate'](_0x1a9885,_0x287e7e,_0x1ccebb,_0x563254);else{for(var _0x44a264=_0x1a9885['length']-0x1;_0x44a264>=0x0;_0x44a264--)if(_0xb59123=_0x1a9885[_0x44a264])_0x507efa=(_0x28ed1d<0x3?_0xb59123(_0x507efa):_0x28ed1d>0x3?_0xb59123(_0x287e7e,_0x1ccebb,_0x507efa):_0xb59123(_0x287e7e,_0x1ccebb))||_0x507efa;}return _0x28ed1d>0x3&&_0x507efa&&Object[_0x3aa994(0x1bb)](_0x287e7e,_0x1ccebb,_0x507efa),_0x507efa;},__metadata=this&&this['__metadata']||function(_0x3c1a53,_0x5dc28c){const _0x2e996c=a125_0x37ca;if(typeof Reflect===_0x2e996c(0x1f2)&&typeof Reflect[_0x2e996c(0x1ed)]===_0x2e996c(0x211))return Reflect[_0x2e996c(0x1ed)](_0x3c1a53,_0x5dc28c);},__importDefault=this&&this[a125_0x40879a(0x20c)]||function(_0x219a74){const _0x16385e=a125_0x40879a;return _0x219a74&&_0x219a74[_0x16385e(0x1bf)]?_0x219a74:{'default':_0x219a74};},FlosumCommitJob_1;Object['defineProperty'](exports,a125_0x40879a(0x1bf),{'value':!![]}),exports[a125_0x40879a(0x1cb)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require(a125_0x40879a(0x20b)),typedi_1=require(a125_0x40879a(0x1ea)),errors_1=require(a125_0x40879a(0x1b2)),bad_request_error_1=require(a125_0x40879a(0x1fc)),salesforce_retriever_service_1=require(a125_0x40879a(0x1d2)),salesforce_sync_service_1=require(a125_0x40879a(0x1d6)),commit_components_dto_1=require(a125_0x40879a(0x216)),commit_components_job_1=require(a125_0x40879a(0x1df)),constants_1=require(a125_0x40879a(0x1f1)),shortid_1=__importDefault(require(a125_0x40879a(0x1de))),providers_tokens_1=require(a125_0x40879a(0x1c0)),commit_to_git_completed_notification_1=require('../../notifications/commit-to-git-completed.notification'),commit_to_git_error_notification_1=require(a125_0x40879a(0x1e7));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x2c12dc,_0x50392b,_0x209bb7){const _0x48c863=a125_0x40879a;this[_0x48c863(0x1dc)]=_0x2c12dc,this[_0x48c863(0x1da)]=_0x50392b,this[_0x48c863(0x1ae)]=_0x209bb7,this[_0x48c863(0x1ab)]=new core_1[(_0x48c863(0x1ac))](FlosumCommitJob_1[_0x48c863(0x1a1)]);}async[a125_0x40879a(0x1d4)](_0x136467,_0xdb25b5,_0xdd7535,_0x1b959f){const _0x2850b4=a125_0x40879a;if(!this[_0x2850b4(0x1a4)]['isEmailNotificationsEnabled']){this['logger']['info'](_0x2850b4(0x212));return;}await new commit_to_git_completed_notification_1['CommitToGitCompletedNotification']({'emails':_0x136467,'gitProvider':_0xdb25b5,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1[_0x2850b4(0x215)][_0x2850b4(0x1a1)],'repositoryName':_0xdd7535,'branchName':_0x1b959f})['execute']();}async['errorNotification'](_0x5631db,_0x2ab5f3,_0x242910,_0x40e65d){const _0x3a5bdf=a125_0x40879a;if(!this[_0x3a5bdf(0x1a4)][_0x3a5bdf(0x1ad)]){this[_0x3a5bdf(0x1ab)][_0x3a5bdf(0x1c9)](_0x3a5bdf(0x212));return;}await new commit_to_git_error_notification_1[(_0x3a5bdf(0x1e0))]({'emails':_0x5631db,'gitProvider':_0x2ab5f3,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0x3a5bdf(0x1e0)][_0x3a5bdf(0x1a1)],'repositoryName':_0x242910,'branchName':_0x40e65d})[_0x3a5bdf(0x1e1)]();}async['fetchRepositoryData'](){const _0x2fd863=a125_0x40879a;try{if(this[_0x2fd863(0x1a4)]['syncRepositoryId'])this['repositoryData']=await this['salesforceSync'][_0x2fd863(0x206)](this['commitData'][_0x2fd863(0x1c1)]);else this[_0x2fd863(0x1a4)][_0x2fd863(0x20f)]&&(this[_0x2fd863(0x1c4)]=await this[_0x2fd863(0x1ae)]['getBranchRecord'](this[_0x2fd863(0x1a4)][_0x2fd863(0x20f)]));}catch(_0x480d44){throw new bad_request_error_1[(_0x2fd863(0x1db))](errors_1[_0x2fd863(0x1bc)]);}}async['getComponentsToWrite'](){const _0x3c8ffa=a125_0x40879a;if(!this[_0x3c8ffa(0x1a4)][_0x3c8ffa(0x1fb)])return[];await this[_0x3c8ffa(0x1dc)]['patchObject'](constants_1[_0x3c8ffa(0x1ce)],this['commitData'][_0x3c8ffa(0x1fb)],{'Name':(0x0,shortid_1[_0x3c8ffa(0x1eb)])()});const _0x2199da=await this[_0x3c8ffa(0x1dc)][_0x3c8ffa(0x1b8)](this[_0x3c8ffa(0x1a4)][_0x3c8ffa(0x1fb)])[_0x3c8ffa(0x1c2)](_0xcf790=>_0xcf790[_0x3c8ffa(0x218)]('\x20')['map'](_0x4dc927=>_0x4dc927[_0x3c8ffa(0x204)]()));await this[_0x3c8ffa(0x1dc)]['deleteAttachment'](this[_0x3c8ffa(0x1a4)][_0x3c8ffa(0x1fb)]);const _0x4444f3=new salesforce_retriever_service_1[(_0x3c8ffa(0x213))](this['salesforceService']);return await _0x4444f3['run'](_0x2199da);}async[a125_0x40879a(0x1f3)](){const _0x2989ef=a125_0x40879a;if(!this['commitData']['deleteAttachmentId'])return[];await this[_0x2989ef(0x1dc)][_0x2989ef(0x21a)](constants_1[_0x2989ef(0x1ce)],this['commitData'][_0x2989ef(0x214)],{'Name':(0x0,shortid_1[_0x2989ef(0x1eb)])()});const _0x357058=await this[_0x2989ef(0x1dc)]['retrieveAttachment'](this[_0x2989ef(0x1a4)][_0x2989ef(0x214)]),_0x2fe6d4=JSON[_0x2989ef(0x1bd)](_0x357058);return await this['salesforceService'][_0x2989ef(0x205)](this[_0x2989ef(0x1a4)][_0x2989ef(0x214)]),_0x2fe6d4;}async[a125_0x40879a(0x1f4)](){const _0x4d2007=a125_0x40879a,_0x154a82=new commit_components_dto_1[(_0x4d2007(0x1ec))](),[_0x267e03,_0x2cc667]=await Promise[_0x4d2007(0x1ee)]([this[_0x4d2007(0x1be)](),this[_0x4d2007(0x1f3)]()]);return _0x154a82[_0x4d2007(0x1b3)]=this[_0x4d2007(0x1a4)]['message'],_0x154a82[_0x4d2007(0x1aa)]=this[_0x4d2007(0x1a4)]['user'],_0x154a82[_0x4d2007(0x1c6)]={'writed':_0x267e03,'deleted':_0x2cc667},_0x154a82[_0x4d2007(0x1f9)]=this[_0x4d2007(0x1d7)][_0x4d2007(0x207)],_0x154a82[_0x4d2007(0x210)]=this[_0x4d2007(0x217)],_0x154a82['branch']=this[_0x4d2007(0x1e2)],_0x154a82[_0x4d2007(0x1d0)]=this[_0x4d2007(0x1d7)]['gitProvider'],_0x154a82[_0x4d2007(0x1fe)]=this[_0x4d2007(0x1c4)][_0x4d2007(0x1e4)],_0x154a82;}async[a125_0x40879a(0x1a6)](_0x489fdc=![]){const _0x12193d=a125_0x40879a;if(_0x489fdc)await this[_0x12193d(0x1ae)][_0x12193d(0x1d9)](this['repositoryData'],{});else{const _0x5e3664=await this[_0x12193d(0x217)][_0x12193d(0x1cd)][_0x12193d(0x1e8)](this[_0x12193d(0x1e2)][_0x12193d(0x1a1)]);this[_0x12193d(0x1f0)][_0x12193d(0x1d1)](this[_0x12193d(0x1e3)]+_0x12193d(0x1cc));const _0x367c5d={[this[_0x12193d(0x217)][_0x12193d(0x1b5)]]:{'lastCommit':_0x5e3664[_0x12193d(0x1ba)]}};await this[_0x12193d(0x1ae)][_0x12193d(0x1d9)](this[_0x12193d(0x1c4)],_0x367c5d);}}async['exec'](){const _0x2999b7=a125_0x40879a,_0x138f99=await this['getCommitDto']();await this[_0x2999b7(0x1ae)][_0x2999b7(0x1a8)](this[_0x2999b7(0x1c4)],_0x2999b7(0x1c5)),await this[_0x2999b7(0x1da)][_0x2999b7(0x1f5)](_0x138f99,this[_0x2999b7(0x1e3)]),await this['updateLastCommit'](),await this[_0x2999b7(0x1ae)][_0x2999b7(0x1a8)](this['repositoryData'],_0x2999b7(0x1b6));}async[a125_0x40879a(0x1fa)](_0x374862){const _0x249f40=a125_0x40879a;try{this[_0x249f40(0x1f0)]['error'](''+_0x374862),await this[_0x249f40(0x1f0)][_0x249f40(0x1a7)](),await this['updateLastCommit'](!![]),await this[_0x249f40(0x1ae)][_0x249f40(0x1a8)](this[_0x249f40(0x1c4)],_0x249f40(0x1c8)),await this['completeNotification']([this[_0x249f40(0x1a4)]['user'][_0x249f40(0x1a3)]],this[_0x249f40(0x1d7)]['gitProvider'],this[_0x249f40(0x217)][_0x249f40(0x1a1)],this[_0x249f40(0x1e2)][_0x249f40(0x1a1)]);}catch(_0x10fd36){this[_0x249f40(0x1ab)][_0x249f40(0x219)](_0x10fd36),await this[_0x249f40(0x200)]([this[_0x249f40(0x1a4)][_0x249f40(0x1aa)][_0x249f40(0x1a3)]],this[_0x249f40(0x1d7)]['gitProvider'],this[_0x249f40(0x217)][_0x249f40(0x1a1)],this[_0x249f40(0x1e2)][_0x249f40(0x1a1)]);}}async[a125_0x40879a(0x1f5)](_0x259529){const _0x32bee0=a125_0x40879a;try{this[_0x32bee0(0x1a4)]=_0x259529,this[_0x32bee0(0x1ef)]=typedi_1[_0x32bee0(0x1b0)][_0x32bee0(0x1c7)](providers_tokens_1[_0x32bee0(0x1cf)][_0x32bee0(0x1ef)]),this[_0x32bee0(0x1d5)]=typedi_1[_0x32bee0(0x1b0)][_0x32bee0(0x1c7)](providers_tokens_1[_0x32bee0(0x1cf)][_0x32bee0(0x1a5)]),this[_0x32bee0(0x1d7)]=typedi_1[_0x32bee0(0x1b0)]['get'](providers_tokens_1[_0x32bee0(0x1cf)][_0x32bee0(0x1d7)]),await this[_0x32bee0(0x1b4)](),this[_0x32bee0(0x217)]=await this[_0x32bee0(0x1d5)][_0x32bee0(0x1e8)](this[_0x32bee0(0x1c4)]['repositoryName']),this[_0x32bee0(0x1e2)]=await this[_0x32bee0(0x217)][_0x32bee0(0x1cd)]['getOne'](this['repositoryData']['branchName']),this[_0x32bee0(0x1f0)]=typedi_1[_0x32bee0(0x1b0)][_0x32bee0(0x1c7)](providers_tokens_1['Tokens'][_0x32bee0(0x1ab)]),this[_0x32bee0(0x1e3)]=_0x32bee0(0x20a)+this[_0x32bee0(0x1d7)][_0x32bee0(0x1d8)][_0x32bee0(0x1e9)]()+_0x32bee0(0x1b9)+this[_0x32bee0(0x1c4)]['repositoryName']+_0x32bee0(0x1dd)+this[_0x32bee0(0x1c4)][_0x32bee0(0x21b)]+_0x32bee0(0x208)+FlosumCommitJob_1[_0x32bee0(0x1a1)]+']';if(!this[_0x32bee0(0x1c4)])throw new bad_request_error_1[(_0x32bee0(0x1db))](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this[_0x32bee0(0x1f0)][_0x32bee0(0x1d1)](this['prefix']+'\x20Start\x20Flosum\x20commit\x20job.')['send'](),await this[_0x32bee0(0x1e6)]()['catch'](_0x21caed=>this['handleCommitJobError'](_0x21caed)),await this['completeNotification']([this[_0x32bee0(0x1a4)][_0x32bee0(0x1aa)][_0x32bee0(0x1a3)]],this[_0x32bee0(0x1d7)][_0x32bee0(0x1d8)],this[_0x32bee0(0x217)][_0x32bee0(0x1a1)],this[_0x32bee0(0x1e2)][_0x32bee0(0x1a1)]);}catch(_0x3a00a4){this[_0x32bee0(0x1a4)]=undefined,this[_0x32bee0(0x1ab)][_0x32bee0(0x219)](_0x3a00a4),await this[_0x32bee0(0x200)]([this[_0x32bee0(0x1a4)][_0x32bee0(0x1aa)][_0x32bee0(0x1a3)]],this['config'][_0x32bee0(0x1d8)],this[_0x32bee0(0x217)][_0x32bee0(0x1a1)],this['branch']['name']);throw _0x3a00a4;}}};function a125_0x3096(){const _0x324484=['Completed','toString','retrieveAttachment',']\x20[Repository:\x20','sha','defineProperty','ERR_INVALID_SYNC_RECORD_ID','parse','getComponentsToWrite','__esModule','../../providers/providers.tokens','syncRepositoryId','then','3834579ydiXfQ','repositoryData','In\x20Progress','components','get','Error','info','58130sSUjcX','FlosumCommitJob','\x20Update\x20remote\x20state.','branches','FLOSUM_ATTACHMENT','Tokens','provider','log','../../salesforce/services/salesforce-retriever.service','908QyfrLw','completeNotification','repoService','../../salesforce/services/salesforce-sync.service','config','gitProvider','updateRemoteState','commitJob','BadRequestError','salesforceService',']\x20[Branch:\x20','shortid','./commit-components.job','CommitToGitErrorNotification','execute','branch','prefix','recordTypeName','(((.+)+)+)+$','exec','../../notifications/commit-to-git-error.notification','getOne','toUpperCase','typedi','default','CommitComponentsDto','metadata','all','gitApiService','sfLogger','../../../../constants','object','getComponentsToDelete','getCommitDto','run','7015723XvreBA','search','80596IZfpWJ','convertToSFDX','handleCommitJobError','commitAttachmentId','../../../../core/errors/bad-request.error','6UPRtNz','recordType','SalesforceSyncService','errorNotification','CommitComponentsJob','apply','1377RoYAGC','trim','deleteAttachment','getRepositoryRecord','isConvertToSfdx',']\x20[','getOwnPropertyDescriptor','[FLOSUM\x20->\x20GIT]\x20[','../../salesforce/services/salesforce.service','__importDefault','3MMLIPl','length','syncBranchId','repo','function','Email\x20notifications\x20are\x20disabled.','SalesforceRetrieverService','deleteAttachmentId','CommitToGitCompletedNotification','../dto/commit-components.dto','repository','split','error','patchObject','branchName','name','3748664RFlUtG','email','commitData','gitRepoService','updateLastCommit','send','setStatus','decorate','user','logger','Logger','isEmailNotificationsEnabled','salesforceSync','13953PYNdhu','Container','3406795nkIdCC','../../../../constants/errors','message','fetchRepositoryData','gitUrl'];a125_0x3096=function(){return _0x324484;};return a125_0x3096();}FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1['SalesforceService'],commit_components_job_1[a125_0x40879a(0x201)],salesforce_sync_service_1[a125_0x40879a(0x1ff)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;