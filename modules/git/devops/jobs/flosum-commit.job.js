function a74_0x3cb9(_0x2236b2,_0x902627){const _0x17a8f7=a74_0x2e1a();return a74_0x3cb9=function(_0x4c8bf1,_0x737828){_0x4c8bf1=_0x4c8bf1-0x171;let _0x2e1a0d=_0x17a8f7[_0x4c8bf1];return _0x2e1a0d;},a74_0x3cb9(_0x2236b2,_0x902627);}const a74_0x541a41=a74_0x3cb9;(function(_0x102f72,_0x3c67d3){const _0x50e498=a74_0x3cb9,_0x30bf51=_0x102f72();while(!![]){try{const _0x5deaa9=parseInt(_0x50e498(0x184))/0x1+-parseInt(_0x50e498(0x1bf))/0x2+-parseInt(_0x50e498(0x18b))/0x3+-parseInt(_0x50e498(0x172))/0x4+-parseInt(_0x50e498(0x177))/0x5+parseInt(_0x50e498(0x1b2))/0x6*(parseInt(_0x50e498(0x191))/0x7)+parseInt(_0x50e498(0x1af))/0x8;if(_0x5deaa9===_0x3c67d3)break;else _0x30bf51['push'](_0x30bf51['shift']());}catch(_0x5bcfce){_0x30bf51['push'](_0x30bf51['shift']());}}}(a74_0x2e1a,0x6b06b));const a74_0x737828=(function(){let _0x128052=!![];return function(_0xf08eb,_0x449d47){const _0x1f46a3=_0x128052?function(){const _0x258e9e=a74_0x3cb9;if(_0x449d47){const _0x3250aa=_0x449d47[_0x258e9e(0x1cd)](_0xf08eb,arguments);return _0x449d47=null,_0x3250aa;}}:function(){};return _0x128052=![],_0x1f46a3;};}()),a74_0x4c8bf1=a74_0x737828(this,function(){const _0x4b1e32=a74_0x3cb9;return a74_0x4c8bf1[_0x4b1e32(0x176)]()['search']('(((.+)+)+)+$')[_0x4b1e32(0x176)]()['constructor'](a74_0x4c8bf1)['search']('(((.+)+)+)+$');});a74_0x4c8bf1();'use strict';var __decorate=this&&this[a74_0x541a41(0x19c)]||function(_0x3629a9,_0x5e1115,_0x17751e,_0x3343c0){const _0x37abad=a74_0x541a41;var _0x57b4c3=arguments[_0x37abad(0x1ac)],_0x36a2b9=_0x57b4c3<0x3?_0x5e1115:_0x3343c0===null?_0x3343c0=Object[_0x37abad(0x186)](_0x5e1115,_0x17751e):_0x3343c0,_0xabfb13;if(typeof Reflect===_0x37abad(0x1bd)&&typeof Reflect[_0x37abad(0x180)]==='function')_0x36a2b9=Reflect[_0x37abad(0x180)](_0x3629a9,_0x5e1115,_0x17751e,_0x3343c0);else{for(var _0x40bb9e=_0x3629a9[_0x37abad(0x1ac)]-0x1;_0x40bb9e>=0x0;_0x40bb9e--)if(_0xabfb13=_0x3629a9[_0x40bb9e])_0x36a2b9=(_0x57b4c3<0x3?_0xabfb13(_0x36a2b9):_0x57b4c3>0x3?_0xabfb13(_0x5e1115,_0x17751e,_0x36a2b9):_0xabfb13(_0x5e1115,_0x17751e))||_0x36a2b9;}return _0x57b4c3>0x3&&_0x36a2b9&&Object[_0x37abad(0x18f)](_0x5e1115,_0x17751e,_0x36a2b9),_0x36a2b9;},__metadata=this&&this['__metadata']||function(_0x1971bf,_0x496bf5){const _0x1e9318=a74_0x541a41;if(typeof Reflect==='object'&&typeof Reflect[_0x1e9318(0x1a0)]===_0x1e9318(0x1be))return Reflect[_0x1e9318(0x1a0)](_0x1971bf,_0x496bf5);},__importDefault=this&&this[a74_0x541a41(0x17d)]||function(_0x418ee8){const _0x4e9de3=a74_0x541a41;return _0x418ee8&&_0x418ee8[_0x4e9de3(0x182)]?_0x418ee8:{'default':_0x418ee8};},FlosumCommitJob_1;Object[a74_0x541a41(0x18f)](exports,'__esModule',{'value':!![]}),exports[a74_0x541a41(0x183)]=void 0x0;const core_1=require(a74_0x541a41(0x1b7)),salesforce_service_1=require(a74_0x541a41(0x1d2)),typedi_1=require(a74_0x541a41(0x1a9)),errors_1=require(a74_0x541a41(0x17e)),bad_request_error_1=require(a74_0x541a41(0x1b1)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a74_0x541a41(0x1d7)),commit_components_dto_1=require(a74_0x541a41(0x178)),commit_components_job_1=require(a74_0x541a41(0x1c3)),constants_1=require(a74_0x541a41(0x1c1)),shortid_1=__importDefault(require(a74_0x541a41(0x1b4))),providers_tokens_1=require(a74_0x541a41(0x1d6));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x3228ab,_0x4a2dd5,_0x13d801){const _0x10cd1c=a74_0x541a41;this[_0x10cd1c(0x1c5)]=_0x3228ab,this[_0x10cd1c(0x1a2)]=_0x4a2dd5,this[_0x10cd1c(0x174)]=_0x13d801,this[_0x10cd1c(0x19a)]=new core_1[(_0x10cd1c(0x19b))](FlosumCommitJob_1[_0x10cd1c(0x1b3)]);}async[a74_0x541a41(0x1c7)](){const _0x49c1bd=a74_0x541a41;try{if(this['commitData'][_0x49c1bd(0x1c8)])this[_0x49c1bd(0x1cc)]=await this[_0x49c1bd(0x174)]['getRepositoryRecord'](this['commitData'][_0x49c1bd(0x1c8)]);else this[_0x49c1bd(0x18d)][_0x49c1bd(0x1c9)]&&(this['repositoryData']=await this[_0x49c1bd(0x174)][_0x49c1bd(0x1a8)](this[_0x49c1bd(0x18d)][_0x49c1bd(0x1c9)]));}catch(_0x1283fc){throw new bad_request_error_1[(_0x49c1bd(0x1c4))](errors_1[_0x49c1bd(0x1b0)]);}}async[a74_0x541a41(0x1c6)](){const _0x70ba03=a74_0x541a41;if(!this[_0x70ba03(0x18d)][_0x70ba03(0x193)])return[];await this[_0x70ba03(0x1c5)][_0x70ba03(0x1a4)](constants_1[_0x70ba03(0x1d1)],this[_0x70ba03(0x18d)][_0x70ba03(0x193)],{'Name':(0x0,shortid_1[_0x70ba03(0x1ba)])()});const _0x524c5c=await this[_0x70ba03(0x1c5)][_0x70ba03(0x17a)](this['commitData'][_0x70ba03(0x193)])[_0x70ba03(0x1aa)](_0x31f896=>_0x31f896['split']('\x20')['map'](_0x21942d=>_0x21942d['trim']()));await this[_0x70ba03(0x1c5)][_0x70ba03(0x188)](this[_0x70ba03(0x18d)][_0x70ba03(0x193)]);const _0x587fa9=new salesforce_retriever_service_1[(_0x70ba03(0x1d5))](this['salesforceService']);return await _0x587fa9[_0x70ba03(0x1a7)](_0x524c5c);}async[a74_0x541a41(0x195)](){const _0x57ffd9=a74_0x541a41;if(!this[_0x57ffd9(0x18d)][_0x57ffd9(0x18e)])return[];await this['salesforceService'][_0x57ffd9(0x1a4)](constants_1['FLOSUM_ATTACHMENT'],this[_0x57ffd9(0x18d)][_0x57ffd9(0x18e)],{'Name':(0x0,shortid_1[_0x57ffd9(0x1ba)])()});const _0x2af30d=await this[_0x57ffd9(0x1c5)]['retrieveAttachment'](this['commitData'][_0x57ffd9(0x18e)]);return await this[_0x57ffd9(0x1c5)][_0x57ffd9(0x188)](this[_0x57ffd9(0x18d)][_0x57ffd9(0x18e)]),_0x2af30d;}async['getCommitDto'](){const _0x20fe70=a74_0x541a41,_0x397084=new commit_components_dto_1[(_0x20fe70(0x1d3))](),[_0x2e6085,_0x18d191]=await Promise[_0x20fe70(0x1a1)]([this[_0x20fe70(0x1c6)](),this[_0x20fe70(0x195)]()]);return _0x397084[_0x20fe70(0x1cb)]=this[_0x20fe70(0x18d)]['message'],_0x397084[_0x20fe70(0x185)]=this[_0x20fe70(0x18d)][_0x20fe70(0x185)],_0x397084['components']={'writed':_0x2e6085,'deleted':_0x18d191},_0x397084[_0x20fe70(0x194)]=this[_0x20fe70(0x1b6)]['isConvertToSfdx'],_0x397084[_0x20fe70(0x18a)]=this[_0x20fe70(0x1bc)],_0x397084[_0x20fe70(0x1ce)]=this['branch'],_0x397084[_0x20fe70(0x199)]=this['config']['gitProvider'],_0x397084;}async[a74_0x541a41(0x1bb)](_0x3cbf8b=![]){const _0x13b114=a74_0x541a41;if(_0x3cbf8b)await this['salesforceSync'][_0x13b114(0x190)](this[_0x13b114(0x1cc)],{});else{const _0x3146ed=await this['repository'][_0x13b114(0x1cf)][_0x13b114(0x17b)](this[_0x13b114(0x1ce)][_0x13b114(0x1b3)]);this[_0x13b114(0x19f)][_0x13b114(0x19e)](this[_0x13b114(0x171)]+_0x13b114(0x17f));const _0x1efbf3={[this[_0x13b114(0x1bc)]['gitUrl']]:{'lastCommit':_0x3146ed[_0x13b114(0x1a3)]}};await this[_0x13b114(0x174)]['updateRemoteState'](this['repositoryData'],_0x1efbf3);}}async[a74_0x541a41(0x1ae)](){const _0x241911=a74_0x541a41,_0xf3914e=await this['getCommitDto']();await this[_0x241911(0x174)]['setStatus'](this['repositoryData'],_0x241911(0x175)),await this[_0x241911(0x1a2)]['run'](_0xf3914e,this['prefix']),await this['updateLastCommit'](),await this[_0x241911(0x174)][_0x241911(0x179)](this[_0x241911(0x1cc)],'Completed');}async[a74_0x541a41(0x197)](_0x1ba443){const _0x327394=a74_0x541a41;try{this[_0x327394(0x19f)][_0x327394(0x1ab)](''+_0x1ba443),await this[_0x327394(0x19f)][_0x327394(0x1c0)](),await this[_0x327394(0x1bb)](!![]),await this['salesforceSync'][_0x327394(0x179)](this[_0x327394(0x1cc)],'Error');}catch(_0x3d28de){this[_0x327394(0x19a)][_0x327394(0x1ab)](_0x3d28de);}}async[a74_0x541a41(0x1a7)](_0x144f30){const _0x3de0dd=a74_0x541a41;try{this['commitData']=_0x144f30,this[_0x3de0dd(0x1ca)]=typedi_1[_0x3de0dd(0x173)][_0x3de0dd(0x181)](providers_tokens_1[_0x3de0dd(0x1a5)][_0x3de0dd(0x1ca)]),this[_0x3de0dd(0x1c2)]=typedi_1[_0x3de0dd(0x173)][_0x3de0dd(0x181)](providers_tokens_1['Tokens'][_0x3de0dd(0x1ad)]),this[_0x3de0dd(0x1b6)]=typedi_1['Container']['get'](providers_tokens_1[_0x3de0dd(0x1a5)][_0x3de0dd(0x1b6)]),await this['fetchRepositoryData'](),this[_0x3de0dd(0x1bc)]=await this[_0x3de0dd(0x1c2)][_0x3de0dd(0x17b)](this[_0x3de0dd(0x1cc)][_0x3de0dd(0x189)]),this[_0x3de0dd(0x1ce)]=await this[_0x3de0dd(0x1bc)][_0x3de0dd(0x1cf)][_0x3de0dd(0x17b)](this['repositoryData'][_0x3de0dd(0x187)]),this[_0x3de0dd(0x19f)]=typedi_1[_0x3de0dd(0x173)][_0x3de0dd(0x181)](providers_tokens_1[_0x3de0dd(0x1a5)]['logger']),this[_0x3de0dd(0x171)]=_0x3de0dd(0x1b8)+this[_0x3de0dd(0x1b6)][_0x3de0dd(0x19d)]['toUpperCase']()+_0x3de0dd(0x1a6)+this[_0x3de0dd(0x1cc)][_0x3de0dd(0x189)]+_0x3de0dd(0x1d0)+this[_0x3de0dd(0x1cc)][_0x3de0dd(0x187)]+_0x3de0dd(0x17c)+FlosumCommitJob_1[_0x3de0dd(0x1b3)]+']';if(!this[_0x3de0dd(0x1cc)])throw new bad_request_error_1[(_0x3de0dd(0x1c4))](errors_1[_0x3de0dd(0x198)]);await this['sfLogger']['log'](this[_0x3de0dd(0x171)]+_0x3de0dd(0x196))[_0x3de0dd(0x1c0)](),await this[_0x3de0dd(0x1ae)]()[_0x3de0dd(0x1b5)](_0x4f9392=>this[_0x3de0dd(0x197)](_0x4f9392));}catch(_0x161c38){this[_0x3de0dd(0x18d)]=undefined,this['logger']['error'](_0x161c38);throw _0x161c38;}}};function a74_0x2e1a(){const _0x41e745=['branchName','deleteAttachment','repositoryName','repo','1665090gyTmHf','SalesforceService','commitData','deleteAttachmentId','defineProperty','updateRemoteState','371VmxtAB','SalesforceSyncService','commitAttachmentId','convertToSFDX','getComponentsToDelete','\x20Start\x20Flosum\x20commit\x20job.','handleCommitJobError','ERR_UNKNOWN_SYNC_RECORD_ID','provider','logger','Logger','__decorate','gitProvider','log','sfLogger','metadata','all','commitJob','sha','patchObject','Tokens',']\x20[Repository:\x20','run','getBranchRecord','typedi','then','error','length','gitRepoService','exec','6374448VNPXAr','ERR_INVALID_SYNC_RECORD_ID','../../../../core/errors/bad-request.error','70206wMnLfJ','name','shortid','catch','config','../../../../core','[FLOSUM\x20->\x20GIT]\x20[','CommitComponentsJob','default','updateLastCommit','repository','object','function','596286XCbeFs','send','../../../../constants','repoService','./commit-components.job','BadRequestError','salesforceService','getComponentsToWrite','fetchRepositoryData','syncRepositoryId','syncBranchId','gitApiService','message','repositoryData','apply','branch','branches',']\x20[Branch:\x20','FLOSUM_ATTACHMENT','../../salesforce/services/salesforce.service','CommitComponentsDto','Service','SalesforceRetrieverService','../../providers/providers.tokens','../../salesforce/services/salesforce-sync.service','prefix','110748TqzAkG','Container','salesforceSync','In\x20Progress','toString','1366150EUpKvx','../dto/commit-components.dto','setStatus','retrieveAttachment','getOne',']\x20[','__importDefault','../../../../constants/errors','\x20Update\x20remote\x20state.','decorate','get','__esModule','FlosumCommitJob','175510QkbHif','user','getOwnPropertyDescriptor'];a74_0x2e1a=function(){return _0x41e745;};return a74_0x2e1a();}FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a74_0x541a41(0x1d4)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a74_0x541a41(0x18c)],commit_components_job_1[a74_0x541a41(0x1b9)],salesforce_sync_service_1[a74_0x541a41(0x192)]])],FlosumCommitJob),exports[a74_0x541a41(0x183)]=FlosumCommitJob;