function a122_0x2af6(){const _0x3b1d34=['syncRepositoryId','branches','typedi','decorate','repo','branch','../../../../core/errors/bad-request.error','CommitComponentsDto','../../../../core','shortid','split','recordType','Service','BadRequestError','object','gitApiService','user','54210ROuGBs','handleCommitJobError','catch','getOwnPropertyDescriptor','prefix','salesforceService','commitAttachmentId','getBranchRecord','ERR_INVALID_SYNC_RECORD_ID','24jkRfIf','defineProperty','5404920tcgdHC','4574kKBdMu','getComponentsToDelete','repositoryData','function','send','repositoryName','gitRepoService','parse','log','612PVTxMQ','commitData','toString','__decorate','../../salesforce/services/salesforce-sync.service','gitProvider','900rdJrGA','FlosumCommitJob','1189476MDSIOy','Container','config','ERR_UNKNOWN_SYNC_RECORD_ID','commitJob','(((.+)+)+)+$','logger','toUpperCase','convertToSFDX','Tokens','./commit-components.job','syncBranchId','sha','SalesforceRetrieverService','../dto/commit-components.dto','search','getComponentsToWrite','error','Logger','SalesforceSyncService','provider','patchObject','length','get','design:paramtypes','components','default','recordTypeName','\x20Update\x20remote\x20state.','salesforceSync','name','updateLastCommit','../../salesforce/services/salesforce-retriever.service','gitUrl','FLOSUM_ATTACHMENT','907552SIRkAE','run','CommitComponentsJob','2009arufyI','../../../../constants','[FLOSUM\x20->\x20GIT]\x20[','retrieveAttachment','then','exec','getCommitDto','__metadata','isConvertToSfdx','../../../../constants/errors','branchName','updateRemoteState','setStatus','SalesforceService','__esModule','__importDefault','repository','metadata','sfLogger','Completed','deleteAttachment','4287iwiiJq','fetchRepositoryData','deleteAttachmentId'];a122_0x2af6=function(){return _0x3b1d34;};return a122_0x2af6();}const a122_0x1d7425=a122_0x5f10;(function(_0x271233,_0x210097){const _0x4b3172=a122_0x5f10,_0x3b8398=_0x271233();while(!![]){try{const _0x529104=-parseInt(_0x4b3172(0xf1))/0x1*(-parseInt(_0x4b3172(0xf4))/0x2)+parseInt(_0x4b3172(0x140))/0x3*(-parseInt(_0x4b3172(0x103))/0x4)+-parseInt(_0x4b3172(0x154))/0x5+-parseInt(_0x4b3172(0xfd))/0x6*(-parseInt(_0x4b3172(0x12b))/0x7)+-parseInt(_0x4b3172(0x128))/0x8+parseInt(_0x4b3172(0x105))/0x9+parseInt(_0x4b3172(0xf3))/0xa;if(_0x529104===_0x210097)break;else _0x3b8398['push'](_0x3b8398['shift']());}catch(_0x43af14){_0x3b8398['push'](_0x3b8398['shift']());}}}(a122_0x2af6,0x4bedf));const a122_0x373569=(function(){let _0x50c88f=!![];return function(_0x2ebef1,_0x5c440f){const _0x184aa0=_0x50c88f?function(){if(_0x5c440f){const _0x5cab28=_0x5c440f['apply'](_0x2ebef1,arguments);return _0x5c440f=null,_0x5cab28;}}:function(){};return _0x50c88f=![],_0x184aa0;};}()),a122_0x153440=a122_0x373569(this,function(){const _0x12fb78=a122_0x5f10;return a122_0x153440[_0x12fb78(0xff)]()['search']('(((.+)+)+)+$')[_0x12fb78(0xff)]()['constructor'](a122_0x153440)[_0x12fb78(0x114)](_0x12fb78(0x10a));});a122_0x153440();function a122_0x5f10(_0x2eef28,_0x104285){const _0x7d62be=a122_0x2af6();return a122_0x5f10=function(_0x153440,_0x373569){_0x153440=_0x153440-0xf0;let _0x2af684=_0x7d62be[_0x153440];return _0x2af684;},a122_0x5f10(_0x2eef28,_0x104285);}'use strict';var __decorate=this&&this[a122_0x1d7425(0x100)]||function(_0x5351c9,_0x2a8297,_0x596068,_0x4933a5){const _0x28e410=a122_0x1d7425;var _0x505056=arguments[_0x28e410(0x11b)],_0x3e45a8=_0x505056<0x3?_0x2a8297:_0x4933a5===null?_0x4933a5=Object[_0x28e410(0x157)](_0x2a8297,_0x596068):_0x4933a5,_0x1fc0f6;if(typeof Reflect===_0x28e410(0x151)&&typeof Reflect[_0x28e410(0x146)]===_0x28e410(0xf7))_0x3e45a8=Reflect[_0x28e410(0x146)](_0x5351c9,_0x2a8297,_0x596068,_0x4933a5);else{for(var _0x302ad1=_0x5351c9[_0x28e410(0x11b)]-0x1;_0x302ad1>=0x0;_0x302ad1--)if(_0x1fc0f6=_0x5351c9[_0x302ad1])_0x3e45a8=(_0x505056<0x3?_0x1fc0f6(_0x3e45a8):_0x505056>0x3?_0x1fc0f6(_0x2a8297,_0x596068,_0x3e45a8):_0x1fc0f6(_0x2a8297,_0x596068))||_0x3e45a8;}return _0x505056>0x3&&_0x3e45a8&&Object['defineProperty'](_0x2a8297,_0x596068,_0x3e45a8),_0x3e45a8;},__metadata=this&&this[a122_0x1d7425(0x132)]||function(_0x1b8fb1,_0x4b85e8){const _0x4425bb=a122_0x1d7425;if(typeof Reflect===_0x4425bb(0x151)&&typeof Reflect[_0x4425bb(0x13c)]==='function')return Reflect[_0x4425bb(0x13c)](_0x1b8fb1,_0x4b85e8);},__importDefault=this&&this[a122_0x1d7425(0x13a)]||function(_0x21260d){const _0x3d84e3=a122_0x1d7425;return _0x21260d&&_0x21260d[_0x3d84e3(0x139)]?_0x21260d:{'default':_0x21260d};},FlosumCommitJob_1;Object[a122_0x1d7425(0xf2)](exports,a122_0x1d7425(0x139),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;const core_1=require(a122_0x1d7425(0x14b)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a122_0x1d7425(0x145)),errors_1=require(a122_0x1d7425(0x134)),bad_request_error_1=require(a122_0x1d7425(0x149)),salesforce_retriever_service_1=require(a122_0x1d7425(0x125)),salesforce_sync_service_1=require(a122_0x1d7425(0x101)),commit_components_dto_1=require(a122_0x1d7425(0x113)),commit_components_job_1=require(a122_0x1d7425(0x10f)),constants_1=require(a122_0x1d7425(0x12c)),shortid_1=__importDefault(require(a122_0x1d7425(0x14c))),providers_tokens_1=require('../../providers/providers.tokens');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x30bf54,_0x13611e,_0x2d2108){const _0x9861e4=a122_0x1d7425;this[_0x9861e4(0x159)]=_0x30bf54,this[_0x9861e4(0x109)]=_0x13611e,this['salesforceSync']=_0x2d2108,this[_0x9861e4(0x10b)]=new core_1[(_0x9861e4(0x117))](FlosumCommitJob_1[_0x9861e4(0x123)]);}async[a122_0x1d7425(0x141)](){const _0x571fc1=a122_0x1d7425;try{if(this[_0x571fc1(0xfe)]['syncRepositoryId'])this['repositoryData']=await this['salesforceSync']['getRepositoryRecord'](this[_0x571fc1(0xfe)][_0x571fc1(0x143)]);else this[_0x571fc1(0xfe)][_0x571fc1(0x110)]&&(this['repositoryData']=await this[_0x571fc1(0x122)][_0x571fc1(0x15b)](this[_0x571fc1(0xfe)][_0x571fc1(0x110)]));}catch(_0x52e9f7){throw new bad_request_error_1[(_0x571fc1(0x150))](errors_1[_0x571fc1(0xf0)]);}}async[a122_0x1d7425(0x115)](){const _0xfd23aa=a122_0x1d7425;if(!this[_0xfd23aa(0xfe)]['commitAttachmentId'])return[];await this[_0xfd23aa(0x159)][_0xfd23aa(0x11a)](constants_1[_0xfd23aa(0x127)],this[_0xfd23aa(0xfe)][_0xfd23aa(0x15a)],{'Name':(0x0,shortid_1[_0xfd23aa(0x11f)])()});const _0x10b3f5=await this[_0xfd23aa(0x159)][_0xfd23aa(0x12e)](this[_0xfd23aa(0xfe)][_0xfd23aa(0x15a)])[_0xfd23aa(0x12f)](_0x313d02=>_0x313d02[_0xfd23aa(0x14d)]('\x20')['map'](_0x2813ee=>_0x2813ee['trim']()));await this[_0xfd23aa(0x159)][_0xfd23aa(0x13f)](this['commitData'][_0xfd23aa(0x15a)]);const _0x417cb2=new salesforce_retriever_service_1[(_0xfd23aa(0x112))](this['salesforceService']);return await _0x417cb2[_0xfd23aa(0x129)](_0x10b3f5);}async[a122_0x1d7425(0xf5)](){const _0x538ba9=a122_0x1d7425;if(!this[_0x538ba9(0xfe)]['deleteAttachmentId'])return[];await this[_0x538ba9(0x159)][_0x538ba9(0x11a)](constants_1[_0x538ba9(0x127)],this[_0x538ba9(0xfe)][_0x538ba9(0x142)],{'Name':(0x0,shortid_1[_0x538ba9(0x11f)])()});const _0x4ff873=await this[_0x538ba9(0x159)]['retrieveAttachment'](this[_0x538ba9(0xfe)][_0x538ba9(0x142)]),_0xf5e2b=JSON[_0x538ba9(0xfb)](_0x4ff873);return await this[_0x538ba9(0x159)][_0x538ba9(0x13f)](this[_0x538ba9(0xfe)][_0x538ba9(0x142)]),_0xf5e2b;}async[a122_0x1d7425(0x131)](){const _0x11121e=a122_0x1d7425,_0xfd8278=new commit_components_dto_1[(_0x11121e(0x14a))](),[_0x40b5cf,_0x452cc1]=await Promise['all']([this[_0x11121e(0x115)](),this[_0x11121e(0xf5)]()]);return _0xfd8278['message']=this[_0x11121e(0xfe)]['message'],_0xfd8278[_0x11121e(0x153)]=this['commitData'][_0x11121e(0x153)],_0xfd8278[_0x11121e(0x11e)]={'writed':_0x40b5cf,'deleted':_0x452cc1},_0xfd8278[_0x11121e(0x10d)]=this[_0x11121e(0x107)][_0x11121e(0x133)],_0xfd8278[_0x11121e(0x147)]=this['repository'],_0xfd8278['branch']=this['branch'],_0xfd8278[_0x11121e(0x119)]=this['config'][_0x11121e(0x102)],_0xfd8278[_0x11121e(0x14e)]=this[_0x11121e(0xf6)][_0x11121e(0x120)],_0xfd8278;}async['updateLastCommit'](_0x431c74=![]){const _0x312e67=a122_0x1d7425;if(_0x431c74)await this[_0x312e67(0x122)][_0x312e67(0x136)](this[_0x312e67(0xf6)],{});else{const _0x228d96=await this[_0x312e67(0x13b)]['branches']['getOne'](this[_0x312e67(0x148)][_0x312e67(0x123)]);this[_0x312e67(0x13d)][_0x312e67(0xfc)](this[_0x312e67(0x158)]+_0x312e67(0x121));const _0x15f139={[this[_0x312e67(0x13b)][_0x312e67(0x126)]]:{'lastCommit':_0x228d96[_0x312e67(0x111)]}};await this['salesforceSync']['updateRemoteState'](this[_0x312e67(0xf6)],_0x15f139);}}async[a122_0x1d7425(0x130)](){const _0x251497=a122_0x1d7425,_0x588ab3=await this['getCommitDto']();await this[_0x251497(0x122)]['setStatus'](this[_0x251497(0xf6)],'In\x20Progress'),await this['commitJob'][_0x251497(0x129)](_0x588ab3,this[_0x251497(0x158)]),await this[_0x251497(0x124)](),await this[_0x251497(0x122)]['setStatus'](this[_0x251497(0xf6)],_0x251497(0x13e));}async[a122_0x1d7425(0x155)](_0x109dd4){const _0x3979c3=a122_0x1d7425;try{this['sfLogger'][_0x3979c3(0x116)](''+_0x109dd4),await this[_0x3979c3(0x13d)][_0x3979c3(0xf8)](),await this['updateLastCommit'](!![]),await this['salesforceSync'][_0x3979c3(0x137)](this[_0x3979c3(0xf6)],'Error');}catch(_0x274f57){this[_0x3979c3(0x10b)][_0x3979c3(0x116)](_0x274f57);}}async[a122_0x1d7425(0x129)](_0x8c9871){const _0x2fa9cf=a122_0x1d7425;try{this[_0x2fa9cf(0xfe)]=_0x8c9871,this[_0x2fa9cf(0x152)]=typedi_1[_0x2fa9cf(0x106)][_0x2fa9cf(0x11c)](providers_tokens_1[_0x2fa9cf(0x10e)][_0x2fa9cf(0x152)]),this['repoService']=typedi_1[_0x2fa9cf(0x106)][_0x2fa9cf(0x11c)](providers_tokens_1[_0x2fa9cf(0x10e)][_0x2fa9cf(0xfa)]),this[_0x2fa9cf(0x107)]=typedi_1[_0x2fa9cf(0x106)][_0x2fa9cf(0x11c)](providers_tokens_1[_0x2fa9cf(0x10e)][_0x2fa9cf(0x107)]),await this[_0x2fa9cf(0x141)](),this['repository']=await this['repoService']['getOne'](this[_0x2fa9cf(0xf6)][_0x2fa9cf(0xf9)]),this['branch']=await this['repository'][_0x2fa9cf(0x144)]['getOne'](this[_0x2fa9cf(0xf6)][_0x2fa9cf(0x135)]),this[_0x2fa9cf(0x13d)]=typedi_1['Container']['get'](providers_tokens_1[_0x2fa9cf(0x10e)]['logger']),this[_0x2fa9cf(0x158)]=_0x2fa9cf(0x12d)+this['config'][_0x2fa9cf(0x102)][_0x2fa9cf(0x10c)]()+']\x20[Repository:\x20'+this[_0x2fa9cf(0xf6)][_0x2fa9cf(0xf9)]+']\x20[Branch:\x20'+this['repositoryData'][_0x2fa9cf(0x135)]+']\x20['+FlosumCommitJob_1['name']+']';if(!this['repositoryData'])throw new bad_request_error_1[(_0x2fa9cf(0x150))](errors_1[_0x2fa9cf(0x108)]);await this[_0x2fa9cf(0x13d)][_0x2fa9cf(0xfc)](this['prefix']+'\x20Start\x20Flosum\x20commit\x20job.')[_0x2fa9cf(0xf8)](),await this[_0x2fa9cf(0x130)]()[_0x2fa9cf(0x156)](_0x39f576=>this[_0x2fa9cf(0x155)](_0x39f576));}catch(_0x574732){this[_0x2fa9cf(0xfe)]=undefined,this['logger']['error'](_0x574732);throw _0x574732;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a122_0x1d7425(0x14f)])({'transient':!![]}),__metadata(a122_0x1d7425(0x11d),[salesforce_service_1[a122_0x1d7425(0x138)],commit_components_job_1[a122_0x1d7425(0x12a)],salesforce_sync_service_1[a122_0x1d7425(0x118)]])],FlosumCommitJob),exports[a122_0x1d7425(0x104)]=FlosumCommitJob;