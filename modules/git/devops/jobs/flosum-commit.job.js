const a105_0xd10267=a105_0x4b5a;(function(_0x1d48c5,_0x438d83){const _0x37f377=a105_0x4b5a,_0x335a35=_0x1d48c5();while(!![]){try{const _0x4011f5=parseInt(_0x37f377(0xd5))/0x1+parseInt(_0x37f377(0xfd))/0x2+parseInt(_0x37f377(0xd8))/0x3*(-parseInt(_0x37f377(0xc8))/0x4)+-parseInt(_0x37f377(0xf1))/0x5*(parseInt(_0x37f377(0xda))/0x6)+parseInt(_0x37f377(0xd0))/0x7*(parseInt(_0x37f377(0xd1))/0x8)+parseInt(_0x37f377(0xe2))/0x9*(parseInt(_0x37f377(0xeb))/0xa)+-parseInt(_0x37f377(0xa0))/0xb;if(_0x4011f5===_0x438d83)break;else _0x335a35['push'](_0x335a35['shift']());}catch(_0x106dd3){_0x335a35['push'](_0x335a35['shift']());}}}(a105_0x1826,0x3384e));const a105_0x442a86=(function(){let _0x1d0a33=!![];return function(_0x24a0de,_0x1f2cfc){const _0x4edc9a=_0x1d0a33?function(){const _0x42368f=a105_0x4b5a;if(_0x1f2cfc){const _0x4c6fef=_0x1f2cfc[_0x42368f(0xac)](_0x24a0de,arguments);return _0x1f2cfc=null,_0x4c6fef;}}:function(){};return _0x1d0a33=![],_0x4edc9a;};}()),a105_0x2c174b=a105_0x442a86(this,function(){const _0x1f7636=a105_0x4b5a;return a105_0x2c174b[_0x1f7636(0xd3)]()['search'](_0x1f7636(0xc1))[_0x1f7636(0xd3)]()[_0x1f7636(0xe3)](a105_0x2c174b)[_0x1f7636(0x98)](_0x1f7636(0xc1));});a105_0x2c174b();function a105_0x1826(){const _0x2a79d2=['sha','handleCommitJobError','[FLOSUM\x20->\x20GIT]\x20[','syncRepositoryId',']\x20[Repository:\x20','retrieveAttachment','message','./commit-components.job','getRepositoryRecord','ERR_INVALID_SYNC_RECORD_ID','syncBranchId','object','getOwnPropertyDescriptor','toUpperCase','user','commitData','default','provider','salesforceService','(((.+)+)+)+$','\x20Start\x20Flosum\x20commit\x20job.','name',']\x20[Branch:\x20','getCommitDto','\x20Update\x20remote\x20state.','CommitComponentsDto','37616IxKbOv','get','getComponentsToDelete','patchObject','../../../../constants/errors','commitAttachmentId','convertToSFDX','repositoryName','21frmoWS','863472GSbcLE','setStatus','toString','send','368373ixdOvH','error','config','24lotmvu','run','1536HLkAPu','branch','function','map','FLOSUM_ATTACHMENT','../dto/commit-components.dto','design:paramtypes','SalesforceRetrieverService','9WAwGIc','constructor','Service','../../providers/providers.tokens','updateLastCommit','BadRequestError','defineProperty','repo','log','3726610YxCdca','all','__importDefault','ERR_UNKNOWN_SYNC_RECORD_ID','salesforceSync','metadata','710nDwqqz','repositoryData','components','../../../../core/errors/bad-request.error','SalesforceService','repoService','isConvertToSfdx','exec','logger','catch','repository','SalesforceSyncService','758810psywjP','branches',']\x20[','FlosumCommitJob','deleteAttachment','../../../../constants','shortid','../../salesforce/services/salesforce-sync.service','In\x20Progress','search','decorate','commitJob','gitRepoService','fetchRepositoryData','then','Tokens','sfLogger','12337985MiITkX','trim','getComponentsToWrite','deleteAttachmentId','prefix','getOne','__esModule','length','Error','Container','gitProvider','branchName','apply','__metadata'];a105_0x1826=function(){return _0x2a79d2;};return a105_0x1826();}'use strict';function a105_0x4b5a(_0x28059f,_0x61553){const _0x512062=a105_0x1826();return a105_0x4b5a=function(_0x2c174b,_0x442a86){_0x2c174b=_0x2c174b-0x97;let _0x18267e=_0x512062[_0x2c174b];return _0x18267e;},a105_0x4b5a(_0x28059f,_0x61553);}var __decorate=this&&this['__decorate']||function(_0x1da8cc,_0x3ea5cb,_0x2050c2,_0x1e90e0){const _0x342441=a105_0x4b5a;var _0x2e248d=arguments[_0x342441(0xa7)],_0x3054d8=_0x2e248d<0x3?_0x3ea5cb:_0x1e90e0===null?_0x1e90e0=Object[_0x342441(0xba)](_0x3ea5cb,_0x2050c2):_0x1e90e0,_0x18e3e8;if(typeof Reflect===_0x342441(0xb9)&&typeof Reflect[_0x342441(0x99)]===_0x342441(0xdc))_0x3054d8=Reflect['decorate'](_0x1da8cc,_0x3ea5cb,_0x2050c2,_0x1e90e0);else{for(var _0x3389e5=_0x1da8cc[_0x342441(0xa7)]-0x1;_0x3389e5>=0x0;_0x3389e5--)if(_0x18e3e8=_0x1da8cc[_0x3389e5])_0x3054d8=(_0x2e248d<0x3?_0x18e3e8(_0x3054d8):_0x2e248d>0x3?_0x18e3e8(_0x3ea5cb,_0x2050c2,_0x3054d8):_0x18e3e8(_0x3ea5cb,_0x2050c2))||_0x3054d8;}return _0x2e248d>0x3&&_0x3054d8&&Object[_0x342441(0xe8)](_0x3ea5cb,_0x2050c2,_0x3054d8),_0x3054d8;},__metadata=this&&this[a105_0xd10267(0xad)]||function(_0x3e5c44,_0x221a98){const _0x336dd3=a105_0xd10267;if(typeof Reflect===_0x336dd3(0xb9)&&typeof Reflect[_0x336dd3(0xf0)]===_0x336dd3(0xdc))return Reflect['metadata'](_0x3e5c44,_0x221a98);},__importDefault=this&&this[a105_0xd10267(0xed)]||function(_0x375bca){const _0xf92845=a105_0xd10267;return _0x375bca&&_0x375bca[_0xf92845(0xa6)]?_0x375bca:{'default':_0x375bca};},FlosumCommitJob_1;Object['defineProperty'](exports,a105_0xd10267(0xa6),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require('typedi'),errors_1=require(a105_0xd10267(0xcc)),bad_request_error_1=require(a105_0xd10267(0xf4)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a105_0xd10267(0x104)),commit_components_dto_1=require(a105_0xd10267(0xdf)),commit_components_job_1=require(a105_0xd10267(0xb5)),constants_1=require(a105_0xd10267(0x102)),shortid_1=__importDefault(require(a105_0xd10267(0x103))),providers_tokens_1=require(a105_0xd10267(0xe5));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x5ada65,_0x4d4007,_0x18fc4e){const _0x2b4b09=a105_0xd10267;this[_0x2b4b09(0xc0)]=_0x5ada65,this['commitJob']=_0x4d4007,this[_0x2b4b09(0xef)]=_0x18fc4e,this[_0x2b4b09(0xf9)]=new core_1['Logger'](FlosumCommitJob_1[_0x2b4b09(0xc3)]);}async[a105_0xd10267(0x9c)](){const _0xcfa255=a105_0xd10267;try{if(this[_0xcfa255(0xbd)][_0xcfa255(0xb1)])this['repositoryData']=await this[_0xcfa255(0xef)][_0xcfa255(0xb6)](this[_0xcfa255(0xbd)]['syncRepositoryId']);else this[_0xcfa255(0xbd)][_0xcfa255(0xb8)]&&(this[_0xcfa255(0xf2)]=await this['salesforceSync']['getBranchRecord'](this[_0xcfa255(0xbd)]['syncBranchId']));}catch(_0x474245){throw new bad_request_error_1[(_0xcfa255(0xe7))](errors_1[_0xcfa255(0xb7)]);}}async[a105_0xd10267(0xa2)](){const _0x1cc4a3=a105_0xd10267;if(!this[_0x1cc4a3(0xbd)]['commitAttachmentId'])return[];await this['salesforceService'][_0x1cc4a3(0xcb)](constants_1['FLOSUM_ATTACHMENT'],this[_0x1cc4a3(0xbd)]['commitAttachmentId'],{'Name':(0x0,shortid_1[_0x1cc4a3(0xbe)])()});const _0x21fb7d=await this[_0x1cc4a3(0xc0)][_0x1cc4a3(0xb3)](this[_0x1cc4a3(0xbd)][_0x1cc4a3(0xcd)])[_0x1cc4a3(0x9d)](_0x23a469=>_0x23a469['split']('\x20')[_0x1cc4a3(0xdd)](_0x43ef40=>_0x43ef40[_0x1cc4a3(0xa1)]()));await this['salesforceService'][_0x1cc4a3(0x101)](this[_0x1cc4a3(0xbd)][_0x1cc4a3(0xcd)]);const _0x245e75=new salesforce_retriever_service_1[(_0x1cc4a3(0xe1))](this[_0x1cc4a3(0xc0)]);return await _0x245e75[_0x1cc4a3(0xd9)](_0x21fb7d);}async[a105_0xd10267(0xca)](){const _0x3b9063=a105_0xd10267;if(!this[_0x3b9063(0xbd)][_0x3b9063(0xa3)])return[];await this[_0x3b9063(0xc0)][_0x3b9063(0xcb)](constants_1[_0x3b9063(0xde)],this['commitData'][_0x3b9063(0xa3)],{'Name':(0x0,shortid_1['default'])()});const _0x58b777=await this[_0x3b9063(0xc0)]['retrieveAttachment'](this['commitData'][_0x3b9063(0xa3)]);return await this[_0x3b9063(0xc0)][_0x3b9063(0x101)](this[_0x3b9063(0xbd)]['deleteAttachmentId']),_0x58b777;}async[a105_0xd10267(0xc5)](){const _0x2a8c1a=a105_0xd10267,_0x5521ca=new commit_components_dto_1[(_0x2a8c1a(0xc7))](),[_0x4a74ed,_0x5da08e]=await Promise[_0x2a8c1a(0xec)]([this[_0x2a8c1a(0xa2)](),this['getComponentsToDelete']()]);return _0x5521ca['message']=this[_0x2a8c1a(0xbd)][_0x2a8c1a(0xb4)],_0x5521ca[_0x2a8c1a(0xbc)]=this[_0x2a8c1a(0xbd)][_0x2a8c1a(0xbc)],_0x5521ca[_0x2a8c1a(0xf3)]={'writed':_0x4a74ed,'deleted':_0x5da08e},_0x5521ca[_0x2a8c1a(0xce)]=this[_0x2a8c1a(0xd7)][_0x2a8c1a(0xf7)],_0x5521ca[_0x2a8c1a(0xe9)]=this[_0x2a8c1a(0xfb)],_0x5521ca[_0x2a8c1a(0xdb)]=this[_0x2a8c1a(0xdb)],_0x5521ca[_0x2a8c1a(0xbf)]=this[_0x2a8c1a(0xd7)][_0x2a8c1a(0xaa)],_0x5521ca;}async['updateLastCommit'](_0x41ca5d=![]){const _0xc32703=a105_0xd10267;if(_0x41ca5d)await this['salesforceSync']['updateRemoteState'](this[_0xc32703(0xf2)],{});else{const _0x34009d=await this[_0xc32703(0xfb)][_0xc32703(0xfe)]['getOne'](this[_0xc32703(0xdb)]['name']);this['sfLogger']['log'](this[_0xc32703(0xa4)]+_0xc32703(0xc6));const _0x2aa828={[this['repository']['gitUrl']]:{'lastCommit':_0x34009d[_0xc32703(0xae)]}};await this[_0xc32703(0xef)]['updateRemoteState'](this[_0xc32703(0xf2)],_0x2aa828);}}async[a105_0xd10267(0xf8)](){const _0x43aa01=a105_0xd10267,_0x54162b=await this[_0x43aa01(0xc5)]();await this[_0x43aa01(0xef)][_0x43aa01(0xd2)](this[_0x43aa01(0xf2)],_0x43aa01(0x97)),await this[_0x43aa01(0x9a)][_0x43aa01(0xd9)](_0x54162b,this['prefix']),await this['updateLastCommit'](),await this[_0x43aa01(0xef)][_0x43aa01(0xd2)](this[_0x43aa01(0xf2)],'Completed');}async[a105_0xd10267(0xaf)](_0x2a7454){const _0x3e7729=a105_0xd10267;try{this[_0x3e7729(0x9f)][_0x3e7729(0xd6)](''+_0x2a7454),await this[_0x3e7729(0x9f)]['send'](),await this[_0x3e7729(0xe6)](!![]),await this[_0x3e7729(0xef)][_0x3e7729(0xd2)](this[_0x3e7729(0xf2)],_0x3e7729(0xa8));}catch(_0x360a09){this[_0x3e7729(0xf9)][_0x3e7729(0xd6)](_0x360a09);}}async[a105_0xd10267(0xd9)](_0x2f9d25){const _0x6bd1bd=a105_0xd10267;try{this['commitData']=_0x2f9d25,this['gitApiService']=typedi_1[_0x6bd1bd(0xa9)][_0x6bd1bd(0xc9)](providers_tokens_1[_0x6bd1bd(0x9e)]['gitApiService']),this[_0x6bd1bd(0xf6)]=typedi_1[_0x6bd1bd(0xa9)][_0x6bd1bd(0xc9)](providers_tokens_1[_0x6bd1bd(0x9e)][_0x6bd1bd(0x9b)]),this[_0x6bd1bd(0xd7)]=typedi_1['Container'][_0x6bd1bd(0xc9)](providers_tokens_1[_0x6bd1bd(0x9e)][_0x6bd1bd(0xd7)]),await this[_0x6bd1bd(0x9c)](),this[_0x6bd1bd(0xfb)]=await this[_0x6bd1bd(0xf6)][_0x6bd1bd(0xa5)](this[_0x6bd1bd(0xf2)][_0x6bd1bd(0xcf)]),this[_0x6bd1bd(0xdb)]=await this['repository'][_0x6bd1bd(0xfe)][_0x6bd1bd(0xa5)](this[_0x6bd1bd(0xf2)][_0x6bd1bd(0xab)]),this['sfLogger']=typedi_1[_0x6bd1bd(0xa9)][_0x6bd1bd(0xc9)](providers_tokens_1['Tokens']['logger']),this[_0x6bd1bd(0xa4)]=_0x6bd1bd(0xb0)+this[_0x6bd1bd(0xd7)][_0x6bd1bd(0xaa)][_0x6bd1bd(0xbb)]()+_0x6bd1bd(0xb2)+this[_0x6bd1bd(0xf2)][_0x6bd1bd(0xcf)]+_0x6bd1bd(0xc4)+this['repositoryData'][_0x6bd1bd(0xab)]+_0x6bd1bd(0xff)+FlosumCommitJob_1[_0x6bd1bd(0xc3)]+']';if(!this['repositoryData'])throw new bad_request_error_1[(_0x6bd1bd(0xe7))](errors_1[_0x6bd1bd(0xee)]);await this[_0x6bd1bd(0x9f)][_0x6bd1bd(0xea)](this[_0x6bd1bd(0xa4)]+_0x6bd1bd(0xc2))[_0x6bd1bd(0xd4)](),await this[_0x6bd1bd(0xf8)]()[_0x6bd1bd(0xfa)](_0x593a7e=>this[_0x6bd1bd(0xaf)](_0x593a7e));}catch(_0x425dd5){this['commitData']=undefined,this[_0x6bd1bd(0xf9)][_0x6bd1bd(0xd6)](_0x425dd5);throw _0x425dd5;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a105_0xd10267(0xe4)])({'transient':!![]}),__metadata(a105_0xd10267(0xe0),[salesforce_service_1[a105_0xd10267(0xf5)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a105_0xd10267(0xfc)]])],FlosumCommitJob),exports[a105_0xd10267(0x100)]=FlosumCommitJob;