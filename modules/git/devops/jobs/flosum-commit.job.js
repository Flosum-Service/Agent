const a105_0xcdb1b3=a105_0x5467;(function(_0x55557b,_0x194b03){const _0x420bc8=a105_0x5467,_0x2a413a=_0x55557b();while(!![]){try{const _0x58c22c=parseInt(_0x420bc8(0xc6))/0x1*(-parseInt(_0x420bc8(0xd5))/0x2)+parseInt(_0x420bc8(0xe3))/0x3*(-parseInt(_0x420bc8(0x105))/0x4)+-parseInt(_0x420bc8(0x108))/0x5*(parseInt(_0x420bc8(0xcc))/0x6)+-parseInt(_0x420bc8(0x128))/0x7*(-parseInt(_0x420bc8(0xec))/0x8)+-parseInt(_0x420bc8(0xc0))/0x9+parseInt(_0x420bc8(0xf1))/0xa+parseInt(_0x420bc8(0xd0))/0xb;if(_0x58c22c===_0x194b03)break;else _0x2a413a['push'](_0x2a413a['shift']());}catch(_0x3f7126){_0x2a413a['push'](_0x2a413a['shift']());}}}(a105_0x23ed,0xa806a));const a105_0x3ddcc8=(function(){let _0x45870f=!![];return function(_0x1bf88c,_0x16722d){const _0x3e42d2=_0x45870f?function(){const _0x52267e=a105_0x5467;if(_0x16722d){const _0x1ce5e5=_0x16722d[_0x52267e(0x10d)](_0x1bf88c,arguments);return _0x16722d=null,_0x1ce5e5;}}:function(){};return _0x45870f=![],_0x3e42d2;};}()),a105_0x5b87e3=a105_0x3ddcc8(this,function(){const _0x165c07=a105_0x5467;return a105_0x5b87e3[_0x165c07(0x126)]()[_0x165c07(0x117)](_0x165c07(0xff))['toString']()[_0x165c07(0x112)](a105_0x5b87e3)[_0x165c07(0x117)](_0x165c07(0xff));});a105_0x5b87e3();function a105_0x23ed(){const _0x18bf4d=['getBranchRecord','all','gitRepoService','9665163fosKHn','exec','send','__metadata','branchName','defineProperty','2EEAfEX','ERR_INVALID_SYNC_RECORD_ID','commitAttachmentId',']\x20[Repository:\x20','salesforceSync','config','6647898cfrXWY','../dto/commit-components.dto','../../../../constants','patchObject','20955451DwejRs','repo','isConvertToSfdx','branch','typedi','780336wZIWMg','deleteAttachment','repository','log','repositoryData',']\x20[Branch:\x20','gitUrl','getOne','Completed',']\x20[','deleteAttachmentId','SalesforceSyncService','../../salesforce/services/salesforce-sync.service','run','9Kwyznb','logger','syncRepositoryId','BadRequestError','Tokens','toUpperCase','getComponentsToWrite','Logger','gitApiService','16600RKqdOe','user','default','CommitComponentsJob','catch','5823260osrlYh','setStatus','FlosumCommitJob','getOwnPropertyDescriptor','get','../../salesforce/services/salesforce-retriever.service','handleCommitJobError','sfLogger','prefix','components','syncBranchId','\x20Start\x20Flosum\x20commit\x20job.','function','SalesforceService','(((.+)+)+)+$','Error','Container','../../../../core','sha','__esModule','4076orpiTC','[FLOSUM\x20->\x20GIT]\x20[','getComponentsToDelete','5MTxrtF','branches','repoService','decorate','FLOSUM_ATTACHMENT','apply','repositoryName','shortid','commitJob','salesforceService','constructor','../../salesforce/services/salesforce.service','updateRemoteState','name','getCommitDto','search','updateLastCommit','__decorate','error','SalesforceRetrieverService','\x20Update\x20remote\x20state.','../../../../core/errors/bad-request.error','split','message','getRepositoryRecord','design:paramtypes','map','retrieveAttachment','commitData','then','toString','object','3934eBWizZ','Service'];a105_0x23ed=function(){return _0x18bf4d;};return a105_0x23ed();}'use strict';var __decorate=this&&this[a105_0xcdb1b3(0x119)]||function(_0x3c6d5a,_0x3b0340,_0x1596e0,_0x4a7ef3){const _0x29246c=a105_0xcdb1b3;var _0x3047ba=arguments['length'],_0x2ab870=_0x3047ba<0x3?_0x3b0340:_0x4a7ef3===null?_0x4a7ef3=Object[_0x29246c(0xf4)](_0x3b0340,_0x1596e0):_0x4a7ef3,_0x59177a;if(typeof Reflect===_0x29246c(0x127)&&typeof Reflect[_0x29246c(0x10b)]===_0x29246c(0xfd))_0x2ab870=Reflect[_0x29246c(0x10b)](_0x3c6d5a,_0x3b0340,_0x1596e0,_0x4a7ef3);else{for(var _0x2c8fd1=_0x3c6d5a['length']-0x1;_0x2c8fd1>=0x0;_0x2c8fd1--)if(_0x59177a=_0x3c6d5a[_0x2c8fd1])_0x2ab870=(_0x3047ba<0x3?_0x59177a(_0x2ab870):_0x3047ba>0x3?_0x59177a(_0x3b0340,_0x1596e0,_0x2ab870):_0x59177a(_0x3b0340,_0x1596e0))||_0x2ab870;}return _0x3047ba>0x3&&_0x2ab870&&Object[_0x29246c(0xc5)](_0x3b0340,_0x1596e0,_0x2ab870),_0x2ab870;},__metadata=this&&this[a105_0xcdb1b3(0xc3)]||function(_0x11d68a,_0x3e16c7){const _0x2d7453=a105_0xcdb1b3;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x2d7453(0xfd))return Reflect['metadata'](_0x11d68a,_0x3e16c7);},__importDefault=this&&this['__importDefault']||function(_0x1ba6b9){const _0x9c0239=a105_0xcdb1b3;return _0x1ba6b9&&_0x1ba6b9[_0x9c0239(0x104)]?_0x1ba6b9:{'default':_0x1ba6b9};},FlosumCommitJob_1;Object[a105_0xcdb1b3(0xc5)](exports,a105_0xcdb1b3(0x104),{'value':!![]}),exports[a105_0xcdb1b3(0xf3)]=void 0x0;const core_1=require(a105_0xcdb1b3(0x102)),salesforce_service_1=require(a105_0xcdb1b3(0x113)),typedi_1=require(a105_0xcdb1b3(0xd4)),errors_1=require('../../../../constants/errors'),bad_request_error_1=require(a105_0xcdb1b3(0x11d)),salesforce_retriever_service_1=require(a105_0xcdb1b3(0xf6)),salesforce_sync_service_1=require(a105_0xcdb1b3(0xe1)),commit_components_dto_1=require(a105_0xcdb1b3(0xcd)),commit_components_job_1=require('./commit-components.job'),constants_1=require(a105_0xcdb1b3(0xce)),shortid_1=__importDefault(require(a105_0xcdb1b3(0x10f))),providers_tokens_1=require('../../providers/providers.tokens');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x1455ae,_0x3bad35,_0x1a935f){const _0x38d2b2=a105_0xcdb1b3;this[_0x38d2b2(0x111)]=_0x1455ae,this['commitJob']=_0x3bad35,this['salesforceSync']=_0x1a935f,this['logger']=new core_1[(_0x38d2b2(0xea))](FlosumCommitJob_1['name']);}async['fetchRepositoryData'](){const _0x417c08=a105_0xcdb1b3;try{if(this[_0x417c08(0x124)][_0x417c08(0xe5)])this[_0x417c08(0xd9)]=await this[_0x417c08(0xca)][_0x417c08(0x120)](this[_0x417c08(0x124)][_0x417c08(0xe5)]);else this[_0x417c08(0x124)][_0x417c08(0xfb)]&&(this['repositoryData']=await this[_0x417c08(0xca)][_0x417c08(0xbd)](this[_0x417c08(0x124)][_0x417c08(0xfb)]));}catch(_0x5a96d0){throw new bad_request_error_1[(_0x417c08(0xe6))](errors_1[_0x417c08(0xc7)]);}}async[a105_0xcdb1b3(0xe9)](){const _0x589e9e=a105_0xcdb1b3;if(!this[_0x589e9e(0x124)][_0x589e9e(0xc8)])return[];await this[_0x589e9e(0x111)][_0x589e9e(0xcf)](constants_1[_0x589e9e(0x10c)],this[_0x589e9e(0x124)][_0x589e9e(0xc8)],{'Name':(0x0,shortid_1[_0x589e9e(0xee)])()});const _0x1cacee=await this['salesforceService'][_0x589e9e(0x123)](this['commitData'][_0x589e9e(0xc8)])[_0x589e9e(0x125)](_0x39e5e9=>_0x39e5e9[_0x589e9e(0x11e)]('\x20')[_0x589e9e(0x122)](_0x4433ad=>_0x4433ad['trim']()));await this[_0x589e9e(0x111)][_0x589e9e(0xd6)](this['commitData']['commitAttachmentId']);const _0x345ac1=new salesforce_retriever_service_1[(_0x589e9e(0x11b))](this['salesforceService']);return await _0x345ac1[_0x589e9e(0xe2)](_0x1cacee);}async['getComponentsToDelete'](){const _0x3faf4c=a105_0xcdb1b3;if(!this[_0x3faf4c(0x124)][_0x3faf4c(0xdf)])return[];await this['salesforceService'][_0x3faf4c(0xcf)](constants_1['FLOSUM_ATTACHMENT'],this['commitData'][_0x3faf4c(0xdf)],{'Name':(0x0,shortid_1['default'])()});const _0xbc31cb=await this[_0x3faf4c(0x111)][_0x3faf4c(0x123)](this[_0x3faf4c(0x124)][_0x3faf4c(0xdf)]);return await this[_0x3faf4c(0x111)][_0x3faf4c(0xd6)](this[_0x3faf4c(0x124)][_0x3faf4c(0xdf)]),_0xbc31cb;}async[a105_0xcdb1b3(0x116)](){const _0xbb8ba2=a105_0xcdb1b3,_0x21d753=new commit_components_dto_1['CommitComponentsDto'](),[_0x1a17cd,_0x169393]=await Promise[_0xbb8ba2(0xbe)]([this['getComponentsToWrite'](),this[_0xbb8ba2(0x107)]()]);return _0x21d753[_0xbb8ba2(0x11f)]=this[_0xbb8ba2(0x124)][_0xbb8ba2(0x11f)],_0x21d753['user']=this[_0xbb8ba2(0x124)][_0xbb8ba2(0xed)],_0x21d753[_0xbb8ba2(0xfa)]={'writed':_0x1a17cd,'deleted':_0x169393},_0x21d753['convertToSFDX']=this[_0xbb8ba2(0xcb)][_0xbb8ba2(0xd2)],_0x21d753[_0xbb8ba2(0xd1)]=this[_0xbb8ba2(0xd7)],_0x21d753[_0xbb8ba2(0xd3)]=this[_0xbb8ba2(0xd3)],_0x21d753['provider']=this['config']['gitProvider'],_0x21d753;}async['updateLastCommit'](_0x5c49ce=![]){const _0x543835=a105_0xcdb1b3;if(_0x5c49ce)await this[_0x543835(0xca)][_0x543835(0x114)](this[_0x543835(0xd9)],{});else{const _0x2a67bd=await this[_0x543835(0xd7)][_0x543835(0x109)][_0x543835(0xdc)](this['branch'][_0x543835(0x115)]);this['sfLogger'][_0x543835(0xd8)](this['prefix']+_0x543835(0x11c));const _0xf10b9f={[this[_0x543835(0xd7)][_0x543835(0xdb)]]:{'lastCommit':_0x2a67bd[_0x543835(0x103)]}};await this['salesforceSync']['updateRemoteState'](this[_0x543835(0xd9)],_0xf10b9f);}}async[a105_0xcdb1b3(0xc1)](){const _0x56fe50=a105_0xcdb1b3,_0x4dc4e9=await this[_0x56fe50(0x116)]();await this[_0x56fe50(0xca)]['setStatus'](this[_0x56fe50(0xd9)],'In\x20Progress'),await this[_0x56fe50(0x110)][_0x56fe50(0xe2)](_0x4dc4e9,this[_0x56fe50(0xf9)]),await this[_0x56fe50(0x118)](),await this[_0x56fe50(0xca)][_0x56fe50(0xf2)](this[_0x56fe50(0xd9)],_0x56fe50(0xdd));}async['handleCommitJobError'](_0x3aa362){const _0x4439a2=a105_0xcdb1b3;try{this[_0x4439a2(0xf8)][_0x4439a2(0x11a)](''+_0x3aa362),await this[_0x4439a2(0xf8)]['send'](),await this[_0x4439a2(0x118)](!![]),await this[_0x4439a2(0xca)][_0x4439a2(0xf2)](this[_0x4439a2(0xd9)],_0x4439a2(0x100));}catch(_0x4be7f1){this['logger'][_0x4439a2(0x11a)](_0x4be7f1);}}async[a105_0xcdb1b3(0xe2)](_0x1e58e7){const _0x373db9=a105_0xcdb1b3;try{this['commitData']=_0x1e58e7,this['gitApiService']=typedi_1['Container'][_0x373db9(0xf5)](providers_tokens_1[_0x373db9(0xe7)][_0x373db9(0xeb)]),this[_0x373db9(0x10a)]=typedi_1[_0x373db9(0x101)][_0x373db9(0xf5)](providers_tokens_1[_0x373db9(0xe7)][_0x373db9(0xbf)]),this['config']=typedi_1['Container'][_0x373db9(0xf5)](providers_tokens_1[_0x373db9(0xe7)][_0x373db9(0xcb)]),await this['fetchRepositoryData'](),this[_0x373db9(0xd7)]=await this[_0x373db9(0x10a)][_0x373db9(0xdc)](this[_0x373db9(0xd9)][_0x373db9(0x10e)]),this[_0x373db9(0xd3)]=await this[_0x373db9(0xd7)][_0x373db9(0x109)][_0x373db9(0xdc)](this['repositoryData'][_0x373db9(0xc4)]),this[_0x373db9(0xf8)]=typedi_1[_0x373db9(0x101)][_0x373db9(0xf5)](providers_tokens_1[_0x373db9(0xe7)][_0x373db9(0xe4)]),this[_0x373db9(0xf9)]=_0x373db9(0x106)+this[_0x373db9(0xcb)]['gitProvider'][_0x373db9(0xe8)]()+_0x373db9(0xc9)+this['repositoryData']['repositoryName']+_0x373db9(0xda)+this[_0x373db9(0xd9)][_0x373db9(0xc4)]+_0x373db9(0xde)+FlosumCommitJob_1[_0x373db9(0x115)]+']';if(!this[_0x373db9(0xd9)])throw new bad_request_error_1['BadRequestError'](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this[_0x373db9(0xf8)]['log'](this[_0x373db9(0xf9)]+_0x373db9(0xfc))[_0x373db9(0xc2)](),await this['exec']()[_0x373db9(0xf0)](_0x4158b3=>this[_0x373db9(0xf7)](_0x4158b3));}catch(_0x3dba84){this['commitData']=undefined,this['logger'][_0x373db9(0x11a)](_0x3dba84);throw _0x3dba84;}}};function a105_0x5467(_0x1173d2,_0x584338){const _0x59cba2=a105_0x23ed();return a105_0x5467=function(_0x5b87e3,_0x3ddcc8){_0x5b87e3=_0x5b87e3-0xbc;let _0x23ed2f=_0x59cba2[_0x5b87e3];return _0x23ed2f;},a105_0x5467(_0x1173d2,_0x584338);}FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a105_0xcdb1b3(0xbc)])({'transient':!![]}),__metadata(a105_0xcdb1b3(0x121),[salesforce_service_1[a105_0xcdb1b3(0xfe)],commit_components_job_1[a105_0xcdb1b3(0xef)],salesforce_sync_service_1[a105_0xcdb1b3(0xe0)]])],FlosumCommitJob),exports[a105_0xcdb1b3(0xf3)]=FlosumCommitJob;