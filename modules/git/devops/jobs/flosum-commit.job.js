function a107_0x4df0(_0xd71f88,_0xce27d2){const _0x8199f8=a107_0x1433();return a107_0x4df0=function(_0xf607f7,_0x2a72c0){_0xf607f7=_0xf607f7-0x1be;let _0x14333e=_0x8199f8[_0xf607f7];return _0x14333e;},a107_0x4df0(_0xd71f88,_0xce27d2);}const a107_0x40a81f=a107_0x4df0;(function(_0x24a5dd,_0x566cdc){const _0x5656d5=a107_0x4df0,_0x246ea6=_0x24a5dd();while(!![]){try{const _0x11ddd0=parseInt(_0x5656d5(0x213))/0x1*(-parseInt(_0x5656d5(0x1df))/0x2)+parseInt(_0x5656d5(0x214))/0x3*(parseInt(_0x5656d5(0x1f6))/0x4)+-parseInt(_0x5656d5(0x1d8))/0x5*(-parseInt(_0x5656d5(0x1c1))/0x6)+-parseInt(_0x5656d5(0x1e2))/0x7+parseInt(_0x5656d5(0x1e1))/0x8*(-parseInt(_0x5656d5(0x1f7))/0x9)+-parseInt(_0x5656d5(0x1d3))/0xa+-parseInt(_0x5656d5(0x21d))/0xb*(-parseInt(_0x5656d5(0x20b))/0xc);if(_0x11ddd0===_0x566cdc)break;else _0x246ea6['push'](_0x246ea6['shift']());}catch(_0xf7db25){_0x246ea6['push'](_0x246ea6['shift']());}}}(a107_0x1433,0xec546));const a107_0x2a72c0=(function(){let _0x343418=!![];return function(_0x54b01a,_0x2fa029){const _0x153b14=_0x343418?function(){const _0x17cbd0=a107_0x4df0;if(_0x2fa029){const _0x5151a9=_0x2fa029[_0x17cbd0(0x1f8)](_0x54b01a,arguments);return _0x2fa029=null,_0x5151a9;}}:function(){};return _0x343418=![],_0x153b14;};}()),a107_0xf607f7=a107_0x2a72c0(this,function(){const _0x5267cc=a107_0x4df0;return a107_0xf607f7['toString']()['search'](_0x5267cc(0x20f))[_0x5267cc(0x1e0)]()['constructor'](a107_0xf607f7)['search'](_0x5267cc(0x20f));});a107_0xf607f7();'use strict';var __decorate=this&&this[a107_0x40a81f(0x222)]||function(_0x7eeda1,_0x30fcf9,_0x1bbe0b,_0x394cdb){const _0x5d56d1=a107_0x40a81f;var _0x3a2b2c=arguments[_0x5d56d1(0x1d1)],_0x5ac098=_0x3a2b2c<0x3?_0x30fcf9:_0x394cdb===null?_0x394cdb=Object[_0x5d56d1(0x1e9)](_0x30fcf9,_0x1bbe0b):_0x394cdb,_0x352ce5;if(typeof Reflect===_0x5d56d1(0x20d)&&typeof Reflect[_0x5d56d1(0x1dc)]===_0x5d56d1(0x227))_0x5ac098=Reflect[_0x5d56d1(0x1dc)](_0x7eeda1,_0x30fcf9,_0x1bbe0b,_0x394cdb);else{for(var _0x1c1ab7=_0x7eeda1['length']-0x1;_0x1c1ab7>=0x0;_0x1c1ab7--)if(_0x352ce5=_0x7eeda1[_0x1c1ab7])_0x5ac098=(_0x3a2b2c<0x3?_0x352ce5(_0x5ac098):_0x3a2b2c>0x3?_0x352ce5(_0x30fcf9,_0x1bbe0b,_0x5ac098):_0x352ce5(_0x30fcf9,_0x1bbe0b))||_0x5ac098;}return _0x3a2b2c>0x3&&_0x5ac098&&Object['defineProperty'](_0x30fcf9,_0x1bbe0b,_0x5ac098),_0x5ac098;},__metadata=this&&this[a107_0x40a81f(0x20c)]||function(_0x728198,_0x2ad6b6){const _0x198bdf=a107_0x40a81f;if(typeof Reflect===_0x198bdf(0x20d)&&typeof Reflect['metadata']==='function')return Reflect[_0x198bdf(0x1f3)](_0x728198,_0x2ad6b6);},__importDefault=this&&this[a107_0x40a81f(0x1f4)]||function(_0x27af6f){const _0x55651d=a107_0x40a81f;return _0x27af6f&&_0x27af6f[_0x55651d(0x20e)]?_0x27af6f:{'default':_0x27af6f};},FlosumCommitJob_1;Object['defineProperty'](exports,a107_0x40a81f(0x20e),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;const core_1=require(a107_0x40a81f(0x21c)),salesforce_service_1=require(a107_0x40a81f(0x207)),typedi_1=require(a107_0x40a81f(0x1c0)),errors_1=require(a107_0x40a81f(0x223)),bad_request_error_1=require(a107_0x40a81f(0x21b)),salesforce_retriever_service_1=require(a107_0x40a81f(0x1d4)),salesforce_sync_service_1=require(a107_0x40a81f(0x228)),commit_components_dto_1=require(a107_0x40a81f(0x210)),commit_components_job_1=require(a107_0x40a81f(0x1da)),constants_1=require(a107_0x40a81f(0x1be)),shortid_1=__importDefault(require('shortid')),providers_tokens_1=require(a107_0x40a81f(0x1ca));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x3ade08,_0x29e6ae,_0xe81292){const _0x492c4e=a107_0x40a81f;this[_0x492c4e(0x1c4)]=_0x3ade08,this[_0x492c4e(0x1e7)]=_0x29e6ae,this[_0x492c4e(0x1cc)]=_0xe81292,this['logger']=new core_1[(_0x492c4e(0x1ef))](FlosumCommitJob_1['name']);}async['fetchRepositoryData'](){const _0x37bdab=a107_0x40a81f;try{if(this[_0x37bdab(0x200)][_0x37bdab(0x1fd)])this[_0x37bdab(0x1d6)]=await this[_0x37bdab(0x1cc)][_0x37bdab(0x20a)](this[_0x37bdab(0x200)][_0x37bdab(0x1fd)]);else this[_0x37bdab(0x200)]['syncBranchId']&&(this[_0x37bdab(0x1d6)]=await this['salesforceSync']['getBranchRecord'](this[_0x37bdab(0x200)][_0x37bdab(0x1f9)]));}catch(_0x43c730){throw new bad_request_error_1[(_0x37bdab(0x1ce))](errors_1[_0x37bdab(0x1fb)]);}}async['getComponentsToWrite'](){const _0x54da8b=a107_0x40a81f;if(!this[_0x54da8b(0x200)][_0x54da8b(0x201)])return[];await this[_0x54da8b(0x1c4)][_0x54da8b(0x225)](constants_1[_0x54da8b(0x203)],this[_0x54da8b(0x200)][_0x54da8b(0x201)],{'Name':(0x0,shortid_1[_0x54da8b(0x215)])()});const _0x215e2a=await this['salesforceService'][_0x54da8b(0x218)](this[_0x54da8b(0x200)][_0x54da8b(0x201)])[_0x54da8b(0x1c7)](_0x57ff49=>_0x57ff49[_0x54da8b(0x204)]('\x20')[_0x54da8b(0x1cd)](_0x419738=>_0x419738[_0x54da8b(0x1c8)]()));await this[_0x54da8b(0x1c4)][_0x54da8b(0x21a)](this[_0x54da8b(0x200)][_0x54da8b(0x201)]);const _0x210968=new salesforce_retriever_service_1[(_0x54da8b(0x1d2))](this[_0x54da8b(0x1c4)]);return await _0x210968[_0x54da8b(0x22c)](_0x215e2a);}async[a107_0x40a81f(0x220)](){const _0x3e3660=a107_0x40a81f;if(!this['commitData'][_0x3e3660(0x1c3)])return[];await this['salesforceService']['patchObject'](constants_1['FLOSUM_ATTACHMENT'],this[_0x3e3660(0x200)][_0x3e3660(0x1c3)],{'Name':(0x0,shortid_1[_0x3e3660(0x215)])()});const _0x33da5f=await this[_0x3e3660(0x1c4)][_0x3e3660(0x218)](this[_0x3e3660(0x200)][_0x3e3660(0x1c3)]),_0x4a2134=JSON[_0x3e3660(0x1d9)](_0x33da5f);return await this[_0x3e3660(0x1c4)][_0x3e3660(0x21a)](this[_0x3e3660(0x200)][_0x3e3660(0x1c3)]),_0x4a2134;}async['getCommitDto'](){const _0x4f4a9f=a107_0x40a81f,_0x4546e0=new commit_components_dto_1[(_0x4f4a9f(0x1f2))](),[_0x5f49c6,_0xb3c3c3]=await Promise['all']([this[_0x4f4a9f(0x1e8)](),this[_0x4f4a9f(0x220)]()]);return _0x4546e0['message']=this[_0x4f4a9f(0x200)]['message'],_0x4546e0['user']=this[_0x4f4a9f(0x200)][_0x4f4a9f(0x22b)],_0x4546e0[_0x4f4a9f(0x202)]={'writed':_0x5f49c6,'deleted':_0xb3c3c3},_0x4546e0[_0x4f4a9f(0x1c9)]=this[_0x4f4a9f(0x212)][_0x4f4a9f(0x224)],_0x4546e0['repo']=this[_0x4f4a9f(0x1fa)],_0x4546e0[_0x4f4a9f(0x1c6)]=this['branch'],_0x4546e0[_0x4f4a9f(0x1f5)]=this[_0x4f4a9f(0x212)][_0x4f4a9f(0x209)],_0x4546e0[_0x4f4a9f(0x1e5)]=this['repositoryData'][_0x4f4a9f(0x1c5)],_0x4546e0;}async[a107_0x40a81f(0x1ec)](_0x9c36ec=![]){const _0x3cf825=a107_0x40a81f;if(_0x9c36ec)await this['salesforceSync']['updateRemoteState'](this[_0x3cf825(0x1d6)],{});else{const _0xa38c1f=await this['repository'][_0x3cf825(0x1de)]['getOne'](this[_0x3cf825(0x1c6)][_0x3cf825(0x211)]);this['sfLogger'][_0x3cf825(0x229)](this['prefix']+_0x3cf825(0x1d0));const _0x49e0c3={[this['repository']['gitUrl']]:{'lastCommit':_0xa38c1f['sha']}};await this[_0x3cf825(0x1cc)][_0x3cf825(0x1e6)](this[_0x3cf825(0x1d6)],_0x49e0c3);}}async[a107_0x40a81f(0x1ed)](){const _0x48f9ac=a107_0x40a81f,_0x3933b2=await this[_0x48f9ac(0x1c2)]();await this[_0x48f9ac(0x1cc)][_0x48f9ac(0x1fe)](this['repositoryData'],_0x48f9ac(0x22a)),await this[_0x48f9ac(0x1e7)][_0x48f9ac(0x22c)](_0x3933b2,this[_0x48f9ac(0x1cf)]),await this[_0x48f9ac(0x1ec)](),await this[_0x48f9ac(0x1cc)]['setStatus'](this['repositoryData'],_0x48f9ac(0x206));}async[a107_0x40a81f(0x22d)](_0x136bd6){const _0x186d51=a107_0x40a81f;try{this[_0x186d51(0x221)][_0x186d51(0x1db)](''+_0x136bd6),await this[_0x186d51(0x221)][_0x186d51(0x217)](),await this[_0x186d51(0x1ec)](!![]),await this['salesforceSync']['setStatus'](this[_0x186d51(0x1d6)],_0x186d51(0x1eb));}catch(_0x25c4c0){this['logger']['error'](_0x25c4c0);}}async[a107_0x40a81f(0x22c)](_0x58cff8){const _0x1d99a7=a107_0x40a81f;try{this[_0x1d99a7(0x200)]=_0x58cff8,this['gitApiService']=typedi_1[_0x1d99a7(0x1f1)][_0x1d99a7(0x226)](providers_tokens_1[_0x1d99a7(0x219)][_0x1d99a7(0x1bf)]),this[_0x1d99a7(0x21f)]=typedi_1[_0x1d99a7(0x1f1)][_0x1d99a7(0x226)](providers_tokens_1[_0x1d99a7(0x219)]['gitRepoService']),this[_0x1d99a7(0x212)]=typedi_1[_0x1d99a7(0x1f1)]['get'](providers_tokens_1[_0x1d99a7(0x219)][_0x1d99a7(0x212)]),await this[_0x1d99a7(0x1e3)](),this[_0x1d99a7(0x1fa)]=await this['repoService'][_0x1d99a7(0x1cb)](this[_0x1d99a7(0x1d6)][_0x1d99a7(0x1fc)]),this[_0x1d99a7(0x1c6)]=await this[_0x1d99a7(0x1fa)]['branches'][_0x1d99a7(0x1cb)](this[_0x1d99a7(0x1d6)][_0x1d99a7(0x208)]),this[_0x1d99a7(0x221)]=typedi_1[_0x1d99a7(0x1f1)][_0x1d99a7(0x226)](providers_tokens_1[_0x1d99a7(0x219)][_0x1d99a7(0x1ee)]),this[_0x1d99a7(0x1cf)]=_0x1d99a7(0x205)+this[_0x1d99a7(0x212)][_0x1d99a7(0x209)][_0x1d99a7(0x21e)]()+_0x1d99a7(0x1e4)+this[_0x1d99a7(0x1d6)][_0x1d99a7(0x1fc)]+']\x20[Branch:\x20'+this['repositoryData'][_0x1d99a7(0x208)]+_0x1d99a7(0x216)+FlosumCommitJob_1[_0x1d99a7(0x211)]+']';if(!this[_0x1d99a7(0x1d6)])throw new bad_request_error_1[(_0x1d99a7(0x1ce))](errors_1[_0x1d99a7(0x1f0)]);await this[_0x1d99a7(0x221)][_0x1d99a7(0x229)](this[_0x1d99a7(0x1cf)]+'\x20Start\x20Flosum\x20commit\x20job.')['send'](),await this[_0x1d99a7(0x1ed)]()['catch'](_0x357bf1=>this[_0x1d99a7(0x22d)](_0x357bf1));}catch(_0x36523b){this[_0x1d99a7(0x200)]=undefined,this[_0x1d99a7(0x1ee)][_0x1d99a7(0x1db)](_0x36523b);throw _0x36523b;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a107_0x40a81f(0x1ea)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a107_0x40a81f(0x1d7)],commit_components_job_1[a107_0x40a81f(0x1dd)],salesforce_sync_service_1[a107_0x40a81f(0x1d5)]])],FlosumCommitJob),exports[a107_0x40a81f(0x1ff)]=FlosumCommitJob;function a107_0x1433(){const _0x464996=['Error','updateLastCommit','exec','logger','Logger','ERR_UNKNOWN_SYNC_RECORD_ID','Container','CommitComponentsDto','metadata','__importDefault','provider','324UtCdOo','180VGbAwk','apply','syncBranchId','repository','ERR_INVALID_SYNC_RECORD_ID','repositoryName','syncRepositoryId','setStatus','FlosumCommitJob','commitData','commitAttachmentId','components','FLOSUM_ATTACHMENT','split','[FLOSUM\x20->\x20GIT]\x20[','Completed','../../salesforce/services/salesforce.service','branchName','gitProvider','getRepositoryRecord','5220srzZtr','__metadata','object','__esModule','(((.+)+)+)+$','../dto/commit-components.dto','name','config','264776Nbimwv','14511mwVboc','default',']\x20[','send','retrieveAttachment','Tokens','deleteAttachment','../../../../core/errors/bad-request.error','../../../../core','94699izFBox','toUpperCase','repoService','getComponentsToDelete','sfLogger','__decorate','../../../../constants/errors','isConvertToSfdx','patchObject','get','function','../../salesforce/services/salesforce-sync.service','log','In\x20Progress','user','run','handleCommitJobError','../../../../constants','gitApiService','typedi','108xvFvfr','getCommitDto','deleteAttachmentId','salesforceService','recordTypeName','branch','then','trim','convertToSFDX','../../providers/providers.tokens','getOne','salesforceSync','map','BadRequestError','prefix','\x20Update\x20remote\x20state.','length','SalesforceRetrieverService','6613990wXnkYd','../../salesforce/services/salesforce-retriever.service','SalesforceSyncService','repositoryData','SalesforceService','293905OjSDQN','parse','./commit-components.job','error','decorate','CommitComponentsJob','branches','6WLGGhs','toString','683728QCbwxS','7432019REiJAR','fetchRepositoryData',']\x20[Repository:\x20','recordType','updateRemoteState','commitJob','getComponentsToWrite','getOwnPropertyDescriptor','Service'];a107_0x1433=function(){return _0x464996;};return a107_0x1433();}