const a104_0x3e3cc4=a104_0xa362;(function(_0x26f463,_0x2594b3){const _0x4d9184=a104_0xa362,_0xf78866=_0x26f463();while(!![]){try{const _0x323aac=-parseInt(_0x4d9184(0x118))/0x1*(-parseInt(_0x4d9184(0xf6))/0x2)+-parseInt(_0x4d9184(0x10f))/0x3*(parseInt(_0x4d9184(0x14a))/0x4)+-parseInt(_0x4d9184(0xf5))/0x5+parseInt(_0x4d9184(0x142))/0x6*(-parseInt(_0x4d9184(0x126))/0x7)+parseInt(_0x4d9184(0x132))/0x8*(-parseInt(_0x4d9184(0xfb))/0x9)+-parseInt(_0x4d9184(0xed))/0xa*(parseInt(_0x4d9184(0x117))/0xb)+parseInt(_0x4d9184(0x103))/0xc;if(_0x323aac===_0x2594b3)break;else _0xf78866['push'](_0xf78866['shift']());}catch(_0xbc371d){_0xf78866['push'](_0xf78866['shift']());}}}(a104_0x4348,0xe4093));const a104_0x2a3c62=(function(){let _0x2a03ed=!![];return function(_0x3b1841,_0x56ebb3){const _0x43f6f4=_0x2a03ed?function(){const _0x41b8eb=a104_0xa362;if(_0x56ebb3){const _0x102581=_0x56ebb3[_0x41b8eb(0x109)](_0x3b1841,arguments);return _0x56ebb3=null,_0x102581;}}:function(){};return _0x2a03ed=![],_0x43f6f4;};}()),a104_0x13eec7=a104_0x2a3c62(this,function(){const _0x1716bd=a104_0xa362;return a104_0x13eec7['toString']()[_0x1716bd(0xf7)](_0x1716bd(0x13f))['toString']()[_0x1716bd(0x12e)](a104_0x13eec7)[_0x1716bd(0xf7)](_0x1716bd(0x13f));});a104_0x13eec7();'use strict';function a104_0xa362(_0x242e22,_0x2c5f6d){const _0x1e4efd=a104_0x4348();return a104_0xa362=function(_0x13eec7,_0x2a3c62){_0x13eec7=_0x13eec7-0xe1;let _0x434835=_0x1e4efd[_0x13eec7];return _0x434835;},a104_0xa362(_0x242e22,_0x2c5f6d);}function a104_0x4348(){const _0x29307d=['trim','repository','function','sfLogger','error','gitRepoService','branch','design:paramtypes','defineProperty','then','exec','getCommitDto','provider','560jVsmOx','gitApiService','getOwnPropertyDescriptor',']\x20[Repository:\x20','repo','branchName','get','Service','983670VmWPYW','4sopdei','search','commitAttachmentId','handleCommitJobError','SalesforceRetrieverService','2327319lXnCfs','Container','SalesforceService','../../salesforce/services/salesforce-retriever.service','../../providers/providers.tokens','getComponentsToDelete','../../../../constants/errors','syncBranchId','27686844jpdGKN','components','__esModule','log','ERR_UNKNOWN_SYNC_RECORD_ID','logger','apply','FlosumCommitJob','SalesforceSyncService','decorate','sha','all','2268033CApJFx','__metadata','getBranchRecord','gitUrl','getComponentsToWrite','[FLOSUM\x20->\x20GIT]\x20[','prefix','BadRequestError','105017XLnEXu','554804ZFRWAG','config','../../salesforce/services/salesforce.service','commitData','run','CommitComponentsJob','repoService','default','convertToSFDX','getOne','syncRepositoryId','shortid','retrieveAttachment','deleteAttachment','28UBvIti','branches','fetchRepositoryData','FLOSUM_ATTACHMENT','object','gitProvider','getRepositoryRecord','repositoryData','constructor','message','Tokens','updateLastCommit','24uIkUrf','length','name','toUpperCase','Error','\x20Start\x20Flosum\x20commit\x20job.','typedi','../../../../core/errors/bad-request.error','split','ERR_INVALID_SYNC_RECORD_ID','commitJob','salesforceSync','send','(((.+)+)+)+$','updateRemoteState','../../../../core','329490FXBrHn','repositoryName','../../../../constants','salesforceService','isConvertToSfdx','setStatus','__importDefault','deleteAttachmentId','4JNVgnt','patchObject'];a104_0x4348=function(){return _0x29307d;};return a104_0x4348();}var __decorate=this&&this['__decorate']||function(_0x44aa53,_0x1d0e27,_0x42a8d9,_0xa207d4){const _0x436db4=a104_0xa362;var _0x27e5f3=arguments['length'],_0x43670e=_0x27e5f3<0x3?_0x1d0e27:_0xa207d4===null?_0xa207d4=Object[_0x436db4(0xef)](_0x1d0e27,_0x42a8d9):_0xa207d4,_0xf1b3f1;if(typeof Reflect===_0x436db4(0x12a)&&typeof Reflect[_0x436db4(0x10c)]==='function')_0x43670e=Reflect[_0x436db4(0x10c)](_0x44aa53,_0x1d0e27,_0x42a8d9,_0xa207d4);else{for(var _0x363e50=_0x44aa53[_0x436db4(0x133)]-0x1;_0x363e50>=0x0;_0x363e50--)if(_0xf1b3f1=_0x44aa53[_0x363e50])_0x43670e=(_0x27e5f3<0x3?_0xf1b3f1(_0x43670e):_0x27e5f3>0x3?_0xf1b3f1(_0x1d0e27,_0x42a8d9,_0x43670e):_0xf1b3f1(_0x1d0e27,_0x42a8d9))||_0x43670e;}return _0x27e5f3>0x3&&_0x43670e&&Object[_0x436db4(0xe8)](_0x1d0e27,_0x42a8d9,_0x43670e),_0x43670e;},__metadata=this&&this[a104_0x3e3cc4(0x110)]||function(_0x118966,_0x28429c){const _0x5ce0c6=a104_0x3e3cc4;if(typeof Reflect===_0x5ce0c6(0x12a)&&typeof Reflect['metadata']===_0x5ce0c6(0xe2))return Reflect['metadata'](_0x118966,_0x28429c);},__importDefault=this&&this[a104_0x3e3cc4(0x148)]||function(_0x5f19c7){const _0x56de0a=a104_0x3e3cc4;return _0x5f19c7&&_0x5f19c7[_0x56de0a(0x105)]?_0x5f19c7:{'default':_0x5f19c7};},FlosumCommitJob_1;Object[a104_0x3e3cc4(0xe8)](exports,a104_0x3e3cc4(0x105),{'value':!![]}),exports[a104_0x3e3cc4(0x10a)]=void 0x0;const core_1=require(a104_0x3e3cc4(0x141)),salesforce_service_1=require(a104_0x3e3cc4(0x11a)),typedi_1=require(a104_0x3e3cc4(0x138)),errors_1=require(a104_0x3e3cc4(0x101)),bad_request_error_1=require(a104_0x3e3cc4(0x139)),salesforce_retriever_service_1=require(a104_0x3e3cc4(0xfe)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job'),constants_1=require(a104_0x3e3cc4(0x144)),shortid_1=__importDefault(require(a104_0x3e3cc4(0x123))),providers_tokens_1=require(a104_0x3e3cc4(0xff));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x344879,_0x381fb6,_0x48375d){const _0x414732=a104_0x3e3cc4;this['salesforceService']=_0x344879,this['commitJob']=_0x381fb6,this[_0x414732(0x13d)]=_0x48375d,this[_0x414732(0x108)]=new core_1['Logger'](FlosumCommitJob_1[_0x414732(0x134)]);}async[a104_0x3e3cc4(0x128)](){const _0xdaa2e3=a104_0x3e3cc4;try{if(this[_0xdaa2e3(0x11b)][_0xdaa2e3(0x122)])this[_0xdaa2e3(0x12d)]=await this['salesforceSync'][_0xdaa2e3(0x12c)](this[_0xdaa2e3(0x11b)][_0xdaa2e3(0x122)]);else this['commitData'][_0xdaa2e3(0x102)]&&(this[_0xdaa2e3(0x12d)]=await this['salesforceSync'][_0xdaa2e3(0x111)](this['commitData'][_0xdaa2e3(0x102)]));}catch(_0x26f9e0){throw new bad_request_error_1['BadRequestError'](errors_1[_0xdaa2e3(0x13b)]);}}async[a104_0x3e3cc4(0x113)](){const _0x56c346=a104_0x3e3cc4;if(!this[_0x56c346(0x11b)][_0x56c346(0xf8)])return[];await this['salesforceService'][_0x56c346(0x14b)](constants_1[_0x56c346(0x129)],this['commitData'][_0x56c346(0xf8)],{'Name':(0x0,shortid_1[_0x56c346(0x11f)])()});const _0x2186b6=await this[_0x56c346(0x145)][_0x56c346(0x124)](this[_0x56c346(0x11b)]['commitAttachmentId'])[_0x56c346(0xe9)](_0x3b0b28=>_0x3b0b28[_0x56c346(0x13a)]('\x20')['map'](_0x5d0e76=>_0x5d0e76[_0x56c346(0x14c)]()));await this[_0x56c346(0x145)][_0x56c346(0x125)](this[_0x56c346(0x11b)][_0x56c346(0xf8)]);const _0x44f1c6=new salesforce_retriever_service_1[(_0x56c346(0xfa))](this[_0x56c346(0x145)]);return await _0x44f1c6[_0x56c346(0x11c)](_0x2186b6);}async[a104_0x3e3cc4(0x100)](){const _0x40097e=a104_0x3e3cc4;if(!this[_0x40097e(0x11b)][_0x40097e(0x149)])return[];await this[_0x40097e(0x145)][_0x40097e(0x14b)](constants_1[_0x40097e(0x129)],this[_0x40097e(0x11b)][_0x40097e(0x149)],{'Name':(0x0,shortid_1['default'])()});const _0x148f99=await this[_0x40097e(0x145)][_0x40097e(0x124)](this[_0x40097e(0x11b)][_0x40097e(0x149)]);return await this[_0x40097e(0x145)][_0x40097e(0x125)](this[_0x40097e(0x11b)][_0x40097e(0x149)]),_0x148f99;}async[a104_0x3e3cc4(0xeb)](){const _0x164a74=a104_0x3e3cc4,_0x3cae1e=new commit_components_dto_1['CommitComponentsDto'](),[_0x1d63cc,_0x13e427]=await Promise[_0x164a74(0x10e)]([this[_0x164a74(0x113)](),this[_0x164a74(0x100)]()]);return _0x3cae1e[_0x164a74(0x12f)]=this[_0x164a74(0x11b)][_0x164a74(0x12f)],_0x3cae1e['user']=this[_0x164a74(0x11b)]['user'],_0x3cae1e[_0x164a74(0x104)]={'writed':_0x1d63cc,'deleted':_0x13e427},_0x3cae1e[_0x164a74(0x120)]=this[_0x164a74(0x119)][_0x164a74(0x146)],_0x3cae1e[_0x164a74(0xf1)]=this[_0x164a74(0xe1)],_0x3cae1e[_0x164a74(0xe6)]=this['branch'],_0x3cae1e[_0x164a74(0xec)]=this[_0x164a74(0x119)]['gitProvider'],_0x3cae1e;}async['updateLastCommit'](_0xe6f359=![]){const _0x3c3fb9=a104_0x3e3cc4;if(_0xe6f359)await this[_0x3c3fb9(0x13d)][_0x3c3fb9(0x140)](this[_0x3c3fb9(0x12d)],{});else{const _0x196a56=await this[_0x3c3fb9(0xe1)][_0x3c3fb9(0x127)]['getOne'](this[_0x3c3fb9(0xe6)]['name']);this[_0x3c3fb9(0xe3)][_0x3c3fb9(0x106)](this[_0x3c3fb9(0x115)]+'\x20Update\x20remote\x20state.');const _0x53519e={[this[_0x3c3fb9(0xe1)][_0x3c3fb9(0x112)]]:{'lastCommit':_0x196a56[_0x3c3fb9(0x10d)]}};await this['salesforceSync']['updateRemoteState'](this['repositoryData'],_0x53519e);}}async[a104_0x3e3cc4(0xea)](){const _0x21a470=a104_0x3e3cc4,_0x30344e=await this[_0x21a470(0xeb)]();await this[_0x21a470(0x13d)][_0x21a470(0x147)](this[_0x21a470(0x12d)],'In\x20Progress'),await this[_0x21a470(0x13c)][_0x21a470(0x11c)](_0x30344e,this[_0x21a470(0x115)]),await this['updateLastCommit'](),await this[_0x21a470(0x13d)][_0x21a470(0x147)](this['repositoryData'],'Completed');}async[a104_0x3e3cc4(0xf9)](_0x2dc440){const _0x15d7a4=a104_0x3e3cc4;try{this['sfLogger'][_0x15d7a4(0xe4)](''+_0x2dc440),await this[_0x15d7a4(0xe3)][_0x15d7a4(0x13e)](),await this[_0x15d7a4(0x131)](!![]),await this[_0x15d7a4(0x13d)][_0x15d7a4(0x147)](this[_0x15d7a4(0x12d)],_0x15d7a4(0x136));}catch(_0x4cbd45){this[_0x15d7a4(0x108)][_0x15d7a4(0xe4)](_0x4cbd45);}}async[a104_0x3e3cc4(0x11c)](_0x5ec595){const _0x5e9df4=a104_0x3e3cc4;try{this[_0x5e9df4(0x11b)]=_0x5ec595,this[_0x5e9df4(0xee)]=typedi_1['Container'][_0x5e9df4(0xf3)](providers_tokens_1['Tokens'][_0x5e9df4(0xee)]),this[_0x5e9df4(0x11e)]=typedi_1['Container'][_0x5e9df4(0xf3)](providers_tokens_1[_0x5e9df4(0x130)][_0x5e9df4(0xe5)]),this[_0x5e9df4(0x119)]=typedi_1[_0x5e9df4(0xfc)][_0x5e9df4(0xf3)](providers_tokens_1[_0x5e9df4(0x130)]['config']),await this[_0x5e9df4(0x128)](),this[_0x5e9df4(0xe1)]=await this[_0x5e9df4(0x11e)][_0x5e9df4(0x121)](this['repositoryData']['repositoryName']),this[_0x5e9df4(0xe6)]=await this[_0x5e9df4(0xe1)]['branches'][_0x5e9df4(0x121)](this[_0x5e9df4(0x12d)][_0x5e9df4(0xf2)]),this[_0x5e9df4(0xe3)]=typedi_1[_0x5e9df4(0xfc)][_0x5e9df4(0xf3)](providers_tokens_1[_0x5e9df4(0x130)]['logger']),this[_0x5e9df4(0x115)]=_0x5e9df4(0x114)+this[_0x5e9df4(0x119)][_0x5e9df4(0x12b)][_0x5e9df4(0x135)]()+_0x5e9df4(0xf0)+this[_0x5e9df4(0x12d)][_0x5e9df4(0x143)]+']\x20[Branch:\x20'+this[_0x5e9df4(0x12d)][_0x5e9df4(0xf2)]+']\x20['+FlosumCommitJob_1[_0x5e9df4(0x134)]+']';if(!this[_0x5e9df4(0x12d)])throw new bad_request_error_1[(_0x5e9df4(0x116))](errors_1[_0x5e9df4(0x107)]);await this[_0x5e9df4(0xe3)][_0x5e9df4(0x106)](this[_0x5e9df4(0x115)]+_0x5e9df4(0x137))[_0x5e9df4(0x13e)](),await this['exec']()['catch'](_0x4d1c0b=>this[_0x5e9df4(0xf9)](_0x4d1c0b));}catch(_0xc4f7a4){this[_0x5e9df4(0x11b)]=undefined,this[_0x5e9df4(0x108)][_0x5e9df4(0xe4)](_0xc4f7a4);throw _0xc4f7a4;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a104_0x3e3cc4(0xf4)])({'transient':!![]}),__metadata(a104_0x3e3cc4(0xe7),[salesforce_service_1[a104_0x3e3cc4(0xfd)],commit_components_job_1[a104_0x3e3cc4(0x11d)],salesforce_sync_service_1[a104_0x3e3cc4(0x10b)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;