const a124_0x4fdd03=a124_0x4f7a;function a124_0x4682(){const _0x24c524=['deleteAttachmentId','gitUrl','split','deleteAttachment','Service','9yIstcU','FLOSUM_ATTACHMENT','../../notifications/commit-to-git-error.notification','config',']\x20[','decorate','patchObject','convertToSFDX','provider','gitRepoService','syncRepositoryId','all','35867400KORNgf','log','\x20Start\x20Flosum\x20commit\x20job.','toUpperCase','505xrIcnZ','handleCommitJobError','map','getRepositoryRecord','getComponentsToWrite','getCommitDto','shortid','updateLastCommit','completeNotification','recordTypeName','toString','setStatus','info','constructor','metadata','salesforceSync','Logger','user','sfLogger','branches','BadRequestError','../../salesforce/services/salesforce-sync.service','get','Tokens','execute','SalesforceSyncService',']\x20[Repository:\x20','syncBranchId','[FLOSUM\x20->\x20GIT]\x20[','email','search','12136vDtGIi','In\x20Progress','11495910avQwMj','errorNotification','../../../../core/errors/bad-request.error','commitAttachmentId','SalesforceService','function','1599304NvyZVF','design:paramtypes','CommitComponentsDto','isConvertToSfdx','952Rodzxc','getComponentsToDelete','11HklYhi','../../salesforce/services/salesforce-retriever.service','defineProperty','exec','../dto/commit-components.dto','getOwnPropertyDescriptor','Completed','27fRfxLJ','__metadata','isEmailNotificationsEnabled','length','repository','object','prefix','repositoryName','ERR_UNKNOWN_SYNC_RECORD_ID','__decorate','repoService','components','../../providers/providers.tokens','../../notifications/commit-to-git-completed.notification','CommitComponentsJob','__esModule','Email\x20notifications\x20are\x20disabled.','branch','12210zsLwzT','FlosumCommitJob','salesforceService','714778rbBzPj','gitApiService','branchName','__importDefault','name','commitJob','logger','(((.+)+)+)+$','Container','commitData','getOne','Error','updateRemoteState','CommitToGitErrorNotification',']\x20[Branch:\x20','typedi','run','send','parse','error','../../salesforce/services/salesforce.service','apply','recordType','gitProvider','1188927vrMjgf','repositoryData','retrieveAttachment'];a124_0x4682=function(){return _0x24c524;};return a124_0x4682();}(function(_0x1fbf8c,_0x165c68){const _0x25b3d2=a124_0x4f7a,_0x1bd958=_0x1fbf8c();while(!![]){try{const _0x1f9486=-parseInt(_0x25b3d2(0x176))/0x1+parseInt(_0x25b3d2(0x15e))/0x2*(-parseInt(_0x25b3d2(0x17e))/0x3)+parseInt(_0x25b3d2(0x1ad))/0x4*(-parseInt(_0x25b3d2(0x18e))/0x5)+parseInt(_0x25b3d2(0x1d4))/0x6*(-parseInt(_0x25b3d2(0x1b9))/0x7)+parseInt(_0x25b3d2(0x1b5))/0x8*(-parseInt(_0x25b3d2(0x1c2))/0x9)+parseInt(_0x25b3d2(0x1af))/0xa+-parseInt(_0x25b3d2(0x1bb))/0xb*(-parseInt(_0x25b3d2(0x18a))/0xc);if(_0x1f9486===_0x165c68)break;else _0x1bd958['push'](_0x1bd958['shift']());}catch(_0x46e1e8){_0x1bd958['push'](_0x1bd958['shift']());}}}(a124_0x4682,0xa98f2));const a124_0x46bad9=(function(){let _0x1a6615=!![];return function(_0x395947,_0x31349e){const _0x461b1d=_0x1a6615?function(){const _0x3fa250=a124_0x4f7a;if(_0x31349e){const _0x5244b7=_0x31349e[_0x3fa250(0x173)](_0x395947,arguments);return _0x31349e=null,_0x5244b7;}}:function(){};return _0x1a6615=![],_0x461b1d;};}()),a124_0x16eb0e=a124_0x46bad9(this,function(){const _0x3c37bd=a124_0x4f7a;return a124_0x16eb0e['toString']()[_0x3c37bd(0x1ac)]('(((.+)+)+)+$')[_0x3c37bd(0x198)]()[_0x3c37bd(0x19b)](a124_0x16eb0e)[_0x3c37bd(0x1ac)](_0x3c37bd(0x165));});a124_0x16eb0e();'use strict';function a124_0x4f7a(_0x250461,_0x58a83c){const _0x33b60c=a124_0x4682();return a124_0x4f7a=function(_0x16eb0e,_0x46bad9){_0x16eb0e=_0x16eb0e-0x15d;let _0x4682fb=_0x33b60c[_0x16eb0e];return _0x4682fb;},a124_0x4f7a(_0x250461,_0x58a83c);}var __decorate=this&&this[a124_0x4fdd03(0x1cb)]||function(_0x231963,_0x5c8590,_0x2c6937,_0x59988d){const _0x47b85d=a124_0x4fdd03;var _0x17c568=arguments['length'],_0x3376af=_0x17c568<0x3?_0x5c8590:_0x59988d===null?_0x59988d=Object[_0x47b85d(0x1c0)](_0x5c8590,_0x2c6937):_0x59988d,_0x4b2709;if(typeof Reflect===_0x47b85d(0x1c7)&&typeof Reflect['decorate']===_0x47b85d(0x1b4))_0x3376af=Reflect[_0x47b85d(0x183)](_0x231963,_0x5c8590,_0x2c6937,_0x59988d);else{for(var _0x4adbe6=_0x231963[_0x47b85d(0x1c5)]-0x1;_0x4adbe6>=0x0;_0x4adbe6--)if(_0x4b2709=_0x231963[_0x4adbe6])_0x3376af=(_0x17c568<0x3?_0x4b2709(_0x3376af):_0x17c568>0x3?_0x4b2709(_0x5c8590,_0x2c6937,_0x3376af):_0x4b2709(_0x5c8590,_0x2c6937))||_0x3376af;}return _0x17c568>0x3&&_0x3376af&&Object[_0x47b85d(0x1bd)](_0x5c8590,_0x2c6937,_0x3376af),_0x3376af;},__metadata=this&&this[a124_0x4fdd03(0x1c3)]||function(_0x19ae43,_0x4da8c4){const _0xd6398b=a124_0x4fdd03;if(typeof Reflect===_0xd6398b(0x1c7)&&typeof Reflect[_0xd6398b(0x19c)]===_0xd6398b(0x1b4))return Reflect[_0xd6398b(0x19c)](_0x19ae43,_0x4da8c4);},__importDefault=this&&this[a124_0x4fdd03(0x161)]||function(_0x41cd86){const _0x532d62=a124_0x4fdd03;return _0x41cd86&&_0x41cd86[_0x532d62(0x1d1)]?_0x41cd86:{'default':_0x41cd86};},FlosumCommitJob_1;Object[a124_0x4fdd03(0x1bd)](exports,a124_0x4fdd03(0x1d1),{'value':!![]}),exports[a124_0x4fdd03(0x1d5)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require(a124_0x4fdd03(0x172)),typedi_1=require(a124_0x4fdd03(0x16d)),errors_1=require('../../../../constants/errors'),bad_request_error_1=require(a124_0x4fdd03(0x1b1)),salesforce_retriever_service_1=require(a124_0x4fdd03(0x1bc)),salesforce_sync_service_1=require(a124_0x4fdd03(0x1a3)),commit_components_dto_1=require(a124_0x4fdd03(0x1bf)),commit_components_job_1=require('./commit-components.job'),constants_1=require('../../../../constants'),shortid_1=__importDefault(require(a124_0x4fdd03(0x194))),providers_tokens_1=require(a124_0x4fdd03(0x1ce)),commit_to_git_completed_notification_1=require(a124_0x4fdd03(0x1cf)),commit_to_git_error_notification_1=require(a124_0x4fdd03(0x180));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x44a3e2,_0x173aa2,_0x18ec75){const _0x39a469=a124_0x4fdd03;this[_0x39a469(0x15d)]=_0x44a3e2,this[_0x39a469(0x163)]=_0x173aa2,this['salesforceSync']=_0x18ec75,this['logger']=new core_1[(_0x39a469(0x19e))](FlosumCommitJob_1[_0x39a469(0x162)]);}async['completeNotification'](_0x43c924,_0x4e31fd,_0x2bf066,_0x53d83d){const _0x1c48ef=a124_0x4fdd03;if(!this[_0x1c48ef(0x167)][_0x1c48ef(0x1c4)]){this[_0x1c48ef(0x164)]['info']('Email\x20notifications\x20are\x20disabled.');return;}await new commit_to_git_completed_notification_1['CommitToGitCompletedNotification']({'emails':_0x43c924,'gitProvider':_0x4e31fd,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1['CommitToGitCompletedNotification'][_0x1c48ef(0x162)],'repositoryName':_0x2bf066,'branchName':_0x53d83d})['execute']();}async[a124_0x4fdd03(0x1b0)](_0x49013b,_0xf429ad,_0x84833b,_0x5d8b0d){const _0x3173b8=a124_0x4fdd03;if(!this[_0x3173b8(0x167)][_0x3173b8(0x1c4)]){this[_0x3173b8(0x164)][_0x3173b8(0x19a)](_0x3173b8(0x1d2));return;}await new commit_to_git_error_notification_1[(_0x3173b8(0x16b))]({'emails':_0x49013b,'gitProvider':_0xf429ad,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1['CommitToGitErrorNotification'][_0x3173b8(0x162)],'repositoryName':_0x84833b,'branchName':_0x5d8b0d})[_0x3173b8(0x1a6)]();}async['fetchRepositoryData'](){const _0x50c8fc=a124_0x4fdd03;try{if(this['commitData'][_0x50c8fc(0x188)])this[_0x50c8fc(0x177)]=await this[_0x50c8fc(0x19d)][_0x50c8fc(0x191)](this[_0x50c8fc(0x167)][_0x50c8fc(0x188)]);else this[_0x50c8fc(0x167)][_0x50c8fc(0x1a9)]&&(this[_0x50c8fc(0x177)]=await this['salesforceSync']['getBranchRecord'](this[_0x50c8fc(0x167)]['syncBranchId']));}catch(_0x1f388c){throw new bad_request_error_1['BadRequestError'](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async['getComponentsToWrite'](){const _0x7d1e1a=a124_0x4fdd03;if(!this[_0x7d1e1a(0x167)][_0x7d1e1a(0x1b2)])return[];await this[_0x7d1e1a(0x15d)][_0x7d1e1a(0x184)](constants_1[_0x7d1e1a(0x17f)],this['commitData'][_0x7d1e1a(0x1b2)],{'Name':(0x0,shortid_1['default'])()});const _0x36f81f=await this[_0x7d1e1a(0x15d)]['retrieveAttachment'](this[_0x7d1e1a(0x167)][_0x7d1e1a(0x1b2)])['then'](_0x1ac5c2=>_0x1ac5c2[_0x7d1e1a(0x17b)]('\x20')[_0x7d1e1a(0x190)](_0x5e3c9f=>_0x5e3c9f['trim']()));await this['salesforceService'][_0x7d1e1a(0x17c)](this['commitData'][_0x7d1e1a(0x1b2)]);const _0x10e151=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x7d1e1a(0x15d)]);return await _0x10e151['run'](_0x36f81f);}async[a124_0x4fdd03(0x1ba)](){const _0xe0d308=a124_0x4fdd03;if(!this[_0xe0d308(0x167)][_0xe0d308(0x179)])return[];await this[_0xe0d308(0x15d)][_0xe0d308(0x184)](constants_1[_0xe0d308(0x17f)],this['commitData']['deleteAttachmentId'],{'Name':(0x0,shortid_1['default'])()});const _0x403bf1=await this[_0xe0d308(0x15d)][_0xe0d308(0x178)](this[_0xe0d308(0x167)][_0xe0d308(0x179)]),_0x54ca04=JSON[_0xe0d308(0x170)](_0x403bf1);return await this[_0xe0d308(0x15d)]['deleteAttachment'](this['commitData'][_0xe0d308(0x179)]),_0x54ca04;}async[a124_0x4fdd03(0x193)](){const _0x420f31=a124_0x4fdd03,_0x181a82=new commit_components_dto_1[(_0x420f31(0x1b7))](),[_0x2b01d6,_0xd6ea2b]=await Promise[_0x420f31(0x189)]([this[_0x420f31(0x192)](),this[_0x420f31(0x1ba)]()]);return _0x181a82['message']=this['commitData']['message'],_0x181a82['user']=this['commitData'][_0x420f31(0x19f)],_0x181a82[_0x420f31(0x1cd)]={'writed':_0x2b01d6,'deleted':_0xd6ea2b},_0x181a82[_0x420f31(0x185)]=this['config'][_0x420f31(0x1b8)],_0x181a82['repo']=this[_0x420f31(0x1c6)],_0x181a82['branch']=this[_0x420f31(0x1d3)],_0x181a82[_0x420f31(0x186)]=this[_0x420f31(0x181)][_0x420f31(0x175)],_0x181a82[_0x420f31(0x174)]=this[_0x420f31(0x177)][_0x420f31(0x197)],_0x181a82;}async[a124_0x4fdd03(0x195)](_0x4b4b5e=![]){const _0x125f52=a124_0x4fdd03;if(_0x4b4b5e)await this[_0x125f52(0x19d)][_0x125f52(0x16a)](this[_0x125f52(0x177)],{});else{const _0x5a87fb=await this[_0x125f52(0x1c6)][_0x125f52(0x1a1)][_0x125f52(0x168)](this['branch'][_0x125f52(0x162)]);this[_0x125f52(0x1a0)][_0x125f52(0x18b)](this[_0x125f52(0x1c8)]+'\x20Update\x20remote\x20state.');const _0x265d11={[this[_0x125f52(0x1c6)][_0x125f52(0x17a)]]:{'lastCommit':_0x5a87fb['sha']}};await this[_0x125f52(0x19d)][_0x125f52(0x16a)](this['repositoryData'],_0x265d11);}}async[a124_0x4fdd03(0x1be)](){const _0x5d186e=a124_0x4fdd03,_0x5cc478=await this['getCommitDto']();await this[_0x5d186e(0x19d)][_0x5d186e(0x199)](this[_0x5d186e(0x177)],_0x5d186e(0x1ae)),await this[_0x5d186e(0x163)][_0x5d186e(0x16e)](_0x5cc478,this[_0x5d186e(0x1c8)]),await this[_0x5d186e(0x195)](),await this[_0x5d186e(0x19d)][_0x5d186e(0x199)](this[_0x5d186e(0x177)],_0x5d186e(0x1c1));}async[a124_0x4fdd03(0x18f)](_0x243366){const _0x3f2705=a124_0x4fdd03;try{this[_0x3f2705(0x1a0)][_0x3f2705(0x171)](''+_0x243366),await this[_0x3f2705(0x1a0)][_0x3f2705(0x16f)](),await this[_0x3f2705(0x195)](!![]),await this['salesforceSync'][_0x3f2705(0x199)](this[_0x3f2705(0x177)],_0x3f2705(0x169)),await this[_0x3f2705(0x196)]([this[_0x3f2705(0x167)][_0x3f2705(0x19f)][_0x3f2705(0x1ab)]],this[_0x3f2705(0x181)]['gitProvider'],this[_0x3f2705(0x1c6)][_0x3f2705(0x162)],this['branch'][_0x3f2705(0x162)]);}catch(_0x374236){this[_0x3f2705(0x164)][_0x3f2705(0x171)](_0x374236),await this[_0x3f2705(0x1b0)]([this[_0x3f2705(0x167)][_0x3f2705(0x19f)][_0x3f2705(0x1ab)]],this[_0x3f2705(0x181)]['gitProvider'],this[_0x3f2705(0x1c6)]['name'],this['branch'][_0x3f2705(0x162)]);}}async[a124_0x4fdd03(0x16e)](_0x221c23){const _0x397189=a124_0x4fdd03;try{this[_0x397189(0x167)]=_0x221c23,this[_0x397189(0x15f)]=typedi_1[_0x397189(0x166)][_0x397189(0x1a4)](providers_tokens_1['Tokens'][_0x397189(0x15f)]),this[_0x397189(0x1cc)]=typedi_1[_0x397189(0x166)]['get'](providers_tokens_1['Tokens'][_0x397189(0x187)]),this['config']=typedi_1[_0x397189(0x166)]['get'](providers_tokens_1[_0x397189(0x1a5)][_0x397189(0x181)]),await this['fetchRepositoryData'](),this[_0x397189(0x1c6)]=await this[_0x397189(0x1cc)][_0x397189(0x168)](this[_0x397189(0x177)][_0x397189(0x1c9)]),this[_0x397189(0x1d3)]=await this[_0x397189(0x1c6)]['branches'][_0x397189(0x168)](this[_0x397189(0x177)][_0x397189(0x160)]),this[_0x397189(0x1a0)]=typedi_1[_0x397189(0x166)][_0x397189(0x1a4)](providers_tokens_1[_0x397189(0x1a5)][_0x397189(0x164)]),this[_0x397189(0x1c8)]=_0x397189(0x1aa)+this[_0x397189(0x181)][_0x397189(0x175)][_0x397189(0x18d)]()+_0x397189(0x1a8)+this[_0x397189(0x177)][_0x397189(0x1c9)]+_0x397189(0x16c)+this['repositoryData']['branchName']+_0x397189(0x182)+FlosumCommitJob_1[_0x397189(0x162)]+']';if(!this['repositoryData'])throw new bad_request_error_1[(_0x397189(0x1a2))](errors_1[_0x397189(0x1ca)]);await this['sfLogger'][_0x397189(0x18b)](this['prefix']+_0x397189(0x18c))[_0x397189(0x16f)](),await this[_0x397189(0x1be)]()['catch'](_0x4c9d84=>this[_0x397189(0x18f)](_0x4c9d84)),await this[_0x397189(0x196)]([this[_0x397189(0x167)][_0x397189(0x19f)][_0x397189(0x1ab)]],this[_0x397189(0x181)][_0x397189(0x175)],this[_0x397189(0x1c6)][_0x397189(0x162)],this[_0x397189(0x1d3)][_0x397189(0x162)]);}catch(_0x4b2d20){this[_0x397189(0x167)]=undefined,this[_0x397189(0x164)][_0x397189(0x171)](_0x4b2d20),await this[_0x397189(0x1b0)]([this[_0x397189(0x167)][_0x397189(0x19f)][_0x397189(0x1ab)]],this[_0x397189(0x181)][_0x397189(0x175)],this[_0x397189(0x1c6)][_0x397189(0x162)],this[_0x397189(0x1d3)][_0x397189(0x162)]);throw _0x4b2d20;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a124_0x4fdd03(0x17d)])({'transient':!![]}),__metadata(a124_0x4fdd03(0x1b6),[salesforce_service_1[a124_0x4fdd03(0x1b3)],commit_components_job_1[a124_0x4fdd03(0x1d0)],salesforce_sync_service_1[a124_0x4fdd03(0x1a7)]])],FlosumCommitJob),exports[a124_0x4fdd03(0x1d5)]=FlosumCommitJob;