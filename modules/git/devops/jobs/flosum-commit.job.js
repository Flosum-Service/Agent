function a105_0x5edd(_0x25908c,_0x441d4e){const _0x1bbcab=a105_0xcef3();return a105_0x5edd=function(_0x163b07,_0x1675b6){_0x163b07=_0x163b07-0x71;let _0xcef39c=_0x1bbcab[_0x163b07];return _0xcef39c;},a105_0x5edd(_0x25908c,_0x441d4e);}const a105_0x3e501b=a105_0x5edd;(function(_0x1b38d8,_0x167234){const _0x5a8297=a105_0x5edd,_0x397b1a=_0x1b38d8();while(!![]){try{const _0x5080a1=-parseInt(_0x5a8297(0x86))/0x1+parseInt(_0x5a8297(0x90))/0x2+-parseInt(_0x5a8297(0x9e))/0x3+-parseInt(_0x5a8297(0xbc))/0x4+parseInt(_0x5a8297(0xcd))/0x5+-parseInt(_0x5a8297(0x7a))/0x6+parseInt(_0x5a8297(0xbe))/0x7;if(_0x5080a1===_0x167234)break;else _0x397b1a['push'](_0x397b1a['shift']());}catch(_0x587c02){_0x397b1a['push'](_0x397b1a['shift']());}}}(a105_0xcef3,0xc60a5));const a105_0x1675b6=(function(){let _0x2f3ffa=!![];return function(_0x3f1044,_0x3379b7){const _0x2d5073=_0x2f3ffa?function(){if(_0x3379b7){const _0x148358=_0x3379b7['apply'](_0x3f1044,arguments);return _0x3379b7=null,_0x148358;}}:function(){};return _0x2f3ffa=![],_0x2d5073;};}()),a105_0x163b07=a105_0x1675b6(this,function(){const _0x2582b4=a105_0x5edd;return a105_0x163b07[_0x2582b4(0xd8)]()[_0x2582b4(0x98)](_0x2582b4(0x95))['toString']()[_0x2582b4(0xb1)](a105_0x163b07)[_0x2582b4(0x98)](_0x2582b4(0x95));});a105_0x163b07();'use strict';var __decorate=this&&this['__decorate']||function(_0x576b99,_0x742be5,_0x1323d1,_0x386769){const _0x356e22=a105_0x5edd;var _0x19af1c=arguments[_0x356e22(0xac)],_0x1153bc=_0x19af1c<0x3?_0x742be5:_0x386769===null?_0x386769=Object['getOwnPropertyDescriptor'](_0x742be5,_0x1323d1):_0x386769,_0x41429a;if(typeof Reflect===_0x356e22(0x89)&&typeof Reflect[_0x356e22(0xa9)]===_0x356e22(0xc9))_0x1153bc=Reflect[_0x356e22(0xa9)](_0x576b99,_0x742be5,_0x1323d1,_0x386769);else{for(var _0x4ae6c4=_0x576b99[_0x356e22(0xac)]-0x1;_0x4ae6c4>=0x0;_0x4ae6c4--)if(_0x41429a=_0x576b99[_0x4ae6c4])_0x1153bc=(_0x19af1c<0x3?_0x41429a(_0x1153bc):_0x19af1c>0x3?_0x41429a(_0x742be5,_0x1323d1,_0x1153bc):_0x41429a(_0x742be5,_0x1323d1))||_0x1153bc;}return _0x19af1c>0x3&&_0x1153bc&&Object[_0x356e22(0xcb)](_0x742be5,_0x1323d1,_0x1153bc),_0x1153bc;},__metadata=this&&this[a105_0x3e501b(0x7b)]||function(_0x31bf36,_0x367cf1){const _0x1c1034=a105_0x3e501b;if(typeof Reflect===_0x1c1034(0x89)&&typeof Reflect[_0x1c1034(0x79)]===_0x1c1034(0xc9))return Reflect[_0x1c1034(0x79)](_0x31bf36,_0x367cf1);},__importDefault=this&&this[a105_0x3e501b(0x8f)]||function(_0x502278){const _0x3345a2=a105_0x3e501b;return _0x502278&&_0x502278[_0x3345a2(0xa7)]?_0x502278:{'default':_0x502278};},FlosumCommitJob_1;Object[a105_0x3e501b(0xcb)](exports,a105_0x3e501b(0xa7),{'value':!![]}),exports[a105_0x3e501b(0x71)]=void 0x0;const core_1=require(a105_0x3e501b(0xa1)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a105_0x3e501b(0x74)),errors_1=require(a105_0x3e501b(0xd0)),bad_request_error_1=require(a105_0x3e501b(0xc7)),salesforce_retriever_service_1=require(a105_0x3e501b(0xce)),salesforce_sync_service_1=require(a105_0x3e501b(0xb7)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a105_0x3e501b(0xb8)),constants_1=require(a105_0x3e501b(0xa3)),shortid_1=__importDefault(require(a105_0x3e501b(0xad))),providers_tokens_1=require(a105_0x3e501b(0xb0));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x26c58e,_0x3709cf,_0x4954e8){const _0x360905=a105_0x3e501b;this['salesforceService']=_0x26c58e,this[_0x360905(0x7d)]=_0x3709cf,this[_0x360905(0xd7)]=_0x4954e8,this['logger']=new core_1[(_0x360905(0xc1))](FlosumCommitJob_1[_0x360905(0x92)]);}async[a105_0x3e501b(0xb9)](){const _0x1e29d1=a105_0x3e501b;try{if(this[_0x1e29d1(0xc2)]['syncRepositoryId'])this[_0x1e29d1(0xaf)]=await this[_0x1e29d1(0xd7)][_0x1e29d1(0x9b)](this[_0x1e29d1(0xc2)]['syncRepositoryId']);else this[_0x1e29d1(0xc2)][_0x1e29d1(0xc5)]&&(this[_0x1e29d1(0xaf)]=await this['salesforceSync']['getBranchRecord'](this[_0x1e29d1(0xc2)][_0x1e29d1(0xc5)]));}catch(_0x5544f4){throw new bad_request_error_1[(_0x1e29d1(0xc4))](errors_1[_0x1e29d1(0xbb)]);}}async[a105_0x3e501b(0x84)](){const _0x2e83d0=a105_0x3e501b;if(!this[_0x2e83d0(0xc2)][_0x2e83d0(0xae)])return[];await this[_0x2e83d0(0x83)]['patchObject'](constants_1['FLOSUM_ATTACHMENT'],this['commitData'][_0x2e83d0(0xae)],{'Name':(0x0,shortid_1[_0x2e83d0(0x9c)])()});const _0x2cdd7a=await this[_0x2e83d0(0x83)]['retrieveAttachment'](this[_0x2e83d0(0xc2)]['commitAttachmentId'])[_0x2e83d0(0xd2)](_0x313509=>_0x313509['split']('\x20')[_0x2e83d0(0xaa)](_0xb41771=>_0xb41771[_0x2e83d0(0xa6)]()));await this[_0x2e83d0(0x83)][_0x2e83d0(0xc6)](this[_0x2e83d0(0xc2)]['commitAttachmentId']);const _0x420317=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x2e83d0(0x83)]);return await _0x420317[_0x2e83d0(0xba)](_0x2cdd7a);}async[a105_0x3e501b(0x94)](){const _0x2af085=a105_0x3e501b;if(!this[_0x2af085(0xc2)]['deleteAttachmentId'])return[];await this[_0x2af085(0x83)][_0x2af085(0x7c)](constants_1[_0x2af085(0x87)],this['commitData'][_0x2af085(0xc3)],{'Name':(0x0,shortid_1[_0x2af085(0x9c)])()});const _0x6744c2=await this[_0x2af085(0x83)]['retrieveAttachment'](this['commitData'][_0x2af085(0xc3)]);return await this['salesforceService'][_0x2af085(0xc6)](this[_0x2af085(0xc2)]['deleteAttachmentId']),_0x6744c2;}async[a105_0x3e501b(0x72)](){const _0x14be29=a105_0x3e501b,_0x13d511=new commit_components_dto_1[(_0x14be29(0x91))](),[_0x25405e,_0x6d8e4]=await Promise[_0x14be29(0x93)]([this[_0x14be29(0x84)](),this[_0x14be29(0x94)]()]);return _0x13d511[_0x14be29(0x77)]=this[_0x14be29(0xc2)][_0x14be29(0x77)],_0x13d511['user']=this['commitData'][_0x14be29(0x88)],_0x13d511['components']={'writed':_0x25405e,'deleted':_0x6d8e4},_0x13d511[_0x14be29(0x97)]=this[_0x14be29(0xa2)][_0x14be29(0x82)],_0x13d511[_0x14be29(0xab)]=this[_0x14be29(0x75)],_0x13d511[_0x14be29(0xa5)]=this[_0x14be29(0xa5)],_0x13d511['provider']=this[_0x14be29(0xa2)][_0x14be29(0x76)],_0x13d511;}async[a105_0x3e501b(0xb4)](_0x316fa9=![]){const _0x3f6b1b=a105_0x3e501b;if(_0x316fa9)await this[_0x3f6b1b(0xd7)]['updateRemoteState'](this[_0x3f6b1b(0xaf)],{});else{const _0xc4a057=await this[_0x3f6b1b(0x75)]['branches'][_0x3f6b1b(0x78)](this['branch'][_0x3f6b1b(0x92)]);this[_0x3f6b1b(0xcc)][_0x3f6b1b(0x7f)](this['prefix']+_0x3f6b1b(0xc0));const _0x295ed2={[this['repository'][_0x3f6b1b(0x99)]]:{'lastCommit':_0xc4a057[_0x3f6b1b(0x8d)]}};await this[_0x3f6b1b(0xd7)][_0x3f6b1b(0x80)](this['repositoryData'],_0x295ed2);}}async[a105_0x3e501b(0x73)](){const _0x1c25e2=a105_0x3e501b,_0x39bfd6=await this[_0x1c25e2(0x72)]();await this[_0x1c25e2(0xd7)][_0x1c25e2(0xca)](this[_0x1c25e2(0xaf)],_0x1c25e2(0xb3)),await this[_0x1c25e2(0x7d)][_0x1c25e2(0xba)](_0x39bfd6,this[_0x1c25e2(0x8c)]),await this[_0x1c25e2(0xb4)](),await this['salesforceSync'][_0x1c25e2(0xca)](this[_0x1c25e2(0xaf)],_0x1c25e2(0x9f));}async['handleCommitJobError'](_0x3b0262){const _0x462f85=a105_0x3e501b;try{this[_0x462f85(0xcc)][_0x462f85(0xcf)](''+_0x3b0262),await this[_0x462f85(0xcc)][_0x462f85(0x81)](),await this[_0x462f85(0xb4)](!![]),await this[_0x462f85(0xd7)]['setStatus'](this[_0x462f85(0xaf)],'Error');}catch(_0x362eec){this[_0x462f85(0x8e)][_0x462f85(0xcf)](_0x362eec);}}async['run'](_0x52c356){const _0x5d6898=a105_0x3e501b;try{this[_0x5d6898(0xc2)]=_0x52c356,this[_0x5d6898(0xd5)]=typedi_1[_0x5d6898(0x85)][_0x5d6898(0xb2)](providers_tokens_1[_0x5d6898(0x9d)]['gitApiService']),this[_0x5d6898(0xa0)]=typedi_1[_0x5d6898(0x85)][_0x5d6898(0xb2)](providers_tokens_1['Tokens'][_0x5d6898(0xc8)]),this['config']=typedi_1[_0x5d6898(0x85)]['get'](providers_tokens_1[_0x5d6898(0x9d)][_0x5d6898(0xa2)]),await this[_0x5d6898(0xb9)](),this[_0x5d6898(0x75)]=await this[_0x5d6898(0xa0)][_0x5d6898(0x78)](this['repositoryData'][_0x5d6898(0xd1)]),this[_0x5d6898(0xa5)]=await this['repository'][_0x5d6898(0xa4)][_0x5d6898(0x78)](this[_0x5d6898(0xaf)]['branchName']),this[_0x5d6898(0xcc)]=typedi_1['Container']['get'](providers_tokens_1['Tokens']['logger']),this[_0x5d6898(0x8c)]=_0x5d6898(0x8a)+this[_0x5d6898(0xa2)][_0x5d6898(0x76)][_0x5d6898(0xa8)]()+_0x5d6898(0xd6)+this[_0x5d6898(0xaf)]['repositoryName']+_0x5d6898(0x9a)+this[_0x5d6898(0xaf)][_0x5d6898(0x7e)]+_0x5d6898(0x8b)+FlosumCommitJob_1['name']+']';if(!this[_0x5d6898(0xaf)])throw new bad_request_error_1[(_0x5d6898(0xc4))](errors_1[_0x5d6898(0xb6)]);await this[_0x5d6898(0xcc)][_0x5d6898(0x7f)](this[_0x5d6898(0x8c)]+_0x5d6898(0xd4))['send'](),await this[_0x5d6898(0x73)]()[_0x5d6898(0xbd)](_0x2aa800=>this['handleCommitJobError'](_0x2aa800));}catch(_0x1b6fba){this['commitData']=undefined,this[_0x5d6898(0x8e)]['error'](_0x1b6fba);throw _0x1b6fba;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a105_0x3e501b(0xbf)])({'transient':!![]}),__metadata(a105_0x3e501b(0xd3),[salesforce_service_1['SalesforceService'],commit_components_job_1[a105_0x3e501b(0xb5)],salesforce_sync_service_1[a105_0x3e501b(0x96)]])],FlosumCommitJob),exports[a105_0x3e501b(0x71)]=FlosumCommitJob;function a105_0xcef3(){const _0x166af1=['commitData','deleteAttachmentId','BadRequestError','syncBranchId','deleteAttachment','../../../../core/errors/bad-request.error','gitRepoService','function','setStatus','defineProperty','sfLogger','4989155FvSBxU','../../salesforce/services/salesforce-retriever.service','error','../../../../constants/errors','repositoryName','then','design:paramtypes','\x20Start\x20Flosum\x20commit\x20job.','gitApiService',']\x20[Repository:\x20','salesforceSync','toString','FlosumCommitJob','getCommitDto','exec','typedi','repository','gitProvider','message','getOne','metadata','3192504lIHdHH','__metadata','patchObject','commitJob','branchName','log','updateRemoteState','send','isConvertToSfdx','salesforceService','getComponentsToWrite','Container','698555lORFxt','FLOSUM_ATTACHMENT','user','object','[FLOSUM\x20->\x20GIT]\x20[',']\x20[','prefix','sha','logger','__importDefault','2166964iarxSr','CommitComponentsDto','name','all','getComponentsToDelete','(((.+)+)+)+$','SalesforceSyncService','convertToSFDX','search','gitUrl',']\x20[Branch:\x20','getRepositoryRecord','default','Tokens','1560810tdIlRB','Completed','repoService','../../../../core','config','../../../../constants','branches','branch','trim','__esModule','toUpperCase','decorate','map','repo','length','shortid','commitAttachmentId','repositoryData','../../providers/providers.tokens','constructor','get','In\x20Progress','updateLastCommit','CommitComponentsJob','ERR_UNKNOWN_SYNC_RECORD_ID','../../salesforce/services/salesforce-sync.service','./commit-components.job','fetchRepositoryData','run','ERR_INVALID_SYNC_RECORD_ID','276444UsNDYr','catch','3849160mubZQX','Service','\x20Update\x20remote\x20state.','Logger'];a105_0xcef3=function(){return _0x166af1;};return a105_0xcef3();}