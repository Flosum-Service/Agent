const a106_0x571f83=a106_0x4b8b;function a106_0x4b8b(_0x183c67,_0x5062cd){const _0x247fcd=a106_0x38f6();return a106_0x4b8b=function(_0x408494,_0x4a51bc){_0x408494=_0x408494-0x8c;let _0x38f629=_0x247fcd[_0x408494];return _0x38f629;},a106_0x4b8b(_0x183c67,_0x5062cd);}(function(_0x5c6887,_0x40bf3c){const _0x5aa5d7=a106_0x4b8b,_0x4ce088=_0x5c6887();while(!![]){try{const _0x197e53=-parseInt(_0x5aa5d7(0xb9))/0x1*(-parseInt(_0x5aa5d7(0xda))/0x2)+-parseInt(_0x5aa5d7(0xce))/0x3*(-parseInt(_0x5aa5d7(0xfd))/0x4)+-parseInt(_0x5aa5d7(0xf5))/0x5*(parseInt(_0x5aa5d7(0xd5))/0x6)+parseInt(_0x5aa5d7(0xa5))/0x7+-parseInt(_0x5aa5d7(0xdf))/0x8*(parseInt(_0x5aa5d7(0xa6))/0x9)+parseInt(_0x5aa5d7(0xf6))/0xa*(parseInt(_0x5aa5d7(0x97))/0xb)+parseInt(_0x5aa5d7(0xbb))/0xc*(-parseInt(_0x5aa5d7(0xb3))/0xd);if(_0x197e53===_0x40bf3c)break;else _0x4ce088['push'](_0x4ce088['shift']());}catch(_0x4e79bd){_0x4ce088['push'](_0x4ce088['shift']());}}}(a106_0x38f6,0x6b2f7));const a106_0x4a51bc=(function(){let _0x5cc9de=!![];return function(_0x48861b,_0x49b592){const _0x37b196=_0x5cc9de?function(){if(_0x49b592){const _0x3bcd15=_0x49b592['apply'](_0x48861b,arguments);return _0x49b592=null,_0x3bcd15;}}:function(){};return _0x5cc9de=![],_0x37b196;};}()),a106_0x408494=a106_0x4a51bc(this,function(){const _0x179db4=a106_0x4b8b;return a106_0x408494[_0x179db4(0xc0)]()['search'](_0x179db4(0xfb))[_0x179db4(0xc0)]()[_0x179db4(0x9b)](a106_0x408494)[_0x179db4(0xd4)](_0x179db4(0xfb));});a106_0x408494();'use strict';var __decorate=this&&this[a106_0x571f83(0xb4)]||function(_0x1b3ffd,_0xf8ed2a,_0x3c243c,_0x31b51f){const _0x51c095=a106_0x571f83;var _0x2477e3=arguments['length'],_0x5e3f54=_0x2477e3<0x3?_0xf8ed2a:_0x31b51f===null?_0x31b51f=Object[_0x51c095(0xe8)](_0xf8ed2a,_0x3c243c):_0x31b51f,_0x468800;if(typeof Reflect===_0x51c095(0xaa)&&typeof Reflect[_0x51c095(0x9e)]===_0x51c095(0x9a))_0x5e3f54=Reflect['decorate'](_0x1b3ffd,_0xf8ed2a,_0x3c243c,_0x31b51f);else{for(var _0x3c54b6=_0x1b3ffd['length']-0x1;_0x3c54b6>=0x0;_0x3c54b6--)if(_0x468800=_0x1b3ffd[_0x3c54b6])_0x5e3f54=(_0x2477e3<0x3?_0x468800(_0x5e3f54):_0x2477e3>0x3?_0x468800(_0xf8ed2a,_0x3c243c,_0x5e3f54):_0x468800(_0xf8ed2a,_0x3c243c))||_0x5e3f54;}return _0x2477e3>0x3&&_0x5e3f54&&Object[_0x51c095(0xb0)](_0xf8ed2a,_0x3c243c,_0x5e3f54),_0x5e3f54;},__metadata=this&&this[a106_0x571f83(0xc8)]||function(_0x40ed69,_0xbeb88){const _0x2a2cc3=a106_0x571f83;if(typeof Reflect===_0x2a2cc3(0xaa)&&typeof Reflect['metadata']===_0x2a2cc3(0x9a))return Reflect['metadata'](_0x40ed69,_0xbeb88);},__importDefault=this&&this[a106_0x571f83(0x8d)]||function(_0x35dfdb){const _0x39fe84=a106_0x571f83;return _0x35dfdb&&_0x35dfdb[_0x39fe84(0xfa)]?_0x35dfdb:{'default':_0x35dfdb};},FlosumCommitJob_1;function a106_0x38f6(){const _0x5a1ae1=['send','\x20Start\x20Flosum\x20commit\x20job.','sfLogger','message','recordType','branch','trim','provider','3863435RxujSy','257410vZZCza','map','name','all','__esModule','(((.+)+)+)+$','error','6100UrVhtn','salesforceService','__importDefault','../dto/commit-components.dto','repositoryName','commitData','repository','getCommitDto','Service','../../../../constants','setStatus','prefix','187ZUiJtQ','BadRequestError','../../../../constants/errors','function','constructor','then','repositoryData','decorate','gitProvider','Completed','gitApiService','Container','[FLOSUM\x20->\x20GIT]\x20[','convertToSFDX','1880137RICoYl','1903806WDAtdx',']\x20[Branch:\x20','ERR_UNKNOWN_SYNC_RECORD_ID',']\x20[Repository:\x20','object','syncRepositoryId','commitJob','../../../../core/errors/bad-request.error','parse','deleteAttachmentId','defineProperty','components','sha','13ILYWQX','__decorate','getBranchRecord','ERR_INVALID_SYNC_RECORD_ID','repoService','./commit-components.job','791bFOIiZ','run','3461280SBWdrI','logger','deleteAttachment','design:paramtypes','config','toString','handleCommitJobError','exec','split','recordTypeName','updateRemoteState','shortid','fetchRepositoryData','__metadata','SalesforceService','CommitComponentsDto','branchName','typedi','get','1539QhHkMF','../../providers/providers.tokens','gitUrl','SalesforceRetrieverService','commitAttachmentId',']\x20[','search','6FiJeGv','../../salesforce/services/salesforce.service','FLOSUM_ATTACHMENT','log','branches','1634fECdhk','\x20Update\x20remote\x20state.','In\x20Progress','FlosumCommitJob','getOne','24mFCXtM','retrieveAttachment','Error','syncBranchId','default','updateLastCommit','../../../../core','Tokens','getComponentsToWrite','getOwnPropertyDescriptor','salesforceSync','patchObject','getComponentsToDelete','toUpperCase'];a106_0x38f6=function(){return _0x5a1ae1;};return a106_0x38f6();}Object[a106_0x571f83(0xb0)](exports,a106_0x571f83(0xfa),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;const core_1=require(a106_0x571f83(0xe5)),salesforce_service_1=require(a106_0x571f83(0xd6)),typedi_1=require(a106_0x571f83(0xcc)),errors_1=require(a106_0x571f83(0x99)),bad_request_error_1=require(a106_0x571f83(0xad)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require(a106_0x571f83(0x8e)),commit_components_job_1=require(a106_0x571f83(0xb8)),constants_1=require(a106_0x571f83(0x94)),shortid_1=__importDefault(require(a106_0x571f83(0xc6))),providers_tokens_1=require(a106_0x571f83(0xcf));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x52350a,_0x260330,_0x4e990a){const _0x5ea371=a106_0x571f83;this[_0x5ea371(0x8c)]=_0x52350a,this[_0x5ea371(0xac)]=_0x260330,this[_0x5ea371(0xe9)]=_0x4e990a,this['logger']=new core_1['Logger'](FlosumCommitJob_1[_0x5ea371(0xf8)]);}async[a106_0x571f83(0xc7)](){const _0x145bfb=a106_0x571f83;try{if(this[_0x145bfb(0x90)][_0x145bfb(0xab)])this[_0x145bfb(0x9d)]=await this[_0x145bfb(0xe9)]['getRepositoryRecord'](this[_0x145bfb(0x90)][_0x145bfb(0xab)]);else this['commitData'][_0x145bfb(0xe2)]&&(this[_0x145bfb(0x9d)]=await this[_0x145bfb(0xe9)][_0x145bfb(0xb5)](this[_0x145bfb(0x90)][_0x145bfb(0xe2)]));}catch(_0x16663){throw new bad_request_error_1[(_0x145bfb(0x98))](errors_1[_0x145bfb(0xb6)]);}}async[a106_0x571f83(0xe7)](){const _0x40626f=a106_0x571f83;if(!this[_0x40626f(0x90)][_0x40626f(0xd2)])return[];await this['salesforceService']['patchObject'](constants_1['FLOSUM_ATTACHMENT'],this[_0x40626f(0x90)][_0x40626f(0xd2)],{'Name':(0x0,shortid_1[_0x40626f(0xe3)])()});const _0x5017cb=await this[_0x40626f(0x8c)][_0x40626f(0xe0)](this[_0x40626f(0x90)]['commitAttachmentId'])[_0x40626f(0x9c)](_0x1eb70d=>_0x1eb70d[_0x40626f(0xc3)]('\x20')[_0x40626f(0xf7)](_0x15eeac=>_0x15eeac[_0x40626f(0xf3)]()));await this[_0x40626f(0x8c)]['deleteAttachment'](this[_0x40626f(0x90)][_0x40626f(0xd2)]);const _0x5cb933=new salesforce_retriever_service_1[(_0x40626f(0xd1))](this['salesforceService']);return await _0x5cb933[_0x40626f(0xba)](_0x5017cb);}async[a106_0x571f83(0xeb)](){const _0x35684d=a106_0x571f83;if(!this['commitData'][_0x35684d(0xaf)])return[];await this[_0x35684d(0x8c)][_0x35684d(0xea)](constants_1[_0x35684d(0xd7)],this[_0x35684d(0x90)][_0x35684d(0xaf)],{'Name':(0x0,shortid_1['default'])()});const _0x1abbac=await this[_0x35684d(0x8c)][_0x35684d(0xe0)](this[_0x35684d(0x90)]['deleteAttachmentId']),_0x1e6e5b=JSON[_0x35684d(0xae)](_0x1abbac);return await this[_0x35684d(0x8c)][_0x35684d(0xbd)](this[_0x35684d(0x90)]['deleteAttachmentId']),_0x1e6e5b;}async[a106_0x571f83(0x92)](){const _0x4c71ea=a106_0x571f83,_0x28c264=new commit_components_dto_1[(_0x4c71ea(0xca))](),[_0x10e72a,_0x36a0d1]=await Promise[_0x4c71ea(0xf9)]([this['getComponentsToWrite'](),this[_0x4c71ea(0xeb)]()]);return _0x28c264[_0x4c71ea(0xf0)]=this[_0x4c71ea(0x90)]['message'],_0x28c264['user']=this[_0x4c71ea(0x90)]['user'],_0x28c264[_0x4c71ea(0xb1)]={'writed':_0x10e72a,'deleted':_0x36a0d1},_0x28c264[_0x4c71ea(0xa4)]=this['config']['isConvertToSfdx'],_0x28c264['repo']=this[_0x4c71ea(0x91)],_0x28c264[_0x4c71ea(0xf2)]=this[_0x4c71ea(0xf2)],_0x28c264[_0x4c71ea(0xf4)]=this[_0x4c71ea(0xbf)][_0x4c71ea(0x9f)],_0x28c264[_0x4c71ea(0xf1)]=this['repositoryData'][_0x4c71ea(0xc4)],_0x28c264;}async[a106_0x571f83(0xe4)](_0x5786ff=![]){const _0x357aa2=a106_0x571f83;if(_0x5786ff)await this[_0x357aa2(0xe9)][_0x357aa2(0xc5)](this['repositoryData'],{});else{const _0x5025cd=await this[_0x357aa2(0x91)][_0x357aa2(0xd9)][_0x357aa2(0xde)](this[_0x357aa2(0xf2)][_0x357aa2(0xf8)]);this[_0x357aa2(0xef)][_0x357aa2(0xd8)](this[_0x357aa2(0x96)]+_0x357aa2(0xdb));const _0x49c9f1={[this['repository'][_0x357aa2(0xd0)]]:{'lastCommit':_0x5025cd[_0x357aa2(0xb2)]}};await this['salesforceSync']['updateRemoteState'](this[_0x357aa2(0x9d)],_0x49c9f1);}}async[a106_0x571f83(0xc2)](){const _0x143c5a=a106_0x571f83,_0x17e292=await this[_0x143c5a(0x92)]();await this[_0x143c5a(0xe9)][_0x143c5a(0x95)](this[_0x143c5a(0x9d)],_0x143c5a(0xdc)),await this[_0x143c5a(0xac)][_0x143c5a(0xba)](_0x17e292,this[_0x143c5a(0x96)]),await this[_0x143c5a(0xe4)](),await this['salesforceSync']['setStatus'](this[_0x143c5a(0x9d)],_0x143c5a(0xa0));}async[a106_0x571f83(0xc1)](_0x115ad0){const _0x26aa46=a106_0x571f83;try{this[_0x26aa46(0xef)]['error'](''+_0x115ad0),await this['sfLogger'][_0x26aa46(0xed)](),await this[_0x26aa46(0xe4)](!![]),await this[_0x26aa46(0xe9)][_0x26aa46(0x95)](this[_0x26aa46(0x9d)],_0x26aa46(0xe1));}catch(_0x2e7c36){this['logger'][_0x26aa46(0xfc)](_0x2e7c36);}}async[a106_0x571f83(0xba)](_0x1563cb){const _0x4cb3b5=a106_0x571f83;try{this[_0x4cb3b5(0x90)]=_0x1563cb,this[_0x4cb3b5(0xa1)]=typedi_1['Container'][_0x4cb3b5(0xcd)](providers_tokens_1[_0x4cb3b5(0xe6)]['gitApiService']),this[_0x4cb3b5(0xb7)]=typedi_1[_0x4cb3b5(0xa2)][_0x4cb3b5(0xcd)](providers_tokens_1[_0x4cb3b5(0xe6)]['gitRepoService']),this['config']=typedi_1[_0x4cb3b5(0xa2)]['get'](providers_tokens_1[_0x4cb3b5(0xe6)][_0x4cb3b5(0xbf)]),await this[_0x4cb3b5(0xc7)](),this[_0x4cb3b5(0x91)]=await this[_0x4cb3b5(0xb7)][_0x4cb3b5(0xde)](this['repositoryData']['repositoryName']),this[_0x4cb3b5(0xf2)]=await this['repository'][_0x4cb3b5(0xd9)][_0x4cb3b5(0xde)](this[_0x4cb3b5(0x9d)][_0x4cb3b5(0xcb)]),this[_0x4cb3b5(0xef)]=typedi_1[_0x4cb3b5(0xa2)]['get'](providers_tokens_1['Tokens'][_0x4cb3b5(0xbc)]),this[_0x4cb3b5(0x96)]=_0x4cb3b5(0xa3)+this[_0x4cb3b5(0xbf)][_0x4cb3b5(0x9f)][_0x4cb3b5(0xec)]()+_0x4cb3b5(0xa9)+this[_0x4cb3b5(0x9d)][_0x4cb3b5(0x8f)]+_0x4cb3b5(0xa7)+this[_0x4cb3b5(0x9d)][_0x4cb3b5(0xcb)]+_0x4cb3b5(0xd3)+FlosumCommitJob_1['name']+']';if(!this['repositoryData'])throw new bad_request_error_1[(_0x4cb3b5(0x98))](errors_1[_0x4cb3b5(0xa8)]);await this['sfLogger'][_0x4cb3b5(0xd8)](this[_0x4cb3b5(0x96)]+_0x4cb3b5(0xee))[_0x4cb3b5(0xed)](),await this['exec']()['catch'](_0x2ff4d4=>this[_0x4cb3b5(0xc1)](_0x2ff4d4));}catch(_0x282e02){this[_0x4cb3b5(0x90)]=undefined,this[_0x4cb3b5(0xbc)][_0x4cb3b5(0xfc)](_0x282e02);throw _0x282e02;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a106_0x571f83(0x93)])({'transient':!![]}),__metadata(a106_0x571f83(0xbe),[salesforce_service_1[a106_0x571f83(0xc9)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1['SalesforceSyncService']])],FlosumCommitJob),exports[a106_0x571f83(0xdd)]=FlosumCommitJob;