const a125_0x4d7bd1=a125_0x2a97;function a125_0x4d95(){const _0x30694d=['repo','repository','147vFaVrL','gitProvider','then','commitJob','design:paramtypes','In\x20Progress','2978496bDseQp','1356325uNmzAR','constructor','provider','prefix','components','2WnwrsI','getOne','run','Logger','get','isConvertToSfdx','decorate','CommitToGitCompletedNotification','2270256EsLXDH','apply','execute','patchObject','Error','SalesforceSyncService','all','error',']\x20[','metadata','user','Service','defineProperty','toString','\x20Start\x20Flosum\x20commit\x20job.','../../../../core/errors/bad-request.error','function','branchName','10HwuvqO','Tokens','repositoryData','sfLogger','syncBranchId','logger','salesforceSync','(((.+)+)+)+$','completeNotification','__importDefault','gitRepoService','typedi','getComponentsToWrite','__metadata','FLOSUM_ATTACHMENT','207660jHQukO','config','name','toUpperCase','Email\x20notifications\x20are\x20disabled.','log','default','SalesforceRetrieverService','catch','getRepositoryRecord','deleteAttachmentId','setStatus','parse','retrieveAttachment','trim','isEmailNotificationsEnabled','commitAttachmentId','ERR_INVALID_SYNC_RECORD_ID','salesforceService','CommitComponentsDto','FlosumCommitJob','message','email','fetchRepositoryData','__esModule','../../providers/providers.tokens','__decorate','convertToSFDX','../../salesforce/services/salesforce-retriever.service','SalesforceService','gitUrl','getOwnPropertyDescriptor','errorNotification','getComponentsToDelete','branches','105258FWfSqV','updateRemoteState',']\x20[Branch:\x20','546824jsFKsx','BadRequestError','getBranchRecord','updateLastCommit','handleCommitJobError','recordType','commitData','deleteAttachment','[FLOSUM\x20->\x20GIT]\x20[','search','map','ERR_UNKNOWN_SYNC_RECORD_ID','length','Container','CommitToGitErrorNotification','object','info','exec','../../../../constants','270081tZBnma','gitApiService','send','./commit-components.job','branch'];a125_0x4d95=function(){return _0x30694d;};return a125_0x4d95();}function a125_0x2a97(_0x158aeb,_0x40ddd3){const _0x59d18a=a125_0x4d95();return a125_0x2a97=function(_0x535079,_0x6b1a4b){_0x535079=_0x535079-0x182;let _0x4d95ac=_0x59d18a[_0x535079];return _0x4d95ac;},a125_0x2a97(_0x158aeb,_0x40ddd3);}(function(_0x2e37f2,_0x2adcbb){const _0x3d2b06=a125_0x2a97,_0x3c51bb=_0x2e37f2();while(!![]){try{const _0xc6bce6=-parseInt(_0x3d2b06(0x1e4))/0x1+parseInt(_0x3d2b06(0x1bb))/0x2*(-parseInt(_0x3d2b06(0x1c3))/0x3)+parseInt(_0x3d2b06(0x1b5))/0x4+parseInt(_0x3d2b06(0x1b6))/0x5+-parseInt(_0x3d2b06(0x192))/0x6*(-parseInt(_0x3d2b06(0x1af))/0x7)+parseInt(_0x3d2b06(0x195))/0x8+parseInt(_0x3d2b06(0x1a8))/0x9*(-parseInt(_0x3d2b06(0x1d5))/0xa);if(_0xc6bce6===_0x2adcbb)break;else _0x3c51bb['push'](_0x3c51bb['shift']());}catch(_0x2fbbac){_0x3c51bb['push'](_0x3c51bb['shift']());}}}(a125_0x4d95,0x6fdf0));const a125_0x6b1a4b=(function(){let _0x5d3b84=!![];return function(_0x3cf852,_0x1b4f22){const _0x58c190=_0x5d3b84?function(){const _0x1bac3c=a125_0x2a97;if(_0x1b4f22){const _0x5cdc1d=_0x1b4f22[_0x1bac3c(0x1c4)](_0x3cf852,arguments);return _0x1b4f22=null,_0x5cdc1d;}}:function(){};return _0x5d3b84=![],_0x58c190;};}()),a125_0x535079=a125_0x6b1a4b(this,function(){const _0x17adf2=a125_0x2a97;return a125_0x535079[_0x17adf2(0x1d0)]()[_0x17adf2(0x19e)](_0x17adf2(0x1dc))['toString']()[_0x17adf2(0x1b7)](a125_0x535079)[_0x17adf2(0x19e)](_0x17adf2(0x1dc));});a125_0x535079();'use strict';var __decorate=this&&this[a125_0x4d7bd1(0x189)]||function(_0x49089c,_0x121f30,_0x1bed92,_0x2cb38d){const _0x29ba74=a125_0x4d7bd1;var _0x3a9a75=arguments[_0x29ba74(0x1a1)],_0x3dbd76=_0x3a9a75<0x3?_0x121f30:_0x2cb38d===null?_0x2cb38d=Object[_0x29ba74(0x18e)](_0x121f30,_0x1bed92):_0x2cb38d,_0x258672;if(typeof Reflect===_0x29ba74(0x1a4)&&typeof Reflect[_0x29ba74(0x1c1)]==='function')_0x3dbd76=Reflect[_0x29ba74(0x1c1)](_0x49089c,_0x121f30,_0x1bed92,_0x2cb38d);else{for(var _0x1687c7=_0x49089c[_0x29ba74(0x1a1)]-0x1;_0x1687c7>=0x0;_0x1687c7--)if(_0x258672=_0x49089c[_0x1687c7])_0x3dbd76=(_0x3a9a75<0x3?_0x258672(_0x3dbd76):_0x3a9a75>0x3?_0x258672(_0x121f30,_0x1bed92,_0x3dbd76):_0x258672(_0x121f30,_0x1bed92))||_0x3dbd76;}return _0x3a9a75>0x3&&_0x3dbd76&&Object[_0x29ba74(0x1cf)](_0x121f30,_0x1bed92,_0x3dbd76),_0x3dbd76;},__metadata=this&&this[a125_0x4d7bd1(0x1e2)]||function(_0x5b11d0,_0x566326){const _0x5bee13=a125_0x4d7bd1;if(typeof Reflect===_0x5bee13(0x1a4)&&typeof Reflect[_0x5bee13(0x1cc)]===_0x5bee13(0x1d3))return Reflect[_0x5bee13(0x1cc)](_0x5b11d0,_0x566326);},__importDefault=this&&this[a125_0x4d7bd1(0x1de)]||function(_0x2bce27){const _0x5419bf=a125_0x4d7bd1;return _0x2bce27&&_0x2bce27[_0x5419bf(0x187)]?_0x2bce27:{'default':_0x2bce27};},FlosumCommitJob_1;Object[a125_0x4d7bd1(0x1cf)](exports,a125_0x4d7bd1(0x187),{'value':!![]}),exports[a125_0x4d7bd1(0x183)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a125_0x4d7bd1(0x1e0)),errors_1=require('../../../../constants/errors'),bad_request_error_1=require(a125_0x4d7bd1(0x1d2)),salesforce_retriever_service_1=require(a125_0x4d7bd1(0x18b)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a125_0x4d7bd1(0x1ab)),constants_1=require(a125_0x4d7bd1(0x1a7)),shortid_1=__importDefault(require('shortid')),providers_tokens_1=require(a125_0x4d7bd1(0x188)),commit_to_git_completed_notification_1=require('../../notifications/commit-to-git-completed.notification'),commit_to_git_error_notification_1=require('../../notifications/commit-to-git-error.notification');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x227777,_0x1cf74c,_0x48d024){const _0x2ee249=a125_0x4d7bd1;this[_0x2ee249(0x1f6)]=_0x227777,this[_0x2ee249(0x1b2)]=_0x1cf74c,this[_0x2ee249(0x1db)]=_0x48d024,this[_0x2ee249(0x1da)]=new core_1[(_0x2ee249(0x1be))](FlosumCommitJob_1['name']);}async[a125_0x4d7bd1(0x1dd)](_0x5b8008,_0x49c1e2,_0x2ac28b,_0x50884d){const _0x205854=a125_0x4d7bd1;if(!this[_0x205854(0x19b)][_0x205854(0x1f3)]){this[_0x205854(0x1da)]['info'](_0x205854(0x1e8));return;}await new commit_to_git_completed_notification_1[(_0x205854(0x1c2))]({'emails':_0x5b8008,'gitProvider':_0x49c1e2,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1[_0x205854(0x1c2)]['name'],'repositoryName':_0x2ac28b,'branchName':_0x50884d})[_0x205854(0x1c5)]();}async[a125_0x4d7bd1(0x18f)](_0x45268b,_0x583404,_0x756060,_0x2d9c0b){const _0x14a00c=a125_0x4d7bd1;if(!this[_0x14a00c(0x19b)][_0x14a00c(0x1f3)]){this[_0x14a00c(0x1da)][_0x14a00c(0x1a5)]('Email\x20notifications\x20are\x20disabled.');return;}await new commit_to_git_error_notification_1[(_0x14a00c(0x1a3))]({'emails':_0x45268b,'gitProvider':_0x583404,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0x14a00c(0x1a3)][_0x14a00c(0x1e6)],'repositoryName':_0x756060,'branchName':_0x2d9c0b})['execute']();}async[a125_0x4d7bd1(0x186)](){const _0x3eaaae=a125_0x4d7bd1;try{if(this['commitData']['syncRepositoryId'])this[_0x3eaaae(0x1d7)]=await this[_0x3eaaae(0x1db)][_0x3eaaae(0x1ed)](this[_0x3eaaae(0x19b)]['syncRepositoryId']);else this[_0x3eaaae(0x19b)][_0x3eaaae(0x1d9)]&&(this[_0x3eaaae(0x1d7)]=await this[_0x3eaaae(0x1db)][_0x3eaaae(0x197)](this[_0x3eaaae(0x19b)][_0x3eaaae(0x1d9)]));}catch(_0x92c7d6){throw new bad_request_error_1[(_0x3eaaae(0x196))](errors_1[_0x3eaaae(0x1f5)]);}}async[a125_0x4d7bd1(0x1e1)](){const _0xe88cba=a125_0x4d7bd1;if(!this[_0xe88cba(0x19b)][_0xe88cba(0x1f4)])return[];await this[_0xe88cba(0x1f6)][_0xe88cba(0x1c6)](constants_1[_0xe88cba(0x1e3)],this[_0xe88cba(0x19b)][_0xe88cba(0x1f4)],{'Name':(0x0,shortid_1[_0xe88cba(0x1ea)])()});const _0x2192c7=await this[_0xe88cba(0x1f6)][_0xe88cba(0x1f1)](this['commitData']['commitAttachmentId'])[_0xe88cba(0x1b1)](_0x33e626=>_0x33e626['split']('\x20')[_0xe88cba(0x19f)](_0x178495=>_0x178495[_0xe88cba(0x1f2)]()));await this[_0xe88cba(0x1f6)][_0xe88cba(0x19c)](this[_0xe88cba(0x19b)][_0xe88cba(0x1f4)]);const _0x2a1b56=new salesforce_retriever_service_1[(_0xe88cba(0x1eb))](this[_0xe88cba(0x1f6)]);return await _0x2a1b56[_0xe88cba(0x1bd)](_0x2192c7);}async['getComponentsToDelete'](){const _0x559d3d=a125_0x4d7bd1;if(!this['commitData'][_0x559d3d(0x1ee)])return[];await this[_0x559d3d(0x1f6)]['patchObject'](constants_1[_0x559d3d(0x1e3)],this['commitData']['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0x559d3d(0x1ea)])()});const _0xbbc62f=await this[_0x559d3d(0x1f6)][_0x559d3d(0x1f1)](this['commitData']['deleteAttachmentId']),_0x147572=JSON[_0x559d3d(0x1f0)](_0xbbc62f);return await this[_0x559d3d(0x1f6)][_0x559d3d(0x19c)](this['commitData']['deleteAttachmentId']),_0x147572;}async['getCommitDto'](){const _0x4adcd1=a125_0x4d7bd1,_0x2ea7df=new commit_components_dto_1[(_0x4adcd1(0x182))](),[_0x451d3a,_0x154987]=await Promise[_0x4adcd1(0x1c9)]([this[_0x4adcd1(0x1e1)](),this[_0x4adcd1(0x190)]()]);return _0x2ea7df[_0x4adcd1(0x184)]=this[_0x4adcd1(0x19b)][_0x4adcd1(0x184)],_0x2ea7df[_0x4adcd1(0x1cd)]=this[_0x4adcd1(0x19b)]['user'],_0x2ea7df[_0x4adcd1(0x1ba)]={'writed':_0x451d3a,'deleted':_0x154987},_0x2ea7df[_0x4adcd1(0x18a)]=this[_0x4adcd1(0x1e5)][_0x4adcd1(0x1c0)],_0x2ea7df[_0x4adcd1(0x1ad)]=this[_0x4adcd1(0x1ae)],_0x2ea7df[_0x4adcd1(0x1ac)]=this[_0x4adcd1(0x1ac)],_0x2ea7df[_0x4adcd1(0x1b8)]=this['config'][_0x4adcd1(0x1b0)],_0x2ea7df[_0x4adcd1(0x19a)]=this[_0x4adcd1(0x1d7)]['recordTypeName'],_0x2ea7df;}async[a125_0x4d7bd1(0x198)](_0x1369f6=![]){const _0x386af8=a125_0x4d7bd1;if(_0x1369f6)await this[_0x386af8(0x1db)][_0x386af8(0x193)](this[_0x386af8(0x1d7)],{});else{const _0x58a00d=await this[_0x386af8(0x1ae)][_0x386af8(0x191)][_0x386af8(0x1bc)](this[_0x386af8(0x1ac)][_0x386af8(0x1e6)]);this[_0x386af8(0x1d8)][_0x386af8(0x1e9)](this[_0x386af8(0x1b9)]+'\x20Update\x20remote\x20state.');const _0x29d9d7={[this['repository'][_0x386af8(0x18d)]]:{'lastCommit':_0x58a00d['sha']}};await this[_0x386af8(0x1db)][_0x386af8(0x193)](this[_0x386af8(0x1d7)],_0x29d9d7);}}async[a125_0x4d7bd1(0x1a6)](){const _0x55bfe6=a125_0x4d7bd1,_0x55668c=await this['getCommitDto']();await this[_0x55bfe6(0x1db)][_0x55bfe6(0x1ef)](this[_0x55bfe6(0x1d7)],_0x55bfe6(0x1b4)),await this[_0x55bfe6(0x1b2)][_0x55bfe6(0x1bd)](_0x55668c,this[_0x55bfe6(0x1b9)]),await this[_0x55bfe6(0x198)](),await this[_0x55bfe6(0x1db)][_0x55bfe6(0x1ef)](this[_0x55bfe6(0x1d7)],'Completed');}async[a125_0x4d7bd1(0x199)](_0x165eef){const _0x279063=a125_0x4d7bd1;try{this['sfLogger'][_0x279063(0x1ca)](''+_0x165eef),await this[_0x279063(0x1d8)]['send'](),await this[_0x279063(0x198)](!![]),await this[_0x279063(0x1db)][_0x279063(0x1ef)](this[_0x279063(0x1d7)],_0x279063(0x1c7)),await this[_0x279063(0x1dd)]([this[_0x279063(0x19b)]['user'][_0x279063(0x185)]],this[_0x279063(0x1e5)]['gitProvider'],this[_0x279063(0x1ae)]['name'],this[_0x279063(0x1ac)][_0x279063(0x1e6)]);}catch(_0x5af9dd){this[_0x279063(0x1da)][_0x279063(0x1ca)](_0x5af9dd),await this[_0x279063(0x18f)]([this['commitData'][_0x279063(0x1cd)][_0x279063(0x185)]],this[_0x279063(0x1e5)][_0x279063(0x1b0)],this['repository'][_0x279063(0x1e6)],this['branch']['name']);}}async[a125_0x4d7bd1(0x1bd)](_0xcf6ad3){const _0x34d4eb=a125_0x4d7bd1;try{this['commitData']=_0xcf6ad3,this['gitApiService']=typedi_1[_0x34d4eb(0x1a2)][_0x34d4eb(0x1bf)](providers_tokens_1[_0x34d4eb(0x1d6)][_0x34d4eb(0x1a9)]),this['repoService']=typedi_1[_0x34d4eb(0x1a2)][_0x34d4eb(0x1bf)](providers_tokens_1[_0x34d4eb(0x1d6)][_0x34d4eb(0x1df)]),this[_0x34d4eb(0x1e5)]=typedi_1['Container'][_0x34d4eb(0x1bf)](providers_tokens_1[_0x34d4eb(0x1d6)][_0x34d4eb(0x1e5)]),await this[_0x34d4eb(0x186)](),this[_0x34d4eb(0x1ae)]=await this['repoService'][_0x34d4eb(0x1bc)](this[_0x34d4eb(0x1d7)]['repositoryName']),this['branch']=await this['repository'][_0x34d4eb(0x191)][_0x34d4eb(0x1bc)](this['repositoryData'][_0x34d4eb(0x1d4)]),this[_0x34d4eb(0x1d8)]=typedi_1['Container'][_0x34d4eb(0x1bf)](providers_tokens_1[_0x34d4eb(0x1d6)][_0x34d4eb(0x1da)]),this[_0x34d4eb(0x1b9)]=_0x34d4eb(0x19d)+this[_0x34d4eb(0x1e5)][_0x34d4eb(0x1b0)][_0x34d4eb(0x1e7)]()+']\x20[Repository:\x20'+this['repositoryData']['repositoryName']+_0x34d4eb(0x194)+this['repositoryData'][_0x34d4eb(0x1d4)]+_0x34d4eb(0x1cb)+FlosumCommitJob_1[_0x34d4eb(0x1e6)]+']';if(!this[_0x34d4eb(0x1d7)])throw new bad_request_error_1[(_0x34d4eb(0x196))](errors_1[_0x34d4eb(0x1a0)]);await this[_0x34d4eb(0x1d8)]['log'](this[_0x34d4eb(0x1b9)]+_0x34d4eb(0x1d1))[_0x34d4eb(0x1aa)](),await this[_0x34d4eb(0x1a6)]()[_0x34d4eb(0x1ec)](_0x4936b0=>this[_0x34d4eb(0x199)](_0x4936b0)),await this[_0x34d4eb(0x1dd)]([this[_0x34d4eb(0x19b)][_0x34d4eb(0x1cd)]['email']],this['config'][_0x34d4eb(0x1b0)],this[_0x34d4eb(0x1ae)]['name'],this[_0x34d4eb(0x1ac)][_0x34d4eb(0x1e6)]);}catch(_0x26b935){this[_0x34d4eb(0x19b)]=undefined,this[_0x34d4eb(0x1da)][_0x34d4eb(0x1ca)](_0x26b935),await this[_0x34d4eb(0x18f)]([this['commitData']['user'][_0x34d4eb(0x185)]],this['config'][_0x34d4eb(0x1b0)],this['repository'][_0x34d4eb(0x1e6)],this[_0x34d4eb(0x1ac)][_0x34d4eb(0x1e6)]);throw _0x26b935;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a125_0x4d7bd1(0x1ce)])({'transient':!![]}),__metadata(a125_0x4d7bd1(0x1b3),[salesforce_service_1[a125_0x4d7bd1(0x18c)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a125_0x4d7bd1(0x1c8)]])],FlosumCommitJob),exports[a125_0x4d7bd1(0x183)]=FlosumCommitJob;