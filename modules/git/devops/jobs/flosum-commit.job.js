function a73_0x34d9(_0x47b3eb,_0x59010b){const _0x552355=a73_0x32b9();return a73_0x34d9=function(_0x175fd0,_0x4461fe){_0x175fd0=_0x175fd0-0xd9;let _0x32b9f1=_0x552355[_0x175fd0];return _0x32b9f1;},a73_0x34d9(_0x47b3eb,_0x59010b);}const a73_0x3e62be=a73_0x34d9;(function(_0x3964d8,_0x4e48dc){const _0x32bd81=a73_0x34d9,_0x1de972=_0x3964d8();while(!![]){try{const _0x21457f=-parseInt(_0x32bd81(0x12d))/0x1+parseInt(_0x32bd81(0x135))/0x2*(parseInt(_0x32bd81(0xea))/0x3)+-parseInt(_0x32bd81(0x109))/0x4*(parseInt(_0x32bd81(0x139))/0x5)+-parseInt(_0x32bd81(0x12c))/0x6+-parseInt(_0x32bd81(0x136))/0x7*(-parseInt(_0x32bd81(0xf7))/0x8)+parseInt(_0x32bd81(0x108))/0x9*(-parseInt(_0x32bd81(0x10d))/0xa)+parseInt(_0x32bd81(0x111))/0xb*(parseInt(_0x32bd81(0xfd))/0xc);if(_0x21457f===_0x4e48dc)break;else _0x1de972['push'](_0x1de972['shift']());}catch(_0x54df7a){_0x1de972['push'](_0x1de972['shift']());}}}(a73_0x32b9,0xd0d01));const a73_0x4461fe=(function(){let _0x249b3c=!![];return function(_0x181c68,_0x32bb18){const _0x5bcbab=_0x249b3c?function(){const _0x51ae8d=a73_0x34d9;if(_0x32bb18){const _0x4e7556=_0x32bb18[_0x51ae8d(0x101)](_0x181c68,arguments);return _0x32bb18=null,_0x4e7556;}}:function(){};return _0x249b3c=![],_0x5bcbab;};}()),a73_0x175fd0=a73_0x4461fe(this,function(){const _0x39da10=a73_0x34d9;return a73_0x175fd0['toString']()[_0x39da10(0x105)](_0x39da10(0x134))[_0x39da10(0x100)]()[_0x39da10(0x112)](a73_0x175fd0)['search'](_0x39da10(0x134));});a73_0x175fd0();function a73_0x32b9(){const _0x2b0efc=['../../../../core/errors/bad-request.error','3449592qIHqJA','3572NccCee','[FLOSUM\x20->\x20GIT]\x20[','SalesforceService','getBranchRecord','40ssgJzo','config','getComponentsToWrite','repository','59935150AyOeQB','constructor','branchName','../../salesforce/services/salesforce-retriever.service','deleteAttachment','../../salesforce/services/salesforce-sync.service','logger','getOne','FLOSUM_ATTACHMENT','repo','get','CommitComponentsDto','salesforceSync','message','SalesforceRetrieverService','trim','getCommitDto','repositoryData','default','length','object','getComponentsToDelete','\x20Start\x20Flosum\x20commit\x20job.','convertToSFDX','name','Container','prefix','9135762rnMgYK','1602225NbRtEi','handleCommitJobError','fetchRepositoryData','gitProvider','getOwnPropertyDescriptor','user','log','(((.+)+)+)+$','14544sCdFwx','14nFgdbY','ERR_UNKNOWN_SYNC_RECORD_ID','commitAttachmentId','4635ZZJiCC','toUpperCase','split','repositoryName','deleteAttachmentId','syncRepositoryId','function','ERR_INVALID_SYNC_RECORD_ID','provider','./commit-components.job','Completed','commitData','repoService','branch','shortid','defineProperty','__esModule','setStatus','then','metadata','isConvertToSfdx','design:paramtypes',']\x20[Repository:\x20','exec','../../../../constants/errors','decorate','222ACrAJq','sfLogger','run','In\x20Progress','BadRequestError','map','updateRemoteState','send','../../salesforce/services/salesforce.service','typedi','error','salesforceService','updateLastCommit','1417336MjTRkI','CommitComponentsJob','syncBranchId','FlosumCommitJob','Error','gitApiService','12BxViQF','Tokens','branches','toString','apply','\x20Update\x20remote\x20state.','../../providers/providers.tokens','components','search','commitJob'];a73_0x32b9=function(){return _0x2b0efc;};return a73_0x32b9();}'use strict';var __decorate=this&&this['__decorate']||function(_0xa575c2,_0x17b01f,_0x22626c,_0x3bc59e){const _0x24687a=a73_0x34d9;var _0x4c27b5=arguments['length'],_0x5433e6=_0x4c27b5<0x3?_0x17b01f:_0x3bc59e===null?_0x3bc59e=Object[_0x24687a(0x131)](_0x17b01f,_0x22626c):_0x3bc59e,_0x16d8ed;if(typeof Reflect===_0x24687a(0x125)&&typeof Reflect[_0x24687a(0xe9)]==='function')_0x5433e6=Reflect[_0x24687a(0xe9)](_0xa575c2,_0x17b01f,_0x22626c,_0x3bc59e);else{for(var _0x2186a0=_0xa575c2[_0x24687a(0x124)]-0x1;_0x2186a0>=0x0;_0x2186a0--)if(_0x16d8ed=_0xa575c2[_0x2186a0])_0x5433e6=(_0x4c27b5<0x3?_0x16d8ed(_0x5433e6):_0x4c27b5>0x3?_0x16d8ed(_0x17b01f,_0x22626c,_0x5433e6):_0x16d8ed(_0x17b01f,_0x22626c))||_0x5433e6;}return _0x4c27b5>0x3&&_0x5433e6&&Object[_0x24687a(0xdf)](_0x17b01f,_0x22626c,_0x5433e6),_0x5433e6;},__metadata=this&&this['__metadata']||function(_0x332faa,_0x59023f){const _0xd303c3=a73_0x34d9;if(typeof Reflect===_0xd303c3(0x125)&&typeof Reflect[_0xd303c3(0xe3)]===_0xd303c3(0x13f))return Reflect[_0xd303c3(0xe3)](_0x332faa,_0x59023f);},__importDefault=this&&this['__importDefault']||function(_0x3eabb0){const _0x183f53=a73_0x34d9;return _0x3eabb0&&_0x3eabb0[_0x183f53(0xe0)]?_0x3eabb0:{'default':_0x3eabb0};},FlosumCommitJob_1;Object[a73_0x3e62be(0xdf)](exports,a73_0x3e62be(0xe0),{'value':!![]}),exports[a73_0x3e62be(0xfa)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require(a73_0x3e62be(0xf2)),typedi_1=require(a73_0x3e62be(0xf3)),errors_1=require(a73_0x3e62be(0xe8)),bad_request_error_1=require(a73_0x3e62be(0x107)),salesforce_retriever_service_1=require(a73_0x3e62be(0x114)),salesforce_sync_service_1=require(a73_0x3e62be(0x116)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a73_0x3e62be(0xd9)),constants_1=require('../../../../constants'),shortid_1=__importDefault(require(a73_0x3e62be(0xde))),providers_tokens_1=require(a73_0x3e62be(0x103));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x5cce52,_0x28f9f6,_0x2b53a4){const _0xbeb193=a73_0x3e62be;this[_0xbeb193(0xf5)]=_0x5cce52,this[_0xbeb193(0x106)]=_0x28f9f6,this[_0xbeb193(0x11d)]=_0x2b53a4,this[_0xbeb193(0x117)]=new core_1['Logger'](FlosumCommitJob_1[_0xbeb193(0x129)]);}async[a73_0x3e62be(0x12f)](){const _0x5e2edd=a73_0x3e62be;try{if(this[_0x5e2edd(0xdb)][_0x5e2edd(0x13e)])this[_0x5e2edd(0x122)]=await this[_0x5e2edd(0x11d)]['getRepositoryRecord'](this[_0x5e2edd(0xdb)][_0x5e2edd(0x13e)]);else this[_0x5e2edd(0xdb)][_0x5e2edd(0xf9)]&&(this[_0x5e2edd(0x122)]=await this['salesforceSync'][_0x5e2edd(0x10c)](this[_0x5e2edd(0xdb)][_0x5e2edd(0xf9)]));}catch(_0x12585c){throw new bad_request_error_1[(_0x5e2edd(0xee))](errors_1[_0x5e2edd(0x140)]);}}async['getComponentsToWrite'](){const _0x181fb3=a73_0x3e62be;if(!this['commitData'][_0x181fb3(0x138)])return[];await this[_0x181fb3(0xf5)]['patchObject'](constants_1[_0x181fb3(0x119)],this[_0x181fb3(0xdb)][_0x181fb3(0x138)],{'Name':(0x0,shortid_1[_0x181fb3(0x123)])()});const _0x475a4a=await this[_0x181fb3(0xf5)]['retrieveAttachment'](this['commitData'][_0x181fb3(0x138)])[_0x181fb3(0xe2)](_0x32f7d0=>_0x32f7d0[_0x181fb3(0x13b)]('\x20')[_0x181fb3(0xef)](_0x4d157f=>_0x4d157f[_0x181fb3(0x120)]()));await this[_0x181fb3(0xf5)][_0x181fb3(0x115)](this[_0x181fb3(0xdb)][_0x181fb3(0x138)]);const _0x2c13e9=new salesforce_retriever_service_1[(_0x181fb3(0x11f))](this['salesforceService']);return await _0x2c13e9['run'](_0x475a4a);}async['getComponentsToDelete'](){const _0x3df7a4=a73_0x3e62be;if(!this[_0x3df7a4(0xdb)][_0x3df7a4(0x13d)])return[];await this['salesforceService']['patchObject'](constants_1['FLOSUM_ATTACHMENT'],this[_0x3df7a4(0xdb)]['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0x3df7a4(0x123)])()});const _0x286479=await this['salesforceService']['retrieveAttachment'](this[_0x3df7a4(0xdb)][_0x3df7a4(0x13d)]);return await this['salesforceService']['deleteAttachment'](this[_0x3df7a4(0xdb)][_0x3df7a4(0x13d)]),_0x286479;}async[a73_0x3e62be(0x121)](){const _0x48493f=a73_0x3e62be,_0x39c36e=new commit_components_dto_1[(_0x48493f(0x11c))](),[_0x214748,_0x531604]=await Promise['all']([this[_0x48493f(0x10f)](),this[_0x48493f(0x126)]()]);return _0x39c36e['message']=this['commitData'][_0x48493f(0x11e)],_0x39c36e[_0x48493f(0x132)]=this[_0x48493f(0xdb)][_0x48493f(0x132)],_0x39c36e[_0x48493f(0x104)]={'writed':_0x214748,'deleted':_0x531604},_0x39c36e[_0x48493f(0x128)]=this[_0x48493f(0x10e)][_0x48493f(0xe4)],_0x39c36e[_0x48493f(0x11a)]=this[_0x48493f(0x110)],_0x39c36e['branch']=this[_0x48493f(0xdd)],_0x39c36e[_0x48493f(0x141)]=this[_0x48493f(0x10e)][_0x48493f(0x130)],_0x39c36e;}async['updateLastCommit'](_0x5f433f=![]){const _0x39ca93=a73_0x3e62be;if(_0x5f433f)await this[_0x39ca93(0x11d)][_0x39ca93(0xf0)](this[_0x39ca93(0x122)],{});else{const _0x904135=await this[_0x39ca93(0x110)]['branches']['getOne'](this[_0x39ca93(0xdd)][_0x39ca93(0x129)]);this[_0x39ca93(0xeb)]['log'](this[_0x39ca93(0x12b)]+_0x39ca93(0x102));const _0xf551b6={[this[_0x39ca93(0x110)]['gitUrl']]:{'lastCommit':_0x904135['sha']}};await this[_0x39ca93(0x11d)][_0x39ca93(0xf0)](this[_0x39ca93(0x122)],_0xf551b6);}}async[a73_0x3e62be(0xe7)](){const _0x18f447=a73_0x3e62be,_0x1f5b40=await this['getCommitDto']();await this['salesforceSync'][_0x18f447(0xe1)](this['repositoryData'],_0x18f447(0xed)),await this[_0x18f447(0x106)]['run'](_0x1f5b40,this['prefix']),await this[_0x18f447(0xf6)](),await this[_0x18f447(0x11d)][_0x18f447(0xe1)](this[_0x18f447(0x122)],_0x18f447(0xda));}async[a73_0x3e62be(0x12e)](_0x5a2987){const _0x5299cc=a73_0x3e62be;try{this[_0x5299cc(0xeb)][_0x5299cc(0xf4)](''+_0x5a2987),await this[_0x5299cc(0xeb)][_0x5299cc(0xf1)](),await this[_0x5299cc(0xf6)](!![]),await this['salesforceSync'][_0x5299cc(0xe1)](this[_0x5299cc(0x122)],_0x5299cc(0xfb));}catch(_0x3fa8b9){this['logger'][_0x5299cc(0xf4)](_0x3fa8b9);}}async[a73_0x3e62be(0xec)](_0x167f70){const _0x1a867e=a73_0x3e62be;try{this[_0x1a867e(0xdb)]=_0x167f70,this[_0x1a867e(0xfc)]=typedi_1[_0x1a867e(0x12a)][_0x1a867e(0x11b)](providers_tokens_1[_0x1a867e(0xfe)]['gitApiService']),this[_0x1a867e(0xdc)]=typedi_1['Container'][_0x1a867e(0x11b)](providers_tokens_1[_0x1a867e(0xfe)]['gitRepoService']),this[_0x1a867e(0x10e)]=typedi_1[_0x1a867e(0x12a)]['get'](providers_tokens_1[_0x1a867e(0xfe)]['config']),await this[_0x1a867e(0x12f)](),this[_0x1a867e(0x110)]=await this[_0x1a867e(0xdc)][_0x1a867e(0x118)](this[_0x1a867e(0x122)][_0x1a867e(0x13c)]),this['branch']=await this[_0x1a867e(0x110)][_0x1a867e(0xff)][_0x1a867e(0x118)](this[_0x1a867e(0x122)][_0x1a867e(0x113)]),this[_0x1a867e(0xeb)]=typedi_1[_0x1a867e(0x12a)][_0x1a867e(0x11b)](providers_tokens_1[_0x1a867e(0xfe)][_0x1a867e(0x117)]),this[_0x1a867e(0x12b)]=_0x1a867e(0x10a)+this[_0x1a867e(0x10e)][_0x1a867e(0x130)][_0x1a867e(0x13a)]()+_0x1a867e(0xe6)+this['repositoryData'][_0x1a867e(0x13c)]+']\x20[Branch:\x20'+this['repositoryData'][_0x1a867e(0x113)]+']\x20['+FlosumCommitJob_1[_0x1a867e(0x129)]+']';if(!this[_0x1a867e(0x122)])throw new bad_request_error_1[(_0x1a867e(0xee))](errors_1[_0x1a867e(0x137)]);await this[_0x1a867e(0xeb)][_0x1a867e(0x133)](this[_0x1a867e(0x12b)]+_0x1a867e(0x127))[_0x1a867e(0xf1)](),await this['exec']()['catch'](_0x477f0e=>this[_0x1a867e(0x12e)](_0x477f0e));}catch(_0x5a4834){this[_0x1a867e(0xdb)]=undefined,this[_0x1a867e(0x117)]['error'](_0x5a4834);throw _0x5a4834;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a73_0x3e62be(0xe5),[salesforce_service_1[a73_0x3e62be(0x10b)],commit_components_job_1[a73_0x3e62be(0xf8)],salesforce_sync_service_1['SalesforceSyncService']])],FlosumCommitJob),exports[a73_0x3e62be(0xfa)]=FlosumCommitJob;