const a104_0x3e28f0=a104_0x1701;(function(_0x37836a,_0x14eb5f){const _0x1d025e=a104_0x1701,_0x56aaae=_0x37836a();while(!![]){try{const _0x2b9460=-parseInt(_0x1d025e(0x196))/0x1*(-parseInt(_0x1d025e(0x1a8))/0x2)+parseInt(_0x1d025e(0x1a6))/0x3*(-parseInt(_0x1d025e(0x175))/0x4)+-parseInt(_0x1d025e(0x16d))/0x5*(parseInt(_0x1d025e(0x1ac))/0x6)+parseInt(_0x1d025e(0x195))/0x7+-parseInt(_0x1d025e(0x19f))/0x8*(-parseInt(_0x1d025e(0x18a))/0x9)+parseInt(_0x1d025e(0x174))/0xa*(parseInt(_0x1d025e(0x1aa))/0xb)+parseInt(_0x1d025e(0x176))/0xc*(parseInt(_0x1d025e(0x172))/0xd);if(_0x2b9460===_0x14eb5f)break;else _0x56aaae['push'](_0x56aaae['shift']());}catch(_0x509b3c){_0x56aaae['push'](_0x56aaae['shift']());}}}(a104_0x215f,0xe298e));const a104_0x5708bc=(function(){let _0x2455c3=!![];return function(_0x555c5f,_0x5701a8){const _0x13f71e=_0x2455c3?function(){const _0xc04cf2=a104_0x1701;if(_0x5701a8){const _0x154e3b=_0x5701a8[_0xc04cf2(0x19c)](_0x555c5f,arguments);return _0x5701a8=null,_0x154e3b;}}:function(){};return _0x2455c3=![],_0x13f71e;};}()),a104_0x3f767f=a104_0x5708bc(this,function(){const _0x2a95af=a104_0x1701;return a104_0x3f767f['toString']()[_0x2a95af(0x1ca)]('(((.+)+)+)+$')[_0x2a95af(0x1bb)]()[_0x2a95af(0x1c2)](a104_0x3f767f)[_0x2a95af(0x1ca)]('(((.+)+)+)+$');});function a104_0x215f(){const _0x428367=['constructor','sha','Error','user','deleteAttachmentId','branchName','CommitComponentsJob','Tokens','search','decorate','get','../dto/commit-components.dto','toUpperCase','repo','salesforceSync','../../salesforce/services/salesforce.service','design:paramtypes','provider','prefix',']\x20[Branch:\x20','FlosumCommitJob','config','all','SalesforceSyncService','run','default','getRepositoryRecord','8865370MfWPlf','commitJob','SalesforceService','patchObject','\x20Update\x20remote\x20state.','91lpwTbD','../../providers/providers.tokens','20ZTgWXm','48FkCdyX','2290092qZBIfD','gitRepoService','shortid','metadata','__esModule','salesforceService','then','branch','fetchRepositoryData','log','../../../../core/errors/bad-request.error','gitProvider','commitData','branches','error','function','Container','repository','../../salesforce/services/salesforce-retriever.service','commitAttachmentId','1229463niRvBv','syncRepositoryId','deleteAttachment','message','../../../../constants','Completed','getComponentsToWrite','isConvertToSfdx',']\x20[','defineProperty','__importDefault','2708363qQgGpg','1PBwiQg','BadRequestError','repositoryName','SalesforceRetrieverService','send','../../../../core','apply','updateLastCommit','convertToSFDX','24BVCcEo','setStatus','catch','repositoryData','split','sfLogger','__decorate','343983PfqjRG','getBranchRecord','1567070zcqXLi','object','6385478nAJNKm','Logger','6sDIYSn','typedi','In\x20Progress','retrieveAttachment','repoService','syncBranchId','ERR_UNKNOWN_SYNC_RECORD_ID','handleCommitJobError','length','../../../../constants/errors','exec','trim','map','name','FLOSUM_ATTACHMENT','toString','./commit-components.job','../../salesforce/services/salesforce-sync.service','ERR_INVALID_SYNC_RECORD_ID','getComponentsToDelete','logger','getOne'];a104_0x215f=function(){return _0x428367;};return a104_0x215f();}a104_0x3f767f();'use strict';var __decorate=this&&this[a104_0x3e28f0(0x1a5)]||function(_0x4d6693,_0xba05cd,_0x2b3196,_0x48b8f9){const _0x3943d2=a104_0x3e28f0;var _0x5baa20=arguments[_0x3943d2(0x1b4)],_0x4783c5=_0x5baa20<0x3?_0xba05cd:_0x48b8f9===null?_0x48b8f9=Object['getOwnPropertyDescriptor'](_0xba05cd,_0x2b3196):_0x48b8f9,_0xff322b;if(typeof Reflect==='object'&&typeof Reflect[_0x3943d2(0x1cb)]===_0x3943d2(0x185))_0x4783c5=Reflect[_0x3943d2(0x1cb)](_0x4d6693,_0xba05cd,_0x2b3196,_0x48b8f9);else{for(var _0x11cc8f=_0x4d6693[_0x3943d2(0x1b4)]-0x1;_0x11cc8f>=0x0;_0x11cc8f--)if(_0xff322b=_0x4d6693[_0x11cc8f])_0x4783c5=(_0x5baa20<0x3?_0xff322b(_0x4783c5):_0x5baa20>0x3?_0xff322b(_0xba05cd,_0x2b3196,_0x4783c5):_0xff322b(_0xba05cd,_0x2b3196))||_0x4783c5;}return _0x5baa20>0x3&&_0x4783c5&&Object['defineProperty'](_0xba05cd,_0x2b3196,_0x4783c5),_0x4783c5;},__metadata=this&&this['__metadata']||function(_0x2e59f6,_0x32c9f1){const _0x5e1df9=a104_0x3e28f0;if(typeof Reflect===_0x5e1df9(0x1a9)&&typeof Reflect[_0x5e1df9(0x179)]===_0x5e1df9(0x185))return Reflect[_0x5e1df9(0x179)](_0x2e59f6,_0x32c9f1);},__importDefault=this&&this[a104_0x3e28f0(0x194)]||function(_0x443994){const _0x3864a3=a104_0x3e28f0;return _0x443994&&_0x443994[_0x3864a3(0x17a)]?_0x443994:{'default':_0x443994};},FlosumCommitJob_1;Object[a104_0x3e28f0(0x193)](exports,a104_0x3e28f0(0x17a),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;function a104_0x1701(_0x17b055,_0x2e588f){const _0x27a98f=a104_0x215f();return a104_0x1701=function(_0x3f767f,_0x5708bc){_0x3f767f=_0x3f767f-0x163;let _0x215fbf=_0x27a98f[_0x3f767f];return _0x215fbf;},a104_0x1701(_0x17b055,_0x2e588f);}const core_1=require(a104_0x3e28f0(0x19b)),salesforce_service_1=require(a104_0x3e28f0(0x1d1)),typedi_1=require(a104_0x3e28f0(0x1ad)),errors_1=require(a104_0x3e28f0(0x1b5)),bad_request_error_1=require(a104_0x3e28f0(0x180)),salesforce_retriever_service_1=require(a104_0x3e28f0(0x188)),salesforce_sync_service_1=require(a104_0x3e28f0(0x1bd)),commit_components_dto_1=require(a104_0x3e28f0(0x1cd)),commit_components_job_1=require(a104_0x3e28f0(0x1bc)),constants_1=require(a104_0x3e28f0(0x18e)),shortid_1=__importDefault(require(a104_0x3e28f0(0x178))),providers_tokens_1=require(a104_0x3e28f0(0x173));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x452fec,_0x42a43f,_0x394a48){const _0x1fcc08=a104_0x3e28f0;this['salesforceService']=_0x452fec,this[_0x1fcc08(0x16e)]=_0x42a43f,this[_0x1fcc08(0x1d0)]=_0x394a48,this[_0x1fcc08(0x1c0)]=new core_1[(_0x1fcc08(0x1ab))](FlosumCommitJob_1['name']);}async[a104_0x3e28f0(0x17e)](){const _0x533793=a104_0x3e28f0;try{if(this[_0x533793(0x182)][_0x533793(0x18b)])this[_0x533793(0x1a2)]=await this[_0x533793(0x1d0)][_0x533793(0x16c)](this[_0x533793(0x182)][_0x533793(0x18b)]);else this['commitData'][_0x533793(0x1b1)]&&(this[_0x533793(0x1a2)]=await this[_0x533793(0x1d0)][_0x533793(0x1a7)](this[_0x533793(0x182)]['syncBranchId']));}catch(_0x35340c){throw new bad_request_error_1[(_0x533793(0x197))](errors_1[_0x533793(0x1be)]);}}async['getComponentsToWrite'](){const _0x39c17d=a104_0x3e28f0;if(!this[_0x39c17d(0x182)]['commitAttachmentId'])return[];await this[_0x39c17d(0x17b)]['patchObject'](constants_1[_0x39c17d(0x1ba)],this[_0x39c17d(0x182)][_0x39c17d(0x189)],{'Name':(0x0,shortid_1['default'])()});const _0x2f027a=await this[_0x39c17d(0x17b)][_0x39c17d(0x1af)](this[_0x39c17d(0x182)][_0x39c17d(0x189)])[_0x39c17d(0x17c)](_0x8315b7=>_0x8315b7[_0x39c17d(0x1a3)]('\x20')[_0x39c17d(0x1b8)](_0x4dba2d=>_0x4dba2d[_0x39c17d(0x1b7)]()));await this['salesforceService'][_0x39c17d(0x18c)](this[_0x39c17d(0x182)]['commitAttachmentId']);const _0x26a891=new salesforce_retriever_service_1[(_0x39c17d(0x199))](this['salesforceService']);return await _0x26a891['run'](_0x2f027a);}async['getComponentsToDelete'](){const _0x477e3a=a104_0x3e28f0;if(!this[_0x477e3a(0x182)][_0x477e3a(0x1c6)])return[];await this[_0x477e3a(0x17b)][_0x477e3a(0x170)](constants_1[_0x477e3a(0x1ba)],this[_0x477e3a(0x182)][_0x477e3a(0x1c6)],{'Name':(0x0,shortid_1[_0x477e3a(0x16b)])()});const _0x28cf5d=await this[_0x477e3a(0x17b)][_0x477e3a(0x1af)](this[_0x477e3a(0x182)]['deleteAttachmentId']);return await this['salesforceService'][_0x477e3a(0x18c)](this[_0x477e3a(0x182)][_0x477e3a(0x1c6)]),_0x28cf5d;}async['getCommitDto'](){const _0x3ee52d=a104_0x3e28f0,_0x2083b8=new commit_components_dto_1['CommitComponentsDto'](),[_0x3fe108,_0x55076e]=await Promise[_0x3ee52d(0x168)]([this[_0x3ee52d(0x190)](),this[_0x3ee52d(0x1bf)]()]);return _0x2083b8[_0x3ee52d(0x18d)]=this[_0x3ee52d(0x182)][_0x3ee52d(0x18d)],_0x2083b8[_0x3ee52d(0x1c5)]=this[_0x3ee52d(0x182)][_0x3ee52d(0x1c5)],_0x2083b8['components']={'writed':_0x3fe108,'deleted':_0x55076e},_0x2083b8[_0x3ee52d(0x19e)]=this[_0x3ee52d(0x167)][_0x3ee52d(0x191)],_0x2083b8[_0x3ee52d(0x1cf)]=this[_0x3ee52d(0x187)],_0x2083b8[_0x3ee52d(0x17d)]=this[_0x3ee52d(0x17d)],_0x2083b8[_0x3ee52d(0x163)]=this['config'][_0x3ee52d(0x181)],_0x2083b8;}async['updateLastCommit'](_0x5dc9b7=![]){const _0x5c0890=a104_0x3e28f0;if(_0x5dc9b7)await this[_0x5c0890(0x1d0)]['updateRemoteState'](this['repositoryData'],{});else{const _0x4eb3a5=await this[_0x5c0890(0x187)][_0x5c0890(0x183)]['getOne'](this[_0x5c0890(0x17d)][_0x5c0890(0x1b9)]);this['sfLogger'][_0x5c0890(0x17f)](this[_0x5c0890(0x164)]+_0x5c0890(0x171));const _0x13e6c0={[this[_0x5c0890(0x187)]['gitUrl']]:{'lastCommit':_0x4eb3a5[_0x5c0890(0x1c3)]}};await this[_0x5c0890(0x1d0)]['updateRemoteState'](this[_0x5c0890(0x1a2)],_0x13e6c0);}}async[a104_0x3e28f0(0x1b6)](){const _0x2f32c9=a104_0x3e28f0,_0x1e36bd=await this['getCommitDto']();await this[_0x2f32c9(0x1d0)][_0x2f32c9(0x1a0)](this[_0x2f32c9(0x1a2)],_0x2f32c9(0x1ae)),await this[_0x2f32c9(0x16e)]['run'](_0x1e36bd,this['prefix']),await this[_0x2f32c9(0x19d)](),await this[_0x2f32c9(0x1d0)][_0x2f32c9(0x1a0)](this[_0x2f32c9(0x1a2)],_0x2f32c9(0x18f));}async[a104_0x3e28f0(0x1b3)](_0x2723d1){const _0x2c1e8c=a104_0x3e28f0;try{this['sfLogger'][_0x2c1e8c(0x184)](''+_0x2723d1),await this[_0x2c1e8c(0x1a4)][_0x2c1e8c(0x19a)](),await this[_0x2c1e8c(0x19d)](!![]),await this['salesforceSync'][_0x2c1e8c(0x1a0)](this[_0x2c1e8c(0x1a2)],_0x2c1e8c(0x1c4));}catch(_0x104f47){this[_0x2c1e8c(0x1c0)]['error'](_0x104f47);}}async[a104_0x3e28f0(0x16a)](_0x3b5b78){const _0x5c2989=a104_0x3e28f0;try{this['commitData']=_0x3b5b78,this['gitApiService']=typedi_1['Container'][_0x5c2989(0x1cc)](providers_tokens_1[_0x5c2989(0x1c9)]['gitApiService']),this[_0x5c2989(0x1b0)]=typedi_1[_0x5c2989(0x186)][_0x5c2989(0x1cc)](providers_tokens_1[_0x5c2989(0x1c9)][_0x5c2989(0x177)]),this[_0x5c2989(0x167)]=typedi_1[_0x5c2989(0x186)][_0x5c2989(0x1cc)](providers_tokens_1[_0x5c2989(0x1c9)]['config']),await this[_0x5c2989(0x17e)](),this[_0x5c2989(0x187)]=await this['repoService']['getOne'](this['repositoryData'][_0x5c2989(0x198)]),this[_0x5c2989(0x17d)]=await this[_0x5c2989(0x187)][_0x5c2989(0x183)][_0x5c2989(0x1c1)](this[_0x5c2989(0x1a2)][_0x5c2989(0x1c7)]),this[_0x5c2989(0x1a4)]=typedi_1[_0x5c2989(0x186)][_0x5c2989(0x1cc)](providers_tokens_1[_0x5c2989(0x1c9)][_0x5c2989(0x1c0)]),this['prefix']='[FLOSUM\x20->\x20GIT]\x20['+this[_0x5c2989(0x167)][_0x5c2989(0x181)][_0x5c2989(0x1ce)]()+']\x20[Repository:\x20'+this[_0x5c2989(0x1a2)][_0x5c2989(0x198)]+_0x5c2989(0x165)+this[_0x5c2989(0x1a2)][_0x5c2989(0x1c7)]+_0x5c2989(0x192)+FlosumCommitJob_1[_0x5c2989(0x1b9)]+']';if(!this[_0x5c2989(0x1a2)])throw new bad_request_error_1[(_0x5c2989(0x197))](errors_1[_0x5c2989(0x1b2)]);await this[_0x5c2989(0x1a4)][_0x5c2989(0x17f)](this[_0x5c2989(0x164)]+'\x20Start\x20Flosum\x20commit\x20job.')['send'](),await this[_0x5c2989(0x1b6)]()[_0x5c2989(0x1a1)](_0x2ff5e0=>this[_0x5c2989(0x1b3)](_0x2ff5e0));}catch(_0x34da70){this[_0x5c2989(0x182)]=undefined,this[_0x5c2989(0x1c0)][_0x5c2989(0x184)](_0x34da70);throw _0x34da70;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a104_0x3e28f0(0x1d2),[salesforce_service_1[a104_0x3e28f0(0x16f)],commit_components_job_1[a104_0x3e28f0(0x1c8)],salesforce_sync_service_1[a104_0x3e28f0(0x169)]])],FlosumCommitJob),exports[a104_0x3e28f0(0x166)]=FlosumCommitJob;