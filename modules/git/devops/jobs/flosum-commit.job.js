const a125_0x17cb1d=a125_0x4bc1;(function(_0x3c606c,_0x4ca737){const _0x2a0f68=a125_0x4bc1,_0x4c6b5d=_0x3c606c();while(!![]){try{const _0x4bd944=-parseInt(_0x2a0f68(0x14a))/0x1+parseInt(_0x2a0f68(0x12c))/0x2*(-parseInt(_0x2a0f68(0x149))/0x3)+-parseInt(_0x2a0f68(0x1a0))/0x4*(-parseInt(_0x2a0f68(0x17f))/0x5)+parseInt(_0x2a0f68(0x161))/0x6+parseInt(_0x2a0f68(0x186))/0x7+-parseInt(_0x2a0f68(0x148))/0x8*(parseInt(_0x2a0f68(0x185))/0x9)+parseInt(_0x2a0f68(0x177))/0xa;if(_0x4bd944===_0x4ca737)break;else _0x4c6b5d['push'](_0x4c6b5d['shift']());}catch(_0x5afdf5){_0x4c6b5d['push'](_0x4c6b5d['shift']());}}}(a125_0x2fea,0xbd670));const a125_0x7424f6=(function(){let _0xd0d6dc=!![];return function(_0x1c0fd8,_0x573524){const _0x278637=_0xd0d6dc?function(){if(_0x573524){const _0x44644c=_0x573524['apply'](_0x1c0fd8,arguments);return _0x573524=null,_0x44644c;}}:function(){};return _0xd0d6dc=![],_0x278637;};}()),a125_0x4a54bd=a125_0x7424f6(this,function(){const _0x7207b9=a125_0x4bc1;return a125_0x4a54bd[_0x7207b9(0x133)]()[_0x7207b9(0x16e)](_0x7207b9(0x137))[_0x7207b9(0x133)]()[_0x7207b9(0x18a)](a125_0x4a54bd)['search'](_0x7207b9(0x137));});a125_0x4a54bd();function a125_0x2fea(){const _0x1e1d22=['exec','error','../../salesforce/services/salesforce-retriever.service','logger','recordType','Tokens','search','email','BadRequestError','getComponentsToDelete','salesforceService','completeNotification','handleCommitJobError','defineProperty','config','15763540LJAPHP','commitData','syncBranchId','fetchRepositoryData',']\x20[Repository:\x20','shortid','getOne','../../notifications/commit-to-git-completed.notification','50OlrzjS','CommitToGitCompletedNotification','[FLOSUM\x20->\x20GIT]\x20[','all','toUpperCase','../../../../constants/errors','4419hYzVsQ','9098467xPYnVp','../../providers/providers.tokens','repositoryName','SalesforceSyncService','constructor','metadata','trim','name','catch','SalesforceService','function','isEmailNotificationsEnabled','__importDefault','../../notifications/commit-to-git-error.notification','prefix','getComponentsToWrite','__decorate','../../../../core/errors/bad-request.error','deleteAttachmentId','setStatus','\x20Update\x20remote\x20state.','../../salesforce/services/salesforce-sync.service','Logger','Container','repositoryData','message','140048EITcDi','patchObject','gitUrl','updateLastCommit','repoService','send','2FpsnBK','design:paramtypes','commitAttachmentId','CommitComponentsJob','Email\x20notifications\x20are\x20disabled.','./commit-components.job','ERR_INVALID_SYNC_RECORD_ID','toString',']\x20[Branch:\x20','convertToSFDX','execute','(((.+)+)+)+$','default','../../salesforce/services/salesforce.service','CommitComponentsDto','../../../../core','CommitToGitErrorNotification','get','log','commitJob','gitRepoService','branchName','recordTypeName','FlosumCommitJob','gitApiService','Error','FLOSUM_ATTACHMENT','run','14008wLwhiO','3924087ghRyDg','1377327zTWpxz','syncRepositoryId','../../../../constants','provider','sha','updateRemoteState','length','../dto/commit-components.dto','getCommitDto','repo','salesforceSync','Completed','user','branch','split','repository','gitProvider','info','getBranchRecord','deleteAttachment','components','parse','SalesforceRetrieverService','6567804YvduQb','retrieveAttachment','sfLogger','errorNotification','then','branches','ERR_UNKNOWN_SYNC_RECORD_ID'];a125_0x2fea=function(){return _0x1e1d22;};return a125_0x2fea();}'use strict';var __decorate=this&&this[a125_0x17cb1d(0x196)]||function(_0x31a34d,_0x42f84a,_0x5e5667,_0x2d566c){const _0x165f0e=a125_0x17cb1d;var _0x400596=arguments[_0x165f0e(0x150)],_0x313e3c=_0x400596<0x3?_0x42f84a:_0x2d566c===null?_0x2d566c=Object['getOwnPropertyDescriptor'](_0x42f84a,_0x5e5667):_0x2d566c,_0xc84567;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x165f0e(0x190))_0x313e3c=Reflect['decorate'](_0x31a34d,_0x42f84a,_0x5e5667,_0x2d566c);else{for(var _0x24ef37=_0x31a34d[_0x165f0e(0x150)]-0x1;_0x24ef37>=0x0;_0x24ef37--)if(_0xc84567=_0x31a34d[_0x24ef37])_0x313e3c=(_0x400596<0x3?_0xc84567(_0x313e3c):_0x400596>0x3?_0xc84567(_0x42f84a,_0x5e5667,_0x313e3c):_0xc84567(_0x42f84a,_0x5e5667))||_0x313e3c;}return _0x400596>0x3&&_0x313e3c&&Object[_0x165f0e(0x175)](_0x42f84a,_0x5e5667,_0x313e3c),_0x313e3c;},__metadata=this&&this['__metadata']||function(_0x5771e5,_0x2d1bc1){const _0x129781=a125_0x17cb1d;if(typeof Reflect==='object'&&typeof Reflect[_0x129781(0x18b)]===_0x129781(0x190))return Reflect[_0x129781(0x18b)](_0x5771e5,_0x2d1bc1);},__importDefault=this&&this[a125_0x17cb1d(0x192)]||function(_0x5174b8){return _0x5174b8&&_0x5174b8['__esModule']?_0x5174b8:{'default':_0x5174b8};},FlosumCommitJob_1;function a125_0x4bc1(_0x5295bc,_0x18684e){const _0x2d3cad=a125_0x2fea();return a125_0x4bc1=function(_0x4a54bd,_0x7424f6){_0x4a54bd=_0x4a54bd-0x12b;let _0x2fead2=_0x2d3cad[_0x4a54bd];return _0x2fead2;},a125_0x4bc1(_0x5295bc,_0x18684e);}Object[a125_0x17cb1d(0x175)](exports,'__esModule',{'value':!![]}),exports[a125_0x17cb1d(0x143)]=void 0x0;const core_1=require(a125_0x17cb1d(0x13b)),salesforce_service_1=require(a125_0x17cb1d(0x139)),typedi_1=require('typedi'),errors_1=require(a125_0x17cb1d(0x184)),bad_request_error_1=require(a125_0x17cb1d(0x197)),salesforce_retriever_service_1=require(a125_0x17cb1d(0x16a)),salesforce_sync_service_1=require(a125_0x17cb1d(0x19b)),commit_components_dto_1=require(a125_0x17cb1d(0x151)),commit_components_job_1=require(a125_0x17cb1d(0x131)),constants_1=require(a125_0x17cb1d(0x14c)),shortid_1=__importDefault(require(a125_0x17cb1d(0x17c))),providers_tokens_1=require(a125_0x17cb1d(0x187)),commit_to_git_completed_notification_1=require(a125_0x17cb1d(0x17e)),commit_to_git_error_notification_1=require(a125_0x17cb1d(0x193));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x4814a8,_0x185e51,_0x3cf63f){const _0x398bb8=a125_0x17cb1d;this['salesforceService']=_0x4814a8,this[_0x398bb8(0x13f)]=_0x185e51,this['salesforceSync']=_0x3cf63f,this[_0x398bb8(0x16b)]=new core_1[(_0x398bb8(0x19c))](FlosumCommitJob_1['name']);}async[a125_0x17cb1d(0x173)](_0x2c48cf,_0x4724fd,_0x8a2bcc,_0x1d1c72){const _0x129efc=a125_0x17cb1d;if(!this['commitData']['isEmailNotificationsEnabled']){this[_0x129efc(0x16b)]['info'](_0x129efc(0x130));return;}await new commit_to_git_completed_notification_1[(_0x129efc(0x180))]({'emails':_0x2c48cf,'gitProvider':_0x4724fd,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1[_0x129efc(0x180)][_0x129efc(0x18d)],'repositoryName':_0x8a2bcc,'branchName':_0x1d1c72})[_0x129efc(0x136)]();}async[a125_0x17cb1d(0x164)](_0x46a0f5,_0x105a92,_0x251e68,_0x385788){const _0x46f188=a125_0x17cb1d;if(!this[_0x46f188(0x178)][_0x46f188(0x191)]){this[_0x46f188(0x16b)][_0x46f188(0x15b)]('Email\x20notifications\x20are\x20disabled.');return;}await new commit_to_git_error_notification_1[(_0x46f188(0x13c))]({'emails':_0x46a0f5,'gitProvider':_0x105a92,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0x46f188(0x13c)]['name'],'repositoryName':_0x251e68,'branchName':_0x385788})[_0x46f188(0x136)]();}async['fetchRepositoryData'](){const _0x2e00ca=a125_0x17cb1d;try{if(this[_0x2e00ca(0x178)][_0x2e00ca(0x14b)])this[_0x2e00ca(0x19e)]=await this[_0x2e00ca(0x154)]['getRepositoryRecord'](this[_0x2e00ca(0x178)][_0x2e00ca(0x14b)]);else this['commitData']['syncBranchId']&&(this[_0x2e00ca(0x19e)]=await this[_0x2e00ca(0x154)][_0x2e00ca(0x15c)](this[_0x2e00ca(0x178)][_0x2e00ca(0x179)]));}catch(_0x17669c){throw new bad_request_error_1[(_0x2e00ca(0x170))](errors_1[_0x2e00ca(0x132)]);}}async['getComponentsToWrite'](){const _0x11c58a=a125_0x17cb1d;if(!this[_0x11c58a(0x178)][_0x11c58a(0x12e)])return[];await this[_0x11c58a(0x172)][_0x11c58a(0x1a1)](constants_1[_0x11c58a(0x146)],this['commitData'][_0x11c58a(0x12e)],{'Name':(0x0,shortid_1[_0x11c58a(0x138)])()});const _0x1665f3=await this[_0x11c58a(0x172)][_0x11c58a(0x162)](this[_0x11c58a(0x178)][_0x11c58a(0x12e)])[_0x11c58a(0x165)](_0x4c06b1=>_0x4c06b1[_0x11c58a(0x158)]('\x20')['map'](_0x26ee2f=>_0x26ee2f[_0x11c58a(0x18c)]()));await this[_0x11c58a(0x172)][_0x11c58a(0x15d)](this[_0x11c58a(0x178)][_0x11c58a(0x12e)]);const _0x3ed985=new salesforce_retriever_service_1[(_0x11c58a(0x160))](this[_0x11c58a(0x172)]);return await _0x3ed985[_0x11c58a(0x147)](_0x1665f3);}async['getComponentsToDelete'](){const _0x1d2781=a125_0x17cb1d;if(!this['commitData']['deleteAttachmentId'])return[];await this['salesforceService']['patchObject'](constants_1[_0x1d2781(0x146)],this[_0x1d2781(0x178)][_0x1d2781(0x198)],{'Name':(0x0,shortid_1[_0x1d2781(0x138)])()});const _0x2849e2=await this['salesforceService'][_0x1d2781(0x162)](this[_0x1d2781(0x178)]['deleteAttachmentId']),_0x2f7e07=JSON[_0x1d2781(0x15f)](_0x2849e2);return await this[_0x1d2781(0x172)][_0x1d2781(0x15d)](this[_0x1d2781(0x178)]['deleteAttachmentId']),_0x2f7e07;}async[a125_0x17cb1d(0x152)](){const _0x455019=a125_0x17cb1d,_0x586909=new commit_components_dto_1[(_0x455019(0x13a))](),[_0x103256,_0x2f451b]=await Promise[_0x455019(0x182)]([this[_0x455019(0x195)](),this[_0x455019(0x171)]()]);return _0x586909[_0x455019(0x19f)]=this[_0x455019(0x178)][_0x455019(0x19f)],_0x586909[_0x455019(0x156)]=this['commitData'][_0x455019(0x156)],_0x586909[_0x455019(0x15e)]={'writed':_0x103256,'deleted':_0x2f451b},_0x586909[_0x455019(0x135)]=this[_0x455019(0x176)]['isConvertToSfdx'],_0x586909[_0x455019(0x153)]=this[_0x455019(0x159)],_0x586909['branch']=this[_0x455019(0x157)],_0x586909[_0x455019(0x14d)]=this[_0x455019(0x176)][_0x455019(0x15a)],_0x586909[_0x455019(0x16c)]=this['repositoryData'][_0x455019(0x142)],_0x586909;}async[a125_0x17cb1d(0x1a3)](_0x5521f9=![]){const _0x336655=a125_0x17cb1d;if(_0x5521f9)await this[_0x336655(0x154)][_0x336655(0x14f)](this[_0x336655(0x19e)],{});else{const _0x1cfb87=await this[_0x336655(0x159)][_0x336655(0x166)]['getOne'](this[_0x336655(0x157)]['name']);this[_0x336655(0x163)]['log'](this['prefix']+_0x336655(0x19a));const _0xa22421={[this[_0x336655(0x159)][_0x336655(0x1a2)]]:{'lastCommit':_0x1cfb87[_0x336655(0x14e)]}};await this['salesforceSync'][_0x336655(0x14f)](this[_0x336655(0x19e)],_0xa22421);}}async[a125_0x17cb1d(0x168)](){const _0x2c6893=a125_0x17cb1d,_0x563715=await this[_0x2c6893(0x152)]();await this[_0x2c6893(0x154)]['setStatus'](this[_0x2c6893(0x19e)],'In\x20Progress'),await this[_0x2c6893(0x13f)][_0x2c6893(0x147)](_0x563715,this['prefix']),await this[_0x2c6893(0x1a3)](),await this[_0x2c6893(0x154)]['setStatus'](this['repositoryData'],_0x2c6893(0x155));}async[a125_0x17cb1d(0x174)](_0xa04f5){const _0xe2377a=a125_0x17cb1d;try{this[_0xe2377a(0x163)][_0xe2377a(0x169)](''+_0xa04f5),await this['sfLogger'][_0xe2377a(0x12b)](),await this['updateLastCommit'](!![]),await this[_0xe2377a(0x154)][_0xe2377a(0x199)](this[_0xe2377a(0x19e)],_0xe2377a(0x145)),await this['completeNotification']([this[_0xe2377a(0x178)]['user'][_0xe2377a(0x16f)]],this[_0xe2377a(0x176)][_0xe2377a(0x15a)],this[_0xe2377a(0x159)][_0xe2377a(0x18d)],this[_0xe2377a(0x157)]['name']);}catch(_0x438a13){this[_0xe2377a(0x16b)]['error'](_0x438a13),await this[_0xe2377a(0x164)]([this[_0xe2377a(0x178)][_0xe2377a(0x156)][_0xe2377a(0x16f)]],this[_0xe2377a(0x176)][_0xe2377a(0x15a)],this[_0xe2377a(0x159)][_0xe2377a(0x18d)],this[_0xe2377a(0x157)][_0xe2377a(0x18d)]);}}async[a125_0x17cb1d(0x147)](_0x3f209c){const _0x94dce2=a125_0x17cb1d;try{this[_0x94dce2(0x178)]=_0x3f209c,this[_0x94dce2(0x144)]=typedi_1[_0x94dce2(0x19d)]['get'](providers_tokens_1[_0x94dce2(0x16d)]['gitApiService']),this[_0x94dce2(0x1a4)]=typedi_1[_0x94dce2(0x19d)]['get'](providers_tokens_1['Tokens'][_0x94dce2(0x140)]),this[_0x94dce2(0x176)]=typedi_1['Container'][_0x94dce2(0x13d)](providers_tokens_1['Tokens'][_0x94dce2(0x176)]),await this[_0x94dce2(0x17a)](),this[_0x94dce2(0x159)]=await this[_0x94dce2(0x1a4)][_0x94dce2(0x17d)](this['repositoryData'][_0x94dce2(0x188)]),this[_0x94dce2(0x157)]=await this[_0x94dce2(0x159)][_0x94dce2(0x166)][_0x94dce2(0x17d)](this[_0x94dce2(0x19e)]['branchName']),this[_0x94dce2(0x163)]=typedi_1[_0x94dce2(0x19d)][_0x94dce2(0x13d)](providers_tokens_1[_0x94dce2(0x16d)]['logger']),this['prefix']=_0x94dce2(0x181)+this[_0x94dce2(0x176)][_0x94dce2(0x15a)][_0x94dce2(0x183)]()+_0x94dce2(0x17b)+this[_0x94dce2(0x19e)][_0x94dce2(0x188)]+_0x94dce2(0x134)+this['repositoryData'][_0x94dce2(0x141)]+']\x20['+FlosumCommitJob_1[_0x94dce2(0x18d)]+']';if(!this[_0x94dce2(0x19e)])throw new bad_request_error_1[(_0x94dce2(0x170))](errors_1[_0x94dce2(0x167)]);await this[_0x94dce2(0x163)][_0x94dce2(0x13e)](this[_0x94dce2(0x194)]+'\x20Start\x20Flosum\x20commit\x20job.')[_0x94dce2(0x12b)](),await this[_0x94dce2(0x168)]()[_0x94dce2(0x18e)](_0x507f99=>this[_0x94dce2(0x174)](_0x507f99)),await this[_0x94dce2(0x173)]([this[_0x94dce2(0x178)][_0x94dce2(0x156)]['email']],this[_0x94dce2(0x176)]['gitProvider'],this[_0x94dce2(0x159)][_0x94dce2(0x18d)],this['branch'][_0x94dce2(0x18d)]);}catch(_0x5e46b8){this[_0x94dce2(0x178)]=undefined,this[_0x94dce2(0x16b)][_0x94dce2(0x169)](_0x5e46b8),await this[_0x94dce2(0x164)]([this[_0x94dce2(0x178)]['user'][_0x94dce2(0x16f)]],this[_0x94dce2(0x176)][_0x94dce2(0x15a)],this[_0x94dce2(0x159)]['name'],this[_0x94dce2(0x157)][_0x94dce2(0x18d)]);throw _0x5e46b8;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a125_0x17cb1d(0x12d),[salesforce_service_1[a125_0x17cb1d(0x18f)],commit_components_job_1[a125_0x17cb1d(0x12f)],salesforce_sync_service_1[a125_0x17cb1d(0x189)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;