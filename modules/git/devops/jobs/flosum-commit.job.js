const a61_0x161235=a61_0xfe8c;(function(_0x10e7d0,_0x15421d){const _0x2a6aee=a61_0xfe8c,_0x11871b=_0x10e7d0();while(!![]){try{const _0x305e9c=parseInt(_0x2a6aee(0x1b8))/0x1+parseInt(_0x2a6aee(0x1ed))/0x2+parseInt(_0x2a6aee(0x1c1))/0x3+parseInt(_0x2a6aee(0x1d8))/0x4+parseInt(_0x2a6aee(0x1f7))/0x5*(parseInt(_0x2a6aee(0x1a2))/0x6)+parseInt(_0x2a6aee(0x1e9))/0x7+parseInt(_0x2a6aee(0x1cb))/0x8*(-parseInt(_0x2a6aee(0x202))/0x9);if(_0x305e9c===_0x15421d)break;else _0x11871b['push'](_0x11871b['shift']());}catch(_0x406081){_0x11871b['push'](_0x11871b['shift']());}}}(a61_0x2b3d,0xe6c6c));const a61_0x12eb2e=(function(){let _0x44d414=!![];return function(_0x1ecf13,_0x4feb4f){const _0x39ff86=_0x44d414?function(){const _0x2b1333=a61_0xfe8c;if(_0x4feb4f){const _0x39fbde=_0x4feb4f[_0x2b1333(0x1d2)](_0x1ecf13,arguments);return _0x4feb4f=null,_0x39fbde;}}:function(){};return _0x44d414=![],_0x39ff86;};}()),a61_0x12a094=a61_0x12eb2e(this,function(){const _0xef4fc5=a61_0xfe8c;return a61_0x12a094[_0xef4fc5(0x1b5)]()[_0xef4fc5(0x196)](_0xef4fc5(0x1be))[_0xef4fc5(0x1b5)]()[_0xef4fc5(0x1a7)](a61_0x12a094)[_0xef4fc5(0x196)]('(((.+)+)+)+$');});a61_0x12a094();'use strict';var __decorate=this&&this[a61_0x161235(0x1a0)]||function(_0x4c0369,_0x2a3d63,_0x2db142,_0x41eec1){const _0x1b24c3=a61_0x161235;var _0x279387=arguments[_0x1b24c3(0x1b3)],_0x425c2c=_0x279387<0x3?_0x2a3d63:_0x41eec1===null?_0x41eec1=Object[_0x1b24c3(0x1ee)](_0x2a3d63,_0x2db142):_0x41eec1,_0xc4597e;if(typeof Reflect===_0x1b24c3(0x1c2)&&typeof Reflect[_0x1b24c3(0x1df)]==='function')_0x425c2c=Reflect['decorate'](_0x4c0369,_0x2a3d63,_0x2db142,_0x41eec1);else{for(var _0x2df3b4=_0x4c0369[_0x1b24c3(0x1b3)]-0x1;_0x2df3b4>=0x0;_0x2df3b4--)if(_0xc4597e=_0x4c0369[_0x2df3b4])_0x425c2c=(_0x279387<0x3?_0xc4597e(_0x425c2c):_0x279387>0x3?_0xc4597e(_0x2a3d63,_0x2db142,_0x425c2c):_0xc4597e(_0x2a3d63,_0x2db142))||_0x425c2c;}return _0x279387>0x3&&_0x425c2c&&Object['defineProperty'](_0x2a3d63,_0x2db142,_0x425c2c),_0x425c2c;},__metadata=this&&this[a61_0x161235(0x1ec)]||function(_0x50eefe,_0x6f09e6){const _0x5eaa65=a61_0x161235;if(typeof Reflect===_0x5eaa65(0x1c2)&&typeof Reflect[_0x5eaa65(0x1a9)]===_0x5eaa65(0x19e))return Reflect['metadata'](_0x50eefe,_0x6f09e6);},__importDefault=this&&this[a61_0x161235(0x1c7)]||function(_0x44bd11){const _0x2517c9=a61_0x161235;return _0x44bd11&&_0x44bd11[_0x2517c9(0x1cf)]?_0x44bd11:{'default':_0x44bd11};},FlosumCommitJob_1;Object[a61_0x161235(0x1b7)](exports,a61_0x161235(0x1cf),{'value':!![]}),exports[a61_0x161235(0x1a1)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a61_0x161235(0x1cd)),errors_1=require('../../../../constants/errors'),bad_request_error_1=require(a61_0x161235(0x1fd)),salesforce_retriever_service_1=require(a61_0x161235(0x1e1)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require(a61_0x161235(0x1cc)),commit_components_job_1=require(a61_0x161235(0x1e7)),constants_1=require('../../../../constants'),shortid_1=__importDefault(require(a61_0x161235(0x1e5))),providers_tokens_1=require(a61_0x161235(0x1bc));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x36564f,_0x51bb4d,_0x37a942){const _0x3e8842=a61_0x161235;this['salesforceService']=_0x36564f,this[_0x3e8842(0x1fa)]=_0x51bb4d,this[_0x3e8842(0x198)]=_0x37a942,this[_0x3e8842(0x1db)]=new core_1[(_0x3e8842(0x1fc))](FlosumCommitJob_1[_0x3e8842(0x1bf)]);}async[a61_0x161235(0x1d1)](){const _0x4c1292=a61_0x161235;try{if(this[_0x4c1292(0x1a3)][_0x4c1292(0x1e2)])this[_0x4c1292(0x1c4)]=await this['salesforceSync'][_0x4c1292(0x1d0)](this[_0x4c1292(0x1a3)][_0x4c1292(0x1e2)]);else this['commitData']['syncBranchId']&&(this[_0x4c1292(0x1c4)]=await this[_0x4c1292(0x198)][_0x4c1292(0x1f9)](this[_0x4c1292(0x1a3)][_0x4c1292(0x1ae)]));}catch(_0x1f4b5f){throw new bad_request_error_1[(_0x4c1292(0x200))](errors_1[_0x4c1292(0x199)]);}}async[a61_0x161235(0x1f0)](){const _0x20a8e0=a61_0x161235;if(!this[_0x20a8e0(0x1a3)][_0x20a8e0(0x197)])return[];await this[_0x20a8e0(0x1ab)][_0x20a8e0(0x1b1)](constants_1[_0x20a8e0(0x19f)],this[_0x20a8e0(0x1a3)][_0x20a8e0(0x197)],{'Name':shortid_1[_0x20a8e0(0x1ca)]()});const _0x22072a=await this['salesforceService'][_0x20a8e0(0x1af)](this[_0x20a8e0(0x1a3)][_0x20a8e0(0x197)])['then'](_0xc6bfc5=>_0xc6bfc5[_0x20a8e0(0x1a5)]('\x20')['map'](_0x26436e=>_0x26436e['trim']()));await this[_0x20a8e0(0x1ab)][_0x20a8e0(0x1da)](this['commitData'][_0x20a8e0(0x197)]);const _0x42e1cc=new salesforce_retriever_service_1[(_0x20a8e0(0x1ad))](this[_0x20a8e0(0x1ab)]);return await _0x42e1cc[_0x20a8e0(0x1f4)](_0x22072a);}async[a61_0x161235(0x201)](){const _0x314223=a61_0x161235;if(!this[_0x314223(0x1a3)][_0x314223(0x1d9)])return[];await this[_0x314223(0x1ab)][_0x314223(0x1b1)](constants_1[_0x314223(0x19f)],this[_0x314223(0x1a3)][_0x314223(0x1d9)],{'Name':shortid_1[_0x314223(0x1ca)]()});const _0xfe866b=await this['salesforceService'][_0x314223(0x1af)](this['commitData'][_0x314223(0x1d9)]);return await this['salesforceService'][_0x314223(0x1da)](this['commitData'][_0x314223(0x1d9)]),_0xfe866b;}async[a61_0x161235(0x1aa)](){const _0x29a9c1=a61_0x161235,_0xc23a5=new commit_components_dto_1[(_0x29a9c1(0x1c8))](),[_0x47f01e,_0x6093d9]=await Promise['all']([this[_0x29a9c1(0x1f0)](),this[_0x29a9c1(0x201)]()]);return _0xc23a5[_0x29a9c1(0x1e8)]=this[_0x29a9c1(0x1a3)][_0x29a9c1(0x1e8)],_0xc23a5['user']=this[_0x29a9c1(0x1a3)][_0x29a9c1(0x1dc)],_0xc23a5[_0x29a9c1(0x1ef)]={'writed':_0x47f01e,'deleted':_0x6093d9},_0xc23a5[_0x29a9c1(0x1c5)]=this[_0x29a9c1(0x19a)][_0x29a9c1(0x1ce)],_0xc23a5[_0x29a9c1(0x1f8)]=this[_0x29a9c1(0x1f1)],_0xc23a5[_0x29a9c1(0x1c6)]=this[_0x29a9c1(0x1c6)],_0xc23a5[_0x29a9c1(0x19d)]=this[_0x29a9c1(0x19a)][_0x29a9c1(0x1c9)],_0xc23a5;}async[a61_0x161235(0x1b9)](_0x3a63f3=![]){const _0x287f28=a61_0x161235;if(_0x3a63f3)await this['salesforceSync'][_0x287f28(0x1bb)](this[_0x287f28(0x1c4)],{});else{const _0x80763e=await this[_0x287f28(0x1f1)][_0x287f28(0x1f6)]['getOne'](this['branch']['name']);this['sfLogger'][_0x287f28(0x1b4)](this[_0x287f28(0x1bd)]+_0x287f28(0x1ea));const _0x33ca65={[this[_0x287f28(0x1f1)][_0x287f28(0x1dd)]]:{'lastCommit':_0x80763e[_0x287f28(0x1e0)]}};await this['salesforceSync']['updateRemoteState'](this[_0x287f28(0x1c4)],_0x33ca65);}}async[a61_0x161235(0x1ff)](){const _0x532276=a61_0x161235,_0x3fb0fb=await this['getCommitDto']();await this[_0x532276(0x198)][_0x532276(0x1b2)](this[_0x532276(0x1c4)],'In\x20Progress'),await this[_0x532276(0x1fa)]['run'](_0x3fb0fb,this['prefix']),await this['updateLastCommit'](),await this['salesforceSync'][_0x532276(0x1b2)](this['repositoryData'],_0x532276(0x1d5));}async[a61_0x161235(0x1d7)](_0x41be38){const _0x1ee759=a61_0x161235;try{this['sfLogger'][_0x1ee759(0x1de)](''+_0x41be38),await this[_0x1ee759(0x1d6)][_0x1ee759(0x1f3)](),await this[_0x1ee759(0x1b9)](!![]),await this[_0x1ee759(0x198)]['setStatus'](this[_0x1ee759(0x1c4)],_0x1ee759(0x1f2));}catch(_0x3f33ee){this[_0x1ee759(0x1db)]['error'](_0x3f33ee);}}async['run'](_0xbeb1f){const _0x2eef67=a61_0x161235;try{this['commitData']=_0xbeb1f,this[_0x2eef67(0x1fe)]=typedi_1[_0x2eef67(0x1d3)][_0x2eef67(0x1ac)](providers_tokens_1[_0x2eef67(0x1c3)][_0x2eef67(0x1fe)]),this['repoService']=typedi_1[_0x2eef67(0x1d3)][_0x2eef67(0x1ac)](providers_tokens_1[_0x2eef67(0x1c3)][_0x2eef67(0x1a4)]),this[_0x2eef67(0x19a)]=typedi_1['Container'][_0x2eef67(0x1ac)](providers_tokens_1[_0x2eef67(0x1c3)][_0x2eef67(0x19a)]),await this[_0x2eef67(0x1d1)](),this[_0x2eef67(0x1f1)]=await this['repoService'][_0x2eef67(0x1a8)](this[_0x2eef67(0x1c4)]['repositoryName']),this['branch']=await this[_0x2eef67(0x1f1)][_0x2eef67(0x1f6)][_0x2eef67(0x1a8)](this[_0x2eef67(0x1c4)][_0x2eef67(0x19c)]),this[_0x2eef67(0x1d6)]=typedi_1[_0x2eef67(0x1d3)]['get'](providers_tokens_1[_0x2eef67(0x1c3)]['logger']),this[_0x2eef67(0x1bd)]=_0x2eef67(0x1b0)+this[_0x2eef67(0x19a)][_0x2eef67(0x1c9)][_0x2eef67(0x1fb)]()+_0x2eef67(0x1f5)+this['repositoryData'][_0x2eef67(0x1c0)]+_0x2eef67(0x1e6)+this[_0x2eef67(0x1c4)]['branchName']+_0x2eef67(0x1b6)+FlosumCommitJob_1['name']+']';if(!this[_0x2eef67(0x1c4)])throw new bad_request_error_1[(_0x2eef67(0x200))](errors_1[_0x2eef67(0x1eb)]);await this[_0x2eef67(0x1d6)][_0x2eef67(0x1b4)](this['prefix']+_0x2eef67(0x1e3))[_0x2eef67(0x1f3)](),await this[_0x2eef67(0x1ff)]()[_0x2eef67(0x19b)](_0x2e4c6e=>this['handleCommitJobError'](_0x2e4c6e));}catch(_0x587066){this['commitData']=undefined,this[_0x2eef67(0x1db)][_0x2eef67(0x1de)](_0x587066);throw _0x587066;}}};function a61_0xfe8c(_0x284f27,_0x26b3f0){const _0x4dfcf8=a61_0x2b3d();return a61_0xfe8c=function(_0x12a094,_0x12eb2e){_0x12a094=_0x12a094-0x196;let _0x2b3df1=_0x4dfcf8[_0x12a094];return _0x2b3df1;},a61_0xfe8c(_0x284f27,_0x26b3f0);}function a61_0x2b3d(){const _0x1eeba9=['getComponentsToDelete','54wvBvCE','search','commitAttachmentId','salesforceSync','ERR_INVALID_SYNC_RECORD_ID','config','catch','branchName','provider','function','FLOSUM_ATTACHMENT','__decorate','FlosumCommitJob','54CRYghn','commitData','gitRepoService','split','design:paramtypes','constructor','getOne','metadata','getCommitDto','salesforceService','get','SalesforceRetrieverService','syncBranchId','retrieveAttachment','[FLOSUM\x20->\x20GIT]\x20[','patchObject','setStatus','length','log','toString',']\x20[','defineProperty','1510038TCRNdg','updateLastCommit','CommitComponentsJob','updateRemoteState','../../providers/providers.tokens','prefix','(((.+)+)+)+$','name','repositoryName','5282022tRgmiu','object','Tokens','repositoryData','convertToSFDX','branch','__importDefault','CommitComponentsDto','gitProvider','default','8135632QplfPM','../dto/commit-components.dto','typedi','isConvertToSfdx','__esModule','getRepositoryRecord','fetchRepositoryData','apply','Container','SalesforceSyncService','Completed','sfLogger','handleCommitJobError','5014476cKQGMC','deleteAttachmentId','deleteAttachment','logger','user','gitUrl','error','decorate','sha','../../salesforce/services/salesforce-retriever.service','syncRepositoryId','\x20Start\x20Flosum\x20commit\x20job.','Service','shortid',']\x20[Branch:\x20','./commit-components.job','message','4049661JEicUP','\x20Update\x20remote\x20state.','ERR_UNKNOWN_SYNC_RECORD_ID','__metadata','1758410UYEkzc','getOwnPropertyDescriptor','components','getComponentsToWrite','repository','Error','send','run',']\x20[Repository:\x20','branches','591625aLTymz','repo','getBranchRecord','commitJob','toUpperCase','Logger','../../../../core/errors/bad-request.error','gitApiService','exec','BadRequestError'];a61_0x2b3d=function(){return _0x1eeba9;};return a61_0x2b3d();}FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a61_0x161235(0x1e4)]({'transient':!![]}),__metadata(a61_0x161235(0x1a6),[salesforce_service_1['SalesforceService'],commit_components_job_1[a61_0x161235(0x1ba)],salesforce_sync_service_1[a61_0x161235(0x1d4)]])],FlosumCommitJob),exports[a61_0x161235(0x1a1)]=FlosumCommitJob;