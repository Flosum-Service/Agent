const a105_0x165669=a105_0x4118;function a105_0x4f17(){const _0x47f746=['defineProperty','typedi','6054734oLzcTI',']\x20[Branch:\x20','components','prefix','gitUrl','./commit-components.job','object','__importDefault','\x20Update\x20remote\x20state.','__decorate','[FLOSUM\x20->\x20GIT]\x20[','salesforceSync','commitData','SalesforceService','75995LhAxut','Completed','send','repository','getRepositoryRecord','message','sfLogger','split','gitProvider','2828475GDTZnx','10970700QodMhV','commitJob','getBranchRecord','branches','gitApiService','user','Error','commitAttachmentId','565578RSOYRI',']\x20[Repository:\x20','28mcIyCv','repoService','get','constructor','salesforceService','ERR_INVALID_SYNC_RECORD_ID','FLOSUM_ATTACHMENT','8rOCMVL','patchObject','updateLastCommit','branch','name','getComponentsToDelete','default','Tokens','retrieveAttachment','metadata','logger','Container','getComponentsToWrite','search','exec','syncBranchId','CommitComponentsJob','1909790AvLMRx','length','toUpperCase','SalesforceRetrieverService','then','In\x20Progress','getCommitDto','toString','run','CommitComponentsDto','50940Vcxnvp','trim','apply','log','config','getOwnPropertyDescriptor','sha',']\x20[','syncRepositoryId','repositoryData','fetchRepositoryData','setStatus','BadRequestError','__esModule','branchName','repo','Logger','convertToSFDX','372jIKDQS','\x20Start\x20Flosum\x20commit\x20job.','deleteAttachment','deleteAttachmentId','getOne','error','handleCommitJobError','repositoryName','isConvertToSfdx','decorate','../../salesforce/services/salesforce-sync.service','../../../../core/errors/bad-request.error','function','../dto/commit-components.dto','provider','../../../../constants/errors','updateRemoteState','FlosumCommitJob','../../../../constants','../../salesforce/services/salesforce-retriever.service','../../providers/providers.tokens'];a105_0x4f17=function(){return _0x47f746;};return a105_0x4f17();}(function(_0xb2392a,_0x575825){const _0x2472e6=a105_0x4118,_0x1e957a=_0xb2392a();while(!![]){try{const _0xaac221=parseInt(_0x2472e6(0x21e))/0x1+parseInt(_0x2472e6(0x1cb))/0x2+parseInt(_0x2472e6(0x1d5))/0x3*(-parseInt(_0x2472e6(0x220))/0x4)+parseInt(_0x2472e6(0x20c))/0x5*(-parseInt(_0x2472e6(0x1e7))/0x6)+parseInt(_0x2472e6(0x1fe))/0x7*(parseInt(_0x2472e6(0x227))/0x8)+parseInt(_0x2472e6(0x215))/0x9+-parseInt(_0x2472e6(0x216))/0xa;if(_0xaac221===_0x575825)break;else _0x1e957a['push'](_0x1e957a['shift']());}catch(_0x360bdf){_0x1e957a['push'](_0x1e957a['shift']());}}}(a105_0x4f17,0x84302));const a105_0x56b975=(function(){let _0x29a948=!![];return function(_0x48e308,_0x4be99c){const _0x51219f=_0x29a948?function(){const _0x48a57d=a105_0x4118;if(_0x4be99c){const _0x43bee7=_0x4be99c[_0x48a57d(0x1d7)](_0x48e308,arguments);return _0x4be99c=null,_0x43bee7;}}:function(){};return _0x29a948=![],_0x51219f;};}()),a105_0x5ecac3=a105_0x56b975(this,function(){const _0x227548=a105_0x4118;return a105_0x5ecac3['toString']()[_0x227548(0x1c7)]('(((.+)+)+)+$')[_0x227548(0x1d2)]()[_0x227548(0x223)](a105_0x5ecac3)[_0x227548(0x1c7)]('(((.+)+)+)+$');});a105_0x5ecac3();'use strict';var __decorate=this&&this[a105_0x165669(0x207)]||function(_0xb979ca,_0x495703,_0x218a45,_0x2fcf53){const _0x2c00a8=a105_0x165669;var _0x471e67=arguments[_0x2c00a8(0x1cc)],_0x58274a=_0x471e67<0x3?_0x495703:_0x2fcf53===null?_0x2fcf53=Object[_0x2c00a8(0x1da)](_0x495703,_0x218a45):_0x2fcf53,_0x13276f;if(typeof Reflect===_0x2c00a8(0x204)&&typeof Reflect[_0x2c00a8(0x1f0)]===_0x2c00a8(0x1f3))_0x58274a=Reflect['decorate'](_0xb979ca,_0x495703,_0x218a45,_0x2fcf53);else{for(var _0x5c24ae=_0xb979ca['length']-0x1;_0x5c24ae>=0x0;_0x5c24ae--)if(_0x13276f=_0xb979ca[_0x5c24ae])_0x58274a=(_0x471e67<0x3?_0x13276f(_0x58274a):_0x471e67>0x3?_0x13276f(_0x495703,_0x218a45,_0x58274a):_0x13276f(_0x495703,_0x218a45))||_0x58274a;}return _0x471e67>0x3&&_0x58274a&&Object['defineProperty'](_0x495703,_0x218a45,_0x58274a),_0x58274a;},__metadata=this&&this['__metadata']||function(_0x287181,_0x448307){const _0x3a2cdf=a105_0x165669;if(typeof Reflect===_0x3a2cdf(0x204)&&typeof Reflect[_0x3a2cdf(0x230)]===_0x3a2cdf(0x1f3))return Reflect[_0x3a2cdf(0x230)](_0x287181,_0x448307);},__importDefault=this&&this[a105_0x165669(0x205)]||function(_0x4d7049){const _0x177314=a105_0x165669;return _0x4d7049&&_0x4d7049[_0x177314(0x1e2)]?_0x4d7049:{'default':_0x4d7049};},FlosumCommitJob_1;function a105_0x4118(_0x30ce19,_0x59df12){const _0x3856a7=a105_0x4f17();return a105_0x4118=function(_0x5ecac3,_0x56b975){_0x5ecac3=_0x5ecac3-0x1c6;let _0x4f17b0=_0x3856a7[_0x5ecac3];return _0x4f17b0;},a105_0x4118(_0x30ce19,_0x59df12);}Object[a105_0x165669(0x1fc)](exports,a105_0x165669(0x1e2),{'value':!![]}),exports[a105_0x165669(0x1f8)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a105_0x165669(0x1fd)),errors_1=require(a105_0x165669(0x1f6)),bad_request_error_1=require(a105_0x165669(0x1f2)),salesforce_retriever_service_1=require(a105_0x165669(0x1fa)),salesforce_sync_service_1=require(a105_0x165669(0x1f1)),commit_components_dto_1=require(a105_0x165669(0x1f4)),commit_components_job_1=require(a105_0x165669(0x203)),constants_1=require(a105_0x165669(0x1f9)),shortid_1=__importDefault(require('shortid')),providers_tokens_1=require(a105_0x165669(0x1fb));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x2f775d,_0xed9213,_0x292913){const _0x27e6a2=a105_0x165669;this[_0x27e6a2(0x224)]=_0x2f775d,this[_0x27e6a2(0x217)]=_0xed9213,this[_0x27e6a2(0x209)]=_0x292913,this[_0x27e6a2(0x231)]=new core_1[(_0x27e6a2(0x1e5))](FlosumCommitJob_1[_0x27e6a2(0x22b)]);}async[a105_0x165669(0x1df)](){const _0x390e58=a105_0x165669;try{if(this['commitData'][_0x390e58(0x1dd)])this[_0x390e58(0x1de)]=await this[_0x390e58(0x209)][_0x390e58(0x210)](this[_0x390e58(0x20a)][_0x390e58(0x1dd)]);else this[_0x390e58(0x20a)][_0x390e58(0x1c9)]&&(this[_0x390e58(0x1de)]=await this[_0x390e58(0x209)][_0x390e58(0x218)](this['commitData'][_0x390e58(0x1c9)]));}catch(_0x6630fe){throw new bad_request_error_1[(_0x390e58(0x1e1))](errors_1[_0x390e58(0x225)]);}}async[a105_0x165669(0x1c6)](){const _0x4a5df2=a105_0x165669;if(!this[_0x4a5df2(0x20a)][_0x4a5df2(0x21d)])return[];await this[_0x4a5df2(0x224)][_0x4a5df2(0x228)](constants_1[_0x4a5df2(0x226)],this[_0x4a5df2(0x20a)][_0x4a5df2(0x21d)],{'Name':(0x0,shortid_1[_0x4a5df2(0x22d)])()});const _0x2f6f46=await this[_0x4a5df2(0x224)][_0x4a5df2(0x22f)](this['commitData'][_0x4a5df2(0x21d)])[_0x4a5df2(0x1cf)](_0x201953=>_0x201953[_0x4a5df2(0x213)]('\x20')['map'](_0x1b14cb=>_0x1b14cb[_0x4a5df2(0x1d6)]()));await this[_0x4a5df2(0x224)][_0x4a5df2(0x1e9)](this[_0x4a5df2(0x20a)][_0x4a5df2(0x21d)]);const _0x24c309=new salesforce_retriever_service_1[(_0x4a5df2(0x1ce))](this[_0x4a5df2(0x224)]);return await _0x24c309['run'](_0x2f6f46);}async[a105_0x165669(0x22c)](){const _0x18742d=a105_0x165669;if(!this[_0x18742d(0x20a)][_0x18742d(0x1ea)])return[];await this[_0x18742d(0x224)]['patchObject'](constants_1[_0x18742d(0x226)],this[_0x18742d(0x20a)]['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0x18742d(0x22d)])()});const _0x1c16e1=await this[_0x18742d(0x224)]['retrieveAttachment'](this[_0x18742d(0x20a)][_0x18742d(0x1ea)]);return await this[_0x18742d(0x224)][_0x18742d(0x1e9)](this['commitData'][_0x18742d(0x1ea)]),_0x1c16e1;}async[a105_0x165669(0x1d1)](){const _0x42e7ef=a105_0x165669,_0x5f0a61=new commit_components_dto_1[(_0x42e7ef(0x1d4))](),[_0x33d391,_0x391a0e]=await Promise['all']([this[_0x42e7ef(0x1c6)](),this[_0x42e7ef(0x22c)]()]);return _0x5f0a61[_0x42e7ef(0x211)]=this[_0x42e7ef(0x20a)]['message'],_0x5f0a61[_0x42e7ef(0x21b)]=this['commitData'][_0x42e7ef(0x21b)],_0x5f0a61[_0x42e7ef(0x200)]={'writed':_0x33d391,'deleted':_0x391a0e},_0x5f0a61[_0x42e7ef(0x1e6)]=this[_0x42e7ef(0x1d9)][_0x42e7ef(0x1ef)],_0x5f0a61[_0x42e7ef(0x1e4)]=this[_0x42e7ef(0x20f)],_0x5f0a61[_0x42e7ef(0x22a)]=this[_0x42e7ef(0x22a)],_0x5f0a61[_0x42e7ef(0x1f5)]=this[_0x42e7ef(0x1d9)][_0x42e7ef(0x214)],_0x5f0a61;}async[a105_0x165669(0x229)](_0x40578a=![]){const _0x515e6e=a105_0x165669;if(_0x40578a)await this[_0x515e6e(0x209)]['updateRemoteState'](this['repositoryData'],{});else{const _0x25e43e=await this[_0x515e6e(0x20f)]['branches'][_0x515e6e(0x1eb)](this[_0x515e6e(0x22a)][_0x515e6e(0x22b)]);this[_0x515e6e(0x212)][_0x515e6e(0x1d8)](this[_0x515e6e(0x201)]+_0x515e6e(0x206));const _0x2137c4={[this['repository'][_0x515e6e(0x202)]]:{'lastCommit':_0x25e43e[_0x515e6e(0x1db)]}};await this[_0x515e6e(0x209)][_0x515e6e(0x1f7)](this[_0x515e6e(0x1de)],_0x2137c4);}}async[a105_0x165669(0x1c8)](){const _0x9d8f83=a105_0x165669,_0xd573dd=await this[_0x9d8f83(0x1d1)]();await this['salesforceSync']['setStatus'](this[_0x9d8f83(0x1de)],_0x9d8f83(0x1d0)),await this[_0x9d8f83(0x217)][_0x9d8f83(0x1d3)](_0xd573dd,this[_0x9d8f83(0x201)]),await this[_0x9d8f83(0x229)](),await this[_0x9d8f83(0x209)][_0x9d8f83(0x1e0)](this[_0x9d8f83(0x1de)],_0x9d8f83(0x20d));}async['handleCommitJobError'](_0xcf2827){const _0x4f8c32=a105_0x165669;try{this[_0x4f8c32(0x212)][_0x4f8c32(0x1ec)](''+_0xcf2827),await this[_0x4f8c32(0x212)][_0x4f8c32(0x20e)](),await this[_0x4f8c32(0x229)](!![]),await this[_0x4f8c32(0x209)]['setStatus'](this[_0x4f8c32(0x1de)],_0x4f8c32(0x21c));}catch(_0x3f72bf){this[_0x4f8c32(0x231)]['error'](_0x3f72bf);}}async[a105_0x165669(0x1d3)](_0x54ba5c){const _0x1b947b=a105_0x165669;try{this['commitData']=_0x54ba5c,this[_0x1b947b(0x21a)]=typedi_1[_0x1b947b(0x232)]['get'](providers_tokens_1['Tokens'][_0x1b947b(0x21a)]),this[_0x1b947b(0x221)]=typedi_1[_0x1b947b(0x232)][_0x1b947b(0x222)](providers_tokens_1['Tokens']['gitRepoService']),this[_0x1b947b(0x1d9)]=typedi_1[_0x1b947b(0x232)]['get'](providers_tokens_1[_0x1b947b(0x22e)][_0x1b947b(0x1d9)]),await this[_0x1b947b(0x1df)](),this[_0x1b947b(0x20f)]=await this[_0x1b947b(0x221)]['getOne'](this['repositoryData'][_0x1b947b(0x1ee)]),this[_0x1b947b(0x22a)]=await this[_0x1b947b(0x20f)][_0x1b947b(0x219)][_0x1b947b(0x1eb)](this['repositoryData'][_0x1b947b(0x1e3)]),this['sfLogger']=typedi_1[_0x1b947b(0x232)]['get'](providers_tokens_1['Tokens'][_0x1b947b(0x231)]),this['prefix']=_0x1b947b(0x208)+this[_0x1b947b(0x1d9)][_0x1b947b(0x214)][_0x1b947b(0x1cd)]()+_0x1b947b(0x21f)+this[_0x1b947b(0x1de)]['repositoryName']+_0x1b947b(0x1ff)+this[_0x1b947b(0x1de)][_0x1b947b(0x1e3)]+_0x1b947b(0x1dc)+FlosumCommitJob_1[_0x1b947b(0x22b)]+']';if(!this[_0x1b947b(0x1de)])throw new bad_request_error_1['BadRequestError'](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this[_0x1b947b(0x212)][_0x1b947b(0x1d8)](this[_0x1b947b(0x201)]+_0x1b947b(0x1e8))[_0x1b947b(0x20e)](),await this['exec']()['catch'](_0x50a4d0=>this[_0x1b947b(0x1ed)](_0x50a4d0));}catch(_0x3382e2){this[_0x1b947b(0x20a)]=undefined,this[_0x1b947b(0x231)]['error'](_0x3382e2);throw _0x3382e2;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a105_0x165669(0x20b)],commit_components_job_1[a105_0x165669(0x1ca)],salesforce_sync_service_1['SalesforceSyncService']])],FlosumCommitJob),exports[a105_0x165669(0x1f8)]=FlosumCommitJob;