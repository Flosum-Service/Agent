function a105_0xb09a(){const _0x1b5370=['15374FxVIRf','salesforceService','shortid','BadRequestError','commitJob','Tokens','updateLastCommit','repositoryData','typedi','syncRepositoryId','../../salesforce/services/salesforce.service','__esModule','../../providers/providers.tokens','send','getOne','logger','60RSKQzD','exec','Container','name','getCommitDto','prefix','user','syncBranchId','log','../dto/commit-components.dto','Service','get','fetchRepositoryData','convertToSFDX','defineProperty','gitProvider','repositoryName','toString','catch','run','salesforceSync','\x20Start\x20Flosum\x20commit\x20job.','__decorate','1175536gpofGc','Completed','default','message','SalesforceSyncService','provider','./commit-components.job','gitUrl','split','decorate','commitData','search','patchObject','CommitComponentsDto','5477800bQBcdD','../../../../constants/errors','updateRemoteState','../../../../constants','299876wNJQeO','FlosumCommitJob','sfLogger','toUpperCase','(((.+)+)+)+$','error','length','commitAttachmentId','ERR_INVALID_SYNC_RECORD_ID','deleteAttachment','In\x20Progress','Logger','../../salesforce/services/salesforce-retriever.service','handleCommitJobError','gitApiService','gitRepoService','deleteAttachmentId','repoService','config','branches','function','apply','Error','retrieveAttachment','repository',']\x20[Branch:\x20','2410614DHlsgs','design:paramtypes','FLOSUM_ATTACHMENT','components','getComponentsToDelete','constructor','setStatus','map','[FLOSUM\x20->\x20GIT]\x20[','../../salesforce/services/salesforce-sync.service','2314870cYIPiW','getComponentsToWrite','3QUkpUw','branch','30Apcatz','getBranchRecord','branchName','__importDefault','944419tzkYsO','__metadata'];a105_0xb09a=function(){return _0x1b5370;};return a105_0xb09a();}const a105_0x1cd137=a105_0x2d66;function a105_0x2d66(_0x3f94fd,_0xffd938){const _0x38435a=a105_0xb09a();return a105_0x2d66=function(_0x1471dd,_0x41b419){_0x1471dd=_0x1471dd-0x161;let _0xb09aca=_0x38435a[_0x1471dd];return _0xb09aca;},a105_0x2d66(_0x3f94fd,_0xffd938);}(function(_0x2b4c82,_0x1e9d5b){const _0x96ae82=a105_0x2d66,_0x59ec6a=_0x2b4c82();while(!![]){try{const _0x1939b6=-parseInt(_0x96ae82(0x1b4))/0x1+parseInt(_0x96ae82(0x17b))/0x2*(parseInt(_0x96ae82(0x173))/0x3)+-parseInt(_0x96ae82(0x1a2))/0x4+-parseInt(_0x96ae82(0x171))/0x5+-parseInt(_0x96ae82(0x175))/0x6*(parseInt(_0x96ae82(0x179))/0x7)+parseInt(_0x96ae82(0x1b0))/0x8+-parseInt(_0x96ae82(0x167))/0x9*(-parseInt(_0x96ae82(0x18b))/0xa);if(_0x1939b6===_0x1e9d5b)break;else _0x59ec6a['push'](_0x59ec6a['shift']());}catch(_0x5799a5){_0x59ec6a['push'](_0x59ec6a['shift']());}}}(a105_0xb09a,0x8ab69));const a105_0x41b419=(function(){let _0x42cc41=!![];return function(_0x5be22e,_0x234b8e){const _0x664f16=_0x42cc41?function(){const _0xa7f61c=a105_0x2d66;if(_0x234b8e){const _0x392576=_0x234b8e[_0xa7f61c(0x162)](_0x5be22e,arguments);return _0x234b8e=null,_0x392576;}}:function(){};return _0x42cc41=![],_0x664f16;};}()),a105_0x1471dd=a105_0x41b419(this,function(){const _0x246f46=a105_0x2d66;return a105_0x1471dd[_0x246f46(0x19c)]()['search']('(((.+)+)+)+$')[_0x246f46(0x19c)]()[_0x246f46(0x16c)](a105_0x1471dd)[_0x246f46(0x1ad)](_0x246f46(0x1b8));});a105_0x1471dd();'use strict';var __decorate=this&&this[a105_0x1cd137(0x1a1)]||function(_0x771d68,_0x2f5cf1,_0x1a3305,_0x27f199){const _0x5f0455=a105_0x1cd137;var _0x4444d4=arguments[_0x5f0455(0x1ba)],_0x5b55ce=_0x4444d4<0x3?_0x2f5cf1:_0x27f199===null?_0x27f199=Object['getOwnPropertyDescriptor'](_0x2f5cf1,_0x1a3305):_0x27f199,_0x45fbdf;if(typeof Reflect==='object'&&typeof Reflect[_0x5f0455(0x1ab)]===_0x5f0455(0x161))_0x5b55ce=Reflect[_0x5f0455(0x1ab)](_0x771d68,_0x2f5cf1,_0x1a3305,_0x27f199);else{for(var _0x2a8c2a=_0x771d68[_0x5f0455(0x1ba)]-0x1;_0x2a8c2a>=0x0;_0x2a8c2a--)if(_0x45fbdf=_0x771d68[_0x2a8c2a])_0x5b55ce=(_0x4444d4<0x3?_0x45fbdf(_0x5b55ce):_0x4444d4>0x3?_0x45fbdf(_0x2f5cf1,_0x1a3305,_0x5b55ce):_0x45fbdf(_0x2f5cf1,_0x1a3305))||_0x5b55ce;}return _0x4444d4>0x3&&_0x5b55ce&&Object[_0x5f0455(0x199)](_0x2f5cf1,_0x1a3305,_0x5b55ce),_0x5b55ce;},__metadata=this&&this[a105_0x1cd137(0x17a)]||function(_0x369646,_0x34ebba){const _0x41ac99=a105_0x1cd137;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x41ac99(0x161))return Reflect['metadata'](_0x369646,_0x34ebba);},__importDefault=this&&this[a105_0x1cd137(0x178)]||function(_0x163879){const _0x40c074=a105_0x1cd137;return _0x163879&&_0x163879[_0x40c074(0x186)]?_0x163879:{'default':_0x163879};},FlosumCommitJob_1;Object[a105_0x1cd137(0x199)](exports,a105_0x1cd137(0x186),{'value':!![]}),exports[a105_0x1cd137(0x1b5)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require(a105_0x1cd137(0x185)),typedi_1=require(a105_0x1cd137(0x183)),errors_1=require(a105_0x1cd137(0x1b1)),bad_request_error_1=require('../../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a105_0x1cd137(0x1c0)),salesforce_sync_service_1=require(a105_0x1cd137(0x170)),commit_components_dto_1=require(a105_0x1cd137(0x194)),commit_components_job_1=require(a105_0x1cd137(0x1a8)),constants_1=require(a105_0x1cd137(0x1b3)),shortid_1=__importDefault(require(a105_0x1cd137(0x17d))),providers_tokens_1=require(a105_0x1cd137(0x187));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x5584a3,_0x123305,_0x4fecb1){const _0x169c8c=a105_0x1cd137;this['salesforceService']=_0x5584a3,this[_0x169c8c(0x17f)]=_0x123305,this[_0x169c8c(0x19f)]=_0x4fecb1,this['logger']=new core_1[(_0x169c8c(0x1bf))](FlosumCommitJob_1[_0x169c8c(0x18e)]);}async[a105_0x1cd137(0x197)](){const _0x4a4ba2=a105_0x1cd137;try{if(this[_0x4a4ba2(0x1ac)][_0x4a4ba2(0x184)])this['repositoryData']=await this[_0x4a4ba2(0x19f)]['getRepositoryRecord'](this['commitData']['syncRepositoryId']);else this['commitData']['syncBranchId']&&(this[_0x4a4ba2(0x182)]=await this[_0x4a4ba2(0x19f)][_0x4a4ba2(0x176)](this['commitData'][_0x4a4ba2(0x192)]));}catch(_0x1cd125){throw new bad_request_error_1['BadRequestError'](errors_1[_0x4a4ba2(0x1bc)]);}}async['getComponentsToWrite'](){const _0x5bb5dc=a105_0x1cd137;if(!this[_0x5bb5dc(0x1ac)][_0x5bb5dc(0x1bb)])return[];await this[_0x5bb5dc(0x17c)][_0x5bb5dc(0x1ae)](constants_1[_0x5bb5dc(0x169)],this[_0x5bb5dc(0x1ac)][_0x5bb5dc(0x1bb)],{'Name':(0x0,shortid_1[_0x5bb5dc(0x1a4)])()});const _0x3219ea=await this[_0x5bb5dc(0x17c)][_0x5bb5dc(0x164)](this['commitData'][_0x5bb5dc(0x1bb)])['then'](_0x4431ea=>_0x4431ea[_0x5bb5dc(0x1aa)]('\x20')[_0x5bb5dc(0x16e)](_0x30851c=>_0x30851c['trim']()));await this[_0x5bb5dc(0x17c)][_0x5bb5dc(0x1bd)](this[_0x5bb5dc(0x1ac)][_0x5bb5dc(0x1bb)]);const _0x43e1f5=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x5bb5dc(0x17c)]);return await _0x43e1f5[_0x5bb5dc(0x19e)](_0x3219ea);}async[a105_0x1cd137(0x16b)](){const _0x6dc0f3=a105_0x1cd137;if(!this['commitData']['deleteAttachmentId'])return[];await this[_0x6dc0f3(0x17c)]['patchObject'](constants_1[_0x6dc0f3(0x169)],this['commitData'][_0x6dc0f3(0x1c4)],{'Name':(0x0,shortid_1['default'])()});const _0xf53970=await this[_0x6dc0f3(0x17c)][_0x6dc0f3(0x164)](this[_0x6dc0f3(0x1ac)]['deleteAttachmentId']);return await this[_0x6dc0f3(0x17c)][_0x6dc0f3(0x1bd)](this[_0x6dc0f3(0x1ac)][_0x6dc0f3(0x1c4)]),_0xf53970;}async[a105_0x1cd137(0x18f)](){const _0x207693=a105_0x1cd137,_0x1efb70=new commit_components_dto_1[(_0x207693(0x1af))](),[_0x1164eb,_0x3cc39e]=await Promise['all']([this[_0x207693(0x172)](),this[_0x207693(0x16b)]()]);return _0x1efb70[_0x207693(0x1a5)]=this[_0x207693(0x1ac)][_0x207693(0x1a5)],_0x1efb70[_0x207693(0x191)]=this['commitData'][_0x207693(0x191)],_0x1efb70[_0x207693(0x16a)]={'writed':_0x1164eb,'deleted':_0x3cc39e},_0x1efb70[_0x207693(0x198)]=this[_0x207693(0x1c6)]['isConvertToSfdx'],_0x1efb70['repo']=this[_0x207693(0x165)],_0x1efb70['branch']=this[_0x207693(0x174)],_0x1efb70[_0x207693(0x1a7)]=this[_0x207693(0x1c6)][_0x207693(0x19a)],_0x1efb70;}async[a105_0x1cd137(0x181)](_0x242f89=![]){const _0x3d349f=a105_0x1cd137;if(_0x242f89)await this[_0x3d349f(0x19f)][_0x3d349f(0x1b2)](this[_0x3d349f(0x182)],{});else{const _0x40995e=await this[_0x3d349f(0x165)]['branches']['getOne'](this[_0x3d349f(0x174)][_0x3d349f(0x18e)]);this['sfLogger'][_0x3d349f(0x193)](this[_0x3d349f(0x190)]+'\x20Update\x20remote\x20state.');const _0x1f0e6c={[this[_0x3d349f(0x165)][_0x3d349f(0x1a9)]]:{'lastCommit':_0x40995e['sha']}};await this[_0x3d349f(0x19f)][_0x3d349f(0x1b2)](this[_0x3d349f(0x182)],_0x1f0e6c);}}async[a105_0x1cd137(0x18c)](){const _0x2265de=a105_0x1cd137,_0x424cc2=await this['getCommitDto']();await this['salesforceSync'][_0x2265de(0x16d)](this[_0x2265de(0x182)],_0x2265de(0x1be)),await this[_0x2265de(0x17f)][_0x2265de(0x19e)](_0x424cc2,this[_0x2265de(0x190)]),await this[_0x2265de(0x181)](),await this['salesforceSync']['setStatus'](this[_0x2265de(0x182)],_0x2265de(0x1a3));}async[a105_0x1cd137(0x1c1)](_0x5c3095){const _0x193298=a105_0x1cd137;try{this[_0x193298(0x1b6)][_0x193298(0x1b9)](''+_0x5c3095),await this['sfLogger']['send'](),await this['updateLastCommit'](!![]),await this[_0x193298(0x19f)][_0x193298(0x16d)](this[_0x193298(0x182)],_0x193298(0x163));}catch(_0xc45b8f){this[_0x193298(0x18a)][_0x193298(0x1b9)](_0xc45b8f);}}async['run'](_0x3ccf30){const _0x5a4232=a105_0x1cd137;try{this[_0x5a4232(0x1ac)]=_0x3ccf30,this[_0x5a4232(0x1c2)]=typedi_1[_0x5a4232(0x18d)][_0x5a4232(0x196)](providers_tokens_1[_0x5a4232(0x180)][_0x5a4232(0x1c2)]),this[_0x5a4232(0x1c5)]=typedi_1[_0x5a4232(0x18d)][_0x5a4232(0x196)](providers_tokens_1[_0x5a4232(0x180)][_0x5a4232(0x1c3)]),this[_0x5a4232(0x1c6)]=typedi_1[_0x5a4232(0x18d)][_0x5a4232(0x196)](providers_tokens_1['Tokens'][_0x5a4232(0x1c6)]),await this['fetchRepositoryData'](),this[_0x5a4232(0x165)]=await this['repoService'][_0x5a4232(0x189)](this['repositoryData'][_0x5a4232(0x19b)]),this[_0x5a4232(0x174)]=await this[_0x5a4232(0x165)][_0x5a4232(0x1c7)][_0x5a4232(0x189)](this[_0x5a4232(0x182)][_0x5a4232(0x177)]),this[_0x5a4232(0x1b6)]=typedi_1[_0x5a4232(0x18d)][_0x5a4232(0x196)](providers_tokens_1[_0x5a4232(0x180)]['logger']),this[_0x5a4232(0x190)]=_0x5a4232(0x16f)+this[_0x5a4232(0x1c6)][_0x5a4232(0x19a)][_0x5a4232(0x1b7)]()+']\x20[Repository:\x20'+this[_0x5a4232(0x182)]['repositoryName']+_0x5a4232(0x166)+this['repositoryData'][_0x5a4232(0x177)]+']\x20['+FlosumCommitJob_1[_0x5a4232(0x18e)]+']';if(!this[_0x5a4232(0x182)])throw new bad_request_error_1[(_0x5a4232(0x17e))](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this[_0x5a4232(0x1b6)][_0x5a4232(0x193)](this['prefix']+_0x5a4232(0x1a0))[_0x5a4232(0x188)](),await this[_0x5a4232(0x18c)]()[_0x5a4232(0x19d)](_0x1138cd=>this[_0x5a4232(0x1c1)](_0x1138cd));}catch(_0x5022f4){this[_0x5a4232(0x1ac)]=undefined,this[_0x5a4232(0x18a)][_0x5a4232(0x1b9)](_0x5022f4);throw _0x5022f4;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a105_0x1cd137(0x195)])({'transient':!![]}),__metadata(a105_0x1cd137(0x168),[salesforce_service_1['SalesforceService'],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a105_0x1cd137(0x1a6)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;