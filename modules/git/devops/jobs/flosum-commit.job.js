function a124_0x25d3(_0xbc9ec6,_0x1be315){const _0x1b86c8=a124_0x2d31();return a124_0x25d3=function(_0x2eed89,_0x2c7611){_0x2eed89=_0x2eed89-0x65;let _0x2d3150=_0x1b86c8[_0x2eed89];return _0x2d3150;},a124_0x25d3(_0xbc9ec6,_0x1be315);}const a124_0xfc8382=a124_0x25d3;(function(_0x14c430,_0x3e8f92){const _0x4ec6f5=a124_0x25d3,_0x17c851=_0x14c430();while(!![]){try{const _0x2f48ce=-parseInt(_0x4ec6f5(0x94))/0x1*(parseInt(_0x4ec6f5(0xbd))/0x2)+-parseInt(_0x4ec6f5(0x84))/0x3*(-parseInt(_0x4ec6f5(0x83))/0x4)+parseInt(_0x4ec6f5(0xbf))/0x5+-parseInt(_0x4ec6f5(0xd7))/0x6+-parseInt(_0x4ec6f5(0xca))/0x7*(-parseInt(_0x4ec6f5(0x88))/0x8)+parseInt(_0x4ec6f5(0x8d))/0x9*(-parseInt(_0x4ec6f5(0x67))/0xa)+-parseInt(_0x4ec6f5(0x6c))/0xb;if(_0x2f48ce===_0x3e8f92)break;else _0x17c851['push'](_0x17c851['shift']());}catch(_0x283ffe){_0x17c851['push'](_0x17c851['shift']());}}}(a124_0x2d31,0xd8450));const a124_0x2c7611=(function(){let _0x72ea98=!![];return function(_0x21eaf7,_0x1d4e99){const _0x3f736a=_0x72ea98?function(){if(_0x1d4e99){const _0x2fc833=_0x1d4e99['apply'](_0x21eaf7,arguments);return _0x1d4e99=null,_0x2fc833;}}:function(){};return _0x72ea98=![],_0x3f736a;};}()),a124_0x2eed89=a124_0x2c7611(this,function(){const _0x5827a2=a124_0x25d3;return a124_0x2eed89[_0x5827a2(0x6a)]()['search'](_0x5827a2(0x81))[_0x5827a2(0x6a)]()['constructor'](a124_0x2eed89)[_0x5827a2(0x7a)](_0x5827a2(0x81));});a124_0x2eed89();'use strict';var __decorate=this&&this[a124_0xfc8382(0xce)]||function(_0xd84968,_0x4f54a2,_0xe0320,_0x23a47c){const _0x3a1abd=a124_0xfc8382;var _0x313b37=arguments[_0x3a1abd(0xac)],_0xb027b2=_0x313b37<0x3?_0x4f54a2:_0x23a47c===null?_0x23a47c=Object[_0x3a1abd(0xc2)](_0x4f54a2,_0xe0320):_0x23a47c,_0x54e9e8;if(typeof Reflect===_0x3a1abd(0x7f)&&typeof Reflect[_0x3a1abd(0xc0)]===_0x3a1abd(0x92))_0xb027b2=Reflect[_0x3a1abd(0xc0)](_0xd84968,_0x4f54a2,_0xe0320,_0x23a47c);else{for(var _0x3144ce=_0xd84968['length']-0x1;_0x3144ce>=0x0;_0x3144ce--)if(_0x54e9e8=_0xd84968[_0x3144ce])_0xb027b2=(_0x313b37<0x3?_0x54e9e8(_0xb027b2):_0x313b37>0x3?_0x54e9e8(_0x4f54a2,_0xe0320,_0xb027b2):_0x54e9e8(_0x4f54a2,_0xe0320))||_0xb027b2;}return _0x313b37>0x3&&_0xb027b2&&Object[_0x3a1abd(0x7d)](_0x4f54a2,_0xe0320,_0xb027b2),_0xb027b2;},__metadata=this&&this['__metadata']||function(_0x45cce0,_0x2cda82){const _0x569f00=a124_0xfc8382;if(typeof Reflect==='object'&&typeof Reflect[_0x569f00(0x8b)]==='function')return Reflect[_0x569f00(0x8b)](_0x45cce0,_0x2cda82);},__importDefault=this&&this['__importDefault']||function(_0x225a52){const _0x176959=a124_0xfc8382;return _0x225a52&&_0x225a52[_0x176959(0xa4)]?_0x225a52:{'default':_0x225a52};},FlosumCommitJob_1;Object[a124_0xfc8382(0x7d)](exports,a124_0xfc8382(0xa4),{'value':!![]}),exports[a124_0xfc8382(0x89)]=void 0x0;const core_1=require(a124_0xfc8382(0x8a)),salesforce_service_1=require(a124_0xfc8382(0x91)),typedi_1=require('typedi'),errors_1=require(a124_0xfc8382(0x65)),bad_request_error_1=require('../../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a124_0xfc8382(0x66)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require(a124_0xfc8382(0x9a)),commit_components_job_1=require('./commit-components.job'),constants_1=require(a124_0xfc8382(0xbc)),shortid_1=__importDefault(require(a124_0xfc8382(0xcf))),providers_tokens_1=require('../../providers/providers.tokens'),commit_to_git_completed_notification_1=require('../../notifications/commit-to-git-completed.notification'),commit_to_git_error_notification_1=require(a124_0xfc8382(0x6e));function a124_0x2d31(){const _0x4b28b8=['isConvertToSfdx','../dto/commit-components.dto','[FLOSUM\x20->\x20GIT]\x20[','repository','SalesforceService','exec','catch','commitAttachmentId','commitJob','toUpperCase','branch','__esModule','setStatus','CommitToGitCompletedNotification','retrieveAttachment',']\x20[Branch:\x20','split','deleteAttachmentId','run','length','handleCommitJobError','getRepositoryRecord','map','Tokens','user','provider','repositoryData','name','gitApiService','gitProvider','then','logger','config','info','Service','../../../../constants','29858ketgCR','email','8189070CLoTos','decorate','completeNotification','getOwnPropertyDescriptor','Completed','patchObject','convertToSFDX','sfLogger','updateRemoteState','design:paramtypes','getComponentsToWrite','35VHncdJ','getOne','getBranchRecord','updateLastCommit','__decorate','shortid','errorNotification','commitData','salesforceSync','CommitComponentsDto','FLOSUM_ATTACHMENT',']\x20[','Container','1649046SYNYIE','fetchRepositoryData','\x20Update\x20remote\x20state.','gitRepoService','../../../../constants/errors','../../salesforce/services/salesforce-retriever.service','148870WNUdjq','Logger','ERR_UNKNOWN_SYNC_RECORD_ID','toString','ERR_INVALID_SYNC_RECORD_ID','16462017rkIwqk','salesforceService','../../notifications/commit-to-git-error.notification','getComponentsToDelete','repo','Error','deleteAttachment','BadRequestError','default','repoService','recordType','SalesforceSyncService',']\x20[Repository:\x20','isEmailNotificationsEnabled','search','parse','send','defineProperty','syncRepositoryId','object','all','(((.+)+)+)+$','getCommitDto','28dkMbgX','194253bGwsTj','get','CommitToGitErrorNotification','branches','1526696RtWjFi','FlosumCommitJob','../../../../core','metadata','prefix','27QhpimX','SalesforceRetrieverService','Email\x20notifications\x20are\x20disabled.','sha','../../salesforce/services/salesforce.service','function','message','23swMeoe','In\x20Progress','trim','syncBranchId','log'];a124_0x2d31=function(){return _0x4b28b8;};return a124_0x2d31();}let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x51f0a2,_0x93c724,_0x177a38){const _0x3aa660=a124_0xfc8382;this[_0x3aa660(0x6d)]=_0x51f0a2,this[_0x3aa660(0xa1)]=_0x93c724,this[_0x3aa660(0xd2)]=_0x177a38,this[_0x3aa660(0xb8)]=new core_1[(_0x3aa660(0x68))](FlosumCommitJob_1[_0x3aa660(0xb4)]);}async[a124_0xfc8382(0xc1)](_0x1132b3,_0x3b1b20,_0x16a573,_0x4167ad){const _0x42818e=a124_0xfc8382;if(!this[_0x42818e(0xd1)][_0x42818e(0x79)]){this[_0x42818e(0xb8)][_0x42818e(0xba)](_0x42818e(0x8f));return;}await new commit_to_git_completed_notification_1[(_0x42818e(0xa6))]({'emails':_0x1132b3,'gitProvider':_0x3b1b20,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1[_0x42818e(0xa6)][_0x42818e(0xb4)],'repositoryName':_0x16a573,'branchName':_0x4167ad})['execute']();}async['errorNotification'](_0x4e66b4,_0x3d14dd,_0x3443a8,_0xce2dee){const _0x11b0c6=a124_0xfc8382;if(!this[_0x11b0c6(0xd1)][_0x11b0c6(0x79)]){this[_0x11b0c6(0xb8)][_0x11b0c6(0xba)](_0x11b0c6(0x8f));return;}await new commit_to_git_error_notification_1[(_0x11b0c6(0x86))]({'emails':_0x4e66b4,'gitProvider':_0x3d14dd,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0x11b0c6(0x86)]['name'],'repositoryName':_0x3443a8,'branchName':_0xce2dee})['execute']();}async[a124_0xfc8382(0xd8)](){const _0x245f82=a124_0xfc8382;try{if(this[_0x245f82(0xd1)][_0x245f82(0x7e)])this[_0x245f82(0xb3)]=await this[_0x245f82(0xd2)][_0x245f82(0xae)](this[_0x245f82(0xd1)][_0x245f82(0x7e)]);else this['commitData'][_0x245f82(0x97)]&&(this[_0x245f82(0xb3)]=await this[_0x245f82(0xd2)][_0x245f82(0xcc)](this[_0x245f82(0xd1)][_0x245f82(0x97)]));}catch(_0x2264a1){throw new bad_request_error_1[(_0x245f82(0x73))](errors_1[_0x245f82(0x6b)]);}}async[a124_0xfc8382(0xc9)](){const _0x2403e1=a124_0xfc8382;if(!this['commitData'][_0x2403e1(0xa0)])return[];await this[_0x2403e1(0x6d)][_0x2403e1(0xc4)](constants_1[_0x2403e1(0xd4)],this[_0x2403e1(0xd1)][_0x2403e1(0xa0)],{'Name':(0x0,shortid_1[_0x2403e1(0x74)])()});const _0x135c67=await this[_0x2403e1(0x6d)][_0x2403e1(0xa7)](this[_0x2403e1(0xd1)]['commitAttachmentId'])[_0x2403e1(0xb7)](_0x28b37c=>_0x28b37c[_0x2403e1(0xa9)]('\x20')[_0x2403e1(0xaf)](_0x317aa8=>_0x317aa8[_0x2403e1(0x96)]()));await this[_0x2403e1(0x6d)][_0x2403e1(0x72)](this[_0x2403e1(0xd1)][_0x2403e1(0xa0)]);const _0x173e4d=new salesforce_retriever_service_1[(_0x2403e1(0x8e))](this['salesforceService']);return await _0x173e4d[_0x2403e1(0xab)](_0x135c67);}async[a124_0xfc8382(0x6f)](){const _0x23aa43=a124_0xfc8382;if(!this[_0x23aa43(0xd1)][_0x23aa43(0xaa)])return[];await this[_0x23aa43(0x6d)][_0x23aa43(0xc4)](constants_1[_0x23aa43(0xd4)],this[_0x23aa43(0xd1)]['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0x23aa43(0x74)])()});const _0x4031d7=await this[_0x23aa43(0x6d)][_0x23aa43(0xa7)](this[_0x23aa43(0xd1)]['deleteAttachmentId']),_0x30c9d4=JSON[_0x23aa43(0x7b)](_0x4031d7);return await this['salesforceService']['deleteAttachment'](this[_0x23aa43(0xd1)][_0x23aa43(0xaa)]),_0x30c9d4;}async[a124_0xfc8382(0x82)](){const _0x27198e=a124_0xfc8382,_0x3385a0=new commit_components_dto_1[(_0x27198e(0xd3))](),[_0x25a341,_0xaabcfe]=await Promise[_0x27198e(0x80)]([this[_0x27198e(0xc9)](),this[_0x27198e(0x6f)]()]);return _0x3385a0['message']=this[_0x27198e(0xd1)][_0x27198e(0x93)],_0x3385a0[_0x27198e(0xb1)]=this[_0x27198e(0xd1)][_0x27198e(0xb1)],_0x3385a0['components']={'writed':_0x25a341,'deleted':_0xaabcfe},_0x3385a0[_0x27198e(0xc5)]=this[_0x27198e(0xb9)][_0x27198e(0x99)],_0x3385a0[_0x27198e(0x70)]=this['repository'],_0x3385a0[_0x27198e(0xa3)]=this[_0x27198e(0xa3)],_0x3385a0[_0x27198e(0xb2)]=this[_0x27198e(0xb9)][_0x27198e(0xb6)],_0x3385a0[_0x27198e(0x76)]=this[_0x27198e(0xb3)]['recordTypeName'],_0x3385a0;}async['updateLastCommit'](_0x538f0a=![]){const _0x4847aa=a124_0xfc8382;if(_0x538f0a)await this[_0x4847aa(0xd2)][_0x4847aa(0xc7)](this[_0x4847aa(0xb3)],{});else{const _0x38824c=await this[_0x4847aa(0x9c)][_0x4847aa(0x87)][_0x4847aa(0xcb)](this['branch'][_0x4847aa(0xb4)]);this[_0x4847aa(0xc6)][_0x4847aa(0x98)](this[_0x4847aa(0x8c)]+_0x4847aa(0xd9));const _0x4e4993={[this[_0x4847aa(0x9c)]['gitUrl']]:{'lastCommit':_0x38824c[_0x4847aa(0x90)]}};await this[_0x4847aa(0xd2)][_0x4847aa(0xc7)](this[_0x4847aa(0xb3)],_0x4e4993);}}async[a124_0xfc8382(0x9e)](){const _0x1a6294=a124_0xfc8382,_0x4f17a2=await this[_0x1a6294(0x82)]();await this['salesforceSync'][_0x1a6294(0xa5)](this[_0x1a6294(0xb3)],_0x1a6294(0x95)),await this[_0x1a6294(0xa1)][_0x1a6294(0xab)](_0x4f17a2,this[_0x1a6294(0x8c)]),await this[_0x1a6294(0xcd)](),await this[_0x1a6294(0xd2)][_0x1a6294(0xa5)](this[_0x1a6294(0xb3)],_0x1a6294(0xc3));}async[a124_0xfc8382(0xad)](_0x3eec0b){const _0x26d309=a124_0xfc8382;try{this[_0x26d309(0xc6)]['error'](''+_0x3eec0b),await this[_0x26d309(0xc6)][_0x26d309(0x7c)](),await this['updateLastCommit'](!![]),await this[_0x26d309(0xd2)][_0x26d309(0xa5)](this[_0x26d309(0xb3)],_0x26d309(0x71)),await this[_0x26d309(0xc1)]([this['commitData'][_0x26d309(0xb1)]['email']],this[_0x26d309(0xb9)][_0x26d309(0xb6)],this[_0x26d309(0x9c)][_0x26d309(0xb4)],this[_0x26d309(0xa3)]['name']);}catch(_0x1158fd){this[_0x26d309(0xb8)]['error'](_0x1158fd),await this[_0x26d309(0xd0)]([this[_0x26d309(0xd1)]['user'][_0x26d309(0xbe)]],this[_0x26d309(0xb9)][_0x26d309(0xb6)],this['repository'][_0x26d309(0xb4)],this[_0x26d309(0xa3)][_0x26d309(0xb4)]);}}async[a124_0xfc8382(0xab)](_0x50614e){const _0x1dc73f=a124_0xfc8382;try{this[_0x1dc73f(0xd1)]=_0x50614e,this[_0x1dc73f(0xb5)]=typedi_1[_0x1dc73f(0xd6)]['get'](providers_tokens_1[_0x1dc73f(0xb0)]['gitApiService']),this[_0x1dc73f(0x75)]=typedi_1[_0x1dc73f(0xd6)][_0x1dc73f(0x85)](providers_tokens_1['Tokens'][_0x1dc73f(0xda)]),this[_0x1dc73f(0xb9)]=typedi_1[_0x1dc73f(0xd6)][_0x1dc73f(0x85)](providers_tokens_1[_0x1dc73f(0xb0)]['config']),await this[_0x1dc73f(0xd8)](),this[_0x1dc73f(0x9c)]=await this[_0x1dc73f(0x75)][_0x1dc73f(0xcb)](this[_0x1dc73f(0xb3)]['repositoryName']),this[_0x1dc73f(0xa3)]=await this[_0x1dc73f(0x9c)][_0x1dc73f(0x87)]['getOne'](this[_0x1dc73f(0xb3)]['branchName']),this[_0x1dc73f(0xc6)]=typedi_1['Container'][_0x1dc73f(0x85)](providers_tokens_1[_0x1dc73f(0xb0)][_0x1dc73f(0xb8)]),this[_0x1dc73f(0x8c)]=_0x1dc73f(0x9b)+this[_0x1dc73f(0xb9)][_0x1dc73f(0xb6)][_0x1dc73f(0xa2)]()+_0x1dc73f(0x78)+this[_0x1dc73f(0xb3)]['repositoryName']+_0x1dc73f(0xa8)+this[_0x1dc73f(0xb3)]['branchName']+_0x1dc73f(0xd5)+FlosumCommitJob_1['name']+']';if(!this[_0x1dc73f(0xb3)])throw new bad_request_error_1[(_0x1dc73f(0x73))](errors_1[_0x1dc73f(0x69)]);await this['sfLogger'][_0x1dc73f(0x98)](this[_0x1dc73f(0x8c)]+'\x20Start\x20Flosum\x20commit\x20job.')[_0x1dc73f(0x7c)](),await this['exec']()[_0x1dc73f(0x9f)](_0x4f68a6=>this['handleCommitJobError'](_0x4f68a6)),await this[_0x1dc73f(0xc1)]([this[_0x1dc73f(0xd1)][_0x1dc73f(0xb1)][_0x1dc73f(0xbe)]],this['config'][_0x1dc73f(0xb6)],this[_0x1dc73f(0x9c)]['name'],this[_0x1dc73f(0xa3)][_0x1dc73f(0xb4)]);}catch(_0x3c1719){this[_0x1dc73f(0xd1)]=undefined,this[_0x1dc73f(0xb8)]['error'](_0x3c1719),await this['errorNotification']([this[_0x1dc73f(0xd1)][_0x1dc73f(0xb1)][_0x1dc73f(0xbe)]],this[_0x1dc73f(0xb9)][_0x1dc73f(0xb6)],this['repository'][_0x1dc73f(0xb4)],this[_0x1dc73f(0xa3)][_0x1dc73f(0xb4)]);throw _0x3c1719;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a124_0xfc8382(0xbb)])({'transient':!![]}),__metadata(a124_0xfc8382(0xc8),[salesforce_service_1[a124_0xfc8382(0x9d)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a124_0xfc8382(0x77)]])],FlosumCommitJob),exports[a124_0xfc8382(0x89)]=FlosumCommitJob;