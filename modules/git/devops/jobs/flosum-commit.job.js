const a105_0x231f99=a105_0x364c;(function(_0x332b9f,_0x503888){const _0x12d7fd=a105_0x364c,_0x1c0e52=_0x332b9f();while(!![]){try{const _0x7e636a=-parseInt(_0x12d7fd(0xc7))/0x1*(parseInt(_0x12d7fd(0xdf))/0x2)+parseInt(_0x12d7fd(0xa6))/0x3+-parseInt(_0x12d7fd(0xcd))/0x4*(-parseInt(_0x12d7fd(0xcf))/0x5)+parseInt(_0x12d7fd(0x86))/0x6*(parseInt(_0x12d7fd(0x88))/0x7)+parseInt(_0x12d7fd(0xe7))/0x8+-parseInt(_0x12d7fd(0xbe))/0x9*(-parseInt(_0x12d7fd(0xb7))/0xa)+-parseInt(_0x12d7fd(0x8d))/0xb*(parseInt(_0x12d7fd(0x9b))/0xc);if(_0x7e636a===_0x503888)break;else _0x1c0e52['push'](_0x1c0e52['shift']());}catch(_0x115bfa){_0x1c0e52['push'](_0x1c0e52['shift']());}}}(a105_0x5d99,0x25bb3));const a105_0x224479=(function(){let _0x481e36=!![];return function(_0x5bb479,_0x1723c8){const _0x4acfe0=_0x481e36?function(){const _0x278653=a105_0x364c;if(_0x1723c8){const _0x35a3c2=_0x1723c8[_0x278653(0xd7)](_0x5bb479,arguments);return _0x1723c8=null,_0x35a3c2;}}:function(){};return _0x481e36=![],_0x4acfe0;};}()),a105_0x3f25a3=a105_0x224479(this,function(){const _0x390571=a105_0x364c;return a105_0x3f25a3[_0x390571(0x76)]()[_0x390571(0x7a)](_0x390571(0xb3))[_0x390571(0x76)]()['constructor'](a105_0x3f25a3)[_0x390571(0x7a)](_0x390571(0xb3));});a105_0x3f25a3();function a105_0x5d99(){const _0x35f115=['get','getOwnPropertyDescriptor','__decorate','Error','deleteAttachment','branches','function','320672aADdHP','Container','toString','isConvertToSfdx','commitJob','gitApiService','search','[FLOSUM\x20->\x20GIT]\x20[','../../../../core/errors/bad-request.error','config','FlosumCommitJob','decorate',']\x20[Branch:\x20','message','__esModule','syncRepositoryId','BadRequestError','salesforceService','829722MpysCS','split','7BQckoo','salesforceSync','sfLogger','send','SalesforceRetrieverService','469601qJLCPU','updateLastCommit','map','all','setStatus','default','logger','ERR_UNKNOWN_SYNC_RECORD_ID','getComponentsToWrite','../../../../constants/errors','components','defineProperty','repositoryName','CommitComponentsDto','108CQBYeO','FLOSUM_ATTACHMENT','name','log','commitAttachmentId','repoService','length','repo','trim','run','ERR_INVALID_SYNC_RECORD_ID','468900EJFmic','shortid','getOne','convertToSFDX','Service','repository','../../salesforce/services/salesforce-sync.service','Tokens','object','updateRemoteState','gitProvider','branch','fetchRepositoryData','(((.+)+)+)+$',']\x20[','handleCommitJobError','../dto/commit-components.dto','40yxYHkI','\x20Update\x20remote\x20state.','toUpperCase','metadata','Logger','repositoryData','sha','421353oEDKBu','__metadata','patchObject','getBranchRecord','commitData','CommitComponentsJob','__importDefault','getCommitDto','design:paramtypes','2863pIPGUy','prefix','branchName',']\x20[Repository:\x20','user','../../salesforce/services/salesforce-retriever.service','4ekuAHA','deleteAttachmentId','98450XxJpOb','gitUrl','exec','typedi','SalesforceService','error','retrieveAttachment','../../salesforce/services/salesforce.service','apply','getComponentsToDelete','\x20Start\x20Flosum\x20commit\x20job.','gitRepoService','In\x20Progress','../../../../constants','SalesforceSyncService','getRepositoryRecord','2KNIgvV'];a105_0x5d99=function(){return _0x35f115;};return a105_0x5d99();}'use strict';var __decorate=this&&this[a105_0x231f99(0xe2)]||function(_0x4578ee,_0x458f79,_0x4fab01,_0x3d67ef){const _0x420ee4=a105_0x231f99;var _0x37efbe=arguments[_0x420ee4(0xa1)],_0x52ec2b=_0x37efbe<0x3?_0x458f79:_0x3d67ef===null?_0x3d67ef=Object[_0x420ee4(0xe1)](_0x458f79,_0x4fab01):_0x3d67ef,_0x248853;if(typeof Reflect===_0x420ee4(0xae)&&typeof Reflect[_0x420ee4(0x7f)]==='function')_0x52ec2b=Reflect[_0x420ee4(0x7f)](_0x4578ee,_0x458f79,_0x4fab01,_0x3d67ef);else{for(var _0x513aa9=_0x4578ee[_0x420ee4(0xa1)]-0x1;_0x513aa9>=0x0;_0x513aa9--)if(_0x248853=_0x4578ee[_0x513aa9])_0x52ec2b=(_0x37efbe<0x3?_0x248853(_0x52ec2b):_0x37efbe>0x3?_0x248853(_0x458f79,_0x4fab01,_0x52ec2b):_0x248853(_0x458f79,_0x4fab01))||_0x52ec2b;}return _0x37efbe>0x3&&_0x52ec2b&&Object[_0x420ee4(0x98)](_0x458f79,_0x4fab01,_0x52ec2b),_0x52ec2b;},__metadata=this&&this[a105_0x231f99(0xbf)]||function(_0x2c9296,_0x14bd22){const _0x14f522=a105_0x231f99;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x14f522(0xe6))return Reflect[_0x14f522(0xba)](_0x2c9296,_0x14bd22);},__importDefault=this&&this[a105_0x231f99(0xc4)]||function(_0x1d5178){const _0x570d35=a105_0x231f99;return _0x1d5178&&_0x1d5178[_0x570d35(0x82)]?_0x1d5178:{'default':_0x1d5178};},FlosumCommitJob_1;Object[a105_0x231f99(0x98)](exports,'__esModule',{'value':!![]}),exports[a105_0x231f99(0x7e)]=void 0x0;function a105_0x364c(_0x1333ee,_0x34bba0){const _0xaac0f1=a105_0x5d99();return a105_0x364c=function(_0x3f25a3,_0x224479){_0x3f25a3=_0x3f25a3-0x75;let _0x5d99f0=_0xaac0f1[_0x3f25a3];return _0x5d99f0;},a105_0x364c(_0x1333ee,_0x34bba0);}const core_1=require('../../../../core'),salesforce_service_1=require(a105_0x231f99(0xd6)),typedi_1=require(a105_0x231f99(0xd2)),errors_1=require(a105_0x231f99(0x96)),bad_request_error_1=require(a105_0x231f99(0x7c)),salesforce_retriever_service_1=require(a105_0x231f99(0xcc)),salesforce_sync_service_1=require(a105_0x231f99(0xac)),commit_components_dto_1=require(a105_0x231f99(0xb6)),commit_components_job_1=require('./commit-components.job'),constants_1=require(a105_0x231f99(0xdc)),shortid_1=__importDefault(require(a105_0x231f99(0xa7))),providers_tokens_1=require('../../providers/providers.tokens');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x1d2bbc,_0x4b5cea,_0x55537a){const _0x22c99e=a105_0x231f99;this[_0x22c99e(0x85)]=_0x1d2bbc,this[_0x22c99e(0x78)]=_0x4b5cea,this[_0x22c99e(0x89)]=_0x55537a,this[_0x22c99e(0x93)]=new core_1[(_0x22c99e(0xbb))](FlosumCommitJob_1[_0x22c99e(0x9d)]);}async[a105_0x231f99(0xb2)](){const _0x3d5e07=a105_0x231f99;try{if(this[_0x3d5e07(0xc2)][_0x3d5e07(0x83)])this[_0x3d5e07(0xbc)]=await this[_0x3d5e07(0x89)][_0x3d5e07(0xde)](this[_0x3d5e07(0xc2)][_0x3d5e07(0x83)]);else this[_0x3d5e07(0xc2)]['syncBranchId']&&(this['repositoryData']=await this[_0x3d5e07(0x89)][_0x3d5e07(0xc1)](this[_0x3d5e07(0xc2)]['syncBranchId']));}catch(_0xbdc7c2){throw new bad_request_error_1['BadRequestError'](errors_1[_0x3d5e07(0xa5)]);}}async[a105_0x231f99(0x95)](){const _0x2bb742=a105_0x231f99;if(!this[_0x2bb742(0xc2)][_0x2bb742(0x9f)])return[];await this[_0x2bb742(0x85)][_0x2bb742(0xc0)](constants_1[_0x2bb742(0x9c)],this[_0x2bb742(0xc2)][_0x2bb742(0x9f)],{'Name':(0x0,shortid_1['default'])()});const _0x34ffe2=await this[_0x2bb742(0x85)][_0x2bb742(0xd5)](this[_0x2bb742(0xc2)]['commitAttachmentId'])['then'](_0x128909=>_0x128909[_0x2bb742(0x87)]('\x20')[_0x2bb742(0x8f)](_0x406b02=>_0x406b02[_0x2bb742(0xa3)]()));await this['salesforceService'][_0x2bb742(0xe4)](this['commitData'][_0x2bb742(0x9f)]);const _0x45807a=new salesforce_retriever_service_1[(_0x2bb742(0x8c))](this[_0x2bb742(0x85)]);return await _0x45807a['run'](_0x34ffe2);}async[a105_0x231f99(0xd8)](){const _0x28f561=a105_0x231f99;if(!this['commitData'][_0x28f561(0xce)])return[];await this[_0x28f561(0x85)][_0x28f561(0xc0)](constants_1[_0x28f561(0x9c)],this[_0x28f561(0xc2)]['deleteAttachmentId'],{'Name':(0x0,shortid_1[_0x28f561(0x92)])()});const _0x375055=await this[_0x28f561(0x85)][_0x28f561(0xd5)](this[_0x28f561(0xc2)][_0x28f561(0xce)]),_0x49766f=JSON['parse'](_0x375055);return await this[_0x28f561(0x85)][_0x28f561(0xe4)](this[_0x28f561(0xc2)][_0x28f561(0xce)]),_0x49766f;}async['getCommitDto'](){const _0x102fa2=a105_0x231f99,_0x5c7a52=new commit_components_dto_1[(_0x102fa2(0x9a))](),[_0x640a71,_0xce01da]=await Promise[_0x102fa2(0x90)]([this[_0x102fa2(0x95)](),this[_0x102fa2(0xd8)]()]);return _0x5c7a52[_0x102fa2(0x81)]=this[_0x102fa2(0xc2)]['message'],_0x5c7a52[_0x102fa2(0xcb)]=this[_0x102fa2(0xc2)][_0x102fa2(0xcb)],_0x5c7a52[_0x102fa2(0x97)]={'writed':_0x640a71,'deleted':_0xce01da},_0x5c7a52[_0x102fa2(0xa9)]=this[_0x102fa2(0x7d)][_0x102fa2(0x77)],_0x5c7a52[_0x102fa2(0xa2)]=this[_0x102fa2(0xab)],_0x5c7a52[_0x102fa2(0xb1)]=this[_0x102fa2(0xb1)],_0x5c7a52['provider']=this[_0x102fa2(0x7d)][_0x102fa2(0xb0)],_0x5c7a52;}async[a105_0x231f99(0x8e)](_0x47dfdf=![]){const _0x22b1ec=a105_0x231f99;if(_0x47dfdf)await this[_0x22b1ec(0x89)][_0x22b1ec(0xaf)](this[_0x22b1ec(0xbc)],{});else{const _0xc86b38=await this['repository']['branches']['getOne'](this[_0x22b1ec(0xb1)][_0x22b1ec(0x9d)]);this[_0x22b1ec(0x8a)][_0x22b1ec(0x9e)](this['prefix']+_0x22b1ec(0xb8));const _0x41a3fb={[this[_0x22b1ec(0xab)][_0x22b1ec(0xd0)]]:{'lastCommit':_0xc86b38[_0x22b1ec(0xbd)]}};await this[_0x22b1ec(0x89)]['updateRemoteState'](this['repositoryData'],_0x41a3fb);}}async[a105_0x231f99(0xd1)](){const _0x4b6d68=a105_0x231f99,_0x417f7=await this[_0x4b6d68(0xc5)]();await this[_0x4b6d68(0x89)]['setStatus'](this[_0x4b6d68(0xbc)],_0x4b6d68(0xdb)),await this[_0x4b6d68(0x78)][_0x4b6d68(0xa4)](_0x417f7,this['prefix']),await this[_0x4b6d68(0x8e)](),await this[_0x4b6d68(0x89)]['setStatus'](this['repositoryData'],'Completed');}async[a105_0x231f99(0xb5)](_0x35d217){const _0x5e826b=a105_0x231f99;try{this[_0x5e826b(0x8a)]['error'](''+_0x35d217),await this[_0x5e826b(0x8a)]['send'](),await this[_0x5e826b(0x8e)](!![]),await this[_0x5e826b(0x89)][_0x5e826b(0x91)](this['repositoryData'],_0x5e826b(0xe3));}catch(_0x39eb89){this[_0x5e826b(0x93)][_0x5e826b(0xd4)](_0x39eb89);}}async[a105_0x231f99(0xa4)](_0x12dfc7){const _0x4fe411=a105_0x231f99;try{this[_0x4fe411(0xc2)]=_0x12dfc7,this['gitApiService']=typedi_1['Container'][_0x4fe411(0xe0)](providers_tokens_1[_0x4fe411(0xad)][_0x4fe411(0x79)]),this['repoService']=typedi_1[_0x4fe411(0x75)]['get'](providers_tokens_1[_0x4fe411(0xad)][_0x4fe411(0xda)]),this[_0x4fe411(0x7d)]=typedi_1['Container']['get'](providers_tokens_1[_0x4fe411(0xad)][_0x4fe411(0x7d)]),await this[_0x4fe411(0xb2)](),this[_0x4fe411(0xab)]=await this[_0x4fe411(0xa0)][_0x4fe411(0xa8)](this['repositoryData'][_0x4fe411(0x99)]),this['branch']=await this['repository'][_0x4fe411(0xe5)][_0x4fe411(0xa8)](this[_0x4fe411(0xbc)][_0x4fe411(0xc9)]),this['sfLogger']=typedi_1[_0x4fe411(0x75)][_0x4fe411(0xe0)](providers_tokens_1['Tokens']['logger']),this[_0x4fe411(0xc8)]=_0x4fe411(0x7b)+this['config'][_0x4fe411(0xb0)][_0x4fe411(0xb9)]()+_0x4fe411(0xca)+this[_0x4fe411(0xbc)][_0x4fe411(0x99)]+_0x4fe411(0x80)+this[_0x4fe411(0xbc)][_0x4fe411(0xc9)]+_0x4fe411(0xb4)+FlosumCommitJob_1[_0x4fe411(0x9d)]+']';if(!this[_0x4fe411(0xbc)])throw new bad_request_error_1[(_0x4fe411(0x84))](errors_1[_0x4fe411(0x94)]);await this[_0x4fe411(0x8a)][_0x4fe411(0x9e)](this[_0x4fe411(0xc8)]+_0x4fe411(0xd9))[_0x4fe411(0x8b)](),await this[_0x4fe411(0xd1)]()['catch'](_0x442ddc=>this['handleCommitJobError'](_0x442ddc));}catch(_0x49489f){this[_0x4fe411(0xc2)]=undefined,this[_0x4fe411(0x93)]['error'](_0x49489f);throw _0x49489f;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a105_0x231f99(0xaa)])({'transient':!![]}),__metadata(a105_0x231f99(0xc6),[salesforce_service_1[a105_0x231f99(0xd3)],commit_components_job_1[a105_0x231f99(0xc3)],salesforce_sync_service_1[a105_0x231f99(0xdd)]])],FlosumCommitJob),exports[a105_0x231f99(0x7e)]=FlosumCommitJob;