const a126_0x1bfc76=a126_0x5383;(function(_0x1906d5,_0x1d6ad5){const _0x3f4740=a126_0x5383,_0x2e12dd=_0x1906d5();while(!![]){try{const _0xff2b6b=-parseInt(_0x3f4740(0x11f))/0x1+-parseInt(_0x3f4740(0xbd))/0x2+-parseInt(_0x3f4740(0xff))/0x3*(parseInt(_0x3f4740(0x125))/0x4)+parseInt(_0x3f4740(0xc1))/0x5*(parseInt(_0x3f4740(0x112))/0x6)+-parseInt(_0x3f4740(0xc7))/0x7+-parseInt(_0x3f4740(0x102))/0x8+parseInt(_0x3f4740(0x120))/0x9*(parseInt(_0x3f4740(0xf1))/0xa);if(_0xff2b6b===_0x1d6ad5)break;else _0x2e12dd['push'](_0x2e12dd['shift']());}catch(_0x167b30){_0x2e12dd['push'](_0x2e12dd['shift']());}}}(a126_0x5cee,0xf39f2));const a126_0x52ea0f=(function(){let _0x4e4f72=!![];return function(_0xcce2a0,_0x161855){const _0x48a83a=_0x4e4f72?function(){const _0x5ecd9f=a126_0x5383;if(_0x161855){const _0x257232=_0x161855[_0x5ecd9f(0xda)](_0xcce2a0,arguments);return _0x161855=null,_0x257232;}}:function(){};return _0x4e4f72=![],_0x48a83a;};}()),a126_0xcdb1a7=a126_0x52ea0f(this,function(){const _0x16cfb7=a126_0x5383;return a126_0xcdb1a7[_0x16cfb7(0xd6)]()[_0x16cfb7(0xe3)](_0x16cfb7(0xf8))[_0x16cfb7(0xd6)]()[_0x16cfb7(0xee)](a126_0xcdb1a7)['search'](_0x16cfb7(0xf8));});a126_0xcdb1a7();'use strict';var __decorate=this&&this[a126_0x1bfc76(0x103)]||function(_0x4f2c5c,_0x34049a,_0x180615,_0x5a4cdd){const _0x131a37=a126_0x1bfc76;var _0x12e295=arguments[_0x131a37(0xcf)],_0x316db9=_0x12e295<0x3?_0x34049a:_0x5a4cdd===null?_0x5a4cdd=Object[_0x131a37(0xe4)](_0x34049a,_0x180615):_0x5a4cdd,_0xda9ac6;if(typeof Reflect===_0x131a37(0xc9)&&typeof Reflect[_0x131a37(0xfe)]===_0x131a37(0xce))_0x316db9=Reflect[_0x131a37(0xfe)](_0x4f2c5c,_0x34049a,_0x180615,_0x5a4cdd);else{for(var _0x49b2d5=_0x4f2c5c[_0x131a37(0xcf)]-0x1;_0x49b2d5>=0x0;_0x49b2d5--)if(_0xda9ac6=_0x4f2c5c[_0x49b2d5])_0x316db9=(_0x12e295<0x3?_0xda9ac6(_0x316db9):_0x12e295>0x3?_0xda9ac6(_0x34049a,_0x180615,_0x316db9):_0xda9ac6(_0x34049a,_0x180615))||_0x316db9;}return _0x12e295>0x3&&_0x316db9&&Object[_0x131a37(0x104)](_0x34049a,_0x180615,_0x316db9),_0x316db9;},__metadata=this&&this[a126_0x1bfc76(0x127)]||function(_0x5391ba,_0xe4f402){const _0x21b858=a126_0x1bfc76;if(typeof Reflect===_0x21b858(0xc9)&&typeof Reflect[_0x21b858(0xd5)]===_0x21b858(0xce))return Reflect[_0x21b858(0xd5)](_0x5391ba,_0xe4f402);},__importDefault=this&&this[a126_0x1bfc76(0x131)]||function(_0x373ee3){const _0x128c7e=a126_0x1bfc76;return _0x373ee3&&_0x373ee3[_0x128c7e(0x110)]?_0x373ee3:{'default':_0x373ee3};},FlosumCommitJob_1;Object['defineProperty'](exports,a126_0x1bfc76(0x110),{'value':!![]}),exports[a126_0x1bfc76(0xd1)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require(a126_0x1bfc76(0x118)),typedi_1=require(a126_0x1bfc76(0xe9)),errors_1=require(a126_0x1bfc76(0x133)),bad_request_error_1=require(a126_0x1bfc76(0xbe)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require(a126_0x1bfc76(0x12e)),commit_components_job_1=require(a126_0x1bfc76(0xcb)),constants_1=require(a126_0x1bfc76(0x117)),shortid_1=__importDefault(require('shortid')),providers_tokens_1=require('../../providers/providers.tokens'),commit_to_git_completed_notification_1=require(a126_0x1bfc76(0x100)),commit_to_git_error_notification_1=require(a126_0x1bfc76(0xbf));function a126_0x5383(_0x19ee81,_0x5cf8c0){const _0x5503c5=a126_0x5cee();return a126_0x5383=function(_0xcdb1a7,_0x52ea0f){_0xcdb1a7=_0xcdb1a7-0xbc;let _0x5cee72=_0x5503c5[_0xcdb1a7];return _0x5cee72;},a126_0x5383(_0x19ee81,_0x5cf8c0);}let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x42a150,_0x2f1983,_0x30d100){const _0x2f95a6=a126_0x1bfc76;this[_0x2f95a6(0xcc)]=_0x42a150,this[_0x2f95a6(0x12c)]=_0x2f1983,this[_0x2f95a6(0x130)]=_0x30d100,this[_0x2f95a6(0xd2)]=new core_1[(_0x2f95a6(0x136))](FlosumCommitJob_1[_0x2f95a6(0xca)]);}async[a126_0x1bfc76(0xf9)](_0x3b5c0a,_0x233dbd,_0x50bdbe,_0x298c3e){const _0x1194d5=a126_0x1bfc76;if(!this[_0x1194d5(0x11b)][_0x1194d5(0xea)]){this[_0x1194d5(0xd2)]['info'](_0x1194d5(0xc6));return;}await new commit_to_git_completed_notification_1[(_0x1194d5(0xc4))]({'emails':_0x3b5c0a,'gitProvider':_0x233dbd,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1[_0x1194d5(0xc4)]['name'],'repositoryName':_0x50bdbe,'branchName':_0x298c3e})[_0x1194d5(0x11a)]();}async[a126_0x1bfc76(0xfb)](_0x5b0abf,_0x541604,_0x40512a,_0x172989){const _0x89f1f3=a126_0x1bfc76;if(!this[_0x89f1f3(0x11b)][_0x89f1f3(0xea)]){this[_0x89f1f3(0xd2)][_0x89f1f3(0xd8)](_0x89f1f3(0xc6));return;}await new commit_to_git_error_notification_1[(_0x89f1f3(0x137))]({'emails':_0x5b0abf,'gitProvider':_0x541604,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0x89f1f3(0x137)][_0x89f1f3(0xca)],'repositoryName':_0x40512a,'branchName':_0x172989})[_0x89f1f3(0x11a)]();}async[a126_0x1bfc76(0xd9)](){const _0x357d99=a126_0x1bfc76;try{if(this[_0x357d99(0x11b)][_0x357d99(0xe8)])this[_0x357d99(0xe5)]=await this[_0x357d99(0x130)][_0x357d99(0x11d)](this['commitData'][_0x357d99(0xe8)]);else this[_0x357d99(0x11b)][_0x357d99(0x107)]&&(this['repositoryData']=await this[_0x357d99(0x130)][_0x357d99(0xf7)](this[_0x357d99(0x11b)][_0x357d99(0x107)]));}catch(_0x2c84d7){throw new bad_request_error_1['BadRequestError'](errors_1[_0x357d99(0x122)]);}}async[a126_0x1bfc76(0xeb)](){const _0x37a846=a126_0x1bfc76;if(!this[_0x37a846(0x11b)][_0x37a846(0xf0)])return[];await this[_0x37a846(0xcc)]['patchObject'](constants_1[_0x37a846(0xdc)],this['commitData'][_0x37a846(0xf0)],{'Name':(0x0,shortid_1[_0x37a846(0xf4)])()});const _0x1d0f6e=await this['salesforceService']['retrieveAttachment'](this[_0x37a846(0x11b)]['commitAttachmentId'])[_0x37a846(0xc5)](_0x1c3d13=>_0x1c3d13['split']('\x20')[_0x37a846(0x12d)](_0x5eb3ea=>_0x5eb3ea[_0x37a846(0xdd)]()));await this[_0x37a846(0xcc)]['deleteAttachment'](this['commitData'][_0x37a846(0xf0)]);const _0x5d80aa=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x37a846(0xcc)]);return await _0x5d80aa['run'](_0x1d0f6e);}async[a126_0x1bfc76(0xe1)](){const _0x2f8408=a126_0x1bfc76;if(!this[_0x2f8408(0x11b)]['deleteAttachmentId'])return[];await this[_0x2f8408(0xcc)][_0x2f8408(0x124)](constants_1[_0x2f8408(0xdc)],this[_0x2f8408(0x11b)][_0x2f8408(0xdf)],{'Name':(0x0,shortid_1[_0x2f8408(0xf4)])()});const _0x45bb82=await this['salesforceService'][_0x2f8408(0xc2)](this[_0x2f8408(0x11b)][_0x2f8408(0xdf)]),_0x43c12c=JSON[_0x2f8408(0x114)](_0x45bb82);return await this[_0x2f8408(0xcc)][_0x2f8408(0x132)](this[_0x2f8408(0x11b)][_0x2f8408(0xdf)]),_0x43c12c;}async[a126_0x1bfc76(0x10d)](){const _0x5dffd7=a126_0x1bfc76,_0x4e0ec1=new commit_components_dto_1[(_0x5dffd7(0xc3))](),[_0x53089f,_0x1a4f40]=await Promise[_0x5dffd7(0xed)]([this[_0x5dffd7(0xeb)](),this['getComponentsToDelete']()]);return _0x4e0ec1[_0x5dffd7(0x126)]=this[_0x5dffd7(0x11b)]['message'],_0x4e0ec1[_0x5dffd7(0xf3)]=this[_0x5dffd7(0x11b)][_0x5dffd7(0xf3)],_0x4e0ec1[_0x5dffd7(0xde)]={'writed':_0x53089f,'deleted':_0x1a4f40},_0x4e0ec1[_0x5dffd7(0xe7)]=this[_0x5dffd7(0x115)][_0x5dffd7(0x10c)],_0x4e0ec1[_0x5dffd7(0xef)]=this['repository'],_0x4e0ec1[_0x5dffd7(0xbc)]=this['branch'],_0x4e0ec1[_0x5dffd7(0xfd)]=this['config'][_0x5dffd7(0x139)],_0x4e0ec1[_0x5dffd7(0x119)]=this[_0x5dffd7(0xe5)][_0x5dffd7(0x12a)],_0x4e0ec1;}async[a126_0x1bfc76(0xf5)](_0x1e74bf=![]){const _0x1791d6=a126_0x1bfc76;if(_0x1e74bf)await this[_0x1791d6(0x130)][_0x1791d6(0x11c)](this[_0x1791d6(0xe5)],{});else{const _0x2c326e=await this[_0x1791d6(0x11e)][_0x1791d6(0xe2)][_0x1791d6(0xd3)](this[_0x1791d6(0xbc)][_0x1791d6(0xca)]);this['sfLogger'][_0x1791d6(0x134)](this[_0x1791d6(0x101)]+_0x1791d6(0xec));const _0x6f9aea={[this[_0x1791d6(0x11e)][_0x1791d6(0x108)]]:{'lastCommit':_0x2c326e[_0x1791d6(0xe0)]}};await this[_0x1791d6(0x130)]['updateRemoteState'](this[_0x1791d6(0xe5)],_0x6f9aea);}}async[a126_0x1bfc76(0x10b)](){const _0x18b1e1=a126_0x1bfc76,_0x287f97=await this[_0x18b1e1(0x10d)]();await this[_0x18b1e1(0x130)]['setStatus'](this[_0x18b1e1(0xe5)],_0x18b1e1(0xfa)),await this[_0x18b1e1(0x12c)]['run'](_0x287f97,this['prefix']),await this[_0x18b1e1(0xf5)](),await this[_0x18b1e1(0x130)][_0x18b1e1(0x109)](this[_0x18b1e1(0xe5)],_0x18b1e1(0x129));}async[a126_0x1bfc76(0x111)](_0x509630){const _0x28a72d=a126_0x1bfc76;try{this[_0x28a72d(0x113)][_0x28a72d(0xf2)](''+_0x509630),await this['sfLogger'][_0x28a72d(0x10e)](),await this['updateLastCommit'](!![]),await this[_0x28a72d(0x130)][_0x28a72d(0x109)](this['repositoryData'],_0x28a72d(0x135)),await this[_0x28a72d(0xf9)]([this[_0x28a72d(0x11b)]['user'][_0x28a72d(0x10a)]],this[_0x28a72d(0x115)][_0x28a72d(0x139)],this[_0x28a72d(0x11e)][_0x28a72d(0xca)],this[_0x28a72d(0xbc)][_0x28a72d(0xca)]);}catch(_0x13824b){this[_0x28a72d(0xd2)]['error'](_0x13824b),await this[_0x28a72d(0xfb)]([this[_0x28a72d(0x11b)][_0x28a72d(0xf3)][_0x28a72d(0x10a)]],this[_0x28a72d(0x115)][_0x28a72d(0x139)],this[_0x28a72d(0x11e)][_0x28a72d(0xca)],this[_0x28a72d(0xbc)]['name']);}}async[a126_0x1bfc76(0xc8)](_0x28eece){const _0x5ae04d=a126_0x1bfc76;try{this[_0x5ae04d(0x11b)]=_0x28eece,this[_0x5ae04d(0x121)]=typedi_1[_0x5ae04d(0x116)]['get'](providers_tokens_1[_0x5ae04d(0xf6)]['gitApiService']),this['repoService']=typedi_1[_0x5ae04d(0x116)][_0x5ae04d(0x12f)](providers_tokens_1[_0x5ae04d(0xf6)]['gitRepoService']),this['config']=typedi_1[_0x5ae04d(0x116)][_0x5ae04d(0x12f)](providers_tokens_1[_0x5ae04d(0xf6)]['config']),await this['fetchRepositoryData'](),this[_0x5ae04d(0x11e)]=await this[_0x5ae04d(0xdb)][_0x5ae04d(0xd3)](this[_0x5ae04d(0xe5)][_0x5ae04d(0xcd)]),this[_0x5ae04d(0xbc)]=await this[_0x5ae04d(0x11e)]['branches'][_0x5ae04d(0xd3)](this['repositoryData']['branchName']),this['sfLogger']=typedi_1[_0x5ae04d(0x116)][_0x5ae04d(0x12f)](providers_tokens_1[_0x5ae04d(0xf6)][_0x5ae04d(0xd2)]),this[_0x5ae04d(0x101)]=_0x5ae04d(0x123)+this[_0x5ae04d(0x115)]['gitProvider']['toUpperCase']()+_0x5ae04d(0x10f)+this[_0x5ae04d(0xe5)][_0x5ae04d(0xcd)]+_0x5ae04d(0xd0)+this[_0x5ae04d(0xe5)][_0x5ae04d(0xd7)]+_0x5ae04d(0xd4)+FlosumCommitJob_1[_0x5ae04d(0xca)]+']';if(!this[_0x5ae04d(0xe5)])throw new bad_request_error_1[(_0x5ae04d(0x106))](errors_1[_0x5ae04d(0xc0)]);await this[_0x5ae04d(0x113)][_0x5ae04d(0x134)](this[_0x5ae04d(0x101)]+_0x5ae04d(0x105))[_0x5ae04d(0x10e)](),await this[_0x5ae04d(0x10b)]()['catch'](_0x26e4c9=>this[_0x5ae04d(0x111)](_0x26e4c9)),await this[_0x5ae04d(0xf9)]([this[_0x5ae04d(0x11b)][_0x5ae04d(0xf3)][_0x5ae04d(0x10a)]],this[_0x5ae04d(0x115)][_0x5ae04d(0x139)],this[_0x5ae04d(0x11e)][_0x5ae04d(0xca)],this['branch']['name']);}catch(_0x265862){this[_0x5ae04d(0x11b)]=undefined,this[_0x5ae04d(0xd2)][_0x5ae04d(0xf2)](_0x265862),await this[_0x5ae04d(0xfb)]([this['commitData'][_0x5ae04d(0xf3)][_0x5ae04d(0x10a)]],this[_0x5ae04d(0x115)][_0x5ae04d(0x139)],this[_0x5ae04d(0x11e)][_0x5ae04d(0xca)],this[_0x5ae04d(0xbc)][_0x5ae04d(0xca)]);throw _0x265862;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a126_0x1bfc76(0x12b)])({'transient':!![]}),__metadata(a126_0x1bfc76(0xe6),[salesforce_service_1[a126_0x1bfc76(0x128)],commit_components_job_1[a126_0x1bfc76(0x138)],salesforce_sync_service_1[a126_0x1bfc76(0xfc)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;function a126_0x5cee(){const _0x3808c7=['565enbruw','retrieveAttachment','CommitComponentsDto','CommitToGitCompletedNotification','then','Email\x20notifications\x20are\x20disabled.','10321703QommCX','run','object','name','./commit-components.job','salesforceService','repositoryName','function','length',']\x20[Branch:\x20','FlosumCommitJob','logger','getOne',']\x20[','metadata','toString','branchName','info','fetchRepositoryData','apply','repoService','FLOSUM_ATTACHMENT','trim','components','deleteAttachmentId','sha','getComponentsToDelete','branches','search','getOwnPropertyDescriptor','repositoryData','design:paramtypes','convertToSFDX','syncRepositoryId','typedi','isEmailNotificationsEnabled','getComponentsToWrite','\x20Update\x20remote\x20state.','all','constructor','repo','commitAttachmentId','12852650xRNGfU','error','user','default','updateLastCommit','Tokens','getBranchRecord','(((.+)+)+)+$','completeNotification','In\x20Progress','errorNotification','SalesforceSyncService','provider','decorate','3urBZtf','../../notifications/commit-to-git-completed.notification','prefix','9191456AmmxaK','__decorate','defineProperty','\x20Start\x20Flosum\x20commit\x20job.','BadRequestError','syncBranchId','gitUrl','setStatus','email','exec','isConvertToSfdx','getCommitDto','send',']\x20[Repository:\x20','__esModule','handleCommitJobError','4206ufdIvt','sfLogger','parse','config','Container','../../../../constants','../../salesforce/services/salesforce.service','recordType','execute','commitData','updateRemoteState','getRepositoryRecord','repository','1186830MiOFNR','45CeSytF','gitApiService','ERR_INVALID_SYNC_RECORD_ID','[FLOSUM\x20->\x20GIT]\x20[','patchObject','1850252gsaLFR','message','__metadata','SalesforceService','Completed','recordTypeName','Service','commitJob','map','../dto/commit-components.dto','get','salesforceSync','__importDefault','deleteAttachment','../../../../constants/errors','log','Error','Logger','CommitToGitErrorNotification','CommitComponentsJob','gitProvider','branch','2469620JxsYiC','../../../../core/errors/bad-request.error','../../notifications/commit-to-git-error.notification','ERR_UNKNOWN_SYNC_RECORD_ID'];a126_0x5cee=function(){return _0x3808c7;};return a126_0x5cee();}