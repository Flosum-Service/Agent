const a124_0x3e1f3a=a124_0x4cb1;(function(_0xc3e386,_0x33fc83){const _0x5a80b5=a124_0x4cb1,_0x46bcbf=_0xc3e386();while(!![]){try{const _0x2e072c=-parseInt(_0x5a80b5(0x1ca))/0x1+-parseInt(_0x5a80b5(0x203))/0x2+parseInt(_0x5a80b5(0x1d0))/0x3+-parseInt(_0x5a80b5(0x1fe))/0x4+-parseInt(_0x5a80b5(0x1dd))/0x5*(-parseInt(_0x5a80b5(0x1d2))/0x6)+-parseInt(_0x5a80b5(0x1e2))/0x7*(parseInt(_0x5a80b5(0x1f7))/0x8)+-parseInt(_0x5a80b5(0x1de))/0x9*(-parseInt(_0x5a80b5(0x1cd))/0xa);if(_0x2e072c===_0x33fc83)break;else _0x46bcbf['push'](_0x46bcbf['shift']());}catch(_0x5c665a){_0x46bcbf['push'](_0x46bcbf['shift']());}}}(a124_0x4506,0xaed8c));const a124_0x45a82a=(function(){let _0x5c5e6d=!![];return function(_0x4b023b,_0x373eed){const _0x350178=_0x5c5e6d?function(){const _0x500270=a124_0x4cb1;if(_0x373eed){const _0x340aa2=_0x373eed[_0x500270(0x1ad)](_0x4b023b,arguments);return _0x373eed=null,_0x340aa2;}}:function(){};return _0x5c5e6d=![],_0x350178;};}()),a124_0x4c0e7c=a124_0x45a82a(this,function(){const _0x39fdbc=a124_0x4cb1;return a124_0x4c0e7c['toString']()[_0x39fdbc(0x1a4)](_0x39fdbc(0x1ff))['toString']()[_0x39fdbc(0x1e6)](a124_0x4c0e7c)[_0x39fdbc(0x1a4)](_0x39fdbc(0x1ff));});a124_0x4c0e7c();function a124_0x4506(){const _0x58c5f3=['__decorate','send','error','getComponentsToWrite','commitData','run','parse',']\x20[Branch:\x20','info','salesforceService','../../../../core','\x20Update\x20remote\x20state.','repo','provider','commitAttachmentId','catch','CommitComponentsJob','../../providers/providers.tokens','1161221zdRXVH','repository','object','23077050nenEtu','ERR_INVALID_SYNC_RECORD_ID','FLOSUM_ATTACHMENT','2241549pZywkh','\x20Start\x20Flosum\x20commit\x20job.','122586fghrKl','logger','__metadata','handleCommitJobError','metadata','errorNotification','function','email','patchObject','SalesforceRetrieverService','branchName','95fkwqcG','9MGeJek','commitJob','message','Email\x20notifications\x20are\x20disabled.','3115ftkhyM','CommitToGitCompletedNotification','fetchRepositoryData','../../salesforce/services/salesforce-sync.service','constructor','Tokens','../dto/commit-components.dto','default','getOne','[FLOSUM\x20->\x20GIT]\x20[','repositoryName','../../salesforce/services/salesforce-retriever.service','../../../../constants/errors','repositoryData','defineProperty','components','salesforceSync','updateRemoteState','../../notifications/commit-to-git-completed.notification','SalesforceSyncService','getOwnPropertyDescriptor','488agyDKV','CommitToGitErrorNotification','user','In\x20Progress','getRepositoryRecord','convertToSFDX','sha','5587560bDsdzJ','(((.+)+)+)+$','completeNotification','execute','gitApiService','283298hdUVrc','all','branch','Logger','Error','repoService','Container','isEmailNotificationsEnabled',']\x20[',']\x20[Repository:\x20','sfLogger','design:paramtypes','FlosumCommitJob','length','BadRequestError','../../../../core/errors/bad-request.error','split','prefix','shortid','syncRepositoryId','decorate','__importDefault','trim','search','getCommitDto','log','deleteAttachmentId','CommitComponentsDto','./commit-components.job','config','exec','deleteAttachment','apply','recordType','name','updateLastCommit','SalesforceService','get','gitProvider','__esModule','setStatus','../../salesforce/services/salesforce.service','branches'];a124_0x4506=function(){return _0x58c5f3;};return a124_0x4506();}'use strict';var __decorate=this&&this[a124_0x3e1f3a(0x1b8)]||function(_0x51a4a6,_0xe6cc17,_0x5f2d99,_0x332742){const _0x333028=a124_0x3e1f3a;var _0x2b4138=arguments[_0x333028(0x210)],_0xaaf66=_0x2b4138<0x3?_0xe6cc17:_0x332742===null?_0x332742=Object[_0x333028(0x1f6)](_0xe6cc17,_0x5f2d99):_0x332742,_0x2d8423;if(typeof Reflect===_0x333028(0x1cc)&&typeof Reflect[_0x333028(0x1a1)]===_0x333028(0x1d8))_0xaaf66=Reflect[_0x333028(0x1a1)](_0x51a4a6,_0xe6cc17,_0x5f2d99,_0x332742);else{for(var _0x3eda85=_0x51a4a6[_0x333028(0x210)]-0x1;_0x3eda85>=0x0;_0x3eda85--)if(_0x2d8423=_0x51a4a6[_0x3eda85])_0xaaf66=(_0x2b4138<0x3?_0x2d8423(_0xaaf66):_0x2b4138>0x3?_0x2d8423(_0xe6cc17,_0x5f2d99,_0xaaf66):_0x2d8423(_0xe6cc17,_0x5f2d99))||_0xaaf66;}return _0x2b4138>0x3&&_0xaaf66&&Object[_0x333028(0x1f0)](_0xe6cc17,_0x5f2d99,_0xaaf66),_0xaaf66;},__metadata=this&&this[a124_0x3e1f3a(0x1d4)]||function(_0x5de770,_0x54d42a){const _0x47ed7e=a124_0x3e1f3a;if(typeof Reflect===_0x47ed7e(0x1cc)&&typeof Reflect[_0x47ed7e(0x1d6)]===_0x47ed7e(0x1d8))return Reflect[_0x47ed7e(0x1d6)](_0x5de770,_0x54d42a);},__importDefault=this&&this[a124_0x3e1f3a(0x1a2)]||function(_0x267c82){const _0x345980=a124_0x3e1f3a;return _0x267c82&&_0x267c82[_0x345980(0x1b4)]?_0x267c82:{'default':_0x267c82};},FlosumCommitJob_1;function a124_0x4cb1(_0x288f47,_0x55cd4e){const _0x128566=a124_0x4506();return a124_0x4cb1=function(_0x4c0e7c,_0x45a82a){_0x4c0e7c=_0x4c0e7c-0x19b;let _0x4506a7=_0x128566[_0x4c0e7c];return _0x4506a7;},a124_0x4cb1(_0x288f47,_0x55cd4e);}Object[a124_0x3e1f3a(0x1f0)](exports,a124_0x3e1f3a(0x1b4),{'value':!![]}),exports[a124_0x3e1f3a(0x20f)]=void 0x0;const core_1=require(a124_0x3e1f3a(0x1c2)),salesforce_service_1=require(a124_0x3e1f3a(0x1b6)),typedi_1=require('typedi'),errors_1=require(a124_0x3e1f3a(0x1ee)),bad_request_error_1=require(a124_0x3e1f3a(0x19c)),salesforce_retriever_service_1=require(a124_0x3e1f3a(0x1ed)),salesforce_sync_service_1=require(a124_0x3e1f3a(0x1e5)),commit_components_dto_1=require(a124_0x3e1f3a(0x1e8)),commit_components_job_1=require(a124_0x3e1f3a(0x1a9)),constants_1=require('../../../../constants'),shortid_1=__importDefault(require(a124_0x3e1f3a(0x19f))),providers_tokens_1=require(a124_0x3e1f3a(0x1c9)),commit_to_git_completed_notification_1=require(a124_0x3e1f3a(0x1f4)),commit_to_git_error_notification_1=require('../../notifications/commit-to-git-error.notification');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x239f05,_0x2f0475,_0x26fac5){const _0x2d5c41=a124_0x3e1f3a;this[_0x2d5c41(0x1c1)]=_0x239f05,this[_0x2d5c41(0x1df)]=_0x2f0475,this[_0x2d5c41(0x1f2)]=_0x26fac5,this[_0x2d5c41(0x1d3)]=new core_1[(_0x2d5c41(0x206))](FlosumCommitJob_1['name']);}async[a124_0x3e1f3a(0x200)](_0x43352d,_0x2cf5a3,_0x24df94,_0x39edef){const _0x1ffcad=a124_0x3e1f3a;if(!this[_0x1ffcad(0x1bc)][_0x1ffcad(0x20a)]){this[_0x1ffcad(0x1d3)][_0x1ffcad(0x1c0)]('Email\x20notifications\x20are\x20disabled.');return;}await new commit_to_git_completed_notification_1[(_0x1ffcad(0x1e3))]({'emails':_0x43352d,'gitProvider':_0x2cf5a3,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1['CommitToGitCompletedNotification'][_0x1ffcad(0x1af)],'repositoryName':_0x24df94,'branchName':_0x39edef})[_0x1ffcad(0x201)]();}async[a124_0x3e1f3a(0x1d7)](_0x6cd69b,_0x2a6020,_0x4a4c91,_0x57170b){const _0x1aa955=a124_0x3e1f3a;if(!this[_0x1aa955(0x1bc)][_0x1aa955(0x20a)]){this[_0x1aa955(0x1d3)][_0x1aa955(0x1c0)](_0x1aa955(0x1e1));return;}await new commit_to_git_error_notification_1[(_0x1aa955(0x1f8))]({'emails':_0x6cd69b,'gitProvider':_0x2a6020,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0x1aa955(0x1f8)]['name'],'repositoryName':_0x4a4c91,'branchName':_0x57170b})['execute']();}async[a124_0x3e1f3a(0x1e4)](){const _0x41d22d=a124_0x3e1f3a;try{if(this[_0x41d22d(0x1bc)][_0x41d22d(0x1a0)])this[_0x41d22d(0x1ef)]=await this['salesforceSync'][_0x41d22d(0x1fb)](this[_0x41d22d(0x1bc)][_0x41d22d(0x1a0)]);else this['commitData']['syncBranchId']&&(this[_0x41d22d(0x1ef)]=await this[_0x41d22d(0x1f2)]['getBranchRecord'](this[_0x41d22d(0x1bc)]['syncBranchId']));}catch(_0xe49f25){throw new bad_request_error_1[(_0x41d22d(0x19b))](errors_1[_0x41d22d(0x1ce)]);}}async[a124_0x3e1f3a(0x1bb)](){const _0x4f8097=a124_0x3e1f3a;if(!this[_0x4f8097(0x1bc)][_0x4f8097(0x1c6)])return[];await this[_0x4f8097(0x1c1)][_0x4f8097(0x1da)](constants_1[_0x4f8097(0x1cf)],this[_0x4f8097(0x1bc)][_0x4f8097(0x1c6)],{'Name':(0x0,shortid_1['default'])()});const _0x36df75=await this[_0x4f8097(0x1c1)]['retrieveAttachment'](this[_0x4f8097(0x1bc)]['commitAttachmentId'])['then'](_0x56955f=>_0x56955f[_0x4f8097(0x19d)]('\x20')['map'](_0x4b083e=>_0x4b083e[_0x4f8097(0x1a3)]()));await this['salesforceService'][_0x4f8097(0x1ac)](this['commitData']['commitAttachmentId']);const _0x543050=new salesforce_retriever_service_1[(_0x4f8097(0x1db))](this[_0x4f8097(0x1c1)]);return await _0x543050['run'](_0x36df75);}async['getComponentsToDelete'](){const _0x34e130=a124_0x3e1f3a;if(!this['commitData']['deleteAttachmentId'])return[];await this['salesforceService'][_0x34e130(0x1da)](constants_1[_0x34e130(0x1cf)],this[_0x34e130(0x1bc)][_0x34e130(0x1a7)],{'Name':(0x0,shortid_1[_0x34e130(0x1e9)])()});const _0x241231=await this[_0x34e130(0x1c1)]['retrieveAttachment'](this[_0x34e130(0x1bc)][_0x34e130(0x1a7)]),_0x1718a7=JSON[_0x34e130(0x1be)](_0x241231);return await this['salesforceService'][_0x34e130(0x1ac)](this[_0x34e130(0x1bc)][_0x34e130(0x1a7)]),_0x1718a7;}async[a124_0x3e1f3a(0x1a5)](){const _0x5ab184=a124_0x3e1f3a,_0x758c84=new commit_components_dto_1[(_0x5ab184(0x1a8))](),[_0x48af2d,_0x5aee23]=await Promise[_0x5ab184(0x204)]([this[_0x5ab184(0x1bb)](),this['getComponentsToDelete']()]);return _0x758c84[_0x5ab184(0x1e0)]=this[_0x5ab184(0x1bc)]['message'],_0x758c84[_0x5ab184(0x1f9)]=this[_0x5ab184(0x1bc)]['user'],_0x758c84[_0x5ab184(0x1f1)]={'writed':_0x48af2d,'deleted':_0x5aee23},_0x758c84[_0x5ab184(0x1fc)]=this['config']['isConvertToSfdx'],_0x758c84[_0x5ab184(0x1c4)]=this[_0x5ab184(0x1cb)],_0x758c84[_0x5ab184(0x205)]=this[_0x5ab184(0x205)],_0x758c84[_0x5ab184(0x1c5)]=this[_0x5ab184(0x1aa)][_0x5ab184(0x1b3)],_0x758c84[_0x5ab184(0x1ae)]=this[_0x5ab184(0x1ef)]['recordTypeName'],_0x758c84;}async[a124_0x3e1f3a(0x1b0)](_0x495d7d=![]){const _0x1a290d=a124_0x3e1f3a;if(_0x495d7d)await this[_0x1a290d(0x1f2)][_0x1a290d(0x1f3)](this[_0x1a290d(0x1ef)],{});else{const _0x2c4c01=await this[_0x1a290d(0x1cb)]['branches']['getOne'](this[_0x1a290d(0x205)]['name']);this[_0x1a290d(0x20d)][_0x1a290d(0x1a6)](this[_0x1a290d(0x19e)]+_0x1a290d(0x1c3));const _0x2ccb29={[this[_0x1a290d(0x1cb)]['gitUrl']]:{'lastCommit':_0x2c4c01[_0x1a290d(0x1fd)]}};await this[_0x1a290d(0x1f2)]['updateRemoteState'](this[_0x1a290d(0x1ef)],_0x2ccb29);}}async[a124_0x3e1f3a(0x1ab)](){const _0xbacf=a124_0x3e1f3a,_0x1e5195=await this[_0xbacf(0x1a5)]();await this[_0xbacf(0x1f2)][_0xbacf(0x1b5)](this['repositoryData'],_0xbacf(0x1fa)),await this[_0xbacf(0x1df)][_0xbacf(0x1bd)](_0x1e5195,this[_0xbacf(0x19e)]),await this[_0xbacf(0x1b0)](),await this['salesforceSync'][_0xbacf(0x1b5)](this['repositoryData'],'Completed');}async[a124_0x3e1f3a(0x1d5)](_0x5357c0){const _0x2c9e80=a124_0x3e1f3a;try{this['sfLogger'][_0x2c9e80(0x1ba)](''+_0x5357c0),await this['sfLogger']['send'](),await this[_0x2c9e80(0x1b0)](!![]),await this[_0x2c9e80(0x1f2)][_0x2c9e80(0x1b5)](this[_0x2c9e80(0x1ef)],_0x2c9e80(0x207)),await this[_0x2c9e80(0x200)]([this[_0x2c9e80(0x1bc)][_0x2c9e80(0x1f9)][_0x2c9e80(0x1d9)]],this['config'][_0x2c9e80(0x1b3)],this[_0x2c9e80(0x1cb)]['name'],this[_0x2c9e80(0x205)][_0x2c9e80(0x1af)]);}catch(_0x575cf3){this[_0x2c9e80(0x1d3)][_0x2c9e80(0x1ba)](_0x575cf3),await this[_0x2c9e80(0x1d7)]([this[_0x2c9e80(0x1bc)]['user'][_0x2c9e80(0x1d9)]],this[_0x2c9e80(0x1aa)]['gitProvider'],this[_0x2c9e80(0x1cb)]['name'],this[_0x2c9e80(0x205)][_0x2c9e80(0x1af)]);}}async[a124_0x3e1f3a(0x1bd)](_0x3af600){const _0x5cc69d=a124_0x3e1f3a;try{this['commitData']=_0x3af600,this['gitApiService']=typedi_1['Container'][_0x5cc69d(0x1b2)](providers_tokens_1[_0x5cc69d(0x1e7)][_0x5cc69d(0x202)]),this[_0x5cc69d(0x208)]=typedi_1[_0x5cc69d(0x209)]['get'](providers_tokens_1[_0x5cc69d(0x1e7)]['gitRepoService']),this[_0x5cc69d(0x1aa)]=typedi_1['Container'][_0x5cc69d(0x1b2)](providers_tokens_1[_0x5cc69d(0x1e7)]['config']),await this[_0x5cc69d(0x1e4)](),this[_0x5cc69d(0x1cb)]=await this[_0x5cc69d(0x208)][_0x5cc69d(0x1ea)](this[_0x5cc69d(0x1ef)][_0x5cc69d(0x1ec)]),this['branch']=await this[_0x5cc69d(0x1cb)][_0x5cc69d(0x1b7)][_0x5cc69d(0x1ea)](this[_0x5cc69d(0x1ef)][_0x5cc69d(0x1dc)]),this[_0x5cc69d(0x20d)]=typedi_1[_0x5cc69d(0x209)]['get'](providers_tokens_1[_0x5cc69d(0x1e7)][_0x5cc69d(0x1d3)]),this['prefix']=_0x5cc69d(0x1eb)+this[_0x5cc69d(0x1aa)][_0x5cc69d(0x1b3)]['toUpperCase']()+_0x5cc69d(0x20c)+this[_0x5cc69d(0x1ef)][_0x5cc69d(0x1ec)]+_0x5cc69d(0x1bf)+this[_0x5cc69d(0x1ef)][_0x5cc69d(0x1dc)]+_0x5cc69d(0x20b)+FlosumCommitJob_1[_0x5cc69d(0x1af)]+']';if(!this[_0x5cc69d(0x1ef)])throw new bad_request_error_1[(_0x5cc69d(0x19b))](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this['sfLogger'][_0x5cc69d(0x1a6)](this['prefix']+_0x5cc69d(0x1d1))[_0x5cc69d(0x1b9)](),await this[_0x5cc69d(0x1ab)]()[_0x5cc69d(0x1c7)](_0x32e8f9=>this[_0x5cc69d(0x1d5)](_0x32e8f9)),await this[_0x5cc69d(0x200)]([this[_0x5cc69d(0x1bc)]['user']['email']],this[_0x5cc69d(0x1aa)]['gitProvider'],this[_0x5cc69d(0x1cb)]['name'],this['branch'][_0x5cc69d(0x1af)]);}catch(_0x96b19f){this[_0x5cc69d(0x1bc)]=undefined,this[_0x5cc69d(0x1d3)]['error'](_0x96b19f),await this['errorNotification']([this[_0x5cc69d(0x1bc)]['user'][_0x5cc69d(0x1d9)]],this[_0x5cc69d(0x1aa)]['gitProvider'],this[_0x5cc69d(0x1cb)]['name'],this[_0x5cc69d(0x205)][_0x5cc69d(0x1af)]);throw _0x96b19f;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a124_0x3e1f3a(0x20e),[salesforce_service_1[a124_0x3e1f3a(0x1b1)],commit_components_job_1[a124_0x3e1f3a(0x1c8)],salesforce_sync_service_1[a124_0x3e1f3a(0x1f5)]])],FlosumCommitJob),exports[a124_0x3e1f3a(0x20f)]=FlosumCommitJob;