const a61_0x1d6630=a61_0x44fc;(function(_0x27ad2c,_0x5c9f14){const _0x463631=a61_0x44fc,_0x17ee55=_0x27ad2c();while(!![]){try{const _0x127609=parseInt(_0x463631(0xe2))/0x1*(-parseInt(_0x463631(0x111))/0x2)+parseInt(_0x463631(0x120))/0x3+parseInt(_0x463631(0x126))/0x4+parseInt(_0x463631(0xe3))/0x5+parseInt(_0x463631(0x117))/0x6+parseInt(_0x463631(0xe8))/0x7*(parseInt(_0x463631(0xf2))/0x8)+-parseInt(_0x463631(0x102))/0x9*(parseInt(_0x463631(0x11f))/0xa);if(_0x127609===_0x5c9f14)break;else _0x17ee55['push'](_0x17ee55['shift']());}catch(_0x5e551a){_0x17ee55['push'](_0x17ee55['shift']());}}}(a61_0xbc14,0x8ccf4));const a61_0x7a705c=(function(){let _0x4824e7=!![];return function(_0x50aa3c,_0x30b48b){const _0x52d3ab=_0x4824e7?function(){const _0x13d5d1=a61_0x44fc;if(_0x30b48b){const _0x5d24bb=_0x30b48b[_0x13d5d1(0xf1)](_0x50aa3c,arguments);return _0x30b48b=null,_0x5d24bb;}}:function(){};return _0x4824e7=![],_0x52d3ab;};}()),a61_0x1464af=a61_0x7a705c(this,function(){const _0x15d7fc=a61_0x44fc;return a61_0x1464af[_0x15d7fc(0x10b)]()[_0x15d7fc(0x135)]('(((.+)+)+)+$')[_0x15d7fc(0x10b)]()['constructor'](a61_0x1464af)[_0x15d7fc(0x135)](_0x15d7fc(0x130));});a61_0x1464af();function a61_0xbc14(){const _0x372a1d=['repoService','repositoryName','handleCommitJobError','SalesforceService','defineProperty','sha','1506490AoThTb','1642509TXGfQf','repository','retrieveAttachment','send','Logger','__decorate','509296kksQBM','[FLOSUM\x20->\x20GIT]\x20[','object','branch','isConvertToSfdx','typedi','get','prefix','split','Completed','(((.+)+)+)+$','error','SalesforceRetrieverService','providersFactory','salesforceSync','search','catch','CommitComponentsJob','metadata','deleteAttachmentId','syncRepositoryId','getRepositoryRecord','commitAttachmentId','updateLastCommit','../../salesforce/services/salesforce-retriever.service','repositoryData','RepositoryFactory','message','Error','updateRemoteState','name','ERR_INVALID_SYNC_RECORD_ID','config','getComponentsToWrite','user','getCommitDto','provider','getBranchRecord','patchObject',']\x20[','CommitComponentsDto','FLOSUM_ATTACHMENT','Container','188BqSRpf','2526925BVplFz','default','trim','branchName','\x20Update\x20remote\x20state.','13055BbVDiX','function','getComponentsToDelete','SalesforceSyncService','commitJob','deleteAttachment','../dto/commit-components.dto','logger','__importDefault','apply','1448iRaknJ','__metadata','__esModule','log','Service','BadRequestError','syncBranchId','decorate','length','fetchRepositoryData','ProvidersFactory','Tokens','../../../../core/errors/bad-request.error','../../salesforce/services/salesforce-sync.service','gitApiService','getOne','54LSCdHt','../../salesforce/services/salesforce.service','setStatus','then','../../providers/providers.tokens','all','convertToSFDX','../../../../core','createFromContext','toString','branches','gitUrl','gitProvider','map','salesforceService','11146eWwntT','sfLogger','commitData','components','FlosumCommitJob',']\x20[Repository:\x20','6063582Zuzjyb','../../../../constants'];a61_0xbc14=function(){return _0x372a1d;};return a61_0xbc14();}'use strict';var __decorate=this&&this[a61_0x1d6630(0x125)]||function(_0x4d861b,_0x105689,_0x41109e,_0xb73014){const _0x4cee9a=a61_0x1d6630;var _0x5a1451=arguments[_0x4cee9a(0xfa)],_0x3a2517=_0x5a1451<0x3?_0x105689:_0xb73014===null?_0xb73014=Object['getOwnPropertyDescriptor'](_0x105689,_0x41109e):_0xb73014,_0x9c1cd2;if(typeof Reflect===_0x4cee9a(0x128)&&typeof Reflect[_0x4cee9a(0xf9)]===_0x4cee9a(0xe9))_0x3a2517=Reflect[_0x4cee9a(0xf9)](_0x4d861b,_0x105689,_0x41109e,_0xb73014);else{for(var _0x4434fc=_0x4d861b[_0x4cee9a(0xfa)]-0x1;_0x4434fc>=0x0;_0x4434fc--)if(_0x9c1cd2=_0x4d861b[_0x4434fc])_0x3a2517=(_0x5a1451<0x3?_0x9c1cd2(_0x3a2517):_0x5a1451>0x3?_0x9c1cd2(_0x105689,_0x41109e,_0x3a2517):_0x9c1cd2(_0x105689,_0x41109e))||_0x3a2517;}return _0x5a1451>0x3&&_0x3a2517&&Object['defineProperty'](_0x105689,_0x41109e,_0x3a2517),_0x3a2517;},__metadata=this&&this[a61_0x1d6630(0xf3)]||function(_0x59e30e,_0x1ad9d8){const _0x301f65=a61_0x1d6630;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x301f65(0xe9))return Reflect[_0x301f65(0x138)](_0x59e30e,_0x1ad9d8);},__importDefault=this&&this[a61_0x1d6630(0xf0)]||function(_0x2481ea){const _0x48d41c=a61_0x1d6630;return _0x2481ea&&_0x2481ea[_0x48d41c(0xf4)]?_0x2481ea:{'default':_0x2481ea};},FlosumCommitJob_1;Object[a61_0x1d6630(0x11d)](exports,a61_0x1d6630(0xf4),{'value':!![]}),exports[a61_0x1d6630(0x115)]=void 0x0;function a61_0x44fc(_0x4c56ef,_0x149772){const _0x16ef5c=a61_0xbc14();return a61_0x44fc=function(_0x1464af,_0x7a705c){_0x1464af=_0x1464af-0xe1;let _0xbc14ca=_0x16ef5c[_0x1464af];return _0xbc14ca;},a61_0x44fc(_0x4c56ef,_0x149772);}const core_1=require(a61_0x1d6630(0x109)),salesforce_service_1=require(a61_0x1d6630(0x103)),typedi_1=require(a61_0x1d6630(0x12b)),errors_1=require('../../../../constants/errors'),bad_request_error_1=require(a61_0x1d6630(0xfe)),salesforce_retriever_service_1=require(a61_0x1d6630(0x13e)),salesforce_sync_service_1=require(a61_0x1d6630(0xff)),commit_components_dto_1=require(a61_0x1d6630(0xee)),commit_components_job_1=require('./commit-components.job'),constants_1=require(a61_0x1d6630(0x118)),shortid_1=__importDefault(require('shortid')),providers_tokens_1=require(a61_0x1d6630(0x106)),repository_factory_1=require('../../providers/repositories/repository.factory'),connection_1=require('../utils/connection');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x1e1677,_0x3ba0a0,_0x2077c0,_0x45e8c0){const _0x6c01aa=a61_0x1d6630;this[_0x6c01aa(0x110)]=_0x1e1677,this[_0x6c01aa(0xec)]=_0x3ba0a0,this[_0x6c01aa(0x134)]=_0x2077c0,this['providersFactory']=_0x45e8c0,this[_0x6c01aa(0xef)]=new core_1[(_0x6c01aa(0x124))](FlosumCommitJob_1[_0x6c01aa(0x144)]);}async[a61_0x1d6630(0xfb)](){const _0x10fcbd=a61_0x1d6630;try{if(this[_0x10fcbd(0x113)][_0x10fcbd(0x13a)])this[_0x10fcbd(0x13f)]=await this['salesforceSync'][_0x10fcbd(0x13b)](this[_0x10fcbd(0x113)][_0x10fcbd(0x13a)]);else this['commitData'][_0x10fcbd(0xf8)]&&(this[_0x10fcbd(0x13f)]=await this[_0x10fcbd(0x134)][_0x10fcbd(0x14b)](this[_0x10fcbd(0x113)][_0x10fcbd(0xf8)]));}catch(_0x3f41c9){throw new bad_request_error_1[(_0x10fcbd(0xf7))](errors_1[_0x10fcbd(0x145)]);}}async[a61_0x1d6630(0x147)](){const _0x13074a=a61_0x1d6630;if(!this[_0x13074a(0x113)][_0x13074a(0x13c)])return[];await this[_0x13074a(0x110)][_0x13074a(0x14c)](constants_1[_0x13074a(0x14f)],this[_0x13074a(0x113)][_0x13074a(0x13c)],{'Name':shortid_1[_0x13074a(0xe4)]()});const _0x13b538=await this['salesforceService'][_0x13074a(0x122)](this[_0x13074a(0x113)][_0x13074a(0x13c)])[_0x13074a(0x105)](_0x47b01c=>_0x47b01c[_0x13074a(0x12e)]('\x20')[_0x13074a(0x10f)](_0x562cc1=>_0x562cc1[_0x13074a(0xe5)]()));await this['salesforceService'][_0x13074a(0xed)](this[_0x13074a(0x113)][_0x13074a(0x13c)]);const _0x1c5819=new salesforce_retriever_service_1[(_0x13074a(0x132))](this[_0x13074a(0x110)]);return await _0x1c5819['run'](_0x13b538);}async[a61_0x1d6630(0xea)](){const _0x375f67=a61_0x1d6630;if(!this['commitData']['deleteAttachmentId'])return[];await this[_0x375f67(0x110)][_0x375f67(0x14c)](constants_1['FLOSUM_ATTACHMENT'],this[_0x375f67(0x113)][_0x375f67(0x139)],{'Name':shortid_1['default']()});const _0x576beb=await this[_0x375f67(0x110)][_0x375f67(0x122)](this[_0x375f67(0x113)][_0x375f67(0x139)]);return await this[_0x375f67(0x110)][_0x375f67(0xed)](this[_0x375f67(0x113)][_0x375f67(0x139)]),_0x576beb;}async[a61_0x1d6630(0x149)](){const _0x50cd64=a61_0x1d6630,_0x46e1fe=new commit_components_dto_1[(_0x50cd64(0x14e))](),[_0x1af13e,_0x34d7f5]=await Promise[_0x50cd64(0x107)]([this[_0x50cd64(0x147)](),this[_0x50cd64(0xea)]()]);return _0x46e1fe[_0x50cd64(0x141)]=this[_0x50cd64(0x113)][_0x50cd64(0x141)],_0x46e1fe[_0x50cd64(0x148)]=this['commitData'][_0x50cd64(0x148)],_0x46e1fe[_0x50cd64(0x114)]={'writed':_0x1af13e,'deleted':_0x34d7f5},_0x46e1fe[_0x50cd64(0x108)]=this[_0x50cd64(0x146)][_0x50cd64(0x12a)],_0x46e1fe['repo']=this[_0x50cd64(0x121)],_0x46e1fe[_0x50cd64(0x129)]=this[_0x50cd64(0x129)],_0x46e1fe[_0x50cd64(0x14a)]=this[_0x50cd64(0x146)][_0x50cd64(0x10e)],_0x46e1fe;}async[a61_0x1d6630(0x13d)](_0x676014=![]){const _0x338644=a61_0x1d6630;if(_0x676014)await this[_0x338644(0x134)]['updateRemoteState'](this[_0x338644(0x13f)],{});else{const _0x1f9c9f=await this['repository'][_0x338644(0x10c)][_0x338644(0x101)](this[_0x338644(0x129)][_0x338644(0x144)]);this[_0x338644(0x112)]['log'](this[_0x338644(0x12d)]+_0x338644(0xe7));const _0x4485cd={[this[_0x338644(0x121)][_0x338644(0x10d)]]:{'lastCommit':_0x1f9c9f[_0x338644(0x11e)]}};await this['salesforceSync'][_0x338644(0x143)](this[_0x338644(0x13f)],_0x4485cd);}}async['exec'](){const _0x583929=a61_0x1d6630,_0x2d3ddd=await this[_0x583929(0x149)]();await this[_0x583929(0x134)]['setStatus'](this[_0x583929(0x13f)],'In\x20Progress'),await this[_0x583929(0xec)]['run'](_0x2d3ddd,this[_0x583929(0x12d)]),await this[_0x583929(0x13d)](),await this[_0x583929(0x134)][_0x583929(0x104)](this['repositoryData'],_0x583929(0x12f));}async[a61_0x1d6630(0x11b)](_0xc6ce18){const _0x457c4a=a61_0x1d6630;try{this['sfLogger']['error'](''+_0xc6ce18),await this[_0x457c4a(0x112)][_0x457c4a(0x123)](),await this[_0x457c4a(0x13d)](!![]),await this[_0x457c4a(0x134)]['setStatus'](this[_0x457c4a(0x13f)],_0x457c4a(0x142));}catch(_0x329004){this['logger'][_0x457c4a(0x131)](_0x329004);}}async['run'](_0x39181e,_0x1f76fc){const _0x3b17be=a61_0x1d6630;try{this['commitData']=_0x39181e,this[_0x3b17be(0x100)]=await this[_0x3b17be(0x133)]['createFromConnection'](_0x1f76fc),this[_0x3b17be(0x119)]=await repository_factory_1[_0x3b17be(0x140)][_0x3b17be(0x10a)](typedi_1[_0x3b17be(0xe1)]),this[_0x3b17be(0x146)]=typedi_1[_0x3b17be(0xe1)]['get'](providers_tokens_1[_0x3b17be(0xfd)][_0x3b17be(0x146)]),await this[_0x3b17be(0xfb)](),this[_0x3b17be(0x121)]=await this[_0x3b17be(0x119)][_0x3b17be(0x101)](this['repositoryData'][_0x3b17be(0x11a)]),this[_0x3b17be(0x129)]=await this[_0x3b17be(0x121)][_0x3b17be(0x10c)][_0x3b17be(0x101)](this[_0x3b17be(0x13f)][_0x3b17be(0xe6)]),this['sfLogger']=typedi_1[_0x3b17be(0xe1)][_0x3b17be(0x12c)](providers_tokens_1['Tokens'][_0x3b17be(0xef)]),this[_0x3b17be(0x12d)]=_0x3b17be(0x127)+this[_0x3b17be(0x146)][_0x3b17be(0x10e)]['toUpperCase']()+_0x3b17be(0x116)+this['repositoryData'][_0x3b17be(0x11a)]+']\x20[Branch:\x20'+this['repositoryData']['branchName']+_0x3b17be(0x14d)+FlosumCommitJob_1[_0x3b17be(0x144)]+']';if(!this[_0x3b17be(0x13f)])throw new bad_request_error_1[(_0x3b17be(0xf7))](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this[_0x3b17be(0x112)][_0x3b17be(0xf5)](this[_0x3b17be(0x12d)]+'\x20Start\x20Flosum\x20commit\x20job.')[_0x3b17be(0x123)](),await this['exec']()[_0x3b17be(0x136)](_0x186532=>this[_0x3b17be(0x11b)](_0x186532));}catch(_0x1b3aea){this[_0x3b17be(0x113)]=undefined,this[_0x3b17be(0xef)]['error'](_0x1b3aea);throw _0x1b3aea;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a61_0x1d6630(0xf6)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a61_0x1d6630(0x11c)],commit_components_job_1[a61_0x1d6630(0x137)],salesforce_sync_service_1[a61_0x1d6630(0xeb)],connection_1[a61_0x1d6630(0xfc)]])],FlosumCommitJob),exports[a61_0x1d6630(0x115)]=FlosumCommitJob;