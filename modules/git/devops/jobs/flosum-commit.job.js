const a105_0x4f3647=a105_0x5395;(function(_0x4d3d3a,_0xa1699e){const _0x13edf7=a105_0x5395,_0xf2613b=_0x4d3d3a();while(!![]){try{const _0x4e8b08=parseInt(_0x13edf7(0x15d))/0x1*(parseInt(_0x13edf7(0x1ae))/0x2)+-parseInt(_0x13edf7(0x1ad))/0x3*(-parseInt(_0x13edf7(0x15a))/0x4)+parseInt(_0x13edf7(0x167))/0x5+-parseInt(_0x13edf7(0x1a7))/0x6+parseInt(_0x13edf7(0x15b))/0x7*(-parseInt(_0x13edf7(0x19e))/0x8)+-parseInt(_0x13edf7(0x178))/0x9+-parseInt(_0x13edf7(0x1bc))/0xa;if(_0x4e8b08===_0xa1699e)break;else _0xf2613b['push'](_0xf2613b['shift']());}catch(_0x5e6e7f){_0xf2613b['push'](_0xf2613b['shift']());}}}(a105_0x59ce,0xc1424));const a105_0x560662=(function(){let _0x3d853d=!![];return function(_0x4a2ab9,_0x4be032){const _0x25b414=_0x3d853d?function(){const _0x4670f8=a105_0x5395;if(_0x4be032){const _0x3b9e7d=_0x4be032[_0x4670f8(0x1be)](_0x4a2ab9,arguments);return _0x4be032=null,_0x3b9e7d;}}:function(){};return _0x3d853d=![],_0x25b414;};}()),a105_0x5c6706=a105_0x560662(this,function(){const _0x43fcb4=a105_0x5395;return a105_0x5c6706[_0x43fcb4(0x17b)]()[_0x43fcb4(0x15e)](_0x43fcb4(0x1a8))[_0x43fcb4(0x17b)]()[_0x43fcb4(0x183)](a105_0x5c6706)[_0x43fcb4(0x15e)]('(((.+)+)+)+$');});a105_0x5c6706();'use strict';var __decorate=this&&this['__decorate']||function(_0x4de5c4,_0x51b3e8,_0xcf942e,_0x5d34b7){const _0x584514=a105_0x5395;var _0x30dbd3=arguments['length'],_0x514b0a=_0x30dbd3<0x3?_0x51b3e8:_0x5d34b7===null?_0x5d34b7=Object[_0x584514(0x19a)](_0x51b3e8,_0xcf942e):_0x5d34b7,_0x1600cd;if(typeof Reflect==='object'&&typeof Reflect[_0x584514(0x189)]===_0x584514(0x1b9))_0x514b0a=Reflect[_0x584514(0x189)](_0x4de5c4,_0x51b3e8,_0xcf942e,_0x5d34b7);else{for(var _0x522689=_0x4de5c4[_0x584514(0x1a9)]-0x1;_0x522689>=0x0;_0x522689--)if(_0x1600cd=_0x4de5c4[_0x522689])_0x514b0a=(_0x30dbd3<0x3?_0x1600cd(_0x514b0a):_0x30dbd3>0x3?_0x1600cd(_0x51b3e8,_0xcf942e,_0x514b0a):_0x1600cd(_0x51b3e8,_0xcf942e))||_0x514b0a;}return _0x30dbd3>0x3&&_0x514b0a&&Object[_0x584514(0x16a)](_0x51b3e8,_0xcf942e,_0x514b0a),_0x514b0a;},__metadata=this&&this[a105_0x4f3647(0x1aa)]||function(_0x479648,_0x322504){const _0xc41efd=a105_0x4f3647;if(typeof Reflect===_0xc41efd(0x190)&&typeof Reflect[_0xc41efd(0x166)]==='function')return Reflect[_0xc41efd(0x166)](_0x479648,_0x322504);},__importDefault=this&&this['__importDefault']||function(_0x5f1ea3){const _0x17686e=a105_0x4f3647;return _0x5f1ea3&&_0x5f1ea3[_0x17686e(0x1a4)]?_0x5f1ea3:{'default':_0x5f1ea3};},FlosumCommitJob_1;function a105_0x5395(_0x219953,_0x2ba536){const _0x298b19=a105_0x59ce();return a105_0x5395=function(_0x5c6706,_0x560662){_0x5c6706=_0x5c6706-0x158;let _0x59ce3a=_0x298b19[_0x5c6706];return _0x59ce3a;},a105_0x5395(_0x219953,_0x2ba536);}Object['defineProperty'](exports,a105_0x4f3647(0x1a4),{'value':!![]}),exports[a105_0x4f3647(0x185)]=void 0x0;const core_1=require(a105_0x4f3647(0x175)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a105_0x4f3647(0x1b4)),errors_1=require(a105_0x4f3647(0x1ab)),bad_request_error_1=require('../../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a105_0x4f3647(0x197)),salesforce_sync_service_1=require(a105_0x4f3647(0x176)),commit_components_dto_1=require(a105_0x4f3647(0x181)),commit_components_job_1=require(a105_0x4f3647(0x17e)),constants_1=require(a105_0x4f3647(0x18e)),shortid_1=__importDefault(require(a105_0x4f3647(0x1c5))),providers_tokens_1=require(a105_0x4f3647(0x163));function a105_0x59ce(){const _0x384ca5=['SalesforceService','run','../dto/commit-components.dto','updateLastCommit','constructor','In\x20Progress','FlosumCommitJob','patchObject',']\x20[Repository:\x20','repositoryData','decorate','getCommitDto','syncRepositoryId','logger','gitUrl','../../../../constants','commitJob','object','isConvertToSfdx','updateRemoteState','sha','salesforceService','send','gitProvider','../../salesforce/services/salesforce-retriever.service','\x20Update\x20remote\x20state.','provider','getOwnPropertyDescriptor','components','design:paramtypes','commitData','309616CSHkgZ','branch','getOne','config','map','then','__esModule','Logger','CommitComponentsDto','543204riSnYT','(((.+)+)+)+$','length','__metadata','../../../../constants/errors','repository','3FoqLIJ','206FwITvm','salesforceSync','deleteAttachmentId','syncBranchId','gitApiService','user','typedi','commitAttachmentId','Tokens','trim','get','function','setStatus','name','8044730QBAtgR','exec','apply','[FLOSUM\x20->\x20GIT]\x20[','gitRepoService','prefix','ERR_INVALID_SYNC_RECORD_ID','split','Container','shortid','getComponentsToDelete','repoService','4481140NUzMKA','28qHlJdl','branchName','14431jnSzyg','search','Completed','all','default','message','../../providers/providers.tokens','catch','FLOSUM_ATTACHMENT','metadata','3925290QkIVBh','retrieveAttachment','BadRequestError','defineProperty','log','Error','SalesforceRetrieverService','sfLogger','ERR_UNKNOWN_SYNC_RECORD_ID','getRepositoryRecord','deleteAttachment','fetchRepositoryData','parse','handleCommitJobError','../../../../core','../../salesforce/services/salesforce-sync.service','getBranchRecord','13952997KrKTfK','branches','convertToSFDX','toString','repositoryName','error','./commit-components.job'];a105_0x59ce=function(){return _0x384ca5;};return a105_0x59ce();}let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x57a6db,_0x393dc5,_0x36a70c){const _0x45a90e=a105_0x4f3647;this[_0x45a90e(0x194)]=_0x57a6db,this[_0x45a90e(0x18f)]=_0x393dc5,this[_0x45a90e(0x1af)]=_0x36a70c,this[_0x45a90e(0x18c)]=new core_1[(_0x45a90e(0x1a5))](FlosumCommitJob_1[_0x45a90e(0x1bb)]);}async[a105_0x4f3647(0x172)](){const _0x13c55e=a105_0x4f3647;try{if(this[_0x13c55e(0x19d)][_0x13c55e(0x18b)])this[_0x13c55e(0x188)]=await this[_0x13c55e(0x1af)][_0x13c55e(0x170)](this[_0x13c55e(0x19d)][_0x13c55e(0x18b)]);else this[_0x13c55e(0x19d)][_0x13c55e(0x1b1)]&&(this['repositoryData']=await this['salesforceSync'][_0x13c55e(0x177)](this['commitData'][_0x13c55e(0x1b1)]));}catch(_0x3695c2){throw new bad_request_error_1[(_0x13c55e(0x169))](errors_1[_0x13c55e(0x1c2)]);}}async['getComponentsToWrite'](){const _0x5efcfe=a105_0x4f3647;if(!this[_0x5efcfe(0x19d)]['commitAttachmentId'])return[];await this[_0x5efcfe(0x194)][_0x5efcfe(0x186)](constants_1['FLOSUM_ATTACHMENT'],this[_0x5efcfe(0x19d)][_0x5efcfe(0x1b5)],{'Name':(0x0,shortid_1[_0x5efcfe(0x161)])()});const _0x5cec3b=await this[_0x5efcfe(0x194)]['retrieveAttachment'](this[_0x5efcfe(0x19d)][_0x5efcfe(0x1b5)])[_0x5efcfe(0x1a3)](_0x13ee7a=>_0x13ee7a[_0x5efcfe(0x1c3)]('\x20')[_0x5efcfe(0x1a2)](_0x43432c=>_0x43432c[_0x5efcfe(0x1b7)]()));await this[_0x5efcfe(0x194)][_0x5efcfe(0x171)](this[_0x5efcfe(0x19d)][_0x5efcfe(0x1b5)]);const _0x15ebf0=new salesforce_retriever_service_1[(_0x5efcfe(0x16d))](this['salesforceService']);return await _0x15ebf0[_0x5efcfe(0x180)](_0x5cec3b);}async[a105_0x4f3647(0x158)](){const _0x44171d=a105_0x4f3647;if(!this[_0x44171d(0x19d)][_0x44171d(0x1b0)])return[];await this[_0x44171d(0x194)]['patchObject'](constants_1[_0x44171d(0x165)],this[_0x44171d(0x19d)]['deleteAttachmentId'],{'Name':(0x0,shortid_1['default'])()});const _0x78aa13=await this['salesforceService'][_0x44171d(0x168)](this['commitData'][_0x44171d(0x1b0)]),_0xde8577=JSON[_0x44171d(0x173)](_0x78aa13);return await this[_0x44171d(0x194)][_0x44171d(0x171)](this[_0x44171d(0x19d)][_0x44171d(0x1b0)]),_0xde8577;}async['getCommitDto'](){const _0x45857d=a105_0x4f3647,_0x3db01f=new commit_components_dto_1[(_0x45857d(0x1a6))](),[_0x5d9614,_0x321ea9]=await Promise[_0x45857d(0x160)]([this['getComponentsToWrite'](),this[_0x45857d(0x158)]()]);return _0x3db01f[_0x45857d(0x162)]=this[_0x45857d(0x19d)][_0x45857d(0x162)],_0x3db01f[_0x45857d(0x1b3)]=this['commitData'][_0x45857d(0x1b3)],_0x3db01f[_0x45857d(0x19b)]={'writed':_0x5d9614,'deleted':_0x321ea9},_0x3db01f[_0x45857d(0x17a)]=this['config'][_0x45857d(0x191)],_0x3db01f['repo']=this[_0x45857d(0x1ac)],_0x3db01f[_0x45857d(0x19f)]=this[_0x45857d(0x19f)],_0x3db01f[_0x45857d(0x199)]=this[_0x45857d(0x1a1)][_0x45857d(0x196)],_0x3db01f;}async[a105_0x4f3647(0x182)](_0x5147e6=![]){const _0x208cfc=a105_0x4f3647;if(_0x5147e6)await this[_0x208cfc(0x1af)][_0x208cfc(0x192)](this[_0x208cfc(0x188)],{});else{const _0x428630=await this['repository']['branches'][_0x208cfc(0x1a0)](this[_0x208cfc(0x19f)][_0x208cfc(0x1bb)]);this[_0x208cfc(0x16e)]['log'](this[_0x208cfc(0x1c1)]+_0x208cfc(0x198));const _0x4ef80f={[this[_0x208cfc(0x1ac)][_0x208cfc(0x18d)]]:{'lastCommit':_0x428630[_0x208cfc(0x193)]}};await this[_0x208cfc(0x1af)][_0x208cfc(0x192)](this[_0x208cfc(0x188)],_0x4ef80f);}}async[a105_0x4f3647(0x1bd)](){const _0x501e2d=a105_0x4f3647,_0x10c60c=await this[_0x501e2d(0x18a)]();await this[_0x501e2d(0x1af)][_0x501e2d(0x1ba)](this[_0x501e2d(0x188)],_0x501e2d(0x184)),await this[_0x501e2d(0x18f)][_0x501e2d(0x180)](_0x10c60c,this[_0x501e2d(0x1c1)]),await this[_0x501e2d(0x182)](),await this[_0x501e2d(0x1af)][_0x501e2d(0x1ba)](this[_0x501e2d(0x188)],_0x501e2d(0x15f));}async[a105_0x4f3647(0x174)](_0x432541){const _0x605d62=a105_0x4f3647;try{this['sfLogger'][_0x605d62(0x17d)](''+_0x432541),await this[_0x605d62(0x16e)][_0x605d62(0x195)](),await this[_0x605d62(0x182)](!![]),await this['salesforceSync']['setStatus'](this[_0x605d62(0x188)],_0x605d62(0x16c));}catch(_0x699760){this[_0x605d62(0x18c)][_0x605d62(0x17d)](_0x699760);}}async[a105_0x4f3647(0x180)](_0x567b6f){const _0x52787d=a105_0x4f3647;try{this[_0x52787d(0x19d)]=_0x567b6f,this['gitApiService']=typedi_1[_0x52787d(0x1c4)][_0x52787d(0x1b8)](providers_tokens_1[_0x52787d(0x1b6)][_0x52787d(0x1b2)]),this[_0x52787d(0x159)]=typedi_1[_0x52787d(0x1c4)][_0x52787d(0x1b8)](providers_tokens_1[_0x52787d(0x1b6)][_0x52787d(0x1c0)]),this['config']=typedi_1[_0x52787d(0x1c4)][_0x52787d(0x1b8)](providers_tokens_1[_0x52787d(0x1b6)][_0x52787d(0x1a1)]),await this[_0x52787d(0x172)](),this[_0x52787d(0x1ac)]=await this[_0x52787d(0x159)]['getOne'](this[_0x52787d(0x188)][_0x52787d(0x17c)]),this[_0x52787d(0x19f)]=await this['repository'][_0x52787d(0x179)][_0x52787d(0x1a0)](this[_0x52787d(0x188)][_0x52787d(0x15c)]),this[_0x52787d(0x16e)]=typedi_1[_0x52787d(0x1c4)]['get'](providers_tokens_1[_0x52787d(0x1b6)][_0x52787d(0x18c)]),this['prefix']=_0x52787d(0x1bf)+this['config'][_0x52787d(0x196)]['toUpperCase']()+_0x52787d(0x187)+this[_0x52787d(0x188)][_0x52787d(0x17c)]+']\x20[Branch:\x20'+this[_0x52787d(0x188)][_0x52787d(0x15c)]+']\x20['+FlosumCommitJob_1[_0x52787d(0x1bb)]+']';if(!this['repositoryData'])throw new bad_request_error_1[(_0x52787d(0x169))](errors_1[_0x52787d(0x16f)]);await this[_0x52787d(0x16e)][_0x52787d(0x16b)](this[_0x52787d(0x1c1)]+'\x20Start\x20Flosum\x20commit\x20job.')['send'](),await this[_0x52787d(0x1bd)]()[_0x52787d(0x164)](_0x3bd532=>this[_0x52787d(0x174)](_0x3bd532));}catch(_0x496a38){this['commitData']=undefined,this[_0x52787d(0x18c)]['error'](_0x496a38);throw _0x496a38;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a105_0x4f3647(0x19c),[salesforce_service_1[a105_0x4f3647(0x17f)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1['SalesforceSyncService']])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;