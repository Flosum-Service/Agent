const a123_0xfc5db1=a123_0x23ce;(function(_0x20352e,_0x2e3ec4){const _0x328089=a123_0x23ce,_0x4631e9=_0x20352e();while(!![]){try{const _0x18332d=-parseInt(_0x328089(0x113))/0x1*(parseInt(_0x328089(0x148))/0x2)+-parseInt(_0x328089(0x124))/0x3+-parseInt(_0x328089(0x108))/0x4+parseInt(_0x328089(0x15a))/0x5*(parseInt(_0x328089(0x13a))/0x6)+-parseInt(_0x328089(0x13b))/0x7*(parseInt(_0x328089(0xfe))/0x8)+parseInt(_0x328089(0x149))/0x9*(-parseInt(_0x328089(0xf7))/0xa)+parseInt(_0x328089(0x107))/0xb;if(_0x18332d===_0x2e3ec4)break;else _0x4631e9['push'](_0x4631e9['shift']());}catch(_0x315066){_0x4631e9['push'](_0x4631e9['shift']());}}}(a123_0x45a6,0x29d36));const a123_0x2a3b88=(function(){let _0x1f3cb6=!![];return function(_0x1b8929,_0x537cd1){const _0x526e1a=_0x1f3cb6?function(){if(_0x537cd1){const _0x35493b=_0x537cd1['apply'](_0x1b8929,arguments);return _0x537cd1=null,_0x35493b;}}:function(){};return _0x1f3cb6=![],_0x526e1a;};}()),a123_0x138427=a123_0x2a3b88(this,function(){const _0x28f228=a123_0x23ce;return a123_0x138427[_0x28f228(0xf5)]()[_0x28f228(0x130)](_0x28f228(0x10d))['toString']()[_0x28f228(0x14d)](a123_0x138427)['search'](_0x28f228(0x10d));});a123_0x138427();'use strict';var __decorate=this&&this[a123_0xfc5db1(0xfd)]||function(_0x329ca3,_0x41999b,_0x329d74,_0x56de2d){const _0x2a9262=a123_0xfc5db1;var _0x9b9f93=arguments[_0x2a9262(0xf9)],_0x269867=_0x9b9f93<0x3?_0x41999b:_0x56de2d===null?_0x56de2d=Object['getOwnPropertyDescriptor'](_0x41999b,_0x329d74):_0x56de2d,_0x163454;if(typeof Reflect===_0x2a9262(0x147)&&typeof Reflect[_0x2a9262(0x139)]===_0x2a9262(0x157))_0x269867=Reflect[_0x2a9262(0x139)](_0x329ca3,_0x41999b,_0x329d74,_0x56de2d);else{for(var _0x371c1e=_0x329ca3['length']-0x1;_0x371c1e>=0x0;_0x371c1e--)if(_0x163454=_0x329ca3[_0x371c1e])_0x269867=(_0x9b9f93<0x3?_0x163454(_0x269867):_0x9b9f93>0x3?_0x163454(_0x41999b,_0x329d74,_0x269867):_0x163454(_0x41999b,_0x329d74))||_0x269867;}return _0x9b9f93>0x3&&_0x269867&&Object[_0x2a9262(0x14b)](_0x41999b,_0x329d74,_0x269867),_0x269867;},__metadata=this&&this[a123_0xfc5db1(0x127)]||function(_0xb07530,_0x182e1d){const _0x55449b=a123_0xfc5db1;if(typeof Reflect===_0x55449b(0x147)&&typeof Reflect[_0x55449b(0x11a)]===_0x55449b(0x157))return Reflect['metadata'](_0xb07530,_0x182e1d);},__importDefault=this&&this[a123_0xfc5db1(0x135)]||function(_0x5556ff){return _0x5556ff&&_0x5556ff['__esModule']?_0x5556ff:{'default':_0x5556ff};},FlosumCommitJob_1;Object[a123_0xfc5db1(0x14b)](exports,a123_0xfc5db1(0x158),{'value':!![]}),exports[a123_0xfc5db1(0x146)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require(a123_0xfc5db1(0x14f)),typedi_1=require(a123_0xfc5db1(0x104)),errors_1=require(a123_0xfc5db1(0x12a)),bad_request_error_1=require(a123_0xfc5db1(0x128)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a123_0xfc5db1(0x145)),commit_components_dto_1=require(a123_0xfc5db1(0x11c)),commit_components_job_1=require(a123_0xfc5db1(0x110)),constants_1=require(a123_0xfc5db1(0x156)),shortid_1=__importDefault(require(a123_0xfc5db1(0x13e))),providers_tokens_1=require(a123_0xfc5db1(0x14a));function a123_0x45a6(){const _0x634f06=['syncBranchId','1773290wdsguI','Completed','length','[FLOSUM\x20->\x20GIT]\x20[','ERR_INVALID_SYNC_RECORD_ID','gitUrl','__decorate','582696MHGVIZ','getOne','BadRequestError','gitApiService','log','message','typedi','all','getBranchRecord','9855725GCcXxd','1221216tKLlQQ','handleCommitJobError','user','branch','recordType','(((.+)+)+)+$','commitData','\x20Start\x20Flosum\x20commit\x20job.','./commit-components.job','ERR_UNKNOWN_SYNC_RECORD_ID','SalesforceSyncService','6GpbOtV','SalesforceRetrieverService','getComponentsToWrite','isConvertToSfdx','repoService','gitProvider','prefix','metadata','name','../dto/commit-components.dto','Logger','SalesforceService','In\x20Progress','branchName','send','setStatus','get','550008LdDBwz','default','patchObject','__metadata','../../../../core/errors/bad-request.error','repo','../../../../constants/errors','Tokens','logger','sha','config','repository','search','getCommitDto','sfLogger','updateLastCommit','provider','__importDefault','FLOSUM_ATTACHMENT','retrieveAttachment','salesforceSync','decorate','4290snuHiq','7MNdRxV','toUpperCase','CommitComponentsJob','shortid','trim','run','Service','Container','then','exec','../../salesforce/services/salesforce-sync.service','FlosumCommitJob','object','92762YBBHbs','9XAPKBM','../../providers/providers.tokens','defineProperty','repositoryData','constructor','commitAttachmentId','../../salesforce/services/salesforce.service','updateRemoteState',']\x20[Repository:\x20',']\x20[Branch:\x20','getComponentsToDelete','CommitComponentsDto','fetchRepositoryData','../../../../constants','function','__esModule','deleteAttachment','2045ggrFBy','syncRepositoryId','salesforceService','gitRepoService','repositoryName','recordTypeName','deleteAttachmentId','error','commitJob','toString'];a123_0x45a6=function(){return _0x634f06;};return a123_0x45a6();}function a123_0x23ce(_0x370d5d,_0x44084c){const _0x24a3b4=a123_0x45a6();return a123_0x23ce=function(_0x138427,_0x2a3b88){_0x138427=_0x138427-0xf0;let _0x45a6ba=_0x24a3b4[_0x138427];return _0x45a6ba;},a123_0x23ce(_0x370d5d,_0x44084c);}let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x12fed9,_0x386e46,_0x4974cf){const _0xc698b6=a123_0xfc5db1;this['salesforceService']=_0x12fed9,this[_0xc698b6(0xf4)]=_0x386e46,this[_0xc698b6(0x138)]=_0x4974cf,this[_0xc698b6(0x12c)]=new core_1[(_0xc698b6(0x11d))](FlosumCommitJob_1[_0xc698b6(0x11b)]);}async[a123_0xfc5db1(0x155)](){const _0x2d755a=a123_0xfc5db1;try{if(this['commitData'][_0x2d755a(0x15b)])this[_0x2d755a(0x14c)]=await this['salesforceSync']['getRepositoryRecord'](this[_0x2d755a(0x10e)][_0x2d755a(0x15b)]);else this[_0x2d755a(0x10e)][_0x2d755a(0xf6)]&&(this[_0x2d755a(0x14c)]=await this[_0x2d755a(0x138)][_0x2d755a(0x106)](this[_0x2d755a(0x10e)][_0x2d755a(0xf6)]));}catch(_0x45bbc7){throw new bad_request_error_1[(_0x2d755a(0x100))](errors_1[_0x2d755a(0xfb)]);}}async[a123_0xfc5db1(0x115)](){const _0x39de99=a123_0xfc5db1;if(!this[_0x39de99(0x10e)][_0x39de99(0x14e)])return[];await this[_0x39de99(0x15c)][_0x39de99(0x126)](constants_1[_0x39de99(0x136)],this[_0x39de99(0x10e)][_0x39de99(0x14e)],{'Name':(0x0,shortid_1[_0x39de99(0x125)])()});const _0x18bdfb=await this['salesforceService'][_0x39de99(0x137)](this['commitData'][_0x39de99(0x14e)])[_0x39de99(0x143)](_0x505713=>_0x505713['split']('\x20')['map'](_0x232c13=>_0x232c13[_0x39de99(0x13f)]()));await this[_0x39de99(0x15c)][_0x39de99(0x159)](this[_0x39de99(0x10e)]['commitAttachmentId']);const _0xae7482=new salesforce_retriever_service_1[(_0x39de99(0x114))](this[_0x39de99(0x15c)]);return await _0xae7482['run'](_0x18bdfb);}async['getComponentsToDelete'](){const _0x41df71=a123_0xfc5db1;if(!this[_0x41df71(0x10e)][_0x41df71(0xf2)])return[];await this['salesforceService']['patchObject'](constants_1[_0x41df71(0x136)],this['commitData'][_0x41df71(0xf2)],{'Name':(0x0,shortid_1['default'])()});const _0x4cb852=await this[_0x41df71(0x15c)][_0x41df71(0x137)](this['commitData'][_0x41df71(0xf2)]),_0x5dc2c7=JSON['parse'](_0x4cb852);return await this[_0x41df71(0x15c)][_0x41df71(0x159)](this[_0x41df71(0x10e)][_0x41df71(0xf2)]),_0x5dc2c7;}async[a123_0xfc5db1(0x131)](){const _0x245a54=a123_0xfc5db1,_0x53fc86=new commit_components_dto_1[(_0x245a54(0x154))](),[_0x10f589,_0x4ffe63]=await Promise[_0x245a54(0x105)]([this[_0x245a54(0x115)](),this[_0x245a54(0x153)]()]);return _0x53fc86[_0x245a54(0x103)]=this['commitData'][_0x245a54(0x103)],_0x53fc86[_0x245a54(0x10a)]=this[_0x245a54(0x10e)]['user'],_0x53fc86['components']={'writed':_0x10f589,'deleted':_0x4ffe63},_0x53fc86['convertToSFDX']=this['config'][_0x245a54(0x116)],_0x53fc86[_0x245a54(0x129)]=this['repository'],_0x53fc86[_0x245a54(0x10b)]=this[_0x245a54(0x10b)],_0x53fc86[_0x245a54(0x134)]=this[_0x245a54(0x12e)][_0x245a54(0x118)],_0x53fc86[_0x245a54(0x10c)]=this[_0x245a54(0x14c)][_0x245a54(0xf1)],_0x53fc86;}async[a123_0xfc5db1(0x133)](_0x173dac=![]){const _0x4428b0=a123_0xfc5db1;if(_0x173dac)await this[_0x4428b0(0x138)][_0x4428b0(0x150)](this[_0x4428b0(0x14c)],{});else{const _0xa7820=await this['repository']['branches'][_0x4428b0(0xff)](this[_0x4428b0(0x10b)][_0x4428b0(0x11b)]);this['sfLogger'][_0x4428b0(0x102)](this['prefix']+'\x20Update\x20remote\x20state.');const _0x388373={[this[_0x4428b0(0x12f)][_0x4428b0(0xfc)]]:{'lastCommit':_0xa7820[_0x4428b0(0x12d)]}};await this[_0x4428b0(0x138)][_0x4428b0(0x150)](this[_0x4428b0(0x14c)],_0x388373);}}async[a123_0xfc5db1(0x144)](){const _0x2e5362=a123_0xfc5db1,_0x23ef7e=await this[_0x2e5362(0x131)]();await this[_0x2e5362(0x138)]['setStatus'](this[_0x2e5362(0x14c)],_0x2e5362(0x11f)),await this['commitJob']['run'](_0x23ef7e,this[_0x2e5362(0x119)]),await this[_0x2e5362(0x133)](),await this[_0x2e5362(0x138)][_0x2e5362(0x122)](this[_0x2e5362(0x14c)],_0x2e5362(0xf8));}async[a123_0xfc5db1(0x109)](_0x4c0610){const _0x51700c=a123_0xfc5db1;try{this[_0x51700c(0x132)][_0x51700c(0xf3)](''+_0x4c0610),await this[_0x51700c(0x132)][_0x51700c(0x121)](),await this[_0x51700c(0x133)](!![]),await this[_0x51700c(0x138)][_0x51700c(0x122)](this[_0x51700c(0x14c)],'Error');}catch(_0x1fe44a){this[_0x51700c(0x12c)][_0x51700c(0xf3)](_0x1fe44a);}}async[a123_0xfc5db1(0x140)](_0x1e0d85){const _0x36174e=a123_0xfc5db1;try{this[_0x36174e(0x10e)]=_0x1e0d85,this[_0x36174e(0x101)]=typedi_1[_0x36174e(0x142)][_0x36174e(0x123)](providers_tokens_1[_0x36174e(0x12b)][_0x36174e(0x101)]),this[_0x36174e(0x117)]=typedi_1[_0x36174e(0x142)][_0x36174e(0x123)](providers_tokens_1[_0x36174e(0x12b)][_0x36174e(0x15d)]),this[_0x36174e(0x12e)]=typedi_1[_0x36174e(0x142)][_0x36174e(0x123)](providers_tokens_1[_0x36174e(0x12b)][_0x36174e(0x12e)]),await this['fetchRepositoryData'](),this[_0x36174e(0x12f)]=await this['repoService'][_0x36174e(0xff)](this['repositoryData'][_0x36174e(0xf0)]),this[_0x36174e(0x10b)]=await this[_0x36174e(0x12f)]['branches'][_0x36174e(0xff)](this[_0x36174e(0x14c)][_0x36174e(0x120)]),this[_0x36174e(0x132)]=typedi_1['Container']['get'](providers_tokens_1[_0x36174e(0x12b)][_0x36174e(0x12c)]),this[_0x36174e(0x119)]=_0x36174e(0xfa)+this[_0x36174e(0x12e)][_0x36174e(0x118)][_0x36174e(0x13c)]()+_0x36174e(0x151)+this[_0x36174e(0x14c)][_0x36174e(0xf0)]+_0x36174e(0x152)+this[_0x36174e(0x14c)][_0x36174e(0x120)]+']\x20['+FlosumCommitJob_1[_0x36174e(0x11b)]+']';if(!this['repositoryData'])throw new bad_request_error_1[(_0x36174e(0x100))](errors_1[_0x36174e(0x111)]);await this[_0x36174e(0x132)]['log'](this['prefix']+_0x36174e(0x10f))[_0x36174e(0x121)](),await this[_0x36174e(0x144)]()['catch'](_0xb9e0ef=>this[_0x36174e(0x109)](_0xb9e0ef));}catch(_0x119aa4){this[_0x36174e(0x10e)]=undefined,this[_0x36174e(0x12c)]['error'](_0x119aa4);throw _0x119aa4;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a123_0xfc5db1(0x141)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a123_0xfc5db1(0x11e)],commit_components_job_1[a123_0xfc5db1(0x13d)],salesforce_sync_service_1[a123_0xfc5db1(0x112)]])],FlosumCommitJob),exports[a123_0xfc5db1(0x146)]=FlosumCommitJob;