function a126_0x57a0(){const _0x24b115=['commitData','CommitComponentsDto','trim','constructor','execute','catch','user',']\x20[Repository:\x20','../../../../constants','158568BTPuSc','default','retrieveAttachment','6370659NVcGuP','deleteAttachment','Service','Logger','getComponentsToWrite','object','error','metadata','info','completeNotification','errorNotification','../../salesforce/services/salesforce-retriever.service','isConvertToSfdx','setStatus','email','gitProvider','search','getBranchRecord','90OZdPBZ','FlosumCommitJob','7ggUcsJ','split','repository','repo','getRepositoryRecord','isEmailNotificationsEnabled','../../salesforce/services/salesforce-sync.service','branchName','commitAttachmentId','typedi','73650ZZaRbU','Container','sfLogger','run','logger','CommitToGitErrorNotification','2129068wbHAqa','log','branch','commitJob','fetchRepositoryData','salesforceSync','prefix','salesforceService','repositoryData','recordType','send','../../notifications/commit-to-git-error.notification','message','patchObject','CommitComponentsJob','decorate','repositoryName','getOne','Tokens','./commit-components.job','__importDefault','recordTypeName','then','gitApiService','Error','name','../../providers/providers.tokens','getOwnPropertyDescriptor','all','Completed','getCommitDto','10090890Ojtxah','ERR_INVALID_SYNC_RECORD_ID','8585630TxWOrO','config','../../notifications/commit-to-git-completed.notification','BadRequestError','\x20Update\x20remote\x20state.','toString','\x20Start\x20Flosum\x20commit\x20job.','toUpperCase','../dto/commit-components.dto',']\x20[Branch:\x20','apply','defineProperty','getComponentsToDelete','SalesforceService','[FLOSUM\x20->\x20GIT]\x20[','provider','CommitToGitCompletedNotification','repoService','In\x20Progress','syncRepositoryId','ERR_UNKNOWN_SYNC_RECORD_ID',']\x20[','13727264fFrYOO','__metadata','map','parse','shortid','FLOSUM_ATTACHMENT','deleteAttachmentId','gitRepoService','design:paramtypes','updateLastCommit','handleCommitJobError','length','branches','(((.+)+)+)+$','sha','60xPAhWB'];a126_0x57a0=function(){return _0x24b115;};return a126_0x57a0();}const a126_0x8fd520=a126_0x52f2;(function(_0x5afea1,_0xb75a97){const _0x50a15b=a126_0x52f2,_0x198c72=_0x5afea1();while(!![]){try{const _0x3c40b3=-parseInt(_0x50a15b(0xee))/0x1+-parseInt(_0x50a15b(0xf4))/0x2+parseInt(_0x50a15b(0x13a))/0x3*(parseInt(_0x50a15b(0x144))/0x4)+-parseInt(_0x50a15b(0x115))/0x5+-parseInt(_0x50a15b(0x113))/0x6+-parseInt(_0x50a15b(0xe4))/0x7*(parseInt(_0x50a15b(0x12b))/0x8)+-parseInt(_0x50a15b(0x147))/0x9*(-parseInt(_0x50a15b(0xe2))/0xa);if(_0x3c40b3===_0xb75a97)break;else _0x198c72['push'](_0x198c72['shift']());}catch(_0xb6b176){_0x198c72['push'](_0x198c72['shift']());}}}(a126_0x57a0,0xde482));function a126_0x52f2(_0x4878eb,_0x391bba){const _0x1957a0=a126_0x57a0();return a126_0x52f2=function(_0x12156f,_0x23b4a7){_0x12156f=_0x12156f-0xdd;let _0x57a041=_0x1957a0[_0x12156f];return _0x57a041;},a126_0x52f2(_0x4878eb,_0x391bba);}const a126_0x23b4a7=(function(){let _0x6bf675=!![];return function(_0x1d9370,_0x1d1600){const _0x2acc52=_0x6bf675?function(){const _0x5f5a7a=a126_0x52f2;if(_0x1d1600){const _0x5ca8f0=_0x1d1600[_0x5f5a7a(0x11f)](_0x1d9370,arguments);return _0x1d1600=null,_0x5ca8f0;}}:function(){};return _0x6bf675=![],_0x2acc52;};}()),a126_0x12156f=a126_0x23b4a7(this,function(){const _0x4750b2=a126_0x52f2;return a126_0x12156f['toString']()[_0x4750b2(0xe0)](_0x4750b2(0x138))[_0x4750b2(0x11a)]()[_0x4750b2(0x13e)](a126_0x12156f)[_0x4750b2(0xe0)](_0x4750b2(0x138));});a126_0x12156f();'use strict';var __decorate=this&&this['__decorate']||function(_0x2831b7,_0x5a0b41,_0x2a477c,_0xd19e0d){const _0x2971fd=a126_0x52f2;var _0x1fdc08=arguments['length'],_0x58ee96=_0x1fdc08<0x3?_0x5a0b41:_0xd19e0d===null?_0xd19e0d=Object[_0x2971fd(0x10f)](_0x5a0b41,_0x2a477c):_0xd19e0d,_0xbce7e4;if(typeof Reflect===_0x2971fd(0x14c)&&typeof Reflect['decorate']==='function')_0x58ee96=Reflect[_0x2971fd(0x103)](_0x2831b7,_0x5a0b41,_0x2a477c,_0xd19e0d);else{for(var _0x26fed7=_0x2831b7[_0x2971fd(0x136)]-0x1;_0x26fed7>=0x0;_0x26fed7--)if(_0xbce7e4=_0x2831b7[_0x26fed7])_0x58ee96=(_0x1fdc08<0x3?_0xbce7e4(_0x58ee96):_0x1fdc08>0x3?_0xbce7e4(_0x5a0b41,_0x2a477c,_0x58ee96):_0xbce7e4(_0x5a0b41,_0x2a477c))||_0x58ee96;}return _0x1fdc08>0x3&&_0x58ee96&&Object[_0x2971fd(0x120)](_0x5a0b41,_0x2a477c,_0x58ee96),_0x58ee96;},__metadata=this&&this[a126_0x8fd520(0x12c)]||function(_0x415234,_0xd6342a){const _0x47ee8a=a126_0x8fd520;if(typeof Reflect===_0x47ee8a(0x14c)&&typeof Reflect[_0x47ee8a(0x14e)]==='function')return Reflect[_0x47ee8a(0x14e)](_0x415234,_0xd6342a);},__importDefault=this&&this[a126_0x8fd520(0x108)]||function(_0x95b0f9){return _0x95b0f9&&_0x95b0f9['__esModule']?_0x95b0f9:{'default':_0x95b0f9};},FlosumCommitJob_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a126_0x8fd520(0xe3)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),typedi_1=require(a126_0x8fd520(0xed)),errors_1=require('../../../../constants/errors'),bad_request_error_1=require('../../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a126_0x8fd520(0x152)),salesforce_sync_service_1=require(a126_0x8fd520(0xea)),commit_components_dto_1=require(a126_0x8fd520(0x11d)),commit_components_job_1=require(a126_0x8fd520(0x107)),constants_1=require(a126_0x8fd520(0x143)),shortid_1=__importDefault(require(a126_0x8fd520(0x12f))),providers_tokens_1=require(a126_0x8fd520(0x10e)),commit_to_git_completed_notification_1=require(a126_0x8fd520(0x117)),commit_to_git_error_notification_1=require(a126_0x8fd520(0xff));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x5a3e81,_0x3390ce,_0x33000a){const _0xa6ba21=a126_0x8fd520;this[_0xa6ba21(0xfb)]=_0x5a3e81,this['commitJob']=_0x3390ce,this['salesforceSync']=_0x33000a,this[_0xa6ba21(0xf2)]=new core_1[(_0xa6ba21(0x14a))](FlosumCommitJob_1[_0xa6ba21(0x10d)]);}async[a126_0x8fd520(0x150)](_0x14208a,_0x288d4e,_0x1b1186,_0x44f9de){const _0x31a108=a126_0x8fd520;if(!this['commitData'][_0x31a108(0xe9)]){this[_0x31a108(0xf2)][_0x31a108(0x14f)]('Email\x20notifications\x20are\x20disabled.');return;}await new commit_to_git_completed_notification_1['CommitToGitCompletedNotification']({'emails':_0x14208a,'gitProvider':_0x288d4e,'completionTime':new Date(),'loggerName':commit_to_git_completed_notification_1[_0x31a108(0x125)][_0x31a108(0x10d)],'repositoryName':_0x1b1186,'branchName':_0x44f9de})['execute']();}async[a126_0x8fd520(0x151)](_0x270c8e,_0x3caabd,_0x2544b6,_0x4f1981){const _0xffc064=a126_0x8fd520;if(!this[_0xffc064(0x13b)]['isEmailNotificationsEnabled']){this['logger'][_0xffc064(0x14f)]('Email\x20notifications\x20are\x20disabled.');return;}await new commit_to_git_error_notification_1[(_0xffc064(0xf3))]({'emails':_0x270c8e,'gitProvider':_0x3caabd,'completionTime':new Date(),'loggerName':commit_to_git_error_notification_1[_0xffc064(0xf3)][_0xffc064(0x10d)],'repositoryName':_0x2544b6,'branchName':_0x4f1981})[_0xffc064(0x13f)]();}async['fetchRepositoryData'](){const _0x1b033a=a126_0x8fd520;try{if(this['commitData']['syncRepositoryId'])this[_0x1b033a(0xfc)]=await this[_0x1b033a(0xf9)][_0x1b033a(0xe8)](this[_0x1b033a(0x13b)][_0x1b033a(0x128)]);else this[_0x1b033a(0x13b)]['syncBranchId']&&(this[_0x1b033a(0xfc)]=await this[_0x1b033a(0xf9)][_0x1b033a(0xe1)](this['commitData']['syncBranchId']));}catch(_0x7415b2){throw new bad_request_error_1[(_0x1b033a(0x118))](errors_1[_0x1b033a(0x114)]);}}async[a126_0x8fd520(0x14b)](){const _0x585783=a126_0x8fd520;if(!this['commitData'][_0x585783(0xec)])return[];await this[_0x585783(0xfb)][_0x585783(0x101)](constants_1[_0x585783(0x130)],this['commitData']['commitAttachmentId'],{'Name':(0x0,shortid_1[_0x585783(0x145)])()});const _0x4a2a5d=await this['salesforceService'][_0x585783(0x146)](this[_0x585783(0x13b)]['commitAttachmentId'])[_0x585783(0x10a)](_0x2ced60=>_0x2ced60[_0x585783(0xe5)]('\x20')[_0x585783(0x12d)](_0x4ecd64=>_0x4ecd64[_0x585783(0x13d)]()));await this[_0x585783(0xfb)]['deleteAttachment'](this[_0x585783(0x13b)][_0x585783(0xec)]);const _0x439a9e=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x585783(0xfb)]);return await _0x439a9e[_0x585783(0xf1)](_0x4a2a5d);}async[a126_0x8fd520(0x121)](){const _0x1a6797=a126_0x8fd520;if(!this[_0x1a6797(0x13b)][_0x1a6797(0x131)])return[];await this['salesforceService'][_0x1a6797(0x101)](constants_1[_0x1a6797(0x130)],this[_0x1a6797(0x13b)][_0x1a6797(0x131)],{'Name':(0x0,shortid_1['default'])()});const _0x2dd86c=await this[_0x1a6797(0xfb)][_0x1a6797(0x146)](this[_0x1a6797(0x13b)][_0x1a6797(0x131)]),_0x323dca=JSON[_0x1a6797(0x12e)](_0x2dd86c);return await this[_0x1a6797(0xfb)][_0x1a6797(0x148)](this['commitData'][_0x1a6797(0x131)]),_0x323dca;}async['getCommitDto'](){const _0x4c5559=a126_0x8fd520,_0x2632a4=new commit_components_dto_1[(_0x4c5559(0x13c))](),[_0xc8101b,_0x293bfb]=await Promise[_0x4c5559(0x110)]([this[_0x4c5559(0x14b)](),this[_0x4c5559(0x121)]()]);return _0x2632a4[_0x4c5559(0x100)]=this[_0x4c5559(0x13b)][_0x4c5559(0x100)],_0x2632a4[_0x4c5559(0x141)]=this[_0x4c5559(0x13b)][_0x4c5559(0x141)],_0x2632a4['components']={'writed':_0xc8101b,'deleted':_0x293bfb},_0x2632a4['convertToSFDX']=this[_0x4c5559(0x116)][_0x4c5559(0x153)],_0x2632a4[_0x4c5559(0xe7)]=this[_0x4c5559(0xe6)],_0x2632a4[_0x4c5559(0xf6)]=this[_0x4c5559(0xf6)],_0x2632a4[_0x4c5559(0x124)]=this['config'][_0x4c5559(0xdf)],_0x2632a4[_0x4c5559(0xfd)]=this[_0x4c5559(0xfc)][_0x4c5559(0x109)],_0x2632a4;}async[a126_0x8fd520(0x134)](_0x2730f4=![]){const _0x5a135c=a126_0x8fd520;if(_0x2730f4)await this[_0x5a135c(0xf9)]['updateRemoteState'](this[_0x5a135c(0xfc)],{});else{const _0x490ca0=await this[_0x5a135c(0xe6)]['branches']['getOne'](this['branch'][_0x5a135c(0x10d)]);this[_0x5a135c(0xf0)]['log'](this[_0x5a135c(0xfa)]+_0x5a135c(0x119));const _0x2f9aac={[this['repository']['gitUrl']]:{'lastCommit':_0x490ca0[_0x5a135c(0x139)]}};await this['salesforceSync']['updateRemoteState'](this[_0x5a135c(0xfc)],_0x2f9aac);}}async['exec'](){const _0x2b0f28=a126_0x8fd520,_0x359629=await this[_0x2b0f28(0x112)]();await this[_0x2b0f28(0xf9)][_0x2b0f28(0xdd)](this[_0x2b0f28(0xfc)],_0x2b0f28(0x127)),await this[_0x2b0f28(0xf7)][_0x2b0f28(0xf1)](_0x359629,this[_0x2b0f28(0xfa)]),await this[_0x2b0f28(0x134)](),await this['salesforceSync'][_0x2b0f28(0xdd)](this['repositoryData'],_0x2b0f28(0x111));}async[a126_0x8fd520(0x135)](_0x3b8ddc){const _0x4bc8b1=a126_0x8fd520;try{this[_0x4bc8b1(0xf0)]['error'](''+_0x3b8ddc),await this['sfLogger']['send'](),await this[_0x4bc8b1(0x134)](!![]),await this['salesforceSync']['setStatus'](this[_0x4bc8b1(0xfc)],_0x4bc8b1(0x10c)),await this[_0x4bc8b1(0x150)]([this[_0x4bc8b1(0x13b)][_0x4bc8b1(0x141)][_0x4bc8b1(0xde)]],this[_0x4bc8b1(0x116)][_0x4bc8b1(0xdf)],this[_0x4bc8b1(0xe6)][_0x4bc8b1(0x10d)],this[_0x4bc8b1(0xf6)][_0x4bc8b1(0x10d)]);}catch(_0x29fd73){this['logger'][_0x4bc8b1(0x14d)](_0x29fd73),await this[_0x4bc8b1(0x151)]([this['commitData']['user']['email']],this[_0x4bc8b1(0x116)][_0x4bc8b1(0xdf)],this[_0x4bc8b1(0xe6)]['name'],this[_0x4bc8b1(0xf6)][_0x4bc8b1(0x10d)]);}}async[a126_0x8fd520(0xf1)](_0x300de9){const _0x1f3a7d=a126_0x8fd520;try{this[_0x1f3a7d(0x13b)]=_0x300de9,this[_0x1f3a7d(0x10b)]=typedi_1[_0x1f3a7d(0xef)]['get'](providers_tokens_1['Tokens']['gitApiService']),this[_0x1f3a7d(0x126)]=typedi_1[_0x1f3a7d(0xef)]['get'](providers_tokens_1[_0x1f3a7d(0x106)][_0x1f3a7d(0x132)]),this[_0x1f3a7d(0x116)]=typedi_1[_0x1f3a7d(0xef)]['get'](providers_tokens_1[_0x1f3a7d(0x106)][_0x1f3a7d(0x116)]),await this[_0x1f3a7d(0xf8)](),this[_0x1f3a7d(0xe6)]=await this['repoService'][_0x1f3a7d(0x105)](this['repositoryData'][_0x1f3a7d(0x104)]),this[_0x1f3a7d(0xf6)]=await this['repository'][_0x1f3a7d(0x137)][_0x1f3a7d(0x105)](this[_0x1f3a7d(0xfc)][_0x1f3a7d(0xeb)]),this[_0x1f3a7d(0xf0)]=typedi_1['Container']['get'](providers_tokens_1[_0x1f3a7d(0x106)]['logger']),this[_0x1f3a7d(0xfa)]=_0x1f3a7d(0x123)+this[_0x1f3a7d(0x116)][_0x1f3a7d(0xdf)][_0x1f3a7d(0x11c)]()+_0x1f3a7d(0x142)+this[_0x1f3a7d(0xfc)]['repositoryName']+_0x1f3a7d(0x11e)+this['repositoryData'][_0x1f3a7d(0xeb)]+_0x1f3a7d(0x12a)+FlosumCommitJob_1[_0x1f3a7d(0x10d)]+']';if(!this[_0x1f3a7d(0xfc)])throw new bad_request_error_1[(_0x1f3a7d(0x118))](errors_1[_0x1f3a7d(0x129)]);await this[_0x1f3a7d(0xf0)][_0x1f3a7d(0xf5)](this[_0x1f3a7d(0xfa)]+_0x1f3a7d(0x11b))[_0x1f3a7d(0xfe)](),await this['exec']()[_0x1f3a7d(0x140)](_0x4081fe=>this[_0x1f3a7d(0x135)](_0x4081fe)),await this[_0x1f3a7d(0x150)]([this[_0x1f3a7d(0x13b)][_0x1f3a7d(0x141)][_0x1f3a7d(0xde)]],this[_0x1f3a7d(0x116)][_0x1f3a7d(0xdf)],this[_0x1f3a7d(0xe6)][_0x1f3a7d(0x10d)],this[_0x1f3a7d(0xf6)]['name']);}catch(_0x2aa5cc){this[_0x1f3a7d(0x13b)]=undefined,this[_0x1f3a7d(0xf2)]['error'](_0x2aa5cc),await this['errorNotification']([this[_0x1f3a7d(0x13b)]['user'][_0x1f3a7d(0xde)]],this[_0x1f3a7d(0x116)][_0x1f3a7d(0xdf)],this[_0x1f3a7d(0xe6)][_0x1f3a7d(0x10d)],this[_0x1f3a7d(0xf6)][_0x1f3a7d(0x10d)]);throw _0x2aa5cc;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a126_0x8fd520(0x149)])({'transient':!![]}),__metadata(a126_0x8fd520(0x133),[salesforce_service_1[a126_0x8fd520(0x122)],commit_components_job_1[a126_0x8fd520(0x102)],salesforce_sync_service_1['SalesforceSyncService']])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;