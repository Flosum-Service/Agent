const a61_0x52efc0=a61_0x3d70;(function(_0x3c9c75,_0x304cd0){const _0x169e22=a61_0x3d70,_0x396e78=_0x3c9c75();while(!![]){try{const _0xfeebf8=parseInt(_0x169e22(0x19e))/0x1*(-parseInt(_0x169e22(0x1a1))/0x2)+-parseInt(_0x169e22(0x1fc))/0x3*(-parseInt(_0x169e22(0x1a6))/0x4)+-parseInt(_0x169e22(0x200))/0x5*(parseInt(_0x169e22(0x1e1))/0x6)+-parseInt(_0x169e22(0x203))/0x7*(parseInt(_0x169e22(0x1fe))/0x8)+parseInt(_0x169e22(0x1e6))/0x9+parseInt(_0x169e22(0x1f1))/0xa*(parseInt(_0x169e22(0x1b0))/0xb)+parseInt(_0x169e22(0x1bd))/0xc*(parseInt(_0x169e22(0x1d3))/0xd);if(_0xfeebf8===_0x304cd0)break;else _0x396e78['push'](_0x396e78['shift']());}catch(_0x40bf0b){_0x396e78['push'](_0x396e78['shift']());}}}(a61_0x133e,0x452d9));const a61_0x4ed2a6=(function(){let _0x255cd7=!![];return function(_0x4822ea,_0x4e655c){const _0x821880=_0x255cd7?function(){const _0x1458a0=a61_0x3d70;if(_0x4e655c){const _0x521c11=_0x4e655c[_0x1458a0(0x1ec)](_0x4822ea,arguments);return _0x4e655c=null,_0x521c11;}}:function(){};return _0x255cd7=![],_0x821880;};}()),a61_0x37ed5b=a61_0x4ed2a6(this,function(){const _0x5838b8=a61_0x3d70;return a61_0x37ed5b[_0x5838b8(0x19c)]()[_0x5838b8(0x1dc)]('(((.+)+)+)+$')[_0x5838b8(0x19c)]()['constructor'](a61_0x37ed5b)['search'](_0x5838b8(0x1a0));});a61_0x37ed5b();'use strict';function a61_0x133e(){const _0x337ac1=['45WcoNyI','../../../../constants','__importDefault','50442cOvvKz','Completed','../../providers/providers.tokens','../../../../core/errors/bad-request.error','branch','length','toString','default','124WEkzOV','fetchRepositoryData','(((.+)+)+)+$','4700uCluxq','CommitComponentsJob','log','sfLogger','trim','4876heWdje','FlosumCommitJob','split','ERR_UNKNOWN_SYNC_RECORD_ID','gitRepoService','../../salesforce/services/salesforce.service','getBranchRecord','commitData','gitApiService','Logger','5827580ukAbkZ','SalesforceService','BadRequestError','metadata','catch','salesforceService',']\x20[Repository:\x20','shortid','typedi','commitJob','SalesforceSyncService','../../../../constants/errors','deleteAttachmentId','12ZRCpOO','\x20Start\x20Flosum\x20commit\x20job.','[FLOSUM\x20->\x20GIT]\x20[','gitProvider','design:paramtypes','repository','CommitComponentsDto','getComponentsToWrite','repo','repositoryData','get',']\x20[Branch:\x20','In\x20Progress','\x20Update\x20remote\x20state.','salesforceSync','FLOSUM_ATTACHMENT','__esModule','syncRepositoryId','setStatus','SalesforceRetrieverService','branches','handleCommitJobError','5446038YwGTqw','repositoryName','branchName','retrieveAttachment','Service','getRepositoryRecord','updateLastCommit','object','convertToSFDX','search','syncBranchId','prefix','logger','decorate','249654aKlPYl','error','gitUrl','repoService','name','2158407SyufGu','run','updateRemoteState','then','provider','getOne','apply','commitAttachmentId','getComponentsToDelete','function','defineProperty','10UUBihJ','patchObject',']\x20[','user','Tokens','../../salesforce/services/salesforce-retriever.service','send','Container','message','config','all','351UzLXNf','components','424KWyENJ','deleteAttachment'];a61_0x133e=function(){return _0x337ac1;};return a61_0x133e();}var __decorate=this&&this['__decorate']||function(_0x1b3a79,_0x28f2cb,_0x4956f3,_0x463e3c){const _0x1f18ee=a61_0x3d70;var _0x176ce2=arguments[_0x1f18ee(0x19b)],_0x397b76=_0x176ce2<0x3?_0x28f2cb:_0x463e3c===null?_0x463e3c=Object['getOwnPropertyDescriptor'](_0x28f2cb,_0x4956f3):_0x463e3c,_0xa91ee9;if(typeof Reflect===_0x1f18ee(0x1da)&&typeof Reflect['decorate']===_0x1f18ee(0x1ef))_0x397b76=Reflect[_0x1f18ee(0x1e0)](_0x1b3a79,_0x28f2cb,_0x4956f3,_0x463e3c);else{for(var _0x221a11=_0x1b3a79[_0x1f18ee(0x19b)]-0x1;_0x221a11>=0x0;_0x221a11--)if(_0xa91ee9=_0x1b3a79[_0x221a11])_0x397b76=(_0x176ce2<0x3?_0xa91ee9(_0x397b76):_0x176ce2>0x3?_0xa91ee9(_0x28f2cb,_0x4956f3,_0x397b76):_0xa91ee9(_0x28f2cb,_0x4956f3))||_0x397b76;}return _0x176ce2>0x3&&_0x397b76&&Object[_0x1f18ee(0x1f0)](_0x28f2cb,_0x4956f3,_0x397b76),_0x397b76;},__metadata=this&&this['__metadata']||function(_0x391094,_0x41e7d3){const _0x166c59=a61_0x3d70;if(typeof Reflect===_0x166c59(0x1da)&&typeof Reflect['metadata']===_0x166c59(0x1ef))return Reflect[_0x166c59(0x1b3)](_0x391094,_0x41e7d3);},__importDefault=this&&this[a61_0x52efc0(0x202)]||function(_0x267649){const _0x396367=a61_0x52efc0;return _0x267649&&_0x267649[_0x396367(0x1cd)]?_0x267649:{'default':_0x267649};},FlosumCommitJob_1;Object[a61_0x52efc0(0x1f0)](exports,a61_0x52efc0(0x1cd),{'value':!![]}),exports[a61_0x52efc0(0x1a7)]=void 0x0;const core_1=require('../../../../core'),salesforce_service_1=require(a61_0x52efc0(0x1ab)),typedi_1=require(a61_0x52efc0(0x1b8)),errors_1=require(a61_0x52efc0(0x1bb)),bad_request_error_1=require(a61_0x52efc0(0x199)),salesforce_retriever_service_1=require(a61_0x52efc0(0x1f6)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job'),constants_1=require(a61_0x52efc0(0x201)),shortid_1=__importDefault(require(a61_0x52efc0(0x1b7))),providers_tokens_1=require(a61_0x52efc0(0x198));function a61_0x3d70(_0x189920,_0x51a77b){const _0x12a24c=a61_0x133e();return a61_0x3d70=function(_0x37ed5b,_0x4ed2a6){_0x37ed5b=_0x37ed5b-0x198;let _0x133e1d=_0x12a24c[_0x37ed5b];return _0x133e1d;},a61_0x3d70(_0x189920,_0x51a77b);}let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x4bc92b,_0x59e5fc,_0x85fadc){const _0x229671=a61_0x52efc0;this[_0x229671(0x1b5)]=_0x4bc92b,this['commitJob']=_0x59e5fc,this[_0x229671(0x1cb)]=_0x85fadc,this['logger']=new core_1[(_0x229671(0x1af))](FlosumCommitJob_1[_0x229671(0x1e5)]);}async[a61_0x52efc0(0x19f)](){const _0x3fc23b=a61_0x52efc0;try{if(this[_0x3fc23b(0x1ad)][_0x3fc23b(0x1ce)])this[_0x3fc23b(0x1c6)]=await this['salesforceSync'][_0x3fc23b(0x1d8)](this[_0x3fc23b(0x1ad)][_0x3fc23b(0x1ce)]);else this[_0x3fc23b(0x1ad)]['syncBranchId']&&(this['repositoryData']=await this[_0x3fc23b(0x1cb)][_0x3fc23b(0x1ac)](this[_0x3fc23b(0x1ad)][_0x3fc23b(0x1dd)]));}catch(_0x58382c){throw new bad_request_error_1['BadRequestError'](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async[a61_0x52efc0(0x1c4)](){const _0x4b8e3c=a61_0x52efc0;if(!this[_0x4b8e3c(0x1ad)][_0x4b8e3c(0x1ed)])return[];await this[_0x4b8e3c(0x1b5)][_0x4b8e3c(0x1f2)](constants_1[_0x4b8e3c(0x1cc)],this[_0x4b8e3c(0x1ad)][_0x4b8e3c(0x1ed)],{'Name':shortid_1[_0x4b8e3c(0x19d)]()});const _0x43607e=await this[_0x4b8e3c(0x1b5)][_0x4b8e3c(0x1d6)](this[_0x4b8e3c(0x1ad)][_0x4b8e3c(0x1ed)])[_0x4b8e3c(0x1e9)](_0x272584=>_0x272584[_0x4b8e3c(0x1a8)]('\x20')['map'](_0x3c4f45=>_0x3c4f45[_0x4b8e3c(0x1a5)]()));await this[_0x4b8e3c(0x1b5)][_0x4b8e3c(0x1ff)](this[_0x4b8e3c(0x1ad)][_0x4b8e3c(0x1ed)]);const _0x447c94=new salesforce_retriever_service_1[(_0x4b8e3c(0x1d0))](this[_0x4b8e3c(0x1b5)]);return await _0x447c94[_0x4b8e3c(0x1e7)](_0x43607e);}async['getComponentsToDelete'](){const _0x46ad0f=a61_0x52efc0;if(!this[_0x46ad0f(0x1ad)]['deleteAttachmentId'])return[];await this[_0x46ad0f(0x1b5)]['patchObject'](constants_1[_0x46ad0f(0x1cc)],this[_0x46ad0f(0x1ad)]['deleteAttachmentId'],{'Name':shortid_1[_0x46ad0f(0x19d)]()});const _0x3e1ee8=await this[_0x46ad0f(0x1b5)][_0x46ad0f(0x1d6)](this[_0x46ad0f(0x1ad)][_0x46ad0f(0x1bc)]);return await this[_0x46ad0f(0x1b5)]['deleteAttachment'](this[_0x46ad0f(0x1ad)][_0x46ad0f(0x1bc)]),_0x3e1ee8;}async['getCommitDto'](){const _0x3609b0=a61_0x52efc0,_0x301ac5=new commit_components_dto_1[(_0x3609b0(0x1c3))](),[_0x55d0ac,_0x1dc6dc]=await Promise[_0x3609b0(0x1fb)]([this[_0x3609b0(0x1c4)](),this[_0x3609b0(0x1ee)]()]);return _0x301ac5[_0x3609b0(0x1f9)]=this[_0x3609b0(0x1ad)]['message'],_0x301ac5[_0x3609b0(0x1f4)]=this[_0x3609b0(0x1ad)][_0x3609b0(0x1f4)],_0x301ac5[_0x3609b0(0x1fd)]={'writed':_0x55d0ac,'deleted':_0x1dc6dc},_0x301ac5[_0x3609b0(0x1db)]=this[_0x3609b0(0x1fa)]['isConvertToSfdx'],_0x301ac5[_0x3609b0(0x1c5)]=this['repository'],_0x301ac5[_0x3609b0(0x19a)]=this[_0x3609b0(0x19a)],_0x301ac5[_0x3609b0(0x1ea)]=this[_0x3609b0(0x1fa)][_0x3609b0(0x1c0)],_0x301ac5;}async['updateLastCommit'](_0x4e18ef=![]){const _0x2d01e4=a61_0x52efc0;if(_0x4e18ef)await this['salesforceSync'][_0x2d01e4(0x1e8)](this[_0x2d01e4(0x1c6)],{});else{const _0x4c41cf=await this['repository'][_0x2d01e4(0x1d1)][_0x2d01e4(0x1eb)](this[_0x2d01e4(0x19a)][_0x2d01e4(0x1e5)]);this[_0x2d01e4(0x1a4)][_0x2d01e4(0x1a3)](this['prefix']+_0x2d01e4(0x1ca));const _0x41d7c1={[this[_0x2d01e4(0x1c2)][_0x2d01e4(0x1e3)]]:{'lastCommit':_0x4c41cf['sha']}};await this[_0x2d01e4(0x1cb)][_0x2d01e4(0x1e8)](this[_0x2d01e4(0x1c6)],_0x41d7c1);}}async['exec'](){const _0x52b185=a61_0x52efc0,_0xbbadb8=await this['getCommitDto']();await this[_0x52b185(0x1cb)][_0x52b185(0x1cf)](this[_0x52b185(0x1c6)],_0x52b185(0x1c9)),await this[_0x52b185(0x1b9)][_0x52b185(0x1e7)](_0xbbadb8,this[_0x52b185(0x1de)]),await this['updateLastCommit'](),await this[_0x52b185(0x1cb)][_0x52b185(0x1cf)](this[_0x52b185(0x1c6)],_0x52b185(0x204));}async[a61_0x52efc0(0x1d2)](_0x3526ad){const _0x11bf6b=a61_0x52efc0;try{this[_0x11bf6b(0x1a4)][_0x11bf6b(0x1e2)](''+_0x3526ad),await this[_0x11bf6b(0x1a4)][_0x11bf6b(0x1f7)](),await this[_0x11bf6b(0x1d9)](!![]),await this[_0x11bf6b(0x1cb)][_0x11bf6b(0x1cf)](this['repositoryData'],'Error');}catch(_0x5615a8){this[_0x11bf6b(0x1df)][_0x11bf6b(0x1e2)](_0x5615a8);}}async[a61_0x52efc0(0x1e7)](_0x2ea857){const _0x2d6674=a61_0x52efc0;try{this[_0x2d6674(0x1ad)]=_0x2ea857,this[_0x2d6674(0x1ae)]=typedi_1[_0x2d6674(0x1f8)][_0x2d6674(0x1c7)](providers_tokens_1[_0x2d6674(0x1f5)]['gitApiService']),this[_0x2d6674(0x1e4)]=typedi_1[_0x2d6674(0x1f8)][_0x2d6674(0x1c7)](providers_tokens_1[_0x2d6674(0x1f5)][_0x2d6674(0x1aa)]),this[_0x2d6674(0x1fa)]=typedi_1[_0x2d6674(0x1f8)][_0x2d6674(0x1c7)](providers_tokens_1['Tokens'][_0x2d6674(0x1fa)]),await this[_0x2d6674(0x19f)](),this[_0x2d6674(0x1c2)]=await this[_0x2d6674(0x1e4)][_0x2d6674(0x1eb)](this[_0x2d6674(0x1c6)][_0x2d6674(0x1d4)]),this['branch']=await this[_0x2d6674(0x1c2)][_0x2d6674(0x1d1)][_0x2d6674(0x1eb)](this[_0x2d6674(0x1c6)][_0x2d6674(0x1d5)]),this[_0x2d6674(0x1a4)]=typedi_1[_0x2d6674(0x1f8)][_0x2d6674(0x1c7)](providers_tokens_1[_0x2d6674(0x1f5)]['logger']),this[_0x2d6674(0x1de)]=_0x2d6674(0x1bf)+this['config']['gitProvider']['toUpperCase']()+_0x2d6674(0x1b6)+this['repositoryData'][_0x2d6674(0x1d4)]+_0x2d6674(0x1c8)+this[_0x2d6674(0x1c6)]['branchName']+_0x2d6674(0x1f3)+FlosumCommitJob_1[_0x2d6674(0x1e5)]+']';if(!this[_0x2d6674(0x1c6)])throw new bad_request_error_1[(_0x2d6674(0x1b2))](errors_1[_0x2d6674(0x1a9)]);await this[_0x2d6674(0x1a4)][_0x2d6674(0x1a3)](this['prefix']+_0x2d6674(0x1be))[_0x2d6674(0x1f7)](),await this['exec']()[_0x2d6674(0x1b4)](_0x381ec2=>this[_0x2d6674(0x1d2)](_0x381ec2));}catch(_0xc4306){this[_0x2d6674(0x1ad)]=undefined,this['logger'][_0x2d6674(0x1e2)](_0xc4306);throw _0xc4306;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a61_0x52efc0(0x1d7)]({'transient':!![]}),__metadata(a61_0x52efc0(0x1c1),[salesforce_service_1[a61_0x52efc0(0x1b1)],commit_components_job_1[a61_0x52efc0(0x1a2)],salesforce_sync_service_1[a61_0x52efc0(0x1ba)]])],FlosumCommitJob),exports[a61_0x52efc0(0x1a7)]=FlosumCommitJob;