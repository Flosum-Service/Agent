function a61_0x1e7c(_0x5a834b,_0x32891d){const _0x337e43=a61_0x259e();return a61_0x1e7c=function(_0x2ab645,_0x2432ba){_0x2ab645=_0x2ab645-0x102;let _0x259e12=_0x337e43[_0x2ab645];return _0x259e12;},a61_0x1e7c(_0x5a834b,_0x32891d);}const a61_0x1cd0fa=a61_0x1e7c;(function(_0x305c6a,_0x5d8d94){const _0x54f1e2=a61_0x1e7c,_0x232b66=_0x305c6a();while(!![]){try{const _0x3b0bd4=parseInt(_0x54f1e2(0x143))/0x1*(-parseInt(_0x54f1e2(0x129))/0x2)+-parseInt(_0x54f1e2(0x103))/0x3*(parseInt(_0x54f1e2(0x135))/0x4)+parseInt(_0x54f1e2(0x108))/0x5*(parseInt(_0x54f1e2(0x134))/0x6)+parseInt(_0x54f1e2(0x157))/0x7+parseInt(_0x54f1e2(0x130))/0x8*(-parseInt(_0x54f1e2(0x140))/0x9)+parseInt(_0x54f1e2(0x110))/0xa+parseInt(_0x54f1e2(0x12f))/0xb*(-parseInt(_0x54f1e2(0x168))/0xc);if(_0x3b0bd4===_0x5d8d94)break;else _0x232b66['push'](_0x232b66['shift']());}catch(_0x23d51c){_0x232b66['push'](_0x232b66['shift']());}}}(a61_0x259e,0x4b7c8));const a61_0x2432ba=(function(){let _0x18db27=!![];return function(_0x381d60,_0x360ff0){const _0x25facf=_0x18db27?function(){const _0x1cdd93=a61_0x1e7c;if(_0x360ff0){const _0x560c1b=_0x360ff0[_0x1cdd93(0x109)](_0x381d60,arguments);return _0x360ff0=null,_0x560c1b;}}:function(){};return _0x18db27=![],_0x25facf;};}()),a61_0x2ab645=a61_0x2432ba(this,function(){const _0x1c0e02=a61_0x1e7c;return a61_0x2ab645[_0x1c0e02(0x146)]()[_0x1c0e02(0x15e)](_0x1c0e02(0x114))[_0x1c0e02(0x146)]()['constructor'](a61_0x2ab645)[_0x1c0e02(0x15e)]('(((.+)+)+)+$');});a61_0x2ab645();'use strict';var __decorate=this&&this[a61_0x1cd0fa(0x145)]||function(_0x8740de,_0x3e172f,_0x586848,_0x177db2){const _0x3aa735=a61_0x1cd0fa;var _0x4249a8=arguments[_0x3aa735(0x14a)],_0x4ae2ea=_0x4249a8<0x3?_0x3e172f:_0x177db2===null?_0x177db2=Object['getOwnPropertyDescriptor'](_0x3e172f,_0x586848):_0x177db2,_0x17234a;if(typeof Reflect===_0x3aa735(0x154)&&typeof Reflect[_0x3aa735(0x10e)]==='function')_0x4ae2ea=Reflect[_0x3aa735(0x10e)](_0x8740de,_0x3e172f,_0x586848,_0x177db2);else{for(var _0x3a69bb=_0x8740de[_0x3aa735(0x14a)]-0x1;_0x3a69bb>=0x0;_0x3a69bb--)if(_0x17234a=_0x8740de[_0x3a69bb])_0x4ae2ea=(_0x4249a8<0x3?_0x17234a(_0x4ae2ea):_0x4249a8>0x3?_0x17234a(_0x3e172f,_0x586848,_0x4ae2ea):_0x17234a(_0x3e172f,_0x586848))||_0x4ae2ea;}return _0x4249a8>0x3&&_0x4ae2ea&&Object['defineProperty'](_0x3e172f,_0x586848,_0x4ae2ea),_0x4ae2ea;},__metadata=this&&this[a61_0x1cd0fa(0x15b)]||function(_0x3ad4d0,_0x15e09e){const _0x226545=a61_0x1cd0fa;if(typeof Reflect==='object'&&typeof Reflect[_0x226545(0x126)]===_0x226545(0x12e))return Reflect[_0x226545(0x126)](_0x3ad4d0,_0x15e09e);},__importDefault=this&&this[a61_0x1cd0fa(0x10c)]||function(_0x1c41fc){const _0x4ac7ec=a61_0x1cd0fa;return _0x1c41fc&&_0x1c41fc[_0x4ac7ec(0x162)]?_0x1c41fc:{'default':_0x1c41fc};},FlosumCommitJob_1;Object['defineProperty'](exports,a61_0x1cd0fa(0x162),{'value':!![]}),exports[a61_0x1cd0fa(0x13c)]=void 0x0;function a61_0x259e(){const _0x246726=['commitAttachmentId','sfLogger','name','getOne','salesforceSync','BadRequestError','../../../../constants','get','sha','provider','../../../../core','metadata','providersFactory','createFromContext','30MXAqCB','split','../../salesforce/services/salesforce.service','exec','FLOSUM_ATTACHMENT','function','22sbeVyw','2761648JkpZXX','../../providers/providers.tokens','getRepositoryRecord','../../salesforce/services/salesforce-sync.service','6APlgsP','3692tYENOn','CommitComponentsDto','commitJob','ProvidersFactory','setStatus','../../providers/repositories/repository.factory','SalesforceRetrieverService','FlosumCommitJob','CommitComponentsJob','message','repoService','9KACGai','logger','../../../../core/errors/bad-request.error','38581lbkjpx','salesforceService','__decorate','toString','shortid','[FLOSUM\x20->\x20GIT]\x20[','repositoryName','length','In\x20Progress','Tokens',']\x20[','Error','then','getComponentsToWrite','trim','SalesforceService','prefix','object','createFromConnection','handleCommitJobError','2499798dqlpEr','../../../../constants/errors','repositoryData','syncBranchId','__metadata','ERR_INVALID_SYNC_RECORD_ID','Completed','search','getCommitDto','getBranchRecord',']\x20[Branch:\x20','__esModule',']\x20[Repository:\x20','branchName','repository','\x20Update\x20remote\x20state.','gitApiService','845964fRNbyK','gitUrl','error','default','Container','retrieveAttachment','run','all','getComponentsToDelete','../utils/connection','gitProvider','syncRepositoryId','6MuQSOY','updateLastCommit','deleteAttachmentId','catch','Service','2737640KvtdXZ','apply','repo','updateRemoteState','__importDefault','convertToSFDX','decorate','branch','4713110hCRhwd','typedi','components','config','(((.+)+)+)+$','fetchRepositoryData','send','branches','design:paramtypes','SalesforceSyncService','commitData'];a61_0x259e=function(){return _0x246726;};return a61_0x259e();}const core_1=require(a61_0x1cd0fa(0x125)),salesforce_service_1=require(a61_0x1cd0fa(0x12b)),typedi_1=require(a61_0x1cd0fa(0x111)),errors_1=require(a61_0x1cd0fa(0x158)),bad_request_error_1=require(a61_0x1cd0fa(0x142)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a61_0x1cd0fa(0x133)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job'),constants_1=require(a61_0x1cd0fa(0x121)),shortid_1=__importDefault(require(a61_0x1cd0fa(0x147))),providers_tokens_1=require(a61_0x1cd0fa(0x131)),repository_factory_1=require(a61_0x1cd0fa(0x13a)),connection_1=require(a61_0x1cd0fa(0x171));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x3aa5b9,_0x53ba33,_0x4ad602,_0x417e3a){const _0x2a38d0=a61_0x1cd0fa;this['salesforceService']=_0x3aa5b9,this['commitJob']=_0x53ba33,this[_0x2a38d0(0x11f)]=_0x4ad602,this['providersFactory']=_0x417e3a,this[_0x2a38d0(0x141)]=new core_1['Logger'](FlosumCommitJob_1['name']);}async[a61_0x1cd0fa(0x115)](){const _0x19e369=a61_0x1cd0fa;try{if(this[_0x19e369(0x11a)]['syncRepositoryId'])this['repositoryData']=await this[_0x19e369(0x11f)][_0x19e369(0x132)](this[_0x19e369(0x11a)][_0x19e369(0x102)]);else this[_0x19e369(0x11a)][_0x19e369(0x15a)]&&(this[_0x19e369(0x159)]=await this[_0x19e369(0x11f)][_0x19e369(0x160)](this[_0x19e369(0x11a)][_0x19e369(0x15a)]));}catch(_0x540d96){throw new bad_request_error_1[(_0x19e369(0x120))](errors_1[_0x19e369(0x15c)]);}}async[a61_0x1cd0fa(0x150)](){const _0x21ab20=a61_0x1cd0fa;if(!this[_0x21ab20(0x11a)][_0x21ab20(0x11b)])return[];await this[_0x21ab20(0x144)]['patchObject'](constants_1[_0x21ab20(0x12d)],this['commitData'][_0x21ab20(0x11b)],{'Name':shortid_1['default']()});const _0x500c76=await this[_0x21ab20(0x144)][_0x21ab20(0x16d)](this[_0x21ab20(0x11a)][_0x21ab20(0x11b)])[_0x21ab20(0x14f)](_0x21472e=>_0x21472e[_0x21ab20(0x12a)]('\x20')['map'](_0x4854b1=>_0x4854b1[_0x21ab20(0x151)]()));await this[_0x21ab20(0x144)]['deleteAttachment'](this['commitData'][_0x21ab20(0x11b)]);const _0x58f06d=new salesforce_retriever_service_1[(_0x21ab20(0x13b))](this[_0x21ab20(0x144)]);return await _0x58f06d['run'](_0x500c76);}async[a61_0x1cd0fa(0x170)](){const _0xda98e0=a61_0x1cd0fa;if(!this[_0xda98e0(0x11a)]['deleteAttachmentId'])return[];await this[_0xda98e0(0x144)]['patchObject'](constants_1[_0xda98e0(0x12d)],this[_0xda98e0(0x11a)][_0xda98e0(0x105)],{'Name':shortid_1[_0xda98e0(0x16b)]()});const _0x4f1037=await this[_0xda98e0(0x144)][_0xda98e0(0x16d)](this['commitData'][_0xda98e0(0x105)]);return await this['salesforceService']['deleteAttachment'](this[_0xda98e0(0x11a)][_0xda98e0(0x105)]),_0x4f1037;}async[a61_0x1cd0fa(0x15f)](){const _0x455e78=a61_0x1cd0fa,_0x384f8d=new commit_components_dto_1[(_0x455e78(0x136))](),[_0x4bf301,_0xec911f]=await Promise[_0x455e78(0x16f)]([this[_0x455e78(0x150)](),this['getComponentsToDelete']()]);return _0x384f8d[_0x455e78(0x13e)]=this[_0x455e78(0x11a)]['message'],_0x384f8d['user']=this['commitData']['user'],_0x384f8d[_0x455e78(0x112)]={'writed':_0x4bf301,'deleted':_0xec911f},_0x384f8d[_0x455e78(0x10d)]=this[_0x455e78(0x113)]['isConvertToSfdx'],_0x384f8d[_0x455e78(0x10a)]=this[_0x455e78(0x165)],_0x384f8d[_0x455e78(0x10f)]=this['branch'],_0x384f8d[_0x455e78(0x124)]=this[_0x455e78(0x113)][_0x455e78(0x172)],_0x384f8d;}async[a61_0x1cd0fa(0x104)](_0x1f8810=![]){const _0x123ab4=a61_0x1cd0fa;if(_0x1f8810)await this[_0x123ab4(0x11f)]['updateRemoteState'](this[_0x123ab4(0x159)],{});else{const _0x3f5489=await this[_0x123ab4(0x165)]['branches'][_0x123ab4(0x11e)](this[_0x123ab4(0x10f)]['name']);this['sfLogger']['log'](this['prefix']+_0x123ab4(0x166));const _0x2b651e={[this[_0x123ab4(0x165)][_0x123ab4(0x169)]]:{'lastCommit':_0x3f5489[_0x123ab4(0x123)]}};await this[_0x123ab4(0x11f)][_0x123ab4(0x10b)](this['repositoryData'],_0x2b651e);}}async[a61_0x1cd0fa(0x12c)](){const _0x26417b=a61_0x1cd0fa,_0x5a94d0=await this[_0x26417b(0x15f)]();await this[_0x26417b(0x11f)][_0x26417b(0x139)](this[_0x26417b(0x159)],_0x26417b(0x14b)),await this[_0x26417b(0x137)][_0x26417b(0x16e)](_0x5a94d0,this[_0x26417b(0x153)]),await this['updateLastCommit'](),await this[_0x26417b(0x11f)][_0x26417b(0x139)](this[_0x26417b(0x159)],_0x26417b(0x15d));}async[a61_0x1cd0fa(0x156)](_0x21f005){const _0x2cd427=a61_0x1cd0fa;try{this[_0x2cd427(0x11c)][_0x2cd427(0x16a)](''+_0x21f005),await this['sfLogger'][_0x2cd427(0x116)](),await this[_0x2cd427(0x104)](!![]),await this[_0x2cd427(0x11f)][_0x2cd427(0x139)](this[_0x2cd427(0x159)],_0x2cd427(0x14e));}catch(_0x457afd){this['logger'][_0x2cd427(0x16a)](_0x457afd);}}async[a61_0x1cd0fa(0x16e)](_0x1c5298,_0x4e9b1f){const _0x2459a4=a61_0x1cd0fa;try{this[_0x2459a4(0x11a)]=_0x1c5298,this[_0x2459a4(0x167)]=await this[_0x2459a4(0x127)][_0x2459a4(0x155)](_0x4e9b1f),this[_0x2459a4(0x13f)]=await repository_factory_1['RepositoryFactory'][_0x2459a4(0x128)](typedi_1[_0x2459a4(0x16c)]),this['config']=typedi_1[_0x2459a4(0x16c)][_0x2459a4(0x122)](providers_tokens_1[_0x2459a4(0x14c)]['config']),await this[_0x2459a4(0x115)](),this[_0x2459a4(0x165)]=await this[_0x2459a4(0x13f)][_0x2459a4(0x11e)](this[_0x2459a4(0x159)]['repositoryName']),this[_0x2459a4(0x10f)]=await this[_0x2459a4(0x165)][_0x2459a4(0x117)][_0x2459a4(0x11e)](this[_0x2459a4(0x159)][_0x2459a4(0x164)]),this[_0x2459a4(0x11c)]=typedi_1[_0x2459a4(0x16c)][_0x2459a4(0x122)](providers_tokens_1[_0x2459a4(0x14c)][_0x2459a4(0x141)]),this[_0x2459a4(0x153)]=_0x2459a4(0x148)+this[_0x2459a4(0x113)][_0x2459a4(0x172)]['toUpperCase']()+_0x2459a4(0x163)+this[_0x2459a4(0x159)][_0x2459a4(0x149)]+_0x2459a4(0x161)+this[_0x2459a4(0x159)][_0x2459a4(0x164)]+_0x2459a4(0x14d)+FlosumCommitJob_1[_0x2459a4(0x11d)]+']';if(!this[_0x2459a4(0x159)])throw new bad_request_error_1[(_0x2459a4(0x120))](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);await this[_0x2459a4(0x11c)]['log'](this[_0x2459a4(0x153)]+'\x20Start\x20Flosum\x20commit\x20job.')[_0x2459a4(0x116)](),await this[_0x2459a4(0x12c)]()[_0x2459a4(0x106)](_0x3a75c1=>this[_0x2459a4(0x156)](_0x3a75c1));}catch(_0xa420b5){this[_0x2459a4(0x11a)]=undefined,this['logger'][_0x2459a4(0x16a)](_0xa420b5);throw _0xa420b5;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a61_0x1cd0fa(0x107)]({'transient':!![]}),__metadata(a61_0x1cd0fa(0x118),[salesforce_service_1[a61_0x1cd0fa(0x152)],commit_components_job_1[a61_0x1cd0fa(0x13d)],salesforce_sync_service_1[a61_0x1cd0fa(0x119)],connection_1[a61_0x1cd0fa(0x138)]])],FlosumCommitJob),exports[a61_0x1cd0fa(0x13c)]=FlosumCommitJob;