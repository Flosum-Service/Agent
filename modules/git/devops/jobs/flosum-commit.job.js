const a105_0x2a5909=a105_0x5931;(function(_0x1884df,_0x2b9048){const _0x2adda1=a105_0x5931,_0x4356fd=_0x1884df();while(!![]){try{const _0x347733=parseInt(_0x2adda1(0x11b))/0x1*(-parseInt(_0x2adda1(0x12c))/0x2)+-parseInt(_0x2adda1(0x17d))/0x3+-parseInt(_0x2adda1(0x142))/0x4*(-parseInt(_0x2adda1(0x139))/0x5)+parseInt(_0x2adda1(0x13e))/0x6+parseInt(_0x2adda1(0x186))/0x7+parseInt(_0x2adda1(0x122))/0x8*(-parseInt(_0x2adda1(0x152))/0x9)+parseInt(_0x2adda1(0x164))/0xa*(parseInt(_0x2adda1(0x157))/0xb);if(_0x347733===_0x2b9048)break;else _0x4356fd['push'](_0x4356fd['shift']());}catch(_0xef8b93){_0x4356fd['push'](_0x4356fd['shift']());}}}(a105_0x57e3,0xeed07));const a105_0x52a547=(function(){let _0x13e93d=!![];return function(_0x1dba52,_0x9765d1){const _0x1efdbe=_0x13e93d?function(){const _0x4f65e5=a105_0x5931;if(_0x9765d1){const _0x281f6e=_0x9765d1[_0x4f65e5(0x173)](_0x1dba52,arguments);return _0x9765d1=null,_0x281f6e;}}:function(){};return _0x13e93d=![],_0x1efdbe;};}()),a105_0x21d8cf=a105_0x52a547(this,function(){const _0x2c61cf=a105_0x5931;return a105_0x21d8cf[_0x2c61cf(0x146)]()[_0x2c61cf(0x120)](_0x2c61cf(0x179))[_0x2c61cf(0x146)]()[_0x2c61cf(0x169)](a105_0x21d8cf)[_0x2c61cf(0x120)](_0x2c61cf(0x179));});a105_0x21d8cf();'use strict';var __decorate=this&&this[a105_0x2a5909(0x171)]||function(_0x28c1b3,_0x33df5b,_0x117e84,_0x926669){const _0x3d6ad0=a105_0x2a5909;var _0x5e854b=arguments[_0x3d6ad0(0x12a)],_0xa26177=_0x5e854b<0x3?_0x33df5b:_0x926669===null?_0x926669=Object[_0x3d6ad0(0x13f)](_0x33df5b,_0x117e84):_0x926669,_0xb4f764;if(typeof Reflect===_0x3d6ad0(0x127)&&typeof Reflect[_0x3d6ad0(0x145)]==='function')_0xa26177=Reflect[_0x3d6ad0(0x145)](_0x28c1b3,_0x33df5b,_0x117e84,_0x926669);else{for(var _0x487fde=_0x28c1b3[_0x3d6ad0(0x12a)]-0x1;_0x487fde>=0x0;_0x487fde--)if(_0xb4f764=_0x28c1b3[_0x487fde])_0xa26177=(_0x5e854b<0x3?_0xb4f764(_0xa26177):_0x5e854b>0x3?_0xb4f764(_0x33df5b,_0x117e84,_0xa26177):_0xb4f764(_0x33df5b,_0x117e84))||_0xa26177;}return _0x5e854b>0x3&&_0xa26177&&Object['defineProperty'](_0x33df5b,_0x117e84,_0xa26177),_0xa26177;},__metadata=this&&this[a105_0x2a5909(0x140)]||function(_0x3ffd6d,_0x6f14ca){const _0x328691=a105_0x2a5909;if(typeof Reflect===_0x328691(0x127)&&typeof Reflect['metadata']==='function')return Reflect[_0x328691(0x162)](_0x3ffd6d,_0x6f14ca);},__importDefault=this&&this[a105_0x2a5909(0x161)]||function(_0x123fdf){const _0x4a9d78=a105_0x2a5909;return _0x123fdf&&_0x123fdf[_0x4a9d78(0x12d)]?_0x123fdf:{'default':_0x123fdf};},FlosumCommitJob_1;Object[a105_0x2a5909(0x11f)](exports,a105_0x2a5909(0x12d),{'value':!![]}),exports[a105_0x2a5909(0x17b)]=void 0x0;function a105_0x57e3(){const _0x3604c0=['../../providers/providers.tokens','../../salesforce/services/salesforce-sync.service','__decorate','Container','apply','sha','repoService','\x20Update\x20remote\x20state.','user','SalesforceRetrieverService','(((.+)+)+)+$','./commit-components.job','FlosumCommitJob','logger','2908005RhKNVm','run','trim',']\x20[','commitData','get','../../../../core','Error','message','4671702AFbdcC','Service','ERR_UNKNOWN_SYNC_RECORD_ID','split','FLOSUM_ATTACHMENT','typedi','5stlzZg','getComponentsToWrite','salesforceService','syncRepositoryId','defineProperty','search','Completed','56EyvDOl','syncBranchId','name','In\x20Progress','repositoryData','object','provider','branches','length','toUpperCase','408790EOGyFq','__esModule','error','commitJob','gitRepoService','components','repository','gitApiService','getComponentsToDelete','commitAttachmentId','retrieveAttachment','BadRequestError','../../../../constants/errors','3295HtIcsE','deleteAttachmentId','prefix','updateRemoteState','SalesforceService','1918074QBPArf','getOwnPropertyDescriptor','__metadata','../dto/commit-components.dto','4348xCvkyE','default','then','decorate','toString','salesforceSync','deleteAttachment','exec','getCommitDto','Tokens','handleCommitJobError','send','patchObject','ERR_INVALID_SYNC_RECORD_ID','CommitComponentsDto','sfLogger','859509vWHGcL',']\x20[Repository:\x20','setStatus','getOne','shortid','10640311iPkwQg','[FLOSUM\x20->\x20GIT]\x20[','repo','\x20Start\x20Flosum\x20commit\x20job.','gitProvider','updateLastCommit','branch','../../../../core/errors/bad-request.error','getBranchRecord','../../salesforce/services/salesforce.service','__importDefault','metadata','SalesforceSyncService','20NzqURu','getRepositoryRecord','config','Logger','repositoryName','constructor','../../salesforce/services/salesforce-retriever.service','map','log','design:paramtypes','../../../../constants'];a105_0x57e3=function(){return _0x3604c0;};return a105_0x57e3();}function a105_0x5931(_0x37baad,_0x173f6f){const _0x17735b=a105_0x57e3();return a105_0x5931=function(_0x21d8cf,_0x52a547){_0x21d8cf=_0x21d8cf-0x116;let _0x57e3a5=_0x17735b[_0x21d8cf];return _0x57e3a5;},a105_0x5931(_0x37baad,_0x173f6f);}const core_1=require(a105_0x2a5909(0x183)),salesforce_service_1=require(a105_0x2a5909(0x160)),typedi_1=require(a105_0x2a5909(0x11a)),errors_1=require(a105_0x2a5909(0x138)),bad_request_error_1=require(a105_0x2a5909(0x15e)),salesforce_retriever_service_1=require(a105_0x2a5909(0x16a)),salesforce_sync_service_1=require(a105_0x2a5909(0x170)),commit_components_dto_1=require(a105_0x2a5909(0x141)),commit_components_job_1=require(a105_0x2a5909(0x17a)),constants_1=require(a105_0x2a5909(0x16e)),shortid_1=__importDefault(require(a105_0x2a5909(0x156))),providers_tokens_1=require(a105_0x2a5909(0x16f));let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x1c1446,_0x5abb59,_0x246456){const _0x2d0b86=a105_0x2a5909;this[_0x2d0b86(0x11d)]=_0x1c1446,this[_0x2d0b86(0x12f)]=_0x5abb59,this[_0x2d0b86(0x147)]=_0x246456,this['logger']=new core_1[(_0x2d0b86(0x167))](FlosumCommitJob_1[_0x2d0b86(0x124)]);}async['fetchRepositoryData'](){const _0x525188=a105_0x2a5909;try{if(this[_0x525188(0x181)][_0x525188(0x11e)])this['repositoryData']=await this[_0x525188(0x147)][_0x525188(0x165)](this['commitData'][_0x525188(0x11e)]);else this[_0x525188(0x181)][_0x525188(0x123)]&&(this[_0x525188(0x126)]=await this[_0x525188(0x147)][_0x525188(0x15f)](this[_0x525188(0x181)][_0x525188(0x123)]));}catch(_0x20b4ab){throw new bad_request_error_1[(_0x525188(0x137))](errors_1[_0x525188(0x14f)]);}}async[a105_0x2a5909(0x11c)](){const _0x13991c=a105_0x2a5909;if(!this[_0x13991c(0x181)][_0x13991c(0x135)])return[];await this[_0x13991c(0x11d)]['patchObject'](constants_1[_0x13991c(0x119)],this[_0x13991c(0x181)][_0x13991c(0x135)],{'Name':(0x0,shortid_1[_0x13991c(0x143)])()});const _0x2abb76=await this['salesforceService'][_0x13991c(0x136)](this['commitData'][_0x13991c(0x135)])[_0x13991c(0x144)](_0x44e5df=>_0x44e5df[_0x13991c(0x118)]('\x20')[_0x13991c(0x16b)](_0x3e53fd=>_0x3e53fd[_0x13991c(0x17f)]()));await this[_0x13991c(0x11d)][_0x13991c(0x148)](this[_0x13991c(0x181)][_0x13991c(0x135)]);const _0x4c0443=new salesforce_retriever_service_1[(_0x13991c(0x178))](this[_0x13991c(0x11d)]);return await _0x4c0443['run'](_0x2abb76);}async['getComponentsToDelete'](){const _0x815ed7=a105_0x2a5909;if(!this['commitData']['deleteAttachmentId'])return[];await this[_0x815ed7(0x11d)][_0x815ed7(0x14e)](constants_1[_0x815ed7(0x119)],this['commitData']['deleteAttachmentId'],{'Name':(0x0,shortid_1['default'])()});const _0x3a27fe=await this[_0x815ed7(0x11d)][_0x815ed7(0x136)](this[_0x815ed7(0x181)][_0x815ed7(0x13a)]);return await this[_0x815ed7(0x11d)][_0x815ed7(0x148)](this[_0x815ed7(0x181)][_0x815ed7(0x13a)]),_0x3a27fe;}async[a105_0x2a5909(0x14a)](){const _0x4af077=a105_0x2a5909,_0x41888a=new commit_components_dto_1[(_0x4af077(0x150))](),[_0x4c865f,_0x372d13]=await Promise['all']([this[_0x4af077(0x11c)](),this[_0x4af077(0x134)]()]);return _0x41888a[_0x4af077(0x185)]=this['commitData'][_0x4af077(0x185)],_0x41888a[_0x4af077(0x177)]=this['commitData'][_0x4af077(0x177)],_0x41888a[_0x4af077(0x131)]={'writed':_0x4c865f,'deleted':_0x372d13},_0x41888a['convertToSFDX']=this[_0x4af077(0x166)]['isConvertToSfdx'],_0x41888a[_0x4af077(0x159)]=this[_0x4af077(0x132)],_0x41888a[_0x4af077(0x15d)]=this[_0x4af077(0x15d)],_0x41888a[_0x4af077(0x128)]=this['config'][_0x4af077(0x15b)],_0x41888a;}async[a105_0x2a5909(0x15c)](_0x4176c0=![]){const _0x577f3d=a105_0x2a5909;if(_0x4176c0)await this[_0x577f3d(0x147)][_0x577f3d(0x13c)](this[_0x577f3d(0x126)],{});else{const _0xed5ee=await this[_0x577f3d(0x132)][_0x577f3d(0x129)][_0x577f3d(0x155)](this[_0x577f3d(0x15d)][_0x577f3d(0x124)]);this[_0x577f3d(0x151)]['log'](this[_0x577f3d(0x13b)]+_0x577f3d(0x176));const _0x2b8bed={[this[_0x577f3d(0x132)]['gitUrl']]:{'lastCommit':_0xed5ee[_0x577f3d(0x174)]}};await this[_0x577f3d(0x147)][_0x577f3d(0x13c)](this[_0x577f3d(0x126)],_0x2b8bed);}}async[a105_0x2a5909(0x149)](){const _0x35dd9d=a105_0x2a5909,_0x2f828b=await this[_0x35dd9d(0x14a)]();await this[_0x35dd9d(0x147)][_0x35dd9d(0x154)](this['repositoryData'],_0x35dd9d(0x125)),await this['commitJob']['run'](_0x2f828b,this[_0x35dd9d(0x13b)]),await this[_0x35dd9d(0x15c)](),await this[_0x35dd9d(0x147)][_0x35dd9d(0x154)](this[_0x35dd9d(0x126)],_0x35dd9d(0x121));}async[a105_0x2a5909(0x14c)](_0x2a22b0){const _0x185d0a=a105_0x2a5909;try{this[_0x185d0a(0x151)][_0x185d0a(0x12e)](''+_0x2a22b0),await this[_0x185d0a(0x151)][_0x185d0a(0x14d)](),await this[_0x185d0a(0x15c)](!![]),await this[_0x185d0a(0x147)][_0x185d0a(0x154)](this['repositoryData'],_0x185d0a(0x184));}catch(_0x5d2668){this['logger'][_0x185d0a(0x12e)](_0x5d2668);}}async[a105_0x2a5909(0x17e)](_0x1cc819){const _0x540d55=a105_0x2a5909;try{this[_0x540d55(0x181)]=_0x1cc819,this[_0x540d55(0x133)]=typedi_1[_0x540d55(0x172)][_0x540d55(0x182)](providers_tokens_1['Tokens'][_0x540d55(0x133)]),this[_0x540d55(0x175)]=typedi_1[_0x540d55(0x172)][_0x540d55(0x182)](providers_tokens_1['Tokens'][_0x540d55(0x130)]),this[_0x540d55(0x166)]=typedi_1[_0x540d55(0x172)]['get'](providers_tokens_1['Tokens'][_0x540d55(0x166)]),await this['fetchRepositoryData'](),this[_0x540d55(0x132)]=await this[_0x540d55(0x175)][_0x540d55(0x155)](this[_0x540d55(0x126)][_0x540d55(0x168)]),this[_0x540d55(0x15d)]=await this[_0x540d55(0x132)]['branches'][_0x540d55(0x155)](this['repositoryData']['branchName']),this[_0x540d55(0x151)]=typedi_1[_0x540d55(0x172)][_0x540d55(0x182)](providers_tokens_1[_0x540d55(0x14b)][_0x540d55(0x17c)]),this[_0x540d55(0x13b)]=_0x540d55(0x158)+this[_0x540d55(0x166)][_0x540d55(0x15b)][_0x540d55(0x12b)]()+_0x540d55(0x153)+this[_0x540d55(0x126)][_0x540d55(0x168)]+']\x20[Branch:\x20'+this[_0x540d55(0x126)]['branchName']+_0x540d55(0x180)+FlosumCommitJob_1[_0x540d55(0x124)]+']';if(!this[_0x540d55(0x126)])throw new bad_request_error_1[(_0x540d55(0x137))](errors_1[_0x540d55(0x117)]);await this[_0x540d55(0x151)][_0x540d55(0x16c)](this[_0x540d55(0x13b)]+_0x540d55(0x15a))[_0x540d55(0x14d)](),await this[_0x540d55(0x149)]()['catch'](_0x2179d8=>this['handleCommitJobError'](_0x2179d8));}catch(_0x1bdd6d){this[_0x540d55(0x181)]=undefined,this[_0x540d55(0x17c)]['error'](_0x1bdd6d);throw _0x1bdd6d;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([(0x0,typedi_1[a105_0x2a5909(0x116)])({'transient':!![]}),__metadata(a105_0x2a5909(0x16d),[salesforce_service_1[a105_0x2a5909(0x13d)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a105_0x2a5909(0x163)]])],FlosumCommitJob),exports[a105_0x2a5909(0x17b)]=FlosumCommitJob;