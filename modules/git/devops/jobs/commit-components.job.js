const a104_0x4d6d1a=a104_0x1922;(function(_0x10fa65,_0x5ca3c7){const _0x1f3a80=a104_0x1922,_0x114a55=_0x10fa65();while(!![]){try{const _0x5a19c9=-parseInt(_0x1f3a80(0x164))/0x1*(parseInt(_0x1f3a80(0x158))/0x2)+-parseInt(_0x1f3a80(0x189))/0x3*(-parseInt(_0x1f3a80(0x1b2))/0x4)+parseInt(_0x1f3a80(0x139))/0x5+-parseInt(_0x1f3a80(0x193))/0x6+parseInt(_0x1f3a80(0x15f))/0x7+-parseInt(_0x1f3a80(0x1ab))/0x8*(parseInt(_0x1f3a80(0x148))/0x9)+parseInt(_0x1f3a80(0x155))/0xa;if(_0x5a19c9===_0x5ca3c7)break;else _0x114a55['push'](_0x114a55['shift']());}catch(_0x29db9a){_0x114a55['push'](_0x114a55['shift']());}}}(a104_0x5851,0x65ee8));const a104_0x453a1b=(function(){let _0x292ea8=!![];return function(_0x5da26c,_0x2bb254){const _0x46ee7c=_0x292ea8?function(){const _0x84f467=a104_0x1922;if(_0x2bb254){const _0x275df8=_0x2bb254[_0x84f467(0x13b)](_0x5da26c,arguments);return _0x2bb254=null,_0x275df8;}}:function(){};return _0x292ea8=![],_0x46ee7c;};}()),a104_0x9b9c97=a104_0x453a1b(this,function(){const _0x41eda8=a104_0x1922;return a104_0x9b9c97['toString']()['search'](_0x41eda8(0x156))[_0x41eda8(0x186)]()[_0x41eda8(0x14a)](a104_0x9b9c97)[_0x41eda8(0x1b3)](_0x41eda8(0x156));});a104_0x9b9c97();'use strict';var __createBinding=this&&this[a104_0x4d6d1a(0x13e)]||(Object[a104_0x4d6d1a(0x14d)]?function(_0xee8309,_0x5967a2,_0x4022a0,_0x2c6984){const _0x3bf079=a104_0x4d6d1a;if(_0x2c6984===undefined)_0x2c6984=_0x4022a0;var _0x2964c4=Object[_0x3bf079(0x157)](_0x5967a2,_0x4022a0);(!_0x2964c4||(_0x3bf079(0x178)in _0x2964c4?!_0x5967a2[_0x3bf079(0x18f)]:_0x2964c4[_0x3bf079(0x143)]||_0x2964c4['configurable']))&&(_0x2964c4={'enumerable':!![],'get':function(){return _0x5967a2[_0x4022a0];}}),Object[_0x3bf079(0x17f)](_0xee8309,_0x2c6984,_0x2964c4);}:function(_0x36bef9,_0xf0a0b6,_0x43d2c0,_0x51d5b4){if(_0x51d5b4===undefined)_0x51d5b4=_0x43d2c0;_0x36bef9[_0x51d5b4]=_0xf0a0b6[_0x43d2c0];}),__setModuleDefault=this&&this[a104_0x4d6d1a(0x1aa)]||(Object['create']?function(_0x77517,_0x12b9f2){const _0x152e20=a104_0x4d6d1a;Object[_0x152e20(0x17f)](_0x77517,_0x152e20(0x183),{'enumerable':!![],'value':_0x12b9f2});}:function(_0x1a58c0,_0xad70de){const _0x50ac39=a104_0x4d6d1a;_0x1a58c0[_0x50ac39(0x183)]=_0xad70de;}),__decorate=this&&this[a104_0x4d6d1a(0x15a)]||function(_0x464899,_0x3268a5,_0x220f71,_0x2016e7){const _0x4a91cb=a104_0x4d6d1a;var _0x40e73b=arguments[_0x4a91cb(0x15d)],_0x54e4da=_0x40e73b<0x3?_0x3268a5:_0x2016e7===null?_0x2016e7=Object['getOwnPropertyDescriptor'](_0x3268a5,_0x220f71):_0x2016e7,_0x4276b3;if(typeof Reflect===_0x4a91cb(0x162)&&typeof Reflect[_0x4a91cb(0x149)]===_0x4a91cb(0x174))_0x54e4da=Reflect['decorate'](_0x464899,_0x3268a5,_0x220f71,_0x2016e7);else{for(var _0x57d6c2=_0x464899[_0x4a91cb(0x15d)]-0x1;_0x57d6c2>=0x0;_0x57d6c2--)if(_0x4276b3=_0x464899[_0x57d6c2])_0x54e4da=(_0x40e73b<0x3?_0x4276b3(_0x54e4da):_0x40e73b>0x3?_0x4276b3(_0x3268a5,_0x220f71,_0x54e4da):_0x4276b3(_0x3268a5,_0x220f71))||_0x54e4da;}return _0x40e73b>0x3&&_0x54e4da&&Object[_0x4a91cb(0x17f)](_0x3268a5,_0x220f71,_0x54e4da),_0x54e4da;},__importStar=this&&this[a104_0x4d6d1a(0x196)]||function(_0x2d9948){const _0x37630a=a104_0x4d6d1a;if(_0x2d9948&&_0x2d9948['__esModule'])return _0x2d9948;var _0x1ba440={};if(_0x2d9948!=null){for(var _0x390ee1 in _0x2d9948)if(_0x390ee1!==_0x37630a(0x183)&&Object[_0x37630a(0x145)][_0x37630a(0x17d)][_0x37630a(0x16d)](_0x2d9948,_0x390ee1))__createBinding(_0x1ba440,_0x2d9948,_0x390ee1);}return __setModuleDefault(_0x1ba440,_0x2d9948),_0x1ba440;},__importDefault=this&&this['__importDefault']||function(_0x31fbb3){const _0x10ddfd=a104_0x4d6d1a;return _0x31fbb3&&_0x31fbb3[_0x10ddfd(0x18f)]?_0x31fbb3:{'default':_0x31fbb3};};Object[a104_0x4d6d1a(0x17f)](exports,a104_0x4d6d1a(0x18f),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a104_0x4d6d1a(0x18c))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a104_0x4d6d1a(0x15e))),child_types_1=__importDefault(require(a104_0x4d6d1a(0x15c))),utils_1=require(a104_0x4d6d1a(0x1a4)),constants_1=require(a104_0x4d6d1a(0x1a8)),git_provider_1=require(a104_0x4d6d1a(0x166)),bitbucket_api_service_1=require(a104_0x4d6d1a(0x17c)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a104_0x4d6d1a(0x140)),path_1=require(a104_0x4d6d1a(0x171)),providers_tokens_1=require(a104_0x4d6d1a(0x1a2)),constants_2=require(a104_0x4d6d1a(0x1a8));function a104_0x1922(_0x53f4f,_0x492c28){const _0x1b4a57=a104_0x5851();return a104_0x1922=function(_0x9b9c97,_0x453a1b){_0x9b9c97=_0x9b9c97-0x139;let _0x5851de=_0x1b4a57[_0x9b9c97];return _0x5851de;},a104_0x1922(_0x53f4f,_0x492c28);}function a104_0x5851(){const _0x5130db=['\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','__decorate','\x20Checking\x20deleted\x20components.','../../parsers/data/child-types','length','typedi','1972530uskeOd','ms.\x20Committed\x20components\x20-\x20','gitUrl','object','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','26AYrNif','log','../../providers/types/git-provider','master','type','CommitComponentsJob','writeComponents','copyMdapiTo','cleanUp','call','\x20Wrote\x20','components','sort','path','DEFAULT_GIT_USER_EMAIL','\x20Start\x20cloning\x20repository.','function','\x20Checking\x20commit\x20components.','prepareMdapi','exec','get','fileName','dir','isLoggedIn','../../providers/api/bitbucket-api.service','hasOwnProperty','MDApiUtils','defineProperty','\x20Preparing\x20to\x20write\x20components','force','COMPONENTS_PER_TICK','default','reduce','CommitComponentsDto','toString','catch','join','207yHiWzv','splice','sfLogger','events','name','removeComponents','__esModule','writed','\x20Preparing\x20to\x20delete\x20components','\x20components','1783398DoTFvf','deleted','send','__importStar','run','error','createProjectFrom','push','componentsToDelete','Bitbucket','commitData','copyProjectTo','provider','SFDXUtils','getGitShellAuthorizationString','../../providers/providers.tokens','removeDir','../../../shared/utils','force-app','credentials','BitbucketApiService','../../../../constants','groupComponentsByFileName','__setModuleDefault','96solcIm','Tokens','clone','copyVlocityComponents','prefix','SFDX','sfdxUtils','21844weSHMe','search','1910325qkkAij','\x20Start\x20converting\x20to\x20SFDX.','apply','gitUtils','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','__createBinding','getProtocol','../../internal/fs.internal','getRemote','GitProvider','writable','branch','prototype','includes','\x20Deleted\x20','520236ijbQQu','decorate','constructor','startTime','\x20Checking\x20written\x20components.','create','commitAndPush','\x20Copying\x20mdapi\x20to\x20git\x20folder.','\x20Nothing\x20to\x20commit.\x20Skip.','replace','componentsToWrite','logger','mdapiUtils','9469830gymrNN','(((.+)+)+)+$','getOwnPropertyDescriptor','44558uJhikp'];a104_0x5851=function(){return _0x5130db;};return a104_0x5851();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x4d6d1a(0x183)]{constructor(){const _0x14c129=a104_0x4d6d1a;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x14c129(0x152)]=0x0,this[_0x14c129(0x19b)]=0x0,this[_0x14c129(0x14b)]=Date['now']();}async[a104_0x4d6d1a(0x141)](){const _0x56907b=a104_0x4d6d1a,{repo:_0x1d1dde}=this[_0x56907b(0x19d)],_0x37c85b=typedi_1[_0x56907b(0x183)]['get'](providers_tokens_1[_0x56907b(0x1ac)][_0x56907b(0x1a6)]);if(this[_0x56907b(0x19d)][_0x56907b(0x19f)]===git_provider_1[_0x56907b(0x142)][_0x56907b(0x19c)]){const _0x570abe=typedi_1['default'][_0x56907b(0x178)](bitbucket_api_service_1[_0x56907b(0x1a7)]);await _0x570abe[_0x56907b(0x17b)]();}return _0x1d1dde[_0x56907b(0x161)][_0x56907b(0x151)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x56907b(0x13f)])(_0x1d1dde['gitUrl'])+'://'+_0x37c85b[_0x56907b(0x1a1)]()+'@');}[a104_0x4d6d1a(0x1a9)](_0x316d7f){const _0x1029a2=a104_0x4d6d1a;var _0x4cd8ff;_0x316d7f[_0x1029a2(0x170)](_0x403d81=>child_types_1[_0x1029a2(0x183)][_0x1029a2(0x146)](_0x403d81['fileType'])?0x1:-0x1);const _0x10b2e7={};for(const _0x27ffba of _0x316d7f){_0x10b2e7[_0x4cd8ff=_0x27ffba['fileName']]||(_0x10b2e7[_0x4cd8ff]=[]),_0x10b2e7[_0x27ffba[_0x1029a2(0x179)]][_0x1029a2(0x19a)](_0x27ffba);}return Object['values'](_0x10b2e7)[_0x1029a2(0x184)]((_0x242b9a,_0x4d6b74)=>[..._0x242b9a,..._0x4d6b74],[]);}async['writeComponents'](_0xafe928){const _0x42f0fb=a104_0x4d6d1a;_0xafe928=this[_0x42f0fb(0x1a9)](_0xafe928);let _0x534bc8=0x0;while(_0xafe928[_0x42f0fb(0x15d)]){const _0x367c90=_0xafe928[_0x42f0fb(0x18a)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x42f0fb(0x154)]['writeFlosumComponents'](_0x367c90,{'skipChildErrors':this[_0x42f0fb(0x19d)][_0x42f0fb(0x144)][_0x42f0fb(0x18d)]===_0x42f0fb(0x167)}),_0x534bc8+=_0x367c90[_0x42f0fb(0x15d)],this[_0x42f0fb(0x18b)][_0x42f0fb(0x165)](this[_0x42f0fb(0x1af)]+_0x42f0fb(0x16e)+_0x534bc8+'/'+this[_0x42f0fb(0x152)]+_0x42f0fb(0x192)),await this['sfLogger']['send']();}}async[a104_0x4d6d1a(0x18e)](_0x4742da){const _0x486ee3=a104_0x4d6d1a;_0x4742da['sort'](_0x3825a6=>child_types_1[_0x486ee3(0x183)][_0x486ee3(0x146)](_0x3825a6[_0x486ee3(0x168)])?-0x1:0x1);let _0xcb33f5=0x0;while(_0x4742da['length']){const _0x2de389=_0x4742da[_0x486ee3(0x18a)](0x0,this[_0x486ee3(0x182)]);await this['mdapiUtils']['removeComponents'](_0x2de389),_0xcb33f5+=_0x2de389[_0x486ee3(0x15d)],this[_0x486ee3(0x18b)][_0x486ee3(0x165)](this[_0x486ee3(0x1af)]+_0x486ee3(0x147)+_0xcb33f5+'/'+this[_0x486ee3(0x19b)]+_0x486ee3(0x192)),await this['sfLogger'][_0x486ee3(0x195)]();}}async[a104_0x4d6d1a(0x16c)](){const _0x1af44b=a104_0x4d6d1a;this[_0x1af44b(0x13c)]&&await this[_0x1af44b(0x13c)][_0x1af44b(0x1a3)]()[_0x1af44b(0x187)](()=>void 0x0),this[_0x1af44b(0x154)]&&await this['mdapiUtils'][_0x1af44b(0x1a3)]()['catch'](()=>void 0x0),this[_0x1af44b(0x1b1)]&&await this[_0x1af44b(0x1b1)][_0x1af44b(0x1a3)]()[_0x1af44b(0x187)](()=>void 0x0);}async[a104_0x4d6d1a(0x177)](){const _0x56e459=a104_0x4d6d1a,{repo:_0x237fa2,branch:_0x179862,components:_0x33156c,convertToSFDX:_0x2b7fd0,message:_0x50eef1,user:_0x4423a3}=this[_0x56e459(0x19d)];this['mdapiUtils']=new mdapi_utils_1[(_0x56e459(0x17e))](),this[_0x56e459(0x13c)]=new git_utils_1['GitUtils'](await this[_0x56e459(0x141)]()),this[_0x56e459(0x1b1)]=new sfdx_utils_1[(_0x56e459(0x1a0))]();let _0x486062=_0x2b7fd0;try{await this[_0x56e459(0x18b)]['log'](this['prefix']+_0x56e459(0x173))[_0x56e459(0x195)](),await this[_0x56e459(0x13c)][_0x56e459(0x1ad)](_0x179862[_0x56e459(0x18d)],_0x237fa2[_0x56e459(0x18d)]);!this['commitData'][_0x56e459(0x181)]?(this['sfLogger'][_0x56e459(0x165)](this['prefix']+'\x20Prepare\x20mdapi\x20files.'),await this[_0x56e459(0x154)][_0x56e459(0x176)](this[_0x56e459(0x13c)][_0x56e459(0x17a)])):this[_0x56e459(0x18b)][_0x56e459(0x165)](this[_0x56e459(0x1af)]+_0x56e459(0x13d));await this[_0x56e459(0x18b)][_0x56e459(0x165)](this['prefix']+_0x56e459(0x14c))['send']();_0x33156c[_0x56e459(0x190)]&&(this[_0x56e459(0x18b)][_0x56e459(0x165)](this['prefix']+_0x56e459(0x180)),this[_0x56e459(0x152)]=_0x33156c[_0x56e459(0x190)]['length'],await this[_0x56e459(0x16a)](_0x33156c[_0x56e459(0x190)]),await this['sfLogger'][_0x56e459(0x195)]());await this['sfLogger']['log'](this[_0x56e459(0x1af)]+_0x56e459(0x15b))['send']();_0x33156c[_0x56e459(0x194)]&&(this[_0x56e459(0x18b)][_0x56e459(0x165)](this[_0x56e459(0x1af)]+_0x56e459(0x191)),this[_0x56e459(0x19b)]=_0x33156c['deleted'][_0x56e459(0x15d)],await this[_0x56e459(0x18e)](_0x33156c[_0x56e459(0x194)]),await this[_0x56e459(0x18b)]['send']());await this[_0x56e459(0x18b)][_0x56e459(0x195)]();const _0x4ffe32=await fs_internal_1['FS']['isEmptyDir'](this[_0x56e459(0x13c)][_0x56e459(0x17a)]);await sfdx_utils_2[_0x56e459(0x1b0)]['isSFDXProject'](this['gitUtils'][_0x56e459(0x17a)])?(_0x486062=!![],await fs_internal_1['FS'][_0x56e459(0x1a3)]((0x0,path_1[_0x56e459(0x188)])(this[_0x56e459(0x13c)][_0x56e459(0x17a)],_0x56e459(0x1a5)))):(_0x486062&&(!_0x4ffe32&&(_0x486062=![])),await this[_0x56e459(0x13c)]['clearDir']());_0x486062?(await this[_0x56e459(0x18b)][_0x56e459(0x165)](this[_0x56e459(0x1af)]+_0x56e459(0x13a))[_0x56e459(0x195)](),await this[_0x56e459(0x1b1)][_0x56e459(0x199)](this['mdapiUtils'][_0x56e459(0x17a)]),await this[_0x56e459(0x1b1)][_0x56e459(0x19e)](this[_0x56e459(0x13c)][_0x56e459(0x17a)],!_0x4ffe32),await this['sfdxUtils'][_0x56e459(0x1ae)](this[_0x56e459(0x154)][_0x56e459(0x17a)],(0x0,path_1[_0x56e459(0x188)])(this[_0x56e459(0x13c)][_0x56e459(0x17a)],constants_2['FORCE_APP_DEFAULT_DIR'])),await this[_0x56e459(0x1b1)][_0x56e459(0x1a3)]()):(await this[_0x56e459(0x18b)][_0x56e459(0x165)](this[_0x56e459(0x1af)]+_0x56e459(0x14f))[_0x56e459(0x195)](),await this[_0x56e459(0x154)][_0x56e459(0x16b)](this[_0x56e459(0x13c)]['dir']));await this[_0x56e459(0x18b)][_0x56e459(0x165)](this[_0x56e459(0x1af)]+_0x56e459(0x163))['send'](),await this['gitUtils'][_0x56e459(0x14e)](_0x50eef1,{'email':constants_1[_0x56e459(0x172)],'name':_0x4423a3[_0x56e459(0x18d)]},_0x179862[_0x56e459(0x18d)]),await this[_0x56e459(0x13c)][_0x56e459(0x1a3)](),await this[_0x56e459(0x154)][_0x56e459(0x1a3)]();const _0x10ae30=this['componentsToWrite']+this['componentsToDelete'];await this[_0x56e459(0x18b)]['log'](this[_0x56e459(0x1af)]+_0x56e459(0x159)+(Date['now']()-this[_0x56e459(0x14b)])+_0x56e459(0x160)+_0x10ae30+'.')[_0x56e459(0x195)]();}catch(_0x3b884b){await this[_0x56e459(0x16c)](),await this[_0x56e459(0x18b)][_0x56e459(0x198)](this[_0x56e459(0x1af)]+'\x20'+_0x3b884b)[_0x56e459(0x195)]();throw _0x3b884b;}}async[a104_0x4d6d1a(0x197)](_0x396f09,_0x5a8544){const _0x2fb2c8=a104_0x4d6d1a;var _0x59a452,_0x1bb19b;this[_0x2fb2c8(0x18b)]=typedi_1[_0x2fb2c8(0x183)][_0x2fb2c8(0x178)](providers_tokens_1[_0x2fb2c8(0x1ac)][_0x2fb2c8(0x153)]),this[_0x2fb2c8(0x1af)]=(_0x5a8544?_0x5a8544+'\x20':'')+'['+commit_components_dto_1[_0x2fb2c8(0x185)]['name']+']',await this[_0x2fb2c8(0x18b)][_0x2fb2c8(0x165)](this[_0x2fb2c8(0x1af)]+_0x2fb2c8(0x175));const _0x5331e2=!!((_0x59a452=_0x396f09['components'])===null||_0x59a452===void 0x0?void 0x0:_0x59a452[_0x2fb2c8(0x190)])||!!((_0x1bb19b=_0x396f09[_0x2fb2c8(0x16f)])===null||_0x1bb19b===void 0x0?void 0x0:_0x1bb19b['deleted']);if(!_0x5331e2){await this[_0x2fb2c8(0x18b)]['log'](this[_0x2fb2c8(0x1af)]+_0x2fb2c8(0x150))[_0x2fb2c8(0x195)]();return;}this[_0x2fb2c8(0x19d)]=_0x396f09,await this['exec']();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a104_0x4d6d1a(0x169)]=CommitComponentsJob;