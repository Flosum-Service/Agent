const a104_0x3a8cbe=a104_0x1a48;(function(_0x3bef0b,_0x36007a){const _0x57b6c3=a104_0x1a48,_0x3827ce=_0x3bef0b();while(!![]){try{const _0xe6e63a=-parseInt(_0x57b6c3(0xd5))/0x1+parseInt(_0x57b6c3(0xb0))/0x2+parseInt(_0x57b6c3(0xf4))/0x3*(parseInt(_0x57b6c3(0xd4))/0x4)+parseInt(_0x57b6c3(0xcf))/0x5*(-parseInt(_0x57b6c3(0xd9))/0x6)+parseInt(_0x57b6c3(0xda))/0x7*(parseInt(_0x57b6c3(0xe5))/0x8)+parseInt(_0x57b6c3(0xc8))/0x9*(parseInt(_0x57b6c3(0xaa))/0xa)+parseInt(_0x57b6c3(0xf0))/0xb*(-parseInt(_0x57b6c3(0xb3))/0xc);if(_0xe6e63a===_0x36007a)break;else _0x3827ce['push'](_0x3827ce['shift']());}catch(_0x10e5ca){_0x3827ce['push'](_0x3827ce['shift']());}}}(a104_0x3d04,0x4c742));function a104_0x1a48(_0x12e706,_0x820b13){const _0xda5d4a=a104_0x3d04();return a104_0x1a48=function(_0x1f5032,_0x211dea){_0x1f5032=_0x1f5032-0x96;let _0x3d04e7=_0xda5d4a[_0x1f5032];return _0x3d04e7;},a104_0x1a48(_0x12e706,_0x820b13);}const a104_0x211dea=(function(){let _0x5de399=!![];return function(_0x59e144,_0x4c6867){const _0x20e932=_0x5de399?function(){const _0x3d23ff=a104_0x1a48;if(_0x4c6867){const _0x3a0ec7=_0x4c6867[_0x3d23ff(0xad)](_0x59e144,arguments);return _0x4c6867=null,_0x3a0ec7;}}:function(){};return _0x5de399=![],_0x20e932;};}()),a104_0x1f5032=a104_0x211dea(this,function(){const _0x30fcc1=a104_0x1a48;return a104_0x1f5032[_0x30fcc1(0xf7)]()['search'](_0x30fcc1(0x9c))[_0x30fcc1(0xf7)]()[_0x30fcc1(0xfe)](a104_0x1f5032)[_0x30fcc1(0xb1)](_0x30fcc1(0x9c));});a104_0x1f5032();'use strict';var __createBinding=this&&this[a104_0x3a8cbe(0xe3)]||(Object[a104_0x3a8cbe(0xa9)]?function(_0x3bed49,_0x116923,_0x4ff728,_0x152399){const _0x19707a=a104_0x3a8cbe;if(_0x152399===undefined)_0x152399=_0x4ff728;var _0x41dc86=Object[_0x19707a(0xf3)](_0x116923,_0x4ff728);(!_0x41dc86||('get'in _0x41dc86?!_0x116923[_0x19707a(0x105)]:_0x41dc86['writable']||_0x41dc86[_0x19707a(0x9a)]))&&(_0x41dc86={'enumerable':!![],'get':function(){return _0x116923[_0x4ff728];}}),Object[_0x19707a(0xc9)](_0x3bed49,_0x152399,_0x41dc86);}:function(_0xc62ab9,_0x418690,_0x14a271,_0x4d9f05){if(_0x4d9f05===undefined)_0x4d9f05=_0x14a271;_0xc62ab9[_0x4d9f05]=_0x418690[_0x14a271];}),__setModuleDefault=this&&this[a104_0x3a8cbe(0xbc)]||(Object[a104_0x3a8cbe(0xa9)]?function(_0x528dd4,_0x38e86f){const _0x390d8a=a104_0x3a8cbe;Object['defineProperty'](_0x528dd4,_0x390d8a(0xf9),{'enumerable':!![],'value':_0x38e86f});}:function(_0x154534,_0x5b4f37){_0x154534['default']=_0x5b4f37;}),__decorate=this&&this[a104_0x3a8cbe(0xe2)]||function(_0x2f1db6,_0x50f2db,_0x47360f,_0x4e4fbf){const _0x5016de=a104_0x3a8cbe;var _0x18c8a4=arguments['length'],_0x3a526d=_0x18c8a4<0x3?_0x50f2db:_0x4e4fbf===null?_0x4e4fbf=Object[_0x5016de(0xf3)](_0x50f2db,_0x47360f):_0x4e4fbf,_0xb9158e;if(typeof Reflect===_0x5016de(0xae)&&typeof Reflect[_0x5016de(0xb7)]===_0x5016de(0xbe))_0x3a526d=Reflect[_0x5016de(0xb7)](_0x2f1db6,_0x50f2db,_0x47360f,_0x4e4fbf);else{for(var _0x2e8fcb=_0x2f1db6[_0x5016de(0xd7)]-0x1;_0x2e8fcb>=0x0;_0x2e8fcb--)if(_0xb9158e=_0x2f1db6[_0x2e8fcb])_0x3a526d=(_0x18c8a4<0x3?_0xb9158e(_0x3a526d):_0x18c8a4>0x3?_0xb9158e(_0x50f2db,_0x47360f,_0x3a526d):_0xb9158e(_0x50f2db,_0x47360f))||_0x3a526d;}return _0x18c8a4>0x3&&_0x3a526d&&Object[_0x5016de(0xc9)](_0x50f2db,_0x47360f,_0x3a526d),_0x3a526d;},__importStar=this&&this[a104_0x3a8cbe(0x10a)]||function(_0x343554){if(_0x343554&&_0x343554['__esModule'])return _0x343554;var _0x517d3b={};if(_0x343554!=null){for(var _0x22edf1 in _0x343554)if(_0x22edf1!=='default'&&Object['prototype']['hasOwnProperty']['call'](_0x343554,_0x22edf1))__createBinding(_0x517d3b,_0x343554,_0x22edf1);}return __setModuleDefault(_0x517d3b,_0x343554),_0x517d3b;},__importDefault=this&&this[a104_0x3a8cbe(0x10b)]||function(_0xfc62c6){const _0x562056=a104_0x3a8cbe;return _0xfc62c6&&_0xfc62c6[_0x562056(0x105)]?_0xfc62c6:{'default':_0xfc62c6};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require(a104_0x3a8cbe(0xc5)),events_1=__importDefault(require(a104_0x3a8cbe(0xac))),git_utils_1=require(a104_0x3a8cbe(0xe0)),mdapi_utils_1=require(a104_0x3a8cbe(0xe6)),sfdx_utils_1=require(a104_0x3a8cbe(0xd6)),typedi_1=__importStar(require(a104_0x3a8cbe(0xa8))),child_types_1=__importDefault(require(a104_0x3a8cbe(0xca))),utils_1=require(a104_0x3a8cbe(0x109)),constants_1=require(a104_0x3a8cbe(0xb5)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require(a104_0x3a8cbe(0xea)),fs_internal_1=require(a104_0x3a8cbe(0x100)),path_1=require(a104_0x3a8cbe(0xce)),providers_tokens_1=require(a104_0x3a8cbe(0xdb));function a104_0x3d04(){const _0x5b5f50=['master','groupComponentsByFileName','path','53740PqQmFB','isLoggedIn','\x20Start\x20cloning\x20repository.','getRemote','gitUtils','82672qImkJj','270491iHPJpZ','../utils/sfdx.utils','length','getProtocol','18ZSTYJa','302225PGqYfL','../../providers/providers.tokens','BitbucketApiService','prefix','\x20Preparing\x20to\x20delete\x20components','values','../utils/git.utils','\x20Copying\x20mdapi\x20to\x20git\x20folder.','__decorate','__createBinding','exec','80aiSqcc','../utils/mdapi.utils','now','credentials','get','../../salesforce/utils/sfdx.utils','removeDir','mdapiUtils','\x20Checking\x20deleted\x20components.','createProjectFrom','includes','355597qKkLxV','CommitComponentsJob','deleted','getOwnPropertyDescriptor','30VivUXD','branch','isSFDXProject','toString','send','default','Bitbucket','push','startTime','\x20Nothing\x20to\x20commit.\x20Skip.','constructor','componentsToDelete','../../internal/fs.internal','replace','gitUrl','SFDX','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','__esModule','copyMdapiTo','cleanUp','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','../../../shared/utils','__importStar','__importDefault','\x20Start\x20converting\x20to\x20SFDX.','\x20Checking\x20written\x20components.','isEmptyDir','sfLogger','configurable','sfdxUtils','(((.+)+)+)+$','components','dir','\x20Wrote\x20','MDApiUtils','reduce','GitProvider','\x20Deleted\x20','writeComponents','ms.\x20Committed\x20components\x20-\x20','commitData','GitUtils','typedi','create','70xBUhsx','removeComponents','events','apply','object','\x20components','205946DKdRVB','search','writed','132xyULER','catch','../../../../constants','clone','decorate','COMPONENTS_PER_TICK','splice','getGitShellAuthorizationString','fileName','__setModuleDefault','provider','function','CommitComponentsDto','://','componentsToWrite','\x20Prepare\x20mdapi\x20files.','name','log','../dto/commit-components.dto','join','commitAndPush','295821XXitQk','defineProperty','../../parsers/data/child-types','sort'];a104_0x3d04=function(){return _0x5b5f50;};return a104_0x3d04();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x3a8cbe(0xf9)]{constructor(){const _0x5116de=a104_0x3a8cbe;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x5116de(0xc1)]=0x0,this['componentsToDelete']=0x0,this['startTime']=Date[_0x5116de(0xe7)]();}async[a104_0x3a8cbe(0xd2)](){const _0x2b825d=a104_0x3a8cbe,{repo:_0x5affe8}=this[_0x2b825d(0xa6)],_0x102f3c=typedi_1[_0x2b825d(0xf9)][_0x2b825d(0xe9)](providers_tokens_1['Tokens'][_0x2b825d(0xe8)]);if(this['commitData'][_0x2b825d(0xbd)]===git_provider_1[_0x2b825d(0xa2)][_0x2b825d(0xfa)]){const _0x136158=typedi_1[_0x2b825d(0xf9)][_0x2b825d(0xe9)](bitbucket_api_service_1[_0x2b825d(0xdc)]);await _0x136158[_0x2b825d(0xd0)]();}return _0x5affe8[_0x2b825d(0x102)][_0x2b825d(0x101)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x2b825d(0xd8)])(_0x5affe8['gitUrl'])+_0x2b825d(0xc0)+_0x102f3c[_0x2b825d(0xba)]()+'@');}['groupComponentsByFileName'](_0x402719){const _0x178198=a104_0x3a8cbe;var _0x2075fb;_0x402719[_0x178198(0xcb)](_0xafc491=>child_types_1[_0x178198(0xf9)][_0x178198(0xef)](_0xafc491['fileType'])?0x1:-0x1);const _0x364d69={};for(const _0x3adb79 of _0x402719){_0x364d69[_0x2075fb=_0x3adb79[_0x178198(0xbb)]]||(_0x364d69[_0x2075fb]=[]),_0x364d69[_0x3adb79[_0x178198(0xbb)]][_0x178198(0xfb)](_0x3adb79);}return Object[_0x178198(0xdf)](_0x364d69)[_0x178198(0xa1)]((_0x2be1e2,_0x1aaca0)=>[..._0x2be1e2,..._0x1aaca0],[]);}async['writeComponents'](_0x441196){const _0x576d7a=a104_0x3a8cbe;_0x441196=this[_0x576d7a(0xcd)](_0x441196);let _0x20f464=0x0;while(_0x441196[_0x576d7a(0xd7)]){const _0x3d9026=_0x441196[_0x576d7a(0xb9)](0x0,this[_0x576d7a(0xb8)]);await this[_0x576d7a(0xec)]['writeFlosumComponents'](_0x3d9026,{'skipChildErrors':this[_0x576d7a(0xa6)][_0x576d7a(0xf5)][_0x576d7a(0xc3)]===_0x576d7a(0xcc)}),_0x20f464+=_0x3d9026['length'],this[_0x576d7a(0x99)]['log'](this[_0x576d7a(0xdd)]+_0x576d7a(0x9f)+_0x20f464+'/'+this['componentsToWrite']+_0x576d7a(0xaf)),await this['sfLogger'][_0x576d7a(0xf8)]();}}async[a104_0x3a8cbe(0xab)](_0xa6523f){const _0x4e0e63=a104_0x3a8cbe;_0xa6523f[_0x4e0e63(0xcb)](_0x18d361=>child_types_1[_0x4e0e63(0xf9)][_0x4e0e63(0xef)](_0x18d361['type'])?-0x1:0x1);let _0x1e54d3=0x0;while(_0xa6523f[_0x4e0e63(0xd7)]){const _0x49d61d=_0xa6523f['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x4e0e63(0xec)][_0x4e0e63(0xab)](_0x49d61d),_0x1e54d3+=_0x49d61d[_0x4e0e63(0xd7)],this[_0x4e0e63(0x99)]['log'](this[_0x4e0e63(0xdd)]+_0x4e0e63(0xa3)+_0x1e54d3+'/'+this[_0x4e0e63(0xff)]+_0x4e0e63(0xaf)),await this[_0x4e0e63(0x99)][_0x4e0e63(0xf8)]();}}async[a104_0x3a8cbe(0x107)](){const _0xe0da9f=a104_0x3a8cbe;this[_0xe0da9f(0xd3)]&&await this['gitUtils'][_0xe0da9f(0xeb)]()[_0xe0da9f(0xb4)](()=>void 0x0),this[_0xe0da9f(0xec)]&&await this['mdapiUtils'][_0xe0da9f(0xeb)]()[_0xe0da9f(0xb4)](()=>void 0x0),this['sfdxUtils']&&await this[_0xe0da9f(0x9b)][_0xe0da9f(0xeb)]()[_0xe0da9f(0xb4)](()=>void 0x0);}async['exec'](){const _0xc6a331=a104_0x3a8cbe,{repo:_0x173e52,branch:_0x459986,components:_0x42df12,convertToSFDX:_0x5395c9,message:_0x544336,user:_0x3c2ecf}=this[_0xc6a331(0xa6)];this[_0xc6a331(0xec)]=new mdapi_utils_1[(_0xc6a331(0xa0))](),this[_0xc6a331(0xd3)]=new git_utils_1[(_0xc6a331(0xa7))](await this['getRemote']()),this[_0xc6a331(0x9b)]=new sfdx_utils_1['SFDXUtils']();let _0x428f53=_0x5395c9;try{await this[_0xc6a331(0x99)]['log'](this['prefix']+_0xc6a331(0xd1))[_0xc6a331(0xf8)](),await this[_0xc6a331(0xd3)][_0xc6a331(0xb6)](_0x459986[_0xc6a331(0xc3)],_0x173e52[_0xc6a331(0xc3)]);!this['commitData']['force']?(this['sfLogger']['log'](this['prefix']+_0xc6a331(0xc2)),await this['mdapiUtils']['prepareMdapi'](this[_0xc6a331(0xd3)]['dir'])):this['sfLogger'][_0xc6a331(0xc4)](this['prefix']+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0xc6a331(0x99)][_0xc6a331(0xc4)](this[_0xc6a331(0xdd)]+_0xc6a331(0x97))[_0xc6a331(0xf8)]();_0x42df12[_0xc6a331(0xb2)]&&(this[_0xc6a331(0x99)][_0xc6a331(0xc4)](this[_0xc6a331(0xdd)]+'\x20Preparing\x20to\x20write\x20components'),this[_0xc6a331(0xc1)]=_0x42df12[_0xc6a331(0xb2)]['length'],await this[_0xc6a331(0xa4)](_0x42df12['writed']),await this[_0xc6a331(0x99)]['send']());await this['sfLogger'][_0xc6a331(0xc4)](this[_0xc6a331(0xdd)]+_0xc6a331(0xed))[_0xc6a331(0xf8)]();_0x42df12[_0xc6a331(0xf2)]&&(this[_0xc6a331(0x99)][_0xc6a331(0xc4)](this[_0xc6a331(0xdd)]+_0xc6a331(0xde)),this[_0xc6a331(0xff)]=_0x42df12[_0xc6a331(0xf2)][_0xc6a331(0xd7)],await this[_0xc6a331(0xab)](_0x42df12[_0xc6a331(0xf2)]),await this[_0xc6a331(0x99)]['send']());await this[_0xc6a331(0x99)][_0xc6a331(0xf8)]();const _0x382fad=await fs_internal_1['FS'][_0xc6a331(0x98)](this['gitUtils'][_0xc6a331(0x9e)]);await sfdx_utils_2[_0xc6a331(0x103)][_0xc6a331(0xf6)](this[_0xc6a331(0xd3)][_0xc6a331(0x9e)])?(_0x428f53=!![],await fs_internal_1['FS'][_0xc6a331(0xeb)]((0x0,path_1[_0xc6a331(0xc6)])(this[_0xc6a331(0xd3)][_0xc6a331(0x9e)],'force-app'))):(_0x428f53&&(!_0x382fad&&(_0x428f53=![])),await this[_0xc6a331(0xd3)]['clearDir']());_0x428f53?(await this['sfLogger'][_0xc6a331(0xc4)](this[_0xc6a331(0xdd)]+_0xc6a331(0x96))[_0xc6a331(0xf8)](),await this[_0xc6a331(0x9b)][_0xc6a331(0xee)](this[_0xc6a331(0xec)][_0xc6a331(0x9e)]),await this[_0xc6a331(0x9b)]['copyProjectTo'](this[_0xc6a331(0xd3)][_0xc6a331(0x9e)],!_0x382fad),await this[_0xc6a331(0x9b)][_0xc6a331(0xeb)]()):(await this[_0xc6a331(0x99)][_0xc6a331(0xc4)](this[_0xc6a331(0xdd)]+_0xc6a331(0xe1))[_0xc6a331(0xf8)](),await this[_0xc6a331(0xec)][_0xc6a331(0x106)](this['gitUtils'][_0xc6a331(0x9e)]));await this[_0xc6a331(0x99)]['log'](this[_0xc6a331(0xdd)]+_0xc6a331(0x108))['send'](),await this[_0xc6a331(0xd3)][_0xc6a331(0xc7)](_0x544336,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x3c2ecf[_0xc6a331(0xc3)]},_0x459986[_0xc6a331(0xc3)]),await this[_0xc6a331(0xd3)][_0xc6a331(0xeb)](),await this[_0xc6a331(0xec)][_0xc6a331(0xeb)]();const _0x2039db=this[_0xc6a331(0xc1)]+this['componentsToDelete'];await this[_0xc6a331(0x99)][_0xc6a331(0xc4)](this['prefix']+_0xc6a331(0x104)+(Date[_0xc6a331(0xe7)]()-this[_0xc6a331(0xfc)])+_0xc6a331(0xa5)+_0x2039db+'.')[_0xc6a331(0xf8)]();}catch(_0x214293){await this[_0xc6a331(0x107)](),await this['sfLogger']['error'](this[_0xc6a331(0xdd)]+'\x20'+_0x214293)['send']();throw _0x214293;}}async['run'](_0x1e4bac,_0x93791c){const _0x1fbd1e=a104_0x3a8cbe;var _0x45a4b3,_0x4f8fe2;this[_0x1fbd1e(0x99)]=typedi_1[_0x1fbd1e(0xf9)][_0x1fbd1e(0xe9)](providers_tokens_1['Tokens']['logger']),this[_0x1fbd1e(0xdd)]=(_0x93791c?_0x93791c+'\x20':'')+'['+commit_components_dto_1[_0x1fbd1e(0xbf)][_0x1fbd1e(0xc3)]+']',await this[_0x1fbd1e(0x99)]['log'](this[_0x1fbd1e(0xdd)]+'\x20Checking\x20commit\x20components.');const _0x397910=!!((_0x45a4b3=_0x1e4bac['components'])===null||_0x45a4b3===void 0x0?void 0x0:_0x45a4b3[_0x1fbd1e(0xb2)])||!!((_0x4f8fe2=_0x1e4bac[_0x1fbd1e(0x9d)])===null||_0x4f8fe2===void 0x0?void 0x0:_0x4f8fe2[_0x1fbd1e(0xf2)]);if(!_0x397910){await this['sfLogger'][_0x1fbd1e(0xc4)](this[_0x1fbd1e(0xdd)]+_0x1fbd1e(0xfd))[_0x1fbd1e(0xf8)]();return;}this[_0x1fbd1e(0xa6)]=_0x1e4bac,await this[_0x1fbd1e(0xe4)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a104_0x3a8cbe(0xf1)]=CommitComponentsJob;