const a104_0x379e59=a104_0x355d;(function(_0x26c646,_0x469381){const _0x342cbe=a104_0x355d,_0x42c5f0=_0x26c646();while(!![]){try{const _0x153f90=-parseInt(_0x342cbe(0x228))/0x1*(parseInt(_0x342cbe(0x205))/0x2)+parseInt(_0x342cbe(0x1ca))/0x3+parseInt(_0x342cbe(0x1d6))/0x4*(-parseInt(_0x342cbe(0x1f0))/0x5)+parseInt(_0x342cbe(0x1f4))/0x6*(parseInt(_0x342cbe(0x1e9))/0x7)+-parseInt(_0x342cbe(0x1d3))/0x8+parseInt(_0x342cbe(0x1e4))/0x9*(parseInt(_0x342cbe(0x213))/0xa)+parseInt(_0x342cbe(0x215))/0xb;if(_0x153f90===_0x469381)break;else _0x42c5f0['push'](_0x42c5f0['shift']());}catch(_0xc750db){_0x42c5f0['push'](_0x42c5f0['shift']());}}}(a104_0x2743,0x786f0));const a104_0x524441=(function(){let _0x4f8bd2=!![];return function(_0x141b9a,_0xdd9d60){const _0x1e73b6=_0x4f8bd2?function(){const _0x6251fa=a104_0x355d;if(_0xdd9d60){const _0x5dbb51=_0xdd9d60[_0x6251fa(0x1db)](_0x141b9a,arguments);return _0xdd9d60=null,_0x5dbb51;}}:function(){};return _0x4f8bd2=![],_0x1e73b6;};}()),a104_0x53e494=a104_0x524441(this,function(){const _0x168afa=a104_0x355d;return a104_0x53e494[_0x168afa(0x20e)]()[_0x168afa(0x1c9)](_0x168afa(0x233))[_0x168afa(0x20e)]()[_0x168afa(0x203)](a104_0x53e494)[_0x168afa(0x1c9)](_0x168afa(0x233));});a104_0x53e494();'use strict';var __createBinding=this&&this[a104_0x379e59(0x1c1)]||(Object[a104_0x379e59(0x1de)]?function(_0x5f567f,_0x2e2d24,_0x3760a0,_0x3182e1){const _0x18d0f7=a104_0x379e59;if(_0x3182e1===undefined)_0x3182e1=_0x3760a0;var _0x22a9ce=Object[_0x18d0f7(0x1cc)](_0x2e2d24,_0x3760a0);(!_0x22a9ce||(_0x18d0f7(0x201)in _0x22a9ce?!_0x2e2d24[_0x18d0f7(0x22e)]:_0x22a9ce[_0x18d0f7(0x1c6)]||_0x22a9ce[_0x18d0f7(0x1dc)]))&&(_0x22a9ce={'enumerable':!![],'get':function(){return _0x2e2d24[_0x3760a0];}}),Object[_0x18d0f7(0x20a)](_0x5f567f,_0x3182e1,_0x22a9ce);}:function(_0x3c7386,_0xef2caf,_0x37d510,_0x4d38fb){if(_0x4d38fb===undefined)_0x4d38fb=_0x37d510;_0x3c7386[_0x4d38fb]=_0xef2caf[_0x37d510];}),__setModuleDefault=this&&this[a104_0x379e59(0x1da)]||(Object['create']?function(_0x1877f2,_0xc1615d){const _0x4f3f03=a104_0x379e59;Object[_0x4f3f03(0x20a)](_0x1877f2,'default',{'enumerable':!![],'value':_0xc1615d});}:function(_0x552558,_0x2021f8){const _0xa1dcbb=a104_0x379e59;_0x552558[_0xa1dcbb(0x1f3)]=_0x2021f8;}),__decorate=this&&this[a104_0x379e59(0x1cb)]||function(_0x5ccef5,_0x12e14a,_0x202f30,_0x44d1c3){const _0x12c702=a104_0x379e59;var _0x4c4d96=arguments[_0x12c702(0x1cf)],_0x44f264=_0x4c4d96<0x3?_0x12e14a:_0x44d1c3===null?_0x44d1c3=Object[_0x12c702(0x1cc)](_0x12e14a,_0x202f30):_0x44d1c3,_0x4bc79b;if(typeof Reflect===_0x12c702(0x1ee)&&typeof Reflect[_0x12c702(0x1c3)]==='function')_0x44f264=Reflect[_0x12c702(0x1c3)](_0x5ccef5,_0x12e14a,_0x202f30,_0x44d1c3);else{for(var _0x2ca717=_0x5ccef5[_0x12c702(0x1cf)]-0x1;_0x2ca717>=0x0;_0x2ca717--)if(_0x4bc79b=_0x5ccef5[_0x2ca717])_0x44f264=(_0x4c4d96<0x3?_0x4bc79b(_0x44f264):_0x4c4d96>0x3?_0x4bc79b(_0x12e14a,_0x202f30,_0x44f264):_0x4bc79b(_0x12e14a,_0x202f30))||_0x44f264;}return _0x4c4d96>0x3&&_0x44f264&&Object['defineProperty'](_0x12e14a,_0x202f30,_0x44f264),_0x44f264;},__importStar=this&&this[a104_0x379e59(0x21d)]||function(_0xdbced2){const _0x311077=a104_0x379e59;if(_0xdbced2&&_0xdbced2['__esModule'])return _0xdbced2;var _0x41f91c={};if(_0xdbced2!=null){for(var _0x57d9b4 in _0xdbced2)if(_0x57d9b4!==_0x311077(0x1f3)&&Object[_0x311077(0x1fd)][_0x311077(0x20d)][_0x311077(0x22f)](_0xdbced2,_0x57d9b4))__createBinding(_0x41f91c,_0xdbced2,_0x57d9b4);}return __setModuleDefault(_0x41f91c,_0xdbced2),_0x41f91c;},__importDefault=this&&this[a104_0x379e59(0x229)]||function(_0x375f2a){const _0x532f84=a104_0x379e59;return _0x375f2a&&_0x375f2a[_0x532f84(0x22e)]?_0x375f2a:{'default':_0x375f2a};};Object['defineProperty'](exports,a104_0x379e59(0x22e),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;function a104_0x355d(_0x5c64c2,_0x2feb59){const _0x4a815f=a104_0x2743();return a104_0x355d=function(_0x53e494,_0x524441){_0x53e494=_0x53e494-0x1bf;let _0x2743b4=_0x4a815f[_0x53e494];return _0x2743b4;},a104_0x355d(_0x5c64c2,_0x2feb59);}const commit_components_dto_1=require(a104_0x379e59(0x1e5)),events_1=__importDefault(require(a104_0x379e59(0x209))),git_utils_1=require(a104_0x379e59(0x1d1)),mdapi_utils_1=require(a104_0x379e59(0x1f5)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a104_0x379e59(0x1d8))),utils_1=require('../../../shared/utils'),constants_1=require(a104_0x379e59(0x211)),git_provider_1=require(a104_0x379e59(0x214)),bitbucket_api_service_1=require(a104_0x379e59(0x21a)),sfdx_utils_2=require(a104_0x379e59(0x1e7)),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a104_0x379e59(0x1e8)),providers_tokens_1=require(a104_0x379e59(0x1c2));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x379e59(0x1f3)]{constructor(){const _0x40d00f=a104_0x379e59;super(...arguments),this[_0x40d00f(0x1f7)]=0x3e8,this[_0x40d00f(0x220)]=0x0,this[_0x40d00f(0x1f1)]=0x0,this['startTime']=Date[_0x40d00f(0x234)]();}async[a104_0x379e59(0x1c0)](){const _0x170987=a104_0x379e59,{repo:_0x1e522e}=this[_0x170987(0x1fb)],_0x3af3f3=typedi_1[_0x170987(0x1f3)]['get'](providers_tokens_1[_0x170987(0x1dd)]['credentials']);if(this['commitData'][_0x170987(0x1ed)]===git_provider_1[_0x170987(0x202)][_0x170987(0x1c8)]){const _0xc70797=typedi_1[_0x170987(0x1f3)][_0x170987(0x201)](bitbucket_api_service_1[_0x170987(0x1fe)]);await _0xc70797['isLoggedIn']();}return _0x1e522e[_0x170987(0x20c)][_0x170987(0x207)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x170987(0x1ef)])(_0x1e522e[_0x170987(0x20c)])+_0x170987(0x22c)+_0x3af3f3['getGitShellAuthorizationString']()+'@');}[a104_0x379e59(0x1e0)](_0x1d12a3){const _0x3af601=a104_0x379e59;var _0x3aa42e;_0x1d12a3[_0x3af601(0x1ec)](_0x2f7f5b=>child_types_1['default'][_0x3af601(0x1e1)](_0x2f7f5b[_0x3af601(0x200)])?0x1:-0x1);const _0x16bead={};for(const _0x5573ee of _0x1d12a3){_0x16bead[_0x3aa42e=_0x5573ee[_0x3af601(0x1d5)]]||(_0x16bead[_0x3aa42e]=[]),_0x16bead[_0x5573ee[_0x3af601(0x1d5)]][_0x3af601(0x230)](_0x5573ee);}return Object['values'](_0x16bead)[_0x3af601(0x232)]((_0x509f2d,_0x4223df)=>[..._0x509f2d,..._0x4223df],[]);}async[a104_0x379e59(0x208)](_0x5b7ca7){const _0x382ff5=a104_0x379e59;_0x5b7ca7=this[_0x382ff5(0x1e0)](_0x5b7ca7);let _0x57d1de=0x0;while(_0x5b7ca7[_0x382ff5(0x1cf)]){const _0x34fb7b=_0x5b7ca7[_0x382ff5(0x1df)](0x0,this[_0x382ff5(0x1f7)]);await this[_0x382ff5(0x1f6)][_0x382ff5(0x1c5)](_0x34fb7b,{'skipChildErrors':this[_0x382ff5(0x1fb)][_0x382ff5(0x236)]['name']===_0x382ff5(0x212)}),_0x57d1de+=_0x34fb7b[_0x382ff5(0x1cf)],this[_0x382ff5(0x1f9)][_0x382ff5(0x223)](this[_0x382ff5(0x22d)]+_0x382ff5(0x1cd)+_0x57d1de+'/'+this[_0x382ff5(0x220)]+_0x382ff5(0x1f8)),await this[_0x382ff5(0x1f9)][_0x382ff5(0x1bf)]();}}async[a104_0x379e59(0x1eb)](_0x21c8dd){const _0x2103c3=a104_0x379e59;_0x21c8dd[_0x2103c3(0x1ec)](_0x1cdf0e=>child_types_1['default'][_0x2103c3(0x1e1)](_0x1cdf0e[_0x2103c3(0x1d2)])?-0x1:0x1);let _0x5a2950=0x0;while(_0x21c8dd[_0x2103c3(0x1cf)]){const _0x56621e=_0x21c8dd[_0x2103c3(0x1df)](0x0,this[_0x2103c3(0x1f7)]);await this[_0x2103c3(0x1f6)][_0x2103c3(0x1eb)](_0x56621e),_0x5a2950+=_0x56621e['length'],this[_0x2103c3(0x1f9)]['log'](this[_0x2103c3(0x22d)]+_0x2103c3(0x22b)+_0x5a2950+'/'+this[_0x2103c3(0x1f1)]+_0x2103c3(0x1f8)),await this[_0x2103c3(0x1f9)][_0x2103c3(0x1bf)]();}}async[a104_0x379e59(0x22a)](){const _0x174eaa=a104_0x379e59;this[_0x174eaa(0x1d7)]&&await this[_0x174eaa(0x1d7)][_0x174eaa(0x1e6)]()[_0x174eaa(0x1fa)](()=>void 0x0),this['mdapiUtils']&&await this[_0x174eaa(0x1f6)][_0x174eaa(0x1e6)]()[_0x174eaa(0x1fa)](()=>void 0x0),this['sfdxUtils']&&await this[_0x174eaa(0x1e3)]['removeDir']()['catch'](()=>void 0x0);}async[a104_0x379e59(0x204)](){const _0x87c87d=a104_0x379e59,{repo:_0x543c33,branch:_0x526365,components:_0x52b850,convertToSFDX:_0x3c3a4d,message:_0x250d1b,user:_0x2184a2}=this[_0x87c87d(0x1fb)];this[_0x87c87d(0x1f6)]=new mdapi_utils_1['MDApiUtils'](),this[_0x87c87d(0x1d7)]=new git_utils_1[(_0x87c87d(0x219))](await this['getRemote']()),this['sfdxUtils']=new sfdx_utils_1['SFDXUtils']();let _0x2005f5=_0x3c3a4d;try{await this['sfLogger']['log'](this[_0x87c87d(0x22d)]+_0x87c87d(0x1f2))['send'](),await this['gitUtils']['clone'](_0x526365[_0x87c87d(0x21c)],_0x543c33[_0x87c87d(0x21c)]);!this[_0x87c87d(0x1fb)][_0x87c87d(0x1d4)]?(this[_0x87c87d(0x1f9)][_0x87c87d(0x223)](this[_0x87c87d(0x22d)]+_0x87c87d(0x1d9)),await this[_0x87c87d(0x1f6)][_0x87c87d(0x218)](this[_0x87c87d(0x1d7)][_0x87c87d(0x1e2)])):this['sfLogger'][_0x87c87d(0x223)](this[_0x87c87d(0x22d)]+_0x87c87d(0x216));await this[_0x87c87d(0x1f9)]['log'](this['prefix']+'\x20Checking\x20written\x20components.')[_0x87c87d(0x1bf)]();_0x52b850[_0x87c87d(0x1c7)]&&(this[_0x87c87d(0x1f9)]['log'](this[_0x87c87d(0x22d)]+_0x87c87d(0x235)),this[_0x87c87d(0x220)]=_0x52b850['writed'][_0x87c87d(0x1cf)],await this[_0x87c87d(0x208)](_0x52b850[_0x87c87d(0x1c7)]),await this[_0x87c87d(0x1f9)][_0x87c87d(0x1bf)]());await this[_0x87c87d(0x1f9)][_0x87c87d(0x223)](this[_0x87c87d(0x22d)]+_0x87c87d(0x206))[_0x87c87d(0x1bf)]();_0x52b850[_0x87c87d(0x21f)]&&(this[_0x87c87d(0x1f9)][_0x87c87d(0x223)](this[_0x87c87d(0x22d)]+_0x87c87d(0x227)),this[_0x87c87d(0x1f1)]=_0x52b850[_0x87c87d(0x21f)][_0x87c87d(0x1cf)],await this[_0x87c87d(0x1eb)](_0x52b850['deleted']),await this[_0x87c87d(0x1f9)][_0x87c87d(0x1bf)]());await this[_0x87c87d(0x1f9)][_0x87c87d(0x1bf)]();const _0x5b98d2=await fs_internal_1['FS'][_0x87c87d(0x21e)](this[_0x87c87d(0x1d7)]['dir']);await sfdx_utils_2['SFDX'][_0x87c87d(0x1d0)](this['gitUtils'][_0x87c87d(0x1e2)])?(_0x2005f5=!![],await fs_internal_1['FS'][_0x87c87d(0x1e6)]((0x0,path_1[_0x87c87d(0x20b)])(this[_0x87c87d(0x1d7)]['dir'],_0x87c87d(0x210)))):(_0x2005f5&&(!_0x5b98d2&&(_0x2005f5=![])),await this[_0x87c87d(0x1d7)][_0x87c87d(0x224)]());_0x2005f5?(await this[_0x87c87d(0x1f9)]['log'](this[_0x87c87d(0x22d)]+'\x20Start\x20converting\x20to\x20SFDX.')['send'](),await this[_0x87c87d(0x1e3)][_0x87c87d(0x222)](this[_0x87c87d(0x1f6)][_0x87c87d(0x1e2)]),await this[_0x87c87d(0x1e3)]['copyProjectTo'](this[_0x87c87d(0x1d7)][_0x87c87d(0x1e2)],!_0x5b98d2),await this['sfdxUtils'][_0x87c87d(0x1e6)]()):(await this['sfLogger'][_0x87c87d(0x223)](this['prefix']+_0x87c87d(0x231))[_0x87c87d(0x1bf)](),await this[_0x87c87d(0x1f6)]['copyMdapiTo'](this[_0x87c87d(0x1d7)]['dir']));await this[_0x87c87d(0x1f9)][_0x87c87d(0x223)](this[_0x87c87d(0x22d)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')[_0x87c87d(0x1bf)](),await this['gitUtils']['commitAndPush'](_0x250d1b,{'email':constants_1[_0x87c87d(0x1ff)],'name':_0x2184a2[_0x87c87d(0x21c)]},_0x526365[_0x87c87d(0x21c)]),await this[_0x87c87d(0x1d7)][_0x87c87d(0x1e6)](),await this[_0x87c87d(0x1f6)][_0x87c87d(0x1e6)]();const _0x2b1efe=this[_0x87c87d(0x220)]+this['componentsToDelete'];await this[_0x87c87d(0x1f9)]['log'](this['prefix']+_0x87c87d(0x225)+(Date[_0x87c87d(0x234)]()-this['startTime'])+_0x87c87d(0x20f)+_0x2b1efe+'.')[_0x87c87d(0x1bf)]();}catch(_0x1cea9b){await this['cleanUp'](),await this[_0x87c87d(0x1f9)][_0x87c87d(0x21b)](this[_0x87c87d(0x22d)]+'\x20'+_0x1cea9b)[_0x87c87d(0x1bf)]();throw _0x1cea9b;}}async[a104_0x379e59(0x226)](_0x5900f7,_0x1fa650){const _0x256dbf=a104_0x379e59;var _0x57c077,_0x2dbe50;this[_0x256dbf(0x1f9)]=typedi_1[_0x256dbf(0x1f3)][_0x256dbf(0x201)](providers_tokens_1['Tokens']['logger']),this[_0x256dbf(0x22d)]=(_0x1fa650?_0x1fa650+'\x20':'')+'['+commit_components_dto_1[_0x256dbf(0x217)]['name']+']',await this[_0x256dbf(0x1f9)][_0x256dbf(0x223)](this[_0x256dbf(0x22d)]+_0x256dbf(0x1fc));const _0x227cd7=!!((_0x57c077=_0x5900f7[_0x256dbf(0x1ea)])===null||_0x57c077===void 0x0?void 0x0:_0x57c077[_0x256dbf(0x1c7)])||!!((_0x2dbe50=_0x5900f7[_0x256dbf(0x1ea)])===null||_0x2dbe50===void 0x0?void 0x0:_0x2dbe50[_0x256dbf(0x21f)]);if(!_0x227cd7){await this[_0x256dbf(0x1f9)][_0x256dbf(0x223)](this['prefix']+_0x256dbf(0x1c4))[_0x256dbf(0x1bf)]();return;}this['commitData']=_0x5900f7,await this[_0x256dbf(0x204)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x379e59(0x221)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x379e59(0x1ce)]=CommitComponentsJob;function a104_0x2743(){const _0x2703be=['12023759iMSCis','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','CommitComponentsDto','prepareMdapi','GitUtils','../../providers/api/bitbucket-api.service','error','name','__importStar','isEmptyDir','deleted','componentsToWrite','Service','createProjectFrom','log','clearDir','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','run','\x20Preparing\x20to\x20delete\x20components','49064pKaHGd','__importDefault','cleanUp','\x20Deleted\x20','://','prefix','__esModule','call','push','\x20Copying\x20mdapi\x20to\x20git\x20folder.','reduce','(((.+)+)+)+$','now','\x20Preparing\x20to\x20write\x20components','branch','send','getRemote','__createBinding','../../providers/providers.tokens','decorate','\x20Nothing\x20to\x20commit.\x20Skip.','writeFlosumComponents','writable','writed','Bitbucket','search','2574690yCXczP','__decorate','getOwnPropertyDescriptor','\x20Wrote\x20','CommitComponentsJob','length','isSFDXProject','../utils/git.utils','type','5231120lPDcwh','force','fileName','248jWuLmT','gitUtils','../../parsers/data/child-types','\x20Prepare\x20mdapi\x20files.','__setModuleDefault','apply','configurable','Tokens','create','splice','groupComponentsByFileName','includes','dir','sfdxUtils','18KbiyAG','../dto/commit-components.dto','removeDir','../../salesforce/utils/sfdx.utils','path','448931gOjrTV','components','removeComponents','sort','provider','object','getProtocol','29035kdkaWU','componentsToDelete','\x20Start\x20cloning\x20repository.','default','18juJHFy','../utils/mdapi.utils','mdapiUtils','COMPONENTS_PER_TICK','\x20components','sfLogger','catch','commitData','\x20Checking\x20commit\x20components.','prototype','BitbucketApiService','DEFAULT_GIT_USER_EMAIL','fileType','get','GitProvider','constructor','exec','26EKkFqS','\x20Checking\x20deleted\x20components.','replace','writeComponents','events','defineProperty','join','gitUrl','hasOwnProperty','toString','ms.\x20Committed\x20components\x20-\x20','force-app','../../../../constants','master','6770lvSMAQ','../../providers/types/git-provider'];a104_0x2743=function(){return _0x2703be;};return a104_0x2743();}