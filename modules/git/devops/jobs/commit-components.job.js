const a125_0x255dbd=a125_0x50c9;(function(_0x551a7c,_0x365424){const _0x5b0daa=a125_0x50c9,_0x36b18b=_0x551a7c();while(!![]){try{const _0x403ef1=-parseInt(_0x5b0daa(0x1a7))/0x1*(-parseInt(_0x5b0daa(0x180))/0x2)+parseInt(_0x5b0daa(0x196))/0x3*(parseInt(_0x5b0daa(0x1ab))/0x4)+-parseInt(_0x5b0daa(0x13d))/0x5+parseInt(_0x5b0daa(0x18c))/0x6+-parseInt(_0x5b0daa(0x16b))/0x7+parseInt(_0x5b0daa(0x1b1))/0x8*(-parseInt(_0x5b0daa(0x184))/0x9)+parseInt(_0x5b0daa(0x163))/0xa*(parseInt(_0x5b0daa(0x14d))/0xb);if(_0x403ef1===_0x365424)break;else _0x36b18b['push'](_0x36b18b['shift']());}catch(_0x24f8b7){_0x36b18b['push'](_0x36b18b['shift']());}}}(a125_0x481b,0xa86fa));function a125_0x50c9(_0x536d13,_0x3e6660){const _0x248f64=a125_0x481b();return a125_0x50c9=function(_0x23f3af,_0x304d54){_0x23f3af=_0x23f3af-0x136;let _0x481b79=_0x248f64[_0x23f3af];return _0x481b79;},a125_0x50c9(_0x536d13,_0x3e6660);}const a125_0x304d54=(function(){let _0x7f3540=!![];return function(_0x178a86,_0x1288fd){const _0x40f064=_0x7f3540?function(){const _0x306148=a125_0x50c9;if(_0x1288fd){const _0x87995=_0x1288fd[_0x306148(0x1ad)](_0x178a86,arguments);return _0x1288fd=null,_0x87995;}}:function(){};return _0x7f3540=![],_0x40f064;};}()),a125_0x23f3af=a125_0x304d54(this,function(){const _0x590d4c=a125_0x50c9;return a125_0x23f3af[_0x590d4c(0x18d)]()[_0x590d4c(0x15a)]('(((.+)+)+)+$')[_0x590d4c(0x18d)]()[_0x590d4c(0x172)](a125_0x23f3af)['search']('(((.+)+)+)+$');});a125_0x23f3af();function a125_0x481b(){const _0x3656e8=['__setModuleDefault','../../internal/fs.internal','COMPONENTS_PER_TICK','../../providers/api/bitbucket-api.service','get','://','sfLogger','../../providers/types/git-provider','force-app','startTime','\x20Checking\x20commit\x20components.','fileName','../../../../constants','name','675917cuMXhV','getRemote','writeComponents','componentsToWrite','isSFDXProject','isConvertToSfdx','gitUrl','type','prefix','decorate','now','componentsToDelete','writeFlosumComponents','search','recordType','master','create','SFDXUtils','groupComponentsByFileName','function','\x20Start\x20converting\x20to\x20SFDX.','send','220qqHufj','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','writable','credentials','defineProperty','commitAndPush','GitProvider','error','1507681lveRze','getProtocol','DEFAULT_GIT_USER_EMAIL','\x20Prepare\x20mdapi\x20files.','includes','push','removeComponents','constructor','__importStar','dir','components','\x20Wrote\x20','Service','reduce','\x20components','SFDX','log','commitData','createProjectFrom','mdapiUtils','deleted','842laVbYb','sort','\x20Checking\x20written\x20components.','copySFDXIgnoredComponents','1307808gBlCqs','call','../../../shared/utils','gitUtils','hasOwnProperty','Tokens','BitbucketApiService','object','724206ZhDfgk','toString','length','configurable','splice','__esModule','CommitComponentsDto','\x20Copying\x20mdapi\x20to\x20git\x20folder.','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','CommitComponentsJob','6vcxMGl','\x20Start\x20cloning\x20repository.','catch','isEmptyDir','run','__decorate','writed','getOwnPropertyDescriptor','../../providers/providers.tokens','branch','fileType','ms.\x20Committed\x20components\x20-\x20','\x20Deleted\x20','path','GitUtils','join','../utils/git.utils','809HqjdFg','exec','removeDir','values','1505452scTNWj','../../parsers/data/child-types','apply','copyProjectTo','getGitShellAuthorizationString','isLoggedIn','40qEJYds','default','typedi','sfdxUtils','__importDefault','cleanUp','../utils/sfdx.utils','clearDir','4669965LkVSbu','logger'];a125_0x481b=function(){return _0x3656e8;};return a125_0x481b();}'use strict';var __createBinding=this&&this['__createBinding']||(Object[a125_0x255dbd(0x15d)]?function(_0x54ab2d,_0x4bedbd,_0x4d79cc,_0xb96846){const _0x361d32=a125_0x255dbd;if(_0xb96846===undefined)_0xb96846=_0x4d79cc;var _0x2d8a44=Object[_0x361d32(0x19d)](_0x4bedbd,_0x4d79cc);(!_0x2d8a44||('get'in _0x2d8a44?!_0x4bedbd[_0x361d32(0x191)]:_0x2d8a44[_0x361d32(0x165)]||_0x2d8a44[_0x361d32(0x18f)]))&&(_0x2d8a44={'enumerable':!![],'get':function(){return _0x4bedbd[_0x4d79cc];}}),Object[_0x361d32(0x167)](_0x54ab2d,_0xb96846,_0x2d8a44);}:function(_0x43d1e4,_0x165c25,_0x206450,_0x2f60e2){if(_0x2f60e2===undefined)_0x2f60e2=_0x206450;_0x43d1e4[_0x2f60e2]=_0x165c25[_0x206450];}),__setModuleDefault=this&&this[a125_0x255dbd(0x13f)]||(Object[a125_0x255dbd(0x15d)]?function(_0x4ab00f,_0x451a00){const _0x40aab7=a125_0x255dbd;Object[_0x40aab7(0x167)](_0x4ab00f,'default',{'enumerable':!![],'value':_0x451a00});}:function(_0x493f50,_0x3a7ac9){_0x493f50['default']=_0x3a7ac9;}),__decorate=this&&this[a125_0x255dbd(0x19b)]||function(_0x4d18ac,_0x23933f,_0x3bc503,_0x2fa907){const _0x3f61cd=a125_0x255dbd;var _0x2f42da=arguments['length'],_0x54c90d=_0x2f42da<0x3?_0x23933f:_0x2fa907===null?_0x2fa907=Object[_0x3f61cd(0x19d)](_0x23933f,_0x3bc503):_0x2fa907,_0x3fd12a;if(typeof Reflect===_0x3f61cd(0x18b)&&typeof Reflect[_0x3f61cd(0x156)]===_0x3f61cd(0x160))_0x54c90d=Reflect[_0x3f61cd(0x156)](_0x4d18ac,_0x23933f,_0x3bc503,_0x2fa907);else{for(var _0xd2cad1=_0x4d18ac['length']-0x1;_0xd2cad1>=0x0;_0xd2cad1--)if(_0x3fd12a=_0x4d18ac[_0xd2cad1])_0x54c90d=(_0x2f42da<0x3?_0x3fd12a(_0x54c90d):_0x2f42da>0x3?_0x3fd12a(_0x23933f,_0x3bc503,_0x54c90d):_0x3fd12a(_0x23933f,_0x3bc503))||_0x54c90d;}return _0x2f42da>0x3&&_0x54c90d&&Object[_0x3f61cd(0x167)](_0x23933f,_0x3bc503,_0x54c90d),_0x54c90d;},__importStar=this&&this[a125_0x255dbd(0x173)]||function(_0x569c5d){const _0x55167a=a125_0x255dbd;if(_0x569c5d&&_0x569c5d['__esModule'])return _0x569c5d;var _0x47cd05={};if(_0x569c5d!=null){for(var _0x11b895 in _0x569c5d)if(_0x11b895!==_0x55167a(0x136)&&Object['prototype'][_0x55167a(0x188)][_0x55167a(0x185)](_0x569c5d,_0x11b895))__createBinding(_0x47cd05,_0x569c5d,_0x11b895);}return __setModuleDefault(_0x47cd05,_0x569c5d),_0x47cd05;},__importDefault=this&&this[a125_0x255dbd(0x139)]||function(_0x24ba74){return _0x24ba74&&_0x24ba74['__esModule']?_0x24ba74:{'default':_0x24ba74};};Object[a125_0x255dbd(0x167)](exports,a125_0x255dbd(0x191),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require('events')),git_utils_1=require(a125_0x255dbd(0x1a6)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a125_0x255dbd(0x13b)),typedi_1=__importStar(require(a125_0x255dbd(0x137))),child_types_1=__importDefault(require(a125_0x255dbd(0x1ac))),utils_1=require(a125_0x255dbd(0x186)),constants_1=require(a125_0x255dbd(0x14b)),git_provider_1=require(a125_0x255dbd(0x146)),bitbucket_api_service_1=require(a125_0x255dbd(0x142)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a125_0x255dbd(0x140)),path_1=require(a125_0x255dbd(0x1a3)),providers_tokens_1=require(a125_0x255dbd(0x19e)),constants_2=require(a125_0x255dbd(0x14b));let CommitComponentsJob=class CommitComponentsJob extends events_1[a125_0x255dbd(0x136)]{constructor(){const _0x509bd5=a125_0x255dbd;super(...arguments),this[_0x509bd5(0x141)]=0x3e8,this[_0x509bd5(0x150)]=0x0,this[_0x509bd5(0x158)]=0x0,this['startTime']=Date[_0x509bd5(0x157)]();}async[a125_0x255dbd(0x14e)](){const _0x2012b0=a125_0x255dbd,{repo:_0x1d35e3}=this[_0x2012b0(0x17c)],_0x51edf7=typedi_1[_0x2012b0(0x136)]['get'](providers_tokens_1[_0x2012b0(0x189)][_0x2012b0(0x166)]);if(this['commitData']['provider']===git_provider_1[_0x2012b0(0x169)]['Bitbucket']){const _0xdf240f=typedi_1[_0x2012b0(0x136)][_0x2012b0(0x143)](bitbucket_api_service_1[_0x2012b0(0x18a)]);await _0xdf240f[_0x2012b0(0x1b0)]();}return _0x1d35e3['gitUrl']['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x2012b0(0x16c)])(_0x1d35e3[_0x2012b0(0x153)])+_0x2012b0(0x144)+_0x51edf7[_0x2012b0(0x1af)]()+'@');}[a125_0x255dbd(0x15f)](_0x44ff43){const _0x240427=a125_0x255dbd;var _0x3c2b50;_0x44ff43[_0x240427(0x181)](_0x5c28b4=>child_types_1[_0x240427(0x136)][_0x240427(0x16f)](_0x5c28b4[_0x240427(0x1a0)])?0x1:-0x1);const _0x53e7f4={};for(const _0x5bdb21 of _0x44ff43){_0x53e7f4[_0x3c2b50=_0x5bdb21['fileName']]||(_0x53e7f4[_0x3c2b50]=[]),_0x53e7f4[_0x5bdb21[_0x240427(0x14a)]][_0x240427(0x170)](_0x5bdb21);}return Object[_0x240427(0x1aa)](_0x53e7f4)[_0x240427(0x178)]((_0x4b8f5c,_0x2aa899)=>[..._0x4b8f5c,..._0x2aa899],[]);}async[a125_0x255dbd(0x14f)](_0x38c5f9){const _0x155d98=a125_0x255dbd;_0x38c5f9=this['groupComponentsByFileName'](_0x38c5f9);let _0x3253ec=0x0;while(_0x38c5f9['length']){const _0x567c69=_0x38c5f9[_0x155d98(0x190)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x155d98(0x17e)][_0x155d98(0x159)](_0x567c69,{'skipChildErrors':this['commitData'][_0x155d98(0x19f)][_0x155d98(0x14c)]===_0x155d98(0x15c),'recordType':this[_0x155d98(0x17c)][_0x155d98(0x15b)]}),_0x3253ec+=_0x567c69['length'],this[_0x155d98(0x145)][_0x155d98(0x17b)](this[_0x155d98(0x155)]+_0x155d98(0x176)+_0x3253ec+'/'+this[_0x155d98(0x150)]+_0x155d98(0x179)),await this[_0x155d98(0x145)]['send']();}}async['removeComponents'](_0x451c6b){const _0x3df646=a125_0x255dbd;_0x451c6b[_0x3df646(0x181)](_0x3f6a32=>child_types_1[_0x3df646(0x136)][_0x3df646(0x16f)](_0x3f6a32[_0x3df646(0x154)])?-0x1:0x1);let _0x40f9b2=0x0;while(_0x451c6b[_0x3df646(0x18e)]){const _0xa77a78=_0x451c6b[_0x3df646(0x190)](0x0,this[_0x3df646(0x141)]);await this['mdapiUtils']['removeComponents'](_0xa77a78,this['commitData'][_0x3df646(0x15b)]),_0x40f9b2+=_0xa77a78[_0x3df646(0x18e)],this['sfLogger'][_0x3df646(0x17b)](this[_0x3df646(0x155)]+_0x3df646(0x1a2)+_0x40f9b2+'/'+this[_0x3df646(0x158)]+'\x20components'),await this[_0x3df646(0x145)][_0x3df646(0x162)]();}}async[a125_0x255dbd(0x13a)](){const _0x18b8b8=a125_0x255dbd;this[_0x18b8b8(0x187)]&&await this[_0x18b8b8(0x187)][_0x18b8b8(0x1a9)]()[_0x18b8b8(0x198)](()=>void 0x0),this[_0x18b8b8(0x17e)]&&await this[_0x18b8b8(0x17e)]['removeDir']()[_0x18b8b8(0x198)](()=>void 0x0),this['sfdxUtils']&&await this[_0x18b8b8(0x138)][_0x18b8b8(0x1a9)]()['catch'](()=>void 0x0);}async[a125_0x255dbd(0x1a8)](){const _0x28b335=a125_0x255dbd,{repo:_0x248335,branch:_0x1ff7b6,components:_0x276325,convertToSFDX:_0x1634a1,message:_0x3cbab5,user:_0xd31a9a}=this[_0x28b335(0x17c)];this[_0x28b335(0x17e)]=new mdapi_utils_1['MDApiUtils'](),this[_0x28b335(0x187)]=new git_utils_1[(_0x28b335(0x1a4))](await this[_0x28b335(0x14e)]()),this[_0x28b335(0x138)]=new sfdx_utils_1[(_0x28b335(0x15e))]();let _0x57224e=_0x1634a1&&this['sfdxUtils'][_0x28b335(0x152)](this['commitData'][_0x28b335(0x15b)]);try{await this['sfLogger']['log'](this[_0x28b335(0x155)]+_0x28b335(0x197))[_0x28b335(0x162)](),await this['gitUtils']['clone'](_0x1ff7b6[_0x28b335(0x14c)],_0x248335[_0x28b335(0x14c)]);!this[_0x28b335(0x17c)]['force']?(this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+_0x28b335(0x16e)),await this['mdapiUtils']['prepareMdapi'](this[_0x28b335(0x187)][_0x28b335(0x174)])):this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+_0x28b335(0x182))[_0x28b335(0x162)]();_0x276325[_0x28b335(0x19c)]&&(this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+'\x20Preparing\x20to\x20write\x20components'),this[_0x28b335(0x150)]=_0x276325[_0x28b335(0x19c)][_0x28b335(0x18e)],await this['writeComponents'](_0x276325[_0x28b335(0x19c)]),await this[_0x28b335(0x145)][_0x28b335(0x162)]());await this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+'\x20Checking\x20deleted\x20components.')[_0x28b335(0x162)]();_0x276325[_0x28b335(0x17f)]&&(this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+'\x20Preparing\x20to\x20delete\x20components'),this[_0x28b335(0x158)]=_0x276325[_0x28b335(0x17f)][_0x28b335(0x18e)],await this[_0x28b335(0x171)](_0x276325['deleted']),await this[_0x28b335(0x145)]['send']());await this[_0x28b335(0x145)][_0x28b335(0x162)]();const _0x3be0d0=await fs_internal_1['FS'][_0x28b335(0x199)](this[_0x28b335(0x187)][_0x28b335(0x174)]);await sfdx_utils_2[_0x28b335(0x17a)][_0x28b335(0x151)](this[_0x28b335(0x187)][_0x28b335(0x174)])?(_0x57224e=!![],await fs_internal_1['FS'][_0x28b335(0x1a9)]((0x0,path_1[_0x28b335(0x1a5)])(this[_0x28b335(0x187)]['dir'],_0x28b335(0x147)))):(_0x57224e&&(!_0x3be0d0&&(_0x57224e=![])),await this[_0x28b335(0x187)][_0x28b335(0x13c)]());_0x57224e?(await this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+_0x28b335(0x161))['send'](),await this['sfdxUtils'][_0x28b335(0x17d)](this['mdapiUtils'][_0x28b335(0x174)]),await this[_0x28b335(0x138)][_0x28b335(0x1ae)](this['gitUtils'][_0x28b335(0x174)],!_0x3be0d0),await this[_0x28b335(0x138)][_0x28b335(0x183)](this[_0x28b335(0x17e)]['dir'],(0x0,path_1[_0x28b335(0x1a5)])(this[_0x28b335(0x187)]['dir'],constants_2['FORCE_APP_DEFAULT_DIR'])),await this[_0x28b335(0x138)]['removeDir']()):(await this[_0x28b335(0x145)]['log'](this[_0x28b335(0x155)]+_0x28b335(0x193))[_0x28b335(0x162)](),await this[_0x28b335(0x17e)]['copyMdapiTo'](this['gitUtils']['dir']));await this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+_0x28b335(0x194))['send'](),await this[_0x28b335(0x187)][_0x28b335(0x168)](_0x3cbab5,{'email':constants_1[_0x28b335(0x16d)],'name':_0xd31a9a['name']},_0x1ff7b6['name']),await this['gitUtils'][_0x28b335(0x1a9)](),await this[_0x28b335(0x17e)][_0x28b335(0x1a9)]();const _0x4a30d7=this['componentsToWrite']+this['componentsToDelete'];await this[_0x28b335(0x145)][_0x28b335(0x17b)](this[_0x28b335(0x155)]+_0x28b335(0x164)+(Date[_0x28b335(0x157)]()-this[_0x28b335(0x148)])+_0x28b335(0x1a1)+_0x4a30d7+'.')[_0x28b335(0x162)]();}catch(_0x5bc9f5){await this[_0x28b335(0x13a)](),await this[_0x28b335(0x145)][_0x28b335(0x16a)](this[_0x28b335(0x155)]+'\x20'+_0x5bc9f5)[_0x28b335(0x162)]();throw _0x5bc9f5;}}async[a125_0x255dbd(0x19a)](_0x375baa,_0x5bbeba){const _0xa7d598=a125_0x255dbd;var _0x18faa3,_0x5f10b1;this[_0xa7d598(0x145)]=typedi_1[_0xa7d598(0x136)][_0xa7d598(0x143)](providers_tokens_1[_0xa7d598(0x189)][_0xa7d598(0x13e)]),this[_0xa7d598(0x155)]=(_0x5bbeba?_0x5bbeba+'\x20':'')+'['+commit_components_dto_1[_0xa7d598(0x192)]['name']+']',await this['sfLogger'][_0xa7d598(0x17b)](this['prefix']+_0xa7d598(0x149));const _0x4b3e3d=!!((_0x18faa3=_0x375baa[_0xa7d598(0x175)])===null||_0x18faa3===void 0x0?void 0x0:_0x18faa3[_0xa7d598(0x19c)])||!!((_0x5f10b1=_0x375baa[_0xa7d598(0x175)])===null||_0x5f10b1===void 0x0?void 0x0:_0x5f10b1[_0xa7d598(0x17f)]);if(!_0x4b3e3d){await this[_0xa7d598(0x145)][_0xa7d598(0x17b)](this[_0xa7d598(0x155)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0xa7d598(0x162)]();return;}this[_0xa7d598(0x17c)]=_0x375baa,await this[_0xa7d598(0x1a8)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a125_0x255dbd(0x177)])({'transient':!![]})],CommitComponentsJob),exports[a125_0x255dbd(0x195)]=CommitComponentsJob;