const a72_0x307fc3=a72_0x253b;(function(_0x12d366,_0x3fab6e){const _0xcb11c1=a72_0x253b,_0x141693=_0x12d366();while(!![]){try{const _0x84abe0=parseInt(_0xcb11c1(0x17b))/0x1*(parseInt(_0xcb11c1(0x153))/0x2)+parseInt(_0xcb11c1(0x132))/0x3*(-parseInt(_0xcb11c1(0x12f))/0x4)+-parseInt(_0xcb11c1(0x129))/0x5+-parseInt(_0xcb11c1(0x121))/0x6*(parseInt(_0xcb11c1(0x167))/0x7)+-parseInt(_0xcb11c1(0x172))/0x8+parseInt(_0xcb11c1(0x178))/0x9*(parseInt(_0xcb11c1(0x11f))/0xa)+parseInt(_0xcb11c1(0x120))/0xb;if(_0x84abe0===_0x3fab6e)break;else _0x141693['push'](_0x141693['shift']());}catch(_0x27c6fd){_0x141693['push'](_0x141693['shift']());}}}(a72_0x214e,0x4e633));function a72_0x253b(_0xb7e6a,_0x2d6d66){const _0x532589=a72_0x214e();return a72_0x253b=function(_0x28a796,_0xa5852d){_0x28a796=_0x28a796-0x107;let _0x214e16=_0x532589[_0x28a796];return _0x214e16;},a72_0x253b(_0xb7e6a,_0x2d6d66);}const a72_0xa5852d=(function(){let _0x15a351=!![];return function(_0x4545c2,_0x2b4a0e){const _0x484ad2=_0x15a351?function(){const _0xcfbb3a=a72_0x253b;if(_0x2b4a0e){const _0x46698a=_0x2b4a0e[_0xcfbb3a(0x109)](_0x4545c2,arguments);return _0x2b4a0e=null,_0x46698a;}}:function(){};return _0x15a351=![],_0x484ad2;};}()),a72_0x28a796=a72_0xa5852d(this,function(){const _0xe969b1=a72_0x253b;return a72_0x28a796[_0xe969b1(0x15a)]()[_0xe969b1(0x163)](_0xe969b1(0x122))['toString']()[_0xe969b1(0x114)](a72_0x28a796)[_0xe969b1(0x163)](_0xe969b1(0x122));});a72_0x28a796();'use strict';var __createBinding=this&&this[a72_0x307fc3(0x136)]||(Object['create']?function(_0x1d8ac3,_0x366593,_0x25ea4e,_0x223c66){const _0x5f4074=a72_0x307fc3;if(_0x223c66===undefined)_0x223c66=_0x25ea4e;var _0x411faf=Object[_0x5f4074(0x16d)](_0x366593,_0x25ea4e);(!_0x411faf||(_0x5f4074(0x10e)in _0x411faf?!_0x366593[_0x5f4074(0x16a)]:_0x411faf[_0x5f4074(0x171)]||_0x411faf['configurable']))&&(_0x411faf={'enumerable':!![],'get':function(){return _0x366593[_0x25ea4e];}}),Object[_0x5f4074(0x173)](_0x1d8ac3,_0x223c66,_0x411faf);}:function(_0x604606,_0x50a002,_0xd67d71,_0x8186e5){if(_0x8186e5===undefined)_0x8186e5=_0xd67d71;_0x604606[_0x8186e5]=_0x50a002[_0xd67d71];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a72_0x307fc3(0x12a)]?function(_0x25522b,_0x2074bf){const _0x287566=a72_0x307fc3;Object['defineProperty'](_0x25522b,_0x287566(0x13f),{'enumerable':!![],'value':_0x2074bf});}:function(_0x328603,_0x5420c7){const _0x1fe5b2=a72_0x307fc3;_0x328603[_0x1fe5b2(0x13f)]=_0x5420c7;}),__decorate=this&&this[a72_0x307fc3(0x138)]||function(_0x33fe0f,_0x18b2d7,_0x48373d,_0x7f3796){const _0x2c6742=a72_0x307fc3;var _0x541175=arguments['length'],_0xa47568=_0x541175<0x3?_0x18b2d7:_0x7f3796===null?_0x7f3796=Object[_0x2c6742(0x16d)](_0x18b2d7,_0x48373d):_0x7f3796,_0xf1e825;if(typeof Reflect===_0x2c6742(0x179)&&typeof Reflect[_0x2c6742(0x15e)]===_0x2c6742(0x131))_0xa47568=Reflect['decorate'](_0x33fe0f,_0x18b2d7,_0x48373d,_0x7f3796);else{for(var _0x3c3c02=_0x33fe0f['length']-0x1;_0x3c3c02>=0x0;_0x3c3c02--)if(_0xf1e825=_0x33fe0f[_0x3c3c02])_0xa47568=(_0x541175<0x3?_0xf1e825(_0xa47568):_0x541175>0x3?_0xf1e825(_0x18b2d7,_0x48373d,_0xa47568):_0xf1e825(_0x18b2d7,_0x48373d))||_0xa47568;}return _0x541175>0x3&&_0xa47568&&Object[_0x2c6742(0x173)](_0x18b2d7,_0x48373d,_0xa47568),_0xa47568;},__importStar=this&&this[a72_0x307fc3(0x12d)]||function(_0x1b8673){const _0x2ecc99=a72_0x307fc3;if(_0x1b8673&&_0x1b8673[_0x2ecc99(0x16a)])return _0x1b8673;var _0x223f5f={};if(_0x1b8673!=null){for(var _0x2713e3 in _0x1b8673)if(_0x2713e3!==_0x2ecc99(0x13f)&&Object[_0x2ecc99(0x15d)][_0x2ecc99(0x10c)][_0x2ecc99(0x123)](_0x1b8673,_0x2713e3))__createBinding(_0x223f5f,_0x1b8673,_0x2713e3);}return __setModuleDefault(_0x223f5f,_0x1b8673),_0x223f5f;},__importDefault=this&&this['__importDefault']||function(_0x315d65){const _0x4526fe=a72_0x307fc3;return _0x315d65&&_0x315d65[_0x4526fe(0x16a)]?_0x315d65:{'default':_0x315d65};};function a72_0x214e(){const _0x11c46c=['sfdxUtils','createProjectFrom','303920pQpscO','create','now','splice','__importStar','catch','4TJxUnf','join','function','741939DbJSli','sfLogger','SFDXUtils','groupComponentsByFileName','__createBinding','fileType','__decorate','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','../../salesforce/utils/sfdx.utils','CommitComponentsDto','copyMdapiTo','../../../shared/utils','length','default','../../../../constants','gitUtils','includes','://','DEFAULT_GIT_USER_EMAIL','isSFDXProject','typedi','send','\x20Start\x20converting\x20to\x20SFDX.','credentials','reduce','ms.\x20Committed\x20components\x20-\x20','clone','components','commitAndPush','componentsToWrite','gitUrl','isLoggedIn','startTime','881770YOXxGp','../utils/mdapi.utils','../../providers/providers.tokens','\x20Nothing\x20to\x20commit.\x20Skip.','../../internal/fs.internal','removeComponents','name','toString','../../providers/types/git-provider','Tokens','prototype','decorate','values','isEmptyDir','copyProjectTo','force','search','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','\x20Deleted\x20','exec','7yGGHUO','\x20Prepare\x20mdapi\x20files.','log','__esModule','replace','COMPONENTS_PER_TICK','getOwnPropertyDescriptor','commitData','\x20Preparing\x20to\x20delete\x20components','GitProvider','writable','59448VSJTWK','defineProperty','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','type','\x20Start\x20cloning\x20repository.','writed','876870JqwhOe','object','logger','1IKLFQX','fileName','path','\x20Checking\x20written\x20components.','mdapiUtils','apply','prefix','MDApiUtils','hasOwnProperty','removeDir','get','Service','deleted','../dto/commit-components.dto','clearDir','../../providers/api/bitbucket-api.service','constructor','getRemote','getProtocol','dir','writeComponents','\x20components','\x20Checking\x20commit\x20components.','componentsToDelete','\x20Checking\x20deleted\x20components.','provider','BitbucketApiService','20seqLtP','1754555bdOiYt','951882jKwKvM','(((.+)+)+)+$','call','\x20Preparing\x20to\x20write\x20components','run','events'];a72_0x214e=function(){return _0x11c46c;};return a72_0x214e();}Object[a72_0x307fc3(0x173)](exports,a72_0x307fc3(0x16a),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require(a72_0x307fc3(0x111)),events_1=__importDefault(require(a72_0x307fc3(0x126))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a72_0x307fc3(0x154)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a72_0x307fc3(0x146))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a72_0x307fc3(0x13d)),constants_1=require(a72_0x307fc3(0x140)),git_provider_1=require(a72_0x307fc3(0x15b)),bitbucket_api_service_1=require(a72_0x307fc3(0x113)),sfdx_utils_2=require(a72_0x307fc3(0x13a)),fs_internal_1=require(a72_0x307fc3(0x157)),path_1=require(a72_0x307fc3(0x17d)),providers_tokens_1=require(a72_0x307fc3(0x155));let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(){const _0x31846f=a72_0x307fc3;super(...arguments),this[_0x31846f(0x16c)]=0x3e8,this[_0x31846f(0x14f)]=0x0,this['componentsToDelete']=0x0,this[_0x31846f(0x152)]=Date[_0x31846f(0x12b)]();}async['getRemote'](){const _0x52ca45=a72_0x307fc3,{repo:_0x4e3628}=this[_0x52ca45(0x16e)],_0x50bd62=typedi_1[_0x52ca45(0x13f)][_0x52ca45(0x10e)](providers_tokens_1[_0x52ca45(0x15c)][_0x52ca45(0x149)]);if(this[_0x52ca45(0x16e)][_0x52ca45(0x11d)]===git_provider_1[_0x52ca45(0x170)]['Bitbucket']){const _0x16dafe=typedi_1['default'][_0x52ca45(0x10e)](bitbucket_api_service_1[_0x52ca45(0x11e)]);await _0x16dafe[_0x52ca45(0x151)]();}return _0x4e3628[_0x52ca45(0x150)][_0x52ca45(0x16b)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x52ca45(0x116)])(_0x4e3628[_0x52ca45(0x150)])+_0x52ca45(0x143)+_0x50bd62['getGitShellAuthorizationString']()+'@');}['groupComponentsByFileName'](_0x3c182a){const _0x5c94ef=a72_0x307fc3;var _0xa2e0b2;_0x3c182a['sort'](_0x50bafb=>child_types_1['default'][_0x5c94ef(0x142)](_0x50bafb[_0x5c94ef(0x137)])?0x1:-0x1);const _0x5e161b={};for(const _0x3bf622 of _0x3c182a){_0x5e161b[_0xa2e0b2=_0x3bf622[_0x5c94ef(0x17c)]]||(_0x5e161b[_0xa2e0b2]=[]),_0x5e161b[_0x3bf622[_0x5c94ef(0x17c)]]['push'](_0x3bf622);}return Object[_0x5c94ef(0x15f)](_0x5e161b)[_0x5c94ef(0x14a)]((_0x23fa8a,_0x2e37ff)=>[..._0x23fa8a,..._0x2e37ff],[]);}async[a72_0x307fc3(0x118)](_0x19ed6c){const _0x27e338=a72_0x307fc3;_0x19ed6c=this[_0x27e338(0x135)](_0x19ed6c);let _0x478154=0x0;while(_0x19ed6c[_0x27e338(0x13e)]){const _0x4e26e2=_0x19ed6c[_0x27e338(0x12c)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x27e338(0x108)]['writeFlosumComponents'](_0x4e26e2,{'skipChildErrors':this['commitData']['branch'][_0x27e338(0x159)]==='master'}),_0x478154+=_0x4e26e2[_0x27e338(0x13e)],this['sfLogger']['log'](this['prefix']+'\x20Wrote\x20'+_0x478154+'/'+this[_0x27e338(0x14f)]+_0x27e338(0x119)),await this[_0x27e338(0x133)]['send']();}}async[a72_0x307fc3(0x158)](_0x3586c4){const _0x4370e3=a72_0x307fc3;_0x3586c4['sort'](_0x4b7ced=>child_types_1[_0x4370e3(0x13f)][_0x4370e3(0x142)](_0x4b7ced[_0x4370e3(0x175)])?-0x1:0x1);let _0x3bb121=0x0;while(_0x3586c4[_0x4370e3(0x13e)]){const _0x3ab7bf=_0x3586c4[_0x4370e3(0x12c)](0x0,this[_0x4370e3(0x16c)]);await this[_0x4370e3(0x108)][_0x4370e3(0x158)](_0x3ab7bf),_0x3bb121+=_0x3ab7bf['length'],this[_0x4370e3(0x133)]['log'](this[_0x4370e3(0x10a)]+_0x4370e3(0x165)+_0x3bb121+'/'+this[_0x4370e3(0x11b)]+_0x4370e3(0x119)),await this['sfLogger'][_0x4370e3(0x147)]();}}async['cleanUp'](){const _0xcdc717=a72_0x307fc3;this[_0xcdc717(0x141)]&&await this[_0xcdc717(0x141)]['removeDir']()[_0xcdc717(0x12e)](()=>void 0x0),this['mdapiUtils']&&await this[_0xcdc717(0x108)][_0xcdc717(0x10d)]()[_0xcdc717(0x12e)](()=>void 0x0),this['sfdxUtils']&&await this[_0xcdc717(0x127)][_0xcdc717(0x10d)]()[_0xcdc717(0x12e)](()=>void 0x0);}async[a72_0x307fc3(0x166)](){const _0x5942f8=a72_0x307fc3,{repo:_0x2fdeb0,branch:_0x3448ba,components:_0x1a5623,convertToSFDX:_0x2bfee8,message:_0x345d76,user:_0x2d99f6}=this[_0x5942f8(0x16e)];this[_0x5942f8(0x108)]=new mdapi_utils_1[(_0x5942f8(0x10b))](),this[_0x5942f8(0x141)]=new git_utils_1['GitUtils'](await this[_0x5942f8(0x115)]()),this[_0x5942f8(0x127)]=new sfdx_utils_1[(_0x5942f8(0x134))]();let _0x37e684=_0x2bfee8;try{await this[_0x5942f8(0x133)][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+_0x5942f8(0x176))[_0x5942f8(0x147)](),await this[_0x5942f8(0x141)][_0x5942f8(0x14c)](_0x3448ba[_0x5942f8(0x159)],_0x2fdeb0[_0x5942f8(0x159)]);!this[_0x5942f8(0x16e)][_0x5942f8(0x162)]?(this[_0x5942f8(0x133)][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+_0x5942f8(0x168)),await this[_0x5942f8(0x108)]['prepareMdapi'](this['gitUtils'][_0x5942f8(0x117)])):this[_0x5942f8(0x133)]['log'](this[_0x5942f8(0x10a)]+_0x5942f8(0x139));await this[_0x5942f8(0x133)][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+_0x5942f8(0x107))[_0x5942f8(0x147)]();_0x1a5623['writed']&&(this[_0x5942f8(0x133)][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+_0x5942f8(0x124)),this[_0x5942f8(0x14f)]=_0x1a5623[_0x5942f8(0x177)][_0x5942f8(0x13e)],await this['writeComponents'](_0x1a5623[_0x5942f8(0x177)]),await this[_0x5942f8(0x133)]['send']());await this['sfLogger'][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+_0x5942f8(0x11c))[_0x5942f8(0x147)]();_0x1a5623[_0x5942f8(0x110)]&&(this[_0x5942f8(0x133)][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+_0x5942f8(0x16f)),this['componentsToDelete']=_0x1a5623['deleted'][_0x5942f8(0x13e)],await this['removeComponents'](_0x1a5623[_0x5942f8(0x110)]),await this[_0x5942f8(0x133)][_0x5942f8(0x147)]());await this[_0x5942f8(0x133)][_0x5942f8(0x147)]();const _0x5d7378=await fs_internal_1['FS'][_0x5942f8(0x160)](this[_0x5942f8(0x141)][_0x5942f8(0x117)]);await sfdx_utils_2['SFDX'][_0x5942f8(0x145)](this['gitUtils'][_0x5942f8(0x117)])?(_0x37e684=!![],await fs_internal_1['FS'][_0x5942f8(0x10d)]((0x0,path_1[_0x5942f8(0x130)])(this['gitUtils']['dir'],'force-app'))):(_0x37e684&&(!_0x5d7378&&(_0x37e684=![])),await this[_0x5942f8(0x141)][_0x5942f8(0x112)]());_0x37e684?(await this['sfLogger']['log'](this[_0x5942f8(0x10a)]+_0x5942f8(0x148))[_0x5942f8(0x147)](),await this['sfdxUtils'][_0x5942f8(0x128)](this['mdapiUtils'][_0x5942f8(0x117)]),await this[_0x5942f8(0x127)][_0x5942f8(0x161)](this[_0x5942f8(0x141)][_0x5942f8(0x117)],!_0x5d7378),await this['sfdxUtils'][_0x5942f8(0x10d)]()):(await this[_0x5942f8(0x133)][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x5942f8(0x147)](),await this[_0x5942f8(0x108)][_0x5942f8(0x13c)](this[_0x5942f8(0x141)]['dir']));await this['sfLogger'][_0x5942f8(0x169)](this['prefix']+_0x5942f8(0x174))[_0x5942f8(0x147)](),await this[_0x5942f8(0x141)][_0x5942f8(0x14e)](_0x345d76,{'email':constants_1[_0x5942f8(0x144)],'name':_0x2d99f6[_0x5942f8(0x159)]},_0x3448ba[_0x5942f8(0x159)]),await this[_0x5942f8(0x141)][_0x5942f8(0x10d)](),await this[_0x5942f8(0x108)]['removeDir']();const _0x5e80dd=this[_0x5942f8(0x14f)]+this['componentsToDelete'];await this[_0x5942f8(0x133)][_0x5942f8(0x169)](this[_0x5942f8(0x10a)]+_0x5942f8(0x164)+(Date[_0x5942f8(0x12b)]()-this[_0x5942f8(0x152)])+_0x5942f8(0x14b)+_0x5e80dd+'.')[_0x5942f8(0x147)]();}catch(_0x85d241){await this['cleanUp'](),await this[_0x5942f8(0x133)]['error'](this[_0x5942f8(0x10a)]+'\x20'+_0x85d241)['send']();throw _0x85d241;}}async[a72_0x307fc3(0x125)](_0x494d96,_0x15de11){const _0x2e92a8=a72_0x307fc3;var _0x241850,_0x370eb3;this['sfLogger']=typedi_1['default']['get'](providers_tokens_1['Tokens'][_0x2e92a8(0x17a)]),this['prefix']=(_0x15de11?_0x15de11+'\x20':'')+'['+commit_components_dto_1[_0x2e92a8(0x13b)][_0x2e92a8(0x159)]+']',await this['sfLogger'][_0x2e92a8(0x169)](this[_0x2e92a8(0x10a)]+_0x2e92a8(0x11a));const _0x16d146=!!((_0x241850=_0x494d96[_0x2e92a8(0x14d)])===null||_0x241850===void 0x0?void 0x0:_0x241850[_0x2e92a8(0x177)])||!!((_0x370eb3=_0x494d96[_0x2e92a8(0x14d)])===null||_0x370eb3===void 0x0?void 0x0:_0x370eb3['deleted']);if(!_0x16d146){await this[_0x2e92a8(0x133)]['log'](this[_0x2e92a8(0x10a)]+_0x2e92a8(0x156))[_0x2e92a8(0x147)]();return;}this['commitData']=_0x494d96,await this[_0x2e92a8(0x166)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a72_0x307fc3(0x10f)])({'transient':!![]})],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;