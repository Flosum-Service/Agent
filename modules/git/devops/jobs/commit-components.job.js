const a122_0x3a1866=a122_0x6dc2;(function(_0x14d80b,_0x58671e){const _0x53c9e8=a122_0x6dc2,_0x5dac9f=_0x14d80b();while(!![]){try{const _0x3c90b1=parseInt(_0x53c9e8(0x100))/0x1+parseInt(_0x53c9e8(0x113))/0x2*(parseInt(_0x53c9e8(0x132))/0x3)+-parseInt(_0x53c9e8(0x14d))/0x4+parseInt(_0x53c9e8(0x15d))/0x5*(-parseInt(_0x53c9e8(0x158))/0x6)+-parseInt(_0x53c9e8(0x149))/0x7+parseInt(_0x53c9e8(0x152))/0x8*(parseInt(_0x53c9e8(0x131))/0x9)+parseInt(_0x53c9e8(0x146))/0xa*(parseInt(_0x53c9e8(0xed))/0xb);if(_0x3c90b1===_0x58671e)break;else _0x5dac9f['push'](_0x5dac9f['shift']());}catch(_0x703c2c){_0x5dac9f['push'](_0x5dac9f['shift']());}}}(a122_0x54ff,0x2d9b0));const a122_0x4c9caa=(function(){let _0x2d2d36=!![];return function(_0x97d2af,_0x1f9c58){const _0x4f7910=_0x2d2d36?function(){const _0x102eff=a122_0x6dc2;if(_0x1f9c58){const _0x46ad2b=_0x1f9c58[_0x102eff(0x10f)](_0x97d2af,arguments);return _0x1f9c58=null,_0x46ad2b;}}:function(){};return _0x2d2d36=![],_0x4f7910;};}()),a122_0x51b975=a122_0x4c9caa(this,function(){const _0xd0771=a122_0x6dc2;return a122_0x51b975['toString']()[_0xd0771(0x143)](_0xd0771(0xef))['toString']()['constructor'](a122_0x51b975)['search'](_0xd0771(0xef));});a122_0x51b975();'use strict';var __createBinding=this&&this[a122_0x3a1866(0x110)]||(Object[a122_0x3a1866(0x140)]?function(_0x1952f9,_0x55ffa5,_0x38252d,_0x5aa1c3){const _0x8f5a0f=a122_0x3a1866;if(_0x5aa1c3===undefined)_0x5aa1c3=_0x38252d;var _0x5c609d=Object[_0x8f5a0f(0x10c)](_0x55ffa5,_0x38252d);(!_0x5c609d||(_0x8f5a0f(0x15a)in _0x5c609d?!_0x55ffa5[_0x8f5a0f(0x148)]:_0x5c609d[_0x8f5a0f(0xf9)]||_0x5c609d[_0x8f5a0f(0x13e)]))&&(_0x5c609d={'enumerable':!![],'get':function(){return _0x55ffa5[_0x38252d];}}),Object[_0x8f5a0f(0x142)](_0x1952f9,_0x5aa1c3,_0x5c609d);}:function(_0x5a5a57,_0x2d531f,_0x459400,_0x20814f){if(_0x20814f===undefined)_0x20814f=_0x459400;_0x5a5a57[_0x20814f]=_0x2d531f[_0x459400];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a122_0x3a1866(0x140)]?function(_0x1e37e7,_0x606056){const _0x5151b1=a122_0x3a1866;Object['defineProperty'](_0x1e37e7,_0x5151b1(0x141),{'enumerable':!![],'value':_0x606056});}:function(_0x380dc5,_0x2822ae){_0x380dc5['default']=_0x2822ae;}),__decorate=this&&this[a122_0x3a1866(0x111)]||function(_0x179806,_0x206ba8,_0xbf4b09,_0x473df8){const _0x27e3ef=a122_0x3a1866;var _0x35970d=arguments[_0x27e3ef(0x109)],_0x167047=_0x35970d<0x3?_0x206ba8:_0x473df8===null?_0x473df8=Object[_0x27e3ef(0x10c)](_0x206ba8,_0xbf4b09):_0x473df8,_0x3e8339;if(typeof Reflect===_0x27e3ef(0x147)&&typeof Reflect['decorate']===_0x27e3ef(0x145))_0x167047=Reflect['decorate'](_0x179806,_0x206ba8,_0xbf4b09,_0x473df8);else{for(var _0x48c4a4=_0x179806[_0x27e3ef(0x109)]-0x1;_0x48c4a4>=0x0;_0x48c4a4--)if(_0x3e8339=_0x179806[_0x48c4a4])_0x167047=(_0x35970d<0x3?_0x3e8339(_0x167047):_0x35970d>0x3?_0x3e8339(_0x206ba8,_0xbf4b09,_0x167047):_0x3e8339(_0x206ba8,_0xbf4b09))||_0x167047;}return _0x35970d>0x3&&_0x167047&&Object[_0x27e3ef(0x142)](_0x206ba8,_0xbf4b09,_0x167047),_0x167047;},__importStar=this&&this[a122_0x3a1866(0x12f)]||function(_0x1548d1){const _0x146ccc=a122_0x3a1866;if(_0x1548d1&&_0x1548d1['__esModule'])return _0x1548d1;var _0x423c86={};if(_0x1548d1!=null){for(var _0x522acd in _0x1548d1)if(_0x522acd!==_0x146ccc(0x141)&&Object[_0x146ccc(0x118)][_0x146ccc(0x134)][_0x146ccc(0x10e)](_0x1548d1,_0x522acd))__createBinding(_0x423c86,_0x1548d1,_0x522acd);}return __setModuleDefault(_0x423c86,_0x1548d1),_0x423c86;},__importDefault=this&&this['__importDefault']||function(_0x1e7c61){const _0x3a138e=a122_0x3a1866;return _0x1e7c61&&_0x1e7c61[_0x3a138e(0x148)]?_0x1e7c61:{'default':_0x1e7c61};};function a122_0x54ff(){const _0x237c16=['log','isConvertToSfdx','dir','FORCE_APP_DEFAULT_DIR','prefix','../../providers/providers.tokens','\x20Start\x20converting\x20to\x20SFDX.','includes','55Hgdcnv','copySFDXIgnoredComponents','(((.+)+)+)+$','SFDXUtils','GitProvider','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','join','type','\x20Deleted\x20','BitbucketApiService','run','writable','sort','://','../../salesforce/utils/sfdx.utils','ms.\x20Committed\x20components\x20-\x20','splice','sfLogger','25325wLBTqF','catch','groupComponentsByFileName','force-app','prepareMdapi','isLoggedIn','../../../../constants','removeComponents','replace','length','master','deleted','getOwnPropertyDescriptor','isSFDXProject','call','apply','__createBinding','__decorate','exec','158756LjehSf','Bitbucket','error','gitUrl','force','prototype','Service','writeComponents','CommitComponentsJob','\x20Preparing\x20to\x20delete\x20components','componentsToWrite','startTime','Tokens','writed','fileName','getRemote','send','recordType','components','cleanUp','commitData','../../../shared/utils','../../providers/types/git-provider','path','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','SFDX','MDApiUtils','removeDir','__importStar','copyMdapiTo','18xYYiGk','9BunBEr','GitUtils','hasOwnProperty','../utils/mdapi.utils','\x20Prepare\x20mdapi\x20files.','getGitShellAuthorizationString','createProjectFrom','reduce','componentsToDelete','../../internal/fs.internal','mdapiUtils','gitUtils','configurable','\x20Checking\x20commit\x20components.','create','default','defineProperty','search','COMPONENTS_PER_TICK','function','930220qCsPyE','object','__esModule','1657971hwsqWu','\x20Preparing\x20to\x20write\x20components','commitAndPush','isEmptyDir','1287944iQZLVX','logger','sfdxUtils','events','provider','1052024gamVaS','\x20Start\x20cloning\x20repository.','\x20Wrote\x20','name','DEFAULT_GIT_USER_EMAIL','typedi','114kjCwhO','\x20Nothing\x20to\x20commit.\x20Skip.','get','\x20components','clearDir','64720rDYQmG','getProtocol'];a122_0x54ff=function(){return _0x237c16;};return a122_0x54ff();}Object[a122_0x3a1866(0x142)](exports,a122_0x3a1866(0x148),{'value':!![]}),exports[a122_0x3a1866(0x11b)]=void 0x0;function a122_0x6dc2(_0x1456c7,_0x46e0bf){const _0x5c5322=a122_0x54ff();return a122_0x6dc2=function(_0x51b975,_0x4c9caa){_0x51b975=_0x51b975-0xe7;let _0x54ff6f=_0x5c5322[_0x51b975];return _0x54ff6f;},a122_0x6dc2(_0x1456c7,_0x46e0bf);}const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a122_0x3a1866(0x150))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a122_0x3a1866(0x135)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a122_0x3a1866(0x157))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a122_0x3a1866(0x128)),constants_1=require(a122_0x3a1866(0x106)),git_provider_1=require(a122_0x3a1866(0x129)),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require(a122_0x3a1866(0xfc)),fs_internal_1=require(a122_0x3a1866(0x13b)),path_1=require(a122_0x3a1866(0x12a)),providers_tokens_1=require(a122_0x3a1866(0xea)),constants_2=require(a122_0x3a1866(0x106));let CommitComponentsJob=class CommitComponentsJob extends events_1[a122_0x3a1866(0x141)]{constructor(){const _0x4607b2=a122_0x3a1866;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x4607b2(0x11d)]=0x0,this[_0x4607b2(0x13a)]=0x0,this[_0x4607b2(0x11e)]=Date['now']();}async['getRemote'](){const _0x1df80d=a122_0x3a1866,{repo:_0x1f2636}=this['commitData'],_0x8ce757=typedi_1[_0x1df80d(0x141)][_0x1df80d(0x15a)](providers_tokens_1[_0x1df80d(0x11f)]['credentials']);if(this[_0x1df80d(0x127)][_0x1df80d(0x151)]===git_provider_1[_0x1df80d(0xf1)][_0x1df80d(0x114)]){const _0xc50dfa=typedi_1[_0x1df80d(0x141)][_0x1df80d(0x15a)](bitbucket_api_service_1[_0x1df80d(0xf7)]);await _0xc50dfa[_0x1df80d(0x105)]();}return _0x1f2636[_0x1df80d(0x116)][_0x1df80d(0x108)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x1df80d(0x15e)])(_0x1f2636[_0x1df80d(0x116)])+_0x1df80d(0xfb)+_0x8ce757[_0x1df80d(0x137)]()+'@');}['groupComponentsByFileName'](_0x2403fb){const _0x5330e9=a122_0x3a1866;var _0x58dcec;_0x2403fb[_0x5330e9(0xfa)](_0xd1b02c=>child_types_1[_0x5330e9(0x141)]['includes'](_0xd1b02c['fileType'])?0x1:-0x1);const _0x1462b5={};for(const _0x525e02 of _0x2403fb){_0x1462b5[_0x58dcec=_0x525e02[_0x5330e9(0x121)]]||(_0x1462b5[_0x58dcec]=[]),_0x1462b5[_0x525e02[_0x5330e9(0x121)]]['push'](_0x525e02);}return Object['values'](_0x1462b5)[_0x5330e9(0x139)]((_0x40e06c,_0x3ac884)=>[..._0x40e06c,..._0x3ac884],[]);}async[a122_0x3a1866(0x11a)](_0x4af087){const _0x912d9b=a122_0x3a1866;_0x4af087=this[_0x912d9b(0x102)](_0x4af087);let _0xe3d09=0x0;while(_0x4af087[_0x912d9b(0x109)]){const _0x289a93=_0x4af087[_0x912d9b(0xfe)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils']['writeFlosumComponents'](_0x289a93,{'skipChildErrors':this[_0x912d9b(0x127)]['branch']['name']===_0x912d9b(0x10a),'recordType':this[_0x912d9b(0x127)]['recordType']}),_0xe3d09+=_0x289a93[_0x912d9b(0x109)],this[_0x912d9b(0xff)][_0x912d9b(0x15f)](this[_0x912d9b(0xe9)]+_0x912d9b(0x154)+_0xe3d09+'/'+this[_0x912d9b(0x11d)]+_0x912d9b(0x15b)),await this[_0x912d9b(0xff)]['send']();}}async[a122_0x3a1866(0x107)](_0xbaddd){const _0x4a983f=a122_0x3a1866;_0xbaddd[_0x4a983f(0xfa)](_0x560c2f=>child_types_1[_0x4a983f(0x141)][_0x4a983f(0xec)](_0x560c2f[_0x4a983f(0xf5)])?-0x1:0x1);let _0x167b4f=0x0;while(_0xbaddd[_0x4a983f(0x109)]){const _0x158fc1=_0xbaddd[_0x4a983f(0xfe)](0x0,this[_0x4a983f(0x144)]);await this[_0x4a983f(0x13c)]['removeComponents'](_0x158fc1,this[_0x4a983f(0x127)][_0x4a983f(0x124)]),_0x167b4f+=_0x158fc1[_0x4a983f(0x109)],this['sfLogger']['log'](this[_0x4a983f(0xe9)]+_0x4a983f(0xf6)+_0x167b4f+'/'+this['componentsToDelete']+_0x4a983f(0x15b)),await this['sfLogger'][_0x4a983f(0x123)]();}}async[a122_0x3a1866(0x126)](){const _0x1e7780=a122_0x3a1866;this[_0x1e7780(0x13d)]&&await this[_0x1e7780(0x13d)]['removeDir']()['catch'](()=>void 0x0),this[_0x1e7780(0x13c)]&&await this['mdapiUtils'][_0x1e7780(0x12e)]()[_0x1e7780(0x101)](()=>void 0x0),this[_0x1e7780(0x14f)]&&await this[_0x1e7780(0x14f)][_0x1e7780(0x12e)]()[_0x1e7780(0x101)](()=>void 0x0);}async['exec'](){const _0x1ece0f=a122_0x3a1866,{repo:_0x4836f2,branch:_0x2036b6,components:_0x2722aa,convertToSFDX:_0x1bd5d3,message:_0x20c9c1,user:_0x29ac77}=this[_0x1ece0f(0x127)];this['mdapiUtils']=new mdapi_utils_1[(_0x1ece0f(0x12d))](),this[_0x1ece0f(0x13d)]=new git_utils_1[(_0x1ece0f(0x133))](await this[_0x1ece0f(0x122)]()),this[_0x1ece0f(0x14f)]=new sfdx_utils_1[(_0x1ece0f(0xf0))]();let _0x4dd4e0=_0x1bd5d3&&this[_0x1ece0f(0x14f)][_0x1ece0f(0x160)](this[_0x1ece0f(0x127)]['recordType']);try{await this['sfLogger'][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+_0x1ece0f(0x153))[_0x1ece0f(0x123)](),await this['gitUtils']['clone'](_0x2036b6[_0x1ece0f(0x155)],_0x4836f2[_0x1ece0f(0x155)]);!this['commitData'][_0x1ece0f(0x117)]?(this['sfLogger'][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+_0x1ece0f(0x136)),await this['mdapiUtils'][_0x1ece0f(0x104)](this[_0x1ece0f(0x13d)][_0x1ece0f(0xe7)])):this['sfLogger']['log'](this['prefix']+_0x1ece0f(0x12b));await this[_0x1ece0f(0xff)][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+'\x20Checking\x20written\x20components.')[_0x1ece0f(0x123)]();_0x2722aa[_0x1ece0f(0x120)]&&(this[_0x1ece0f(0xff)][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+_0x1ece0f(0x14a)),this[_0x1ece0f(0x11d)]=_0x2722aa['writed'][_0x1ece0f(0x109)],await this[_0x1ece0f(0x11a)](_0x2722aa['writed']),await this['sfLogger']['send']());await this[_0x1ece0f(0xff)][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+'\x20Checking\x20deleted\x20components.')[_0x1ece0f(0x123)]();_0x2722aa[_0x1ece0f(0x10b)]&&(this[_0x1ece0f(0xff)][_0x1ece0f(0x15f)](this['prefix']+_0x1ece0f(0x11c)),this['componentsToDelete']=_0x2722aa[_0x1ece0f(0x10b)][_0x1ece0f(0x109)],await this[_0x1ece0f(0x107)](_0x2722aa[_0x1ece0f(0x10b)]),await this[_0x1ece0f(0xff)]['send']());await this[_0x1ece0f(0xff)][_0x1ece0f(0x123)]();const _0x401938=await fs_internal_1['FS'][_0x1ece0f(0x14c)](this['gitUtils'][_0x1ece0f(0xe7)]);await sfdx_utils_2[_0x1ece0f(0x12c)][_0x1ece0f(0x10d)](this[_0x1ece0f(0x13d)][_0x1ece0f(0xe7)])?(_0x4dd4e0=!![],await fs_internal_1['FS'][_0x1ece0f(0x12e)]((0x0,path_1[_0x1ece0f(0xf4)])(this['gitUtils']['dir'],_0x1ece0f(0x103)))):(_0x4dd4e0&&(!_0x401938&&(_0x4dd4e0=![])),await this[_0x1ece0f(0x13d)][_0x1ece0f(0x15c)]());_0x4dd4e0?(await this[_0x1ece0f(0xff)][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+_0x1ece0f(0xeb))['send'](),await this[_0x1ece0f(0x14f)][_0x1ece0f(0x138)](this[_0x1ece0f(0x13c)]['dir']),await this[_0x1ece0f(0x14f)]['copyProjectTo'](this[_0x1ece0f(0x13d)]['dir'],!_0x401938),await this[_0x1ece0f(0x14f)][_0x1ece0f(0xee)](this[_0x1ece0f(0x13c)][_0x1ece0f(0xe7)],(0x0,path_1[_0x1ece0f(0xf4)])(this[_0x1ece0f(0x13d)][_0x1ece0f(0xe7)],constants_2[_0x1ece0f(0xe8)])),await this[_0x1ece0f(0x14f)][_0x1ece0f(0x12e)]()):(await this[_0x1ece0f(0xff)][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x1ece0f(0x123)](),await this[_0x1ece0f(0x13c)][_0x1ece0f(0x130)](this['gitUtils']['dir']));await this[_0x1ece0f(0xff)][_0x1ece0f(0x15f)](this[_0x1ece0f(0xe9)]+_0x1ece0f(0xf3))[_0x1ece0f(0x123)](),await this[_0x1ece0f(0x13d)][_0x1ece0f(0x14b)](_0x20c9c1,{'email':constants_1[_0x1ece0f(0x156)],'name':_0x29ac77[_0x1ece0f(0x155)]},_0x2036b6[_0x1ece0f(0x155)]),await this[_0x1ece0f(0x13d)][_0x1ece0f(0x12e)](),await this[_0x1ece0f(0x13c)]['removeDir']();const _0x3a2c0c=this[_0x1ece0f(0x11d)]+this[_0x1ece0f(0x13a)];await this['sfLogger'][_0x1ece0f(0x15f)](this['prefix']+_0x1ece0f(0xf2)+(Date['now']()-this['startTime'])+_0x1ece0f(0xfd)+_0x3a2c0c+'.')[_0x1ece0f(0x123)]();}catch(_0x131ef8){await this['cleanUp'](),await this[_0x1ece0f(0xff)][_0x1ece0f(0x115)](this['prefix']+'\x20'+_0x131ef8)[_0x1ece0f(0x123)]();throw _0x131ef8;}}async[a122_0x3a1866(0xf8)](_0x2a433f,_0xd4a6cb){const _0x1045b7=a122_0x3a1866;var _0x142d19,_0x54eb43;this['sfLogger']=typedi_1[_0x1045b7(0x141)]['get'](providers_tokens_1[_0x1045b7(0x11f)][_0x1045b7(0x14e)]),this[_0x1045b7(0xe9)]=(_0xd4a6cb?_0xd4a6cb+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto'][_0x1045b7(0x155)]+']',await this[_0x1045b7(0xff)][_0x1045b7(0x15f)](this[_0x1045b7(0xe9)]+_0x1045b7(0x13f));const _0xf6eab=!!((_0x142d19=_0x2a433f[_0x1045b7(0x125)])===null||_0x142d19===void 0x0?void 0x0:_0x142d19[_0x1045b7(0x120)])||!!((_0x54eb43=_0x2a433f[_0x1045b7(0x125)])===null||_0x54eb43===void 0x0?void 0x0:_0x54eb43[_0x1045b7(0x10b)]);if(!_0xf6eab){await this[_0x1045b7(0xff)]['log'](this[_0x1045b7(0xe9)]+_0x1045b7(0x159))[_0x1045b7(0x123)]();return;}this['commitData']=_0x2a433f,await this[_0x1045b7(0x112)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a122_0x3a1866(0x119)])({'transient':!![]})],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;