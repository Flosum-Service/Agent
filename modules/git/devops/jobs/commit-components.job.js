const a60_0x32b191=a60_0x3476;(function(_0x22b822,_0x50faa3){const _0x1fbf5e=a60_0x3476,_0x375191=_0x22b822();while(!![]){try{const _0x19c91d=parseInt(_0x1fbf5e(0x170))/0x1+parseInt(_0x1fbf5e(0x142))/0x2+-parseInt(_0x1fbf5e(0x10c))/0x3*(parseInt(_0x1fbf5e(0x123))/0x4)+-parseInt(_0x1fbf5e(0x161))/0x5*(-parseInt(_0x1fbf5e(0x13b))/0x6)+-parseInt(_0x1fbf5e(0x169))/0x7+parseInt(_0x1fbf5e(0x122))/0x8+-parseInt(_0x1fbf5e(0x11b))/0x9*(parseInt(_0x1fbf5e(0x133))/0xa);if(_0x19c91d===_0x50faa3)break;else _0x375191['push'](_0x375191['shift']());}catch(_0x5c361){_0x375191['push'](_0x375191['shift']());}}}(a60_0x3ec5,0xeb7a3));const a60_0x2e4174=(function(){let _0x1058d1=!![];return function(_0x13e837,_0x165fc9){const _0x16ac63=_0x1058d1?function(){const _0x1bb99d=a60_0x3476;if(_0x165fc9){const _0x4e5146=_0x165fc9[_0x1bb99d(0x15f)](_0x13e837,arguments);return _0x165fc9=null,_0x4e5146;}}:function(){};return _0x1058d1=![],_0x16ac63;};}()),a60_0x2d725a=a60_0x2e4174(this,function(){const _0x29e4a2=a60_0x3476;return a60_0x2d725a[_0x29e4a2(0x108)]()[_0x29e4a2(0x12a)]('(((.+)+)+)+$')[_0x29e4a2(0x108)]()['constructor'](a60_0x2d725a)['search'](_0x29e4a2(0x121));});a60_0x2d725a();'use strict';var __createBinding=this&&this[a60_0x32b191(0x104)]||(Object['create']?function(_0x286ab8,_0x371612,_0x32ba89,_0x43f3c4){const _0x42359c=a60_0x32b191;if(_0x43f3c4===undefined)_0x43f3c4=_0x32ba89;Object[_0x42359c(0x118)](_0x286ab8,_0x43f3c4,{'enumerable':!![],'get':function(){return _0x371612[_0x32ba89];}});}:function(_0x29ffcc,_0x5c3b26,_0x4bcfe7,_0x256bc8){if(_0x256bc8===undefined)_0x256bc8=_0x4bcfe7;_0x29ffcc[_0x256bc8]=_0x5c3b26[_0x4bcfe7];}),__setModuleDefault=this&&this[a60_0x32b191(0x146)]||(Object['create']?function(_0x420d9c,_0x41bc43){const _0x52fd86=a60_0x32b191;Object[_0x52fd86(0x118)](_0x420d9c,_0x52fd86(0x101),{'enumerable':!![],'value':_0x41bc43});}:function(_0x29770c,_0x318252){const _0x40bc94=a60_0x32b191;_0x29770c[_0x40bc94(0x101)]=_0x318252;}),__decorate=this&&this[a60_0x32b191(0x103)]||function(_0x111d1e,_0x994dce,_0xcaa208,_0x130943){const _0x45d9ce=a60_0x32b191;var _0x1e2b17=arguments[_0x45d9ce(0x14d)],_0x1386af=_0x1e2b17<0x3?_0x994dce:_0x130943===null?_0x130943=Object[_0x45d9ce(0x145)](_0x994dce,_0xcaa208):_0x130943,_0x1cf226;if(typeof Reflect===_0x45d9ce(0x12e)&&typeof Reflect[_0x45d9ce(0xfe)]===_0x45d9ce(0x144))_0x1386af=Reflect[_0x45d9ce(0xfe)](_0x111d1e,_0x994dce,_0xcaa208,_0x130943);else{for(var _0x13a428=_0x111d1e['length']-0x1;_0x13a428>=0x0;_0x13a428--)if(_0x1cf226=_0x111d1e[_0x13a428])_0x1386af=(_0x1e2b17<0x3?_0x1cf226(_0x1386af):_0x1e2b17>0x3?_0x1cf226(_0x994dce,_0xcaa208,_0x1386af):_0x1cf226(_0x994dce,_0xcaa208))||_0x1386af;}return _0x1e2b17>0x3&&_0x1386af&&Object['defineProperty'](_0x994dce,_0xcaa208,_0x1386af),_0x1386af;},__importStar=this&&this[a60_0x32b191(0x15a)]||function(_0x4c6561){const _0x153bd3=a60_0x32b191;if(_0x4c6561&&_0x4c6561[_0x153bd3(0x129)])return _0x4c6561;var _0x54d90b={};if(_0x4c6561!=null){for(var _0x52dd20 in _0x4c6561)if(_0x52dd20!==_0x153bd3(0x101)&&Object[_0x153bd3(0x151)][_0x153bd3(0x16e)][_0x153bd3(0x130)](_0x4c6561,_0x52dd20))__createBinding(_0x54d90b,_0x4c6561,_0x52dd20);}return __setModuleDefault(_0x54d90b,_0x4c6561),_0x54d90b;},__importDefault=this&&this['__importDefault']||function(_0x10398b){const _0x2f9905=a60_0x32b191;return _0x10398b&&_0x10398b[_0x2f9905(0x129)]?_0x10398b:{'default':_0x10398b};};function a60_0x3ec5(){const _0x3fffa3=['__createBinding','\x20Deleted\x20','groupComponentsByFileName','name','toString','../utils/mdapi.utils','SFDXUtils','exec','711EeaKzQ','prepareMdapi','prefix','../../providers/providers.tokens','sfdxUtils','now','startTime','\x20Wrote\x20','CommitComponentsJob','../../../shared/utils','://','push','defineProperty','\x20Prepare\x20mdapi\x20files.','../../providers/types/git-provider','18iokFdB','isEmptyDir','copyMdapiTo','log','reduce','componentsToDelete','(((.+)+)+)+$','6815120zOpDhN','280RVFenx','provider','\x20Copying\x20mdapi\x20to\x20git\x20folder.','components','splice','\x20Preparing\x20to\x20delete\x20components','__esModule','search','force','catch','Service','object','run','call','../../parsers/data/child-types','removeComponents','15201960ddMwDd','MDApiUtils','\x20Start\x20cloning\x20repository.','force-app','../dto/commit-components.dto','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','COMPONENTS_PER_TICK','commitData','8901630xCtcjJ','get','createProjectFrom','dir','commitAndPush','\x20Nothing\x20to\x20commit.\x20Skip.','getGitShellAuthorizationString','3678656IRAKGO','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','function','getOwnPropertyDescriptor','__setModuleDefault','getProtocol','replace','deleted','clearDir','error','CommitComponentsDto','length','removeDir','\x20components','GitUtils','prototype','clone','mdapiUtils','isSFDXProject','send','getRemote','writeFlosumComponents','SFDX','path','__importStar','fileName','\x20Checking\x20deleted\x20components.','GitProvider','../../providers/api/bitbucket-api.service','apply','Tokens','5EORBtB','branch','../../internal/fs.internal','BitbucketApiService','type','componentsToWrite','includes','writeComponents','9321179uHpYII','\x20Preparing\x20to\x20write\x20components','ms.\x20Committed\x20components\x20-\x20','sort','values','hasOwnProperty','../../salesforce/utils/sfdx.utils','1178271SueuWI','writed','sfLogger','gitUrl','\x20Checking\x20written\x20components.','../../../../constants','decorate','cleanUp','DEFAULT_GIT_USER_EMAIL','default','gitUtils','__decorate'];a60_0x3ec5=function(){return _0x3fffa3;};return a60_0x3ec5();}Object[a60_0x32b191(0x118)](exports,'__esModule',{'value':!![]}),exports[a60_0x32b191(0x114)]=void 0x0;function a60_0x3476(_0x383138,_0x506afa){const _0x17beff=a60_0x3ec5();return a60_0x3476=function(_0x2d725a,_0x2e4174){_0x2d725a=_0x2d725a-0xfb;let _0x3ec532=_0x17beff[_0x2d725a];return _0x3ec532;},a60_0x3476(_0x383138,_0x506afa);}const commit_components_dto_1=require(a60_0x32b191(0x137)),events_1=__importDefault(require('events')),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a60_0x32b191(0x109)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a60_0x32b191(0x131))),utils_1=require(a60_0x32b191(0x115)),constants_1=require(a60_0x32b191(0xfd)),git_provider_1=require(a60_0x32b191(0x11a)),bitbucket_api_service_1=require(a60_0x32b191(0x15e)),sfdx_utils_2=require(a60_0x32b191(0x16f)),fs_internal_1=require(a60_0x32b191(0x163)),path_1=require(a60_0x32b191(0x159)),providers_tokens_1=require(a60_0x32b191(0x10f));let CommitComponentsJob=class CommitComponentsJob extends events_1[a60_0x32b191(0x101)]{constructor(){const _0x3d2ba9=a60_0x32b191;super(...arguments),this[_0x3d2ba9(0x139)]=0x3e8,this[_0x3d2ba9(0x166)]=0x0,this['componentsToDelete']=0x0,this['startTime']=Date[_0x3d2ba9(0x111)]();}async[a60_0x32b191(0x156)](){const _0x47d74c=a60_0x32b191,{repo:_0x3239cc}=this[_0x47d74c(0x13a)],_0x4d36ff=typedi_1[_0x47d74c(0x101)]['get'](providers_tokens_1[_0x47d74c(0x160)]['credentials']);if(this[_0x47d74c(0x13a)][_0x47d74c(0x124)]===git_provider_1[_0x47d74c(0x15d)]['Bitbucket']){const _0x33d4a7=typedi_1[_0x47d74c(0x101)][_0x47d74c(0x13c)](bitbucket_api_service_1[_0x47d74c(0x164)]);await _0x33d4a7['isLoggedIn']();}return _0x3239cc[_0x47d74c(0xfb)][_0x47d74c(0x148)](/http(s)?:\/\/(.+@)?/,utils_1[_0x47d74c(0x147)](_0x3239cc[_0x47d74c(0xfb)])+_0x47d74c(0x116)+_0x4d36ff[_0x47d74c(0x141)]()+'@');}[a60_0x32b191(0x106)](_0x3e7b5c){const _0x4fd0c7=a60_0x32b191;var _0x32fc02;_0x3e7b5c[_0x4fd0c7(0x16c)](_0x23d90d=>child_types_1['default'][_0x4fd0c7(0x167)](_0x23d90d['fileType'])?0x1:-0x1);const _0xa48c92={};for(const _0x3e3479 of _0x3e7b5c){_0xa48c92[_0x32fc02=_0x3e3479[_0x4fd0c7(0x15b)]]||(_0xa48c92[_0x32fc02]=[]),_0xa48c92[_0x3e3479['fileName']][_0x4fd0c7(0x117)](_0x3e3479);}return Object[_0x4fd0c7(0x16d)](_0xa48c92)[_0x4fd0c7(0x11f)]((_0x52983a,_0x86e108)=>[..._0x52983a,..._0x86e108],[]);}async[a60_0x32b191(0x168)](_0x140b67){const _0x573202=a60_0x32b191;_0x140b67=this[_0x573202(0x106)](_0x140b67);let _0x5ed5f7=0x0;while(_0x140b67[_0x573202(0x14d)]){const _0x3dcd5f=_0x140b67[_0x573202(0x127)](0x0,this[_0x573202(0x139)]);await this[_0x573202(0x153)][_0x573202(0x157)](_0x3dcd5f,{'skipChildErrors':this[_0x573202(0x13a)][_0x573202(0x162)][_0x573202(0x107)]==='master'}),_0x5ed5f7+=_0x3dcd5f[_0x573202(0x14d)],this[_0x573202(0x172)]['log'](this[_0x573202(0x10e)]+_0x573202(0x113)+_0x5ed5f7+'/'+this[_0x573202(0x166)]+'\x20components'),await this[_0x573202(0x172)][_0x573202(0x155)]();}}async['removeComponents'](_0x84b910){const _0x1f6bbd=a60_0x32b191;_0x84b910[_0x1f6bbd(0x16c)](_0x66bf2b=>child_types_1[_0x1f6bbd(0x101)]['includes'](_0x66bf2b[_0x1f6bbd(0x165)])?-0x1:0x1);let _0x4a1fca=0x0;while(_0x84b910[_0x1f6bbd(0x14d)]){const _0xbac881=_0x84b910['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x1f6bbd(0x153)][_0x1f6bbd(0x132)](_0xbac881),_0x4a1fca+=_0xbac881[_0x1f6bbd(0x14d)],this['sfLogger'][_0x1f6bbd(0x11e)](this[_0x1f6bbd(0x10e)]+_0x1f6bbd(0x105)+_0x4a1fca+'/'+this[_0x1f6bbd(0x120)]+_0x1f6bbd(0x14f)),await this[_0x1f6bbd(0x172)][_0x1f6bbd(0x155)]();}}async['cleanUp'](){const _0x41ef65=a60_0x32b191;this['gitUtils']&&await this[_0x41ef65(0x102)][_0x41ef65(0x14e)]()[_0x41ef65(0x12c)](()=>void 0x0),this['mdapiUtils']&&await this[_0x41ef65(0x153)]['removeDir']()[_0x41ef65(0x12c)](()=>void 0x0),this[_0x41ef65(0x110)]&&await this[_0x41ef65(0x110)][_0x41ef65(0x14e)]()[_0x41ef65(0x12c)](()=>void 0x0);}async['exec'](){const _0x415972=a60_0x32b191,{repo:_0x302415,branch:_0x5576ed,components:_0x515c80,convertToSFDX:_0x2a8fae,message:_0x4c669a,user:_0x35c165}=this[_0x415972(0x13a)];this[_0x415972(0x153)]=new mdapi_utils_1[(_0x415972(0x134))](),this[_0x415972(0x102)]=new git_utils_1[(_0x415972(0x150))](await this[_0x415972(0x156)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x415972(0x10a))]();let _0x56351d=_0x2a8fae;try{await this['sfLogger'][_0x415972(0x11e)](this[_0x415972(0x10e)]+_0x415972(0x135))[_0x415972(0x155)](),await this[_0x415972(0x102)][_0x415972(0x152)](_0x5576ed[_0x415972(0x107)],_0x302415[_0x415972(0x107)]);!this[_0x415972(0x13a)][_0x415972(0x12b)]?(this[_0x415972(0x172)][_0x415972(0x11e)](this[_0x415972(0x10e)]+_0x415972(0x119)),await this[_0x415972(0x153)][_0x415972(0x10d)](this[_0x415972(0x102)][_0x415972(0x13e)])):this['sfLogger'][_0x415972(0x11e)](this['prefix']+_0x415972(0x138));await this['sfLogger']['log'](this[_0x415972(0x10e)]+_0x415972(0xfc))['send']();_0x515c80[_0x415972(0x171)]&&(this['sfLogger'][_0x415972(0x11e)](this[_0x415972(0x10e)]+_0x415972(0x16a)),this[_0x415972(0x166)]=_0x515c80[_0x415972(0x171)]['length'],await this[_0x415972(0x168)](_0x515c80[_0x415972(0x171)]),await this[_0x415972(0x172)][_0x415972(0x155)]());await this[_0x415972(0x172)][_0x415972(0x11e)](this[_0x415972(0x10e)]+_0x415972(0x15c))[_0x415972(0x155)]();_0x515c80[_0x415972(0x149)]&&(this['sfLogger'][_0x415972(0x11e)](this[_0x415972(0x10e)]+_0x415972(0x128)),this['componentsToDelete']=_0x515c80['deleted'][_0x415972(0x14d)],await this[_0x415972(0x132)](_0x515c80[_0x415972(0x149)]),await this[_0x415972(0x172)][_0x415972(0x155)]());await this['sfLogger'][_0x415972(0x155)]();const _0x56be4d=await fs_internal_1['FS'][_0x415972(0x11c)](this['gitUtils'][_0x415972(0x13e)]);await sfdx_utils_2[_0x415972(0x158)][_0x415972(0x154)](this[_0x415972(0x102)]['dir'])?(_0x56351d=!![],await fs_internal_1['FS']['removeDir'](path_1['join'](this[_0x415972(0x102)][_0x415972(0x13e)],_0x415972(0x136)))):(_0x56351d&&(!_0x56be4d&&(_0x56351d=![])),await this[_0x415972(0x102)][_0x415972(0x14a)]());_0x56351d?(await this['sfLogger'][_0x415972(0x11e)](this[_0x415972(0x10e)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x415972(0x155)](),await this[_0x415972(0x110)][_0x415972(0x13d)](this[_0x415972(0x153)][_0x415972(0x13e)]),await this['sfdxUtils']['copyProjectTo'](this['gitUtils'][_0x415972(0x13e)],!_0x56be4d),await this[_0x415972(0x110)]['removeDir']()):(await this[_0x415972(0x172)][_0x415972(0x11e)](this[_0x415972(0x10e)]+_0x415972(0x125))['send'](),await this[_0x415972(0x153)][_0x415972(0x11d)](this['gitUtils'][_0x415972(0x13e)]));await this['sfLogger'][_0x415972(0x11e)](this[_0x415972(0x10e)]+_0x415972(0x143))['send'](),await this[_0x415972(0x102)][_0x415972(0x13f)](_0x4c669a,{'email':constants_1[_0x415972(0x100)],'name':_0x35c165[_0x415972(0x107)]},_0x5576ed['name']),await this[_0x415972(0x102)][_0x415972(0x14e)](),await this['mdapiUtils'][_0x415972(0x14e)]();const _0x4c4547=this[_0x415972(0x166)]+this[_0x415972(0x120)];await this[_0x415972(0x172)][_0x415972(0x11e)](this[_0x415972(0x10e)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x415972(0x111)]()-this[_0x415972(0x112)])+_0x415972(0x16b)+_0x4c4547+'.')[_0x415972(0x155)]();}catch(_0x42ddef){await this[_0x415972(0xff)](),await this[_0x415972(0x172)][_0x415972(0x14b)](this[_0x415972(0x10e)]+'\x20'+_0x42ddef)[_0x415972(0x155)]();throw _0x42ddef;}}async[a60_0x32b191(0x12f)](_0x4dfb3e,_0x2b8033){const _0x5986d6=a60_0x32b191;var _0x441239,_0x254939;this[_0x5986d6(0x172)]=typedi_1[_0x5986d6(0x101)][_0x5986d6(0x13c)](providers_tokens_1['Tokens']['logger']),this[_0x5986d6(0x10e)]=(_0x2b8033?_0x2b8033+'\x20':'')+'['+commit_components_dto_1[_0x5986d6(0x14c)][_0x5986d6(0x107)]+']',await this[_0x5986d6(0x172)]['log'](this[_0x5986d6(0x10e)]+'\x20Checking\x20commit\x20components.');const _0x531de0=!!((_0x441239=_0x4dfb3e[_0x5986d6(0x126)])===null||_0x441239===void 0x0?void 0x0:_0x441239['writed'])||!!((_0x254939=_0x4dfb3e[_0x5986d6(0x126)])===null||_0x254939===void 0x0?void 0x0:_0x254939['deleted']);if(!_0x531de0){await this[_0x5986d6(0x172)]['log'](this[_0x5986d6(0x10e)]+_0x5986d6(0x140))[_0x5986d6(0x155)]();return;}this['commitData']=_0x4dfb3e,await this[_0x5986d6(0x10b)]();}};CommitComponentsJob=__decorate([typedi_1[a60_0x32b191(0x12d)]({'transient':!![]})],CommitComponentsJob),exports[a60_0x32b191(0x114)]=CommitComponentsJob;