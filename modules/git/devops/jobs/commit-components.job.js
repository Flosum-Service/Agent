const a106_0x443ad5=a106_0x3e9d;(function(_0x1b9fba,_0x48f369){const _0x135262=a106_0x3e9d,_0x18ba61=_0x1b9fba();while(!![]){try{const _0xe50034=-parseInt(_0x135262(0xc4))/0x1*(parseInt(_0x135262(0xa9))/0x2)+parseInt(_0x135262(0x7c))/0x3+-parseInt(_0x135262(0x78))/0x4+-parseInt(_0x135262(0x82))/0x5*(parseInt(_0x135262(0xa7))/0x6)+-parseInt(_0x135262(0xac))/0x7*(parseInt(_0x135262(0x98))/0x8)+-parseInt(_0x135262(0xed))/0x9*(-parseInt(_0x135262(0xb8))/0xa)+parseInt(_0x135262(0xd8))/0xb;if(_0xe50034===_0x48f369)break;else _0x18ba61['push'](_0x18ba61['shift']());}catch(_0x23a0e4){_0x18ba61['push'](_0x18ba61['shift']());}}}(a106_0x113b,0x76dab));const a106_0x376e4=(function(){let _0x4af3d8=!![];return function(_0x479c4d,_0x5c08b2){const _0x2833c7=_0x4af3d8?function(){const _0x2006db=a106_0x3e9d;if(_0x5c08b2){const _0x387c9b=_0x5c08b2[_0x2006db(0xd9)](_0x479c4d,arguments);return _0x5c08b2=null,_0x387c9b;}}:function(){};return _0x4af3d8=![],_0x2833c7;};}()),a106_0x25efed=a106_0x376e4(this,function(){const _0x4c7661=a106_0x3e9d;return a106_0x25efed[_0x4c7661(0xd6)]()[_0x4c7661(0xcb)]('(((.+)+)+)+$')[_0x4c7661(0xd6)]()[_0x4c7661(0x7f)](a106_0x25efed)[_0x4c7661(0xcb)](_0x4c7661(0xde));});a106_0x25efed();'use strict';var __createBinding=this&&this[a106_0x443ad5(0xe6)]||(Object[a106_0x443ad5(0xc5)]?function(_0x37f1d7,_0x43dca2,_0x3f4bd7,_0x5b1e4c){const _0x1afbb3=a106_0x443ad5;if(_0x5b1e4c===undefined)_0x5b1e4c=_0x3f4bd7;var _0x4edc12=Object[_0x1afbb3(0xeb)](_0x43dca2,_0x3f4bd7);(!_0x4edc12||(_0x1afbb3(0xb6)in _0x4edc12?!_0x43dca2[_0x1afbb3(0x8c)]:_0x4edc12['writable']||_0x4edc12[_0x1afbb3(0xdd)]))&&(_0x4edc12={'enumerable':!![],'get':function(){return _0x43dca2[_0x3f4bd7];}}),Object[_0x1afbb3(0xa1)](_0x37f1d7,_0x5b1e4c,_0x4edc12);}:function(_0x765d50,_0x8e94ad,_0x4af127,_0x2fa40f){if(_0x2fa40f===undefined)_0x2fa40f=_0x4af127;_0x765d50[_0x2fa40f]=_0x8e94ad[_0x4af127];}),__setModuleDefault=this&&this[a106_0x443ad5(0xdf)]||(Object[a106_0x443ad5(0xc5)]?function(_0x1e2ea1,_0x100dcd){const _0x1cf199=a106_0x443ad5;Object[_0x1cf199(0xa1)](_0x1e2ea1,_0x1cf199(0xbb),{'enumerable':!![],'value':_0x100dcd});}:function(_0x3830c9,_0x1225b5){const _0x5c66f2=a106_0x443ad5;_0x3830c9[_0x5c66f2(0xbb)]=_0x1225b5;}),__decorate=this&&this['__decorate']||function(_0x4b9759,_0x45d887,_0x3ac357,_0x18f946){const _0x20de49=a106_0x443ad5;var _0x11ef0d=arguments[_0x20de49(0x85)],_0x4f319c=_0x11ef0d<0x3?_0x45d887:_0x18f946===null?_0x18f946=Object[_0x20de49(0xeb)](_0x45d887,_0x3ac357):_0x18f946,_0x963d5c;if(typeof Reflect===_0x20de49(0x88)&&typeof Reflect['decorate']==='function')_0x4f319c=Reflect[_0x20de49(0x94)](_0x4b9759,_0x45d887,_0x3ac357,_0x18f946);else{for(var _0x15c681=_0x4b9759['length']-0x1;_0x15c681>=0x0;_0x15c681--)if(_0x963d5c=_0x4b9759[_0x15c681])_0x4f319c=(_0x11ef0d<0x3?_0x963d5c(_0x4f319c):_0x11ef0d>0x3?_0x963d5c(_0x45d887,_0x3ac357,_0x4f319c):_0x963d5c(_0x45d887,_0x3ac357))||_0x4f319c;}return _0x11ef0d>0x3&&_0x4f319c&&Object[_0x20de49(0xa1)](_0x45d887,_0x3ac357,_0x4f319c),_0x4f319c;},__importStar=this&&this[a106_0x443ad5(0xd1)]||function(_0x1afc77){const _0x2c0d19=a106_0x443ad5;if(_0x1afc77&&_0x1afc77[_0x2c0d19(0x8c)])return _0x1afc77;var _0x423970={};if(_0x1afc77!=null){for(var _0x31a70d in _0x1afc77)if(_0x31a70d!==_0x2c0d19(0xbb)&&Object[_0x2c0d19(0x80)][_0x2c0d19(0xab)][_0x2c0d19(0x9e)](_0x1afc77,_0x31a70d))__createBinding(_0x423970,_0x1afc77,_0x31a70d);}return __setModuleDefault(_0x423970,_0x1afc77),_0x423970;},__importDefault=this&&this['__importDefault']||function(_0x48d141){const _0x2eda08=a106_0x443ad5;return _0x48d141&&_0x48d141[_0x2eda08(0x8c)]?_0x48d141:{'default':_0x48d141};};Object['defineProperty'](exports,a106_0x443ad5(0x8c),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require('events')),git_utils_1=require(a106_0x443ad5(0x84)),mdapi_utils_1=require(a106_0x443ad5(0xb0)),sfdx_utils_1=require(a106_0x443ad5(0x95)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a106_0x443ad5(0xaa)),constants_1=require(a106_0x443ad5(0xcc)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require(a106_0x443ad5(0xe5)),sfdx_utils_2=require(a106_0x443ad5(0x99)),fs_internal_1=require(a106_0x443ad5(0xea)),path_1=require(a106_0x443ad5(0x8a)),providers_tokens_1=require(a106_0x443ad5(0x7d)),constants_2=require(a106_0x443ad5(0xcc));let CommitComponentsJob=class CommitComponentsJob extends events_1[a106_0x443ad5(0xbb)]{constructor(){const _0x310d04=a106_0x443ad5;super(...arguments),this[_0x310d04(0xbe)]=0x3e8,this[_0x310d04(0x8d)]=0x0,this[_0x310d04(0x7e)]=0x0,this[_0x310d04(0xaf)]=Date[_0x310d04(0xa2)]();}async[a106_0x443ad5(0x7a)](){const _0x303d10=a106_0x443ad5,{repo:_0x4d60ac}=this[_0x303d10(0xc8)],_0x1f934d=typedi_1[_0x303d10(0xbb)]['get'](providers_tokens_1[_0x303d10(0xee)][_0x303d10(0xb2)]);if(this[_0x303d10(0xc8)][_0x303d10(0xb3)]===git_provider_1[_0x303d10(0xd3)][_0x303d10(0x97)]){const _0xddadcf=typedi_1[_0x303d10(0xbb)][_0x303d10(0xb6)](bitbucket_api_service_1[_0x303d10(0xe7)]);await _0xddadcf['isLoggedIn']();}return _0x4d60ac[_0x303d10(0xd4)][_0x303d10(0xd5)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x4d60ac[_0x303d10(0xd4)])+_0x303d10(0x96)+_0x1f934d[_0x303d10(0xbd)]()+'@');}['groupComponentsByFileName'](_0x45b5c6){const _0x32f556=a106_0x443ad5;var _0xa83c1;_0x45b5c6[_0x32f556(0x90)](_0x88884b=>child_types_1[_0x32f556(0xbb)][_0x32f556(0xce)](_0x88884b[_0x32f556(0xc1)])?0x1:-0x1);const _0x3ff807={};for(const _0x1f1619 of _0x45b5c6){_0x3ff807[_0xa83c1=_0x1f1619['fileName']]||(_0x3ff807[_0xa83c1]=[]),_0x3ff807[_0x1f1619['fileName']][_0x32f556(0xe9)](_0x1f1619);}return Object['values'](_0x3ff807)[_0x32f556(0xc3)]((_0x3e2d99,_0x3b556b)=>[..._0x3e2d99,..._0x3b556b],[]);}async['writeComponents'](_0x480e48){const _0x5da59c=a106_0x443ad5;_0x480e48=this[_0x5da59c(0x83)](_0x480e48);let _0xeb3c39=0x0;while(_0x480e48[_0x5da59c(0x85)]){const _0x40d375=_0x480e48[_0x5da59c(0x8f)](0x0,this[_0x5da59c(0xbe)]);await this[_0x5da59c(0xc2)][_0x5da59c(0xb4)](_0x40d375,{'skipChildErrors':this['commitData']['branch']['name']===_0x5da59c(0xbf),'recordType':this[_0x5da59c(0xc8)][_0x5da59c(0xe8)]}),_0xeb3c39+=_0x40d375[_0x5da59c(0x85)],this[_0x5da59c(0xc7)][_0x5da59c(0x91)](this[_0x5da59c(0xa8)]+_0x5da59c(0x92)+_0xeb3c39+'/'+this[_0x5da59c(0x8d)]+'\x20components'),await this[_0x5da59c(0xc7)][_0x5da59c(0xc9)]();}}async[a106_0x443ad5(0xe0)](_0xe6df65){const _0x39e71c=a106_0x443ad5;_0xe6df65['sort'](_0x472300=>child_types_1[_0x39e71c(0xbb)][_0x39e71c(0xce)](_0x472300[_0x39e71c(0x9c)])?-0x1:0x1);let _0x5bc8d4=0x0;while(_0xe6df65['length']){const _0x329dc5=_0xe6df65[_0x39e71c(0x8f)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x39e71c(0xc2)]['removeComponents'](_0x329dc5,this[_0x39e71c(0xc8)][_0x39e71c(0xe8)]),_0x5bc8d4+=_0x329dc5['length'],this[_0x39e71c(0xc7)]['log'](this[_0x39e71c(0xa8)]+'\x20Deleted\x20'+_0x5bc8d4+'/'+this['componentsToDelete']+'\x20components'),await this[_0x39e71c(0xc7)]['send']();}}async['cleanUp'](){const _0x14a56e=a106_0x443ad5;this[_0x14a56e(0x86)]&&await this[_0x14a56e(0x86)][_0x14a56e(0x79)]()[_0x14a56e(0xba)](()=>void 0x0),this[_0x14a56e(0xc2)]&&await this[_0x14a56e(0xc2)]['removeDir']()[_0x14a56e(0xba)](()=>void 0x0),this[_0x14a56e(0x9a)]&&await this[_0x14a56e(0x9a)]['removeDir']()['catch'](()=>void 0x0);}async['exec'](){const _0x37af0f=a106_0x443ad5,{repo:_0x1ac138,branch:_0x1c70c0,components:_0x51c4b3,convertToSFDX:_0x4a9a63,message:_0x34c12e,user:_0x516f61}=this[_0x37af0f(0xc8)];this['mdapiUtils']=new mdapi_utils_1['MDApiUtils'](),this[_0x37af0f(0x86)]=new git_utils_1[(_0x37af0f(0xbc))](await this['getRemote']()),this[_0x37af0f(0x9a)]=new sfdx_utils_1[(_0x37af0f(0xe3))]();let _0x583ef4=_0x4a9a63&&this[_0x37af0f(0x9a)][_0x37af0f(0xdb)](this['commitData'][_0x37af0f(0xe8)]);try{await this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this['prefix']+_0x37af0f(0x93))[_0x37af0f(0xc9)](),await this[_0x37af0f(0x86)]['clone'](_0x1c70c0['name'],_0x1ac138[_0x37af0f(0xb9)]);!this[_0x37af0f(0xc8)][_0x37af0f(0xe1)]?(this[_0x37af0f(0xc7)]['log'](this[_0x37af0f(0xa8)]+_0x37af0f(0xa4)),await this[_0x37af0f(0xc2)][_0x37af0f(0xd7)](this['gitUtils'][_0x37af0f(0x87)])):this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+_0x37af0f(0xda));await this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+_0x37af0f(0xb1))[_0x37af0f(0xc9)]();_0x51c4b3['writed']&&(this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this['prefix']+_0x37af0f(0x8b)),this[_0x37af0f(0x8d)]=_0x51c4b3[_0x37af0f(0xd0)][_0x37af0f(0x85)],await this[_0x37af0f(0xa5)](_0x51c4b3['writed']),await this[_0x37af0f(0xc7)][_0x37af0f(0xc9)]());await this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+_0x37af0f(0xc0))['send']();_0x51c4b3[_0x37af0f(0xae)]&&(this['sfLogger'][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+_0x37af0f(0xb7)),this[_0x37af0f(0x7e)]=_0x51c4b3[_0x37af0f(0xae)]['length'],await this[_0x37af0f(0xe0)](_0x51c4b3[_0x37af0f(0xae)]),await this[_0x37af0f(0xc7)][_0x37af0f(0xc9)]());await this['sfLogger']['send']();const _0x57f0c1=await fs_internal_1['FS'][_0x37af0f(0x9b)](this[_0x37af0f(0x86)]['dir']);await sfdx_utils_2['SFDX'][_0x37af0f(0xe2)](this[_0x37af0f(0x86)][_0x37af0f(0x87)])?(_0x583ef4=!![],await fs_internal_1['FS'][_0x37af0f(0x79)]((0x0,path_1[_0x37af0f(0x8e)])(this[_0x37af0f(0x86)]['dir'],_0x37af0f(0xcd)))):(_0x583ef4&&(!_0x57f0c1&&(_0x583ef4=![])),await this[_0x37af0f(0x86)][_0x37af0f(0xc6)]());_0x583ef4?(await this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+_0x37af0f(0xa6))['send'](),await this['sfdxUtils'][_0x37af0f(0xcf)](this[_0x37af0f(0xc2)][_0x37af0f(0x87)]),await this[_0x37af0f(0x9a)][_0x37af0f(0xa3)](this[_0x37af0f(0x86)][_0x37af0f(0x87)],!_0x57f0c1),await this[_0x37af0f(0x9a)][_0x37af0f(0xdc)](this[_0x37af0f(0xc2)][_0x37af0f(0x87)],(0x0,path_1[_0x37af0f(0x8e)])(this[_0x37af0f(0x86)][_0x37af0f(0x87)],constants_2[_0x37af0f(0x9d)])),await this[_0x37af0f(0x9a)][_0x37af0f(0x79)]()):(await this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x37af0f(0xc9)](),await this['mdapiUtils']['copyMdapiTo'](this[_0x37af0f(0x86)][_0x37af0f(0x87)]));await this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+_0x37af0f(0x9f))[_0x37af0f(0xc9)](),await this['gitUtils']['commitAndPush'](_0x34c12e,{'email':constants_1[_0x37af0f(0xca)],'name':_0x516f61[_0x37af0f(0xb9)]},_0x1c70c0[_0x37af0f(0xb9)]),await this[_0x37af0f(0x86)][_0x37af0f(0x79)](),await this['mdapiUtils'][_0x37af0f(0x79)]();const _0x103ce3=this[_0x37af0f(0x8d)]+this[_0x37af0f(0x7e)];await this[_0x37af0f(0xc7)][_0x37af0f(0x91)](this[_0x37af0f(0xa8)]+_0x37af0f(0x81)+(Date[_0x37af0f(0xa2)]()-this['startTime'])+_0x37af0f(0xec)+_0x103ce3+'.')['send']();}catch(_0x4fcca0){await this[_0x37af0f(0xe4)](),await this[_0x37af0f(0xc7)]['error'](this[_0x37af0f(0xa8)]+'\x20'+_0x4fcca0)[_0x37af0f(0xc9)]();throw _0x4fcca0;}}async[a106_0x443ad5(0xad)](_0x12e607,_0x126c92){const _0x505f86=a106_0x443ad5;var _0x564160,_0x2d8b23;this['sfLogger']=typedi_1[_0x505f86(0xbb)][_0x505f86(0xb6)](providers_tokens_1[_0x505f86(0xee)][_0x505f86(0xb5)]),this[_0x505f86(0xa8)]=(_0x126c92?_0x126c92+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto'][_0x505f86(0xb9)]+']',await this['sfLogger'][_0x505f86(0x91)](this['prefix']+'\x20Checking\x20commit\x20components.');const _0x248e28=!!((_0x564160=_0x12e607[_0x505f86(0x89)])===null||_0x564160===void 0x0?void 0x0:_0x564160[_0x505f86(0xd0)])||!!((_0x2d8b23=_0x12e607[_0x505f86(0x89)])===null||_0x2d8b23===void 0x0?void 0x0:_0x2d8b23[_0x505f86(0xae)]);if(!_0x248e28){await this[_0x505f86(0xc7)][_0x505f86(0x91)](this['prefix']+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x505f86(0xc9)]();return;}this[_0x505f86(0xc8)]=_0x12e607,await this[_0x505f86(0xa0)]();}};function a106_0x3e9d(_0x1fe8f9,_0x11778b){const _0x11053d=a106_0x113b();return a106_0x3e9d=function(_0x25efed,_0x376e4){_0x25efed=_0x25efed-0x78;let _0x113bb7=_0x11053d[_0x25efed];return _0x113bb7;},a106_0x3e9d(_0x1fe8f9,_0x11778b);}CommitComponentsJob=__decorate([(0x0,typedi_1[a106_0x443ad5(0x7b)])({'transient':!![]})],CommitComponentsJob),exports[a106_0x443ad5(0xd2)]=CommitComponentsJob;function a106_0x113b(){const _0xf29a8f=['1016603myyKKz','run','deleted','startTime','../utils/mdapi.utils','\x20Checking\x20written\x20components.','credentials','provider','writeFlosumComponents','logger','get','\x20Preparing\x20to\x20delete\x20components','10lVBJir','name','catch','default','GitUtils','getGitShellAuthorizationString','COMPONENTS_PER_TICK','master','\x20Checking\x20deleted\x20components.','fileType','mdapiUtils','reduce','2286hJPLQw','create','clearDir','sfLogger','commitData','send','DEFAULT_GIT_USER_EMAIL','search','../../../../constants','force-app','includes','createProjectFrom','writed','__importStar','CommitComponentsJob','GitProvider','gitUrl','replace','toString','prepareMdapi','20827587ojSWXg','apply','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','isConvertToSfdx','copySFDXIgnoredComponents','configurable','(((.+)+)+)+$','__setModuleDefault','removeComponents','force','isSFDXProject','SFDXUtils','cleanUp','../../providers/api/bitbucket-api.service','__createBinding','BitbucketApiService','recordType','push','../../internal/fs.internal','getOwnPropertyDescriptor','ms.\x20Committed\x20components\x20-\x20','1977147vkUjHJ','Tokens','2641272TZbjjt','removeDir','getRemote','Service','1637190iCzojh','../../providers/providers.tokens','componentsToDelete','constructor','prototype','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','2296000MsNLqJ','groupComponentsByFileName','../utils/git.utils','length','gitUtils','dir','object','components','path','\x20Preparing\x20to\x20write\x20components','__esModule','componentsToWrite','join','splice','sort','log','\x20Wrote\x20','\x20Start\x20cloning\x20repository.','decorate','../utils/sfdx.utils','://','Bitbucket','8MyIYnW','../../salesforce/utils/sfdx.utils','sfdxUtils','isEmptyDir','type','FORCE_APP_DEFAULT_DIR','call','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','exec','defineProperty','now','copyProjectTo','\x20Prepare\x20mdapi\x20files.','writeComponents','\x20Start\x20converting\x20to\x20SFDX.','12sGtgzp','prefix','392LeTUBR','../../../shared/utils','hasOwnProperty'];a106_0x113b=function(){return _0xf29a8f;};return a106_0x113b();}