const a121_0x1086e2=a121_0x32e7;(function(_0x2c34ce,_0x5a2d85){const _0x3007c1=a121_0x32e7,_0x2ee65b=_0x2c34ce();while(!![]){try{const _0x1a43bd=-parseInt(_0x3007c1(0xac))/0x1+-parseInt(_0x3007c1(0xec))/0x2*(-parseInt(_0x3007c1(0xbd))/0x3)+-parseInt(_0x3007c1(0xd7))/0x4+parseInt(_0x3007c1(0xf2))/0x5*(parseInt(_0x3007c1(0xc9))/0x6)+parseInt(_0x3007c1(0xad))/0x7*(parseInt(_0x3007c1(0xb5))/0x8)+parseInt(_0x3007c1(0xaa))/0x9*(parseInt(_0x3007c1(0xc0))/0xa)+parseInt(_0x3007c1(0xd8))/0xb*(parseInt(_0x3007c1(0xd4))/0xc);if(_0x1a43bd===_0x5a2d85)break;else _0x2ee65b['push'](_0x2ee65b['shift']());}catch(_0x10f5f2){_0x2ee65b['push'](_0x2ee65b['shift']());}}}(a121_0x2692,0x59aff));const a121_0x18ede4=(function(){let _0x37d3f3=!![];return function(_0x23ba12,_0x5eb449){const _0x6cbd13=_0x37d3f3?function(){const _0x491dda=a121_0x32e7;if(_0x5eb449){const _0xb4ad36=_0x5eb449[_0x491dda(0xdd)](_0x23ba12,arguments);return _0x5eb449=null,_0xb4ad36;}}:function(){};return _0x37d3f3=![],_0x6cbd13;};}()),a121_0x3de0ac=a121_0x18ede4(this,function(){const _0x4f8d31=a121_0x32e7;return a121_0x3de0ac[_0x4f8d31(0xee)]()[_0x4f8d31(0x9b)](_0x4f8d31(0xed))['toString']()[_0x4f8d31(0xa1)](a121_0x3de0ac)['search']('(((.+)+)+)+$');});function a121_0x2692(){const _0x2a4fb8=['constructor','hasOwnProperty','startTime','prefix','Tokens','../../../../constants','../../../shared/utils','commitAndPush','sort','9NCWQTN','create','204486guKtlB','10346EaQZYq','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','getGitShellAuthorizationString','__setModuleDefault','reduce','default','clearDir','dir','384csaKLN','groupComponentsByFileName','function','includes','length','ms.\x20Committed\x20components\x20-\x20','componentsToWrite','log','8115tRrhxi','sfdxUtils','get','1347830iyiffQ','recordType','COMPONENTS_PER_TICK','../../internal/fs.internal','call','removeDir','prepareMdapi','send','cleanUp','6VIUeso','copyProjectTo','catch','\x20Checking\x20deleted\x20components.','__esModule','master','object','componentsToDelete','\x20Deleted\x20','isConvertToSfdx','\x20Nothing\x20to\x20commit.\x20Skip.','288516bZETdi','CommitComponentsJob','error','2396468mQNBlz','231ILBUOQ','sfLogger','exec','now','../../salesforce/utils/sfdx.utils','apply','replace','isEmptyDir','gitUtils','fileName','createProjectFrom','provider','getOwnPropertyDescriptor','type','run','name','__importDefault','deleted','BitbucketApiService','removeComponents','94SHwgRb','(((.+)+)+)+$','toString','../utils/sfdx.utils','typedi','decorate','1665985QzExWE','\x20Wrote\x20','force','clone','\x20Copying\x20mdapi\x20to\x20git\x20folder.','isLoggedIn','\x20Preparing\x20to\x20delete\x20components','getProtocol','\x20Prepare\x20mdapi\x20files.','fileType','\x20components','Bitbucket','defineProperty','prototype','gitUrl','../../providers/providers.tokens','DEFAULT_GIT_USER_EMAIL','splice','\x20Preparing\x20to\x20write\x20components','writeFlosumComponents','\x20Start\x20cloning\x20repository.','events','join','isSFDXProject','SFDXUtils','../utils/git.utils','\x20Checking\x20written\x20components.','values','mdapiUtils','writeComponents','__decorate','configurable','Service','search','commitData','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','GitUtils','../../providers/types/git-provider','writed'];a121_0x2692=function(){return _0x2a4fb8;};return a121_0x2692();}function a121_0x32e7(_0x4eadd8,_0xc527b8){const _0x240db0=a121_0x2692();return a121_0x32e7=function(_0x3de0ac,_0x18ede4){_0x3de0ac=_0x3de0ac-0x91;let _0x2692f8=_0x240db0[_0x3de0ac];return _0x2692f8;},a121_0x32e7(_0x4eadd8,_0xc527b8);}a121_0x3de0ac();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a121_0x1086e2(0xab)]?function(_0x1244f0,_0x475ebe,_0x3e2db8,_0xa62b32){const _0x36204b=a121_0x1086e2;if(_0xa62b32===undefined)_0xa62b32=_0x3e2db8;var _0x530eb2=Object[_0x36204b(0xe4)](_0x475ebe,_0x3e2db8);(!_0x530eb2||(_0x36204b(0xbf)in _0x530eb2?!_0x475ebe[_0x36204b(0xcd)]:_0x530eb2['writable']||_0x530eb2[_0x36204b(0x99)]))&&(_0x530eb2={'enumerable':!![],'get':function(){return _0x475ebe[_0x3e2db8];}}),Object[_0x36204b(0xfe)](_0x1244f0,_0xa62b32,_0x530eb2);}:function(_0x5a5356,_0x873abb,_0x410c7d,_0x4fd3b5){if(_0x4fd3b5===undefined)_0x4fd3b5=_0x410c7d;_0x5a5356[_0x4fd3b5]=_0x873abb[_0x410c7d];}),__setModuleDefault=this&&this[a121_0x1086e2(0xb0)]||(Object[a121_0x1086e2(0xab)]?function(_0x172fb8,_0x3eafbb){const _0x23edb3=a121_0x1086e2;Object[_0x23edb3(0xfe)](_0x172fb8,_0x23edb3(0xb2),{'enumerable':!![],'value':_0x3eafbb});}:function(_0x239f25,_0x3cfe83){const _0x13103f=a121_0x1086e2;_0x239f25[_0x13103f(0xb2)]=_0x3cfe83;}),__decorate=this&&this[a121_0x1086e2(0x98)]||function(_0x274616,_0x32a8cc,_0x1a0e8d,_0x1bddea){const _0x501e02=a121_0x1086e2;var _0x28e99e=arguments[_0x501e02(0xb9)],_0x30e237=_0x28e99e<0x3?_0x32a8cc:_0x1bddea===null?_0x1bddea=Object[_0x501e02(0xe4)](_0x32a8cc,_0x1a0e8d):_0x1bddea,_0x18c068;if(typeof Reflect===_0x501e02(0xcf)&&typeof Reflect[_0x501e02(0xf1)]===_0x501e02(0xb7))_0x30e237=Reflect[_0x501e02(0xf1)](_0x274616,_0x32a8cc,_0x1a0e8d,_0x1bddea);else{for(var _0x51b32c=_0x274616[_0x501e02(0xb9)]-0x1;_0x51b32c>=0x0;_0x51b32c--)if(_0x18c068=_0x274616[_0x51b32c])_0x30e237=(_0x28e99e<0x3?_0x18c068(_0x30e237):_0x28e99e>0x3?_0x18c068(_0x32a8cc,_0x1a0e8d,_0x30e237):_0x18c068(_0x32a8cc,_0x1a0e8d))||_0x30e237;}return _0x28e99e>0x3&&_0x30e237&&Object[_0x501e02(0xfe)](_0x32a8cc,_0x1a0e8d,_0x30e237),_0x30e237;},__importStar=this&&this['__importStar']||function(_0x48e423){const _0x371dbf=a121_0x1086e2;if(_0x48e423&&_0x48e423[_0x371dbf(0xcd)])return _0x48e423;var _0x35cd3d={};if(_0x48e423!=null){for(var _0x21bcc2 in _0x48e423)if(_0x21bcc2!==_0x371dbf(0xb2)&&Object[_0x371dbf(0xff)][_0x371dbf(0xa2)][_0x371dbf(0xc4)](_0x48e423,_0x21bcc2))__createBinding(_0x35cd3d,_0x48e423,_0x21bcc2);}return __setModuleDefault(_0x35cd3d,_0x48e423),_0x35cd3d;},__importDefault=this&&this[a121_0x1086e2(0xe8)]||function(_0xdbf3eb){const _0x463283=a121_0x1086e2;return _0xdbf3eb&&_0xdbf3eb[_0x463283(0xcd)]?_0xdbf3eb:{'default':_0xdbf3eb};};Object['defineProperty'](exports,a121_0x1086e2(0xcd),{'value':!![]}),exports[a121_0x1086e2(0xd5)]=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a121_0x1086e2(0x107))),git_utils_1=require(a121_0x1086e2(0x93)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a121_0x1086e2(0xef)),typedi_1=__importStar(require(a121_0x1086e2(0xf0))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a121_0x1086e2(0xa7)),constants_1=require('../../../../constants'),git_provider_1=require(a121_0x1086e2(0x9f)),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require(a121_0x1086e2(0xdc)),fs_internal_1=require(a121_0x1086e2(0xc3)),path_1=require('path'),providers_tokens_1=require(a121_0x1086e2(0x101)),constants_2=require(a121_0x1086e2(0xa6));let CommitComponentsJob=class CommitComponentsJob extends events_1[a121_0x1086e2(0xb2)]{constructor(){const _0x5e92f8=a121_0x1086e2;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x5e92f8(0xbb)]=0x0,this['componentsToDelete']=0x0,this[_0x5e92f8(0xa3)]=Date[_0x5e92f8(0xdb)]();}async['getRemote'](){const _0x59c340=a121_0x1086e2,{repo:_0x89c1e5}=this[_0x59c340(0x9c)],_0x23468b=typedi_1['default'][_0x59c340(0xbf)](providers_tokens_1[_0x59c340(0xa5)]['credentials']);if(this[_0x59c340(0x9c)][_0x59c340(0xe3)]===git_provider_1['GitProvider'][_0x59c340(0xfd)]){const _0x4ae294=typedi_1[_0x59c340(0xb2)][_0x59c340(0xbf)](bitbucket_api_service_1[_0x59c340(0xea)]);await _0x4ae294[_0x59c340(0xf7)]();}return _0x89c1e5[_0x59c340(0x100)][_0x59c340(0xde)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x59c340(0xf9)])(_0x89c1e5[_0x59c340(0x100)])+'://'+_0x23468b[_0x59c340(0xaf)]()+'@');}[a121_0x1086e2(0xb6)](_0x56c410){const _0x36509c=a121_0x1086e2;var _0x1b24f7;_0x56c410[_0x36509c(0xa9)](_0x4f2043=>child_types_1['default'][_0x36509c(0xb8)](_0x4f2043[_0x36509c(0xfb)])?0x1:-0x1);const _0x132770={};for(const _0x20c7f5 of _0x56c410){_0x132770[_0x1b24f7=_0x20c7f5[_0x36509c(0xe1)]]||(_0x132770[_0x1b24f7]=[]),_0x132770[_0x20c7f5[_0x36509c(0xe1)]]['push'](_0x20c7f5);}return Object[_0x36509c(0x95)](_0x132770)[_0x36509c(0xb1)]((_0x247405,_0x5c6e06)=>[..._0x247405,..._0x5c6e06],[]);}async['writeComponents'](_0x19d78d){const _0x21813c=a121_0x1086e2;_0x19d78d=this['groupComponentsByFileName'](_0x19d78d);let _0x428d29=0x0;while(_0x19d78d[_0x21813c(0xb9)]){const _0x5f3494=_0x19d78d[_0x21813c(0x103)](0x0,this[_0x21813c(0xc2)]);await this['mdapiUtils'][_0x21813c(0x105)](_0x5f3494,{'skipChildErrors':this['commitData']['branch'][_0x21813c(0xe7)]===_0x21813c(0xce),'recordType':this[_0x21813c(0x9c)][_0x21813c(0xc1)]}),_0x428d29+=_0x5f3494[_0x21813c(0xb9)],this['sfLogger'][_0x21813c(0xbc)](this['prefix']+_0x21813c(0xf3)+_0x428d29+'/'+this[_0x21813c(0xbb)]+_0x21813c(0xfc)),await this['sfLogger']['send']();}}async[a121_0x1086e2(0xeb)](_0x48428c){const _0x3c8fbd=a121_0x1086e2;_0x48428c[_0x3c8fbd(0xa9)](_0x159658=>child_types_1[_0x3c8fbd(0xb2)][_0x3c8fbd(0xb8)](_0x159658[_0x3c8fbd(0xe5)])?-0x1:0x1);let _0x244479=0x0;while(_0x48428c[_0x3c8fbd(0xb9)]){const _0x1bfec2=_0x48428c[_0x3c8fbd(0x103)](0x0,this[_0x3c8fbd(0xc2)]);await this['mdapiUtils'][_0x3c8fbd(0xeb)](_0x1bfec2,this['commitData'][_0x3c8fbd(0xc1)]),_0x244479+=_0x1bfec2[_0x3c8fbd(0xb9)],this[_0x3c8fbd(0xd9)]['log'](this[_0x3c8fbd(0xa4)]+_0x3c8fbd(0xd1)+_0x244479+'/'+this['componentsToDelete']+_0x3c8fbd(0xfc)),await this[_0x3c8fbd(0xd9)][_0x3c8fbd(0xc7)]();}}async['cleanUp'](){const _0x7bf570=a121_0x1086e2;this[_0x7bf570(0xe0)]&&await this['gitUtils'][_0x7bf570(0xc5)]()[_0x7bf570(0xcb)](()=>void 0x0),this['mdapiUtils']&&await this[_0x7bf570(0x96)]['removeDir']()[_0x7bf570(0xcb)](()=>void 0x0),this[_0x7bf570(0xbe)]&&await this[_0x7bf570(0xbe)]['removeDir']()['catch'](()=>void 0x0);}async[a121_0x1086e2(0xda)](){const _0x1ec8b7=a121_0x1086e2,{repo:_0xb170d4,branch:_0x29e2d2,components:_0x2854e6,convertToSFDX:_0x1df585,message:_0x4ce0ec,user:_0x277eab}=this[_0x1ec8b7(0x9c)];this[_0x1ec8b7(0x96)]=new mdapi_utils_1['MDApiUtils'](),this[_0x1ec8b7(0xe0)]=new git_utils_1[(_0x1ec8b7(0x9e))](await this['getRemote']()),this[_0x1ec8b7(0xbe)]=new sfdx_utils_1[(_0x1ec8b7(0x92))]();let _0x3bcb6a=_0x1df585&&this[_0x1ec8b7(0xbe)][_0x1ec8b7(0xd2)](this[_0x1ec8b7(0x9c)][_0x1ec8b7(0xc1)]);try{await this['sfLogger'][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+_0x1ec8b7(0x106))[_0x1ec8b7(0xc7)](),await this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xf5)](_0x29e2d2[_0x1ec8b7(0xe7)],_0xb170d4[_0x1ec8b7(0xe7)]);!this[_0x1ec8b7(0x9c)][_0x1ec8b7(0xf4)]?(this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+_0x1ec8b7(0xfa)),await this[_0x1ec8b7(0x96)][_0x1ec8b7(0xc6)](this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xb4)])):this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+_0x1ec8b7(0xae));await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this['prefix']+_0x1ec8b7(0x94))[_0x1ec8b7(0xc7)]();_0x2854e6[_0x1ec8b7(0xa0)]&&(this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+_0x1ec8b7(0x104)),this[_0x1ec8b7(0xbb)]=_0x2854e6[_0x1ec8b7(0xa0)]['length'],await this[_0x1ec8b7(0x97)](_0x2854e6[_0x1ec8b7(0xa0)]),await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xc7)]());await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+_0x1ec8b7(0xcc))[_0x1ec8b7(0xc7)]();_0x2854e6[_0x1ec8b7(0xe9)]&&(this[_0x1ec8b7(0xd9)]['log'](this['prefix']+_0x1ec8b7(0xf8)),this['componentsToDelete']=_0x2854e6[_0x1ec8b7(0xe9)][_0x1ec8b7(0xb9)],await this[_0x1ec8b7(0xeb)](_0x2854e6[_0x1ec8b7(0xe9)]),await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xc7)]());await this['sfLogger']['send']();const _0x2acd63=await fs_internal_1['FS'][_0x1ec8b7(0xdf)](this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xb4)]);await sfdx_utils_2['SFDX'][_0x1ec8b7(0x91)](this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xb4)])?(_0x3bcb6a=!![],await fs_internal_1['FS'][_0x1ec8b7(0xc5)]((0x0,path_1['join'])(this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xb4)],'force-app'))):(_0x3bcb6a&&(!_0x2acd63&&(_0x3bcb6a=![])),await this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xb3)]());_0x3bcb6a?(await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x1ec8b7(0xc7)](),await this[_0x1ec8b7(0xbe)][_0x1ec8b7(0xe2)](this[_0x1ec8b7(0x96)][_0x1ec8b7(0xb4)]),await this['sfdxUtils'][_0x1ec8b7(0xca)](this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xb4)],!_0x2acd63),await this['sfdxUtils']['copySFDXIgnoredComponents'](this['mdapiUtils']['dir'],(0x0,path_1[_0x1ec8b7(0x108)])(this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xb4)],constants_2['FORCE_APP_DEFAULT_DIR'])),await this['sfdxUtils'][_0x1ec8b7(0xc5)]()):(await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+_0x1ec8b7(0xf6))[_0x1ec8b7(0xc7)](),await this[_0x1ec8b7(0x96)]['copyMdapiTo'](this['gitUtils'][_0x1ec8b7(0xb4)]));await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xbc)](this['prefix']+_0x1ec8b7(0x9d))[_0x1ec8b7(0xc7)](),await this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xa8)](_0x4ce0ec,{'email':constants_1[_0x1ec8b7(0x102)],'name':_0x277eab[_0x1ec8b7(0xe7)]},_0x29e2d2['name']),await this[_0x1ec8b7(0xe0)][_0x1ec8b7(0xc5)](),await this[_0x1ec8b7(0x96)][_0x1ec8b7(0xc5)]();const _0x536057=this[_0x1ec8b7(0xbb)]+this[_0x1ec8b7(0xd0)];await this['sfLogger'][_0x1ec8b7(0xbc)](this[_0x1ec8b7(0xa4)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date['now']()-this[_0x1ec8b7(0xa3)])+_0x1ec8b7(0xba)+_0x536057+'.')[_0x1ec8b7(0xc7)]();}catch(_0x243ca8){await this[_0x1ec8b7(0xc8)](),await this[_0x1ec8b7(0xd9)][_0x1ec8b7(0xd6)](this['prefix']+'\x20'+_0x243ca8)[_0x1ec8b7(0xc7)]();throw _0x243ca8;}}async[a121_0x1086e2(0xe6)](_0x141731,_0x46d182){const _0x4e1a6d=a121_0x1086e2;var _0x2258c8,_0x202674;this[_0x4e1a6d(0xd9)]=typedi_1[_0x4e1a6d(0xb2)]['get'](providers_tokens_1[_0x4e1a6d(0xa5)]['logger']),this[_0x4e1a6d(0xa4)]=(_0x46d182?_0x46d182+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto'][_0x4e1a6d(0xe7)]+']',await this[_0x4e1a6d(0xd9)][_0x4e1a6d(0xbc)](this[_0x4e1a6d(0xa4)]+'\x20Checking\x20commit\x20components.');const _0x48f9ee=!!((_0x2258c8=_0x141731['components'])===null||_0x2258c8===void 0x0?void 0x0:_0x2258c8[_0x4e1a6d(0xa0)])||!!((_0x202674=_0x141731['components'])===null||_0x202674===void 0x0?void 0x0:_0x202674[_0x4e1a6d(0xe9)]);if(!_0x48f9ee){await this['sfLogger']['log'](this[_0x4e1a6d(0xa4)]+_0x4e1a6d(0xd3))['send']();return;}this[_0x4e1a6d(0x9c)]=_0x141731,await this[_0x4e1a6d(0xda)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a121_0x1086e2(0x9a)])({'transient':!![]})],CommitComponentsJob),exports[a121_0x1086e2(0xd5)]=CommitComponentsJob;