const a104_0x4af895=a104_0x3318;(function(_0x48a2e8,_0x211113){const _0x1c586d=a104_0x3318,_0xe9ef01=_0x48a2e8();while(!![]){try{const _0x54942a=parseInt(_0x1c586d(0x100))/0x1+parseInt(_0x1c586d(0x131))/0x2+-parseInt(_0x1c586d(0x157))/0x3+parseInt(_0x1c586d(0x133))/0x4*(-parseInt(_0x1c586d(0x13e))/0x5)+-parseInt(_0x1c586d(0x140))/0x6+parseInt(_0x1c586d(0x11e))/0x7+parseInt(_0x1c586d(0xf8))/0x8*(parseInt(_0x1c586d(0x124))/0x9);if(_0x54942a===_0x211113)break;else _0xe9ef01['push'](_0xe9ef01['shift']());}catch(_0x4a24dc){_0xe9ef01['push'](_0xe9ef01['shift']());}}}(a104_0x5894,0x905c9));const a104_0x2977b9=(function(){let _0x5a94d6=!![];return function(_0x19372f,_0x1cc991){const _0x33e99d=_0x5a94d6?function(){if(_0x1cc991){const _0x2f752f=_0x1cc991['apply'](_0x19372f,arguments);return _0x1cc991=null,_0x2f752f;}}:function(){};return _0x5a94d6=![],_0x33e99d;};}()),a104_0x108360=a104_0x2977b9(this,function(){const _0x2fc292=a104_0x3318;return a104_0x108360['toString']()['search'](_0x2fc292(0x13b))['toString']()[_0x2fc292(0x11f)](a104_0x108360)['search'](_0x2fc292(0x13b));});a104_0x108360();function a104_0x5894(){const _0x37a86f=['\x20Copying\x20mdapi\x20to\x20git\x20folder.','typedi','removeComponents','COMPONENTS_PER_TICK','../../../../constants','Service','writeComponents','writed','default','\x20Start\x20cloning\x20repository.','error','\x20Nothing\x20to\x20commit.\x20Skip.','11136TUQVzn','components','push','now','fileType','isEmptyDir','path','reduce','32668KozSsM','sfLogger','length','../utils/sfdx.utils','name','CommitComponentsJob','getProtocol','branch','credentials','startTime','getOwnPropertyDescriptor','replace','defineProperty','../dto/commit-components.dto','__esModule','logger','SFDX','catch','clearDir','get','getRemote','Bitbucket','exec','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','getGitShellAuthorizationString','FORCE_APP_DEFAULT_DIR','send','../../providers/providers.tokens','GitUtils','cleanUp','4143503uyzJtK','constructor','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','../../../shared/utils','join','commitData','13257XqUbZi','://','gitUrl','CommitComponentsDto','configurable','\x20Prepare\x20mdapi\x20files.','prepareMdapi','componentsToDelete','values','prefix','../../providers/api/bitbucket-api.service','\x20Wrote\x20','../../providers/types/git-provider','898232YSyFSD','copyVlocityComponents','8WgbXlI','isSFDXProject','decorate','componentsToWrite','sort','deleted','gitUtils','object','(((.+)+)+)+$','includes','groupComponentsByFileName','1637590IyXltM','../utils/mdapi.utils','5824524UgUdUM','ms.\x20Committed\x20components\x20-\x20','GitProvider','\x20components','__importDefault','type','../../parsers/data/child-types','call','force','\x20Deleted\x20','__setModuleDefault','../utils/git.utils','splice','dir','mdapiUtils','sfdxUtils','force-app','removeDir','../../internal/fs.internal','../../salesforce/utils/sfdx.utils','prototype','provider','\x20Checking\x20written\x20components.','2721102WJwstO','\x20Preparing\x20to\x20delete\x20components','writable','\x20Start\x20converting\x20to\x20SFDX.','log','events','create'];a104_0x5894=function(){return _0x37a86f;};return a104_0x5894();}'use strict';var __createBinding=this&&this['__createBinding']||(Object[a104_0x4af895(0x15d)]?function(_0x551389,_0x292f4a,_0x126524,_0x5d6a75){const _0x23b6a6=a104_0x4af895;if(_0x5d6a75===undefined)_0x5d6a75=_0x126524;var _0x4edcde=Object['getOwnPropertyDescriptor'](_0x292f4a,_0x126524);(!_0x4edcde||(_0x23b6a6(0x113)in _0x4edcde?!_0x292f4a['__esModule']:_0x4edcde[_0x23b6a6(0x159)]||_0x4edcde[_0x23b6a6(0x128)]))&&(_0x4edcde={'enumerable':!![],'get':function(){return _0x292f4a[_0x126524];}}),Object[_0x23b6a6(0x10c)](_0x551389,_0x5d6a75,_0x4edcde);}:function(_0x26dacc,_0x3b9802,_0x296487,_0x120e64){if(_0x120e64===undefined)_0x120e64=_0x296487;_0x26dacc[_0x120e64]=_0x3b9802[_0x296487];}),__setModuleDefault=this&&this[a104_0x4af895(0x14a)]||(Object[a104_0x4af895(0x15d)]?function(_0x472267,_0x3b7acf){const _0x52c745=a104_0x4af895;Object[_0x52c745(0x10c)](_0x472267,'default',{'enumerable':!![],'value':_0x3b7acf});}:function(_0x5c5c15,_0x1e9099){const _0x2585ad=a104_0x4af895;_0x5c5c15[_0x2585ad(0xf4)]=_0x1e9099;}),__decorate=this&&this['__decorate']||function(_0x281dae,_0xe0549a,_0x13df09,_0x70acc2){const _0x3f028d=a104_0x4af895;var _0xf35a1f=arguments[_0x3f028d(0x102)],_0x137718=_0xf35a1f<0x3?_0xe0549a:_0x70acc2===null?_0x70acc2=Object[_0x3f028d(0x10a)](_0xe0549a,_0x13df09):_0x70acc2,_0x431165;if(typeof Reflect===_0x3f028d(0x13a)&&typeof Reflect[_0x3f028d(0x135)]==='function')_0x137718=Reflect[_0x3f028d(0x135)](_0x281dae,_0xe0549a,_0x13df09,_0x70acc2);else{for(var _0xa0beec=_0x281dae['length']-0x1;_0xa0beec>=0x0;_0xa0beec--)if(_0x431165=_0x281dae[_0xa0beec])_0x137718=(_0xf35a1f<0x3?_0x431165(_0x137718):_0xf35a1f>0x3?_0x431165(_0xe0549a,_0x13df09,_0x137718):_0x431165(_0xe0549a,_0x13df09))||_0x137718;}return _0xf35a1f>0x3&&_0x137718&&Object[_0x3f028d(0x10c)](_0xe0549a,_0x13df09,_0x137718),_0x137718;},__importStar=this&&this['__importStar']||function(_0x1a5688){const _0xd3b146=a104_0x4af895;if(_0x1a5688&&_0x1a5688[_0xd3b146(0x10e)])return _0x1a5688;var _0x3749c4={};if(_0x1a5688!=null){for(var _0x38ff55 in _0x1a5688)if(_0x38ff55!==_0xd3b146(0xf4)&&Object[_0xd3b146(0x154)]['hasOwnProperty'][_0xd3b146(0x147)](_0x1a5688,_0x38ff55))__createBinding(_0x3749c4,_0x1a5688,_0x38ff55);}return __setModuleDefault(_0x3749c4,_0x1a5688),_0x3749c4;},__importDefault=this&&this[a104_0x4af895(0x144)]||function(_0xc9a88f){const _0x248ab7=a104_0x4af895;return _0xc9a88f&&_0xc9a88f[_0x248ab7(0x10e)]?_0xc9a88f:{'default':_0xc9a88f};};Object[a104_0x4af895(0x10c)](exports,a104_0x4af895(0x10e),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require(a104_0x4af895(0x10d)),events_1=__importDefault(require(a104_0x4af895(0x15c))),git_utils_1=require(a104_0x4af895(0x14b)),mdapi_utils_1=require(a104_0x4af895(0x13f)),sfdx_utils_1=require(a104_0x4af895(0x103)),typedi_1=__importStar(require(a104_0x4af895(0x15f))),child_types_1=__importDefault(require(a104_0x4af895(0x146))),utils_1=require(a104_0x4af895(0x121)),constants_1=require(a104_0x4af895(0x162)),git_provider_1=require(a104_0x4af895(0x130)),bitbucket_api_service_1=require(a104_0x4af895(0x12e)),sfdx_utils_2=require(a104_0x4af895(0x153)),fs_internal_1=require(a104_0x4af895(0x152)),path_1=require(a104_0x4af895(0xfe)),providers_tokens_1=require(a104_0x4af895(0x11b)),constants_2=require(a104_0x4af895(0x162));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x4af895(0xf4)]{constructor(){const _0x4a03c7=a104_0x4af895;super(...arguments),this[_0x4a03c7(0x161)]=0x3e8,this[_0x4a03c7(0x136)]=0x0,this[_0x4a03c7(0x12b)]=0x0,this[_0x4a03c7(0x109)]=Date[_0x4a03c7(0xfb)]();}async[a104_0x4af895(0x114)](){const _0x5624c6=a104_0x4af895,{repo:_0x12d8ae}=this['commitData'],_0x1543a3=typedi_1['default']['get'](providers_tokens_1['Tokens'][_0x5624c6(0x108)]);if(this['commitData'][_0x5624c6(0x155)]===git_provider_1[_0x5624c6(0x142)][_0x5624c6(0x115)]){const _0x4d6cbb=typedi_1[_0x5624c6(0xf4)]['get'](bitbucket_api_service_1['BitbucketApiService']);await _0x4d6cbb['isLoggedIn']();}return _0x12d8ae[_0x5624c6(0x126)][_0x5624c6(0x10b)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x5624c6(0x106)])(_0x12d8ae[_0x5624c6(0x126)])+_0x5624c6(0x125)+_0x1543a3[_0x5624c6(0x118)]()+'@');}[a104_0x4af895(0x13d)](_0x288f0b){const _0x59d622=a104_0x4af895;var _0x40d675;_0x288f0b[_0x59d622(0x137)](_0x26ca9e=>child_types_1[_0x59d622(0xf4)][_0x59d622(0x13c)](_0x26ca9e[_0x59d622(0xfc)])?0x1:-0x1);const _0xb57910={};for(const _0x21f0bb of _0x288f0b){_0xb57910[_0x40d675=_0x21f0bb['fileName']]||(_0xb57910[_0x40d675]=[]),_0xb57910[_0x21f0bb['fileName']][_0x59d622(0xfa)](_0x21f0bb);}return Object[_0x59d622(0x12c)](_0xb57910)[_0x59d622(0xff)]((_0x51fc78,_0xedea0)=>[..._0x51fc78,..._0xedea0],[]);}async[a104_0x4af895(0xf2)](_0x10cae3){const _0x1b5476=a104_0x4af895;_0x10cae3=this['groupComponentsByFileName'](_0x10cae3);let _0x3e6bff=0x0;while(_0x10cae3[_0x1b5476(0x102)]){const _0x489659=_0x10cae3[_0x1b5476(0x14c)](0x0,this[_0x1b5476(0x161)]);await this[_0x1b5476(0x14e)]['writeFlosumComponents'](_0x489659,{'skipChildErrors':this[_0x1b5476(0x123)][_0x1b5476(0x107)][_0x1b5476(0x104)]==='master'}),_0x3e6bff+=_0x489659[_0x1b5476(0x102)],this[_0x1b5476(0x101)][_0x1b5476(0x15b)](this[_0x1b5476(0x12d)]+_0x1b5476(0x12f)+_0x3e6bff+'/'+this['componentsToWrite']+_0x1b5476(0x143)),await this[_0x1b5476(0x101)][_0x1b5476(0x11a)]();}}async[a104_0x4af895(0x160)](_0x5cb700){const _0xccaaaf=a104_0x4af895;_0x5cb700[_0xccaaaf(0x137)](_0x6906b2=>child_types_1[_0xccaaaf(0xf4)][_0xccaaaf(0x13c)](_0x6906b2[_0xccaaaf(0x145)])?-0x1:0x1);let _0x35d6e4=0x0;while(_0x5cb700[_0xccaaaf(0x102)]){const _0x4d9466=_0x5cb700[_0xccaaaf(0x14c)](0x0,this[_0xccaaaf(0x161)]);await this[_0xccaaaf(0x14e)][_0xccaaaf(0x160)](_0x4d9466),_0x35d6e4+=_0x4d9466[_0xccaaaf(0x102)],this[_0xccaaaf(0x101)][_0xccaaaf(0x15b)](this['prefix']+_0xccaaaf(0x149)+_0x35d6e4+'/'+this[_0xccaaaf(0x12b)]+_0xccaaaf(0x143)),await this[_0xccaaaf(0x101)][_0xccaaaf(0x11a)]();}}async[a104_0x4af895(0x11d)](){const _0x4c049c=a104_0x4af895;this[_0x4c049c(0x139)]&&await this[_0x4c049c(0x139)][_0x4c049c(0x151)]()[_0x4c049c(0x111)](()=>void 0x0),this['mdapiUtils']&&await this[_0x4c049c(0x14e)][_0x4c049c(0x151)]()[_0x4c049c(0x111)](()=>void 0x0),this[_0x4c049c(0x14f)]&&await this['sfdxUtils'][_0x4c049c(0x151)]()[_0x4c049c(0x111)](()=>void 0x0);}async[a104_0x4af895(0x116)](){const _0x4e79bc=a104_0x4af895,{repo:_0x15d2d0,branch:_0x1deda9,components:_0x2da671,convertToSFDX:_0xd3c94,message:_0x3c763c,user:_0x4ddbc6}=this['commitData'];this['mdapiUtils']=new mdapi_utils_1['MDApiUtils'](),this[_0x4e79bc(0x139)]=new git_utils_1[(_0x4e79bc(0x11c))](await this['getRemote']()),this['sfdxUtils']=new sfdx_utils_1['SFDXUtils']();let _0x73cb1f=_0xd3c94;try{await this['sfLogger']['log'](this[_0x4e79bc(0x12d)]+_0x4e79bc(0xf5))['send'](),await this[_0x4e79bc(0x139)]['clone'](_0x1deda9[_0x4e79bc(0x104)],_0x15d2d0[_0x4e79bc(0x104)]);!this['commitData'][_0x4e79bc(0x148)]?(this[_0x4e79bc(0x101)][_0x4e79bc(0x15b)](this[_0x4e79bc(0x12d)]+_0x4e79bc(0x129)),await this['mdapiUtils'][_0x4e79bc(0x12a)](this[_0x4e79bc(0x139)][_0x4e79bc(0x14d)])):this[_0x4e79bc(0x101)]['log'](this[_0x4e79bc(0x12d)]+_0x4e79bc(0x117));await this[_0x4e79bc(0x101)]['log'](this[_0x4e79bc(0x12d)]+_0x4e79bc(0x156))[_0x4e79bc(0x11a)]();_0x2da671['writed']&&(this[_0x4e79bc(0x101)]['log'](this['prefix']+'\x20Preparing\x20to\x20write\x20components'),this[_0x4e79bc(0x136)]=_0x2da671['writed'][_0x4e79bc(0x102)],await this['writeComponents'](_0x2da671[_0x4e79bc(0xf3)]),await this[_0x4e79bc(0x101)]['send']());await this[_0x4e79bc(0x101)][_0x4e79bc(0x15b)](this[_0x4e79bc(0x12d)]+'\x20Checking\x20deleted\x20components.')['send']();_0x2da671[_0x4e79bc(0x138)]&&(this[_0x4e79bc(0x101)][_0x4e79bc(0x15b)](this['prefix']+_0x4e79bc(0x158)),this['componentsToDelete']=_0x2da671[_0x4e79bc(0x138)][_0x4e79bc(0x102)],await this['removeComponents'](_0x2da671[_0x4e79bc(0x138)]),await this['sfLogger'][_0x4e79bc(0x11a)]());await this['sfLogger'][_0x4e79bc(0x11a)]();const _0x1a38ec=await fs_internal_1['FS'][_0x4e79bc(0xfd)](this[_0x4e79bc(0x139)][_0x4e79bc(0x14d)]);await sfdx_utils_2[_0x4e79bc(0x110)][_0x4e79bc(0x134)](this[_0x4e79bc(0x139)]['dir'])?(_0x73cb1f=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1[_0x4e79bc(0x122)])(this[_0x4e79bc(0x139)][_0x4e79bc(0x14d)],_0x4e79bc(0x150)))):(_0x73cb1f&&(!_0x1a38ec&&(_0x73cb1f=![])),await this[_0x4e79bc(0x139)][_0x4e79bc(0x112)]());_0x73cb1f?(await this[_0x4e79bc(0x101)][_0x4e79bc(0x15b)](this['prefix']+_0x4e79bc(0x15a))[_0x4e79bc(0x11a)](),await this['sfdxUtils']['createProjectFrom'](this['mdapiUtils'][_0x4e79bc(0x14d)]),await this[_0x4e79bc(0x14f)]['copyProjectTo'](this[_0x4e79bc(0x139)]['dir'],!_0x1a38ec),await this[_0x4e79bc(0x14f)][_0x4e79bc(0x132)](this[_0x4e79bc(0x14e)]['dir'],(0x0,path_1[_0x4e79bc(0x122)])(this[_0x4e79bc(0x139)][_0x4e79bc(0x14d)],constants_2[_0x4e79bc(0x119)])),await this['sfdxUtils']['removeDir']()):(await this['sfLogger']['log'](this[_0x4e79bc(0x12d)]+_0x4e79bc(0x15e))[_0x4e79bc(0x11a)](),await this[_0x4e79bc(0x14e)]['copyMdapiTo'](this['gitUtils'][_0x4e79bc(0x14d)]));await this['sfLogger'][_0x4e79bc(0x15b)](this['prefix']+_0x4e79bc(0x120))[_0x4e79bc(0x11a)](),await this[_0x4e79bc(0x139)]['commitAndPush'](_0x3c763c,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x4ddbc6[_0x4e79bc(0x104)]},_0x1deda9[_0x4e79bc(0x104)]),await this[_0x4e79bc(0x139)][_0x4e79bc(0x151)](),await this[_0x4e79bc(0x14e)]['removeDir']();const _0x222e74=this[_0x4e79bc(0x136)]+this[_0x4e79bc(0x12b)];await this[_0x4e79bc(0x101)][_0x4e79bc(0x15b)](this[_0x4e79bc(0x12d)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x4e79bc(0xfb)]()-this['startTime'])+_0x4e79bc(0x141)+_0x222e74+'.')[_0x4e79bc(0x11a)]();}catch(_0x19ddd3){await this['cleanUp'](),await this[_0x4e79bc(0x101)][_0x4e79bc(0xf6)](this[_0x4e79bc(0x12d)]+'\x20'+_0x19ddd3)[_0x4e79bc(0x11a)]();throw _0x19ddd3;}}async['run'](_0x80c0ea,_0x507b1e){const _0x490d57=a104_0x4af895;var _0x58b86f,_0x2d00aa;this['sfLogger']=typedi_1[_0x490d57(0xf4)][_0x490d57(0x113)](providers_tokens_1['Tokens'][_0x490d57(0x10f)]),this[_0x490d57(0x12d)]=(_0x507b1e?_0x507b1e+'\x20':'')+'['+commit_components_dto_1[_0x490d57(0x127)][_0x490d57(0x104)]+']',await this['sfLogger'][_0x490d57(0x15b)](this[_0x490d57(0x12d)]+'\x20Checking\x20commit\x20components.');const _0x3c4755=!!((_0x58b86f=_0x80c0ea[_0x490d57(0xf9)])===null||_0x58b86f===void 0x0?void 0x0:_0x58b86f[_0x490d57(0xf3)])||!!((_0x2d00aa=_0x80c0ea[_0x490d57(0xf9)])===null||_0x2d00aa===void 0x0?void 0x0:_0x2d00aa['deleted']);if(!_0x3c4755){await this[_0x490d57(0x101)][_0x490d57(0x15b)](this[_0x490d57(0x12d)]+_0x490d57(0xf7))[_0x490d57(0x11a)]();return;}this[_0x490d57(0x123)]=_0x80c0ea,await this[_0x490d57(0x116)]();}};function a104_0x3318(_0x3fcd14,_0x470f23){const _0x3ded96=a104_0x5894();return a104_0x3318=function(_0x108360,_0x2977b9){_0x108360=_0x108360-0xf2;let _0x589402=_0x3ded96[_0x108360];return _0x589402;},a104_0x3318(_0x3fcd14,_0x470f23);}CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x4af895(0x163)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x4af895(0x105)]=CommitComponentsJob;