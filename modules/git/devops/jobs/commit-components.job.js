const a121_0x8fe600=a121_0x5518;(function(_0x277ce4,_0x30111c){const _0x3fd2a2=a121_0x5518,_0x292e12=_0x277ce4();while(!![]){try{const _0x48cc62=parseInt(_0x3fd2a2(0x168))/0x1+parseInt(_0x3fd2a2(0x1bd))/0x2+parseInt(_0x3fd2a2(0x193))/0x3*(-parseInt(_0x3fd2a2(0x1cd))/0x4)+parseInt(_0x3fd2a2(0x163))/0x5+-parseInt(_0x3fd2a2(0x160))/0x6+parseInt(_0x3fd2a2(0x183))/0x7+-parseInt(_0x3fd2a2(0x18e))/0x8*(parseInt(_0x3fd2a2(0x1cc))/0x9);if(_0x48cc62===_0x30111c)break;else _0x292e12['push'](_0x292e12['shift']());}catch(_0x1ac502){_0x292e12['push'](_0x292e12['shift']());}}}(a121_0x818a,0x96b67));const a121_0x4d843b=(function(){let _0x47a880=!![];return function(_0x47a568,_0x5ad386){const _0x16f945=_0x47a880?function(){const _0x3a4f91=a121_0x5518;if(_0x5ad386){const _0x4efcca=_0x5ad386[_0x3a4f91(0x1a2)](_0x47a568,arguments);return _0x5ad386=null,_0x4efcca;}}:function(){};return _0x47a880=![],_0x16f945;};}()),a121_0x45a671=a121_0x4d843b(this,function(){const _0x171cf0=a121_0x5518;return a121_0x45a671[_0x171cf0(0x1c6)]()[_0x171cf0(0x17b)]('(((.+)+)+)+$')[_0x171cf0(0x1c6)]()[_0x171cf0(0x164)](a121_0x45a671)[_0x171cf0(0x17b)]('(((.+)+)+)+$');});a121_0x45a671();function a121_0x5518(_0x14709b,_0x58bcae){const _0x460c0c=a121_0x818a();return a121_0x5518=function(_0x45a671,_0x4d843b){_0x45a671=_0x45a671-0x15a;let _0x818a62=_0x460c0c[_0x45a671];return _0x818a62;},a121_0x5518(_0x14709b,_0x58bcae);}'use strict';var __createBinding=this&&this[a121_0x8fe600(0x174)]||(Object[a121_0x8fe600(0x1aa)]?function(_0x11104f,_0x436ef7,_0x3d20e3,_0x35413d){const _0x38c61b=a121_0x8fe600;if(_0x35413d===undefined)_0x35413d=_0x3d20e3;var _0x4cb335=Object[_0x38c61b(0x1b9)](_0x436ef7,_0x3d20e3);(!_0x4cb335||(_0x38c61b(0x196)in _0x4cb335?!_0x436ef7[_0x38c61b(0x179)]:_0x4cb335[_0x38c61b(0x15c)]||_0x4cb335[_0x38c61b(0x1a9)]))&&(_0x4cb335={'enumerable':!![],'get':function(){return _0x436ef7[_0x3d20e3];}}),Object[_0x38c61b(0x165)](_0x11104f,_0x35413d,_0x4cb335);}:function(_0x591cd0,_0x1162ee,_0x2eda00,_0x34103f){if(_0x34103f===undefined)_0x34103f=_0x2eda00;_0x591cd0[_0x34103f]=_0x1162ee[_0x2eda00];}),__setModuleDefault=this&&this[a121_0x8fe600(0x1ce)]||(Object['create']?function(_0x1da1b8,_0x111acf){const _0x493bcb=a121_0x8fe600;Object[_0x493bcb(0x165)](_0x1da1b8,'default',{'enumerable':!![],'value':_0x111acf});}:function(_0x5b540b,_0x286c0c){const _0x1deb9b=a121_0x8fe600;_0x5b540b[_0x1deb9b(0x17f)]=_0x286c0c;}),__decorate=this&&this['__decorate']||function(_0x2446e2,_0x122a92,_0x508bea,_0xd2a8f4){const _0x321a54=a121_0x8fe600;var _0x4ff6a7=arguments[_0x321a54(0x16a)],_0x635b02=_0x4ff6a7<0x3?_0x122a92:_0xd2a8f4===null?_0xd2a8f4=Object[_0x321a54(0x1b9)](_0x122a92,_0x508bea):_0xd2a8f4,_0x5d51a0;if(typeof Reflect===_0x321a54(0x175)&&typeof Reflect[_0x321a54(0x171)]===_0x321a54(0x194))_0x635b02=Reflect[_0x321a54(0x171)](_0x2446e2,_0x122a92,_0x508bea,_0xd2a8f4);else{for(var _0x27b10e=_0x2446e2[_0x321a54(0x16a)]-0x1;_0x27b10e>=0x0;_0x27b10e--)if(_0x5d51a0=_0x2446e2[_0x27b10e])_0x635b02=(_0x4ff6a7<0x3?_0x5d51a0(_0x635b02):_0x4ff6a7>0x3?_0x5d51a0(_0x122a92,_0x508bea,_0x635b02):_0x5d51a0(_0x122a92,_0x508bea))||_0x635b02;}return _0x4ff6a7>0x3&&_0x635b02&&Object[_0x321a54(0x165)](_0x122a92,_0x508bea,_0x635b02),_0x635b02;},__importStar=this&&this[a121_0x8fe600(0x18f)]||function(_0x4834cd){const _0x37358d=a121_0x8fe600;if(_0x4834cd&&_0x4834cd[_0x37358d(0x179)])return _0x4834cd;var _0x25af85={};if(_0x4834cd!=null){for(var _0xdde1cc in _0x4834cd)if(_0xdde1cc!=='default'&&Object['prototype'][_0x37358d(0x19d)][_0x37358d(0x19c)](_0x4834cd,_0xdde1cc))__createBinding(_0x25af85,_0x4834cd,_0xdde1cc);}return __setModuleDefault(_0x25af85,_0x4834cd),_0x25af85;},__importDefault=this&&this[a121_0x8fe600(0x1ae)]||function(_0x5a9e6e){const _0x3954d4=a121_0x8fe600;return _0x5a9e6e&&_0x5a9e6e[_0x3954d4(0x179)]?_0x5a9e6e:{'default':_0x5a9e6e};};Object['defineProperty'](exports,a121_0x8fe600(0x179),{'value':!![]}),exports[a121_0x8fe600(0x1c7)]=void 0x0;const commit_components_dto_1=require(a121_0x8fe600(0x181)),events_1=__importDefault(require(a121_0x8fe600(0x1c0))),git_utils_1=require(a121_0x8fe600(0x1b1)),mdapi_utils_1=require(a121_0x8fe600(0x15e)),sfdx_utils_1=require(a121_0x8fe600(0x1cf)),typedi_1=__importStar(require(a121_0x8fe600(0x188))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a121_0x8fe600(0x187)),constants_1=require(a121_0x8fe600(0x162)),git_provider_1=require(a121_0x8fe600(0x1c3)),bitbucket_api_service_1=require(a121_0x8fe600(0x184)),sfdx_utils_2=require(a121_0x8fe600(0x17e)),fs_internal_1=require(a121_0x8fe600(0x1a6)),path_1=require(a121_0x8fe600(0x198)),providers_tokens_1=require(a121_0x8fe600(0x18d)),constants_2=require(a121_0x8fe600(0x162));let CommitComponentsJob=class CommitComponentsJob extends events_1[a121_0x8fe600(0x17f)]{constructor(){const _0x2fee0a=a121_0x8fe600;super(...arguments),this[_0x2fee0a(0x18c)]=0x3e8,this[_0x2fee0a(0x1ca)]=0x0,this[_0x2fee0a(0x17c)]=0x0,this['startTime']=Date[_0x2fee0a(0x1a5)]();}async[a121_0x8fe600(0x1bb)](){const _0xe6fd5f=a121_0x8fe600,{repo:_0x535467}=this[_0xe6fd5f(0x180)],_0x4d07d3=typedi_1[_0xe6fd5f(0x17f)][_0xe6fd5f(0x196)](providers_tokens_1[_0xe6fd5f(0x186)][_0xe6fd5f(0x1ab)]);if(this[_0xe6fd5f(0x180)][_0xe6fd5f(0x1a7)]===git_provider_1[_0xe6fd5f(0x173)][_0xe6fd5f(0x195)]){const _0x5b3668=typedi_1[_0xe6fd5f(0x17f)]['get'](bitbucket_api_service_1[_0xe6fd5f(0x18b)]);await _0x5b3668[_0xe6fd5f(0x15f)]();}return _0x535467[_0xe6fd5f(0x182)][_0xe6fd5f(0x1ac)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x535467[_0xe6fd5f(0x182)])+'://'+_0x4d07d3[_0xe6fd5f(0x1ad)]()+'@');}[a121_0x8fe600(0x191)](_0x5dbbbd){const _0x2b668c=a121_0x8fe600;var _0x1a0333;_0x5dbbbd[_0x2b668c(0x1a3)](_0x5b61bc=>child_types_1[_0x2b668c(0x17f)][_0x2b668c(0x1b0)](_0x5b61bc['fileType'])?0x1:-0x1);const _0x5b5dc3={};for(const _0x282eca of _0x5dbbbd){_0x5b5dc3[_0x1a0333=_0x282eca[_0x2b668c(0x1c9)]]||(_0x5b5dc3[_0x1a0333]=[]),_0x5b5dc3[_0x282eca['fileName']][_0x2b668c(0x1d0)](_0x282eca);}return Object['values'](_0x5b5dc3)[_0x2b668c(0x18a)]((_0x1fc88c,_0x4fcb7a)=>[..._0x1fc88c,..._0x4fcb7a],[]);}async[a121_0x8fe600(0x19a)](_0x2a5ee7){const _0x4b6f4a=a121_0x8fe600;_0x2a5ee7=this[_0x4b6f4a(0x191)](_0x2a5ee7);let _0x10f3f0=0x0;while(_0x2a5ee7[_0x4b6f4a(0x16a)]){const _0x582d9d=_0x2a5ee7[_0x4b6f4a(0x169)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x4b6f4a(0x1c8)][_0x4b6f4a(0x192)](_0x582d9d,{'skipChildErrors':this[_0x4b6f4a(0x180)][_0x4b6f4a(0x185)][_0x4b6f4a(0x177)]===_0x4b6f4a(0x17d),'recordType':this[_0x4b6f4a(0x180)][_0x4b6f4a(0x1a8)]}),_0x10f3f0+=_0x582d9d[_0x4b6f4a(0x16a)],this['sfLogger'][_0x4b6f4a(0x1b8)](this[_0x4b6f4a(0x1a0)]+_0x4b6f4a(0x1d2)+_0x10f3f0+'/'+this[_0x4b6f4a(0x1ca)]+'\x20components'),await this[_0x4b6f4a(0x15b)][_0x4b6f4a(0x16c)]();}}async['removeComponents'](_0x58eca7){const _0x4c32ab=a121_0x8fe600;_0x58eca7['sort'](_0x1b48e0=>child_types_1[_0x4c32ab(0x17f)]['includes'](_0x1b48e0[_0x4c32ab(0x1d3)])?-0x1:0x1);let _0x173d0d=0x0;while(_0x58eca7[_0x4c32ab(0x16a)]){const _0x4b425d=_0x58eca7['splice'](0x0,this[_0x4c32ab(0x18c)]);await this[_0x4c32ab(0x1c8)][_0x4c32ab(0x1bf)](_0x4b425d,this['commitData'][_0x4c32ab(0x1a8)]),_0x173d0d+=_0x4b425d[_0x4c32ab(0x16a)],this[_0x4c32ab(0x15b)][_0x4c32ab(0x1b8)](this[_0x4c32ab(0x1a0)]+'\x20Deleted\x20'+_0x173d0d+'/'+this[_0x4c32ab(0x17c)]+'\x20components'),await this[_0x4c32ab(0x15b)][_0x4c32ab(0x16c)]();}}async[a121_0x8fe600(0x15d)](){const _0x2c0514=a121_0x8fe600;this[_0x2c0514(0x176)]&&await this[_0x2c0514(0x176)][_0x2c0514(0x1a4)]()['catch'](()=>void 0x0),this[_0x2c0514(0x1c8)]&&await this[_0x2c0514(0x1c8)][_0x2c0514(0x1a4)]()[_0x2c0514(0x1b6)](()=>void 0x0),this[_0x2c0514(0x16f)]&&await this[_0x2c0514(0x16f)][_0x2c0514(0x1a4)]()[_0x2c0514(0x1b6)](()=>void 0x0);}async['exec'](){const _0x5c8818=a121_0x8fe600,{repo:_0x2ef3a1,branch:_0x65391c,components:_0x45f280,convertToSFDX:_0x1ba344,message:_0x4b21d1,user:_0x517c29}=this[_0x5c8818(0x180)];this[_0x5c8818(0x1c8)]=new mdapi_utils_1[(_0x5c8818(0x189))](),this[_0x5c8818(0x176)]=new git_utils_1[(_0x5c8818(0x1b2))](await this['getRemote']()),this[_0x5c8818(0x16f)]=new sfdx_utils_1[(_0x5c8818(0x172))]();let _0x4e86ec=_0x1ba344&&this[_0x5c8818(0x16f)]['isConvertToSfdx'](this[_0x5c8818(0x180)]['recordType']);try{await this[_0x5c8818(0x15b)][_0x5c8818(0x1b8)](this[_0x5c8818(0x1a0)]+_0x5c8818(0x1ba))['send'](),await this[_0x5c8818(0x176)]['clone'](_0x65391c['name'],_0x2ef3a1['name']);!this[_0x5c8818(0x180)]['force']?(this[_0x5c8818(0x15b)][_0x5c8818(0x1b8)](this[_0x5c8818(0x1a0)]+'\x20Prepare\x20mdapi\x20files.'),await this['mdapiUtils'][_0x5c8818(0x16d)](this[_0x5c8818(0x176)][_0x5c8818(0x19f)])):this['sfLogger'][_0x5c8818(0x1b8)](this[_0x5c8818(0x1a0)]+_0x5c8818(0x1bc));await this[_0x5c8818(0x15b)][_0x5c8818(0x1b8)](this[_0x5c8818(0x1a0)]+_0x5c8818(0x1af))[_0x5c8818(0x16c)]();_0x45f280[_0x5c8818(0x166)]&&(this[_0x5c8818(0x15b)]['log'](this['prefix']+_0x5c8818(0x1be)),this['componentsToWrite']=_0x45f280[_0x5c8818(0x166)]['length'],await this[_0x5c8818(0x19a)](_0x45f280[_0x5c8818(0x166)]),await this[_0x5c8818(0x15b)][_0x5c8818(0x16c)]());await this['sfLogger'][_0x5c8818(0x1b8)](this[_0x5c8818(0x1a0)]+_0x5c8818(0x1b4))[_0x5c8818(0x16c)]();_0x45f280[_0x5c8818(0x161)]&&(this[_0x5c8818(0x15b)][_0x5c8818(0x1b8)](this['prefix']+_0x5c8818(0x19b)),this['componentsToDelete']=_0x45f280[_0x5c8818(0x161)][_0x5c8818(0x16a)],await this[_0x5c8818(0x1bf)](_0x45f280[_0x5c8818(0x161)]),await this[_0x5c8818(0x15b)][_0x5c8818(0x16c)]());await this[_0x5c8818(0x15b)][_0x5c8818(0x16c)]();const _0x1aefe8=await fs_internal_1['FS'][_0x5c8818(0x167)](this[_0x5c8818(0x176)][_0x5c8818(0x19f)]);await sfdx_utils_2[_0x5c8818(0x1cb)][_0x5c8818(0x15a)](this[_0x5c8818(0x176)][_0x5c8818(0x19f)])?(_0x4e86ec=!![],await fs_internal_1['FS'][_0x5c8818(0x1a4)]((0x0,path_1[_0x5c8818(0x1a1)])(this['gitUtils']['dir'],'force-app'))):(_0x4e86ec&&(!_0x1aefe8&&(_0x4e86ec=![])),await this[_0x5c8818(0x176)]['clearDir']());_0x4e86ec?(await this['sfLogger'][_0x5c8818(0x1b8)](this[_0x5c8818(0x1a0)]+_0x5c8818(0x1d1))[_0x5c8818(0x16c)](),await this[_0x5c8818(0x16f)][_0x5c8818(0x1b3)](this[_0x5c8818(0x1c8)][_0x5c8818(0x19f)]),await this['sfdxUtils'][_0x5c8818(0x16e)](this['gitUtils'][_0x5c8818(0x19f)],!_0x1aefe8),await this['sfdxUtils']['copySFDXIgnoredComponents'](this[_0x5c8818(0x1c8)]['dir'],(0x0,path_1['join'])(this[_0x5c8818(0x176)][_0x5c8818(0x19f)],constants_2[_0x5c8818(0x1b5)])),await this[_0x5c8818(0x16f)][_0x5c8818(0x1a4)]()):(await this[_0x5c8818(0x15b)][_0x5c8818(0x1b8)](this[_0x5c8818(0x1a0)]+_0x5c8818(0x16b))[_0x5c8818(0x16c)](),await this[_0x5c8818(0x1c8)][_0x5c8818(0x190)](this['gitUtils'][_0x5c8818(0x19f)]));await this[_0x5c8818(0x15b)]['log'](this[_0x5c8818(0x1a0)]+_0x5c8818(0x199))[_0x5c8818(0x16c)](),await this[_0x5c8818(0x176)][_0x5c8818(0x17a)](_0x4b21d1,{'email':constants_1[_0x5c8818(0x19e)],'name':_0x517c29[_0x5c8818(0x177)]},_0x65391c[_0x5c8818(0x177)]),await this[_0x5c8818(0x176)]['removeDir'](),await this[_0x5c8818(0x1c8)]['removeDir']();const _0x393ac8=this[_0x5c8818(0x1ca)]+this[_0x5c8818(0x17c)];await this[_0x5c8818(0x15b)]['log'](this[_0x5c8818(0x1a0)]+_0x5c8818(0x1b7)+(Date[_0x5c8818(0x1a5)]()-this[_0x5c8818(0x170)])+'ms.\x20Committed\x20components\x20-\x20'+_0x393ac8+'.')[_0x5c8818(0x16c)]();}catch(_0x863a9a){await this[_0x5c8818(0x15d)](),await this['sfLogger'][_0x5c8818(0x1c4)](this['prefix']+'\x20'+_0x863a9a)[_0x5c8818(0x16c)]();throw _0x863a9a;}}async['run'](_0x4b15a0,_0x223d17){const _0x52f37c=a121_0x8fe600;var _0x370773,_0x7038e;this[_0x52f37c(0x15b)]=typedi_1['default'][_0x52f37c(0x196)](providers_tokens_1[_0x52f37c(0x186)]['logger']),this[_0x52f37c(0x1a0)]=(_0x223d17?_0x223d17+'\x20':'')+'['+commit_components_dto_1[_0x52f37c(0x1c2)][_0x52f37c(0x177)]+']',await this['sfLogger']['log'](this[_0x52f37c(0x1a0)]+_0x52f37c(0x197));const _0x58adb9=!!((_0x370773=_0x4b15a0['components'])===null||_0x370773===void 0x0?void 0x0:_0x370773['writed'])||!!((_0x7038e=_0x4b15a0[_0x52f37c(0x178)])===null||_0x7038e===void 0x0?void 0x0:_0x7038e[_0x52f37c(0x161)]);if(!_0x58adb9){await this['sfLogger'][_0x52f37c(0x1b8)](this[_0x52f37c(0x1a0)]+'\x20Nothing\x20to\x20commit.\x20Skip.')['send']();return;}this[_0x52f37c(0x180)]=_0x4b15a0,await this[_0x52f37c(0x1c1)]();}};function a121_0x818a(){const _0x29b678=['../../internal/fs.internal','provider','recordType','configurable','create','credentials','replace','getGitShellAuthorizationString','__importDefault','\x20Checking\x20written\x20components.','includes','../utils/git.utils','GitUtils','createProjectFrom','\x20Checking\x20deleted\x20components.','FORCE_APP_DEFAULT_DIR','catch','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','log','getOwnPropertyDescriptor','\x20Start\x20cloning\x20repository.','getRemote','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','614206MUfvNK','\x20Preparing\x20to\x20write\x20components','removeComponents','events','exec','CommitComponentsDto','../../providers/types/git-provider','error','Service','toString','CommitComponentsJob','mdapiUtils','fileName','componentsToWrite','SFDX','14354217PgOpnM','404LIYqjG','__setModuleDefault','../utils/sfdx.utils','push','\x20Start\x20converting\x20to\x20SFDX.','\x20Wrote\x20','type','isSFDXProject','sfLogger','writable','cleanUp','../utils/mdapi.utils','isLoggedIn','4572288jICclz','deleted','../../../../constants','5147750fkWTkY','constructor','defineProperty','writed','isEmptyDir','821166ZNkwNo','splice','length','\x20Copying\x20mdapi\x20to\x20git\x20folder.','send','prepareMdapi','copyProjectTo','sfdxUtils','startTime','decorate','SFDXUtils','GitProvider','__createBinding','object','gitUtils','name','components','__esModule','commitAndPush','search','componentsToDelete','master','../../salesforce/utils/sfdx.utils','default','commitData','../dto/commit-components.dto','gitUrl','7576758usvaWF','../../providers/api/bitbucket-api.service','branch','Tokens','../../../shared/utils','typedi','MDApiUtils','reduce','BitbucketApiService','COMPONENTS_PER_TICK','../../providers/providers.tokens','8aySmjF','__importStar','copyMdapiTo','groupComponentsByFileName','writeFlosumComponents','7899JnuMOB','function','Bitbucket','get','\x20Checking\x20commit\x20components.','path','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','writeComponents','\x20Preparing\x20to\x20delete\x20components','call','hasOwnProperty','DEFAULT_GIT_USER_EMAIL','dir','prefix','join','apply','sort','removeDir','now'];a121_0x818a=function(){return _0x29b678;};return a121_0x818a();}CommitComponentsJob=__decorate([(0x0,typedi_1[a121_0x8fe600(0x1c5)])({'transient':!![]})],CommitComponentsJob),exports[a121_0x8fe600(0x1c7)]=CommitComponentsJob;