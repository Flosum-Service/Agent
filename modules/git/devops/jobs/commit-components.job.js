const a124_0x13056c=a124_0x4309;(function(_0x58aca0,_0x1cbdc3){const _0x402023=a124_0x4309,_0x3b2056=_0x58aca0();while(!![]){try{const _0x527ae7=parseInt(_0x402023(0x155))/0x1+parseInt(_0x402023(0x114))/0x2+-parseInt(_0x402023(0x178))/0x3+parseInt(_0x402023(0x137))/0x4*(-parseInt(_0x402023(0x15c))/0x5)+parseInt(_0x402023(0x159))/0x6+parseInt(_0x402023(0x12a))/0x7*(parseInt(_0x402023(0x154))/0x8)+-parseInt(_0x402023(0x11d))/0x9;if(_0x527ae7===_0x1cbdc3)break;else _0x3b2056['push'](_0x3b2056['shift']());}catch(_0x553d06){_0x3b2056['push'](_0x3b2056['shift']());}}}(a124_0x2ba9,0x4161b));const a124_0x23bcbc=(function(){let _0x3cd6ac=!![];return function(_0x487aa9,_0x18fbdf){const _0x54a8e4=_0x3cd6ac?function(){const _0x493089=a124_0x4309;if(_0x18fbdf){const _0x13f324=_0x18fbdf[_0x493089(0x115)](_0x487aa9,arguments);return _0x18fbdf=null,_0x13f324;}}:function(){};return _0x3cd6ac=![],_0x54a8e4;};}()),a124_0x469edb=a124_0x23bcbc(this,function(){const _0x268a27=a124_0x4309;return a124_0x469edb[_0x268a27(0x165)]()['search'](_0x268a27(0x151))[_0x268a27(0x165)]()[_0x268a27(0x170)](a124_0x469edb)['search'](_0x268a27(0x151));});a124_0x469edb();'use strict';var __createBinding=this&&this[a124_0x13056c(0x163)]||(Object['create']?function(_0x5e6093,_0x4160c3,_0x3ae478,_0xb35bb7){const _0x1c6c5f=a124_0x13056c;if(_0xb35bb7===undefined)_0xb35bb7=_0x3ae478;var _0x270d58=Object[_0x1c6c5f(0x14d)](_0x4160c3,_0x3ae478);(!_0x270d58||(_0x1c6c5f(0x14b)in _0x270d58?!_0x4160c3[_0x1c6c5f(0x138)]:_0x270d58['writable']||_0x270d58[_0x1c6c5f(0x121)]))&&(_0x270d58={'enumerable':!![],'get':function(){return _0x4160c3[_0x3ae478];}}),Object[_0x1c6c5f(0x140)](_0x5e6093,_0xb35bb7,_0x270d58);}:function(_0x57d15b,_0x2f27c5,_0x740376,_0x551f6c){if(_0x551f6c===undefined)_0x551f6c=_0x740376;_0x57d15b[_0x551f6c]=_0x2f27c5[_0x740376];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a124_0x13056c(0x171)]?function(_0x7d1878,_0x3adaff){const _0x3186c7=a124_0x13056c;Object[_0x3186c7(0x140)](_0x7d1878,_0x3186c7(0x172),{'enumerable':!![],'value':_0x3adaff});}:function(_0x1c0733,_0x40aa7d){const _0x516ca5=a124_0x13056c;_0x1c0733[_0x516ca5(0x172)]=_0x40aa7d;}),__decorate=this&&this[a124_0x13056c(0x14a)]||function(_0x5a88d0,_0x5cb340,_0x2cd62a,_0x91d551){const _0x3cbe9a=a124_0x13056c;var _0x36ff23=arguments['length'],_0x4a2a9b=_0x36ff23<0x3?_0x5cb340:_0x91d551===null?_0x91d551=Object[_0x3cbe9a(0x14d)](_0x5cb340,_0x2cd62a):_0x91d551,_0x421816;if(typeof Reflect==='object'&&typeof Reflect[_0x3cbe9a(0x11c)]==='function')_0x4a2a9b=Reflect[_0x3cbe9a(0x11c)](_0x5a88d0,_0x5cb340,_0x2cd62a,_0x91d551);else{for(var _0x5944e6=_0x5a88d0['length']-0x1;_0x5944e6>=0x0;_0x5944e6--)if(_0x421816=_0x5a88d0[_0x5944e6])_0x4a2a9b=(_0x36ff23<0x3?_0x421816(_0x4a2a9b):_0x36ff23>0x3?_0x421816(_0x5cb340,_0x2cd62a,_0x4a2a9b):_0x421816(_0x5cb340,_0x2cd62a))||_0x4a2a9b;}return _0x36ff23>0x3&&_0x4a2a9b&&Object[_0x3cbe9a(0x140)](_0x5cb340,_0x2cd62a,_0x4a2a9b),_0x4a2a9b;},__importStar=this&&this[a124_0x13056c(0x128)]||function(_0x2ecdec){const _0x4d8ec2=a124_0x13056c;if(_0x2ecdec&&_0x2ecdec[_0x4d8ec2(0x138)])return _0x2ecdec;var _0x169091={};if(_0x2ecdec!=null){for(var _0x1536b7 in _0x2ecdec)if(_0x1536b7!==_0x4d8ec2(0x172)&&Object[_0x4d8ec2(0x160)][_0x4d8ec2(0x15b)][_0x4d8ec2(0x166)](_0x2ecdec,_0x1536b7))__createBinding(_0x169091,_0x2ecdec,_0x1536b7);}return __setModuleDefault(_0x169091,_0x2ecdec),_0x169091;},__importDefault=this&&this[a124_0x13056c(0x157)]||function(_0x9e61d0){const _0x21a938=a124_0x13056c;return _0x9e61d0&&_0x9e61d0[_0x21a938(0x138)]?_0x9e61d0:{'default':_0x9e61d0};};function a124_0x4309(_0x20a917,_0x33fa79){const _0x196117=a124_0x2ba9();return a124_0x4309=function(_0x469edb,_0x23bcbc){_0x469edb=_0x469edb-0x107;let _0x2ba950=_0x196117[_0x469edb];return _0x2ba950;},a124_0x4309(_0x20a917,_0x33fa79);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a124_0x13056c(0x117))),git_utils_1=require(a124_0x13056c(0x119)),mdapi_utils_1=require(a124_0x13056c(0x122)),sfdx_utils_1=require(a124_0x13056c(0x13a)),typedi_1=__importStar(require(a124_0x13056c(0x13c))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a124_0x13056c(0x110)),constants_1=require(a124_0x13056c(0x175)),git_provider_1=require(a124_0x13056c(0x17f)),bitbucket_api_service_1=require(a124_0x13056c(0x10e)),sfdx_utils_2=require(a124_0x13056c(0x12f)),fs_internal_1=require(a124_0x13056c(0x142)),path_1=require('path'),providers_tokens_1=require(a124_0x13056c(0x134)),constants_2=require(a124_0x13056c(0x175));function a124_0x2ba9(){const _0x4e7888=['DEFAULT_GIT_USER_EMAIL','\x20Preparing\x20to\x20delete\x20components','../../../../constants','commitData','isSFDXProject','521100beqkRb','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','componentsToWrite','recordType','sfdxUtils','catch','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','../../providers/types/git-provider','logger','componentsToDelete','COMPONENTS_PER_TICK','copyMdapiTo','\x20Start\x20cloning\x20repository.','getRemote','BitbucketApiService','fileName','../../providers/api/bitbucket-api.service','groupComponentsByFileName','../../../shared/utils','now','mdapiUtils','\x20Prepare\x20mdapi\x20files.','93712LsWcGt','apply','prefix','events','\x20components','../utils/git.utils','getGitShellAuthorizationString','log','decorate','1476000CAwIha','splice','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','replace','configurable','../utils/mdapi.utils','values','fileType','commitAndPush','ms.\x20Committed\x20components\x20-\x20','branch','__importStar','gitUtils','42HFapCh','removeComponents','includes','exec','createProjectFrom','../../salesforce/utils/sfdx.utils','\x20Copying\x20mdapi\x20to\x20git\x20folder.','\x20Preparing\x20to\x20write\x20components','://','getProtocol','../../providers/providers.tokens','Service','sfLogger','1003768MnbxHz','__esModule','GitUtils','../utils/sfdx.utils','FORCE_APP_DEFAULT_DIR','typedi','length','name','CommitComponentsJob','defineProperty','\x20Start\x20converting\x20to\x20SFDX.','../../internal/fs.internal','gitUrl','dir','Bitbucket','force','Tokens','isLoggedIn','writed','__decorate','get','GitProvider','getOwnPropertyDescriptor','type','components','credentials','(((.+)+)+)+$','copyProjectTo','\x20Checking\x20commit\x20components.','598528VDPXsF','243708JjgAAL','provider','__importDefault','writeFlosumComponents','2207562VvTXTZ','push','hasOwnProperty','10QNjSYW','clone','\x20Deleted\x20','cleanUp','prototype','deleted','writeComponents','__createBinding','MDApiUtils','toString','call','error','startTime','prepareMdapi','removeDir','\x20Nothing\x20to\x20commit.\x20Skip.','send','isEmptyDir','SFDX','join','constructor','create','default'];a124_0x2ba9=function(){return _0x4e7888;};return a124_0x2ba9();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a124_0x13056c(0x172)]{constructor(){const _0x228eaa=a124_0x13056c;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x228eaa(0x17a)]=0x0,this['componentsToDelete']=0x0,this[_0x228eaa(0x168)]=Date[_0x228eaa(0x111)]();}async[a124_0x13056c(0x10b)](){const _0x39c999=a124_0x13056c,{repo:_0x1b291e}=this[_0x39c999(0x176)],_0x4d7019=typedi_1['default'][_0x39c999(0x14b)](providers_tokens_1[_0x39c999(0x147)][_0x39c999(0x150)]);if(this[_0x39c999(0x176)][_0x39c999(0x156)]===git_provider_1[_0x39c999(0x14c)][_0x39c999(0x145)]){const _0x40294e=typedi_1[_0x39c999(0x172)][_0x39c999(0x14b)](bitbucket_api_service_1[_0x39c999(0x10c)]);await _0x40294e[_0x39c999(0x148)]();}return _0x1b291e[_0x39c999(0x143)][_0x39c999(0x120)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x39c999(0x133)])(_0x1b291e[_0x39c999(0x143)])+_0x39c999(0x132)+_0x4d7019[_0x39c999(0x11a)]()+'@');}[a124_0x13056c(0x10f)](_0x14b6fb){const _0x4d1b9b=a124_0x13056c;var _0x392b2c;_0x14b6fb['sort'](_0x433fe4=>child_types_1[_0x4d1b9b(0x172)]['includes'](_0x433fe4[_0x4d1b9b(0x124)])?0x1:-0x1);const _0x3beb56={};for(const _0x1a9b7b of _0x14b6fb){_0x3beb56[_0x392b2c=_0x1a9b7b[_0x4d1b9b(0x10d)]]||(_0x3beb56[_0x392b2c]=[]),_0x3beb56[_0x1a9b7b[_0x4d1b9b(0x10d)]][_0x4d1b9b(0x15a)](_0x1a9b7b);}return Object[_0x4d1b9b(0x123)](_0x3beb56)['reduce']((_0x378c93,_0x3bc1fc)=>[..._0x378c93,..._0x3bc1fc],[]);}async['writeComponents'](_0x2f8fe9){const _0x366c6f=a124_0x13056c;_0x2f8fe9=this[_0x366c6f(0x10f)](_0x2f8fe9);let _0x12c541=0x0;while(_0x2f8fe9[_0x366c6f(0x13d)]){const _0x5410d6=_0x2f8fe9[_0x366c6f(0x11e)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x366c6f(0x112)][_0x366c6f(0x158)](_0x5410d6,{'skipChildErrors':this[_0x366c6f(0x176)][_0x366c6f(0x127)]['name']==='master','recordType':this[_0x366c6f(0x176)][_0x366c6f(0x17b)]}),_0x12c541+=_0x5410d6[_0x366c6f(0x13d)],this[_0x366c6f(0x136)][_0x366c6f(0x11b)](this[_0x366c6f(0x116)]+'\x20Wrote\x20'+_0x12c541+'/'+this['componentsToWrite']+_0x366c6f(0x118)),await this[_0x366c6f(0x136)][_0x366c6f(0x16c)]();}}async[a124_0x13056c(0x12b)](_0x58c555){const _0x530308=a124_0x13056c;_0x58c555['sort'](_0x323d5d=>child_types_1['default'][_0x530308(0x12c)](_0x323d5d[_0x530308(0x14e)])?-0x1:0x1);let _0x58b4cc=0x0;while(_0x58c555[_0x530308(0x13d)]){const _0x4662c1=_0x58c555[_0x530308(0x11e)](0x0,this[_0x530308(0x108)]);await this[_0x530308(0x112)][_0x530308(0x12b)](_0x4662c1,this[_0x530308(0x176)][_0x530308(0x17b)]),_0x58b4cc+=_0x4662c1[_0x530308(0x13d)],this[_0x530308(0x136)][_0x530308(0x11b)](this['prefix']+_0x530308(0x15e)+_0x58b4cc+'/'+this[_0x530308(0x107)]+_0x530308(0x118)),await this[_0x530308(0x136)]['send']();}}async[a124_0x13056c(0x15f)](){const _0x3a1089=a124_0x13056c;this['gitUtils']&&await this[_0x3a1089(0x129)][_0x3a1089(0x16a)]()[_0x3a1089(0x17d)](()=>void 0x0),this[_0x3a1089(0x112)]&&await this['mdapiUtils'][_0x3a1089(0x16a)]()[_0x3a1089(0x17d)](()=>void 0x0),this[_0x3a1089(0x17c)]&&await this[_0x3a1089(0x17c)][_0x3a1089(0x16a)]()[_0x3a1089(0x17d)](()=>void 0x0);}async[a124_0x13056c(0x12d)](){const _0x5337d1=a124_0x13056c,{repo:_0x5ecf6d,branch:_0x58abfb,components:_0x263528,convertToSFDX:_0x17974e,message:_0x2b369e,user:_0x45acb0}=this[_0x5337d1(0x176)];this[_0x5337d1(0x112)]=new mdapi_utils_1[(_0x5337d1(0x164))](),this[_0x5337d1(0x129)]=new git_utils_1[(_0x5337d1(0x139))](await this[_0x5337d1(0x10b)]()),this[_0x5337d1(0x17c)]=new sfdx_utils_1['SFDXUtils']();let _0x2b8ff3=_0x17974e&&this[_0x5337d1(0x17c)]['isConvertToSfdx'](this[_0x5337d1(0x176)][_0x5337d1(0x17b)]);try{await this[_0x5337d1(0x136)][_0x5337d1(0x11b)](this[_0x5337d1(0x116)]+_0x5337d1(0x10a))[_0x5337d1(0x16c)](),await this['gitUtils'][_0x5337d1(0x15d)](_0x58abfb[_0x5337d1(0x13e)],_0x5ecf6d[_0x5337d1(0x13e)]);!this['commitData'][_0x5337d1(0x146)]?(this[_0x5337d1(0x136)][_0x5337d1(0x11b)](this['prefix']+_0x5337d1(0x113)),await this[_0x5337d1(0x112)][_0x5337d1(0x169)](this[_0x5337d1(0x129)][_0x5337d1(0x144)])):this[_0x5337d1(0x136)][_0x5337d1(0x11b)](this[_0x5337d1(0x116)]+_0x5337d1(0x17e));await this[_0x5337d1(0x136)][_0x5337d1(0x11b)](this['prefix']+'\x20Checking\x20written\x20components.')[_0x5337d1(0x16c)]();_0x263528[_0x5337d1(0x149)]&&(this[_0x5337d1(0x136)]['log'](this[_0x5337d1(0x116)]+_0x5337d1(0x131)),this[_0x5337d1(0x17a)]=_0x263528[_0x5337d1(0x149)][_0x5337d1(0x13d)],await this[_0x5337d1(0x162)](_0x263528[_0x5337d1(0x149)]),await this[_0x5337d1(0x136)]['send']());await this[_0x5337d1(0x136)][_0x5337d1(0x11b)](this[_0x5337d1(0x116)]+'\x20Checking\x20deleted\x20components.')[_0x5337d1(0x16c)]();_0x263528['deleted']&&(this[_0x5337d1(0x136)][_0x5337d1(0x11b)](this[_0x5337d1(0x116)]+_0x5337d1(0x174)),this[_0x5337d1(0x107)]=_0x263528[_0x5337d1(0x161)][_0x5337d1(0x13d)],await this[_0x5337d1(0x12b)](_0x263528[_0x5337d1(0x161)]),await this[_0x5337d1(0x136)][_0x5337d1(0x16c)]());await this[_0x5337d1(0x136)][_0x5337d1(0x16c)]();const _0x4ebfba=await fs_internal_1['FS'][_0x5337d1(0x16d)](this[_0x5337d1(0x129)]['dir']);await sfdx_utils_2[_0x5337d1(0x16e)][_0x5337d1(0x177)](this['gitUtils'][_0x5337d1(0x144)])?(_0x2b8ff3=!![],await fs_internal_1['FS'][_0x5337d1(0x16a)]((0x0,path_1[_0x5337d1(0x16f)])(this['gitUtils'][_0x5337d1(0x144)],'force-app'))):(_0x2b8ff3&&(!_0x4ebfba&&(_0x2b8ff3=![])),await this[_0x5337d1(0x129)]['clearDir']());_0x2b8ff3?(await this['sfLogger'][_0x5337d1(0x11b)](this[_0x5337d1(0x116)]+_0x5337d1(0x141))['send'](),await this['sfdxUtils'][_0x5337d1(0x12e)](this[_0x5337d1(0x112)][_0x5337d1(0x144)]),await this[_0x5337d1(0x17c)][_0x5337d1(0x152)](this[_0x5337d1(0x129)][_0x5337d1(0x144)],!_0x4ebfba),await this[_0x5337d1(0x17c)]['copySFDXIgnoredComponents'](this['mdapiUtils'][_0x5337d1(0x144)],(0x0,path_1[_0x5337d1(0x16f)])(this[_0x5337d1(0x129)][_0x5337d1(0x144)],constants_2[_0x5337d1(0x13b)])),await this[_0x5337d1(0x17c)][_0x5337d1(0x16a)]()):(await this['sfLogger']['log'](this[_0x5337d1(0x116)]+_0x5337d1(0x130))[_0x5337d1(0x16c)](),await this[_0x5337d1(0x112)][_0x5337d1(0x109)](this[_0x5337d1(0x129)][_0x5337d1(0x144)]));await this['sfLogger']['log'](this[_0x5337d1(0x116)]+_0x5337d1(0x179))['send'](),await this[_0x5337d1(0x129)][_0x5337d1(0x125)](_0x2b369e,{'email':constants_1[_0x5337d1(0x173)],'name':_0x45acb0[_0x5337d1(0x13e)]},_0x58abfb[_0x5337d1(0x13e)]),await this[_0x5337d1(0x129)][_0x5337d1(0x16a)](),await this[_0x5337d1(0x112)]['removeDir']();const _0x141d7b=this[_0x5337d1(0x17a)]+this[_0x5337d1(0x107)];await this['sfLogger'][_0x5337d1(0x11b)](this[_0x5337d1(0x116)]+_0x5337d1(0x11f)+(Date['now']()-this[_0x5337d1(0x168)])+_0x5337d1(0x126)+_0x141d7b+'.')[_0x5337d1(0x16c)]();}catch(_0x18399a){await this[_0x5337d1(0x15f)](),await this[_0x5337d1(0x136)][_0x5337d1(0x167)](this[_0x5337d1(0x116)]+'\x20'+_0x18399a)[_0x5337d1(0x16c)]();throw _0x18399a;}}async['run'](_0x3c8b8b,_0x34b132){const _0x5b8e7a=a124_0x13056c;var _0x1211c6,_0x5882ba;this[_0x5b8e7a(0x136)]=typedi_1[_0x5b8e7a(0x172)][_0x5b8e7a(0x14b)](providers_tokens_1[_0x5b8e7a(0x147)][_0x5b8e7a(0x180)]),this[_0x5b8e7a(0x116)]=(_0x34b132?_0x34b132+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto'][_0x5b8e7a(0x13e)]+']',await this['sfLogger'][_0x5b8e7a(0x11b)](this[_0x5b8e7a(0x116)]+_0x5b8e7a(0x153));const _0x44e00b=!!((_0x1211c6=_0x3c8b8b[_0x5b8e7a(0x14f)])===null||_0x1211c6===void 0x0?void 0x0:_0x1211c6['writed'])||!!((_0x5882ba=_0x3c8b8b[_0x5b8e7a(0x14f)])===null||_0x5882ba===void 0x0?void 0x0:_0x5882ba[_0x5b8e7a(0x161)]);if(!_0x44e00b){await this['sfLogger'][_0x5b8e7a(0x11b)](this[_0x5b8e7a(0x116)]+_0x5b8e7a(0x16b))['send']();return;}this[_0x5b8e7a(0x176)]=_0x3c8b8b,await this[_0x5b8e7a(0x12d)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a124_0x13056c(0x135)])({'transient':!![]})],CommitComponentsJob),exports[a124_0x13056c(0x13f)]=CommitComponentsJob;