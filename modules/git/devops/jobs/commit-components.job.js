function a73_0x256c(_0x6d159a,_0x333f00){const _0x5e4567=a73_0x49e8();return a73_0x256c=function(_0xf50e74,_0x5294a9){_0xf50e74=_0xf50e74-0x1c9;let _0x49e874=_0x5e4567[_0xf50e74];return _0x49e874;},a73_0x256c(_0x6d159a,_0x333f00);}const a73_0x56ca59=a73_0x256c;(function(_0x28da6a,_0x48e2ce){const _0x5704df=a73_0x256c,_0x1d5601=_0x28da6a();while(!![]){try{const _0x1c1cc9=parseInt(_0x5704df(0x218))/0x1*(-parseInt(_0x5704df(0x239))/0x2)+parseInt(_0x5704df(0x1cd))/0x3*(parseInt(_0x5704df(0x1e2))/0x4)+-parseInt(_0x5704df(0x1d2))/0x5*(-parseInt(_0x5704df(0x1ea))/0x6)+-parseInt(_0x5704df(0x238))/0x7+-parseInt(_0x5704df(0x223))/0x8+parseInt(_0x5704df(0x1de))/0x9*(-parseInt(_0x5704df(0x1d4))/0xa)+parseInt(_0x5704df(0x215))/0xb;if(_0x1c1cc9===_0x48e2ce)break;else _0x1d5601['push'](_0x1d5601['shift']());}catch(_0x3d4099){_0x1d5601['push'](_0x1d5601['shift']());}}}(a73_0x49e8,0xd5459));const a73_0x5294a9=(function(){let _0xd6900f=!![];return function(_0x3f0fde,_0x243c4f){const _0x47e480=_0xd6900f?function(){const _0x32773d=a73_0x256c;if(_0x243c4f){const _0x2aa528=_0x243c4f[_0x32773d(0x1d0)](_0x3f0fde,arguments);return _0x243c4f=null,_0x2aa528;}}:function(){};return _0xd6900f=![],_0x47e480;};}()),a73_0xf50e74=a73_0x5294a9(this,function(){const _0x1f78ce=a73_0x256c;return a73_0xf50e74[_0x1f78ce(0x22a)]()[_0x1f78ce(0x224)](_0x1f78ce(0x20b))[_0x1f78ce(0x22a)]()[_0x1f78ce(0x1d1)](a73_0xf50e74)['search'](_0x1f78ce(0x20b));});a73_0xf50e74();'use strict';var __createBinding=this&&this[a73_0x56ca59(0x229)]||(Object['create']?function(_0x21be86,_0x166a43,_0x57eab6,_0x38ed3d){const _0x547a9e=a73_0x56ca59;if(_0x38ed3d===undefined)_0x38ed3d=_0x57eab6;var _0x1d9efe=Object[_0x547a9e(0x1e0)](_0x166a43,_0x57eab6);(!_0x1d9efe||('get'in _0x1d9efe?!_0x166a43[_0x547a9e(0x202)]:_0x1d9efe[_0x547a9e(0x1d7)]||_0x1d9efe[_0x547a9e(0x21f)]))&&(_0x1d9efe={'enumerable':!![],'get':function(){return _0x166a43[_0x57eab6];}}),Object[_0x547a9e(0x22e)](_0x21be86,_0x38ed3d,_0x1d9efe);}:function(_0x33dba5,_0x12b416,_0x2d1b7e,_0x3b5347){if(_0x3b5347===undefined)_0x3b5347=_0x2d1b7e;_0x33dba5[_0x3b5347]=_0x12b416[_0x2d1b7e];}),__setModuleDefault=this&&this[a73_0x56ca59(0x1e4)]||(Object[a73_0x56ca59(0x1e7)]?function(_0x47ca02,_0x227208){const _0x32371b=a73_0x56ca59;Object[_0x32371b(0x22e)](_0x47ca02,_0x32371b(0x1f9),{'enumerable':!![],'value':_0x227208});}:function(_0x1a04b8,_0x5aee8){const _0x24e66f=a73_0x56ca59;_0x1a04b8[_0x24e66f(0x1f9)]=_0x5aee8;}),__decorate=this&&this[a73_0x56ca59(0x1da)]||function(_0x4a22c0,_0x136c9f,_0x53104e,_0x301442){const _0x5d4697=a73_0x56ca59;var _0x4a4964=arguments[_0x5d4697(0x1e6)],_0xad2f62=_0x4a4964<0x3?_0x136c9f:_0x301442===null?_0x301442=Object[_0x5d4697(0x1e0)](_0x136c9f,_0x53104e):_0x301442,_0x3ca815;if(typeof Reflect==='object'&&typeof Reflect[_0x5d4697(0x20d)]==='function')_0xad2f62=Reflect[_0x5d4697(0x20d)](_0x4a22c0,_0x136c9f,_0x53104e,_0x301442);else{for(var _0x15040c=_0x4a22c0[_0x5d4697(0x1e6)]-0x1;_0x15040c>=0x0;_0x15040c--)if(_0x3ca815=_0x4a22c0[_0x15040c])_0xad2f62=(_0x4a4964<0x3?_0x3ca815(_0xad2f62):_0x4a4964>0x3?_0x3ca815(_0x136c9f,_0x53104e,_0xad2f62):_0x3ca815(_0x136c9f,_0x53104e))||_0xad2f62;}return _0x4a4964>0x3&&_0xad2f62&&Object[_0x5d4697(0x22e)](_0x136c9f,_0x53104e,_0xad2f62),_0xad2f62;},__importStar=this&&this['__importStar']||function(_0x145ae3){const _0x827659=a73_0x56ca59;if(_0x145ae3&&_0x145ae3['__esModule'])return _0x145ae3;var _0x128537={};if(_0x145ae3!=null){for(var _0x326cd7 in _0x145ae3)if(_0x326cd7!=='default'&&Object[_0x827659(0x1d8)][_0x827659(0x1f8)][_0x827659(0x1ce)](_0x145ae3,_0x326cd7))__createBinding(_0x128537,_0x145ae3,_0x326cd7);}return __setModuleDefault(_0x128537,_0x145ae3),_0x128537;},__importDefault=this&&this['__importDefault']||function(_0x40aa27){const _0x512c25=a73_0x56ca59;return _0x40aa27&&_0x40aa27[_0x512c25(0x202)]?_0x40aa27:{'default':_0x40aa27};};function a73_0x49e8(){const _0x1d9e49=['CommitComponentsDto','__createBinding','toString','../../internal/fs.internal','writeFlosumComponents','master','defineProperty','cleanUp','splice','../../providers/providers.tokens','../utils/git.utils','removeDir','../../salesforce/utils/sfdx.utils','\x20components','branch','sfLogger','10866394MnLMAX','2iNHrIj','catch','clone','log','dir','prefix','\x20Start\x20cloning\x20repository.','1876884YYBTCk','call','commitData','apply','constructor','50RejBBC','getGitShellAuthorizationString','10qXozis','GitUtils','fileType','writable','prototype','copyMdapiTo','__decorate','events','reduce','MDApiUtils','8136432bWHqWA','\x20Prepare\x20mdapi\x20files.','getOwnPropertyDescriptor','isLoggedIn','4RlgcCF','\x20Nothing\x20to\x20commit.\x20Skip.','__setModuleDefault','isSFDXProject','length','create','COMPONENTS_PER_TICK','writed','259410XCslwI','provider','Bitbucket','prepareMdapi','fileName','now','../utils/mdapi.utils','componentsToDelete','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','sfdxUtils','values','\x20Checking\x20deleted\x20components.','ms.\x20Committed\x20components\x20-\x20','\x20Start\x20converting\x20to\x20SFDX.','hasOwnProperty','default','clearDir','../../providers/api/bitbucket-api.service','path','sort','run','../utils/sfdx.utils','join','\x20Checking\x20written\x20components.','__esModule','startTime','../../providers/types/git-provider','\x20Preparing\x20to\x20delete\x20components','groupComponentsByFileName','name','getProtocol','get','copyProjectTo','(((.+)+)+)+$','getRemote','decorate','mdapiUtils','commitAndPush','../../../../constants','gitUtils','\x20Deleted\x20','replace','BitbucketApiService','28655451FoLTBL','deleted','\x20Wrote\x20','12629qiBnWB','includes','send','Tokens','removeComponents','error','gitUrl','configurable','componentsToWrite','exec','\x20Checking\x20commit\x20components.','2563512daAyoP','search','push','writeComponents','components'];a73_0x49e8=function(){return _0x1d9e49;};return a73_0x49e8();}Object[a73_0x56ca59(0x22e)](exports,a73_0x56ca59(0x202),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a73_0x56ca59(0x1db))),git_utils_1=require(a73_0x56ca59(0x232)),mdapi_utils_1=require(a73_0x56ca59(0x1f0)),sfdx_utils_1=require(a73_0x56ca59(0x1ff)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require('../../../shared/utils'),constants_1=require(a73_0x56ca59(0x210)),git_provider_1=require(a73_0x56ca59(0x204)),bitbucket_api_service_1=require(a73_0x56ca59(0x1fb)),sfdx_utils_2=require(a73_0x56ca59(0x234)),fs_internal_1=require(a73_0x56ca59(0x22b)),path_1=require(a73_0x56ca59(0x1fc)),providers_tokens_1=require(a73_0x56ca59(0x231));let CommitComponentsJob=class CommitComponentsJob extends events_1[a73_0x56ca59(0x1f9)]{constructor(){const _0x216306=a73_0x56ca59;super(...arguments),this[_0x216306(0x1e8)]=0x3e8,this['componentsToWrite']=0x0,this[_0x216306(0x1f1)]=0x0,this[_0x216306(0x203)]=Date[_0x216306(0x1ef)]();}async['getRemote'](){const _0x523663=a73_0x56ca59,{repo:_0x5c6aa9}=this['commitData'],_0x20b646=typedi_1[_0x523663(0x1f9)][_0x523663(0x209)](providers_tokens_1[_0x523663(0x21b)]['credentials']);if(this[_0x523663(0x1cf)][_0x523663(0x1eb)]===git_provider_1['GitProvider'][_0x523663(0x1ec)]){const _0x1d58d1=typedi_1[_0x523663(0x1f9)][_0x523663(0x209)](bitbucket_api_service_1[_0x523663(0x214)]);await _0x1d58d1[_0x523663(0x1e1)]();}return _0x5c6aa9[_0x523663(0x21e)][_0x523663(0x213)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x523663(0x208)])(_0x5c6aa9[_0x523663(0x21e)])+'://'+_0x20b646[_0x523663(0x1d3)]()+'@');}['groupComponentsByFileName'](_0x3e3108){const _0x24857e=a73_0x56ca59;var _0x43d862;_0x3e3108[_0x24857e(0x1fd)](_0x28cbe9=>child_types_1[_0x24857e(0x1f9)]['includes'](_0x28cbe9[_0x24857e(0x1d6)])?0x1:-0x1);const _0x5040e7={};for(const _0x30e6db of _0x3e3108){_0x5040e7[_0x43d862=_0x30e6db['fileName']]||(_0x5040e7[_0x43d862]=[]),_0x5040e7[_0x30e6db[_0x24857e(0x1ee)]][_0x24857e(0x225)](_0x30e6db);}return Object[_0x24857e(0x1f4)](_0x5040e7)[_0x24857e(0x1dc)]((_0x4ac73b,_0xda0ac8)=>[..._0x4ac73b,..._0xda0ac8],[]);}async[a73_0x56ca59(0x226)](_0x1edb18){const _0x117afb=a73_0x56ca59;_0x1edb18=this[_0x117afb(0x206)](_0x1edb18);let _0x347344=0x0;while(_0x1edb18[_0x117afb(0x1e6)]){const _0xc979e8=_0x1edb18[_0x117afb(0x230)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils'][_0x117afb(0x22c)](_0xc979e8,{'skipChildErrors':this[_0x117afb(0x1cf)][_0x117afb(0x236)][_0x117afb(0x207)]===_0x117afb(0x22d)}),_0x347344+=_0xc979e8[_0x117afb(0x1e6)],this[_0x117afb(0x237)]['log'](this[_0x117afb(0x1cb)]+_0x117afb(0x217)+_0x347344+'/'+this[_0x117afb(0x220)]+_0x117afb(0x235)),await this[_0x117afb(0x237)]['send']();}}async[a73_0x56ca59(0x21c)](_0x3d3535){const _0x419709=a73_0x56ca59;_0x3d3535[_0x419709(0x1fd)](_0x1ca23e=>child_types_1[_0x419709(0x1f9)][_0x419709(0x219)](_0x1ca23e['type'])?-0x1:0x1);let _0x30cc6e=0x0;while(_0x3d3535['length']){const _0x24cd83=_0x3d3535[_0x419709(0x230)](0x0,this[_0x419709(0x1e8)]);await this[_0x419709(0x20e)][_0x419709(0x21c)](_0x24cd83),_0x30cc6e+=_0x24cd83[_0x419709(0x1e6)],this[_0x419709(0x237)][_0x419709(0x1c9)](this[_0x419709(0x1cb)]+_0x419709(0x212)+_0x30cc6e+'/'+this[_0x419709(0x1f1)]+_0x419709(0x235)),await this[_0x419709(0x237)][_0x419709(0x21a)]();}}async[a73_0x56ca59(0x22f)](){const _0x306c2b=a73_0x56ca59;this[_0x306c2b(0x211)]&&await this[_0x306c2b(0x211)]['removeDir']()[_0x306c2b(0x23a)](()=>void 0x0),this['mdapiUtils']&&await this['mdapiUtils'][_0x306c2b(0x233)]()[_0x306c2b(0x23a)](()=>void 0x0),this['sfdxUtils']&&await this['sfdxUtils'][_0x306c2b(0x233)]()[_0x306c2b(0x23a)](()=>void 0x0);}async[a73_0x56ca59(0x221)](){const _0x4777e0=a73_0x56ca59,{repo:_0x55287f,branch:_0x42a7b6,components:_0x5af090,convertToSFDX:_0x1cb125,message:_0x40f9b2,user:_0x345fbb}=this[_0x4777e0(0x1cf)];this[_0x4777e0(0x20e)]=new mdapi_utils_1[(_0x4777e0(0x1dd))](),this[_0x4777e0(0x211)]=new git_utils_1[(_0x4777e0(0x1d5))](await this[_0x4777e0(0x20c)]()),this[_0x4777e0(0x1f3)]=new sfdx_utils_1['SFDXUtils']();let _0x58b7bc=_0x1cb125;try{await this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+_0x4777e0(0x1cc))[_0x4777e0(0x21a)](),await this['gitUtils'][_0x4777e0(0x23b)](_0x42a7b6['name'],_0x55287f[_0x4777e0(0x207)]);!this['commitData']['force']?(this['sfLogger'][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+_0x4777e0(0x1df)),await this[_0x4777e0(0x20e)][_0x4777e0(0x1ed)](this[_0x4777e0(0x211)][_0x4777e0(0x1ca)])):this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+_0x4777e0(0x201))[_0x4777e0(0x21a)]();_0x5af090[_0x4777e0(0x1e9)]&&(this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+'\x20Preparing\x20to\x20write\x20components'),this[_0x4777e0(0x220)]=_0x5af090[_0x4777e0(0x1e9)][_0x4777e0(0x1e6)],await this[_0x4777e0(0x226)](_0x5af090[_0x4777e0(0x1e9)]),await this[_0x4777e0(0x237)]['send']());await this['sfLogger'][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+_0x4777e0(0x1f5))[_0x4777e0(0x21a)]();_0x5af090['deleted']&&(this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+_0x4777e0(0x205)),this[_0x4777e0(0x1f1)]=_0x5af090['deleted'][_0x4777e0(0x1e6)],await this[_0x4777e0(0x21c)](_0x5af090[_0x4777e0(0x216)]),await this[_0x4777e0(0x237)][_0x4777e0(0x21a)]());await this[_0x4777e0(0x237)][_0x4777e0(0x21a)]();const _0x24484e=await fs_internal_1['FS']['isEmptyDir'](this[_0x4777e0(0x211)][_0x4777e0(0x1ca)]);await sfdx_utils_2['SFDX'][_0x4777e0(0x1e5)](this[_0x4777e0(0x211)]['dir'])?(_0x58b7bc=!![],await fs_internal_1['FS'][_0x4777e0(0x233)]((0x0,path_1[_0x4777e0(0x200)])(this[_0x4777e0(0x211)]['dir'],'force-app'))):(_0x58b7bc&&(!_0x24484e&&(_0x58b7bc=![])),await this['gitUtils'][_0x4777e0(0x1fa)]());_0x58b7bc?(await this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+_0x4777e0(0x1f7))[_0x4777e0(0x21a)](),await this['sfdxUtils']['createProjectFrom'](this['mdapiUtils'][_0x4777e0(0x1ca)]),await this[_0x4777e0(0x1f3)][_0x4777e0(0x20a)](this[_0x4777e0(0x211)][_0x4777e0(0x1ca)],!_0x24484e),await this['sfdxUtils'][_0x4777e0(0x233)]()):(await this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x4777e0(0x21a)](),await this[_0x4777e0(0x20e)][_0x4777e0(0x1d9)](this[_0x4777e0(0x211)]['dir']));await this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')[_0x4777e0(0x21a)](),await this[_0x4777e0(0x211)][_0x4777e0(0x20f)](_0x40f9b2,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x345fbb[_0x4777e0(0x207)]},_0x42a7b6[_0x4777e0(0x207)]),await this[_0x4777e0(0x211)][_0x4777e0(0x233)](),await this[_0x4777e0(0x20e)][_0x4777e0(0x233)]();const _0x50f609=this[_0x4777e0(0x220)]+this[_0x4777e0(0x1f1)];await this[_0x4777e0(0x237)][_0x4777e0(0x1c9)](this[_0x4777e0(0x1cb)]+_0x4777e0(0x1f2)+(Date[_0x4777e0(0x1ef)]()-this[_0x4777e0(0x203)])+_0x4777e0(0x1f6)+_0x50f609+'.')['send']();}catch(_0x526a98){await this['cleanUp'](),await this[_0x4777e0(0x237)][_0x4777e0(0x21d)](this[_0x4777e0(0x1cb)]+'\x20'+_0x526a98)[_0x4777e0(0x21a)]();throw _0x526a98;}}async[a73_0x56ca59(0x1fe)](_0x3ded0e,_0x6ffa4e){const _0x7b0b3=a73_0x56ca59;var _0x21ba05,_0x36919d;this['sfLogger']=typedi_1[_0x7b0b3(0x1f9)][_0x7b0b3(0x209)](providers_tokens_1[_0x7b0b3(0x21b)]['logger']),this[_0x7b0b3(0x1cb)]=(_0x6ffa4e?_0x6ffa4e+'\x20':'')+'['+commit_components_dto_1[_0x7b0b3(0x228)][_0x7b0b3(0x207)]+']',await this[_0x7b0b3(0x237)]['log'](this[_0x7b0b3(0x1cb)]+_0x7b0b3(0x222));const _0x544722=!!((_0x21ba05=_0x3ded0e[_0x7b0b3(0x227)])===null||_0x21ba05===void 0x0?void 0x0:_0x21ba05[_0x7b0b3(0x1e9)])||!!((_0x36919d=_0x3ded0e['components'])===null||_0x36919d===void 0x0?void 0x0:_0x36919d[_0x7b0b3(0x216)]);if(!_0x544722){await this[_0x7b0b3(0x237)]['log'](this[_0x7b0b3(0x1cb)]+_0x7b0b3(0x1e3))[_0x7b0b3(0x21a)]();return;}this['commitData']=_0x3ded0e,await this[_0x7b0b3(0x221)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;