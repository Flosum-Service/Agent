function a121_0x3ace(_0x9cea17,_0xe35e9a){const _0x21551f=a121_0x455a();return a121_0x3ace=function(_0x4bdae7,_0x1a7815){_0x4bdae7=_0x4bdae7-0x6e;let _0x455aed=_0x21551f[_0x4bdae7];return _0x455aed;},a121_0x3ace(_0x9cea17,_0xe35e9a);}const a121_0x462057=a121_0x3ace;(function(_0x5841bb,_0x475c71){const _0x521ee9=a121_0x3ace,_0x11fe5c=_0x5841bb();while(!![]){try{const _0x43b8a=parseInt(_0x521ee9(0x84))/0x1+-parseInt(_0x521ee9(0xab))/0x2*(-parseInt(_0x521ee9(0xd5))/0x3)+parseInt(_0x521ee9(0xb7))/0x4*(-parseInt(_0x521ee9(0xb3))/0x5)+parseInt(_0x521ee9(0x97))/0x6*(parseInt(_0x521ee9(0xda))/0x7)+parseInt(_0x521ee9(0xa1))/0x8+-parseInt(_0x521ee9(0x8e))/0x9+-parseInt(_0x521ee9(0x75))/0xa*(parseInt(_0x521ee9(0x7d))/0xb);if(_0x43b8a===_0x475c71)break;else _0x11fe5c['push'](_0x11fe5c['shift']());}catch(_0x4e07f7){_0x11fe5c['push'](_0x11fe5c['shift']());}}}(a121_0x455a,0x868d0));const a121_0x1a7815=(function(){let _0x524076=!![];return function(_0x3754e7,_0x5d1b06){const _0x2ef0b7=_0x524076?function(){if(_0x5d1b06){const _0x4a1804=_0x5d1b06['apply'](_0x3754e7,arguments);return _0x5d1b06=null,_0x4a1804;}}:function(){};return _0x524076=![],_0x2ef0b7;};}()),a121_0x4bdae7=a121_0x1a7815(this,function(){const _0x3ecdc6=a121_0x3ace;return a121_0x4bdae7[_0x3ecdc6(0x81)]()[_0x3ecdc6(0xb2)](_0x3ecdc6(0x83))['toString']()[_0x3ecdc6(0xc8)](a121_0x4bdae7)[_0x3ecdc6(0xb2)](_0x3ecdc6(0x83));});a121_0x4bdae7();'use strict';var __createBinding=this&&this[a121_0x462057(0x6f)]||(Object['create']?function(_0x456560,_0x535227,_0x5f2882,_0x5bff68){const _0x9fd1b6=a121_0x462057;if(_0x5bff68===undefined)_0x5bff68=_0x5f2882;var _0x188450=Object[_0x9fd1b6(0x7b)](_0x535227,_0x5f2882);(!_0x188450||(_0x9fd1b6(0x76)in _0x188450?!_0x535227[_0x9fd1b6(0xa5)]:_0x188450[_0x9fd1b6(0x94)]||_0x188450[_0x9fd1b6(0xb4)]))&&(_0x188450={'enumerable':!![],'get':function(){return _0x535227[_0x5f2882];}}),Object[_0x9fd1b6(0xb1)](_0x456560,_0x5bff68,_0x188450);}:function(_0x5a76eb,_0x28c7a1,_0x1b6bb2,_0x450192){if(_0x450192===undefined)_0x450192=_0x1b6bb2;_0x5a76eb[_0x450192]=_0x28c7a1[_0x1b6bb2];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x2ecf52,_0x4309f5){const _0x2c8458=a121_0x462057;Object['defineProperty'](_0x2ecf52,_0x2c8458(0x82),{'enumerable':!![],'value':_0x4309f5});}:function(_0x1f905b,_0x485d0c){const _0x1f65b3=a121_0x462057;_0x1f905b[_0x1f65b3(0x82)]=_0x485d0c;}),__decorate=this&&this[a121_0x462057(0x72)]||function(_0x324a90,_0x3a6a81,_0x55aff4,_0x399220){const _0x175f21=a121_0x462057;var _0x4d2e2b=arguments[_0x175f21(0x85)],_0x3142e8=_0x4d2e2b<0x3?_0x3a6a81:_0x399220===null?_0x399220=Object[_0x175f21(0x7b)](_0x3a6a81,_0x55aff4):_0x399220,_0x2843a8;if(typeof Reflect==='object'&&typeof Reflect[_0x175f21(0x92)]==='function')_0x3142e8=Reflect[_0x175f21(0x92)](_0x324a90,_0x3a6a81,_0x55aff4,_0x399220);else{for(var _0x4d5d20=_0x324a90[_0x175f21(0x85)]-0x1;_0x4d5d20>=0x0;_0x4d5d20--)if(_0x2843a8=_0x324a90[_0x4d5d20])_0x3142e8=(_0x4d2e2b<0x3?_0x2843a8(_0x3142e8):_0x4d2e2b>0x3?_0x2843a8(_0x3a6a81,_0x55aff4,_0x3142e8):_0x2843a8(_0x3a6a81,_0x55aff4))||_0x3142e8;}return _0x4d2e2b>0x3&&_0x3142e8&&Object[_0x175f21(0xb1)](_0x3a6a81,_0x55aff4,_0x3142e8),_0x3142e8;},__importStar=this&&this['__importStar']||function(_0x2f46e3){const _0x5ca976=a121_0x462057;if(_0x2f46e3&&_0x2f46e3[_0x5ca976(0xa5)])return _0x2f46e3;var _0x5ee589={};if(_0x2f46e3!=null){for(var _0x215459 in _0x2f46e3)if(_0x215459!=='default'&&Object['prototype'][_0x5ca976(0x71)]['call'](_0x2f46e3,_0x215459))__createBinding(_0x5ee589,_0x2f46e3,_0x215459);}return __setModuleDefault(_0x5ee589,_0x2f46e3),_0x5ee589;},__importDefault=this&&this[a121_0x462057(0xa0)]||function(_0xdd2a98){return _0xdd2a98&&_0xdd2a98['__esModule']?_0xdd2a98:{'default':_0xdd2a98};};Object[a121_0x462057(0xb1)](exports,a121_0x462057(0xa5),{'value':!![]}),exports[a121_0x462057(0xb6)]=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a121_0x462057(0xa3))),git_utils_1=require(a121_0x462057(0xd2)),mdapi_utils_1=require(a121_0x462057(0x9b)),sfdx_utils_1=require(a121_0x462057(0xb9)),typedi_1=__importStar(require(a121_0x462057(0xa2))),child_types_1=__importDefault(require(a121_0x462057(0xbb))),utils_1=require('../../../shared/utils'),constants_1=require(a121_0x462057(0x95)),git_provider_1=require(a121_0x462057(0xd8)),bitbucket_api_service_1=require(a121_0x462057(0xac)),sfdx_utils_2=require(a121_0x462057(0xe1)),fs_internal_1=require(a121_0x462057(0x6e)),path_1=require('path'),providers_tokens_1=require(a121_0x462057(0x93)),constants_2=require(a121_0x462057(0x95));function a121_0x455a(){const _0x34bd5d=['SFDXUtils','deleted','Tokens','../../salesforce/utils/sfdx.utils','getGitShellAuthorizationString','../../internal/fs.internal','__createBinding','gitUtils','hasOwnProperty','__decorate','DEFAULT_GIT_USER_EMAIL','ms.\x20Committed\x20components\x20-\x20','10dSyaHK','get','\x20Copying\x20mdapi\x20to\x20git\x20folder.','splice','getRemote','removeComponents','getOwnPropertyDescriptor','mdapiUtils','8899748ryyvib','copyProjectTo','\x20Start\x20cloning\x20repository.','\x20Preparing\x20to\x20write\x20components','toString','default','(((.+)+)+)+$','174342pISVbW','length','type','copySFDXIgnoredComponents','error','\x20components','createProjectFrom','sort','\x20Prepare\x20mdapi\x20files.','\x20Checking\x20commit\x20components.','5547672FcKZuF','getProtocol','commitAndPush','FORCE_APP_DEFAULT_DIR','decorate','../../providers/providers.tokens','writable','../../../../constants','values','18cFtaNO','run','Bitbucket','dir','../utils/mdapi.utils','isConvertToSfdx','writed','prepareMdapi','join','__importDefault','7314176MawHVK','typedi','events','isLoggedIn','__esModule','includes','provider','now','componentsToDelete','GitUtils','200vNkBFM','../../providers/api/bitbucket-api.service','fileName','MDApiUtils','recordType','master','defineProperty','search','1552940DuRUDw','configurable','://','CommitComponentsJob','12CKHcKs','send','../utils/sfdx.utils','reduce','../../parsers/data/child-types','BitbucketApiService','replace','isEmptyDir','exec','gitUrl','writeComponents','branch','catch','sfdxUtils','SFDX','COMPONENTS_PER_TICK','componentsToWrite','constructor','commitData','name','\x20Deleted\x20','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','cleanUp','\x20Checking\x20written\x20components.','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','copyMdapiTo','sfLogger','../utils/git.utils','clearDir','prefix','25137ZSwCQl','groupComponentsByFileName','startTime','../../providers/types/git-provider','removeDir','2290974WDSWku','log','push','components'];a121_0x455a=function(){return _0x34bd5d;};return a121_0x455a();}let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(){const _0x52a1b3=a121_0x462057;super(...arguments),this[_0x52a1b3(0xc6)]=0x3e8,this[_0x52a1b3(0xc7)]=0x0,this[_0x52a1b3(0xa9)]=0x0,this[_0x52a1b3(0xd7)]=Date[_0x52a1b3(0xa8)]();}async[a121_0x462057(0x79)](){const _0x45a0bf=a121_0x462057,{repo:_0x26e9cb}=this[_0x45a0bf(0xc9)],_0x4a4c35=typedi_1[_0x45a0bf(0x82)][_0x45a0bf(0x76)](providers_tokens_1['Tokens']['credentials']);if(this[_0x45a0bf(0xc9)][_0x45a0bf(0xa7)]===git_provider_1['GitProvider'][_0x45a0bf(0x99)]){const _0x4d92dd=typedi_1[_0x45a0bf(0x82)][_0x45a0bf(0x76)](bitbucket_api_service_1[_0x45a0bf(0xbc)]);await _0x4d92dd[_0x45a0bf(0xa4)]();}return _0x26e9cb[_0x45a0bf(0xc0)][_0x45a0bf(0xbd)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x45a0bf(0x8f)])(_0x26e9cb['gitUrl'])+_0x45a0bf(0xb5)+_0x4a4c35[_0x45a0bf(0xe2)]()+'@');}[a121_0x462057(0xd6)](_0x115a79){const _0x2ac6f1=a121_0x462057;var _0x51d1fc;_0x115a79[_0x2ac6f1(0x8b)](_0x19132d=>child_types_1[_0x2ac6f1(0x82)][_0x2ac6f1(0xa6)](_0x19132d['fileType'])?0x1:-0x1);const _0x5e179b={};for(const _0x5c0c11 of _0x115a79){_0x5e179b[_0x51d1fc=_0x5c0c11[_0x2ac6f1(0xad)]]||(_0x5e179b[_0x51d1fc]=[]),_0x5e179b[_0x5c0c11['fileName']][_0x2ac6f1(0xdc)](_0x5c0c11);}return Object[_0x2ac6f1(0x96)](_0x5e179b)[_0x2ac6f1(0xba)]((_0x59a422,_0x4ea31f)=>[..._0x59a422,..._0x4ea31f],[]);}async[a121_0x462057(0xc1)](_0x1efef8){const _0x6c3905=a121_0x462057;_0x1efef8=this[_0x6c3905(0xd6)](_0x1efef8);let _0x3f82d9=0x0;while(_0x1efef8[_0x6c3905(0x85)]){const _0x4a0e81=_0x1efef8[_0x6c3905(0x78)](0x0,this[_0x6c3905(0xc6)]);await this['mdapiUtils']['writeFlosumComponents'](_0x4a0e81,{'skipChildErrors':this[_0x6c3905(0xc9)][_0x6c3905(0xc2)][_0x6c3905(0xca)]===_0x6c3905(0xb0),'recordType':this[_0x6c3905(0xc9)]['recordType']}),_0x3f82d9+=_0x4a0e81[_0x6c3905(0x85)],this[_0x6c3905(0xd1)][_0x6c3905(0xdb)](this[_0x6c3905(0xd4)]+'\x20Wrote\x20'+_0x3f82d9+'/'+this[_0x6c3905(0xc7)]+_0x6c3905(0x89)),await this[_0x6c3905(0xd1)][_0x6c3905(0xb8)]();}}async[a121_0x462057(0x7a)](_0x1f3d98){const _0x1769ae=a121_0x462057;_0x1f3d98[_0x1769ae(0x8b)](_0x575db1=>child_types_1[_0x1769ae(0x82)][_0x1769ae(0xa6)](_0x575db1[_0x1769ae(0x86)])?-0x1:0x1);let _0x266cbc=0x0;while(_0x1f3d98['length']){const _0x4f90b4=_0x1f3d98[_0x1769ae(0x78)](0x0,this[_0x1769ae(0xc6)]);await this[_0x1769ae(0x7c)][_0x1769ae(0x7a)](_0x4f90b4,this[_0x1769ae(0xc9)][_0x1769ae(0xaf)]),_0x266cbc+=_0x4f90b4['length'],this[_0x1769ae(0xd1)]['log'](this[_0x1769ae(0xd4)]+_0x1769ae(0xcb)+_0x266cbc+'/'+this['componentsToDelete']+'\x20components'),await this[_0x1769ae(0xd1)]['send']();}}async[a121_0x462057(0xcd)](){const _0x597330=a121_0x462057;this[_0x597330(0x70)]&&await this['gitUtils'][_0x597330(0xd9)]()[_0x597330(0xc3)](()=>void 0x0),this['mdapiUtils']&&await this[_0x597330(0x7c)][_0x597330(0xd9)]()[_0x597330(0xc3)](()=>void 0x0),this[_0x597330(0xc4)]&&await this[_0x597330(0xc4)]['removeDir']()[_0x597330(0xc3)](()=>void 0x0);}async['exec'](){const _0x162628=a121_0x462057,{repo:_0x3d0444,branch:_0x4198f5,components:_0x56da48,convertToSFDX:_0x28457f,message:_0x203783,user:_0x5da1c8}=this['commitData'];this[_0x162628(0x7c)]=new mdapi_utils_1[(_0x162628(0xae))](),this['gitUtils']=new git_utils_1[(_0x162628(0xaa))](await this[_0x162628(0x79)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x162628(0xde))]();let _0x335f7a=_0x28457f&&this[_0x162628(0xc4)][_0x162628(0x9c)](this['commitData'][_0x162628(0xaf)]);try{await this[_0x162628(0xd1)][_0x162628(0xdb)](this[_0x162628(0xd4)]+_0x162628(0x7f))[_0x162628(0xb8)](),await this[_0x162628(0x70)]['clone'](_0x4198f5[_0x162628(0xca)],_0x3d0444[_0x162628(0xca)]);!this[_0x162628(0xc9)]['force']?(this[_0x162628(0xd1)]['log'](this[_0x162628(0xd4)]+_0x162628(0x8c)),await this['mdapiUtils'][_0x162628(0x9e)](this['gitUtils'][_0x162628(0x9a)])):this[_0x162628(0xd1)][_0x162628(0xdb)](this['prefix']+_0x162628(0xcc));await this[_0x162628(0xd1)][_0x162628(0xdb)](this['prefix']+_0x162628(0xce))[_0x162628(0xb8)]();_0x56da48[_0x162628(0x9d)]&&(this[_0x162628(0xd1)][_0x162628(0xdb)](this[_0x162628(0xd4)]+_0x162628(0x80)),this[_0x162628(0xc7)]=_0x56da48['writed']['length'],await this['writeComponents'](_0x56da48[_0x162628(0x9d)]),await this[_0x162628(0xd1)]['send']());await this[_0x162628(0xd1)][_0x162628(0xdb)](this[_0x162628(0xd4)]+'\x20Checking\x20deleted\x20components.')[_0x162628(0xb8)]();_0x56da48['deleted']&&(this[_0x162628(0xd1)]['log'](this['prefix']+'\x20Preparing\x20to\x20delete\x20components'),this[_0x162628(0xa9)]=_0x56da48[_0x162628(0xdf)][_0x162628(0x85)],await this['removeComponents'](_0x56da48[_0x162628(0xdf)]),await this[_0x162628(0xd1)]['send']());await this[_0x162628(0xd1)][_0x162628(0xb8)]();const _0x1ba2d7=await fs_internal_1['FS'][_0x162628(0xbe)](this[_0x162628(0x70)][_0x162628(0x9a)]);await sfdx_utils_2[_0x162628(0xc5)]['isSFDXProject'](this[_0x162628(0x70)][_0x162628(0x9a)])?(_0x335f7a=!![],await fs_internal_1['FS'][_0x162628(0xd9)]((0x0,path_1['join'])(this[_0x162628(0x70)][_0x162628(0x9a)],'force-app'))):(_0x335f7a&&(!_0x1ba2d7&&(_0x335f7a=![])),await this[_0x162628(0x70)][_0x162628(0xd3)]());_0x335f7a?(await this[_0x162628(0xd1)][_0x162628(0xdb)](this[_0x162628(0xd4)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x162628(0xb8)](),await this['sfdxUtils'][_0x162628(0x8a)](this['mdapiUtils'][_0x162628(0x9a)]),await this[_0x162628(0xc4)][_0x162628(0x7e)](this['gitUtils']['dir'],!_0x1ba2d7),await this['sfdxUtils'][_0x162628(0x87)](this[_0x162628(0x7c)]['dir'],(0x0,path_1[_0x162628(0x9f)])(this[_0x162628(0x70)]['dir'],constants_2[_0x162628(0x91)])),await this[_0x162628(0xc4)]['removeDir']()):(await this['sfLogger'][_0x162628(0xdb)](this[_0x162628(0xd4)]+_0x162628(0x77))['send'](),await this[_0x162628(0x7c)][_0x162628(0xd0)](this[_0x162628(0x70)]['dir']));await this[_0x162628(0xd1)][_0x162628(0xdb)](this[_0x162628(0xd4)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')['send'](),await this[_0x162628(0x70)][_0x162628(0x90)](_0x203783,{'email':constants_1[_0x162628(0x73)],'name':_0x5da1c8[_0x162628(0xca)]},_0x4198f5[_0x162628(0xca)]),await this[_0x162628(0x70)]['removeDir'](),await this[_0x162628(0x7c)]['removeDir']();const _0x2d2013=this['componentsToWrite']+this[_0x162628(0xa9)];await this[_0x162628(0xd1)][_0x162628(0xdb)](this['prefix']+_0x162628(0xcf)+(Date[_0x162628(0xa8)]()-this[_0x162628(0xd7)])+_0x162628(0x74)+_0x2d2013+'.')[_0x162628(0xb8)]();}catch(_0x3d4874){await this[_0x162628(0xcd)](),await this[_0x162628(0xd1)][_0x162628(0x88)](this['prefix']+'\x20'+_0x3d4874)[_0x162628(0xb8)]();throw _0x3d4874;}}async[a121_0x462057(0x98)](_0x43ee92,_0x510e7e){const _0x2ce5e5=a121_0x462057;var _0x1418d0,_0x2c7dc5;this[_0x2ce5e5(0xd1)]=typedi_1[_0x2ce5e5(0x82)][_0x2ce5e5(0x76)](providers_tokens_1[_0x2ce5e5(0xe0)]['logger']),this[_0x2ce5e5(0xd4)]=(_0x510e7e?_0x510e7e+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto'][_0x2ce5e5(0xca)]+']',await this[_0x2ce5e5(0xd1)]['log'](this[_0x2ce5e5(0xd4)]+_0x2ce5e5(0x8d));const _0x1a68be=!!((_0x1418d0=_0x43ee92[_0x2ce5e5(0xdd)])===null||_0x1418d0===void 0x0?void 0x0:_0x1418d0[_0x2ce5e5(0x9d)])||!!((_0x2c7dc5=_0x43ee92[_0x2ce5e5(0xdd)])===null||_0x2c7dc5===void 0x0?void 0x0:_0x2c7dc5[_0x2ce5e5(0xdf)]);if(!_0x1a68be){await this[_0x2ce5e5(0xd1)][_0x2ce5e5(0xdb)](this[_0x2ce5e5(0xd4)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x2ce5e5(0xb8)]();return;}this[_0x2ce5e5(0xc9)]=_0x43ee92,await this[_0x2ce5e5(0xbf)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a121_0x462057(0xb6)]=CommitComponentsJob;