const a103_0x10ca8a=a103_0x236d;(function(_0x270a86,_0x741b18){const _0x51a94b=a103_0x236d,_0x2e90b4=_0x270a86();while(!![]){try{const _0xd61737=-parseInt(_0x51a94b(0x1f6))/0x1+-parseInt(_0x51a94b(0x207))/0x2+parseInt(_0x51a94b(0x250))/0x3*(-parseInt(_0x51a94b(0x232))/0x4)+-parseInt(_0x51a94b(0x221))/0x5*(-parseInt(_0x51a94b(0x23f))/0x6)+parseInt(_0x51a94b(0x227))/0x7*(-parseInt(_0x51a94b(0x224))/0x8)+-parseInt(_0x51a94b(0x24b))/0x9+parseInt(_0x51a94b(0x24f))/0xa;if(_0xd61737===_0x741b18)break;else _0x2e90b4['push'](_0x2e90b4['shift']());}catch(_0x594230){_0x2e90b4['push'](_0x2e90b4['shift']());}}}(a103_0x4f2d,0xd219b));const a103_0x4d9952=(function(){let _0x5e5eda=!![];return function(_0x5ccbf7,_0x2f53fb){const _0x5df73b=_0x5e5eda?function(){const _0xac322d=a103_0x236d;if(_0x2f53fb){const _0x2de19a=_0x2f53fb[_0xac322d(0x241)](_0x5ccbf7,arguments);return _0x2f53fb=null,_0x2de19a;}}:function(){};return _0x5e5eda=![],_0x5df73b;};}()),a103_0x35dfec=a103_0x4d9952(this,function(){const _0x7732eb=a103_0x236d;return a103_0x35dfec[_0x7732eb(0x23d)]()[_0x7732eb(0x22c)]('(((.+)+)+)+$')[_0x7732eb(0x23d)]()['constructor'](a103_0x35dfec)[_0x7732eb(0x22c)](_0x7732eb(0x203));});function a103_0x4f2d(){const _0x2496d4=['../../providers/providers.tokens','\x20components','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','componentsToWrite','values','events','Bitbucket','__createBinding','prototype','catch','reduce','clone','GitUtils','359230oWXntb','SFDX','dir','8824qaAUKw','defineProperty','groupComponentsByFileName','10759txvana','send','\x20Checking\x20commit\x20components.','writeComponents','COMPONENTS_PER_TICK','search','ms.\x20Committed\x20components\x20-\x20','credentials','length','\x20Checking\x20deleted\x20components.','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','4MiQbIi','../../../shared/utils','deleted','isLoggedIn','exec','gitUrl','name','__importDefault','DEFAULT_GIT_USER_EMAIL','log','typedi','toString','replace','24hHTIeO','removeComponents','apply','getGitShellAuthorizationString','sfdxUtils','__decorate','gitUtils','sort','includes','sfLogger','create','CommitComponentsDto','1579788huBgCt','decorate','\x20Prepare\x20mdapi\x20files.','../../../../constants','49160110FtdiEz','2615511GssdNl','prefix','force-app','get','mdapiUtils','Tokens','branch','now','isEmptyDir','../../providers/api/bitbucket-api.service','provider','writed','default','\x20Copying\x20mdapi\x20to\x20git\x20folder.','join','__esModule','404961WoAnIs','createProjectFrom','../../salesforce/utils/sfdx.utils','../utils/mdapi.utils','commitData','removeDir','\x20Nothing\x20to\x20commit.\x20Skip.','fileType','../dto/commit-components.dto','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','splice','hasOwnProperty','\x20Preparing\x20to\x20write\x20components','(((.+)+)+)+$','CommitComponentsJob','../../parsers/data/child-types','call','2390366hDfYGZ','getOwnPropertyDescriptor','startTime','../../providers/types/git-provider','getRemote','\x20Start\x20converting\x20to\x20SFDX.','../utils/git.utils','function','cleanUp','configurable','clearDir','writeFlosumComponents','componentsToDelete'];a103_0x4f2d=function(){return _0x2496d4;};return a103_0x4f2d();}a103_0x35dfec();'use strict';var __createBinding=this&&this[a103_0x10ca8a(0x21b)]||(Object['create']?function(_0x3ebccc,_0x1276a7,_0x20c0a9,_0x1bd7b0){const _0x4fff70=a103_0x10ca8a;if(_0x1bd7b0===undefined)_0x1bd7b0=_0x20c0a9;var _0x403374=Object[_0x4fff70(0x208)](_0x1276a7,_0x20c0a9);(!_0x403374||(_0x4fff70(0x253)in _0x403374?!_0x1276a7[_0x4fff70(0x1f5)]:_0x403374['writable']||_0x403374[_0x4fff70(0x210)]))&&(_0x403374={'enumerable':!![],'get':function(){return _0x1276a7[_0x20c0a9];}}),Object[_0x4fff70(0x225)](_0x3ebccc,_0x1bd7b0,_0x403374);}:function(_0x5420ee,_0x16110b,_0x5b57a0,_0x568c6f){if(_0x568c6f===undefined)_0x568c6f=_0x5b57a0;_0x5420ee[_0x568c6f]=_0x16110b[_0x5b57a0];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a103_0x10ca8a(0x249)]?function(_0x27c3fd,_0x3b66f6){const _0x1ba530=a103_0x10ca8a;Object[_0x1ba530(0x225)](_0x27c3fd,_0x1ba530(0x1f2),{'enumerable':!![],'value':_0x3b66f6});}:function(_0x25c7e9,_0x1b289d){const _0x1ebf63=a103_0x10ca8a;_0x25c7e9[_0x1ebf63(0x1f2)]=_0x1b289d;}),__decorate=this&&this[a103_0x10ca8a(0x244)]||function(_0x3a3291,_0x36e360,_0x2681d4,_0x34339a){const _0x5bb69e=a103_0x10ca8a;var _0x5c3ac8=arguments['length'],_0x4ebdcf=_0x5c3ac8<0x3?_0x36e360:_0x34339a===null?_0x34339a=Object[_0x5bb69e(0x208)](_0x36e360,_0x2681d4):_0x34339a,_0x51afe4;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x5bb69e(0x20e))_0x4ebdcf=Reflect[_0x5bb69e(0x24c)](_0x3a3291,_0x36e360,_0x2681d4,_0x34339a);else{for(var _0x5902e8=_0x3a3291[_0x5bb69e(0x22f)]-0x1;_0x5902e8>=0x0;_0x5902e8--)if(_0x51afe4=_0x3a3291[_0x5902e8])_0x4ebdcf=(_0x5c3ac8<0x3?_0x51afe4(_0x4ebdcf):_0x5c3ac8>0x3?_0x51afe4(_0x36e360,_0x2681d4,_0x4ebdcf):_0x51afe4(_0x36e360,_0x2681d4))||_0x4ebdcf;}return _0x5c3ac8>0x3&&_0x4ebdcf&&Object['defineProperty'](_0x36e360,_0x2681d4,_0x4ebdcf),_0x4ebdcf;},__importStar=this&&this['__importStar']||function(_0x4b4535){const _0x108de1=a103_0x10ca8a;if(_0x4b4535&&_0x4b4535[_0x108de1(0x1f5)])return _0x4b4535;var _0x13a0a1={};if(_0x4b4535!=null){for(var _0x4141b3 in _0x4b4535)if(_0x4141b3!=='default'&&Object[_0x108de1(0x21c)][_0x108de1(0x201)][_0x108de1(0x206)](_0x4b4535,_0x4141b3))__createBinding(_0x13a0a1,_0x4b4535,_0x4141b3);}return __setModuleDefault(_0x13a0a1,_0x4b4535),_0x13a0a1;},__importDefault=this&&this[a103_0x10ca8a(0x239)]||function(_0x1a83cf){const _0x160418=a103_0x10ca8a;return _0x1a83cf&&_0x1a83cf[_0x160418(0x1f5)]?_0x1a83cf:{'default':_0x1a83cf};};Object['defineProperty'](exports,a103_0x10ca8a(0x1f5),{'value':!![]}),exports[a103_0x10ca8a(0x204)]=void 0x0;const commit_components_dto_1=require(a103_0x10ca8a(0x1fe)),events_1=__importDefault(require(a103_0x10ca8a(0x219))),git_utils_1=require(a103_0x10ca8a(0x20d)),mdapi_utils_1=require(a103_0x10ca8a(0x1f9)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a103_0x10ca8a(0x23c))),child_types_1=__importDefault(require(a103_0x10ca8a(0x205))),utils_1=require(a103_0x10ca8a(0x233)),constants_1=require(a103_0x10ca8a(0x24e)),git_provider_1=require(a103_0x10ca8a(0x20a)),bitbucket_api_service_1=require(a103_0x10ca8a(0x1ef)),sfdx_utils_2=require(a103_0x10ca8a(0x1f8)),fs_internal_1=require('../../internal/fs.internal'),path_1=require('path'),providers_tokens_1=require(a103_0x10ca8a(0x214));let CommitComponentsJob=class CommitComponentsJob extends events_1[a103_0x10ca8a(0x1f2)]{constructor(){const _0x516ee9=a103_0x10ca8a;super(...arguments),this[_0x516ee9(0x22b)]=0x3e8,this['componentsToWrite']=0x0,this[_0x516ee9(0x213)]=0x0,this[_0x516ee9(0x209)]=Date[_0x516ee9(0x257)]();}async[a103_0x10ca8a(0x20b)](){const _0x4d19d9=a103_0x10ca8a,{repo:_0x3575cd}=this['commitData'],_0x512909=typedi_1[_0x4d19d9(0x1f2)][_0x4d19d9(0x253)](providers_tokens_1[_0x4d19d9(0x255)][_0x4d19d9(0x22e)]);if(this[_0x4d19d9(0x1fa)][_0x4d19d9(0x1f0)]===git_provider_1['GitProvider'][_0x4d19d9(0x21a)]){const _0x4e8c54=typedi_1[_0x4d19d9(0x1f2)][_0x4d19d9(0x253)](bitbucket_api_service_1['BitbucketApiService']);await _0x4e8c54[_0x4d19d9(0x235)]();}return _0x3575cd[_0x4d19d9(0x237)][_0x4d19d9(0x23e)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x3575cd[_0x4d19d9(0x237)])+'://'+_0x512909[_0x4d19d9(0x242)]()+'@');}[a103_0x10ca8a(0x226)](_0x320f0b){const _0x62a1b0=a103_0x10ca8a;var _0x21cb27;_0x320f0b[_0x62a1b0(0x246)](_0xfa6131=>child_types_1['default'][_0x62a1b0(0x247)](_0xfa6131[_0x62a1b0(0x1fd)])?0x1:-0x1);const _0x648290={};for(const _0x57b416 of _0x320f0b){_0x648290[_0x21cb27=_0x57b416['fileName']]||(_0x648290[_0x21cb27]=[]),_0x648290[_0x57b416['fileName']]['push'](_0x57b416);}return Object[_0x62a1b0(0x218)](_0x648290)[_0x62a1b0(0x21e)]((_0x29ee8b,_0x139a7f)=>[..._0x29ee8b,..._0x139a7f],[]);}async[a103_0x10ca8a(0x22a)](_0x24f852){const _0x58c71a=a103_0x10ca8a;_0x24f852=this['groupComponentsByFileName'](_0x24f852);let _0x1262ce=0x0;while(_0x24f852[_0x58c71a(0x22f)]){const _0x543646=_0x24f852[_0x58c71a(0x200)](0x0,this[_0x58c71a(0x22b)]);await this[_0x58c71a(0x254)][_0x58c71a(0x212)](_0x543646,{'skipChildErrors':this[_0x58c71a(0x1fa)][_0x58c71a(0x256)][_0x58c71a(0x238)]==='master'}),_0x1262ce+=_0x543646[_0x58c71a(0x22f)],this[_0x58c71a(0x248)][_0x58c71a(0x23b)](this[_0x58c71a(0x251)]+'\x20Wrote\x20'+_0x1262ce+'/'+this[_0x58c71a(0x217)]+'\x20components'),await this[_0x58c71a(0x248)][_0x58c71a(0x228)]();}}async[a103_0x10ca8a(0x240)](_0x4f3d89){const _0x1af1ee=a103_0x10ca8a;_0x4f3d89[_0x1af1ee(0x246)](_0x45ceaa=>child_types_1[_0x1af1ee(0x1f2)][_0x1af1ee(0x247)](_0x45ceaa['type'])?-0x1:0x1);let _0x2f66a4=0x0;while(_0x4f3d89[_0x1af1ee(0x22f)]){const _0xb8fab2=_0x4f3d89[_0x1af1ee(0x200)](0x0,this[_0x1af1ee(0x22b)]);await this[_0x1af1ee(0x254)][_0x1af1ee(0x240)](_0xb8fab2),_0x2f66a4+=_0xb8fab2[_0x1af1ee(0x22f)],this[_0x1af1ee(0x248)]['log'](this['prefix']+'\x20Deleted\x20'+_0x2f66a4+'/'+this[_0x1af1ee(0x213)]+_0x1af1ee(0x215)),await this[_0x1af1ee(0x248)][_0x1af1ee(0x228)]();}}async[a103_0x10ca8a(0x20f)](){const _0x39828c=a103_0x10ca8a;this['gitUtils']&&await this[_0x39828c(0x245)]['removeDir']()[_0x39828c(0x21d)](()=>void 0x0),this['mdapiUtils']&&await this[_0x39828c(0x254)][_0x39828c(0x1fb)]()['catch'](()=>void 0x0),this[_0x39828c(0x243)]&&await this[_0x39828c(0x243)][_0x39828c(0x1fb)]()[_0x39828c(0x21d)](()=>void 0x0);}async[a103_0x10ca8a(0x236)](){const _0x5c9eb9=a103_0x10ca8a,{repo:_0x4c5002,branch:_0x59007b,components:_0xcf9f1c,convertToSFDX:_0x481930,message:_0x3d3ba5,user:_0x1a11a2}=this[_0x5c9eb9(0x1fa)];this[_0x5c9eb9(0x254)]=new mdapi_utils_1['MDApiUtils'](),this[_0x5c9eb9(0x245)]=new git_utils_1[(_0x5c9eb9(0x220))](await this['getRemote']()),this[_0x5c9eb9(0x243)]=new sfdx_utils_1['SFDXUtils']();let _0x33fcd5=_0x481930;try{await this['sfLogger'][_0x5c9eb9(0x23b)](this[_0x5c9eb9(0x251)]+'\x20Start\x20cloning\x20repository.')[_0x5c9eb9(0x228)](),await this[_0x5c9eb9(0x245)][_0x5c9eb9(0x21f)](_0x59007b['name'],_0x4c5002[_0x5c9eb9(0x238)]);!this[_0x5c9eb9(0x1fa)]['force']?(this[_0x5c9eb9(0x248)][_0x5c9eb9(0x23b)](this[_0x5c9eb9(0x251)]+_0x5c9eb9(0x24d)),await this['mdapiUtils']['prepareMdapi'](this[_0x5c9eb9(0x245)][_0x5c9eb9(0x223)])):this[_0x5c9eb9(0x248)][_0x5c9eb9(0x23b)](this[_0x5c9eb9(0x251)]+_0x5c9eb9(0x231));await this[_0x5c9eb9(0x248)]['log'](this[_0x5c9eb9(0x251)]+'\x20Checking\x20written\x20components.')[_0x5c9eb9(0x228)]();_0xcf9f1c[_0x5c9eb9(0x1f1)]&&(this[_0x5c9eb9(0x248)]['log'](this[_0x5c9eb9(0x251)]+_0x5c9eb9(0x202)),this[_0x5c9eb9(0x217)]=_0xcf9f1c['writed'][_0x5c9eb9(0x22f)],await this['writeComponents'](_0xcf9f1c[_0x5c9eb9(0x1f1)]),await this[_0x5c9eb9(0x248)]['send']());await this[_0x5c9eb9(0x248)][_0x5c9eb9(0x23b)](this[_0x5c9eb9(0x251)]+_0x5c9eb9(0x230))['send']();_0xcf9f1c[_0x5c9eb9(0x234)]&&(this[_0x5c9eb9(0x248)][_0x5c9eb9(0x23b)](this['prefix']+'\x20Preparing\x20to\x20delete\x20components'),this[_0x5c9eb9(0x213)]=_0xcf9f1c[_0x5c9eb9(0x234)][_0x5c9eb9(0x22f)],await this[_0x5c9eb9(0x240)](_0xcf9f1c[_0x5c9eb9(0x234)]),await this[_0x5c9eb9(0x248)][_0x5c9eb9(0x228)]());await this[_0x5c9eb9(0x248)][_0x5c9eb9(0x228)]();const _0x421c75=await fs_internal_1['FS'][_0x5c9eb9(0x1ee)](this[_0x5c9eb9(0x245)][_0x5c9eb9(0x223)]);await sfdx_utils_2[_0x5c9eb9(0x222)]['isSFDXProject'](this[_0x5c9eb9(0x245)][_0x5c9eb9(0x223)])?(_0x33fcd5=!![],await fs_internal_1['FS'][_0x5c9eb9(0x1fb)]((0x0,path_1[_0x5c9eb9(0x1f4)])(this[_0x5c9eb9(0x245)][_0x5c9eb9(0x223)],_0x5c9eb9(0x252)))):(_0x33fcd5&&(!_0x421c75&&(_0x33fcd5=![])),await this[_0x5c9eb9(0x245)][_0x5c9eb9(0x211)]());_0x33fcd5?(await this['sfLogger'][_0x5c9eb9(0x23b)](this[_0x5c9eb9(0x251)]+_0x5c9eb9(0x20c))[_0x5c9eb9(0x228)](),await this[_0x5c9eb9(0x243)][_0x5c9eb9(0x1f7)](this[_0x5c9eb9(0x254)]['dir']),await this['sfdxUtils']['copyProjectTo'](this[_0x5c9eb9(0x245)][_0x5c9eb9(0x223)],!_0x421c75),await this[_0x5c9eb9(0x243)][_0x5c9eb9(0x1fb)]()):(await this[_0x5c9eb9(0x248)][_0x5c9eb9(0x23b)](this['prefix']+_0x5c9eb9(0x1f3))['send'](),await this[_0x5c9eb9(0x254)]['copyMdapiTo'](this[_0x5c9eb9(0x245)]['dir']));await this[_0x5c9eb9(0x248)][_0x5c9eb9(0x23b)](this[_0x5c9eb9(0x251)]+_0x5c9eb9(0x1ff))[_0x5c9eb9(0x228)](),await this[_0x5c9eb9(0x245)]['commitAndPush'](_0x3d3ba5,{'email':constants_1[_0x5c9eb9(0x23a)],'name':_0x1a11a2[_0x5c9eb9(0x238)]},_0x59007b['name']),await this[_0x5c9eb9(0x245)]['removeDir'](),await this[_0x5c9eb9(0x254)][_0x5c9eb9(0x1fb)]();const _0x349463=this[_0x5c9eb9(0x217)]+this[_0x5c9eb9(0x213)];await this[_0x5c9eb9(0x248)][_0x5c9eb9(0x23b)](this[_0x5c9eb9(0x251)]+_0x5c9eb9(0x216)+(Date[_0x5c9eb9(0x257)]()-this[_0x5c9eb9(0x209)])+_0x5c9eb9(0x22d)+_0x349463+'.')['send']();}catch(_0x3c1a66){await this[_0x5c9eb9(0x20f)](),await this[_0x5c9eb9(0x248)]['error'](this[_0x5c9eb9(0x251)]+'\x20'+_0x3c1a66)[_0x5c9eb9(0x228)]();throw _0x3c1a66;}}async['run'](_0x2814d2,_0x25f17c){const _0xa5d371=a103_0x10ca8a;var _0xff1a3c,_0x3d5f3d;this[_0xa5d371(0x248)]=typedi_1[_0xa5d371(0x1f2)]['get'](providers_tokens_1['Tokens']['logger']),this[_0xa5d371(0x251)]=(_0x25f17c?_0x25f17c+'\x20':'')+'['+commit_components_dto_1[_0xa5d371(0x24a)][_0xa5d371(0x238)]+']',await this[_0xa5d371(0x248)][_0xa5d371(0x23b)](this[_0xa5d371(0x251)]+_0xa5d371(0x229));const _0x14414d=!!((_0xff1a3c=_0x2814d2['components'])===null||_0xff1a3c===void 0x0?void 0x0:_0xff1a3c[_0xa5d371(0x1f1)])||!!((_0x3d5f3d=_0x2814d2['components'])===null||_0x3d5f3d===void 0x0?void 0x0:_0x3d5f3d[_0xa5d371(0x234)]);if(!_0x14414d){await this[_0xa5d371(0x248)][_0xa5d371(0x23b)](this[_0xa5d371(0x251)]+_0xa5d371(0x1fc))[_0xa5d371(0x228)]();return;}this[_0xa5d371(0x1fa)]=_0x2814d2,await this[_0xa5d371(0x236)]();}};function a103_0x236d(_0x4f46d3,_0x4556fe){const _0x18a94f=a103_0x4f2d();return a103_0x236d=function(_0x35dfec,_0x4d9952){_0x35dfec=_0x35dfec-0x1ee;let _0x4f2d19=_0x18a94f[_0x35dfec];return _0x4f2d19;},a103_0x236d(_0x4f46d3,_0x4556fe);}CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a103_0x10ca8a(0x204)]=CommitComponentsJob;