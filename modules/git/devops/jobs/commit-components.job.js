const a104_0x5a84f7=a104_0xfa0e;function a104_0xfa0e(_0x49c644,_0x4a66a1){const _0x3d7987=a104_0x38e7();return a104_0xfa0e=function(_0x308265,_0x1a7c59){_0x308265=_0x308265-0xa2;let _0x38e7ce=_0x3d7987[_0x308265];return _0x38e7ce;},a104_0xfa0e(_0x49c644,_0x4a66a1);}(function(_0x1b4f54,_0x3dac9a){const _0x5936d1=a104_0xfa0e,_0x4761b5=_0x1b4f54();while(!![]){try{const _0x7b8b47=parseInt(_0x5936d1(0xdb))/0x1*(-parseInt(_0x5936d1(0x109))/0x2)+parseInt(_0x5936d1(0xca))/0x3*(parseInt(_0x5936d1(0xf3))/0x4)+-parseInt(_0x5936d1(0xb2))/0x5+-parseInt(_0x5936d1(0xd1))/0x6+-parseInt(_0x5936d1(0xbb))/0x7*(parseInt(_0x5936d1(0x105))/0x8)+parseInt(_0x5936d1(0x100))/0x9+parseInt(_0x5936d1(0xd5))/0xa*(parseInt(_0x5936d1(0x10a))/0xb);if(_0x7b8b47===_0x3dac9a)break;else _0x4761b5['push'](_0x4761b5['shift']());}catch(_0x430095){_0x4761b5['push'](_0x4761b5['shift']());}}}(a104_0x38e7,0x4f394));const a104_0x1a7c59=(function(){let _0x351607=!![];return function(_0x534fd5,_0x363dfc){const _0x508aee=_0x351607?function(){const _0xc4549b=a104_0xfa0e;if(_0x363dfc){const _0x48a000=_0x363dfc[_0xc4549b(0x10c)](_0x534fd5,arguments);return _0x363dfc=null,_0x48a000;}}:function(){};return _0x351607=![],_0x508aee;};}()),a104_0x308265=a104_0x1a7c59(this,function(){const _0x5db027=a104_0xfa0e;return a104_0x308265['toString']()[_0x5db027(0x114)](_0x5db027(0xbf))[_0x5db027(0xa3)]()[_0x5db027(0xd8)](a104_0x308265)[_0x5db027(0x114)]('(((.+)+)+)+$');});a104_0x308265();'use strict';var __createBinding=this&&this[a104_0x5a84f7(0xe1)]||(Object['create']?function(_0x4f67aa,_0x3fae87,_0x61ba2c,_0x5a9079){const _0x5ab4a1=a104_0x5a84f7;if(_0x5a9079===undefined)_0x5a9079=_0x61ba2c;var _0x53d29d=Object[_0x5ab4a1(0xe5)](_0x3fae87,_0x61ba2c);(!_0x53d29d||(_0x5ab4a1(0xfc)in _0x53d29d?!_0x3fae87[_0x5ab4a1(0xd0)]:_0x53d29d[_0x5ab4a1(0xf0)]||_0x53d29d[_0x5ab4a1(0xed)]))&&(_0x53d29d={'enumerable':!![],'get':function(){return _0x3fae87[_0x61ba2c];}}),Object['defineProperty'](_0x4f67aa,_0x5a9079,_0x53d29d);}:function(_0xb89b20,_0x209147,_0x302506,_0xb62e25){if(_0xb62e25===undefined)_0xb62e25=_0x302506;_0xb89b20[_0xb62e25]=_0x209147[_0x302506];}),__setModuleDefault=this&&this[a104_0x5a84f7(0x108)]||(Object[a104_0x5a84f7(0xde)]?function(_0x3ab54c,_0x79d3f){const _0x516b07=a104_0x5a84f7;Object['defineProperty'](_0x3ab54c,_0x516b07(0x113),{'enumerable':!![],'value':_0x79d3f});}:function(_0x12f02c,_0x5ae29c){const _0x1a4971=a104_0x5a84f7;_0x12f02c[_0x1a4971(0x113)]=_0x5ae29c;}),__decorate=this&&this[a104_0x5a84f7(0xf7)]||function(_0x1cf4da,_0x168998,_0x2c557a,_0x34c86e){const _0x309431=a104_0x5a84f7;var _0x3891ac=arguments[_0x309431(0xdd)],_0x5f5a63=_0x3891ac<0x3?_0x168998:_0x34c86e===null?_0x34c86e=Object[_0x309431(0xe5)](_0x168998,_0x2c557a):_0x34c86e,_0x55223d;if(typeof Reflect===_0x309431(0x10d)&&typeof Reflect[_0x309431(0xc9)]==='function')_0x5f5a63=Reflect[_0x309431(0xc9)](_0x1cf4da,_0x168998,_0x2c557a,_0x34c86e);else{for(var _0x73427c=_0x1cf4da['length']-0x1;_0x73427c>=0x0;_0x73427c--)if(_0x55223d=_0x1cf4da[_0x73427c])_0x5f5a63=(_0x3891ac<0x3?_0x55223d(_0x5f5a63):_0x3891ac>0x3?_0x55223d(_0x168998,_0x2c557a,_0x5f5a63):_0x55223d(_0x168998,_0x2c557a))||_0x5f5a63;}return _0x3891ac>0x3&&_0x5f5a63&&Object[_0x309431(0xa8)](_0x168998,_0x2c557a,_0x5f5a63),_0x5f5a63;},__importStar=this&&this[a104_0x5a84f7(0xf6)]||function(_0xccd08){const _0x35ab5b=a104_0x5a84f7;if(_0xccd08&&_0xccd08['__esModule'])return _0xccd08;var _0x191ff0={};if(_0xccd08!=null){for(var _0x3c2269 in _0xccd08)if(_0x3c2269!=='default'&&Object[_0x35ab5b(0xec)][_0x35ab5b(0xd6)][_0x35ab5b(0xdc)](_0xccd08,_0x3c2269))__createBinding(_0x191ff0,_0xccd08,_0x3c2269);}return __setModuleDefault(_0x191ff0,_0xccd08),_0x191ff0;},__importDefault=this&&this[a104_0x5a84f7(0xe0)]||function(_0x1d11c9){const _0x3e5b56=a104_0x5a84f7;return _0x1d11c9&&_0x1d11c9[_0x3e5b56(0xd0)]?_0x1d11c9:{'default':_0x1d11c9};};Object[a104_0x5a84f7(0xa8)](exports,a104_0x5a84f7(0xd0),{'value':!![]}),exports[a104_0x5a84f7(0x104)]=void 0x0;const commit_components_dto_1=require(a104_0x5a84f7(0xb1)),events_1=__importDefault(require(a104_0x5a84f7(0xf5))),git_utils_1=require(a104_0x5a84f7(0xce)),mdapi_utils_1=require(a104_0x5a84f7(0xe7)),sfdx_utils_1=require(a104_0x5a84f7(0xab)),typedi_1=__importStar(require(a104_0x5a84f7(0xb0))),child_types_1=__importDefault(require(a104_0x5a84f7(0xe9))),utils_1=require(a104_0x5a84f7(0xcb)),constants_1=require(a104_0x5a84f7(0x10b)),git_provider_1=require(a104_0x5a84f7(0xfe)),bitbucket_api_service_1=require(a104_0x5a84f7(0x110)),sfdx_utils_2=require(a104_0x5a84f7(0xc2)),fs_internal_1=require(a104_0x5a84f7(0xcf)),path_1=require(a104_0x5a84f7(0xf4)),providers_tokens_1=require('../../providers/providers.tokens'),constants_2=require(a104_0x5a84f7(0x10b));function a104_0x38e7(){const _0x5991cc=['\x20Prepare\x20mdapi\x20files.','\x20Preparing\x20to\x20write\x20components','isSFDXProject','error','\x20Checking\x20deleted\x20components.','sfdxUtils','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','407701zzjumt','writeComponents','commitData','componentsToDelete','(((.+)+)+)+$','provider','\x20Copying\x20mdapi\x20to\x20git\x20folder.','../../salesforce/utils/sfdx.utils','\x20Deleted\x20','isLoggedIn','Bitbucket','fileName','gitUrl','mdapiUtils','decorate','3tFQQEx','../../../shared/utils','BitbucketApiService','catch','../utils/git.utils','../../internal/fs.internal','__esModule','1427970AylDTi','removeComponents','getProtocol','includes','20CewSag','hasOwnProperty','values','constructor','deleted','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','56314bzeSUI','call','length','create','now','__importDefault','__createBinding','credentials','DEFAULT_GIT_USER_EMAIL','getRemote','getOwnPropertyDescriptor','exec','../utils/mdapi.utils','\x20Checking\x20commit\x20components.','../../parsers/data/child-types','sort','ms.\x20Committed\x20components\x20-\x20','prototype','configurable','components','splice','writable','cleanUp','clone','1527044FwbjXO','path','events','__importStar','__decorate','logger','\x20Start\x20cloning\x20repository.','getGitShellAuthorizationString','startTime','get','sfLogger','../../providers/types/git-provider','FORCE_APP_DEFAULT_DIR','4678371ifHmCP','Tokens','force','commitAndPush','CommitComponentsJob','32CpPsgo','prepareMdapi','\x20components','__setModuleDefault','2WMsRrL','3248377zNabNo','../../../../constants','apply','object','\x20Preparing\x20to\x20delete\x20components','master','../../providers/api/bitbucket-api.service','://','name','default','search','GitProvider','COMPONENTS_PER_TICK','prefix','copyMdapiTo','CommitComponentsDto','log','writed','send','fileType','writeFlosumComponents','force-app','dir','\x20Start\x20converting\x20to\x20SFDX.','toString','removeDir','componentsToWrite','replace','groupComponentsByFileName','defineProperty','branch','\x20Nothing\x20to\x20commit.\x20Skip.','../utils/sfdx.utils','join','clearDir','run','gitUtils','typedi','../dto/commit-components.dto','3202065UqwmYX','GitUtils'];a104_0x38e7=function(){return _0x5991cc;};return a104_0x38e7();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x5a84f7(0x113)]{constructor(){const _0x9871dc=a104_0x5a84f7;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x9871dc(0xa5)]=0x0,this[_0x9871dc(0xbe)]=0x0,this[_0x9871dc(0xfb)]=Date[_0x9871dc(0xdf)]();}async[a104_0x5a84f7(0xe4)](){const _0x3cd0a3=a104_0x5a84f7,{repo:_0x487486}=this[_0x3cd0a3(0xbd)],_0x466d1f=typedi_1[_0x3cd0a3(0x113)][_0x3cd0a3(0xfc)](providers_tokens_1[_0x3cd0a3(0x101)][_0x3cd0a3(0xe2)]);if(this[_0x3cd0a3(0xbd)][_0x3cd0a3(0xc0)]===git_provider_1[_0x3cd0a3(0x115)][_0x3cd0a3(0xc5)]){const _0x15120f=typedi_1[_0x3cd0a3(0x113)]['get'](bitbucket_api_service_1[_0x3cd0a3(0xcc)]);await _0x15120f[_0x3cd0a3(0xc4)]();}return _0x487486[_0x3cd0a3(0xc7)][_0x3cd0a3(0xa6)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x3cd0a3(0xd3)])(_0x487486[_0x3cd0a3(0xc7)])+_0x3cd0a3(0x111)+_0x466d1f[_0x3cd0a3(0xfa)]()+'@');}[a104_0x5a84f7(0xa7)](_0x2b6b1c){const _0x4f60af=a104_0x5a84f7;var _0xefa2a9;_0x2b6b1c['sort'](_0x38dea3=>child_types_1[_0x4f60af(0x113)][_0x4f60af(0xd4)](_0x38dea3[_0x4f60af(0x11d)])?0x1:-0x1);const _0x79e5dc={};for(const _0x545c6a of _0x2b6b1c){_0x79e5dc[_0xefa2a9=_0x545c6a[_0x4f60af(0xc6)]]||(_0x79e5dc[_0xefa2a9]=[]),_0x79e5dc[_0x545c6a[_0x4f60af(0xc6)]]['push'](_0x545c6a);}return Object[_0x4f60af(0xd7)](_0x79e5dc)['reduce']((_0xc41917,_0x51e423)=>[..._0xc41917,..._0x51e423],[]);}async[a104_0x5a84f7(0xbc)](_0x2fd04a){const _0x40e3e8=a104_0x5a84f7;_0x2fd04a=this[_0x40e3e8(0xa7)](_0x2fd04a);let _0x4568da=0x0;while(_0x2fd04a[_0x40e3e8(0xdd)]){const _0x3d960f=_0x2fd04a[_0x40e3e8(0xef)](0x0,this[_0x40e3e8(0x116)]);await this[_0x40e3e8(0xc8)][_0x40e3e8(0x11e)](_0x3d960f,{'skipChildErrors':this[_0x40e3e8(0xbd)][_0x40e3e8(0xa9)][_0x40e3e8(0x112)]===_0x40e3e8(0x10f)}),_0x4568da+=_0x3d960f[_0x40e3e8(0xdd)],this[_0x40e3e8(0xfd)][_0x40e3e8(0x11a)](this[_0x40e3e8(0x117)]+'\x20Wrote\x20'+_0x4568da+'/'+this[_0x40e3e8(0xa5)]+_0x40e3e8(0x107)),await this[_0x40e3e8(0xfd)][_0x40e3e8(0x11c)]();}}async[a104_0x5a84f7(0xd2)](_0x191d78){const _0x548a17=a104_0x5a84f7;_0x191d78[_0x548a17(0xea)](_0x3c87ac=>child_types_1[_0x548a17(0x113)][_0x548a17(0xd4)](_0x3c87ac['type'])?-0x1:0x1);let _0x7054e6=0x0;while(_0x191d78[_0x548a17(0xdd)]){const _0x40ed47=_0x191d78['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x548a17(0xc8)][_0x548a17(0xd2)](_0x40ed47),_0x7054e6+=_0x40ed47['length'],this[_0x548a17(0xfd)][_0x548a17(0x11a)](this['prefix']+_0x548a17(0xc3)+_0x7054e6+'/'+this[_0x548a17(0xbe)]+_0x548a17(0x107)),await this[_0x548a17(0xfd)]['send']();}}async[a104_0x5a84f7(0xf1)](){const _0x49851c=a104_0x5a84f7;this[_0x49851c(0xaf)]&&await this[_0x49851c(0xaf)][_0x49851c(0xa4)]()[_0x49851c(0xcd)](()=>void 0x0),this[_0x49851c(0xc8)]&&await this[_0x49851c(0xc8)][_0x49851c(0xa4)]()[_0x49851c(0xcd)](()=>void 0x0),this[_0x49851c(0xb9)]&&await this[_0x49851c(0xb9)][_0x49851c(0xa4)]()[_0x49851c(0xcd)](()=>void 0x0);}async[a104_0x5a84f7(0xe6)](){const _0x1ff1cc=a104_0x5a84f7,{repo:_0x4c5392,branch:_0x46db57,components:_0x331c12,convertToSFDX:_0x365b3b,message:_0x1404a3,user:_0x5806d7}=this[_0x1ff1cc(0xbd)];this['mdapiUtils']=new mdapi_utils_1['MDApiUtils'](),this[_0x1ff1cc(0xaf)]=new git_utils_1[(_0x1ff1cc(0xb3))](await this[_0x1ff1cc(0xe4)]()),this[_0x1ff1cc(0xb9)]=new sfdx_utils_1['SFDXUtils']();let _0x3cbdf3=_0x365b3b;try{await this['sfLogger'][_0x1ff1cc(0x11a)](this['prefix']+_0x1ff1cc(0xf9))['send'](),await this[_0x1ff1cc(0xaf)][_0x1ff1cc(0xf2)](_0x46db57[_0x1ff1cc(0x112)],_0x4c5392['name']);!this['commitData'][_0x1ff1cc(0x102)]?(this[_0x1ff1cc(0xfd)]['log'](this[_0x1ff1cc(0x117)]+_0x1ff1cc(0xb4)),await this[_0x1ff1cc(0xc8)][_0x1ff1cc(0x106)](this[_0x1ff1cc(0xaf)][_0x1ff1cc(0x120)])):this[_0x1ff1cc(0xfd)][_0x1ff1cc(0x11a)](this['prefix']+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this['sfLogger']['log'](this[_0x1ff1cc(0x117)]+'\x20Checking\x20written\x20components.')['send']();_0x331c12[_0x1ff1cc(0x11b)]&&(this[_0x1ff1cc(0xfd)]['log'](this[_0x1ff1cc(0x117)]+_0x1ff1cc(0xb5)),this['componentsToWrite']=_0x331c12[_0x1ff1cc(0x11b)][_0x1ff1cc(0xdd)],await this[_0x1ff1cc(0xbc)](_0x331c12[_0x1ff1cc(0x11b)]),await this['sfLogger'][_0x1ff1cc(0x11c)]());await this[_0x1ff1cc(0xfd)][_0x1ff1cc(0x11a)](this['prefix']+_0x1ff1cc(0xb8))[_0x1ff1cc(0x11c)]();_0x331c12['deleted']&&(this[_0x1ff1cc(0xfd)]['log'](this[_0x1ff1cc(0x117)]+_0x1ff1cc(0x10e)),this[_0x1ff1cc(0xbe)]=_0x331c12[_0x1ff1cc(0xd9)][_0x1ff1cc(0xdd)],await this['removeComponents'](_0x331c12[_0x1ff1cc(0xd9)]),await this['sfLogger']['send']());await this[_0x1ff1cc(0xfd)][_0x1ff1cc(0x11c)]();const _0xf5a487=await fs_internal_1['FS']['isEmptyDir'](this[_0x1ff1cc(0xaf)]['dir']);await sfdx_utils_2['SFDX'][_0x1ff1cc(0xb6)](this[_0x1ff1cc(0xaf)][_0x1ff1cc(0x120)])?(_0x3cbdf3=!![],await fs_internal_1['FS'][_0x1ff1cc(0xa4)]((0x0,path_1[_0x1ff1cc(0xac)])(this[_0x1ff1cc(0xaf)][_0x1ff1cc(0x120)],_0x1ff1cc(0x11f)))):(_0x3cbdf3&&(!_0xf5a487&&(_0x3cbdf3=![])),await this['gitUtils'][_0x1ff1cc(0xad)]());_0x3cbdf3?(await this[_0x1ff1cc(0xfd)][_0x1ff1cc(0x11a)](this[_0x1ff1cc(0x117)]+_0x1ff1cc(0xa2))[_0x1ff1cc(0x11c)](),await this[_0x1ff1cc(0xb9)]['createProjectFrom'](this[_0x1ff1cc(0xc8)][_0x1ff1cc(0x120)]),await this['sfdxUtils']['copyProjectTo'](this[_0x1ff1cc(0xaf)][_0x1ff1cc(0x120)],!_0xf5a487),await this['sfdxUtils']['copyVlocityComponents'](this[_0x1ff1cc(0xc8)]['dir'],(0x0,path_1[_0x1ff1cc(0xac)])(this[_0x1ff1cc(0xaf)][_0x1ff1cc(0x120)],constants_2[_0x1ff1cc(0xff)])),await this[_0x1ff1cc(0xb9)][_0x1ff1cc(0xa4)]()):(await this[_0x1ff1cc(0xfd)][_0x1ff1cc(0x11a)](this[_0x1ff1cc(0x117)]+_0x1ff1cc(0xc1))[_0x1ff1cc(0x11c)](),await this[_0x1ff1cc(0xc8)][_0x1ff1cc(0x118)](this[_0x1ff1cc(0xaf)][_0x1ff1cc(0x120)]));await this[_0x1ff1cc(0xfd)][_0x1ff1cc(0x11a)](this[_0x1ff1cc(0x117)]+_0x1ff1cc(0xda))[_0x1ff1cc(0x11c)](),await this[_0x1ff1cc(0xaf)][_0x1ff1cc(0x103)](_0x1404a3,{'email':constants_1[_0x1ff1cc(0xe3)],'name':_0x5806d7[_0x1ff1cc(0x112)]},_0x46db57[_0x1ff1cc(0x112)]),await this[_0x1ff1cc(0xaf)]['removeDir'](),await this[_0x1ff1cc(0xc8)][_0x1ff1cc(0xa4)]();const _0x18bc87=this[_0x1ff1cc(0xa5)]+this['componentsToDelete'];await this['sfLogger'][_0x1ff1cc(0x11a)](this[_0x1ff1cc(0x117)]+_0x1ff1cc(0xba)+(Date['now']()-this[_0x1ff1cc(0xfb)])+_0x1ff1cc(0xeb)+_0x18bc87+'.')[_0x1ff1cc(0x11c)]();}catch(_0x2556ae){await this[_0x1ff1cc(0xf1)](),await this['sfLogger'][_0x1ff1cc(0xb7)](this[_0x1ff1cc(0x117)]+'\x20'+_0x2556ae)['send']();throw _0x2556ae;}}async[a104_0x5a84f7(0xae)](_0x4cf465,_0x331066){const _0x4e56ee=a104_0x5a84f7;var _0x117457,_0x1272c4;this[_0x4e56ee(0xfd)]=typedi_1[_0x4e56ee(0x113)][_0x4e56ee(0xfc)](providers_tokens_1[_0x4e56ee(0x101)][_0x4e56ee(0xf8)]),this[_0x4e56ee(0x117)]=(_0x331066?_0x331066+'\x20':'')+'['+commit_components_dto_1[_0x4e56ee(0x119)][_0x4e56ee(0x112)]+']',await this[_0x4e56ee(0xfd)]['log'](this[_0x4e56ee(0x117)]+_0x4e56ee(0xe8));const _0xb4e6f3=!!((_0x117457=_0x4cf465['components'])===null||_0x117457===void 0x0?void 0x0:_0x117457[_0x4e56ee(0x11b)])||!!((_0x1272c4=_0x4cf465[_0x4e56ee(0xee)])===null||_0x1272c4===void 0x0?void 0x0:_0x1272c4[_0x4e56ee(0xd9)]);if(!_0xb4e6f3){await this['sfLogger'][_0x4e56ee(0x11a)](this[_0x4e56ee(0x117)]+_0x4e56ee(0xaa))['send']();return;}this['commitData']=_0x4cf465,await this[_0x4e56ee(0xe6)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a104_0x5a84f7(0x104)]=CommitComponentsJob;