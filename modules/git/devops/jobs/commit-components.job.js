const a104_0x27f3d1=a104_0x41a8;function a104_0x41a8(_0x5bca90,_0x1d8bde){const _0x4be6aa=a104_0x27bc();return a104_0x41a8=function(_0x28071a,_0x56097c){_0x28071a=_0x28071a-0x83;let _0x27bcf0=_0x4be6aa[_0x28071a];return _0x27bcf0;},a104_0x41a8(_0x5bca90,_0x1d8bde);}(function(_0x4a2273,_0x5469fd){const _0x2a0186=a104_0x41a8,_0x4c98bf=_0x4a2273();while(!![]){try{const _0x3ab2d4=parseInt(_0x2a0186(0xf5))/0x1*(parseInt(_0x2a0186(0xeb))/0x2)+-parseInt(_0x2a0186(0xf6))/0x3*(parseInt(_0x2a0186(0xa8))/0x4)+-parseInt(_0x2a0186(0x85))/0x5*(parseInt(_0x2a0186(0xd4))/0x6)+parseInt(_0x2a0186(0x86))/0x7*(parseInt(_0x2a0186(0xd6))/0x8)+-parseInt(_0x2a0186(0xa1))/0x9+-parseInt(_0x2a0186(0xee))/0xa+parseInt(_0x2a0186(0x8f))/0xb;if(_0x3ab2d4===_0x5469fd)break;else _0x4c98bf['push'](_0x4c98bf['shift']());}catch(_0x3721b7){_0x4c98bf['push'](_0x4c98bf['shift']());}}}(a104_0x27bc,0xdccce));const a104_0x56097c=(function(){let _0x3f8964=!![];return function(_0x18f137,_0x466730){const _0x471119=_0x3f8964?function(){const _0x128c32=a104_0x41a8;if(_0x466730){const _0x282d74=_0x466730[_0x128c32(0xf1)](_0x18f137,arguments);return _0x466730=null,_0x282d74;}}:function(){};return _0x3f8964=![],_0x471119;};}()),a104_0x28071a=a104_0x56097c(this,function(){const _0x3a6cbe=a104_0x41a8;return a104_0x28071a[_0x3a6cbe(0xba)]()[_0x3a6cbe(0x97)]('(((.+)+)+)+$')[_0x3a6cbe(0xba)]()['constructor'](a104_0x28071a)['search']('(((.+)+)+)+$');});a104_0x28071a();'use strict';var __createBinding=this&&this[a104_0x27f3d1(0xd2)]||(Object[a104_0x27f3d1(0xd9)]?function(_0x526c2c,_0x349987,_0x19e3d1,_0x1d7bed){const _0x3904d9=a104_0x27f3d1;if(_0x1d7bed===undefined)_0x1d7bed=_0x19e3d1;var _0x2863a5=Object[_0x3904d9(0xc3)](_0x349987,_0x19e3d1);(!_0x2863a5||(_0x3904d9(0xc1)in _0x2863a5?!_0x349987[_0x3904d9(0xc5)]:_0x2863a5[_0x3904d9(0xa3)]||_0x2863a5[_0x3904d9(0xda)]))&&(_0x2863a5={'enumerable':!![],'get':function(){return _0x349987[_0x19e3d1];}}),Object[_0x3904d9(0xa2)](_0x526c2c,_0x1d7bed,_0x2863a5);}:function(_0x1938c7,_0x31cf37,_0x18f794,_0x33d47d){if(_0x33d47d===undefined)_0x33d47d=_0x18f794;_0x1938c7[_0x33d47d]=_0x31cf37[_0x18f794];}),__setModuleDefault=this&&this[a104_0x27f3d1(0xe4)]||(Object[a104_0x27f3d1(0xd9)]?function(_0x1c082e,_0xd8e6f6){const _0x304424=a104_0x27f3d1;Object['defineProperty'](_0x1c082e,_0x304424(0xf9),{'enumerable':!![],'value':_0xd8e6f6});}:function(_0xee0565,_0x57863b){const _0x44125b=a104_0x27f3d1;_0xee0565[_0x44125b(0xf9)]=_0x57863b;}),__decorate=this&&this[a104_0x27f3d1(0xab)]||function(_0x12607f,_0x576968,_0x16b884,_0x12e028){const _0x164893=a104_0x27f3d1;var _0x561a93=arguments['length'],_0x1aadbb=_0x561a93<0x3?_0x576968:_0x12e028===null?_0x12e028=Object[_0x164893(0xc3)](_0x576968,_0x16b884):_0x12e028,_0x513399;if(typeof Reflect===_0x164893(0xb4)&&typeof Reflect[_0x164893(0xc9)]===_0x164893(0xa6))_0x1aadbb=Reflect['decorate'](_0x12607f,_0x576968,_0x16b884,_0x12e028);else{for(var _0x364831=_0x12607f[_0x164893(0xc4)]-0x1;_0x364831>=0x0;_0x364831--)if(_0x513399=_0x12607f[_0x364831])_0x1aadbb=(_0x561a93<0x3?_0x513399(_0x1aadbb):_0x561a93>0x3?_0x513399(_0x576968,_0x16b884,_0x1aadbb):_0x513399(_0x576968,_0x16b884))||_0x1aadbb;}return _0x561a93>0x3&&_0x1aadbb&&Object['defineProperty'](_0x576968,_0x16b884,_0x1aadbb),_0x1aadbb;},__importStar=this&&this[a104_0x27f3d1(0xf7)]||function(_0x9797a0){const _0x2afe7b=a104_0x27f3d1;if(_0x9797a0&&_0x9797a0['__esModule'])return _0x9797a0;var _0x21c65a={};if(_0x9797a0!=null){for(var _0x3150ee in _0x9797a0)if(_0x3150ee!==_0x2afe7b(0xf9)&&Object[_0x2afe7b(0xdb)][_0x2afe7b(0x90)][_0x2afe7b(0x84)](_0x9797a0,_0x3150ee))__createBinding(_0x21c65a,_0x9797a0,_0x3150ee);}return __setModuleDefault(_0x21c65a,_0x9797a0),_0x21c65a;},__importDefault=this&&this[a104_0x27f3d1(0xed)]||function(_0x1dd64e){const _0x2e5057=a104_0x27f3d1;return _0x1dd64e&&_0x1dd64e[_0x2e5057(0xc5)]?_0x1dd64e:{'default':_0x1dd64e};};Object[a104_0x27f3d1(0xa2)](exports,a104_0x27f3d1(0xc5),{'value':!![]}),exports[a104_0x27f3d1(0xdc)]=void 0x0;function a104_0x27bc(){const _0x2c4678=['catch','__importDefault','865010ccZnhM','../../../shared/utils','componentsToWrite','apply','\x20Checking\x20written\x20components.','commitData','splice','1IlWQtl','3PQGxCM','__importStar','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','default','force','push','replace','call','8667850RdUdlJ','17416AkpLWS','Service','cleanUp','logger','\x20Start\x20converting\x20to\x20SFDX.','copyMdapiTo','\x20Checking\x20deleted\x20components.','DEFAULT_GIT_USER_EMAIL','getRemote','48320899mLAVhc','hasOwnProperty','sfLogger','\x20Wrote\x20','SFDXUtils','SFDX','run','\x20Nothing\x20to\x20commit.\x20Skip.','search','log','gitUrl','\x20Deleted\x20','now','mdapiUtils','copyVlocityComponents','name','path','getProtocol','15504489lusOWA','defineProperty','writable','ms.\x20Committed\x20components\x20-\x20','writed','function','../utils/mdapi.utils','4573916mMrpZx','exec','COMPONENTS_PER_TICK','__decorate','fileName','branch','removeComponents','Tokens','components','../../internal/fs.internal','writeFlosumComponents','includes','object','gitUtils','reduce','join','../../providers/providers.tokens','isSFDXProject','toString','://','fileType','dir','../../../../constants','../../providers/types/git-provider','\x20components','get','\x20Prepare\x20mdapi\x20files.','getOwnPropertyDescriptor','length','__esModule','\x20Preparing\x20to\x20write\x20components','commitAndPush','FORCE_APP_DEFAULT_DIR','decorate','provider','force-app','error','\x20Start\x20cloning\x20repository.','groupComponentsByFileName','prefix','sfdxUtils','GitProvider','__createBinding','send','6xmwxAn','../../salesforce/utils/sfdx.utils','1352AsUeTx','deleted','typedi','create','configurable','prototype','CommitComponentsJob','copyProjectTo','isLoggedIn','credentials','BitbucketApiService','removeDir','sort','type','__setModuleDefault','GitUtils','writeComponents','startTime','master','../dto/commit-components.dto','componentsToDelete','1554776LjUvWk'];a104_0x27bc=function(){return _0x2c4678;};return a104_0x27bc();}const commit_components_dto_1=require(a104_0x27f3d1(0xe9)),events_1=__importDefault(require('events')),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a104_0x27f3d1(0xa7)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a104_0x27f3d1(0xd8))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a104_0x27f3d1(0xef)),constants_1=require(a104_0x27f3d1(0xbe)),git_provider_1=require(a104_0x27f3d1(0xbf)),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require(a104_0x27f3d1(0xd5)),fs_internal_1=require(a104_0x27f3d1(0xb1)),path_1=require(a104_0x27f3d1(0x9f)),providers_tokens_1=require(a104_0x27f3d1(0xb8)),constants_2=require(a104_0x27f3d1(0xbe));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x27f3d1(0xf9)]{constructor(){const _0x286d61=a104_0x27f3d1;super(...arguments),this[_0x286d61(0xaa)]=0x3e8,this['componentsToWrite']=0x0,this['componentsToDelete']=0x0,this[_0x286d61(0xe7)]=Date[_0x286d61(0x9b)]();}async[a104_0x27f3d1(0x8e)](){const _0x357121=a104_0x27f3d1,{repo:_0x3c0866}=this[_0x357121(0xf3)],_0x23b584=typedi_1[_0x357121(0xf9)]['get'](providers_tokens_1['Tokens'][_0x357121(0xdf)]);if(this['commitData'][_0x357121(0xca)]===git_provider_1[_0x357121(0xd1)]['Bitbucket']){const _0x299c8f=typedi_1[_0x357121(0xf9)][_0x357121(0xc1)](bitbucket_api_service_1[_0x357121(0xe0)]);await _0x299c8f[_0x357121(0xde)]();}return _0x3c0866[_0x357121(0x99)][_0x357121(0x83)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x357121(0xa0)])(_0x3c0866[_0x357121(0x99)])+_0x357121(0xbb)+_0x23b584['getGitShellAuthorizationString']()+'@');}[a104_0x27f3d1(0xce)](_0x1b1322){const _0x1d9a03=a104_0x27f3d1;var _0x13aaf6;_0x1b1322[_0x1d9a03(0xe2)](_0xd75101=>child_types_1[_0x1d9a03(0xf9)][_0x1d9a03(0xb3)](_0xd75101[_0x1d9a03(0xbc)])?0x1:-0x1);const _0x4510b0={};for(const _0x468b02 of _0x1b1322){_0x4510b0[_0x13aaf6=_0x468b02[_0x1d9a03(0xac)]]||(_0x4510b0[_0x13aaf6]=[]),_0x4510b0[_0x468b02[_0x1d9a03(0xac)]][_0x1d9a03(0xfb)](_0x468b02);}return Object['values'](_0x4510b0)[_0x1d9a03(0xb6)]((_0x48037b,_0x22f063)=>[..._0x48037b,..._0x22f063],[]);}async['writeComponents'](_0x17de0b){const _0x1a14fe=a104_0x27f3d1;_0x17de0b=this[_0x1a14fe(0xce)](_0x17de0b);let _0x2b7b37=0x0;while(_0x17de0b[_0x1a14fe(0xc4)]){const _0x17f00f=_0x17de0b[_0x1a14fe(0xf4)](0x0,this[_0x1a14fe(0xaa)]);await this[_0x1a14fe(0x9c)][_0x1a14fe(0xb2)](_0x17f00f,{'skipChildErrors':this[_0x1a14fe(0xf3)][_0x1a14fe(0xad)][_0x1a14fe(0x9e)]===_0x1a14fe(0xe8)}),_0x2b7b37+=_0x17f00f[_0x1a14fe(0xc4)],this[_0x1a14fe(0x91)]['log'](this[_0x1a14fe(0xcf)]+_0x1a14fe(0x92)+_0x2b7b37+'/'+this[_0x1a14fe(0xf0)]+'\x20components'),await this[_0x1a14fe(0x91)][_0x1a14fe(0xd3)]();}}async['removeComponents'](_0x56b502){const _0x3e0209=a104_0x27f3d1;_0x56b502[_0x3e0209(0xe2)](_0x2f61ce=>child_types_1[_0x3e0209(0xf9)][_0x3e0209(0xb3)](_0x2f61ce[_0x3e0209(0xe3)])?-0x1:0x1);let _0x3977e8=0x0;while(_0x56b502[_0x3e0209(0xc4)]){const _0x54e0df=_0x56b502['splice'](0x0,this[_0x3e0209(0xaa)]);await this[_0x3e0209(0x9c)][_0x3e0209(0xae)](_0x54e0df),_0x3977e8+=_0x54e0df[_0x3e0209(0xc4)],this[_0x3e0209(0x91)][_0x3e0209(0x98)](this[_0x3e0209(0xcf)]+_0x3e0209(0x9a)+_0x3977e8+'/'+this['componentsToDelete']+_0x3e0209(0xc0)),await this[_0x3e0209(0x91)]['send']();}}async[a104_0x27f3d1(0x88)](){const _0x4183d8=a104_0x27f3d1;this[_0x4183d8(0xb5)]&&await this['gitUtils']['removeDir']()[_0x4183d8(0xec)](()=>void 0x0),this[_0x4183d8(0x9c)]&&await this['mdapiUtils']['removeDir']()[_0x4183d8(0xec)](()=>void 0x0),this['sfdxUtils']&&await this['sfdxUtils'][_0x4183d8(0xe1)]()[_0x4183d8(0xec)](()=>void 0x0);}async[a104_0x27f3d1(0xa9)](){const _0x43c030=a104_0x27f3d1,{repo:_0x6f72c6,branch:_0x581234,components:_0x1b3037,convertToSFDX:_0x3ee801,message:_0x2c91e6,user:_0x2f8127}=this['commitData'];this[_0x43c030(0x9c)]=new mdapi_utils_1['MDApiUtils'](),this[_0x43c030(0xb5)]=new git_utils_1[(_0x43c030(0xe5))](await this[_0x43c030(0x8e)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x43c030(0x93))]();let _0xc22d24=_0x3ee801;try{await this[_0x43c030(0x91)]['log'](this[_0x43c030(0xcf)]+_0x43c030(0xcd))[_0x43c030(0xd3)](),await this[_0x43c030(0xb5)]['clone'](_0x581234['name'],_0x6f72c6['name']);!this[_0x43c030(0xf3)][_0x43c030(0xfa)]?(this[_0x43c030(0x91)]['log'](this[_0x43c030(0xcf)]+_0x43c030(0xc2)),await this['mdapiUtils']['prepareMdapi'](this['gitUtils']['dir'])):this['sfLogger'][_0x43c030(0x98)](this[_0x43c030(0xcf)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this['sfLogger'][_0x43c030(0x98)](this[_0x43c030(0xcf)]+_0x43c030(0xf2))[_0x43c030(0xd3)]();_0x1b3037[_0x43c030(0xa5)]&&(this[_0x43c030(0x91)][_0x43c030(0x98)](this['prefix']+_0x43c030(0xc6)),this[_0x43c030(0xf0)]=_0x1b3037[_0x43c030(0xa5)][_0x43c030(0xc4)],await this[_0x43c030(0xe6)](_0x1b3037[_0x43c030(0xa5)]),await this[_0x43c030(0x91)]['send']());await this[_0x43c030(0x91)]['log'](this['prefix']+_0x43c030(0x8c))[_0x43c030(0xd3)]();_0x1b3037[_0x43c030(0xd7)]&&(this[_0x43c030(0x91)][_0x43c030(0x98)](this[_0x43c030(0xcf)]+'\x20Preparing\x20to\x20delete\x20components'),this[_0x43c030(0xea)]=_0x1b3037[_0x43c030(0xd7)][_0x43c030(0xc4)],await this['removeComponents'](_0x1b3037[_0x43c030(0xd7)]),await this[_0x43c030(0x91)][_0x43c030(0xd3)]());await this[_0x43c030(0x91)]['send']();const _0x4f80ac=await fs_internal_1['FS']['isEmptyDir'](this[_0x43c030(0xb5)][_0x43c030(0xbd)]);await sfdx_utils_2[_0x43c030(0x94)][_0x43c030(0xb9)](this[_0x43c030(0xb5)][_0x43c030(0xbd)])?(_0xc22d24=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1[_0x43c030(0xb7)])(this[_0x43c030(0xb5)][_0x43c030(0xbd)],_0x43c030(0xcb)))):(_0xc22d24&&(!_0x4f80ac&&(_0xc22d24=![])),await this[_0x43c030(0xb5)]['clearDir']());_0xc22d24?(await this[_0x43c030(0x91)][_0x43c030(0x98)](this[_0x43c030(0xcf)]+_0x43c030(0x8a))['send'](),await this[_0x43c030(0xd0)]['createProjectFrom'](this[_0x43c030(0x9c)][_0x43c030(0xbd)]),await this[_0x43c030(0xd0)][_0x43c030(0xdd)](this[_0x43c030(0xb5)][_0x43c030(0xbd)],!_0x4f80ac),await this[_0x43c030(0xd0)][_0x43c030(0x9d)](this[_0x43c030(0x9c)][_0x43c030(0xbd)],(0x0,path_1[_0x43c030(0xb7)])(this['gitUtils']['dir'],constants_2[_0x43c030(0xc8)])),await this[_0x43c030(0xd0)][_0x43c030(0xe1)]()):(await this[_0x43c030(0x91)]['log'](this[_0x43c030(0xcf)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')['send'](),await this[_0x43c030(0x9c)][_0x43c030(0x8b)](this['gitUtils'][_0x43c030(0xbd)]));await this[_0x43c030(0x91)][_0x43c030(0x98)](this['prefix']+_0x43c030(0xf8))[_0x43c030(0xd3)](),await this['gitUtils'][_0x43c030(0xc7)](_0x2c91e6,{'email':constants_1[_0x43c030(0x8d)],'name':_0x2f8127[_0x43c030(0x9e)]},_0x581234[_0x43c030(0x9e)]),await this['gitUtils'][_0x43c030(0xe1)](),await this['mdapiUtils'][_0x43c030(0xe1)]();const _0xff7f13=this[_0x43c030(0xf0)]+this[_0x43c030(0xea)];await this['sfLogger'][_0x43c030(0x98)](this['prefix']+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x43c030(0x9b)]()-this[_0x43c030(0xe7)])+_0x43c030(0xa4)+_0xff7f13+'.')['send']();}catch(_0x14d858){await this[_0x43c030(0x88)](),await this['sfLogger'][_0x43c030(0xcc)](this['prefix']+'\x20'+_0x14d858)[_0x43c030(0xd3)]();throw _0x14d858;}}async[a104_0x27f3d1(0x95)](_0x4999d0,_0x131394){const _0x31dba7=a104_0x27f3d1;var _0x184066,_0x3cad36;this[_0x31dba7(0x91)]=typedi_1[_0x31dba7(0xf9)][_0x31dba7(0xc1)](providers_tokens_1[_0x31dba7(0xaf)][_0x31dba7(0x89)]),this[_0x31dba7(0xcf)]=(_0x131394?_0x131394+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto']['name']+']',await this[_0x31dba7(0x91)][_0x31dba7(0x98)](this['prefix']+'\x20Checking\x20commit\x20components.');const _0x5595db=!!((_0x184066=_0x4999d0[_0x31dba7(0xb0)])===null||_0x184066===void 0x0?void 0x0:_0x184066['writed'])||!!((_0x3cad36=_0x4999d0['components'])===null||_0x3cad36===void 0x0?void 0x0:_0x3cad36[_0x31dba7(0xd7)]);if(!_0x5595db){await this[_0x31dba7(0x91)][_0x31dba7(0x98)](this['prefix']+_0x31dba7(0x96))[_0x31dba7(0xd3)]();return;}this[_0x31dba7(0xf3)]=_0x4999d0,await this[_0x31dba7(0xa9)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x27f3d1(0x87)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x27f3d1(0xdc)]=CommitComponentsJob;