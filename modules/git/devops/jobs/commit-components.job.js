const a73_0x578255=a73_0x23e8;(function(_0x450b80,_0x2946d2){const _0x4c5435=a73_0x23e8,_0x174533=_0x450b80();while(!![]){try{const _0x152c09=parseInt(_0x4c5435(0x1b9))/0x1*(-parseInt(_0x4c5435(0x205))/0x2)+parseInt(_0x4c5435(0x1ec))/0x3+parseInt(_0x4c5435(0x1c6))/0x4*(-parseInt(_0x4c5435(0x1f6))/0x5)+-parseInt(_0x4c5435(0x1a8))/0x6+parseInt(_0x4c5435(0x1ac))/0x7+parseInt(_0x4c5435(0x1bc))/0x8*(-parseInt(_0x4c5435(0x1f7))/0x9)+parseInt(_0x4c5435(0x1ed))/0xa;if(_0x152c09===_0x2946d2)break;else _0x174533['push'](_0x174533['shift']());}catch(_0x442f1f){_0x174533['push'](_0x174533['shift']());}}}(a73_0x58a8,0xd2924));function a73_0x23e8(_0x5cefba,_0x5c1f7d){const _0xfa0bda=a73_0x58a8();return a73_0x23e8=function(_0x423912,_0x2aec0a){_0x423912=_0x423912-0x1a2;let _0x58a8d4=_0xfa0bda[_0x423912];return _0x58a8d4;},a73_0x23e8(_0x5cefba,_0x5c1f7d);}const a73_0x2aec0a=(function(){let _0x2bfc2c=!![];return function(_0xd5e904,_0x12ae86){const _0x20f019=_0x2bfc2c?function(){if(_0x12ae86){const _0x3207a0=_0x12ae86['apply'](_0xd5e904,arguments);return _0x12ae86=null,_0x3207a0;}}:function(){};return _0x2bfc2c=![],_0x20f019;};}()),a73_0x423912=a73_0x2aec0a(this,function(){const _0x5c60b7=a73_0x23e8;return a73_0x423912[_0x5c60b7(0x1f1)]()['search']('(((.+)+)+)+$')[_0x5c60b7(0x1f1)]()['constructor'](a73_0x423912)[_0x5c60b7(0x1aa)](_0x5c60b7(0x1a7));});a73_0x423912();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a73_0x578255(0x1ae)]?function(_0x894a5,_0x48bcfe,_0x2ced84,_0x5576a3){const _0xa7d300=a73_0x578255;if(_0x5576a3===undefined)_0x5576a3=_0x2ced84;var _0x3470c6=Object['getOwnPropertyDescriptor'](_0x48bcfe,_0x2ced84);(!_0x3470c6||(_0xa7d300(0x1a6)in _0x3470c6?!_0x48bcfe[_0xa7d300(0x1c9)]:_0x3470c6[_0xa7d300(0x206)]||_0x3470c6[_0xa7d300(0x1ef)]))&&(_0x3470c6={'enumerable':!![],'get':function(){return _0x48bcfe[_0x2ced84];}}),Object[_0xa7d300(0x1db)](_0x894a5,_0x5576a3,_0x3470c6);}:function(_0x172ac0,_0x4b3ba5,_0x43380b,_0x462492){if(_0x462492===undefined)_0x462492=_0x43380b;_0x172ac0[_0x462492]=_0x4b3ba5[_0x43380b];}),__setModuleDefault=this&&this[a73_0x578255(0x1c0)]||(Object[a73_0x578255(0x1ae)]?function(_0x523cc6,_0x528bc5){const _0x3903bf=a73_0x578255;Object[_0x3903bf(0x1db)](_0x523cc6,_0x3903bf(0x200),{'enumerable':!![],'value':_0x528bc5});}:function(_0x393964,_0x3cb5d5){_0x393964['default']=_0x3cb5d5;}),__decorate=this&&this[a73_0x578255(0x1cb)]||function(_0xde4eab,_0x190a3d,_0x199b7f,_0xc977f9){const _0x2a69e0=a73_0x578255;var _0x34211e=arguments[_0x2a69e0(0x1b3)],_0xa06333=_0x34211e<0x3?_0x190a3d:_0xc977f9===null?_0xc977f9=Object['getOwnPropertyDescriptor'](_0x190a3d,_0x199b7f):_0xc977f9,_0x4d6fac;if(typeof Reflect===_0x2a69e0(0x1a9)&&typeof Reflect['decorate']===_0x2a69e0(0x217))_0xa06333=Reflect['decorate'](_0xde4eab,_0x190a3d,_0x199b7f,_0xc977f9);else{for(var _0x34de06=_0xde4eab[_0x2a69e0(0x1b3)]-0x1;_0x34de06>=0x0;_0x34de06--)if(_0x4d6fac=_0xde4eab[_0x34de06])_0xa06333=(_0x34211e<0x3?_0x4d6fac(_0xa06333):_0x34211e>0x3?_0x4d6fac(_0x190a3d,_0x199b7f,_0xa06333):_0x4d6fac(_0x190a3d,_0x199b7f))||_0xa06333;}return _0x34211e>0x3&&_0xa06333&&Object['defineProperty'](_0x190a3d,_0x199b7f,_0xa06333),_0xa06333;},__importStar=this&&this[a73_0x578255(0x1fa)]||function(_0x3e44ba){const _0x3a6fc5=a73_0x578255;if(_0x3e44ba&&_0x3e44ba[_0x3a6fc5(0x1c9)])return _0x3e44ba;var _0x5636b9={};if(_0x3e44ba!=null){for(var _0x2a1d7c in _0x3e44ba)if(_0x2a1d7c!==_0x3a6fc5(0x200)&&Object[_0x3a6fc5(0x1e1)][_0x3a6fc5(0x1dc)][_0x3a6fc5(0x209)](_0x3e44ba,_0x2a1d7c))__createBinding(_0x5636b9,_0x3e44ba,_0x2a1d7c);}return __setModuleDefault(_0x5636b9,_0x3e44ba),_0x5636b9;},__importDefault=this&&this[a73_0x578255(0x1a2)]||function(_0x262019){return _0x262019&&_0x262019['__esModule']?_0x262019:{'default':_0x262019};};Object[a73_0x578255(0x1db)](exports,a73_0x578255(0x1c9),{'value':!![]}),exports[a73_0x578255(0x1cc)]=void 0x0;const commit_components_dto_1=require(a73_0x578255(0x1e7)),events_1=__importDefault(require(a73_0x578255(0x1f3))),git_utils_1=require(a73_0x578255(0x203)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a73_0x578255(0x1c5)),typedi_1=__importStar(require(a73_0x578255(0x201))),child_types_1=__importDefault(require(a73_0x578255(0x1ad))),utils_1=require(a73_0x578255(0x1b1)),constants_1=require('../../../../constants'),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require(a73_0x578255(0x1ab)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a73_0x578255(0x1ca)),path_1=require(a73_0x578255(0x1a4)),providers_tokens_1=require(a73_0x578255(0x1d9));function a73_0x58a8(){const _0x4999da=['function','__importDefault','startTime','path','\x20Start\x20converting\x20to\x20SFDX.','get','(((.+)+)+)+$','4295574FmvDtg','object','search','../../providers/api/bitbucket-api.service','5283915cLdBQF','../../parsers/data/child-types','create','send','fileName','../../../shared/utils','copyMdapiTo','length','mdapiUtils','now','branch','Service','commitAndPush','26084LYjUOo','splice','\x20Preparing\x20to\x20delete\x20components','136400EHexXY','writeFlosumComponents','componentsToWrite','GitUtils','__setModuleDefault','force-app','components','replace','\x20components','../utils/sfdx.utils','4qrqFgV','run','\x20Checking\x20deleted\x20components.','__esModule','../../internal/fs.internal','__decorate','CommitComponentsJob','commitData','Tokens','BitbucketApiService','\x20Checking\x20written\x20components.','writed','SFDX','isSFDXProject','\x20Copying\x20mdapi\x20to\x20git\x20folder.','clearDir','sfLogger','getRemote','error','../../providers/providers.tokens','isEmptyDir','defineProperty','hasOwnProperty','\x20Nothing\x20to\x20commit.\x20Skip.','prefix','SFDXUtils','sort','prototype','log','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','://','deleted','GitProvider','../dto/commit-components.dto','\x20Deleted\x20','\x20Wrote\x20','credentials','\x20Start\x20cloning\x20repository.','2512995xhXDol','29417140OoJGli','catch','configurable','removeDir','toString','master','events','name','clone','735615WtnuQD','684tAKQQW','values','prepareMdapi','__importStar','COMPONENTS_PER_TICK','dir','provider','exec','writeComponents','default','typedi','\x20Checking\x20commit\x20components.','../utils/git.utils','groupComponentsByFileName','116QabxRc','writable','getProtocol','CommitComponentsDto','call','componentsToDelete','getGitShellAuthorizationString','push','type','cleanUp','fileType','gitUrl','ms.\x20Committed\x20components\x20-\x20','sfdxUtils','createProjectFrom','logger','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','gitUtils'];a73_0x58a8=function(){return _0x4999da;};return a73_0x58a8();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a73_0x578255(0x200)]{constructor(){const _0x1676b2=a73_0x578255;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x1676b2(0x1be)]=0x0,this[_0x1676b2(0x20a)]=0x0,this[_0x1676b2(0x1a3)]=Date[_0x1676b2(0x1b5)]();}async[a73_0x578255(0x1d7)](){const _0xac14d4=a73_0x578255,{repo:_0x5d9d15}=this[_0xac14d4(0x1cd)],_0x501085=typedi_1[_0xac14d4(0x200)][_0xac14d4(0x1a6)](providers_tokens_1['Tokens'][_0xac14d4(0x1ea)]);if(this[_0xac14d4(0x1cd)][_0xac14d4(0x1fd)]===git_provider_1[_0xac14d4(0x1e6)]['Bitbucket']){const _0x118cff=typedi_1[_0xac14d4(0x200)][_0xac14d4(0x1a6)](bitbucket_api_service_1[_0xac14d4(0x1cf)]);await _0x118cff['isLoggedIn']();}return _0x5d9d15['gitUrl'][_0xac14d4(0x1c3)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0xac14d4(0x207)])(_0x5d9d15[_0xac14d4(0x210)])+_0xac14d4(0x1e4)+_0x501085[_0xac14d4(0x20b)]()+'@');}['groupComponentsByFileName'](_0x504d64){const _0x1fbb79=a73_0x578255;var _0x38a826;_0x504d64['sort'](_0x1559a9=>child_types_1[_0x1fbb79(0x200)]['includes'](_0x1559a9[_0x1fbb79(0x20f)])?0x1:-0x1);const _0x46f3e9={};for(const _0x2ee120 of _0x504d64){_0x46f3e9[_0x38a826=_0x2ee120[_0x1fbb79(0x1b0)]]||(_0x46f3e9[_0x38a826]=[]),_0x46f3e9[_0x2ee120[_0x1fbb79(0x1b0)]][_0x1fbb79(0x20c)](_0x2ee120);}return Object[_0x1fbb79(0x1f8)](_0x46f3e9)['reduce']((_0x41b51a,_0x28114b)=>[..._0x41b51a,..._0x28114b],[]);}async[a73_0x578255(0x1ff)](_0x2b8f29){const _0x52576e=a73_0x578255;_0x2b8f29=this[_0x52576e(0x204)](_0x2b8f29);let _0x4382af=0x0;while(_0x2b8f29[_0x52576e(0x1b3)]){const _0x1d196a=_0x2b8f29[_0x52576e(0x1ba)](0x0,this[_0x52576e(0x1fb)]);await this[_0x52576e(0x1b4)][_0x52576e(0x1bd)](_0x1d196a,{'skipChildErrors':this[_0x52576e(0x1cd)][_0x52576e(0x1b6)][_0x52576e(0x1f4)]===_0x52576e(0x1f2)}),_0x4382af+=_0x1d196a[_0x52576e(0x1b3)],this[_0x52576e(0x1d6)][_0x52576e(0x1e2)](this[_0x52576e(0x1de)]+_0x52576e(0x1e9)+_0x4382af+'/'+this['componentsToWrite']+_0x52576e(0x1c4)),await this[_0x52576e(0x1d6)]['send']();}}async['removeComponents'](_0x3f1b69){const _0xbe8543=a73_0x578255;_0x3f1b69[_0xbe8543(0x1e0)](_0x243840=>child_types_1[_0xbe8543(0x200)]['includes'](_0x243840[_0xbe8543(0x20d)])?-0x1:0x1);let _0x31a96d=0x0;while(_0x3f1b69[_0xbe8543(0x1b3)]){const _0x18e0ba=_0x3f1b69['splice'](0x0,this[_0xbe8543(0x1fb)]);await this[_0xbe8543(0x1b4)]['removeComponents'](_0x18e0ba),_0x31a96d+=_0x18e0ba[_0xbe8543(0x1b3)],this[_0xbe8543(0x1d6)]['log'](this[_0xbe8543(0x1de)]+_0xbe8543(0x1e8)+_0x31a96d+'/'+this[_0xbe8543(0x20a)]+_0xbe8543(0x1c4)),await this[_0xbe8543(0x1d6)][_0xbe8543(0x1af)]();}}async[a73_0x578255(0x20e)](){const _0x40df53=a73_0x578255;this[_0x40df53(0x216)]&&await this[_0x40df53(0x216)][_0x40df53(0x1f0)]()[_0x40df53(0x1ee)](()=>void 0x0),this[_0x40df53(0x1b4)]&&await this[_0x40df53(0x1b4)][_0x40df53(0x1f0)]()[_0x40df53(0x1ee)](()=>void 0x0),this[_0x40df53(0x212)]&&await this['sfdxUtils']['removeDir']()['catch'](()=>void 0x0);}async[a73_0x578255(0x1fe)](){const _0x220cfc=a73_0x578255,{repo:_0x796f70,branch:_0x437e91,components:_0x7a6deb,convertToSFDX:_0x32c44e,message:_0x4ab582,user:_0x468188}=this[_0x220cfc(0x1cd)];this['mdapiUtils']=new mdapi_utils_1['MDApiUtils'](),this[_0x220cfc(0x216)]=new git_utils_1[(_0x220cfc(0x1bf))](await this['getRemote']()),this[_0x220cfc(0x212)]=new sfdx_utils_1[(_0x220cfc(0x1df))]();let _0x2aeb8e=_0x32c44e;try{await this['sfLogger'][_0x220cfc(0x1e2)](this[_0x220cfc(0x1de)]+_0x220cfc(0x1eb))[_0x220cfc(0x1af)](),await this[_0x220cfc(0x216)][_0x220cfc(0x1f5)](_0x437e91[_0x220cfc(0x1f4)],_0x796f70[_0x220cfc(0x1f4)]);!this[_0x220cfc(0x1cd)]['force']?(this['sfLogger'][_0x220cfc(0x1e2)](this[_0x220cfc(0x1de)]+'\x20Prepare\x20mdapi\x20files.'),await this[_0x220cfc(0x1b4)][_0x220cfc(0x1f9)](this['gitUtils']['dir'])):this[_0x220cfc(0x1d6)]['log'](this[_0x220cfc(0x1de)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x220cfc(0x1d6)][_0x220cfc(0x1e2)](this[_0x220cfc(0x1de)]+_0x220cfc(0x1d0))[_0x220cfc(0x1af)]();_0x7a6deb[_0x220cfc(0x1d1)]&&(this[_0x220cfc(0x1d6)]['log'](this['prefix']+'\x20Preparing\x20to\x20write\x20components'),this['componentsToWrite']=_0x7a6deb[_0x220cfc(0x1d1)][_0x220cfc(0x1b3)],await this[_0x220cfc(0x1ff)](_0x7a6deb[_0x220cfc(0x1d1)]),await this[_0x220cfc(0x1d6)][_0x220cfc(0x1af)]());await this[_0x220cfc(0x1d6)][_0x220cfc(0x1e2)](this[_0x220cfc(0x1de)]+_0x220cfc(0x1c8))['send']();_0x7a6deb['deleted']&&(this[_0x220cfc(0x1d6)][_0x220cfc(0x1e2)](this[_0x220cfc(0x1de)]+_0x220cfc(0x1bb)),this['componentsToDelete']=_0x7a6deb[_0x220cfc(0x1e5)][_0x220cfc(0x1b3)],await this['removeComponents'](_0x7a6deb[_0x220cfc(0x1e5)]),await this[_0x220cfc(0x1d6)][_0x220cfc(0x1af)]());await this[_0x220cfc(0x1d6)][_0x220cfc(0x1af)]();const _0x1b6e3f=await fs_internal_1['FS'][_0x220cfc(0x1da)](this[_0x220cfc(0x216)][_0x220cfc(0x1fc)]);await sfdx_utils_2[_0x220cfc(0x1d2)][_0x220cfc(0x1d3)](this['gitUtils'][_0x220cfc(0x1fc)])?(_0x2aeb8e=!![],await fs_internal_1['FS'][_0x220cfc(0x1f0)]((0x0,path_1['join'])(this[_0x220cfc(0x216)]['dir'],_0x220cfc(0x1c1)))):(_0x2aeb8e&&(!_0x1b6e3f&&(_0x2aeb8e=![])),await this['gitUtils'][_0x220cfc(0x1d5)]());_0x2aeb8e?(await this[_0x220cfc(0x1d6)]['log'](this[_0x220cfc(0x1de)]+_0x220cfc(0x1a5))[_0x220cfc(0x1af)](),await this[_0x220cfc(0x212)][_0x220cfc(0x213)](this[_0x220cfc(0x1b4)][_0x220cfc(0x1fc)]),await this[_0x220cfc(0x212)]['copyProjectTo'](this[_0x220cfc(0x216)]['dir'],!_0x1b6e3f),await this[_0x220cfc(0x212)]['removeDir']()):(await this[_0x220cfc(0x1d6)][_0x220cfc(0x1e2)](this['prefix']+_0x220cfc(0x1d4))[_0x220cfc(0x1af)](),await this['mdapiUtils'][_0x220cfc(0x1b2)](this[_0x220cfc(0x216)][_0x220cfc(0x1fc)]));await this[_0x220cfc(0x1d6)][_0x220cfc(0x1e2)](this['prefix']+_0x220cfc(0x1e3))[_0x220cfc(0x1af)](),await this[_0x220cfc(0x216)][_0x220cfc(0x1b8)](_0x4ab582,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x468188[_0x220cfc(0x1f4)]},_0x437e91[_0x220cfc(0x1f4)]),await this[_0x220cfc(0x216)][_0x220cfc(0x1f0)](),await this[_0x220cfc(0x1b4)][_0x220cfc(0x1f0)]();const _0x1d9751=this[_0x220cfc(0x1be)]+this[_0x220cfc(0x20a)];await this[_0x220cfc(0x1d6)]['log'](this[_0x220cfc(0x1de)]+_0x220cfc(0x215)+(Date['now']()-this[_0x220cfc(0x1a3)])+_0x220cfc(0x211)+_0x1d9751+'.')['send']();}catch(_0x3a9ca9){await this[_0x220cfc(0x20e)](),await this[_0x220cfc(0x1d6)][_0x220cfc(0x1d8)](this[_0x220cfc(0x1de)]+'\x20'+_0x3a9ca9)[_0x220cfc(0x1af)]();throw _0x3a9ca9;}}async[a73_0x578255(0x1c7)](_0x50782d,_0xb6fe6c){const _0x112bb7=a73_0x578255;var _0x3431b5,_0x3bba88;this['sfLogger']=typedi_1[_0x112bb7(0x200)][_0x112bb7(0x1a6)](providers_tokens_1[_0x112bb7(0x1ce)][_0x112bb7(0x214)]),this[_0x112bb7(0x1de)]=(_0xb6fe6c?_0xb6fe6c+'\x20':'')+'['+commit_components_dto_1[_0x112bb7(0x208)]['name']+']',await this[_0x112bb7(0x1d6)]['log'](this[_0x112bb7(0x1de)]+_0x112bb7(0x202));const _0x36afdc=!!((_0x3431b5=_0x50782d[_0x112bb7(0x1c2)])===null||_0x3431b5===void 0x0?void 0x0:_0x3431b5[_0x112bb7(0x1d1)])||!!((_0x3bba88=_0x50782d[_0x112bb7(0x1c2)])===null||_0x3bba88===void 0x0?void 0x0:_0x3bba88[_0x112bb7(0x1e5)]);if(!_0x36afdc){await this[_0x112bb7(0x1d6)][_0x112bb7(0x1e2)](this[_0x112bb7(0x1de)]+_0x112bb7(0x1dd))[_0x112bb7(0x1af)]();return;}this[_0x112bb7(0x1cd)]=_0x50782d,await this[_0x112bb7(0x1fe)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a73_0x578255(0x1b7)])({'transient':!![]})],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;