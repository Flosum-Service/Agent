function a104_0x3886(_0x499025,_0x58dd44){const _0x3692d0=a104_0x3ef9();return a104_0x3886=function(_0xc51ab8,_0x156340){_0xc51ab8=_0xc51ab8-0x115;let _0x3ef9b7=_0x3692d0[_0xc51ab8];return _0x3ef9b7;},a104_0x3886(_0x499025,_0x58dd44);}function a104_0x3ef9(){const _0x27030d=['../../../shared/utils','sort','162832owOxtr','__setModuleDefault','getProtocol','DEFAULT_GIT_USER_EMAIL','../../providers/types/git-provider','21QLLuVw','1914335MMOGrt','prefix','2629xtXBmZ','isEmptyDir','default','sfdxUtils','Bitbucket','splice','gitUtils','__importDefault','\x20Deleted\x20','create','apply','../utils/sfdx.utils','prototype','force-app','startTime','send','call','3993846PTMffD','gitUrl','\x20Nothing\x20to\x20commit.\x20Skip.','4hFtmOZ','FORCE_APP_DEFAULT_DIR','../utils/git.utils','CommitComponentsDto','search','\x20components','../../providers/api/bitbucket-api.service','type','\x20Copying\x20mdapi\x20to\x20git\x20folder.','COMPONENTS_PER_TICK','credentials','prepareMdapi','writable','components','name','commitData','567uVIoBC','Tokens','SFDXUtils','12759012ioMLzK','15722NhCiDW','ms.\x20Committed\x20components\x20-\x20','removeDir','../../providers/providers.tokens','deleted','\x20Checking\x20commit\x20components.','exec','catch','__decorate','join','fileType','../../internal/fs.internal','defineProperty','now','../../salesforce/utils/sfdx.utils','37330LRMKJo','events','push','\x20Start\x20cloning\x20repository.','1652388hvAubA','getOwnPropertyDescriptor','9anztlJ','cleanUp','groupComponentsByFileName','toString','\x20Preparing\x20to\x20delete\x20components','sfLogger','GitProvider','CommitComponentsJob','log','path','componentsToDelete','mdapiUtils','componentsToWrite','clone','decorate','typedi','../utils/mdapi.utils','__createBinding','length','\x20Start\x20converting\x20to\x20SFDX.','://','\x20Prepare\x20mdapi\x20files.','get','../../../../constants','copyProjectTo','includes','provider','object','writeComponents','clearDir','createProjectFrom','removeComponents','isLoggedIn','dir','error','fileName','run','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','replace','__esModule','SFDX','\x20Checking\x20written\x20components.','\x20Wrote\x20','writed','getRemote'];a104_0x3ef9=function(){return _0x27030d;};return a104_0x3ef9();}const a104_0x4fc514=a104_0x3886;(function(_0x4930d2,_0x24cc9a){const _0x55b36f=a104_0x3886,_0x19067f=_0x4930d2();while(!![]){try{const _0x5cbf9f=parseInt(_0x55b36f(0x158))/0x1*(parseInt(_0x55b36f(0x143))/0x2)+parseInt(_0x55b36f(0x12c))/0x3+-parseInt(_0x55b36f(0x12f))/0x4*(parseInt(_0x55b36f(0x119))/0x5)+parseInt(_0x55b36f(0x156))/0x6*(parseInt(_0x55b36f(0x118))/0x7)+parseInt(_0x55b36f(0x187))/0x8*(-parseInt(_0x55b36f(0x13f))/0x9)+-parseInt(_0x55b36f(0x152))/0xa*(parseInt(_0x55b36f(0x11b))/0xb)+parseInt(_0x55b36f(0x142))/0xc;if(_0x5cbf9f===_0x24cc9a)break;else _0x19067f['push'](_0x19067f['shift']());}catch(_0x83e37d){_0x19067f['push'](_0x19067f['shift']());}}}(a104_0x3ef9,0xb33a8));const a104_0x156340=(function(){let _0x1b9de9=!![];return function(_0x2ff085,_0x2db277){const _0x293e38=_0x1b9de9?function(){const _0x1db9dc=a104_0x3886;if(_0x2db277){const _0x2dba54=_0x2db277[_0x1db9dc(0x125)](_0x2ff085,arguments);return _0x2db277=null,_0x2dba54;}}:function(){};return _0x1b9de9=![],_0x293e38;};}()),a104_0xc51ab8=a104_0x156340(this,function(){const _0x367582=a104_0x3886;return a104_0xc51ab8['toString']()[_0x367582(0x133)]('(((.+)+)+)+$')[_0x367582(0x15b)]()['constructor'](a104_0xc51ab8)['search']('(((.+)+)+)+$');});a104_0xc51ab8();'use strict';var __createBinding=this&&this[a104_0x4fc514(0x169)]||(Object[a104_0x4fc514(0x124)]?function(_0x17e67e,_0x3b8231,_0x173a0e,_0x1f479e){const _0x30348e=a104_0x4fc514;if(_0x1f479e===undefined)_0x1f479e=_0x173a0e;var _0x1b1ddf=Object[_0x30348e(0x157)](_0x3b8231,_0x173a0e);(!_0x1b1ddf||(_0x30348e(0x16e)in _0x1b1ddf?!_0x3b8231[_0x30348e(0x17f)]:_0x1b1ddf[_0x30348e(0x13b)]||_0x1b1ddf['configurable']))&&(_0x1b1ddf={'enumerable':!![],'get':function(){return _0x3b8231[_0x173a0e];}}),Object[_0x30348e(0x14f)](_0x17e67e,_0x1f479e,_0x1b1ddf);}:function(_0x554367,_0x3a1ee6,_0x1b14b2,_0x4e9625){if(_0x4e9625===undefined)_0x4e9625=_0x1b14b2;_0x554367[_0x4e9625]=_0x3a1ee6[_0x1b14b2];}),__setModuleDefault=this&&this[a104_0x4fc514(0x188)]||(Object[a104_0x4fc514(0x124)]?function(_0x519f70,_0x4763d4){const _0x604859=a104_0x4fc514;Object[_0x604859(0x14f)](_0x519f70,_0x604859(0x11d),{'enumerable':!![],'value':_0x4763d4});}:function(_0x1d3053,_0x1219e2){const _0x2a8c31=a104_0x4fc514;_0x1d3053[_0x2a8c31(0x11d)]=_0x1219e2;}),__decorate=this&&this[a104_0x4fc514(0x14b)]||function(_0x557296,_0x283387,_0x57d08d,_0x178cd0){const _0x4e5c3b=a104_0x4fc514;var _0x5e93ee=arguments[_0x4e5c3b(0x16a)],_0x25f924=_0x5e93ee<0x3?_0x283387:_0x178cd0===null?_0x178cd0=Object[_0x4e5c3b(0x157)](_0x283387,_0x57d08d):_0x178cd0,_0x275b85;if(typeof Reflect===_0x4e5c3b(0x173)&&typeof Reflect['decorate']==='function')_0x25f924=Reflect[_0x4e5c3b(0x166)](_0x557296,_0x283387,_0x57d08d,_0x178cd0);else{for(var _0x15f536=_0x557296['length']-0x1;_0x15f536>=0x0;_0x15f536--)if(_0x275b85=_0x557296[_0x15f536])_0x25f924=(_0x5e93ee<0x3?_0x275b85(_0x25f924):_0x5e93ee>0x3?_0x275b85(_0x283387,_0x57d08d,_0x25f924):_0x275b85(_0x283387,_0x57d08d))||_0x25f924;}return _0x5e93ee>0x3&&_0x25f924&&Object[_0x4e5c3b(0x14f)](_0x283387,_0x57d08d,_0x25f924),_0x25f924;},__importStar=this&&this['__importStar']||function(_0x41d5b2){const _0x2515d5=a104_0x4fc514;if(_0x41d5b2&&_0x41d5b2[_0x2515d5(0x17f)])return _0x41d5b2;var _0x56e63e={};if(_0x41d5b2!=null){for(var _0x20c505 in _0x41d5b2)if(_0x20c505!==_0x2515d5(0x11d)&&Object[_0x2515d5(0x127)]['hasOwnProperty'][_0x2515d5(0x12b)](_0x41d5b2,_0x20c505))__createBinding(_0x56e63e,_0x41d5b2,_0x20c505);}return __setModuleDefault(_0x56e63e,_0x41d5b2),_0x56e63e;},__importDefault=this&&this[a104_0x4fc514(0x122)]||function(_0x20d0ed){const _0x4fe3f5=a104_0x4fc514;return _0x20d0ed&&_0x20d0ed[_0x4fe3f5(0x17f)]?_0x20d0ed:{'default':_0x20d0ed};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a104_0x4fc514(0x15f)]=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a104_0x4fc514(0x153))),git_utils_1=require(a104_0x4fc514(0x131)),mdapi_utils_1=require(a104_0x4fc514(0x168)),sfdx_utils_1=require(a104_0x4fc514(0x126)),typedi_1=__importStar(require(a104_0x4fc514(0x167))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a104_0x4fc514(0x185)),constants_1=require(a104_0x4fc514(0x16f)),git_provider_1=require(a104_0x4fc514(0x117)),bitbucket_api_service_1=require(a104_0x4fc514(0x135)),sfdx_utils_2=require(a104_0x4fc514(0x151)),fs_internal_1=require(a104_0x4fc514(0x14e)),path_1=require(a104_0x4fc514(0x161)),providers_tokens_1=require(a104_0x4fc514(0x146)),constants_2=require(a104_0x4fc514(0x16f));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x4fc514(0x11d)]{constructor(){const _0x538705=a104_0x4fc514;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x538705(0x164)]=0x0,this['componentsToDelete']=0x0,this[_0x538705(0x129)]=Date['now']();}async['getRemote'](){const _0x169bba=a104_0x4fc514,{repo:_0x559fb2}=this[_0x169bba(0x13e)],_0x96065d=typedi_1[_0x169bba(0x11d)][_0x169bba(0x16e)](providers_tokens_1['Tokens'][_0x169bba(0x139)]);if(this[_0x169bba(0x13e)][_0x169bba(0x172)]===git_provider_1[_0x169bba(0x15e)][_0x169bba(0x11f)]){const _0x2e958c=typedi_1['default'][_0x169bba(0x16e)](bitbucket_api_service_1['BitbucketApiService']);await _0x2e958c[_0x169bba(0x178)]();}return _0x559fb2[_0x169bba(0x12d)][_0x169bba(0x17e)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x169bba(0x115)])(_0x559fb2['gitUrl'])+_0x169bba(0x16c)+_0x96065d['getGitShellAuthorizationString']()+'@');}[a104_0x4fc514(0x15a)](_0x29cf28){const _0x1d246d=a104_0x4fc514;var _0x78e04b;_0x29cf28['sort'](_0x494447=>child_types_1[_0x1d246d(0x11d)][_0x1d246d(0x171)](_0x494447[_0x1d246d(0x14d)])?0x1:-0x1);const _0x48da97={};for(const _0xb615b6 of _0x29cf28){_0x48da97[_0x78e04b=_0xb615b6[_0x1d246d(0x17b)]]||(_0x48da97[_0x78e04b]=[]),_0x48da97[_0xb615b6[_0x1d246d(0x17b)]][_0x1d246d(0x154)](_0xb615b6);}return Object['values'](_0x48da97)['reduce']((_0x2532cc,_0x570d16)=>[..._0x2532cc,..._0x570d16],[]);}async['writeComponents'](_0x35f6b8){const _0x5958d0=a104_0x4fc514;_0x35f6b8=this[_0x5958d0(0x15a)](_0x35f6b8);let _0x110d46=0x0;while(_0x35f6b8['length']){const _0x366679=_0x35f6b8[_0x5958d0(0x120)](0x0,this[_0x5958d0(0x138)]);await this[_0x5958d0(0x163)]['writeFlosumComponents'](_0x366679,{'skipChildErrors':this[_0x5958d0(0x13e)]['branch']['name']==='master'}),_0x110d46+=_0x366679[_0x5958d0(0x16a)],this[_0x5958d0(0x15d)]['log'](this[_0x5958d0(0x11a)]+_0x5958d0(0x182)+_0x110d46+'/'+this['componentsToWrite']+_0x5958d0(0x134)),await this[_0x5958d0(0x15d)][_0x5958d0(0x12a)]();}}async[a104_0x4fc514(0x177)](_0xb5cdb7){const _0x5b1d89=a104_0x4fc514;_0xb5cdb7[_0x5b1d89(0x186)](_0x40f07f=>child_types_1[_0x5b1d89(0x11d)][_0x5b1d89(0x171)](_0x40f07f[_0x5b1d89(0x136)])?-0x1:0x1);let _0x253f9a=0x0;while(_0xb5cdb7[_0x5b1d89(0x16a)]){const _0x3bd6b4=_0xb5cdb7[_0x5b1d89(0x120)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x5b1d89(0x163)]['removeComponents'](_0x3bd6b4),_0x253f9a+=_0x3bd6b4[_0x5b1d89(0x16a)],this[_0x5b1d89(0x15d)][_0x5b1d89(0x160)](this[_0x5b1d89(0x11a)]+_0x5b1d89(0x123)+_0x253f9a+'/'+this[_0x5b1d89(0x162)]+_0x5b1d89(0x134)),await this[_0x5b1d89(0x15d)][_0x5b1d89(0x12a)]();}}async[a104_0x4fc514(0x159)](){const _0x4eabe0=a104_0x4fc514;this['gitUtils']&&await this['gitUtils'][_0x4eabe0(0x145)]()[_0x4eabe0(0x14a)](()=>void 0x0),this[_0x4eabe0(0x163)]&&await this[_0x4eabe0(0x163)]['removeDir']()[_0x4eabe0(0x14a)](()=>void 0x0),this[_0x4eabe0(0x11e)]&&await this[_0x4eabe0(0x11e)]['removeDir']()['catch'](()=>void 0x0);}async[a104_0x4fc514(0x149)](){const _0x2c3d08=a104_0x4fc514,{repo:_0x73d20,branch:_0x576200,components:_0x19fe49,convertToSFDX:_0x4369ea,message:_0x18d79f,user:_0x4424de}=this['commitData'];this[_0x2c3d08(0x163)]=new mdapi_utils_1['MDApiUtils'](),this[_0x2c3d08(0x121)]=new git_utils_1['GitUtils'](await this[_0x2c3d08(0x184)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x2c3d08(0x141))]();let _0x4e8c7e=_0x4369ea;try{await this['sfLogger']['log'](this[_0x2c3d08(0x11a)]+_0x2c3d08(0x155))[_0x2c3d08(0x12a)](),await this['gitUtils'][_0x2c3d08(0x165)](_0x576200['name'],_0x73d20[_0x2c3d08(0x13d)]);!this[_0x2c3d08(0x13e)]['force']?(this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this['prefix']+_0x2c3d08(0x16d)),await this[_0x2c3d08(0x163)][_0x2c3d08(0x13a)](this[_0x2c3d08(0x121)]['dir'])):this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this[_0x2c3d08(0x11a)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x2c3d08(0x15d)]['log'](this[_0x2c3d08(0x11a)]+_0x2c3d08(0x181))['send']();_0x19fe49[_0x2c3d08(0x183)]&&(this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this['prefix']+'\x20Preparing\x20to\x20write\x20components'),this[_0x2c3d08(0x164)]=_0x19fe49['writed'][_0x2c3d08(0x16a)],await this[_0x2c3d08(0x174)](_0x19fe49[_0x2c3d08(0x183)]),await this[_0x2c3d08(0x15d)][_0x2c3d08(0x12a)]());await this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this[_0x2c3d08(0x11a)]+'\x20Checking\x20deleted\x20components.')[_0x2c3d08(0x12a)]();_0x19fe49[_0x2c3d08(0x147)]&&(this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this[_0x2c3d08(0x11a)]+_0x2c3d08(0x15c)),this[_0x2c3d08(0x162)]=_0x19fe49['deleted'][_0x2c3d08(0x16a)],await this['removeComponents'](_0x19fe49['deleted']),await this[_0x2c3d08(0x15d)][_0x2c3d08(0x12a)]());await this['sfLogger'][_0x2c3d08(0x12a)]();const _0x3b77ae=await fs_internal_1['FS'][_0x2c3d08(0x11c)](this[_0x2c3d08(0x121)]['dir']);await sfdx_utils_2[_0x2c3d08(0x180)]['isSFDXProject'](this['gitUtils'][_0x2c3d08(0x179)])?(_0x4e8c7e=!![],await fs_internal_1['FS'][_0x2c3d08(0x145)]((0x0,path_1[_0x2c3d08(0x14c)])(this['gitUtils']['dir'],_0x2c3d08(0x128)))):(_0x4e8c7e&&(!_0x3b77ae&&(_0x4e8c7e=![])),await this[_0x2c3d08(0x121)][_0x2c3d08(0x175)]());_0x4e8c7e?(await this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this[_0x2c3d08(0x11a)]+_0x2c3d08(0x16b))['send'](),await this[_0x2c3d08(0x11e)][_0x2c3d08(0x176)](this['mdapiUtils'][_0x2c3d08(0x179)]),await this[_0x2c3d08(0x11e)][_0x2c3d08(0x170)](this[_0x2c3d08(0x121)][_0x2c3d08(0x179)],!_0x3b77ae),await this['sfdxUtils']['copyVlocityComponents'](this['mdapiUtils'][_0x2c3d08(0x179)],(0x0,path_1[_0x2c3d08(0x14c)])(this['gitUtils'][_0x2c3d08(0x179)],constants_2[_0x2c3d08(0x130)])),await this['sfdxUtils'][_0x2c3d08(0x145)]()):(await this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this[_0x2c3d08(0x11a)]+_0x2c3d08(0x137))[_0x2c3d08(0x12a)](),await this[_0x2c3d08(0x163)]['copyMdapiTo'](this['gitUtils'][_0x2c3d08(0x179)]));await this['sfLogger'][_0x2c3d08(0x160)](this['prefix']+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')[_0x2c3d08(0x12a)](),await this[_0x2c3d08(0x121)]['commitAndPush'](_0x18d79f,{'email':constants_1[_0x2c3d08(0x116)],'name':_0x4424de[_0x2c3d08(0x13d)]},_0x576200[_0x2c3d08(0x13d)]),await this[_0x2c3d08(0x121)]['removeDir'](),await this[_0x2c3d08(0x163)][_0x2c3d08(0x145)]();const _0x1c480f=this['componentsToWrite']+this[_0x2c3d08(0x162)];await this[_0x2c3d08(0x15d)][_0x2c3d08(0x160)](this[_0x2c3d08(0x11a)]+_0x2c3d08(0x17d)+(Date[_0x2c3d08(0x150)]()-this['startTime'])+_0x2c3d08(0x144)+_0x1c480f+'.')['send']();}catch(_0x7ffe4){await this[_0x2c3d08(0x159)](),await this[_0x2c3d08(0x15d)][_0x2c3d08(0x17a)](this[_0x2c3d08(0x11a)]+'\x20'+_0x7ffe4)['send']();throw _0x7ffe4;}}async[a104_0x4fc514(0x17c)](_0x347aef,_0x167a1f){const _0x29bf38=a104_0x4fc514;var _0x2b66e1,_0x220e72;this[_0x29bf38(0x15d)]=typedi_1[_0x29bf38(0x11d)]['get'](providers_tokens_1[_0x29bf38(0x140)]['logger']),this[_0x29bf38(0x11a)]=(_0x167a1f?_0x167a1f+'\x20':'')+'['+commit_components_dto_1[_0x29bf38(0x132)][_0x29bf38(0x13d)]+']',await this['sfLogger'][_0x29bf38(0x160)](this['prefix']+_0x29bf38(0x148));const _0x678d14=!!((_0x2b66e1=_0x347aef[_0x29bf38(0x13c)])===null||_0x2b66e1===void 0x0?void 0x0:_0x2b66e1[_0x29bf38(0x183)])||!!((_0x220e72=_0x347aef[_0x29bf38(0x13c)])===null||_0x220e72===void 0x0?void 0x0:_0x220e72['deleted']);if(!_0x678d14){await this[_0x29bf38(0x15d)]['log'](this['prefix']+_0x29bf38(0x12e))[_0x29bf38(0x12a)]();return;}this[_0x29bf38(0x13e)]=_0x347aef,await this['exec']();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a104_0x4fc514(0x15f)]=CommitComponentsJob;