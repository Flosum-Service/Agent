const a103_0xc21b82=a103_0x2bbb;function a103_0x5252(){const _0x1e2d64=['copyMdapiTo','object','__esModule','default','search','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','force-app','getGitShellAuthorizationString','create','isSFDXProject','startTime','clearDir','../../providers/types/git-provider','writeComponents','8274KvIxQF','components','sfLogger','1265614CxIZJu','run','151773ltnnic','175620erBQzf','fileName','gitUtils','values','commitAndPush','send','SFDX','catch','124071uIrFdl','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','1870497FLPwgf','prepareMdapi','\x20Copying\x20mdapi\x20to\x20git\x20folder.','SFDXUtils','\x20Start\x20converting\x20to\x20SFDX.','constructor','decorate','\x20Checking\x20written\x20components.','writable','DEFAULT_GIT_USER_EMAIL','Service','BitbucketApiService','configurable','dir','../utils/git.utils','join','path','length','COMPONENTS_PER_TICK','commitData','function','8OQlSTo','475TmXKnV','includes','sort','\x20components','\x20Preparing\x20to\x20delete\x20components','../../parsers/data/child-types','__importStar','../../providers/api/bitbucket-api.service','\x20Preparing\x20to\x20write\x20components','__decorate','defineProperty','__importDefault','exec','://','\x20Checking\x20commit\x20components.','copyProjectTo','isLoggedIn','get','../../providers/providers.tokens','isEmptyDir','../../../../constants','../../salesforce/utils/sfdx.utils','GitProvider','16JIHLfw','now','../dto/commit-components.dto','\x20Checking\x20deleted\x20components.','removeDir','componentsToWrite','writeFlosumComponents','createProjectFrom','call','provider','name','cleanUp','__setModuleDefault','(((.+)+)+)+$','splice','prefix','replace','toString','gitUrl','clone','mdapiUtils','Tokens','componentsToDelete','getRemote','force','66NiGsEp','log','deleted','sfdxUtils','645070OuPzQD','ms.\x20Committed\x20components\x20-\x20','prototype','getOwnPropertyDescriptor','writed','apply','master','removeComponents','CommitComponentsJob','MDApiUtils'];a103_0x5252=function(){return _0x1e2d64;};return a103_0x5252();}(function(_0x49976d,_0x1fc369){const _0x2d1c61=a103_0x2bbb,_0x28f53d=_0x49976d();while(!![]){try{const _0x388846=parseInt(_0x2d1c61(0x9b))/0x1+-parseInt(_0x2d1c61(0x93))/0x2+parseInt(_0x2d1c61(0x92))/0x3*(-parseInt(_0x2d1c61(0xca))/0x4)+-parseInt(_0x2d1c61(0xb3))/0x5*(parseInt(_0x2d1c61(0x8d))/0x6)+-parseInt(_0x2d1c61(0x90))/0x7*(parseInt(_0x2d1c61(0xb2))/0x8)+parseInt(_0x2d1c61(0x9d))/0x9+parseInt(_0x2d1c61(0xe7))/0xa*(parseInt(_0x2d1c61(0xe3))/0xb);if(_0x388846===_0x1fc369)break;else _0x28f53d['push'](_0x28f53d['shift']());}catch(_0x1cc30b){_0x28f53d['push'](_0x28f53d['shift']());}}}(a103_0x5252,0x1c8e5));const a103_0x3fe83b=(function(){let _0x2b62e6=!![];return function(_0x5ac071,_0x519fa9){const _0x37917e=_0x2b62e6?function(){const _0x39843a=a103_0x2bbb;if(_0x519fa9){const _0xfd187e=_0x519fa9[_0x39843a(0xec)](_0x5ac071,arguments);return _0x519fa9=null,_0xfd187e;}}:function(){};return _0x2b62e6=![],_0x37917e;};}()),a103_0x129300=a103_0x3fe83b(this,function(){const _0x252958=a103_0x2bbb;return a103_0x129300[_0x252958(0xdb)]()[_0x252958(0xf5)]('(((.+)+)+)+$')[_0x252958(0xdb)]()[_0x252958(0xa2)](a103_0x129300)[_0x252958(0xf5)](_0x252958(0xd7));});a103_0x129300();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0xb472c6,_0x6d912c,_0x15c1de,_0x4f11b5){const _0x44f3c6=a103_0x2bbb;if(_0x4f11b5===undefined)_0x4f11b5=_0x15c1de;var _0x1eaf78=Object[_0x44f3c6(0xea)](_0x6d912c,_0x15c1de);(!_0x1eaf78||('get'in _0x1eaf78?!_0x6d912c[_0x44f3c6(0xf3)]:_0x1eaf78[_0x44f3c6(0xa5)]||_0x1eaf78[_0x44f3c6(0xa9)]))&&(_0x1eaf78={'enumerable':!![],'get':function(){return _0x6d912c[_0x15c1de];}}),Object['defineProperty'](_0xb472c6,_0x4f11b5,_0x1eaf78);}:function(_0xf4ec16,_0x53294a,_0x18f798,_0x57020d){if(_0x57020d===undefined)_0x57020d=_0x18f798;_0xf4ec16[_0x57020d]=_0x53294a[_0x18f798];}),__setModuleDefault=this&&this[a103_0xc21b82(0xd6)]||(Object[a103_0xc21b82(0x87)]?function(_0x336151,_0x17f805){const _0x292177=a103_0xc21b82;Object[_0x292177(0xbd)](_0x336151,_0x292177(0xf4),{'enumerable':!![],'value':_0x17f805});}:function(_0x1eafaf,_0x51ffb7){const _0x39f74d=a103_0xc21b82;_0x1eafaf[_0x39f74d(0xf4)]=_0x51ffb7;}),__decorate=this&&this[a103_0xc21b82(0xbc)]||function(_0x4e6b80,_0x17cda0,_0x202dc8,_0x4c734f){const _0x1aedd7=a103_0xc21b82;var _0x40d135=arguments[_0x1aedd7(0xae)],_0x921444=_0x40d135<0x3?_0x17cda0:_0x4c734f===null?_0x4c734f=Object[_0x1aedd7(0xea)](_0x17cda0,_0x202dc8):_0x4c734f,_0x36240f;if(typeof Reflect===_0x1aedd7(0xf2)&&typeof Reflect['decorate']===_0x1aedd7(0xb1))_0x921444=Reflect[_0x1aedd7(0xa3)](_0x4e6b80,_0x17cda0,_0x202dc8,_0x4c734f);else{for(var _0x556b0b=_0x4e6b80[_0x1aedd7(0xae)]-0x1;_0x556b0b>=0x0;_0x556b0b--)if(_0x36240f=_0x4e6b80[_0x556b0b])_0x921444=(_0x40d135<0x3?_0x36240f(_0x921444):_0x40d135>0x3?_0x36240f(_0x17cda0,_0x202dc8,_0x921444):_0x36240f(_0x17cda0,_0x202dc8))||_0x921444;}return _0x40d135>0x3&&_0x921444&&Object['defineProperty'](_0x17cda0,_0x202dc8,_0x921444),_0x921444;},__importStar=this&&this[a103_0xc21b82(0xb9)]||function(_0x172cc7){const _0x27de6b=a103_0xc21b82;if(_0x172cc7&&_0x172cc7['__esModule'])return _0x172cc7;var _0x4a33a1={};if(_0x172cc7!=null){for(var _0x7b38c0 in _0x172cc7)if(_0x7b38c0!==_0x27de6b(0xf4)&&Object[_0x27de6b(0xe9)]['hasOwnProperty'][_0x27de6b(0xd2)](_0x172cc7,_0x7b38c0))__createBinding(_0x4a33a1,_0x172cc7,_0x7b38c0);}return __setModuleDefault(_0x4a33a1,_0x172cc7),_0x4a33a1;},__importDefault=this&&this[a103_0xc21b82(0xbe)]||function(_0x32c01d){const _0x789224=a103_0xc21b82;return _0x32c01d&&_0x32c01d[_0x789224(0xf3)]?_0x32c01d:{'default':_0x32c01d};};Object[a103_0xc21b82(0xbd)](exports,a103_0xc21b82(0xf3),{'value':!![]}),exports[a103_0xc21b82(0xef)]=void 0x0;function a103_0x2bbb(_0x28be79,_0x2bc51b){const _0x64dd55=a103_0x5252();return a103_0x2bbb=function(_0x129300,_0x3fe83b){_0x129300=_0x129300-0x84;let _0x52520a=_0x64dd55[_0x129300];return _0x52520a;},a103_0x2bbb(_0x28be79,_0x2bc51b);}const commit_components_dto_1=require(a103_0xc21b82(0xcc)),events_1=__importDefault(require('events')),git_utils_1=require(a103_0xc21b82(0xab)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a103_0xc21b82(0xb8))),utils_1=require('../../../shared/utils'),constants_1=require(a103_0xc21b82(0xc7)),git_provider_1=require(a103_0xc21b82(0x8b)),bitbucket_api_service_1=require(a103_0xc21b82(0xba)),sfdx_utils_2=require(a103_0xc21b82(0xc8)),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a103_0xc21b82(0xad)),providers_tokens_1=require(a103_0xc21b82(0xc5));let CommitComponentsJob=class CommitComponentsJob extends events_1[a103_0xc21b82(0xf4)]{constructor(){const _0x412e64=a103_0xc21b82;super(...arguments),this[_0x412e64(0xaf)]=0x3e8,this[_0x412e64(0xcf)]=0x0,this[_0x412e64(0xe0)]=0x0,this[_0x412e64(0x89)]=Date[_0x412e64(0xcb)]();}async[a103_0xc21b82(0xe1)](){const _0x55f037=a103_0xc21b82,{repo:_0x17202c}=this['commitData'],_0x4ead05=typedi_1[_0x55f037(0xf4)][_0x55f037(0xc4)](providers_tokens_1[_0x55f037(0xdf)]['credentials']);if(this[_0x55f037(0xb0)][_0x55f037(0xd3)]===git_provider_1[_0x55f037(0xc9)]['Bitbucket']){const _0x54f54b=typedi_1['default'][_0x55f037(0xc4)](bitbucket_api_service_1[_0x55f037(0xa8)]);await _0x54f54b[_0x55f037(0xc3)]();}return _0x17202c[_0x55f037(0xdc)][_0x55f037(0xda)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x17202c['gitUrl'])+_0x55f037(0xc0)+_0x4ead05[_0x55f037(0x86)]()+'@');}['groupComponentsByFileName'](_0x546332){const _0x5c4f95=a103_0xc21b82;var _0x5c49c8;_0x546332[_0x5c4f95(0xb5)](_0x2a3c76=>child_types_1[_0x5c4f95(0xf4)][_0x5c4f95(0xb4)](_0x2a3c76['fileType'])?0x1:-0x1);const _0x4d1d93={};for(const _0x3b53aa of _0x546332){_0x4d1d93[_0x5c49c8=_0x3b53aa['fileName']]||(_0x4d1d93[_0x5c49c8]=[]),_0x4d1d93[_0x3b53aa[_0x5c4f95(0x94)]]['push'](_0x3b53aa);}return Object[_0x5c4f95(0x96)](_0x4d1d93)['reduce']((_0xafbe4d,_0xfb2a34)=>[..._0xafbe4d,..._0xfb2a34],[]);}async['writeComponents'](_0x1793df){const _0x4902ea=a103_0xc21b82;_0x1793df=this['groupComponentsByFileName'](_0x1793df);let _0x2c4077=0x0;while(_0x1793df[_0x4902ea(0xae)]){const _0x4dc277=_0x1793df[_0x4902ea(0xd8)](0x0,this[_0x4902ea(0xaf)]);await this[_0x4902ea(0xde)][_0x4902ea(0xd0)](_0x4dc277,{'skipChildErrors':this[_0x4902ea(0xb0)]['branch'][_0x4902ea(0xd4)]===_0x4902ea(0xed)}),_0x2c4077+=_0x4dc277[_0x4902ea(0xae)],this[_0x4902ea(0x8f)]['log'](this['prefix']+'\x20Wrote\x20'+_0x2c4077+'/'+this['componentsToWrite']+_0x4902ea(0xb6)),await this[_0x4902ea(0x8f)][_0x4902ea(0x98)]();}}async[a103_0xc21b82(0xee)](_0x38f53f){const _0x3a0851=a103_0xc21b82;_0x38f53f[_0x3a0851(0xb5)](_0x21d235=>child_types_1['default'][_0x3a0851(0xb4)](_0x21d235['type'])?-0x1:0x1);let _0x5171d4=0x0;while(_0x38f53f[_0x3a0851(0xae)]){const _0x395e4e=_0x38f53f[_0x3a0851(0xd8)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x3a0851(0xde)][_0x3a0851(0xee)](_0x395e4e),_0x5171d4+=_0x395e4e['length'],this[_0x3a0851(0x8f)][_0x3a0851(0xe4)](this[_0x3a0851(0xd9)]+'\x20Deleted\x20'+_0x5171d4+'/'+this[_0x3a0851(0xe0)]+_0x3a0851(0xb6)),await this[_0x3a0851(0x8f)][_0x3a0851(0x98)]();}}async[a103_0xc21b82(0xd5)](){const _0x576838=a103_0xc21b82;this[_0x576838(0x95)]&&await this[_0x576838(0x95)][_0x576838(0xce)]()['catch'](()=>void 0x0),this[_0x576838(0xde)]&&await this['mdapiUtils'][_0x576838(0xce)]()['catch'](()=>void 0x0),this[_0x576838(0xe6)]&&await this[_0x576838(0xe6)]['removeDir']()[_0x576838(0x9a)](()=>void 0x0);}async[a103_0xc21b82(0xbf)](){const _0x1e80e5=a103_0xc21b82,{repo:_0x10eb00,branch:_0x58c62b,components:_0x3979be,convertToSFDX:_0xff7f57,message:_0x1730ed,user:_0x189510}=this['commitData'];this['mdapiUtils']=new mdapi_utils_1[(_0x1e80e5(0xf0))](),this['gitUtils']=new git_utils_1['GitUtils'](await this[_0x1e80e5(0xe1)]()),this[_0x1e80e5(0xe6)]=new sfdx_utils_1[(_0x1e80e5(0xa0))]();let _0x291c77=_0xff7f57;try{await this[_0x1e80e5(0x8f)]['log'](this[_0x1e80e5(0xd9)]+'\x20Start\x20cloning\x20repository.')[_0x1e80e5(0x98)](),await this[_0x1e80e5(0x95)][_0x1e80e5(0xdd)](_0x58c62b[_0x1e80e5(0xd4)],_0x10eb00[_0x1e80e5(0xd4)]);!this[_0x1e80e5(0xb0)][_0x1e80e5(0xe2)]?(this[_0x1e80e5(0x8f)][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+'\x20Prepare\x20mdapi\x20files.'),await this['mdapiUtils'][_0x1e80e5(0x9e)](this[_0x1e80e5(0x95)]['dir'])):this['sfLogger'][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+_0x1e80e5(0x84));await this[_0x1e80e5(0x8f)][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+_0x1e80e5(0xa4))[_0x1e80e5(0x98)]();_0x3979be[_0x1e80e5(0xeb)]&&(this[_0x1e80e5(0x8f)][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+_0x1e80e5(0xbb)),this[_0x1e80e5(0xcf)]=_0x3979be[_0x1e80e5(0xeb)][_0x1e80e5(0xae)],await this[_0x1e80e5(0x8c)](_0x3979be[_0x1e80e5(0xeb)]),await this[_0x1e80e5(0x8f)][_0x1e80e5(0x98)]());await this[_0x1e80e5(0x8f)][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+_0x1e80e5(0xcd))[_0x1e80e5(0x98)]();_0x3979be[_0x1e80e5(0xe5)]&&(this['sfLogger'][_0x1e80e5(0xe4)](this['prefix']+_0x1e80e5(0xb7)),this[_0x1e80e5(0xe0)]=_0x3979be['deleted']['length'],await this['removeComponents'](_0x3979be[_0x1e80e5(0xe5)]),await this[_0x1e80e5(0x8f)][_0x1e80e5(0x98)]());await this[_0x1e80e5(0x8f)][_0x1e80e5(0x98)]();const _0x247ad=await fs_internal_1['FS'][_0x1e80e5(0xc6)](this[_0x1e80e5(0x95)][_0x1e80e5(0xaa)]);await sfdx_utils_2[_0x1e80e5(0x99)][_0x1e80e5(0x88)](this[_0x1e80e5(0x95)][_0x1e80e5(0xaa)])?(_0x291c77=!![],await fs_internal_1['FS'][_0x1e80e5(0xce)]((0x0,path_1[_0x1e80e5(0xac)])(this[_0x1e80e5(0x95)][_0x1e80e5(0xaa)],_0x1e80e5(0x85)))):(_0x291c77&&(!_0x247ad&&(_0x291c77=![])),await this['gitUtils'][_0x1e80e5(0x8a)]());_0x291c77?(await this[_0x1e80e5(0x8f)][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+_0x1e80e5(0xa1))[_0x1e80e5(0x98)](),await this['sfdxUtils'][_0x1e80e5(0xd1)](this['mdapiUtils'][_0x1e80e5(0xaa)]),await this[_0x1e80e5(0xe6)][_0x1e80e5(0xc2)](this[_0x1e80e5(0x95)][_0x1e80e5(0xaa)],!_0x247ad),await this[_0x1e80e5(0xe6)][_0x1e80e5(0xce)]()):(await this['sfLogger'][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+_0x1e80e5(0x9f))['send'](),await this['mdapiUtils'][_0x1e80e5(0xf1)](this[_0x1e80e5(0x95)][_0x1e80e5(0xaa)]));await this[_0x1e80e5(0x8f)]['log'](this[_0x1e80e5(0xd9)]+_0x1e80e5(0x9c))[_0x1e80e5(0x98)](),await this['gitUtils'][_0x1e80e5(0x97)](_0x1730ed,{'email':constants_1[_0x1e80e5(0xa6)],'name':_0x189510[_0x1e80e5(0xd4)]},_0x58c62b[_0x1e80e5(0xd4)]),await this[_0x1e80e5(0x95)][_0x1e80e5(0xce)](),await this[_0x1e80e5(0xde)][_0x1e80e5(0xce)]();const _0x57c7b0=this[_0x1e80e5(0xcf)]+this['componentsToDelete'];await this['sfLogger'][_0x1e80e5(0xe4)](this[_0x1e80e5(0xd9)]+_0x1e80e5(0xf6)+(Date['now']()-this[_0x1e80e5(0x89)])+_0x1e80e5(0xe8)+_0x57c7b0+'.')[_0x1e80e5(0x98)]();}catch(_0x5ed0a0){await this[_0x1e80e5(0xd5)](),await this['sfLogger']['error'](this['prefix']+'\x20'+_0x5ed0a0)['send']();throw _0x5ed0a0;}}async[a103_0xc21b82(0x91)](_0x1aedc2,_0x523a27){const _0x42249b=a103_0xc21b82;var _0x581940,_0x5d269a;this['sfLogger']=typedi_1[_0x42249b(0xf4)]['get'](providers_tokens_1[_0x42249b(0xdf)]['logger']),this[_0x42249b(0xd9)]=(_0x523a27?_0x523a27+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto']['name']+']',await this[_0x42249b(0x8f)][_0x42249b(0xe4)](this[_0x42249b(0xd9)]+_0x42249b(0xc1));const _0x2ef6cb=!!((_0x581940=_0x1aedc2[_0x42249b(0x8e)])===null||_0x581940===void 0x0?void 0x0:_0x581940[_0x42249b(0xeb)])||!!((_0x5d269a=_0x1aedc2[_0x42249b(0x8e)])===null||_0x5d269a===void 0x0?void 0x0:_0x5d269a[_0x42249b(0xe5)]);if(!_0x2ef6cb){await this[_0x42249b(0x8f)][_0x42249b(0xe4)](this[_0x42249b(0xd9)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x42249b(0x98)]();return;}this[_0x42249b(0xb0)]=_0x1aedc2,await this[_0x42249b(0xbf)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a103_0xc21b82(0xa7)])({'transient':!![]})],CommitComponentsJob),exports[a103_0xc21b82(0xef)]=CommitComponentsJob;