const a105_0x13375a=a105_0x5c1b;function a105_0x5c1b(_0x2b4696,_0x1c2317){const _0x5cc592=a105_0xfb90();return a105_0x5c1b=function(_0x109fec,_0xf79bdd){_0x109fec=_0x109fec-0x1d3;let _0xfb9016=_0x5cc592[_0x109fec];return _0xfb9016;},a105_0x5c1b(_0x2b4696,_0x1c2317);}(function(_0x1c8154,_0x26aad6){const _0x171eb2=a105_0x5c1b,_0x1bdbbb=_0x1c8154();while(!![]){try{const _0x26a8a8=parseInt(_0x171eb2(0x216))/0x1*(parseInt(_0x171eb2(0x1e4))/0x2)+-parseInt(_0x171eb2(0x240))/0x3*(-parseInt(_0x171eb2(0x232))/0x4)+parseInt(_0x171eb2(0x1fe))/0x5*(parseInt(_0x171eb2(0x1e8))/0x6)+-parseInt(_0x171eb2(0x203))/0x7+parseInt(_0x171eb2(0x249))/0x8+-parseInt(_0x171eb2(0x245))/0x9+-parseInt(_0x171eb2(0x231))/0xa;if(_0x26a8a8===_0x26aad6)break;else _0x1bdbbb['push'](_0x1bdbbb['shift']());}catch(_0x10dcfb){_0x1bdbbb['push'](_0x1bdbbb['shift']());}}}(a105_0xfb90,0xd4e70));const a105_0xf79bdd=(function(){let _0x8ceeee=!![];return function(_0xd71a05,_0x289066){const _0x21e6ea=_0x8ceeee?function(){const _0x3e0d03=a105_0x5c1b;if(_0x289066){const _0x4ae166=_0x289066[_0x3e0d03(0x23a)](_0xd71a05,arguments);return _0x289066=null,_0x4ae166;}}:function(){};return _0x8ceeee=![],_0x21e6ea;};}()),a105_0x109fec=a105_0xf79bdd(this,function(){const _0x1f1382=a105_0x5c1b;return a105_0x109fec[_0x1f1382(0x227)]()[_0x1f1382(0x1f0)]('(((.+)+)+)+$')['toString']()[_0x1f1382(0x222)](a105_0x109fec)[_0x1f1382(0x1f0)](_0x1f1382(0x22f));});a105_0x109fec();'use strict';var __createBinding=this&&this[a105_0x13375a(0x218)]||(Object[a105_0x13375a(0x225)]?function(_0x113dd5,_0x57d1e2,_0x437cba,_0x10e64d){const _0xb1c23=a105_0x13375a;if(_0x10e64d===undefined)_0x10e64d=_0x437cba;var _0x1ba4fa=Object[_0xb1c23(0x1d4)](_0x57d1e2,_0x437cba);(!_0x1ba4fa||('get'in _0x1ba4fa?!_0x57d1e2['__esModule']:_0x1ba4fa['writable']||_0x1ba4fa[_0xb1c23(0x1ec)]))&&(_0x1ba4fa={'enumerable':!![],'get':function(){return _0x57d1e2[_0x437cba];}}),Object[_0xb1c23(0x208)](_0x113dd5,_0x10e64d,_0x1ba4fa);}:function(_0x424e3a,_0xa2b6de,_0x595366,_0x30104){if(_0x30104===undefined)_0x30104=_0x595366;_0x424e3a[_0x30104]=_0xa2b6de[_0x595366];}),__setModuleDefault=this&&this[a105_0x13375a(0x24b)]||(Object[a105_0x13375a(0x225)]?function(_0xb184e4,_0x561335){const _0x5370ed=a105_0x13375a;Object[_0x5370ed(0x208)](_0xb184e4,_0x5370ed(0x224),{'enumerable':!![],'value':_0x561335});}:function(_0x1ce54a,_0x28a5bc){const _0x3aa4ff=a105_0x13375a;_0x1ce54a[_0x3aa4ff(0x224)]=_0x28a5bc;}),__decorate=this&&this['__decorate']||function(_0x24d677,_0x5407ef,_0x342ef4,_0x415ae9){const _0x4212f0=a105_0x13375a;var _0x18878f=arguments[_0x4212f0(0x209)],_0x34af2f=_0x18878f<0x3?_0x5407ef:_0x415ae9===null?_0x415ae9=Object[_0x4212f0(0x1d4)](_0x5407ef,_0x342ef4):_0x415ae9,_0x3247fb;if(typeof Reflect===_0x4212f0(0x23d)&&typeof Reflect['decorate']===_0x4212f0(0x1e0))_0x34af2f=Reflect[_0x4212f0(0x1eb)](_0x24d677,_0x5407ef,_0x342ef4,_0x415ae9);else{for(var _0x305ab6=_0x24d677['length']-0x1;_0x305ab6>=0x0;_0x305ab6--)if(_0x3247fb=_0x24d677[_0x305ab6])_0x34af2f=(_0x18878f<0x3?_0x3247fb(_0x34af2f):_0x18878f>0x3?_0x3247fb(_0x5407ef,_0x342ef4,_0x34af2f):_0x3247fb(_0x5407ef,_0x342ef4))||_0x34af2f;}return _0x18878f>0x3&&_0x34af2f&&Object[_0x4212f0(0x208)](_0x5407ef,_0x342ef4,_0x34af2f),_0x34af2f;},__importStar=this&&this[a105_0x13375a(0x219)]||function(_0x43a818){const _0x1e7779=a105_0x13375a;if(_0x43a818&&_0x43a818['__esModule'])return _0x43a818;var _0x468528={};if(_0x43a818!=null){for(var _0x318406 in _0x43a818)if(_0x318406!==_0x1e7779(0x224)&&Object[_0x1e7779(0x22c)][_0x1e7779(0x205)][_0x1e7779(0x1e6)](_0x43a818,_0x318406))__createBinding(_0x468528,_0x43a818,_0x318406);}return __setModuleDefault(_0x468528,_0x43a818),_0x468528;},__importDefault=this&&this[a105_0x13375a(0x233)]||function(_0x5387cd){const _0x348845=a105_0x13375a;return _0x5387cd&&_0x5387cd[_0x348845(0x1e9)]?_0x5387cd:{'default':_0x5387cd};};Object[a105_0x13375a(0x208)](exports,'__esModule',{'value':!![]}),exports[a105_0x13375a(0x244)]=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require('events')),git_utils_1=require(a105_0x13375a(0x236)),mdapi_utils_1=require(a105_0x13375a(0x234)),sfdx_utils_1=require(a105_0x13375a(0x235)),typedi_1=__importStar(require(a105_0x13375a(0x20b))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a105_0x13375a(0x1dc)),constants_1=require(a105_0x13375a(0x1f1)),git_provider_1=require(a105_0x13375a(0x213)),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require(a105_0x13375a(0x241)),fs_internal_1=require(a105_0x13375a(0x21f)),path_1=require(a105_0x13375a(0x23c)),providers_tokens_1=require(a105_0x13375a(0x237)),constants_2=require(a105_0x13375a(0x1f1));let CommitComponentsJob=class CommitComponentsJob extends events_1[a105_0x13375a(0x224)]{constructor(){const _0x32dbf6=a105_0x13375a;super(...arguments),this[_0x32dbf6(0x230)]=0x3e8,this[_0x32dbf6(0x220)]=0x0,this[_0x32dbf6(0x1d8)]=0x0,this[_0x32dbf6(0x1ed)]=Date['now']();}async['getRemote'](){const _0x2c5ade=a105_0x13375a,{repo:_0x468240}=this['commitData'],_0x31c7e1=typedi_1['default'][_0x2c5ade(0x1f6)](providers_tokens_1['Tokens'][_0x2c5ade(0x238)]);if(this['commitData'][_0x2c5ade(0x21a)]===git_provider_1[_0x2c5ade(0x1f2)][_0x2c5ade(0x1de)]){const _0x3f2e72=typedi_1[_0x2c5ade(0x224)][_0x2c5ade(0x1f6)](bitbucket_api_service_1[_0x2c5ade(0x212)]);await _0x3f2e72[_0x2c5ade(0x1df)]();}return _0x468240['gitUrl'][_0x2c5ade(0x23b)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x468240[_0x2c5ade(0x1fc)])+'://'+_0x31c7e1['getGitShellAuthorizationString']()+'@');}[a105_0x13375a(0x22b)](_0x33bd3f){const _0x583415=a105_0x13375a;var _0x5a0c4c;_0x33bd3f['sort'](_0x502ce2=>child_types_1[_0x583415(0x224)][_0x583415(0x248)](_0x502ce2[_0x583415(0x223)])?0x1:-0x1);const _0x18f397={};for(const _0x1d5299 of _0x33bd3f){_0x18f397[_0x5a0c4c=_0x1d5299[_0x583415(0x1dd)]]||(_0x18f397[_0x5a0c4c]=[]),_0x18f397[_0x1d5299[_0x583415(0x1dd)]][_0x583415(0x22d)](_0x1d5299);}return Object['values'](_0x18f397)[_0x583415(0x226)]((_0x31b060,_0x5c7c5f)=>[..._0x31b060,..._0x5c7c5f],[]);}async['writeComponents'](_0x4a13f4){const _0x39845a=a105_0x13375a;_0x4a13f4=this[_0x39845a(0x22b)](_0x4a13f4);let _0x3183c9=0x0;while(_0x4a13f4['length']){const _0x193913=_0x4a13f4['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x39845a(0x1f9)][_0x39845a(0x1d7)](_0x193913,{'skipChildErrors':this[_0x39845a(0x1ff)]['branch'][_0x39845a(0x247)]===_0x39845a(0x1f5),'recordType':this[_0x39845a(0x1ff)][_0x39845a(0x1e2)]}),_0x3183c9+=_0x193913[_0x39845a(0x209)],this[_0x39845a(0x1da)][_0x39845a(0x1f4)](this['prefix']+_0x39845a(0x1f3)+_0x3183c9+'/'+this[_0x39845a(0x220)]+'\x20components'),await this[_0x39845a(0x1da)][_0x39845a(0x20f)]();}}async['removeComponents'](_0x40ef31){const _0x471c33=a105_0x13375a;_0x40ef31[_0x471c33(0x21d)](_0x278ab0=>child_types_1[_0x471c33(0x224)]['includes'](_0x278ab0[_0x471c33(0x23f)])?-0x1:0x1);let _0x52314f=0x0;while(_0x40ef31['length']){const _0x167422=_0x40ef31[_0x471c33(0x1d3)](0x0,this[_0x471c33(0x230)]);await this[_0x471c33(0x1f9)][_0x471c33(0x22e)](_0x167422,this['commitData'][_0x471c33(0x1e2)]),_0x52314f+=_0x167422[_0x471c33(0x209)],this[_0x471c33(0x1da)]['log'](this['prefix']+_0x471c33(0x229)+_0x52314f+'/'+this[_0x471c33(0x1d8)]+_0x471c33(0x214)),await this[_0x471c33(0x1da)][_0x471c33(0x20f)]();}}async[a105_0x13375a(0x206)](){const _0x422b40=a105_0x13375a;this[_0x422b40(0x201)]&&await this[_0x422b40(0x201)]['removeDir']()['catch'](()=>void 0x0),this['mdapiUtils']&&await this['mdapiUtils'][_0x422b40(0x1e1)]()[_0x422b40(0x22a)](()=>void 0x0),this[_0x422b40(0x217)]&&await this[_0x422b40(0x217)][_0x422b40(0x1e1)]()['catch'](()=>void 0x0);}async['exec'](){const _0x88d30a=a105_0x13375a,{repo:_0x4f6e70,branch:_0x2dfc75,components:_0x5f1ea9,convertToSFDX:_0x1b1e03,message:_0x2108af,user:_0x3c5858}=this[_0x88d30a(0x1ff)];this['mdapiUtils']=new mdapi_utils_1[(_0x88d30a(0x228))](),this[_0x88d30a(0x201)]=new git_utils_1[(_0x88d30a(0x20e))](await this[_0x88d30a(0x21b)]()),this[_0x88d30a(0x217)]=new sfdx_utils_1[(_0x88d30a(0x239))]();let _0x306c41=_0x1b1e03&&this['sfdxUtils']['isConvertToSfdx'](this[_0x88d30a(0x1ff)]['recordType']);try{await this['sfLogger']['log'](this[_0x88d30a(0x1ef)]+_0x88d30a(0x200))[_0x88d30a(0x20f)](),await this[_0x88d30a(0x201)]['clone'](_0x2dfc75['name'],_0x4f6e70[_0x88d30a(0x247)]);!this[_0x88d30a(0x1ff)][_0x88d30a(0x1f7)]?(this[_0x88d30a(0x1da)][_0x88d30a(0x1f4)](this[_0x88d30a(0x1ef)]+_0x88d30a(0x246)),await this[_0x88d30a(0x1f9)][_0x88d30a(0x1e5)](this[_0x88d30a(0x201)]['dir'])):this['sfLogger']['log'](this[_0x88d30a(0x1ef)]+_0x88d30a(0x204));await this[_0x88d30a(0x1da)][_0x88d30a(0x1f4)](this[_0x88d30a(0x1ef)]+_0x88d30a(0x215))['send']();_0x5f1ea9[_0x88d30a(0x20d)]&&(this['sfLogger'][_0x88d30a(0x1f4)](this[_0x88d30a(0x1ef)]+_0x88d30a(0x1ea)),this[_0x88d30a(0x220)]=_0x5f1ea9[_0x88d30a(0x20d)][_0x88d30a(0x209)],await this[_0x88d30a(0x23e)](_0x5f1ea9[_0x88d30a(0x20d)]),await this[_0x88d30a(0x1da)][_0x88d30a(0x20f)]());await this[_0x88d30a(0x1da)]['log'](this['prefix']+'\x20Checking\x20deleted\x20components.')[_0x88d30a(0x20f)]();_0x5f1ea9[_0x88d30a(0x1fd)]&&(this[_0x88d30a(0x1da)][_0x88d30a(0x1f4)](this[_0x88d30a(0x1ef)]+_0x88d30a(0x21e)),this[_0x88d30a(0x1d8)]=_0x5f1ea9[_0x88d30a(0x1fd)][_0x88d30a(0x209)],await this['removeComponents'](_0x5f1ea9[_0x88d30a(0x1fd)]),await this[_0x88d30a(0x1da)][_0x88d30a(0x20f)]());await this[_0x88d30a(0x1da)]['send']();const _0x566b0a=await fs_internal_1['FS']['isEmptyDir'](this['gitUtils'][_0x88d30a(0x21c)]);await sfdx_utils_2['SFDX']['isSFDXProject'](this[_0x88d30a(0x201)]['dir'])?(_0x306c41=!![],await fs_internal_1['FS'][_0x88d30a(0x1e1)]((0x0,path_1[_0x88d30a(0x207)])(this['gitUtils']['dir'],_0x88d30a(0x1d6)))):(_0x306c41&&(!_0x566b0a&&(_0x306c41=![])),await this['gitUtils']['clearDir']());_0x306c41?(await this[_0x88d30a(0x1da)][_0x88d30a(0x1f4)](this[_0x88d30a(0x1ef)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x88d30a(0x20f)](),await this[_0x88d30a(0x217)][_0x88d30a(0x1e3)](this[_0x88d30a(0x1f9)][_0x88d30a(0x21c)]),await this[_0x88d30a(0x217)]['copyProjectTo'](this['gitUtils'][_0x88d30a(0x21c)],!_0x566b0a),await this[_0x88d30a(0x217)]['copySFDXIgnoredComponents'](this[_0x88d30a(0x1f9)][_0x88d30a(0x21c)],(0x0,path_1[_0x88d30a(0x207)])(this['gitUtils'][_0x88d30a(0x21c)],constants_2[_0x88d30a(0x202)])),await this[_0x88d30a(0x217)]['removeDir']()):(await this[_0x88d30a(0x1da)]['log'](this['prefix']+_0x88d30a(0x1db))[_0x88d30a(0x20f)](),await this[_0x88d30a(0x1f9)][_0x88d30a(0x211)](this[_0x88d30a(0x201)]['dir']));await this[_0x88d30a(0x1da)][_0x88d30a(0x1f4)](this['prefix']+_0x88d30a(0x242))[_0x88d30a(0x20f)](),await this['gitUtils'][_0x88d30a(0x20a)](_0x2108af,{'email':constants_1[_0x88d30a(0x210)],'name':_0x3c5858[_0x88d30a(0x247)]},_0x2dfc75[_0x88d30a(0x247)]),await this['gitUtils'][_0x88d30a(0x1e1)](),await this['mdapiUtils'][_0x88d30a(0x1e1)]();const _0x6fbe9a=this[_0x88d30a(0x220)]+this[_0x88d30a(0x1d8)];await this[_0x88d30a(0x1da)][_0x88d30a(0x1f4)](this[_0x88d30a(0x1ef)]+_0x88d30a(0x1d5)+(Date[_0x88d30a(0x24a)]()-this[_0x88d30a(0x1ed)])+_0x88d30a(0x243)+_0x6fbe9a+'.')[_0x88d30a(0x20f)]();}catch(_0x996fbc){await this[_0x88d30a(0x206)](),await this[_0x88d30a(0x1da)][_0x88d30a(0x221)](this[_0x88d30a(0x1ef)]+'\x20'+_0x996fbc)[_0x88d30a(0x20f)]();throw _0x996fbc;}}async[a105_0x13375a(0x1ee)](_0x1c0c44,_0x4bd0e5){const _0x263524=a105_0x13375a;var _0x561728,_0x4635ff;this[_0x263524(0x1da)]=typedi_1['default'][_0x263524(0x1f6)](providers_tokens_1[_0x263524(0x1f8)][_0x263524(0x1fb)]),this[_0x263524(0x1ef)]=(_0x4bd0e5?_0x4bd0e5+'\x20':'')+'['+commit_components_dto_1[_0x263524(0x20c)]['name']+']',await this[_0x263524(0x1da)][_0x263524(0x1f4)](this['prefix']+'\x20Checking\x20commit\x20components.');const _0x532de4=!!((_0x561728=_0x1c0c44[_0x263524(0x1e7)])===null||_0x561728===void 0x0?void 0x0:_0x561728[_0x263524(0x20d)])||!!((_0x4635ff=_0x1c0c44[_0x263524(0x1e7)])===null||_0x4635ff===void 0x0?void 0x0:_0x4635ff[_0x263524(0x1fd)]);if(!_0x532de4){await this[_0x263524(0x1da)][_0x263524(0x1f4)](this[_0x263524(0x1ef)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x263524(0x20f)]();return;}this[_0x263524(0x1ff)]=_0x1c0c44,await this[_0x263524(0x1d9)]();}};function a105_0xfb90(){const _0x186fe8=['MDApiUtils','\x20Deleted\x20','catch','groupComponentsByFileName','prototype','push','removeComponents','(((.+)+)+)+$','COMPONENTS_PER_TICK','25579110yLzqfq','8IlcwdZ','__importDefault','../utils/mdapi.utils','../utils/sfdx.utils','../utils/git.utils','../../providers/providers.tokens','credentials','SFDXUtils','apply','replace','path','object','writeComponents','type','1961031hGstVd','../../salesforce/utils/sfdx.utils','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','ms.\x20Committed\x20components\x20-\x20','CommitComponentsJob','1073151xXfCOz','\x20Prepare\x20mdapi\x20files.','name','includes','10869424MTqRNM','now','__setModuleDefault','splice','getOwnPropertyDescriptor','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','force-app','writeFlosumComponents','componentsToDelete','exec','sfLogger','\x20Copying\x20mdapi\x20to\x20git\x20folder.','../../../shared/utils','fileName','Bitbucket','isLoggedIn','function','removeDir','recordType','createProjectFrom','1668272VZyiCz','prepareMdapi','call','components','7987962LXqfCo','__esModule','\x20Preparing\x20to\x20write\x20components','decorate','configurable','startTime','run','prefix','search','../../../../constants','GitProvider','\x20Wrote\x20','log','master','get','force','Tokens','mdapiUtils','Service','logger','gitUrl','deleted','5NhSscD','commitData','\x20Start\x20cloning\x20repository.','gitUtils','FORCE_APP_DEFAULT_DIR','8976079XXDncu','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','hasOwnProperty','cleanUp','join','defineProperty','length','commitAndPush','typedi','CommitComponentsDto','writed','GitUtils','send','DEFAULT_GIT_USER_EMAIL','copyMdapiTo','BitbucketApiService','../../providers/types/git-provider','\x20components','\x20Checking\x20written\x20components.','1KOKKBs','sfdxUtils','__createBinding','__importStar','provider','getRemote','dir','sort','\x20Preparing\x20to\x20delete\x20components','../../internal/fs.internal','componentsToWrite','error','constructor','fileType','default','create','reduce','toString'];a105_0xfb90=function(){return _0x186fe8;};return a105_0xfb90();}CommitComponentsJob=__decorate([(0x0,typedi_1[a105_0x13375a(0x1fa)])({'transient':!![]})],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;