const a124_0x952c1e=a124_0x37da;(function(_0x2fe7ed,_0x2be945){const _0x5c088b=a124_0x37da,_0x569a44=_0x2fe7ed();while(!![]){try{const _0x40a0fa=-parseInt(_0x5c088b(0x157))/0x1+-parseInt(_0x5c088b(0x12a))/0x2*(parseInt(_0x5c088b(0x118))/0x3)+-parseInt(_0x5c088b(0x11e))/0x4*(parseInt(_0x5c088b(0x13f))/0x5)+parseInt(_0x5c088b(0x104))/0x6*(parseInt(_0x5c088b(0x169))/0x7)+parseInt(_0x5c088b(0x15a))/0x8*(parseInt(_0x5c088b(0x109))/0x9)+-parseInt(_0x5c088b(0x15e))/0xa*(parseInt(_0x5c088b(0x11d))/0xb)+parseInt(_0x5c088b(0x160))/0xc;if(_0x40a0fa===_0x2be945)break;else _0x569a44['push'](_0x569a44['shift']());}catch(_0x184c37){_0x569a44['push'](_0x569a44['shift']());}}}(a124_0x208f,0x37b0f));const a124_0x3e99e4=(function(){let _0x33b94d=!![];return function(_0x2c6ad0,_0x2d7a9e){const _0x37c8ba=_0x33b94d?function(){const _0x442c4e=a124_0x37da;if(_0x2d7a9e){const _0x3df5cc=_0x2d7a9e[_0x442c4e(0x141)](_0x2c6ad0,arguments);return _0x2d7a9e=null,_0x3df5cc;}}:function(){};return _0x33b94d=![],_0x37c8ba;};}()),a124_0x5dc1d0=a124_0x3e99e4(this,function(){const _0x243044=a124_0x37da;return a124_0x5dc1d0[_0x243044(0x16d)]()[_0x243044(0x15d)](_0x243044(0x14b))['toString']()['constructor'](a124_0x5dc1d0)[_0x243044(0x15d)](_0x243044(0x14b));});a124_0x5dc1d0();function a124_0x208f(){const _0x56d4a0=['join','credentials','2ErgCTN','dir','componentsToWrite','getOwnPropertyDescriptor','error','cleanUp','type','SFDX','DEFAULT_GIT_USER_EMAIL','clone','__createBinding','splice','now','isConvertToSfdx','run','__setModuleDefault','mdapiUtils','writed','MDApiUtils','gitUrl','\x20Preparing\x20to\x20write\x20components','5xBGbwM','CommitComponentsJob','apply','\x20Wrote\x20','\x20Deleted\x20','isLoggedIn','defineProperty','log','function','\x20Checking\x20deleted\x20components.','COMPONENTS_PER_TICK','sort','(((.+)+)+)+$','force-app','__decorate','clearDir','reduce','length','path','commitData','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','Tokens','../../providers/providers.tokens','removeComponents','104177FKDoMe','writeComponents','copyMdapiTo','241544VRhkCB','fileName','decorate','search','209120fVfCRA','\x20Checking\x20written\x20components.','1614492AWBvjo','startTime','removeDir','sfLogger','get','../utils/mdapi.utils','gitUtils','create','branch','14511GBKqmq','__importStar','events','catch','toString','componentsToDelete','provider','Bitbucket','prepareMdapi','../utils/git.utils','force','prefix','\x20Checking\x20commit\x20components.','default','../../parsers/data/child-types','copyProjectTo','\x20Start\x20cloning\x20repository.','1140mgqmGx','GitUtils','values','../../internal/fs.internal','recordType','117kSEesx','configurable','copySFDXIgnoredComponents','name','send','../../../../constants','SFDXUtils','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','../dto/commit-components.dto','sfdxUtils','components','\x20Copying\x20mdapi\x20to\x20git\x20folder.','getGitShellAuthorizationString','call','replace','918237ejPjHH','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','deleted','\x20components','exec','143Qryfke','42788tUHTdi','createProjectFrom','__importDefault','__esModule','commitAndPush','object','master','CommitComponentsDto','fileType','groupComponentsByFileName'];a124_0x208f=function(){return _0x56d4a0;};return a124_0x208f();}function a124_0x37da(_0x4aadc2,_0x3d3b6c){const _0x2a797d=a124_0x208f();return a124_0x37da=function(_0x5dc1d0,_0x3e99e4){_0x5dc1d0=_0x5dc1d0-0x100;let _0x208ff7=_0x2a797d[_0x5dc1d0];return _0x208ff7;},a124_0x37da(_0x4aadc2,_0x3d3b6c);}'use strict';var __createBinding=this&&this[a124_0x952c1e(0x134)]||(Object['create']?function(_0x58adff,_0x26a06f,_0x31ce44,_0x3467f8){const _0xfcd141=a124_0x952c1e;if(_0x3467f8===undefined)_0x3467f8=_0x31ce44;var _0x16eb11=Object[_0xfcd141(0x12d)](_0x26a06f,_0x31ce44);(!_0x16eb11||(_0xfcd141(0x164)in _0x16eb11?!_0x26a06f[_0xfcd141(0x121)]:_0x16eb11['writable']||_0x16eb11[_0xfcd141(0x10a)]))&&(_0x16eb11={'enumerable':!![],'get':function(){return _0x26a06f[_0x31ce44];}}),Object[_0xfcd141(0x145)](_0x58adff,_0x3467f8,_0x16eb11);}:function(_0x3533ab,_0xc5c0f7,_0x1c1b56,_0x15f572){if(_0x15f572===undefined)_0x15f572=_0x1c1b56;_0x3533ab[_0x15f572]=_0xc5c0f7[_0x1c1b56];}),__setModuleDefault=this&&this[a124_0x952c1e(0x139)]||(Object[a124_0x952c1e(0x167)]?function(_0x15047d,_0x58e926){const _0x22d69d=a124_0x952c1e;Object['defineProperty'](_0x15047d,_0x22d69d(0x100),{'enumerable':!![],'value':_0x58e926});}:function(_0x5dac1e,_0x385974){_0x5dac1e['default']=_0x385974;}),__decorate=this&&this[a124_0x952c1e(0x14d)]||function(_0x1077fb,_0x5d6f47,_0xc8aebd,_0x1fa6ba){const _0x5437c1=a124_0x952c1e;var _0x1a20f0=arguments[_0x5437c1(0x150)],_0x71657e=_0x1a20f0<0x3?_0x5d6f47:_0x1fa6ba===null?_0x1fa6ba=Object[_0x5437c1(0x12d)](_0x5d6f47,_0xc8aebd):_0x1fa6ba,_0x2ad566;if(typeof Reflect===_0x5437c1(0x123)&&typeof Reflect[_0x5437c1(0x15c)]===_0x5437c1(0x147))_0x71657e=Reflect[_0x5437c1(0x15c)](_0x1077fb,_0x5d6f47,_0xc8aebd,_0x1fa6ba);else{for(var _0x34a4fa=_0x1077fb[_0x5437c1(0x150)]-0x1;_0x34a4fa>=0x0;_0x34a4fa--)if(_0x2ad566=_0x1077fb[_0x34a4fa])_0x71657e=(_0x1a20f0<0x3?_0x2ad566(_0x71657e):_0x1a20f0>0x3?_0x2ad566(_0x5d6f47,_0xc8aebd,_0x71657e):_0x2ad566(_0x5d6f47,_0xc8aebd))||_0x71657e;}return _0x1a20f0>0x3&&_0x71657e&&Object[_0x5437c1(0x145)](_0x5d6f47,_0xc8aebd,_0x71657e),_0x71657e;},__importStar=this&&this[a124_0x952c1e(0x16a)]||function(_0x1b34ee){const _0x494325=a124_0x952c1e;if(_0x1b34ee&&_0x1b34ee[_0x494325(0x121)])return _0x1b34ee;var _0x266ea7={};if(_0x1b34ee!=null){for(var _0x5aba15 in _0x1b34ee)if(_0x5aba15!==_0x494325(0x100)&&Object['prototype']['hasOwnProperty'][_0x494325(0x116)](_0x1b34ee,_0x5aba15))__createBinding(_0x266ea7,_0x1b34ee,_0x5aba15);}return __setModuleDefault(_0x266ea7,_0x1b34ee),_0x266ea7;},__importDefault=this&&this[a124_0x952c1e(0x120)]||function(_0x96328e){const _0x1dda1a=a124_0x952c1e;return _0x96328e&&_0x96328e[_0x1dda1a(0x121)]?_0x96328e:{'default':_0x96328e};};Object[a124_0x952c1e(0x145)](exports,a124_0x952c1e(0x121),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require(a124_0x952c1e(0x111)),events_1=__importDefault(require(a124_0x952c1e(0x16b))),git_utils_1=require(a124_0x952c1e(0x172)),mdapi_utils_1=require(a124_0x952c1e(0x165)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a124_0x952c1e(0x101))),utils_1=require('../../../shared/utils'),constants_1=require(a124_0x952c1e(0x10e)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a124_0x952c1e(0x107)),path_1=require(a124_0x952c1e(0x151)),providers_tokens_1=require(a124_0x952c1e(0x155)),constants_2=require(a124_0x952c1e(0x10e));let CommitComponentsJob=class CommitComponentsJob extends events_1[a124_0x952c1e(0x100)]{constructor(){const _0x8b209e=a124_0x952c1e;super(...arguments),this[_0x8b209e(0x149)]=0x3e8,this['componentsToWrite']=0x0,this['componentsToDelete']=0x0,this[_0x8b209e(0x161)]=Date[_0x8b209e(0x136)]();}async['getRemote'](){const _0x29cf65=a124_0x952c1e,{repo:_0x4a02c}=this[_0x29cf65(0x152)],_0x21f2c5=typedi_1[_0x29cf65(0x100)]['get'](providers_tokens_1['Tokens'][_0x29cf65(0x129)]);if(this[_0x29cf65(0x152)][_0x29cf65(0x16f)]===git_provider_1['GitProvider'][_0x29cf65(0x170)]){const _0x1cb74f=typedi_1[_0x29cf65(0x100)][_0x29cf65(0x164)](bitbucket_api_service_1['BitbucketApiService']);await _0x1cb74f[_0x29cf65(0x144)]();}return _0x4a02c[_0x29cf65(0x13d)][_0x29cf65(0x117)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x4a02c[_0x29cf65(0x13d)])+'://'+_0x21f2c5[_0x29cf65(0x115)]()+'@');}[a124_0x952c1e(0x127)](_0x121042){const _0x31af86=a124_0x952c1e;var _0x1f4af4;_0x121042['sort'](_0x3e71c4=>child_types_1[_0x31af86(0x100)]['includes'](_0x3e71c4[_0x31af86(0x126)])?0x1:-0x1);const _0x3073b4={};for(const _0x45fd30 of _0x121042){_0x3073b4[_0x1f4af4=_0x45fd30[_0x31af86(0x15b)]]||(_0x3073b4[_0x1f4af4]=[]),_0x3073b4[_0x45fd30['fileName']]['push'](_0x45fd30);}return Object[_0x31af86(0x106)](_0x3073b4)[_0x31af86(0x14f)]((_0x11a62e,_0x4c7691)=>[..._0x11a62e,..._0x4c7691],[]);}async['writeComponents'](_0x2ff902){const _0x50d611=a124_0x952c1e;_0x2ff902=this[_0x50d611(0x127)](_0x2ff902);let _0x2f9d0e=0x0;while(_0x2ff902[_0x50d611(0x150)]){const _0x3829e2=_0x2ff902['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x50d611(0x13a)]['writeFlosumComponents'](_0x3829e2,{'skipChildErrors':this['commitData'][_0x50d611(0x168)][_0x50d611(0x10c)]===_0x50d611(0x124),'recordType':this[_0x50d611(0x152)][_0x50d611(0x108)]}),_0x2f9d0e+=_0x3829e2['length'],this[_0x50d611(0x163)][_0x50d611(0x146)](this[_0x50d611(0x174)]+_0x50d611(0x142)+_0x2f9d0e+'/'+this[_0x50d611(0x12c)]+_0x50d611(0x11b)),await this[_0x50d611(0x163)][_0x50d611(0x10d)]();}}async[a124_0x952c1e(0x156)](_0xe3540e){const _0x3c329a=a124_0x952c1e;_0xe3540e[_0x3c329a(0x14a)](_0x344520=>child_types_1[_0x3c329a(0x100)]['includes'](_0x344520[_0x3c329a(0x130)])?-0x1:0x1);let _0x425375=0x0;while(_0xe3540e[_0x3c329a(0x150)]){const _0x4d710b=_0xe3540e[_0x3c329a(0x135)](0x0,this[_0x3c329a(0x149)]);await this[_0x3c329a(0x13a)][_0x3c329a(0x156)](_0x4d710b,this[_0x3c329a(0x152)][_0x3c329a(0x108)]),_0x425375+=_0x4d710b[_0x3c329a(0x150)],this[_0x3c329a(0x163)][_0x3c329a(0x146)](this[_0x3c329a(0x174)]+_0x3c329a(0x143)+_0x425375+'/'+this['componentsToDelete']+_0x3c329a(0x11b)),await this[_0x3c329a(0x163)][_0x3c329a(0x10d)]();}}async[a124_0x952c1e(0x12f)](){const _0x3227ca=a124_0x952c1e;this['gitUtils']&&await this[_0x3227ca(0x166)][_0x3227ca(0x162)]()[_0x3227ca(0x16c)](()=>void 0x0),this[_0x3227ca(0x13a)]&&await this['mdapiUtils'][_0x3227ca(0x162)]()[_0x3227ca(0x16c)](()=>void 0x0),this[_0x3227ca(0x112)]&&await this[_0x3227ca(0x112)]['removeDir']()[_0x3227ca(0x16c)](()=>void 0x0);}async[a124_0x952c1e(0x11c)](){const _0x3be20d=a124_0x952c1e,{repo:_0x4bf297,branch:_0x4bb311,components:_0x38589e,convertToSFDX:_0x46bba5,message:_0x16544b,user:_0x33cac7}=this['commitData'];this[_0x3be20d(0x13a)]=new mdapi_utils_1[(_0x3be20d(0x13c))](),this['gitUtils']=new git_utils_1[(_0x3be20d(0x105))](await this['getRemote']()),this[_0x3be20d(0x112)]=new sfdx_utils_1[(_0x3be20d(0x10f))]();let _0x5058b3=_0x46bba5&&this['sfdxUtils'][_0x3be20d(0x137)](this['commitData'][_0x3be20d(0x108)]);try{await this[_0x3be20d(0x163)][_0x3be20d(0x146)](this['prefix']+_0x3be20d(0x103))['send'](),await this[_0x3be20d(0x166)][_0x3be20d(0x133)](_0x4bb311[_0x3be20d(0x10c)],_0x4bf297[_0x3be20d(0x10c)]);!this[_0x3be20d(0x152)][_0x3be20d(0x173)]?(this[_0x3be20d(0x163)][_0x3be20d(0x146)](this[_0x3be20d(0x174)]+'\x20Prepare\x20mdapi\x20files.'),await this[_0x3be20d(0x13a)][_0x3be20d(0x171)](this[_0x3be20d(0x166)][_0x3be20d(0x12b)])):this[_0x3be20d(0x163)][_0x3be20d(0x146)](this['prefix']+_0x3be20d(0x153));await this[_0x3be20d(0x163)][_0x3be20d(0x146)](this[_0x3be20d(0x174)]+_0x3be20d(0x15f))[_0x3be20d(0x10d)]();_0x38589e[_0x3be20d(0x13b)]&&(this[_0x3be20d(0x163)][_0x3be20d(0x146)](this[_0x3be20d(0x174)]+_0x3be20d(0x13e)),this[_0x3be20d(0x12c)]=_0x38589e['writed'][_0x3be20d(0x150)],await this[_0x3be20d(0x158)](_0x38589e[_0x3be20d(0x13b)]),await this[_0x3be20d(0x163)][_0x3be20d(0x10d)]());await this['sfLogger'][_0x3be20d(0x146)](this[_0x3be20d(0x174)]+_0x3be20d(0x148))[_0x3be20d(0x10d)]();_0x38589e['deleted']&&(this[_0x3be20d(0x163)][_0x3be20d(0x146)](this['prefix']+'\x20Preparing\x20to\x20delete\x20components'),this[_0x3be20d(0x16e)]=_0x38589e[_0x3be20d(0x11a)][_0x3be20d(0x150)],await this[_0x3be20d(0x156)](_0x38589e[_0x3be20d(0x11a)]),await this[_0x3be20d(0x163)][_0x3be20d(0x10d)]());await this['sfLogger']['send']();const _0x511737=await fs_internal_1['FS']['isEmptyDir'](this[_0x3be20d(0x166)]['dir']);await sfdx_utils_2[_0x3be20d(0x131)]['isSFDXProject'](this[_0x3be20d(0x166)][_0x3be20d(0x12b)])?(_0x5058b3=!![],await fs_internal_1['FS'][_0x3be20d(0x162)]((0x0,path_1['join'])(this['gitUtils'][_0x3be20d(0x12b)],_0x3be20d(0x14c)))):(_0x5058b3&&(!_0x511737&&(_0x5058b3=![])),await this['gitUtils'][_0x3be20d(0x14e)]());_0x5058b3?(await this[_0x3be20d(0x163)][_0x3be20d(0x146)](this[_0x3be20d(0x174)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x3be20d(0x10d)](),await this['sfdxUtils'][_0x3be20d(0x11f)](this[_0x3be20d(0x13a)][_0x3be20d(0x12b)]),await this[_0x3be20d(0x112)][_0x3be20d(0x102)](this[_0x3be20d(0x166)][_0x3be20d(0x12b)],!_0x511737),await this[_0x3be20d(0x112)][_0x3be20d(0x10b)](this['mdapiUtils']['dir'],(0x0,path_1[_0x3be20d(0x128)])(this[_0x3be20d(0x166)]['dir'],constants_2['FORCE_APP_DEFAULT_DIR'])),await this[_0x3be20d(0x112)][_0x3be20d(0x162)]()):(await this['sfLogger']['log'](this[_0x3be20d(0x174)]+_0x3be20d(0x114))[_0x3be20d(0x10d)](),await this[_0x3be20d(0x13a)][_0x3be20d(0x159)](this[_0x3be20d(0x166)]['dir']));await this[_0x3be20d(0x163)][_0x3be20d(0x146)](this[_0x3be20d(0x174)]+_0x3be20d(0x110))[_0x3be20d(0x10d)](),await this[_0x3be20d(0x166)][_0x3be20d(0x122)](_0x16544b,{'email':constants_1[_0x3be20d(0x132)],'name':_0x33cac7['name']},_0x4bb311[_0x3be20d(0x10c)]),await this[_0x3be20d(0x166)][_0x3be20d(0x162)](),await this['mdapiUtils'][_0x3be20d(0x162)]();const _0x48ed52=this['componentsToWrite']+this[_0x3be20d(0x16e)];await this[_0x3be20d(0x163)][_0x3be20d(0x146)](this[_0x3be20d(0x174)]+_0x3be20d(0x119)+(Date['now']()-this[_0x3be20d(0x161)])+'ms.\x20Committed\x20components\x20-\x20'+_0x48ed52+'.')[_0x3be20d(0x10d)]();}catch(_0x68c0d2){await this[_0x3be20d(0x12f)](),await this[_0x3be20d(0x163)][_0x3be20d(0x12e)](this['prefix']+'\x20'+_0x68c0d2)[_0x3be20d(0x10d)]();throw _0x68c0d2;}}async[a124_0x952c1e(0x138)](_0x160af7,_0x2dc37d){const _0x30d37e=a124_0x952c1e;var _0x4fd969,_0x4b810;this[_0x30d37e(0x163)]=typedi_1['default']['get'](providers_tokens_1[_0x30d37e(0x154)]['logger']),this['prefix']=(_0x2dc37d?_0x2dc37d+'\x20':'')+'['+commit_components_dto_1[_0x30d37e(0x125)][_0x30d37e(0x10c)]+']',await this[_0x30d37e(0x163)][_0x30d37e(0x146)](this[_0x30d37e(0x174)]+_0x30d37e(0x175));const _0x32b32b=!!((_0x4fd969=_0x160af7[_0x30d37e(0x113)])===null||_0x4fd969===void 0x0?void 0x0:_0x4fd969[_0x30d37e(0x13b)])||!!((_0x4b810=_0x160af7[_0x30d37e(0x113)])===null||_0x4b810===void 0x0?void 0x0:_0x4b810['deleted']);if(!_0x32b32b){await this[_0x30d37e(0x163)][_0x30d37e(0x146)](this[_0x30d37e(0x174)]+'\x20Nothing\x20to\x20commit.\x20Skip.')['send']();return;}this[_0x30d37e(0x152)]=_0x160af7,await this[_0x30d37e(0x11c)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a124_0x952c1e(0x140)]=CommitComponentsJob;