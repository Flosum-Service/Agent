const a104_0x5dbfa8=a104_0x50aa;(function(_0x3ef93d,_0x268664){const _0x40da65=a104_0x50aa,_0x101017=_0x3ef93d();while(!![]){try{const _0x5f012d=parseInt(_0x40da65(0xc6))/0x1+-parseInt(_0x40da65(0xfb))/0x2*(parseInt(_0x40da65(0xc9))/0x3)+parseInt(_0x40da65(0xb3))/0x4+parseInt(_0x40da65(0x104))/0x5*(-parseInt(_0x40da65(0xbd))/0x6)+-parseInt(_0x40da65(0x11f))/0x7*(parseInt(_0x40da65(0x113))/0x8)+parseInt(_0x40da65(0xe3))/0x9+parseInt(_0x40da65(0x11d))/0xa*(parseInt(_0x40da65(0xdc))/0xb);if(_0x5f012d===_0x268664)break;else _0x101017['push'](_0x101017['shift']());}catch(_0x3e7cf8){_0x101017['push'](_0x101017['shift']());}}}(a104_0x4182,0xd60d0));const a104_0x2ed4f6=(function(){let _0x3baec3=!![];return function(_0x19efbf,_0x5c4ed3){const _0x45f724=_0x3baec3?function(){if(_0x5c4ed3){const _0x371186=_0x5c4ed3['apply'](_0x19efbf,arguments);return _0x5c4ed3=null,_0x371186;}}:function(){};return _0x3baec3=![],_0x45f724;};}()),a104_0x570908=a104_0x2ed4f6(this,function(){const _0x5acead=a104_0x50aa;return a104_0x570908[_0x5acead(0xcf)]()[_0x5acead(0x111)](_0x5acead(0xaf))['toString']()[_0x5acead(0xb9)](a104_0x570908)[_0x5acead(0x111)]('(((.+)+)+)+$');});a104_0x570908();function a104_0x50aa(_0x4310b0,_0x2604f1){const _0x238fb1=a104_0x4182();return a104_0x50aa=function(_0x570908,_0x2ed4f6){_0x570908=_0x570908-0xaf;let _0x4182c1=_0x238fb1[_0x570908];return _0x4182c1;},a104_0x50aa(_0x4310b0,_0x2604f1);}'use strict';var __createBinding=this&&this[a104_0x5dbfa8(0xca)]||(Object[a104_0x5dbfa8(0xe2)]?function(_0x41ed09,_0x4346c8,_0x189760,_0x1a50f7){const _0x1db703=a104_0x5dbfa8;if(_0x1a50f7===undefined)_0x1a50f7=_0x189760;var _0x39c0d5=Object['getOwnPropertyDescriptor'](_0x4346c8,_0x189760);(!_0x39c0d5||('get'in _0x39c0d5?!_0x4346c8[_0x1db703(0xf8)]:_0x39c0d5[_0x1db703(0x108)]||_0x39c0d5[_0x1db703(0xb5)]))&&(_0x39c0d5={'enumerable':!![],'get':function(){return _0x4346c8[_0x189760];}}),Object[_0x1db703(0x114)](_0x41ed09,_0x1a50f7,_0x39c0d5);}:function(_0xd0e8c8,_0x2e2841,_0x553ec5,_0x94d1f2){if(_0x94d1f2===undefined)_0x94d1f2=_0x553ec5;_0xd0e8c8[_0x94d1f2]=_0x2e2841[_0x553ec5];}),__setModuleDefault=this&&this[a104_0x5dbfa8(0xdf)]||(Object[a104_0x5dbfa8(0xe2)]?function(_0x2cc8c6,_0xa4642e){const _0x5311fe=a104_0x5dbfa8;Object['defineProperty'](_0x2cc8c6,_0x5311fe(0x10a),{'enumerable':!![],'value':_0xa4642e});}:function(_0xf17444,_0x14143b){const _0x5887cc=a104_0x5dbfa8;_0xf17444[_0x5887cc(0x10a)]=_0x14143b;}),__decorate=this&&this['__decorate']||function(_0x55ac95,_0x2b53b1,_0x574a43,_0x39e246){const _0x1b7638=a104_0x5dbfa8;var _0x509b8b=arguments[_0x1b7638(0xfa)],_0x5ad45b=_0x509b8b<0x3?_0x2b53b1:_0x39e246===null?_0x39e246=Object['getOwnPropertyDescriptor'](_0x2b53b1,_0x574a43):_0x39e246,_0x55ba1d;if(typeof Reflect===_0x1b7638(0x10b)&&typeof Reflect[_0x1b7638(0xd7)]===_0x1b7638(0x11b))_0x5ad45b=Reflect[_0x1b7638(0xd7)](_0x55ac95,_0x2b53b1,_0x574a43,_0x39e246);else{for(var _0x54dcf8=_0x55ac95[_0x1b7638(0xfa)]-0x1;_0x54dcf8>=0x0;_0x54dcf8--)if(_0x55ba1d=_0x55ac95[_0x54dcf8])_0x5ad45b=(_0x509b8b<0x3?_0x55ba1d(_0x5ad45b):_0x509b8b>0x3?_0x55ba1d(_0x2b53b1,_0x574a43,_0x5ad45b):_0x55ba1d(_0x2b53b1,_0x574a43))||_0x5ad45b;}return _0x509b8b>0x3&&_0x5ad45b&&Object[_0x1b7638(0x114)](_0x2b53b1,_0x574a43,_0x5ad45b),_0x5ad45b;},__importStar=this&&this[a104_0x5dbfa8(0xd9)]||function(_0x1d7056){const _0x5de538=a104_0x5dbfa8;if(_0x1d7056&&_0x1d7056['__esModule'])return _0x1d7056;var _0x5edaf4={};if(_0x1d7056!=null){for(var _0x216a64 in _0x1d7056)if(_0x216a64!==_0x5de538(0x10a)&&Object[_0x5de538(0xed)][_0x5de538(0xe7)][_0x5de538(0xc4)](_0x1d7056,_0x216a64))__createBinding(_0x5edaf4,_0x1d7056,_0x216a64);}return __setModuleDefault(_0x5edaf4,_0x1d7056),_0x5edaf4;},__importDefault=this&&this['__importDefault']||function(_0x19954b){const _0x36962d=a104_0x5dbfa8;return _0x19954b&&_0x19954b[_0x36962d(0xf8)]?_0x19954b:{'default':_0x19954b};};Object[a104_0x5dbfa8(0x114)](exports,a104_0x5dbfa8(0xf8),{'value':!![]}),exports[a104_0x5dbfa8(0x10c)]=void 0x0;const commit_components_dto_1=require(a104_0x5dbfa8(0xdd)),events_1=__importDefault(require('events')),git_utils_1=require(a104_0x5dbfa8(0xd3)),mdapi_utils_1=require(a104_0x5dbfa8(0x11e)),sfdx_utils_1=require(a104_0x5dbfa8(0xbf)),typedi_1=__importStar(require(a104_0x5dbfa8(0xb4))),child_types_1=__importDefault(require(a104_0x5dbfa8(0xda))),utils_1=require('../../../shared/utils'),constants_1=require('../../../../constants'),git_provider_1=require(a104_0x5dbfa8(0xb2)),bitbucket_api_service_1=require(a104_0x5dbfa8(0xfe)),sfdx_utils_2=require(a104_0x5dbfa8(0xdb)),fs_internal_1=require(a104_0x5dbfa8(0x11c)),path_1=require('path'),providers_tokens_1=require(a104_0x5dbfa8(0xd2));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x5dbfa8(0x10a)]{constructor(){const _0x4cbe82=a104_0x5dbfa8;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x4cbe82(0xff)]=0x0,this['componentsToDelete']=0x0,this[_0x4cbe82(0xf4)]=Date[_0x4cbe82(0xbb)]();}async['getRemote'](){const _0x2c80c6=a104_0x5dbfa8,{repo:_0x52f331}=this['commitData'],_0x2293dd=typedi_1['default'][_0x2c80c6(0x110)](providers_tokens_1[_0x2c80c6(0x10f)][_0x2c80c6(0xbe)]);if(this[_0x2c80c6(0xcd)][_0x2c80c6(0xf3)]===git_provider_1['GitProvider'][_0x2c80c6(0xce)]){const _0x546d74=typedi_1['default']['get'](bitbucket_api_service_1['BitbucketApiService']);await _0x546d74[_0x2c80c6(0x117)]();}return _0x52f331['gitUrl'][_0x2c80c6(0xeb)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x2c80c6(0xf7)])(_0x52f331[_0x2c80c6(0xea)])+_0x2c80c6(0x109)+_0x2293dd[_0x2c80c6(0xd1)]()+'@');}['groupComponentsByFileName'](_0x295f45){const _0x5aca6c=a104_0x5dbfa8;var _0x3aefeb;_0x295f45[_0x5aca6c(0x10e)](_0x26e69d=>child_types_1[_0x5aca6c(0x10a)]['includes'](_0x26e69d['fileType'])?0x1:-0x1);const _0x24ad2b={};for(const _0x2e63cc of _0x295f45){_0x24ad2b[_0x3aefeb=_0x2e63cc[_0x5aca6c(0x103)]]||(_0x24ad2b[_0x3aefeb]=[]),_0x24ad2b[_0x2e63cc[_0x5aca6c(0x103)]][_0x5aca6c(0xc5)](_0x2e63cc);}return Object[_0x5aca6c(0x10d)](_0x24ad2b)['reduce']((_0x14023f,_0x317298)=>[..._0x14023f,..._0x317298],[]);}async[a104_0x5dbfa8(0x102)](_0xf7db76){const _0x38f7e2=a104_0x5dbfa8;_0xf7db76=this[_0x38f7e2(0xb6)](_0xf7db76);let _0x3aa249=0x0;while(_0xf7db76[_0x38f7e2(0xfa)]){const _0x8885d9=_0xf7db76[_0x38f7e2(0xde)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils'][_0x38f7e2(0xd8)](_0x8885d9,{'skipChildErrors':this[_0x38f7e2(0xcd)][_0x38f7e2(0xe0)][_0x38f7e2(0xbc)]==='master'}),_0x3aa249+=_0x8885d9[_0x38f7e2(0xfa)],this[_0x38f7e2(0xe5)][_0x38f7e2(0xe1)](this[_0x38f7e2(0x116)]+'\x20Wrote\x20'+_0x3aa249+'/'+this[_0x38f7e2(0xff)]+'\x20components'),await this[_0x38f7e2(0xe5)][_0x38f7e2(0x105)]();}}async[a104_0x5dbfa8(0x100)](_0x4db41d){const _0x3860c3=a104_0x5dbfa8;_0x4db41d[_0x3860c3(0x10e)](_0x4d8f7b=>child_types_1[_0x3860c3(0x10a)]['includes'](_0x4d8f7b[_0x3860c3(0xc2)])?-0x1:0x1);let _0x41ddff=0x0;while(_0x4db41d[_0x3860c3(0xfa)]){const _0x4617d0=_0x4db41d['splice'](0x0,this[_0x3860c3(0xf2)]);await this['mdapiUtils'][_0x3860c3(0x100)](_0x4617d0),_0x41ddff+=_0x4617d0['length'],this[_0x3860c3(0xe5)][_0x3860c3(0xe1)](this['prefix']+_0x3860c3(0xec)+_0x41ddff+'/'+this[_0x3860c3(0xf1)]+_0x3860c3(0xc3)),await this[_0x3860c3(0xe5)][_0x3860c3(0x105)]();}}async[a104_0x5dbfa8(0x119)](){const _0x38b7b9=a104_0x5dbfa8;this[_0x38b7b9(0xcc)]&&await this['gitUtils'][_0x38b7b9(0xba)]()['catch'](()=>void 0x0),this[_0x38b7b9(0x106)]&&await this[_0x38b7b9(0x106)]['removeDir']()['catch'](()=>void 0x0),this[_0x38b7b9(0xc8)]&&await this[_0x38b7b9(0xc8)][_0x38b7b9(0xba)]()[_0x38b7b9(0xd5)](()=>void 0x0);}async['exec'](){const _0x1b818d=a104_0x5dbfa8,{repo:_0x13fca5,branch:_0x21c429,components:_0x4246f7,convertToSFDX:_0x51935f,message:_0x26c3d3,user:_0x4a8d16}=this['commitData'];this[_0x1b818d(0x106)]=new mdapi_utils_1[(_0x1b818d(0xb8))](),this['gitUtils']=new git_utils_1[(_0x1b818d(0xf9))](await this[_0x1b818d(0xef)]()),this[_0x1b818d(0xc8)]=new sfdx_utils_1['SFDXUtils']();let _0x51c707=_0x51935f;try{await this['sfLogger'][_0x1b818d(0xe1)](this[_0x1b818d(0x116)]+_0x1b818d(0xfd))[_0x1b818d(0x105)](),await this[_0x1b818d(0xcc)]['clone'](_0x21c429[_0x1b818d(0xbc)],_0x13fca5['name']);!this[_0x1b818d(0xcd)][_0x1b818d(0xcb)]?(this['sfLogger']['log'](this[_0x1b818d(0x116)]+_0x1b818d(0xe6)),await this[_0x1b818d(0x106)][_0x1b818d(0x112)](this[_0x1b818d(0xcc)][_0x1b818d(0xe8)])):this[_0x1b818d(0xe5)]['log'](this[_0x1b818d(0x116)]+_0x1b818d(0xb7));await this[_0x1b818d(0xe5)]['log'](this[_0x1b818d(0x116)]+_0x1b818d(0x118))[_0x1b818d(0x105)]();_0x4246f7[_0x1b818d(0x101)]&&(this[_0x1b818d(0xe5)]['log'](this['prefix']+_0x1b818d(0xee)),this[_0x1b818d(0xff)]=_0x4246f7[_0x1b818d(0x101)][_0x1b818d(0xfa)],await this[_0x1b818d(0x102)](_0x4246f7[_0x1b818d(0x101)]),await this[_0x1b818d(0xe5)][_0x1b818d(0x105)]());await this[_0x1b818d(0xe5)]['log'](this[_0x1b818d(0x116)]+_0x1b818d(0xf0))['send']();_0x4246f7[_0x1b818d(0xd0)]&&(this[_0x1b818d(0xe5)][_0x1b818d(0xe1)](this['prefix']+_0x1b818d(0xd4)),this[_0x1b818d(0xf1)]=_0x4246f7['deleted'][_0x1b818d(0xfa)],await this[_0x1b818d(0x100)](_0x4246f7[_0x1b818d(0xd0)]),await this['sfLogger'][_0x1b818d(0x105)]());await this[_0x1b818d(0xe5)][_0x1b818d(0x105)]();const _0x15e08a=await fs_internal_1['FS'][_0x1b818d(0xf5)](this[_0x1b818d(0xcc)][_0x1b818d(0xe8)]);await sfdx_utils_2[_0x1b818d(0x115)]['isSFDXProject'](this[_0x1b818d(0xcc)][_0x1b818d(0xe8)])?(_0x51c707=!![],await fs_internal_1['FS'][_0x1b818d(0xba)]((0x0,path_1['join'])(this['gitUtils'][_0x1b818d(0xe8)],'force-app'))):(_0x51c707&&(!_0x15e08a&&(_0x51c707=![])),await this[_0x1b818d(0xcc)]['clearDir']());_0x51c707?(await this['sfLogger']['log'](this['prefix']+'\x20Start\x20converting\x20to\x20SFDX.')['send'](),await this[_0x1b818d(0xc8)][_0x1b818d(0xc0)](this['mdapiUtils'][_0x1b818d(0xe8)]),await this[_0x1b818d(0xc8)][_0x1b818d(0xf6)](this[_0x1b818d(0xcc)][_0x1b818d(0xe8)],!_0x15e08a),await this['sfdxUtils'][_0x1b818d(0xba)]()):(await this[_0x1b818d(0xe5)][_0x1b818d(0xe1)](this['prefix']+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')['send'](),await this[_0x1b818d(0x106)][_0x1b818d(0xb1)](this[_0x1b818d(0xcc)][_0x1b818d(0xe8)]));await this[_0x1b818d(0xe5)][_0x1b818d(0xe1)](this[_0x1b818d(0x116)]+_0x1b818d(0xb0))[_0x1b818d(0x105)](),await this[_0x1b818d(0xcc)][_0x1b818d(0xe4)](_0x26c3d3,{'email':constants_1[_0x1b818d(0xe9)],'name':_0x4a8d16[_0x1b818d(0xbc)]},_0x21c429[_0x1b818d(0xbc)]),await this[_0x1b818d(0xcc)][_0x1b818d(0xba)](),await this[_0x1b818d(0x106)]['removeDir']();const _0x55429e=this['componentsToWrite']+this['componentsToDelete'];await this['sfLogger'][_0x1b818d(0xe1)](this[_0x1b818d(0x116)]+_0x1b818d(0xc1)+(Date[_0x1b818d(0xbb)]()-this[_0x1b818d(0xf4)])+_0x1b818d(0xd6)+_0x55429e+'.')[_0x1b818d(0x105)]();}catch(_0x1c2659){await this['cleanUp'](),await this[_0x1b818d(0xe5)][_0x1b818d(0x107)](this['prefix']+'\x20'+_0x1c2659)[_0x1b818d(0x105)]();throw _0x1c2659;}}async['run'](_0xedab9b,_0x30f88c){const _0x478da4=a104_0x5dbfa8;var _0x5af408,_0x7b7440;this[_0x478da4(0xe5)]=typedi_1[_0x478da4(0x10a)]['get'](providers_tokens_1[_0x478da4(0x10f)]['logger']),this[_0x478da4(0x116)]=(_0x30f88c?_0x30f88c+'\x20':'')+'['+commit_components_dto_1[_0x478da4(0x11a)][_0x478da4(0xbc)]+']',await this['sfLogger'][_0x478da4(0xe1)](this[_0x478da4(0x116)]+'\x20Checking\x20commit\x20components.');const _0x7247bd=!!((_0x5af408=_0xedab9b[_0x478da4(0xc7)])===null||_0x5af408===void 0x0?void 0x0:_0x5af408[_0x478da4(0x101)])||!!((_0x7b7440=_0xedab9b[_0x478da4(0xc7)])===null||_0x7b7440===void 0x0?void 0x0:_0x7b7440[_0x478da4(0xd0)]);if(!_0x7247bd){await this[_0x478da4(0xe5)][_0x478da4(0xe1)](this[_0x478da4(0x116)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x478da4(0x105)]();return;}this['commitData']=_0xedab9b,await this['exec']();}};function a104_0x4182(){const _0x2f8b0b=['fileName','2586815breapB','send','mdapiUtils','error','writable','://','default','object','CommitComponentsJob','values','sort','Tokens','get','search','prepareMdapi','148664ipGMvS','defineProperty','SFDX','prefix','isLoggedIn','\x20Checking\x20written\x20components.','cleanUp','CommitComponentsDto','function','../../internal/fs.internal','3070rIKqMg','../utils/mdapi.utils','133HVRMlK','(((.+)+)+)+$','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','copyMdapiTo','../../providers/types/git-provider','3298876xCMDwU','typedi','configurable','groupComponentsByFileName','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','MDApiUtils','constructor','removeDir','now','name','18PfKHba','credentials','../utils/sfdx.utils','createProjectFrom','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','type','\x20components','call','push','1230114lkxpnv','components','sfdxUtils','213TprfHr','__createBinding','force','gitUtils','commitData','Bitbucket','toString','deleted','getGitShellAuthorizationString','../../providers/providers.tokens','../utils/git.utils','\x20Preparing\x20to\x20delete\x20components','catch','ms.\x20Committed\x20components\x20-\x20','decorate','writeFlosumComponents','__importStar','../../parsers/data/child-types','../../salesforce/utils/sfdx.utils','8767JZVsVM','../dto/commit-components.dto','splice','__setModuleDefault','branch','log','create','9113067raiMQa','commitAndPush','sfLogger','\x20Prepare\x20mdapi\x20files.','hasOwnProperty','dir','DEFAULT_GIT_USER_EMAIL','gitUrl','replace','\x20Deleted\x20','prototype','\x20Preparing\x20to\x20write\x20components','getRemote','\x20Checking\x20deleted\x20components.','componentsToDelete','COMPONENTS_PER_TICK','provider','startTime','isEmptyDir','copyProjectTo','getProtocol','__esModule','GitUtils','length','14934kBaxDT','Service','\x20Start\x20cloning\x20repository.','../../providers/api/bitbucket-api.service','componentsToWrite','removeComponents','writed','writeComponents'];a104_0x4182=function(){return _0x2f8b0b;};return a104_0x4182();}CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x5dbfa8(0xfc)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x5dbfa8(0x10c)]=CommitComponentsJob;