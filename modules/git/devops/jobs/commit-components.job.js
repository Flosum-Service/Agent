const a104_0xe5f0cc=a104_0x2b67;(function(_0x907968,_0x41a369){const _0x30a6c1=a104_0x2b67,_0x1b45c8=_0x907968();while(!![]){try{const _0x13f8ed=-parseInt(_0x30a6c1(0x13d))/0x1*(-parseInt(_0x30a6c1(0x14b))/0x2)+parseInt(_0x30a6c1(0x11d))/0x3*(-parseInt(_0x30a6c1(0x156))/0x4)+-parseInt(_0x30a6c1(0x101))/0x5+-parseInt(_0x30a6c1(0xfd))/0x6*(parseInt(_0x30a6c1(0xea))/0x7)+parseInt(_0x30a6c1(0xf6))/0x8*(-parseInt(_0x30a6c1(0x109))/0x9)+-parseInt(_0x30a6c1(0x11c))/0xa*(-parseInt(_0x30a6c1(0x12c))/0xb)+-parseInt(_0x30a6c1(0x13c))/0xc*(-parseInt(_0x30a6c1(0x111))/0xd);if(_0x13f8ed===_0x41a369)break;else _0x1b45c8['push'](_0x1b45c8['shift']());}catch(_0x4dc436){_0x1b45c8['push'](_0x1b45c8['shift']());}}}(a104_0x85b1,0x3ca48));function a104_0x2b67(_0x2c333c,_0x40d221){const _0x32c485=a104_0x85b1();return a104_0x2b67=function(_0x2ad493,_0xbb7cc6){_0x2ad493=_0x2ad493-0xe5;let _0x85b15a=_0x32c485[_0x2ad493];return _0x85b15a;},a104_0x2b67(_0x2c333c,_0x40d221);}const a104_0xbb7cc6=(function(){let _0xb11788=!![];return function(_0x1ca467,_0x3a824d){const _0x2dd456=_0xb11788?function(){const _0x1e4934=a104_0x2b67;if(_0x3a824d){const _0x2dedaa=_0x3a824d[_0x1e4934(0xeb)](_0x1ca467,arguments);return _0x3a824d=null,_0x2dedaa;}}:function(){};return _0xb11788=![],_0x2dd456;};}()),a104_0x2ad493=a104_0xbb7cc6(this,function(){const _0x40bc5f=a104_0x2b67;return a104_0x2ad493['toString']()[_0x40bc5f(0x11e)](_0x40bc5f(0xf7))['toString']()['constructor'](a104_0x2ad493)[_0x40bc5f(0x11e)](_0x40bc5f(0xf7));});a104_0x2ad493();function a104_0x85b1(){const _0xb166cd=['logger','__importDefault','sfLogger','name','configurable','18KiQzSd','\x20Deleted\x20','componentsToDelete','ms.\x20Committed\x20components\x20-\x20','169970HoGSdB','hasOwnProperty','function','CommitComponentsDto','__setModuleDefault','fileType','splice','\x20Checking\x20written\x20components.','119952zvDDft','length','get','decorate','CommitComponentsJob','commitAndPush','\x20Wrote\x20','run','13325HpPTOr','force','mdapiUtils','values','SFDXUtils','error','master','componentsToWrite','defineProperty','://','copyProjectTo','20JoExTP','48VLLKQS','search','\x20Preparing\x20to\x20delete\x20components','startTime','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','gitUtils','../../../../constants','__createBinding','../../providers/types/git-provider','path','getRemote','replace','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','send','deleted','2695781ZZDaHE','object','../../../shared/utils','\x20Start\x20cloning\x20repository.','copyVlocityComponents','dir','\x20Checking\x20commit\x20components.','FORCE_APP_DEFAULT_DIR','clone','typedi','Bitbucket','commitData','prototype','__importStar','sfdxUtils','__esModule','2724coDJyu','7IUdIDj','credentials','isEmptyDir','includes','../utils/sfdx.utils','groupComponentsByFileName','create','writable','\x20Prepare\x20mdapi\x20files.','components','writed','join','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','events','6884LiuAbZ','GitProvider','clearDir','\x20Nothing\x20to\x20commit.\x20Skip.','fileName','../../providers/api/bitbucket-api.service','cleanUp','MDApiUtils','reduce','copyMdapiTo','\x20Start\x20converting\x20to\x20SFDX.','10544LJlmKO','sort','exec','Service','\x20Copying\x20mdapi\x20to\x20git\x20folder.','\x20Checking\x20deleted\x20components.','../utils/git.utils','\x20components','\x20Preparing\x20to\x20write\x20components','../../providers/providers.tokens','removeDir','branch','52521mpZoVn','apply','catch','removeComponents','call','gitUrl','../utils/mdapi.utils','default','log','prefix','writeComponents','Tokens','240rbWQeI','(((.+)+)+)+$'];a104_0x85b1=function(){return _0xb166cd;};return a104_0x85b1();}'use strict';var __createBinding=this&&this[a104_0xe5f0cc(0x124)]||(Object[a104_0xe5f0cc(0x143)]?function(_0x3a2a38,_0x34d35f,_0x3de51a,_0x2fbbb3){const _0x2913aa=a104_0xe5f0cc;if(_0x2fbbb3===undefined)_0x2fbbb3=_0x3de51a;var _0x52c62b=Object['getOwnPropertyDescriptor'](_0x34d35f,_0x3de51a);(!_0x52c62b||(_0x2913aa(0x10b)in _0x52c62b?!_0x34d35f[_0x2913aa(0x13b)]:_0x52c62b[_0x2913aa(0x144)]||_0x52c62b[_0x2913aa(0xfc)]))&&(_0x52c62b={'enumerable':!![],'get':function(){return _0x34d35f[_0x3de51a];}}),Object[_0x2913aa(0x119)](_0x3a2a38,_0x2fbbb3,_0x52c62b);}:function(_0x3482b8,_0x5a99ac,_0x4a7850,_0x46bebe){if(_0x46bebe===undefined)_0x46bebe=_0x4a7850;_0x3482b8[_0x46bebe]=_0x5a99ac[_0x4a7850];}),__setModuleDefault=this&&this[a104_0xe5f0cc(0x105)]||(Object[a104_0xe5f0cc(0x143)]?function(_0x4a2cd3,_0x2ec545){const _0x4ed309=a104_0xe5f0cc;Object[_0x4ed309(0x119)](_0x4a2cd3,_0x4ed309(0xf1),{'enumerable':!![],'value':_0x2ec545});}:function(_0x10834b,_0x4865f5){const _0x4d5524=a104_0xe5f0cc;_0x10834b[_0x4d5524(0xf1)]=_0x4865f5;}),__decorate=this&&this['__decorate']||function(_0x4521b3,_0x2eb659,_0x312c34,_0x4fc5e6){const _0x1e1087=a104_0xe5f0cc;var _0x358fc6=arguments[_0x1e1087(0x10a)],_0x3ae099=_0x358fc6<0x3?_0x2eb659:_0x4fc5e6===null?_0x4fc5e6=Object['getOwnPropertyDescriptor'](_0x2eb659,_0x312c34):_0x4fc5e6,_0x2f8d27;if(typeof Reflect===_0x1e1087(0x12d)&&typeof Reflect['decorate']===_0x1e1087(0x103))_0x3ae099=Reflect[_0x1e1087(0x10c)](_0x4521b3,_0x2eb659,_0x312c34,_0x4fc5e6);else{for(var _0x20e058=_0x4521b3[_0x1e1087(0x10a)]-0x1;_0x20e058>=0x0;_0x20e058--)if(_0x2f8d27=_0x4521b3[_0x20e058])_0x3ae099=(_0x358fc6<0x3?_0x2f8d27(_0x3ae099):_0x358fc6>0x3?_0x2f8d27(_0x2eb659,_0x312c34,_0x3ae099):_0x2f8d27(_0x2eb659,_0x312c34))||_0x3ae099;}return _0x358fc6>0x3&&_0x3ae099&&Object[_0x1e1087(0x119)](_0x2eb659,_0x312c34,_0x3ae099),_0x3ae099;},__importStar=this&&this[a104_0xe5f0cc(0x139)]||function(_0x5e74b3){const _0x1caefb=a104_0xe5f0cc;if(_0x5e74b3&&_0x5e74b3[_0x1caefb(0x13b)])return _0x5e74b3;var _0x38c38f={};if(_0x5e74b3!=null){for(var _0x5f3eab in _0x5e74b3)if(_0x5f3eab!==_0x1caefb(0xf1)&&Object[_0x1caefb(0x138)][_0x1caefb(0x102)][_0x1caefb(0xee)](_0x5e74b3,_0x5f3eab))__createBinding(_0x38c38f,_0x5e74b3,_0x5f3eab);}return __setModuleDefault(_0x38c38f,_0x5e74b3),_0x38c38f;},__importDefault=this&&this[a104_0xe5f0cc(0xf9)]||function(_0x1b32e3){const _0x1a059e=a104_0xe5f0cc;return _0x1b32e3&&_0x1b32e3[_0x1a059e(0x13b)]?_0x1b32e3:{'default':_0x1b32e3};};Object['defineProperty'](exports,a104_0xe5f0cc(0x13b),{'value':!![]}),exports[a104_0xe5f0cc(0x10d)]=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require(a104_0xe5f0cc(0x14a))),git_utils_1=require(a104_0xe5f0cc(0x15c)),mdapi_utils_1=require(a104_0xe5f0cc(0xf0)),sfdx_utils_1=require(a104_0xe5f0cc(0x141)),typedi_1=__importStar(require(a104_0xe5f0cc(0x135))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a104_0xe5f0cc(0x12e)),constants_1=require('../../../../constants'),git_provider_1=require(a104_0xe5f0cc(0x125)),bitbucket_api_service_1=require(a104_0xe5f0cc(0x150)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a104_0xe5f0cc(0x126)),providers_tokens_1=require(a104_0xe5f0cc(0xe7)),constants_2=require(a104_0xe5f0cc(0x123));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0xe5f0cc(0xf1)]{constructor(){const _0x43daf3=a104_0xe5f0cc;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x43daf3(0x118)]=0x0,this[_0x43daf3(0xff)]=0x0,this[_0x43daf3(0x120)]=Date['now']();}async[a104_0xe5f0cc(0x127)](){const _0x5ab9c8=a104_0xe5f0cc,{repo:_0x3ae9c2}=this[_0x5ab9c8(0x137)],_0x5af794=typedi_1[_0x5ab9c8(0xf1)][_0x5ab9c8(0x10b)](providers_tokens_1['Tokens'][_0x5ab9c8(0x13e)]);if(this[_0x5ab9c8(0x137)]['provider']===git_provider_1[_0x5ab9c8(0x14c)][_0x5ab9c8(0x136)]){const _0x5ef297=typedi_1[_0x5ab9c8(0xf1)]['get'](bitbucket_api_service_1['BitbucketApiService']);await _0x5ef297['isLoggedIn']();}return _0x3ae9c2[_0x5ab9c8(0xef)][_0x5ab9c8(0x128)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x3ae9c2[_0x5ab9c8(0xef)])+_0x5ab9c8(0x11a)+_0x5af794['getGitShellAuthorizationString']()+'@');}[a104_0xe5f0cc(0x142)](_0x344466){const _0x5aaf9b=a104_0xe5f0cc;var _0x48d862;_0x344466[_0x5aaf9b(0x157)](_0x50b186=>child_types_1[_0x5aaf9b(0xf1)][_0x5aaf9b(0x140)](_0x50b186[_0x5aaf9b(0x106)])?0x1:-0x1);const _0x4acbe4={};for(const _0x145e76 of _0x344466){_0x4acbe4[_0x48d862=_0x145e76[_0x5aaf9b(0x14f)]]||(_0x4acbe4[_0x48d862]=[]),_0x4acbe4[_0x145e76[_0x5aaf9b(0x14f)]]['push'](_0x145e76);}return Object[_0x5aaf9b(0x114)](_0x4acbe4)[_0x5aaf9b(0x153)]((_0x47a651,_0x4da36c)=>[..._0x47a651,..._0x4da36c],[]);}async[a104_0xe5f0cc(0xf4)](_0x2c44c2){const _0x52396c=a104_0xe5f0cc;_0x2c44c2=this[_0x52396c(0x142)](_0x2c44c2);let _0x456f1e=0x0;while(_0x2c44c2[_0x52396c(0x10a)]){const _0x387d5f=_0x2c44c2[_0x52396c(0x107)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x52396c(0x113)]['writeFlosumComponents'](_0x387d5f,{'skipChildErrors':this['commitData'][_0x52396c(0xe9)][_0x52396c(0xfb)]===_0x52396c(0x117)}),_0x456f1e+=_0x387d5f['length'],this[_0x52396c(0xfa)][_0x52396c(0xf2)](this['prefix']+_0x52396c(0x10f)+_0x456f1e+'/'+this[_0x52396c(0x118)]+_0x52396c(0xe5)),await this[_0x52396c(0xfa)][_0x52396c(0x12a)]();}}async[a104_0xe5f0cc(0xed)](_0x4f1290){const _0x250da6=a104_0xe5f0cc;_0x4f1290[_0x250da6(0x157)](_0xd6f724=>child_types_1[_0x250da6(0xf1)][_0x250da6(0x140)](_0xd6f724['type'])?-0x1:0x1);let _0x19a467=0x0;while(_0x4f1290[_0x250da6(0x10a)]){const _0x2334dc=_0x4f1290[_0x250da6(0x107)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x250da6(0x113)]['removeComponents'](_0x2334dc),_0x19a467+=_0x2334dc[_0x250da6(0x10a)],this[_0x250da6(0xfa)][_0x250da6(0xf2)](this[_0x250da6(0xf3)]+_0x250da6(0xfe)+_0x19a467+'/'+this[_0x250da6(0xff)]+_0x250da6(0xe5)),await this[_0x250da6(0xfa)][_0x250da6(0x12a)]();}}async[a104_0xe5f0cc(0x151)](){const _0x1303f6=a104_0xe5f0cc;this[_0x1303f6(0x122)]&&await this[_0x1303f6(0x122)][_0x1303f6(0xe8)]()[_0x1303f6(0xec)](()=>void 0x0),this[_0x1303f6(0x113)]&&await this[_0x1303f6(0x113)][_0x1303f6(0xe8)]()[_0x1303f6(0xec)](()=>void 0x0),this['sfdxUtils']&&await this['sfdxUtils'][_0x1303f6(0xe8)]()['catch'](()=>void 0x0);}async[a104_0xe5f0cc(0x158)](){const _0x4da998=a104_0xe5f0cc,{repo:_0x85c1c5,branch:_0x406e1a,components:_0x55c2a4,convertToSFDX:_0x81d82b,message:_0x3a0bdb,user:_0x2e96de}=this[_0x4da998(0x137)];this['mdapiUtils']=new mdapi_utils_1[(_0x4da998(0x152))](),this[_0x4da998(0x122)]=new git_utils_1['GitUtils'](await this[_0x4da998(0x127)]()),this[_0x4da998(0x13a)]=new sfdx_utils_1[(_0x4da998(0x115))]();let _0x1bef1b=_0x81d82b;try{await this[_0x4da998(0xfa)][_0x4da998(0xf2)](this['prefix']+_0x4da998(0x12f))['send'](),await this[_0x4da998(0x122)][_0x4da998(0x134)](_0x406e1a['name'],_0x85c1c5[_0x4da998(0xfb)]);!this['commitData'][_0x4da998(0x112)]?(this[_0x4da998(0xfa)][_0x4da998(0xf2)](this['prefix']+_0x4da998(0x145)),await this[_0x4da998(0x113)]['prepareMdapi'](this[_0x4da998(0x122)][_0x4da998(0x131)])):this['sfLogger'][_0x4da998(0xf2)](this['prefix']+_0x4da998(0x149));await this[_0x4da998(0xfa)][_0x4da998(0xf2)](this[_0x4da998(0xf3)]+_0x4da998(0x108))[_0x4da998(0x12a)]();_0x55c2a4[_0x4da998(0x147)]&&(this['sfLogger']['log'](this[_0x4da998(0xf3)]+_0x4da998(0xe6)),this[_0x4da998(0x118)]=_0x55c2a4['writed'][_0x4da998(0x10a)],await this[_0x4da998(0xf4)](_0x55c2a4[_0x4da998(0x147)]),await this[_0x4da998(0xfa)][_0x4da998(0x12a)]());await this[_0x4da998(0xfa)][_0x4da998(0xf2)](this['prefix']+_0x4da998(0x15b))[_0x4da998(0x12a)]();_0x55c2a4[_0x4da998(0x12b)]&&(this['sfLogger'][_0x4da998(0xf2)](this['prefix']+_0x4da998(0x11f)),this[_0x4da998(0xff)]=_0x55c2a4['deleted'][_0x4da998(0x10a)],await this[_0x4da998(0xed)](_0x55c2a4[_0x4da998(0x12b)]),await this['sfLogger']['send']());await this[_0x4da998(0xfa)][_0x4da998(0x12a)]();const _0x369ce2=await fs_internal_1['FS'][_0x4da998(0x13f)](this['gitUtils']['dir']);await sfdx_utils_2['SFDX']['isSFDXProject'](this[_0x4da998(0x122)][_0x4da998(0x131)])?(_0x1bef1b=!![],await fs_internal_1['FS'][_0x4da998(0xe8)]((0x0,path_1[_0x4da998(0x148)])(this[_0x4da998(0x122)][_0x4da998(0x131)],'force-app'))):(_0x1bef1b&&(!_0x369ce2&&(_0x1bef1b=![])),await this[_0x4da998(0x122)][_0x4da998(0x14d)]());_0x1bef1b?(await this['sfLogger'][_0x4da998(0xf2)](this['prefix']+_0x4da998(0x155))[_0x4da998(0x12a)](),await this[_0x4da998(0x13a)]['createProjectFrom'](this[_0x4da998(0x113)][_0x4da998(0x131)]),await this[_0x4da998(0x13a)][_0x4da998(0x11b)](this[_0x4da998(0x122)][_0x4da998(0x131)],!_0x369ce2),await this['sfdxUtils'][_0x4da998(0x130)](this[_0x4da998(0x113)]['dir'],(0x0,path_1[_0x4da998(0x148)])(this['gitUtils'][_0x4da998(0x131)],constants_2[_0x4da998(0x133)])),await this[_0x4da998(0x13a)][_0x4da998(0xe8)]()):(await this['sfLogger'][_0x4da998(0xf2)](this[_0x4da998(0xf3)]+_0x4da998(0x15a))[_0x4da998(0x12a)](),await this[_0x4da998(0x113)][_0x4da998(0x154)](this[_0x4da998(0x122)][_0x4da998(0x131)]));await this[_0x4da998(0xfa)][_0x4da998(0xf2)](this[_0x4da998(0xf3)]+_0x4da998(0x121))['send'](),await this['gitUtils'][_0x4da998(0x10e)](_0x3a0bdb,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x2e96de[_0x4da998(0xfb)]},_0x406e1a['name']),await this[_0x4da998(0x122)]['removeDir'](),await this['mdapiUtils'][_0x4da998(0xe8)]();const _0x3a351c=this['componentsToWrite']+this['componentsToDelete'];await this[_0x4da998(0xfa)][_0x4da998(0xf2)](this['prefix']+_0x4da998(0x129)+(Date['now']()-this[_0x4da998(0x120)])+_0x4da998(0x100)+_0x3a351c+'.')[_0x4da998(0x12a)]();}catch(_0x93d66d){await this[_0x4da998(0x151)](),await this[_0x4da998(0xfa)][_0x4da998(0x116)](this[_0x4da998(0xf3)]+'\x20'+_0x93d66d)[_0x4da998(0x12a)]();throw _0x93d66d;}}async[a104_0xe5f0cc(0x110)](_0xf495ac,_0x5400e9){const _0x12e38b=a104_0xe5f0cc;var _0x1ec2a5,_0x39d24d;this[_0x12e38b(0xfa)]=typedi_1[_0x12e38b(0xf1)][_0x12e38b(0x10b)](providers_tokens_1[_0x12e38b(0xf5)][_0x12e38b(0xf8)]),this[_0x12e38b(0xf3)]=(_0x5400e9?_0x5400e9+'\x20':'')+'['+commit_components_dto_1[_0x12e38b(0x104)][_0x12e38b(0xfb)]+']',await this['sfLogger']['log'](this[_0x12e38b(0xf3)]+_0x12e38b(0x132));const _0x14501e=!!((_0x1ec2a5=_0xf495ac[_0x12e38b(0x146)])===null||_0x1ec2a5===void 0x0?void 0x0:_0x1ec2a5[_0x12e38b(0x147)])||!!((_0x39d24d=_0xf495ac[_0x12e38b(0x146)])===null||_0x39d24d===void 0x0?void 0x0:_0x39d24d[_0x12e38b(0x12b)]);if(!_0x14501e){await this[_0x12e38b(0xfa)]['log'](this['prefix']+_0x12e38b(0x14e))[_0x12e38b(0x12a)]();return;}this[_0x12e38b(0x137)]=_0xf495ac,await this[_0x12e38b(0x158)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0xe5f0cc(0x159)])({'transient':!![]})],CommitComponentsJob),exports[a104_0xe5f0cc(0x10d)]=CommitComponentsJob;