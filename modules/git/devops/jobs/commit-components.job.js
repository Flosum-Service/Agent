const a73_0x4305d2=a73_0x40df;(function(_0x3058fa,_0x4f6e52){const _0x33efa2=a73_0x40df,_0x17859b=_0x3058fa();while(!![]){try{const _0x1dc998=-parseInt(_0x33efa2(0x116))/0x1+-parseInt(_0x33efa2(0xdb))/0x2+-parseInt(_0x33efa2(0xc8))/0x3*(parseInt(_0x33efa2(0xbf))/0x4)+-parseInt(_0x33efa2(0xbe))/0x5+-parseInt(_0x33efa2(0xfe))/0x6*(parseInt(_0x33efa2(0xde))/0x7)+parseInt(_0x33efa2(0x10c))/0x8*(parseInt(_0x33efa2(0xf0))/0x9)+parseInt(_0x33efa2(0xc1))/0xa;if(_0x1dc998===_0x4f6e52)break;else _0x17859b['push'](_0x17859b['shift']());}catch(_0xee11c4){_0x17859b['push'](_0x17859b['shift']());}}}(a73_0xabca,0x7facc));const a73_0x322b1c=(function(){let _0xfb3fd4=!![];return function(_0xd280,_0x414940){const _0x11d11e=_0xfb3fd4?function(){if(_0x414940){const _0x45d21f=_0x414940['apply'](_0xd280,arguments);return _0x414940=null,_0x45d21f;}}:function(){};return _0xfb3fd4=![],_0x11d11e;};}()),a73_0x51977f=a73_0x322b1c(this,function(){const _0x334899=a73_0x40df;return a73_0x51977f[_0x334899(0xda)]()[_0x334899(0x11a)](_0x334899(0xba))[_0x334899(0xda)]()[_0x334899(0xb9)](a73_0x51977f)[_0x334899(0x11a)](_0x334899(0xba));});function a73_0xabca(){const _0x2eeb8e=['deleted','includes','COMPONENTS_PER_TICK','\x20components','BitbucketApiService','catch','\x20Copying\x20mdapi\x20to\x20git\x20folder.','toString','1415964tkYLad','../../providers/providers.tokens','prefix','7mRJSWL','reduce','values','typedi','\x20Preparing\x20to\x20write\x20components','dir','create','credentials','commitAndPush','MDApiUtils','defineProperty','\x20Preparing\x20to\x20delete\x20components','\x20Checking\x20commit\x20components.','SFDXUtils','type','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','\x20Start\x20converting\x20to\x20SFDX.','162lVipHh','../../../shared/utils','\x20Wrote\x20','getGitShellAuthorizationString','log','../utils/git.utils','sfLogger','writed','sfdxUtils','__createBinding','removeDir','Tokens','exec','master','4167894uXAEWt','logger','push','force-app','configurable','\x20Nothing\x20to\x20commit.\x20Skip.','clearDir','clone','function','\x20Checking\x20written\x20components.','__importDefault','GitProvider','prepareMdapi','DEFAULT_GIT_USER_EMAIL','261896enYLBi','name','decorate','branch','length','sort','../../providers/types/git-provider','removeComponents','hasOwnProperty','\x20Prepare\x20mdapi\x20files.','933560XAvirm','startTime','CommitComponentsDto','fileName','search','get','gitUtils','__esModule','isSFDXProject','splice','prototype','getOwnPropertyDescriptor','componentsToDelete','componentsToWrite','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','path','SFDX','../../salesforce/utils/sfdx.utils','commitData','now','components','cleanUp','writeComponents','../../parsers/data/child-types','../../internal/fs.internal','object','\x20Checking\x20deleted\x20components.','constructor','(((.+)+)+)+$','mdapiUtils','gitUrl','createProjectFrom','1591620zJCFdQ','4drHljO','send','35690880LODJfY','getProtocol','provider','../utils/sfdx.utils','writeFlosumComponents','CommitComponentsJob','\x20Start\x20cloning\x20repository.','2942649lPRrKw','Service','__importStar','copyMdapiTo','__decorate','groupComponentsByFileName','isLoggedIn','default','__setModuleDefault','../utils/mdapi.utils','getRemote'];a73_0xabca=function(){return _0x2eeb8e;};return a73_0xabca();}function a73_0x40df(_0xbc9c13,_0x7175c2){const _0x2626dc=a73_0xabca();return a73_0x40df=function(_0x51977f,_0x322b1c){_0x51977f=_0x51977f-0xb7;let _0xabca49=_0x2626dc[_0x51977f];return _0xabca49;},a73_0x40df(_0xbc9c13,_0x7175c2);}a73_0x51977f();'use strict';var __createBinding=this&&this[a73_0x4305d2(0xf9)]||(Object['create']?function(_0x372c8e,_0x3cde89,_0x4605ff,_0x350022){const _0x3af144=a73_0x4305d2;if(_0x350022===undefined)_0x350022=_0x4605ff;var _0x13ed57=Object[_0x3af144(0x121)](_0x3cde89,_0x4605ff);(!_0x13ed57||(_0x3af144(0x11b)in _0x13ed57?!_0x3cde89[_0x3af144(0x11d)]:_0x13ed57['writable']||_0x13ed57[_0x3af144(0x102)]))&&(_0x13ed57={'enumerable':!![],'get':function(){return _0x3cde89[_0x4605ff];}}),Object[_0x3af144(0xe8)](_0x372c8e,_0x350022,_0x13ed57);}:function(_0x220dbb,_0x150ec1,_0x186ce5,_0xf1a3c6){if(_0xf1a3c6===undefined)_0xf1a3c6=_0x186ce5;_0x220dbb[_0xf1a3c6]=_0x150ec1[_0x186ce5];}),__setModuleDefault=this&&this[a73_0x4305d2(0xd0)]||(Object[a73_0x4305d2(0xe4)]?function(_0x3984a3,_0x48db69){const _0x152239=a73_0x4305d2;Object[_0x152239(0xe8)](_0x3984a3,'default',{'enumerable':!![],'value':_0x48db69});}:function(_0x81ede5,_0x4da6a5){const _0x44bdf4=a73_0x4305d2;_0x81ede5[_0x44bdf4(0xcf)]=_0x4da6a5;}),__decorate=this&&this[a73_0x4305d2(0xcc)]||function(_0x30ca9a,_0x4d43db,_0x39f111,_0x13fef4){const _0x548791=a73_0x4305d2;var _0x558387=arguments[_0x548791(0x110)],_0x2bdf93=_0x558387<0x3?_0x4d43db:_0x13fef4===null?_0x13fef4=Object[_0x548791(0x121)](_0x4d43db,_0x39f111):_0x13fef4,_0x562695;if(typeof Reflect===_0x548791(0xb7)&&typeof Reflect[_0x548791(0x10e)]===_0x548791(0x106))_0x2bdf93=Reflect[_0x548791(0x10e)](_0x30ca9a,_0x4d43db,_0x39f111,_0x13fef4);else{for(var _0x5b6f8a=_0x30ca9a[_0x548791(0x110)]-0x1;_0x5b6f8a>=0x0;_0x5b6f8a--)if(_0x562695=_0x30ca9a[_0x5b6f8a])_0x2bdf93=(_0x558387<0x3?_0x562695(_0x2bdf93):_0x558387>0x3?_0x562695(_0x4d43db,_0x39f111,_0x2bdf93):_0x562695(_0x4d43db,_0x39f111))||_0x2bdf93;}return _0x558387>0x3&&_0x2bdf93&&Object['defineProperty'](_0x4d43db,_0x39f111,_0x2bdf93),_0x2bdf93;},__importStar=this&&this[a73_0x4305d2(0xca)]||function(_0x2daa6e){const _0x3a68fc=a73_0x4305d2;if(_0x2daa6e&&_0x2daa6e[_0x3a68fc(0x11d)])return _0x2daa6e;var _0xab4b20={};if(_0x2daa6e!=null){for(var _0x1a8723 in _0x2daa6e)if(_0x1a8723!==_0x3a68fc(0xcf)&&Object[_0x3a68fc(0x120)][_0x3a68fc(0x114)]['call'](_0x2daa6e,_0x1a8723))__createBinding(_0xab4b20,_0x2daa6e,_0x1a8723);}return __setModuleDefault(_0xab4b20,_0x2daa6e),_0xab4b20;},__importDefault=this&&this[a73_0x4305d2(0x108)]||function(_0x53d8e8){const _0x1284f3=a73_0x4305d2;return _0x53d8e8&&_0x53d8e8[_0x1284f3(0x11d)]?_0x53d8e8:{'default':_0x53d8e8};};Object[a73_0x4305d2(0xe8)](exports,a73_0x4305d2(0x11d),{'value':!![]}),exports[a73_0x4305d2(0xc6)]=void 0x0;const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require('events')),git_utils_1=require(a73_0x4305d2(0xf5)),mdapi_utils_1=require(a73_0x4305d2(0xd1)),sfdx_utils_1=require(a73_0x4305d2(0xc4)),typedi_1=__importStar(require(a73_0x4305d2(0xe1))),child_types_1=__importDefault(require(a73_0x4305d2(0x12d))),utils_1=require(a73_0x4305d2(0xf1)),constants_1=require('../../../../constants'),git_provider_1=require(a73_0x4305d2(0x112)),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require(a73_0x4305d2(0x127)),fs_internal_1=require(a73_0x4305d2(0x12e)),path_1=require(a73_0x4305d2(0x125)),providers_tokens_1=require(a73_0x4305d2(0xdc));let CommitComponentsJob=class CommitComponentsJob extends events_1[a73_0x4305d2(0xcf)]{constructor(){const _0x5c439d=a73_0x4305d2;super(...arguments),this[_0x5c439d(0xd5)]=0x3e8,this[_0x5c439d(0x123)]=0x0,this[_0x5c439d(0x122)]=0x0,this['startTime']=Date[_0x5c439d(0x129)]();}async[a73_0x4305d2(0xd2)](){const _0x131e1c=a73_0x4305d2,{repo:_0x14d85b}=this[_0x131e1c(0x128)],_0x440c5f=typedi_1[_0x131e1c(0xcf)]['get'](providers_tokens_1[_0x131e1c(0xfb)][_0x131e1c(0xe5)]);if(this['commitData'][_0x131e1c(0xc3)]===git_provider_1[_0x131e1c(0x109)]['Bitbucket']){const _0xe4be7c=typedi_1[_0x131e1c(0xcf)][_0x131e1c(0x11b)](bitbucket_api_service_1[_0x131e1c(0xd7)]);await _0xe4be7c[_0x131e1c(0xce)]();}return _0x14d85b['gitUrl']['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x131e1c(0xc2)])(_0x14d85b[_0x131e1c(0xbc)])+'://'+_0x440c5f[_0x131e1c(0xf3)]()+'@');}['groupComponentsByFileName'](_0x5b8224){const _0x440394=a73_0x4305d2;var _0xcb2fa;_0x5b8224[_0x440394(0x111)](_0x3c4801=>child_types_1[_0x440394(0xcf)][_0x440394(0xd4)](_0x3c4801['fileType'])?0x1:-0x1);const _0x54a408={};for(const _0x35c9dc of _0x5b8224){_0x54a408[_0xcb2fa=_0x35c9dc[_0x440394(0x119)]]||(_0x54a408[_0xcb2fa]=[]),_0x54a408[_0x35c9dc[_0x440394(0x119)]][_0x440394(0x100)](_0x35c9dc);}return Object[_0x440394(0xe0)](_0x54a408)[_0x440394(0xdf)]((_0x64cfce,_0x58536b)=>[..._0x64cfce,..._0x58536b],[]);}async[a73_0x4305d2(0x12c)](_0x292fc7){const _0x363dd6=a73_0x4305d2;_0x292fc7=this[_0x363dd6(0xcd)](_0x292fc7);let _0x519681=0x0;while(_0x292fc7[_0x363dd6(0x110)]){const _0x226e9f=_0x292fc7['splice'](0x0,this[_0x363dd6(0xd5)]);await this['mdapiUtils'][_0x363dd6(0xc5)](_0x226e9f,{'skipChildErrors':this[_0x363dd6(0x128)][_0x363dd6(0x10f)][_0x363dd6(0x10d)]===_0x363dd6(0xfd)}),_0x519681+=_0x226e9f[_0x363dd6(0x110)],this[_0x363dd6(0xf6)][_0x363dd6(0xf4)](this[_0x363dd6(0xdd)]+_0x363dd6(0xf2)+_0x519681+'/'+this['componentsToWrite']+_0x363dd6(0xd6)),await this['sfLogger'][_0x363dd6(0xc0)]();}}async[a73_0x4305d2(0x113)](_0x22dbf7){const _0x166ee6=a73_0x4305d2;_0x22dbf7['sort'](_0x26dbba=>child_types_1[_0x166ee6(0xcf)][_0x166ee6(0xd4)](_0x26dbba[_0x166ee6(0xec)])?-0x1:0x1);let _0x4818df=0x0;while(_0x22dbf7[_0x166ee6(0x110)]){const _0x154cbd=_0x22dbf7[_0x166ee6(0x11f)](0x0,this[_0x166ee6(0xd5)]);await this['mdapiUtils'][_0x166ee6(0x113)](_0x154cbd),_0x4818df+=_0x154cbd['length'],this['sfLogger'][_0x166ee6(0xf4)](this[_0x166ee6(0xdd)]+'\x20Deleted\x20'+_0x4818df+'/'+this[_0x166ee6(0x122)]+_0x166ee6(0xd6)),await this[_0x166ee6(0xf6)][_0x166ee6(0xc0)]();}}async['cleanUp'](){const _0x4ec923=a73_0x4305d2;this['gitUtils']&&await this[_0x4ec923(0x11c)]['removeDir']()[_0x4ec923(0xd8)](()=>void 0x0),this['mdapiUtils']&&await this[_0x4ec923(0xbb)][_0x4ec923(0xfa)]()['catch'](()=>void 0x0),this[_0x4ec923(0xf8)]&&await this[_0x4ec923(0xf8)]['removeDir']()[_0x4ec923(0xd8)](()=>void 0x0);}async[a73_0x4305d2(0xfc)](){const _0x58d9e0=a73_0x4305d2,{repo:_0x5e7cfc,branch:_0x299602,components:_0x1ff2a2,convertToSFDX:_0x1bc938,message:_0x566571,user:_0x283d69}=this[_0x58d9e0(0x128)];this[_0x58d9e0(0xbb)]=new mdapi_utils_1[(_0x58d9e0(0xe7))](),this[_0x58d9e0(0x11c)]=new git_utils_1['GitUtils'](await this['getRemote']()),this[_0x58d9e0(0xf8)]=new sfdx_utils_1[(_0x58d9e0(0xeb))]();let _0x210d38=_0x1bc938;try{await this[_0x58d9e0(0xf6)]['log'](this['prefix']+_0x58d9e0(0xc7))[_0x58d9e0(0xc0)](),await this[_0x58d9e0(0x11c)][_0x58d9e0(0x105)](_0x299602[_0x58d9e0(0x10d)],_0x5e7cfc[_0x58d9e0(0x10d)]);!this[_0x58d9e0(0x128)]['force']?(this[_0x58d9e0(0xf6)][_0x58d9e0(0xf4)](this[_0x58d9e0(0xdd)]+_0x58d9e0(0x115)),await this[_0x58d9e0(0xbb)][_0x58d9e0(0x10a)](this[_0x58d9e0(0x11c)]['dir'])):this[_0x58d9e0(0xf6)][_0x58d9e0(0xf4)](this[_0x58d9e0(0xdd)]+_0x58d9e0(0xee));await this[_0x58d9e0(0xf6)]['log'](this[_0x58d9e0(0xdd)]+_0x58d9e0(0x107))[_0x58d9e0(0xc0)]();_0x1ff2a2[_0x58d9e0(0xf7)]&&(this[_0x58d9e0(0xf6)][_0x58d9e0(0xf4)](this['prefix']+_0x58d9e0(0xe2)),this[_0x58d9e0(0x123)]=_0x1ff2a2[_0x58d9e0(0xf7)][_0x58d9e0(0x110)],await this[_0x58d9e0(0x12c)](_0x1ff2a2[_0x58d9e0(0xf7)]),await this[_0x58d9e0(0xf6)]['send']());await this[_0x58d9e0(0xf6)][_0x58d9e0(0xf4)](this[_0x58d9e0(0xdd)]+_0x58d9e0(0xb8))[_0x58d9e0(0xc0)]();_0x1ff2a2[_0x58d9e0(0xd3)]&&(this[_0x58d9e0(0xf6)][_0x58d9e0(0xf4)](this[_0x58d9e0(0xdd)]+_0x58d9e0(0xe9)),this[_0x58d9e0(0x122)]=_0x1ff2a2[_0x58d9e0(0xd3)][_0x58d9e0(0x110)],await this[_0x58d9e0(0x113)](_0x1ff2a2[_0x58d9e0(0xd3)]),await this[_0x58d9e0(0xf6)][_0x58d9e0(0xc0)]());await this[_0x58d9e0(0xf6)][_0x58d9e0(0xc0)]();const _0x4840ac=await fs_internal_1['FS']['isEmptyDir'](this['gitUtils'][_0x58d9e0(0xe3)]);await sfdx_utils_2[_0x58d9e0(0x126)][_0x58d9e0(0x11e)](this['gitUtils']['dir'])?(_0x210d38=!![],await fs_internal_1['FS'][_0x58d9e0(0xfa)]((0x0,path_1['join'])(this[_0x58d9e0(0x11c)]['dir'],_0x58d9e0(0x101)))):(_0x210d38&&(!_0x4840ac&&(_0x210d38=![])),await this[_0x58d9e0(0x11c)][_0x58d9e0(0x104)]());_0x210d38?(await this[_0x58d9e0(0xf6)][_0x58d9e0(0xf4)](this[_0x58d9e0(0xdd)]+_0x58d9e0(0xef))[_0x58d9e0(0xc0)](),await this[_0x58d9e0(0xf8)][_0x58d9e0(0xbd)](this[_0x58d9e0(0xbb)][_0x58d9e0(0xe3)]),await this['sfdxUtils']['copyProjectTo'](this[_0x58d9e0(0x11c)][_0x58d9e0(0xe3)],!_0x4840ac),await this['sfdxUtils'][_0x58d9e0(0xfa)]()):(await this[_0x58d9e0(0xf6)]['log'](this[_0x58d9e0(0xdd)]+_0x58d9e0(0xd9))[_0x58d9e0(0xc0)](),await this[_0x58d9e0(0xbb)][_0x58d9e0(0xcb)](this['gitUtils'][_0x58d9e0(0xe3)]));await this[_0x58d9e0(0xf6)][_0x58d9e0(0xf4)](this[_0x58d9e0(0xdd)]+_0x58d9e0(0x124))[_0x58d9e0(0xc0)](),await this[_0x58d9e0(0x11c)][_0x58d9e0(0xe6)](_0x566571,{'email':constants_1[_0x58d9e0(0x10b)],'name':_0x283d69[_0x58d9e0(0x10d)]},_0x299602['name']),await this[_0x58d9e0(0x11c)][_0x58d9e0(0xfa)](),await this[_0x58d9e0(0xbb)]['removeDir']();const _0x141613=this['componentsToWrite']+this[_0x58d9e0(0x122)];await this[_0x58d9e0(0xf6)]['log'](this[_0x58d9e0(0xdd)]+_0x58d9e0(0xed)+(Date[_0x58d9e0(0x129)]()-this[_0x58d9e0(0x117)])+'ms.\x20Committed\x20components\x20-\x20'+_0x141613+'.')[_0x58d9e0(0xc0)]();}catch(_0x4a01f7){await this[_0x58d9e0(0x12b)](),await this[_0x58d9e0(0xf6)]['error'](this[_0x58d9e0(0xdd)]+'\x20'+_0x4a01f7)[_0x58d9e0(0xc0)]();throw _0x4a01f7;}}async['run'](_0x1bedd4,_0x21962e){const _0x4528a8=a73_0x4305d2;var _0xc0e5b7,_0x4c0edc;this['sfLogger']=typedi_1[_0x4528a8(0xcf)][_0x4528a8(0x11b)](providers_tokens_1[_0x4528a8(0xfb)][_0x4528a8(0xff)]),this[_0x4528a8(0xdd)]=(_0x21962e?_0x21962e+'\x20':'')+'['+commit_components_dto_1[_0x4528a8(0x118)][_0x4528a8(0x10d)]+']',await this['sfLogger']['log'](this[_0x4528a8(0xdd)]+_0x4528a8(0xea));const _0xd89e16=!!((_0xc0e5b7=_0x1bedd4['components'])===null||_0xc0e5b7===void 0x0?void 0x0:_0xc0e5b7[_0x4528a8(0xf7)])||!!((_0x4c0edc=_0x1bedd4[_0x4528a8(0x12a)])===null||_0x4c0edc===void 0x0?void 0x0:_0x4c0edc['deleted']);if(!_0xd89e16){await this[_0x4528a8(0xf6)][_0x4528a8(0xf4)](this[_0x4528a8(0xdd)]+_0x4528a8(0x103))[_0x4528a8(0xc0)]();return;}this[_0x4528a8(0x128)]=_0x1bedd4,await this[_0x4528a8(0xfc)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a73_0x4305d2(0xc9)])({'transient':!![]})],CommitComponentsJob),exports[a73_0x4305d2(0xc6)]=CommitComponentsJob;