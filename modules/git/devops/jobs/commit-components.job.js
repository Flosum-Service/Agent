const a104_0x401796=a104_0x4283;function a104_0x4283(_0x30d2c7,_0x29dfa9){const _0x2af61f=a104_0x9bf5();return a104_0x4283=function(_0x5343b2,_0x2b0445){_0x5343b2=_0x5343b2-0x113;let _0x9bf5b0=_0x2af61f[_0x5343b2];return _0x9bf5b0;},a104_0x4283(_0x30d2c7,_0x29dfa9);}(function(_0x3e6751,_0x16e2e5){const _0x286530=a104_0x4283,_0x34f1e0=_0x3e6751();while(!![]){try{const _0x3e3906=parseInt(_0x286530(0x178))/0x1*(-parseInt(_0x286530(0x15d))/0x2)+parseInt(_0x286530(0x177))/0x3*(parseInt(_0x286530(0x167))/0x4)+parseInt(_0x286530(0x113))/0x5*(-parseInt(_0x286530(0x163))/0x6)+-parseInt(_0x286530(0x164))/0x7+-parseInt(_0x286530(0x15b))/0x8*(-parseInt(_0x286530(0x188))/0x9)+-parseInt(_0x286530(0x155))/0xa+-parseInt(_0x286530(0x189))/0xb*(-parseInt(_0x286530(0x157))/0xc);if(_0x3e3906===_0x16e2e5)break;else _0x34f1e0['push'](_0x34f1e0['shift']());}catch(_0x46e107){_0x34f1e0['push'](_0x34f1e0['shift']());}}}(a104_0x9bf5,0x308b6));const a104_0x2b0445=(function(){let _0x2ddc46=!![];return function(_0x3ff080,_0x9a5d64){const _0x5d9548=_0x2ddc46?function(){const _0x1d1699=a104_0x4283;if(_0x9a5d64){const _0x69b0f1=_0x9a5d64[_0x1d1699(0x131)](_0x3ff080,arguments);return _0x9a5d64=null,_0x69b0f1;}}:function(){};return _0x2ddc46=![],_0x5d9548;};}()),a104_0x5343b2=a104_0x2b0445(this,function(){const _0x291341=a104_0x4283;return a104_0x5343b2[_0x291341(0x16f)]()[_0x291341(0x170)]('(((.+)+)+)+$')[_0x291341(0x16f)]()[_0x291341(0x15f)](a104_0x5343b2)['search'](_0x291341(0x119));});a104_0x5343b2();'use strict';var __createBinding=this&&this[a104_0x401796(0x18b)]||(Object[a104_0x401796(0x153)]?function(_0x220036,_0x27bc93,_0x520946,_0x57b958){const _0x327884=a104_0x401796;if(_0x57b958===undefined)_0x57b958=_0x520946;var _0x5b8874=Object[_0x327884(0x162)](_0x27bc93,_0x520946);(!_0x5b8874||(_0x327884(0x168)in _0x5b8874?!_0x27bc93[_0x327884(0x151)]:_0x5b8874[_0x327884(0x150)]||_0x5b8874[_0x327884(0x160)]))&&(_0x5b8874={'enumerable':!![],'get':function(){return _0x27bc93[_0x520946];}}),Object[_0x327884(0x145)](_0x220036,_0x57b958,_0x5b8874);}:function(_0x2df7da,_0x4a1ded,_0x45ddea,_0x5395ca){if(_0x5395ca===undefined)_0x5395ca=_0x45ddea;_0x2df7da[_0x5395ca]=_0x4a1ded[_0x45ddea];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a104_0x401796(0x153)]?function(_0x15cc4c,_0x3c87a1){const _0x327156=a104_0x401796;Object[_0x327156(0x145)](_0x15cc4c,_0x327156(0x16a),{'enumerable':!![],'value':_0x3c87a1});}:function(_0x456750,_0x35ba7c){const _0x40ff0c=a104_0x401796;_0x456750[_0x40ff0c(0x16a)]=_0x35ba7c;}),__decorate=this&&this[a104_0x401796(0x18a)]||function(_0x23cd18,_0x488533,_0x1a494b,_0x1ddf56){const _0xf5368e=a104_0x401796;var _0x23a8ef=arguments[_0xf5368e(0x143)],_0xcaebc3=_0x23a8ef<0x3?_0x488533:_0x1ddf56===null?_0x1ddf56=Object[_0xf5368e(0x162)](_0x488533,_0x1a494b):_0x1ddf56,_0x5d806c;if(typeof Reflect===_0xf5368e(0x14c)&&typeof Reflect[_0xf5368e(0x130)]==='function')_0xcaebc3=Reflect[_0xf5368e(0x130)](_0x23cd18,_0x488533,_0x1a494b,_0x1ddf56);else{for(var _0x28b4ec=_0x23cd18['length']-0x1;_0x28b4ec>=0x0;_0x28b4ec--)if(_0x5d806c=_0x23cd18[_0x28b4ec])_0xcaebc3=(_0x23a8ef<0x3?_0x5d806c(_0xcaebc3):_0x23a8ef>0x3?_0x5d806c(_0x488533,_0x1a494b,_0xcaebc3):_0x5d806c(_0x488533,_0x1a494b))||_0xcaebc3;}return _0x23a8ef>0x3&&_0xcaebc3&&Object[_0xf5368e(0x145)](_0x488533,_0x1a494b,_0xcaebc3),_0xcaebc3;},__importStar=this&&this[a104_0x401796(0x140)]||function(_0x286638){const _0x55f6f5=a104_0x401796;if(_0x286638&&_0x286638[_0x55f6f5(0x151)])return _0x286638;var _0x3e27c6={};if(_0x286638!=null){for(var _0x378bf3 in _0x286638)if(_0x378bf3!=='default'&&Object['prototype'][_0x55f6f5(0x146)][_0x55f6f5(0x135)](_0x286638,_0x378bf3))__createBinding(_0x3e27c6,_0x286638,_0x378bf3);}return __setModuleDefault(_0x3e27c6,_0x286638),_0x3e27c6;},__importDefault=this&&this['__importDefault']||function(_0x506212){const _0x192cab=a104_0x401796;return _0x506212&&_0x506212[_0x192cab(0x151)]?_0x506212:{'default':_0x506212};};function a104_0x9bf5(){const _0xa018d8=['fileType','600522euOTKK','includes','constructor','configurable','../../../shared/utils','getOwnPropertyDescriptor','157386HFoRwU','1427489iRLlSH','getProtocol','MDApiUtils','5132brOZKL','get','prefix','default','typedi','master','://','isEmptyDir','toString','search','push','gitUrl','../utils/sfdx.utils','path','sfLogger','../../../../constants','72nDOYZc','1jSFZim','deleted','../../providers/providers.tokens','getGitShellAuthorizationString','SFDXUtils','now','isSFDXProject','writeFlosumComponents','\x20Start\x20converting\x20to\x20SFDX.','\x20Nothing\x20to\x20commit.\x20Skip.','BitbucketApiService','../utils/git.utils','clearDir','commitData','startTime','../../parsers/data/child-types','9xoNhGF','1375FLLnUV','__decorate','__createBinding','log','5EMfosh','../../providers/types/git-provider','sort','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','\x20Checking\x20written\x20components.','run','(((.+)+)+)+$','DEFAULT_GIT_USER_EMAIL','\x20Prepare\x20mdapi\x20files.','force','replace','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','\x20Checking\x20deleted\x20components.','copyMdapiTo','Bitbucket','fileName','\x20Preparing\x20to\x20write\x20components','force-app','Tokens','COMPONENTS_PER_TICK','clone','componentsToWrite','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','gitUtils','send','splice','\x20Checking\x20commit\x20components.','catch','GitProvider','decorate','apply','prepareMdapi','reduce','join','call','logger','components','Service','sfdxUtils','\x20Start\x20cloning\x20repository.','events','cleanUp','\x20components','writed','createProjectFrom','__importStar','exec','../dto/commit-components.dto','length','CommitComponentsDto','defineProperty','hasOwnProperty','dir','\x20Deleted\x20','removeDir','../../salesforce/utils/sfdx.utils','name','object','error','CommitComponentsJob','getRemote','writable','__esModule','groupComponentsByFileName','create','mdapiUtils','3359980bOERzU','copyProjectTo','78024KGSFjj','removeComponents','ms.\x20Committed\x20components\x20-\x20','componentsToDelete','1773704CdXdLB'];a104_0x9bf5=function(){return _0xa018d8;};return a104_0x9bf5();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a104_0x401796(0x14e)]=void 0x0;const commit_components_dto_1=require(a104_0x401796(0x142)),events_1=__importDefault(require(a104_0x401796(0x13b))),git_utils_1=require(a104_0x401796(0x183)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a104_0x401796(0x173)),typedi_1=__importStar(require(a104_0x401796(0x16b))),child_types_1=__importDefault(require(a104_0x401796(0x187))),utils_1=require(a104_0x401796(0x161)),constants_1=require(a104_0x401796(0x176)),git_provider_1=require(a104_0x401796(0x114)),bitbucket_api_service_1=require('../../providers/api/bitbucket-api.service'),sfdx_utils_2=require(a104_0x401796(0x14a)),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a104_0x401796(0x174)),providers_tokens_1=require(a104_0x401796(0x17a));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x401796(0x16a)]{constructor(){const _0x3f12dc=a104_0x401796;super(...arguments),this[_0x3f12dc(0x126)]=0x3e8,this['componentsToWrite']=0x0,this[_0x3f12dc(0x15a)]=0x0,this[_0x3f12dc(0x186)]=Date[_0x3f12dc(0x17d)]();}async['getRemote'](){const _0x3c8633=a104_0x401796,{repo:_0x41cd19}=this[_0x3c8633(0x185)],_0x204b7f=typedi_1[_0x3c8633(0x16a)][_0x3c8633(0x168)](providers_tokens_1[_0x3c8633(0x125)]['credentials']);if(this['commitData']['provider']===git_provider_1[_0x3c8633(0x12f)][_0x3c8633(0x121)]){const _0x315778=typedi_1['default']['get'](bitbucket_api_service_1[_0x3c8633(0x182)]);await _0x315778['isLoggedIn']();}return _0x41cd19[_0x3c8633(0x172)][_0x3c8633(0x11d)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x3c8633(0x165)])(_0x41cd19[_0x3c8633(0x172)])+_0x3c8633(0x16d)+_0x204b7f[_0x3c8633(0x17b)]()+'@');}['groupComponentsByFileName'](_0x309e29){const _0x43e670=a104_0x401796;var _0x57338a;_0x309e29[_0x43e670(0x115)](_0x1a21f3=>child_types_1[_0x43e670(0x16a)][_0x43e670(0x15e)](_0x1a21f3[_0x43e670(0x15c)])?0x1:-0x1);const _0x175763={};for(const _0x4639b6 of _0x309e29){_0x175763[_0x57338a=_0x4639b6[_0x43e670(0x122)]]||(_0x175763[_0x57338a]=[]),_0x175763[_0x4639b6[_0x43e670(0x122)]][_0x43e670(0x171)](_0x4639b6);}return Object['values'](_0x175763)[_0x43e670(0x133)]((_0x33c01f,_0x5cf047)=>[..._0x33c01f,..._0x5cf047],[]);}async['writeComponents'](_0x5effe0){const _0x41d2e3=a104_0x401796;_0x5effe0=this[_0x41d2e3(0x152)](_0x5effe0);let _0x304796=0x0;while(_0x5effe0['length']){const _0x4c4f12=_0x5effe0[_0x41d2e3(0x12c)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils'][_0x41d2e3(0x17f)](_0x4c4f12,{'skipChildErrors':this[_0x41d2e3(0x185)]['branch'][_0x41d2e3(0x14b)]===_0x41d2e3(0x16c)}),_0x304796+=_0x4c4f12[_0x41d2e3(0x143)],this[_0x41d2e3(0x175)]['log'](this['prefix']+'\x20Wrote\x20'+_0x304796+'/'+this[_0x41d2e3(0x128)]+'\x20components'),await this[_0x41d2e3(0x175)][_0x41d2e3(0x12b)]();}}async[a104_0x401796(0x158)](_0x31dcf5){const _0x1b1714=a104_0x401796;_0x31dcf5[_0x1b1714(0x115)](_0x3383dd=>child_types_1[_0x1b1714(0x16a)][_0x1b1714(0x15e)](_0x3383dd['type'])?-0x1:0x1);let _0x370fa3=0x0;while(_0x31dcf5[_0x1b1714(0x143)]){const _0xd0517f=_0x31dcf5[_0x1b1714(0x12c)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x1b1714(0x154)][_0x1b1714(0x158)](_0xd0517f),_0x370fa3+=_0xd0517f[_0x1b1714(0x143)],this[_0x1b1714(0x175)]['log'](this[_0x1b1714(0x169)]+_0x1b1714(0x148)+_0x370fa3+'/'+this[_0x1b1714(0x15a)]+_0x1b1714(0x13d)),await this[_0x1b1714(0x175)]['send']();}}async['cleanUp'](){const _0x22460f=a104_0x401796;this[_0x22460f(0x12a)]&&await this[_0x22460f(0x12a)][_0x22460f(0x149)]()[_0x22460f(0x12e)](()=>void 0x0),this[_0x22460f(0x154)]&&await this[_0x22460f(0x154)]['removeDir']()['catch'](()=>void 0x0),this['sfdxUtils']&&await this[_0x22460f(0x139)][_0x22460f(0x149)]()['catch'](()=>void 0x0);}async[a104_0x401796(0x141)](){const _0x5428ba=a104_0x401796,{repo:_0x29eedf,branch:_0xb2afb3,components:_0x553559,convertToSFDX:_0x489f01,message:_0x2caf2e,user:_0x515853}=this[_0x5428ba(0x185)];this['mdapiUtils']=new mdapi_utils_1[(_0x5428ba(0x166))](),this[_0x5428ba(0x12a)]=new git_utils_1['GitUtils'](await this[_0x5428ba(0x14f)]()),this[_0x5428ba(0x139)]=new sfdx_utils_1[(_0x5428ba(0x17c))]();let _0x501e4f=_0x489f01;try{await this['sfLogger'][_0x5428ba(0x18c)](this['prefix']+_0x5428ba(0x13a))[_0x5428ba(0x12b)](),await this['gitUtils'][_0x5428ba(0x127)](_0xb2afb3[_0x5428ba(0x14b)],_0x29eedf[_0x5428ba(0x14b)]);!this['commitData'][_0x5428ba(0x11c)]?(this['sfLogger'][_0x5428ba(0x18c)](this['prefix']+_0x5428ba(0x11b)),await this['mdapiUtils'][_0x5428ba(0x132)](this[_0x5428ba(0x12a)][_0x5428ba(0x147)])):this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this[_0x5428ba(0x169)]+_0x5428ba(0x11e));await this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this[_0x5428ba(0x169)]+_0x5428ba(0x117))[_0x5428ba(0x12b)]();_0x553559[_0x5428ba(0x13e)]&&(this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this[_0x5428ba(0x169)]+_0x5428ba(0x123)),this[_0x5428ba(0x128)]=_0x553559[_0x5428ba(0x13e)]['length'],await this['writeComponents'](_0x553559[_0x5428ba(0x13e)]),await this[_0x5428ba(0x175)][_0x5428ba(0x12b)]());await this[_0x5428ba(0x175)]['log'](this['prefix']+_0x5428ba(0x11f))['send']();_0x553559[_0x5428ba(0x179)]&&(this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this[_0x5428ba(0x169)]+'\x20Preparing\x20to\x20delete\x20components'),this[_0x5428ba(0x15a)]=_0x553559[_0x5428ba(0x179)]['length'],await this['removeComponents'](_0x553559[_0x5428ba(0x179)]),await this['sfLogger'][_0x5428ba(0x12b)]());await this[_0x5428ba(0x175)]['send']();const _0x4bd564=await fs_internal_1['FS'][_0x5428ba(0x16e)](this[_0x5428ba(0x12a)][_0x5428ba(0x147)]);await sfdx_utils_2['SFDX'][_0x5428ba(0x17e)](this[_0x5428ba(0x12a)][_0x5428ba(0x147)])?(_0x501e4f=!![],await fs_internal_1['FS'][_0x5428ba(0x149)]((0x0,path_1[_0x5428ba(0x134)])(this[_0x5428ba(0x12a)][_0x5428ba(0x147)],_0x5428ba(0x124)))):(_0x501e4f&&(!_0x4bd564&&(_0x501e4f=![])),await this[_0x5428ba(0x12a)][_0x5428ba(0x184)]());_0x501e4f?(await this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this[_0x5428ba(0x169)]+_0x5428ba(0x180))[_0x5428ba(0x12b)](),await this[_0x5428ba(0x139)][_0x5428ba(0x13f)](this['mdapiUtils'][_0x5428ba(0x147)]),await this[_0x5428ba(0x139)][_0x5428ba(0x156)](this[_0x5428ba(0x12a)][_0x5428ba(0x147)],!_0x4bd564),await this['sfdxUtils'][_0x5428ba(0x149)]()):(await this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this[_0x5428ba(0x169)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x5428ba(0x12b)](),await this['mdapiUtils'][_0x5428ba(0x120)](this[_0x5428ba(0x12a)][_0x5428ba(0x147)]));await this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this['prefix']+_0x5428ba(0x129))[_0x5428ba(0x12b)](),await this[_0x5428ba(0x12a)]['commitAndPush'](_0x2caf2e,{'email':constants_1[_0x5428ba(0x11a)],'name':_0x515853[_0x5428ba(0x14b)]},_0xb2afb3[_0x5428ba(0x14b)]),await this[_0x5428ba(0x12a)][_0x5428ba(0x149)](),await this[_0x5428ba(0x154)][_0x5428ba(0x149)]();const _0x1eb766=this[_0x5428ba(0x128)]+this['componentsToDelete'];await this[_0x5428ba(0x175)][_0x5428ba(0x18c)](this[_0x5428ba(0x169)]+_0x5428ba(0x116)+(Date[_0x5428ba(0x17d)]()-this['startTime'])+_0x5428ba(0x159)+_0x1eb766+'.')['send']();}catch(_0xcbb6d){await this[_0x5428ba(0x13c)](),await this[_0x5428ba(0x175)][_0x5428ba(0x14d)](this[_0x5428ba(0x169)]+'\x20'+_0xcbb6d)[_0x5428ba(0x12b)]();throw _0xcbb6d;}}async[a104_0x401796(0x118)](_0x1d669f,_0x3e345f){const _0x2f9dd8=a104_0x401796;var _0xa60b1f,_0x232bec;this[_0x2f9dd8(0x175)]=typedi_1['default'][_0x2f9dd8(0x168)](providers_tokens_1[_0x2f9dd8(0x125)][_0x2f9dd8(0x136)]),this['prefix']=(_0x3e345f?_0x3e345f+'\x20':'')+'['+commit_components_dto_1[_0x2f9dd8(0x144)][_0x2f9dd8(0x14b)]+']',await this['sfLogger'][_0x2f9dd8(0x18c)](this[_0x2f9dd8(0x169)]+_0x2f9dd8(0x12d));const _0x59e1e3=!!((_0xa60b1f=_0x1d669f[_0x2f9dd8(0x137)])===null||_0xa60b1f===void 0x0?void 0x0:_0xa60b1f['writed'])||!!((_0x232bec=_0x1d669f['components'])===null||_0x232bec===void 0x0?void 0x0:_0x232bec[_0x2f9dd8(0x179)]);if(!_0x59e1e3){await this[_0x2f9dd8(0x175)][_0x2f9dd8(0x18c)](this[_0x2f9dd8(0x169)]+_0x2f9dd8(0x181))[_0x2f9dd8(0x12b)]();return;}this['commitData']=_0x1d669f,await this['exec']();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x401796(0x138)])({'transient':!![]})],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;