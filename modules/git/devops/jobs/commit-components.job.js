const a73_0x48ba28=a73_0xffd5;(function(_0x4dca4a,_0x2b1677){const _0x1a36ba=a73_0xffd5,_0x7bf2d6=_0x4dca4a();while(!![]){try{const _0x41f853=parseInt(_0x1a36ba(0x167))/0x1*(-parseInt(_0x1a36ba(0x16c))/0x2)+parseInt(_0x1a36ba(0x175))/0x3+parseInt(_0x1a36ba(0x197))/0x4*(-parseInt(_0x1a36ba(0x1b8))/0x5)+-parseInt(_0x1a36ba(0x18e))/0x6+-parseInt(_0x1a36ba(0x183))/0x7*(-parseInt(_0x1a36ba(0x154))/0x8)+parseInt(_0x1a36ba(0x18c))/0x9+parseInt(_0x1a36ba(0x163))/0xa*(parseInt(_0x1a36ba(0x1b3))/0xb);if(_0x41f853===_0x2b1677)break;else _0x7bf2d6['push'](_0x7bf2d6['shift']());}catch(_0x2023b6){_0x7bf2d6['push'](_0x7bf2d6['shift']());}}}(a73_0xfed7,0x8ac7b));const a73_0x3181c6=(function(){let _0x2ca8d8=!![];return function(_0x4ff4ab,_0x3d4197){const _0xfe5a98=_0x2ca8d8?function(){const _0x497a69=a73_0xffd5;if(_0x3d4197){const _0x5dba86=_0x3d4197[_0x497a69(0x173)](_0x4ff4ab,arguments);return _0x3d4197=null,_0x5dba86;}}:function(){};return _0x2ca8d8=![],_0xfe5a98;};}()),a73_0x595151=a73_0x3181c6(this,function(){const _0x334eca=a73_0xffd5;return a73_0x595151[_0x334eca(0x17e)]()[_0x334eca(0x18f)](_0x334eca(0x186))[_0x334eca(0x17e)]()[_0x334eca(0x156)](a73_0x595151)[_0x334eca(0x18f)]('(((.+)+)+)+$');});function a73_0xfed7(){const _0x4e841a=['get','__createBinding','default','log','removeDir','writed','gitUtils','toString','../utils/sfdx.utils','../../parsers/data/child-types','send','name','6209UhNRiY','../utils/git.utils','componentsToDelete','(((.+)+)+)+$','commitData','componentsToWrite','SFDXUtils','__importStar','\x20Checking\x20deleted\x20components.','322200bInKiQ','exec','2814924HlKkvu','search','isLoggedIn','Bitbucket','SFDX','../../internal/fs.internal','master','values','object','108QcCioK','../../salesforce/utils/sfdx.utils','getProtocol','GitUtils','run','credentials','mdapiUtils','CommitComponentsDto','splice','function','getRemote','\x20components','commitAndPush','prepareMdapi','GitProvider','now','../dto/commit-components.dto','removeComponents','../../../shared/utils','force-app','sfLogger','createProjectFrom','sort','sfdxUtils','__decorate','branch','CommitComponentsJob','cleanUp','242teZeXJ','writeComponents','startTime','\x20Checking\x20commit\x20components.','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','124140udBkbl','\x20Deleted\x20','ms.\x20Committed\x20components\x20-\x20','length','__esModule','dir','isEmptyDir','logger','prefix','isSFDXProject','copyMdapiTo','decorate','\x20Nothing\x20to\x20commit.\x20Skip.','\x20Wrote\x20','components','gitUrl','\x20Preparing\x20to\x20delete\x20components','deleted','8800wnhXyC','defineProperty','constructor','COMPONENTS_PER_TICK','fileName','provider','__importDefault','catch','__setModuleDefault','writable','\x20Start\x20converting\x20to\x20SFDX.','://','\x20Prepare\x20mdapi\x20files.','call','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','525020ifeLJd','getOwnPropertyDescriptor','Tokens','prototype','5611cSVKoz','\x20Checking\x20written\x20components.','groupComponentsByFileName','includes','../../providers/types/git-provider','286nsosgJ','clone','copyProjectTo','reduce','../../providers/api/bitbucket-api.service','hasOwnProperty','../utils/mdapi.utils','apply','create','1031346BxwKQz','clearDir'];a73_0xfed7=function(){return _0x4e841a;};return a73_0xfed7();}a73_0x595151();'use strict';var __createBinding=this&&this[a73_0x48ba28(0x178)]||(Object[a73_0x48ba28(0x174)]?function(_0x4e4d3a,_0x49d0b7,_0x49dd31,_0x47dce4){const _0x58d30c=a73_0x48ba28;if(_0x47dce4===undefined)_0x47dce4=_0x49dd31;var _0x5b2921=Object[_0x58d30c(0x164)](_0x49d0b7,_0x49dd31);(!_0x5b2921||('get'in _0x5b2921?!_0x49d0b7['__esModule']:_0x5b2921[_0x58d30c(0x15d)]||_0x5b2921['configurable']))&&(_0x5b2921={'enumerable':!![],'get':function(){return _0x49d0b7[_0x49dd31];}}),Object[_0x58d30c(0x155)](_0x4e4d3a,_0x47dce4,_0x5b2921);}:function(_0x496864,_0x597c4d,_0x4968e2,_0x25f331){if(_0x25f331===undefined)_0x25f331=_0x4968e2;_0x496864[_0x25f331]=_0x597c4d[_0x4968e2];}),__setModuleDefault=this&&this[a73_0x48ba28(0x15c)]||(Object['create']?function(_0x4ffd95,_0x1304c4){const _0x19bc64=a73_0x48ba28;Object[_0x19bc64(0x155)](_0x4ffd95,_0x19bc64(0x179),{'enumerable':!![],'value':_0x1304c4});}:function(_0x484fb4,_0x425796){const _0x14e632=a73_0x48ba28;_0x484fb4[_0x14e632(0x179)]=_0x425796;}),__decorate=this&&this[a73_0x48ba28(0x1af)]||function(_0x34f771,_0x984340,_0x698ef1,_0x38b391){const _0x357ae4=a73_0x48ba28;var _0x37c23d=arguments['length'],_0x355e71=_0x37c23d<0x3?_0x984340:_0x38b391===null?_0x38b391=Object[_0x357ae4(0x164)](_0x984340,_0x698ef1):_0x38b391,_0x2d12d4;if(typeof Reflect===_0x357ae4(0x196)&&typeof Reflect['decorate']===_0x357ae4(0x1a0))_0x355e71=Reflect[_0x357ae4(0x14d)](_0x34f771,_0x984340,_0x698ef1,_0x38b391);else{for(var _0x465a0d=_0x34f771[_0x357ae4(0x1bb)]-0x1;_0x465a0d>=0x0;_0x465a0d--)if(_0x2d12d4=_0x34f771[_0x465a0d])_0x355e71=(_0x37c23d<0x3?_0x2d12d4(_0x355e71):_0x37c23d>0x3?_0x2d12d4(_0x984340,_0x698ef1,_0x355e71):_0x2d12d4(_0x984340,_0x698ef1))||_0x355e71;}return _0x37c23d>0x3&&_0x355e71&&Object[_0x357ae4(0x155)](_0x984340,_0x698ef1,_0x355e71),_0x355e71;},__importStar=this&&this[a73_0x48ba28(0x18a)]||function(_0x1c9033){const _0x2dafec=a73_0x48ba28;if(_0x1c9033&&_0x1c9033[_0x2dafec(0x1bc)])return _0x1c9033;var _0x5c6e7c={};if(_0x1c9033!=null){for(var _0x3c8f8f in _0x1c9033)if(_0x3c8f8f!==_0x2dafec(0x179)&&Object[_0x2dafec(0x166)][_0x2dafec(0x171)][_0x2dafec(0x161)](_0x1c9033,_0x3c8f8f))__createBinding(_0x5c6e7c,_0x1c9033,_0x3c8f8f);}return __setModuleDefault(_0x5c6e7c,_0x1c9033),_0x5c6e7c;},__importDefault=this&&this[a73_0x48ba28(0x15a)]||function(_0x1c2597){const _0x259e9=a73_0x48ba28;return _0x1c2597&&_0x1c2597[_0x259e9(0x1bc)]?_0x1c2597:{'default':_0x1c2597};};Object[a73_0x48ba28(0x155)](exports,'__esModule',{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require(a73_0x48ba28(0x1a7)),events_1=__importDefault(require('events')),git_utils_1=require(a73_0x48ba28(0x184)),mdapi_utils_1=require(a73_0x48ba28(0x172)),sfdx_utils_1=require(a73_0x48ba28(0x17f)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a73_0x48ba28(0x180))),utils_1=require(a73_0x48ba28(0x1a9)),constants_1=require('../../../../constants'),git_provider_1=require(a73_0x48ba28(0x16b)),bitbucket_api_service_1=require(a73_0x48ba28(0x170)),sfdx_utils_2=require(a73_0x48ba28(0x198)),fs_internal_1=require(a73_0x48ba28(0x193)),path_1=require('path'),providers_tokens_1=require('../../providers/providers.tokens');function a73_0xffd5(_0x17aafd,_0x58a467){const _0x1a5be0=a73_0xfed7();return a73_0xffd5=function(_0x595151,_0x3181c6){_0x595151=_0x595151-0x14a;let _0xfed779=_0x1a5be0[_0x595151];return _0xfed779;},a73_0xffd5(_0x17aafd,_0x58a467);}let CommitComponentsJob=class CommitComponentsJob extends events_1[a73_0x48ba28(0x179)]{constructor(){const _0x357262=a73_0x48ba28;super(...arguments),this[_0x357262(0x157)]=0x3e8,this[_0x357262(0x188)]=0x0,this[_0x357262(0x185)]=0x0,this['startTime']=Date['now']();}async[a73_0x48ba28(0x1a1)](){const _0x2d0a5c=a73_0x48ba28,{repo:_0x589402}=this[_0x2d0a5c(0x187)],_0x2cae54=typedi_1[_0x2d0a5c(0x179)][_0x2d0a5c(0x177)](providers_tokens_1[_0x2d0a5c(0x165)][_0x2d0a5c(0x19c)]);if(this[_0x2d0a5c(0x187)][_0x2d0a5c(0x159)]===git_provider_1[_0x2d0a5c(0x1a5)][_0x2d0a5c(0x191)]){const _0x7336ab=typedi_1[_0x2d0a5c(0x179)][_0x2d0a5c(0x177)](bitbucket_api_service_1['BitbucketApiService']);await _0x7336ab[_0x2d0a5c(0x190)]();}return _0x589402[_0x2d0a5c(0x151)]['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x2d0a5c(0x199)])(_0x589402['gitUrl'])+_0x2d0a5c(0x15f)+_0x2cae54['getGitShellAuthorizationString']()+'@');}[a73_0x48ba28(0x169)](_0x5169d5){const _0x20bb22=a73_0x48ba28;var _0x45dad0;_0x5169d5[_0x20bb22(0x1ad)](_0x445af7=>child_types_1[_0x20bb22(0x179)][_0x20bb22(0x16a)](_0x445af7['fileType'])?0x1:-0x1);const _0x558306={};for(const _0x10c529 of _0x5169d5){_0x558306[_0x45dad0=_0x10c529[_0x20bb22(0x158)]]||(_0x558306[_0x45dad0]=[]),_0x558306[_0x10c529[_0x20bb22(0x158)]]['push'](_0x10c529);}return Object[_0x20bb22(0x195)](_0x558306)[_0x20bb22(0x16f)]((_0x3377e7,_0x2daaed)=>[..._0x3377e7,..._0x2daaed],[]);}async['writeComponents'](_0x16f033){const _0x3993e0=a73_0x48ba28;_0x16f033=this[_0x3993e0(0x169)](_0x16f033);let _0x75eafb=0x0;while(_0x16f033[_0x3993e0(0x1bb)]){const _0x49b630=_0x16f033[_0x3993e0(0x19f)](0x0,this[_0x3993e0(0x157)]);await this['mdapiUtils']['writeFlosumComponents'](_0x49b630,{'skipChildErrors':this['commitData'][_0x3993e0(0x1b0)][_0x3993e0(0x182)]===_0x3993e0(0x194)}),_0x75eafb+=_0x49b630[_0x3993e0(0x1bb)],this[_0x3993e0(0x1ab)][_0x3993e0(0x17a)](this[_0x3993e0(0x14a)]+_0x3993e0(0x14f)+_0x75eafb+'/'+this['componentsToWrite']+_0x3993e0(0x1a2)),await this[_0x3993e0(0x1ab)][_0x3993e0(0x181)]();}}async[a73_0x48ba28(0x1a8)](_0x1984f3){const _0x1e8570=a73_0x48ba28;_0x1984f3['sort'](_0x54358a=>child_types_1[_0x1e8570(0x179)][_0x1e8570(0x16a)](_0x54358a['type'])?-0x1:0x1);let _0x3c87c1=0x0;while(_0x1984f3[_0x1e8570(0x1bb)]){const _0x256b08=_0x1984f3[_0x1e8570(0x19f)](0x0,this[_0x1e8570(0x157)]);await this['mdapiUtils'][_0x1e8570(0x1a8)](_0x256b08),_0x3c87c1+=_0x256b08['length'],this[_0x1e8570(0x1ab)][_0x1e8570(0x17a)](this[_0x1e8570(0x14a)]+_0x1e8570(0x1b9)+_0x3c87c1+'/'+this[_0x1e8570(0x185)]+_0x1e8570(0x1a2)),await this[_0x1e8570(0x1ab)][_0x1e8570(0x181)]();}}async[a73_0x48ba28(0x1b2)](){const _0x2cefcf=a73_0x48ba28;this[_0x2cefcf(0x17d)]&&await this[_0x2cefcf(0x17d)][_0x2cefcf(0x17b)]()['catch'](()=>void 0x0),this['mdapiUtils']&&await this['mdapiUtils'][_0x2cefcf(0x17b)]()['catch'](()=>void 0x0),this[_0x2cefcf(0x1ae)]&&await this[_0x2cefcf(0x1ae)][_0x2cefcf(0x17b)]()[_0x2cefcf(0x15b)](()=>void 0x0);}async[a73_0x48ba28(0x18d)](){const _0x4d5cc2=a73_0x48ba28,{repo:_0x57e058,branch:_0x308e1e,components:_0x459550,convertToSFDX:_0x42554f,message:_0xf51ed5,user:_0x417167}=this['commitData'];this[_0x4d5cc2(0x19d)]=new mdapi_utils_1['MDApiUtils'](),this[_0x4d5cc2(0x17d)]=new git_utils_1[(_0x4d5cc2(0x19a))](await this['getRemote']()),this[_0x4d5cc2(0x1ae)]=new sfdx_utils_1[(_0x4d5cc2(0x189))]();let _0x1cdbc8=_0x42554f;try{await this[_0x4d5cc2(0x1ab)][_0x4d5cc2(0x17a)](this['prefix']+'\x20Start\x20cloning\x20repository.')[_0x4d5cc2(0x181)](),await this[_0x4d5cc2(0x17d)][_0x4d5cc2(0x16d)](_0x308e1e[_0x4d5cc2(0x182)],_0x57e058[_0x4d5cc2(0x182)]);!this[_0x4d5cc2(0x187)]['force']?(this[_0x4d5cc2(0x1ab)]['log'](this['prefix']+_0x4d5cc2(0x160)),await this[_0x4d5cc2(0x19d)][_0x4d5cc2(0x1a4)](this['gitUtils'][_0x4d5cc2(0x1bd)])):this[_0x4d5cc2(0x1ab)][_0x4d5cc2(0x17a)](this[_0x4d5cc2(0x14a)]+_0x4d5cc2(0x1b7));await this['sfLogger'][_0x4d5cc2(0x17a)](this[_0x4d5cc2(0x14a)]+_0x4d5cc2(0x168))[_0x4d5cc2(0x181)]();_0x459550[_0x4d5cc2(0x17c)]&&(this[_0x4d5cc2(0x1ab)][_0x4d5cc2(0x17a)](this[_0x4d5cc2(0x14a)]+'\x20Preparing\x20to\x20write\x20components'),this[_0x4d5cc2(0x188)]=_0x459550[_0x4d5cc2(0x17c)]['length'],await this[_0x4d5cc2(0x1b4)](_0x459550[_0x4d5cc2(0x17c)]),await this[_0x4d5cc2(0x1ab)][_0x4d5cc2(0x181)]());await this[_0x4d5cc2(0x1ab)][_0x4d5cc2(0x17a)](this[_0x4d5cc2(0x14a)]+_0x4d5cc2(0x18b))[_0x4d5cc2(0x181)]();_0x459550[_0x4d5cc2(0x153)]&&(this[_0x4d5cc2(0x1ab)][_0x4d5cc2(0x17a)](this[_0x4d5cc2(0x14a)]+_0x4d5cc2(0x152)),this[_0x4d5cc2(0x185)]=_0x459550[_0x4d5cc2(0x153)][_0x4d5cc2(0x1bb)],await this[_0x4d5cc2(0x1a8)](_0x459550['deleted']),await this['sfLogger']['send']());await this[_0x4d5cc2(0x1ab)]['send']();const _0x291625=await fs_internal_1['FS'][_0x4d5cc2(0x1be)](this['gitUtils'][_0x4d5cc2(0x1bd)]);await sfdx_utils_2[_0x4d5cc2(0x192)][_0x4d5cc2(0x14b)](this[_0x4d5cc2(0x17d)]['dir'])?(_0x1cdbc8=!![],await fs_internal_1['FS'][_0x4d5cc2(0x17b)]((0x0,path_1['join'])(this['gitUtils'][_0x4d5cc2(0x1bd)],_0x4d5cc2(0x1aa)))):(_0x1cdbc8&&(!_0x291625&&(_0x1cdbc8=![])),await this[_0x4d5cc2(0x17d)][_0x4d5cc2(0x176)]());_0x1cdbc8?(await this[_0x4d5cc2(0x1ab)]['log'](this[_0x4d5cc2(0x14a)]+_0x4d5cc2(0x15e))[_0x4d5cc2(0x181)](),await this[_0x4d5cc2(0x1ae)][_0x4d5cc2(0x1ac)](this[_0x4d5cc2(0x19d)][_0x4d5cc2(0x1bd)]),await this['sfdxUtils'][_0x4d5cc2(0x16e)](this[_0x4d5cc2(0x17d)][_0x4d5cc2(0x1bd)],!_0x291625),await this[_0x4d5cc2(0x1ae)][_0x4d5cc2(0x17b)]()):(await this[_0x4d5cc2(0x1ab)][_0x4d5cc2(0x17a)](this[_0x4d5cc2(0x14a)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x4d5cc2(0x181)](),await this[_0x4d5cc2(0x19d)][_0x4d5cc2(0x14c)](this[_0x4d5cc2(0x17d)][_0x4d5cc2(0x1bd)]));await this[_0x4d5cc2(0x1ab)]['log'](this[_0x4d5cc2(0x14a)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')['send'](),await this['gitUtils'][_0x4d5cc2(0x1a3)](_0xf51ed5,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x417167[_0x4d5cc2(0x182)]},_0x308e1e[_0x4d5cc2(0x182)]),await this[_0x4d5cc2(0x17d)][_0x4d5cc2(0x17b)](),await this[_0x4d5cc2(0x19d)][_0x4d5cc2(0x17b)]();const _0xd9c21e=this['componentsToWrite']+this[_0x4d5cc2(0x185)];await this[_0x4d5cc2(0x1ab)]['log'](this[_0x4d5cc2(0x14a)]+_0x4d5cc2(0x162)+(Date[_0x4d5cc2(0x1a6)]()-this[_0x4d5cc2(0x1b5)])+_0x4d5cc2(0x1ba)+_0xd9c21e+'.')[_0x4d5cc2(0x181)]();}catch(_0xd73266){await this['cleanUp'](),await this[_0x4d5cc2(0x1ab)]['error'](this[_0x4d5cc2(0x14a)]+'\x20'+_0xd73266)[_0x4d5cc2(0x181)]();throw _0xd73266;}}async[a73_0x48ba28(0x19b)](_0x2679f8,_0xe8f28e){const _0x26b575=a73_0x48ba28;var _0x10d416,_0x5b34e6;this[_0x26b575(0x1ab)]=typedi_1[_0x26b575(0x179)][_0x26b575(0x177)](providers_tokens_1[_0x26b575(0x165)][_0x26b575(0x1bf)]),this[_0x26b575(0x14a)]=(_0xe8f28e?_0xe8f28e+'\x20':'')+'['+commit_components_dto_1[_0x26b575(0x19e)][_0x26b575(0x182)]+']',await this[_0x26b575(0x1ab)][_0x26b575(0x17a)](this[_0x26b575(0x14a)]+_0x26b575(0x1b6));const _0x41cc31=!!((_0x10d416=_0x2679f8[_0x26b575(0x150)])===null||_0x10d416===void 0x0?void 0x0:_0x10d416['writed'])||!!((_0x5b34e6=_0x2679f8['components'])===null||_0x5b34e6===void 0x0?void 0x0:_0x5b34e6['deleted']);if(!_0x41cc31){await this[_0x26b575(0x1ab)]['log'](this[_0x26b575(0x14a)]+_0x26b575(0x14e))['send']();return;}this['commitData']=_0x2679f8,await this[_0x26b575(0x18d)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a73_0x48ba28(0x1b1)]=CommitComponentsJob;