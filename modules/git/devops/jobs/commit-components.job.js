const a104_0x1850e9=a104_0x3721;function a104_0x3721(_0x5cfe7b,_0x5cc83c){const _0x4f8fa6=a104_0xbb2b();return a104_0x3721=function(_0x101cd9,_0x179fde){_0x101cd9=_0x101cd9-0x67;let _0xbb2b68=_0x4f8fa6[_0x101cd9];return _0xbb2b68;},a104_0x3721(_0x5cfe7b,_0x5cc83c);}(function(_0x4f6c16,_0x21331e){const _0x126e05=a104_0x3721,_0x20d5e6=_0x4f6c16();while(!![]){try{const _0x36a877=parseInt(_0x126e05(0x7a))/0x1*(-parseInt(_0x126e05(0xae))/0x2)+-parseInt(_0x126e05(0xca))/0x3+-parseInt(_0x126e05(0xd4))/0x4*(-parseInt(_0x126e05(0x70))/0x5)+parseInt(_0x126e05(0xa1))/0x6+parseInt(_0x126e05(0x9c))/0x7*(parseInt(_0x126e05(0x68))/0x8)+parseInt(_0x126e05(0xbf))/0x9*(parseInt(_0x126e05(0x74))/0xa)+-parseInt(_0x126e05(0xc3))/0xb*(parseInt(_0x126e05(0x6e))/0xc);if(_0x36a877===_0x21331e)break;else _0x20d5e6['push'](_0x20d5e6['shift']());}catch(_0xa6d2bc){_0x20d5e6['push'](_0x20d5e6['shift']());}}}(a104_0xbb2b,0x6e612));const a104_0x179fde=(function(){let _0x62e5a1=!![];return function(_0x5cb638,_0x51b265){const _0x29de2d=_0x62e5a1?function(){const _0x5aef1b=a104_0x3721;if(_0x51b265){const _0x37005c=_0x51b265[_0x5aef1b(0x9e)](_0x5cb638,arguments);return _0x51b265=null,_0x37005c;}}:function(){};return _0x62e5a1=![],_0x29de2d;};}()),a104_0x101cd9=a104_0x179fde(this,function(){const _0x5ac4be=a104_0x3721;return a104_0x101cd9[_0x5ac4be(0xc6)]()[_0x5ac4be(0x79)](_0x5ac4be(0x84))[_0x5ac4be(0xc6)]()[_0x5ac4be(0xbd)](a104_0x101cd9)[_0x5ac4be(0x79)](_0x5ac4be(0x84));});a104_0x101cd9();'use strict';var __createBinding=this&&this[a104_0x1850e9(0xbb)]||(Object[a104_0x1850e9(0x93)]?function(_0x4b28cc,_0x4579cd,_0xd1a38f,_0x3b7a2b){const _0x237702=a104_0x1850e9;if(_0x3b7a2b===undefined)_0x3b7a2b=_0xd1a38f;var _0x8b31b1=Object[_0x237702(0xaa)](_0x4579cd,_0xd1a38f);(!_0x8b31b1||(_0x237702(0xbe)in _0x8b31b1?!_0x4579cd[_0x237702(0x9f)]:_0x8b31b1[_0x237702(0xd5)]||_0x8b31b1[_0x237702(0x6a)]))&&(_0x8b31b1={'enumerable':!![],'get':function(){return _0x4579cd[_0xd1a38f];}}),Object[_0x237702(0x7e)](_0x4b28cc,_0x3b7a2b,_0x8b31b1);}:function(_0x253b50,_0x48c6b6,_0xd5ed40,_0x1b57a6){if(_0x1b57a6===undefined)_0x1b57a6=_0xd5ed40;_0x253b50[_0x1b57a6]=_0x48c6b6[_0xd5ed40];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a104_0x1850e9(0x93)]?function(_0x2de604,_0x5f306c){const _0x1e28ff=a104_0x1850e9;Object[_0x1e28ff(0x7e)](_0x2de604,_0x1e28ff(0xc8),{'enumerable':!![],'value':_0x5f306c});}:function(_0x2d67bd,_0x2c7e5a){_0x2d67bd['default']=_0x2c7e5a;}),__decorate=this&&this[a104_0x1850e9(0xa2)]||function(_0x52584d,_0x37d886,_0x42a612,_0x2fd1bf){const _0x1b3c4e=a104_0x1850e9;var _0x25d220=arguments['length'],_0x57935a=_0x25d220<0x3?_0x37d886:_0x2fd1bf===null?_0x2fd1bf=Object['getOwnPropertyDescriptor'](_0x37d886,_0x42a612):_0x2fd1bf,_0x408027;if(typeof Reflect===_0x1b3c4e(0x99)&&typeof Reflect[_0x1b3c4e(0x83)]==='function')_0x57935a=Reflect[_0x1b3c4e(0x83)](_0x52584d,_0x37d886,_0x42a612,_0x2fd1bf);else{for(var _0x2b6e11=_0x52584d[_0x1b3c4e(0xd1)]-0x1;_0x2b6e11>=0x0;_0x2b6e11--)if(_0x408027=_0x52584d[_0x2b6e11])_0x57935a=(_0x25d220<0x3?_0x408027(_0x57935a):_0x25d220>0x3?_0x408027(_0x37d886,_0x42a612,_0x57935a):_0x408027(_0x37d886,_0x42a612))||_0x57935a;}return _0x25d220>0x3&&_0x57935a&&Object[_0x1b3c4e(0x7e)](_0x37d886,_0x42a612,_0x57935a),_0x57935a;},__importStar=this&&this[a104_0x1850e9(0xb3)]||function(_0x1182ee){const _0x3bcbd3=a104_0x1850e9;if(_0x1182ee&&_0x1182ee[_0x3bcbd3(0x9f)])return _0x1182ee;var _0x58ac28={};if(_0x1182ee!=null){for(var _0x4b8455 in _0x1182ee)if(_0x4b8455!==_0x3bcbd3(0xc8)&&Object[_0x3bcbd3(0xcd)]['hasOwnProperty']['call'](_0x1182ee,_0x4b8455))__createBinding(_0x58ac28,_0x1182ee,_0x4b8455);}return __setModuleDefault(_0x58ac28,_0x1182ee),_0x58ac28;},__importDefault=this&&this[a104_0x1850e9(0xb0)]||function(_0x417ff5){return _0x417ff5&&_0x417ff5['__esModule']?_0x417ff5:{'default':_0x417ff5};};Object[a104_0x1850e9(0x7e)](exports,'__esModule',{'value':!![]}),exports[a104_0x1850e9(0xb4)]=void 0x0;function a104_0xbb2b(){const _0x4b49fe=['now','object','\x20Checking\x20written\x20components.','../../parsers/data/child-types','7IhzGyc','master','apply','__esModule','SFDXUtils','3985230luVnVN','__decorate','name','createProjectFrom','prefix','commitAndPush','sfLogger','gitUtils','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','getOwnPropertyDescriptor','dir','copyMdapiTo','run','2GULgPS','force','__importDefault','getProtocol','sort','__importStar','CommitComponentsJob','../../providers/api/bitbucket-api.service','catch','Bitbucket','getRemote','../../../../constants','\x20Checking\x20deleted\x20components.','__createBinding','gitUrl','constructor','get','27EdFMFI','CommitComponentsDto','\x20Start\x20cloning\x20repository.','fileName','275HIAbkF','copyProjectTo','force-app','toString','\x20components','default','startTime','1577184LQlewl','\x20Nothing\x20to\x20commit.\x20Skip.','FORCE_APP_DEFAULT_DIR','prototype','../../providers/types/git-provider','splice','\x20Start\x20converting\x20to\x20SFDX.','length','writeComponents','Tokens','2124dEztVW','writable','path','log','../../../shared/utils','1369048ZBgogW','mdapiUtils','configurable','prepareMdapi','writeFlosumComponents','includes','295692ynCAaO','../utils/git.utils','8055FOgzOE','credentials','fileType','removeDir','353890rFBMsV','reduce','../utils/sfdx.utils','Service','deleted','search','203077pcFiev','sfdxUtils','\x20Preparing\x20to\x20delete\x20components','cleanUp','defineProperty','../../internal/fs.internal','send','components','clone','decorate','(((.+)+)+)+$','getGitShellAuthorizationString','://','type','writed','exec','commitData','COMPONENTS_PER_TICK','removeComponents','push','branch','DEFAULT_GIT_USER_EMAIL','values','../utils/mdapi.utils','componentsToDelete','create','copyVlocityComponents','groupComponentsByFileName','../../providers/providers.tokens','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.'];a104_0xbb2b=function(){return _0x4b49fe;};return a104_0xbb2b();}const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require('events')),git_utils_1=require(a104_0x1850e9(0x6f)),mdapi_utils_1=require(a104_0x1850e9(0x91)),sfdx_utils_1=require(a104_0x1850e9(0x76)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a104_0x1850e9(0x9b))),utils_1=require(a104_0x1850e9(0x67)),constants_1=require('../../../../constants'),git_provider_1=require(a104_0x1850e9(0xce)),bitbucket_api_service_1=require(a104_0x1850e9(0xb5)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a104_0x1850e9(0x7f)),path_1=require(a104_0x1850e9(0xd6)),providers_tokens_1=require(a104_0x1850e9(0x96)),constants_2=require(a104_0x1850e9(0xb9));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x1850e9(0xc8)]{constructor(){const _0x1b5210=a104_0x1850e9;super(...arguments),this[_0x1b5210(0x8b)]=0x3e8,this['componentsToWrite']=0x0,this[_0x1b5210(0x92)]=0x0,this[_0x1b5210(0xc9)]=Date['now']();}async[a104_0x1850e9(0xb8)](){const _0x3ff5e3=a104_0x1850e9,{repo:_0x29e517}=this['commitData'],_0x36c97c=typedi_1['default'][_0x3ff5e3(0xbe)](providers_tokens_1[_0x3ff5e3(0xd3)][_0x3ff5e3(0x71)]);if(this[_0x3ff5e3(0x8a)]['provider']===git_provider_1['GitProvider'][_0x3ff5e3(0xb7)]){const _0x48768b=typedi_1[_0x3ff5e3(0xc8)][_0x3ff5e3(0xbe)](bitbucket_api_service_1['BitbucketApiService']);await _0x48768b['isLoggedIn']();}return _0x29e517[_0x3ff5e3(0xbc)]['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x3ff5e3(0xb1)])(_0x29e517['gitUrl'])+_0x3ff5e3(0x86)+_0x36c97c[_0x3ff5e3(0x85)]()+'@');}[a104_0x1850e9(0x95)](_0x5b87de){const _0x3efdbe=a104_0x1850e9;var _0x58f5de;_0x5b87de['sort'](_0x44d3fa=>child_types_1[_0x3efdbe(0xc8)][_0x3efdbe(0x6d)](_0x44d3fa[_0x3efdbe(0x72)])?0x1:-0x1);const _0xf4ec50={};for(const _0x17672c of _0x5b87de){_0xf4ec50[_0x58f5de=_0x17672c[_0x3efdbe(0xc2)]]||(_0xf4ec50[_0x58f5de]=[]),_0xf4ec50[_0x17672c[_0x3efdbe(0xc2)]][_0x3efdbe(0x8d)](_0x17672c);}return Object[_0x3efdbe(0x90)](_0xf4ec50)[_0x3efdbe(0x75)]((_0x270437,_0x114de0)=>[..._0x270437,..._0x114de0],[]);}async[a104_0x1850e9(0xd2)](_0x511ea7){const _0x3601af=a104_0x1850e9;_0x511ea7=this['groupComponentsByFileName'](_0x511ea7);let _0x4e0f92=0x0;while(_0x511ea7[_0x3601af(0xd1)]){const _0x3dd244=_0x511ea7[_0x3601af(0xcf)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x3601af(0x69)][_0x3601af(0x6c)](_0x3dd244,{'skipChildErrors':this[_0x3601af(0x8a)][_0x3601af(0x8e)][_0x3601af(0xa3)]===_0x3601af(0x9d)}),_0x4e0f92+=_0x3dd244[_0x3601af(0xd1)],this[_0x3601af(0xa7)]['log'](this['prefix']+'\x20Wrote\x20'+_0x4e0f92+'/'+this['componentsToWrite']+_0x3601af(0xc7)),await this[_0x3601af(0xa7)][_0x3601af(0x80)]();}}async[a104_0x1850e9(0x8c)](_0xc73b0d){const _0x4d6254=a104_0x1850e9;_0xc73b0d[_0x4d6254(0xb2)](_0x2f7eba=>child_types_1[_0x4d6254(0xc8)]['includes'](_0x2f7eba[_0x4d6254(0x87)])?-0x1:0x1);let _0x432d8c=0x0;while(_0xc73b0d[_0x4d6254(0xd1)]){const _0x453844=_0xc73b0d['splice'](0x0,this[_0x4d6254(0x8b)]);await this[_0x4d6254(0x69)][_0x4d6254(0x8c)](_0x453844),_0x432d8c+=_0x453844[_0x4d6254(0xd1)],this[_0x4d6254(0xa7)][_0x4d6254(0xd7)](this[_0x4d6254(0xa5)]+'\x20Deleted\x20'+_0x432d8c+'/'+this[_0x4d6254(0x92)]+_0x4d6254(0xc7)),await this['sfLogger']['send']();}}async[a104_0x1850e9(0x7d)](){const _0x2eb495=a104_0x1850e9;this[_0x2eb495(0xa8)]&&await this[_0x2eb495(0xa8)][_0x2eb495(0x73)]()[_0x2eb495(0xb6)](()=>void 0x0),this['mdapiUtils']&&await this['mdapiUtils'][_0x2eb495(0x73)]()[_0x2eb495(0xb6)](()=>void 0x0),this[_0x2eb495(0x7b)]&&await this[_0x2eb495(0x7b)][_0x2eb495(0x73)]()[_0x2eb495(0xb6)](()=>void 0x0);}async[a104_0x1850e9(0x89)](){const _0x136378=a104_0x1850e9,{repo:_0x14ecf8,branch:_0x4d3b5e,components:_0x7a4d90,convertToSFDX:_0xecdf2d,message:_0x542ecd,user:_0x1b09ea}=this[_0x136378(0x8a)];this['mdapiUtils']=new mdapi_utils_1['MDApiUtils'](),this[_0x136378(0xa8)]=new git_utils_1['GitUtils'](await this[_0x136378(0xb8)]()),this[_0x136378(0x7b)]=new sfdx_utils_1[(_0x136378(0xa0))]();let _0x9601de=_0xecdf2d;try{await this[_0x136378(0xa7)]['log'](this[_0x136378(0xa5)]+_0x136378(0xc1))[_0x136378(0x80)](),await this[_0x136378(0xa8)][_0x136378(0x82)](_0x4d3b5e[_0x136378(0xa3)],_0x14ecf8[_0x136378(0xa3)]);!this['commitData'][_0x136378(0xaf)]?(this[_0x136378(0xa7)][_0x136378(0xd7)](this[_0x136378(0xa5)]+'\x20Prepare\x20mdapi\x20files.'),await this[_0x136378(0x69)][_0x136378(0x6b)](this[_0x136378(0xa8)][_0x136378(0xab)])):this[_0x136378(0xa7)]['log'](this[_0x136378(0xa5)]+_0x136378(0x97));await this[_0x136378(0xa7)]['log'](this[_0x136378(0xa5)]+_0x136378(0x9a))[_0x136378(0x80)]();_0x7a4d90[_0x136378(0x88)]&&(this[_0x136378(0xa7)]['log'](this[_0x136378(0xa5)]+'\x20Preparing\x20to\x20write\x20components'),this['componentsToWrite']=_0x7a4d90[_0x136378(0x88)][_0x136378(0xd1)],await this[_0x136378(0xd2)](_0x7a4d90[_0x136378(0x88)]),await this[_0x136378(0xa7)][_0x136378(0x80)]());await this[_0x136378(0xa7)][_0x136378(0xd7)](this[_0x136378(0xa5)]+_0x136378(0xba))[_0x136378(0x80)]();_0x7a4d90[_0x136378(0x78)]&&(this[_0x136378(0xa7)][_0x136378(0xd7)](this[_0x136378(0xa5)]+_0x136378(0x7c)),this[_0x136378(0x92)]=_0x7a4d90['deleted'][_0x136378(0xd1)],await this[_0x136378(0x8c)](_0x7a4d90[_0x136378(0x78)]),await this[_0x136378(0xa7)][_0x136378(0x80)]());await this['sfLogger'][_0x136378(0x80)]();const _0x321e56=await fs_internal_1['FS']['isEmptyDir'](this[_0x136378(0xa8)][_0x136378(0xab)]);await sfdx_utils_2['SFDX']['isSFDXProject'](this[_0x136378(0xa8)][_0x136378(0xab)])?(_0x9601de=!![],await fs_internal_1['FS'][_0x136378(0x73)]((0x0,path_1['join'])(this[_0x136378(0xa8)][_0x136378(0xab)],_0x136378(0xc5)))):(_0x9601de&&(!_0x321e56&&(_0x9601de=![])),await this[_0x136378(0xa8)]['clearDir']());_0x9601de?(await this[_0x136378(0xa7)][_0x136378(0xd7)](this['prefix']+_0x136378(0xd0))['send'](),await this[_0x136378(0x7b)][_0x136378(0xa4)](this[_0x136378(0x69)][_0x136378(0xab)]),await this['sfdxUtils'][_0x136378(0xc4)](this['gitUtils'][_0x136378(0xab)],!_0x321e56),await this[_0x136378(0x7b)][_0x136378(0x94)](this[_0x136378(0x69)][_0x136378(0xab)],(0x0,path_1['join'])(this[_0x136378(0xa8)][_0x136378(0xab)],constants_2[_0x136378(0xcc)])),await this[_0x136378(0x7b)]['removeDir']()):(await this[_0x136378(0xa7)]['log'](this[_0x136378(0xa5)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x136378(0x80)](),await this[_0x136378(0x69)][_0x136378(0xac)](this[_0x136378(0xa8)][_0x136378(0xab)]));await this[_0x136378(0xa7)]['log'](this[_0x136378(0xa5)]+_0x136378(0xa9))[_0x136378(0x80)](),await this[_0x136378(0xa8)][_0x136378(0xa6)](_0x542ecd,{'email':constants_1[_0x136378(0x8f)],'name':_0x1b09ea[_0x136378(0xa3)]},_0x4d3b5e['name']),await this['gitUtils'][_0x136378(0x73)](),await this[_0x136378(0x69)][_0x136378(0x73)]();const _0x35d6e8=this['componentsToWrite']+this[_0x136378(0x92)];await this[_0x136378(0xa7)]['log'](this['prefix']+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x136378(0x98)]()-this[_0x136378(0xc9)])+'ms.\x20Committed\x20components\x20-\x20'+_0x35d6e8+'.')[_0x136378(0x80)]();}catch(_0x5efbce){await this[_0x136378(0x7d)](),await this[_0x136378(0xa7)]['error'](this[_0x136378(0xa5)]+'\x20'+_0x5efbce)[_0x136378(0x80)]();throw _0x5efbce;}}async[a104_0x1850e9(0xad)](_0x5d4c67,_0x2b3a62){const _0x572149=a104_0x1850e9;var _0x5f9f0a,_0x3b5582;this[_0x572149(0xa7)]=typedi_1[_0x572149(0xc8)][_0x572149(0xbe)](providers_tokens_1['Tokens']['logger']),this[_0x572149(0xa5)]=(_0x2b3a62?_0x2b3a62+'\x20':'')+'['+commit_components_dto_1[_0x572149(0xc0)][_0x572149(0xa3)]+']',await this[_0x572149(0xa7)][_0x572149(0xd7)](this['prefix']+'\x20Checking\x20commit\x20components.');const _0x26809f=!!((_0x5f9f0a=_0x5d4c67[_0x572149(0x81)])===null||_0x5f9f0a===void 0x0?void 0x0:_0x5f9f0a[_0x572149(0x88)])||!!((_0x3b5582=_0x5d4c67['components'])===null||_0x3b5582===void 0x0?void 0x0:_0x3b5582[_0x572149(0x78)]);if(!_0x26809f){await this[_0x572149(0xa7)]['log'](this[_0x572149(0xa5)]+_0x572149(0xcb))[_0x572149(0x80)]();return;}this['commitData']=_0x5d4c67,await this[_0x572149(0x89)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x1850e9(0x77)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x1850e9(0xb4)]=CommitComponentsJob;