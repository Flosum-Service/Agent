const a123_0x5693ff=a123_0x1ce7;(function(_0xe8104d,_0xfa3315){const _0x57f4da=a123_0x1ce7,_0x1038f5=_0xe8104d();while(!![]){try{const _0x4ccbbe=-parseInt(_0x57f4da(0x1bf))/0x1+-parseInt(_0x57f4da(0x217))/0x2*(-parseInt(_0x57f4da(0x1ea))/0x3)+parseInt(_0x57f4da(0x1bd))/0x4*(parseInt(_0x57f4da(0x223))/0x5)+parseInt(_0x57f4da(0x1c1))/0x6*(-parseInt(_0x57f4da(0x1dd))/0x7)+-parseInt(_0x57f4da(0x210))/0x8*(-parseInt(_0x57f4da(0x208))/0x9)+-parseInt(_0x57f4da(0x1c4))/0xa+-parseInt(_0x57f4da(0x1ca))/0xb*(-parseInt(_0x57f4da(0x1fb))/0xc);if(_0x4ccbbe===_0xfa3315)break;else _0x1038f5['push'](_0x1038f5['shift']());}catch(_0x439bac){_0x1038f5['push'](_0x1038f5['shift']());}}}(a123_0x1e15,0x26817));const a123_0x2b7585=(function(){let _0x5d0df2=!![];return function(_0x5e985c,_0x40a230){const _0x2e9ca5=_0x5d0df2?function(){const _0x86c4ce=a123_0x1ce7;if(_0x40a230){const _0x526a25=_0x40a230[_0x86c4ce(0x234)](_0x5e985c,arguments);return _0x40a230=null,_0x526a25;}}:function(){};return _0x5d0df2=![],_0x2e9ca5;};}()),a123_0x443aea=a123_0x2b7585(this,function(){const _0x2e13c6=a123_0x1ce7;return a123_0x443aea['toString']()['search'](_0x2e13c6(0x205))[_0x2e13c6(0x1ed)]()[_0x2e13c6(0x200)](a123_0x443aea)[_0x2e13c6(0x1ff)](_0x2e13c6(0x205));});a123_0x443aea();'use strict';function a123_0x1ce7(_0x415d74,_0x1d6951){const _0xf2d567=a123_0x1e15();return a123_0x1ce7=function(_0x443aea,_0x2b7585){_0x443aea=_0x443aea-0x1bc;let _0x1e153f=_0xf2d567[_0x443aea];return _0x1e153f;},a123_0x1ce7(_0x415d74,_0x1d6951);}var __createBinding=this&&this[a123_0x5693ff(0x232)]||(Object['create']?function(_0x5448d6,_0x7e2873,_0x58d693,_0xd2ff13){const _0x2e3bf8=a123_0x5693ff;if(_0xd2ff13===undefined)_0xd2ff13=_0x58d693;var _0x5bc458=Object[_0x2e3bf8(0x22a)](_0x7e2873,_0x58d693);(!_0x5bc458||('get'in _0x5bc458?!_0x7e2873[_0x2e3bf8(0x21a)]:_0x5bc458[_0x2e3bf8(0x1e4)]||_0x5bc458[_0x2e3bf8(0x225)]))&&(_0x5bc458={'enumerable':!![],'get':function(){return _0x7e2873[_0x58d693];}}),Object['defineProperty'](_0x5448d6,_0xd2ff13,_0x5bc458);}:function(_0x408f0f,_0x4c395f,_0x5dd8e8,_0x5b8f7c){if(_0x5b8f7c===undefined)_0x5b8f7c=_0x5dd8e8;_0x408f0f[_0x5b8f7c]=_0x4c395f[_0x5dd8e8];}),__setModuleDefault=this&&this[a123_0x5693ff(0x1d9)]||(Object['create']?function(_0x5b743a,_0x4a89e7){const _0x3125e0=a123_0x5693ff;Object[_0x3125e0(0x22f)](_0x5b743a,_0x3125e0(0x228),{'enumerable':!![],'value':_0x4a89e7});}:function(_0x295ade,_0x598cdf){const _0x179e62=a123_0x5693ff;_0x295ade[_0x179e62(0x228)]=_0x598cdf;}),__decorate=this&&this['__decorate']||function(_0x5c6e3a,_0x3735de,_0x1c17e0,_0x49c781){const _0x86cd02=a123_0x5693ff;var _0x4fcd51=arguments[_0x86cd02(0x1d6)],_0x5df679=_0x4fcd51<0x3?_0x3735de:_0x49c781===null?_0x49c781=Object[_0x86cd02(0x22a)](_0x3735de,_0x1c17e0):_0x49c781,_0xc21c90;if(typeof Reflect==='object'&&typeof Reflect[_0x86cd02(0x20d)]===_0x86cd02(0x211))_0x5df679=Reflect['decorate'](_0x5c6e3a,_0x3735de,_0x1c17e0,_0x49c781);else{for(var _0x31c802=_0x5c6e3a[_0x86cd02(0x1d6)]-0x1;_0x31c802>=0x0;_0x31c802--)if(_0xc21c90=_0x5c6e3a[_0x31c802])_0x5df679=(_0x4fcd51<0x3?_0xc21c90(_0x5df679):_0x4fcd51>0x3?_0xc21c90(_0x3735de,_0x1c17e0,_0x5df679):_0xc21c90(_0x3735de,_0x1c17e0))||_0x5df679;}return _0x4fcd51>0x3&&_0x5df679&&Object[_0x86cd02(0x22f)](_0x3735de,_0x1c17e0,_0x5df679),_0x5df679;},__importStar=this&&this[a123_0x5693ff(0x220)]||function(_0xe3b9a0){const _0x38f382=a123_0x5693ff;if(_0xe3b9a0&&_0xe3b9a0[_0x38f382(0x21a)])return _0xe3b9a0;var _0x3c4b5b={};if(_0xe3b9a0!=null){for(var _0x15d123 in _0xe3b9a0)if(_0x15d123!==_0x38f382(0x228)&&Object[_0x38f382(0x1fe)][_0x38f382(0x1d5)]['call'](_0xe3b9a0,_0x15d123))__createBinding(_0x3c4b5b,_0xe3b9a0,_0x15d123);}return __setModuleDefault(_0x3c4b5b,_0xe3b9a0),_0x3c4b5b;},__importDefault=this&&this['__importDefault']||function(_0x37693f){const _0x34f281=a123_0x5693ff;return _0x37693f&&_0x37693f[_0x34f281(0x21a)]?_0x37693f:{'default':_0x37693f};};Object[a123_0x5693ff(0x22f)](exports,a123_0x5693ff(0x21a),{'value':!![]}),exports[a123_0x5693ff(0x1de)]=void 0x0;function a123_0x1e15(){const _0x2f4aea=['credentials','959880gQLmUf','exec','push','prototype','search','constructor','name','../../../shared/utils','logger','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','(((.+)+)+)+$','run','recordType','126xlsQMd','commitData','copyProjectTo','../dto/commit-components.dto','Tokens','decorate','\x20components','cleanUp','160728QVUIhJ','function','path','FORCE_APP_DEFAULT_DIR','ms.\x20Committed\x20components\x20-\x20','fileType','\x20Start\x20cloning\x20repository.','313454LaUCDw','CommitComponentsDto','gitUrl','__esModule','catch','\x20Checking\x20written\x20components.','DEFAULT_GIT_USER_EMAIL','prepareMdapi','\x20Preparing\x20to\x20write\x20components','__importStar','clearDir','componentsToDelete','5Koozrg','error','configurable','sort','deleted','default','../../providers/api/bitbucket-api.service','getOwnPropertyDescriptor','../utils/sfdx.utils','send','../utils/mdapi.utils','writed','defineProperty','clone','force-app','__createBinding','COMPONENTS_PER_TICK','apply','../../providers/providers.tokens','660052IkywLF','writeComponents','220065vURhBh','prefix','6jjULcO','mdapiUtils','\x20Checking\x20deleted\x20components.','713980QvuUMN','\x20Copying\x20mdapi\x20to\x20git\x20folder.','getGitShellAuthorizationString','SFDXUtils','sfLogger','events','11uHwLXP','isSFDXProject','\x20Wrote\x20','log','removeComponents','groupComponentsByFileName','master','replace','\x20Nothing\x20to\x20commit.\x20Skip.','getRemote','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','hasOwnProperty','length','writeFlosumComponents','../../salesforce/utils/sfdx.utils','__setModuleDefault','../../internal/fs.internal','join','../../../../constants','1636754Leokvo','CommitComponentsJob','isEmptyDir','includes','sfdxUtils','../../parsers/data/child-types','BitbucketApiService','writable','Bitbucket','createProjectFrom','fileName','removeDir','GitProvider','3HSRgHr','reduce','MDApiUtils','toString','components','://','typedi','componentsToWrite','get','startTime','values','commitAndPush','dir','gitUtils','splice','provider'];a123_0x1e15=function(){return _0x2f4aea;};return a123_0x1e15();}const commit_components_dto_1=require(a123_0x5693ff(0x20b)),events_1=__importDefault(require(a123_0x5693ff(0x1c9))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a123_0x5693ff(0x22d)),sfdx_utils_1=require(a123_0x5693ff(0x22b)),typedi_1=__importStar(require(a123_0x5693ff(0x1f0))),child_types_1=__importDefault(require(a123_0x5693ff(0x1e2))),utils_1=require(a123_0x5693ff(0x202)),constants_1=require(a123_0x5693ff(0x1dc)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require(a123_0x5693ff(0x229)),sfdx_utils_2=require(a123_0x5693ff(0x1d8)),fs_internal_1=require(a123_0x5693ff(0x1da)),path_1=require(a123_0x5693ff(0x212)),providers_tokens_1=require(a123_0x5693ff(0x1bc)),constants_2=require('../../../../constants');let CommitComponentsJob=class CommitComponentsJob extends events_1[a123_0x5693ff(0x228)]{constructor(){const _0x5c0ce4=a123_0x5693ff;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x5c0ce4(0x1f1)]=0x0,this[_0x5c0ce4(0x222)]=0x0,this[_0x5c0ce4(0x1f3)]=Date['now']();}async['getRemote'](){const _0x37f054=a123_0x5693ff,{repo:_0x3e6331}=this[_0x37f054(0x209)],_0x1f05ae=typedi_1['default'][_0x37f054(0x1f2)](providers_tokens_1[_0x37f054(0x20c)][_0x37f054(0x1fa)]);if(this[_0x37f054(0x209)][_0x37f054(0x1f9)]===git_provider_1[_0x37f054(0x1e9)][_0x37f054(0x1e5)]){const _0x4c64f4=typedi_1['default'][_0x37f054(0x1f2)](bitbucket_api_service_1[_0x37f054(0x1e3)]);await _0x4c64f4['isLoggedIn']();}return _0x3e6331['gitUrl'][_0x37f054(0x1d1)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x3e6331[_0x37f054(0x219)])+_0x37f054(0x1ef)+_0x1f05ae[_0x37f054(0x1c6)]()+'@');}[a123_0x5693ff(0x1cf)](_0x14e255){const _0x4d3078=a123_0x5693ff;var _0x64da9a;_0x14e255[_0x4d3078(0x226)](_0x150c49=>child_types_1[_0x4d3078(0x228)]['includes'](_0x150c49[_0x4d3078(0x215)])?0x1:-0x1);const _0xa666be={};for(const _0x3d66ae of _0x14e255){_0xa666be[_0x64da9a=_0x3d66ae[_0x4d3078(0x1e7)]]||(_0xa666be[_0x64da9a]=[]),_0xa666be[_0x3d66ae[_0x4d3078(0x1e7)]][_0x4d3078(0x1fd)](_0x3d66ae);}return Object[_0x4d3078(0x1f4)](_0xa666be)[_0x4d3078(0x1eb)]((_0x2bf075,_0x1c8422)=>[..._0x2bf075,..._0x1c8422],[]);}async[a123_0x5693ff(0x1be)](_0x39b4f5){const _0x14d22c=a123_0x5693ff;_0x39b4f5=this[_0x14d22c(0x1cf)](_0x39b4f5);let _0x28f617=0x0;while(_0x39b4f5[_0x14d22c(0x1d6)]){const _0x2ba839=_0x39b4f5[_0x14d22c(0x1f8)](0x0,this[_0x14d22c(0x233)]);await this[_0x14d22c(0x1c2)][_0x14d22c(0x1d7)](_0x2ba839,{'skipChildErrors':this[_0x14d22c(0x209)]['branch']['name']===_0x14d22c(0x1d0),'recordType':this[_0x14d22c(0x209)]['recordType']}),_0x28f617+=_0x2ba839[_0x14d22c(0x1d6)],this[_0x14d22c(0x1c8)]['log'](this[_0x14d22c(0x1c0)]+_0x14d22c(0x1cc)+_0x28f617+'/'+this[_0x14d22c(0x1f1)]+'\x20components'),await this[_0x14d22c(0x1c8)][_0x14d22c(0x22c)]();}}async['removeComponents'](_0x5b574c){const _0x20ef05=a123_0x5693ff;_0x5b574c['sort'](_0x1c787a=>child_types_1[_0x20ef05(0x228)][_0x20ef05(0x1e0)](_0x1c787a['type'])?-0x1:0x1);let _0x557fed=0x0;while(_0x5b574c[_0x20ef05(0x1d6)]){const _0x44f6c0=_0x5b574c[_0x20ef05(0x1f8)](0x0,this[_0x20ef05(0x233)]);await this[_0x20ef05(0x1c2)][_0x20ef05(0x1ce)](_0x44f6c0,this['commitData'][_0x20ef05(0x207)]),_0x557fed+=_0x44f6c0[_0x20ef05(0x1d6)],this[_0x20ef05(0x1c8)][_0x20ef05(0x1cd)](this[_0x20ef05(0x1c0)]+'\x20Deleted\x20'+_0x557fed+'/'+this['componentsToDelete']+_0x20ef05(0x20e)),await this[_0x20ef05(0x1c8)]['send']();}}async[a123_0x5693ff(0x20f)](){const _0x36c163=a123_0x5693ff;this[_0x36c163(0x1f7)]&&await this['gitUtils'][_0x36c163(0x1e8)]()[_0x36c163(0x21b)](()=>void 0x0),this[_0x36c163(0x1c2)]&&await this[_0x36c163(0x1c2)][_0x36c163(0x1e8)]()['catch'](()=>void 0x0),this[_0x36c163(0x1e1)]&&await this[_0x36c163(0x1e1)][_0x36c163(0x1e8)]()[_0x36c163(0x21b)](()=>void 0x0);}async['exec'](){const _0x42962c=a123_0x5693ff,{repo:_0x5649ab,branch:_0x5da1cd,components:_0x35659d,convertToSFDX:_0x5c7f25,message:_0xb605c8,user:_0x3f006d}=this['commitData'];this[_0x42962c(0x1c2)]=new mdapi_utils_1[(_0x42962c(0x1ec))](),this[_0x42962c(0x1f7)]=new git_utils_1['GitUtils'](await this[_0x42962c(0x1d3)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x42962c(0x1c7))]();let _0x51d3d8=_0x5c7f25&&this[_0x42962c(0x1e1)]['isConvertToSfdx'](this[_0x42962c(0x209)][_0x42962c(0x207)]);try{await this['sfLogger']['log'](this[_0x42962c(0x1c0)]+_0x42962c(0x216))[_0x42962c(0x22c)](),await this[_0x42962c(0x1f7)][_0x42962c(0x230)](_0x5da1cd[_0x42962c(0x201)],_0x5649ab[_0x42962c(0x201)]);!this['commitData']['force']?(this['sfLogger']['log'](this[_0x42962c(0x1c0)]+'\x20Prepare\x20mdapi\x20files.'),await this['mdapiUtils'][_0x42962c(0x21e)](this[_0x42962c(0x1f7)][_0x42962c(0x1f6)])):this[_0x42962c(0x1c8)][_0x42962c(0x1cd)](this[_0x42962c(0x1c0)]+_0x42962c(0x1d4));await this[_0x42962c(0x1c8)]['log'](this[_0x42962c(0x1c0)]+_0x42962c(0x21c))[_0x42962c(0x22c)]();_0x35659d[_0x42962c(0x22e)]&&(this[_0x42962c(0x1c8)][_0x42962c(0x1cd)](this[_0x42962c(0x1c0)]+_0x42962c(0x21f)),this[_0x42962c(0x1f1)]=_0x35659d[_0x42962c(0x22e)][_0x42962c(0x1d6)],await this[_0x42962c(0x1be)](_0x35659d['writed']),await this['sfLogger']['send']());await this[_0x42962c(0x1c8)][_0x42962c(0x1cd)](this[_0x42962c(0x1c0)]+_0x42962c(0x1c3))['send']();_0x35659d[_0x42962c(0x227)]&&(this[_0x42962c(0x1c8)][_0x42962c(0x1cd)](this[_0x42962c(0x1c0)]+'\x20Preparing\x20to\x20delete\x20components'),this['componentsToDelete']=_0x35659d[_0x42962c(0x227)][_0x42962c(0x1d6)],await this[_0x42962c(0x1ce)](_0x35659d[_0x42962c(0x227)]),await this[_0x42962c(0x1c8)][_0x42962c(0x22c)]());await this['sfLogger'][_0x42962c(0x22c)]();const _0x8cd434=await fs_internal_1['FS'][_0x42962c(0x1df)](this[_0x42962c(0x1f7)][_0x42962c(0x1f6)]);await sfdx_utils_2['SFDX'][_0x42962c(0x1cb)](this[_0x42962c(0x1f7)][_0x42962c(0x1f6)])?(_0x51d3d8=!![],await fs_internal_1['FS'][_0x42962c(0x1e8)]((0x0,path_1[_0x42962c(0x1db)])(this[_0x42962c(0x1f7)][_0x42962c(0x1f6)],_0x42962c(0x231)))):(_0x51d3d8&&(!_0x8cd434&&(_0x51d3d8=![])),await this[_0x42962c(0x1f7)][_0x42962c(0x221)]());_0x51d3d8?(await this[_0x42962c(0x1c8)]['log'](this[_0x42962c(0x1c0)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x42962c(0x22c)](),await this['sfdxUtils'][_0x42962c(0x1e6)](this['mdapiUtils'][_0x42962c(0x1f6)]),await this[_0x42962c(0x1e1)][_0x42962c(0x20a)](this['gitUtils'][_0x42962c(0x1f6)],!_0x8cd434),await this['sfdxUtils']['copySFDXIgnoredComponents'](this['mdapiUtils'][_0x42962c(0x1f6)],(0x0,path_1[_0x42962c(0x1db)])(this[_0x42962c(0x1f7)][_0x42962c(0x1f6)],constants_2[_0x42962c(0x213)])),await this['sfdxUtils'][_0x42962c(0x1e8)]()):(await this[_0x42962c(0x1c8)][_0x42962c(0x1cd)](this[_0x42962c(0x1c0)]+_0x42962c(0x1c5))[_0x42962c(0x22c)](),await this[_0x42962c(0x1c2)]['copyMdapiTo'](this[_0x42962c(0x1f7)][_0x42962c(0x1f6)]));await this[_0x42962c(0x1c8)]['log'](this[_0x42962c(0x1c0)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')['send'](),await this['gitUtils'][_0x42962c(0x1f5)](_0xb605c8,{'email':constants_1[_0x42962c(0x21d)],'name':_0x3f006d[_0x42962c(0x201)]},_0x5da1cd[_0x42962c(0x201)]),await this[_0x42962c(0x1f7)][_0x42962c(0x1e8)](),await this['mdapiUtils'][_0x42962c(0x1e8)]();const _0x412d17=this['componentsToWrite']+this[_0x42962c(0x222)];await this[_0x42962c(0x1c8)][_0x42962c(0x1cd)](this[_0x42962c(0x1c0)]+_0x42962c(0x204)+(Date['now']()-this[_0x42962c(0x1f3)])+_0x42962c(0x214)+_0x412d17+'.')[_0x42962c(0x22c)]();}catch(_0xc8745){await this[_0x42962c(0x20f)](),await this[_0x42962c(0x1c8)][_0x42962c(0x224)](this[_0x42962c(0x1c0)]+'\x20'+_0xc8745)[_0x42962c(0x22c)]();throw _0xc8745;}}async[a123_0x5693ff(0x206)](_0x58f5e9,_0x26bf38){const _0xbe4494=a123_0x5693ff;var _0x3d232a,_0x2d1cdb;this[_0xbe4494(0x1c8)]=typedi_1[_0xbe4494(0x228)][_0xbe4494(0x1f2)](providers_tokens_1[_0xbe4494(0x20c)][_0xbe4494(0x203)]),this[_0xbe4494(0x1c0)]=(_0x26bf38?_0x26bf38+'\x20':'')+'['+commit_components_dto_1[_0xbe4494(0x218)][_0xbe4494(0x201)]+']',await this[_0xbe4494(0x1c8)][_0xbe4494(0x1cd)](this[_0xbe4494(0x1c0)]+'\x20Checking\x20commit\x20components.');const _0x23964a=!!((_0x3d232a=_0x58f5e9['components'])===null||_0x3d232a===void 0x0?void 0x0:_0x3d232a['writed'])||!!((_0x2d1cdb=_0x58f5e9[_0xbe4494(0x1ee)])===null||_0x2d1cdb===void 0x0?void 0x0:_0x2d1cdb[_0xbe4494(0x227)]);if(!_0x23964a){await this[_0xbe4494(0x1c8)]['log'](this[_0xbe4494(0x1c0)]+_0xbe4494(0x1d2))[_0xbe4494(0x22c)]();return;}this['commitData']=_0x58f5e9,await this[_0xbe4494(0x1fc)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports['CommitComponentsJob']=CommitComponentsJob;