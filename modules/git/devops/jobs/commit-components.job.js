const a103_0x2d6c74=a103_0x59ef;(function(_0x432f6e,_0x2a6f35){const _0x5c519a=a103_0x59ef,_0x2821cf=_0x432f6e();while(!![]){try{const _0x227ff8=-parseInt(_0x5c519a(0x109))/0x1*(parseInt(_0x5c519a(0x108))/0x2)+parseInt(_0x5c519a(0xc0))/0x3+-parseInt(_0x5c519a(0xed))/0x4+parseInt(_0x5c519a(0x11e))/0x5+parseInt(_0x5c519a(0x128))/0x6*(parseInt(_0x5c519a(0x10e))/0x7)+parseInt(_0x5c519a(0xf0))/0x8+-parseInt(_0x5c519a(0xca))/0x9;if(_0x227ff8===_0x2a6f35)break;else _0x2821cf['push'](_0x2821cf['shift']());}catch(_0x2a7e8a){_0x2821cf['push'](_0x2821cf['shift']());}}}(a103_0x5440,0x8423f));const a103_0x1b4f03=(function(){let _0x517146=!![];return function(_0x3eb9e0,_0x45f16b){const _0x4bc54d=_0x517146?function(){const _0x5eb320=a103_0x59ef;if(_0x45f16b){const _0x140613=_0x45f16b[_0x5eb320(0xf4)](_0x3eb9e0,arguments);return _0x45f16b=null,_0x140613;}}:function(){};return _0x517146=![],_0x4bc54d;};}()),a103_0x5b7033=a103_0x1b4f03(this,function(){const _0x2667bf=a103_0x59ef;return a103_0x5b7033[_0x2667bf(0xf3)]()[_0x2667bf(0xee)](_0x2667bf(0xd6))[_0x2667bf(0xf3)]()[_0x2667bf(0x120)](a103_0x5b7033)[_0x2667bf(0xee)](_0x2667bf(0xd6));});a103_0x5b7033();'use strict';function a103_0x5440(){const _0x5a0efe=['__importDefault','run','splice','../dto/commit-components.dto','provider','__decorate','name','Bitbucket','send','9578KmofbQ','92ErdLsW','typedi','clone','push','\x20Checking\x20written\x20components.','6091225BeSxBZ','CommitComponentsDto','master','type','cleanUp','exec','Tokens','\x20Start\x20converting\x20to\x20SFDX.','values','commitData','SFDX','SFDXUtils','error','removeComponents','componentsToDelete','mdapiUtils','167960INPfSN','groupComponentsByFileName','constructor','startTime','copyProjectTo','removeDir','gitUrl','sfdxUtils','componentsToWrite','../../internal/fs.internal','6QZYRVu','decorate','branch','://','../utils/mdapi.utils','isEmptyDir','isLoggedIn','COMPONENTS_PER_TICK','\x20Checking\x20commit\x20components.','../utils/sfdx.utils','deleted','prepareMdapi','2344554jgcjvi','catch','now','ms.\x20Committed\x20components\x20-\x20','configurable','includes','object','CommitComponentsJob','DEFAULT_GIT_USER_EMAIL','writable','7501518pzqyIx','BitbucketApiService','getOwnPropertyDescriptor','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','\x20Checking\x20deleted\x20components.','commitAndPush','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','writed','__importStar','isSFDXProject','GitUtils','components','(((.+)+)+)+$','\x20Wrote\x20','getGitShellAuthorizationString','MDApiUtils','__setModuleDefault','\x20Prepare\x20mdapi\x20files.','defineProperty','default','writeComponents','sfLogger','sort','log','prefix','Service','dir','length','\x20components','../../providers/api/bitbucket-api.service','replace','getRemote','../utils/git.utils','fileName','\x20Preparing\x20to\x20write\x20components','803592pvnGOT','search','get','2647600TjLtCf','__createBinding','__esModule','toString','apply','writeFlosumComponents','../../providers/types/git-provider','gitUtils','fileType','getProtocol','events','force','create','../../../shared/utils','join'];a103_0x5440=function(){return _0x5a0efe;};return a103_0x5440();}var __createBinding=this&&this[a103_0x2d6c74(0xf1)]||(Object[a103_0x2d6c74(0xfc)]?function(_0x780aae,_0x5814fe,_0x290d88,_0x183e5c){const _0x4d7e62=a103_0x2d6c74;if(_0x183e5c===undefined)_0x183e5c=_0x290d88;var _0x3ea26c=Object[_0x4d7e62(0xcc)](_0x5814fe,_0x290d88);(!_0x3ea26c||(_0x4d7e62(0xef)in _0x3ea26c?!_0x5814fe[_0x4d7e62(0xf2)]:_0x3ea26c[_0x4d7e62(0xc9)]||_0x3ea26c[_0x4d7e62(0xc4)]))&&(_0x3ea26c={'enumerable':!![],'get':function(){return _0x5814fe[_0x290d88];}}),Object[_0x4d7e62(0xdc)](_0x780aae,_0x183e5c,_0x3ea26c);}:function(_0x2b327c,_0x5bfbd6,_0x4c3238,_0x39e238){if(_0x39e238===undefined)_0x39e238=_0x4c3238;_0x2b327c[_0x39e238]=_0x5bfbd6[_0x4c3238];}),__setModuleDefault=this&&this[a103_0x2d6c74(0xda)]||(Object[a103_0x2d6c74(0xfc)]?function(_0x3a6bb3,_0x3d8af7){const _0x29ac9b=a103_0x2d6c74;Object[_0x29ac9b(0xdc)](_0x3a6bb3,'default',{'enumerable':!![],'value':_0x3d8af7});}:function(_0x42a8e2,_0x13b69f){_0x42a8e2['default']=_0x13b69f;}),__decorate=this&&this[a103_0x2d6c74(0x104)]||function(_0x249c50,_0x25ba97,_0x49b6ac,_0x1a578f){const _0x4d8ef4=a103_0x2d6c74;var _0x13d296=arguments[_0x4d8ef4(0xe5)],_0x43ab9d=_0x13d296<0x3?_0x25ba97:_0x1a578f===null?_0x1a578f=Object[_0x4d8ef4(0xcc)](_0x25ba97,_0x49b6ac):_0x1a578f,_0x32ab63;if(typeof Reflect===_0x4d8ef4(0xc6)&&typeof Reflect[_0x4d8ef4(0x129)]==='function')_0x43ab9d=Reflect[_0x4d8ef4(0x129)](_0x249c50,_0x25ba97,_0x49b6ac,_0x1a578f);else{for(var _0x22019c=_0x249c50[_0x4d8ef4(0xe5)]-0x1;_0x22019c>=0x0;_0x22019c--)if(_0x32ab63=_0x249c50[_0x22019c])_0x43ab9d=(_0x13d296<0x3?_0x32ab63(_0x43ab9d):_0x13d296>0x3?_0x32ab63(_0x25ba97,_0x49b6ac,_0x43ab9d):_0x32ab63(_0x25ba97,_0x49b6ac))||_0x43ab9d;}return _0x13d296>0x3&&_0x43ab9d&&Object[_0x4d8ef4(0xdc)](_0x25ba97,_0x49b6ac,_0x43ab9d),_0x43ab9d;},__importStar=this&&this[a103_0x2d6c74(0xd2)]||function(_0x3a8a82){const _0x57968f=a103_0x2d6c74;if(_0x3a8a82&&_0x3a8a82[_0x57968f(0xf2)])return _0x3a8a82;var _0x39227c={};if(_0x3a8a82!=null){for(var _0x25fb5d in _0x3a8a82)if(_0x25fb5d!==_0x57968f(0xdd)&&Object['prototype']['hasOwnProperty']['call'](_0x3a8a82,_0x25fb5d))__createBinding(_0x39227c,_0x3a8a82,_0x25fb5d);}return __setModuleDefault(_0x39227c,_0x3a8a82),_0x39227c;},__importDefault=this&&this[a103_0x2d6c74(0xff)]||function(_0x5ab2fd){const _0x36bcdf=a103_0x2d6c74;return _0x5ab2fd&&_0x5ab2fd[_0x36bcdf(0xf2)]?_0x5ab2fd:{'default':_0x5ab2fd};};Object[a103_0x2d6c74(0xdc)](exports,a103_0x2d6c74(0xf2),{'value':!![]}),exports[a103_0x2d6c74(0xc7)]=void 0x0;const commit_components_dto_1=require(a103_0x2d6c74(0x102)),events_1=__importDefault(require(a103_0x2d6c74(0xfa))),git_utils_1=require(a103_0x2d6c74(0xea)),mdapi_utils_1=require(a103_0x2d6c74(0x12c)),sfdx_utils_1=require(a103_0x2d6c74(0x131)),typedi_1=__importStar(require(a103_0x2d6c74(0x10a))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a103_0x2d6c74(0xfd)),constants_1=require('../../../../constants'),git_provider_1=require(a103_0x2d6c74(0xf6)),bitbucket_api_service_1=require(a103_0x2d6c74(0xe7)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a103_0x2d6c74(0x127)),path_1=require('path'),providers_tokens_1=require('../../providers/providers.tokens');let CommitComponentsJob=class CommitComponentsJob extends events_1[a103_0x2d6c74(0xdd)]{constructor(){const _0x257c96=a103_0x2d6c74;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x257c96(0x126)]=0x0,this['componentsToDelete']=0x0,this['startTime']=Date[_0x257c96(0xc2)]();}async[a103_0x2d6c74(0xe9)](){const _0x5e6a7a=a103_0x2d6c74,{repo:_0x1ab4f1}=this[_0x5e6a7a(0x117)],_0x3ee7bb=typedi_1[_0x5e6a7a(0xdd)][_0x5e6a7a(0xef)](providers_tokens_1[_0x5e6a7a(0x114)]['credentials']);if(this[_0x5e6a7a(0x117)][_0x5e6a7a(0x103)]===git_provider_1['GitProvider'][_0x5e6a7a(0x106)]){const _0x472bc4=typedi_1[_0x5e6a7a(0xdd)][_0x5e6a7a(0xef)](bitbucket_api_service_1[_0x5e6a7a(0xcb)]);await _0x472bc4[_0x5e6a7a(0x12e)]();}return _0x1ab4f1[_0x5e6a7a(0x124)][_0x5e6a7a(0xe8)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x5e6a7a(0xf9)])(_0x1ab4f1['gitUrl'])+_0x5e6a7a(0x12b)+_0x3ee7bb[_0x5e6a7a(0xd8)]()+'@');}[a103_0x2d6c74(0x11f)](_0x1fc903){const _0x54a337=a103_0x2d6c74;var _0x5896d5;_0x1fc903[_0x54a337(0xe0)](_0x1eaff6=>child_types_1[_0x54a337(0xdd)][_0x54a337(0xc5)](_0x1eaff6[_0x54a337(0xf8)])?0x1:-0x1);const _0x4d9aac={};for(const _0x359df8 of _0x1fc903){_0x4d9aac[_0x5896d5=_0x359df8[_0x54a337(0xeb)]]||(_0x4d9aac[_0x5896d5]=[]),_0x4d9aac[_0x359df8[_0x54a337(0xeb)]][_0x54a337(0x10c)](_0x359df8);}return Object[_0x54a337(0x116)](_0x4d9aac)['reduce']((_0x31a50a,_0x99c39c)=>[..._0x31a50a,..._0x99c39c],[]);}async[a103_0x2d6c74(0xde)](_0x10bfa7){const _0x298e1d=a103_0x2d6c74;_0x10bfa7=this[_0x298e1d(0x11f)](_0x10bfa7);let _0x11cc57=0x0;while(_0x10bfa7[_0x298e1d(0xe5)]){const _0x3f7b75=_0x10bfa7[_0x298e1d(0x101)](0x0,this[_0x298e1d(0x12f)]);await this[_0x298e1d(0x11d)][_0x298e1d(0xf5)](_0x3f7b75,{'skipChildErrors':this[_0x298e1d(0x117)][_0x298e1d(0x12a)][_0x298e1d(0x105)]===_0x298e1d(0x110)}),_0x11cc57+=_0x3f7b75['length'],this['sfLogger']['log'](this[_0x298e1d(0xe2)]+_0x298e1d(0xd7)+_0x11cc57+'/'+this[_0x298e1d(0x126)]+_0x298e1d(0xe6)),await this[_0x298e1d(0xdf)][_0x298e1d(0x107)]();}}async[a103_0x2d6c74(0x11b)](_0x4663b8){const _0x3c3188=a103_0x2d6c74;_0x4663b8['sort'](_0x30b7cc=>child_types_1[_0x3c3188(0xdd)][_0x3c3188(0xc5)](_0x30b7cc[_0x3c3188(0x111)])?-0x1:0x1);let _0x149eed=0x0;while(_0x4663b8['length']){const _0x32a395=_0x4663b8[_0x3c3188(0x101)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x3c3188(0x11d)][_0x3c3188(0x11b)](_0x32a395),_0x149eed+=_0x32a395['length'],this['sfLogger'][_0x3c3188(0xe1)](this[_0x3c3188(0xe2)]+'\x20Deleted\x20'+_0x149eed+'/'+this[_0x3c3188(0x11c)]+_0x3c3188(0xe6)),await this[_0x3c3188(0xdf)][_0x3c3188(0x107)]();}}async[a103_0x2d6c74(0x112)](){const _0x48a0a7=a103_0x2d6c74;this['gitUtils']&&await this[_0x48a0a7(0xf7)][_0x48a0a7(0x123)]()['catch'](()=>void 0x0),this[_0x48a0a7(0x11d)]&&await this[_0x48a0a7(0x11d)][_0x48a0a7(0x123)]()[_0x48a0a7(0xc1)](()=>void 0x0),this[_0x48a0a7(0x125)]&&await this[_0x48a0a7(0x125)]['removeDir']()['catch'](()=>void 0x0);}async[a103_0x2d6c74(0x113)](){const _0x13310a=a103_0x2d6c74,{repo:_0x1c8b30,branch:_0x11ac27,components:_0xbede1d,convertToSFDX:_0x18ffe9,message:_0x583551,user:_0x5cdbf0}=this['commitData'];this[_0x13310a(0x11d)]=new mdapi_utils_1[(_0x13310a(0xd9))](),this['gitUtils']=new git_utils_1[(_0x13310a(0xd4))](await this['getRemote']()),this['sfdxUtils']=new sfdx_utils_1[(_0x13310a(0x119))]();let _0x3237f1=_0x18ffe9;try{await this['sfLogger'][_0x13310a(0xe1)](this[_0x13310a(0xe2)]+'\x20Start\x20cloning\x20repository.')[_0x13310a(0x107)](),await this[_0x13310a(0xf7)][_0x13310a(0x10b)](_0x11ac27['name'],_0x1c8b30[_0x13310a(0x105)]);!this['commitData'][_0x13310a(0xfb)]?(this['sfLogger']['log'](this['prefix']+_0x13310a(0xdb)),await this[_0x13310a(0x11d)][_0x13310a(0xbf)](this[_0x13310a(0xf7)][_0x13310a(0xe4)])):this[_0x13310a(0xdf)][_0x13310a(0xe1)](this[_0x13310a(0xe2)]+_0x13310a(0xcd));await this['sfLogger'][_0x13310a(0xe1)](this[_0x13310a(0xe2)]+_0x13310a(0x10d))['send']();_0xbede1d[_0x13310a(0xd1)]&&(this[_0x13310a(0xdf)]['log'](this[_0x13310a(0xe2)]+_0x13310a(0xec)),this[_0x13310a(0x126)]=_0xbede1d[_0x13310a(0xd1)][_0x13310a(0xe5)],await this[_0x13310a(0xde)](_0xbede1d['writed']),await this['sfLogger'][_0x13310a(0x107)]());await this['sfLogger'][_0x13310a(0xe1)](this['prefix']+_0x13310a(0xce))['send']();_0xbede1d[_0x13310a(0x132)]&&(this[_0x13310a(0xdf)]['log'](this[_0x13310a(0xe2)]+'\x20Preparing\x20to\x20delete\x20components'),this['componentsToDelete']=_0xbede1d[_0x13310a(0x132)][_0x13310a(0xe5)],await this[_0x13310a(0x11b)](_0xbede1d['deleted']),await this[_0x13310a(0xdf)][_0x13310a(0x107)]());await this['sfLogger'][_0x13310a(0x107)]();const _0x4993e0=await fs_internal_1['FS'][_0x13310a(0x12d)](this[_0x13310a(0xf7)][_0x13310a(0xe4)]);await sfdx_utils_2[_0x13310a(0x118)][_0x13310a(0xd3)](this['gitUtils'][_0x13310a(0xe4)])?(_0x3237f1=!![],await fs_internal_1['FS'][_0x13310a(0x123)]((0x0,path_1[_0x13310a(0xfe)])(this['gitUtils']['dir'],'force-app'))):(_0x3237f1&&(!_0x4993e0&&(_0x3237f1=![])),await this[_0x13310a(0xf7)]['clearDir']());_0x3237f1?(await this[_0x13310a(0xdf)][_0x13310a(0xe1)](this[_0x13310a(0xe2)]+_0x13310a(0x115))[_0x13310a(0x107)](),await this[_0x13310a(0x125)]['createProjectFrom'](this[_0x13310a(0x11d)][_0x13310a(0xe4)]),await this[_0x13310a(0x125)][_0x13310a(0x122)](this[_0x13310a(0xf7)]['dir'],!_0x4993e0),await this['sfdxUtils'][_0x13310a(0x123)]()):(await this[_0x13310a(0xdf)][_0x13310a(0xe1)](this[_0x13310a(0xe2)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x13310a(0x107)](),await this[_0x13310a(0x11d)]['copyMdapiTo'](this[_0x13310a(0xf7)]['dir']));await this['sfLogger'][_0x13310a(0xe1)](this[_0x13310a(0xe2)]+_0x13310a(0xd0))['send'](),await this[_0x13310a(0xf7)][_0x13310a(0xcf)](_0x583551,{'email':constants_1[_0x13310a(0xc8)],'name':_0x5cdbf0[_0x13310a(0x105)]},_0x11ac27[_0x13310a(0x105)]),await this[_0x13310a(0xf7)]['removeDir'](),await this[_0x13310a(0x11d)][_0x13310a(0x123)]();const _0x18df29=this[_0x13310a(0x126)]+this[_0x13310a(0x11c)];await this[_0x13310a(0xdf)]['log'](this[_0x13310a(0xe2)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x13310a(0xc2)]()-this[_0x13310a(0x121)])+_0x13310a(0xc3)+_0x18df29+'.')[_0x13310a(0x107)]();}catch(_0x2ff7f4){await this[_0x13310a(0x112)](),await this[_0x13310a(0xdf)][_0x13310a(0x11a)](this[_0x13310a(0xe2)]+'\x20'+_0x2ff7f4)['send']();throw _0x2ff7f4;}}async[a103_0x2d6c74(0x100)](_0x4f9aa4,_0x3c5e67){const _0x4281bf=a103_0x2d6c74;var _0x39d26c,_0x376f4b;this[_0x4281bf(0xdf)]=typedi_1[_0x4281bf(0xdd)]['get'](providers_tokens_1[_0x4281bf(0x114)]['logger']),this[_0x4281bf(0xe2)]=(_0x3c5e67?_0x3c5e67+'\x20':'')+'['+commit_components_dto_1[_0x4281bf(0x10f)][_0x4281bf(0x105)]+']',await this['sfLogger'][_0x4281bf(0xe1)](this['prefix']+_0x4281bf(0x130));const _0x49b430=!!((_0x39d26c=_0x4f9aa4[_0x4281bf(0xd5)])===null||_0x39d26c===void 0x0?void 0x0:_0x39d26c[_0x4281bf(0xd1)])||!!((_0x376f4b=_0x4f9aa4[_0x4281bf(0xd5)])===null||_0x376f4b===void 0x0?void 0x0:_0x376f4b[_0x4281bf(0x132)]);if(!_0x49b430){await this[_0x4281bf(0xdf)][_0x4281bf(0xe1)](this[_0x4281bf(0xe2)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x4281bf(0x107)]();return;}this['commitData']=_0x4f9aa4,await this[_0x4281bf(0x113)]();}};function a103_0x59ef(_0x68a5ec,_0x4db2eb){const _0x2ecda2=a103_0x5440();return a103_0x59ef=function(_0x5b7033,_0x1b4f03){_0x5b7033=_0x5b7033-0xbf;let _0x544061=_0x2ecda2[_0x5b7033];return _0x544061;},a103_0x59ef(_0x68a5ec,_0x4db2eb);}CommitComponentsJob=__decorate([(0x0,typedi_1[a103_0x2d6c74(0xe3)])({'transient':!![]})],CommitComponentsJob),exports[a103_0x2d6c74(0xc7)]=CommitComponentsJob;