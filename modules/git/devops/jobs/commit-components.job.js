const a104_0x2411ea=a104_0x51f7;function a104_0x51f7(_0x3d77bb,_0x59619d){const _0x905247=a104_0x39c3();return a104_0x51f7=function(_0x553d2d,_0x149f82){_0x553d2d=_0x553d2d-0x65;let _0x39c3f9=_0x905247[_0x553d2d];return _0x39c3f9;},a104_0x51f7(_0x3d77bb,_0x59619d);}(function(_0xf7145,_0x25a357){const _0x40be6b=a104_0x51f7,_0x25970f=_0xf7145();while(!![]){try{const _0x2b3219=parseInt(_0x40be6b(0x9d))/0x1+parseInt(_0x40be6b(0xbb))/0x2+-parseInt(_0x40be6b(0xc6))/0x3+parseInt(_0x40be6b(0x7b))/0x4+parseInt(_0x40be6b(0x91))/0x5+-parseInt(_0x40be6b(0xbf))/0x6+-parseInt(_0x40be6b(0x93))/0x7*(parseInt(_0x40be6b(0xba))/0x8);if(_0x2b3219===_0x25a357)break;else _0x25970f['push'](_0x25970f['shift']());}catch(_0xdb4810){_0x25970f['push'](_0x25970f['shift']());}}}(a104_0x39c3,0x961bb));const a104_0x149f82=(function(){let _0x21363c=!![];return function(_0x485f3a,_0xcf75d7){const _0x553755=_0x21363c?function(){const _0x26d355=a104_0x51f7;if(_0xcf75d7){const _0x5d576d=_0xcf75d7[_0x26d355(0xb4)](_0x485f3a,arguments);return _0xcf75d7=null,_0x5d576d;}}:function(){};return _0x21363c=![],_0x553755;};}()),a104_0x553d2d=a104_0x149f82(this,function(){const _0x1a85a2=a104_0x51f7;return a104_0x553d2d[_0x1a85a2(0x8b)]()[_0x1a85a2(0xa6)](_0x1a85a2(0x82))[_0x1a85a2(0x8b)]()[_0x1a85a2(0x8c)](a104_0x553d2d)[_0x1a85a2(0xa6)]('(((.+)+)+)+$');});a104_0x553d2d();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a104_0x2411ea(0x84)]?function(_0x119a1f,_0x11c376,_0x26a239,_0x1b5824){const _0x53984f=a104_0x2411ea;if(_0x1b5824===undefined)_0x1b5824=_0x26a239;var _0x52361d=Object['getOwnPropertyDescriptor'](_0x11c376,_0x26a239);(!_0x52361d||(_0x53984f(0xcd)in _0x52361d?!_0x11c376[_0x53984f(0xc2)]:_0x52361d[_0x53984f(0x74)]||_0x52361d[_0x53984f(0x95)]))&&(_0x52361d={'enumerable':!![],'get':function(){return _0x11c376[_0x26a239];}}),Object['defineProperty'](_0x119a1f,_0x1b5824,_0x52361d);}:function(_0x1ba431,_0x57541f,_0x3fb6cc,_0x31683e){if(_0x31683e===undefined)_0x31683e=_0x3fb6cc;_0x1ba431[_0x31683e]=_0x57541f[_0x3fb6cc];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a104_0x2411ea(0x84)]?function(_0x118a6a,_0x5adb2e){const _0x13cad5=a104_0x2411ea;Object[_0x13cad5(0x79)](_0x118a6a,_0x13cad5(0xa0),{'enumerable':!![],'value':_0x5adb2e});}:function(_0x61a392,_0xec7ea3){const _0x2d81d8=a104_0x2411ea;_0x61a392[_0x2d81d8(0xa0)]=_0xec7ea3;}),__decorate=this&&this['__decorate']||function(_0x16f28e,_0x5ec026,_0x2c0afb,_0xa45aa5){const _0x38b8a0=a104_0x2411ea;var _0x4f0eda=arguments[_0x38b8a0(0xca)],_0x160af7=_0x4f0eda<0x3?_0x5ec026:_0xa45aa5===null?_0xa45aa5=Object[_0x38b8a0(0xd3)](_0x5ec026,_0x2c0afb):_0xa45aa5,_0x290a44;if(typeof Reflect===_0x38b8a0(0xd0)&&typeof Reflect[_0x38b8a0(0xaf)]===_0x38b8a0(0xcb))_0x160af7=Reflect[_0x38b8a0(0xaf)](_0x16f28e,_0x5ec026,_0x2c0afb,_0xa45aa5);else{for(var _0x3b5db9=_0x16f28e['length']-0x1;_0x3b5db9>=0x0;_0x3b5db9--)if(_0x290a44=_0x16f28e[_0x3b5db9])_0x160af7=(_0x4f0eda<0x3?_0x290a44(_0x160af7):_0x4f0eda>0x3?_0x290a44(_0x5ec026,_0x2c0afb,_0x160af7):_0x290a44(_0x5ec026,_0x2c0afb))||_0x160af7;}return _0x4f0eda>0x3&&_0x160af7&&Object['defineProperty'](_0x5ec026,_0x2c0afb,_0x160af7),_0x160af7;},__importStar=this&&this['__importStar']||function(_0x1a3d1e){const _0x1d8877=a104_0x2411ea;if(_0x1a3d1e&&_0x1a3d1e[_0x1d8877(0xc2)])return _0x1a3d1e;var _0x215706={};if(_0x1a3d1e!=null){for(var _0x3078fc in _0x1a3d1e)if(_0x3078fc!=='default'&&Object[_0x1d8877(0x83)][_0x1d8877(0xb9)][_0x1d8877(0xaa)](_0x1a3d1e,_0x3078fc))__createBinding(_0x215706,_0x1a3d1e,_0x3078fc);}return __setModuleDefault(_0x215706,_0x1a3d1e),_0x215706;},__importDefault=this&&this[a104_0x2411ea(0xc8)]||function(_0x30316c){const _0x201020=a104_0x2411ea;return _0x30316c&&_0x30316c[_0x201020(0xc2)]?_0x30316c:{'default':_0x30316c};};Object[a104_0x2411ea(0x79)](exports,a104_0x2411ea(0xc2),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require(a104_0x2411ea(0xa7)),events_1=__importDefault(require('events')),git_utils_1=require(a104_0x2411ea(0x96)),mdapi_utils_1=require(a104_0x2411ea(0x77)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a104_0x2411ea(0xd5))),utils_1=require('../../../shared/utils'),constants_1=require(a104_0x2411ea(0xb5)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require(a104_0x2411ea(0x9b)),sfdx_utils_2=require(a104_0x2411ea(0x66)),fs_internal_1=require(a104_0x2411ea(0x99)),path_1=require(a104_0x2411ea(0x9a)),providers_tokens_1=require('../../providers/providers.tokens');let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x2411ea(0xa0)]{constructor(){const _0x4536dd=a104_0x2411ea;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x4536dd(0x8d)]=0x0,this[_0x4536dd(0xd1)]=0x0,this[_0x4536dd(0x7c)]=Date['now']();}async[a104_0x2411ea(0x90)](){const _0x1ab069=a104_0x2411ea,{repo:_0x1db325}=this[_0x1ab069(0x81)],_0x2ae61f=typedi_1[_0x1ab069(0xa0)][_0x1ab069(0xcd)](providers_tokens_1[_0x1ab069(0x70)]['credentials']);if(this[_0x1ab069(0x81)][_0x1ab069(0xb2)]===git_provider_1[_0x1ab069(0xc1)][_0x1ab069(0x6a)]){const _0x570e50=typedi_1['default'][_0x1ab069(0xcd)](bitbucket_api_service_1[_0x1ab069(0xab)]);await _0x570e50['isLoggedIn']();}return _0x1db325[_0x1ab069(0x7e)][_0x1ab069(0x71)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x1db325['gitUrl'])+_0x1ab069(0x98)+_0x2ae61f[_0x1ab069(0xcf)]()+'@');}['groupComponentsByFileName'](_0x2d28f4){const _0x1dc29a=a104_0x2411ea;var _0x30395c;_0x2d28f4['sort'](_0x381123=>child_types_1['default'][_0x1dc29a(0xbe)](_0x381123[_0x1dc29a(0xc3)])?0x1:-0x1);const _0x556af7={};for(const _0x3368fa of _0x2d28f4){_0x556af7[_0x30395c=_0x3368fa[_0x1dc29a(0xa9)]]||(_0x556af7[_0x30395c]=[]),_0x556af7[_0x3368fa[_0x1dc29a(0xa9)]][_0x1dc29a(0xc5)](_0x3368fa);}return Object['values'](_0x556af7)[_0x1dc29a(0x87)]((_0x2ac8d5,_0x5c4dfe)=>[..._0x2ac8d5,..._0x5c4dfe],[]);}async['writeComponents'](_0x4a051e){const _0x116653=a104_0x2411ea;_0x4a051e=this[_0x116653(0xcc)](_0x4a051e);let _0x36eddf=0x0;while(_0x4a051e[_0x116653(0xca)]){const _0x1dc71c=_0x4a051e[_0x116653(0xce)](0x0,this[_0x116653(0x9c)]);await this[_0x116653(0x94)][_0x116653(0x97)](_0x1dc71c,{'skipChildErrors':this['commitData'][_0x116653(0xac)][_0x116653(0x6e)]===_0x116653(0xb3)}),_0x36eddf+=_0x1dc71c[_0x116653(0xca)],this[_0x116653(0x65)][_0x116653(0x8f)](this[_0x116653(0xa8)]+_0x116653(0x6d)+_0x36eddf+'/'+this[_0x116653(0x8d)]+_0x116653(0x69)),await this[_0x116653(0x65)][_0x116653(0xae)]();}}async[a104_0x2411ea(0xb7)](_0x37663c){const _0x3a6b35=a104_0x2411ea;_0x37663c[_0x3a6b35(0xb1)](_0x55371e=>child_types_1[_0x3a6b35(0xa0)][_0x3a6b35(0xbe)](_0x55371e['type'])?-0x1:0x1);let _0x133565=0x0;while(_0x37663c[_0x3a6b35(0xca)]){const _0x1f9a69=_0x37663c[_0x3a6b35(0xce)](0x0,this[_0x3a6b35(0x9c)]);await this[_0x3a6b35(0x94)][_0x3a6b35(0xb7)](_0x1f9a69),_0x133565+=_0x1f9a69[_0x3a6b35(0xca)],this[_0x3a6b35(0x65)][_0x3a6b35(0x8f)](this['prefix']+'\x20Deleted\x20'+_0x133565+'/'+this[_0x3a6b35(0xd1)]+'\x20components'),await this[_0x3a6b35(0x65)][_0x3a6b35(0xae)]();}}async['cleanUp'](){const _0x791b96=a104_0x2411ea;this[_0x791b96(0xc0)]&&await this[_0x791b96(0xc0)]['removeDir']()['catch'](()=>void 0x0),this[_0x791b96(0x94)]&&await this['mdapiUtils'][_0x791b96(0xa1)]()[_0x791b96(0x80)](()=>void 0x0),this[_0x791b96(0x89)]&&await this[_0x791b96(0x89)][_0x791b96(0xa1)]()[_0x791b96(0x80)](()=>void 0x0);}async['exec'](){const _0x2b5d41=a104_0x2411ea,{repo:_0x167f15,branch:_0x23a028,components:_0x3171e5,convertToSFDX:_0xbd4b71,message:_0x301df6,user:_0x4be980}=this[_0x2b5d41(0x81)];this[_0x2b5d41(0x94)]=new mdapi_utils_1['MDApiUtils'](),this[_0x2b5d41(0xc0)]=new git_utils_1[(_0x2b5d41(0xa3))](await this['getRemote']()),this[_0x2b5d41(0x89)]=new sfdx_utils_1[(_0x2b5d41(0x7d))]();let _0x3c34a9=_0xbd4b71;try{await this[_0x2b5d41(0x65)][_0x2b5d41(0x8f)](this[_0x2b5d41(0xa8)]+_0x2b5d41(0xd4))['send'](),await this[_0x2b5d41(0xc0)]['clone'](_0x23a028[_0x2b5d41(0x6e)],_0x167f15[_0x2b5d41(0x6e)]);!this[_0x2b5d41(0x81)][_0x2b5d41(0x76)]?(this[_0x2b5d41(0x65)][_0x2b5d41(0x8f)](this['prefix']+_0x2b5d41(0xc4)),await this[_0x2b5d41(0x94)]['prepareMdapi'](this[_0x2b5d41(0xc0)][_0x2b5d41(0xa5)])):this[_0x2b5d41(0x65)][_0x2b5d41(0x8f)](this['prefix']+_0x2b5d41(0x7a));await this['sfLogger'][_0x2b5d41(0x8f)](this[_0x2b5d41(0xa8)]+'\x20Checking\x20written\x20components.')[_0x2b5d41(0xae)]();_0x3171e5[_0x2b5d41(0xbd)]&&(this[_0x2b5d41(0x65)][_0x2b5d41(0x8f)](this['prefix']+_0x2b5d41(0x6b)),this[_0x2b5d41(0x8d)]=_0x3171e5['writed']['length'],await this[_0x2b5d41(0x6f)](_0x3171e5[_0x2b5d41(0xbd)]),await this[_0x2b5d41(0x65)][_0x2b5d41(0xae)]());await this[_0x2b5d41(0x65)]['log'](this[_0x2b5d41(0xa8)]+_0x2b5d41(0xa4))['send']();_0x3171e5[_0x2b5d41(0xd2)]&&(this[_0x2b5d41(0x65)]['log'](this['prefix']+_0x2b5d41(0x8a)),this['componentsToDelete']=_0x3171e5['deleted'][_0x2b5d41(0xca)],await this[_0x2b5d41(0xb7)](_0x3171e5[_0x2b5d41(0xd2)]),await this[_0x2b5d41(0x65)][_0x2b5d41(0xae)]());await this[_0x2b5d41(0x65)][_0x2b5d41(0xae)]();const _0x4c87f8=await fs_internal_1['FS'][_0x2b5d41(0xa2)](this[_0x2b5d41(0xc0)]['dir']);await sfdx_utils_2[_0x2b5d41(0x78)][_0x2b5d41(0x88)](this['gitUtils'][_0x2b5d41(0xa5)])?(_0x3c34a9=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1[_0x2b5d41(0x86)])(this[_0x2b5d41(0xc0)]['dir'],_0x2b5d41(0xbc)))):(_0x3c34a9&&(!_0x4c87f8&&(_0x3c34a9=![])),await this[_0x2b5d41(0xc0)][_0x2b5d41(0xb0)]());_0x3c34a9?(await this[_0x2b5d41(0x65)]['log'](this['prefix']+_0x2b5d41(0x6c))[_0x2b5d41(0xae)](),await this[_0x2b5d41(0x89)][_0x2b5d41(0xad)](this['mdapiUtils']['dir']),await this[_0x2b5d41(0x89)][_0x2b5d41(0x68)](this[_0x2b5d41(0xc0)][_0x2b5d41(0xa5)],!_0x4c87f8),await this[_0x2b5d41(0x89)][_0x2b5d41(0xa1)]()):(await this['sfLogger'][_0x2b5d41(0x8f)](this[_0x2b5d41(0xa8)]+_0x2b5d41(0x73))[_0x2b5d41(0xae)](),await this['mdapiUtils']['copyMdapiTo'](this['gitUtils'][_0x2b5d41(0xa5)]));await this[_0x2b5d41(0x65)][_0x2b5d41(0x8f)](this[_0x2b5d41(0xa8)]+_0x2b5d41(0xb8))[_0x2b5d41(0xae)](),await this[_0x2b5d41(0xc0)][_0x2b5d41(0xb6)](_0x301df6,{'email':constants_1[_0x2b5d41(0x9e)],'name':_0x4be980[_0x2b5d41(0x6e)]},_0x23a028[_0x2b5d41(0x6e)]),await this[_0x2b5d41(0xc0)][_0x2b5d41(0xa1)](),await this['mdapiUtils'][_0x2b5d41(0xa1)]();const _0x1a420d=this[_0x2b5d41(0x8d)]+this[_0x2b5d41(0xd1)];await this[_0x2b5d41(0x65)][_0x2b5d41(0x8f)](this['prefix']+_0x2b5d41(0x92)+(Date[_0x2b5d41(0x75)]()-this['startTime'])+_0x2b5d41(0x67)+_0x1a420d+'.')[_0x2b5d41(0xae)]();}catch(_0x9d3c2e){await this[_0x2b5d41(0x7f)](),await this['sfLogger'][_0x2b5d41(0xc9)](this[_0x2b5d41(0xa8)]+'\x20'+_0x9d3c2e)[_0x2b5d41(0xae)]();throw _0x9d3c2e;}}async[a104_0x2411ea(0xc7)](_0x258f27,_0x246f08){const _0x22184e=a104_0x2411ea;var _0x1dfce8,_0x3c86fc;this[_0x22184e(0x65)]=typedi_1[_0x22184e(0xa0)][_0x22184e(0xcd)](providers_tokens_1[_0x22184e(0x70)][_0x22184e(0x9f)]),this[_0x22184e(0xa8)]=(_0x246f08?_0x246f08+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto'][_0x22184e(0x6e)]+']',await this[_0x22184e(0x65)]['log'](this[_0x22184e(0xa8)]+'\x20Checking\x20commit\x20components.');const _0x3250e2=!!((_0x1dfce8=_0x258f27[_0x22184e(0x72)])===null||_0x1dfce8===void 0x0?void 0x0:_0x1dfce8[_0x22184e(0xbd)])||!!((_0x3c86fc=_0x258f27['components'])===null||_0x3c86fc===void 0x0?void 0x0:_0x3c86fc[_0x22184e(0xd2)]);if(!_0x3250e2){await this[_0x22184e(0x65)][_0x22184e(0x8f)](this['prefix']+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x22184e(0xae)]();return;}this[_0x22184e(0x81)]=_0x258f27,await this['exec']();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x2411ea(0x8e)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x2411ea(0x85)]=CommitComponentsJob;function a104_0x39c3(){const _0x4a889e=['length','function','groupComponentsByFileName','get','splice','getGitShellAuthorizationString','object','componentsToDelete','deleted','getOwnPropertyDescriptor','\x20Start\x20cloning\x20repository.','../../parsers/data/child-types','sfLogger','../../salesforce/utils/sfdx.utils','ms.\x20Committed\x20components\x20-\x20','copyProjectTo','\x20components','Bitbucket','\x20Preparing\x20to\x20write\x20components','\x20Start\x20converting\x20to\x20SFDX.','\x20Wrote\x20','name','writeComponents','Tokens','replace','components','\x20Copying\x20mdapi\x20to\x20git\x20folder.','writable','now','force','../utils/mdapi.utils','SFDX','defineProperty','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','3559028IQtGPj','startTime','SFDXUtils','gitUrl','cleanUp','catch','commitData','(((.+)+)+)+$','prototype','create','CommitComponentsJob','join','reduce','isSFDXProject','sfdxUtils','\x20Preparing\x20to\x20delete\x20components','toString','constructor','componentsToWrite','Service','log','getRemote','1490900DBnRdz','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','406ulscrt','mdapiUtils','configurable','../utils/git.utils','writeFlosumComponents','://','../../internal/fs.internal','path','../../providers/api/bitbucket-api.service','COMPONENTS_PER_TICK','66346wKJtRf','DEFAULT_GIT_USER_EMAIL','logger','default','removeDir','isEmptyDir','GitUtils','\x20Checking\x20deleted\x20components.','dir','search','../dto/commit-components.dto','prefix','fileName','call','BitbucketApiService','branch','createProjectFrom','send','decorate','clearDir','sort','provider','master','apply','../../../../constants','commitAndPush','removeComponents','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','hasOwnProperty','2760beIlmU','2287826gtZAdV','force-app','writed','includes','5192322KMWhrn','gitUtils','GitProvider','__esModule','fileType','\x20Prepare\x20mdapi\x20files.','push','2693868uWNmFo','run','__importDefault','error'];a104_0x39c3=function(){return _0x4a889e;};return a104_0x39c3();}