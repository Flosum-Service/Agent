const a104_0x53d664=a104_0x5b2b;(function(_0x1e0a83,_0x48693c){const _0x56f4c2=a104_0x5b2b,_0x4438a0=_0x1e0a83();while(!![]){try{const _0xc5f8cb=-parseInt(_0x56f4c2(0x112))/0x1*(-parseInt(_0x56f4c2(0x105))/0x2)+parseInt(_0x56f4c2(0x118))/0x3+-parseInt(_0x56f4c2(0x109))/0x4+parseInt(_0x56f4c2(0x12e))/0x5*(parseInt(_0x56f4c2(0x134))/0x6)+parseInt(_0x56f4c2(0x130))/0x7+parseInt(_0x56f4c2(0x152))/0x8+-parseInt(_0x56f4c2(0x153))/0x9;if(_0xc5f8cb===_0x48693c)break;else _0x4438a0['push'](_0x4438a0['shift']());}catch(_0x28b03c){_0x4438a0['push'](_0x4438a0['shift']());}}}(a104_0x4d27,0x67283));function a104_0x5b2b(_0x46a1fd,_0x2d876e){const _0x1edf25=a104_0x4d27();return a104_0x5b2b=function(_0x281b46,_0xf06672){_0x281b46=_0x281b46-0xf3;let _0x4d27cc=_0x1edf25[_0x281b46];return _0x4d27cc;},a104_0x5b2b(_0x46a1fd,_0x2d876e);}const a104_0xf06672=(function(){let _0x48aab7=!![];return function(_0x61f8c4,_0x3ae27d){const _0x20c776=_0x48aab7?function(){const _0x883ba2=a104_0x5b2b;if(_0x3ae27d){const _0x763155=_0x3ae27d[_0x883ba2(0x126)](_0x61f8c4,arguments);return _0x3ae27d=null,_0x763155;}}:function(){};return _0x48aab7=![],_0x20c776;};}()),a104_0x281b46=a104_0xf06672(this,function(){const _0x438c53=a104_0x5b2b;return a104_0x281b46[_0x438c53(0x147)]()['search'](_0x438c53(0x12b))[_0x438c53(0x147)]()[_0x438c53(0xfb)](a104_0x281b46)[_0x438c53(0x160)]('(((.+)+)+)+$');});a104_0x281b46();'use strict';var __createBinding=this&&this[a104_0x53d664(0xf9)]||(Object[a104_0x53d664(0x128)]?function(_0x3b6b7e,_0x86c630,_0x4b3caf,_0x595dba){const _0x563b4d=a104_0x53d664;if(_0x595dba===undefined)_0x595dba=_0x4b3caf;var _0x5a87f0=Object[_0x563b4d(0x144)](_0x86c630,_0x4b3caf);(!_0x5a87f0||(_0x563b4d(0x13a)in _0x5a87f0?!_0x86c630[_0x563b4d(0x14f)]:_0x5a87f0[_0x563b4d(0x11d)]||_0x5a87f0['configurable']))&&(_0x5a87f0={'enumerable':!![],'get':function(){return _0x86c630[_0x4b3caf];}}),Object['defineProperty'](_0x3b6b7e,_0x595dba,_0x5a87f0);}:function(_0xac8cc4,_0x90fdaa,_0x4cc358,_0x13fc7f){if(_0x13fc7f===undefined)_0x13fc7f=_0x4cc358;_0xac8cc4[_0x13fc7f]=_0x90fdaa[_0x4cc358];}),__setModuleDefault=this&&this[a104_0x53d664(0x13e)]||(Object[a104_0x53d664(0x128)]?function(_0x36ce6b,_0xfa189){const _0x50116d=a104_0x53d664;Object['defineProperty'](_0x36ce6b,_0x50116d(0x156),{'enumerable':!![],'value':_0xfa189});}:function(_0x131602,_0x30e505){const _0x57864e=a104_0x53d664;_0x131602[_0x57864e(0x156)]=_0x30e505;}),__decorate=this&&this['__decorate']||function(_0x175c66,_0x2224bf,_0x69dbfb,_0x568401){const _0x161966=a104_0x53d664;var _0x83df13=arguments[_0x161966(0x139)],_0x5968fe=_0x83df13<0x3?_0x2224bf:_0x568401===null?_0x568401=Object[_0x161966(0x144)](_0x2224bf,_0x69dbfb):_0x568401,_0x9888ae;if(typeof Reflect==='object'&&typeof Reflect[_0x161966(0x11c)]==='function')_0x5968fe=Reflect['decorate'](_0x175c66,_0x2224bf,_0x69dbfb,_0x568401);else{for(var _0x10580e=_0x175c66[_0x161966(0x139)]-0x1;_0x10580e>=0x0;_0x10580e--)if(_0x9888ae=_0x175c66[_0x10580e])_0x5968fe=(_0x83df13<0x3?_0x9888ae(_0x5968fe):_0x83df13>0x3?_0x9888ae(_0x2224bf,_0x69dbfb,_0x5968fe):_0x9888ae(_0x2224bf,_0x69dbfb))||_0x5968fe;}return _0x83df13>0x3&&_0x5968fe&&Object[_0x161966(0x143)](_0x2224bf,_0x69dbfb,_0x5968fe),_0x5968fe;},__importStar=this&&this[a104_0x53d664(0x15e)]||function(_0x1c0f12){const _0x4bdd3d=a104_0x53d664;if(_0x1c0f12&&_0x1c0f12['__esModule'])return _0x1c0f12;var _0x4191ed={};if(_0x1c0f12!=null){for(var _0x4f65ef in _0x1c0f12)if(_0x4f65ef!==_0x4bdd3d(0x156)&&Object[_0x4bdd3d(0x12a)]['hasOwnProperty'][_0x4bdd3d(0x113)](_0x1c0f12,_0x4f65ef))__createBinding(_0x4191ed,_0x1c0f12,_0x4f65ef);}return __setModuleDefault(_0x4191ed,_0x1c0f12),_0x4191ed;},__importDefault=this&&this['__importDefault']||function(_0x3ea002){const _0x50c3fd=a104_0x53d664;return _0x3ea002&&_0x3ea002[_0x50c3fd(0x14f)]?_0x3ea002:{'default':_0x3ea002};};Object[a104_0x53d664(0x143)](exports,a104_0x53d664(0x14f),{'value':!![]}),exports[a104_0x53d664(0x13c)]=void 0x0;const commit_components_dto_1=require(a104_0x53d664(0x10a)),events_1=__importDefault(require('events')),git_utils_1=require(a104_0x53d664(0x136)),mdapi_utils_1=require(a104_0x53d664(0xfe)),sfdx_utils_1=require(a104_0x53d664(0x114)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a104_0x53d664(0x119))),utils_1=require('../../../shared/utils'),constants_1=require(a104_0x53d664(0x142)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require(a104_0x53d664(0xfa)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a104_0x53d664(0x14b)),providers_tokens_1=require(a104_0x53d664(0x123)),constants_2=require('../../../../constants');function a104_0x4d27(){const _0x432fac=['prefix','\x20Preparing\x20to\x20write\x20components','fileType','\x20Preparing\x20to\x20delete\x20components','run','__importStar','type','search','fileName','componentsToDelete','logger','Tokens','groupComponentsByFileName','\x20Start\x20converting\x20to\x20SFDX.','splice','copyVlocityComponents','Service','://','cleanUp','__createBinding','../../providers/api/bitbucket-api.service','constructor','FORCE_APP_DEFAULT_DIR','clone','../utils/mdapi.utils','copyProjectTo','dir','DEFAULT_GIT_USER_EMAIL','removeDir','componentsToWrite','createProjectFrom','592754dPerHc','commitData','ms.\x20Committed\x20components\x20-\x20','\x20Wrote\x20','344680burgqE','../dto/commit-components.dto','MDApiUtils','join','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','getGitShellAuthorizationString','\x20Deleted\x20','components','log','2DWZVfK','call','../utils/sfdx.utils','writeFlosumComponents','writeComponents','provider','963687xDRvgs','../../parsers/data/child-types','\x20Copying\x20mdapi\x20to\x20git\x20folder.','error','decorate','writable','\x20components','removeComponents','\x20Checking\x20deleted\x20components.','CommitComponentsDto','commitAndPush','../../providers/providers.tokens','force-app','sort','apply','writed','create','isEmptyDir','prototype','(((.+)+)+)+$','gitUtils','catch','50OWUaxM','now','3733975mtmsPi','send','SFDXUtils','includes','157890RKKgoG','GitProvider','../utils/git.utils','values','BitbucketApiService','length','get','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','CommitComponentsJob','master','__setModuleDefault','\x20Start\x20cloning\x20repository.','exec','getRemote','../../../../constants','defineProperty','getOwnPropertyDescriptor','push','credentials','toString','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','COMPONENTS_PER_TICK','Bitbucket','path','copyMdapiTo','name','mdapiUtils','__esModule','startTime','deleted','3552952Wtyxlo','14813784diUZtK','sfLogger','GitUtils','default','sfdxUtils','prepareMdapi'];a104_0x4d27=function(){return _0x432fac;};return a104_0x4d27();}let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x53d664(0x156)]{constructor(){const _0x2c83d2=a104_0x53d664;super(...arguments),this[_0x2c83d2(0x149)]=0x3e8,this[_0x2c83d2(0x103)]=0x0,this[_0x2c83d2(0x162)]=0x0,this[_0x2c83d2(0x150)]=Date[_0x2c83d2(0x12f)]();}async['getRemote'](){const _0x386d5e=a104_0x53d664,{repo:_0x3e9f27}=this[_0x386d5e(0x106)],_0x4fa663=typedi_1[_0x386d5e(0x156)]['get'](providers_tokens_1[_0x386d5e(0x164)][_0x386d5e(0x146)]);if(this[_0x386d5e(0x106)][_0x386d5e(0x117)]===git_provider_1[_0x386d5e(0x135)][_0x386d5e(0x14a)]){const _0x1cf7b5=typedi_1[_0x386d5e(0x156)][_0x386d5e(0x13a)](bitbucket_api_service_1[_0x386d5e(0x138)]);await _0x1cf7b5['isLoggedIn']();}return _0x3e9f27['gitUrl']['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x3e9f27['gitUrl'])+_0x386d5e(0xf7)+_0x4fa663[_0x386d5e(0x10e)]()+'@');}[a104_0x53d664(0x165)](_0x6983ba){const _0x8b164c=a104_0x53d664;var _0x3b3846;_0x6983ba[_0x8b164c(0x125)](_0x4b822b=>child_types_1[_0x8b164c(0x156)][_0x8b164c(0x133)](_0x4b822b[_0x8b164c(0x15b)])?0x1:-0x1);const _0x16452b={};for(const _0x59ec69 of _0x6983ba){_0x16452b[_0x3b3846=_0x59ec69[_0x8b164c(0x161)]]||(_0x16452b[_0x3b3846]=[]),_0x16452b[_0x59ec69['fileName']][_0x8b164c(0x145)](_0x59ec69);}return Object[_0x8b164c(0x137)](_0x16452b)['reduce']((_0x4df1e5,_0x51ac3c)=>[..._0x4df1e5,..._0x51ac3c],[]);}async[a104_0x53d664(0x116)](_0x24659e){const _0x11ac22=a104_0x53d664;_0x24659e=this['groupComponentsByFileName'](_0x24659e);let _0x51f145=0x0;while(_0x24659e['length']){const _0x8f3706=_0x24659e[_0x11ac22(0xf4)](0x0,this[_0x11ac22(0x149)]);await this['mdapiUtils'][_0x11ac22(0x115)](_0x8f3706,{'skipChildErrors':this[_0x11ac22(0x106)]['branch'][_0x11ac22(0x14d)]===_0x11ac22(0x13d)}),_0x51f145+=_0x8f3706[_0x11ac22(0x139)],this[_0x11ac22(0x154)][_0x11ac22(0x111)](this['prefix']+_0x11ac22(0x108)+_0x51f145+'/'+this[_0x11ac22(0x103)]+_0x11ac22(0x11e)),await this[_0x11ac22(0x154)][_0x11ac22(0x131)]();}}async[a104_0x53d664(0x11f)](_0x3bd95f){const _0x4d8071=a104_0x53d664;_0x3bd95f['sort'](_0x24f2e8=>child_types_1[_0x4d8071(0x156)]['includes'](_0x24f2e8[_0x4d8071(0x15f)])?-0x1:0x1);let _0x246002=0x0;while(_0x3bd95f[_0x4d8071(0x139)]){const _0x2e2877=_0x3bd95f[_0x4d8071(0xf4)](0x0,this[_0x4d8071(0x149)]);await this['mdapiUtils'][_0x4d8071(0x11f)](_0x2e2877),_0x246002+=_0x2e2877[_0x4d8071(0x139)],this[_0x4d8071(0x154)][_0x4d8071(0x111)](this['prefix']+_0x4d8071(0x10f)+_0x246002+'/'+this[_0x4d8071(0x162)]+_0x4d8071(0x11e)),await this['sfLogger']['send']();}}async[a104_0x53d664(0xf8)](){const _0x1ea639=a104_0x53d664;this['gitUtils']&&await this[_0x1ea639(0x12c)]['removeDir']()[_0x1ea639(0x12d)](()=>void 0x0),this[_0x1ea639(0x14e)]&&await this[_0x1ea639(0x14e)]['removeDir']()['catch'](()=>void 0x0),this[_0x1ea639(0x157)]&&await this[_0x1ea639(0x157)]['removeDir']()[_0x1ea639(0x12d)](()=>void 0x0);}async[a104_0x53d664(0x140)](){const _0x152827=a104_0x53d664,{repo:_0x59c803,branch:_0x2e6141,components:_0x264e49,convertToSFDX:_0x52c0f1,message:_0x2ecd4b,user:_0x6ae626}=this[_0x152827(0x106)];this[_0x152827(0x14e)]=new mdapi_utils_1[(_0x152827(0x10b))](),this['gitUtils']=new git_utils_1[(_0x152827(0x155))](await this[_0x152827(0x141)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x152827(0x132))]();let _0x29a3b1=_0x52c0f1;try{await this[_0x152827(0x154)][_0x152827(0x111)](this[_0x152827(0x159)]+_0x152827(0x13f))[_0x152827(0x131)](),await this[_0x152827(0x12c)][_0x152827(0xfd)](_0x2e6141[_0x152827(0x14d)],_0x59c803[_0x152827(0x14d)]);!this[_0x152827(0x106)]['force']?(this[_0x152827(0x154)][_0x152827(0x111)](this[_0x152827(0x159)]+'\x20Prepare\x20mdapi\x20files.'),await this[_0x152827(0x14e)][_0x152827(0x158)](this['gitUtils'][_0x152827(0x100)])):this[_0x152827(0x154)][_0x152827(0x111)](this[_0x152827(0x159)]+_0x152827(0x148));await this['sfLogger'][_0x152827(0x111)](this[_0x152827(0x159)]+'\x20Checking\x20written\x20components.')[_0x152827(0x131)]();_0x264e49['writed']&&(this['sfLogger'][_0x152827(0x111)](this['prefix']+_0x152827(0x15a)),this[_0x152827(0x103)]=_0x264e49[_0x152827(0x127)][_0x152827(0x139)],await this[_0x152827(0x116)](_0x264e49[_0x152827(0x127)]),await this[_0x152827(0x154)]['send']());await this[_0x152827(0x154)][_0x152827(0x111)](this[_0x152827(0x159)]+_0x152827(0x120))[_0x152827(0x131)]();_0x264e49[_0x152827(0x151)]&&(this[_0x152827(0x154)]['log'](this[_0x152827(0x159)]+_0x152827(0x15c)),this[_0x152827(0x162)]=_0x264e49[_0x152827(0x151)][_0x152827(0x139)],await this[_0x152827(0x11f)](_0x264e49[_0x152827(0x151)]),await this['sfLogger'][_0x152827(0x131)]());await this[_0x152827(0x154)][_0x152827(0x131)]();const _0x5683db=await fs_internal_1['FS'][_0x152827(0x129)](this[_0x152827(0x12c)]['dir']);await sfdx_utils_2['SFDX']['isSFDXProject'](this[_0x152827(0x12c)][_0x152827(0x100)])?(_0x29a3b1=!![],await fs_internal_1['FS'][_0x152827(0x102)]((0x0,path_1[_0x152827(0x10c)])(this[_0x152827(0x12c)][_0x152827(0x100)],_0x152827(0x124)))):(_0x29a3b1&&(!_0x5683db&&(_0x29a3b1=![])),await this[_0x152827(0x12c)]['clearDir']());_0x29a3b1?(await this[_0x152827(0x154)][_0x152827(0x111)](this[_0x152827(0x159)]+_0x152827(0xf3))[_0x152827(0x131)](),await this[_0x152827(0x157)][_0x152827(0x104)](this['mdapiUtils'][_0x152827(0x100)]),await this[_0x152827(0x157)][_0x152827(0xff)](this['gitUtils'][_0x152827(0x100)],!_0x5683db),await this[_0x152827(0x157)][_0x152827(0xf5)](this['mdapiUtils'][_0x152827(0x100)],(0x0,path_1[_0x152827(0x10c)])(this[_0x152827(0x12c)][_0x152827(0x100)],constants_2[_0x152827(0xfc)])),await this[_0x152827(0x157)][_0x152827(0x102)]()):(await this[_0x152827(0x154)][_0x152827(0x111)](this['prefix']+_0x152827(0x11a))[_0x152827(0x131)](),await this[_0x152827(0x14e)][_0x152827(0x14c)](this[_0x152827(0x12c)][_0x152827(0x100)]));await this[_0x152827(0x154)][_0x152827(0x111)](this[_0x152827(0x159)]+_0x152827(0x13b))['send'](),await this[_0x152827(0x12c)][_0x152827(0x122)](_0x2ecd4b,{'email':constants_1[_0x152827(0x101)],'name':_0x6ae626[_0x152827(0x14d)]},_0x2e6141[_0x152827(0x14d)]),await this[_0x152827(0x12c)][_0x152827(0x102)](),await this[_0x152827(0x14e)][_0x152827(0x102)]();const _0x4f6ee0=this['componentsToWrite']+this[_0x152827(0x162)];await this['sfLogger'][_0x152827(0x111)](this['prefix']+_0x152827(0x10d)+(Date[_0x152827(0x12f)]()-this['startTime'])+_0x152827(0x107)+_0x4f6ee0+'.')[_0x152827(0x131)]();}catch(_0x3c01cd){await this[_0x152827(0xf8)](),await this[_0x152827(0x154)][_0x152827(0x11b)](this[_0x152827(0x159)]+'\x20'+_0x3c01cd)[_0x152827(0x131)]();throw _0x3c01cd;}}async[a104_0x53d664(0x15d)](_0x2d638d,_0xd7f47c){const _0x117aab=a104_0x53d664;var _0xe54e92,_0xf8e32f;this['sfLogger']=typedi_1['default'][_0x117aab(0x13a)](providers_tokens_1[_0x117aab(0x164)][_0x117aab(0x163)]),this['prefix']=(_0xd7f47c?_0xd7f47c+'\x20':'')+'['+commit_components_dto_1[_0x117aab(0x121)][_0x117aab(0x14d)]+']',await this[_0x117aab(0x154)][_0x117aab(0x111)](this['prefix']+'\x20Checking\x20commit\x20components.');const _0xc22608=!!((_0xe54e92=_0x2d638d[_0x117aab(0x110)])===null||_0xe54e92===void 0x0?void 0x0:_0xe54e92[_0x117aab(0x127)])||!!((_0xf8e32f=_0x2d638d[_0x117aab(0x110)])===null||_0xf8e32f===void 0x0?void 0x0:_0xf8e32f[_0x117aab(0x151)]);if(!_0xc22608){await this[_0x117aab(0x154)]['log'](this['prefix']+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x117aab(0x131)]();return;}this['commitData']=_0x2d638d,await this[_0x117aab(0x140)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x53d664(0xf6)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x53d664(0x13c)]=CommitComponentsJob;