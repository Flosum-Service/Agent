const a104_0x229cf4=a104_0x57ef;(function(_0x2429d2,_0x3e2e08){const _0x72b08c=a104_0x57ef,_0xcad951=_0x2429d2();while(!![]){try{const _0x55f576=parseInt(_0x72b08c(0x1b0))/0x1*(-parseInt(_0x72b08c(0x1c7))/0x2)+parseInt(_0x72b08c(0x196))/0x3+-parseInt(_0x72b08c(0x166))/0x4+-parseInt(_0x72b08c(0x17d))/0x5*(-parseInt(_0x72b08c(0x1d1))/0x6)+parseInt(_0x72b08c(0x19b))/0x7*(parseInt(_0x72b08c(0x177))/0x8)+-parseInt(_0x72b08c(0x1a8))/0x9+-parseInt(_0x72b08c(0x1a5))/0xa*(parseInt(_0x72b08c(0x175))/0xb);if(_0x55f576===_0x3e2e08)break;else _0xcad951['push'](_0xcad951['shift']());}catch(_0x5cbead){_0xcad951['push'](_0xcad951['shift']());}}}(a104_0x3af9,0x26ea4));function a104_0x3af9(){const _0x1455cb=['\x20Start\x20cloning\x20repository.','getGitShellAuthorizationString','\x20Wrote\x20','writeComponents','mdapiUtils','getOwnPropertyDescriptor','provider','logger','FORCE_APP_DEFAULT_DIR','GitProvider','replace','CommitComponentsJob','700359OgQuml','ms.\x20Committed\x20components\x20-\x20','484320cDIvRx','../utils/git.utils','commitData','create','call','getRemote','8755cdCySQ','sfdxUtils','credentials','isSFDXProject','prepareMdapi','constructor','join','force-app','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','now','removeDir','../../salesforce/utils/sfdx.utils','CommitComponentsDto','defineProperty','sfLogger','typedi','\x20Copying\x20mdapi\x20to\x20git\x20folder.','\x20Start\x20converting\x20to\x20SFDX.','SFDX','__esModule','__importDefault','isLoggedIn','cleanUp','writable','fileName','826035HuaiWB','run','getProtocol','../../providers/api/bitbucket-api.service','send','21NzVsHA','dir','master','branch','SFDXUtils','Bitbucket','decorate','splice','length','clearDir','40SGwOkm','reduce','\x20Preparing\x20to\x20delete\x20components','35145TiWAyn','error','removeComponents','gitUrl','events','exec','apply','hasOwnProperty','3AOuShV','components','deleted','COMPONENTS_PER_TICK','Tokens','../../../shared/utils','../../../../constants','prototype','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','componentsToWrite','isEmptyDir','gitUtils','componentsToDelete','../../providers/types/git-provider','DEFAULT_GIT_USER_EMAIL','__setModuleDefault','(((.+)+)+)+$','writeFlosumComponents','\x20Checking\x20deleted\x20components.','BitbucketApiService','catch','log','__importStar','4358iMGUCu','../../internal/fs.internal','\x20components','sort','\x20Deleted\x20','name','../dto/commit-components.dto','search','fileType','object','744nKYLpL','../utils/sfdx.utils','copyProjectTo','clone','includes','\x20Nothing\x20to\x20commit.\x20Skip.','configurable','prefix','get','writed','MDApiUtils','groupComponentsByFileName','toString','default','\x20Preparing\x20to\x20write\x20components','type','createProjectFrom','__decorate','998300jkWjkx','\x20Checking\x20written\x20components.','startTime'];a104_0x3af9=function(){return _0x1455cb;};return a104_0x3af9();}const a104_0x3afbbc=(function(){let _0x3f8e6a=!![];return function(_0x55481f,_0x4a4070){const _0x21b15d=_0x3f8e6a?function(){const _0x50dd3d=a104_0x57ef;if(_0x4a4070){const _0x462fbe=_0x4a4070[_0x50dd3d(0x1ae)](_0x55481f,arguments);return _0x4a4070=null,_0x462fbe;}}:function(){};return _0x3f8e6a=![],_0x21b15d;};}()),a104_0x2561fb=a104_0x3afbbc(this,function(){const _0x44e291=a104_0x57ef;return a104_0x2561fb[_0x44e291(0x160)]()['search'](_0x44e291(0x1c0))[_0x44e291(0x160)]()[_0x44e291(0x182)](a104_0x2561fb)[_0x44e291(0x1ce)](_0x44e291(0x1c0));});a104_0x2561fb();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a104_0x229cf4(0x17a)]?function(_0x441542,_0x25ffbf,_0x1d696f,_0x2dc776){const _0x2e99c5=a104_0x229cf4;if(_0x2dc776===undefined)_0x2dc776=_0x1d696f;var _0x3b7c21=Object[_0x2e99c5(0x16e)](_0x25ffbf,_0x1d696f);(!_0x3b7c21||(_0x2e99c5(0x15c)in _0x3b7c21?!_0x25ffbf[_0x2e99c5(0x190)]:_0x3b7c21[_0x2e99c5(0x194)]||_0x3b7c21[_0x2e99c5(0x15a)]))&&(_0x3b7c21={'enumerable':!![],'get':function(){return _0x25ffbf[_0x1d696f];}}),Object[_0x2e99c5(0x18a)](_0x441542,_0x2dc776,_0x3b7c21);}:function(_0x132679,_0x50fee1,_0x116979,_0x245f3d){if(_0x245f3d===undefined)_0x245f3d=_0x116979;_0x132679[_0x245f3d]=_0x50fee1[_0x116979];}),__setModuleDefault=this&&this[a104_0x229cf4(0x1bf)]||(Object[a104_0x229cf4(0x17a)]?function(_0x5b8ea5,_0x44bc23){const _0x1daf8f=a104_0x229cf4;Object[_0x1daf8f(0x18a)](_0x5b8ea5,_0x1daf8f(0x161),{'enumerable':!![],'value':_0x44bc23});}:function(_0x4e7c72,_0x4da6f6){const _0x37e3b5=a104_0x229cf4;_0x4e7c72[_0x37e3b5(0x161)]=_0x4da6f6;}),__decorate=this&&this[a104_0x229cf4(0x165)]||function(_0x5b1c40,_0x205e5c,_0x32b3d1,_0x118608){const _0x3ab358=a104_0x229cf4;var _0x8c6a84=arguments[_0x3ab358(0x1a3)],_0x4593a2=_0x8c6a84<0x3?_0x205e5c:_0x118608===null?_0x118608=Object[_0x3ab358(0x16e)](_0x205e5c,_0x32b3d1):_0x118608,_0x524a7b;if(typeof Reflect===_0x3ab358(0x1d0)&&typeof Reflect['decorate']==='function')_0x4593a2=Reflect[_0x3ab358(0x1a1)](_0x5b1c40,_0x205e5c,_0x32b3d1,_0x118608);else{for(var _0x113750=_0x5b1c40[_0x3ab358(0x1a3)]-0x1;_0x113750>=0x0;_0x113750--)if(_0x524a7b=_0x5b1c40[_0x113750])_0x4593a2=(_0x8c6a84<0x3?_0x524a7b(_0x4593a2):_0x8c6a84>0x3?_0x524a7b(_0x205e5c,_0x32b3d1,_0x4593a2):_0x524a7b(_0x205e5c,_0x32b3d1))||_0x4593a2;}return _0x8c6a84>0x3&&_0x4593a2&&Object['defineProperty'](_0x205e5c,_0x32b3d1,_0x4593a2),_0x4593a2;},__importStar=this&&this[a104_0x229cf4(0x1c6)]||function(_0x39894f){const _0x405bd5=a104_0x229cf4;if(_0x39894f&&_0x39894f[_0x405bd5(0x190)])return _0x39894f;var _0x5bd9df={};if(_0x39894f!=null){for(var _0x3a5745 in _0x39894f)if(_0x3a5745!==_0x405bd5(0x161)&&Object[_0x405bd5(0x1b7)][_0x405bd5(0x1af)][_0x405bd5(0x17b)](_0x39894f,_0x3a5745))__createBinding(_0x5bd9df,_0x39894f,_0x3a5745);}return __setModuleDefault(_0x5bd9df,_0x39894f),_0x5bd9df;},__importDefault=this&&this[a104_0x229cf4(0x191)]||function(_0x2887a5){const _0x501dda=a104_0x229cf4;return _0x2887a5&&_0x2887a5[_0x501dda(0x190)]?_0x2887a5:{'default':_0x2887a5};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a104_0x229cf4(0x174)]=void 0x0;const commit_components_dto_1=require(a104_0x229cf4(0x1cd)),events_1=__importDefault(require(a104_0x229cf4(0x1ac))),git_utils_1=require(a104_0x229cf4(0x178)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a104_0x229cf4(0x155)),typedi_1=__importStar(require(a104_0x229cf4(0x18c))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a104_0x229cf4(0x1b5)),constants_1=require(a104_0x229cf4(0x1b6)),git_provider_1=require(a104_0x229cf4(0x1bd)),bitbucket_api_service_1=require(a104_0x229cf4(0x199)),sfdx_utils_2=require(a104_0x229cf4(0x188)),fs_internal_1=require(a104_0x229cf4(0x1c8)),path_1=require('path'),providers_tokens_1=require('../../providers/providers.tokens'),constants_2=require(a104_0x229cf4(0x1b6));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x229cf4(0x161)]{constructor(){const _0x5eb860=a104_0x229cf4;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x5eb860(0x1b9)]=0x0,this[_0x5eb860(0x1bc)]=0x0,this[_0x5eb860(0x168)]=Date[_0x5eb860(0x186)]();}async['getRemote'](){const _0x3238af=a104_0x229cf4,{repo:_0x1e8ce8}=this[_0x3238af(0x179)],_0x26785e=typedi_1[_0x3238af(0x161)][_0x3238af(0x15c)](providers_tokens_1[_0x3238af(0x1b4)][_0x3238af(0x17f)]);if(this['commitData'][_0x3238af(0x16f)]===git_provider_1[_0x3238af(0x172)][_0x3238af(0x1a0)]){const _0x141458=typedi_1['default']['get'](bitbucket_api_service_1[_0x3238af(0x1c3)]);await _0x141458[_0x3238af(0x192)]();}return _0x1e8ce8['gitUrl'][_0x3238af(0x173)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x3238af(0x198)])(_0x1e8ce8[_0x3238af(0x1ab)])+'://'+_0x26785e[_0x3238af(0x16a)]()+'@');}[a104_0x229cf4(0x15f)](_0x515ecd){const _0x51107c=a104_0x229cf4;var _0x283ae1;_0x515ecd[_0x51107c(0x1ca)](_0x15f99f=>child_types_1[_0x51107c(0x161)][_0x51107c(0x158)](_0x15f99f[_0x51107c(0x1cf)])?0x1:-0x1);const _0x2f0bfb={};for(const _0x55e56c of _0x515ecd){_0x2f0bfb[_0x283ae1=_0x55e56c[_0x51107c(0x195)]]||(_0x2f0bfb[_0x283ae1]=[]),_0x2f0bfb[_0x55e56c[_0x51107c(0x195)]]['push'](_0x55e56c);}return Object['values'](_0x2f0bfb)[_0x51107c(0x1a6)]((_0x5e9eac,_0x282a7d)=>[..._0x5e9eac,..._0x282a7d],[]);}async['writeComponents'](_0x2d4656){const _0x30fbc9=a104_0x229cf4;_0x2d4656=this[_0x30fbc9(0x15f)](_0x2d4656);let _0x394fd9=0x0;while(_0x2d4656[_0x30fbc9(0x1a3)]){const _0x1813e0=_0x2d4656[_0x30fbc9(0x1a2)](0x0,this[_0x30fbc9(0x1b3)]);await this['mdapiUtils'][_0x30fbc9(0x1c1)](_0x1813e0,{'skipChildErrors':this[_0x30fbc9(0x179)][_0x30fbc9(0x19e)][_0x30fbc9(0x1cc)]===_0x30fbc9(0x19d)}),_0x394fd9+=_0x1813e0[_0x30fbc9(0x1a3)],this[_0x30fbc9(0x18b)][_0x30fbc9(0x1c5)](this[_0x30fbc9(0x15b)]+_0x30fbc9(0x16b)+_0x394fd9+'/'+this[_0x30fbc9(0x1b9)]+_0x30fbc9(0x1c9)),await this[_0x30fbc9(0x18b)][_0x30fbc9(0x19a)]();}}async[a104_0x229cf4(0x1aa)](_0x4bb8ec){const _0xb0394=a104_0x229cf4;_0x4bb8ec[_0xb0394(0x1ca)](_0x3f594e=>child_types_1[_0xb0394(0x161)][_0xb0394(0x158)](_0x3f594e[_0xb0394(0x163)])?-0x1:0x1);let _0x431291=0x0;while(_0x4bb8ec['length']){const _0x1abc5f=_0x4bb8ec[_0xb0394(0x1a2)](0x0,this[_0xb0394(0x1b3)]);await this[_0xb0394(0x16d)][_0xb0394(0x1aa)](_0x1abc5f),_0x431291+=_0x1abc5f['length'],this[_0xb0394(0x18b)]['log'](this[_0xb0394(0x15b)]+_0xb0394(0x1cb)+_0x431291+'/'+this['componentsToDelete']+_0xb0394(0x1c9)),await this[_0xb0394(0x18b)][_0xb0394(0x19a)]();}}async['cleanUp'](){const _0x67038d=a104_0x229cf4;this[_0x67038d(0x1bb)]&&await this[_0x67038d(0x1bb)][_0x67038d(0x187)]()[_0x67038d(0x1c4)](()=>void 0x0),this[_0x67038d(0x16d)]&&await this[_0x67038d(0x16d)][_0x67038d(0x187)]()[_0x67038d(0x1c4)](()=>void 0x0),this['sfdxUtils']&&await this[_0x67038d(0x17e)][_0x67038d(0x187)]()[_0x67038d(0x1c4)](()=>void 0x0);}async['exec'](){const _0x59eab8=a104_0x229cf4,{repo:_0x42ffcc,branch:_0x8cba35,components:_0xf4d3eb,convertToSFDX:_0x305c8b,message:_0x4a75cd,user:_0x5f5125}=this[_0x59eab8(0x179)];this[_0x59eab8(0x16d)]=new mdapi_utils_1[(_0x59eab8(0x15e))](),this[_0x59eab8(0x1bb)]=new git_utils_1['GitUtils'](await this[_0x59eab8(0x17c)]()),this[_0x59eab8(0x17e)]=new sfdx_utils_1[(_0x59eab8(0x19f))]();let _0x2399ac=_0x305c8b;try{await this[_0x59eab8(0x18b)][_0x59eab8(0x1c5)](this[_0x59eab8(0x15b)]+_0x59eab8(0x169))[_0x59eab8(0x19a)](),await this[_0x59eab8(0x1bb)][_0x59eab8(0x157)](_0x8cba35[_0x59eab8(0x1cc)],_0x42ffcc[_0x59eab8(0x1cc)]);!this[_0x59eab8(0x179)]['force']?(this[_0x59eab8(0x18b)][_0x59eab8(0x1c5)](this[_0x59eab8(0x15b)]+'\x20Prepare\x20mdapi\x20files.'),await this[_0x59eab8(0x16d)][_0x59eab8(0x181)](this[_0x59eab8(0x1bb)][_0x59eab8(0x19c)])):this[_0x59eab8(0x18b)]['log'](this['prefix']+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x59eab8(0x18b)][_0x59eab8(0x1c5)](this[_0x59eab8(0x15b)]+_0x59eab8(0x167))['send']();_0xf4d3eb[_0x59eab8(0x15d)]&&(this[_0x59eab8(0x18b)][_0x59eab8(0x1c5)](this['prefix']+_0x59eab8(0x162)),this[_0x59eab8(0x1b9)]=_0xf4d3eb['writed'][_0x59eab8(0x1a3)],await this[_0x59eab8(0x16c)](_0xf4d3eb[_0x59eab8(0x15d)]),await this['sfLogger'][_0x59eab8(0x19a)]());await this['sfLogger']['log'](this[_0x59eab8(0x15b)]+_0x59eab8(0x1c2))[_0x59eab8(0x19a)]();_0xf4d3eb['deleted']&&(this[_0x59eab8(0x18b)]['log'](this[_0x59eab8(0x15b)]+_0x59eab8(0x1a7)),this['componentsToDelete']=_0xf4d3eb[_0x59eab8(0x1b2)][_0x59eab8(0x1a3)],await this['removeComponents'](_0xf4d3eb[_0x59eab8(0x1b2)]),await this[_0x59eab8(0x18b)][_0x59eab8(0x19a)]());await this[_0x59eab8(0x18b)][_0x59eab8(0x19a)]();const _0x26aef0=await fs_internal_1['FS'][_0x59eab8(0x1ba)](this[_0x59eab8(0x1bb)]['dir']);await sfdx_utils_2[_0x59eab8(0x18f)][_0x59eab8(0x180)](this[_0x59eab8(0x1bb)][_0x59eab8(0x19c)])?(_0x2399ac=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1['join'])(this[_0x59eab8(0x1bb)][_0x59eab8(0x19c)],_0x59eab8(0x184)))):(_0x2399ac&&(!_0x26aef0&&(_0x2399ac=![])),await this['gitUtils'][_0x59eab8(0x1a4)]());_0x2399ac?(await this['sfLogger'][_0x59eab8(0x1c5)](this[_0x59eab8(0x15b)]+_0x59eab8(0x18e))['send'](),await this[_0x59eab8(0x17e)][_0x59eab8(0x164)](this[_0x59eab8(0x16d)][_0x59eab8(0x19c)]),await this[_0x59eab8(0x17e)][_0x59eab8(0x156)](this[_0x59eab8(0x1bb)][_0x59eab8(0x19c)],!_0x26aef0),await this[_0x59eab8(0x17e)]['copyVlocityComponents'](this[_0x59eab8(0x16d)][_0x59eab8(0x19c)],(0x0,path_1[_0x59eab8(0x183)])(this['gitUtils'][_0x59eab8(0x19c)],constants_2[_0x59eab8(0x171)])),await this[_0x59eab8(0x17e)][_0x59eab8(0x187)]()):(await this[_0x59eab8(0x18b)]['log'](this[_0x59eab8(0x15b)]+_0x59eab8(0x18d))[_0x59eab8(0x19a)](),await this[_0x59eab8(0x16d)]['copyMdapiTo'](this[_0x59eab8(0x1bb)]['dir']));await this[_0x59eab8(0x18b)][_0x59eab8(0x1c5)](this[_0x59eab8(0x15b)]+_0x59eab8(0x185))['send'](),await this['gitUtils']['commitAndPush'](_0x4a75cd,{'email':constants_1[_0x59eab8(0x1be)],'name':_0x5f5125[_0x59eab8(0x1cc)]},_0x8cba35['name']),await this[_0x59eab8(0x1bb)]['removeDir'](),await this[_0x59eab8(0x16d)][_0x59eab8(0x187)]();const _0x2936ad=this[_0x59eab8(0x1b9)]+this[_0x59eab8(0x1bc)];await this[_0x59eab8(0x18b)][_0x59eab8(0x1c5)](this[_0x59eab8(0x15b)]+_0x59eab8(0x1b8)+(Date[_0x59eab8(0x186)]()-this['startTime'])+_0x59eab8(0x176)+_0x2936ad+'.')[_0x59eab8(0x19a)]();}catch(_0x9cd935){await this[_0x59eab8(0x193)](),await this[_0x59eab8(0x18b)][_0x59eab8(0x1a9)](this[_0x59eab8(0x15b)]+'\x20'+_0x9cd935)[_0x59eab8(0x19a)]();throw _0x9cd935;}}async[a104_0x229cf4(0x197)](_0x385c75,_0x351038){const _0x1e0377=a104_0x229cf4;var _0x28f9c6,_0x1c65ba;this[_0x1e0377(0x18b)]=typedi_1[_0x1e0377(0x161)][_0x1e0377(0x15c)](providers_tokens_1[_0x1e0377(0x1b4)][_0x1e0377(0x170)]),this[_0x1e0377(0x15b)]=(_0x351038?_0x351038+'\x20':'')+'['+commit_components_dto_1[_0x1e0377(0x189)][_0x1e0377(0x1cc)]+']',await this[_0x1e0377(0x18b)][_0x1e0377(0x1c5)](this[_0x1e0377(0x15b)]+'\x20Checking\x20commit\x20components.');const _0x26590e=!!((_0x28f9c6=_0x385c75[_0x1e0377(0x1b1)])===null||_0x28f9c6===void 0x0?void 0x0:_0x28f9c6[_0x1e0377(0x15d)])||!!((_0x1c65ba=_0x385c75['components'])===null||_0x1c65ba===void 0x0?void 0x0:_0x1c65ba[_0x1e0377(0x1b2)]);if(!_0x26590e){await this[_0x1e0377(0x18b)][_0x1e0377(0x1c5)](this[_0x1e0377(0x15b)]+_0x1e0377(0x159))['send']();return;}this['commitData']=_0x385c75,await this[_0x1e0377(0x1ad)]();}};function a104_0x57ef(_0x1b2b7e,_0x5c344f){const _0x3968bc=a104_0x3af9();return a104_0x57ef=function(_0x2561fb,_0x3afbbc){_0x2561fb=_0x2561fb-0x155;let _0x3af9df=_0x3968bc[_0x2561fb];return _0x3af9df;},a104_0x57ef(_0x1b2b7e,_0x5c344f);}CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a104_0x229cf4(0x174)]=CommitComponentsJob;