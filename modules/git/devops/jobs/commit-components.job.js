const a104_0x5e6e1b=a104_0x470a;(function(_0x57fad6,_0x5c0cb4){const _0x6bd4c2=a104_0x470a,_0x160c0d=_0x57fad6();while(!![]){try{const _0x579f09=-parseInt(_0x6bd4c2(0xd1))/0x1+parseInt(_0x6bd4c2(0xcd))/0x2*(parseInt(_0x6bd4c2(0x132))/0x3)+-parseInt(_0x6bd4c2(0x104))/0x4+parseInt(_0x6bd4c2(0x131))/0x5+parseInt(_0x6bd4c2(0xfe))/0x6*(parseInt(_0x6bd4c2(0x117))/0x7)+-parseInt(_0x6bd4c2(0x106))/0x8*(-parseInt(_0x6bd4c2(0xef))/0x9)+-parseInt(_0x6bd4c2(0xfc))/0xa;if(_0x579f09===_0x5c0cb4)break;else _0x160c0d['push'](_0x160c0d['shift']());}catch(_0x210ccb){_0x160c0d['push'](_0x160c0d['shift']());}}}(a104_0x2893,0xd6465));function a104_0x470a(_0x2cdfb9,_0x55e5f3){const _0x5ab093=a104_0x2893();return a104_0x470a=function(_0xcd7ca6,_0x317daa){_0xcd7ca6=_0xcd7ca6-0xc5;let _0x2893bf=_0x5ab093[_0xcd7ca6];return _0x2893bf;},a104_0x470a(_0x2cdfb9,_0x55e5f3);}const a104_0x317daa=(function(){let _0x1ac59d=!![];return function(_0x37e9b2,_0x49ad77){const _0x29ee54=_0x1ac59d?function(){if(_0x49ad77){const _0x496f62=_0x49ad77['apply'](_0x37e9b2,arguments);return _0x49ad77=null,_0x496f62;}}:function(){};return _0x1ac59d=![],_0x29ee54;};}()),a104_0xcd7ca6=a104_0x317daa(this,function(){const _0x5d0393=a104_0x470a;return a104_0xcd7ca6[_0x5d0393(0x13b)]()['search']('(((.+)+)+)+$')['toString']()[_0x5d0393(0x11f)](a104_0xcd7ca6)[_0x5d0393(0x119)](_0x5d0393(0x10a));});a104_0xcd7ca6();'use strict';function a104_0x2893(){const _0x2f6138=['://','8XrXVaO','logger','force-app','length','(((.+)+)+)+$','\x20components','SFDXUtils','GitProvider','copyProjectTo','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','\x20Checking\x20commit\x20components.','Bitbucket','../../../shared/utils','cleanUp','join','prefix','includes','2177vdqSQY','create','search','../../salesforce/utils/sfdx.utils','splice','commitAndPush','CommitComponentsJob','createProjectFrom','constructor','copyMdapiTo','\x20Copying\x20mdapi\x20to\x20git\x20folder.','__createBinding','now','log','prototype','catch','\x20Nothing\x20to\x20commit.\x20Skip.','defineProperty','getProtocol','provider','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','values','path','fileName','groupComponentsByFileName','gitUtils','7882400JeiOkG','362442rSXRtB','decorate','componentsToDelete','\x20Preparing\x20to\x20write\x20components','branch','sort','hasOwnProperty','__esModule','../utils/sfdx.utils','toString','isLoggedIn','COMPONENTS_PER_TICK','getOwnPropertyDescriptor','gitUrl','deleted','isSFDXProject','type','startTime','26uZPXjW','removeComponents','SFDX','../../providers/providers.tokens','71817PqGdXl','../../providers/api/bitbucket-api.service','prepareMdapi','../utils/git.utils','commitData','removeDir','__importStar','\x20Checking\x20written\x20components.','fileType','getRemote','clearDir','object','../../providers/types/git-provider','get','typedi','default','DEFAULT_GIT_USER_EMAIL','\x20Checking\x20deleted\x20components.','writed','function','sfLogger','BitbucketApiService','send','replace','\x20Deleted\x20','__decorate','__importDefault','writable','exec','Service','14643441JDMdlH','ms.\x20Committed\x20components\x20-\x20','components','mdapiUtils','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','copyVlocityComponents','\x20Prepare\x20mdapi\x20files.','name','\x20Wrote\x20','componentsToWrite','configurable','\x20Start\x20cloning\x20repository.','push','46379760DCDPXp','writeComponents','24768rBJpAp','dir','Tokens','../dto/commit-components.dto','sfdxUtils','__setModuleDefault','1881828yLamIp'];a104_0x2893=function(){return _0x2f6138;};return a104_0x2893();}var __createBinding=this&&this[a104_0x5e6e1b(0x122)]||(Object[a104_0x5e6e1b(0x118)]?function(_0x4c2d59,_0x5497c5,_0x5888c4,_0x139af6){const _0x41d673=a104_0x5e6e1b;if(_0x139af6===undefined)_0x139af6=_0x5888c4;var _0x4e1963=Object[_0x41d673(0xc7)](_0x5497c5,_0x5888c4);(!_0x4e1963||(_0x41d673(0xde)in _0x4e1963?!_0x5497c5[_0x41d673(0x139)]:_0x4e1963[_0x41d673(0xec)]||_0x4e1963[_0x41d673(0xf9)]))&&(_0x4e1963={'enumerable':!![],'get':function(){return _0x5497c5[_0x5888c4];}}),Object[_0x41d673(0x128)](_0x4c2d59,_0x139af6,_0x4e1963);}:function(_0x4a1f36,_0x335379,_0x18f51d,_0x15034d){if(_0x15034d===undefined)_0x15034d=_0x18f51d;_0x4a1f36[_0x15034d]=_0x335379[_0x18f51d];}),__setModuleDefault=this&&this[a104_0x5e6e1b(0x103)]||(Object[a104_0x5e6e1b(0x118)]?function(_0x2ac1c8,_0x5f427a){const _0x1f9ac5=a104_0x5e6e1b;Object[_0x1f9ac5(0x128)](_0x2ac1c8,_0x1f9ac5(0xe0),{'enumerable':!![],'value':_0x5f427a});}:function(_0x250860,_0x33a110){_0x250860['default']=_0x33a110;}),__decorate=this&&this[a104_0x5e6e1b(0xea)]||function(_0xb2ac63,_0x15967c,_0x58f374,_0x4489ae){const _0x59995b=a104_0x5e6e1b;var _0x3c3732=arguments[_0x59995b(0x109)],_0x44c185=_0x3c3732<0x3?_0x15967c:_0x4489ae===null?_0x4489ae=Object['getOwnPropertyDescriptor'](_0x15967c,_0x58f374):_0x4489ae,_0x1f0d29;if(typeof Reflect===_0x59995b(0xdc)&&typeof Reflect[_0x59995b(0x133)]===_0x59995b(0xe4))_0x44c185=Reflect['decorate'](_0xb2ac63,_0x15967c,_0x58f374,_0x4489ae);else{for(var _0x14f24e=_0xb2ac63[_0x59995b(0x109)]-0x1;_0x14f24e>=0x0;_0x14f24e--)if(_0x1f0d29=_0xb2ac63[_0x14f24e])_0x44c185=(_0x3c3732<0x3?_0x1f0d29(_0x44c185):_0x3c3732>0x3?_0x1f0d29(_0x15967c,_0x58f374,_0x44c185):_0x1f0d29(_0x15967c,_0x58f374))||_0x44c185;}return _0x3c3732>0x3&&_0x44c185&&Object['defineProperty'](_0x15967c,_0x58f374,_0x44c185),_0x44c185;},__importStar=this&&this[a104_0x5e6e1b(0xd7)]||function(_0x3d2b6e){const _0x220bca=a104_0x5e6e1b;if(_0x3d2b6e&&_0x3d2b6e[_0x220bca(0x139)])return _0x3d2b6e;var _0x44e890={};if(_0x3d2b6e!=null){for(var _0x2e77a3 in _0x3d2b6e)if(_0x2e77a3!==_0x220bca(0xe0)&&Object[_0x220bca(0x125)][_0x220bca(0x138)]['call'](_0x3d2b6e,_0x2e77a3))__createBinding(_0x44e890,_0x3d2b6e,_0x2e77a3);}return __setModuleDefault(_0x44e890,_0x3d2b6e),_0x44e890;},__importDefault=this&&this[a104_0x5e6e1b(0xeb)]||function(_0x3a7604){const _0x9440af=a104_0x5e6e1b;return _0x3a7604&&_0x3a7604[_0x9440af(0x139)]?_0x3a7604:{'default':_0x3a7604};};Object[a104_0x5e6e1b(0x128)](exports,a104_0x5e6e1b(0x139),{'value':!![]}),exports[a104_0x5e6e1b(0x11d)]=void 0x0;const commit_components_dto_1=require(a104_0x5e6e1b(0x101)),events_1=__importDefault(require('events')),git_utils_1=require(a104_0x5e6e1b(0xd4)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a104_0x5e6e1b(0x13a)),typedi_1=__importStar(require(a104_0x5e6e1b(0xdf))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require(a104_0x5e6e1b(0x112)),constants_1=require('../../../../constants'),git_provider_1=require(a104_0x5e6e1b(0xdd)),bitbucket_api_service_1=require(a104_0x5e6e1b(0xd2)),sfdx_utils_2=require(a104_0x5e6e1b(0x11a)),fs_internal_1=require('../../internal/fs.internal'),path_1=require(a104_0x5e6e1b(0x12d)),providers_tokens_1=require(a104_0x5e6e1b(0xd0)),constants_2=require('../../../../constants');let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(){const _0xfecba1=a104_0x5e6e1b;super(...arguments),this[_0xfecba1(0xc6)]=0x3e8,this['componentsToWrite']=0x0,this[_0xfecba1(0x134)]=0x0,this['startTime']=Date[_0xfecba1(0x123)]();}async['getRemote'](){const _0x36b247=a104_0x5e6e1b,{repo:_0x150a98}=this[_0x36b247(0xd5)],_0x552ad1=typedi_1['default'][_0x36b247(0xde)](providers_tokens_1[_0x36b247(0x100)]['credentials']);if(this[_0x36b247(0xd5)][_0x36b247(0x12a)]===git_provider_1[_0x36b247(0x10d)][_0x36b247(0x111)]){const _0x4724a9=typedi_1[_0x36b247(0xe0)][_0x36b247(0xde)](bitbucket_api_service_1[_0x36b247(0xe6)]);await _0x4724a9[_0x36b247(0xc5)]();}return _0x150a98[_0x36b247(0xc8)][_0x36b247(0xe8)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x36b247(0x129)])(_0x150a98[_0x36b247(0xc8)])+_0x36b247(0x105)+_0x552ad1['getGitShellAuthorizationString']()+'@');}[a104_0x5e6e1b(0x12f)](_0x57cf7c){const _0x440bf1=a104_0x5e6e1b;var _0x1fdb1e;_0x57cf7c[_0x440bf1(0x137)](_0x52418d=>child_types_1['default'][_0x440bf1(0x116)](_0x52418d[_0x440bf1(0xd9)])?0x1:-0x1);const _0x3f5088={};for(const _0x80cede of _0x57cf7c){_0x3f5088[_0x1fdb1e=_0x80cede[_0x440bf1(0x12e)]]||(_0x3f5088[_0x1fdb1e]=[]),_0x3f5088[_0x80cede['fileName']][_0x440bf1(0xfb)](_0x80cede);}return Object[_0x440bf1(0x12c)](_0x3f5088)['reduce']((_0xdd28d4,_0x58805b)=>[..._0xdd28d4,..._0x58805b],[]);}async[a104_0x5e6e1b(0xfd)](_0x282528){const _0xbf47f2=a104_0x5e6e1b;_0x282528=this[_0xbf47f2(0x12f)](_0x282528);let _0x237463=0x0;while(_0x282528[_0xbf47f2(0x109)]){const _0x1a4db8=_0x282528[_0xbf47f2(0x11b)](0x0,this[_0xbf47f2(0xc6)]);await this[_0xbf47f2(0xf2)]['writeFlosumComponents'](_0x1a4db8,{'skipChildErrors':this[_0xbf47f2(0xd5)][_0xbf47f2(0x136)]['name']==='master'}),_0x237463+=_0x1a4db8[_0xbf47f2(0x109)],this[_0xbf47f2(0xe5)][_0xbf47f2(0x124)](this[_0xbf47f2(0x115)]+_0xbf47f2(0xf7)+_0x237463+'/'+this['componentsToWrite']+_0xbf47f2(0x10b)),await this[_0xbf47f2(0xe5)][_0xbf47f2(0xe7)]();}}async['removeComponents'](_0x292c67){const _0x54f47e=a104_0x5e6e1b;_0x292c67[_0x54f47e(0x137)](_0x7f2ae5=>child_types_1[_0x54f47e(0xe0)][_0x54f47e(0x116)](_0x7f2ae5[_0x54f47e(0xcb)])?-0x1:0x1);let _0x4d0127=0x0;while(_0x292c67[_0x54f47e(0x109)]){const _0x1787dd=_0x292c67[_0x54f47e(0x11b)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x54f47e(0xf2)]['removeComponents'](_0x1787dd),_0x4d0127+=_0x1787dd[_0x54f47e(0x109)],this[_0x54f47e(0xe5)][_0x54f47e(0x124)](this[_0x54f47e(0x115)]+_0x54f47e(0xe9)+_0x4d0127+'/'+this[_0x54f47e(0x134)]+_0x54f47e(0x10b)),await this[_0x54f47e(0xe5)][_0x54f47e(0xe7)]();}}async[a104_0x5e6e1b(0x113)](){const _0xd339f9=a104_0x5e6e1b;this[_0xd339f9(0x130)]&&await this[_0xd339f9(0x130)][_0xd339f9(0xd6)]()[_0xd339f9(0x126)](()=>void 0x0),this[_0xd339f9(0xf2)]&&await this[_0xd339f9(0xf2)][_0xd339f9(0xd6)]()['catch'](()=>void 0x0),this['sfdxUtils']&&await this[_0xd339f9(0x102)]['removeDir']()[_0xd339f9(0x126)](()=>void 0x0);}async[a104_0x5e6e1b(0xed)](){const _0x419a84=a104_0x5e6e1b,{repo:_0x3bdd30,branch:_0x4daf4e,components:_0x2fd991,convertToSFDX:_0x16dca6,message:_0x33ba4e,user:_0x210539}=this[_0x419a84(0xd5)];this[_0x419a84(0xf2)]=new mdapi_utils_1['MDApiUtils'](),this[_0x419a84(0x130)]=new git_utils_1['GitUtils'](await this[_0x419a84(0xda)]()),this[_0x419a84(0x102)]=new sfdx_utils_1[(_0x419a84(0x10c))]();let _0x13a3f6=_0x16dca6;try{await this[_0x419a84(0xe5)]['log'](this[_0x419a84(0x115)]+_0x419a84(0xfa))[_0x419a84(0xe7)](),await this[_0x419a84(0x130)]['clone'](_0x4daf4e[_0x419a84(0xf6)],_0x3bdd30['name']);!this[_0x419a84(0xd5)]['force']?(this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+_0x419a84(0xf5)),await this[_0x419a84(0xf2)][_0x419a84(0xd3)](this[_0x419a84(0x130)]['dir'])):this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+_0x419a84(0x10f));await this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+_0x419a84(0xd8))[_0x419a84(0xe7)]();_0x2fd991[_0x419a84(0xe3)]&&(this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+_0x419a84(0x135)),this[_0x419a84(0xf8)]=_0x2fd991['writed'][_0x419a84(0x109)],await this[_0x419a84(0xfd)](_0x2fd991['writed']),await this[_0x419a84(0xe5)][_0x419a84(0xe7)]());await this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+_0x419a84(0xe2))['send']();_0x2fd991[_0x419a84(0xc9)]&&(this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+'\x20Preparing\x20to\x20delete\x20components'),this['componentsToDelete']=_0x2fd991['deleted'][_0x419a84(0x109)],await this[_0x419a84(0xce)](_0x2fd991['deleted']),await this[_0x419a84(0xe5)][_0x419a84(0xe7)]());await this[_0x419a84(0xe5)][_0x419a84(0xe7)]();const _0x34a84=await fs_internal_1['FS']['isEmptyDir'](this[_0x419a84(0x130)][_0x419a84(0xff)]);await sfdx_utils_2[_0x419a84(0xcf)][_0x419a84(0xca)](this[_0x419a84(0x130)][_0x419a84(0xff)])?(_0x13a3f6=!![],await fs_internal_1['FS'][_0x419a84(0xd6)]((0x0,path_1[_0x419a84(0x114)])(this[_0x419a84(0x130)][_0x419a84(0xff)],_0x419a84(0x108)))):(_0x13a3f6&&(!_0x34a84&&(_0x13a3f6=![])),await this['gitUtils'][_0x419a84(0xdb)]());_0x13a3f6?(await this['sfLogger']['log'](this[_0x419a84(0x115)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x419a84(0xe7)](),await this[_0x419a84(0x102)][_0x419a84(0x11e)](this[_0x419a84(0xf2)]['dir']),await this[_0x419a84(0x102)][_0x419a84(0x10e)](this[_0x419a84(0x130)]['dir'],!_0x34a84),await this[_0x419a84(0x102)][_0x419a84(0xf4)](this[_0x419a84(0xf2)][_0x419a84(0xff)],(0x0,path_1[_0x419a84(0x114)])(this[_0x419a84(0x130)]['dir'],constants_2['FORCE_APP_DEFAULT_DIR'])),await this[_0x419a84(0x102)][_0x419a84(0xd6)]()):(await this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+_0x419a84(0x121))[_0x419a84(0xe7)](),await this[_0x419a84(0xf2)][_0x419a84(0x120)](this[_0x419a84(0x130)][_0x419a84(0xff)]));await this[_0x419a84(0xe5)][_0x419a84(0x124)](this[_0x419a84(0x115)]+_0x419a84(0x12b))[_0x419a84(0xe7)](),await this[_0x419a84(0x130)][_0x419a84(0x11c)](_0x33ba4e,{'email':constants_1[_0x419a84(0xe1)],'name':_0x210539[_0x419a84(0xf6)]},_0x4daf4e[_0x419a84(0xf6)]),await this[_0x419a84(0x130)]['removeDir'](),await this[_0x419a84(0xf2)][_0x419a84(0xd6)]();const _0x1cdc00=this[_0x419a84(0xf8)]+this[_0x419a84(0x134)];await this[_0x419a84(0xe5)]['log'](this[_0x419a84(0x115)]+_0x419a84(0xf3)+(Date[_0x419a84(0x123)]()-this[_0x419a84(0xcc)])+_0x419a84(0xf0)+_0x1cdc00+'.')[_0x419a84(0xe7)]();}catch(_0x5257cf){await this[_0x419a84(0x113)](),await this[_0x419a84(0xe5)]['error'](this[_0x419a84(0x115)]+'\x20'+_0x5257cf)[_0x419a84(0xe7)]();throw _0x5257cf;}}async['run'](_0x40277a,_0x2ea63a){const _0x27f0d3=a104_0x5e6e1b;var _0x5e4067,_0x42a312;this[_0x27f0d3(0xe5)]=typedi_1[_0x27f0d3(0xe0)][_0x27f0d3(0xde)](providers_tokens_1[_0x27f0d3(0x100)][_0x27f0d3(0x107)]),this[_0x27f0d3(0x115)]=(_0x2ea63a?_0x2ea63a+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto']['name']+']',await this[_0x27f0d3(0xe5)]['log'](this[_0x27f0d3(0x115)]+_0x27f0d3(0x110));const _0x1e4900=!!((_0x5e4067=_0x40277a[_0x27f0d3(0xf1)])===null||_0x5e4067===void 0x0?void 0x0:_0x5e4067[_0x27f0d3(0xe3)])||!!((_0x42a312=_0x40277a[_0x27f0d3(0xf1)])===null||_0x42a312===void 0x0?void 0x0:_0x42a312[_0x27f0d3(0xc9)]);if(!_0x1e4900){await this[_0x27f0d3(0xe5)]['log'](this[_0x27f0d3(0x115)]+_0x27f0d3(0x127))['send']();return;}this[_0x27f0d3(0xd5)]=_0x40277a,await this[_0x27f0d3(0xed)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x5e6e1b(0xee)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x5e6e1b(0x11d)]=CommitComponentsJob;