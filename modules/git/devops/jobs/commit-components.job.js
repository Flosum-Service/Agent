const a103_0x77e599=a103_0x465c;function a103_0x5eb9(){const _0x5e35e7=['credentials','fileName','sfdxUtils','deleted','join','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','copyProjectTo','getGitShellAuthorizationString','3680530xEPQPG','error','isLoggedIn','writed','33bYVovR','master','gitUrl','force-app','object','16649226jCmAZT','__importDefault','COMPONENTS_PER_TICK','../../internal/fs.internal','search','../utils/mdapi.utils','(((.+)+)+)+$','66PQzXSb','hasOwnProperty','cleanUp','removeDir','\x20Checking\x20deleted\x20components.','writeFlosumComponents','values','writeComponents','Tokens','function','__esModule','../utils/git.utils','groupComponentsByFileName','includes','dir','defineProperty','104659EtqoId','../../providers/api/bitbucket-api.service','length','sfLogger','clone','createProjectFrom','removeComponents','create','path','commitAndPush','fileType','\x20Prepare\x20mdapi\x20files.','copyMdapiTo','SFDX','push','__setModuleDefault','\x20Checking\x20commit\x20components.','log','get','\x20Nothing\x20to\x20commit.\x20Skip.','gitUtils','writable','getOwnPropertyDescriptor','componentsToDelete','branch','reduce','now','provider','CommitComponentsDto','\x20Deleted\x20','mdapiUtils','../utils/sfdx.utils','startTime','1490013FquLlh','constructor','\x20components','../../../shared/utils','__importStar','prefix','sort','getProtocol','type','2216RdMHXK','\x20Copying\x20mdapi\x20to\x20git\x20folder.','CommitComponentsJob','apply','../dto/commit-components.dto','decorate','logger','../../providers/types/git-provider','://','4IeppHI','7945IvfRGF','isEmptyDir','events','MDApiUtils','GitProvider','../../providers/providers.tokens','../../parsers/data/child-types','isSFDXProject','componentsToWrite','typedi','Bitbucket','toString','commitData','\x20Wrote\x20','prepareMdapi','\x20Preparing\x20to\x20write\x20components','SFDXUtils','BitbucketApiService','\x20Start\x20cloning\x20repository.','send','default','139300gmexLP','components','name','209428umAlVn','getRemote','force','run','../../salesforce/utils/sfdx.utils','catch'];a103_0x5eb9=function(){return _0x5e35e7;};return a103_0x5eb9();}function a103_0x465c(_0x29dcd2,_0x202973){const _0xa6defe=a103_0x5eb9();return a103_0x465c=function(_0x347820,_0x2c653f){_0x347820=_0x347820-0xc8;let _0x5eb92e=_0xa6defe[_0x347820];return _0x5eb92e;},a103_0x465c(_0x29dcd2,_0x202973);}(function(_0x46b4a0,_0x4b0e60){const _0x1fb6b2=a103_0x465c,_0xf7b3ce=_0x46b4a0();while(!![]){try{const _0x154522=parseInt(_0x1fb6b2(0x12e))/0x1*(-parseInt(_0x1fb6b2(0xe7))/0x2)+parseInt(_0x1fb6b2(0x112))/0x3*(-parseInt(_0x1fb6b2(0x100))/0x4)+parseInt(_0x1fb6b2(0xfd))/0x5*(-parseInt(_0x1fb6b2(0x11e))/0x6)+-parseInt(_0x1fb6b2(0xe8))/0x7*(parseInt(_0x1fb6b2(0xde))/0x8)+-parseInt(_0x1fb6b2(0xd5))/0x9+parseInt(_0x1fb6b2(0x10e))/0xa+parseInt(_0x1fb6b2(0x117))/0xb;if(_0x154522===_0x4b0e60)break;else _0xf7b3ce['push'](_0xf7b3ce['shift']());}catch(_0x230a9a){_0xf7b3ce['push'](_0xf7b3ce['shift']());}}}(a103_0x5eb9,0x4baca));const a103_0x2c653f=(function(){let _0x1941da=!![];return function(_0x402753,_0x39dc7b){const _0x536785=_0x1941da?function(){const _0x183222=a103_0x465c;if(_0x39dc7b){const _0x589daf=_0x39dc7b[_0x183222(0xe1)](_0x402753,arguments);return _0x39dc7b=null,_0x589daf;}}:function(){};return _0x1941da=![],_0x536785;};}()),a103_0x347820=a103_0x2c653f(this,function(){const _0x5f14ba=a103_0x465c;return a103_0x347820[_0x5f14ba(0xf3)]()[_0x5f14ba(0x11b)](_0x5f14ba(0x11d))[_0x5f14ba(0xf3)]()[_0x5f14ba(0xd6)](a103_0x347820)['search'](_0x5f14ba(0x11d));});a103_0x347820();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a103_0x77e599(0x135)]?function(_0x62d5f4,_0x4ca562,_0x542c26,_0x37a552){const _0x431cdb=a103_0x77e599;if(_0x37a552===undefined)_0x37a552=_0x542c26;var _0x3bc7b9=Object[_0x431cdb(0xca)](_0x4ca562,_0x542c26);(!_0x3bc7b9||(_0x431cdb(0x140)in _0x3bc7b9?!_0x4ca562['__esModule']:_0x3bc7b9[_0x431cdb(0xc9)]||_0x3bc7b9['configurable']))&&(_0x3bc7b9={'enumerable':!![],'get':function(){return _0x4ca562[_0x542c26];}}),Object['defineProperty'](_0x62d5f4,_0x37a552,_0x3bc7b9);}:function(_0x2cd660,_0x441869,_0x8fc725,_0x17c053){if(_0x17c053===undefined)_0x17c053=_0x8fc725;_0x2cd660[_0x17c053]=_0x441869[_0x8fc725];}),__setModuleDefault=this&&this[a103_0x77e599(0x13d)]||(Object['create']?function(_0xb8d3c4,_0xc9a266){const _0x32495d=a103_0x77e599;Object[_0x32495d(0x12d)](_0xb8d3c4,_0x32495d(0xfc),{'enumerable':!![],'value':_0xc9a266});}:function(_0x21b5f5,_0x49cac2){const _0x2f9dae=a103_0x77e599;_0x21b5f5[_0x2f9dae(0xfc)]=_0x49cac2;}),__decorate=this&&this['__decorate']||function(_0x3400f7,_0x18deb1,_0x19e11a,_0x5115cd){const _0x38d091=a103_0x77e599;var _0x15e992=arguments[_0x38d091(0x130)],_0x4d1166=_0x15e992<0x3?_0x18deb1:_0x5115cd===null?_0x5115cd=Object[_0x38d091(0xca)](_0x18deb1,_0x19e11a):_0x5115cd,_0x152db2;if(typeof Reflect===_0x38d091(0x116)&&typeof Reflect[_0x38d091(0xe3)]===_0x38d091(0x127))_0x4d1166=Reflect[_0x38d091(0xe3)](_0x3400f7,_0x18deb1,_0x19e11a,_0x5115cd);else{for(var _0x30f2fb=_0x3400f7[_0x38d091(0x130)]-0x1;_0x30f2fb>=0x0;_0x30f2fb--)if(_0x152db2=_0x3400f7[_0x30f2fb])_0x4d1166=(_0x15e992<0x3?_0x152db2(_0x4d1166):_0x15e992>0x3?_0x152db2(_0x18deb1,_0x19e11a,_0x4d1166):_0x152db2(_0x18deb1,_0x19e11a))||_0x4d1166;}return _0x15e992>0x3&&_0x4d1166&&Object[_0x38d091(0x12d)](_0x18deb1,_0x19e11a,_0x4d1166),_0x4d1166;},__importStar=this&&this[a103_0x77e599(0xd9)]||function(_0x1c1898){const _0x28f51a=a103_0x77e599;if(_0x1c1898&&_0x1c1898[_0x28f51a(0x128)])return _0x1c1898;var _0x2f01be={};if(_0x1c1898!=null){for(var _0x2da510 in _0x1c1898)if(_0x2da510!==_0x28f51a(0xfc)&&Object['prototype'][_0x28f51a(0x11f)]['call'](_0x1c1898,_0x2da510))__createBinding(_0x2f01be,_0x1c1898,_0x2da510);}return __setModuleDefault(_0x2f01be,_0x1c1898),_0x2f01be;},__importDefault=this&&this[a103_0x77e599(0x118)]||function(_0x321408){const _0x4f7d76=a103_0x77e599;return _0x321408&&_0x321408[_0x4f7d76(0x128)]?_0x321408:{'default':_0x321408};};Object[a103_0x77e599(0x12d)](exports,a103_0x77e599(0x128),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const commit_components_dto_1=require(a103_0x77e599(0xe2)),events_1=__importDefault(require(a103_0x77e599(0xea))),git_utils_1=require(a103_0x77e599(0x129)),mdapi_utils_1=require(a103_0x77e599(0x11c)),sfdx_utils_1=require(a103_0x77e599(0xd3)),typedi_1=__importStar(require(a103_0x77e599(0xf1))),child_types_1=__importDefault(require(a103_0x77e599(0xee))),utils_1=require(a103_0x77e599(0xd8)),constants_1=require('../../../../constants'),git_provider_1=require(a103_0x77e599(0xe5)),bitbucket_api_service_1=require(a103_0x77e599(0x12f)),sfdx_utils_2=require(a103_0x77e599(0x104)),fs_internal_1=require(a103_0x77e599(0x11a)),path_1=require(a103_0x77e599(0x136)),providers_tokens_1=require(a103_0x77e599(0xed));let CommitComponentsJob=class CommitComponentsJob extends events_1[a103_0x77e599(0xfc)]{constructor(){const _0x31863e=a103_0x77e599;super(...arguments),this[_0x31863e(0x119)]=0x3e8,this['componentsToWrite']=0x0,this[_0x31863e(0xcb)]=0x0,this['startTime']=Date[_0x31863e(0xce)]();}async[a103_0x77e599(0x101)](){const _0x2a855f=a103_0x77e599,{repo:_0x699d98}=this['commitData'],_0x8d070a=typedi_1[_0x2a855f(0xfc)][_0x2a855f(0x140)](providers_tokens_1[_0x2a855f(0x126)][_0x2a855f(0x106)]);if(this['commitData'][_0x2a855f(0xcf)]===git_provider_1[_0x2a855f(0xec)][_0x2a855f(0xf2)]){const _0x47e388=typedi_1[_0x2a855f(0xfc)][_0x2a855f(0x140)](bitbucket_api_service_1[_0x2a855f(0xf9)]);await _0x47e388[_0x2a855f(0x110)]();}return _0x699d98['gitUrl']['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x2a855f(0xdc)])(_0x699d98[_0x2a855f(0x114)])+_0x2a855f(0xe6)+_0x8d070a[_0x2a855f(0x10d)]()+'@');}['groupComponentsByFileName'](_0x426e72){const _0x2ce0fc=a103_0x77e599;var _0x2b52e6;_0x426e72[_0x2ce0fc(0xdb)](_0x428955=>child_types_1['default'][_0x2ce0fc(0x12b)](_0x428955[_0x2ce0fc(0x138)])?0x1:-0x1);const _0x4ea98a={};for(const _0x135648 of _0x426e72){_0x4ea98a[_0x2b52e6=_0x135648[_0x2ce0fc(0x107)]]||(_0x4ea98a[_0x2b52e6]=[]),_0x4ea98a[_0x135648[_0x2ce0fc(0x107)]][_0x2ce0fc(0x13c)](_0x135648);}return Object[_0x2ce0fc(0x124)](_0x4ea98a)[_0x2ce0fc(0xcd)]((_0x3e42a6,_0x238234)=>[..._0x3e42a6,..._0x238234],[]);}async[a103_0x77e599(0x125)](_0x58dfe4){const _0x1f5234=a103_0x77e599;_0x58dfe4=this[_0x1f5234(0x12a)](_0x58dfe4);let _0x86bab9=0x0;while(_0x58dfe4['length']){const _0x5e995a=_0x58dfe4['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x1f5234(0xd2)][_0x1f5234(0x123)](_0x5e995a,{'skipChildErrors':this['commitData'][_0x1f5234(0xcc)][_0x1f5234(0xff)]===_0x1f5234(0x113)}),_0x86bab9+=_0x5e995a[_0x1f5234(0x130)],this[_0x1f5234(0x131)][_0x1f5234(0x13f)](this[_0x1f5234(0xda)]+_0x1f5234(0xf5)+_0x86bab9+'/'+this[_0x1f5234(0xf0)]+_0x1f5234(0xd7)),await this[_0x1f5234(0x131)][_0x1f5234(0xfb)]();}}async[a103_0x77e599(0x134)](_0xae593e){const _0x35e8b4=a103_0x77e599;_0xae593e[_0x35e8b4(0xdb)](_0x49c750=>child_types_1[_0x35e8b4(0xfc)][_0x35e8b4(0x12b)](_0x49c750[_0x35e8b4(0xdd)])?-0x1:0x1);let _0x464e36=0x0;while(_0xae593e[_0x35e8b4(0x130)]){const _0x1185ed=_0xae593e['splice'](0x0,this[_0x35e8b4(0x119)]);await this[_0x35e8b4(0xd2)][_0x35e8b4(0x134)](_0x1185ed),_0x464e36+=_0x1185ed[_0x35e8b4(0x130)],this[_0x35e8b4(0x131)]['log'](this[_0x35e8b4(0xda)]+_0x35e8b4(0xd1)+_0x464e36+'/'+this[_0x35e8b4(0xcb)]+_0x35e8b4(0xd7)),await this['sfLogger'][_0x35e8b4(0xfb)]();}}async[a103_0x77e599(0x120)](){const _0x4ac2e8=a103_0x77e599;this[_0x4ac2e8(0xc8)]&&await this[_0x4ac2e8(0xc8)][_0x4ac2e8(0x121)]()[_0x4ac2e8(0x105)](()=>void 0x0),this[_0x4ac2e8(0xd2)]&&await this[_0x4ac2e8(0xd2)]['removeDir']()[_0x4ac2e8(0x105)](()=>void 0x0),this['sfdxUtils']&&await this[_0x4ac2e8(0x108)][_0x4ac2e8(0x121)]()[_0x4ac2e8(0x105)](()=>void 0x0);}async['exec'](){const _0x384795=a103_0x77e599,{repo:_0x10e88c,branch:_0x34a73b,components:_0x713436,convertToSFDX:_0x1d6eba,message:_0x5bbd15,user:_0xd840fd}=this['commitData'];this[_0x384795(0xd2)]=new mdapi_utils_1[(_0x384795(0xeb))](),this['gitUtils']=new git_utils_1['GitUtils'](await this[_0x384795(0x101)]()),this[_0x384795(0x108)]=new sfdx_utils_1[(_0x384795(0xf8))]();let _0x179684=_0x1d6eba;try{await this[_0x384795(0x131)][_0x384795(0x13f)](this[_0x384795(0xda)]+_0x384795(0xfa))[_0x384795(0xfb)](),await this['gitUtils'][_0x384795(0x132)](_0x34a73b[_0x384795(0xff)],_0x10e88c[_0x384795(0xff)]);!this[_0x384795(0xf4)][_0x384795(0x102)]?(this[_0x384795(0x131)][_0x384795(0x13f)](this['prefix']+_0x384795(0x139)),await this[_0x384795(0xd2)][_0x384795(0xf6)](this['gitUtils'][_0x384795(0x12c)])):this[_0x384795(0x131)][_0x384795(0x13f)](this[_0x384795(0xda)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x384795(0x131)][_0x384795(0x13f)](this[_0x384795(0xda)]+'\x20Checking\x20written\x20components.')[_0x384795(0xfb)]();_0x713436[_0x384795(0x111)]&&(this[_0x384795(0x131)][_0x384795(0x13f)](this[_0x384795(0xda)]+_0x384795(0xf7)),this[_0x384795(0xf0)]=_0x713436[_0x384795(0x111)][_0x384795(0x130)],await this[_0x384795(0x125)](_0x713436[_0x384795(0x111)]),await this[_0x384795(0x131)][_0x384795(0xfb)]());await this[_0x384795(0x131)]['log'](this[_0x384795(0xda)]+_0x384795(0x122))['send']();_0x713436['deleted']&&(this['sfLogger'][_0x384795(0x13f)](this[_0x384795(0xda)]+'\x20Preparing\x20to\x20delete\x20components'),this[_0x384795(0xcb)]=_0x713436['deleted'][_0x384795(0x130)],await this[_0x384795(0x134)](_0x713436[_0x384795(0x109)]),await this[_0x384795(0x131)][_0x384795(0xfb)]());await this['sfLogger'][_0x384795(0xfb)]();const _0x58d2eb=await fs_internal_1['FS'][_0x384795(0xe9)](this[_0x384795(0xc8)][_0x384795(0x12c)]);await sfdx_utils_2[_0x384795(0x13b)][_0x384795(0xef)](this['gitUtils'][_0x384795(0x12c)])?(_0x179684=!![],await fs_internal_1['FS'][_0x384795(0x121)]((0x0,path_1[_0x384795(0x10a)])(this['gitUtils'][_0x384795(0x12c)],_0x384795(0x115)))):(_0x179684&&(!_0x58d2eb&&(_0x179684=![])),await this[_0x384795(0xc8)]['clearDir']());_0x179684?(await this[_0x384795(0x131)]['log'](this[_0x384795(0xda)]+'\x20Start\x20converting\x20to\x20SFDX.')[_0x384795(0xfb)](),await this[_0x384795(0x108)][_0x384795(0x133)](this[_0x384795(0xd2)][_0x384795(0x12c)]),await this[_0x384795(0x108)][_0x384795(0x10c)](this[_0x384795(0xc8)]['dir'],!_0x58d2eb),await this[_0x384795(0x108)][_0x384795(0x121)]()):(await this[_0x384795(0x131)]['log'](this['prefix']+_0x384795(0xdf))[_0x384795(0xfb)](),await this['mdapiUtils'][_0x384795(0x13a)](this['gitUtils'][_0x384795(0x12c)]));await this[_0x384795(0x131)][_0x384795(0x13f)](this[_0x384795(0xda)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')[_0x384795(0xfb)](),await this[_0x384795(0xc8)][_0x384795(0x137)](_0x5bbd15,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0xd840fd[_0x384795(0xff)]},_0x34a73b[_0x384795(0xff)]),await this[_0x384795(0xc8)][_0x384795(0x121)](),await this['mdapiUtils']['removeDir']();const _0x48c3c5=this['componentsToWrite']+this['componentsToDelete'];await this['sfLogger'][_0x384795(0x13f)](this[_0x384795(0xda)]+_0x384795(0x10b)+(Date[_0x384795(0xce)]()-this[_0x384795(0xd4)])+'ms.\x20Committed\x20components\x20-\x20'+_0x48c3c5+'.')[_0x384795(0xfb)]();}catch(_0xb8aff6){await this[_0x384795(0x120)](),await this[_0x384795(0x131)][_0x384795(0x10f)](this[_0x384795(0xda)]+'\x20'+_0xb8aff6)[_0x384795(0xfb)]();throw _0xb8aff6;}}async[a103_0x77e599(0x103)](_0x379083,_0x40e2f1){const _0x23167a=a103_0x77e599;var _0x33ba6e,_0x3f3642;this[_0x23167a(0x131)]=typedi_1['default']['get'](providers_tokens_1[_0x23167a(0x126)][_0x23167a(0xe4)]),this[_0x23167a(0xda)]=(_0x40e2f1?_0x40e2f1+'\x20':'')+'['+commit_components_dto_1[_0x23167a(0xd0)][_0x23167a(0xff)]+']',await this[_0x23167a(0x131)][_0x23167a(0x13f)](this[_0x23167a(0xda)]+_0x23167a(0x13e));const _0x24a472=!!((_0x33ba6e=_0x379083['components'])===null||_0x33ba6e===void 0x0?void 0x0:_0x33ba6e['writed'])||!!((_0x3f3642=_0x379083[_0x23167a(0xfe)])===null||_0x3f3642===void 0x0?void 0x0:_0x3f3642[_0x23167a(0x109)]);if(!_0x24a472){await this[_0x23167a(0x131)]['log'](this['prefix']+_0x23167a(0x141))['send']();return;}this[_0x23167a(0xf4)]=_0x379083,await this['exec']();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a103_0x77e599(0xe0)]=CommitComponentsJob;