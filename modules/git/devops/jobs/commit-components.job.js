const a104_0x426e0b=a104_0xc97a;(function(_0x64d1e8,_0xc23eac){const _0x5a930e=a104_0xc97a,_0x257b25=_0x64d1e8();while(!![]){try{const _0x62e66f=parseInt(_0x5a930e(0x1ba))/0x1+parseInt(_0x5a930e(0x1bd))/0x2+-parseInt(_0x5a930e(0x1b6))/0x3+-parseInt(_0x5a930e(0x1b1))/0x4*(-parseInt(_0x5a930e(0x186))/0x5)+-parseInt(_0x5a930e(0x19e))/0x6+-parseInt(_0x5a930e(0x19c))/0x7+parseInt(_0x5a930e(0x195))/0x8;if(_0x62e66f===_0xc23eac)break;else _0x257b25['push'](_0x257b25['shift']());}catch(_0x3f962e){_0x257b25['push'](_0x257b25['shift']());}}}(a104_0xa3df,0xd9107));const a104_0x222b39=(function(){let _0x34b9bc=!![];return function(_0x1ad9c0,_0x248f11){const _0x1bc658=_0x34b9bc?function(){const _0x3b660b=a104_0xc97a;if(_0x248f11){const _0x332f44=_0x248f11[_0x3b660b(0x1d4)](_0x1ad9c0,arguments);return _0x248f11=null,_0x332f44;}}:function(){};return _0x34b9bc=![],_0x1bc658;};}()),a104_0x284feb=a104_0x222b39(this,function(){const _0x13a2ab=a104_0xc97a;return a104_0x284feb['toString']()[_0x13a2ab(0x1e0)](_0x13a2ab(0x172))[_0x13a2ab(0x182)]()[_0x13a2ab(0x180)](a104_0x284feb)[_0x13a2ab(0x1e0)](_0x13a2ab(0x172));});a104_0x284feb();function a104_0xa3df(){const _0x569b2f=['../../../../constants','events','default','://','SFDX','\x20Nothing\x20to\x20commit.\x20Skip.','components','11650736lakKhb','CommitComponentsJob','commitAndPush','groupComponentsByFileName','commitData','\x20Start\x20cloning\x20repository.','force','4649855hGdgQU','componentsToWrite','8694792EMnmAi','get','\x20Preparing\x20to\x20write\x20components','catch','\x20Prepare\x20mdapi\x20files.','dir','SFDXUtils','splice','GitUtils','log','clearDir','values','reduce','getGitShellAuthorizationString','configurable','__esModule','sfLogger','call','../../providers/types/git-provider','68wrDVBj','typedi','writeFlosumComponents','object','writed','1748682cpkuuH','\x20Preparing\x20to\x20delete\x20components','fileType','defineProperty','411523dkXTcA','prepareMdapi','__importDefault','1038076TRFZjY','push','getOwnPropertyDescriptor','COMPONENTS_PER_TICK','createProjectFrom','credentials','BitbucketApiService','removeComponents','../../providers/api/bitbucket-api.service','master','\x20Copying\x20mdapi\x20to\x20git\x20folder.','../../salesforce/utils/sfdx.utils','componentsToDelete','writable','provider','isSFDXProject','CommitComponentsDto','__createBinding','sort','deleted','Tokens','../../parsers/data/child-types','gitUrl','apply','includes','DEFAULT_GIT_USER_EMAIL','startTime','removeDir','send','getRemote','../../../shared/utils','__importStar','prefix','getProtocol','\x20Wrote\x20','search','\x20components','../dto/commit-components.dto','\x20Checking\x20commit\x20components.','run','../utils/sfdx.utils','mdapiUtils','MDApiUtils','now','name','branch','\x20Checking\x20deleted\x20components.','(((.+)+)+)+$','force-app','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','../../providers/providers.tokens','../../internal/fs.internal','copyProjectTo','Bitbucket','writeComponents','isLoggedIn','copyMdapiTo','length','gitUtils','\x20Checking\x20written\x20components.','logger','constructor','decorate','toString','join','sfdxUtils','function','352495cOPoby','create','cleanUp','exec','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','fileName','Service','clone'];a104_0xa3df=function(){return _0x569b2f;};return a104_0xa3df();}function a104_0xc97a(_0x1d5a09,_0x490325){const _0x385ae0=a104_0xa3df();return a104_0xc97a=function(_0x284feb,_0x222b39){_0x284feb=_0x284feb-0x16f;let _0xa3df82=_0x385ae0[_0x284feb];return _0xa3df82;},a104_0xc97a(_0x1d5a09,_0x490325);}'use strict';var __createBinding=this&&this[a104_0x426e0b(0x1ce)]||(Object[a104_0x426e0b(0x187)]?function(_0x11acbf,_0x27419c,_0x2c7e61,_0x3decbf){const _0x411b03=a104_0x426e0b;if(_0x3decbf===undefined)_0x3decbf=_0x2c7e61;var _0x3357b8=Object[_0x411b03(0x1bf)](_0x27419c,_0x2c7e61);(!_0x3357b8||(_0x411b03(0x19f)in _0x3357b8?!_0x27419c[_0x411b03(0x1ad)]:_0x3357b8[_0x411b03(0x1ca)]||_0x3357b8[_0x411b03(0x1ac)]))&&(_0x3357b8={'enumerable':!![],'get':function(){return _0x27419c[_0x2c7e61];}}),Object[_0x411b03(0x1b9)](_0x11acbf,_0x3decbf,_0x3357b8);}:function(_0x3d8af8,_0xec46b8,_0x566759,_0x1353ec){if(_0x1353ec===undefined)_0x1353ec=_0x566759;_0x3d8af8[_0x1353ec]=_0xec46b8[_0x566759];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x1bae74,_0x4305d7){const _0x25d820=a104_0x426e0b;Object['defineProperty'](_0x1bae74,_0x25d820(0x190),{'enumerable':!![],'value':_0x4305d7});}:function(_0x2785d9,_0x48cd17){const _0xed8ec3=a104_0x426e0b;_0x2785d9[_0xed8ec3(0x190)]=_0x48cd17;}),__decorate=this&&this['__decorate']||function(_0x51bcc8,_0xc6d5e7,_0x3b8855,_0x4079da){const _0x51d82c=a104_0x426e0b;var _0x125b10=arguments[_0x51d82c(0x17c)],_0x2975a9=_0x125b10<0x3?_0xc6d5e7:_0x4079da===null?_0x4079da=Object[_0x51d82c(0x1bf)](_0xc6d5e7,_0x3b8855):_0x4079da,_0x5f24e3;if(typeof Reflect===_0x51d82c(0x1b4)&&typeof Reflect[_0x51d82c(0x181)]===_0x51d82c(0x185))_0x2975a9=Reflect['decorate'](_0x51bcc8,_0xc6d5e7,_0x3b8855,_0x4079da);else{for(var _0x5c6e7b=_0x51bcc8[_0x51d82c(0x17c)]-0x1;_0x5c6e7b>=0x0;_0x5c6e7b--)if(_0x5f24e3=_0x51bcc8[_0x5c6e7b])_0x2975a9=(_0x125b10<0x3?_0x5f24e3(_0x2975a9):_0x125b10>0x3?_0x5f24e3(_0xc6d5e7,_0x3b8855,_0x2975a9):_0x5f24e3(_0xc6d5e7,_0x3b8855))||_0x2975a9;}return _0x125b10>0x3&&_0x2975a9&&Object[_0x51d82c(0x1b9)](_0xc6d5e7,_0x3b8855,_0x2975a9),_0x2975a9;},__importStar=this&&this[a104_0x426e0b(0x1dc)]||function(_0xbd85a5){const _0x4a7843=a104_0x426e0b;if(_0xbd85a5&&_0xbd85a5[_0x4a7843(0x1ad)])return _0xbd85a5;var _0x17e47d={};if(_0xbd85a5!=null){for(var _0xb7d8ca in _0xbd85a5)if(_0xb7d8ca!==_0x4a7843(0x190)&&Object['prototype']['hasOwnProperty'][_0x4a7843(0x1af)](_0xbd85a5,_0xb7d8ca))__createBinding(_0x17e47d,_0xbd85a5,_0xb7d8ca);}return __setModuleDefault(_0x17e47d,_0xbd85a5),_0x17e47d;},__importDefault=this&&this[a104_0x426e0b(0x1bc)]||function(_0x24103a){const _0x319934=a104_0x426e0b;return _0x24103a&&_0x24103a[_0x319934(0x1ad)]?_0x24103a:{'default':_0x24103a};};Object[a104_0x426e0b(0x1b9)](exports,a104_0x426e0b(0x1ad),{'value':!![]}),exports[a104_0x426e0b(0x196)]=void 0x0;const commit_components_dto_1=require(a104_0x426e0b(0x1e2)),events_1=__importDefault(require(a104_0x426e0b(0x18f))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a104_0x426e0b(0x1e5)),typedi_1=__importStar(require(a104_0x426e0b(0x1b2))),child_types_1=__importDefault(require(a104_0x426e0b(0x1d2))),utils_1=require(a104_0x426e0b(0x1db)),constants_1=require(a104_0x426e0b(0x18e)),git_provider_1=require(a104_0x426e0b(0x1b0)),bitbucket_api_service_1=require(a104_0x426e0b(0x1c5)),sfdx_utils_2=require(a104_0x426e0b(0x1c8)),fs_internal_1=require(a104_0x426e0b(0x176)),path_1=require('path'),providers_tokens_1=require(a104_0x426e0b(0x175));let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(){const _0x25f447=a104_0x426e0b;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x25f447(0x19d)]=0x0,this[_0x25f447(0x1c9)]=0x0,this[_0x25f447(0x1d7)]=Date[_0x25f447(0x1e8)]();}async[a104_0x426e0b(0x1da)](){const _0x31417b=a104_0x426e0b,{repo:_0x5c5c82}=this['commitData'],_0x1868c0=typedi_1[_0x31417b(0x190)]['get'](providers_tokens_1[_0x31417b(0x1d1)][_0x31417b(0x1c2)]);if(this['commitData'][_0x31417b(0x1cb)]===git_provider_1['GitProvider'][_0x31417b(0x178)]){const _0x3523de=typedi_1['default'][_0x31417b(0x19f)](bitbucket_api_service_1[_0x31417b(0x1c3)]);await _0x3523de[_0x31417b(0x17a)]();}return _0x5c5c82[_0x31417b(0x1d3)]['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x31417b(0x1de)])(_0x5c5c82[_0x31417b(0x1d3)])+_0x31417b(0x191)+_0x1868c0[_0x31417b(0x1ab)]()+'@');}[a104_0x426e0b(0x198)](_0x2899a3){const _0x57e4f6=a104_0x426e0b;var _0x371596;_0x2899a3[_0x57e4f6(0x1cf)](_0x6f1f2c=>child_types_1['default'][_0x57e4f6(0x1d5)](_0x6f1f2c[_0x57e4f6(0x1b8)])?0x1:-0x1);const _0x270e78={};for(const _0x53f40b of _0x2899a3){_0x270e78[_0x371596=_0x53f40b[_0x57e4f6(0x18b)]]||(_0x270e78[_0x371596]=[]),_0x270e78[_0x53f40b[_0x57e4f6(0x18b)]][_0x57e4f6(0x1be)](_0x53f40b);}return Object[_0x57e4f6(0x1a9)](_0x270e78)[_0x57e4f6(0x1aa)]((_0x3c9e2f,_0x4d4aea)=>[..._0x3c9e2f,..._0x4d4aea],[]);}async['writeComponents'](_0xbcf4e3){const _0x245ef3=a104_0x426e0b;_0xbcf4e3=this['groupComponentsByFileName'](_0xbcf4e3);let _0xb640fd=0x0;while(_0xbcf4e3['length']){const _0x30e57f=_0xbcf4e3[_0x245ef3(0x1a5)](0x0,this[_0x245ef3(0x1c0)]);await this[_0x245ef3(0x1e6)][_0x245ef3(0x1b3)](_0x30e57f,{'skipChildErrors':this['commitData'][_0x245ef3(0x170)][_0x245ef3(0x16f)]===_0x245ef3(0x1c6)}),_0xb640fd+=_0x30e57f[_0x245ef3(0x17c)],this[_0x245ef3(0x1ae)][_0x245ef3(0x1a7)](this[_0x245ef3(0x1dd)]+_0x245ef3(0x1df)+_0xb640fd+'/'+this[_0x245ef3(0x19d)]+_0x245ef3(0x1e1)),await this['sfLogger'][_0x245ef3(0x1d9)]();}}async[a104_0x426e0b(0x1c4)](_0x3c0d1c){const _0x13429b=a104_0x426e0b;_0x3c0d1c[_0x13429b(0x1cf)](_0x4c069a=>child_types_1[_0x13429b(0x190)][_0x13429b(0x1d5)](_0x4c069a['type'])?-0x1:0x1);let _0x3d22c2=0x0;while(_0x3c0d1c[_0x13429b(0x17c)]){const _0x319ea5=_0x3c0d1c[_0x13429b(0x1a5)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x13429b(0x1e6)]['removeComponents'](_0x319ea5),_0x3d22c2+=_0x319ea5[_0x13429b(0x17c)],this[_0x13429b(0x1ae)]['log'](this['prefix']+'\x20Deleted\x20'+_0x3d22c2+'/'+this[_0x13429b(0x1c9)]+_0x13429b(0x1e1)),await this[_0x13429b(0x1ae)][_0x13429b(0x1d9)]();}}async[a104_0x426e0b(0x188)](){const _0x410004=a104_0x426e0b;this[_0x410004(0x17d)]&&await this[_0x410004(0x17d)][_0x410004(0x1d8)]()[_0x410004(0x1a1)](()=>void 0x0),this[_0x410004(0x1e6)]&&await this[_0x410004(0x1e6)][_0x410004(0x1d8)]()[_0x410004(0x1a1)](()=>void 0x0),this[_0x410004(0x184)]&&await this['sfdxUtils'][_0x410004(0x1d8)]()[_0x410004(0x1a1)](()=>void 0x0);}async[a104_0x426e0b(0x189)](){const _0x24504b=a104_0x426e0b,{repo:_0x525f55,branch:_0x3e5a43,components:_0x46399,convertToSFDX:_0xa5f6af,message:_0x565de0,user:_0x4903a6}=this[_0x24504b(0x199)];this[_0x24504b(0x1e6)]=new mdapi_utils_1[(_0x24504b(0x1e7))](),this[_0x24504b(0x17d)]=new git_utils_1[(_0x24504b(0x1a6))](await this[_0x24504b(0x1da)]()),this[_0x24504b(0x184)]=new sfdx_utils_1[(_0x24504b(0x1a4))]();let _0x108192=_0xa5f6af;try{await this['sfLogger']['log'](this['prefix']+_0x24504b(0x19a))[_0x24504b(0x1d9)](),await this[_0x24504b(0x17d)][_0x24504b(0x18d)](_0x3e5a43[_0x24504b(0x16f)],_0x525f55[_0x24504b(0x16f)]);!this[_0x24504b(0x199)][_0x24504b(0x19b)]?(this[_0x24504b(0x1ae)]['log'](this[_0x24504b(0x1dd)]+_0x24504b(0x1a2)),await this[_0x24504b(0x1e6)][_0x24504b(0x1bb)](this[_0x24504b(0x17d)][_0x24504b(0x1a3)])):this[_0x24504b(0x1ae)][_0x24504b(0x1a7)](this[_0x24504b(0x1dd)]+_0x24504b(0x174));await this[_0x24504b(0x1ae)][_0x24504b(0x1a7)](this[_0x24504b(0x1dd)]+_0x24504b(0x17e))[_0x24504b(0x1d9)]();_0x46399[_0x24504b(0x1b5)]&&(this[_0x24504b(0x1ae)][_0x24504b(0x1a7)](this[_0x24504b(0x1dd)]+_0x24504b(0x1a0)),this[_0x24504b(0x19d)]=_0x46399['writed'][_0x24504b(0x17c)],await this[_0x24504b(0x179)](_0x46399[_0x24504b(0x1b5)]),await this['sfLogger'][_0x24504b(0x1d9)]());await this['sfLogger'][_0x24504b(0x1a7)](this[_0x24504b(0x1dd)]+_0x24504b(0x171))['send']();_0x46399[_0x24504b(0x1d0)]&&(this[_0x24504b(0x1ae)][_0x24504b(0x1a7)](this[_0x24504b(0x1dd)]+_0x24504b(0x1b7)),this[_0x24504b(0x1c9)]=_0x46399[_0x24504b(0x1d0)][_0x24504b(0x17c)],await this[_0x24504b(0x1c4)](_0x46399['deleted']),await this[_0x24504b(0x1ae)][_0x24504b(0x1d9)]());await this['sfLogger'][_0x24504b(0x1d9)]();const _0x37dbb0=await fs_internal_1['FS']['isEmptyDir'](this[_0x24504b(0x17d)][_0x24504b(0x1a3)]);await sfdx_utils_2[_0x24504b(0x192)][_0x24504b(0x1cc)](this[_0x24504b(0x17d)]['dir'])?(_0x108192=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1[_0x24504b(0x183)])(this['gitUtils'][_0x24504b(0x1a3)],_0x24504b(0x173)))):(_0x108192&&(!_0x37dbb0&&(_0x108192=![])),await this['gitUtils'][_0x24504b(0x1a8)]());_0x108192?(await this[_0x24504b(0x1ae)][_0x24504b(0x1a7)](this['prefix']+'\x20Start\x20converting\x20to\x20SFDX.')[_0x24504b(0x1d9)](),await this[_0x24504b(0x184)][_0x24504b(0x1c1)](this[_0x24504b(0x1e6)][_0x24504b(0x1a3)]),await this[_0x24504b(0x184)][_0x24504b(0x177)](this[_0x24504b(0x17d)][_0x24504b(0x1a3)],!_0x37dbb0),await this[_0x24504b(0x184)][_0x24504b(0x1d8)]()):(await this['sfLogger'][_0x24504b(0x1a7)](this[_0x24504b(0x1dd)]+_0x24504b(0x1c7))[_0x24504b(0x1d9)](),await this[_0x24504b(0x1e6)][_0x24504b(0x17b)](this[_0x24504b(0x17d)][_0x24504b(0x1a3)]));await this[_0x24504b(0x1ae)][_0x24504b(0x1a7)](this['prefix']+_0x24504b(0x18a))[_0x24504b(0x1d9)](),await this['gitUtils'][_0x24504b(0x197)](_0x565de0,{'email':constants_1[_0x24504b(0x1d6)],'name':_0x4903a6[_0x24504b(0x16f)]},_0x3e5a43[_0x24504b(0x16f)]),await this[_0x24504b(0x17d)][_0x24504b(0x1d8)](),await this[_0x24504b(0x1e6)][_0x24504b(0x1d8)]();const _0x558db3=this[_0x24504b(0x19d)]+this[_0x24504b(0x1c9)];await this[_0x24504b(0x1ae)][_0x24504b(0x1a7)](this[_0x24504b(0x1dd)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date['now']()-this[_0x24504b(0x1d7)])+'ms.\x20Committed\x20components\x20-\x20'+_0x558db3+'.')[_0x24504b(0x1d9)]();}catch(_0x222e58){await this[_0x24504b(0x188)](),await this[_0x24504b(0x1ae)]['error'](this['prefix']+'\x20'+_0x222e58)['send']();throw _0x222e58;}}async[a104_0x426e0b(0x1e4)](_0x28bfb8,_0x107523){const _0x261f6e=a104_0x426e0b;var _0x15b061,_0x476549;this['sfLogger']=typedi_1[_0x261f6e(0x190)]['get'](providers_tokens_1[_0x261f6e(0x1d1)][_0x261f6e(0x17f)]),this['prefix']=(_0x107523?_0x107523+'\x20':'')+'['+commit_components_dto_1[_0x261f6e(0x1cd)][_0x261f6e(0x16f)]+']',await this[_0x261f6e(0x1ae)][_0x261f6e(0x1a7)](this[_0x261f6e(0x1dd)]+_0x261f6e(0x1e3));const _0x1f1209=!!((_0x15b061=_0x28bfb8['components'])===null||_0x15b061===void 0x0?void 0x0:_0x15b061[_0x261f6e(0x1b5)])||!!((_0x476549=_0x28bfb8[_0x261f6e(0x194)])===null||_0x476549===void 0x0?void 0x0:_0x476549[_0x261f6e(0x1d0)]);if(!_0x1f1209){await this['sfLogger'][_0x261f6e(0x1a7)](this[_0x261f6e(0x1dd)]+_0x261f6e(0x193))[_0x261f6e(0x1d9)]();return;}this[_0x261f6e(0x199)]=_0x28bfb8,await this[_0x261f6e(0x189)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x426e0b(0x18c)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x426e0b(0x196)]=CommitComponentsJob;