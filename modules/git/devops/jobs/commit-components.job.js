const a104_0x29615a=a104_0x1fc8;(function(_0x1b5c48,_0xf79509){const _0x39e4d9=a104_0x1fc8,_0x4fd6c2=_0x1b5c48();while(!![]){try{const _0x1aaac6=-parseInt(_0x39e4d9(0x83))/0x1*(-parseInt(_0x39e4d9(0x7f))/0x2)+-parseInt(_0x39e4d9(0x95))/0x3*(-parseInt(_0x39e4d9(0xc1))/0x4)+parseInt(_0x39e4d9(0x78))/0x5+-parseInt(_0x39e4d9(0x92))/0x6*(-parseInt(_0x39e4d9(0x72))/0x7)+parseInt(_0x39e4d9(0x7c))/0x8*(-parseInt(_0x39e4d9(0xd9))/0x9)+parseInt(_0x39e4d9(0xbf))/0xa+parseInt(_0x39e4d9(0xca))/0xb*(-parseInt(_0x39e4d9(0xd8))/0xc);if(_0x1aaac6===_0xf79509)break;else _0x4fd6c2['push'](_0x4fd6c2['shift']());}catch(_0x4f0cbb){_0x4fd6c2['push'](_0x4fd6c2['shift']());}}}(a104_0x900e,0x859e5));function a104_0x1fc8(_0x1d96b6,_0x38c89f){const _0x1a48bc=a104_0x900e();return a104_0x1fc8=function(_0x555c6f,_0x44c79f){_0x555c6f=_0x555c6f-0x67;let _0x900e8d=_0x1a48bc[_0x555c6f];return _0x900e8d;},a104_0x1fc8(_0x1d96b6,_0x38c89f);}const a104_0x44c79f=(function(){let _0x3e5c27=!![];return function(_0x50b393,_0x5a252b){const _0x19d3a7=_0x3e5c27?function(){const _0x3bb885=a104_0x1fc8;if(_0x5a252b){const _0x61bad6=_0x5a252b[_0x3bb885(0x9b)](_0x50b393,arguments);return _0x5a252b=null,_0x61bad6;}}:function(){};return _0x3e5c27=![],_0x19d3a7;};}()),a104_0x555c6f=a104_0x44c79f(this,function(){const _0x4f49f3=a104_0x1fc8;return a104_0x555c6f[_0x4f49f3(0x96)]()['search'](_0x4f49f3(0xc5))[_0x4f49f3(0x96)]()['constructor'](a104_0x555c6f)['search'](_0x4f49f3(0xc5));});a104_0x555c6f();'use strict';function a104_0x900e(){const _0x2c516d=['join','\x20components','552OPEnvc','length','SFDX','4gsSDED','commitData','../dto/commit-components.dto','run','461561KgpXbP','clone','defineProperty','name','type','getRemote','provider','__importDefault','typedi','gitUtils','componentsToDelete','__esModule','\x20Prepare\x20mdapi\x20files.','isSFDXProject','\x20Copying\x20mdapi\x20to\x20git\x20folder.','474gmdtKV','sfLogger','Bitbucket','101247wrkgec','toString','copyVlocityComponents','cleanUp','../utils/mdapi.utils','hasOwnProperty','apply','force','deleted','gitUrl','decorate','Tokens','push','catch','FORCE_APP_DEFAULT_DIR','writeFlosumComponents','removeDir','isEmptyDir','isLoggedIn','__importStar','configurable','mdapiUtils','object','\x20Checking\x20written\x20components.','default','credentials','sort','prepareMdapi','\x20Nothing\x20to\x20commit.\x20Skip.','error','groupComponentsByFileName','exec','fileName','commitAndPush','componentsToWrite','force-app','MDApiUtils','\x20Start\x20converting\x20to\x20SFDX.','dir','prefix','../utils/git.utils','create','1756250VeSyty','master','8NXNeIb','log','sfdxUtils','../../providers/api/bitbucket-api.service','(((.+)+)+)+$','GitUtils','now','call','DEFAULT_GIT_USER_EMAIL','77xTAZzx','__decorate','writed','SFDXUtils','\x20Preparing\x20to\x20write\x20components','BitbucketApiService','values','../../internal/fs.internal','replace','reduce','writable','events','COMPONENTS_PER_TICK','ms.\x20Committed\x20components\x20-\x20','2138856herfgt','122463OdbXQk','\x20Checking\x20commit\x20components.','\x20Deleted\x20','logger','CommitComponentsJob','../../salesforce/utils/sfdx.utils','removeComponents','getOwnPropertyDescriptor','getProtocol','get','../../../../constants','send','\x20Wrote\x20','67291lHfRnA','../utils/sfdx.utils','writeComponents','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','startTime','path','4040890DyyxSa','copyMdapiTo'];a104_0x900e=function(){return _0x2c516d;};return a104_0x900e();}var __createBinding=this&&this['__createBinding']||(Object[a104_0x29615a(0xbe)]?function(_0x504cd4,_0xa05de8,_0x1dad39,_0xaafe55){const _0x450838=a104_0x29615a;if(_0xaafe55===undefined)_0xaafe55=_0x1dad39;var _0x33d9fc=Object[_0x450838(0x6c)](_0xa05de8,_0x1dad39);(!_0x33d9fc||(_0x450838(0x6e)in _0x33d9fc?!_0xa05de8[_0x450838(0x8e)]:_0x33d9fc[_0x450838(0xd4)]||_0x33d9fc[_0x450838(0xa9)]))&&(_0x33d9fc={'enumerable':!![],'get':function(){return _0xa05de8[_0x1dad39];}}),Object[_0x450838(0x85)](_0x504cd4,_0xaafe55,_0x33d9fc);}:function(_0x3f7740,_0x34c2f6,_0x167589,_0x1f641b){if(_0x1f641b===undefined)_0x1f641b=_0x167589;_0x3f7740[_0x1f641b]=_0x34c2f6[_0x167589];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x2f8f1c,_0x51292f){const _0x29740f=a104_0x29615a;Object[_0x29740f(0x85)](_0x2f8f1c,_0x29740f(0xad),{'enumerable':!![],'value':_0x51292f});}:function(_0x1da579,_0x1cdea5){_0x1da579['default']=_0x1cdea5;}),__decorate=this&&this[a104_0x29615a(0xcb)]||function(_0x59fb6b,_0x333f8f,_0x4fc358,_0x39b3d9){const _0x1050b0=a104_0x29615a;var _0x1eee60=arguments['length'],_0x48e578=_0x1eee60<0x3?_0x333f8f:_0x39b3d9===null?_0x39b3d9=Object[_0x1050b0(0x6c)](_0x333f8f,_0x4fc358):_0x39b3d9,_0x4dfdc7;if(typeof Reflect===_0x1050b0(0xab)&&typeof Reflect[_0x1050b0(0x9f)]==='function')_0x48e578=Reflect['decorate'](_0x59fb6b,_0x333f8f,_0x4fc358,_0x39b3d9);else{for(var _0xd777db=_0x59fb6b[_0x1050b0(0x7d)]-0x1;_0xd777db>=0x0;_0xd777db--)if(_0x4dfdc7=_0x59fb6b[_0xd777db])_0x48e578=(_0x1eee60<0x3?_0x4dfdc7(_0x48e578):_0x1eee60>0x3?_0x4dfdc7(_0x333f8f,_0x4fc358,_0x48e578):_0x4dfdc7(_0x333f8f,_0x4fc358))||_0x48e578;}return _0x1eee60>0x3&&_0x48e578&&Object[_0x1050b0(0x85)](_0x333f8f,_0x4fc358,_0x48e578),_0x48e578;},__importStar=this&&this[a104_0x29615a(0xa8)]||function(_0x42289e){const _0x136e89=a104_0x29615a;if(_0x42289e&&_0x42289e[_0x136e89(0x8e)])return _0x42289e;var _0x41d84c={};if(_0x42289e!=null){for(var _0x138eee in _0x42289e)if(_0x138eee!==_0x136e89(0xad)&&Object['prototype'][_0x136e89(0x9a)][_0x136e89(0xc8)](_0x42289e,_0x138eee))__createBinding(_0x41d84c,_0x42289e,_0x138eee);}return __setModuleDefault(_0x41d84c,_0x42289e),_0x41d84c;},__importDefault=this&&this[a104_0x29615a(0x8a)]||function(_0x2caa45){return _0x2caa45&&_0x2caa45['__esModule']?_0x2caa45:{'default':_0x2caa45};};Object[a104_0x29615a(0x85)](exports,a104_0x29615a(0x8e),{'value':!![]}),exports[a104_0x29615a(0x69)]=void 0x0;const commit_components_dto_1=require(a104_0x29615a(0x81)),events_1=__importDefault(require(a104_0x29615a(0xd5))),git_utils_1=require(a104_0x29615a(0xbd)),mdapi_utils_1=require(a104_0x29615a(0x99)),sfdx_utils_1=require(a104_0x29615a(0x73)),typedi_1=__importStar(require(a104_0x29615a(0x8b))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require('../../../shared/utils'),constants_1=require(a104_0x29615a(0x6f)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require(a104_0x29615a(0xc4)),sfdx_utils_2=require(a104_0x29615a(0x6a)),fs_internal_1=require(a104_0x29615a(0xd1)),path_1=require(a104_0x29615a(0x77)),providers_tokens_1=require('../../providers/providers.tokens'),constants_2=require(a104_0x29615a(0x6f));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x29615a(0xad)]{constructor(){const _0x559f57=a104_0x29615a;super(...arguments),this[_0x559f57(0xd6)]=0x3e8,this['componentsToWrite']=0x0,this[_0x559f57(0x8d)]=0x0,this['startTime']=Date[_0x559f57(0xc7)]();}async[a104_0x29615a(0x88)](){const _0x54d261=a104_0x29615a,{repo:_0x48c22c}=this[_0x54d261(0x80)],_0x1bc00f=typedi_1[_0x54d261(0xad)]['get'](providers_tokens_1['Tokens'][_0x54d261(0xae)]);if(this[_0x54d261(0x80)][_0x54d261(0x89)]===git_provider_1['GitProvider'][_0x54d261(0x94)]){const _0x3bc699=typedi_1[_0x54d261(0xad)][_0x54d261(0x6e)](bitbucket_api_service_1[_0x54d261(0xcf)]);await _0x3bc699[_0x54d261(0xa7)]();}return _0x48c22c[_0x54d261(0x9e)][_0x54d261(0xd2)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x54d261(0x6d)])(_0x48c22c[_0x54d261(0x9e)])+'://'+_0x1bc00f['getGitShellAuthorizationString']()+'@');}[a104_0x29615a(0xb3)](_0x416272){const _0x5a2cd=a104_0x29615a;var _0x59f08f;_0x416272['sort'](_0x2a2076=>child_types_1[_0x5a2cd(0xad)]['includes'](_0x2a2076['fileType'])?0x1:-0x1);const _0x29ea49={};for(const _0x367ce3 of _0x416272){_0x29ea49[_0x59f08f=_0x367ce3[_0x5a2cd(0xb5)]]||(_0x29ea49[_0x59f08f]=[]),_0x29ea49[_0x367ce3[_0x5a2cd(0xb5)]][_0x5a2cd(0xa1)](_0x367ce3);}return Object[_0x5a2cd(0xd0)](_0x29ea49)[_0x5a2cd(0xd3)]((_0x342ab1,_0x41f2e6)=>[..._0x342ab1,..._0x41f2e6],[]);}async['writeComponents'](_0x39d8e1){const _0x5f3223=a104_0x29615a;_0x39d8e1=this['groupComponentsByFileName'](_0x39d8e1);let _0x49a742=0x0;while(_0x39d8e1['length']){const _0x201c33=_0x39d8e1['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x5f3223(0xaa)][_0x5f3223(0xa4)](_0x201c33,{'skipChildErrors':this['commitData']['branch'][_0x5f3223(0x86)]===_0x5f3223(0xc0)}),_0x49a742+=_0x201c33[_0x5f3223(0x7d)],this[_0x5f3223(0x93)][_0x5f3223(0xc2)](this[_0x5f3223(0xbc)]+_0x5f3223(0x71)+_0x49a742+'/'+this['componentsToWrite']+_0x5f3223(0x7b)),await this[_0x5f3223(0x93)][_0x5f3223(0x70)]();}}async['removeComponents'](_0x19ef3c){const _0x19ec8b=a104_0x29615a;_0x19ef3c[_0x19ec8b(0xaf)](_0x142a04=>child_types_1[_0x19ec8b(0xad)]['includes'](_0x142a04[_0x19ec8b(0x87)])?-0x1:0x1);let _0x1617cd=0x0;while(_0x19ef3c[_0x19ec8b(0x7d)]){const _0x3c5dd1=_0x19ef3c['splice'](0x0,this[_0x19ec8b(0xd6)]);await this[_0x19ec8b(0xaa)][_0x19ec8b(0x6b)](_0x3c5dd1),_0x1617cd+=_0x3c5dd1['length'],this[_0x19ec8b(0x93)][_0x19ec8b(0xc2)](this[_0x19ec8b(0xbc)]+_0x19ec8b(0x67)+_0x1617cd+'/'+this['componentsToDelete']+_0x19ec8b(0x7b)),await this[_0x19ec8b(0x93)][_0x19ec8b(0x70)]();}}async[a104_0x29615a(0x98)](){const _0x20e58=a104_0x29615a;this[_0x20e58(0x8c)]&&await this['gitUtils'][_0x20e58(0xa5)]()[_0x20e58(0xa2)](()=>void 0x0),this[_0x20e58(0xaa)]&&await this[_0x20e58(0xaa)][_0x20e58(0xa5)]()[_0x20e58(0xa2)](()=>void 0x0),this[_0x20e58(0xc3)]&&await this[_0x20e58(0xc3)][_0x20e58(0xa5)]()[_0x20e58(0xa2)](()=>void 0x0);}async[a104_0x29615a(0xb4)](){const _0x59b231=a104_0x29615a,{repo:_0x33517a,branch:_0x440d91,components:_0x4be317,convertToSFDX:_0x208a31,message:_0x27a4ee,user:_0x2b45c5}=this[_0x59b231(0x80)];this[_0x59b231(0xaa)]=new mdapi_utils_1[(_0x59b231(0xb9))](),this[_0x59b231(0x8c)]=new git_utils_1[(_0x59b231(0xc6))](await this[_0x59b231(0x88)]()),this[_0x59b231(0xc3)]=new sfdx_utils_1[(_0x59b231(0xcd))]();let _0x59d82d=_0x208a31;try{await this['sfLogger'][_0x59b231(0xc2)](this['prefix']+'\x20Start\x20cloning\x20repository.')[_0x59b231(0x70)](),await this[_0x59b231(0x8c)][_0x59b231(0x84)](_0x440d91['name'],_0x33517a[_0x59b231(0x86)]);!this[_0x59b231(0x80)][_0x59b231(0x9c)]?(this[_0x59b231(0x93)][_0x59b231(0xc2)](this['prefix']+_0x59b231(0x8f)),await this[_0x59b231(0xaa)][_0x59b231(0xb0)](this[_0x59b231(0x8c)]['dir'])):this[_0x59b231(0x93)]['log'](this[_0x59b231(0xbc)]+_0x59b231(0x75));await this['sfLogger'][_0x59b231(0xc2)](this[_0x59b231(0xbc)]+_0x59b231(0xac))[_0x59b231(0x70)]();_0x4be317[_0x59b231(0xcc)]&&(this['sfLogger'][_0x59b231(0xc2)](this['prefix']+_0x59b231(0xce)),this[_0x59b231(0xb7)]=_0x4be317[_0x59b231(0xcc)][_0x59b231(0x7d)],await this[_0x59b231(0x74)](_0x4be317['writed']),await this['sfLogger'][_0x59b231(0x70)]());await this[_0x59b231(0x93)][_0x59b231(0xc2)](this[_0x59b231(0xbc)]+'\x20Checking\x20deleted\x20components.')[_0x59b231(0x70)]();_0x4be317['deleted']&&(this['sfLogger'][_0x59b231(0xc2)](this[_0x59b231(0xbc)]+'\x20Preparing\x20to\x20delete\x20components'),this['componentsToDelete']=_0x4be317[_0x59b231(0x9d)]['length'],await this[_0x59b231(0x6b)](_0x4be317[_0x59b231(0x9d)]),await this[_0x59b231(0x93)][_0x59b231(0x70)]());await this[_0x59b231(0x93)][_0x59b231(0x70)]();const _0x1b57c4=await fs_internal_1['FS'][_0x59b231(0xa6)](this[_0x59b231(0x8c)][_0x59b231(0xbb)]);await sfdx_utils_2[_0x59b231(0x7e)][_0x59b231(0x90)](this[_0x59b231(0x8c)][_0x59b231(0xbb)])?(_0x59d82d=!![],await fs_internal_1['FS'][_0x59b231(0xa5)]((0x0,path_1[_0x59b231(0x7a)])(this[_0x59b231(0x8c)][_0x59b231(0xbb)],_0x59b231(0xb8)))):(_0x59d82d&&(!_0x1b57c4&&(_0x59d82d=![])),await this[_0x59b231(0x8c)]['clearDir']());_0x59d82d?(await this[_0x59b231(0x93)][_0x59b231(0xc2)](this[_0x59b231(0xbc)]+_0x59b231(0xba))[_0x59b231(0x70)](),await this[_0x59b231(0xc3)]['createProjectFrom'](this[_0x59b231(0xaa)][_0x59b231(0xbb)]),await this['sfdxUtils']['copyProjectTo'](this[_0x59b231(0x8c)][_0x59b231(0xbb)],!_0x1b57c4),await this[_0x59b231(0xc3)][_0x59b231(0x97)](this[_0x59b231(0xaa)][_0x59b231(0xbb)],(0x0,path_1['join'])(this[_0x59b231(0x8c)][_0x59b231(0xbb)],constants_2[_0x59b231(0xa3)])),await this[_0x59b231(0xc3)][_0x59b231(0xa5)]()):(await this[_0x59b231(0x93)][_0x59b231(0xc2)](this[_0x59b231(0xbc)]+_0x59b231(0x91))['send'](),await this['mdapiUtils'][_0x59b231(0x79)](this[_0x59b231(0x8c)]['dir']));await this[_0x59b231(0x93)][_0x59b231(0xc2)](this[_0x59b231(0xbc)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')[_0x59b231(0x70)](),await this[_0x59b231(0x8c)][_0x59b231(0xb6)](_0x27a4ee,{'email':constants_1[_0x59b231(0xc9)],'name':_0x2b45c5[_0x59b231(0x86)]},_0x440d91[_0x59b231(0x86)]),await this[_0x59b231(0x8c)][_0x59b231(0xa5)](),await this[_0x59b231(0xaa)]['removeDir']();const _0x2e5f2a=this[_0x59b231(0xb7)]+this[_0x59b231(0x8d)];await this[_0x59b231(0x93)][_0x59b231(0xc2)](this[_0x59b231(0xbc)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x59b231(0xc7)]()-this[_0x59b231(0x76)])+_0x59b231(0xd7)+_0x2e5f2a+'.')[_0x59b231(0x70)]();}catch(_0x44a20e){await this[_0x59b231(0x98)](),await this['sfLogger'][_0x59b231(0xb2)](this[_0x59b231(0xbc)]+'\x20'+_0x44a20e)[_0x59b231(0x70)]();throw _0x44a20e;}}async[a104_0x29615a(0x82)](_0x10af05,_0x18ddde){const _0x2020e6=a104_0x29615a;var _0x59af92,_0x4dab80;this[_0x2020e6(0x93)]=typedi_1['default']['get'](providers_tokens_1[_0x2020e6(0xa0)][_0x2020e6(0x68)]),this['prefix']=(_0x18ddde?_0x18ddde+'\x20':'')+'['+commit_components_dto_1['CommitComponentsDto'][_0x2020e6(0x86)]+']',await this['sfLogger'][_0x2020e6(0xc2)](this[_0x2020e6(0xbc)]+_0x2020e6(0xda));const _0x325b46=!!((_0x59af92=_0x10af05['components'])===null||_0x59af92===void 0x0?void 0x0:_0x59af92['writed'])||!!((_0x4dab80=_0x10af05['components'])===null||_0x4dab80===void 0x0?void 0x0:_0x4dab80[_0x2020e6(0x9d)]);if(!_0x325b46){await this[_0x2020e6(0x93)]['log'](this[_0x2020e6(0xbc)]+_0x2020e6(0xb1))[_0x2020e6(0x70)]();return;}this[_0x2020e6(0x80)]=_0x10af05,await this[_0x2020e6(0xb4)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a104_0x29615a(0x69)]=CommitComponentsJob;