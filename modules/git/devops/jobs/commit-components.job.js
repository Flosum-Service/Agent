const a73_0x43f665=a73_0x1a25;(function(_0x1bcfaa,_0x5b1b53){const _0x35ec1d=a73_0x1a25,_0x2e8684=_0x1bcfaa();while(!![]){try{const _0x32bb5b=-parseInt(_0x35ec1d(0xb4))/0x1*(parseInt(_0x35ec1d(0x81))/0x2)+-parseInt(_0x35ec1d(0xc4))/0x3+-parseInt(_0x35ec1d(0x82))/0x4+parseInt(_0x35ec1d(0x92))/0x5+parseInt(_0x35ec1d(0xce))/0x6+-parseInt(_0x35ec1d(0x79))/0x7*(-parseInt(_0x35ec1d(0x8d))/0x8)+-parseInt(_0x35ec1d(0xd9))/0x9*(-parseInt(_0x35ec1d(0x76))/0xa);if(_0x32bb5b===_0x5b1b53)break;else _0x2e8684['push'](_0x2e8684['shift']());}catch(_0x2cbd65){_0x2e8684['push'](_0x2e8684['shift']());}}}(a73_0x3717,0x9ab50));const a73_0x249fb5=(function(){let _0x5e2d8e=!![];return function(_0x547b7d,_0x554b7a){const _0x57324a=_0x5e2d8e?function(){const _0x448be2=a73_0x1a25;if(_0x554b7a){const _0xaba204=_0x554b7a[_0x448be2(0x99)](_0x547b7d,arguments);return _0x554b7a=null,_0xaba204;}}:function(){};return _0x5e2d8e=![],_0x57324a;};}()),a73_0x12b8d5=a73_0x249fb5(this,function(){const _0x1cc168=a73_0x1a25;return a73_0x12b8d5[_0x1cc168(0x8b)]()['search']('(((.+)+)+)+$')[_0x1cc168(0x8b)]()[_0x1cc168(0x7b)](a73_0x12b8d5)[_0x1cc168(0xbe)](_0x1cc168(0x86));});a73_0x12b8d5();'use strict';var __createBinding=this&&this[a73_0x43f665(0x6f)]||(Object[a73_0x43f665(0xd5)]?function(_0x24afe8,_0x569ec9,_0x2d154a,_0x2e54d8){const _0x1f6266=a73_0x43f665;if(_0x2e54d8===undefined)_0x2e54d8=_0x2d154a;var _0xd99e26=Object['getOwnPropertyDescriptor'](_0x569ec9,_0x2d154a);(!_0xd99e26||(_0x1f6266(0xa2)in _0xd99e26?!_0x569ec9['__esModule']:_0xd99e26['writable']||_0xd99e26[_0x1f6266(0xad)]))&&(_0xd99e26={'enumerable':!![],'get':function(){return _0x569ec9[_0x2d154a];}}),Object['defineProperty'](_0x24afe8,_0x2e54d8,_0xd99e26);}:function(_0x4718ca,_0x39298b,_0x3aa092,_0x26c3a3){if(_0x26c3a3===undefined)_0x26c3a3=_0x3aa092;_0x4718ca[_0x26c3a3]=_0x39298b[_0x3aa092];}),__setModuleDefault=this&&this[a73_0x43f665(0xb3)]||(Object[a73_0x43f665(0xd5)]?function(_0x90c545,_0x2a175c){const _0x8a9ea9=a73_0x43f665;Object[_0x8a9ea9(0x77)](_0x90c545,_0x8a9ea9(0xc1),{'enumerable':!![],'value':_0x2a175c});}:function(_0x566464,_0x3065f4){const _0x3ebf9b=a73_0x43f665;_0x566464[_0x3ebf9b(0xc1)]=_0x3065f4;}),__decorate=this&&this[a73_0x43f665(0xc9)]||function(_0x5a695f,_0x5132c5,_0x394be6,_0x53bc00){const _0x30526c=a73_0x43f665;var _0x39da3a=arguments['length'],_0x162703=_0x39da3a<0x3?_0x5132c5:_0x53bc00===null?_0x53bc00=Object['getOwnPropertyDescriptor'](_0x5132c5,_0x394be6):_0x53bc00,_0x1e1cbf;if(typeof Reflect==='object'&&typeof Reflect[_0x30526c(0x8f)]==='function')_0x162703=Reflect[_0x30526c(0x8f)](_0x5a695f,_0x5132c5,_0x394be6,_0x53bc00);else{for(var _0x5ebf3c=_0x5a695f[_0x30526c(0x7a)]-0x1;_0x5ebf3c>=0x0;_0x5ebf3c--)if(_0x1e1cbf=_0x5a695f[_0x5ebf3c])_0x162703=(_0x39da3a<0x3?_0x1e1cbf(_0x162703):_0x39da3a>0x3?_0x1e1cbf(_0x5132c5,_0x394be6,_0x162703):_0x1e1cbf(_0x5132c5,_0x394be6))||_0x162703;}return _0x39da3a>0x3&&_0x162703&&Object['defineProperty'](_0x5132c5,_0x394be6,_0x162703),_0x162703;},__importStar=this&&this[a73_0x43f665(0xd4)]||function(_0x34182b){const _0x5292d2=a73_0x43f665;if(_0x34182b&&_0x34182b[_0x5292d2(0x85)])return _0x34182b;var _0x19c861={};if(_0x34182b!=null){for(var _0x3887f2 in _0x34182b)if(_0x3887f2!==_0x5292d2(0xc1)&&Object[_0x5292d2(0xbd)][_0x5292d2(0xb5)][_0x5292d2(0x8c)](_0x34182b,_0x3887f2))__createBinding(_0x19c861,_0x34182b,_0x3887f2);}return __setModuleDefault(_0x19c861,_0x34182b),_0x19c861;},__importDefault=this&&this['__importDefault']||function(_0x565898){const _0x355b53=a73_0x43f665;return _0x565898&&_0x565898[_0x355b53(0x85)]?_0x565898:{'default':_0x565898};};Object['defineProperty'](exports,a73_0x43f665(0x85),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;function a73_0x1a25(_0x520d12,_0x55d9fd){const _0x4344a2=a73_0x3717();return a73_0x1a25=function(_0x12b8d5,_0x249fb5){_0x12b8d5=_0x12b8d5-0x6d;let _0x37179a=_0x4344a2[_0x12b8d5];return _0x37179a;},a73_0x1a25(_0x520d12,_0x55d9fd);}const commit_components_dto_1=require(a73_0x43f665(0xc2)),events_1=__importDefault(require('events')),git_utils_1=require(a73_0x43f665(0x7e)),mdapi_utils_1=require(a73_0x43f665(0xb7)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a73_0x43f665(0xcf))),child_types_1=__importDefault(require('../../parsers/data/child-types')),utils_1=require('../../../shared/utils'),constants_1=require(a73_0x43f665(0xc8)),git_provider_1=require(a73_0x43f665(0xdc)),bitbucket_api_service_1=require(a73_0x43f665(0x9f)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a73_0x43f665(0xbf)),path_1=require(a73_0x43f665(0xc3)),providers_tokens_1=require('../../providers/providers.tokens');let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(){const _0x291a0c=a73_0x43f665;super(...arguments),this[_0x291a0c(0xde)]=0x3e8,this['componentsToWrite']=0x0,this[_0x291a0c(0xcb)]=0x0,this[_0x291a0c(0xd1)]=Date[_0x291a0c(0xa4)]();}async[a73_0x43f665(0xa9)](){const _0x1842fa=a73_0x43f665,{repo:_0x35e7aa}=this[_0x1842fa(0xd6)],_0x41c5bf=typedi_1[_0x1842fa(0xc1)][_0x1842fa(0xa2)](providers_tokens_1[_0x1842fa(0x70)]['credentials']);if(this[_0x1842fa(0xd6)][_0x1842fa(0x74)]===git_provider_1[_0x1842fa(0x6d)]['Bitbucket']){const _0x55f0fd=typedi_1[_0x1842fa(0xc1)][_0x1842fa(0xa2)](bitbucket_api_service_1['BitbucketApiService']);await _0x55f0fd[_0x1842fa(0xaf)]();}return _0x35e7aa[_0x1842fa(0xa6)]['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x1842fa(0xb1)])(_0x35e7aa[_0x1842fa(0xa6)])+_0x1842fa(0xa5)+_0x41c5bf[_0x1842fa(0xab)]()+'@');}[a73_0x43f665(0x9e)](_0x2b0fab){const _0xab0547=a73_0x43f665;var _0x14a152;_0x2b0fab[_0xab0547(0xae)](_0x39ed7b=>child_types_1['default']['includes'](_0x39ed7b[_0xab0547(0xc5)])?0x1:-0x1);const _0x44f2b7={};for(const _0x1dd0b4 of _0x2b0fab){_0x44f2b7[_0x14a152=_0x1dd0b4[_0xab0547(0x80)]]||(_0x44f2b7[_0x14a152]=[]),_0x44f2b7[_0x1dd0b4[_0xab0547(0x80)]][_0xab0547(0x7f)](_0x1dd0b4);}return Object[_0xab0547(0x7d)](_0x44f2b7)[_0xab0547(0xca)]((_0x543638,_0x4deafb)=>[..._0x543638,..._0x4deafb],[]);}async[a73_0x43f665(0x73)](_0x2fe247){const _0x4f03ba=a73_0x43f665;_0x2fe247=this[_0x4f03ba(0x9e)](_0x2fe247);let _0x8d363d=0x0;while(_0x2fe247[_0x4f03ba(0x7a)]){const _0x3be5be=_0x2fe247[_0x4f03ba(0xcc)](0x0,this[_0x4f03ba(0xde)]);await this[_0x4f03ba(0x7c)][_0x4f03ba(0xb9)](_0x3be5be,{'skipChildErrors':this['commitData'][_0x4f03ba(0x8e)][_0x4f03ba(0xac)]==='master'}),_0x8d363d+=_0x3be5be[_0x4f03ba(0x7a)],this[_0x4f03ba(0x94)][_0x4f03ba(0xc0)](this[_0x4f03ba(0xb0)]+'\x20Wrote\x20'+_0x8d363d+'/'+this[_0x4f03ba(0x95)]+_0x4f03ba(0xd0)),await this[_0x4f03ba(0x94)][_0x4f03ba(0x9b)]();}}async['removeComponents'](_0x55ffaf){const _0x5895ba=a73_0x43f665;_0x55ffaf[_0x5895ba(0xae)](_0x163c84=>child_types_1[_0x5895ba(0xc1)][_0x5895ba(0xa0)](_0x163c84[_0x5895ba(0x83)])?-0x1:0x1);let _0x4d5ea5=0x0;while(_0x55ffaf[_0x5895ba(0x7a)]){const _0x2aa0ac=_0x55ffaf[_0x5895ba(0xcc)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x5895ba(0x7c)][_0x5895ba(0xd3)](_0x2aa0ac),_0x4d5ea5+=_0x2aa0ac[_0x5895ba(0x7a)],this['sfLogger'][_0x5895ba(0xc0)](this[_0x5895ba(0xb0)]+'\x20Deleted\x20'+_0x4d5ea5+'/'+this[_0x5895ba(0xcb)]+_0x5895ba(0xd0)),await this['sfLogger']['send']();}}async[a73_0x43f665(0x9d)](){const _0x124e0c=a73_0x43f665;this[_0x124e0c(0x9a)]&&await this['gitUtils'][_0x124e0c(0xb8)]()[_0x124e0c(0xc6)](()=>void 0x0),this['mdapiUtils']&&await this['mdapiUtils'][_0x124e0c(0xb8)]()[_0x124e0c(0xc6)](()=>void 0x0),this[_0x124e0c(0xdf)]&&await this[_0x124e0c(0xdf)][_0x124e0c(0xb8)]()['catch'](()=>void 0x0);}async[a73_0x43f665(0x75)](){const _0x25eeb2=a73_0x43f665,{repo:_0x190057,branch:_0x33a786,components:_0x334007,convertToSFDX:_0x49649e,message:_0x4bc731,user:_0x1976b4}=this[_0x25eeb2(0xd6)];this['mdapiUtils']=new mdapi_utils_1[(_0x25eeb2(0x87))](),this[_0x25eeb2(0x9a)]=new git_utils_1[(_0x25eeb2(0xa7))](await this['getRemote']()),this[_0x25eeb2(0xdf)]=new sfdx_utils_1[(_0x25eeb2(0x91))]();let _0xf391dc=_0x49649e;try{await this[_0x25eeb2(0x94)][_0x25eeb2(0xc0)](this[_0x25eeb2(0xb0)]+_0x25eeb2(0x89))['send'](),await this[_0x25eeb2(0x9a)][_0x25eeb2(0xdd)](_0x33a786[_0x25eeb2(0xac)],_0x190057[_0x25eeb2(0xac)]);!this[_0x25eeb2(0xd6)]['force']?(this[_0x25eeb2(0x94)][_0x25eeb2(0xc0)](this[_0x25eeb2(0xb0)]+_0x25eeb2(0xbb)),await this[_0x25eeb2(0x7c)][_0x25eeb2(0x98)](this[_0x25eeb2(0x9a)][_0x25eeb2(0xba)])):this[_0x25eeb2(0x94)][_0x25eeb2(0xc0)](this[_0x25eeb2(0xb0)]+_0x25eeb2(0xb6));await this['sfLogger'][_0x25eeb2(0xc0)](this['prefix']+_0x25eeb2(0xcd))[_0x25eeb2(0x9b)]();_0x334007['writed']&&(this[_0x25eeb2(0x94)]['log'](this[_0x25eeb2(0xb0)]+_0x25eeb2(0x6e)),this[_0x25eeb2(0x95)]=_0x334007[_0x25eeb2(0xdb)][_0x25eeb2(0x7a)],await this['writeComponents'](_0x334007[_0x25eeb2(0xdb)]),await this[_0x25eeb2(0x94)][_0x25eeb2(0x9b)]());await this[_0x25eeb2(0x94)]['log'](this['prefix']+_0x25eeb2(0x9c))['send']();_0x334007[_0x25eeb2(0x8a)]&&(this['sfLogger'][_0x25eeb2(0xc0)](this[_0x25eeb2(0xb0)]+_0x25eeb2(0xc7)),this[_0x25eeb2(0xcb)]=_0x334007[_0x25eeb2(0x8a)][_0x25eeb2(0x7a)],await this[_0x25eeb2(0xd3)](_0x334007['deleted']),await this[_0x25eeb2(0x94)][_0x25eeb2(0x9b)]());await this[_0x25eeb2(0x94)][_0x25eeb2(0x9b)]();const _0x767f0b=await fs_internal_1['FS'][_0x25eeb2(0xb2)](this['gitUtils'][_0x25eeb2(0xba)]);await sfdx_utils_2[_0x25eeb2(0x71)][_0x25eeb2(0x97)](this[_0x25eeb2(0x9a)][_0x25eeb2(0xba)])?(_0xf391dc=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1[_0x25eeb2(0x93)])(this[_0x25eeb2(0x9a)]['dir'],'force-app'))):(_0xf391dc&&(!_0x767f0b&&(_0xf391dc=![])),await this[_0x25eeb2(0x9a)]['clearDir']());_0xf391dc?(await this[_0x25eeb2(0x94)]['log'](this[_0x25eeb2(0xb0)]+_0x25eeb2(0xa1))['send'](),await this[_0x25eeb2(0xdf)][_0x25eeb2(0x96)](this['mdapiUtils']['dir']),await this[_0x25eeb2(0xdf)][_0x25eeb2(0xbc)](this[_0x25eeb2(0x9a)][_0x25eeb2(0xba)],!_0x767f0b),await this[_0x25eeb2(0xdf)][_0x25eeb2(0xb8)]()):(await this['sfLogger'][_0x25eeb2(0xc0)](this['prefix']+_0x25eeb2(0xd8))['send'](),await this[_0x25eeb2(0x7c)][_0x25eeb2(0x72)](this['gitUtils'][_0x25eeb2(0xba)]));await this[_0x25eeb2(0x94)][_0x25eeb2(0xc0)](this[_0x25eeb2(0xb0)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')['send'](),await this[_0x25eeb2(0x9a)][_0x25eeb2(0x78)](_0x4bc731,{'email':constants_1[_0x25eeb2(0xa3)],'name':_0x1976b4[_0x25eeb2(0xac)]},_0x33a786['name']),await this['gitUtils'][_0x25eeb2(0xb8)](),await this[_0x25eeb2(0x7c)][_0x25eeb2(0xb8)]();const _0x13b3d3=this['componentsToWrite']+this[_0x25eeb2(0xcb)];await this['sfLogger'][_0x25eeb2(0xc0)](this[_0x25eeb2(0xb0)]+_0x25eeb2(0xaa)+(Date[_0x25eeb2(0xa4)]()-this[_0x25eeb2(0xd1)])+_0x25eeb2(0x90)+_0x13b3d3+'.')['send']();}catch(_0x59dad0){await this[_0x25eeb2(0x9d)](),await this[_0x25eeb2(0x94)]['error'](this['prefix']+'\x20'+_0x59dad0)[_0x25eeb2(0x9b)]();throw _0x59dad0;}}async[a73_0x43f665(0x84)](_0x4ffdbf,_0x45906c){const _0xbb126=a73_0x43f665;var _0x360ee8,_0xf4f571;this[_0xbb126(0x94)]=typedi_1[_0xbb126(0xc1)][_0xbb126(0xa2)](providers_tokens_1[_0xbb126(0x70)]['logger']),this[_0xbb126(0xb0)]=(_0x45906c?_0x45906c+'\x20':'')+'['+commit_components_dto_1[_0xbb126(0xd7)]['name']+']',await this['sfLogger']['log'](this['prefix']+_0xbb126(0xd2));const _0x344f3d=!!((_0x360ee8=_0x4ffdbf[_0xbb126(0xa8)])===null||_0x360ee8===void 0x0?void 0x0:_0x360ee8['writed'])||!!((_0xf4f571=_0x4ffdbf[_0xbb126(0xa8)])===null||_0xf4f571===void 0x0?void 0x0:_0xf4f571[_0xbb126(0x8a)]);if(!_0x344f3d){await this[_0xbb126(0x94)][_0xbb126(0xc0)](this[_0xbb126(0xb0)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0xbb126(0x9b)]();return;}this[_0xbb126(0xd6)]=_0x4ffdbf,await this[_0xbb126(0x75)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a73_0x43f665(0xda)])({'transient':!![]})],CommitComponentsJob),exports[a73_0x43f665(0x88)]=CommitComponentsJob;function a73_0x3717(){const _0x4b90ab=['componentsToWrite','createProjectFrom','isSFDXProject','prepareMdapi','apply','gitUtils','send','\x20Checking\x20deleted\x20components.','cleanUp','groupComponentsByFileName','../../providers/api/bitbucket-api.service','includes','\x20Start\x20converting\x20to\x20SFDX.','get','DEFAULT_GIT_USER_EMAIL','now','://','gitUrl','GitUtils','components','getRemote','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','getGitShellAuthorizationString','name','configurable','sort','isLoggedIn','prefix','getProtocol','isEmptyDir','__setModuleDefault','293FHufyu','hasOwnProperty','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','../utils/mdapi.utils','removeDir','writeFlosumComponents','dir','\x20Prepare\x20mdapi\x20files.','copyProjectTo','prototype','search','../../internal/fs.internal','log','default','../dto/commit-components.dto','path','3206454qCfDLi','fileType','catch','\x20Preparing\x20to\x20delete\x20components','../../../../constants','__decorate','reduce','componentsToDelete','splice','\x20Checking\x20written\x20components.','450264uSGCaq','typedi','\x20components','startTime','\x20Checking\x20commit\x20components.','removeComponents','__importStar','create','commitData','CommitComponentsDto','\x20Copying\x20mdapi\x20to\x20git\x20folder.','10976778zzITfi','Service','writed','../../providers/types/git-provider','clone','COMPONENTS_PER_TICK','sfdxUtils','GitProvider','\x20Preparing\x20to\x20write\x20components','__createBinding','Tokens','SFDX','copyMdapiTo','writeComponents','provider','exec','10RICwmL','defineProperty','commitAndPush','16205DfptXn','length','constructor','mdapiUtils','values','../utils/git.utils','push','fileName','5294uddioW','21484VoGIeI','type','run','__esModule','(((.+)+)+)+$','MDApiUtils','CommitComponentsJob','\x20Start\x20cloning\x20repository.','deleted','toString','call','200QBKtbF','branch','decorate','ms.\x20Committed\x20components\x20-\x20','SFDXUtils','5654395BurWnG','join','sfLogger'];a73_0x3717=function(){return _0x4b90ab;};return a73_0x3717();}