const a104_0xc9fa43=a104_0x5f10;function a104_0x3da7(){const _0x5e8724=['98nkRHOK','622776BylrrP','sort','send','includes','hasOwnProperty','credentials','cleanUp','clone','isEmptyDir','default','componentsToDelete','typedi','://','getProtocol','(((.+)+)+)+$','GitUtils','__createBinding','gitUrl','writed','CommitComponentsJob','../../providers/types/git-provider','fileName','type','toString','1828872TibAwL','removeDir','constructor','__setModuleDefault','../../../shared/utils','groupComponentsByFileName','21IpTbgt','\x20Copying\x20mdapi\x20to\x20git\x20folder.','Tokens','getRemote','prefix','log','path','startTime','137984aHewLZ','\x20Preparing\x20to\x20write\x20components','\x20Preparing\x20to\x20delete\x20components','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','603600oIYTPD','join','../../providers/providers.tokens','SFDX','search','__esModule','master','Service','get','commitData','decorate','\x20Wrote\x20','\x20Checking\x20written\x20components.','apply','\x20Deleted\x20','replace','components','values','run','call','COMPONENTS_PER_TICK','../../salesforce/utils/sfdx.utils','create','clearDir','now','../../providers/api/bitbucket-api.service','../../internal/fs.internal','dir','componentsToWrite','push','writeComponents','fileType','name','writeFlosumComponents','DEFAULT_GIT_USER_EMAIL','deleted','copyVlocityComponents','../../parsers/data/child-types','splice','sfLogger','prepareMdapi','../utils/git.utils','\x20Checking\x20deleted\x20components.','copyProjectTo','gitUtils','__importStar','exec','removeComponents','defineProperty','CommitComponentsDto','MDApiUtils','copyMdapiTo','catch','GitProvider','../../../../constants','\x20components','writable','\x20Start\x20converting\x20to\x20SFDX.','length','isSFDXProject','SFDXUtils','events','mdapiUtils','sfdxUtils','provider','19107850yzBWps','getOwnPropertyDescriptor','1135115XRBhiJ','12IfqMdE','161548Yupkji','force-app','\x20Checking\x20commit\x20components.','../dto/commit-components.dto'];a104_0x3da7=function(){return _0x5e8724;};return a104_0x3da7();}(function(_0x1141dd,_0x39ad8d){const _0xf32ca0=a104_0x5f10,_0x4ea08d=_0x1141dd();while(!![]){try{const _0x160f2e=parseInt(_0xf32ca0(0x1c1))/0x1+parseInt(_0xf32ca0(0x178))/0x2*(parseInt(_0xf32ca0(0x170))/0x3)+parseInt(_0xf32ca0(0x1c0))/0x4*(parseInt(_0xf32ca0(0x1bf))/0x5)+-parseInt(_0xf32ca0(0x17c))/0x6+-parseInt(_0xf32ca0(0x1c5))/0x7*(-parseInt(_0xf32ca0(0x1c6))/0x8)+parseInt(_0xf32ca0(0x1de))/0x9+-parseInt(_0xf32ca0(0x1bd))/0xa;if(_0x160f2e===_0x39ad8d)break;else _0x4ea08d['push'](_0x4ea08d['shift']());}catch(_0x59ab80){_0x4ea08d['push'](_0x4ea08d['shift']());}}}(a104_0x3da7,0x9440a));const a104_0x301fb=(function(){let _0x2e2812=!![];return function(_0x4409f6,_0x28bd0e){const _0x429925=_0x2e2812?function(){const _0x538e1d=a104_0x5f10;if(_0x28bd0e){const _0xd66413=_0x28bd0e[_0x538e1d(0x189)](_0x4409f6,arguments);return _0x28bd0e=null,_0xd66413;}}:function(){};return _0x2e2812=![],_0x429925;};}()),a104_0x131cbe=a104_0x301fb(this,function(){const _0x34ccc9=a104_0x5f10;return a104_0x131cbe[_0x34ccc9(0x1dd)]()[_0x34ccc9(0x180)](_0x34ccc9(0x1d4))['toString']()[_0x34ccc9(0x1e0)](a104_0x131cbe)[_0x34ccc9(0x180)](_0x34ccc9(0x1d4));});function a104_0x5f10(_0xd10910,_0x3f96e4){const _0x46ef9c=a104_0x3da7();return a104_0x5f10=function(_0x131cbe,_0x301fb){_0x131cbe=_0x131cbe-0x16d;let _0x3da71f=_0x46ef9c[_0x131cbe];return _0x3da71f;},a104_0x5f10(_0xd10910,_0x3f96e4);}a104_0x131cbe();'use strict';var __createBinding=this&&this[a104_0xc9fa43(0x1d6)]||(Object[a104_0xc9fa43(0x192)]?function(_0x5076be,_0x6209c4,_0x406545,_0x34bf8d){const _0x3fef68=a104_0xc9fa43;if(_0x34bf8d===undefined)_0x34bf8d=_0x406545;var _0x6b0fcf=Object[_0x3fef68(0x1be)](_0x6209c4,_0x406545);(!_0x6b0fcf||('get'in _0x6b0fcf?!_0x6209c4['__esModule']:_0x6b0fcf[_0x3fef68(0x1b4)]||_0x6b0fcf['configurable']))&&(_0x6b0fcf={'enumerable':!![],'get':function(){return _0x6209c4[_0x406545];}}),Object[_0x3fef68(0x1ac)](_0x5076be,_0x34bf8d,_0x6b0fcf);}:function(_0x169af9,_0x71d5be,_0x45a47e,_0x128ed7){if(_0x128ed7===undefined)_0x128ed7=_0x45a47e;_0x169af9[_0x128ed7]=_0x71d5be[_0x45a47e];}),__setModuleDefault=this&&this[a104_0xc9fa43(0x16d)]||(Object['create']?function(_0x33fa09,_0x4fae42){const _0x50bcf3=a104_0xc9fa43;Object[_0x50bcf3(0x1ac)](_0x33fa09,_0x50bcf3(0x1cf),{'enumerable':!![],'value':_0x4fae42});}:function(_0x2bb22c,_0x5c62d5){const _0x4bf58b=a104_0xc9fa43;_0x2bb22c[_0x4bf58b(0x1cf)]=_0x5c62d5;}),__decorate=this&&this['__decorate']||function(_0x3cec2d,_0x27fe51,_0x468ab3,_0x15f798){const _0x18f75b=a104_0xc9fa43;var _0x4a0188=arguments[_0x18f75b(0x1b6)],_0x477e99=_0x4a0188<0x3?_0x27fe51:_0x15f798===null?_0x15f798=Object[_0x18f75b(0x1be)](_0x27fe51,_0x468ab3):_0x15f798,_0x308000;if(typeof Reflect==='object'&&typeof Reflect[_0x18f75b(0x186)]==='function')_0x477e99=Reflect[_0x18f75b(0x186)](_0x3cec2d,_0x27fe51,_0x468ab3,_0x15f798);else{for(var _0x265eec=_0x3cec2d['length']-0x1;_0x265eec>=0x0;_0x265eec--)if(_0x308000=_0x3cec2d[_0x265eec])_0x477e99=(_0x4a0188<0x3?_0x308000(_0x477e99):_0x4a0188>0x3?_0x308000(_0x27fe51,_0x468ab3,_0x477e99):_0x308000(_0x27fe51,_0x468ab3))||_0x477e99;}return _0x4a0188>0x3&&_0x477e99&&Object[_0x18f75b(0x1ac)](_0x27fe51,_0x468ab3,_0x477e99),_0x477e99;},__importStar=this&&this[a104_0xc9fa43(0x1a9)]||function(_0x481c17){const _0x7cc8d=a104_0xc9fa43;if(_0x481c17&&_0x481c17[_0x7cc8d(0x181)])return _0x481c17;var _0x2400ee={};if(_0x481c17!=null){for(var _0x19dc1c in _0x481c17)if(_0x19dc1c!==_0x7cc8d(0x1cf)&&Object['prototype'][_0x7cc8d(0x1ca)][_0x7cc8d(0x18f)](_0x481c17,_0x19dc1c))__createBinding(_0x2400ee,_0x481c17,_0x19dc1c);}return __setModuleDefault(_0x2400ee,_0x481c17),_0x2400ee;},__importDefault=this&&this['__importDefault']||function(_0x27da94){const _0x35421a=a104_0xc9fa43;return _0x27da94&&_0x27da94[_0x35421a(0x181)]?_0x27da94:{'default':_0x27da94};};Object[a104_0xc9fa43(0x1ac)](exports,a104_0xc9fa43(0x181),{'value':!![]}),exports[a104_0xc9fa43(0x1d9)]=void 0x0;const commit_components_dto_1=require(a104_0xc9fa43(0x1c4)),events_1=__importDefault(require(a104_0xc9fa43(0x1b9))),git_utils_1=require(a104_0xc9fa43(0x1a5)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a104_0xc9fa43(0x1d1))),child_types_1=__importDefault(require(a104_0xc9fa43(0x1a1))),utils_1=require(a104_0xc9fa43(0x16e)),constants_1=require(a104_0xc9fa43(0x1b2)),git_provider_1=require(a104_0xc9fa43(0x1da)),bitbucket_api_service_1=require(a104_0xc9fa43(0x195)),sfdx_utils_2=require(a104_0xc9fa43(0x191)),fs_internal_1=require(a104_0xc9fa43(0x196)),path_1=require(a104_0xc9fa43(0x176)),providers_tokens_1=require(a104_0xc9fa43(0x17e)),constants_2=require('../../../../constants');let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0xc9fa43(0x1cf)]{constructor(){const _0x42a5be=a104_0xc9fa43;super(...arguments),this[_0x42a5be(0x190)]=0x3e8,this[_0x42a5be(0x198)]=0x0,this[_0x42a5be(0x1d0)]=0x0,this[_0x42a5be(0x177)]=Date[_0x42a5be(0x194)]();}async[a104_0xc9fa43(0x173)](){const _0x131ab6=a104_0xc9fa43,{repo:_0x49ec99}=this[_0x131ab6(0x185)],_0x58028f=typedi_1[_0x131ab6(0x1cf)][_0x131ab6(0x184)](providers_tokens_1[_0x131ab6(0x172)][_0x131ab6(0x1cb)]);if(this['commitData'][_0x131ab6(0x1bc)]===git_provider_1[_0x131ab6(0x1b1)]['Bitbucket']){const _0x1c8b54=typedi_1[_0x131ab6(0x1cf)]['get'](bitbucket_api_service_1['BitbucketApiService']);await _0x1c8b54['isLoggedIn']();}return _0x49ec99['gitUrl'][_0x131ab6(0x18b)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x131ab6(0x1d3)])(_0x49ec99[_0x131ab6(0x1d7)])+_0x131ab6(0x1d2)+_0x58028f['getGitShellAuthorizationString']()+'@');}[a104_0xc9fa43(0x16f)](_0x15a765){const _0x127631=a104_0xc9fa43;var _0x38cb04;_0x15a765[_0x127631(0x1c7)](_0x3b3f5e=>child_types_1[_0x127631(0x1cf)][_0x127631(0x1c9)](_0x3b3f5e[_0x127631(0x19b)])?0x1:-0x1);const _0x325f26={};for(const _0x2a75c3 of _0x15a765){_0x325f26[_0x38cb04=_0x2a75c3[_0x127631(0x1db)]]||(_0x325f26[_0x38cb04]=[]),_0x325f26[_0x2a75c3[_0x127631(0x1db)]][_0x127631(0x199)](_0x2a75c3);}return Object[_0x127631(0x18d)](_0x325f26)['reduce']((_0x55ddc4,_0x41afb2)=>[..._0x55ddc4,..._0x41afb2],[]);}async[a104_0xc9fa43(0x19a)](_0x67caf7){const _0x5ea748=a104_0xc9fa43;_0x67caf7=this[_0x5ea748(0x16f)](_0x67caf7);let _0x576afd=0x0;while(_0x67caf7[_0x5ea748(0x1b6)]){const _0x54e696=_0x67caf7[_0x5ea748(0x1a2)](0x0,this[_0x5ea748(0x190)]);await this[_0x5ea748(0x1ba)][_0x5ea748(0x19d)](_0x54e696,{'skipChildErrors':this[_0x5ea748(0x185)]['branch'][_0x5ea748(0x19c)]===_0x5ea748(0x182)}),_0x576afd+=_0x54e696['length'],this[_0x5ea748(0x1a3)][_0x5ea748(0x175)](this[_0x5ea748(0x174)]+_0x5ea748(0x187)+_0x576afd+'/'+this[_0x5ea748(0x198)]+_0x5ea748(0x1b3)),await this[_0x5ea748(0x1a3)]['send']();}}async['removeComponents'](_0x4c3c36){const _0x204e65=a104_0xc9fa43;_0x4c3c36[_0x204e65(0x1c7)](_0x5ea581=>child_types_1['default'][_0x204e65(0x1c9)](_0x5ea581[_0x204e65(0x1dc)])?-0x1:0x1);let _0x3c9efb=0x0;while(_0x4c3c36['length']){const _0x85bbae=_0x4c3c36[_0x204e65(0x1a2)](0x0,this[_0x204e65(0x190)]);await this[_0x204e65(0x1ba)][_0x204e65(0x1ab)](_0x85bbae),_0x3c9efb+=_0x85bbae[_0x204e65(0x1b6)],this[_0x204e65(0x1a3)][_0x204e65(0x175)](this[_0x204e65(0x174)]+_0x204e65(0x18a)+_0x3c9efb+'/'+this['componentsToDelete']+_0x204e65(0x1b3)),await this[_0x204e65(0x1a3)]['send']();}}async[a104_0xc9fa43(0x1cc)](){const _0x5d16ed=a104_0xc9fa43;this['gitUtils']&&await this[_0x5d16ed(0x1a8)]['removeDir']()[_0x5d16ed(0x1b0)](()=>void 0x0),this[_0x5d16ed(0x1ba)]&&await this['mdapiUtils']['removeDir']()[_0x5d16ed(0x1b0)](()=>void 0x0),this[_0x5d16ed(0x1bb)]&&await this['sfdxUtils'][_0x5d16ed(0x1df)]()[_0x5d16ed(0x1b0)](()=>void 0x0);}async[a104_0xc9fa43(0x1aa)](){const _0x267537=a104_0xc9fa43,{repo:_0xbf90e2,branch:_0x50c89c,components:_0x15f7f1,convertToSFDX:_0x106db4,message:_0x40a566,user:_0xac9214}=this['commitData'];this[_0x267537(0x1ba)]=new mdapi_utils_1[(_0x267537(0x1ae))](),this[_0x267537(0x1a8)]=new git_utils_1[(_0x267537(0x1d5))](await this[_0x267537(0x173)]()),this[_0x267537(0x1bb)]=new sfdx_utils_1[(_0x267537(0x1b8))]();let _0x11ff47=_0x106db4;try{await this['sfLogger']['log'](this[_0x267537(0x174)]+'\x20Start\x20cloning\x20repository.')['send'](),await this[_0x267537(0x1a8)][_0x267537(0x1cd)](_0x50c89c[_0x267537(0x19c)],_0xbf90e2['name']);!this[_0x267537(0x185)]['force']?(this[_0x267537(0x1a3)]['log'](this[_0x267537(0x174)]+'\x20Prepare\x20mdapi\x20files.'),await this['mdapiUtils'][_0x267537(0x1a4)](this[_0x267537(0x1a8)][_0x267537(0x197)])):this['sfLogger'][_0x267537(0x175)](this['prefix']+_0x267537(0x17b));await this[_0x267537(0x1a3)][_0x267537(0x175)](this[_0x267537(0x174)]+_0x267537(0x188))['send']();_0x15f7f1['writed']&&(this[_0x267537(0x1a3)][_0x267537(0x175)](this[_0x267537(0x174)]+_0x267537(0x179)),this[_0x267537(0x198)]=_0x15f7f1[_0x267537(0x1d8)][_0x267537(0x1b6)],await this[_0x267537(0x19a)](_0x15f7f1[_0x267537(0x1d8)]),await this[_0x267537(0x1a3)][_0x267537(0x1c8)]());await this[_0x267537(0x1a3)][_0x267537(0x175)](this[_0x267537(0x174)]+_0x267537(0x1a6))[_0x267537(0x1c8)]();_0x15f7f1[_0x267537(0x19f)]&&(this['sfLogger'][_0x267537(0x175)](this[_0x267537(0x174)]+_0x267537(0x17a)),this[_0x267537(0x1d0)]=_0x15f7f1[_0x267537(0x19f)]['length'],await this[_0x267537(0x1ab)](_0x15f7f1[_0x267537(0x19f)]),await this['sfLogger'][_0x267537(0x1c8)]());await this['sfLogger'][_0x267537(0x1c8)]();const _0x5d4fc2=await fs_internal_1['FS'][_0x267537(0x1ce)](this['gitUtils'][_0x267537(0x197)]);await sfdx_utils_2[_0x267537(0x17f)][_0x267537(0x1b7)](this[_0x267537(0x1a8)]['dir'])?(_0x11ff47=!![],await fs_internal_1['FS'][_0x267537(0x1df)]((0x0,path_1[_0x267537(0x17d)])(this[_0x267537(0x1a8)][_0x267537(0x197)],_0x267537(0x1c2)))):(_0x11ff47&&(!_0x5d4fc2&&(_0x11ff47=![])),await this['gitUtils'][_0x267537(0x193)]());_0x11ff47?(await this['sfLogger']['log'](this[_0x267537(0x174)]+_0x267537(0x1b5))[_0x267537(0x1c8)](),await this[_0x267537(0x1bb)]['createProjectFrom'](this[_0x267537(0x1ba)][_0x267537(0x197)]),await this[_0x267537(0x1bb)][_0x267537(0x1a7)](this[_0x267537(0x1a8)]['dir'],!_0x5d4fc2),await this['sfdxUtils'][_0x267537(0x1a0)](this[_0x267537(0x1ba)][_0x267537(0x197)],(0x0,path_1[_0x267537(0x17d)])(this[_0x267537(0x1a8)][_0x267537(0x197)],constants_2['FORCE_APP_DEFAULT_DIR'])),await this[_0x267537(0x1bb)][_0x267537(0x1df)]()):(await this['sfLogger'][_0x267537(0x175)](this['prefix']+_0x267537(0x171))[_0x267537(0x1c8)](),await this[_0x267537(0x1ba)][_0x267537(0x1af)](this[_0x267537(0x1a8)][_0x267537(0x197)]));await this[_0x267537(0x1a3)][_0x267537(0x175)](this[_0x267537(0x174)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')[_0x267537(0x1c8)](),await this['gitUtils']['commitAndPush'](_0x40a566,{'email':constants_1[_0x267537(0x19e)],'name':_0xac9214['name']},_0x50c89c[_0x267537(0x19c)]),await this['gitUtils'][_0x267537(0x1df)](),await this['mdapiUtils'][_0x267537(0x1df)]();const _0x55980c=this[_0x267537(0x198)]+this['componentsToDelete'];await this[_0x267537(0x1a3)][_0x267537(0x175)](this[_0x267537(0x174)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x267537(0x194)]()-this[_0x267537(0x177)])+'ms.\x20Committed\x20components\x20-\x20'+_0x55980c+'.')[_0x267537(0x1c8)]();}catch(_0x4c3fbf){await this[_0x267537(0x1cc)](),await this[_0x267537(0x1a3)]['error'](this[_0x267537(0x174)]+'\x20'+_0x4c3fbf)[_0x267537(0x1c8)]();throw _0x4c3fbf;}}async[a104_0xc9fa43(0x18e)](_0x47f016,_0x47360d){const _0x57452a=a104_0xc9fa43;var _0x5993e0,_0x17eabf;this[_0x57452a(0x1a3)]=typedi_1[_0x57452a(0x1cf)]['get'](providers_tokens_1[_0x57452a(0x172)]['logger']),this[_0x57452a(0x174)]=(_0x47360d?_0x47360d+'\x20':'')+'['+commit_components_dto_1[_0x57452a(0x1ad)][_0x57452a(0x19c)]+']',await this[_0x57452a(0x1a3)][_0x57452a(0x175)](this[_0x57452a(0x174)]+_0x57452a(0x1c3));const _0x4ce5f6=!!((_0x5993e0=_0x47f016[_0x57452a(0x18c)])===null||_0x5993e0===void 0x0?void 0x0:_0x5993e0[_0x57452a(0x1d8)])||!!((_0x17eabf=_0x47f016[_0x57452a(0x18c)])===null||_0x17eabf===void 0x0?void 0x0:_0x17eabf[_0x57452a(0x19f)]);if(!_0x4ce5f6){await this[_0x57452a(0x1a3)][_0x57452a(0x175)](this[_0x57452a(0x174)]+'\x20Nothing\x20to\x20commit.\x20Skip.')[_0x57452a(0x1c8)]();return;}this[_0x57452a(0x185)]=_0x47f016,await this[_0x57452a(0x1aa)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0xc9fa43(0x183)])({'transient':!![]})],CommitComponentsJob),exports[a104_0xc9fa43(0x1d9)]=CommitComponentsJob;