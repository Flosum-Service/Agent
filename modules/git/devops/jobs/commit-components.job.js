const a104_0x91c991=a104_0x4394;function a104_0x4394(_0x50c513,_0x49ea90){const _0x1bcbfb=a104_0x4dcc();return a104_0x4394=function(_0x41b983,_0x4d6cf4){_0x41b983=_0x41b983-0x133;let _0x4dcc81=_0x1bcbfb[_0x41b983];return _0x4dcc81;},a104_0x4394(_0x50c513,_0x49ea90);}(function(_0x2a1ae4,_0x5bd3c1){const _0x4b81b8=a104_0x4394,_0x2b032e=_0x2a1ae4();while(!![]){try{const _0x56a4d4=-parseInt(_0x4b81b8(0x178))/0x1*(-parseInt(_0x4b81b8(0x18f))/0x2)+-parseInt(_0x4b81b8(0x148))/0x3+-parseInt(_0x4b81b8(0x16d))/0x4*(parseInt(_0x4b81b8(0x140))/0x5)+-parseInt(_0x4b81b8(0x15b))/0x6+-parseInt(_0x4b81b8(0x191))/0x7*(parseInt(_0x4b81b8(0x166))/0x8)+parseInt(_0x4b81b8(0x186))/0x9*(parseInt(_0x4b81b8(0x16a))/0xa)+parseInt(_0x4b81b8(0x14c))/0xb*(-parseInt(_0x4b81b8(0x164))/0xc);if(_0x56a4d4===_0x5bd3c1)break;else _0x2b032e['push'](_0x2b032e['shift']());}catch(_0x412cd8){_0x2b032e['push'](_0x2b032e['shift']());}}}(a104_0x4dcc,0x817f6));const a104_0x4d6cf4=(function(){let _0x2cdcd0=!![];return function(_0x26507c,_0x781aab){const _0x4ea79f=_0x2cdcd0?function(){const _0x2cd7e3=a104_0x4394;if(_0x781aab){const _0x4167dd=_0x781aab[_0x2cd7e3(0x173)](_0x26507c,arguments);return _0x781aab=null,_0x4167dd;}}:function(){};return _0x2cdcd0=![],_0x4ea79f;};}()),a104_0x41b983=a104_0x4d6cf4(this,function(){const _0x5cd80b=a104_0x4394;return a104_0x41b983[_0x5cd80b(0x14d)]()[_0x5cd80b(0x14b)](_0x5cd80b(0x15f))[_0x5cd80b(0x14d)]()[_0x5cd80b(0x18d)](a104_0x41b983)[_0x5cd80b(0x14b)](_0x5cd80b(0x15f));});a104_0x41b983();'use strict';var __createBinding=this&&this[a104_0x91c991(0x19a)]||(Object[a104_0x91c991(0x1a6)]?function(_0x2a320f,_0x5c25a2,_0x374df5,_0x10619f){const _0x2401c9=a104_0x91c991;if(_0x10619f===undefined)_0x10619f=_0x374df5;var _0x222377=Object[_0x2401c9(0x15d)](_0x5c25a2,_0x374df5);(!_0x222377||(_0x2401c9(0x151)in _0x222377?!_0x5c25a2['__esModule']:_0x222377[_0x2401c9(0x13e)]||_0x222377[_0x2401c9(0x180)]))&&(_0x222377={'enumerable':!![],'get':function(){return _0x5c25a2[_0x374df5];}}),Object['defineProperty'](_0x2a320f,_0x10619f,_0x222377);}:function(_0x578a59,_0x1dcc16,_0x536cf0,_0x621a42){if(_0x621a42===undefined)_0x621a42=_0x536cf0;_0x578a59[_0x621a42]=_0x1dcc16[_0x536cf0];}),__setModuleDefault=this&&this[a104_0x91c991(0x195)]||(Object['create']?function(_0x298ea5,_0x445493){const _0x1a41d7=a104_0x91c991;Object[_0x1a41d7(0x199)](_0x298ea5,'default',{'enumerable':!![],'value':_0x445493});}:function(_0x4dca7f,_0x16ea5b){const _0x79c910=a104_0x91c991;_0x4dca7f[_0x79c910(0x1a4)]=_0x16ea5b;}),__decorate=this&&this[a104_0x91c991(0x1a5)]||function(_0x12cf64,_0xe09c7e,_0x5b7635,_0x3c9d33){const _0x3c4557=a104_0x91c991;var _0x151f71=arguments[_0x3c4557(0x17a)],_0x1573ab=_0x151f71<0x3?_0xe09c7e:_0x3c9d33===null?_0x3c9d33=Object[_0x3c4557(0x15d)](_0xe09c7e,_0x5b7635):_0x3c9d33,_0x19b6b5;if(typeof Reflect===_0x3c4557(0x15e)&&typeof Reflect[_0x3c4557(0x19d)]===_0x3c4557(0x136))_0x1573ab=Reflect[_0x3c4557(0x19d)](_0x12cf64,_0xe09c7e,_0x5b7635,_0x3c9d33);else{for(var _0x3c6a78=_0x12cf64[_0x3c4557(0x17a)]-0x1;_0x3c6a78>=0x0;_0x3c6a78--)if(_0x19b6b5=_0x12cf64[_0x3c6a78])_0x1573ab=(_0x151f71<0x3?_0x19b6b5(_0x1573ab):_0x151f71>0x3?_0x19b6b5(_0xe09c7e,_0x5b7635,_0x1573ab):_0x19b6b5(_0xe09c7e,_0x5b7635))||_0x1573ab;}return _0x151f71>0x3&&_0x1573ab&&Object[_0x3c4557(0x199)](_0xe09c7e,_0x5b7635,_0x1573ab),_0x1573ab;},__importStar=this&&this[a104_0x91c991(0x187)]||function(_0xe27e10){const _0x2978eb=a104_0x91c991;if(_0xe27e10&&_0xe27e10['__esModule'])return _0xe27e10;var _0x477c79={};if(_0xe27e10!=null){for(var _0x5345e4 in _0xe27e10)if(_0x5345e4!=='default'&&Object[_0x2978eb(0x169)]['hasOwnProperty'][_0x2978eb(0x133)](_0xe27e10,_0x5345e4))__createBinding(_0x477c79,_0xe27e10,_0x5345e4);}return __setModuleDefault(_0x477c79,_0xe27e10),_0x477c79;},__importDefault=this&&this['__importDefault']||function(_0x35a3d7){const _0x41387b=a104_0x91c991;return _0x35a3d7&&_0x35a3d7[_0x41387b(0x189)]?_0x35a3d7:{'default':_0x35a3d7};};function a104_0x4dcc(){const _0x5020ef=['__setModuleDefault','exec','push','isEmptyDir','defineProperty','__createBinding','componentsToWrite','../../parsers/data/child-types','decorate','../../salesforce/utils/sfdx.utils','groupComponentsByFileName','events','COMPONENTS_PER_TICK','sfLogger','replace','default','__decorate','create','DEFAULT_GIT_USER_EMAIL','startTime','\x20components','\x20Checking\x20written\x20components.','ms.\x20Committed\x20components\x20-\x20','gitUtils','call','force','now','function','GitProvider','typedi','copyVlocityComponents','sort','mdapiUtils','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','://','writable','CommitComponentsJob','204970juMMBO','commitAndPush','componentsToDelete','CommitComponentsDto','GitUtils','writeComponents','../dto/commit-components.dto','prefix','292947KJWHSX','\x20Wrote\x20','../../providers/providers.tokens','search','17655YPUKII','toString','isLoggedIn','../../../shared/utils','run','get','\x20Preparing\x20to\x20write\x20components','\x20Checking\x20deleted\x20components.','cleanUp','\x20Copying\x20mdapi\x20to\x20git\x20folder.','branch','prepareMdapi','send','../utils/mdapi.utils','clearDir','915984RyZeFA','../../providers/types/git-provider','getOwnPropertyDescriptor','object','(((.+)+)+)+$','../../../../constants','Service','Tokens','components','852yYAzYc','getProtocol','1064WDCYtc','BitbucketApiService','writed','prototype','350PowyEF','FORCE_APP_DEFAULT_DIR','fileName','12siUKQU','removeComponents','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','\x20Start\x20converting\x20to\x20SFDX.','splice','../../providers/api/bitbucket-api.service','apply','includes','Bitbucket','error','force-app','92UMWxyR','sfdxUtils','length','gitUrl','name','deleted','MDApiUtils','\x20Nothing\x20to\x20commit.\x20Skip.','configurable','join','\x20Deleted\x20','log','SFDXUtils','clone','70218DlfFId','__importStar','getRemote','__esModule','commitData','removeDir','values','constructor','catch','19246ecmYUY','provider','7406jtSUSE','master','\x20Checking\x20commit\x20components.','dir'];a104_0x4dcc=function(){return _0x5020ef;};return a104_0x4dcc();}Object[a104_0x91c991(0x199)](exports,a104_0x91c991(0x189),{'value':!![]}),exports[a104_0x91c991(0x13f)]=void 0x0;const commit_components_dto_1=require(a104_0x91c991(0x146)),events_1=__importDefault(require(a104_0x91c991(0x1a0))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require(a104_0x91c991(0x159)),sfdx_utils_1=require('../utils/sfdx.utils'),typedi_1=__importStar(require(a104_0x91c991(0x138))),child_types_1=__importDefault(require(a104_0x91c991(0x19c))),utils_1=require(a104_0x91c991(0x14f)),constants_1=require(a104_0x91c991(0x160)),git_provider_1=require(a104_0x91c991(0x15c)),bitbucket_api_service_1=require(a104_0x91c991(0x172)),sfdx_utils_2=require(a104_0x91c991(0x19e)),fs_internal_1=require('../../internal/fs.internal'),path_1=require('path'),providers_tokens_1=require(a104_0x91c991(0x14a)),constants_2=require(a104_0x91c991(0x160));let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(){const _0x1abb49=a104_0x91c991;super(...arguments),this[_0x1abb49(0x1a1)]=0x3e8,this['componentsToWrite']=0x0,this[_0x1abb49(0x142)]=0x0,this[_0x1abb49(0x1a8)]=Date[_0x1abb49(0x135)]();}async['getRemote'](){const _0x12f839=a104_0x91c991,{repo:_0x34a3bb}=this[_0x12f839(0x18a)],_0x3aebc9=typedi_1[_0x12f839(0x1a4)][_0x12f839(0x151)](providers_tokens_1[_0x12f839(0x162)]['credentials']);if(this['commitData'][_0x12f839(0x190)]===git_provider_1[_0x12f839(0x137)][_0x12f839(0x175)]){const _0x209802=typedi_1['default']['get'](bitbucket_api_service_1[_0x12f839(0x167)]);await _0x209802[_0x12f839(0x14e)]();}return _0x34a3bb['gitUrl'][_0x12f839(0x1a3)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x12f839(0x165)])(_0x34a3bb[_0x12f839(0x17b)])+_0x12f839(0x13d)+_0x3aebc9['getGitShellAuthorizationString']()+'@');}[a104_0x91c991(0x19f)](_0x10be0e){const _0x29626b=a104_0x91c991;var _0x599aef;_0x10be0e[_0x29626b(0x13a)](_0x32fd69=>child_types_1['default']['includes'](_0x32fd69['fileType'])?0x1:-0x1);const _0x5c8c67={};for(const _0x5f49b0 of _0x10be0e){_0x5c8c67[_0x599aef=_0x5f49b0[_0x29626b(0x16c)]]||(_0x5c8c67[_0x599aef]=[]),_0x5c8c67[_0x5f49b0[_0x29626b(0x16c)]][_0x29626b(0x197)](_0x5f49b0);}return Object[_0x29626b(0x18c)](_0x5c8c67)['reduce']((_0x4a73cf,_0x4c0a50)=>[..._0x4a73cf,..._0x4c0a50],[]);}async[a104_0x91c991(0x145)](_0x3686ea){const _0x18fb5f=a104_0x91c991;_0x3686ea=this['groupComponentsByFileName'](_0x3686ea);let _0x15950d=0x0;while(_0x3686ea[_0x18fb5f(0x17a)]){const _0x2c2283=_0x3686ea[_0x18fb5f(0x171)](0x0,this[_0x18fb5f(0x1a1)]);await this[_0x18fb5f(0x13b)]['writeFlosumComponents'](_0x2c2283,{'skipChildErrors':this['commitData'][_0x18fb5f(0x156)]['name']===_0x18fb5f(0x192)}),_0x15950d+=_0x2c2283[_0x18fb5f(0x17a)],this[_0x18fb5f(0x1a2)][_0x18fb5f(0x183)](this[_0x18fb5f(0x147)]+_0x18fb5f(0x149)+_0x15950d+'/'+this[_0x18fb5f(0x19b)]+_0x18fb5f(0x1a9)),await this[_0x18fb5f(0x1a2)][_0x18fb5f(0x158)]();}}async[a104_0x91c991(0x16e)](_0x4bf4fe){const _0x2117aa=a104_0x91c991;_0x4bf4fe['sort'](_0x52e493=>child_types_1[_0x2117aa(0x1a4)][_0x2117aa(0x174)](_0x52e493['type'])?-0x1:0x1);let _0x3d075e=0x0;while(_0x4bf4fe[_0x2117aa(0x17a)]){const _0x3ba6bf=_0x4bf4fe['splice'](0x0,this['COMPONENTS_PER_TICK']);await this[_0x2117aa(0x13b)][_0x2117aa(0x16e)](_0x3ba6bf),_0x3d075e+=_0x3ba6bf[_0x2117aa(0x17a)],this[_0x2117aa(0x1a2)]['log'](this['prefix']+_0x2117aa(0x182)+_0x3d075e+'/'+this[_0x2117aa(0x142)]+_0x2117aa(0x1a9)),await this['sfLogger']['send']();}}async[a104_0x91c991(0x154)](){const _0x544168=a104_0x91c991;this[_0x544168(0x1ac)]&&await this[_0x544168(0x1ac)]['removeDir']()[_0x544168(0x18e)](()=>void 0x0),this[_0x544168(0x13b)]&&await this[_0x544168(0x13b)]['removeDir']()[_0x544168(0x18e)](()=>void 0x0),this[_0x544168(0x179)]&&await this[_0x544168(0x179)]['removeDir']()[_0x544168(0x18e)](()=>void 0x0);}async['exec'](){const _0x1fea74=a104_0x91c991,{repo:_0x2de4de,branch:_0x59428a,components:_0x4f5787,convertToSFDX:_0x2b1118,message:_0x17b981,user:_0x504639}=this[_0x1fea74(0x18a)];this[_0x1fea74(0x13b)]=new mdapi_utils_1[(_0x1fea74(0x17e))](),this['gitUtils']=new git_utils_1[(_0x1fea74(0x144))](await this[_0x1fea74(0x188)]()),this[_0x1fea74(0x179)]=new sfdx_utils_1[(_0x1fea74(0x184))]();let _0x3e0765=_0x2b1118;try{await this[_0x1fea74(0x1a2)][_0x1fea74(0x183)](this[_0x1fea74(0x147)]+'\x20Start\x20cloning\x20repository.')[_0x1fea74(0x158)](),await this[_0x1fea74(0x1ac)][_0x1fea74(0x185)](_0x59428a[_0x1fea74(0x17c)],_0x2de4de[_0x1fea74(0x17c)]);!this[_0x1fea74(0x18a)][_0x1fea74(0x134)]?(this[_0x1fea74(0x1a2)]['log'](this['prefix']+'\x20Prepare\x20mdapi\x20files.'),await this[_0x1fea74(0x13b)][_0x1fea74(0x157)](this[_0x1fea74(0x1ac)]['dir'])):this[_0x1fea74(0x1a2)][_0x1fea74(0x183)](this[_0x1fea74(0x147)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x1fea74(0x1a2)][_0x1fea74(0x183)](this[_0x1fea74(0x147)]+_0x1fea74(0x1aa))[_0x1fea74(0x158)]();_0x4f5787[_0x1fea74(0x168)]&&(this['sfLogger']['log'](this[_0x1fea74(0x147)]+_0x1fea74(0x152)),this[_0x1fea74(0x19b)]=_0x4f5787[_0x1fea74(0x168)][_0x1fea74(0x17a)],await this['writeComponents'](_0x4f5787['writed']),await this[_0x1fea74(0x1a2)]['send']());await this['sfLogger'][_0x1fea74(0x183)](this['prefix']+_0x1fea74(0x153))[_0x1fea74(0x158)]();_0x4f5787[_0x1fea74(0x17d)]&&(this[_0x1fea74(0x1a2)][_0x1fea74(0x183)](this['prefix']+'\x20Preparing\x20to\x20delete\x20components'),this[_0x1fea74(0x142)]=_0x4f5787[_0x1fea74(0x17d)]['length'],await this['removeComponents'](_0x4f5787[_0x1fea74(0x17d)]),await this['sfLogger'][_0x1fea74(0x158)]());await this[_0x1fea74(0x1a2)][_0x1fea74(0x158)]();const _0x4a4557=await fs_internal_1['FS'][_0x1fea74(0x198)](this[_0x1fea74(0x1ac)][_0x1fea74(0x194)]);await sfdx_utils_2['SFDX']['isSFDXProject'](this[_0x1fea74(0x1ac)]['dir'])?(_0x3e0765=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1[_0x1fea74(0x181)])(this[_0x1fea74(0x1ac)][_0x1fea74(0x194)],_0x1fea74(0x177)))):(_0x3e0765&&(!_0x4a4557&&(_0x3e0765=![])),await this[_0x1fea74(0x1ac)][_0x1fea74(0x15a)]());_0x3e0765?(await this[_0x1fea74(0x1a2)][_0x1fea74(0x183)](this['prefix']+_0x1fea74(0x170))[_0x1fea74(0x158)](),await this[_0x1fea74(0x179)]['createProjectFrom'](this['mdapiUtils']['dir']),await this[_0x1fea74(0x179)]['copyProjectTo'](this[_0x1fea74(0x1ac)][_0x1fea74(0x194)],!_0x4a4557),await this[_0x1fea74(0x179)][_0x1fea74(0x139)](this[_0x1fea74(0x13b)][_0x1fea74(0x194)],(0x0,path_1['join'])(this[_0x1fea74(0x1ac)][_0x1fea74(0x194)],constants_2[_0x1fea74(0x16b)])),await this[_0x1fea74(0x179)][_0x1fea74(0x18b)]()):(await this[_0x1fea74(0x1a2)]['log'](this[_0x1fea74(0x147)]+_0x1fea74(0x155))[_0x1fea74(0x158)](),await this['mdapiUtils']['copyMdapiTo'](this[_0x1fea74(0x1ac)][_0x1fea74(0x194)]));await this['sfLogger'][_0x1fea74(0x183)](this[_0x1fea74(0x147)]+_0x1fea74(0x13c))[_0x1fea74(0x158)](),await this[_0x1fea74(0x1ac)][_0x1fea74(0x141)](_0x17b981,{'email':constants_1[_0x1fea74(0x1a7)],'name':_0x504639[_0x1fea74(0x17c)]},_0x59428a[_0x1fea74(0x17c)]),await this[_0x1fea74(0x1ac)][_0x1fea74(0x18b)](),await this[_0x1fea74(0x13b)][_0x1fea74(0x18b)]();const _0x3b3aa5=this[_0x1fea74(0x19b)]+this[_0x1fea74(0x142)];await this[_0x1fea74(0x1a2)][_0x1fea74(0x183)](this['prefix']+_0x1fea74(0x16f)+(Date['now']()-this['startTime'])+_0x1fea74(0x1ab)+_0x3b3aa5+'.')['send']();}catch(_0x58c99c){await this[_0x1fea74(0x154)](),await this['sfLogger'][_0x1fea74(0x176)](this[_0x1fea74(0x147)]+'\x20'+_0x58c99c)[_0x1fea74(0x158)]();throw _0x58c99c;}}async[a104_0x91c991(0x150)](_0x34f70f,_0x25987a){const _0x3c25a1=a104_0x91c991;var _0x44d3f0,_0x5ecafc;this[_0x3c25a1(0x1a2)]=typedi_1[_0x3c25a1(0x1a4)][_0x3c25a1(0x151)](providers_tokens_1['Tokens']['logger']),this['prefix']=(_0x25987a?_0x25987a+'\x20':'')+'['+commit_components_dto_1[_0x3c25a1(0x143)][_0x3c25a1(0x17c)]+']',await this['sfLogger'][_0x3c25a1(0x183)](this['prefix']+_0x3c25a1(0x193));const _0x925f3c=!!((_0x44d3f0=_0x34f70f['components'])===null||_0x44d3f0===void 0x0?void 0x0:_0x44d3f0[_0x3c25a1(0x168)])||!!((_0x5ecafc=_0x34f70f[_0x3c25a1(0x163)])===null||_0x5ecafc===void 0x0?void 0x0:_0x5ecafc['deleted']);if(!_0x925f3c){await this[_0x3c25a1(0x1a2)][_0x3c25a1(0x183)](this[_0x3c25a1(0x147)]+_0x3c25a1(0x17f))['send']();return;}this[_0x3c25a1(0x18a)]=_0x34f70f,await this[_0x3c25a1(0x196)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x91c991(0x161)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x91c991(0x13f)]=CommitComponentsJob;