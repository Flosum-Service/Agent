const a104_0x54f8e5=a104_0x4444;(function(_0x28cceb,_0x3f9ec1){const _0x1041f4=a104_0x4444,_0x37a7ca=_0x28cceb();while(!![]){try{const _0x4bc1e3=parseInt(_0x1041f4(0x1c8))/0x1+parseInt(_0x1041f4(0x194))/0x2*(parseInt(_0x1041f4(0x1cc))/0x3)+parseInt(_0x1041f4(0x168))/0x4*(-parseInt(_0x1041f4(0x1b9))/0x5)+parseInt(_0x1041f4(0x1bf))/0x6+parseInt(_0x1041f4(0x1af))/0x7*(-parseInt(_0x1041f4(0x186))/0x8)+parseInt(_0x1041f4(0x181))/0x9*(-parseInt(_0x1041f4(0x18e))/0xa)+parseInt(_0x1041f4(0x175))/0xb*(parseInt(_0x1041f4(0x184))/0xc);if(_0x4bc1e3===_0x3f9ec1)break;else _0x37a7ca['push'](_0x37a7ca['shift']());}catch(_0x3f67da){_0x37a7ca['push'](_0x37a7ca['shift']());}}}(a104_0x3c23,0xb7b82));const a104_0x274fda=(function(){let _0x23989f=!![];return function(_0xf394d2,_0x1feb0d){const _0x13ef26=_0x23989f?function(){const _0x1abd75=a104_0x4444;if(_0x1feb0d){const _0xbd9137=_0x1feb0d[_0x1abd75(0x191)](_0xf394d2,arguments);return _0x1feb0d=null,_0xbd9137;}}:function(){};return _0x23989f=![],_0x13ef26;};}()),a104_0x524ef4=a104_0x274fda(this,function(){const _0x19824a=a104_0x4444;return a104_0x524ef4[_0x19824a(0x18c)]()[_0x19824a(0x1cb)](_0x19824a(0x16f))['toString']()[_0x19824a(0x171)](a104_0x524ef4)[_0x19824a(0x1cb)]('(((.+)+)+)+$');});a104_0x524ef4();'use strict';var __createBinding=this&&this[a104_0x54f8e5(0x17c)]||(Object[a104_0x54f8e5(0x1c3)]?function(_0x1e79ed,_0x514105,_0x131850,_0x59845d){const _0x56ac40=a104_0x54f8e5;if(_0x59845d===undefined)_0x59845d=_0x131850;var _0x2aa65d=Object[_0x56ac40(0x195)](_0x514105,_0x131850);(!_0x2aa65d||(_0x56ac40(0x1b7)in _0x2aa65d?!_0x514105['__esModule']:_0x2aa65d['writable']||_0x2aa65d['configurable']))&&(_0x2aa65d={'enumerable':!![],'get':function(){return _0x514105[_0x131850];}}),Object['defineProperty'](_0x1e79ed,_0x59845d,_0x2aa65d);}:function(_0x4e4b7a,_0x1eca98,_0x2018f3,_0xc60cac){if(_0xc60cac===undefined)_0xc60cac=_0x2018f3;_0x4e4b7a[_0xc60cac]=_0x1eca98[_0x2018f3];}),__setModuleDefault=this&&this[a104_0x54f8e5(0x18b)]||(Object[a104_0x54f8e5(0x1c3)]?function(_0x4eba4e,_0x18ffa0){const _0x52b777=a104_0x54f8e5;Object[_0x52b777(0x1aa)](_0x4eba4e,_0x52b777(0x1bb),{'enumerable':!![],'value':_0x18ffa0});}:function(_0x22a1a7,_0x531067){const _0x31b7c8=a104_0x54f8e5;_0x22a1a7[_0x31b7c8(0x1bb)]=_0x531067;}),__decorate=this&&this[a104_0x54f8e5(0x1d0)]||function(_0x2942d5,_0x511502,_0x1aba76,_0x5d23fb){const _0x5f5959=a104_0x54f8e5;var _0x5eace6=arguments[_0x5f5959(0x18d)],_0x135fbe=_0x5eace6<0x3?_0x511502:_0x5d23fb===null?_0x5d23fb=Object[_0x5f5959(0x195)](_0x511502,_0x1aba76):_0x5d23fb,_0x1e243e;if(typeof Reflect===_0x5f5959(0x188)&&typeof Reflect[_0x5f5959(0x192)]===_0x5f5959(0x1c2))_0x135fbe=Reflect[_0x5f5959(0x192)](_0x2942d5,_0x511502,_0x1aba76,_0x5d23fb);else{for(var _0x528871=_0x2942d5[_0x5f5959(0x18d)]-0x1;_0x528871>=0x0;_0x528871--)if(_0x1e243e=_0x2942d5[_0x528871])_0x135fbe=(_0x5eace6<0x3?_0x1e243e(_0x135fbe):_0x5eace6>0x3?_0x1e243e(_0x511502,_0x1aba76,_0x135fbe):_0x1e243e(_0x511502,_0x1aba76))||_0x135fbe;}return _0x5eace6>0x3&&_0x135fbe&&Object[_0x5f5959(0x1aa)](_0x511502,_0x1aba76,_0x135fbe),_0x135fbe;},__importStar=this&&this[a104_0x54f8e5(0x170)]||function(_0x3ad34f){const _0x27b347=a104_0x54f8e5;if(_0x3ad34f&&_0x3ad34f[_0x27b347(0x1d2)])return _0x3ad34f;var _0x2d9b8b={};if(_0x3ad34f!=null){for(var _0xf4b08 in _0x3ad34f)if(_0xf4b08!==_0x27b347(0x1bb)&&Object['prototype']['hasOwnProperty']['call'](_0x3ad34f,_0xf4b08))__createBinding(_0x2d9b8b,_0x3ad34f,_0xf4b08);}return __setModuleDefault(_0x2d9b8b,_0x3ad34f),_0x2d9b8b;},__importDefault=this&&this[a104_0x54f8e5(0x1d4)]||function(_0x285e28){const _0x57148f=a104_0x54f8e5;return _0x285e28&&_0x285e28[_0x57148f(0x1d2)]?_0x285e28:{'default':_0x285e28};};Object[a104_0x54f8e5(0x1aa)](exports,a104_0x54f8e5(0x1d2),{'value':!![]}),exports[a104_0x54f8e5(0x16d)]=void 0x0;function a104_0x4444(_0x235ffe,_0x575631){const _0x4c38b2=a104_0x3c23();return a104_0x4444=function(_0x524ef4,_0x274fda){_0x524ef4=_0x524ef4-0x163;let _0x3c2328=_0x4c38b2[_0x524ef4];return _0x3c2328;},a104_0x4444(_0x235ffe,_0x575631);}function a104_0x3c23(){const _0x44e02c=['type','isLoggedIn','sfLogger','../../providers/api/bitbucket-api.service','CommitComponentsJob','exec','(((.+)+)+)+$','__importStar','constructor','COMPONENTS_PER_TICK','://','cleanUp','22NTcAza','reduce','../../parsers/data/child-types','copyMdapiTo','SFDX','\x20Deleted\x20','\x20Start\x20converting\x20to\x20SFDX.','__createBinding','groupComponentsByFileName','logger','components','path','9htTESG','\x20Checking\x20commit\x20components.','prepareMdapi','2935032GfTzLZ','now','1014048GIJHpz','credentials','object','Tokens','sfdxUtils','__setModuleDefault','toString','length','6764340lhrhnK','provider','startTime','apply','decorate','branch','2038qmJMXC','getOwnPropertyDescriptor','\x20Copying\x20mdapi\x20to\x20git\x20folder.','../../providers/providers.tokens','Service','\x20Prepare\x20mdapi\x20files.','../../internal/fs.internal','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','\x20Wrote\x20','mdapiUtils','sort','getGitShellAuthorizationString','SFDXUtils','run','../../providers/types/git-provider','splice','force-app','\x20components','force','deleted','dir','removeComponents','defineProperty','send','\x20Start\x20cloning\x20repository.','values','commitData','7ILNfHy','name','componentsToWrite','\x20Nothing\x20to\x20commit.\x20Skip.','gitUtils','../../../shared/utils','MDApiUtils','isSFDXProject','get','writeComponents','30KoVBoA','BitbucketApiService','default','isEmptyDir','log','CommitComponentsDto','4272024bJAZbs','Bitbucket','master','function','create','catch','writed','fileName','../utils/git.utils','462879VqudsT','../utils/sfdx.utils','join','search','2043cRpcQo','prefix','ms.\x20Committed\x20components\x20-\x20','../utils/mdapi.utils','__decorate','clone','__esModule','gitUrl','__importDefault','removeDir','componentsToDelete','../dto/commit-components.dto','getRemote','clearDir','includes','createProjectFrom','../../salesforce/utils/sfdx.utils','534860dULVuj'];a104_0x3c23=function(){return _0x44e02c;};return a104_0x3c23();}const commit_components_dto_1=require(a104_0x54f8e5(0x1d7)),events_1=__importDefault(require('events')),git_utils_1=require(a104_0x54f8e5(0x1c7)),mdapi_utils_1=require(a104_0x54f8e5(0x1cf)),sfdx_utils_1=require(a104_0x54f8e5(0x1c9)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a104_0x54f8e5(0x177))),utils_1=require(a104_0x54f8e5(0x1b4)),constants_1=require('../../../../constants'),git_provider_1=require(a104_0x54f8e5(0x1a2)),bitbucket_api_service_1=require(a104_0x54f8e5(0x16c)),sfdx_utils_2=require(a104_0x54f8e5(0x167)),fs_internal_1=require(a104_0x54f8e5(0x19a)),path_1=require(a104_0x54f8e5(0x180)),providers_tokens_1=require(a104_0x54f8e5(0x197));let CommitComponentsJob=class CommitComponentsJob extends events_1[a104_0x54f8e5(0x1bb)]{constructor(){const _0x11b625=a104_0x54f8e5;super(...arguments),this[_0x11b625(0x172)]=0x3e8,this[_0x11b625(0x1b1)]=0x0,this[_0x11b625(0x1d6)]=0x0,this[_0x11b625(0x190)]=Date[_0x11b625(0x185)]();}async[a104_0x54f8e5(0x163)](){const _0x31e4e5=a104_0x54f8e5,{repo:_0x5e0498}=this[_0x31e4e5(0x1ae)],_0x52b65f=typedi_1['default'][_0x31e4e5(0x1b7)](providers_tokens_1[_0x31e4e5(0x189)][_0x31e4e5(0x187)]);if(this['commitData'][_0x31e4e5(0x18f)]===git_provider_1['GitProvider'][_0x31e4e5(0x1c0)]){const _0x3658e6=typedi_1[_0x31e4e5(0x1bb)][_0x31e4e5(0x1b7)](bitbucket_api_service_1[_0x31e4e5(0x1ba)]);await _0x3658e6[_0x31e4e5(0x16a)]();}return _0x5e0498[_0x31e4e5(0x1d3)]['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1['getProtocol'])(_0x5e0498[_0x31e4e5(0x1d3)])+_0x31e4e5(0x173)+_0x52b65f[_0x31e4e5(0x19f)]()+'@');}[a104_0x54f8e5(0x17d)](_0x296257){const _0x16b378=a104_0x54f8e5;var _0x4a77e6;_0x296257[_0x16b378(0x19e)](_0x15e053=>child_types_1[_0x16b378(0x1bb)][_0x16b378(0x165)](_0x15e053['fileType'])?0x1:-0x1);const _0x3bb185={};for(const _0x4a0fcd of _0x296257){_0x3bb185[_0x4a77e6=_0x4a0fcd[_0x16b378(0x1c6)]]||(_0x3bb185[_0x4a77e6]=[]),_0x3bb185[_0x4a0fcd['fileName']]['push'](_0x4a0fcd);}return Object[_0x16b378(0x1ad)](_0x3bb185)[_0x16b378(0x176)]((_0x42d120,_0x383070)=>[..._0x42d120,..._0x383070],[]);}async[a104_0x54f8e5(0x1b8)](_0x459f4e){const _0x103485=a104_0x54f8e5;_0x459f4e=this[_0x103485(0x17d)](_0x459f4e);let _0x1d0e05=0x0;while(_0x459f4e[_0x103485(0x18d)]){const _0xb4397e=_0x459f4e['splice'](0x0,this[_0x103485(0x172)]);await this['mdapiUtils']['writeFlosumComponents'](_0xb4397e,{'skipChildErrors':this[_0x103485(0x1ae)][_0x103485(0x193)][_0x103485(0x1b0)]===_0x103485(0x1c1)}),_0x1d0e05+=_0xb4397e[_0x103485(0x18d)],this['sfLogger'][_0x103485(0x1bd)](this['prefix']+_0x103485(0x19c)+_0x1d0e05+'/'+this[_0x103485(0x1b1)]+_0x103485(0x1a5)),await this[_0x103485(0x16b)][_0x103485(0x1ab)]();}}async[a104_0x54f8e5(0x1a9)](_0x1deea6){const _0x4b10c8=a104_0x54f8e5;_0x1deea6[_0x4b10c8(0x19e)](_0x3575f9=>child_types_1[_0x4b10c8(0x1bb)][_0x4b10c8(0x165)](_0x3575f9[_0x4b10c8(0x169)])?-0x1:0x1);let _0x4978a3=0x0;while(_0x1deea6[_0x4b10c8(0x18d)]){const _0x3146aa=_0x1deea6[_0x4b10c8(0x1a3)](0x0,this[_0x4b10c8(0x172)]);await this['mdapiUtils']['removeComponents'](_0x3146aa),_0x4978a3+=_0x3146aa['length'],this[_0x4b10c8(0x16b)]['log'](this[_0x4b10c8(0x1cd)]+_0x4b10c8(0x17a)+_0x4978a3+'/'+this[_0x4b10c8(0x1d6)]+'\x20components'),await this[_0x4b10c8(0x16b)][_0x4b10c8(0x1ab)]();}}async['cleanUp'](){const _0x26f45c=a104_0x54f8e5;this[_0x26f45c(0x1b3)]&&await this['gitUtils'][_0x26f45c(0x1d5)]()['catch'](()=>void 0x0),this['mdapiUtils']&&await this['mdapiUtils'][_0x26f45c(0x1d5)]()['catch'](()=>void 0x0),this[_0x26f45c(0x18a)]&&await this['sfdxUtils'][_0x26f45c(0x1d5)]()[_0x26f45c(0x1c4)](()=>void 0x0);}async[a104_0x54f8e5(0x16e)](){const _0x5bbec6=a104_0x54f8e5,{repo:_0x2459d1,branch:_0xf6e49d,components:_0x4d81e7,convertToSFDX:_0x49c160,message:_0x292995,user:_0x4dbe92}=this[_0x5bbec6(0x1ae)];this[_0x5bbec6(0x19d)]=new mdapi_utils_1[(_0x5bbec6(0x1b5))](),this['gitUtils']=new git_utils_1['GitUtils'](await this[_0x5bbec6(0x163)]()),this['sfdxUtils']=new sfdx_utils_1[(_0x5bbec6(0x1a0))]();let _0x4b9c2c=_0x49c160;try{await this['sfLogger']['log'](this[_0x5bbec6(0x1cd)]+_0x5bbec6(0x1ac))['send'](),await this['gitUtils'][_0x5bbec6(0x1d1)](_0xf6e49d[_0x5bbec6(0x1b0)],_0x2459d1[_0x5bbec6(0x1b0)]);!this[_0x5bbec6(0x1ae)][_0x5bbec6(0x1a6)]?(this[_0x5bbec6(0x16b)][_0x5bbec6(0x1bd)](this[_0x5bbec6(0x1cd)]+_0x5bbec6(0x199)),await this[_0x5bbec6(0x19d)][_0x5bbec6(0x183)](this[_0x5bbec6(0x1b3)][_0x5bbec6(0x1a8)])):this['sfLogger']['log'](this[_0x5bbec6(0x1cd)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x5bbec6(0x16b)][_0x5bbec6(0x1bd)](this[_0x5bbec6(0x1cd)]+'\x20Checking\x20written\x20components.')[_0x5bbec6(0x1ab)]();_0x4d81e7[_0x5bbec6(0x1c5)]&&(this['sfLogger']['log'](this[_0x5bbec6(0x1cd)]+'\x20Preparing\x20to\x20write\x20components'),this[_0x5bbec6(0x1b1)]=_0x4d81e7[_0x5bbec6(0x1c5)]['length'],await this[_0x5bbec6(0x1b8)](_0x4d81e7[_0x5bbec6(0x1c5)]),await this['sfLogger']['send']());await this['sfLogger'][_0x5bbec6(0x1bd)](this[_0x5bbec6(0x1cd)]+'\x20Checking\x20deleted\x20components.')[_0x5bbec6(0x1ab)]();_0x4d81e7[_0x5bbec6(0x1a7)]&&(this['sfLogger']['log'](this['prefix']+'\x20Preparing\x20to\x20delete\x20components'),this[_0x5bbec6(0x1d6)]=_0x4d81e7[_0x5bbec6(0x1a7)][_0x5bbec6(0x18d)],await this[_0x5bbec6(0x1a9)](_0x4d81e7['deleted']),await this[_0x5bbec6(0x16b)][_0x5bbec6(0x1ab)]());await this[_0x5bbec6(0x16b)][_0x5bbec6(0x1ab)]();const _0x4540bb=await fs_internal_1['FS'][_0x5bbec6(0x1bc)](this[_0x5bbec6(0x1b3)]['dir']);await sfdx_utils_2[_0x5bbec6(0x179)][_0x5bbec6(0x1b6)](this[_0x5bbec6(0x1b3)]['dir'])?(_0x4b9c2c=!![],await fs_internal_1['FS']['removeDir']((0x0,path_1[_0x5bbec6(0x1ca)])(this[_0x5bbec6(0x1b3)][_0x5bbec6(0x1a8)],_0x5bbec6(0x1a4)))):(_0x4b9c2c&&(!_0x4540bb&&(_0x4b9c2c=![])),await this[_0x5bbec6(0x1b3)][_0x5bbec6(0x164)]());_0x4b9c2c?(await this['sfLogger']['log'](this[_0x5bbec6(0x1cd)]+_0x5bbec6(0x17b))[_0x5bbec6(0x1ab)](),await this[_0x5bbec6(0x18a)][_0x5bbec6(0x166)](this['mdapiUtils'][_0x5bbec6(0x1a8)]),await this[_0x5bbec6(0x18a)]['copyProjectTo'](this['gitUtils'][_0x5bbec6(0x1a8)],!_0x4540bb),await this[_0x5bbec6(0x18a)][_0x5bbec6(0x1d5)]()):(await this[_0x5bbec6(0x16b)][_0x5bbec6(0x1bd)](this[_0x5bbec6(0x1cd)]+_0x5bbec6(0x196))[_0x5bbec6(0x1ab)](),await this[_0x5bbec6(0x19d)][_0x5bbec6(0x178)](this[_0x5bbec6(0x1b3)][_0x5bbec6(0x1a8)]));await this[_0x5bbec6(0x16b)][_0x5bbec6(0x1bd)](this[_0x5bbec6(0x1cd)]+_0x5bbec6(0x19b))[_0x5bbec6(0x1ab)](),await this[_0x5bbec6(0x1b3)]['commitAndPush'](_0x292995,{'email':constants_1['DEFAULT_GIT_USER_EMAIL'],'name':_0x4dbe92['name']},_0xf6e49d['name']),await this['gitUtils']['removeDir'](),await this[_0x5bbec6(0x19d)][_0x5bbec6(0x1d5)]();const _0x2cb493=this[_0x5bbec6(0x1b1)]+this[_0x5bbec6(0x1d6)];await this[_0x5bbec6(0x16b)][_0x5bbec6(0x1bd)](this[_0x5bbec6(0x1cd)]+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x5bbec6(0x185)]()-this[_0x5bbec6(0x190)])+_0x5bbec6(0x1ce)+_0x2cb493+'.')[_0x5bbec6(0x1ab)]();}catch(_0x319aff){await this[_0x5bbec6(0x174)](),await this[_0x5bbec6(0x16b)]['error'](this[_0x5bbec6(0x1cd)]+'\x20'+_0x319aff)['send']();throw _0x319aff;}}async[a104_0x54f8e5(0x1a1)](_0x5891cb,_0x9a8a63){const _0x40134c=a104_0x54f8e5;var _0xce82ea,_0x277aad;this[_0x40134c(0x16b)]=typedi_1[_0x40134c(0x1bb)]['get'](providers_tokens_1[_0x40134c(0x189)][_0x40134c(0x17e)]),this[_0x40134c(0x1cd)]=(_0x9a8a63?_0x9a8a63+'\x20':'')+'['+commit_components_dto_1[_0x40134c(0x1be)][_0x40134c(0x1b0)]+']',await this[_0x40134c(0x16b)][_0x40134c(0x1bd)](this[_0x40134c(0x1cd)]+_0x40134c(0x182));const _0x2dd714=!!((_0xce82ea=_0x5891cb[_0x40134c(0x17f)])===null||_0xce82ea===void 0x0?void 0x0:_0xce82ea[_0x40134c(0x1c5)])||!!((_0x277aad=_0x5891cb[_0x40134c(0x17f)])===null||_0x277aad===void 0x0?void 0x0:_0x277aad[_0x40134c(0x1a7)]);if(!_0x2dd714){await this[_0x40134c(0x16b)]['log'](this[_0x40134c(0x1cd)]+_0x40134c(0x1b2))[_0x40134c(0x1ab)]();return;}this[_0x40134c(0x1ae)]=_0x5891cb,await this[_0x40134c(0x16e)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a104_0x54f8e5(0x198)])({'transient':!![]})],CommitComponentsJob),exports[a104_0x54f8e5(0x16d)]=CommitComponentsJob;