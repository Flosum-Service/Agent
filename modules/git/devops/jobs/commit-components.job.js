const a124_0x556362=a124_0x2cd4;function a124_0x2759(){const _0x2df8ac=['../utils/git.utils','type','mdapiUtils','\x20Deleted\x20','dir','sfLogger','Tokens','recordType','MDApiUtils','isEmptyDir','365877KqvFnS','__createBinding','__importDefault','exec','apply','\x20Start\x20cloning\x20repository.','deleted','Bitbucket','groupComponentsByFileName','values','name','COMPONENTS_PER_TICK','writable','DEFAULT_GIT_USER_EMAIL','removeComponents','catch','\x20Checking\x20deleted\x20components.','\x20Preparing\x20to\x20write\x20components','663582OyzmKM','614256yGNAcf','../utils/mdapi.utils','sfdxUtils','get','CommitComponentsDto','clearDir','clone','getGitShellAuthorizationString','../utils/sfdx.utils','../../providers/types/git-provider','credentials','getRemote','fileType','run','\x20Start\x20converting\x20to\x20SFDX.','1897644gtRGuQ','../../parsers/data/child-types','1fDYxJC','call','object','CommitComponentsJob','startTime','\x20Checking\x20commit\x20components.','copyProjectTo','718616xDiwqE','search','removeDir','__setModuleDefault','\x20Nothing\x20to\x20commit.\x20Skip.','decorate','replace','__importStar','log','../dto/commit-components.dto','../../internal/fs.internal','create','writed','sort','writeComponents','commitData','\x20components','hasOwnProperty','now','GitProvider','8ailXqs','copyMdapiTo','\x20Prepare\x20mdapi\x20files.','splice','prefix','SFDXUtils','commitAndPush','../../../shared/utils','\x20Checking\x20written\x20components.','GitUtils','defineProperty','Service','branch','send','isSFDXProject','path','master','push','prototype','1311220azrfuj','getProtocol','__esModule','componentsToDelete','default','fileName','\x20Preparing\x20to\x20delete\x20components','join','getOwnPropertyDescriptor','gitUtils','force-app','3566214uBFTRc','__decorate','../../providers/api/bitbucket-api.service','://','cleanUp','componentsToWrite','toString','length','provider','configurable','isLoggedIn','error'];a124_0x2759=function(){return _0x2df8ac;};return a124_0x2759();}(function(_0x319ed8,_0x12c796){const _0x278f10=a124_0x2cd4,_0x16e556=_0x319ed8();while(!![]){try{const _0x250d6b=parseInt(_0x278f10(0xf7))/0x1*(parseInt(_0x278f10(0xe5))/0x2)+-parseInt(_0x278f10(0xd3))/0x3*(-parseInt(_0x278f10(0x112))/0x4)+-parseInt(_0x278f10(0xb2))/0x5+parseInt(_0x278f10(0xe6))/0x6+parseInt(_0x278f10(0xf5))/0x7+-parseInt(_0x278f10(0xfe))/0x8+-parseInt(_0x278f10(0xbd))/0x9;if(_0x250d6b===_0x12c796)break;else _0x16e556['push'](_0x16e556['shift']());}catch(_0x5f3db8){_0x16e556['push'](_0x16e556['shift']());}}}(a124_0x2759,0x3109c));const a124_0x5aa2f8=(function(){let _0x3cde1=!![];return function(_0x12f5e0,_0x261840){const _0x1a2020=_0x3cde1?function(){const _0x26fb7a=a124_0x2cd4;if(_0x261840){const _0x5e48cd=_0x261840[_0x26fb7a(0xd7)](_0x12f5e0,arguments);return _0x261840=null,_0x5e48cd;}}:function(){};return _0x3cde1=![],_0x1a2020;};}()),a124_0x4e6460=a124_0x5aa2f8(this,function(){const _0x3a9e7a=a124_0x2cd4;return a124_0x4e6460['toString']()[_0x3a9e7a(0xff)]('(((.+)+)+)+$')[_0x3a9e7a(0xc3)]()['constructor'](a124_0x4e6460)[_0x3a9e7a(0xff)]('(((.+)+)+)+$');});a124_0x4e6460();function a124_0x2cd4(_0x5c09e7,_0x5c2141){const _0x13ab77=a124_0x2759();return a124_0x2cd4=function(_0x4e6460,_0x5aa2f8){_0x4e6460=_0x4e6460-0xae;let _0x2759ff=_0x13ab77[_0x4e6460];return _0x2759ff;},a124_0x2cd4(_0x5c09e7,_0x5c2141);}'use strict';var __createBinding=this&&this[a124_0x556362(0xd4)]||(Object['create']?function(_0x215520,_0x52c5c8,_0x42bfba,_0x2e954b){const _0x13a600=a124_0x556362;if(_0x2e954b===undefined)_0x2e954b=_0x42bfba;var _0x1706e3=Object[_0x13a600(0xba)](_0x52c5c8,_0x42bfba);(!_0x1706e3||(_0x13a600(0xe9)in _0x1706e3?!_0x52c5c8[_0x13a600(0xb4)]:_0x1706e3[_0x13a600(0xdf)]||_0x1706e3[_0x13a600(0xc6)]))&&(_0x1706e3={'enumerable':!![],'get':function(){return _0x52c5c8[_0x42bfba];}}),Object['defineProperty'](_0x215520,_0x2e954b,_0x1706e3);}:function(_0x2c26b7,_0x1f95e3,_0x59f33d,_0x52c569){if(_0x52c569===undefined)_0x52c569=_0x59f33d;_0x2c26b7[_0x52c569]=_0x1f95e3[_0x59f33d];}),__setModuleDefault=this&&this[a124_0x556362(0x101)]||(Object[a124_0x556362(0x109)]?function(_0x371793,_0x655bac){const _0x29c0f5=a124_0x556362;Object[_0x29c0f5(0x11c)](_0x371793,_0x29c0f5(0xb6),{'enumerable':!![],'value':_0x655bac});}:function(_0x44a6fd,_0x214771){const _0x54c4b6=a124_0x556362;_0x44a6fd[_0x54c4b6(0xb6)]=_0x214771;}),__decorate=this&&this[a124_0x556362(0xbe)]||function(_0x6d6d84,_0x1a9cb8,_0x161bea,_0x6eb723){const _0x308d39=a124_0x556362;var _0x284d27=arguments[_0x308d39(0xc4)],_0x32f147=_0x284d27<0x3?_0x1a9cb8:_0x6eb723===null?_0x6eb723=Object[_0x308d39(0xba)](_0x1a9cb8,_0x161bea):_0x6eb723,_0x4a9f23;if(typeof Reflect===_0x308d39(0xf9)&&typeof Reflect[_0x308d39(0x103)]==='function')_0x32f147=Reflect[_0x308d39(0x103)](_0x6d6d84,_0x1a9cb8,_0x161bea,_0x6eb723);else{for(var _0x498e9a=_0x6d6d84[_0x308d39(0xc4)]-0x1;_0x498e9a>=0x0;_0x498e9a--)if(_0x4a9f23=_0x6d6d84[_0x498e9a])_0x32f147=(_0x284d27<0x3?_0x4a9f23(_0x32f147):_0x284d27>0x3?_0x4a9f23(_0x1a9cb8,_0x161bea,_0x32f147):_0x4a9f23(_0x1a9cb8,_0x161bea))||_0x32f147;}return _0x284d27>0x3&&_0x32f147&&Object['defineProperty'](_0x1a9cb8,_0x161bea,_0x32f147),_0x32f147;},__importStar=this&&this[a124_0x556362(0x105)]||function(_0x5be85a){const _0x3d33fa=a124_0x556362;if(_0x5be85a&&_0x5be85a[_0x3d33fa(0xb4)])return _0x5be85a;var _0x3aa21a={};if(_0x5be85a!=null){for(var _0x58f94c in _0x5be85a)if(_0x58f94c!==_0x3d33fa(0xb6)&&Object[_0x3d33fa(0xb1)][_0x3d33fa(0x10f)][_0x3d33fa(0xf8)](_0x5be85a,_0x58f94c))__createBinding(_0x3aa21a,_0x5be85a,_0x58f94c);}return __setModuleDefault(_0x3aa21a,_0x5be85a),_0x3aa21a;},__importDefault=this&&this[a124_0x556362(0xd5)]||function(_0x2ca7d8){const _0x4b129b=a124_0x556362;return _0x2ca7d8&&_0x2ca7d8[_0x4b129b(0xb4)]?_0x2ca7d8:{'default':_0x2ca7d8};};Object[a124_0x556362(0x11c)](exports,'__esModule',{'value':!![]}),exports[a124_0x556362(0xfa)]=void 0x0;const commit_components_dto_1=require(a124_0x556362(0x107)),events_1=__importDefault(require('events')),git_utils_1=require(a124_0x556362(0xc9)),mdapi_utils_1=require(a124_0x556362(0xe7)),sfdx_utils_1=require(a124_0x556362(0xee)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a124_0x556362(0xf6))),utils_1=require(a124_0x556362(0x119)),constants_1=require('../../../../constants'),git_provider_1=require(a124_0x556362(0xef)),bitbucket_api_service_1=require(a124_0x556362(0xbf)),sfdx_utils_2=require('../../salesforce/utils/sfdx.utils'),fs_internal_1=require(a124_0x556362(0x108)),path_1=require(a124_0x556362(0xae)),providers_tokens_1=require('../../providers/providers.tokens'),constants_2=require('../../../../constants');let CommitComponentsJob=class CommitComponentsJob extends events_1[a124_0x556362(0xb6)]{constructor(){const _0x44d853=a124_0x556362;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x44d853(0xc2)]=0x0,this[_0x44d853(0xb5)]=0x0,this[_0x44d853(0xfb)]=Date[_0x44d853(0x110)]();}async['getRemote'](){const _0x3b4b9=a124_0x556362,{repo:_0x1e7a9b}=this['commitData'],_0x3c3402=typedi_1[_0x3b4b9(0xb6)][_0x3b4b9(0xe9)](providers_tokens_1[_0x3b4b9(0xcf)][_0x3b4b9(0xf0)]);if(this[_0x3b4b9(0x10d)][_0x3b4b9(0xc5)]===git_provider_1[_0x3b4b9(0x111)][_0x3b4b9(0xda)]){const _0x154807=typedi_1['default']['get'](bitbucket_api_service_1['BitbucketApiService']);await _0x154807[_0x3b4b9(0xc7)]();}return _0x1e7a9b['gitUrl'][_0x3b4b9(0x104)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x3b4b9(0xb3)])(_0x1e7a9b['gitUrl'])+_0x3b4b9(0xc0)+_0x3c3402[_0x3b4b9(0xed)]()+'@');}[a124_0x556362(0xdb)](_0x4111d1){const _0x58f483=a124_0x556362;var _0xb37b28;_0x4111d1[_0x58f483(0x10b)](_0xcb6486=>child_types_1[_0x58f483(0xb6)]['includes'](_0xcb6486[_0x58f483(0xf2)])?0x1:-0x1);const _0x19127d={};for(const _0x565e3e of _0x4111d1){_0x19127d[_0xb37b28=_0x565e3e['fileName']]||(_0x19127d[_0xb37b28]=[]),_0x19127d[_0x565e3e[_0x58f483(0xb7)]][_0x58f483(0xb0)](_0x565e3e);}return Object[_0x58f483(0xdc)](_0x19127d)['reduce']((_0x3c4b21,_0x122f7f)=>[..._0x3c4b21,..._0x122f7f],[]);}async['writeComponents'](_0x11b5a7){const _0x6b5aeb=a124_0x556362;_0x11b5a7=this['groupComponentsByFileName'](_0x11b5a7);let _0x1c4531=0x0;while(_0x11b5a7[_0x6b5aeb(0xc4)]){const _0x5cac92=_0x11b5a7['splice'](0x0,this[_0x6b5aeb(0xde)]);await this[_0x6b5aeb(0xcb)]['writeFlosumComponents'](_0x5cac92,{'skipChildErrors':this[_0x6b5aeb(0x10d)][_0x6b5aeb(0x11e)][_0x6b5aeb(0xdd)]===_0x6b5aeb(0xaf),'recordType':this['commitData'][_0x6b5aeb(0xd0)]}),_0x1c4531+=_0x5cac92['length'],this[_0x6b5aeb(0xce)][_0x6b5aeb(0x106)](this[_0x6b5aeb(0x116)]+'\x20Wrote\x20'+_0x1c4531+'/'+this[_0x6b5aeb(0xc2)]+_0x6b5aeb(0x10e)),await this['sfLogger'][_0x6b5aeb(0x11f)]();}}async['removeComponents'](_0x21a6c3){const _0x460919=a124_0x556362;_0x21a6c3[_0x460919(0x10b)](_0x3d75dd=>child_types_1[_0x460919(0xb6)]['includes'](_0x3d75dd[_0x460919(0xca)])?-0x1:0x1);let _0x2d2930=0x0;while(_0x21a6c3[_0x460919(0xc4)]){const _0x3f8ef2=_0x21a6c3[_0x460919(0x115)](0x0,this['COMPONENTS_PER_TICK']);await this[_0x460919(0xcb)][_0x460919(0xe1)](_0x3f8ef2,this['commitData'][_0x460919(0xd0)]),_0x2d2930+=_0x3f8ef2[_0x460919(0xc4)],this[_0x460919(0xce)][_0x460919(0x106)](this[_0x460919(0x116)]+_0x460919(0xcc)+_0x2d2930+'/'+this['componentsToDelete']+_0x460919(0x10e)),await this['sfLogger'][_0x460919(0x11f)]();}}async['cleanUp'](){const _0x4b25f4=a124_0x556362;this[_0x4b25f4(0xbb)]&&await this[_0x4b25f4(0xbb)][_0x4b25f4(0x100)]()[_0x4b25f4(0xe2)](()=>void 0x0),this[_0x4b25f4(0xcb)]&&await this[_0x4b25f4(0xcb)][_0x4b25f4(0x100)]()[_0x4b25f4(0xe2)](()=>void 0x0),this[_0x4b25f4(0xe8)]&&await this[_0x4b25f4(0xe8)]['removeDir']()[_0x4b25f4(0xe2)](()=>void 0x0);}async[a124_0x556362(0xd6)](){const _0x1efd3c=a124_0x556362,{repo:_0x3a283c,branch:_0x21f0b9,components:_0x28caad,convertToSFDX:_0x50a568,message:_0x27ab76,user:_0x1dc9b0}=this[_0x1efd3c(0x10d)];this['mdapiUtils']=new mdapi_utils_1[(_0x1efd3c(0xd1))](),this['gitUtils']=new git_utils_1[(_0x1efd3c(0x11b))](await this[_0x1efd3c(0xf1)]()),this[_0x1efd3c(0xe8)]=new sfdx_utils_1[(_0x1efd3c(0x117))]();let _0x129beb=_0x50a568&&this[_0x1efd3c(0xe8)]['isConvertToSfdx'](this[_0x1efd3c(0x10d)][_0x1efd3c(0xd0)]);try{await this[_0x1efd3c(0xce)][_0x1efd3c(0x106)](this['prefix']+_0x1efd3c(0xd8))[_0x1efd3c(0x11f)](),await this[_0x1efd3c(0xbb)][_0x1efd3c(0xec)](_0x21f0b9[_0x1efd3c(0xdd)],_0x3a283c[_0x1efd3c(0xdd)]);!this[_0x1efd3c(0x10d)]['force']?(this[_0x1efd3c(0xce)][_0x1efd3c(0x106)](this['prefix']+_0x1efd3c(0x114)),await this['mdapiUtils']['prepareMdapi'](this[_0x1efd3c(0xbb)][_0x1efd3c(0xcd)])):this[_0x1efd3c(0xce)]['log'](this[_0x1efd3c(0x116)]+'\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');await this[_0x1efd3c(0xce)]['log'](this[_0x1efd3c(0x116)]+_0x1efd3c(0x11a))[_0x1efd3c(0x11f)]();_0x28caad[_0x1efd3c(0x10a)]&&(this[_0x1efd3c(0xce)][_0x1efd3c(0x106)](this[_0x1efd3c(0x116)]+_0x1efd3c(0xe4)),this[_0x1efd3c(0xc2)]=_0x28caad[_0x1efd3c(0x10a)]['length'],await this[_0x1efd3c(0x10c)](_0x28caad['writed']),await this['sfLogger']['send']());await this['sfLogger']['log'](this[_0x1efd3c(0x116)]+_0x1efd3c(0xe3))[_0x1efd3c(0x11f)]();_0x28caad[_0x1efd3c(0xd9)]&&(this[_0x1efd3c(0xce)][_0x1efd3c(0x106)](this[_0x1efd3c(0x116)]+_0x1efd3c(0xb8)),this['componentsToDelete']=_0x28caad[_0x1efd3c(0xd9)][_0x1efd3c(0xc4)],await this[_0x1efd3c(0xe1)](_0x28caad[_0x1efd3c(0xd9)]),await this[_0x1efd3c(0xce)][_0x1efd3c(0x11f)]());await this[_0x1efd3c(0xce)][_0x1efd3c(0x11f)]();const _0x108ac0=await fs_internal_1['FS'][_0x1efd3c(0xd2)](this[_0x1efd3c(0xbb)][_0x1efd3c(0xcd)]);await sfdx_utils_2['SFDX'][_0x1efd3c(0x120)](this['gitUtils']['dir'])?(_0x129beb=!![],await fs_internal_1['FS'][_0x1efd3c(0x100)]((0x0,path_1['join'])(this['gitUtils'][_0x1efd3c(0xcd)],_0x1efd3c(0xbc)))):(_0x129beb&&(!_0x108ac0&&(_0x129beb=![])),await this[_0x1efd3c(0xbb)][_0x1efd3c(0xeb)]());_0x129beb?(await this[_0x1efd3c(0xce)][_0x1efd3c(0x106)](this['prefix']+_0x1efd3c(0xf4))['send'](),await this[_0x1efd3c(0xe8)]['createProjectFrom'](this['mdapiUtils']['dir']),await this[_0x1efd3c(0xe8)][_0x1efd3c(0xfd)](this[_0x1efd3c(0xbb)][_0x1efd3c(0xcd)],!_0x108ac0),await this[_0x1efd3c(0xe8)]['copySFDXIgnoredComponents'](this[_0x1efd3c(0xcb)][_0x1efd3c(0xcd)],(0x0,path_1[_0x1efd3c(0xb9)])(this[_0x1efd3c(0xbb)][_0x1efd3c(0xcd)],constants_2['FORCE_APP_DEFAULT_DIR'])),await this[_0x1efd3c(0xe8)][_0x1efd3c(0x100)]()):(await this[_0x1efd3c(0xce)][_0x1efd3c(0x106)](this[_0x1efd3c(0x116)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0x1efd3c(0x11f)](),await this[_0x1efd3c(0xcb)][_0x1efd3c(0x113)](this['gitUtils']['dir']));await this['sfLogger'][_0x1efd3c(0x106)](this[_0x1efd3c(0x116)]+'\x20Committing\x20and\x20pushing\x20source\x20to\x20git.')[_0x1efd3c(0x11f)](),await this['gitUtils'][_0x1efd3c(0x118)](_0x27ab76,{'email':constants_1[_0x1efd3c(0xe0)],'name':_0x1dc9b0[_0x1efd3c(0xdd)]},_0x21f0b9['name']),await this['gitUtils'][_0x1efd3c(0x100)](),await this['mdapiUtils'][_0x1efd3c(0x100)]();const _0x4338ed=this['componentsToWrite']+this[_0x1efd3c(0xb5)];await this[_0x1efd3c(0xce)][_0x1efd3c(0x106)](this['prefix']+'\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x1efd3c(0x110)]()-this[_0x1efd3c(0xfb)])+'ms.\x20Committed\x20components\x20-\x20'+_0x4338ed+'.')['send']();}catch(_0x12889c){await this[_0x1efd3c(0xc1)](),await this[_0x1efd3c(0xce)][_0x1efd3c(0xc8)](this[_0x1efd3c(0x116)]+'\x20'+_0x12889c)['send']();throw _0x12889c;}}async[a124_0x556362(0xf3)](_0x526c4c,_0x3e1b05){const _0x5ead54=a124_0x556362;var _0x142575,_0x59e914;this[_0x5ead54(0xce)]=typedi_1[_0x5ead54(0xb6)][_0x5ead54(0xe9)](providers_tokens_1[_0x5ead54(0xcf)]['logger']),this[_0x5ead54(0x116)]=(_0x3e1b05?_0x3e1b05+'\x20':'')+'['+commit_components_dto_1[_0x5ead54(0xea)][_0x5ead54(0xdd)]+']',await this[_0x5ead54(0xce)][_0x5ead54(0x106)](this[_0x5ead54(0x116)]+_0x5ead54(0xfc));const _0x572146=!!((_0x142575=_0x526c4c['components'])===null||_0x142575===void 0x0?void 0x0:_0x142575[_0x5ead54(0x10a)])||!!((_0x59e914=_0x526c4c['components'])===null||_0x59e914===void 0x0?void 0x0:_0x59e914[_0x5ead54(0xd9)]);if(!_0x572146){await this[_0x5ead54(0xce)][_0x5ead54(0x106)](this['prefix']+_0x5ead54(0x102))[_0x5ead54(0x11f)]();return;}this[_0x5ead54(0x10d)]=_0x526c4c,await this['exec']();}};CommitComponentsJob=__decorate([(0x0,typedi_1[a124_0x556362(0x11d)])({'transient':!![]})],CommitComponentsJob),exports[a124_0x556362(0xfa)]=CommitComponentsJob;