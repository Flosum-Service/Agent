const a121_0x216138=a121_0x53a0;(function(_0x308a67,_0x129e43){const _0x250086=a121_0x53a0,_0x419347=_0x308a67();while(!![]){try{const _0x34d498=parseInt(_0x250086(0x201))/0x1+-parseInt(_0x250086(0x1de))/0x2+-parseInt(_0x250086(0x232))/0x3+parseInt(_0x250086(0x1d7))/0x4+parseInt(_0x250086(0x1ce))/0x5*(parseInt(_0x250086(0x1ec))/0x6)+-parseInt(_0x250086(0x1f2))/0x7+-parseInt(_0x250086(0x1fb))/0x8;if(_0x34d498===_0x129e43)break;else _0x419347['push'](_0x419347['shift']());}catch(_0x489026){_0x419347['push'](_0x419347['shift']());}}}(a121_0x1026,0xdb3c1));const a121_0x488f85=(function(){let _0x38c4d4=!![];return function(_0x585a76,_0x21eb98){const _0x5c1195=_0x38c4d4?function(){const _0x560b6b=a121_0x53a0;if(_0x21eb98){const _0x152fc5=_0x21eb98[_0x560b6b(0x213)](_0x585a76,arguments);return _0x21eb98=null,_0x152fc5;}}:function(){};return _0x38c4d4=![],_0x5c1195;};}()),a121_0xfb134f=a121_0x488f85(this,function(){const _0x4f7599=a121_0x53a0;return a121_0xfb134f[_0x4f7599(0x1f8)]()[_0x4f7599(0x1d9)]('(((.+)+)+)+$')['toString']()[_0x4f7599(0x1f5)](a121_0xfb134f)[_0x4f7599(0x1d9)]('(((.+)+)+)+$');});a121_0xfb134f();'use strict';var __createBinding=this&&this[a121_0x216138(0x236)]||(Object[a121_0x216138(0x1fc)]?function(_0x4509c9,_0x2dafa5,_0x239d29,_0x3a81e5){const _0x3ad9e8=a121_0x216138;if(_0x3a81e5===undefined)_0x3a81e5=_0x239d29;var _0x4dc75f=Object[_0x3ad9e8(0x208)](_0x2dafa5,_0x239d29);(!_0x4dc75f||('get'in _0x4dc75f?!_0x2dafa5[_0x3ad9e8(0x1c3)]:_0x4dc75f[_0x3ad9e8(0x1cb)]||_0x4dc75f[_0x3ad9e8(0x1c4)]))&&(_0x4dc75f={'enumerable':!![],'get':function(){return _0x2dafa5[_0x239d29];}}),Object[_0x3ad9e8(0x1d5)](_0x4509c9,_0x3a81e5,_0x4dc75f);}:function(_0xdfc80,_0x4eaeea,_0x33cd2a,_0x3f1426){if(_0x3f1426===undefined)_0x3f1426=_0x33cd2a;_0xdfc80[_0x3f1426]=_0x4eaeea[_0x33cd2a];}),__setModuleDefault=this&&this[a121_0x216138(0x203)]||(Object[a121_0x216138(0x1fc)]?function(_0x599032,_0x48a381){const _0x202b8e=a121_0x216138;Object[_0x202b8e(0x1d5)](_0x599032,'default',{'enumerable':!![],'value':_0x48a381});}:function(_0xd99532,_0x32ce6e){const _0x6bc3ea=a121_0x216138;_0xd99532[_0x6bc3ea(0x1eb)]=_0x32ce6e;}),__decorate=this&&this[a121_0x216138(0x1d8)]||function(_0x4c3316,_0x3ca616,_0x15d92f,_0x6ba867){const _0x3c659e=a121_0x216138;var _0x47949f=arguments[_0x3c659e(0x223)],_0x236f22=_0x47949f<0x3?_0x3ca616:_0x6ba867===null?_0x6ba867=Object['getOwnPropertyDescriptor'](_0x3ca616,_0x15d92f):_0x6ba867,_0x2967b7;if(typeof Reflect===_0x3c659e(0x1cc)&&typeof Reflect[_0x3c659e(0x233)]==='function')_0x236f22=Reflect['decorate'](_0x4c3316,_0x3ca616,_0x15d92f,_0x6ba867);else{for(var _0x18b0ea=_0x4c3316['length']-0x1;_0x18b0ea>=0x0;_0x18b0ea--)if(_0x2967b7=_0x4c3316[_0x18b0ea])_0x236f22=(_0x47949f<0x3?_0x2967b7(_0x236f22):_0x47949f>0x3?_0x2967b7(_0x3ca616,_0x15d92f,_0x236f22):_0x2967b7(_0x3ca616,_0x15d92f))||_0x236f22;}return _0x47949f>0x3&&_0x236f22&&Object[_0x3c659e(0x1d5)](_0x3ca616,_0x15d92f,_0x236f22),_0x236f22;},__importStar=this&&this[a121_0x216138(0x1e5)]||function(_0x210c93){const _0x4ba9bc=a121_0x216138;if(_0x210c93&&_0x210c93[_0x4ba9bc(0x1c3)])return _0x210c93;var _0x3bd256={};if(_0x210c93!=null){for(var _0x48f3e9 in _0x210c93)if(_0x48f3e9!==_0x4ba9bc(0x1eb)&&Object[_0x4ba9bc(0x209)]['hasOwnProperty'][_0x4ba9bc(0x1f9)](_0x210c93,_0x48f3e9))__createBinding(_0x3bd256,_0x210c93,_0x48f3e9);}return __setModuleDefault(_0x3bd256,_0x210c93),_0x3bd256;},__importDefault=this&&this[a121_0x216138(0x1e3)]||function(_0x22bee5){const _0x25759d=a121_0x216138;return _0x22bee5&&_0x22bee5[_0x25759d(0x1c3)]?_0x22bee5:{'default':_0x22bee5};};Object[a121_0x216138(0x1d5)](exports,a121_0x216138(0x1c3),{'value':!![]}),exports[a121_0x216138(0x234)]=void 0x0;function a121_0x1026(){const _0x544234=['copySFDXIgnoredComponents','DEFAULT_GIT_USER_EMAIL','createProjectFrom','11718112moaNGm','isEmptyDir','gitUtils','constructor','gitUrl','writed','toString','call','now','1168176CMdhhh','create','commitAndPush','startTime','sfLogger','getGitShellAuthorizationString','1769096VdLcWq','../../../../constants','__setModuleDefault','exec','fileName','\x20Start\x20cloning\x20repository.','\x20Checking\x20deleted\x20components.','getOwnPropertyDescriptor','prototype','logger','\x20Checking\x20commit\x20components.','sort','writeFlosumComponents','Tokens','CommitComponentsDto','catch','\x20Checking\x20written\x20components.','Bitbucket','apply','force','deleted','force-app','\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','commitData','send','../../parsers/data/child-types','mdapiUtils','splice','copyProjectTo','replace','componentsToWrite','../../salesforce/utils/sfdx.utils','\x20Nothing\x20to\x20commit.\x20Skip.','join','length','SFDXUtils','writeComponents','error','reduce','includes','cleanUp','MDApiUtils','clone','prefix','dir','../../providers/providers.tokens','prepareMdapi','sfdxUtils','COMPONENTS_PER_TICK','3069876LeChWn','decorate','CommitComponentsJob','credentials','__createBinding','type','\x20Wrote\x20','\x20Committing\x20and\x20pushing\x20source\x20to\x20git.','GitProvider','__esModule','configurable','../utils/git.utils','\x20Start\x20converting\x20to\x20SFDX.','../utils/sfdx.utils','../../providers/api/bitbucket-api.service','recordType','://','writable','object','path','10OeEqID','run','isSFDXProject','fileType','provider','name','clearDir','defineProperty','isLoggedIn','6386576YSsJLo','__decorate','search','removeComponents','master','values','get','1064158aQffZI','\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20','componentsToDelete','copyMdapiTo','getRemote','__importDefault','getProtocol','__importStar','removeDir','push','components','ms.\x20Committed\x20components\x20-\x20','log','default','2722962XwHXfJ','../../internal/fs.internal','groupComponentsByFileName'];a121_0x1026=function(){return _0x544234;};return a121_0x1026();}const commit_components_dto_1=require('../dto/commit-components.dto'),events_1=__importDefault(require('events')),git_utils_1=require(a121_0x216138(0x1c5)),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a121_0x216138(0x1c7)),typedi_1=__importStar(require('typedi')),child_types_1=__importDefault(require(a121_0x216138(0x21a))),utils_1=require('../../../shared/utils'),constants_1=require(a121_0x216138(0x202)),git_provider_1=require('../../providers/types/git-provider'),bitbucket_api_service_1=require(a121_0x216138(0x1c8)),sfdx_utils_2=require(a121_0x216138(0x220)),fs_internal_1=require(a121_0x216138(0x1ed)),path_1=require(a121_0x216138(0x1cd)),providers_tokens_1=require(a121_0x216138(0x22e)),constants_2=require(a121_0x216138(0x202));function a121_0x53a0(_0x5b1db0,_0x15efb9){const _0x4b8f50=a121_0x1026();return a121_0x53a0=function(_0xfb134f,_0x488f85){_0xfb134f=_0xfb134f-0x1c2;let _0x102668=_0x4b8f50[_0xfb134f];return _0x102668;},a121_0x53a0(_0x5b1db0,_0x15efb9);}let CommitComponentsJob=class CommitComponentsJob extends events_1['default']{constructor(){const _0x33a891=a121_0x216138;super(...arguments),this['COMPONENTS_PER_TICK']=0x3e8,this[_0x33a891(0x21f)]=0x0,this[_0x33a891(0x1e0)]=0x0,this[_0x33a891(0x1fe)]=Date[_0x33a891(0x1fa)]();}async[a121_0x216138(0x1e2)](){const _0x4afa6e=a121_0x216138,{repo:_0xa33f4f}=this[_0x4afa6e(0x218)],_0x36ce75=typedi_1[_0x4afa6e(0x1eb)][_0x4afa6e(0x1dd)](providers_tokens_1[_0x4afa6e(0x20e)][_0x4afa6e(0x235)]);if(this['commitData'][_0x4afa6e(0x1d2)]===git_provider_1[_0x4afa6e(0x1c2)][_0x4afa6e(0x212)]){const _0x2cc73f=typedi_1['default'][_0x4afa6e(0x1dd)](bitbucket_api_service_1['BitbucketApiService']);await _0x2cc73f[_0x4afa6e(0x1d6)]();}return _0xa33f4f['gitUrl'][_0x4afa6e(0x21e)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x4afa6e(0x1e4)])(_0xa33f4f[_0x4afa6e(0x1f6)])+_0x4afa6e(0x1ca)+_0x36ce75[_0x4afa6e(0x200)]()+'@');}[a121_0x216138(0x1ee)](_0x579413){const _0x4f0d00=a121_0x216138;var _0x333ba9;_0x579413[_0x4f0d00(0x20c)](_0x3c7b5a=>child_types_1[_0x4f0d00(0x1eb)][_0x4f0d00(0x228)](_0x3c7b5a[_0x4f0d00(0x1d1)])?0x1:-0x1);const _0x580aed={};for(const _0x1342d0 of _0x579413){_0x580aed[_0x333ba9=_0x1342d0[_0x4f0d00(0x205)]]||(_0x580aed[_0x333ba9]=[]),_0x580aed[_0x1342d0[_0x4f0d00(0x205)]][_0x4f0d00(0x1e7)](_0x1342d0);}return Object[_0x4f0d00(0x1dc)](_0x580aed)[_0x4f0d00(0x227)]((_0x3baf81,_0x34d345)=>[..._0x3baf81,..._0x34d345],[]);}async[a121_0x216138(0x225)](_0x2d0097){const _0x4e57e7=a121_0x216138;_0x2d0097=this[_0x4e57e7(0x1ee)](_0x2d0097);let _0x2fcc8c=0x0;while(_0x2d0097['length']){const _0x4f2b3e=_0x2d0097[_0x4e57e7(0x21c)](0x0,this[_0x4e57e7(0x231)]);await this[_0x4e57e7(0x21b)][_0x4e57e7(0x20d)](_0x4f2b3e,{'skipChildErrors':this[_0x4e57e7(0x218)]['branch'][_0x4e57e7(0x1d3)]===_0x4e57e7(0x1db),'recordType':this['commitData'][_0x4e57e7(0x1c9)]}),_0x2fcc8c+=_0x4f2b3e[_0x4e57e7(0x223)],this['sfLogger'][_0x4e57e7(0x1ea)](this[_0x4e57e7(0x22c)]+_0x4e57e7(0x238)+_0x2fcc8c+'/'+this[_0x4e57e7(0x21f)]+'\x20components'),await this['sfLogger']['send']();}}async['removeComponents'](_0x1d1ea7){const _0x7b9f20=a121_0x216138;_0x1d1ea7['sort'](_0xfe7339=>child_types_1['default']['includes'](_0xfe7339[_0x7b9f20(0x237)])?-0x1:0x1);let _0x2b3968=0x0;while(_0x1d1ea7[_0x7b9f20(0x223)]){const _0xd26888=_0x1d1ea7[_0x7b9f20(0x21c)](0x0,this[_0x7b9f20(0x231)]);await this[_0x7b9f20(0x21b)][_0x7b9f20(0x1da)](_0xd26888,this['commitData'][_0x7b9f20(0x1c9)]),_0x2b3968+=_0xd26888[_0x7b9f20(0x223)],this[_0x7b9f20(0x1ff)][_0x7b9f20(0x1ea)](this['prefix']+'\x20Deleted\x20'+_0x2b3968+'/'+this[_0x7b9f20(0x1e0)]+'\x20components'),await this[_0x7b9f20(0x1ff)][_0x7b9f20(0x219)]();}}async[a121_0x216138(0x229)](){const _0x4eacdf=a121_0x216138;this[_0x4eacdf(0x1f4)]&&await this[_0x4eacdf(0x1f4)][_0x4eacdf(0x1e6)]()[_0x4eacdf(0x210)](()=>void 0x0),this[_0x4eacdf(0x21b)]&&await this['mdapiUtils'][_0x4eacdf(0x1e6)]()[_0x4eacdf(0x210)](()=>void 0x0),this[_0x4eacdf(0x230)]&&await this['sfdxUtils']['removeDir']()[_0x4eacdf(0x210)](()=>void 0x0);}async[a121_0x216138(0x204)](){const _0xc133d9=a121_0x216138,{repo:_0x1cd4bd,branch:_0x463bf8,components:_0x177c6f,convertToSFDX:_0x194b0e,message:_0x1c856a,user:_0x2a1677}=this[_0xc133d9(0x218)];this[_0xc133d9(0x21b)]=new mdapi_utils_1[(_0xc133d9(0x22a))](),this[_0xc133d9(0x1f4)]=new git_utils_1['GitUtils'](await this[_0xc133d9(0x1e2)]()),this[_0xc133d9(0x230)]=new sfdx_utils_1[(_0xc133d9(0x224))]();let _0x5648f7=_0x194b0e&&this[_0xc133d9(0x230)]['isConvertToSfdx'](this['commitData'][_0xc133d9(0x1c9)]);try{await this['sfLogger']['log'](this['prefix']+_0xc133d9(0x206))[_0xc133d9(0x219)](),await this[_0xc133d9(0x1f4)][_0xc133d9(0x22b)](_0x463bf8[_0xc133d9(0x1d3)],_0x1cd4bd[_0xc133d9(0x1d3)]);!this[_0xc133d9(0x218)][_0xc133d9(0x214)]?(this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this[_0xc133d9(0x22c)]+'\x20Prepare\x20mdapi\x20files.'),await this['mdapiUtils'][_0xc133d9(0x22f)](this['gitUtils'][_0xc133d9(0x22d)])):this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this[_0xc133d9(0x22c)]+_0xc133d9(0x217));await this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this[_0xc133d9(0x22c)]+_0xc133d9(0x211))[_0xc133d9(0x219)]();_0x177c6f[_0xc133d9(0x1f7)]&&(this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this['prefix']+'\x20Preparing\x20to\x20write\x20components'),this[_0xc133d9(0x21f)]=_0x177c6f['writed']['length'],await this[_0xc133d9(0x225)](_0x177c6f['writed']),await this[_0xc133d9(0x1ff)][_0xc133d9(0x219)]());await this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this[_0xc133d9(0x22c)]+_0xc133d9(0x207))[_0xc133d9(0x219)]();_0x177c6f[_0xc133d9(0x215)]&&(this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this[_0xc133d9(0x22c)]+'\x20Preparing\x20to\x20delete\x20components'),this['componentsToDelete']=_0x177c6f[_0xc133d9(0x215)][_0xc133d9(0x223)],await this[_0xc133d9(0x1da)](_0x177c6f[_0xc133d9(0x215)]),await this[_0xc133d9(0x1ff)][_0xc133d9(0x219)]());await this[_0xc133d9(0x1ff)][_0xc133d9(0x219)]();const _0x3e77b6=await fs_internal_1['FS'][_0xc133d9(0x1f3)](this['gitUtils'][_0xc133d9(0x22d)]);await sfdx_utils_2['SFDX'][_0xc133d9(0x1d0)](this[_0xc133d9(0x1f4)][_0xc133d9(0x22d)])?(_0x5648f7=!![],await fs_internal_1['FS'][_0xc133d9(0x1e6)]((0x0,path_1['join'])(this[_0xc133d9(0x1f4)][_0xc133d9(0x22d)],_0xc133d9(0x216)))):(_0x5648f7&&(!_0x3e77b6&&(_0x5648f7=![])),await this[_0xc133d9(0x1f4)][_0xc133d9(0x1d4)]());_0x5648f7?(await this['sfLogger'][_0xc133d9(0x1ea)](this['prefix']+_0xc133d9(0x1c6))[_0xc133d9(0x219)](),await this[_0xc133d9(0x230)][_0xc133d9(0x1f1)](this[_0xc133d9(0x21b)][_0xc133d9(0x22d)]),await this[_0xc133d9(0x230)][_0xc133d9(0x21d)](this['gitUtils']['dir'],!_0x3e77b6),await this[_0xc133d9(0x230)][_0xc133d9(0x1ef)](this['mdapiUtils'][_0xc133d9(0x22d)],(0x0,path_1[_0xc133d9(0x222)])(this['gitUtils'][_0xc133d9(0x22d)],constants_2['FORCE_APP_DEFAULT_DIR'])),await this['sfdxUtils'][_0xc133d9(0x1e6)]()):(await this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this[_0xc133d9(0x22c)]+'\x20Copying\x20mdapi\x20to\x20git\x20folder.')[_0xc133d9(0x219)](),await this[_0xc133d9(0x21b)][_0xc133d9(0x1e1)](this[_0xc133d9(0x1f4)][_0xc133d9(0x22d)]));await this[_0xc133d9(0x1ff)]['log'](this['prefix']+_0xc133d9(0x239))[_0xc133d9(0x219)](),await this['gitUtils'][_0xc133d9(0x1fd)](_0x1c856a,{'email':constants_1[_0xc133d9(0x1f0)],'name':_0x2a1677[_0xc133d9(0x1d3)]},_0x463bf8[_0xc133d9(0x1d3)]),await this[_0xc133d9(0x1f4)][_0xc133d9(0x1e6)](),await this[_0xc133d9(0x21b)]['removeDir']();const _0x59a844=this[_0xc133d9(0x21f)]+this[_0xc133d9(0x1e0)];await this[_0xc133d9(0x1ff)][_0xc133d9(0x1ea)](this[_0xc133d9(0x22c)]+_0xc133d9(0x1df)+(Date[_0xc133d9(0x1fa)]()-this['startTime'])+_0xc133d9(0x1e9)+_0x59a844+'.')[_0xc133d9(0x219)]();}catch(_0x233b18){await this[_0xc133d9(0x229)](),await this[_0xc133d9(0x1ff)][_0xc133d9(0x226)](this[_0xc133d9(0x22c)]+'\x20'+_0x233b18)['send']();throw _0x233b18;}}async[a121_0x216138(0x1cf)](_0x2969ce,_0x48f04c){const _0xc5fd8b=a121_0x216138;var _0x58da8b,_0x238ed2;this[_0xc5fd8b(0x1ff)]=typedi_1[_0xc5fd8b(0x1eb)][_0xc5fd8b(0x1dd)](providers_tokens_1[_0xc5fd8b(0x20e)][_0xc5fd8b(0x20a)]),this[_0xc5fd8b(0x22c)]=(_0x48f04c?_0x48f04c+'\x20':'')+'['+commit_components_dto_1[_0xc5fd8b(0x20f)][_0xc5fd8b(0x1d3)]+']',await this[_0xc5fd8b(0x1ff)][_0xc5fd8b(0x1ea)](this[_0xc5fd8b(0x22c)]+_0xc5fd8b(0x20b));const _0x2e7469=!!((_0x58da8b=_0x2969ce[_0xc5fd8b(0x1e8)])===null||_0x58da8b===void 0x0?void 0x0:_0x58da8b[_0xc5fd8b(0x1f7)])||!!((_0x238ed2=_0x2969ce[_0xc5fd8b(0x1e8)])===null||_0x238ed2===void 0x0?void 0x0:_0x238ed2[_0xc5fd8b(0x215)]);if(!_0x2e7469){await this[_0xc5fd8b(0x1ff)][_0xc5fd8b(0x1ea)](this[_0xc5fd8b(0x22c)]+_0xc5fd8b(0x221))[_0xc5fd8b(0x219)]();return;}this['commitData']=_0x2969ce,await this[_0xc5fd8b(0x204)]();}};CommitComponentsJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]})],CommitComponentsJob),exports[a121_0x216138(0x234)]=CommitComponentsJob;