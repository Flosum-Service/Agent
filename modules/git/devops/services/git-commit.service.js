const a112_0x107dc2=a112_0x4ae1;(function(_0x521f62,_0x4963f8){const _0x51738b=a112_0x4ae1,_0xa21951=_0x521f62();while(!![]){try{const _0x4ff6fb=parseInt(_0x51738b(0x9e))/0x1*(parseInt(_0x51738b(0xa3))/0x2)+parseInt(_0x51738b(0xd1))/0x3+-parseInt(_0x51738b(0x9d))/0x4+-parseInt(_0x51738b(0x90))/0x5+-parseInt(_0x51738b(0xa5))/0x6+parseInt(_0x51738b(0xd2))/0x7*(parseInt(_0x51738b(0xcd))/0x8)+parseInt(_0x51738b(0xb3))/0x9;if(_0x4ff6fb===_0x4963f8)break;else _0xa21951['push'](_0xa21951['shift']());}catch(_0x5e9620){_0xa21951['push'](_0xa21951['shift']());}}}(a112_0x3e2c,0x53316));function a112_0x4ae1(_0x5bbcc9,_0x3ddc80){const _0x4ec59d=a112_0x3e2c();return a112_0x4ae1=function(_0x534333,_0x548aa9){_0x534333=_0x534333-0x84;let _0x3e2c82=_0x4ec59d[_0x534333];return _0x3e2c82;},a112_0x4ae1(_0x5bbcc9,_0x3ddc80);}const a112_0x548aa9=(function(){let _0x3b797f=!![];return function(_0x5511f6,_0x921820){const _0xa8dc7a=_0x3b797f?function(){const _0x33e015=a112_0x4ae1;if(_0x921820){const _0x1dd0a5=_0x921820[_0x33e015(0x93)](_0x5511f6,arguments);return _0x921820=null,_0x1dd0a5;}}:function(){};return _0x3b797f=![],_0xa8dc7a;};}()),a112_0x534333=a112_0x548aa9(this,function(){const _0x4b927a=a112_0x4ae1;return a112_0x534333[_0x4b927a(0xd3)]()[_0x4b927a(0x91)](_0x4b927a(0xa2))[_0x4b927a(0xd3)]()[_0x4b927a(0xbb)](a112_0x534333)['search']('(((.+)+)+)+$');});a112_0x534333();'use strict';var __decorate=this&&this[a112_0x107dc2(0xba)]||function(_0x2eb8a1,_0x1b7f43,_0xac870,_0x300fbb){const _0x1fbfb6=a112_0x107dc2;var _0x4ced26=arguments[_0x1fbfb6(0xac)],_0x15f791=_0x4ced26<0x3?_0x1b7f43:_0x300fbb===null?_0x300fbb=Object['getOwnPropertyDescriptor'](_0x1b7f43,_0xac870):_0x300fbb,_0x1a660a;if(typeof Reflect===_0x1fbfb6(0xbc)&&typeof Reflect[_0x1fbfb6(0xbd)]==='function')_0x15f791=Reflect['decorate'](_0x2eb8a1,_0x1b7f43,_0xac870,_0x300fbb);else{for(var _0x5cd98d=_0x2eb8a1[_0x1fbfb6(0xac)]-0x1;_0x5cd98d>=0x0;_0x5cd98d--)if(_0x1a660a=_0x2eb8a1[_0x5cd98d])_0x15f791=(_0x4ced26<0x3?_0x1a660a(_0x15f791):_0x4ced26>0x3?_0x1a660a(_0x1b7f43,_0xac870,_0x15f791):_0x1a660a(_0x1b7f43,_0xac870))||_0x15f791;}return _0x4ced26>0x3&&_0x15f791&&Object[_0x1fbfb6(0xb8)](_0x1b7f43,_0xac870,_0x15f791),_0x15f791;},__metadata=this&&this[a112_0x107dc2(0x8d)]||function(_0x3cea6c,_0x29aacb){const _0x388204=a112_0x107dc2;if(typeof Reflect===_0x388204(0xbc)&&typeof Reflect[_0x388204(0xb1)]===_0x388204(0x89))return Reflect[_0x388204(0xb1)](_0x3cea6c,_0x29aacb);};Object[a112_0x107dc2(0xb8)](exports,a112_0x107dc2(0x85),{'value':!![]}),exports['GitCommitService']=void 0x0;const constants_1=require(a112_0x107dc2(0x98)),salesforce_git_sync_service_1=require('../../salesforce/services/salesforce-git-sync.service'),salesforce_rest_service_1=require(a112_0x107dc2(0xa4)),typedi_1=require('typedi'),salesforce_sync_service_1=require(a112_0x107dc2(0xca)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),factory_parser_1=require(a112_0x107dc2(0x92)),path_utils_1=require(a112_0x107dc2(0xc4)),components_utils_1=require('../utils/components.utils');function a112_0x3e2c(){const _0x4891fa=['../../parsers/factory.parser','apply','fetchBranchComponentsByFilenames','filterMetadataComponents','repositoryGit','FLOSUM_NAMESPACE','../../../../constants','salesforce','execute','getBranchRecordByName','salesforceRest','2675624DMUyeP','1pvUzfy','componentsMetadata','getRecordTypes','name','(((.+)+)+)+$','395972YVyvxq','../../salesforce/services/salesforce-rest.service','1919178XzNzaS','force','updateRemoteState','FLOSUM_BRANCH','Service','salesforceGitSync','type','length','readComponentPaths','PathUtils','syncRecord','recordTypes','metadata','getRemoteStateAttachmentId','7977672gepAXt','repositoryId','FLOSUM_GIT_NAMESPACE','lastCommit','Synchronization_Status__c','defineProperty','string','__decorate','constructor','object','decorate','push','find','indexOf','recordTypeName','splice','fetchBranchComponents','../utils/path.utils','branch','ComponentsUtils','SalesforceGitSyncService','proceedFile','getComponentRecordTypes','../../salesforce/services/salesforce-sync.service','create','SalesforceRestService','239152SgRern','now','catch','TASKS_PER_TICK','1097934qXpiWh','105cyHeuH','toString','setCommitDto','SalesforceSyncService','parse','createCommit','getRepositoryId','retrieveAttachment','branchId','GitCommitService','__esModule','Last_Updated_On__c','FLOSUM_REPOSITORY','salesforceSync','function','getBranchId','map','fetchComponentsMetadata','__metadata','gitCommit','patch','2846275drBbWK','search'];a112_0x3e2c=function(){return _0x4891fa;};return a112_0x3e2c();}let GitCommitService=class GitCommitService{constructor(_0x18ff51,_0x55b04a,_0x553297,_0x5c670e){const _0x2b303c=a112_0x107dc2;this[_0x2b303c(0xaa)]=_0x18ff51,this[_0x2b303c(0x9c)]=_0x55b04a,this[_0x2b303c(0x88)]=_0x553297,this[_0x2b303c(0x99)]=_0x5c670e,this[_0x2b303c(0xd0)]=0xc8;}get[a112_0x107dc2(0xb4)](){const _0x4dca9d=a112_0x107dc2;var _0x3fa3f8;return((_0x3fa3f8=this[_0x4dca9d(0xaf)])===null||_0x3fa3f8===void 0x0?void 0x0:_0x3fa3f8[_0x4dca9d(0xb4)])||'';}get['branchId'](){const _0x3de36f=a112_0x107dc2;var _0x1d31a2;return((_0x1d31a2=this[_0x3de36f(0xaf)])===null||_0x1d31a2===void 0x0?void 0x0:_0x1d31a2['branchId'])||'';}get['recordType'](){const _0x3f7b73=a112_0x107dc2;return this['syncRecord'][_0x3f7b73(0xc1)];}async[a112_0x107dc2(0xd7)](_0x4f53cb){return this['salesforceGitSync']['createCommit'](_0x4f53cb,this['repositoryId']);}async['checkSyncStatus'](_0x3c1ffd){const _0x578209=a112_0x107dc2;if(this[_0x578209(0xaf)]){const _0x2c9990=await this[_0x578209(0x88)][_0x578209(0xb2)](this['syncRecord']),_0x25c7ac=await this[_0x578209(0x99)][_0x578209(0xd9)](_0x2c9990)['then'](_0x573db0=>typeof _0x573db0===_0x578209(0xb9)?JSON[_0x578209(0xd6)](_0x573db0):_0x573db0)[_0x578209(0xcf)](()=>({}));if(_0x25c7ac[this['gitCommit'][_0x578209(0x96)]]){if(_0x25c7ac[this[_0x578209(0x8e)][_0x578209(0x96)]][_0x578209(0xb6)]===_0x3c1ffd)return!![];}return![];}return![];}async['updateRemoteState'](_0xa1879b){const _0x64c630=a112_0x107dc2;this['syncRecord']&&await this['salesforceSync'][_0x64c630(0xa7)](this[_0x64c630(0xaf)],_0xa1879b);}['getUnusedComponentsFilePaths'](){const _0x4d750b=a112_0x107dc2;return this['componentsMetadata'][_0x4d750b(0x8b)](({fileName:_0x3bbb6f})=>_0x3bbb6f);}async[a112_0x107dc2(0xc8)](_0x2fab65,_0xd48f38,_0x24f82c){const _0x3ca767=a112_0x107dc2,_0x10453a=await path_utils_1[_0x3ca767(0xae)][_0x3ca767(0xad)](this['syncRecord'][_0x3ca767(0xc1)],_0x2fab65,_0xd48f38,_0x24f82c),_0x4b6beb=components_utils_1['ComponentsUtils'][_0x3ca767(0x95)](this[_0x3ca767(0x9f)],_0x2fab65,_0x24f82c,this[_0x3ca767(0xaf)][_0x3ca767(0xc1)]),_0x370c8a=factory_parser_1['FactoryParser'][_0x3ca767(0xcb)]({'recordType':this[_0x3ca767(0xaf)][_0x3ca767(0xc1)],'sourceDir':_0xd48f38,'paths':_0x10453a}),_0x392301=await _0x370c8a[_0x3ca767(0x9a)](),_0x55f7f5=[],_0x205ee3=[];for(const _0x5810e8 of _0x392301){const _0x466c3f=_0x4b6beb[_0x3ca767(0xbf)](_0x1a806c=>_0x1a806c['name']===_0x5810e8[_0x3ca767(0xa1)]&&_0x1a806c[_0x3ca767(0xab)]===_0x5810e8[_0x3ca767(0xab)]);if(!_0x466c3f){_0x55f7f5[_0x3ca767(0xbe)](_0x5810e8);continue;}_0x5810e8['crc']!==_0x466c3f['crc32']&&_0x205ee3['push']({'meta':_0x466c3f,'component':_0x5810e8}),_0x4b6beb[_0x3ca767(0xc2)](_0x4b6beb[_0x3ca767(0xc0)](_0x466c3f),0x1);}return{'inserted':_0x55f7f5,'modified':_0x205ee3,'removed':_0x4b6beb};}async['fetchRepositoryOrBranchData'](){const _0x52c6d6=a112_0x107dc2;this[_0x52c6d6(0xaf)]=this[_0x52c6d6(0x8e)][_0x52c6d6(0xc5)]==='master'?await this[_0x52c6d6(0x88)]['getRepositoryRecordByName'](this[_0x52c6d6(0x8e)]['repository']):await this[_0x52c6d6(0x88)][_0x52c6d6(0x9b)](this['gitCommit'][_0x52c6d6(0xc5)]),this['recordTypes']=await this[_0x52c6d6(0xaa)][_0x52c6d6(0xc9)]();}async[a112_0x107dc2(0x8c)](_0x5c49e1){const _0x627ee3=a112_0x107dc2;if(this[_0x627ee3(0x8e)][_0x627ee3(0xa6)]||_0x5c49e1){this[_0x627ee3(0x9f)]=this[_0x627ee3(0xda)]?await this['salesforceGitSync'][_0x627ee3(0xc3)](this[_0x627ee3(0xda)]):await this[_0x627ee3(0xaa)]['fetchRepositoryComponents'](this['repositoryId']);return;}const _0x3a38a3=components_utils_1[_0x627ee3(0xc6)]['prepareComponentNamesForFetchMetadata'](this['gitCommit']['fileNames'],this[_0x627ee3(0xaf)][_0x627ee3(0xc1)]);this[_0x627ee3(0x9f)]=[];while(_0x3a38a3[_0x627ee3(0xac)]){const _0x4f04b5=_0x3a38a3[_0x627ee3(0xc2)](0x0,this[_0x627ee3(0xd0)]),_0x3c484b=this[_0x627ee3(0xda)]?await this[_0x627ee3(0xaa)][_0x627ee3(0x94)](_0x4f04b5,this[_0x627ee3(0xda)]):await this[_0x627ee3(0xaa)]['fetchRepositoryComponentsByFilenames'](_0x4f04b5,this[_0x627ee3(0xb4)]);this[_0x627ee3(0x9f)]['push'](..._0x3c484b);}}async['updateStatus'](_0x20f5d0){const _0x429b78=a112_0x107dc2;this[_0x429b78(0xda)]?await this['salesforceRest']['patch'](constants_1[_0x429b78(0xa8)],this[_0x429b78(0xda)],{[constants_1[_0x429b78(0xb5)]+_0x429b78(0xb7)]:_0x20f5d0,[constants_1[_0x429b78(0x97)]+_0x429b78(0x86)]:Date[_0x429b78(0xce)]()}):await this[_0x429b78(0x9c)][_0x429b78(0x8f)](constants_1[_0x429b78(0x87)],this['repositoryId'],{[constants_1['FLOSUM_GIT_NAMESPACE']+'Synchronization_Status__c']:_0x20f5d0});}[a112_0x107dc2(0xd4)](_0x5cad32){const _0x3a28e9=a112_0x107dc2;this[_0x3a28e9(0x8e)]=_0x5cad32;}[a112_0x107dc2(0xa0)](){const _0x42c0ef=a112_0x107dc2;return this[_0x42c0ef(0xb0)];}[a112_0x107dc2(0xd8)](){const _0x32c644=a112_0x107dc2;return this[_0x32c644(0xb4)];}[a112_0x107dc2(0x8a)](){return this['branchId'];}};GitCommitService=__decorate([(0x0,typedi_1[a112_0x107dc2(0xa9)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_git_sync_service_1[a112_0x107dc2(0xc7)],salesforce_rest_service_1[a112_0x107dc2(0xcc)],salesforce_sync_service_1[a112_0x107dc2(0xd5)],salesforce_service_1['SalesforceService']])],GitCommitService),exports[a112_0x107dc2(0x84)]=GitCommitService;