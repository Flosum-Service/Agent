const a109_0x6e0081=a109_0x5954;function a109_0x48fd(){const _0x5c1a28=['branchId','getBranchId','../../salesforce/services/salesforce.service','find','parse','fetchBranchComponents','salesforceGitSync','match','toString','map','1289658klmhPE','../../parsers/utils','recordTypes','lastCommit','catch','filter','([./-]{1}|$)','design:paramtypes','FLOSUM_REPOSITORY','proceedFile','getRepositoryRecordByName','TASKS_PER_TICK','9ObREzX','filterParserPaths','__esModule','repositoryGit','Service','crc32','getComponentRecordTypes','1552406jXuAVR','../../salesforce/services/salesforce-git-sync.service','updateRemoteState','SalesforceRestService','push','type','18200380qNXaAt','decorate','apply','length','getOwnPropertyDescriptor','string','752668EKAZfG','128mkrdQm','10596636PlhtKG','../../salesforce/services/salesforce-sync.service','SalesforceService','splice','indexOf','then','setCommitDto','FLOSUM_BRANCH','patch','typedi','getRepositoryId','getRecordTypes','3274508vmHMCV','SalesforceSyncService','3QsaMDz','fetchRepositoryComponents','defineProperty','branch','replace','syncRecord','salesforceRest','salesforceSync','updateStatus','getBranchRecordByName','search','META_XML_EXTENSION','GitCommitService','repository','fetchComponentsMetadata','repositoryId','(((.+)+)+)+$','../../parsers/mdapi/parser-v2','FLOSUM_GIT_NAMESPACE','../../../../constants','gitCommit','Synchronization_Status__c','getUnusedComponentsFilePaths','metadata','function','fetchRepositoryOrBranchData','salesforce','retrieveAttachment','createCommit','force','name','componentsMetadata','4225390EfGiRT','fileName'];a109_0x48fd=function(){return _0x5c1a28;};return a109_0x48fd();}(function(_0x54d82a,_0x283540){const _0x4ce448=a109_0x5954,_0x1aa727=_0x54d82a();while(!![]){try{const _0x177e74=-parseInt(_0x4ce448(0x100))/0x1+parseInt(_0x4ce448(0xed))/0x2+parseInt(_0x4ce448(0xc1))/0x3*(-parseInt(_0x4ce448(0xbf))/0x4)+parseInt(_0x4ce448(0xe1))/0x5+-parseInt(_0x4ce448(0x10e))/0x6+-parseInt(_0x4ce448(0x10c))/0x7*(-parseInt(_0x4ce448(0x10d))/0x8)+parseInt(_0x4ce448(0xf9))/0x9*(parseInt(_0x4ce448(0x106))/0xa);if(_0x177e74===_0x283540)break;else _0x1aa727['push'](_0x1aa727['shift']());}catch(_0x5a199a){_0x1aa727['push'](_0x1aa727['shift']());}}}(a109_0x48fd,0xda106));const a109_0xd8baa0=(function(){let _0x15ebfc=!![];return function(_0x20553e,_0x8bc58){const _0x3c9326=_0x15ebfc?function(){const _0x40ad11=a109_0x5954;if(_0x8bc58){const _0x2c7d5c=_0x8bc58[_0x40ad11(0x108)](_0x20553e,arguments);return _0x8bc58=null,_0x2c7d5c;}}:function(){};return _0x15ebfc=![],_0x3c9326;};}()),a109_0x1a27ea=a109_0xd8baa0(this,function(){const _0x9d4170=a109_0x5954;return a109_0x1a27ea['toString']()[_0x9d4170(0xcb)](_0x9d4170(0xd1))[_0x9d4170(0xeb)]()['constructor'](a109_0x1a27ea)[_0x9d4170(0xcb)](_0x9d4170(0xd1));});a109_0x1a27ea();function a109_0x5954(_0x2db660,_0xfea7b2){const _0x46d840=a109_0x48fd();return a109_0x5954=function(_0x1a27ea,_0xd8baa0){_0x1a27ea=_0x1a27ea-0xb9;let _0x48fd47=_0x46d840[_0x1a27ea];return _0x48fd47;},a109_0x5954(_0x2db660,_0xfea7b2);}'use strict';var __decorate=this&&this['__decorate']||function(_0x106a72,_0x384310,_0x5091c1,_0xed7cd7){const _0x2818a0=a109_0x5954;var _0xcdd002=arguments[_0x2818a0(0x109)],_0x41e1fb=_0xcdd002<0x3?_0x384310:_0xed7cd7===null?_0xed7cd7=Object[_0x2818a0(0x10a)](_0x384310,_0x5091c1):_0xed7cd7,_0x29c1bc;if(typeof Reflect==='object'&&typeof Reflect[_0x2818a0(0x107)]===_0x2818a0(0xd9))_0x41e1fb=Reflect['decorate'](_0x106a72,_0x384310,_0x5091c1,_0xed7cd7);else{for(var _0x3557d8=_0x106a72['length']-0x1;_0x3557d8>=0x0;_0x3557d8--)if(_0x29c1bc=_0x106a72[_0x3557d8])_0x41e1fb=(_0xcdd002<0x3?_0x29c1bc(_0x41e1fb):_0xcdd002>0x3?_0x29c1bc(_0x384310,_0x5091c1,_0x41e1fb):_0x29c1bc(_0x384310,_0x5091c1))||_0x41e1fb;}return _0xcdd002>0x3&&_0x41e1fb&&Object['defineProperty'](_0x384310,_0x5091c1,_0x41e1fb),_0x41e1fb;},__metadata=this&&this['__metadata']||function(_0x37509f,_0x3d4b92){const _0x3b041f=a109_0x5954;if(typeof Reflect==='object'&&typeof Reflect[_0x3b041f(0xd8)]===_0x3b041f(0xd9))return Reflect['metadata'](_0x37509f,_0x3d4b92);};Object[a109_0x6e0081(0xc3)](exports,a109_0x6e0081(0xfb),{'value':!![]}),exports[a109_0x6e0081(0xcd)]=void 0x0;const constants_1=require(a109_0x6e0081(0xd4)),salesforce_git_sync_service_1=require(a109_0x6e0081(0x101)),salesforce_rest_service_1=require('../../salesforce/services/salesforce-rest.service'),typedi_1=require(a109_0x6e0081(0xbc)),salesforce_sync_service_1=require(a109_0x6e0081(0x10f)),salesforce_service_1=require(a109_0x6e0081(0xe5)),parser_v2_1=require(a109_0x6e0081(0xd2)),utils_1=require(a109_0x6e0081(0xee));let GitCommitService=class GitCommitService{constructor(_0x19e1db,_0x42039d,_0x5cb8bf,_0xd4c4c0){const _0xd20756=a109_0x6e0081;this[_0xd20756(0xe9)]=_0x19e1db,this[_0xd20756(0xc7)]=_0x42039d,this[_0xd20756(0xc8)]=_0x5cb8bf,this[_0xd20756(0xdb)]=_0xd4c4c0,this[_0xd20756(0xf8)]=0xc8;}get['repositoryId'](){const _0xbc028d=a109_0x6e0081;var _0x48cbcb;return((_0x48cbcb=this[_0xbc028d(0xc6)])===null||_0x48cbcb===void 0x0?void 0x0:_0x48cbcb[_0xbc028d(0xd0)])||'';}get[a109_0x6e0081(0xe3)](){const _0x3a7e58=a109_0x6e0081;var _0x5f3701;return((_0x5f3701=this[_0x3a7e58(0xc6)])===null||_0x5f3701===void 0x0?void 0x0:_0x5f3701[_0x3a7e58(0xe3)])||'';}async[a109_0x6e0081(0xdd)](_0x23ab02){const _0x334cbd=a109_0x6e0081;return this['salesforceGitSync'][_0x334cbd(0xdd)](_0x23ab02,this[_0x334cbd(0xd0)]);}async['checkSyncStatus'](_0x5a4593){const _0x530bb0=a109_0x6e0081;if(this[_0x530bb0(0xc6)]){const _0x425e5f=await this[_0x530bb0(0xc8)]['getRemoteStateAttachmentId'](this[_0x530bb0(0xc6)]),_0x3b2583=await this[_0x530bb0(0xdb)][_0x530bb0(0xdc)](_0x425e5f)[_0x530bb0(0x113)](_0x114225=>typeof _0x114225===_0x530bb0(0x10b)?JSON[_0x530bb0(0xe7)](_0x114225):_0x114225)[_0x530bb0(0xf1)](()=>({}));if(_0x3b2583[this[_0x530bb0(0xd5)][_0x530bb0(0xfc)]]){if(_0x3b2583[this['gitCommit']['repositoryGit']][_0x530bb0(0xf0)]===_0x5a4593)return!![];}return![];}return![];}async[a109_0x6e0081(0x102)](_0x3540b0){const _0x2acbd2=a109_0x6e0081;this['syncRecord']&&await this[_0x2acbd2(0xc8)]['updateRemoteState'](this[_0x2acbd2(0xc6)],_0x3540b0);}[a109_0x6e0081(0xd7)](){const _0xaf6a3=a109_0x6e0081;return this[_0xaf6a3(0xe0)][_0xaf6a3(0xec)](({fileName:_0xf4c3f6})=>_0xf4c3f6);}async[a109_0x6e0081(0xf6)](_0xf9f2ab,_0x2c8c3a,_0x49390f){const _0x3014c0=a109_0x6e0081,_0x5bf285=new RegExp('^'+_0xf9f2ab+_0x3014c0(0xf3));let _0x12be25=[_0xf9f2ab];_0x49390f&&(_0x12be25=(0x0,utils_1[_0x3014c0(0xfa)])(await(0x0,utils_1['readFilesByFilename'])(_0xf9f2ab,_0x2c8c3a)['catch'](()=>[])));const _0x2a79bc=_0x49390f?this[_0x3014c0(0xe0)][_0x3014c0(0xf2)](_0x1a5c18=>_0x1a5c18['fileName'][_0x3014c0(0xea)](_0x5bf285)):this['componentsMetadata']['filter'](_0x396a77=>_0x396a77[_0x3014c0(0xe2)]===_0xf9f2ab||_0x396a77[_0x3014c0(0xe2)]===_0xf9f2ab['replace'](constants_1[_0x3014c0(0xcc)],'')),_0x24411f=new parser_v2_1['MDApiParserV2'](_0x2c8c3a,_0x12be25),_0x23eb95=await _0x24411f['parse'](),_0x3a88a3=[],_0x109a8b=[];for(const _0x9373e9 of _0x23eb95){const _0x8d6fb3=_0x2a79bc[_0x3014c0(0xe6)](_0x2df33a=>_0x2df33a[_0x3014c0(0xdf)]===_0x9373e9[_0x3014c0(0xdf)]&&_0x2df33a[_0x3014c0(0x105)]===_0x9373e9[_0x3014c0(0x105)]);if(!_0x8d6fb3){_0x3a88a3[_0x3014c0(0x104)](_0x9373e9);continue;}_0x9373e9['crc']!==_0x8d6fb3[_0x3014c0(0xfe)]&&_0x109a8b[_0x3014c0(0x104)]({'meta':_0x8d6fb3,'component':_0x9373e9}),_0x2a79bc[_0x3014c0(0x111)](_0x2a79bc[_0x3014c0(0x112)](_0x8d6fb3),0x1);}return{'inserted':_0x3a88a3,'modified':_0x109a8b,'removed':_0x2a79bc};}async[a109_0x6e0081(0xda)](){const _0x2f60ec=a109_0x6e0081;this[_0x2f60ec(0xc6)]=this[_0x2f60ec(0xd5)][_0x2f60ec(0xc4)]==='master'?await this['salesforceSync'][_0x2f60ec(0xf7)](this[_0x2f60ec(0xd5)][_0x2f60ec(0xce)]):await this['salesforceSync'][_0x2f60ec(0xca)](this['gitCommit'][_0x2f60ec(0xc4)]),this['recordTypes']=await this['salesforceGitSync'][_0x2f60ec(0xff)]();}async[a109_0x6e0081(0xcf)](_0x1a5a7b){const _0x5ac7ac=a109_0x6e0081;if(this[_0x5ac7ac(0xd5)][_0x5ac7ac(0xde)]||_0x1a5a7b){this[_0x5ac7ac(0xe0)]=this[_0x5ac7ac(0xe3)]?await this['salesforceGitSync'][_0x5ac7ac(0xe8)](this[_0x5ac7ac(0xe3)]):await this[_0x5ac7ac(0xe9)][_0x5ac7ac(0xc2)](this['repositoryId']);return;}const _0x2d245a=[...new Set(this['gitCommit']['fileNames'][_0x5ac7ac(0xec)](_0xaed559=>_0xaed559[_0x5ac7ac(0xc5)](constants_1[_0x5ac7ac(0xcc)],'')))];this['componentsMetadata']=[];while(_0x2d245a[_0x5ac7ac(0x109)]){const _0xdb3b9e=_0x2d245a[_0x5ac7ac(0x111)](0x0,this['TASKS_PER_TICK']),_0x277ca0=this[_0x5ac7ac(0xe3)]?await this[_0x5ac7ac(0xe9)]['fetchBranchComponentsByFilenames'](_0xdb3b9e,this['branchId']):await this['salesforceGitSync']['fetchRepositoryComponentsByFilenames'](_0xdb3b9e,this[_0x5ac7ac(0xd0)]);this[_0x5ac7ac(0xe0)][_0x5ac7ac(0x104)](..._0x277ca0);}}async[a109_0x6e0081(0xc9)](_0x3d00eb){const _0xdd3b2d=a109_0x6e0081;this[_0xdd3b2d(0xe3)]?await this[_0xdd3b2d(0xc7)][_0xdd3b2d(0xbb)](constants_1[_0xdd3b2d(0xba)],this[_0xdd3b2d(0xe3)],{[constants_1['FLOSUM_GIT_NAMESPACE']+'Synchronization_Status__c']:_0x3d00eb,[constants_1['FLOSUM_NAMESPACE']+'Last_Updated_On__c']:Date['now']()}):await this[_0xdd3b2d(0xc7)][_0xdd3b2d(0xbb)](constants_1[_0xdd3b2d(0xf5)],this['repositoryId'],{[constants_1[_0xdd3b2d(0xd3)]+_0xdd3b2d(0xd6)]:_0x3d00eb});}[a109_0x6e0081(0xb9)](_0x1c372d){const _0x5ac53b=a109_0x6e0081;this[_0x5ac53b(0xd5)]=_0x1c372d;}[a109_0x6e0081(0xbe)](){const _0x4d4807=a109_0x6e0081;return this[_0x4d4807(0xef)];}[a109_0x6e0081(0xbd)](){return this['repositoryId'];}[a109_0x6e0081(0xe4)](){return this['branchId'];}};GitCommitService=__decorate([(0x0,typedi_1[a109_0x6e0081(0xfd)])({'transient':!![]}),__metadata(a109_0x6e0081(0xf4),[salesforce_git_sync_service_1['SalesforceGitSyncService'],salesforce_rest_service_1[a109_0x6e0081(0x103)],salesforce_sync_service_1[a109_0x6e0081(0xc0)],salesforce_service_1[a109_0x6e0081(0x110)]])],GitCommitService),exports[a109_0x6e0081(0xcd)]=GitCommitService;