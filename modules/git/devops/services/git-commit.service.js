const a129_0xf3cfc9=a129_0x1c09;function a129_0x1c09(_0x27aa94,_0x2adb71){const _0x4f5764=a129_0xbba3();return a129_0x1c09=function(_0x12b941,_0xb89e69){_0x12b941=_0x12b941-0x1e1;let _0xbba33f=_0x4f5764[_0x12b941];return _0xbba33f;},a129_0x1c09(_0x27aa94,_0x2adb71);}(function(_0x414d03,_0x1f03ec){const _0x25f549=a129_0x1c09,_0x10de93=_0x414d03();while(!![]){try{const _0x13689c=parseInt(_0x25f549(0x204))/0x1+parseInt(_0x25f549(0x239))/0x2+-parseInt(_0x25f549(0x1f0))/0x3+-parseInt(_0x25f549(0x230))/0x4*(-parseInt(_0x25f549(0x22e))/0x5)+parseInt(_0x25f549(0x1fd))/0x6*(-parseInt(_0x25f549(0x22f))/0x7)+-parseInt(_0x25f549(0x219))/0x8*(parseInt(_0x25f549(0x1ee))/0x9)+parseInt(_0x25f549(0x1f8))/0xa*(parseInt(_0x25f549(0x212))/0xb);if(_0x13689c===_0x1f03ec)break;else _0x10de93['push'](_0x10de93['shift']());}catch(_0x179ff5){_0x10de93['push'](_0x10de93['shift']());}}}(a129_0xbba3,0x449c0));const a129_0xb89e69=(function(){let _0x4d982b=!![];return function(_0x2cb1c4,_0x357fe7){const _0x4306aa=_0x4d982b?function(){if(_0x357fe7){const _0xb19dbe=_0x357fe7['apply'](_0x2cb1c4,arguments);return _0x357fe7=null,_0xb19dbe;}}:function(){};return _0x4d982b=![],_0x4306aa;};}()),a129_0x12b941=a129_0xb89e69(this,function(){const _0x1bdb3e=a129_0x1c09;return a129_0x12b941['toString']()['search'](_0x1bdb3e(0x1f6))[_0x1bdb3e(0x207)]()['constructor'](a129_0x12b941)['search']('(((.+)+)+)+$');});a129_0x12b941();'use strict';var __decorate=this&&this[a129_0xf3cfc9(0x1fc)]||function(_0x7b1f3e,_0x31d7e5,_0x257dbc,_0x50e576){const _0x17d139=a129_0xf3cfc9;var _0x39ecc7=arguments[_0x17d139(0x20d)],_0x2e6c83=_0x39ecc7<0x3?_0x31d7e5:_0x50e576===null?_0x50e576=Object['getOwnPropertyDescriptor'](_0x31d7e5,_0x257dbc):_0x50e576,_0x3e7dec;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x17d139(0x232))_0x2e6c83=Reflect['decorate'](_0x7b1f3e,_0x31d7e5,_0x257dbc,_0x50e576);else{for(var _0x6467ea=_0x7b1f3e[_0x17d139(0x20d)]-0x1;_0x6467ea>=0x0;_0x6467ea--)if(_0x3e7dec=_0x7b1f3e[_0x6467ea])_0x2e6c83=(_0x39ecc7<0x3?_0x3e7dec(_0x2e6c83):_0x39ecc7>0x3?_0x3e7dec(_0x31d7e5,_0x257dbc,_0x2e6c83):_0x3e7dec(_0x31d7e5,_0x257dbc))||_0x2e6c83;}return _0x39ecc7>0x3&&_0x2e6c83&&Object['defineProperty'](_0x31d7e5,_0x257dbc,_0x2e6c83),_0x2e6c83;},__metadata=this&&this[a129_0xf3cfc9(0x1ea)]||function(_0x468597,_0x5f261c){const _0x1f7cbe=a129_0xf3cfc9;if(typeof Reflect==='object'&&typeof Reflect[_0x1f7cbe(0x20f)]===_0x1f7cbe(0x232))return Reflect['metadata'](_0x468597,_0x5f261c);};Object[a129_0xf3cfc9(0x231)](exports,a129_0xf3cfc9(0x1fb),{'value':!![]}),exports['GitCommitService']=void 0x0;function a129_0xbba3(){const _0x27c387=['gitCommit','getRemoteStateAttachmentId','salesforce','salesforceGitSync','../../salesforce/services/salesforce-git-sync.service','FLOSUM_REPOSITORY','8OOYYGn','fetchBranchComponents','lastCommit','Synchronization_Status__c','../../../../constants','repository','../../salesforce/services/salesforce-sync.service','map','repositoryId','recordTypes','filterMetadataComponents','typedi','SalesforceSyncService','SalesforceService','syncRecord','../utils/components.utils','salesforceSync','getUnusedComponentsFilePaths','createCommit','recordTypeName','../../parsers/factory.parser','75VulraH','7ZuWMke','28556BfiPLs','defineProperty','function','proceedFile','string','checkSyncStatus','FLOSUM_GIT_NAMESPACE','crc','updateStatus','664928hkVqVq','SalesforceGitSyncService','FLOSUM_NAMESPACE','now','updateRemoteState','fetchBranchComponentsByFilenames','SalesforceRestService','readComponentPaths','ComponentsUtils','setCommitDto','design:paramtypes','branch','componentsMetadata','__metadata','push','master','branchId','2230263gACXMv','getRepositoryRecordByName','807651FeXJpx','find','Last_Updated_On__c','parse','fileNames','execute','(((.+)+)+)+$','../../salesforce/services/salesforce.service','4715890ySazoc','splice','fetchRepositoryComponentsByFilenames','__esModule','__decorate','3133506dLLYHj','Service','FactoryParser','create','fetchComponentsMetadata','TASKS_PER_TICK','force','409161uGxphB','indexOf','recordType','toString','patch','getRecordTypes','type','name','repositoryGit','length','catch','metadata','FLOSUM_BRANCH','fetchRepositoryComponents','11bYmwNQ'];a129_0xbba3=function(){return _0x27c387;};return a129_0xbba3();}const constants_1=require(a129_0xf3cfc9(0x21d)),salesforce_git_sync_service_1=require(a129_0xf3cfc9(0x217)),salesforce_rest_service_1=require('../../salesforce/services/salesforce-rest.service'),typedi_1=require(a129_0xf3cfc9(0x224)),salesforce_sync_service_1=require(a129_0xf3cfc9(0x21f)),salesforce_service_1=require(a129_0xf3cfc9(0x1f7)),factory_parser_1=require(a129_0xf3cfc9(0x22d)),path_utils_1=require('../utils/path.utils'),components_utils_1=require(a129_0xf3cfc9(0x228));let GitCommitService=class GitCommitService{constructor(_0x1103de,_0xe9e1c5,_0x2a6779,_0x3048b2){const _0x1eb891=a129_0xf3cfc9;this[_0x1eb891(0x216)]=_0x1103de,this['salesforceRest']=_0xe9e1c5,this[_0x1eb891(0x229)]=_0x2a6779,this[_0x1eb891(0x215)]=_0x3048b2,this['TASKS_PER_TICK']=0xc8;}get[a129_0xf3cfc9(0x221)](){const _0x471c3d=a129_0xf3cfc9;var _0x4f4621;return((_0x4f4621=this[_0x471c3d(0x227)])===null||_0x4f4621===void 0x0?void 0x0:_0x4f4621[_0x471c3d(0x221)])||'';}get['branchId'](){const _0x5121e4=a129_0xf3cfc9;var _0x3396dd;return((_0x3396dd=this[_0x5121e4(0x227)])===null||_0x3396dd===void 0x0?void 0x0:_0x3396dd[_0x5121e4(0x1ed)])||'';}get[a129_0xf3cfc9(0x206)](){return this['syncRecord']['recordTypeName'];}async[a129_0xf3cfc9(0x22b)](_0x549ec1){const _0x424232=a129_0xf3cfc9;return this[_0x424232(0x216)][_0x424232(0x22b)](_0x549ec1,this['repositoryId']);}async[a129_0xf3cfc9(0x235)](_0x1d58d3){const _0x2590f3=a129_0xf3cfc9;if(this['syncRecord']){const _0xe7a25b=await this[_0x2590f3(0x229)][_0x2590f3(0x214)](this['syncRecord']),_0x54e391=await this[_0x2590f3(0x215)]['retrieveAttachment'](_0xe7a25b)['then'](_0x27c60f=>typeof _0x27c60f===_0x2590f3(0x234)?JSON[_0x2590f3(0x1f3)](_0x27c60f):_0x27c60f)[_0x2590f3(0x20e)](()=>({}));if(_0x54e391[this[_0x2590f3(0x213)][_0x2590f3(0x20c)]]){if(_0x54e391[this[_0x2590f3(0x213)][_0x2590f3(0x20c)]][_0x2590f3(0x21b)]===_0x1d58d3)return!![];}return![];}return![];}async['updateRemoteState'](_0x5a77ca){const _0x38259b=a129_0xf3cfc9;this['syncRecord']&&await this[_0x38259b(0x229)][_0x38259b(0x1e1)](this['syncRecord'],_0x5a77ca);}[a129_0xf3cfc9(0x22a)](){const _0x3f00ce=a129_0xf3cfc9;return this[_0x3f00ce(0x1e9)][_0x3f00ce(0x220)](({fileName:_0x23302b})=>_0x23302b);}async[a129_0xf3cfc9(0x233)](_0x1f7331,_0x205054,_0x2c539f){const _0x1efba1=a129_0xf3cfc9,_0x8f4796=await path_utils_1['PathUtils'][_0x1efba1(0x1e4)](this[_0x1efba1(0x227)][_0x1efba1(0x22c)],_0x1f7331,_0x205054,_0x2c539f),_0x5b85c1=components_utils_1[_0x1efba1(0x1e5)][_0x1efba1(0x223)](this[_0x1efba1(0x1e9)],_0x1f7331,_0x2c539f,this[_0x1efba1(0x227)]['recordTypeName']),_0x4b95e4=factory_parser_1[_0x1efba1(0x1ff)][_0x1efba1(0x200)]({'recordType':this[_0x1efba1(0x227)][_0x1efba1(0x22c)],'sourceDir':_0x205054,'paths':_0x8f4796}),_0x53e5e9=await _0x4b95e4[_0x1efba1(0x1f5)](),_0x553e98=[],_0x566fef=[];for(const _0xbfd239 of _0x53e5e9){const _0x358740=_0x5b85c1[_0x1efba1(0x1f1)](_0x7ab026=>_0x7ab026['name']===_0xbfd239[_0x1efba1(0x20b)]&&_0x7ab026[_0x1efba1(0x20a)]===_0xbfd239[_0x1efba1(0x20a)]);if(!_0x358740){_0x553e98[_0x1efba1(0x1eb)](_0xbfd239);continue;}_0xbfd239[_0x1efba1(0x237)]!==_0x358740['crc32']&&_0x566fef['push']({'meta':_0x358740,'component':_0xbfd239}),_0x5b85c1[_0x1efba1(0x1f9)](_0x5b85c1[_0x1efba1(0x205)](_0x358740),0x1);}return{'inserted':_0x553e98,'modified':_0x566fef,'removed':_0x5b85c1};}async['fetchRepositoryOrBranchData'](){const _0x37466e=a129_0xf3cfc9;this[_0x37466e(0x227)]=this[_0x37466e(0x213)][_0x37466e(0x1e8)]===_0x37466e(0x1ec)?await this[_0x37466e(0x229)][_0x37466e(0x1ef)](this[_0x37466e(0x213)][_0x37466e(0x21e)]):await this[_0x37466e(0x229)]['getBranchRecordByName'](this[_0x37466e(0x213)][_0x37466e(0x1e8)]),this[_0x37466e(0x222)]=await this[_0x37466e(0x216)]['getComponentRecordTypes']();}async[a129_0xf3cfc9(0x201)](_0x441ec3){const _0x4119c9=a129_0xf3cfc9;if(this[_0x4119c9(0x213)][_0x4119c9(0x203)]||_0x441ec3){this['componentsMetadata']=this['branchId']?await this['salesforceGitSync'][_0x4119c9(0x21a)](this[_0x4119c9(0x1ed)]):await this[_0x4119c9(0x216)][_0x4119c9(0x211)](this['repositoryId']);return;}const _0x23c84c=components_utils_1[_0x4119c9(0x1e5)]['prepareComponentNamesForFetchMetadata'](this[_0x4119c9(0x213)][_0x4119c9(0x1f4)],this[_0x4119c9(0x227)]['recordTypeName']);this[_0x4119c9(0x1e9)]=[];while(_0x23c84c['length']){const _0x2b4f16=_0x23c84c[_0x4119c9(0x1f9)](0x0,this[_0x4119c9(0x202)]),_0x3f7ec9=this[_0x4119c9(0x1ed)]?await this['salesforceGitSync'][_0x4119c9(0x1e2)](_0x2b4f16,this[_0x4119c9(0x1ed)]):await this['salesforceGitSync'][_0x4119c9(0x1fa)](_0x2b4f16,this[_0x4119c9(0x221)]);this['componentsMetadata'][_0x4119c9(0x1eb)](..._0x3f7ec9);}}async[a129_0xf3cfc9(0x238)](_0x43b9dc){const _0x5598fd=a129_0xf3cfc9;this['branchId']?await this['salesforceRest'][_0x5598fd(0x208)](constants_1[_0x5598fd(0x210)],this[_0x5598fd(0x1ed)],{[constants_1[_0x5598fd(0x236)]+_0x5598fd(0x21c)]:_0x43b9dc,[constants_1[_0x5598fd(0x23b)]+_0x5598fd(0x1f2)]:Date[_0x5598fd(0x23c)]()}):await this['salesforceRest'][_0x5598fd(0x208)](constants_1[_0x5598fd(0x218)],this[_0x5598fd(0x221)],{[constants_1[_0x5598fd(0x236)]+_0x5598fd(0x21c)]:_0x43b9dc});}[a129_0xf3cfc9(0x1e6)](_0x1298be){this['gitCommit']=_0x1298be;}[a129_0xf3cfc9(0x209)](){return this['recordTypes'];}['getRepositoryId'](){const _0x58e3fe=a129_0xf3cfc9;return this[_0x58e3fe(0x221)];}['getBranchId'](){return this['branchId'];}};GitCommitService=__decorate([(0x0,typedi_1[a129_0xf3cfc9(0x1fe)])({'transient':!![]}),__metadata(a129_0xf3cfc9(0x1e7),[salesforce_git_sync_service_1[a129_0xf3cfc9(0x23a)],salesforce_rest_service_1[a129_0xf3cfc9(0x1e3)],salesforce_sync_service_1[a129_0xf3cfc9(0x225)],salesforce_service_1[a129_0xf3cfc9(0x226)]])],GitCommitService),exports['GitCommitService']=GitCommitService;