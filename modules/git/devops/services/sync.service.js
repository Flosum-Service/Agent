function a110_0xb8af(_0x19f4b1,_0x3cb4f6){const _0x343e5c=a110_0x6adc();return a110_0xb8af=function(_0x1ae29b,_0x2ec8ea){_0x1ae29b=_0x1ae29b-0xea;let _0x6adc51=_0x343e5c[_0x1ae29b];return _0x6adc51;},a110_0xb8af(_0x19f4b1,_0x3cb4f6);}const a110_0x4c3fff=a110_0xb8af;(function(_0x1970a3,_0x32a539){const _0x281521=a110_0xb8af,_0x20f236=_0x1970a3();while(!![]){try{const _0x586284=-parseInt(_0x281521(0x11d))/0x1+-parseInt(_0x281521(0x147))/0x2+-parseInt(_0x281521(0x145))/0x3+parseInt(_0x281521(0xf4))/0x4*(-parseInt(_0x281521(0x126))/0x5)+-parseInt(_0x281521(0x140))/0x6*(-parseInt(_0x281521(0x132))/0x7)+parseInt(_0x281521(0x102))/0x8*(-parseInt(_0x281521(0xf2))/0x9)+parseInt(_0x281521(0x104))/0xa;if(_0x586284===_0x32a539)break;else _0x20f236['push'](_0x20f236['shift']());}catch(_0x752be1){_0x20f236['push'](_0x20f236['shift']());}}}(a110_0x6adc,0xc7f9d));const a110_0x2ec8ea=(function(){let _0x1b3dd8=!![];return function(_0xa098a7,_0x75fc48){const _0x2fad87=_0x1b3dd8?function(){if(_0x75fc48){const _0x4801b2=_0x75fc48['apply'](_0xa098a7,arguments);return _0x75fc48=null,_0x4801b2;}}:function(){};return _0x1b3dd8=![],_0x2fad87;};}()),a110_0x1ae29b=a110_0x2ec8ea(this,function(){const _0xdc0c2f=a110_0xb8af;return a110_0x1ae29b[_0xdc0c2f(0x148)]()[_0xdc0c2f(0x12d)](_0xdc0c2f(0x112))['toString']()['constructor'](a110_0x1ae29b)['search'](_0xdc0c2f(0x112));});a110_0x1ae29b();'use strict';var __decorate=this&&this['__decorate']||function(_0x3ae275,_0x406eaf,_0x1780fc,_0x26e57d){const _0x570019=a110_0xb8af;var _0x199446=arguments['length'],_0x4b00b7=_0x199446<0x3?_0x406eaf:_0x26e57d===null?_0x26e57d=Object[_0x570019(0x10b)](_0x406eaf,_0x1780fc):_0x26e57d,_0x4db003;if(typeof Reflect===_0x570019(0x108)&&typeof Reflect[_0x570019(0x165)]===_0x570019(0x131))_0x4b00b7=Reflect['decorate'](_0x3ae275,_0x406eaf,_0x1780fc,_0x26e57d);else{for(var _0x400096=_0x3ae275[_0x570019(0x161)]-0x1;_0x400096>=0x0;_0x400096--)if(_0x4db003=_0x3ae275[_0x400096])_0x4b00b7=(_0x199446<0x3?_0x4db003(_0x4b00b7):_0x199446>0x3?_0x4db003(_0x406eaf,_0x1780fc,_0x4b00b7):_0x4db003(_0x406eaf,_0x1780fc))||_0x4b00b7;}return _0x199446>0x3&&_0x4b00b7&&Object['defineProperty'](_0x406eaf,_0x1780fc,_0x4b00b7),_0x4b00b7;},__metadata=this&&this[a110_0x4c3fff(0xfe)]||function(_0x25522b,_0x1c4d13){const _0x1515c6=a110_0x4c3fff;if(typeof Reflect===_0x1515c6(0x108)&&typeof Reflect[_0x1515c6(0x125)]===_0x1515c6(0x131))return Reflect[_0x1515c6(0x125)](_0x25522b,_0x1c4d13);},SyncService_1;function a110_0x6adc(){const _0xa90ca6=['2951532woTHbA','toString','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','BadRequestError','salesforceSync','../../../../core/errors/bad-request.error','GitSyncJob','log','getLoggerId','setLoggerId','\x20Have\x20to\x20synchronize\x20','find','REPOSITORY_NAME_REGEXP','../errors/git-branch-not-found.error','\x20No\x20repositories\x20to\x20sync.','design:paramtypes','get','SyncService','catch','branchId','create','config','FlosumSyncJob','repositoriesIntersections','gitRepoService','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','length',']\x20[','\x20Syncing\x20repository:\x20\x22','setStatus','decorate','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','Waiting','logger','repositoryId','SalesforceError',']\x20due\x20error\x20-\x20','../../salesforce/errors/salesforce.error','\x20branches.','salesforceService','SyncDirection','branchName','\x20Sync\x20job\x20done.','3429Tcmowi','send','8UZNjxL','__esModule','\x20Checking\x20valid\x20name.','direction','map','\x20Getting\x20Flosum\x20repository','getAll','\x20Getting\x20branch\x20records.','join','sfLogger','__metadata','updateRemoteState','connectionId','../../../../constants','18928nMUPGY','\x20Completed\x20prepare\x20to\x20syncing.','60500510CDRRNa','TooManyRequests','repoList','name','object','\x27\x20in\x20repository\x20\x27','hooks','getOwnPropertyDescriptor','checkValidNaming','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','isBidirectionalSynchronization','../../providers/web-hooks/hooks.utils','../../providers/providers.tokens','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','(((.+)+)+)+$','Tokens','gitApiService','BRANCH_NAME_REGEXP','../../salesforce/services/salesforce-sync.service','getRepositoryRecords','\x20Stop\x20sync\x20job\x20for\x20\x27','prefix','Not\x20Synchronized','\x20Getting\x20repositories\x20from\x20git\x20service.',']\x20branch.','1359475TnqKap','push','defineProperty','HooksUtils','../jobs/flosum-sync.job','Unable\x20to\x20synchronize\x20repository\x20\x27','Container','getHookLinkFor','metadata','2586635gPchsT','getBranchRecords','\x20Checking\x20intersects.','../jobs/git-sync.job','run','getOrCreateRepo','../../../../core','search','Service','Logger','repositoryName','function','623616WxbCsH','applicationUrl','error','toUpperCase','../../../shared/utils','FlosumToGit','handleRecordSyncError','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','isIntersects','toLowerCase','gitProvider','GitBranchNotFoundError','\x20Repository\x20\x22','createHookPayload','18iVNxgC','\x20Getting\x20repository\x20records.','repoService','SalesforceSyncService','test','2180619kDNmAy','../../salesforce/services/salesforce.service'];a110_0x6adc=function(){return _0xa90ca6;};return a110_0x6adc();}Object[a110_0x4c3fff(0x11f)](exports,a110_0x4c3fff(0xf5),{'value':!![]}),exports[a110_0x4c3fff(0x158)]=void 0x0;const constants_1=require(a110_0x4c3fff(0x101)),core_1=require(a110_0x4c3fff(0x12c)),too_many_requests_error_1=require('../../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a110_0x4c3fff(0xec)),salesforce_sync_service_1=require(a110_0x4c3fff(0x116)),salesforce_service_1=require(a110_0x4c3fff(0x146)),utils_1=require(a110_0x4c3fff(0x136)),typedi_1=require('typedi'),hooks_utils_1=require(a110_0x4c3fff(0x10f)),git_branch_not_found_error_1=require(a110_0x4c3fff(0x154)),flosum_sync_job_1=require(a110_0x4c3fff(0x121)),git_sync_job_1=require(a110_0x4c3fff(0x129)),providers_tokens_1=require(a110_0x4c3fff(0x110)),bad_request_error_1=require(a110_0x4c3fff(0x14c));let SyncService=SyncService_1=class SyncService{constructor(_0x292090,_0x11b0b8){const _0xad5ec0=a110_0x4c3fff;this['salesforceService']=_0x292090,this[_0xad5ec0(0x14b)]=_0x11b0b8,this[_0xad5ec0(0x168)]=new core_1[(_0xad5ec0(0x12f))](SyncService_1['name']),this[_0xad5ec0(0x15e)]={},this['repoList']=[];}async[a110_0x4c3fff(0x138)](_0x1bd577,_0x41f828){const _0x73f3db=a110_0x4c3fff;if(_0x41f828 instanceof git_branch_not_found_error_1[_0x73f3db(0x13d)]){await this[_0x73f3db(0x14b)]['setStatus'](_0x1bd577,_0x73f3db(0x11a));return;}if(_0x41f828 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x73f3db(0x14b)][_0x73f3db(0x164)](_0x1bd577,_0x73f3db(0x167));throw _0x41f828;}try{await this[_0x73f3db(0xfd)]['error'](this[_0x73f3db(0x119)]+_0x73f3db(0x118)+_0x1bd577[_0x73f3db(0x130)]+'\x27\x20['+_0x1bd577['branchName']+_0x73f3db(0xeb)+_0x41f828+'.')[_0x73f3db(0xf3)](),await this[_0x73f3db(0x14b)][_0x73f3db(0xff)](_0x1bd577,{}),await this[_0x73f3db(0x14b)][_0x73f3db(0x164)](_0x1bd577,'Error');}catch(_0xe13a45){if(_0xe13a45 instanceof salesforce_error_1[_0x73f3db(0xea)])throw _0xe13a45;}}async[a110_0x4c3fff(0x13a)](_0x42d00d){const _0x579319=a110_0x4c3fff;if(_0x42d00d[_0x579319(0x169)]){const _0x50bce8=_0x42d00d['repositoryName'][_0x579319(0x13b)](),_0x2b3b62=this[_0x579319(0x15e)][_0x50bce8];if(!_0x2b3b62)this[_0x579319(0x15e)][_0x50bce8]=_0x42d00d['repositoryName'];else{if(_0x2b3b62&&_0x2b3b62!==_0x42d00d[_0x579319(0x130)])return await this[_0x579319(0x138)](_0x42d00d,new Error(_0x579319(0x122)+_0x42d00d[_0x579319(0x130)]+_0x579319(0x139)+_0x50bce8+'\x27\x20-\x20\x27'+_0x2b3b62+'\x27')),!![];}}return![];}async[a110_0x4c3fff(0x10c)](_0x279dd2){const _0x3989d9=a110_0x4c3fff;if(!constants_1[_0x3989d9(0x153)][_0x3989d9(0x144)](_0x279dd2[_0x3989d9(0x130)]))return await this[_0x3989d9(0x138)](_0x279dd2,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x279dd2['repositoryName']+_0x3989d9(0x166))),![];if(!constants_1[_0x3989d9(0x115)][_0x3989d9(0x144)](_0x279dd2[_0x3989d9(0xf0)]))return await this[_0x3989d9(0x138)](_0x279dd2,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x279dd2[_0x3989d9(0xf0)]+_0x3989d9(0x109)+_0x279dd2[_0x3989d9(0x130)]+_0x3989d9(0x10d))),![];return!![];}async[a110_0x4c3fff(0x12b)](_0x16c3bf,_0x5c504a){const _0x5f2913=a110_0x4c3fff;let _0x191172=this[_0x5f2913(0x106)][_0x5f2913(0x152)](_0x323036=>_0x16c3bf[_0x5f2913(0x130)]===_0x323036['name']);!_0x191172&&(this[_0x5f2913(0xfd)]['log'](this[_0x5f2913(0x119)]+_0x5f2913(0x13e)+_0x16c3bf[_0x5f2913(0x130)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x191172=await this['repoService']['create']({'name':_0x16c3bf[_0x5f2913(0x130)],'autoInit':!![],'defaultBranch':_0x16c3bf[_0x5f2913(0xf0)],'private':!![],'createHook':typedi_1[_0x5f2913(0x123)]['get'](providers_tokens_1[_0x5f2913(0x113)][_0x5f2913(0x15c)])[_0x5f2913(0x10e)]}));if(this[_0x5f2913(0x15c)][_0x5f2913(0x10e)]){const _0x5d9bb6=await _0x191172[_0x5f2913(0x10a)][_0x5f2913(0xfa)]();!_0x5d9bb6[_0x5f2913(0x152)](_0x11d75d=>_0x11d75d['url']===hooks_utils_1[_0x5f2913(0x120)][_0x5f2913(0x124)](this[_0x5f2913(0x15c)][_0x5f2913(0x13c)],this['config'][_0x5f2913(0x133)],_0x5c504a))&&(this['sfLogger'][_0x5f2913(0x14e)](this[_0x5f2913(0x119)]+_0x5f2913(0x13e)+_0x16c3bf['repositoryName']+_0x5f2913(0x111)),await _0x191172['hooks'][_0x5f2913(0x15b)](hooks_utils_1[_0x5f2913(0x120)][_0x5f2913(0x13f)](this['config'][_0x5f2913(0x13c)],_0x191172['hooks'],this[_0x5f2913(0x15c)][_0x5f2913(0x133)],_0x5c504a)));}return this[_0x5f2913(0x106)][_0x5f2913(0x11e)](_0x191172),_0x191172;}async[a110_0x4c3fff(0x12a)](){const _0xf6b0c8=a110_0x4c3fff;this[_0xf6b0c8(0x114)]=typedi_1[_0xf6b0c8(0x123)]['get'](providers_tokens_1[_0xf6b0c8(0x113)][_0xf6b0c8(0x114)]),this[_0xf6b0c8(0x142)]=typedi_1['Container'][_0xf6b0c8(0x157)](providers_tokens_1[_0xf6b0c8(0x113)][_0xf6b0c8(0x15f)]),this['config']=typedi_1[_0xf6b0c8(0x123)][_0xf6b0c8(0x157)](providers_tokens_1[_0xf6b0c8(0x113)]['config']),this[_0xf6b0c8(0xfd)]=typedi_1[_0xf6b0c8(0x123)]['get'](providers_tokens_1[_0xf6b0c8(0x113)][_0xf6b0c8(0x168)]),this['prefix']='['+SyncService_1[_0xf6b0c8(0x107)]+_0xf6b0c8(0x162)+this[_0xf6b0c8(0x15c)]['gitProvider'][_0xf6b0c8(0x135)]()+']',this[_0xf6b0c8(0xee)][_0xf6b0c8(0x150)](this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14f)]());try{this['sfLogger'][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+'\x20Start\x20sync\x20job.'),await this['sfLogger'][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0x141))[_0xf6b0c8(0xf3)]();const _0x43a4e7=await this[_0xf6b0c8(0x14b)][_0xf6b0c8(0x117)](typedi_1['Container']['get'](providers_tokens_1[_0xf6b0c8(0x113)][_0xf6b0c8(0x100)]));if(!_0x43a4e7[_0xf6b0c8(0x161)])throw new bad_request_error_1[(_0xf6b0c8(0x14a))](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0x155));await this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14e)](this['prefix']+_0xf6b0c8(0xfb))[_0xf6b0c8(0xf3)]();const _0x412a04=await this[_0xf6b0c8(0x14b)][_0xf6b0c8(0x127)](_0x43a4e7[_0xf6b0c8(0xf8)](_0x1b7bfa=>'\x27'+_0x1b7bfa['repositoryId']+'\x27')[_0xf6b0c8(0xfc)](','));await this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0x11b))[_0xf6b0c8(0xf3)](),this[_0xf6b0c8(0x106)]=await this[_0xf6b0c8(0x142)]['getAll']();const _0x481bb6=[..._0x43a4e7,..._0x412a04];this['sfLogger'][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0x151)+_0x481bb6[_0xf6b0c8(0x161)]+_0xf6b0c8(0xed));for(const _0x3f3174 of _0x481bb6){this[_0xf6b0c8(0x168)][_0xf6b0c8(0x14e)]('Syncing\x20'+_0x3f3174[_0xf6b0c8(0x130)]+'['+_0x3f3174['repositoryId']+']\x20repository\x20'+_0x3f3174['branchName']+'['+_0x3f3174[_0xf6b0c8(0x15a)]+_0xf6b0c8(0x11c)),this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14e)](this['prefix']+_0xf6b0c8(0x163)+_0x3f3174[_0xf6b0c8(0x130)]+'\x22\x20branch:\x20\x22'+_0x3f3174['branchName']+'\x22.'),this[_0xf6b0c8(0xfd)]['log'](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0xf6));const _0x281db0=await this[_0xf6b0c8(0x10c)](_0x3f3174);if(!_0x281db0)continue;this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14e)](this['prefix']+_0xf6b0c8(0x128));const _0x488cd3=await this[_0xf6b0c8(0x13a)](_0x3f3174);if(_0x488cd3)continue;await this['sfLogger'][_0xf6b0c8(0xf3)]();let _0x579cf3;try{await this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0xf9))[_0xf6b0c8(0xf3)](),_0x579cf3=await this[_0xf6b0c8(0x12b)](_0x3f3174,typedi_1[_0xf6b0c8(0x123)][_0xf6b0c8(0x157)](providers_tokens_1[_0xf6b0c8(0x113)][_0xf6b0c8(0x100)]));}catch(_0x4e869a){await this[_0xf6b0c8(0x138)](_0x3f3174,_0x4e869a instanceof too_many_requests_error_1[_0xf6b0c8(0x105)]?_0x4e869a:new Error(_0xf6b0c8(0x160)+_0x4e869a));continue;}await this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0x103))[_0xf6b0c8(0xf3)]();if(_0x3f3174[_0xf6b0c8(0xf7)]===flosum_repository_sync_dto_1[_0xf6b0c8(0xef)][_0xf6b0c8(0x137)]){const _0x3e8eab=typedi_1[_0xf6b0c8(0x123)]['get'](flosum_sync_job_1[_0xf6b0c8(0x15d)]);await _0x3e8eab['run']({'repository':_0x579cf3,'convertToSFDX':this[_0xf6b0c8(0x15c)]['isConvertToSfdx'],'syncRecord':_0x3f3174,'provider':this[_0xf6b0c8(0x15c)][_0xf6b0c8(0x13c)]})[_0xf6b0c8(0x159)](_0xda7b91=>this['handleRecordSyncError'](_0x3f3174,_0xda7b91));}else{const _0x4ba3e6=typedi_1[_0xf6b0c8(0x123)][_0xf6b0c8(0x157)](git_sync_job_1[_0xf6b0c8(0x14d)]);await _0x4ba3e6[_0xf6b0c8(0x12a)]({'repository':_0x579cf3,'branch':_0x3f3174[_0xf6b0c8(0xf0)],'provider':this[_0xf6b0c8(0x15c)][_0xf6b0c8(0x13c)],'repositoryGit':_0x579cf3['gitUrl'],'syncRecord':_0x3f3174})[_0xf6b0c8(0x159)](_0x41f108=>this[_0xf6b0c8(0x138)](_0x3f3174,_0x41f108));}}}catch(_0x37322a){this[_0xf6b0c8(0x168)][_0xf6b0c8(0x134)](_0x37322a);_0x37322a instanceof too_many_requests_error_1[_0xf6b0c8(0x105)]?(await this['sfLogger'][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0x149))[_0xf6b0c8(0xf3)](),await(0x0,utils_1['sleep'])(0x3c*0x3c*0x3e8),this['run']()):await this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x134)](this['prefix']+'\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x37322a)['send']();return;}await this[_0xf6b0c8(0xfd)][_0xf6b0c8(0x14e)](this[_0xf6b0c8(0x119)]+_0xf6b0c8(0xf1))['send'](),await this[_0xf6b0c8(0x14b)]['disableSync'](typedi_1[_0xf6b0c8(0x123)][_0xf6b0c8(0x157)](providers_tokens_1[_0xf6b0c8(0x113)][_0xf6b0c8(0x100)]))[_0xf6b0c8(0x159)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a110_0x4c3fff(0x12e)])({'transient':!![]}),__metadata(a110_0x4c3fff(0x156),[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a110_0x4c3fff(0x143)]])],SyncService),exports['SyncService']=SyncService;