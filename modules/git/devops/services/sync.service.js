const a79_0x586591=a79_0x3bc9;(function(_0x16f980,_0xbe2b97){const _0x4d4dad=a79_0x3bc9,_0x50b655=_0x16f980();while(!![]){try{const _0x24a4e2=parseInt(_0x4d4dad(0x1b0))/0x1+-parseInt(_0x4d4dad(0x184))/0x2*(-parseInt(_0x4d4dad(0x1ab))/0x3)+parseInt(_0x4d4dad(0x16b))/0x4*(parseInt(_0x4d4dad(0x16e))/0x5)+parseInt(_0x4d4dad(0x191))/0x6*(parseInt(_0x4d4dad(0x148))/0x7)+-parseInt(_0x4d4dad(0x13f))/0x8+parseInt(_0x4d4dad(0x195))/0x9+-parseInt(_0x4d4dad(0x162))/0xa;if(_0x24a4e2===_0xbe2b97)break;else _0x50b655['push'](_0x50b655['shift']());}catch(_0x5995af){_0x50b655['push'](_0x50b655['shift']());}}}(a79_0x2417,0x729a2));const a79_0x5507c9=(function(){let _0x19e385=!![];return function(_0x2cf093,_0x541527){const _0x206f76=_0x19e385?function(){const _0x5b7fff=a79_0x3bc9;if(_0x541527){const _0x440cfe=_0x541527[_0x5b7fff(0x178)](_0x2cf093,arguments);return _0x541527=null,_0x440cfe;}}:function(){};return _0x19e385=![],_0x206f76;};}()),a79_0x1ee64a=a79_0x5507c9(this,function(){const _0x2e3de4=a79_0x3bc9;return a79_0x1ee64a[_0x2e3de4(0x13a)]()[_0x2e3de4(0x13c)]('(((.+)+)+)+$')[_0x2e3de4(0x13a)]()['constructor'](a79_0x1ee64a)['search'](_0x2e3de4(0x150));});a79_0x1ee64a();'use strict';var __decorate=this&&this[a79_0x586591(0x14d)]||function(_0x33d197,_0x45a76d,_0x45ac27,_0x7ec516){const _0x959500=a79_0x586591;var _0x2ab56d=arguments[_0x959500(0x166)],_0x18385b=_0x2ab56d<0x3?_0x45a76d:_0x7ec516===null?_0x7ec516=Object[_0x959500(0x185)](_0x45a76d,_0x45ac27):_0x7ec516,_0x596224;if(typeof Reflect==='object'&&typeof Reflect[_0x959500(0x19b)]==='function')_0x18385b=Reflect[_0x959500(0x19b)](_0x33d197,_0x45a76d,_0x45ac27,_0x7ec516);else{for(var _0x359040=_0x33d197['length']-0x1;_0x359040>=0x0;_0x359040--)if(_0x596224=_0x33d197[_0x359040])_0x18385b=(_0x2ab56d<0x3?_0x596224(_0x18385b):_0x2ab56d>0x3?_0x596224(_0x45a76d,_0x45ac27,_0x18385b):_0x596224(_0x45a76d,_0x45ac27))||_0x18385b;}return _0x2ab56d>0x3&&_0x18385b&&Object['defineProperty'](_0x45a76d,_0x45ac27,_0x18385b),_0x18385b;},__metadata=this&&this[a79_0x586591(0x17e)]||function(_0xc405a0,_0x23615f){const _0x53538b=a79_0x586591;if(typeof Reflect==='object'&&typeof Reflect[_0x53538b(0x1b1)]===_0x53538b(0x1b3))return Reflect[_0x53538b(0x1b1)](_0xc405a0,_0x23615f);},SyncService_1;Object[a79_0x586591(0x13e)](exports,a79_0x586591(0x151),{'value':!![]}),exports[a79_0x586591(0x187)]=void 0x0;function a79_0x3bc9(_0x29884f,_0xca4d27){const _0x376105=a79_0x2417();return a79_0x3bc9=function(_0x1ee64a,_0x5507c9){_0x1ee64a=_0x1ee64a-0x132;let _0x241723=_0x376105[_0x1ee64a];return _0x241723;},a79_0x3bc9(_0x29884f,_0xca4d27);}const constants_1=require(a79_0x586591(0x15d)),core_1=require(a79_0x586591(0x1b2)),too_many_requests_error_1=require(a79_0x586591(0x16f)),flosum_repository_sync_dto_1=require(a79_0x586591(0x16c)),salesforce_error_1=require(a79_0x586591(0x136)),salesforce_sync_service_1=require(a79_0x586591(0x1a0)),salesforce_service_1=require(a79_0x586591(0x183)),utils_1=require(a79_0x586591(0x153)),typedi_1=require(a79_0x586591(0x18b)),hooks_utils_1=require(a79_0x586591(0x165)),git_branch_not_found_error_1=require(a79_0x586591(0x197)),flosum_sync_job_1=require(a79_0x586591(0x19f)),git_sync_job_1=require(a79_0x586591(0x19a)),providers_tokens_1=require(a79_0x586591(0x15f)),bad_request_error_1=require(a79_0x586591(0x1aa));function a79_0x2417(){const _0x577a76=['gitApiService','19010740QQlSYT','handleRecordSyncError',']\x20[','../../providers/web-hooks/hooks.utils','length','BRANCH_NAME_REGEXP','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','salesforceService','isConvertToSfdx','20xTTdOz','../../salesforce/dto/flosum-repository-sync.dto','disableSync','622785AvpOJH','../../../../core/errors/too-many-requests.error','\x20Stop\x20sync\x20job\x20for\x20\x27','getRepositoryRecords','repoList','\x20Getting\x20repositories\x20from\x20git\x20service.','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','Unable\x20to\x20synchronize\x20repository\x20\x27','sleep','isIntersects','apply','checkValidNaming','getLoggerId',']\x20due\x20error\x20-\x20',']\x20branch.','catch','__metadata','\x20Completed\x20prepare\x20to\x20syncing.','getOrCreateRepo',']\x20repository\x20','\x20No\x20repositories\x20to\x20sync.','../../salesforce/services/salesforce.service','2eaXsuY','getOwnPropertyDescriptor','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','SyncService','TooManyRequests','send','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','typedi','repositoryId','logger','FlosumSyncJob','\x20Getting\x20repository\x20records.','run','12mPlOqq','\x20branches.','hooks','getBranchRecords','6560739HBDSFm','join','../errors/git-branch-not-found.error','design:paramtypes','sfLogger','../jobs/git-sync.job','decorate','Service','repoService','toLowerCase','../jobs/flosum-sync.job','../../salesforce/services/salesforce-sync.service','branchName','getAll','\x20Getting\x20branch\x20records.','prefix','SalesforceService','\x20Have\x20to\x20synchronize\x20','url','BadRequestError','repositoriesIntersections','../../../../core/errors/bad-request.error','765573BpyMdw','updateRemoteState','\x27\x20in\x20repository\x20\x27','salesforceSync','log','786451zKNJhJ','metadata','../../../../core','function','connectionId','\x20Repository\x20\x22','map','HooksUtils','../../salesforce/errors/salesforce.error','SalesforceError','SalesforceSyncService','gitUrl','toString','Not\x20Synchronized','search','\x20Sync\x20job\x20done.','defineProperty','7394384ssMbvi','\x20Getting\x20Flosum\x20repository','error','name','direction','setStatus','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x27\x20[','gitProvider','3154844QCTIfc','Container','\x20Checking\x20valid\x20name.','repositoryName','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','__decorate','REPOSITORY_NAME_REGEXP','getHookLinkFor','(((.+)+)+)+$','__esModule','isBidirectionalSynchronization','../../../shared/utils','push','config','get','Logger','applicationUrl','Waiting','\x27\x20-\x20\x27','SyncDirection','create','../../../../constants','Tokens','../../providers/providers.tokens','gitRepoService'];a79_0x2417=function(){return _0x577a76;};return a79_0x2417();}let SyncService=SyncService_1=class SyncService{constructor(_0x188fac,_0x4eff6a){const _0x569169=a79_0x586591;this[_0x569169(0x169)]=_0x188fac,this[_0x569169(0x1ae)]=_0x4eff6a,this[_0x569169(0x18d)]=new core_1[(_0x569169(0x157))](SyncService_1[_0x569169(0x142)]),this[_0x569169(0x1a9)]={},this[_0x569169(0x172)]=[];}async['handleRecordSyncError'](_0x5b8af5,_0x1f3f58){const _0xe53c72=a79_0x586591;if(_0x1f3f58 instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this['salesforceSync'][_0xe53c72(0x144)](_0x5b8af5,_0xe53c72(0x13b));return;}if(_0x1f3f58 instanceof too_many_requests_error_1['TooManyRequests']){await this['salesforceSync'][_0xe53c72(0x144)](_0x5b8af5,_0xe53c72(0x159));throw _0x1f3f58;}try{await this['sfLogger']['error'](this[_0xe53c72(0x1a4)]+_0xe53c72(0x170)+_0x5b8af5['repositoryName']+_0xe53c72(0x146)+_0x5b8af5[_0xe53c72(0x1a1)]+_0xe53c72(0x17b)+_0x1f3f58+'.')[_0xe53c72(0x189)](),await this[_0xe53c72(0x1ae)][_0xe53c72(0x1ac)](_0x5b8af5,{}),await this[_0xe53c72(0x1ae)][_0xe53c72(0x144)](_0x5b8af5,'Error');}catch(_0x521e79){if(_0x521e79 instanceof salesforce_error_1[_0xe53c72(0x137)])throw _0x521e79;}}async[a79_0x586591(0x177)](_0x1aae99){const _0x313d86=a79_0x586591;if(_0x1aae99[_0x313d86(0x18c)]){const _0x268b40=_0x1aae99[_0x313d86(0x14b)][_0x313d86(0x19e)](),_0x512c78=this[_0x313d86(0x1a9)][_0x268b40];if(!_0x512c78)this[_0x313d86(0x1a9)][_0x268b40]=_0x1aae99[_0x313d86(0x14b)];else{if(_0x512c78&&_0x512c78!==_0x1aae99['repositoryName'])return await this['handleRecordSyncError'](_0x1aae99,new Error(_0x313d86(0x175)+_0x1aae99[_0x313d86(0x14b)]+_0x313d86(0x168)+_0x268b40+_0x313d86(0x15a)+_0x512c78+'\x27')),!![];}}return![];}async[a79_0x586591(0x179)](_0x1f4772){const _0x5855e9=a79_0x586591;if(!constants_1[_0x5855e9(0x14e)]['test'](_0x1f4772[_0x5855e9(0x14b)]))return await this['handleRecordSyncError'](_0x1f4772,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x1f4772['repositoryName']+_0x5855e9(0x14c))),![];if(!constants_1[_0x5855e9(0x167)]['test'](_0x1f4772[_0x5855e9(0x1a1)]))return await this['handleRecordSyncError'](_0x1f4772,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x1f4772['branchName']+_0x5855e9(0x1ad)+_0x1f4772[_0x5855e9(0x14b)]+_0x5855e9(0x145))),![];return!![];}async[a79_0x586591(0x180)](_0x3e573a,_0x515474){const _0x33f346=a79_0x586591;let _0x547bb4=this[_0x33f346(0x172)]['find'](_0x37f712=>_0x3e573a[_0x33f346(0x14b)]===_0x37f712['name']);!_0x547bb4&&(this[_0x33f346(0x199)]['log'](this[_0x33f346(0x1a4)]+_0x33f346(0x133)+_0x3e573a[_0x33f346(0x14b)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x547bb4=await this[_0x33f346(0x19d)][_0x33f346(0x15c)]({'name':_0x3e573a[_0x33f346(0x14b)],'autoInit':!![],'defaultBranch':_0x3e573a['branchName'],'private':!![],'createHook':typedi_1[_0x33f346(0x149)]['get'](providers_tokens_1[_0x33f346(0x15e)][_0x33f346(0x155)])[_0x33f346(0x152)]}));if(this[_0x33f346(0x155)][_0x33f346(0x152)]){const _0x52ea43=await _0x547bb4[_0x33f346(0x193)]['getAll']();!_0x52ea43['find'](_0xf4bfe4=>_0xf4bfe4[_0x33f346(0x1a7)]===hooks_utils_1[_0x33f346(0x135)][_0x33f346(0x14f)](this[_0x33f346(0x155)]['gitProvider'],this[_0x33f346(0x155)][_0x33f346(0x158)],_0x515474))&&(this['sfLogger']['log'](this[_0x33f346(0x1a4)]+_0x33f346(0x133)+_0x3e573a[_0x33f346(0x14b)]+_0x33f346(0x174)),await _0x547bb4[_0x33f346(0x193)][_0x33f346(0x15c)](hooks_utils_1[_0x33f346(0x135)]['createHookPayload'](this[_0x33f346(0x155)][_0x33f346(0x147)],_0x547bb4[_0x33f346(0x193)],this[_0x33f346(0x155)][_0x33f346(0x158)],_0x515474)));}return this[_0x33f346(0x172)][_0x33f346(0x154)](_0x547bb4),_0x547bb4;}async['run'](){const _0x3fa46a=a79_0x586591;this[_0x3fa46a(0x161)]=typedi_1[_0x3fa46a(0x149)][_0x3fa46a(0x156)](providers_tokens_1[_0x3fa46a(0x15e)]['gitApiService']),this[_0x3fa46a(0x19d)]=typedi_1[_0x3fa46a(0x149)]['get'](providers_tokens_1[_0x3fa46a(0x15e)][_0x3fa46a(0x160)]),this[_0x3fa46a(0x155)]=typedi_1[_0x3fa46a(0x149)]['get'](providers_tokens_1[_0x3fa46a(0x15e)][_0x3fa46a(0x155)]),this['sfLogger']=typedi_1['Container']['get'](providers_tokens_1[_0x3fa46a(0x15e)][_0x3fa46a(0x18d)]),this[_0x3fa46a(0x1a4)]='['+SyncService_1[_0x3fa46a(0x142)]+_0x3fa46a(0x164)+this[_0x3fa46a(0x155)][_0x3fa46a(0x147)]['toUpperCase']()+']',this[_0x3fa46a(0x169)]['setLoggerId'](this[_0x3fa46a(0x199)][_0x3fa46a(0x17a)]());try{this[_0x3fa46a(0x199)][_0x3fa46a(0x1af)](this['prefix']+'\x20Start\x20sync\x20job.'),await this['sfLogger'][_0x3fa46a(0x1af)](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x18f))['send']();const _0x1dca44=await this['salesforceSync'][_0x3fa46a(0x171)](typedi_1[_0x3fa46a(0x149)]['get'](providers_tokens_1['Tokens']['connectionId']));if(!_0x1dca44['length'])throw new bad_request_error_1[(_0x3fa46a(0x1a8))](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x182));await this[_0x3fa46a(0x199)][_0x3fa46a(0x1af)](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x1a3))[_0x3fa46a(0x189)]();const _0x216933=await this['salesforceSync'][_0x3fa46a(0x194)](_0x1dca44[_0x3fa46a(0x134)](_0x2752c3=>'\x27'+_0x2752c3[_0x3fa46a(0x18c)]+'\x27')[_0x3fa46a(0x196)](','));await this[_0x3fa46a(0x199)]['log'](this['prefix']+_0x3fa46a(0x173))['send'](),this[_0x3fa46a(0x172)]=await this['repoService'][_0x3fa46a(0x1a2)]();const _0x4c490d=[..._0x1dca44,..._0x216933];this[_0x3fa46a(0x199)]['log'](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x1a6)+_0x4c490d['length']+_0x3fa46a(0x192));for(const _0x2fae8a of _0x4c490d){this[_0x3fa46a(0x18d)][_0x3fa46a(0x1af)]('Syncing\x20'+_0x2fae8a[_0x3fa46a(0x14b)]+'['+_0x2fae8a['repositoryId']+_0x3fa46a(0x181)+_0x2fae8a[_0x3fa46a(0x1a1)]+'['+_0x2fae8a['branchId']+_0x3fa46a(0x17c)),this[_0x3fa46a(0x199)][_0x3fa46a(0x1af)](this[_0x3fa46a(0x1a4)]+'\x20Syncing\x20repository:\x20\x22'+_0x2fae8a[_0x3fa46a(0x14b)]+'\x22\x20branch:\x20\x22'+_0x2fae8a[_0x3fa46a(0x1a1)]+'\x22.'),this[_0x3fa46a(0x199)][_0x3fa46a(0x1af)](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x14a));const _0x2c70fc=await this[_0x3fa46a(0x179)](_0x2fae8a);if(!_0x2c70fc)continue;this['sfLogger']['log'](this[_0x3fa46a(0x1a4)]+'\x20Checking\x20intersects.');const _0x789e0=await this[_0x3fa46a(0x177)](_0x2fae8a);if(_0x789e0)continue;await this[_0x3fa46a(0x199)][_0x3fa46a(0x189)]();let _0x106f6b;try{await this['sfLogger'][_0x3fa46a(0x1af)](this['prefix']+_0x3fa46a(0x140))[_0x3fa46a(0x189)](),_0x106f6b=await this[_0x3fa46a(0x180)](_0x2fae8a,typedi_1[_0x3fa46a(0x149)][_0x3fa46a(0x156)](providers_tokens_1[_0x3fa46a(0x15e)][_0x3fa46a(0x132)]));}catch(_0x3c0f98){await this[_0x3fa46a(0x163)](_0x2fae8a,_0x3c0f98 instanceof too_many_requests_error_1[_0x3fa46a(0x188)]?_0x3c0f98:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x3c0f98));continue;}await this[_0x3fa46a(0x199)][_0x3fa46a(0x1af)](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x17f))[_0x3fa46a(0x189)]();if(_0x2fae8a[_0x3fa46a(0x143)]===flosum_repository_sync_dto_1[_0x3fa46a(0x15b)]['FlosumToGit']){const _0x162127=typedi_1[_0x3fa46a(0x149)][_0x3fa46a(0x156)](flosum_sync_job_1[_0x3fa46a(0x18e)]);await _0x162127[_0x3fa46a(0x190)]({'repository':_0x106f6b,'convertToSFDX':this['config'][_0x3fa46a(0x16a)],'syncRecord':_0x2fae8a,'provider':this[_0x3fa46a(0x155)][_0x3fa46a(0x147)]})[_0x3fa46a(0x17d)](_0x5e48b0=>this[_0x3fa46a(0x163)](_0x2fae8a,_0x5e48b0));}else{const _0x387392=typedi_1['Container'][_0x3fa46a(0x156)](git_sync_job_1['GitSyncJob']);await _0x387392['run']({'repository':_0x106f6b,'branch':_0x2fae8a[_0x3fa46a(0x1a1)],'provider':this[_0x3fa46a(0x155)][_0x3fa46a(0x147)],'repositoryGit':_0x106f6b[_0x3fa46a(0x139)],'syncRecord':_0x2fae8a})[_0x3fa46a(0x17d)](_0x233067=>this[_0x3fa46a(0x163)](_0x2fae8a,_0x233067));}}}catch(_0x31d07c){this[_0x3fa46a(0x18d)][_0x3fa46a(0x141)](_0x31d07c);_0x31d07c instanceof too_many_requests_error_1[_0x3fa46a(0x188)]?(await this['sfLogger'][_0x3fa46a(0x1af)](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x18a))[_0x3fa46a(0x189)](),await(0x0,utils_1[_0x3fa46a(0x176)])(0x3c*0x3c*0x3e8),this[_0x3fa46a(0x190)]()):await this[_0x3fa46a(0x199)][_0x3fa46a(0x141)](this[_0x3fa46a(0x1a4)]+_0x3fa46a(0x186)+_0x31d07c)[_0x3fa46a(0x189)]();return;}await this[_0x3fa46a(0x199)][_0x3fa46a(0x1af)](this['prefix']+_0x3fa46a(0x13d))[_0x3fa46a(0x189)](),await this[_0x3fa46a(0x1ae)][_0x3fa46a(0x16d)](typedi_1[_0x3fa46a(0x149)][_0x3fa46a(0x156)](providers_tokens_1[_0x3fa46a(0x15e)]['connectionId']))[_0x3fa46a(0x17d)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a79_0x586591(0x19c)])({'transient':!![]}),__metadata(a79_0x586591(0x198),[salesforce_service_1[a79_0x586591(0x1a5)],salesforce_sync_service_1[a79_0x586591(0x138)]])],SyncService),exports[a79_0x586591(0x187)]=SyncService;