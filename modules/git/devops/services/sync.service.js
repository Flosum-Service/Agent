const a111_0x15755d=a111_0x3d1d;function a111_0x12c0(){const _0x211e7e=['metadata','\x27\x20in\x20repository\x20\x27','setStatus','55013030mBrbKi','branchName','connectionId','catch','18330DyLYsc','getHookLinkFor','../../../../core/errors/bad-request.error','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','repoList','decorate','getLoggerId','\x20Start\x20sync\x20job.','map','run','typedi','updateRemoteState','prefix','5220744BWnpyY','\x20Getting\x20Flosum\x20repository','../../../../constants','repoService','sleep','create','search','Unable\x20to\x20synchronize\x20repository\x20\x27','Service','../../../shared/utils','salesforceSync','../../salesforce/services/salesforce.service','../../../../core','390890WMOmui','BRANCH_NAME_REGEXP','push','test',']\x20due\x20error\x20-\x20','applicationUrl','\x20Stop\x20sync\x20job\x20for\x20\x27','handleRecordSyncError','repositoryName','5771763vXgTLE','isIntersects','\x20Getting\x20branch\x20records.','setLoggerId','490mVaMvn','sfLogger','checkValidNaming','name','salesforceService','Error','getOwnPropertyDescriptor','Container','171lNhhLm','../jobs/git-sync.job','GitSyncJob','log','Not\x20Synchronized','getOrCreateRepo','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','../../salesforce/errors/salesforce.error','config','get','../../../../core/errors/too-many-requests.error','\x20Sync\x20job\x20done.','SalesforceService','\x27\x20-\x20\x27','isConvertToSfdx','createHookPayload','getRepositoryRecords','FlosumToGit','repositoryId','send','hooks','../errors/git-branch-not-found.error','toUpperCase','length','direction','object',']\x20[','\x22\x20branch:\x20\x22','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','\x20Getting\x20repositories\x20from\x20git\x20service.','../jobs/flosum-sync.job','8NCKIqD','function','BadRequestError','HooksUtils','Logger','__decorate','isBidirectionalSynchronization','getAll','(((.+)+)+)+$','repositoriesIntersections','\x20Checking\x20valid\x20name.','Unable\x20to\x20synchronize\x20branch\x20\x27','toString','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','36324sfjjVP','find','5652305LfJZBo',']\x20branch.','gitRepoService','Syncing\x20','logger','error','\x20Checking\x20intersects.','\x20Have\x20to\x20synchronize\x20','disableSync','REPOSITORY_NAME_REGEXP','__metadata','\x20No\x20repositories\x20to\x20sync.','\x20Getting\x20repository\x20records.','design:paramtypes','TooManyRequests','toLowerCase','gitApiService','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.',']\x20repository\x20','SyncDirection','\x20Repository\x20\x22','\x20Syncing\x20repository:\x20\x22','gitProvider','\x20Completed\x20prepare\x20to\x20syncing.','Tokens','SyncService','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','defineProperty','SalesforceError'];a111_0x12c0=function(){return _0x211e7e;};return a111_0x12c0();}(function(_0x235b87,_0x258101){const _0x4c91ff=a111_0x3d1d,_0x16f3c9=_0x235b87();while(!![]){try{const _0x3d7811=-parseInt(_0x4c91ff(0x1d4))/0x1*(parseInt(_0x4c91ff(0x186))/0x2)+-parseInt(_0x4c91ff(0x1e9))/0x3*(parseInt(_0x4c91ff(0x194))/0x4)+-parseInt(_0x4c91ff(0x196))/0x5+parseInt(_0x4c91ff(0x1ba))/0x6*(-parseInt(_0x4c91ff(0x1e1))/0x7)+-parseInt(_0x4c91ff(0x1c7))/0x8+-parseInt(_0x4c91ff(0x1dd))/0x9+parseInt(_0x4c91ff(0x1b6))/0xa;if(_0x3d7811===_0x258101)break;else _0x16f3c9['push'](_0x16f3c9['shift']());}catch(_0x18adab){_0x16f3c9['push'](_0x16f3c9['shift']());}}}(a111_0x12c0,0xbee5b));const a111_0x1f61c5=(function(){let _0x230055=!![];return function(_0x2123ce,_0x443abf){const _0x3f1d47=_0x230055?function(){if(_0x443abf){const _0x197303=_0x443abf['apply'](_0x2123ce,arguments);return _0x443abf=null,_0x197303;}}:function(){};return _0x230055=![],_0x3f1d47;};}()),a111_0xf29d09=a111_0x1f61c5(this,function(){const _0x250392=a111_0x3d1d;return a111_0xf29d09[_0x250392(0x192)]()[_0x250392(0x1cd)](_0x250392(0x18e))[_0x250392(0x192)]()['constructor'](a111_0xf29d09)[_0x250392(0x1cd)](_0x250392(0x18e));});a111_0xf29d09();function a111_0x3d1d(_0x13fcc1,_0x377732){const _0x59c91e=a111_0x12c0();return a111_0x3d1d=function(_0xf29d09,_0x1f61c5){_0xf29d09=_0xf29d09-0x180;let _0x12c058=_0x59c91e[_0xf29d09];return _0x12c058;},a111_0x3d1d(_0x13fcc1,_0x377732);}'use strict';var __decorate=this&&this[a111_0x15755d(0x18b)]||function(_0x51f747,_0x5727a6,_0x34a963,_0x5ec6a1){const _0x5f12d7=a111_0x15755d;var _0x473345=arguments[_0x5f12d7(0x200)],_0x5d1687=_0x473345<0x3?_0x5727a6:_0x5ec6a1===null?_0x5ec6a1=Object[_0x5f12d7(0x1e7)](_0x5727a6,_0x34a963):_0x5ec6a1,_0x44f6a8;if(typeof Reflect===_0x5f12d7(0x180)&&typeof Reflect[_0x5f12d7(0x1bf)]===_0x5f12d7(0x187))_0x5d1687=Reflect[_0x5f12d7(0x1bf)](_0x51f747,_0x5727a6,_0x34a963,_0x5ec6a1);else{for(var _0x5c9846=_0x51f747[_0x5f12d7(0x200)]-0x1;_0x5c9846>=0x0;_0x5c9846--)if(_0x44f6a8=_0x51f747[_0x5c9846])_0x5d1687=(_0x473345<0x3?_0x44f6a8(_0x5d1687):_0x473345>0x3?_0x44f6a8(_0x5727a6,_0x34a963,_0x5d1687):_0x44f6a8(_0x5727a6,_0x34a963))||_0x5d1687;}return _0x473345>0x3&&_0x5d1687&&Object['defineProperty'](_0x5727a6,_0x34a963,_0x5d1687),_0x5d1687;},__metadata=this&&this[a111_0x15755d(0x1a0)]||function(_0x109549,_0x17e4fb){const _0x1f5bb4=a111_0x15755d;if(typeof Reflect===_0x1f5bb4(0x180)&&typeof Reflect[_0x1f5bb4(0x1b3)]===_0x1f5bb4(0x187))return Reflect[_0x1f5bb4(0x1b3)](_0x109549,_0x17e4fb);},SyncService_1;Object[a111_0x15755d(0x1b1)](exports,'__esModule',{'value':!![]}),exports[a111_0x15755d(0x1af)]=void 0x0;const constants_1=require(a111_0x15755d(0x1c9)),core_1=require(a111_0x15755d(0x1d3)),too_many_requests_error_1=require(a111_0x15755d(0x1f3)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a111_0x15755d(0x1f0)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a111_0x15755d(0x1d2)),utils_1=require(a111_0x15755d(0x1d0)),typedi_1=require(a111_0x15755d(0x1c4)),hooks_utils_1=require('../../providers/web-hooks/hooks.utils'),git_branch_not_found_error_1=require(a111_0x15755d(0x1fe)),flosum_sync_job_1=require(a111_0x15755d(0x185)),git_sync_job_1=require(a111_0x15755d(0x1ea)),providers_tokens_1=require('../../providers/providers.tokens'),bad_request_error_1=require(a111_0x15755d(0x1bc));let SyncService=SyncService_1=class SyncService{constructor(_0x430d6a,_0x3bd946){const _0xbeb8a0=a111_0x15755d;this[_0xbeb8a0(0x1e5)]=_0x430d6a,this[_0xbeb8a0(0x1d1)]=_0x3bd946,this[_0xbeb8a0(0x19a)]=new core_1[(_0xbeb8a0(0x18a))](SyncService_1['name']),this[_0xbeb8a0(0x18f)]={},this[_0xbeb8a0(0x1be)]=[];}async[a111_0x15755d(0x1db)](_0x586f4c,_0x2e25bc){const _0xfd13eb=a111_0x15755d;if(_0x2e25bc instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this['salesforceSync']['setStatus'](_0x586f4c,_0xfd13eb(0x1ed));return;}if(_0x2e25bc instanceof too_many_requests_error_1[_0xfd13eb(0x1a4)]){await this[_0xfd13eb(0x1d1)][_0xfd13eb(0x1b5)](_0x586f4c,'Waiting');throw _0x2e25bc;}try{await this[_0xfd13eb(0x1e2)][_0xfd13eb(0x19b)](this[_0xfd13eb(0x1c6)]+_0xfd13eb(0x1da)+_0x586f4c[_0xfd13eb(0x1dc)]+'\x27\x20['+_0x586f4c[_0xfd13eb(0x1b7)]+_0xfd13eb(0x1d8)+_0x2e25bc+'.')[_0xfd13eb(0x1fc)](),await this['salesforceSync'][_0xfd13eb(0x1c5)](_0x586f4c,{}),await this['salesforceSync']['setStatus'](_0x586f4c,_0xfd13eb(0x1e6));}catch(_0x30e7aa){if(_0x30e7aa instanceof salesforce_error_1[_0xfd13eb(0x1b2)])throw _0x30e7aa;}}async[a111_0x15755d(0x1de)](_0x25c663){const _0x3efdb7=a111_0x15755d;if(_0x25c663[_0x3efdb7(0x1fb)]){const _0x3cfce1=_0x25c663[_0x3efdb7(0x1dc)][_0x3efdb7(0x1a5)](),_0x551d6a=this[_0x3efdb7(0x18f)][_0x3cfce1];if(!_0x551d6a)this[_0x3efdb7(0x18f)][_0x3cfce1]=_0x25c663[_0x3efdb7(0x1dc)];else{if(_0x551d6a&&_0x551d6a!==_0x25c663[_0x3efdb7(0x1dc)])return await this[_0x3efdb7(0x1db)](_0x25c663,new Error(_0x3efdb7(0x1ce)+_0x25c663['repositoryName']+_0x3efdb7(0x1ef)+_0x3cfce1+_0x3efdb7(0x1f6)+_0x551d6a+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x3c0f33){const _0x3eb96b=a111_0x15755d;if(!constants_1[_0x3eb96b(0x19f)]['test'](_0x3c0f33[_0x3eb96b(0x1dc)]))return await this[_0x3eb96b(0x1db)](_0x3c0f33,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x3c0f33[_0x3eb96b(0x1dc)]+_0x3eb96b(0x193))),![];if(!constants_1[_0x3eb96b(0x1d5)][_0x3eb96b(0x1d7)](_0x3c0f33[_0x3eb96b(0x1b7)]))return await this[_0x3eb96b(0x1db)](_0x3c0f33,new Error(_0x3eb96b(0x191)+_0x3c0f33[_0x3eb96b(0x1b7)]+_0x3eb96b(0x1b4)+_0x3c0f33['repositoryName']+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a111_0x15755d(0x1ee)](_0x449085,_0x46dedf){const _0x4c6097=a111_0x15755d;let _0x2d5076=this[_0x4c6097(0x1be)][_0x4c6097(0x195)](_0x5108f5=>_0x449085['repositoryName']===_0x5108f5[_0x4c6097(0x1e4)]);!_0x2d5076&&(this[_0x4c6097(0x1e2)]['log'](this['prefix']+_0x4c6097(0x1aa)+_0x449085['repositoryName']+_0x4c6097(0x1b0)),_0x2d5076=await this[_0x4c6097(0x1ca)][_0x4c6097(0x1cc)]({'name':_0x449085[_0x4c6097(0x1dc)],'autoInit':!![],'defaultBranch':_0x449085['branchName'],'private':!![],'createHook':typedi_1[_0x4c6097(0x1e8)][_0x4c6097(0x1f2)](providers_tokens_1[_0x4c6097(0x1ae)][_0x4c6097(0x1f1)])[_0x4c6097(0x18c)]}));if(this['config'][_0x4c6097(0x18c)]){const _0x34aa87=await _0x2d5076['hooks']['getAll']();!_0x34aa87[_0x4c6097(0x195)](_0x557418=>_0x557418['url']===hooks_utils_1[_0x4c6097(0x189)][_0x4c6097(0x1bb)](this[_0x4c6097(0x1f1)]['gitProvider'],this[_0x4c6097(0x1f1)][_0x4c6097(0x1d9)],_0x46dedf))&&(this[_0x4c6097(0x1e2)][_0x4c6097(0x1ec)](this['prefix']+_0x4c6097(0x1aa)+_0x449085[_0x4c6097(0x1dc)]+_0x4c6097(0x1a7)),await _0x2d5076[_0x4c6097(0x1fd)]['create'](hooks_utils_1[_0x4c6097(0x189)][_0x4c6097(0x1f8)](this[_0x4c6097(0x1f1)][_0x4c6097(0x1ac)],_0x2d5076[_0x4c6097(0x1fd)],this['config'][_0x4c6097(0x1d9)],_0x46dedf)));}return this[_0x4c6097(0x1be)][_0x4c6097(0x1d6)](_0x2d5076),_0x2d5076;}async[a111_0x15755d(0x1c3)](){const _0x435c13=a111_0x15755d;this[_0x435c13(0x1a6)]=typedi_1[_0x435c13(0x1e8)]['get'](providers_tokens_1[_0x435c13(0x1ae)][_0x435c13(0x1a6)]),this[_0x435c13(0x1ca)]=typedi_1['Container'][_0x435c13(0x1f2)](providers_tokens_1[_0x435c13(0x1ae)][_0x435c13(0x198)]),this[_0x435c13(0x1f1)]=typedi_1[_0x435c13(0x1e8)]['get'](providers_tokens_1[_0x435c13(0x1ae)][_0x435c13(0x1f1)]),this[_0x435c13(0x1e2)]=typedi_1[_0x435c13(0x1e8)]['get'](providers_tokens_1[_0x435c13(0x1ae)]['logger']),this['prefix']='['+SyncService_1[_0x435c13(0x1e4)]+_0x435c13(0x181)+this[_0x435c13(0x1f1)][_0x435c13(0x1ac)][_0x435c13(0x1ff)]()+']',this[_0x435c13(0x1e5)][_0x435c13(0x1e0)](this[_0x435c13(0x1e2)][_0x435c13(0x1c0)]());try{this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x1c1)),await this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x1a2))[_0x435c13(0x1fc)]();const _0x5b0ce6=await this[_0x435c13(0x1d1)][_0x435c13(0x1f9)](typedi_1[_0x435c13(0x1e8)][_0x435c13(0x1f2)](providers_tokens_1[_0x435c13(0x1ae)][_0x435c13(0x1b8)]));if(!_0x5b0ce6[_0x435c13(0x200)])throw new bad_request_error_1[(_0x435c13(0x188))](this[_0x435c13(0x1c6)]+_0x435c13(0x1a1));await this['sfLogger'][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x1df))['send']();const _0x47e6a1=await this['salesforceSync']['getBranchRecords'](_0x5b0ce6[_0x435c13(0x1c2)](_0x33f864=>'\x27'+_0x33f864[_0x435c13(0x1fb)]+'\x27')['join'](','));await this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x184))[_0x435c13(0x1fc)](),this[_0x435c13(0x1be)]=await this[_0x435c13(0x1ca)][_0x435c13(0x18d)]();const _0x10aebf=[..._0x5b0ce6,..._0x47e6a1];this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x19d)+_0x10aebf[_0x435c13(0x200)]+'\x20branches.');for(const _0x30bceb of _0x10aebf){this[_0x435c13(0x19a)][_0x435c13(0x1ec)](_0x435c13(0x199)+_0x30bceb[_0x435c13(0x1dc)]+'['+_0x30bceb[_0x435c13(0x1fb)]+_0x435c13(0x1a8)+_0x30bceb[_0x435c13(0x1b7)]+'['+_0x30bceb['branchId']+_0x435c13(0x197)),this['sfLogger'][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x1ab)+_0x30bceb['repositoryName']+_0x435c13(0x182)+_0x30bceb[_0x435c13(0x1b7)]+'\x22.'),this['sfLogger'][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x190));const _0x53cf05=await this[_0x435c13(0x1e3)](_0x30bceb);if(!_0x53cf05)continue;this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x19c));const _0xc42428=await this[_0x435c13(0x1de)](_0x30bceb);if(_0xc42428)continue;await this[_0x435c13(0x1e2)][_0x435c13(0x1fc)]();let _0x3ff13a;try{await this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x1c8))[_0x435c13(0x1fc)](),_0x3ff13a=await this[_0x435c13(0x1ee)](_0x30bceb,typedi_1[_0x435c13(0x1e8)][_0x435c13(0x1f2)](providers_tokens_1[_0x435c13(0x1ae)][_0x435c13(0x1b8)]));}catch(_0x302f36){await this[_0x435c13(0x1db)](_0x30bceb,_0x302f36 instanceof too_many_requests_error_1[_0x435c13(0x1a4)]?_0x302f36:new Error(_0x435c13(0x1bd)+_0x302f36));continue;}await this[_0x435c13(0x1e2)]['log'](this[_0x435c13(0x1c6)]+_0x435c13(0x1ad))[_0x435c13(0x1fc)]();if(_0x30bceb[_0x435c13(0x201)]===flosum_repository_sync_dto_1[_0x435c13(0x1a9)][_0x435c13(0x1fa)]){const _0x18752c=typedi_1[_0x435c13(0x1e8)][_0x435c13(0x1f2)](flosum_sync_job_1['FlosumSyncJob']);await _0x18752c[_0x435c13(0x1c3)]({'repository':_0x3ff13a,'convertToSFDX':this['config'][_0x435c13(0x1f7)],'syncRecord':_0x30bceb,'provider':this[_0x435c13(0x1f1)][_0x435c13(0x1ac)]})[_0x435c13(0x1b9)](_0x3c1aa3=>this['handleRecordSyncError'](_0x30bceb,_0x3c1aa3));}else{const _0x59acad=typedi_1[_0x435c13(0x1e8)][_0x435c13(0x1f2)](git_sync_job_1[_0x435c13(0x1eb)]);await _0x59acad[_0x435c13(0x1c3)]({'repository':_0x3ff13a,'branch':_0x30bceb[_0x435c13(0x1b7)],'provider':this[_0x435c13(0x1f1)][_0x435c13(0x1ac)],'repositoryGit':_0x3ff13a['gitUrl'],'syncRecord':_0x30bceb})[_0x435c13(0x1b9)](_0x3b6881=>this['handleRecordSyncError'](_0x30bceb,_0x3b6881));}}}catch(_0x3b01cb){this[_0x435c13(0x19a)][_0x435c13(0x19b)](_0x3b01cb);_0x3b01cb instanceof too_many_requests_error_1['TooManyRequests']?(await this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+'\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')[_0x435c13(0x1fc)](),await(0x0,utils_1[_0x435c13(0x1cb)])(0x3c*0x3c*0x3e8),this['run']()):await this['sfLogger']['error'](this[_0x435c13(0x1c6)]+_0x435c13(0x183)+_0x3b01cb)[_0x435c13(0x1fc)]();return;}await this[_0x435c13(0x1e2)][_0x435c13(0x1ec)](this[_0x435c13(0x1c6)]+_0x435c13(0x1f4))[_0x435c13(0x1fc)](),await this['salesforceSync'][_0x435c13(0x19e)](typedi_1[_0x435c13(0x1e8)][_0x435c13(0x1f2)](providers_tokens_1[_0x435c13(0x1ae)][_0x435c13(0x1b8)]))[_0x435c13(0x1b9)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x15755d(0x1cf)])({'transient':!![]}),__metadata(a111_0x15755d(0x1a3),[salesforce_service_1[a111_0x15755d(0x1f5)],salesforce_sync_service_1['SalesforceSyncService']])],SyncService),exports['SyncService']=SyncService;