const a111_0x5eddeb=a111_0xfc0a;(function(_0x5799eb,_0x11a63b){const _0x2f689a=a111_0xfc0a,_0x4c439c=_0x5799eb();while(!![]){try{const _0x3c5fa1=parseInt(_0x2f689a(0x1f1))/0x1*(-parseInt(_0x2f689a(0x1ed))/0x2)+parseInt(_0x2f689a(0x214))/0x3*(parseInt(_0x2f689a(0x22b))/0x4)+-parseInt(_0x2f689a(0x221))/0x5+parseInt(_0x2f689a(0x1c4))/0x6+-parseInt(_0x2f689a(0x22a))/0x7+parseInt(_0x2f689a(0x217))/0x8+parseInt(_0x2f689a(0x1ea))/0x9;if(_0x3c5fa1===_0x11a63b)break;else _0x4c439c['push'](_0x4c439c['shift']());}catch(_0x421fe4){_0x4c439c['push'](_0x4c439c['shift']());}}}(a111_0x2569,0x967f2));const a111_0xe88329=(function(){let _0x1769d2=!![];return function(_0x2d2099,_0x546ec8){const _0x3e093a=_0x1769d2?function(){const _0x6a9b30=a111_0xfc0a;if(_0x546ec8){const _0x1d9eb1=_0x546ec8[_0x6a9b30(0x20d)](_0x2d2099,arguments);return _0x546ec8=null,_0x1d9eb1;}}:function(){};return _0x1769d2=![],_0x3e093a;};}()),a111_0x36cb54=a111_0xe88329(this,function(){const _0xfb6183=a111_0xfc0a;return a111_0x36cb54[_0xfb6183(0x1be)]()[_0xfb6183(0x1df)](_0xfb6183(0x208))[_0xfb6183(0x1be)]()['constructor'](a111_0x36cb54)[_0xfb6183(0x1df)](_0xfb6183(0x208));});a111_0x36cb54();'use strict';var __decorate=this&&this[a111_0x5eddeb(0x1c7)]||function(_0x4e5cc7,_0x2baa6a,_0x1be412,_0x38baec){const _0x47a6fe=a111_0x5eddeb;var _0x253eb8=arguments[_0x47a6fe(0x237)],_0x28eed9=_0x253eb8<0x3?_0x2baa6a:_0x38baec===null?_0x38baec=Object['getOwnPropertyDescriptor'](_0x2baa6a,_0x1be412):_0x38baec,_0x2ae373;if(typeof Reflect===_0x47a6fe(0x223)&&typeof Reflect['decorate']===_0x47a6fe(0x231))_0x28eed9=Reflect[_0x47a6fe(0x1de)](_0x4e5cc7,_0x2baa6a,_0x1be412,_0x38baec);else{for(var _0x46e5bc=_0x4e5cc7['length']-0x1;_0x46e5bc>=0x0;_0x46e5bc--)if(_0x2ae373=_0x4e5cc7[_0x46e5bc])_0x28eed9=(_0x253eb8<0x3?_0x2ae373(_0x28eed9):_0x253eb8>0x3?_0x2ae373(_0x2baa6a,_0x1be412,_0x28eed9):_0x2ae373(_0x2baa6a,_0x1be412))||_0x28eed9;}return _0x253eb8>0x3&&_0x28eed9&&Object[_0x47a6fe(0x222)](_0x2baa6a,_0x1be412,_0x28eed9),_0x28eed9;},__metadata=this&&this[a111_0x5eddeb(0x1fb)]||function(_0x249ac1,_0x4547fe){const _0xee0a31=a111_0x5eddeb;if(typeof Reflect===_0xee0a31(0x223)&&typeof Reflect[_0xee0a31(0x1cc)]===_0xee0a31(0x231))return Reflect[_0xee0a31(0x1cc)](_0x249ac1,_0x4547fe);},SyncService_1;Object[a111_0x5eddeb(0x222)](exports,a111_0x5eddeb(0x1ff),{'value':!![]}),exports[a111_0x5eddeb(0x229)]=void 0x0;const constants_1=require(a111_0x5eddeb(0x1c1)),core_1=require(a111_0x5eddeb(0x1bc)),too_many_requests_error_1=require('../../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a111_0x5eddeb(0x1f4)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a111_0x5eddeb(0x1d3)),utils_1=require(a111_0x5eddeb(0x1e7)),typedi_1=require(a111_0x5eddeb(0x212)),hooks_utils_1=require(a111_0x5eddeb(0x1f6)),git_branch_not_found_error_1=require(a111_0x5eddeb(0x22f)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a111_0x5eddeb(0x227)),providers_tokens_1=require(a111_0x5eddeb(0x1e6)),bad_request_error_1=require(a111_0x5eddeb(0x1e2));let SyncService=SyncService_1=class SyncService{constructor(_0x46d08b,_0x3a5399){const _0x5915ff=a111_0x5eddeb;this[_0x5915ff(0x1f9)]=_0x46d08b,this[_0x5915ff(0x22e)]=_0x3a5399,this[_0x5915ff(0x203)]=new core_1[(_0x5915ff(0x230))](SyncService_1[_0x5915ff(0x1f5)]),this['repositoriesIntersections']={},this[_0x5915ff(0x235)]=[];}async[a111_0x5eddeb(0x1f7)](_0x25f044,_0x1235de){const _0x485196=a111_0x5eddeb;if(_0x1235de instanceof git_branch_not_found_error_1[_0x485196(0x21a)]){await this[_0x485196(0x22e)][_0x485196(0x1e8)](_0x25f044,_0x485196(0x1c6));return;}if(_0x1235de instanceof too_many_requests_error_1[_0x485196(0x1dd)]){await this[_0x485196(0x22e)][_0x485196(0x1e8)](_0x25f044,_0x485196(0x204));throw _0x1235de;}try{await this[_0x485196(0x1bf)][_0x485196(0x226)](this[_0x485196(0x1fa)]+_0x485196(0x1f8)+_0x25f044[_0x485196(0x21c)]+_0x485196(0x20c)+_0x25f044[_0x485196(0x1ef)]+_0x485196(0x1c8)+_0x1235de+'.')[_0x485196(0x220)](),await this[_0x485196(0x22e)][_0x485196(0x1cf)](_0x25f044,{}),await this[_0x485196(0x22e)][_0x485196(0x1e8)](_0x25f044,'Error');}catch(_0x418864){if(_0x418864 instanceof salesforce_error_1[_0x485196(0x1d9)])throw _0x418864;}}async['isIntersects'](_0x107665){const _0x416a6b=a111_0x5eddeb;if(_0x107665[_0x416a6b(0x1c3)]){const _0x560d8b=_0x107665[_0x416a6b(0x21c)][_0x416a6b(0x207)](),_0x126577=this['repositoriesIntersections'][_0x560d8b];if(!_0x126577)this[_0x416a6b(0x1fe)][_0x560d8b]=_0x107665[_0x416a6b(0x21c)];else{if(_0x126577&&_0x126577!==_0x107665[_0x416a6b(0x21c)])return await this['handleRecordSyncError'](_0x107665,new Error(_0x416a6b(0x1c5)+_0x107665[_0x416a6b(0x21c)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x560d8b+_0x416a6b(0x1e1)+_0x126577+'\x27')),!![];}}return![];}async[a111_0x5eddeb(0x232)](_0x134480){const _0x1901e7=a111_0x5eddeb;if(!constants_1[_0x1901e7(0x21e)][_0x1901e7(0x20a)](_0x134480[_0x1901e7(0x21c)]))return await this[_0x1901e7(0x1f7)](_0x134480,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x134480[_0x1901e7(0x21c)]+_0x1901e7(0x209))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x1901e7(0x20a)](_0x134480['branchName']))return await this[_0x1901e7(0x1f7)](_0x134480,new Error(_0x1901e7(0x22d)+_0x134480[_0x1901e7(0x1ef)]+_0x1901e7(0x22c)+_0x134480['repositoryName']+_0x1901e7(0x1d4))),![];return!![];}async[a111_0x5eddeb(0x216)](_0x938410,_0x59a295){const _0x2909d2=a111_0x5eddeb;let _0x3a5a00=this[_0x2909d2(0x235)][_0x2909d2(0x1db)](_0x5e5b09=>_0x938410[_0x2909d2(0x21c)]===_0x5e5b09[_0x2909d2(0x1f5)]);!_0x3a5a00&&(this['sfLogger'][_0x2909d2(0x1da)](this[_0x2909d2(0x1fa)]+'\x20Repository\x20\x22'+_0x938410[_0x2909d2(0x21c)]+_0x2909d2(0x21f)),_0x3a5a00=await this['repoService'][_0x2909d2(0x21d)]({'name':_0x938410[_0x2909d2(0x21c)],'autoInit':!![],'defaultBranch':_0x938410['branchName'],'private':!![],'createHook':typedi_1[_0x2909d2(0x215)][_0x2909d2(0x205)](providers_tokens_1[_0x2909d2(0x210)][_0x2909d2(0x1eb)])[_0x2909d2(0x1e9)]}));if(this[_0x2909d2(0x1eb)]['isBidirectionalSynchronization']){const _0x58dba8=await _0x3a5a00[_0x2909d2(0x211)][_0x2909d2(0x1ba)]();!_0x58dba8[_0x2909d2(0x1db)](_0x1e4abf=>_0x1e4abf['url']===hooks_utils_1['HooksUtils']['getHookLinkFor'](this[_0x2909d2(0x1eb)][_0x2909d2(0x1d7)],this[_0x2909d2(0x1eb)]['applicationUrl'],_0x59a295))&&(this[_0x2909d2(0x1bf)][_0x2909d2(0x1da)](this[_0x2909d2(0x1fa)]+'\x20Repository\x20\x22'+_0x938410[_0x2909d2(0x21c)]+_0x2909d2(0x1fc)),await _0x3a5a00[_0x2909d2(0x211)]['create'](hooks_utils_1[_0x2909d2(0x233)]['createHookPayload'](this['config'][_0x2909d2(0x1d7)],_0x3a5a00[_0x2909d2(0x211)],this[_0x2909d2(0x1eb)][_0x2909d2(0x1bd)],_0x59a295)));}return this[_0x2909d2(0x235)][_0x2909d2(0x1e5)](_0x3a5a00),_0x3a5a00;}async[a111_0x5eddeb(0x200)](){const _0x11e374=a111_0x5eddeb;this['gitApiService']=typedi_1[_0x11e374(0x215)][_0x11e374(0x205)](providers_tokens_1['Tokens'][_0x11e374(0x225)]),this[_0x11e374(0x1f2)]=typedi_1[_0x11e374(0x215)][_0x11e374(0x205)](providers_tokens_1[_0x11e374(0x210)][_0x11e374(0x1c0)]),this[_0x11e374(0x1eb)]=typedi_1['Container'][_0x11e374(0x205)](providers_tokens_1[_0x11e374(0x210)][_0x11e374(0x1eb)]),this[_0x11e374(0x1bf)]=typedi_1[_0x11e374(0x215)][_0x11e374(0x205)](providers_tokens_1[_0x11e374(0x210)][_0x11e374(0x203)]),this[_0x11e374(0x1fa)]='['+SyncService_1[_0x11e374(0x1f5)]+_0x11e374(0x1dc)+this[_0x11e374(0x1eb)][_0x11e374(0x1d7)]['toUpperCase']()+']',this[_0x11e374(0x1f9)][_0x11e374(0x1ee)](this[_0x11e374(0x1bf)][_0x11e374(0x21b)]());try{this[_0x11e374(0x1bf)][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+_0x11e374(0x201)),await this[_0x11e374(0x1bf)]['log'](this[_0x11e374(0x1fa)]+_0x11e374(0x1f3))[_0x11e374(0x220)]();const _0x33ccbd=await this[_0x11e374(0x22e)][_0x11e374(0x1f0)](typedi_1[_0x11e374(0x215)][_0x11e374(0x205)](providers_tokens_1[_0x11e374(0x210)][_0x11e374(0x228)]));if(!_0x33ccbd[_0x11e374(0x237)])throw new bad_request_error_1[(_0x11e374(0x1c2))](this[_0x11e374(0x1fa)]+_0x11e374(0x1bb));await this['sfLogger'][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+_0x11e374(0x219))['send']();const _0x91a212=await this[_0x11e374(0x22e)][_0x11e374(0x1e4)](_0x33ccbd['map'](_0x110bb3=>'\x27'+_0x110bb3[_0x11e374(0x1c3)]+'\x27')['join'](','));await this['sfLogger'][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+_0x11e374(0x1d8))[_0x11e374(0x220)](),this[_0x11e374(0x235)]=await this[_0x11e374(0x1f2)]['getAll']();const _0x1b733b=[..._0x33ccbd,..._0x91a212];this[_0x11e374(0x1bf)][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+'\x20Have\x20to\x20synchronize\x20'+_0x1b733b[_0x11e374(0x237)]+'\x20branches.');for(const _0x248660 of _0x1b733b){this[_0x11e374(0x203)]['log'](_0x11e374(0x213)+_0x248660[_0x11e374(0x21c)]+'['+_0x248660['repositoryId']+_0x11e374(0x1e0)+_0x248660[_0x11e374(0x1ef)]+'['+_0x248660[_0x11e374(0x1ce)]+_0x11e374(0x236)),this['sfLogger']['log'](this[_0x11e374(0x1fa)]+_0x11e374(0x1d1)+_0x248660[_0x11e374(0x21c)]+_0x11e374(0x1cb)+_0x248660[_0x11e374(0x1ef)]+'\x22.'),this[_0x11e374(0x1bf)]['log'](this[_0x11e374(0x1fa)]+'\x20Checking\x20valid\x20name.');const _0x472b97=await this['checkValidNaming'](_0x248660);if(!_0x472b97)continue;this[_0x11e374(0x1bf)][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+_0x11e374(0x1b9));const _0x5e123f=await this[_0x11e374(0x20e)](_0x248660);if(_0x5e123f)continue;await this[_0x11e374(0x1bf)]['send']();let _0x54463c;try{await this[_0x11e374(0x1bf)][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+_0x11e374(0x224))[_0x11e374(0x220)](),_0x54463c=await this['getOrCreateRepo'](_0x248660,typedi_1[_0x11e374(0x215)][_0x11e374(0x205)](providers_tokens_1['Tokens'][_0x11e374(0x228)]));}catch(_0x28e597){await this['handleRecordSyncError'](_0x248660,_0x28e597 instanceof too_many_requests_error_1[_0x11e374(0x1dd)]?_0x28e597:new Error(_0x11e374(0x1d5)+_0x28e597));continue;}await this[_0x11e374(0x1bf)][_0x11e374(0x1da)](this['prefix']+_0x11e374(0x1cd))[_0x11e374(0x220)]();if(_0x248660[_0x11e374(0x218)]===flosum_repository_sync_dto_1[_0x11e374(0x20f)][_0x11e374(0x1fd)]){const _0x119a79=typedi_1[_0x11e374(0x215)][_0x11e374(0x205)](flosum_sync_job_1[_0x11e374(0x1d2)]);await _0x119a79['run']({'repository':_0x54463c,'convertToSFDX':this[_0x11e374(0x1eb)][_0x11e374(0x1ec)],'syncRecord':_0x248660,'provider':this['config'][_0x11e374(0x1d7)]})[_0x11e374(0x1b8)](_0x2b594b=>this[_0x11e374(0x1f7)](_0x248660,_0x2b594b));}else{const _0x161f09=typedi_1[_0x11e374(0x215)]['get'](git_sync_job_1[_0x11e374(0x1c9)]);await _0x161f09[_0x11e374(0x200)]({'repository':_0x54463c,'branch':_0x248660[_0x11e374(0x1ef)],'provider':this[_0x11e374(0x1eb)][_0x11e374(0x1d7)],'repositoryGit':_0x54463c[_0x11e374(0x1e3)],'syncRecord':_0x248660})['catch'](_0x1c0565=>this[_0x11e374(0x1f7)](_0x248660,_0x1c0565));}}}catch(_0x399226){this['logger'][_0x11e374(0x226)](_0x399226);_0x399226 instanceof too_many_requests_error_1[_0x11e374(0x1dd)]?(await this['sfLogger'][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+'\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')[_0x11e374(0x220)](),await(0x0,utils_1[_0x11e374(0x1d0)])(0x3c*0x3c*0x3e8),this[_0x11e374(0x200)]()):await this[_0x11e374(0x1bf)][_0x11e374(0x226)](this[_0x11e374(0x1fa)]+_0x11e374(0x202)+_0x399226)[_0x11e374(0x220)]();return;}await this[_0x11e374(0x1bf)][_0x11e374(0x1da)](this[_0x11e374(0x1fa)]+_0x11e374(0x1d6))[_0x11e374(0x220)](),await this['salesforceSync'][_0x11e374(0x206)](typedi_1[_0x11e374(0x215)][_0x11e374(0x205)](providers_tokens_1[_0x11e374(0x210)][_0x11e374(0x228)]))[_0x11e374(0x1b8)](()=>null);}};function a111_0xfc0a(_0x231dc3,_0x5eb4fc){const _0x1e6de7=a111_0x2569();return a111_0xfc0a=function(_0x36cb54,_0xe88329){_0x36cb54=_0x36cb54-0x1b8;let _0x256934=_0x1e6de7[_0x36cb54];return _0x256934;},a111_0xfc0a(_0x231dc3,_0x5eb4fc);}SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x5eddeb(0x234)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a111_0x5eddeb(0x20b)],salesforce_sync_service_1[a111_0x5eddeb(0x1ca)]])],SyncService),exports[a111_0x5eddeb(0x229)]=SyncService;function a111_0x2569(){const _0x39938f=['../../salesforce/services/salesforce.service','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','\x20Sync\x20job\x20done.','gitProvider','\x20Getting\x20repositories\x20from\x20git\x20service.','SalesforceError','log','find',']\x20[','TooManyRequests','decorate','search',']\x20repository\x20','\x27\x20-\x20\x27','../../../../core/errors/bad-request.error','gitUrl','getBranchRecords','push','../../providers/providers.tokens','../../../shared/utils','setStatus','isBidirectionalSynchronization','8019468lsJEMf','config','isConvertToSfdx','1425982ZrtaZR','setLoggerId','branchName','getRepositoryRecords','1fNkNcK','repoService','\x20Getting\x20repository\x20records.','../../salesforce/errors/salesforce.error','name','../../providers/web-hooks/hooks.utils','handleRecordSyncError','\x20Stop\x20sync\x20job\x20for\x20\x27','salesforceService','prefix','__metadata','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','FlosumToGit','repositoriesIntersections','__esModule','run','\x20Start\x20sync\x20job.','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','logger','Waiting','get','disableSync','toLowerCase','(((.+)+)+)+$','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','test','SalesforceService','\x27\x20[','apply','isIntersects','SyncDirection','Tokens','hooks','typedi','Syncing\x20','466086AaQLeH','Container','getOrCreateRepo','2613632JeeKMS','direction','\x20Getting\x20branch\x20records.','GitBranchNotFoundError','getLoggerId','repositoryName','create','REPOSITORY_NAME_REGEXP','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','send','3263585MVKLrt','defineProperty','object','\x20Getting\x20Flosum\x20repository','gitApiService','error','../jobs/git-sync.job','connectionId','SyncService','4995844ZgaVyA','28EMIrqT','\x27\x20in\x20repository\x20\x27','Unable\x20to\x20synchronize\x20branch\x20\x27','salesforceSync','../errors/git-branch-not-found.error','Logger','function','checkValidNaming','HooksUtils','Service','repoList',']\x20branch.','length','catch','\x20Checking\x20intersects.','getAll','\x20No\x20repositories\x20to\x20sync.','../../../../core','applicationUrl','toString','sfLogger','gitRepoService','../../../../constants','BadRequestError','repositoryId','2343264qqzKsw','Unable\x20to\x20synchronize\x20repository\x20\x27','Not\x20Synchronized','__decorate',']\x20due\x20error\x20-\x20','GitSyncJob','SalesforceSyncService','\x22\x20branch:\x20\x22','metadata','\x20Completed\x20prepare\x20to\x20syncing.','branchId','updateRemoteState','sleep','\x20Syncing\x20repository:\x20\x22','FlosumSyncJob'];a111_0x2569=function(){return _0x39938f;};return a111_0x2569();}