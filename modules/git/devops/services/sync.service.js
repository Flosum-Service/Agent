function a110_0x1b8a(_0x4e5574,_0x4dfa6f){const _0x5da306=a110_0xb18f();return a110_0x1b8a=function(_0x285aeb,_0x55b05c){_0x285aeb=_0x285aeb-0xa6;let _0xb18f53=_0x5da306[_0x285aeb];return _0xb18f53;},a110_0x1b8a(_0x4e5574,_0x4dfa6f);}const a110_0x5ad6c7=a110_0x1b8a;(function(_0x1ec047,_0x178d8e){const _0x1bfa85=a110_0x1b8a,_0x3ac1d6=_0x1ec047();while(!![]){try{const _0x307525=-parseInt(_0x1bfa85(0xdd))/0x1*(-parseInt(_0x1bfa85(0xbf))/0x2)+-parseInt(_0x1bfa85(0xa6))/0x3+parseInt(_0x1bfa85(0xf3))/0x4+parseInt(_0x1bfa85(0xaf))/0x5*(parseInt(_0x1bfa85(0x114))/0x6)+-parseInt(_0x1bfa85(0x108))/0x7+-parseInt(_0x1bfa85(0xe2))/0x8*(-parseInt(_0x1bfa85(0xb8))/0x9)+-parseInt(_0x1bfa85(0xf7))/0xa;if(_0x307525===_0x178d8e)break;else _0x3ac1d6['push'](_0x3ac1d6['shift']());}catch(_0x5014c9){_0x3ac1d6['push'](_0x3ac1d6['shift']());}}}(a110_0xb18f,0xaee57));const a110_0x55b05c=(function(){let _0x3cba8e=!![];return function(_0x3f7ca8,_0x5cb742){const _0x51dfad=_0x3cba8e?function(){if(_0x5cb742){const _0x1f71ba=_0x5cb742['apply'](_0x3f7ca8,arguments);return _0x5cb742=null,_0x1f71ba;}}:function(){};return _0x3cba8e=![],_0x51dfad;};}()),a110_0x285aeb=a110_0x55b05c(this,function(){const _0x234a96=a110_0x1b8a;return a110_0x285aeb[_0x234a96(0xf8)]()[_0x234a96(0xa7)](_0x234a96(0x10e))[_0x234a96(0xf8)]()[_0x234a96(0x115)](a110_0x285aeb)[_0x234a96(0xa7)](_0x234a96(0x10e));});a110_0x285aeb();function a110_0xb18f(){const _0xf7c58f=['5899448TuqEkV','gitRepoService','../../salesforce/errors/salesforce.error','getAll','toUpperCase','Syncing\x20','create','\x20Have\x20to\x20synchronize\x20','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','\x20Checking\x20intersects.','setStatus','applicationUrl','getOrCreateRepo','config','sfLogger','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','test','697040CztwWG','\x20Checking\x20valid\x20name.','repositoriesIntersections','../../salesforce/services/salesforce-sync.service','7338850FZXNni','toString','createHookPayload','../../../../core','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.',']\x20repository\x20','\x20Getting\x20Flosum\x20repository','GitSyncJob','updateRemoteState','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x20branches.','error','\x20Getting\x20repository\x20records.','\x20Getting\x20repositories\x20from\x20git\x20service.','../../../shared/utils',']\x20[','../../salesforce/services/salesforce.service','6895070KTpHVB','defineProperty','Waiting','gitUrl','GitBranchNotFoundError','SalesforceSyncService','(((.+)+)+)+$','\x20Getting\x20branch\x20records.','getHookLinkFor','salesforceSync','../../providers/providers.tokens','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','317508jjLLRZ','constructor','Tokens','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x22\x20branch:\x20\x22','length','function','connectionId','REPOSITORY_NAME_REGEXP','sleep','getLoggerId','toLowerCase','Container',']\x20branch.','\x20Completed\x20prepare\x20to\x20syncing.','../../../../constants','Unable\x20to\x20synchronize\x20repository\x20\x27','decorate','name','225330EEHBLY','search','repoService','logger','repositoryId','../jobs/flosum-sync.job','\x20Start\x20sync\x20job.','TooManyRequests','gitProvider','40rDDGTZ','repoList','run','Unable\x20to\x20synchronize\x20branch\x20\x27','catch','branchName','__metadata','\x27\x20[','gitApiService','9slMQgm','BRANCH_NAME_REGEXP','prefix','metadata','BadRequestError','salesforceService','../../../../core/errors/too-many-requests.error','470138qSsvsM','Not\x20Synchronized','Logger','HooksUtils','\x20No\x20repositories\x20to\x20sync.','\x20Repository\x20\x22','FlosumToGit','isIntersects','handleRecordSyncError','join','\x27\x20in\x20repository\x20\x27','Error','checkValidNaming','getRepositoryRecords','branchId','design:paramtypes','object','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','\x27\x20-\x20\x27','send','log','../../../../core/errors/bad-request.error','\x20Stop\x20sync\x20job\x20for\x20\x27','find','__esModule','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','hooks','typedi','\x20Syncing\x20repository:\x20\x22','get','5UwKImx','isBidirectionalSynchronization','repositoryName','../../providers/web-hooks/hooks.utils','push'];a110_0xb18f=function(){return _0xf7c58f;};return a110_0xb18f();}'use strict';var __decorate=this&&this['__decorate']||function(_0x3c1906,_0x34287b,_0x42328b,_0x130992){const _0x3cb865=a110_0x1b8a;var _0x41bcb1=arguments[_0x3cb865(0x119)],_0x32c37f=_0x41bcb1<0x3?_0x34287b:_0x130992===null?_0x130992=Object['getOwnPropertyDescriptor'](_0x34287b,_0x42328b):_0x130992,_0x13e5e4;if(typeof Reflect===_0x3cb865(0xcf)&&typeof Reflect[_0x3cb865(0x125)]===_0x3cb865(0x11a))_0x32c37f=Reflect['decorate'](_0x3c1906,_0x34287b,_0x42328b,_0x130992);else{for(var _0xb5d82=_0x3c1906[_0x3cb865(0x119)]-0x1;_0xb5d82>=0x0;_0xb5d82--)if(_0x13e5e4=_0x3c1906[_0xb5d82])_0x32c37f=(_0x41bcb1<0x3?_0x13e5e4(_0x32c37f):_0x41bcb1>0x3?_0x13e5e4(_0x34287b,_0x42328b,_0x32c37f):_0x13e5e4(_0x34287b,_0x42328b))||_0x32c37f;}return _0x41bcb1>0x3&&_0x32c37f&&Object[_0x3cb865(0x109)](_0x34287b,_0x42328b,_0x32c37f),_0x32c37f;},__metadata=this&&this[a110_0x5ad6c7(0xb5)]||function(_0x302f52,_0x3159fb){const _0x58ad4e=a110_0x5ad6c7;if(typeof Reflect==='object'&&typeof Reflect[_0x58ad4e(0xbb)]===_0x58ad4e(0x11a))return Reflect[_0x58ad4e(0xbb)](_0x302f52,_0x3159fb);},SyncService_1;Object[a110_0x5ad6c7(0x109)](exports,a110_0x5ad6c7(0xd7),{'value':!![]}),exports['SyncService']=void 0x0;const constants_1=require(a110_0x5ad6c7(0x123)),core_1=require(a110_0x5ad6c7(0xfa)),too_many_requests_error_1=require(a110_0x5ad6c7(0xbe)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a110_0x5ad6c7(0xe4)),salesforce_sync_service_1=require(a110_0x5ad6c7(0xf6)),salesforce_service_1=require(a110_0x5ad6c7(0x107)),utils_1=require(a110_0x5ad6c7(0x105)),typedi_1=require(a110_0x5ad6c7(0xda)),hooks_utils_1=require(a110_0x5ad6c7(0xe0)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require(a110_0x5ad6c7(0xab)),git_sync_job_1=require('../jobs/git-sync.job'),providers_tokens_1=require(a110_0x5ad6c7(0x112)),bad_request_error_1=require(a110_0x5ad6c7(0xd4));let SyncService=SyncService_1=class SyncService{constructor(_0x153708,_0x3b5615){const _0x5b34d0=a110_0x5ad6c7;this[_0x5b34d0(0xbd)]=_0x153708,this['salesforceSync']=_0x3b5615,this[_0x5b34d0(0xa9)]=new core_1[(_0x5b34d0(0xc1))](SyncService_1[_0x5b34d0(0x126)]),this[_0x5b34d0(0xf5)]={},this[_0x5b34d0(0xb0)]=[];}async['handleRecordSyncError'](_0x3b775e,_0x446011){const _0x441063=a110_0x5ad6c7;if(_0x446011 instanceof git_branch_not_found_error_1[_0x441063(0x10c)]){await this[_0x441063(0x111)]['setStatus'](_0x3b775e,_0x441063(0xc0));return;}if(_0x446011 instanceof too_many_requests_error_1[_0x441063(0xad)]){await this['salesforceSync'][_0x441063(0xec)](_0x3b775e,_0x441063(0x10a));throw _0x446011;}try{await this['sfLogger'][_0x441063(0x102)](this[_0x441063(0xba)]+_0x441063(0xd5)+_0x3b775e[_0x441063(0xdf)]+_0x441063(0xb6)+_0x3b775e[_0x441063(0xb4)]+']\x20due\x20error\x20-\x20'+_0x446011+'.')[_0x441063(0xd2)](),await this[_0x441063(0x111)][_0x441063(0xff)](_0x3b775e,{}),await this[_0x441063(0x111)][_0x441063(0xec)](_0x3b775e,_0x441063(0xca));}catch(_0x10558d){if(_0x10558d instanceof salesforce_error_1['SalesforceError'])throw _0x10558d;}}async[a110_0x5ad6c7(0xc6)](_0x1cb14d){const _0x241ee8=a110_0x5ad6c7;if(_0x1cb14d[_0x241ee8(0xaa)]){const _0x12dc01=_0x1cb14d[_0x241ee8(0xdf)][_0x241ee8(0x11f)](),_0x5d439b=this[_0x241ee8(0xf5)][_0x12dc01];if(!_0x5d439b)this['repositoriesIntersections'][_0x12dc01]=_0x1cb14d[_0x241ee8(0xdf)];else{if(_0x5d439b&&_0x5d439b!==_0x1cb14d['repositoryName'])return await this[_0x241ee8(0xc7)](_0x1cb14d,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x1cb14d[_0x241ee8(0xdf)]+_0x241ee8(0x113)+_0x12dc01+_0x241ee8(0xd1)+_0x5d439b+'\x27')),!![];}}return![];}async[a110_0x5ad6c7(0xcb)](_0x4450e7){const _0x4dd400=a110_0x5ad6c7;if(!constants_1[_0x4dd400(0x11c)][_0x4dd400(0xf2)](_0x4450e7[_0x4dd400(0xdf)]))return await this[_0x4dd400(0xc7)](_0x4450e7,new Error(_0x4dd400(0x124)+_0x4450e7[_0x4dd400(0xdf)]+_0x4dd400(0x100))),![];if(!constants_1[_0x4dd400(0xb9)][_0x4dd400(0xf2)](_0x4450e7['branchName']))return await this[_0x4dd400(0xc7)](_0x4450e7,new Error(_0x4dd400(0xb2)+_0x4450e7[_0x4dd400(0xb4)]+_0x4dd400(0xc9)+_0x4450e7[_0x4dd400(0xdf)]+_0x4dd400(0x117))),![];return!![];}async[a110_0x5ad6c7(0xee)](_0x180ac5,_0x136175){const _0x4585ac=a110_0x5ad6c7;let _0x25f932=this[_0x4585ac(0xb0)][_0x4585ac(0xd6)](_0x669ce0=>_0x180ac5['repositoryName']===_0x669ce0[_0x4585ac(0x126)]);!_0x25f932&&(this[_0x4585ac(0xf0)][_0x4585ac(0xd3)](this[_0x4585ac(0xba)]+_0x4585ac(0xc4)+_0x180ac5['repositoryName']+_0x4585ac(0xfb)),_0x25f932=await this[_0x4585ac(0xa8)][_0x4585ac(0xe8)]({'name':_0x180ac5[_0x4585ac(0xdf)],'autoInit':!![],'defaultBranch':_0x180ac5[_0x4585ac(0xb4)],'private':!![],'createHook':typedi_1['Container']['get'](providers_tokens_1['Tokens'][_0x4585ac(0xef)])[_0x4585ac(0xde)]}));if(this[_0x4585ac(0xef)][_0x4585ac(0xde)]){const _0x345db6=await _0x25f932[_0x4585ac(0xd9)][_0x4585ac(0xe5)]();!_0x345db6[_0x4585ac(0xd6)](_0xafab4a=>_0xafab4a['url']===hooks_utils_1[_0x4585ac(0xc2)][_0x4585ac(0x110)](this[_0x4585ac(0xef)][_0x4585ac(0xae)],this[_0x4585ac(0xef)][_0x4585ac(0xed)],_0x136175))&&(this[_0x4585ac(0xf0)][_0x4585ac(0xd3)](this[_0x4585ac(0xba)]+'\x20Repository\x20\x22'+_0x180ac5[_0x4585ac(0xdf)]+_0x4585ac(0xf1)),await _0x25f932[_0x4585ac(0xd9)][_0x4585ac(0xe8)](hooks_utils_1['HooksUtils'][_0x4585ac(0xf9)](this[_0x4585ac(0xef)][_0x4585ac(0xae)],_0x25f932[_0x4585ac(0xd9)],this[_0x4585ac(0xef)]['applicationUrl'],_0x136175)));}return this[_0x4585ac(0xb0)][_0x4585ac(0xe1)](_0x25f932),_0x25f932;}async[a110_0x5ad6c7(0xb1)](){const _0xf0999c=a110_0x5ad6c7;this['gitApiService']=typedi_1[_0xf0999c(0x120)][_0xf0999c(0xdc)](providers_tokens_1['Tokens'][_0xf0999c(0xb7)]),this[_0xf0999c(0xa8)]=typedi_1['Container'][_0xf0999c(0xdc)](providers_tokens_1[_0xf0999c(0x116)][_0xf0999c(0xe3)]),this[_0xf0999c(0xef)]=typedi_1[_0xf0999c(0x120)][_0xf0999c(0xdc)](providers_tokens_1[_0xf0999c(0x116)][_0xf0999c(0xef)]),this[_0xf0999c(0xf0)]=typedi_1[_0xf0999c(0x120)][_0xf0999c(0xdc)](providers_tokens_1[_0xf0999c(0x116)][_0xf0999c(0xa9)]),this[_0xf0999c(0xba)]='['+SyncService_1['name']+_0xf0999c(0x106)+this['config'][_0xf0999c(0xae)][_0xf0999c(0xe6)]()+']',this[_0xf0999c(0xbd)]['setLoggerId'](this[_0xf0999c(0xf0)][_0xf0999c(0x11e)]());try{this[_0xf0999c(0xf0)][_0xf0999c(0xd3)](this[_0xf0999c(0xba)]+_0xf0999c(0xac)),await this['sfLogger'][_0xf0999c(0xd3)](this[_0xf0999c(0xba)]+_0xf0999c(0x103))[_0xf0999c(0xd2)]();const _0x3b57bf=await this[_0xf0999c(0x111)][_0xf0999c(0xcc)](typedi_1[_0xf0999c(0x120)][_0xf0999c(0xdc)](providers_tokens_1['Tokens'][_0xf0999c(0x11b)]));if(!_0x3b57bf[_0xf0999c(0x119)])throw new bad_request_error_1[(_0xf0999c(0xbc))](this['prefix']+_0xf0999c(0xc3));await this['sfLogger']['log'](this[_0xf0999c(0xba)]+_0xf0999c(0x10f))[_0xf0999c(0xd2)]();const _0x468327=await this['salesforceSync']['getBranchRecords'](_0x3b57bf['map'](_0x113841=>'\x27'+_0x113841[_0xf0999c(0xaa)]+'\x27')[_0xf0999c(0xc8)](','));await this[_0xf0999c(0xf0)][_0xf0999c(0xd3)](this['prefix']+_0xf0999c(0x104))['send'](),this['repoList']=await this['repoService']['getAll']();const _0x4f9926=[..._0x3b57bf,..._0x468327];this[_0xf0999c(0xf0)]['log'](this[_0xf0999c(0xba)]+_0xf0999c(0xe9)+_0x4f9926[_0xf0999c(0x119)]+_0xf0999c(0x101));for(const _0x363342 of _0x4f9926){this[_0xf0999c(0xa9)]['log'](_0xf0999c(0xe7)+_0x363342[_0xf0999c(0xdf)]+'['+_0x363342['repositoryId']+_0xf0999c(0xfc)+_0x363342[_0xf0999c(0xb4)]+'['+_0x363342[_0xf0999c(0xcd)]+_0xf0999c(0x121)),this['sfLogger'][_0xf0999c(0xd3)](this['prefix']+_0xf0999c(0xdb)+_0x363342['repositoryName']+_0xf0999c(0x118)+_0x363342[_0xf0999c(0xb4)]+'\x22.'),this['sfLogger']['log'](this[_0xf0999c(0xba)]+_0xf0999c(0xf4));const _0x2bfc33=await this['checkValidNaming'](_0x363342);if(!_0x2bfc33)continue;this[_0xf0999c(0xf0)][_0xf0999c(0xd3)](this[_0xf0999c(0xba)]+_0xf0999c(0xeb));const _0x4d81c3=await this[_0xf0999c(0xc6)](_0x363342);if(_0x4d81c3)continue;await this[_0xf0999c(0xf0)][_0xf0999c(0xd2)]();let _0x75aab9;try{await this['sfLogger']['log'](this['prefix']+_0xf0999c(0xfd))['send'](),_0x75aab9=await this[_0xf0999c(0xee)](_0x363342,typedi_1[_0xf0999c(0x120)][_0xf0999c(0xdc)](providers_tokens_1[_0xf0999c(0x116)][_0xf0999c(0x11b)]));}catch(_0x1be02c){await this['handleRecordSyncError'](_0x363342,_0x1be02c instanceof too_many_requests_error_1[_0xf0999c(0xad)]?_0x1be02c:new Error(_0xf0999c(0xd0)+_0x1be02c));continue;}await this[_0xf0999c(0xf0)][_0xf0999c(0xd3)](this[_0xf0999c(0xba)]+_0xf0999c(0x122))[_0xf0999c(0xd2)]();if(_0x363342['direction']===flosum_repository_sync_dto_1['SyncDirection'][_0xf0999c(0xc5)]){const _0x36f336=typedi_1[_0xf0999c(0x120)]['get'](flosum_sync_job_1['FlosumSyncJob']);await _0x36f336[_0xf0999c(0xb1)]({'repository':_0x75aab9,'convertToSFDX':this[_0xf0999c(0xef)]['isConvertToSfdx'],'syncRecord':_0x363342,'provider':this[_0xf0999c(0xef)][_0xf0999c(0xae)]})[_0xf0999c(0xb3)](_0x4e4a9c=>this[_0xf0999c(0xc7)](_0x363342,_0x4e4a9c));}else{const _0x518bfe=typedi_1[_0xf0999c(0x120)][_0xf0999c(0xdc)](git_sync_job_1[_0xf0999c(0xfe)]);await _0x518bfe['run']({'repository':_0x75aab9,'branch':_0x363342[_0xf0999c(0xb4)],'provider':this[_0xf0999c(0xef)][_0xf0999c(0xae)],'repositoryGit':_0x75aab9[_0xf0999c(0x10b)],'syncRecord':_0x363342})[_0xf0999c(0xb3)](_0x5d7609=>this['handleRecordSyncError'](_0x363342,_0x5d7609));}}}catch(_0x9dfc83){this[_0xf0999c(0xa9)][_0xf0999c(0x102)](_0x9dfc83);_0x9dfc83 instanceof too_many_requests_error_1[_0xf0999c(0xad)]?(await this[_0xf0999c(0xf0)][_0xf0999c(0xd3)](this[_0xf0999c(0xba)]+_0xf0999c(0xea))[_0xf0999c(0xd2)](),await(0x0,utils_1[_0xf0999c(0x11d)])(0x3c*0x3c*0x3e8),this[_0xf0999c(0xb1)]()):await this[_0xf0999c(0xf0)]['error'](this['prefix']+_0xf0999c(0xd8)+_0x9dfc83)[_0xf0999c(0xd2)]();return;}await this[_0xf0999c(0xf0)]['log'](this[_0xf0999c(0xba)]+'\x20Sync\x20job\x20done.')[_0xf0999c(0xd2)](),await this['salesforceSync']['disableSync'](typedi_1[_0xf0999c(0x120)][_0xf0999c(0xdc)](providers_tokens_1[_0xf0999c(0x116)][_0xf0999c(0x11b)]))[_0xf0999c(0xb3)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a110_0x5ad6c7(0xce),[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a110_0x5ad6c7(0x10d)]])],SyncService),exports['SyncService']=SyncService;