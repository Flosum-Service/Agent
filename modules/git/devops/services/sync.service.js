const a111_0x1f929a=a111_0x360d;(function(_0x149bcc,_0x1fc046){const _0x3b030b=a111_0x360d,_0x5cc578=_0x149bcc();while(!![]){try{const _0x4a52da=-parseInt(_0x3b030b(0x194))/0x1*(-parseInt(_0x3b030b(0x193))/0x2)+parseInt(_0x3b030b(0x1d1))/0x3+parseInt(_0x3b030b(0x1ad))/0x4+parseInt(_0x3b030b(0x1ff))/0x5*(-parseInt(_0x3b030b(0x1f9))/0x6)+parseInt(_0x3b030b(0x19b))/0x7+parseInt(_0x3b030b(0x1da))/0x8*(-parseInt(_0x3b030b(0x1c6))/0x9)+-parseInt(_0x3b030b(0x1fe))/0xa;if(_0x4a52da===_0x1fc046)break;else _0x5cc578['push'](_0x5cc578['shift']());}catch(_0x4bf1ad){_0x5cc578['push'](_0x5cc578['shift']());}}}(a111_0x4ce1,0xbd879));function a111_0x360d(_0x1df220,_0x500ad8){const _0x4d9a29=a111_0x4ce1();return a111_0x360d=function(_0x35240c,_0x14001c){_0x35240c=_0x35240c-0x18a;let _0x4ce113=_0x4d9a29[_0x35240c];return _0x4ce113;},a111_0x360d(_0x1df220,_0x500ad8);}const a111_0x14001c=(function(){let _0x5b227c=!![];return function(_0x4b7b40,_0x78368d){const _0x52f2a2=_0x5b227c?function(){if(_0x78368d){const _0x3c406e=_0x78368d['apply'](_0x4b7b40,arguments);return _0x78368d=null,_0x3c406e;}}:function(){};return _0x5b227c=![],_0x52f2a2;};}()),a111_0x35240c=a111_0x14001c(this,function(){const _0x556d4d=a111_0x360d;return a111_0x35240c[_0x556d4d(0x1ae)]()[_0x556d4d(0x1d2)](_0x556d4d(0x1c5))[_0x556d4d(0x1ae)]()[_0x556d4d(0x1b2)](a111_0x35240c)['search'](_0x556d4d(0x1c5));});a111_0x35240c();function a111_0x4ce1(){const _0x29d447=['object','../../providers/providers.tokens','error','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','SalesforceSyncService','function','repoList','\x20branches.','5371088ecADuP','toString',']\x20repository\x20','setStatus','\x20No\x20repositories\x20to\x20sync.','constructor','\x22\x20branch:\x20\x22','../jobs/git-sync.job','BRANCH_NAME_REGEXP','join','SalesforceService','\x20Start\x20sync\x20job.','name','getOwnPropertyDescriptor','SyncDirection','push','log','../jobs/flosum-sync.job','\x20Getting\x20Flosum\x20repository','../../salesforce/services/salesforce.service','branchId','gitApiService','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','Error','(((.+)+)+)+$','45batupB','\x27\x20-\x20\x27','handleRecordSyncError','Unable\x20to\x20synchronize\x20repository\x20\x27','\x20Completed\x20prepare\x20to\x20syncing.','../../../../core/errors/too-many-requests.error','\x20Sync\x20job\x20done.','SalesforceError','REPOSITORY_NAME_REGEXP','\x27\x20in\x20repository\x20\x27','decorate','3058971VJFViY','search','metadata','../../../../core','Container','config','branchName','get','repositoryName','1545376MhVElV','defineProperty','\x27\x20[','\x20Syncing\x20repository:\x20\x22','Unable\x20to\x20synchronize\x20branch\x20\x27','sfLogger','Tokens','createHookPayload','\x20Have\x20to\x20synchronize\x20','salesforceService','../../../../constants','../../salesforce/errors/salesforce.error',']\x20[','Logger','updateRemoteState','\x20Getting\x20repositories\x20from\x20git\x20service.','catch','__metadata','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','Service','../../../../core/errors/bad-request.error','hooks','isIntersects','isBidirectionalSynchronization','../../salesforce/dto/flosum-repository-sync.dto','GitBranchNotFoundError','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','send','create','logger','GitSyncJob','703116EabKEi','gitProvider','disableSync','applicationUrl','length','18391790UNOlFW','5dyBJaG','getOrCreateRepo','\x20Repository\x20\x22','repositoryId','getAll','getBranchRecords','\x20Stop\x20sync\x20job\x20for\x20\x27','repositoriesIntersections','map','run','FlosumSyncJob','__decorate','TooManyRequests','gitUrl','test','../../../shared/utils','checkValidNaming','../errors/git-branch-not-found.error',']\x20branch.','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','salesforceSync','repoService','\x20Getting\x20repository\x20records.','direction','1002594QyTrQv','1fHFTdU','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x20Checking\x20intersects.','connectionId','prefix','__esModule','5843684cOAszS','SyncService','toUpperCase','toLowerCase','isConvertToSfdx','setLoggerId','HooksUtils','find','\x20Getting\x20branch\x20records.','Waiting'];a111_0x4ce1=function(){return _0x29d447;};return a111_0x4ce1();}'use strict';var __decorate=this&&this[a111_0x1f929a(0x20a)]||function(_0x6f5c2f,_0x55efd1,_0x57fd8c,_0xeb2a50){const _0x2244d7=a111_0x1f929a;var _0x1653ae=arguments[_0x2244d7(0x1fd)],_0x59cdc3=_0x1653ae<0x3?_0x55efd1:_0xeb2a50===null?_0xeb2a50=Object[_0x2244d7(0x1ba)](_0x55efd1,_0x57fd8c):_0xeb2a50,_0x5e01e1;if(typeof Reflect===_0x2244d7(0x1a5)&&typeof Reflect[_0x2244d7(0x1d0)]===_0x2244d7(0x1aa))_0x59cdc3=Reflect['decorate'](_0x6f5c2f,_0x55efd1,_0x57fd8c,_0xeb2a50);else{for(var _0x2fa31c=_0x6f5c2f[_0x2244d7(0x1fd)]-0x1;_0x2fa31c>=0x0;_0x2fa31c--)if(_0x5e01e1=_0x6f5c2f[_0x2fa31c])_0x59cdc3=(_0x1653ae<0x3?_0x5e01e1(_0x59cdc3):_0x1653ae>0x3?_0x5e01e1(_0x55efd1,_0x57fd8c,_0x59cdc3):_0x5e01e1(_0x55efd1,_0x57fd8c))||_0x59cdc3;}return _0x1653ae>0x3&&_0x59cdc3&&Object[_0x2244d7(0x1db)](_0x55efd1,_0x57fd8c,_0x59cdc3),_0x59cdc3;},__metadata=this&&this[a111_0x1f929a(0x1eb)]||function(_0x5ccc1f,_0x1e164a){const _0x2aa0c9=a111_0x1f929a;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0x2aa0c9(0x1d3)](_0x5ccc1f,_0x1e164a);},SyncService_1;Object[a111_0x1f929a(0x1db)](exports,a111_0x1f929a(0x19a),{'value':!![]}),exports[a111_0x1f929a(0x19c)]=void 0x0;const constants_1=require(a111_0x1f929a(0x1e4)),core_1=require(a111_0x1f929a(0x1d4)),too_many_requests_error_1=require(a111_0x1f929a(0x1cb)),flosum_repository_sync_dto_1=require(a111_0x1f929a(0x1f2)),salesforce_error_1=require(a111_0x1f929a(0x1e5)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a111_0x1f929a(0x1c0)),utils_1=require(a111_0x1f929a(0x18a)),typedi_1=require('typedi'),hooks_utils_1=require('../../providers/web-hooks/hooks.utils'),git_branch_not_found_error_1=require(a111_0x1f929a(0x18c)),flosum_sync_job_1=require(a111_0x1f929a(0x1be)),git_sync_job_1=require(a111_0x1f929a(0x1b4)),providers_tokens_1=require(a111_0x1f929a(0x1a6)),bad_request_error_1=require(a111_0x1f929a(0x1ee));let SyncService=SyncService_1=class SyncService{constructor(_0x645271,_0x293c2a){const _0x10724f=a111_0x1f929a;this['salesforceService']=_0x645271,this[_0x10724f(0x18f)]=_0x293c2a,this[_0x10724f(0x1f7)]=new core_1[(_0x10724f(0x1e7))](SyncService_1[_0x10724f(0x1b9)]),this[_0x10724f(0x206)]={},this['repoList']=[];}async[a111_0x1f929a(0x1c8)](_0xa7f5ba,_0x3cd423){const _0x378ddd=a111_0x1f929a;if(_0x3cd423 instanceof git_branch_not_found_error_1[_0x378ddd(0x1f3)]){await this[_0x378ddd(0x18f)]['setStatus'](_0xa7f5ba,'Not\x20Synchronized');return;}if(_0x3cd423 instanceof too_many_requests_error_1[_0x378ddd(0x20b)]){await this[_0x378ddd(0x18f)][_0x378ddd(0x1b0)](_0xa7f5ba,_0x378ddd(0x1a4));throw _0x3cd423;}try{await this[_0x378ddd(0x1df)][_0x378ddd(0x1a7)](this[_0x378ddd(0x199)]+_0x378ddd(0x205)+_0xa7f5ba['repositoryName']+_0x378ddd(0x1dc)+_0xa7f5ba[_0x378ddd(0x1d7)]+']\x20due\x20error\x20-\x20'+_0x3cd423+'.')[_0x378ddd(0x1f5)](),await this[_0x378ddd(0x18f)][_0x378ddd(0x1e8)](_0xa7f5ba,{}),await this['salesforceSync'][_0x378ddd(0x1b0)](_0xa7f5ba,_0x378ddd(0x1c4));}catch(_0x1630c1){if(_0x1630c1 instanceof salesforce_error_1[_0x378ddd(0x1cd)])throw _0x1630c1;}}async[a111_0x1f929a(0x1f0)](_0x3fa4a1){const _0x84df20=a111_0x1f929a;if(_0x3fa4a1[_0x84df20(0x202)]){const _0x4b63b0=_0x3fa4a1[_0x84df20(0x1d9)][_0x84df20(0x19e)](),_0x5bbbb0=this[_0x84df20(0x206)][_0x4b63b0];if(!_0x5bbbb0)this['repositoriesIntersections'][_0x4b63b0]=_0x3fa4a1['repositoryName'];else{if(_0x5bbbb0&&_0x5bbbb0!==_0x3fa4a1[_0x84df20(0x1d9)])return await this[_0x84df20(0x1c8)](_0x3fa4a1,new Error(_0x84df20(0x1c9)+_0x3fa4a1[_0x84df20(0x1d9)]+_0x84df20(0x1ec)+_0x4b63b0+_0x84df20(0x1c7)+_0x5bbbb0+'\x27')),!![];}}return![];}async[a111_0x1f929a(0x18b)](_0x33fdfc){const _0x51d415=a111_0x1f929a;if(!constants_1[_0x51d415(0x1ce)][_0x51d415(0x20d)](_0x33fdfc[_0x51d415(0x1d9)]))return await this[_0x51d415(0x1c8)](_0x33fdfc,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x33fdfc[_0x51d415(0x1d9)]+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1[_0x51d415(0x1b5)]['test'](_0x33fdfc[_0x51d415(0x1d7)]))return await this[_0x51d415(0x1c8)](_0x33fdfc,new Error(_0x51d415(0x1de)+_0x33fdfc[_0x51d415(0x1d7)]+_0x51d415(0x1cf)+_0x33fdfc[_0x51d415(0x1d9)]+_0x51d415(0x196))),![];return!![];}async[a111_0x1f929a(0x200)](_0x3859a1,_0x1f0ae5){const _0x384455=a111_0x1f929a;let _0x416320=this[_0x384455(0x1ab)][_0x384455(0x1a2)](_0x13632a=>_0x3859a1['repositoryName']===_0x13632a[_0x384455(0x1b9)]);!_0x416320&&(this['sfLogger'][_0x384455(0x1bd)](this['prefix']+_0x384455(0x201)+_0x3859a1[_0x384455(0x1d9)]+_0x384455(0x1a8)),_0x416320=await this[_0x384455(0x190)][_0x384455(0x1f6)]({'name':_0x3859a1['repositoryName'],'autoInit':!![],'defaultBranch':_0x3859a1[_0x384455(0x1d7)],'private':!![],'createHook':typedi_1['Container'][_0x384455(0x1d8)](providers_tokens_1[_0x384455(0x1e0)]['config'])[_0x384455(0x1f1)]}));if(this[_0x384455(0x1d6)][_0x384455(0x1f1)]){const _0x348bca=await _0x416320[_0x384455(0x1ef)][_0x384455(0x203)]();!_0x348bca[_0x384455(0x1a2)](_0x362906=>_0x362906['url']===hooks_utils_1['HooksUtils']['getHookLinkFor'](this[_0x384455(0x1d6)]['gitProvider'],this[_0x384455(0x1d6)]['applicationUrl'],_0x1f0ae5))&&(this[_0x384455(0x1df)][_0x384455(0x1bd)](this[_0x384455(0x199)]+_0x384455(0x201)+_0x3859a1[_0x384455(0x1d9)]+_0x384455(0x1c3)),await _0x416320[_0x384455(0x1ef)][_0x384455(0x1f6)](hooks_utils_1[_0x384455(0x1a1)][_0x384455(0x1e1)](this[_0x384455(0x1d6)][_0x384455(0x1fa)],_0x416320['hooks'],this['config'][_0x384455(0x1fc)],_0x1f0ae5)));}return this[_0x384455(0x1ab)][_0x384455(0x1bc)](_0x416320),_0x416320;}async[a111_0x1f929a(0x208)](){const _0x2e079b=a111_0x1f929a;this[_0x2e079b(0x1c2)]=typedi_1[_0x2e079b(0x1d5)][_0x2e079b(0x1d8)](providers_tokens_1[_0x2e079b(0x1e0)][_0x2e079b(0x1c2)]),this[_0x2e079b(0x190)]=typedi_1[_0x2e079b(0x1d5)][_0x2e079b(0x1d8)](providers_tokens_1['Tokens']['gitRepoService']),this[_0x2e079b(0x1d6)]=typedi_1[_0x2e079b(0x1d5)]['get'](providers_tokens_1[_0x2e079b(0x1e0)][_0x2e079b(0x1d6)]),this[_0x2e079b(0x1df)]=typedi_1[_0x2e079b(0x1d5)][_0x2e079b(0x1d8)](providers_tokens_1[_0x2e079b(0x1e0)][_0x2e079b(0x1f7)]),this['prefix']='['+SyncService_1[_0x2e079b(0x1b9)]+_0x2e079b(0x1e6)+this[_0x2e079b(0x1d6)][_0x2e079b(0x1fa)][_0x2e079b(0x19d)]()+']',this[_0x2e079b(0x1e3)][_0x2e079b(0x1a0)](this[_0x2e079b(0x1df)]['getLoggerId']());try{this[_0x2e079b(0x1df)][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x1b8)),await this['sfLogger'][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x191))[_0x2e079b(0x1f5)]();const _0x5bddb9=await this['salesforceSync']['getRepositoryRecords'](typedi_1[_0x2e079b(0x1d5)][_0x2e079b(0x1d8)](providers_tokens_1[_0x2e079b(0x1e0)][_0x2e079b(0x198)]));if(!_0x5bddb9[_0x2e079b(0x1fd)])throw new bad_request_error_1['BadRequestError'](this[_0x2e079b(0x199)]+_0x2e079b(0x1b1));await this['sfLogger'][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x1a3))[_0x2e079b(0x1f5)]();const _0x2c8533=await this[_0x2e079b(0x18f)][_0x2e079b(0x204)](_0x5bddb9[_0x2e079b(0x207)](_0x16d633=>'\x27'+_0x16d633['repositoryId']+'\x27')[_0x2e079b(0x1b6)](','));await this[_0x2e079b(0x1df)][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x1e9))[_0x2e079b(0x1f5)](),this['repoList']=await this[_0x2e079b(0x190)][_0x2e079b(0x203)]();const _0x1353eb=[..._0x5bddb9,..._0x2c8533];this[_0x2e079b(0x1df)]['log'](this['prefix']+_0x2e079b(0x1e2)+_0x1353eb['length']+_0x2e079b(0x1ac));for(const _0x2d74c2 of _0x1353eb){this[_0x2e079b(0x1f7)][_0x2e079b(0x1bd)]('Syncing\x20'+_0x2d74c2[_0x2e079b(0x1d9)]+'['+_0x2d74c2[_0x2e079b(0x202)]+_0x2e079b(0x1af)+_0x2d74c2['branchName']+'['+_0x2d74c2[_0x2e079b(0x1c1)]+_0x2e079b(0x18d)),this['sfLogger']['log'](this[_0x2e079b(0x199)]+_0x2e079b(0x1dd)+_0x2d74c2[_0x2e079b(0x1d9)]+_0x2e079b(0x1b3)+_0x2d74c2[_0x2e079b(0x1d7)]+'\x22.'),this[_0x2e079b(0x1df)][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+'\x20Checking\x20valid\x20name.');const _0x4660d5=await this['checkValidNaming'](_0x2d74c2);if(!_0x4660d5)continue;this[_0x2e079b(0x1df)][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x197));const _0x290e56=await this[_0x2e079b(0x1f0)](_0x2d74c2);if(_0x290e56)continue;await this[_0x2e079b(0x1df)][_0x2e079b(0x1f5)]();let _0x5da65f;try{await this[_0x2e079b(0x1df)]['log'](this['prefix']+_0x2e079b(0x1bf))[_0x2e079b(0x1f5)](),_0x5da65f=await this['getOrCreateRepo'](_0x2d74c2,typedi_1[_0x2e079b(0x1d5)]['get'](providers_tokens_1[_0x2e079b(0x1e0)][_0x2e079b(0x198)]));}catch(_0x141270){await this[_0x2e079b(0x1c8)](_0x2d74c2,_0x141270 instanceof too_many_requests_error_1[_0x2e079b(0x20b)]?_0x141270:new Error(_0x2e079b(0x18e)+_0x141270));continue;}await this[_0x2e079b(0x1df)][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x1ca))['send']();if(_0x2d74c2[_0x2e079b(0x192)]===flosum_repository_sync_dto_1[_0x2e079b(0x1bb)]['FlosumToGit']){const _0x55ca18=typedi_1[_0x2e079b(0x1d5)][_0x2e079b(0x1d8)](flosum_sync_job_1[_0x2e079b(0x209)]);await _0x55ca18['run']({'repository':_0x5da65f,'convertToSFDX':this[_0x2e079b(0x1d6)][_0x2e079b(0x19f)],'syncRecord':_0x2d74c2,'provider':this[_0x2e079b(0x1d6)][_0x2e079b(0x1fa)]})[_0x2e079b(0x1ea)](_0x11cfdb=>this[_0x2e079b(0x1c8)](_0x2d74c2,_0x11cfdb));}else{const _0x562892=typedi_1[_0x2e079b(0x1d5)][_0x2e079b(0x1d8)](git_sync_job_1[_0x2e079b(0x1f8)]);await _0x562892['run']({'repository':_0x5da65f,'branch':_0x2d74c2[_0x2e079b(0x1d7)],'provider':this[_0x2e079b(0x1d6)][_0x2e079b(0x1fa)],'repositoryGit':_0x5da65f[_0x2e079b(0x20c)],'syncRecord':_0x2d74c2})['catch'](_0x527887=>this[_0x2e079b(0x1c8)](_0x2d74c2,_0x527887));}}}catch(_0x4b559b){this[_0x2e079b(0x1f7)][_0x2e079b(0x1a7)](_0x4b559b);_0x4b559b instanceof too_many_requests_error_1['TooManyRequests']?(await this['sfLogger'][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x195))[_0x2e079b(0x1f5)](),await(0x0,utils_1['sleep'])(0x3c*0x3c*0x3e8),this[_0x2e079b(0x208)]()):await this[_0x2e079b(0x1df)][_0x2e079b(0x1a7)](this[_0x2e079b(0x199)]+_0x2e079b(0x1f4)+_0x4b559b)[_0x2e079b(0x1f5)]();return;}await this[_0x2e079b(0x1df)][_0x2e079b(0x1bd)](this[_0x2e079b(0x199)]+_0x2e079b(0x1cc))[_0x2e079b(0x1f5)](),await this[_0x2e079b(0x18f)][_0x2e079b(0x1fb)](typedi_1[_0x2e079b(0x1d5)][_0x2e079b(0x1d8)](providers_tokens_1[_0x2e079b(0x1e0)][_0x2e079b(0x198)]))[_0x2e079b(0x1ea)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x1f929a(0x1ed)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a111_0x1f929a(0x1b7)],salesforce_sync_service_1[a111_0x1f929a(0x1a9)]])],SyncService),exports['SyncService']=SyncService;