const a67_0x54f766=a67_0x4198;(function(_0x35e191,_0x4baa92){const _0x474fec=a67_0x4198,_0x3a3a4a=_0x35e191();while(!![]){try{const _0x5c87ae=parseInt(_0x474fec(0xad))/0x1+-parseInt(_0x474fec(0x103))/0x2*(parseInt(_0x474fec(0xc6))/0x3)+-parseInt(_0x474fec(0xfe))/0x4+parseInt(_0x474fec(0xf4))/0x5*(-parseInt(_0x474fec(0xd2))/0x6)+-parseInt(_0x474fec(0xd1))/0x7*(parseInt(_0x474fec(0xba))/0x8)+parseInt(_0x474fec(0xb1))/0x9*(-parseInt(_0x474fec(0xa4))/0xa)+parseInt(_0x474fec(0xe9))/0xb;if(_0x5c87ae===_0x4baa92)break;else _0x3a3a4a['push'](_0x3a3a4a['shift']());}catch(_0xf674bb){_0x3a3a4a['push'](_0x3a3a4a['shift']());}}}(a67_0x3d7c,0xd7d94));const a67_0x3ab217=(function(){let _0x42af50=!![];return function(_0xe332ee,_0x2adcf6){const _0x16f9e2=_0x42af50?function(){const _0x2301d2=a67_0x4198;if(_0x2adcf6){const _0x421756=_0x2adcf6[_0x2301d2(0xc2)](_0xe332ee,arguments);return _0x2adcf6=null,_0x421756;}}:function(){};return _0x42af50=![],_0x16f9e2;};}()),a67_0x7ae78a=a67_0x3ab217(this,function(){const _0x3bea04=a67_0x4198;return a67_0x7ae78a[_0x3bea04(0xa6)]()[_0x3bea04(0xa7)](_0x3bea04(0xb0))[_0x3bea04(0xa6)]()[_0x3bea04(0xf3)](a67_0x7ae78a)[_0x3bea04(0xa7)](_0x3bea04(0xb0));});function a67_0x4198(_0x60e185,_0x6cab7f){const _0x4fcb78=a67_0x3d7c();return a67_0x4198=function(_0x7ae78a,_0x3ab217){_0x7ae78a=_0x7ae78a-0x9c;let _0x3d7cbb=_0x4fcb78[_0x7ae78a];return _0x3d7cbb;},a67_0x4198(_0x60e185,_0x6cab7f);}a67_0x7ae78a();'use strict';function a67_0x3d7c(){const _0x1ceed8=['constructor','45nbezEa','REPOSITORY_NAME_REGEXP','../../../../core/errors/too-many-requests.error','object','error','metadata','send','../jobs/flosum-sync.job',']\x20[','logger','6650020Ogaabu','repoService','run','repositoryName','Container','4NjaUPw',']\x20repository\x20','getRepositoryRecords','\x27\x20[','name','getBranchRecords','isBidirectionalSynchronization','disableSync','design:paramtypes','Unable\x20to\x20synchronize\x20repository\x20\x27','gitApiService','isConvertToSfdx','checkValidNaming','function','\x27\x20-\x20\x27','SyncService','Service','../../../../core','\x20Stop\x20sync\x20job\x20for\x20\x27','Unable\x20to\x20synchronize\x20branch\x20\x27','setStatus','gitUrl','\x20Getting\x20branch\x20records.','RepositoryFactory',']\x20due\x20error\x20-\x20','\x20Getting\x20Flosum\x20repository','GitSyncJob','\x20Getting\x20repository\x20records.','toLowerCase','TooManyRequests','SyncDirection','gitProvider','\x20Start\x20sync\x20job.','39030YELrhp','\x20branches.','toString','search','\x27\x20in\x20repository\x20\x27','../../providers/providers.tokens','\x20Checking\x20valid\x20name.','map','repositoryId','496737MGFrep','toUpperCase','branchName','(((.+)+)+)+$','2007FGmuWD','config','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','HooksUtils','prefix','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','createHookPayload','hooks','setLoggerId','16wvnylF','Syncing\x20','getHookLinkFor','salesforceSync','salesforceService','FlosumSyncJob',']\x20branch.','\x20Getting\x20repositories\x20from\x20git\x20service.','apply','get','../../salesforce/services/salesforce.service','find','552873bZXilX','length','../utils/connection','\x22\x20branch:\x20\x22','__decorate','handleRecordSyncError','sfLogger','BRANCH_NAME_REGEXP','Tokens','catch','../../../shared/utils','4158721ZEvWkO','715812dwDrbF','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','SalesforceService','create','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','log','../../providers/repositories/repository.factory','../../salesforce/dto/flosum-repository-sync.dto','__esModule','\x20Repository\x20\x22','push','createFromConnection','defineProperty','applicationUrl','url','providersFactory','SalesforceError','updateRemoteState','\x20Sync\x20job\x20done.','getLoggerId','isIntersects','Logger','test','61058349ZxISkl','__metadata','../../salesforce/services/salesforce-sync.service','repositoriesIntersections','repoList','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','\x20Checking\x20intersects.','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','../../salesforce/errors/salesforce.error','../jobs/git-sync.job'];a67_0x3d7c=function(){return _0x1ceed8;};return a67_0x3d7c();}var __decorate=this&&this[a67_0x54f766(0xca)]||function(_0x3f4e42,_0x1af005,_0x45718b,_0x333f8b){const _0x198e49=a67_0x54f766;var _0x130dac=arguments[_0x198e49(0xc7)],_0x1e77cf=_0x130dac<0x3?_0x1af005:_0x333f8b===null?_0x333f8b=Object['getOwnPropertyDescriptor'](_0x1af005,_0x45718b):_0x333f8b,_0x30f858;if(typeof Reflect===_0x198e49(0xf7)&&typeof Reflect['decorate']===_0x198e49(0x110))_0x1e77cf=Reflect['decorate'](_0x3f4e42,_0x1af005,_0x45718b,_0x333f8b);else{for(var _0x332d80=_0x3f4e42[_0x198e49(0xc7)]-0x1;_0x332d80>=0x0;_0x332d80--)if(_0x30f858=_0x3f4e42[_0x332d80])_0x1e77cf=(_0x130dac<0x3?_0x30f858(_0x1e77cf):_0x130dac>0x3?_0x30f858(_0x1af005,_0x45718b,_0x1e77cf):_0x30f858(_0x1af005,_0x45718b))||_0x1e77cf;}return _0x130dac>0x3&&_0x1e77cf&&Object[_0x198e49(0xde)](_0x1af005,_0x45718b,_0x1e77cf),_0x1e77cf;},__metadata=this&&this[a67_0x54f766(0xea)]||function(_0x4380c1,_0x4f2afd){const _0x30a797=a67_0x54f766;if(typeof Reflect===_0x30a797(0xf7)&&typeof Reflect[_0x30a797(0xf9)]===_0x30a797(0x110))return Reflect['metadata'](_0x4380c1,_0x4f2afd);},SyncService_1;Object[a67_0x54f766(0xde)](exports,a67_0x54f766(0xda),{'value':!![]}),exports[a67_0x54f766(0x112)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a67_0x54f766(0x114)),too_many_requests_error_1=require(a67_0x54f766(0xf6)),flosum_repository_sync_dto_1=require(a67_0x54f766(0xd9)),salesforce_error_1=require(a67_0x54f766(0xf1)),salesforce_sync_service_1=require(a67_0x54f766(0xeb)),salesforce_service_1=require(a67_0x54f766(0xc4)),utils_1=require(a67_0x54f766(0xd0)),typedi_1=require('typedi'),hooks_utils_1=require('../../providers/web-hooks/hooks.utils'),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require(a67_0x54f766(0xfb)),git_sync_job_1=require(a67_0x54f766(0xf2)),repository_factory_1=require(a67_0x54f766(0xd8)),connection_1=require(a67_0x54f766(0xc8)),providers_tokens_1=require(a67_0x54f766(0xa9));let SyncService=SyncService_1=class SyncService{constructor(_0x2e05ff,_0x4eac82,_0x158ddd){const _0x56d712=a67_0x54f766;this[_0x56d712(0xbe)]=_0x2e05ff,this[_0x56d712(0xbd)]=_0x4eac82,this['providersFactory']=_0x158ddd,this['logger']=new core_1[(_0x56d712(0xe7))](SyncService_1[_0x56d712(0x107)]),this['repositoriesIntersections']={},this[_0x56d712(0xed)]=[];}async[a67_0x54f766(0xcb)](_0x1e46af,_0x3c590d){const _0x5d421b=a67_0x54f766;if(_0x3c590d instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this[_0x5d421b(0xbd)][_0x5d421b(0x117)](_0x1e46af,'Not\x20Synchronized');return;}if(_0x3c590d instanceof too_many_requests_error_1[_0x5d421b(0xa0)]){await this[_0x5d421b(0xbd)][_0x5d421b(0x117)](_0x1e46af,'Waiting');throw _0x3c590d;}try{await this['sfLogger'][_0x5d421b(0xf8)](this[_0x5d421b(0xb5)]+_0x5d421b(0x115)+_0x1e46af[_0x5d421b(0x101)]+_0x5d421b(0x106)+_0x1e46af['branchName']+_0x5d421b(0x11b)+_0x3c590d+'.')[_0x5d421b(0xfa)](),await this[_0x5d421b(0xbd)][_0x5d421b(0xe3)](_0x1e46af,{}),await this['salesforceSync'][_0x5d421b(0x117)](_0x1e46af,'Error');}catch(_0x34152b){if(_0x34152b instanceof salesforce_error_1[_0x5d421b(0xe2)])throw _0x34152b;}}async[a67_0x54f766(0xe6)](_0x1ec23e){const _0x242ff1=a67_0x54f766;if(_0x1ec23e[_0x242ff1(0xac)]){const _0x3d42cf=_0x1ec23e[_0x242ff1(0x101)][_0x242ff1(0x9f)](),_0x50240a=this['repositoriesIntersections'][_0x3d42cf];if(!_0x50240a)this[_0x242ff1(0xec)][_0x3d42cf]=_0x1ec23e[_0x242ff1(0x101)];else{if(_0x50240a&&_0x50240a!==_0x1ec23e[_0x242ff1(0x101)])return await this[_0x242ff1(0xcb)](_0x1ec23e,new Error(_0x242ff1(0x10c)+_0x1ec23e[_0x242ff1(0x101)]+_0x242ff1(0xee)+_0x3d42cf+_0x242ff1(0x111)+_0x50240a+'\x27')),!![];}}return![];}async[a67_0x54f766(0x10f)](_0x15c883){const _0x2ba4e0=a67_0x54f766;if(!constants_1[_0x2ba4e0(0xf5)][_0x2ba4e0(0xe8)](_0x15c883[_0x2ba4e0(0x101)]))return await this['handleRecordSyncError'](_0x15c883,new Error(_0x2ba4e0(0x10c)+_0x15c883[_0x2ba4e0(0x101)]+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1[_0x2ba4e0(0xcd)][_0x2ba4e0(0xe8)](_0x15c883[_0x2ba4e0(0xaf)]))return await this[_0x2ba4e0(0xcb)](_0x15c883,new Error(_0x2ba4e0(0x116)+_0x15c883[_0x2ba4e0(0xaf)]+_0x2ba4e0(0xa8)+_0x15c883[_0x2ba4e0(0x101)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async['getOrCreateRepo'](_0x1c4784,_0x53c151){const _0x4e073c=a67_0x54f766;let _0x270af7=this[_0x4e073c(0xed)][_0x4e073c(0xc5)](_0x54728c=>_0x1c4784[_0x4e073c(0x101)]===_0x54728c[_0x4e073c(0x107)]);!_0x270af7&&(this['sfLogger'][_0x4e073c(0xd7)](this[_0x4e073c(0xb5)]+_0x4e073c(0xdb)+_0x1c4784[_0x4e073c(0x101)]+_0x4e073c(0xd3)),_0x270af7=await this[_0x4e073c(0xff)][_0x4e073c(0xd5)]({'name':_0x1c4784['repositoryName'],'autoInit':!![],'defaultBranch':_0x1c4784[_0x4e073c(0xaf)],'private':!![],'createHook':typedi_1[_0x4e073c(0x102)][_0x4e073c(0xc3)](providers_tokens_1[_0x4e073c(0xce)][_0x4e073c(0xb2)])[_0x4e073c(0x109)]}));if(this[_0x4e073c(0xb2)][_0x4e073c(0x109)]){const _0x4b4fef=await _0x270af7['hooks']['getAll']();!_0x4b4fef[_0x4e073c(0xc5)](_0x5d8767=>_0x5d8767[_0x4e073c(0xe0)]===hooks_utils_1['HooksUtils'][_0x4e073c(0xbc)](this[_0x4e073c(0xb2)][_0x4e073c(0xa2)],this[_0x4e073c(0xb2)][_0x4e073c(0xdf)],_0x53c151))&&(this['sfLogger']['log'](this[_0x4e073c(0xb5)]+_0x4e073c(0xdb)+_0x1c4784['repositoryName']+_0x4e073c(0xf0)),await _0x270af7['hooks'][_0x4e073c(0xd5)](hooks_utils_1[_0x4e073c(0xb4)][_0x4e073c(0xb7)](this[_0x4e073c(0xb2)]['gitProvider'],_0x270af7[_0x4e073c(0xb8)],this[_0x4e073c(0xb2)][_0x4e073c(0xdf)],_0x53c151)));}return this[_0x4e073c(0xed)][_0x4e073c(0xdc)](_0x270af7),_0x270af7;}async['run'](_0x564ecf){const _0x1e90b1=a67_0x54f766;this[_0x1e90b1(0x10d)]=await this[_0x1e90b1(0xe1)][_0x1e90b1(0xdd)](_0x564ecf),this[_0x1e90b1(0xff)]=await repository_factory_1[_0x1e90b1(0x11a)]['createFromContext'](typedi_1[_0x1e90b1(0x102)]),this[_0x1e90b1(0xb2)]=typedi_1['Container'][_0x1e90b1(0xc3)](providers_tokens_1['Tokens'][_0x1e90b1(0xb2)]),this[_0x1e90b1(0xcc)]=typedi_1['Container'][_0x1e90b1(0xc3)](providers_tokens_1[_0x1e90b1(0xce)][_0x1e90b1(0xfd)]),this[_0x1e90b1(0xb5)]='['+SyncService_1['name']+_0x1e90b1(0xfc)+this['config'][_0x1e90b1(0xa2)][_0x1e90b1(0xae)]()+']',this[_0x1e90b1(0xbe)][_0x1e90b1(0xb9)](this[_0x1e90b1(0xcc)][_0x1e90b1(0xe5)]());try{this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+_0x1e90b1(0xa3)),await this['sfLogger'][_0x1e90b1(0xd7)](this['prefix']+_0x1e90b1(0x9e))['send']();const _0x5c29c2=await this[_0x1e90b1(0xbd)][_0x1e90b1(0x105)](_0x564ecf);await this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this['prefix']+_0x1e90b1(0x119))[_0x1e90b1(0xfa)]();const _0x190952=await this[_0x1e90b1(0xbd)][_0x1e90b1(0x108)](_0x5c29c2[_0x1e90b1(0xab)](_0x364411=>'\x27'+_0x364411[_0x1e90b1(0xac)]+'\x27')['join'](','));await this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this['prefix']+_0x1e90b1(0xc1))[_0x1e90b1(0xfa)](),this[_0x1e90b1(0xed)]=await this[_0x1e90b1(0xff)]['getAll']();const _0x4b0470=[..._0x5c29c2,..._0x190952];this['sfLogger'][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+'\x20Have\x20to\x20synchronize\x20'+_0x4b0470[_0x1e90b1(0xc7)]+_0x1e90b1(0xa5));for(const _0x134fd4 of _0x4b0470){this['logger'][_0x1e90b1(0xd7)](_0x1e90b1(0xbb)+_0x134fd4[_0x1e90b1(0x101)]+'['+_0x134fd4[_0x1e90b1(0xac)]+_0x1e90b1(0x104)+_0x134fd4['branchName']+'['+_0x134fd4['branchId']+_0x1e90b1(0xc0)),this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+'\x20Syncing\x20repository:\x20\x22'+_0x134fd4[_0x1e90b1(0x101)]+_0x1e90b1(0xc9)+_0x134fd4[_0x1e90b1(0xaf)]+'\x22.'),this[_0x1e90b1(0xcc)]['log'](this[_0x1e90b1(0xb5)]+_0x1e90b1(0xaa));const _0x46f505=await this[_0x1e90b1(0x10f)](_0x134fd4);if(!_0x46f505)continue;this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+_0x1e90b1(0xef));const _0x5ddb8f=await this[_0x1e90b1(0xe6)](_0x134fd4);if(_0x5ddb8f)continue;await this[_0x1e90b1(0xcc)][_0x1e90b1(0xfa)]();let _0x9f1afd;try{await this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+_0x1e90b1(0x9c))['send'](),_0x9f1afd=await this['getOrCreateRepo'](_0x134fd4,_0x564ecf);}catch(_0x4cb873){await this[_0x1e90b1(0xcb)](_0x134fd4,_0x4cb873 instanceof too_many_requests_error_1[_0x1e90b1(0xa0)]?_0x4cb873:new Error(_0x1e90b1(0xb6)+_0x4cb873));continue;}await this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+'\x20Completed\x20prepare\x20to\x20syncing.')[_0x1e90b1(0xfa)]();if(_0x134fd4['direction']===flosum_repository_sync_dto_1[_0x1e90b1(0xa1)]['FlosumToGit']){const _0x5f539e=typedi_1['Container'][_0x1e90b1(0xc3)](flosum_sync_job_1[_0x1e90b1(0xbf)]);await _0x5f539e['run']({'repository':_0x9f1afd,'convertToSFDX':this['config'][_0x1e90b1(0x10e)],'syncRecord':_0x134fd4,'provider':this[_0x1e90b1(0xb2)][_0x1e90b1(0xa2)]})[_0x1e90b1(0xcf)](_0x2273e9=>this['handleRecordSyncError'](_0x134fd4,_0x2273e9));}else{const _0x30c632=typedi_1[_0x1e90b1(0x102)]['get'](git_sync_job_1[_0x1e90b1(0x9d)]);await _0x30c632[_0x1e90b1(0x100)]({'repository':_0x9f1afd,'branch':_0x134fd4['branchName'],'provider':this['config'][_0x1e90b1(0xa2)],'repositoryGit':_0x9f1afd[_0x1e90b1(0x118)],'syncRecord':_0x134fd4})['catch'](_0x451822=>this[_0x1e90b1(0xcb)](_0x134fd4,_0x451822));}}}catch(_0x400af6){this[_0x1e90b1(0xfd)][_0x1e90b1(0xf8)](_0x400af6);_0x400af6 instanceof too_many_requests_error_1[_0x1e90b1(0xa0)]?(await this['sfLogger'][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+_0x1e90b1(0xb3))[_0x1e90b1(0xfa)](),await utils_1['sleep'](0x3c*0x3c*0x3e8),this[_0x1e90b1(0x100)](this[_0x1e90b1(0xb2)][_0x1e90b1(0xa2)])):await this[_0x1e90b1(0xcc)][_0x1e90b1(0xf8)](this[_0x1e90b1(0xb5)]+_0x1e90b1(0xd6)+_0x400af6)['send']();return;}await this[_0x1e90b1(0xcc)][_0x1e90b1(0xd7)](this[_0x1e90b1(0xb5)]+_0x1e90b1(0xe4))['send'](),await this['salesforceSync'][_0x1e90b1(0x10a)](_0x564ecf)[_0x1e90b1(0xcf)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a67_0x54f766(0x113)]({'transient':!![]}),__metadata(a67_0x54f766(0x10b),[salesforce_service_1[a67_0x54f766(0xd4)],salesforce_sync_service_1['SalesforceSyncService'],connection_1['ProvidersFactory']])],SyncService),exports[a67_0x54f766(0x112)]=SyncService;