const a67_0x6cdb09=a67_0x1da4;(function(_0x463345,_0x113373){const _0x315339=a67_0x1da4,_0x217445=_0x463345();while(!![]){try{const _0x3292b0=parseInt(_0x315339(0x149))/0x1*(parseInt(_0x315339(0x113))/0x2)+parseInt(_0x315339(0x12b))/0x3*(parseInt(_0x315339(0x14f))/0x4)+-parseInt(_0x315339(0xda))/0x5*(-parseInt(_0x315339(0xfe))/0x6)+-parseInt(_0x315339(0xeb))/0x7*(-parseInt(_0x315339(0x119))/0x8)+-parseInt(_0x315339(0xf5))/0x9+-parseInt(_0x315339(0x111))/0xa*(-parseInt(_0x315339(0xd5))/0xb)+-parseInt(_0x315339(0x14b))/0xc*(parseInt(_0x315339(0x103))/0xd);if(_0x3292b0===_0x113373)break;else _0x217445['push'](_0x217445['shift']());}catch(_0x58ec58){_0x217445['push'](_0x217445['shift']());}}}(a67_0x397e,0xbf440));const a67_0x239ee9=(function(){let _0x44e43c=!![];return function(_0x1d5db8,_0x1f459e){const _0x470636=_0x44e43c?function(){if(_0x1f459e){const _0x268586=_0x1f459e['apply'](_0x1d5db8,arguments);return _0x1f459e=null,_0x268586;}}:function(){};return _0x44e43c=![],_0x470636;};}()),a67_0x156135=a67_0x239ee9(this,function(){const _0xa960b9=a67_0x1da4;return a67_0x156135[_0xa960b9(0x138)]()[_0xa960b9(0xe2)](_0xa960b9(0x132))[_0xa960b9(0x138)]()[_0xa960b9(0xf2)](a67_0x156135)[_0xa960b9(0xe2)](_0xa960b9(0x132));});a67_0x156135();'use strict';function a67_0x1da4(_0x396d4f,_0x50dfc7){const _0x145de4=a67_0x397e();return a67_0x1da4=function(_0x156135,_0x239ee9){_0x156135=_0x156135-0xd4;let _0x397e7b=_0x145de4[_0x156135];return _0x397e7b;},a67_0x1da4(_0x396d4f,_0x50dfc7);}var __decorate=this&&this[a67_0x6cdb09(0x12c)]||function(_0x51826a,_0x1a0b16,_0x2017a2,_0x4913e7){const _0x5b21ba=a67_0x6cdb09;var _0x1da82f=arguments[_0x5b21ba(0x147)],_0x2fd313=_0x1da82f<0x3?_0x1a0b16:_0x4913e7===null?_0x4913e7=Object[_0x5b21ba(0xde)](_0x1a0b16,_0x2017a2):_0x4913e7,_0x3c880e;if(typeof Reflect==='object'&&typeof Reflect[_0x5b21ba(0x11e)]==='function')_0x2fd313=Reflect['decorate'](_0x51826a,_0x1a0b16,_0x2017a2,_0x4913e7);else{for(var _0x4e2dea=_0x51826a[_0x5b21ba(0x147)]-0x1;_0x4e2dea>=0x0;_0x4e2dea--)if(_0x3c880e=_0x51826a[_0x4e2dea])_0x2fd313=(_0x1da82f<0x3?_0x3c880e(_0x2fd313):_0x1da82f>0x3?_0x3c880e(_0x1a0b16,_0x2017a2,_0x2fd313):_0x3c880e(_0x1a0b16,_0x2017a2))||_0x2fd313;}return _0x1da82f>0x3&&_0x2fd313&&Object[_0x5b21ba(0x11f)](_0x1a0b16,_0x2017a2,_0x2fd313),_0x2fd313;},__metadata=this&&this['__metadata']||function(_0x53d885,_0x17c97b){const _0xb02e48=a67_0x6cdb09;if(typeof Reflect===_0xb02e48(0x141)&&typeof Reflect['metadata']===_0xb02e48(0xf8))return Reflect[_0xb02e48(0x12a)](_0x53d885,_0x17c97b);},SyncService_1;Object[a67_0x6cdb09(0x11f)](exports,a67_0x6cdb09(0x14d),{'value':!![]}),exports[a67_0x6cdb09(0xe5)]=void 0x0;const constants_1=require(a67_0x6cdb09(0x155)),core_1=require(a67_0x6cdb09(0x120)),too_many_requests_error_1=require(a67_0x6cdb09(0x139)),flosum_repository_sync_dto_1=require(a67_0x6cdb09(0x136)),salesforce_error_1=require(a67_0x6cdb09(0x10c)),salesforce_sync_service_1=require(a67_0x6cdb09(0x116)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),utils_1=require('../../../shared/utils'),typedi_1=require(a67_0x6cdb09(0x14a)),hooks_utils_1=require(a67_0x6cdb09(0xe3)),git_branch_not_found_error_1=require(a67_0x6cdb09(0x121)),flosum_sync_job_1=require(a67_0x6cdb09(0x108)),git_sync_job_1=require(a67_0x6cdb09(0x11d)),connection_1=require(a67_0x6cdb09(0x101)),providers_tokens_1=require(a67_0x6cdb09(0xe0));let SyncService=SyncService_1=class SyncService{constructor(_0x14949c,_0x140ea9,_0x2aae6b){const _0x56c1a7=a67_0x6cdb09;this[_0x56c1a7(0x11c)]=_0x14949c,this[_0x56c1a7(0xf4)]=_0x140ea9,this[_0x56c1a7(0xfc)]=_0x2aae6b,this[_0x56c1a7(0x140)]=new core_1[(_0x56c1a7(0x10e))](SyncService_1[_0x56c1a7(0x13e)]),this[_0x56c1a7(0x13a)]={},this[_0x56c1a7(0xe7)]=[];}async[a67_0x6cdb09(0x107)](_0x27166e,_0x163ce8){const _0x2d9c9a=a67_0x6cdb09;if(_0x163ce8 instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this['salesforceSync'][_0x2d9c9a(0x145)](_0x27166e,'Not\x20Synchronized');return;}if(_0x163ce8 instanceof too_many_requests_error_1[_0x2d9c9a(0xfb)]){await this[_0x2d9c9a(0xf4)]['setStatus'](_0x27166e,_0x2d9c9a(0x14c));throw _0x163ce8;}try{await this[_0x2d9c9a(0x114)][_0x2d9c9a(0xf7)](this[_0x2d9c9a(0x104)]+'\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x27166e[_0x2d9c9a(0x11b)]+_0x2d9c9a(0x146)+_0x27166e[_0x2d9c9a(0x12d)]+_0x2d9c9a(0x150)+_0x163ce8+'.')[_0x2d9c9a(0xe1)](),await this[_0x2d9c9a(0xf4)][_0x2d9c9a(0xdc)](_0x27166e,{}),await this[_0x2d9c9a(0xf4)][_0x2d9c9a(0x145)](_0x27166e,'Error');}catch(_0x97374b){if(_0x97374b instanceof salesforce_error_1['SalesforceError'])throw _0x97374b;}}async[a67_0x6cdb09(0x125)](_0x132f02){const _0x503b27=a67_0x6cdb09;if(_0x132f02[_0x503b27(0x157)]){const _0x3c576b=_0x132f02['repositoryName'][_0x503b27(0x156)](),_0x47cc64=this[_0x503b27(0x13a)][_0x3c576b];if(!_0x47cc64)this[_0x503b27(0x13a)][_0x3c576b]=_0x132f02[_0x503b27(0x11b)];else{if(_0x47cc64&&_0x47cc64!==_0x132f02[_0x503b27(0x11b)])return await this[_0x503b27(0x107)](_0x132f02,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x132f02[_0x503b27(0x11b)]+_0x503b27(0x115)+_0x3c576b+_0x503b27(0xef)+_0x47cc64+'\x27')),!![];}}return![];}async[a67_0x6cdb09(0x117)](_0x56d70a){const _0xa530f2=a67_0x6cdb09;if(!constants_1['REPOSITORY_NAME_REGEXP']['test'](_0x56d70a[_0xa530f2(0x11b)]))return await this[_0xa530f2(0x107)](_0x56d70a,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x56d70a[_0xa530f2(0x11b)]+_0xa530f2(0x133))),![];if(!constants_1[_0xa530f2(0xe6)][_0xa530f2(0x135)](_0x56d70a[_0xa530f2(0x12d)]))return await this['handleRecordSyncError'](_0x56d70a,new Error(_0xa530f2(0xff)+_0x56d70a[_0xa530f2(0x12d)]+'\x27\x20in\x20repository\x20\x27'+_0x56d70a['repositoryName']+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async['getOrCreateRepo'](_0xee2152,_0x4dbce5){const _0x275e7e=a67_0x6cdb09;let _0x2e811d=this[_0x275e7e(0xe7)]['find'](_0x15b31f=>_0xee2152[_0x275e7e(0x11b)]===_0x15b31f[_0x275e7e(0x13e)]);!_0x2e811d&&(this[_0x275e7e(0x114)][_0x275e7e(0x12e)](this[_0x275e7e(0x104)]+_0x275e7e(0x13d)+_0xee2152['repositoryName']+_0x275e7e(0x153)),_0x2e811d=await this[_0x275e7e(0x109)][_0x275e7e(0x123)]({'name':_0xee2152[_0x275e7e(0x11b)],'autoInit':!![],'defaultBranch':_0xee2152[_0x275e7e(0x12d)],'private':!![],'createHook':typedi_1[_0x275e7e(0xf6)][_0x275e7e(0x10d)](providers_tokens_1[_0x275e7e(0xdb)][_0x275e7e(0x13f)])[_0x275e7e(0x13c)]}));if(this['config']['isBidirectionalSynchronization']){const _0x4824f3=await _0x2e811d[_0x275e7e(0x11a)][_0x275e7e(0x152)]();!_0x4824f3[_0x275e7e(0xf1)](_0x189420=>_0x189420[_0x275e7e(0xfd)]===hooks_utils_1[_0x275e7e(0x130)][_0x275e7e(0x100)](this[_0x275e7e(0x13f)][_0x275e7e(0x14e)],this[_0x275e7e(0x13f)]['applicationUrl'],_0x4dbce5))&&(this['sfLogger'][_0x275e7e(0x12e)](this['prefix']+_0x275e7e(0x13d)+_0xee2152[_0x275e7e(0x11b)]+_0x275e7e(0x10b)),await _0x2e811d['hooks'][_0x275e7e(0x123)](hooks_utils_1[_0x275e7e(0x130)][_0x275e7e(0xed)](this[_0x275e7e(0x13f)][_0x275e7e(0x14e)],_0x2e811d[_0x275e7e(0x11a)],this[_0x275e7e(0x13f)]['applicationUrl'],_0x4dbce5)));}return this[_0x275e7e(0xe7)][_0x275e7e(0xd7)](_0x2e811d),_0x2e811d;}async[a67_0x6cdb09(0xe8)](){const _0x83b4e1=a67_0x6cdb09;this[_0x83b4e1(0x102)]=typedi_1[_0x83b4e1(0xf6)]['get'](providers_tokens_1[_0x83b4e1(0xdb)][_0x83b4e1(0x102)]),this[_0x83b4e1(0x109)]=typedi_1['Container'][_0x83b4e1(0x10d)](providers_tokens_1[_0x83b4e1(0xdb)]['gitRepoService']),this[_0x83b4e1(0x13f)]=typedi_1[_0x83b4e1(0xf6)][_0x83b4e1(0x10d)](providers_tokens_1[_0x83b4e1(0xdb)][_0x83b4e1(0x13f)]),this[_0x83b4e1(0x114)]=typedi_1[_0x83b4e1(0xf6)][_0x83b4e1(0x10d)](providers_tokens_1[_0x83b4e1(0xdb)]['logger']),this[_0x83b4e1(0x104)]='['+SyncService_1[_0x83b4e1(0x13e)]+']\x20['+this['config'][_0x83b4e1(0x14e)][_0x83b4e1(0x129)]()+']',this[_0x83b4e1(0x11c)][_0x83b4e1(0x143)](this[_0x83b4e1(0x114)][_0x83b4e1(0x112)]());try{this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this[_0x83b4e1(0x104)]+'\x20Start\x20sync\x20job.'),await this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this['prefix']+_0x83b4e1(0x13b))[_0x83b4e1(0xe1)]();const _0x28676e=await this[_0x83b4e1(0xf4)]['getRepositoryRecords'](typedi_1[_0x83b4e1(0xf6)]['get'](providers_tokens_1[_0x83b4e1(0xdb)]['connectionId']));await this['sfLogger'][_0x83b4e1(0x12e)](this[_0x83b4e1(0x104)]+_0x83b4e1(0x137))['send']();const _0x4528c4=await this[_0x83b4e1(0xf4)][_0x83b4e1(0x124)](_0x28676e[_0x83b4e1(0x131)](_0x31ae08=>'\x27'+_0x31ae08[_0x83b4e1(0x157)]+'\x27')[_0x83b4e1(0xe9)](','));await this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this[_0x83b4e1(0x104)]+_0x83b4e1(0xd6))[_0x83b4e1(0xe1)](),this[_0x83b4e1(0xe7)]=await this[_0x83b4e1(0x109)][_0x83b4e1(0x152)]();const _0x3163de=[..._0x28676e,..._0x4528c4];this['sfLogger'][_0x83b4e1(0x12e)](this['prefix']+_0x83b4e1(0xfa)+_0x3163de['length']+_0x83b4e1(0x10a));for(const _0x50f4c8 of _0x3163de){this[_0x83b4e1(0x140)][_0x83b4e1(0x12e)](_0x83b4e1(0x127)+_0x50f4c8[_0x83b4e1(0x11b)]+'['+_0x50f4c8[_0x83b4e1(0x157)]+_0x83b4e1(0x128)+_0x50f4c8['branchName']+'['+_0x50f4c8[_0x83b4e1(0x126)]+_0x83b4e1(0xec)),this[_0x83b4e1(0x114)]['log'](this[_0x83b4e1(0x104)]+_0x83b4e1(0x144)+_0x50f4c8['repositoryName']+_0x83b4e1(0x12f)+_0x50f4c8[_0x83b4e1(0x12d)]+'\x22.'),this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this[_0x83b4e1(0x104)]+_0x83b4e1(0x10f));const _0xc19ba9=await this[_0x83b4e1(0x117)](_0x50f4c8);if(!_0xc19ba9)continue;this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this['prefix']+'\x20Checking\x20intersects.');const _0x4ba4ae=await this[_0x83b4e1(0x125)](_0x50f4c8);if(_0x4ba4ae)continue;await this['sfLogger'][_0x83b4e1(0xe1)]();let _0x31f0a2;try{await this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this[_0x83b4e1(0x104)]+_0x83b4e1(0xf9))['send'](),_0x31f0a2=await this[_0x83b4e1(0x110)](_0x50f4c8,typedi_1[_0x83b4e1(0xf6)]['get'](providers_tokens_1[_0x83b4e1(0xdb)][_0x83b4e1(0x151)]));}catch(_0x4baad9){await this[_0x83b4e1(0x107)](_0x50f4c8,_0x4baad9 instanceof too_many_requests_error_1[_0x83b4e1(0xfb)]?_0x4baad9:new Error(_0x83b4e1(0x148)+_0x4baad9));continue;}await this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this[_0x83b4e1(0x104)]+_0x83b4e1(0x154))['send']();if(_0x50f4c8[_0x83b4e1(0xf0)]===flosum_repository_sync_dto_1[_0x83b4e1(0xd8)][_0x83b4e1(0xee)]){const _0x2fa6ce=typedi_1[_0x83b4e1(0xf6)][_0x83b4e1(0x10d)](flosum_sync_job_1[_0x83b4e1(0xdd)]);await _0x2fa6ce[_0x83b4e1(0xe8)]({'repository':_0x31f0a2,'convertToSFDX':this[_0x83b4e1(0x13f)][_0x83b4e1(0xf3)],'syncRecord':_0x50f4c8,'provider':this[_0x83b4e1(0x13f)][_0x83b4e1(0x14e)]})[_0x83b4e1(0x134)](_0x341d0c=>this[_0x83b4e1(0x107)](_0x50f4c8,_0x341d0c));}else{const _0x574864=typedi_1[_0x83b4e1(0xf6)][_0x83b4e1(0x10d)](git_sync_job_1[_0x83b4e1(0x106)]);await _0x574864[_0x83b4e1(0xe8)]({'repository':_0x31f0a2,'branch':_0x50f4c8[_0x83b4e1(0x12d)],'provider':this[_0x83b4e1(0x13f)][_0x83b4e1(0x14e)],'repositoryGit':_0x31f0a2[_0x83b4e1(0x122)],'syncRecord':_0x50f4c8})[_0x83b4e1(0x134)](_0x35ff1a=>this[_0x83b4e1(0x107)](_0x50f4c8,_0x35ff1a));}}}catch(_0x2d6e96){this[_0x83b4e1(0x140)][_0x83b4e1(0xf7)](_0x2d6e96);_0x2d6e96 instanceof too_many_requests_error_1[_0x83b4e1(0xfb)]?(await this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this['prefix']+_0x83b4e1(0x142))[_0x83b4e1(0xe1)](),await utils_1['sleep'](0x3c*0x3c*0x3e8),this[_0x83b4e1(0xe8)]()):await this[_0x83b4e1(0x114)]['error'](this[_0x83b4e1(0x104)]+_0x83b4e1(0x105)+_0x2d6e96)[_0x83b4e1(0xe1)]();return;}await this[_0x83b4e1(0x114)][_0x83b4e1(0x12e)](this['prefix']+_0x83b4e1(0xd9))[_0x83b4e1(0xe1)](),await this[_0x83b4e1(0xf4)][_0x83b4e1(0x118)](typedi_1[_0x83b4e1(0xf6)]['get'](providers_tokens_1[_0x83b4e1(0xdb)][_0x83b4e1(0x151)]))[_0x83b4e1(0x134)](()=>null);}};function a67_0x397e(){const _0x304ed1=['length','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','16063ZTHhni','typedi','12mQfCKZ','Waiting','__esModule','gitProvider','8afZWUg',']\x20due\x20error\x20-\x20','connectionId','getAll','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','\x20Completed\x20prepare\x20to\x20syncing.','../../../../constants','toLowerCase','repositoryId','design:paramtypes','33GbhRku','\x20Getting\x20repositories\x20from\x20git\x20service.','push','SyncDirection','\x20Sync\x20job\x20done.','185qGjCMl','Tokens','updateRemoteState','FlosumSyncJob','getOwnPropertyDescriptor','ProvidersFactory','../../providers/providers.tokens','send','search','../../providers/web-hooks/hooks.utils','SalesforceService','SyncService','BRANCH_NAME_REGEXP','repoList','run','join','Service','1197385iLQshd',']\x20branch.','createHookPayload','FlosumToGit','\x27\x20-\x20\x27','direction','find','constructor','isConvertToSfdx','salesforceSync','9261756uWXuNW','Container','error','function','\x20Getting\x20Flosum\x20repository','\x20Have\x20to\x20synchronize\x20','TooManyRequests','providersFactory','url','187212TduuqO','Unable\x20to\x20synchronize\x20branch\x20\x27','getHookLinkFor','../utils/connection','gitApiService','60239933Qrpodw','prefix','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','GitSyncJob','handleRecordSyncError','../jobs/flosum-sync.job','repoService','\x20branches.','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','../../salesforce/errors/salesforce.error','get','Logger','\x20Checking\x20valid\x20name.','getOrCreateRepo','5198290vlZODV','getLoggerId','188JrBpLw','sfLogger','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','../../salesforce/services/salesforce-sync.service','checkValidNaming','disableSync','32mmFjGT','hooks','repositoryName','salesforceService','../jobs/git-sync.job','decorate','defineProperty','../../../../core','../errors/git-branch-not-found.error','gitUrl','create','getBranchRecords','isIntersects','branchId','Syncing\x20',']\x20repository\x20','toUpperCase','metadata','2307369EhddZM','__decorate','branchName','log','\x22\x20branch:\x20\x22','HooksUtils','map','(((.+)+)+)+$','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','catch','test','../../salesforce/dto/flosum-repository-sync.dto','\x20Getting\x20branch\x20records.','toString','../../../../core/errors/too-many-requests.error','repositoriesIntersections','\x20Getting\x20repository\x20records.','isBidirectionalSynchronization','\x20Repository\x20\x22','name','config','logger','object','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','setLoggerId','\x20Syncing\x20repository:\x20\x22','setStatus','\x27\x20['];a67_0x397e=function(){return _0x304ed1;};return a67_0x397e();}SyncService=SyncService_1=__decorate([typedi_1[a67_0x6cdb09(0xea)]({'transient':!![]}),__metadata(a67_0x6cdb09(0xd4),[salesforce_service_1[a67_0x6cdb09(0xe4)],salesforce_sync_service_1['SalesforceSyncService'],connection_1[a67_0x6cdb09(0xdf)]])],SyncService),exports[a67_0x6cdb09(0xe5)]=SyncService;