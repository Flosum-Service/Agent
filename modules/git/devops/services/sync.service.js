function a111_0x2c15(_0x40fd7d,_0x360646){const _0x5f3c59=a111_0x4c52();return a111_0x2c15=function(_0x5a9a0d,_0x179d0a){_0x5a9a0d=_0x5a9a0d-0x1e2;let _0x4c5252=_0x5f3c59[_0x5a9a0d];return _0x4c5252;},a111_0x2c15(_0x40fd7d,_0x360646);}const a111_0x2d7de7=a111_0x2c15;(function(_0x3cfad7,_0x415b7f){const _0x1b3c26=a111_0x2c15,_0x53dc08=_0x3cfad7();while(!![]){try{const _0x6002ee=-parseInt(_0x1b3c26(0x20a))/0x1+-parseInt(_0x1b3c26(0x1e2))/0x2*(parseInt(_0x1b3c26(0x227))/0x3)+-parseInt(_0x1b3c26(0x23e))/0x4*(parseInt(_0x1b3c26(0x1f3))/0x5)+-parseInt(_0x1b3c26(0x1f6))/0x6+-parseInt(_0x1b3c26(0x1f2))/0x7+parseInt(_0x1b3c26(0x231))/0x8*(-parseInt(_0x1b3c26(0x256))/0x9)+parseInt(_0x1b3c26(0x238))/0xa;if(_0x6002ee===_0x415b7f)break;else _0x53dc08['push'](_0x53dc08['shift']());}catch(_0xf1717d){_0x53dc08['push'](_0x53dc08['shift']());}}}(a111_0x4c52,0x8e533));const a111_0x179d0a=(function(){let _0x3c685b=!![];return function(_0x26c10f,_0x7de1cd){const _0x56fd07=_0x3c685b?function(){if(_0x7de1cd){const _0x18a18a=_0x7de1cd['apply'](_0x26c10f,arguments);return _0x7de1cd=null,_0x18a18a;}}:function(){};return _0x3c685b=![],_0x56fd07;};}()),a111_0x5a9a0d=a111_0x179d0a(this,function(){const _0x4a0bb3=a111_0x2c15;return a111_0x5a9a0d[_0x4a0bb3(0x254)]()['search'](_0x4a0bb3(0x205))['toString']()[_0x4a0bb3(0x237)](a111_0x5a9a0d)['search'](_0x4a0bb3(0x205));});a111_0x5a9a0d();'use strict';var __decorate=this&&this[a111_0x2d7de7(0x24d)]||function(_0x4d2ae1,_0x7f8cfe,_0x191c2d,_0x393fbb){const _0x17a666=a111_0x2d7de7;var _0x1556e9=arguments['length'],_0x5a6cb2=_0x1556e9<0x3?_0x7f8cfe:_0x393fbb===null?_0x393fbb=Object['getOwnPropertyDescriptor'](_0x7f8cfe,_0x191c2d):_0x393fbb,_0x2926d2;if(typeof Reflect==='object'&&typeof Reflect[_0x17a666(0x201)]===_0x17a666(0x1fe))_0x5a6cb2=Reflect['decorate'](_0x4d2ae1,_0x7f8cfe,_0x191c2d,_0x393fbb);else{for(var _0x740a5f=_0x4d2ae1['length']-0x1;_0x740a5f>=0x0;_0x740a5f--)if(_0x2926d2=_0x4d2ae1[_0x740a5f])_0x5a6cb2=(_0x1556e9<0x3?_0x2926d2(_0x5a6cb2):_0x1556e9>0x3?_0x2926d2(_0x7f8cfe,_0x191c2d,_0x5a6cb2):_0x2926d2(_0x7f8cfe,_0x191c2d))||_0x5a6cb2;}return _0x1556e9>0x3&&_0x5a6cb2&&Object[_0x17a666(0x24b)](_0x7f8cfe,_0x191c2d,_0x5a6cb2),_0x5a6cb2;},__metadata=this&&this[a111_0x2d7de7(0x250)]||function(_0xf17d1d,_0x1a542f){const _0x4dba55=a111_0x2d7de7;if(typeof Reflect===_0x4dba55(0x219)&&typeof Reflect[_0x4dba55(0x22f)]===_0x4dba55(0x1fe))return Reflect[_0x4dba55(0x22f)](_0xf17d1d,_0x1a542f);},SyncService_1;Object[a111_0x2d7de7(0x24b)](exports,a111_0x2d7de7(0x23b),{'value':!![]}),exports['SyncService']=void 0x0;function a111_0x4c52(){const _0x4e1194=['typedi','\x20Checking\x20valid\x20name.','repositoriesIntersections','url','push','repoService','object',']\x20[','getOrCreateRepo','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x20Getting\x20branch\x20records.','updateRemoteState','gitUrl','setLoggerId','../../providers/providers.tokens','GitSyncJob','config','gitProvider','hooks','HooksUtils','2071281VVAEOv','setStatus','create','catch','\x20Checking\x20intersects.','../../../../constants','sleep','log','metadata','\x22\x20branch:\x20\x22','8moXgri','../../salesforce/services/salesforce-sync.service','Unable\x20to\x20synchronize\x20repository\x20\x27','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','length','\x20Sync\x20job\x20done.','constructor','58383260lahuJK','../../salesforce/errors/salesforce.error','GitBranchNotFoundError','__esModule','Tokens','../errors/git-branch-not-found.error','8312zrcFpk','FlosumSyncJob','join','Logger','Container','connectionId','BadRequestError','repositoryId','direction','find','../../salesforce/services/salesforce.service','\x20No\x20repositories\x20to\x20sync.','checkValidNaming','defineProperty','repositoryName','__decorate','SyncDirection','\x20Start\x20sync\x20job.','__metadata','salesforceService','\x20Stop\x20sync\x20job\x20for\x20\x27','SalesforceService','toString','gitApiService','5879331vWmyUE','get','disableSync','Not\x20Synchronized','Service','\x27\x20-\x20\x27','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','\x20Getting\x20Flosum\x20repository','2YHsmxu','FlosumToGit','getAll','run','\x20Have\x20to\x20synchronize\x20','send','getRepositoryRecords','Error','\x20branches.','applicationUrl','salesforceSync','../jobs/git-sync.job','TooManyRequests','map','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','SalesforceError','7234297MgsCpk','2505uvsadw','\x27\x20[','\x20Completed\x20prepare\x20to\x20syncing.','4303626Aawign','test','Unable\x20to\x20synchronize\x20branch\x20\x27',']\x20branch.',']\x20due\x20error\x20-\x20','\x27\x20in\x20repository\x20\x27','logger','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','function','getHookLinkFor','\x20Repository\x20\x22','decorate','isConvertToSfdx','Syncing\x20','prefix','(((.+)+)+)+$','branchName','BRANCH_NAME_REGEXP','toUpperCase','sfLogger','1119857xxujJl','isBidirectionalSynchronization','name','../../providers/web-hooks/hooks.utils','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','handleRecordSyncError','error','repoList','../jobs/flosum-sync.job'];a111_0x4c52=function(){return _0x4e1194;};return a111_0x4c52();}const constants_1=require(a111_0x2d7de7(0x22c)),core_1=require('../../../../core'),too_many_requests_error_1=require('../../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a111_0x2d7de7(0x239)),salesforce_sync_service_1=require(a111_0x2d7de7(0x232)),salesforce_service_1=require(a111_0x2d7de7(0x248)),utils_1=require('../../../shared/utils'),typedi_1=require(a111_0x2d7de7(0x213)),hooks_utils_1=require(a111_0x2d7de7(0x20d)),git_branch_not_found_error_1=require(a111_0x2d7de7(0x23d)),flosum_sync_job_1=require(a111_0x2d7de7(0x212)),git_sync_job_1=require(a111_0x2d7de7(0x1ed)),providers_tokens_1=require(a111_0x2d7de7(0x221)),bad_request_error_1=require('../../../../core/errors/bad-request.error');let SyncService=SyncService_1=class SyncService{constructor(_0x3a9068,_0x21232f){const _0x366d7e=a111_0x2d7de7;this[_0x366d7e(0x251)]=_0x3a9068,this[_0x366d7e(0x1ec)]=_0x21232f,this[_0x366d7e(0x1fc)]=new core_1[(_0x366d7e(0x241))](SyncService_1[_0x366d7e(0x20c)]),this[_0x366d7e(0x215)]={},this[_0x366d7e(0x211)]=[];}async['handleRecordSyncError'](_0x2a86d3,_0x2fddb9){const _0x248333=a111_0x2d7de7;if(_0x2fddb9 instanceof git_branch_not_found_error_1[_0x248333(0x23a)]){await this[_0x248333(0x1ec)]['setStatus'](_0x2a86d3,_0x248333(0x259));return;}if(_0x2fddb9 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x248333(0x1ec)][_0x248333(0x228)](_0x2a86d3,'Waiting');throw _0x2fddb9;}try{await this[_0x248333(0x209)][_0x248333(0x210)](this['prefix']+_0x248333(0x252)+_0x2a86d3['repositoryName']+_0x248333(0x1f4)+_0x2a86d3['branchName']+_0x248333(0x1fa)+_0x2fddb9+'.')[_0x248333(0x1e7)](),await this[_0x248333(0x1ec)][_0x248333(0x21e)](_0x2a86d3,{}),await this[_0x248333(0x1ec)][_0x248333(0x228)](_0x2a86d3,_0x248333(0x1e9));}catch(_0xb3dff7){if(_0xb3dff7 instanceof salesforce_error_1[_0x248333(0x1f1)])throw _0xb3dff7;}}async['isIntersects'](_0x565a49){const _0x58f16e=a111_0x2d7de7;if(_0x565a49[_0x58f16e(0x245)]){const _0x586d8d=_0x565a49[_0x58f16e(0x24c)]['toLowerCase'](),_0x58c44a=this['repositoriesIntersections'][_0x586d8d];if(!_0x58c44a)this[_0x58f16e(0x215)][_0x586d8d]=_0x565a49[_0x58f16e(0x24c)];else{if(_0x58c44a&&_0x58c44a!==_0x565a49[_0x58f16e(0x24c)])return await this[_0x58f16e(0x20f)](_0x565a49,new Error(_0x58f16e(0x233)+_0x565a49[_0x58f16e(0x24c)]+_0x58f16e(0x234)+_0x586d8d+_0x58f16e(0x25b)+_0x58c44a+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x413290){const _0x14a986=a111_0x2d7de7;if(!constants_1['REPOSITORY_NAME_REGEXP']['test'](_0x413290[_0x14a986(0x24c)]))return await this[_0x14a986(0x20f)](_0x413290,new Error(_0x14a986(0x233)+_0x413290[_0x14a986(0x24c)]+_0x14a986(0x21c))),![];if(!constants_1[_0x14a986(0x207)][_0x14a986(0x1f7)](_0x413290['branchName']))return await this[_0x14a986(0x20f)](_0x413290,new Error(_0x14a986(0x1f8)+_0x413290[_0x14a986(0x206)]+_0x14a986(0x1fb)+_0x413290[_0x14a986(0x24c)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a111_0x2d7de7(0x21b)](_0x6648e,_0x31f130){const _0x1b426d=a111_0x2d7de7;let _0x51d6c7=this[_0x1b426d(0x211)][_0x1b426d(0x247)](_0x1ef912=>_0x6648e['repositoryName']===_0x1ef912[_0x1b426d(0x20c)]);!_0x51d6c7&&(this[_0x1b426d(0x209)]['log'](this[_0x1b426d(0x204)]+_0x1b426d(0x200)+_0x6648e[_0x1b426d(0x24c)]+_0x1b426d(0x25c)),_0x51d6c7=await this[_0x1b426d(0x218)][_0x1b426d(0x229)]({'name':_0x6648e['repositoryName'],'autoInit':!![],'defaultBranch':_0x6648e['branchName'],'private':!![],'createHook':typedi_1[_0x1b426d(0x242)][_0x1b426d(0x257)](providers_tokens_1[_0x1b426d(0x23c)][_0x1b426d(0x223)])[_0x1b426d(0x20b)]}));if(this[_0x1b426d(0x223)][_0x1b426d(0x20b)]){const _0xe16e6=await _0x51d6c7[_0x1b426d(0x225)][_0x1b426d(0x1e4)]();!_0xe16e6[_0x1b426d(0x247)](_0x2dbf1f=>_0x2dbf1f[_0x1b426d(0x216)]===hooks_utils_1[_0x1b426d(0x226)][_0x1b426d(0x1ff)](this[_0x1b426d(0x223)]['gitProvider'],this[_0x1b426d(0x223)]['applicationUrl'],_0x31f130))&&(this[_0x1b426d(0x209)][_0x1b426d(0x22e)](this['prefix']+_0x1b426d(0x200)+_0x6648e[_0x1b426d(0x24c)]+'\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.'),await _0x51d6c7[_0x1b426d(0x225)][_0x1b426d(0x229)](hooks_utils_1[_0x1b426d(0x226)]['createHookPayload'](this['config']['gitProvider'],_0x51d6c7[_0x1b426d(0x225)],this[_0x1b426d(0x223)][_0x1b426d(0x1eb)],_0x31f130)));}return this[_0x1b426d(0x211)][_0x1b426d(0x217)](_0x51d6c7),_0x51d6c7;}async['run'](){const _0x48a9c8=a111_0x2d7de7;this[_0x48a9c8(0x255)]=typedi_1[_0x48a9c8(0x242)][_0x48a9c8(0x257)](providers_tokens_1['Tokens'][_0x48a9c8(0x255)]),this[_0x48a9c8(0x218)]=typedi_1[_0x48a9c8(0x242)][_0x48a9c8(0x257)](providers_tokens_1['Tokens']['gitRepoService']),this['config']=typedi_1[_0x48a9c8(0x242)][_0x48a9c8(0x257)](providers_tokens_1['Tokens'][_0x48a9c8(0x223)]),this[_0x48a9c8(0x209)]=typedi_1[_0x48a9c8(0x242)][_0x48a9c8(0x257)](providers_tokens_1[_0x48a9c8(0x23c)][_0x48a9c8(0x1fc)]),this['prefix']='['+SyncService_1['name']+_0x48a9c8(0x21a)+this['config']['gitProvider'][_0x48a9c8(0x208)]()+']',this[_0x48a9c8(0x251)][_0x48a9c8(0x220)](this['sfLogger']['getLoggerId']());try{this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x24f)),await this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+'\x20Getting\x20repository\x20records.')[_0x48a9c8(0x1e7)]();const _0x3593ba=await this[_0x48a9c8(0x1ec)][_0x48a9c8(0x1e8)](typedi_1[_0x48a9c8(0x242)][_0x48a9c8(0x257)](providers_tokens_1[_0x48a9c8(0x23c)]['connectionId']));if(!_0x3593ba[_0x48a9c8(0x235)])throw new bad_request_error_1[(_0x48a9c8(0x244))](this[_0x48a9c8(0x204)]+_0x48a9c8(0x249));await this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x21d))[_0x48a9c8(0x1e7)]();const _0x108a20=await this['salesforceSync']['getBranchRecords'](_0x3593ba[_0x48a9c8(0x1ef)](_0x2eb7ac=>'\x27'+_0x2eb7ac[_0x48a9c8(0x245)]+'\x27')[_0x48a9c8(0x240)](','));await this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+'\x20Getting\x20repositories\x20from\x20git\x20service.')[_0x48a9c8(0x1e7)](),this[_0x48a9c8(0x211)]=await this[_0x48a9c8(0x218)][_0x48a9c8(0x1e4)]();const _0x581f66=[..._0x3593ba,..._0x108a20];this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x1e6)+_0x581f66[_0x48a9c8(0x235)]+_0x48a9c8(0x1ea));for(const _0x230704 of _0x581f66){this['logger']['log'](_0x48a9c8(0x203)+_0x230704['repositoryName']+'['+_0x230704[_0x48a9c8(0x245)]+']\x20repository\x20'+_0x230704[_0x48a9c8(0x206)]+'['+_0x230704['branchId']+_0x48a9c8(0x1f9)),this[_0x48a9c8(0x209)]['log'](this[_0x48a9c8(0x204)]+'\x20Syncing\x20repository:\x20\x22'+_0x230704[_0x48a9c8(0x24c)]+_0x48a9c8(0x230)+_0x230704[_0x48a9c8(0x206)]+'\x22.'),this[_0x48a9c8(0x209)]['log'](this[_0x48a9c8(0x204)]+_0x48a9c8(0x214));const _0x55b746=await this[_0x48a9c8(0x24a)](_0x230704);if(!_0x55b746)continue;this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x22b));const _0x51268d=await this['isIntersects'](_0x230704);if(_0x51268d)continue;await this[_0x48a9c8(0x209)][_0x48a9c8(0x1e7)]();let _0x245eb1;try{await this[_0x48a9c8(0x209)]['log'](this[_0x48a9c8(0x204)]+_0x48a9c8(0x25d))[_0x48a9c8(0x1e7)](),_0x245eb1=await this['getOrCreateRepo'](_0x230704,typedi_1[_0x48a9c8(0x242)][_0x48a9c8(0x257)](providers_tokens_1[_0x48a9c8(0x23c)][_0x48a9c8(0x243)]));}catch(_0x342178){await this[_0x48a9c8(0x20f)](_0x230704,_0x342178 instanceof too_many_requests_error_1['TooManyRequests']?_0x342178:new Error(_0x48a9c8(0x1fd)+_0x342178));continue;}await this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x1f5))[_0x48a9c8(0x1e7)]();if(_0x230704[_0x48a9c8(0x246)]===flosum_repository_sync_dto_1[_0x48a9c8(0x24e)][_0x48a9c8(0x1e3)]){const _0x1f1052=typedi_1['Container'][_0x48a9c8(0x257)](flosum_sync_job_1[_0x48a9c8(0x23f)]);await _0x1f1052[_0x48a9c8(0x1e5)]({'repository':_0x245eb1,'convertToSFDX':this[_0x48a9c8(0x223)][_0x48a9c8(0x202)],'syncRecord':_0x230704,'provider':this['config'][_0x48a9c8(0x224)]})[_0x48a9c8(0x22a)](_0x15668d=>this[_0x48a9c8(0x20f)](_0x230704,_0x15668d));}else{const _0x2e23e9=typedi_1[_0x48a9c8(0x242)]['get'](git_sync_job_1[_0x48a9c8(0x222)]);await _0x2e23e9[_0x48a9c8(0x1e5)]({'repository':_0x245eb1,'branch':_0x230704[_0x48a9c8(0x206)],'provider':this[_0x48a9c8(0x223)][_0x48a9c8(0x224)],'repositoryGit':_0x245eb1[_0x48a9c8(0x21f)],'syncRecord':_0x230704})[_0x48a9c8(0x22a)](_0x1a676d=>this[_0x48a9c8(0x20f)](_0x230704,_0x1a676d));}}}catch(_0x44ccff){this[_0x48a9c8(0x1fc)][_0x48a9c8(0x210)](_0x44ccff);_0x44ccff instanceof too_many_requests_error_1[_0x48a9c8(0x1ee)]?(await this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x20e))[_0x48a9c8(0x1e7)](),await(0x0,utils_1[_0x48a9c8(0x22d)])(0x3c*0x3c*0x3e8),this['run']()):await this['sfLogger'][_0x48a9c8(0x210)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x1f0)+_0x44ccff)[_0x48a9c8(0x1e7)]();return;}await this[_0x48a9c8(0x209)][_0x48a9c8(0x22e)](this[_0x48a9c8(0x204)]+_0x48a9c8(0x236))[_0x48a9c8(0x1e7)](),await this[_0x48a9c8(0x1ec)][_0x48a9c8(0x258)](typedi_1[_0x48a9c8(0x242)][_0x48a9c8(0x257)](providers_tokens_1[_0x48a9c8(0x23c)][_0x48a9c8(0x243)]))[_0x48a9c8(0x22a)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x2d7de7(0x25a)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a111_0x2d7de7(0x253)],salesforce_sync_service_1['SalesforceSyncService']])],SyncService),exports['SyncService']=SyncService;