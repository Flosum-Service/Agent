const a111_0x626252=a111_0x2078;(function(_0x319fb4,_0x3c652a){const _0x1fa266=a111_0x2078,_0x1c28e6=_0x319fb4();while(!![]){try{const _0x4a08a9=parseInt(_0x1fa266(0x152))/0x1*(-parseInt(_0x1fa266(0x149))/0x2)+parseInt(_0x1fa266(0x157))/0x3*(-parseInt(_0x1fa266(0x13d))/0x4)+parseInt(_0x1fa266(0x131))/0x5*(parseInt(_0x1fa266(0x136))/0x6)+parseInt(_0x1fa266(0xf9))/0x7+parseInt(_0x1fa266(0x164))/0x8*(parseInt(_0x1fa266(0x169))/0x9)+parseInt(_0x1fa266(0x132))/0xa+-parseInt(_0x1fa266(0x168))/0xb;if(_0x4a08a9===_0x3c652a)break;else _0x1c28e6['push'](_0x1c28e6['shift']());}catch(_0x2f4298){_0x1c28e6['push'](_0x1c28e6['shift']());}}}(a111_0x3585,0x84b34));const a111_0x10c461=(function(){let _0x33d6f2=!![];return function(_0x5befe2,_0x2beb3b){const _0x14456b=_0x33d6f2?function(){const _0x158b94=a111_0x2078;if(_0x2beb3b){const _0x14a7c7=_0x2beb3b[_0x158b94(0x12d)](_0x5befe2,arguments);return _0x2beb3b=null,_0x14a7c7;}}:function(){};return _0x33d6f2=![],_0x14456b;};}()),a111_0x1100a5=a111_0x10c461(this,function(){const _0x3b5403=a111_0x2078;return a111_0x1100a5[_0x3b5403(0x15e)]()[_0x3b5403(0x10b)](_0x3b5403(0x162))['toString']()[_0x3b5403(0x121)](a111_0x1100a5)['search'](_0x3b5403(0x162));});function a111_0x3585(){const _0x577513=['toString','sleep','metadata','\x20Sync\x20job\x20done.','(((.+)+)+)+$','getHookLinkFor','8YxgfFv','updateRemoteState','SyncDirection','Service','23377849rAvnXz','8998173gWnGOX','SalesforceSyncService','find','\x27\x20in\x20repository\x20\x27','applicationUrl','SyncService',']\x20repository\x20','error','push','SalesforceService','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','../../salesforce/services/salesforce-sync.service','../../../shared/utils','FlosumToGit','isIntersects','Tokens','repoService','5418868RnoMCf',']\x20[','\x20Start\x20sync\x20job.','typedi','repositoryId','handleRecordSyncError','getAll','catch','hooks','../jobs/git-sync.job','salesforceSync','\x20Getting\x20branch\x20records.','REPOSITORY_NAME_REGEXP','getOrCreateRepo','connectionId','\x20Checking\x20intersects.','../../providers/providers.tokens','salesforceService','search','\x20Getting\x20repositories\x20from\x20git\x20service.','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','toLowerCase','repositoriesIntersections','sfLogger','branchName','join','gitRepoService','logger','GitBranchNotFoundError','repoList','setStatus','../../providers/web-hooks/hooks.utils','\x20branches.','Error','Container','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','BRANCH_NAME_REGEXP','\x20Stop\x20sync\x20job\x20for\x20\x27','getRepositoryRecords','Unable\x20to\x20synchronize\x20branch\x20\x27','constructor','design:paramtypes','disableSync','../jobs/flosum-sync.job','defineProperty','map','../../salesforce/dto/flosum-repository-sync.dto','checkValidNaming','../../salesforce/errors/salesforce.error','../../../../core/errors/too-many-requests.error','../../salesforce/services/salesforce.service','toUpperCase','apply','length','test','log','55NtUkno','8401660QGWVnx','getOwnPropertyDescriptor','isConvertToSfdx','direction','246168nUHeNf','isBidirectionalSynchronization','run','\x20Getting\x20repository\x20records.','send','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','HooksUtils','252caooln','get','FlosumSyncJob','\x20Completed\x20prepare\x20to\x20syncing.','../../../../constants','Logger','TooManyRequests','config','prefix','__metadata','\x20Repository\x20\x22','BadRequestError','756274BrczHu','repositoryName','name','Not\x20Synchronized','createHookPayload','decorate','gitApiService','../../../../core/errors/bad-request.error','\x20Getting\x20Flosum\x20repository','1ZRLuNW','\x27\x20-\x20\x27','gitUrl','object','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','879GmcYtz','Waiting','GitSyncJob','create','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','gitProvider','../../../../core'];a111_0x3585=function(){return _0x577513;};return a111_0x3585();}a111_0x1100a5();'use strict';function a111_0x2078(_0x20076d,_0x2d9685){const _0x59f3fa=a111_0x3585();return a111_0x2078=function(_0x1100a5,_0x10c461){_0x1100a5=_0x1100a5-0xf7;let _0x35858e=_0x59f3fa[_0x1100a5];return _0x35858e;},a111_0x2078(_0x20076d,_0x2d9685);}var __decorate=this&&this['__decorate']||function(_0x3aedd5,_0x5070d1,_0x1599e6,_0x465743){const _0x3cf91e=a111_0x2078;var _0x731f26=arguments[_0x3cf91e(0x12e)],_0x517f18=_0x731f26<0x3?_0x5070d1:_0x465743===null?_0x465743=Object[_0x3cf91e(0x133)](_0x5070d1,_0x1599e6):_0x465743,_0x89cd7e;if(typeof Reflect===_0x3cf91e(0x155)&&typeof Reflect['decorate']==='function')_0x517f18=Reflect[_0x3cf91e(0x14e)](_0x3aedd5,_0x5070d1,_0x1599e6,_0x465743);else{for(var _0x28c679=_0x3aedd5['length']-0x1;_0x28c679>=0x0;_0x28c679--)if(_0x89cd7e=_0x3aedd5[_0x28c679])_0x517f18=(_0x731f26<0x3?_0x89cd7e(_0x517f18):_0x731f26>0x3?_0x89cd7e(_0x5070d1,_0x1599e6,_0x517f18):_0x89cd7e(_0x5070d1,_0x1599e6))||_0x517f18;}return _0x731f26>0x3&&_0x517f18&&Object[_0x3cf91e(0x125)](_0x5070d1,_0x1599e6,_0x517f18),_0x517f18;},__metadata=this&&this[a111_0x626252(0x146)]||function(_0x29aa28,_0x232b05){const _0x45c4ab=a111_0x626252;if(typeof Reflect==='object'&&typeof Reflect[_0x45c4ab(0x160)]==='function')return Reflect[_0x45c4ab(0x160)](_0x29aa28,_0x232b05);},SyncService_1;Object[a111_0x626252(0x125)](exports,'__esModule',{'value':!![]}),exports[a111_0x626252(0x16e)]=void 0x0;const constants_1=require(a111_0x626252(0x141)),core_1=require(a111_0x626252(0x15d)),too_many_requests_error_1=require(a111_0x626252(0x12a)),flosum_repository_sync_dto_1=require(a111_0x626252(0x127)),salesforce_error_1=require(a111_0x626252(0x129)),salesforce_sync_service_1=require(a111_0x626252(0x174)),salesforce_service_1=require(a111_0x626252(0x12b)),utils_1=require(a111_0x626252(0x175)),typedi_1=require(a111_0x626252(0xfc)),hooks_utils_1=require(a111_0x626252(0x118)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require(a111_0x626252(0x124)),git_sync_job_1=require(a111_0x626252(0x102)),providers_tokens_1=require(a111_0x626252(0x109)),bad_request_error_1=require(a111_0x626252(0x150));let SyncService=SyncService_1=class SyncService{constructor(_0x451b3f,_0x52e295){const _0x392b12=a111_0x626252;this['salesforceService']=_0x451b3f,this[_0x392b12(0x103)]=_0x52e295,this['logger']=new core_1[(_0x392b12(0x142))](SyncService_1[_0x392b12(0x14b)]),this['repositoriesIntersections']={},this['repoList']=[];}async[a111_0x626252(0xfe)](_0x4b6fce,_0x1798dd){const _0xfcfa4=a111_0x626252;if(_0x1798dd instanceof git_branch_not_found_error_1[_0xfcfa4(0x115)]){await this[_0xfcfa4(0x103)][_0xfcfa4(0x117)](_0x4b6fce,_0xfcfa4(0x14c));return;}if(_0x1798dd instanceof too_many_requests_error_1['TooManyRequests']){await this[_0xfcfa4(0x103)]['setStatus'](_0x4b6fce,_0xfcfa4(0x158));throw _0x1798dd;}try{await this[_0xfcfa4(0x110)][_0xfcfa4(0x170)](this['prefix']+_0xfcfa4(0x11e)+_0x4b6fce[_0xfcfa4(0x14a)]+'\x27\x20['+_0x4b6fce['branchName']+']\x20due\x20error\x20-\x20'+_0x1798dd+'.')[_0xfcfa4(0x13a)](),await this[_0xfcfa4(0x103)][_0xfcfa4(0x165)](_0x4b6fce,{}),await this['salesforceSync']['setStatus'](_0x4b6fce,_0xfcfa4(0x11a));}catch(_0x28c6bd){if(_0x28c6bd instanceof salesforce_error_1['SalesforceError'])throw _0x28c6bd;}}async[a111_0x626252(0x177)](_0x41fdf2){const _0x259c03=a111_0x626252;if(_0x41fdf2['repositoryId']){const _0x1ebb7f=_0x41fdf2[_0x259c03(0x14a)][_0x259c03(0x10e)](),_0x18f5be=this[_0x259c03(0x10f)][_0x1ebb7f];if(!_0x18f5be)this[_0x259c03(0x10f)][_0x1ebb7f]=_0x41fdf2[_0x259c03(0x14a)];else{if(_0x18f5be&&_0x18f5be!==_0x41fdf2[_0x259c03(0x14a)])return await this[_0x259c03(0xfe)](_0x41fdf2,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x41fdf2[_0x259c03(0x14a)]+_0x259c03(0x173)+_0x1ebb7f+_0x259c03(0x153)+_0x18f5be+'\x27')),!![];}}return![];}async[a111_0x626252(0x128)](_0x322a14){const _0x29b859=a111_0x626252;if(!constants_1[_0x29b859(0x105)][_0x29b859(0x12f)](_0x322a14[_0x29b859(0x14a)]))return await this[_0x29b859(0xfe)](_0x322a14,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x322a14['repositoryName']+_0x29b859(0x13b))),![];if(!constants_1[_0x29b859(0x11d)]['test'](_0x322a14[_0x29b859(0x111)]))return await this[_0x29b859(0xfe)](_0x322a14,new Error(_0x29b859(0x120)+_0x322a14[_0x29b859(0x111)]+_0x29b859(0x16c)+_0x322a14[_0x29b859(0x14a)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a111_0x626252(0x106)](_0x155c69,_0x324ce5){const _0x512c56=a111_0x626252;let _0x3e45fb=this['repoList']['find'](_0x2ef344=>_0x155c69['repositoryName']===_0x2ef344[_0x512c56(0x14b)]);!_0x3e45fb&&(this[_0x512c56(0x110)][_0x512c56(0x130)](this[_0x512c56(0x145)]+_0x512c56(0x147)+_0x155c69[_0x512c56(0x14a)]+_0x512c56(0x156)),_0x3e45fb=await this[_0x512c56(0xf8)][_0x512c56(0x15a)]({'name':_0x155c69[_0x512c56(0x14a)],'autoInit':!![],'defaultBranch':_0x155c69[_0x512c56(0x111)],'private':!![],'createHook':typedi_1['Container'][_0x512c56(0x13e)](providers_tokens_1[_0x512c56(0xf7)][_0x512c56(0x144)])['isBidirectionalSynchronization']}));if(this['config'][_0x512c56(0x137)]){const _0x1deb39=await _0x3e45fb[_0x512c56(0x101)][_0x512c56(0xff)]();!_0x1deb39[_0x512c56(0x16b)](_0x1802fc=>_0x1802fc['url']===hooks_utils_1[_0x512c56(0x13c)][_0x512c56(0x163)](this['config']['gitProvider'],this[_0x512c56(0x144)]['applicationUrl'],_0x324ce5))&&(this[_0x512c56(0x110)][_0x512c56(0x130)](this[_0x512c56(0x145)]+_0x512c56(0x147)+_0x155c69['repositoryName']+_0x512c56(0x15b)),await _0x3e45fb[_0x512c56(0x101)][_0x512c56(0x15a)](hooks_utils_1[_0x512c56(0x13c)][_0x512c56(0x14d)](this[_0x512c56(0x144)]['gitProvider'],_0x3e45fb['hooks'],this[_0x512c56(0x144)][_0x512c56(0x16d)],_0x324ce5)));}return this[_0x512c56(0x116)][_0x512c56(0x171)](_0x3e45fb),_0x3e45fb;}async[a111_0x626252(0x138)](){const _0x5df0de=a111_0x626252;this[_0x5df0de(0x14f)]=typedi_1[_0x5df0de(0x11b)]['get'](providers_tokens_1['Tokens'][_0x5df0de(0x14f)]),this[_0x5df0de(0xf8)]=typedi_1[_0x5df0de(0x11b)]['get'](providers_tokens_1['Tokens'][_0x5df0de(0x113)]),this[_0x5df0de(0x144)]=typedi_1[_0x5df0de(0x11b)][_0x5df0de(0x13e)](providers_tokens_1[_0x5df0de(0xf7)]['config']),this[_0x5df0de(0x110)]=typedi_1[_0x5df0de(0x11b)][_0x5df0de(0x13e)](providers_tokens_1['Tokens']['logger']),this[_0x5df0de(0x145)]='['+SyncService_1[_0x5df0de(0x14b)]+_0x5df0de(0xfa)+this['config'][_0x5df0de(0x15c)][_0x5df0de(0x12c)]()+']',this[_0x5df0de(0x10a)]['setLoggerId'](this[_0x5df0de(0x110)]['getLoggerId']());try{this['sfLogger'][_0x5df0de(0x130)](this[_0x5df0de(0x145)]+_0x5df0de(0xfb)),await this['sfLogger'][_0x5df0de(0x130)](this['prefix']+_0x5df0de(0x139))[_0x5df0de(0x13a)]();const _0x4b2c24=await this[_0x5df0de(0x103)][_0x5df0de(0x11f)](typedi_1[_0x5df0de(0x11b)][_0x5df0de(0x13e)](providers_tokens_1[_0x5df0de(0xf7)][_0x5df0de(0x107)]));if(!_0x4b2c24[_0x5df0de(0x12e)])throw new bad_request_error_1[(_0x5df0de(0x148))](this[_0x5df0de(0x145)]+'\x20No\x20repositories\x20to\x20sync.');await this[_0x5df0de(0x110)][_0x5df0de(0x130)](this[_0x5df0de(0x145)]+_0x5df0de(0x104))[_0x5df0de(0x13a)]();const _0x540186=await this[_0x5df0de(0x103)]['getBranchRecords'](_0x4b2c24[_0x5df0de(0x126)](_0x19b20b=>'\x27'+_0x19b20b['repositoryId']+'\x27')[_0x5df0de(0x112)](','));await this[_0x5df0de(0x110)][_0x5df0de(0x130)](this['prefix']+_0x5df0de(0x10c))[_0x5df0de(0x13a)](),this[_0x5df0de(0x116)]=await this[_0x5df0de(0xf8)][_0x5df0de(0xff)]();const _0x4d4c42=[..._0x4b2c24,..._0x540186];this[_0x5df0de(0x110)][_0x5df0de(0x130)](this[_0x5df0de(0x145)]+'\x20Have\x20to\x20synchronize\x20'+_0x4d4c42[_0x5df0de(0x12e)]+_0x5df0de(0x119));for(const _0x41a7fd of _0x4d4c42){this[_0x5df0de(0x114)][_0x5df0de(0x130)]('Syncing\x20'+_0x41a7fd[_0x5df0de(0x14a)]+'['+_0x41a7fd[_0x5df0de(0xfd)]+_0x5df0de(0x16f)+_0x41a7fd['branchName']+'['+_0x41a7fd['branchId']+']\x20branch.'),this[_0x5df0de(0x110)][_0x5df0de(0x130)](this['prefix']+'\x20Syncing\x20repository:\x20\x22'+_0x41a7fd[_0x5df0de(0x14a)]+'\x22\x20branch:\x20\x22'+_0x41a7fd[_0x5df0de(0x111)]+'\x22.'),this[_0x5df0de(0x110)]['log'](this[_0x5df0de(0x145)]+'\x20Checking\x20valid\x20name.');const _0x34eee6=await this[_0x5df0de(0x128)](_0x41a7fd);if(!_0x34eee6)continue;this[_0x5df0de(0x110)][_0x5df0de(0x130)](this[_0x5df0de(0x145)]+_0x5df0de(0x108));const _0x39925f=await this['isIntersects'](_0x41a7fd);if(_0x39925f)continue;await this[_0x5df0de(0x110)]['send']();let _0x6d1a8b;try{await this[_0x5df0de(0x110)]['log'](this['prefix']+_0x5df0de(0x151))[_0x5df0de(0x13a)](),_0x6d1a8b=await this[_0x5df0de(0x106)](_0x41a7fd,typedi_1['Container'][_0x5df0de(0x13e)](providers_tokens_1[_0x5df0de(0xf7)][_0x5df0de(0x107)]));}catch(_0x41c015){await this[_0x5df0de(0xfe)](_0x41a7fd,_0x41c015 instanceof too_many_requests_error_1['TooManyRequests']?_0x41c015:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x41c015));continue;}await this['sfLogger'][_0x5df0de(0x130)](this[_0x5df0de(0x145)]+_0x5df0de(0x140))[_0x5df0de(0x13a)]();if(_0x41a7fd[_0x5df0de(0x135)]===flosum_repository_sync_dto_1[_0x5df0de(0x166)][_0x5df0de(0x176)]){const _0x58b3e6=typedi_1[_0x5df0de(0x11b)]['get'](flosum_sync_job_1[_0x5df0de(0x13f)]);await _0x58b3e6[_0x5df0de(0x138)]({'repository':_0x6d1a8b,'convertToSFDX':this[_0x5df0de(0x144)][_0x5df0de(0x134)],'syncRecord':_0x41a7fd,'provider':this[_0x5df0de(0x144)]['gitProvider']})[_0x5df0de(0x100)](_0x340522=>this[_0x5df0de(0xfe)](_0x41a7fd,_0x340522));}else{const _0x2aa9ca=typedi_1[_0x5df0de(0x11b)][_0x5df0de(0x13e)](git_sync_job_1[_0x5df0de(0x159)]);await _0x2aa9ca[_0x5df0de(0x138)]({'repository':_0x6d1a8b,'branch':_0x41a7fd[_0x5df0de(0x111)],'provider':this[_0x5df0de(0x144)][_0x5df0de(0x15c)],'repositoryGit':_0x6d1a8b[_0x5df0de(0x154)],'syncRecord':_0x41a7fd})['catch'](_0xddad1d=>this[_0x5df0de(0xfe)](_0x41a7fd,_0xddad1d));}}}catch(_0x2adba1){this['logger']['error'](_0x2adba1);_0x2adba1 instanceof too_many_requests_error_1[_0x5df0de(0x143)]?(await this[_0x5df0de(0x110)][_0x5df0de(0x130)](this[_0x5df0de(0x145)]+_0x5df0de(0x11c))['send'](),await(0x0,utils_1[_0x5df0de(0x15f)])(0x3c*0x3c*0x3e8),this[_0x5df0de(0x138)]()):await this['sfLogger'][_0x5df0de(0x170)](this[_0x5df0de(0x145)]+_0x5df0de(0x10d)+_0x2adba1)[_0x5df0de(0x13a)]();return;}await this[_0x5df0de(0x110)][_0x5df0de(0x130)](this[_0x5df0de(0x145)]+_0x5df0de(0x161))['send'](),await this[_0x5df0de(0x103)][_0x5df0de(0x123)](typedi_1[_0x5df0de(0x11b)]['get'](providers_tokens_1[_0x5df0de(0xf7)][_0x5df0de(0x107)]))[_0x5df0de(0x100)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x626252(0x167)])({'transient':!![]}),__metadata(a111_0x626252(0x122),[salesforce_service_1[a111_0x626252(0x172)],salesforce_sync_service_1[a111_0x626252(0x16a)]])],SyncService),exports[a111_0x626252(0x16e)]=SyncService;