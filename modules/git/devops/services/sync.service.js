const a111_0x33422a=a111_0x8e2c;(function(_0x9c2283,_0x3c0947){const _0x29ff94=a111_0x8e2c,_0x21d8ac=_0x9c2283();while(!![]){try{const _0x24e63d=parseInt(_0x29ff94(0x1ca))/0x1+-parseInt(_0x29ff94(0x1a6))/0x2*(-parseInt(_0x29ff94(0x14e))/0x3)+-parseInt(_0x29ff94(0x185))/0x4+-parseInt(_0x29ff94(0x19a))/0x5*(-parseInt(_0x29ff94(0x1a9))/0x6)+parseInt(_0x29ff94(0x175))/0x7+-parseInt(_0x29ff94(0x1bf))/0x8*(parseInt(_0x29ff94(0x166))/0x9)+-parseInt(_0x29ff94(0x1b2))/0xa*(parseInt(_0x29ff94(0x194))/0xb);if(_0x24e63d===_0x3c0947)break;else _0x21d8ac['push'](_0x21d8ac['shift']());}catch(_0x564bdd){_0x21d8ac['push'](_0x21d8ac['shift']());}}}(a111_0x2620,0x632a5));const a111_0xc8a7ef=(function(){let _0x1cbcf0=!![];return function(_0x4361fd,_0x5dc66a){const _0x5d1e36=_0x1cbcf0?function(){const _0x6a74e8=a111_0x8e2c;if(_0x5dc66a){const _0x5167d1=_0x5dc66a[_0x6a74e8(0x159)](_0x4361fd,arguments);return _0x5dc66a=null,_0x5167d1;}}:function(){};return _0x1cbcf0=![],_0x5d1e36;};}()),a111_0x924ca3=a111_0xc8a7ef(this,function(){const _0x2a886d=a111_0x8e2c;return a111_0x924ca3[_0x2a886d(0x197)]()['search'](_0x2a886d(0x18b))[_0x2a886d(0x197)]()[_0x2a886d(0x151)](a111_0x924ca3)[_0x2a886d(0x186)]('(((.+)+)+)+$');});a111_0x924ca3();function a111_0x8e2c(_0x29758f,_0x3acb52){const _0x7bfc7d=a111_0x2620();return a111_0x8e2c=function(_0x924ca3,_0xc8a7ef){_0x924ca3=_0x924ca3-0x14d;let _0x262041=_0x7bfc7d[_0x924ca3];return _0x262041;},a111_0x8e2c(_0x29758f,_0x3acb52);}'use strict';var __decorate=this&&this[a111_0x33422a(0x18c)]||function(_0x23ee6c,_0x387b22,_0x50b625,_0x405424){const _0x384c44=a111_0x33422a;var _0x33291d=arguments[_0x384c44(0x169)],_0x21c5ef=_0x33291d<0x3?_0x387b22:_0x405424===null?_0x405424=Object[_0x384c44(0x154)](_0x387b22,_0x50b625):_0x405424,_0x539e28;if(typeof Reflect===_0x384c44(0x17a)&&typeof Reflect[_0x384c44(0x19d)]==='function')_0x21c5ef=Reflect[_0x384c44(0x19d)](_0x23ee6c,_0x387b22,_0x50b625,_0x405424);else{for(var _0x5ca303=_0x23ee6c[_0x384c44(0x169)]-0x1;_0x5ca303>=0x0;_0x5ca303--)if(_0x539e28=_0x23ee6c[_0x5ca303])_0x21c5ef=(_0x33291d<0x3?_0x539e28(_0x21c5ef):_0x33291d>0x3?_0x539e28(_0x387b22,_0x50b625,_0x21c5ef):_0x539e28(_0x387b22,_0x50b625))||_0x21c5ef;}return _0x33291d>0x3&&_0x21c5ef&&Object[_0x384c44(0x165)](_0x387b22,_0x50b625,_0x21c5ef),_0x21c5ef;},__metadata=this&&this[a111_0x33422a(0x191)]||function(_0x286da7,_0x5ae42b){const _0x48bce7=a111_0x33422a;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x48bce7(0x172))return Reflect[_0x48bce7(0x164)](_0x286da7,_0x5ae42b);},SyncService_1;Object[a111_0x33422a(0x165)](exports,'__esModule',{'value':!![]}),exports[a111_0x33422a(0x1b1)]=void 0x0;const constants_1=require(a111_0x33422a(0x1c2)),core_1=require(a111_0x33422a(0x17f)),too_many_requests_error_1=require(a111_0x33422a(0x167)),flosum_repository_sync_dto_1=require(a111_0x33422a(0x1ae)),salesforce_error_1=require(a111_0x33422a(0x179)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a111_0x33422a(0x18d)),utils_1=require(a111_0x33422a(0x1b5)),typedi_1=require('typedi'),hooks_utils_1=require('../../providers/web-hooks/hooks.utils'),git_branch_not_found_error_1=require(a111_0x33422a(0x15e)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require('../jobs/git-sync.job'),providers_tokens_1=require(a111_0x33422a(0x168)),bad_request_error_1=require(a111_0x33422a(0x1b0));let SyncService=SyncService_1=class SyncService{constructor(_0x2b8399,_0x2e5b08){const _0x3258da=a111_0x33422a;this[_0x3258da(0x19b)]=_0x2b8399,this[_0x3258da(0x1a0)]=_0x2e5b08,this[_0x3258da(0x18e)]=new core_1[(_0x3258da(0x1c8))](SyncService_1[_0x3258da(0x1bb)]),this['repositoriesIntersections']={},this[_0x3258da(0x1af)]=[];}async[a111_0x33422a(0x1aa)](_0x9b4911,_0x658f5){const _0x24cda7=a111_0x33422a;if(_0x658f5 instanceof git_branch_not_found_error_1[_0x24cda7(0x150)]){await this[_0x24cda7(0x1a0)][_0x24cda7(0x1a7)](_0x9b4911,'Not\x20Synchronized');return;}if(_0x658f5 instanceof too_many_requests_error_1[_0x24cda7(0x1c6)]){await this[_0x24cda7(0x1a0)][_0x24cda7(0x1a7)](_0x9b4911,_0x24cda7(0x16b));throw _0x658f5;}try{await this[_0x24cda7(0x14f)]['error'](this['prefix']+_0x24cda7(0x192)+_0x9b4911[_0x24cda7(0x1d0)]+_0x24cda7(0x193)+_0x9b4911[_0x24cda7(0x1cd)]+_0x24cda7(0x198)+_0x658f5+'.')['send'](),await this[_0x24cda7(0x1a0)][_0x24cda7(0x1b6)](_0x9b4911,{}),await this['salesforceSync']['setStatus'](_0x9b4911,_0x24cda7(0x162));}catch(_0x34acdf){if(_0x34acdf instanceof salesforce_error_1[_0x24cda7(0x1ad)])throw _0x34acdf;}}async[a111_0x33422a(0x178)](_0x4e93ec){const _0x374aa6=a111_0x33422a;if(_0x4e93ec[_0x374aa6(0x17c)]){const _0x23d4f4=_0x4e93ec[_0x374aa6(0x1d0)]['toLowerCase'](),_0x28e522=this[_0x374aa6(0x17d)][_0x23d4f4];if(!_0x28e522)this['repositoriesIntersections'][_0x23d4f4]=_0x4e93ec[_0x374aa6(0x1d0)];else{if(_0x28e522&&_0x28e522!==_0x4e93ec[_0x374aa6(0x1d0)])return await this[_0x374aa6(0x1aa)](_0x4e93ec,new Error(_0x374aa6(0x196)+_0x4e93ec[_0x374aa6(0x1d0)]+_0x374aa6(0x16e)+_0x23d4f4+'\x27\x20-\x20\x27'+_0x28e522+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x1b12d0){const _0x1cea7f=a111_0x33422a;if(!constants_1[_0x1cea7f(0x174)][_0x1cea7f(0x157)](_0x1b12d0['repositoryName']))return await this[_0x1cea7f(0x1aa)](_0x1b12d0,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x1b12d0[_0x1cea7f(0x1d0)]+_0x1cea7f(0x1ce))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x1cea7f(0x157)](_0x1b12d0[_0x1cea7f(0x1cd)]))return await this[_0x1cea7f(0x1aa)](_0x1b12d0,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x1b12d0[_0x1cea7f(0x1cd)]+_0x1cea7f(0x1c9)+_0x1b12d0[_0x1cea7f(0x1d0)]+_0x1cea7f(0x163))),![];return!![];}async['getOrCreateRepo'](_0x298877,_0x59f183){const _0x53eefb=a111_0x33422a;let _0xea73be=this[_0x53eefb(0x1af)]['find'](_0x5c3de4=>_0x298877[_0x53eefb(0x1d0)]===_0x5c3de4['name']);!_0xea73be&&(this[_0x53eefb(0x14f)]['log'](this[_0x53eefb(0x16c)]+_0x53eefb(0x1cf)+_0x298877[_0x53eefb(0x1d0)]+_0x53eefb(0x184)),_0xea73be=await this[_0x53eefb(0x17e)][_0x53eefb(0x15f)]({'name':_0x298877[_0x53eefb(0x1d0)],'autoInit':!![],'defaultBranch':_0x298877[_0x53eefb(0x1cd)],'private':!![],'createHook':typedi_1['Container']['get'](providers_tokens_1[_0x53eefb(0x1a5)]['config'])[_0x53eefb(0x17b)]}));if(this[_0x53eefb(0x1be)][_0x53eefb(0x17b)]){const _0x31c408=await _0xea73be[_0x53eefb(0x155)][_0x53eefb(0x15d)]();!_0x31c408[_0x53eefb(0x188)](_0x13b728=>_0x13b728[_0x53eefb(0x1a2)]===hooks_utils_1[_0x53eefb(0x195)][_0x53eefb(0x1a8)](this['config'][_0x53eefb(0x156)],this['config'][_0x53eefb(0x14d)],_0x59f183))&&(this[_0x53eefb(0x14f)][_0x53eefb(0x18a)](this[_0x53eefb(0x16c)]+'\x20Repository\x20\x22'+_0x298877['repositoryName']+_0x53eefb(0x177)),await _0xea73be[_0x53eefb(0x155)][_0x53eefb(0x15f)](hooks_utils_1[_0x53eefb(0x195)]['createHookPayload'](this[_0x53eefb(0x1be)][_0x53eefb(0x156)],_0xea73be[_0x53eefb(0x155)],this[_0x53eefb(0x1be)][_0x53eefb(0x14d)],_0x59f183)));}return this[_0x53eefb(0x1af)][_0x53eefb(0x183)](_0xea73be),_0xea73be;}async['run'](){const _0x77fcee=a111_0x33422a;this['gitApiService']=typedi_1[_0x77fcee(0x180)][_0x77fcee(0x1cc)](providers_tokens_1['Tokens'][_0x77fcee(0x170)]),this[_0x77fcee(0x17e)]=typedi_1[_0x77fcee(0x180)]['get'](providers_tokens_1['Tokens'][_0x77fcee(0x190)]),this[_0x77fcee(0x1be)]=typedi_1[_0x77fcee(0x180)]['get'](providers_tokens_1[_0x77fcee(0x1a5)]['config']),this[_0x77fcee(0x14f)]=typedi_1[_0x77fcee(0x180)][_0x77fcee(0x1cc)](providers_tokens_1['Tokens'][_0x77fcee(0x18e)]),this[_0x77fcee(0x16c)]='['+SyncService_1[_0x77fcee(0x1bb)]+_0x77fcee(0x1ac)+this[_0x77fcee(0x1be)][_0x77fcee(0x156)][_0x77fcee(0x19e)]()+']',this[_0x77fcee(0x19b)][_0x77fcee(0x1b3)](this[_0x77fcee(0x14f)][_0x77fcee(0x1bd)]());try{this[_0x77fcee(0x14f)][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x15c)),await this[_0x77fcee(0x14f)][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x171))['send']();const _0x2319f9=await this[_0x77fcee(0x1a0)][_0x77fcee(0x182)](typedi_1[_0x77fcee(0x180)][_0x77fcee(0x1cc)](providers_tokens_1[_0x77fcee(0x1a5)]['connectionId']));if(!_0x2319f9[_0x77fcee(0x169)])throw new bad_request_error_1[(_0x77fcee(0x16a))](this[_0x77fcee(0x16c)]+_0x77fcee(0x19c));await this[_0x77fcee(0x14f)][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x16d))[_0x77fcee(0x19f)]();const _0xcc8f7a=await this[_0x77fcee(0x1a0)][_0x77fcee(0x1a1)](_0x2319f9[_0x77fcee(0x1c4)](_0x49d4e5=>'\x27'+_0x49d4e5[_0x77fcee(0x17c)]+'\x27')[_0x77fcee(0x1bc)](','));await this[_0x77fcee(0x14f)][_0x77fcee(0x18a)](this['prefix']+'\x20Getting\x20repositories\x20from\x20git\x20service.')['send'](),this[_0x77fcee(0x1af)]=await this[_0x77fcee(0x17e)][_0x77fcee(0x15d)]();const _0xeb0b67=[..._0x2319f9,..._0xcc8f7a];this['sfLogger'][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x181)+_0xeb0b67[_0x77fcee(0x169)]+_0x77fcee(0x199));for(const _0x34f3f6 of _0xeb0b67){this[_0x77fcee(0x18e)][_0x77fcee(0x18a)](_0x77fcee(0x1b7)+_0x34f3f6[_0x77fcee(0x1d0)]+'['+_0x34f3f6[_0x77fcee(0x17c)]+']\x20repository\x20'+_0x34f3f6[_0x77fcee(0x1cd)]+'['+_0x34f3f6[_0x77fcee(0x1ba)]+_0x77fcee(0x1ab)),this[_0x77fcee(0x14f)][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x1b9)+_0x34f3f6[_0x77fcee(0x1d0)]+_0x77fcee(0x161)+_0x34f3f6[_0x77fcee(0x1cd)]+'\x22.'),this['sfLogger'][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x1c5));const _0x2d7852=await this[_0x77fcee(0x1a3)](_0x34f3f6);if(!_0x2d7852)continue;this['sfLogger'][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x160));const _0xc18085=await this[_0x77fcee(0x178)](_0x34f3f6);if(_0xc18085)continue;await this[_0x77fcee(0x14f)][_0x77fcee(0x19f)]();let _0x44a707;try{await this[_0x77fcee(0x14f)][_0x77fcee(0x18a)](this['prefix']+'\x20Getting\x20Flosum\x20repository')['send'](),_0x44a707=await this['getOrCreateRepo'](_0x34f3f6,typedi_1['Container'][_0x77fcee(0x1cc)](providers_tokens_1[_0x77fcee(0x1a5)][_0x77fcee(0x1c1)]));}catch(_0x230ae6){await this[_0x77fcee(0x1aa)](_0x34f3f6,_0x230ae6 instanceof too_many_requests_error_1['TooManyRequests']?_0x230ae6:new Error(_0x77fcee(0x189)+_0x230ae6));continue;}await this['sfLogger'][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x1a4))[_0x77fcee(0x19f)]();if(_0x34f3f6[_0x77fcee(0x16f)]===flosum_repository_sync_dto_1['SyncDirection'][_0x77fcee(0x176)]){const _0x547e3a=typedi_1['Container'][_0x77fcee(0x1cc)](flosum_sync_job_1[_0x77fcee(0x1c0)]);await _0x547e3a[_0x77fcee(0x15b)]({'repository':_0x44a707,'convertToSFDX':this[_0x77fcee(0x1be)][_0x77fcee(0x187)],'syncRecord':_0x34f3f6,'provider':this[_0x77fcee(0x1be)][_0x77fcee(0x156)]})[_0x77fcee(0x1b8)](_0x44cfdd=>this[_0x77fcee(0x1aa)](_0x34f3f6,_0x44cfdd));}else{const _0x12f571=typedi_1['Container'][_0x77fcee(0x1cc)](git_sync_job_1[_0x77fcee(0x173)]);await _0x12f571[_0x77fcee(0x15b)]({'repository':_0x44a707,'branch':_0x34f3f6[_0x77fcee(0x1cd)],'provider':this[_0x77fcee(0x1be)][_0x77fcee(0x156)],'repositoryGit':_0x44a707['gitUrl'],'syncRecord':_0x34f3f6})[_0x77fcee(0x1b8)](_0x1d30a7=>this[_0x77fcee(0x1aa)](_0x34f3f6,_0x1d30a7));}}}catch(_0x4227ba){this[_0x77fcee(0x18e)][_0x77fcee(0x18f)](_0x4227ba);_0x4227ba instanceof too_many_requests_error_1[_0x77fcee(0x1c6)]?(await this[_0x77fcee(0x14f)][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x153))[_0x77fcee(0x19f)](),await(0x0,utils_1['sleep'])(0x3c*0x3c*0x3e8),this[_0x77fcee(0x15b)]()):await this[_0x77fcee(0x14f)]['error'](this[_0x77fcee(0x16c)]+_0x77fcee(0x1c3)+_0x4227ba)['send']();return;}await this['sfLogger'][_0x77fcee(0x18a)](this[_0x77fcee(0x16c)]+_0x77fcee(0x158))['send'](),await this[_0x77fcee(0x1a0)][_0x77fcee(0x15a)](typedi_1[_0x77fcee(0x180)][_0x77fcee(0x1cc)](providers_tokens_1[_0x77fcee(0x1a5)]['connectionId']))[_0x77fcee(0x1b8)](()=>null);}};function a111_0x2620(){const _0x1532cc=['20RnhdLE','setLoggerId','design:paramtypes','../../../shared/utils','updateRemoteState','Syncing\x20','catch','\x20Syncing\x20repository:\x20\x22','branchId','name','join','getLoggerId','config','8kAfKWq','FlosumSyncJob','connectionId','../../../../constants','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','map','\x20Checking\x20valid\x20name.','TooManyRequests','Service','Logger','\x27\x20in\x20repository\x20\x27','635694ebXOrW','SalesforceService','get','branchName','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x20Repository\x20\x22','repositoryName','applicationUrl','12zNTKnn','sfLogger','GitBranchNotFoundError','constructor','SalesforceSyncService','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','getOwnPropertyDescriptor','hooks','gitProvider','test','\x20Sync\x20job\x20done.','apply','disableSync','run','\x20Start\x20sync\x20job.','getAll','../errors/git-branch-not-found.error','create','\x20Checking\x20intersects.','\x22\x20branch:\x20\x22','Error','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','metadata','defineProperty','3691773sVOyGi','../../../../core/errors/too-many-requests.error','../../providers/providers.tokens','length','BadRequestError','Waiting','prefix','\x20Getting\x20branch\x20records.','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','direction','gitApiService','\x20Getting\x20repository\x20records.','function','GitSyncJob','REPOSITORY_NAME_REGEXP','4929337xFqzQc','FlosumToGit','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','isIntersects','../../salesforce/errors/salesforce.error','object','isBidirectionalSynchronization','repositoryId','repositoriesIntersections','repoService','../../../../core','Container','\x20Have\x20to\x20synchronize\x20','getRepositoryRecords','push','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','1286904TkUpkb','search','isConvertToSfdx','find','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','log','(((.+)+)+)+$','__decorate','../../salesforce/services/salesforce.service','logger','error','gitRepoService','__metadata','\x20Stop\x20sync\x20job\x20for\x20\x27','\x27\x20[','6852769vSRWAt','HooksUtils','Unable\x20to\x20synchronize\x20repository\x20\x27','toString',']\x20due\x20error\x20-\x20','\x20branches.','3838745UmJUIA','salesforceService','\x20No\x20repositories\x20to\x20sync.','decorate','toUpperCase','send','salesforceSync','getBranchRecords','url','checkValidNaming','\x20Completed\x20prepare\x20to\x20syncing.','Tokens','138214thNwRK','setStatus','getHookLinkFor','6DbpMQq','handleRecordSyncError',']\x20branch.',']\x20[','SalesforceError','../../salesforce/dto/flosum-repository-sync.dto','repoList','../../../../core/errors/bad-request.error','SyncService'];a111_0x2620=function(){return _0x1532cc;};return a111_0x2620();}SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x33422a(0x1c7)])({'transient':!![]}),__metadata(a111_0x33422a(0x1b4),[salesforce_service_1[a111_0x33422a(0x1cb)],salesforce_sync_service_1[a111_0x33422a(0x152)]])],SyncService),exports[a111_0x33422a(0x1b1)]=SyncService;