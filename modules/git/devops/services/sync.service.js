const a111_0x1df533=a111_0x3467;function a111_0x429b(){const _0x4b8608=['repoList','url','GitBranchNotFoundError','setStatus','\x20Syncing\x20repository:\x20\x22','sfLogger','\x20Getting\x20repositories\x20from\x20git\x20service.','send','\x20Stop\x20sync\x20job\x20for\x20\x27','23001470xKxCnP','gitProvider','HooksUtils','\x20Getting\x20repository\x20records.','applicationUrl','repositoriesIntersections','branchName','Waiting','../../../shared/utils','error','SalesforceService','toUpperCase','getHookLinkFor','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20',']\x20branch.','checkValidNaming','../jobs/git-sync.job','logger','object','SalesforceSyncService','salesforceSync','5130978zvpPqF','Syncing\x20','catch','\x20No\x20repositories\x20to\x20sync.','Tokens','getRepositoryRecords','get','../../../../core','setLoggerId','apply','../../salesforce/services/salesforce.service','create','884399NUSiXI','decorate','find','Not\x20Synchronized','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','__esModule','../../../../constants','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','constructor','sleep','defineProperty','config','\x27\x20in\x20repository\x20\x27','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','getAll',']\x20due\x20error\x20-\x20','repoService','run','BRANCH_NAME_REGEXP','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','Unable\x20to\x20synchronize\x20repository\x20\x27','Error','connectionId','TooManyRequests','../../salesforce/services/salesforce-sync.service','name','salesforceService','hooks','14CMSCjl',']\x20[','../../providers/providers.tokens','27FlMfOB','../../../../core/errors/bad-request.error','handleRecordSyncError','getOrCreateRepo','Unable\x20to\x20synchronize\x20branch\x20\x27','1809888LiwsyV','gitApiService','createHookPayload',']\x20repository\x20','Container','SyncService','search','repositoryName','getLoggerId','FlosumSyncJob','length','Logger','getBranchRecords','push','isBidirectionalSynchronization','repositoryId','\x20branches.','toLowerCase','direction','(((.+)+)+)+$','SyncDirection','function','isIntersects','\x20Repository\x20\x22','../../providers/web-hooks/hooks.utils','8474420Bcwfob','3292632hPYxts','branchId','prefix','\x20Getting\x20Flosum\x20repository','disableSync','14FGJwXD','\x22\x20branch:\x20\x22','map','gitUrl','design:paramtypes','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','REPOSITORY_NAME_REGEXP','Service','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','log','SalesforceError','262395wapNbq','GitSyncJob','test','\x27\x20[','__metadata','toString','\x20Checking\x20valid\x20name.','BadRequestError'];a111_0x429b=function(){return _0x4b8608;};return a111_0x429b();}(function(_0x3d939a,_0x4afafe){const _0x475734=a111_0x3467,_0x5a9ba7=_0x3d939a();while(!![]){try{const _0x2f99e0=-parseInt(_0x475734(0x268))/0x1+-parseInt(_0x475734(0x204))/0x2*(-parseInt(_0x475734(0x236))/0x3)+parseInt(_0x475734(0x226))/0x4+parseInt(_0x475734(0x225))/0x5+-parseInt(_0x475734(0x25c))/0x6*(-parseInt(_0x475734(0x22b))/0x7)+-parseInt(_0x475734(0x20c))/0x8*(parseInt(_0x475734(0x207))/0x9)+-parseInt(_0x475734(0x247))/0xa;if(_0x2f99e0===_0x4afafe)break;else _0x5a9ba7['push'](_0x5a9ba7['shift']());}catch(_0x262fd3){_0x5a9ba7['push'](_0x5a9ba7['shift']());}}}(a111_0x429b,0xee9d9));const a111_0xe65724=(function(){let _0x453cf9=!![];return function(_0x104c39,_0x35bbf4){const _0x1cc65d=_0x453cf9?function(){const _0xdec0d0=a111_0x3467;if(_0x35bbf4){const _0x40d521=_0x35bbf4[_0xdec0d0(0x265)](_0x104c39,arguments);return _0x35bbf4=null,_0x40d521;}}:function(){};return _0x453cf9=![],_0x1cc65d;};}()),a111_0x490e5a=a111_0xe65724(this,function(){const _0x55c0ff=a111_0x3467;return a111_0x490e5a[_0x55c0ff(0x23b)]()[_0x55c0ff(0x212)](_0x55c0ff(0x21f))[_0x55c0ff(0x23b)]()[_0x55c0ff(0x1f0)](a111_0x490e5a)[_0x55c0ff(0x212)]('(((.+)+)+)+$');});a111_0x490e5a();'use strict';var __decorate=this&&this['__decorate']||function(_0xb3701,_0x40afa5,_0x2fe9fd,_0x183aa8){const _0x458ee5=a111_0x3467;var _0x2b8377=arguments[_0x458ee5(0x216)],_0x330539=_0x2b8377<0x3?_0x40afa5:_0x183aa8===null?_0x183aa8=Object['getOwnPropertyDescriptor'](_0x40afa5,_0x2fe9fd):_0x183aa8,_0x19875e;if(typeof Reflect===_0x458ee5(0x259)&&typeof Reflect[_0x458ee5(0x269)]===_0x458ee5(0x221))_0x330539=Reflect['decorate'](_0xb3701,_0x40afa5,_0x2fe9fd,_0x183aa8);else{for(var _0x2b2cbc=_0xb3701[_0x458ee5(0x216)]-0x1;_0x2b2cbc>=0x0;_0x2b2cbc--)if(_0x19875e=_0xb3701[_0x2b2cbc])_0x330539=(_0x2b8377<0x3?_0x19875e(_0x330539):_0x2b8377>0x3?_0x19875e(_0x40afa5,_0x2fe9fd,_0x330539):_0x19875e(_0x40afa5,_0x2fe9fd))||_0x330539;}return _0x2b8377>0x3&&_0x330539&&Object[_0x458ee5(0x1f2)](_0x40afa5,_0x2fe9fd,_0x330539),_0x330539;},__metadata=this&&this[a111_0x1df533(0x23a)]||function(_0x4419a2,_0x22d311){const _0x6d9b64=a111_0x1df533;if(typeof Reflect===_0x6d9b64(0x259)&&typeof Reflect['metadata']===_0x6d9b64(0x221))return Reflect['metadata'](_0x4419a2,_0x22d311);},SyncService_1;Object[a111_0x1df533(0x1f2)](exports,a111_0x1df533(0x1ed),{'value':!![]}),exports[a111_0x1df533(0x211)]=void 0x0;const constants_1=require(a111_0x1df533(0x1ee)),core_1=require(a111_0x1df533(0x263)),too_many_requests_error_1=require('../../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_sync_service_1=require(a111_0x1df533(0x200)),salesforce_service_1=require(a111_0x1df533(0x266)),utils_1=require(a111_0x1df533(0x24f)),typedi_1=require('typedi'),hooks_utils_1=require(a111_0x1df533(0x224)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a111_0x1df533(0x257)),providers_tokens_1=require(a111_0x1df533(0x206)),bad_request_error_1=require(a111_0x1df533(0x208));function a111_0x3467(_0x149f60,_0x565821){const _0x5bdff7=a111_0x429b();return a111_0x3467=function(_0x490e5a,_0xe65724){_0x490e5a=_0x490e5a-0x1ed;let _0x429b5e=_0x5bdff7[_0x490e5a];return _0x429b5e;},a111_0x3467(_0x149f60,_0x565821);}let SyncService=SyncService_1=class SyncService{constructor(_0x4df96a,_0x24f0a8){const _0x53b87b=a111_0x1df533;this[_0x53b87b(0x202)]=_0x4df96a,this[_0x53b87b(0x25b)]=_0x24f0a8,this[_0x53b87b(0x258)]=new core_1[(_0x53b87b(0x217))](SyncService_1[_0x53b87b(0x201)]),this[_0x53b87b(0x24c)]={},this[_0x53b87b(0x23e)]=[];}async[a111_0x1df533(0x209)](_0x5770d9,_0x489e9a){const _0x1a35d4=a111_0x1df533;if(_0x489e9a instanceof git_branch_not_found_error_1[_0x1a35d4(0x240)]){await this[_0x1a35d4(0x25b)]['setStatus'](_0x5770d9,_0x1a35d4(0x26b));return;}if(_0x489e9a instanceof too_many_requests_error_1[_0x1a35d4(0x1ff)]){await this[_0x1a35d4(0x25b)][_0x1a35d4(0x241)](_0x5770d9,_0x1a35d4(0x24e));throw _0x489e9a;}try{await this[_0x1a35d4(0x243)][_0x1a35d4(0x250)](this[_0x1a35d4(0x228)]+_0x1a35d4(0x246)+_0x5770d9[_0x1a35d4(0x213)]+_0x1a35d4(0x239)+_0x5770d9[_0x1a35d4(0x24d)]+_0x1a35d4(0x1f7)+_0x489e9a+'.')[_0x1a35d4(0x245)](),await this[_0x1a35d4(0x25b)]['updateRemoteState'](_0x5770d9,{}),await this['salesforceSync'][_0x1a35d4(0x241)](_0x5770d9,_0x1a35d4(0x1fd));}catch(_0x47351a){if(_0x47351a instanceof salesforce_error_1[_0x1a35d4(0x235)])throw _0x47351a;}}async[a111_0x1df533(0x222)](_0x3dfbf1){const _0x6a523e=a111_0x1df533;if(_0x3dfbf1[_0x6a523e(0x21b)]){const _0x3ff2f3=_0x3dfbf1[_0x6a523e(0x213)][_0x6a523e(0x21d)](),_0x492e05=this[_0x6a523e(0x24c)][_0x3ff2f3];if(!_0x492e05)this[_0x6a523e(0x24c)][_0x3ff2f3]=_0x3dfbf1[_0x6a523e(0x213)];else{if(_0x492e05&&_0x492e05!==_0x3dfbf1[_0x6a523e(0x213)])return await this[_0x6a523e(0x209)](_0x3dfbf1,new Error(_0x6a523e(0x1fc)+_0x3dfbf1[_0x6a523e(0x213)]+_0x6a523e(0x26c)+_0x3ff2f3+'\x27\x20-\x20\x27'+_0x492e05+'\x27')),!![];}}return![];}async[a111_0x1df533(0x256)](_0x580e67){const _0x2439ce=a111_0x1df533;if(!constants_1[_0x2439ce(0x231)][_0x2439ce(0x238)](_0x580e67['repositoryName']))return await this['handleRecordSyncError'](_0x580e67,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x580e67[_0x2439ce(0x213)]+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1[_0x2439ce(0x1fa)][_0x2439ce(0x238)](_0x580e67[_0x2439ce(0x24d)]))return await this[_0x2439ce(0x209)](_0x580e67,new Error(_0x2439ce(0x20b)+_0x580e67['branchName']+_0x2439ce(0x1f4)+_0x580e67[_0x2439ce(0x213)]+_0x2439ce(0x233))),![];return!![];}async[a111_0x1df533(0x20a)](_0x20b940,_0xcd2aba){const _0x36e416=a111_0x1df533;let _0x12bd96=this[_0x36e416(0x23e)][_0x36e416(0x26a)](_0xa057cc=>_0x20b940[_0x36e416(0x213)]===_0xa057cc[_0x36e416(0x201)]);!_0x12bd96&&(this[_0x36e416(0x243)][_0x36e416(0x234)](this[_0x36e416(0x228)]+_0x36e416(0x223)+_0x20b940[_0x36e416(0x213)]+_0x36e416(0x1ef)),_0x12bd96=await this[_0x36e416(0x1f8)]['create']({'name':_0x20b940[_0x36e416(0x213)],'autoInit':!![],'defaultBranch':_0x20b940['branchName'],'private':!![],'createHook':typedi_1[_0x36e416(0x210)]['get'](providers_tokens_1[_0x36e416(0x260)][_0x36e416(0x1f3)])[_0x36e416(0x21a)]}));if(this[_0x36e416(0x1f3)][_0x36e416(0x21a)]){const _0x55bd27=await _0x12bd96[_0x36e416(0x203)]['getAll']();!_0x55bd27[_0x36e416(0x26a)](_0x1a4baa=>_0x1a4baa[_0x36e416(0x23f)]===hooks_utils_1[_0x36e416(0x249)][_0x36e416(0x253)](this['config']['gitProvider'],this[_0x36e416(0x1f3)][_0x36e416(0x24b)],_0xcd2aba))&&(this[_0x36e416(0x243)]['log'](this['prefix']+_0x36e416(0x223)+_0x20b940[_0x36e416(0x213)]+_0x36e416(0x230)),await _0x12bd96['hooks'][_0x36e416(0x267)](hooks_utils_1[_0x36e416(0x249)][_0x36e416(0x20e)](this[_0x36e416(0x1f3)][_0x36e416(0x248)],_0x12bd96[_0x36e416(0x203)],this[_0x36e416(0x1f3)][_0x36e416(0x24b)],_0xcd2aba)));}return this[_0x36e416(0x23e)][_0x36e416(0x219)](_0x12bd96),_0x12bd96;}async[a111_0x1df533(0x1f9)](){const _0x370fb4=a111_0x1df533;this['gitApiService']=typedi_1[_0x370fb4(0x210)][_0x370fb4(0x262)](providers_tokens_1[_0x370fb4(0x260)][_0x370fb4(0x20d)]),this['repoService']=typedi_1[_0x370fb4(0x210)][_0x370fb4(0x262)](providers_tokens_1['Tokens']['gitRepoService']),this[_0x370fb4(0x1f3)]=typedi_1['Container'][_0x370fb4(0x262)](providers_tokens_1[_0x370fb4(0x260)][_0x370fb4(0x1f3)]),this[_0x370fb4(0x243)]=typedi_1[_0x370fb4(0x210)][_0x370fb4(0x262)](providers_tokens_1['Tokens'][_0x370fb4(0x258)]),this[_0x370fb4(0x228)]='['+SyncService_1['name']+_0x370fb4(0x205)+this[_0x370fb4(0x1f3)]['gitProvider'][_0x370fb4(0x252)]()+']',this[_0x370fb4(0x202)][_0x370fb4(0x264)](this[_0x370fb4(0x243)][_0x370fb4(0x214)]());try{this[_0x370fb4(0x243)][_0x370fb4(0x234)](this[_0x370fb4(0x228)]+'\x20Start\x20sync\x20job.'),await this['sfLogger'][_0x370fb4(0x234)](this[_0x370fb4(0x228)]+_0x370fb4(0x24a))[_0x370fb4(0x245)]();const _0x3c2577=await this[_0x370fb4(0x25b)][_0x370fb4(0x261)](typedi_1[_0x370fb4(0x210)]['get'](providers_tokens_1['Tokens']['connectionId']));if(!_0x3c2577[_0x370fb4(0x216)])throw new bad_request_error_1[(_0x370fb4(0x23d))](this[_0x370fb4(0x228)]+_0x370fb4(0x25f));await this['sfLogger'][_0x370fb4(0x234)](this['prefix']+'\x20Getting\x20branch\x20records.')[_0x370fb4(0x245)]();const _0x4d65ba=await this[_0x370fb4(0x25b)][_0x370fb4(0x218)](_0x3c2577[_0x370fb4(0x22d)](_0x39d897=>'\x27'+_0x39d897['repositoryId']+'\x27')['join'](','));await this[_0x370fb4(0x243)]['log'](this[_0x370fb4(0x228)]+_0x370fb4(0x244))['send'](),this[_0x370fb4(0x23e)]=await this[_0x370fb4(0x1f8)][_0x370fb4(0x1f6)]();const _0xd0cbc9=[..._0x3c2577,..._0x4d65ba];this[_0x370fb4(0x243)]['log'](this['prefix']+'\x20Have\x20to\x20synchronize\x20'+_0xd0cbc9[_0x370fb4(0x216)]+_0x370fb4(0x21c));for(const _0x11084d of _0xd0cbc9){this[_0x370fb4(0x258)]['log'](_0x370fb4(0x25d)+_0x11084d[_0x370fb4(0x213)]+'['+_0x11084d['repositoryId']+_0x370fb4(0x20f)+_0x11084d[_0x370fb4(0x24d)]+'['+_0x11084d[_0x370fb4(0x227)]+_0x370fb4(0x255)),this[_0x370fb4(0x243)][_0x370fb4(0x234)](this['prefix']+_0x370fb4(0x242)+_0x11084d[_0x370fb4(0x213)]+_0x370fb4(0x22c)+_0x11084d[_0x370fb4(0x24d)]+'\x22.'),this['sfLogger'][_0x370fb4(0x234)](this[_0x370fb4(0x228)]+_0x370fb4(0x23c));const _0x21d455=await this['checkValidNaming'](_0x11084d);if(!_0x21d455)continue;this[_0x370fb4(0x243)][_0x370fb4(0x234)](this[_0x370fb4(0x228)]+'\x20Checking\x20intersects.');const _0x2f7b9d=await this['isIntersects'](_0x11084d);if(_0x2f7b9d)continue;await this[_0x370fb4(0x243)][_0x370fb4(0x245)]();let _0x3e9118;try{await this[_0x370fb4(0x243)]['log'](this['prefix']+_0x370fb4(0x229))['send'](),_0x3e9118=await this[_0x370fb4(0x20a)](_0x11084d,typedi_1[_0x370fb4(0x210)][_0x370fb4(0x262)](providers_tokens_1[_0x370fb4(0x260)]['connectionId']));}catch(_0x4dc467){await this[_0x370fb4(0x209)](_0x11084d,_0x4dc467 instanceof too_many_requests_error_1[_0x370fb4(0x1ff)]?_0x4dc467:new Error(_0x370fb4(0x1fb)+_0x4dc467));continue;}await this[_0x370fb4(0x243)]['log'](this[_0x370fb4(0x228)]+'\x20Completed\x20prepare\x20to\x20syncing.')[_0x370fb4(0x245)]();if(_0x11084d[_0x370fb4(0x21e)]===flosum_repository_sync_dto_1[_0x370fb4(0x220)]['FlosumToGit']){const _0x199d7a=typedi_1['Container'][_0x370fb4(0x262)](flosum_sync_job_1[_0x370fb4(0x215)]);await _0x199d7a['run']({'repository':_0x3e9118,'convertToSFDX':this[_0x370fb4(0x1f3)]['isConvertToSfdx'],'syncRecord':_0x11084d,'provider':this['config']['gitProvider']})[_0x370fb4(0x25e)](_0x53d1d6=>this[_0x370fb4(0x209)](_0x11084d,_0x53d1d6));}else{const _0x14a5d1=typedi_1[_0x370fb4(0x210)][_0x370fb4(0x262)](git_sync_job_1[_0x370fb4(0x237)]);await _0x14a5d1[_0x370fb4(0x1f9)]({'repository':_0x3e9118,'branch':_0x11084d[_0x370fb4(0x24d)],'provider':this[_0x370fb4(0x1f3)][_0x370fb4(0x248)],'repositoryGit':_0x3e9118[_0x370fb4(0x22e)],'syncRecord':_0x11084d})['catch'](_0x347cc1=>this[_0x370fb4(0x209)](_0x11084d,_0x347cc1));}}}catch(_0x5097e9){this[_0x370fb4(0x258)][_0x370fb4(0x250)](_0x5097e9);_0x5097e9 instanceof too_many_requests_error_1['TooManyRequests']?(await this[_0x370fb4(0x243)]['log'](this[_0x370fb4(0x228)]+_0x370fb4(0x1f5))[_0x370fb4(0x245)](),await(0x0,utils_1[_0x370fb4(0x1f1)])(0x3c*0x3c*0x3e8),this[_0x370fb4(0x1f9)]()):await this[_0x370fb4(0x243)]['error'](this['prefix']+_0x370fb4(0x254)+_0x5097e9)[_0x370fb4(0x245)]();return;}await this[_0x370fb4(0x243)]['log'](this[_0x370fb4(0x228)]+'\x20Sync\x20job\x20done.')[_0x370fb4(0x245)](),await this['salesforceSync'][_0x370fb4(0x22a)](typedi_1['Container']['get'](providers_tokens_1['Tokens'][_0x370fb4(0x1fe)]))['catch'](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x1df533(0x232)])({'transient':!![]}),__metadata(a111_0x1df533(0x22f),[salesforce_service_1[a111_0x1df533(0x251)],salesforce_sync_service_1[a111_0x1df533(0x25a)]])],SyncService),exports[a111_0x1df533(0x211)]=SyncService;