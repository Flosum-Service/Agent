const a111_0x146b68=a111_0x6a9d;function a111_0x49d8(){const _0x1be6de=['branchName','getHookLinkFor','BRANCH_NAME_REGEXP','3240088iDVaEK','createHookPayload','run','get','FlosumSyncJob','salesforceSync','\x20Checking\x20valid\x20name.','REPOSITORY_NAME_REGEXP','disableSync','../../salesforce/services/salesforce-sync.service','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','object','error','44qTKFMi','repositoryId','BadRequestError','1281568HLeJXq','hooks','791rayVPA',']\x20branch.','applicationUrl','isConvertToSfdx','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','../jobs/git-sync.job','sfLogger','\x20Sync\x20job\x20done.','getRepositoryRecords','Container','typedi','389334Xhadmx','gitUrl','salesforceService','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','FlosumToGit','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','getOrCreateRepo','apply','Service','Logger','\x20Syncing\x20repository:\x20\x22','\x20Stop\x20sync\x20job\x20for\x20\x27','search','__esModule','isBidirectionalSynchronization','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','gitProvider','../../providers/providers.tokens','repoList','\x20Start\x20sync\x20job.','getLoggerId','\x20Have\x20to\x20synchronize\x20','../../salesforce/errors/salesforce.error','handleRecordSyncError','logger','\x20Getting\x20repositories\x20from\x20git\x20service.','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','\x20Checking\x20intersects.','SalesforceError','../errors/git-branch-not-found.error','Waiting','constructor','Error','sleep','SalesforceService','../../../../core/errors/too-many-requests.error','function','Syncing\x20','\x20Getting\x20branch\x20records.','length','SyncService','44034ZtMDoL','2128479EulxGW','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','gitApiService','18728tBNJjN','setLoggerId','create','(((.+)+)+)+$','TooManyRequests','toUpperCase','defineProperty','isIntersects',']\x20[','GitSyncJob','2523585SuJGsX','send','Unable\x20to\x20synchronize\x20repository\x20\x27','find','../../../../core','150BkOpJx',']\x20repository\x20','repositoryName','__decorate','gitRepoService','18ImnmRC','decorate','toString','SyncDirection','name','repoService','\x20Getting\x20Flosum\x20repository','Tokens','connectionId','../../salesforce/services/salesforce.service','HooksUtils','repositoriesIntersections','\x20Getting\x20repository\x20records.','catch','metadata','checkValidNaming','log','getAll','updateRemoteState','setStatus','config','\x20Completed\x20prepare\x20to\x20syncing.','__metadata','../jobs/flosum-sync.job','../../salesforce/dto/flosum-repository-sync.dto','direction','prefix'];a111_0x49d8=function(){return _0x1be6de;};return a111_0x49d8();}(function(_0x2120b4,_0x593f7e){const _0x569564=a111_0x6a9d,_0x4a4c65=_0x2120b4();while(!![]){try{const _0x517510=-parseInt(_0x569564(0x149))/0x1*(-parseInt(_0x569564(0x109))/0x2)+parseInt(_0x569564(0x106))/0x3+parseInt(_0x569564(0xcf))/0x4+-parseInt(_0x569564(0x113))/0x5+parseInt(_0x569564(0x105))/0x6*(parseInt(_0x569564(0xd1))/0x7)+parseInt(_0x569564(0x13b))/0x8*(-parseInt(_0x569564(0x11d))/0x9)+-parseInt(_0x569564(0x118))/0xa*(parseInt(_0x569564(0xdc))/0xb);if(_0x517510===_0x593f7e)break;else _0x4a4c65['push'](_0x4a4c65['shift']());}catch(_0x262cd0){_0x4a4c65['push'](_0x4a4c65['shift']());}}}(a111_0x49d8,0x67e57));const a111_0x24d113=(function(){let _0x31ac52=!![];return function(_0x47fc09,_0x4cfedc){const _0x13c6c0=_0x31ac52?function(){const _0x610c97=a111_0x6a9d;if(_0x4cfedc){const _0xe1eae5=_0x4cfedc[_0x610c97(0xe3)](_0x47fc09,arguments);return _0x4cfedc=null,_0xe1eae5;}}:function(){};return _0x31ac52=![],_0x13c6c0;};}()),a111_0x32937f=a111_0x24d113(this,function(){const _0x259679=a111_0x6a9d;return a111_0x32937f[_0x259679(0x11f)]()['search'](_0x259679(0x10c))[_0x259679(0x11f)]()[_0x259679(0xfb)](a111_0x32937f)[_0x259679(0xe8)](_0x259679(0x10c));});a111_0x32937f();'use strict';var __decorate=this&&this[a111_0x146b68(0x11b)]||function(_0x22a55c,_0x296c1c,_0x27184b,_0x258b7e){const _0x262d0f=a111_0x146b68;var _0x23a5f9=arguments[_0x262d0f(0x103)],_0x5686a8=_0x23a5f9<0x3?_0x296c1c:_0x258b7e===null?_0x258b7e=Object['getOwnPropertyDescriptor'](_0x296c1c,_0x27184b):_0x258b7e,_0x594fdb;if(typeof Reflect===_0x262d0f(0x147)&&typeof Reflect[_0x262d0f(0x11e)]===_0x262d0f(0x100))_0x5686a8=Reflect['decorate'](_0x22a55c,_0x296c1c,_0x27184b,_0x258b7e);else{for(var _0xd93f08=_0x22a55c['length']-0x1;_0xd93f08>=0x0;_0xd93f08--)if(_0x594fdb=_0x22a55c[_0xd93f08])_0x5686a8=(_0x23a5f9<0x3?_0x594fdb(_0x5686a8):_0x23a5f9>0x3?_0x594fdb(_0x296c1c,_0x27184b,_0x5686a8):_0x594fdb(_0x296c1c,_0x27184b))||_0x5686a8;}return _0x23a5f9>0x3&&_0x5686a8&&Object[_0x262d0f(0x10f)](_0x296c1c,_0x27184b,_0x5686a8),_0x5686a8;},__metadata=this&&this[a111_0x146b68(0x133)]||function(_0x291542,_0x4059f6){const _0x23f53f=a111_0x146b68;if(typeof Reflect===_0x23f53f(0x147)&&typeof Reflect[_0x23f53f(0x12b)]===_0x23f53f(0x100))return Reflect[_0x23f53f(0x12b)](_0x291542,_0x4059f6);},SyncService_1;Object[a111_0x146b68(0x10f)](exports,a111_0x146b68(0xe9),{'value':!![]}),exports[a111_0x146b68(0x104)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a111_0x146b68(0x117)),too_many_requests_error_1=require(a111_0x146b68(0xff)),flosum_repository_sync_dto_1=require(a111_0x146b68(0x135)),salesforce_error_1=require(a111_0x146b68(0xf2)),salesforce_sync_service_1=require(a111_0x146b68(0x144)),salesforce_service_1=require(a111_0x146b68(0x126)),utils_1=require('../../../shared/utils'),typedi_1=require(a111_0x146b68(0xdb)),hooks_utils_1=require('../../providers/web-hooks/hooks.utils'),git_branch_not_found_error_1=require(a111_0x146b68(0xf9)),flosum_sync_job_1=require(a111_0x146b68(0x134)),git_sync_job_1=require(a111_0x146b68(0xd6)),providers_tokens_1=require(a111_0x146b68(0xed)),bad_request_error_1=require('../../../../core/errors/bad-request.error');function a111_0x6a9d(_0x4f9154,_0x23d905){const _0x159633=a111_0x49d8();return a111_0x6a9d=function(_0x32937f,_0x24d113){_0x32937f=_0x32937f-0xcf;let _0x49d817=_0x159633[_0x32937f];return _0x49d817;},a111_0x6a9d(_0x4f9154,_0x23d905);}let SyncService=SyncService_1=class SyncService{constructor(_0x397d3c,_0x841d3e){const _0xf01150=a111_0x146b68;this[_0xf01150(0xde)]=_0x397d3c,this[_0xf01150(0x140)]=_0x841d3e,this['logger']=new core_1[(_0xf01150(0xe5))](SyncService_1[_0xf01150(0x121)]),this[_0xf01150(0x128)]={},this[_0xf01150(0xee)]=[];}async[a111_0x146b68(0xf3)](_0x474a38,_0x3aa4d4){const _0x1a90db=a111_0x146b68;if(_0x3aa4d4 instanceof git_branch_not_found_error_1['GitBranchNotFoundError']){await this[_0x1a90db(0x140)][_0x1a90db(0x130)](_0x474a38,'Not\x20Synchronized');return;}if(_0x3aa4d4 instanceof too_many_requests_error_1[_0x1a90db(0x10d)]){await this[_0x1a90db(0x140)][_0x1a90db(0x130)](_0x474a38,_0x1a90db(0xfa));throw _0x3aa4d4;}try{await this['sfLogger'][_0x1a90db(0x148)](this[_0x1a90db(0x137)]+_0x1a90db(0xe7)+_0x474a38[_0x1a90db(0x11a)]+'\x27\x20['+_0x474a38['branchName']+']\x20due\x20error\x20-\x20'+_0x3aa4d4+'.')[_0x1a90db(0x114)](),await this[_0x1a90db(0x140)][_0x1a90db(0x12f)](_0x474a38,{}),await this[_0x1a90db(0x140)][_0x1a90db(0x130)](_0x474a38,_0x1a90db(0xfc));}catch(_0x461543){if(_0x461543 instanceof salesforce_error_1[_0x1a90db(0xf8)])throw _0x461543;}}async[a111_0x146b68(0x110)](_0x178d02){const _0x3c2920=a111_0x146b68;if(_0x178d02[_0x3c2920(0x14a)]){const _0x3d805f=_0x178d02[_0x3c2920(0x11a)]['toLowerCase'](),_0x1531ce=this[_0x3c2920(0x128)][_0x3d805f];if(!_0x1531ce)this[_0x3c2920(0x128)][_0x3d805f]=_0x178d02[_0x3c2920(0x11a)];else{if(_0x1531ce&&_0x1531ce!==_0x178d02[_0x3c2920(0x11a)])return await this[_0x3c2920(0xf3)](_0x178d02,new Error(_0x3c2920(0x115)+_0x178d02[_0x3c2920(0x11a)]+_0x3c2920(0xeb)+_0x3d805f+'\x27\x20-\x20\x27'+_0x1531ce+'\x27')),!![];}}return![];}async[a111_0x146b68(0x12c)](_0x5ce576){const _0x6ca56d=a111_0x146b68;if(!constants_1[_0x6ca56d(0x142)]['test'](_0x5ce576['repositoryName']))return await this['handleRecordSyncError'](_0x5ce576,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x5ce576[_0x6ca56d(0x11a)]+_0x6ca56d(0xd5))),![];if(!constants_1[_0x6ca56d(0x13a)]['test'](_0x5ce576['branchName']))return await this[_0x6ca56d(0xf3)](_0x5ce576,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x5ce576[_0x6ca56d(0x138)]+'\x27\x20in\x20repository\x20\x27'+_0x5ce576[_0x6ca56d(0x11a)]+_0x6ca56d(0x107))),![];return!![];}async[a111_0x146b68(0xe2)](_0x532b11,_0x2fb794){const _0x4c79d4=a111_0x146b68;let _0x46c27a=this[_0x4c79d4(0xee)][_0x4c79d4(0x116)](_0x349186=>_0x532b11[_0x4c79d4(0x11a)]===_0x349186[_0x4c79d4(0x121)]);!_0x46c27a&&(this[_0x4c79d4(0xd7)]['log'](this[_0x4c79d4(0x137)]+'\x20Repository\x20\x22'+_0x532b11[_0x4c79d4(0x11a)]+_0x4c79d4(0xdf)),_0x46c27a=await this['repoService']['create']({'name':_0x532b11[_0x4c79d4(0x11a)],'autoInit':!![],'defaultBranch':_0x532b11['branchName'],'private':!![],'createHook':typedi_1[_0x4c79d4(0xda)][_0x4c79d4(0x13e)](providers_tokens_1[_0x4c79d4(0x124)]['config'])['isBidirectionalSynchronization']}));if(this[_0x4c79d4(0x131)][_0x4c79d4(0xea)]){const _0x5aacbc=await _0x46c27a['hooks'][_0x4c79d4(0x12e)]();!_0x5aacbc[_0x4c79d4(0x116)](_0x13ef31=>_0x13ef31['url']===hooks_utils_1[_0x4c79d4(0x127)][_0x4c79d4(0x139)](this[_0x4c79d4(0x131)]['gitProvider'],this[_0x4c79d4(0x131)][_0x4c79d4(0xd3)],_0x2fb794))&&(this[_0x4c79d4(0xd7)][_0x4c79d4(0x12d)](this[_0x4c79d4(0x137)]+'\x20Repository\x20\x22'+_0x532b11['repositoryName']+_0x4c79d4(0x146)),await _0x46c27a[_0x4c79d4(0xd0)][_0x4c79d4(0x10b)](hooks_utils_1[_0x4c79d4(0x127)][_0x4c79d4(0x13c)](this['config'][_0x4c79d4(0xec)],_0x46c27a['hooks'],this['config'][_0x4c79d4(0xd3)],_0x2fb794)));}return this[_0x4c79d4(0xee)]['push'](_0x46c27a),_0x46c27a;}async[a111_0x146b68(0x13d)](){const _0x1620a6=a111_0x146b68;this[_0x1620a6(0x108)]=typedi_1[_0x1620a6(0xda)][_0x1620a6(0x13e)](providers_tokens_1[_0x1620a6(0x124)][_0x1620a6(0x108)]),this[_0x1620a6(0x122)]=typedi_1[_0x1620a6(0xda)][_0x1620a6(0x13e)](providers_tokens_1['Tokens'][_0x1620a6(0x11c)]),this['config']=typedi_1[_0x1620a6(0xda)][_0x1620a6(0x13e)](providers_tokens_1[_0x1620a6(0x124)][_0x1620a6(0x131)]),this[_0x1620a6(0xd7)]=typedi_1[_0x1620a6(0xda)][_0x1620a6(0x13e)](providers_tokens_1[_0x1620a6(0x124)][_0x1620a6(0xf4)]),this[_0x1620a6(0x137)]='['+SyncService_1[_0x1620a6(0x121)]+_0x1620a6(0x111)+this[_0x1620a6(0x131)][_0x1620a6(0xec)][_0x1620a6(0x10e)]()+']',this[_0x1620a6(0xde)][_0x1620a6(0x10a)](this['sfLogger'][_0x1620a6(0xf0)]());try{this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this[_0x1620a6(0x137)]+_0x1620a6(0xef)),await this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this['prefix']+_0x1620a6(0x129))[_0x1620a6(0x114)]();const _0xdfef51=await this[_0x1620a6(0x140)][_0x1620a6(0xd9)](typedi_1[_0x1620a6(0xda)][_0x1620a6(0x13e)](providers_tokens_1[_0x1620a6(0x124)][_0x1620a6(0x125)]));if(!_0xdfef51[_0x1620a6(0x103)])throw new bad_request_error_1[(_0x1620a6(0x14b))](this['prefix']+'\x20No\x20repositories\x20to\x20sync.');await this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this['prefix']+_0x1620a6(0x102))[_0x1620a6(0x114)]();const _0x1f19a1=await this[_0x1620a6(0x140)]['getBranchRecords'](_0xdfef51['map'](_0x461cc0=>'\x27'+_0x461cc0['repositoryId']+'\x27')['join'](','));await this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this[_0x1620a6(0x137)]+_0x1620a6(0xf5))[_0x1620a6(0x114)](),this[_0x1620a6(0xee)]=await this[_0x1620a6(0x122)][_0x1620a6(0x12e)]();const _0x4f030b=[..._0xdfef51,..._0x1f19a1];this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this[_0x1620a6(0x137)]+_0x1620a6(0xf1)+_0x4f030b[_0x1620a6(0x103)]+'\x20branches.');for(const _0x4d845e of _0x4f030b){this[_0x1620a6(0xf4)]['log'](_0x1620a6(0x101)+_0x4d845e[_0x1620a6(0x11a)]+'['+_0x4d845e[_0x1620a6(0x14a)]+_0x1620a6(0x119)+_0x4d845e[_0x1620a6(0x138)]+'['+_0x4d845e['branchId']+_0x1620a6(0xd2)),this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this[_0x1620a6(0x137)]+_0x1620a6(0xe6)+_0x4d845e['repositoryName']+'\x22\x20branch:\x20\x22'+_0x4d845e['branchName']+'\x22.'),this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this[_0x1620a6(0x137)]+_0x1620a6(0x141));const _0x2f3d64=await this['checkValidNaming'](_0x4d845e);if(!_0x2f3d64)continue;this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this['prefix']+_0x1620a6(0xf7));const _0x3a6ed3=await this[_0x1620a6(0x110)](_0x4d845e);if(_0x3a6ed3)continue;await this[_0x1620a6(0xd7)]['send']();let _0x88c2c6;try{await this['sfLogger']['log'](this[_0x1620a6(0x137)]+_0x1620a6(0x123))[_0x1620a6(0x114)](),_0x88c2c6=await this[_0x1620a6(0xe2)](_0x4d845e,typedi_1[_0x1620a6(0xda)][_0x1620a6(0x13e)](providers_tokens_1['Tokens']['connectionId']));}catch(_0x1f1adf){await this[_0x1620a6(0xf3)](_0x4d845e,_0x1f1adf instanceof too_many_requests_error_1[_0x1620a6(0x10d)]?_0x1f1adf:new Error(_0x1620a6(0xf6)+_0x1f1adf));continue;}await this['sfLogger']['log'](this['prefix']+_0x1620a6(0x132))['send']();if(_0x4d845e[_0x1620a6(0x136)]===flosum_repository_sync_dto_1[_0x1620a6(0x120)][_0x1620a6(0xe0)]){const _0x5e30dd=typedi_1[_0x1620a6(0xda)][_0x1620a6(0x13e)](flosum_sync_job_1[_0x1620a6(0x13f)]);await _0x5e30dd['run']({'repository':_0x88c2c6,'convertToSFDX':this['config'][_0x1620a6(0xd4)],'syncRecord':_0x4d845e,'provider':this[_0x1620a6(0x131)]['gitProvider']})[_0x1620a6(0x12a)](_0x574a81=>this['handleRecordSyncError'](_0x4d845e,_0x574a81));}else{const _0x10e6ff=typedi_1[_0x1620a6(0xda)]['get'](git_sync_job_1[_0x1620a6(0x112)]);await _0x10e6ff[_0x1620a6(0x13d)]({'repository':_0x88c2c6,'branch':_0x4d845e[_0x1620a6(0x138)],'provider':this['config'][_0x1620a6(0xec)],'repositoryGit':_0x88c2c6[_0x1620a6(0xdd)],'syncRecord':_0x4d845e})[_0x1620a6(0x12a)](_0x1211fd=>this['handleRecordSyncError'](_0x4d845e,_0x1211fd));}}}catch(_0x1c30bd){this[_0x1620a6(0xf4)][_0x1620a6(0x148)](_0x1c30bd);_0x1c30bd instanceof too_many_requests_error_1['TooManyRequests']?(await this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this[_0x1620a6(0x137)]+_0x1620a6(0x145))[_0x1620a6(0x114)](),await(0x0,utils_1[_0x1620a6(0xfd)])(0x3c*0x3c*0x3e8),this[_0x1620a6(0x13d)]()):await this[_0x1620a6(0xd7)][_0x1620a6(0x148)](this[_0x1620a6(0x137)]+_0x1620a6(0xe1)+_0x1c30bd)['send']();return;}await this[_0x1620a6(0xd7)][_0x1620a6(0x12d)](this[_0x1620a6(0x137)]+_0x1620a6(0xd8))[_0x1620a6(0x114)](),await this[_0x1620a6(0x140)][_0x1620a6(0x143)](typedi_1['Container'][_0x1620a6(0x13e)](providers_tokens_1[_0x1620a6(0x124)][_0x1620a6(0x125)]))['catch'](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x146b68(0xe4)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a111_0x146b68(0xfe)],salesforce_sync_service_1['SalesforceSyncService']])],SyncService),exports[a111_0x146b68(0x104)]=SyncService;