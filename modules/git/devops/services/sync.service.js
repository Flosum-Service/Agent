function a111_0x32e5(_0x1b304c,_0x364538){const _0xf61da0=a111_0x5c25();return a111_0x32e5=function(_0x3613e7,_0x1b0df8){_0x3613e7=_0x3613e7-0x74;let _0x5c253c=_0xf61da0[_0x3613e7];return _0x5c253c;},a111_0x32e5(_0x1b304c,_0x364538);}const a111_0x3cdf99=a111_0x32e5;(function(_0xc86a6d,_0x4b5d5f){const _0x2b2ba4=a111_0x32e5,_0x4ee3ed=_0xc86a6d();while(!![]){try{const _0x5a59e4=parseInt(_0x2b2ba4(0xa5))/0x1+parseInt(_0x2b2ba4(0xc5))/0x2+parseInt(_0x2b2ba4(0xec))/0x3*(parseInt(_0x2b2ba4(0x95))/0x4)+-parseInt(_0x2b2ba4(0x7b))/0x5+-parseInt(_0x2b2ba4(0xcb))/0x6*(-parseInt(_0x2b2ba4(0x97))/0x7)+parseInt(_0x2b2ba4(0x9e))/0x8*(parseInt(_0x2b2ba4(0xc6))/0x9)+-parseInt(_0x2b2ba4(0x9c))/0xa;if(_0x5a59e4===_0x4b5d5f)break;else _0x4ee3ed['push'](_0x4ee3ed['shift']());}catch(_0x45369b){_0x4ee3ed['push'](_0x4ee3ed['shift']());}}}(a111_0x5c25,0x2358a));const a111_0x1b0df8=(function(){let _0x4383b9=!![];return function(_0x5a7d07,_0x5a4e46){const _0x3c3161=_0x4383b9?function(){const _0x17fcaf=a111_0x32e5;if(_0x5a4e46){const _0x1e30db=_0x5a4e46[_0x17fcaf(0xa2)](_0x5a7d07,arguments);return _0x5a4e46=null,_0x1e30db;}}:function(){};return _0x4383b9=![],_0x3c3161;};}()),a111_0x3613e7=a111_0x1b0df8(this,function(){const _0x121fbf=a111_0x32e5;return a111_0x3613e7[_0x121fbf(0xf4)]()[_0x121fbf(0xc8)](_0x121fbf(0xee))[_0x121fbf(0xf4)]()[_0x121fbf(0x90)](a111_0x3613e7)[_0x121fbf(0xc8)](_0x121fbf(0xee));});a111_0x3613e7();function a111_0x5c25(){const _0x2b8e64=['\x20Getting\x20Flosum\x20repository',']\x20due\x20error\x20-\x20','164Azuzif','config','179837LpljkG','applicationUrl','FlosumToGit','../../providers/web-hooks/hooks.utils','prefix','2085630TdzZqr','checkValidNaming','198296qWsGIg','../../providers/providers.tokens','Logger','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','apply','getBranchRecords','__decorate','33540TBGPOX','\x20Getting\x20repository\x20records.','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','toLowerCase',']\x20[','url','repoList','FlosumSyncJob','setStatus','getHookLinkFor','\x20Start\x20sync\x20job.','get','../../../shared/utils','updateRemoteState','BadRequestError','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','Unable\x20to\x20synchronize\x20branch\x20\x27','gitApiService','handleRecordSyncError','object','function','connectionId','branchName','SyncService','../../salesforce/services/salesforce-sync.service','\x20Stop\x20sync\x20job\x20for\x20\x27','find','typedi','__metadata','setLoggerId','repositoryName','repositoryId','110798snkSxn','90eEqHMm','decorate','search','\x20Syncing\x20repository:\x20\x22','HooksUtils','18vwkcnP','SalesforceSyncService','direction','\x20Checking\x20valid\x20name.','Not\x20Synchronized','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','Waiting','sleep','../../../../core/errors/bad-request.error','toUpperCase','test','\x20Getting\x20branch\x20records.','Error','getAll','name','salesforceService','getOrCreateRepo','sfLogger','\x20Checking\x20intersects.','isIntersects','\x27\x20[','REPOSITORY_NAME_REGEXP','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','defineProperty','disableSync','hooks','GitBranchNotFoundError','SalesforceService','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.',']\x20repository\x20','createHookPayload','\x20Getting\x20repositories\x20from\x20git\x20service.','\x22\x20branch:\x20\x22','3117xmwwty','isBidirectionalSynchronization','(((.+)+)+)+$','GitSyncJob','Unable\x20to\x20synchronize\x20repository\x20\x27','map','\x20Completed\x20prepare\x20to\x20syncing.','../../salesforce/services/salesforce.service','toString','log','\x27\x20-\x20\x27','logger','Tokens','length','TooManyRequests','push','catch','getRepositoryRecords','__esModule','SalesforceError','515700KSToxo','../../../../core/errors/too-many-requests.error','branchId','run','\x20Repository\x20\x22',']\x20branch.','Container','create','getOwnPropertyDescriptor','\x20Have\x20to\x20synchronize\x20','\x27\x20in\x20repository\x20\x27','send','gitProvider','salesforceSync','getLoggerId','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','\x20branches.','../jobs/git-sync.job','gitRepoService','error','repoService','constructor','metadata','repositoriesIntersections'];a111_0x5c25=function(){return _0x2b8e64;};return a111_0x5c25();}'use strict';var __decorate=this&&this[a111_0x3cdf99(0xa4)]||function(_0x32b54a,_0x1f80a2,_0x105f80,_0x1858b1){const _0x395eef=a111_0x3cdf99;var _0x59bbc7=arguments['length'],_0xde81eb=_0x59bbc7<0x3?_0x1f80a2:_0x1858b1===null?_0x1858b1=Object[_0x395eef(0x83)](_0x1f80a2,_0x105f80):_0x1858b1,_0x1c926a;if(typeof Reflect===_0x395eef(0xb8)&&typeof Reflect['decorate']===_0x395eef(0xb9))_0xde81eb=Reflect[_0x395eef(0xc7)](_0x32b54a,_0x1f80a2,_0x105f80,_0x1858b1);else{for(var _0x299b98=_0x32b54a[_0x395eef(0x74)]-0x1;_0x299b98>=0x0;_0x299b98--)if(_0x1c926a=_0x32b54a[_0x299b98])_0xde81eb=(_0x59bbc7<0x3?_0x1c926a(_0xde81eb):_0x59bbc7>0x3?_0x1c926a(_0x1f80a2,_0x105f80,_0xde81eb):_0x1c926a(_0x1f80a2,_0x105f80))||_0xde81eb;}return _0x59bbc7>0x3&&_0xde81eb&&Object[_0x395eef(0xe2)](_0x1f80a2,_0x105f80,_0xde81eb),_0xde81eb;},__metadata=this&&this[a111_0x3cdf99(0xc1)]||function(_0x4acc86,_0x2921bc){const _0x35f579=a111_0x3cdf99;if(typeof Reflect===_0x35f579(0xb8)&&typeof Reflect[_0x35f579(0x91)]===_0x35f579(0xb9))return Reflect['metadata'](_0x4acc86,_0x2921bc);},SyncService_1;Object['defineProperty'](exports,a111_0x3cdf99(0x79),{'value':!![]}),exports['SyncService']=void 0x0;const constants_1=require('../../../../constants'),core_1=require('../../../../core'),too_many_requests_error_1=require(a111_0x3cdf99(0x7c)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_sync_service_1=require(a111_0x3cdf99(0xbd)),salesforce_service_1=require(a111_0x3cdf99(0xf3)),utils_1=require(a111_0x3cdf99(0xb1)),typedi_1=require(a111_0x3cdf99(0xc0)),hooks_utils_1=require(a111_0x3cdf99(0x9a)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a111_0x3cdf99(0x8c)),providers_tokens_1=require(a111_0x3cdf99(0x9f)),bad_request_error_1=require(a111_0x3cdf99(0xd3));let SyncService=SyncService_1=class SyncService{constructor(_0x4f645d,_0x4c2fcc){const _0x57bd92=a111_0x3cdf99;this[_0x57bd92(0xda)]=_0x4f645d,this[_0x57bd92(0x88)]=_0x4c2fcc,this[_0x57bd92(0xf7)]=new core_1[(_0x57bd92(0xa0))](SyncService_1['name']),this[_0x57bd92(0x92)]={},this[_0x57bd92(0xab)]=[];}async[a111_0x3cdf99(0xb7)](_0x1a1605,_0x311a15){const _0x30f83d=a111_0x3cdf99;if(_0x311a15 instanceof git_branch_not_found_error_1[_0x30f83d(0xe5)]){await this[_0x30f83d(0x88)]['setStatus'](_0x1a1605,_0x30f83d(0xcf));return;}if(_0x311a15 instanceof too_many_requests_error_1[_0x30f83d(0x75)]){await this[_0x30f83d(0x88)][_0x30f83d(0xad)](_0x1a1605,_0x30f83d(0xd1));throw _0x311a15;}try{await this[_0x30f83d(0xdc)]['error'](this[_0x30f83d(0x9b)]+_0x30f83d(0xbe)+_0x1a1605[_0x30f83d(0xc3)]+_0x30f83d(0xdf)+_0x1a1605['branchName']+_0x30f83d(0x94)+_0x311a15+'.')[_0x30f83d(0x86)](),await this[_0x30f83d(0x88)][_0x30f83d(0xb2)](_0x1a1605,{}),await this[_0x30f83d(0x88)][_0x30f83d(0xad)](_0x1a1605,_0x30f83d(0xd7));}catch(_0x59da67){if(_0x59da67 instanceof salesforce_error_1[_0x30f83d(0x7a)])throw _0x59da67;}}async[a111_0x3cdf99(0xde)](_0x4dd8fe){const _0x51a92f=a111_0x3cdf99;if(_0x4dd8fe[_0x51a92f(0xc4)]){const _0x13ae9a=_0x4dd8fe['repositoryName'][_0x51a92f(0xa8)](),_0x5be4d1=this[_0x51a92f(0x92)][_0x13ae9a];if(!_0x5be4d1)this[_0x51a92f(0x92)][_0x13ae9a]=_0x4dd8fe[_0x51a92f(0xc3)];else{if(_0x5be4d1&&_0x5be4d1!==_0x4dd8fe[_0x51a92f(0xc3)])return await this[_0x51a92f(0xb7)](_0x4dd8fe,new Error(_0x51a92f(0xf0)+_0x4dd8fe['repositoryName']+_0x51a92f(0x8a)+_0x13ae9a+_0x51a92f(0xf6)+_0x5be4d1+'\x27')),!![];}}return![];}async[a111_0x3cdf99(0x9d)](_0x3a0939){const _0x1355fb=a111_0x3cdf99;if(!constants_1[_0x1355fb(0xe0)][_0x1355fb(0xd5)](_0x3a0939['repositoryName']))return await this[_0x1355fb(0xb7)](_0x3a0939,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x3a0939[_0x1355fb(0xc3)]+_0x1355fb(0xe7))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x1355fb(0xd5)](_0x3a0939[_0x1355fb(0xbb)]))return await this[_0x1355fb(0xb7)](_0x3a0939,new Error(_0x1355fb(0xb5)+_0x3a0939['branchName']+_0x1355fb(0x85)+_0x3a0939['repositoryName']+_0x1355fb(0xb4))),![];return!![];}async[a111_0x3cdf99(0xdb)](_0x31097e,_0x20f808){const _0x49098d=a111_0x3cdf99;let _0xce1260=this[_0x49098d(0xab)][_0x49098d(0xbf)](_0x319361=>_0x31097e[_0x49098d(0xc3)]===_0x319361[_0x49098d(0xd9)]);!_0xce1260&&(this['sfLogger'][_0x49098d(0xf5)](this[_0x49098d(0x9b)]+'\x20Repository\x20\x22'+_0x31097e['repositoryName']+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0xce1260=await this['repoService'][_0x49098d(0x82)]({'name':_0x31097e['repositoryName'],'autoInit':!![],'defaultBranch':_0x31097e['branchName'],'private':!![],'createHook':typedi_1['Container']['get'](providers_tokens_1[_0x49098d(0xf8)][_0x49098d(0x96)])[_0x49098d(0xed)]}));if(this[_0x49098d(0x96)][_0x49098d(0xed)]){const _0x3ad2b1=await _0xce1260[_0x49098d(0xe4)][_0x49098d(0xd8)]();!_0x3ad2b1[_0x49098d(0xbf)](_0x4d5a31=>_0x4d5a31[_0x49098d(0xaa)]===hooks_utils_1[_0x49098d(0xca)][_0x49098d(0xae)](this['config'][_0x49098d(0x87)],this[_0x49098d(0x96)]['applicationUrl'],_0x20f808))&&(this[_0x49098d(0xdc)][_0x49098d(0xf5)](this[_0x49098d(0x9b)]+_0x49098d(0x7f)+_0x31097e[_0x49098d(0xc3)]+_0x49098d(0xa7)),await _0xce1260['hooks'][_0x49098d(0x82)](hooks_utils_1[_0x49098d(0xca)][_0x49098d(0xe9)](this[_0x49098d(0x96)][_0x49098d(0x87)],_0xce1260[_0x49098d(0xe4)],this[_0x49098d(0x96)][_0x49098d(0x98)],_0x20f808)));}return this[_0x49098d(0xab)][_0x49098d(0x76)](_0xce1260),_0xce1260;}async[a111_0x3cdf99(0x7e)](){const _0xa521a9=a111_0x3cdf99;this[_0xa521a9(0xb6)]=typedi_1['Container'][_0xa521a9(0xb0)](providers_tokens_1['Tokens']['gitApiService']),this['repoService']=typedi_1['Container']['get'](providers_tokens_1[_0xa521a9(0xf8)][_0xa521a9(0x8d)]),this['config']=typedi_1[_0xa521a9(0x81)][_0xa521a9(0xb0)](providers_tokens_1[_0xa521a9(0xf8)]['config']),this[_0xa521a9(0xdc)]=typedi_1[_0xa521a9(0x81)]['get'](providers_tokens_1[_0xa521a9(0xf8)][_0xa521a9(0xf7)]),this[_0xa521a9(0x9b)]='['+SyncService_1[_0xa521a9(0xd9)]+_0xa521a9(0xa9)+this[_0xa521a9(0x96)][_0xa521a9(0x87)][_0xa521a9(0xd4)]()+']',this[_0xa521a9(0xda)][_0xa521a9(0xc2)](this['sfLogger'][_0xa521a9(0x89)]());try{this['sfLogger']['log'](this[_0xa521a9(0x9b)]+_0xa521a9(0xaf)),await this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this[_0xa521a9(0x9b)]+_0xa521a9(0xa6))[_0xa521a9(0x86)]();const _0x206e7c=await this['salesforceSync'][_0xa521a9(0x78)](typedi_1[_0xa521a9(0x81)][_0xa521a9(0xb0)](providers_tokens_1[_0xa521a9(0xf8)]['connectionId']));if(!_0x206e7c[_0xa521a9(0x74)])throw new bad_request_error_1[(_0xa521a9(0xb3))](this[_0xa521a9(0x9b)]+'\x20No\x20repositories\x20to\x20sync.');await this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this[_0xa521a9(0x9b)]+_0xa521a9(0xd6))[_0xa521a9(0x86)]();const _0x437576=await this[_0xa521a9(0x88)][_0xa521a9(0xa3)](_0x206e7c[_0xa521a9(0xf1)](_0x789e4a=>'\x27'+_0x789e4a['repositoryId']+'\x27')['join'](','));await this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this['prefix']+_0xa521a9(0xea))[_0xa521a9(0x86)](),this['repoList']=await this[_0xa521a9(0x8f)][_0xa521a9(0xd8)]();const _0xe48254=[..._0x206e7c,..._0x437576];this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this[_0xa521a9(0x9b)]+_0xa521a9(0x84)+_0xe48254['length']+_0xa521a9(0x8b));for(const _0x1d7eca of _0xe48254){this[_0xa521a9(0xf7)][_0xa521a9(0xf5)]('Syncing\x20'+_0x1d7eca[_0xa521a9(0xc3)]+'['+_0x1d7eca[_0xa521a9(0xc4)]+_0xa521a9(0xe8)+_0x1d7eca[_0xa521a9(0xbb)]+'['+_0x1d7eca[_0xa521a9(0x7d)]+_0xa521a9(0x80)),this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this['prefix']+_0xa521a9(0xc9)+_0x1d7eca['repositoryName']+_0xa521a9(0xeb)+_0x1d7eca[_0xa521a9(0xbb)]+'\x22.'),this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this[_0xa521a9(0x9b)]+_0xa521a9(0xce));const _0x3beffe=await this['checkValidNaming'](_0x1d7eca);if(!_0x3beffe)continue;this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this['prefix']+_0xa521a9(0xdd));const _0x20cd87=await this['isIntersects'](_0x1d7eca);if(_0x20cd87)continue;await this[_0xa521a9(0xdc)][_0xa521a9(0x86)]();let _0xe21c5d;try{await this['sfLogger'][_0xa521a9(0xf5)](this['prefix']+_0xa521a9(0x93))[_0xa521a9(0x86)](),_0xe21c5d=await this[_0xa521a9(0xdb)](_0x1d7eca,typedi_1[_0xa521a9(0x81)][_0xa521a9(0xb0)](providers_tokens_1['Tokens'][_0xa521a9(0xba)]));}catch(_0x50ad98){await this['handleRecordSyncError'](_0x1d7eca,_0x50ad98 instanceof too_many_requests_error_1['TooManyRequests']?_0x50ad98:new Error(_0xa521a9(0xe1)+_0x50ad98));continue;}await this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this[_0xa521a9(0x9b)]+_0xa521a9(0xf2))[_0xa521a9(0x86)]();if(_0x1d7eca[_0xa521a9(0xcd)]===flosum_repository_sync_dto_1['SyncDirection'][_0xa521a9(0x99)]){const _0x219abc=typedi_1[_0xa521a9(0x81)][_0xa521a9(0xb0)](flosum_sync_job_1[_0xa521a9(0xac)]);await _0x219abc[_0xa521a9(0x7e)]({'repository':_0xe21c5d,'convertToSFDX':this[_0xa521a9(0x96)]['isConvertToSfdx'],'syncRecord':_0x1d7eca,'provider':this[_0xa521a9(0x96)][_0xa521a9(0x87)]})[_0xa521a9(0x77)](_0x4ad6b5=>this['handleRecordSyncError'](_0x1d7eca,_0x4ad6b5));}else{const _0x4cda36=typedi_1[_0xa521a9(0x81)][_0xa521a9(0xb0)](git_sync_job_1[_0xa521a9(0xef)]);await _0x4cda36[_0xa521a9(0x7e)]({'repository':_0xe21c5d,'branch':_0x1d7eca[_0xa521a9(0xbb)],'provider':this['config']['gitProvider'],'repositoryGit':_0xe21c5d['gitUrl'],'syncRecord':_0x1d7eca})[_0xa521a9(0x77)](_0x137772=>this[_0xa521a9(0xb7)](_0x1d7eca,_0x137772));}}}catch(_0x2c5d43){this[_0xa521a9(0xf7)][_0xa521a9(0x8e)](_0x2c5d43);_0x2c5d43 instanceof too_many_requests_error_1[_0xa521a9(0x75)]?(await this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this[_0xa521a9(0x9b)]+_0xa521a9(0xd0))[_0xa521a9(0x86)](),await(0x0,utils_1[_0xa521a9(0xd2)])(0x3c*0x3c*0x3e8),this[_0xa521a9(0x7e)]()):await this[_0xa521a9(0xdc)][_0xa521a9(0x8e)](this[_0xa521a9(0x9b)]+_0xa521a9(0xa1)+_0x2c5d43)[_0xa521a9(0x86)]();return;}await this[_0xa521a9(0xdc)][_0xa521a9(0xf5)](this[_0xa521a9(0x9b)]+'\x20Sync\x20job\x20done.')[_0xa521a9(0x86)](),await this[_0xa521a9(0x88)][_0xa521a9(0xe3)](typedi_1[_0xa521a9(0x81)][_0xa521a9(0xb0)](providers_tokens_1[_0xa521a9(0xf8)][_0xa521a9(0xba)]))[_0xa521a9(0x77)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a111_0x3cdf99(0xe6)],salesforce_sync_service_1[a111_0x3cdf99(0xcc)]])],SyncService),exports[a111_0x3cdf99(0xbc)]=SyncService;