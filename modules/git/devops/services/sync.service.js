const a111_0x25f926=a111_0x3d1f;(function(_0x2d2d2c,_0x5695ff){const _0xae11f7=a111_0x3d1f,_0x40232d=_0x2d2d2c();while(!![]){try{const _0x3a8429=parseInt(_0xae11f7(0xf8))/0x1*(parseInt(_0xae11f7(0x11d))/0x2)+parseInt(_0xae11f7(0xec))/0x3*(-parseInt(_0xae11f7(0xdf))/0x4)+parseInt(_0xae11f7(0x154))/0x5*(-parseInt(_0xae11f7(0x122))/0x6)+-parseInt(_0xae11f7(0xe9))/0x7*(parseInt(_0xae11f7(0x15e))/0x8)+-parseInt(_0xae11f7(0x119))/0x9+-parseInt(_0xae11f7(0x108))/0xa+parseInt(_0xae11f7(0xf2))/0xb*(parseInt(_0xae11f7(0x152))/0xc);if(_0x3a8429===_0x5695ff)break;else _0x40232d['push'](_0x40232d['shift']());}catch(_0x473930){_0x40232d['push'](_0x40232d['shift']());}}}(a111_0x4888,0x98841));function a111_0x4888(){const _0x313b2c=['prefix','getLoggerId','search','\x20No\x20repositories\x20to\x20sync.','FlosumToGit','19770672zmrYzG','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','2935dOAZMn','(((.+)+)+)+$','SyncDirection','metadata','handleRecordSyncError','GitBranchNotFoundError','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x20Syncing\x20repository:\x20\x22',']\x20repository\x20','TooManyRequests','184CLEYLk','\x20Have\x20to\x20synchronize\x20','Container','__metadata','Unable\x20to\x20synchronize\x20repository\x20\x27','catch','../../../../core/errors/too-many-requests.error','../errors/git-branch-not-found.error','../../../../core/errors/bad-request.error','repoService','32MUqpml','\x20branches.','map','hooks','setLoggerId','isBidirectionalSynchronization','Not\x20Synchronized','Tokens','log','__decorate','246498coIiQK','\x20Stop\x20sync\x20job\x20for\x20\x27','Unable\x20to\x20synchronize\x20branch\x20\x27','61059gXHSgm','isIntersects','../../../shared/utils','toString','../jobs/flosum-sync.job','\x27\x20[','22zCLolF','../../../../core','find','\x27\x20in\x20repository\x20\x27','Syncing\x20','Waiting','76449lRGNge','\x20Repository\x20\x22','../../salesforce/errors/salesforce.error','repositoryId','\x20Completed\x20prepare\x20to\x20syncing.','../../providers/providers.tokens','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','\x20Getting\x20Flosum\x20repository','getAll','__esModule','../../../../constants','branchName','design:paramtypes','test','direction','error','7897460CnbOlg','createHookPayload','get','getOwnPropertyDescriptor','send','connectionId','defineProperty','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','\x20Sync\x20job\x20done.',']\x20due\x20error\x20-\x20','function','create','setStatus','\x20Checking\x20intersects.','\x27\x20-\x20\x27','salesforceService','gitApiService','6392115bfjYPL','sleep','branchId','\x22\x20branch:\x20\x22','2WLVDQR','FlosumSyncJob','disableSync','typedi','BadRequestError','2802wwjHBk','gitUrl','Service','updateRemoteState','repositoryName','gitRepoService','join','checkValidNaming','object','run','logger','getOrCreateRepo','toUpperCase','sfLogger','SalesforceSyncService','push','\x20Start\x20sync\x20job.','applicationUrl','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.','decorate','constructor','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','Error','getHookLinkFor','repositoriesIntersections','getBranchRecords','\x20Getting\x20repositories\x20from\x20git\x20service.','salesforceSync','repoList','url','config','\x20Checking\x20valid\x20name.','length','SyncService','../../salesforce/dto/flosum-repository-sync.dto','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','../../salesforce/services/salesforce.service','../jobs/git-sync.job','SalesforceError','gitProvider','BRANCH_NAME_REGEXP','HooksUtils','name'];a111_0x4888=function(){return _0x313b2c;};return a111_0x4888();}const a111_0x3977b1=(function(){let _0x34c6c4=!![];return function(_0x4d3681,_0x2377ac){const _0x524e2f=_0x34c6c4?function(){if(_0x2377ac){const _0x55114e=_0x2377ac['apply'](_0x4d3681,arguments);return _0x2377ac=null,_0x55114e;}}:function(){};return _0x34c6c4=![],_0x524e2f;};}()),a111_0x378b3f=a111_0x3977b1(this,function(){const _0x4d431a=a111_0x3d1f;return a111_0x378b3f['toString']()[_0x4d431a(0x14f)](_0x4d431a(0x155))[_0x4d431a(0xef)]()[_0x4d431a(0x136)](a111_0x378b3f)[_0x4d431a(0x14f)]('(((.+)+)+)+$');});a111_0x378b3f();'use strict';var __decorate=this&&this[a111_0x25f926(0xe8)]||function(_0x33186e,_0x258faa,_0x1a4b4b,_0x4458b3){const _0x10bb8b=a111_0x25f926;var _0x268754=arguments['length'],_0x1533db=_0x268754<0x3?_0x258faa:_0x4458b3===null?_0x4458b3=Object[_0x10bb8b(0x10b)](_0x258faa,_0x1a4b4b):_0x4458b3,_0x14fef2;if(typeof Reflect===_0x10bb8b(0x12a)&&typeof Reflect['decorate']===_0x10bb8b(0x112))_0x1533db=Reflect[_0x10bb8b(0x135)](_0x33186e,_0x258faa,_0x1a4b4b,_0x4458b3);else{for(var _0x253ee7=_0x33186e[_0x10bb8b(0x142)]-0x1;_0x253ee7>=0x0;_0x253ee7--)if(_0x14fef2=_0x33186e[_0x253ee7])_0x1533db=(_0x268754<0x3?_0x14fef2(_0x1533db):_0x268754>0x3?_0x14fef2(_0x258faa,_0x1a4b4b,_0x1533db):_0x14fef2(_0x258faa,_0x1a4b4b))||_0x1533db;}return _0x268754>0x3&&_0x1533db&&Object[_0x10bb8b(0x10e)](_0x258faa,_0x1a4b4b,_0x1533db),_0x1533db;},__metadata=this&&this[a111_0x25f926(0x161)]||function(_0x21e26c,_0x1fc76f){const _0x33b5da=a111_0x25f926;if(typeof Reflect===_0x33b5da(0x12a)&&typeof Reflect[_0x33b5da(0x157)]==='function')return Reflect[_0x33b5da(0x157)](_0x21e26c,_0x1fc76f);},SyncService_1;Object['defineProperty'](exports,a111_0x25f926(0x101),{'value':!![]}),exports[a111_0x25f926(0x143)]=void 0x0;const constants_1=require(a111_0x25f926(0x102)),core_1=require(a111_0x25f926(0xf3)),too_many_requests_error_1=require(a111_0x25f926(0x164)),flosum_repository_sync_dto_1=require(a111_0x25f926(0x144)),salesforce_error_1=require(a111_0x25f926(0xfa)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a111_0x25f926(0x146)),utils_1=require(a111_0x25f926(0xee)),typedi_1=require(a111_0x25f926(0x120)),hooks_utils_1=require('../../providers/web-hooks/hooks.utils'),git_branch_not_found_error_1=require(a111_0x25f926(0x165)),flosum_sync_job_1=require(a111_0x25f926(0xf0)),git_sync_job_1=require(a111_0x25f926(0x147)),providers_tokens_1=require(a111_0x25f926(0xfd)),bad_request_error_1=require(a111_0x25f926(0x166));function a111_0x3d1f(_0x56c7b4,_0x14bace){const _0x398eb9=a111_0x4888();return a111_0x3d1f=function(_0x378b3f,_0x3977b1){_0x378b3f=_0x378b3f-0xde;let _0x4888ee=_0x398eb9[_0x378b3f];return _0x4888ee;},a111_0x3d1f(_0x56c7b4,_0x14bace);}let SyncService=SyncService_1=class SyncService{constructor(_0x2a7227,_0x122a61){const _0x2a5935=a111_0x25f926;this['salesforceService']=_0x2a7227,this['salesforceSync']=_0x122a61,this[_0x2a5935(0x12c)]=new core_1['Logger'](SyncService_1['name']),this[_0x2a5935(0x13a)]={},this['repoList']=[];}async[a111_0x25f926(0x158)](_0x58a716,_0x129802){const _0x1b4f7a=a111_0x25f926;if(_0x129802 instanceof git_branch_not_found_error_1[_0x1b4f7a(0x159)]){await this[_0x1b4f7a(0x13d)][_0x1b4f7a(0x114)](_0x58a716,_0x1b4f7a(0xe5));return;}if(_0x129802 instanceof too_many_requests_error_1[_0x1b4f7a(0x15d)]){await this[_0x1b4f7a(0x13d)][_0x1b4f7a(0x114)](_0x58a716,_0x1b4f7a(0xf7));throw _0x129802;}try{await this['sfLogger'][_0x1b4f7a(0x107)](this[_0x1b4f7a(0x14d)]+_0x1b4f7a(0xea)+_0x58a716[_0x1b4f7a(0x126)]+_0x1b4f7a(0xf1)+_0x58a716[_0x1b4f7a(0x103)]+_0x1b4f7a(0x111)+_0x129802+'.')[_0x1b4f7a(0x10c)](),await this[_0x1b4f7a(0x13d)][_0x1b4f7a(0x125)](_0x58a716,{}),await this[_0x1b4f7a(0x13d)][_0x1b4f7a(0x114)](_0x58a716,_0x1b4f7a(0x138));}catch(_0xc336f6){if(_0xc336f6 instanceof salesforce_error_1[_0x1b4f7a(0x148)])throw _0xc336f6;}}async[a111_0x25f926(0xed)](_0x1d9f5d){const _0x44891e=a111_0x25f926;if(_0x1d9f5d[_0x44891e(0xfb)]){const _0x342908=_0x1d9f5d[_0x44891e(0x126)]['toLowerCase'](),_0x3b0a56=this[_0x44891e(0x13a)][_0x342908];if(!_0x3b0a56)this['repositoriesIntersections'][_0x342908]=_0x1d9f5d[_0x44891e(0x126)];else{if(_0x3b0a56&&_0x3b0a56!==_0x1d9f5d['repositoryName'])return await this[_0x44891e(0x158)](_0x1d9f5d,new Error(_0x44891e(0x162)+_0x1d9f5d[_0x44891e(0x126)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x342908+_0x44891e(0x116)+_0x3b0a56+'\x27')),!![];}}return![];}async[a111_0x25f926(0x129)](_0x11f574){const _0x3a853d=a111_0x25f926;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x3a853d(0x105)](_0x11f574[_0x3a853d(0x126)]))return await this['handleRecordSyncError'](_0x11f574,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x11f574[_0x3a853d(0x126)]+_0x3a853d(0x137))),![];if(!constants_1[_0x3a853d(0x14a)][_0x3a853d(0x105)](_0x11f574[_0x3a853d(0x103)]))return await this[_0x3a853d(0x158)](_0x11f574,new Error(_0x3a853d(0xeb)+_0x11f574[_0x3a853d(0x103)]+_0x3a853d(0xf5)+_0x11f574[_0x3a853d(0x126)]+_0x3a853d(0x15a))),![];return!![];}async[a111_0x25f926(0x12d)](_0x3e569a,_0x560228){const _0x95c4d3=a111_0x25f926;let _0x4b7d58=this[_0x95c4d3(0x13e)][_0x95c4d3(0xf4)](_0x15ed2e=>_0x3e569a[_0x95c4d3(0x126)]===_0x15ed2e[_0x95c4d3(0x14c)]);!_0x4b7d58&&(this[_0x95c4d3(0x12f)][_0x95c4d3(0xe7)](this['prefix']+'\x20Repository\x20\x22'+_0x3e569a[_0x95c4d3(0x126)]+_0x95c4d3(0xfe)),_0x4b7d58=await this['repoService'][_0x95c4d3(0x113)]({'name':_0x3e569a['repositoryName'],'autoInit':!![],'defaultBranch':_0x3e569a[_0x95c4d3(0x103)],'private':!![],'createHook':typedi_1[_0x95c4d3(0x160)][_0x95c4d3(0x10a)](providers_tokens_1['Tokens']['config'])[_0x95c4d3(0xe4)]}));if(this[_0x95c4d3(0x140)][_0x95c4d3(0xe4)]){const _0x387f10=await _0x4b7d58[_0x95c4d3(0xe2)][_0x95c4d3(0x100)]();!_0x387f10[_0x95c4d3(0xf4)](_0x9334ff=>_0x9334ff[_0x95c4d3(0x13f)]===hooks_utils_1[_0x95c4d3(0x14b)][_0x95c4d3(0x139)](this['config']['gitProvider'],this[_0x95c4d3(0x140)][_0x95c4d3(0x133)],_0x560228))&&(this['sfLogger'][_0x95c4d3(0xe7)](this[_0x95c4d3(0x14d)]+_0x95c4d3(0xf9)+_0x3e569a[_0x95c4d3(0x126)]+_0x95c4d3(0x134)),await _0x4b7d58[_0x95c4d3(0xe2)][_0x95c4d3(0x113)](hooks_utils_1[_0x95c4d3(0x14b)][_0x95c4d3(0x109)](this[_0x95c4d3(0x140)]['gitProvider'],_0x4b7d58[_0x95c4d3(0xe2)],this[_0x95c4d3(0x140)][_0x95c4d3(0x133)],_0x560228)));}return this[_0x95c4d3(0x13e)][_0x95c4d3(0x131)](_0x4b7d58),_0x4b7d58;}async[a111_0x25f926(0x12b)](){const _0x38d72a=a111_0x25f926;this[_0x38d72a(0x118)]=typedi_1['Container'][_0x38d72a(0x10a)](providers_tokens_1[_0x38d72a(0xe6)][_0x38d72a(0x118)]),this[_0x38d72a(0xde)]=typedi_1[_0x38d72a(0x160)][_0x38d72a(0x10a)](providers_tokens_1['Tokens'][_0x38d72a(0x127)]),this[_0x38d72a(0x140)]=typedi_1[_0x38d72a(0x160)][_0x38d72a(0x10a)](providers_tokens_1['Tokens']['config']),this[_0x38d72a(0x12f)]=typedi_1[_0x38d72a(0x160)][_0x38d72a(0x10a)](providers_tokens_1[_0x38d72a(0xe6)][_0x38d72a(0x12c)]),this['prefix']='['+SyncService_1[_0x38d72a(0x14c)]+']\x20['+this['config'][_0x38d72a(0x149)][_0x38d72a(0x12e)]()+']',this[_0x38d72a(0x117)][_0x38d72a(0xe3)](this[_0x38d72a(0x12f)][_0x38d72a(0x14e)]());try{this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+_0x38d72a(0x132)),await this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+'\x20Getting\x20repository\x20records.')[_0x38d72a(0x10c)]();const _0x565d1a=await this[_0x38d72a(0x13d)]['getRepositoryRecords'](typedi_1[_0x38d72a(0x160)]['get'](providers_tokens_1[_0x38d72a(0xe6)][_0x38d72a(0x10d)]));if(!_0x565d1a[_0x38d72a(0x142)])throw new bad_request_error_1[(_0x38d72a(0x121))](this[_0x38d72a(0x14d)]+_0x38d72a(0x150));await this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this['prefix']+'\x20Getting\x20branch\x20records.')[_0x38d72a(0x10c)]();const _0x1a1df1=await this[_0x38d72a(0x13d)][_0x38d72a(0x13b)](_0x565d1a[_0x38d72a(0xe1)](_0x137346=>'\x27'+_0x137346[_0x38d72a(0xfb)]+'\x27')[_0x38d72a(0x128)](','));await this['sfLogger'][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+_0x38d72a(0x13c))[_0x38d72a(0x10c)](),this['repoList']=await this[_0x38d72a(0xde)][_0x38d72a(0x100)]();const _0x75fd=[..._0x565d1a,..._0x1a1df1];this['sfLogger'][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+_0x38d72a(0x15f)+_0x75fd['length']+_0x38d72a(0xe0));for(const _0x3ce690 of _0x75fd){this[_0x38d72a(0x12c)][_0x38d72a(0xe7)](_0x38d72a(0xf6)+_0x3ce690[_0x38d72a(0x126)]+'['+_0x3ce690[_0x38d72a(0xfb)]+_0x38d72a(0x15c)+_0x3ce690[_0x38d72a(0x103)]+'['+_0x3ce690[_0x38d72a(0x11b)]+']\x20branch.'),this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+_0x38d72a(0x15b)+_0x3ce690[_0x38d72a(0x126)]+_0x38d72a(0x11c)+_0x3ce690['branchName']+'\x22.'),this[_0x38d72a(0x12f)]['log'](this[_0x38d72a(0x14d)]+_0x38d72a(0x141));const _0x26c4cf=await this[_0x38d72a(0x129)](_0x3ce690);if(!_0x26c4cf)continue;this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this['prefix']+_0x38d72a(0x115));const _0xaa4278=await this[_0x38d72a(0xed)](_0x3ce690);if(_0xaa4278)continue;await this[_0x38d72a(0x12f)][_0x38d72a(0x10c)]();let _0x11ac9a;try{await this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+_0x38d72a(0xff))[_0x38d72a(0x10c)](),_0x11ac9a=await this[_0x38d72a(0x12d)](_0x3ce690,typedi_1[_0x38d72a(0x160)][_0x38d72a(0x10a)](providers_tokens_1['Tokens']['connectionId']));}catch(_0x5cc000){await this[_0x38d72a(0x158)](_0x3ce690,_0x5cc000 instanceof too_many_requests_error_1[_0x38d72a(0x15d)]?_0x5cc000:new Error(_0x38d72a(0x145)+_0x5cc000));continue;}await this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+_0x38d72a(0xfc))['send']();if(_0x3ce690[_0x38d72a(0x106)]===flosum_repository_sync_dto_1[_0x38d72a(0x156)][_0x38d72a(0x151)]){const _0xf2c81d=typedi_1['Container'][_0x38d72a(0x10a)](flosum_sync_job_1[_0x38d72a(0x11e)]);await _0xf2c81d[_0x38d72a(0x12b)]({'repository':_0x11ac9a,'convertToSFDX':this['config']['isConvertToSfdx'],'syncRecord':_0x3ce690,'provider':this['config'][_0x38d72a(0x149)]})['catch'](_0x886579=>this['handleRecordSyncError'](_0x3ce690,_0x886579));}else{const _0x2a6b17=typedi_1[_0x38d72a(0x160)]['get'](git_sync_job_1['GitSyncJob']);await _0x2a6b17[_0x38d72a(0x12b)]({'repository':_0x11ac9a,'branch':_0x3ce690[_0x38d72a(0x103)],'provider':this['config'][_0x38d72a(0x149)],'repositoryGit':_0x11ac9a[_0x38d72a(0x123)],'syncRecord':_0x3ce690})['catch'](_0x98c9c5=>this['handleRecordSyncError'](_0x3ce690,_0x98c9c5));}}}catch(_0x43caf8){this['logger'][_0x38d72a(0x107)](_0x43caf8);_0x43caf8 instanceof too_many_requests_error_1[_0x38d72a(0x15d)]?(await this[_0x38d72a(0x12f)]['log'](this[_0x38d72a(0x14d)]+_0x38d72a(0x153))['send'](),await(0x0,utils_1[_0x38d72a(0x11a)])(0x3c*0x3c*0x3e8),this[_0x38d72a(0x12b)]()):await this[_0x38d72a(0x12f)][_0x38d72a(0x107)](this[_0x38d72a(0x14d)]+_0x38d72a(0x10f)+_0x43caf8)[_0x38d72a(0x10c)]();return;}await this[_0x38d72a(0x12f)][_0x38d72a(0xe7)](this[_0x38d72a(0x14d)]+_0x38d72a(0x110))['send'](),await this[_0x38d72a(0x13d)][_0x38d72a(0x11f)](typedi_1[_0x38d72a(0x160)][_0x38d72a(0x10a)](providers_tokens_1[_0x38d72a(0xe6)][_0x38d72a(0x10d)]))[_0x38d72a(0x163)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a111_0x25f926(0x124)])({'transient':!![]}),__metadata(a111_0x25f926(0x104),[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a111_0x25f926(0x130)]])],SyncService),exports['SyncService']=SyncService;