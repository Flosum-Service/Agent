const a128_0x556ee8=a128_0x4a0f;(function(_0xa99f2f,_0xd99caf){const _0x38abe9=a128_0x4a0f,_0xd5f337=_0xa99f2f();while(!![]){try{const _0x5e6c7b=parseInt(_0x38abe9(0x1af))/0x1*(parseInt(_0x38abe9(0x191))/0x2)+parseInt(_0x38abe9(0x1d5))/0x3+parseInt(_0x38abe9(0x190))/0x4*(parseInt(_0x38abe9(0x1e7))/0x5)+-parseInt(_0x38abe9(0x19c))/0x6*(parseInt(_0x38abe9(0x1c5))/0x7)+parseInt(_0x38abe9(0x18b))/0x8*(parseInt(_0x38abe9(0x1f8))/0x9)+parseInt(_0x38abe9(0x1e0))/0xa*(parseInt(_0x38abe9(0x1ce))/0xb)+-parseInt(_0x38abe9(0x18a))/0xc*(parseInt(_0x38abe9(0x198))/0xd);if(_0x5e6c7b===_0xd99caf)break;else _0xd5f337['push'](_0xd5f337['shift']());}catch(_0x33b83b){_0xd5f337['push'](_0xd5f337['shift']());}}}(a128_0x5373,0xab58c));function a128_0x4a0f(_0x2a529b,_0x5212ea){const _0x57b1f2=a128_0x5373();return a128_0x4a0f=function(_0x20784a,_0x301a35){_0x20784a=_0x20784a-0x181;let _0x5373ae=_0x57b1f2[_0x20784a];return _0x5373ae;},a128_0x4a0f(_0x2a529b,_0x5212ea);}function a128_0x5373(){const _0x344198=['getAll','getHookLinkFor','typedi','apply','toString','\x20Getting\x20Flosum\x20repository','\x20branches.','\x20Checking\x20intersects.','send','(((.+)+)+)+$','SyncService','error','toUpperCase','isIntersects','\x20Getting\x20branch\x20records.','get','function','salesforceService','29PKJFHV','Unable\x20to\x20synchronize\x20branch\x20\x27','map','SyncDirection','connectionId','../../../shared/utils',']\x20branch.','metadata',']\x20[','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','find','GitBranchNotFoundError','../jobs/flosum-sync.job','log','handleRecordSyncError','test','gitProvider','setStatus','\x20Have\x20to\x20synchronize\x20','../../../../core','Unable\x20to\x20synchronize\x20repository\x20\x27','isBidirectionalSynchronization','299110ItPsvH','constructor','object','salesforceSync','SalesforceSyncService','\x27\x20-\x20\x27','Container','../../salesforce/services/salesforce.service','\x20Stop\x20sync\x20job\x20for\x20\x27','2038993oAoKFe','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','\x20Getting\x20repository\x20records.','\x20Syncing\x20repository:\x20\x22','repositoriesIntersections','prefix','\x20Getting\x20repositories\x20from\x20git\x20service.','897249KTFYMx','BRANCH_NAME_REGEXP','sfLogger','\x20Start\x20sync\x20job.','getRepositoryRecords','toLowerCase','Error','../../salesforce/errors/salesforce.error','Service','repositoryName','../jobs/git-sync.job','20SzHZii','GitSyncJob','__metadata','hooks','catch','REPOSITORY_NAME_REGEXP','Syncing\x20','5mPXhOz','HooksUtils','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.',']\x20due\x20error\x20-\x20','../../providers/web-hooks/hooks.utils','create','../../../../core/errors/too-many-requests.error','\x22\x20branch:\x20\x22','run','updateRemoteState','Not\x20Synchronized','\x20Repository\x20\x22','repositoryId','search','checkValidNaming','setLoggerId','gitUrl','948906tHPIzG','getOrCreateRepo','push','config','applicationUrl','logger','gitApiService','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','length','SalesforceError','name','../../salesforce/services/salesforce-sync.service','\x20No\x20repositories\x20to\x20sync.','disableSync','FlosumToGit','defineProperty','\x27\x20in\x20repository\x20\x27','\x27\x20[','\x20Sync\x20job\x20done.','24FlVOoC','88ZZwkcy','BadRequestError','branchName','FlosumSyncJob','repoService','56152HtNFhu','58258BCHGMo','Tokens','gitRepoService','getBranchRecords','Waiting','direction','repoList','12079184BfjWNo','TooManyRequests','getLoggerId','sleep','18ydntUg'];a128_0x5373=function(){return _0x344198;};return a128_0x5373();}const a128_0x301a35=(function(){let _0x429df2=!![];return function(_0x70ce66,_0x17d8f8){const _0x4bd0d4=_0x429df2?function(){const _0x478771=a128_0x4a0f;if(_0x17d8f8){const _0x273d42=_0x17d8f8[_0x478771(0x1a0)](_0x70ce66,arguments);return _0x17d8f8=null,_0x273d42;}}:function(){};return _0x429df2=![],_0x4bd0d4;};}()),a128_0x20784a=a128_0x301a35(this,function(){const _0x2b6e30=a128_0x4a0f;return a128_0x20784a[_0x2b6e30(0x1a1)]()[_0x2b6e30(0x1f4)](_0x2b6e30(0x1a6))[_0x2b6e30(0x1a1)]()[_0x2b6e30(0x1c6)](a128_0x20784a)[_0x2b6e30(0x1f4)](_0x2b6e30(0x1a6));});a128_0x20784a();'use strict';var __decorate=this&&this['__decorate']||function(_0x1a5751,_0x398552,_0x570fed,_0x43793f){const _0x5782b3=a128_0x4a0f;var _0x1e1746=arguments[_0x5782b3(0x200)],_0x1479eb=_0x1e1746<0x3?_0x398552:_0x43793f===null?_0x43793f=Object['getOwnPropertyDescriptor'](_0x398552,_0x570fed):_0x43793f,_0x578050;if(typeof Reflect===_0x5782b3(0x1c7)&&typeof Reflect['decorate']===_0x5782b3(0x1ad))_0x1479eb=Reflect['decorate'](_0x1a5751,_0x398552,_0x570fed,_0x43793f);else{for(var _0x113a2a=_0x1a5751[_0x5782b3(0x200)]-0x1;_0x113a2a>=0x0;_0x113a2a--)if(_0x578050=_0x1a5751[_0x113a2a])_0x1479eb=(_0x1e1746<0x3?_0x578050(_0x1479eb):_0x1e1746>0x3?_0x578050(_0x398552,_0x570fed,_0x1479eb):_0x578050(_0x398552,_0x570fed))||_0x1479eb;}return _0x1e1746>0x3&&_0x1479eb&&Object[_0x5782b3(0x186)](_0x398552,_0x570fed,_0x1479eb),_0x1479eb;},__metadata=this&&this[a128_0x556ee8(0x1e2)]||function(_0x287d91,_0x8eba7e){const _0x10be6d=a128_0x556ee8;if(typeof Reflect===_0x10be6d(0x1c7)&&typeof Reflect[_0x10be6d(0x1b6)]===_0x10be6d(0x1ad))return Reflect[_0x10be6d(0x1b6)](_0x287d91,_0x8eba7e);},SyncService_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a128_0x556ee8(0x1a7)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a128_0x556ee8(0x1c2)),too_many_requests_error_1=require(a128_0x556ee8(0x1ed)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a128_0x556ee8(0x1dc)),salesforce_sync_service_1=require(a128_0x556ee8(0x182)),salesforce_service_1=require(a128_0x556ee8(0x1cc)),utils_1=require(a128_0x556ee8(0x1b4)),typedi_1=require(a128_0x556ee8(0x19f)),hooks_utils_1=require(a128_0x556ee8(0x1eb)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require(a128_0x556ee8(0x1bb)),git_sync_job_1=require(a128_0x556ee8(0x1df)),providers_tokens_1=require('../../providers/providers.tokens'),bad_request_error_1=require('../../../../core/errors/bad-request.error');let SyncService=SyncService_1=class SyncService{constructor(_0x42293f,_0x2db5e8){const _0x6e7611=a128_0x556ee8;this[_0x6e7611(0x1ae)]=_0x42293f,this[_0x6e7611(0x1c8)]=_0x2db5e8,this[_0x6e7611(0x1fd)]=new core_1['Logger'](SyncService_1['name']),this['repositoriesIntersections']={},this[_0x6e7611(0x197)]=[];}async[a128_0x556ee8(0x1bd)](_0x1a9f6f,_0xf301e9){const _0x3e9bee=a128_0x556ee8;if(_0xf301e9 instanceof git_branch_not_found_error_1[_0x3e9bee(0x1ba)]){await this[_0x3e9bee(0x1c8)]['setStatus'](_0x1a9f6f,_0x3e9bee(0x1f1));return;}if(_0xf301e9 instanceof too_many_requests_error_1['TooManyRequests']){await this['salesforceSync'][_0x3e9bee(0x1c0)](_0x1a9f6f,_0x3e9bee(0x195));throw _0xf301e9;}try{await this[_0x3e9bee(0x1d7)][_0x3e9bee(0x1a8)](this['prefix']+_0x3e9bee(0x1cd)+_0x1a9f6f[_0x3e9bee(0x1de)]+_0x3e9bee(0x188)+_0x1a9f6f['branchName']+_0x3e9bee(0x1ea)+_0xf301e9+'.')[_0x3e9bee(0x1a5)](),await this['salesforceSync'][_0x3e9bee(0x1f0)](_0x1a9f6f,{}),await this['salesforceSync'][_0x3e9bee(0x1c0)](_0x1a9f6f,_0x3e9bee(0x1db));}catch(_0x492769){if(_0x492769 instanceof salesforce_error_1[_0x3e9bee(0x201)])throw _0x492769;}}async['isIntersects'](_0x436a9b){const _0x5948f0=a128_0x556ee8;if(_0x436a9b[_0x5948f0(0x1f3)]){const _0x2ffad8=_0x436a9b[_0x5948f0(0x1de)][_0x5948f0(0x1da)](),_0x338baa=this[_0x5948f0(0x1d2)][_0x2ffad8];if(!_0x338baa)this['repositoriesIntersections'][_0x2ffad8]=_0x436a9b['repositoryName'];else{if(_0x338baa&&_0x338baa!==_0x436a9b[_0x5948f0(0x1de)])return await this[_0x5948f0(0x1bd)](_0x436a9b,new Error(_0x5948f0(0x1c3)+_0x436a9b['repositoryName']+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x2ffad8+_0x5948f0(0x1ca)+_0x338baa+'\x27')),!![];}}return![];}async[a128_0x556ee8(0x1f5)](_0x36bf95){const _0xe45a18=a128_0x556ee8;if(!constants_1[_0xe45a18(0x1e5)][_0xe45a18(0x1be)](_0x36bf95[_0xe45a18(0x1de)]))return await this[_0xe45a18(0x1bd)](_0x36bf95,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x36bf95[_0xe45a18(0x1de)]+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1[_0xe45a18(0x1d6)][_0xe45a18(0x1be)](_0x36bf95[_0xe45a18(0x18d)]))return await this[_0xe45a18(0x1bd)](_0x36bf95,new Error(_0xe45a18(0x1b0)+_0x36bf95[_0xe45a18(0x18d)]+_0xe45a18(0x187)+_0x36bf95[_0xe45a18(0x1de)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a128_0x556ee8(0x1f9)](_0x15444e,_0x1b8baa){const _0x3fb184=a128_0x556ee8;let _0x5ed59b=this[_0x3fb184(0x197)]['find'](_0x58d49f=>_0x15444e[_0x3fb184(0x1de)]===_0x58d49f['name']);!_0x5ed59b&&(this[_0x3fb184(0x1d7)][_0x3fb184(0x1bc)](this[_0x3fb184(0x1d3)]+_0x3fb184(0x1f2)+_0x15444e[_0x3fb184(0x1de)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x5ed59b=await this['repoService'][_0x3fb184(0x1ec)]({'name':_0x15444e[_0x3fb184(0x1de)],'autoInit':!![],'defaultBranch':_0x15444e[_0x3fb184(0x18d)],'private':!![],'createHook':typedi_1[_0x3fb184(0x1cb)][_0x3fb184(0x1ac)](providers_tokens_1[_0x3fb184(0x192)][_0x3fb184(0x1fb)])[_0x3fb184(0x1c4)]}));if(this['config'][_0x3fb184(0x1c4)]){const _0x46569a=await _0x5ed59b[_0x3fb184(0x1e3)][_0x3fb184(0x19d)]();!_0x46569a[_0x3fb184(0x1b9)](_0x182326=>_0x182326['url']===hooks_utils_1[_0x3fb184(0x1e8)][_0x3fb184(0x19e)](this[_0x3fb184(0x1fb)][_0x3fb184(0x1bf)],this[_0x3fb184(0x1fb)]['applicationUrl'],_0x1b8baa))&&(this[_0x3fb184(0x1d7)][_0x3fb184(0x1bc)](this[_0x3fb184(0x1d3)]+_0x3fb184(0x1f2)+_0x15444e['repositoryName']+_0x3fb184(0x1e9)),await _0x5ed59b[_0x3fb184(0x1e3)][_0x3fb184(0x1ec)](hooks_utils_1[_0x3fb184(0x1e8)]['createHookPayload'](this[_0x3fb184(0x1fb)][_0x3fb184(0x1bf)],_0x5ed59b[_0x3fb184(0x1e3)],this['config'][_0x3fb184(0x1fc)],_0x1b8baa)));}return this[_0x3fb184(0x197)][_0x3fb184(0x1fa)](_0x5ed59b),_0x5ed59b;}async[a128_0x556ee8(0x1ef)](){const _0x85faed=a128_0x556ee8;this[_0x85faed(0x1fe)]=typedi_1[_0x85faed(0x1cb)][_0x85faed(0x1ac)](providers_tokens_1[_0x85faed(0x192)][_0x85faed(0x1fe)]),this[_0x85faed(0x18f)]=typedi_1['Container'][_0x85faed(0x1ac)](providers_tokens_1[_0x85faed(0x192)][_0x85faed(0x193)]),this[_0x85faed(0x1fb)]=typedi_1[_0x85faed(0x1cb)][_0x85faed(0x1ac)](providers_tokens_1[_0x85faed(0x192)][_0x85faed(0x1fb)]),this[_0x85faed(0x1d7)]=typedi_1[_0x85faed(0x1cb)][_0x85faed(0x1ac)](providers_tokens_1[_0x85faed(0x192)][_0x85faed(0x1fd)]),this['prefix']='['+SyncService_1[_0x85faed(0x181)]+_0x85faed(0x1b7)+this[_0x85faed(0x1fb)][_0x85faed(0x1bf)][_0x85faed(0x1a9)]()+']',this[_0x85faed(0x1ae)][_0x85faed(0x1f6)](this['sfLogger'][_0x85faed(0x19a)]());try{this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x1d8)),await this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x1d0))[_0x85faed(0x1a5)]();const _0x2df92e=await this[_0x85faed(0x1c8)][_0x85faed(0x1d9)](typedi_1['Container']['get'](providers_tokens_1['Tokens'][_0x85faed(0x1b3)]));if(!_0x2df92e[_0x85faed(0x200)])throw new bad_request_error_1[(_0x85faed(0x18c))](this['prefix']+_0x85faed(0x183));await this['sfLogger'][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x1ab))[_0x85faed(0x1a5)]();const _0xb8daa6=await this['salesforceSync'][_0x85faed(0x194)](_0x2df92e[_0x85faed(0x1b1)](_0x1ecbfe=>'\x27'+_0x1ecbfe[_0x85faed(0x1f3)]+'\x27')['join'](','));await this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this['prefix']+_0x85faed(0x1d4))[_0x85faed(0x1a5)](),this['repoList']=await this[_0x85faed(0x18f)][_0x85faed(0x19d)]();const _0x5c237a=[..._0x2df92e,..._0xb8daa6];this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x1c1)+_0x5c237a[_0x85faed(0x200)]+_0x85faed(0x1a3));for(const _0x5df270 of _0x5c237a){this['logger']['log'](_0x85faed(0x1e6)+_0x5df270[_0x85faed(0x1de)]+'['+_0x5df270['repositoryId']+']\x20repository\x20'+_0x5df270['branchName']+'['+_0x5df270['branchId']+_0x85faed(0x1b5)),this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x1d1)+_0x5df270[_0x85faed(0x1de)]+_0x85faed(0x1ee)+_0x5df270['branchName']+'\x22.'),this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+'\x20Checking\x20valid\x20name.');const _0x11df77=await this['checkValidNaming'](_0x5df270);if(!_0x11df77)continue;this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x1a4));const _0x38ff21=await this[_0x85faed(0x1aa)](_0x5df270);if(_0x38ff21)continue;await this[_0x85faed(0x1d7)][_0x85faed(0x1a5)]();let _0x358edb;try{await this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this['prefix']+_0x85faed(0x1a2))[_0x85faed(0x1a5)](),_0x358edb=await this[_0x85faed(0x1f9)](_0x5df270,typedi_1['Container'][_0x85faed(0x1ac)](providers_tokens_1[_0x85faed(0x192)][_0x85faed(0x1b3)]));}catch(_0x3c9ec0){await this[_0x85faed(0x1bd)](_0x5df270,_0x3c9ec0 instanceof too_many_requests_error_1[_0x85faed(0x199)]?_0x3c9ec0:new Error(_0x85faed(0x1b8)+_0x3c9ec0));continue;}await this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this['prefix']+'\x20Completed\x20prepare\x20to\x20syncing.')[_0x85faed(0x1a5)]();if(_0x5df270[_0x85faed(0x196)]===flosum_repository_sync_dto_1[_0x85faed(0x1b2)][_0x85faed(0x185)]){const _0x1d2f7d=typedi_1['Container'][_0x85faed(0x1ac)](flosum_sync_job_1[_0x85faed(0x18e)]);await _0x1d2f7d[_0x85faed(0x1ef)]({'repository':_0x358edb,'convertToSFDX':this[_0x85faed(0x1fb)]['isConvertToSfdx'],'syncRecord':_0x5df270,'provider':this[_0x85faed(0x1fb)]['gitProvider']})[_0x85faed(0x1e4)](_0x5f2373=>this[_0x85faed(0x1bd)](_0x5df270,_0x5f2373));}else{const _0x4e090c=typedi_1[_0x85faed(0x1cb)][_0x85faed(0x1ac)](git_sync_job_1[_0x85faed(0x1e1)]);await _0x4e090c[_0x85faed(0x1ef)]({'repository':_0x358edb,'branch':_0x5df270[_0x85faed(0x18d)],'provider':this[_0x85faed(0x1fb)][_0x85faed(0x1bf)],'repositoryGit':_0x358edb[_0x85faed(0x1f7)],'syncRecord':_0x5df270})[_0x85faed(0x1e4)](_0x4dd8ba=>this[_0x85faed(0x1bd)](_0x5df270,_0x4dd8ba));}}}catch(_0x253abe){this[_0x85faed(0x1fd)][_0x85faed(0x1a8)](_0x253abe);_0x253abe instanceof too_many_requests_error_1['TooManyRequests']?(await this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x1ff))[_0x85faed(0x1a5)](),await(0x0,utils_1[_0x85faed(0x19b)])(0x3c*0x3c*0x3e8),this[_0x85faed(0x1ef)]()):await this[_0x85faed(0x1d7)][_0x85faed(0x1a8)](this[_0x85faed(0x1d3)]+_0x85faed(0x1cf)+_0x253abe)[_0x85faed(0x1a5)]();return;}await this[_0x85faed(0x1d7)][_0x85faed(0x1bc)](this[_0x85faed(0x1d3)]+_0x85faed(0x189))['send'](),await this[_0x85faed(0x1c8)][_0x85faed(0x184)](typedi_1[_0x85faed(0x1cb)][_0x85faed(0x1ac)](providers_tokens_1[_0x85faed(0x192)][_0x85faed(0x1b3)]))[_0x85faed(0x1e4)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a128_0x556ee8(0x1dd)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a128_0x556ee8(0x1c9)]])],SyncService),exports['SyncService']=SyncService;