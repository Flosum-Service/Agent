function a128_0x2e88(){const _0x4a4fc6=['\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','../../../../core/errors/too-many-requests.error','log','decorate','\x27\x20-\x20\x27','GitBranchNotFoundError','../jobs/flosum-sync.job','BRANCH_NAME_REGEXP','../../../shared/utils','\x20Start\x20sync\x20job.','../../providers/providers.tokens','toUpperCase','Tokens','url','SalesforceSyncService','branchName','(((.+)+)+)+$','join','\x20Have\x20to\x20synchronize\x20','FlosumToGit','\x20Checking\x20valid\x20name.','handleRecordSyncError','Waiting','sfLogger','repositoriesIntersections','5236656IYMPJc','Service','setLoggerId','send','__esModule','15988pFnveY','\x20Getting\x20Flosum\x20repository','../jobs/git-sync.job','Unable\x20to\x20synchronize\x20branch\x20\x27','length','disableSync','push','\x20Getting\x20branch\x20records.','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','getBranchRecords','connectionId','\x20Repository\x20\x22','constructor','find','../../../../core','GitSyncJob','catch','repositoryId','gitUrl','gitApiService','config','design:paramtypes','defineProperty','\x22\x20branch:\x20\x22','__decorate','run','__metadata','BadRequestError','error','repositoryName','toString','72xQVihp','object','test','../../../../constants','setStatus','2973410zkwaSW','name','HooksUtils','Syncing\x20','function','gitProvider','\x20Sync\x20job\x20done.','getRepositoryRecords','Logger','105933QRVOfc','\x20Getting\x20repositories\x20from\x20git\x20service.','../../salesforce/dto/flosum-repository-sync.dto','getOrCreateRepo','TooManyRequests','Container','applicationUrl','6551670vHHEFS','apply','9lFSgGN','metadata','\x20Completed\x20prepare\x20to\x20syncing.','../../../../core/errors/bad-request.error','getLoggerId','salesforceService','hooks','checkValidNaming','Error','SyncService','branchId','138rrdQmx','1xvXuuL','296wlysPI','gitRepoService','isIntersects','prefix','salesforceSync','typedi','\x20Stop\x20sync\x20job\x20for\x20\x27','search','get','SyncDirection','\x27\x20in\x20repository\x20\x27','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','REPOSITORY_NAME_REGEXP','getAll','\x20No\x20repositories\x20to\x20sync.','repoService','1095574uDudkr','63145fntzNi','create','../../salesforce/services/salesforce-sync.service','../../providers/web-hooks/hooks.utils',']\x20repository\x20','Not\x20Synchronized','toLowerCase','isBidirectionalSynchronization','getOwnPropertyDescriptor','direction','Unable\x20to\x20synchronize\x20repository\x20\x27','getHookLinkFor','repoList','logger'];a128_0x2e88=function(){return _0x4a4fc6;};return a128_0x2e88();}const a128_0x3a07bd=a128_0x4f4f;(function(_0x4041fa,_0x34a9f0){const _0x5037e2=a128_0x4f4f,_0x8da0b1=_0x4041fa();while(!![]){try{const _0xea80ef=-parseInt(_0x5037e2(0x1fa))/0x1*(-parseInt(_0x5037e2(0x20b))/0x2)+parseInt(_0x5037e2(0x1e5))/0x3*(-parseInt(_0x5037e2(0x1d7))/0x4)+parseInt(_0x5037e2(0x20c))/0x5*(parseInt(_0x5037e2(0x1f9))/0x6)+-parseInt(_0x5037e2(0x1b8))/0x7*(-parseInt(_0x5037e2(0x1fb))/0x8)+-parseInt(_0x5037e2(0x1ee))/0x9*(parseInt(_0x5037e2(0x1ec))/0xa)+parseInt(_0x5037e2(0x1dc))/0xb+parseInt(_0x5037e2(0x233))/0xc;if(_0xea80ef===_0x34a9f0)break;else _0x8da0b1['push'](_0x8da0b1['shift']());}catch(_0x3b0bb9){_0x8da0b1['push'](_0x8da0b1['shift']());}}}(a128_0x2e88,0x52b07));const a128_0x119754=(function(){let _0x39be6c=!![];return function(_0xec87d9,_0x30c3f3){const _0x2386aa=_0x39be6c?function(){const _0x587f14=a128_0x4f4f;if(_0x30c3f3){const _0x24c5a4=_0x30c3f3[_0x587f14(0x1ed)](_0xec87d9,arguments);return _0x30c3f3=null,_0x24c5a4;}}:function(){};return _0x39be6c=![],_0x2386aa;};}()),a128_0x12babb=a128_0x119754(this,function(){const _0x20bc2d=a128_0x4f4f;return a128_0x12babb[_0x20bc2d(0x1d6)]()[_0x20bc2d(0x202)](_0x20bc2d(0x22a))['toString']()[_0x20bc2d(0x1c4)](a128_0x12babb)[_0x20bc2d(0x202)](_0x20bc2d(0x22a));});a128_0x12babb();function a128_0x4f4f(_0x4aea32,_0x215ff7){const _0x4c04fc=a128_0x2e88();return a128_0x4f4f=function(_0x12babb,_0x119754){_0x12babb=_0x12babb-0x1b8;let _0x2e883c=_0x4c04fc[_0x12babb];return _0x2e883c;},a128_0x4f4f(_0x4aea32,_0x215ff7);}'use strict';var __decorate=this&&this[a128_0x3a07bd(0x1d0)]||function(_0x2ef1f6,_0x9d01b0,_0x2083c2,_0x5eabde){const _0xb2b8b9=a128_0x3a07bd;var _0x4d6017=arguments[_0xb2b8b9(0x1bc)],_0xbd3b7f=_0x4d6017<0x3?_0x9d01b0:_0x5eabde===null?_0x5eabde=Object[_0xb2b8b9(0x214)](_0x9d01b0,_0x2083c2):_0x5eabde,_0x430adb;if(typeof Reflect==='object'&&typeof Reflect[_0xb2b8b9(0x21d)]===_0xb2b8b9(0x1e0))_0xbd3b7f=Reflect[_0xb2b8b9(0x21d)](_0x2ef1f6,_0x9d01b0,_0x2083c2,_0x5eabde);else{for(var _0x3e66db=_0x2ef1f6[_0xb2b8b9(0x1bc)]-0x1;_0x3e66db>=0x0;_0x3e66db--)if(_0x430adb=_0x2ef1f6[_0x3e66db])_0xbd3b7f=(_0x4d6017<0x3?_0x430adb(_0xbd3b7f):_0x4d6017>0x3?_0x430adb(_0x9d01b0,_0x2083c2,_0xbd3b7f):_0x430adb(_0x9d01b0,_0x2083c2))||_0xbd3b7f;}return _0x4d6017>0x3&&_0xbd3b7f&&Object[_0xb2b8b9(0x1ce)](_0x9d01b0,_0x2083c2,_0xbd3b7f),_0xbd3b7f;},__metadata=this&&this[a128_0x3a07bd(0x1d2)]||function(_0x2c351d,_0x24534e){const _0x117e0a=a128_0x3a07bd;if(typeof Reflect===_0x117e0a(0x1d8)&&typeof Reflect['metadata']===_0x117e0a(0x1e0))return Reflect[_0x117e0a(0x1ef)](_0x2c351d,_0x24534e);},SyncService_1;Object[a128_0x3a07bd(0x1ce)](exports,a128_0x3a07bd(0x237),{'value':!![]}),exports[a128_0x3a07bd(0x1f7)]=void 0x0;const constants_1=require(a128_0x3a07bd(0x1da)),core_1=require(a128_0x3a07bd(0x1c6)),too_many_requests_error_1=require(a128_0x3a07bd(0x21b)),flosum_repository_sync_dto_1=require(a128_0x3a07bd(0x1e7)),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_sync_service_1=require(a128_0x3a07bd(0x20e)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),utils_1=require(a128_0x3a07bd(0x222)),typedi_1=require(a128_0x3a07bd(0x200)),hooks_utils_1=require(a128_0x3a07bd(0x20f)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require(a128_0x3a07bd(0x220)),git_sync_job_1=require(a128_0x3a07bd(0x1ba)),providers_tokens_1=require(a128_0x3a07bd(0x224)),bad_request_error_1=require(a128_0x3a07bd(0x1f1));let SyncService=SyncService_1=class SyncService{constructor(_0x2aa9d5,_0x4ddf66){const _0x58e1c0=a128_0x3a07bd;this[_0x58e1c0(0x1f3)]=_0x2aa9d5,this['salesforceSync']=_0x4ddf66,this['logger']=new core_1[(_0x58e1c0(0x1e4))](SyncService_1['name']),this[_0x58e1c0(0x232)]={},this[_0x58e1c0(0x218)]=[];}async['handleRecordSyncError'](_0x19a2e5,_0x425016){const _0x214ecb=a128_0x3a07bd;if(_0x425016 instanceof git_branch_not_found_error_1[_0x214ecb(0x21f)]){await this[_0x214ecb(0x1ff)]['setStatus'](_0x19a2e5,_0x214ecb(0x211));return;}if(_0x425016 instanceof too_many_requests_error_1[_0x214ecb(0x1e9)]){await this[_0x214ecb(0x1ff)][_0x214ecb(0x1db)](_0x19a2e5,_0x214ecb(0x230));throw _0x425016;}try{await this[_0x214ecb(0x231)][_0x214ecb(0x1d4)](this['prefix']+_0x214ecb(0x201)+_0x19a2e5[_0x214ecb(0x1d5)]+'\x27\x20['+_0x19a2e5[_0x214ecb(0x229)]+']\x20due\x20error\x20-\x20'+_0x425016+'.')['send'](),await this[_0x214ecb(0x1ff)]['updateRemoteState'](_0x19a2e5,{}),await this[_0x214ecb(0x1ff)]['setStatus'](_0x19a2e5,_0x214ecb(0x1f6));}catch(_0x1ad717){if(_0x1ad717 instanceof salesforce_error_1['SalesforceError'])throw _0x1ad717;}}async['isIntersects'](_0x394818){const _0x2874cc=a128_0x3a07bd;if(_0x394818[_0x2874cc(0x1c9)]){const _0x754db5=_0x394818[_0x2874cc(0x1d5)][_0x2874cc(0x212)](),_0x242ac3=this[_0x2874cc(0x232)][_0x754db5];if(!_0x242ac3)this[_0x2874cc(0x232)][_0x754db5]=_0x394818[_0x2874cc(0x1d5)];else{if(_0x242ac3&&_0x242ac3!==_0x394818[_0x2874cc(0x1d5)])return await this[_0x2874cc(0x22f)](_0x394818,new Error(_0x2874cc(0x216)+_0x394818[_0x2874cc(0x1d5)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x754db5+_0x2874cc(0x21e)+_0x242ac3+'\x27')),!![];}}return![];}async[a128_0x3a07bd(0x1f5)](_0x320b9c){const _0x32fff0=a128_0x3a07bd;if(!constants_1[_0x32fff0(0x207)][_0x32fff0(0x1d9)](_0x320b9c[_0x32fff0(0x1d5)]))return await this[_0x32fff0(0x22f)](_0x320b9c,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x320b9c[_0x32fff0(0x1d5)]+_0x32fff0(0x1c0))),![];if(!constants_1[_0x32fff0(0x221)][_0x32fff0(0x1d9)](_0x320b9c[_0x32fff0(0x229)]))return await this['handleRecordSyncError'](_0x320b9c,new Error(_0x32fff0(0x1bb)+_0x320b9c[_0x32fff0(0x229)]+_0x32fff0(0x205)+_0x320b9c[_0x32fff0(0x1d5)]+_0x32fff0(0x206))),![];return!![];}async[a128_0x3a07bd(0x1e8)](_0x4b17b3,_0x2f591f){const _0x195804=a128_0x3a07bd;let _0x5bf2fc=this[_0x195804(0x218)][_0x195804(0x1c5)](_0xb2d88c=>_0x4b17b3[_0x195804(0x1d5)]===_0xb2d88c[_0x195804(0x1dd)]);!_0x5bf2fc&&(this[_0x195804(0x231)][_0x195804(0x21c)](this[_0x195804(0x1fe)]+_0x195804(0x1c3)+_0x4b17b3[_0x195804(0x1d5)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x5bf2fc=await this[_0x195804(0x20a)]['create']({'name':_0x4b17b3[_0x195804(0x1d5)],'autoInit':!![],'defaultBranch':_0x4b17b3[_0x195804(0x229)],'private':!![],'createHook':typedi_1[_0x195804(0x1ea)][_0x195804(0x203)](providers_tokens_1[_0x195804(0x226)][_0x195804(0x1cc)])[_0x195804(0x213)]}));if(this[_0x195804(0x1cc)][_0x195804(0x213)]){const _0x3a8010=await _0x5bf2fc[_0x195804(0x1f4)][_0x195804(0x208)]();!_0x3a8010['find'](_0xdfd224=>_0xdfd224[_0x195804(0x227)]===hooks_utils_1[_0x195804(0x1de)][_0x195804(0x217)](this[_0x195804(0x1cc)][_0x195804(0x1e1)],this[_0x195804(0x1cc)][_0x195804(0x1eb)],_0x2f591f))&&(this[_0x195804(0x231)][_0x195804(0x21c)](this[_0x195804(0x1fe)]+_0x195804(0x1c3)+_0x4b17b3[_0x195804(0x1d5)]+'\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.'),await _0x5bf2fc[_0x195804(0x1f4)][_0x195804(0x20d)](hooks_utils_1[_0x195804(0x1de)]['createHookPayload'](this['config'][_0x195804(0x1e1)],_0x5bf2fc['hooks'],this[_0x195804(0x1cc)][_0x195804(0x1eb)],_0x2f591f)));}return this['repoList'][_0x195804(0x1be)](_0x5bf2fc),_0x5bf2fc;}async[a128_0x3a07bd(0x1d1)](){const _0x746d48=a128_0x3a07bd;this[_0x746d48(0x1cb)]=typedi_1[_0x746d48(0x1ea)]['get'](providers_tokens_1['Tokens'][_0x746d48(0x1cb)]),this[_0x746d48(0x20a)]=typedi_1[_0x746d48(0x1ea)][_0x746d48(0x203)](providers_tokens_1[_0x746d48(0x226)][_0x746d48(0x1fc)]),this['config']=typedi_1[_0x746d48(0x1ea)][_0x746d48(0x203)](providers_tokens_1[_0x746d48(0x226)][_0x746d48(0x1cc)]),this[_0x746d48(0x231)]=typedi_1[_0x746d48(0x1ea)][_0x746d48(0x203)](providers_tokens_1[_0x746d48(0x226)]['logger']),this[_0x746d48(0x1fe)]='['+SyncService_1[_0x746d48(0x1dd)]+']\x20['+this[_0x746d48(0x1cc)]['gitProvider'][_0x746d48(0x225)]()+']',this[_0x746d48(0x1f3)][_0x746d48(0x235)](this[_0x746d48(0x231)][_0x746d48(0x1f2)]());try{this[_0x746d48(0x231)][_0x746d48(0x21c)](this[_0x746d48(0x1fe)]+_0x746d48(0x223)),await this[_0x746d48(0x231)][_0x746d48(0x21c)](this[_0x746d48(0x1fe)]+'\x20Getting\x20repository\x20records.')[_0x746d48(0x236)]();const _0x1b48b8=await this[_0x746d48(0x1ff)][_0x746d48(0x1e3)](typedi_1[_0x746d48(0x1ea)][_0x746d48(0x203)](providers_tokens_1[_0x746d48(0x226)]['connectionId']));if(!_0x1b48b8['length'])throw new bad_request_error_1[(_0x746d48(0x1d3))](this[_0x746d48(0x1fe)]+_0x746d48(0x209));await this[_0x746d48(0x231)][_0x746d48(0x21c)](this[_0x746d48(0x1fe)]+_0x746d48(0x1bf))[_0x746d48(0x236)]();const _0x4fe461=await this[_0x746d48(0x1ff)][_0x746d48(0x1c1)](_0x1b48b8['map'](_0x10e8dc=>'\x27'+_0x10e8dc[_0x746d48(0x1c9)]+'\x27')[_0x746d48(0x22b)](','));await this[_0x746d48(0x231)][_0x746d48(0x21c)](this[_0x746d48(0x1fe)]+_0x746d48(0x1e6))['send'](),this[_0x746d48(0x218)]=await this[_0x746d48(0x20a)][_0x746d48(0x208)]();const _0xb8cca5=[..._0x1b48b8,..._0x4fe461];this['sfLogger']['log'](this[_0x746d48(0x1fe)]+_0x746d48(0x22c)+_0xb8cca5[_0x746d48(0x1bc)]+'\x20branches.');for(const _0x381b59 of _0xb8cca5){this[_0x746d48(0x219)][_0x746d48(0x21c)](_0x746d48(0x1df)+_0x381b59[_0x746d48(0x1d5)]+'['+_0x381b59['repositoryId']+_0x746d48(0x210)+_0x381b59[_0x746d48(0x229)]+'['+_0x381b59[_0x746d48(0x1f8)]+']\x20branch.'),this['sfLogger']['log'](this[_0x746d48(0x1fe)]+'\x20Syncing\x20repository:\x20\x22'+_0x381b59[_0x746d48(0x1d5)]+_0x746d48(0x1cf)+_0x381b59[_0x746d48(0x229)]+'\x22.'),this[_0x746d48(0x231)]['log'](this['prefix']+_0x746d48(0x22e));const _0x4a2ba5=await this[_0x746d48(0x1f5)](_0x381b59);if(!_0x4a2ba5)continue;this['sfLogger']['log'](this[_0x746d48(0x1fe)]+'\x20Checking\x20intersects.');const _0x1896cf=await this[_0x746d48(0x1fd)](_0x381b59);if(_0x1896cf)continue;await this[_0x746d48(0x231)]['send']();let _0x2c4c6f;try{await this['sfLogger']['log'](this['prefix']+_0x746d48(0x1b9))['send'](),_0x2c4c6f=await this['getOrCreateRepo'](_0x381b59,typedi_1[_0x746d48(0x1ea)][_0x746d48(0x203)](providers_tokens_1[_0x746d48(0x226)][_0x746d48(0x1c2)]));}catch(_0x3b15cc){await this[_0x746d48(0x22f)](_0x381b59,_0x3b15cc instanceof too_many_requests_error_1['TooManyRequests']?_0x3b15cc:new Error('[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20'+_0x3b15cc));continue;}await this[_0x746d48(0x231)][_0x746d48(0x21c)](this['prefix']+_0x746d48(0x1f0))[_0x746d48(0x236)]();if(_0x381b59[_0x746d48(0x215)]===flosum_repository_sync_dto_1[_0x746d48(0x204)][_0x746d48(0x22d)]){const _0x402d90=typedi_1['Container'][_0x746d48(0x203)](flosum_sync_job_1['FlosumSyncJob']);await _0x402d90[_0x746d48(0x1d1)]({'repository':_0x2c4c6f,'convertToSFDX':this['config']['isConvertToSfdx'],'syncRecord':_0x381b59,'provider':this[_0x746d48(0x1cc)][_0x746d48(0x1e1)]})[_0x746d48(0x1c8)](_0x3146bf=>this['handleRecordSyncError'](_0x381b59,_0x3146bf));}else{const _0x189aa9=typedi_1[_0x746d48(0x1ea)][_0x746d48(0x203)](git_sync_job_1[_0x746d48(0x1c7)]);await _0x189aa9['run']({'repository':_0x2c4c6f,'branch':_0x381b59['branchName'],'provider':this['config'][_0x746d48(0x1e1)],'repositoryGit':_0x2c4c6f[_0x746d48(0x1ca)],'syncRecord':_0x381b59})['catch'](_0x122fa2=>this['handleRecordSyncError'](_0x381b59,_0x122fa2));}}}catch(_0x3224a9){this[_0x746d48(0x219)]['error'](_0x3224a9);_0x3224a9 instanceof too_many_requests_error_1[_0x746d48(0x1e9)]?(await this['sfLogger']['log'](this[_0x746d48(0x1fe)]+'\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')[_0x746d48(0x236)](),await(0x0,utils_1['sleep'])(0x3c*0x3c*0x3e8),this[_0x746d48(0x1d1)]()):await this[_0x746d48(0x231)][_0x746d48(0x1d4)](this[_0x746d48(0x1fe)]+_0x746d48(0x21a)+_0x3224a9)[_0x746d48(0x236)]();return;}await this[_0x746d48(0x231)][_0x746d48(0x21c)](this[_0x746d48(0x1fe)]+_0x746d48(0x1e2))[_0x746d48(0x236)](),await this[_0x746d48(0x1ff)][_0x746d48(0x1bd)](typedi_1[_0x746d48(0x1ea)][_0x746d48(0x203)](providers_tokens_1[_0x746d48(0x226)][_0x746d48(0x1c2)]))[_0x746d48(0x1c8)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a128_0x3a07bd(0x234)])({'transient':!![]}),__metadata(a128_0x3a07bd(0x1cd),[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a128_0x3a07bd(0x228)]])],SyncService),exports['SyncService']=SyncService;