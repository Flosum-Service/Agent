function a112_0x1031(_0x54014b,_0x2ed054){const _0x35e082=a112_0x46bd();return a112_0x1031=function(_0x35e18d,_0x40d761){_0x35e18d=_0x35e18d-0xb6;let _0x46bd91=_0x35e082[_0x35e18d];return _0x46bd91;},a112_0x1031(_0x54014b,_0x2ed054);}const a112_0x2a0b5b=a112_0x1031;(function(_0x2ea96f,_0x31c316){const _0x97619a=a112_0x1031,_0x85bb1b=_0x2ea96f();while(!![]){try{const _0x39da38=parseInt(_0x97619a(0xc3))/0x1+-parseInt(_0x97619a(0xfa))/0x2+-parseInt(_0x97619a(0xd8))/0x3*(parseInt(_0x97619a(0xfd))/0x4)+parseInt(_0x97619a(0xeb))/0x5*(parseInt(_0x97619a(0xbe))/0x6)+-parseInt(_0x97619a(0x120))/0x7*(-parseInt(_0x97619a(0xdd))/0x8)+parseInt(_0x97619a(0xbb))/0x9+-parseInt(_0x97619a(0xf3))/0xa*(-parseInt(_0x97619a(0x12f))/0xb);if(_0x39da38===_0x31c316)break;else _0x85bb1b['push'](_0x85bb1b['shift']());}catch(_0x1fa321){_0x85bb1b['push'](_0x85bb1b['shift']());}}}(a112_0x46bd,0xb1f8f));const a112_0x40d761=(function(){let _0x2a7719=!![];return function(_0x33e2cc,_0xd2199f){const _0x4c769a=_0x2a7719?function(){const _0x26bcfc=a112_0x1031;if(_0xd2199f){const _0x4d1c17=_0xd2199f[_0x26bcfc(0xc9)](_0x33e2cc,arguments);return _0xd2199f=null,_0x4d1c17;}}:function(){};return _0x2a7719=![],_0x4c769a;};}()),a112_0x35e18d=a112_0x40d761(this,function(){const _0x27801d=a112_0x1031;return a112_0x35e18d[_0x27801d(0xd3)]()[_0x27801d(0xfb)]('(((.+)+)+)+$')['toString']()['constructor'](a112_0x35e18d)['search']('(((.+)+)+)+$');});function a112_0x46bd(){const _0x293bb8=[']\x20repository\x20','prefix','error','find','4837149wVgVrW','hooks','\x27\x20[','3257898KssmHF','../../../../core/errors/too-many-requests.error',']\x20branch.','get','length','232315vZakIv','toLowerCase','join','isBidirectionalSynchronization','gitProvider','Error','apply','BRANCH_NAME_REGEXP','checkValidNaming','function','\x27\x20-\x20\x27','\x20Getting\x20repositories\x20from\x20git\x20service.','send',']\x20due\x20error\x20-\x20','defineProperty','\x20[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','toString','updateRemoteState','../../salesforce/services/salesforce-sync.service','salesforceSync','../../../../core/errors/bad-request.error','12DgPiGt','\x20Getting\x20Flosum\x20repository','catch','\x22\x20does\x27t\x20has\x20the\x20agent\x20webhook.\x20Agent\x20will\x20create\x20new\x20repository\x20webhook\x20to\x20enable\x20back\x20sync.',']\x20[','8jMpnkK','SyncService','../../providers/providers.tokens','getAll','../../salesforce/errors/salesforce.error','Logger','\x22\x20branch:\x20\x22','\x20No\x20repositories\x20to\x20sync.','create','TooManyRequests','gitRepoService','typedi','direction','metadata','5izKOvm','sleep','run','config','repositoryId','getOwnPropertyDescriptor','setStatus','GitSyncJob','4858910KGggRI','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','SyncDirection','getRepositoryRecords','\x20Repository\x20\x22','isConvertToSfdx','setLoggerId','2894456FRGPfQ','search','getOrCreateRepo','1222084NjjzGg','Container','gitApiService','name','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','isIntersects','\x20Sync\x20job\x20done.','\x20Stop\x20sync\x20job\x20for\x20\x27','gitUrl','Syncing\x20','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','Unable\x20to\x20synchronize\x20repository\x20\x27','handleRecordSyncError','Tokens','map','repoList','repoService','push','applicationUrl','url','GitBranchNotFoundError','SalesforceService','\x20Checking\x20valid\x20name.','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','logger','object','sfLogger','disableSync','\x20branches.','SalesforceSyncService','test','../../salesforce/dto/flosum-repository-sync.dto','../../../../constants','repositoriesIntersections','Service','993748vEgAtk','log','\x20Getting\x20branch\x20records.','__decorate','salesforceService','branchId','HooksUtils','repositoryName','branchName','Not\x20Synchronized','decorate','connectionId','REPOSITORY_NAME_REGEXP','\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','../../providers/web-hooks/hooks.utils','44KQAWMi','__esModule','Waiting','../../../../core','\x27\x20in\x20repository\x20\x27','\x20Checking\x20intersects.'];a112_0x46bd=function(){return _0x293bb8;};return a112_0x46bd();}a112_0x35e18d();'use strict';var __decorate=this&&this[a112_0x2a0b5b(0x123)]||function(_0x3fb086,_0x227db3,_0x395a68,_0x311860){const _0x2a902c=a112_0x2a0b5b;var _0xc5be94=arguments[_0x2a902c(0xc2)],_0xd97297=_0xc5be94<0x3?_0x227db3:_0x311860===null?_0x311860=Object[_0x2a902c(0xf0)](_0x227db3,_0x395a68):_0x311860,_0x3479b0;if(typeof Reflect===_0x2a902c(0x116)&&typeof Reflect['decorate']===_0x2a902c(0xcc))_0xd97297=Reflect[_0x2a902c(0x12a)](_0x3fb086,_0x227db3,_0x395a68,_0x311860);else{for(var _0x3ab8bd=_0x3fb086[_0x2a902c(0xc2)]-0x1;_0x3ab8bd>=0x0;_0x3ab8bd--)if(_0x3479b0=_0x3fb086[_0x3ab8bd])_0xd97297=(_0xc5be94<0x3?_0x3479b0(_0xd97297):_0xc5be94>0x3?_0x3479b0(_0x227db3,_0x395a68,_0xd97297):_0x3479b0(_0x227db3,_0x395a68))||_0xd97297;}return _0xc5be94>0x3&&_0xd97297&&Object[_0x2a902c(0xd1)](_0x227db3,_0x395a68,_0xd97297),_0xd97297;},__metadata=this&&this['__metadata']||function(_0x574c08,_0x3fc36f){const _0x22f0ef=a112_0x2a0b5b;if(typeof Reflect===_0x22f0ef(0x116)&&typeof Reflect[_0x22f0ef(0xea)]===_0x22f0ef(0xcc))return Reflect[_0x22f0ef(0xea)](_0x574c08,_0x3fc36f);},SyncService_1;Object[a112_0x2a0b5b(0xd1)](exports,a112_0x2a0b5b(0x130),{'value':!![]}),exports[a112_0x2a0b5b(0xde)]=void 0x0;const constants_1=require(a112_0x2a0b5b(0x11d)),core_1=require(a112_0x2a0b5b(0x132)),too_many_requests_error_1=require(a112_0x2a0b5b(0xbf)),flosum_repository_sync_dto_1=require(a112_0x2a0b5b(0x11c)),salesforce_error_1=require(a112_0x2a0b5b(0xe1)),salesforce_sync_service_1=require(a112_0x2a0b5b(0xd5)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),utils_1=require('../../../shared/utils'),typedi_1=require(a112_0x2a0b5b(0xe8)),hooks_utils_1=require(a112_0x2a0b5b(0x12e)),git_branch_not_found_error_1=require('../errors/git-branch-not-found.error'),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require('../jobs/git-sync.job'),providers_tokens_1=require(a112_0x2a0b5b(0xdf)),bad_request_error_1=require(a112_0x2a0b5b(0xd7));let SyncService=SyncService_1=class SyncService{constructor(_0x457d4c,_0x4020d3){const _0x488468=a112_0x2a0b5b;this['salesforceService']=_0x457d4c,this[_0x488468(0xd6)]=_0x4020d3,this[_0x488468(0x115)]=new core_1[(_0x488468(0xe2))](SyncService_1[_0x488468(0x100)]),this[_0x488468(0x11e)]={},this[_0x488468(0x10c)]=[];}async['handleRecordSyncError'](_0x4613db,_0x137035){const _0x597b2d=a112_0x2a0b5b;if(_0x137035 instanceof git_branch_not_found_error_1[_0x597b2d(0x111)]){await this[_0x597b2d(0xd6)][_0x597b2d(0xf1)](_0x4613db,_0x597b2d(0x129));return;}if(_0x137035 instanceof too_many_requests_error_1[_0x597b2d(0xe6)]){await this['salesforceSync'][_0x597b2d(0xf1)](_0x4613db,_0x597b2d(0x131));throw _0x137035;}try{await this[_0x597b2d(0x117)][_0x597b2d(0xb9)](this[_0x597b2d(0xb8)]+_0x597b2d(0x104)+_0x4613db[_0x597b2d(0x127)]+_0x597b2d(0xbd)+_0x4613db[_0x597b2d(0x128)]+_0x597b2d(0xd0)+_0x137035+'.')[_0x597b2d(0xcf)](),await this['salesforceSync'][_0x597b2d(0xd4)](_0x4613db,{}),await this[_0x597b2d(0xd6)][_0x597b2d(0xf1)](_0x4613db,_0x597b2d(0xc8));}catch(_0x57a371){if(_0x57a371 instanceof salesforce_error_1['SalesforceError'])throw _0x57a371;}}async['isIntersects'](_0x4d5ff6){const _0x322b22=a112_0x2a0b5b;if(_0x4d5ff6[_0x322b22(0xef)]){const _0x32456f=_0x4d5ff6[_0x322b22(0x127)][_0x322b22(0xc4)](),_0x5d7097=this[_0x322b22(0x11e)][_0x32456f];if(!_0x5d7097)this['repositoriesIntersections'][_0x32456f]=_0x4d5ff6[_0x322b22(0x127)];else{if(_0x5d7097&&_0x5d7097!==_0x4d5ff6['repositoryName'])return await this[_0x322b22(0x109)](_0x4d5ff6,new Error(_0x322b22(0x108)+_0x4d5ff6[_0x322b22(0x127)]+_0x322b22(0x101)+_0x32456f+_0x322b22(0xcd)+_0x5d7097+'\x27')),!![];}}return![];}async[a112_0x2a0b5b(0xcb)](_0x34cdf5){const _0x45dc19=a112_0x2a0b5b;if(!constants_1[_0x45dc19(0x12c)]['test'](_0x34cdf5['repositoryName']))return await this[_0x45dc19(0x109)](_0x34cdf5,new Error(_0x45dc19(0x108)+_0x34cdf5['repositoryName']+_0x45dc19(0xf4))),![];if(!constants_1[_0x45dc19(0xca)][_0x45dc19(0x11b)](_0x34cdf5[_0x45dc19(0x128)]))return await this[_0x45dc19(0x109)](_0x34cdf5,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x34cdf5[_0x45dc19(0x128)]+_0x45dc19(0x133)+_0x34cdf5[_0x45dc19(0x127)]+_0x45dc19(0x114))),![];return!![];}async[a112_0x2a0b5b(0xfc)](_0xbf29e9,_0x398be9){const _0x141f5c=a112_0x2a0b5b;let _0x5a799c=this[_0x141f5c(0x10c)]['find'](_0x3ede2c=>_0xbf29e9['repositoryName']===_0x3ede2c[_0x141f5c(0x100)]);!_0x5a799c&&(this['sfLogger'][_0x141f5c(0x121)](this[_0x141f5c(0xb8)]+'\x20Repository\x20\x22'+_0xbf29e9['repositoryName']+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x5a799c=await this['repoService'][_0x141f5c(0xe5)]({'name':_0xbf29e9[_0x141f5c(0x127)],'autoInit':!![],'defaultBranch':_0xbf29e9['branchName'],'private':!![],'createHook':typedi_1[_0x141f5c(0xfe)]['get'](providers_tokens_1[_0x141f5c(0x10a)][_0x141f5c(0xee)])[_0x141f5c(0xc6)]}));if(this[_0x141f5c(0xee)]['isBidirectionalSynchronization']){const _0x118618=await _0x5a799c[_0x141f5c(0xbc)][_0x141f5c(0xe0)]();!_0x118618[_0x141f5c(0xba)](_0x4a7eb6=>_0x4a7eb6[_0x141f5c(0x110)]===hooks_utils_1[_0x141f5c(0x126)]['getHookLinkFor'](this[_0x141f5c(0xee)][_0x141f5c(0xc7)],this[_0x141f5c(0xee)][_0x141f5c(0x10f)],_0x398be9))&&(this[_0x141f5c(0x117)][_0x141f5c(0x121)](this[_0x141f5c(0xb8)]+_0x141f5c(0xf7)+_0xbf29e9[_0x141f5c(0x127)]+_0x141f5c(0xdb)),await _0x5a799c[_0x141f5c(0xbc)]['create'](hooks_utils_1['HooksUtils']['createHookPayload'](this['config'][_0x141f5c(0xc7)],_0x5a799c[_0x141f5c(0xbc)],this[_0x141f5c(0xee)][_0x141f5c(0x10f)],_0x398be9)));}return this[_0x141f5c(0x10c)][_0x141f5c(0x10e)](_0x5a799c),_0x5a799c;}async[a112_0x2a0b5b(0xed)](){const _0x2e6cb3=a112_0x2a0b5b;this[_0x2e6cb3(0xff)]=typedi_1[_0x2e6cb3(0xfe)][_0x2e6cb3(0xc1)](providers_tokens_1[_0x2e6cb3(0x10a)]['gitApiService']),this['repoService']=typedi_1['Container'][_0x2e6cb3(0xc1)](providers_tokens_1[_0x2e6cb3(0x10a)][_0x2e6cb3(0xe7)]),this[_0x2e6cb3(0xee)]=typedi_1['Container'][_0x2e6cb3(0xc1)](providers_tokens_1[_0x2e6cb3(0x10a)][_0x2e6cb3(0xee)]),this[_0x2e6cb3(0x117)]=typedi_1[_0x2e6cb3(0xfe)][_0x2e6cb3(0xc1)](providers_tokens_1[_0x2e6cb3(0x10a)][_0x2e6cb3(0x115)]),this['prefix']='['+SyncService_1[_0x2e6cb3(0x100)]+_0x2e6cb3(0xdc)+this[_0x2e6cb3(0xee)][_0x2e6cb3(0xc7)]['toUpperCase']()+']',this[_0x2e6cb3(0x124)][_0x2e6cb3(0xf9)](this[_0x2e6cb3(0x117)]['getLoggerId']());try{this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this[_0x2e6cb3(0xb8)]+'\x20Start\x20sync\x20job.'),await this[_0x2e6cb3(0x117)]['log'](this['prefix']+'\x20Getting\x20repository\x20records.')[_0x2e6cb3(0xcf)]();const _0x594e03=await this[_0x2e6cb3(0xd6)][_0x2e6cb3(0xf6)](typedi_1[_0x2e6cb3(0xfe)][_0x2e6cb3(0xc1)](providers_tokens_1[_0x2e6cb3(0x10a)]['connectionId']));if(!_0x594e03['length'])throw new bad_request_error_1['BadRequestError'](this['prefix']+_0x2e6cb3(0xe4));await this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this['prefix']+_0x2e6cb3(0x122))[_0x2e6cb3(0xcf)]();const _0x111739=await this['salesforceSync']['getBranchRecords'](_0x594e03[_0x2e6cb3(0x10b)](_0x13c42b=>'\x27'+_0x13c42b['repositoryId']+'\x27')[_0x2e6cb3(0xc5)](','));await this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this[_0x2e6cb3(0xb8)]+_0x2e6cb3(0xce))[_0x2e6cb3(0xcf)](),this[_0x2e6cb3(0x10c)]=await this[_0x2e6cb3(0x10d)][_0x2e6cb3(0xe0)]();const _0x5b3072=[..._0x594e03,..._0x111739];this['sfLogger'][_0x2e6cb3(0x121)](this[_0x2e6cb3(0xb8)]+'\x20Have\x20to\x20synchronize\x20'+_0x5b3072[_0x2e6cb3(0xc2)]+_0x2e6cb3(0x119));for(const _0x2daae0 of _0x5b3072){this[_0x2e6cb3(0x115)][_0x2e6cb3(0x121)](_0x2e6cb3(0x106)+_0x2daae0['repositoryName']+'['+_0x2daae0['repositoryId']+_0x2e6cb3(0xb7)+_0x2daae0['branchName']+'['+_0x2daae0[_0x2e6cb3(0x125)]+_0x2e6cb3(0xc0)),this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this[_0x2e6cb3(0xb8)]+'\x20Syncing\x20repository:\x20\x22'+_0x2daae0['repositoryName']+_0x2e6cb3(0xe3)+_0x2daae0[_0x2e6cb3(0x128)]+'\x22.'),this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this[_0x2e6cb3(0xb8)]+_0x2e6cb3(0x113));const _0x39de34=await this[_0x2e6cb3(0xcb)](_0x2daae0);if(!_0x39de34)continue;this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this[_0x2e6cb3(0xb8)]+_0x2e6cb3(0xb6));const _0x40cfb6=await this[_0x2e6cb3(0x102)](_0x2daae0);if(_0x40cfb6)continue;await this['sfLogger'][_0x2e6cb3(0xcf)]();let _0x25cdc4;try{await this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this['prefix']+_0x2e6cb3(0xd9))['send'](),_0x25cdc4=await this[_0x2e6cb3(0xfc)](_0x2daae0,typedi_1[_0x2e6cb3(0xfe)][_0x2e6cb3(0xc1)](providers_tokens_1[_0x2e6cb3(0x10a)][_0x2e6cb3(0x12b)]));}catch(_0xfece87){await this[_0x2e6cb3(0x109)](_0x2daae0,_0xfece87 instanceof too_many_requests_error_1[_0x2e6cb3(0xe6)]?_0xfece87:new Error(_0x2e6cb3(0x107)+_0xfece87));continue;}await this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this['prefix']+'\x20Completed\x20prepare\x20to\x20syncing.')['send']();if(_0x2daae0[_0x2e6cb3(0xe9)]===flosum_repository_sync_dto_1[_0x2e6cb3(0xf5)]['FlosumToGit']){const _0x23f259=typedi_1[_0x2e6cb3(0xfe)][_0x2e6cb3(0xc1)](flosum_sync_job_1['FlosumSyncJob']);await _0x23f259[_0x2e6cb3(0xed)]({'repository':_0x25cdc4,'convertToSFDX':this[_0x2e6cb3(0xee)][_0x2e6cb3(0xf8)],'syncRecord':_0x2daae0,'provider':this[_0x2e6cb3(0xee)][_0x2e6cb3(0xc7)]})[_0x2e6cb3(0xda)](_0x5236ac=>this[_0x2e6cb3(0x109)](_0x2daae0,_0x5236ac));}else{const _0x4efcc8=typedi_1[_0x2e6cb3(0xfe)][_0x2e6cb3(0xc1)](git_sync_job_1[_0x2e6cb3(0xf2)]);await _0x4efcc8[_0x2e6cb3(0xed)]({'repository':_0x25cdc4,'branch':_0x2daae0[_0x2e6cb3(0x128)],'provider':this['config'][_0x2e6cb3(0xc7)],'repositoryGit':_0x25cdc4[_0x2e6cb3(0x105)],'syncRecord':_0x2daae0})[_0x2e6cb3(0xda)](_0xed5f2b=>this['handleRecordSyncError'](_0x2daae0,_0xed5f2b));}}}catch(_0x396939){this[_0x2e6cb3(0x115)]['error'](_0x396939);_0x396939 instanceof too_many_requests_error_1['TooManyRequests']?(await this[_0x2e6cb3(0x117)][_0x2e6cb3(0x121)](this['prefix']+_0x2e6cb3(0xd2))[_0x2e6cb3(0xcf)](),await(0x0,utils_1[_0x2e6cb3(0xec)])(0x3c*0x3c*0x3e8),this['run']()):await this['sfLogger']['error'](this['prefix']+_0x2e6cb3(0x12d)+_0x396939)[_0x2e6cb3(0xcf)]();return;}await this[_0x2e6cb3(0x117)]['log'](this[_0x2e6cb3(0xb8)]+_0x2e6cb3(0x103))[_0x2e6cb3(0xcf)](),await this['salesforceSync'][_0x2e6cb3(0x118)](typedi_1[_0x2e6cb3(0xfe)]['get'](providers_tokens_1[_0x2e6cb3(0x10a)][_0x2e6cb3(0x12b)]))[_0x2e6cb3(0xda)](()=>null);}};SyncService=SyncService_1=__decorate([(0x0,typedi_1[a112_0x2a0b5b(0x11f)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a112_0x2a0b5b(0x112)],salesforce_sync_service_1[a112_0x2a0b5b(0x11a)]])],SyncService),exports[a112_0x2a0b5b(0xde)]=SyncService;