const a158_0x4e92cc=a158_0x3607;function a158_0x2ebf(){const _0x45e57a=['Tokens','BitbucketApiService','8DKSXvM','typedi','credentials','now','573003SLKJPG','/site/oauth2/access_token','defineProperty','checkAccessToken','url','search','pathname','metadata','axios','accessTokenExpiresAt','setAccessToken','../credentials/dto/bitbucket-credentials.dto','__decorate','getCurrentUser','(((.+)+)+)+$','getOwnPropertyDescriptor','decorate','length','https://bitbucket.org','constructor','request','createRequest','747630DONFTc','getAuthorizationHeader','BitbucketCredentialsDto','47952fQDenX','getHeaders','URL','function','__metadata','use','60490TlkymI','../providers.tokens','312DGLZiP','password','object','348631frChEh','Authorization','username','isLoggedIn','Inject','__esModule','125671EMfvJi','user','toString','158193OsuGYa','./git-api.service','refreshToken'];a158_0x2ebf=function(){return _0x45e57a;};return a158_0x2ebf();}(function(_0x3d5d2d,_0x50d99c){const _0x33e611=a158_0x3607,_0x44cefb=_0x3d5d2d();while(!![]){try{const _0x38a4b9=parseInt(_0x33e611(0x17e))/0x1+parseInt(_0x33e611(0x1a6))/0x2+parseInt(_0x33e611(0x190))/0x3+parseInt(_0x33e611(0x18c))/0x4*(-parseInt(_0x33e611(0x179))/0x5)+parseInt(_0x33e611(0x1a9))/0x6+-parseInt(_0x33e611(0x184))/0x7+parseInt(_0x33e611(0x17b))/0x8*(-parseInt(_0x33e611(0x187))/0x9);if(_0x38a4b9===_0x50d99c)break;else _0x44cefb['push'](_0x44cefb['shift']());}catch(_0x2f5029){_0x44cefb['push'](_0x44cefb['shift']());}}}(a158_0x2ebf,0x2f4fb));function a158_0x3607(_0x528f4f,_0x62ab5f){const _0x33336b=a158_0x2ebf();return a158_0x3607=function(_0x3107a1,_0x1ad944){_0x3107a1=_0x3107a1-0x177;let _0x2ebfe5=_0x33336b[_0x3107a1];return _0x2ebfe5;},a158_0x3607(_0x528f4f,_0x62ab5f);}const a158_0x1ad944=(function(){let _0x507c00=!![];return function(_0x1e3f48,_0x12185a){const _0x4f3d09=_0x507c00?function(){if(_0x12185a){const _0x163c85=_0x12185a['apply'](_0x1e3f48,arguments);return _0x12185a=null,_0x163c85;}}:function(){};return _0x507c00=![],_0x4f3d09;};}()),a158_0x3107a1=a158_0x1ad944(this,function(){const _0x3bcab5=a158_0x3607;return a158_0x3107a1[_0x3bcab5(0x186)]()[_0x3bcab5(0x195)](_0x3bcab5(0x19e))['toString']()[_0x3bcab5(0x1a3)](a158_0x3107a1)[_0x3bcab5(0x195)](_0x3bcab5(0x19e));});a158_0x3107a1();'use strict';var __decorate=this&&this[a158_0x4e92cc(0x19c)]||function(_0x2ecad8,_0x3e3b65,_0x3cf150,_0xadba62){const _0x2f1aee=a158_0x4e92cc;var _0x3e602b=arguments[_0x2f1aee(0x1a1)],_0xca248c=_0x3e602b<0x3?_0x3e3b65:_0xadba62===null?_0xadba62=Object[_0x2f1aee(0x19f)](_0x3e3b65,_0x3cf150):_0xadba62,_0x59fe60;if(typeof Reflect===_0x2f1aee(0x17d)&&typeof Reflect[_0x2f1aee(0x1a0)]===_0x2f1aee(0x1ac))_0xca248c=Reflect[_0x2f1aee(0x1a0)](_0x2ecad8,_0x3e3b65,_0x3cf150,_0xadba62);else{for(var _0x32d2b0=_0x2ecad8[_0x2f1aee(0x1a1)]-0x1;_0x32d2b0>=0x0;_0x32d2b0--)if(_0x59fe60=_0x2ecad8[_0x32d2b0])_0xca248c=(_0x3e602b<0x3?_0x59fe60(_0xca248c):_0x3e602b>0x3?_0x59fe60(_0x3e3b65,_0x3cf150,_0xca248c):_0x59fe60(_0x3e3b65,_0x3cf150))||_0xca248c;}return _0x3e602b>0x3&&_0xca248c&&Object[_0x2f1aee(0x192)](_0x3e3b65,_0x3cf150,_0xca248c),_0xca248c;},__metadata=this&&this[a158_0x4e92cc(0x177)]||function(_0xd7f25b,_0x2fbcac){const _0x8c960=a158_0x4e92cc;if(typeof Reflect===_0x8c960(0x17d)&&typeof Reflect[_0x8c960(0x197)]===_0x8c960(0x1ac))return Reflect[_0x8c960(0x197)](_0xd7f25b,_0x2fbcac);},__param=this&&this['__param']||function(_0x54b0d7,_0x14b162){return function(_0x15768a,_0x46f562){_0x14b162(_0x15768a,_0x46f562,_0x54b0d7);};},__importDefault=this&&this['__importDefault']||function(_0x1427a7){const _0x43051b=a158_0x4e92cc;return _0x1427a7&&_0x1427a7[_0x43051b(0x183)]?_0x1427a7:{'default':_0x1427a7};};Object[a158_0x4e92cc(0x192)](exports,a158_0x4e92cc(0x183),{'value':!![]}),exports['BitbucketApiService']=void 0x0;const axios_1=__importDefault(require(a158_0x4e92cc(0x198))),typedi_1=require(a158_0x4e92cc(0x18d)),git_api_service_1=require(a158_0x4e92cc(0x188)),bitbucket_credentials_dto_1=require(a158_0x4e92cc(0x19b)),providers_tokens_1=require(a158_0x4e92cc(0x17a)),git_provider_1=require('../types/git-provider'),url_1=require(a158_0x4e92cc(0x194));let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x1be379,_0x57e400){const _0x3c8aec=a158_0x4e92cc;super(_0x1be379,_0x57e400),this[_0x3c8aec(0x199)]=-0x1,this['MAX_REQUEST_PER_HOUR']=0x3e8;}[a158_0x4e92cc(0x1a5)](_0xa4cb8d){const _0x2bad42=a158_0x4e92cc,_0x1577d5=super[_0x2bad42(0x1a5)](_0xa4cb8d);return _0x1577d5['interceptors'][_0x2bad42(0x1a4)][_0x2bad42(0x178)](async _0x5ef67e=>{const _0x47d030=_0x2bad42;return await this[_0x47d030(0x193)](),_0x5ef67e['headers'][_0x47d030(0x17f)]=this[_0x47d030(0x18e)][_0x47d030(0x1a7)](),_0x5ef67e;}),_0x1577d5;}async[a158_0x4e92cc(0x193)](){const _0x4f16c3=a158_0x4e92cc;if(Date[_0x4f16c3(0x18f)]()<this[_0x4f16c3(0x199)])return;await this[_0x4f16c3(0x189)]();}async[a158_0x4e92cc(0x189)](){const _0x5406eb=a158_0x4e92cc,{clientId:_0x5d44c7,clientSecret:_0x45eda9}=this[_0x5406eb(0x18e)],_0x165caa=new url_1[(_0x5406eb(0x1ab))](_0x5406eb(0x1a2));_0x165caa[_0x5406eb(0x180)]=_0x5d44c7,_0x165caa[_0x5406eb(0x17c)]=_0x45eda9,_0x165caa[_0x5406eb(0x196)]=_0x5406eb(0x191);const {data:_0x5d41bf}=await axios_1['default']['post'](_0x165caa['toString'](),'grant_type=client_credentials'),{expires_in:_0x3273ca,access_token:_0x573a6b}=_0x5d41bf;this[_0x5406eb(0x199)]=Date['now']()+_0x3273ca*0x3e8,this[_0x5406eb(0x18e)][_0x5406eb(0x19a)](_0x573a6b);}[a158_0x4e92cc(0x1aa)](){return{};}[a158_0x4e92cc(0x19d)](){const _0x5bed4b=a158_0x4e92cc;return this[_0x5bed4b(0x1a4)]['get'](_0x5bed4b(0x185));}async[a158_0x4e92cc(0x181)](){return await this['getCurrentUser'](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1['Service'])(),__param(0x0,(0x0,typedi_1[a158_0x4e92cc(0x182)])(providers_tokens_1[a158_0x4e92cc(0x18a)]['provider'])),__param(0x1,(0x0,typedi_1[a158_0x4e92cc(0x182)])(providers_tokens_1['Tokens'][a158_0x4e92cc(0x18e)])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1[a158_0x4e92cc(0x1a8)]])],BitbucketApiService),exports[a158_0x4e92cc(0x18b)]=BitbucketApiService;