const a163_0x44727d=a163_0x1ffd;(function(_0x5ccb97,_0x5d69f9){const _0x2c51fb=a163_0x1ffd,_0x39c022=_0x5ccb97();while(!![]){try{const _0x537757=parseInt(_0x2c51fb(0x7a))/0x1+-parseInt(_0x2c51fb(0x8f))/0x2+-parseInt(_0x2c51fb(0x71))/0x3+-parseInt(_0x2c51fb(0x84))/0x4*(parseInt(_0x2c51fb(0x95))/0x5)+-parseInt(_0x2c51fb(0x91))/0x6+-parseInt(_0x2c51fb(0x89))/0x7+parseInt(_0x2c51fb(0x78))/0x8;if(_0x537757===_0x5d69f9)break;else _0x39c022['push'](_0x39c022['shift']());}catch(_0x16e7c6){_0x39c022['push'](_0x39c022['shift']());}}}(a163_0x394c,0xa7567));const a163_0x451bb5=(function(){let _0x1d4f55=!![];return function(_0x5e9a40,_0x4cc23e){const _0x3635d2=_0x1d4f55?function(){if(_0x4cc23e){const _0x55497b=_0x4cc23e['apply'](_0x5e9a40,arguments);return _0x4cc23e=null,_0x55497b;}}:function(){};return _0x1d4f55=![],_0x3635d2;};}()),a163_0x4a59bc=a163_0x451bb5(this,function(){const _0x5e8353=a163_0x1ffd;return a163_0x4a59bc['toString']()[_0x5e8353(0x96)](_0x5e8353(0x7b))[_0x5e8353(0x8d)]()['constructor'](a163_0x4a59bc)[_0x5e8353(0x96)](_0x5e8353(0x7b));});a163_0x4a59bc();'use strict';function a163_0x394c(){const _0x52574c=['object','2043295NyxYOM','search','length','Inject','password','provider','credentials','url','https://bitbucket.org','typedi','isLoggedIn','__importDefault','request','MAX_REQUEST_PER_HOUR','GitApiService','__decorate','createRequest','metadata','decorate','1919685yCZqUp','pathname','setAccessToken','getOwnPropertyDescriptor','getHeaders','get','design:paramtypes','27377680DxylkK','axios','1469VYTNnr','(((.+)+)+)+$','Tokens','getAuthorizationHeader','default','grant_type=client_credentials','URL','./git-api.service','../providers.tokens','now','4BHhCrX','defineProperty','BitbucketApiService','function','__esModule','1644041rPLQdf','checkAccessToken','BitbucketCredentialsDto','/site/oauth2/access_token','toString','user','1872412UMqlVu','use','3111846HLGNgK','accessTokenExpiresAt','refreshToken'];a163_0x394c=function(){return _0x52574c;};return a163_0x394c();}function a163_0x1ffd(_0x47899d,_0x21bb7c){const _0x59d8e6=a163_0x394c();return a163_0x1ffd=function(_0x4a59bc,_0x451bb5){_0x4a59bc=_0x4a59bc-0x71;let _0x394c19=_0x59d8e6[_0x4a59bc];return _0x394c19;},a163_0x1ffd(_0x47899d,_0x21bb7c);}var __decorate=this&&this[a163_0x44727d(0xa4)]||function(_0x46335c,_0x240952,_0x30ec25,_0x53808d){const _0x575d5a=a163_0x44727d;var _0x5de61c=arguments['length'],_0x1270a1=_0x5de61c<0x3?_0x240952:_0x53808d===null?_0x53808d=Object[_0x575d5a(0x74)](_0x240952,_0x30ec25):_0x53808d,_0x43e4ed;if(typeof Reflect===_0x575d5a(0x94)&&typeof Reflect[_0x575d5a(0xa7)]==='function')_0x1270a1=Reflect[_0x575d5a(0xa7)](_0x46335c,_0x240952,_0x30ec25,_0x53808d);else{for(var _0x3f3e6b=_0x46335c[_0x575d5a(0x97)]-0x1;_0x3f3e6b>=0x0;_0x3f3e6b--)if(_0x43e4ed=_0x46335c[_0x3f3e6b])_0x1270a1=(_0x5de61c<0x3?_0x43e4ed(_0x1270a1):_0x5de61c>0x3?_0x43e4ed(_0x240952,_0x30ec25,_0x1270a1):_0x43e4ed(_0x240952,_0x30ec25))||_0x1270a1;}return _0x5de61c>0x3&&_0x1270a1&&Object[_0x575d5a(0x85)](_0x240952,_0x30ec25,_0x1270a1),_0x1270a1;},__metadata=this&&this['__metadata']||function(_0x1f2dbb,_0x46d418){const _0x93eecc=a163_0x44727d;if(typeof Reflect===_0x93eecc(0x94)&&typeof Reflect[_0x93eecc(0xa6)]===_0x93eecc(0x87))return Reflect[_0x93eecc(0xa6)](_0x1f2dbb,_0x46d418);},__param=this&&this['__param']||function(_0x3c0dfa,_0x5f452e){return function(_0x54c0e0,_0xccd056){_0x5f452e(_0x54c0e0,_0xccd056,_0x3c0dfa);};},__importDefault=this&&this[a163_0x44727d(0xa0)]||function(_0x1d2cfb){return _0x1d2cfb&&_0x1d2cfb['__esModule']?_0x1d2cfb:{'default':_0x1d2cfb};};Object[a163_0x44727d(0x85)](exports,a163_0x44727d(0x88),{'value':!![]}),exports[a163_0x44727d(0x86)]=void 0x0;const axios_1=__importDefault(require(a163_0x44727d(0x79))),typedi_1=require(a163_0x44727d(0x9e)),git_api_service_1=require(a163_0x44727d(0x81)),bitbucket_credentials_dto_1=require('../credentials/dto/bitbucket-credentials.dto'),providers_tokens_1=require(a163_0x44727d(0x82)),git_provider_1=require('../types/git-provider'),url_1=require(a163_0x44727d(0x9c));let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a163_0x44727d(0xa3)]{constructor(_0x42db38,_0x2ff15a){const _0x434bd3=a163_0x44727d;super(_0x42db38,_0x2ff15a),this[_0x434bd3(0x92)]=-0x1,this[_0x434bd3(0xa2)]=0x3e8;}[a163_0x44727d(0xa5)](_0x16dac0){const _0x1049d3=a163_0x44727d,_0xa4fac6=super[_0x1049d3(0xa5)](_0x16dac0);return _0xa4fac6['interceptors'][_0x1049d3(0xa1)][_0x1049d3(0x90)](async _0x19b5ed=>{const _0x2229c5=_0x1049d3;return await this[_0x2229c5(0x8a)](),_0x19b5ed['headers']['Authorization']=this[_0x2229c5(0x9b)][_0x2229c5(0x7d)](),_0x19b5ed;}),_0xa4fac6;}async[a163_0x44727d(0x8a)](){const _0x1937be=a163_0x44727d;if(Date[_0x1937be(0x83)]()<this[_0x1937be(0x92)])return;await this['refreshToken']();}async[a163_0x44727d(0x93)](){const _0xe72d21=a163_0x44727d,{clientId:_0x538c3c,clientSecret:_0x8feda5}=this[_0xe72d21(0x9b)],_0x5a6395=new url_1[(_0xe72d21(0x80))](_0xe72d21(0x9d));_0x5a6395['username']=_0x538c3c,_0x5a6395[_0xe72d21(0x99)]=_0x8feda5,_0x5a6395[_0xe72d21(0x72)]=_0xe72d21(0x8c);const {data:_0x5e1dac}=await axios_1[_0xe72d21(0x7e)]['post'](_0x5a6395[_0xe72d21(0x8d)](),_0xe72d21(0x7f)),{expires_in:_0x173ae2,access_token:_0x363814}=_0x5e1dac;this[_0xe72d21(0x92)]=Date[_0xe72d21(0x83)]()+_0x173ae2*0x3e8,this[_0xe72d21(0x9b)][_0xe72d21(0x73)](_0x363814);}[a163_0x44727d(0x75)](){return{};}['getCurrentUser'](){const _0x3e061c=a163_0x44727d;return this[_0x3e061c(0xa1)][_0x3e061c(0x76)](_0x3e061c(0x8e));}async[a163_0x44727d(0x9f)](){return await this['getCurrentUser'](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1['Service'])(),__param(0x0,(0x0,typedi_1[a163_0x44727d(0x98)])(providers_tokens_1[a163_0x44727d(0x7c)][a163_0x44727d(0x9a)])),__param(0x1,(0x0,typedi_1[a163_0x44727d(0x98)])(providers_tokens_1[a163_0x44727d(0x7c)][a163_0x44727d(0x9b)])),__metadata(a163_0x44727d(0x77),[String,bitbucket_credentials_dto_1[a163_0x44727d(0x8b)]])],BitbucketApiService),exports[a163_0x44727d(0x86)]=BitbucketApiService;