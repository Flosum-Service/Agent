const a163_0x39e252=a163_0x1469;(function(_0x4da211,_0x4b0f5c){const _0x5e8f04=a163_0x1469,_0x5aee22=_0x4da211();while(!![]){try{const _0xeaf04d=-parseInt(_0x5e8f04(0xd4))/0x1+parseInt(_0x5e8f04(0xfc))/0x2+parseInt(_0x5e8f04(0xe2))/0x3*(-parseInt(_0x5e8f04(0xd3))/0x4)+parseInt(_0x5e8f04(0xcb))/0x5*(-parseInt(_0x5e8f04(0xcc))/0x6)+parseInt(_0x5e8f04(0xfb))/0x7+-parseInt(_0x5e8f04(0xc5))/0x8+parseInt(_0x5e8f04(0xfa))/0x9*(parseInt(_0x5e8f04(0xf6))/0xa);if(_0xeaf04d===_0x4b0f5c)break;else _0x5aee22['push'](_0x5aee22['shift']());}catch(_0x56f893){_0x5aee22['push'](_0x5aee22['shift']());}}}(a163_0x4f80,0x8e0f0));const a163_0x5ba6f0=(function(){let _0x2e4079=!![];return function(_0x249e01,_0x5ca929){const _0x518645=_0x2e4079?function(){const _0x4b31c2=a163_0x1469;if(_0x5ca929){const _0x1e74e1=_0x5ca929[_0x4b31c2(0xf2)](_0x249e01,arguments);return _0x5ca929=null,_0x1e74e1;}}:function(){};return _0x2e4079=![],_0x518645;};}()),a163_0x5a302d=a163_0x5ba6f0(this,function(){const _0x411613=a163_0x1469;return a163_0x5a302d[_0x411613(0xf3)]()[_0x411613(0xec)](_0x411613(0xf8))[_0x411613(0xf3)]()['constructor'](a163_0x5a302d)[_0x411613(0xec)](_0x411613(0xf8));});a163_0x5a302d();'use strict';var __decorate=this&&this[a163_0x39e252(0xf9)]||function(_0x306086,_0x4f229a,_0x560df7,_0x16716){const _0x4f675b=a163_0x39e252;var _0x2599d2=arguments[_0x4f675b(0xd6)],_0x30351c=_0x2599d2<0x3?_0x4f229a:_0x16716===null?_0x16716=Object[_0x4f675b(0xe9)](_0x4f229a,_0x560df7):_0x16716,_0x3d60c7;if(typeof Reflect===_0x4f675b(0xc9)&&typeof Reflect['decorate']==='function')_0x30351c=Reflect[_0x4f675b(0xd8)](_0x306086,_0x4f229a,_0x560df7,_0x16716);else{for(var _0x5042a5=_0x306086['length']-0x1;_0x5042a5>=0x0;_0x5042a5--)if(_0x3d60c7=_0x306086[_0x5042a5])_0x30351c=(_0x2599d2<0x3?_0x3d60c7(_0x30351c):_0x2599d2>0x3?_0x3d60c7(_0x4f229a,_0x560df7,_0x30351c):_0x3d60c7(_0x4f229a,_0x560df7))||_0x30351c;}return _0x2599d2>0x3&&_0x30351c&&Object[_0x4f675b(0xf4)](_0x4f229a,_0x560df7,_0x30351c),_0x30351c;},__metadata=this&&this['__metadata']||function(_0x5d34fc,_0x533a01){const _0x1212fc=a163_0x39e252;if(typeof Reflect===_0x1212fc(0xc9)&&typeof Reflect['metadata']===_0x1212fc(0xe3))return Reflect[_0x1212fc(0xd2)](_0x5d34fc,_0x533a01);},__param=this&&this[a163_0x39e252(0xfd)]||function(_0x8b22c2,_0x3db753){return function(_0x32fa20,_0x3624dd){_0x3db753(_0x32fa20,_0x3624dd,_0x8b22c2);};},__importDefault=this&&this[a163_0x39e252(0xdd)]||function(_0x22bb9b){const _0x2141d7=a163_0x39e252;return _0x22bb9b&&_0x22bb9b[_0x2141d7(0xe5)]?_0x22bb9b:{'default':_0x22bb9b};};Object[a163_0x39e252(0xf4)](exports,a163_0x39e252(0xe5),{'value':!![]}),exports[a163_0x39e252(0xe6)]=void 0x0;const axios_1=__importDefault(require(a163_0x39e252(0xce))),typedi_1=require('typedi'),git_api_service_1=require(a163_0x39e252(0xde)),bitbucket_credentials_dto_1=require('../credentials/dto/bitbucket-credentials.dto'),providers_tokens_1=require(a163_0x39e252(0xf5)),git_provider_1=require(a163_0x39e252(0xe8)),url_1=require(a163_0x39e252(0xcf));let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x9440e4,_0x4e9897){const _0x1486b7=a163_0x39e252;super(_0x9440e4,_0x4e9897),this[_0x1486b7(0xcd)]=-0x1,this[_0x1486b7(0xea)]=0x3e8;}[a163_0x39e252(0xd7)](_0x391575){const _0x5485a9=a163_0x39e252,_0x51c1b0=super[_0x5485a9(0xd7)](_0x391575);return _0x51c1b0['interceptors'][_0x5485a9(0xd0)]['use'](async _0xf14a7b=>{const _0x27decf=_0x5485a9;return await this[_0x27decf(0xca)](),_0xf14a7b[_0x27decf(0xf0)][_0x27decf(0xd9)]=this['credentials'][_0x27decf(0xc8)](),_0xf14a7b;}),_0x51c1b0;}async[a163_0x39e252(0xca)](){const _0x2c8ea6=a163_0x39e252;if(Date[_0x2c8ea6(0xdf)]()<this[_0x2c8ea6(0xcd)])return;await this[_0x2c8ea6(0xe7)]();}async[a163_0x39e252(0xe7)](){const _0x5afda7=a163_0x39e252,{clientId:_0x2d3faa,clientSecret:_0x36df59}=this['credentials'],_0x51e604=new url_1[(_0x5afda7(0xf1))](_0x5afda7(0xc4));_0x51e604[_0x5afda7(0xe1)]=_0x2d3faa,_0x51e604['password']=_0x36df59,_0x51e604['pathname']=_0x5afda7(0xd1);const {data:_0x19f08b}=await axios_1[_0x5afda7(0xf7)][_0x5afda7(0xc6)](_0x51e604[_0x5afda7(0xf3)](),'grant_type=client_credentials'),{expires_in:_0x1ef854,access_token:_0x4fea45}=_0x19f08b;this[_0x5afda7(0xcd)]=Date[_0x5afda7(0xdf)]()+_0x1ef854*0x3e8,this['credentials'][_0x5afda7(0xdb)](_0x4fea45);}[a163_0x39e252(0xee)](){return{};}['getCurrentUser'](){const _0x3092da=a163_0x39e252;return this[_0x3092da(0xd0)][_0x3092da(0xd5)](_0x3092da(0xed));}async['isLoggedIn'](){const _0x293ec6=a163_0x39e252;return await this[_0x293ec6(0xeb)](),!![];}};function a163_0x1469(_0x56f39e,_0x496e03){const _0xc78b2e=a163_0x4f80();return a163_0x1469=function(_0x5a302d,_0x5ba6f0){_0x5a302d=_0x5a302d-0xc3;let _0x4f80a2=_0xc78b2e[_0x5a302d];return _0x4f80a2;},a163_0x1469(_0x56f39e,_0x496e03);}function a163_0x4f80(){const _0x44d94a=['design:paramtypes','__esModule','BitbucketApiService','refreshToken','../types/git-provider','getOwnPropertyDescriptor','MAX_REQUEST_PER_HOUR','getCurrentUser','search','user','getHeaders','provider','headers','URL','apply','toString','defineProperty','../providers.tokens','30MeRrXR','default','(((.+)+)+)+$','__decorate','7097256CApdsL','6321217yvczTE','790016TBfhEn','__param','credentials','https://bitbucket.org','7287032bDhZEL','post','BitbucketCredentialsDto','getAuthorizationHeader','object','checkAccessToken','565afxjDI','11004BTFDyK','accessTokenExpiresAt','axios','url','request','/site/oauth2/access_token','metadata','60wlotcB','1121263ZpYRdq','get','length','createRequest','decorate','Authorization','Inject','setAccessToken','Service','__importDefault','./git-api.service','now','Tokens','username','168507qHqIER','function'];a163_0x4f80=function(){return _0x44d94a;};return a163_0x4f80();}BitbucketApiService=__decorate([(0x0,typedi_1[a163_0x39e252(0xdc)])(),__param(0x0,(0x0,typedi_1[a163_0x39e252(0xda)])(providers_tokens_1[a163_0x39e252(0xe0)][a163_0x39e252(0xef)])),__param(0x1,(0x0,typedi_1[a163_0x39e252(0xda)])(providers_tokens_1[a163_0x39e252(0xe0)][a163_0x39e252(0xc3)])),__metadata(a163_0x39e252(0xe4),[String,bitbucket_credentials_dto_1[a163_0x39e252(0xc7)]])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;