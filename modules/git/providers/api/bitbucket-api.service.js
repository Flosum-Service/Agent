const a163_0xe85468=a163_0x483e;function a163_0x483e(_0x2ae640,_0x1d8e8f){const _0x3d6080=a163_0x5cfe();return a163_0x483e=function(_0x46c98b,_0x1ec27b){_0x46c98b=_0x46c98b-0x72;let _0x5cfedb=_0x3d6080[_0x46c98b];return _0x5cfedb;},a163_0x483e(_0x2ae640,_0x1d8e8f);}function a163_0x5cfe(){const _0x2ba7bc=['object','decorate','post','../credentials/dto/bitbucket-credentials.dto','BitbucketCredentialsDto','__esModule','30YkxtrD','(((.+)+)+)+$','Tokens','user','189nrAtUw','accessTokenExpiresAt','username','Service','metadata','GitApiService','toString','url','createRequest','use','../providers.tokens','apply','function','getAuthorizationHeader','interceptors','URL','defineProperty','BitbucketApiService','59160192LrUIhd','429672RZzkxV','./git-api.service','4JyBRwj','Inject','length','14065956QBThIK','now','1QlVjhO','372545BQGXyF','4688002hQZOzO','default','5609649RGMEqI','isLoggedIn','__importDefault','6UYAPPt','3276872UJLBlH','../types/git-provider','getHeaders','credentials','request','checkAccessToken','setAccessToken','__metadata','pathname','search','__decorate','refreshToken','Authorization'];a163_0x5cfe=function(){return _0x2ba7bc;};return a163_0x5cfe();}(function(_0x40176b,_0x25612a){const _0x193963=a163_0x483e,_0x574a20=_0x40176b();while(!![]){try{const _0x25df42=-parseInt(_0x193963(0x8f))/0x1*(parseInt(_0x193963(0x97))/0x2)+parseInt(_0x193963(0x93))/0x3*(parseInt(_0x193963(0x8a))/0x4)+parseInt(_0x193963(0x90))/0x5*(parseInt(_0x193963(0x96))/0x6)+-parseInt(_0x193963(0x75))/0x7*(parseInt(_0x193963(0x88))/0x8)+-parseInt(_0x193963(0x8d))/0x9+-parseInt(_0x193963(0xaa))/0xa*(parseInt(_0x193963(0x91))/0xb)+parseInt(_0x193963(0x87))/0xc;if(_0x25df42===_0x25612a)break;else _0x574a20['push'](_0x574a20['shift']());}catch(_0x122d40){_0x574a20['push'](_0x574a20['shift']());}}}(a163_0x5cfe,0xe690f));const a163_0x1ec27b=(function(){let _0x180a39=!![];return function(_0x33a764,_0x53721a){const _0x2ac73b=_0x180a39?function(){const _0x284460=a163_0x483e;if(_0x53721a){const _0x12beb7=_0x53721a[_0x284460(0x80)](_0x33a764,arguments);return _0x53721a=null,_0x12beb7;}}:function(){};return _0x180a39=![],_0x2ac73b;};}()),a163_0x46c98b=a163_0x1ec27b(this,function(){const _0x1a3bf0=a163_0x483e;return a163_0x46c98b[_0x1a3bf0(0x7b)]()[_0x1a3bf0(0xa0)](_0x1a3bf0(0x72))['toString']()['constructor'](a163_0x46c98b)[_0x1a3bf0(0xa0)](_0x1a3bf0(0x72));});a163_0x46c98b();'use strict';var __decorate=this&&this[a163_0xe85468(0xa1)]||function(_0x452deb,_0x4f1471,_0x5d2e75,_0x6b2926){const _0x4b99d2=a163_0xe85468;var _0x1a85d8=arguments['length'],_0xdaa00e=_0x1a85d8<0x3?_0x4f1471:_0x6b2926===null?_0x6b2926=Object['getOwnPropertyDescriptor'](_0x4f1471,_0x5d2e75):_0x6b2926,_0x5d4c53;if(typeof Reflect==='object'&&typeof Reflect[_0x4b99d2(0xa5)]===_0x4b99d2(0x81))_0xdaa00e=Reflect[_0x4b99d2(0xa5)](_0x452deb,_0x4f1471,_0x5d2e75,_0x6b2926);else{for(var _0x421159=_0x452deb[_0x4b99d2(0x8c)]-0x1;_0x421159>=0x0;_0x421159--)if(_0x5d4c53=_0x452deb[_0x421159])_0xdaa00e=(_0x1a85d8<0x3?_0x5d4c53(_0xdaa00e):_0x1a85d8>0x3?_0x5d4c53(_0x4f1471,_0x5d2e75,_0xdaa00e):_0x5d4c53(_0x4f1471,_0x5d2e75))||_0xdaa00e;}return _0x1a85d8>0x3&&_0xdaa00e&&Object[_0x4b99d2(0x85)](_0x4f1471,_0x5d2e75,_0xdaa00e),_0xdaa00e;},__metadata=this&&this[a163_0xe85468(0x9e)]||function(_0x35d238,_0x139472){const _0x49d288=a163_0xe85468;if(typeof Reflect===_0x49d288(0xa4)&&typeof Reflect[_0x49d288(0x79)]===_0x49d288(0x81))return Reflect['metadata'](_0x35d238,_0x139472);},__param=this&&this['__param']||function(_0x22616c,_0xb388e4){return function(_0x1bec19,_0x475438){_0xb388e4(_0x1bec19,_0x475438,_0x22616c);};},__importDefault=this&&this[a163_0xe85468(0x95)]||function(_0x243235){const _0x3b06c3=a163_0xe85468;return _0x243235&&_0x243235[_0x3b06c3(0xa9)]?_0x243235:{'default':_0x243235};};Object[a163_0xe85468(0x85)](exports,a163_0xe85468(0xa9),{'value':!![]}),exports[a163_0xe85468(0x86)]=void 0x0;const axios_1=__importDefault(require('axios')),typedi_1=require('typedi'),git_api_service_1=require(a163_0xe85468(0x89)),bitbucket_credentials_dto_1=require(a163_0xe85468(0xa7)),providers_tokens_1=require(a163_0xe85468(0x7f)),git_provider_1=require(a163_0xe85468(0x98)),url_1=require(a163_0xe85468(0x7c));let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a163_0xe85468(0x7a)]{constructor(_0xa61835,_0x181311){super(_0xa61835,_0x181311),this['accessTokenExpiresAt']=-0x1,this['MAX_REQUEST_PER_HOUR']=0x3e8;}[a163_0xe85468(0x7d)](_0x174a6d){const _0x25a183=a163_0xe85468,_0x570d1b=super[_0x25a183(0x7d)](_0x174a6d);return _0x570d1b[_0x25a183(0x83)]['request'][_0x25a183(0x7e)](async _0x3d867a=>{const _0x4f2ae8=_0x25a183;return await this[_0x4f2ae8(0x9c)](),_0x3d867a['headers'][_0x4f2ae8(0xa3)]=this[_0x4f2ae8(0x9a)][_0x4f2ae8(0x82)](),_0x3d867a;}),_0x570d1b;}async[a163_0xe85468(0x9c)](){const _0x180c6a=a163_0xe85468;if(Date[_0x180c6a(0x8e)]()<this['accessTokenExpiresAt'])return;await this[_0x180c6a(0xa2)]();}async[a163_0xe85468(0xa2)](){const _0x55c7da=a163_0xe85468,{clientId:_0x32df7f,clientSecret:_0x533eed}=this[_0x55c7da(0x9a)],_0x507986=new url_1[(_0x55c7da(0x84))]('https://bitbucket.org');_0x507986[_0x55c7da(0x77)]=_0x32df7f,_0x507986['password']=_0x533eed,_0x507986[_0x55c7da(0x9f)]='/site/oauth2/access_token';const {data:_0x3028a2}=await axios_1[_0x55c7da(0x92)][_0x55c7da(0xa6)](_0x507986[_0x55c7da(0x7b)](),'grant_type=client_credentials'),{expires_in:_0x4170c5,access_token:_0x4ef69e}=_0x3028a2;this[_0x55c7da(0x76)]=Date[_0x55c7da(0x8e)]()+_0x4170c5*0x3e8,this[_0x55c7da(0x9a)][_0x55c7da(0x9d)](_0x4ef69e);}[a163_0xe85468(0x99)](){return{};}['getCurrentUser'](){const _0x7ba179=a163_0xe85468;return this[_0x7ba179(0x9b)]['get'](_0x7ba179(0x74));}async[a163_0xe85468(0x94)](){return await this['getCurrentUser'](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a163_0xe85468(0x78)])(),__param(0x0,(0x0,typedi_1[a163_0xe85468(0x8b)])(providers_tokens_1[a163_0xe85468(0x73)]['provider'])),__param(0x1,(0x0,typedi_1[a163_0xe85468(0x8b)])(providers_tokens_1[a163_0xe85468(0x73)][a163_0xe85468(0x9a)])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1[a163_0xe85468(0xa8)]])],BitbucketApiService),exports[a163_0xe85468(0x86)]=BitbucketApiService;