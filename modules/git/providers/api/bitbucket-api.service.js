const a124_0x53743b=a124_0x5a99;(function(_0x545646,_0x2472ca){const _0xfd557a=a124_0x5a99,_0x5e6e8f=_0x545646();while(!![]){try{const _0x47b926=parseInt(_0xfd557a(0x12a))/0x1+-parseInt(_0xfd557a(0x12f))/0x2*(parseInt(_0xfd557a(0x122))/0x3)+-parseInt(_0xfd557a(0xfe))/0x4*(parseInt(_0xfd557a(0x101))/0x5)+-parseInt(_0xfd557a(0x12d))/0x6*(-parseInt(_0xfd557a(0x105))/0x7)+parseInt(_0xfd557a(0x11f))/0x8+-parseInt(_0xfd557a(0x10e))/0x9+parseInt(_0xfd557a(0x111))/0xa*(parseInt(_0xfd557a(0x11e))/0xb);if(_0x47b926===_0x2472ca)break;else _0x5e6e8f['push'](_0x5e6e8f['shift']());}catch(_0x28eec4){_0x5e6e8f['push'](_0x5e6e8f['shift']());}}}(a124_0x45d4,0x83145));const a124_0x2d57c0=(function(){let _0x638ff8=!![];return function(_0x429707,_0x268e51){const _0x2896b4=_0x638ff8?function(){const _0x1b85b8=a124_0x5a99;if(_0x268e51){const _0x482cd5=_0x268e51[_0x1b85b8(0x12e)](_0x429707,arguments);return _0x268e51=null,_0x482cd5;}}:function(){};return _0x638ff8=![],_0x2896b4;};}()),a124_0x4579eb=a124_0x2d57c0(this,function(){const _0x29b681=a124_0x5a99;return a124_0x4579eb[_0x29b681(0x12b)]()[_0x29b681(0x11c)]('(((.+)+)+)+$')[_0x29b681(0x12b)]()[_0x29b681(0x119)](a124_0x4579eb)['search']('(((.+)+)+)+$');});a124_0x4579eb();function a124_0x5a99(_0x23d2fb,_0x32a60f){const _0x2088df=a124_0x45d4();return a124_0x5a99=function(_0x4579eb,_0x2d57c0){_0x4579eb=_0x4579eb-0xfc;let _0x45d45d=_0x2088df[_0x4579eb];return _0x45d45d;},a124_0x5a99(_0x23d2fb,_0x32a60f);}'use strict';var __decorate=this&&this[a124_0x53743b(0x117)]||function(_0x5a9c9d,_0x3ae2ee,_0x54e9d6,_0x325691){const _0x2fd7f7=a124_0x53743b;var _0x117857=arguments[_0x2fd7f7(0x12c)],_0x4bd570=_0x117857<0x3?_0x3ae2ee:_0x325691===null?_0x325691=Object[_0x2fd7f7(0x129)](_0x3ae2ee,_0x54e9d6):_0x325691,_0x3e6a1f;if(typeof Reflect==='object'&&typeof Reflect[_0x2fd7f7(0x118)]===_0x2fd7f7(0x135))_0x4bd570=Reflect['decorate'](_0x5a9c9d,_0x3ae2ee,_0x54e9d6,_0x325691);else{for(var _0x5598e1=_0x5a9c9d['length']-0x1;_0x5598e1>=0x0;_0x5598e1--)if(_0x3e6a1f=_0x5a9c9d[_0x5598e1])_0x4bd570=(_0x117857<0x3?_0x3e6a1f(_0x4bd570):_0x117857>0x3?_0x3e6a1f(_0x3ae2ee,_0x54e9d6,_0x4bd570):_0x3e6a1f(_0x3ae2ee,_0x54e9d6))||_0x4bd570;}return _0x117857>0x3&&_0x4bd570&&Object[_0x2fd7f7(0x126)](_0x3ae2ee,_0x54e9d6,_0x4bd570),_0x4bd570;},__metadata=this&&this[a124_0x53743b(0x109)]||function(_0xf930f6,_0x4ab34f){const _0x2bc9e6=a124_0x53743b;if(typeof Reflect===_0x2bc9e6(0x10a)&&typeof Reflect[_0x2bc9e6(0x132)]===_0x2bc9e6(0x135))return Reflect[_0x2bc9e6(0x132)](_0xf930f6,_0x4ab34f);},__param=this&&this['__param']||function(_0x42cd52,_0x28eea7){return function(_0x687ac8,_0x35291f){_0x28eea7(_0x687ac8,_0x35291f,_0x42cd52);};},__importDefault=this&&this[a124_0x53743b(0x137)]||function(_0x3bdbb0){return _0x3bdbb0&&_0x3bdbb0['__esModule']?_0x3bdbb0:{'default':_0x3bdbb0};};Object[a124_0x53743b(0x126)](exports,'__esModule',{'value':!![]}),exports[a124_0x53743b(0x131)]=void 0x0;const axios_1=__importDefault(require('axios')),typedi_1=require(a124_0x53743b(0x10c)),git_api_service_1=require(a124_0x53743b(0x10d)),bitbucket_credentials_dto_1=require(a124_0x53743b(0x120)),providers_tokens_1=require('../providers.tokens'),git_provider_1=require(a124_0x53743b(0x11d)),url_1=require(a124_0x53743b(0x108));let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a124_0x53743b(0x121)]{constructor(_0x4f3098,_0x148e54){const _0x1c3dae=a124_0x53743b;super(_0x4f3098,_0x148e54),this['accessTokenExpiresAt']=-0x1,this[_0x1c3dae(0x136)]=0x3e8;}[a124_0x53743b(0x110)](_0x59ab79){const _0x1e6ddc=a124_0x53743b,_0x4d710f=super[_0x1e6ddc(0x110)](_0x59ab79);return _0x4d710f[_0x1e6ddc(0x133)][_0x1e6ddc(0x107)][_0x1e6ddc(0x114)](async _0x3d71d4=>{const _0x5f17e1=_0x1e6ddc;return await this['checkAccessToken'](),_0x3d71d4[_0x5f17e1(0x128)]||(_0x3d71d4[_0x5f17e1(0x128)]={}),_0x3d71d4['headers'][_0x5f17e1(0x116)]=this['credentials']['getAuthorizationHeader'](),_0x3d71d4;}),_0x4d710f;}async[a124_0x53743b(0x130)](){const _0x2448e2=a124_0x53743b;if(Date[_0x2448e2(0x123)]()<this['accessTokenExpiresAt'])return;await this[_0x2448e2(0x125)]();}async[a124_0x53743b(0x125)](){const _0x2441d9=a124_0x53743b,{clientId:_0x4f80b9,clientSecret:_0x2918e3}=this[_0x2441d9(0x138)],_0x13838b=new url_1['URL'](_0x2441d9(0xfd));_0x13838b[_0x2441d9(0x104)]=_0x4f80b9,_0x13838b[_0x2441d9(0x10b)]=_0x2918e3,_0x13838b[_0x2441d9(0x112)]='/site/oauth2/access_token';const {data:_0x28e369}=await axios_1[_0x2441d9(0x11b)][_0x2441d9(0x113)](_0x13838b[_0x2441d9(0x12b)](),_0x2441d9(0x134)),{expires_in:_0x3a32ff,access_token:_0x233766}=_0x28e369;this[_0x2441d9(0x10f)]=Date['now']()+_0x3a32ff*0x3e8,this[_0x2441d9(0x138)][_0x2441d9(0x11a)](_0x233766);}[a124_0x53743b(0x106)](){return{};}['getCurrentUser'](){const _0x53a373=a124_0x53743b;return this[_0x53a373(0x107)][_0x53a373(0x124)](_0x53a373(0x127));}async['isLoggedIn'](){return await this['getCurrentUser'](),!![];}};function a124_0x45d4(){const _0x75247c=['password','typedi','./git-api.service','6724962mNRMBl','accessTokenExpiresAt','createRequest','1146040lRygDP','pathname','post','use','Service','Authorization','__decorate','decorate','constructor','setAccessToken','default','search','../types/git-provider','44ozUXjj','4249528PrmUBU','../credentials/dto/bitbucket-credentials.dto','GitApiService','9zKLZep','now','get','refreshToken','defineProperty','user','headers','getOwnPropertyDescriptor','616081ZmfSLX','toString','length','186IKVdNe','apply','352432GafmLv','checkAccessToken','BitbucketApiService','metadata','interceptors','grant_type=client_credentials','function','MAX_REQUEST_PER_HOUR','__importDefault','credentials','Inject','https://bitbucket.org','1895716qLtDve','design:paramtypes','BitbucketCredentialsDto','5Xlespe','provider','Tokens','username','153776lPQDzs','getHeaders','request','url','__metadata','object'];a124_0x45d4=function(){return _0x75247c;};return a124_0x45d4();}BitbucketApiService=__decorate([(0x0,typedi_1[a124_0x53743b(0x115)])(),__param(0x0,(0x0,typedi_1[a124_0x53743b(0xfc)])(providers_tokens_1[a124_0x53743b(0x103)][a124_0x53743b(0x102)])),__param(0x1,(0x0,typedi_1['Inject'])(providers_tokens_1[a124_0x53743b(0x103)][a124_0x53743b(0x138)])),__metadata(a124_0x53743b(0xff),[String,bitbucket_credentials_dto_1[a124_0x53743b(0x100)]])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;