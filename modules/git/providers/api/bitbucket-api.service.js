const a184_0x26e652=a184_0x4f3f;(function(_0x48c678,_0x3bb377){const _0x241330=a184_0x4f3f,_0x404727=_0x48c678();while(!![]){try{const _0x379990=parseInt(_0x241330(0xec))/0x1*(parseInt(_0x241330(0xe6))/0x2)+-parseInt(_0x241330(0xe1))/0x3+parseInt(_0x241330(0xfa))/0x4+parseInt(_0x241330(0xd3))/0x5+parseInt(_0x241330(0xd8))/0x6+parseInt(_0x241330(0xf0))/0x7*(-parseInt(_0x241330(0xd1))/0x8)+-parseInt(_0x241330(0xf7))/0x9;if(_0x379990===_0x3bb377)break;else _0x404727['push'](_0x404727['shift']());}catch(_0x59e819){_0x404727['push'](_0x404727['shift']());}}}(a184_0x39e5,0x2a8a3));const a184_0x58401a=(function(){let _0x2ef33a=!![];return function(_0x396934,_0x33ad41){const _0x4dd70b=_0x2ef33a?function(){const _0x9a3ff7=a184_0x4f3f;if(_0x33ad41){const _0x4d24b3=_0x33ad41[_0x9a3ff7(0xf3)](_0x396934,arguments);return _0x33ad41=null,_0x4d24b3;}}:function(){};return _0x2ef33a=![],_0x4dd70b;};}()),a184_0x54c639=a184_0x58401a(this,function(){const _0x2954b6=a184_0x4f3f;return a184_0x54c639[_0x2954b6(0xd6)]()[_0x2954b6(0xf9)]('(((.+)+)+)+$')[_0x2954b6(0xd6)]()[_0x2954b6(0xf1)](a184_0x54c639)[_0x2954b6(0xf9)](_0x2954b6(0xd9));});a184_0x54c639();'use strict';var __decorate=this&&this[a184_0x26e652(0xfb)]||function(_0xc5a1b5,_0x20daff,_0x5ccf48,_0x8cbec4){const _0x48619e=a184_0x26e652;var _0x52d24c=arguments[_0x48619e(0xc5)],_0x13ec36=_0x52d24c<0x3?_0x20daff:_0x8cbec4===null?_0x8cbec4=Object[_0x48619e(0xce)](_0x20daff,_0x5ccf48):_0x8cbec4,_0x29349a;if(typeof Reflect===_0x48619e(0xca)&&typeof Reflect[_0x48619e(0xe8)]===_0x48619e(0xe3))_0x13ec36=Reflect[_0x48619e(0xe8)](_0xc5a1b5,_0x20daff,_0x5ccf48,_0x8cbec4);else{for(var _0x23c777=_0xc5a1b5[_0x48619e(0xc5)]-0x1;_0x23c777>=0x0;_0x23c777--)if(_0x29349a=_0xc5a1b5[_0x23c777])_0x13ec36=(_0x52d24c<0x3?_0x29349a(_0x13ec36):_0x52d24c>0x3?_0x29349a(_0x20daff,_0x5ccf48,_0x13ec36):_0x29349a(_0x20daff,_0x5ccf48))||_0x13ec36;}return _0x52d24c>0x3&&_0x13ec36&&Object[_0x48619e(0xf5)](_0x20daff,_0x5ccf48,_0x13ec36),_0x13ec36;},__metadata=this&&this[a184_0x26e652(0xee)]||function(_0x31ab72,_0x5acb62){const _0x430b36=a184_0x26e652;if(typeof Reflect==='object'&&typeof Reflect[_0x430b36(0xcc)]===_0x430b36(0xe3))return Reflect[_0x430b36(0xcc)](_0x31ab72,_0x5acb62);},__param=this&&this[a184_0x26e652(0xf4)]||function(_0x4de289,_0x53aa57){return function(_0x19c139,_0x54878e){_0x53aa57(_0x19c139,_0x54878e,_0x4de289);};},__importDefault=this&&this['__importDefault']||function(_0xf947ae){return _0xf947ae&&_0xf947ae['__esModule']?_0xf947ae:{'default':_0xf947ae};};function a184_0x39e5(){const _0x5efe83=['__metadata','credentials','376187IiuERs','constructor','../credentials/dto/bitbucket-credentials.dto','apply','__param','defineProperty','getHeaders','2135268hZzrOl','headers','search','372316ghDwHY','__decorate','isLoggedIn','getCurrentUser','length','refreshToken','BitbucketCredentialsDto','https://bitbucket.org','design:paramtypes','object','now','metadata','BitbucketApiService','getOwnPropertyDescriptor','MAX_REQUEST_PER_HOUR','Inject','8nXlTXn','grant_type=client_credentials','1565740yUZGCY','accessTokenExpiresAt','use','toString','../types/git-provider','1417236zQxdgj','(((.+)+)+)+$','Authorization','password','../providers.tokens','createRequest','checkAccessToken','getAuthorizationHeader','provider','1002189IgcpGU','Tokens','function','post','URL','7652XJTtal','default','decorate','pathname','user','url','41npXZrN','request'];a184_0x39e5=function(){return _0x5efe83;};return a184_0x39e5();}Object[a184_0x26e652(0xf5)](exports,'__esModule',{'value':!![]}),exports[a184_0x26e652(0xcd)]=void 0x0;const axios_1=__importDefault(require('axios')),typedi_1=require('typedi'),git_api_service_1=require('./git-api.service'),bitbucket_credentials_dto_1=require(a184_0x26e652(0xf2)),providers_tokens_1=require(a184_0x26e652(0xdc)),git_provider_1=require(a184_0x26e652(0xd7)),url_1=require(a184_0x26e652(0xeb));let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x168e44,_0x4fbda0){const _0x45cacf=a184_0x26e652;super(_0x168e44,_0x4fbda0),this[_0x45cacf(0xd4)]=-0x1,this[_0x45cacf(0xcf)]=0x3e8;}['createRequest'](_0x517a8f){const _0x56c0ff=a184_0x26e652,_0x5f44af=super[_0x56c0ff(0xdd)](_0x517a8f);return _0x5f44af['interceptors'][_0x56c0ff(0xed)][_0x56c0ff(0xd5)](async _0x253d85=>{const _0x3fdd5a=_0x56c0ff;return await this[_0x3fdd5a(0xde)](),_0x253d85[_0x3fdd5a(0xf8)][_0x3fdd5a(0xda)]=this[_0x3fdd5a(0xef)][_0x3fdd5a(0xdf)](),_0x253d85;}),_0x5f44af;}async[a184_0x26e652(0xde)](){const _0x55ef2f=a184_0x26e652;if(Date[_0x55ef2f(0xcb)]()<this[_0x55ef2f(0xd4)])return;await this['refreshToken']();}async[a184_0x26e652(0xc6)](){const _0xcfdd3e=a184_0x26e652,{clientId:_0xe82cb,clientSecret:_0x2af219}=this[_0xcfdd3e(0xef)],_0x2c75e5=new url_1[(_0xcfdd3e(0xe5))](_0xcfdd3e(0xc8));_0x2c75e5['username']=_0xe82cb,_0x2c75e5[_0xcfdd3e(0xdb)]=_0x2af219,_0x2c75e5[_0xcfdd3e(0xe9)]='/site/oauth2/access_token';const {data:_0xdc4a9a}=await axios_1[_0xcfdd3e(0xe7)][_0xcfdd3e(0xe4)](_0x2c75e5[_0xcfdd3e(0xd6)](),_0xcfdd3e(0xd2)),{expires_in:_0x3aab93,access_token:_0x4128be}=_0xdc4a9a;this['accessTokenExpiresAt']=Date['now']()+_0x3aab93*0x3e8,this[_0xcfdd3e(0xef)]['setAccessToken'](_0x4128be);}[a184_0x26e652(0xf6)](){return{};}[a184_0x26e652(0xc4)](){const _0x3341c7=a184_0x26e652;return this[_0x3341c7(0xed)]['get'](_0x3341c7(0xea));}async[a184_0x26e652(0xfc)](){return await this['getCurrentUser'](),!![];}};function a184_0x4f3f(_0x250908,_0x447140){const _0x3b6258=a184_0x39e5();return a184_0x4f3f=function(_0x54c639,_0x58401a){_0x54c639=_0x54c639-0xc4;let _0x39e536=_0x3b6258[_0x54c639];return _0x39e536;},a184_0x4f3f(_0x250908,_0x447140);}BitbucketApiService=__decorate([(0x0,typedi_1['Service'])(),__param(0x0,(0x0,typedi_1[a184_0x26e652(0xd0)])(providers_tokens_1[a184_0x26e652(0xe2)][a184_0x26e652(0xe0)])),__param(0x1,(0x0,typedi_1[a184_0x26e652(0xd0)])(providers_tokens_1[a184_0x26e652(0xe2)][a184_0x26e652(0xef)])),__metadata(a184_0x26e652(0xc9),[String,bitbucket_credentials_dto_1[a184_0x26e652(0xc7)]])],BitbucketApiService),exports[a184_0x26e652(0xcd)]=BitbucketApiService;