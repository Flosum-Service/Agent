const a196_0x2b51a5=a196_0x2520;(function(_0x2f0313,_0x155cfb){const _0xe1ce02=a196_0x2520,_0x63369f=_0x2f0313();while(!![]){try{const _0x447d9f=-parseInt(_0xe1ce02(0x15e))/0x1+-parseInt(_0xe1ce02(0x18b))/0x2+parseInt(_0xe1ce02(0x16b))/0x3+-parseInt(_0xe1ce02(0x17c))/0x4+parseInt(_0xe1ce02(0x172))/0x5+-parseInt(_0xe1ce02(0x173))/0x6*(-parseInt(_0xe1ce02(0x160))/0x7)+parseInt(_0xe1ce02(0x183))/0x8;if(_0x447d9f===_0x155cfb)break;else _0x63369f['push'](_0x63369f['shift']());}catch(_0xfa6680){_0x63369f['push'](_0x63369f['shift']());}}}(a196_0x2ae7,0xe28e6));const a196_0xc3052d=(function(){let _0x4dbfcb=!![];return function(_0x45b00b,_0x17a242){const _0x599b56=_0x4dbfcb?function(){const _0x33f2df=a196_0x2520;if(_0x17a242){const _0x5a85be=_0x17a242[_0x33f2df(0x177)](_0x45b00b,arguments);return _0x17a242=null,_0x5a85be;}}:function(){};return _0x4dbfcb=![],_0x599b56;};}()),a196_0x22690c=a196_0xc3052d(this,function(){const _0x1a8999=a196_0x2520;return a196_0x22690c[_0x1a8999(0x164)]()[_0x1a8999(0x178)]('(((.+)+)+)+$')['toString']()[_0x1a8999(0x188)](a196_0x22690c)['search'](_0x1a8999(0x17a));});function a196_0x2520(_0x1bad46,_0xc11dca){const _0x1b86a1=a196_0x2ae7();return a196_0x2520=function(_0x22690c,_0xc3052d){_0x22690c=_0x22690c-0x15c;let _0x2ae719=_0x1b86a1[_0x22690c];return _0x2ae719;},a196_0x2520(_0x1bad46,_0xc11dca);}a196_0x22690c();function a196_0x2ae7(){const _0x2e74eb=['__param','function','apply','search','BitbucketCredentialsDto','(((.+)+)+)+$','createRequest','7270116rsvczk','user','../types/git-provider','request','now','BitbucketApiService','../providers.tokens','25832320hWKrOW','../credentials/dto/bitbucket-credentials.dto','Tokens','axios','credentials','constructor','./git-api.service','isLoggedIn','3146040YjpkUn','object','url','default','GitApiService','accessTokenExpiresAt','1589366qaESyn','pathname','1758953MdpycM','Inject','use','interceptors','toString','design:paramtypes','grant_type=client_credentials','Authorization','getCurrentUser','__importDefault','username','667683uaSoQQ','__esModule','https://bitbucket.org','provider','getAuthorizationHeader','refreshToken','defineProperty','7255860rRFoZP','24rkTSjN','MAX_REQUEST_PER_HOUR'];a196_0x2ae7=function(){return _0x2e74eb;};return a196_0x2ae7();}'use strict';var __decorate=this&&this['__decorate']||function(_0x10fe5f,_0x1f3c4b,_0x40325a,_0x288e33){const _0x1126fb=a196_0x2520;var _0x1c2b1e=arguments['length'],_0x4fc67e=_0x1c2b1e<0x3?_0x1f3c4b:_0x288e33===null?_0x288e33=Object['getOwnPropertyDescriptor'](_0x1f3c4b,_0x40325a):_0x288e33,_0x1980d9;if(typeof Reflect===_0x1126fb(0x18c)&&typeof Reflect['decorate']===_0x1126fb(0x176))_0x4fc67e=Reflect['decorate'](_0x10fe5f,_0x1f3c4b,_0x40325a,_0x288e33);else{for(var _0x465645=_0x10fe5f['length']-0x1;_0x465645>=0x0;_0x465645--)if(_0x1980d9=_0x10fe5f[_0x465645])_0x4fc67e=(_0x1c2b1e<0x3?_0x1980d9(_0x4fc67e):_0x1c2b1e>0x3?_0x1980d9(_0x1f3c4b,_0x40325a,_0x4fc67e):_0x1980d9(_0x1f3c4b,_0x40325a))||_0x4fc67e;}return _0x1c2b1e>0x3&&_0x4fc67e&&Object['defineProperty'](_0x1f3c4b,_0x40325a,_0x4fc67e),_0x4fc67e;},__metadata=this&&this['__metadata']||function(_0x387594,_0x31e3c7){const _0x5e5f48=a196_0x2520;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x5e5f48(0x176))return Reflect['metadata'](_0x387594,_0x31e3c7);},__param=this&&this[a196_0x2b51a5(0x175)]||function(_0x40c8d7,_0x5f0957){return function(_0x2d1fc5,_0xb9b90c){_0x5f0957(_0x2d1fc5,_0xb9b90c,_0x40c8d7);};},__importDefault=this&&this[a196_0x2b51a5(0x169)]||function(_0xf9b928){const _0xdba3b0=a196_0x2b51a5;return _0xf9b928&&_0xf9b928[_0xdba3b0(0x16c)]?_0xf9b928:{'default':_0xf9b928};};Object[a196_0x2b51a5(0x171)](exports,'__esModule',{'value':!![]}),exports[a196_0x2b51a5(0x181)]=void 0x0;const axios_1=__importDefault(require(a196_0x2b51a5(0x186))),typedi_1=require('typedi'),git_api_service_1=require(a196_0x2b51a5(0x189)),bitbucket_credentials_dto_1=require(a196_0x2b51a5(0x184)),providers_tokens_1=require(a196_0x2b51a5(0x182)),git_provider_1=require(a196_0x2b51a5(0x17e)),url_1=require(a196_0x2b51a5(0x18d));let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a196_0x2b51a5(0x15c)]{constructor(_0x40163c,_0x1c5f87){const _0x433496=a196_0x2b51a5;super(_0x40163c,_0x1c5f87),this['accessTokenExpiresAt']=-0x1,this[_0x433496(0x174)]=0x3e8;}[a196_0x2b51a5(0x17b)](_0x459f87){const _0x32ff1b=a196_0x2b51a5,_0x148e82=super[_0x32ff1b(0x17b)](_0x459f87);return _0x148e82[_0x32ff1b(0x163)]['request'][_0x32ff1b(0x162)](async _0x4ee89f=>{const _0x288c5f=_0x32ff1b;return await this['checkAccessToken'](),_0x4ee89f['headers'][_0x288c5f(0x167)]=this['credentials'][_0x288c5f(0x16f)](),_0x4ee89f;}),_0x148e82;}async['checkAccessToken'](){const _0x5f5688=a196_0x2b51a5;if(Date[_0x5f5688(0x180)]()<this[_0x5f5688(0x15d)])return;await this[_0x5f5688(0x170)]();}async[a196_0x2b51a5(0x170)](){const _0x41fb7a=a196_0x2b51a5,{clientId:_0x5e5134,clientSecret:_0x53ccbc}=this[_0x41fb7a(0x187)],_0x2fa9c8=new url_1['URL'](_0x41fb7a(0x16d));_0x2fa9c8[_0x41fb7a(0x16a)]=_0x5e5134,_0x2fa9c8['password']=_0x53ccbc,_0x2fa9c8[_0x41fb7a(0x15f)]='/site/oauth2/access_token';const {data:_0x153912}=await axios_1[_0x41fb7a(0x18e)]['post'](_0x2fa9c8[_0x41fb7a(0x164)](),_0x41fb7a(0x166)),{expires_in:_0x237065,access_token:_0x58db66}=_0x153912;this[_0x41fb7a(0x15d)]=Date[_0x41fb7a(0x180)]()+_0x237065*0x3e8,this[_0x41fb7a(0x187)]['setAccessToken'](_0x58db66);}['getHeaders'](){return{};}[a196_0x2b51a5(0x168)](){const _0x44e3b8=a196_0x2b51a5;return this[_0x44e3b8(0x17f)]['get'](_0x44e3b8(0x17d));}async[a196_0x2b51a5(0x18a)](){const _0x5b7562=a196_0x2b51a5;return await this[_0x5b7562(0x168)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1['Service'])(),__param(0x0,(0x0,typedi_1[a196_0x2b51a5(0x161)])(providers_tokens_1[a196_0x2b51a5(0x185)][a196_0x2b51a5(0x16e)])),__param(0x1,(0x0,typedi_1[a196_0x2b51a5(0x161)])(providers_tokens_1[a196_0x2b51a5(0x185)][a196_0x2b51a5(0x187)])),__metadata(a196_0x2b51a5(0x165),[String,bitbucket_credentials_dto_1[a196_0x2b51a5(0x179)]])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;