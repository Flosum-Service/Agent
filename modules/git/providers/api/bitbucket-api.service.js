const a157_0x4abcab=a157_0x1c99;(function(_0x44cdaa,_0x1902aa){const _0x214a37=a157_0x1c99,_0x5d87e7=_0x44cdaa();while(!![]){try{const _0x4778c0=-parseInt(_0x214a37(0xb4))/0x1+parseInt(_0x214a37(0x89))/0x2+-parseInt(_0x214a37(0xae))/0x3+parseInt(_0x214a37(0x95))/0x4*(parseInt(_0x214a37(0xaf))/0x5)+-parseInt(_0x214a37(0xb0))/0x6*(-parseInt(_0x214a37(0xbe))/0x7)+parseInt(_0x214a37(0xa1))/0x8+-parseInt(_0x214a37(0x88))/0x9;if(_0x4778c0===_0x1902aa)break;else _0x5d87e7['push'](_0x5d87e7['shift']());}catch(_0x334bf0){_0x5d87e7['push'](_0x5d87e7['shift']());}}}(a157_0xbbeb,0xbf3aa));const a157_0x5315a5=(function(){let _0x11798b=!![];return function(_0x2b1563,_0x3e7e08){const _0xd16609=_0x11798b?function(){const _0x35aa92=a157_0x1c99;if(_0x3e7e08){const _0x3c7c71=_0x3e7e08[_0x35aa92(0x97)](_0x2b1563,arguments);return _0x3e7e08=null,_0x3c7c71;}}:function(){};return _0x11798b=![],_0xd16609;};}()),a157_0x5ef3dc=a157_0x5315a5(this,function(){const _0x25fe01=a157_0x1c99;return a157_0x5ef3dc[_0x25fe01(0xb8)]()[_0x25fe01(0xbd)]('(((.+)+)+)+$')[_0x25fe01(0xb8)]()['constructor'](a157_0x5ef3dc)[_0x25fe01(0xbd)](_0x25fe01(0xa7));});function a157_0x1c99(_0x1320cf,_0x11f6df){const _0x128c93=a157_0xbbeb();return a157_0x1c99=function(_0x5ef3dc,_0x5315a5){_0x5ef3dc=_0x5ef3dc-0x88;let _0xbbebf3=_0x128c93[_0x5ef3dc];return _0xbbebf3;},a157_0x1c99(_0x1320cf,_0x11f6df);}a157_0x5ef3dc();'use strict';var __decorate=this&&this['__decorate']||function(_0x1c3ec2,_0x33f163,_0x407505,_0x2c50c9){const _0x4cc0ff=a157_0x1c99;var _0x1460af=arguments[_0x4cc0ff(0xab)],_0x55d14d=_0x1460af<0x3?_0x33f163:_0x2c50c9===null?_0x2c50c9=Object[_0x4cc0ff(0xb9)](_0x33f163,_0x407505):_0x2c50c9,_0x3a72a6;if(typeof Reflect==='object'&&typeof Reflect[_0x4cc0ff(0xa6)]==='function')_0x55d14d=Reflect[_0x4cc0ff(0xa6)](_0x1c3ec2,_0x33f163,_0x407505,_0x2c50c9);else{for(var _0x23d698=_0x1c3ec2[_0x4cc0ff(0xab)]-0x1;_0x23d698>=0x0;_0x23d698--)if(_0x3a72a6=_0x1c3ec2[_0x23d698])_0x55d14d=(_0x1460af<0x3?_0x3a72a6(_0x55d14d):_0x1460af>0x3?_0x3a72a6(_0x33f163,_0x407505,_0x55d14d):_0x3a72a6(_0x33f163,_0x407505))||_0x55d14d;}return _0x1460af>0x3&&_0x55d14d&&Object[_0x4cc0ff(0xad)](_0x33f163,_0x407505,_0x55d14d),_0x55d14d;},__metadata=this&&this['__metadata']||function(_0x358d10,_0x2fbeae){const _0xd40d12=a157_0x1c99;if(typeof Reflect===_0xd40d12(0x91)&&typeof Reflect[_0xd40d12(0xac)]===_0xd40d12(0x99))return Reflect[_0xd40d12(0xac)](_0x358d10,_0x2fbeae);},__param=this&&this[a157_0x4abcab(0xb5)]||function(_0x5b8ee6,_0x17731a){return function(_0x403317,_0x2f4451){_0x17731a(_0x403317,_0x2f4451,_0x5b8ee6);};},__importDefault=this&&this[a157_0x4abcab(0xa0)]||function(_0x5e42e9){const _0x1a80a4=a157_0x4abcab;return _0x5e42e9&&_0x5e42e9[_0x1a80a4(0xa9)]?_0x5e42e9:{'default':_0x5e42e9};};Object[a157_0x4abcab(0xad)](exports,a157_0x4abcab(0xa9),{'value':!![]}),exports['BitbucketApiService']=void 0x0;function a157_0xbbeb(){const _0x1f805a=['1558740YSvRDo','__param','isLoggedIn','Inject','toString','getOwnPropertyDescriptor','url','getCurrentUser','password','search','7EqMoFm','username','21692457twwtNm','2788822ysGZyu','getHeaders','pathname','MAX_REQUEST_PER_HOUR','URL','typedi','Tokens','get','object','post','../credentials/dto/bitbucket-credentials.dto','accessTokenExpiresAt','7484SndxQT','createRequest','apply','checkAccessToken','function','interceptors','BitbucketApiService','https://bitbucket.org','setAccessToken','refreshToken','request','__importDefault','10261784JemJTx','Authorization','user','use','now','decorate','(((.+)+)+)+$','/site/oauth2/access_token','__esModule','./git-api.service','length','metadata','defineProperty','383859aGbgWs','2245aGXmjh','8178162rpKuCB','headers','credentials','GitApiService'];a157_0xbbeb=function(){return _0x1f805a;};return a157_0xbbeb();}const axios_1=__importDefault(require('axios')),typedi_1=require(a157_0x4abcab(0x8e)),git_api_service_1=require(a157_0x4abcab(0xaa)),bitbucket_credentials_dto_1=require(a157_0x4abcab(0x93)),providers_tokens_1=require('../providers.tokens'),git_provider_1=require('../types/git-provider'),url_1=require(a157_0x4abcab(0xba));let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a157_0x4abcab(0xb3)]{constructor(_0x30b9e9,_0x509275){const _0x45fc8a=a157_0x4abcab;super(_0x30b9e9,_0x509275),this['accessTokenExpiresAt']=-0x1,this[_0x45fc8a(0x8c)]=0x3e8;}['createRequest'](_0x4d75b5){const _0x417294=a157_0x4abcab,_0x2cd045=super[_0x417294(0x96)](_0x4d75b5);return _0x2cd045[_0x417294(0x9a)][_0x417294(0x9f)][_0x417294(0xa4)](async _0x194ddd=>{const _0x477e1c=_0x417294;return await this['checkAccessToken'](),_0x194ddd[_0x477e1c(0xb1)][_0x477e1c(0xa2)]=this[_0x477e1c(0xb2)]['getAuthorizationHeader'](),_0x194ddd;}),_0x2cd045;}async[a157_0x4abcab(0x98)](){const _0x11723d=a157_0x4abcab;if(Date[_0x11723d(0xa5)]()<this[_0x11723d(0x94)])return;await this[_0x11723d(0x9e)]();}async[a157_0x4abcab(0x9e)](){const _0x3eadca=a157_0x4abcab,{clientId:_0x391b7d,clientSecret:_0x1bc988}=this[_0x3eadca(0xb2)],_0x18dc66=new url_1[(_0x3eadca(0x8d))](_0x3eadca(0x9c));_0x18dc66[_0x3eadca(0xbf)]=_0x391b7d,_0x18dc66[_0x3eadca(0xbc)]=_0x1bc988,_0x18dc66[_0x3eadca(0x8b)]=_0x3eadca(0xa8);const {data:_0x5acd81}=await axios_1['default'][_0x3eadca(0x92)](_0x18dc66['toString'](),'grant_type=client_credentials'),{expires_in:_0x1596f5,access_token:_0x5a9116}=_0x5acd81;this['accessTokenExpiresAt']=Date[_0x3eadca(0xa5)]()+_0x1596f5*0x3e8,this[_0x3eadca(0xb2)][_0x3eadca(0x9d)](_0x5a9116);}[a157_0x4abcab(0x8a)](){return{};}[a157_0x4abcab(0xbb)](){const _0x4ae4ce=a157_0x4abcab;return this[_0x4ae4ce(0x9f)][_0x4ae4ce(0x90)](_0x4ae4ce(0xa3));}async[a157_0x4abcab(0xb6)](){const _0x57d113=a157_0x4abcab;return await this[_0x57d113(0xbb)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1['Service'])(),__param(0x0,(0x0,typedi_1[a157_0x4abcab(0xb7)])(providers_tokens_1[a157_0x4abcab(0x8f)]['provider'])),__param(0x1,(0x0,typedi_1[a157_0x4abcab(0xb7)])(providers_tokens_1['Tokens'][a157_0x4abcab(0xb2)])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1['BitbucketCredentialsDto']])],BitbucketApiService),exports[a157_0x4abcab(0x9b)]=BitbucketApiService;