const a163_0x20aa12=a163_0x3f4f;(function(_0xf23ff0,_0x1775de){const _0x1a3675=a163_0x3f4f,_0x56a074=_0xf23ff0();while(!![]){try{const _0x1bddbe=parseInt(_0x1a3675(0xd2))/0x1*(-parseInt(_0x1a3675(0xbd))/0x2)+parseInt(_0x1a3675(0xb4))/0x3+parseInt(_0x1a3675(0xd4))/0x4*(-parseInt(_0x1a3675(0xbc))/0x5)+-parseInt(_0x1a3675(0xca))/0x6*(parseInt(_0x1a3675(0xdb))/0x7)+-parseInt(_0x1a3675(0xda))/0x8*(-parseInt(_0x1a3675(0xe1))/0x9)+-parseInt(_0x1a3675(0xcb))/0xa+-parseInt(_0x1a3675(0xaf))/0xb*(-parseInt(_0x1a3675(0xb8))/0xc);if(_0x1bddbe===_0x1775de)break;else _0x56a074['push'](_0x56a074['shift']());}catch(_0x5b7fc9){_0x56a074['push'](_0x56a074['shift']());}}}(a163_0x5b78,0xc3912));const a163_0x2aca70=(function(){let _0x12df5a=!![];return function(_0x58e85d,_0x14be56){const _0x1592ca=_0x12df5a?function(){const _0x1f7e67=a163_0x3f4f;if(_0x14be56){const _0x66c3b2=_0x14be56[_0x1f7e67(0xcc)](_0x58e85d,arguments);return _0x14be56=null,_0x66c3b2;}}:function(){};return _0x12df5a=![],_0x1592ca;};}()),a163_0x40a2eb=a163_0x2aca70(this,function(){const _0x270b97=a163_0x3f4f;return a163_0x40a2eb[_0x270b97(0xc5)]()['search'](_0x270b97(0xd9))[_0x270b97(0xc5)]()[_0x270b97(0xc7)](a163_0x40a2eb)[_0x270b97(0xdd)](_0x270b97(0xd9));});a163_0x40a2eb();'use strict';var __decorate=this&&this[a163_0x20aa12(0xb3)]||function(_0x477d26,_0x5e3af6,_0x2ea43f,_0x48bc20){const _0x57d0ec=a163_0x20aa12;var _0x2c5deb=arguments[_0x57d0ec(0xc4)],_0x38d694=_0x2c5deb<0x3?_0x5e3af6:_0x48bc20===null?_0x48bc20=Object[_0x57d0ec(0xb6)](_0x5e3af6,_0x2ea43f):_0x48bc20,_0xe11002;if(typeof Reflect===_0x57d0ec(0xc6)&&typeof Reflect[_0x57d0ec(0xc0)]===_0x57d0ec(0xce))_0x38d694=Reflect['decorate'](_0x477d26,_0x5e3af6,_0x2ea43f,_0x48bc20);else{for(var _0x55ff4b=_0x477d26[_0x57d0ec(0xc4)]-0x1;_0x55ff4b>=0x0;_0x55ff4b--)if(_0xe11002=_0x477d26[_0x55ff4b])_0x38d694=(_0x2c5deb<0x3?_0xe11002(_0x38d694):_0x2c5deb>0x3?_0xe11002(_0x5e3af6,_0x2ea43f,_0x38d694):_0xe11002(_0x5e3af6,_0x2ea43f))||_0x38d694;}return _0x2c5deb>0x3&&_0x38d694&&Object[_0x57d0ec(0xd7)](_0x5e3af6,_0x2ea43f,_0x38d694),_0x38d694;},__metadata=this&&this[a163_0x20aa12(0xbb)]||function(_0x15de22,_0x2ede3d){const _0x5cfa4e=a163_0x20aa12;if(typeof Reflect===_0x5cfa4e(0xc6)&&typeof Reflect['metadata']===_0x5cfa4e(0xce))return Reflect['metadata'](_0x15de22,_0x2ede3d);},__param=this&&this[a163_0x20aa12(0xd0)]||function(_0xd9eaf4,_0x479cb2){return function(_0x5425f5,_0x5f0d40){_0x479cb2(_0x5425f5,_0x5f0d40,_0xd9eaf4);};},__importDefault=this&&this[a163_0x20aa12(0xc1)]||function(_0x458291){const _0x57c18e=a163_0x20aa12;return _0x458291&&_0x458291[_0x57c18e(0xb7)]?_0x458291:{'default':_0x458291};};Object[a163_0x20aa12(0xd7)](exports,a163_0x20aa12(0xb7),{'value':!![]}),exports[a163_0x20aa12(0xad)]=void 0x0;function a163_0x3f4f(_0x1d93c7,_0x25a71f){const _0x382ac1=a163_0x5b78();return a163_0x3f4f=function(_0x40a2eb,_0x2aca70){_0x40a2eb=_0x40a2eb-0xaa;let _0x5b78aa=_0x382ac1[_0x40a2eb];return _0x5b78aa;},a163_0x3f4f(_0x1d93c7,_0x25a71f);}const axios_1=__importDefault(require(a163_0x20aa12(0xbf))),typedi_1=require('typedi'),git_api_service_1=require('./git-api.service'),bitbucket_credentials_dto_1=require(a163_0x20aa12(0xe3)),providers_tokens_1=require('../providers.tokens'),git_provider_1=require('../types/git-provider'),url_1=require(a163_0x20aa12(0xb5));let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x554335,_0x174c09){const _0x389c73=a163_0x20aa12;super(_0x554335,_0x174c09),this[_0x389c73(0xb1)]=-0x1,this[_0x389c73(0xaa)]=0x3e8;}[a163_0x20aa12(0xc8)](_0x495d6e){const _0x3ded13=a163_0x20aa12,_0x4deb9d=super[_0x3ded13(0xc8)](_0x495d6e);return _0x4deb9d[_0x3ded13(0xd6)]['request'][_0x3ded13(0xcf)](async _0x251ce5=>{const _0x15b014=_0x3ded13;return await this[_0x15b014(0xac)](),_0x251ce5['headers']['Authorization']=this[_0x15b014(0xc2)][_0x15b014(0xbe)](),_0x251ce5;}),_0x4deb9d;}async[a163_0x20aa12(0xac)](){const _0x46aa10=a163_0x20aa12;if(Date['now']()<this[_0x46aa10(0xb1)])return;await this[_0x46aa10(0xe2)]();}async[a163_0x20aa12(0xe2)](){const _0x3a57da=a163_0x20aa12,{clientId:_0x24722d,clientSecret:_0x1318b8}=this[_0x3a57da(0xc2)],_0x4d6281=new url_1['URL'](_0x3a57da(0xdc));_0x4d6281[_0x3a57da(0xb2)]=_0x24722d,_0x4d6281['password']=_0x1318b8,_0x4d6281[_0x3a57da(0xc3)]=_0x3a57da(0xc9);const {data:_0x281ead}=await axios_1[_0x3a57da(0xdf)]['post'](_0x4d6281[_0x3a57da(0xc5)](),_0x3a57da(0xd1)),{expires_in:_0x5e2c2a,access_token:_0x26fd9c}=_0x281ead;this['accessTokenExpiresAt']=Date[_0x3a57da(0xb0)]()+_0x5e2c2a*0x3e8,this[_0x3a57da(0xc2)]['setAccessToken'](_0x26fd9c);}[a163_0x20aa12(0xba)](){return{};}[a163_0x20aa12(0xde)](){const _0x367a4b=a163_0x20aa12;return this[_0x367a4b(0xae)][_0x367a4b(0xb9)](_0x367a4b(0xe4));}async[a163_0x20aa12(0xd3)](){const _0x5aad95=a163_0x20aa12;return await this[_0x5aad95(0xde)](),!![];}};function a163_0x5b78(){const _0x4f44c5=['11QwSEto','now','accessTokenExpiresAt','username','__decorate','1611822pvsaUp','url','getOwnPropertyDescriptor','__esModule','49197972GHYvuH','get','getHeaders','__metadata','71365sZAKTh','4aRuXwl','getAuthorizationHeader','axios','decorate','__importDefault','credentials','pathname','length','toString','object','constructor','createRequest','/site/oauth2/access_token','3516AjaOqu','13612270ceYVik','apply','BitbucketCredentialsDto','function','use','__param','grant_type=client_credentials','785529DegruX','isLoggedIn','244HvqgQM','design:paramtypes','interceptors','defineProperty','Service','(((.+)+)+)+$','4248BpTsad','15029bSFdgg','https://bitbucket.org','search','getCurrentUser','default','Tokens','20763BeEdjj','refreshToken','../credentials/dto/bitbucket-credentials.dto','user','MAX_REQUEST_PER_HOUR','Inject','checkAccessToken','BitbucketApiService','request'];a163_0x5b78=function(){return _0x4f44c5;};return a163_0x5b78();}BitbucketApiService=__decorate([(0x0,typedi_1[a163_0x20aa12(0xd8)])(),__param(0x0,(0x0,typedi_1[a163_0x20aa12(0xab)])(providers_tokens_1[a163_0x20aa12(0xe0)]['provider'])),__param(0x1,(0x0,typedi_1[a163_0x20aa12(0xab)])(providers_tokens_1['Tokens'][a163_0x20aa12(0xc2)])),__metadata(a163_0x20aa12(0xd5),[String,bitbucket_credentials_dto_1[a163_0x20aa12(0xcd)]])],BitbucketApiService),exports[a163_0x20aa12(0xad)]=BitbucketApiService;