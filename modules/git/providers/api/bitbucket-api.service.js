const a158_0x33cf5c=a158_0x5db0;(function(_0x77f2dd,_0x439202){const _0x4a5817=a158_0x5db0,_0x47474d=_0x77f2dd();while(!![]){try{const _0x1491ec=parseInt(_0x4a5817(0xfb))/0x1+-parseInt(_0x4a5817(0xc7))/0x2+parseInt(_0x4a5817(0xe0))/0x3*(parseInt(_0x4a5817(0xea))/0x4)+-parseInt(_0x4a5817(0xf5))/0x5+parseInt(_0x4a5817(0xce))/0x6*(-parseInt(_0x4a5817(0xfa))/0x7)+-parseInt(_0x4a5817(0xe6))/0x8*(parseInt(_0x4a5817(0xc8))/0x9)+parseInt(_0x4a5817(0xd9))/0xa*(parseInt(_0x4a5817(0xcc))/0xb);if(_0x1491ec===_0x439202)break;else _0x47474d['push'](_0x47474d['shift']());}catch(_0x5a6566){_0x47474d['push'](_0x47474d['shift']());}}}(a158_0x4136,0x65b8c));const a158_0x2e2007=(function(){let _0xf0a4dd=!![];return function(_0x594da1,_0x1459cf){const _0x58fbd1=_0xf0a4dd?function(){const _0x36a95b=a158_0x5db0;if(_0x1459cf){const _0x47aed4=_0x1459cf[_0x36a95b(0xdf)](_0x594da1,arguments);return _0x1459cf=null,_0x47aed4;}}:function(){};return _0xf0a4dd=![],_0x58fbd1;};}()),a158_0x2a2fa9=a158_0x2e2007(this,function(){const _0x4aed60=a158_0x5db0;return a158_0x2a2fa9[_0x4aed60(0xd7)]()[_0x4aed60(0xd3)]('(((.+)+)+)+$')['toString']()['constructor'](a158_0x2a2fa9)[_0x4aed60(0xd3)](_0x4aed60(0xd4));});a158_0x2a2fa9();'use strict';function a158_0x5db0(_0x508a37,_0x576aec){const _0x306246=a158_0x4136();return a158_0x5db0=function(_0x2a2fa9,_0x2e2007){_0x2a2fa9=_0x2a2fa9-0xc3;let _0x4136a1=_0x306246[_0x2a2fa9];return _0x4136a1;},a158_0x5db0(_0x508a37,_0x576aec);}var __decorate=this&&this[a158_0x33cf5c(0xc6)]||function(_0x35fbde,_0x3623cf,_0x3314bd,_0x1a52ce){const _0x291865=a158_0x33cf5c;var _0x43f43b=arguments[_0x291865(0xd1)],_0x28ad8e=_0x43f43b<0x3?_0x3623cf:_0x1a52ce===null?_0x1a52ce=Object[_0x291865(0xf3)](_0x3623cf,_0x3314bd):_0x1a52ce,_0x4fa14d;if(typeof Reflect===_0x291865(0xf2)&&typeof Reflect[_0x291865(0xe2)]===_0x291865(0xf8))_0x28ad8e=Reflect[_0x291865(0xe2)](_0x35fbde,_0x3623cf,_0x3314bd,_0x1a52ce);else{for(var _0x295737=_0x35fbde[_0x291865(0xd1)]-0x1;_0x295737>=0x0;_0x295737--)if(_0x4fa14d=_0x35fbde[_0x295737])_0x28ad8e=(_0x43f43b<0x3?_0x4fa14d(_0x28ad8e):_0x43f43b>0x3?_0x4fa14d(_0x3623cf,_0x3314bd,_0x28ad8e):_0x4fa14d(_0x3623cf,_0x3314bd))||_0x28ad8e;}return _0x43f43b>0x3&&_0x28ad8e&&Object[_0x291865(0xec)](_0x3623cf,_0x3314bd,_0x28ad8e),_0x28ad8e;},__metadata=this&&this['__metadata']||function(_0x4e369b,_0x5291c0){const _0x4d613e=a158_0x33cf5c;if(typeof Reflect==='object'&&typeof Reflect[_0x4d613e(0xe5)]===_0x4d613e(0xf8))return Reflect[_0x4d613e(0xe5)](_0x4e369b,_0x5291c0);},__param=this&&this[a158_0x33cf5c(0xde)]||function(_0x23009c,_0xa5306a){return function(_0x233341,_0x36534c){_0xa5306a(_0x233341,_0x36534c,_0x23009c);};},__importDefault=this&&this[a158_0x33cf5c(0xeb)]||function(_0x49fc5f){const _0x20b78e=a158_0x33cf5c;return _0x49fc5f&&_0x49fc5f[_0x20b78e(0xfd)]?_0x49fc5f:{'default':_0x49fc5f};};Object[a158_0x33cf5c(0xec)](exports,a158_0x33cf5c(0xfd),{'value':!![]}),exports[a158_0x33cf5c(0xd8)]=void 0x0;function a158_0x4136(){const _0xfa7038=['typedi','2893YYXfzd','../types/git-provider','592134EGjdfE','/site/oauth2/access_token','design:paramtypes','length','request','search','(((.+)+)+)+$','now','getAuthorizationHeader','toString','BitbucketApiService','35670hotfxx','use','get','getHeaders','credentials','__param','apply','3xFfatO','Authorization','decorate','getCurrentUser','default','metadata','24ZhLest','provider','user','checkAccessToken','2526884yWyhGl','__importDefault','defineProperty','axios','Tokens','GitApiService','createRequest','password','object','getOwnPropertyDescriptor','setAccessToken','4118775ZjoZon','accessTokenExpiresAt','https://bitbucket.org','function','Service','14uOXNXA','341285tadwxu','pathname','__esModule','username','refreshToken','MAX_REQUEST_PER_HOUR','post','Inject','__decorate','656872fZkUhs','434718GVnJjc','headers','isLoggedIn'];a158_0x4136=function(){return _0xfa7038;};return a158_0x4136();}const axios_1=__importDefault(require(a158_0x33cf5c(0xed))),typedi_1=require(a158_0x33cf5c(0xcb)),git_api_service_1=require('./git-api.service'),bitbucket_credentials_dto_1=require('../credentials/dto/bitbucket-credentials.dto'),providers_tokens_1=require('../providers.tokens'),git_provider_1=require(a158_0x33cf5c(0xcd)),url_1=require('url');let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a158_0x33cf5c(0xef)]{constructor(_0x1e2235,_0x454753){const _0x2ecf03=a158_0x33cf5c;super(_0x1e2235,_0x454753),this[_0x2ecf03(0xf6)]=-0x1,this[_0x2ecf03(0xc3)]=0x3e8;}[a158_0x33cf5c(0xf0)](_0x202198){const _0x327060=a158_0x33cf5c,_0x283a76=super[_0x327060(0xf0)](_0x202198);return _0x283a76['interceptors'][_0x327060(0xd2)][_0x327060(0xda)](async _0x277799=>{const _0x12c558=_0x327060;return await this[_0x12c558(0xe9)](),_0x277799[_0x12c558(0xc9)][_0x12c558(0xe1)]=this[_0x12c558(0xdd)][_0x12c558(0xd6)](),_0x277799;}),_0x283a76;}async[a158_0x33cf5c(0xe9)](){const _0x467ab6=a158_0x33cf5c;if(Date[_0x467ab6(0xd5)]()<this['accessTokenExpiresAt'])return;await this[_0x467ab6(0xff)]();}async['refreshToken'](){const _0x30768d=a158_0x33cf5c,{clientId:_0x4b0dca,clientSecret:_0x385da2}=this[_0x30768d(0xdd)],_0x4517c1=new url_1['URL'](_0x30768d(0xf7));_0x4517c1[_0x30768d(0xfe)]=_0x4b0dca,_0x4517c1[_0x30768d(0xf1)]=_0x385da2,_0x4517c1[_0x30768d(0xfc)]=_0x30768d(0xcf);const {data:_0x3ef19e}=await axios_1[_0x30768d(0xe4)][_0x30768d(0xc4)](_0x4517c1['toString'](),'grant_type=client_credentials'),{expires_in:_0x5f4b57,access_token:_0x5aeef5}=_0x3ef19e;this[_0x30768d(0xf6)]=Date['now']()+_0x5f4b57*0x3e8,this[_0x30768d(0xdd)][_0x30768d(0xf4)](_0x5aeef5);}[a158_0x33cf5c(0xdc)](){return{};}[a158_0x33cf5c(0xe3)](){const _0x39efb7=a158_0x33cf5c;return this[_0x39efb7(0xd2)][_0x39efb7(0xdb)](_0x39efb7(0xe8));}async[a158_0x33cf5c(0xca)](){const _0xedef0e=a158_0x33cf5c;return await this[_0xedef0e(0xe3)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a158_0x33cf5c(0xf9)])(),__param(0x0,(0x0,typedi_1[a158_0x33cf5c(0xc5)])(providers_tokens_1[a158_0x33cf5c(0xee)][a158_0x33cf5c(0xe7)])),__param(0x1,(0x0,typedi_1[a158_0x33cf5c(0xc5)])(providers_tokens_1[a158_0x33cf5c(0xee)][a158_0x33cf5c(0xdd)])),__metadata(a158_0x33cf5c(0xd0),[String,bitbucket_credentials_dto_1['BitbucketCredentialsDto']])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;