const a163_0x5883b8=a163_0x4348;(function(_0x54dc1d,_0x238da9){const _0x2d94e0=a163_0x4348,_0x4fa1ef=_0x54dc1d();while(!![]){try{const _0x4cef99=parseInt(_0x2d94e0(0xf5))/0x1+-parseInt(_0x2d94e0(0x110))/0x2+-parseInt(_0x2d94e0(0xd8))/0x3+parseInt(_0x2d94e0(0x101))/0x4*(parseInt(_0x2d94e0(0xff))/0x5)+-parseInt(_0x2d94e0(0x107))/0x6*(-parseInt(_0x2d94e0(0x103))/0x7)+parseInt(_0x2d94e0(0xfe))/0x8*(parseInt(_0x2d94e0(0xf7))/0x9)+parseInt(_0x2d94e0(0x112))/0xa*(-parseInt(_0x2d94e0(0xdf))/0xb);if(_0x4cef99===_0x238da9)break;else _0x4fa1ef['push'](_0x4fa1ef['shift']());}catch(_0xaeaebd){_0x4fa1ef['push'](_0x4fa1ef['shift']());}}}(a163_0x2ce3,0x435ad));const a163_0x50ac33=(function(){let _0x599a2f=!![];return function(_0x431b25,_0x2a6204){const _0x3d2e12=_0x599a2f?function(){const _0xe8ab12=a163_0x4348;if(_0x2a6204){const _0x24b71c=_0x2a6204[_0xe8ab12(0x108)](_0x431b25,arguments);return _0x2a6204=null,_0x24b71c;}}:function(){};return _0x599a2f=![],_0x3d2e12;};}()),a163_0x4d6a25=a163_0x50ac33(this,function(){const _0x11f38b=a163_0x4348;return a163_0x4d6a25[_0x11f38b(0x10a)]()[_0x11f38b(0xf9)]('(((.+)+)+)+$')[_0x11f38b(0x10a)]()[_0x11f38b(0xe6)](a163_0x4d6a25)[_0x11f38b(0xf9)]('(((.+)+)+)+$');});a163_0x4d6a25();function a163_0x2ce3(){const _0x2b0323=['now','length','/site/oauth2/access_token','metadata','308GKgirH','BitbucketCredentialsDto','use','decorate','__param','getOwnPropertyDescriptor','defineProperty','constructor','provider','credentials','refreshToken','getHeaders','request','../credentials/dto/bitbucket-credentials.dto','__decorate','Service','./git-api.service','Tokens','function','design:paramtypes','Inject','password','540145oLYNrR','../types/git-provider','6201zDYrkk','typedi','search','accessTokenExpiresAt','BitbucketApiService','get','createRequest','6320IGrEkq','10ngVvSo','GitApiService','567320OOQZyt','interceptors','66381SLQtJU','grant_type=client_credentials','object','getAuthorizationHeader','84nosyFf','apply','https://bitbucket.org','toString','setAccessToken','user','URL','username','__esModule','592212aUHNDd','getCurrentUser','174990yEQqir','1316742cWYnjj','checkAccessToken','MAX_REQUEST_PER_HOUR'];a163_0x2ce3=function(){return _0x2b0323;};return a163_0x2ce3();}'use strict';var __decorate=this&&this[a163_0x5883b8(0xed)]||function(_0x344a5c,_0x3e7cd9,_0x25dcfd,_0x449402){const _0x10271f=a163_0x5883b8;var _0x53afff=arguments[_0x10271f(0xdc)],_0x24d123=_0x53afff<0x3?_0x3e7cd9:_0x449402===null?_0x449402=Object[_0x10271f(0xe4)](_0x3e7cd9,_0x25dcfd):_0x449402,_0x472f4c;if(typeof Reflect===_0x10271f(0x105)&&typeof Reflect[_0x10271f(0xe2)]===_0x10271f(0xf1))_0x24d123=Reflect['decorate'](_0x344a5c,_0x3e7cd9,_0x25dcfd,_0x449402);else{for(var _0xa4aa1b=_0x344a5c['length']-0x1;_0xa4aa1b>=0x0;_0xa4aa1b--)if(_0x472f4c=_0x344a5c[_0xa4aa1b])_0x24d123=(_0x53afff<0x3?_0x472f4c(_0x24d123):_0x53afff>0x3?_0x472f4c(_0x3e7cd9,_0x25dcfd,_0x24d123):_0x472f4c(_0x3e7cd9,_0x25dcfd))||_0x24d123;}return _0x53afff>0x3&&_0x24d123&&Object['defineProperty'](_0x3e7cd9,_0x25dcfd,_0x24d123),_0x24d123;},__metadata=this&&this['__metadata']||function(_0x1108ba,_0xd645a8){const _0x38a3c3=a163_0x5883b8;if(typeof Reflect===_0x38a3c3(0x105)&&typeof Reflect[_0x38a3c3(0xde)]===_0x38a3c3(0xf1))return Reflect[_0x38a3c3(0xde)](_0x1108ba,_0xd645a8);},__param=this&&this[a163_0x5883b8(0xe3)]||function(_0x326919,_0x59cb41){return function(_0xb72ff2,_0x11eb0a){_0x59cb41(_0xb72ff2,_0x11eb0a,_0x326919);};},__importDefault=this&&this['__importDefault']||function(_0x536734){const _0x215ce1=a163_0x5883b8;return _0x536734&&_0x536734[_0x215ce1(0x10f)]?_0x536734:{'default':_0x536734};};Object[a163_0x5883b8(0xe5)](exports,a163_0x5883b8(0x10f),{'value':!![]}),exports[a163_0x5883b8(0xfb)]=void 0x0;const axios_1=__importDefault(require('axios')),typedi_1=require(a163_0x5883b8(0xf8)),git_api_service_1=require(a163_0x5883b8(0xef)),bitbucket_credentials_dto_1=require(a163_0x5883b8(0xec)),providers_tokens_1=require('../providers.tokens'),git_provider_1=require(a163_0x5883b8(0xf6)),url_1=require('url');function a163_0x4348(_0x3be868,_0x452cd2){const _0x900d53=a163_0x2ce3();return a163_0x4348=function(_0x4d6a25,_0x50ac33){_0x4d6a25=_0x4d6a25-0xd8;let _0x2ce3e9=_0x900d53[_0x4d6a25];return _0x2ce3e9;},a163_0x4348(_0x3be868,_0x452cd2);}let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a163_0x5883b8(0x100)]{constructor(_0xed50c4,_0x3b35b5){const _0x3de7db=a163_0x5883b8;super(_0xed50c4,_0x3b35b5),this[_0x3de7db(0xfa)]=-0x1,this[_0x3de7db(0xda)]=0x3e8;}['createRequest'](_0x3260a7){const _0x50562c=a163_0x5883b8,_0x3f11fd=super[_0x50562c(0xfd)](_0x3260a7);return _0x3f11fd[_0x50562c(0x102)][_0x50562c(0xeb)][_0x50562c(0xe1)](async _0x5cf3c0=>{const _0x1c4780=_0x50562c;return await this[_0x1c4780(0xd9)](),_0x5cf3c0['headers']['Authorization']=this[_0x1c4780(0xe8)][_0x1c4780(0x106)](),_0x5cf3c0;}),_0x3f11fd;}async[a163_0x5883b8(0xd9)](){const _0x3c2109=a163_0x5883b8;if(Date['now']()<this['accessTokenExpiresAt'])return;await this[_0x3c2109(0xe9)]();}async['refreshToken'](){const _0x418cbc=a163_0x5883b8,{clientId:_0x1e988d,clientSecret:_0x44a05a}=this[_0x418cbc(0xe8)],_0x1ea313=new url_1[(_0x418cbc(0x10d))](_0x418cbc(0x109));_0x1ea313[_0x418cbc(0x10e)]=_0x1e988d,_0x1ea313[_0x418cbc(0xf4)]=_0x44a05a,_0x1ea313['pathname']=_0x418cbc(0xdd);const {data:_0x232689}=await axios_1['default']['post'](_0x1ea313[_0x418cbc(0x10a)](),_0x418cbc(0x104)),{expires_in:_0xe2d3dd,access_token:_0x415000}=_0x232689;this[_0x418cbc(0xfa)]=Date[_0x418cbc(0xdb)]()+_0xe2d3dd*0x3e8,this[_0x418cbc(0xe8)][_0x418cbc(0x10b)](_0x415000);}[a163_0x5883b8(0xea)](){return{};}['getCurrentUser'](){const _0x3b4902=a163_0x5883b8;return this['request'][_0x3b4902(0xfc)](_0x3b4902(0x10c));}async['isLoggedIn'](){const _0x841da6=a163_0x5883b8;return await this[_0x841da6(0x111)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a163_0x5883b8(0xee)])(),__param(0x0,(0x0,typedi_1[a163_0x5883b8(0xf3)])(providers_tokens_1[a163_0x5883b8(0xf0)][a163_0x5883b8(0xe7)])),__param(0x1,(0x0,typedi_1[a163_0x5883b8(0xf3)])(providers_tokens_1[a163_0x5883b8(0xf0)][a163_0x5883b8(0xe8)])),__metadata(a163_0x5883b8(0xf2),[String,bitbucket_credentials_dto_1[a163_0x5883b8(0xe0)]])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;