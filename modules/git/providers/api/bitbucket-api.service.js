const a107_0x2ea883=a107_0xdb55;(function(_0x4f8f97,_0x586739){const _0x2cb95e=a107_0xdb55,_0x1e00af=_0x4f8f97();while(!![]){try{const _0x1009d4=parseInt(_0x2cb95e(0x10c))/0x1+parseInt(_0x2cb95e(0x115))/0x2+-parseInt(_0x2cb95e(0x137))/0x3+-parseInt(_0x2cb95e(0x13e))/0x4*(-parseInt(_0x2cb95e(0x12e))/0x5)+parseInt(_0x2cb95e(0x119))/0x6*(parseInt(_0x2cb95e(0x10d))/0x7)+parseInt(_0x2cb95e(0x107))/0x8+-parseInt(_0x2cb95e(0x131))/0x9;if(_0x1009d4===_0x586739)break;else _0x1e00af['push'](_0x1e00af['shift']());}catch(_0x4c944c){_0x1e00af['push'](_0x1e00af['shift']());}}}(a107_0x5423,0x92358));const a107_0x393940=(function(){let _0x380f3c=!![];return function(_0x22fe8e,_0x7cbdc){const _0x2e5593=_0x380f3c?function(){if(_0x7cbdc){const _0x422ad5=_0x7cbdc['apply'](_0x22fe8e,arguments);return _0x7cbdc=null,_0x422ad5;}}:function(){};return _0x380f3c=![],_0x2e5593;};}()),a107_0x4e7b9a=a107_0x393940(this,function(){const _0x46858d=a107_0xdb55;return a107_0x4e7b9a[_0x46858d(0x126)]()['search'](_0x46858d(0x13c))['toString']()[_0x46858d(0x114)](a107_0x4e7b9a)['search'](_0x46858d(0x13c));});a107_0x4e7b9a();'use strict';var __decorate=this&&this[a107_0x2ea883(0x11f)]||function(_0x147499,_0xbbc194,_0x4b2b53,_0xebde84){const _0xbcbe93=a107_0x2ea883;var _0x5978c9=arguments[_0xbcbe93(0x12a)],_0x228588=_0x5978c9<0x3?_0xbbc194:_0xebde84===null?_0xebde84=Object[_0xbcbe93(0x113)](_0xbbc194,_0x4b2b53):_0xebde84,_0x1b5288;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0xbcbe93(0x104))_0x228588=Reflect[_0xbcbe93(0x11d)](_0x147499,_0xbbc194,_0x4b2b53,_0xebde84);else{for(var _0x38dd4b=_0x147499[_0xbcbe93(0x12a)]-0x1;_0x38dd4b>=0x0;_0x38dd4b--)if(_0x1b5288=_0x147499[_0x38dd4b])_0x228588=(_0x5978c9<0x3?_0x1b5288(_0x228588):_0x5978c9>0x3?_0x1b5288(_0xbbc194,_0x4b2b53,_0x228588):_0x1b5288(_0xbbc194,_0x4b2b53))||_0x228588;}return _0x5978c9>0x3&&_0x228588&&Object['defineProperty'](_0xbbc194,_0x4b2b53,_0x228588),_0x228588;},__metadata=this&&this[a107_0x2ea883(0x127)]||function(_0x10ed3e,_0x16bf15){const _0x163713=a107_0x2ea883;if(typeof Reflect===_0x163713(0x112)&&typeof Reflect['metadata']===_0x163713(0x104))return Reflect[_0x163713(0x110)](_0x10ed3e,_0x16bf15);},__param=this&&this[a107_0x2ea883(0x10a)]||function(_0x5e1d24,_0x315196){return function(_0x4f20aa,_0x596ce0){_0x315196(_0x4f20aa,_0x596ce0,_0x5e1d24);};},__importDefault=this&&this[a107_0x2ea883(0x121)]||function(_0x482030){const _0x5ae29a=a107_0x2ea883;return _0x482030&&_0x482030[_0x5ae29a(0x136)]?_0x482030:{'default':_0x482030};};function a107_0xdb55(_0x433206,_0x41a89a){const _0x29486f=a107_0x5423();return a107_0xdb55=function(_0x4e7b9a,_0x393940){_0x4e7b9a=_0x4e7b9a-0x103;let _0x54232c=_0x29486f[_0x4e7b9a];return _0x54232c;},a107_0xdb55(_0x433206,_0x41a89a);}Object[a107_0x2ea883(0x10b)](exports,a107_0x2ea883(0x136),{'value':!![]}),exports[a107_0x2ea883(0x12d)]=void 0x0;const axios_1=__importDefault(require(a107_0x2ea883(0x103))),typedi_1=require('typedi'),git_api_service_1=require('./git-api.service'),bitbucket_credentials_dto_1=require(a107_0x2ea883(0x109)),providers_tokens_1=require(a107_0x2ea883(0x12b)),git_provider_1=require(a107_0x2ea883(0x140)),url_1=require(a107_0x2ea883(0x11e));function a107_0x5423(){const _0x24b8f3=['../types/git-provider','axios','function','refreshToken','headers','6115656ZYGhju','Inject','../credentials/dto/bitbucket-credentials.dto','__param','defineProperty','145635cbHTDy','959GIsSeM','getAuthorizationHeader','interceptors','metadata','getCurrentUser','object','getOwnPropertyDescriptor','constructor','2263168mdNsFG','checkAccessToken','username','Tokens','19668VGpSCS','accessTokenExpiresAt','password','default','decorate','url','__decorate','isLoggedIn','__importDefault','grant_type=client_credentials','provider','getHeaders','createRequest','toString','__metadata','/site/oauth2/access_token','use','length','../providers.tokens','design:paramtypes','BitbucketApiService','31300MdAqNv','request','setAccessToken','24911442ZprWlk','post','Authorization','get','URL','__esModule','508116DCLMfV','GitApiService','pathname','BitbucketCredentialsDto','credentials','(((.+)+)+)+$','now','668aeVqaG','MAX_REQUEST_PER_HOUR'];a107_0x5423=function(){return _0x24b8f3;};return a107_0x5423();}let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a107_0x2ea883(0x138)]{constructor(_0x9f401f,_0x39e448){const _0x2d2782=a107_0x2ea883;super(_0x9f401f,_0x39e448),this[_0x2d2782(0x11a)]=-0x1,this[_0x2d2782(0x13f)]=0x3e8;}[a107_0x2ea883(0x125)](_0x366a4a){const _0x18fa55=a107_0x2ea883,_0x1cd60a=super['createRequest'](_0x366a4a);return _0x1cd60a[_0x18fa55(0x10f)]['request'][_0x18fa55(0x129)](async _0x1944e7=>{const _0x5941ec=_0x18fa55;return await this['checkAccessToken'](),_0x1944e7[_0x5941ec(0x106)][_0x5941ec(0x133)]=this[_0x5941ec(0x13b)][_0x5941ec(0x10e)](),_0x1944e7;}),_0x1cd60a;}async[a107_0x2ea883(0x116)](){const _0x1e6cef=a107_0x2ea883;if(Date[_0x1e6cef(0x13d)]()<this[_0x1e6cef(0x11a)])return;await this[_0x1e6cef(0x105)]();}async[a107_0x2ea883(0x105)](){const _0x5c34e7=a107_0x2ea883,{clientId:_0xdc7836,clientSecret:_0x5f1e22}=this[_0x5c34e7(0x13b)],_0x1f8a16=new url_1[(_0x5c34e7(0x135))]('https://bitbucket.org');_0x1f8a16[_0x5c34e7(0x117)]=_0xdc7836,_0x1f8a16[_0x5c34e7(0x11b)]=_0x5f1e22,_0x1f8a16[_0x5c34e7(0x139)]=_0x5c34e7(0x128);const {data:_0x262aca}=await axios_1[_0x5c34e7(0x11c)][_0x5c34e7(0x132)](_0x1f8a16[_0x5c34e7(0x126)](),_0x5c34e7(0x122)),{expires_in:_0x1d252a,access_token:_0x3c320e}=_0x262aca;this[_0x5c34e7(0x11a)]=Date[_0x5c34e7(0x13d)]()+_0x1d252a*0x3e8,this['credentials'][_0x5c34e7(0x130)](_0x3c320e);}[a107_0x2ea883(0x124)](){return{};}['getCurrentUser'](){const _0x312c92=a107_0x2ea883;return this[_0x312c92(0x12f)][_0x312c92(0x134)]('user');}async[a107_0x2ea883(0x120)](){const _0xbb194b=a107_0x2ea883;return await this[_0xbb194b(0x111)](),!![];}};BitbucketApiService=__decorate([typedi_1['Service'](),__param(0x0,typedi_1[a107_0x2ea883(0x108)](providers_tokens_1[a107_0x2ea883(0x118)][a107_0x2ea883(0x123)])),__param(0x1,typedi_1[a107_0x2ea883(0x108)](providers_tokens_1[a107_0x2ea883(0x118)]['credentials'])),__metadata(a107_0x2ea883(0x12c),[String,bitbucket_credentials_dto_1[a107_0x2ea883(0x13a)]])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;