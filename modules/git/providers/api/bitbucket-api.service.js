const a158_0x49b906=a158_0x37da;(function(_0x4e3447,_0x437032){const _0x3355cf=a158_0x37da,_0x557ffe=_0x4e3447();while(!![]){try{const _0x1fde4a=parseInt(_0x3355cf(0x19e))/0x1+-parseInt(_0x3355cf(0x1ba))/0x2*(parseInt(_0x3355cf(0x18e))/0x3)+parseInt(_0x3355cf(0x19b))/0x4+-parseInt(_0x3355cf(0x1bf))/0x5+parseInt(_0x3355cf(0x1b7))/0x6*(-parseInt(_0x3355cf(0x1aa))/0x7)+parseInt(_0x3355cf(0x191))/0x8+parseInt(_0x3355cf(0x18f))/0x9;if(_0x1fde4a===_0x437032)break;else _0x557ffe['push'](_0x557ffe['shift']());}catch(_0x57cb6d){_0x557ffe['push'](_0x557ffe['shift']());}}}(a158_0x3177,0x222b3));const a158_0xdc43d=(function(){let _0x41ad03=!![];return function(_0x2a701e,_0x5c7490){const _0x9514f9=_0x41ad03?function(){const _0x27538b=a158_0x37da;if(_0x5c7490){const _0x563108=_0x5c7490[_0x27538b(0x1af)](_0x2a701e,arguments);return _0x5c7490=null,_0x563108;}}:function(){};return _0x41ad03=![],_0x9514f9;};}()),a158_0x12fded=a158_0xdc43d(this,function(){const _0x2b08f8=a158_0x37da;return a158_0x12fded[_0x2b08f8(0x18d)]()[_0x2b08f8(0x19a)]('(((.+)+)+)+$')[_0x2b08f8(0x18d)]()[_0x2b08f8(0x1c1)](a158_0x12fded)[_0x2b08f8(0x19a)](_0x2b08f8(0x1a9));});a158_0x12fded();'use strict';var __decorate=this&&this[a158_0x49b906(0x198)]||function(_0x450e8e,_0xa2b7d6,_0x470e82,_0x33c574){const _0x1e5387=a158_0x49b906;var _0x4c0dda=arguments[_0x1e5387(0x190)],_0x5ea3fd=_0x4c0dda<0x3?_0xa2b7d6:_0x33c574===null?_0x33c574=Object['getOwnPropertyDescriptor'](_0xa2b7d6,_0x470e82):_0x33c574,_0x289ef4;if(typeof Reflect===_0x1e5387(0x192)&&typeof Reflect[_0x1e5387(0x1a3)]===_0x1e5387(0x195))_0x5ea3fd=Reflect[_0x1e5387(0x1a3)](_0x450e8e,_0xa2b7d6,_0x470e82,_0x33c574);else{for(var _0xf08c34=_0x450e8e[_0x1e5387(0x190)]-0x1;_0xf08c34>=0x0;_0xf08c34--)if(_0x289ef4=_0x450e8e[_0xf08c34])_0x5ea3fd=(_0x4c0dda<0x3?_0x289ef4(_0x5ea3fd):_0x4c0dda>0x3?_0x289ef4(_0xa2b7d6,_0x470e82,_0x5ea3fd):_0x289ef4(_0xa2b7d6,_0x470e82))||_0x5ea3fd;}return _0x4c0dda>0x3&&_0x5ea3fd&&Object[_0x1e5387(0x1bc)](_0xa2b7d6,_0x470e82,_0x5ea3fd),_0x5ea3fd;},__metadata=this&&this['__metadata']||function(_0x527a7e,_0x309bb6){const _0x1161ec=a158_0x49b906;if(typeof Reflect===_0x1161ec(0x192)&&typeof Reflect[_0x1161ec(0x1a2)]===_0x1161ec(0x195))return Reflect[_0x1161ec(0x1a2)](_0x527a7e,_0x309bb6);},__param=this&&this[a158_0x49b906(0x1ae)]||function(_0x3ab295,_0xcafbae){return function(_0x73ba96,_0x2552ad){_0xcafbae(_0x73ba96,_0x2552ad,_0x3ab295);};},__importDefault=this&&this['__importDefault']||function(_0x2bf0d4){const _0x53cd71=a158_0x49b906;return _0x2bf0d4&&_0x2bf0d4[_0x53cd71(0x193)]?_0x2bf0d4:{'default':_0x2bf0d4};};Object['defineProperty'](exports,a158_0x49b906(0x193),{'value':!![]}),exports[a158_0x49b906(0x1ad)]=void 0x0;function a158_0x3177(){const _0x439fde=['checkAccessToken','credentials','pathname','Service','now','Authorization','request','12bhJFVW','../providers.tokens','password','244958PoxdJd','axios','defineProperty','getAuthorizationHeader','refreshToken','892435rAiBal','/site/oauth2/access_token','constructor','user','../types/git-provider','url','toString','3Lxitin','3361887rTDhoS','length','1593392XiPGzV','object','__esModule','typedi','function','accessTokenExpiresAt','Inject','__decorate','../credentials/dto/bitbucket-credentials.dto','search','186236mMybaD','get','./git-api.service','72889iqKrKc','isLoggedIn','use','getCurrentUser','metadata','decorate','post','setAccessToken','getHeaders','createRequest','design:paramtypes','(((.+)+)+)+$','879354XbVWYc','grant_type=client_credentials','GitApiService','BitbucketApiService','__param','apply'];a158_0x3177=function(){return _0x439fde;};return a158_0x3177();}const axios_1=__importDefault(require(a158_0x49b906(0x1bb))),typedi_1=require(a158_0x49b906(0x194)),git_api_service_1=require(a158_0x49b906(0x19d)),bitbucket_credentials_dto_1=require(a158_0x49b906(0x199)),providers_tokens_1=require(a158_0x49b906(0x1b8)),git_provider_1=require(a158_0x49b906(0x18b)),url_1=require(a158_0x49b906(0x18c));let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a158_0x49b906(0x1ac)]{constructor(_0x5bd19e,_0x221ab0){const _0xeaccbd=a158_0x49b906;super(_0x5bd19e,_0x221ab0),this[_0xeaccbd(0x196)]=-0x1,this['MAX_REQUEST_PER_HOUR']=0x3e8;}[a158_0x49b906(0x1a7)](_0x4ab71f){const _0x1442b0=a158_0x49b906,_0x2bf83f=super[_0x1442b0(0x1a7)](_0x4ab71f);return _0x2bf83f['interceptors'][_0x1442b0(0x1b6)][_0x1442b0(0x1a0)](async _0x1d2bac=>{const _0x497e7f=_0x1442b0;return await this[_0x497e7f(0x1b0)](),_0x1d2bac['headers'][_0x497e7f(0x1b5)]=this[_0x497e7f(0x1b1)][_0x497e7f(0x1bd)](),_0x1d2bac;}),_0x2bf83f;}async[a158_0x49b906(0x1b0)](){const _0x53c53e=a158_0x49b906;if(Date['now']()<this[_0x53c53e(0x196)])return;await this[_0x53c53e(0x1be)]();}async['refreshToken'](){const _0x161156=a158_0x49b906,{clientId:_0x455c57,clientSecret:_0x517489}=this['credentials'],_0x2417e5=new url_1['URL']('https://bitbucket.org');_0x2417e5['username']=_0x455c57,_0x2417e5[_0x161156(0x1b9)]=_0x517489,_0x2417e5[_0x161156(0x1b2)]=_0x161156(0x1c0);const {data:_0x5c20c4}=await axios_1['default'][_0x161156(0x1a4)](_0x2417e5['toString'](),_0x161156(0x1ab)),{expires_in:_0xec33b8,access_token:_0x27967a}=_0x5c20c4;this['accessTokenExpiresAt']=Date[_0x161156(0x1b4)]()+_0xec33b8*0x3e8,this[_0x161156(0x1b1)][_0x161156(0x1a5)](_0x27967a);}[a158_0x49b906(0x1a6)](){return{};}[a158_0x49b906(0x1a1)](){const _0x3254fb=a158_0x49b906;return this['request'][_0x3254fb(0x19c)](_0x3254fb(0x1c2));}async[a158_0x49b906(0x19f)](){const _0x2345a0=a158_0x49b906;return await this[_0x2345a0(0x1a1)](),!![];}};function a158_0x37da(_0x46f5fd,_0x96ec0b){const _0x3986cd=a158_0x3177();return a158_0x37da=function(_0x12fded,_0xdc43d){_0x12fded=_0x12fded-0x18b;let _0x317712=_0x3986cd[_0x12fded];return _0x317712;},a158_0x37da(_0x46f5fd,_0x96ec0b);}BitbucketApiService=__decorate([(0x0,typedi_1[a158_0x49b906(0x1b3)])(),__param(0x0,(0x0,typedi_1[a158_0x49b906(0x197)])(providers_tokens_1['Tokens']['provider'])),__param(0x1,(0x0,typedi_1[a158_0x49b906(0x197)])(providers_tokens_1['Tokens'][a158_0x49b906(0x1b1)])),__metadata(a158_0x49b906(0x1a8),[String,bitbucket_credentials_dto_1['BitbucketCredentialsDto']])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;