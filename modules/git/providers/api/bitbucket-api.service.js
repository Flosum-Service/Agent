const a169_0x25d5df=a169_0x21b5;(function(_0x230dc7,_0x145909){const _0x5e32b7=a169_0x21b5,_0x8cef76=_0x230dc7();while(!![]){try{const _0x1cbebb=parseInt(_0x5e32b7(0x170))/0x1*(parseInt(_0x5e32b7(0x180))/0x2)+-parseInt(_0x5e32b7(0x164))/0x3+-parseInt(_0x5e32b7(0x18c))/0x4+-parseInt(_0x5e32b7(0x172))/0x5+parseInt(_0x5e32b7(0x177))/0x6+parseInt(_0x5e32b7(0x175))/0x7*(-parseInt(_0x5e32b7(0x191))/0x8)+-parseInt(_0x5e32b7(0x18f))/0x9*(-parseInt(_0x5e32b7(0x176))/0xa);if(_0x1cbebb===_0x145909)break;else _0x8cef76['push'](_0x8cef76['shift']());}catch(_0x7f1cff){_0x8cef76['push'](_0x8cef76['shift']());}}}(a169_0x17cf,0x368fa));const a169_0x56292d=(function(){let _0x36a4d2=!![];return function(_0x2f5c76,_0x42dc14){const _0x2f7928=_0x36a4d2?function(){const _0x45a6e9=a169_0x21b5;if(_0x42dc14){const _0x295b70=_0x42dc14[_0x45a6e9(0x173)](_0x2f5c76,arguments);return _0x42dc14=null,_0x295b70;}}:function(){};return _0x36a4d2=![],_0x2f7928;};}()),a169_0x27f444=a169_0x56292d(this,function(){const _0x535f3d=a169_0x21b5;return a169_0x27f444[_0x535f3d(0x18b)]()['search']('(((.+)+)+)+$')[_0x535f3d(0x18b)]()[_0x535f3d(0x18d)](a169_0x27f444)[_0x535f3d(0x16f)](_0x535f3d(0x16c));});a169_0x27f444();function a169_0x21b5(_0x5e3726,_0x22f484){const _0x6648cb=a169_0x17cf();return a169_0x21b5=function(_0x27f444,_0x56292d){_0x27f444=_0x27f444-0x161;let _0x17cfb0=_0x6648cb[_0x27f444];return _0x17cfb0;},a169_0x21b5(_0x5e3726,_0x22f484);}'use strict';var __decorate=this&&this[a169_0x25d5df(0x189)]||function(_0x338e02,_0x4cc229,_0x856189,_0x38e758){const _0x2d9bd6=a169_0x25d5df;var _0x1fff3d=arguments[_0x2d9bd6(0x16a)],_0x56e373=_0x1fff3d<0x3?_0x4cc229:_0x38e758===null?_0x38e758=Object['getOwnPropertyDescriptor'](_0x4cc229,_0x856189):_0x38e758,_0xb2f4a9;if(typeof Reflect===_0x2d9bd6(0x165)&&typeof Reflect[_0x2d9bd6(0x17a)]===_0x2d9bd6(0x162))_0x56e373=Reflect[_0x2d9bd6(0x17a)](_0x338e02,_0x4cc229,_0x856189,_0x38e758);else{for(var _0x21ece0=_0x338e02[_0x2d9bd6(0x16a)]-0x1;_0x21ece0>=0x0;_0x21ece0--)if(_0xb2f4a9=_0x338e02[_0x21ece0])_0x56e373=(_0x1fff3d<0x3?_0xb2f4a9(_0x56e373):_0x1fff3d>0x3?_0xb2f4a9(_0x4cc229,_0x856189,_0x56e373):_0xb2f4a9(_0x4cc229,_0x856189))||_0x56e373;}return _0x1fff3d>0x3&&_0x56e373&&Object[_0x2d9bd6(0x187)](_0x4cc229,_0x856189,_0x56e373),_0x56e373;},__metadata=this&&this['__metadata']||function(_0x52e14d,_0x338534){const _0x15dafd=a169_0x25d5df;if(typeof Reflect===_0x15dafd(0x165)&&typeof Reflect[_0x15dafd(0x179)]==='function')return Reflect['metadata'](_0x52e14d,_0x338534);},__param=this&&this['__param']||function(_0x4d4f2d,_0x101feb){return function(_0x1cb534,_0x134ad7){_0x101feb(_0x1cb534,_0x134ad7,_0x4d4f2d);};},__importDefault=this&&this['__importDefault']||function(_0x17d7d1){const _0x40c60b=a169_0x25d5df;return _0x17d7d1&&_0x17d7d1[_0x40c60b(0x188)]?_0x17d7d1:{'default':_0x17d7d1};};function a169_0x17cf(){const _0x13d8ae=['__decorate','../providers.tokens','toString','1422888FfsaHV','constructor','Tokens','2097TpAwDp','accessTokenExpiresAt','8FqBZSn','pathname','getCurrentUser','function','../credentials/dto/bitbucket-credentials.dto','99564WYURhQ','object','checkAccessToken','provider','default','Inject','length','now','(((.+)+)+)+$','setAccessToken','grant_type=client_credentials','search','1zxYKgU','request','1280515NzjdeN','apply','createRequest','1476055BHCZPR','42190VgrzrG','472512AKpSVM','headers','metadata','decorate','BitbucketApiService','Authorization','./git-api.service','isLoggedIn','credentials','35162QcTxCg','use','getAuthorizationHeader','refreshToken','typedi','password','MAX_REQUEST_PER_HOUR','defineProperty','__esModule'];a169_0x17cf=function(){return _0x13d8ae;};return a169_0x17cf();}Object[a169_0x25d5df(0x187)](exports,'__esModule',{'value':!![]}),exports[a169_0x25d5df(0x17b)]=void 0x0;const axios_1=__importDefault(require('axios')),typedi_1=require(a169_0x25d5df(0x184)),git_api_service_1=require(a169_0x25d5df(0x17d)),bitbucket_credentials_dto_1=require(a169_0x25d5df(0x163)),providers_tokens_1=require(a169_0x25d5df(0x18a)),git_provider_1=require('../types/git-provider'),url_1=require('url');let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x55c403,_0x39947b){const _0x323a43=a169_0x25d5df;super(_0x55c403,_0x39947b),this[_0x323a43(0x190)]=-0x1,this[_0x323a43(0x186)]=0x3e8;}[a169_0x25d5df(0x174)](_0x5e2d80){const _0x5c5160=a169_0x25d5df,_0x11e129=super[_0x5c5160(0x174)](_0x5e2d80);return _0x11e129['interceptors'][_0x5c5160(0x171)][_0x5c5160(0x181)](async _0x102ac2=>{const _0x2a9452=_0x5c5160;return await this[_0x2a9452(0x166)](),_0x102ac2[_0x2a9452(0x178)][_0x2a9452(0x17c)]=this[_0x2a9452(0x17f)][_0x2a9452(0x182)](),_0x102ac2;}),_0x11e129;}async[a169_0x25d5df(0x166)](){const _0x494876=a169_0x25d5df;if(Date[_0x494876(0x16b)]()<this[_0x494876(0x190)])return;await this['refreshToken']();}async[a169_0x25d5df(0x183)](){const _0x132953=a169_0x25d5df,{clientId:_0x541c79,clientSecret:_0x1b064d}=this[_0x132953(0x17f)],_0x38d710=new url_1['URL']('https://bitbucket.org');_0x38d710['username']=_0x541c79,_0x38d710[_0x132953(0x185)]=_0x1b064d,_0x38d710[_0x132953(0x192)]='/site/oauth2/access_token';const {data:_0x593890}=await axios_1[_0x132953(0x168)]['post'](_0x38d710[_0x132953(0x18b)](),_0x132953(0x16e)),{expires_in:_0x5cd7b8,access_token:_0x591608}=_0x593890;this['accessTokenExpiresAt']=Date['now']()+_0x5cd7b8*0x3e8,this[_0x132953(0x17f)][_0x132953(0x16d)](_0x591608);}['getHeaders'](){return{};}[a169_0x25d5df(0x161)](){const _0x1f4cd5=a169_0x25d5df;return this[_0x1f4cd5(0x171)]['get']('user');}async[a169_0x25d5df(0x17e)](){return await this['getCurrentUser'](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1['Service'])(),__param(0x0,(0x0,typedi_1[a169_0x25d5df(0x169)])(providers_tokens_1[a169_0x25d5df(0x18e)][a169_0x25d5df(0x167)])),__param(0x1,(0x0,typedi_1[a169_0x25d5df(0x169)])(providers_tokens_1['Tokens'][a169_0x25d5df(0x17f)])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1['BitbucketCredentialsDto']])],BitbucketApiService),exports[a169_0x25d5df(0x17b)]=BitbucketApiService;