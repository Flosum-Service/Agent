const a123_0x57a953=a123_0x19db;(function(_0x139dba,_0x28d912){const _0x42f69f=a123_0x19db,_0x543a72=_0x139dba();while(!![]){try{const _0x4dff23=-parseInt(_0x42f69f(0xd2))/0x1+-parseInt(_0x42f69f(0xa8))/0x2*(-parseInt(_0x42f69f(0xc2))/0x3)+-parseInt(_0x42f69f(0xc4))/0x4+parseInt(_0x42f69f(0xa2))/0x5+-parseInt(_0x42f69f(0xd0))/0x6+-parseInt(_0x42f69f(0xaf))/0x7+parseInt(_0x42f69f(0xb8))/0x8*(parseInt(_0x42f69f(0xc7))/0x9);if(_0x4dff23===_0x28d912)break;else _0x543a72['push'](_0x543a72['shift']());}catch(_0x4e0e19){_0x543a72['push'](_0x543a72['shift']());}}}(a123_0x5015,0x3b6f1));const a123_0x555537=(function(){let _0x399280=!![];return function(_0x1959af,_0x103463){const _0x2e29d6=_0x399280?function(){const _0x4a3903=a123_0x19db;if(_0x103463){const _0x12200c=_0x103463[_0x4a3903(0xc9)](_0x1959af,arguments);return _0x103463=null,_0x12200c;}}:function(){};return _0x399280=![],_0x2e29d6;};}()),a123_0x26a56d=a123_0x555537(this,function(){const _0x487996=a123_0x19db;return a123_0x26a56d[_0x487996(0xba)]()[_0x487996(0xa1)](_0x487996(0xac))[_0x487996(0xba)]()[_0x487996(0xad)](a123_0x26a56d)[_0x487996(0xa1)](_0x487996(0xac));});a123_0x26a56d();'use strict';function a123_0x5015(){const _0x4883f9=['refreshToken','headers','length','/site/oauth2/access_token','credentials','provider','Service','93GVIrxf','typedi','105932TXPChF','username','post','4394439lCKOMH','https://bitbucket.org','apply','use','getAuthorizationHeader','isLoggedIn','user','__importDefault','../types/git-provider','1549668tdbmWu','pathname','264979vbfdES','password','metadata','__esModule','../credentials/dto/bitbucket-credentials.dto','createRequest','getCurrentUser','search','1315065fqjzeg','object','getHeaders','request','grant_type=client_credentials','checkAccessToken','27910lcsmVh','__metadata','interceptors','URL','(((.+)+)+)+$','constructor','GitApiService','2734956bVbBZH','BitbucketApiService','function','Authorization','accessTokenExpiresAt','axios','__param','defineProperty','Inject','8yZFGTP','Tokens','toString'];a123_0x5015=function(){return _0x4883f9;};return a123_0x5015();}var __decorate=this&&this['__decorate']||function(_0x29ba6d,_0x15c56e,_0x5e90f0,_0x12119d){const _0x1a3a05=a123_0x19db;var _0x20dead=arguments[_0x1a3a05(0xbd)],_0x185154=_0x20dead<0x3?_0x15c56e:_0x12119d===null?_0x12119d=Object['getOwnPropertyDescriptor'](_0x15c56e,_0x5e90f0):_0x12119d,_0x3c015d;if(typeof Reflect===_0x1a3a05(0xa3)&&typeof Reflect['decorate']===_0x1a3a05(0xb1))_0x185154=Reflect['decorate'](_0x29ba6d,_0x15c56e,_0x5e90f0,_0x12119d);else{for(var _0x51cac1=_0x29ba6d[_0x1a3a05(0xbd)]-0x1;_0x51cac1>=0x0;_0x51cac1--)if(_0x3c015d=_0x29ba6d[_0x51cac1])_0x185154=(_0x20dead<0x3?_0x3c015d(_0x185154):_0x20dead>0x3?_0x3c015d(_0x15c56e,_0x5e90f0,_0x185154):_0x3c015d(_0x15c56e,_0x5e90f0))||_0x185154;}return _0x20dead>0x3&&_0x185154&&Object[_0x1a3a05(0xb6)](_0x15c56e,_0x5e90f0,_0x185154),_0x185154;},__metadata=this&&this[a123_0x57a953(0xa9)]||function(_0x535718,_0x23fb01){const _0x4c3ca1=a123_0x57a953;if(typeof Reflect===_0x4c3ca1(0xa3)&&typeof Reflect[_0x4c3ca1(0xd4)]===_0x4c3ca1(0xb1))return Reflect[_0x4c3ca1(0xd4)](_0x535718,_0x23fb01);},__param=this&&this[a123_0x57a953(0xb5)]||function(_0x438a1a,_0x42ef9a){return function(_0x4540ab,_0x1a6b70){_0x42ef9a(_0x4540ab,_0x1a6b70,_0x438a1a);};},__importDefault=this&&this[a123_0x57a953(0xce)]||function(_0x3cf2c6){const _0x1439a6=a123_0x57a953;return _0x3cf2c6&&_0x3cf2c6[_0x1439a6(0xd5)]?_0x3cf2c6:{'default':_0x3cf2c6};};Object[a123_0x57a953(0xb6)](exports,a123_0x57a953(0xd5),{'value':!![]}),exports[a123_0x57a953(0xb0)]=void 0x0;function a123_0x19db(_0x111404,_0xce7539){const _0xb3f511=a123_0x5015();return a123_0x19db=function(_0x26a56d,_0x555537){_0x26a56d=_0x26a56d-0x9e;let _0x501532=_0xb3f511[_0x26a56d];return _0x501532;},a123_0x19db(_0x111404,_0xce7539);}const axios_1=__importDefault(require(a123_0x57a953(0xb4))),typedi_1=require(a123_0x57a953(0xc3)),git_api_service_1=require('./git-api.service'),bitbucket_credentials_dto_1=require(a123_0x57a953(0x9e)),providers_tokens_1=require('../providers.tokens'),git_provider_1=require(a123_0x57a953(0xcf)),url_1=require('url');let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a123_0x57a953(0xae)]{constructor(_0x2b60aa,_0x43a153){const _0x73fee1=a123_0x57a953;super(_0x2b60aa,_0x43a153),this[_0x73fee1(0xb3)]=-0x1,this['MAX_REQUEST_PER_HOUR']=0x3e8;}[a123_0x57a953(0x9f)](_0x389c9c){const _0x4ca649=a123_0x57a953,_0x2bc7d4=super[_0x4ca649(0x9f)](_0x389c9c);return _0x2bc7d4[_0x4ca649(0xaa)][_0x4ca649(0xa5)][_0x4ca649(0xca)](async _0x53e701=>{const _0x3ce8bc=_0x4ca649;return await this['checkAccessToken'](),_0x53e701[_0x3ce8bc(0xbc)]||(_0x53e701['headers']={}),_0x53e701[_0x3ce8bc(0xbc)][_0x3ce8bc(0xb2)]=this[_0x3ce8bc(0xbf)][_0x3ce8bc(0xcb)](),_0x53e701;}),_0x2bc7d4;}async[a123_0x57a953(0xa7)](){const _0x4015c9=a123_0x57a953;if(Date['now']()<this['accessTokenExpiresAt'])return;await this[_0x4015c9(0xbb)]();}async['refreshToken'](){const _0x39735d=a123_0x57a953,{clientId:_0x386039,clientSecret:_0x54825f}=this[_0x39735d(0xbf)],_0x18b39d=new url_1[(_0x39735d(0xab))](_0x39735d(0xc8));_0x18b39d[_0x39735d(0xc5)]=_0x386039,_0x18b39d[_0x39735d(0xd3)]=_0x54825f,_0x18b39d[_0x39735d(0xd1)]=_0x39735d(0xbe);const {data:_0x31cff7}=await axios_1['default'][_0x39735d(0xc6)](_0x18b39d['toString'](),_0x39735d(0xa6)),{expires_in:_0x40bfb1,access_token:_0x27309c}=_0x31cff7;this[_0x39735d(0xb3)]=Date['now']()+_0x40bfb1*0x3e8,this[_0x39735d(0xbf)]['setAccessToken'](_0x27309c);}[a123_0x57a953(0xa4)](){return{};}[a123_0x57a953(0xa0)](){const _0x1d6fcf=a123_0x57a953;return this['request']['get'](_0x1d6fcf(0xcd));}async[a123_0x57a953(0xcc)](){return await this['getCurrentUser'](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a123_0x57a953(0xc1)])(),__param(0x0,(0x0,typedi_1[a123_0x57a953(0xb7)])(providers_tokens_1['Tokens'][a123_0x57a953(0xc0)])),__param(0x1,(0x0,typedi_1[a123_0x57a953(0xb7)])(providers_tokens_1[a123_0x57a953(0xb9)][a123_0x57a953(0xbf)])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1['BitbucketCredentialsDto']])],BitbucketApiService),exports[a123_0x57a953(0xb0)]=BitbucketApiService;