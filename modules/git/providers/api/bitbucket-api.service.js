const a107_0x10e043=a107_0x6e43;(function(_0x22126a,_0x486658){const _0x138c3a=a107_0x6e43,_0x53fcd0=_0x22126a();while(!![]){try{const _0x4a24ec=parseInt(_0x138c3a(0x21d))/0x1*(parseInt(_0x138c3a(0x223))/0x2)+parseInt(_0x138c3a(0x212))/0x3+parseInt(_0x138c3a(0x1f5))/0x4+-parseInt(_0x138c3a(0x205))/0x5*(-parseInt(_0x138c3a(0x1fd))/0x6)+-parseInt(_0x138c3a(0x203))/0x7+parseInt(_0x138c3a(0x20d))/0x8*(-parseInt(_0x138c3a(0x20b))/0x9)+-parseInt(_0x138c3a(0x211))/0xa;if(_0x4a24ec===_0x486658)break;else _0x53fcd0['push'](_0x53fcd0['shift']());}catch(_0x20fa58){_0x53fcd0['push'](_0x53fcd0['shift']());}}}(a107_0x2354,0xe7c80));const a107_0x16111a=(function(){let _0x2b9e59=!![];return function(_0x300499,_0x2c40b5){const _0x24c1dd=_0x2b9e59?function(){const _0x503542=a107_0x6e43;if(_0x2c40b5){const _0x32a405=_0x2c40b5[_0x503542(0x21e)](_0x300499,arguments);return _0x2c40b5=null,_0x32a405;}}:function(){};return _0x2b9e59=![],_0x24c1dd;};}()),a107_0x5a7ac5=a107_0x16111a(this,function(){const _0x40c852=a107_0x6e43;return a107_0x5a7ac5['toString']()[_0x40c852(0x20e)](_0x40c852(0x210))[_0x40c852(0x202)]()[_0x40c852(0x1fe)](a107_0x5a7ac5)['search'](_0x40c852(0x210));});a107_0x5a7ac5();'use strict';function a107_0x6e43(_0xedf461,_0x1bb752){const _0x16af42=a107_0x2354();return a107_0x6e43=function(_0x5a7ac5,_0x16111a){_0x5a7ac5=_0x5a7ac5-0x1ea;let _0x23548e=_0x16af42[_0x5a7ac5];return _0x23548e;},a107_0x6e43(_0xedf461,_0x1bb752);}var __decorate=this&&this[a107_0x10e043(0x218)]||function(_0x3ff51a,_0x377ffc,_0xb92a6e,_0x4e9846){const _0x498f0e=a107_0x10e043;var _0x496842=arguments[_0x498f0e(0x221)],_0x34532a=_0x496842<0x3?_0x377ffc:_0x4e9846===null?_0x4e9846=Object[_0x498f0e(0x214)](_0x377ffc,_0xb92a6e):_0x4e9846,_0x225af6;if(typeof Reflect===_0x498f0e(0x204)&&typeof Reflect[_0x498f0e(0x1f9)]===_0x498f0e(0x20c))_0x34532a=Reflect[_0x498f0e(0x1f9)](_0x3ff51a,_0x377ffc,_0xb92a6e,_0x4e9846);else{for(var _0xb0a286=_0x3ff51a[_0x498f0e(0x221)]-0x1;_0xb0a286>=0x0;_0xb0a286--)if(_0x225af6=_0x3ff51a[_0xb0a286])_0x34532a=(_0x496842<0x3?_0x225af6(_0x34532a):_0x496842>0x3?_0x225af6(_0x377ffc,_0xb92a6e,_0x34532a):_0x225af6(_0x377ffc,_0xb92a6e))||_0x34532a;}return _0x496842>0x3&&_0x34532a&&Object[_0x498f0e(0x21a)](_0x377ffc,_0xb92a6e,_0x34532a),_0x34532a;},__metadata=this&&this[a107_0x10e043(0x224)]||function(_0x1bbb6e,_0x410f2c){const _0x50c664=a107_0x10e043;if(typeof Reflect===_0x50c664(0x204)&&typeof Reflect[_0x50c664(0x207)]===_0x50c664(0x20c))return Reflect[_0x50c664(0x207)](_0x1bbb6e,_0x410f2c);},__param=this&&this['__param']||function(_0x1f6aec,_0x49f63f){return function(_0x2c36cc,_0x3c1aa3){_0x49f63f(_0x2c36cc,_0x3c1aa3,_0x1f6aec);};},__importDefault=this&&this[a107_0x10e043(0x20a)]||function(_0x25eda7){const _0x1791cb=a107_0x10e043;return _0x25eda7&&_0x25eda7[_0x1791cb(0x1fa)]?_0x25eda7:{'default':_0x25eda7};};Object[a107_0x10e043(0x21a)](exports,'__esModule',{'value':!![]}),exports[a107_0x10e043(0x21f)]=void 0x0;function a107_0x2354(){const _0x464fc6=['refreshToken','BitbucketCredentialsDto','../types/git-provider','https://bitbucket.org','getCurrentUser','checkAccessToken','provider','request','interceptors','Tokens','password','headers','5442144ZvayRA','createRequest','pathname','design:paramtypes','decorate','__esModule','../credentials/dto/bitbucket-credentials.dto','../providers.tokens','6FIKSSK','constructor','username','URL','use','toString','8226274lkVzCp','object','3070355mIgLFy','getHeaders','metadata','Authorization','Inject','__importDefault','27ySdQXw','function','673520dnmMIy','search','default','(((.+)+)+)+$','25496740ckWnKS','3820632QZKJEs','GitApiService','getOwnPropertyDescriptor','isLoggedIn','setAccessToken','Service','__decorate','accessTokenExpiresAt','defineProperty','now','credentials','13kFPEol','apply','BitbucketApiService','./git-api.service','length','post','258254rfIqYh','__metadata'];a107_0x2354=function(){return _0x464fc6;};return a107_0x2354();}const axios_1=__importDefault(require('axios')),typedi_1=require('typedi'),git_api_service_1=require(a107_0x10e043(0x220)),bitbucket_credentials_dto_1=require(a107_0x10e043(0x1fb)),providers_tokens_1=require(a107_0x10e043(0x1fc)),git_provider_1=require(a107_0x10e043(0x1eb)),url_1=require('url');let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a107_0x10e043(0x213)]{constructor(_0x559177,_0x3e8c5){super(_0x559177,_0x3e8c5),this['accessTokenExpiresAt']=-0x1,this['MAX_REQUEST_PER_HOUR']=0x3e8;}[a107_0x10e043(0x1f6)](_0x3d3f52){const _0x2804b3=a107_0x10e043,_0x540a26=super[_0x2804b3(0x1f6)](_0x3d3f52);return _0x540a26[_0x2804b3(0x1f1)]['request'][_0x2804b3(0x201)](async _0x2a3b05=>{const _0x1ebd8f=_0x2804b3;return await this[_0x1ebd8f(0x1ee)](),_0x2a3b05[_0x1ebd8f(0x1f4)][_0x1ebd8f(0x208)]=this['credentials']['getAuthorizationHeader'](),_0x2a3b05;}),_0x540a26;}async[a107_0x10e043(0x1ee)](){const _0x671d26=a107_0x10e043;if(Date[_0x671d26(0x21b)]()<this[_0x671d26(0x219)])return;await this[_0x671d26(0x225)]();}async['refreshToken'](){const _0x712059=a107_0x10e043,{clientId:_0x39150e,clientSecret:_0x52ae9b}=this[_0x712059(0x21c)],_0x1bb97d=new url_1[(_0x712059(0x200))](_0x712059(0x1ec));_0x1bb97d[_0x712059(0x1ff)]=_0x39150e,_0x1bb97d[_0x712059(0x1f3)]=_0x52ae9b,_0x1bb97d[_0x712059(0x1f7)]='/site/oauth2/access_token';const {data:_0xbf245c}=await axios_1[_0x712059(0x20f)][_0x712059(0x222)](_0x1bb97d[_0x712059(0x202)](),'grant_type=client_credentials'),{expires_in:_0x591b45,access_token:_0x234d53}=_0xbf245c;this['accessTokenExpiresAt']=Date[_0x712059(0x21b)]()+_0x591b45*0x3e8,this[_0x712059(0x21c)][_0x712059(0x216)](_0x234d53);}[a107_0x10e043(0x206)](){return{};}['getCurrentUser'](){const _0x13b6af=a107_0x10e043;return this[_0x13b6af(0x1f0)]['get']('user');}async[a107_0x10e043(0x215)](){const _0x411113=a107_0x10e043;return await this[_0x411113(0x1ed)](),!![];}};BitbucketApiService=__decorate([typedi_1[a107_0x10e043(0x217)](),__param(0x0,typedi_1[a107_0x10e043(0x209)](providers_tokens_1[a107_0x10e043(0x1f2)][a107_0x10e043(0x1ef)])),__param(0x1,typedi_1[a107_0x10e043(0x209)](providers_tokens_1[a107_0x10e043(0x1f2)][a107_0x10e043(0x21c)])),__metadata(a107_0x10e043(0x1f8),[String,bitbucket_credentials_dto_1[a107_0x10e043(0x1ea)]])],BitbucketApiService),exports[a107_0x10e043(0x21f)]=BitbucketApiService;