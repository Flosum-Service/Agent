const a158_0x3156ef=a158_0x4cd8;function a158_0x534a(){const _0x54b6b8=['checkAccessToken','decorate','search','grant_type=client_credentials','BitbucketApiService','url','default','URL','258zYMXWN','Authorization','MAX_REQUEST_PER_HOUR','__esModule','__metadata','interceptors','getAuthorizationHeader','146762zAbaTl','typedi','11838310SgKNao','../types/git-provider','Tokens','20LrLmaQ','request','headers','axios','__importDefault','createRequest','(((.+)+)+)+$','credentials','password','2521113aeWWsx','object','BitbucketCredentialsDto','toString','metadata','./git-api.service','__decorate','apply','use','__param','Inject','1407098xTEyEf','defineProperty','../credentials/dto/bitbucket-credentials.dto','9279ZcqOcY','Service','GitApiService','6352MPiCiV','1UTTVgO','username','length','getCurrentUser','refreshToken','24DrJARX','function','getOwnPropertyDescriptor','accessTokenExpiresAt','22722865EdZZCK','297625ByQSni','https://bitbucket.org'];a158_0x534a=function(){return _0x54b6b8;};return a158_0x534a();}(function(_0x5188b4,_0x165af3){const _0x36ca32=a158_0x4cd8,_0x160c31=_0x5188b4();while(!![]){try{const _0xd78606=-parseInt(_0x36ca32(0x133))/0x1*(-parseInt(_0x36ca32(0x12c))/0x2)+parseInt(_0x36ca32(0x121))/0x3+parseInt(_0x36ca32(0x118))/0x4*(parseInt(_0x36ca32(0x13d))/0x5)+-parseInt(_0x36ca32(0x147))/0x6*(-parseInt(_0x36ca32(0x113))/0x7)+-parseInt(_0x36ca32(0x132))/0x8*(-parseInt(_0x36ca32(0x12f))/0x9)+parseInt(_0x36ca32(0x115))/0xa+-parseInt(_0x36ca32(0x13c))/0xb*(parseInt(_0x36ca32(0x138))/0xc);if(_0xd78606===_0x165af3)break;else _0x160c31['push'](_0x160c31['shift']());}catch(_0x419f76){_0x160c31['push'](_0x160c31['shift']());}}}(a158_0x534a,0x95ed2));const a158_0x26856e=(function(){let _0xae54bb=!![];return function(_0x16ba6f,_0xfbb8a0){const _0x5e624d=_0xae54bb?function(){const _0x48564b=a158_0x4cd8;if(_0xfbb8a0){const _0x421189=_0xfbb8a0[_0x48564b(0x128)](_0x16ba6f,arguments);return _0xfbb8a0=null,_0x421189;}}:function(){};return _0xae54bb=![],_0x5e624d;};}()),a158_0x194d1c=a158_0x26856e(this,function(){const _0x260f92=a158_0x4cd8;return a158_0x194d1c[_0x260f92(0x124)]()['search'](_0x260f92(0x11e))[_0x260f92(0x124)]()['constructor'](a158_0x194d1c)[_0x260f92(0x141)]('(((.+)+)+)+$');});a158_0x194d1c();function a158_0x4cd8(_0x2c31c1,_0x47b0f2){const _0x3660f5=a158_0x534a();return a158_0x4cd8=function(_0x194d1c,_0x26856e){_0x194d1c=_0x194d1c-0x110;let _0x534aee=_0x3660f5[_0x194d1c];return _0x534aee;},a158_0x4cd8(_0x2c31c1,_0x47b0f2);}'use strict';var __decorate=this&&this[a158_0x3156ef(0x127)]||function(_0x1a0046,_0x1d5bf2,_0x24738b,_0x402f75){const _0x1549a4=a158_0x3156ef;var _0x2e8f28=arguments[_0x1549a4(0x135)],_0x36733a=_0x2e8f28<0x3?_0x1d5bf2:_0x402f75===null?_0x402f75=Object[_0x1549a4(0x13a)](_0x1d5bf2,_0x24738b):_0x402f75,_0x44e23b;if(typeof Reflect===_0x1549a4(0x122)&&typeof Reflect['decorate']===_0x1549a4(0x139))_0x36733a=Reflect[_0x1549a4(0x140)](_0x1a0046,_0x1d5bf2,_0x24738b,_0x402f75);else{for(var _0x48504d=_0x1a0046[_0x1549a4(0x135)]-0x1;_0x48504d>=0x0;_0x48504d--)if(_0x44e23b=_0x1a0046[_0x48504d])_0x36733a=(_0x2e8f28<0x3?_0x44e23b(_0x36733a):_0x2e8f28>0x3?_0x44e23b(_0x1d5bf2,_0x24738b,_0x36733a):_0x44e23b(_0x1d5bf2,_0x24738b))||_0x36733a;}return _0x2e8f28>0x3&&_0x36733a&&Object[_0x1549a4(0x12d)](_0x1d5bf2,_0x24738b,_0x36733a),_0x36733a;},__metadata=this&&this[a158_0x3156ef(0x110)]||function(_0xce8758,_0x4eba1b){const _0x1d6844=a158_0x3156ef;if(typeof Reflect===_0x1d6844(0x122)&&typeof Reflect[_0x1d6844(0x125)]===_0x1d6844(0x139))return Reflect[_0x1d6844(0x125)](_0xce8758,_0x4eba1b);},__param=this&&this[a158_0x3156ef(0x12a)]||function(_0x465225,_0x551bd9){return function(_0x1b531c,_0x4ecfac){_0x551bd9(_0x1b531c,_0x4ecfac,_0x465225);};},__importDefault=this&&this[a158_0x3156ef(0x11c)]||function(_0x45efc2){const _0x50ded0=a158_0x3156ef;return _0x45efc2&&_0x45efc2[_0x50ded0(0x14a)]?_0x45efc2:{'default':_0x45efc2};};Object[a158_0x3156ef(0x12d)](exports,a158_0x3156ef(0x14a),{'value':!![]}),exports[a158_0x3156ef(0x143)]=void 0x0;const axios_1=__importDefault(require(a158_0x3156ef(0x11b))),typedi_1=require(a158_0x3156ef(0x114)),git_api_service_1=require(a158_0x3156ef(0x126)),bitbucket_credentials_dto_1=require(a158_0x3156ef(0x12e)),providers_tokens_1=require('../providers.tokens'),git_provider_1=require(a158_0x3156ef(0x116)),url_1=require(a158_0x3156ef(0x144));let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a158_0x3156ef(0x131)]{constructor(_0x4130a3,_0x529118){const _0x2a20c3=a158_0x3156ef;super(_0x4130a3,_0x529118),this['accessTokenExpiresAt']=-0x1,this[_0x2a20c3(0x149)]=0x3e8;}[a158_0x3156ef(0x11d)](_0x5ad746){const _0x50682b=a158_0x3156ef,_0xafada=super[_0x50682b(0x11d)](_0x5ad746);return _0xafada[_0x50682b(0x111)][_0x50682b(0x119)][_0x50682b(0x129)](async _0x1e5563=>{const _0x4c7106=_0x50682b;return await this[_0x4c7106(0x13f)](),_0x1e5563[_0x4c7106(0x11a)][_0x4c7106(0x148)]=this[_0x4c7106(0x11f)][_0x4c7106(0x112)](),_0x1e5563;}),_0xafada;}async[a158_0x3156ef(0x13f)](){const _0x35ff42=a158_0x3156ef;if(Date['now']()<this[_0x35ff42(0x13b)])return;await this['refreshToken']();}async[a158_0x3156ef(0x137)](){const _0x9f97bd=a158_0x3156ef,{clientId:_0xe93119,clientSecret:_0x5052c9}=this[_0x9f97bd(0x11f)],_0x3d3c30=new url_1[(_0x9f97bd(0x146))](_0x9f97bd(0x13e));_0x3d3c30[_0x9f97bd(0x134)]=_0xe93119,_0x3d3c30[_0x9f97bd(0x120)]=_0x5052c9,_0x3d3c30['pathname']='/site/oauth2/access_token';const {data:_0x1cf906}=await axios_1[_0x9f97bd(0x145)]['post'](_0x3d3c30['toString'](),_0x9f97bd(0x142)),{expires_in:_0x299dc1,access_token:_0x20cabe}=_0x1cf906;this[_0x9f97bd(0x13b)]=Date['now']()+_0x299dc1*0x3e8,this[_0x9f97bd(0x11f)]['setAccessToken'](_0x20cabe);}['getHeaders'](){return{};}[a158_0x3156ef(0x136)](){const _0x562de1=a158_0x3156ef;return this[_0x562de1(0x119)]['get']('user');}async['isLoggedIn'](){const _0x3e48bf=a158_0x3156ef;return await this[_0x3e48bf(0x136)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a158_0x3156ef(0x130)])(),__param(0x0,(0x0,typedi_1[a158_0x3156ef(0x12b)])(providers_tokens_1[a158_0x3156ef(0x117)]['provider'])),__param(0x1,(0x0,typedi_1['Inject'])(providers_tokens_1['Tokens'][a158_0x3156ef(0x11f)])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1[a158_0x3156ef(0x123)]])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;