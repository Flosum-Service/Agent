const a158_0x1ecfe8=a158_0x2b18;(function(_0x1d1645,_0x579503){const _0xb31206=a158_0x2b18,_0x20c887=_0x1d1645();while(!![]){try{const _0x5befeb=parseInt(_0xb31206(0xf4))/0x1*(parseInt(_0xb31206(0xf6))/0x2)+parseInt(_0xb31206(0x101))/0x3+parseInt(_0xb31206(0xc7))/0x4*(-parseInt(_0xb31206(0xfe))/0x5)+parseInt(_0xb31206(0xdf))/0x6+parseInt(_0xb31206(0xe0))/0x7+-parseInt(_0xb31206(0xce))/0x8*(parseInt(_0xb31206(0xfd))/0x9)+-parseInt(_0xb31206(0xed))/0xa*(parseInt(_0xb31206(0xec))/0xb);if(_0x5befeb===_0x579503)break;else _0x20c887['push'](_0x20c887['shift']());}catch(_0x41c780){_0x20c887['push'](_0x20c887['shift']());}}}(a158_0x4925,0x4176c));const a158_0x56e5f2=(function(){let _0x5009e3=!![];return function(_0x5bfa41,_0x36d682){const _0x367c98=_0x5009e3?function(){if(_0x36d682){const _0x51fda9=_0x36d682['apply'](_0x5bfa41,arguments);return _0x36d682=null,_0x51fda9;}}:function(){};return _0x5009e3=![],_0x367c98;};}()),a158_0x5b6cbf=a158_0x56e5f2(this,function(){const _0x5d2132=a158_0x2b18;return a158_0x5b6cbf['toString']()[_0x5d2132(0xe4)](_0x5d2132(0xd7))[_0x5d2132(0xf9)]()[_0x5d2132(0xea)](a158_0x5b6cbf)['search'](_0x5d2132(0xd7));});a158_0x5b6cbf();function a158_0x4925(){const _0x48922c=['search','defineProperty','__metadata','headers','getAuthorizationHeader','default','constructor','grant_type=client_credentials','22MRrxON','1333590HwzPtG','username','BitbucketApiService','__importDefault','__param','object','pathname','1gemfyd','BitbucketCredentialsDto','954310GngyEr','provider','https://bitbucket.org','toString','password','credentials','checkAccessToken','116046JzanBC','23135TwaLUt','__esModule','../types/git-provider','296010fpKqFQ','356gBMyhM','request','getOwnPropertyDescriptor','now','design:paramtypes','accessTokenExpiresAt','function','152mZwMfp','MAX_REQUEST_PER_HOUR','createRequest','Inject','metadata','length','get','setAccessToken','post','(((.+)+)+)+$','Tokens','getHeaders','getCurrentUser','user','URL','decorate','./git-api.service','2564562imqsQk','1318765ltGDDe','refreshToken','url','../providers.tokens'];a158_0x4925=function(){return _0x48922c;};return a158_0x4925();}function a158_0x2b18(_0x419c98,_0x53161d){const _0x403774=a158_0x4925();return a158_0x2b18=function(_0x5b6cbf,_0x56e5f2){_0x5b6cbf=_0x5b6cbf-0xc7;let _0x492555=_0x403774[_0x5b6cbf];return _0x492555;},a158_0x2b18(_0x419c98,_0x53161d);}'use strict';var __decorate=this&&this['__decorate']||function(_0x561184,_0x3ab710,_0x2e39ff,_0x2a3375){const _0x21772a=a158_0x2b18;var _0x3f002a=arguments[_0x21772a(0xd3)],_0x539a92=_0x3f002a<0x3?_0x3ab710:_0x2a3375===null?_0x2a3375=Object[_0x21772a(0xc9)](_0x3ab710,_0x2e39ff):_0x2a3375,_0x1d0bf3;if(typeof Reflect===_0x21772a(0xf2)&&typeof Reflect['decorate']===_0x21772a(0xcd))_0x539a92=Reflect[_0x21772a(0xdd)](_0x561184,_0x3ab710,_0x2e39ff,_0x2a3375);else{for(var _0x158d5a=_0x561184[_0x21772a(0xd3)]-0x1;_0x158d5a>=0x0;_0x158d5a--)if(_0x1d0bf3=_0x561184[_0x158d5a])_0x539a92=(_0x3f002a<0x3?_0x1d0bf3(_0x539a92):_0x3f002a>0x3?_0x1d0bf3(_0x3ab710,_0x2e39ff,_0x539a92):_0x1d0bf3(_0x3ab710,_0x2e39ff))||_0x539a92;}return _0x3f002a>0x3&&_0x539a92&&Object[_0x21772a(0xe5)](_0x3ab710,_0x2e39ff,_0x539a92),_0x539a92;},__metadata=this&&this[a158_0x1ecfe8(0xe6)]||function(_0x18d416,_0xde0bb7){const _0x36e326=a158_0x1ecfe8;if(typeof Reflect===_0x36e326(0xf2)&&typeof Reflect[_0x36e326(0xd2)]==='function')return Reflect[_0x36e326(0xd2)](_0x18d416,_0xde0bb7);},__param=this&&this[a158_0x1ecfe8(0xf1)]||function(_0xcd6d28,_0x21fbca){return function(_0x40d5d5,_0x560ede){_0x21fbca(_0x40d5d5,_0x560ede,_0xcd6d28);};},__importDefault=this&&this[a158_0x1ecfe8(0xf0)]||function(_0xb5cff8){const _0x266299=a158_0x1ecfe8;return _0xb5cff8&&_0xb5cff8[_0x266299(0xff)]?_0xb5cff8:{'default':_0xb5cff8};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a158_0x1ecfe8(0xef)]=void 0x0;const axios_1=__importDefault(require('axios')),typedi_1=require('typedi'),git_api_service_1=require(a158_0x1ecfe8(0xde)),bitbucket_credentials_dto_1=require('../credentials/dto/bitbucket-credentials.dto'),providers_tokens_1=require(a158_0x1ecfe8(0xe3)),git_provider_1=require(a158_0x1ecfe8(0x100)),url_1=require(a158_0x1ecfe8(0xe2));let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x4118b8,_0x537f0e){const _0x3753ce=a158_0x1ecfe8;super(_0x4118b8,_0x537f0e),this[_0x3753ce(0xcc)]=-0x1,this[_0x3753ce(0xcf)]=0x3e8;}['createRequest'](_0x2fb370){const _0x14622e=a158_0x1ecfe8,_0x3ebdf6=super[_0x14622e(0xd0)](_0x2fb370);return _0x3ebdf6['interceptors'][_0x14622e(0xc8)]['use'](async _0x2c8838=>{const _0xcbf7df=_0x14622e;return await this[_0xcbf7df(0xfc)](),_0x2c8838[_0xcbf7df(0xe7)]['Authorization']=this[_0xcbf7df(0xfb)][_0xcbf7df(0xe8)](),_0x2c8838;}),_0x3ebdf6;}async[a158_0x1ecfe8(0xfc)](){const _0x1ede67=a158_0x1ecfe8;if(Date[_0x1ede67(0xca)]()<this[_0x1ede67(0xcc)])return;await this[_0x1ede67(0xe1)]();}async['refreshToken'](){const _0x35a778=a158_0x1ecfe8,{clientId:_0x156c45,clientSecret:_0x515108}=this['credentials'],_0x5f5960=new url_1[(_0x35a778(0xdc))](_0x35a778(0xf8));_0x5f5960[_0x35a778(0xee)]=_0x156c45,_0x5f5960[_0x35a778(0xfa)]=_0x515108,_0x5f5960[_0x35a778(0xf3)]='/site/oauth2/access_token';const {data:_0x5ee3b6}=await axios_1[_0x35a778(0xe9)][_0x35a778(0xd6)](_0x5f5960['toString'](),_0x35a778(0xeb)),{expires_in:_0x922c50,access_token:_0x3f35fd}=_0x5ee3b6;this['accessTokenExpiresAt']=Date[_0x35a778(0xca)]()+_0x922c50*0x3e8,this[_0x35a778(0xfb)][_0x35a778(0xd5)](_0x3f35fd);}[a158_0x1ecfe8(0xd9)](){return{};}[a158_0x1ecfe8(0xda)](){const _0x279105=a158_0x1ecfe8;return this[_0x279105(0xc8)][_0x279105(0xd4)](_0x279105(0xdb));}async['isLoggedIn'](){return await this['getCurrentUser'](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1['Service'])(),__param(0x0,(0x0,typedi_1[a158_0x1ecfe8(0xd1)])(providers_tokens_1[a158_0x1ecfe8(0xd8)][a158_0x1ecfe8(0xf7)])),__param(0x1,(0x0,typedi_1[a158_0x1ecfe8(0xd1)])(providers_tokens_1[a158_0x1ecfe8(0xd8)][a158_0x1ecfe8(0xfb)])),__metadata(a158_0x1ecfe8(0xcb),[String,bitbucket_credentials_dto_1[a158_0x1ecfe8(0xf5)]])],BitbucketApiService),exports['BitbucketApiService']=BitbucketApiService;