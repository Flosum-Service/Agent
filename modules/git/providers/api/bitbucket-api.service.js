const a157_0x1eaaff=a157_0x5787;(function(_0x1d4a69,_0x299fb2){const _0x382698=a157_0x5787,_0x56e3d0=_0x1d4a69();while(!![]){try{const _0x406bf9=-parseInt(_0x382698(0x193))/0x1*(parseInt(_0x382698(0x1a5))/0x2)+parseInt(_0x382698(0x173))/0x3*(parseInt(_0x382698(0x199))/0x4)+-parseInt(_0x382698(0x17d))/0x5+parseInt(_0x382698(0x1a7))/0x6*(parseInt(_0x382698(0x178))/0x7)+parseInt(_0x382698(0x1a1))/0x8+parseInt(_0x382698(0x19e))/0x9*(-parseInt(_0x382698(0x17b))/0xa)+parseInt(_0x382698(0x17a))/0xb*(parseInt(_0x382698(0x179))/0xc);if(_0x406bf9===_0x299fb2)break;else _0x56e3d0['push'](_0x56e3d0['shift']());}catch(_0x370db9){_0x56e3d0['push'](_0x56e3d0['shift']());}}}(a157_0x178b,0x36f25));const a157_0x805199=(function(){let _0x3ab268=!![];return function(_0x4dd4ad,_0x15f518){const _0x33de03=_0x3ab268?function(){if(_0x15f518){const _0x3c8bdd=_0x15f518['apply'](_0x4dd4ad,arguments);return _0x15f518=null,_0x3c8bdd;}}:function(){};return _0x3ab268=![],_0x33de03;};}()),a157_0x58d58f=a157_0x805199(this,function(){const _0x39e3f3=a157_0x5787;return a157_0x58d58f[_0x39e3f3(0x188)]()[_0x39e3f3(0x1a9)]('(((.+)+)+)+$')[_0x39e3f3(0x188)]()[_0x39e3f3(0x191)](a157_0x58d58f)['search'](_0x39e3f3(0x198));});a157_0x58d58f();function a157_0x178b(){const _0x132d0a=['search','user','provider','isLoggedIn','headers','../types/git-provider','checkAccessToken','GitApiService','__decorate','BitbucketCredentialsDto','31764vQLLjF','get','object','URL','post','59962YVpzTZ','9550068ZWRDPE','11xgXEom','366090svfhrg','use','1551700PCYyPh','__param','now','createRequest','accessTokenExpiresAt','getAuthorizationHeader','grant_type=client_credentials','/site/oauth2/access_token','username','password','interceptors','toString','https://bitbucket.org','../providers.tokens','Tokens','metadata','Inject','__importDefault','credentials','Service','constructor','refreshToken','1OEQjcb','MAX_REQUEST_PER_HOUR','default','length','typedi','(((.+)+)+)+$','20OXIQMf','function','axios','__metadata','setAccessToken','36OpxNsg','Authorization','request','666384cZFXAo','BitbucketApiService','defineProperty','getCurrentUser','860252YxDjmg','pathname','126laZWxi','getOwnPropertyDescriptor'];a157_0x178b=function(){return _0x132d0a;};return a157_0x178b();}'use strict';function a157_0x5787(_0x38bae9,_0x57e9b9){const _0x59eb9a=a157_0x178b();return a157_0x5787=function(_0x58d58f,_0x805199){_0x58d58f=_0x58d58f-0x16f;let _0x178bae=_0x59eb9a[_0x58d58f];return _0x178bae;},a157_0x5787(_0x38bae9,_0x57e9b9);}var __decorate=this&&this[a157_0x1eaaff(0x171)]||function(_0x30a45f,_0x3b86c4,_0x43fa63,_0x8af4da){const _0x4f78b6=a157_0x1eaaff;var _0x11e11f=arguments['length'],_0x561723=_0x11e11f<0x3?_0x3b86c4:_0x8af4da===null?_0x8af4da=Object[_0x4f78b6(0x1a8)](_0x3b86c4,_0x43fa63):_0x8af4da,_0x1839f6;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x561723=Reflect['decorate'](_0x30a45f,_0x3b86c4,_0x43fa63,_0x8af4da);else{for(var _0x423d30=_0x30a45f[_0x4f78b6(0x196)]-0x1;_0x423d30>=0x0;_0x423d30--)if(_0x1839f6=_0x30a45f[_0x423d30])_0x561723=(_0x11e11f<0x3?_0x1839f6(_0x561723):_0x11e11f>0x3?_0x1839f6(_0x3b86c4,_0x43fa63,_0x561723):_0x1839f6(_0x3b86c4,_0x43fa63))||_0x561723;}return _0x11e11f>0x3&&_0x561723&&Object['defineProperty'](_0x3b86c4,_0x43fa63,_0x561723),_0x561723;},__metadata=this&&this[a157_0x1eaaff(0x19c)]||function(_0x108c0f,_0x534890){const _0x14e4ed=a157_0x1eaaff;if(typeof Reflect===_0x14e4ed(0x175)&&typeof Reflect['metadata']===_0x14e4ed(0x19a))return Reflect[_0x14e4ed(0x18c)](_0x108c0f,_0x534890);},__param=this&&this[a157_0x1eaaff(0x17e)]||function(_0x44482e,_0x4a8f40){return function(_0x389a24,_0x3857d1){_0x4a8f40(_0x389a24,_0x3857d1,_0x44482e);};},__importDefault=this&&this[a157_0x1eaaff(0x18e)]||function(_0x45ac7d){return _0x45ac7d&&_0x45ac7d['__esModule']?_0x45ac7d:{'default':_0x45ac7d};};Object[a157_0x1eaaff(0x1a3)](exports,'__esModule',{'value':!![]}),exports[a157_0x1eaaff(0x1a2)]=void 0x0;const axios_1=__importDefault(require(a157_0x1eaaff(0x19b))),typedi_1=require(a157_0x1eaaff(0x197)),git_api_service_1=require('./git-api.service'),bitbucket_credentials_dto_1=require('../credentials/dto/bitbucket-credentials.dto'),providers_tokens_1=require(a157_0x1eaaff(0x18a)),git_provider_1=require(a157_0x1eaaff(0x1ae)),url_1=require('url');let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a157_0x1eaaff(0x170)]{constructor(_0x3946d5,_0x46d4bb){const _0x34ac10=a157_0x1eaaff;super(_0x3946d5,_0x46d4bb),this[_0x34ac10(0x181)]=-0x1,this[_0x34ac10(0x194)]=0x3e8;}['createRequest'](_0x7decbc){const _0x5918e8=a157_0x1eaaff,_0x1e03ce=super[_0x5918e8(0x180)](_0x7decbc);return _0x1e03ce[_0x5918e8(0x187)][_0x5918e8(0x1a0)][_0x5918e8(0x17c)](async _0x1785ae=>{const _0x4770bd=_0x5918e8;return await this['checkAccessToken'](),_0x1785ae[_0x4770bd(0x1ad)][_0x4770bd(0x19f)]=this[_0x4770bd(0x18f)][_0x4770bd(0x182)](),_0x1785ae;}),_0x1e03ce;}async[a157_0x1eaaff(0x16f)](){const _0x4c198=a157_0x1eaaff;if(Date['now']()<this[_0x4c198(0x181)])return;await this[_0x4c198(0x192)]();}async[a157_0x1eaaff(0x192)](){const _0x3c2cc8=a157_0x1eaaff,{clientId:_0xa635ea,clientSecret:_0x3bd589}=this['credentials'],_0x2e6836=new url_1[(_0x3c2cc8(0x176))](_0x3c2cc8(0x189));_0x2e6836[_0x3c2cc8(0x185)]=_0xa635ea,_0x2e6836[_0x3c2cc8(0x186)]=_0x3bd589,_0x2e6836[_0x3c2cc8(0x1a6)]=_0x3c2cc8(0x184);const {data:_0x177cd5}=await axios_1[_0x3c2cc8(0x195)][_0x3c2cc8(0x177)](_0x2e6836['toString'](),_0x3c2cc8(0x183)),{expires_in:_0x2f4223,access_token:_0x3258a5}=_0x177cd5;this[_0x3c2cc8(0x181)]=Date[_0x3c2cc8(0x17f)]()+_0x2f4223*0x3e8,this[_0x3c2cc8(0x18f)][_0x3c2cc8(0x19d)](_0x3258a5);}['getHeaders'](){return{};}['getCurrentUser'](){const _0x637fbe=a157_0x1eaaff;return this[_0x637fbe(0x1a0)][_0x637fbe(0x174)](_0x637fbe(0x1aa));}async[a157_0x1eaaff(0x1ac)](){const _0x278335=a157_0x1eaaff;return await this[_0x278335(0x1a4)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a157_0x1eaaff(0x190)])(),__param(0x0,(0x0,typedi_1[a157_0x1eaaff(0x18d)])(providers_tokens_1[a157_0x1eaaff(0x18b)][a157_0x1eaaff(0x1ab)])),__param(0x1,(0x0,typedi_1[a157_0x1eaaff(0x18d)])(providers_tokens_1[a157_0x1eaaff(0x18b)]['credentials'])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1[a157_0x1eaaff(0x172)]])],BitbucketApiService),exports[a157_0x1eaaff(0x1a2)]=BitbucketApiService;