const a157_0x58eaae=a157_0x3643;(function(_0x2c3d0b,_0x2c96d3){const _0xc94115=a157_0x3643,_0x489555=_0x2c3d0b();while(!![]){try{const _0xa482cd=-parseInt(_0xc94115(0x90))/0x1+-parseInt(_0xc94115(0x9a))/0x2+parseInt(_0xc94115(0x88))/0x3+-parseInt(_0xc94115(0xb9))/0x4*(-parseInt(_0xc94115(0xad))/0x5)+-parseInt(_0xc94115(0x9c))/0x6+-parseInt(_0xc94115(0xb3))/0x7*(parseInt(_0xc94115(0x99))/0x8)+parseInt(_0xc94115(0xae))/0x9;if(_0xa482cd===_0x2c96d3)break;else _0x489555['push'](_0x489555['shift']());}catch(_0x28d252){_0x489555['push'](_0x489555['shift']());}}}(a157_0x1523,0xabd95));const a157_0x31fd81=(function(){let _0x14c480=!![];return function(_0x4e848e,_0x216586){const _0x35d323=_0x14c480?function(){const _0x4a8a50=a157_0x3643;if(_0x216586){const _0x4d1ada=_0x216586[_0x4a8a50(0xa8)](_0x4e848e,arguments);return _0x216586=null,_0x4d1ada;}}:function(){};return _0x14c480=![],_0x35d323;};}()),a157_0x1e2918=a157_0x31fd81(this,function(){const _0x445495=a157_0x3643;return a157_0x1e2918[_0x445495(0x92)]()[_0x445495(0xa5)]('(((.+)+)+)+$')[_0x445495(0x92)]()[_0x445495(0xa2)](a157_0x1e2918)[_0x445495(0xa5)](_0x445495(0xb0));});a157_0x1e2918();'use strict';var __decorate=this&&this[a157_0x58eaae(0x91)]||function(_0x38a859,_0x22ce43,_0x2f4565,_0x95988b){const _0x1d41cd=a157_0x58eaae;var _0x3a6c60=arguments[_0x1d41cd(0xa6)],_0x95fbaa=_0x3a6c60<0x3?_0x22ce43:_0x95988b===null?_0x95988b=Object['getOwnPropertyDescriptor'](_0x22ce43,_0x2f4565):_0x95988b,_0x294209;if(typeof Reflect==='object'&&typeof Reflect[_0x1d41cd(0x82)]===_0x1d41cd(0xaa))_0x95fbaa=Reflect[_0x1d41cd(0x82)](_0x38a859,_0x22ce43,_0x2f4565,_0x95988b);else{for(var _0xa5ad37=_0x38a859[_0x1d41cd(0xa6)]-0x1;_0xa5ad37>=0x0;_0xa5ad37--)if(_0x294209=_0x38a859[_0xa5ad37])_0x95fbaa=(_0x3a6c60<0x3?_0x294209(_0x95fbaa):_0x3a6c60>0x3?_0x294209(_0x22ce43,_0x2f4565,_0x95fbaa):_0x294209(_0x22ce43,_0x2f4565))||_0x95fbaa;}return _0x3a6c60>0x3&&_0x95fbaa&&Object[_0x1d41cd(0xb5)](_0x22ce43,_0x2f4565,_0x95fbaa),_0x95fbaa;},__metadata=this&&this[a157_0x58eaae(0xa7)]||function(_0x51fbee,_0x1c712a){const _0x1ab686=a157_0x58eaae;if(typeof Reflect==='object'&&typeof Reflect[_0x1ab686(0xa4)]===_0x1ab686(0xaa))return Reflect[_0x1ab686(0xa4)](_0x51fbee,_0x1c712a);},__param=this&&this[a157_0x58eaae(0x8f)]||function(_0x54baed,_0x41dee7){return function(_0x4e49b8,_0x3d45c2){_0x41dee7(_0x4e49b8,_0x3d45c2,_0x54baed);};},__importDefault=this&&this['__importDefault']||function(_0x2281ba){const _0x4b7516=a157_0x58eaae;return _0x2281ba&&_0x2281ba[_0x4b7516(0xa9)]?_0x2281ba:{'default':_0x2281ba};};Object[a157_0x58eaae(0xb5)](exports,a157_0x58eaae(0xa9),{'value':!![]}),exports[a157_0x58eaae(0x8c)]=void 0x0;function a157_0x1523(){const _0x859d94=['typedi','(((.+)+)+)+$','user','url','6058577RcUbTx','getCurrentUser','defineProperty','./git-api.service','get','getHeaders','4sAxamo','decorate','isLoggedIn','username','checkAccessToken','headers','Tokens','3178398DbRpbb','/site/oauth2/access_token','../providers.tokens','setAccessToken','BitbucketApiService','provider','password','__param','661459myclwO','__decorate','toString','Authorization','../credentials/dto/bitbucket-credentials.dto','Service','refreshToken','Inject','request','8GcxtJj','633116ZyWMpk','post','7821648VEFgmJ','axios','../types/git-provider','pathname','interceptors','use','constructor','now','metadata','search','length','__metadata','apply','__esModule','function','accessTokenExpiresAt','credentials','2627895tcEoBq','20393856zqGSSa'];a157_0x1523=function(){return _0x859d94;};return a157_0x1523();}const axios_1=__importDefault(require(a157_0x58eaae(0x9d))),typedi_1=require(a157_0x58eaae(0xaf)),git_api_service_1=require(a157_0x58eaae(0xb6)),bitbucket_credentials_dto_1=require(a157_0x58eaae(0x94)),providers_tokens_1=require(a157_0x58eaae(0x8a)),git_provider_1=require(a157_0x58eaae(0x9e)),url_1=require(a157_0x58eaae(0xb2));function a157_0x3643(_0x45c092,_0xf9dd67){const _0xe7900a=a157_0x1523();return a157_0x3643=function(_0x1e2918,_0x31fd81){_0x1e2918=_0x1e2918-0x82;let _0x152315=_0xe7900a[_0x1e2918];return _0x152315;},a157_0x3643(_0x45c092,_0xf9dd67);}let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x177041,_0x41500c){const _0x33654d=a157_0x58eaae;super(_0x177041,_0x41500c),this[_0x33654d(0xab)]=-0x1,this['MAX_REQUEST_PER_HOUR']=0x3e8;}['createRequest'](_0x2a023c){const _0x5e268f=a157_0x58eaae,_0x3af6b2=super['createRequest'](_0x2a023c);return _0x3af6b2[_0x5e268f(0xa0)][_0x5e268f(0x98)][_0x5e268f(0xa1)](async _0x11694a=>{const _0xcd8c3=_0x5e268f;return await this[_0xcd8c3(0x85)](),_0x11694a[_0xcd8c3(0x86)][_0xcd8c3(0x93)]=this['credentials']['getAuthorizationHeader'](),_0x11694a;}),_0x3af6b2;}async[a157_0x58eaae(0x85)](){const _0x5eb69c=a157_0x58eaae;if(Date[_0x5eb69c(0xa3)]()<this['accessTokenExpiresAt'])return;await this[_0x5eb69c(0x96)]();}async['refreshToken'](){const _0x13cb7=a157_0x58eaae,{clientId:_0x370985,clientSecret:_0x2b0308}=this[_0x13cb7(0xac)],_0x15ced5=new url_1['URL']('https://bitbucket.org');_0x15ced5[_0x13cb7(0x84)]=_0x370985,_0x15ced5[_0x13cb7(0x8e)]=_0x2b0308,_0x15ced5[_0x13cb7(0x9f)]=_0x13cb7(0x89);const {data:_0x234935}=await axios_1['default'][_0x13cb7(0x9b)](_0x15ced5['toString'](),'grant_type=client_credentials'),{expires_in:_0x2e08f0,access_token:_0x47edd1}=_0x234935;this[_0x13cb7(0xab)]=Date[_0x13cb7(0xa3)]()+_0x2e08f0*0x3e8,this[_0x13cb7(0xac)][_0x13cb7(0x8b)](_0x47edd1);}[a157_0x58eaae(0xb8)](){return{};}[a157_0x58eaae(0xb4)](){const _0x10197c=a157_0x58eaae;return this[_0x10197c(0x98)][_0x10197c(0xb7)](_0x10197c(0xb1));}async[a157_0x58eaae(0x83)](){const _0x7c0986=a157_0x58eaae;return await this[_0x7c0986(0xb4)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a157_0x58eaae(0x95)])(),__param(0x0,(0x0,typedi_1[a157_0x58eaae(0x97)])(providers_tokens_1[a157_0x58eaae(0x87)][a157_0x58eaae(0x8d)])),__param(0x1,(0x0,typedi_1[a157_0x58eaae(0x97)])(providers_tokens_1[a157_0x58eaae(0x87)]['credentials'])),__metadata('design:paramtypes',[String,bitbucket_credentials_dto_1['BitbucketCredentialsDto']])],BitbucketApiService),exports[a157_0x58eaae(0x8c)]=BitbucketApiService;