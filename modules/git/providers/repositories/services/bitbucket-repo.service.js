const a166_0x3a20cf=a166_0x288b;(function(_0x35a944,_0x2d22fd){const _0x25749e=a166_0x288b,_0xdfb959=_0x35a944();while(!![]){try{const _0xf796bf=-parseInt(_0x25749e(0xe6))/0x1+-parseInt(_0x25749e(0xf0))/0x2*(parseInt(_0x25749e(0x10d))/0x3)+parseInt(_0x25749e(0xd9))/0x4+-parseInt(_0x25749e(0x110))/0x5*(-parseInt(_0x25749e(0x109))/0x6)+-parseInt(_0x25749e(0x10f))/0x7+-parseInt(_0x25749e(0xe0))/0x8*(parseInt(_0x25749e(0x101))/0x9)+parseInt(_0x25749e(0xdd))/0xa*(parseInt(_0x25749e(0xed))/0xb);if(_0xf796bf===_0x2d22fd)break;else _0xdfb959['push'](_0xdfb959['shift']());}catch(_0x1f304e){_0xdfb959['push'](_0xdfb959['shift']());}}}(a166_0x5357,0xbfdf4));const a166_0x5940e2=(function(){let _0x5af1fd=!![];return function(_0x809fcb,_0x57a692){const _0x4cb1d0=_0x5af1fd?function(){const _0x244898=a166_0x288b;if(_0x57a692){const _0x4200ae=_0x57a692[_0x244898(0x108)](_0x809fcb,arguments);return _0x57a692=null,_0x4200ae;}}:function(){};return _0x5af1fd=![],_0x4cb1d0;};}()),a166_0x568730=a166_0x5940e2(this,function(){const _0x4e980d=a166_0x288b;return a166_0x568730[_0x4e980d(0x11b)]()[_0x4e980d(0xfa)](_0x4e980d(0xe7))[_0x4e980d(0x11b)]()['constructor'](a166_0x568730)[_0x4e980d(0xfa)](_0x4e980d(0xe7));});function a166_0x288b(_0x3933e5,_0x4d8f4b){const _0x1e8f4=a166_0x5357();return a166_0x288b=function(_0x568730,_0x5940e2){_0x568730=_0x568730-0xd9;let _0x53576c=_0x1e8f4[_0x568730];return _0x53576c;},a166_0x288b(_0x3933e5,_0x4d8f4b);}a166_0x568730();'use strict';var __decorate=this&&this[a166_0x3a20cf(0x10e)]||function(_0x167828,_0x90cff7,_0xe382a8,_0x3a63a2){const _0x14cb58=a166_0x3a20cf;var _0x29a609=arguments['length'],_0x59a33d=_0x29a609<0x3?_0x90cff7:_0x3a63a2===null?_0x3a63a2=Object[_0x14cb58(0x117)](_0x90cff7,_0xe382a8):_0x3a63a2,_0x1f59ea;if(typeof Reflect===_0x14cb58(0xfb)&&typeof Reflect[_0x14cb58(0xf2)]===_0x14cb58(0xde))_0x59a33d=Reflect[_0x14cb58(0xf2)](_0x167828,_0x90cff7,_0xe382a8,_0x3a63a2);else{for(var _0x34b136=_0x167828['length']-0x1;_0x34b136>=0x0;_0x34b136--)if(_0x1f59ea=_0x167828[_0x34b136])_0x59a33d=(_0x29a609<0x3?_0x1f59ea(_0x59a33d):_0x29a609>0x3?_0x1f59ea(_0x90cff7,_0xe382a8,_0x59a33d):_0x1f59ea(_0x90cff7,_0xe382a8))||_0x59a33d;}return _0x29a609>0x3&&_0x59a33d&&Object[_0x14cb58(0xe9)](_0x90cff7,_0xe382a8,_0x59a33d),_0x59a33d;},__metadata=this&&this[a166_0x3a20cf(0x113)]||function(_0x6a8c2c,_0x12a80b){const _0x4b9ff5=a166_0x3a20cf;if(typeof Reflect===_0x4b9ff5(0xfb)&&typeof Reflect['metadata']===_0x4b9ff5(0xde))return Reflect['metadata'](_0x6a8c2c,_0x12a80b);},__param=this&&this[a166_0x3a20cf(0xea)]||function(_0x12b27a,_0x109ba5){return function(_0x139391,_0x10e120){_0x109ba5(_0x139391,_0x10e120,_0x12b27a);};};Object[a166_0x3a20cf(0xe9)](exports,a166_0x3a20cf(0x104),{'value':!![]}),exports[a166_0x3a20cf(0xdc)]=void 0x0;function a166_0x5357(){const _0x111d2d=['decorate','GitRepoService','BitbucketApiService','values','delete','put','Inject','getOne','search','object','request','BadRequestError','autoInit','design:paramtypes','apiBody','10606293vsKPSu','getAll','./git-repo.service','__esModule','get','defaultBranch','master','apply','28788vsJMrN','repositories/','map','fromBitbucket','14031xAquCw','__decorate','6623561stWhsR','1180OOujMl','../../../../../core/errors/not-found.error','workspace','__metadata','../repo.class','Repo','next','getOwnPropertyDescriptor','credentials','project','BitbucketCredentialsDto','toString','Tokens','NotFoundError','2597764TkeuaV','post','Git','BitbucketRepoService','7536820WaVFIO','function','../../../internal/git.internal','8rBqrif','../../credentials/dto/bitbucket-credentials.dto','api','../../../../../core/errors/api.error','toLowerCase','update','659830yBfjWh','(((.+)+)+)+$','createEmptyBranch','defineProperty','__param','ApiError','name','33vRCWeu','../../api/bitbucket-api.service','createRequest','202lICCcZ','ERR_BITBUCKET_MISSING_PROJECT'];a166_0x5357=function(){return _0x111d2d;};return a166_0x5357();}const errors_1=require('../../../../../constants/errors'),bad_request_error_1=require('../../../../../core/errors/bad-request.error'),not_found_error_1=require(a166_0x3a20cf(0x111)),bitbucket_api_service_1=require(a166_0x3a20cf(0xee)),typedi_1=require('typedi'),api_error_1=require(a166_0x3a20cf(0xe3)),git_internal_1=require(a166_0x3a20cf(0xdf)),repo_class_1=require(a166_0x3a20cf(0x114)),git_repo_service_1=require(a166_0x3a20cf(0x103)),bitbucket_credentials_dto_1=require(a166_0x3a20cf(0xe1)),providers_tokens_1=require('../../providers.tokens');let BitbucketRepoService=class BitbucketRepoService extends git_repo_service_1[a166_0x3a20cf(0xf3)]{constructor(_0x48c1db,_0x464efb){const _0x3989e2=a166_0x3a20cf;super(_0x48c1db),this['api']=_0x48c1db,this[_0x3989e2(0xfc)]=_0x48c1db[_0x3989e2(0xef)](),this[_0x3989e2(0x119)]=_0x464efb[_0x3989e2(0x119)],this['workspace']=_0x464efb[_0x3989e2(0x112)],this[_0x3989e2(0x118)]=_0x464efb;if(!this[_0x3989e2(0x112)])throw new Error(errors_1['ERR_BITBUCKET_MISSING_WORKSPACE']);if(!this[_0x3989e2(0x119)])throw new Error(errors_1[_0x3989e2(0xf1)]);}async['create'](_0x270634){const _0x4b43d4=a166_0x3a20cf;try{const {name:_0x205fb0}=_0x270634,_0x23ff89={'name':_0x270634[_0x4b43d4(0xec)],'is_private':_0x270634['private'],..._0x270634[_0x4b43d4(0x100)]||{},'project':{'key':this[_0x4b43d4(0x119)]}},_0x4a2bee=await this['request'][_0x4b43d4(0xda)]('/repositories/'+this[_0x4b43d4(0x112)]+'/'+_0x205fb0['toLowerCase'](),_0x23ff89),_0x415fc3=repo_class_1[_0x4b43d4(0x115)][_0x4b43d4(0x10c)](_0x4a2bee,this[_0x4b43d4(0xe2)],this['credentials']);return _0x270634[_0x4b43d4(0xfe)]&&(await git_internal_1[_0x4b43d4(0xdb)][_0x4b43d4(0xe8)](_0x415fc3,_0x270634['defaultBranch']||'master','',this[_0x4b43d4(0x118)]),_0x415fc3[_0x4b43d4(0x106)]=_0x270634[_0x4b43d4(0x106)]||_0x4b43d4(0x107)),_0x415fc3;}catch(_0x246fbb){if(_0x246fbb instanceof api_error_1[_0x4b43d4(0xeb)])throw _0x246fbb;throw new bad_request_error_1[(_0x4b43d4(0xfd))](_0x246fbb);}}async[a166_0x3a20cf(0x102)](){const _0x230b4b=a166_0x3a20cf;try{const _0x420dba=[];let _0x18d7c2;do{_0x18d7c2=await this[_0x230b4b(0xfc)]['get'](_0x18d7c2?_0x18d7c2[_0x230b4b(0x116)]:'repositories/'+this[_0x230b4b(0x112)]),_0x420dba['push'](..._0x18d7c2[_0x230b4b(0xf5)]);}while(_0x18d7c2['next']);return _0x420dba[_0x230b4b(0x10b)](_0x49f5f0=>repo_class_1['Repo'][_0x230b4b(0x10c)](_0x49f5f0,this[_0x230b4b(0xe2)],this[_0x230b4b(0x118)]));}catch(_0x5420a8){if(_0x5420a8 instanceof api_error_1[_0x230b4b(0xeb)])throw _0x5420a8;throw new not_found_error_1[(_0x230b4b(0x11d))](_0x5420a8);}}async[a166_0x3a20cf(0xf9)](_0xb6f1c){const _0x2fa935=a166_0x3a20cf;try{const _0x6c98e5=await this['request'][_0x2fa935(0x105)]('repositories/'+this[_0x2fa935(0x112)]+'/'+_0xb6f1c[_0x2fa935(0xe4)]());return repo_class_1[_0x2fa935(0x115)][_0x2fa935(0x10c)](_0x6c98e5,this[_0x2fa935(0xe2)],this['credentials']);}catch(_0x4f66b6){if(_0x4f66b6 instanceof api_error_1[_0x2fa935(0xeb)])throw _0x4f66b6;throw new not_found_error_1[(_0x2fa935(0x11d))](_0x4f66b6);}}async[a166_0x3a20cf(0xe5)](_0x17b4fb,_0xefe881){const _0x2c0508=a166_0x3a20cf;await this[_0x2c0508(0xf9)](_0x17b4fb);try{const _0x44ff5a=await this[_0x2c0508(0xfc)][_0x2c0508(0xf7)](_0x2c0508(0x10a)+this[_0x2c0508(0x112)]+'/'+_0x17b4fb[_0x2c0508(0xe4)](),_0xefe881);return repo_class_1[_0x2c0508(0x115)][_0x2c0508(0x10c)](_0x44ff5a,this['api'],this['credentials']);}catch(_0x230439){if(_0x230439 instanceof api_error_1[_0x2c0508(0xeb)])throw _0x230439;throw new not_found_error_1['NotFoundError'](_0x230439);}}async[a166_0x3a20cf(0xf6)](_0x23ef9f){const _0x7398b3=a166_0x3a20cf;try{await this['request'][_0x7398b3(0xf6)](_0x7398b3(0x10a)+this[_0x7398b3(0x112)]+'/'+_0x23ef9f[_0x7398b3(0xe4)]());}catch(_0x1d04e4){if(_0x1d04e4 instanceof api_error_1[_0x7398b3(0xeb)])throw _0x1d04e4;throw new bad_request_error_1[(_0x7398b3(0xfd))](_0x1d04e4);}}};BitbucketRepoService=__decorate([(0x0,typedi_1['Service'])(),__param(0x1,(0x0,typedi_1[a166_0x3a20cf(0xf8)])(providers_tokens_1[a166_0x3a20cf(0x11c)]['credentials'])),__metadata(a166_0x3a20cf(0xff),[bitbucket_api_service_1[a166_0x3a20cf(0xf4)],bitbucket_credentials_dto_1[a166_0x3a20cf(0x11a)]])],BitbucketRepoService),exports[a166_0x3a20cf(0xdc)]=BitbucketRepoService;