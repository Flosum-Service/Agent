const a149_0x640021=a149_0x34d6;(function(_0x3fc367,_0x40f7a8){const _0x315683=a149_0x34d6,_0x46d313=_0x3fc367();while(!![]){try{const _0x5b9fdb=-parseInt(_0x315683(0xda))/0x1*(-parseInt(_0x315683(0xb4))/0x2)+parseInt(_0x315683(0xc4))/0x3+-parseInt(_0x315683(0xe4))/0x4*(parseInt(_0x315683(0xba))/0x5)+parseInt(_0x315683(0xc5))/0x6*(-parseInt(_0x315683(0xf0))/0x7)+-parseInt(_0x315683(0xce))/0x8*(-parseInt(_0x315683(0xc1))/0x9)+-parseInt(_0x315683(0xbd))/0xa*(-parseInt(_0x315683(0xc2))/0xb)+parseInt(_0x315683(0xe3))/0xc*(parseInt(_0x315683(0xf2))/0xd);if(_0x5b9fdb===_0x40f7a8)break;else _0x46d313['push'](_0x46d313['shift']());}catch(_0x282c3f){_0x46d313['push'](_0x46d313['shift']());}}}(a149_0x202f,0xc7af6));function a149_0x34d6(_0x4209dd,_0x5dbddd){const _0x1b2a88=a149_0x202f();return a149_0x34d6=function(_0x265907,_0x1f6927){_0x265907=_0x265907-0xa8;let _0x202f55=_0x1b2a88[_0x265907];return _0x202f55;},a149_0x34d6(_0x4209dd,_0x5dbddd);}const a149_0x1f6927=(function(){let _0x44f173=!![];return function(_0x2856f8,_0x1c11db){const _0x326780=_0x44f173?function(){if(_0x1c11db){const _0x2e1a33=_0x1c11db['apply'](_0x2856f8,arguments);return _0x1c11db=null,_0x2e1a33;}}:function(){};return _0x44f173=![],_0x326780;};}()),a149_0x265907=a149_0x1f6927(this,function(){const _0x4cc08a=a149_0x34d6;return a149_0x265907['toString']()[_0x4cc08a(0xaa)](_0x4cc08a(0xe6))['toString']()[_0x4cc08a(0xbb)](a149_0x265907)['search'](_0x4cc08a(0xe6));});a149_0x265907();function a149_0x202f(){const _0x1f476f=['744ztdUyA','/projects/','(((.+)+)+)+$','BadRequestError','then','decorate','projects/','/repos','../repo.class','__decorate','GitRepoService','apiUrl','14QPMcGy','defineProperty','78fHmIPT','function','api','../../api/bitbucket-server-api.service','Repo','search','getOne','git','__esModule','createEmptyBranch','push','values','joinURL','typedi','fromBitbucketServer','2502254qbPTmW','metadata','create','../../../../../core/errors/not-found.error','BitbucketServerRepoService','design:paramtypes','35615gxtamL','constructor','../../credentials/dto/bitbucket-server-credentials.dto','10QxClZU','defaults','delete','getOwnPropertyDescriptor','2031606HZdbfO','12453771LBwdym','NotFoundError','830190UcIqwt','2859954rWDbql','Service','__metadata','/branches','map','credentials','autoInit','ApiError','name','8EEUxtM','./git-repo.service','get','project','/default-branch','getAll','/repos/','master','length','request','__param','post','1dnfnJt','defaultBranch','put','slug','../../../../shared/utils','apiBody','Git','baseURL','object','420708cJZuQe'];a149_0x202f=function(){return _0x1f476f;};return a149_0x202f();}'use strict';var __decorate=this&&this[a149_0x640021(0xed)]||function(_0x3b59a3,_0x1b4023,_0x181d78,_0x2f642f){const _0x4e1411=a149_0x640021;var _0x102be8=arguments[_0x4e1411(0xd6)],_0xe04ef2=_0x102be8<0x3?_0x1b4023:_0x2f642f===null?_0x2f642f=Object[_0x4e1411(0xc0)](_0x1b4023,_0x181d78):_0x2f642f,_0x29834a;if(typeof Reflect===_0x4e1411(0xe2)&&typeof Reflect[_0x4e1411(0xe9)]===_0x4e1411(0xf3))_0xe04ef2=Reflect[_0x4e1411(0xe9)](_0x3b59a3,_0x1b4023,_0x181d78,_0x2f642f);else{for(var _0x3c6f26=_0x3b59a3[_0x4e1411(0xd6)]-0x1;_0x3c6f26>=0x0;_0x3c6f26--)if(_0x29834a=_0x3b59a3[_0x3c6f26])_0xe04ef2=(_0x102be8<0x3?_0x29834a(_0xe04ef2):_0x102be8>0x3?_0x29834a(_0x1b4023,_0x181d78,_0xe04ef2):_0x29834a(_0x1b4023,_0x181d78))||_0xe04ef2;}return _0x102be8>0x3&&_0xe04ef2&&Object[_0x4e1411(0xf1)](_0x1b4023,_0x181d78,_0xe04ef2),_0xe04ef2;},__metadata=this&&this[a149_0x640021(0xc7)]||function(_0x14675f,_0x2ff108){const _0x262e84=a149_0x640021;if(typeof Reflect===_0x262e84(0xe2)&&typeof Reflect['metadata']===_0x262e84(0xf3))return Reflect[_0x262e84(0xb5)](_0x14675f,_0x2ff108);},__param=this&&this[a149_0x640021(0xd8)]||function(_0x239098,_0x4d07a3){return function(_0x470a07,_0x21924e){_0x4d07a3(_0x470a07,_0x21924e,_0x239098);};};Object[a149_0x640021(0xf1)](exports,a149_0x640021(0xad),{'value':!![]}),exports[a149_0x640021(0xb8)]=void 0x0;const bad_request_error_1=require('../../../../../core/errors/bad-request.error'),not_found_error_1=require(a149_0x640021(0xb7)),typedi_1=require(a149_0x640021(0xb2)),api_error_1=require('../../../../../core/errors/api.error'),bitbucket_server_api_service_1=require(a149_0x640021(0xa8)),git_internal_1=require('../../../internal/git.internal'),utils_1=require(a149_0x640021(0xde)),repo_class_1=require(a149_0x640021(0xec)),git_repo_service_1=require(a149_0x640021(0xcf)),providers_tokens_1=require('../../providers.tokens'),bitbucket_server_credentials_dto_1=require(a149_0x640021(0xbc));let BitbucketServerRepoService=class BitbucketServerRepoService extends git_repo_service_1[a149_0x640021(0xee)]{constructor(_0x1b98db,_0x4f8c03){const _0x524af8=a149_0x640021;super(_0x1b98db),this['api']=_0x1b98db,this[_0x524af8(0xd1)]=_0x4f8c03[_0x524af8(0xd1)],this['credentials']=_0x4f8c03;}async[a149_0x640021(0xb6)](_0x5584b8){const _0x4844be=a149_0x640021;try{const _0x70fc39={'name':_0x5584b8['name'],'scmId':_0x4844be(0xac),'defaultBranch':_0x5584b8['defaultBranch'],..._0x5584b8[_0x4844be(0xdf)]||{}},_0x2a2000=await this[_0x4844be(0xd7)][_0x4844be(0xd9)](_0x4844be(0xea)+this[_0x4844be(0xd1)]+_0x4844be(0xeb),_0x70fc39),_0x11a300=repo_class_1[_0x4844be(0xa9)]['fromBitbucketServer'](_0x2a2000,'',this[_0x4844be(0xf4)],this[_0x4844be(0xca)]);return _0x5584b8[_0x4844be(0xcb)]&&await git_internal_1[_0x4844be(0xe0)][_0x4844be(0xae)](_0x11a300,_0x5584b8['defaultBranch']||_0x4844be(0xd5),'',this[_0x4844be(0xca)]),this['getOne'](_0x11a300[_0x4844be(0xcd)]);}catch(_0x3239b9){if(_0x3239b9 instanceof api_error_1[_0x4844be(0xcc)])throw _0x3239b9;throw new bad_request_error_1[(_0x4844be(0xe7))](_0x3239b9);}}async[a149_0x640021(0xd3)](){const _0x21a919=a149_0x640021;try{const _0x3d5b44=[];let _0x1fa6ce;do{_0x1fa6ce=await this[_0x21a919(0xd7)][_0x21a919(0xd0)](_0x21a919(0xea)+this[_0x21a919(0xd1)]+'/repos',{'params':{'limit':0x64,'start':_0x1fa6ce?_0x1fa6ce['nextPageStart']:0x0}}),_0x3d5b44[_0x21a919(0xaf)](..._0x1fa6ce[_0x21a919(0xb0)]);}while(!_0x1fa6ce['isLastPage']);return _0x3d5b44[_0x21a919(0xc9)](_0x4d52af=>repo_class_1['Repo'][_0x21a919(0xb3)](_0x4d52af,utils_1['joinURL'](this['request'][_0x21a919(0xbe)][_0x21a919(0xe1)]||'',_0x21a919(0xe5)+this[_0x21a919(0xd1)]+'/repos/'+_0x4d52af[_0x21a919(0xdd)]),this[_0x21a919(0xf4)],this[_0x21a919(0xca)]));}catch(_0x3d5ff9){if(_0x3d5ff9 instanceof api_error_1[_0x21a919(0xcc)])throw _0x3d5ff9;throw new not_found_error_1['NotFoundError'](_0x3d5ff9);}}async[a149_0x640021(0xab)](_0x122777){const _0x3567ed=a149_0x640021;var _0x313de6;try{const _0x4163a8=await this[_0x3567ed(0xd7)][_0x3567ed(0xd0)]('projects/'+this['project']+_0x3567ed(0xd4)+_0x122777),_0x568a5b=repo_class_1[_0x3567ed(0xa9)][_0x3567ed(0xb3)](_0x4163a8,utils_1[_0x3567ed(0xb1)](this[_0x3567ed(0xd7)]['defaults'][_0x3567ed(0xe1)]||'',_0x3567ed(0xe5)+this['project']+'/repos/'+_0x122777),this[_0x3567ed(0xf4)],this[_0x3567ed(0xca)]),_0xab51c4=await this[_0x3567ed(0xd7)][_0x3567ed(0xd0)](_0x568a5b[_0x3567ed(0xef)]+_0x3567ed(0xc8))[_0x3567ed(0xe8)](_0x59cbb6=>_0x59cbb6[_0x3567ed(0xb0)]);return _0x568a5b[_0x3567ed(0xdb)]=(_0x313de6=_0xab51c4['find'](_0x2c03c0=>_0x2c03c0['isDefault']===!![]))===null||_0x313de6===void 0x0?void 0x0:_0x313de6['displayId'],_0x568a5b;}catch(_0x33e7ed){if(_0x33e7ed instanceof api_error_1[_0x3567ed(0xcc)])throw _0x33e7ed;throw new not_found_error_1[(_0x3567ed(0xc3))](_0x33e7ed);}}async['update'](_0x10dd39,_0x2de4fa){const _0x54e302=a149_0x640021;try{const _0x3d5a62=await this[_0x54e302(0xd7)][_0x54e302(0xdc)](_0x54e302(0xea)+this['project']+_0x54e302(0xd4)+_0x10dd39,_0x2de4fa),_0x282c09=await this[_0x54e302(0xd7)][_0x54e302(0xd0)](_0x54e302(0xea)+this[_0x54e302(0xd1)]+_0x54e302(0xd4)+_0x10dd39+_0x54e302(0xd2)),_0x280d5f=repo_class_1[_0x54e302(0xa9)][_0x54e302(0xb3)](_0x3d5a62,utils_1[_0x54e302(0xb1)](this['request']['defaults'][_0x54e302(0xe1)]||'',_0x54e302(0xe5)+this[_0x54e302(0xd1)]+_0x54e302(0xd4)+_0x10dd39),this[_0x54e302(0xf4)],this['credentials']);return _0x280d5f[_0x54e302(0xdb)]=_0x282c09['displayId'],_0x280d5f;}catch(_0x43de0d){if(_0x43de0d instanceof api_error_1[_0x54e302(0xcc)])throw _0x43de0d;throw new not_found_error_1[(_0x54e302(0xc3))](_0x43de0d);}}async[a149_0x640021(0xbf)](_0x3e0bdc){const _0x57b816=a149_0x640021;try{await this[_0x57b816(0xab)](_0x3e0bdc),await this[_0x57b816(0xd7)]['delete'](_0x57b816(0xea)+this['project']+'/repos/'+_0x3e0bdc);}catch(_0x520c60){if(_0x520c60 instanceof api_error_1['ApiError'])throw _0x520c60;throw new bad_request_error_1[(_0x57b816(0xe7))](_0x520c60);}}};BitbucketServerRepoService=__decorate([typedi_1[a149_0x640021(0xc6)](),__param(0x1,typedi_1['Inject'](providers_tokens_1['Tokens'][a149_0x640021(0xca)])),__metadata(a149_0x640021(0xb9),[bitbucket_server_api_service_1['BitbucketServerApiService'],bitbucket_server_credentials_dto_1['BitbucketServerCredentialsDto']])],BitbucketServerRepoService),exports['BitbucketServerRepoService']=BitbucketServerRepoService;