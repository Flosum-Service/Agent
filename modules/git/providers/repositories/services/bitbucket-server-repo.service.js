const a206_0x51fcee=a206_0x1b9e;function a206_0x440a(){const _0x32719e=['Tokens','apply','80nKBuOM','__metadata','1274grTDAa','../../providers.tokens','BitbucketServerCredentialsDto','credentials','api','/default-branch','get','NotFoundError','/branches','32178EdKhOs','__decorate','request','metadata','../../../../../core/errors/not-found.error','../../api/bitbucket-server-api.service','BitbucketServerRepoService','../../../../shared/utils','typedi','126kkQJpX','13808GCGkiT','toString','createEmptyBranch','post','search','autoInit','../repo.class','/repos','Service','911530ALQJkz','../../../../../core/errors/bad-request.error','displayId','BadRequestError','design:paramtypes','baseURL','joinURL','Inject','name','put','16407413TIbpSe','681AyBiUN','delete','Repo','length','/repos/','fromBitbucketServer','object','3811470BbItrD','/projects/','GitRepoService','slug','getAll','isLastPage','BitbucketServerApiService','isDefault','then','getOwnPropertyDescriptor','function','find','create','ApiError','map','decorate','541116eYhDuu','defaults','20lTFuwy','../../credentials/dto/bitbucket-server-credentials.dto','defaultBranch','apiBody','../../../../../core/errors/api.error','projects/','__param','getOne','defineProperty','project'];a206_0x440a=function(){return _0x32719e;};return a206_0x440a();}(function(_0x3b78f5,_0x1e09f5){const _0x14c83c=a206_0x1b9e,_0x5ebb75=_0x3b78f5();while(!![]){try{const _0x126c0=parseInt(_0x14c83c(0x1e6))/0x1*(parseInt(_0x14c83c(0x1bf))/0x2)+parseInt(_0x14c83c(0x1c8))/0x3*(parseInt(_0x14c83c(0x1ff))/0x4)+parseInt(_0x14c83c(0x1db))/0x5+parseInt(_0x14c83c(0x1ed))/0x6+parseInt(_0x14c83c(0x1d1))/0x7*(parseInt(_0x14c83c(0x1d2))/0x8)+parseInt(_0x14c83c(0x1fd))/0x9*(parseInt(_0x14c83c(0x1bd))/0xa)+-parseInt(_0x14c83c(0x1e5))/0xb;if(_0x126c0===_0x1e09f5)break;else _0x5ebb75['push'](_0x5ebb75['shift']());}catch(_0x36b473){_0x5ebb75['push'](_0x5ebb75['shift']());}}}(a206_0x440a,0x4f74f));const a206_0x9779d4=(function(){let _0x532f1b=!![];return function(_0x593a9d,_0x5bb2a3){const _0x286fef=_0x532f1b?function(){const _0x47239b=a206_0x1b9e;if(_0x5bb2a3){const _0x344bfc=_0x5bb2a3[_0x47239b(0x1bc)](_0x593a9d,arguments);return _0x5bb2a3=null,_0x344bfc;}}:function(){};return _0x532f1b=![],_0x286fef;};}()),a206_0x5eee56=a206_0x9779d4(this,function(){const _0x35c3e8=a206_0x1b9e;return a206_0x5eee56[_0x35c3e8(0x1d3)]()[_0x35c3e8(0x1d6)]('(((.+)+)+)+$')['toString']()['constructor'](a206_0x5eee56)[_0x35c3e8(0x1d6)]('(((.+)+)+)+$');});a206_0x5eee56();'use strict';var __decorate=this&&this[a206_0x51fcee(0x1c9)]||function(_0x2977f4,_0x4c595f,_0x453d45,_0x340483){const _0x3a6be4=a206_0x51fcee;var _0x9a18bd=arguments['length'],_0x37b0bb=_0x9a18bd<0x3?_0x4c595f:_0x340483===null?_0x340483=Object[_0x3a6be4(0x1f6)](_0x4c595f,_0x453d45):_0x340483,_0x2ee5b7;if(typeof Reflect===_0x3a6be4(0x1ec)&&typeof Reflect[_0x3a6be4(0x1fc)]===_0x3a6be4(0x1f7))_0x37b0bb=Reflect[_0x3a6be4(0x1fc)](_0x2977f4,_0x4c595f,_0x453d45,_0x340483);else{for(var _0x3c0d14=_0x2977f4[_0x3a6be4(0x1e9)]-0x1;_0x3c0d14>=0x0;_0x3c0d14--)if(_0x2ee5b7=_0x2977f4[_0x3c0d14])_0x37b0bb=(_0x9a18bd<0x3?_0x2ee5b7(_0x37b0bb):_0x9a18bd>0x3?_0x2ee5b7(_0x4c595f,_0x453d45,_0x37b0bb):_0x2ee5b7(_0x4c595f,_0x453d45))||_0x37b0bb;}return _0x9a18bd>0x3&&_0x37b0bb&&Object[_0x3a6be4(0x207)](_0x4c595f,_0x453d45,_0x37b0bb),_0x37b0bb;},__metadata=this&&this[a206_0x51fcee(0x1be)]||function(_0x5e5000,_0x4d66e9){const _0x44dbe2=a206_0x51fcee;if(typeof Reflect===_0x44dbe2(0x1ec)&&typeof Reflect[_0x44dbe2(0x1cb)]==='function')return Reflect[_0x44dbe2(0x1cb)](_0x5e5000,_0x4d66e9);},__param=this&&this[a206_0x51fcee(0x205)]||function(_0x3cecfb,_0x50b77c){return function(_0x228b60,_0x1eff52){_0x50b77c(_0x228b60,_0x1eff52,_0x3cecfb);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['BitbucketServerRepoService']=void 0x0;const bad_request_error_1=require(a206_0x51fcee(0x1dc)),not_found_error_1=require(a206_0x51fcee(0x1cc)),typedi_1=require(a206_0x51fcee(0x1d0)),api_error_1=require(a206_0x51fcee(0x203)),bitbucket_server_api_service_1=require(a206_0x51fcee(0x1cd)),git_internal_1=require('../../../internal/git.internal'),utils_1=require(a206_0x51fcee(0x1cf)),repo_class_1=require(a206_0x51fcee(0x1d8)),git_repo_service_1=require('./git-repo.service'),providers_tokens_1=require(a206_0x51fcee(0x1c0)),bitbucket_server_credentials_dto_1=require(a206_0x51fcee(0x200));function a206_0x1b9e(_0x588450,_0x29aa5b){const _0x2e86a8=a206_0x440a();return a206_0x1b9e=function(_0x5eee56,_0x9779d4){_0x5eee56=_0x5eee56-0x1bc;let _0x440a7a=_0x2e86a8[_0x5eee56];return _0x440a7a;},a206_0x1b9e(_0x588450,_0x29aa5b);}let BitbucketServerRepoService=class BitbucketServerRepoService extends git_repo_service_1[a206_0x51fcee(0x1ef)]{constructor(_0x2f0f39,_0x22dd0d){const _0x16e208=a206_0x51fcee;super(_0x2f0f39),this[_0x16e208(0x1c3)]=_0x2f0f39,this['project']=_0x22dd0d[_0x16e208(0x208)],this[_0x16e208(0x1c2)]=_0x22dd0d;}async[a206_0x51fcee(0x1f9)](_0x3a6f8c){const _0x39da1d=a206_0x51fcee;try{const _0x3dca27={'name':_0x3a6f8c[_0x39da1d(0x1e3)],'scmId':'git','defaultBranch':_0x3a6f8c[_0x39da1d(0x201)],..._0x3a6f8c[_0x39da1d(0x202)]||{}},_0x432db0=await this[_0x39da1d(0x1ca)][_0x39da1d(0x1d5)](_0x39da1d(0x204)+this[_0x39da1d(0x208)]+_0x39da1d(0x1d9),_0x3dca27),_0x2ad82e=repo_class_1[_0x39da1d(0x1e8)][_0x39da1d(0x1eb)](_0x432db0,'',this['api'],this['credentials']);return _0x3a6f8c[_0x39da1d(0x1d7)]&&await git_internal_1['Git'][_0x39da1d(0x1d4)](_0x2ad82e,_0x3a6f8c[_0x39da1d(0x201)]||'master','',this['credentials']),this['getOne'](_0x2ad82e['name']);}catch(_0x2463d0){if(_0x2463d0 instanceof api_error_1[_0x39da1d(0x1fa)])throw _0x2463d0;throw new bad_request_error_1[(_0x39da1d(0x1de))](_0x2463d0);}}async[a206_0x51fcee(0x1f1)](){const _0x510c68=a206_0x51fcee;try{const _0x195b48=[];let _0x4e9044;do{_0x4e9044=await this[_0x510c68(0x1ca)][_0x510c68(0x1c5)](_0x510c68(0x204)+this['project']+_0x510c68(0x1d9),{'params':{'limit':0x64,'start':_0x4e9044?_0x4e9044['nextPageStart']:0x0}}),_0x195b48['push'](..._0x4e9044['values']);}while(!_0x4e9044[_0x510c68(0x1f2)]);return _0x195b48[_0x510c68(0x1fb)](_0x107884=>repo_class_1[_0x510c68(0x1e8)][_0x510c68(0x1eb)](_0x107884,(0x0,utils_1[_0x510c68(0x1e1)])(this[_0x510c68(0x1ca)][_0x510c68(0x1fe)][_0x510c68(0x1e0)]||'',_0x510c68(0x1ee)+this[_0x510c68(0x208)]+_0x510c68(0x1ea)+_0x107884[_0x510c68(0x1f0)]),this['api'],this['credentials']));}catch(_0x2d52ee){if(_0x2d52ee instanceof api_error_1[_0x510c68(0x1fa)])throw _0x2d52ee;throw new not_found_error_1['NotFoundError'](_0x2d52ee);}}async[a206_0x51fcee(0x206)](_0x2a513d){const _0x27f728=a206_0x51fcee;var _0x38c8c6;try{const _0x59274d=await this[_0x27f728(0x1ca)][_0x27f728(0x1c5)](_0x27f728(0x204)+this[_0x27f728(0x208)]+_0x27f728(0x1ea)+_0x2a513d),_0x264ae3=repo_class_1[_0x27f728(0x1e8)]['fromBitbucketServer'](_0x59274d,(0x0,utils_1[_0x27f728(0x1e1)])(this[_0x27f728(0x1ca)][_0x27f728(0x1fe)][_0x27f728(0x1e0)]||'','/projects/'+this[_0x27f728(0x208)]+_0x27f728(0x1ea)+_0x2a513d),this[_0x27f728(0x1c3)],this[_0x27f728(0x1c2)]),_0x50f2ff=await this[_0x27f728(0x1ca)][_0x27f728(0x1c5)](_0x264ae3['apiUrl']+_0x27f728(0x1c7))[_0x27f728(0x1f5)](_0x1a1462=>_0x1a1462['values']);return _0x264ae3['defaultBranch']=(_0x38c8c6=_0x50f2ff[_0x27f728(0x1f8)](_0x443022=>_0x443022[_0x27f728(0x1f4)]===!![]))===null||_0x38c8c6===void 0x0?void 0x0:_0x38c8c6[_0x27f728(0x1dd)],_0x264ae3;}catch(_0x411927){if(_0x411927 instanceof api_error_1[_0x27f728(0x1fa)])throw _0x411927;throw new not_found_error_1['NotFoundError'](_0x411927);}}async['update'](_0x46bcd4,_0x56dc60){const _0x44b036=a206_0x51fcee;try{const _0x567059=await this[_0x44b036(0x1ca)][_0x44b036(0x1e4)](_0x44b036(0x204)+this[_0x44b036(0x208)]+_0x44b036(0x1ea)+_0x46bcd4,_0x56dc60),_0x2cb3cc=await this[_0x44b036(0x1ca)][_0x44b036(0x1c5)](_0x44b036(0x204)+this[_0x44b036(0x208)]+'/repos/'+_0x46bcd4+_0x44b036(0x1c4)),_0x27a1cd=repo_class_1[_0x44b036(0x1e8)][_0x44b036(0x1eb)](_0x567059,(0x0,utils_1['joinURL'])(this[_0x44b036(0x1ca)]['defaults'][_0x44b036(0x1e0)]||'',_0x44b036(0x1ee)+this[_0x44b036(0x208)]+_0x44b036(0x1ea)+_0x46bcd4),this['api'],this[_0x44b036(0x1c2)]);return _0x27a1cd['defaultBranch']=_0x2cb3cc[_0x44b036(0x1dd)],_0x27a1cd;}catch(_0x2c17b0){if(_0x2c17b0 instanceof api_error_1[_0x44b036(0x1fa)])throw _0x2c17b0;throw new not_found_error_1[(_0x44b036(0x1c6))](_0x2c17b0);}}async[a206_0x51fcee(0x1e7)](_0x3ba8da){const _0x3883ee=a206_0x51fcee;try{await this['getOne'](_0x3ba8da),await this[_0x3883ee(0x1ca)]['delete'](_0x3883ee(0x204)+this[_0x3883ee(0x208)]+_0x3883ee(0x1ea)+_0x3ba8da);}catch(_0x22f781){if(_0x22f781 instanceof api_error_1[_0x3883ee(0x1fa)])throw _0x22f781;throw new bad_request_error_1[(_0x3883ee(0x1de))](_0x22f781);}}};BitbucketServerRepoService=__decorate([(0x0,typedi_1[a206_0x51fcee(0x1da)])(),__param(0x1,(0x0,typedi_1[a206_0x51fcee(0x1e2)])(providers_tokens_1[a206_0x51fcee(0x209)][a206_0x51fcee(0x1c2)])),__metadata(a206_0x51fcee(0x1df),[bitbucket_server_api_service_1[a206_0x51fcee(0x1f3)],bitbucket_server_credentials_dto_1[a206_0x51fcee(0x1c1)]])],BitbucketServerRepoService),exports[a206_0x51fcee(0x1ce)]=BitbucketServerRepoService;