const a130_0xcf18ab=a130_0x40f7;function a130_0x4de1(){const _0x2bab99=['121HXnqfT','__importDefault','cd\x20','_repoPath','52029JFLWOm','Describe\x20commit\x20%s','264876RWajpD','4nxcUem','\x20&&\x20git\x20checkout\x20--orphan\x20','constructor','spawnPromise','removeDir','5308JjNCad','then','Git','../../../core','DEFAULT_CLONE_PATH','Create\x20empty\x20branch\x20at\x20%s\x20name\x20%s\x20[%s]','(((.+)+)+)+$','Checkout\x20to\x20%s','refs/heads/','\x20--quiet','312lqHjjD','\x20&&\x20git\x20push\x20origin\x20','Clean\x20up\x20repository\x20directory\x20after\x20creating\x20branch','\x20&&\x20git\x20rev-parse\x20HEAD','log','logger','getRemoteHash','git\x20ls-remote\x20','\x20&&\x20git\x20status','path','81EmJAEj','default','ChildProcessUtils','extractEmailFromCommitDescribe','DEFAULT_GIT_USER_NAME','getGitShellAuthorizationString','\x20&&\x20git\x20init','\x20--single-branch\x20','setCredentials','://','cwd','git','clone','./internal.utils','commit','__esModule','apply','replace','3283oiNXQK','split','search','map','50uTxBul','getCurrentHash','getProtocol','3536IiBdYZ','124994NxQTZj','baseDir','gitUrl','\x20--refs','name','join','.temp','\x20&&\x20git\x20commit\x20-m\x20\x22','BranchDto','status','extractChangesFromCommitDescribe','../../../constants','getRepositoryBranches','push','INITIAL_COMMIT','match','12615109aFHKZI','test','filter','DEFAULT_GIT_USER_EMAIL','14eENWHi','makeDir','add','sha','13050wCqsHX'];a130_0x4de1=function(){return _0x2bab99;};return a130_0x4de1();}function a130_0x40f7(_0x3907eb,_0x4c9284){const _0x49cc7d=a130_0x4de1();return a130_0x40f7=function(_0x4faabb,_0x5449f8){_0x4faabb=_0x4faabb-0x165;let _0x4de15=_0x49cc7d[_0x4faabb];return _0x4de15;},a130_0x40f7(_0x3907eb,_0x4c9284);}(function(_0x49d31c,_0x201c6a){const _0x3de56e=a130_0x40f7,_0x385c=_0x49d31c();while(!![]){try{const _0x2a6196=-parseInt(_0x3de56e(0x190))/0x1*(parseInt(_0x3de56e(0x1b0))/0x2)+parseInt(_0x3de56e(0x176))/0x3*(parseInt(_0x3de56e(0x1b5))/0x4)+parseInt(_0x3de56e(0x1a8))/0x5*(-parseInt(_0x3de56e(0x16c))/0x6)+-parseInt(_0x3de56e(0x188))/0x7*(parseInt(_0x3de56e(0x18f))/0x8)+parseInt(_0x3de56e(0x1ad))/0x9*(-parseInt(_0x3de56e(0x18c))/0xa)+-parseInt(_0x3de56e(0x1a9))/0xb*(parseInt(_0x3de56e(0x1af))/0xc)+parseInt(_0x3de56e(0x1a0))/0xd*(parseInt(_0x3de56e(0x1a4))/0xe);if(_0x2a6196===_0x201c6a)break;else _0x385c['push'](_0x385c['shift']());}catch(_0x227546){_0x385c['push'](_0x385c['shift']());}}}(a130_0x4de1,0x228c4));const a130_0x5449f8=(function(){let _0x2f6ed1=!![];return function(_0x2cafc0,_0x502020){const _0x2b1a74=_0x2f6ed1?function(){const _0x85e532=a130_0x40f7;if(_0x502020){const _0x567110=_0x502020[_0x85e532(0x186)](_0x2cafc0,arguments);return _0x502020=null,_0x567110;}}:function(){};return _0x2f6ed1=![],_0x2b1a74;};}()),a130_0x4faabb=a130_0x5449f8(this,function(){const _0x16b48b=a130_0x40f7;return a130_0x4faabb['toString']()[_0x16b48b(0x18a)](_0x16b48b(0x168))['toString']()[_0x16b48b(0x1b2)](a130_0x4faabb)[_0x16b48b(0x18a)](_0x16b48b(0x168));});a130_0x4faabb();'use strict';var __importDefault=this&&this[a130_0xcf18ab(0x1aa)]||function(_0xfa177f){const _0x5c253d=a130_0xcf18ab;return _0xfa177f&&_0xfa177f[_0x5c253d(0x185)]?_0xfa177f:{'default':_0xfa177f};};Object['defineProperty'](exports,a130_0xcf18ab(0x185),{'value':!![]}),exports[a130_0xcf18ab(0x1b7)]=void 0x0;const constants_1=require(a130_0xcf18ab(0x19b)),core_1=require(a130_0xcf18ab(0x165)),path_1=__importDefault(require(a130_0xcf18ab(0x175))),branch_dto_1=require('../providers/branches/dto/branch.dto'),utils_1=require('../../shared/utils'),fs_internal_1=require('./fs.internal'),internal_utils_1=require(a130_0xcf18ab(0x183)),utils_2=require('@flosum/utils');class Git{constructor(_0xfff6f1){this['_repoPath']=_0xfff6f1;}get[a130_0xcf18ab(0x191)](){return this['_repoPath'];}async[a130_0xcf18ab(0x17e)](_0x26bbb9,_0x383f34){const _0x8b9f80=a130_0xcf18ab;await utils_2[_0x8b9f80(0x178)][_0x8b9f80(0x1b3)](_0x8b9f80(0x1ab)+this[_0x8b9f80(0x1ac)]+'\x20&&\x20git\x20config\x20--local\x20user.name\x20\x22'+_0x26bbb9+'\x22\x20&&\x20git\x20config\x20--local\x20user.email\x20\x22'+_0x383f34+'\x22','');}async[a130_0xcf18ab(0x1a6)](..._0x445d18){const _0x219109=a130_0xcf18ab;await utils_2[_0x219109(0x178)][_0x219109(0x1b3)](_0x219109(0x1ab)+this[_0x219109(0x1ac)]+'\x20&&\x20git\x20add\x20'+_0x445d18[_0x219109(0x195)]('\x20'),'');}async[a130_0xcf18ab(0x199)](){const _0x1ed712=a130_0xcf18ab;return utils_2[_0x1ed712(0x178)]['spawnPromise'](_0x1ed712(0x1ab)+this[_0x1ed712(0x1ac)]+_0x1ed712(0x174),'');}async[a130_0xcf18ab(0x184)](_0xc4fe95){const _0x239879=a130_0xcf18ab;Git['logger'][_0x239879(0x170)]('Commit\x20message\x20\x22%s\x22',_0xc4fe95),await utils_2[_0x239879(0x178)][_0x239879(0x1b3)](_0x239879(0x1ab)+this[_0x239879(0x1ac)]+_0x239879(0x197)+_0xc4fe95+'\x22','');}async[a130_0xcf18ab(0x19d)](_0x301c83){const _0x339f02=a130_0xcf18ab;Git[_0x339f02(0x171)][_0x339f02(0x170)]('Push\x20changes\x20to\x20%s',_0x301c83),await utils_2['ChildProcessUtils'][_0x339f02(0x1b3)](_0x339f02(0x1ab)+this[_0x339f02(0x1ac)]+_0x339f02(0x16d)+_0x301c83+_0x339f02(0x16b),'');}async['checkout'](_0x269bf0){const _0x59427c=a130_0xcf18ab;Git['logger'][_0x59427c(0x170)](_0x59427c(0x169),_0x269bf0),await utils_2[_0x59427c(0x178)][_0x59427c(0x1b3)](_0x59427c(0x1ab)+this[_0x59427c(0x1ac)]+'\x20&&\x20git\x20checkout\x20'+_0x269bf0,'');}async[a130_0xcf18ab(0x18d)](){const _0x3943b2=a130_0xcf18ab,_0xd38d08=await utils_2[_0x3943b2(0x178)]['spawnPromise']('cd\x20'+this[_0x3943b2(0x1ac)]+_0x3943b2(0x16f),'');return _0xd38d08['replace']('\x0a','');}async['describeCommit'](_0x4ac40a){const _0x2b199c=a130_0xcf18ab;Git[_0x2b199c(0x171)][_0x2b199c(0x170)](_0x2b199c(0x1ae),_0x4ac40a);const _0x240b2a=await utils_2['ChildProcessUtils'][_0x2b199c(0x1b3)]('cd\x20'+this[_0x2b199c(0x1ac)]+'\x20&&\x20git\x20show\x20--pretty=format:\x22Author:\x20%an%nEmail:\x20%ae%nMessage:\x20%s\x22\x20--name-status\x20'+_0x4ac40a,'');return{'author':(0x0,internal_utils_1['extractAuthorFromCommitDescribe'])(_0x240b2a),'email':(0x0,internal_utils_1[_0x2b199c(0x179)])(_0x240b2a),'message':(0x0,internal_utils_1['extractMessageFromCommitDescribe'])(_0x240b2a),'changes':(0x0,internal_utils_1[_0x2b199c(0x19a)])(_0x240b2a)};}static async[a130_0xcf18ab(0x172)](_0x5b9268,_0x56d5d8){const _0x2c4b88=a130_0xcf18ab,[_0x17a61f]=await utils_2[_0x2c4b88(0x178)][_0x2c4b88(0x1b3)]('git\x20ls-remote\x20'+_0x5b9268+'\x20'+_0x56d5d8+_0x2c4b88(0x193),'')[_0x2c4b88(0x1b6)](_0x40d349=>_0x40d349[_0x2c4b88(0x187)](/\s/g,'\x20')[_0x2c4b88(0x189)]('\x20'));return _0x17a61f;}static async[a130_0xcf18ab(0x182)](_0x122dd7,_0x3bd3bd,_0x2aa329){const _0x571602=a130_0xcf18ab,_0x4e5888=path_1[_0x571602(0x177)][_0x571602(0x195)](this[_0x571602(0x166)],_0x3bd3bd),_0x4e2bf2=new Git(_0x4e5888);return Git['logger'][_0x571602(0x170)]('Clone\x20repository\x20branch\x20%s\x20to\x20%s',_0x2aa329,_0x4e5888),await fs_internal_1['FS'][_0x571602(0x1b4)](_0x4e5888),await utils_2[_0x571602(0x178)]['spawnPromise']('git\x20clone\x20-b\x20'+_0x2aa329+_0x571602(0x17d)+_0x122dd7+'\x20'+_0x4e5888,''),_0x4e2bf2;}static async[a130_0xcf18ab(0x19c)](_0x3541cc,_0x3ae233){const _0x39288f=a130_0xcf18ab,_0x2f7b26=/(?:([a-f0-9]+)\s+((?:HEAD|refs\/heads\/).*))/,_0xdcf249=_0x3541cc[_0x39288f(0x192)][_0x39288f(0x187)](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x39288f(0x18e)])(_0x3541cc[_0x39288f(0x192)])+_0x39288f(0x17f)+_0x3ae233[_0x39288f(0x17b)]()+'@'),_0x326c87=await utils_2[_0x39288f(0x178)][_0x39288f(0x1b3)](_0x39288f(0x173)+_0xdcf249,'');return _0x326c87[_0x39288f(0x189)]('\x0a')[_0x39288f(0x1a2)](_0x393850=>_0x2f7b26[_0x39288f(0x1a1)](_0x393850))[_0x39288f(0x18b)](_0x23828b=>{const _0x7be45f=_0x39288f,[,_0x85f281,_0x41baae]=_0x23828b[_0x7be45f(0x19f)](_0x2f7b26),_0x365158=new branch_dto_1[(_0x7be45f(0x198))]();return _0x365158[_0x7be45f(0x1a7)]=_0x85f281,_0x365158[_0x7be45f(0x194)]=_0x41baae[_0x7be45f(0x187)](_0x7be45f(0x16a),''),_0x365158;});}static async['createEmptyBranch'](_0x31732c,_0x44a568,_0x50d176,_0x5aadb1){const _0x2b6f83=a130_0xcf18ab,_0x566197=_0x31732c[_0x2b6f83(0x192)]['replace'](/http(s)?:\/\/(.+@)?/,(0x0,utils_1[_0x2b6f83(0x18e)])(_0x31732c['gitUrl'])+_0x2b6f83(0x17f)+_0x5aadb1['getGitShellAuthorizationString']()+'@'),_0x4de53d=path_1[_0x2b6f83(0x177)]['join'](this[_0x2b6f83(0x166)],_0x31732c[_0x2b6f83(0x194)]);Git[_0x2b6f83(0x171)]['log'](_0x2b6f83(0x167),_0x31732c[_0x2b6f83(0x194)],_0x44a568,_0x4de53d),await fs_internal_1['FS'][_0x2b6f83(0x1b4)](_0x4de53d),await fs_internal_1['FS'][_0x2b6f83(0x1a5)](_0x4de53d);const _0x3073c1=new Git(_0x4de53d);await utils_2[_0x2b6f83(0x178)][_0x2b6f83(0x1b3)]('cd\x20'+_0x3073c1[_0x2b6f83(0x191)]+_0x2b6f83(0x17c),''),await utils_2[_0x2b6f83(0x178)][_0x2b6f83(0x1b3)]('cd\x20'+_0x3073c1['baseDir']+'\x20&&\x20git\x20remote\x20add\x20origin\x20'+_0x566197,''),await _0x3073c1['setCredentials'](constants_1[_0x2b6f83(0x17a)],constants_1[_0x2b6f83(0x1a3)]),await utils_2[_0x2b6f83(0x178)]['spawnPromise'](_0x2b6f83(0x1ab)+_0x3073c1[_0x2b6f83(0x191)]+_0x2b6f83(0x1b1)+_0x44a568,''),await utils_2[_0x2b6f83(0x178)]['spawnPromise'](_0x2b6f83(0x1ab)+_0x3073c1[_0x2b6f83(0x191)]+_0x2b6f83(0x197)+(_0x50d176||constants_1[_0x2b6f83(0x19e)])+'\x22\x20--allow-empty',''),await _0x3073c1[_0x2b6f83(0x19d)](_0x44a568),Git['logger']['log'](_0x2b6f83(0x16e)),await fs_internal_1['FS'][_0x2b6f83(0x1b4)](_0x3073c1[_0x2b6f83(0x191)]);}}exports[a130_0xcf18ab(0x1b7)]=Git,Git[a130_0xcf18ab(0x166)]=path_1[a130_0xcf18ab(0x177)][a130_0xcf18ab(0x195)](process[a130_0xcf18ab(0x180)](),a130_0xcf18ab(0x196),a130_0xcf18ab(0x181)),Git['logger']=new core_1['Logger'](Git['name']);