const a237_0x4aad9b=a237_0x7e8e;(function(_0xe6a3fc,_0x5bef33){const _0x184a3c=a237_0x7e8e,_0x6dcf04=_0xe6a3fc();while(!![]){try{const _0x1a6b3c=-parseInt(_0x184a3c(0x13e))/0x1+-parseInt(_0x184a3c(0x146))/0x2*(parseInt(_0x184a3c(0x13b))/0x3)+parseInt(_0x184a3c(0x15b))/0x4*(-parseInt(_0x184a3c(0x127))/0x5)+-parseInt(_0x184a3c(0x13f))/0x6*(parseInt(_0x184a3c(0x126))/0x7)+parseInt(_0x184a3c(0x142))/0x8*(-parseInt(_0x184a3c(0x140))/0x9)+-parseInt(_0x184a3c(0x143))/0xa*(parseInt(_0x184a3c(0x123))/0xb)+parseInt(_0x184a3c(0x154))/0xc*(parseInt(_0x184a3c(0x15a))/0xd);if(_0x1a6b3c===_0x5bef33)break;else _0x6dcf04['push'](_0x6dcf04['shift']());}catch(_0x389469){_0x6dcf04['push'](_0x6dcf04['shift']());}}}(a237_0x252b,0xe8c85));const a237_0x5d0a26=(function(){let _0x526c22=!![];return function(_0x3a3c1c,_0x442864){const _0x301a0d=_0x526c22?function(){if(_0x442864){const _0x5e922b=_0x442864['apply'](_0x3a3c1c,arguments);return _0x442864=null,_0x5e922b;}}:function(){};return _0x526c22=![],_0x301a0d;};}()),a237_0x5dccb7=a237_0x5d0a26(this,function(){const _0x37abf7=a237_0x7e8e;return a237_0x5dccb7[_0x37abf7(0x14c)]()[_0x37abf7(0x162)]('(((.+)+)+)+$')[_0x37abf7(0x14c)]()[_0x37abf7(0x15f)](a237_0x5dccb7)[_0x37abf7(0x162)](_0x37abf7(0x131));});function a237_0x252b(){const _0x3b747d=['info','62147YUSHaz','6cFKjaI','9dHjgCI','%ids%','12970168PLHlGX','90Dbcidi','run','fileType','74GUTfyS','SalesforceQueryService','retrieveComponents','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','salesforceService','FlosumComponentHistoryDto','toString','manually\x20retrieved\x20%d/%d\x20components','replace','typedi','join','../../../../core','__esModule','ParentId','482424esyvdJ','splice','__importDefault','log','all','filename','2093eCKzMX','27764jauwDs','map','SalesforceRetrieverService','fromSalesforce','constructor','length','manually\x20retrieving\x20components\x20from\x20salesforce','search','../queries','Logger','retrieveComponentIdsFromHistoryIds','1655005liUIUK','logger','GET_COMPONENT_HISTORIES_BY_IDS','10385417uYIjXc','465BxGQAw','get','defineProperty','attachmentId','COMPONENTS_PER_REQUEST','find','./salesforce-query.service','retrieveLastComponents','default','then','(((.+)+)+)+$','../dto/flosum-component-history.dto','components','push','query','base64','ids','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','retrieveAttachment','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','28572CFzxGn','Name'];a237_0x252b=function(){return _0x3b747d;};return a237_0x252b();}function a237_0x7e8e(_0x1b7024,_0x1e50ee){const _0x4cc0ad=a237_0x252b();return a237_0x7e8e=function(_0x5dccb7,_0x5d0a26){_0x5dccb7=_0x5dccb7-0x123;let _0x252b12=_0x4cc0ad[_0x5dccb7];return _0x252b12;},a237_0x7e8e(_0x1b7024,_0x1e50ee);}a237_0x5dccb7();'use strict';var __importDefault=this&&this[a237_0x4aad9b(0x156)]||function(_0x1cd050){const _0x2747d8=a237_0x4aad9b;return _0x1cd050&&_0x1cd050[_0x2747d8(0x152)]?_0x1cd050:{'default':_0x1cd050};};Object[a237_0x4aad9b(0x129)](exports,a237_0x4aad9b(0x152),{'value':!![]}),exports[a237_0x4aad9b(0x15d)]=void 0x0;const core_1=require(a237_0x4aad9b(0x151)),typedi_1=__importDefault(require(a237_0x4aad9b(0x14f))),salesforce_query_service_1=require(a237_0x4aad9b(0x12d)),queries_1=require(a237_0x4aad9b(0x163)),flosum_component_history_dto_1=require(a237_0x4aad9b(0x132));class SalesforceRetrieverService{constructor(_0x5c86fb){const _0x3b6071=a237_0x4aad9b;this[_0x3b6071(0x14a)]=_0x5c86fb,this[_0x3b6071(0x124)]=new core_1[(_0x3b6071(0x164))](SalesforceRetrieverService['name']),this[_0x3b6071(0x12b)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x235c59){const _0x4776c3=a237_0x4aad9b;this['logger'][_0x4776c3(0x13d)](_0x4776c3(0x149),_0x235c59[_0x4776c3(0x160)]);const _0x11a970=typedi_1[_0x4776c3(0x12f)][_0x4776c3(0x128)](salesforce_query_service_1[_0x4776c3(0x147)]),_0x141cfd=_0x235c59[_0x4776c3(0x15c)](_0x5a35fe=>'\x27'+_0x5a35fe+'\x27'),_0x2029ac=[];while(_0x141cfd[_0x4776c3(0x160)]){const _0x1efcb2=_0x141cfd[_0x4776c3(0x155)](0x0,this['COMPONENTS_PER_QUERY']),_0x4c79b7=_0x11a970[_0x4776c3(0x135)](queries_1[_0x4776c3(0x138)][_0x4776c3(0x14e)]('%parent_ids%',_0x1efcb2['join']())),_0x25f26d=_0x11a970[_0x4776c3(0x135)](queries_1[_0x4776c3(0x125)]['replace'](_0x4776c3(0x141),_0x1efcb2[_0x4776c3(0x150)]()))[_0x4776c3(0x130)](_0x114f68=>_0x114f68[_0x4776c3(0x15c)](_0x5c003d=>flosum_component_history_dto_1[_0x4776c3(0x14b)][_0x4776c3(0x15e)](_0x5c003d))),[_0x244141,_0x4cfd5b]=await Promise[_0x4776c3(0x158)]([_0x4c79b7,_0x25f26d]);for(const _0x12b33e of _0x4cfd5b){const _0x9c93a7=_0x244141[_0x4776c3(0x12c)](_0x5cff69=>_0x5cff69[_0x4776c3(0x153)]===_0x12b33e['id']);_0x9c93a7&&_0x2029ac[_0x4776c3(0x134)]({'fileType':_0x9c93a7[_0x4776c3(0x13c)],'fileName':_0x12b33e[_0x4776c3(0x159)],'attachmentId':_0x9c93a7['Id']});}}return _0x2029ac;}async['retrieveLastComponents'](_0x1425e9){const _0x85a188=a237_0x4aad9b,_0xcead82=await this[_0x85a188(0x165)](_0x1425e9);this['logger'][_0x85a188(0x13d)](_0x85a188(0x161));const _0x1e9062=[];for(const _0x53d8b2 of _0xcead82){const _0x3732ef=await this[_0x85a188(0x14a)][_0x85a188(0x139)](_0x53d8b2[_0x85a188(0x12a)],!![]);_0x1e9062['push']({'body':_0x3732ef[_0x85a188(0x14c)](_0x85a188(0x136)),'fileName':_0x53d8b2['fileName'],'fileType':_0x53d8b2[_0x85a188(0x145)]}),this['logger'][_0x85a188(0x13d)](_0x85a188(0x14d),_0x1e9062['length'],_0x1425e9[_0x85a188(0x160)]);}return _0x1e9062;}async[a237_0x4aad9b(0x144)](_0x2b064e){const _0xed9f00=a237_0x4aad9b,_0x4c3174=[..._0x2b064e],_0x1e42b6=[],_0x5c5506=[];while(_0x4c3174[_0xed9f00(0x160)]){const _0x4a4e97=_0x4c3174['splice'](0x0,this[_0xed9f00(0x12b)]),_0xc663c6=await this['salesforceService'][_0xed9f00(0x148)](_0x4a4e97);_0x4a4e97[_0xed9f00(0x160)]!==_0xc663c6[_0xed9f00(0x137)][_0xed9f00(0x160)]?(_0x4c3174[_0xed9f00(0x134)](..._0xc663c6['ids']),_0x1e42b6[_0xed9f00(0x134)](..._0xc663c6[_0xed9f00(0x133)])):_0x5c5506['push'](..._0x4a4e97),this[_0xed9f00(0x124)][_0xed9f00(0x157)](_0xed9f00(0x13a),_0x2b064e[_0xed9f00(0x160)]-_0x4c3174[_0xed9f00(0x160)],_0x2b064e[_0xed9f00(0x160)]);}if(_0x5c5506[_0xed9f00(0x160)]){const _0x243221=await this[_0xed9f00(0x12e)](_0x5c5506);_0x1e42b6[_0xed9f00(0x134)](..._0x243221);}return _0x1e42b6;}}exports[a237_0x4aad9b(0x15d)]=SalesforceRetrieverService;