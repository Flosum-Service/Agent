const a269_0x23c16b=a269_0x2fcf;(function(_0x9662e5,_0x435d74){const _0x59d1c5=a269_0x2fcf,_0x202347=_0x9662e5();while(!![]){try{const _0x591002=-parseInt(_0x59d1c5(0xf7))/0x1+parseInt(_0x59d1c5(0xfa))/0x2*(-parseInt(_0x59d1c5(0xdc))/0x3)+parseInt(_0x59d1c5(0xff))/0x4*(parseInt(_0x59d1c5(0x10d))/0x5)+parseInt(_0x59d1c5(0x104))/0x6*(parseInt(_0x59d1c5(0xea))/0x7)+-parseInt(_0x59d1c5(0x112))/0x8+parseInt(_0x59d1c5(0x10e))/0x9*(-parseInt(_0x59d1c5(0x110))/0xa)+parseInt(_0x59d1c5(0x113))/0xb*(parseInt(_0x59d1c5(0x114))/0xc);if(_0x591002===_0x435d74)break;else _0x202347['push'](_0x202347['shift']());}catch(_0x193d8e){_0x202347['push'](_0x202347['shift']());}}}(a269_0x3918,0x58e8f));const a269_0x19d8b6=(function(){let _0x505caf=!![];return function(_0x1b021f,_0x1470c9){const _0x542264=_0x505caf?function(){if(_0x1470c9){const _0x2e8142=_0x1470c9['apply'](_0x1b021f,arguments);return _0x1470c9=null,_0x2e8142;}}:function(){};return _0x505caf=![],_0x542264;};}()),a269_0x22fe13=a269_0x19d8b6(this,function(){const _0x4a0c85=a269_0x2fcf;return a269_0x22fe13[_0x4a0c85(0x10c)]()['search'](_0x4a0c85(0xe7))['toString']()[_0x4a0c85(0xf4)](a269_0x22fe13)['search'](_0x4a0c85(0xe7));});a269_0x22fe13();'use strict';function a269_0x3918(){const _0x551366=['2037vwcEyu','retrieveAttachment','./salesforce-query.service','splice','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','replace','__esModule','retrieveComponentIdsFromHistoryIds','length','fileType','constructor','find','GET_COMPONENT_HISTORIES_BY_IDS','506178OufcyR','attachmentId','log','4BTObLs','../queries','retrieveComponents','query','join','4FXKMiC','filename','map','retrieveLastComponents','Manually\x20retrieving\x20components\x20from\x20salesforce','13170WwuesU','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','logger','%parent_ids%','Retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','SalesforceQueryService','default','salesforceService','toString','3619620lNQUSc','5593608orcCLy','COMPONENTS_PER_REQUEST','10ggOzuq','Manually\x20retrieved\x20%d/%d\x20components','1711096rNgoXy','11cdDSjb','12126684hmdXKi','components','info','../../../../core','base64','1001211BMkHxZ','FlosumComponentHistoryDto','run','defineProperty','ParentId','fromSalesforce','name','SalesforceRetrieverService','Name','ids','__importDefault','(((.+)+)+)+$','COMPONENTS_PER_QUERY','push'];a269_0x3918=function(){return _0x551366;};return a269_0x3918();}var __importDefault=this&&this[a269_0x23c16b(0xe6)]||function(_0x12c370){const _0x13ffb4=a269_0x23c16b;return _0x12c370&&_0x12c370[_0x13ffb4(0xf0)]?_0x12c370:{'default':_0x12c370};};Object[a269_0x23c16b(0xdf)](exports,a269_0x23c16b(0xf0),{'value':!![]}),exports[a269_0x23c16b(0xe3)]=void 0x0;const core_1=require(a269_0x23c16b(0xda)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a269_0x23c16b(0xec)),queries_1=require(a269_0x23c16b(0xfb)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');function a269_0x2fcf(_0x19f636,_0x32ee6d){const _0x5576ab=a269_0x3918();return a269_0x2fcf=function(_0x22fe13,_0x19d8b6){_0x22fe13=_0x22fe13-0xd8;let _0x39186f=_0x5576ab[_0x22fe13];return _0x39186f;},a269_0x2fcf(_0x19f636,_0x32ee6d);}class SalesforceRetrieverService{constructor(_0x18d44f){const _0x2a6e50=a269_0x23c16b;this[_0x2a6e50(0x10b)]=_0x18d44f,this[_0x2a6e50(0x106)]=new core_1['Logger'](SalesforceRetrieverService[_0x2a6e50(0xe2)]),this[_0x2a6e50(0x10f)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async[a269_0x23c16b(0xf1)](_0x290204){const _0xe2f082=a269_0x23c16b;this[_0xe2f082(0x106)][_0xe2f082(0xd9)](_0xe2f082(0x105),_0x290204[_0xe2f082(0xf2)]);const _0x449474=typedi_1[_0xe2f082(0x10a)]['get'](salesforce_query_service_1[_0xe2f082(0x109)]),_0x24247f=_0x290204[_0xe2f082(0x101)](_0x4d0bd5=>'\x27'+_0x4d0bd5+'\x27'),_0x54bef1=[];while(_0x24247f[_0xe2f082(0xf2)]){const _0x5993f7=_0x24247f['splice'](0x0,this[_0xe2f082(0xe8)]),_0x1d7257=_0x449474[_0xe2f082(0xfd)](queries_1[_0xe2f082(0xee)]['replace'](_0xe2f082(0x107),_0x5993f7[_0xe2f082(0xfe)]())),_0x27524e=_0x449474[_0xe2f082(0xfd)](queries_1[_0xe2f082(0xf6)][_0xe2f082(0xef)]('%ids%',_0x5993f7[_0xe2f082(0xfe)]()))['then'](_0x29962b=>_0x29962b[_0xe2f082(0x101)](_0x5d7b66=>flosum_component_history_dto_1[_0xe2f082(0xdd)][_0xe2f082(0xe1)](_0x5d7b66))),[_0xc1b147,_0x55ff52]=await Promise['all']([_0x1d7257,_0x27524e]);for(const _0x5e206a of _0x55ff52){const _0x1098b0=_0xc1b147[_0xe2f082(0xf5)](_0x410f20=>_0x410f20[_0xe2f082(0xe0)]===_0x5e206a['id']);_0x1098b0&&_0x54bef1[_0xe2f082(0xe9)]({'fileType':_0x1098b0[_0xe2f082(0xe4)],'fileName':_0x5e206a[_0xe2f082(0x100)],'attachmentId':_0x1098b0['Id']});}}return _0x54bef1;}async[a269_0x23c16b(0x102)](_0x2176ab){const _0xeaba49=a269_0x23c16b,_0x3cacb7=await this[_0xeaba49(0xf1)](_0x2176ab);this[_0xeaba49(0x106)]['info'](_0xeaba49(0x103));const _0x59754b=[];for(const _0x5d768b of _0x3cacb7){const _0x3a627a=await this['salesforceService'][_0xeaba49(0xeb)](_0x5d768b[_0xeaba49(0xf8)],!![]);_0x59754b['push']({'body':_0x3a627a[_0xeaba49(0x10c)](_0xeaba49(0xdb)),'fileName':_0x5d768b['fileName'],'fileType':_0x5d768b[_0xeaba49(0xf3)]}),this[_0xeaba49(0x106)][_0xeaba49(0xd9)](_0xeaba49(0x111),_0x59754b['length'],_0x2176ab[_0xeaba49(0xf2)]);}return _0x59754b;}async[a269_0x23c16b(0xde)](_0xd73586){const _0x5e9116=a269_0x23c16b,_0x138b50=[..._0xd73586],_0x1fb26b=[],_0x2bb1a5=[];while(_0x138b50['length']){const _0x3aa5ef=_0x138b50[_0x5e9116(0xed)](0x0,this['COMPONENTS_PER_REQUEST']),_0x3dab2e=await this[_0x5e9116(0x10b)][_0x5e9116(0xfc)](_0x3aa5ef);_0x3aa5ef[_0x5e9116(0xf2)]!==_0x3dab2e[_0x5e9116(0xe5)][_0x5e9116(0xf2)]?(_0x138b50[_0x5e9116(0xe9)](..._0x3dab2e[_0x5e9116(0xe5)]),_0x1fb26b[_0x5e9116(0xe9)](..._0x3dab2e[_0x5e9116(0xd8)])):_0x2bb1a5[_0x5e9116(0xe9)](..._0x3aa5ef),this[_0x5e9116(0x106)][_0x5e9116(0xf9)](_0x5e9116(0x108),_0xd73586[_0x5e9116(0xf2)]-_0x138b50[_0x5e9116(0xf2)],_0xd73586[_0x5e9116(0xf2)]);}if(_0x2bb1a5[_0x5e9116(0xf2)]){const _0x318a0d=await this[_0x5e9116(0x102)](_0x2bb1a5);_0x1fb26b[_0x5e9116(0xe9)](..._0x318a0d);}return _0x1fb26b;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;