const a202_0x3dc5a7=a202_0x53a3;(function(_0x38678e,_0x1c2ada){const _0x1326d1=a202_0x53a3,_0x273eb6=_0x38678e();while(!![]){try{const _0x2eb3ae=parseInt(_0x1326d1(0x16c))/0x1+-parseInt(_0x1326d1(0x133))/0x2*(parseInt(_0x1326d1(0x14e))/0x3)+-parseInt(_0x1326d1(0x136))/0x4+-parseInt(_0x1326d1(0x143))/0x5+-parseInt(_0x1326d1(0x155))/0x6*(parseInt(_0x1326d1(0x13a))/0x7)+-parseInt(_0x1326d1(0x15d))/0x8*(parseInt(_0x1326d1(0x146))/0x9)+parseInt(_0x1326d1(0x164))/0xa;if(_0x2eb3ae===_0x1c2ada)break;else _0x273eb6['push'](_0x273eb6['shift']());}catch(_0x135974){_0x273eb6['push'](_0x273eb6['shift']());}}}(a202_0x2387,0xd6080));const a202_0x1becac=(function(){let _0xc196a9=!![];return function(_0x16fccf,_0x40eb94){const _0x1876cc=_0xc196a9?function(){const _0x3adaa5=a202_0x53a3;if(_0x40eb94){const _0x2964a5=_0x40eb94[_0x3adaa5(0x154)](_0x16fccf,arguments);return _0x40eb94=null,_0x2964a5;}}:function(){};return _0xc196a9=![],_0x1876cc;};}()),a202_0xdbbf48=a202_0x1becac(this,function(){const _0x2b06df=a202_0x53a3;return a202_0xdbbf48[_0x2b06df(0x16e)]()[_0x2b06df(0x151)]('(((.+)+)+)+$')[_0x2b06df(0x16e)]()[_0x2b06df(0x142)](a202_0xdbbf48)['search'](_0x2b06df(0x13f));});function a202_0x53a3(_0x2fc0a1,_0x4ea226){const _0x3d4ce2=a202_0x2387();return a202_0x53a3=function(_0xdbbf48,_0x1becac){_0xdbbf48=_0xdbbf48-0x131;let _0x238766=_0x3d4ce2[_0xdbbf48];return _0x238766;},a202_0x53a3(_0x2fc0a1,_0x4ea226);}a202_0xdbbf48();function a202_0x2387(){const _0x319ce4=['name','logger','retrieveComponentIdsFromHistoryIds','get','../queries','12XASMpS','find','log','search','fromSalesforce','attachmentId','apply','6SnvWuh','%ids%','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','COMPONENTS_PER_QUERY','Name','COMPONENTS_PER_REQUEST','filename','ParentId','28552fDEtWr','fileName','base64','%parent_ids%','manually\x20retrieving\x20components\x20from\x20salesforce','replace','SalesforceQueryService','66189430eTyCbD','salesforceService','../dto/flosum-component-history.dto','retrieveLastComponents','all','manually\x20retrieved\x20%d/%d\x20components','map','join','76704eFfCKo','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','toString','splice','__importDefault','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','519602VuvnNW','retrieveComponents','GET_COMPONENT_HISTORIES_BY_IDS','4846452ihsOvU','SalesforceRetrieverService','__esModule','Logger','11621834ohwifQ','fileType','ids','push','./salesforce-query.service','(((.+)+)+)+$','retrieveAttachment','query','constructor','5774185EsUgdP','components','typedi','1899cyFCAu','info','length'];a202_0x2387=function(){return _0x319ce4;};return a202_0x2387();}'use strict';var __importDefault=this&&this[a202_0x3dc5a7(0x131)]||function(_0x709e98){return _0x709e98&&_0x709e98['__esModule']?_0x709e98:{'default':_0x709e98};};Object['defineProperty'](exports,a202_0x3dc5a7(0x138),{'value':!![]}),exports[a202_0x3dc5a7(0x137)]=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require(a202_0x3dc5a7(0x145))),salesforce_query_service_1=require(a202_0x3dc5a7(0x13e)),queries_1=require(a202_0x3dc5a7(0x14d)),flosum_component_history_dto_1=require(a202_0x3dc5a7(0x166));class SalesforceRetrieverService{constructor(_0x50277c){const _0x25232d=a202_0x3dc5a7;this['salesforceService']=_0x50277c,this[_0x25232d(0x14a)]=new core_1[(_0x25232d(0x139))](SalesforceRetrieverService[_0x25232d(0x149)]),this[_0x25232d(0x15a)]=0xbb8,this[_0x25232d(0x158)]=0x1f4;}async[a202_0x3dc5a7(0x14b)](_0x371c83){const _0x48b8f1=a202_0x3dc5a7;this[_0x48b8f1(0x14a)][_0x48b8f1(0x147)](_0x48b8f1(0x16d),_0x371c83[_0x48b8f1(0x148)]);const _0x24d359=typedi_1['default'][_0x48b8f1(0x14c)](salesforce_query_service_1[_0x48b8f1(0x163)]),_0x5d6a1d=_0x371c83[_0x48b8f1(0x16a)](_0x19f8c0=>'\x27'+_0x19f8c0+'\x27'),_0x224fdf=[];while(_0x5d6a1d[_0x48b8f1(0x148)]){const _0x680ce3=_0x5d6a1d['splice'](0x0,this[_0x48b8f1(0x158)]),_0x183765=_0x24d359[_0x48b8f1(0x141)](queries_1[_0x48b8f1(0x157)][_0x48b8f1(0x162)](_0x48b8f1(0x160),_0x680ce3['join']())),_0x2fb50a=_0x24d359[_0x48b8f1(0x141)](queries_1[_0x48b8f1(0x135)][_0x48b8f1(0x162)](_0x48b8f1(0x156),_0x680ce3[_0x48b8f1(0x16b)]()))['then'](_0x44a9d8=>_0x44a9d8[_0x48b8f1(0x16a)](_0x494ad1=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0x48b8f1(0x152)](_0x494ad1))),[_0x1eee60,_0x573a2d]=await Promise[_0x48b8f1(0x168)]([_0x183765,_0x2fb50a]);for(const _0x1fe81a of _0x573a2d){const _0x73793=_0x1eee60[_0x48b8f1(0x14f)](_0x4518e8=>_0x4518e8[_0x48b8f1(0x15c)]===_0x1fe81a['id']);_0x73793&&_0x224fdf[_0x48b8f1(0x13d)]({'fileType':_0x73793[_0x48b8f1(0x159)],'fileName':_0x1fe81a[_0x48b8f1(0x15b)],'attachmentId':_0x73793['Id']});}}return _0x224fdf;}async['retrieveLastComponents'](_0x748dda){const _0x3511c7=a202_0x3dc5a7,_0x67d260=await this[_0x3511c7(0x14b)](_0x748dda);this[_0x3511c7(0x14a)][_0x3511c7(0x147)](_0x3511c7(0x161));const _0x266d79=[];for(const _0x477787 of _0x67d260){const _0x9ee0ee=await this[_0x3511c7(0x165)][_0x3511c7(0x140)](_0x477787[_0x3511c7(0x153)],!![]);_0x266d79[_0x3511c7(0x13d)]({'body':_0x9ee0ee[_0x3511c7(0x16e)](_0x3511c7(0x15f)),'fileName':_0x477787[_0x3511c7(0x15e)],'fileType':_0x477787[_0x3511c7(0x13b)]}),this['logger'][_0x3511c7(0x147)](_0x3511c7(0x169),_0x266d79[_0x3511c7(0x148)],_0x748dda[_0x3511c7(0x148)]);}return _0x266d79;}async['run'](_0x4cc845){const _0x24c9e8=a202_0x3dc5a7,_0x30360c=[..._0x4cc845],_0x249823=[],_0x911dd=[];while(_0x30360c[_0x24c9e8(0x148)]){const _0x3aef64=_0x30360c[_0x24c9e8(0x16f)](0x0,this[_0x24c9e8(0x15a)]),_0x3ec31d=await this[_0x24c9e8(0x165)][_0x24c9e8(0x134)](_0x3aef64);_0x3aef64[_0x24c9e8(0x148)]!==_0x3ec31d[_0x24c9e8(0x13c)][_0x24c9e8(0x148)]?(_0x30360c[_0x24c9e8(0x13d)](..._0x3ec31d[_0x24c9e8(0x13c)]),_0x249823['push'](..._0x3ec31d[_0x24c9e8(0x144)])):_0x911dd[_0x24c9e8(0x13d)](..._0x3aef64),this[_0x24c9e8(0x14a)][_0x24c9e8(0x150)](_0x24c9e8(0x132),_0x4cc845[_0x24c9e8(0x148)]-_0x30360c[_0x24c9e8(0x148)],_0x4cc845[_0x24c9e8(0x148)]);}if(_0x911dd[_0x24c9e8(0x148)]){const _0x440d81=await this[_0x24c9e8(0x167)](_0x911dd);_0x249823[_0x24c9e8(0x13d)](..._0x440d81);}return _0x249823;}}exports[a202_0x3dc5a7(0x137)]=SalesforceRetrieverService;