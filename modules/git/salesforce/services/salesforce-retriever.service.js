const a237_0x5725cf=a237_0xf577;function a237_0x3a49(){const _0x2c2194=['name','salesforceService','./salesforce-query.service','ParentId','679DEnmoz','base64','FlosumComponentHistoryDto','apply','Name','manually\x20retrieved\x20%d/%d\x20components','run','retrieveComponents','__importDefault','join','query','typedi','length','logger','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','constructor','COMPONENTS_PER_REQUEST','ids','push','__esModule','%ids%','fromSalesforce','all','defineProperty','splice','../../../../core','197997QgwrAl','get','%parent_ids%','info','toString','retrieveLastComponents','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','map','search','manually\x20retrieving\x20components\x20from\x20salesforce','fileName','retrieveAttachment','SalesforceRetrieverService','Logger','234LBAiIr','309111xJrpME','retrieveComponentIdsFromHistoryIds','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','fileType','filename','5776400YFUrog','35948Djzbix','then','(((.+)+)+)+$','506682bOCGEk','GET_COMPONENT_HISTORIES_BY_IDS','default','1718880LAtKlF'];a237_0x3a49=function(){return _0x2c2194;};return a237_0x3a49();}(function(_0x14b9a0,_0x44a499){const _0x2ea8cf=a237_0xf577,_0x2e08c9=_0x14b9a0();while(!![]){try{const _0x1ad3ba=parseInt(_0x2ea8cf(0xd0))/0x1+parseInt(_0x2ea8cf(0xd9))/0x2+parseInt(_0x2ea8cf(0xfb))/0x3+-parseInt(_0x2ea8cf(0xd6))/0x4+parseInt(_0x2ea8cf(0xdc))/0x5+parseInt(_0x2ea8cf(0xcf))/0x6*(-parseInt(_0x2ea8cf(0xe1))/0x7)+-parseInt(_0x2ea8cf(0xd5))/0x8;if(_0x1ad3ba===_0x44a499)break;else _0x2e08c9['push'](_0x2e08c9['shift']());}catch(_0x248c96){_0x2e08c9['push'](_0x2e08c9['shift']());}}}(a237_0x3a49,0x39f5f));const a237_0x1a4d8c=(function(){let _0x55fb9d=!![];return function(_0x316586,_0x3e0792){const _0x451130=_0x55fb9d?function(){const _0x1d81f5=a237_0xf577;if(_0x3e0792){const _0x549da9=_0x3e0792[_0x1d81f5(0xe4)](_0x316586,arguments);return _0x3e0792=null,_0x549da9;}}:function(){};return _0x55fb9d=![],_0x451130;};}()),a237_0x35d5a3=a237_0x1a4d8c(this,function(){const _0x595113=a237_0xf577;return a237_0x35d5a3['toString']()['search'](_0x595113(0xd8))[_0x595113(0xff)]()[_0x595113(0xf0)](a237_0x35d5a3)[_0x595113(0x103)](_0x595113(0xd8));});function a237_0xf577(_0x3f2ec9,_0xbb47f4){const _0xa01cb2=a237_0x3a49();return a237_0xf577=function(_0x35d5a3,_0x1a4d8c){_0x35d5a3=_0x35d5a3-0xce;let _0x3a49d7=_0xa01cb2[_0x35d5a3];return _0x3a49d7;},a237_0xf577(_0x3f2ec9,_0xbb47f4);}a237_0x35d5a3();'use strict';var __importDefault=this&&this[a237_0x5725cf(0xe9)]||function(_0x5d8d70){const _0x568d5e=a237_0x5725cf;return _0x5d8d70&&_0x5d8d70[_0x568d5e(0xf4)]?_0x5d8d70:{'default':_0x5d8d70};};Object[a237_0x5725cf(0xf8)](exports,a237_0x5725cf(0xf4),{'value':!![]}),exports[a237_0x5725cf(0x107)]=void 0x0;const core_1=require(a237_0x5725cf(0xfa)),typedi_1=__importDefault(require(a237_0x5725cf(0xec))),salesforce_query_service_1=require(a237_0x5725cf(0xdf)),queries_1=require('../queries'),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x1f887d){const _0x238694=a237_0x5725cf;this[_0x238694(0xde)]=_0x1f887d,this[_0x238694(0xee)]=new core_1[(_0x238694(0xce))](SalesforceRetrieverService[_0x238694(0xdd)]),this[_0x238694(0xf1)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async[a237_0x5725cf(0xd1)](_0x29a8bf){const _0xf8cde8=a237_0x5725cf;this['logger'][_0xf8cde8(0xfe)](_0xf8cde8(0x101),_0x29a8bf[_0xf8cde8(0xed)]);const _0x585655=typedi_1[_0xf8cde8(0xdb)][_0xf8cde8(0xfc)](salesforce_query_service_1['SalesforceQueryService']),_0x47120d=_0x29a8bf[_0xf8cde8(0x102)](_0x34cc80=>'\x27'+_0x34cc80+'\x27'),_0xf0721a=[];while(_0x47120d[_0xf8cde8(0xed)]){const _0x4bea72=_0x47120d['splice'](0x0,this['COMPONENTS_PER_QUERY']),_0x19ade6=_0x585655[_0xf8cde8(0xeb)](queries_1[_0xf8cde8(0xef)]['replace'](_0xf8cde8(0xfd),_0x4bea72[_0xf8cde8(0xea)]())),_0x2f18dc=_0x585655['query'](queries_1[_0xf8cde8(0xda)]['replace'](_0xf8cde8(0xf5),_0x4bea72[_0xf8cde8(0xea)]()))[_0xf8cde8(0xd7)](_0x22a459=>_0x22a459['map'](_0x1f15e1=>flosum_component_history_dto_1[_0xf8cde8(0xe3)][_0xf8cde8(0xf6)](_0x1f15e1))),[_0x228e1c,_0x3b4d02]=await Promise[_0xf8cde8(0xf7)]([_0x19ade6,_0x2f18dc]);for(const _0x424c3c of _0x3b4d02){const _0x19ce91=_0x228e1c['find'](_0x5b1b89=>_0x5b1b89[_0xf8cde8(0xe0)]===_0x424c3c['id']);_0x19ce91&&_0xf0721a[_0xf8cde8(0xf3)]({'fileType':_0x19ce91[_0xf8cde8(0xe5)],'fileName':_0x424c3c[_0xf8cde8(0xd4)],'attachmentId':_0x19ce91['Id']});}}return _0xf0721a;}async[a237_0x5725cf(0x100)](_0x19063a){const _0x9e2504=a237_0x5725cf,_0x58de3a=await this[_0x9e2504(0xd1)](_0x19063a);this[_0x9e2504(0xee)][_0x9e2504(0xfe)](_0x9e2504(0x104));const _0x5cb6db=[];for(const _0x2c7490 of _0x58de3a){const _0x6526d5=await this[_0x9e2504(0xde)][_0x9e2504(0x106)](_0x2c7490['attachmentId'],!![]);_0x5cb6db[_0x9e2504(0xf3)]({'body':_0x6526d5[_0x9e2504(0xff)](_0x9e2504(0xe2)),'fileName':_0x2c7490[_0x9e2504(0x105)],'fileType':_0x2c7490[_0x9e2504(0xd3)]}),this[_0x9e2504(0xee)][_0x9e2504(0xfe)](_0x9e2504(0xe6),_0x5cb6db[_0x9e2504(0xed)],_0x19063a[_0x9e2504(0xed)]);}return _0x5cb6db;}async[a237_0x5725cf(0xe7)](_0x97a6c){const _0x26b5d0=a237_0x5725cf,_0x20dbc4=[..._0x97a6c],_0x200c37=[],_0x18df81=[];while(_0x20dbc4['length']){const _0x320458=_0x20dbc4[_0x26b5d0(0xf9)](0x0,this[_0x26b5d0(0xf1)]),_0x10fb8f=await this[_0x26b5d0(0xde)][_0x26b5d0(0xe8)](_0x320458);_0x320458[_0x26b5d0(0xed)]!==_0x10fb8f[_0x26b5d0(0xf2)][_0x26b5d0(0xed)]?(_0x20dbc4[_0x26b5d0(0xf3)](..._0x10fb8f[_0x26b5d0(0xf2)]),_0x200c37[_0x26b5d0(0xf3)](..._0x10fb8f['components'])):_0x18df81[_0x26b5d0(0xf3)](..._0x320458),this[_0x26b5d0(0xee)]['log'](_0x26b5d0(0xd2),_0x97a6c[_0x26b5d0(0xed)]-_0x20dbc4[_0x26b5d0(0xed)],_0x97a6c[_0x26b5d0(0xed)]);}if(_0x18df81[_0x26b5d0(0xed)]){const _0x45067a=await this[_0x26b5d0(0x100)](_0x18df81);_0x200c37[_0x26b5d0(0xf3)](..._0x45067a);}return _0x200c37;}}exports[a237_0x5725cf(0x107)]=SalesforceRetrieverService;