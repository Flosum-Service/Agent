const a280_0x293681=a280_0x2f1d;(function(_0x26545f,_0x1327af){const _0x1a76c7=a280_0x2f1d,_0x258160=_0x26545f();while(!![]){try{const _0x153bc6=parseInt(_0x1a76c7(0x17b))/0x1*(-parseInt(_0x1a76c7(0x176))/0x2)+parseInt(_0x1a76c7(0x16f))/0x3+-parseInt(_0x1a76c7(0x16e))/0x4+parseInt(_0x1a76c7(0x14c))/0x5+parseInt(_0x1a76c7(0x15b))/0x6+-parseInt(_0x1a76c7(0x171))/0x7*(parseInt(_0x1a76c7(0x179))/0x8)+parseInt(_0x1a76c7(0x166))/0x9;if(_0x153bc6===_0x1327af)break;else _0x258160['push'](_0x258160['shift']());}catch(_0x13b9b0){_0x258160['push'](_0x258160['shift']());}}}(a280_0x4e3e,0x9d528));const a280_0x4087e6=(function(){let _0x402124=!![];return function(_0x15c58b,_0x11dabd){const _0x54fc65=_0x402124?function(){if(_0x11dabd){const _0x185e8d=_0x11dabd['apply'](_0x15c58b,arguments);return _0x11dabd=null,_0x185e8d;}}:function(){};return _0x402124=![],_0x54fc65;};}()),a280_0x3411b0=a280_0x4087e6(this,function(){const _0x42145e=a280_0x2f1d;return a280_0x3411b0['toString']()[_0x42145e(0x154)]('(((.+)+)+)+$')[_0x42145e(0x16d)]()[_0x42145e(0x170)](a280_0x3411b0)[_0x42145e(0x154)]('(((.+)+)+)+$');});function a280_0x2f1d(_0x55c161,_0x5f01f4){const _0x19112f=a280_0x4e3e();return a280_0x2f1d=function(_0x3411b0,_0x4087e6){_0x3411b0=_0x3411b0-0x149;let _0x4e3e89=_0x19112f[_0x3411b0];return _0x4e3e89;},a280_0x2f1d(_0x55c161,_0x5f01f4);}a280_0x3411b0();'use strict';var __importDefault=this&&this[a280_0x293681(0x149)]||function(_0x134ebc){return _0x134ebc&&_0x134ebc['__esModule']?_0x134ebc:{'default':_0x134ebc};};Object['defineProperty'](exports,a280_0x293681(0x14a),{'value':!![]}),exports[a280_0x293681(0x16a)]=void 0x0;function a280_0x4e3e(){const _0x7f5270=['GET_COMPONENT_HISTORIES_BY_IDS','name','logger','all','FlosumComponentHistoryDto','search','attachmentId','Manually\x20retrieving\x20components\x20from\x20salesforce','replace','typedi','push','Name','5449200cRoMVK','filename','get','salesforceService','COMPONENTS_PER_QUERY','ParentId','retrieveComponentIdsFromHistoryIds','fromSalesforce','./salesforce-query.service','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','%parent_ids%','5339862pkeVbA','map','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','../../../../core','SalesforceRetrieverService','info','SalesforceQueryService','toString','3929968xSnhtR','1322568FAhQUD','constructor','95165bxfCrz','length','fileName','then','Manually\x20retrieved\x20%d/%d\x20components','136bqaROZ','../queries','Logger','136OsWqfV','fileType','1637qRJMvA','__importDefault','__esModule','COMPONENTS_PER_REQUEST','134705lFilSg','join','%ids%'];a280_0x4e3e=function(){return _0x7f5270;};return a280_0x4e3e();}const core_1=require(a280_0x293681(0x169)),typedi_1=__importDefault(require(a280_0x293681(0x158))),salesforce_query_service_1=require(a280_0x293681(0x163)),queries_1=require(a280_0x293681(0x177)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x1d5d6c){const _0x5afddf=a280_0x293681;this['salesforceService']=_0x1d5d6c,this[_0x5afddf(0x151)]=new core_1[(_0x5afddf(0x178))](SalesforceRetrieverService[_0x5afddf(0x150)]),this[_0x5afddf(0x14b)]=0xbb8,this[_0x5afddf(0x15f)]=0x1f4;}async[a280_0x293681(0x161)](_0x5bbc20){const _0x5f4254=a280_0x293681;this[_0x5f4254(0x151)]['info'](_0x5f4254(0x168),_0x5bbc20[_0x5f4254(0x172)]);const _0x557aae=typedi_1['default'][_0x5f4254(0x15d)](salesforce_query_service_1[_0x5f4254(0x16c)]),_0x466190=_0x5bbc20[_0x5f4254(0x167)](_0x5ebefa=>'\x27'+_0x5ebefa+'\x27'),_0x1dc09d=[];while(_0x466190[_0x5f4254(0x172)]){const _0x486e30=_0x466190['splice'](0x0,this[_0x5f4254(0x15f)]),_0x42f622=_0x557aae['query'](queries_1[_0x5f4254(0x164)][_0x5f4254(0x157)](_0x5f4254(0x165),_0x486e30['join']())),_0x361e7b=_0x557aae['query'](queries_1[_0x5f4254(0x14f)]['replace'](_0x5f4254(0x14e),_0x486e30[_0x5f4254(0x14d)]()))[_0x5f4254(0x174)](_0x12ccb0=>_0x12ccb0[_0x5f4254(0x167)](_0x5a82c=>flosum_component_history_dto_1[_0x5f4254(0x153)][_0x5f4254(0x162)](_0x5a82c))),[_0xda31b2,_0x568fd1]=await Promise[_0x5f4254(0x152)]([_0x42f622,_0x361e7b]);for(const _0x21b8db of _0x568fd1){const _0x3cf639=_0xda31b2['find'](_0x5d0e47=>_0x5d0e47[_0x5f4254(0x160)]===_0x21b8db['id']);_0x3cf639&&_0x1dc09d[_0x5f4254(0x159)]({'fileType':_0x3cf639[_0x5f4254(0x15a)],'fileName':_0x21b8db[_0x5f4254(0x15c)],'attachmentId':_0x3cf639['Id']});}}return _0x1dc09d;}async['retrieveLastComponents'](_0x22f3ae){const _0x492b73=a280_0x293681,_0x576550=await this[_0x492b73(0x161)](_0x22f3ae);this[_0x492b73(0x151)][_0x492b73(0x16b)](_0x492b73(0x156));const _0x56a28f=[];for(const _0xabf3b7 of _0x576550){const _0x458912=await this[_0x492b73(0x15e)]['retrieveAttachment'](_0xabf3b7[_0x492b73(0x155)],!![]);_0x56a28f[_0x492b73(0x159)]({'body':_0x458912[_0x492b73(0x16d)]('base64'),'fileName':_0xabf3b7[_0x492b73(0x173)],'fileType':_0xabf3b7[_0x492b73(0x17a)]}),this[_0x492b73(0x151)]['info'](_0x492b73(0x175),_0x56a28f[_0x492b73(0x172)],_0x22f3ae[_0x492b73(0x172)]);}return _0x56a28f;}async['run'](_0x414bbc){if(!_0x414bbc['length'])return[];const _0x395665=await this['salesforceService']['retrieveComponents'](_0x414bbc);return _0x395665;}}exports[a280_0x293681(0x16a)]=SalesforceRetrieverService;