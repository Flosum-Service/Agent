const a269_0xd16619=a269_0x5cb4;(function(_0x1313fe,_0x31abcc){const _0x5a7b05=a269_0x5cb4,_0x20a270=_0x1313fe();while(!![]){try{const _0x1a439d=-parseInt(_0x5a7b05(0xab))/0x1+-parseInt(_0x5a7b05(0x83))/0x2+parseInt(_0x5a7b05(0x9f))/0x3+-parseInt(_0x5a7b05(0x8f))/0x4+parseInt(_0x5a7b05(0x8b))/0x5*(parseInt(_0x5a7b05(0x9c))/0x6)+-parseInt(_0x5a7b05(0x87))/0x7+-parseInt(_0x5a7b05(0x97))/0x8*(-parseInt(_0x5a7b05(0x7f))/0x9);if(_0x1a439d===_0x31abcc)break;else _0x20a270['push'](_0x20a270['shift']());}catch(_0x281efe){_0x20a270['push'](_0x20a270['shift']());}}}(a269_0x2ed9,0xdd861));const a269_0x763910=(function(){let _0x5c0504=!![];return function(_0x433cf8,_0x4c6a86){const _0x32eb24=_0x5c0504?function(){const _0x58e79e=a269_0x5cb4;if(_0x4c6a86){const _0x563c1e=_0x4c6a86[_0x58e79e(0xa7)](_0x433cf8,arguments);return _0x4c6a86=null,_0x563c1e;}}:function(){};return _0x5c0504=![],_0x32eb24;};}()),a269_0x2faf5a=a269_0x763910(this,function(){const _0x3e34c0=a269_0x5cb4;return a269_0x2faf5a[_0x3e34c0(0x96)]()['search'](_0x3e34c0(0x91))[_0x3e34c0(0x96)]()[_0x3e34c0(0xa5)](a269_0x2faf5a)[_0x3e34c0(0xa6)]('(((.+)+)+)+$');});function a269_0x2ed9(){const _0x266085=['filename','468737JKxWpk','fileName','join','Manually\x20retrieving\x20components\x20from\x20salesforce','SalesforceQueryService','attachmentId','FlosumComponentHistoryDto','name','SalesforceRetrieverService','__importDefault','../queries','387eVAsRe','fromSalesforce','query','map','2660512ayAoSF','all','ParentId','__esModule','4415558jQIHVh','Manually\x20retrieved\x20%d/%d\x20components','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','replace','37385bsyCHS','find','length','%parent_ids%','3954176dxGXBa','COMPONENTS_PER_QUERY','(((.+)+)+)+$','Logger','splice','base64','default','toString','423752KpXXGK','./salesforce-query.service','GET_COMPONENT_HISTORIES_BY_IDS','info','fileType','1170IiYpob','retrieveComponents','%ids%','1770030Ynpbav','logger','typedi','salesforceService','get','then','constructor','search','apply','retrieveComponentIdsFromHistoryIds','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)'];a269_0x2ed9=function(){return _0x266085;};return a269_0x2ed9();}a269_0x2faf5a();'use strict';function a269_0x5cb4(_0x13ded6,_0x164412){const _0xde1bef=a269_0x2ed9();return a269_0x5cb4=function(_0x2faf5a,_0x763910){_0x2faf5a=_0x2faf5a-0x7d;let _0x2ed94f=_0xde1bef[_0x2faf5a];return _0x2ed94f;},a269_0x5cb4(_0x13ded6,_0x164412);}var __importDefault=this&&this[a269_0xd16619(0x7d)]||function(_0x13243d){return _0x13243d&&_0x13243d['__esModule']?_0x13243d:{'default':_0x13243d};};Object['defineProperty'](exports,a269_0xd16619(0x86),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require(a269_0xd16619(0xa1))),salesforce_query_service_1=require(a269_0xd16619(0x98)),queries_1=require(a269_0xd16619(0x7e)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x3a2627){const _0x2fd0fa=a269_0xd16619;this[_0x2fd0fa(0xa2)]=_0x3a2627,this['logger']=new core_1[(_0x2fd0fa(0x92))](SalesforceRetrieverService[_0x2fd0fa(0xb2)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x2fd0fa(0x90)]=0x1f4;}async[a269_0xd16619(0xa8)](_0x2d179d){const _0x397c60=a269_0xd16619;this[_0x397c60(0xa0)][_0x397c60(0x9a)](_0x397c60(0xa9),_0x2d179d[_0x397c60(0x8d)]);const _0x30a50a=typedi_1[_0x397c60(0x95)][_0x397c60(0xa3)](salesforce_query_service_1[_0x397c60(0xaf)]),_0x123731=_0x2d179d[_0x397c60(0x82)](_0x34f421=>'\x27'+_0x34f421+'\x27'),_0x2ad16d=[];while(_0x123731[_0x397c60(0x8d)]){const _0x3e8660=_0x123731[_0x397c60(0x93)](0x0,this['COMPONENTS_PER_QUERY']),_0x27ed6b=_0x30a50a['query'](queries_1[_0x397c60(0x89)][_0x397c60(0x8a)](_0x397c60(0x8e),_0x3e8660[_0x397c60(0xad)]())),_0x52e6a1=_0x30a50a[_0x397c60(0x81)](queries_1[_0x397c60(0x99)][_0x397c60(0x8a)](_0x397c60(0x9e),_0x3e8660[_0x397c60(0xad)]()))[_0x397c60(0xa4)](_0x1ddd87=>_0x1ddd87[_0x397c60(0x82)](_0x13d285=>flosum_component_history_dto_1[_0x397c60(0xb1)][_0x397c60(0x80)](_0x13d285))),[_0x1c28ad,_0x59f68e]=await Promise[_0x397c60(0x84)]([_0x27ed6b,_0x52e6a1]);for(const _0x528b34 of _0x59f68e){const _0x68c0e4=_0x1c28ad[_0x397c60(0x8c)](_0x182b90=>_0x182b90[_0x397c60(0x85)]===_0x528b34['id']);_0x68c0e4&&_0x2ad16d['push']({'fileType':_0x68c0e4['Name'],'fileName':_0x528b34[_0x397c60(0xaa)],'attachmentId':_0x68c0e4['Id']});}}return _0x2ad16d;}async['retrieveLastComponents'](_0x4eba80){const _0x47c484=a269_0xd16619,_0x2163bd=await this[_0x47c484(0xa8)](_0x4eba80);this[_0x47c484(0xa0)][_0x47c484(0x9a)](_0x47c484(0xae));const _0x1a9f52=[];for(const _0x12facc of _0x2163bd){const _0x342db6=await this[_0x47c484(0xa2)]['retrieveAttachment'](_0x12facc[_0x47c484(0xb0)],!![]);_0x1a9f52['push']({'body':_0x342db6[_0x47c484(0x96)](_0x47c484(0x94)),'fileName':_0x12facc[_0x47c484(0xac)],'fileType':_0x12facc[_0x47c484(0x9b)]}),this[_0x47c484(0xa0)][_0x47c484(0x9a)](_0x47c484(0x88),_0x1a9f52[_0x47c484(0x8d)],_0x4eba80['length']);}return _0x1a9f52;}async['run'](_0x58c083){const _0x370719=a269_0xd16619;if(!_0x58c083[_0x370719(0x8d)])return[];const _0x50cc2a=await this[_0x370719(0xa2)][_0x370719(0x9d)](_0x58c083);return _0x50cc2a;}}exports[a269_0xd16619(0xb3)]=SalesforceRetrieverService;