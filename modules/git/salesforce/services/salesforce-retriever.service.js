const a269_0x2f4841=a269_0x3c4a;(function(_0x4b329a,_0x2309c3){const _0x212b81=a269_0x3c4a,_0x4da190=_0x4b329a();while(!![]){try{const _0x363767=-parseInt(_0x212b81(0x21a))/0x1+parseInt(_0x212b81(0x1f5))/0x2*(-parseInt(_0x212b81(0x204))/0x3)+-parseInt(_0x212b81(0x203))/0x4+parseInt(_0x212b81(0x216))/0x5*(parseInt(_0x212b81(0x1e7))/0x6)+parseInt(_0x212b81(0x1ff))/0x7+-parseInt(_0x212b81(0x1f8))/0x8+parseInt(_0x212b81(0x210))/0x9;if(_0x363767===_0x2309c3)break;else _0x4da190['push'](_0x4da190['shift']());}catch(_0x1d14c9){_0x4da190['push'](_0x4da190['shift']());}}}(a269_0x144d,0x5edb7));const a269_0x217eed=(function(){let _0x173908=!![];return function(_0x2ad419,_0x58814e){const _0x2abb54=_0x173908?function(){const _0x290cd1=a269_0x3c4a;if(_0x58814e){const _0x4c77fb=_0x58814e[_0x290cd1(0x1f7)](_0x2ad419,arguments);return _0x58814e=null,_0x4c77fb;}}:function(){};return _0x173908=![],_0x2abb54;};}()),a269_0x53f165=a269_0x217eed(this,function(){const _0x58d70f=a269_0x3c4a;return a269_0x53f165[_0x58d70f(0x20c)]()[_0x58d70f(0x1eb)]('(((.+)+)+)+$')[_0x58d70f(0x20c)]()[_0x58d70f(0x1f9)](a269_0x53f165)['search'](_0x58d70f(0x1ea));});a269_0x53f165();'use strict';var __importDefault=this&&this[a269_0x2f4841(0x20f)]||function(_0x2931b2){const _0xbff3b9=a269_0x2f4841;return _0x2931b2&&_0x2931b2[_0xbff3b9(0x1ec)]?_0x2931b2:{'default':_0x2931b2};};Object[a269_0x2f4841(0x1f4)](exports,'__esModule',{'value':!![]}),exports[a269_0x2f4841(0x219)]=void 0x0;const core_1=require(a269_0x2f4841(0x218)),typedi_1=__importDefault(require(a269_0x2f4841(0x1fc))),salesforce_query_service_1=require(a269_0x2f4841(0x21c)),queries_1=require(a269_0x2f4841(0x1fe)),flosum_component_history_dto_1=require(a269_0x2f4841(0x212));class SalesforceRetrieverService{constructor(_0x402cbb){const _0x34b37c=a269_0x2f4841;this['salesforceService']=_0x402cbb,this['logger']=new core_1[(_0x34b37c(0x208))](SalesforceRetrieverService[_0x34b37c(0x213)]),this[_0x34b37c(0x206)]=0xbb8,this[_0x34b37c(0x20b)]=0x1f4;}async[a269_0x2f4841(0x207)](_0x5f1df6){const _0x3fe9c7=a269_0x2f4841;this[_0x3fe9c7(0x20d)][_0x3fe9c7(0x1e6)](_0x3fe9c7(0x1f2),_0x5f1df6[_0x3fe9c7(0x20e)]);const _0x554744=typedi_1[_0x3fe9c7(0x205)][_0x3fe9c7(0x1ef)](salesforce_query_service_1['SalesforceQueryService']),_0x313238=_0x5f1df6['map'](_0x221013=>'\x27'+_0x221013+'\x27'),_0x5a473e=[];while(_0x313238[_0x3fe9c7(0x20e)]){const _0x3ac879=_0x313238[_0x3fe9c7(0x1e8)](0x0,this[_0x3fe9c7(0x20b)]),_0x436ce9=_0x554744[_0x3fe9c7(0x200)](queries_1[_0x3fe9c7(0x201)][_0x3fe9c7(0x1fa)](_0x3fe9c7(0x1fd),_0x3ac879[_0x3fe9c7(0x1f3)]())),_0x4113fe=_0x554744[_0x3fe9c7(0x200)](queries_1[_0x3fe9c7(0x1f6)][_0x3fe9c7(0x1fa)](_0x3fe9c7(0x1fb),_0x3ac879[_0x3fe9c7(0x1f3)]()))[_0x3fe9c7(0x20a)](_0x4004b2=>_0x4004b2[_0x3fe9c7(0x21b)](_0x1b6bdf=>flosum_component_history_dto_1[_0x3fe9c7(0x209)]['fromSalesforce'](_0x1b6bdf))),[_0x3643b5,_0x1271b2]=await Promise[_0x3fe9c7(0x202)]([_0x436ce9,_0x4113fe]);for(const _0x197c3a of _0x1271b2){const _0x17b1fc=_0x3643b5['find'](_0x29792a=>_0x29792a[_0x3fe9c7(0x215)]===_0x197c3a['id']);_0x17b1fc&&_0x5a473e[_0x3fe9c7(0x214)]({'fileType':_0x17b1fc[_0x3fe9c7(0x1f0)],'fileName':_0x197c3a[_0x3fe9c7(0x217)],'attachmentId':_0x17b1fc['Id']});}}return _0x5a473e;}async[a269_0x2f4841(0x1f1)](_0x34b7c6){const _0x3108a2=a269_0x2f4841,_0x1d40fb=await this[_0x3108a2(0x207)](_0x34b7c6);this[_0x3108a2(0x20d)]['info']('Manually\x20retrieving\x20components\x20from\x20salesforce');const _0x460b8c=[];for(const _0x310595 of _0x1d40fb){const _0x25bd38=await this[_0x3108a2(0x211)]['retrieveAttachment'](_0x310595[_0x3108a2(0x1e5)],!![]);_0x460b8c[_0x3108a2(0x214)]({'body':_0x25bd38[_0x3108a2(0x20c)]('base64'),'fileName':_0x310595[_0x3108a2(0x21d)],'fileType':_0x310595[_0x3108a2(0x1ee)]}),this['logger'][_0x3108a2(0x1e6)]('Manually\x20retrieved\x20%d/%d\x20components',_0x460b8c[_0x3108a2(0x20e)],_0x34b7c6['length']);}return _0x460b8c;}async[a269_0x2f4841(0x1e9)](_0x285cac){const _0x16f391=a269_0x2f4841;if(!_0x285cac[_0x16f391(0x20e)])return[];const _0x29d989=await this['salesforceService'][_0x16f391(0x1ed)](_0x285cac);return _0x29d989;}}function a269_0x3c4a(_0x479f9a,_0x17d014){const _0x51f65f=a269_0x144d();return a269_0x3c4a=function(_0x53f165,_0x217eed){_0x53f165=_0x53f165-0x1e5;let _0x144d50=_0x51f65f[_0x53f165];return _0x144d50;},a269_0x3c4a(_0x479f9a,_0x17d014);}function a269_0x144d(){const _0x4202eb=['retrieveComponentIdsFromHistoryIds','Logger','FlosumComponentHistoryDto','then','COMPONENTS_PER_QUERY','toString','logger','length','__importDefault','13622130dTeUZL','salesforceService','../dto/flosum-component-history.dto','name','push','ParentId','8035unECCa','filename','../../../../core','SalesforceRetrieverService','669145JxJlxv','map','./salesforce-query.service','fileName','attachmentId','info','2526yEdEan','splice','run','(((.+)+)+)+$','search','__esModule','retrieveComponents','fileType','get','Name','retrieveLastComponents','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','join','defineProperty','2ieOWUn','GET_COMPONENT_HISTORIES_BY_IDS','apply','5346472KWoJCw','constructor','replace','%ids%','typedi','%parent_ids%','../queries','5261172VUQhba','query','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','all','2034428VyIxvP','2121351REVhxf','default','COMPONENTS_PER_REQUEST'];a269_0x144d=function(){return _0x4202eb;};return a269_0x144d();}exports[a269_0x2f4841(0x219)]=SalesforceRetrieverService;