const a203_0xe25c1b=a203_0x153e;(function(_0x52a455,_0x3c146a){const _0x2baaf3=a203_0x153e,_0x2272b1=_0x52a455();while(!![]){try{const _0x1237e5=-parseInt(_0x2baaf3(0x1f0))/0x1*(parseInt(_0x2baaf3(0x1dd))/0x2)+parseInt(_0x2baaf3(0x1f4))/0x3+parseInt(_0x2baaf3(0x1fd))/0x4*(parseInt(_0x2baaf3(0x200))/0x5)+-parseInt(_0x2baaf3(0x1e5))/0x6+parseInt(_0x2baaf3(0x1d8))/0x7+parseInt(_0x2baaf3(0x1da))/0x8*(parseInt(_0x2baaf3(0x1d7))/0x9)+parseInt(_0x2baaf3(0x1f3))/0xa;if(_0x1237e5===_0x3c146a)break;else _0x2272b1['push'](_0x2272b1['shift']());}catch(_0x349174){_0x2272b1['push'](_0x2272b1['shift']());}}}(a203_0x5f37,0xbe8e0));const a203_0x1220bd=(function(){let _0x304e6f=!![];return function(_0x2dcc5e,_0x4be059){const _0x2fccb8=_0x304e6f?function(){const _0x16d396=a203_0x153e;if(_0x4be059){const _0x44fab5=_0x4be059[_0x16d396(0x1e8)](_0x2dcc5e,arguments);return _0x4be059=null,_0x44fab5;}}:function(){};return _0x304e6f=![],_0x2fccb8;};}()),a203_0x3b0995=a203_0x1220bd(this,function(){const _0x2ad17c=a203_0x153e;return a203_0x3b0995[_0x2ad17c(0x20a)]()[_0x2ad17c(0x1e1)]('(((.+)+)+)+$')['toString']()['constructor'](a203_0x3b0995)['search'](_0x2ad17c(0x1db));});a203_0x3b0995();function a203_0x5f37(){const _0x5a4efd=['info','1006546OAxnyE','ParentId','COMPONENTS_PER_REQUEST','fromSalesforce','search','ids','SalesforceRetrieverService','COMPONENTS_PER_QUERY','8284290igHqby','%parent_ids%','length','apply','name','retrieveComponentIdsFromHistoryIds','join','retrieveComponents','SalesforceQueryService','map','defineProperty','3YbyGBk','filename','splice','20211790vLoXhj','42585OmmcVJ','%ids%','push','default','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','log','replace','./salesforce-query.service','../dto/flosum-component-history.dto','664968DILnaL','__importDefault','logger','25ppwsUI','retrieveLastComponents','base64','attachmentId','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','salesforceService','Logger','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','run','manually\x20retrieving\x20components\x20from\x20salesforce','toString','components','then','__esModule','fileType','../queries','fileName','query','243CMAdHJ','444696OTrUtk','manually\x20retrieved\x20%d/%d\x20components','219536uPHNUY','(((.+)+)+)+$'];a203_0x5f37=function(){return _0x5a4efd;};return a203_0x5f37();}'use strict';var __importDefault=this&&this[a203_0xe25c1b(0x1fe)]||function(_0x43eadf){const _0x1a25be=a203_0xe25c1b;return _0x43eadf&&_0x43eadf[_0x1a25be(0x1d2)]?_0x43eadf:{'default':_0x43eadf};};Object[a203_0xe25c1b(0x1ef)](exports,a203_0xe25c1b(0x1d2),{'value':!![]}),exports[a203_0xe25c1b(0x1e3)]=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a203_0xe25c1b(0x1fb)),queries_1=require(a203_0xe25c1b(0x1d4)),flosum_component_history_dto_1=require(a203_0xe25c1b(0x1fc));class SalesforceRetrieverService{constructor(_0x37a5e5){const _0x1d75ce=a203_0xe25c1b;this['salesforceService']=_0x37a5e5,this[_0x1d75ce(0x1ff)]=new core_1[(_0x1d75ce(0x206))](SalesforceRetrieverService[_0x1d75ce(0x1e9)]),this[_0x1d75ce(0x1df)]=0xbb8,this[_0x1d75ce(0x1e4)]=0x1f4;}async[a203_0xe25c1b(0x1ea)](_0x5dea7e){const _0x20c271=a203_0xe25c1b;this[_0x20c271(0x1ff)][_0x20c271(0x1dc)](_0x20c271(0x207),_0x5dea7e[_0x20c271(0x1e7)]);const _0x5b92cb=typedi_1[_0x20c271(0x1f7)]['get'](salesforce_query_service_1[_0x20c271(0x1ed)]),_0x2fc983=_0x5dea7e[_0x20c271(0x1ee)](_0x171aeb=>'\x27'+_0x171aeb+'\x27'),_0x15c169=[];while(_0x2fc983['length']){const _0x4ea202=_0x2fc983[_0x20c271(0x1f2)](0x0,this[_0x20c271(0x1e4)]),_0x2e1fc6=_0x5b92cb[_0x20c271(0x1d6)](queries_1[_0x20c271(0x204)]['replace'](_0x20c271(0x1e6),_0x4ea202[_0x20c271(0x1eb)]())),_0x27a420=_0x5b92cb[_0x20c271(0x1d6)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x20c271(0x1fa)](_0x20c271(0x1f5),_0x4ea202['join']()))[_0x20c271(0x1d1)](_0x1820e7=>_0x1820e7[_0x20c271(0x1ee)](_0x5c7ee3=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0x20c271(0x1e0)](_0x5c7ee3))),[_0x1595f6,_0x2be023]=await Promise['all']([_0x2e1fc6,_0x27a420]);for(const _0x3174c4 of _0x2be023){const _0x27d9b9=_0x1595f6['find'](_0x246d45=>_0x246d45[_0x20c271(0x1de)]===_0x3174c4['id']);_0x27d9b9&&_0x15c169[_0x20c271(0x1f6)]({'fileType':_0x27d9b9['Name'],'fileName':_0x3174c4[_0x20c271(0x1f1)],'attachmentId':_0x27d9b9['Id']});}}return _0x15c169;}async[a203_0xe25c1b(0x201)](_0x419a72){const _0x34757e=a203_0xe25c1b,_0x988568=await this[_0x34757e(0x1ea)](_0x419a72);this['logger']['info'](_0x34757e(0x209));const _0x116fdb=[];for(const _0x18ce55 of _0x988568){const _0x50c30=await this[_0x34757e(0x205)]['retrieveAttachment'](_0x18ce55[_0x34757e(0x203)],!![]);_0x116fdb[_0x34757e(0x1f6)]({'body':_0x50c30[_0x34757e(0x20a)](_0x34757e(0x202)),'fileName':_0x18ce55[_0x34757e(0x1d5)],'fileType':_0x18ce55[_0x34757e(0x1d3)]}),this[_0x34757e(0x1ff)][_0x34757e(0x1dc)](_0x34757e(0x1d9),_0x116fdb[_0x34757e(0x1e7)],_0x419a72[_0x34757e(0x1e7)]);}return _0x116fdb;}async[a203_0xe25c1b(0x208)](_0x1dbe9b){const _0x348ecc=a203_0xe25c1b,_0x21d4be=[..._0x1dbe9b],_0x4898b7=[],_0x2827a1=[];while(_0x21d4be[_0x348ecc(0x1e7)]){const _0x1a641b=_0x21d4be['splice'](0x0,this['COMPONENTS_PER_REQUEST']),_0x4b3366=await this[_0x348ecc(0x205)][_0x348ecc(0x1ec)](_0x1a641b);_0x1a641b[_0x348ecc(0x1e7)]!==_0x4b3366[_0x348ecc(0x1e2)]['length']?(_0x21d4be['push'](..._0x4b3366[_0x348ecc(0x1e2)]),_0x4898b7[_0x348ecc(0x1f6)](..._0x4b3366[_0x348ecc(0x20b)])):_0x2827a1[_0x348ecc(0x1f6)](..._0x1a641b),this[_0x348ecc(0x1ff)][_0x348ecc(0x1f9)](_0x348ecc(0x1f8),_0x1dbe9b[_0x348ecc(0x1e7)]-_0x21d4be[_0x348ecc(0x1e7)],_0x1dbe9b[_0x348ecc(0x1e7)]);}if(_0x2827a1[_0x348ecc(0x1e7)]){const _0x21fec7=await this['retrieveLastComponents'](_0x2827a1);_0x4898b7['push'](..._0x21fec7);}return _0x4898b7;}}function a203_0x153e(_0x1ff859,_0xac94cd){const _0x97cc92=a203_0x5f37();return a203_0x153e=function(_0x3b0995,_0x1220bd){_0x3b0995=_0x3b0995-0x1d1;let _0x5f37ac=_0x97cc92[_0x3b0995];return _0x5f37ac;},a203_0x153e(_0x1ff859,_0xac94cd);}exports['SalesforceRetrieverService']=SalesforceRetrieverService;