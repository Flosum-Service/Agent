const a185_0x53ab81=a185_0x4367;function a185_0x4367(_0x38a187,_0x1d660b){const _0x658ae8=a185_0x546a();return a185_0x4367=function(_0x4f1065,_0x14d16e){_0x4f1065=_0x4f1065-0x108;let _0x546a26=_0x658ae8[_0x4f1065];return _0x546a26;},a185_0x4367(_0x38a187,_0x1d660b);}(function(_0x1eed6d,_0x792103){const _0x41cd09=a185_0x4367,_0x5df70c=_0x1eed6d();while(!![]){try{const _0x6737dc=parseInt(_0x41cd09(0x124))/0x1+-parseInt(_0x41cd09(0x121))/0x2+parseInt(_0x41cd09(0x128))/0x3+parseInt(_0x41cd09(0x12b))/0x4+parseInt(_0x41cd09(0x10a))/0x5+parseInt(_0x41cd09(0x108))/0x6*(parseInt(_0x41cd09(0x11d))/0x7)+-parseInt(_0x41cd09(0x10d))/0x8*(parseInt(_0x41cd09(0x142))/0x9);if(_0x6737dc===_0x792103)break;else _0x5df70c['push'](_0x5df70c['shift']());}catch(_0x324e9e){_0x5df70c['push'](_0x5df70c['shift']());}}}(a185_0x546a,0x27690));const a185_0x14d16e=(function(){let _0x2ac54d=!![];return function(_0x2b26cc,_0x3493f5){const _0x479fa4=_0x2ac54d?function(){if(_0x3493f5){const _0x2c2f45=_0x3493f5['apply'](_0x2b26cc,arguments);return _0x3493f5=null,_0x2c2f45;}}:function(){};return _0x2ac54d=![],_0x479fa4;};}()),a185_0x4f1065=a185_0x14d16e(this,function(){const _0x26dd1c=a185_0x4367;return a185_0x4f1065[_0x26dd1c(0x114)]()[_0x26dd1c(0x11e)](_0x26dd1c(0x125))['toString']()[_0x26dd1c(0x13b)](a185_0x4f1065)['search'](_0x26dd1c(0x125));});a185_0x4f1065();'use strict';var __importDefault=this&&this[a185_0x53ab81(0x140)]||function(_0x42f7e3){const _0x112b8b=a185_0x53ab81;return _0x42f7e3&&_0x42f7e3[_0x112b8b(0x109)]?_0x42f7e3:{'default':_0x42f7e3};};Object[a185_0x53ab81(0x143)](exports,a185_0x53ab81(0x109),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;function a185_0x546a(){const _0x35b312=['replace','175601rODtLO','(((.+)+)+)+$','log','retrieveAttachment','3852RxZILQ','ids','info','1083828aGTwzl','COMPONENTS_PER_REQUEST','Name','%parent_ids%','fromSalesforce','fileName','logger','name','then','run','manually\x20retrieving\x20components\x20from\x20salesforce','map','SalesforceQueryService','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','query','retrieveComponents','constructor','salesforceService','typedi','ParentId','fileType','__importDefault','base64','36xSLKzd','defineProperty','filename','retrieveLastComponents','1030596bSybPa','__esModule','259030PBknbz','join','push','976280pSuowP','splice','components','all','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','retrieveComponentIdsFromHistoryIds','default','toString','../queries','get','length','GET_COMPONENT_HISTORIES_BY_IDS','COMPONENTS_PER_QUERY','attachmentId','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','FlosumComponentHistoryDto','7tgQwXO','search','../../../../core','SalesforceRetrieverService','43700Dvjemn','../dto/flosum-component-history.dto'];a185_0x546a=function(){return _0x35b312;};return a185_0x546a();}const core_1=require(a185_0x53ab81(0x11f)),typedi_1=__importDefault(require(a185_0x53ab81(0x13d))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a185_0x53ab81(0x115)),flosum_component_history_dto_1=require(a185_0x53ab81(0x122));class SalesforceRetrieverService{constructor(_0x4a03f7){const _0x2b4bc1=a185_0x53ab81;this[_0x2b4bc1(0x13c)]=_0x4a03f7,this['logger']=new core_1['Logger'](SalesforceRetrieverService[_0x2b4bc1(0x132)]),this[_0x2b4bc1(0x12c)]=0xbb8,this[_0x2b4bc1(0x119)]=0x1f4;}async[a185_0x53ab81(0x112)](_0x661e4b){const _0xda0cc3=a185_0x53ab81;this['logger'][_0xda0cc3(0x12a)](_0xda0cc3(0x111),_0x661e4b[_0xda0cc3(0x117)]);const _0x361cd3=typedi_1[_0xda0cc3(0x113)][_0xda0cc3(0x116)](salesforce_query_service_1[_0xda0cc3(0x137)]),_0x1e1f7d=_0x661e4b['map'](_0x188af3=>'\x27'+_0x188af3+'\x27'),_0x26a52a=[];while(_0x1e1f7d['length']){const _0x24575c=_0x1e1f7d[_0xda0cc3(0x10e)](0x0,this[_0xda0cc3(0x119)]),_0x17ad44=_0x361cd3[_0xda0cc3(0x139)](queries_1[_0xda0cc3(0x11b)][_0xda0cc3(0x123)](_0xda0cc3(0x12e),_0x24575c['join']())),_0x406320=_0x361cd3[_0xda0cc3(0x139)](queries_1[_0xda0cc3(0x118)][_0xda0cc3(0x123)]('%ids%',_0x24575c[_0xda0cc3(0x10b)]()))[_0xda0cc3(0x133)](_0x237815=>_0x237815[_0xda0cc3(0x136)](_0x193e10=>flosum_component_history_dto_1[_0xda0cc3(0x11c)][_0xda0cc3(0x12f)](_0x193e10))),[_0x5619ca,_0xf94022]=await Promise[_0xda0cc3(0x110)]([_0x17ad44,_0x406320]);for(const _0x2219d5 of _0xf94022){const _0x53eb9f=_0x5619ca['find'](_0x48f5e2=>_0x48f5e2[_0xda0cc3(0x13e)]===_0x2219d5['id']);_0x53eb9f&&_0x26a52a[_0xda0cc3(0x10c)]({'fileType':_0x53eb9f[_0xda0cc3(0x12d)],'fileName':_0x2219d5[_0xda0cc3(0x144)],'attachmentId':_0x53eb9f['Id']});}}return _0x26a52a;}async[a185_0x53ab81(0x145)](_0x206a36){const _0x8efbde=a185_0x53ab81,_0x31a68f=await this['retrieveComponentIdsFromHistoryIds'](_0x206a36);this[_0x8efbde(0x131)]['info'](_0x8efbde(0x135));const _0x32b568=[];for(const _0x22582d of _0x31a68f){const _0x1873fe=await this[_0x8efbde(0x13c)][_0x8efbde(0x127)](_0x22582d[_0x8efbde(0x11a)],!![]);_0x32b568[_0x8efbde(0x10c)]({'body':_0x1873fe['toString'](_0x8efbde(0x141)),'fileName':_0x22582d[_0x8efbde(0x130)],'fileType':_0x22582d[_0x8efbde(0x13f)]}),this[_0x8efbde(0x131)][_0x8efbde(0x12a)]('manually\x20retrieved\x20%d/%d\x20components',_0x32b568[_0x8efbde(0x117)],_0x206a36[_0x8efbde(0x117)]);}return _0x32b568;}async[a185_0x53ab81(0x134)](_0x4f0fa3){const _0x761d8e=a185_0x53ab81,_0x11edd9=[..._0x4f0fa3],_0xb9a59b=[],_0x79cfcc=[];while(_0x11edd9[_0x761d8e(0x117)]){const _0x2baaa5=_0x11edd9[_0x761d8e(0x10e)](0x0,this[_0x761d8e(0x12c)]),_0x56909f=await this[_0x761d8e(0x13c)][_0x761d8e(0x13a)](_0x2baaa5);_0x2baaa5[_0x761d8e(0x117)]!==_0x56909f[_0x761d8e(0x129)][_0x761d8e(0x117)]?(_0x11edd9[_0x761d8e(0x10c)](..._0x56909f[_0x761d8e(0x129)]),_0xb9a59b['push'](..._0x56909f[_0x761d8e(0x10f)])):_0x79cfcc[_0x761d8e(0x10c)](..._0x2baaa5),this[_0x761d8e(0x131)][_0x761d8e(0x126)](_0x761d8e(0x138),_0x4f0fa3[_0x761d8e(0x117)]-_0x11edd9[_0x761d8e(0x117)],_0x4f0fa3[_0x761d8e(0x117)]);}if(_0x79cfcc[_0x761d8e(0x117)]){const _0x41ad12=await this['retrieveLastComponents'](_0x79cfcc);_0xb9a59b[_0x761d8e(0x10c)](..._0x41ad12);}return _0xb9a59b;}}exports[a185_0x53ab81(0x120)]=SalesforceRetrieverService;