const a242_0x5c0cbb=a242_0x1f5f;(function(_0x26c4b9,_0x2cdc45){const _0x213ee2=a242_0x1f5f,_0x1d9f2e=_0x26c4b9();while(!![]){try{const _0x348dbe=parseInt(_0x213ee2(0x1a8))/0x1+parseInt(_0x213ee2(0x1aa))/0x2*(-parseInt(_0x213ee2(0x1ce))/0x3)+-parseInt(_0x213ee2(0x1a9))/0x4+parseInt(_0x213ee2(0x1a0))/0x5*(parseInt(_0x213ee2(0x19e))/0x6)+parseInt(_0x213ee2(0x1bc))/0x7*(-parseInt(_0x213ee2(0x1b2))/0x8)+-parseInt(_0x213ee2(0x1c2))/0x9+parseInt(_0x213ee2(0x1b1))/0xa;if(_0x348dbe===_0x2cdc45)break;else _0x1d9f2e['push'](_0x1d9f2e['shift']());}catch(_0x5b50ee){_0x1d9f2e['push'](_0x1d9f2e['shift']());}}}(a242_0x2384,0x6b3b2));const a242_0x128bbd=(function(){let _0x439852=!![];return function(_0x191f21,_0x28570c){const _0x2b253c=_0x439852?function(){const _0x17808b=a242_0x1f5f;if(_0x28570c){const _0x16bf29=_0x28570c[_0x17808b(0x1ab)](_0x191f21,arguments);return _0x28570c=null,_0x16bf29;}}:function(){};return _0x439852=![],_0x2b253c;};}()),a242_0x3fec9d=a242_0x128bbd(this,function(){const _0x29b26f=a242_0x1f5f;return a242_0x3fec9d[_0x29b26f(0x1b4)]()[_0x29b26f(0x1a1)](_0x29b26f(0x1b5))['toString']()[_0x29b26f(0x1c5)](a242_0x3fec9d)[_0x29b26f(0x1a1)](_0x29b26f(0x1b5));});a242_0x3fec9d();'use strict';var __importDefault=this&&this[a242_0x5c0cbb(0x1a7)]||function(_0x116e83){const _0x2caffd=a242_0x5c0cbb;return _0x116e83&&_0x116e83[_0x2caffd(0x1b6)]?_0x116e83:{'default':_0x116e83};};Object[a242_0x5c0cbb(0x196)](exports,a242_0x5c0cbb(0x1b6),{'value':!![]}),exports[a242_0x5c0cbb(0x1c8)]=void 0x0;function a242_0x1f5f(_0x30b4db,_0x51ffd3){const _0x178e1c=a242_0x2384();return a242_0x1f5f=function(_0x3fec9d,_0x128bbd){_0x3fec9d=_0x3fec9d-0x195;let _0x23845e=_0x178e1c[_0x3fec9d];return _0x23845e;},a242_0x1f5f(_0x30b4db,_0x51ffd3);}const core_1=require(a242_0x5c0cbb(0x1c7)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a242_0x5c0cbb(0x1c0)),queries_1=require(a242_0x5c0cbb(0x1cc)),flosum_component_history_dto_1=require(a242_0x5c0cbb(0x199));class SalesforceRetrieverService{constructor(_0x3c6019){const _0x46e472=a242_0x5c0cbb;this[_0x46e472(0x1b3)]=_0x3c6019,this[_0x46e472(0x1b0)]=new core_1[(_0x46e472(0x1a5))](SalesforceRetrieverService[_0x46e472(0x1c1)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x46e472(0x1b9)]=0x1f4;}async[a242_0x5c0cbb(0x1c4)](_0x22e3ed){const _0x3f3bb0=a242_0x5c0cbb;this['logger'][_0x3f3bb0(0x1bd)](_0x3f3bb0(0x1c6),_0x22e3ed['length']);const _0x268aef=typedi_1['default'][_0x3f3bb0(0x198)](salesforce_query_service_1[_0x3f3bb0(0x1c3)]),_0x9ab747=_0x22e3ed['map'](_0x174910=>'\x27'+_0x174910+'\x27'),_0x9d3941=[];while(_0x9ab747[_0x3f3bb0(0x1be)]){const _0x50aa2=_0x9ab747['splice'](0x0,this[_0x3f3bb0(0x1b9)]),_0x37fdd2=_0x268aef[_0x3f3bb0(0x19a)](queries_1[_0x3f3bb0(0x1b8)]['replace'](_0x3f3bb0(0x1af),_0x50aa2[_0x3f3bb0(0x1cb)]())),_0x43bced=_0x268aef[_0x3f3bb0(0x19a)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x3f3bb0(0x19d)]('%ids%',_0x50aa2[_0x3f3bb0(0x1cb)]()))[_0x3f3bb0(0x1a4)](_0x41ae84=>_0x41ae84[_0x3f3bb0(0x1bf)](_0x1fb352=>flosum_component_history_dto_1['FlosumComponentHistoryDto']['fromSalesforce'](_0x1fb352))),[_0x234f6d,_0x60cda4]=await Promise[_0x3f3bb0(0x19f)]([_0x37fdd2,_0x43bced]);for(const _0x2c461d of _0x60cda4){const _0x5b5f31=_0x234f6d[_0x3f3bb0(0x1ba)](_0x566d20=>_0x566d20['ParentId']===_0x2c461d['id']);_0x5b5f31&&_0x9d3941[_0x3f3bb0(0x1c9)]({'fileType':_0x5b5f31['Name'],'fileName':_0x2c461d['filename'],'attachmentId':_0x5b5f31['Id']});}}return _0x9d3941;}async[a242_0x5c0cbb(0x1ae)](_0x2e81e0){const _0x1a3fdb=a242_0x5c0cbb,_0x37b830=await this[_0x1a3fdb(0x1c4)](_0x2e81e0);this[_0x1a3fdb(0x1b0)][_0x1a3fdb(0x1bd)](_0x1a3fdb(0x1ca));const _0xcb1827=[];for(const _0x252956 of _0x37b830){const _0x5034d5=await this[_0x1a3fdb(0x1b3)][_0x1a3fdb(0x195)](_0x252956[_0x1a3fdb(0x1bb)],!![]);_0xcb1827['push']({'body':_0x5034d5[_0x1a3fdb(0x1b4)]('base64'),'fileName':_0x252956[_0x1a3fdb(0x1ac)],'fileType':_0x252956[_0x1a3fdb(0x1a3)]}),this[_0x1a3fdb(0x1b0)]['info'](_0x1a3fdb(0x1a2),_0xcb1827[_0x1a3fdb(0x1be)],_0x2e81e0[_0x1a3fdb(0x1be)]);}return _0xcb1827;}async[a242_0x5c0cbb(0x19c)](_0x5024cf){const _0xcb1e85=a242_0x5c0cbb,_0x193cdf=[..._0x5024cf],_0x4cefc9=[],_0x1d938d=[];while(_0x193cdf[_0xcb1e85(0x1be)]){const _0x261a5a=_0x193cdf[_0xcb1e85(0x1ad)](0x0,this[_0xcb1e85(0x197)]),_0x4eec9a=await this[_0xcb1e85(0x1b3)]['retrieveComponents'](_0x261a5a);_0x261a5a[_0xcb1e85(0x1be)]!==_0x4eec9a[_0xcb1e85(0x1cd)][_0xcb1e85(0x1be)]?(_0x193cdf['push'](..._0x4eec9a[_0xcb1e85(0x1cd)]),_0x4cefc9[_0xcb1e85(0x1c9)](..._0x4eec9a[_0xcb1e85(0x19b)])):_0x1d938d[_0xcb1e85(0x1c9)](..._0x261a5a),this[_0xcb1e85(0x1b0)][_0xcb1e85(0x1a6)](_0xcb1e85(0x1b7),_0x5024cf[_0xcb1e85(0x1be)]-_0x193cdf['length'],_0x5024cf[_0xcb1e85(0x1be)]);}if(_0x1d938d[_0xcb1e85(0x1be)]){const _0x53a561=await this[_0xcb1e85(0x1ae)](_0x1d938d);_0x4cefc9[_0xcb1e85(0x1c9)](..._0x53a561);}return _0x4cefc9;}}function a242_0x2384(){const _0x2f489e=['search','manually\x20retrieved\x20%d/%d\x20components','fileType','then','Logger','log','__importDefault','172589mKzsPo','638880KgqdME','3526vOtANF','apply','fileName','splice','retrieveLastComponents','%parent_ids%','logger','5369540BHkGYn','8HZZfDl','salesforceService','toString','(((.+)+)+)+$','__esModule','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','COMPONENTS_PER_QUERY','find','attachmentId','2717813oUxXSP','info','length','map','./salesforce-query.service','name','1963440AMVCjA','SalesforceQueryService','retrieveComponentIdsFromHistoryIds','constructor','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','../../../../core','SalesforceRetrieverService','push','manually\x20retrieving\x20components\x20from\x20salesforce','join','../queries','ids','219FZkrGn','retrieveAttachment','defineProperty','COMPONENTS_PER_REQUEST','get','../dto/flosum-component-history.dto','query','components','run','replace','1249026rvMTCB','all','15qEUtUY'];a242_0x2384=function(){return _0x2f489e;};return a242_0x2384();}exports[a242_0x5c0cbb(0x1c8)]=SalesforceRetrieverService;