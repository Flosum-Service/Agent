const a268_0x5c8aac=a268_0x1b49;function a268_0x1b49(_0x1504af,_0x3bab26){const _0x3e4b84=a268_0x314d();return a268_0x1b49=function(_0x3e64d0,_0x2c7f21){_0x3e64d0=_0x3e64d0-0x131;let _0x314dbc=_0x3e4b84[_0x3e64d0];return _0x314dbc;},a268_0x1b49(_0x1504af,_0x3bab26);}(function(_0x22581c,_0x4e6c0d){const _0x464aff=a268_0x1b49,_0x1d83e7=_0x22581c();while(!![]){try{const _0x3b9e07=parseInt(_0x464aff(0x145))/0x1+parseInt(_0x464aff(0x13a))/0x2+-parseInt(_0x464aff(0x156))/0x3+-parseInt(_0x464aff(0x137))/0x4+parseInt(_0x464aff(0x15e))/0x5*(parseInt(_0x464aff(0x168))/0x6)+parseInt(_0x464aff(0x152))/0x7*(-parseInt(_0x464aff(0x14d))/0x8)+-parseInt(_0x464aff(0x135))/0x9;if(_0x3b9e07===_0x4e6c0d)break;else _0x1d83e7['push'](_0x1d83e7['shift']());}catch(_0x16420e){_0x1d83e7['push'](_0x1d83e7['shift']());}}}(a268_0x314d,0xe223e));const a268_0x2c7f21=(function(){let _0x2a4cb3=!![];return function(_0x5d1592,_0x16a996){const _0xc895f3=_0x2a4cb3?function(){const _0x501167=a268_0x1b49;if(_0x16a996){const _0x5dfab9=_0x16a996[_0x501167(0x157)](_0x5d1592,arguments);return _0x16a996=null,_0x5dfab9;}}:function(){};return _0x2a4cb3=![],_0xc895f3;};}()),a268_0x3e64d0=a268_0x2c7f21(this,function(){const _0x641076=a268_0x1b49;return a268_0x3e64d0['toString']()[_0x641076(0x163)](_0x641076(0x142))[_0x641076(0x13b)]()[_0x641076(0x16c)](a268_0x3e64d0)[_0x641076(0x163)](_0x641076(0x142));});a268_0x3e64d0();function a268_0x314d(){const _0x54a141=['all','Manually\x20retrieved\x20%d/%d\x20components','1351IGIqsq','map','ParentId','name','2229384TljfWa','apply','ids','Name','get','replace','COMPONENTS_PER_REQUEST','then','5gvpCxm','default','splice','length','find','search','Logger','logger','retrieveComponentIdsFromHistoryIds','run','10107096XbgMwG','push','info','defineProperty','constructor','attachmentId','components','salesforceService','retrieveComponents','__esModule','10747611rSmFzS','%ids%','3053192luOxcz','retrieveLastComponents','log','3000602ZxmpNN','toString','./salesforce-query.service','COMPONENTS_PER_QUERY','SalesforceQueryService','../dto/flosum-component-history.dto','SalesforceRetrieverService','../../../../core','(((.+)+)+)+$','fromSalesforce','join','530645wEljyM','fileType','typedi','__importDefault','../queries','query','GET_COMPONENT_HISTORIES_BY_IDS','fileName','3672pxbnAB','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','Manually\x20retrieving\x20components\x20from\x20salesforce'];a268_0x314d=function(){return _0x54a141;};return a268_0x314d();}'use strict';var __importDefault=this&&this[a268_0x5c8aac(0x148)]||function(_0x17c0a6){const _0x5800d7=a268_0x5c8aac;return _0x17c0a6&&_0x17c0a6[_0x5800d7(0x134)]?_0x17c0a6:{'default':_0x17c0a6};};Object[a268_0x5c8aac(0x16b)](exports,a268_0x5c8aac(0x134),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a268_0x5c8aac(0x141)),typedi_1=__importDefault(require(a268_0x5c8aac(0x147))),salesforce_query_service_1=require(a268_0x5c8aac(0x13c)),queries_1=require(a268_0x5c8aac(0x149)),flosum_component_history_dto_1=require(a268_0x5c8aac(0x13f));class SalesforceRetrieverService{constructor(_0x399467){const _0x5aadd1=a268_0x5c8aac;this[_0x5aadd1(0x132)]=_0x399467,this[_0x5aadd1(0x165)]=new core_1[(_0x5aadd1(0x164))](SalesforceRetrieverService[_0x5aadd1(0x155)]),this[_0x5aadd1(0x15c)]=0xbb8,this[_0x5aadd1(0x13d)]=0x1f4;}async[a268_0x5c8aac(0x166)](_0x2df1ec){const _0xeb1012=a268_0x5c8aac;this[_0xeb1012(0x165)]['info'](_0xeb1012(0x14e),_0x2df1ec[_0xeb1012(0x161)]);const _0x2d3df6=typedi_1[_0xeb1012(0x15f)][_0xeb1012(0x15a)](salesforce_query_service_1[_0xeb1012(0x13e)]),_0x21163d=_0x2df1ec[_0xeb1012(0x153)](_0x4389d0=>'\x27'+_0x4389d0+'\x27'),_0x566a28=[];while(_0x21163d['length']){const _0x1e2129=_0x21163d[_0xeb1012(0x160)](0x0,this['COMPONENTS_PER_QUERY']),_0x3e422e=_0x2d3df6[_0xeb1012(0x14a)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0xeb1012(0x15b)]('%parent_ids%',_0x1e2129['join']())),_0x5e34e0=_0x2d3df6[_0xeb1012(0x14a)](queries_1[_0xeb1012(0x14b)][_0xeb1012(0x15b)](_0xeb1012(0x136),_0x1e2129[_0xeb1012(0x144)]()))[_0xeb1012(0x15d)](_0x429516=>_0x429516[_0xeb1012(0x153)](_0x504a28=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0xeb1012(0x143)](_0x504a28))),[_0x579e65,_0x12db3f]=await Promise[_0xeb1012(0x150)]([_0x3e422e,_0x5e34e0]);for(const _0x5ede50 of _0x12db3f){const _0x75f371=_0x579e65[_0xeb1012(0x162)](_0x400ff7=>_0x400ff7[_0xeb1012(0x154)]===_0x5ede50['id']);_0x75f371&&_0x566a28[_0xeb1012(0x169)]({'fileType':_0x75f371[_0xeb1012(0x159)],'fileName':_0x5ede50['filename'],'attachmentId':_0x75f371['Id']});}}return _0x566a28;}async[a268_0x5c8aac(0x138)](_0x42038b){const _0x535dd0=a268_0x5c8aac,_0x59f149=await this['retrieveComponentIdsFromHistoryIds'](_0x42038b);this['logger'][_0x535dd0(0x16a)](_0x535dd0(0x14f));const _0x4cf6a3=[];for(const _0x39d06c of _0x59f149){const _0x43e651=await this[_0x535dd0(0x132)]['retrieveAttachment'](_0x39d06c[_0x535dd0(0x16d)],!![]);_0x4cf6a3[_0x535dd0(0x169)]({'body':_0x43e651[_0x535dd0(0x13b)]('base64'),'fileName':_0x39d06c[_0x535dd0(0x14c)],'fileType':_0x39d06c[_0x535dd0(0x146)]}),this[_0x535dd0(0x165)][_0x535dd0(0x16a)](_0x535dd0(0x151),_0x4cf6a3[_0x535dd0(0x161)],_0x42038b[_0x535dd0(0x161)]);}return _0x4cf6a3;}async[a268_0x5c8aac(0x167)](_0x4ed72f){const _0x54979a=a268_0x5c8aac,_0x14b39f=[..._0x4ed72f],_0x343a01=[],_0x53b897=[];while(_0x14b39f[_0x54979a(0x161)]){const _0x5a23c4=_0x14b39f['splice'](0x0,this[_0x54979a(0x15c)]),_0x5d0387=await this[_0x54979a(0x132)][_0x54979a(0x133)](_0x5a23c4);_0x5a23c4['length']!==_0x5d0387[_0x54979a(0x158)][_0x54979a(0x161)]?(_0x14b39f[_0x54979a(0x169)](..._0x5d0387[_0x54979a(0x158)]),_0x343a01[_0x54979a(0x169)](..._0x5d0387[_0x54979a(0x131)])):_0x53b897['push'](..._0x5a23c4),this[_0x54979a(0x165)][_0x54979a(0x139)]('Retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x4ed72f[_0x54979a(0x161)]-_0x14b39f[_0x54979a(0x161)],_0x4ed72f['length']);}if(_0x53b897[_0x54979a(0x161)]){const _0x248ef6=await this[_0x54979a(0x138)](_0x53b897);_0x343a01[_0x54979a(0x169)](..._0x248ef6);}return _0x343a01;}}exports[a268_0x5c8aac(0x140)]=SalesforceRetrieverService;