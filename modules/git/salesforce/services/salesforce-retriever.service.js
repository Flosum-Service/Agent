const a281_0x38565b=a281_0x1560;(function(_0x32225c,_0x4bff7a){const _0x5a2f87=a281_0x1560,_0x192c40=_0x32225c();while(!![]){try{const _0x35ed9e=parseInt(_0x5a2f87(0xd3))/0x1+parseInt(_0x5a2f87(0xbc))/0x2+parseInt(_0x5a2f87(0xcb))/0x3+-parseInt(_0x5a2f87(0xc1))/0x4+-parseInt(_0x5a2f87(0xc7))/0x5+-parseInt(_0x5a2f87(0xcd))/0x6*(-parseInt(_0x5a2f87(0xad))/0x7)+-parseInt(_0x5a2f87(0xc0))/0x8;if(_0x35ed9e===_0x4bff7a)break;else _0x192c40['push'](_0x192c40['shift']());}catch(_0x39915b){_0x192c40['push'](_0x192c40['shift']());}}}(a281_0x24ca,0xc1dd5));const a281_0x44f08c=(function(){let _0x8e2aba=!![];return function(_0x5a4f38,_0x16bb10){const _0x4a7bb3=_0x8e2aba?function(){const _0x402edf=a281_0x1560;if(_0x16bb10){const _0x44a20b=_0x16bb10[_0x402edf(0xb8)](_0x5a4f38,arguments);return _0x16bb10=null,_0x44a20b;}}:function(){};return _0x8e2aba=![],_0x4a7bb3;};}()),a281_0x46665e=a281_0x44f08c(this,function(){const _0x223997=a281_0x1560;return a281_0x46665e[_0x223997(0xd4)]()[_0x223997(0xd7)](_0x223997(0xca))[_0x223997(0xd4)]()[_0x223997(0xd1)](a281_0x46665e)[_0x223997(0xd7)]('(((.+)+)+)+$');});function a281_0x1560(_0x5ce7fe,_0x5838da){const _0xe6bcc8=a281_0x24ca();return a281_0x1560=function(_0x46665e,_0x44f08c){_0x46665e=_0x46665e-0xa6;let _0x24ca52=_0xe6bcc8[_0x46665e];return _0x24ca52;},a281_0x1560(_0x5ce7fe,_0x5838da);}a281_0x46665e();'use strict';function a281_0x24ca(){const _0x552bbe=['replace','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','(((.+)+)+)+$','4723758ewWdHv','filename','4253358ObDVWf','salesforceService','GET_COMPONENT_HISTORIES_BY_IDS','map','constructor','fileType','793831wfWgCh','toString','all','../dto/flosum-component-history.dto','search','defineProperty','query','push','../../../../core','COMPONENTS_PER_QUERY','__importDefault','find','COMPONENTS_PER_REQUEST','7DzCueQ','retrieveComponentIdsFromHistoryIds','fromSalesforce','retrieveAttachment','get','length','name','SalesforceRetrieverService','logger','Logger','Manually\x20retrieving\x20components\x20from\x20salesforce','apply','Name','then','default','2397984OQdvBL','Manually\x20retrieved\x20%d/%d\x20components','info','retrieveLastComponents','15410344XnPjuZ','472240VbmLqM','ParentId','retrieveComponents','__esModule','fileName','join','7189400cdGZPE'];a281_0x24ca=function(){return _0x552bbe;};return a281_0x24ca();}var __importDefault=this&&this[a281_0x38565b(0xaa)]||function(_0x289631){const _0x159239=a281_0x38565b;return _0x289631&&_0x289631[_0x159239(0xc4)]?_0x289631:{'default':_0x289631};};Object[a281_0x38565b(0xd8)](exports,a281_0x38565b(0xc4),{'value':!![]}),exports[a281_0x38565b(0xb4)]=void 0x0;const core_1=require(a281_0x38565b(0xa8)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require('../queries'),flosum_component_history_dto_1=require(a281_0x38565b(0xd6));class SalesforceRetrieverService{constructor(_0x453467){const _0x118391=a281_0x38565b;this[_0x118391(0xce)]=_0x453467,this['logger']=new core_1[(_0x118391(0xb6))](SalesforceRetrieverService[_0x118391(0xb3)]),this[_0x118391(0xac)]=0xbb8,this[_0x118391(0xa9)]=0x1f4;}async[a281_0x38565b(0xae)](_0x46e786){const _0x314fe2=a281_0x38565b;this[_0x314fe2(0xb5)][_0x314fe2(0xbe)]('Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)',_0x46e786[_0x314fe2(0xb2)]);const _0x467676=typedi_1[_0x314fe2(0xbb)][_0x314fe2(0xb1)](salesforce_query_service_1['SalesforceQueryService']),_0x46d498=_0x46e786[_0x314fe2(0xd0)](_0x9afacb=>'\x27'+_0x9afacb+'\x27'),_0x23efcd=[];while(_0x46d498['length']){const _0xb0c8fa=_0x46d498['splice'](0x0,this[_0x314fe2(0xa9)]),_0x359407=_0x467676[_0x314fe2(0xa6)](queries_1[_0x314fe2(0xc9)][_0x314fe2(0xc8)]('%parent_ids%',_0xb0c8fa[_0x314fe2(0xc6)]())),_0x887d8b=_0x467676['query'](queries_1[_0x314fe2(0xcf)][_0x314fe2(0xc8)]('%ids%',_0xb0c8fa['join']()))[_0x314fe2(0xba)](_0x1de36d=>_0x1de36d['map'](_0x3ad77e=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0x314fe2(0xaf)](_0x3ad77e))),[_0x186e1d,_0x117fd4]=await Promise[_0x314fe2(0xd5)]([_0x359407,_0x887d8b]);for(const _0x446067 of _0x117fd4){const _0x40e533=_0x186e1d[_0x314fe2(0xab)](_0x5d0467=>_0x5d0467[_0x314fe2(0xc2)]===_0x446067['id']);_0x40e533&&_0x23efcd['push']({'fileType':_0x40e533[_0x314fe2(0xb9)],'fileName':_0x446067[_0x314fe2(0xcc)],'attachmentId':_0x40e533['Id']});}}return _0x23efcd;}async[a281_0x38565b(0xbf)](_0x5e0078){const _0x53b4e6=a281_0x38565b,_0x420ef3=await this[_0x53b4e6(0xae)](_0x5e0078);this[_0x53b4e6(0xb5)][_0x53b4e6(0xbe)](_0x53b4e6(0xb7));const _0x3b3437=[];for(const _0x8eb15 of _0x420ef3){const _0x5a2712=await this['salesforceService'][_0x53b4e6(0xb0)](_0x8eb15['attachmentId'],!![]);_0x3b3437[_0x53b4e6(0xa7)]({'body':_0x5a2712['toString']('base64'),'fileName':_0x8eb15[_0x53b4e6(0xc5)],'fileType':_0x8eb15[_0x53b4e6(0xd2)]}),this['logger'][_0x53b4e6(0xbe)](_0x53b4e6(0xbd),_0x3b3437[_0x53b4e6(0xb2)],_0x5e0078[_0x53b4e6(0xb2)]);}return _0x3b3437;}async['run'](_0x4fa300){const _0x335e5b=a281_0x38565b;if(!_0x4fa300['length'])return[];const _0x1032df=await this['salesforceService'][_0x335e5b(0xc3)](_0x4fa300);return _0x1032df;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;