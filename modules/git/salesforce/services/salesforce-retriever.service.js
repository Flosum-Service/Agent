const a242_0x1bb6d6=a242_0x1157;(function(_0x25dd9a,_0x4bac7e){const _0x431060=a242_0x1157,_0xf1f95c=_0x25dd9a();while(!![]){try{const _0x3f4e1d=parseInt(_0x431060(0x13b))/0x1*(-parseInt(_0x431060(0x157))/0x2)+parseInt(_0x431060(0x162))/0x3*(parseInt(_0x431060(0x133))/0x4)+-parseInt(_0x431060(0x132))/0x5*(-parseInt(_0x431060(0x141))/0x6)+parseInt(_0x431060(0x13e))/0x7*(-parseInt(_0x431060(0x161))/0x8)+parseInt(_0x431060(0x160))/0x9+-parseInt(_0x431060(0x158))/0xa+parseInt(_0x431060(0x14a))/0xb*(parseInt(_0x431060(0x137))/0xc);if(_0x3f4e1d===_0x4bac7e)break;else _0xf1f95c['push'](_0xf1f95c['shift']());}catch(_0x1a4e34){_0xf1f95c['push'](_0xf1f95c['shift']());}}}(a242_0x57fc,0x4f1a2));function a242_0x1157(_0x58e6b9,_0x434312){const _0x3f6006=a242_0x57fc();return a242_0x1157=function(_0x294007,_0x5053f2){_0x294007=_0x294007-0x12c;let _0x57fc7a=_0x3f6006[_0x294007];return _0x57fc7a;},a242_0x1157(_0x58e6b9,_0x434312);}const a242_0x5053f2=(function(){let _0x50c8d7=!![];return function(_0x321b52,_0x3aca5e){const _0x569b3c=_0x50c8d7?function(){if(_0x3aca5e){const _0x352fa6=_0x3aca5e['apply'](_0x321b52,arguments);return _0x3aca5e=null,_0x352fa6;}}:function(){};return _0x50c8d7=![],_0x569b3c;};}()),a242_0x294007=a242_0x5053f2(this,function(){const _0x3db4ef=a242_0x1157;return a242_0x294007[_0x3db4ef(0x148)]()[_0x3db4ef(0x130)]('(((.+)+)+)+$')[_0x3db4ef(0x148)]()['constructor'](a242_0x294007)['search'](_0x3db4ef(0x12d));});a242_0x294007();function a242_0x57fc(){const _0x2d44a2=['%parent_ids%','join','4456613okFztp','replace','fileType','6MMWyLu','ids','map','query','typedi','logger','retrieveComponentIdsFromHistoryIds','toString','../../../../core','1507xEQodb','splice','length','manually\x20retrieved\x20%d/%d\x20components','../queries','SalesforceRetrieverService','./salesforce-query.service','COMPONENTS_PER_REQUEST','retrieveComponents','salesforceService','fileName','manually\x20retrieving\x20components\x20from\x20salesforce','push','130692djFYME','4297740wsWbvB','name','Name','ParentId','log','../dto/flosum-component-history.dto','__importDefault','COMPONENTS_PER_QUERY','118773YdQsyT','8dqOsDd','4362VIWCOo','default','components','retrieveLastComponents','filename','info','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','(((.+)+)+)+$','defineProperty','%ids%','search','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','1097515oyjeYk','1576tEWVfx','get','Logger','find','62676MZvAYR','run','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','__esModule','2dYDTlK'];a242_0x57fc=function(){return _0x2d44a2;};return a242_0x57fc();}'use strict';var __importDefault=this&&this[a242_0x1bb6d6(0x15e)]||function(_0x46e67f){const _0x36becb=a242_0x1bb6d6;return _0x46e67f&&_0x46e67f[_0x36becb(0x13a)]?_0x46e67f:{'default':_0x46e67f};};Object[a242_0x1bb6d6(0x12e)](exports,'__esModule',{'value':!![]}),exports[a242_0x1bb6d6(0x14f)]=void 0x0;const core_1=require(a242_0x1bb6d6(0x149)),typedi_1=__importDefault(require(a242_0x1bb6d6(0x145))),salesforce_query_service_1=require(a242_0x1bb6d6(0x150)),queries_1=require(a242_0x1bb6d6(0x14e)),flosum_component_history_dto_1=require(a242_0x1bb6d6(0x15d));class SalesforceRetrieverService{constructor(_0x4b4861){const _0x6e0484=a242_0x1bb6d6;this[_0x6e0484(0x153)]=_0x4b4861,this[_0x6e0484(0x146)]=new core_1[(_0x6e0484(0x135))](SalesforceRetrieverService[_0x6e0484(0x159)]),this[_0x6e0484(0x151)]=0xbb8,this[_0x6e0484(0x15f)]=0x1f4;}async[a242_0x1bb6d6(0x147)](_0x1477e9){const _0x2e1500=a242_0x1bb6d6;this['logger']['info'](_0x2e1500(0x131),_0x1477e9[_0x2e1500(0x14c)]);const _0x2e426e=typedi_1[_0x2e1500(0x163)][_0x2e1500(0x134)](salesforce_query_service_1['SalesforceQueryService']),_0x13bf1c=_0x1477e9[_0x2e1500(0x143)](_0x237a1f=>'\x27'+_0x237a1f+'\x27'),_0x3c522a=[];while(_0x13bf1c['length']){const _0xcf62cc=_0x13bf1c[_0x2e1500(0x14b)](0x0,this[_0x2e1500(0x15f)]),_0x15f1e2=_0x2e426e[_0x2e1500(0x144)](queries_1[_0x2e1500(0x12c)][_0x2e1500(0x13f)](_0x2e1500(0x13c),_0xcf62cc[_0x2e1500(0x13d)]())),_0x3435f4=_0x2e426e['query'](queries_1['GET_COMPONENT_HISTORIES_BY_IDS']['replace'](_0x2e1500(0x12f),_0xcf62cc['join']()))['then'](_0x49bb48=>_0x49bb48[_0x2e1500(0x143)](_0x435a21=>flosum_component_history_dto_1['FlosumComponentHistoryDto']['fromSalesforce'](_0x435a21))),[_0x29de82,_0x17bbcf]=await Promise['all']([_0x15f1e2,_0x3435f4]);for(const _0x545628 of _0x17bbcf){const _0x29a376=_0x29de82[_0x2e1500(0x136)](_0xd76b32=>_0xd76b32[_0x2e1500(0x15b)]===_0x545628['id']);_0x29a376&&_0x3c522a[_0x2e1500(0x156)]({'fileType':_0x29a376[_0x2e1500(0x15a)],'fileName':_0x545628[_0x2e1500(0x166)],'attachmentId':_0x29a376['Id']});}}return _0x3c522a;}async[a242_0x1bb6d6(0x165)](_0x1ea22c){const _0x1296b4=a242_0x1bb6d6,_0x39b6b7=await this['retrieveComponentIdsFromHistoryIds'](_0x1ea22c);this['logger']['info'](_0x1296b4(0x155));const _0x12e07e=[];for(const _0x2eb4f7 of _0x39b6b7){const _0x29d0cc=await this[_0x1296b4(0x153)]['retrieveAttachment'](_0x2eb4f7['attachmentId'],!![]);_0x12e07e[_0x1296b4(0x156)]({'body':_0x29d0cc[_0x1296b4(0x148)]('base64'),'fileName':_0x2eb4f7[_0x1296b4(0x154)],'fileType':_0x2eb4f7[_0x1296b4(0x140)]}),this[_0x1296b4(0x146)][_0x1296b4(0x167)](_0x1296b4(0x14d),_0x12e07e[_0x1296b4(0x14c)],_0x1ea22c[_0x1296b4(0x14c)]);}return _0x12e07e;}async[a242_0x1bb6d6(0x138)](_0x2ee9dc){const _0x10b9a0=a242_0x1bb6d6,_0xaf61cd=[..._0x2ee9dc],_0x33c622=[],_0xd4b22f=[];while(_0xaf61cd[_0x10b9a0(0x14c)]){const _0x2f208d=_0xaf61cd[_0x10b9a0(0x14b)](0x0,this[_0x10b9a0(0x151)]),_0x14f42b=await this['salesforceService'][_0x10b9a0(0x152)](_0x2f208d);_0x2f208d['length']!==_0x14f42b[_0x10b9a0(0x142)]['length']?(_0xaf61cd[_0x10b9a0(0x156)](..._0x14f42b['ids']),_0x33c622['push'](..._0x14f42b[_0x10b9a0(0x164)])):_0xd4b22f[_0x10b9a0(0x156)](..._0x2f208d),this['logger'][_0x10b9a0(0x15c)](_0x10b9a0(0x139),_0x2ee9dc[_0x10b9a0(0x14c)]-_0xaf61cd[_0x10b9a0(0x14c)],_0x2ee9dc['length']);}if(_0xd4b22f[_0x10b9a0(0x14c)]){const _0x1988b5=await this[_0x10b9a0(0x165)](_0xd4b22f);_0x33c622['push'](..._0x1988b5);}return _0x33c622;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;