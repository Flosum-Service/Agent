const a242_0x25338d=a242_0x5638;(function(_0x4d82c6,_0x42bb5e){const _0x1d3d8f=a242_0x5638,_0x3cfecc=_0x4d82c6();while(!![]){try{const _0x57250b=parseInt(_0x1d3d8f(0x157))/0x1*(-parseInt(_0x1d3d8f(0x16a))/0x2)+parseInt(_0x1d3d8f(0x14c))/0x3+parseInt(_0x1d3d8f(0x169))/0x4+parseInt(_0x1d3d8f(0x172))/0x5+parseInt(_0x1d3d8f(0x14b))/0x6+-parseInt(_0x1d3d8f(0x16c))/0x7*(-parseInt(_0x1d3d8f(0x162))/0x8)+-parseInt(_0x1d3d8f(0x168))/0x9*(parseInt(_0x1d3d8f(0x155))/0xa);if(_0x57250b===_0x42bb5e)break;else _0x3cfecc['push'](_0x3cfecc['shift']());}catch(_0x386ebc){_0x3cfecc['push'](_0x3cfecc['shift']());}}}(a242_0xe88e,0xb1ca6));const a242_0x15342a=(function(){let _0xddf9ef=!![];return function(_0x108e03,_0x3441fa){const _0x53d3fd=_0xddf9ef?function(){const _0xcc6ea4=a242_0x5638;if(_0x3441fa){const _0x550bcc=_0x3441fa[_0xcc6ea4(0x173)](_0x108e03,arguments);return _0x3441fa=null,_0x550bcc;}}:function(){};return _0xddf9ef=![],_0x53d3fd;};}()),a242_0x2543bd=a242_0x15342a(this,function(){const _0x4b82c5=a242_0x5638;return a242_0x2543bd[_0x4b82c5(0x163)]()[_0x4b82c5(0x17e)](_0x4b82c5(0x174))[_0x4b82c5(0x163)]()['constructor'](a242_0x2543bd)[_0x4b82c5(0x17e)](_0x4b82c5(0x174));});a242_0x2543bd();'use strict';var __importDefault=this&&this[a242_0x25338d(0x14f)]||function(_0x43088d){const _0x5ceb3b=a242_0x25338d;return _0x43088d&&_0x43088d[_0x5ceb3b(0x179)]?_0x43088d:{'default':_0x43088d};};Object['defineProperty'](exports,a242_0x25338d(0x179),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;function a242_0xe88e(){const _0x21e812=['retrieveComponentIdsFromHistoryIds','fileType','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','search','FlosumComponentHistoryDto','Name','log','attachmentId','2288184AxtgKO','461652tZeSiY','run','COMPONENTS_PER_QUERY','__importDefault','../queries','GET_COMPONENT_HISTORIES_BY_IDS','%parent_ids%','COMPONENTS_PER_REQUEST','info','21990zfrosf','splice','733078tgMBsj','Logger','manually\x20retrieved\x20%d/%d\x20components','../dto/flosum-component-history.dto','length','map','get','join','push','retrieveLastComponents','query','1135072jytNAB','toString','retrieveComponents','ParentId','then','replace','3645SbkTpW','4638744FdxmjG','2rZqIPU','retrieveAttachment','7PKicrl','ids','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','../../../../core','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','salesforceService','2575425mdFHdB','apply','(((.+)+)+)+$','SalesforceRetrieverService','%ids%','base64','manually\x20retrieving\x20components\x20from\x20salesforce','__esModule','logger'];a242_0xe88e=function(){return _0x21e812;};return a242_0xe88e();}const core_1=require(a242_0x25338d(0x16f)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a242_0x25338d(0x150)),flosum_component_history_dto_1=require(a242_0x25338d(0x15a));class SalesforceRetrieverService{constructor(_0x52ef41){const _0x4d8fa4=a242_0x25338d;this[_0x4d8fa4(0x171)]=_0x52ef41,this[_0x4d8fa4(0x17a)]=new core_1[(_0x4d8fa4(0x158))](SalesforceRetrieverService['name']),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x4d8fa4(0x14e)]=0x1f4;}async[a242_0x25338d(0x17b)](_0x130a6a){const _0x301746=a242_0x25338d;this['logger'][_0x301746(0x154)](_0x301746(0x17d),_0x130a6a['length']);const _0x5a11af=typedi_1['default'][_0x301746(0x15d)](salesforce_query_service_1['SalesforceQueryService']),_0x5dbe19=_0x130a6a['map'](_0x5173d7=>'\x27'+_0x5173d7+'\x27'),_0x59accb=[];while(_0x5dbe19[_0x301746(0x15b)]){const _0x498e7e=_0x5dbe19[_0x301746(0x156)](0x0,this['COMPONENTS_PER_QUERY']),_0x424eae=_0x5a11af['query'](queries_1[_0x301746(0x16e)][_0x301746(0x167)](_0x301746(0x152),_0x498e7e['join']())),_0x34382f=_0x5a11af[_0x301746(0x161)](queries_1[_0x301746(0x151)][_0x301746(0x167)](_0x301746(0x176),_0x498e7e[_0x301746(0x15e)]()))[_0x301746(0x166)](_0x2466f0=>_0x2466f0[_0x301746(0x15c)](_0x5aaf42=>flosum_component_history_dto_1[_0x301746(0x147)]['fromSalesforce'](_0x5aaf42))),[_0x263c61,_0x558c02]=await Promise['all']([_0x424eae,_0x34382f]);for(const _0x37f95c of _0x558c02){const _0x533ad8=_0x263c61['find'](_0x4f14fd=>_0x4f14fd[_0x301746(0x165)]===_0x37f95c['id']);_0x533ad8&&_0x59accb[_0x301746(0x15f)]({'fileType':_0x533ad8[_0x301746(0x148)],'fileName':_0x37f95c['filename'],'attachmentId':_0x533ad8['Id']});}}return _0x59accb;}async[a242_0x25338d(0x160)](_0x48583e){const _0x1fcc9a=a242_0x25338d,_0x392523=await this['retrieveComponentIdsFromHistoryIds'](_0x48583e);this[_0x1fcc9a(0x17a)][_0x1fcc9a(0x154)](_0x1fcc9a(0x178));const _0x37fa5e=[];for(const _0x350775 of _0x392523){const _0x275e77=await this[_0x1fcc9a(0x171)][_0x1fcc9a(0x16b)](_0x350775[_0x1fcc9a(0x14a)],!![]);_0x37fa5e['push']({'body':_0x275e77['toString'](_0x1fcc9a(0x177)),'fileName':_0x350775['fileName'],'fileType':_0x350775[_0x1fcc9a(0x17c)]}),this['logger'][_0x1fcc9a(0x154)](_0x1fcc9a(0x159),_0x37fa5e[_0x1fcc9a(0x15b)],_0x48583e[_0x1fcc9a(0x15b)]);}return _0x37fa5e;}async[a242_0x25338d(0x14d)](_0x47a213){const _0x52ead6=a242_0x25338d,_0x52d11b=[..._0x47a213],_0x1254c5=[],_0xb4c5b1=[];while(_0x52d11b[_0x52ead6(0x15b)]){const _0x112b72=_0x52d11b['splice'](0x0,this[_0x52ead6(0x153)]),_0x235048=await this[_0x52ead6(0x171)][_0x52ead6(0x164)](_0x112b72);_0x112b72[_0x52ead6(0x15b)]!==_0x235048[_0x52ead6(0x16d)][_0x52ead6(0x15b)]?(_0x52d11b[_0x52ead6(0x15f)](..._0x235048[_0x52ead6(0x16d)]),_0x1254c5[_0x52ead6(0x15f)](..._0x235048['components'])):_0xb4c5b1[_0x52ead6(0x15f)](..._0x112b72),this[_0x52ead6(0x17a)][_0x52ead6(0x149)](_0x52ead6(0x170),_0x47a213[_0x52ead6(0x15b)]-_0x52d11b[_0x52ead6(0x15b)],_0x47a213[_0x52ead6(0x15b)]);}if(_0xb4c5b1[_0x52ead6(0x15b)]){const _0x433d33=await this[_0x52ead6(0x160)](_0xb4c5b1);_0x1254c5[_0x52ead6(0x15f)](..._0x433d33);}return _0x1254c5;}}function a242_0x5638(_0x182d7d,_0x1f1e0f){const _0x5daed9=a242_0xe88e();return a242_0x5638=function(_0x2543bd,_0x15342a){_0x2543bd=_0x2543bd-0x147;let _0xe88e4f=_0x5daed9[_0x2543bd];return _0xe88e4f;},a242_0x5638(_0x182d7d,_0x1f1e0f);}exports[a242_0x25338d(0x175)]=SalesforceRetrieverService;