const a203_0x3ac250=a203_0x421d;(function(_0x568fea,_0x14984f){const _0x3222cc=a203_0x421d,_0x48c29f=_0x568fea();while(!![]){try{const _0x1795e1=parseInt(_0x3222cc(0x11d))/0x1+-parseInt(_0x3222cc(0x10f))/0x2+-parseInt(_0x3222cc(0x115))/0x3+-parseInt(_0x3222cc(0xf9))/0x4*(parseInt(_0x3222cc(0x102))/0x5)+parseInt(_0x3222cc(0xf8))/0x6*(parseInt(_0x3222cc(0x104))/0x7)+-parseInt(_0x3222cc(0x107))/0x8*(-parseInt(_0x3222cc(0x127))/0x9)+parseInt(_0x3222cc(0x12d))/0xa;if(_0x1795e1===_0x14984f)break;else _0x48c29f['push'](_0x48c29f['shift']());}catch(_0x124f50){_0x48c29f['push'](_0x48c29f['shift']());}}}(a203_0x561f,0x4b986));const a203_0x12f74e=(function(){let _0x3014dd=!![];return function(_0x15b5ad,_0x36c372){const _0x132e3d=_0x3014dd?function(){const _0x4899f8=a203_0x421d;if(_0x36c372){const _0x1e7866=_0x36c372[_0x4899f8(0x11a)](_0x15b5ad,arguments);return _0x36c372=null,_0x1e7866;}}:function(){};return _0x3014dd=![],_0x132e3d;};}()),a203_0xdf8d83=a203_0x12f74e(this,function(){const _0x5535cc=a203_0x421d;return a203_0xdf8d83[_0x5535cc(0x12c)]()[_0x5535cc(0x122)]('(((.+)+)+)+$')[_0x5535cc(0x12c)]()[_0x5535cc(0x108)](a203_0xdf8d83)[_0x5535cc(0x122)]('(((.+)+)+)+$');});a203_0xdf8d83();'use strict';var __importDefault=this&&this[a203_0x3ac250(0x112)]||function(_0x52b0be){const _0xd857c4=a203_0x3ac250;return _0x52b0be&&_0x52b0be[_0xd857c4(0x100)]?_0x52b0be:{'default':_0x52b0be};};function a203_0x421d(_0x569be1,_0x2bfcbb){const _0xfaeb8f=a203_0x561f();return a203_0x421d=function(_0xdf8d83,_0x12f74e){_0xdf8d83=_0xdf8d83-0xf8;let _0x561f93=_0xfaeb8f[_0xdf8d83];return _0x561f93;},a203_0x421d(_0x569be1,_0x2bfcbb);}Object['defineProperty'](exports,a203_0x3ac250(0x100),{'value':!![]}),exports[a203_0x3ac250(0x121)]=void 0x0;const core_1=require(a203_0x3ac250(0x10b)),typedi_1=__importDefault(require(a203_0x3ac250(0x10e))),salesforce_query_service_1=require(a203_0x3ac250(0xff)),queries_1=require(a203_0x3ac250(0x124)),flosum_component_history_dto_1=require(a203_0x3ac250(0xfc));class SalesforceRetrieverService{constructor(_0x1f1690){const _0x2b2cc3=a203_0x3ac250;this[_0x2b2cc3(0x103)]=_0x1f1690,this['logger']=new core_1['Logger'](SalesforceRetrieverService[_0x2b2cc3(0x12f)]),this[_0x2b2cc3(0x117)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async[a203_0x3ac250(0x10c)](_0x9f49a7){const _0x252542=a203_0x3ac250;this[_0x252542(0x12a)][_0x252542(0x130)](_0x252542(0x128),_0x9f49a7['length']);const _0x2cf011=typedi_1[_0x252542(0x125)][_0x252542(0x11c)](salesforce_query_service_1['SalesforceQueryService']),_0x555473=_0x9f49a7[_0x252542(0x131)](_0x4c55dc=>'\x27'+_0x4c55dc+'\x27'),_0xa7a221=[];while(_0x555473['length']){const _0x2284c2=_0x555473[_0x252542(0x118)](0x0,this[_0x252542(0x116)]),_0xc2dc01=_0x2cf011[_0x252542(0x12b)](queries_1[_0x252542(0x10d)][_0x252542(0x126)]('%parent_ids%',_0x2284c2[_0x252542(0x11f)]())),_0x32a962=_0x2cf011['query'](queries_1[_0x252542(0x105)]['replace'](_0x252542(0xfd),_0x2284c2[_0x252542(0x11f)]()))[_0x252542(0x109)](_0x42cc62=>_0x42cc62['map'](_0x2f330c=>flosum_component_history_dto_1[_0x252542(0x111)]['fromSalesforce'](_0x2f330c))),[_0xfb2153,_0x1ebc49]=await Promise['all']([_0xc2dc01,_0x32a962]);for(const _0x56fc70 of _0x1ebc49){const _0x291d5a=_0xfb2153['find'](_0x296938=>_0x296938[_0x252542(0x106)]===_0x56fc70['id']);_0x291d5a&&_0xa7a221['push']({'fileType':_0x291d5a['Name'],'fileName':_0x56fc70[_0x252542(0x11b)],'attachmentId':_0x291d5a['Id']});}}return _0xa7a221;}async[a203_0x3ac250(0xfa)](_0x3989c2){const _0x1a1df6=a203_0x3ac250,_0x5660b2=await this['retrieveComponentIdsFromHistoryIds'](_0x3989c2);this[_0x1a1df6(0x12a)]['info'](_0x1a1df6(0xfe));const _0x33e0da=[];for(const _0x5c0b07 of _0x5660b2){const _0x6d082c=await this['salesforceService'][_0x1a1df6(0x10a)](_0x5c0b07[_0x1a1df6(0xfb)],!![]);_0x33e0da[_0x1a1df6(0x114)]({'body':_0x6d082c['toString'](_0x1a1df6(0x120)),'fileName':_0x5c0b07[_0x1a1df6(0x119)],'fileType':_0x5c0b07[_0x1a1df6(0x113)]}),this['logger']['info'](_0x1a1df6(0x129),_0x33e0da['length'],_0x3989c2[_0x1a1df6(0x101)]);}return _0x33e0da;}async[a203_0x3ac250(0x12e)](_0x2d2916){const _0x1d1e01=a203_0x3ac250,_0x37b158=[..._0x2d2916],_0x585927=[],_0x416faf=[];while(_0x37b158[_0x1d1e01(0x101)]){const _0x518a47=_0x37b158[_0x1d1e01(0x118)](0x0,this[_0x1d1e01(0x117)]),_0x3e1642=await this[_0x1d1e01(0x103)]['retrieveComponents'](_0x518a47);_0x518a47[_0x1d1e01(0x101)]!==_0x3e1642[_0x1d1e01(0x11e)][_0x1d1e01(0x101)]?(_0x37b158[_0x1d1e01(0x114)](..._0x3e1642[_0x1d1e01(0x11e)]),_0x585927[_0x1d1e01(0x114)](..._0x3e1642[_0x1d1e01(0x123)])):_0x416faf[_0x1d1e01(0x114)](..._0x518a47),this[_0x1d1e01(0x12a)][_0x1d1e01(0x110)]('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x2d2916[_0x1d1e01(0x101)]-_0x37b158[_0x1d1e01(0x101)],_0x2d2916[_0x1d1e01(0x101)]);}if(_0x416faf['length']){const _0x51065a=await this[_0x1d1e01(0xfa)](_0x416faf);_0x585927[_0x1d1e01(0x114)](..._0x51065a);}return _0x585927;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;function a203_0x561f(){const _0x165bc3=['then','retrieveAttachment','../../../../core','retrieveComponentIdsFromHistoryIds','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','typedi','160092CTHJaB','log','FlosumComponentHistoryDto','__importDefault','fileType','push','177417aVyuzN','COMPONENTS_PER_QUERY','COMPONENTS_PER_REQUEST','splice','fileName','apply','filename','get','415367IKZpxE','ids','join','base64','SalesforceRetrieverService','search','components','../queries','default','replace','414ruuADQ','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','manually\x20retrieved\x20%d/%d\x20components','logger','query','toString','836720PEGlqJ','run','name','info','map','522TDbXVk','4vqbdQK','retrieveLastComponents','attachmentId','../dto/flosum-component-history.dto','%ids%','manually\x20retrieving\x20components\x20from\x20salesforce','./salesforce-query.service','__esModule','length','2301855XQYEUF','salesforceService','21483tiNsiK','GET_COMPONENT_HISTORIES_BY_IDS','ParentId','24896BxglIm','constructor'];a203_0x561f=function(){return _0x165bc3;};return a203_0x561f();}