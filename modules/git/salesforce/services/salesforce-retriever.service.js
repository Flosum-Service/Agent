function a242_0x6c06(_0x242383,_0x2d3fd2){const _0x39def5=a242_0x4ab4();return a242_0x6c06=function(_0x40fae,_0x59b6e4){_0x40fae=_0x40fae-0x1bf;let _0x4ab452=_0x39def5[_0x40fae];return _0x4ab452;},a242_0x6c06(_0x242383,_0x2d3fd2);}const a242_0x1bd2f2=a242_0x6c06;(function(_0x3a108a,_0x30f791){const _0x54be1f=a242_0x6c06,_0x22b692=_0x3a108a();while(!![]){try{const _0x44e3c4=parseInt(_0x54be1f(0x1cc))/0x1+-parseInt(_0x54be1f(0x1e7))/0x2*(-parseInt(_0x54be1f(0x1ed))/0x3)+parseInt(_0x54be1f(0x1d3))/0x4+-parseInt(_0x54be1f(0x1e6))/0x5+-parseInt(_0x54be1f(0x1c7))/0x6*(-parseInt(_0x54be1f(0x1d2))/0x7)+-parseInt(_0x54be1f(0x1e4))/0x8+parseInt(_0x54be1f(0x1db))/0x9;if(_0x44e3c4===_0x30f791)break;else _0x22b692['push'](_0x22b692['shift']());}catch(_0x3f04ff){_0x22b692['push'](_0x22b692['shift']());}}}(a242_0x4ab4,0x19d4c));const a242_0x59b6e4=(function(){let _0xefef46=!![];return function(_0x28fbb0,_0x54dc5a){const _0x156014=_0xefef46?function(){if(_0x54dc5a){const _0x2e93e4=_0x54dc5a['apply'](_0x28fbb0,arguments);return _0x54dc5a=null,_0x2e93e4;}}:function(){};return _0xefef46=![],_0x156014;};}()),a242_0x40fae=a242_0x59b6e4(this,function(){const _0xab8839=a242_0x6c06;return a242_0x40fae['toString']()[_0xab8839(0x1c3)](_0xab8839(0x1cf))['toString']()[_0xab8839(0x1f6)](a242_0x40fae)[_0xab8839(0x1c3)](_0xab8839(0x1cf));});a242_0x40fae();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1d4341){return _0x1d4341&&_0x1d4341['__esModule']?_0x1d4341:{'default':_0x1d4341};};Object[a242_0x1bd2f2(0x1d4)](exports,'__esModule',{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a242_0x1bd2f2(0x1ec)),typedi_1=__importDefault(require(a242_0x1bd2f2(0x1ce))),salesforce_query_service_1=require(a242_0x1bd2f2(0x1c0)),queries_1=require('../queries'),flosum_component_history_dto_1=require(a242_0x1bd2f2(0x1e2));function a242_0x4ab4(){const _0x5ef81b=['defineProperty','get','push','retrieveComponentIdsFromHistoryIds','base64','manually\x20retrieving\x20components\x20from\x20salesforce','fileName','280278pVFyUC','Logger','find','default','name','all','COMPONENTS_PER_QUERY','../dto/flosum-component-history.dto','fromSalesforce','906424EyLYrU','join','656620nBhOFY','202ndjuDM','%parent_ids%','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','SalesforceRetrieverService','Name','../../../../core','2898kkceyQ','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','filename','ids','manually\x20retrieved\x20%d/%d\x20components','logger','run','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','FlosumComponentHistoryDto','constructor','info','then','./salesforce-query.service','salesforceService','COMPONENTS_PER_REQUEST','search','replace','toString','retrieveComponents','66DuSbWJ','ParentId','map','length','GET_COMPONENT_HISTORIES_BY_IDS','205481BbUHBf','fileType','typedi','(((.+)+)+)+$','query','components','7371RCFywc','18636vsKsqV'];a242_0x4ab4=function(){return _0x5ef81b;};return a242_0x4ab4();}class SalesforceRetrieverService{constructor(_0x59a295){const _0x36fcbe=a242_0x1bd2f2;this[_0x36fcbe(0x1c1)]=_0x59a295,this['logger']=new core_1[(_0x36fcbe(0x1dc))](SalesforceRetrieverService[_0x36fcbe(0x1df)]),this[_0x36fcbe(0x1c2)]=0xbb8,this[_0x36fcbe(0x1e1)]=0x1f4;}async[a242_0x1bd2f2(0x1d7)](_0x3bf141){const _0x30a27d=a242_0x1bd2f2;this[_0x30a27d(0x1f2)][_0x30a27d(0x1f7)](_0x30a27d(0x1e9),_0x3bf141[_0x30a27d(0x1ca)]);const _0x1f06bf=typedi_1[_0x30a27d(0x1de)][_0x30a27d(0x1d5)](salesforce_query_service_1['SalesforceQueryService']),_0x2e76fb=_0x3bf141[_0x30a27d(0x1c9)](_0x4feba6=>'\x27'+_0x4feba6+'\x27'),_0x5adb10=[];while(_0x2e76fb[_0x30a27d(0x1ca)]){const _0x355397=_0x2e76fb['splice'](0x0,this[_0x30a27d(0x1e1)]),_0x1b7c75=_0x1f06bf[_0x30a27d(0x1d0)](queries_1[_0x30a27d(0x1ee)]['replace'](_0x30a27d(0x1e8),_0x355397[_0x30a27d(0x1e5)]())),_0xd0488f=_0x1f06bf[_0x30a27d(0x1d0)](queries_1[_0x30a27d(0x1cb)][_0x30a27d(0x1c4)]('%ids%',_0x355397['join']()))[_0x30a27d(0x1bf)](_0x2f8445=>_0x2f8445[_0x30a27d(0x1c9)](_0x2269c6=>flosum_component_history_dto_1[_0x30a27d(0x1f5)][_0x30a27d(0x1e3)](_0x2269c6))),[_0x461644,_0x25be75]=await Promise[_0x30a27d(0x1e0)]([_0x1b7c75,_0xd0488f]);for(const _0x3a4be1 of _0x25be75){const _0x2201f4=_0x461644[_0x30a27d(0x1dd)](_0xd4368=>_0xd4368[_0x30a27d(0x1c8)]===_0x3a4be1['id']);_0x2201f4&&_0x5adb10['push']({'fileType':_0x2201f4[_0x30a27d(0x1eb)],'fileName':_0x3a4be1[_0x30a27d(0x1ef)],'attachmentId':_0x2201f4['Id']});}}return _0x5adb10;}async['retrieveLastComponents'](_0x5177ef){const _0x45e98e=a242_0x1bd2f2,_0x4a3d38=await this[_0x45e98e(0x1d7)](_0x5177ef);this[_0x45e98e(0x1f2)]['info'](_0x45e98e(0x1d9));const _0x1ec874=[];for(const _0x2c8c5a of _0x4a3d38){const _0xb8e38b=await this[_0x45e98e(0x1c1)]['retrieveAttachment'](_0x2c8c5a['attachmentId'],!![]);_0x1ec874['push']({'body':_0xb8e38b[_0x45e98e(0x1c5)](_0x45e98e(0x1d8)),'fileName':_0x2c8c5a[_0x45e98e(0x1da)],'fileType':_0x2c8c5a[_0x45e98e(0x1cd)]}),this['logger'][_0x45e98e(0x1f7)](_0x45e98e(0x1f1),_0x1ec874[_0x45e98e(0x1ca)],_0x5177ef[_0x45e98e(0x1ca)]);}return _0x1ec874;}async[a242_0x1bd2f2(0x1f3)](_0x596203){const _0x148ece=a242_0x1bd2f2,_0x34c2c9=[..._0x596203],_0x5971b4=[],_0x3ee164=[];while(_0x34c2c9[_0x148ece(0x1ca)]){const _0xa8f067=_0x34c2c9['splice'](0x0,this['COMPONENTS_PER_REQUEST']),_0x382c7e=await this['salesforceService'][_0x148ece(0x1c6)](_0xa8f067);_0xa8f067['length']!==_0x382c7e[_0x148ece(0x1f0)][_0x148ece(0x1ca)]?(_0x34c2c9[_0x148ece(0x1d6)](..._0x382c7e[_0x148ece(0x1f0)]),_0x5971b4[_0x148ece(0x1d6)](..._0x382c7e[_0x148ece(0x1d1)])):_0x3ee164['push'](..._0xa8f067),this[_0x148ece(0x1f2)]['log'](_0x148ece(0x1f4),_0x596203['length']-_0x34c2c9[_0x148ece(0x1ca)],_0x596203['length']);}if(_0x3ee164[_0x148ece(0x1ca)]){const _0x38272e=await this['retrieveLastComponents'](_0x3ee164);_0x5971b4[_0x148ece(0x1d6)](..._0x38272e);}return _0x5971b4;}}exports[a242_0x1bd2f2(0x1ea)]=SalesforceRetrieverService;