const a203_0x24436d=a203_0x2e2e;function a203_0x2e2e(_0xb023ef,_0x1447cf){const _0x55e687=a203_0xd0a9();return a203_0x2e2e=function(_0x10442e,_0x1d0cd5){_0x10442e=_0x10442e-0xc1;let _0xd0a939=_0x55e687[_0x10442e];return _0xd0a939;},a203_0x2e2e(_0xb023ef,_0x1447cf);}(function(_0x49004c,_0x5e0acf){const _0x4d4000=a203_0x2e2e,_0xaaec4c=_0x49004c();while(!![]){try{const _0x90c4d7=parseInt(_0x4d4000(0xdd))/0x1+-parseInt(_0x4d4000(0xe2))/0x2*(-parseInt(_0x4d4000(0xd6))/0x3)+-parseInt(_0x4d4000(0xe8))/0x4*(-parseInt(_0x4d4000(0xcc))/0x5)+-parseInt(_0x4d4000(0xef))/0x6+-parseInt(_0x4d4000(0xce))/0x7*(-parseInt(_0x4d4000(0xcf))/0x8)+-parseInt(_0x4d4000(0xc9))/0x9+parseInt(_0x4d4000(0xdf))/0xa*(parseInt(_0x4d4000(0xd0))/0xb);if(_0x90c4d7===_0x5e0acf)break;else _0xaaec4c['push'](_0xaaec4c['shift']());}catch(_0x214e9a){_0xaaec4c['push'](_0xaaec4c['shift']());}}}(a203_0xd0a9,0x2dccc));const a203_0x1d0cd5=(function(){let _0x2e3a7c=!![];return function(_0x12196d,_0x1e1549){const _0x3f2376=_0x2e3a7c?function(){const _0xe7ded9=a203_0x2e2e;if(_0x1e1549){const _0x4eb1ad=_0x1e1549[_0xe7ded9(0xde)](_0x12196d,arguments);return _0x1e1549=null,_0x4eb1ad;}}:function(){};return _0x2e3a7c=![],_0x3f2376;};}()),a203_0x10442e=a203_0x1d0cd5(this,function(){const _0x4e2cf3=a203_0x2e2e;return a203_0x10442e[_0x4e2cf3(0xcd)]()[_0x4e2cf3(0xe6)](_0x4e2cf3(0xe7))[_0x4e2cf3(0xcd)]()['constructor'](a203_0x10442e)[_0x4e2cf3(0xe6)](_0x4e2cf3(0xe7));});a203_0x10442e();'use strict';var __importDefault=this&&this[a203_0x24436d(0xe5)]||function(_0x31f9ca){return _0x31f9ca&&_0x31f9ca['__esModule']?_0x31f9ca:{'default':_0x31f9ca};};function a203_0xd0a9(){const _0x5c4f0d=['12WDduAy','Logger','push','COMPONENTS_PER_REQUEST','replace','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','defineProperty','1409460YIlpZF','../../../../core','default','manually\x20retrieved\x20%d/%d\x20components','fileName','all','run','query','%parent_ids%','retrieveLastComponents','splice','manually\x20retrieving\x20components\x20from\x20salesforce','logger','GET_COMPONENT_HISTORIES_BY_IDS','ParentId','../queries','salesforceService','retrieveComponentIdsFromHistoryIds','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','typedi','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','SalesforceQueryService','filename','fromSalesforce','1394937AxDbhJ','base64','__esModule','515885PctazO','toString','336QLYNMN','14088IDtgsi','132eakldA','Name','FlosumComponentHistoryDto','COMPONENTS_PER_QUERY','SalesforceRetrieverService','info','2874fijcst','log','name','ids','map','../dto/flosum-component-history.dto','%ids%','9514KIunAx','apply','129770gKLklW','length','retrieveAttachment','38SOzQSr','find','join','__importDefault','search','(((.+)+)+)+$'];a203_0xd0a9=function(){return _0x5c4f0d;};return a203_0xd0a9();}Object[a203_0x24436d(0xee)](exports,a203_0x24436d(0xcb),{'value':!![]}),exports[a203_0x24436d(0xd4)]=void 0x0;const core_1=require(a203_0x24436d(0xf0)),typedi_1=__importDefault(require(a203_0x24436d(0xc4))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a203_0x24436d(0xfe)),flosum_component_history_dto_1=require(a203_0x24436d(0xdb));class SalesforceRetrieverService{constructor(_0x2c414c){const _0x100b49=a203_0x24436d;this[_0x100b49(0xc1)]=_0x2c414c,this[_0x100b49(0xfb)]=new core_1[(_0x100b49(0xe9))](SalesforceRetrieverService[_0x100b49(0xd8)]),this[_0x100b49(0xeb)]=0xbb8,this[_0x100b49(0xd3)]=0x1f4;}async[a203_0x24436d(0xc2)](_0x359474){const _0x595d66=a203_0x24436d;this[_0x595d66(0xfb)]['info'](_0x595d66(0xc5),_0x359474[_0x595d66(0xe0)]);const _0x3e4298=typedi_1[_0x595d66(0xf1)]['get'](salesforce_query_service_1[_0x595d66(0xc6)]),_0x5bdaa1=_0x359474[_0x595d66(0xda)](_0x3ecf99=>'\x27'+_0x3ecf99+'\x27'),_0xf77b1d=[];while(_0x5bdaa1['length']){const _0x1f8743=_0x5bdaa1[_0x595d66(0xf9)](0x0,this[_0x595d66(0xd3)]),_0x4e92b=_0x3e4298['query'](queries_1[_0x595d66(0xed)][_0x595d66(0xec)](_0x595d66(0xf7),_0x1f8743[_0x595d66(0xe4)]())),_0x1cfd2c=_0x3e4298[_0x595d66(0xf6)](queries_1[_0x595d66(0xfc)][_0x595d66(0xec)](_0x595d66(0xdc),_0x1f8743[_0x595d66(0xe4)]()))['then'](_0x4f5d0d=>_0x4f5d0d['map'](_0x4e3483=>flosum_component_history_dto_1[_0x595d66(0xd2)][_0x595d66(0xc8)](_0x4e3483))),[_0x3e6a1f,_0x4fceab]=await Promise[_0x595d66(0xf4)]([_0x4e92b,_0x1cfd2c]);for(const _0x5d778f of _0x4fceab){const _0x5c3ae8=_0x3e6a1f[_0x595d66(0xe3)](_0x5b41cd=>_0x5b41cd[_0x595d66(0xfd)]===_0x5d778f['id']);_0x5c3ae8&&_0xf77b1d['push']({'fileType':_0x5c3ae8[_0x595d66(0xd1)],'fileName':_0x5d778f[_0x595d66(0xc7)],'attachmentId':_0x5c3ae8['Id']});}}return _0xf77b1d;}async[a203_0x24436d(0xf8)](_0x288588){const _0x126686=a203_0x24436d,_0x45fc0d=await this[_0x126686(0xc2)](_0x288588);this[_0x126686(0xfb)][_0x126686(0xd5)](_0x126686(0xfa));const _0x34e4a4=[];for(const _0x14e910 of _0x45fc0d){const _0x37d0d2=await this[_0x126686(0xc1)][_0x126686(0xe1)](_0x14e910['attachmentId'],!![]);_0x34e4a4['push']({'body':_0x37d0d2['toString'](_0x126686(0xca)),'fileName':_0x14e910[_0x126686(0xf3)],'fileType':_0x14e910['fileType']}),this[_0x126686(0xfb)][_0x126686(0xd5)](_0x126686(0xf2),_0x34e4a4[_0x126686(0xe0)],_0x288588[_0x126686(0xe0)]);}return _0x34e4a4;}async[a203_0x24436d(0xf5)](_0x34d8b2){const _0x3cfb1b=a203_0x24436d,_0x2aeabe=[..._0x34d8b2],_0x5a1186=[],_0x21bf38=[];while(_0x2aeabe[_0x3cfb1b(0xe0)]){const _0x2190da=_0x2aeabe[_0x3cfb1b(0xf9)](0x0,this[_0x3cfb1b(0xeb)]),_0x542e28=await this['salesforceService']['retrieveComponents'](_0x2190da);_0x2190da[_0x3cfb1b(0xe0)]!==_0x542e28[_0x3cfb1b(0xd9)][_0x3cfb1b(0xe0)]?(_0x2aeabe[_0x3cfb1b(0xea)](..._0x542e28[_0x3cfb1b(0xd9)]),_0x5a1186['push'](..._0x542e28['components'])):_0x21bf38['push'](..._0x2190da),this[_0x3cfb1b(0xfb)][_0x3cfb1b(0xd7)](_0x3cfb1b(0xc3),_0x34d8b2[_0x3cfb1b(0xe0)]-_0x2aeabe[_0x3cfb1b(0xe0)],_0x34d8b2[_0x3cfb1b(0xe0)]);}if(_0x21bf38[_0x3cfb1b(0xe0)]){const _0x11d2f2=await this['retrieveLastComponents'](_0x21bf38);_0x5a1186['push'](..._0x11d2f2);}return _0x5a1186;}}exports[a203_0x24436d(0xd4)]=SalesforceRetrieverService;