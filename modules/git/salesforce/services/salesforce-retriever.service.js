const a242_0x369342=a242_0x2323;function a242_0x2323(_0x29664b,_0x4317ce){const _0x4ce1a9=a242_0x27f3();return a242_0x2323=function(_0x35d5b9,_0x11ebaf){_0x35d5b9=_0x35d5b9-0xf4;let _0x27f37a=_0x4ce1a9[_0x35d5b9];return _0x27f37a;},a242_0x2323(_0x29664b,_0x4317ce);}(function(_0x10c288,_0x1720fa){const _0x1c89f7=a242_0x2323,_0x8e0643=_0x10c288();while(!![]){try{const _0x283a3c=-parseInt(_0x1c89f7(0x100))/0x1+-parseInt(_0x1c89f7(0x118))/0x2+-parseInt(_0x1c89f7(0x113))/0x3+-parseInt(_0x1c89f7(0xfe))/0x4*(-parseInt(_0x1c89f7(0x101))/0x5)+parseInt(_0x1c89f7(0x112))/0x6+parseInt(_0x1c89f7(0x10b))/0x7*(parseInt(_0x1c89f7(0x106))/0x8)+parseInt(_0x1c89f7(0x117))/0x9*(-parseInt(_0x1c89f7(0xf4))/0xa);if(_0x283a3c===_0x1720fa)break;else _0x8e0643['push'](_0x8e0643['shift']());}catch(_0x3d29ab){_0x8e0643['push'](_0x8e0643['shift']());}}}(a242_0x27f3,0xa4cc9));const a242_0x11ebaf=(function(){let _0x337758=!![];return function(_0x494e0f,_0x56a346){const _0x4621f4=_0x337758?function(){const _0x1b2b09=a242_0x2323;if(_0x56a346){const _0x583e52=_0x56a346[_0x1b2b09(0x10d)](_0x494e0f,arguments);return _0x56a346=null,_0x583e52;}}:function(){};return _0x337758=![],_0x4621f4;};}()),a242_0x35d5b9=a242_0x11ebaf(this,function(){const _0x3838b2=a242_0x2323;return a242_0x35d5b9[_0x3838b2(0xfc)]()[_0x3838b2(0x116)](_0x3838b2(0xf7))[_0x3838b2(0xfc)]()['constructor'](a242_0x35d5b9)[_0x3838b2(0x116)](_0x3838b2(0xf7));});a242_0x35d5b9();'use strict';var __importDefault=this&&this[a242_0x369342(0xf8)]||function(_0x2cd81d){return _0x2cd81d&&_0x2cd81d['__esModule']?_0x2cd81d:{'default':_0x2cd81d};};Object['defineProperty'](exports,a242_0x369342(0x114),{'value':!![]}),exports[a242_0x369342(0x10c)]=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require(a242_0x369342(0x11b))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a242_0x369342(0x11c)),flosum_component_history_dto_1=require(a242_0x369342(0x11f));class SalesforceRetrieverService{constructor(_0x428213){const _0xf12ee7=a242_0x369342;this[_0xf12ee7(0x11e)]=_0x428213,this[_0xf12ee7(0xfd)]=new core_1[(_0xf12ee7(0x104))](SalesforceRetrieverService['name']),this[_0xf12ee7(0x110)]=0xbb8,this[_0xf12ee7(0x123)]=0x1f4;}async[a242_0x369342(0x11a)](_0x33f1b9){const _0x591bfe=a242_0x369342;this['logger'][_0x591bfe(0x111)](_0x591bfe(0x127),_0x33f1b9['length']);const _0x54a093=typedi_1[_0x591bfe(0x10e)]['get'](salesforce_query_service_1[_0x591bfe(0x119)]),_0x3cef94=_0x33f1b9[_0x591bfe(0x102)](_0x1ed735=>'\x27'+_0x1ed735+'\x27'),_0x22e5a7=[];while(_0x3cef94[_0x591bfe(0x129)]){const _0x4ea1dc=_0x3cef94[_0x591bfe(0xf9)](0x0,this[_0x591bfe(0x123)]),_0xee2e24=_0x54a093[_0x591bfe(0x11d)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x591bfe(0x121)](_0x591bfe(0xff),_0x4ea1dc['join']())),_0x3e621d=_0x54a093['query'](queries_1[_0x591bfe(0xfa)][_0x591bfe(0x121)](_0x591bfe(0x105),_0x4ea1dc[_0x591bfe(0x107)]()))[_0x591bfe(0x103)](_0x9688b1=>_0x9688b1[_0x591bfe(0x102)](_0x47f00d=>flosum_component_history_dto_1[_0x591bfe(0x126)][_0x591bfe(0x109)](_0x47f00d))),[_0x2e9750,_0xe6bf40]=await Promise[_0x591bfe(0x10f)]([_0xee2e24,_0x3e621d]);for(const _0x1d930e of _0xe6bf40){const _0xa9e98=_0x2e9750[_0x591bfe(0x124)](_0x5846f2=>_0x5846f2['ParentId']===_0x1d930e['id']);_0xa9e98&&_0x22e5a7['push']({'fileType':_0xa9e98['Name'],'fileName':_0x1d930e[_0x591bfe(0xf6)],'attachmentId':_0xa9e98['Id']});}}return _0x22e5a7;}async[a242_0x369342(0x120)](_0x437107){const _0x420a16=a242_0x369342,_0x5c22a7=await this['retrieveComponentIdsFromHistoryIds'](_0x437107);this[_0x420a16(0xfd)][_0x420a16(0x111)]('manually\x20retrieving\x20components\x20from\x20salesforce');const _0x216c60=[];for(const _0x12a08f of _0x5c22a7){const _0x655f80=await this[_0x420a16(0x11e)][_0x420a16(0x115)](_0x12a08f['attachmentId'],!![]);_0x216c60[_0x420a16(0xf5)]({'body':_0x655f80['toString'](_0x420a16(0x10a)),'fileName':_0x12a08f[_0x420a16(0x125)],'fileType':_0x12a08f[_0x420a16(0x108)]}),this[_0x420a16(0xfd)][_0x420a16(0x111)]('manually\x20retrieved\x20%d/%d\x20components',_0x216c60[_0x420a16(0x129)],_0x437107[_0x420a16(0x129)]);}return _0x216c60;}async[a242_0x369342(0x128)](_0x5bc6fe){const _0xdc113f=a242_0x369342,_0x2324e7=[..._0x5bc6fe],_0x3e192a=[],_0x1b050f=[];while(_0x2324e7['length']){const _0x2f2cc7=_0x2324e7['splice'](0x0,this[_0xdc113f(0x110)]),_0x4f327b=await this[_0xdc113f(0x11e)][_0xdc113f(0x12a)](_0x2f2cc7);_0x2f2cc7[_0xdc113f(0x129)]!==_0x4f327b[_0xdc113f(0x122)][_0xdc113f(0x129)]?(_0x2324e7['push'](..._0x4f327b[_0xdc113f(0x122)]),_0x3e192a[_0xdc113f(0xf5)](..._0x4f327b['components'])):_0x1b050f[_0xdc113f(0xf5)](..._0x2f2cc7),this['logger']['log'](_0xdc113f(0xfb),_0x5bc6fe[_0xdc113f(0x129)]-_0x2324e7[_0xdc113f(0x129)],_0x5bc6fe[_0xdc113f(0x129)]);}if(_0x1b050f['length']){const _0x463bf7=await this['retrieveLastComponents'](_0x1b050f);_0x3e192a['push'](..._0x463bf7);}return _0x3e192a;}}exports[a242_0x369342(0x10c)]=SalesforceRetrieverService;function a242_0x27f3(){const _0x425743=['__esModule','retrieveAttachment','search','1935VXIyiL','97816ofOASm','SalesforceQueryService','retrieveComponentIdsFromHistoryIds','typedi','../queries','query','salesforceService','../dto/flosum-component-history.dto','retrieveLastComponents','replace','ids','COMPONENTS_PER_QUERY','find','fileName','FlosumComponentHistoryDto','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','run','length','retrieveComponents','61990cTnYEX','push','filename','(((.+)+)+)+$','__importDefault','splice','GET_COMPONENT_HISTORIES_BY_IDS','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','toString','logger','20XWyDOr','%parent_ids%','348844fVNHwC','80590MUcdcF','map','then','Logger','%ids%','9284536tRzTOJ','join','fileType','fromSalesforce','base64','7Aokgkv','SalesforceRetrieverService','apply','default','all','COMPONENTS_PER_REQUEST','info','7193658qyrIRv','103638hBDGvc'];a242_0x27f3=function(){return _0x425743;};return a242_0x27f3();}