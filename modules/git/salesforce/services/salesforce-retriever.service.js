const a236_0x54c562=a236_0x16a2;(function(_0x4ba39c,_0x57533e){const _0x5b68ea=a236_0x16a2,_0x4faf3d=_0x4ba39c();while(!![]){try{const _0x37e774=parseInt(_0x5b68ea(0x123))/0x1+parseInt(_0x5b68ea(0xf7))/0x2+-parseInt(_0x5b68ea(0x122))/0x3+-parseInt(_0x5b68ea(0x10f))/0x4*(-parseInt(_0x5b68ea(0x111))/0x5)+-parseInt(_0x5b68ea(0x11f))/0x6*(parseInt(_0x5b68ea(0xfb))/0x7)+-parseInt(_0x5b68ea(0xf3))/0x8+-parseInt(_0x5b68ea(0x116))/0x9*(-parseInt(_0x5b68ea(0x129))/0xa);if(_0x37e774===_0x57533e)break;else _0x4faf3d['push'](_0x4faf3d['shift']());}catch(_0x2fcfd0){_0x4faf3d['push'](_0x4faf3d['shift']());}}}(a236_0xa3f1,0x7d0d1));const a236_0x194d4f=(function(){let _0x25dfb2=!![];return function(_0x441265,_0x1f4548){const _0x3f0157=_0x25dfb2?function(){const _0x22767b=a236_0x16a2;if(_0x1f4548){const _0x497e31=_0x1f4548[_0x22767b(0xf8)](_0x441265,arguments);return _0x1f4548=null,_0x497e31;}}:function(){};return _0x25dfb2=![],_0x3f0157;};}()),a236_0x561cb4=a236_0x194d4f(this,function(){const _0x336449=a236_0x16a2;return a236_0x561cb4[_0x336449(0x11b)]()[_0x336449(0x102)](_0x336449(0x100))[_0x336449(0x11b)]()[_0x336449(0x10e)](a236_0x561cb4)[_0x336449(0x102)]('(((.+)+)+)+$');});a236_0x561cb4();function a236_0x16a2(_0x568d6a,_0xd45cf7){const _0x481c0f=a236_0xa3f1();return a236_0x16a2=function(_0x561cb4,_0x194d4f){_0x561cb4=_0x561cb4-0xf3;let _0xa3f177=_0x481c0f[_0x561cb4];return _0xa3f177;},a236_0x16a2(_0x568d6a,_0xd45cf7);}'use strict';function a236_0xa3f1(){const _0x59f0ca=['4wrTmuA','salesforceService','2167525kmuqse','get','manually\x20retrieved\x20%d/%d\x20components','FlosumComponentHistoryDto','GET_COMPONENT_HISTORIES_BY_IDS','5724306fSqUIt','../dto/flosum-component-history.dto','attachmentId','retrieveComponentIdsFromHistoryIds','../queries','toString','retrieveAttachment','%parent_ids%','retrieveComponents','78eaKvrV','../../../../core','ids','1289268ggvvaK','520490ayZNTQ','SalesforceQueryService','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','map','fromSalesforce','Name','10ADGfIL','6874672VmXfGe','info','fileName','COMPONENTS_PER_QUERY','1338182CSEOFc','apply','query','%ids%','246519xlJlVY','COMPONENTS_PER_REQUEST','logger','replace','log','(((.+)+)+)+$','base64','search','length','manually\x20retrieving\x20components\x20from\x20salesforce','push','components','retrieveLastComponents','all','__esModule','Logger','SalesforceRetrieverService','defineProperty','__importDefault','constructor'];a236_0xa3f1=function(){return _0x59f0ca;};return a236_0xa3f1();}var __importDefault=this&&this[a236_0x54c562(0x10d)]||function(_0x1e1587){const _0x318933=a236_0x54c562;return _0x1e1587&&_0x1e1587[_0x318933(0x109)]?_0x1e1587:{'default':_0x1e1587};};Object[a236_0x54c562(0x10c)](exports,a236_0x54c562(0x109),{'value':!![]}),exports[a236_0x54c562(0x10b)]=void 0x0;const core_1=require(a236_0x54c562(0x120)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a236_0x54c562(0x11a)),flosum_component_history_dto_1=require(a236_0x54c562(0x117));class SalesforceRetrieverService{constructor(_0x3f31fb){const _0x4e7597=a236_0x54c562;this[_0x4e7597(0x110)]=_0x3f31fb,this[_0x4e7597(0xfd)]=new core_1[(_0x4e7597(0x10a))](SalesforceRetrieverService['name']),this[_0x4e7597(0xfc)]=0xbb8,this[_0x4e7597(0xf6)]=0x1f4;}async[a236_0x54c562(0x119)](_0x26da03){const _0x32d280=a236_0x54c562;this['logger'][_0x32d280(0xf4)](_0x32d280(0x125),_0x26da03[_0x32d280(0x103)]);const _0x203307=typedi_1['default'][_0x32d280(0x112)](salesforce_query_service_1[_0x32d280(0x124)]),_0x4ed4b8=_0x26da03[_0x32d280(0x126)](_0x35c625=>'\x27'+_0x35c625+'\x27'),_0x4f60df=[];while(_0x4ed4b8[_0x32d280(0x103)]){const _0x2aea94=_0x4ed4b8['splice'](0x0,this['COMPONENTS_PER_QUERY']),_0x1d07fc=_0x203307[_0x32d280(0xf9)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x32d280(0xfe)](_0x32d280(0x11d),_0x2aea94['join']())),_0xb901f1=_0x203307[_0x32d280(0xf9)](queries_1[_0x32d280(0x115)][_0x32d280(0xfe)](_0x32d280(0xfa),_0x2aea94['join']()))['then'](_0x16991d=>_0x16991d[_0x32d280(0x126)](_0x17b7da=>flosum_component_history_dto_1[_0x32d280(0x114)][_0x32d280(0x127)](_0x17b7da))),[_0x23aa12,_0x50917d]=await Promise[_0x32d280(0x108)]([_0x1d07fc,_0xb901f1]);for(const _0x2fd88c of _0x50917d){const _0x527180=_0x23aa12['find'](_0x2f04b2=>_0x2f04b2['ParentId']===_0x2fd88c['id']);_0x527180&&_0x4f60df[_0x32d280(0x105)]({'fileType':_0x527180[_0x32d280(0x128)],'fileName':_0x2fd88c['filename'],'attachmentId':_0x527180['Id']});}}return _0x4f60df;}async[a236_0x54c562(0x107)](_0x1f9b52){const _0x5b67ec=a236_0x54c562,_0x497eea=await this[_0x5b67ec(0x119)](_0x1f9b52);this[_0x5b67ec(0xfd)][_0x5b67ec(0xf4)](_0x5b67ec(0x104));const _0x45bd9a=[];for(const _0x584e82 of _0x497eea){const _0x270b42=await this['salesforceService'][_0x5b67ec(0x11c)](_0x584e82[_0x5b67ec(0x118)],!![]);_0x45bd9a[_0x5b67ec(0x105)]({'body':_0x270b42[_0x5b67ec(0x11b)](_0x5b67ec(0x101)),'fileName':_0x584e82[_0x5b67ec(0xf5)],'fileType':_0x584e82['fileType']}),this[_0x5b67ec(0xfd)][_0x5b67ec(0xf4)](_0x5b67ec(0x113),_0x45bd9a[_0x5b67ec(0x103)],_0x1f9b52[_0x5b67ec(0x103)]);}return _0x45bd9a;}async['run'](_0x4aea04){const _0x1f7b3d=a236_0x54c562,_0x4c609b=[..._0x4aea04],_0x731abb=[],_0x56fcb7=[];while(_0x4c609b[_0x1f7b3d(0x103)]){const _0x29c624=_0x4c609b['splice'](0x0,this[_0x1f7b3d(0xfc)]),_0x5edf92=await this[_0x1f7b3d(0x110)][_0x1f7b3d(0x11e)](_0x29c624);_0x29c624[_0x1f7b3d(0x103)]!==_0x5edf92[_0x1f7b3d(0x121)][_0x1f7b3d(0x103)]?(_0x4c609b[_0x1f7b3d(0x105)](..._0x5edf92[_0x1f7b3d(0x121)]),_0x731abb[_0x1f7b3d(0x105)](..._0x5edf92[_0x1f7b3d(0x106)])):_0x56fcb7['push'](..._0x29c624),this[_0x1f7b3d(0xfd)][_0x1f7b3d(0xff)]('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x4aea04[_0x1f7b3d(0x103)]-_0x4c609b[_0x1f7b3d(0x103)],_0x4aea04[_0x1f7b3d(0x103)]);}if(_0x56fcb7['length']){const _0x5626c5=await this[_0x1f7b3d(0x107)](_0x56fcb7);_0x731abb['push'](..._0x5626c5);}return _0x731abb;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;