const a190_0x30777a=a190_0x2721;(function(_0x1d1ea1,_0x4e289a){const _0x21ae70=a190_0x2721,_0x5dd625=_0x1d1ea1();while(!![]){try{const _0x34a8fe=-parseInt(_0x21ae70(0x11b))/0x1+parseInt(_0x21ae70(0x10f))/0x2+-parseInt(_0x21ae70(0x136))/0x3+-parseInt(_0x21ae70(0x127))/0x4+parseInt(_0x21ae70(0x128))/0x5*(-parseInt(_0x21ae70(0x121))/0x6)+parseInt(_0x21ae70(0x106))/0x7*(-parseInt(_0x21ae70(0x113))/0x8)+parseInt(_0x21ae70(0x124))/0x9;if(_0x34a8fe===_0x4e289a)break;else _0x5dd625['push'](_0x5dd625['shift']());}catch(_0x3d8b24){_0x5dd625['push'](_0x5dd625['shift']());}}}(a190_0x515a,0x36303));const a190_0x2a9e47=(function(){let _0x33a635=!![];return function(_0x5e02d1,_0x59971c){const _0x3576f3=_0x33a635?function(){const _0x9a9418=a190_0x2721;if(_0x59971c){const _0x527d23=_0x59971c[_0x9a9418(0x12f)](_0x5e02d1,arguments);return _0x59971c=null,_0x527d23;}}:function(){};return _0x33a635=![],_0x3576f3;};}()),a190_0x2b43b1=a190_0x2a9e47(this,function(){const _0x35f4ec=a190_0x2721;return a190_0x2b43b1['toString']()[_0x35f4ec(0x118)](_0x35f4ec(0x11d))[_0x35f4ec(0x109)]()[_0x35f4ec(0x135)](a190_0x2b43b1)[_0x35f4ec(0x118)](_0x35f4ec(0x11d));});function a190_0x2721(_0x42310d,_0xb43ed3){const _0x1d04ae=a190_0x515a();return a190_0x2721=function(_0x2b43b1,_0x2a9e47){_0x2b43b1=_0x2b43b1-0x101;let _0x515ad0=_0x1d04ae[_0x2b43b1];return _0x515ad0;},a190_0x2721(_0x42310d,_0xb43ed3);}function a190_0x515a(){const _0xa1dde6=['../queries','(((.+)+)+)+$','Name','../../../../core','ParentId','2572188xBtPnY','replace','length','11820879eIgHpl','%ids%','COMPONENTS_PER_QUERY','1440888xsEOMf','5QOfDoM','name','query','ids','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','FlosumComponentHistoryDto','then','apply','retrieveLastComponents','push','info','manually\x20retrieving\x20components\x20from\x20salesforce','splice','constructor','360000HUKjii','%parent_ids%','map','./salesforce-query.service','__esModule','fileType','SalesforceQueryService','all','21xaeXMI','SalesforceRetrieverService','retrieveComponentIdsFromHistoryIds','toString','attachmentId','join','../dto/flosum-component-history.dto','GET_COMPONENT_HISTORIES_BY_IDS','logger','198008XXaTUG','retrieveComponents','log','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','716840MQUrxX','salesforceService','fileName','base64','COMPONENTS_PER_REQUEST','search','run','default','12745AomhPM'];a190_0x515a=function(){return _0xa1dde6;};return a190_0x515a();}a190_0x2b43b1();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x502d00){const _0x99f27d=a190_0x2721;return _0x502d00&&_0x502d00[_0x99f27d(0x102)]?_0x502d00:{'default':_0x502d00};};Object['defineProperty'](exports,a190_0x30777a(0x102),{'value':!![]}),exports[a190_0x30777a(0x107)]=void 0x0;const core_1=require(a190_0x30777a(0x11f)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a190_0x30777a(0x101)),queries_1=require(a190_0x30777a(0x11c)),flosum_component_history_dto_1=require(a190_0x30777a(0x10c));class SalesforceRetrieverService{constructor(_0x52c1b1){const _0x329bed=a190_0x30777a;this[_0x329bed(0x114)]=_0x52c1b1,this[_0x329bed(0x10e)]=new core_1['Logger'](SalesforceRetrieverService[_0x329bed(0x129)]),this[_0x329bed(0x117)]=0xbb8,this[_0x329bed(0x126)]=0x1f4;}async[a190_0x30777a(0x108)](_0x5c36ca){const _0x5a301e=a190_0x30777a;this['logger'][_0x5a301e(0x132)](_0x5a301e(0x112),_0x5c36ca['length']);const _0x3ec9b5=typedi_1[_0x5a301e(0x11a)]['get'](salesforce_query_service_1[_0x5a301e(0x104)]),_0x1df73a=_0x5c36ca[_0x5a301e(0x138)](_0x21e84d=>'\x27'+_0x21e84d+'\x27'),_0x335d8e=[];while(_0x1df73a[_0x5a301e(0x123)]){const _0x42f996=_0x1df73a[_0x5a301e(0x134)](0x0,this['COMPONENTS_PER_QUERY']),_0x5b6628=_0x3ec9b5[_0x5a301e(0x12a)](queries_1[_0x5a301e(0x12c)][_0x5a301e(0x122)](_0x5a301e(0x137),_0x42f996[_0x5a301e(0x10b)]())),_0x2a2d47=_0x3ec9b5[_0x5a301e(0x12a)](queries_1[_0x5a301e(0x10d)][_0x5a301e(0x122)](_0x5a301e(0x125),_0x42f996[_0x5a301e(0x10b)]()))[_0x5a301e(0x12e)](_0x5039fa=>_0x5039fa['map'](_0x4c028e=>flosum_component_history_dto_1[_0x5a301e(0x12d)]['fromSalesforce'](_0x4c028e))),[_0x4b91e3,_0x434460]=await Promise[_0x5a301e(0x105)]([_0x5b6628,_0x2a2d47]);for(const _0x1902e4 of _0x434460){const _0x150521=_0x4b91e3['find'](_0x4ee6d3=>_0x4ee6d3[_0x5a301e(0x120)]===_0x1902e4['id']);_0x150521&&_0x335d8e[_0x5a301e(0x131)]({'fileType':_0x150521[_0x5a301e(0x11e)],'fileName':_0x1902e4['filename'],'attachmentId':_0x150521['Id']});}}return _0x335d8e;}async[a190_0x30777a(0x130)](_0x5b330a){const _0x4fa1a7=a190_0x30777a,_0x25177d=await this[_0x4fa1a7(0x108)](_0x5b330a);this[_0x4fa1a7(0x10e)][_0x4fa1a7(0x132)](_0x4fa1a7(0x133));const _0x51e9b2=[];for(const _0x36f108 of _0x25177d){const _0x34ba79=await this[_0x4fa1a7(0x114)]['retrieveAttachment'](_0x36f108[_0x4fa1a7(0x10a)],!![]);_0x51e9b2[_0x4fa1a7(0x131)]({'body':_0x34ba79[_0x4fa1a7(0x109)](_0x4fa1a7(0x116)),'fileName':_0x36f108[_0x4fa1a7(0x115)],'fileType':_0x36f108[_0x4fa1a7(0x103)]}),this[_0x4fa1a7(0x10e)][_0x4fa1a7(0x132)]('manually\x20retrieved\x20%d/%d\x20components',_0x51e9b2[_0x4fa1a7(0x123)],_0x5b330a[_0x4fa1a7(0x123)]);}return _0x51e9b2;}async[a190_0x30777a(0x119)](_0x57e589){const _0x28023e=a190_0x30777a,_0x540a92=[..._0x57e589],_0x49c677=[],_0x3c0a15=[];while(_0x540a92['length']){const _0x19e1e7=_0x540a92['splice'](0x0,this['COMPONENTS_PER_REQUEST']),_0x1d4aef=await this[_0x28023e(0x114)][_0x28023e(0x110)](_0x19e1e7);_0x19e1e7[_0x28023e(0x123)]!==_0x1d4aef[_0x28023e(0x12b)][_0x28023e(0x123)]?(_0x540a92['push'](..._0x1d4aef['ids']),_0x49c677[_0x28023e(0x131)](..._0x1d4aef['components'])):_0x3c0a15[_0x28023e(0x131)](..._0x19e1e7),this['logger'][_0x28023e(0x111)]('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x57e589[_0x28023e(0x123)]-_0x540a92[_0x28023e(0x123)],_0x57e589[_0x28023e(0x123)]);}if(_0x3c0a15[_0x28023e(0x123)]){const _0x537a58=await this[_0x28023e(0x130)](_0x3c0a15);_0x49c677[_0x28023e(0x131)](..._0x537a58);}return _0x49c677;}}exports[a190_0x30777a(0x107)]=SalesforceRetrieverService;