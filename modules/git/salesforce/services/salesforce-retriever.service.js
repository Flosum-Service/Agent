const a237_0xeb4049=a237_0x44db;(function(_0x4fd6a1,_0x343095){const _0x2b58fd=a237_0x44db,_0x38b336=_0x4fd6a1();while(!![]){try{const _0x7a08f3=-parseInt(_0x2b58fd(0x103))/0x1*(-parseInt(_0x2b58fd(0x104))/0x2)+-parseInt(_0x2b58fd(0x135))/0x3*(parseInt(_0x2b58fd(0x10a))/0x4)+-parseInt(_0x2b58fd(0x130))/0x5*(parseInt(_0x2b58fd(0x136))/0x6)+parseInt(_0x2b58fd(0x100))/0x7*(parseInt(_0x2b58fd(0x131))/0x8)+parseInt(_0x2b58fd(0x11e))/0x9*(-parseInt(_0x2b58fd(0x11b))/0xa)+-parseInt(_0x2b58fd(0x123))/0xb+parseInt(_0x2b58fd(0x10e))/0xc*(parseInt(_0x2b58fd(0x11c))/0xd);if(_0x7a08f3===_0x343095)break;else _0x38b336['push'](_0x38b336['shift']());}catch(_0x50dc36){_0x38b336['push'](_0x38b336['shift']());}}}(a237_0x4492,0x32d3c));const a237_0x2a237b=(function(){let _0x533e44=!![];return function(_0x266e2a,_0x33040c){const _0x1b0f06=_0x533e44?function(){const _0x5a7782=a237_0x44db;if(_0x33040c){const _0x51a3ac=_0x33040c[_0x5a7782(0x12f)](_0x266e2a,arguments);return _0x33040c=null,_0x51a3ac;}}:function(){};return _0x533e44=![],_0x1b0f06;};}()),a237_0x1e624b=a237_0x2a237b(this,function(){const _0x36b8db=a237_0x44db;return a237_0x1e624b[_0x36b8db(0x128)]()[_0x36b8db(0x126)]('(((.+)+)+)+$')[_0x36b8db(0x128)]()[_0x36b8db(0x115)](a237_0x1e624b)[_0x36b8db(0x126)]('(((.+)+)+)+$');});function a237_0x4492(){const _0x3d0eda=['splice','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','1CsrRfz','313836fRGKNG','salesforceService','length','__importDefault','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','get','28vRZjEB','filename','__esModule','find','192ONsMNo','then','GET_COMPONENT_HISTORIES_BY_IDS','COMPONENTS_PER_QUERY','typedi','all','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','constructor','attachmentId','default','join','./salesforce-query.service','push','30Utgzjd','414102InWlxe','info','186003cOPDko','retrieveComponents','map','defineProperty','COMPONENTS_PER_REQUEST','750728AhfFFa','../queries','retrieveAttachment','search','../dto/flosum-component-history.dto','toString','../../../../core','logger','ids','SalesforceQueryService','replace','%parent_ids%','apply','965ykiDiZ','736ZzwXhC','fileName','%ids%','Logger','156531yzwJJd','2748AYBzDQ','run','Name','manually\x20retrieving\x20components\x20from\x20salesforce','retrieveLastComponents','9548RFmTUX'];a237_0x4492=function(){return _0x3d0eda;};return a237_0x4492();}a237_0x1e624b();'use strict';var __importDefault=this&&this[a237_0xeb4049(0x107)]||function(_0x5e7e8e){const _0x28d7c1=a237_0xeb4049;return _0x5e7e8e&&_0x5e7e8e[_0x28d7c1(0x10c)]?_0x5e7e8e:{'default':_0x5e7e8e};};Object[a237_0xeb4049(0x121)](exports,'__esModule',{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a237_0xeb4049(0x129)),typedi_1=__importDefault(require(a237_0xeb4049(0x112))),salesforce_query_service_1=require(a237_0xeb4049(0x119)),queries_1=require(a237_0xeb4049(0x124)),flosum_component_history_dto_1=require(a237_0xeb4049(0x127));class SalesforceRetrieverService{constructor(_0x91be3d){const _0x3ec129=a237_0xeb4049;this[_0x3ec129(0x105)]=_0x91be3d,this['logger']=new core_1[(_0x3ec129(0x134))](SalesforceRetrieverService['name']),this[_0x3ec129(0x122)]=0xbb8,this[_0x3ec129(0x111)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x42a847){const _0x2693f6=a237_0xeb4049;this[_0x2693f6(0x12a)][_0x2693f6(0x11d)](_0x2693f6(0x108),_0x42a847[_0x2693f6(0x106)]);const _0x55ea6d=typedi_1[_0x2693f6(0x117)][_0x2693f6(0x109)](salesforce_query_service_1[_0x2693f6(0x12c)]),_0x34497a=_0x42a847[_0x2693f6(0x120)](_0x515978=>'\x27'+_0x515978+'\x27'),_0x54efe1=[];while(_0x34497a[_0x2693f6(0x106)]){const _0x1807f1=_0x34497a[_0x2693f6(0x101)](0x0,this[_0x2693f6(0x111)]),_0x4e7b96=_0x55ea6d['query'](queries_1[_0x2693f6(0x114)][_0x2693f6(0x12d)](_0x2693f6(0x12e),_0x1807f1['join']())),_0x4ca943=_0x55ea6d['query'](queries_1[_0x2693f6(0x110)][_0x2693f6(0x12d)](_0x2693f6(0x133),_0x1807f1[_0x2693f6(0x118)]()))[_0x2693f6(0x10f)](_0x2480ca=>_0x2480ca[_0x2693f6(0x120)](_0x1e08ee=>flosum_component_history_dto_1['FlosumComponentHistoryDto']['fromSalesforce'](_0x1e08ee))),[_0x3e1d30,_0x223913]=await Promise[_0x2693f6(0x113)]([_0x4e7b96,_0x4ca943]);for(const _0x58ebc9 of _0x223913){const _0x3739cd=_0x3e1d30[_0x2693f6(0x10d)](_0x59f2e0=>_0x59f2e0['ParentId']===_0x58ebc9['id']);_0x3739cd&&_0x54efe1['push']({'fileType':_0x3739cd[_0x2693f6(0x138)],'fileName':_0x58ebc9[_0x2693f6(0x10b)],'attachmentId':_0x3739cd['Id']});}}return _0x54efe1;}async[a237_0xeb4049(0xff)](_0x39cea5){const _0x2ade15=a237_0xeb4049,_0x5282ef=await this['retrieveComponentIdsFromHistoryIds'](_0x39cea5);this['logger'][_0x2ade15(0x11d)](_0x2ade15(0x139));const _0x2c8366=[];for(const _0x5d359e of _0x5282ef){const _0x2edd88=await this['salesforceService'][_0x2ade15(0x125)](_0x5d359e[_0x2ade15(0x116)],!![]);_0x2c8366[_0x2ade15(0x11a)]({'body':_0x2edd88[_0x2ade15(0x128)]('base64'),'fileName':_0x5d359e[_0x2ade15(0x132)],'fileType':_0x5d359e['fileType']}),this[_0x2ade15(0x12a)][_0x2ade15(0x11d)]('manually\x20retrieved\x20%d/%d\x20components',_0x2c8366[_0x2ade15(0x106)],_0x39cea5[_0x2ade15(0x106)]);}return _0x2c8366;}async[a237_0xeb4049(0x137)](_0x518226){const _0x27b12d=a237_0xeb4049,_0x287104=[..._0x518226],_0x2bff75=[],_0x1a7191=[];while(_0x287104[_0x27b12d(0x106)]){const _0x263a14=_0x287104['splice'](0x0,this[_0x27b12d(0x122)]),_0x1f9c2f=await this[_0x27b12d(0x105)][_0x27b12d(0x11f)](_0x263a14);_0x263a14[_0x27b12d(0x106)]!==_0x1f9c2f[_0x27b12d(0x12b)][_0x27b12d(0x106)]?(_0x287104[_0x27b12d(0x11a)](..._0x1f9c2f[_0x27b12d(0x12b)]),_0x2bff75[_0x27b12d(0x11a)](..._0x1f9c2f['components'])):_0x1a7191[_0x27b12d(0x11a)](..._0x263a14),this[_0x27b12d(0x12a)]['log'](_0x27b12d(0x102),_0x518226[_0x27b12d(0x106)]-_0x287104[_0x27b12d(0x106)],_0x518226['length']);}if(_0x1a7191[_0x27b12d(0x106)]){const _0x11c49a=await this[_0x27b12d(0xff)](_0x1a7191);_0x2bff75['push'](..._0x11c49a);}return _0x2bff75;}}function a237_0x44db(_0x5629d7,_0x2049f4){const _0x1d843b=a237_0x4492();return a237_0x44db=function(_0x1e624b,_0x2a237b){_0x1e624b=_0x1e624b-0xff;let _0x44921a=_0x1d843b[_0x1e624b];return _0x44921a;},a237_0x44db(_0x5629d7,_0x2049f4);}exports['SalesforceRetrieverService']=SalesforceRetrieverService;