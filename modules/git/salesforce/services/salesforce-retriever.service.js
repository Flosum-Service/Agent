const a242_0x13013f=a242_0x2aea;(function(_0x23bf53,_0x5e025a){const _0x451002=a242_0x2aea,_0x3d2060=_0x23bf53();while(!![]){try{const _0x577eea=-parseInt(_0x451002(0x91))/0x1*(parseInt(_0x451002(0x82))/0x2)+-parseInt(_0x451002(0x9d))/0x3*(parseInt(_0x451002(0x89))/0x4)+-parseInt(_0x451002(0x96))/0x5*(-parseInt(_0x451002(0xa2))/0x6)+parseInt(_0x451002(0xb8))/0x7*(-parseInt(_0x451002(0x92))/0x8)+parseInt(_0x451002(0xab))/0x9*(-parseInt(_0x451002(0x88))/0xa)+parseInt(_0x451002(0x8b))/0xb+-parseInt(_0x451002(0x8e))/0xc*(-parseInt(_0x451002(0x81))/0xd);if(_0x577eea===_0x5e025a)break;else _0x3d2060['push'](_0x3d2060['shift']());}catch(_0x2abded){_0x3d2060['push'](_0x3d2060['shift']());}}}(a242_0x2e05,0xd9b48));function a242_0x2aea(_0x154e14,_0x1d45f1){const _0x28bb05=a242_0x2e05();return a242_0x2aea=function(_0x208b81,_0x5ce924){_0x208b81=_0x208b81-0x7c;let _0x2e05ad=_0x28bb05[_0x208b81];return _0x2e05ad;},a242_0x2aea(_0x154e14,_0x1d45f1);}const a242_0x5ce924=(function(){let _0x5e8fb8=!![];return function(_0x984bea,_0x138a99){const _0x2666fa=_0x5e8fb8?function(){const _0x4dcc9e=a242_0x2aea;if(_0x138a99){const _0x23c73b=_0x138a99[_0x4dcc9e(0x99)](_0x984bea,arguments);return _0x138a99=null,_0x23c73b;}}:function(){};return _0x5e8fb8=![],_0x2666fa;};}()),a242_0x208b81=a242_0x5ce924(this,function(){const _0x51d46f=a242_0x2aea;return a242_0x208b81[_0x51d46f(0x9a)]()[_0x51d46f(0x98)]('(((.+)+)+)+$')['toString']()[_0x51d46f(0x9f)](a242_0x208b81)[_0x51d46f(0x98)](_0x51d46f(0x93));});a242_0x208b81();'use strict';function a242_0x2e05(){const _0xbc38b6=['%ids%','join','COMPONENTS_PER_REQUEST','log','fromSalesforce','manually\x20retrieved\x20%d/%d\x20components','18GLlzrT','splice','../../../../core','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','retrieveComponentIdsFromHistoryIds','name','components','push','../queries','manually\x20retrieving\x20components\x20from\x20salesforce','info','run','length','335510KIauCP','base64','default','Logger','defineProperty','COMPONENTS_PER_QUERY','1799239mCAubA','144lrLASc','salesforceService','replace','find','retrieveComponents','logger','5347410mLaSVI','4VPkcki','retrieveAttachment','8306628tpqCQQ','fileName','SalesforceQueryService','204TWaydh','retrieveLastComponents','typedi','2340jKeiwd','136sWPvSR','(((.+)+)+)+$','map','%parent_ids%','25RfDXFZ','query','search','apply','toString','__esModule','./salesforce-query.service','1076451CuDEHw','__importDefault','constructor','ParentId','SalesforceRetrieverService','234372ZjKYhj','Name','GET_ATTACHMENT_BY_PARENT_IDS_QUERY'];a242_0x2e05=function(){return _0xbc38b6;};return a242_0x2e05();}var __importDefault=this&&this[a242_0x13013f(0x9e)]||function(_0x485b2b){const _0x176192=a242_0x13013f;return _0x485b2b&&_0x485b2b[_0x176192(0x9b)]?_0x485b2b:{'default':_0x485b2b};};Object[a242_0x13013f(0x7f)](exports,a242_0x13013f(0x9b),{'value':!![]}),exports[a242_0x13013f(0xa1)]=void 0x0;const core_1=require(a242_0x13013f(0xad)),typedi_1=__importDefault(require(a242_0x13013f(0x90))),salesforce_query_service_1=require(a242_0x13013f(0x9c)),queries_1=require(a242_0x13013f(0xb3)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x3437ab){const _0x3e93a4=a242_0x13013f;this['salesforceService']=_0x3437ab,this['logger']=new core_1[(_0x3e93a4(0x7e))](SalesforceRetrieverService[_0x3e93a4(0xb0)]),this[_0x3e93a4(0xa7)]=0xbb8,this[_0x3e93a4(0x80)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x278bd6){const _0xcd4651=a242_0x13013f;this[_0xcd4651(0x87)][_0xcd4651(0xb5)](_0xcd4651(0xae),_0x278bd6[_0xcd4651(0xb7)]);const _0x29e535=typedi_1[_0xcd4651(0x7d)]['get'](salesforce_query_service_1[_0xcd4651(0x8d)]),_0x254624=_0x278bd6[_0xcd4651(0x94)](_0x5b79ac=>'\x27'+_0x5b79ac+'\x27'),_0x261d2d=[];while(_0x254624[_0xcd4651(0xb7)]){const _0x480bfe=_0x254624[_0xcd4651(0xac)](0x0,this['COMPONENTS_PER_QUERY']),_0x43c72c=_0x29e535[_0xcd4651(0x97)](queries_1[_0xcd4651(0xa4)][_0xcd4651(0x84)](_0xcd4651(0x95),_0x480bfe['join']())),_0x18fb4f=_0x29e535[_0xcd4651(0x97)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0xcd4651(0x84)](_0xcd4651(0xa5),_0x480bfe[_0xcd4651(0xa6)]()))['then'](_0xd4f153=>_0xd4f153['map'](_0x37a044=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0xcd4651(0xa9)](_0x37a044))),[_0x4df09e,_0x1da4f5]=await Promise['all']([_0x43c72c,_0x18fb4f]);for(const _0x4d9e3f of _0x1da4f5){const _0x254b1e=_0x4df09e[_0xcd4651(0x85)](_0x240ad3=>_0x240ad3[_0xcd4651(0xa0)]===_0x4d9e3f['id']);_0x254b1e&&_0x261d2d[_0xcd4651(0xb2)]({'fileType':_0x254b1e[_0xcd4651(0xa3)],'fileName':_0x4d9e3f['filename'],'attachmentId':_0x254b1e['Id']});}}return _0x261d2d;}async['retrieveLastComponents'](_0x4905c4){const _0x4b379b=a242_0x13013f,_0x15c76f=await this[_0x4b379b(0xaf)](_0x4905c4);this[_0x4b379b(0x87)][_0x4b379b(0xb5)](_0x4b379b(0xb4));const _0x88362c=[];for(const _0x527dce of _0x15c76f){const _0x179ebd=await this[_0x4b379b(0x83)][_0x4b379b(0x8a)](_0x527dce['attachmentId'],!![]);_0x88362c[_0x4b379b(0xb2)]({'body':_0x179ebd['toString'](_0x4b379b(0x7c)),'fileName':_0x527dce[_0x4b379b(0x8c)],'fileType':_0x527dce['fileType']}),this[_0x4b379b(0x87)][_0x4b379b(0xb5)](_0x4b379b(0xaa),_0x88362c[_0x4b379b(0xb7)],_0x4905c4[_0x4b379b(0xb7)]);}return _0x88362c;}async[a242_0x13013f(0xb6)](_0x4f728e){const _0x47c569=a242_0x13013f,_0x457b85=[..._0x4f728e],_0x4a8e79=[],_0x548131=[];while(_0x457b85[_0x47c569(0xb7)]){const _0x14e928=_0x457b85[_0x47c569(0xac)](0x0,this[_0x47c569(0xa7)]),_0x2a4929=await this[_0x47c569(0x83)][_0x47c569(0x86)](_0x14e928);_0x14e928[_0x47c569(0xb7)]!==_0x2a4929['ids']['length']?(_0x457b85['push'](..._0x2a4929['ids']),_0x4a8e79['push'](..._0x2a4929[_0x47c569(0xb1)])):_0x548131[_0x47c569(0xb2)](..._0x14e928),this['logger'][_0x47c569(0xa8)]('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x4f728e['length']-_0x457b85[_0x47c569(0xb7)],_0x4f728e[_0x47c569(0xb7)]);}if(_0x548131[_0x47c569(0xb7)]){const _0x59153f=await this[_0x47c569(0x8f)](_0x548131);_0x4a8e79['push'](..._0x59153f);}return _0x4a8e79;}}exports[a242_0x13013f(0xa1)]=SalesforceRetrieverService;