const a281_0xe1eda6=a281_0x5607;(function(_0x378e8c,_0x5784fc){const _0xa1fdeb=a281_0x5607,_0x115ca2=_0x378e8c();while(!![]){try{const _0x149f51=parseInt(_0xa1fdeb(0x6c))/0x1*(parseInt(_0xa1fdeb(0x9a))/0x2)+-parseInt(_0xa1fdeb(0x7b))/0x3*(parseInt(_0xa1fdeb(0x88))/0x4)+-parseInt(_0xa1fdeb(0x8e))/0x5+parseInt(_0xa1fdeb(0x77))/0x6+-parseInt(_0xa1fdeb(0x93))/0x7+-parseInt(_0xa1fdeb(0x7d))/0x8*(-parseInt(_0xa1fdeb(0x76))/0x9)+parseInt(_0xa1fdeb(0x78))/0xa;if(_0x149f51===_0x5784fc)break;else _0x115ca2['push'](_0x115ca2['shift']());}catch(_0xa29390){_0x115ca2['push'](_0x115ca2['shift']());}}}(a281_0x4f19,0x8fcb1));function a281_0x5607(_0x20efe5,_0x163a5f){const _0x4fba8a=a281_0x4f19();return a281_0x5607=function(_0x5cb83a,_0x536952){_0x5cb83a=_0x5cb83a-0x6a;let _0x4f197b=_0x4fba8a[_0x5cb83a];return _0x4f197b;},a281_0x5607(_0x20efe5,_0x163a5f);}const a281_0x536952=(function(){let _0x1b2999=!![];return function(_0x527672,_0x51a51b){const _0x4b7f05=_0x1b2999?function(){const _0x260ed3=a281_0x5607;if(_0x51a51b){const _0x3b9ea6=_0x51a51b[_0x260ed3(0x75)](_0x527672,arguments);return _0x51a51b=null,_0x3b9ea6;}}:function(){};return _0x1b2999=![],_0x4b7f05;};}()),a281_0x5cb83a=a281_0x536952(this,function(){const _0x556cc8=a281_0x5607;return a281_0x5cb83a[_0x556cc8(0x96)]()[_0x556cc8(0x9b)](_0x556cc8(0x6a))[_0x556cc8(0x96)]()[_0x556cc8(0xa1)](a281_0x5cb83a)[_0x556cc8(0x9b)]('(((.+)+)+)+$');});a281_0x5cb83a();'use strict';var __importDefault=this&&this[a281_0xe1eda6(0x87)]||function(_0x5dc870){const _0xaef2ee=a281_0xe1eda6;return _0x5dc870&&_0x5dc870[_0xaef2ee(0xa0)]?_0x5dc870:{'default':_0x5dc870};};Object['defineProperty'](exports,a281_0xe1eda6(0xa0),{'value':!![]}),exports[a281_0xe1eda6(0x98)]=void 0x0;const core_1=require(a281_0xe1eda6(0x81)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a281_0xe1eda6(0x8f)),queries_1=require(a281_0xe1eda6(0x85)),flosum_component_history_dto_1=require(a281_0xe1eda6(0x7e));function a281_0x4f19(){const _0x1bb297=['default','SalesforceQueryService','Manually\x20retrieving\x20components\x20from\x20salesforce','2828565yqIpOx','./salesforce-query.service','retrieveLastComponents','salesforceService','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','7847231xXntfn','join','filename','toString','ParentId','SalesforceRetrieverService','Manually\x20retrieved\x20%d/%d\x20components','2784wOOEJF','search','retrieveComponents','retrieveComponentIdsFromHistoryIds','query','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','__esModule','constructor','(((.+)+)+)+$','logger','619BSeWAP','%parent_ids%','fileName','name','base64','all','%ids%','length','attachmentId','apply','18gPSKBG','6138966jyahHc','7358870uRBaic','replace','COMPONENTS_PER_QUERY','2527845qxOmqG','FlosumComponentHistoryDto','1990568PxHIAF','../dto/flosum-component-history.dto','retrieveAttachment','then','../../../../core','Name','find','run','../queries','Logger','__importDefault','4BBsnyR','push','info'];a281_0x4f19=function(){return _0x1bb297;};return a281_0x4f19();}class SalesforceRetrieverService{constructor(_0xc2532b){const _0x1ec035=a281_0xe1eda6;this[_0x1ec035(0x91)]=_0xc2532b,this[_0x1ec035(0x6b)]=new core_1[(_0x1ec035(0x86))](SalesforceRetrieverService[_0x1ec035(0x6f)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x1ec035(0x7a)]=0x1f4;}async[a281_0xe1eda6(0x9d)](_0xe9fcd1){const _0x4aad3c=a281_0xe1eda6;this[_0x4aad3c(0x6b)][_0x4aad3c(0x8a)](_0x4aad3c(0x9f),_0xe9fcd1['length']);const _0xeec598=typedi_1[_0x4aad3c(0x8b)]['get'](salesforce_query_service_1[_0x4aad3c(0x8c)]),_0x44dda2=_0xe9fcd1['map'](_0x49f810=>'\x27'+_0x49f810+'\x27'),_0x4b8902=[];while(_0x44dda2[_0x4aad3c(0x73)]){const _0x369808=_0x44dda2['splice'](0x0,this['COMPONENTS_PER_QUERY']),_0x3bd498=_0xeec598[_0x4aad3c(0x9e)](queries_1[_0x4aad3c(0x92)][_0x4aad3c(0x79)](_0x4aad3c(0x6d),_0x369808['join']())),_0x39c501=_0xeec598[_0x4aad3c(0x9e)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS']['replace'](_0x4aad3c(0x72),_0x369808[_0x4aad3c(0x94)]()))[_0x4aad3c(0x80)](_0x336ba4=>_0x336ba4['map'](_0x475d10=>flosum_component_history_dto_1[_0x4aad3c(0x7c)]['fromSalesforce'](_0x475d10))),[_0x27e7c3,_0x562811]=await Promise[_0x4aad3c(0x71)]([_0x3bd498,_0x39c501]);for(const _0x434e54 of _0x562811){const _0x515910=_0x27e7c3[_0x4aad3c(0x83)](_0x3d08fe=>_0x3d08fe[_0x4aad3c(0x97)]===_0x434e54['id']);_0x515910&&_0x4b8902[_0x4aad3c(0x89)]({'fileType':_0x515910[_0x4aad3c(0x82)],'fileName':_0x434e54[_0x4aad3c(0x95)],'attachmentId':_0x515910['Id']});}}return _0x4b8902;}async[a281_0xe1eda6(0x90)](_0x54e420){const _0x14013f=a281_0xe1eda6,_0x322cd4=await this[_0x14013f(0x9d)](_0x54e420);this[_0x14013f(0x6b)][_0x14013f(0x8a)](_0x14013f(0x8d));const _0x4a236e=[];for(const _0x3f2561 of _0x322cd4){const _0x55a81a=await this[_0x14013f(0x91)][_0x14013f(0x7f)](_0x3f2561[_0x14013f(0x74)],!![]);_0x4a236e['push']({'body':_0x55a81a['toString'](_0x14013f(0x70)),'fileName':_0x3f2561[_0x14013f(0x6e)],'fileType':_0x3f2561['fileType']}),this[_0x14013f(0x6b)]['info'](_0x14013f(0x99),_0x4a236e[_0x14013f(0x73)],_0x54e420['length']);}return _0x4a236e;}async[a281_0xe1eda6(0x84)](_0x4df1fb){const _0x151c5b=a281_0xe1eda6;if(!_0x4df1fb[_0x151c5b(0x73)])return[];const _0x2c0bd6=await this[_0x151c5b(0x91)][_0x151c5b(0x9c)](_0x4df1fb);return _0x2c0bd6;}}exports[a281_0xe1eda6(0x98)]=SalesforceRetrieverService;