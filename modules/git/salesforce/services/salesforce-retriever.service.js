const a242_0x936716=a242_0x4435;(function(_0x40ce15,_0x536d95){const _0x47634e=a242_0x4435,_0x21fc24=_0x40ce15();while(!![]){try{const _0x6222ce=-parseInt(_0x47634e(0xac))/0x1+parseInt(_0x47634e(0x7e))/0x2+-parseInt(_0x47634e(0x80))/0x3+-parseInt(_0x47634e(0x9c))/0x4+-parseInt(_0x47634e(0x8d))/0x5+parseInt(_0x47634e(0x95))/0x6*(-parseInt(_0x47634e(0x73))/0x7)+parseInt(_0x47634e(0xa7))/0x8;if(_0x6222ce===_0x536d95)break;else _0x21fc24['push'](_0x21fc24['shift']());}catch(_0x6d81da){_0x21fc24['push'](_0x21fc24['shift']());}}}(a242_0x180b,0xeb548));function a242_0x180b(){const _0x19397b=['logger','COMPONENTS_PER_QUERY','manually\x20retrieving\x20components\x20from\x20salesforce','then','log','41392784QyoDIM','info','fromSalesforce','get','name','1517035fyOwJb','run','7uquLsO','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','FlosumComponentHistoryDto','map','splice','base64','search','defineProperty','%ids%','ids','Name','1367698VkKizV','SalesforceQueryService','1886877ZGsAud','../../../../core','GET_COMPONENT_HISTORIES_BY_IDS','query','SalesforceRetrieverService','Logger','retrieveAttachment','fileName','retrieveLastComponents','default','ParentId','__esModule','attachmentId','7013950AcXMJI','manually\x20retrieved\x20%d/%d\x20components','push','%parent_ids%','(((.+)+)+)+$','toString','components','replace','1734774bZsTgJ','COMPONENTS_PER_REQUEST','typedi','salesforceService','retrieveComponentIdsFromHistoryIds','./salesforce-query.service','length','4224488NOcScG','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','find','retrieveComponents','__importDefault','../queries'];a242_0x180b=function(){return _0x19397b;};return a242_0x180b();}const a242_0x1faa11=(function(){let _0x27b6bc=!![];return function(_0x3d3fc7,_0x256fcc){const _0x38dd37=_0x27b6bc?function(){if(_0x256fcc){const _0x36591c=_0x256fcc['apply'](_0x3d3fc7,arguments);return _0x256fcc=null,_0x36591c;}}:function(){};return _0x27b6bc=![],_0x38dd37;};}()),a242_0x5da708=a242_0x1faa11(this,function(){const _0x27f677=a242_0x4435;return a242_0x5da708[_0x27f677(0x92)]()[_0x27f677(0x79)](_0x27f677(0x91))[_0x27f677(0x92)]()['constructor'](a242_0x5da708)[_0x27f677(0x79)]('(((.+)+)+)+$');});function a242_0x4435(_0x495f20,_0x9ac544){const _0x4f9843=a242_0x180b();return a242_0x4435=function(_0x5da708,_0x1faa11){_0x5da708=_0x5da708-0x73;let _0x180bee=_0x4f9843[_0x5da708];return _0x180bee;},a242_0x4435(_0x495f20,_0x9ac544);}a242_0x5da708();'use strict';var __importDefault=this&&this[a242_0x936716(0xa0)]||function(_0x3cb09e){const _0x33b135=a242_0x936716;return _0x3cb09e&&_0x3cb09e[_0x33b135(0x8b)]?_0x3cb09e:{'default':_0x3cb09e};};Object[a242_0x936716(0x7a)](exports,a242_0x936716(0x8b),{'value':!![]}),exports[a242_0x936716(0x84)]=void 0x0;const core_1=require(a242_0x936716(0x81)),typedi_1=__importDefault(require(a242_0x936716(0x97))),salesforce_query_service_1=require(a242_0x936716(0x9a)),queries_1=require(a242_0x936716(0xa1)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x37c75a){const _0x3680c0=a242_0x936716;this['salesforceService']=_0x37c75a,this['logger']=new core_1[(_0x3680c0(0x85))](SalesforceRetrieverService[_0x3680c0(0xab)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x3680c0(0xa3)]=0x1f4;}async[a242_0x936716(0x99)](_0xf43e75){const _0x3fbd31=a242_0x936716;this[_0x3fbd31(0xa2)]['info'](_0x3fbd31(0x74),_0xf43e75[_0x3fbd31(0x9b)]);const _0x2d590b=typedi_1[_0x3fbd31(0x89)][_0x3fbd31(0xaa)](salesforce_query_service_1[_0x3fbd31(0x7f)]),_0x4a5ec5=_0xf43e75[_0x3fbd31(0x76)](_0x3d8868=>'\x27'+_0x3d8868+'\x27'),_0xcafb37=[];while(_0x4a5ec5[_0x3fbd31(0x9b)]){const _0x1e684d=_0x4a5ec5['splice'](0x0,this[_0x3fbd31(0xa3)]),_0x2384cf=_0x2d590b[_0x3fbd31(0x83)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x3fbd31(0x94)](_0x3fbd31(0x90),_0x1e684d['join']())),_0x3cc8c6=_0x2d590b[_0x3fbd31(0x83)](queries_1[_0x3fbd31(0x82)]['replace'](_0x3fbd31(0x7b),_0x1e684d['join']()))[_0x3fbd31(0xa5)](_0x5396a0=>_0x5396a0[_0x3fbd31(0x76)](_0x4924dc=>flosum_component_history_dto_1[_0x3fbd31(0x75)][_0x3fbd31(0xa9)](_0x4924dc))),[_0x276fc1,_0x3c00b5]=await Promise['all']([_0x2384cf,_0x3cc8c6]);for(const _0xd512eb of _0x3c00b5){const _0xc46d78=_0x276fc1[_0x3fbd31(0x9e)](_0x3656f8=>_0x3656f8[_0x3fbd31(0x8a)]===_0xd512eb['id']);_0xc46d78&&_0xcafb37[_0x3fbd31(0x8f)]({'fileType':_0xc46d78[_0x3fbd31(0x7d)],'fileName':_0xd512eb['filename'],'attachmentId':_0xc46d78['Id']});}}return _0xcafb37;}async[a242_0x936716(0x88)](_0x3d3134){const _0x49508b=a242_0x936716,_0x2e4b97=await this[_0x49508b(0x99)](_0x3d3134);this['logger'][_0x49508b(0xa8)](_0x49508b(0xa4));const _0x1382e0=[];for(const _0x2efb46 of _0x2e4b97){const _0x3646bf=await this[_0x49508b(0x98)][_0x49508b(0x86)](_0x2efb46[_0x49508b(0x8c)],!![]);_0x1382e0['push']({'body':_0x3646bf[_0x49508b(0x92)](_0x49508b(0x78)),'fileName':_0x2efb46[_0x49508b(0x87)],'fileType':_0x2efb46['fileType']}),this[_0x49508b(0xa2)][_0x49508b(0xa8)](_0x49508b(0x8e),_0x1382e0[_0x49508b(0x9b)],_0x3d3134[_0x49508b(0x9b)]);}return _0x1382e0;}async[a242_0x936716(0xad)](_0x2cabaf){const _0x43fbd5=a242_0x936716,_0x39bc92=[..._0x2cabaf],_0x41e146=[],_0x3ebd93=[];while(_0x39bc92[_0x43fbd5(0x9b)]){const _0x15687c=_0x39bc92[_0x43fbd5(0x77)](0x0,this[_0x43fbd5(0x96)]),_0x5b1441=await this[_0x43fbd5(0x98)][_0x43fbd5(0x9f)](_0x15687c);_0x15687c['length']!==_0x5b1441['ids'][_0x43fbd5(0x9b)]?(_0x39bc92[_0x43fbd5(0x8f)](..._0x5b1441[_0x43fbd5(0x7c)]),_0x41e146[_0x43fbd5(0x8f)](..._0x5b1441[_0x43fbd5(0x93)])):_0x3ebd93['push'](..._0x15687c),this[_0x43fbd5(0xa2)][_0x43fbd5(0xa6)](_0x43fbd5(0x9d),_0x2cabaf[_0x43fbd5(0x9b)]-_0x39bc92[_0x43fbd5(0x9b)],_0x2cabaf[_0x43fbd5(0x9b)]);}if(_0x3ebd93[_0x43fbd5(0x9b)]){const _0x599fa1=await this[_0x43fbd5(0x88)](_0x3ebd93);_0x41e146[_0x43fbd5(0x8f)](..._0x599fa1);}return _0x41e146;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;