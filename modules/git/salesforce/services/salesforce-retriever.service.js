const a252_0x5b30a1=a252_0x933a;(function(_0x8ca008,_0x58234e){const _0x5b3eef=a252_0x933a,_0x468dc3=_0x8ca008();while(!![]){try{const _0x2ce04a=parseInt(_0x5b3eef(0x13a))/0x1+-parseInt(_0x5b3eef(0x124))/0x2+parseInt(_0x5b3eef(0x10c))/0x3*(parseInt(_0x5b3eef(0x11b))/0x4)+parseInt(_0x5b3eef(0x135))/0x5*(parseInt(_0x5b3eef(0x13f))/0x6)+-parseInt(_0x5b3eef(0x119))/0x7+-parseInt(_0x5b3eef(0x122))/0x8*(parseInt(_0x5b3eef(0x136))/0x9)+parseInt(_0x5b3eef(0x11e))/0xa*(parseInt(_0x5b3eef(0x133))/0xb);if(_0x2ce04a===_0x58234e)break;else _0x468dc3['push'](_0x468dc3['shift']());}catch(_0x44c3ab){_0x468dc3['push'](_0x468dc3['shift']());}}}(a252_0x55dc,0xc1ac8));const a252_0x2861fa=(function(){let _0x2fdaeb=!![];return function(_0x2c9859,_0x113f6b){const _0x4c91f5=_0x2fdaeb?function(){const _0xa5e57d=a252_0x933a;if(_0x113f6b){const _0x56a7c9=_0x113f6b[_0xa5e57d(0x131)](_0x2c9859,arguments);return _0x113f6b=null,_0x56a7c9;}}:function(){};return _0x2fdaeb=![],_0x4c91f5;};}()),a252_0x4cc5ce=a252_0x2861fa(this,function(){const _0x5e077b=a252_0x933a;return a252_0x4cc5ce[_0x5e077b(0x126)]()[_0x5e077b(0x10a)](_0x5e077b(0x129))[_0x5e077b(0x126)]()['constructor'](a252_0x4cc5ce)[_0x5e077b(0x10a)](_0x5e077b(0x129));});a252_0x4cc5ce();'use strict';function a252_0x933a(_0x599a73,_0x8da64b){const _0x3cee67=a252_0x55dc();return a252_0x933a=function(_0x4cc5ce,_0x2861fa){_0x4cc5ce=_0x4cc5ce-0x109;let _0x55dc08=_0x3cee67[_0x4cc5ce];return _0x55dc08;},a252_0x933a(_0x599a73,_0x8da64b);}var __importDefault=this&&this[a252_0x5b30a1(0x110)]||function(_0x300353){return _0x300353&&_0x300353['__esModule']?_0x300353:{'default':_0x300353};};function a252_0x55dc(){const _0x108e15=['SalesforceQueryService','16iSVUqP','COMPONENTS_PER_QUERY','1034210ZurpqK','components','toString','COMPONENTS_PER_REQUEST','../queries','(((.+)+)+)+$','FlosumComponentHistoryDto','push','Manually\x20retrieving\x20components\x20from\x20salesforce','retrieveComponents','name','all','query','apply','../../../../core','50083Eyeazy','replace','14785DLxmyo','5110533YGYKmQ','./salesforce-query.service','%parent_ids%','__esModule','349037qKIoIt','get','log','fileName','salesforceService','2658JDCYnx','Retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','fileType','map','Manually\x20retrieved\x20%d/%d\x20components','length','search','info','1263255CiJmWf','logger','run','GET_COMPONENT_HISTORIES_BY_IDS','__importDefault','splice','SalesforceRetrieverService','retrieveLastComponents','ParentId','Logger','join','typedi','../dto/flosum-component-history.dto','895573xokhnZ','fromSalesforce','8JaCkCY','attachmentId','%ids%','160WZdUKC','then','defineProperty'];a252_0x55dc=function(){return _0x108e15;};return a252_0x55dc();}Object[a252_0x5b30a1(0x120)](exports,a252_0x5b30a1(0x139),{'value':!![]}),exports[a252_0x5b30a1(0x112)]=void 0x0;const core_1=require(a252_0x5b30a1(0x132)),typedi_1=__importDefault(require(a252_0x5b30a1(0x117))),salesforce_query_service_1=require(a252_0x5b30a1(0x137)),queries_1=require(a252_0x5b30a1(0x128)),flosum_component_history_dto_1=require(a252_0x5b30a1(0x118));class SalesforceRetrieverService{constructor(_0x3cd6bc){const _0x5aed68=a252_0x5b30a1;this['salesforceService']=_0x3cd6bc,this[_0x5aed68(0x10d)]=new core_1[(_0x5aed68(0x115))](SalesforceRetrieverService[_0x5aed68(0x12e)]),this[_0x5aed68(0x127)]=0xbb8,this[_0x5aed68(0x123)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x1652fd){const _0x900948=a252_0x5b30a1;this[_0x900948(0x10d)][_0x900948(0x10b)]('Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)',_0x1652fd[_0x900948(0x109)]);const _0x4478b0=typedi_1['default'][_0x900948(0x13b)](salesforce_query_service_1[_0x900948(0x121)]),_0x5a71ee=_0x1652fd['map'](_0x50044e=>'\x27'+_0x50044e+'\x27'),_0x104f1e=[];while(_0x5a71ee[_0x900948(0x109)]){const _0x400780=_0x5a71ee[_0x900948(0x111)](0x0,this[_0x900948(0x123)]),_0x322829=_0x4478b0[_0x900948(0x130)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x900948(0x134)](_0x900948(0x138),_0x400780[_0x900948(0x116)]())),_0x26a000=_0x4478b0['query'](queries_1[_0x900948(0x10f)][_0x900948(0x134)](_0x900948(0x11d),_0x400780[_0x900948(0x116)]()))[_0x900948(0x11f)](_0xce4ecd=>_0xce4ecd[_0x900948(0x142)](_0x1f7113=>flosum_component_history_dto_1[_0x900948(0x12a)][_0x900948(0x11a)](_0x1f7113))),[_0x3137f2,_0x11136e]=await Promise[_0x900948(0x12f)]([_0x322829,_0x26a000]);for(const _0x4b662a of _0x11136e){const _0x8fa27=_0x3137f2['find'](_0x4d2e54=>_0x4d2e54[_0x900948(0x114)]===_0x4b662a['id']);_0x8fa27&&_0x104f1e[_0x900948(0x12b)]({'fileType':_0x8fa27['Name'],'fileName':_0x4b662a['filename'],'attachmentId':_0x8fa27['Id']});}}return _0x104f1e;}async[a252_0x5b30a1(0x113)](_0x14a02f){const _0x1009c1=a252_0x5b30a1,_0x403c09=await this['retrieveComponentIdsFromHistoryIds'](_0x14a02f);this['logger'][_0x1009c1(0x10b)](_0x1009c1(0x12c));const _0x3b98f4=[];for(const _0x57187e of _0x403c09){const _0xf24a61=await this[_0x1009c1(0x13e)]['retrieveAttachment'](_0x57187e[_0x1009c1(0x11c)],!![]);_0x3b98f4['push']({'body':_0xf24a61['toString']('base64'),'fileName':_0x57187e[_0x1009c1(0x13d)],'fileType':_0x57187e[_0x1009c1(0x141)]}),this['logger'][_0x1009c1(0x10b)](_0x1009c1(0x143),_0x3b98f4[_0x1009c1(0x109)],_0x14a02f[_0x1009c1(0x109)]);}return _0x3b98f4;}async[a252_0x5b30a1(0x10e)](_0xa1f0e4){const _0x55a592=a252_0x5b30a1,_0x14ca85=[..._0xa1f0e4],_0x578817=[],_0x2014b9=[];while(_0x14ca85['length']){const _0x21eff4=_0x14ca85['splice'](0x0,this[_0x55a592(0x127)]),_0xd3ba10=await this[_0x55a592(0x13e)][_0x55a592(0x12d)](_0x21eff4);_0x21eff4[_0x55a592(0x109)]!==_0xd3ba10['ids'][_0x55a592(0x109)]?(_0x14ca85[_0x55a592(0x12b)](..._0xd3ba10['ids']),_0x578817[_0x55a592(0x12b)](..._0xd3ba10[_0x55a592(0x125)])):_0x2014b9[_0x55a592(0x12b)](..._0x21eff4),this['logger'][_0x55a592(0x13c)](_0x55a592(0x140),_0xa1f0e4[_0x55a592(0x109)]-_0x14ca85['length'],_0xa1f0e4[_0x55a592(0x109)]);}if(_0x2014b9[_0x55a592(0x109)]){const _0x5dd4c6=await this['retrieveLastComponents'](_0x2014b9);_0x578817[_0x55a592(0x12b)](..._0x5dd4c6);}return _0x578817;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;