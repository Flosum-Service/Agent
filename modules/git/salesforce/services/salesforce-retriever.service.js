const a186_0x4c964d=a186_0x47fe;(function(_0x387f42,_0x381010){const _0x2a1f95=a186_0x47fe,_0x4ac169=_0x387f42();while(!![]){try{const _0x4b604c=-parseInt(_0x2a1f95(0x1b3))/0x1*(parseInt(_0x2a1f95(0x1c3))/0x2)+parseInt(_0x2a1f95(0x1b7))/0x3+-parseInt(_0x2a1f95(0x1db))/0x4*(-parseInt(_0x2a1f95(0x1a9))/0x5)+-parseInt(_0x2a1f95(0x1a4))/0x6*(-parseInt(_0x2a1f95(0x1ae))/0x7)+-parseInt(_0x2a1f95(0x1b5))/0x8*(-parseInt(_0x2a1f95(0x1c8))/0x9)+-parseInt(_0x2a1f95(0x1c1))/0xa*(-parseInt(_0x2a1f95(0x1b0))/0xb)+-parseInt(_0x2a1f95(0x1c0))/0xc;if(_0x4b604c===_0x381010)break;else _0x4ac169['push'](_0x4ac169['shift']());}catch(_0x248658){_0x4ac169['push'](_0x4ac169['shift']());}}}(a186_0x3e7c,0x88875));const a186_0x348965=(function(){let _0x190056=!![];return function(_0x18d01c,_0x7ef22d){const _0x167a67=_0x190056?function(){const _0x9cbf27=a186_0x47fe;if(_0x7ef22d){const _0x197d89=_0x7ef22d[_0x9cbf27(0x1d0)](_0x18d01c,arguments);return _0x7ef22d=null,_0x197d89;}}:function(){};return _0x190056=![],_0x167a67;};}()),a186_0x1a9c59=a186_0x348965(this,function(){const _0x7f6a35=a186_0x47fe;return a186_0x1a9c59[_0x7f6a35(0x1b6)]()[_0x7f6a35(0x1b8)](_0x7f6a35(0x1ab))['toString']()[_0x7f6a35(0x1ad)](a186_0x1a9c59)['search'](_0x7f6a35(0x1ab));});function a186_0x47fe(_0x5d4797,_0x176c10){const _0x5bf321=a186_0x3e7c();return a186_0x47fe=function(_0x1a9c59,_0x348965){_0x1a9c59=_0x1a9c59-0x1a1;let _0x3e7cff=_0x5bf321[_0x1a9c59];return _0x3e7cff;},a186_0x47fe(_0x5d4797,_0x176c10);}a186_0x1a9c59();function a186_0x3e7c(){const _0x2493ff=['map','4TDUuhg','salesforceService','Name','components','push','104916wjCLyY','__importDefault','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','replace','fromSalesforce','2878230vKSmRX','get','(((.+)+)+)+$','then','constructor','364oOUNjs','name','22xjyipZ','join','default','364061WmidRC','%ids%','24moTyBK','toString','3215298uRLEBM','search','Logger','query','retrieveComponents','logger','../queries','info','ids','19727292LTtGSV','947860WFUqpq','COMPONENTS_PER_REQUEST','4MlxVUV','retrieveAttachment','GET_COMPONENT_HISTORIES_BY_IDS','../dto/flosum-component-history.dto','splice','555084ulbvZo','base64','all','SalesforceQueryService','__esModule','COMPONENTS_PER_QUERY','defineProperty','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','apply','attachmentId','retrieveLastComponents','manually\x20retrieved\x20%d/%d\x20components','length','retrieveComponentIdsFromHistoryIds','./salesforce-query.service','SalesforceRetrieverService','manually\x20retrieving\x20components\x20from\x20salesforce','ParentId'];a186_0x3e7c=function(){return _0x2493ff;};return a186_0x3e7c();}'use strict';var __importDefault=this&&this[a186_0x4c964d(0x1a5)]||function(_0x37b7fa){const _0x2b2958=a186_0x4c964d;return _0x37b7fa&&_0x37b7fa[_0x2b2958(0x1cc)]?_0x37b7fa:{'default':_0x37b7fa};};Object[a186_0x4c964d(0x1ce)](exports,a186_0x4c964d(0x1cc),{'value':!![]}),exports[a186_0x4c964d(0x1d7)]=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a186_0x4c964d(0x1d6)),queries_1=require(a186_0x4c964d(0x1bd)),flosum_component_history_dto_1=require(a186_0x4c964d(0x1c6));class SalesforceRetrieverService{constructor(_0x33eaa0){const _0xb31ea1=a186_0x4c964d;this[_0xb31ea1(0x1dc)]=_0x33eaa0,this['logger']=new core_1[(_0xb31ea1(0x1b9))](SalesforceRetrieverService[_0xb31ea1(0x1af)]),this[_0xb31ea1(0x1c2)]=0xbb8,this[_0xb31ea1(0x1cd)]=0x1f4;}async[a186_0x4c964d(0x1d5)](_0x570412){const _0x5bffe4=a186_0x4c964d;this[_0x5bffe4(0x1bc)][_0x5bffe4(0x1be)](_0x5bffe4(0x1a6),_0x570412[_0x5bffe4(0x1d4)]);const _0xaced0a=typedi_1[_0x5bffe4(0x1b2)][_0x5bffe4(0x1aa)](salesforce_query_service_1[_0x5bffe4(0x1cb)]),_0x16988e=_0x570412[_0x5bffe4(0x1da)](_0x101278=>'\x27'+_0x101278+'\x27'),_0xd3396f=[];while(_0x16988e['length']){const _0x2b94ec=_0x16988e[_0x5bffe4(0x1c7)](0x0,this[_0x5bffe4(0x1cd)]),_0x11aaea=_0xaced0a[_0x5bffe4(0x1ba)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x5bffe4(0x1a7)]('%parent_ids%',_0x2b94ec[_0x5bffe4(0x1b1)]())),_0x165694=_0xaced0a[_0x5bffe4(0x1ba)](queries_1[_0x5bffe4(0x1c5)][_0x5bffe4(0x1a7)](_0x5bffe4(0x1b4),_0x2b94ec[_0x5bffe4(0x1b1)]()))[_0x5bffe4(0x1ac)](_0x380f9d=>_0x380f9d[_0x5bffe4(0x1da)](_0x580ec1=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0x5bffe4(0x1a8)](_0x580ec1))),[_0x1f58e8,_0x21439a]=await Promise[_0x5bffe4(0x1ca)]([_0x11aaea,_0x165694]);for(const _0x5eb7af of _0x21439a){const _0x4fec3e=_0x1f58e8['find'](_0x1b02b7=>_0x1b02b7[_0x5bffe4(0x1d9)]===_0x5eb7af['id']);_0x4fec3e&&_0xd3396f[_0x5bffe4(0x1a3)]({'fileType':_0x4fec3e[_0x5bffe4(0x1a1)],'fileName':_0x5eb7af['filename'],'attachmentId':_0x4fec3e['Id']});}}return _0xd3396f;}async[a186_0x4c964d(0x1d2)](_0x56b9aa){const _0x301f87=a186_0x4c964d,_0xa61a32=await this[_0x301f87(0x1d5)](_0x56b9aa);this[_0x301f87(0x1bc)]['info'](_0x301f87(0x1d8));const _0x3e242e=[];for(const _0x446cf2 of _0xa61a32){const _0x4549f0=await this['salesforceService'][_0x301f87(0x1c4)](_0x446cf2[_0x301f87(0x1d1)],!![]);_0x3e242e[_0x301f87(0x1a3)]({'body':_0x4549f0['toString'](_0x301f87(0x1c9)),'fileName':_0x446cf2['fileName'],'fileType':_0x446cf2['fileType']}),this[_0x301f87(0x1bc)][_0x301f87(0x1be)](_0x301f87(0x1d3),_0x3e242e[_0x301f87(0x1d4)],_0x56b9aa['length']);}return _0x3e242e;}async['run'](_0x3264c3){const _0x4c42c7=a186_0x4c964d,_0x214f08=[..._0x3264c3],_0x3bad05=[],_0x50a59d=[];while(_0x214f08[_0x4c42c7(0x1d4)]){const _0x57ed09=_0x214f08[_0x4c42c7(0x1c7)](0x0,this[_0x4c42c7(0x1c2)]),_0x410c0f=await this[_0x4c42c7(0x1dc)][_0x4c42c7(0x1bb)](_0x57ed09);_0x57ed09[_0x4c42c7(0x1d4)]!==_0x410c0f['ids'][_0x4c42c7(0x1d4)]?(_0x214f08[_0x4c42c7(0x1a3)](..._0x410c0f[_0x4c42c7(0x1bf)]),_0x3bad05[_0x4c42c7(0x1a3)](..._0x410c0f[_0x4c42c7(0x1a2)])):_0x50a59d[_0x4c42c7(0x1a3)](..._0x57ed09),this[_0x4c42c7(0x1bc)]['log'](_0x4c42c7(0x1cf),_0x3264c3[_0x4c42c7(0x1d4)]-_0x214f08['length'],_0x3264c3[_0x4c42c7(0x1d4)]);}if(_0x50a59d[_0x4c42c7(0x1d4)]){const _0x3a9870=await this[_0x4c42c7(0x1d2)](_0x50a59d);_0x3bad05[_0x4c42c7(0x1a3)](..._0x3a9870);}return _0x3bad05;}}exports[a186_0x4c964d(0x1d7)]=SalesforceRetrieverService;