const a236_0x32d07c=a236_0x5d6f;(function(_0x4c853c,_0x11f20a){const _0x31ea4d=a236_0x5d6f,_0x165c70=_0x4c853c();while(!![]){try{const _0x46bf30=-parseInt(_0x31ea4d(0x1fc))/0x1*(parseInt(_0x31ea4d(0x224))/0x2)+parseInt(_0x31ea4d(0x21f))/0x3*(-parseInt(_0x31ea4d(0x226))/0x4)+-parseInt(_0x31ea4d(0x21d))/0x5*(-parseInt(_0x31ea4d(0x221))/0x6)+parseInt(_0x31ea4d(0x215))/0x7*(-parseInt(_0x31ea4d(0x202))/0x8)+-parseInt(_0x31ea4d(0x214))/0x9*(-parseInt(_0x31ea4d(0x217))/0xa)+parseInt(_0x31ea4d(0x211))/0xb*(parseInt(_0x31ea4d(0x1ed))/0xc)+-parseInt(_0x31ea4d(0x1f0))/0xd*(parseInt(_0x31ea4d(0x20d))/0xe);if(_0x46bf30===_0x11f20a)break;else _0x165c70['push'](_0x165c70['shift']());}catch(_0x20cc23){_0x165c70['push'](_0x165c70['shift']());}}}(a236_0x22f6,0x5b441));const a236_0x2238f0=(function(){let _0x51b5a7=!![];return function(_0x192e6f,_0xe28813){const _0x54f1ca=_0x51b5a7?function(){const _0x40de67=a236_0x5d6f;if(_0xe28813){const _0xf85708=_0xe28813[_0x40de67(0x1fb)](_0x192e6f,arguments);return _0xe28813=null,_0xf85708;}}:function(){};return _0x51b5a7=![],_0x54f1ca;};}()),a236_0x53bde3=a236_0x2238f0(this,function(){const _0x12c57a=a236_0x5d6f;return a236_0x53bde3[_0x12c57a(0x220)]()[_0x12c57a(0x200)](_0x12c57a(0x21a))[_0x12c57a(0x220)]()[_0x12c57a(0x203)](a236_0x53bde3)['search'](_0x12c57a(0x21a));});function a236_0x5d6f(_0x241610,_0x4c2ab2){const _0x22f8df=a236_0x22f6();return a236_0x5d6f=function(_0x53bde3,_0x2238f0){_0x53bde3=_0x53bde3-0x1e9;let _0x22f628=_0x22f8df[_0x53bde3];return _0x22f628;},a236_0x5d6f(_0x241610,_0x4c2ab2);}a236_0x53bde3();'use strict';var __importDefault=this&&this[a236_0x32d07c(0x209)]||function(_0x2175d1){const _0x3361fd=a236_0x32d07c;return _0x2175d1&&_0x2175d1[_0x3361fd(0x1f9)]?_0x2175d1:{'default':_0x2175d1};};Object[a236_0x32d07c(0x207)](exports,a236_0x32d07c(0x1f9),{'value':!![]}),exports[a236_0x32d07c(0x1ff)]=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a236_0x32d07c(0x1f6)),queries_1=require('../queries'),flosum_component_history_dto_1=require(a236_0x32d07c(0x20c));function a236_0x22f6(){const _0x2ec655=['7MDAsav','join','14270xpSEnO','length','manually\x20retrieving\x20components\x20from\x20salesforce','(((.+)+)+)+$','retrieveAttachment','push','9935zWEryZ','filename','296220TkdJRI','toString','1506CXhsAA','FlosumComponentHistoryDto','query','87410ribjUX','splice','16JvHwjf','retrieveLastComponents','fileType','replace','%ids%','3036TFfGDr','components','fromSalesforce','689lbislR','base64','name','retrieveComponentIdsFromHistoryIds','COMPONENTS_PER_QUERY','Name','./salesforce-query.service','attachmentId','COMPONENTS_PER_REQUEST','__esModule','then','apply','1mGUyQH','info','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','SalesforceRetrieverService','search','salesforceService','4513072FlsfIz','constructor','ids','all','run','defineProperty','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','__importDefault','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','%parent_ids%','../dto/flosum-component-history.dto','140084ISznCg','logger','find','manually\x20retrieved\x20%d/%d\x20components','32252uPZcGI','log','map','4203dpLhKk'];a236_0x22f6=function(){return _0x2ec655;};return a236_0x22f6();}class SalesforceRetrieverService{constructor(_0x4b4f6e){const _0x2ce6ca=a236_0x32d07c;this[_0x2ce6ca(0x201)]=_0x4b4f6e,this['logger']=new core_1['Logger'](SalesforceRetrieverService[_0x2ce6ca(0x1f2)]),this[_0x2ce6ca(0x1f8)]=0xbb8,this[_0x2ce6ca(0x1f4)]=0x1f4;}async[a236_0x32d07c(0x1f3)](_0x583dd4){const _0x48f8b0=a236_0x32d07c;this[_0x48f8b0(0x20e)][_0x48f8b0(0x1fd)](_0x48f8b0(0x1fe),_0x583dd4[_0x48f8b0(0x218)]);const _0x244158=typedi_1['default']['get'](salesforce_query_service_1['SalesforceQueryService']),_0xa6b186=_0x583dd4['map'](_0x1a4b36=>'\x27'+_0x1a4b36+'\x27'),_0x3c7ceb=[];while(_0xa6b186['length']){const _0x4fdae5=_0xa6b186['splice'](0x0,this[_0x48f8b0(0x1f4)]),_0x25a0a3=_0x244158[_0x48f8b0(0x223)](queries_1[_0x48f8b0(0x208)][_0x48f8b0(0x1eb)](_0x48f8b0(0x20b),_0x4fdae5[_0x48f8b0(0x216)]())),_0x22410c=_0x244158['query'](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x48f8b0(0x1eb)](_0x48f8b0(0x1ec),_0x4fdae5[_0x48f8b0(0x216)]()))[_0x48f8b0(0x1fa)](_0x12ed16=>_0x12ed16[_0x48f8b0(0x213)](_0x36903d=>flosum_component_history_dto_1[_0x48f8b0(0x222)][_0x48f8b0(0x1ef)](_0x36903d))),[_0x58a08a,_0x57af19]=await Promise[_0x48f8b0(0x205)]([_0x25a0a3,_0x22410c]);for(const _0x4609f7 of _0x57af19){const _0x3ef90c=_0x58a08a[_0x48f8b0(0x20f)](_0x53de9c=>_0x53de9c['ParentId']===_0x4609f7['id']);_0x3ef90c&&_0x3c7ceb[_0x48f8b0(0x21c)]({'fileType':_0x3ef90c[_0x48f8b0(0x1f5)],'fileName':_0x4609f7[_0x48f8b0(0x21e)],'attachmentId':_0x3ef90c['Id']});}}return _0x3c7ceb;}async[a236_0x32d07c(0x1e9)](_0x10044a){const _0x8b638a=a236_0x32d07c,_0x35fcad=await this[_0x8b638a(0x1f3)](_0x10044a);this[_0x8b638a(0x20e)][_0x8b638a(0x1fd)](_0x8b638a(0x219));const _0x11fc72=[];for(const _0x1c575a of _0x35fcad){const _0x3c05ff=await this[_0x8b638a(0x201)][_0x8b638a(0x21b)](_0x1c575a[_0x8b638a(0x1f7)],!![]);_0x11fc72[_0x8b638a(0x21c)]({'body':_0x3c05ff[_0x8b638a(0x220)](_0x8b638a(0x1f1)),'fileName':_0x1c575a['fileName'],'fileType':_0x1c575a[_0x8b638a(0x1ea)]}),this['logger'][_0x8b638a(0x1fd)](_0x8b638a(0x210),_0x11fc72[_0x8b638a(0x218)],_0x10044a[_0x8b638a(0x218)]);}return _0x11fc72;}async[a236_0x32d07c(0x206)](_0x5ed0d7){const _0x88d3e4=a236_0x32d07c,_0x2fd2dd=[..._0x5ed0d7],_0x3408b5=[],_0x339241=[];while(_0x2fd2dd[_0x88d3e4(0x218)]){const _0xc3153a=_0x2fd2dd[_0x88d3e4(0x225)](0x0,this[_0x88d3e4(0x1f8)]),_0x696dc9=await this[_0x88d3e4(0x201)]['retrieveComponents'](_0xc3153a);_0xc3153a[_0x88d3e4(0x218)]!==_0x696dc9[_0x88d3e4(0x204)][_0x88d3e4(0x218)]?(_0x2fd2dd[_0x88d3e4(0x21c)](..._0x696dc9[_0x88d3e4(0x204)]),_0x3408b5[_0x88d3e4(0x21c)](..._0x696dc9[_0x88d3e4(0x1ee)])):_0x339241[_0x88d3e4(0x21c)](..._0xc3153a),this[_0x88d3e4(0x20e)][_0x88d3e4(0x212)](_0x88d3e4(0x20a),_0x5ed0d7['length']-_0x2fd2dd['length'],_0x5ed0d7[_0x88d3e4(0x218)]);}if(_0x339241['length']){const _0x4d4ecc=await this[_0x88d3e4(0x1e9)](_0x339241);_0x3408b5[_0x88d3e4(0x21c)](..._0x4d4ecc);}return _0x3408b5;}}exports[a236_0x32d07c(0x1ff)]=SalesforceRetrieverService;