const a279_0xa8dce=a279_0x5476;function a279_0x28fe(){const _0x34dada=['Manually\x20retrieving\x20components\x20from\x20salesforce','retrieveComponentIdsFromHistoryIds','11EIQJvP','then','4ituPKA','__importDefault','928lHTnCz','info','COMPONENTS_PER_REQUEST','Name','constructor','COMPONENTS_PER_QUERY','salesforceService','map','70OPUdmG','fileName','GET_COMPONENT_HISTORIES_BY_IDS','SalesforceRetrieverService','push','%parent_ids%','15723rvCOpY','./salesforce-query.service','join','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','157827PiWCfP','retrieveLastComponents','logger','defineProperty','58748fgaXKb','search','fileType','../dto/flosum-component-history.dto','325092CxmMJq','attachmentId','default','Manually\x20retrieved\x20%d/%d\x20components','%ids%','3068028NyJFfo','ParentId','replace','FlosumComponentHistoryDto','SalesforceQueryService','129290AtFpaL','typedi','find','(((.+)+)+)+$','length','run','toString','534tDethY','retrieveComponents','17213gmddkA','__esModule','retrieveAttachment','filename','../../../../core','base64'];a279_0x28fe=function(){return _0x34dada;};return a279_0x28fe();}(function(_0x50bca1,_0x19d7b3){const _0x55a4d0=a279_0x5476,_0x3983d4=_0x50bca1();while(!![]){try{const _0x5fda=-parseInt(_0x55a4d0(0x96))/0x1+parseInt(_0x55a4d0(0xbb))/0x2*(parseInt(_0x55a4d0(0x9e))/0x3)+-parseInt(_0x55a4d0(0x9a))/0x4*(parseInt(_0x55a4d0(0x8c))/0x5)+parseInt(_0x55a4d0(0xaf))/0x6*(parseInt(_0x55a4d0(0xb1))/0x7)+parseInt(_0x55a4d0(0xbd))/0x8*(-parseInt(_0x55a4d0(0x92))/0x9)+-parseInt(_0x55a4d0(0xa8))/0xa+parseInt(_0x55a4d0(0xb9))/0xb*(parseInt(_0x55a4d0(0xa3))/0xc);if(_0x5fda===_0x19d7b3)break;else _0x3983d4['push'](_0x3983d4['shift']());}catch(_0x5ea39c){_0x3983d4['push'](_0x3983d4['shift']());}}}(a279_0x28fe,0x1b65e));const a279_0x15ca0e=(function(){let _0x406678=!![];return function(_0x24f559,_0x470d4d){const _0x504239=_0x406678?function(){if(_0x470d4d){const _0x397c90=_0x470d4d['apply'](_0x24f559,arguments);return _0x470d4d=null,_0x397c90;}}:function(){};return _0x406678=![],_0x504239;};}()),a279_0x2f134e=a279_0x15ca0e(this,function(){const _0x490654=a279_0x5476;return a279_0x2f134e[_0x490654(0xae)]()[_0x490654(0x9b)](_0x490654(0xab))[_0x490654(0xae)]()[_0x490654(0xc1)](a279_0x2f134e)['search'](_0x490654(0xab));});function a279_0x5476(_0xe32eeb,_0x396f4a){const _0x5e3866=a279_0x28fe();return a279_0x5476=function(_0x2f134e,_0x15ca0e){_0x2f134e=_0x2f134e-0x8b;let _0x28fe91=_0x5e3866[_0x2f134e];return _0x28fe91;},a279_0x5476(_0xe32eeb,_0x396f4a);}a279_0x2f134e();'use strict';var __importDefault=this&&this[a279_0xa8dce(0xbc)]||function(_0x2d7940){const _0x19e333=a279_0xa8dce;return _0x2d7940&&_0x2d7940[_0x19e333(0xb2)]?_0x2d7940:{'default':_0x2d7940};};Object[a279_0xa8dce(0x99)](exports,a279_0xa8dce(0xb2),{'value':!![]}),exports[a279_0xa8dce(0x8f)]=void 0x0;const core_1=require(a279_0xa8dce(0xb5)),typedi_1=__importDefault(require(a279_0xa8dce(0xa9))),salesforce_query_service_1=require(a279_0xa8dce(0x93)),queries_1=require('../queries'),flosum_component_history_dto_1=require(a279_0xa8dce(0x9d));class SalesforceRetrieverService{constructor(_0x1fd292){const _0x82d62=a279_0xa8dce;this[_0x82d62(0xc3)]=_0x1fd292,this[_0x82d62(0x98)]=new core_1['Logger'](SalesforceRetrieverService['name']),this[_0x82d62(0xbf)]=0xbb8,this[_0x82d62(0xc2)]=0x1f4;}async[a279_0xa8dce(0xb8)](_0x1673c4){const _0x2bf63f=a279_0xa8dce;this['logger'][_0x2bf63f(0xbe)](_0x2bf63f(0x95),_0x1673c4[_0x2bf63f(0xac)]);const _0x263af4=typedi_1[_0x2bf63f(0xa0)]['get'](salesforce_query_service_1[_0x2bf63f(0xa7)]),_0x3f2378=_0x1673c4['map'](_0x28df8f=>'\x27'+_0x28df8f+'\x27'),_0x196bb1=[];while(_0x3f2378[_0x2bf63f(0xac)]){const _0x3a7db7=_0x3f2378['splice'](0x0,this['COMPONENTS_PER_QUERY']),_0x50f786=_0x263af4['query'](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x2bf63f(0xa5)](_0x2bf63f(0x91),_0x3a7db7[_0x2bf63f(0x94)]())),_0xcf26fe=_0x263af4['query'](queries_1[_0x2bf63f(0x8e)][_0x2bf63f(0xa5)](_0x2bf63f(0xa2),_0x3a7db7[_0x2bf63f(0x94)]()))[_0x2bf63f(0xba)](_0x9fd3df=>_0x9fd3df[_0x2bf63f(0x8b)](_0x35a7bf=>flosum_component_history_dto_1[_0x2bf63f(0xa6)]['fromSalesforce'](_0x35a7bf))),[_0x2d1bc4,_0x280729]=await Promise['all']([_0x50f786,_0xcf26fe]);for(const _0x41a342 of _0x280729){const _0x2609f8=_0x2d1bc4[_0x2bf63f(0xaa)](_0x3b7e94=>_0x3b7e94[_0x2bf63f(0xa4)]===_0x41a342['id']);_0x2609f8&&_0x196bb1[_0x2bf63f(0x90)]({'fileType':_0x2609f8[_0x2bf63f(0xc0)],'fileName':_0x41a342[_0x2bf63f(0xb4)],'attachmentId':_0x2609f8['Id']});}}return _0x196bb1;}async[a279_0xa8dce(0x97)](_0x373150){const _0x2b3e48=a279_0xa8dce,_0x284516=await this[_0x2b3e48(0xb8)](_0x373150);this['logger'][_0x2b3e48(0xbe)](_0x2b3e48(0xb7));const _0xf88ace=[];for(const _0x30762b of _0x284516){const _0x49c5e6=await this[_0x2b3e48(0xc3)][_0x2b3e48(0xb3)](_0x30762b[_0x2b3e48(0x9f)],!![]);_0xf88ace['push']({'body':_0x49c5e6[_0x2b3e48(0xae)](_0x2b3e48(0xb6)),'fileName':_0x30762b[_0x2b3e48(0x8d)],'fileType':_0x30762b[_0x2b3e48(0x9c)]}),this[_0x2b3e48(0x98)][_0x2b3e48(0xbe)](_0x2b3e48(0xa1),_0xf88ace['length'],_0x373150[_0x2b3e48(0xac)]);}return _0xf88ace;}async[a279_0xa8dce(0xad)](_0x112c59){const _0x4e7695=a279_0xa8dce;if(!_0x112c59[_0x4e7695(0xac)])return[];const _0x40d75b=await this[_0x4e7695(0xc3)][_0x4e7695(0xb0)](_0x112c59);return _0x40d75b;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;