const a279_0x12003c=a279_0x58e0;(function(_0x53ad3d,_0x3444ef){const _0x8c8b7b=a279_0x58e0,_0x24598c=_0x53ad3d();while(!![]){try{const _0x236391=parseInt(_0x8c8b7b(0x1fa))/0x1+-parseInt(_0x8c8b7b(0x1e4))/0x2+-parseInt(_0x8c8b7b(0x1e8))/0x3*(-parseInt(_0x8c8b7b(0x1d8))/0x4)+parseInt(_0x8c8b7b(0x1cd))/0x5*(parseInt(_0x8c8b7b(0x1c6))/0x6)+-parseInt(_0x8c8b7b(0x1fb))/0x7+parseInt(_0x8c8b7b(0x1e9))/0x8+parseInt(_0x8c8b7b(0x1d2))/0x9*(parseInt(_0x8c8b7b(0x1f6))/0xa);if(_0x236391===_0x3444ef)break;else _0x24598c['push'](_0x24598c['shift']());}catch(_0xaa5750){_0x24598c['push'](_0x24598c['shift']());}}}(a279_0x1e17,0x233cc));const a279_0x44da3d=(function(){let _0x5a0805=!![];return function(_0x4d7b53,_0xff8739){const _0x5cb6c0=_0x5a0805?function(){const _0x38b1b6=a279_0x58e0;if(_0xff8739){const _0x5bcb6e=_0xff8739[_0x38b1b6(0x1e1)](_0x4d7b53,arguments);return _0xff8739=null,_0x5bcb6e;}}:function(){};return _0x5a0805=![],_0x5cb6c0;};}()),a279_0x5b0a3b=a279_0x44da3d(this,function(){const _0x88b010=a279_0x58e0;return a279_0x5b0a3b[_0x88b010(0x1c7)]()[_0x88b010(0x1e0)](_0x88b010(0x1fd))[_0x88b010(0x1c7)]()[_0x88b010(0x1ec)](a279_0x5b0a3b)['search']('(((.+)+)+)+$');});a279_0x5b0a3b();'use strict';function a279_0x58e0(_0xb88606,_0x2c978e){const _0x38614a=a279_0x1e17();return a279_0x58e0=function(_0x5b0a3b,_0x44da3d){_0x5b0a3b=_0x5b0a3b-0x1c6;let _0x1e1748=_0x38614a[_0x5b0a3b];return _0x1e1748;},a279_0x58e0(_0xb88606,_0x2c978e);}var __importDefault=this&&this[a279_0x12003c(0x1f9)]||function(_0x1a6156){const _0xf9265=a279_0x12003c;return _0x1a6156&&_0x1a6156[_0xf9265(0x1f2)]?_0x1a6156:{'default':_0x1a6156};};function a279_0x1e17(){const _0x2bf761=['../queries','Manually\x20retrieved\x20%d/%d\x20components','search','apply','COMPONENTS_PER_QUERY','Logger','486066TngbCw','%parent_ids%','Name','filename','2952MEXIXL','552056FvCVLO','find','query','constructor','Manually\x20retrieving\x20components\x20from\x20salesforce','base64','map','fileType','ParentId','__esModule','join','logger','retrieveComponentIdsFromHistoryIds','10JJSQoI','./salesforce-query.service','fileName','__importDefault','6057UbcugJ','1525580xeRhpD','retrieveAttachment','(((.+)+)+)+$','54hwvGdZ','toString','GET_COMPONENT_HISTORIES_BY_IDS','then','COMPONENTS_PER_REQUEST','length','retrieveComponents','64565cWzGkO','SalesforceRetrieverService','%ids%','../../../../core','replace','1175688elstEL','FlosumComponentHistoryDto','all','get','splice','salesforceService','1152WtdMIP','push','SalesforceQueryService','attachmentId','default','info'];a279_0x1e17=function(){return _0x2bf761;};return a279_0x1e17();}Object['defineProperty'](exports,a279_0x12003c(0x1f2),{'value':!![]}),exports[a279_0x12003c(0x1ce)]=void 0x0;const core_1=require(a279_0x12003c(0x1d0)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a279_0x12003c(0x1f7)),queries_1=require(a279_0x12003c(0x1de)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x3c8458){const _0x103fe2=a279_0x12003c;this[_0x103fe2(0x1d7)]=_0x3c8458,this['logger']=new core_1[(_0x103fe2(0x1e3))](SalesforceRetrieverService['name']),this[_0x103fe2(0x1ca)]=0xbb8,this[_0x103fe2(0x1e2)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0xc111fd){const _0x4af088=a279_0x12003c;this['logger'][_0x4af088(0x1dd)]('Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)',_0xc111fd['length']);const _0x1c2ffa=typedi_1[_0x4af088(0x1dc)][_0x4af088(0x1d5)](salesforce_query_service_1[_0x4af088(0x1da)]),_0x3fd87a=_0xc111fd[_0x4af088(0x1ef)](_0x387eaf=>'\x27'+_0x387eaf+'\x27'),_0x86a909=[];while(_0x3fd87a[_0x4af088(0x1cb)]){const _0x16799f=_0x3fd87a[_0x4af088(0x1d6)](0x0,this[_0x4af088(0x1e2)]),_0x241a40=_0x1c2ffa[_0x4af088(0x1eb)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x4af088(0x1d1)](_0x4af088(0x1e5),_0x16799f[_0x4af088(0x1f3)]())),_0x16cab8=_0x1c2ffa['query'](queries_1[_0x4af088(0x1c8)][_0x4af088(0x1d1)](_0x4af088(0x1cf),_0x16799f[_0x4af088(0x1f3)]()))[_0x4af088(0x1c9)](_0x33b20f=>_0x33b20f['map'](_0x2ab801=>flosum_component_history_dto_1[_0x4af088(0x1d3)]['fromSalesforce'](_0x2ab801))),[_0x3c7b06,_0x5a8c65]=await Promise[_0x4af088(0x1d4)]([_0x241a40,_0x16cab8]);for(const _0x429897 of _0x5a8c65){const _0x45f99b=_0x3c7b06[_0x4af088(0x1ea)](_0x44d8dd=>_0x44d8dd[_0x4af088(0x1f1)]===_0x429897['id']);_0x45f99b&&_0x86a909[_0x4af088(0x1d9)]({'fileType':_0x45f99b[_0x4af088(0x1e6)],'fileName':_0x429897[_0x4af088(0x1e7)],'attachmentId':_0x45f99b['Id']});}}return _0x86a909;}async['retrieveLastComponents'](_0x402cbe){const _0x348844=a279_0x12003c,_0x270515=await this[_0x348844(0x1f5)](_0x402cbe);this[_0x348844(0x1f4)][_0x348844(0x1dd)](_0x348844(0x1ed));const _0x396cbd=[];for(const _0x5e336c of _0x270515){const _0x443684=await this['salesforceService'][_0x348844(0x1fc)](_0x5e336c[_0x348844(0x1db)],!![]);_0x396cbd['push']({'body':_0x443684[_0x348844(0x1c7)](_0x348844(0x1ee)),'fileName':_0x5e336c[_0x348844(0x1f8)],'fileType':_0x5e336c[_0x348844(0x1f0)]}),this['logger'][_0x348844(0x1dd)](_0x348844(0x1df),_0x396cbd['length'],_0x402cbe[_0x348844(0x1cb)]);}return _0x396cbd;}async['run'](_0x5af012){const _0x1efee6=a279_0x12003c;if(!_0x5af012['length'])return[];const _0x9f1b53=await this[_0x1efee6(0x1d7)][_0x1efee6(0x1cc)](_0x5af012);return _0x9f1b53;}}exports[a279_0x12003c(0x1ce)]=SalesforceRetrieverService;