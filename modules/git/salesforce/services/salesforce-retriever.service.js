function a242_0x1ca9(_0x2719ef,_0x2fb95e){const _0x381694=a242_0x4a44();return a242_0x1ca9=function(_0x277284,_0x57ed44){_0x277284=_0x277284-0x1d4;let _0x4a447c=_0x381694[_0x277284];return _0x4a447c;},a242_0x1ca9(_0x2719ef,_0x2fb95e);}const a242_0x57695a=a242_0x1ca9;(function(_0x118c20,_0x49bb73){const _0x5a0c9d=a242_0x1ca9,_0x18c017=_0x118c20();while(!![]){try{const _0x1cc43f=parseInt(_0x5a0c9d(0x20c))/0x1+parseInt(_0x5a0c9d(0x1fe))/0x2*(parseInt(_0x5a0c9d(0x1f1))/0x3)+-parseInt(_0x5a0c9d(0x1ec))/0x4*(parseInt(_0x5a0c9d(0x1fa))/0x5)+-parseInt(_0x5a0c9d(0x1e6))/0x6+-parseInt(_0x5a0c9d(0x20b))/0x7*(parseInt(_0x5a0c9d(0x1dd))/0x8)+-parseInt(_0x5a0c9d(0x1fd))/0x9*(parseInt(_0x5a0c9d(0x1d5))/0xa)+-parseInt(_0x5a0c9d(0x1d8))/0xb*(-parseInt(_0x5a0c9d(0x1d4))/0xc);if(_0x1cc43f===_0x49bb73)break;else _0x18c017['push'](_0x18c017['shift']());}catch(_0x2097d9){_0x18c017['push'](_0x18c017['shift']());}}}(a242_0x4a44,0x5f140));const a242_0x57ed44=(function(){let _0x30095d=!![];return function(_0x17a2d5,_0x4cc11c){const _0x53fdd3=_0x30095d?function(){if(_0x4cc11c){const _0x28b5c9=_0x4cc11c['apply'](_0x17a2d5,arguments);return _0x4cc11c=null,_0x28b5c9;}}:function(){};return _0x30095d=![],_0x53fdd3;};}()),a242_0x277284=a242_0x57ed44(this,function(){const _0x31cd07=a242_0x1ca9;return a242_0x277284[_0x31cd07(0x1e4)]()[_0x31cd07(0x1e1)]('(((.+)+)+)+$')[_0x31cd07(0x1e4)]()[_0x31cd07(0x1f5)](a242_0x277284)[_0x31cd07(0x1e1)](_0x31cd07(0x200));});a242_0x277284();'use strict';var __importDefault=this&&this[a242_0x57695a(0x1e0)]||function(_0x321b84){const _0x4db47c=a242_0x57695a;return _0x321b84&&_0x321b84[_0x4db47c(0x1e9)]?_0x321b84:{'default':_0x321b84};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a242_0x57695a(0x1f6)]=void 0x0;const core_1=require(a242_0x57695a(0x1f8)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a242_0x57695a(0x1ed)),queries_1=require(a242_0x57695a(0x1e2)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');function a242_0x4a44(){const _0x28c583=['__esModule','components','GET_COMPONENT_HISTORIES_BY_IDS','452FJHDpO','./salesforce-query.service','ParentId','name','push','9JGArai','retrieveComponentIdsFromHistoryIds','fileName','retrieveComponents','constructor','SalesforceRetrieverService','filename','../../../../core','default','23875fzVXFK','splice','replace','9eHFIjz','385808OoCIjQ','retrieveLastComponents','(((.+)+)+)+$','query','log','ids','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','FlosumComponentHistoryDto','%ids%','logger','COMPONENTS_PER_REQUEST','get','salesforceService','189UwMTVW','470548RRVNqt','base64','fileType','36VKyDZg','219430FPeJFP','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','then','1888172pPoYVw','COMPONENTS_PER_QUERY','retrieveAttachment','join','manually\x20retrieving\x20components\x20from\x20salesforce','44872trJnRz','all','length','__importDefault','search','../queries','Name','toString','map','2770890qFVNHr','Logger','info'];a242_0x4a44=function(){return _0x28c583;};return a242_0x4a44();}class SalesforceRetrieverService{constructor(_0x5e29b5){const _0x399088=a242_0x57695a;this[_0x399088(0x20a)]=_0x5e29b5,this[_0x399088(0x207)]=new core_1[(_0x399088(0x1e7))](SalesforceRetrieverService[_0x399088(0x1ef)]),this[_0x399088(0x208)]=0xbb8,this[_0x399088(0x1d9)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x3e9a68){const _0x214621=a242_0x57695a;this[_0x214621(0x207)]['info'](_0x214621(0x1d6),_0x3e9a68[_0x214621(0x1df)]);const _0x38d069=typedi_1[_0x214621(0x1f9)][_0x214621(0x209)](salesforce_query_service_1['SalesforceQueryService']),_0x20e785=_0x3e9a68[_0x214621(0x1e5)](_0x283c20=>'\x27'+_0x283c20+'\x27'),_0x58a331=[];while(_0x20e785[_0x214621(0x1df)]){const _0x482774=_0x20e785[_0x214621(0x1fb)](0x0,this['COMPONENTS_PER_QUERY']),_0x5c17fc=_0x38d069[_0x214621(0x201)](queries_1[_0x214621(0x204)][_0x214621(0x1fc)]('%parent_ids%',_0x482774[_0x214621(0x1db)]())),_0xd08632=_0x38d069[_0x214621(0x201)](queries_1[_0x214621(0x1eb)][_0x214621(0x1fc)](_0x214621(0x206),_0x482774['join']()))[_0x214621(0x1d7)](_0x35c312=>_0x35c312['map'](_0x37c767=>flosum_component_history_dto_1[_0x214621(0x205)]['fromSalesforce'](_0x37c767))),[_0x2111a8,_0x5ab0dd]=await Promise[_0x214621(0x1de)]([_0x5c17fc,_0xd08632]);for(const _0x122aae of _0x5ab0dd){const _0x4f5f49=_0x2111a8['find'](_0x1dbd33=>_0x1dbd33[_0x214621(0x1ee)]===_0x122aae['id']);_0x4f5f49&&_0x58a331[_0x214621(0x1f0)]({'fileType':_0x4f5f49[_0x214621(0x1e3)],'fileName':_0x122aae[_0x214621(0x1f7)],'attachmentId':_0x4f5f49['Id']});}}return _0x58a331;}async[a242_0x57695a(0x1ff)](_0x33150f){const _0x32ff0f=a242_0x57695a,_0x1df755=await this[_0x32ff0f(0x1f2)](_0x33150f);this[_0x32ff0f(0x207)][_0x32ff0f(0x1e8)](_0x32ff0f(0x1dc));const _0x4b1e91=[];for(const _0x169f27 of _0x1df755){const _0x1777e4=await this[_0x32ff0f(0x20a)][_0x32ff0f(0x1da)](_0x169f27['attachmentId'],!![]);_0x4b1e91[_0x32ff0f(0x1f0)]({'body':_0x1777e4[_0x32ff0f(0x1e4)](_0x32ff0f(0x20d)),'fileName':_0x169f27[_0x32ff0f(0x1f3)],'fileType':_0x169f27[_0x32ff0f(0x20e)]}),this['logger'][_0x32ff0f(0x1e8)]('manually\x20retrieved\x20%d/%d\x20components',_0x4b1e91[_0x32ff0f(0x1df)],_0x33150f['length']);}return _0x4b1e91;}async['run'](_0x3dbca0){const _0x37a7ae=a242_0x57695a,_0x6c459c=[..._0x3dbca0],_0x114ff6=[],_0x3f5d87=[];while(_0x6c459c[_0x37a7ae(0x1df)]){const _0x33f942=_0x6c459c[_0x37a7ae(0x1fb)](0x0,this[_0x37a7ae(0x208)]),_0x206421=await this[_0x37a7ae(0x20a)][_0x37a7ae(0x1f4)](_0x33f942);_0x33f942[_0x37a7ae(0x1df)]!==_0x206421[_0x37a7ae(0x203)][_0x37a7ae(0x1df)]?(_0x6c459c['push'](..._0x206421[_0x37a7ae(0x203)]),_0x114ff6[_0x37a7ae(0x1f0)](..._0x206421[_0x37a7ae(0x1ea)])):_0x3f5d87[_0x37a7ae(0x1f0)](..._0x33f942),this['logger'][_0x37a7ae(0x202)]('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x3dbca0[_0x37a7ae(0x1df)]-_0x6c459c[_0x37a7ae(0x1df)],_0x3dbca0[_0x37a7ae(0x1df)]);}if(_0x3f5d87[_0x37a7ae(0x1df)]){const _0x31ac47=await this[_0x37a7ae(0x1ff)](_0x3f5d87);_0x114ff6[_0x37a7ae(0x1f0)](..._0x31ac47);}return _0x114ff6;}}exports[a242_0x57695a(0x1f6)]=SalesforceRetrieverService;