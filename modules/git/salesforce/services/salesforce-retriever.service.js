const a253_0x1e4073=a253_0x5b2e;(function(_0x3a85bb,_0x198d51){const _0x42eb34=a253_0x5b2e,_0x5b64e2=_0x3a85bb();while(!![]){try{const _0x3f888f=parseInt(_0x42eb34(0x16e))/0x1*(parseInt(_0x42eb34(0x188))/0x2)+parseInt(_0x42eb34(0x165))/0x3+parseInt(_0x42eb34(0x172))/0x4+-parseInt(_0x42eb34(0x167))/0x5+parseInt(_0x42eb34(0x15d))/0x6+-parseInt(_0x42eb34(0x15a))/0x7*(parseInt(_0x42eb34(0x174))/0x8)+-parseInt(_0x42eb34(0x189))/0x9*(parseInt(_0x42eb34(0x16a))/0xa);if(_0x3f888f===_0x198d51)break;else _0x5b64e2['push'](_0x5b64e2['shift']());}catch(_0x457ee0){_0x5b64e2['push'](_0x5b64e2['shift']());}}}(a253_0x89c1,0x4dc99));const a253_0x10efd8=(function(){let _0x1d3855=!![];return function(_0x500798,_0x4c09e1){const _0x43cd02=_0x1d3855?function(){const _0x1a1eed=a253_0x5b2e;if(_0x4c09e1){const _0xec45a8=_0x4c09e1[_0x1a1eed(0x170)](_0x500798,arguments);return _0x4c09e1=null,_0xec45a8;}}:function(){};return _0x1d3855=![],_0x43cd02;};}()),a253_0x101a98=a253_0x10efd8(this,function(){const _0x1462d1=a253_0x5b2e;return a253_0x101a98[_0x1462d1(0x17e)]()[_0x1462d1(0x169)](_0x1462d1(0x17d))[_0x1462d1(0x17e)]()[_0x1462d1(0x17a)](a253_0x101a98)['search'](_0x1462d1(0x17d));});a253_0x101a98();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x55781a){return _0x55781a&&_0x55781a['__esModule']?_0x55781a:{'default':_0x55781a};};Object[a253_0x1e4073(0x171)](exports,a253_0x1e4073(0x164),{'value':!![]}),exports[a253_0x1e4073(0x17b)]=void 0x0;const core_1=require(a253_0x1e4073(0x163)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a253_0x1e4073(0x182)),queries_1=require('../queries'),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x76656){const _0x4efe05=a253_0x1e4073;this[_0x4efe05(0x161)]=_0x76656,this[_0x4efe05(0x154)]=new core_1[(_0x4efe05(0x181))](SalesforceRetrieverService[_0x4efe05(0x177)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x4efe05(0x162)]=0x1f4;}async[a253_0x1e4073(0x16f)](_0x475f30){const _0x550c94=a253_0x1e4073;this[_0x550c94(0x154)][_0x550c94(0x15f)](_0x550c94(0x15b),_0x475f30[_0x550c94(0x180)]);const _0x14582a=typedi_1[_0x550c94(0x184)][_0x550c94(0x173)](salesforce_query_service_1[_0x550c94(0x178)]),_0x3192f4=_0x475f30[_0x550c94(0x153)](_0x4a909b=>'\x27'+_0x4a909b+'\x27'),_0x5d8d04=[];while(_0x3192f4[_0x550c94(0x180)]){const _0x54355a=_0x3192f4[_0x550c94(0x183)](0x0,this[_0x550c94(0x162)]),_0x238a85=_0x14582a[_0x550c94(0x175)](queries_1[_0x550c94(0x152)][_0x550c94(0x176)](_0x550c94(0x187),_0x54355a['join']())),_0x5de55e=_0x14582a[_0x550c94(0x175)](queries_1[_0x550c94(0x166)][_0x550c94(0x176)]('%ids%',_0x54355a[_0x550c94(0x157)]()))['then'](_0x1f66c9=>_0x1f66c9[_0x550c94(0x153)](_0xdd835c=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0x550c94(0x16b)](_0xdd835c))),[_0x207ade,_0x9953cd]=await Promise[_0x550c94(0x155)]([_0x238a85,_0x5de55e]);for(const _0x441b39 of _0x9953cd){const _0x4afd94=_0x207ade[_0x550c94(0x159)](_0x54cdfa=>_0x54cdfa['ParentId']===_0x441b39['id']);_0x4afd94&&_0x5d8d04['push']({'fileType':_0x4afd94[_0x550c94(0x15c)],'fileName':_0x441b39['filename'],'attachmentId':_0x4afd94['Id']});}}return _0x5d8d04;}async[a253_0x1e4073(0x156)](_0x4c1717){const _0x29fc39=a253_0x1e4073,_0x6414f7=await this['retrieveComponentIdsFromHistoryIds'](_0x4c1717);this[_0x29fc39(0x154)][_0x29fc39(0x15f)](_0x29fc39(0x17f));const _0xf913b4=[];for(const _0x51be26 of _0x6414f7){const _0x516020=await this[_0x29fc39(0x161)]['retrieveAttachment'](_0x51be26[_0x29fc39(0x16d)],!![]);_0xf913b4[_0x29fc39(0x186)]({'body':_0x516020['toString'](_0x29fc39(0x15e)),'fileName':_0x51be26['fileName'],'fileType':_0x51be26[_0x29fc39(0x160)]}),this[_0x29fc39(0x154)][_0x29fc39(0x15f)]('Manually\x20retrieved\x20%d/%d\x20components',_0xf913b4[_0x29fc39(0x180)],_0x4c1717[_0x29fc39(0x180)]);}return _0xf913b4;}async[a253_0x1e4073(0x168)](_0x2b4f4f){const _0x15f425=a253_0x1e4073,_0x2c5d5f=[..._0x2b4f4f],_0x4e5c46=[],_0x2b38c5=[];while(_0x2c5d5f[_0x15f425(0x180)]){const _0x161cce=_0x2c5d5f[_0x15f425(0x183)](0x0,this[_0x15f425(0x179)]),_0x531ef4=await this['salesforceService']['retrieveComponents'](_0x161cce);_0x161cce[_0x15f425(0x180)]!==_0x531ef4[_0x15f425(0x16c)][_0x15f425(0x180)]?(_0x2c5d5f[_0x15f425(0x186)](..._0x531ef4[_0x15f425(0x16c)]),_0x4e5c46[_0x15f425(0x186)](..._0x531ef4[_0x15f425(0x185)])):_0x2b38c5['push'](..._0x161cce),this['logger'][_0x15f425(0x158)](_0x15f425(0x17c),_0x2b4f4f[_0x15f425(0x180)]-_0x2c5d5f['length'],_0x2b4f4f[_0x15f425(0x180)]);}if(_0x2b38c5[_0x15f425(0x180)]){const _0x157a77=await this[_0x15f425(0x156)](_0x2b38c5);_0x4e5c46[_0x15f425(0x186)](..._0x157a77);}return _0x4e5c46;}}function a253_0x5b2e(_0x55e074,_0x366837){const _0x50d1e7=a253_0x89c1();return a253_0x5b2e=function(_0x101a98,_0x10efd8){_0x101a98=_0x101a98-0x152;let _0x89c19=_0x50d1e7[_0x101a98];return _0x89c19;},a253_0x5b2e(_0x55e074,_0x366837);}exports['SalesforceRetrieverService']=SalesforceRetrieverService;function a253_0x89c1(){const _0xe12966=['ids','attachmentId','1CvDdHI','retrieveComponentIdsFromHistoryIds','apply','defineProperty','2143404SXIzOR','get','209928Vdeoxi','query','replace','name','SalesforceQueryService','COMPONENTS_PER_REQUEST','constructor','SalesforceRetrieverService','Retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','(((.+)+)+)+$','toString','Manually\x20retrieving\x20components\x20from\x20salesforce','length','Logger','./salesforce-query.service','splice','default','components','push','%parent_ids%','677928yAOahj','9msRZWU','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','map','logger','all','retrieveLastComponents','join','log','find','21opdTFe','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','Name','1815474FJXHKu','base64','info','fileType','salesforceService','COMPONENTS_PER_QUERY','../../../../core','__esModule','683673DjMyMs','GET_COMPONENT_HISTORIES_BY_IDS','232430WJWVys','run','search','9614590JPbnky','fromSalesforce'];a253_0x89c1=function(){return _0xe12966;};return a253_0x89c1();}