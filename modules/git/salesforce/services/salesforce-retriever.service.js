const a190_0xba1c35=a190_0x4286;(function(_0x49cc68,_0xe8a95){const _0x51509c=a190_0x4286,_0x571008=_0x49cc68();while(!![]){try{const _0x362078=parseInt(_0x51509c(0x10a))/0x1*(-parseInt(_0x51509c(0xed))/0x2)+parseInt(_0x51509c(0xec))/0x3*(parseInt(_0x51509c(0x10b))/0x4)+-parseInt(_0x51509c(0x11c))/0x5+-parseInt(_0x51509c(0x117))/0x6+-parseInt(_0x51509c(0xe9))/0x7+parseInt(_0x51509c(0x116))/0x8*(-parseInt(_0x51509c(0x123))/0x9)+parseInt(_0x51509c(0xea))/0xa;if(_0x362078===_0xe8a95)break;else _0x571008['push'](_0x571008['shift']());}catch(_0x21ed0f){_0x571008['push'](_0x571008['shift']());}}}(a190_0x5c0c,0x4863d));const a190_0x46dbe9=(function(){let _0x288d32=!![];return function(_0xf1acb1,_0x552ef9){const _0x3d530a=_0x288d32?function(){const _0x10011b=a190_0x4286;if(_0x552ef9){const _0x3b9ee5=_0x552ef9[_0x10011b(0xf1)](_0xf1acb1,arguments);return _0x552ef9=null,_0x3b9ee5;}}:function(){};return _0x288d32=![],_0x3d530a;};}()),a190_0x462d88=a190_0x46dbe9(this,function(){const _0x554e2c=a190_0x4286;return a190_0x462d88['toString']()[_0x554e2c(0xeb)](_0x554e2c(0x11f))[_0x554e2c(0x107)]()['constructor'](a190_0x462d88)['search']('(((.+)+)+)+$');});a190_0x462d88();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x479ff0){const _0x5d6e09=a190_0x4286;return _0x479ff0&&_0x479ff0[_0x5d6e09(0x115)]?_0x479ff0:{'default':_0x479ff0};};function a190_0x5c0c(){const _0x47515d=['SalesforceRetrieverService','1682705UqLjyM','../../../../core','splice','(((.+)+)+)+$','COMPONENTS_PER_QUERY','find','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','3859182gnyJGO','2346113MPHRxg','12363880ZXKCMe','search','3sDLaFa','1918HDxEPh','defineProperty','info','manually\x20retrieved\x20%d/%d\x20components','apply','./salesforce-query.service','Name','query','%ids%','retrieveAttachment','then','replace','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','logger','default','log','ParentId','SalesforceQueryService','ids','GET_COMPONENT_HISTORIES_BY_IDS','salesforceService','manually\x20retrieving\x20components\x20from\x20salesforce','retrieveComponentIdsFromHistoryIds','FlosumComponentHistoryDto','get','fileType','toString','map','run','178YlvgVw','1517932JmnMbB','%parent_ids%','join','retrieveLastComponents','components','fromSalesforce','Logger','attachmentId','base64','length','__esModule','8sNVrAg','288972sxdfeh','filename','name','push'];a190_0x5c0c=function(){return _0x47515d;};return a190_0x5c0c();}function a190_0x4286(_0x58af92,_0x5345c1){const _0x18f90f=a190_0x5c0c();return a190_0x4286=function(_0x462d88,_0x46dbe9){_0x462d88=_0x462d88-0xe9;let _0x5c0cc7=_0x18f90f[_0x462d88];return _0x5c0cc7;},a190_0x4286(_0x58af92,_0x5345c1);}Object[a190_0xba1c35(0xee)](exports,a190_0xba1c35(0x115),{'value':!![]}),exports[a190_0xba1c35(0x11b)]=void 0x0;const core_1=require(a190_0xba1c35(0x11d)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a190_0xba1c35(0xf2)),queries_1=require('../queries'),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x461d07){const _0x2d82b1=a190_0xba1c35;this[_0x2d82b1(0x101)]=_0x461d07,this[_0x2d82b1(0xfa)]=new core_1[(_0x2d82b1(0x111))](SalesforceRetrieverService[_0x2d82b1(0x119)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x2d82b1(0x120)]=0x1f4;}async[a190_0xba1c35(0x103)](_0x4c296){const _0x1fd2c4=a190_0xba1c35;this['logger'][_0x1fd2c4(0xef)](_0x1fd2c4(0x122),_0x4c296['length']);const _0x429da7=typedi_1[_0x1fd2c4(0xfb)][_0x1fd2c4(0x105)](salesforce_query_service_1[_0x1fd2c4(0xfe)]),_0x438dbf=_0x4c296[_0x1fd2c4(0x108)](_0x4574e7=>'\x27'+_0x4574e7+'\x27'),_0x3f95a9=[];while(_0x438dbf[_0x1fd2c4(0x114)]){const _0x2222f4=_0x438dbf['splice'](0x0,this[_0x1fd2c4(0x120)]),_0x8f28b2=_0x429da7[_0x1fd2c4(0xf4)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x1fd2c4(0xf8)](_0x1fd2c4(0x10c),_0x2222f4[_0x1fd2c4(0x10d)]())),_0x8e52ed=_0x429da7[_0x1fd2c4(0xf4)](queries_1[_0x1fd2c4(0x100)][_0x1fd2c4(0xf8)](_0x1fd2c4(0xf5),_0x2222f4[_0x1fd2c4(0x10d)]()))[_0x1fd2c4(0xf7)](_0x3d0d1d=>_0x3d0d1d[_0x1fd2c4(0x108)](_0x4ce1f8=>flosum_component_history_dto_1[_0x1fd2c4(0x104)][_0x1fd2c4(0x110)](_0x4ce1f8))),[_0x31691c,_0x4708e8]=await Promise['all']([_0x8f28b2,_0x8e52ed]);for(const _0x6e2319 of _0x4708e8){const _0x2bfece=_0x31691c[_0x1fd2c4(0x121)](_0x2607b3=>_0x2607b3[_0x1fd2c4(0xfd)]===_0x6e2319['id']);_0x2bfece&&_0x3f95a9[_0x1fd2c4(0x11a)]({'fileType':_0x2bfece[_0x1fd2c4(0xf3)],'fileName':_0x6e2319[_0x1fd2c4(0x118)],'attachmentId':_0x2bfece['Id']});}}return _0x3f95a9;}async[a190_0xba1c35(0x10e)](_0x5f50c3){const _0x1bb128=a190_0xba1c35,_0x545179=await this[_0x1bb128(0x103)](_0x5f50c3);this[_0x1bb128(0xfa)][_0x1bb128(0xef)](_0x1bb128(0x102));const _0x38a116=[];for(const _0x538574 of _0x545179){const _0x4577e4=await this['salesforceService'][_0x1bb128(0xf6)](_0x538574[_0x1bb128(0x112)],!![]);_0x38a116[_0x1bb128(0x11a)]({'body':_0x4577e4[_0x1bb128(0x107)](_0x1bb128(0x113)),'fileName':_0x538574['fileName'],'fileType':_0x538574[_0x1bb128(0x106)]}),this[_0x1bb128(0xfa)][_0x1bb128(0xef)](_0x1bb128(0xf0),_0x38a116[_0x1bb128(0x114)],_0x5f50c3[_0x1bb128(0x114)]);}return _0x38a116;}async[a190_0xba1c35(0x109)](_0x14a6c5){const _0x44d40b=a190_0xba1c35,_0x5d9d90=[..._0x14a6c5],_0x40088c=[],_0x2af455=[];while(_0x5d9d90[_0x44d40b(0x114)]){const _0x529621=_0x5d9d90[_0x44d40b(0x11e)](0x0,this['COMPONENTS_PER_REQUEST']),_0x2851c5=await this[_0x44d40b(0x101)]['retrieveComponents'](_0x529621);_0x529621[_0x44d40b(0x114)]!==_0x2851c5[_0x44d40b(0xff)][_0x44d40b(0x114)]?(_0x5d9d90[_0x44d40b(0x11a)](..._0x2851c5['ids']),_0x40088c['push'](..._0x2851c5[_0x44d40b(0x10f)])):_0x2af455['push'](..._0x529621),this['logger'][_0x44d40b(0xfc)](_0x44d40b(0xf9),_0x14a6c5[_0x44d40b(0x114)]-_0x5d9d90[_0x44d40b(0x114)],_0x14a6c5[_0x44d40b(0x114)]);}if(_0x2af455[_0x44d40b(0x114)]){const _0x3e5141=await this[_0x44d40b(0x10e)](_0x2af455);_0x40088c[_0x44d40b(0x11a)](..._0x3e5141);}return _0x40088c;}}exports[a190_0xba1c35(0x11b)]=SalesforceRetrieverService;