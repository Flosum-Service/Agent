const a280_0x2efb3a=a280_0x5ade;(function(_0x428034,_0x526703){const _0x25b21c=a280_0x5ade,_0x4ba15a=_0x428034();while(!![]){try{const _0x5b2af3=-parseInt(_0x25b21c(0x205))/0x1*(parseInt(_0x25b21c(0x210))/0x2)+-parseInt(_0x25b21c(0x1f3))/0x3*(-parseInt(_0x25b21c(0x202))/0x4)+-parseInt(_0x25b21c(0x201))/0x5*(parseInt(_0x25b21c(0x218))/0x6)+-parseInt(_0x25b21c(0x1f4))/0x7+-parseInt(_0x25b21c(0x1f6))/0x8*(parseInt(_0x25b21c(0x1f9))/0x9)+-parseInt(_0x25b21c(0x21a))/0xa+parseInt(_0x25b21c(0x200))/0xb*(parseInt(_0x25b21c(0x21c))/0xc);if(_0x5b2af3===_0x526703)break;else _0x4ba15a['push'](_0x4ba15a['shift']());}catch(_0x50a23f){_0x4ba15a['push'](_0x4ba15a['shift']());}}}(a280_0x1d53,0xa8138));const a280_0x51589d=(function(){let _0x347691=!![];return function(_0x3b657e,_0x4bc527){const _0x1e3835=_0x347691?function(){const _0x5cb365=a280_0x5ade;if(_0x4bc527){const _0x558f0d=_0x4bc527[_0x5cb365(0x20d)](_0x3b657e,arguments);return _0x4bc527=null,_0x558f0d;}}:function(){};return _0x347691=![],_0x1e3835;};}()),a280_0x599dcb=a280_0x51589d(this,function(){const _0x57acdd=a280_0x5ade;return a280_0x599dcb['toString']()['search'](_0x57acdd(0x1eb))[_0x57acdd(0x1ff)]()[_0x57acdd(0x21f)](a280_0x599dcb)['search'](_0x57acdd(0x1eb));});a280_0x599dcb();'use strict';var __importDefault=this&&this[a280_0x2efb3a(0x206)]||function(_0x5a4739){return _0x5a4739&&_0x5a4739['__esModule']?_0x5a4739:{'default':_0x5a4739};};function a280_0x1d53(){const _0x3e3740=['80088URXvTb','name','retrieveComponents','constructor','length','retrieveAttachment','./salesforce-query.service','(((.+)+)+)+$','join','Manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','../queries','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','Manually\x20retrieving\x20components\x20from\x20salesforce','Logger','../../../../core','474tsxQSm','3695286VxLOSL','then','20344UhcBNZ','replace','fileType','1755rigPln','Name','all','base64','defineProperty','filename','toString','5027bwhXnR','10TcVgTM','16232kBXVPh','splice','logger','68785UiLfnI','__importDefault','salesforceService','map','FlosumComponentHistoryDto','Manually\x20retrieved\x20%d/%d\x20components','push','COMPONENTS_PER_QUERY','apply','SalesforceQueryService','query','4UosSyx','run','info','fileName','retrieveComponentIdsFromHistoryIds','%ids%','__esModule','%parent_ids%','4017780PbrbNn','get','5021290zLLnsx','typedi'];a280_0x1d53=function(){return _0x3e3740;};return a280_0x1d53();}function a280_0x5ade(_0x221f31,_0x138b06){const _0x18aca8=a280_0x1d53();return a280_0x5ade=function(_0x599dcb,_0x51589d){_0x599dcb=_0x599dcb-0x1eb;let _0x1d53b8=_0x18aca8[_0x599dcb];return _0x1d53b8;},a280_0x5ade(_0x221f31,_0x138b06);}Object[a280_0x2efb3a(0x1fd)](exports,a280_0x2efb3a(0x216),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a280_0x2efb3a(0x1f2)),typedi_1=__importDefault(require(a280_0x2efb3a(0x21b))),salesforce_query_service_1=require(a280_0x2efb3a(0x222)),queries_1=require(a280_0x2efb3a(0x1ee)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x4c9ffa){const _0x4b4bff=a280_0x2efb3a;this[_0x4b4bff(0x207)]=_0x4c9ffa,this[_0x4b4bff(0x204)]=new core_1[(_0x4b4bff(0x1f1))](SalesforceRetrieverService[_0x4b4bff(0x21d)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x4b4bff(0x20c)]=0x1f4;}async[a280_0x2efb3a(0x214)](_0x5ecf05){const _0x22102e=a280_0x2efb3a;this[_0x22102e(0x204)]['info'](_0x22102e(0x1ed),_0x5ecf05['length']);const _0x11a9d7=typedi_1['default'][_0x22102e(0x219)](salesforce_query_service_1[_0x22102e(0x20e)]),_0x58039b=_0x5ecf05[_0x22102e(0x208)](_0xe75364=>'\x27'+_0xe75364+'\x27'),_0x5b20a5=[];while(_0x58039b['length']){const _0x40abd8=_0x58039b[_0x22102e(0x203)](0x0,this[_0x22102e(0x20c)]),_0x165d65=_0x11a9d7[_0x22102e(0x20f)](queries_1[_0x22102e(0x1ef)]['replace'](_0x22102e(0x217),_0x40abd8[_0x22102e(0x1ec)]())),_0x394be4=_0x11a9d7['query'](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x22102e(0x1f7)](_0x22102e(0x215),_0x40abd8['join']()))[_0x22102e(0x1f5)](_0x43daa2=>_0x43daa2[_0x22102e(0x208)](_0x5b88ab=>flosum_component_history_dto_1[_0x22102e(0x209)]['fromSalesforce'](_0x5b88ab))),[_0x11b781,_0x20fb19]=await Promise[_0x22102e(0x1fb)]([_0x165d65,_0x394be4]);for(const _0x569d9a of _0x20fb19){const _0x374dd1=_0x11b781['find'](_0x217553=>_0x217553['ParentId']===_0x569d9a['id']);_0x374dd1&&_0x5b20a5['push']({'fileType':_0x374dd1[_0x22102e(0x1fa)],'fileName':_0x569d9a[_0x22102e(0x1fe)],'attachmentId':_0x374dd1['Id']});}}return _0x5b20a5;}async['retrieveLastComponents'](_0x4a373c){const _0x58bda6=a280_0x2efb3a,_0x592f98=await this['retrieveComponentIdsFromHistoryIds'](_0x4a373c);this[_0x58bda6(0x204)]['info'](_0x58bda6(0x1f0));const _0x159f80=[];for(const _0x520419 of _0x592f98){const _0x361af8=await this[_0x58bda6(0x207)][_0x58bda6(0x221)](_0x520419['attachmentId'],!![]);_0x159f80[_0x58bda6(0x20b)]({'body':_0x361af8[_0x58bda6(0x1ff)](_0x58bda6(0x1fc)),'fileName':_0x520419[_0x58bda6(0x213)],'fileType':_0x520419[_0x58bda6(0x1f8)]}),this[_0x58bda6(0x204)][_0x58bda6(0x212)](_0x58bda6(0x20a),_0x159f80[_0x58bda6(0x220)],_0x4a373c['length']);}return _0x159f80;}async[a280_0x2efb3a(0x211)](_0x7ebef6){const _0x443c13=a280_0x2efb3a;if(!_0x7ebef6['length'])return[];const _0xf3937e=await this['salesforceService'][_0x443c13(0x21e)](_0x7ebef6);return _0xf3937e;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;