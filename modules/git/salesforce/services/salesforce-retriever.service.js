const a242_0x1071c4=a242_0x3b38;(function(_0xd6ab60,_0x51f280){const _0xf01e45=a242_0x3b38,_0x1c439c=_0xd6ab60();while(!![]){try{const _0x4d6833=parseInt(_0xf01e45(0x20b))/0x1*(parseInt(_0xf01e45(0x1fd))/0x2)+parseInt(_0xf01e45(0x209))/0x3*(-parseInt(_0xf01e45(0x1ea))/0x4)+-parseInt(_0xf01e45(0x1ed))/0x5+-parseInt(_0xf01e45(0x1e1))/0x6+parseInt(_0xf01e45(0x1e9))/0x7+-parseInt(_0xf01e45(0x20d))/0x8+parseInt(_0xf01e45(0x1eb))/0x9;if(_0x4d6833===_0x51f280)break;else _0x1c439c['push'](_0x1c439c['shift']());}catch(_0xb48cb0){_0x1c439c['push'](_0x1c439c['shift']());}}}(a242_0x1a6e,0x5b4f9));const a242_0x2e9b99=(function(){let _0x447305=!![];return function(_0x56e380,_0x4ce76a){const _0x460d0c=_0x447305?function(){const _0x108e05=a242_0x3b38;if(_0x4ce76a){const _0x4c6c43=_0x4ce76a[_0x108e05(0x1f5)](_0x56e380,arguments);return _0x4ce76a=null,_0x4c6c43;}}:function(){};return _0x447305=![],_0x460d0c;};}()),a242_0x4daeac=a242_0x2e9b99(this,function(){const _0x5adb92=a242_0x3b38;return a242_0x4daeac[_0x5adb92(0x202)]()[_0x5adb92(0x1dd)](_0x5adb92(0x1dc))[_0x5adb92(0x202)]()[_0x5adb92(0x1df)](a242_0x4daeac)['search']('(((.+)+)+)+$');});function a242_0x3b38(_0x57e7d9,_0x5b4054){const _0xe4dbae=a242_0x1a6e();return a242_0x3b38=function(_0x4daeac,_0x2e9b99){_0x4daeac=_0x4daeac-0x1d8;let _0x1a6e09=_0xe4dbae[_0x4daeac];return _0x1a6e09;},a242_0x3b38(_0x57e7d9,_0x5b4054);}a242_0x4daeac();'use strict';var __importDefault=this&&this[a242_0x1071c4(0x206)]||function(_0x4d5c60){const _0x3a9002=a242_0x1071c4;return _0x4d5c60&&_0x4d5c60[_0x3a9002(0x205)]?_0x4d5c60:{'default':_0x4d5c60};};Object['defineProperty'](exports,a242_0x1071c4(0x205),{'value':!![]}),exports[a242_0x1071c4(0x1f8)]=void 0x0;const core_1=require(a242_0x1071c4(0x1e0)),typedi_1=__importDefault(require(a242_0x1071c4(0x1f1))),salesforce_query_service_1=require(a242_0x1071c4(0x1e7)),queries_1=require('../queries'),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');function a242_0x1a6e(){const _0x47f4bd=['salesforceService','logger','retrieveLastComponents','(((.+)+)+)+$','search','length','constructor','../../../../core','2148420vPTBFj','components','%ids%','FlosumComponentHistoryDto','Name','COMPONENTS_PER_QUERY','./salesforce-query.service','log','1991451TthOVL','220vmTeWv','7803630dzDzeo','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','1581380kuoVoh','info','replace','fileName','typedi','join','splice','retrieveComponents','apply','map','ParentId','SalesforceRetrieverService','get','%parent_ids%','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','manually\x20retrieved\x20%d/%d\x20components','6bwZvMf','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','manually\x20retrieving\x20components\x20from\x20salesforce','fileType','push','toString','query','retrieveComponentIdsFromHistoryIds','__esModule','__importDefault','fromSalesforce','Logger','29139OFCQfr','ids','159554khkpfz','COMPONENTS_PER_REQUEST','381240AFrTUA','name','default','base64'];a242_0x1a6e=function(){return _0x47f4bd;};return a242_0x1a6e();}class SalesforceRetrieverService{constructor(_0x1d2d02){const _0x452ef7=a242_0x1071c4;this[_0x452ef7(0x1d9)]=_0x1d2d02,this[_0x452ef7(0x1da)]=new core_1[(_0x452ef7(0x208))](SalesforceRetrieverService[_0x452ef7(0x20e)]),this[_0x452ef7(0x20c)]=0xbb8,this[_0x452ef7(0x1e6)]=0x1f4;}async[a242_0x1071c4(0x204)](_0x2d335a){const _0x1e63c1=a242_0x1071c4;this[_0x1e63c1(0x1da)][_0x1e63c1(0x1ee)](_0x1e63c1(0x1ec),_0x2d335a['length']);const _0x5101a9=typedi_1[_0x1e63c1(0x20f)][_0x1e63c1(0x1f9)](salesforce_query_service_1['SalesforceQueryService']),_0x19e50e=_0x2d335a['map'](_0x3acd8b=>'\x27'+_0x3acd8b+'\x27'),_0x558da2=[];while(_0x19e50e[_0x1e63c1(0x1de)]){const _0x390d53=_0x19e50e[_0x1e63c1(0x1f3)](0x0,this[_0x1e63c1(0x1e6)]),_0x2521fa=_0x5101a9['query'](queries_1[_0x1e63c1(0x1fb)]['replace'](_0x1e63c1(0x1fa),_0x390d53[_0x1e63c1(0x1f2)]())),_0x1f11d6=_0x5101a9[_0x1e63c1(0x203)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x1e63c1(0x1ef)](_0x1e63c1(0x1e3),_0x390d53[_0x1e63c1(0x1f2)]()))['then'](_0x29db91=>_0x29db91[_0x1e63c1(0x1f6)](_0x1cf3fe=>flosum_component_history_dto_1[_0x1e63c1(0x1e4)][_0x1e63c1(0x207)](_0x1cf3fe))),[_0x4d61ea,_0x3e5be6]=await Promise['all']([_0x2521fa,_0x1f11d6]);for(const _0x368770 of _0x3e5be6){const _0x2a2211=_0x4d61ea['find'](_0x2e2757=>_0x2e2757[_0x1e63c1(0x1f7)]===_0x368770['id']);_0x2a2211&&_0x558da2['push']({'fileType':_0x2a2211[_0x1e63c1(0x1e5)],'fileName':_0x368770['filename'],'attachmentId':_0x2a2211['Id']});}}return _0x558da2;}async[a242_0x1071c4(0x1db)](_0x3dae93){const _0x5a0425=a242_0x1071c4,_0x447c54=await this[_0x5a0425(0x204)](_0x3dae93);this[_0x5a0425(0x1da)]['info'](_0x5a0425(0x1ff));const _0x10bebe=[];for(const _0x2201d2 of _0x447c54){const _0x2b9d88=await this[_0x5a0425(0x1d9)]['retrieveAttachment'](_0x2201d2['attachmentId'],!![]);_0x10bebe['push']({'body':_0x2b9d88['toString'](_0x5a0425(0x1d8)),'fileName':_0x2201d2[_0x5a0425(0x1f0)],'fileType':_0x2201d2[_0x5a0425(0x200)]}),this[_0x5a0425(0x1da)]['info'](_0x5a0425(0x1fc),_0x10bebe[_0x5a0425(0x1de)],_0x3dae93[_0x5a0425(0x1de)]);}return _0x10bebe;}async['run'](_0xad97e9){const _0x4d163e=a242_0x1071c4,_0x1326f4=[..._0xad97e9],_0x359fa5=[],_0x56cab3=[];while(_0x1326f4[_0x4d163e(0x1de)]){const _0x264dd4=_0x1326f4[_0x4d163e(0x1f3)](0x0,this[_0x4d163e(0x20c)]),_0x1cd96e=await this[_0x4d163e(0x1d9)][_0x4d163e(0x1f4)](_0x264dd4);_0x264dd4['length']!==_0x1cd96e[_0x4d163e(0x20a)]['length']?(_0x1326f4[_0x4d163e(0x201)](..._0x1cd96e[_0x4d163e(0x20a)]),_0x359fa5[_0x4d163e(0x201)](..._0x1cd96e[_0x4d163e(0x1e2)])):_0x56cab3[_0x4d163e(0x201)](..._0x264dd4),this['logger'][_0x4d163e(0x1e8)](_0x4d163e(0x1fe),_0xad97e9[_0x4d163e(0x1de)]-_0x1326f4['length'],_0xad97e9[_0x4d163e(0x1de)]);}if(_0x56cab3[_0x4d163e(0x1de)]){const _0x27e6e8=await this[_0x4d163e(0x1db)](_0x56cab3);_0x359fa5['push'](..._0x27e6e8);}return _0x359fa5;}}exports[a242_0x1071c4(0x1f8)]=SalesforceRetrieverService;