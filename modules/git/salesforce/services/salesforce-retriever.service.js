const a237_0x20a976=a237_0x9e8d;(function(_0x27d6c3,_0x516715){const _0x2abf54=a237_0x9e8d,_0x1c6673=_0x27d6c3();while(!![]){try{const _0x39185a=parseInt(_0x2abf54(0x136))/0x1+parseInt(_0x2abf54(0x117))/0x2*(parseInt(_0x2abf54(0x13d))/0x3)+-parseInt(_0x2abf54(0x132))/0x4*(-parseInt(_0x2abf54(0x12b))/0x5)+parseInt(_0x2abf54(0x130))/0x6*(-parseInt(_0x2abf54(0x12c))/0x7)+parseInt(_0x2abf54(0x116))/0x8+parseInt(_0x2abf54(0x127))/0x9*(parseInt(_0x2abf54(0x146))/0xa)+-parseInt(_0x2abf54(0x124))/0xb;if(_0x39185a===_0x516715)break;else _0x1c6673['push'](_0x1c6673['shift']());}catch(_0x4d25e3){_0x1c6673['push'](_0x1c6673['shift']());}}}(a237_0x4186,0xad45f));function a237_0x9e8d(_0x297442,_0x5f40a0){const _0x3974da=a237_0x4186();return a237_0x9e8d=function(_0x3ab8d4,_0x3135fe){_0x3ab8d4=_0x3ab8d4-0x10b;let _0x41869a=_0x3974da[_0x3ab8d4];return _0x41869a;},a237_0x9e8d(_0x297442,_0x5f40a0);}const a237_0x3135fe=(function(){let _0x4c9b59=!![];return function(_0x2cc191,_0x79606d){const _0x5f17b0=_0x4c9b59?function(){if(_0x79606d){const _0x180408=_0x79606d['apply'](_0x2cc191,arguments);return _0x79606d=null,_0x180408;}}:function(){};return _0x4c9b59=![],_0x5f17b0;};}()),a237_0x3ab8d4=a237_0x3135fe(this,function(){const _0x20baeb=a237_0x9e8d;return a237_0x3ab8d4[_0x20baeb(0x139)]()[_0x20baeb(0x145)](_0x20baeb(0x13e))[_0x20baeb(0x139)]()[_0x20baeb(0x12f)](a237_0x3ab8d4)['search'](_0x20baeb(0x13e));});a237_0x3ab8d4();'use strict';var __importDefault=this&&this[a237_0x20a976(0x134)]||function(_0x5d81a6){return _0x5d81a6&&_0x5d81a6['__esModule']?_0x5d81a6:{'default':_0x5d81a6};};Object[a237_0x20a976(0x11e)](exports,'__esModule',{'value':!![]}),exports[a237_0x20a976(0x10d)]=void 0x0;const core_1=require(a237_0x20a976(0x11c)),typedi_1=__importDefault(require(a237_0x20a976(0x125))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require('../queries'),flosum_component_history_dto_1=require(a237_0x20a976(0x11d));class SalesforceRetrieverService{constructor(_0x4ea660){const _0x591549=a237_0x20a976;this[_0x591549(0x141)]=_0x4ea660,this[_0x591549(0x126)]=new core_1[(_0x591549(0x123))](SalesforceRetrieverService[_0x591549(0x13b)]),this[_0x591549(0x13a)]=0xbb8,this[_0x591549(0x114)]=0x1f4;}async[a237_0x20a976(0x143)](_0x491175){const _0x550ce9=a237_0x20a976;this['logger']['info'](_0x550ce9(0x142),_0x491175[_0x550ce9(0x11f)]);const _0x49e0f2=typedi_1[_0x550ce9(0x110)][_0x550ce9(0x119)](salesforce_query_service_1[_0x550ce9(0x10f)]),_0x29bf0e=_0x491175[_0x550ce9(0x118)](_0xc26424=>'\x27'+_0xc26424+'\x27'),_0x9e58ce=[];while(_0x29bf0e[_0x550ce9(0x11f)]){const _0x56bf64=_0x29bf0e['splice'](0x0,this[_0x550ce9(0x114)]),_0x495ea6=_0x49e0f2[_0x550ce9(0x12d)](queries_1[_0x550ce9(0x13f)][_0x550ce9(0x131)]('%parent_ids%',_0x56bf64[_0x550ce9(0x140)]())),_0x572c40=_0x49e0f2[_0x550ce9(0x12d)](queries_1[_0x550ce9(0x11a)][_0x550ce9(0x131)]('%ids%',_0x56bf64[_0x550ce9(0x140)]()))[_0x550ce9(0x11b)](_0x45533f=>_0x45533f[_0x550ce9(0x118)](_0x463fda=>flosum_component_history_dto_1[_0x550ce9(0x129)][_0x550ce9(0x10e)](_0x463fda))),[_0x1f36de,_0x73dd1c]=await Promise[_0x550ce9(0x144)]([_0x495ea6,_0x572c40]);for(const _0x1c120f of _0x73dd1c){const _0x54cdb3=_0x1f36de['find'](_0x3d4793=>_0x3d4793[_0x550ce9(0x12e)]===_0x1c120f['id']);_0x54cdb3&&_0x9e58ce[_0x550ce9(0x13c)]({'fileType':_0x54cdb3[_0x550ce9(0x113)],'fileName':_0x1c120f[_0x550ce9(0x128)],'attachmentId':_0x54cdb3['Id']});}}return _0x9e58ce;}async[a237_0x20a976(0x112)](_0x2fc8fc){const _0x3e6229=a237_0x20a976,_0x4778a0=await this['retrieveComponentIdsFromHistoryIds'](_0x2fc8fc);this['logger'][_0x3e6229(0x120)](_0x3e6229(0x121));const _0xc90129=[];for(const _0xc87cfc of _0x4778a0){const _0xba78b3=await this[_0x3e6229(0x141)][_0x3e6229(0x111)](_0xc87cfc[_0x3e6229(0x137)],!![]);_0xc90129[_0x3e6229(0x13c)]({'body':_0xba78b3[_0x3e6229(0x139)](_0x3e6229(0x10b)),'fileName':_0xc87cfc['fileName'],'fileType':_0xc87cfc[_0x3e6229(0x138)]}),this['logger'][_0x3e6229(0x120)](_0x3e6229(0x135),_0xc90129[_0x3e6229(0x11f)],_0x2fc8fc[_0x3e6229(0x11f)]);}return _0xc90129;}async['run'](_0x1fa2ae){const _0x4d2ec4=a237_0x20a976,_0x48e069=[..._0x1fa2ae],_0x2a3ec4=[],_0x4d5ec3=[];while(_0x48e069['length']){const _0x4eb5ea=_0x48e069[_0x4d2ec4(0x133)](0x0,this[_0x4d2ec4(0x13a)]),_0x7c8733=await this[_0x4d2ec4(0x141)][_0x4d2ec4(0x122)](_0x4eb5ea);_0x4eb5ea[_0x4d2ec4(0x11f)]!==_0x7c8733['ids'][_0x4d2ec4(0x11f)]?(_0x48e069[_0x4d2ec4(0x13c)](..._0x7c8733['ids']),_0x2a3ec4[_0x4d2ec4(0x13c)](..._0x7c8733[_0x4d2ec4(0x12a)])):_0x4d5ec3['push'](..._0x4eb5ea),this[_0x4d2ec4(0x126)][_0x4d2ec4(0x115)](_0x4d2ec4(0x10c),_0x1fa2ae[_0x4d2ec4(0x11f)]-_0x48e069[_0x4d2ec4(0x11f)],_0x1fa2ae[_0x4d2ec4(0x11f)]);}if(_0x4d5ec3[_0x4d2ec4(0x11f)]){const _0x192720=await this[_0x4d2ec4(0x112)](_0x4d5ec3);_0x2a3ec4['push'](..._0x192720);}return _0x2a3ec4;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;function a237_0x4186(){const _0x53b1f2=['fileType','toString','COMPONENTS_PER_REQUEST','name','push','156tkpnrG','(((.+)+)+)+$','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','join','salesforceService','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','retrieveComponentIdsFromHistoryIds','all','search','796120QNdFat','base64','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','SalesforceRetrieverService','fromSalesforce','SalesforceQueryService','default','retrieveAttachment','retrieveLastComponents','Name','COMPONENTS_PER_QUERY','log','1908168fMFqJG','7406EGpfZK','map','get','GET_COMPONENT_HISTORIES_BY_IDS','then','../../../../core','../dto/flosum-component-history.dto','defineProperty','length','info','manually\x20retrieving\x20components\x20from\x20salesforce','retrieveComponents','Logger','10333642KsXmdt','typedi','logger','81anduFX','filename','FlosumComponentHistoryDto','components','25GVsIOs','742735OxtUfX','query','ParentId','constructor','36lUQDOT','replace','413216gQmilW','splice','__importDefault','manually\x20retrieved\x20%d/%d\x20components','621674vTEeda','attachmentId'];a237_0x4186=function(){return _0x53b1f2;};return a237_0x4186();}