const a203_0x29e4f5=a203_0x24d0;(function(_0xf33ad6,_0x3cda20){const _0x502554=a203_0x24d0,_0x631840=_0xf33ad6();while(!![]){try{const _0x50ff67=-parseInt(_0x502554(0x1e3))/0x1+parseInt(_0x502554(0x1d3))/0x2*(parseInt(_0x502554(0x1b9))/0x3)+-parseInt(_0x502554(0x1e8))/0x4+parseInt(_0x502554(0x1cb))/0x5*(parseInt(_0x502554(0x1e7))/0x6)+parseInt(_0x502554(0x1d6))/0x7+parseInt(_0x502554(0x1d0))/0x8+-parseInt(_0x502554(0x1c9))/0x9;if(_0x50ff67===_0x3cda20)break;else _0x631840['push'](_0x631840['shift']());}catch(_0x42241e){_0x631840['push'](_0x631840['shift']());}}}(a203_0x5704,0xba8fa));const a203_0xfea5b8=(function(){let _0x4e71d6=!![];return function(_0x185c09,_0x2c52eb){const _0x435989=_0x4e71d6?function(){const _0xac4a6f=a203_0x24d0;if(_0x2c52eb){const _0x16da28=_0x2c52eb[_0xac4a6f(0x1b6)](_0x185c09,arguments);return _0x2c52eb=null,_0x16da28;}}:function(){};return _0x4e71d6=![],_0x435989;};}()),a203_0xc2ba24=a203_0xfea5b8(this,function(){const _0x2d0f17=a203_0x24d0;return a203_0xc2ba24[_0x2d0f17(0x1e5)]()[_0x2d0f17(0x1c6)](_0x2d0f17(0x1c2))[_0x2d0f17(0x1e5)]()[_0x2d0f17(0x1b8)](a203_0xc2ba24)[_0x2d0f17(0x1c6)](_0x2d0f17(0x1c2));});a203_0xc2ba24();'use strict';var __importDefault=this&&this[a203_0x29e4f5(0x1d8)]||function(_0x29f16e){return _0x29f16e&&_0x29f16e['__esModule']?_0x29f16e:{'default':_0x29f16e};};Object[a203_0x29e4f5(0x1dd)](exports,a203_0x29e4f5(0x1d9),{'value':!![]}),exports[a203_0x29e4f5(0x1dc)]=void 0x0;const core_1=require(a203_0x29e4f5(0x1bf)),typedi_1=__importDefault(require(a203_0x29e4f5(0x1ea))),salesforce_query_service_1=require(a203_0x29e4f5(0x1d1)),queries_1=require('../queries'),flosum_component_history_dto_1=require(a203_0x29e4f5(0x1bc));function a203_0x24d0(_0x4c1656,_0x1aa55a){const _0x2f8899=a203_0x5704();return a203_0x24d0=function(_0xc2ba24,_0xfea5b8){_0xc2ba24=_0xc2ba24-0x1b3;let _0x5704d6=_0x2f8899[_0xc2ba24];return _0x5704d6;},a203_0x24d0(_0x4c1656,_0x1aa55a);}class SalesforceRetrieverService{constructor(_0x3a1edf){const _0x16dd33=a203_0x29e4f5;this[_0x16dd33(0x1b5)]=_0x3a1edf,this[_0x16dd33(0x1d5)]=new core_1[(_0x16dd33(0x1da))](SalesforceRetrieverService['name']),this[_0x16dd33(0x1ec)]=0xbb8,this[_0x16dd33(0x1b7)]=0x1f4;}async[a203_0x29e4f5(0x1b3)](_0x2856b3){const _0x379996=a203_0x29e4f5;this[_0x379996(0x1d5)][_0x379996(0x1d4)]('manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)',_0x2856b3[_0x379996(0x1bd)]);const _0x3d298c=typedi_1[_0x379996(0x1db)]['get'](salesforce_query_service_1['SalesforceQueryService']),_0x425e4b=_0x2856b3[_0x379996(0x1d2)](_0xacd13e=>'\x27'+_0xacd13e+'\x27'),_0x4806c9=[];while(_0x425e4b[_0x379996(0x1bd)]){const _0x423632=_0x425e4b[_0x379996(0x1df)](0x0,this[_0x379996(0x1b7)]),_0x5e71f7=_0x3d298c[_0x379996(0x1be)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY']['replace'](_0x379996(0x1e1),_0x423632[_0x379996(0x1e6)]())),_0x447366=_0x3d298c['query'](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x379996(0x1c4)](_0x379996(0x1e9),_0x423632[_0x379996(0x1e6)]()))['then'](_0x287028=>_0x287028[_0x379996(0x1d2)](_0x4e5deb=>flosum_component_history_dto_1[_0x379996(0x1bb)]['fromSalesforce'](_0x4e5deb))),[_0x110762,_0x2e8b70]=await Promise['all']([_0x5e71f7,_0x447366]);for(const _0x49fbe1 of _0x2e8b70){const _0x48b53e=_0x110762[_0x379996(0x1c3)](_0x2d9cf2=>_0x2d9cf2[_0x379996(0x1eb)]===_0x49fbe1['id']);_0x48b53e&&_0x4806c9[_0x379996(0x1e2)]({'fileType':_0x48b53e[_0x379996(0x1ce)],'fileName':_0x49fbe1[_0x379996(0x1ca)],'attachmentId':_0x48b53e['Id']});}}return _0x4806c9;}async[a203_0x29e4f5(0x1de)](_0x26dc48){const _0x2bbcc2=a203_0x29e4f5,_0x470635=await this[_0x2bbcc2(0x1b3)](_0x26dc48);this[_0x2bbcc2(0x1d5)][_0x2bbcc2(0x1d4)](_0x2bbcc2(0x1c1));const _0x25e50f=[];for(const _0x5f1a50 of _0x470635){const _0x258eb3=await this[_0x2bbcc2(0x1b5)][_0x2bbcc2(0x1e4)](_0x5f1a50[_0x2bbcc2(0x1c0)],!![]);_0x25e50f[_0x2bbcc2(0x1e2)]({'body':_0x258eb3[_0x2bbcc2(0x1e5)](_0x2bbcc2(0x1cf)),'fileName':_0x5f1a50[_0x2bbcc2(0x1cd)],'fileType':_0x5f1a50[_0x2bbcc2(0x1c5)]}),this[_0x2bbcc2(0x1d5)][_0x2bbcc2(0x1d4)](_0x2bbcc2(0x1d7),_0x25e50f[_0x2bbcc2(0x1bd)],_0x26dc48[_0x2bbcc2(0x1bd)]);}return _0x25e50f;}async[a203_0x29e4f5(0x1e0)](_0x32048e){const _0x3faa91=a203_0x29e4f5,_0x2585ed=[..._0x32048e],_0x3318dc=[],_0x15b51a=[];while(_0x2585ed[_0x3faa91(0x1bd)]){const _0x1225de=_0x2585ed['splice'](0x0,this[_0x3faa91(0x1ec)]),_0x290f57=await this[_0x3faa91(0x1b5)][_0x3faa91(0x1cc)](_0x1225de);_0x1225de[_0x3faa91(0x1bd)]!==_0x290f57['ids'][_0x3faa91(0x1bd)]?(_0x2585ed['push'](..._0x290f57[_0x3faa91(0x1b4)]),_0x3318dc[_0x3faa91(0x1e2)](..._0x290f57[_0x3faa91(0x1ba)])):_0x15b51a[_0x3faa91(0x1e2)](..._0x1225de),this['logger'][_0x3faa91(0x1c7)](_0x3faa91(0x1c8),_0x32048e[_0x3faa91(0x1bd)]-_0x2585ed[_0x3faa91(0x1bd)],_0x32048e[_0x3faa91(0x1bd)]);}if(_0x15b51a[_0x3faa91(0x1bd)]){const _0x513ca2=await this[_0x3faa91(0x1de)](_0x15b51a);_0x3318dc[_0x3faa91(0x1e2)](..._0x513ca2);}return _0x3318dc;}}function a203_0x5704(){const _0x5bf147=['ParentId','COMPONENTS_PER_REQUEST','retrieveComponentIdsFromHistoryIds','ids','salesforceService','apply','COMPONENTS_PER_QUERY','constructor','772293lhUqJA','components','FlosumComponentHistoryDto','../dto/flosum-component-history.dto','length','query','../../../../core','attachmentId','manually\x20retrieving\x20components\x20from\x20salesforce','(((.+)+)+)+$','find','replace','fileType','search','log','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','7633845qlLtYj','filename','25hMEBLF','retrieveComponents','fileName','Name','base64','667064HhlDwF','./salesforce-query.service','map','10ESFNkd','info','logger','9163819pINeJD','manually\x20retrieved\x20%d/%d\x20components','__importDefault','__esModule','Logger','default','SalesforceRetrieverService','defineProperty','retrieveLastComponents','splice','run','%parent_ids%','push','684639WtrvEa','retrieveAttachment','toString','join','1329930iFTJfN','5963728symGpV','%ids%','typedi'];a203_0x5704=function(){return _0x5bf147;};return a203_0x5704();}exports['SalesforceRetrieverService']=SalesforceRetrieverService;