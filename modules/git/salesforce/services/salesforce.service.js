const a206_0x59e35a=a206_0x1324;(function(_0x307e03,_0xaf5c4){const _0x28e60e=a206_0x1324,_0x559e58=_0x307e03();while(!![]){try{const _0x152e96=parseInt(_0x28e60e(0xac))/0x1+parseInt(_0x28e60e(0xc6))/0x2*(parseInt(_0x28e60e(0xc4))/0x3)+-parseInt(_0x28e60e(0x91))/0x4*(parseInt(_0x28e60e(0x90))/0x5)+-parseInt(_0x28e60e(0x94))/0x6*(parseInt(_0x28e60e(0xa6))/0x7)+parseInt(_0x28e60e(0x92))/0x8+-parseInt(_0x28e60e(0x8c))/0x9*(-parseInt(_0x28e60e(0xb1))/0xa)+-parseInt(_0x28e60e(0xb7))/0xb;if(_0x152e96===_0xaf5c4)break;else _0x559e58['push'](_0x559e58['shift']());}catch(_0x3ff0b2){_0x559e58['push'](_0x559e58['shift']());}}}(a206_0x3fd9,0x456ea));function a206_0x1324(_0xddba81,_0x334778){const _0x12c669=a206_0x3fd9();return a206_0x1324=function(_0xe532e9,_0x5b83a0){_0xe532e9=_0xe532e9-0x8a;let _0x3fd9bf=_0x12c669[_0xe532e9];return _0x3fd9bf;},a206_0x1324(_0xddba81,_0x334778);}const a206_0x5b83a0=(function(){let _0x4c50f9=!![];return function(_0x44b7f2,_0xc7a074){const _0x588f14=_0x4c50f9?function(){const _0x44c21d=a206_0x1324;if(_0xc7a074){const _0x1b6a45=_0xc7a074[_0x44c21d(0xc3)](_0x44b7f2,arguments);return _0xc7a074=null,_0x1b6a45;}}:function(){};return _0x4c50f9=![],_0x588f14;};}()),a206_0xe532e9=a206_0x5b83a0(this,function(){const _0x4f0ca9=a206_0x1324;return a206_0xe532e9[_0x4f0ca9(0x9b)]()[_0x4f0ca9(0x8b)]('(((.+)+)+)+$')[_0x4f0ca9(0x9b)]()[_0x4f0ca9(0xbf)](a206_0xe532e9)[_0x4f0ca9(0x8b)](_0x4f0ca9(0xc0));});a206_0xe532e9();'use strict';var __decorate=this&&this[a206_0x59e35a(0xbc)]||function(_0x177872,_0x266549,_0x2217db,_0x41004b){const _0x5d4cfa=a206_0x59e35a;var _0x4bf17f=arguments['length'],_0x2361de=_0x4bf17f<0x3?_0x266549:_0x41004b===null?_0x41004b=Object[_0x5d4cfa(0xb6)](_0x266549,_0x2217db):_0x41004b,_0x134abb;if(typeof Reflect===_0x5d4cfa(0xb8)&&typeof Reflect['decorate']==='function')_0x2361de=Reflect['decorate'](_0x177872,_0x266549,_0x2217db,_0x41004b);else{for(var _0x333566=_0x177872[_0x5d4cfa(0xa3)]-0x1;_0x333566>=0x0;_0x333566--)if(_0x134abb=_0x177872[_0x333566])_0x2361de=(_0x4bf17f<0x3?_0x134abb(_0x2361de):_0x4bf17f>0x3?_0x134abb(_0x266549,_0x2217db,_0x2361de):_0x134abb(_0x266549,_0x2217db))||_0x2361de;}return _0x4bf17f>0x3&&_0x2361de&&Object[_0x5d4cfa(0xa9)](_0x266549,_0x2217db,_0x2361de),_0x2361de;},__metadata=this&&this[a206_0x59e35a(0xb3)]||function(_0x1b1b1c,_0x5e9e96){const _0x737a8c=a206_0x59e35a;if(typeof Reflect===_0x737a8c(0xb8)&&typeof Reflect[_0x737a8c(0x9f)]===_0x737a8c(0xad))return Reflect[_0x737a8c(0x9f)](_0x1b1b1c,_0x5e9e96);},__param=this&&this['__param']||function(_0x3cedb7,_0x162dbf){return function(_0x261957,_0x5e0ab1){_0x162dbf(_0x261957,_0x5e0ab1,_0x3cedb7);};},SalesforceService_1;Object['defineProperty'](exports,a206_0x59e35a(0xb4),{'value':!![]}),exports[a206_0x59e35a(0xcd)]=void 0x0;function a206_0x3fd9(){const _0x10e22e=['7ysmOnb','design:paramtypes','IGNORE_FLOSUM_GIT_NAMESPACE','defineProperty','createObject','/body','196553mnDVoM','function','log','sendLog','/flosum_git','1570yOygpY','loggerId','__metadata','__esModule','retrieve\x20attachment\x20%s\x20from\x20salesforce','getOwnPropertyDescriptor','3849615ttGFEy','object','deleteAttachment','post','/sobjects/Attachment/','__decorate','/logger','retrieve\x20components\x20\x20%d\x20from\x20salesforce','constructor','(((.+)+)+)+$','Logger','internalLogger','apply','9EKinZF','[message]\x20%s','20506ypwjTi','./salesforce-logger.service','services/apexrest','retrieveComponents','../../../../core/errors/internal-server.error','fetchConnection','SalesforceError','SalesforceService','SALESFORCE_API_VERSION','then','../dto/connection.dto','search','25434khvWJl','ConnectionDto','namespace','arraybuffer','78105lDHpVe','4pQIcFc','1474672rfBfTi','error','1232088feKvDI','../errors/salesforce.error','logger','/attachments','request','createSalesforceRequest','delete','toString','../utils/create-request.util','Service','get','metadata','setLoggerId','services/data/','patchObject','length','InternalServerError','patch'];a206_0x3fd9=function(){return _0x10e22e;};return a206_0x3fd9();}const typedi_1=require('typedi'),core_1=require('../../../../core'),internal_server_error_1=require(a206_0x59e35a(0xca)),salesforce_auth_service_1=require('./salesforce-auth.service'),constants_1=require('../../../../constants'),create_request_util_1=require(a206_0x59e35a(0x9c)),salesforce_logger_service_1=require(a206_0x59e35a(0xc7)),salesforce_error_1=require(a206_0x59e35a(0x95)),connection_dto_1=require(a206_0x59e35a(0x8a));let SalesforceService=SalesforceService_1=class SalesforceService{constructor(_0x169b3d){const _0x2391c2=a206_0x59e35a;this[_0x2391c2(0x96)]=new core_1[(_0x2391c2(0xc1))](SalesforceService_1['name']),this[_0x2391c2(0x98)]=(0x0,create_request_util_1[_0x2391c2(0x99)])(_0x169b3d),this['namespace']=constants_1[_0x2391c2(0xa8)]?'':_0x2391c2(0xb0);}[a206_0x59e35a(0xa0)](_0x5dce9d){const _0x20af84=a206_0x59e35a;this[_0x20af84(0xb2)]=_0x5dce9d,this[_0x20af84(0xc2)]=new salesforce_logger_service_1['SalesforceLogger'](this);}['getLogger'](){const _0x24fd50=a206_0x59e35a;return this[_0x24fd50(0xc2)];}async[a206_0x59e35a(0xc9)](_0x1d16a3){const _0x355131=a206_0x59e35a;try{this[_0x355131(0x96)]['log'](_0x355131(0xbe),_0x1d16a3[_0x355131(0xa3)]);const _0x293149=await this['request']['post'](_0x355131(0xc8)+this['namespace']+_0x355131(0x97),{'componentIds':_0x1d16a3,'loggerId':this['loggerId']})[_0x355131(0xcf)](({data:_0x319db4})=>_0x319db4);return _0x293149;}catch(_0x19075d){this[_0x355131(0x96)][_0x355131(0x93)](_0x19075d);throw new salesforce_error_1[(_0x355131(0xcc))](_0x19075d);}}async[a206_0x59e35a(0xb9)](_0x588cfe){const _0x4e40ce=a206_0x59e35a;try{this['logger']['log']('delete\x20attachment\x20%s\x20from\x20salesforce',_0x588cfe),await this[_0x4e40ce(0x98)][_0x4e40ce(0x9a)](_0x4e40ce(0xa1)+constants_1['SALESFORCE_API_VERSION']+_0x4e40ce(0xbb)+_0x588cfe);}catch(_0xa3abb2){this[_0x4e40ce(0x96)][_0x4e40ce(0x93)](_0xa3abb2);throw new salesforce_error_1[(_0x4e40ce(0xcc))](_0xa3abb2);}}async['retrieveAttachment'](_0x3e0574,_0x1bd398=![]){const _0xaf660e=a206_0x59e35a;try{this[_0xaf660e(0x96)][_0xaf660e(0xae)](_0xaf660e(0xb5),_0x3e0574);const _0x22de6a=await this['request']['get'](_0xaf660e(0xa1)+constants_1['SALESFORCE_API_VERSION']+_0xaf660e(0xbb)+_0x3e0574+_0xaf660e(0xab),{'responseType':_0x1bd398?_0xaf660e(0x8f):'text'})[_0xaf660e(0xcf)](({data:_0x4e3dde})=>_0x4e3dde);return _0x22de6a;}catch(_0x10f8f7){this[_0xaf660e(0x96)][_0xaf660e(0x93)](_0x10f8f7);throw new salesforce_error_1['SalesforceError'](_0x10f8f7);}}async[a206_0x59e35a(0xaf)](_0x4c338e){const _0x4dd99d=a206_0x59e35a;try{_0x4c338e['forEach'](_0x379ebd=>this[_0x4dd99d(0x96)]['log'](_0x4dd99d(0xc5),_0x379ebd)),await this['request'][_0x4dd99d(0xba)](_0x4dd99d(0xc8)+this['namespace']+_0x4dd99d(0xbd),{'messages':_0x4c338e,'loggerId':this[_0x4dd99d(0xb2)]});}catch(_0x185087){this[_0x4dd99d(0x96)][_0x4dd99d(0x93)](_0x185087);throw new internal_server_error_1[(_0x4dd99d(0xa4))](_0x185087);}}async[a206_0x59e35a(0xaa)](_0x80e3b3,_0x344ea6){const _0x252b1e=a206_0x59e35a;try{const {data:_0x145863}=await this[_0x252b1e(0x98)]['post'](_0x252b1e(0xa1)+constants_1[_0x252b1e(0xce)]+'/sobjects/'+_0x80e3b3+'/',_0x344ea6);return _0x145863['id'];}catch(_0x1b668b){throw new salesforce_error_1[(_0x252b1e(0xcc))](_0x1b668b);}}async[a206_0x59e35a(0xa2)](_0x4ca3b6,_0x178c79,_0x11ecc0){const _0x133a7b=a206_0x59e35a;try{await this[_0x133a7b(0x98)][_0x133a7b(0xa5)]('services/data/'+constants_1[_0x133a7b(0xce)]+'/sobjects/'+_0x4ca3b6+'/'+_0x178c79,_0x11ecc0);}catch(_0x964894){throw new salesforce_error_1[(_0x133a7b(0xcc))](_0x964894);}}async[a206_0x59e35a(0xcb)](_0x5cb775){const _0x2acbe9=a206_0x59e35a;try{const {data:_0x2524f7}=await this[_0x2acbe9(0x98)][_0x2acbe9(0x9e)](_0x2acbe9(0xc8)+this[_0x2acbe9(0x8e)]+'/connection',{'params':{'connectionId':_0x5cb775}});return new connection_dto_1[(_0x2acbe9(0x8d))](_0x2524f7);}catch(_0x3d4306){throw new salesforce_error_1['SalesforceError'](_0x3d4306);}}};SalesforceService=SalesforceService_1=__decorate([(0x0,typedi_1[a206_0x59e35a(0x9d)])({'transient':!![]}),__param(0x0,(0x0,typedi_1['Inject'])()),__metadata(a206_0x59e35a(0xa7),[salesforce_auth_service_1['SalesforceAuthService']])],SalesforceService),exports['SalesforceService']=SalesforceService;