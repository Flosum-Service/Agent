const a194_0x24a24c=a194_0x2b4d;(function(_0x3d925b,_0x1f9815){const _0x10dcb8=a194_0x2b4d,_0x95cc04=_0x3d925b();while(!![]){try{const _0x5e8d2f=-parseInt(_0x10dcb8(0x135))/0x1+parseInt(_0x10dcb8(0x15a))/0x2+-parseInt(_0x10dcb8(0x13a))/0x3+parseInt(_0x10dcb8(0x11f))/0x4*(parseInt(_0x10dcb8(0x14d))/0x5)+parseInt(_0x10dcb8(0x13c))/0x6+-parseInt(_0x10dcb8(0x14a))/0x7+-parseInt(_0x10dcb8(0x145))/0x8*(-parseInt(_0x10dcb8(0x16e))/0x9);if(_0x5e8d2f===_0x1f9815)break;else _0x95cc04['push'](_0x95cc04['shift']());}catch(_0xcec9a9){_0x95cc04['push'](_0x95cc04['shift']());}}}(a194_0x42ab,0x7848c));const a194_0x1c3c6d=(function(){let _0x58c657=!![];return function(_0x467601,_0x9cd5df){const _0x28595c=_0x58c657?function(){const _0x5b055a=a194_0x2b4d;if(_0x9cd5df){const _0x5c3ef0=_0x9cd5df[_0x5b055a(0x16d)](_0x467601,arguments);return _0x9cd5df=null,_0x5c3ef0;}}:function(){};return _0x58c657=![],_0x28595c;};}()),a194_0x236516=a194_0x1c3c6d(this,function(){const _0x59588e=a194_0x2b4d;return a194_0x236516[_0x59588e(0x123)]()[_0x59588e(0x175)](_0x59588e(0x16b))[_0x59588e(0x123)]()['constructor'](a194_0x236516)[_0x59588e(0x175)](_0x59588e(0x16b));});function a194_0x42ab(){const _0x5c54ce=['getProceededComponentsMeta','2417949fQvJUM',']\x20-\x20meta\x20not\x20found','3324924BqoSKb','Is_From_Agent__c','Component__c','reference','createZip','createPatchRequest','../../../../core','prepareCommitManifest','map','610016jVzfjK','file','ContentType','.id}','name','4327400TpGDea','gitSync','Component_History__c','790OALQya','componentName','body','Version__c','delete','get','application/zip','../utils/composite.utils','type','componentsToDelete','../errors/salesforce.error','Component_Name__c','FLOSUM_COMPONENT_HISTORY','1152806qGZsBE','Branch__c','componentId','request','crc','prepareComponentAttachmentRecord','files','createPostRequest','Zip','keys','Repository','FLOSUM_GIT_NAMESPACE','filePath','Component_Type__c','File_Name__c','./salesforce-git-sync.service','SalesforceGitSyncService','(((.+)+)+)+$','manifests','apply','63TIoiXr','update','RecordTypeId','default','defineProperty','SalesforceComponentsManager','repositoryId','search','Last_Modified_By__c','__esModule','componentType','push','find','createDeleteRequest','__importDefault','ParentId','branchId','Branch','Last_Modified_Date__c','FLOSUM_NAMESPACE','24340rzyqBT','typedi','SalesforceError','Logger','toString','Changed_By__c','Source__c','username','FLOSUM_COMMIT_MANIFEST','version','Deletion_By_Agent__c','componentsToUpdate','proceededComponentsMeta','insert','recordTypes','prepareComponentRecord','fetchCommitManifestsByComponentIds','toISOString','FLOSUM_COMPONENT','CRC32__c','Commit__c','prepareComponentHistoryRecord','708884qRAIyU','../../../../constants','proceedComponentMeta','FLOSUM_ATTACHMENT'];a194_0x42ab=function(){return _0x5c54ce;};return a194_0x42ab();}a194_0x236516();function a194_0x2b4d(_0x564c41,_0x547f9c){const _0x52efb2=a194_0x42ab();return a194_0x2b4d=function(_0x236516,_0x1c3c6d){_0x236516=_0x236516-0x114;let _0x42ab3c=_0x52efb2[_0x236516];return _0x42ab3c;},a194_0x2b4d(_0x564c41,_0x547f9c);}'use strict';var __importDefault=this&&this[a194_0x24a24c(0x119)]||function(_0x1c71da){return _0x1c71da&&_0x1c71da['__esModule']?_0x1c71da:{'default':_0x1c71da};};Object[a194_0x24a24c(0x172)](exports,a194_0x24a24c(0x114),{'value':!![]}),exports[a194_0x24a24c(0x173)]=void 0x0;const constants_1=require(a194_0x24a24c(0x136)),core_1=require(a194_0x24a24c(0x142)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require(a194_0x24a24c(0x120))),salesforce_error_1=require(a194_0x24a24c(0x157)),composite_utils_1=require(a194_0x24a24c(0x154)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a194_0x24a24c(0x169));class SalesforceComponentsManager{constructor(_0x5844ec,_0x44dbf9,_0x10235d,_0x2425d7,_0x39ef55){const _0x1ad631=a194_0x24a24c;this[_0x1ad631(0x174)]=_0x5844ec,this[_0x1ad631(0x11b)]=_0x44dbf9,this[_0x1ad631(0x126)]=_0x10235d,this[_0x1ad631(0x12d)]=_0x2425d7,this[_0x1ad631(0x12b)]=_0x39ef55,this['logger']=new core_1[(_0x1ad631(0x122))](SalesforceComponentsManager[_0x1ad631(0x149)]),this[_0x1ad631(0x14b)]=typedi_1[_0x1ad631(0x171)][_0x1ad631(0x152)](salesforce_git_sync_service_1[_0x1ad631(0x16a)]);}[a194_0x24a24c(0x137)](_0x4e22d2,_0x2ebfb5){const _0x594865=a194_0x24a24c,_0x38e3a5=(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x4e22d2,[_0x594865(0x167),_0x594865(0x158),_0x594865(0x150)]);this[_0x594865(0x12b)][_0x594865(0x116)]({'componentId':'','reference':_0x2ebfb5,'version':_0x38e3a5[_0x594865(0x150)],'componentName':_0x38e3a5['Component_Name__c'],'componentType':_0x38e3a5[_0x594865(0x167)]});}[a194_0x24a24c(0x143)](_0x223499,_0x4eddd3){const _0x19d38f=a194_0x24a24c,{request:_0x2f1c8b}=(0x0,composite_utils_1[_0x19d38f(0x161)])(constants_1[_0x19d38f(0x127)],{[constants_1[_0x19d38f(0x11e)]+_0x19d38f(0x133)]:_0x223499,[constants_1[_0x19d38f(0x11e)]+_0x19d38f(0x14c)]:_0x4eddd3});return _0x2f1c8b;}async[a194_0x24a24c(0x15f)](_0x3d2c10,_0x1da241){const _0x4a2fa2=a194_0x24a24c,_0x414c2c={},_0x2257ad=zip_1[_0x4a2fa2(0x162)][_0x4a2fa2(0x140)]();for(const _0x2f02ba of Object[_0x4a2fa2(0x163)](_0x3d2c10[_0x4a2fa2(0x160)])){_0x2257ad[_0x4a2fa2(0x146)](_0x2f02ba,_0x3d2c10['files'][_0x2f02ba],{'createFolders':!![]});}return _0x414c2c[_0x4a2fa2(0x147)]=_0x4a2fa2(0x153),_0x414c2c['Name']=_0x3d2c10[_0x4a2fa2(0x155)],_0x414c2c['Description']=_0x3d2c10[_0x4a2fa2(0x155)],_0x414c2c[_0x4a2fa2(0x11a)]=_0x1da241,_0x414c2c['Body']=await _0x2257ad['generateAsync']({'type':'base64','compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x414c2c;}[a194_0x24a24c(0x134)](_0x50bb36,_0x4d1626,_0x2a211c){const _0x2df5cd=a194_0x24a24c,_0x591408=new Date()[_0x2df5cd(0x130)](),_0x49438b={};return _0x49438b[constants_1[_0x2df5cd(0x11e)]+_0x2df5cd(0x13e)]=_0x4d1626,_0x49438b[constants_1['FLOSUM_NAMESPACE']+_0x2df5cd(0x132)]=_0x50bb36[_0x2df5cd(0x15e)],_0x49438b[constants_1[_0x2df5cd(0x11e)]+'Changed_On__c']=_0x591408,_0x49438b[constants_1[_0x2df5cd(0x11e)]+_0x2df5cd(0x124)]=this[_0x2df5cd(0x126)],_0x49438b[constants_1[_0x2df5cd(0x11e)]+_0x2df5cd(0x150)]=_0x2a211c?_0x2a211c+0x1:0x1,_0x49438b[constants_1[_0x2df5cd(0x165)]+_0x2df5cd(0x13d)]=!![],_0x49438b;}[a194_0x24a24c(0x12e)](_0x496baa,_0x5e28f8){const _0x59698f=a194_0x24a24c;var _0x373779,_0x39a248;const _0x5563e8=new Date()[_0x59698f(0x130)](),_0x30908a={};return!_0x5e28f8?(this[_0x59698f(0x11b)]?(_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x15b)]=this['branchId'],_0x30908a[constants_1['FLOSUM_NAMESPACE']+_0x59698f(0x125)]='Branch',_0x30908a[_0x59698f(0x170)]=(_0x373779=this[_0x59698f(0x12d)][_0x59698f(0x117)](_0x17a3e7=>_0x17a3e7[_0x59698f(0x149)]===_0x59698f(0x11c)))===null||_0x373779===void 0x0?void 0x0:_0x373779['id']):(_0x30908a[constants_1[_0x59698f(0x11e)]+'Repository__c']=this[_0x59698f(0x174)],_0x30908a[constants_1[_0x59698f(0x11e)]+'Source__c']=_0x59698f(0x164),_0x30908a['RecordTypeId']=(_0x39a248=this[_0x59698f(0x12d)][_0x59698f(0x117)](_0x288e61=>_0x288e61[_0x59698f(0x149)]===_0x59698f(0x164)))===null||_0x39a248===void 0x0?void 0x0:_0x39a248['id']),_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x150)]=0x1):_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x150)]=_0x5e28f8[_0x59698f(0x128)]+0x1,_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x167)]=_0x496baa[_0x59698f(0x155)],_0x30908a[constants_1[_0x59698f(0x11e)]+'Component_Name__c']=_0x496baa[_0x59698f(0x149)],_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x168)]=_0x496baa[_0x59698f(0x166)],_0x30908a[constants_1['FLOSUM_NAMESPACE']+'Last_Updated_By__c']=this['username'],_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x176)]=this[_0x59698f(0x126)],_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x11d)]=_0x5563e8,_0x30908a[constants_1[_0x59698f(0x11e)]+'Committed_On__c']=_0x5563e8,_0x30908a[constants_1[_0x59698f(0x11e)]+_0x59698f(0x132)]=_0x496baa[_0x59698f(0x15e)],_0x30908a;}[a194_0x24a24c(0x139)](){const _0x3802c1=a194_0x24a24c;return this[_0x3802c1(0x12b)];}async[a194_0x24a24c(0x12c)](_0x5a40a6,_0x21c5aa){const _0x1b3547=a194_0x24a24c,_0x2421d3=[];for(const _0xcb6750 of _0x5a40a6){const _0x3f49e9=(0x0,composite_utils_1[_0x1b3547(0x161)])(constants_1[_0x1b3547(0x131)],this[_0x1b3547(0x12e)](_0xcb6750)),_0x5c7658=(0x0,composite_utils_1[_0x1b3547(0x161)])(constants_1[_0x1b3547(0x159)],this[_0x1b3547(0x134)](_0xcb6750,'@{'+_0x3f49e9[_0x1b3547(0x13f)]+'.id}')),_0x16c77b=(0x0,composite_utils_1[_0x1b3547(0x161)])(constants_1[_0x1b3547(0x138)],await this[_0x1b3547(0x15f)](_0xcb6750,'@{'+_0x5c7658[_0x1b3547(0x13f)]+_0x1b3547(0x148)));this[_0x1b3547(0x137)](_0x3f49e9[_0x1b3547(0x15d)][_0x1b3547(0x14f)],_0x3f49e9[_0x1b3547(0x13f)]),_0x2421d3[_0x1b3547(0x116)](_0x3f49e9['request'],_0x5c7658[_0x1b3547(0x15d)],_0x16c77b[_0x1b3547(0x15d)]),_0x21c5aa&&_0x2421d3[_0x1b3547(0x116)](this[_0x1b3547(0x143)](_0x21c5aa,'@{'+_0x5c7658[_0x1b3547(0x13f)]+_0x1b3547(0x148)));}return _0x2421d3;}async[a194_0x24a24c(0x16f)](_0xc202b4,_0x3cfa88=''){const _0x2b7651=a194_0x24a24c,_0x59a83b=[];for(const {component:_0x2ed85d,meta:_0xd29315}of _0xc202b4){if(!_0xd29315['id']){const _0x49823f=this[_0x2b7651(0x12b)][_0x2b7651(0x117)](_0x2a54bb=>_0x2a54bb['componentName']===_0x2ed85d[_0x2b7651(0x149)]&&_0x2a54bb[_0x2b7651(0x115)]===_0x2ed85d[_0x2b7651(0x155)]);if(!_0x49823f)throw new salesforce_error_1[(_0x2b7651(0x121))](new Error('Could\x20not\x20proceed\x20component\x20'+_0x2ed85d[_0x2b7651(0x149)]+'\x20['+_0x2ed85d[_0x2b7651(0x155)]+_0x2b7651(0x13b)));_0xd29315['id']=_0x49823f[_0x2b7651(0x15c)];}const _0x5871db=(0x0,composite_utils_1['createPatchRequest'])(constants_1[_0x2b7651(0x131)],_0xd29315['id'],this[_0x2b7651(0x12e)](_0x2ed85d,_0xd29315)),_0x426705=(0x0,composite_utils_1[_0x2b7651(0x161)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this['prepareComponentHistoryRecord'](_0x2ed85d,_0xd29315['id'],_0xd29315[_0x2b7651(0x128)])),_0x746a72=(0x0,composite_utils_1[_0x2b7651(0x161)])(constants_1[_0x2b7651(0x138)],await this[_0x2b7651(0x15f)](_0x2ed85d,'@{'+_0x426705['reference']+_0x2b7651(0x148)));this[_0x2b7651(0x137)](_0x5871db[_0x2b7651(0x15d)][_0x2b7651(0x14f)],_0x5871db[_0x2b7651(0x13f)]),_0x59a83b['push'](_0x5871db[_0x2b7651(0x15d)],_0x426705[_0x2b7651(0x15d)],_0x746a72[_0x2b7651(0x15d)]),_0x3cfa88&&_0x59a83b[_0x2b7651(0x116)](this[_0x2b7651(0x143)](_0x3cfa88,'@{'+_0x426705['reference']+_0x2b7651(0x148)));}return _0x59a83b;}async[a194_0x24a24c(0x151)](_0x1682c8,_0x59cfe5=![]){const _0x433c75=a194_0x24a24c,_0x423bc7={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x418fca=[];for(const _0x21c248 of _0x1682c8){if(_0x21c248['id'])_0x418fca[_0x433c75(0x116)](_0x21c248['id']);else{const _0x4b3814=this[_0x433c75(0x12b)][_0x433c75(0x117)](_0x31e053=>_0x31e053[_0x433c75(0x14e)]===_0x21c248['name']&&_0x31e053[_0x433c75(0x115)]===_0x21c248[_0x433c75(0x155)]);if(!_0x4b3814||!_0x4b3814[_0x433c75(0x15c)])continue;_0x418fca[_0x433c75(0x116)](_0x4b3814['componentId']);}}if(_0x59cfe5){const _0x345d69=await this[_0x433c75(0x14b)][_0x433c75(0x12f)](_0x418fca);_0x423bc7[_0x433c75(0x16c)]=_0x345d69['map'](_0x104a08=>(0x0,composite_utils_1[_0x433c75(0x118)])(constants_1[_0x433c75(0x127)],_0x104a08)[_0x433c75(0x15d)]);}return _0x423bc7[_0x433c75(0x12a)]=_0x418fca[_0x433c75(0x144)](_0x1bd84f=>(0x0,composite_utils_1[_0x433c75(0x141)])(constants_1['FLOSUM_COMPONENT'],_0x1bd84f,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x433c75(0x129)]:!![]})[_0x433c75(0x15d)]),_0x423bc7[_0x433c75(0x156)]=_0x418fca['map'](_0x1f5222=>(0x0,composite_utils_1[_0x433c75(0x118)])(constants_1['FLOSUM_COMPONENT'],_0x1f5222)['request']),_0x423bc7;}}exports['SalesforceComponentsManager']=SalesforceComponentsManager;