const a229_0x3a3f4b=a229_0x9047;(function(_0x47e6c5,_0x5ca28a){const _0x1561b8=a229_0x9047,_0x2057b7=_0x47e6c5();while(!![]){try{const _0xe2c6fe=-parseInt(_0x1561b8(0x176))/0x1+parseInt(_0x1561b8(0x17a))/0x2*(-parseInt(_0x1561b8(0x17e))/0x3)+-parseInt(_0x1561b8(0x1c8))/0x4+-parseInt(_0x1561b8(0x19f))/0x5+parseInt(_0x1561b8(0x1c0))/0x6*(-parseInt(_0x1561b8(0x17b))/0x7)+parseInt(_0x1561b8(0x187))/0x8*(parseInt(_0x1561b8(0x1d2))/0x9)+-parseInt(_0x1561b8(0x1b3))/0xa*(-parseInt(_0x1561b8(0x18e))/0xb);if(_0xe2c6fe===_0x5ca28a)break;else _0x2057b7['push'](_0x2057b7['shift']());}catch(_0x499b0f){_0x2057b7['push'](_0x2057b7['shift']());}}}(a229_0x3a8d,0x29edd));const a229_0x43ef99=(function(){let _0x9e689c=!![];return function(_0x1f5ab6,_0x22bc56){const _0x2633b2=_0x9e689c?function(){if(_0x22bc56){const _0x21cefd=_0x22bc56['apply'](_0x1f5ab6,arguments);return _0x22bc56=null,_0x21cefd;}}:function(){};return _0x9e689c=![],_0x2633b2;};}()),a229_0x1b3783=a229_0x43ef99(this,function(){const _0x47301e=a229_0x9047;return a229_0x1b3783[_0x47301e(0x194)]()[_0x47301e(0x1ce)](_0x47301e(0x186))[_0x47301e(0x194)]()[_0x47301e(0x1cf)](a229_0x1b3783)[_0x47301e(0x1ce)](_0x47301e(0x186));});a229_0x1b3783();function a229_0x9047(_0x23a2bc,_0x2f3903){const _0x10bc86=a229_0x3a8d();return a229_0x9047=function(_0x1b3783,_0x43ef99){_0x1b3783=_0x1b3783-0x174;let _0x3a8dd5=_0x10bc86[_0x1b3783];return _0x3a8dd5;},a229_0x9047(_0x23a2bc,_0x2f3903);}function a229_0x3a8d(){const _0x3d5384=['Commit__c','filePath','10886gcGBnC','63NXRMsN','Logger','version','165nauVMO','createPatchRequest','Component_History__c','../errors/salesforce.error','../utils/composite.utils','FLOSUM_COMPONENT_HISTORY','Deletion_By_Agent__c','./salesforce-git-sync.service','(((.+)+)+)+$','4608PADBKF','componentId','request','SalesforceGitSyncService','crc','prepareComponentHistoryRecord','componentsToUpdate','627QXRaGE','Is_From_Agent__c','Changed_By__c','componentName','defineProperty','generateAsync','toString','Body','FLOSUM_COMPONENT','Changed_On__c','.id}','body','Committed_On__c','ParentId','map','file','gitSync','1132670Xxlxum','Component_Type__c','SalesforceComponentsManager','prepareCommitManifest','ContentType','Description','find','type','username','application/zip','CRC32__c','Last_Modified_Date__c','repositoryId','DEFLATE','branchId','Last_Updated_By__c','Branch','createPostRequest','proceedComponentMeta','base64','224040tIakyH','prepareComponentAttachmentRecord','fetchCommitManifestsByComponentIds','toISOString','typedi','Zip','files','FLOSUM_ATTACHMENT','../../../../core','prepareComponentRecord','createDeleteRequest','FLOSUM_COMMIT_MANIFEST','__importDefault','201012fMZWRk','reference','Version__c','SalesforceError','Component_Name__c','Could\x20not\x20proceed\x20component\x20','../../parsers/utils/zip','proceededComponentsMeta','185244gSmige','logger','delete','componentType','insert','name','search','constructor','update','getProceededComponentsMeta','81tpmHSK','FLOSUM_GIT_NAMESPACE','push','Branch__c','createZip','Repository__c','RecordTypeId','Repository','keys','FLOSUM_NAMESPACE','__esModule','get','File_Name__c','236743argchO','recordTypes'];a229_0x3a8d=function(){return _0x3d5384;};return a229_0x3a8d();}'use strict';var __importDefault=this&&this[a229_0x3a3f4b(0x1bf)]||function(_0x3edf56){const _0x5aebf6=a229_0x3a3f4b;return _0x3edf56&&_0x3edf56[_0x5aebf6(0x1dc)]?_0x3edf56:{'default':_0x3edf56};};Object[a229_0x3a3f4b(0x192)](exports,a229_0x3a3f4b(0x1dc),{'value':!![]}),exports[a229_0x3a3f4b(0x1a1)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a229_0x3a3f4b(0x1bb)),zip_1=require(a229_0x3a3f4b(0x1c6)),typedi_1=__importDefault(require(a229_0x3a3f4b(0x1b7))),salesforce_error_1=require(a229_0x3a3f4b(0x181)),composite_utils_1=require(a229_0x3a3f4b(0x182)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a229_0x3a3f4b(0x185));class SalesforceComponentsManager{constructor(_0x5ec776,_0x4e4b19,_0xc177ef,_0x160380,_0x446eef){const _0x102833=a229_0x3a3f4b;this[_0x102833(0x1ab)]=_0x5ec776,this[_0x102833(0x1ad)]=_0x4e4b19,this['username']=_0xc177ef,this[_0x102833(0x177)]=_0x160380,this[_0x102833(0x1c7)]=_0x446eef,this[_0x102833(0x1c9)]=new core_1[(_0x102833(0x17c))](SalesforceComponentsManager[_0x102833(0x1cd)]),this[_0x102833(0x19e)]=typedi_1['default'][_0x102833(0x174)](salesforce_git_sync_service_1[_0x102833(0x18a)]);}[a229_0x3a3f4b(0x1b1)](_0x44faf3,_0x42805e){const _0x35b83d=a229_0x3a3f4b,_0x4f29a1=(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x44faf3,[_0x35b83d(0x1a0),'Component_Name__c',_0x35b83d(0x1c2)]);this['proceededComponentsMeta']['push']({'componentId':'','reference':_0x42805e,'version':_0x4f29a1[_0x35b83d(0x1c2)],'componentName':_0x4f29a1['Component_Name__c'],'componentType':_0x4f29a1[_0x35b83d(0x1a0)]});}[a229_0x3a3f4b(0x1a2)](_0x42f322,_0x387ea7){const _0x3c2957=a229_0x3a3f4b,{request:_0x5ccb8a}=(0x0,composite_utils_1[_0x3c2957(0x1b0)])(constants_1[_0x3c2957(0x1be)],{[constants_1['FLOSUM_NAMESPACE']+_0x3c2957(0x178)]:_0x42f322,[constants_1[_0x3c2957(0x1db)]+_0x3c2957(0x180)]:_0x387ea7});return _0x5ccb8a;}async[a229_0x3a3f4b(0x1b4)](_0x5c1de9,_0x403fc9){const _0xca60bc=a229_0x3a3f4b,_0x2f8a32={},_0x2d848f=zip_1[_0xca60bc(0x1b8)][_0xca60bc(0x1d6)]();for(const _0x2ce1f8 of Object[_0xca60bc(0x1da)](_0x5c1de9[_0xca60bc(0x1b9)])){_0x2d848f[_0xca60bc(0x19d)](_0x2ce1f8,_0x5c1de9['files'][_0x2ce1f8],{'createFolders':!![]});}return _0x2f8a32[_0xca60bc(0x1a3)]=_0xca60bc(0x1a8),_0x2f8a32['Name']=_0x5c1de9[_0xca60bc(0x1a6)],_0x2f8a32[_0xca60bc(0x1a4)]=_0x5c1de9[_0xca60bc(0x1a6)],_0x2f8a32[_0xca60bc(0x19b)]=_0x403fc9,_0x2f8a32[_0xca60bc(0x195)]=await _0x2d848f[_0xca60bc(0x193)]({'type':_0xca60bc(0x1b2),'compression':_0xca60bc(0x1ac),'compressionOptions':{'level':0x6}}),_0x2f8a32;}[a229_0x3a3f4b(0x18c)](_0x46fa85,_0x3afe61,_0x5f0cc4){const _0x1a3bcb=a229_0x3a3f4b,_0x562471=new Date()[_0x1a3bcb(0x1b6)](),_0x3f3b29={};return _0x3f3b29[constants_1['FLOSUM_NAMESPACE']+'Component__c']=_0x3afe61,_0x3f3b29[constants_1[_0x1a3bcb(0x1db)]+_0x1a3bcb(0x1a9)]=_0x46fa85[_0x1a3bcb(0x18b)],_0x3f3b29[constants_1[_0x1a3bcb(0x1db)]+_0x1a3bcb(0x197)]=_0x562471,_0x3f3b29[constants_1[_0x1a3bcb(0x1db)]+_0x1a3bcb(0x190)]=this['username'],_0x3f3b29[constants_1[_0x1a3bcb(0x1db)]+'Version__c']=_0x5f0cc4?_0x5f0cc4+0x1:0x1,_0x3f3b29[constants_1[_0x1a3bcb(0x1d3)]+_0x1a3bcb(0x18f)]=!![],_0x3f3b29;}[a229_0x3a3f4b(0x1bc)](_0x301b8c,_0x42b549){const _0x45cd45=a229_0x3a3f4b;var _0x430ac8,_0x106991;const _0x2fedab=new Date()[_0x45cd45(0x1b6)](),_0x2c6cd2={};return!_0x42b549?(this[_0x45cd45(0x1ad)]?(_0x2c6cd2[constants_1['FLOSUM_NAMESPACE']+_0x45cd45(0x1d5)]=this['branchId'],_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+'Source__c']='Branch',_0x2c6cd2[_0x45cd45(0x1d8)]=(_0x430ac8=this[_0x45cd45(0x177)][_0x45cd45(0x1a5)](_0x2a1a5a=>_0x2a1a5a['name']===_0x45cd45(0x1af)))===null||_0x430ac8===void 0x0?void 0x0:_0x430ac8['id']):(_0x2c6cd2[constants_1['FLOSUM_NAMESPACE']+_0x45cd45(0x1d7)]=this['repositoryId'],_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+'Source__c']=_0x45cd45(0x1d9),_0x2c6cd2['RecordTypeId']=(_0x106991=this[_0x45cd45(0x177)][_0x45cd45(0x1a5)](_0x47ebea=>_0x47ebea['name']===_0x45cd45(0x1d9)))===null||_0x106991===void 0x0?void 0x0:_0x106991['id']),_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+'Version__c']=0x1):_0x2c6cd2[constants_1['FLOSUM_NAMESPACE']+_0x45cd45(0x1c2)]=_0x42b549[_0x45cd45(0x17d)]+0x1,_0x2c6cd2[constants_1['FLOSUM_NAMESPACE']+_0x45cd45(0x1a0)]=_0x301b8c[_0x45cd45(0x1a6)],_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+_0x45cd45(0x1c4)]=_0x301b8c[_0x45cd45(0x1cd)],_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+_0x45cd45(0x175)]=_0x301b8c[_0x45cd45(0x179)],_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+_0x45cd45(0x1ae)]=this[_0x45cd45(0x1a7)],_0x2c6cd2[constants_1['FLOSUM_NAMESPACE']+'Last_Modified_By__c']=this[_0x45cd45(0x1a7)],_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+_0x45cd45(0x1aa)]=_0x2fedab,_0x2c6cd2[constants_1['FLOSUM_NAMESPACE']+_0x45cd45(0x19a)]=_0x2fedab,_0x2c6cd2[constants_1[_0x45cd45(0x1db)]+_0x45cd45(0x1a9)]=_0x301b8c[_0x45cd45(0x18b)],_0x2c6cd2;}[a229_0x3a3f4b(0x1d1)](){const _0x9c001d=a229_0x3a3f4b;return this[_0x9c001d(0x1c7)];}async[a229_0x3a3f4b(0x1cc)](_0x25aed9,_0x24a455){const _0x2bc974=a229_0x3a3f4b,_0x101d95=[];for(const _0x845d4a of _0x25aed9){const _0x26fc5b=(0x0,composite_utils_1[_0x2bc974(0x1b0)])(constants_1[_0x2bc974(0x196)],this[_0x2bc974(0x1bc)](_0x845d4a)),_0x3de435=(0x0,composite_utils_1[_0x2bc974(0x1b0)])(constants_1[_0x2bc974(0x183)],this[_0x2bc974(0x18c)](_0x845d4a,'@{'+_0x26fc5b['reference']+'.id}')),_0xdcce4a=(0x0,composite_utils_1[_0x2bc974(0x1b0)])(constants_1[_0x2bc974(0x1ba)],await this[_0x2bc974(0x1b4)](_0x845d4a,'@{'+_0x3de435[_0x2bc974(0x1c1)]+'.id}'));this[_0x2bc974(0x1b1)](_0x26fc5b[_0x2bc974(0x189)][_0x2bc974(0x199)],_0x26fc5b[_0x2bc974(0x1c1)]),_0x101d95[_0x2bc974(0x1d4)](_0x26fc5b[_0x2bc974(0x189)],_0x3de435[_0x2bc974(0x189)],_0xdcce4a[_0x2bc974(0x189)]),_0x24a455&&_0x101d95[_0x2bc974(0x1d4)](this[_0x2bc974(0x1a2)](_0x24a455,'@{'+_0x3de435['reference']+_0x2bc974(0x198)));}return _0x101d95;}async[a229_0x3a3f4b(0x1d0)](_0x880506,_0x2d0605=''){const _0x16d9fe=a229_0x3a3f4b,_0xda9574=[];for(const {component:_0x1225c9,meta:_0x4f2f1c}of _0x880506){if(!_0x4f2f1c['id']){const _0xb38330=this[_0x16d9fe(0x1c7)][_0x16d9fe(0x1a5)](_0x251314=>_0x251314[_0x16d9fe(0x191)]===_0x1225c9[_0x16d9fe(0x1cd)]&&_0x251314[_0x16d9fe(0x1cb)]===_0x1225c9[_0x16d9fe(0x1a6)]);if(!_0xb38330)throw new salesforce_error_1[(_0x16d9fe(0x1c3))](new Error(_0x16d9fe(0x1c5)+_0x1225c9[_0x16d9fe(0x1cd)]+'\x20['+_0x1225c9[_0x16d9fe(0x1a6)]+']\x20-\x20meta\x20not\x20found'));_0x4f2f1c['id']=_0xb38330[_0x16d9fe(0x188)];}const _0x3a93b2=(0x0,composite_utils_1[_0x16d9fe(0x17f)])(constants_1[_0x16d9fe(0x196)],_0x4f2f1c['id'],this[_0x16d9fe(0x1bc)](_0x1225c9,_0x4f2f1c)),_0x4a2acf=(0x0,composite_utils_1[_0x16d9fe(0x1b0)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this['prepareComponentHistoryRecord'](_0x1225c9,_0x4f2f1c['id'],_0x4f2f1c['version'])),_0x3ec060=(0x0,composite_utils_1[_0x16d9fe(0x1b0)])(constants_1[_0x16d9fe(0x1ba)],await this[_0x16d9fe(0x1b4)](_0x1225c9,'@{'+_0x4a2acf[_0x16d9fe(0x1c1)]+_0x16d9fe(0x198)));this[_0x16d9fe(0x1b1)](_0x3a93b2[_0x16d9fe(0x189)][_0x16d9fe(0x199)],_0x3a93b2['reference']),_0xda9574[_0x16d9fe(0x1d4)](_0x3a93b2['request'],_0x4a2acf[_0x16d9fe(0x189)],_0x3ec060[_0x16d9fe(0x189)]),_0x2d0605&&_0xda9574[_0x16d9fe(0x1d4)](this['prepareCommitManifest'](_0x2d0605,'@{'+_0x4a2acf[_0x16d9fe(0x1c1)]+'.id}'));}return _0xda9574;}async[a229_0x3a3f4b(0x1ca)](_0x433f5c,_0x1fab6f=![]){const _0x54572c=a229_0x3a3f4b,_0x4e55aa={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x667364=[];for(const _0x5c861e of _0x433f5c){if(_0x5c861e['id'])_0x667364[_0x54572c(0x1d4)](_0x5c861e['id']);else{const _0x2f5a1d=this[_0x54572c(0x1c7)]['find'](_0x5744a2=>_0x5744a2[_0x54572c(0x191)]===_0x5c861e[_0x54572c(0x1cd)]&&_0x5744a2['componentType']===_0x5c861e['type']);if(!_0x2f5a1d||!_0x2f5a1d['componentId'])continue;_0x667364[_0x54572c(0x1d4)](_0x2f5a1d[_0x54572c(0x188)]);}}if(_0x1fab6f){const _0x15a57f=await this['gitSync'][_0x54572c(0x1b5)](_0x667364);_0x4e55aa['manifests']=_0x15a57f[_0x54572c(0x19c)](_0x2bb253=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1[_0x54572c(0x1be)],_0x2bb253)[_0x54572c(0x189)]);}return _0x4e55aa[_0x54572c(0x18d)]=_0x667364['map'](_0x592f90=>(0x0,composite_utils_1[_0x54572c(0x17f)])(constants_1['FLOSUM_COMPONENT'],_0x592f90,{[constants_1[_0x54572c(0x1d3)]+_0x54572c(0x184)]:!![]})[_0x54572c(0x189)]),_0x4e55aa['componentsToDelete']=_0x667364[_0x54572c(0x19c)](_0x539b19=>(0x0,composite_utils_1[_0x54572c(0x1bd)])(constants_1[_0x54572c(0x196)],_0x539b19)['request']),_0x4e55aa;}}exports['SalesforceComponentsManager']=SalesforceComponentsManager;