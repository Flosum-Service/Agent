const a234_0x358fba=a234_0x185c;function a234_0x185c(_0x18e721,_0x2b824f){const _0xa8c56a=a234_0x55a4();return a234_0x185c=function(_0x28237f,_0x49b9ea){_0x28237f=_0x28237f-0x16c;let _0x55a4af=_0xa8c56a[_0x28237f];return _0x55a4af;},a234_0x185c(_0x18e721,_0x2b824f);}function a234_0x55a4(){const _0x2c2d9e=['../utils/flosum-naming.utils','3345976aRKhWd','Commit__c','Repository','FLOSUM_COMPONENT_HISTORY','insert','componentsToUpdate','isVlocityComponent','files','reference','./salesforce-git-sync.service','1629135FFCDCr','name','proceededComponentsMeta','createDeleteRequest','224DvRhvh',']\x20-\x20meta\x20not\x20found','createPatchRequest','../utils/composite.utils','Zip','Last_Updated_By__c','ParentId','50UnmZfY','componentType','910976qlPmEA','Component__c','username','__importDefault','apply','Body','componentsToDelete','FLOSUM_NAMESPACE','push','../../../../constants','.id}','prepareComponentAttachmentRecord','Is_From_Agent__c','Deletion_By_Agent__c','../../../../core','../errors/salesforce.error','delete','1273203fWldls','componentId','repositoryId','SalesforceError','typedi','extractFieldsFromRecord','getProceededComponentsMeta','SalesforceComponentsManager','CRC32__c','toISOString','Could\x20not\x20proceed\x20component\x20','DEFLATE','__esModule','proceedComponentMeta','24nJnUUt','Logger','generateAsync','filePath','prepareComponentRecord','crc','prepareCommitManifest','FLOSUM_GIT_NAMESPACE','48dpsVPT','recordTypes','Name','application/zip','version','Vlocity_Component_Name__c','base64','logger','../../parsers/utils/zip','Repository__c','map','Description','14sfLWBh','createPostRequest','Version__c','body','Source__c','SalesforceGitSyncService','FLOSUM_COMPONENT','Component_Type__c','Last_Modified_Date__c','Component_Name__c','get','FLOSUM_COMMIT_MANIFEST','58690WLhBjL','Component_History__c','RecordTypeId','branchId','search','12508TxCuHb','prepareComponentHistoryRecord','(((.+)+)+)+$','Changed_On__c','Last_Modified_By__c','FLOSUM_ATTACHMENT','type','gitSync','Committed_On__c','componentName','4721872tjedSI','vlocityComponentName','Changed_By__c','keys','Vlocity_Component__c','request','find','file','createZip'];a234_0x55a4=function(){return _0x2c2d9e;};return a234_0x55a4();}(function(_0x14a013,_0x3d7591){const _0x2c4b0c=a234_0x185c,_0x39dfaa=_0x14a013();while(!![]){try{const _0x25da9e=parseInt(_0x2c4b0c(0x18d))/0x1*(parseInt(_0x2c4b0c(0x1da))/0x2)+parseInt(_0x2c4b0c(0x1a7))/0x3+-parseInt(_0x2c4b0c(0x175))/0x4+-parseInt(_0x2c4b0c(0x1d5))/0x5*(parseInt(_0x2c4b0c(0x1b5))/0x6)+-parseInt(_0x2c4b0c(0x1c9))/0x7*(-parseInt(_0x2c4b0c(0x17f))/0x8)+parseInt(_0x2c4b0c(0x189))/0x9*(-parseInt(_0x2c4b0c(0x194))/0xa)+parseInt(_0x2c4b0c(0x196))/0xb*(parseInt(_0x2c4b0c(0x1bd))/0xc);if(_0x25da9e===_0x3d7591)break;else _0x39dfaa['push'](_0x39dfaa['shift']());}catch(_0x3457ca){_0x39dfaa['push'](_0x39dfaa['shift']());}}}(a234_0x55a4,0xd2190));const a234_0x49b9ea=(function(){let _0x5af877=!![];return function(_0x109430,_0x5aea70){const _0x560260=_0x5af877?function(){const _0x1ac135=a234_0x185c;if(_0x5aea70){const _0x58e532=_0x5aea70[_0x1ac135(0x19a)](_0x109430,arguments);return _0x5aea70=null,_0x58e532;}}:function(){};return _0x5af877=![],_0x560260;};}()),a234_0x28237f=a234_0x49b9ea(this,function(){const _0x15d480=a234_0x185c;return a234_0x28237f['toString']()['search'](_0x15d480(0x16d))['toString']()['constructor'](a234_0x28237f)[_0x15d480(0x1d9)](_0x15d480(0x16d));});a234_0x28237f();'use strict';var __importDefault=this&&this[a234_0x358fba(0x199)]||function(_0x3684f7){return _0x3684f7&&_0x3684f7['__esModule']?_0x3684f7:{'default':_0x3684f7};};Object['defineProperty'](exports,a234_0x358fba(0x1b3),{'value':!![]}),exports[a234_0x358fba(0x1ae)]=void 0x0;const constants_1=require(a234_0x358fba(0x19f)),core_1=require(a234_0x358fba(0x1a4)),zip_1=require(a234_0x358fba(0x1c5)),typedi_1=__importDefault(require(a234_0x358fba(0x1ab))),salesforce_error_1=require(a234_0x358fba(0x1a5)),composite_utils_1=require(a234_0x358fba(0x190)),flosum_naming_utils_1=require(a234_0x358fba(0x17e)),salesforce_git_sync_service_1=require(a234_0x358fba(0x188));class SalesforceComponentsManager{constructor(_0x16bb0f,_0x2fd59a,_0x551a63,_0x3059a7,_0x12d67b){const _0x1c40e7=a234_0x358fba;this['repositoryId']=_0x16bb0f,this[_0x1c40e7(0x1d8)]=_0x2fd59a,this[_0x1c40e7(0x198)]=_0x551a63,this[_0x1c40e7(0x1be)]=_0x3059a7,this[_0x1c40e7(0x18b)]=_0x12d67b,this[_0x1c40e7(0x1c4)]=new core_1[(_0x1c40e7(0x1b6))](SalesforceComponentsManager[_0x1c40e7(0x18a)]),this[_0x1c40e7(0x172)]=typedi_1['default'][_0x1c40e7(0x1d3)](salesforce_git_sync_service_1[_0x1c40e7(0x1ce)]);}[a234_0x358fba(0x1b4)](_0x26aa5c,_0x957c92){const _0x6207b2=a234_0x358fba,_0x3ba4b6=(0x0,flosum_naming_utils_1[_0x6207b2(0x1ac)])(_0x26aa5c,[_0x6207b2(0x1d0),_0x6207b2(0x1d2),_0x6207b2(0x1cb)]);this['proceededComponentsMeta'][_0x6207b2(0x19e)]({'componentId':'','reference':_0x957c92,'version':_0x3ba4b6[_0x6207b2(0x1cb)],'componentName':_0x3ba4b6[_0x6207b2(0x1d2)],'componentType':_0x3ba4b6[_0x6207b2(0x1d0)]});}['prepareCommitManifest'](_0x2a5b0d,_0x104189){const _0x574291=a234_0x358fba,{request:_0x544fdd}=(0x0,composite_utils_1[_0x574291(0x1ca)])(constants_1[_0x574291(0x1d4)],{[constants_1['FLOSUM_NAMESPACE']+_0x574291(0x180)]:_0x2a5b0d,[constants_1[_0x574291(0x19d)]+_0x574291(0x1d6)]:_0x104189});return _0x544fdd;}async[a234_0x358fba(0x1a1)](_0x952924,_0x4f70bd){const _0x137f0b=a234_0x358fba,_0x323793={},_0x26a6bc=zip_1[_0x137f0b(0x191)][_0x137f0b(0x17d)]();for(const _0x4da070 of Object[_0x137f0b(0x178)](_0x952924[_0x137f0b(0x186)])){_0x26a6bc[_0x137f0b(0x17c)](_0x4da070,_0x952924[_0x137f0b(0x186)][_0x4da070],{'createFolders':!![]});}return _0x323793['ContentType']=_0x137f0b(0x1c0),_0x323793[_0x137f0b(0x1bf)]=_0x952924[_0x137f0b(0x171)],_0x323793[_0x137f0b(0x1c8)]=_0x952924[_0x137f0b(0x171)],_0x323793[_0x137f0b(0x193)]=_0x4f70bd,_0x323793[_0x137f0b(0x19b)]=await _0x26a6bc[_0x137f0b(0x1b7)]({'type':_0x137f0b(0x1c3),'compression':_0x137f0b(0x1b2),'compressionOptions':{'level':0x6}}),_0x323793;}[a234_0x358fba(0x16c)](_0x3c001c,_0x57ef9b,_0x5250bb){const _0x3bdda9=a234_0x358fba,_0x26331c=new Date()[_0x3bdda9(0x1b0)](),_0x3e5612={};return _0x3e5612[constants_1[_0x3bdda9(0x19d)]+_0x3bdda9(0x197)]=_0x57ef9b,_0x3e5612[constants_1['FLOSUM_NAMESPACE']+'CRC32__c']=_0x3c001c[_0x3bdda9(0x1ba)],_0x3e5612[constants_1[_0x3bdda9(0x19d)]+_0x3bdda9(0x16e)]=_0x26331c,_0x3e5612[constants_1['FLOSUM_NAMESPACE']+_0x3bdda9(0x177)]=this[_0x3bdda9(0x198)],_0x3e5612[constants_1[_0x3bdda9(0x19d)]+_0x3bdda9(0x1cb)]=_0x5250bb?_0x5250bb+0x1:0x1,_0x3e5612[constants_1[_0x3bdda9(0x1bc)]+_0x3bdda9(0x1a2)]=!![],_0x3e5612;}[a234_0x358fba(0x1b9)](_0x871752,_0x1d5e67){const _0x4f1ca6=a234_0x358fba;var _0x4c4883,_0xa2be6b;const _0x57ba22=new Date()[_0x4f1ca6(0x1b0)](),_0x52d85b={};return!_0x1d5e67?(this[_0x4f1ca6(0x1d8)]?(_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+'Branch__c']=this[_0x4f1ca6(0x1d8)],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+'Source__c']='Branch',_0x52d85b[_0x4f1ca6(0x1d7)]=(_0x4c4883=this['recordTypes'][_0x4f1ca6(0x17b)](_0x555c00=>_0x555c00[_0x4f1ca6(0x18a)]==='Branch'))===null||_0x4c4883===void 0x0?void 0x0:_0x4c4883['id']):(_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x1c6)]=this[_0x4f1ca6(0x1a9)],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x1cd)]=_0x4f1ca6(0x181),_0x52d85b[_0x4f1ca6(0x1d7)]=(_0xa2be6b=this[_0x4f1ca6(0x1be)][_0x4f1ca6(0x17b)](_0x255337=>_0x255337[_0x4f1ca6(0x18a)]==='Repository'))===null||_0xa2be6b===void 0x0?void 0x0:_0xa2be6b['id']),_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+'Version__c']=0x1):_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+'Version__c']=_0x1d5e67[_0x4f1ca6(0x1c1)]+0x1,_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x1d0)]=_0x871752[_0x4f1ca6(0x171)],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x1d2)]=_0x871752[_0x4f1ca6(0x18a)],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+'File_Name__c']=_0x871752[_0x4f1ca6(0x1b8)],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x192)]=this['username'],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x16f)]=this['username'],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x1d1)]=_0x57ba22,_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x173)]=_0x57ba22,_0x52d85b[constants_1['FLOSUM_NAMESPACE']+_0x4f1ca6(0x1af)]=_0x871752[_0x4f1ca6(0x1ba)],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x1c2)]=_0x871752[_0x4f1ca6(0x176)],_0x52d85b[constants_1[_0x4f1ca6(0x19d)]+_0x4f1ca6(0x179)]=_0x871752[_0x4f1ca6(0x185)],_0x52d85b;}[a234_0x358fba(0x1ad)](){return this['proceededComponentsMeta'];}async[a234_0x358fba(0x183)](_0x5daf6f,_0x1ecff9){const _0x181838=a234_0x358fba,_0x478cbc=[];for(const _0x397414 of _0x5daf6f){const _0x446b0a=(0x0,composite_utils_1[_0x181838(0x1ca)])(constants_1[_0x181838(0x1cf)],this[_0x181838(0x1b9)](_0x397414)),_0x13e0ab=(0x0,composite_utils_1[_0x181838(0x1ca)])(constants_1[_0x181838(0x182)],this['prepareComponentHistoryRecord'](_0x397414,'@{'+_0x446b0a['reference']+_0x181838(0x1a0))),_0x18e2c2=(0x0,composite_utils_1[_0x181838(0x1ca)])(constants_1[_0x181838(0x170)],await this[_0x181838(0x1a1)](_0x397414,'@{'+_0x13e0ab['reference']+_0x181838(0x1a0)));this[_0x181838(0x1b4)](_0x446b0a[_0x181838(0x17a)][_0x181838(0x1cc)],_0x446b0a['reference']),_0x478cbc[_0x181838(0x19e)](_0x446b0a[_0x181838(0x17a)],_0x13e0ab[_0x181838(0x17a)],_0x18e2c2['request']),_0x1ecff9&&_0x478cbc[_0x181838(0x19e)](this['prepareCommitManifest'](_0x1ecff9,'@{'+_0x13e0ab[_0x181838(0x187)]+'.id}'));}return _0x478cbc;}async['update'](_0x307737,_0xb72773=''){const _0x705106=a234_0x358fba,_0x14f9bb=[];for(const {component:_0x5a910e,meta:_0xeae73c}of _0x307737){if(!_0xeae73c['id']){const _0x5ed639=this[_0x705106(0x18b)][_0x705106(0x17b)](_0x1d683f=>_0x1d683f[_0x705106(0x174)]===_0x5a910e[_0x705106(0x18a)]&&_0x1d683f['componentType']===_0x5a910e[_0x705106(0x171)]);if(!_0x5ed639)throw new salesforce_error_1[(_0x705106(0x1aa))](new Error(_0x705106(0x1b1)+_0x5a910e[_0x705106(0x18a)]+'\x20['+_0x5a910e[_0x705106(0x171)]+_0x705106(0x18e)));_0xeae73c['id']=_0x5ed639[_0x705106(0x1a8)];}const _0x31f5ba=(0x0,composite_utils_1[_0x705106(0x18f)])(constants_1[_0x705106(0x1cf)],_0xeae73c['id'],this[_0x705106(0x1b9)](_0x5a910e,_0xeae73c)),_0x46331c=(0x0,composite_utils_1[_0x705106(0x1ca)])(constants_1[_0x705106(0x182)],this[_0x705106(0x16c)](_0x5a910e,_0xeae73c['id'],_0xeae73c['version'])),_0x2f6baa=(0x0,composite_utils_1[_0x705106(0x1ca)])(constants_1[_0x705106(0x170)],await this['prepareComponentAttachmentRecord'](_0x5a910e,'@{'+_0x46331c[_0x705106(0x187)]+_0x705106(0x1a0)));this[_0x705106(0x1b4)](_0x31f5ba[_0x705106(0x17a)][_0x705106(0x1cc)],_0x31f5ba[_0x705106(0x187)]),_0x14f9bb[_0x705106(0x19e)](_0x31f5ba[_0x705106(0x17a)],_0x46331c['request'],_0x2f6baa[_0x705106(0x17a)]),_0xb72773&&_0x14f9bb[_0x705106(0x19e)](this[_0x705106(0x1bb)](_0xb72773,'@{'+_0x46331c[_0x705106(0x187)]+_0x705106(0x1a0)));}return _0x14f9bb;}async[a234_0x358fba(0x1a6)](_0x4fa402,_0x4715cf=![]){const _0x4b5d55=a234_0x358fba,_0x2d592a={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0xfe50d=[];for(const _0x30140f of _0x4fa402){if(_0x30140f['id'])_0xfe50d[_0x4b5d55(0x19e)](_0x30140f['id']);else{const _0x5dbb5f=this[_0x4b5d55(0x18b)]['find'](_0x16a709=>_0x16a709['componentName']===_0x30140f[_0x4b5d55(0x18a)]&&_0x16a709[_0x4b5d55(0x195)]===_0x30140f['type']);if(!_0x5dbb5f||!_0x5dbb5f[_0x4b5d55(0x1a8)])continue;_0xfe50d[_0x4b5d55(0x19e)](_0x5dbb5f['componentId']);}}if(_0x4715cf){const _0x4a822a=await this[_0x4b5d55(0x172)]['fetchCommitManifestsByComponentIds'](_0xfe50d);_0x2d592a['manifests']=_0x4a822a[_0x4b5d55(0x1c7)](_0x4c6e51=>(0x0,composite_utils_1[_0x4b5d55(0x18c)])(constants_1[_0x4b5d55(0x1d4)],_0x4c6e51)[_0x4b5d55(0x17a)]);}return _0x2d592a[_0x4b5d55(0x184)]=_0xfe50d[_0x4b5d55(0x1c7)](_0x48def8=>(0x0,composite_utils_1[_0x4b5d55(0x18f)])(constants_1['FLOSUM_COMPONENT'],_0x48def8,{[constants_1[_0x4b5d55(0x1bc)]+_0x4b5d55(0x1a3)]:!![]})[_0x4b5d55(0x17a)]),_0x2d592a[_0x4b5d55(0x19c)]=_0xfe50d['map'](_0x21d5ec=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1[_0x4b5d55(0x1cf)],_0x21d5ec)['request']),_0x2d592a;}}exports[a234_0x358fba(0x1ae)]=SalesforceComponentsManager;