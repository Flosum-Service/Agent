function a261_0x5c15(_0xab875e,_0x23cc16){const _0x349bb5=a261_0x4142();return a261_0x5c15=function(_0x3e53db,_0x567ef1){_0x3e53db=_0x3e53db-0x98;let _0x41420e=_0x349bb5[_0x3e53db];return _0x41420e;},a261_0x5c15(_0xab875e,_0x23cc16);}const a261_0x5e3a82=a261_0x5c15;(function(_0x42a033,_0x58bd81){const _0x457ae4=a261_0x5c15,_0x29a17f=_0x42a033();while(!![]){try{const _0x7217fa=-parseInt(_0x457ae4(0xf2))/0x1*(parseInt(_0x457ae4(0xb9))/0x2)+-parseInt(_0x457ae4(0xba))/0x3*(parseInt(_0x457ae4(0xd8))/0x4)+parseInt(_0x457ae4(0xf5))/0x5+-parseInt(_0x457ae4(0xbf))/0x6+parseInt(_0x457ae4(0xdc))/0x7+parseInt(_0x457ae4(0xe7))/0x8+parseInt(_0x457ae4(0xbc))/0x9*(-parseInt(_0x457ae4(0xfb))/0xa);if(_0x7217fa===_0x58bd81)break;else _0x29a17f['push'](_0x29a17f['shift']());}catch(_0x3de816){_0x29a17f['push'](_0x29a17f['shift']());}}}(a261_0x4142,0x8e4cf));function a261_0x4142(){const _0x2d8534=['SalesforceError','../errors/salesforce.error','Deletion_By_Agent__c','Body','__esModule','Component_Type__c','find','map','MC_Key__c','Vlocity_Component__c','.id}','componentType','createPostRequest','toISOString','crc','Is_From_Agent__c','createPatchRequest','CRC32__c','Commit__c','Source__c','prepareCommitManifest','Name','FLOSUM_GIT_NAMESPACE','Changed_By__c','SalesforceComponentsManager','SalesforceGitSyncService','apply','./salesforce-git-sync.service','getProceededComponentsMeta','Changed_On__c','Vlocity_Component_Name__c','FLOSUM_COMPONENT_HISTORY','createZip','Could\x20not\x20proceed\x20component\x20','body','recordTypes','branchId','2UbXBry','417zENHyw','ContentType','9IKEBsx','search','prepareComponentHistoryRecord','3997572iPzzFK','Last_Modified_By__c','typedi','Component_Name__c','gitSync','Branch','name','DEFLATE','createDeleteRequest','filePath','generateAsync','FLOSUM_COMPONENT','componentsToDelete','__importDefault','request','repositoryId','marketingCloudKey','proceededComponentsMeta','prepareComponentRecord','application/zip','Last_Modified_Date__c','toString','Version__c','prepareComponentAttachmentRecord','vlocityComponentName','3952EUcsAg','../utils/composite.utils','FLOSUM_NAMESPACE','username','4777066xTrMXf','ParentId','extractFieldsFromRecord','Branch__c',']\x20-\x20meta\x20not\x20found','Repository','File_Name__c','FLOSUM_COMMIT_MANIFEST','get','Logger','proceedComponentMeta','8869928fZPDeQ','reference','push','componentId','Component__c','RecordTypeId','Component_History__c','componentName','Description','Last_Updated_By__c','version','645471ujgMXc','file','type','4170965WeFiUj','FLOSUM_ATTACHMENT','keys','Committed_On__c','(((.+)+)+)+$','isVlocityComponent','5934440SlMwwl'];a261_0x4142=function(){return _0x2d8534;};return a261_0x4142();}const a261_0x567ef1=(function(){let _0x1494d6=!![];return function(_0x2dcb51,_0x4d27b4){const _0x136903=_0x1494d6?function(){const _0x3fd42c=a261_0x5c15;if(_0x4d27b4){const _0x2cf85d=_0x4d27b4[_0x3fd42c(0xae)](_0x2dcb51,arguments);return _0x4d27b4=null,_0x2cf85d;}}:function(){};return _0x1494d6=![],_0x136903;};}()),a261_0x3e53db=a261_0x567ef1(this,function(){const _0x564f78=a261_0x5c15;return a261_0x3e53db[_0x564f78(0xd4)]()[_0x564f78(0xbd)](_0x564f78(0xf9))[_0x564f78(0xd4)]()['constructor'](a261_0x3e53db)['search']('(((.+)+)+)+$');});a261_0x3e53db();'use strict';var __importDefault=this&&this[a261_0x5e3a82(0xcc)]||function(_0x2e73fc){return _0x2e73fc&&_0x2e73fc['__esModule']?_0x2e73fc:{'default':_0x2e73fc};};Object['defineProperty'](exports,a261_0x5e3a82(0x98),{'value':!![]}),exports[a261_0x5e3a82(0xac)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require('../../../../core'),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require(a261_0x5e3a82(0xc1))),salesforce_error_1=require(a261_0x5e3a82(0xfd)),composite_utils_1=require(a261_0x5e3a82(0xd9)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a261_0x5e3a82(0xaf));class SalesforceComponentsManager{constructor(_0xfbc51d,_0x5ade6d,_0x3c33a2,_0x335dbd,_0x59c45a){const _0x2a2f6a=a261_0x5e3a82;this['repositoryId']=_0xfbc51d,this[_0x2a2f6a(0xb8)]=_0x5ade6d,this['username']=_0x3c33a2,this[_0x2a2f6a(0xb7)]=_0x335dbd,this[_0x2a2f6a(0xd0)]=_0x59c45a,this['logger']=new core_1[(_0x2a2f6a(0xe5))](SalesforceComponentsManager[_0x2a2f6a(0xc5)]),this[_0x2a2f6a(0xc3)]=typedi_1['default'][_0x2a2f6a(0xe4)](salesforce_git_sync_service_1[_0x2a2f6a(0xad)]);}[a261_0x5e3a82(0xe6)](_0x337849,_0x3c35b7){const _0x15cd86=a261_0x5e3a82,_0x186c80=(0x0,flosum_naming_utils_1[_0x15cd86(0xde)])(_0x337849,[_0x15cd86(0x99),_0x15cd86(0xc2),_0x15cd86(0xd5)]);this[_0x15cd86(0xd0)]['push']({'componentId':'','reference':_0x3c35b7,'version':_0x186c80[_0x15cd86(0xd5)],'componentName':_0x186c80[_0x15cd86(0xc2)],'componentType':_0x186c80[_0x15cd86(0x99)]});}[a261_0x5e3a82(0xa8)](_0x3eb25f,_0x15b204){const _0x757dea=a261_0x5e3a82,{request:_0x2e6e22}=(0x0,composite_utils_1[_0x757dea(0xa0)])(constants_1[_0x757dea(0xe3)],{[constants_1[_0x757dea(0xda)]+_0x757dea(0xa6)]:_0x3eb25f,[constants_1[_0x757dea(0xda)]+_0x757dea(0xed)]:_0x15b204});return _0x2e6e22;}async['prepareComponentAttachmentRecord'](_0x23e87e,_0x595915){const _0xc9fec=a261_0x5e3a82,_0x5a1f20={},_0x1b1883=zip_1['Zip'][_0xc9fec(0xb4)]();for(const _0x4850d3 of Object[_0xc9fec(0xf7)](_0x23e87e['files'])){_0x1b1883[_0xc9fec(0xf3)](_0x4850d3,_0x23e87e['files'][_0x4850d3],{'createFolders':!![]});}return _0x5a1f20[_0xc9fec(0xbb)]=_0xc9fec(0xd2),_0x5a1f20[_0xc9fec(0xa9)]=_0x23e87e[_0xc9fec(0xf4)],_0x5a1f20[_0xc9fec(0xef)]=_0x23e87e[_0xc9fec(0xf4)],_0x5a1f20[_0xc9fec(0xdd)]=_0x595915,_0x5a1f20[_0xc9fec(0xff)]=await _0x1b1883[_0xc9fec(0xc9)]({'type':'base64','compression':_0xc9fec(0xc6),'compressionOptions':{'level':0x6}}),_0x5a1f20;}[a261_0x5e3a82(0xbe)](_0x44a23f,_0x109e22,_0x6d05f4){const _0x2be2e1=a261_0x5e3a82,_0x3a0dbe=new Date()[_0x2be2e1(0xa1)](),_0x394b2d={};return _0x394b2d[constants_1[_0x2be2e1(0xda)]+_0x2be2e1(0xeb)]=_0x109e22,_0x394b2d[constants_1[_0x2be2e1(0xda)]+_0x2be2e1(0xa5)]=_0x44a23f[_0x2be2e1(0xa2)],_0x394b2d[constants_1[_0x2be2e1(0xda)]+_0x2be2e1(0xb1)]=_0x3a0dbe,_0x394b2d[constants_1[_0x2be2e1(0xda)]+_0x2be2e1(0xab)]=this[_0x2be2e1(0xdb)],_0x394b2d[constants_1['FLOSUM_NAMESPACE']+'Version__c']=_0x6d05f4?_0x6d05f4+0x1:0x1,_0x394b2d[constants_1[_0x2be2e1(0xaa)]+_0x2be2e1(0xa3)]=!![],_0x394b2d;}[a261_0x5e3a82(0xd1)](_0x4e3fb6,_0xa7db7){const _0x2269b3=a261_0x5e3a82;var _0x32a660,_0x7ff6a0;const _0x3386a0=new Date()[_0x2269b3(0xa1)](),_0x1efbe1={};return!_0xa7db7?(this['branchId']?(_0x1efbe1[constants_1['FLOSUM_NAMESPACE']+_0x2269b3(0xdf)]=this['branchId'],_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xa7)]=_0x2269b3(0xc4),_0x1efbe1[_0x2269b3(0xec)]=(_0x32a660=this[_0x2269b3(0xb7)][_0x2269b3(0x9a)](_0x84ecc5=>_0x84ecc5[_0x2269b3(0xc5)]===_0x2269b3(0xc4)))===null||_0x32a660===void 0x0?void 0x0:_0x32a660['id']):(_0x1efbe1[constants_1[_0x2269b3(0xda)]+'Repository__c']=this[_0x2269b3(0xce)],_0x1efbe1[constants_1[_0x2269b3(0xda)]+'Source__c']='Repository',_0x1efbe1[_0x2269b3(0xec)]=(_0x7ff6a0=this[_0x2269b3(0xb7)][_0x2269b3(0x9a)](_0x3f7cbc=>_0x3f7cbc['name']===_0x2269b3(0xe1)))===null||_0x7ff6a0===void 0x0?void 0x0:_0x7ff6a0['id']),_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xd5)]=0x1):_0x1efbe1[constants_1['FLOSUM_NAMESPACE']+_0x2269b3(0xd5)]=_0xa7db7[_0x2269b3(0xf1)]+0x1,_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0x99)]=_0x4e3fb6[_0x2269b3(0xf4)],_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xc2)]=_0x4e3fb6['name'],_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xe2)]=_0x4e3fb6[_0x2269b3(0xc8)],_0x1efbe1[constants_1['FLOSUM_NAMESPACE']+_0x2269b3(0xf0)]=this['username'],_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xc0)]=this['username'],_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xd3)]=_0x3386a0,_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xf8)]=_0x3386a0,_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xa5)]=_0x4e3fb6[_0x2269b3(0xa2)],_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0xb2)]=_0x4e3fb6[_0x2269b3(0xd7)],_0x1efbe1[constants_1[_0x2269b3(0xda)]+_0x2269b3(0x9d)]=_0x4e3fb6[_0x2269b3(0xfa)],_0x1efbe1[constants_1['FLOSUM_NAMESPACE']+_0x2269b3(0x9c)]=_0x4e3fb6[_0x2269b3(0xcf)],_0x1efbe1;}[a261_0x5e3a82(0xb0)](){const _0x1bd776=a261_0x5e3a82;return this[_0x1bd776(0xd0)];}async['insert'](_0x19c44c,_0x517d25){const _0x4d6602=a261_0x5e3a82,_0x95f104=[];for(const _0x3ed682 of _0x19c44c){const _0x2f9766=(0x0,composite_utils_1[_0x4d6602(0xa0)])(constants_1[_0x4d6602(0xca)],this[_0x4d6602(0xd1)](_0x3ed682)),_0x13cb4f=(0x0,composite_utils_1[_0x4d6602(0xa0)])(constants_1[_0x4d6602(0xb3)],this[_0x4d6602(0xbe)](_0x3ed682,'@{'+_0x2f9766[_0x4d6602(0xe8)]+'.id}')),_0x19c394=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x4d6602(0xf6)],await this['prepareComponentAttachmentRecord'](_0x3ed682,'@{'+_0x13cb4f[_0x4d6602(0xe8)]+'.id}'));this[_0x4d6602(0xe6)](_0x2f9766[_0x4d6602(0xcd)]['body'],_0x2f9766[_0x4d6602(0xe8)]),_0x95f104[_0x4d6602(0xe9)](_0x2f9766['request'],_0x13cb4f[_0x4d6602(0xcd)],_0x19c394[_0x4d6602(0xcd)]),_0x517d25&&_0x95f104[_0x4d6602(0xe9)](this[_0x4d6602(0xa8)](_0x517d25,'@{'+_0x13cb4f['reference']+_0x4d6602(0x9e)));}return _0x95f104;}async['update'](_0x154e15,_0x44f86a=''){const _0x1f0566=a261_0x5e3a82,_0xe7ff9a=[];for(const {component:_0x44323d,meta:_0x56d191}of _0x154e15){if(!_0x56d191['id']){const _0x355b16=this[_0x1f0566(0xd0)][_0x1f0566(0x9a)](_0x2830e7=>_0x2830e7[_0x1f0566(0xee)]===_0x44323d[_0x1f0566(0xc5)]&&_0x2830e7['componentType']===_0x44323d[_0x1f0566(0xf4)]);if(!_0x355b16)throw new salesforce_error_1[(_0x1f0566(0xfc))](new Error(_0x1f0566(0xb5)+_0x44323d[_0x1f0566(0xc5)]+'\x20['+_0x44323d[_0x1f0566(0xf4)]+_0x1f0566(0xe0)));_0x56d191['id']=_0x355b16[_0x1f0566(0xea)];}const _0x15b3ab=(0x0,composite_utils_1[_0x1f0566(0xa4)])(constants_1[_0x1f0566(0xca)],_0x56d191['id'],this[_0x1f0566(0xd1)](_0x44323d,_0x56d191)),_0xd1a7f0=(0x0,composite_utils_1[_0x1f0566(0xa0)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x1f0566(0xbe)](_0x44323d,_0x56d191['id'],_0x56d191[_0x1f0566(0xf1)])),_0x502b8d=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x1f0566(0xf6)],await this[_0x1f0566(0xd6)](_0x44323d,'@{'+_0xd1a7f0['reference']+_0x1f0566(0x9e)));this['proceedComponentMeta'](_0x15b3ab[_0x1f0566(0xcd)][_0x1f0566(0xb6)],_0x15b3ab[_0x1f0566(0xe8)]),_0xe7ff9a['push'](_0x15b3ab[_0x1f0566(0xcd)],_0xd1a7f0[_0x1f0566(0xcd)],_0x502b8d['request']),_0x44f86a&&_0xe7ff9a['push'](this['prepareCommitManifest'](_0x44f86a,'@{'+_0xd1a7f0[_0x1f0566(0xe8)]+_0x1f0566(0x9e)));}return _0xe7ff9a;}async['delete'](_0x23da55,_0x18df1f=![]){const _0xde13e1=a261_0x5e3a82,_0x123bdf={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x5e109c=[];for(const _0x386d7e of _0x23da55){if(_0x386d7e['id'])_0x5e109c[_0xde13e1(0xe9)](_0x386d7e['id']);else{const _0x3dab2b=this[_0xde13e1(0xd0)][_0xde13e1(0x9a)](_0x19ea59=>_0x19ea59['componentName']===_0x386d7e[_0xde13e1(0xc5)]&&_0x19ea59[_0xde13e1(0x9f)]===_0x386d7e['type']);if(!_0x3dab2b||!_0x3dab2b[_0xde13e1(0xea)])continue;_0x5e109c[_0xde13e1(0xe9)](_0x3dab2b[_0xde13e1(0xea)]);}}if(_0x18df1f){const _0x42e832=await this[_0xde13e1(0xc3)]['fetchCommitManifestsByComponentIds'](_0x5e109c);_0x123bdf['manifests']=_0x42e832[_0xde13e1(0x9b)](_0x42f8eb=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1[_0xde13e1(0xe3)],_0x42f8eb)[_0xde13e1(0xcd)]);}return _0x123bdf['componentsToUpdate']=_0x5e109c[_0xde13e1(0x9b)](_0x458e20=>(0x0,composite_utils_1[_0xde13e1(0xa4)])(constants_1[_0xde13e1(0xca)],_0x458e20,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0xde13e1(0xfe)]:!![]})[_0xde13e1(0xcd)]),_0x123bdf[_0xde13e1(0xcb)]=_0x5e109c[_0xde13e1(0x9b)](_0x5643bc=>(0x0,composite_utils_1[_0xde13e1(0xc7)])(constants_1['FLOSUM_COMPONENT'],_0x5643bc)[_0xde13e1(0xcd)]),_0x123bdf;}}exports[a261_0x5e3a82(0xac)]=SalesforceComponentsManager;