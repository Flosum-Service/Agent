const a244_0xf61633=a244_0x49f5;(function(_0x51cd97,_0x38f558){const _0x2e2fdf=a244_0x49f5,_0x57f9be=_0x51cd97();while(!![]){try{const _0x196921=parseInt(_0x2e2fdf(0x1b3))/0x1+parseInt(_0x2e2fdf(0x1a1))/0x2+parseInt(_0x2e2fdf(0x1ea))/0x3+parseInt(_0x2e2fdf(0x1a3))/0x4+-parseInt(_0x2e2fdf(0x1e4))/0x5*(-parseInt(_0x2e2fdf(0x1de))/0x6)+parseInt(_0x2e2fdf(0x1d4))/0x7*(parseInt(_0x2e2fdf(0x1e7))/0x8)+-parseInt(_0x2e2fdf(0x1c9))/0x9;if(_0x196921===_0x38f558)break;else _0x57f9be['push'](_0x57f9be['shift']());}catch(_0x5817f0){_0x57f9be['push'](_0x57f9be['shift']());}}}(a244_0x2dca,0xe8512));const a244_0x1a3ec0=(function(){let _0xd1e019=!![];return function(_0x4b11d8,_0x57ebb9){const _0x1230ec=_0xd1e019?function(){const _0x135267=a244_0x49f5;if(_0x57ebb9){const _0x1063a9=_0x57ebb9[_0x135267(0x19e)](_0x4b11d8,arguments);return _0x57ebb9=null,_0x1063a9;}}:function(){};return _0xd1e019=![],_0x1230ec;};}()),a244_0x5f5b45=a244_0x1a3ec0(this,function(){const _0x3d5a5c=a244_0x49f5;return a244_0x5f5b45[_0x3d5a5c(0x1dd)]()[_0x3d5a5c(0x1dc)]('(((.+)+)+)+$')[_0x3d5a5c(0x1dd)]()[_0x3d5a5c(0x1c4)](a244_0x5f5b45)[_0x3d5a5c(0x1dc)](_0x3d5a5c(0x1e8));});function a244_0x49f5(_0x40dce4,_0x369ed7){const _0x1b3cc6=a244_0x2dca();return a244_0x49f5=function(_0x5f5b45,_0x1a3ec0){_0x5f5b45=_0x5f5b45-0x18b;let _0x2dca08=_0x1b3cc6[_0x5f5b45];return _0x2dca08;},a244_0x49f5(_0x40dce4,_0x369ed7);}a244_0x5f5b45();function a244_0x2dca(){const _0x46e688=['prepareComponentHistoryRecord','default','CRC32__c','SalesforceError','Logger','search','toString','258PxLFhK','componentId','reference','find','__importDefault','proceededComponentsMeta','91895xzSadC','type','componentsToDelete','16MaqHXm','(((.+)+)+)+$','SalesforceComponentsManager','2659542qoxHGu','push','prepareCommitManifest','request','file','getProceededComponentsMeta','proceedComponentMeta','../errors/salesforce.error','isVlocityComponent','update','toISOString','manifests','delete','componentName','componentType','files','filePath','defineProperty','generateAsync','Version__c','get','Branch__c','RecordTypeId','Repository','File_Name__c','Last_Updated_By__c','apply','FLOSUM_NAMESPACE','Vlocity_Component_Name__c','2079668VCbWbV','prepareComponentAttachmentRecord','3609744OqctTP','keys','Deletion_By_Agent__c','FLOSUM_GIT_NAMESPACE','FLOSUM_COMMIT_MANIFEST','version','typedi','createPostRequest','map','Component_Type__c','name','prepareComponentRecord','../utils/flosum-naming.utils','Component__c','createZip','extractFieldsFromRecord','1134842lVIXNJ','repositoryId','Could\x20not\x20proceed\x20component\x20','__esModule','Changed_On__c','Body','createPatchRequest','Is_From_Agent__c','../utils/composite.utils','Branch','FLOSUM_ATTACHMENT','createDeleteRequest','FLOSUM_COMPONENT','branchId','body','Changed_By__c','crc','constructor','.id}','recordTypes','logger','fetchCommitManifestsByComponentIds','46576791tPIZdI','Component_History__c','gitSync',']\x20-\x20meta\x20not\x20found','ParentId','componentsToUpdate','Component_Name__c','../../../../constants','Description','Last_Modified_By__c','Name','4804961PRKSQE','username','../../../../core'];a244_0x2dca=function(){return _0x46e688;};return a244_0x2dca();}'use strict';var __importDefault=this&&this[a244_0xf61633(0x1e2)]||function(_0xc880d3){const _0x11918f=a244_0xf61633;return _0xc880d3&&_0xc880d3[_0x11918f(0x1b6)]?_0xc880d3:{'default':_0xc880d3};};Object[a244_0xf61633(0x195)](exports,a244_0xf61633(0x1b6),{'value':!![]}),exports[a244_0xf61633(0x1e9)]=void 0x0;const constants_1=require(a244_0xf61633(0x1d0)),core_1=require(a244_0xf61633(0x1d6)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require(a244_0xf61633(0x1a9))),salesforce_error_1=require(a244_0xf61633(0x18b)),composite_utils_1=require(a244_0xf61633(0x1bb)),flosum_naming_utils_1=require(a244_0xf61633(0x1af)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceComponentsManager{constructor(_0xcd9c29,_0x1b4bf6,_0x2f1d23,_0x227dee,_0x543f8c){const _0x55e13c=a244_0xf61633;this[_0x55e13c(0x1b4)]=_0xcd9c29,this[_0x55e13c(0x1c0)]=_0x1b4bf6,this[_0x55e13c(0x1d5)]=_0x2f1d23,this['recordTypes']=_0x227dee,this[_0x55e13c(0x1e3)]=_0x543f8c,this[_0x55e13c(0x1c7)]=new core_1[(_0x55e13c(0x1db))](SalesforceComponentsManager['name']),this[_0x55e13c(0x1cb)]=typedi_1[_0x55e13c(0x1d8)][_0x55e13c(0x198)](salesforce_git_sync_service_1['SalesforceGitSyncService']);}[a244_0xf61633(0x1f0)](_0x42daaa,_0x48244a){const _0x166bfa=a244_0xf61633,_0x440f80=(0x0,flosum_naming_utils_1[_0x166bfa(0x1b2)])(_0x42daaa,[_0x166bfa(0x1ac),_0x166bfa(0x1cf),_0x166bfa(0x197)]);this['proceededComponentsMeta'][_0x166bfa(0x1eb)]({'componentId':'','reference':_0x48244a,'version':_0x440f80[_0x166bfa(0x197)],'componentName':_0x440f80[_0x166bfa(0x1cf)],'componentType':_0x440f80[_0x166bfa(0x1ac)]});}[a244_0xf61633(0x1ec)](_0x2dc9ac,_0x287ca6){const _0x1f99ad=a244_0xf61633,{request:_0xc45359}=(0x0,composite_utils_1[_0x1f99ad(0x1aa)])(constants_1[_0x1f99ad(0x1a7)],{[constants_1[_0x1f99ad(0x19f)]+'Commit__c']:_0x2dc9ac,[constants_1[_0x1f99ad(0x19f)]+_0x1f99ad(0x1ca)]:_0x287ca6});return _0xc45359;}async['prepareComponentAttachmentRecord'](_0x22a480,_0x572863){const _0x70a804=a244_0xf61633,_0x1ff74d={},_0x15a24e=zip_1['Zip'][_0x70a804(0x1b1)]();for(const _0x17e779 of Object[_0x70a804(0x1a4)](_0x22a480[_0x70a804(0x193)])){_0x15a24e[_0x70a804(0x1ee)](_0x17e779,_0x22a480[_0x70a804(0x193)][_0x17e779],{'createFolders':!![]});}return _0x1ff74d['ContentType']='application/zip',_0x1ff74d[_0x70a804(0x1d3)]=_0x22a480[_0x70a804(0x1e5)],_0x1ff74d[_0x70a804(0x1d1)]=_0x22a480[_0x70a804(0x1e5)],_0x1ff74d[_0x70a804(0x1cd)]=_0x572863,_0x1ff74d[_0x70a804(0x1b8)]=await _0x15a24e[_0x70a804(0x196)]({'type':'base64','compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x1ff74d;}[a244_0xf61633(0x1d7)](_0x5723b2,_0x41f987,_0x105cc4){const _0x2f07b7=a244_0xf61633,_0x231ba2=new Date()[_0x2f07b7(0x18e)](),_0xd26368={};return _0xd26368[constants_1[_0x2f07b7(0x19f)]+_0x2f07b7(0x1b0)]=_0x41f987,_0xd26368[constants_1['FLOSUM_NAMESPACE']+_0x2f07b7(0x1d9)]=_0x5723b2['crc'],_0xd26368[constants_1['FLOSUM_NAMESPACE']+_0x2f07b7(0x1b7)]=_0x231ba2,_0xd26368[constants_1[_0x2f07b7(0x19f)]+_0x2f07b7(0x1c2)]=this[_0x2f07b7(0x1d5)],_0xd26368[constants_1[_0x2f07b7(0x19f)]+_0x2f07b7(0x197)]=_0x105cc4?_0x105cc4+0x1:0x1,_0xd26368[constants_1[_0x2f07b7(0x1a6)]+_0x2f07b7(0x1ba)]=!![],_0xd26368;}[a244_0xf61633(0x1ae)](_0x132e96,_0x2849bf){const _0x37f112=a244_0xf61633;var _0x4a219,_0x5cb9f7;const _0x1f6ccc=new Date()[_0x37f112(0x18e)](),_0x112f0e={};return!_0x2849bf?(this['branchId']?(_0x112f0e[constants_1[_0x37f112(0x19f)]+_0x37f112(0x199)]=this[_0x37f112(0x1c0)],_0x112f0e[constants_1['FLOSUM_NAMESPACE']+'Source__c']=_0x37f112(0x1bc),_0x112f0e[_0x37f112(0x19a)]=(_0x4a219=this[_0x37f112(0x1c6)]['find'](_0x4f0429=>_0x4f0429[_0x37f112(0x1ad)]===_0x37f112(0x1bc)))===null||_0x4a219===void 0x0?void 0x0:_0x4a219['id']):(_0x112f0e[constants_1['FLOSUM_NAMESPACE']+'Repository__c']=this[_0x37f112(0x1b4)],_0x112f0e[constants_1['FLOSUM_NAMESPACE']+'Source__c']='Repository',_0x112f0e[_0x37f112(0x19a)]=(_0x5cb9f7=this['recordTypes'][_0x37f112(0x1e1)](_0x36896d=>_0x36896d[_0x37f112(0x1ad)]===_0x37f112(0x19b)))===null||_0x5cb9f7===void 0x0?void 0x0:_0x5cb9f7['id']),_0x112f0e[constants_1['FLOSUM_NAMESPACE']+_0x37f112(0x197)]=0x1):_0x112f0e[constants_1[_0x37f112(0x19f)]+'Version__c']=_0x2849bf[_0x37f112(0x1a8)]+0x1,_0x112f0e[constants_1['FLOSUM_NAMESPACE']+_0x37f112(0x1ac)]=_0x132e96[_0x37f112(0x1e5)],_0x112f0e[constants_1[_0x37f112(0x19f)]+'Component_Name__c']=_0x132e96[_0x37f112(0x1ad)],_0x112f0e[constants_1[_0x37f112(0x19f)]+_0x37f112(0x19c)]=_0x132e96[_0x37f112(0x194)],_0x112f0e[constants_1[_0x37f112(0x19f)]+_0x37f112(0x19d)]=this[_0x37f112(0x1d5)],_0x112f0e[constants_1[_0x37f112(0x19f)]+_0x37f112(0x1d2)]=this['username'],_0x112f0e[constants_1['FLOSUM_NAMESPACE']+'Last_Modified_Date__c']=_0x1f6ccc,_0x112f0e[constants_1[_0x37f112(0x19f)]+'Committed_On__c']=_0x1f6ccc,_0x112f0e[constants_1['FLOSUM_NAMESPACE']+_0x37f112(0x1d9)]=_0x132e96[_0x37f112(0x1c3)],_0x112f0e[constants_1[_0x37f112(0x19f)]+_0x37f112(0x1a0)]=_0x132e96['vlocityComponentName'],_0x112f0e[constants_1['FLOSUM_NAMESPACE']+'Vlocity_Component__c']=_0x132e96[_0x37f112(0x18c)],_0x112f0e[constants_1['FLOSUM_NAMESPACE']+'MC_Key__c']=_0x132e96['marketingCloudKey'],_0x112f0e;}[a244_0xf61633(0x1ef)](){const _0x2ea1ad=a244_0xf61633;return this[_0x2ea1ad(0x1e3)];}async['insert'](_0x4060ae,_0x402672){const _0x3f43dd=a244_0xf61633,_0x6ef7ba=[];for(const _0x5eaffd of _0x4060ae){const _0x30c75b=(0x0,composite_utils_1[_0x3f43dd(0x1aa)])(constants_1['FLOSUM_COMPONENT'],this[_0x3f43dd(0x1ae)](_0x5eaffd)),_0xab0f95=(0x0,composite_utils_1[_0x3f43dd(0x1aa)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x3f43dd(0x1d7)](_0x5eaffd,'@{'+_0x30c75b[_0x3f43dd(0x1e0)]+_0x3f43dd(0x1c5))),_0x1115d1=(0x0,composite_utils_1[_0x3f43dd(0x1aa)])(constants_1[_0x3f43dd(0x1bd)],await this[_0x3f43dd(0x1a2)](_0x5eaffd,'@{'+_0xab0f95[_0x3f43dd(0x1e0)]+_0x3f43dd(0x1c5)));this[_0x3f43dd(0x1f0)](_0x30c75b[_0x3f43dd(0x1ed)][_0x3f43dd(0x1c1)],_0x30c75b[_0x3f43dd(0x1e0)]),_0x6ef7ba[_0x3f43dd(0x1eb)](_0x30c75b['request'],_0xab0f95['request'],_0x1115d1[_0x3f43dd(0x1ed)]),_0x402672&&_0x6ef7ba[_0x3f43dd(0x1eb)](this['prepareCommitManifest'](_0x402672,'@{'+_0xab0f95[_0x3f43dd(0x1e0)]+_0x3f43dd(0x1c5)));}return _0x6ef7ba;}async[a244_0xf61633(0x18d)](_0x532770,_0x10dc11=''){const _0x11f27a=a244_0xf61633,_0x1ddc94=[];for(const {component:_0x39cef6,meta:_0x2ffebe}of _0x532770){if(!_0x2ffebe['id']){const _0x3323fa=this[_0x11f27a(0x1e3)][_0x11f27a(0x1e1)](_0x100ec3=>_0x100ec3[_0x11f27a(0x191)]===_0x39cef6[_0x11f27a(0x1ad)]&&_0x100ec3['componentType']===_0x39cef6[_0x11f27a(0x1e5)]);if(!_0x3323fa)throw new salesforce_error_1[(_0x11f27a(0x1da))](new Error(_0x11f27a(0x1b5)+_0x39cef6['name']+'\x20['+_0x39cef6[_0x11f27a(0x1e5)]+_0x11f27a(0x1cc)));_0x2ffebe['id']=_0x3323fa[_0x11f27a(0x1df)];}const _0x5231fb=(0x0,composite_utils_1[_0x11f27a(0x1b9)])(constants_1[_0x11f27a(0x1bf)],_0x2ffebe['id'],this[_0x11f27a(0x1ae)](_0x39cef6,_0x2ffebe)),_0x3853e4=(0x0,composite_utils_1[_0x11f27a(0x1aa)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x11f27a(0x1d7)](_0x39cef6,_0x2ffebe['id'],_0x2ffebe[_0x11f27a(0x1a8)])),_0x5cd7d7=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x11f27a(0x1bd)],await this[_0x11f27a(0x1a2)](_0x39cef6,'@{'+_0x3853e4[_0x11f27a(0x1e0)]+_0x11f27a(0x1c5)));this[_0x11f27a(0x1f0)](_0x5231fb[_0x11f27a(0x1ed)][_0x11f27a(0x1c1)],_0x5231fb[_0x11f27a(0x1e0)]),_0x1ddc94[_0x11f27a(0x1eb)](_0x5231fb[_0x11f27a(0x1ed)],_0x3853e4[_0x11f27a(0x1ed)],_0x5cd7d7[_0x11f27a(0x1ed)]),_0x10dc11&&_0x1ddc94[_0x11f27a(0x1eb)](this[_0x11f27a(0x1ec)](_0x10dc11,'@{'+_0x3853e4[_0x11f27a(0x1e0)]+_0x11f27a(0x1c5)));}return _0x1ddc94;}async[a244_0xf61633(0x190)](_0x5e6b6e,_0x3fffe7=![]){const _0x10baec=a244_0xf61633,_0x56ea5b={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x39db7d=[];for(const _0x4ee089 of _0x5e6b6e){if(_0x4ee089['id'])_0x39db7d[_0x10baec(0x1eb)](_0x4ee089['id']);else{const _0x39cc58=this[_0x10baec(0x1e3)][_0x10baec(0x1e1)](_0xeb3196=>_0xeb3196[_0x10baec(0x191)]===_0x4ee089[_0x10baec(0x1ad)]&&_0xeb3196[_0x10baec(0x192)]===_0x4ee089['type']);if(!_0x39cc58||!_0x39cc58[_0x10baec(0x1df)])continue;_0x39db7d[_0x10baec(0x1eb)](_0x39cc58[_0x10baec(0x1df)]);}}if(_0x3fffe7){const _0x25f738=await this[_0x10baec(0x1cb)][_0x10baec(0x1c8)](_0x39db7d);_0x56ea5b[_0x10baec(0x18f)]=_0x25f738[_0x10baec(0x1ab)](_0x290dbe=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1[_0x10baec(0x1a7)],_0x290dbe)[_0x10baec(0x1ed)]);}return _0x56ea5b[_0x10baec(0x1ce)]=_0x39db7d[_0x10baec(0x1ab)](_0x53224b=>(0x0,composite_utils_1[_0x10baec(0x1b9)])(constants_1[_0x10baec(0x1bf)],_0x53224b,{[constants_1[_0x10baec(0x1a6)]+_0x10baec(0x1a5)]:!![]})['request']),_0x56ea5b[_0x10baec(0x1e6)]=_0x39db7d['map'](_0x3520b3=>(0x0,composite_utils_1[_0x10baec(0x1be)])(constants_1[_0x10baec(0x1bf)],_0x3520b3)[_0x10baec(0x1ed)]),_0x56ea5b;}}exports[a244_0xf61633(0x1e9)]=SalesforceComponentsManager;