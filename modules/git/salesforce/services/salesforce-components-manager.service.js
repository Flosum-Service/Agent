const a182_0x570e89=a182_0x1f87;(function(_0x4640a2,_0x1d56ef){const _0x29e16f=a182_0x1f87,_0x1c7a53=_0x4640a2();while(!![]){try{const _0x4392ed=parseInt(_0x29e16f(0x19f))/0x1*(-parseInt(_0x29e16f(0x19b))/0x2)+parseInt(_0x29e16f(0x169))/0x3+parseInt(_0x29e16f(0x17a))/0x4+-parseInt(_0x29e16f(0x143))/0x5*(-parseInt(_0x29e16f(0x15d))/0x6)+-parseInt(_0x29e16f(0x199))/0x7+-parseInt(_0x29e16f(0x159))/0x8*(parseInt(_0x29e16f(0x16d))/0x9)+parseInt(_0x29e16f(0x164))/0xa;if(_0x4392ed===_0x1d56ef)break;else _0x1c7a53['push'](_0x1c7a53['shift']());}catch(_0x42da46){_0x1c7a53['push'](_0x1c7a53['shift']());}}}(a182_0x4b62,0xaccfc));const a182_0x17e4cd=(function(){let _0x1a3ba7=!![];return function(_0x4c9ba2,_0x2b1641){const _0x2a00f9=_0x1a3ba7?function(){const _0x27877a=a182_0x1f87;if(_0x2b1641){const _0x169297=_0x2b1641[_0x27877a(0x14f)](_0x4c9ba2,arguments);return _0x2b1641=null,_0x169297;}}:function(){};return _0x1a3ba7=![],_0x2a00f9;};}()),a182_0x4fb046=a182_0x17e4cd(this,function(){const _0x2743fa=a182_0x1f87;return a182_0x4fb046[_0x2743fa(0x18e)]()['search'](_0x2743fa(0x15e))[_0x2743fa(0x18e)]()[_0x2743fa(0x14a)](a182_0x4fb046)[_0x2743fa(0x197)](_0x2743fa(0x15e));});a182_0x4fb046();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2f60d4){const _0xb1ed64=a182_0x1f87;return _0x2f60d4&&_0x2f60d4[_0xb1ed64(0x180)]?_0x2f60d4:{'default':_0x2f60d4};};function a182_0x1f87(_0x1c9b87,_0x36d3fb){const _0x3097a2=a182_0x4b62();return a182_0x1f87=function(_0x4fb046,_0x17e4cd){_0x4fb046=_0x4fb046-0x143;let _0x4b62d9=_0x3097a2[_0x4fb046];return _0x4b62d9;},a182_0x1f87(_0x1c9b87,_0x36d3fb);}Object['defineProperty'](exports,a182_0x570e89(0x180),{'value':!![]}),exports[a182_0x570e89(0x186)]=void 0x0;const constants_1=require(a182_0x570e89(0x196)),core_1=require(a182_0x570e89(0x155)),zip_1=require(a182_0x570e89(0x17d)),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a182_0x570e89(0x167)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a182_0x570e89(0x15a)),salesforce_git_sync_service_1=require(a182_0x570e89(0x193));class SalesforceComponentsManager{constructor(_0x1c3e70,_0x347f19,_0x31e007,_0x517e15,_0x4656cb){const _0x36d94d=a182_0x570e89;this[_0x36d94d(0x14b)]=_0x1c3e70,this[_0x36d94d(0x16e)]=_0x347f19,this[_0x36d94d(0x16f)]=_0x31e007,this[_0x36d94d(0x17e)]=_0x517e15,this['proceededComponentsMeta']=_0x4656cb,this['logger']=new core_1[(_0x36d94d(0x191))](SalesforceComponentsManager[_0x36d94d(0x18b)]),this[_0x36d94d(0x16c)]=typedi_1[_0x36d94d(0x165)]['get'](salesforce_git_sync_service_1[_0x36d94d(0x15c)]);}[a182_0x570e89(0x177)](_0x2a2a85,_0x5108e4){const _0x16da3e=a182_0x570e89,_0x2c3b66=flosum_naming_utils_1[_0x16da3e(0x175)](_0x2a2a85,[_0x16da3e(0x170),'Component_Name__c','Version__c']);this[_0x16da3e(0x157)][_0x16da3e(0x174)]({'componentId':'','reference':_0x5108e4,'version':_0x2c3b66[_0x16da3e(0x19a)],'componentName':_0x2c3b66['Component_Name__c'],'componentType':_0x2c3b66[_0x16da3e(0x170)]});}[a182_0x570e89(0x1a0)](_0x2d99db,_0x2a460c){const _0x473720=a182_0x570e89,{request:_0x3f44bf}=composite_utils_1[_0x473720(0x154)](constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1[_0x473720(0x17b)]+_0x473720(0x181)]:_0x2d99db,[constants_1[_0x473720(0x17b)]+_0x473720(0x172)]:_0x2a460c});return _0x3f44bf;}async[a182_0x570e89(0x16a)](_0x55c08e,_0x39bfd1){const _0x12c22d=a182_0x570e89,_0x23b1eb={},_0x8f562a=zip_1[_0x12c22d(0x18f)]['createZip']();for(const _0x29e8f0 of Object['keys'](_0x55c08e[_0x12c22d(0x19e)])){_0x8f562a[_0x12c22d(0x15f)](_0x29e8f0,_0x55c08e[_0x12c22d(0x19e)][_0x29e8f0],{'createFolders':!![]});}return _0x23b1eb['ContentType']='application/zip',_0x23b1eb[_0x12c22d(0x19d)]=_0x55c08e[_0x12c22d(0x18a)],_0x23b1eb[_0x12c22d(0x17f)]=_0x55c08e[_0x12c22d(0x18a)],_0x23b1eb['ParentId']=_0x39bfd1,_0x23b1eb[_0x12c22d(0x190)]=await _0x8f562a[_0x12c22d(0x168)]({'type':'base64','compression':_0x12c22d(0x163),'compressionOptions':{'level':0x6}}),_0x23b1eb;}['prepareComponentHistoryRecord'](_0xf9a6fa,_0x2d6ce2,_0x10a33f){const _0x444da8=a182_0x570e89,_0x1a042e=new Date()[_0x444da8(0x189)](),_0x5528bc={};return _0x5528bc[constants_1[_0x444da8(0x17b)]+'Component__c']=_0x2d6ce2,_0x5528bc[constants_1[_0x444da8(0x17b)]+_0x444da8(0x1a3)]=_0xf9a6fa[_0x444da8(0x192)],_0x5528bc[constants_1[_0x444da8(0x17b)]+_0x444da8(0x194)]=_0x1a042e,_0x5528bc[constants_1[_0x444da8(0x17b)]+'Changed_By__c']=this['username'],_0x5528bc[constants_1['FLOSUM_NAMESPACE']+_0x444da8(0x19a)]=_0x10a33f?_0x10a33f+0x1:0x1,_0x5528bc[constants_1[_0x444da8(0x156)]+_0x444da8(0x1a1)]=!![],_0x5528bc;}[a182_0x570e89(0x152)](_0x481abb,_0x27a5a4){const _0x3609e3=a182_0x570e89;var _0x4f69e5,_0x26642b;const _0xb38a23=new Date()[_0x3609e3(0x189)](),_0x4bd67b={};return!_0x27a5a4?(this[_0x3609e3(0x16e)]?(_0x4bd67b[constants_1['FLOSUM_NAMESPACE']+_0x3609e3(0x178)]=this[_0x3609e3(0x16e)],_0x4bd67b[constants_1[_0x3609e3(0x17b)]+_0x3609e3(0x17c)]=_0x3609e3(0x188),_0x4bd67b['RecordTypeId']=(_0x4f69e5=this['recordTypes'][_0x3609e3(0x14c)](_0x4d9d26=>_0x4d9d26['name']===_0x3609e3(0x188)))===null||_0x4f69e5===void 0x0?void 0x0:_0x4f69e5['id']):(_0x4bd67b[constants_1['FLOSUM_NAMESPACE']+_0x3609e3(0x179)]=this[_0x3609e3(0x14b)],_0x4bd67b[constants_1[_0x3609e3(0x17b)]+_0x3609e3(0x17c)]='Repository',_0x4bd67b[_0x3609e3(0x145)]=(_0x26642b=this['recordTypes'][_0x3609e3(0x14c)](_0x387bfd=>_0x387bfd[_0x3609e3(0x18b)]===_0x3609e3(0x148)))===null||_0x26642b===void 0x0?void 0x0:_0x26642b['id']),_0x4bd67b[constants_1[_0x3609e3(0x17b)]+_0x3609e3(0x19a)]=0x1):_0x4bd67b[constants_1[_0x3609e3(0x17b)]+_0x3609e3(0x19a)]=_0x27a5a4[_0x3609e3(0x183)]+0x1,_0x4bd67b[constants_1[_0x3609e3(0x17b)]+'Component_Type__c']=_0x481abb[_0x3609e3(0x18a)],_0x4bd67b[constants_1['FLOSUM_NAMESPACE']+_0x3609e3(0x149)]=_0x481abb[_0x3609e3(0x18b)],_0x4bd67b[constants_1[_0x3609e3(0x17b)]+_0x3609e3(0x166)]=_0x481abb[_0x3609e3(0x182)],_0x4bd67b[constants_1['FLOSUM_NAMESPACE']+_0x3609e3(0x161)]=this['username'],_0x4bd67b[constants_1[_0x3609e3(0x17b)]+'Last_Modified_By__c']=this[_0x3609e3(0x16f)],_0x4bd67b[constants_1['FLOSUM_NAMESPACE']+_0x3609e3(0x14e)]=_0xb38a23,_0x4bd67b[constants_1['FLOSUM_NAMESPACE']+_0x3609e3(0x184)]=_0xb38a23,_0x4bd67b[constants_1[_0x3609e3(0x17b)]+_0x3609e3(0x1a3)]=_0x481abb['crc'],_0x4bd67b;}[a182_0x570e89(0x187)](){return this['proceededComponentsMeta'];}async['insert'](_0xa13c3e,_0x5e8f3d){const _0x2b7927=a182_0x570e89,_0x473b1e=[];for(const _0x5e21d7 of _0xa13c3e){const _0x4ab086=composite_utils_1['createPostRequest'](constants_1[_0x2b7927(0x1a2)],this[_0x2b7927(0x152)](_0x5e21d7)),_0x58e3a6=composite_utils_1[_0x2b7927(0x154)](constants_1[_0x2b7927(0x146)],this['prepareComponentHistoryRecord'](_0x5e21d7,'@{'+_0x4ab086[_0x2b7927(0x14d)]+_0x2b7927(0x147))),_0xbc888b=composite_utils_1[_0x2b7927(0x154)](constants_1[_0x2b7927(0x195)],await this['prepareComponentAttachmentRecord'](_0x5e21d7,'@{'+_0x58e3a6[_0x2b7927(0x14d)]+_0x2b7927(0x147)));this[_0x2b7927(0x177)](_0x4ab086[_0x2b7927(0x185)][_0x2b7927(0x160)],_0x4ab086[_0x2b7927(0x14d)]),_0x473b1e[_0x2b7927(0x174)](_0x4ab086[_0x2b7927(0x185)],_0x58e3a6[_0x2b7927(0x185)],_0xbc888b[_0x2b7927(0x185)]),_0x5e8f3d&&_0x473b1e['push'](this['prepareCommitManifest'](_0x5e8f3d,'@{'+_0x58e3a6[_0x2b7927(0x14d)]+_0x2b7927(0x147)));}return _0x473b1e;}async[a182_0x570e89(0x16b)](_0x25309e,_0x3356e6=''){const _0x3085c6=a182_0x570e89,_0x2fa835=[];for(const {component:_0x226958,meta:_0x2d4ae6}of _0x25309e){if(!_0x2d4ae6['id']){const _0x482c6a=this[_0x3085c6(0x157)][_0x3085c6(0x14c)](_0x20c1f0=>_0x20c1f0['componentName']===_0x226958[_0x3085c6(0x18b)]&&_0x20c1f0[_0x3085c6(0x18c)]===_0x226958['type']);if(!_0x482c6a)throw new salesforce_error_1[(_0x3085c6(0x144))](new Error(_0x3085c6(0x151)+_0x226958[_0x3085c6(0x18b)]+'\x20['+_0x226958[_0x3085c6(0x18a)]+_0x3085c6(0x153)));_0x2d4ae6['id']=_0x482c6a[_0x3085c6(0x173)];}const _0x479c03=composite_utils_1[_0x3085c6(0x158)](constants_1[_0x3085c6(0x1a2)],_0x2d4ae6['id'],this[_0x3085c6(0x152)](_0x226958,_0x2d4ae6)),_0x2d8414=composite_utils_1[_0x3085c6(0x154)](constants_1[_0x3085c6(0x146)],this[_0x3085c6(0x171)](_0x226958,_0x2d4ae6['id'],_0x2d4ae6[_0x3085c6(0x183)])),_0x2602b6=composite_utils_1['createPostRequest'](constants_1[_0x3085c6(0x195)],await this['prepareComponentAttachmentRecord'](_0x226958,'@{'+_0x2d8414['reference']+_0x3085c6(0x147)));this[_0x3085c6(0x177)](_0x479c03[_0x3085c6(0x185)][_0x3085c6(0x160)],_0x479c03[_0x3085c6(0x14d)]),_0x2fa835[_0x3085c6(0x174)](_0x479c03['request'],_0x2d8414[_0x3085c6(0x185)],_0x2602b6['request']),_0x3356e6&&_0x2fa835[_0x3085c6(0x174)](this['prepareCommitManifest'](_0x3356e6,'@{'+_0x2d8414['reference']+_0x3085c6(0x147)));}return _0x2fa835;}async[a182_0x570e89(0x176)](_0x203a8c,_0xea3ffc=![]){const _0x5ba67d=a182_0x570e89,_0x5bfe07={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x36b530=[];for(const _0x555cf5 of _0x203a8c){if(_0x555cf5['id'])_0x36b530[_0x5ba67d(0x174)](_0x555cf5['id']);else{const _0x15f74f=this['proceededComponentsMeta']['find'](_0xa853ce=>_0xa853ce[_0x5ba67d(0x19c)]===_0x555cf5[_0x5ba67d(0x18b)]&&_0xa853ce['componentType']===_0x555cf5[_0x5ba67d(0x18a)]);if(!_0x15f74f||!_0x15f74f[_0x5ba67d(0x173)])continue;_0x36b530[_0x5ba67d(0x174)](_0x15f74f[_0x5ba67d(0x173)]);}}if(_0xea3ffc){const _0x8f678c=await this[_0x5ba67d(0x16c)][_0x5ba67d(0x18d)](_0x36b530);_0x5bfe07['manifests']=_0x8f678c[_0x5ba67d(0x1a4)](_0x3fad4d=>composite_utils_1[_0x5ba67d(0x198)](constants_1[_0x5ba67d(0x150)],_0x3fad4d)[_0x5ba67d(0x185)]);}return _0x5bfe07[_0x5ba67d(0x162)]=_0x36b530[_0x5ba67d(0x1a4)](_0x59c05f=>composite_utils_1[_0x5ba67d(0x158)](constants_1[_0x5ba67d(0x1a2)],_0x59c05f,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x5ba67d(0x15b)]:!![]})[_0x5ba67d(0x185)]),_0x5bfe07['componentsToDelete']=_0x36b530['map'](_0x4e3569=>composite_utils_1[_0x5ba67d(0x198)](constants_1[_0x5ba67d(0x1a2)],_0x4e3569)['request']),_0x5bfe07;}}exports[a182_0x570e89(0x186)]=SalesforceComponentsManager;function a182_0x4b62(){const _0x303d5d=['crc','./salesforce-git-sync.service','Changed_On__c','FLOSUM_ATTACHMENT','../../../../constants','search','createDeleteRequest','6340145jsKAms','Version__c','46hiItfo','componentName','Name','files','12850AIldHY','prepareCommitManifest','Is_From_Agent__c','FLOSUM_COMPONENT','CRC32__c','map','4653195zcvIRS','SalesforceError','RecordTypeId','FLOSUM_COMPONENT_HISTORY','.id}','Repository','Component_Name__c','constructor','repositoryId','find','reference','Last_Modified_Date__c','apply','FLOSUM_COMMIT_MANIFEST','Could\x20not\x20proceed\x20component\x20','prepareComponentRecord',']\x20-\x20meta\x20not\x20found','createPostRequest','../../../../core','FLOSUM_GIT_NAMESPACE','proceededComponentsMeta','createPatchRequest','8uBELXR','../utils/flosum-naming.utils','Deletion_By_Agent__c','SalesforceGitSyncService','6EDOeYj','(((.+)+)+)+$','file','body','Last_Updated_By__c','componentsToUpdate','DEFLATE','9265310pwSsCt','default','File_Name__c','../errors/salesforce.error','generateAsync','1017000PGOoMU','prepareComponentAttachmentRecord','update','gitSync','3716649PJlQeX','branchId','username','Component_Type__c','prepareComponentHistoryRecord','Component_History__c','componentId','push','extractFieldsFromRecord','delete','proceedComponentMeta','Branch__c','Repository__c','503648dFMllq','FLOSUM_NAMESPACE','Source__c','../../parsers/utils/zip','recordTypes','Description','__esModule','Commit__c','filePath','version','Committed_On__c','request','SalesforceComponentsManager','getProceededComponentsMeta','Branch','toISOString','type','name','componentType','fetchCommitManifestsByComponentIds','toString','Zip','Body','Logger'];a182_0x4b62=function(){return _0x303d5d;};return a182_0x4b62();}