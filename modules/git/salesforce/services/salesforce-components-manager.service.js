const a261_0xc5030e=a261_0x21c9;(function(_0x380651,_0x447dc9){const _0x5976c7=a261_0x21c9,_0x4c1272=_0x380651();while(!![]){try{const _0x342a41=parseInt(_0x5976c7(0x1cd))/0x1+parseInt(_0x5976c7(0x1dc))/0x2*(-parseInt(_0x5976c7(0x1cb))/0x3)+parseInt(_0x5976c7(0x1e4))/0x4*(-parseInt(_0x5976c7(0x1d0))/0x5)+parseInt(_0x5976c7(0x1d5))/0x6*(-parseInt(_0x5976c7(0x1d8))/0x7)+parseInt(_0x5976c7(0x1ed))/0x8+parseInt(_0x5976c7(0x1a6))/0x9*(parseInt(_0x5976c7(0x1c8))/0xa)+-parseInt(_0x5976c7(0x1a1))/0xb;if(_0x342a41===_0x447dc9)break;else _0x4c1272['push'](_0x4c1272['shift']());}catch(_0x2efa8b){_0x4c1272['push'](_0x4c1272['shift']());}}}(a261_0x205a,0x5f847));const a261_0xb76890=(function(){let _0x321d38=!![];return function(_0x38112f,_0x1f3326){const _0x123f12=_0x321d38?function(){const _0x307633=a261_0x21c9;if(_0x1f3326){const _0x83c5e2=_0x1f3326[_0x307633(0x1ad)](_0x38112f,arguments);return _0x1f3326=null,_0x83c5e2;}}:function(){};return _0x321d38=![],_0x123f12;};}()),a261_0x527778=a261_0xb76890(this,function(){const _0x580053=a261_0x21c9;return a261_0x527778[_0x580053(0x1ca)]()[_0x580053(0x1a0)](_0x580053(0x1c3))['toString']()[_0x580053(0x1c0)](a261_0x527778)[_0x580053(0x1a0)](_0x580053(0x1c3));});a261_0x527778();'use strict';function a261_0x205a(){const _0x471152=['branchId','createPostRequest','toISOString','proceededComponentsMeta','fetchCommitManifestsByComponentIds','FLOSUM_COMPONENT_HISTORY','componentsToUpdate','search','1182874LiWvHQ','componentsToDelete','File_Name__c','RecordTypeId','prepareComponentAttachmentRecord','441piYGle','files','find','Changed_On__c','./salesforce-git-sync.service','prepareCommitManifest','Last_Modified_By__c','apply','Deletion_By_Agent__c','../../../../core','reference','createDeleteRequest','type','../utils/composite.utils','Could\x20not\x20proceed\x20component\x20','filePath','Description','Repository__c','defineProperty','marketingCloudKey','ParentId','getProceededComponentsMeta','get','version','crc','__importDefault','constructor','gitSync','FLOSUM_NAMESPACE','(((.+)+)+)+$','isVlocityComponent','map','name','extractFieldsFromRecord','130960iHNvAq','username','toString','9327jgeAVx','CRC32__c','445857CHrumW','Last_Modified_Date__c','update','5BWjhLj','Vlocity_Component__c','Component_Name__c','Repository','FLOSUM_COMMIT_MANIFEST','8754dnxTbG','Last_Updated_By__c','Component_Type__c','1393vfZTkL','SalesforceGitSyncService','componentName','Body','274kgzYwy','body','repositoryId','SalesforceComponentsManager','keys','createPatchRequest','Component__c','delete','2064008tXQKeh','FLOSUM_GIT_NAMESPACE','componentId','.id}','Zip','MC_Key__c','Source__c','prepareComponentHistoryRecord','prepareComponentRecord','5147904LqnhiW','componentType','Commit__c','../../../../constants','request','Changed_By__c','proceedComponentMeta','__esModule','logger','file','insert','push','recordTypes',']\x20-\x20meta\x20not\x20found','FLOSUM_COMPONENT','Version__c'];a261_0x205a=function(){return _0x471152;};return a261_0x205a();}var __importDefault=this&&this[a261_0xc5030e(0x1bf)]||function(_0x42a9ec){return _0x42a9ec&&_0x42a9ec['__esModule']?_0x42a9ec:{'default':_0x42a9ec};};function a261_0x21c9(_0x23170b,_0x4abbf3){const _0x439c4d=a261_0x205a();return a261_0x21c9=function(_0x527778,_0xb76890){_0x527778=_0x527778-0x194;let _0x205a99=_0x439c4d[_0x527778];return _0x205a99;},a261_0x21c9(_0x23170b,_0x4abbf3);}Object[a261_0xc5030e(0x1b8)](exports,a261_0xc5030e(0x1f4),{'value':!![]}),exports[a261_0xc5030e(0x1df)]=void 0x0;const constants_1=require(a261_0xc5030e(0x1f0)),core_1=require(a261_0xc5030e(0x1af)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a261_0xc5030e(0x1b3)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a261_0xc5030e(0x1aa));class SalesforceComponentsManager{constructor(_0x39992a,_0x1f1ee4,_0x34f89e,_0x323679,_0x1bed53){const _0x3e16fa=a261_0xc5030e;this[_0x3e16fa(0x1de)]=_0x39992a,this[_0x3e16fa(0x199)]=_0x1f1ee4,this[_0x3e16fa(0x1c9)]=_0x34f89e,this[_0x3e16fa(0x195)]=_0x323679,this['proceededComponentsMeta']=_0x1bed53,this[_0x3e16fa(0x1f5)]=new core_1['Logger'](SalesforceComponentsManager[_0x3e16fa(0x1c6)]),this['gitSync']=typedi_1['default'][_0x3e16fa(0x1bc)](salesforce_git_sync_service_1[_0x3e16fa(0x1d9)]);}[a261_0xc5030e(0x1f3)](_0x2b77e4,_0x1cfab2){const _0x510ced=a261_0xc5030e,_0x3b9e66=(0x0,flosum_naming_utils_1[_0x510ced(0x1c7)])(_0x2b77e4,[_0x510ced(0x1d7),_0x510ced(0x1d2),'Version__c']);this[_0x510ced(0x19c)][_0x510ced(0x194)]({'componentId':'','reference':_0x1cfab2,'version':_0x3b9e66[_0x510ced(0x198)],'componentName':_0x3b9e66['Component_Name__c'],'componentType':_0x3b9e66[_0x510ced(0x1d7)]});}[a261_0xc5030e(0x1ab)](_0x3630cf,_0x2aab70){const _0x532dd4=a261_0xc5030e,{request:_0x1c0c4d}=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x532dd4(0x1d4)],{[constants_1[_0x532dd4(0x1c2)]+_0x532dd4(0x1ef)]:_0x3630cf,[constants_1['FLOSUM_NAMESPACE']+'Component_History__c']:_0x2aab70});return _0x1c0c4d;}async[a261_0xc5030e(0x1a5)](_0x5eec07,_0x3ffe4f){const _0x308637=a261_0xc5030e,_0x5b5998={},_0x5aa33b=zip_1[_0x308637(0x1e8)]['createZip']();for(const _0x15dd7b of Object[_0x308637(0x1e0)](_0x5eec07[_0x308637(0x1a7)])){_0x5aa33b[_0x308637(0x1f6)](_0x15dd7b,_0x5eec07['files'][_0x15dd7b],{'createFolders':!![]});}return _0x5b5998['ContentType']='application/zip',_0x5b5998['Name']=_0x5eec07[_0x308637(0x1b2)],_0x5b5998[_0x308637(0x1b6)]=_0x5eec07['type'],_0x5b5998[_0x308637(0x1ba)]=_0x3ffe4f,_0x5b5998[_0x308637(0x1db)]=await _0x5aa33b['generateAsync']({'type':'base64','compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x5b5998;}[a261_0xc5030e(0x1eb)](_0x1e72a3,_0x565152,_0x1b9606){const _0x522061=a261_0xc5030e,_0xc39e18=new Date()[_0x522061(0x19b)](),_0xc11ea9={};return _0xc11ea9[constants_1['FLOSUM_NAMESPACE']+_0x522061(0x1e2)]=_0x565152,_0xc11ea9[constants_1[_0x522061(0x1c2)]+_0x522061(0x1cc)]=_0x1e72a3[_0x522061(0x1be)],_0xc11ea9[constants_1[_0x522061(0x1c2)]+_0x522061(0x1a9)]=_0xc39e18,_0xc11ea9[constants_1['FLOSUM_NAMESPACE']+_0x522061(0x1f2)]=this[_0x522061(0x1c9)],_0xc11ea9[constants_1[_0x522061(0x1c2)]+_0x522061(0x198)]=_0x1b9606?_0x1b9606+0x1:0x1,_0xc11ea9[constants_1[_0x522061(0x1e5)]+'Is_From_Agent__c']=!![],_0xc11ea9;}[a261_0xc5030e(0x1ec)](_0x33d79e,_0x2bacad){const _0x24176a=a261_0xc5030e;var _0xe834f3,_0x15dde7;const _0x2f6650=new Date()[_0x24176a(0x19b)](),_0x1bb91a={};return!_0x2bacad?(this['branchId']?(_0x1bb91a[constants_1[_0x24176a(0x1c2)]+'Branch__c']=this[_0x24176a(0x199)],_0x1bb91a[constants_1['FLOSUM_NAMESPACE']+_0x24176a(0x1ea)]='Branch',_0x1bb91a[_0x24176a(0x1a4)]=(_0xe834f3=this[_0x24176a(0x195)]['find'](_0x26ccb5=>_0x26ccb5[_0x24176a(0x1c6)]==='Branch'))===null||_0xe834f3===void 0x0?void 0x0:_0xe834f3['id']):(_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x1b7)]=this[_0x24176a(0x1de)],_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x1ea)]=_0x24176a(0x1d3),_0x1bb91a['RecordTypeId']=(_0x15dde7=this[_0x24176a(0x195)][_0x24176a(0x1a8)](_0x672954=>_0x672954['name']===_0x24176a(0x1d3)))===null||_0x15dde7===void 0x0?void 0x0:_0x15dde7['id']),_0x1bb91a[constants_1[_0x24176a(0x1c2)]+'Version__c']=0x1):_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x198)]=_0x2bacad['version']+0x1,_0x1bb91a[constants_1[_0x24176a(0x1c2)]+'Component_Type__c']=_0x33d79e['type'],_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x1d2)]=_0x33d79e[_0x24176a(0x1c6)],_0x1bb91a[constants_1['FLOSUM_NAMESPACE']+_0x24176a(0x1a3)]=_0x33d79e[_0x24176a(0x1b5)],_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x1d6)]=this[_0x24176a(0x1c9)],_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x1ac)]=this[_0x24176a(0x1c9)],_0x1bb91a[constants_1['FLOSUM_NAMESPACE']+_0x24176a(0x1ce)]=_0x2f6650,_0x1bb91a[constants_1[_0x24176a(0x1c2)]+'Committed_On__c']=_0x2f6650,_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x1cc)]=_0x33d79e[_0x24176a(0x1be)],_0x1bb91a[constants_1['FLOSUM_NAMESPACE']+'Vlocity_Component_Name__c']=_0x33d79e['vlocityComponentName'],_0x1bb91a[constants_1['FLOSUM_NAMESPACE']+_0x24176a(0x1d1)]=_0x33d79e[_0x24176a(0x1c4)],_0x1bb91a[constants_1[_0x24176a(0x1c2)]+_0x24176a(0x1e9)]=_0x33d79e[_0x24176a(0x1b9)],_0x1bb91a;}[a261_0xc5030e(0x1bb)](){const _0x92c3b9=a261_0xc5030e;return this[_0x92c3b9(0x19c)];}async[a261_0xc5030e(0x1f7)](_0x5f12e2,_0xa9a0f6){const _0x165327=a261_0xc5030e,_0x592031=[];for(const _0x27e90b of _0x5f12e2){const _0x25e232=(0x0,composite_utils_1[_0x165327(0x19a)])(constants_1[_0x165327(0x197)],this[_0x165327(0x1ec)](_0x27e90b)),_0x57a0ae=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x165327(0x19e)],this[_0x165327(0x1eb)](_0x27e90b,'@{'+_0x25e232['reference']+_0x165327(0x1e7))),_0x59beea=(0x0,composite_utils_1[_0x165327(0x19a)])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x165327(0x1a5)](_0x27e90b,'@{'+_0x57a0ae[_0x165327(0x1b0)]+_0x165327(0x1e7)));this['proceedComponentMeta'](_0x25e232[_0x165327(0x1f1)][_0x165327(0x1dd)],_0x25e232[_0x165327(0x1b0)]),_0x592031['push'](_0x25e232[_0x165327(0x1f1)],_0x57a0ae[_0x165327(0x1f1)],_0x59beea['request']),_0xa9a0f6&&_0x592031[_0x165327(0x194)](this[_0x165327(0x1ab)](_0xa9a0f6,'@{'+_0x57a0ae[_0x165327(0x1b0)]+_0x165327(0x1e7)));}return _0x592031;}async[a261_0xc5030e(0x1cf)](_0x3f556a,_0x1b7ca9=''){const _0x59966b=a261_0xc5030e,_0x276cd1=[];for(const {component:_0x3fbf1a,meta:_0x2c4738}of _0x3f556a){if(!_0x2c4738['id']){const _0x11fb7d=this[_0x59966b(0x19c)][_0x59966b(0x1a8)](_0x55921f=>_0x55921f[_0x59966b(0x1da)]===_0x3fbf1a[_0x59966b(0x1c6)]&&_0x55921f[_0x59966b(0x1ee)]===_0x3fbf1a['type']);if(!_0x11fb7d)throw new salesforce_error_1['SalesforceError'](new Error(_0x59966b(0x1b4)+_0x3fbf1a[_0x59966b(0x1c6)]+'\x20['+_0x3fbf1a['type']+_0x59966b(0x196)));_0x2c4738['id']=_0x11fb7d[_0x59966b(0x1e6)];}const _0x2793b8=(0x0,composite_utils_1[_0x59966b(0x1e1)])(constants_1['FLOSUM_COMPONENT'],_0x2c4738['id'],this[_0x59966b(0x1ec)](_0x3fbf1a,_0x2c4738)),_0x1f1b85=(0x0,composite_utils_1[_0x59966b(0x19a)])(constants_1[_0x59966b(0x19e)],this[_0x59966b(0x1eb)](_0x3fbf1a,_0x2c4738['id'],_0x2c4738[_0x59966b(0x1bd)])),_0x2f4d88=(0x0,composite_utils_1[_0x59966b(0x19a)])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x59966b(0x1a5)](_0x3fbf1a,'@{'+_0x1f1b85[_0x59966b(0x1b0)]+_0x59966b(0x1e7)));this[_0x59966b(0x1f3)](_0x2793b8[_0x59966b(0x1f1)]['body'],_0x2793b8[_0x59966b(0x1b0)]),_0x276cd1[_0x59966b(0x194)](_0x2793b8[_0x59966b(0x1f1)],_0x1f1b85[_0x59966b(0x1f1)],_0x2f4d88['request']),_0x1b7ca9&&_0x276cd1['push'](this[_0x59966b(0x1ab)](_0x1b7ca9,'@{'+_0x1f1b85['reference']+_0x59966b(0x1e7)));}return _0x276cd1;}async[a261_0xc5030e(0x1e3)](_0x41a574,_0x17701d=![]){const _0x511024=a261_0xc5030e,_0x1485db={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x56e8ce=[];for(const _0x40c14f of _0x41a574){if(_0x40c14f['id'])_0x56e8ce[_0x511024(0x194)](_0x40c14f['id']);else{const _0x2e78c9=this[_0x511024(0x19c)][_0x511024(0x1a8)](_0x926984=>_0x926984['componentName']===_0x40c14f[_0x511024(0x1c6)]&&_0x926984[_0x511024(0x1ee)]===_0x40c14f['type']);if(!_0x2e78c9||!_0x2e78c9[_0x511024(0x1e6)])continue;_0x56e8ce[_0x511024(0x194)](_0x2e78c9[_0x511024(0x1e6)]);}}if(_0x17701d){const _0x559b36=await this[_0x511024(0x1c1)][_0x511024(0x19d)](_0x56e8ce);_0x1485db['manifests']=_0x559b36[_0x511024(0x1c5)](_0x4314dd=>(0x0,composite_utils_1[_0x511024(0x1b1)])(constants_1['FLOSUM_COMMIT_MANIFEST'],_0x4314dd)[_0x511024(0x1f1)]);}return _0x1485db[_0x511024(0x19f)]=_0x56e8ce[_0x511024(0x1c5)](_0x318049=>(0x0,composite_utils_1[_0x511024(0x1e1)])(constants_1[_0x511024(0x197)],_0x318049,{[constants_1[_0x511024(0x1e5)]+_0x511024(0x1ae)]:!![]})[_0x511024(0x1f1)]),_0x1485db[_0x511024(0x1a2)]=_0x56e8ce[_0x511024(0x1c5)](_0x6c5553=>(0x0,composite_utils_1[_0x511024(0x1b1)])(constants_1[_0x511024(0x197)],_0x6c5553)['request']),_0x1485db;}}exports[a261_0xc5030e(0x1df)]=SalesforceComponentsManager;