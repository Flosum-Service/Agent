const a234_0x211ff2=a234_0x5e70;(function(_0x7de74e,_0x5507ce){const _0x18135c=a234_0x5e70,_0x595879=_0x7de74e();while(!![]){try{const _0x60624c=-parseInt(_0x18135c(0xcf))/0x1*(parseInt(_0x18135c(0xf1))/0x2)+-parseInt(_0x18135c(0xd6))/0x3+parseInt(_0x18135c(0x12c))/0x4*(parseInt(_0x18135c(0x119))/0x5)+-parseInt(_0x18135c(0x114))/0x6+-parseInt(_0x18135c(0xe0))/0x7*(-parseInt(_0x18135c(0x122))/0x8)+parseInt(_0x18135c(0xc8))/0x9*(parseInt(_0x18135c(0x113))/0xa)+parseInt(_0x18135c(0xd8))/0xb;if(_0x60624c===_0x5507ce)break;else _0x595879['push'](_0x595879['shift']());}catch(_0x4ef19c){_0x595879['push'](_0x595879['shift']());}}}(a234_0xd928,0x25419));const a234_0x334ee7=(function(){let _0x3f97d1=!![];return function(_0x374cb4,_0x2bcc41){const _0x5ae880=_0x3f97d1?function(){const _0x5e8f8e=a234_0x5e70;if(_0x2bcc41){const _0x97e995=_0x2bcc41[_0x5e8f8e(0x102)](_0x374cb4,arguments);return _0x2bcc41=null,_0x97e995;}}:function(){};return _0x3f97d1=![],_0x5ae880;};}()),a234_0x219872=a234_0x334ee7(this,function(){const _0x47a3b3=a234_0x5e70;return a234_0x219872[_0x47a3b3(0xec)]()[_0x47a3b3(0xf4)]('(((.+)+)+)+$')[_0x47a3b3(0xec)]()[_0x47a3b3(0x12f)](a234_0x219872)[_0x47a3b3(0xf4)](_0x47a3b3(0xdf));});function a234_0xd928(){const _0x3f27ec=['176964idqQEW','SalesforceError','keys','search','name','FLOSUM_NAMESPACE','getProceededComponentsMeta','FLOSUM_COMMIT_MANIFEST','manifests','prepareComponentAttachmentRecord','application/zip','reference','base64','insert','Changed_On__c','__esModule','../../../../core','apply','../../parsers/utils/zip','DEFLATE','../utils/composite.utils','Last_Modified_By__c','Is_From_Agent__c','generateAsync','Name','RecordTypeId','Could\x20not\x20proceed\x20component\x20','Description','componentId','defineProperty','get','SalesforceComponentsManager','filePath','componentsToUpdate','1350310RFCBWu','302718ZmKkhO','.id}','./salesforce-git-sync.service','ContentType','__importDefault','378735hTAXLi','type','username','toISOString','Vlocity_Component__c','prepareComponentRecord','ParentId','gitSync','crc','1273816BXkStJ','Vlocity_Component_Name__c','Body','FLOSUM_ATTACHMENT','../errors/salesforce.error','version','createDeleteRequest','push','Last_Updated_By__c','body','8rHbcnP','fetchCommitManifestsByComponentIds','createPatchRequest','constructor','proceededComponentsMeta','Repository__c','9qCtHAE','isVlocityComponent','file','prepareComponentHistoryRecord','Commit__c','Component_Type__c','createZip','1qKNTyi','Component_History__c','CRC32__c','Last_Modified_Date__c','default','logger','Version__c','765048djSuvf','FLOSUM_COMPONENT_HISTORY','1108800YsytQZ','prepareCommitManifest','recordTypes','Branch','componentsToDelete','Source__c','map','(((.+)+)+)+$','7CTGTya','repositoryId','createPostRequest','Logger','find','FLOSUM_GIT_NAMESPACE','files','componentName','delete','Repository','Committed_On__c','branchId','toString','request','componentType','Component_Name__c','vlocityComponentName'];a234_0xd928=function(){return _0x3f27ec;};return a234_0xd928();}a234_0x219872();function a234_0x5e70(_0x38b3e8,_0x1fd72d){const _0x2afd08=a234_0xd928();return a234_0x5e70=function(_0x219872,_0x334ee7){_0x219872=_0x219872-0xc8;let _0xd9284f=_0x2afd08[_0x219872];return _0xd9284f;},a234_0x5e70(_0x38b3e8,_0x1fd72d);}'use strict';var __importDefault=this&&this[a234_0x211ff2(0x118)]||function(_0x4a306a){const _0x43c05d=a234_0x211ff2;return _0x4a306a&&_0x4a306a[_0x43c05d(0x100)]?_0x4a306a:{'default':_0x4a306a};};Object[a234_0x211ff2(0x10e)](exports,'__esModule',{'value':!![]}),exports[a234_0x211ff2(0x110)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a234_0x211ff2(0x101)),zip_1=require(a234_0x211ff2(0x103)),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a234_0x211ff2(0x126)),composite_utils_1=require(a234_0x211ff2(0x105)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a234_0x211ff2(0x116));class SalesforceComponentsManager{constructor(_0x1e47b9,_0xb035fd,_0x49e44b,_0x161b75,_0x4e6d73){const _0x36d952=a234_0x211ff2;this['repositoryId']=_0x1e47b9,this[_0x36d952(0xeb)]=_0xb035fd,this[_0x36d952(0x11b)]=_0x49e44b,this[_0x36d952(0xda)]=_0x161b75,this[_0x36d952(0x130)]=_0x4e6d73,this[_0x36d952(0xd4)]=new core_1[(_0x36d952(0xe3))](SalesforceComponentsManager[_0x36d952(0xf5)]),this[_0x36d952(0x120)]=typedi_1[_0x36d952(0xd3)][_0x36d952(0x10f)](salesforce_git_sync_service_1['SalesforceGitSyncService']);}['proceedComponentMeta'](_0x632b2d,_0x453d4f){const _0x37ec35=a234_0x211ff2,_0x131e7d=(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x632b2d,[_0x37ec35(0xcd),'Component_Name__c',_0x37ec35(0xd5)]);this[_0x37ec35(0x130)][_0x37ec35(0x129)]({'componentId':'','reference':_0x453d4f,'version':_0x131e7d[_0x37ec35(0xd5)],'componentName':_0x131e7d[_0x37ec35(0xef)],'componentType':_0x131e7d[_0x37ec35(0xcd)]});}[a234_0x211ff2(0xd9)](_0x20acf7,_0x1d511b){const _0x359557=a234_0x211ff2,{request:_0x5a50b1}=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1[_0x359557(0xf6)]+_0x359557(0xcc)]:_0x20acf7,[constants_1['FLOSUM_NAMESPACE']+_0x359557(0xd0)]:_0x1d511b});return _0x5a50b1;}async[a234_0x211ff2(0xfa)](_0x103b78,_0x4375de){const _0x5e94b8=a234_0x211ff2,_0x1f49e4={},_0x28d411=zip_1['Zip'][_0x5e94b8(0xce)]();for(const _0x21a64c of Object[_0x5e94b8(0xf3)](_0x103b78[_0x5e94b8(0xe6)])){_0x28d411[_0x5e94b8(0xca)](_0x21a64c,_0x103b78[_0x5e94b8(0xe6)][_0x21a64c],{'createFolders':!![]});}return _0x1f49e4[_0x5e94b8(0x117)]=_0x5e94b8(0xfb),_0x1f49e4[_0x5e94b8(0x109)]=_0x103b78[_0x5e94b8(0x11a)],_0x1f49e4[_0x5e94b8(0x10c)]=_0x103b78[_0x5e94b8(0x11a)],_0x1f49e4[_0x5e94b8(0x11f)]=_0x4375de,_0x1f49e4[_0x5e94b8(0x124)]=await _0x28d411[_0x5e94b8(0x108)]({'type':_0x5e94b8(0xfd),'compression':_0x5e94b8(0x104),'compressionOptions':{'level':0x6}}),_0x1f49e4;}[a234_0x211ff2(0xcb)](_0x31af6a,_0x32745c,_0x417ca4){const _0xc9b202=a234_0x211ff2,_0x273425=new Date()[_0xc9b202(0x11c)](),_0x3728af={};return _0x3728af[constants_1[_0xc9b202(0xf6)]+'Component__c']=_0x32745c,_0x3728af[constants_1[_0xc9b202(0xf6)]+_0xc9b202(0xd1)]=_0x31af6a[_0xc9b202(0x121)],_0x3728af[constants_1[_0xc9b202(0xf6)]+_0xc9b202(0xff)]=_0x273425,_0x3728af[constants_1[_0xc9b202(0xf6)]+'Changed_By__c']=this[_0xc9b202(0x11b)],_0x3728af[constants_1[_0xc9b202(0xf6)]+_0xc9b202(0xd5)]=_0x417ca4?_0x417ca4+0x1:0x1,_0x3728af[constants_1[_0xc9b202(0xe5)]+_0xc9b202(0x107)]=!![],_0x3728af;}['prepareComponentRecord'](_0x3a65d0,_0x20c796){const _0x49719b=a234_0x211ff2;var _0x173f2a,_0x3e518d;const _0x7e0e7d=new Date()[_0x49719b(0x11c)](),_0x13b42c={};return!_0x20c796?(this[_0x49719b(0xeb)]?(_0x13b42c[constants_1[_0x49719b(0xf6)]+'Branch__c']=this['branchId'],_0x13b42c[constants_1[_0x49719b(0xf6)]+_0x49719b(0xdd)]=_0x49719b(0xdb),_0x13b42c[_0x49719b(0x10a)]=(_0x173f2a=this[_0x49719b(0xda)][_0x49719b(0xe4)](_0x465ac4=>_0x465ac4['name']==='Branch'))===null||_0x173f2a===void 0x0?void 0x0:_0x173f2a['id']):(_0x13b42c[constants_1['FLOSUM_NAMESPACE']+_0x49719b(0x131)]=this[_0x49719b(0xe1)],_0x13b42c[constants_1['FLOSUM_NAMESPACE']+_0x49719b(0xdd)]=_0x49719b(0xe9),_0x13b42c[_0x49719b(0x10a)]=(_0x3e518d=this[_0x49719b(0xda)]['find'](_0x8d6498=>_0x8d6498[_0x49719b(0xf5)]===_0x49719b(0xe9)))===null||_0x3e518d===void 0x0?void 0x0:_0x3e518d['id']),_0x13b42c[constants_1['FLOSUM_NAMESPACE']+_0x49719b(0xd5)]=0x1):_0x13b42c[constants_1[_0x49719b(0xf6)]+'Version__c']=_0x20c796[_0x49719b(0x127)]+0x1,_0x13b42c[constants_1[_0x49719b(0xf6)]+_0x49719b(0xcd)]=_0x3a65d0['type'],_0x13b42c[constants_1['FLOSUM_NAMESPACE']+_0x49719b(0xef)]=_0x3a65d0[_0x49719b(0xf5)],_0x13b42c[constants_1['FLOSUM_NAMESPACE']+'File_Name__c']=_0x3a65d0[_0x49719b(0x111)],_0x13b42c[constants_1[_0x49719b(0xf6)]+_0x49719b(0x12a)]=this[_0x49719b(0x11b)],_0x13b42c[constants_1[_0x49719b(0xf6)]+_0x49719b(0x106)]=this[_0x49719b(0x11b)],_0x13b42c[constants_1[_0x49719b(0xf6)]+_0x49719b(0xd2)]=_0x7e0e7d,_0x13b42c[constants_1['FLOSUM_NAMESPACE']+_0x49719b(0xea)]=_0x7e0e7d,_0x13b42c[constants_1[_0x49719b(0xf6)]+_0x49719b(0xd1)]=_0x3a65d0[_0x49719b(0x121)],_0x13b42c[constants_1[_0x49719b(0xf6)]+_0x49719b(0x123)]=_0x3a65d0[_0x49719b(0xf0)],_0x13b42c[constants_1['FLOSUM_NAMESPACE']+_0x49719b(0x11d)]=_0x3a65d0[_0x49719b(0xc9)],_0x13b42c;}[a234_0x211ff2(0xf7)](){const _0x3ffd80=a234_0x211ff2;return this[_0x3ffd80(0x130)];}async[a234_0x211ff2(0xfe)](_0x5ae4eb,_0x697fee){const _0x4be157=a234_0x211ff2,_0x5ec383=[];for(const _0x3f425d of _0x5ae4eb){const _0x1315fa=(0x0,composite_utils_1[_0x4be157(0xe2)])(constants_1['FLOSUM_COMPONENT'],this[_0x4be157(0x11e)](_0x3f425d)),_0x25da37=(0x0,composite_utils_1[_0x4be157(0xe2)])(constants_1[_0x4be157(0xd7)],this[_0x4be157(0xcb)](_0x3f425d,'@{'+_0x1315fa[_0x4be157(0xfc)]+_0x4be157(0x115))),_0x2a1e3a=(0x0,composite_utils_1[_0x4be157(0xe2)])(constants_1[_0x4be157(0x125)],await this[_0x4be157(0xfa)](_0x3f425d,'@{'+_0x25da37[_0x4be157(0xfc)]+'.id}'));this['proceedComponentMeta'](_0x1315fa[_0x4be157(0xed)][_0x4be157(0x12b)],_0x1315fa[_0x4be157(0xfc)]),_0x5ec383[_0x4be157(0x129)](_0x1315fa[_0x4be157(0xed)],_0x25da37[_0x4be157(0xed)],_0x2a1e3a['request']),_0x697fee&&_0x5ec383[_0x4be157(0x129)](this['prepareCommitManifest'](_0x697fee,'@{'+_0x25da37['reference']+'.id}'));}return _0x5ec383;}async['update'](_0x5c86a3,_0x353943=''){const _0x22539e=a234_0x211ff2,_0x237bcc=[];for(const {component:_0x409f21,meta:_0x178d58}of _0x5c86a3){if(!_0x178d58['id']){const _0x47c61a=this[_0x22539e(0x130)][_0x22539e(0xe4)](_0x3a5860=>_0x3a5860[_0x22539e(0xe7)]===_0x409f21[_0x22539e(0xf5)]&&_0x3a5860[_0x22539e(0xee)]===_0x409f21['type']);if(!_0x47c61a)throw new salesforce_error_1[(_0x22539e(0xf2))](new Error(_0x22539e(0x10b)+_0x409f21['name']+'\x20['+_0x409f21[_0x22539e(0x11a)]+']\x20-\x20meta\x20not\x20found'));_0x178d58['id']=_0x47c61a[_0x22539e(0x10d)];}const _0x430166=(0x0,composite_utils_1[_0x22539e(0x12e)])(constants_1['FLOSUM_COMPONENT'],_0x178d58['id'],this[_0x22539e(0x11e)](_0x409f21,_0x178d58)),_0x1834de=(0x0,composite_utils_1[_0x22539e(0xe2)])(constants_1[_0x22539e(0xd7)],this[_0x22539e(0xcb)](_0x409f21,_0x178d58['id'],_0x178d58[_0x22539e(0x127)])),_0x3e7c36=(0x0,composite_utils_1[_0x22539e(0xe2)])(constants_1[_0x22539e(0x125)],await this[_0x22539e(0xfa)](_0x409f21,'@{'+_0x1834de['reference']+_0x22539e(0x115)));this['proceedComponentMeta'](_0x430166[_0x22539e(0xed)][_0x22539e(0x12b)],_0x430166[_0x22539e(0xfc)]),_0x237bcc[_0x22539e(0x129)](_0x430166[_0x22539e(0xed)],_0x1834de['request'],_0x3e7c36[_0x22539e(0xed)]),_0x353943&&_0x237bcc[_0x22539e(0x129)](this[_0x22539e(0xd9)](_0x353943,'@{'+_0x1834de[_0x22539e(0xfc)]+'.id}'));}return _0x237bcc;}async[a234_0x211ff2(0xe8)](_0x10c59d,_0x459171=![]){const _0x27e60f=a234_0x211ff2,_0x1ffcc9={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x3af13e=[];for(const _0x27928f of _0x10c59d){if(_0x27928f['id'])_0x3af13e['push'](_0x27928f['id']);else{const _0x5c43f0=this[_0x27e60f(0x130)][_0x27e60f(0xe4)](_0x59acc2=>_0x59acc2[_0x27e60f(0xe7)]===_0x27928f[_0x27e60f(0xf5)]&&_0x59acc2[_0x27e60f(0xee)]===_0x27928f['type']);if(!_0x5c43f0||!_0x5c43f0[_0x27e60f(0x10d)])continue;_0x3af13e[_0x27e60f(0x129)](_0x5c43f0[_0x27e60f(0x10d)]);}}if(_0x459171){const _0x1daf49=await this['gitSync'][_0x27e60f(0x12d)](_0x3af13e);_0x1ffcc9[_0x27e60f(0xf9)]=_0x1daf49[_0x27e60f(0xde)](_0x554ef7=>(0x0,composite_utils_1[_0x27e60f(0x128)])(constants_1[_0x27e60f(0xf8)],_0x554ef7)['request']);}return _0x1ffcc9[_0x27e60f(0x112)]=_0x3af13e['map'](_0x57f0a2=>(0x0,composite_utils_1[_0x27e60f(0x12e)])(constants_1['FLOSUM_COMPONENT'],_0x57f0a2,{[constants_1[_0x27e60f(0xe5)]+'Deletion_By_Agent__c']:!![]})['request']),_0x1ffcc9[_0x27e60f(0xdc)]=_0x3af13e[_0x27e60f(0xde)](_0x49ceaa=>(0x0,composite_utils_1[_0x27e60f(0x128)])(constants_1['FLOSUM_COMPONENT'],_0x49ceaa)[_0x27e60f(0xed)]),_0x1ffcc9;}}exports[a234_0x211ff2(0x110)]=SalesforceComponentsManager;