const a195_0x19e483=a195_0x4bb6;function a195_0x5d38(){const _0x230a5f=['createPatchRequest','crc','../utils/composite.utils','name','FLOSUM_ATTACHMENT','Version__c','ContentType',']\x20-\x20meta\x20not\x20found','recordTypes','find','getProceededComponentsMeta','gitSync','toString','2uzihTt','RecordTypeId','Branch','componentsToUpdate','Component__c','search','repositoryId','SalesforceGitSyncService','118613nMJmWH','7040473PlEIgG','ParentId','890469OnGWFt','reference','push','generateAsync','.id}','insert','prepareCommitManifest','defineProperty','default','request','Repository','Component_Name__c','map','FLOSUM_COMPONENT','version','Last_Modified_Date__c','FLOSUM_COMMIT_MANIFEST','Name','application/zip','componentsToDelete','prepareComponentRecord','__esModule','30PRXKdo','prepareComponentAttachmentRecord','Component_Type__c','constructor','apply','componentType','keys','extractFieldsFromRecord','file','componentName','Changed_On__c','../utils/flosum-naming.utils','__importDefault','(((.+)+)+)+$','prepareComponentHistoryRecord','1816NxbCyZ','Repository__c','628708hPrnvN','../errors/salesforce.error','createDeleteRequest','username','./salesforce-git-sync.service','5411LyvigQ','Logger','FLOSUM_GIT_NAMESPACE','../../parsers/utils/zip','typedi','componentId','fetchCommitManifestsByComponentIds','CRC32__c','FLOSUM_COMPONENT_HISTORY','toISOString','base64','filePath','Last_Updated_By__c','body','5BMsLza','type','createZip','12KovswW','DEFLATE','proceededComponentsMeta','FLOSUM_NAMESPACE','Branch__c','files','proceedComponentMeta','logger','update','209934METbUB','Source__c','createPostRequest','../../../../constants','822477SIChLy','branchId','SalesforceComponentsManager','Description','File_Name__c','Could\x20not\x20proceed\x20component\x20'];a195_0x5d38=function(){return _0x230a5f;};return a195_0x5d38();}(function(_0x2680d1,_0x56dbdf){const _0x3bc9bb=a195_0x4bb6,_0x41ccc5=_0x2680d1();while(!![]){try{const _0x312edf=parseInt(_0x3bc9bb(0x115))/0x1+parseInt(_0x3bc9bb(0x10d))/0x2*(-parseInt(_0x3bc9bb(0x162))/0x3)+parseInt(_0x3bc9bb(0x13f))/0x4*(-parseInt(_0x3bc9bb(0x152))/0x5)+-parseInt(_0x3bc9bb(0x15e))/0x6+parseInt(_0x3bc9bb(0x144))/0x7*(parseInt(_0x3bc9bb(0x13d))/0x8)+-parseInt(_0x3bc9bb(0x118))/0x9*(parseInt(_0x3bc9bb(0x12e))/0xa)+-parseInt(_0x3bc9bb(0x116))/0xb*(-parseInt(_0x3bc9bb(0x155))/0xc);if(_0x312edf===_0x56dbdf)break;else _0x41ccc5['push'](_0x41ccc5['shift']());}catch(_0x6a4145){_0x41ccc5['push'](_0x41ccc5['shift']());}}}(a195_0x5d38,0x29be3));const a195_0x366f8b=(function(){let _0x305bc0=!![];return function(_0x235dd6,_0x4fdacb){const _0xdf639d=_0x305bc0?function(){const _0x336925=a195_0x4bb6;if(_0x4fdacb){const _0x12404f=_0x4fdacb[_0x336925(0x132)](_0x235dd6,arguments);return _0x4fdacb=null,_0x12404f;}}:function(){};return _0x305bc0=![],_0xdf639d;};}()),a195_0x519f96=a195_0x366f8b(this,function(){const _0x46707f=a195_0x4bb6;return a195_0x519f96[_0x46707f(0x10c)]()[_0x46707f(0x112)](_0x46707f(0x13b))[_0x46707f(0x10c)]()[_0x46707f(0x131)](a195_0x519f96)[_0x46707f(0x112)]('(((.+)+)+)+$');});a195_0x519f96();'use strict';var __importDefault=this&&this[a195_0x19e483(0x13a)]||function(_0x5803fa){const _0xbcc31=a195_0x19e483;return _0x5803fa&&_0x5803fa[_0xbcc31(0x12d)]?_0x5803fa:{'default':_0x5803fa};};Object[a195_0x19e483(0x11f)](exports,a195_0x19e483(0x12d),{'value':!![]}),exports[a195_0x19e483(0x164)]=void 0x0;function a195_0x4bb6(_0x136eec,_0x850b5a){const _0x3eeff8=a195_0x5d38();return a195_0x4bb6=function(_0x519f96,_0x366f8b){_0x519f96=_0x519f96-0x10c;let _0x5d3881=_0x3eeff8[_0x519f96];return _0x5d3881;},a195_0x4bb6(_0x136eec,_0x850b5a);}const constants_1=require(a195_0x19e483(0x161)),core_1=require('../../../../core'),zip_1=require(a195_0x19e483(0x147)),typedi_1=__importDefault(require(a195_0x19e483(0x148))),salesforce_error_1=require(a195_0x19e483(0x140)),composite_utils_1=require(a195_0x19e483(0x16a)),flosum_naming_utils_1=require(a195_0x19e483(0x139)),salesforce_git_sync_service_1=require(a195_0x19e483(0x143));class SalesforceComponentsManager{constructor(_0xd8164a,_0x5ae811,_0x2979a3,_0x4887c7,_0x4b72e9){const _0x1c823a=a195_0x19e483;this[_0x1c823a(0x113)]=_0xd8164a,this[_0x1c823a(0x163)]=_0x5ae811,this[_0x1c823a(0x142)]=_0x2979a3,this[_0x1c823a(0x170)]=_0x4887c7,this[_0x1c823a(0x157)]=_0x4b72e9,this[_0x1c823a(0x15c)]=new core_1[(_0x1c823a(0x145))](SalesforceComponentsManager[_0x1c823a(0x16b)]),this[_0x1c823a(0x173)]=typedi_1[_0x1c823a(0x120)]['get'](salesforce_git_sync_service_1[_0x1c823a(0x114)]);}[a195_0x19e483(0x15b)](_0x53fdd6,_0x73eb77){const _0x458e83=a195_0x19e483,_0x25308d=(0x0,flosum_naming_utils_1[_0x458e83(0x135)])(_0x53fdd6,[_0x458e83(0x130),'Component_Name__c',_0x458e83(0x16d)]);this[_0x458e83(0x157)][_0x458e83(0x11a)]({'componentId':'','reference':_0x73eb77,'version':_0x25308d['Version__c'],'componentName':_0x25308d['Component_Name__c'],'componentType':_0x25308d[_0x458e83(0x130)]});}[a195_0x19e483(0x11e)](_0x5cb682,_0x2e682f){const _0x17afd4=a195_0x19e483,{request:_0x4a2a19}=(0x0,composite_utils_1[_0x17afd4(0x160)])(constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1[_0x17afd4(0x158)]+'Commit__c']:_0x5cb682,[constants_1[_0x17afd4(0x158)]+'Component_History__c']:_0x2e682f});return _0x4a2a19;}async[a195_0x19e483(0x12f)](_0x30f774,_0x5e80d6){const _0x2dbb4f=a195_0x19e483,_0x5607ff={},_0x4d74f8=zip_1['Zip'][_0x2dbb4f(0x154)]();for(const _0xa8d733 of Object[_0x2dbb4f(0x134)](_0x30f774[_0x2dbb4f(0x15a)])){_0x4d74f8[_0x2dbb4f(0x136)](_0xa8d733,_0x30f774[_0x2dbb4f(0x15a)][_0xa8d733],{'createFolders':!![]});}return _0x5607ff[_0x2dbb4f(0x16e)]=_0x2dbb4f(0x12a),_0x5607ff[_0x2dbb4f(0x129)]=_0x30f774[_0x2dbb4f(0x153)],_0x5607ff[_0x2dbb4f(0x165)]=_0x30f774[_0x2dbb4f(0x153)],_0x5607ff[_0x2dbb4f(0x117)]=_0x5e80d6,_0x5607ff['Body']=await _0x4d74f8[_0x2dbb4f(0x11b)]({'type':_0x2dbb4f(0x14e),'compression':_0x2dbb4f(0x156),'compressionOptions':{'level':0x6}}),_0x5607ff;}[a195_0x19e483(0x13c)](_0x128736,_0x19b4e3,_0x415013){const _0x47aa3a=a195_0x19e483,_0x1192e8=new Date()[_0x47aa3a(0x14d)](),_0x31818d={};return _0x31818d[constants_1[_0x47aa3a(0x158)]+_0x47aa3a(0x111)]=_0x19b4e3,_0x31818d[constants_1[_0x47aa3a(0x158)]+_0x47aa3a(0x14b)]=_0x128736[_0x47aa3a(0x169)],_0x31818d[constants_1['FLOSUM_NAMESPACE']+_0x47aa3a(0x138)]=_0x1192e8,_0x31818d[constants_1[_0x47aa3a(0x158)]+'Changed_By__c']=this['username'],_0x31818d[constants_1[_0x47aa3a(0x158)]+'Version__c']=_0x415013?_0x415013+0x1:0x1,_0x31818d[constants_1[_0x47aa3a(0x146)]+'Is_From_Agent__c']=!![],_0x31818d;}[a195_0x19e483(0x12c)](_0x4cce7a,_0x1eca58){const _0x13aa14=a195_0x19e483;var _0x34f114,_0x4e0178;const _0x532c53=new Date()[_0x13aa14(0x14d)](),_0x44196a={};return!_0x1eca58?(this[_0x13aa14(0x163)]?(_0x44196a[constants_1['FLOSUM_NAMESPACE']+_0x13aa14(0x159)]=this[_0x13aa14(0x163)],_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x15f)]=_0x13aa14(0x10f),_0x44196a[_0x13aa14(0x10e)]=(_0x34f114=this['recordTypes'][_0x13aa14(0x171)](_0x35ece2=>_0x35ece2[_0x13aa14(0x16b)]===_0x13aa14(0x10f)))===null||_0x34f114===void 0x0?void 0x0:_0x34f114['id']):(_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x13e)]=this[_0x13aa14(0x113)],_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x15f)]=_0x13aa14(0x122),_0x44196a[_0x13aa14(0x10e)]=(_0x4e0178=this['recordTypes']['find'](_0x13a652=>_0x13a652['name']===_0x13aa14(0x122)))===null||_0x4e0178===void 0x0?void 0x0:_0x4e0178['id']),_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x16d)]=0x1):_0x44196a[constants_1[_0x13aa14(0x158)]+'Version__c']=_0x1eca58['version']+0x1,_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x130)]=_0x4cce7a[_0x13aa14(0x153)],_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x123)]=_0x4cce7a[_0x13aa14(0x16b)],_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x166)]=_0x4cce7a[_0x13aa14(0x14f)],_0x44196a[constants_1['FLOSUM_NAMESPACE']+_0x13aa14(0x150)]=this['username'],_0x44196a[constants_1[_0x13aa14(0x158)]+'Last_Modified_By__c']=this[_0x13aa14(0x142)],_0x44196a[constants_1['FLOSUM_NAMESPACE']+_0x13aa14(0x127)]=_0x532c53,_0x44196a[constants_1[_0x13aa14(0x158)]+'Committed_On__c']=_0x532c53,_0x44196a[constants_1[_0x13aa14(0x158)]+_0x13aa14(0x14b)]=_0x4cce7a['crc'],_0x44196a;}[a195_0x19e483(0x172)](){const _0x2141cd=a195_0x19e483;return this[_0x2141cd(0x157)];}async[a195_0x19e483(0x11d)](_0x5cc510,_0x438308){const _0x142713=a195_0x19e483,_0x381ff8=[];for(const _0x278fb7 of _0x5cc510){const _0x30eb47=(0x0,composite_utils_1[_0x142713(0x160)])(constants_1[_0x142713(0x125)],this[_0x142713(0x12c)](_0x278fb7)),_0x371a6f=(0x0,composite_utils_1[_0x142713(0x160)])(constants_1[_0x142713(0x14c)],this[_0x142713(0x13c)](_0x278fb7,'@{'+_0x30eb47[_0x142713(0x119)]+_0x142713(0x11c))),_0x398205=(0x0,composite_utils_1[_0x142713(0x160)])(constants_1[_0x142713(0x16c)],await this[_0x142713(0x12f)](_0x278fb7,'@{'+_0x371a6f['reference']+_0x142713(0x11c)));this[_0x142713(0x15b)](_0x30eb47[_0x142713(0x121)][_0x142713(0x151)],_0x30eb47['reference']),_0x381ff8[_0x142713(0x11a)](_0x30eb47[_0x142713(0x121)],_0x371a6f[_0x142713(0x121)],_0x398205[_0x142713(0x121)]),_0x438308&&_0x381ff8[_0x142713(0x11a)](this['prepareCommitManifest'](_0x438308,'@{'+_0x371a6f[_0x142713(0x119)]+_0x142713(0x11c)));}return _0x381ff8;}async[a195_0x19e483(0x15d)](_0x217790,_0x2d133c=''){const _0x219814=a195_0x19e483,_0x225994=[];for(const {component:_0x3dc300,meta:_0x353718}of _0x217790){if(!_0x353718['id']){const _0x1351f9=this['proceededComponentsMeta'][_0x219814(0x171)](_0xdbc92b=>_0xdbc92b[_0x219814(0x137)]===_0x3dc300[_0x219814(0x16b)]&&_0xdbc92b[_0x219814(0x133)]===_0x3dc300[_0x219814(0x153)]);if(!_0x1351f9)throw new salesforce_error_1['SalesforceError'](new Error(_0x219814(0x167)+_0x3dc300[_0x219814(0x16b)]+'\x20['+_0x3dc300[_0x219814(0x153)]+_0x219814(0x16f)));_0x353718['id']=_0x1351f9[_0x219814(0x149)];}const _0x3df4f9=(0x0,composite_utils_1['createPatchRequest'])(constants_1['FLOSUM_COMPONENT'],_0x353718['id'],this[_0x219814(0x12c)](_0x3dc300,_0x353718)),_0x6b6c70=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x219814(0x14c)],this[_0x219814(0x13c)](_0x3dc300,_0x353718['id'],_0x353718[_0x219814(0x126)])),_0x16a90e=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x219814(0x12f)](_0x3dc300,'@{'+_0x6b6c70[_0x219814(0x119)]+'.id}'));this[_0x219814(0x15b)](_0x3df4f9['request'][_0x219814(0x151)],_0x3df4f9['reference']),_0x225994[_0x219814(0x11a)](_0x3df4f9[_0x219814(0x121)],_0x6b6c70[_0x219814(0x121)],_0x16a90e[_0x219814(0x121)]),_0x2d133c&&_0x225994[_0x219814(0x11a)](this[_0x219814(0x11e)](_0x2d133c,'@{'+_0x6b6c70[_0x219814(0x119)]+_0x219814(0x11c)));}return _0x225994;}async['delete'](_0x58d931,_0x5cc341=![]){const _0x2d292c=a195_0x19e483,_0x1b229d={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x5950d7=[];for(const _0x4415b7 of _0x58d931){if(_0x4415b7['id'])_0x5950d7[_0x2d292c(0x11a)](_0x4415b7['id']);else{const _0x494272=this['proceededComponentsMeta'][_0x2d292c(0x171)](_0x2edd7c=>_0x2edd7c[_0x2d292c(0x137)]===_0x4415b7['name']&&_0x2edd7c[_0x2d292c(0x133)]===_0x4415b7['type']);if(!_0x494272||!_0x494272[_0x2d292c(0x149)])continue;_0x5950d7['push'](_0x494272['componentId']);}}if(_0x5cc341){const _0x5c3444=await this[_0x2d292c(0x173)][_0x2d292c(0x14a)](_0x5950d7);_0x1b229d['manifests']=_0x5c3444[_0x2d292c(0x124)](_0x4d83bf=>(0x0,composite_utils_1[_0x2d292c(0x141)])(constants_1[_0x2d292c(0x128)],_0x4d83bf)[_0x2d292c(0x121)]);}return _0x1b229d[_0x2d292c(0x110)]=_0x5950d7[_0x2d292c(0x124)](_0x2144be=>(0x0,composite_utils_1[_0x2d292c(0x168)])(constants_1[_0x2d292c(0x125)],_0x2144be,{[constants_1[_0x2d292c(0x146)]+'Deletion_By_Agent__c']:!![]})['request']),_0x1b229d[_0x2d292c(0x12b)]=_0x5950d7[_0x2d292c(0x124)](_0x456331=>(0x0,composite_utils_1[_0x2d292c(0x141)])(constants_1['FLOSUM_COMPONENT'],_0x456331)[_0x2d292c(0x121)]),_0x1b229d;}}exports[a195_0x19e483(0x164)]=SalesforceComponentsManager;