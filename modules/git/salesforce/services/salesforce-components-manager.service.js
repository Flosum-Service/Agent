const a234_0x1477a0=a234_0x24fc;(function(_0x13baa9,_0x178f38){const _0x4dc717=a234_0x24fc,_0x523474=_0x13baa9();while(!![]){try{const _0x825691=parseInt(_0x4dc717(0xa6))/0x1*(parseInt(_0x4dc717(0xa2))/0x2)+-parseInt(_0x4dc717(0xc0))/0x3*(-parseInt(_0x4dc717(0xb8))/0x4)+parseInt(_0x4dc717(0xb5))/0x5*(-parseInt(_0x4dc717(0xaa))/0x6)+parseInt(_0x4dc717(0xf8))/0x7+-parseInt(_0x4dc717(0xbb))/0x8*(parseInt(_0x4dc717(0xd7))/0x9)+-parseInt(_0x4dc717(0xfb))/0xa+parseInt(_0x4dc717(0xae))/0xb;if(_0x825691===_0x178f38)break;else _0x523474['push'](_0x523474['shift']());}catch(_0xf9126b){_0x523474['push'](_0x523474['shift']());}}}(a234_0x1901,0xc228e));const a234_0x1862be=(function(){let _0x3e1a15=!![];return function(_0x53582b,_0x3cba32){const _0x20a0ee=_0x3e1a15?function(){const _0x2c0e97=a234_0x24fc;if(_0x3cba32){const _0x1a098b=_0x3cba32[_0x2c0e97(0xb0)](_0x53582b,arguments);return _0x3cba32=null,_0x1a098b;}}:function(){};return _0x3e1a15=![],_0x20a0ee;};}()),a234_0x1f9868=a234_0x1862be(this,function(){const _0x3a3fdc=a234_0x24fc;return a234_0x1f9868[_0x3a3fdc(0xf4)]()[_0x3a3fdc(0xa0)](_0x3a3fdc(0xf9))['toString']()['constructor'](a234_0x1f9868)[_0x3a3fdc(0xa0)]('(((.+)+)+)+$');});function a234_0x1901(){const _0xc7f4b=['898074bROrss','../../../../constants','prepareComponentRecord','toISOString','9260097ERxSue','proceededComponentsMeta','apply','repositoryId','application/zip','FLOSUM_COMMIT_MANIFEST','Description','30lcMJJZ','fetchCommitManifestsByComponentIds','componentName','4oVaIvf','map','prepareComponentAttachmentRecord','80deJNsa','name','default','base64','Source__c','3418485vvFWCQ','extractFieldsFromRecord','Repository__c','.id}','prepareCommitManifest','Changed_On__c','componentType','RecordTypeId','SalesforceGitSyncService','version','Version__c','SalesforceComponentsManager','find','createDeleteRequest','CRC32__c','FLOSUM_ATTACHMENT','Last_Modified_Date__c','update','insert','generateAsync','defineProperty','Is_From_Agent__c','__esModule','117450gGplWf','Last_Updated_By__c','reference','push','branchId','createPostRequest','FLOSUM_GIT_NAMESPACE','FLOSUM_COMPONENT_HISTORY','Component_Type__c','Changed_By__c','prepareComponentHistoryRecord','./salesforce-git-sync.service','proceedComponentMeta','Name','../../parsers/utils/zip','Commit__c','body','crc','recordTypes','SalesforceError','FLOSUM_NAMESPACE','ContentType','Could\x20not\x20proceed\x20component\x20','files','delete','logger','username','DEFLATE','File_Name__c','toString','Zip','componentId','FLOSUM_COMPONENT','815157csAUSZ','(((.+)+)+)+$','Body','14889050YqOntZ','Component_Name__c','componentsToUpdate','isVlocityComponent','Committed_On__c','../errors/salesforce.error','gitSync','createPatchRequest','Branch__c','Vlocity_Component__c','search',']\x20-\x20meta\x20not\x20found','58SntCgc','componentsToDelete','Last_Modified_By__c','Branch','41896QHXoFC','request','type','manifests'];a234_0x1901=function(){return _0xc7f4b;};return a234_0x1901();}a234_0x1f9868();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x149751){return _0x149751&&_0x149751['__esModule']?_0x149751:{'default':_0x149751};};Object[a234_0x1477a0(0xd4)](exports,a234_0x1477a0(0xd6),{'value':!![]}),exports[a234_0x1477a0(0xcb)]=void 0x0;const constants_1=require(a234_0x1477a0(0xab)),core_1=require('../../../../core'),zip_1=require(a234_0x1477a0(0xe5)),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a234_0x1477a0(0x100)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a234_0x1477a0(0xe2));function a234_0x24fc(_0x298ae2,_0x365a93){const _0x3f4ab5=a234_0x1901();return a234_0x24fc=function(_0x1f9868,_0x1862be){_0x1f9868=_0x1f9868-0x9c;let _0x19018c=_0x3f4ab5[_0x1f9868];return _0x19018c;},a234_0x24fc(_0x298ae2,_0x365a93);}class SalesforceComponentsManager{constructor(_0x5774dc,_0x1f5b17,_0x2a9b50,_0x5384ce,_0x3e4c67){const _0x40be87=a234_0x1477a0;this[_0x40be87(0xb1)]=_0x5774dc,this['branchId']=_0x1f5b17,this[_0x40be87(0xf1)]=_0x2a9b50,this[_0x40be87(0xe9)]=_0x5384ce,this[_0x40be87(0xaf)]=_0x3e4c67,this[_0x40be87(0xf0)]=new core_1['Logger'](SalesforceComponentsManager[_0x40be87(0xbc)]),this[_0x40be87(0x9c)]=typedi_1[_0x40be87(0xbd)]['get'](salesforce_git_sync_service_1[_0x40be87(0xc8)]);}['proceedComponentMeta'](_0x23d090,_0x58a2a6){const _0x53d999=a234_0x1477a0,_0x976cac=(0x0,flosum_naming_utils_1[_0x53d999(0xc1)])(_0x23d090,['Component_Type__c',_0x53d999(0xfc),_0x53d999(0xca)]);this[_0x53d999(0xaf)][_0x53d999(0xda)]({'componentId':'','reference':_0x58a2a6,'version':_0x976cac[_0x53d999(0xca)],'componentName':_0x976cac[_0x53d999(0xfc)],'componentType':_0x976cac[_0x53d999(0xdf)]});}[a234_0x1477a0(0xc4)](_0x2678f6,_0x60ebb2){const _0x506d99=a234_0x1477a0,{request:_0x1a4f1b}=(0x0,composite_utils_1[_0x506d99(0xdc)])(constants_1[_0x506d99(0xb3)],{[constants_1[_0x506d99(0xeb)]+_0x506d99(0xe6)]:_0x2678f6,[constants_1[_0x506d99(0xeb)]+'Component_History__c']:_0x60ebb2});return _0x1a4f1b;}async[a234_0x1477a0(0xba)](_0x5e6e42,_0x5edb6f){const _0x504aae=a234_0x1477a0,_0x59af22={},_0x2916ad=zip_1[_0x504aae(0xf5)]['createZip']();for(const _0x3e90f1 of Object['keys'](_0x5e6e42[_0x504aae(0xee)])){_0x2916ad['file'](_0x3e90f1,_0x5e6e42[_0x504aae(0xee)][_0x3e90f1],{'createFolders':!![]});}return _0x59af22[_0x504aae(0xec)]=_0x504aae(0xb2),_0x59af22[_0x504aae(0xe4)]=_0x5e6e42['type'],_0x59af22[_0x504aae(0xb4)]=_0x5e6e42[_0x504aae(0xa8)],_0x59af22['ParentId']=_0x5edb6f,_0x59af22[_0x504aae(0xfa)]=await _0x2916ad[_0x504aae(0xd3)]({'type':_0x504aae(0xbe),'compression':_0x504aae(0xf2),'compressionOptions':{'level':0x6}}),_0x59af22;}[a234_0x1477a0(0xe1)](_0x5152cf,_0x18ffbf,_0x4d6b23){const _0x433f6f=a234_0x1477a0,_0x4e782c=new Date()[_0x433f6f(0xad)](),_0x2c60da={};return _0x2c60da[constants_1[_0x433f6f(0xeb)]+'Component__c']=_0x18ffbf,_0x2c60da[constants_1['FLOSUM_NAMESPACE']+_0x433f6f(0xce)]=_0x5152cf[_0x433f6f(0xe8)],_0x2c60da[constants_1['FLOSUM_NAMESPACE']+_0x433f6f(0xc5)]=_0x4e782c,_0x2c60da[constants_1['FLOSUM_NAMESPACE']+_0x433f6f(0xe0)]=this[_0x433f6f(0xf1)],_0x2c60da[constants_1['FLOSUM_NAMESPACE']+'Version__c']=_0x4d6b23?_0x4d6b23+0x1:0x1,_0x2c60da[constants_1[_0x433f6f(0xdd)]+_0x433f6f(0xd5)]=!![],_0x2c60da;}[a234_0x1477a0(0xac)](_0x3d50bb,_0xb24c77){const _0x2c4c6c=a234_0x1477a0;var _0x1fd0b9,_0x27d1db;const _0x343b93=new Date()['toISOString'](),_0x5c3482={};return!_0xb24c77?(this[_0x2c4c6c(0xdb)]?(_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0x9e)]=this[_0x2c4c6c(0xdb)],_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xbf)]='Branch',_0x5c3482[_0x2c4c6c(0xc7)]=(_0x1fd0b9=this['recordTypes'][_0x2c4c6c(0xcc)](_0x22d749=>_0x22d749['name']===_0x2c4c6c(0xa5)))===null||_0x1fd0b9===void 0x0?void 0x0:_0x1fd0b9['id']):(_0x5c3482[constants_1['FLOSUM_NAMESPACE']+_0x2c4c6c(0xc2)]=this['repositoryId'],_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xbf)]='Repository',_0x5c3482[_0x2c4c6c(0xc7)]=(_0x27d1db=this[_0x2c4c6c(0xe9)][_0x2c4c6c(0xcc)](_0x4309f9=>_0x4309f9[_0x2c4c6c(0xbc)]==='Repository'))===null||_0x27d1db===void 0x0?void 0x0:_0x27d1db['id']),_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xca)]=0x1):_0x5c3482[constants_1['FLOSUM_NAMESPACE']+_0x2c4c6c(0xca)]=_0xb24c77[_0x2c4c6c(0xc9)]+0x1,_0x5c3482[constants_1['FLOSUM_NAMESPACE']+_0x2c4c6c(0xdf)]=_0x3d50bb['type'],_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xfc)]=_0x3d50bb[_0x2c4c6c(0xbc)],_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xf3)]=_0x3d50bb['filePath'],_0x5c3482[constants_1['FLOSUM_NAMESPACE']+_0x2c4c6c(0xd8)]=this[_0x2c4c6c(0xf1)],_0x5c3482[constants_1['FLOSUM_NAMESPACE']+_0x2c4c6c(0xa4)]=this[_0x2c4c6c(0xf1)],_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xd0)]=_0x343b93,_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xff)]=_0x343b93,_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0xce)]=_0x3d50bb[_0x2c4c6c(0xe8)],_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+'Vlocity_Component_Name__c']=_0x3d50bb['vlocityComponentName'],_0x5c3482[constants_1[_0x2c4c6c(0xeb)]+_0x2c4c6c(0x9f)]=_0x3d50bb[_0x2c4c6c(0xfe)],_0x5c3482;}['getProceededComponentsMeta'](){return this['proceededComponentsMeta'];}async[a234_0x1477a0(0xd2)](_0x59aaae,_0xf14245){const _0x1a5fb2=a234_0x1477a0,_0xa35bd6=[];for(const _0x5c9f2f of _0x59aaae){const _0x289e85=(0x0,composite_utils_1[_0x1a5fb2(0xdc)])(constants_1[_0x1a5fb2(0xf7)],this['prepareComponentRecord'](_0x5c9f2f)),_0x2e362c=(0x0,composite_utils_1[_0x1a5fb2(0xdc)])(constants_1[_0x1a5fb2(0xde)],this['prepareComponentHistoryRecord'](_0x5c9f2f,'@{'+_0x289e85[_0x1a5fb2(0xd9)]+_0x1a5fb2(0xc3))),_0x919273=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_ATTACHMENT'],await this['prepareComponentAttachmentRecord'](_0x5c9f2f,'@{'+_0x2e362c['reference']+_0x1a5fb2(0xc3)));this['proceedComponentMeta'](_0x289e85[_0x1a5fb2(0xa7)]['body'],_0x289e85[_0x1a5fb2(0xd9)]),_0xa35bd6[_0x1a5fb2(0xda)](_0x289e85[_0x1a5fb2(0xa7)],_0x2e362c[_0x1a5fb2(0xa7)],_0x919273[_0x1a5fb2(0xa7)]),_0xf14245&&_0xa35bd6['push'](this[_0x1a5fb2(0xc4)](_0xf14245,'@{'+_0x2e362c[_0x1a5fb2(0xd9)]+_0x1a5fb2(0xc3)));}return _0xa35bd6;}async[a234_0x1477a0(0xd1)](_0x503409,_0x21b679=''){const _0x35ef5e=a234_0x1477a0,_0x48749c=[];for(const {component:_0x1d3ccd,meta:_0x9ba691}of _0x503409){if(!_0x9ba691['id']){const _0x32bf82=this[_0x35ef5e(0xaf)][_0x35ef5e(0xcc)](_0x4c686d=>_0x4c686d[_0x35ef5e(0xb7)]===_0x1d3ccd['name']&&_0x4c686d[_0x35ef5e(0xc6)]===_0x1d3ccd[_0x35ef5e(0xa8)]);if(!_0x32bf82)throw new salesforce_error_1[(_0x35ef5e(0xea))](new Error(_0x35ef5e(0xed)+_0x1d3ccd['name']+'\x20['+_0x1d3ccd['type']+_0x35ef5e(0xa1)));_0x9ba691['id']=_0x32bf82[_0x35ef5e(0xf6)];}const _0x20f56b=(0x0,composite_utils_1[_0x35ef5e(0x9d)])(constants_1['FLOSUM_COMPONENT'],_0x9ba691['id'],this[_0x35ef5e(0xac)](_0x1d3ccd,_0x9ba691)),_0x3abf88=(0x0,composite_utils_1[_0x35ef5e(0xdc)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x35ef5e(0xe1)](_0x1d3ccd,_0x9ba691['id'],_0x9ba691[_0x35ef5e(0xc9)])),_0x17a93f=(0x0,composite_utils_1[_0x35ef5e(0xdc)])(constants_1[_0x35ef5e(0xcf)],await this[_0x35ef5e(0xba)](_0x1d3ccd,'@{'+_0x3abf88[_0x35ef5e(0xd9)]+_0x35ef5e(0xc3)));this[_0x35ef5e(0xe3)](_0x20f56b[_0x35ef5e(0xa7)][_0x35ef5e(0xe7)],_0x20f56b['reference']),_0x48749c['push'](_0x20f56b[_0x35ef5e(0xa7)],_0x3abf88[_0x35ef5e(0xa7)],_0x17a93f[_0x35ef5e(0xa7)]),_0x21b679&&_0x48749c[_0x35ef5e(0xda)](this[_0x35ef5e(0xc4)](_0x21b679,'@{'+_0x3abf88['reference']+_0x35ef5e(0xc3)));}return _0x48749c;}async[a234_0x1477a0(0xef)](_0x329043,_0xafa10=![]){const _0x4d2bdc=a234_0x1477a0,_0x20f8f8={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x372d7d=[];for(const _0x176b6b of _0x329043){if(_0x176b6b['id'])_0x372d7d[_0x4d2bdc(0xda)](_0x176b6b['id']);else{const _0x41ba74=this['proceededComponentsMeta'][_0x4d2bdc(0xcc)](_0x1ed8b1=>_0x1ed8b1['componentName']===_0x176b6b['name']&&_0x1ed8b1[_0x4d2bdc(0xc6)]===_0x176b6b[_0x4d2bdc(0xa8)]);if(!_0x41ba74||!_0x41ba74[_0x4d2bdc(0xf6)])continue;_0x372d7d[_0x4d2bdc(0xda)](_0x41ba74['componentId']);}}if(_0xafa10){const _0x50ea44=await this['gitSync'][_0x4d2bdc(0xb6)](_0x372d7d);_0x20f8f8[_0x4d2bdc(0xa9)]=_0x50ea44[_0x4d2bdc(0xb9)](_0x36cb37=>(0x0,composite_utils_1[_0x4d2bdc(0xcd)])(constants_1[_0x4d2bdc(0xb3)],_0x36cb37)[_0x4d2bdc(0xa7)]);}return _0x20f8f8[_0x4d2bdc(0xfd)]=_0x372d7d[_0x4d2bdc(0xb9)](_0x1cd427=>(0x0,composite_utils_1[_0x4d2bdc(0x9d)])(constants_1[_0x4d2bdc(0xf7)],_0x1cd427,{[constants_1['FLOSUM_GIT_NAMESPACE']+'Deletion_By_Agent__c']:!![]})[_0x4d2bdc(0xa7)]),_0x20f8f8[_0x4d2bdc(0xa3)]=_0x372d7d[_0x4d2bdc(0xb9)](_0x3f806b=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1['FLOSUM_COMPONENT'],_0x3f806b)[_0x4d2bdc(0xa7)]),_0x20f8f8;}}exports[a234_0x1477a0(0xcb)]=SalesforceComponentsManager;