const a261_0x2eacea=a261_0xcedf;(function(_0x345a3e,_0x18c9f6){const _0x3e97c8=a261_0xcedf,_0x253336=_0x345a3e();while(!![]){try{const _0x3c79d5=-parseInt(_0x3e97c8(0x1cd))/0x1+parseInt(_0x3e97c8(0x1b2))/0x2+parseInt(_0x3e97c8(0x178))/0x3*(parseInt(_0x3e97c8(0x19d))/0x4)+-parseInt(_0x3e97c8(0x1a8))/0x5*(-parseInt(_0x3e97c8(0x1c3))/0x6)+parseInt(_0x3e97c8(0x170))/0x7+-parseInt(_0x3e97c8(0x197))/0x8+-parseInt(_0x3e97c8(0x184))/0x9;if(_0x3c79d5===_0x18c9f6)break;else _0x253336['push'](_0x253336['shift']());}catch(_0xf3e58f){_0x253336['push'](_0x253336['shift']());}}}(a261_0x4cf2,0x66bed));const a261_0x54cc68=(function(){let _0x336739=!![];return function(_0x356709,_0xf11ce9){const _0x4a8feb=_0x336739?function(){if(_0xf11ce9){const _0x354eba=_0xf11ce9['apply'](_0x356709,arguments);return _0xf11ce9=null,_0x354eba;}}:function(){};return _0x336739=![],_0x4a8feb;};}()),a261_0x206f49=a261_0x54cc68(this,function(){const _0x42b996=a261_0xcedf;return a261_0x206f49['toString']()[_0x42b996(0x1bb)](_0x42b996(0x19b))[_0x42b996(0x1a4)]()['constructor'](a261_0x206f49)[_0x42b996(0x1bb)](_0x42b996(0x19b));});a261_0x206f49();'use strict';var __importDefault=this&&this[a261_0x2eacea(0x1be)]||function(_0x225c98){const _0xba93e6=a261_0x2eacea;return _0x225c98&&_0x225c98[_0xba93e6(0x1d0)]?_0x225c98:{'default':_0x225c98};};Object[a261_0x2eacea(0x1a7)](exports,'__esModule',{'value':!![]}),exports[a261_0x2eacea(0x185)]=void 0x0;function a261_0x4cf2(){const _0xabd804=['Vlocity_Component_Name__c','Description','6AuMQlN',']\x20-\x20meta\x20not\x20found','FLOSUM_COMPONENT_HISTORY','version','../errors/salesforce.error','../utils/flosum-naming.utils','Vlocity_Component__c','Last_Modified_Date__c','createDeleteRequest','application/zip','prepareComponentAttachmentRecord','generateAsync','6646770LkRzvY','SalesforceComponentsManager','body','logger','find','recordTypes','componentType','proceededComponentsMeta','ParentId','FLOSUM_COMPONENT','ContentType','request','Component__c','fetchCommitManifestsByComponentIds','Last_Modified_By__c','RecordTypeId','delete','proceedComponentMeta','MC_Key__c','575544DZjWqg','createPatchRequest','../../../../constants','Component_Type__c','(((.+)+)+)+$','Is_From_Agent__c','1219632uDVoVC','marketingCloudKey','Changed_By__c','FLOSUM_NAMESPACE','createZip','Version__c','prepareComponentRecord','toString','Name','crc','defineProperty','20FbhWGq','Deletion_By_Agent__c','Branch','./salesforce-git-sync.service','Repository','extractFieldsFromRecord','DEFLATE','Committed_On__c','.id}','vlocityComponentName','212526njBMrX','Zip','push','filePath','createPostRequest','Repository__c','repositoryId','toISOString','default','search','FLOSUM_GIT_NAMESPACE','files','__importDefault','gitSync','Branch__c','type','Changed_On__c','872778jcwKAK','prepareComponentHistoryRecord','name','Source__c','SalesforceGitSyncService','prepareCommitManifest','file','reference','isVlocityComponent','../../parsers/utils/zip','426313JPspRq','get','manifests','__esModule','map','Logger','SalesforceError','Component_Name__c','componentsToDelete','CRC32__c','branchId','getProceededComponentsMeta','../utils/composite.utils','FLOSUM_ATTACHMENT','2517900ItqQMm','username','FLOSUM_COMMIT_MANIFEST','componentId','update','componentsToUpdate'];a261_0x4cf2=function(){return _0xabd804;};return a261_0x4cf2();}function a261_0xcedf(_0x3e2833,_0x45eb63){const _0x4f82ba=a261_0x4cf2();return a261_0xcedf=function(_0x206f49,_0x54cc68){_0x206f49=_0x206f49-0x170;let _0x4cf2fa=_0x4f82ba[_0x206f49];return _0x4cf2fa;},a261_0xcedf(_0x3e2833,_0x45eb63);}const constants_1=require(a261_0x2eacea(0x199)),core_1=require('../../../../core'),zip_1=require(a261_0x2eacea(0x1cc)),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a261_0x2eacea(0x17c)),composite_utils_1=require(a261_0x2eacea(0x1d9)),flosum_naming_utils_1=require(a261_0x2eacea(0x17d)),salesforce_git_sync_service_1=require(a261_0x2eacea(0x1ab));class SalesforceComponentsManager{constructor(_0x78089,_0x43dcda,_0x31ff88,_0x24649e,_0x3e03f6){const _0x38e52b=a261_0x2eacea;this[_0x38e52b(0x1b8)]=_0x78089,this[_0x38e52b(0x1d7)]=_0x43dcda,this[_0x38e52b(0x171)]=_0x31ff88,this[_0x38e52b(0x189)]=_0x24649e,this['proceededComponentsMeta']=_0x3e03f6,this[_0x38e52b(0x187)]=new core_1[(_0x38e52b(0x1d2))](SalesforceComponentsManager['name']),this[_0x38e52b(0x1bf)]=typedi_1[_0x38e52b(0x1ba)][_0x38e52b(0x1ce)](salesforce_git_sync_service_1[_0x38e52b(0x1c7)]);}[a261_0x2eacea(0x195)](_0x4212d5,_0x4d382d){const _0x32821c=a261_0x2eacea,_0x57fa10=(0x0,flosum_naming_utils_1[_0x32821c(0x1ad)])(_0x4212d5,[_0x32821c(0x19a),_0x32821c(0x1d4),_0x32821c(0x1a2)]);this[_0x32821c(0x18b)][_0x32821c(0x1b4)]({'componentId':'','reference':_0x4d382d,'version':_0x57fa10[_0x32821c(0x1a2)],'componentName':_0x57fa10[_0x32821c(0x1d4)],'componentType':_0x57fa10[_0x32821c(0x19a)]});}[a261_0x2eacea(0x1c8)](_0x3cdd32,_0x2e17f5){const _0x1ada84=a261_0x2eacea,{request:_0x1817ae}=(0x0,composite_utils_1[_0x1ada84(0x1b6)])(constants_1[_0x1ada84(0x172)],{[constants_1[_0x1ada84(0x1a0)]+'Commit__c']:_0x3cdd32,[constants_1[_0x1ada84(0x1a0)]+'Component_History__c']:_0x2e17f5});return _0x1817ae;}async[a261_0x2eacea(0x182)](_0x1d1292,_0x1b2366){const _0x3763b3=a261_0x2eacea,_0x3dab41={},_0x27e045=zip_1[_0x3763b3(0x1b3)][_0x3763b3(0x1a1)]();for(const _0x5ed9b5 of Object['keys'](_0x1d1292[_0x3763b3(0x1bd)])){_0x27e045[_0x3763b3(0x1c9)](_0x5ed9b5,_0x1d1292[_0x3763b3(0x1bd)][_0x5ed9b5],{'createFolders':!![]});}return _0x3dab41[_0x3763b3(0x18e)]=_0x3763b3(0x181),_0x3dab41[_0x3763b3(0x1a5)]=_0x1d1292[_0x3763b3(0x1c1)],_0x3dab41[_0x3763b3(0x177)]=_0x1d1292[_0x3763b3(0x1c1)],_0x3dab41[_0x3763b3(0x18c)]=_0x1b2366,_0x3dab41['Body']=await _0x27e045[_0x3763b3(0x183)]({'type':'base64','compression':_0x3763b3(0x1ae),'compressionOptions':{'level':0x6}}),_0x3dab41;}[a261_0x2eacea(0x1c4)](_0x4e157a,_0x2abd95,_0xff6a77){const _0x2c3c86=a261_0x2eacea,_0x48b3a6=new Date()['toISOString'](),_0x362376={};return _0x362376[constants_1[_0x2c3c86(0x1a0)]+_0x2c3c86(0x190)]=_0x2abd95,_0x362376[constants_1[_0x2c3c86(0x1a0)]+_0x2c3c86(0x1d6)]=_0x4e157a['crc'],_0x362376[constants_1[_0x2c3c86(0x1a0)]+_0x2c3c86(0x1c2)]=_0x48b3a6,_0x362376[constants_1['FLOSUM_NAMESPACE']+_0x2c3c86(0x19f)]=this[_0x2c3c86(0x171)],_0x362376[constants_1[_0x2c3c86(0x1a0)]+'Version__c']=_0xff6a77?_0xff6a77+0x1:0x1,_0x362376[constants_1[_0x2c3c86(0x1bc)]+_0x2c3c86(0x19c)]=!![],_0x362376;}[a261_0x2eacea(0x1a3)](_0x33673e,_0x305b20){const _0x1c8cf2=a261_0x2eacea;var _0x4b1049,_0x20aad4;const _0x165b41=new Date()[_0x1c8cf2(0x1b9)](),_0x73bf59={};return!_0x305b20?(this[_0x1c8cf2(0x1d7)]?(_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x1c0)]=this['branchId'],_0x73bf59[constants_1['FLOSUM_NAMESPACE']+'Source__c']=_0x1c8cf2(0x1aa),_0x73bf59[_0x1c8cf2(0x193)]=(_0x4b1049=this['recordTypes'][_0x1c8cf2(0x188)](_0x8ed21=>_0x8ed21[_0x1c8cf2(0x1c5)]===_0x1c8cf2(0x1aa)))===null||_0x4b1049===void 0x0?void 0x0:_0x4b1049['id']):(_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x1b7)]=this['repositoryId'],_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x1c6)]=_0x1c8cf2(0x1ac),_0x73bf59[_0x1c8cf2(0x193)]=(_0x20aad4=this['recordTypes']['find'](_0x871650=>_0x871650[_0x1c8cf2(0x1c5)]==='Repository'))===null||_0x20aad4===void 0x0?void 0x0:_0x20aad4['id']),_0x73bf59[constants_1['FLOSUM_NAMESPACE']+_0x1c8cf2(0x1a2)]=0x1):_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x1a2)]=_0x305b20[_0x1c8cf2(0x17b)]+0x1,_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x19a)]=_0x33673e[_0x1c8cf2(0x1c1)],_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+'Component_Name__c']=_0x33673e[_0x1c8cf2(0x1c5)],_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+'File_Name__c']=_0x33673e[_0x1c8cf2(0x1b5)],_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+'Last_Updated_By__c']=this[_0x1c8cf2(0x171)],_0x73bf59[constants_1['FLOSUM_NAMESPACE']+_0x1c8cf2(0x192)]=this['username'],_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x17f)]=_0x165b41,_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x1af)]=_0x165b41,_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x1d6)]=_0x33673e[_0x1c8cf2(0x1a6)],_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x176)]=_0x33673e[_0x1c8cf2(0x1b1)],_0x73bf59[constants_1['FLOSUM_NAMESPACE']+_0x1c8cf2(0x17e)]=_0x33673e[_0x1c8cf2(0x1cb)],_0x73bf59[constants_1[_0x1c8cf2(0x1a0)]+_0x1c8cf2(0x196)]=_0x33673e[_0x1c8cf2(0x19e)],_0x73bf59;}[a261_0x2eacea(0x1d8)](){const _0x1dee8f=a261_0x2eacea;return this[_0x1dee8f(0x18b)];}async['insert'](_0x26bb3b,_0x1c0cee){const _0x555075=a261_0x2eacea,_0x952414=[];for(const _0x5abc6a of _0x26bb3b){const _0x84fd38=(0x0,composite_utils_1[_0x555075(0x1b6)])(constants_1[_0x555075(0x18d)],this[_0x555075(0x1a3)](_0x5abc6a)),_0x2e968a=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x555075(0x17a)],this[_0x555075(0x1c4)](_0x5abc6a,'@{'+_0x84fd38[_0x555075(0x1ca)]+_0x555075(0x1b0))),_0x30f720=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x555075(0x1da)],await this[_0x555075(0x182)](_0x5abc6a,'@{'+_0x2e968a[_0x555075(0x1ca)]+_0x555075(0x1b0)));this[_0x555075(0x195)](_0x84fd38['request'][_0x555075(0x186)],_0x84fd38['reference']),_0x952414[_0x555075(0x1b4)](_0x84fd38[_0x555075(0x18f)],_0x2e968a[_0x555075(0x18f)],_0x30f720[_0x555075(0x18f)]),_0x1c0cee&&_0x952414[_0x555075(0x1b4)](this[_0x555075(0x1c8)](_0x1c0cee,'@{'+_0x2e968a[_0x555075(0x1ca)]+_0x555075(0x1b0)));}return _0x952414;}async[a261_0x2eacea(0x174)](_0x4f02bb,_0x4ef649=''){const _0x2479d7=a261_0x2eacea,_0x557317=[];for(const {component:_0x34516a,meta:_0x51b15f}of _0x4f02bb){if(!_0x51b15f['id']){const _0x296812=this[_0x2479d7(0x18b)]['find'](_0x3a6e51=>_0x3a6e51['componentName']===_0x34516a[_0x2479d7(0x1c5)]&&_0x3a6e51['componentType']===_0x34516a[_0x2479d7(0x1c1)]);if(!_0x296812)throw new salesforce_error_1[(_0x2479d7(0x1d3))](new Error('Could\x20not\x20proceed\x20component\x20'+_0x34516a[_0x2479d7(0x1c5)]+'\x20['+_0x34516a['type']+_0x2479d7(0x179)));_0x51b15f['id']=_0x296812['componentId'];}const _0x58eb8f=(0x0,composite_utils_1[_0x2479d7(0x198)])(constants_1[_0x2479d7(0x18d)],_0x51b15f['id'],this['prepareComponentRecord'](_0x34516a,_0x51b15f)),_0x9f664b=(0x0,composite_utils_1[_0x2479d7(0x1b6)])(constants_1[_0x2479d7(0x17a)],this['prepareComponentHistoryRecord'](_0x34516a,_0x51b15f['id'],_0x51b15f[_0x2479d7(0x17b)])),_0x2fef8c=(0x0,composite_utils_1[_0x2479d7(0x1b6)])(constants_1[_0x2479d7(0x1da)],await this[_0x2479d7(0x182)](_0x34516a,'@{'+_0x9f664b[_0x2479d7(0x1ca)]+_0x2479d7(0x1b0)));this['proceedComponentMeta'](_0x58eb8f[_0x2479d7(0x18f)]['body'],_0x58eb8f[_0x2479d7(0x1ca)]),_0x557317['push'](_0x58eb8f[_0x2479d7(0x18f)],_0x9f664b[_0x2479d7(0x18f)],_0x2fef8c[_0x2479d7(0x18f)]),_0x4ef649&&_0x557317[_0x2479d7(0x1b4)](this[_0x2479d7(0x1c8)](_0x4ef649,'@{'+_0x9f664b[_0x2479d7(0x1ca)]+'.id}'));}return _0x557317;}async[a261_0x2eacea(0x194)](_0x4835e9,_0x184506=![]){const _0x17238c=a261_0x2eacea,_0x411c5c={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x475616=[];for(const _0x3f21df of _0x4835e9){if(_0x3f21df['id'])_0x475616[_0x17238c(0x1b4)](_0x3f21df['id']);else{const _0x533b84=this[_0x17238c(0x18b)][_0x17238c(0x188)](_0x40c004=>_0x40c004['componentName']===_0x3f21df[_0x17238c(0x1c5)]&&_0x40c004[_0x17238c(0x18a)]===_0x3f21df[_0x17238c(0x1c1)]);if(!_0x533b84||!_0x533b84[_0x17238c(0x173)])continue;_0x475616[_0x17238c(0x1b4)](_0x533b84[_0x17238c(0x173)]);}}if(_0x184506){const _0x214f5c=await this[_0x17238c(0x1bf)][_0x17238c(0x191)](_0x475616);_0x411c5c[_0x17238c(0x1cf)]=_0x214f5c[_0x17238c(0x1d1)](_0x4daa0f=>(0x0,composite_utils_1[_0x17238c(0x180)])(constants_1[_0x17238c(0x172)],_0x4daa0f)[_0x17238c(0x18f)]);}return _0x411c5c[_0x17238c(0x175)]=_0x475616[_0x17238c(0x1d1)](_0x5f32da=>(0x0,composite_utils_1[_0x17238c(0x198)])(constants_1[_0x17238c(0x18d)],_0x5f32da,{[constants_1[_0x17238c(0x1bc)]+_0x17238c(0x1a9)]:!![]})[_0x17238c(0x18f)]),_0x411c5c[_0x17238c(0x1d5)]=_0x475616[_0x17238c(0x1d1)](_0x44d486=>(0x0,composite_utils_1[_0x17238c(0x180)])(constants_1['FLOSUM_COMPONENT'],_0x44d486)[_0x17238c(0x18f)]),_0x411c5c;}}exports[a261_0x2eacea(0x185)]=SalesforceComponentsManager;