const a234_0x25607d=a234_0x3ee3;(function(_0x261eb7,_0x343817){const _0x280d25=a234_0x3ee3,_0x840df2=_0x261eb7();while(!![]){try{const _0x453ba9=-parseInt(_0x280d25(0x249))/0x1+-parseInt(_0x280d25(0x242))/0x2+parseInt(_0x280d25(0x244))/0x3*(-parseInt(_0x280d25(0x22f))/0x4)+-parseInt(_0x280d25(0x1f3))/0x5+-parseInt(_0x280d25(0x1f7))/0x6*(-parseInt(_0x280d25(0x225))/0x7)+parseInt(_0x280d25(0x217))/0x8+-parseInt(_0x280d25(0x221))/0x9*(-parseInt(_0x280d25(0x222))/0xa);if(_0x453ba9===_0x343817)break;else _0x840df2['push'](_0x840df2['shift']());}catch(_0x187294){_0x840df2['push'](_0x840df2['shift']());}}}(a234_0x543a,0xed226));function a234_0x543a(){const _0xf60b7c=['Source__c','file','reference','448170sayhAj','prepareComponentHistoryRecord','DEFLATE','keys','Repository__c','recordTypes','Repository','update','FLOSUM_COMPONENT_HISTORY','gitSync','Vlocity_Component__c','Deletion_By_Agent__c','Name','Description','2278645ccUZNM','componentType','crc','toISOString','402312ceyYow','Branch','componentId','../../parsers/utils/zip','SalesforceComponentsManager','logger','search','apply','ParentId','type','name','version','componentsToUpdate','isVlocityComponent','Version__c','manifests','../errors/salesforce.error','Last_Updated_By__c','generateAsync','Changed_On__c','push','FLOSUM_NAMESPACE','fetchCommitManifestsByComponentIds','SalesforceError','FLOSUM_ATTACHMENT','FLOSUM_COMMIT_MANIFEST','username','prepareCommitManifest','(((.+)+)+)+$','createPatchRequest','Last_Modified_By__c','branchId','4802152wdVxLg','getProceededComponentsMeta','componentsToDelete','prepareComponentAttachmentRecord','Component_Type__c','Could\x20not\x20proceed\x20component\x20','prepareComponentRecord','delete','FLOSUM_GIT_NAMESPACE','files','18ahSMCm','11704910JbaIYq','__importDefault','../../../../core','133HicbSG','repositoryId','toString','CRC32__c','map','Commit__c','Zip','body','Logger','FLOSUM_COMPONENT','839972rUICEk','createPostRequest','RecordTypeId','extractFieldsFromRecord','default','proceedComponentMeta','proceededComponentsMeta','find','base64','Component_Name__c','typedi','request','.id}','insert','createDeleteRequest','get','./salesforce-git-sync.service','Branch__c','Is_From_Agent__c','2160160KwKApb',']\x20-\x20meta\x20not\x20found','18gcgPgV','componentName'];a234_0x543a=function(){return _0xf60b7c;};return a234_0x543a();}const a234_0x19a619=(function(){let _0x515122=!![];return function(_0x53101e,_0x1ee62b){const _0x28c7e7=_0x515122?function(){const _0x2f723e=a234_0x3ee3;if(_0x1ee62b){const _0x4bdaef=_0x1ee62b[_0x2f723e(0x1fe)](_0x53101e,arguments);return _0x1ee62b=null,_0x4bdaef;}}:function(){};return _0x515122=![],_0x28c7e7;};}()),a234_0x32bb6b=a234_0x19a619(this,function(){const _0x4b6d14=a234_0x3ee3;return a234_0x32bb6b[_0x4b6d14(0x227)]()[_0x4b6d14(0x1fd)](_0x4b6d14(0x213))['toString']()['constructor'](a234_0x32bb6b)[_0x4b6d14(0x1fd)](_0x4b6d14(0x213));});a234_0x32bb6b();'use strict';var __importDefault=this&&this[a234_0x25607d(0x223)]||function(_0x956d5d){return _0x956d5d&&_0x956d5d['__esModule']?_0x956d5d:{'default':_0x956d5d};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a234_0x25607d(0x1fb)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a234_0x25607d(0x224)),zip_1=require(a234_0x25607d(0x1fa)),typedi_1=__importDefault(require(a234_0x25607d(0x239))),salesforce_error_1=require(a234_0x25607d(0x207)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a234_0x25607d(0x23f));class SalesforceComponentsManager{constructor(_0x562400,_0x220a65,_0x7f5218,_0x46a892,_0x53990e){const _0x5c74a7=a234_0x25607d;this[_0x5c74a7(0x226)]=_0x562400,this[_0x5c74a7(0x216)]=_0x220a65,this[_0x5c74a7(0x211)]=_0x7f5218,this[_0x5c74a7(0x1ea)]=_0x46a892,this[_0x5c74a7(0x235)]=_0x53990e,this[_0x5c74a7(0x1fc)]=new core_1[(_0x5c74a7(0x22d))](SalesforceComponentsManager[_0x5c74a7(0x201)]),this[_0x5c74a7(0x1ee)]=typedi_1[_0x5c74a7(0x233)][_0x5c74a7(0x23e)](salesforce_git_sync_service_1['SalesforceGitSyncService']);}[a234_0x25607d(0x234)](_0xb19efa,_0x28ac6b){const _0x151f02=a234_0x25607d,_0x208791=(0x0,flosum_naming_utils_1[_0x151f02(0x232)])(_0xb19efa,['Component_Type__c',_0x151f02(0x238),_0x151f02(0x205)]);this[_0x151f02(0x235)]['push']({'componentId':'','reference':_0x28ac6b,'version':_0x208791[_0x151f02(0x205)],'componentName':_0x208791[_0x151f02(0x238)],'componentType':_0x208791[_0x151f02(0x21b)]});}[a234_0x25607d(0x212)](_0x51b4ee,_0x3bfa12){const _0x2ed0bb=a234_0x25607d,{request:_0x12d730}=(0x0,composite_utils_1[_0x2ed0bb(0x230)])(constants_1[_0x2ed0bb(0x210)],{[constants_1[_0x2ed0bb(0x20c)]+_0x2ed0bb(0x22a)]:_0x51b4ee,[constants_1[_0x2ed0bb(0x20c)]+'Component_History__c']:_0x3bfa12});return _0x12d730;}async[a234_0x25607d(0x21a)](_0x2ee474,_0x40b11b){const _0x2bbd07=a234_0x25607d,_0x52b059={},_0x43b91b=zip_1[_0x2bbd07(0x22b)]['createZip']();for(const _0x2975a2 of Object[_0x2bbd07(0x1e8)](_0x2ee474['files'])){_0x43b91b[_0x2bbd07(0x247)](_0x2975a2,_0x2ee474[_0x2bbd07(0x220)][_0x2975a2],{'createFolders':!![]});}return _0x52b059['ContentType']='application/zip',_0x52b059[_0x2bbd07(0x1f1)]=_0x2ee474[_0x2bbd07(0x200)],_0x52b059[_0x2bbd07(0x1f2)]=_0x2ee474[_0x2bbd07(0x200)],_0x52b059[_0x2bbd07(0x1ff)]=_0x40b11b,_0x52b059['Body']=await _0x43b91b[_0x2bbd07(0x209)]({'type':_0x2bbd07(0x237),'compression':_0x2bbd07(0x1e7),'compressionOptions':{'level':0x6}}),_0x52b059;}[a234_0x25607d(0x1e6)](_0xe075de,_0x5d4d24,_0x4a93c6){const _0xde08ce=a234_0x25607d,_0x50abf8=new Date()[_0xde08ce(0x1f6)](),_0x1661ff={};return _0x1661ff[constants_1['FLOSUM_NAMESPACE']+'Component__c']=_0x5d4d24,_0x1661ff[constants_1[_0xde08ce(0x20c)]+'CRC32__c']=_0xe075de[_0xde08ce(0x1f5)],_0x1661ff[constants_1['FLOSUM_NAMESPACE']+_0xde08ce(0x20a)]=_0x50abf8,_0x1661ff[constants_1[_0xde08ce(0x20c)]+'Changed_By__c']=this[_0xde08ce(0x211)],_0x1661ff[constants_1[_0xde08ce(0x20c)]+_0xde08ce(0x205)]=_0x4a93c6?_0x4a93c6+0x1:0x1,_0x1661ff[constants_1['FLOSUM_GIT_NAMESPACE']+_0xde08ce(0x241)]=!![],_0x1661ff;}['prepareComponentRecord'](_0x1356d2,_0x1db14e){const _0x1321b6=a234_0x25607d;var _0x2cef83,_0x37a15b;const _0x7ef885=new Date()[_0x1321b6(0x1f6)](),_0x1ac7a7={};return!_0x1db14e?(this[_0x1321b6(0x216)]?(_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x240)]=this[_0x1321b6(0x216)],_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x246)]=_0x1321b6(0x1f8),_0x1ac7a7[_0x1321b6(0x231)]=(_0x2cef83=this['recordTypes'][_0x1321b6(0x236)](_0x942a0f=>_0x942a0f[_0x1321b6(0x201)]===_0x1321b6(0x1f8)))===null||_0x2cef83===void 0x0?void 0x0:_0x2cef83['id']):(_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x1e9)]=this['repositoryId'],_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x246)]=_0x1321b6(0x1eb),_0x1ac7a7[_0x1321b6(0x231)]=(_0x37a15b=this[_0x1321b6(0x1ea)][_0x1321b6(0x236)](_0x19ce99=>_0x19ce99['name']===_0x1321b6(0x1eb)))===null||_0x37a15b===void 0x0?void 0x0:_0x37a15b['id']),_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x205)]=0x1):_0x1ac7a7[constants_1['FLOSUM_NAMESPACE']+_0x1321b6(0x205)]=_0x1db14e[_0x1321b6(0x202)]+0x1,_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x21b)]=_0x1356d2[_0x1321b6(0x200)],_0x1ac7a7[constants_1['FLOSUM_NAMESPACE']+_0x1321b6(0x238)]=_0x1356d2[_0x1321b6(0x201)],_0x1ac7a7[constants_1['FLOSUM_NAMESPACE']+'File_Name__c']=_0x1356d2['filePath'],_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x208)]=this[_0x1321b6(0x211)],_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x215)]=this[_0x1321b6(0x211)],_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+'Last_Modified_Date__c']=_0x7ef885,_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+'Committed_On__c']=_0x7ef885,_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x228)]=_0x1356d2[_0x1321b6(0x1f5)],_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+'Vlocity_Component_Name__c']=_0x1356d2['vlocityComponentName'],_0x1ac7a7[constants_1[_0x1321b6(0x20c)]+_0x1321b6(0x1ef)]=_0x1356d2[_0x1321b6(0x204)],_0x1ac7a7;}[a234_0x25607d(0x218)](){return this['proceededComponentsMeta'];}async[a234_0x25607d(0x23c)](_0x16650c,_0x245da4){const _0x55ee5=a234_0x25607d,_0x4998a6=[];for(const _0xf0dd05 of _0x16650c){const _0x263027=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x55ee5(0x22e)],this['prepareComponentRecord'](_0xf0dd05)),_0x14ff52=(0x0,composite_utils_1[_0x55ee5(0x230)])(constants_1[_0x55ee5(0x1ed)],this[_0x55ee5(0x1e6)](_0xf0dd05,'@{'+_0x263027[_0x55ee5(0x248)]+'.id}')),_0xd00cc9=(0x0,composite_utils_1[_0x55ee5(0x230)])(constants_1[_0x55ee5(0x20f)],await this[_0x55ee5(0x21a)](_0xf0dd05,'@{'+_0x14ff52[_0x55ee5(0x248)]+_0x55ee5(0x23b)));this[_0x55ee5(0x234)](_0x263027[_0x55ee5(0x23a)][_0x55ee5(0x22c)],_0x263027['reference']),_0x4998a6[_0x55ee5(0x20b)](_0x263027[_0x55ee5(0x23a)],_0x14ff52[_0x55ee5(0x23a)],_0xd00cc9[_0x55ee5(0x23a)]),_0x245da4&&_0x4998a6[_0x55ee5(0x20b)](this[_0x55ee5(0x212)](_0x245da4,'@{'+_0x14ff52['reference']+_0x55ee5(0x23b)));}return _0x4998a6;}async[a234_0x25607d(0x1ec)](_0xd5abb2,_0x33e4e1=''){const _0x15bd76=a234_0x25607d,_0x1435b6=[];for(const {component:_0x42b580,meta:_0x6130f7}of _0xd5abb2){if(!_0x6130f7['id']){const _0x152f62=this['proceededComponentsMeta'][_0x15bd76(0x236)](_0x2cc402=>_0x2cc402[_0x15bd76(0x245)]===_0x42b580[_0x15bd76(0x201)]&&_0x2cc402[_0x15bd76(0x1f4)]===_0x42b580[_0x15bd76(0x200)]);if(!_0x152f62)throw new salesforce_error_1[(_0x15bd76(0x20e))](new Error(_0x15bd76(0x21c)+_0x42b580['name']+'\x20['+_0x42b580[_0x15bd76(0x200)]+_0x15bd76(0x243)));_0x6130f7['id']=_0x152f62[_0x15bd76(0x1f9)];}const _0x144021=(0x0,composite_utils_1[_0x15bd76(0x214)])(constants_1['FLOSUM_COMPONENT'],_0x6130f7['id'],this[_0x15bd76(0x21d)](_0x42b580,_0x6130f7)),_0x22983e=(0x0,composite_utils_1[_0x15bd76(0x230)])(constants_1[_0x15bd76(0x1ed)],this[_0x15bd76(0x1e6)](_0x42b580,_0x6130f7['id'],_0x6130f7[_0x15bd76(0x202)])),_0x50ee67=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x15bd76(0x20f)],await this[_0x15bd76(0x21a)](_0x42b580,'@{'+_0x22983e[_0x15bd76(0x248)]+_0x15bd76(0x23b)));this[_0x15bd76(0x234)](_0x144021[_0x15bd76(0x23a)][_0x15bd76(0x22c)],_0x144021[_0x15bd76(0x248)]),_0x1435b6[_0x15bd76(0x20b)](_0x144021[_0x15bd76(0x23a)],_0x22983e[_0x15bd76(0x23a)],_0x50ee67[_0x15bd76(0x23a)]),_0x33e4e1&&_0x1435b6[_0x15bd76(0x20b)](this[_0x15bd76(0x212)](_0x33e4e1,'@{'+_0x22983e[_0x15bd76(0x248)]+'.id}'));}return _0x1435b6;}async[a234_0x25607d(0x21e)](_0x88974e,_0x1f3eab=![]){const _0x390514=a234_0x25607d,_0x2122e1={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x7be803=[];for(const _0x5d3589 of _0x88974e){if(_0x5d3589['id'])_0x7be803[_0x390514(0x20b)](_0x5d3589['id']);else{const _0x35322d=this[_0x390514(0x235)][_0x390514(0x236)](_0x5ef606=>_0x5ef606[_0x390514(0x245)]===_0x5d3589[_0x390514(0x201)]&&_0x5ef606[_0x390514(0x1f4)]===_0x5d3589[_0x390514(0x200)]);if(!_0x35322d||!_0x35322d[_0x390514(0x1f9)])continue;_0x7be803[_0x390514(0x20b)](_0x35322d['componentId']);}}if(_0x1f3eab){const _0x36797f=await this[_0x390514(0x1ee)][_0x390514(0x20d)](_0x7be803);_0x2122e1[_0x390514(0x206)]=_0x36797f[_0x390514(0x229)](_0x34c470=>(0x0,composite_utils_1[_0x390514(0x23d)])(constants_1[_0x390514(0x210)],_0x34c470)['request']);}return _0x2122e1[_0x390514(0x203)]=_0x7be803[_0x390514(0x229)](_0x3a95c6=>(0x0,composite_utils_1[_0x390514(0x214)])(constants_1[_0x390514(0x22e)],_0x3a95c6,{[constants_1[_0x390514(0x21f)]+_0x390514(0x1f0)]:!![]})[_0x390514(0x23a)]),_0x2122e1[_0x390514(0x219)]=_0x7be803['map'](_0x8d3cc4=>(0x0,composite_utils_1[_0x390514(0x23d)])(constants_1['FLOSUM_COMPONENT'],_0x8d3cc4)[_0x390514(0x23a)]),_0x2122e1;}}function a234_0x3ee3(_0x59fff9,_0x3cdf5c){const _0x26255e=a234_0x543a();return a234_0x3ee3=function(_0x32bb6b,_0x19a619){_0x32bb6b=_0x32bb6b-0x1e6;let _0x543a2d=_0x26255e[_0x32bb6b];return _0x543a2d;},a234_0x3ee3(_0x59fff9,_0x3cdf5c);}exports['SalesforceComponentsManager']=SalesforceComponentsManager;