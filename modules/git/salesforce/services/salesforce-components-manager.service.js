const a229_0x8c9423=a229_0x53ff;(function(_0x2ea275,_0x560bf9){const _0xd1882f=a229_0x53ff,_0x2c90a1=_0x2ea275();while(!![]){try{const _0x3779bd=-parseInt(_0xd1882f(0x11a))/0x1*(-parseInt(_0xd1882f(0x142))/0x2)+parseInt(_0xd1882f(0x150))/0x3+parseInt(_0xd1882f(0x12c))/0x4*(parseInt(_0xd1882f(0x114))/0x5)+-parseInt(_0xd1882f(0x112))/0x6*(parseInt(_0xd1882f(0x144))/0x7)+parseInt(_0xd1882f(0xfa))/0x8*(parseInt(_0xd1882f(0x123))/0x9)+parseInt(_0xd1882f(0x105))/0xa+-parseInt(_0xd1882f(0x141))/0xb;if(_0x3779bd===_0x560bf9)break;else _0x2c90a1['push'](_0x2c90a1['shift']());}catch(_0x2cc6eb){_0x2c90a1['push'](_0x2c90a1['shift']());}}}(a229_0x4e8a,0xec86e));const a229_0x308357=(function(){let _0x44121f=!![];return function(_0x35be06,_0x36ae2b){const _0xf374d6=_0x44121f?function(){const _0x45db56=a229_0x53ff;if(_0x36ae2b){const _0xdc54b7=_0x36ae2b[_0x45db56(0x143)](_0x35be06,arguments);return _0x36ae2b=null,_0xdc54b7;}}:function(){};return _0x44121f=![],_0xf374d6;};}()),a229_0x388422=a229_0x308357(this,function(){const _0xfc1f5e=a229_0x53ff;return a229_0x388422[_0xfc1f5e(0x135)]()[_0xfc1f5e(0x130)](_0xfc1f5e(0xfe))[_0xfc1f5e(0x135)]()[_0xfc1f5e(0xfd)](a229_0x388422)[_0xfc1f5e(0x130)](_0xfc1f5e(0xfe));});function a229_0x4e8a(){const _0x5ec45f=['get','826008UxIZaf','manifests','generateAsync','../utils/composite.utils','Branch','componentsToDelete','proceedComponentMeta','keys','proceededComponentsMeta','type','../../../../core','SalesforceComponentsManager','FLOSUM_NAMESPACE','FLOSUM_COMMIT_MANIFEST','request','gitSync','../../../../constants','CRC32__c','logger','Deletion_By_Agent__c','5714888NXewTw','prepareComponentAttachmentRecord','Committed_On__c','constructor','(((.+)+)+)+$','Source__c','../errors/salesforce.error','DEFLATE','Repository','Component_History__c','Repository__c','12155750uzkLNx','version','Last_Modified_Date__c','filePath','SalesforceGitSyncService','insert','username','default','Is_From_Agent__c','name','__esModule','RecordTypeId','typedi','1087236hanEfW','Changed_On__c','815IkdTlm','Version__c','SalesforceError','recordTypes','Component_Name__c','files','1658893EhbjXe','crc','file','FLOSUM_ATTACHMENT','componentType','.id}','componentName','createZip','componentsToUpdate','9XAZkgx','Description','createPostRequest','getProceededComponentsMeta','Last_Updated_By__c','defineProperty','FLOSUM_GIT_NAMESPACE','ContentType','map','20824yznCDB','reference','componentId','toISOString','search','extractFieldsFromRecord','update','Logger','Component_Type__c','toString','prepareCommitManifest','../../parsers/utils/zip','body','Zip','find',']\x20-\x20meta\x20not\x20found','FLOSUM_COMPONENT_HISTORY','application/zip','repositoryId','File_Name__c','fetchCommitManifestsByComponentIds','37196687jBaehW','2XbADYH','apply','14uVgEve','delete','Last_Modified_By__c','base64','../utils/flosum-naming.utils','branchId','push','prepareComponentHistoryRecord','FLOSUM_COMPONENT','createPatchRequest','prepareComponentRecord'];a229_0x4e8a=function(){return _0x5ec45f;};return a229_0x4e8a();}a229_0x388422();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x12a718){const _0x176621=a229_0x53ff;return _0x12a718&&_0x12a718[_0x176621(0x10f)]?_0x12a718:{'default':_0x12a718};};Object[a229_0x8c9423(0x128)](exports,a229_0x8c9423(0x10f),{'value':!![]}),exports[a229_0x8c9423(0x15b)]=void 0x0;const constants_1=require(a229_0x8c9423(0xf6)),core_1=require(a229_0x8c9423(0x15a)),zip_1=require(a229_0x8c9423(0x137)),typedi_1=__importDefault(require(a229_0x8c9423(0x111))),salesforce_error_1=require(a229_0x8c9423(0x100)),composite_utils_1=require(a229_0x8c9423(0x153)),flosum_naming_utils_1=require(a229_0x8c9423(0x148)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');function a229_0x53ff(_0x3a0f2d,_0x5aa5b5){const _0x4d808f=a229_0x4e8a();return a229_0x53ff=function(_0x388422,_0x308357){_0x388422=_0x388422-0xf4;let _0x4e8a2c=_0x4d808f[_0x388422];return _0x4e8a2c;},a229_0x53ff(_0x3a0f2d,_0x5aa5b5);}class SalesforceComponentsManager{constructor(_0x1ba0dd,_0x127cea,_0x2d0fea,_0x50c0cc,_0x242620){const _0x16a333=a229_0x8c9423;this[_0x16a333(0x13e)]=_0x1ba0dd,this[_0x16a333(0x149)]=_0x127cea,this['username']=_0x2d0fea,this[_0x16a333(0x117)]=_0x50c0cc,this[_0x16a333(0x158)]=_0x242620,this[_0x16a333(0xf8)]=new core_1[(_0x16a333(0x133))](SalesforceComponentsManager[_0x16a333(0x10e)]),this[_0x16a333(0xf5)]=typedi_1[_0x16a333(0x10c)][_0x16a333(0x14f)](salesforce_git_sync_service_1[_0x16a333(0x109)]);}[a229_0x8c9423(0x156)](_0x193877,_0x14b2a1){const _0x22462a=a229_0x8c9423,_0x107084=(0x0,flosum_naming_utils_1[_0x22462a(0x131)])(_0x193877,[_0x22462a(0x134),_0x22462a(0x118),'Version__c']);this[_0x22462a(0x158)][_0x22462a(0x14a)]({'componentId':'','reference':_0x14b2a1,'version':_0x107084[_0x22462a(0x115)],'componentName':_0x107084[_0x22462a(0x118)],'componentType':_0x107084[_0x22462a(0x134)]});}[a229_0x8c9423(0x136)](_0x587d1a,_0x323b3e){const _0x299d4a=a229_0x8c9423,{request:_0xb3b0df}=(0x0,composite_utils_1[_0x299d4a(0x125)])(constants_1[_0x299d4a(0x15d)],{[constants_1[_0x299d4a(0x15c)]+'Commit__c']:_0x587d1a,[constants_1[_0x299d4a(0x15c)]+_0x299d4a(0x103)]:_0x323b3e});return _0xb3b0df;}async[a229_0x8c9423(0xfb)](_0x27de5a,_0x36ba2b){const _0x549fb7=a229_0x8c9423,_0x48e9ef={},_0x15a55e=zip_1[_0x549fb7(0x139)][_0x549fb7(0x121)]();for(const _0x41fdfc of Object[_0x549fb7(0x157)](_0x27de5a[_0x549fb7(0x119)])){_0x15a55e[_0x549fb7(0x11c)](_0x41fdfc,_0x27de5a[_0x549fb7(0x119)][_0x41fdfc],{'createFolders':!![]});}return _0x48e9ef[_0x549fb7(0x12a)]=_0x549fb7(0x13d),_0x48e9ef['Name']=_0x27de5a[_0x549fb7(0x159)],_0x48e9ef[_0x549fb7(0x124)]=_0x27de5a[_0x549fb7(0x159)],_0x48e9ef['ParentId']=_0x36ba2b,_0x48e9ef['Body']=await _0x15a55e[_0x549fb7(0x152)]({'type':_0x549fb7(0x147),'compression':_0x549fb7(0x101),'compressionOptions':{'level':0x6}}),_0x48e9ef;}['prepareComponentHistoryRecord'](_0xc2e6a1,_0x24c00b,_0x1943c5){const _0x1d18f1=a229_0x8c9423,_0x439790=new Date()[_0x1d18f1(0x12f)](),_0x260af9={};return _0x260af9[constants_1[_0x1d18f1(0x15c)]+'Component__c']=_0x24c00b,_0x260af9[constants_1[_0x1d18f1(0x15c)]+_0x1d18f1(0xf7)]=_0xc2e6a1[_0x1d18f1(0x11b)],_0x260af9[constants_1['FLOSUM_NAMESPACE']+_0x1d18f1(0x113)]=_0x439790,_0x260af9[constants_1[_0x1d18f1(0x15c)]+'Changed_By__c']=this['username'],_0x260af9[constants_1[_0x1d18f1(0x15c)]+_0x1d18f1(0x115)]=_0x1943c5?_0x1943c5+0x1:0x1,_0x260af9[constants_1[_0x1d18f1(0x129)]+_0x1d18f1(0x10d)]=!![],_0x260af9;}[a229_0x8c9423(0x14e)](_0x330b52,_0x3c8ec3){const _0x35b4cc=a229_0x8c9423;var _0x3eaf25,_0x1a0c0f;const _0x4dbd3c=new Date()[_0x35b4cc(0x12f)](),_0x28fd3d={};return!_0x3c8ec3?(this[_0x35b4cc(0x149)]?(_0x28fd3d[constants_1['FLOSUM_NAMESPACE']+'Branch__c']=this[_0x35b4cc(0x149)],_0x28fd3d[constants_1['FLOSUM_NAMESPACE']+'Source__c']=_0x35b4cc(0x154),_0x28fd3d[_0x35b4cc(0x110)]=(_0x3eaf25=this[_0x35b4cc(0x117)][_0x35b4cc(0x13a)](_0x24fe66=>_0x24fe66[_0x35b4cc(0x10e)]===_0x35b4cc(0x154)))===null||_0x3eaf25===void 0x0?void 0x0:_0x3eaf25['id']):(_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0x104)]=this['repositoryId'],_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0xff)]='Repository',_0x28fd3d[_0x35b4cc(0x110)]=(_0x1a0c0f=this[_0x35b4cc(0x117)]['find'](_0x24d358=>_0x24d358[_0x35b4cc(0x10e)]===_0x35b4cc(0x102)))===null||_0x1a0c0f===void 0x0?void 0x0:_0x1a0c0f['id']),_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0x115)]=0x1):_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0x115)]=_0x3c8ec3[_0x35b4cc(0x106)]+0x1,_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+'Component_Type__c']=_0x330b52['type'],_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0x118)]=_0x330b52[_0x35b4cc(0x10e)],_0x28fd3d[constants_1['FLOSUM_NAMESPACE']+_0x35b4cc(0x13f)]=_0x330b52[_0x35b4cc(0x108)],_0x28fd3d[constants_1['FLOSUM_NAMESPACE']+_0x35b4cc(0x127)]=this[_0x35b4cc(0x10b)],_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0x146)]=this['username'],_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0x107)]=_0x4dbd3c,_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0xfc)]=_0x4dbd3c,_0x28fd3d[constants_1[_0x35b4cc(0x15c)]+_0x35b4cc(0xf7)]=_0x330b52[_0x35b4cc(0x11b)],_0x28fd3d;}[a229_0x8c9423(0x126)](){const _0x2c621d=a229_0x8c9423;return this[_0x2c621d(0x158)];}async[a229_0x8c9423(0x10a)](_0x3f59fe,_0x1f901a){const _0x2bdd71=a229_0x8c9423,_0x293a38=[];for(const _0x415d5c of _0x3f59fe){const _0x1a523d=(0x0,composite_utils_1[_0x2bdd71(0x125)])(constants_1[_0x2bdd71(0x14c)],this['prepareComponentRecord'](_0x415d5c)),_0x2bebb1=(0x0,composite_utils_1[_0x2bdd71(0x125)])(constants_1[_0x2bdd71(0x13c)],this['prepareComponentHistoryRecord'](_0x415d5c,'@{'+_0x1a523d[_0x2bdd71(0x12d)]+'.id}')),_0x2f76ea=(0x0,composite_utils_1[_0x2bdd71(0x125)])(constants_1[_0x2bdd71(0x11d)],await this['prepareComponentAttachmentRecord'](_0x415d5c,'@{'+_0x2bebb1['reference']+_0x2bdd71(0x11f)));this['proceedComponentMeta'](_0x1a523d[_0x2bdd71(0xf4)][_0x2bdd71(0x138)],_0x1a523d[_0x2bdd71(0x12d)]),_0x293a38[_0x2bdd71(0x14a)](_0x1a523d[_0x2bdd71(0xf4)],_0x2bebb1[_0x2bdd71(0xf4)],_0x2f76ea['request']),_0x1f901a&&_0x293a38[_0x2bdd71(0x14a)](this[_0x2bdd71(0x136)](_0x1f901a,'@{'+_0x2bebb1[_0x2bdd71(0x12d)]+_0x2bdd71(0x11f)));}return _0x293a38;}async[a229_0x8c9423(0x132)](_0x166cff,_0x2cc190=''){const _0xf08f9d=a229_0x8c9423,_0x2a116d=[];for(const {component:_0xad7dbc,meta:_0x369601}of _0x166cff){if(!_0x369601['id']){const _0x76533b=this[_0xf08f9d(0x158)][_0xf08f9d(0x13a)](_0x5e3d24=>_0x5e3d24['componentName']===_0xad7dbc['name']&&_0x5e3d24[_0xf08f9d(0x11e)]===_0xad7dbc[_0xf08f9d(0x159)]);if(!_0x76533b)throw new salesforce_error_1[(_0xf08f9d(0x116))](new Error('Could\x20not\x20proceed\x20component\x20'+_0xad7dbc[_0xf08f9d(0x10e)]+'\x20['+_0xad7dbc[_0xf08f9d(0x159)]+_0xf08f9d(0x13b)));_0x369601['id']=_0x76533b['componentId'];}const _0xc9a9a=(0x0,composite_utils_1[_0xf08f9d(0x14d)])(constants_1['FLOSUM_COMPONENT'],_0x369601['id'],this[_0xf08f9d(0x14e)](_0xad7dbc,_0x369601)),_0x5234d7=(0x0,composite_utils_1[_0xf08f9d(0x125)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0xf08f9d(0x14b)](_0xad7dbc,_0x369601['id'],_0x369601['version'])),_0x30aba6=(0x0,composite_utils_1[_0xf08f9d(0x125)])(constants_1[_0xf08f9d(0x11d)],await this[_0xf08f9d(0xfb)](_0xad7dbc,'@{'+_0x5234d7[_0xf08f9d(0x12d)]+_0xf08f9d(0x11f)));this[_0xf08f9d(0x156)](_0xc9a9a[_0xf08f9d(0xf4)]['body'],_0xc9a9a[_0xf08f9d(0x12d)]),_0x2a116d['push'](_0xc9a9a[_0xf08f9d(0xf4)],_0x5234d7[_0xf08f9d(0xf4)],_0x30aba6[_0xf08f9d(0xf4)]),_0x2cc190&&_0x2a116d['push'](this['prepareCommitManifest'](_0x2cc190,'@{'+_0x5234d7[_0xf08f9d(0x12d)]+'.id}'));}return _0x2a116d;}async[a229_0x8c9423(0x145)](_0x4778fa,_0x6b9dfa=![]){const _0x255d38=a229_0x8c9423,_0x15923e={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x164946=[];for(const _0x34dd12 of _0x4778fa){if(_0x34dd12['id'])_0x164946[_0x255d38(0x14a)](_0x34dd12['id']);else{const _0x531e36=this['proceededComponentsMeta']['find'](_0x42a170=>_0x42a170[_0x255d38(0x120)]===_0x34dd12[_0x255d38(0x10e)]&&_0x42a170['componentType']===_0x34dd12[_0x255d38(0x159)]);if(!_0x531e36||!_0x531e36['componentId'])continue;_0x164946[_0x255d38(0x14a)](_0x531e36[_0x255d38(0x12e)]);}}if(_0x6b9dfa){const _0x4edbe4=await this['gitSync'][_0x255d38(0x140)](_0x164946);_0x15923e[_0x255d38(0x151)]=_0x4edbe4[_0x255d38(0x12b)](_0x4a1dd1=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1['FLOSUM_COMMIT_MANIFEST'],_0x4a1dd1)['request']);}return _0x15923e[_0x255d38(0x122)]=_0x164946['map'](_0x1b4bb7=>(0x0,composite_utils_1[_0x255d38(0x14d)])(constants_1['FLOSUM_COMPONENT'],_0x1b4bb7,{[constants_1[_0x255d38(0x129)]+_0x255d38(0xf9)]:!![]})[_0x255d38(0xf4)]),_0x15923e[_0x255d38(0x155)]=_0x164946[_0x255d38(0x12b)](_0xf58f22=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1[_0x255d38(0x14c)],_0xf58f22)['request']),_0x15923e;}}exports['SalesforceComponentsManager']=SalesforceComponentsManager;