const a234_0x2b48fa=a234_0x10fb;(function(_0x30246d,_0x5a90e3){const _0xb1d924=a234_0x10fb,_0x4ce25d=_0x30246d();while(!![]){try{const _0x12349e=parseInt(_0xb1d924(0x152))/0x1*(parseInt(_0xb1d924(0x174))/0x2)+-parseInt(_0xb1d924(0x19d))/0x3*(-parseInt(_0xb1d924(0x198))/0x4)+-parseInt(_0xb1d924(0x18b))/0x5*(-parseInt(_0xb1d924(0x167))/0x6)+-parseInt(_0xb1d924(0x187))/0x7+-parseInt(_0xb1d924(0x15f))/0x8*(-parseInt(_0xb1d924(0x13e))/0x9)+-parseInt(_0xb1d924(0x16c))/0xa*(parseInt(_0xb1d924(0x166))/0xb)+parseInt(_0xb1d924(0x18f))/0xc;if(_0x12349e===_0x5a90e3)break;else _0x4ce25d['push'](_0x4ce25d['shift']());}catch(_0x559fcd){_0x4ce25d['push'](_0x4ce25d['shift']());}}}(a234_0x1f5b,0xbf0e3));function a234_0x10fb(_0x112746,_0x590b6c){const _0x18a715=a234_0x1f5b();return a234_0x10fb=function(_0x3e7fd4,_0x2d065a){_0x3e7fd4=_0x3e7fd4-0x13a;let _0x1f5b28=_0x18a715[_0x3e7fd4];return _0x1f5b28;},a234_0x10fb(_0x112746,_0x590b6c);}const a234_0x2d065a=(function(){let _0x266b6c=!![];return function(_0x35ef82,_0x4163f9){const _0x3ca9ac=_0x266b6c?function(){const _0x36097d=a234_0x10fb;if(_0x4163f9){const _0x22e063=_0x4163f9[_0x36097d(0x13b)](_0x35ef82,arguments);return _0x4163f9=null,_0x22e063;}}:function(){};return _0x266b6c=![],_0x3ca9ac;};}()),a234_0x3e7fd4=a234_0x2d065a(this,function(){const _0x2c9490=a234_0x10fb;return a234_0x3e7fd4[_0x2c9490(0x172)]()[_0x2c9490(0x156)](_0x2c9490(0x161))['toString']()[_0x2c9490(0x194)](a234_0x3e7fd4)[_0x2c9490(0x156)]('(((.+)+)+)+$');});a234_0x3e7fd4();'use strict';var __importDefault=this&&this[a234_0x2b48fa(0x14f)]||function(_0x5e773d){const _0x1933b2=a234_0x2b48fa;return _0x5e773d&&_0x5e773d[_0x1933b2(0x19f)]?_0x5e773d:{'default':_0x5e773d};};function a234_0x1f5b(){const _0x31d407=['Vlocity_Component_Name__c','CRC32__c','Source__c','toISOString','RecordTypeId','createPostRequest','ParentId','813464ptjjZX','proceededComponentsMeta','(((.+)+)+)+$','Last_Modified_By__c','type','fetchCommitManifestsByComponentIds','push','198qbtKIO','12XvKvLu','manifests','Component_Name__c','Repository__c','DEFLATE','61330rjVLzi','update','ContentType','get','Could\x20not\x20proceed\x20component\x20','componentId','toString','reference','30550QSyOEh','logger','.id}','base64','Logger','proceedComponentMeta','componentsToUpdate','map','generateAsync','isVlocityComponent','componentType','application/zip','prepareCommitManifest','find','FLOSUM_COMPONENT','insert','createZip','name','defineProperty','8276786oQITeC','recordTypes','filePath','Deletion_By_Agent__c','367425NpXIiN','Repository','createDeleteRequest','file','7319484bHvCzi','FLOSUM_ATTACHMENT','Component_History__c','repositoryId','../../../../constants','constructor','prepareComponentRecord','Last_Modified_Date__c','prepareComponentHistoryRecord','4HVLJvt','username','branchId','File_Name__c','extractFieldsFromRecord','748887QbVJEM','Component_Type__c','__esModule','crc','../utils/flosum-naming.utils','Committed_On__c','apply','Version__c','gitSync','27TLBNgl','Name','../../../../core','FLOSUM_GIT_NAMESPACE','createPatchRequest','Branch','request','Zip','FLOSUM_NAMESPACE','../errors/salesforce.error','prepareComponentAttachmentRecord','Branch__c','../utils/composite.utils','../../parsers/utils/zip','componentName',']\x20-\x20meta\x20not\x20found','Last_Updated_By__c','__importDefault','FLOSUM_COMMIT_MANIFEST','typedi','50ELvtfg','default','Commit__c','Changed_By__c','search','body'];a234_0x1f5b=function(){return _0x31d407;};return a234_0x1f5b();}Object[a234_0x2b48fa(0x186)](exports,a234_0x2b48fa(0x19f),{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;const constants_1=require(a234_0x2b48fa(0x193)),core_1=require(a234_0x2b48fa(0x140)),zip_1=require(a234_0x2b48fa(0x14b)),typedi_1=__importDefault(require(a234_0x2b48fa(0x151))),salesforce_error_1=require(a234_0x2b48fa(0x147)),composite_utils_1=require(a234_0x2b48fa(0x14a)),flosum_naming_utils_1=require(a234_0x2b48fa(0x1a1)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceComponentsManager{constructor(_0x514937,_0x5065a7,_0x5000a7,_0x4a5ea6,_0x2837a3){const _0xc9658d=a234_0x2b48fa;this['repositoryId']=_0x514937,this[_0xc9658d(0x19a)]=_0x5065a7,this['username']=_0x5000a7,this[_0xc9658d(0x188)]=_0x4a5ea6,this[_0xc9658d(0x160)]=_0x2837a3,this[_0xc9658d(0x175)]=new core_1[(_0xc9658d(0x178))](SalesforceComponentsManager[_0xc9658d(0x185)]),this[_0xc9658d(0x13d)]=typedi_1[_0xc9658d(0x153)][_0xc9658d(0x16f)](salesforce_git_sync_service_1['SalesforceGitSyncService']);}['proceedComponentMeta'](_0x3cdb66,_0xb3b130){const _0x12cdf8=a234_0x2b48fa,_0x1afed0=(0x0,flosum_naming_utils_1[_0x12cdf8(0x19c)])(_0x3cdb66,[_0x12cdf8(0x19e),'Component_Name__c',_0x12cdf8(0x13c)]);this[_0x12cdf8(0x160)][_0x12cdf8(0x165)]({'componentId':'','reference':_0xb3b130,'version':_0x1afed0[_0x12cdf8(0x13c)],'componentName':_0x1afed0[_0x12cdf8(0x169)],'componentType':_0x1afed0[_0x12cdf8(0x19e)]});}[a234_0x2b48fa(0x180)](_0x2e4f52,_0x355c68){const _0x49dc09=a234_0x2b48fa,{request:_0x5ed8c6}=(0x0,composite_utils_1[_0x49dc09(0x15d)])(constants_1[_0x49dc09(0x150)],{[constants_1[_0x49dc09(0x146)]+_0x49dc09(0x154)]:_0x2e4f52,[constants_1['FLOSUM_NAMESPACE']+_0x49dc09(0x191)]:_0x355c68});return _0x5ed8c6;}async[a234_0x2b48fa(0x148)](_0x4dfa90,_0x590e82){const _0x247bb5=a234_0x2b48fa,_0x3f6a96={},_0x4c85aa=zip_1[_0x247bb5(0x145)][_0x247bb5(0x184)]();for(const _0xe68398 of Object['keys'](_0x4dfa90['files'])){_0x4c85aa[_0x247bb5(0x18e)](_0xe68398,_0x4dfa90['files'][_0xe68398],{'createFolders':!![]});}return _0x3f6a96[_0x247bb5(0x16e)]=_0x247bb5(0x17f),_0x3f6a96[_0x247bb5(0x13f)]=_0x4dfa90['type'],_0x3f6a96['Description']=_0x4dfa90['type'],_0x3f6a96[_0x247bb5(0x15e)]=_0x590e82,_0x3f6a96['Body']=await _0x4c85aa[_0x247bb5(0x17c)]({'type':_0x247bb5(0x177),'compression':_0x247bb5(0x16b),'compressionOptions':{'level':0x6}}),_0x3f6a96;}[a234_0x2b48fa(0x197)](_0x1a402c,_0x45ea73,_0x576cf0){const _0x972a17=a234_0x2b48fa,_0x4dca23=new Date()[_0x972a17(0x15b)](),_0x3a9532={};return _0x3a9532[constants_1[_0x972a17(0x146)]+'Component__c']=_0x45ea73,_0x3a9532[constants_1[_0x972a17(0x146)]+_0x972a17(0x159)]=_0x1a402c[_0x972a17(0x1a0)],_0x3a9532[constants_1[_0x972a17(0x146)]+'Changed_On__c']=_0x4dca23,_0x3a9532[constants_1[_0x972a17(0x146)]+_0x972a17(0x155)]=this[_0x972a17(0x199)],_0x3a9532[constants_1[_0x972a17(0x146)]+_0x972a17(0x13c)]=_0x576cf0?_0x576cf0+0x1:0x1,_0x3a9532[constants_1[_0x972a17(0x141)]+'Is_From_Agent__c']=!![],_0x3a9532;}['prepareComponentRecord'](_0x3adb73,_0x52a284){const _0x5027d6=a234_0x2b48fa;var _0xae9f1c,_0x2bcebf;const _0x331637=new Date()[_0x5027d6(0x15b)](),_0x352fbe={};return!_0x52a284?(this[_0x5027d6(0x19a)]?(_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x149)]=this['branchId'],_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x15a)]=_0x5027d6(0x143),_0x352fbe[_0x5027d6(0x15c)]=(_0xae9f1c=this[_0x5027d6(0x188)][_0x5027d6(0x181)](_0x4b45f3=>_0x4b45f3[_0x5027d6(0x185)]===_0x5027d6(0x143)))===null||_0xae9f1c===void 0x0?void 0x0:_0xae9f1c['id']):(_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x16a)]=this[_0x5027d6(0x192)],_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x15a)]=_0x5027d6(0x18c),_0x352fbe[_0x5027d6(0x15c)]=(_0x2bcebf=this['recordTypes'][_0x5027d6(0x181)](_0x39b698=>_0x39b698[_0x5027d6(0x185)]===_0x5027d6(0x18c)))===null||_0x2bcebf===void 0x0?void 0x0:_0x2bcebf['id']),_0x352fbe[constants_1['FLOSUM_NAMESPACE']+'Version__c']=0x1):_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x13c)]=_0x52a284['version']+0x1,_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x19e)]=_0x3adb73[_0x5027d6(0x163)],_0x352fbe[constants_1['FLOSUM_NAMESPACE']+'Component_Name__c']=_0x3adb73[_0x5027d6(0x185)],_0x352fbe[constants_1['FLOSUM_NAMESPACE']+_0x5027d6(0x19b)]=_0x3adb73[_0x5027d6(0x189)],_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x14e)]=this[_0x5027d6(0x199)],_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x162)]=this[_0x5027d6(0x199)],_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x196)]=_0x331637,_0x352fbe[constants_1[_0x5027d6(0x146)]+_0x5027d6(0x13a)]=_0x331637,_0x352fbe[constants_1['FLOSUM_NAMESPACE']+_0x5027d6(0x159)]=_0x3adb73[_0x5027d6(0x1a0)],_0x352fbe[constants_1['FLOSUM_NAMESPACE']+_0x5027d6(0x158)]=_0x3adb73['vlocityComponentName'],_0x352fbe[constants_1[_0x5027d6(0x146)]+'Vlocity_Component__c']=_0x3adb73[_0x5027d6(0x17d)],_0x352fbe;}['getProceededComponentsMeta'](){const _0xd3fb12=a234_0x2b48fa;return this[_0xd3fb12(0x160)];}async[a234_0x2b48fa(0x183)](_0x3a6401,_0x22edda){const _0xa948bd=a234_0x2b48fa,_0x47e089=[];for(const _0x169b25 of _0x3a6401){const _0x56680f=(0x0,composite_utils_1[_0xa948bd(0x15d)])(constants_1[_0xa948bd(0x182)],this[_0xa948bd(0x195)](_0x169b25)),_0x20a6f2=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0xa948bd(0x197)](_0x169b25,'@{'+_0x56680f[_0xa948bd(0x173)]+'.id}')),_0x5c7e36=(0x0,composite_utils_1[_0xa948bd(0x15d)])(constants_1[_0xa948bd(0x190)],await this[_0xa948bd(0x148)](_0x169b25,'@{'+_0x20a6f2[_0xa948bd(0x173)]+_0xa948bd(0x176)));this[_0xa948bd(0x179)](_0x56680f['request']['body'],_0x56680f[_0xa948bd(0x173)]),_0x47e089[_0xa948bd(0x165)](_0x56680f[_0xa948bd(0x144)],_0x20a6f2[_0xa948bd(0x144)],_0x5c7e36[_0xa948bd(0x144)]),_0x22edda&&_0x47e089[_0xa948bd(0x165)](this['prepareCommitManifest'](_0x22edda,'@{'+_0x20a6f2[_0xa948bd(0x173)]+'.id}'));}return _0x47e089;}async[a234_0x2b48fa(0x16d)](_0x101f6f,_0x119c04=''){const _0x11d7c2=a234_0x2b48fa,_0x433ee2=[];for(const {component:_0x2be03a,meta:_0x246296}of _0x101f6f){if(!_0x246296['id']){const _0x212da3=this[_0x11d7c2(0x160)][_0x11d7c2(0x181)](_0xae89fc=>_0xae89fc[_0x11d7c2(0x14c)]===_0x2be03a[_0x11d7c2(0x185)]&&_0xae89fc[_0x11d7c2(0x17e)]===_0x2be03a['type']);if(!_0x212da3)throw new salesforce_error_1['SalesforceError'](new Error(_0x11d7c2(0x170)+_0x2be03a[_0x11d7c2(0x185)]+'\x20['+_0x2be03a[_0x11d7c2(0x163)]+_0x11d7c2(0x14d)));_0x246296['id']=_0x212da3['componentId'];}const _0x506248=(0x0,composite_utils_1[_0x11d7c2(0x142)])(constants_1['FLOSUM_COMPONENT'],_0x246296['id'],this[_0x11d7c2(0x195)](_0x2be03a,_0x246296)),_0x1386d8=(0x0,composite_utils_1[_0x11d7c2(0x15d)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x11d7c2(0x197)](_0x2be03a,_0x246296['id'],_0x246296['version'])),_0xafbafd=(0x0,composite_utils_1[_0x11d7c2(0x15d)])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x11d7c2(0x148)](_0x2be03a,'@{'+_0x1386d8[_0x11d7c2(0x173)]+'.id}'));this[_0x11d7c2(0x179)](_0x506248[_0x11d7c2(0x144)][_0x11d7c2(0x157)],_0x506248[_0x11d7c2(0x173)]),_0x433ee2[_0x11d7c2(0x165)](_0x506248['request'],_0x1386d8[_0x11d7c2(0x144)],_0xafbafd[_0x11d7c2(0x144)]),_0x119c04&&_0x433ee2[_0x11d7c2(0x165)](this['prepareCommitManifest'](_0x119c04,'@{'+_0x1386d8[_0x11d7c2(0x173)]+_0x11d7c2(0x176)));}return _0x433ee2;}async['delete'](_0xb73197,_0x115d4b=![]){const _0x3369b4=a234_0x2b48fa,_0x3180bb={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0xcf7354=[];for(const _0x2a027e of _0xb73197){if(_0x2a027e['id'])_0xcf7354['push'](_0x2a027e['id']);else{const _0x298c65=this[_0x3369b4(0x160)][_0x3369b4(0x181)](_0x183716=>_0x183716['componentName']===_0x2a027e[_0x3369b4(0x185)]&&_0x183716[_0x3369b4(0x17e)]===_0x2a027e['type']);if(!_0x298c65||!_0x298c65[_0x3369b4(0x171)])continue;_0xcf7354[_0x3369b4(0x165)](_0x298c65['componentId']);}}if(_0x115d4b){const _0x4ff129=await this[_0x3369b4(0x13d)][_0x3369b4(0x164)](_0xcf7354);_0x3180bb[_0x3369b4(0x168)]=_0x4ff129['map'](_0x3cc366=>(0x0,composite_utils_1[_0x3369b4(0x18d)])(constants_1[_0x3369b4(0x150)],_0x3cc366)[_0x3369b4(0x144)]);}return _0x3180bb[_0x3369b4(0x17a)]=_0xcf7354[_0x3369b4(0x17b)](_0x14c366=>(0x0,composite_utils_1[_0x3369b4(0x142)])(constants_1[_0x3369b4(0x182)],_0x14c366,{[constants_1[_0x3369b4(0x141)]+_0x3369b4(0x18a)]:!![]})['request']),_0x3180bb['componentsToDelete']=_0xcf7354[_0x3369b4(0x17b)](_0x5d8fb6=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1['FLOSUM_COMPONENT'],_0x5d8fb6)[_0x3369b4(0x144)]),_0x3180bb;}}exports['SalesforceComponentsManager']=SalesforceComponentsManager;