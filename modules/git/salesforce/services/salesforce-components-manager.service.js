const a229_0x5adea4=a229_0x3c15;(function(_0x451922,_0x11bda8){const _0x5e5bf9=a229_0x3c15,_0x3df336=_0x451922();while(!![]){try{const _0x2bda71=-parseInt(_0x5e5bf9(0xba))/0x1+parseInt(_0x5e5bf9(0x8d))/0x2*(parseInt(_0x5e5bf9(0x8a))/0x3)+-parseInt(_0x5e5bf9(0xbf))/0x4+-parseInt(_0x5e5bf9(0xd6))/0x5*(-parseInt(_0x5e5bf9(0xde))/0x6)+-parseInt(_0x5e5bf9(0xe7))/0x7+parseInt(_0x5e5bf9(0xe0))/0x8*(parseInt(_0x5e5bf9(0xa6))/0x9)+parseInt(_0x5e5bf9(0xe4))/0xa;if(_0x2bda71===_0x11bda8)break;else _0x3df336['push'](_0x3df336['shift']());}catch(_0x15e806){_0x3df336['push'](_0x3df336['shift']());}}}(a229_0x1870,0xf0ea5));function a229_0x1870(){const _0x4307ae=['typedi','CRC32__c','.id}','1838697uMIgEt','branchId','createZip','FLOSUM_ATTACHMENT','Source__c','6071660LhgRHu','FLOSUM_NAMESPACE','__esModule','filePath','Could\x20not\x20proceed\x20component\x20','find','fetchCommitManifestsByComponentIds','prepareComponentHistoryRecord','createPatchRequest','FLOSUM_COMMIT_MANIFEST','../utils/flosum-naming.utils','username','componentName','prepareComponentRecord','../../../../constants','Component_History__c','Version__c','repositoryId','FLOSUM_GIT_NAMESPACE','../utils/composite.utils','Last_Modified_Date__c','FLOSUM_COMPONENT_HISTORY','ParentId','5415425BVkHrl','__importDefault','name','Component__c','apply','version','Component_Type__c','SalesforceComponentsManager','6bwOxrc','Changed_On__c','183936DvtpGw','extractFieldsFromRecord','Last_Modified_By__c','proceedComponentMeta','23095250hofkPx','generateAsync','RecordTypeId','1017905TjnFkF','./salesforce-git-sync.service','proceededComponentsMeta','body','ContentType','search','../../parsers/utils/zip','Repository','Commit__c','126IhqLpc','../../../../core','keys','46726YPvcIe','insert','Body','push','map','get','Deletion_By_Agent__c','crc','toString','request','createDeleteRequest',']\x20-\x20meta\x20not\x20found','gitSync','update','getProceededComponentsMeta','recordTypes','Branch__c','componentsToDelete','files','SalesforceError','DEFLATE','Component_Name__c','prepareCommitManifest','delete','toISOString','45RvHzAI','prepareComponentAttachmentRecord','Branch','(((.+)+)+)+$','defineProperty','Zip','Is_From_Agent__c','reference','createPostRequest','FLOSUM_COMPONENT','base64','type','Last_Updated_By__c','componentType','file','componentId','Logger'];a229_0x1870=function(){return _0x4307ae;};return a229_0x1870();}const a229_0x2b214a=(function(){let _0x16b0a6=!![];return function(_0x26462b,_0x1bad4e){const _0x124638=_0x16b0a6?function(){const _0x20e6f0=a229_0x3c15;if(_0x1bad4e){const _0x6140ef=_0x1bad4e[_0x20e6f0(0xda)](_0x26462b,arguments);return _0x1bad4e=null,_0x6140ef;}}:function(){};return _0x16b0a6=![],_0x124638;};}()),a229_0x4765e4=a229_0x2b214a(this,function(){const _0x2ddfa4=a229_0x3c15;return a229_0x4765e4['toString']()[_0x2ddfa4(0x86)]('(((.+)+)+)+$')[_0x2ddfa4(0x95)]()['constructor'](a229_0x4765e4)[_0x2ddfa4(0x86)](_0x2ddfa4(0xa9));});function a229_0x3c15(_0x27f23f,_0xd96315){const _0x2403f0=a229_0x1870();return a229_0x3c15=function(_0x4765e4,_0x2b214a){_0x4765e4=_0x4765e4-0x83;let _0x1870c7=_0x2403f0[_0x4765e4];return _0x1870c7;},a229_0x3c15(_0x27f23f,_0xd96315);}a229_0x4765e4();'use strict';var __importDefault=this&&this[a229_0x5adea4(0xd7)]||function(_0x1b5278){const _0x2a101e=a229_0x5adea4;return _0x1b5278&&_0x1b5278[_0x2a101e(0xc1)]?_0x1b5278:{'default':_0x1b5278};};Object[a229_0x5adea4(0xaa)](exports,a229_0x5adea4(0xc1),{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;const constants_1=require(a229_0x5adea4(0xcd)),core_1=require(a229_0x5adea4(0x8b)),zip_1=require(a229_0x5adea4(0x87)),typedi_1=__importDefault(require(a229_0x5adea4(0xb7))),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a229_0x5adea4(0xd2)),flosum_naming_utils_1=require(a229_0x5adea4(0xc9)),salesforce_git_sync_service_1=require(a229_0x5adea4(0xe8));class SalesforceComponentsManager{constructor(_0x218fe9,_0x2890ce,_0x3bbc99,_0x35f777,_0x7db851){const _0x30dacb=a229_0x5adea4;this[_0x30dacb(0xd0)]=_0x218fe9,this['branchId']=_0x2890ce,this[_0x30dacb(0xca)]=_0x3bbc99,this[_0x30dacb(0x9c)]=_0x35f777,this[_0x30dacb(0x83)]=_0x7db851,this['logger']=new core_1[(_0x30dacb(0xb6))](SalesforceComponentsManager['name']),this[_0x30dacb(0x99)]=typedi_1['default'][_0x30dacb(0x92)](salesforce_git_sync_service_1['SalesforceGitSyncService']);}[a229_0x5adea4(0xe3)](_0x350499,_0x49a2ef){const _0xfe8944=a229_0x5adea4,_0x529daf=(0x0,flosum_naming_utils_1[_0xfe8944(0xe1)])(_0x350499,[_0xfe8944(0xdc),_0xfe8944(0xa2),_0xfe8944(0xcf)]);this['proceededComponentsMeta'][_0xfe8944(0x90)]({'componentId':'','reference':_0x49a2ef,'version':_0x529daf[_0xfe8944(0xcf)],'componentName':_0x529daf[_0xfe8944(0xa2)],'componentType':_0x529daf['Component_Type__c']});}[a229_0x5adea4(0xa3)](_0x43b3a4,_0x34cd54){const _0x5c8cf8=a229_0x5adea4,{request:_0x1c7fff}=(0x0,composite_utils_1[_0x5c8cf8(0xae)])(constants_1[_0x5c8cf8(0xc8)],{[constants_1['FLOSUM_NAMESPACE']+_0x5c8cf8(0x89)]:_0x43b3a4,[constants_1[_0x5c8cf8(0xc0)]+_0x5c8cf8(0xce)]:_0x34cd54});return _0x1c7fff;}async[a229_0x5adea4(0xa7)](_0x2d4161,_0x22afe7){const _0x27688d=a229_0x5adea4,_0x54bfe5={},_0x3addf3=zip_1[_0x27688d(0xab)][_0x27688d(0xbc)]();for(const _0x2a7c75 of Object[_0x27688d(0x8c)](_0x2d4161[_0x27688d(0x9f)])){_0x3addf3[_0x27688d(0xb4)](_0x2a7c75,_0x2d4161[_0x27688d(0x9f)][_0x2a7c75],{'createFolders':!![]});}return _0x54bfe5[_0x27688d(0x85)]='application/zip',_0x54bfe5['Name']=_0x2d4161['type'],_0x54bfe5['Description']=_0x2d4161[_0x27688d(0xb1)],_0x54bfe5[_0x27688d(0xd5)]=_0x22afe7,_0x54bfe5[_0x27688d(0x8f)]=await _0x3addf3[_0x27688d(0xe5)]({'type':_0x27688d(0xb0),'compression':_0x27688d(0xa1),'compressionOptions':{'level':0x6}}),_0x54bfe5;}[a229_0x5adea4(0xc6)](_0x92eb07,_0x37f264,_0x8088d0){const _0x56940b=a229_0x5adea4,_0x49ffb0=new Date()[_0x56940b(0xa5)](),_0x155aba={};return _0x155aba[constants_1['FLOSUM_NAMESPACE']+_0x56940b(0xd9)]=_0x37f264,_0x155aba[constants_1['FLOSUM_NAMESPACE']+_0x56940b(0xb8)]=_0x92eb07[_0x56940b(0x94)],_0x155aba[constants_1['FLOSUM_NAMESPACE']+_0x56940b(0xdf)]=_0x49ffb0,_0x155aba[constants_1[_0x56940b(0xc0)]+'Changed_By__c']=this[_0x56940b(0xca)],_0x155aba[constants_1[_0x56940b(0xc0)]+_0x56940b(0xcf)]=_0x8088d0?_0x8088d0+0x1:0x1,_0x155aba[constants_1[_0x56940b(0xd1)]+_0x56940b(0xac)]=!![],_0x155aba;}[a229_0x5adea4(0xcc)](_0x15b193,_0x58d0b4){const _0x7f6ec4=a229_0x5adea4;var _0x1b7003,_0x4d9bdd;const _0x1f38fd=new Date()['toISOString'](),_0x82e1f5={};return!_0x58d0b4?(this[_0x7f6ec4(0xbb)]?(_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0x9d)]=this[_0x7f6ec4(0xbb)],_0x82e1f5[constants_1['FLOSUM_NAMESPACE']+_0x7f6ec4(0xbe)]=_0x7f6ec4(0xa8),_0x82e1f5[_0x7f6ec4(0xe6)]=(_0x1b7003=this[_0x7f6ec4(0x9c)][_0x7f6ec4(0xc4)](_0x513b35=>_0x513b35[_0x7f6ec4(0xd8)]===_0x7f6ec4(0xa8)))===null||_0x1b7003===void 0x0?void 0x0:_0x1b7003['id']):(_0x82e1f5[constants_1['FLOSUM_NAMESPACE']+'Repository__c']=this['repositoryId'],_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0xbe)]=_0x7f6ec4(0x88),_0x82e1f5['RecordTypeId']=(_0x4d9bdd=this[_0x7f6ec4(0x9c)][_0x7f6ec4(0xc4)](_0x50797c=>_0x50797c[_0x7f6ec4(0xd8)]==='Repository'))===null||_0x4d9bdd===void 0x0?void 0x0:_0x4d9bdd['id']),_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0xcf)]=0x1):_0x82e1f5[constants_1['FLOSUM_NAMESPACE']+_0x7f6ec4(0xcf)]=_0x58d0b4[_0x7f6ec4(0xdb)]+0x1,_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0xdc)]=_0x15b193[_0x7f6ec4(0xb1)],_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+'Component_Name__c']=_0x15b193['name'],_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+'File_Name__c']=_0x15b193[_0x7f6ec4(0xc2)],_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0xb2)]=this[_0x7f6ec4(0xca)],_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0xe2)]=this[_0x7f6ec4(0xca)],_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0xd3)]=_0x1f38fd,_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+'Committed_On__c']=_0x1f38fd,_0x82e1f5[constants_1[_0x7f6ec4(0xc0)]+_0x7f6ec4(0xb8)]=_0x15b193['crc'],_0x82e1f5;}[a229_0x5adea4(0x9b)](){const _0x20cecc=a229_0x5adea4;return this[_0x20cecc(0x83)];}async[a229_0x5adea4(0x8e)](_0x33fe85,_0xb85d5f){const _0x33015a=a229_0x5adea4,_0xd2c66e=[];for(const _0x3ebfc9 of _0x33fe85){const _0x34edf0=(0x0,composite_utils_1[_0x33015a(0xae)])(constants_1[_0x33015a(0xaf)],this[_0x33015a(0xcc)](_0x3ebfc9)),_0x4327f6=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x33015a(0xd4)],this[_0x33015a(0xc6)](_0x3ebfc9,'@{'+_0x34edf0[_0x33015a(0xad)]+_0x33015a(0xb9))),_0x11df41=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x33015a(0xbd)],await this[_0x33015a(0xa7)](_0x3ebfc9,'@{'+_0x4327f6[_0x33015a(0xad)]+'.id}'));this[_0x33015a(0xe3)](_0x34edf0[_0x33015a(0x96)][_0x33015a(0x84)],_0x34edf0[_0x33015a(0xad)]),_0xd2c66e['push'](_0x34edf0['request'],_0x4327f6[_0x33015a(0x96)],_0x11df41[_0x33015a(0x96)]),_0xb85d5f&&_0xd2c66e['push'](this[_0x33015a(0xa3)](_0xb85d5f,'@{'+_0x4327f6[_0x33015a(0xad)]+_0x33015a(0xb9)));}return _0xd2c66e;}async[a229_0x5adea4(0x9a)](_0x5f5952,_0x2bf1ce=''){const _0x104315=a229_0x5adea4,_0x3c65f3=[];for(const {component:_0x4b5e2e,meta:_0x6edf8c}of _0x5f5952){if(!_0x6edf8c['id']){const _0x52f1f9=this['proceededComponentsMeta'][_0x104315(0xc4)](_0x111b8c=>_0x111b8c[_0x104315(0xcb)]===_0x4b5e2e[_0x104315(0xd8)]&&_0x111b8c[_0x104315(0xb3)]===_0x4b5e2e['type']);if(!_0x52f1f9)throw new salesforce_error_1[(_0x104315(0xa0))](new Error(_0x104315(0xc3)+_0x4b5e2e[_0x104315(0xd8)]+'\x20['+_0x4b5e2e['type']+_0x104315(0x98)));_0x6edf8c['id']=_0x52f1f9[_0x104315(0xb5)];}const _0xf76f5d=(0x0,composite_utils_1[_0x104315(0xc7)])(constants_1['FLOSUM_COMPONENT'],_0x6edf8c['id'],this[_0x104315(0xcc)](_0x4b5e2e,_0x6edf8c)),_0xdf7a05=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x104315(0xd4)],this[_0x104315(0xc6)](_0x4b5e2e,_0x6edf8c['id'],_0x6edf8c['version'])),_0x46ccfc=(0x0,composite_utils_1[_0x104315(0xae)])(constants_1[_0x104315(0xbd)],await this[_0x104315(0xa7)](_0x4b5e2e,'@{'+_0xdf7a05['reference']+_0x104315(0xb9)));this[_0x104315(0xe3)](_0xf76f5d['request'][_0x104315(0x84)],_0xf76f5d[_0x104315(0xad)]),_0x3c65f3[_0x104315(0x90)](_0xf76f5d['request'],_0xdf7a05[_0x104315(0x96)],_0x46ccfc['request']),_0x2bf1ce&&_0x3c65f3['push'](this[_0x104315(0xa3)](_0x2bf1ce,'@{'+_0xdf7a05[_0x104315(0xad)]+'.id}'));}return _0x3c65f3;}async[a229_0x5adea4(0xa4)](_0xa5dd0c,_0x5a7531=![]){const _0x34bc83=a229_0x5adea4,_0x5ed56d={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x4e4484=[];for(const _0x6474ea of _0xa5dd0c){if(_0x6474ea['id'])_0x4e4484[_0x34bc83(0x90)](_0x6474ea['id']);else{const _0x2395fe=this[_0x34bc83(0x83)]['find'](_0x29fc71=>_0x29fc71[_0x34bc83(0xcb)]===_0x6474ea[_0x34bc83(0xd8)]&&_0x29fc71[_0x34bc83(0xb3)]===_0x6474ea['type']);if(!_0x2395fe||!_0x2395fe[_0x34bc83(0xb5)])continue;_0x4e4484[_0x34bc83(0x90)](_0x2395fe[_0x34bc83(0xb5)]);}}if(_0x5a7531){const _0x2dc0b2=await this['gitSync'][_0x34bc83(0xc5)](_0x4e4484);_0x5ed56d['manifests']=_0x2dc0b2[_0x34bc83(0x91)](_0x3ce9fb=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1[_0x34bc83(0xc8)],_0x3ce9fb)[_0x34bc83(0x96)]);}return _0x5ed56d['componentsToUpdate']=_0x4e4484[_0x34bc83(0x91)](_0x1f4aa1=>(0x0,composite_utils_1[_0x34bc83(0xc7)])(constants_1['FLOSUM_COMPONENT'],_0x1f4aa1,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x34bc83(0x93)]:!![]})['request']),_0x5ed56d[_0x34bc83(0x9e)]=_0x4e4484[_0x34bc83(0x91)](_0xf04b7f=>(0x0,composite_utils_1[_0x34bc83(0x97)])(constants_1[_0x34bc83(0xaf)],_0xf04b7f)[_0x34bc83(0x96)]),_0x5ed56d;}}exports[a229_0x5adea4(0xdd)]=SalesforceComponentsManager;