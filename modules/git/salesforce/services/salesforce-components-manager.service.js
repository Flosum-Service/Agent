function a182_0x2a41(_0x47d2ae,_0x24bbb8){const _0x4bb70d=a182_0x586d();return a182_0x2a41=function(_0x49ef8e,_0x51c983){_0x49ef8e=_0x49ef8e-0xf9;let _0x586dc0=_0x4bb70d[_0x49ef8e];return _0x586dc0;},a182_0x2a41(_0x47d2ae,_0x24bbb8);}const a182_0x390446=a182_0x2a41;(function(_0x27af2f,_0x4c194d){const _0x3afcd4=a182_0x2a41,_0x3cf815=_0x27af2f();while(!![]){try{const _0x3e72f7=-parseInt(_0x3afcd4(0x138))/0x1+-parseInt(_0x3afcd4(0x114))/0x2+parseInt(_0x3afcd4(0x117))/0x3+-parseInt(_0x3afcd4(0x10e))/0x4*(parseInt(_0x3afcd4(0x125))/0x5)+-parseInt(_0x3afcd4(0x128))/0x6+-parseInt(_0x3afcd4(0x14b))/0x7*(-parseInt(_0x3afcd4(0x153))/0x8)+-parseInt(_0x3afcd4(0xfd))/0x9*(-parseInt(_0x3afcd4(0x113))/0xa);if(_0x3e72f7===_0x4c194d)break;else _0x3cf815['push'](_0x3cf815['shift']());}catch(_0xb51f35){_0x3cf815['push'](_0x3cf815['shift']());}}}(a182_0x586d,0x4206f));const a182_0x51c983=(function(){let _0x161845=!![];return function(_0x38c864,_0x2e9dee){const _0x39fa83=_0x161845?function(){const _0x8efe75=a182_0x2a41;if(_0x2e9dee){const _0x3629a7=_0x2e9dee[_0x8efe75(0x101)](_0x38c864,arguments);return _0x2e9dee=null,_0x3629a7;}}:function(){};return _0x161845=![],_0x39fa83;};}()),a182_0x49ef8e=a182_0x51c983(this,function(){const _0x17afbf=a182_0x2a41;return a182_0x49ef8e['toString']()[_0x17afbf(0x13d)](_0x17afbf(0x121))[_0x17afbf(0x156)]()[_0x17afbf(0x13b)](a182_0x49ef8e)[_0x17afbf(0x13d)](_0x17afbf(0x121));});a182_0x49ef8e();'use strict';var __importDefault=this&&this[a182_0x390446(0x13f)]||function(_0x351787){return _0x351787&&_0x351787['__esModule']?_0x351787:{'default':_0x351787};};function a182_0x586d(){const _0x216549=['../../parsers/utils/zip','(((.+)+)+)+$','body','Component__c','FLOSUM_COMMIT_MANIFEST','5rVgHEq','Deletion_By_Agent__c','get','2244432aJyTWL','../utils/flosum-naming.utils','branchId','default','Name','SalesforceGitSyncService','.id}','typedi','Repository__c','username','Body','Committed_On__c','name','defineProperty','createZip','ContentType','358783infhQX','crc','componentType','constructor','proceededComponentsMeta','search','keys','__importDefault','Changed_By__c','Source__c','proceedComponentMeta','Logger','Last_Updated_By__c','toISOString','Could\x20not\x20proceed\x20component\x20','createPostRequest','type','__esModule','Branch','5831EVkcbQ','createDeleteRequest','SalesforceError','Component_Type__c','fetchCommitManifestsByComponentIds','RecordTypeId','prepareComponentHistoryRecord','Zip','5000DpgNUC','update','generateAsync','toString','FLOSUM_GIT_NAMESPACE','Version__c',']\x20-\x20meta\x20not\x20found','manifests','map','Description','Component_Name__c','find','9086589MDxqzB','Is_From_Agent__c','prepareComponentAttachmentRecord','reference','apply','FLOSUM_NAMESPACE','SalesforceComponentsManager','application/zip','delete','Last_Modified_By__c','CRC32__c','componentId','FLOSUM_ATTACHMENT','Branch__c','componentsToDelete','createPatchRequest','push','918284pLjgSG','gitSync','extractFieldsFromRecord','prepareComponentRecord','files','10jSXjmD','1072268ZbskIF','Changed_On__c','FLOSUM_COMPONENT','716283qPLtcP','request','repositoryId','Component_History__c','Repository','../errors/salesforce.error','File_Name__c','prepareCommitManifest','recordTypes'];a182_0x586d=function(){return _0x216549;};return a182_0x586d();}Object[a182_0x390446(0x135)](exports,a182_0x390446(0x149),{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;const constants_1=require('../../../../constants'),core_1=require('../../../../core'),zip_1=require(a182_0x390446(0x120)),typedi_1=__importDefault(require(a182_0x390446(0x12f))),salesforce_error_1=require(a182_0x390446(0x11c)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a182_0x390446(0x129)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceComponentsManager{constructor(_0x1773f1,_0xcf763e,_0x30e1c5,_0x23cc79,_0xc617a7){const _0x1e84dd=a182_0x390446;this[_0x1e84dd(0x119)]=_0x1773f1,this[_0x1e84dd(0x12a)]=_0xcf763e,this[_0x1e84dd(0x131)]=_0x30e1c5,this[_0x1e84dd(0x11f)]=_0x23cc79,this[_0x1e84dd(0x13c)]=_0xc617a7,this['logger']=new core_1[(_0x1e84dd(0x143))](SalesforceComponentsManager['name']),this['gitSync']=typedi_1[_0x1e84dd(0x12b)][_0x1e84dd(0x127)](salesforce_git_sync_service_1[_0x1e84dd(0x12d)]);}[a182_0x390446(0x142)](_0x4c8deb,_0x41cb4f){const _0x25aaaf=a182_0x390446,_0x33a686=flosum_naming_utils_1[_0x25aaaf(0x110)](_0x4c8deb,[_0x25aaaf(0x14e),_0x25aaaf(0xfb),_0x25aaaf(0x158)]);this[_0x25aaaf(0x13c)]['push']({'componentId':'','reference':_0x41cb4f,'version':_0x33a686[_0x25aaaf(0x158)],'componentName':_0x33a686['Component_Name__c'],'componentType':_0x33a686[_0x25aaaf(0x14e)]});}[a182_0x390446(0x11e)](_0x4ea7f9,_0x2fe740){const _0x13725f=a182_0x390446,{request:_0x55db49}=composite_utils_1['createPostRequest'](constants_1[_0x13725f(0x124)],{[constants_1[_0x13725f(0x102)]+'Commit__c']:_0x4ea7f9,[constants_1[_0x13725f(0x102)]+_0x13725f(0x11a)]:_0x2fe740});return _0x55db49;}async['prepareComponentAttachmentRecord'](_0x51e928,_0x69fe2e){const _0x929be1=a182_0x390446,_0x2c012f={},_0x36c29d=zip_1[_0x929be1(0x152)][_0x929be1(0x136)]();for(const _0x32753f of Object[_0x929be1(0x13e)](_0x51e928[_0x929be1(0x112)])){_0x36c29d['file'](_0x32753f,_0x51e928[_0x929be1(0x112)][_0x32753f],{'createFolders':!![]});}return _0x2c012f[_0x929be1(0x137)]=_0x929be1(0x104),_0x2c012f[_0x929be1(0x12c)]=_0x51e928[_0x929be1(0x148)],_0x2c012f[_0x929be1(0xfa)]=_0x51e928[_0x929be1(0x148)],_0x2c012f['ParentId']=_0x69fe2e,_0x2c012f[_0x929be1(0x132)]=await _0x36c29d[_0x929be1(0x155)]({'type':'base64','compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x2c012f;}['prepareComponentHistoryRecord'](_0x335e63,_0x5b7d42,_0x30e6ea){const _0x289547=a182_0x390446,_0x5e7ba7=new Date()[_0x289547(0x145)](),_0x48e7e9={};return _0x48e7e9[constants_1[_0x289547(0x102)]+_0x289547(0x123)]=_0x5b7d42,_0x48e7e9[constants_1[_0x289547(0x102)]+_0x289547(0x107)]=_0x335e63[_0x289547(0x139)],_0x48e7e9[constants_1[_0x289547(0x102)]+_0x289547(0x115)]=_0x5e7ba7,_0x48e7e9[constants_1[_0x289547(0x102)]+_0x289547(0x140)]=this[_0x289547(0x131)],_0x48e7e9[constants_1[_0x289547(0x102)]+_0x289547(0x158)]=_0x30e6ea?_0x30e6ea+0x1:0x1,_0x48e7e9[constants_1[_0x289547(0x157)]+_0x289547(0xfe)]=!![],_0x48e7e9;}[a182_0x390446(0x111)](_0x2d8c60,_0x1cc470){const _0x118b41=a182_0x390446;var _0x8f7c12,_0x4c1cd3;const _0x219c58=new Date()[_0x118b41(0x145)](),_0x280388={};return!_0x1cc470?(this[_0x118b41(0x12a)]?(_0x280388[constants_1['FLOSUM_NAMESPACE']+_0x118b41(0x10a)]=this[_0x118b41(0x12a)],_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x141)]=_0x118b41(0x14a),_0x280388[_0x118b41(0x150)]=(_0x8f7c12=this['recordTypes'][_0x118b41(0xfc)](_0x3c88f0=>_0x3c88f0['name']===_0x118b41(0x14a)))===null||_0x8f7c12===void 0x0?void 0x0:_0x8f7c12['id']):(_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x130)]=this[_0x118b41(0x119)],_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x141)]='Repository',_0x280388[_0x118b41(0x150)]=(_0x4c1cd3=this[_0x118b41(0x11f)][_0x118b41(0xfc)](_0x2a71d6=>_0x2a71d6['name']===_0x118b41(0x11b)))===null||_0x4c1cd3===void 0x0?void 0x0:_0x4c1cd3['id']),_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x158)]=0x1):_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x158)]=_0x1cc470['version']+0x1,_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x14e)]=_0x2d8c60[_0x118b41(0x148)],_0x280388[constants_1[_0x118b41(0x102)]+'Component_Name__c']=_0x2d8c60[_0x118b41(0x134)],_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x11d)]=_0x2d8c60['filePath'],_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x144)]=this[_0x118b41(0x131)],_0x280388[constants_1[_0x118b41(0x102)]+_0x118b41(0x106)]=this[_0x118b41(0x131)],_0x280388[constants_1[_0x118b41(0x102)]+'Last_Modified_Date__c']=_0x219c58,_0x280388[constants_1['FLOSUM_NAMESPACE']+_0x118b41(0x133)]=_0x219c58,_0x280388[constants_1[_0x118b41(0x102)]+'CRC32__c']=_0x2d8c60['crc'],_0x280388;}['getProceededComponentsMeta'](){const _0x508c3a=a182_0x390446;return this[_0x508c3a(0x13c)];}async['insert'](_0x42ac79,_0x252164){const _0x17b9b3=a182_0x390446,_0x17ca46=[];for(const _0x123fc1 of _0x42ac79){const _0x59db1b=composite_utils_1[_0x17b9b3(0x147)](constants_1['FLOSUM_COMPONENT'],this[_0x17b9b3(0x111)](_0x123fc1)),_0x745842=composite_utils_1['createPostRequest'](constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x17b9b3(0x151)](_0x123fc1,'@{'+_0x59db1b[_0x17b9b3(0x100)]+'.id}')),_0x352fd9=composite_utils_1[_0x17b9b3(0x147)](constants_1['FLOSUM_ATTACHMENT'],await this['prepareComponentAttachmentRecord'](_0x123fc1,'@{'+_0x745842[_0x17b9b3(0x100)]+_0x17b9b3(0x12e)));this[_0x17b9b3(0x142)](_0x59db1b['request'][_0x17b9b3(0x122)],_0x59db1b[_0x17b9b3(0x100)]),_0x17ca46[_0x17b9b3(0x10d)](_0x59db1b[_0x17b9b3(0x118)],_0x745842[_0x17b9b3(0x118)],_0x352fd9[_0x17b9b3(0x118)]),_0x252164&&_0x17ca46[_0x17b9b3(0x10d)](this[_0x17b9b3(0x11e)](_0x252164,'@{'+_0x745842[_0x17b9b3(0x100)]+_0x17b9b3(0x12e)));}return _0x17ca46;}async[a182_0x390446(0x154)](_0x3d57f0,_0x51e464=''){const _0x2e2303=a182_0x390446,_0x1bd26b=[];for(const {component:_0x1e05ee,meta:_0x2f2cfb}of _0x3d57f0){if(!_0x2f2cfb['id']){const _0x49feef=this[_0x2e2303(0x13c)][_0x2e2303(0xfc)](_0x357a2e=>_0x357a2e['componentName']===_0x1e05ee[_0x2e2303(0x134)]&&_0x357a2e[_0x2e2303(0x13a)]===_0x1e05ee[_0x2e2303(0x148)]);if(!_0x49feef)throw new salesforce_error_1[(_0x2e2303(0x14d))](new Error(_0x2e2303(0x146)+_0x1e05ee[_0x2e2303(0x134)]+'\x20['+_0x1e05ee[_0x2e2303(0x148)]+_0x2e2303(0x159)));_0x2f2cfb['id']=_0x49feef[_0x2e2303(0x108)];}const _0x2d84c5=composite_utils_1[_0x2e2303(0x10c)](constants_1[_0x2e2303(0x116)],_0x2f2cfb['id'],this[_0x2e2303(0x111)](_0x1e05ee,_0x2f2cfb)),_0x2acf11=composite_utils_1[_0x2e2303(0x147)](constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x2e2303(0x151)](_0x1e05ee,_0x2f2cfb['id'],_0x2f2cfb['version'])),_0x3be648=composite_utils_1[_0x2e2303(0x147)](constants_1[_0x2e2303(0x109)],await this[_0x2e2303(0xff)](_0x1e05ee,'@{'+_0x2acf11[_0x2e2303(0x100)]+_0x2e2303(0x12e)));this[_0x2e2303(0x142)](_0x2d84c5['request'][_0x2e2303(0x122)],_0x2d84c5['reference']),_0x1bd26b['push'](_0x2d84c5[_0x2e2303(0x118)],_0x2acf11['request'],_0x3be648['request']),_0x51e464&&_0x1bd26b[_0x2e2303(0x10d)](this['prepareCommitManifest'](_0x51e464,'@{'+_0x2acf11[_0x2e2303(0x100)]+_0x2e2303(0x12e)));}return _0x1bd26b;}async[a182_0x390446(0x105)](_0x4468a8,_0x3bb80e=![]){const _0x16793f=a182_0x390446,_0x2d8efd={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x2f577e=[];for(const _0xc787ef of _0x4468a8){if(_0xc787ef['id'])_0x2f577e['push'](_0xc787ef['id']);else{const _0x4b92a8=this['proceededComponentsMeta'][_0x16793f(0xfc)](_0x58b5b7=>_0x58b5b7['componentName']===_0xc787ef['name']&&_0x58b5b7[_0x16793f(0x13a)]===_0xc787ef[_0x16793f(0x148)]);if(!_0x4b92a8||!_0x4b92a8['componentId'])continue;_0x2f577e[_0x16793f(0x10d)](_0x4b92a8[_0x16793f(0x108)]);}}if(_0x3bb80e){const _0x3a19ea=await this[_0x16793f(0x10f)][_0x16793f(0x14f)](_0x2f577e);_0x2d8efd[_0x16793f(0x15a)]=_0x3a19ea[_0x16793f(0xf9)](_0x24f542=>composite_utils_1[_0x16793f(0x14c)](constants_1['FLOSUM_COMMIT_MANIFEST'],_0x24f542)[_0x16793f(0x118)]);}return _0x2d8efd['componentsToUpdate']=_0x2f577e[_0x16793f(0xf9)](_0x193782=>composite_utils_1[_0x16793f(0x10c)](constants_1[_0x16793f(0x116)],_0x193782,{[constants_1[_0x16793f(0x157)]+_0x16793f(0x126)]:!![]})['request']),_0x2d8efd[_0x16793f(0x10b)]=_0x2f577e['map'](_0x3c33c7=>composite_utils_1[_0x16793f(0x14c)](constants_1[_0x16793f(0x116)],_0x3c33c7)['request']),_0x2d8efd;}}exports[a182_0x390446(0x103)]=SalesforceComponentsManager;