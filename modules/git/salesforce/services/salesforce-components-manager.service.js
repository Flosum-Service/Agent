const a234_0x4c6e7a=a234_0x5735;(function(_0x40a206,_0x1c1de0){const _0x4d5c31=a234_0x5735,_0x10e4fa=_0x40a206();while(!![]){try{const _0x4c203b=parseInt(_0x4d5c31(0x136))/0x1*(parseInt(_0x4d5c31(0x123))/0x2)+parseInt(_0x4d5c31(0x10b))/0x3*(-parseInt(_0x4d5c31(0x164))/0x4)+parseInt(_0x4d5c31(0x140))/0x5*(-parseInt(_0x4d5c31(0x11e))/0x6)+parseInt(_0x4d5c31(0x133))/0x7*(-parseInt(_0x4d5c31(0x10d))/0x8)+-parseInt(_0x4d5c31(0x124))/0x9+-parseInt(_0x4d5c31(0x160))/0xa+parseInt(_0x4d5c31(0x11a))/0xb;if(_0x4c203b===_0x1c1de0)break;else _0x10e4fa['push'](_0x10e4fa['shift']());}catch(_0x29d7f2){_0x10e4fa['push'](_0x10e4fa['shift']());}}}(a234_0x1fcf,0x222fe));const a234_0x2aaaad=(function(){let _0x2f7ebd=!![];return function(_0x254bc8,_0x503814){const _0x4abf67=_0x2f7ebd?function(){const _0x354996=a234_0x5735;if(_0x503814){const _0x33ff99=_0x503814[_0x354996(0x109)](_0x254bc8,arguments);return _0x503814=null,_0x33ff99;}}:function(){};return _0x2f7ebd=![],_0x4abf67;};}()),a234_0x41d867=a234_0x2aaaad(this,function(){const _0x43788f=a234_0x5735;return a234_0x41d867[_0x43788f(0x134)]()[_0x43788f(0x131)](_0x43788f(0x106))[_0x43788f(0x134)]()[_0x43788f(0x137)](a234_0x41d867)[_0x43788f(0x131)]('(((.+)+)+)+$');});a234_0x41d867();function a234_0x1fcf(){const _0x1e88f7=['FLOSUM_COMMIT_MANIFEST','version','proceedComponentMeta','Repository__c','FLOSUM_GIT_NAMESPACE','base64','search','SalesforceGitSyncService','49KvNNLc','toString','files','32TnQkyU','constructor','componentsToDelete','update','crc','reference','prepareComponentHistoryRecord',']\x20-\x20meta\x20not\x20found','logger','RecordTypeId','65aHCgmo','username','componentType','filePath','FLOSUM_COMPONENT_HISTORY','default','../../../../core','manifests','../../parsers/utils/zip','createZip','push','generateAsync','SalesforceComponentsManager','CRC32__c','../../../../constants','Branch','application/zip','name','gitSync','map','ParentId','FLOSUM_NAMESPACE','createPostRequest','request','.id}','Vlocity_Component_Name__c','isVlocityComponent','Last_Updated_By__c','DEFLATE','recordTypes','ContentType','vlocityComponentName','479070ZfKXse','../utils/flosum-naming.utils','componentsToUpdate','componentName','16Mhgnxv','keys','Component__c','Changed_On__c','branchId','Body','proceededComponentsMeta','extractFieldsFromRecord','prepareCommitManifest','Last_Modified_Date__c','prepareComponentRecord','(((.+)+)+)+$','__esModule','type','apply','toISOString','189642FDctBj','Name','215032PFEHMR','Could\x20not\x20proceed\x20component\x20','createPatchRequest','typedi','Source__c','Component_Type__c','Committed_On__c','repositoryId','body','componentId','prepareComponentAttachmentRecord','Commit__c','FLOSUM_COMPONENT','7555977JJiKRc','Version__c','createDeleteRequest','Repository','4356PgeLqN','File_Name__c','../errors/salesforce.error','Last_Modified_By__c','Zip','5614izYnAW','1245123OWcCwO','delete','Logger','Component_History__c','find','FLOSUM_ATTACHMENT','__importDefault'];a234_0x1fcf=function(){return _0x1e88f7;};return a234_0x1fcf();}function a234_0x5735(_0x1af799,_0x5f12d3){const _0x53fba7=a234_0x1fcf();return a234_0x5735=function(_0x41d867,_0x2aaaad){_0x41d867=_0x41d867-0xff;let _0x1fcf6c=_0x53fba7[_0x41d867];return _0x1fcf6c;},a234_0x5735(_0x1af799,_0x5f12d3);}'use strict';var __importDefault=this&&this[a234_0x4c6e7a(0x12a)]||function(_0x3456af){const _0x56e138=a234_0x4c6e7a;return _0x3456af&&_0x3456af[_0x56e138(0x107)]?_0x3456af:{'default':_0x3456af};};Object['defineProperty'](exports,a234_0x4c6e7a(0x107),{'value':!![]}),exports[a234_0x4c6e7a(0x14c)]=void 0x0;const constants_1=require(a234_0x4c6e7a(0x14e)),core_1=require(a234_0x4c6e7a(0x146)),zip_1=require(a234_0x4c6e7a(0x148)),typedi_1=__importDefault(require(a234_0x4c6e7a(0x110))),salesforce_error_1=require(a234_0x4c6e7a(0x120)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a234_0x4c6e7a(0x161)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceComponentsManager{constructor(_0x567b1e,_0x4151ee,_0x1bcfa9,_0x3518cd,_0x12c015){const _0x2ab8dc=a234_0x4c6e7a;this[_0x2ab8dc(0x114)]=_0x567b1e,this[_0x2ab8dc(0xff)]=_0x4151ee,this[_0x2ab8dc(0x141)]=_0x1bcfa9,this['recordTypes']=_0x3518cd,this[_0x2ab8dc(0x101)]=_0x12c015,this[_0x2ab8dc(0x13e)]=new core_1[(_0x2ab8dc(0x126))](SalesforceComponentsManager[_0x2ab8dc(0x151)]),this[_0x2ab8dc(0x152)]=typedi_1[_0x2ab8dc(0x145)]['get'](salesforce_git_sync_service_1[_0x2ab8dc(0x132)]);}[a234_0x4c6e7a(0x12d)](_0x2a023a,_0x187782){const _0x5db932=a234_0x4c6e7a,_0x5144f1=(0x0,flosum_naming_utils_1[_0x5db932(0x102)])(_0x2a023a,[_0x5db932(0x112),'Component_Name__c','Version__c']);this[_0x5db932(0x101)][_0x5db932(0x14a)]({'componentId':'','reference':_0x187782,'version':_0x5144f1[_0x5db932(0x11b)],'componentName':_0x5144f1['Component_Name__c'],'componentType':_0x5144f1[_0x5db932(0x112)]});}[a234_0x4c6e7a(0x103)](_0x1b77d5,_0x246e5a){const _0x43089c=a234_0x4c6e7a,{request:_0x139871}=(0x0,composite_utils_1[_0x43089c(0x156)])(constants_1[_0x43089c(0x12b)],{[constants_1[_0x43089c(0x155)]+_0x43089c(0x118)]:_0x1b77d5,[constants_1['FLOSUM_NAMESPACE']+_0x43089c(0x127)]:_0x246e5a});return _0x139871;}async[a234_0x4c6e7a(0x117)](_0x2f8964,_0x4fb453){const _0x22c36f=a234_0x4c6e7a,_0x4239ee={},_0x482734=zip_1[_0x22c36f(0x122)][_0x22c36f(0x149)]();for(const _0x221e27 of Object[_0x22c36f(0x165)](_0x2f8964[_0x22c36f(0x135)])){_0x482734['file'](_0x221e27,_0x2f8964['files'][_0x221e27],{'createFolders':!![]});}return _0x4239ee[_0x22c36f(0x15e)]=_0x22c36f(0x150),_0x4239ee[_0x22c36f(0x10c)]=_0x2f8964[_0x22c36f(0x108)],_0x4239ee['Description']=_0x2f8964['type'],_0x4239ee[_0x22c36f(0x154)]=_0x4fb453,_0x4239ee[_0x22c36f(0x100)]=await _0x482734[_0x22c36f(0x14b)]({'type':_0x22c36f(0x130),'compression':_0x22c36f(0x15c),'compressionOptions':{'level':0x6}}),_0x4239ee;}[a234_0x4c6e7a(0x13c)](_0x34491d,_0x1e9b80,_0x12d18d){const _0xc6079=a234_0x4c6e7a,_0x681c32=new Date()[_0xc6079(0x10a)](),_0x53c306={};return _0x53c306[constants_1[_0xc6079(0x155)]+_0xc6079(0x166)]=_0x1e9b80,_0x53c306[constants_1[_0xc6079(0x155)]+_0xc6079(0x14d)]=_0x34491d[_0xc6079(0x13a)],_0x53c306[constants_1[_0xc6079(0x155)]+_0xc6079(0x167)]=_0x681c32,_0x53c306[constants_1[_0xc6079(0x155)]+'Changed_By__c']=this[_0xc6079(0x141)],_0x53c306[constants_1['FLOSUM_NAMESPACE']+'Version__c']=_0x12d18d?_0x12d18d+0x1:0x1,_0x53c306[constants_1[_0xc6079(0x12f)]+'Is_From_Agent__c']=!![],_0x53c306;}[a234_0x4c6e7a(0x105)](_0x290f5f,_0x3c9f68){const _0x159a2f=a234_0x4c6e7a;var _0x4fe64c,_0x438427;const _0x1f3c73=new Date()[_0x159a2f(0x10a)](),_0x4c33a4={};return!_0x3c9f68?(this[_0x159a2f(0xff)]?(_0x4c33a4[constants_1[_0x159a2f(0x155)]+'Branch__c']=this[_0x159a2f(0xff)],_0x4c33a4[constants_1[_0x159a2f(0x155)]+'Source__c']='Branch',_0x4c33a4['RecordTypeId']=(_0x4fe64c=this[_0x159a2f(0x15d)][_0x159a2f(0x128)](_0x3b9e52=>_0x3b9e52[_0x159a2f(0x151)]===_0x159a2f(0x14f)))===null||_0x4fe64c===void 0x0?void 0x0:_0x4fe64c['id']):(_0x4c33a4[constants_1['FLOSUM_NAMESPACE']+_0x159a2f(0x12e)]=this['repositoryId'],_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x111)]=_0x159a2f(0x11d),_0x4c33a4[_0x159a2f(0x13f)]=(_0x438427=this[_0x159a2f(0x15d)][_0x159a2f(0x128)](_0x18d5e1=>_0x18d5e1['name']===_0x159a2f(0x11d)))===null||_0x438427===void 0x0?void 0x0:_0x438427['id']),_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x11b)]=0x1):_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x11b)]=_0x3c9f68[_0x159a2f(0x12c)]+0x1,_0x4c33a4[constants_1['FLOSUM_NAMESPACE']+_0x159a2f(0x112)]=_0x290f5f[_0x159a2f(0x108)],_0x4c33a4[constants_1['FLOSUM_NAMESPACE']+'Component_Name__c']=_0x290f5f[_0x159a2f(0x151)],_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x11f)]=_0x290f5f[_0x159a2f(0x143)],_0x4c33a4[constants_1['FLOSUM_NAMESPACE']+_0x159a2f(0x15b)]=this[_0x159a2f(0x141)],_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x121)]=this[_0x159a2f(0x141)],_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x104)]=_0x1f3c73,_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x113)]=_0x1f3c73,_0x4c33a4[constants_1[_0x159a2f(0x155)]+'CRC32__c']=_0x290f5f[_0x159a2f(0x13a)],_0x4c33a4[constants_1[_0x159a2f(0x155)]+_0x159a2f(0x159)]=_0x290f5f[_0x159a2f(0x15f)],_0x4c33a4[constants_1[_0x159a2f(0x155)]+'Vlocity_Component__c']=_0x290f5f[_0x159a2f(0x15a)],_0x4c33a4;}['getProceededComponentsMeta'](){const _0x3f0478=a234_0x4c6e7a;return this[_0x3f0478(0x101)];}async['insert'](_0x4b0c0d,_0x5489f2){const _0x94eb07=a234_0x4c6e7a,_0x5902c9=[];for(const _0x155a30 of _0x4b0c0d){const _0x25f929=(0x0,composite_utils_1[_0x94eb07(0x156)])(constants_1[_0x94eb07(0x119)],this['prepareComponentRecord'](_0x155a30)),_0x21871e=(0x0,composite_utils_1[_0x94eb07(0x156)])(constants_1[_0x94eb07(0x144)],this['prepareComponentHistoryRecord'](_0x155a30,'@{'+_0x25f929[_0x94eb07(0x13b)]+_0x94eb07(0x158))),_0x1952d5=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x94eb07(0x129)],await this[_0x94eb07(0x117)](_0x155a30,'@{'+_0x21871e[_0x94eb07(0x13b)]+_0x94eb07(0x158)));this['proceedComponentMeta'](_0x25f929[_0x94eb07(0x157)][_0x94eb07(0x115)],_0x25f929['reference']),_0x5902c9['push'](_0x25f929[_0x94eb07(0x157)],_0x21871e['request'],_0x1952d5[_0x94eb07(0x157)]),_0x5489f2&&_0x5902c9[_0x94eb07(0x14a)](this[_0x94eb07(0x103)](_0x5489f2,'@{'+_0x21871e[_0x94eb07(0x13b)]+_0x94eb07(0x158)));}return _0x5902c9;}async[a234_0x4c6e7a(0x139)](_0x3c227b,_0x1ba7e8=''){const _0x359bcb=a234_0x4c6e7a,_0x220485=[];for(const {component:_0x5deac6,meta:_0x2e13fb}of _0x3c227b){if(!_0x2e13fb['id']){const _0x557baf=this[_0x359bcb(0x101)]['find'](_0xeaebf=>_0xeaebf[_0x359bcb(0x163)]===_0x5deac6[_0x359bcb(0x151)]&&_0xeaebf[_0x359bcb(0x142)]===_0x5deac6[_0x359bcb(0x108)]);if(!_0x557baf)throw new salesforce_error_1['SalesforceError'](new Error(_0x359bcb(0x10e)+_0x5deac6[_0x359bcb(0x151)]+'\x20['+_0x5deac6[_0x359bcb(0x108)]+_0x359bcb(0x13d)));_0x2e13fb['id']=_0x557baf['componentId'];}const _0x262c25=(0x0,composite_utils_1[_0x359bcb(0x10f)])(constants_1[_0x359bcb(0x119)],_0x2e13fb['id'],this[_0x359bcb(0x105)](_0x5deac6,_0x2e13fb)),_0x428b02=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x359bcb(0x144)],this[_0x359bcb(0x13c)](_0x5deac6,_0x2e13fb['id'],_0x2e13fb['version'])),_0x4153ca=(0x0,composite_utils_1[_0x359bcb(0x156)])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x359bcb(0x117)](_0x5deac6,'@{'+_0x428b02[_0x359bcb(0x13b)]+'.id}'));this[_0x359bcb(0x12d)](_0x262c25[_0x359bcb(0x157)]['body'],_0x262c25[_0x359bcb(0x13b)]),_0x220485[_0x359bcb(0x14a)](_0x262c25[_0x359bcb(0x157)],_0x428b02[_0x359bcb(0x157)],_0x4153ca[_0x359bcb(0x157)]),_0x1ba7e8&&_0x220485[_0x359bcb(0x14a)](this['prepareCommitManifest'](_0x1ba7e8,'@{'+_0x428b02[_0x359bcb(0x13b)]+'.id}'));}return _0x220485;}async[a234_0x4c6e7a(0x125)](_0xf945ca,_0x1e44c2=![]){const _0x43ad06=a234_0x4c6e7a,_0x27026d={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x58d22d=[];for(const _0x382745 of _0xf945ca){if(_0x382745['id'])_0x58d22d[_0x43ad06(0x14a)](_0x382745['id']);else{const _0x36f4b6=this[_0x43ad06(0x101)][_0x43ad06(0x128)](_0x3a1c8e=>_0x3a1c8e[_0x43ad06(0x163)]===_0x382745[_0x43ad06(0x151)]&&_0x3a1c8e[_0x43ad06(0x142)]===_0x382745['type']);if(!_0x36f4b6||!_0x36f4b6[_0x43ad06(0x116)])continue;_0x58d22d[_0x43ad06(0x14a)](_0x36f4b6[_0x43ad06(0x116)]);}}if(_0x1e44c2){const _0x156b7e=await this[_0x43ad06(0x152)]['fetchCommitManifestsByComponentIds'](_0x58d22d);_0x27026d[_0x43ad06(0x147)]=_0x156b7e[_0x43ad06(0x153)](_0x132330=>(0x0,composite_utils_1[_0x43ad06(0x11c)])(constants_1[_0x43ad06(0x12b)],_0x132330)[_0x43ad06(0x157)]);}return _0x27026d[_0x43ad06(0x162)]=_0x58d22d['map'](_0x174a1c=>(0x0,composite_utils_1[_0x43ad06(0x10f)])(constants_1[_0x43ad06(0x119)],_0x174a1c,{[constants_1['FLOSUM_GIT_NAMESPACE']+'Deletion_By_Agent__c']:!![]})[_0x43ad06(0x157)]),_0x27026d[_0x43ad06(0x138)]=_0x58d22d[_0x43ad06(0x153)](_0x287b9a=>(0x0,composite_utils_1[_0x43ad06(0x11c)])(constants_1['FLOSUM_COMPONENT'],_0x287b9a)['request']),_0x27026d;}}exports[a234_0x4c6e7a(0x14c)]=SalesforceComponentsManager;