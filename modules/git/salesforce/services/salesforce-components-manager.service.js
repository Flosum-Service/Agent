const a272_0x3c86f4=a272_0x14c0;function a272_0x2a8e(){const _0x2adc45=['Component__c','19998TLjDfO','get','SalesforceGitSyncService','Is_From_Agent__c','toString','default','fetchCommitManifestsByComponentIds','delete','crc','Body','prepareComponentAttachmentRecord','componentName','208632RwBmSc','Repository','../../../../core','../utils/flosum-naming.utils','__esModule','./salesforce-git-sync.service','componentsToUpdate','gitSync','manifests','Committed_On__c','ContentType','name','FLOSUM_COMPONENT_HISTORY','extractFieldsFromRecord','Last_Modified_By__c','Logger','createPatchRequest','prepareComponentRecord','proceededComponentsMeta','getProceededComponentsMeta','apply','Vlocity_Component__c','FLOSUM_COMMIT_MANIFEST','map','Repository__c','30568LhFdcC','Component_Type__c','FLOSUM_GIT_NAMESPACE','logger','File_Name__c','recordTypes','find','defineProperty','repositoryId','type','Description','Version__c','../errors/salesforce.error','517915OJgsTe','body','keys','206600gGcyYJ','prepareComponentHistoryRecord','filePath','push','file','Zip','username','DEFLATE','.id}','SalesforceComponentsManager','application/zip','FLOSUM_ATTACHMENT','Source__c','Branch__c','componentId','insert','124OlyjuE','isVlocityComponent','createDeleteRequest','CRC32__c','update','FLOSUM_COMPONENT','toISOString','base64','prepareCommitManifest','componentType','constructor','generateAsync','typedi','proceedComponentMeta','branchId','FLOSUM_NAMESPACE','(((.+)+)+)+$','8318xWVLau','119jgIgex','createPostRequest','Name','40197TpRNuQ','files','request','reference','version','../../parsers/utils/zip','Branch','search','Component_Name__c','marketingCloudKey','Could\x20not\x20proceed\x20component\x20'];a272_0x2a8e=function(){return _0x2adc45;};return a272_0x2a8e();}(function(_0x279f8c,_0x1a1a8b){const _0x3fe526=a272_0x14c0,_0x13ddca=_0x279f8c();while(!![]){try{const _0x19f7ee=-parseInt(_0x3fe526(0xb8))/0x1+parseInt(_0x3fe526(0xd9))/0x2+-parseInt(_0x3fe526(0xdd))/0x3*(-parseInt(_0x3fe526(0xc8))/0x4)+parseInt(_0x3fe526(0xb5))/0x5+parseInt(_0x3fe526(0xf5))/0x6+-parseInt(_0x3fe526(0xda))/0x7*(parseInt(_0x3fe526(0x10e))/0x8)+parseInt(_0x3fe526(0xe9))/0x9;if(_0x19f7ee===_0x1a1a8b)break;else _0x13ddca['push'](_0x13ddca['shift']());}catch(_0x169c9c){_0x13ddca['push'](_0x13ddca['shift']());}}}(a272_0x2a8e,0x46724));const a272_0xef8291=(function(){let _0x1292cf=!![];return function(_0x5afe64,_0x5a24c4){const _0x40983c=_0x1292cf?function(){const _0x2eb814=a272_0x14c0;if(_0x5a24c4){const _0x2287f2=_0x5a24c4[_0x2eb814(0x109)](_0x5afe64,arguments);return _0x5a24c4=null,_0x2287f2;}}:function(){};return _0x1292cf=![],_0x40983c;};}()),a272_0x2ecedf=a272_0xef8291(this,function(){const _0x5b6b6f=a272_0x14c0;return a272_0x2ecedf[_0x5b6b6f(0xed)]()[_0x5b6b6f(0xe4)]('(((.+)+)+)+$')[_0x5b6b6f(0xed)]()[_0x5b6b6f(0xd2)](a272_0x2ecedf)[_0x5b6b6f(0xe4)](_0x5b6b6f(0xd8));});function a272_0x14c0(_0x2cc446,_0x26ada4){const _0x86c382=a272_0x2a8e();return a272_0x14c0=function(_0x2ecedf,_0xef8291){_0x2ecedf=_0x2ecedf-0xab;let _0x2a8e79=_0x86c382[_0x2ecedf];return _0x2a8e79;},a272_0x14c0(_0x2cc446,_0x26ada4);}a272_0x2ecedf();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4c1bb2){const _0x3194e2=a272_0x14c0;return _0x4c1bb2&&_0x4c1bb2[_0x3194e2(0xf9)]?_0x4c1bb2:{'default':_0x4c1bb2};};Object[a272_0x3c86f4(0xaf)](exports,a272_0x3c86f4(0xf9),{'value':!![]}),exports[a272_0x3c86f4(0xc1)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a272_0x3c86f4(0xf7)),zip_1=require(a272_0x3c86f4(0xe2)),typedi_1=__importDefault(require(a272_0x3c86f4(0xd4))),salesforce_error_1=require(a272_0x3c86f4(0xb4)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a272_0x3c86f4(0xf8)),salesforce_git_sync_service_1=require(a272_0x3c86f4(0xfa));class SalesforceComponentsManager{constructor(_0x213aa1,_0x10481a,_0x3bc55a,_0x3558d5,_0xb6131a){const _0x16861c=a272_0x3c86f4;this[_0x16861c(0xb0)]=_0x213aa1,this[_0x16861c(0xd6)]=_0x10481a,this[_0x16861c(0xbe)]=_0x3bc55a,this[_0x16861c(0xad)]=_0x3558d5,this[_0x16861c(0x107)]=_0xb6131a,this[_0x16861c(0xab)]=new core_1[(_0x16861c(0x104))](SalesforceComponentsManager['name']),this[_0x16861c(0xfc)]=typedi_1[_0x16861c(0xee)][_0x16861c(0xea)](salesforce_git_sync_service_1[_0x16861c(0xeb)]);}[a272_0x3c86f4(0xd5)](_0x2cfbfc,_0x1f9fe9){const _0x3622a8=a272_0x3c86f4,_0x17b41b=(0x0,flosum_naming_utils_1[_0x3622a8(0x102)])(_0x2cfbfc,[_0x3622a8(0x10f),_0x3622a8(0xe5),_0x3622a8(0xb3)]);this[_0x3622a8(0x107)][_0x3622a8(0xbb)]({'componentId':'','reference':_0x1f9fe9,'version':_0x17b41b[_0x3622a8(0xb3)],'componentName':_0x17b41b[_0x3622a8(0xe5)],'componentType':_0x17b41b['Component_Type__c']});}[a272_0x3c86f4(0xd0)](_0x32e298,_0x5452e9){const _0x562041=a272_0x3c86f4,{request:_0x37f50c}=(0x0,composite_utils_1[_0x562041(0xdb)])(constants_1[_0x562041(0x10b)],{[constants_1['FLOSUM_NAMESPACE']+'Commit__c']:_0x32e298,[constants_1[_0x562041(0xd7)]+'Component_History__c']:_0x5452e9});return _0x37f50c;}async[a272_0x3c86f4(0xf3)](_0x287abe,_0x4368e5){const _0x1e891d=a272_0x3c86f4,_0x3fc9b0={},_0x542e5a=zip_1[_0x1e891d(0xbd)]['createZip']();for(const _0x4ef4e3 of Object[_0x1e891d(0xb7)](_0x287abe[_0x1e891d(0xde)])){_0x542e5a[_0x1e891d(0xbc)](_0x4ef4e3,_0x287abe[_0x1e891d(0xde)][_0x4ef4e3],{'createFolders':!![]});}return _0x3fc9b0[_0x1e891d(0xff)]=_0x1e891d(0xc2),_0x3fc9b0[_0x1e891d(0xdc)]=_0x287abe['type'],_0x3fc9b0[_0x1e891d(0xb2)]=_0x287abe[_0x1e891d(0xb1)],_0x3fc9b0['ParentId']=_0x4368e5,_0x3fc9b0[_0x1e891d(0xf2)]=await _0x542e5a[_0x1e891d(0xd3)]({'type':_0x1e891d(0xcf),'compression':_0x1e891d(0xbf),'compressionOptions':{'level':0x6}}),_0x3fc9b0;}[a272_0x3c86f4(0xb9)](_0x51be9b,_0x13e607,_0x21e7fc){const _0x353b0e=a272_0x3c86f4,_0x56369e=new Date()[_0x353b0e(0xce)](),_0x5df3c5={};return _0x5df3c5[constants_1[_0x353b0e(0xd7)]+_0x353b0e(0xe8)]=_0x13e607,_0x5df3c5[constants_1[_0x353b0e(0xd7)]+_0x353b0e(0xcb)]=_0x51be9b[_0x353b0e(0xf1)],_0x5df3c5[constants_1['FLOSUM_NAMESPACE']+'Changed_On__c']=_0x56369e,_0x5df3c5[constants_1[_0x353b0e(0xd7)]+'Changed_By__c']=this['username'],_0x5df3c5[constants_1[_0x353b0e(0xd7)]+_0x353b0e(0xb3)]=_0x21e7fc?_0x21e7fc+0x1:0x1,_0x5df3c5[constants_1['FLOSUM_GIT_NAMESPACE']+_0x353b0e(0xec)]=!![],_0x5df3c5;}[a272_0x3c86f4(0x106)](_0x9f5397,_0x1f730c){const _0x2bbea9=a272_0x3c86f4;var _0x420207,_0x1fa280;const _0x3a3334=new Date()[_0x2bbea9(0xce)](),_0x3ec41f={};return!_0x1f730c?(this[_0x2bbea9(0xd6)]?(_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+_0x2bbea9(0xc5)]=this[_0x2bbea9(0xd6)],_0x3ec41f[constants_1['FLOSUM_NAMESPACE']+_0x2bbea9(0xc4)]=_0x2bbea9(0xe3),_0x3ec41f['RecordTypeId']=(_0x420207=this[_0x2bbea9(0xad)]['find'](_0x34ebc8=>_0x34ebc8[_0x2bbea9(0x100)]===_0x2bbea9(0xe3)))===null||_0x420207===void 0x0?void 0x0:_0x420207['id']):(_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+_0x2bbea9(0x10d)]=this[_0x2bbea9(0xb0)],_0x3ec41f[constants_1['FLOSUM_NAMESPACE']+_0x2bbea9(0xc4)]=_0x2bbea9(0xf6),_0x3ec41f['RecordTypeId']=(_0x1fa280=this['recordTypes']['find'](_0x3c3f18=>_0x3c3f18['name']===_0x2bbea9(0xf6)))===null||_0x1fa280===void 0x0?void 0x0:_0x1fa280['id']),_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+_0x2bbea9(0xb3)]=0x1):_0x3ec41f[constants_1['FLOSUM_NAMESPACE']+_0x2bbea9(0xb3)]=_0x1f730c[_0x2bbea9(0xe1)]+0x1,_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+'Component_Type__c']=_0x9f5397['type'],_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+_0x2bbea9(0xe5)]=_0x9f5397[_0x2bbea9(0x100)],_0x3ec41f[constants_1['FLOSUM_NAMESPACE']+_0x2bbea9(0xac)]=_0x9f5397[_0x2bbea9(0xba)],_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+'Last_Updated_By__c']=this[_0x2bbea9(0xbe)],_0x3ec41f[constants_1['FLOSUM_NAMESPACE']+_0x2bbea9(0x103)]=this['username'],_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+'Last_Modified_Date__c']=_0x3a3334,_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+_0x2bbea9(0xfe)]=_0x3a3334,_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+_0x2bbea9(0xcb)]=_0x9f5397[_0x2bbea9(0xf1)],_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+'Vlocity_Component_Name__c']=_0x9f5397['vlocityComponentName'],_0x3ec41f[constants_1['FLOSUM_NAMESPACE']+_0x2bbea9(0x10a)]=_0x9f5397[_0x2bbea9(0xc9)],_0x3ec41f[constants_1[_0x2bbea9(0xd7)]+'MC_Key__c']=_0x9f5397[_0x2bbea9(0xe6)],_0x3ec41f;}[a272_0x3c86f4(0x108)](){const _0x1f875a=a272_0x3c86f4;return this[_0x1f875a(0x107)];}async[a272_0x3c86f4(0xc7)](_0x5dcff4,_0x57a7ee){const _0x1b1aad=a272_0x3c86f4,_0x1e698f=[];for(const _0x1e05d1 of _0x5dcff4){const _0x49a5f1=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x1b1aad(0xcd)],this['prepareComponentRecord'](_0x1e05d1)),_0x319c5f=(0x0,composite_utils_1[_0x1b1aad(0xdb)])(constants_1[_0x1b1aad(0x101)],this[_0x1b1aad(0xb9)](_0x1e05d1,'@{'+_0x49a5f1[_0x1b1aad(0xe0)]+'.id}')),_0x4cefe5=(0x0,composite_utils_1[_0x1b1aad(0xdb)])(constants_1[_0x1b1aad(0xc3)],await this[_0x1b1aad(0xf3)](_0x1e05d1,'@{'+_0x319c5f[_0x1b1aad(0xe0)]+_0x1b1aad(0xc0)));this['proceedComponentMeta'](_0x49a5f1[_0x1b1aad(0xdf)][_0x1b1aad(0xb6)],_0x49a5f1['reference']),_0x1e698f[_0x1b1aad(0xbb)](_0x49a5f1[_0x1b1aad(0xdf)],_0x319c5f[_0x1b1aad(0xdf)],_0x4cefe5[_0x1b1aad(0xdf)]),_0x57a7ee&&_0x1e698f[_0x1b1aad(0xbb)](this[_0x1b1aad(0xd0)](_0x57a7ee,'@{'+_0x319c5f[_0x1b1aad(0xe0)]+_0x1b1aad(0xc0)));}return _0x1e698f;}async[a272_0x3c86f4(0xcc)](_0x318250,_0xbde56e=''){const _0x98b3a7=a272_0x3c86f4,_0x14e0e7=[];for(const {component:_0x207992,meta:_0x5cd1d0}of _0x318250){if(!_0x5cd1d0['id']){const _0x183439=this[_0x98b3a7(0x107)][_0x98b3a7(0xae)](_0x2c7459=>_0x2c7459[_0x98b3a7(0xf4)]===_0x207992[_0x98b3a7(0x100)]&&_0x2c7459[_0x98b3a7(0xd1)]===_0x207992['type']);if(!_0x183439)throw new salesforce_error_1['SalesforceError'](new Error(_0x98b3a7(0xe7)+_0x207992['name']+'\x20['+_0x207992['type']+']\x20-\x20meta\x20not\x20found'));_0x5cd1d0['id']=_0x183439[_0x98b3a7(0xc6)];}const _0xc084ef=(0x0,composite_utils_1[_0x98b3a7(0x105)])(constants_1['FLOSUM_COMPONENT'],_0x5cd1d0['id'],this[_0x98b3a7(0x106)](_0x207992,_0x5cd1d0)),_0x10fc8f=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x98b3a7(0x101)],this['prepareComponentHistoryRecord'](_0x207992,_0x5cd1d0['id'],_0x5cd1d0[_0x98b3a7(0xe1)])),_0x19c6df=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x98b3a7(0xc3)],await this[_0x98b3a7(0xf3)](_0x207992,'@{'+_0x10fc8f[_0x98b3a7(0xe0)]+_0x98b3a7(0xc0)));this[_0x98b3a7(0xd5)](_0xc084ef[_0x98b3a7(0xdf)]['body'],_0xc084ef[_0x98b3a7(0xe0)]),_0x14e0e7[_0x98b3a7(0xbb)](_0xc084ef[_0x98b3a7(0xdf)],_0x10fc8f['request'],_0x19c6df[_0x98b3a7(0xdf)]),_0xbde56e&&_0x14e0e7[_0x98b3a7(0xbb)](this['prepareCommitManifest'](_0xbde56e,'@{'+_0x10fc8f[_0x98b3a7(0xe0)]+_0x98b3a7(0xc0)));}return _0x14e0e7;}async[a272_0x3c86f4(0xf0)](_0xc1b750,_0x4ee486=![]){const _0x1c7725=a272_0x3c86f4,_0x29f24e={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x46fad8=[];for(const _0x18c31a of _0xc1b750){if(_0x18c31a['id'])_0x46fad8['push'](_0x18c31a['id']);else{const _0x501e19=this[_0x1c7725(0x107)]['find'](_0x3b5d1a=>_0x3b5d1a[_0x1c7725(0xf4)]===_0x18c31a[_0x1c7725(0x100)]&&_0x3b5d1a[_0x1c7725(0xd1)]===_0x18c31a[_0x1c7725(0xb1)]);if(!_0x501e19||!_0x501e19['componentId'])continue;_0x46fad8[_0x1c7725(0xbb)](_0x501e19['componentId']);}}if(_0x4ee486){const _0x1ac68e=await this[_0x1c7725(0xfc)][_0x1c7725(0xef)](_0x46fad8);_0x29f24e[_0x1c7725(0xfd)]=_0x1ac68e['map'](_0x43b585=>(0x0,composite_utils_1[_0x1c7725(0xca)])(constants_1['FLOSUM_COMMIT_MANIFEST'],_0x43b585)['request']);}return _0x29f24e[_0x1c7725(0xfb)]=_0x46fad8[_0x1c7725(0x10c)](_0x17c060=>(0x0,composite_utils_1[_0x1c7725(0x105)])(constants_1[_0x1c7725(0xcd)],_0x17c060,{[constants_1[_0x1c7725(0x110)]+'Deletion_By_Agent__c']:!![]})['request']),_0x29f24e['componentsToDelete']=_0x46fad8['map'](_0x5d632f=>(0x0,composite_utils_1[_0x1c7725(0xca)])(constants_1[_0x1c7725(0xcd)],_0x5d632f)[_0x1c7725(0xdf)]),_0x29f24e;}}exports[a272_0x3c86f4(0xc1)]=SalesforceComponentsManager;