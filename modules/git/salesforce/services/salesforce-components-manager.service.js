function a234_0x5784(_0x32c874,_0x14ce60){const _0x5303ad=a234_0x169c();return a234_0x5784=function(_0x1122fa,_0x508e40){_0x1122fa=_0x1122fa-0xd8;let _0x169ca7=_0x5303ad[_0x1122fa];return _0x169ca7;},a234_0x5784(_0x32c874,_0x14ce60);}const a234_0x2fa7ea=a234_0x5784;(function(_0xda65c,_0xdd677f){const _0xa7eb8f=a234_0x5784,_0x472a9c=_0xda65c();while(!![]){try{const _0x5b21ac=-parseInt(_0xa7eb8f(0x10b))/0x1*(-parseInt(_0xa7eb8f(0x12c))/0x2)+parseInt(_0xa7eb8f(0x107))/0x3+-parseInt(_0xa7eb8f(0xef))/0x4*(-parseInt(_0xa7eb8f(0x10c))/0x5)+-parseInt(_0xa7eb8f(0x111))/0x6*(parseInt(_0xa7eb8f(0x121))/0x7)+parseInt(_0xa7eb8f(0x12d))/0x8+parseInt(_0xa7eb8f(0xdc))/0x9+-parseInt(_0xa7eb8f(0x109))/0xa;if(_0x5b21ac===_0xdd677f)break;else _0x472a9c['push'](_0x472a9c['shift']());}catch(_0x1c3cce){_0x472a9c['push'](_0x472a9c['shift']());}}}(a234_0x169c,0xc9153));const a234_0x508e40=(function(){let _0x22ecc0=!![];return function(_0x34c433,_0x2e3909){const _0x1e0e48=_0x22ecc0?function(){const _0x5110db=a234_0x5784;if(_0x2e3909){const _0x1f68ad=_0x2e3909[_0x5110db(0xe2)](_0x34c433,arguments);return _0x2e3909=null,_0x1f68ad;}}:function(){};return _0x22ecc0=![],_0x1e0e48;};}()),a234_0x1122fa=a234_0x508e40(this,function(){const _0x40c600=a234_0x5784;return a234_0x1122fa[_0x40c600(0x10a)]()['search']('(((.+)+)+)+$')['toString']()[_0x40c600(0x120)](a234_0x1122fa)[_0x40c600(0x11e)](_0x40c600(0xfa));});a234_0x1122fa();'use strict';var __importDefault=this&&this['__importDefault']||function(_0xd58771){const _0x1883cf=a234_0x5784;return _0xd58771&&_0xd58771[_0x1883cf(0x134)]?_0xd58771:{'default':_0xd58771};};Object[a234_0x2fa7ea(0x104)](exports,a234_0x2fa7ea(0x134),{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;const constants_1=require(a234_0x2fa7ea(0xff)),core_1=require(a234_0x2fa7ea(0x117)),zip_1=require(a234_0x2fa7ea(0x128)),typedi_1=__importDefault(require(a234_0x2fa7ea(0x108))),salesforce_error_1=require(a234_0x2fa7ea(0xf4)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a234_0x2fa7ea(0x102)),salesforce_git_sync_service_1=require(a234_0x2fa7ea(0xe8));function a234_0x169c(){const _0x372442=['files','createPostRequest','../utils/flosum-naming.utils','Branch__c','defineProperty','componentsToDelete','SalesforceComponentsManager','2780568hSfQoJ','typedi','44560860Rdkukt','toString','43080BeBWMH','14965ekOFwh','Logger','Version__c','prepareComponentAttachmentRecord','File_Name__c','2574OavtRg','createZip','FLOSUM_COMPONENT','insert','SalesforceGitSyncService','request','../../../../core','Last_Updated_By__c','body','componentsToUpdate','componentId','Could\x20not\x20proceed\x20component\x20','CRC32__c','search','Description','constructor','6573dfawbU','get','crc','componentType','Body','recordTypes','find','../../parsers/utils/zip','FLOSUM_ATTACHMENT','branchId','generateAsync','58RPokTL','10756720IscWSb','Component_History__c','extractFieldsFromRecord','delete','keys','base64','proceedComponentMeta','__esModule','username','createPatchRequest','prepareComponentHistoryRecord','repositoryId','file','Repository','Source__c','push','gitSync','Component__c','10108935Txpxgf','Component_Type__c','update','Last_Modified_Date__c','name','getProceededComponentsMeta','apply','Committed_On__c','map','Changed_By__c','fetchCommitManifestsByComponentIds','type','./salesforce-git-sync.service','Component_Name__c','prepareComponentRecord','Branch','version','Last_Modified_By__c','reference','1388PsnhAJ','FLOSUM_GIT_NAMESPACE','toISOString','ContentType','prepareCommitManifest','../errors/salesforce.error','FLOSUM_NAMESPACE','componentName','RecordTypeId','createDeleteRequest','.id}','(((.+)+)+)+$','DEFLATE','Vlocity_Component_Name__c','FLOSUM_COMPONENT_HISTORY','proceededComponentsMeta','../../../../constants'];a234_0x169c=function(){return _0x372442;};return a234_0x169c();}class SalesforceComponentsManager{constructor(_0x364835,_0x296993,_0x254e3f,_0x2bedb8,_0x1da75e){const _0x229533=a234_0x2fa7ea;this[_0x229533(0x138)]=_0x364835,this[_0x229533(0x12a)]=_0x296993,this[_0x229533(0x135)]=_0x254e3f,this[_0x229533(0x126)]=_0x2bedb8,this[_0x229533(0xfe)]=_0x1da75e,this['logger']=new core_1[(_0x229533(0x10d))](SalesforceComponentsManager[_0x229533(0xe0)]),this[_0x229533(0xda)]=typedi_1['default'][_0x229533(0x122)](salesforce_git_sync_service_1[_0x229533(0x115)]);}[a234_0x2fa7ea(0x133)](_0x3923fa,_0xfa1148){const _0x1a4496=a234_0x2fa7ea,_0x253f65=(0x0,flosum_naming_utils_1[_0x1a4496(0x12f)])(_0x3923fa,[_0x1a4496(0xdd),_0x1a4496(0xe9),_0x1a4496(0x10e)]);this[_0x1a4496(0xfe)][_0x1a4496(0xd9)]({'componentId':'','reference':_0xfa1148,'version':_0x253f65[_0x1a4496(0x10e)],'componentName':_0x253f65[_0x1a4496(0xe9)],'componentType':_0x253f65['Component_Type__c']});}[a234_0x2fa7ea(0xf3)](_0x423057,_0x309113){const _0x63fbec=a234_0x2fa7ea,{request:_0x4601b8}=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1[_0x63fbec(0xf5)]+'Commit__c']:_0x423057,[constants_1[_0x63fbec(0xf5)]+_0x63fbec(0x12e)]:_0x309113});return _0x4601b8;}async['prepareComponentAttachmentRecord'](_0x11b071,_0x1b69c0){const _0x1fb88d=a234_0x2fa7ea,_0xb5ce15={},_0x2c10af=zip_1['Zip'][_0x1fb88d(0x112)]();for(const _0x4d35d3 of Object[_0x1fb88d(0x131)](_0x11b071[_0x1fb88d(0x100)])){_0x2c10af[_0x1fb88d(0x139)](_0x4d35d3,_0x11b071[_0x1fb88d(0x100)][_0x4d35d3],{'createFolders':!![]});}return _0xb5ce15[_0x1fb88d(0xf2)]='application/zip',_0xb5ce15['Name']=_0x11b071[_0x1fb88d(0xe7)],_0xb5ce15[_0x1fb88d(0x11f)]=_0x11b071[_0x1fb88d(0xe7)],_0xb5ce15['ParentId']=_0x1b69c0,_0xb5ce15[_0x1fb88d(0x125)]=await _0x2c10af[_0x1fb88d(0x12b)]({'type':_0x1fb88d(0x132),'compression':_0x1fb88d(0xfb),'compressionOptions':{'level':0x6}}),_0xb5ce15;}[a234_0x2fa7ea(0x137)](_0x1310d2,_0x2c61f0,_0x50bf03){const _0x4ebc97=a234_0x2fa7ea,_0x135654=new Date()[_0x4ebc97(0xf1)](),_0x3c7129={};return _0x3c7129[constants_1[_0x4ebc97(0xf5)]+_0x4ebc97(0xdb)]=_0x2c61f0,_0x3c7129[constants_1[_0x4ebc97(0xf5)]+_0x4ebc97(0x11d)]=_0x1310d2[_0x4ebc97(0x123)],_0x3c7129[constants_1[_0x4ebc97(0xf5)]+'Changed_On__c']=_0x135654,_0x3c7129[constants_1[_0x4ebc97(0xf5)]+_0x4ebc97(0xe5)]=this[_0x4ebc97(0x135)],_0x3c7129[constants_1['FLOSUM_NAMESPACE']+_0x4ebc97(0x10e)]=_0x50bf03?_0x50bf03+0x1:0x1,_0x3c7129[constants_1['FLOSUM_GIT_NAMESPACE']+'Is_From_Agent__c']=!![],_0x3c7129;}[a234_0x2fa7ea(0xea)](_0x388c58,_0x2bdc41){const _0x204c20=a234_0x2fa7ea;var _0x4f8313,_0x4d4f55;const _0x511c3d=new Date()[_0x204c20(0xf1)](),_0x1203a4={};return!_0x2bdc41?(this[_0x204c20(0x12a)]?(_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0x103)]=this[_0x204c20(0x12a)],_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0xd8)]='Branch',_0x1203a4['RecordTypeId']=(_0x4f8313=this[_0x204c20(0x126)][_0x204c20(0x127)](_0x5efb77=>_0x5efb77['name']===_0x204c20(0xeb)))===null||_0x4f8313===void 0x0?void 0x0:_0x4f8313['id']):(_0x1203a4[constants_1[_0x204c20(0xf5)]+'Repository__c']=this[_0x204c20(0x138)],_0x1203a4[constants_1[_0x204c20(0xf5)]+'Source__c']=_0x204c20(0x13a),_0x1203a4[_0x204c20(0xf7)]=(_0x4d4f55=this['recordTypes'][_0x204c20(0x127)](_0x30b04d=>_0x30b04d[_0x204c20(0xe0)]===_0x204c20(0x13a)))===null||_0x4d4f55===void 0x0?void 0x0:_0x4d4f55['id']),_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0x10e)]=0x1):_0x1203a4[constants_1['FLOSUM_NAMESPACE']+_0x204c20(0x10e)]=_0x2bdc41[_0x204c20(0xec)]+0x1,_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0xdd)]=_0x388c58[_0x204c20(0xe7)],_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0xe9)]=_0x388c58[_0x204c20(0xe0)],_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0x110)]=_0x388c58['filePath'],_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0x118)]=this[_0x204c20(0x135)],_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0xed)]=this[_0x204c20(0x135)],_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0xdf)]=_0x511c3d,_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0xe3)]=_0x511c3d,_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0x11d)]=_0x388c58[_0x204c20(0x123)],_0x1203a4[constants_1[_0x204c20(0xf5)]+_0x204c20(0xfc)]=_0x388c58['vlocityComponentName'],_0x1203a4[constants_1[_0x204c20(0xf5)]+'Vlocity_Component__c']=_0x388c58['isVlocityComponent'],_0x1203a4;}[a234_0x2fa7ea(0xe1)](){const _0x3ec8b7=a234_0x2fa7ea;return this[_0x3ec8b7(0xfe)];}async[a234_0x2fa7ea(0x114)](_0x2d13e1,_0x8d94f2){const _0x5f4ec8=a234_0x2fa7ea,_0x589a11=[];for(const _0x3a386c of _0x2d13e1){const _0x197e32=(0x0,composite_utils_1[_0x5f4ec8(0x101)])(constants_1['FLOSUM_COMPONENT'],this[_0x5f4ec8(0xea)](_0x3a386c)),_0x4f3c4b=(0x0,composite_utils_1[_0x5f4ec8(0x101)])(constants_1[_0x5f4ec8(0xfd)],this['prepareComponentHistoryRecord'](_0x3a386c,'@{'+_0x197e32[_0x5f4ec8(0xee)]+'.id}')),_0x3f7cc2=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x5f4ec8(0x129)],await this[_0x5f4ec8(0x10f)](_0x3a386c,'@{'+_0x4f3c4b[_0x5f4ec8(0xee)]+_0x5f4ec8(0xf9)));this[_0x5f4ec8(0x133)](_0x197e32[_0x5f4ec8(0x116)]['body'],_0x197e32[_0x5f4ec8(0xee)]),_0x589a11['push'](_0x197e32[_0x5f4ec8(0x116)],_0x4f3c4b[_0x5f4ec8(0x116)],_0x3f7cc2[_0x5f4ec8(0x116)]),_0x8d94f2&&_0x589a11[_0x5f4ec8(0xd9)](this['prepareCommitManifest'](_0x8d94f2,'@{'+_0x4f3c4b[_0x5f4ec8(0xee)]+_0x5f4ec8(0xf9)));}return _0x589a11;}async[a234_0x2fa7ea(0xde)](_0x402fb1,_0x85792c=''){const _0x296898=a234_0x2fa7ea,_0x3b44bf=[];for(const {component:_0x5d6f3d,meta:_0x2934a3}of _0x402fb1){if(!_0x2934a3['id']){const _0x252939=this[_0x296898(0xfe)][_0x296898(0x127)](_0x20e476=>_0x20e476['componentName']===_0x5d6f3d[_0x296898(0xe0)]&&_0x20e476[_0x296898(0x124)]===_0x5d6f3d['type']);if(!_0x252939)throw new salesforce_error_1['SalesforceError'](new Error(_0x296898(0x11c)+_0x5d6f3d[_0x296898(0xe0)]+'\x20['+_0x5d6f3d['type']+']\x20-\x20meta\x20not\x20found'));_0x2934a3['id']=_0x252939[_0x296898(0x11b)];}const _0x233a3a=(0x0,composite_utils_1[_0x296898(0x136)])(constants_1[_0x296898(0x113)],_0x2934a3['id'],this['prepareComponentRecord'](_0x5d6f3d,_0x2934a3)),_0x5f02ed=(0x0,composite_utils_1[_0x296898(0x101)])(constants_1[_0x296898(0xfd)],this[_0x296898(0x137)](_0x5d6f3d,_0x2934a3['id'],_0x2934a3[_0x296898(0xec)])),_0x228a7b=(0x0,composite_utils_1[_0x296898(0x101)])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x296898(0x10f)](_0x5d6f3d,'@{'+_0x5f02ed[_0x296898(0xee)]+'.id}'));this[_0x296898(0x133)](_0x233a3a[_0x296898(0x116)][_0x296898(0x119)],_0x233a3a[_0x296898(0xee)]),_0x3b44bf[_0x296898(0xd9)](_0x233a3a[_0x296898(0x116)],_0x5f02ed[_0x296898(0x116)],_0x228a7b[_0x296898(0x116)]),_0x85792c&&_0x3b44bf[_0x296898(0xd9)](this[_0x296898(0xf3)](_0x85792c,'@{'+_0x5f02ed[_0x296898(0xee)]+_0x296898(0xf9)));}return _0x3b44bf;}async[a234_0x2fa7ea(0x130)](_0x39eb81,_0x532f03=![]){const _0x12bbd4=a234_0x2fa7ea,_0x80602e={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x181eb4=[];for(const _0x2e9fb7 of _0x39eb81){if(_0x2e9fb7['id'])_0x181eb4[_0x12bbd4(0xd9)](_0x2e9fb7['id']);else{const _0xd825ea=this[_0x12bbd4(0xfe)][_0x12bbd4(0x127)](_0x2dbe6d=>_0x2dbe6d[_0x12bbd4(0xf6)]===_0x2e9fb7[_0x12bbd4(0xe0)]&&_0x2dbe6d[_0x12bbd4(0x124)]===_0x2e9fb7[_0x12bbd4(0xe7)]);if(!_0xd825ea||!_0xd825ea[_0x12bbd4(0x11b)])continue;_0x181eb4['push'](_0xd825ea[_0x12bbd4(0x11b)]);}}if(_0x532f03){const _0x239270=await this['gitSync'][_0x12bbd4(0xe6)](_0x181eb4);_0x80602e['manifests']=_0x239270[_0x12bbd4(0xe4)](_0x19356a=>(0x0,composite_utils_1[_0x12bbd4(0xf8)])(constants_1['FLOSUM_COMMIT_MANIFEST'],_0x19356a)[_0x12bbd4(0x116)]);}return _0x80602e[_0x12bbd4(0x11a)]=_0x181eb4[_0x12bbd4(0xe4)](_0x359287=>(0x0,composite_utils_1[_0x12bbd4(0x136)])(constants_1[_0x12bbd4(0x113)],_0x359287,{[constants_1[_0x12bbd4(0xf0)]+'Deletion_By_Agent__c']:!![]})[_0x12bbd4(0x116)]),_0x80602e[_0x12bbd4(0x105)]=_0x181eb4[_0x12bbd4(0xe4)](_0xc5b851=>(0x0,composite_utils_1[_0x12bbd4(0xf8)])(constants_1[_0x12bbd4(0x113)],_0xc5b851)[_0x12bbd4(0x116)]),_0x80602e;}}exports[a234_0x2fa7ea(0x106)]=SalesforceComponentsManager;