const a195_0x50efeb=a195_0x2cb1;(function(_0x1f6dc9,_0x4ae4e3){const _0x599aec=a195_0x2cb1,_0x251cad=_0x1f6dc9();while(!![]){try{const _0x38eb31=parseInt(_0x599aec(0x85))/0x1+-parseInt(_0x599aec(0x7d))/0x2+-parseInt(_0x599aec(0x83))/0x3+parseInt(_0x599aec(0x96))/0x4+-parseInt(_0x599aec(0xae))/0x5*(parseInt(_0x599aec(0xb3))/0x6)+-parseInt(_0x599aec(0x6e))/0x7*(-parseInt(_0x599aec(0x8c))/0x8)+parseInt(_0x599aec(0xa5))/0x9*(parseInt(_0x599aec(0xc6))/0xa);if(_0x38eb31===_0x4ae4e3)break;else _0x251cad['push'](_0x251cad['shift']());}catch(_0x3c8fb9){_0x251cad['push'](_0x251cad['shift']());}}}(a195_0x2041,0x247b5));const a195_0x35705d=(function(){let _0x42310a=!![];return function(_0x1fab6b,_0x672351){const _0xb18852=_0x42310a?function(){const _0xe34169=a195_0x2cb1;if(_0x672351){const _0x2ee9f9=_0x672351[_0xe34169(0x6c)](_0x1fab6b,arguments);return _0x672351=null,_0x2ee9f9;}}:function(){};return _0x42310a=![],_0xb18852;};}()),a195_0x8c1a41=a195_0x35705d(this,function(){const _0x2ba1f4=a195_0x2cb1;return a195_0x8c1a41['toString']()['search']('(((.+)+)+)+$')[_0x2ba1f4(0x97)]()[_0x2ba1f4(0x9e)](a195_0x8c1a41)[_0x2ba1f4(0xba)](_0x2ba1f4(0x99));});function a195_0x2cb1(_0x2833cc,_0x2bfeb0){const _0x433687=a195_0x2041();return a195_0x2cb1=function(_0x8c1a41,_0x35705d){_0x8c1a41=_0x8c1a41-0x65;let _0x204189=_0x433687[_0x8c1a41];return _0x204189;},a195_0x2cb1(_0x2833cc,_0x2bfeb0);}a195_0x8c1a41();'use strict';function a195_0x2041(){const _0x54cd8f=['crc','branchId','constructor','find','push','__esModule','map','FLOSUM_COMPONENT_HISTORY','Last_Modified_By__c','1401993XtvyuV','proceededComponentsMeta','ParentId','../errors/salesforce.error','Changed_On__c','componentsToUpdate','Body','Source__c','Component__c','10lqdWMB','getProceededComponentsMeta','typedi','../../parsers/utils/zip','componentName','458658yQYyzM','../utils/composite.utils','request','Changed_By__c','manifests','createDeleteRequest','SalesforceError','search','__importDefault','Zip','generateAsync','Deletion_By_Agent__c','username','Committed_On__c','reference','defineProperty','delete','Commit__c','base64','20lVMBHb','prepareComponentHistoryRecord','FLOSUM_NAMESPACE','type','default','application/zip','createZip','prepareCommitManifest','FLOSUM_COMPONENT','files','fetchCommitManifestsByComponentIds','prepareComponentRecord','apply','update','822374AFhplm','File_Name__c','Repository','body','../../../../constants','proceedComponentMeta','Last_Updated_By__c','FLOSUM_COMMIT_MANIFEST','ContentType','FLOSUM_GIT_NAMESPACE','Branch__c','Is_From_Agent__c','repositoryId','Branch','prepareComponentAttachmentRecord','470126XDUUeb','Name','toISOString','DEFLATE','name','SalesforceGitSyncService','486468Vczxuv','insert','27445Ukplre','createPostRequest','createPatchRequest','.id}','CRC32__c','get','gitSync','16YTwcaI','recordTypes','Version__c','componentId','logger','../utils/flosum-naming.utils','Component_Name__c','RecordTypeId','componentType','SalesforceComponentsManager','502284XnkMXv','toString','./salesforce-git-sync.service','(((.+)+)+)+$','Component_Type__c','Component_History__c'];a195_0x2041=function(){return _0x54cd8f;};return a195_0x2041();}var __importDefault=this&&this[a195_0x50efeb(0xbb)]||function(_0x100ac5){return _0x100ac5&&_0x100ac5['__esModule']?_0x100ac5:{'default':_0x100ac5};};Object[a195_0x50efeb(0xc2)](exports,a195_0x50efeb(0xa1),{'value':!![]}),exports[a195_0x50efeb(0x95)]=void 0x0;const constants_1=require(a195_0x50efeb(0x72)),core_1=require('../../../../core'),zip_1=require(a195_0x50efeb(0xb1)),typedi_1=__importDefault(require(a195_0x50efeb(0xb0))),salesforce_error_1=require(a195_0x50efeb(0xa8)),composite_utils_1=require(a195_0x50efeb(0xb4)),flosum_naming_utils_1=require(a195_0x50efeb(0x91)),salesforce_git_sync_service_1=require(a195_0x50efeb(0x98));class SalesforceComponentsManager{constructor(_0x316970,_0x3b5c44,_0x15e487,_0x1c85f8,_0x3ad401){const _0xc23bf0=a195_0x50efeb;this[_0xc23bf0(0x7a)]=_0x316970,this[_0xc23bf0(0x9d)]=_0x3b5c44,this[_0xc23bf0(0xbf)]=_0x15e487,this[_0xc23bf0(0x8d)]=_0x1c85f8,this[_0xc23bf0(0xa6)]=_0x3ad401,this[_0xc23bf0(0x90)]=new core_1['Logger'](SalesforceComponentsManager['name']),this[_0xc23bf0(0x8b)]=typedi_1[_0xc23bf0(0xca)][_0xc23bf0(0x8a)](salesforce_git_sync_service_1[_0xc23bf0(0x82)]);}[a195_0x50efeb(0x73)](_0x3bc016,_0x3f0b43){const _0x42dca3=a195_0x50efeb,_0x464fa9=(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x3bc016,[_0x42dca3(0x9a),_0x42dca3(0x92),_0x42dca3(0x8e)]);this[_0x42dca3(0xa6)][_0x42dca3(0xa0)]({'componentId':'','reference':_0x3f0b43,'version':_0x464fa9[_0x42dca3(0x8e)],'componentName':_0x464fa9[_0x42dca3(0x92)],'componentType':_0x464fa9['Component_Type__c']});}[a195_0x50efeb(0x67)](_0x1c8742,_0x493962){const _0xa05584=a195_0x50efeb,{request:_0x55a715}=(0x0,composite_utils_1[_0xa05584(0x86)])(constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1[_0xa05584(0xc8)]+_0xa05584(0xc4)]:_0x1c8742,[constants_1[_0xa05584(0xc8)]+_0xa05584(0x9b)]:_0x493962});return _0x55a715;}async[a195_0x50efeb(0x7c)](_0x5b0b1d,_0x1630e4){const _0x3e0491=a195_0x50efeb,_0x3e9d76={},_0x6ef230=zip_1[_0x3e0491(0xbc)][_0x3e0491(0x66)]();for(const _0x343d4f of Object['keys'](_0x5b0b1d['files'])){_0x6ef230['file'](_0x343d4f,_0x5b0b1d[_0x3e0491(0x69)][_0x343d4f],{'createFolders':!![]});}return _0x3e9d76[_0x3e0491(0x76)]=_0x3e0491(0x65),_0x3e9d76[_0x3e0491(0x7e)]=_0x5b0b1d['type'],_0x3e9d76['Description']=_0x5b0b1d['type'],_0x3e9d76[_0x3e0491(0xa7)]=_0x1630e4,_0x3e9d76[_0x3e0491(0xab)]=await _0x6ef230[_0x3e0491(0xbd)]({'type':_0x3e0491(0xc5),'compression':_0x3e0491(0x80),'compressionOptions':{'level':0x6}}),_0x3e9d76;}[a195_0x50efeb(0xc7)](_0x4e461d,_0x49ba56,_0x2b803f){const _0x1622bb=a195_0x50efeb,_0x338399=new Date()[_0x1622bb(0x7f)](),_0x3a5b70={};return _0x3a5b70[constants_1[_0x1622bb(0xc8)]+_0x1622bb(0xad)]=_0x49ba56,_0x3a5b70[constants_1[_0x1622bb(0xc8)]+_0x1622bb(0x89)]=_0x4e461d[_0x1622bb(0x9c)],_0x3a5b70[constants_1[_0x1622bb(0xc8)]+_0x1622bb(0xa9)]=_0x338399,_0x3a5b70[constants_1['FLOSUM_NAMESPACE']+_0x1622bb(0xb6)]=this[_0x1622bb(0xbf)],_0x3a5b70[constants_1[_0x1622bb(0xc8)]+_0x1622bb(0x8e)]=_0x2b803f?_0x2b803f+0x1:0x1,_0x3a5b70[constants_1['FLOSUM_GIT_NAMESPACE']+_0x1622bb(0x79)]=!![],_0x3a5b70;}[a195_0x50efeb(0x6b)](_0x19bbfe,_0x1f4439){const _0x3b0f8a=a195_0x50efeb;var _0x1057fe,_0x4557a1;const _0x1c697e=new Date()[_0x3b0f8a(0x7f)](),_0x197f0c={};return!_0x1f4439?(this[_0x3b0f8a(0x9d)]?(_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0x78)]=this[_0x3b0f8a(0x9d)],_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0xac)]='Branch',_0x197f0c[_0x3b0f8a(0x93)]=(_0x1057fe=this[_0x3b0f8a(0x8d)][_0x3b0f8a(0x9f)](_0x3f39a1=>_0x3f39a1[_0x3b0f8a(0x81)]===_0x3b0f8a(0x7b)))===null||_0x1057fe===void 0x0?void 0x0:_0x1057fe['id']):(_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+'Repository__c']=this[_0x3b0f8a(0x7a)],_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+'Source__c']=_0x3b0f8a(0x70),_0x197f0c[_0x3b0f8a(0x93)]=(_0x4557a1=this[_0x3b0f8a(0x8d)]['find'](_0x27f55b=>_0x27f55b['name']===_0x3b0f8a(0x70)))===null||_0x4557a1===void 0x0?void 0x0:_0x4557a1['id']),_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0x8e)]=0x1):_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0x8e)]=_0x1f4439['version']+0x1,_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0x9a)]=_0x19bbfe['type'],_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0x92)]=_0x19bbfe[_0x3b0f8a(0x81)],_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0x6f)]=_0x19bbfe['filePath'],_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0x74)]=this[_0x3b0f8a(0xbf)],_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+_0x3b0f8a(0xa4)]=this['username'],_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+'Last_Modified_Date__c']=_0x1c697e,_0x197f0c[constants_1['FLOSUM_NAMESPACE']+_0x3b0f8a(0xc0)]=_0x1c697e,_0x197f0c[constants_1[_0x3b0f8a(0xc8)]+'CRC32__c']=_0x19bbfe['crc'],_0x197f0c;}[a195_0x50efeb(0xaf)](){const _0x8b546a=a195_0x50efeb;return this[_0x8b546a(0xa6)];}async[a195_0x50efeb(0x84)](_0x228bd5,_0x1fef91){const _0x5748f5=a195_0x50efeb,_0x39a514=[];for(const _0x7f8705 of _0x228bd5){const _0x4fe831=(0x0,composite_utils_1[_0x5748f5(0x86)])(constants_1[_0x5748f5(0x68)],this[_0x5748f5(0x6b)](_0x7f8705)),_0x46ca28=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x5748f5(0xa3)],this[_0x5748f5(0xc7)](_0x7f8705,'@{'+_0x4fe831['reference']+_0x5748f5(0x88))),_0x2b75c9=(0x0,composite_utils_1[_0x5748f5(0x86)])(constants_1['FLOSUM_ATTACHMENT'],await this['prepareComponentAttachmentRecord'](_0x7f8705,'@{'+_0x46ca28[_0x5748f5(0xc1)]+'.id}'));this[_0x5748f5(0x73)](_0x4fe831['request'][_0x5748f5(0x71)],_0x4fe831[_0x5748f5(0xc1)]),_0x39a514[_0x5748f5(0xa0)](_0x4fe831['request'],_0x46ca28['request'],_0x2b75c9['request']),_0x1fef91&&_0x39a514[_0x5748f5(0xa0)](this[_0x5748f5(0x67)](_0x1fef91,'@{'+_0x46ca28[_0x5748f5(0xc1)]+'.id}'));}return _0x39a514;}async[a195_0x50efeb(0x6d)](_0x3086ca,_0xa33792=''){const _0x43492b=a195_0x50efeb,_0x5b0290=[];for(const {component:_0x8bf421,meta:_0x1ca4e5}of _0x3086ca){if(!_0x1ca4e5['id']){const _0x4b2f86=this[_0x43492b(0xa6)][_0x43492b(0x9f)](_0x5c7e7e=>_0x5c7e7e['componentName']===_0x8bf421[_0x43492b(0x81)]&&_0x5c7e7e[_0x43492b(0x94)]===_0x8bf421[_0x43492b(0xc9)]);if(!_0x4b2f86)throw new salesforce_error_1[(_0x43492b(0xb9))](new Error('Could\x20not\x20proceed\x20component\x20'+_0x8bf421[_0x43492b(0x81)]+'\x20['+_0x8bf421[_0x43492b(0xc9)]+']\x20-\x20meta\x20not\x20found'));_0x1ca4e5['id']=_0x4b2f86[_0x43492b(0x8f)];}const _0x5061a4=(0x0,composite_utils_1['createPatchRequest'])(constants_1['FLOSUM_COMPONENT'],_0x1ca4e5['id'],this['prepareComponentRecord'](_0x8bf421,_0x1ca4e5)),_0x203926=(0x0,composite_utils_1[_0x43492b(0x86)])(constants_1[_0x43492b(0xa3)],this[_0x43492b(0xc7)](_0x8bf421,_0x1ca4e5['id'],_0x1ca4e5['version'])),_0x13b0f4=(0x0,composite_utils_1[_0x43492b(0x86)])(constants_1['FLOSUM_ATTACHMENT'],await this['prepareComponentAttachmentRecord'](_0x8bf421,'@{'+_0x203926['reference']+'.id}'));this[_0x43492b(0x73)](_0x5061a4[_0x43492b(0xb5)][_0x43492b(0x71)],_0x5061a4[_0x43492b(0xc1)]),_0x5b0290[_0x43492b(0xa0)](_0x5061a4['request'],_0x203926[_0x43492b(0xb5)],_0x13b0f4[_0x43492b(0xb5)]),_0xa33792&&_0x5b0290[_0x43492b(0xa0)](this[_0x43492b(0x67)](_0xa33792,'@{'+_0x203926['reference']+'.id}'));}return _0x5b0290;}async[a195_0x50efeb(0xc3)](_0x5a7e24,_0xa4f11c=![]){const _0x25161c=a195_0x50efeb,_0x39242b={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x4722b8=[];for(const _0x8cd02f of _0x5a7e24){if(_0x8cd02f['id'])_0x4722b8[_0x25161c(0xa0)](_0x8cd02f['id']);else{const _0x5ce0fb=this[_0x25161c(0xa6)][_0x25161c(0x9f)](_0x4fa958=>_0x4fa958[_0x25161c(0xb2)]===_0x8cd02f['name']&&_0x4fa958['componentType']===_0x8cd02f[_0x25161c(0xc9)]);if(!_0x5ce0fb||!_0x5ce0fb[_0x25161c(0x8f)])continue;_0x4722b8[_0x25161c(0xa0)](_0x5ce0fb[_0x25161c(0x8f)]);}}if(_0xa4f11c){const _0x2bf347=await this[_0x25161c(0x8b)][_0x25161c(0x6a)](_0x4722b8);_0x39242b[_0x25161c(0xb7)]=_0x2bf347['map'](_0x23a90e=>(0x0,composite_utils_1[_0x25161c(0xb8)])(constants_1[_0x25161c(0x75)],_0x23a90e)[_0x25161c(0xb5)]);}return _0x39242b[_0x25161c(0xaa)]=_0x4722b8[_0x25161c(0xa2)](_0x508d27=>(0x0,composite_utils_1[_0x25161c(0x87)])(constants_1[_0x25161c(0x68)],_0x508d27,{[constants_1[_0x25161c(0x77)]+_0x25161c(0xbe)]:!![]})[_0x25161c(0xb5)]),_0x39242b['componentsToDelete']=_0x4722b8['map'](_0x4b6b2f=>(0x0,composite_utils_1[_0x25161c(0xb8)])(constants_1[_0x25161c(0x68)],_0x4b6b2f)[_0x25161c(0xb5)]),_0x39242b;}}exports[a195_0x50efeb(0x95)]=SalesforceComponentsManager;