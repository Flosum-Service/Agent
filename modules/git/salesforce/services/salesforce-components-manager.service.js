const a234_0x1f2281=a234_0x1164;(function(_0x23bf21,_0x1e98c9){const _0x38be2d=a234_0x1164,_0xa54cd0=_0x23bf21();while(!![]){try{const _0x414837=parseInt(_0x38be2d(0x187))/0x1*(parseInt(_0x38be2d(0x1b7))/0x2)+-parseInt(_0x38be2d(0x1b3))/0x3*(-parseInt(_0x38be2d(0x1a7))/0x4)+parseInt(_0x38be2d(0x191))/0x5+parseInt(_0x38be2d(0x1d5))/0x6*(-parseInt(_0x38be2d(0x1c0))/0x7)+parseInt(_0x38be2d(0x19c))/0x8*(parseInt(_0x38be2d(0x178))/0x9)+parseInt(_0x38be2d(0x198))/0xa*(-parseInt(_0x38be2d(0x1a0))/0xb)+-parseInt(_0x38be2d(0x1a3))/0xc;if(_0x414837===_0x1e98c9)break;else _0xa54cd0['push'](_0xa54cd0['shift']());}catch(_0x2a8fed){_0xa54cd0['push'](_0xa54cd0['shift']());}}}(a234_0x1beb,0x9f223));const a234_0x24b3a7=(function(){let _0x590fd5=!![];return function(_0x1b24d1,_0xaacde){const _0x1741f8=_0x590fd5?function(){if(_0xaacde){const _0x571b70=_0xaacde['apply'](_0x1b24d1,arguments);return _0xaacde=null,_0x571b70;}}:function(){};return _0x590fd5=![],_0x1741f8;};}()),a234_0x268c35=a234_0x24b3a7(this,function(){const _0x222945=a234_0x1164;return a234_0x268c35[_0x222945(0x1cf)]()['search'](_0x222945(0x185))[_0x222945(0x1cf)]()[_0x222945(0x1ae)](a234_0x268c35)['search']('(((.+)+)+)+$');});a234_0x268c35();'use strict';var __importDefault=this&&this[a234_0x1f2281(0x174)]||function(_0x41d4b9){const _0x27b893=a234_0x1f2281;return _0x41d4b9&&_0x41d4b9[_0x27b893(0x184)]?_0x41d4b9:{'default':_0x41d4b9};};function a234_0x1164(_0x35e282,_0x367b60){const _0x3edc2a=a234_0x1beb();return a234_0x1164=function(_0x268c35,_0x24b3a7){_0x268c35=_0x268c35-0x170;let _0x1beb04=_0x3edc2a[_0x268c35];return _0x1beb04;},a234_0x1164(_0x35e282,_0x367b60);}Object[a234_0x1f2281(0x1c2)](exports,a234_0x1f2281(0x184),{'value':!![]}),exports[a234_0x1f2281(0x19f)]=void 0x0;const constants_1=require(a234_0x1f2281(0x1c1)),core_1=require(a234_0x1f2281(0x183)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a234_0x1f2281(0x196)),composite_utils_1=require(a234_0x1f2281(0x1bd)),flosum_naming_utils_1=require(a234_0x1f2281(0x1a9)),salesforce_git_sync_service_1=require(a234_0x1f2281(0x1b4));class SalesforceComponentsManager{constructor(_0x1b2116,_0x31cfcc,_0x359cf2,_0x172ce3,_0x1ca2e8){const _0x1a8df1=a234_0x1f2281;this[_0x1a8df1(0x1b8)]=_0x1b2116,this[_0x1a8df1(0x19b)]=_0x31cfcc,this['username']=_0x359cf2,this[_0x1a8df1(0x1be)]=_0x172ce3,this[_0x1a8df1(0x1a2)]=_0x1ca2e8,this[_0x1a8df1(0x18d)]=new core_1[(_0x1a8df1(0x1cd))](SalesforceComponentsManager[_0x1a8df1(0x1ca)]),this[_0x1a8df1(0x190)]=typedi_1[_0x1a8df1(0x1b5)][_0x1a8df1(0x1b0)](salesforce_git_sync_service_1[_0x1a8df1(0x17c)]);}[a234_0x1f2281(0x17a)](_0x15f66d,_0x7ed2cb){const _0x4a2be6=a234_0x1f2281,_0x35b439=(0x0,flosum_naming_utils_1[_0x4a2be6(0x1d4)])(_0x15f66d,['Component_Type__c',_0x4a2be6(0x1b6),_0x4a2be6(0x1ba)]);this[_0x4a2be6(0x1a2)][_0x4a2be6(0x19d)]({'componentId':'','reference':_0x7ed2cb,'version':_0x35b439['Version__c'],'componentName':_0x35b439['Component_Name__c'],'componentType':_0x35b439['Component_Type__c']});}[a234_0x1f2281(0x171)](_0x447b3c,_0x2461a3){const _0x105884=a234_0x1f2281,{request:_0x286737}=(0x0,composite_utils_1[_0x105884(0x1aa)])(constants_1[_0x105884(0x177)],{[constants_1[_0x105884(0x1b2)]+'Commit__c']:_0x447b3c,[constants_1[_0x105884(0x1b2)]+_0x105884(0x199)]:_0x2461a3});return _0x286737;}async[a234_0x1f2281(0x18c)](_0x271e5b,_0x291b0a){const _0x5e0c73=a234_0x1f2281,_0x377df5={},_0x223268=zip_1[_0x5e0c73(0x1bb)][_0x5e0c73(0x186)]();for(const _0x31f018 of Object[_0x5e0c73(0x175)](_0x271e5b[_0x5e0c73(0x18f)])){_0x223268[_0x5e0c73(0x1c3)](_0x31f018,_0x271e5b['files'][_0x31f018],{'createFolders':!![]});}return _0x377df5[_0x5e0c73(0x1cb)]='application/zip',_0x377df5[_0x5e0c73(0x1b1)]=_0x271e5b[_0x5e0c73(0x1c4)],_0x377df5[_0x5e0c73(0x1c7)]=_0x271e5b[_0x5e0c73(0x1c4)],_0x377df5[_0x5e0c73(0x1d3)]=_0x291b0a,_0x377df5['Body']=await _0x223268['generateAsync']({'type':'base64','compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x377df5;}[a234_0x1f2281(0x179)](_0x1b3df5,_0x4e3288,_0x1bc3b0){const _0x1b195e=a234_0x1f2281,_0x346a42=new Date()[_0x1b195e(0x182)](),_0x1f2239={};return _0x1f2239[constants_1[_0x1b195e(0x1b2)]+'Component__c']=_0x4e3288,_0x1f2239[constants_1[_0x1b195e(0x1b2)]+_0x1b195e(0x1af)]=_0x1b3df5[_0x1b195e(0x1d7)],_0x1f2239[constants_1[_0x1b195e(0x1b2)]+'Changed_On__c']=_0x346a42,_0x1f2239[constants_1[_0x1b195e(0x1b2)]+_0x1b195e(0x1a6)]=this[_0x1b195e(0x181)],_0x1f2239[constants_1[_0x1b195e(0x1b2)]+'Version__c']=_0x1bc3b0?_0x1bc3b0+0x1:0x1,_0x1f2239[constants_1[_0x1b195e(0x1b9)]+_0x1b195e(0x1ce)]=!![],_0x1f2239;}[a234_0x1f2281(0x18a)](_0x21d134,_0x597984){const _0x312ca1=a234_0x1f2281;var _0x439cc8,_0x4cbd2f;const _0x5aad1e=new Date()['toISOString'](),_0x5bb6f3={};return!_0x597984?(this['branchId']?(_0x5bb6f3[constants_1['FLOSUM_NAMESPACE']+_0x312ca1(0x195)]=this[_0x312ca1(0x19b)],_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x170)]='Branch',_0x5bb6f3['RecordTypeId']=(_0x439cc8=this[_0x312ca1(0x1be)][_0x312ca1(0x1ab)](_0x5ade1e=>_0x5ade1e[_0x312ca1(0x1ca)]===_0x312ca1(0x17b)))===null||_0x439cc8===void 0x0?void 0x0:_0x439cc8['id']):(_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x1c9)]=this[_0x312ca1(0x1b8)],_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x170)]='Repository',_0x5bb6f3['RecordTypeId']=(_0x4cbd2f=this['recordTypes']['find'](_0x2954e2=>_0x2954e2[_0x312ca1(0x1ca)]===_0x312ca1(0x1d1)))===null||_0x4cbd2f===void 0x0?void 0x0:_0x4cbd2f['id']),_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x1ba)]=0x1):_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+'Version__c']=_0x597984[_0x312ca1(0x1cc)]+0x1,_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x1a1)]=_0x21d134[_0x312ca1(0x1c4)],_0x5bb6f3[constants_1['FLOSUM_NAMESPACE']+_0x312ca1(0x1b6)]=_0x21d134[_0x312ca1(0x1ca)],_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x17e)]=_0x21d134['filePath'],_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x1a4)]=this['username'],_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x1c5)]=this['username'],_0x5bb6f3[constants_1['FLOSUM_NAMESPACE']+'Last_Modified_Date__c']=_0x5aad1e,_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+'Committed_On__c']=_0x5aad1e,_0x5bb6f3[constants_1['FLOSUM_NAMESPACE']+_0x312ca1(0x1af)]=_0x21d134['crc'],_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x1d0)]=_0x21d134[_0x312ca1(0x180)],_0x5bb6f3[constants_1[_0x312ca1(0x1b2)]+_0x312ca1(0x19e)]=_0x21d134[_0x312ca1(0x1bc)],_0x5bb6f3;}[a234_0x1f2281(0x176)](){return this['proceededComponentsMeta'];}async[a234_0x1f2281(0x18e)](_0x20f3f5,_0x434051){const _0x4129df=a234_0x1f2281,_0x53b1f3=[];for(const _0x1dfca5 of _0x20f3f5){const _0x4a456e=(0x0,composite_utils_1[_0x4129df(0x1aa)])(constants_1[_0x4129df(0x189)],this[_0x4129df(0x18a)](_0x1dfca5)),_0x3846fc=(0x0,composite_utils_1[_0x4129df(0x1aa)])(constants_1[_0x4129df(0x188)],this[_0x4129df(0x179)](_0x1dfca5,'@{'+_0x4a456e[_0x4129df(0x1ac)]+'.id}')),_0x5832da=(0x0,composite_utils_1[_0x4129df(0x1aa)])(constants_1[_0x4129df(0x1d6)],await this[_0x4129df(0x18c)](_0x1dfca5,'@{'+_0x3846fc[_0x4129df(0x1ac)]+_0x4129df(0x17f)));this[_0x4129df(0x17a)](_0x4a456e[_0x4129df(0x17d)][_0x4129df(0x193)],_0x4a456e[_0x4129df(0x1ac)]),_0x53b1f3['push'](_0x4a456e[_0x4129df(0x17d)],_0x3846fc[_0x4129df(0x17d)],_0x5832da[_0x4129df(0x17d)]),_0x434051&&_0x53b1f3[_0x4129df(0x19d)](this['prepareCommitManifest'](_0x434051,'@{'+_0x3846fc[_0x4129df(0x1ac)]+_0x4129df(0x17f)));}return _0x53b1f3;}async[a234_0x1f2281(0x19a)](_0x67ff74,_0x401eed=''){const _0x243b82=a234_0x1f2281,_0xa46b6e=[];for(const {component:_0xb2c36d,meta:_0xc7f7c9}of _0x67ff74){if(!_0xc7f7c9['id']){const _0x36e552=this[_0x243b82(0x1a2)][_0x243b82(0x1ab)](_0x32a81e=>_0x32a81e['componentName']===_0xb2c36d[_0x243b82(0x1ca)]&&_0x32a81e[_0x243b82(0x1a5)]===_0xb2c36d['type']);if(!_0x36e552)throw new salesforce_error_1[(_0x243b82(0x172))](new Error(_0x243b82(0x197)+_0xb2c36d[_0x243b82(0x1ca)]+'\x20['+_0xb2c36d[_0x243b82(0x1c4)]+_0x243b82(0x1d2)));_0xc7f7c9['id']=_0x36e552['componentId'];}const _0x3a7046=(0x0,composite_utils_1['createPatchRequest'])(constants_1['FLOSUM_COMPONENT'],_0xc7f7c9['id'],this['prepareComponentRecord'](_0xb2c36d,_0xc7f7c9)),_0x3f1dce=(0x0,composite_utils_1[_0x243b82(0x1aa)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x243b82(0x179)](_0xb2c36d,_0xc7f7c9['id'],_0xc7f7c9[_0x243b82(0x1cc)])),_0x23857e=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x243b82(0x18c)](_0xb2c36d,'@{'+_0x3f1dce[_0x243b82(0x1ac)]+_0x243b82(0x17f)));this['proceedComponentMeta'](_0x3a7046[_0x243b82(0x17d)][_0x243b82(0x193)],_0x3a7046[_0x243b82(0x1ac)]),_0xa46b6e['push'](_0x3a7046[_0x243b82(0x17d)],_0x3f1dce[_0x243b82(0x17d)],_0x23857e['request']),_0x401eed&&_0xa46b6e[_0x243b82(0x19d)](this['prepareCommitManifest'](_0x401eed,'@{'+_0x3f1dce['reference']+_0x243b82(0x17f)));}return _0xa46b6e;}async[a234_0x1f2281(0x173)](_0x55717c,_0xc3860a=![]){const _0x5ec199=a234_0x1f2281,_0x4734df={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x1a8f81=[];for(const _0x2181b1 of _0x55717c){if(_0x2181b1['id'])_0x1a8f81['push'](_0x2181b1['id']);else{const _0x3e2b41=this[_0x5ec199(0x1a2)][_0x5ec199(0x1ab)](_0x140dd0=>_0x140dd0[_0x5ec199(0x192)]===_0x2181b1[_0x5ec199(0x1ca)]&&_0x140dd0['componentType']===_0x2181b1[_0x5ec199(0x1c4)]);if(!_0x3e2b41||!_0x3e2b41[_0x5ec199(0x1ad)])continue;_0x1a8f81[_0x5ec199(0x19d)](_0x3e2b41['componentId']);}}if(_0xc3860a){const _0x349c10=await this['gitSync'][_0x5ec199(0x18b)](_0x1a8f81);_0x4734df[_0x5ec199(0x194)]=_0x349c10['map'](_0x56e058=>(0x0,composite_utils_1[_0x5ec199(0x1c6)])(constants_1[_0x5ec199(0x177)],_0x56e058)[_0x5ec199(0x17d)]);}return _0x4734df['componentsToUpdate']=_0x1a8f81['map'](_0x41fe6a=>(0x0,composite_utils_1[_0x5ec199(0x1bf)])(constants_1[_0x5ec199(0x189)],_0x41fe6a,{[constants_1[_0x5ec199(0x1b9)]+'Deletion_By_Agent__c']:!![]})[_0x5ec199(0x17d)]),_0x4734df[_0x5ec199(0x1c8)]=_0x1a8f81[_0x5ec199(0x1a8)](_0x288175=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1['FLOSUM_COMPONENT'],_0x288175)[_0x5ec199(0x17d)]),_0x4734df;}}exports[a234_0x1f2281(0x19f)]=SalesforceComponentsManager;function a234_0x1beb(){const _0x5746ce=['Last_Updated_By__c','componentType','Changed_By__c','3028972cPYpyV','map','../utils/flosum-naming.utils','createPostRequest','find','reference','componentId','constructor','CRC32__c','get','Name','FLOSUM_NAMESPACE','3eCGpje','./salesforce-git-sync.service','default','Component_Name__c','1576090OoGjDS','repositoryId','FLOSUM_GIT_NAMESPACE','Version__c','Zip','isVlocityComponent','../utils/composite.utils','recordTypes','createPatchRequest','35sFaIJH','../../../../constants','defineProperty','file','type','Last_Modified_By__c','createDeleteRequest','Description','componentsToDelete','Repository__c','name','ContentType','version','Logger','Is_From_Agent__c','toString','Vlocity_Component_Name__c','Repository',']\x20-\x20meta\x20not\x20found','ParentId','extractFieldsFromRecord','635754gerYlP','FLOSUM_ATTACHMENT','crc','Source__c','prepareCommitManifest','SalesforceError','delete','__importDefault','keys','getProceededComponentsMeta','FLOSUM_COMMIT_MANIFEST','9YaRgsM','prepareComponentHistoryRecord','proceedComponentMeta','Branch','SalesforceGitSyncService','request','File_Name__c','.id}','vlocityComponentName','username','toISOString','../../../../core','__esModule','(((.+)+)+)+$','createZip','1eeVglf','FLOSUM_COMPONENT_HISTORY','FLOSUM_COMPONENT','prepareComponentRecord','fetchCommitManifestsByComponentIds','prepareComponentAttachmentRecord','logger','insert','files','gitSync','2683950fWbcde','componentName','body','manifests','Branch__c','../errors/salesforce.error','Could\x20not\x20proceed\x20component\x20','40RFkZea','Component_History__c','update','branchId','9628488vGkemN','push','Vlocity_Component__c','SalesforceComponentsManager','1198978eYrVwv','Component_Type__c','proceededComponentsMeta','20016492pMCqcO'];a234_0x1beb=function(){return _0x5746ce;};return a234_0x1beb();}