const a182_0x2fef18=a182_0x3450;(function(_0x4e60e4,_0x10090f){const _0xf03e3f=a182_0x3450,_0x4ec456=_0x4e60e4();while(!![]){try{const _0x1ea879=-parseInt(_0xf03e3f(0xb4))/0x1*(-parseInt(_0xf03e3f(0x10a))/0x2)+parseInt(_0xf03e3f(0xc7))/0x3*(-parseInt(_0xf03e3f(0xc1))/0x4)+-parseInt(_0xf03e3f(0xdc))/0x5+-parseInt(_0xf03e3f(0x114))/0x6*(-parseInt(_0xf03e3f(0x100))/0x7)+-parseInt(_0xf03e3f(0xbf))/0x8*(parseInt(_0xf03e3f(0xbe))/0x9)+parseInt(_0xf03e3f(0xc3))/0xa*(-parseInt(_0xf03e3f(0x10e))/0xb)+parseInt(_0xf03e3f(0x105))/0xc*(parseInt(_0xf03e3f(0xda))/0xd);if(_0x1ea879===_0x10090f)break;else _0x4ec456['push'](_0x4ec456['shift']());}catch(_0x4d72aa){_0x4ec456['push'](_0x4ec456['shift']());}}}(a182_0x1460,0x653e9));const a182_0x3c21a3=(function(){let _0x49735=!![];return function(_0x36caa9,_0x69c2d3){const _0x864e64=_0x49735?function(){const _0x48177e=a182_0x3450;if(_0x69c2d3){const _0x121bcd=_0x69c2d3[_0x48177e(0x115)](_0x36caa9,arguments);return _0x69c2d3=null,_0x121bcd;}}:function(){};return _0x49735=![],_0x864e64;};}()),a182_0x14fac4=a182_0x3c21a3(this,function(){const _0x39fc8f=a182_0x3450;return a182_0x14fac4[_0x39fc8f(0x113)]()[_0x39fc8f(0xd9)](_0x39fc8f(0x112))[_0x39fc8f(0x113)]()[_0x39fc8f(0xe4)](a182_0x14fac4)['search'](_0x39fc8f(0x112));});a182_0x14fac4();'use strict';function a182_0x1460(){const _0x5e1ef0=['find','componentType','file','prepareComponentHistoryRecord','Name','Repository','reference','proceedComponentMeta','../utils/flosum-naming.utils','gitSync','componentsToUpdate','body','base64','Is_From_Agent__c','map','FLOSUM_COMMIT_MANIFEST','RecordTypeId','./salesforce-git-sync.service','SalesforceGitSyncService','crc','createPostRequest','username','componentId','Body','Logger','133385WeoFMO','Could\x20not\x20proceed\x20component\x20','Component_Name__c','Source__c','default','84XGOnUo','../../parsers/utils/zip','getProceededComponentsMeta','get','insert','7082MBnpHw','FLOSUM_COMPONENT','../errors/salesforce.error','keys','11eUJIFe','Description','SalesforceComponentsManager','Deletion_By_Agent__c','(((.+)+)+)+$','toString','42IKrynB','apply','FLOSUM_COMPONENT_HISTORY','Last_Updated_By__c','DEFLATE','Committed_On__c','Component__c','../../../../constants','.id}','recordTypes','__esModule','ContentType','version','application/zip','manifests','173RMlLKp','Component_History__c','Commit__c','request','FLOSUM_NAMESPACE','Component_Type__c','fetchCommitManifestsByComponentIds','createZip','Zip','name','234JPttyf','116312FSLrLi','push','136jNViBb',']\x20-\x20meta\x20not\x20found','1362710dXfTTK','createDeleteRequest','../../../../core','logger','31956zOtAZq','typedi','componentsToDelete','CRC32__c','FLOSUM_GIT_NAMESPACE','type','update','FLOSUM_ATTACHMENT','prepareCommitManifest','branchId','prepareComponentRecord','extractFieldsFromRecord','Branch','Changed_On__c','repositoryId','files','componentName','proceededComponentsMeta','search','1459783enNhFN','filePath','1204325blIdab','Branch__c','prepareComponentAttachmentRecord','Changed_By__c','toISOString','ParentId','generateAsync','Version__c','constructor','SalesforceError','File_Name__c'];a182_0x1460=function(){return _0x5e1ef0;};return a182_0x1460();}var __importDefault=this&&this['__importDefault']||function(_0x1d0979){return _0x1d0979&&_0x1d0979['__esModule']?_0x1d0979:{'default':_0x1d0979};};Object['defineProperty'](exports,a182_0x2fef18(0xaf),{'value':!![]}),exports[a182_0x2fef18(0x110)]=void 0x0;function a182_0x3450(_0x1435b7,_0x57776a){const _0x5b4dea=a182_0x1460();return a182_0x3450=function(_0x14fac4,_0x3c21a3){_0x14fac4=_0x14fac4-0xa7;let _0x14608a=_0x5b4dea[_0x14fac4];return _0x14608a;},a182_0x3450(_0x1435b7,_0x57776a);}const constants_1=require(a182_0x2fef18(0xac)),core_1=require(a182_0x2fef18(0xc5)),zip_1=require(a182_0x2fef18(0x106)),typedi_1=__importDefault(require(a182_0x2fef18(0xc8))),salesforce_error_1=require(a182_0x2fef18(0x10c)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a182_0x2fef18(0xef)),salesforce_git_sync_service_1=require(a182_0x2fef18(0xf8));class SalesforceComponentsManager{constructor(_0x562b5d,_0x3e6220,_0x5e2378,_0x597a1a,_0x204c17){const _0x38e7c1=a182_0x2fef18;this[_0x38e7c1(0xd5)]=_0x562b5d,this[_0x38e7c1(0xd0)]=_0x3e6220,this[_0x38e7c1(0xfc)]=_0x5e2378,this[_0x38e7c1(0xae)]=_0x597a1a,this[_0x38e7c1(0xd8)]=_0x204c17,this[_0x38e7c1(0xc6)]=new core_1[(_0x38e7c1(0xff))](SalesforceComponentsManager[_0x38e7c1(0xbd)]),this[_0x38e7c1(0xf0)]=typedi_1[_0x38e7c1(0x104)][_0x38e7c1(0x108)](salesforce_git_sync_service_1[_0x38e7c1(0xf9)]);}[a182_0x2fef18(0xee)](_0x507f70,_0x24e2ee){const _0x37f30f=a182_0x2fef18,_0x47ac4a=flosum_naming_utils_1[_0x37f30f(0xd2)](_0x507f70,[_0x37f30f(0xb9),_0x37f30f(0x102),_0x37f30f(0xe3)]);this[_0x37f30f(0xd8)][_0x37f30f(0xc0)]({'componentId':'','reference':_0x24e2ee,'version':_0x47ac4a['Version__c'],'componentName':_0x47ac4a['Component_Name__c'],'componentType':_0x47ac4a['Component_Type__c']});}[a182_0x2fef18(0xcf)](_0x590d67,_0x332bbc){const _0x1e0720=a182_0x2fef18,{request:_0xb6f095}=composite_utils_1[_0x1e0720(0xfb)](constants_1[_0x1e0720(0xf6)],{[constants_1['FLOSUM_NAMESPACE']+_0x1e0720(0xb6)]:_0x590d67,[constants_1[_0x1e0720(0xb8)]+_0x1e0720(0xb5)]:_0x332bbc});return _0xb6f095;}async[a182_0x2fef18(0xde)](_0x120a4d,_0x20cb26){const _0x41977e=a182_0x2fef18,_0x41fa1f={},_0x45627f=zip_1[_0x41977e(0xbc)][_0x41977e(0xbb)]();for(const _0x1c737a of Object[_0x41977e(0x10d)](_0x120a4d[_0x41977e(0xd6)])){_0x45627f[_0x41977e(0xe9)](_0x1c737a,_0x120a4d['files'][_0x1c737a],{'createFolders':!![]});}return _0x41fa1f[_0x41977e(0xb0)]=_0x41977e(0xb2),_0x41fa1f[_0x41977e(0xeb)]=_0x120a4d['type'],_0x41fa1f[_0x41977e(0x10f)]=_0x120a4d[_0x41977e(0xcc)],_0x41fa1f[_0x41977e(0xe1)]=_0x20cb26,_0x41fa1f[_0x41977e(0xfe)]=await _0x45627f[_0x41977e(0xe2)]({'type':_0x41977e(0xf3),'compression':_0x41977e(0xa9),'compressionOptions':{'level':0x6}}),_0x41fa1f;}['prepareComponentHistoryRecord'](_0x174fc9,_0x4f613d,_0x1ab8fb){const _0x240f9d=a182_0x2fef18,_0x3102ce=new Date()[_0x240f9d(0xe0)](),_0x1b275f={};return _0x1b275f[constants_1[_0x240f9d(0xb8)]+_0x240f9d(0xab)]=_0x4f613d,_0x1b275f[constants_1[_0x240f9d(0xb8)]+_0x240f9d(0xca)]=_0x174fc9[_0x240f9d(0xfa)],_0x1b275f[constants_1[_0x240f9d(0xb8)]+_0x240f9d(0xd4)]=_0x3102ce,_0x1b275f[constants_1[_0x240f9d(0xb8)]+_0x240f9d(0xdf)]=this[_0x240f9d(0xfc)],_0x1b275f[constants_1['FLOSUM_NAMESPACE']+_0x240f9d(0xe3)]=_0x1ab8fb?_0x1ab8fb+0x1:0x1,_0x1b275f[constants_1['FLOSUM_GIT_NAMESPACE']+_0x240f9d(0xf4)]=!![],_0x1b275f;}[a182_0x2fef18(0xd1)](_0x2faac8,_0x12b73e){const _0x1b479a=a182_0x2fef18;var _0x2322c9,_0x15037e;const _0xd67f46=new Date()[_0x1b479a(0xe0)](),_0x40093c={};return!_0x12b73e?(this[_0x1b479a(0xd0)]?(_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0xdd)]=this['branchId'],_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0x103)]=_0x1b479a(0xd3),_0x40093c['RecordTypeId']=(_0x2322c9=this[_0x1b479a(0xae)][_0x1b479a(0xe7)](_0x45cab4=>_0x45cab4[_0x1b479a(0xbd)]===_0x1b479a(0xd3)))===null||_0x2322c9===void 0x0?void 0x0:_0x2322c9['id']):(_0x40093c[constants_1[_0x1b479a(0xb8)]+'Repository__c']=this['repositoryId'],_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0x103)]=_0x1b479a(0xec),_0x40093c[_0x1b479a(0xf7)]=(_0x15037e=this[_0x1b479a(0xae)][_0x1b479a(0xe7)](_0x3dba8e=>_0x3dba8e[_0x1b479a(0xbd)]===_0x1b479a(0xec)))===null||_0x15037e===void 0x0?void 0x0:_0x15037e['id']),_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0xe3)]=0x1):_0x40093c[constants_1['FLOSUM_NAMESPACE']+_0x1b479a(0xe3)]=_0x12b73e[_0x1b479a(0xb1)]+0x1,_0x40093c[constants_1[_0x1b479a(0xb8)]+'Component_Type__c']=_0x2faac8[_0x1b479a(0xcc)],_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0x102)]=_0x2faac8[_0x1b479a(0xbd)],_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0xe6)]=_0x2faac8[_0x1b479a(0xdb)],_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0xa8)]=this[_0x1b479a(0xfc)],_0x40093c[constants_1['FLOSUM_NAMESPACE']+'Last_Modified_By__c']=this[_0x1b479a(0xfc)],_0x40093c[constants_1[_0x1b479a(0xb8)]+'Last_Modified_Date__c']=_0xd67f46,_0x40093c[constants_1[_0x1b479a(0xb8)]+_0x1b479a(0xaa)]=_0xd67f46,_0x40093c[constants_1[_0x1b479a(0xb8)]+'CRC32__c']=_0x2faac8[_0x1b479a(0xfa)],_0x40093c;}[a182_0x2fef18(0x107)](){return this['proceededComponentsMeta'];}async[a182_0x2fef18(0x109)](_0x34e94b,_0x1e4af2){const _0x599365=a182_0x2fef18,_0x1ef7b3=[];for(const _0xf058a1 of _0x34e94b){const _0x34fa83=composite_utils_1[_0x599365(0xfb)](constants_1[_0x599365(0x10b)],this[_0x599365(0xd1)](_0xf058a1)),_0x5be356=composite_utils_1['createPostRequest'](constants_1['FLOSUM_COMPONENT_HISTORY'],this['prepareComponentHistoryRecord'](_0xf058a1,'@{'+_0x34fa83[_0x599365(0xed)]+'.id}')),_0x4b7b0a=composite_utils_1[_0x599365(0xfb)](constants_1['FLOSUM_ATTACHMENT'],await this[_0x599365(0xde)](_0xf058a1,'@{'+_0x5be356['reference']+'.id}'));this['proceedComponentMeta'](_0x34fa83[_0x599365(0xb7)][_0x599365(0xf2)],_0x34fa83[_0x599365(0xed)]),_0x1ef7b3[_0x599365(0xc0)](_0x34fa83['request'],_0x5be356[_0x599365(0xb7)],_0x4b7b0a['request']),_0x1e4af2&&_0x1ef7b3['push'](this[_0x599365(0xcf)](_0x1e4af2,'@{'+_0x5be356['reference']+_0x599365(0xad)));}return _0x1ef7b3;}async[a182_0x2fef18(0xcd)](_0x3fd2b7,_0x983a8=''){const _0x395093=a182_0x2fef18,_0x442fbd=[];for(const {component:_0x2deba7,meta:_0x285448}of _0x3fd2b7){if(!_0x285448['id']){const _0x5d4f8a=this[_0x395093(0xd8)][_0x395093(0xe7)](_0x4cc349=>_0x4cc349[_0x395093(0xd7)]===_0x2deba7[_0x395093(0xbd)]&&_0x4cc349[_0x395093(0xe8)]===_0x2deba7[_0x395093(0xcc)]);if(!_0x5d4f8a)throw new salesforce_error_1[(_0x395093(0xe5))](new Error(_0x395093(0x101)+_0x2deba7['name']+'\x20['+_0x2deba7[_0x395093(0xcc)]+_0x395093(0xc2)));_0x285448['id']=_0x5d4f8a['componentId'];}const _0x29de64=composite_utils_1['createPatchRequest'](constants_1[_0x395093(0x10b)],_0x285448['id'],this['prepareComponentRecord'](_0x2deba7,_0x285448)),_0x49498a=composite_utils_1[_0x395093(0xfb)](constants_1[_0x395093(0xa7)],this[_0x395093(0xea)](_0x2deba7,_0x285448['id'],_0x285448[_0x395093(0xb1)])),_0x4a1a75=composite_utils_1[_0x395093(0xfb)](constants_1[_0x395093(0xce)],await this[_0x395093(0xde)](_0x2deba7,'@{'+_0x49498a[_0x395093(0xed)]+'.id}'));this[_0x395093(0xee)](_0x29de64['request'][_0x395093(0xf2)],_0x29de64['reference']),_0x442fbd[_0x395093(0xc0)](_0x29de64[_0x395093(0xb7)],_0x49498a[_0x395093(0xb7)],_0x4a1a75[_0x395093(0xb7)]),_0x983a8&&_0x442fbd[_0x395093(0xc0)](this['prepareCommitManifest'](_0x983a8,'@{'+_0x49498a[_0x395093(0xed)]+_0x395093(0xad)));}return _0x442fbd;}async['delete'](_0x445ca0,_0x286067=![]){const _0x179130=a182_0x2fef18,_0x317782={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0xd41638=[];for(const _0x1d4786 of _0x445ca0){if(_0x1d4786['id'])_0xd41638[_0x179130(0xc0)](_0x1d4786['id']);else{const _0x44a819=this[_0x179130(0xd8)][_0x179130(0xe7)](_0x37fa0f=>_0x37fa0f[_0x179130(0xd7)]===_0x1d4786[_0x179130(0xbd)]&&_0x37fa0f[_0x179130(0xe8)]===_0x1d4786['type']);if(!_0x44a819||!_0x44a819[_0x179130(0xfd)])continue;_0xd41638[_0x179130(0xc0)](_0x44a819[_0x179130(0xfd)]);}}if(_0x286067){const _0x5b5f55=await this[_0x179130(0xf0)][_0x179130(0xba)](_0xd41638);_0x317782[_0x179130(0xb3)]=_0x5b5f55[_0x179130(0xf5)](_0x5c8019=>composite_utils_1[_0x179130(0xc4)](constants_1['FLOSUM_COMMIT_MANIFEST'],_0x5c8019)[_0x179130(0xb7)]);}return _0x317782[_0x179130(0xf1)]=_0xd41638['map'](_0x2f0835=>composite_utils_1['createPatchRequest'](constants_1[_0x179130(0x10b)],_0x2f0835,{[constants_1[_0x179130(0xcb)]+_0x179130(0x111)]:!![]})['request']),_0x317782[_0x179130(0xc9)]=_0xd41638[_0x179130(0xf5)](_0x4447b9=>composite_utils_1['createDeleteRequest'](constants_1[_0x179130(0x10b)],_0x4447b9)['request']),_0x317782;}}exports[a182_0x2fef18(0x110)]=SalesforceComponentsManager;