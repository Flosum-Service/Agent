function a234_0x2808(_0x24960d,_0x200a81){const _0x483f4a=a234_0x93ad();return a234_0x2808=function(_0x355719,_0x4a940c){_0x355719=_0x355719-0x7e;let _0x93add3=_0x483f4a[_0x355719];return _0x93add3;},a234_0x2808(_0x24960d,_0x200a81);}const a234_0x23cea4=a234_0x2808;(function(_0x5a5976,_0x1c875a){const _0x5f454d=a234_0x2808,_0x12b69c=_0x5a5976();while(!![]){try{const _0x4665bd=-parseInt(_0x5f454d(0xc1))/0x1*(parseInt(_0x5f454d(0x84))/0x2)+parseInt(_0x5f454d(0x9d))/0x3+-parseInt(_0x5f454d(0xe8))/0x4*(parseInt(_0x5f454d(0xae))/0x5)+parseInt(_0x5f454d(0xc2))/0x6*(parseInt(_0x5f454d(0xa4))/0x7)+-parseInt(_0x5f454d(0x86))/0x8*(parseInt(_0x5f454d(0x9f))/0x9)+-parseInt(_0x5f454d(0xdf))/0xa*(-parseInt(_0x5f454d(0x8b))/0xb)+-parseInt(_0x5f454d(0xc5))/0xc*(-parseInt(_0x5f454d(0xc8))/0xd);if(_0x4665bd===_0x1c875a)break;else _0x12b69c['push'](_0x12b69c['shift']());}catch(_0x525181){_0x12b69c['push'](_0x12b69c['shift']());}}}(a234_0x93ad,0xa6931));const a234_0x4a940c=(function(){let _0x32f97d=!![];return function(_0x2e9de6,_0xd88219){const _0x4e48d8=_0x32f97d?function(){const _0x838aea=a234_0x2808;if(_0xd88219){const _0x2774dc=_0xd88219[_0x838aea(0xd9)](_0x2e9de6,arguments);return _0xd88219=null,_0x2774dc;}}:function(){};return _0x32f97d=![],_0x4e48d8;};}()),a234_0x355719=a234_0x4a940c(this,function(){const _0x332476=a234_0x2808;return a234_0x355719[_0x332476(0x85)]()['search'](_0x332476(0x82))[_0x332476(0x85)]()[_0x332476(0x95)](a234_0x355719)['search'](_0x332476(0x82));});a234_0x355719();'use strict';var __importDefault=this&&this[a234_0x23cea4(0x92)]||function(_0xd3090a){const _0x12b91f=a234_0x23cea4;return _0xd3090a&&_0xd3090a[_0x12b91f(0xe7)]?_0xd3090a:{'default':_0xd3090a};};Object[a234_0x23cea4(0xe5)](exports,'__esModule',{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a234_0x23cea4(0xad)),zip_1=require(a234_0x23cea4(0xbd)),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a234_0x23cea4(0xcb)),flosum_naming_utils_1=require(a234_0x23cea4(0xe3)),salesforce_git_sync_service_1=require(a234_0x23cea4(0xd3));function a234_0x93ad(){const _0x4a829f=['branchId','Version__c','vlocityComponentName','default','createPostRequest','componentType','FLOSUM_COMPONENT_HISTORY','Deletion_By_Agent__c','FLOSUM_GIT_NAMESPACE','../../parsers/utils/zip','recordTypes','Repository__c','ParentId','37393DEGkmX','26490pfnmJf','find','version','27844968VHQKTL','FLOSUM_COMMIT_MANIFEST','componentId','13InGvZe','Vlocity_Component_Name__c','Component_Type__c','../utils/composite.utils','base64','proceedComponentMeta','Could\x20not\x20proceed\x20component\x20','createZip','proceededComponentsMeta','Is_From_Agent__c','body','./salesforce-git-sync.service','prepareCommitManifest','Repository','Branch__c','Source__c','createPatchRequest','apply','FLOSUM_NAMESPACE','RecordTypeId','componentsToUpdate','Logger','Changed_By__c','400ytkUmt','extractFieldsFromRecord','delete','Last_Modified_By__c','../utils/flosum-naming.utils','fetchCommitManifestsByComponentIds','defineProperty','SalesforceComponentsManager','__esModule','164uADoXY','crc','SalesforceError','Body','Last_Updated_By__c','DEFLATE','toISOString','(((.+)+)+)+$','Component_Name__c','66REINKl','toString','8MMHjck','Component__c','keys','update','Committed_On__c','106920WVfKxa','componentName','push','Description','getProceededComponentsMeta','createDeleteRequest','FLOSUM_COMPONENT','__importDefault','isVlocityComponent','repositoryId','constructor','request','username','reference','Name','generateAsync','name','manifests','2708079fyjUpp','files','4817682ysfROQ','type','gitSync','componentsToDelete',']\x20-\x20meta\x20not\x20found','182YJSkqG','Commit__c','FLOSUM_ATTACHMENT','Component_History__c','ContentType','.id}','prepareComponentHistoryRecord','CRC32__c','prepareComponentRecord','../../../../core','155505cxwOyW','Last_Modified_Date__c','Changed_On__c','map','insert','filePath'];a234_0x93ad=function(){return _0x4a829f;};return a234_0x93ad();}class SalesforceComponentsManager{constructor(_0x39c01c,_0x582887,_0xded40f,_0x1c636a,_0x2acea1){const _0x400f0e=a234_0x23cea4;this[_0x400f0e(0x94)]=_0x39c01c,this['branchId']=_0x582887,this[_0x400f0e(0x97)]=_0xded40f,this[_0x400f0e(0xbe)]=_0x1c636a,this['proceededComponentsMeta']=_0x2acea1,this['logger']=new core_1[(_0x400f0e(0xdd))](SalesforceComponentsManager[_0x400f0e(0x9b)]),this['gitSync']=typedi_1[_0x400f0e(0xb7)]['get'](salesforce_git_sync_service_1['SalesforceGitSyncService']);}[a234_0x23cea4(0xcd)](_0x253e6a,_0x5b5e27){const _0x51dd52=a234_0x23cea4,_0xed08e6=(0x0,flosum_naming_utils_1[_0x51dd52(0xe0)])(_0x253e6a,[_0x51dd52(0xca),_0x51dd52(0x83),'Version__c']);this[_0x51dd52(0xd0)][_0x51dd52(0x8d)]({'componentId':'','reference':_0x5b5e27,'version':_0xed08e6[_0x51dd52(0xb5)],'componentName':_0xed08e6[_0x51dd52(0x83)],'componentType':_0xed08e6['Component_Type__c']});}[a234_0x23cea4(0xd4)](_0x32e016,_0x4b1bb3){const _0x47e736=a234_0x23cea4,{request:_0xd7b001}=(0x0,composite_utils_1[_0x47e736(0xb8)])(constants_1[_0x47e736(0xc6)],{[constants_1[_0x47e736(0xda)]+_0x47e736(0xa5)]:_0x32e016,[constants_1[_0x47e736(0xda)]+_0x47e736(0xa7)]:_0x4b1bb3});return _0xd7b001;}async['prepareComponentAttachmentRecord'](_0x7771ea,_0x2a3a6e){const _0x3df4e6=a234_0x23cea4,_0x57b731={},_0x82998e=zip_1['Zip'][_0x3df4e6(0xcf)]();for(const _0x5934c4 of Object[_0x3df4e6(0x88)](_0x7771ea[_0x3df4e6(0x9e)])){_0x82998e['file'](_0x5934c4,_0x7771ea['files'][_0x5934c4],{'createFolders':!![]});}return _0x57b731[_0x3df4e6(0xa8)]='application/zip',_0x57b731[_0x3df4e6(0x99)]=_0x7771ea[_0x3df4e6(0xa0)],_0x57b731[_0x3df4e6(0x8e)]=_0x7771ea[_0x3df4e6(0xa0)],_0x57b731[_0x3df4e6(0xc0)]=_0x2a3a6e,_0x57b731[_0x3df4e6(0x7e)]=await _0x82998e[_0x3df4e6(0x9a)]({'type':_0x3df4e6(0xcc),'compression':_0x3df4e6(0x80),'compressionOptions':{'level':0x6}}),_0x57b731;}[a234_0x23cea4(0xaa)](_0x331af8,_0x5128d9,_0x16a317){const _0x2872c2=a234_0x23cea4,_0x18d5f4=new Date()[_0x2872c2(0x81)](),_0x1c84e1={};return _0x1c84e1[constants_1[_0x2872c2(0xda)]+_0x2872c2(0x87)]=_0x5128d9,_0x1c84e1[constants_1[_0x2872c2(0xda)]+_0x2872c2(0xab)]=_0x331af8[_0x2872c2(0xe9)],_0x1c84e1[constants_1['FLOSUM_NAMESPACE']+_0x2872c2(0xb0)]=_0x18d5f4,_0x1c84e1[constants_1[_0x2872c2(0xda)]+_0x2872c2(0xde)]=this[_0x2872c2(0x97)],_0x1c84e1[constants_1[_0x2872c2(0xda)]+_0x2872c2(0xb5)]=_0x16a317?_0x16a317+0x1:0x1,_0x1c84e1[constants_1['FLOSUM_GIT_NAMESPACE']+_0x2872c2(0xd1)]=!![],_0x1c84e1;}[a234_0x23cea4(0xac)](_0x27fa4f,_0x159592){const _0x1e0744=a234_0x23cea4;var _0x4a34c0,_0x383b45;const _0x34117b=new Date()[_0x1e0744(0x81)](),_0x2ae658={};return!_0x159592?(this[_0x1e0744(0xb4)]?(_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xd6)]=this['branchId'],_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xd7)]='Branch',_0x2ae658['RecordTypeId']=(_0x4a34c0=this[_0x1e0744(0xbe)][_0x1e0744(0xc3)](_0xd5c23c=>_0xd5c23c[_0x1e0744(0x9b)]==='Branch'))===null||_0x4a34c0===void 0x0?void 0x0:_0x4a34c0['id']):(_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xbf)]=this[_0x1e0744(0x94)],_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xd7)]=_0x1e0744(0xd5),_0x2ae658[_0x1e0744(0xdb)]=(_0x383b45=this['recordTypes'][_0x1e0744(0xc3)](_0x3911fe=>_0x3911fe[_0x1e0744(0x9b)]===_0x1e0744(0xd5)))===null||_0x383b45===void 0x0?void 0x0:_0x383b45['id']),_0x2ae658[constants_1['FLOSUM_NAMESPACE']+_0x1e0744(0xb5)]=0x1):_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xb5)]=_0x159592[_0x1e0744(0xc4)]+0x1,_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xca)]=_0x27fa4f[_0x1e0744(0xa0)],_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0x83)]=_0x27fa4f['name'],_0x2ae658[constants_1['FLOSUM_NAMESPACE']+'File_Name__c']=_0x27fa4f[_0x1e0744(0xb3)],_0x2ae658[constants_1['FLOSUM_NAMESPACE']+_0x1e0744(0x7f)]=this[_0x1e0744(0x97)],_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xe2)]=this[_0x1e0744(0x97)],_0x2ae658[constants_1['FLOSUM_NAMESPACE']+_0x1e0744(0xaf)]=_0x34117b,_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0x8a)]=_0x34117b,_0x2ae658[constants_1['FLOSUM_NAMESPACE']+_0x1e0744(0xab)]=_0x27fa4f['crc'],_0x2ae658[constants_1[_0x1e0744(0xda)]+_0x1e0744(0xc9)]=_0x27fa4f[_0x1e0744(0xb6)],_0x2ae658[constants_1['FLOSUM_NAMESPACE']+'Vlocity_Component__c']=_0x27fa4f[_0x1e0744(0x93)],_0x2ae658;}[a234_0x23cea4(0x8f)](){return this['proceededComponentsMeta'];}async[a234_0x23cea4(0xb2)](_0x4c43a3,_0x1d7638){const _0xd6c39b=a234_0x23cea4,_0x12da89=[];for(const _0x24faf1 of _0x4c43a3){const _0xc8ee47=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_COMPONENT'],this[_0xd6c39b(0xac)](_0x24faf1)),_0xa7df9f=(0x0,composite_utils_1[_0xd6c39b(0xb8)])(constants_1[_0xd6c39b(0xba)],this[_0xd6c39b(0xaa)](_0x24faf1,'@{'+_0xc8ee47[_0xd6c39b(0x98)]+'.id}')),_0x1cf0af=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0xd6c39b(0xa6)],await this['prepareComponentAttachmentRecord'](_0x24faf1,'@{'+_0xa7df9f['reference']+_0xd6c39b(0xa9)));this[_0xd6c39b(0xcd)](_0xc8ee47[_0xd6c39b(0x96)]['body'],_0xc8ee47[_0xd6c39b(0x98)]),_0x12da89[_0xd6c39b(0x8d)](_0xc8ee47['request'],_0xa7df9f[_0xd6c39b(0x96)],_0x1cf0af[_0xd6c39b(0x96)]),_0x1d7638&&_0x12da89[_0xd6c39b(0x8d)](this[_0xd6c39b(0xd4)](_0x1d7638,'@{'+_0xa7df9f[_0xd6c39b(0x98)]+'.id}'));}return _0x12da89;}async[a234_0x23cea4(0x89)](_0x27923f,_0x326c28=''){const _0x33184d=a234_0x23cea4,_0x2a2508=[];for(const {component:_0x5dd484,meta:_0x2e0f5e}of _0x27923f){if(!_0x2e0f5e['id']){const _0xe6e556=this[_0x33184d(0xd0)]['find'](_0x236212=>_0x236212['componentName']===_0x5dd484[_0x33184d(0x9b)]&&_0x236212[_0x33184d(0xb9)]===_0x5dd484[_0x33184d(0xa0)]);if(!_0xe6e556)throw new salesforce_error_1[(_0x33184d(0xea))](new Error(_0x33184d(0xce)+_0x5dd484[_0x33184d(0x9b)]+'\x20['+_0x5dd484[_0x33184d(0xa0)]+_0x33184d(0xa3)));_0x2e0f5e['id']=_0xe6e556['componentId'];}const _0x43498f=(0x0,composite_utils_1[_0x33184d(0xd8)])(constants_1[_0x33184d(0x91)],_0x2e0f5e['id'],this[_0x33184d(0xac)](_0x5dd484,_0x2e0f5e)),_0x35e547=(0x0,composite_utils_1[_0x33184d(0xb8)])(constants_1[_0x33184d(0xba)],this[_0x33184d(0xaa)](_0x5dd484,_0x2e0f5e['id'],_0x2e0f5e[_0x33184d(0xc4)])),_0x372cb3=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_ATTACHMENT'],await this['prepareComponentAttachmentRecord'](_0x5dd484,'@{'+_0x35e547['reference']+'.id}'));this[_0x33184d(0xcd)](_0x43498f[_0x33184d(0x96)][_0x33184d(0xd2)],_0x43498f[_0x33184d(0x98)]),_0x2a2508[_0x33184d(0x8d)](_0x43498f[_0x33184d(0x96)],_0x35e547[_0x33184d(0x96)],_0x372cb3[_0x33184d(0x96)]),_0x326c28&&_0x2a2508[_0x33184d(0x8d)](this[_0x33184d(0xd4)](_0x326c28,'@{'+_0x35e547[_0x33184d(0x98)]+'.id}'));}return _0x2a2508;}async[a234_0x23cea4(0xe1)](_0x2238a0,_0x1d68e8=![]){const _0x2a96a9=a234_0x23cea4,_0x27f986={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x5b9099=[];for(const _0x180cbb of _0x2238a0){if(_0x180cbb['id'])_0x5b9099[_0x2a96a9(0x8d)](_0x180cbb['id']);else{const _0x53666c=this[_0x2a96a9(0xd0)][_0x2a96a9(0xc3)](_0x30a2ee=>_0x30a2ee[_0x2a96a9(0x8c)]===_0x180cbb[_0x2a96a9(0x9b)]&&_0x30a2ee[_0x2a96a9(0xb9)]===_0x180cbb[_0x2a96a9(0xa0)]);if(!_0x53666c||!_0x53666c[_0x2a96a9(0xc7)])continue;_0x5b9099[_0x2a96a9(0x8d)](_0x53666c[_0x2a96a9(0xc7)]);}}if(_0x1d68e8){const _0x5ac5c5=await this[_0x2a96a9(0xa1)][_0x2a96a9(0xe4)](_0x5b9099);_0x27f986[_0x2a96a9(0x9c)]=_0x5ac5c5['map'](_0xfe1850=>(0x0,composite_utils_1[_0x2a96a9(0x90)])(constants_1[_0x2a96a9(0xc6)],_0xfe1850)['request']);}return _0x27f986[_0x2a96a9(0xdc)]=_0x5b9099[_0x2a96a9(0xb1)](_0x44d075=>(0x0,composite_utils_1['createPatchRequest'])(constants_1[_0x2a96a9(0x91)],_0x44d075,{[constants_1[_0x2a96a9(0xbc)]+_0x2a96a9(0xbb)]:!![]})['request']),_0x27f986[_0x2a96a9(0xa2)]=_0x5b9099[_0x2a96a9(0xb1)](_0x425a16=>(0x0,composite_utils_1[_0x2a96a9(0x90)])(constants_1[_0x2a96a9(0x91)],_0x425a16)[_0x2a96a9(0x96)]),_0x27f986;}}exports[a234_0x23cea4(0xe6)]=SalesforceComponentsManager;