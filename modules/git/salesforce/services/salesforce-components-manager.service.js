const a195_0x12d4d7=a195_0x2b20;(function(_0x5b7aa6,_0x15802b){const _0x18b731=a195_0x2b20,_0x54b733=_0x5b7aa6();while(!![]){try{const _0x541eb3=parseInt(_0x18b731(0x1cc))/0x1*(parseInt(_0x18b731(0x17d))/0x2)+-parseInt(_0x18b731(0x1ba))/0x3+-parseInt(_0x18b731(0x195))/0x4+-parseInt(_0x18b731(0x1db))/0x5*(-parseInt(_0x18b731(0x1c9))/0x6)+-parseInt(_0x18b731(0x1a7))/0x7+parseInt(_0x18b731(0x1c1))/0x8*(parseInt(_0x18b731(0x1cd))/0x9)+parseInt(_0x18b731(0x18b))/0xa;if(_0x541eb3===_0x15802b)break;else _0x54b733['push'](_0x54b733['shift']());}catch(_0x30a80f){_0x54b733['push'](_0x54b733['shift']());}}}(a195_0x28b9,0xefeca));function a195_0x28b9(){const _0xc2de01=['prepareComponentHistoryRecord','FLOSUM_ATTACHMENT','Committed_On__c','keys','push','Changed_By__c','file','RecordTypeId','Component__c','recordTypes','FLOSUM_NAMESPACE','Repository','createZip','Last_Modified_Date__c','createPostRequest','__esModule','13573063ogqpoq','../utils/composite.utils','Version__c','application/zip','(((.+)+)+)+$','__importDefault','Repository__c','get','proceedComponentMeta','Component_Name__c','request','componentType','DEFLATE','SalesforceComponentsManager','toISOString','default','Component_Type__c','delete','insert','331617DCRLsY','repositoryId','gitSync','Branch','proceededComponentsMeta','../errors/salesforce.error','FLOSUM_COMPONENT','10787584nHeVcW','body','Commit__c','version','SalesforceGitSyncService','Body','FLOSUM_GIT_NAMESPACE','componentsToUpdate','1250844rKUwVS','prepareComponentAttachmentRecord','type','194jgGbNe','9ojmKRj','.id}','../utils/flosum-naming.utils','update','fetchCommitManifestsByComponentIds','Component_History__c','branchId','reference','manifests','toString','map','prepareComponentRecord','Branch__c','extractFieldsFromRecord','5hsdOTc','Name','createDeleteRequest','componentId','Description','logger','36ZKuvsK','prepareCommitManifest','CRC32__c','constructor','crc','ContentType','find','Deletion_By_Agent__c','Logger','ParentId','files','Zip','../../../../core','username','24274410kikKYC','getProceededComponentsMeta',']\x20-\x20meta\x20not\x20found','Could\x20not\x20proceed\x20component\x20','createPatchRequest','filePath','FLOSUM_COMMIT_MANIFEST','search','name','Is_From_Agent__c','3822308RuXINk','FLOSUM_COMPONENT_HISTORY'];a195_0x28b9=function(){return _0xc2de01;};return a195_0x28b9();}const a195_0x466f6a=(function(){let _0x10b857=!![];return function(_0x4f2800,_0x2c35ec){const _0x40e985=_0x10b857?function(){if(_0x2c35ec){const _0x4fb407=_0x2c35ec['apply'](_0x4f2800,arguments);return _0x2c35ec=null,_0x4fb407;}}:function(){};return _0x10b857=![],_0x40e985;};}()),a195_0x66b4ed=a195_0x466f6a(this,function(){const _0x36de80=a195_0x2b20;return a195_0x66b4ed[_0x36de80(0x1d6)]()['search'](_0x36de80(0x1ab))[_0x36de80(0x1d6)]()[_0x36de80(0x180)](a195_0x66b4ed)[_0x36de80(0x192)]('(((.+)+)+)+$');});a195_0x66b4ed();'use strict';var __importDefault=this&&this[a195_0x12d4d7(0x1ac)]||function(_0x3e4265){const _0x2fd847=a195_0x12d4d7;return _0x3e4265&&_0x3e4265[_0x2fd847(0x1a6)]?_0x3e4265:{'default':_0x3e4265};};Object['defineProperty'](exports,a195_0x12d4d7(0x1a6),{'value':!![]}),exports[a195_0x12d4d7(0x1b4)]=void 0x0;const constants_1=require('../../../../constants'),core_1=require(a195_0x12d4d7(0x189)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a195_0x12d4d7(0x1bf)),composite_utils_1=require(a195_0x12d4d7(0x1a8)),flosum_naming_utils_1=require(a195_0x12d4d7(0x1cf)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');function a195_0x2b20(_0x1be85d,_0x352829){const _0x4c0732=a195_0x28b9();return a195_0x2b20=function(_0x66b4ed,_0x466f6a){_0x66b4ed=_0x66b4ed-0x178;let _0x28b9e3=_0x4c0732[_0x66b4ed];return _0x28b9e3;},a195_0x2b20(_0x1be85d,_0x352829);}class SalesforceComponentsManager{constructor(_0x46c0fa,_0x5e6740,_0x2a4ffc,_0xc51dcf,_0x450572){const _0x1c9cde=a195_0x12d4d7;this['repositoryId']=_0x46c0fa,this[_0x1c9cde(0x1d3)]=_0x5e6740,this['username']=_0x2a4ffc,this[_0x1c9cde(0x1a0)]=_0xc51dcf,this[_0x1c9cde(0x1be)]=_0x450572,this[_0x1c9cde(0x17c)]=new core_1[(_0x1c9cde(0x185))](SalesforceComponentsManager[_0x1c9cde(0x193)]),this[_0x1c9cde(0x1bc)]=typedi_1[_0x1c9cde(0x1b6)][_0x1c9cde(0x1ae)](salesforce_git_sync_service_1[_0x1c9cde(0x1c5)]);}[a195_0x12d4d7(0x1af)](_0x2fef10,_0x5b963e){const _0x3936ac=a195_0x12d4d7,_0x3353f2=(0x0,flosum_naming_utils_1[_0x3936ac(0x1da)])(_0x2fef10,[_0x3936ac(0x1b7),_0x3936ac(0x1b0),_0x3936ac(0x1a9)]);this[_0x3936ac(0x1be)][_0x3936ac(0x19b)]({'componentId':'','reference':_0x5b963e,'version':_0x3353f2[_0x3936ac(0x1a9)],'componentName':_0x3353f2[_0x3936ac(0x1b0)],'componentType':_0x3353f2['Component_Type__c']});}['prepareCommitManifest'](_0x3895cb,_0x5c15e4){const _0xb62452=a195_0x12d4d7,{request:_0x5d331f}=(0x0,composite_utils_1[_0xb62452(0x1a5)])(constants_1[_0xb62452(0x191)],{[constants_1['FLOSUM_NAMESPACE']+_0xb62452(0x1c3)]:_0x3895cb,[constants_1['FLOSUM_NAMESPACE']+_0xb62452(0x1d2)]:_0x5c15e4});return _0x5d331f;}async[a195_0x12d4d7(0x1ca)](_0x475c7a,_0x3d43bf){const _0x4873ef=a195_0x12d4d7,_0x40f31={},_0x56ac8c=zip_1[_0x4873ef(0x188)][_0x4873ef(0x1a3)]();for(const _0x1f9627 of Object[_0x4873ef(0x19a)](_0x475c7a[_0x4873ef(0x187)])){_0x56ac8c[_0x4873ef(0x19d)](_0x1f9627,_0x475c7a[_0x4873ef(0x187)][_0x1f9627],{'createFolders':!![]});}return _0x40f31[_0x4873ef(0x182)]=_0x4873ef(0x1aa),_0x40f31[_0x4873ef(0x178)]=_0x475c7a[_0x4873ef(0x1cb)],_0x40f31[_0x4873ef(0x17b)]=_0x475c7a['type'],_0x40f31[_0x4873ef(0x186)]=_0x3d43bf,_0x40f31[_0x4873ef(0x1c6)]=await _0x56ac8c['generateAsync']({'type':'base64','compression':_0x4873ef(0x1b3),'compressionOptions':{'level':0x6}}),_0x40f31;}[a195_0x12d4d7(0x197)](_0x1b8029,_0x3078c5,_0xed085){const _0x306571=a195_0x12d4d7,_0x1d2ca7=new Date()['toISOString'](),_0x3ba2a0={};return _0x3ba2a0[constants_1[_0x306571(0x1a1)]+_0x306571(0x19f)]=_0x3078c5,_0x3ba2a0[constants_1[_0x306571(0x1a1)]+_0x306571(0x17f)]=_0x1b8029[_0x306571(0x181)],_0x3ba2a0[constants_1[_0x306571(0x1a1)]+'Changed_On__c']=_0x1d2ca7,_0x3ba2a0[constants_1['FLOSUM_NAMESPACE']+_0x306571(0x19c)]=this[_0x306571(0x18a)],_0x3ba2a0[constants_1[_0x306571(0x1a1)]+_0x306571(0x1a9)]=_0xed085?_0xed085+0x1:0x1,_0x3ba2a0[constants_1[_0x306571(0x1c7)]+_0x306571(0x194)]=!![],_0x3ba2a0;}[a195_0x12d4d7(0x1d8)](_0x2e9e33,_0x46ad2d){const _0x56e018=a195_0x12d4d7;var _0x30f4d5,_0x66671a;const _0x4a754f=new Date()[_0x56e018(0x1b5)](),_0x294f95={};return!_0x46ad2d?(this[_0x56e018(0x1d3)]?(_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x1d9)]=this['branchId'],_0x294f95[constants_1['FLOSUM_NAMESPACE']+'Source__c']=_0x56e018(0x1bd),_0x294f95['RecordTypeId']=(_0x30f4d5=this[_0x56e018(0x1a0)]['find'](_0x237f87=>_0x237f87[_0x56e018(0x193)]===_0x56e018(0x1bd)))===null||_0x30f4d5===void 0x0?void 0x0:_0x30f4d5['id']):(_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x1ad)]=this[_0x56e018(0x1bb)],_0x294f95[constants_1[_0x56e018(0x1a1)]+'Source__c']=_0x56e018(0x1a2),_0x294f95[_0x56e018(0x19e)]=(_0x66671a=this['recordTypes']['find'](_0x1afe7c=>_0x1afe7c['name']==='Repository'))===null||_0x66671a===void 0x0?void 0x0:_0x66671a['id']),_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x1a9)]=0x1):_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x1a9)]=_0x46ad2d['version']+0x1,_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x1b7)]=_0x2e9e33[_0x56e018(0x1cb)],_0x294f95[constants_1['FLOSUM_NAMESPACE']+_0x56e018(0x1b0)]=_0x2e9e33['name'],_0x294f95[constants_1[_0x56e018(0x1a1)]+'File_Name__c']=_0x2e9e33[_0x56e018(0x190)],_0x294f95[constants_1['FLOSUM_NAMESPACE']+'Last_Updated_By__c']=this['username'],_0x294f95[constants_1[_0x56e018(0x1a1)]+'Last_Modified_By__c']=this[_0x56e018(0x18a)],_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x1a4)]=_0x4a754f,_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x199)]=_0x4a754f,_0x294f95[constants_1[_0x56e018(0x1a1)]+_0x56e018(0x17f)]=_0x2e9e33[_0x56e018(0x181)],_0x294f95;}[a195_0x12d4d7(0x18c)](){return this['proceededComponentsMeta'];}async[a195_0x12d4d7(0x1b9)](_0x5dbbf9,_0x221a1e){const _0x5b2e6c=a195_0x12d4d7,_0x4fb66c=[];for(const _0x212584 of _0x5dbbf9){const _0x5a7917=(0x0,composite_utils_1[_0x5b2e6c(0x1a5)])(constants_1[_0x5b2e6c(0x1c0)],this['prepareComponentRecord'](_0x212584)),_0x4cb44b=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x5b2e6c(0x196)],this['prepareComponentHistoryRecord'](_0x212584,'@{'+_0x5a7917['reference']+_0x5b2e6c(0x1ce))),_0x216b35=(0x0,composite_utils_1[_0x5b2e6c(0x1a5)])(constants_1[_0x5b2e6c(0x198)],await this[_0x5b2e6c(0x1ca)](_0x212584,'@{'+_0x4cb44b[_0x5b2e6c(0x1d4)]+'.id}'));this[_0x5b2e6c(0x1af)](_0x5a7917[_0x5b2e6c(0x1b1)][_0x5b2e6c(0x1c2)],_0x5a7917[_0x5b2e6c(0x1d4)]),_0x4fb66c[_0x5b2e6c(0x19b)](_0x5a7917['request'],_0x4cb44b[_0x5b2e6c(0x1b1)],_0x216b35['request']),_0x221a1e&&_0x4fb66c[_0x5b2e6c(0x19b)](this['prepareCommitManifest'](_0x221a1e,'@{'+_0x4cb44b['reference']+_0x5b2e6c(0x1ce)));}return _0x4fb66c;}async[a195_0x12d4d7(0x1d0)](_0x2a5df7,_0x22124b=''){const _0x58bee0=a195_0x12d4d7,_0x33f13f=[];for(const {component:_0x4330f6,meta:_0xe1bb69}of _0x2a5df7){if(!_0xe1bb69['id']){const _0xc5969f=this[_0x58bee0(0x1be)][_0x58bee0(0x183)](_0x41f784=>_0x41f784['componentName']===_0x4330f6[_0x58bee0(0x193)]&&_0x41f784[_0x58bee0(0x1b2)]===_0x4330f6['type']);if(!_0xc5969f)throw new salesforce_error_1['SalesforceError'](new Error(_0x58bee0(0x18e)+_0x4330f6[_0x58bee0(0x193)]+'\x20['+_0x4330f6[_0x58bee0(0x1cb)]+_0x58bee0(0x18d)));_0xe1bb69['id']=_0xc5969f['componentId'];}const _0x15d218=(0x0,composite_utils_1[_0x58bee0(0x18f)])(constants_1[_0x58bee0(0x1c0)],_0xe1bb69['id'],this[_0x58bee0(0x1d8)](_0x4330f6,_0xe1bb69)),_0x5c26b9=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x58bee0(0x196)],this[_0x58bee0(0x197)](_0x4330f6,_0xe1bb69['id'],_0xe1bb69[_0x58bee0(0x1c4)])),_0xad703b=(0x0,composite_utils_1[_0x58bee0(0x1a5)])(constants_1[_0x58bee0(0x198)],await this[_0x58bee0(0x1ca)](_0x4330f6,'@{'+_0x5c26b9[_0x58bee0(0x1d4)]+_0x58bee0(0x1ce)));this[_0x58bee0(0x1af)](_0x15d218['request'][_0x58bee0(0x1c2)],_0x15d218[_0x58bee0(0x1d4)]),_0x33f13f[_0x58bee0(0x19b)](_0x15d218['request'],_0x5c26b9[_0x58bee0(0x1b1)],_0xad703b[_0x58bee0(0x1b1)]),_0x22124b&&_0x33f13f['push'](this[_0x58bee0(0x17e)](_0x22124b,'@{'+_0x5c26b9[_0x58bee0(0x1d4)]+'.id}'));}return _0x33f13f;}async[a195_0x12d4d7(0x1b8)](_0x44e9c5,_0x46902b=![]){const _0x3cee12=a195_0x12d4d7,_0xc0c9ef={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x2416e5=[];for(const _0x5d2a2c of _0x44e9c5){if(_0x5d2a2c['id'])_0x2416e5[_0x3cee12(0x19b)](_0x5d2a2c['id']);else{const _0x1bbb45=this[_0x3cee12(0x1be)][_0x3cee12(0x183)](_0x48bc50=>_0x48bc50['componentName']===_0x5d2a2c[_0x3cee12(0x193)]&&_0x48bc50['componentType']===_0x5d2a2c[_0x3cee12(0x1cb)]);if(!_0x1bbb45||!_0x1bbb45[_0x3cee12(0x17a)])continue;_0x2416e5['push'](_0x1bbb45[_0x3cee12(0x17a)]);}}if(_0x46902b){const _0x4200bb=await this['gitSync'][_0x3cee12(0x1d1)](_0x2416e5);_0xc0c9ef[_0x3cee12(0x1d5)]=_0x4200bb[_0x3cee12(0x1d7)](_0x4ca8b2=>(0x0,composite_utils_1[_0x3cee12(0x179)])(constants_1['FLOSUM_COMMIT_MANIFEST'],_0x4ca8b2)['request']);}return _0xc0c9ef[_0x3cee12(0x1c8)]=_0x2416e5[_0x3cee12(0x1d7)](_0x340163=>(0x0,composite_utils_1['createPatchRequest'])(constants_1[_0x3cee12(0x1c0)],_0x340163,{[constants_1[_0x3cee12(0x1c7)]+_0x3cee12(0x184)]:!![]})[_0x3cee12(0x1b1)]),_0xc0c9ef['componentsToDelete']=_0x2416e5[_0x3cee12(0x1d7)](_0x564459=>(0x0,composite_utils_1['createDeleteRequest'])(constants_1[_0x3cee12(0x1c0)],_0x564459)[_0x3cee12(0x1b1)]),_0xc0c9ef;}}exports[a195_0x12d4d7(0x1b4)]=SalesforceComponentsManager;