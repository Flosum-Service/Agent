const a244_0x4e6e91=a244_0x10ee;(function(_0x52b82c,_0x372cfd){const _0x329654=a244_0x10ee,_0x47a807=_0x52b82c();while(!![]){try{const _0x4bbd52=parseInt(_0x329654(0x144))/0x1*(-parseInt(_0x329654(0x15d))/0x2)+-parseInt(_0x329654(0x143))/0x3*(-parseInt(_0x329654(0x11f))/0x4)+parseInt(_0x329654(0x12d))/0x5*(-parseInt(_0x329654(0x131))/0x6)+-parseInt(_0x329654(0x13c))/0x7+-parseInt(_0x329654(0x12a))/0x8*(parseInt(_0x329654(0x164))/0x9)+-parseInt(_0x329654(0x128))/0xa+parseInt(_0x329654(0x123))/0xb;if(_0x4bbd52===_0x372cfd)break;else _0x47a807['push'](_0x47a807['shift']());}catch(_0x1e1db0){_0x47a807['push'](_0x47a807['shift']());}}}(a244_0x186b,0x19e43));function a244_0x10ee(_0x4aa986,_0x3b8f81){const _0x7361df=a244_0x186b();return a244_0x10ee=function(_0x1e6598,_0x44eb33){_0x1e6598=_0x1e6598-0xfb;let _0x186bbe=_0x7361df[_0x1e6598];return _0x186bbe;},a244_0x10ee(_0x4aa986,_0x3b8f81);}function a244_0x186b(){const _0x60421b=['prepareComponentAttachmentRecord','SalesforceGitSyncService','FLOSUM_ATTACHMENT','__importDefault','Repository','Zip','DEFLATE','Component_Name__c','../../../../core','componentsToUpdate','FLOSUM_COMPONENT_HISTORY','Component_History__c','gitSync','FLOSUM_NAMESPACE','update','Changed_On__c','type','2AKwKzD','constructor','../utils/flosum-naming.utils','repositoryId','defineProperty','FLOSUM_COMPONENT','Changed_By__c','806454fCflBN','FLOSUM_COMMIT_MANIFEST','Component_Type__c','prepareComponentHistoryRecord','Deletion_By_Agent__c','vlocityComponentName','branchId','FLOSUM_GIT_NAMESPACE','base64','request','get','toISOString','map','reference','../errors/salesforce.error','recordTypes','body','toString','RecordTypeId','componentId','search','Version__c','Logger','isVlocityComponent','application/zip','Is_From_Agent__c','createDeleteRequest','Last_Modified_By__c','name','(((.+)+)+)+$','componentType','file','Vlocity_Component_Name__c','componentName','proceedComponentMeta','fetchCommitManifestsByComponentIds','__esModule','Source__c','.id}','find','Could\x20not\x20proceed\x20component\x20','8dmmqOb','files','getProceededComponentsMeta','extractFieldsFromRecord','6387502cSrZhH','SalesforceError','createZip','typedi','MC_Key__c','1108330zxDWok','File_Name__c','8dHsGVJ','Component__c','SalesforceComponentsManager','115pXSkkB','manifests','filePath',']\x20-\x20meta\x20not\x20found','54546fubSoo','prepareComponentRecord','version','insert','Commit__c','componentsToDelete','createPostRequest','username','createPatchRequest','proceededComponentsMeta','Description','962962tMVxPx','crc','../../../../constants','logger','Vlocity_Component__c','push','Body','130827kSGGbV','14751OrAbDk','Last_Modified_Date__c','CRC32__c','delete','marketingCloudKey','prepareCommitManifest','./salesforce-git-sync.service','Branch__c'];a244_0x186b=function(){return _0x60421b;};return a244_0x186b();}const a244_0x44eb33=(function(){let _0x1fd667=!![];return function(_0x422d73,_0x3bfb45){const _0x3b4d44=_0x1fd667?function(){if(_0x3bfb45){const _0x441525=_0x3bfb45['apply'](_0x422d73,arguments);return _0x3bfb45=null,_0x441525;}}:function(){};return _0x1fd667=![],_0x3b4d44;};}()),a244_0x1e6598=a244_0x44eb33(this,function(){const _0x4c3ff5=a244_0x10ee;return a244_0x1e6598[_0x4c3ff5(0x107)]()[_0x4c3ff5(0x10a)](_0x4c3ff5(0x113))['toString']()[_0x4c3ff5(0x15e)](a244_0x1e6598)['search'](_0x4c3ff5(0x113));});a244_0x1e6598();'use strict';var __importDefault=this&&this[a244_0x4e6e91(0x14f)]||function(_0x561fe6){const _0x58a9c7=a244_0x4e6e91;return _0x561fe6&&_0x561fe6[_0x58a9c7(0x11a)]?_0x561fe6:{'default':_0x561fe6};};Object[a244_0x4e6e91(0x161)](exports,a244_0x4e6e91(0x11a),{'value':!![]}),exports[a244_0x4e6e91(0x12c)]=void 0x0;const constants_1=require(a244_0x4e6e91(0x13e)),core_1=require(a244_0x4e6e91(0x154)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require(a244_0x4e6e91(0x126))),salesforce_error_1=require(a244_0x4e6e91(0x104)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a244_0x4e6e91(0x15f)),salesforce_git_sync_service_1=require(a244_0x4e6e91(0x14a));class SalesforceComponentsManager{constructor(_0x52d723,_0x2f0297,_0x55d3a6,_0x2ea9b9,_0x29db90){const _0x11d136=a244_0x4e6e91;this['repositoryId']=_0x52d723,this[_0x11d136(0xfc)]=_0x2f0297,this['username']=_0x55d3a6,this['recordTypes']=_0x2ea9b9,this['proceededComponentsMeta']=_0x29db90,this[_0x11d136(0x13f)]=new core_1[(_0x11d136(0x10c))](SalesforceComponentsManager[_0x11d136(0x112)]),this[_0x11d136(0x158)]=typedi_1['default'][_0x11d136(0x100)](salesforce_git_sync_service_1[_0x11d136(0x14d)]);}[a244_0x4e6e91(0x118)](_0xc3388b,_0x1f7bb8){const _0x3f8971=a244_0x4e6e91,_0x2dee5d=(0x0,flosum_naming_utils_1[_0x3f8971(0x122)])(_0xc3388b,[_0x3f8971(0x166),_0x3f8971(0x153),_0x3f8971(0x10b)]);this[_0x3f8971(0x13a)][_0x3f8971(0x141)]({'componentId':'','reference':_0x1f7bb8,'version':_0x2dee5d[_0x3f8971(0x10b)],'componentName':_0x2dee5d[_0x3f8971(0x153)],'componentType':_0x2dee5d[_0x3f8971(0x166)]});}[a244_0x4e6e91(0x149)](_0x145fb1,_0x2e2d14){const _0xc943e=a244_0x4e6e91,{request:_0x371390}=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_COMMIT_MANIFEST'],{[constants_1['FLOSUM_NAMESPACE']+_0xc943e(0x135)]:_0x145fb1,[constants_1[_0xc943e(0x159)]+_0xc943e(0x157)]:_0x2e2d14});return _0x371390;}async[a244_0x4e6e91(0x14c)](_0x22d32a,_0x4f2f60){const _0x15b369=a244_0x4e6e91,_0x123b19={},_0x4c53d3=zip_1[_0x15b369(0x151)][_0x15b369(0x125)]();for(const _0x2e5692 of Object['keys'](_0x22d32a[_0x15b369(0x120)])){_0x4c53d3[_0x15b369(0x115)](_0x2e5692,_0x22d32a[_0x15b369(0x120)][_0x2e5692],{'createFolders':!![]});}return _0x123b19['ContentType']=_0x15b369(0x10e),_0x123b19['Name']=_0x22d32a['type'],_0x123b19[_0x15b369(0x13b)]=_0x22d32a['type'],_0x123b19['ParentId']=_0x4f2f60,_0x123b19[_0x15b369(0x142)]=await _0x4c53d3['generateAsync']({'type':_0x15b369(0xfe),'compression':_0x15b369(0x152),'compressionOptions':{'level':0x6}}),_0x123b19;}[a244_0x4e6e91(0x167)](_0xddd145,_0x448f8e,_0x1fb440){const _0x20988d=a244_0x4e6e91,_0xaa2e07=new Date()[_0x20988d(0x101)](),_0x30ef1c={};return _0x30ef1c[constants_1['FLOSUM_NAMESPACE']+_0x20988d(0x12b)]=_0x448f8e,_0x30ef1c[constants_1[_0x20988d(0x159)]+_0x20988d(0x146)]=_0xddd145[_0x20988d(0x13d)],_0x30ef1c[constants_1[_0x20988d(0x159)]+_0x20988d(0x15b)]=_0xaa2e07,_0x30ef1c[constants_1['FLOSUM_NAMESPACE']+_0x20988d(0x163)]=this['username'],_0x30ef1c[constants_1[_0x20988d(0x159)]+'Version__c']=_0x1fb440?_0x1fb440+0x1:0x1,_0x30ef1c[constants_1[_0x20988d(0xfd)]+_0x20988d(0x10f)]=!![],_0x30ef1c;}[a244_0x4e6e91(0x132)](_0x73ac55,_0x1847a6){const _0x3fbbb8=a244_0x4e6e91;var _0x390c56,_0x1959b9;const _0x584186=new Date()[_0x3fbbb8(0x101)](),_0x132b6a={};return!_0x1847a6?(this['branchId']?(_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x14b)]=this[_0x3fbbb8(0xfc)],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x11b)]='Branch',_0x132b6a[_0x3fbbb8(0x108)]=(_0x390c56=this[_0x3fbbb8(0x105)][_0x3fbbb8(0x11d)](_0xafd472=>_0xafd472[_0x3fbbb8(0x112)]==='Branch'))===null||_0x390c56===void 0x0?void 0x0:_0x390c56['id']):(_0x132b6a[constants_1['FLOSUM_NAMESPACE']+'Repository__c']=this[_0x3fbbb8(0x160)],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x11b)]=_0x3fbbb8(0x150),_0x132b6a[_0x3fbbb8(0x108)]=(_0x1959b9=this[_0x3fbbb8(0x105)][_0x3fbbb8(0x11d)](_0x195ab2=>_0x195ab2['name']===_0x3fbbb8(0x150)))===null||_0x1959b9===void 0x0?void 0x0:_0x1959b9['id']),_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x10b)]=0x1):_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x10b)]=_0x1847a6['version']+0x1,_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x166)]=_0x73ac55[_0x3fbbb8(0x15c)],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x153)]=_0x73ac55['name'],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x129)]=_0x73ac55[_0x3fbbb8(0x12f)],_0x132b6a[constants_1['FLOSUM_NAMESPACE']+'Last_Updated_By__c']=this[_0x3fbbb8(0x138)],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x111)]=this['username'],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x145)]=_0x584186,_0x132b6a[constants_1[_0x3fbbb8(0x159)]+'Committed_On__c']=_0x584186,_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x146)]=_0x73ac55[_0x3fbbb8(0x13d)],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x116)]=_0x73ac55[_0x3fbbb8(0xfb)],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x140)]=_0x73ac55[_0x3fbbb8(0x10d)],_0x132b6a[constants_1[_0x3fbbb8(0x159)]+_0x3fbbb8(0x127)]=_0x73ac55[_0x3fbbb8(0x148)],_0x132b6a;}[a244_0x4e6e91(0x121)](){return this['proceededComponentsMeta'];}async[a244_0x4e6e91(0x134)](_0x37b9d8,_0x120351){const _0x2c2cf0=a244_0x4e6e91,_0x409943=[];for(const _0x17b127 of _0x37b9d8){const _0x51b43a=(0x0,composite_utils_1[_0x2c2cf0(0x137)])(constants_1['FLOSUM_COMPONENT'],this['prepareComponentRecord'](_0x17b127)),_0x3eda40=(0x0,composite_utils_1[_0x2c2cf0(0x137)])(constants_1[_0x2c2cf0(0x156)],this[_0x2c2cf0(0x167)](_0x17b127,'@{'+_0x51b43a[_0x2c2cf0(0x103)]+'.id}')),_0x3d2966=(0x0,composite_utils_1[_0x2c2cf0(0x137)])(constants_1[_0x2c2cf0(0x14e)],await this[_0x2c2cf0(0x14c)](_0x17b127,'@{'+_0x3eda40['reference']+'.id}'));this[_0x2c2cf0(0x118)](_0x51b43a['request'][_0x2c2cf0(0x106)],_0x51b43a[_0x2c2cf0(0x103)]),_0x409943[_0x2c2cf0(0x141)](_0x51b43a[_0x2c2cf0(0xff)],_0x3eda40[_0x2c2cf0(0xff)],_0x3d2966[_0x2c2cf0(0xff)]),_0x120351&&_0x409943[_0x2c2cf0(0x141)](this[_0x2c2cf0(0x149)](_0x120351,'@{'+_0x3eda40[_0x2c2cf0(0x103)]+_0x2c2cf0(0x11c)));}return _0x409943;}async[a244_0x4e6e91(0x15a)](_0x422b3b,_0x3c896c=''){const _0x384130=a244_0x4e6e91,_0x872b0d=[];for(const {component:_0x42cb1c,meta:_0x354732}of _0x422b3b){if(!_0x354732['id']){const _0x1c7c4c=this[_0x384130(0x13a)]['find'](_0x2a67a0=>_0x2a67a0[_0x384130(0x117)]===_0x42cb1c[_0x384130(0x112)]&&_0x2a67a0['componentType']===_0x42cb1c[_0x384130(0x15c)]);if(!_0x1c7c4c)throw new salesforce_error_1[(_0x384130(0x124))](new Error(_0x384130(0x11e)+_0x42cb1c[_0x384130(0x112)]+'\x20['+_0x42cb1c[_0x384130(0x15c)]+_0x384130(0x130)));_0x354732['id']=_0x1c7c4c[_0x384130(0x109)];}const _0x4e62a6=(0x0,composite_utils_1[_0x384130(0x139)])(constants_1[_0x384130(0x162)],_0x354732['id'],this[_0x384130(0x132)](_0x42cb1c,_0x354732)),_0x15f397=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x384130(0x156)],this[_0x384130(0x167)](_0x42cb1c,_0x354732['id'],_0x354732[_0x384130(0x133)])),_0x193b27=(0x0,composite_utils_1[_0x384130(0x137)])(constants_1[_0x384130(0x14e)],await this['prepareComponentAttachmentRecord'](_0x42cb1c,'@{'+_0x15f397[_0x384130(0x103)]+_0x384130(0x11c)));this[_0x384130(0x118)](_0x4e62a6[_0x384130(0xff)][_0x384130(0x106)],_0x4e62a6[_0x384130(0x103)]),_0x872b0d[_0x384130(0x141)](_0x4e62a6[_0x384130(0xff)],_0x15f397[_0x384130(0xff)],_0x193b27['request']),_0x3c896c&&_0x872b0d[_0x384130(0x141)](this[_0x384130(0x149)](_0x3c896c,'@{'+_0x15f397[_0x384130(0x103)]+'.id}'));}return _0x872b0d;}async[a244_0x4e6e91(0x147)](_0x45c360,_0xc28383=![]){const _0x1fa6a7=a244_0x4e6e91,_0x2901bb={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x3a9849=[];for(const _0x4a1a30 of _0x45c360){if(_0x4a1a30['id'])_0x3a9849['push'](_0x4a1a30['id']);else{const _0x1c6c81=this[_0x1fa6a7(0x13a)][_0x1fa6a7(0x11d)](_0xa6be8=>_0xa6be8[_0x1fa6a7(0x117)]===_0x4a1a30[_0x1fa6a7(0x112)]&&_0xa6be8[_0x1fa6a7(0x114)]===_0x4a1a30[_0x1fa6a7(0x15c)]);if(!_0x1c6c81||!_0x1c6c81[_0x1fa6a7(0x109)])continue;_0x3a9849[_0x1fa6a7(0x141)](_0x1c6c81[_0x1fa6a7(0x109)]);}}if(_0xc28383){const _0x4b918e=await this[_0x1fa6a7(0x158)][_0x1fa6a7(0x119)](_0x3a9849);_0x2901bb[_0x1fa6a7(0x12e)]=_0x4b918e[_0x1fa6a7(0x102)](_0x2c6632=>(0x0,composite_utils_1[_0x1fa6a7(0x110)])(constants_1[_0x1fa6a7(0x165)],_0x2c6632)[_0x1fa6a7(0xff)]);}return _0x2901bb[_0x1fa6a7(0x155)]=_0x3a9849[_0x1fa6a7(0x102)](_0x31e741=>(0x0,composite_utils_1['createPatchRequest'])(constants_1[_0x1fa6a7(0x162)],_0x31e741,{[constants_1[_0x1fa6a7(0xfd)]+_0x1fa6a7(0x168)]:!![]})[_0x1fa6a7(0xff)]),_0x2901bb[_0x1fa6a7(0x136)]=_0x3a9849[_0x1fa6a7(0x102)](_0x1fb5dc=>(0x0,composite_utils_1[_0x1fa6a7(0x110)])(constants_1['FLOSUM_COMPONENT'],_0x1fb5dc)['request']),_0x2901bb;}}exports['SalesforceComponentsManager']=SalesforceComponentsManager;