function a245_0x3d3c(_0x885af1,_0x25bc93){const _0x1ecfb7=a245_0x2969();return a245_0x3d3c=function(_0x1a0bfd,_0x178181){_0x1a0bfd=_0x1a0bfd-0xa5;let _0x2969c0=_0x1ecfb7[_0x1a0bfd];return _0x2969c0;},a245_0x3d3c(_0x885af1,_0x25bc93);}const a245_0x2d7e1d=a245_0x3d3c;(function(_0x5253e9,_0x4947e0){const _0x2beacc=a245_0x3d3c,_0x3bf651=_0x5253e9();while(!![]){try{const _0x51d923=parseInt(_0x2beacc(0xca))/0x1+parseInt(_0x2beacc(0xff))/0x2*(-parseInt(_0x2beacc(0x107))/0x3)+parseInt(_0x2beacc(0xb8))/0x4+-parseInt(_0x2beacc(0xce))/0x5+parseInt(_0x2beacc(0xad))/0x6*(-parseInt(_0x2beacc(0xe3))/0x7)+parseInt(_0x2beacc(0xdc))/0x8*(-parseInt(_0x2beacc(0xf8))/0x9)+-parseInt(_0x2beacc(0xcd))/0xa*(-parseInt(_0x2beacc(0xb5))/0xb);if(_0x51d923===_0x4947e0)break;else _0x3bf651['push'](_0x3bf651['shift']());}catch(_0x2b94c9){_0x3bf651['push'](_0x3bf651['shift']());}}}(a245_0x2969,0xd41dc));const a245_0x178181=(function(){let _0x2dd03d=!![];return function(_0x1a9038,_0x146d72){const _0x3224bc=_0x2dd03d?function(){if(_0x146d72){const _0x3baa53=_0x146d72['apply'](_0x1a9038,arguments);return _0x146d72=null,_0x3baa53;}}:function(){};return _0x2dd03d=![],_0x3224bc;};}()),a245_0x1a0bfd=a245_0x178181(this,function(){const _0x4cc934=a245_0x3d3c;return a245_0x1a0bfd[_0x4cc934(0xd8)]()[_0x4cc934(0x10a)](_0x4cc934(0xf0))[_0x4cc934(0xd8)]()[_0x4cc934(0xab)](a245_0x1a0bfd)[_0x4cc934(0x10a)](_0x4cc934(0xf0));});function a245_0x2969(){const _0x593620=['FLOSUM_ATTACHMENT','Repository__c','filePath','push','Vlocity_Component_Name__c','proceededComponentsMeta','Description','logger','files','fetchCommitManifestsByComponentIds','Is_From_Agent__c',']\x20-\x20meta\x20not\x20found','componentName','recordTypes','map','update','807649OpIbJA','File_Name__c','request','4410650KQuUIT','3691825xGVhKe','base64','createPostRequest','version','FLOSUM_GIT_NAMESPACE','Component_Name__c','componentId','prepareComponentRecord','find','../utils/composite.utils','toString','proceedComponentMeta','FLOSUM_COMPONENT','componentType','8RrllqW','branchId','createPatchRequest','Source__c','componentsToUpdate','DEFLATE','Name','28EfbDUi','Could\x20not\x20proceed\x20component\x20','body','crc','.id}','Last_Updated_By__c','repositoryId','RecordTypeId','reference','SalesforceComponentsManager','FLOSUM_COMMIT_MANIFEST','Vlocity_Component__c','Branch','(((.+)+)+)+$','Changed_By__c','defineProperty','Component_History__c','../../../../constants','gitSync','Version__c','extractFieldsFromRecord','7713oezXxx','prepareComponentAttachmentRecord','createDeleteRequest','file','./salesforce-git-sync.service','name','Component_Type__c','32cRijMQ','Zip','Changed_On__c','vlocityComponentName','__esModule','ContentType','CRC32__c','Deletion_By_Agent__c','284628GFLGMp','../errors/salesforce.error','generateAsync','search','Last_Modified_Date__c','../utils/flosum-naming.utils','__importDefault','toISOString','username','type','Committed_On__c','insert','manifests','constructor','SalesforceGitSyncService','1997790acEGon','application/zip','Branch__c','get','Logger','prepareCommitManifest','prepareComponentHistoryRecord','MC_Key__c','55HXuNDh','Last_Modified_By__c','FLOSUM_NAMESPACE','5779808tSScmj','keys'];a245_0x2969=function(){return _0x593620;};return a245_0x2969();}a245_0x1a0bfd();'use strict';var __importDefault=this&&this[a245_0x2d7e1d(0x10d)]||function(_0x26a9f6){const _0x1eaa3c=a245_0x2d7e1d;return _0x26a9f6&&_0x26a9f6[_0x1eaa3c(0x103)]?_0x26a9f6:{'default':_0x26a9f6};};Object[a245_0x2d7e1d(0xf2)](exports,'__esModule',{'value':!![]}),exports[a245_0x2d7e1d(0xec)]=void 0x0;const constants_1=require(a245_0x2d7e1d(0xf4)),core_1=require('../../../../core'),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a245_0x2d7e1d(0x108)),composite_utils_1=require(a245_0x2d7e1d(0xd7)),flosum_naming_utils_1=require(a245_0x2d7e1d(0x10c)),salesforce_git_sync_service_1=require(a245_0x2d7e1d(0xfc));class SalesforceComponentsManager{constructor(_0x5dc156,_0x1ade2b,_0x10f289,_0x9b4cdf,_0x9eff8f){const _0x34779d=a245_0x2d7e1d;this['repositoryId']=_0x5dc156,this[_0x34779d(0xdd)]=_0x1ade2b,this[_0x34779d(0xa6)]=_0x10f289,this[_0x34779d(0xc7)]=_0x9b4cdf,this[_0x34779d(0xbf)]=_0x9eff8f,this[_0x34779d(0xc1)]=new core_1[(_0x34779d(0xb1))](SalesforceComponentsManager[_0x34779d(0xfd)]),this[_0x34779d(0xf5)]=typedi_1['default'][_0x34779d(0xb0)](salesforce_git_sync_service_1[_0x34779d(0xac)]);}['proceedComponentMeta'](_0x3598de,_0x5664b2){const _0x24cd17=a245_0x2d7e1d,_0x252c53=(0x0,flosum_naming_utils_1[_0x24cd17(0xf7)])(_0x3598de,[_0x24cd17(0xfe),_0x24cd17(0xd3),_0x24cd17(0xf6)]);this[_0x24cd17(0xbf)][_0x24cd17(0xbd)]({'componentId':'','reference':_0x5664b2,'version':_0x252c53[_0x24cd17(0xf6)],'componentName':_0x252c53['Component_Name__c'],'componentType':_0x252c53[_0x24cd17(0xfe)]});}['prepareCommitManifest'](_0x25c441,_0x2c80c6){const _0x7aaa8b=a245_0x2d7e1d,{request:_0x4d33d3}=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x7aaa8b(0xed)],{[constants_1[_0x7aaa8b(0xb7)]+'Commit__c']:_0x25c441,[constants_1[_0x7aaa8b(0xb7)]+_0x7aaa8b(0xf3)]:_0x2c80c6});return _0x4d33d3;}async['prepareComponentAttachmentRecord'](_0x3daa77,_0x41f3b6){const _0x220c40=a245_0x2d7e1d,_0x1a35ff={},_0x32be77=zip_1[_0x220c40(0x100)]['createZip']();for(const _0x6bb423 of Object[_0x220c40(0xb9)](_0x3daa77[_0x220c40(0xc2)])){_0x32be77[_0x220c40(0xfb)](_0x6bb423,_0x3daa77['files'][_0x6bb423],{'createFolders':!![]});}return _0x1a35ff[_0x220c40(0x104)]=_0x220c40(0xae),_0x1a35ff[_0x220c40(0xe2)]=_0x3daa77[_0x220c40(0xa7)],_0x1a35ff[_0x220c40(0xc0)]=_0x3daa77[_0x220c40(0xa7)],_0x1a35ff['ParentId']=_0x41f3b6,_0x1a35ff['Body']=await _0x32be77[_0x220c40(0x109)]({'type':_0x220c40(0xcf),'compression':_0x220c40(0xe1),'compressionOptions':{'level':0x6}}),_0x1a35ff;}[a245_0x2d7e1d(0xb3)](_0x1c36b1,_0x497a73,_0x4a596d){const _0xa98dbc=a245_0x2d7e1d,_0x4b8ea8=new Date()['toISOString'](),_0x5866dd={};return _0x5866dd[constants_1[_0xa98dbc(0xb7)]+'Component__c']=_0x497a73,_0x5866dd[constants_1[_0xa98dbc(0xb7)]+_0xa98dbc(0x105)]=_0x1c36b1['crc'],_0x5866dd[constants_1['FLOSUM_NAMESPACE']+_0xa98dbc(0x101)]=_0x4b8ea8,_0x5866dd[constants_1[_0xa98dbc(0xb7)]+_0xa98dbc(0xf1)]=this[_0xa98dbc(0xa6)],_0x5866dd[constants_1[_0xa98dbc(0xb7)]+_0xa98dbc(0xf6)]=_0x4a596d?_0x4a596d+0x1:0x1,_0x5866dd[constants_1['FLOSUM_GIT_NAMESPACE']+_0xa98dbc(0xc4)]=!![],_0x5866dd;}[a245_0x2d7e1d(0xd5)](_0x3d3a4a,_0x882d85){const _0x3c1c13=a245_0x2d7e1d;var _0x4ed1e6,_0x4622d9;const _0x365359=new Date()[_0x3c1c13(0xa5)](),_0x3a9e17={};return!_0x882d85?(this['branchId']?(_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+_0x3c1c13(0xaf)]=this[_0x3c1c13(0xdd)],_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0xdf)]=_0x3c1c13(0xef),_0x3a9e17[_0x3c1c13(0xea)]=(_0x4ed1e6=this[_0x3c1c13(0xc7)]['find'](_0x209b39=>_0x209b39[_0x3c1c13(0xfd)]==='Branch'))===null||_0x4ed1e6===void 0x0?void 0x0:_0x4ed1e6['id']):(_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+_0x3c1c13(0xbb)]=this[_0x3c1c13(0xe9)],_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+'Source__c']='Repository',_0x3a9e17[_0x3c1c13(0xea)]=(_0x4622d9=this[_0x3c1c13(0xc7)][_0x3c1c13(0xd6)](_0x2dcda0=>_0x2dcda0['name']==='Repository'))===null||_0x4622d9===void 0x0?void 0x0:_0x4622d9['id']),_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0xf6)]=0x1):_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+'Version__c']=_0x882d85[_0x3c1c13(0xd1)]+0x1,_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+_0x3c1c13(0xfe)]=_0x3d3a4a['type'],_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+'Component_Name__c']=_0x3d3a4a['name'],_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+_0x3c1c13(0xcb)]=_0x3d3a4a[_0x3c1c13(0xbc)],_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0xe8)]=this['username'],_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0xb6)]=this['username'],_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0x10b)]=_0x365359,_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0xa8)]=_0x365359,_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+_0x3c1c13(0x105)]=_0x3d3a4a[_0x3c1c13(0xe6)],_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0xbe)]=_0x3d3a4a[_0x3c1c13(0x102)],_0x3a9e17[constants_1['FLOSUM_NAMESPACE']+_0x3c1c13(0xee)]=_0x3d3a4a['isVlocityComponent'],_0x3a9e17[constants_1[_0x3c1c13(0xb7)]+_0x3c1c13(0xb4)]=_0x3d3a4a['marketingCloudKey'],_0x3a9e17;}['getProceededComponentsMeta'](){return this['proceededComponentsMeta'];}async[a245_0x2d7e1d(0xa9)](_0x2995a,_0x48a0ff){const _0x2ca9a6=a245_0x2d7e1d,_0x7128d3=[];for(const _0xccfbdc of _0x2995a){const _0x56fd2d=(0x0,composite_utils_1[_0x2ca9a6(0xd0)])(constants_1[_0x2ca9a6(0xda)],this[_0x2ca9a6(0xd5)](_0xccfbdc)),_0x4abd27=(0x0,composite_utils_1[_0x2ca9a6(0xd0)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x2ca9a6(0xb3)](_0xccfbdc,'@{'+_0x56fd2d[_0x2ca9a6(0xeb)]+_0x2ca9a6(0xe7))),_0x8d1799=(0x0,composite_utils_1[_0x2ca9a6(0xd0)])(constants_1[_0x2ca9a6(0xba)],await this[_0x2ca9a6(0xf9)](_0xccfbdc,'@{'+_0x4abd27[_0x2ca9a6(0xeb)]+_0x2ca9a6(0xe7)));this[_0x2ca9a6(0xd9)](_0x56fd2d[_0x2ca9a6(0xcc)][_0x2ca9a6(0xe5)],_0x56fd2d[_0x2ca9a6(0xeb)]),_0x7128d3[_0x2ca9a6(0xbd)](_0x56fd2d[_0x2ca9a6(0xcc)],_0x4abd27['request'],_0x8d1799[_0x2ca9a6(0xcc)]),_0x48a0ff&&_0x7128d3[_0x2ca9a6(0xbd)](this[_0x2ca9a6(0xb2)](_0x48a0ff,'@{'+_0x4abd27[_0x2ca9a6(0xeb)]+_0x2ca9a6(0xe7)));}return _0x7128d3;}async[a245_0x2d7e1d(0xc9)](_0x7ec533,_0x36ce8c=''){const _0x3c7177=a245_0x2d7e1d,_0x2b9ce4=[];for(const {component:_0x130dbe,meta:_0x2af01a}of _0x7ec533){if(!_0x2af01a['id']){const _0x4fb805=this[_0x3c7177(0xbf)]['find'](_0x45dff8=>_0x45dff8[_0x3c7177(0xc6)]===_0x130dbe[_0x3c7177(0xfd)]&&_0x45dff8[_0x3c7177(0xdb)]===_0x130dbe[_0x3c7177(0xa7)]);if(!_0x4fb805)throw new salesforce_error_1['SalesforceError'](new Error(_0x3c7177(0xe4)+_0x130dbe[_0x3c7177(0xfd)]+'\x20['+_0x130dbe[_0x3c7177(0xa7)]+_0x3c7177(0xc5)));_0x2af01a['id']=_0x4fb805[_0x3c7177(0xd4)];}const _0x3c922e=(0x0,composite_utils_1[_0x3c7177(0xde)])(constants_1[_0x3c7177(0xda)],_0x2af01a['id'],this[_0x3c7177(0xd5)](_0x130dbe,_0x2af01a)),_0x1b6f33=(0x0,composite_utils_1[_0x3c7177(0xd0)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x3c7177(0xb3)](_0x130dbe,_0x2af01a['id'],_0x2af01a[_0x3c7177(0xd1)])),_0x29e210=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x3c7177(0xba)],await this[_0x3c7177(0xf9)](_0x130dbe,'@{'+_0x1b6f33[_0x3c7177(0xeb)]+_0x3c7177(0xe7)));this[_0x3c7177(0xd9)](_0x3c922e[_0x3c7177(0xcc)]['body'],_0x3c922e[_0x3c7177(0xeb)]),_0x2b9ce4[_0x3c7177(0xbd)](_0x3c922e[_0x3c7177(0xcc)],_0x1b6f33[_0x3c7177(0xcc)],_0x29e210[_0x3c7177(0xcc)]),_0x36ce8c&&_0x2b9ce4[_0x3c7177(0xbd)](this['prepareCommitManifest'](_0x36ce8c,'@{'+_0x1b6f33[_0x3c7177(0xeb)]+_0x3c7177(0xe7)));}return _0x2b9ce4;}async['delete'](_0x4705be,_0x3ffef9=![]){const _0x459bdc=a245_0x2d7e1d,_0x40cef7={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x4ad1e7=[];for(const _0x5e141c of _0x4705be){if(_0x5e141c['id'])_0x4ad1e7['push'](_0x5e141c['id']);else{const _0x322979=this[_0x459bdc(0xbf)][_0x459bdc(0xd6)](_0x508a72=>_0x508a72[_0x459bdc(0xc6)]===_0x5e141c[_0x459bdc(0xfd)]&&_0x508a72[_0x459bdc(0xdb)]===_0x5e141c[_0x459bdc(0xa7)]);if(!_0x322979||!_0x322979[_0x459bdc(0xd4)])continue;_0x4ad1e7[_0x459bdc(0xbd)](_0x322979[_0x459bdc(0xd4)]);}}if(_0x3ffef9){const _0xf7078f=await this[_0x459bdc(0xf5)][_0x459bdc(0xc3)](_0x4ad1e7);_0x40cef7[_0x459bdc(0xaa)]=_0xf7078f[_0x459bdc(0xc8)](_0x56002c=>(0x0,composite_utils_1[_0x459bdc(0xfa)])(constants_1['FLOSUM_COMMIT_MANIFEST'],_0x56002c)[_0x459bdc(0xcc)]);}return _0x40cef7[_0x459bdc(0xe0)]=_0x4ad1e7[_0x459bdc(0xc8)](_0x36b147=>(0x0,composite_utils_1[_0x459bdc(0xde)])(constants_1[_0x459bdc(0xda)],_0x36b147,{[constants_1[_0x459bdc(0xd2)]+_0x459bdc(0x106)]:!![]})[_0x459bdc(0xcc)]),_0x40cef7['componentsToDelete']=_0x4ad1e7[_0x459bdc(0xc8)](_0x5092d7=>(0x0,composite_utils_1[_0x459bdc(0xfa)])(constants_1[_0x459bdc(0xda)],_0x5092d7)[_0x459bdc(0xcc)]),_0x40cef7;}}exports[a245_0x2d7e1d(0xec)]=SalesforceComponentsManager;