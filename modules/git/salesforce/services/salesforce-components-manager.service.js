const a195_0x1506bf=a195_0x21ce;function a195_0x21ce(_0x748591,_0x620fd0){const _0x2e5fea=a195_0x26b0();return a195_0x21ce=function(_0x212f0e,_0x41ab1b){_0x212f0e=_0x212f0e-0x175;let _0x26b032=_0x2e5fea[_0x212f0e];return _0x26b032;},a195_0x21ce(_0x748591,_0x620fd0);}function a195_0x26b0(){const _0x3410ff=['Version__c','body','ContentType','request','componentType','createPostRequest','createDeleteRequest','prepareComponentAttachmentRecord','Changed_On__c','../errors/salesforce.error',']\x20-\x20meta\x20not\x20found','Component_Name__c','FLOSUM_COMPONENT_HISTORY','toISOString','proceededComponentsMeta','prepareComponentHistoryRecord','.id}','fetchCommitManifestsByComponentIds','username','5694185WwdXqI','Source__c','2651162tqiRAj','FLOSUM_GIT_NAMESPACE','Repository','gitSync','typedi','constructor','logger','componentId','Component_History__c','keys','delete','__esModule','Name','createPatchRequest','CRC32__c','FLOSUM_COMPONENT','branchId','application/zip','Component_Type__c','6kKPcWI','type','Last_Modified_By__c','1VzPTSv','version','Component__c','recordTypes','../../../../constants','Branch__c','8BTBehk','Description','extractFieldsFromRecord','11698490BPYZiY','Body','prepareCommitManifest','315SgIzWk','FLOSUM_COMMIT_MANIFEST','Is_From_Agent__c','File_Name__c','repositoryId','files','__importDefault','Zip','ParentId','base64','RecordTypeId','crc','../utils/flosum-naming.utils','Branch','(((.+)+)+)+$','filePath','manifests','componentsToDelete','name','Last_Updated_By__c','FLOSUM_ATTACHMENT','push','SalesforceGitSyncService','toString','Deletion_By_Agent__c','../../../../core','proceedComponentMeta','componentName','file','reference','search','Logger','Could\x20not\x20proceed\x20component\x20','298488SasPer','121SFiymH','1969467CckbTI','3207700xUdhnU','FLOSUM_NAMESPACE','update','prepareComponentRecord','createZip','apply','SalesforceComponentsManager','./salesforce-git-sync.service','find','defineProperty','2046180XPQbUU'];a195_0x26b0=function(){return _0x3410ff;};return a195_0x26b0();}(function(_0x1ccfc2,_0x4b5924){const _0x2439ac=a195_0x21ce,_0x17b918=_0x1ccfc2();while(!![]){try{const _0x982cc5=-parseInt(_0x2439ac(0x186))/0x1*(parseInt(_0x2439ac(0x1d6))/0x2)+-parseInt(_0x2439ac(0x1b5))/0x3+-parseInt(_0x2439ac(0x18c))/0x4*(-parseInt(_0x2439ac(0x1b6))/0x5)+parseInt(_0x2439ac(0x183))/0x6*(parseInt(_0x2439ac(0x1d4))/0x7)+parseInt(_0x2439ac(0x1b3))/0x8*(parseInt(_0x2439ac(0x192))/0x9)+parseInt(_0x2439ac(0x18f))/0xa+-parseInt(_0x2439ac(0x1b4))/0xb*(parseInt(_0x2439ac(0x1c0))/0xc);if(_0x982cc5===_0x4b5924)break;else _0x17b918['push'](_0x17b918['shift']());}catch(_0x1a7517){_0x17b918['push'](_0x17b918['shift']());}}}(a195_0x26b0,0xae726));const a195_0x41ab1b=(function(){let _0x156239=!![];return function(_0x357329,_0xa65fb1){const _0x5e07f5=_0x156239?function(){const _0x2e02d3=a195_0x21ce;if(_0xa65fb1){const _0xf42de9=_0xa65fb1[_0x2e02d3(0x1bb)](_0x357329,arguments);return _0xa65fb1=null,_0xf42de9;}}:function(){};return _0x156239=![],_0x5e07f5;};}()),a195_0x212f0e=a195_0x41ab1b(this,function(){const _0x3e811e=a195_0x21ce;return a195_0x212f0e[_0x3e811e(0x1a9)]()[_0x3e811e(0x1b0)]('(((.+)+)+)+$')[_0x3e811e(0x1a9)]()[_0x3e811e(0x175)](a195_0x212f0e)[_0x3e811e(0x1b0)](_0x3e811e(0x1a0));});a195_0x212f0e();'use strict';var __importDefault=this&&this[a195_0x1506bf(0x198)]||function(_0x3354b5){return _0x3354b5&&_0x3354b5['__esModule']?_0x3354b5:{'default':_0x3354b5};};Object[a195_0x1506bf(0x1bf)](exports,a195_0x1506bf(0x17b),{'value':!![]}),exports[a195_0x1506bf(0x1bc)]=void 0x0;const constants_1=require(a195_0x1506bf(0x18a)),core_1=require(a195_0x1506bf(0x1ab)),zip_1=require('../../parsers/utils/zip'),typedi_1=__importDefault(require(a195_0x1506bf(0x1da))),salesforce_error_1=require(a195_0x1506bf(0x1ca)),composite_utils_1=require('../utils/composite.utils'),flosum_naming_utils_1=require(a195_0x1506bf(0x19e)),salesforce_git_sync_service_1=require(a195_0x1506bf(0x1bd));class SalesforceComponentsManager{constructor(_0x461fab,_0x36bd38,_0x2182cc,_0x29e03d,_0x4cc998){const _0x2c9af1=a195_0x1506bf;this[_0x2c9af1(0x196)]=_0x461fab,this[_0x2c9af1(0x180)]=_0x36bd38,this[_0x2c9af1(0x1d3)]=_0x2182cc,this[_0x2c9af1(0x189)]=_0x29e03d,this[_0x2c9af1(0x1cf)]=_0x4cc998,this[_0x2c9af1(0x176)]=new core_1[(_0x2c9af1(0x1b1))](SalesforceComponentsManager[_0x2c9af1(0x1a4)]),this[_0x2c9af1(0x1d9)]=typedi_1['default']['get'](salesforce_git_sync_service_1[_0x2c9af1(0x1a8)]);}[a195_0x1506bf(0x1ac)](_0x5277a3,_0x33e703){const _0x26c163=a195_0x1506bf,_0x4d6c94=(0x0,flosum_naming_utils_1[_0x26c163(0x18e)])(_0x5277a3,[_0x26c163(0x182),'Component_Name__c',_0x26c163(0x1c1)]);this[_0x26c163(0x1cf)][_0x26c163(0x1a7)]({'componentId':'','reference':_0x33e703,'version':_0x4d6c94['Version__c'],'componentName':_0x4d6c94[_0x26c163(0x1cc)],'componentType':_0x4d6c94[_0x26c163(0x182)]});}['prepareCommitManifest'](_0x49b1c4,_0x2df250){const _0x5b7401=a195_0x1506bf,{request:_0x4b0700}=(0x0,composite_utils_1[_0x5b7401(0x1c6)])(constants_1[_0x5b7401(0x193)],{[constants_1['FLOSUM_NAMESPACE']+'Commit__c']:_0x49b1c4,[constants_1[_0x5b7401(0x1b7)]+_0x5b7401(0x178)]:_0x2df250});return _0x4b0700;}async[a195_0x1506bf(0x1c8)](_0xb261a6,_0x23fb7e){const _0x3e3e95=a195_0x1506bf,_0x44d34d={},_0x365672=zip_1[_0x3e3e95(0x199)][_0x3e3e95(0x1ba)]();for(const _0x5f019e of Object[_0x3e3e95(0x179)](_0xb261a6[_0x3e3e95(0x197)])){_0x365672[_0x3e3e95(0x1ae)](_0x5f019e,_0xb261a6[_0x3e3e95(0x197)][_0x5f019e],{'createFolders':!![]});}return _0x44d34d[_0x3e3e95(0x1c3)]=_0x3e3e95(0x181),_0x44d34d[_0x3e3e95(0x17c)]=_0xb261a6[_0x3e3e95(0x184)],_0x44d34d[_0x3e3e95(0x18d)]=_0xb261a6[_0x3e3e95(0x184)],_0x44d34d[_0x3e3e95(0x19a)]=_0x23fb7e,_0x44d34d[_0x3e3e95(0x190)]=await _0x365672['generateAsync']({'type':_0x3e3e95(0x19b),'compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x44d34d;}[a195_0x1506bf(0x1d0)](_0x4b9d27,_0x13d4d0,_0x531cfe){const _0xe2c2b0=a195_0x1506bf,_0x518725=new Date()[_0xe2c2b0(0x1ce)](),_0x5b552f={};return _0x5b552f[constants_1['FLOSUM_NAMESPACE']+_0xe2c2b0(0x188)]=_0x13d4d0,_0x5b552f[constants_1[_0xe2c2b0(0x1b7)]+'CRC32__c']=_0x4b9d27['crc'],_0x5b552f[constants_1['FLOSUM_NAMESPACE']+_0xe2c2b0(0x1c9)]=_0x518725,_0x5b552f[constants_1[_0xe2c2b0(0x1b7)]+'Changed_By__c']=this[_0xe2c2b0(0x1d3)],_0x5b552f[constants_1[_0xe2c2b0(0x1b7)]+_0xe2c2b0(0x1c1)]=_0x531cfe?_0x531cfe+0x1:0x1,_0x5b552f[constants_1['FLOSUM_GIT_NAMESPACE']+_0xe2c2b0(0x194)]=!![],_0x5b552f;}[a195_0x1506bf(0x1b9)](_0x2c855e,_0x551890){const _0x5baa7f=a195_0x1506bf;var _0x2aafac,_0x8974e7;const _0x268364=new Date()[_0x5baa7f(0x1ce)](),_0x394881={};return!_0x551890?(this[_0x5baa7f(0x180)]?(_0x394881[constants_1['FLOSUM_NAMESPACE']+_0x5baa7f(0x18b)]=this['branchId'],_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x1d5)]=_0x5baa7f(0x19f),_0x394881[_0x5baa7f(0x19c)]=(_0x2aafac=this[_0x5baa7f(0x189)]['find'](_0x3aa753=>_0x3aa753['name']===_0x5baa7f(0x19f)))===null||_0x2aafac===void 0x0?void 0x0:_0x2aafac['id']):(_0x394881[constants_1[_0x5baa7f(0x1b7)]+'Repository__c']=this[_0x5baa7f(0x196)],_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x1d5)]=_0x5baa7f(0x1d8),_0x394881[_0x5baa7f(0x19c)]=(_0x8974e7=this[_0x5baa7f(0x189)][_0x5baa7f(0x1be)](_0x15c884=>_0x15c884['name']==='Repository'))===null||_0x8974e7===void 0x0?void 0x0:_0x8974e7['id']),_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x1c1)]=0x1):_0x394881[constants_1[_0x5baa7f(0x1b7)]+'Version__c']=_0x551890[_0x5baa7f(0x187)]+0x1,_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x182)]=_0x2c855e['type'],_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x1cc)]=_0x2c855e[_0x5baa7f(0x1a4)],_0x394881[constants_1['FLOSUM_NAMESPACE']+_0x5baa7f(0x195)]=_0x2c855e[_0x5baa7f(0x1a1)],_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x1a5)]=this[_0x5baa7f(0x1d3)],_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x185)]=this['username'],_0x394881[constants_1[_0x5baa7f(0x1b7)]+'Last_Modified_Date__c']=_0x268364,_0x394881[constants_1[_0x5baa7f(0x1b7)]+'Committed_On__c']=_0x268364,_0x394881[constants_1[_0x5baa7f(0x1b7)]+_0x5baa7f(0x17e)]=_0x2c855e[_0x5baa7f(0x19d)],_0x394881;}['getProceededComponentsMeta'](){const _0x5534e6=a195_0x1506bf;return this[_0x5534e6(0x1cf)];}async['insert'](_0x3c1804,_0x4be3c6){const _0x2f01de=a195_0x1506bf,_0x3574fc=[];for(const _0x503c0f of _0x3c1804){const _0x3b2137=(0x0,composite_utils_1[_0x2f01de(0x1c6)])(constants_1[_0x2f01de(0x17f)],this['prepareComponentRecord'](_0x503c0f)),_0x35761d=(0x0,composite_utils_1[_0x2f01de(0x1c6)])(constants_1[_0x2f01de(0x1cd)],this['prepareComponentHistoryRecord'](_0x503c0f,'@{'+_0x3b2137[_0x2f01de(0x1af)]+_0x2f01de(0x1d1))),_0x27b112=(0x0,composite_utils_1['createPostRequest'])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x2f01de(0x1c8)](_0x503c0f,'@{'+_0x35761d[_0x2f01de(0x1af)]+'.id}'));this[_0x2f01de(0x1ac)](_0x3b2137['request'][_0x2f01de(0x1c2)],_0x3b2137['reference']),_0x3574fc[_0x2f01de(0x1a7)](_0x3b2137[_0x2f01de(0x1c4)],_0x35761d[_0x2f01de(0x1c4)],_0x27b112['request']),_0x4be3c6&&_0x3574fc[_0x2f01de(0x1a7)](this[_0x2f01de(0x191)](_0x4be3c6,'@{'+_0x35761d[_0x2f01de(0x1af)]+_0x2f01de(0x1d1)));}return _0x3574fc;}async[a195_0x1506bf(0x1b8)](_0x402a8a,_0x1f6da1=''){const _0x5810a2=a195_0x1506bf,_0x44331e=[];for(const {component:_0x5868bf,meta:_0xd7f2bd}of _0x402a8a){if(!_0xd7f2bd['id']){const _0x5e93c4=this[_0x5810a2(0x1cf)][_0x5810a2(0x1be)](_0x4e6fe8=>_0x4e6fe8[_0x5810a2(0x1ad)]===_0x5868bf[_0x5810a2(0x1a4)]&&_0x4e6fe8[_0x5810a2(0x1c5)]===_0x5868bf[_0x5810a2(0x184)]);if(!_0x5e93c4)throw new salesforce_error_1['SalesforceError'](new Error(_0x5810a2(0x1b2)+_0x5868bf[_0x5810a2(0x1a4)]+'\x20['+_0x5868bf[_0x5810a2(0x184)]+_0x5810a2(0x1cb)));_0xd7f2bd['id']=_0x5e93c4[_0x5810a2(0x177)];}const _0xb74463=(0x0,composite_utils_1[_0x5810a2(0x17d)])(constants_1[_0x5810a2(0x17f)],_0xd7f2bd['id'],this[_0x5810a2(0x1b9)](_0x5868bf,_0xd7f2bd)),_0x9a6cc8=(0x0,composite_utils_1['createPostRequest'])(constants_1[_0x5810a2(0x1cd)],this[_0x5810a2(0x1d0)](_0x5868bf,_0xd7f2bd['id'],_0xd7f2bd[_0x5810a2(0x187)])),_0x2475e9=(0x0,composite_utils_1[_0x5810a2(0x1c6)])(constants_1[_0x5810a2(0x1a6)],await this[_0x5810a2(0x1c8)](_0x5868bf,'@{'+_0x9a6cc8['reference']+_0x5810a2(0x1d1)));this['proceedComponentMeta'](_0xb74463[_0x5810a2(0x1c4)][_0x5810a2(0x1c2)],_0xb74463[_0x5810a2(0x1af)]),_0x44331e[_0x5810a2(0x1a7)](_0xb74463[_0x5810a2(0x1c4)],_0x9a6cc8[_0x5810a2(0x1c4)],_0x2475e9['request']),_0x1f6da1&&_0x44331e[_0x5810a2(0x1a7)](this[_0x5810a2(0x191)](_0x1f6da1,'@{'+_0x9a6cc8[_0x5810a2(0x1af)]+_0x5810a2(0x1d1)));}return _0x44331e;}async[a195_0x1506bf(0x17a)](_0xaca4ab,_0x2caaf2=![]){const _0x22a09c=a195_0x1506bf,_0x513e0f={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x353c9c=[];for(const _0x182f71 of _0xaca4ab){if(_0x182f71['id'])_0x353c9c[_0x22a09c(0x1a7)](_0x182f71['id']);else{const _0x584827=this['proceededComponentsMeta'][_0x22a09c(0x1be)](_0x2bd6f4=>_0x2bd6f4[_0x22a09c(0x1ad)]===_0x182f71[_0x22a09c(0x1a4)]&&_0x2bd6f4[_0x22a09c(0x1c5)]===_0x182f71[_0x22a09c(0x184)]);if(!_0x584827||!_0x584827['componentId'])continue;_0x353c9c[_0x22a09c(0x1a7)](_0x584827[_0x22a09c(0x177)]);}}if(_0x2caaf2){const _0xa344fb=await this[_0x22a09c(0x1d9)][_0x22a09c(0x1d2)](_0x353c9c);_0x513e0f[_0x22a09c(0x1a2)]=_0xa344fb['map'](_0x168fb5=>(0x0,composite_utils_1[_0x22a09c(0x1c7)])(constants_1[_0x22a09c(0x193)],_0x168fb5)['request']);}return _0x513e0f['componentsToUpdate']=_0x353c9c['map'](_0x17cf9f=>(0x0,composite_utils_1['createPatchRequest'])(constants_1['FLOSUM_COMPONENT'],_0x17cf9f,{[constants_1[_0x22a09c(0x1d7)]+_0x22a09c(0x1aa)]:!![]})[_0x22a09c(0x1c4)]),_0x513e0f[_0x22a09c(0x1a3)]=_0x353c9c['map'](_0x1e9e88=>(0x0,composite_utils_1[_0x22a09c(0x1c7)])(constants_1[_0x22a09c(0x17f)],_0x1e9e88)[_0x22a09c(0x1c4)]),_0x513e0f;}}exports[a195_0x1506bf(0x1bc)]=SalesforceComponentsManager;