const a234_0x397339=a234_0x33c2;(function(_0x280ed0,_0x1c6ab4){const _0x438d42=a234_0x33c2,_0x41be29=_0x280ed0();while(!![]){try{const _0x2e5dde=parseInt(_0x438d42(0x14a))/0x1+parseInt(_0x438d42(0x168))/0x2*(parseInt(_0x438d42(0x19e))/0x3)+parseInt(_0x438d42(0x150))/0x4*(parseInt(_0x438d42(0x18e))/0x5)+parseInt(_0x438d42(0x186))/0x6*(parseInt(_0x438d42(0x144))/0x7)+parseInt(_0x438d42(0x171))/0x8*(-parseInt(_0x438d42(0x165))/0x9)+parseInt(_0x438d42(0x14d))/0xa*(-parseInt(_0x438d42(0x160))/0xb)+parseInt(_0x438d42(0x167))/0xc*(parseInt(_0x438d42(0x14f))/0xd);if(_0x2e5dde===_0x1c6ab4)break;else _0x41be29['push'](_0x41be29['shift']());}catch(_0x5abc3e){_0x41be29['push'](_0x41be29['shift']());}}}(a234_0x138f,0x742d5));const a234_0x5e95c3=(function(){let _0x422cf8=!![];return function(_0x326111,_0x3fd2e0){const _0x5f3b6c=_0x422cf8?function(){if(_0x3fd2e0){const _0x335cd4=_0x3fd2e0['apply'](_0x326111,arguments);return _0x3fd2e0=null,_0x335cd4;}}:function(){};return _0x422cf8=![],_0x5f3b6c;};}()),a234_0x1d27df=a234_0x5e95c3(this,function(){const _0x2a608a=a234_0x33c2;return a234_0x1d27df[_0x2a608a(0x14b)]()['search'](_0x2a608a(0x180))[_0x2a608a(0x14b)]()[_0x2a608a(0x1a4)](a234_0x1d27df)[_0x2a608a(0x16a)]('(((.+)+)+)+$');});a234_0x1d27df();'use strict';var __importDefault=this&&this[a234_0x397339(0x1a1)]||function(_0x2a0165){const _0x3e09ae=a234_0x397339;return _0x2a0165&&_0x2a0165[_0x3e09ae(0x193)]?_0x2a0165:{'default':_0x2a0165};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;const constants_1=require(a234_0x397339(0x1a0)),core_1=require(a234_0x397339(0x16d)),zip_1=require(a234_0x397339(0x16e)),typedi_1=__importDefault(require(a234_0x397339(0x151))),salesforce_error_1=require(a234_0x397339(0x178)),composite_utils_1=require(a234_0x397339(0x16f)),flosum_naming_utils_1=require(a234_0x397339(0x148)),salesforce_git_sync_service_1=require(a234_0x397339(0x162));function a234_0x33c2(_0x322d67,_0x94daba){const _0xcb6dea=a234_0x138f();return a234_0x33c2=function(_0x1d27df,_0x5e95c3){_0x1d27df=_0x1d27df-0x144;let _0x138f03=_0xcb6dea[_0x1d27df];return _0x138f03;},a234_0x33c2(_0x322d67,_0x94daba);}class SalesforceComponentsManager{constructor(_0x2fcb2d,_0x44ccb1,_0xb14372,_0x4f277f,_0x4230fc){const _0x3897b2=a234_0x397339;this[_0x3897b2(0x184)]=_0x2fcb2d,this[_0x3897b2(0x14c)]=_0x44ccb1,this[_0x3897b2(0x170)]=_0xb14372,this['recordTypes']=_0x4f277f,this[_0x3897b2(0x155)]=_0x4230fc,this['logger']=new core_1[(_0x3897b2(0x161))](SalesforceComponentsManager[_0x3897b2(0x18f)]),this[_0x3897b2(0x198)]=typedi_1[_0x3897b2(0x1a5)][_0x3897b2(0x195)](salesforce_git_sync_service_1[_0x3897b2(0x154)]);}[a234_0x397339(0x166)](_0x35138f,_0xfb0b2d){const _0x38beef=a234_0x397339,_0x360d59=(0x0,flosum_naming_utils_1[_0x38beef(0x1ac)])(_0x35138f,['Component_Type__c',_0x38beef(0x164),_0x38beef(0x173)]);this['proceededComponentsMeta'][_0x38beef(0x197)]({'componentId':'','reference':_0xfb0b2d,'version':_0x360d59[_0x38beef(0x173)],'componentName':_0x360d59[_0x38beef(0x164)],'componentType':_0x360d59[_0x38beef(0x16b)]});}[a234_0x397339(0x19d)](_0x303d8e,_0xa258ce){const _0x5213bd=a234_0x397339,{request:_0x587e27}=(0x0,composite_utils_1[_0x5213bd(0x183)])(constants_1[_0x5213bd(0x194)],{[constants_1[_0x5213bd(0x17a)]+_0x5213bd(0x19f)]:_0x303d8e,[constants_1['FLOSUM_NAMESPACE']+_0x5213bd(0x191)]:_0xa258ce});return _0x587e27;}async[a234_0x397339(0x187)](_0x3c0281,_0x45d134){const _0x23c326=a234_0x397339,_0x587880={},_0x189604=zip_1['Zip'][_0x23c326(0x145)]();for(const _0x2771f9 of Object['keys'](_0x3c0281[_0x23c326(0x14e)])){_0x189604[_0x23c326(0x179)](_0x2771f9,_0x3c0281[_0x23c326(0x14e)][_0x2771f9],{'createFolders':!![]});}return _0x587880[_0x23c326(0x17b)]=_0x23c326(0x18a),_0x587880[_0x23c326(0x189)]=_0x3c0281[_0x23c326(0x163)],_0x587880['Description']=_0x3c0281[_0x23c326(0x163)],_0x587880['ParentId']=_0x45d134,_0x587880[_0x23c326(0x185)]=await _0x189604['generateAsync']({'type':_0x23c326(0x1ab),'compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x587880;}[a234_0x397339(0x18c)](_0x30a699,_0x2774d3,_0x8677f8){const _0x53b862=a234_0x397339,_0x36adb6=new Date()[_0x53b862(0x190)](),_0x4ec42c={};return _0x4ec42c[constants_1[_0x53b862(0x17a)]+_0x53b862(0x17d)]=_0x2774d3,_0x4ec42c[constants_1[_0x53b862(0x17a)]+_0x53b862(0x196)]=_0x30a699[_0x53b862(0x18d)],_0x4ec42c[constants_1['FLOSUM_NAMESPACE']+_0x53b862(0x181)]=_0x36adb6,_0x4ec42c[constants_1[_0x53b862(0x17a)]+_0x53b862(0x149)]=this[_0x53b862(0x170)],_0x4ec42c[constants_1['FLOSUM_NAMESPACE']+_0x53b862(0x173)]=_0x8677f8?_0x8677f8+0x1:0x1,_0x4ec42c[constants_1[_0x53b862(0x1a2)]+_0x53b862(0x177)]=!![],_0x4ec42c;}['prepareComponentRecord'](_0x4fc98a,_0x267186){const _0x27c7ec=a234_0x397339;var _0x58ea65,_0xfea9c3;const _0x3263f1=new Date()[_0x27c7ec(0x190)](),_0x2f8c18={};return!_0x267186?(this[_0x27c7ec(0x14c)]?(_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x192)]=this[_0x27c7ec(0x14c)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x17c)]=_0x27c7ec(0x18b),_0x2f8c18[_0x27c7ec(0x159)]=(_0x58ea65=this[_0x27c7ec(0x1ad)][_0x27c7ec(0x15d)](_0x2bde21=>_0x2bde21[_0x27c7ec(0x18f)]===_0x27c7ec(0x18b)))===null||_0x58ea65===void 0x0?void 0x0:_0x58ea65['id']):(_0x2f8c18[constants_1['FLOSUM_NAMESPACE']+_0x27c7ec(0x15f)]=this[_0x27c7ec(0x184)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x17c)]=_0x27c7ec(0x19c),_0x2f8c18[_0x27c7ec(0x159)]=(_0xfea9c3=this[_0x27c7ec(0x1ad)][_0x27c7ec(0x15d)](_0x483c9c=>_0x483c9c[_0x27c7ec(0x18f)]==='Repository'))===null||_0xfea9c3===void 0x0?void 0x0:_0xfea9c3['id']),_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+'Version__c']=0x1):_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x173)]=_0x267186[_0x27c7ec(0x175)]+0x1,_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+'Component_Type__c']=_0x4fc98a[_0x27c7ec(0x163)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x164)]=_0x4fc98a['name'],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+'File_Name__c']=_0x4fc98a[_0x27c7ec(0x182)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+'Last_Updated_By__c']=this[_0x27c7ec(0x170)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+'Last_Modified_By__c']=this[_0x27c7ec(0x170)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+'Last_Modified_Date__c']=_0x3263f1,_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x188)]=_0x3263f1,_0x2f8c18[constants_1['FLOSUM_NAMESPACE']+_0x27c7ec(0x196)]=_0x4fc98a[_0x27c7ec(0x18d)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x1a7)]=_0x4fc98a[_0x27c7ec(0x17e)],_0x2f8c18[constants_1[_0x27c7ec(0x17a)]+_0x27c7ec(0x19a)]=_0x4fc98a[_0x27c7ec(0x153)],_0x2f8c18;}[a234_0x397339(0x1a3)](){const _0x4944cd=a234_0x397339;return this[_0x4944cd(0x155)];}async[a234_0x397339(0x1aa)](_0x7c8a90,_0x4381d8){const _0x3171dc=a234_0x397339,_0x4240c5=[];for(const _0x5a0622 of _0x7c8a90){const _0x3e5b2a=(0x0,composite_utils_1[_0x3171dc(0x183)])(constants_1[_0x3171dc(0x146)],this[_0x3171dc(0x17f)](_0x5a0622)),_0x4449c6=(0x0,composite_utils_1[_0x3171dc(0x183)])(constants_1[_0x3171dc(0x152)],this[_0x3171dc(0x18c)](_0x5a0622,'@{'+_0x3e5b2a[_0x3171dc(0x1a6)]+'.id}')),_0x43712d=(0x0,composite_utils_1[_0x3171dc(0x183)])(constants_1['FLOSUM_ATTACHMENT'],await this[_0x3171dc(0x187)](_0x5a0622,'@{'+_0x4449c6['reference']+'.id}'));this[_0x3171dc(0x166)](_0x3e5b2a[_0x3171dc(0x15a)][_0x3171dc(0x15b)],_0x3e5b2a[_0x3171dc(0x1a6)]),_0x4240c5[_0x3171dc(0x197)](_0x3e5b2a[_0x3171dc(0x15a)],_0x4449c6['request'],_0x43712d[_0x3171dc(0x15a)]),_0x4381d8&&_0x4240c5['push'](this[_0x3171dc(0x19d)](_0x4381d8,'@{'+_0x4449c6['reference']+_0x3171dc(0x156)));}return _0x4240c5;}async[a234_0x397339(0x157)](_0x5a4f4f,_0xaf13fb=''){const _0x2ef16a=a234_0x397339,_0x1dc911=[];for(const {component:_0x26622d,meta:_0xb965a6}of _0x5a4f4f){if(!_0xb965a6['id']){const _0x439713=this[_0x2ef16a(0x155)]['find'](_0x17b278=>_0x17b278['componentName']===_0x26622d[_0x2ef16a(0x18f)]&&_0x17b278[_0x2ef16a(0x16c)]===_0x26622d['type']);if(!_0x439713)throw new salesforce_error_1[(_0x2ef16a(0x1a8))](new Error('Could\x20not\x20proceed\x20component\x20'+_0x26622d['name']+'\x20['+_0x26622d[_0x2ef16a(0x163)]+_0x2ef16a(0x15e)));_0xb965a6['id']=_0x439713[_0x2ef16a(0x19b)];}const _0x22c758=(0x0,composite_utils_1[_0x2ef16a(0x169)])(constants_1[_0x2ef16a(0x146)],_0xb965a6['id'],this['prepareComponentRecord'](_0x26622d,_0xb965a6)),_0xf89551=(0x0,composite_utils_1[_0x2ef16a(0x183)])(constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x2ef16a(0x18c)](_0x26622d,_0xb965a6['id'],_0xb965a6['version'])),_0x5c51dd=(0x0,composite_utils_1[_0x2ef16a(0x183)])(constants_1[_0x2ef16a(0x147)],await this[_0x2ef16a(0x187)](_0x26622d,'@{'+_0xf89551[_0x2ef16a(0x1a6)]+_0x2ef16a(0x156)));this[_0x2ef16a(0x166)](_0x22c758[_0x2ef16a(0x15a)][_0x2ef16a(0x15b)],_0x22c758[_0x2ef16a(0x1a6)]),_0x1dc911[_0x2ef16a(0x197)](_0x22c758[_0x2ef16a(0x15a)],_0xf89551[_0x2ef16a(0x15a)],_0x5c51dd[_0x2ef16a(0x15a)]),_0xaf13fb&&_0x1dc911[_0x2ef16a(0x197)](this['prepareCommitManifest'](_0xaf13fb,'@{'+_0xf89551['reference']+'.id}'));}return _0x1dc911;}async[a234_0x397339(0x158)](_0x18a60f,_0x3723ee=![]){const _0x33461f=a234_0x397339,_0xf0100d={'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]},_0x55cd5a=[];for(const _0x6e8114 of _0x18a60f){if(_0x6e8114['id'])_0x55cd5a[_0x33461f(0x197)](_0x6e8114['id']);else{const _0x3fb9e5=this['proceededComponentsMeta'][_0x33461f(0x15d)](_0x8d2007=>_0x8d2007['componentName']===_0x6e8114[_0x33461f(0x18f)]&&_0x8d2007[_0x33461f(0x16c)]===_0x6e8114['type']);if(!_0x3fb9e5||!_0x3fb9e5[_0x33461f(0x19b)])continue;_0x55cd5a['push'](_0x3fb9e5[_0x33461f(0x19b)]);}}if(_0x3723ee){const _0x1abc41=await this[_0x33461f(0x198)][_0x33461f(0x176)](_0x55cd5a);_0xf0100d[_0x33461f(0x1a9)]=_0x1abc41['map'](_0x152b71=>(0x0,composite_utils_1[_0x33461f(0x15c)])(constants_1[_0x33461f(0x194)],_0x152b71)[_0x33461f(0x15a)]);}return _0xf0100d[_0x33461f(0x174)]=_0x55cd5a[_0x33461f(0x172)](_0x3219ce=>(0x0,composite_utils_1['createPatchRequest'])(constants_1[_0x33461f(0x146)],_0x3219ce,{[constants_1[_0x33461f(0x1a2)]+'Deletion_By_Agent__c']:!![]})[_0x33461f(0x15a)]),_0xf0100d[_0x33461f(0x199)]=_0x55cd5a['map'](_0x12f80a=>(0x0,composite_utils_1[_0x33461f(0x15c)])(constants_1[_0x33461f(0x146)],_0x12f80a)[_0x33461f(0x15a)]),_0xf0100d;}}function a234_0x138f(){const _0x5a295f=['8AznnKL','map','Version__c','componentsToUpdate','version','fetchCommitManifestsByComponentIds','Is_From_Agent__c','../errors/salesforce.error','file','FLOSUM_NAMESPACE','ContentType','Source__c','Component__c','vlocityComponentName','prepareComponentRecord','(((.+)+)+)+$','Changed_On__c','filePath','createPostRequest','repositoryId','Body','2370438kiajci','prepareComponentAttachmentRecord','Committed_On__c','Name','application/zip','Branch','prepareComponentHistoryRecord','crc','25HNueSC','name','toISOString','Component_History__c','Branch__c','__esModule','FLOSUM_COMMIT_MANIFEST','get','CRC32__c','push','gitSync','componentsToDelete','Vlocity_Component__c','componentId','Repository','prepareCommitManifest','1152QeuzAn','Commit__c','../../../../constants','__importDefault','FLOSUM_GIT_NAMESPACE','getProceededComponentsMeta','constructor','default','reference','Vlocity_Component_Name__c','SalesforceError','manifests','insert','base64','extractFieldsFromRecord','recordTypes','7eEYfQV','createZip','FLOSUM_COMPONENT','FLOSUM_ATTACHMENT','../utils/flosum-naming.utils','Changed_By__c','371221UzWuyT','toString','branchId','41000fzysCH','files','7432984ICjOSr','177652CgENez','typedi','FLOSUM_COMPONENT_HISTORY','isVlocityComponent','SalesforceGitSyncService','proceededComponentsMeta','.id}','update','delete','RecordTypeId','request','body','createDeleteRequest','find',']\x20-\x20meta\x20not\x20found','Repository__c','913SJxwuY','Logger','./salesforce-git-sync.service','type','Component_Name__c','7635726CKcnPd','proceedComponentMeta','12plwkbM','544fupnpe','createPatchRequest','search','Component_Type__c','componentType','../../../../core','../../parsers/utils/zip','../utils/composite.utils','username'];a234_0x138f=function(){return _0x5a295f;};return a234_0x138f();}exports['SalesforceComponentsManager']=SalesforceComponentsManager;