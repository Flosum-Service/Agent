function a226_0x32cf(_0x1be881,_0x52762d){const _0x28cd05=a226_0xd070();return a226_0x32cf=function(_0x5c4cbc,_0x96f939){_0x5c4cbc=_0x5c4cbc-0x132;let _0xd0705d=_0x28cd05[_0x5c4cbc];return _0xd0705d;},a226_0x32cf(_0x1be881,_0x52762d);}const a226_0x14bfd1=a226_0x32cf;(function(_0x44cd90,_0x228194){const _0x5ba2f5=a226_0x32cf,_0x4d424e=_0x44cd90();while(!![]){try{const _0x244ba9=-parseInt(_0x5ba2f5(0x147))/0x1+-parseInt(_0x5ba2f5(0x162))/0x2+-parseInt(_0x5ba2f5(0x133))/0x3+parseInt(_0x5ba2f5(0x14b))/0x4*(parseInt(_0x5ba2f5(0x157))/0x5)+-parseInt(_0x5ba2f5(0x13f))/0x6*(parseInt(_0x5ba2f5(0x14a))/0x7)+-parseInt(_0x5ba2f5(0x17b))/0x8+parseInt(_0x5ba2f5(0x158))/0x9;if(_0x244ba9===_0x228194)break;else _0x4d424e['push'](_0x4d424e['shift']());}catch(_0x32b600){_0x4d424e['push'](_0x4d424e['shift']());}}}(a226_0xd070,0xce071));function a226_0xd070(){const _0x58a346=['toString','4098342jiIkMu','prototype','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','writable','setAuthDetails','name','ERR_INVALID_SALESFORCE_TOKEN','../../../../constants','defineProperty','instance_url','salesforce','requestConfig','16350mSkUqj','then','data','axios','refresh_token','constructor','getOwnPropertyDescriptor','__createBinding','465168cumOIE','log','object','56GugpGD','60fZVkjm','tokenType','create\x20authorized\x20request\x20failed:\x20authorization\x20error','decorate','__importDefault','message','get','Error','__decorate','design:paramtypes','post','instanceUrl','247810EyCjbD','29564325XkvmBA','error','create','call','check\x20auth:\x20current\x20state\x20-\x20%s','accessToken','default','waitAuth','force\x20update\x20token','../../providers/providers.tokens','1194672tgJZKq','updateAccessToken','Active','/services/oauth2/token','authState','hasOwnProperty','SALESFORCE_API_VERSION','access_token','joinURL','../errors/invalid-refresh-token.error','__importStar','catch','__esModule','orgId','Service','Updating','apply','update\x20access\x20token','getAuthData','token_type','../../../shared/utils','configurable','typedi','UnauthorizedSalesforceError','logger','5872384hWJwZF','metadata','Logger','Idle','AuthState','update\x20access\x20token\x20failed:\x20%s','length','search','__setModuleDefault','SalesforceAuthService','AUTH_WAIT_TIME'];a226_0xd070=function(){return _0x58a346;};return a226_0xd070();}const a226_0x96f939=(function(){let _0x208ccb=!![];return function(_0x4b2dcb,_0x31db7a){const _0x3bb3a8=_0x208ccb?function(){const _0x3e3c73=a226_0x32cf;if(_0x31db7a){const _0x495b85=_0x31db7a[_0x3e3c73(0x172)](_0x4b2dcb,arguments);return _0x31db7a=null,_0x495b85;}}:function(){};return _0x208ccb=![],_0x3bb3a8;};}()),a226_0x5c4cbc=a226_0x96f939(this,function(){const _0xcafdb=a226_0x32cf;return a226_0x5c4cbc[_0xcafdb(0x132)]()[_0xcafdb(0x182)]('(((.+)+)+)+$')[_0xcafdb(0x132)]()[_0xcafdb(0x144)](a226_0x5c4cbc)['search']('(((.+)+)+)+$');});a226_0x5c4cbc();'use strict';var __createBinding=this&&this[a226_0x14bfd1(0x146)]||(Object[a226_0x14bfd1(0x15a)]?function(_0x2c824e,_0x1e3e25,_0x29ff3a,_0x1efb01){const _0x52b81a=a226_0x14bfd1;if(_0x1efb01===undefined)_0x1efb01=_0x29ff3a;var _0xd96363=Object['getOwnPropertyDescriptor'](_0x1e3e25,_0x29ff3a);(!_0xd96363||('get'in _0xd96363?!_0x1e3e25[_0x52b81a(0x16e)]:_0xd96363[_0x52b81a(0x136)]||_0xd96363[_0x52b81a(0x177)]))&&(_0xd96363={'enumerable':!![],'get':function(){return _0x1e3e25[_0x29ff3a];}}),Object[_0x52b81a(0x13b)](_0x2c824e,_0x1efb01,_0xd96363);}:function(_0xee93cc,_0x4d21cc,_0x435be5,_0x3b5b2d){if(_0x3b5b2d===undefined)_0x3b5b2d=_0x435be5;_0xee93cc[_0x3b5b2d]=_0x4d21cc[_0x435be5];}),__setModuleDefault=this&&this[a226_0x14bfd1(0x183)]||(Object['create']?function(_0x55b8be,_0x438de7){const _0x3c69fd=a226_0x14bfd1;Object[_0x3c69fd(0x13b)](_0x55b8be,_0x3c69fd(0x15e),{'enumerable':!![],'value':_0x438de7});}:function(_0x91bd63,_0x27d649){const _0x8c0f84=a226_0x14bfd1;_0x91bd63[_0x8c0f84(0x15e)]=_0x27d649;}),__decorate=this&&this[a226_0x14bfd1(0x153)]||function(_0x3017bf,_0x2d6c16,_0x2d28ec,_0x4bbf50){const _0x4a7d2b=a226_0x14bfd1;var _0x297e8c=arguments[_0x4a7d2b(0x181)],_0x234f43=_0x297e8c<0x3?_0x2d6c16:_0x4bbf50===null?_0x4bbf50=Object[_0x4a7d2b(0x145)](_0x2d6c16,_0x2d28ec):_0x4bbf50,_0x45c298;if(typeof Reflect===_0x4a7d2b(0x149)&&typeof Reflect[_0x4a7d2b(0x14e)]==='function')_0x234f43=Reflect[_0x4a7d2b(0x14e)](_0x3017bf,_0x2d6c16,_0x2d28ec,_0x4bbf50);else{for(var _0x49181b=_0x3017bf['length']-0x1;_0x49181b>=0x0;_0x49181b--)if(_0x45c298=_0x3017bf[_0x49181b])_0x234f43=(_0x297e8c<0x3?_0x45c298(_0x234f43):_0x297e8c>0x3?_0x45c298(_0x2d6c16,_0x2d28ec,_0x234f43):_0x45c298(_0x2d6c16,_0x2d28ec))||_0x234f43;}return _0x297e8c>0x3&&_0x234f43&&Object[_0x4a7d2b(0x13b)](_0x2d6c16,_0x2d28ec,_0x234f43),_0x234f43;},__importStar=this&&this[a226_0x14bfd1(0x16c)]||function(_0x425bf6){const _0x49af3a=a226_0x14bfd1;if(_0x425bf6&&_0x425bf6[_0x49af3a(0x16e)])return _0x425bf6;var _0x4d125e={};if(_0x425bf6!=null){for(var _0x4b8648 in _0x425bf6)if(_0x4b8648!==_0x49af3a(0x15e)&&Object[_0x49af3a(0x134)][_0x49af3a(0x167)][_0x49af3a(0x15b)](_0x425bf6,_0x4b8648))__createBinding(_0x4d125e,_0x425bf6,_0x4b8648);}return __setModuleDefault(_0x4d125e,_0x425bf6),_0x4d125e;},__metadata=this&&this['__metadata']||function(_0x41f4b1,_0x4951b1){const _0x17ebbc=a226_0x14bfd1;if(typeof Reflect===_0x17ebbc(0x149)&&typeof Reflect[_0x17ebbc(0x17c)]==='function')return Reflect[_0x17ebbc(0x17c)](_0x41f4b1,_0x4951b1);},__importDefault=this&&this[a226_0x14bfd1(0x14f)]||function(_0x14e816){const _0x135f2d=a226_0x14bfd1;return _0x14e816&&_0x14e816[_0x135f2d(0x16e)]?_0x14e816:{'default':_0x14e816};},SalesforceAuthService_1;Object['defineProperty'](exports,a226_0x14bfd1(0x16e),{'value':!![]}),exports[a226_0x14bfd1(0x184)]=void 0x0;const typedi_1=__importStar(require(a226_0x14bfd1(0x178))),errors_1=require('../../../../constants/errors'),core_1=require('../../../../core'),axios_1=__importDefault(require(a226_0x14bfd1(0x142))),utils_1=require(a226_0x14bfd1(0x176)),invalid_refresh_token_error_1=require(a226_0x14bfd1(0x16b)),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a226_0x14bfd1(0x13a)),providers_tokens_1=require(a226_0x14bfd1(0x161));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x11f860=a226_0x14bfd1;this[_0x11f860(0x185)]=0x1388,this['authState']=auth_state_enum_1[_0x11f860(0x17f)][_0x11f860(0x17e)],this[_0x11f860(0x17a)]=new core_1[(_0x11f860(0x17d))](SalesforceAuthService_1[_0x11f860(0x138)]),this[_0x11f860(0x137)]();}async[a226_0x14bfd1(0x137)](){const _0x3c2883=a226_0x14bfd1;this[_0x3c2883(0x17a)][_0x3c2883(0x148)](_0x3c2883(0x15c),auth_state_enum_1[_0x3c2883(0x17f)][this[_0x3c2883(0x166)]]);try{if(this[_0x3c2883(0x166)]===auth_state_enum_1[_0x3c2883(0x17f)][_0x3c2883(0x152)])return;if(this[_0x3c2883(0x166)]===auth_state_enum_1[_0x3c2883(0x17f)][_0x3c2883(0x17e)])await this[_0x3c2883(0x163)]();else{const _0xd92c15=await this[_0x3c2883(0x13e)](),_0x29e27b=await axios_1[_0x3c2883(0x15e)]['get']('services/data/'+constants_1[_0x3c2883(0x168)],_0xd92c15)[_0x3c2883(0x140)](()=>!![])[_0x3c2883(0x16d)](()=>![]);!_0x29e27b&&await this[_0x3c2883(0x163)]();}}catch(_0x4f1ac3){}}async[a226_0x14bfd1(0x163)](){const _0x25e816=a226_0x14bfd1;var _0x23099f,_0x2f61c8,_0x38d778;this[_0x25e816(0x17a)][_0x25e816(0x148)](_0x25e816(0x173));try{this[_0x25e816(0x166)]=auth_state_enum_1[_0x25e816(0x17f)]['Updating'];const {refreshToken:_0x2a7746,clientId:_0x36b2db,clientSecret:_0x44b6ea,loginUrl:_0x4f676e}=typedi_1[_0x25e816(0x15e)][_0x25e816(0x151)](providers_tokens_1['Tokens'][_0x25e816(0x13d)]),{data:_0x20d745}=await axios_1[_0x25e816(0x15e)][_0x25e816(0x155)]((0x0,utils_1[_0x25e816(0x16a)])(_0x4f676e,_0x25e816(0x165)),null,{'params':{'grant_type':_0x25e816(0x143),'refresh_token':_0x2a7746,'client_id':_0x36b2db,'client_secret':_0x44b6ea}});this[_0x25e816(0x156)]=_0x20d745[_0x25e816(0x13c)],this['accessToken']=_0x20d745[_0x25e816(0x169)],this[_0x25e816(0x14c)]=_0x20d745[_0x25e816(0x175)],this[_0x25e816(0x166)]=auth_state_enum_1[_0x25e816(0x17f)][_0x25e816(0x164)],this['logger'][_0x25e816(0x148)]('access\x20token\x20updated\x20for\x20%s',this[_0x25e816(0x156)]);}catch(_0x1ca41b){const _0x1e305a=((_0x2f61c8=(_0x23099f=_0x1ca41b===null||_0x1ca41b===void 0x0?void 0x0:_0x1ca41b['response'])===null||_0x23099f===void 0x0?void 0x0:_0x23099f['data'])===null||_0x2f61c8===void 0x0?void 0x0:_0x2f61c8[_0x25e816(0x159)])||((_0x38d778=_0x1ca41b===null||_0x1ca41b===void 0x0?void 0x0:_0x1ca41b['response'])===null||_0x38d778===void 0x0?void 0x0:_0x38d778[_0x25e816(0x141)])||_0x1ca41b[_0x25e816(0x150)];this[_0x25e816(0x17a)]['error'](_0x25e816(0x180),_0x1e305a),this[_0x25e816(0x166)]=auth_state_enum_1[_0x25e816(0x17f)][_0x25e816(0x152)];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x25e816(0x139)]);}}async['forceUpdateToken'](){const _0xf2d0b9=a226_0x14bfd1;this['logger'][_0xf2d0b9(0x148)](_0xf2d0b9(0x160));if(this[_0xf2d0b9(0x166)]===auth_state_enum_1['AuthState'][_0xf2d0b9(0x171)]||this[_0xf2d0b9(0x166)]===auth_state_enum_1[_0xf2d0b9(0x17f)]['Idle'])return await(0x0,utils_1['sleep'])(this[_0xf2d0b9(0x185)]),this['forceUpdateToken']();if(this[_0xf2d0b9(0x166)]===auth_state_enum_1[_0xf2d0b9(0x17f)][_0xf2d0b9(0x152)])throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0xf2d0b9(0x139)]);await this[_0xf2d0b9(0x163)]();}async['waitAuth'](){const _0xf1a20b=a226_0x14bfd1;if(this['authState']===auth_state_enum_1['AuthState'][_0xf1a20b(0x152)]){this[_0xf1a20b(0x17a)][_0xf1a20b(0x148)](_0xf1a20b(0x14d));throw new unauthorized_salesforce_error_1[(_0xf1a20b(0x179))]();}if(this[_0xf1a20b(0x166)]!==auth_state_enum_1[_0xf1a20b(0x17f)][_0xf1a20b(0x164)])return this[_0xf1a20b(0x17a)][_0xf1a20b(0x148)](_0xf1a20b(0x135)),await(0x0,utils_1['sleep'])(this['AUTH_WAIT_TIME']),this[_0xf1a20b(0x15f)]();}[a226_0x14bfd1(0x174)](){const _0x5a4d97=a226_0x14bfd1;return{'orgId':this[_0x5a4d97(0x16f)],'accessToken':this[_0x5a4d97(0x15d)],'instanceUrl':this[_0x5a4d97(0x156)]};}async[a226_0x14bfd1(0x13e)](){const _0xb4f442=a226_0x14bfd1;return await this[_0xb4f442(0x15f)](),{'baseURL':this[_0xb4f442(0x156)],'headers':{'accept':'application/json','authorization':this['tokenType']+'\x20'+this[_0xb4f442(0x15d)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a226_0x14bfd1(0x170)])(),__metadata(a226_0x14bfd1(0x154),[])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;