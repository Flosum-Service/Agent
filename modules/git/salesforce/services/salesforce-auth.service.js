const a232_0x539aa4=a232_0x3d6d;(function(_0x48fb12,_0x3321c4){const _0x5c7dc6=a232_0x3d6d,_0xb76c17=_0x48fb12();while(!![]){try{const _0x57b66a=parseInt(_0x5c7dc6(0x73))/0x1+parseInt(_0x5c7dc6(0x78))/0x2+parseInt(_0x5c7dc6(0xa1))/0x3*(-parseInt(_0x5c7dc6(0x6b))/0x4)+parseInt(_0x5c7dc6(0x65))/0x5*(parseInt(_0x5c7dc6(0x70))/0x6)+-parseInt(_0x5c7dc6(0xa9))/0x7*(-parseInt(_0x5c7dc6(0x95))/0x8)+-parseInt(_0x5c7dc6(0xa8))/0x9*(parseInt(_0x5c7dc6(0xac))/0xa)+-parseInt(_0x5c7dc6(0xad))/0xb;if(_0x57b66a===_0x3321c4)break;else _0xb76c17['push'](_0xb76c17['shift']());}catch(_0x3626ca){_0xb76c17['push'](_0xb76c17['shift']());}}}(a232_0x16ec,0x9ce97));const a232_0x29c7a0=(function(){let _0xcc5e4a=!![];return function(_0xab7fe7,_0x986945){const _0x13bee4=_0xcc5e4a?function(){const _0x2a4d93=a232_0x3d6d;if(_0x986945){const _0x1e1726=_0x986945[_0x2a4d93(0x94)](_0xab7fe7,arguments);return _0x986945=null,_0x1e1726;}}:function(){};return _0xcc5e4a=![],_0x13bee4;};}()),a232_0x1347d8=a232_0x29c7a0(this,function(){const _0xae725a=a232_0x3d6d;return a232_0x1347d8[_0xae725a(0x9d)]()[_0xae725a(0x87)](_0xae725a(0x80))[_0xae725a(0x9d)]()[_0xae725a(0xb6)](a232_0x1347d8)[_0xae725a(0x87)](_0xae725a(0x80));});a232_0x1347d8();function a232_0x16ec(){const _0x7f5d03=['1797370EyqEGy','5993823wgeciM','function','Idle','decorate','access\x20token\x20updated\x20for\x20%s','getOwnPropertyDescriptor','response','accessToken','__importDefault','constructor','../../../../constants/errors','SalesforceAuthService','log','update\x20access\x20token\x20failed:\x20%s','design:paramtypes','../errors/invalid-refresh-token.error','logger','3845KUHnJL','../enums/auth-state.enum','/services/oauth2/token','../../../shared/utils','length','Updating','287976sFVncK','defineProperty','catch','__createBinding','prototype','8202TsMAXO','__metadata','writable','202675VsUBRI','../errors/unauthorized-salesforce.error','create','refresh_token','AUTH_WAIT_TIME','407800enklar','application/json','setAuthDetails','object','Logger','SALESFORCE_API_VERSION','create\x20authorized\x20request\x20failed:\x20authorization\x20error','__setModuleDefault','(((.+)+)+)+$','requestConfig','tokenType','default','orgId','message','data','search','sleep','InvalidRefreshTokenError','waitAuth','../../../../constants','name','forceUpdateToken','then','ERR_INVALID_SALESFORCE_TOKEN','__decorate','UnauthorizedSalesforceError','updateAccessToken','error','apply','8cOSpjZ','update\x20access\x20token','call','Error','post','authState','force\x20update\x20token','typedi','toString','AuthState','Tokens','instance_url','3wtXHvn','axios','token_type','__esModule','get','metadata','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','27wDoDOn','2387077wmcdwf','../../providers/providers.tokens','../../../../core'];a232_0x16ec=function(){return _0x7f5d03;};return a232_0x16ec();}'use strict';var __createBinding=this&&this[a232_0x539aa4(0x6e)]||(Object[a232_0x539aa4(0x75)]?function(_0x185ece,_0x1c07bb,_0x21319a,_0x474985){const _0x4a0a95=a232_0x539aa4;if(_0x474985===undefined)_0x474985=_0x21319a;var _0x6dfeab=Object[_0x4a0a95(0xb2)](_0x1c07bb,_0x21319a);(!_0x6dfeab||(_0x4a0a95(0xa5)in _0x6dfeab?!_0x1c07bb[_0x4a0a95(0xa4)]:_0x6dfeab[_0x4a0a95(0x72)]||_0x6dfeab['configurable']))&&(_0x6dfeab={'enumerable':!![],'get':function(){return _0x1c07bb[_0x21319a];}}),Object[_0x4a0a95(0x6c)](_0x185ece,_0x474985,_0x6dfeab);}:function(_0x55a6fb,_0x562693,_0x42bfe8,_0x4d45e7){if(_0x4d45e7===undefined)_0x4d45e7=_0x42bfe8;_0x55a6fb[_0x4d45e7]=_0x562693[_0x42bfe8];}),__setModuleDefault=this&&this[a232_0x539aa4(0x7f)]||(Object[a232_0x539aa4(0x75)]?function(_0x14193c,_0xad754c){Object['defineProperty'](_0x14193c,'default',{'enumerable':!![],'value':_0xad754c});}:function(_0x3673ae,_0x90c9b4){const _0x54f79b=a232_0x539aa4;_0x3673ae[_0x54f79b(0x83)]=_0x90c9b4;}),__decorate=this&&this[a232_0x539aa4(0x90)]||function(_0x4f4277,_0x2c8c1b,_0x20dcee,_0x213e62){const _0x5b68ea=a232_0x539aa4;var _0x3bbbec=arguments['length'],_0x1ebe10=_0x3bbbec<0x3?_0x2c8c1b:_0x213e62===null?_0x213e62=Object[_0x5b68ea(0xb2)](_0x2c8c1b,_0x20dcee):_0x213e62,_0x419a7c;if(typeof Reflect===_0x5b68ea(0x7b)&&typeof Reflect['decorate']===_0x5b68ea(0xae))_0x1ebe10=Reflect[_0x5b68ea(0xb0)](_0x4f4277,_0x2c8c1b,_0x20dcee,_0x213e62);else{for(var _0x31315a=_0x4f4277[_0x5b68ea(0x69)]-0x1;_0x31315a>=0x0;_0x31315a--)if(_0x419a7c=_0x4f4277[_0x31315a])_0x1ebe10=(_0x3bbbec<0x3?_0x419a7c(_0x1ebe10):_0x3bbbec>0x3?_0x419a7c(_0x2c8c1b,_0x20dcee,_0x1ebe10):_0x419a7c(_0x2c8c1b,_0x20dcee))||_0x1ebe10;}return _0x3bbbec>0x3&&_0x1ebe10&&Object[_0x5b68ea(0x6c)](_0x2c8c1b,_0x20dcee,_0x1ebe10),_0x1ebe10;},__importStar=this&&this['__importStar']||function(_0x3a1491){const _0xb3ccbc=a232_0x539aa4;if(_0x3a1491&&_0x3a1491[_0xb3ccbc(0xa4)])return _0x3a1491;var _0x2cef51={};if(_0x3a1491!=null){for(var _0x1a4658 in _0x3a1491)if(_0x1a4658!==_0xb3ccbc(0x83)&&Object[_0xb3ccbc(0x6f)]['hasOwnProperty'][_0xb3ccbc(0x97)](_0x3a1491,_0x1a4658))__createBinding(_0x2cef51,_0x3a1491,_0x1a4658);}return __setModuleDefault(_0x2cef51,_0x3a1491),_0x2cef51;},__metadata=this&&this[a232_0x539aa4(0x71)]||function(_0x267a84,_0x6f4d7c){const _0x1f666a=a232_0x539aa4;if(typeof Reflect===_0x1f666a(0x7b)&&typeof Reflect[_0x1f666a(0xa6)]===_0x1f666a(0xae))return Reflect[_0x1f666a(0xa6)](_0x267a84,_0x6f4d7c);},__importDefault=this&&this[a232_0x539aa4(0xb5)]||function(_0x331507){const _0x13bdaa=a232_0x539aa4;return _0x331507&&_0x331507[_0x13bdaa(0xa4)]?_0x331507:{'default':_0x331507};},SalesforceAuthService_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=__importStar(require(a232_0x539aa4(0x9c))),errors_1=require(a232_0x539aa4(0xb7)),core_1=require(a232_0x539aa4(0xab)),axios_1=__importDefault(require(a232_0x539aa4(0xa2))),utils_1=require(a232_0x539aa4(0x68)),invalid_refresh_token_error_1=require(a232_0x539aa4(0xbc)),auth_state_enum_1=require(a232_0x539aa4(0x66)),unauthorized_salesforce_error_1=require(a232_0x539aa4(0x74)),constants_1=require(a232_0x539aa4(0x8b)),providers_tokens_1=require(a232_0x539aa4(0xaa));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x47a37e=a232_0x539aa4;this[_0x47a37e(0x77)]=0x1388,this['authState']=auth_state_enum_1[_0x47a37e(0x9e)][_0x47a37e(0xaf)],this[_0x47a37e(0x64)]=new core_1[(_0x47a37e(0x7c))](SalesforceAuthService_1[_0x47a37e(0x8c)]),this['setAuthDetails']();}async[a232_0x539aa4(0x7a)](){const _0x919635=a232_0x539aa4;this[_0x919635(0x64)][_0x919635(0xb9)]('check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1[_0x919635(0x9e)][this[_0x919635(0x9a)]]);try{if(this[_0x919635(0x9a)]===auth_state_enum_1[_0x919635(0x9e)][_0x919635(0x98)])return;if(this[_0x919635(0x9a)]===auth_state_enum_1[_0x919635(0x9e)][_0x919635(0xaf)])await this[_0x919635(0x92)]();else{const _0x19f522=await this[_0x919635(0x81)](),_0x2e3357=await axios_1[_0x919635(0x83)][_0x919635(0xa5)]('services/data/'+constants_1[_0x919635(0x7d)],_0x19f522)[_0x919635(0x8e)](()=>!![])[_0x919635(0x6d)](()=>![]);!_0x2e3357&&await this[_0x919635(0x92)]();}}catch(_0x5d8d1f){}}async[a232_0x539aa4(0x92)](){const _0x5d3309=a232_0x539aa4;var _0x1921f3,_0x22af3f,_0xe74d27;this[_0x5d3309(0x64)][_0x5d3309(0xb9)](_0x5d3309(0x96));try{this[_0x5d3309(0x9a)]=auth_state_enum_1[_0x5d3309(0x9e)][_0x5d3309(0x6a)];const {refreshToken:_0x13467a,clientId:_0x5389c4,clientSecret:_0x559cf6,loginUrl:_0x53959a}=typedi_1[_0x5d3309(0x83)]['get'](providers_tokens_1[_0x5d3309(0x9f)]['salesforce']),{data:_0x1f3a21}=await axios_1[_0x5d3309(0x83)][_0x5d3309(0x99)]((0x0,utils_1['joinURL'])(_0x53959a,_0x5d3309(0x67)),null,{'params':{'grant_type':_0x5d3309(0x76),'refresh_token':_0x13467a,'client_id':_0x5389c4,'client_secret':_0x559cf6}});this['instanceUrl']=_0x1f3a21[_0x5d3309(0xa0)],this[_0x5d3309(0xb4)]=_0x1f3a21['access_token'],this[_0x5d3309(0x82)]=_0x1f3a21[_0x5d3309(0xa3)],this['authState']=auth_state_enum_1[_0x5d3309(0x9e)]['Active'],this[_0x5d3309(0x64)]['log'](_0x5d3309(0xb1),this['instanceUrl']);}catch(_0x6fe9b0){const _0x50fd20=((_0x22af3f=(_0x1921f3=_0x6fe9b0===null||_0x6fe9b0===void 0x0?void 0x0:_0x6fe9b0[_0x5d3309(0xb3)])===null||_0x1921f3===void 0x0?void 0x0:_0x1921f3[_0x5d3309(0x86)])===null||_0x22af3f===void 0x0?void 0x0:_0x22af3f[_0x5d3309(0x93)])||((_0xe74d27=_0x6fe9b0===null||_0x6fe9b0===void 0x0?void 0x0:_0x6fe9b0['response'])===null||_0xe74d27===void 0x0?void 0x0:_0xe74d27[_0x5d3309(0x86)])||_0x6fe9b0[_0x5d3309(0x85)];this[_0x5d3309(0x64)][_0x5d3309(0x93)](_0x5d3309(0xba),_0x50fd20),this['authState']=auth_state_enum_1[_0x5d3309(0x9e)][_0x5d3309(0x98)];throw new invalid_refresh_token_error_1[(_0x5d3309(0x89))](errors_1[_0x5d3309(0x8f)]);}}async[a232_0x539aa4(0x8d)](){const _0xf06833=a232_0x539aa4;this[_0xf06833(0x64)][_0xf06833(0xb9)](_0xf06833(0x9b));if(this[_0xf06833(0x9a)]===auth_state_enum_1[_0xf06833(0x9e)][_0xf06833(0x6a)]||this[_0xf06833(0x9a)]===auth_state_enum_1[_0xf06833(0x9e)][_0xf06833(0xaf)])return await(0x0,utils_1[_0xf06833(0x88)])(this['AUTH_WAIT_TIME']),this[_0xf06833(0x8d)]();if(this[_0xf06833(0x9a)]===auth_state_enum_1[_0xf06833(0x9e)][_0xf06833(0x98)])throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0xf06833(0x92)]();}async[a232_0x539aa4(0x8a)](){const _0x23609b=a232_0x539aa4;if(this['authState']===auth_state_enum_1[_0x23609b(0x9e)][_0x23609b(0x98)]){this[_0x23609b(0x64)][_0x23609b(0xb9)](_0x23609b(0x7e));throw new unauthorized_salesforce_error_1[(_0x23609b(0x91))]();}if(this[_0x23609b(0x9a)]!==auth_state_enum_1[_0x23609b(0x9e)]['Active'])return this['logger'][_0x23609b(0xb9)](_0x23609b(0xa7)),await(0x0,utils_1['sleep'])(this[_0x23609b(0x77)]),this[_0x23609b(0x8a)]();}['getAuthData'](){const _0x2d20d2=a232_0x539aa4;return{'orgId':this[_0x2d20d2(0x84)],'accessToken':this[_0x2d20d2(0xb4)],'instanceUrl':this['instanceUrl']};}async[a232_0x539aa4(0x81)](){const _0x40bbef=a232_0x539aa4;return await this[_0x40bbef(0x8a)](),{'baseURL':this['instanceUrl'],'headers':{'accept':_0x40bbef(0x79),'authorization':this['tokenType']+'\x20'+this[_0x40bbef(0xb4)]}};}};function a232_0x3d6d(_0x467fc6,_0x760c32){const _0x365c1f=a232_0x16ec();return a232_0x3d6d=function(_0x1347d8,_0x29c7a0){_0x1347d8=_0x1347d8-0x64;let _0x16ec41=_0x365c1f[_0x1347d8];return _0x16ec41;},a232_0x3d6d(_0x467fc6,_0x760c32);}SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a232_0x539aa4(0xbb),[])],SalesforceAuthService),exports[a232_0x539aa4(0xb8)]=SalesforceAuthService;