const a242_0x1ae2e1=a242_0x4b32;(function(_0x22e106,_0x1d0756){const _0x442325=a242_0x4b32,_0x4b9689=_0x22e106();while(!![]){try{const _0x114ddc=-parseInt(_0x442325(0xf3))/0x1*(parseInt(_0x442325(0xbe))/0x2)+-parseInt(_0x442325(0xfa))/0x3+parseInt(_0x442325(0xe1))/0x4+-parseInt(_0x442325(0xe0))/0x5+-parseInt(_0x442325(0xe7))/0x6+-parseInt(_0x442325(0xd6))/0x7+parseInt(_0x442325(0x108))/0x8*(parseInt(_0x442325(0xeb))/0x9);if(_0x114ddc===_0x1d0756)break;else _0x4b9689['push'](_0x4b9689['shift']());}catch(_0x2618bc){_0x4b9689['push'](_0x4b9689['shift']());}}}(a242_0x1040,0xc4dc1));const a242_0x463cec=(function(){let _0x254201=!![];return function(_0xf99d6c,_0x5dd6db){const _0x100168=_0x254201?function(){const _0x495942=a242_0x4b32;if(_0x5dd6db){const _0x26e6dd=_0x5dd6db[_0x495942(0xdb)](_0xf99d6c,arguments);return _0x5dd6db=null,_0x26e6dd;}}:function(){};return _0x254201=![],_0x100168;};}()),a242_0x332404=a242_0x463cec(this,function(){const _0x4d828c=a242_0x4b32;return a242_0x332404[_0x4d828c(0xf9)]()[_0x4d828c(0xe8)](_0x4d828c(0xdc))[_0x4d828c(0xf9)]()[_0x4d828c(0xfd)](a242_0x332404)[_0x4d828c(0xe8)]('(((.+)+)+)+$');});function a242_0x4b32(_0x4b0559,_0x572673){const _0x43a67e=a242_0x1040();return a242_0x4b32=function(_0x332404,_0x463cec){_0x332404=_0x332404-0xbd;let _0x10403c=_0x43a67e[_0x332404];return _0x10403c;},a242_0x4b32(_0x4b0559,_0x572673);}a242_0x332404();function a242_0x1040(){const _0x6989d6=['name','length','3018708kYEeLA','search','__decorate','Check\x20auth:\x20current\x20state\x20-\x20%s','9HHjKhe','AUTH_WAIT_TIME','__importStar','call','AuthState','../errors/invalid-refresh-token.error','function','object','12074FkEGQk','refresh_token','requestConfig','getOwnPropertyDescriptor','default','response','toString','3990948MQJeRj','joinURL','Logger','constructor','accessToken','../../providers/providers.tokens','data','waitAuth','Create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','InvalidRefreshTokenError','instanceUrl','Update\x20access\x20token','token_type','UnauthorizedSalesforceError','46056968nBaFau','axios','Update\x20access\x20token\x20failed:\x20%s','../../../../constants','create','defineProperty','68pTDSIn','../../../shared/utils','decorate','setAuthDetails','orgId','../errors/unauthorized-salesforce.error','updateAccessToken','Idle','authState','Service','__esModule','SALESFORCE_API_VERSION','Error','instance_url','Force\x20update\x20token','logger','get','getAuthData','post','ERR_INVALID_SALESFORCE_TOKEN','Updating','../enums/auth-state.enum','Tokens','/services/oauth2/token','10717952xYbcAi','SalesforceAuthService','salesforce','forceUpdateToken','tokenType','apply','(((.+)+)+)+$','services/data/','Active','error','6234570eXuAHa','284864uUFWey','log','sleep','application/json'];a242_0x1040=function(){return _0x6989d6;};return a242_0x1040();}'use strict';var __createBinding=this&&this['__createBinding']||(Object[a242_0x1ae2e1(0x10c)]?function(_0x4bf2c9,_0x4af291,_0x19957f,_0x18a4d5){const _0x1b30e5=a242_0x1ae2e1;if(_0x18a4d5===undefined)_0x18a4d5=_0x19957f;var _0x11c10a=Object[_0x1b30e5(0xf6)](_0x4af291,_0x19957f);(!_0x11c10a||('get'in _0x11c10a?!_0x4af291['__esModule']:_0x11c10a['writable']||_0x11c10a['configurable']))&&(_0x11c10a={'enumerable':!![],'get':function(){return _0x4af291[_0x19957f];}}),Object[_0x1b30e5(0xbd)](_0x4bf2c9,_0x18a4d5,_0x11c10a);}:function(_0x14c733,_0x3eb791,_0x127047,_0x5ddd1e){if(_0x5ddd1e===undefined)_0x5ddd1e=_0x127047;_0x14c733[_0x5ddd1e]=_0x3eb791[_0x127047];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a242_0x1ae2e1(0x10c)]?function(_0x228234,_0x3eb964){const _0x393fed=a242_0x1ae2e1;Object[_0x393fed(0xbd)](_0x228234,'default',{'enumerable':!![],'value':_0x3eb964});}:function(_0x70f761,_0x146865){const _0x33ab1e=a242_0x1ae2e1;_0x70f761[_0x33ab1e(0xf7)]=_0x146865;}),__decorate=this&&this[a242_0x1ae2e1(0xe9)]||function(_0x4c177c,_0xb31d4d,_0x41f63c,_0x38d49b){const _0x33cd98=a242_0x1ae2e1;var _0x506cc2=arguments['length'],_0x5542d9=_0x506cc2<0x3?_0xb31d4d:_0x38d49b===null?_0x38d49b=Object[_0x33cd98(0xf6)](_0xb31d4d,_0x41f63c):_0x38d49b,_0xad0613;if(typeof Reflect===_0x33cd98(0xf2)&&typeof Reflect[_0x33cd98(0xc0)]==='function')_0x5542d9=Reflect[_0x33cd98(0xc0)](_0x4c177c,_0xb31d4d,_0x41f63c,_0x38d49b);else{for(var _0xf3d0ab=_0x4c177c[_0x33cd98(0xe6)]-0x1;_0xf3d0ab>=0x0;_0xf3d0ab--)if(_0xad0613=_0x4c177c[_0xf3d0ab])_0x5542d9=(_0x506cc2<0x3?_0xad0613(_0x5542d9):_0x506cc2>0x3?_0xad0613(_0xb31d4d,_0x41f63c,_0x5542d9):_0xad0613(_0xb31d4d,_0x41f63c))||_0x5542d9;}return _0x506cc2>0x3&&_0x5542d9&&Object[_0x33cd98(0xbd)](_0xb31d4d,_0x41f63c,_0x5542d9),_0x5542d9;},__importStar=this&&this[a242_0x1ae2e1(0xed)]||function(_0x36ca0f){const _0x4a2464=a242_0x1ae2e1;if(_0x36ca0f&&_0x36ca0f[_0x4a2464(0xc8)])return _0x36ca0f;var _0x21183b={};if(_0x36ca0f!=null){for(var _0x3bf097 in _0x36ca0f)if(_0x3bf097!==_0x4a2464(0xf7)&&Object['prototype']['hasOwnProperty'][_0x4a2464(0xee)](_0x36ca0f,_0x3bf097))__createBinding(_0x21183b,_0x36ca0f,_0x3bf097);}return __setModuleDefault(_0x21183b,_0x36ca0f),_0x21183b;},__metadata=this&&this['__metadata']||function(_0x30551a,_0x48abc2){const _0x7287b=a242_0x1ae2e1;if(typeof Reflect===_0x7287b(0xf2)&&typeof Reflect['metadata']===_0x7287b(0xf1))return Reflect['metadata'](_0x30551a,_0x48abc2);},__importDefault=this&&this['__importDefault']||function(_0x36ec64){const _0x518a50=a242_0x1ae2e1;return _0x36ec64&&_0x36ec64[_0x518a50(0xc8)]?_0x36ec64:{'default':_0x36ec64};},SalesforceAuthService_1;Object[a242_0x1ae2e1(0xbd)](exports,a242_0x1ae2e1(0xc8),{'value':!![]}),exports[a242_0x1ae2e1(0xd7)]=void 0x0;const typedi_1=__importStar(require('typedi')),errors_1=require('../../../../constants/errors'),core_1=require('../../../../core'),axios_1=__importDefault(require(a242_0x1ae2e1(0x109))),utils_1=require(a242_0x1ae2e1(0xbf)),invalid_refresh_token_error_1=require(a242_0x1ae2e1(0xf0)),auth_state_enum_1=require(a242_0x1ae2e1(0xd3)),unauthorized_salesforce_error_1=require(a242_0x1ae2e1(0xc3)),constants_1=require(a242_0x1ae2e1(0x10b)),providers_tokens_1=require(a242_0x1ae2e1(0xff));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x1ba8e6=a242_0x1ae2e1;this[_0x1ba8e6(0xec)]=0x1388,this[_0x1ba8e6(0xc6)]=auth_state_enum_1['AuthState'][_0x1ba8e6(0xc5)],this[_0x1ba8e6(0xcd)]=new core_1[(_0x1ba8e6(0xfc))](SalesforceAuthService_1[_0x1ba8e6(0xe5)]),this['setAuthDetails']();}async[a242_0x1ae2e1(0xc1)](){const _0x3a27da=a242_0x1ae2e1;this[_0x3a27da(0xcd)][_0x3a27da(0xe2)](_0x3a27da(0xea),auth_state_enum_1[_0x3a27da(0xef)][this[_0x3a27da(0xc6)]]);try{if(this[_0x3a27da(0xc6)]===auth_state_enum_1[_0x3a27da(0xef)][_0x3a27da(0xca)])return;if(this[_0x3a27da(0xc6)]===auth_state_enum_1[_0x3a27da(0xef)][_0x3a27da(0xc5)])await this[_0x3a27da(0xc4)]();else{const _0x5518d8=await this[_0x3a27da(0xf5)](),_0x374623=await axios_1['default'][_0x3a27da(0xce)](_0x3a27da(0xdd)+constants_1[_0x3a27da(0xc9)],_0x5518d8)['then'](()=>!![])['catch'](()=>![]);!_0x374623&&await this[_0x3a27da(0xc4)]();}}catch(_0xcc2618){}}async[a242_0x1ae2e1(0xc4)](){const _0x4ecbbd=a242_0x1ae2e1;var _0x25d522,_0x3678d2,_0x341ebf;this[_0x4ecbbd(0xcd)][_0x4ecbbd(0xe2)](_0x4ecbbd(0x105));try{this['authState']=auth_state_enum_1[_0x4ecbbd(0xef)][_0x4ecbbd(0xd2)];const {refreshToken:_0x58edab,clientId:_0x57feea,clientSecret:_0x4719d5,loginUrl:_0x497962}=typedi_1[_0x4ecbbd(0xf7)][_0x4ecbbd(0xce)](providers_tokens_1[_0x4ecbbd(0xd4)][_0x4ecbbd(0xd8)]),{data:_0x1b5b40}=await axios_1[_0x4ecbbd(0xf7)][_0x4ecbbd(0xd0)]((0x0,utils_1[_0x4ecbbd(0xfb)])(_0x497962,_0x4ecbbd(0xd5)),null,{'params':{'grant_type':_0x4ecbbd(0xf4),'refresh_token':_0x58edab,'client_id':_0x57feea,'client_secret':_0x4719d5}});this[_0x4ecbbd(0x104)]=_0x1b5b40[_0x4ecbbd(0xcb)],this[_0x4ecbbd(0xfe)]=_0x1b5b40['access_token'],this[_0x4ecbbd(0xda)]=_0x1b5b40[_0x4ecbbd(0x106)],this[_0x4ecbbd(0xc6)]=auth_state_enum_1['AuthState'][_0x4ecbbd(0xde)],this[_0x4ecbbd(0xcd)][_0x4ecbbd(0xe2)]('Access\x20token\x20updated\x20for\x20%s',this['instanceUrl']);}catch(_0x1f1001){const _0x5dbcb3=((_0x3678d2=(_0x25d522=_0x1f1001===null||_0x1f1001===void 0x0?void 0x0:_0x1f1001[_0x4ecbbd(0xf8)])===null||_0x25d522===void 0x0?void 0x0:_0x25d522[_0x4ecbbd(0x100)])===null||_0x3678d2===void 0x0?void 0x0:_0x3678d2[_0x4ecbbd(0xdf)])||((_0x341ebf=_0x1f1001===null||_0x1f1001===void 0x0?void 0x0:_0x1f1001[_0x4ecbbd(0xf8)])===null||_0x341ebf===void 0x0?void 0x0:_0x341ebf[_0x4ecbbd(0x100)])||_0x1f1001['message'];this['logger'][_0x4ecbbd(0xdf)](_0x4ecbbd(0x10a),_0x5dbcb3),this[_0x4ecbbd(0xc6)]=auth_state_enum_1[_0x4ecbbd(0xef)]['Error'];throw new invalid_refresh_token_error_1[(_0x4ecbbd(0x103))](errors_1[_0x4ecbbd(0xd1)]);}}async[a242_0x1ae2e1(0xd9)](){const _0x4b9c3f=a242_0x1ae2e1;this['logger'][_0x4b9c3f(0xe2)](_0x4b9c3f(0xcc));if(this[_0x4b9c3f(0xc6)]===auth_state_enum_1[_0x4b9c3f(0xef)][_0x4b9c3f(0xd2)]||this['authState']===auth_state_enum_1[_0x4b9c3f(0xef)][_0x4b9c3f(0xc5)])return await(0x0,utils_1[_0x4b9c3f(0xe3)])(this[_0x4b9c3f(0xec)]),this['forceUpdateToken']();if(this[_0x4b9c3f(0xc6)]===auth_state_enum_1[_0x4b9c3f(0xef)][_0x4b9c3f(0xca)])throw new invalid_refresh_token_error_1[(_0x4b9c3f(0x103))](errors_1[_0x4b9c3f(0xd1)]);await this[_0x4b9c3f(0xc4)]();}async[a242_0x1ae2e1(0x101)](){const _0x3eaa03=a242_0x1ae2e1;if(this[_0x3eaa03(0xc6)]===auth_state_enum_1['AuthState'][_0x3eaa03(0xca)]){this[_0x3eaa03(0xcd)][_0x3eaa03(0xe2)]('Create\x20authorized\x20request\x20failed:\x20authorization\x20error');throw new unauthorized_salesforce_error_1[(_0x3eaa03(0x107))]();}if(this[_0x3eaa03(0xc6)]!==auth_state_enum_1[_0x3eaa03(0xef)][_0x3eaa03(0xde)])return this[_0x3eaa03(0xcd)][_0x3eaa03(0xe2)](_0x3eaa03(0x102)),await(0x0,utils_1[_0x3eaa03(0xe3)])(this['AUTH_WAIT_TIME']),this['waitAuth']();}[a242_0x1ae2e1(0xcf)](){const _0x128d5c=a242_0x1ae2e1;return{'orgId':this[_0x128d5c(0xc2)],'accessToken':this['accessToken'],'instanceUrl':this['instanceUrl']};}async[a242_0x1ae2e1(0xf5)](){const _0x32a0b7=a242_0x1ae2e1;return await this[_0x32a0b7(0x101)](),{'baseURL':this[_0x32a0b7(0x104)],'headers':{'accept':_0x32a0b7(0xe4),'authorization':this['tokenType']+'\x20'+this[_0x32a0b7(0xfe)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a242_0x1ae2e1(0xc7)])(),__metadata('design:paramtypes',[])],SalesforceAuthService),exports[a242_0x1ae2e1(0xd7)]=SalesforceAuthService;