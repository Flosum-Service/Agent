function a180_0x22cf(){const _0x2c1742=['1373592aFlUIL','12141rYVXqB','InvalidRefreshTokenError','accessToken','catch','update\x20access\x20token\x20failed:\x20%s','function','force\x20update\x20token','3197000xevaMo','log','updateAccessToken','decorate','Active','waitAuth','forceUpdateToken','UnauthorizedSalesforceError','50IiGREg','(((.+)+)+)+$','402924cjgRht','logger','AuthState','post','orgId','164ILxjvX','create','create\x20authorized\x20request\x20failed:\x20authorization\x20error','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','then','SalesforceAuthService','joinURL','response','Error','Idle','token_type','sleep','data','axios','get','setAuthDetails','error','name','__importDefault','9322434Kfvghl','defineProperty','typedi','192980dnYuob','design:paramtypes','access_token','../../providers/providers.tokens','ERR_INVALID_SALESFORCE_TOKEN','update\x20access\x20token','getAuthData','__createBinding','toString','AUTH_WAIT_TIME','constructor','object','authState','getOwnPropertyDescriptor','Service','check\x20auth:\x20current\x20state\x20-\x20%s','application/json','__esModule','2008XRRoyi','Logger','default','refresh_token','instance_url','../../../../core','prototype','../../../../constants/errors','requestConfig','apply','27672EgoSsn','../errors/invalid-refresh-token.error','SALESFORCE_API_VERSION','instanceUrl','search','../enums/auth-state.enum','length','tokenType','__metadata','Updating','metadata','7HbgdPB'];a180_0x22cf=function(){return _0x2c1742;};return a180_0x22cf();}const a180_0xbea794=a180_0xbf4e;(function(_0x4e896e,_0x5a8310){const _0x4e4b4a=a180_0xbf4e,_0x34c1fa=_0x4e896e();while(!![]){try{const _0x2a02cd=-parseInt(_0x4e4b4a(0xca))/0x1+parseInt(_0x4e4b4a(0xcf))/0x2*(parseInt(_0x4e4b4a(0x101))/0x3)+-parseInt(_0x4e4b4a(0xe5))/0x4*(-parseInt(_0x4e4b4a(0x11d))/0x5)+-parseInt(_0x4e4b4a(0x10d))/0x6*(parseInt(_0x4e4b4a(0x10c))/0x7)+parseInt(_0x4e4b4a(0xf7))/0x8*(parseInt(_0x4e4b4a(0x10e))/0x9)+parseInt(_0x4e4b4a(0x115))/0xa+-parseInt(_0x4e4b4a(0xe2))/0xb;if(_0x2a02cd===_0x5a8310)break;else _0x34c1fa['push'](_0x34c1fa['shift']());}catch(_0xf049c9){_0x34c1fa['push'](_0x34c1fa['shift']());}}}(a180_0x22cf,0x65fe7));const a180_0x2411f0=(function(){let _0x2bb4b1=!![];return function(_0x3a5614,_0x2d590b){const _0x3d0178=_0x2bb4b1?function(){const _0x181336=a180_0xbf4e;if(_0x2d590b){const _0x343577=_0x2d590b[_0x181336(0x100)](_0x3a5614,arguments);return _0x2d590b=null,_0x343577;}}:function(){};return _0x2bb4b1=![],_0x3d0178;};}()),a180_0x21480c=a180_0x2411f0(this,function(){const _0xecd71=a180_0xbf4e;return a180_0x21480c[_0xecd71(0xed)]()[_0xecd71(0x105)](_0xecd71(0x11e))['toString']()[_0xecd71(0xef)](a180_0x21480c)['search']('(((.+)+)+)+$');});a180_0x21480c();'use strict';function a180_0xbf4e(_0x4eed2e,_0xd73c27){const _0x362959=a180_0x22cf();return a180_0xbf4e=function(_0x21480c,_0x2411f0){_0x21480c=_0x21480c-0xca;let _0x22cfcf=_0x362959[_0x21480c];return _0x22cfcf;},a180_0xbf4e(_0x4eed2e,_0xd73c27);}var __createBinding=this&&this[a180_0xbea794(0xec)]||(Object['create']?function(_0x3e00c9,_0x2a042a,_0x337eac,_0x184c08){const _0x31b052=a180_0xbea794;if(_0x184c08===undefined)_0x184c08=_0x337eac;Object[_0x31b052(0xe3)](_0x3e00c9,_0x184c08,{'enumerable':!![],'get':function(){return _0x2a042a[_0x337eac];}});}:function(_0x4338e8,_0x3553a9,_0x1f5428,_0x5c1ef7){if(_0x5c1ef7===undefined)_0x5c1ef7=_0x1f5428;_0x4338e8[_0x5c1ef7]=_0x3553a9[_0x1f5428];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a180_0xbea794(0xd0)]?function(_0x3559db,_0x3e325b){const _0x4d11a3=a180_0xbea794;Object[_0x4d11a3(0xe3)](_0x3559db,_0x4d11a3(0xf9),{'enumerable':!![],'value':_0x3e325b});}:function(_0x48a268,_0x385b42){const _0xe51699=a180_0xbea794;_0x48a268[_0xe51699(0xf9)]=_0x385b42;}),__decorate=this&&this['__decorate']||function(_0xb4813c,_0x129159,_0x16c893,_0x6a37cd){const _0x5857a2=a180_0xbea794;var _0x1967de=arguments['length'],_0x3585d5=_0x1967de<0x3?_0x129159:_0x6a37cd===null?_0x6a37cd=Object[_0x5857a2(0xf2)](_0x129159,_0x16c893):_0x6a37cd,_0x28eb8b;if(typeof Reflect===_0x5857a2(0xf0)&&typeof Reflect[_0x5857a2(0x118)]===_0x5857a2(0x113))_0x3585d5=Reflect[_0x5857a2(0x118)](_0xb4813c,_0x129159,_0x16c893,_0x6a37cd);else{for(var _0x549d9e=_0xb4813c[_0x5857a2(0x107)]-0x1;_0x549d9e>=0x0;_0x549d9e--)if(_0x28eb8b=_0xb4813c[_0x549d9e])_0x3585d5=(_0x1967de<0x3?_0x28eb8b(_0x3585d5):_0x1967de>0x3?_0x28eb8b(_0x129159,_0x16c893,_0x3585d5):_0x28eb8b(_0x129159,_0x16c893))||_0x3585d5;}return _0x1967de>0x3&&_0x3585d5&&Object[_0x5857a2(0xe3)](_0x129159,_0x16c893,_0x3585d5),_0x3585d5;},__importStar=this&&this['__importStar']||function(_0x3e480e){const _0x1ce485=a180_0xbea794;if(_0x3e480e&&_0x3e480e['__esModule'])return _0x3e480e;var _0x332518={};if(_0x3e480e!=null){for(var _0x304de8 in _0x3e480e)if(_0x304de8!==_0x1ce485(0xf9)&&Object[_0x1ce485(0xfd)]['hasOwnProperty']['call'](_0x3e480e,_0x304de8))__createBinding(_0x332518,_0x3e480e,_0x304de8);}return __setModuleDefault(_0x332518,_0x3e480e),_0x332518;},__metadata=this&&this[a180_0xbea794(0x109)]||function(_0x3f39d1,_0x32532e){const _0x408582=a180_0xbea794;if(typeof Reflect===_0x408582(0xf0)&&typeof Reflect[_0x408582(0x10b)]===_0x408582(0x113))return Reflect[_0x408582(0x10b)](_0x3f39d1,_0x32532e);},__importDefault=this&&this[a180_0xbea794(0xe1)]||function(_0x33fea4){const _0x258d14=a180_0xbea794;return _0x33fea4&&_0x33fea4[_0x258d14(0xf6)]?_0x33fea4:{'default':_0x33fea4};},SalesforceAuthService_1;Object[a180_0xbea794(0xe3)](exports,a180_0xbea794(0xf6),{'value':!![]}),exports[a180_0xbea794(0xd4)]=void 0x0;const typedi_1=__importStar(require(a180_0xbea794(0xe4))),errors_1=require(a180_0xbea794(0xfe)),core_1=require(a180_0xbea794(0xfc)),axios_1=__importDefault(require(a180_0xbea794(0xdc))),utils_1=require('../../../shared/utils'),invalid_refresh_token_error_1=require(a180_0xbea794(0x102)),auth_state_enum_1=require(a180_0xbea794(0x106)),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require('../../../../constants'),providers_tokens_1=require(a180_0xbea794(0xe8));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x308d7c=a180_0xbea794;this[_0x308d7c(0xee)]=0x1388,this[_0x308d7c(0xf1)]=auth_state_enum_1[_0x308d7c(0xcc)][_0x308d7c(0xd8)],this[_0x308d7c(0xcb)]=new core_1[(_0x308d7c(0xf8))](SalesforceAuthService_1[_0x308d7c(0xe0)]),this[_0x308d7c(0xde)]();}async[a180_0xbea794(0xde)](){const _0x32ef98=a180_0xbea794;this[_0x32ef98(0xcb)][_0x32ef98(0x116)](_0x32ef98(0xf4),auth_state_enum_1[_0x32ef98(0xcc)][this[_0x32ef98(0xf1)]]);try{if(this[_0x32ef98(0xf1)]===auth_state_enum_1[_0x32ef98(0xcc)][_0x32ef98(0xd7)])return;if(this[_0x32ef98(0xf1)]===auth_state_enum_1['AuthState'][_0x32ef98(0xd8)])await this[_0x32ef98(0x117)]();else{const _0x18a7dd=await this[_0x32ef98(0xff)](),_0x5ab593=await axios_1[_0x32ef98(0xf9)][_0x32ef98(0xdd)]('services/data/'+constants_1[_0x32ef98(0x103)],_0x18a7dd)[_0x32ef98(0xd3)](()=>!![])[_0x32ef98(0x111)](()=>![]);!_0x5ab593&&await this[_0x32ef98(0x117)]();}}catch(_0x25c7d9){}}async[a180_0xbea794(0x117)](){const _0x49ee4d=a180_0xbea794;var _0xcfe5a9,_0x2035d1,_0x185368;this['logger']['log'](_0x49ee4d(0xea));try{this[_0x49ee4d(0xf1)]=auth_state_enum_1[_0x49ee4d(0xcc)][_0x49ee4d(0x10a)];const {refreshToken:_0x501765,clientId:_0x267fef,clientSecret:_0x351404,loginUrl:_0x5242bb}=typedi_1[_0x49ee4d(0xf9)]['get'](providers_tokens_1['Tokens']['salesforce']),{data:_0x4b17ba}=await axios_1[_0x49ee4d(0xf9)][_0x49ee4d(0xcd)](utils_1[_0x49ee4d(0xd5)](_0x5242bb,'/services/oauth2/token'),null,{'params':{'grant_type':_0x49ee4d(0xfa),'refresh_token':_0x501765,'client_id':_0x267fef,'client_secret':_0x351404}});this[_0x49ee4d(0x104)]=_0x4b17ba[_0x49ee4d(0xfb)],this[_0x49ee4d(0x110)]=_0x4b17ba[_0x49ee4d(0xe7)],this[_0x49ee4d(0x108)]=_0x4b17ba[_0x49ee4d(0xd9)],this[_0x49ee4d(0xf1)]=auth_state_enum_1['AuthState'][_0x49ee4d(0x119)],this[_0x49ee4d(0xcb)][_0x49ee4d(0x116)]('access\x20token\x20updated\x20for\x20%s',this[_0x49ee4d(0x104)]);}catch(_0x474fad){const _0x448604=((_0x2035d1=(_0xcfe5a9=_0x474fad===null||_0x474fad===void 0x0?void 0x0:_0x474fad['response'])===null||_0xcfe5a9===void 0x0?void 0x0:_0xcfe5a9[_0x49ee4d(0xdb)])===null||_0x2035d1===void 0x0?void 0x0:_0x2035d1['error'])||((_0x185368=_0x474fad===null||_0x474fad===void 0x0?void 0x0:_0x474fad[_0x49ee4d(0xd6)])===null||_0x185368===void 0x0?void 0x0:_0x185368[_0x49ee4d(0xdb)])||_0x474fad['message'];this[_0x49ee4d(0xcb)][_0x49ee4d(0xdf)](_0x49ee4d(0x112),_0x448604),this[_0x49ee4d(0xf1)]=auth_state_enum_1[_0x49ee4d(0xcc)][_0x49ee4d(0xd7)];throw new invalid_refresh_token_error_1[(_0x49ee4d(0x10f))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async[a180_0xbea794(0x11b)](){const _0x57029b=a180_0xbea794;this['logger'][_0x57029b(0x116)](_0x57029b(0x114));if(this[_0x57029b(0xf1)]===auth_state_enum_1[_0x57029b(0xcc)][_0x57029b(0x10a)]||this[_0x57029b(0xf1)]===auth_state_enum_1[_0x57029b(0xcc)][_0x57029b(0xd8)])return await utils_1[_0x57029b(0xda)](this['AUTH_WAIT_TIME']),this[_0x57029b(0x11b)]();if(this[_0x57029b(0xf1)]===auth_state_enum_1[_0x57029b(0xcc)][_0x57029b(0xd7)])throw new invalid_refresh_token_error_1[(_0x57029b(0x10f))](errors_1[_0x57029b(0xe9)]);await this[_0x57029b(0x117)]();}async['waitAuth'](){const _0x1c1fbb=a180_0xbea794;if(this[_0x1c1fbb(0xf1)]===auth_state_enum_1[_0x1c1fbb(0xcc)]['Error']){this[_0x1c1fbb(0xcb)][_0x1c1fbb(0x116)](_0x1c1fbb(0xd1));throw new unauthorized_salesforce_error_1[(_0x1c1fbb(0x11c))]();}if(this[_0x1c1fbb(0xf1)]!==auth_state_enum_1[_0x1c1fbb(0xcc)][_0x1c1fbb(0x119)])return this[_0x1c1fbb(0xcb)][_0x1c1fbb(0x116)](_0x1c1fbb(0xd2)),await utils_1[_0x1c1fbb(0xda)](this[_0x1c1fbb(0xee)]),this[_0x1c1fbb(0x11a)]();}[a180_0xbea794(0xeb)](){const _0x4a930f=a180_0xbea794;return{'orgId':this[_0x4a930f(0xce)],'accessToken':this[_0x4a930f(0x110)],'instanceUrl':this[_0x4a930f(0x104)]};}async[a180_0xbea794(0xff)](){const _0x1f3552=a180_0xbea794;return await this[_0x1f3552(0x11a)](),{'baseURL':this['instanceUrl'],'headers':{'accept':_0x1f3552(0xf5),'authorization':this[_0x1f3552(0x108)]+'\x20'+this[_0x1f3552(0x110)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1[a180_0xbea794(0xf3)](),__metadata(a180_0xbea794(0xe6),[])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;