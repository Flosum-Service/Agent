const a192_0x2a8833=a192_0x42d4;(function(_0x12e906,_0x2ac75a){const _0x311263=a192_0x42d4,_0x999999=_0x12e906();while(!![]){try{const _0x4336f3=parseInt(_0x311263(0xe6))/0x1+parseInt(_0x311263(0xd1))/0x2+-parseInt(_0x311263(0xd0))/0x3+-parseInt(_0x311263(0xc2))/0x4*(-parseInt(_0x311263(0x109))/0x5)+parseInt(_0x311263(0x113))/0x6+parseInt(_0x311263(0xf0))/0x7+-parseInt(_0x311263(0xe4))/0x8;if(_0x4336f3===_0x2ac75a)break;else _0x999999['push'](_0x999999['shift']());}catch(_0x574f7b){_0x999999['push'](_0x999999['shift']());}}}(a192_0x24d9,0x49bcf));function a192_0x24d9(){const _0x4ebc56=['instance_url','1697031jDYlZL','waitAuth','__setModuleDefault','log','__metadata','force\x20update\x20token','check\x20auth:\x20current\x20state\x20-\x20%s','update\x20access\x20token\x20failed:\x20%s','salesforce','requestConfig','search','function','__decorate','setAuthDetails','Updating','../../../shared/utils','call','ERR_INVALID_SALESFORCE_TOKEN','/services/oauth2/token','update\x20access\x20token','AUTH_WAIT_TIME','name','../../../../constants','AuthState','getOwnPropertyDescriptor','798190hxNDkA','logger','updateAccessToken','SalesforceAuthService','catch','create\x20authorized\x20request\x20failed:\x20authorization\x20error','typedi','constructor','access_token','__importDefault','1591464qSBskO','refresh_token','response','orgId','InvalidRefreshTokenError','12LMUBXP','authState','error','metadata','axios','../errors/unauthorized-salesforce.error','hasOwnProperty','defineProperty','data','sleep','default','token_type','then','Error','616272rKloiU','480324wXEitL','decorate','post','Logger','(((.+)+)+)+$','toString','length','../../../../constants/errors','create','tokenType','__createBinding','get','Service','__esModule','services/data/','__importStar','instanceUrl','accessToken','getAuthData','8071480azCdxg','apply','289637OzcdLS','access\x20token\x20updated\x20for\x20%s','design:paramtypes','writable','object','../enums/auth-state.enum','prototype','forceUpdateToken','../../../../core'];a192_0x24d9=function(){return _0x4ebc56;};return a192_0x24d9();}const a192_0x352f50=(function(){let _0x4702b3=!![];return function(_0x33e0ba,_0x30109d){const _0x14ed32=_0x4702b3?function(){const _0x1d7c04=a192_0x42d4;if(_0x30109d){const _0x17940d=_0x30109d[_0x1d7c04(0xe5)](_0x33e0ba,arguments);return _0x30109d=null,_0x17940d;}}:function(){};return _0x4702b3=![],_0x14ed32;};}()),a192_0x2c5816=a192_0x352f50(this,function(){const _0x176a53=a192_0x42d4;return a192_0x2c5816[_0x176a53(0xd6)]()[_0x176a53(0xfa)](_0x176a53(0xd5))[_0x176a53(0xd6)]()[_0x176a53(0x110)](a192_0x2c5816)[_0x176a53(0xfa)](_0x176a53(0xd5));});a192_0x2c5816();'use strict';var __createBinding=this&&this[a192_0x2a8833(0xdb)]||(Object['create']?function(_0x32123d,_0x3f72d7,_0x4c2a16,_0x34d19a){const _0xd962bc=a192_0x2a8833;if(_0x34d19a===undefined)_0x34d19a=_0x4c2a16;var _0x1b7af0=Object[_0xd962bc(0x108)](_0x3f72d7,_0x4c2a16);(!_0x1b7af0||('get'in _0x1b7af0?!_0x3f72d7['__esModule']:_0x1b7af0[_0xd962bc(0xe9)]||_0x1b7af0['configurable']))&&(_0x1b7af0={'enumerable':!![],'get':function(){return _0x3f72d7[_0x4c2a16];}}),Object[_0xd962bc(0xc9)](_0x32123d,_0x34d19a,_0x1b7af0);}:function(_0x5ba2b4,_0x31ba4a,_0x3db15e,_0x3acf58){if(_0x3acf58===undefined)_0x3acf58=_0x3db15e;_0x5ba2b4[_0x3acf58]=_0x31ba4a[_0x3db15e];}),__setModuleDefault=this&&this[a192_0x2a8833(0xf2)]||(Object[a192_0x2a8833(0xd9)]?function(_0x2d257f,_0x223aa3){const _0x54410d=a192_0x2a8833;Object[_0x54410d(0xc9)](_0x2d257f,'default',{'enumerable':!![],'value':_0x223aa3});}:function(_0x4808f5,_0x13a2f7){const _0x15f3bf=a192_0x2a8833;_0x4808f5[_0x15f3bf(0xcc)]=_0x13a2f7;}),__decorate=this&&this[a192_0x2a8833(0xfc)]||function(_0x476ff5,_0x2823db,_0x4ff72d,_0x3f9040){const _0x55140d=a192_0x2a8833;var _0x456473=arguments[_0x55140d(0xd7)],_0x9ee1b1=_0x456473<0x3?_0x2823db:_0x3f9040===null?_0x3f9040=Object[_0x55140d(0x108)](_0x2823db,_0x4ff72d):_0x3f9040,_0x4a132d;if(typeof Reflect===_0x55140d(0xea)&&typeof Reflect[_0x55140d(0xd2)]===_0x55140d(0xfb))_0x9ee1b1=Reflect[_0x55140d(0xd2)](_0x476ff5,_0x2823db,_0x4ff72d,_0x3f9040);else{for(var _0x21c3e8=_0x476ff5[_0x55140d(0xd7)]-0x1;_0x21c3e8>=0x0;_0x21c3e8--)if(_0x4a132d=_0x476ff5[_0x21c3e8])_0x9ee1b1=(_0x456473<0x3?_0x4a132d(_0x9ee1b1):_0x456473>0x3?_0x4a132d(_0x2823db,_0x4ff72d,_0x9ee1b1):_0x4a132d(_0x2823db,_0x4ff72d))||_0x9ee1b1;}return _0x456473>0x3&&_0x9ee1b1&&Object[_0x55140d(0xc9)](_0x2823db,_0x4ff72d,_0x9ee1b1),_0x9ee1b1;},__importStar=this&&this[a192_0x2a8833(0xe0)]||function(_0x277ef5){const _0x2bfbe9=a192_0x2a8833;if(_0x277ef5&&_0x277ef5[_0x2bfbe9(0xde)])return _0x277ef5;var _0x5da668={};if(_0x277ef5!=null){for(var _0x108d88 in _0x277ef5)if(_0x108d88!==_0x2bfbe9(0xcc)&&Object[_0x2bfbe9(0xec)][_0x2bfbe9(0xc8)][_0x2bfbe9(0x100)](_0x277ef5,_0x108d88))__createBinding(_0x5da668,_0x277ef5,_0x108d88);}return __setModuleDefault(_0x5da668,_0x277ef5),_0x5da668;},__metadata=this&&this[a192_0x2a8833(0xf4)]||function(_0x43c797,_0x41ba62){const _0x5c361a=a192_0x2a8833;if(typeof Reflect===_0x5c361a(0xea)&&typeof Reflect['metadata']===_0x5c361a(0xfb))return Reflect[_0x5c361a(0xc5)](_0x43c797,_0x41ba62);},__importDefault=this&&this[a192_0x2a8833(0x112)]||function(_0x19cd76){const _0x558a73=a192_0x2a8833;return _0x19cd76&&_0x19cd76[_0x558a73(0xde)]?_0x19cd76:{'default':_0x19cd76};},SalesforceAuthService_1;Object[a192_0x2a8833(0xc9)](exports,a192_0x2a8833(0xde),{'value':!![]}),exports[a192_0x2a8833(0x10c)]=void 0x0;function a192_0x42d4(_0x51b04b,_0x84cb12){const _0x561f57=a192_0x24d9();return a192_0x42d4=function(_0x2c5816,_0x352f50){_0x2c5816=_0x2c5816-0xbf;let _0x24d9c6=_0x561f57[_0x2c5816];return _0x24d9c6;},a192_0x42d4(_0x51b04b,_0x84cb12);}const typedi_1=__importStar(require(a192_0x2a8833(0x10f))),errors_1=require(a192_0x2a8833(0xd8)),core_1=require(a192_0x2a8833(0xee)),axios_1=__importDefault(require(a192_0x2a8833(0xc6))),utils_1=require(a192_0x2a8833(0xff)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require(a192_0x2a8833(0xeb)),unauthorized_salesforce_error_1=require(a192_0x2a8833(0xc7)),constants_1=require(a192_0x2a8833(0x106)),providers_tokens_1=require('../../providers/providers.tokens');let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x4bb3f3=a192_0x2a8833;this[_0x4bb3f3(0x104)]=0x1388,this[_0x4bb3f3(0xc3)]=auth_state_enum_1[_0x4bb3f3(0x107)]['Idle'],this[_0x4bb3f3(0x10a)]=new core_1[(_0x4bb3f3(0xd4))](SalesforceAuthService_1[_0x4bb3f3(0x105)]),this['setAuthDetails']();}async[a192_0x2a8833(0xfd)](){const _0x3fc372=a192_0x2a8833;this[_0x3fc372(0x10a)]['log'](_0x3fc372(0xf6),auth_state_enum_1[_0x3fc372(0x107)][this[_0x3fc372(0xc3)]]);try{if(this['authState']===auth_state_enum_1[_0x3fc372(0x107)][_0x3fc372(0xcf)])return;if(this[_0x3fc372(0xc3)]===auth_state_enum_1[_0x3fc372(0x107)]['Idle'])await this[_0x3fc372(0x10b)]();else{const _0x2be608=await this[_0x3fc372(0xf9)](),_0x5d0694=await axios_1['default']['get'](_0x3fc372(0xdf)+constants_1['SALESFORCE_API_VERSION'],_0x2be608)[_0x3fc372(0xce)](()=>!![])[_0x3fc372(0x10d)](()=>![]);!_0x5d0694&&await this[_0x3fc372(0x10b)]();}}catch(_0x2a031a){}}async[a192_0x2a8833(0x10b)](){const _0x25c994=a192_0x2a8833;var _0x4cc57b,_0x37bcca,_0x24b9a8;this[_0x25c994(0x10a)][_0x25c994(0xf3)](_0x25c994(0x103));try{this['authState']=auth_state_enum_1['AuthState'][_0x25c994(0xfe)];const {refreshToken:_0x5b1680,clientId:_0x423ea,clientSecret:_0x48a3f6,loginUrl:_0x45091b}=typedi_1['default'][_0x25c994(0xdc)](providers_tokens_1['Tokens'][_0x25c994(0xf8)]),{data:_0x2477ad}=await axios_1[_0x25c994(0xcc)][_0x25c994(0xd3)]((0x0,utils_1['joinURL'])(_0x45091b,_0x25c994(0x102)),null,{'params':{'grant_type':_0x25c994(0x114),'refresh_token':_0x5b1680,'client_id':_0x423ea,'client_secret':_0x48a3f6}});this['instanceUrl']=_0x2477ad[_0x25c994(0xef)],this[_0x25c994(0xe2)]=_0x2477ad[_0x25c994(0x111)],this['tokenType']=_0x2477ad[_0x25c994(0xcd)],this[_0x25c994(0xc3)]=auth_state_enum_1[_0x25c994(0x107)]['Active'],this['logger']['log'](_0x25c994(0xe7),this[_0x25c994(0xe1)]);}catch(_0x1081fe){const _0x569398=((_0x37bcca=(_0x4cc57b=_0x1081fe===null||_0x1081fe===void 0x0?void 0x0:_0x1081fe['response'])===null||_0x4cc57b===void 0x0?void 0x0:_0x4cc57b[_0x25c994(0xca)])===null||_0x37bcca===void 0x0?void 0x0:_0x37bcca[_0x25c994(0xc4)])||((_0x24b9a8=_0x1081fe===null||_0x1081fe===void 0x0?void 0x0:_0x1081fe[_0x25c994(0xbf)])===null||_0x24b9a8===void 0x0?void 0x0:_0x24b9a8[_0x25c994(0xca)])||_0x1081fe['message'];this[_0x25c994(0x10a)][_0x25c994(0xc4)](_0x25c994(0xf7),_0x569398),this[_0x25c994(0xc3)]=auth_state_enum_1[_0x25c994(0x107)]['Error'];throw new invalid_refresh_token_error_1[(_0x25c994(0xc1))](errors_1[_0x25c994(0x101)]);}}async['forceUpdateToken'](){const _0x200366=a192_0x2a8833;this[_0x200366(0x10a)]['log'](_0x200366(0xf5));if(this[_0x200366(0xc3)]===auth_state_enum_1[_0x200366(0x107)][_0x200366(0xfe)]||this[_0x200366(0xc3)]===auth_state_enum_1['AuthState']['Idle'])return await(0x0,utils_1['sleep'])(this[_0x200366(0x104)]),this[_0x200366(0xed)]();if(this['authState']===auth_state_enum_1[_0x200366(0x107)][_0x200366(0xcf)])throw new invalid_refresh_token_error_1[(_0x200366(0xc1))](errors_1[_0x200366(0x101)]);await this[_0x200366(0x10b)]();}async[a192_0x2a8833(0xf1)](){const _0x59120d=a192_0x2a8833;if(this[_0x59120d(0xc3)]===auth_state_enum_1[_0x59120d(0x107)][_0x59120d(0xcf)]){this[_0x59120d(0x10a)][_0x59120d(0xf3)](_0x59120d(0x10e));throw new unauthorized_salesforce_error_1['UnauthorizedSalesforceError']();}if(this[_0x59120d(0xc3)]!==auth_state_enum_1[_0x59120d(0x107)]['Active'])return this[_0x59120d(0x10a)][_0x59120d(0xf3)]('create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done'),await(0x0,utils_1[_0x59120d(0xcb)])(this[_0x59120d(0x104)]),this[_0x59120d(0xf1)]();}[a192_0x2a8833(0xe3)](){const _0xef6195=a192_0x2a8833;return{'orgId':this[_0xef6195(0xc0)],'accessToken':this[_0xef6195(0xe2)],'instanceUrl':this['instanceUrl']};}async['requestConfig'](){const _0x2ade4c=a192_0x2a8833;return await this[_0x2ade4c(0xf1)](),{'baseURL':this[_0x2ade4c(0xe1)],'headers':{'accept':'application/json','authorization':this[_0x2ade4c(0xda)]+'\x20'+this[_0x2ade4c(0xe2)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a192_0x2a8833(0xdd)])(),__metadata(a192_0x2a8833(0xe8),[])],SalesforceAuthService),exports[a192_0x2a8833(0x10c)]=SalesforceAuthService;