const a232_0x1fe724=a232_0x15ed;(function(_0x45eaf9,_0x1a952a){const _0x2b55b3=a232_0x15ed,_0x276315=_0x45eaf9();while(!![]){try{const _0x1e0b14=parseInt(_0x2b55b3(0x1ca))/0x1*(-parseInt(_0x2b55b3(0x1c8))/0x2)+parseInt(_0x2b55b3(0x1c5))/0x3*(-parseInt(_0x2b55b3(0x19d))/0x4)+parseInt(_0x2b55b3(0x1bd))/0x5+parseInt(_0x2b55b3(0x1e5))/0x6*(-parseInt(_0x2b55b3(0x1a4))/0x7)+parseInt(_0x2b55b3(0x1cb))/0x8*(-parseInt(_0x2b55b3(0x1b5))/0x9)+parseInt(_0x2b55b3(0x1dd))/0xa+parseInt(_0x2b55b3(0x1e7))/0xb*(parseInt(_0x2b55b3(0x1e0))/0xc);if(_0x1e0b14===_0x1a952a)break;else _0x276315['push'](_0x276315['shift']());}catch(_0x210299){_0x276315['push'](_0x276315['shift']());}}}(a232_0x5078,0xe1553));function a232_0x5078(){const _0x582316=['1176788hEwFAX','8SXNHiN','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','default','data','instanceUrl','prototype','log','design:paramtypes','waitAuth','create','InvalidRefreshTokenError','__importStar','AuthState','search','__setModuleDefault','__esModule','hasOwnProperty','UnauthorizedSalesforceError','6559480MLCBYH','AUTH_WAIT_TIME','post','4764ApHmdU','configurable','length','Updating','../../../shared/utils','137934XZoTKO','../../../../constants/errors','3311DIGpmV','access_token','authState','error','forceUpdateToken','updateAccessToken','message','name','(((.+)+)+)+$','then','orgId','172ZgPbzk','setAuthDetails','update\x20access\x20token\x20failed:\x20%s','services/data/','Error','__metadata','function','63PLSOsH','SalesforceAuthService','update\x20access\x20token','../../../../constants','force\x20update\x20token','writable','token_type','call','object','requestConfig','typedi','metadata','getAuthData','ERR_INVALID_SALESFORCE_TOKEN','decorate','constructor','defineProperty','1057356LYrQKr','getOwnPropertyDescriptor','Idle','../errors/invalid-refresh-token.error','logger','tokenType','response','Service','8989935pQoSIG','sleep','accessToken','Tokens','toString','get','access\x20token\x20updated\x20for\x20%s','../../../../core','10416omjRiJ','__decorate','salesforce','2FULGSD','../errors/unauthorized-salesforce.error'];a232_0x5078=function(){return _0x582316;};return a232_0x5078();}const a232_0x16dec8=(function(){let _0x8496fa=!![];return function(_0x30ade1,_0xca11ad){const _0x26f53d=_0x8496fa?function(){if(_0xca11ad){const _0x51f418=_0xca11ad['apply'](_0x30ade1,arguments);return _0xca11ad=null,_0x51f418;}}:function(){};return _0x8496fa=![],_0x26f53d;};}()),a232_0x566128=a232_0x16dec8(this,function(){const _0x348920=a232_0x15ed;return a232_0x566128[_0x348920(0x1c1)]()[_0x348920(0x1d8)](_0x348920(0x19a))[_0x348920(0x1c1)]()[_0x348920(0x1b3)](a232_0x566128)['search'](_0x348920(0x19a));});a232_0x566128();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a232_0x1fe724(0x1d4)]?function(_0x1dc62c,_0x33b9ae,_0x3933f8,_0x32cd3f){const _0x2bea82=a232_0x1fe724;if(_0x32cd3f===undefined)_0x32cd3f=_0x3933f8;var _0x25721a=Object[_0x2bea82(0x1b6)](_0x33b9ae,_0x3933f8);(!_0x25721a||(_0x2bea82(0x1c2)in _0x25721a?!_0x33b9ae[_0x2bea82(0x1da)]:_0x25721a[_0x2bea82(0x1a9)]||_0x25721a[_0x2bea82(0x1e1)]))&&(_0x25721a={'enumerable':!![],'get':function(){return _0x33b9ae[_0x3933f8];}}),Object[_0x2bea82(0x1b4)](_0x1dc62c,_0x32cd3f,_0x25721a);}:function(_0x3c4879,_0x1c5b49,_0x51c63a,_0x215e7d){if(_0x215e7d===undefined)_0x215e7d=_0x51c63a;_0x3c4879[_0x215e7d]=_0x1c5b49[_0x51c63a];}),__setModuleDefault=this&&this[a232_0x1fe724(0x1d9)]||(Object[a232_0x1fe724(0x1d4)]?function(_0x3e3d14,_0x4906c4){const _0x405a54=a232_0x1fe724;Object[_0x405a54(0x1b4)](_0x3e3d14,_0x405a54(0x1cd),{'enumerable':!![],'value':_0x4906c4});}:function(_0x46040e,_0x484cb8){_0x46040e['default']=_0x484cb8;}),__decorate=this&&this[a232_0x1fe724(0x1c6)]||function(_0xa89196,_0x4cec10,_0x31913b,_0x68edc2){const _0x21531a=a232_0x1fe724;var _0x1412f1=arguments['length'],_0xf1b7bf=_0x1412f1<0x3?_0x4cec10:_0x68edc2===null?_0x68edc2=Object[_0x21531a(0x1b6)](_0x4cec10,_0x31913b):_0x68edc2,_0x40e6d0;if(typeof Reflect===_0x21531a(0x1ac)&&typeof Reflect[_0x21531a(0x1b2)]==='function')_0xf1b7bf=Reflect['decorate'](_0xa89196,_0x4cec10,_0x31913b,_0x68edc2);else{for(var _0x26fcec=_0xa89196[_0x21531a(0x1e2)]-0x1;_0x26fcec>=0x0;_0x26fcec--)if(_0x40e6d0=_0xa89196[_0x26fcec])_0xf1b7bf=(_0x1412f1<0x3?_0x40e6d0(_0xf1b7bf):_0x1412f1>0x3?_0x40e6d0(_0x4cec10,_0x31913b,_0xf1b7bf):_0x40e6d0(_0x4cec10,_0x31913b))||_0xf1b7bf;}return _0x1412f1>0x3&&_0xf1b7bf&&Object[_0x21531a(0x1b4)](_0x4cec10,_0x31913b,_0xf1b7bf),_0xf1b7bf;},__importStar=this&&this[a232_0x1fe724(0x1d6)]||function(_0x2bf25a){const _0x2595f2=a232_0x1fe724;if(_0x2bf25a&&_0x2bf25a[_0x2595f2(0x1da)])return _0x2bf25a;var _0x1a2bed={};if(_0x2bf25a!=null){for(var _0x33ff05 in _0x2bf25a)if(_0x33ff05!==_0x2595f2(0x1cd)&&Object[_0x2595f2(0x1d0)][_0x2595f2(0x1db)][_0x2595f2(0x1ab)](_0x2bf25a,_0x33ff05))__createBinding(_0x1a2bed,_0x2bf25a,_0x33ff05);}return __setModuleDefault(_0x1a2bed,_0x2bf25a),_0x1a2bed;},__metadata=this&&this[a232_0x1fe724(0x1a2)]||function(_0x1f2c19,_0x1e7797){const _0x24478b=a232_0x1fe724;if(typeof Reflect===_0x24478b(0x1ac)&&typeof Reflect[_0x24478b(0x1af)]===_0x24478b(0x1a3))return Reflect[_0x24478b(0x1af)](_0x1f2c19,_0x1e7797);},__importDefault=this&&this['__importDefault']||function(_0x168ee4){const _0xc8ade6=a232_0x1fe724;return _0x168ee4&&_0x168ee4[_0xc8ade6(0x1da)]?_0x168ee4:{'default':_0x168ee4};},SalesforceAuthService_1;Object[a232_0x1fe724(0x1b4)](exports,a232_0x1fe724(0x1da),{'value':!![]}),exports[a232_0x1fe724(0x1a5)]=void 0x0;function a232_0x15ed(_0x5adda9,_0x16d451){const _0x3f1c97=a232_0x5078();return a232_0x15ed=function(_0x566128,_0x16dec8){_0x566128=_0x566128-0x196;let _0x507851=_0x3f1c97[_0x566128];return _0x507851;},a232_0x15ed(_0x5adda9,_0x16d451);}const typedi_1=__importStar(require(a232_0x1fe724(0x1ae))),errors_1=require(a232_0x1fe724(0x1e6)),core_1=require(a232_0x1fe724(0x1c4)),axios_1=__importDefault(require('axios')),utils_1=require(a232_0x1fe724(0x1e4)),invalid_refresh_token_error_1=require(a232_0x1fe724(0x1b8)),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require(a232_0x1fe724(0x1c9)),constants_1=require(a232_0x1fe724(0x1a7)),providers_tokens_1=require('../../providers/providers.tokens');let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x2808a8=a232_0x1fe724;this[_0x2808a8(0x1de)]=0x1388,this['authState']=auth_state_enum_1[_0x2808a8(0x1d7)]['Idle'],this[_0x2808a8(0x1b9)]=new core_1['Logger'](SalesforceAuthService_1[_0x2808a8(0x199)]),this[_0x2808a8(0x19e)]();}async[a232_0x1fe724(0x19e)](){const _0x666d3f=a232_0x1fe724;this[_0x666d3f(0x1b9)][_0x666d3f(0x1d1)]('check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1[_0x666d3f(0x1d7)][this[_0x666d3f(0x1e9)]]);try{if(this[_0x666d3f(0x1e9)]===auth_state_enum_1[_0x666d3f(0x1d7)][_0x666d3f(0x1a1)])return;if(this[_0x666d3f(0x1e9)]===auth_state_enum_1['AuthState'][_0x666d3f(0x1b7)])await this[_0x666d3f(0x197)]();else{const _0x546322=await this[_0x666d3f(0x1ad)](),_0x3de0ae=await axios_1['default']['get'](_0x666d3f(0x1a0)+constants_1['SALESFORCE_API_VERSION'],_0x546322)[_0x666d3f(0x19b)](()=>!![])['catch'](()=>![]);!_0x3de0ae&&await this[_0x666d3f(0x197)]();}}catch(_0x15d5b2){}}async[a232_0x1fe724(0x197)](){const _0x545dd6=a232_0x1fe724;var _0x47c6a0,_0xf75dac,_0x26d0d5;this['logger'][_0x545dd6(0x1d1)](_0x545dd6(0x1a6));try{this[_0x545dd6(0x1e9)]=auth_state_enum_1['AuthState'][_0x545dd6(0x1e3)];const {refreshToken:_0x17eaeb,clientId:_0x1f3d02,clientSecret:_0x1582cb,loginUrl:_0x5d3e0b}=typedi_1[_0x545dd6(0x1cd)][_0x545dd6(0x1c2)](providers_tokens_1[_0x545dd6(0x1c0)][_0x545dd6(0x1c7)]),{data:_0x518030}=await axios_1[_0x545dd6(0x1cd)][_0x545dd6(0x1df)]((0x0,utils_1['joinURL'])(_0x5d3e0b,'/services/oauth2/token'),null,{'params':{'grant_type':'refresh_token','refresh_token':_0x17eaeb,'client_id':_0x1f3d02,'client_secret':_0x1582cb}});this['instanceUrl']=_0x518030['instance_url'],this[_0x545dd6(0x1bf)]=_0x518030[_0x545dd6(0x1e8)],this[_0x545dd6(0x1ba)]=_0x518030[_0x545dd6(0x1aa)],this['authState']=auth_state_enum_1[_0x545dd6(0x1d7)]['Active'],this[_0x545dd6(0x1b9)][_0x545dd6(0x1d1)](_0x545dd6(0x1c3),this[_0x545dd6(0x1cf)]);}catch(_0xf130b4){const _0x4d38e3=((_0xf75dac=(_0x47c6a0=_0xf130b4===null||_0xf130b4===void 0x0?void 0x0:_0xf130b4[_0x545dd6(0x1bb)])===null||_0x47c6a0===void 0x0?void 0x0:_0x47c6a0[_0x545dd6(0x1ce)])===null||_0xf75dac===void 0x0?void 0x0:_0xf75dac['error'])||((_0x26d0d5=_0xf130b4===null||_0xf130b4===void 0x0?void 0x0:_0xf130b4[_0x545dd6(0x1bb)])===null||_0x26d0d5===void 0x0?void 0x0:_0x26d0d5['data'])||_0xf130b4[_0x545dd6(0x198)];this[_0x545dd6(0x1b9)][_0x545dd6(0x1ea)](_0x545dd6(0x19f),_0x4d38e3),this['authState']=auth_state_enum_1[_0x545dd6(0x1d7)][_0x545dd6(0x1a1)];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x545dd6(0x1b1)]);}}async[a232_0x1fe724(0x196)](){const _0x2a98d6=a232_0x1fe724;this[_0x2a98d6(0x1b9)][_0x2a98d6(0x1d1)](_0x2a98d6(0x1a8));if(this[_0x2a98d6(0x1e9)]===auth_state_enum_1[_0x2a98d6(0x1d7)][_0x2a98d6(0x1e3)]||this[_0x2a98d6(0x1e9)]===auth_state_enum_1['AuthState'][_0x2a98d6(0x1b7)])return await(0x0,utils_1[_0x2a98d6(0x1be)])(this[_0x2a98d6(0x1de)]),this[_0x2a98d6(0x196)]();if(this[_0x2a98d6(0x1e9)]===auth_state_enum_1[_0x2a98d6(0x1d7)][_0x2a98d6(0x1a1)])throw new invalid_refresh_token_error_1[(_0x2a98d6(0x1d5))](errors_1[_0x2a98d6(0x1b1)]);await this[_0x2a98d6(0x197)]();}async[a232_0x1fe724(0x1d3)](){const _0x33cf67=a232_0x1fe724;if(this['authState']===auth_state_enum_1['AuthState'][_0x33cf67(0x1a1)]){this[_0x33cf67(0x1b9)][_0x33cf67(0x1d1)]('create\x20authorized\x20request\x20failed:\x20authorization\x20error');throw new unauthorized_salesforce_error_1[(_0x33cf67(0x1dc))]();}if(this[_0x33cf67(0x1e9)]!==auth_state_enum_1[_0x33cf67(0x1d7)]['Active'])return this['logger'][_0x33cf67(0x1d1)](_0x33cf67(0x1cc)),await(0x0,utils_1['sleep'])(this['AUTH_WAIT_TIME']),this[_0x33cf67(0x1d3)]();}[a232_0x1fe724(0x1b0)](){const _0x29288f=a232_0x1fe724;return{'orgId':this[_0x29288f(0x19c)],'accessToken':this[_0x29288f(0x1bf)],'instanceUrl':this[_0x29288f(0x1cf)]};}async[a232_0x1fe724(0x1ad)](){const _0x58ce5e=a232_0x1fe724;return await this['waitAuth'](),{'baseURL':this['instanceUrl'],'headers':{'accept':'application/json','authorization':this[_0x58ce5e(0x1ba)]+'\x20'+this[_0x58ce5e(0x1bf)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a232_0x1fe724(0x1bc)])(),__metadata(a232_0x1fe724(0x1d2),[])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;