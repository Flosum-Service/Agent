function a269_0x4444(_0x12cc9f,_0x20fcff){const _0x14d8f6=a269_0x32fc();return a269_0x4444=function(_0x4892fd,_0x316737){_0x4892fd=_0x4892fd-0x1d8;let _0x32fc85=_0x14d8f6[_0x4892fd];return _0x32fc85;},a269_0x4444(_0x12cc9f,_0x20fcff);}const a269_0x37425b=a269_0x4444;(function(_0x5f4762,_0x3d246f){const _0x364a19=a269_0x4444,_0x32d68a=_0x5f4762();while(!![]){try{const _0x36736f=-parseInt(_0x364a19(0x217))/0x1+parseInt(_0x364a19(0x1eb))/0x2*(parseInt(_0x364a19(0x200))/0x3)+-parseInt(_0x364a19(0x1fd))/0x4*(parseInt(_0x364a19(0x1f1))/0x5)+parseInt(_0x364a19(0x212))/0x6+parseInt(_0x364a19(0x22d))/0x7*(-parseInt(_0x364a19(0x1ed))/0x8)+-parseInt(_0x364a19(0x210))/0x9+parseInt(_0x364a19(0x1fa))/0xa;if(_0x36736f===_0x3d246f)break;else _0x32d68a['push'](_0x32d68a['shift']());}catch(_0x15b92c){_0x32d68a['push'](_0x32d68a['shift']());}}}(a269_0x32fc,0xc33dc));const a269_0x316737=(function(){let _0x1185d5=!![];return function(_0x7783,_0x41ef90){const _0x2ab072=_0x1185d5?function(){const _0x5de10e=a269_0x4444;if(_0x41ef90){const _0x1db4fb=_0x41ef90[_0x5de10e(0x219)](_0x7783,arguments);return _0x41ef90=null,_0x1db4fb;}}:function(){};return _0x1185d5=![],_0x2ab072;};}()),a269_0x4892fd=a269_0x316737(this,function(){const _0x288c4a=a269_0x4444;return a269_0x4892fd[_0x288c4a(0x1e2)]()[_0x288c4a(0x218)](_0x288c4a(0x1e9))[_0x288c4a(0x1e2)]()[_0x288c4a(0x1e8)](a269_0x4892fd)[_0x288c4a(0x218)](_0x288c4a(0x1e9));});a269_0x4892fd();'use strict';var __createBinding=this&&this[a269_0x37425b(0x204)]||(Object[a269_0x37425b(0x20b)]?function(_0xc905a6,_0x40ffd3,_0x4d0f12,_0x62ab13){const _0x28ba47=a269_0x37425b;if(_0x62ab13===undefined)_0x62ab13=_0x4d0f12;var _0x42c4a4=Object[_0x28ba47(0x227)](_0x40ffd3,_0x4d0f12);(!_0x42c4a4||(_0x28ba47(0x229)in _0x42c4a4?!_0x40ffd3['__esModule']:_0x42c4a4['writable']||_0x42c4a4[_0x28ba47(0x1e0)]))&&(_0x42c4a4={'enumerable':!![],'get':function(){return _0x40ffd3[_0x4d0f12];}}),Object[_0x28ba47(0x1fc)](_0xc905a6,_0x62ab13,_0x42c4a4);}:function(_0x2f0044,_0x448012,_0x7688f7,_0xeff845){if(_0xeff845===undefined)_0xeff845=_0x7688f7;_0x2f0044[_0xeff845]=_0x448012[_0x7688f7];}),__setModuleDefault=this&&this[a269_0x37425b(0x21e)]||(Object[a269_0x37425b(0x20b)]?function(_0x5a3326,_0x4957dc){const _0x57a003=a269_0x37425b;Object[_0x57a003(0x1fc)](_0x5a3326,_0x57a003(0x226),{'enumerable':!![],'value':_0x4957dc});}:function(_0x5aaa82,_0x228a81){const _0x3182ca=a269_0x37425b;_0x5aaa82[_0x3182ca(0x226)]=_0x228a81;}),__decorate=this&&this['__decorate']||function(_0x345d21,_0x297ce4,_0x3ef45c,_0x4e48fc){const _0x5a3d6f=a269_0x37425b;var _0x322eff=arguments['length'],_0xccd6ba=_0x322eff<0x3?_0x297ce4:_0x4e48fc===null?_0x4e48fc=Object[_0x5a3d6f(0x227)](_0x297ce4,_0x3ef45c):_0x4e48fc,_0x13cf33;if(typeof Reflect===_0x5a3d6f(0x215)&&typeof Reflect[_0x5a3d6f(0x208)]===_0x5a3d6f(0x1ec))_0xccd6ba=Reflect[_0x5a3d6f(0x208)](_0x345d21,_0x297ce4,_0x3ef45c,_0x4e48fc);else{for(var _0x1352c3=_0x345d21[_0x5a3d6f(0x211)]-0x1;_0x1352c3>=0x0;_0x1352c3--)if(_0x13cf33=_0x345d21[_0x1352c3])_0xccd6ba=(_0x322eff<0x3?_0x13cf33(_0xccd6ba):_0x322eff>0x3?_0x13cf33(_0x297ce4,_0x3ef45c,_0xccd6ba):_0x13cf33(_0x297ce4,_0x3ef45c))||_0xccd6ba;}return _0x322eff>0x3&&_0xccd6ba&&Object[_0x5a3d6f(0x1fc)](_0x297ce4,_0x3ef45c,_0xccd6ba),_0xccd6ba;},__importStar=this&&this[a269_0x37425b(0x205)]||function(_0x49bfa7){const _0x184968=a269_0x37425b;if(_0x49bfa7&&_0x49bfa7[_0x184968(0x1e6)])return _0x49bfa7;var _0x52edc4={};if(_0x49bfa7!=null){for(var _0x2c671d in _0x49bfa7)if(_0x2c671d!=='default'&&Object['prototype']['hasOwnProperty'][_0x184968(0x1f4)](_0x49bfa7,_0x2c671d))__createBinding(_0x52edc4,_0x49bfa7,_0x2c671d);}return __setModuleDefault(_0x52edc4,_0x49bfa7),_0x52edc4;},__metadata=this&&this['__metadata']||function(_0x5cb187,_0xb453ba){const _0x348a20=a269_0x37425b;if(typeof Reflect===_0x348a20(0x215)&&typeof Reflect[_0x348a20(0x228)]===_0x348a20(0x1ec))return Reflect[_0x348a20(0x228)](_0x5cb187,_0xb453ba);},__importDefault=this&&this[a269_0x37425b(0x1e1)]||function(_0x95cd75){const _0x37385a=a269_0x37425b;return _0x95cd75&&_0x95cd75[_0x37385a(0x1e6)]?_0x95cd75:{'default':_0x95cd75};},SalesforceAuthService_1;Object[a269_0x37425b(0x1fc)](exports,a269_0x37425b(0x1e6),{'value':!![]}),exports[a269_0x37425b(0x1e5)]=void 0x0;const typedi_1=__importStar(require(a269_0x37425b(0x231))),errors_1=require('../../../../constants/errors'),core_1=require(a269_0x37425b(0x1da)),axios_1=__importDefault(require(a269_0x37425b(0x1ff))),utils_1=require('../../../shared/utils'),invalid_refresh_token_error_1=require(a269_0x37425b(0x232)),auth_state_enum_1=require(a269_0x37425b(0x234)),unauthorized_salesforce_error_1=require(a269_0x37425b(0x221)),constants_1=require(a269_0x37425b(0x235)),providers_tokens_1=require(a269_0x37425b(0x206)),salesforce_1=require(a269_0x37425b(0x1dc));function a269_0x32fc(){const _0x599394=['logger','Logger','ERR_INVALID_SALESFORCE_TOKEN','instance_url','5872347oqyWwY','length','2148804chslxZ','updateAccessToken','post','object','application/json','518464vKnIEB','search','apply','authorization','Force\x20update\x20token','headers','SALESFORCE_API_VERSION','__setModuleDefault','access_token','Access\x20token\x20updated\x20for\x20%s','../errors/unauthorized-salesforce.error','refresh_token','token_type','instanceUrl','Create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','default','getOwnPropertyDescriptor','metadata','get','SalesforceUtils','Idle','tokenType','14YgXgrr','error','getAuthData','Active','typedi','../errors/invalid-refresh-token.error','orgId','../enums/auth-state.enum','../../../../constants','UnauthorizedSalesforceError','then','../../../../core','joinURL','@flosum/salesforce','authState','catch','InvalidRefreshTokenError','configurable','__importDefault','toString','message','waitAuth','SalesforceAuthService','__esModule','log','constructor','(((.+)+)+)+$','AuthState','17198SfeUlT','function','4744424IPqPfN','response','requestConfig','Update\x20access\x20token\x20failed:\x20%s','185GISxqZ','isSoapUrl','setAuthDetails','call','isBulk1Url','Updating','Error','Update\x20access\x20token','sleep','22322090lednUx','AUTH_WAIT_TIME','defineProperty','6628iCvzEs','services/data/','axios','219tVjFMm','forceUpdateToken','Service','design:paramtypes','__createBinding','__importStar','../../providers/providers.tokens','accessToken','decorate','data','/services/oauth2/token','create'];a269_0x32fc=function(){return _0x599394;};return a269_0x32fc();}let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x129279=a269_0x37425b;this['AUTH_WAIT_TIME']=0x1388,this['authState']=auth_state_enum_1[_0x129279(0x1ea)][_0x129279(0x22b)],this['logger']=new core_1[(_0x129279(0x20d))](SalesforceAuthService_1['name']),this[_0x129279(0x1f3)]();}async['setAuthDetails'](){const _0x55853a=a269_0x37425b;this[_0x55853a(0x20c)][_0x55853a(0x1e7)]('Check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1[_0x55853a(0x1ea)][this['authState']]);try{if(this['authState']===auth_state_enum_1[_0x55853a(0x1ea)][_0x55853a(0x1f7)])return;if(this[_0x55853a(0x1dd)]===auth_state_enum_1[_0x55853a(0x1ea)]['Idle'])await this[_0x55853a(0x213)]();else{const _0x2e6f4f=await this[_0x55853a(0x1ef)](),_0xa05ad5=await axios_1[_0x55853a(0x226)][_0x55853a(0x229)](_0x55853a(0x1fe)+constants_1[_0x55853a(0x21d)],_0x2e6f4f)[_0x55853a(0x1d9)](()=>!![])[_0x55853a(0x1de)](()=>![]);!_0xa05ad5&&await this[_0x55853a(0x213)]();}}catch(_0x1a3ccd){}}async[a269_0x37425b(0x213)](){const _0x1614ed=a269_0x37425b;var _0x531ee7,_0x5db6b7,_0x1fef66;this[_0x1614ed(0x20c)][_0x1614ed(0x1e7)](_0x1614ed(0x1f8));try{this[_0x1614ed(0x1dd)]=auth_state_enum_1[_0x1614ed(0x1ea)][_0x1614ed(0x1f6)];const {refreshToken:_0x4b8296,clientId:_0x4c4499,clientSecret:_0x167b29,loginUrl:_0x42e0fd}=typedi_1['default'][_0x1614ed(0x229)](providers_tokens_1['Tokens']['salesforce']),{data:_0x2ac2f4}=await axios_1[_0x1614ed(0x226)][_0x1614ed(0x214)]((0x0,utils_1[_0x1614ed(0x1db)])(_0x42e0fd,_0x1614ed(0x20a)),null,{'params':{'grant_type':_0x1614ed(0x222),'refresh_token':_0x4b8296,'client_id':_0x4c4499,'client_secret':_0x167b29}});this[_0x1614ed(0x224)]=_0x2ac2f4[_0x1614ed(0x20f)],this[_0x1614ed(0x207)]=_0x2ac2f4[_0x1614ed(0x21f)],this[_0x1614ed(0x22c)]=_0x2ac2f4[_0x1614ed(0x223)],this[_0x1614ed(0x1dd)]=auth_state_enum_1[_0x1614ed(0x1ea)][_0x1614ed(0x230)],this[_0x1614ed(0x20c)][_0x1614ed(0x1e7)](_0x1614ed(0x220),this[_0x1614ed(0x224)]);}catch(_0x1e4a13){const _0x15fa8b=((_0x5db6b7=(_0x531ee7=_0x1e4a13===null||_0x1e4a13===void 0x0?void 0x0:_0x1e4a13[_0x1614ed(0x1ee)])===null||_0x531ee7===void 0x0?void 0x0:_0x531ee7[_0x1614ed(0x209)])===null||_0x5db6b7===void 0x0?void 0x0:_0x5db6b7['error'])||((_0x1fef66=_0x1e4a13===null||_0x1e4a13===void 0x0?void 0x0:_0x1e4a13[_0x1614ed(0x1ee)])===null||_0x1fef66===void 0x0?void 0x0:_0x1fef66[_0x1614ed(0x209)])||_0x1e4a13[_0x1614ed(0x1e3)];this[_0x1614ed(0x20c)][_0x1614ed(0x22e)](_0x1614ed(0x1f0),_0x15fa8b),this[_0x1614ed(0x1dd)]=auth_state_enum_1[_0x1614ed(0x1ea)]['Error'];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async[a269_0x37425b(0x201)](){const _0x17aa95=a269_0x37425b;this[_0x17aa95(0x20c)]['log'](_0x17aa95(0x21b));if(this[_0x17aa95(0x1dd)]===auth_state_enum_1['AuthState'][_0x17aa95(0x1f6)]||this[_0x17aa95(0x1dd)]===auth_state_enum_1[_0x17aa95(0x1ea)][_0x17aa95(0x22b)])return await(0x0,utils_1['sleep'])(this[_0x17aa95(0x1fb)]),this[_0x17aa95(0x201)]();if(this['authState']===auth_state_enum_1['AuthState'][_0x17aa95(0x1f7)])throw new invalid_refresh_token_error_1[(_0x17aa95(0x1df))](errors_1[_0x17aa95(0x20e)]);await this[_0x17aa95(0x213)]();}async[a269_0x37425b(0x1e4)](){const _0x180f97=a269_0x37425b;if(this['authState']===auth_state_enum_1[_0x180f97(0x1ea)][_0x180f97(0x1f7)]){this[_0x180f97(0x20c)][_0x180f97(0x1e7)]('Create\x20authorized\x20request\x20failed:\x20authorization\x20error');throw new unauthorized_salesforce_error_1[(_0x180f97(0x1d8))]();}if(this[_0x180f97(0x1dd)]!==auth_state_enum_1[_0x180f97(0x1ea)][_0x180f97(0x230)])return this[_0x180f97(0x20c)][_0x180f97(0x1e7)](_0x180f97(0x225)),await(0x0,utils_1[_0x180f97(0x1f9)])(this['AUTH_WAIT_TIME']),this['waitAuth']();}[a269_0x37425b(0x22f)](){const _0x415862=a269_0x37425b;return{'orgId':this[_0x415862(0x233)],'accessToken':this[_0x415862(0x207)],'instanceUrl':this[_0x415862(0x224)]};}async[a269_0x37425b(0x1ef)](_0x54ac47=''){const _0x10ab7b=a269_0x37425b;await this[_0x10ab7b(0x1e4)]();const _0x503e8b={'baseURL':this[_0x10ab7b(0x224)],'headers':{'accept':_0x10ab7b(0x216)}};if(salesforce_1[_0x10ab7b(0x22a)][_0x10ab7b(0x1f5)](_0x54ac47))_0x503e8b[_0x10ab7b(0x21c)]['X-SFDC-Session']=this[_0x10ab7b(0x207)];else salesforce_1[_0x10ab7b(0x22a)][_0x10ab7b(0x1f2)](_0x54ac47)?_0x503e8b['data']=_0x503e8b['data']['replace'](/<met:sessionId>.+?<\/met:sessionId>/,'<met:sessionId>'+this[_0x10ab7b(0x207)]+'</met:sessionId>'):_0x503e8b['headers'][_0x10ab7b(0x21a)]=this[_0x10ab7b(0x22c)]+'\x20'+this[_0x10ab7b(0x207)];return _0x503e8b;}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a269_0x37425b(0x202)])(),__metadata(a269_0x37425b(0x203),[])],SalesforceAuthService),exports[a269_0x37425b(0x1e5)]=SalesforceAuthService;