const a226_0x2f5e6a=a226_0x5288;(function(_0x17276f,_0x2c2ef4){const _0x546a99=a226_0x5288,_0x36fcfd=_0x17276f();while(!![]){try{const _0x52fc1f=-parseInt(_0x546a99(0x1bb))/0x1*(parseInt(_0x546a99(0x1cc))/0x2)+parseInt(_0x546a99(0x1b9))/0x3*(-parseInt(_0x546a99(0x1c2))/0x4)+-parseInt(_0x546a99(0x1b2))/0x5*(parseInt(_0x546a99(0x1ba))/0x6)+parseInt(_0x546a99(0x18e))/0x7*(-parseInt(_0x546a99(0x1a8))/0x8)+parseInt(_0x546a99(0x1c9))/0x9+parseInt(_0x546a99(0x1cd))/0xa*(-parseInt(_0x546a99(0x19e))/0xb)+parseInt(_0x546a99(0x17c))/0xc*(parseInt(_0x546a99(0x1b0))/0xd);if(_0x52fc1f===_0x2c2ef4)break;else _0x36fcfd['push'](_0x36fcfd['shift']());}catch(_0x4d7cfb){_0x36fcfd['push'](_0x36fcfd['shift']());}}}(a226_0x33cc,0xaff47));function a226_0x5288(_0x2c1c5e,_0x4a5993){const _0x4497ff=a226_0x33cc();return a226_0x5288=function(_0x283e7b,_0x3c7f30){_0x283e7b=_0x283e7b-0x17a;let _0x33cc59=_0x4497ff[_0x283e7b];return _0x33cc59;},a226_0x5288(_0x2c1c5e,_0x4a5993);}const a226_0x3c7f30=(function(){let _0x4ff459=!![];return function(_0x387cad,_0x3e56de){const _0x298679=_0x4ff459?function(){const _0x5565d4=a226_0x5288;if(_0x3e56de){const _0x5c272f=_0x3e56de[_0x5565d4(0x1a7)](_0x387cad,arguments);return _0x3e56de=null,_0x5c272f;}}:function(){};return _0x4ff459=![],_0x298679;};}()),a226_0x283e7b=a226_0x3c7f30(this,function(){const _0x208392=a226_0x5288;return a226_0x283e7b[_0x208392(0x1c8)]()['search'](_0x208392(0x194))[_0x208392(0x1c8)]()[_0x208392(0x1af)](a226_0x283e7b)[_0x208392(0x1ce)](_0x208392(0x194));});a226_0x283e7b();'use strict';function a226_0x33cc(){const _0x48aec8=['2907160ZMMkWs','tokenType','response','force\x20update\x20token','token_type','sleep','__metadata','constructor','19988228XwEpWW','AuthState','990695ogjjwH','getAuthData','Error','../../../shared/utils','typedi','refresh_token','Active','3RpjNvl','6iyMzfg','5QBvjxb','instanceUrl','accessToken','writable','SalesforceAuthService','call','default','1873288PQtTUs','application/json','__esModule','function','logger','services/data/','toString','3932802MNcpLA','error','access\x20token\x20updated\x20for\x20%s','542366RZQOoQ','1014020jwCVWj','search','then','updateAccessToken','24NCDiwf','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','requestConfig','axios','Idle','__decorate','decorate','InvalidRefreshTokenError','catch','object','defineProperty','update\x20access\x20token\x20failed:\x20%s','instance_url','getOwnPropertyDescriptor','../../../../constants','hasOwnProperty','get','forceUpdateToken','7CPikFG','update\x20access\x20token','create\x20authorized\x20request\x20failed:\x20authorization\x20error','check\x20auth:\x20current\x20state\x20-\x20%s','__createBinding','metadata','(((.+)+)+)+$','access_token','joinURL','design:paramtypes','Updating','__importDefault','waitAuth','data','post','log','44LJcdwO','../../../../constants/errors','../../../../core','authState','../errors/invalid-refresh-token.error','UnauthorizedSalesforceError','AUTH_WAIT_TIME','salesforce','configurable','apply'];a226_0x33cc=function(){return _0x48aec8;};return a226_0x33cc();}var __createBinding=this&&this[a226_0x2f5e6a(0x192)]||(Object['create']?function(_0x129b77,_0x3f26ff,_0x4ca346,_0x3d5479){const _0x531e67=a226_0x2f5e6a;if(_0x3d5479===undefined)_0x3d5479=_0x4ca346;var _0x25a11e=Object[_0x531e67(0x189)](_0x3f26ff,_0x4ca346);(!_0x25a11e||(_0x531e67(0x18c)in _0x25a11e?!_0x3f26ff[_0x531e67(0x1c4)]:_0x25a11e[_0x531e67(0x1be)]||_0x25a11e[_0x531e67(0x1a6)]))&&(_0x25a11e={'enumerable':!![],'get':function(){return _0x3f26ff[_0x4ca346];}}),Object[_0x531e67(0x186)](_0x129b77,_0x3d5479,_0x25a11e);}:function(_0x41a9b4,_0x3fd086,_0x244466,_0x1033d3){if(_0x1033d3===undefined)_0x1033d3=_0x244466;_0x41a9b4[_0x1033d3]=_0x3fd086[_0x244466];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x58b982,_0x3dc311){const _0x8951b8=a226_0x2f5e6a;Object[_0x8951b8(0x186)](_0x58b982,_0x8951b8(0x1c1),{'enumerable':!![],'value':_0x3dc311});}:function(_0x3cccb3,_0x448eda){_0x3cccb3['default']=_0x448eda;}),__decorate=this&&this[a226_0x2f5e6a(0x181)]||function(_0x2b9f58,_0x376ca6,_0x5c78e0,_0x43b62e){const _0x5487f8=a226_0x2f5e6a;var _0x1d80d9=arguments['length'],_0xb729f8=_0x1d80d9<0x3?_0x376ca6:_0x43b62e===null?_0x43b62e=Object[_0x5487f8(0x189)](_0x376ca6,_0x5c78e0):_0x43b62e,_0x24629d;if(typeof Reflect===_0x5487f8(0x185)&&typeof Reflect[_0x5487f8(0x182)]===_0x5487f8(0x1c5))_0xb729f8=Reflect[_0x5487f8(0x182)](_0x2b9f58,_0x376ca6,_0x5c78e0,_0x43b62e);else{for(var _0x3ee2ef=_0x2b9f58['length']-0x1;_0x3ee2ef>=0x0;_0x3ee2ef--)if(_0x24629d=_0x2b9f58[_0x3ee2ef])_0xb729f8=(_0x1d80d9<0x3?_0x24629d(_0xb729f8):_0x1d80d9>0x3?_0x24629d(_0x376ca6,_0x5c78e0,_0xb729f8):_0x24629d(_0x376ca6,_0x5c78e0))||_0xb729f8;}return _0x1d80d9>0x3&&_0xb729f8&&Object['defineProperty'](_0x376ca6,_0x5c78e0,_0xb729f8),_0xb729f8;},__importStar=this&&this['__importStar']||function(_0x7d4a9c){const _0x34a8d2=a226_0x2f5e6a;if(_0x7d4a9c&&_0x7d4a9c[_0x34a8d2(0x1c4)])return _0x7d4a9c;var _0x4faf0c={};if(_0x7d4a9c!=null){for(var _0x578e08 in _0x7d4a9c)if(_0x578e08!==_0x34a8d2(0x1c1)&&Object['prototype'][_0x34a8d2(0x18b)][_0x34a8d2(0x1c0)](_0x7d4a9c,_0x578e08))__createBinding(_0x4faf0c,_0x7d4a9c,_0x578e08);}return __setModuleDefault(_0x4faf0c,_0x7d4a9c),_0x4faf0c;},__metadata=this&&this[a226_0x2f5e6a(0x1ae)]||function(_0x49bfd6,_0xcfaba){const _0x285583=a226_0x2f5e6a;if(typeof Reflect===_0x285583(0x185)&&typeof Reflect[_0x285583(0x193)]===_0x285583(0x1c5))return Reflect['metadata'](_0x49bfd6,_0xcfaba);},__importDefault=this&&this[a226_0x2f5e6a(0x199)]||function(_0x1b53a4){const _0x2c2fec=a226_0x2f5e6a;return _0x1b53a4&&_0x1b53a4[_0x2c2fec(0x1c4)]?_0x1b53a4:{'default':_0x1b53a4};},SalesforceAuthService_1;Object[a226_0x2f5e6a(0x186)](exports,a226_0x2f5e6a(0x1c4),{'value':!![]}),exports[a226_0x2f5e6a(0x1bf)]=void 0x0;const typedi_1=__importStar(require(a226_0x2f5e6a(0x1b6))),errors_1=require(a226_0x2f5e6a(0x19f)),core_1=require(a226_0x2f5e6a(0x1a0)),axios_1=__importDefault(require(a226_0x2f5e6a(0x17f))),utils_1=require(a226_0x2f5e6a(0x1b5)),invalid_refresh_token_error_1=require(a226_0x2f5e6a(0x1a2)),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a226_0x2f5e6a(0x18a)),providers_tokens_1=require('../../providers/providers.tokens');let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x3c3b2e=a226_0x2f5e6a;this[_0x3c3b2e(0x1a4)]=0x1388,this['authState']=auth_state_enum_1[_0x3c3b2e(0x1b1)][_0x3c3b2e(0x180)],this[_0x3c3b2e(0x1c6)]=new core_1['Logger'](SalesforceAuthService_1['name']),this['setAuthDetails']();}async['setAuthDetails'](){const _0x565c8d=a226_0x2f5e6a;this[_0x565c8d(0x1c6)]['log'](_0x565c8d(0x191),auth_state_enum_1['AuthState'][this['authState']]);try{if(this['authState']===auth_state_enum_1[_0x565c8d(0x1b1)]['Error'])return;if(this['authState']===auth_state_enum_1[_0x565c8d(0x1b1)][_0x565c8d(0x180)])await this[_0x565c8d(0x17b)]();else{const _0x5a13e1=await this['requestConfig'](),_0xff9d11=await axios_1[_0x565c8d(0x1c1)]['get'](_0x565c8d(0x1c7)+constants_1['SALESFORCE_API_VERSION'],_0x5a13e1)[_0x565c8d(0x17a)](()=>!![])[_0x565c8d(0x184)](()=>![]);!_0xff9d11&&await this[_0x565c8d(0x17b)]();}}catch(_0x5a1182){}}async[a226_0x2f5e6a(0x17b)](){const _0x4d076b=a226_0x2f5e6a;var _0x5b7c3c,_0x48f5eb,_0x416f2b;this[_0x4d076b(0x1c6)][_0x4d076b(0x19d)](_0x4d076b(0x18f));try{this[_0x4d076b(0x1a1)]=auth_state_enum_1[_0x4d076b(0x1b1)][_0x4d076b(0x198)];const {refreshToken:_0x5e666e,clientId:_0x5f0761,clientSecret:_0x121133,loginUrl:_0x3fa70e}=typedi_1['default'][_0x4d076b(0x18c)](providers_tokens_1['Tokens'][_0x4d076b(0x1a5)]),{data:_0x3277db}=await axios_1[_0x4d076b(0x1c1)][_0x4d076b(0x19c)]((0x0,utils_1[_0x4d076b(0x196)])(_0x3fa70e,'/services/oauth2/token'),null,{'params':{'grant_type':_0x4d076b(0x1b7),'refresh_token':_0x5e666e,'client_id':_0x5f0761,'client_secret':_0x121133}});this[_0x4d076b(0x1bc)]=_0x3277db[_0x4d076b(0x188)],this[_0x4d076b(0x1bd)]=_0x3277db[_0x4d076b(0x195)],this[_0x4d076b(0x1a9)]=_0x3277db[_0x4d076b(0x1ac)],this['authState']=auth_state_enum_1[_0x4d076b(0x1b1)][_0x4d076b(0x1b8)],this[_0x4d076b(0x1c6)]['log'](_0x4d076b(0x1cb),this['instanceUrl']);}catch(_0x49090b){const _0x5eef1b=((_0x48f5eb=(_0x5b7c3c=_0x49090b===null||_0x49090b===void 0x0?void 0x0:_0x49090b[_0x4d076b(0x1aa)])===null||_0x5b7c3c===void 0x0?void 0x0:_0x5b7c3c[_0x4d076b(0x19b)])===null||_0x48f5eb===void 0x0?void 0x0:_0x48f5eb['error'])||((_0x416f2b=_0x49090b===null||_0x49090b===void 0x0?void 0x0:_0x49090b[_0x4d076b(0x1aa)])===null||_0x416f2b===void 0x0?void 0x0:_0x416f2b[_0x4d076b(0x19b)])||_0x49090b['message'];this['logger'][_0x4d076b(0x1ca)](_0x4d076b(0x187),_0x5eef1b),this['authState']=auth_state_enum_1[_0x4d076b(0x1b1)][_0x4d076b(0x1b4)];throw new invalid_refresh_token_error_1[(_0x4d076b(0x183))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async[a226_0x2f5e6a(0x18d)](){const _0x1d9064=a226_0x2f5e6a;this[_0x1d9064(0x1c6)][_0x1d9064(0x19d)](_0x1d9064(0x1ab));if(this['authState']===auth_state_enum_1['AuthState'][_0x1d9064(0x198)]||this[_0x1d9064(0x1a1)]===auth_state_enum_1[_0x1d9064(0x1b1)][_0x1d9064(0x180)])return await(0x0,utils_1['sleep'])(this[_0x1d9064(0x1a4)]),this[_0x1d9064(0x18d)]();if(this[_0x1d9064(0x1a1)]===auth_state_enum_1[_0x1d9064(0x1b1)][_0x1d9064(0x1b4)])throw new invalid_refresh_token_error_1[(_0x1d9064(0x183))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0x1d9064(0x17b)]();}async[a226_0x2f5e6a(0x19a)](){const _0x102828=a226_0x2f5e6a;if(this[_0x102828(0x1a1)]===auth_state_enum_1[_0x102828(0x1b1)]['Error']){this['logger']['log'](_0x102828(0x190));throw new unauthorized_salesforce_error_1[(_0x102828(0x1a3))]();}if(this['authState']!==auth_state_enum_1['AuthState']['Active'])return this['logger'][_0x102828(0x19d)](_0x102828(0x17d)),await(0x0,utils_1[_0x102828(0x1ad)])(this['AUTH_WAIT_TIME']),this[_0x102828(0x19a)]();}[a226_0x2f5e6a(0x1b3)](){const _0x1cb33e=a226_0x2f5e6a;return{'orgId':this['orgId'],'accessToken':this[_0x1cb33e(0x1bd)],'instanceUrl':this[_0x1cb33e(0x1bc)]};}async[a226_0x2f5e6a(0x17e)](){const _0x20b891=a226_0x2f5e6a;return await this[_0x20b891(0x19a)](),{'baseURL':this[_0x20b891(0x1bc)],'headers':{'accept':_0x20b891(0x1c3),'authorization':this[_0x20b891(0x1a9)]+'\x20'+this[_0x20b891(0x1bd)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a226_0x2f5e6a(0x197),[])],SalesforceAuthService),exports[a226_0x2f5e6a(0x1bf)]=SalesforceAuthService;