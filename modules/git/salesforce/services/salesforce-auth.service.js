function a232_0x1675(_0x25b4f2,_0x3f4b65){const _0x1faf76=a232_0x250f();return a232_0x1675=function(_0x1fddd5,_0x3e03d2){_0x1fddd5=_0x1fddd5-0x190;let _0x250f78=_0x1faf76[_0x1fddd5];return _0x250f78;},a232_0x1675(_0x25b4f2,_0x3f4b65);}const a232_0x2b1395=a232_0x1675;(function(_0x331e48,_0x1d35bd){const _0x9b086c=a232_0x1675,_0x4fcb73=_0x331e48();while(!![]){try{const _0x3fadcb=parseInt(_0x9b086c(0x193))/0x1*(-parseInt(_0x9b086c(0x19b))/0x2)+parseInt(_0x9b086c(0x1c4))/0x3*(parseInt(_0x9b086c(0x1a1))/0x4)+-parseInt(_0x9b086c(0x19c))/0x5+-parseInt(_0x9b086c(0x1db))/0x6*(parseInt(_0x9b086c(0x1b8))/0x7)+parseInt(_0x9b086c(0x1b5))/0x8+parseInt(_0x9b086c(0x1e5))/0x9+-parseInt(_0x9b086c(0x1d9))/0xa*(-parseInt(_0x9b086c(0x1d4))/0xb);if(_0x3fadcb===_0x1d35bd)break;else _0x4fcb73['push'](_0x4fcb73['shift']());}catch(_0x54469b){_0x4fcb73['push'](_0x4fcb73['shift']());}}}(a232_0x250f,0x68d1d));const a232_0x3e03d2=(function(){let _0x4b2b62=!![];return function(_0x10a500,_0x58f11b){const _0x2b9d31=_0x4b2b62?function(){const _0x56c765=a232_0x1675;if(_0x58f11b){const _0x3fa26c=_0x58f11b[_0x56c765(0x1df)](_0x10a500,arguments);return _0x58f11b=null,_0x3fa26c;}}:function(){};return _0x4b2b62=![],_0x2b9d31;};}()),a232_0x1fddd5=a232_0x3e03d2(this,function(){const _0x581f4e=a232_0x1675;return a232_0x1fddd5[_0x581f4e(0x1a6)]()['search']('(((.+)+)+)+$')[_0x581f4e(0x1a6)]()[_0x581f4e(0x1c5)](a232_0x1fddd5)[_0x581f4e(0x1ce)](_0x581f4e(0x1bb));});a232_0x1fddd5();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a232_0x2b1395(0x1aa)]?function(_0x2fc1b9,_0x1c5dac,_0x171dfb,_0xc9af0b){const _0x216aac=a232_0x2b1395;if(_0xc9af0b===undefined)_0xc9af0b=_0x171dfb;var _0x3f130a=Object[_0x216aac(0x1c2)](_0x1c5dac,_0x171dfb);(!_0x3f130a||(_0x216aac(0x1a2)in _0x3f130a?!_0x1c5dac[_0x216aac(0x1e4)]:_0x3f130a[_0x216aac(0x1d5)]||_0x3f130a[_0x216aac(0x1ae)]))&&(_0x3f130a={'enumerable':!![],'get':function(){return _0x1c5dac[_0x171dfb];}}),Object[_0x216aac(0x191)](_0x2fc1b9,_0xc9af0b,_0x3f130a);}:function(_0x22a30d,_0x5067e1,_0x2141cb,_0x4e9b9a){if(_0x4e9b9a===undefined)_0x4e9b9a=_0x2141cb;_0x22a30d[_0x4e9b9a]=_0x5067e1[_0x2141cb];}),__setModuleDefault=this&&this[a232_0x2b1395(0x1ea)]||(Object['create']?function(_0x43f79b,_0x32acec){Object['defineProperty'](_0x43f79b,'default',{'enumerable':!![],'value':_0x32acec});}:function(_0x15df4e,_0x39e0da){const _0x45b304=a232_0x2b1395;_0x15df4e[_0x45b304(0x1c1)]=_0x39e0da;}),__decorate=this&&this[a232_0x2b1395(0x195)]||function(_0x565ec6,_0x1f67d0,_0x81a887,_0x396b4b){const _0x158378=a232_0x2b1395;var _0x1cda94=arguments[_0x158378(0x1b2)],_0x5de318=_0x1cda94<0x3?_0x1f67d0:_0x396b4b===null?_0x396b4b=Object[_0x158378(0x1c2)](_0x1f67d0,_0x81a887):_0x396b4b,_0x2342fa;if(typeof Reflect===_0x158378(0x1a7)&&typeof Reflect['decorate']===_0x158378(0x1ad))_0x5de318=Reflect['decorate'](_0x565ec6,_0x1f67d0,_0x81a887,_0x396b4b);else{for(var _0x3383d8=_0x565ec6[_0x158378(0x1b2)]-0x1;_0x3383d8>=0x0;_0x3383d8--)if(_0x2342fa=_0x565ec6[_0x3383d8])_0x5de318=(_0x1cda94<0x3?_0x2342fa(_0x5de318):_0x1cda94>0x3?_0x2342fa(_0x1f67d0,_0x81a887,_0x5de318):_0x2342fa(_0x1f67d0,_0x81a887))||_0x5de318;}return _0x1cda94>0x3&&_0x5de318&&Object[_0x158378(0x191)](_0x1f67d0,_0x81a887,_0x5de318),_0x5de318;},__importStar=this&&this['__importStar']||function(_0x1bf137){const _0x5667e9=a232_0x2b1395;if(_0x1bf137&&_0x1bf137[_0x5667e9(0x1e4)])return _0x1bf137;var _0x591b1e={};if(_0x1bf137!=null){for(var _0x39eced in _0x1bf137)if(_0x39eced!==_0x5667e9(0x1c1)&&Object[_0x5667e9(0x198)][_0x5667e9(0x1e1)][_0x5667e9(0x199)](_0x1bf137,_0x39eced))__createBinding(_0x591b1e,_0x1bf137,_0x39eced);}return __setModuleDefault(_0x591b1e,_0x1bf137),_0x591b1e;},__metadata=this&&this[a232_0x2b1395(0x1dd)]||function(_0x577785,_0x48525a){const _0x110751=a232_0x2b1395;if(typeof Reflect===_0x110751(0x1a7)&&typeof Reflect[_0x110751(0x1a0)]===_0x110751(0x1ad))return Reflect['metadata'](_0x577785,_0x48525a);},__importDefault=this&&this[a232_0x2b1395(0x1e6)]||function(_0x1fce7f){const _0x2cc7a7=a232_0x2b1395;return _0x1fce7f&&_0x1fce7f[_0x2cc7a7(0x1e4)]?_0x1fce7f:{'default':_0x1fce7f};},SalesforceAuthService_1;Object[a232_0x2b1395(0x191)](exports,a232_0x2b1395(0x1e4),{'value':!![]}),exports[a232_0x2b1395(0x1cb)]=void 0x0;function a232_0x250f(){const _0x392f31=['sleep','forceUpdateToken','toString','object','message','error','create','log','authState','function','configurable','Error','force\x20update\x20token','joinURL','length','post','AUTH_WAIT_TIME','5845776rTwhDs','update\x20access\x20token','accessToken','21iEcRFz','data','Active','(((.+)+)+)+$','Idle','axios','setAuthDetails','instanceUrl','updateAccessToken','default','getOwnPropertyDescriptor','response','3nesKtw','constructor','../enums/auth-state.enum','catch','InvalidRefreshTokenError','../../../../constants','../errors/invalid-refresh-token.error','SalesforceAuthService','orgId','create\x20authorized\x20request\x20failed:\x20authorization\x20error','search','Logger','token_type','requestConfig','Updating','typedi','17314ImwTsr','writable','refresh_token','tokenType','update\x20access\x20token\x20failed:\x20%s','7780LqpksZ','logger','1688514EDIwep','../../../../constants/errors','__metadata','access_token','apply','name','hasOwnProperty','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','../../../shared/utils','__esModule','2441835YKlxGB','__importDefault','../../providers/providers.tokens','Tokens','../errors/unauthorized-salesforce.error','__setModuleDefault','AuthState','ERR_INVALID_SALESFORCE_TOKEN','defineProperty','check\x20auth:\x20current\x20state\x20-\x20%s','8459zCUHKu','UnauthorizedSalesforceError','__decorate','services/data/','design:paramtypes','prototype','call','access\x20token\x20updated\x20for\x20%s','134BnhveC','2637165xssdBb','then','instance_url','SALESFORCE_API_VERSION','metadata','564700oTyYCz','get','waitAuth'];a232_0x250f=function(){return _0x392f31;};return a232_0x250f();}const typedi_1=__importStar(require(a232_0x2b1395(0x1d3))),errors_1=require(a232_0x2b1395(0x1dc)),core_1=require('../../../../core'),axios_1=__importDefault(require(a232_0x2b1395(0x1bd))),utils_1=require(a232_0x2b1395(0x1e3)),invalid_refresh_token_error_1=require(a232_0x2b1395(0x1ca)),auth_state_enum_1=require(a232_0x2b1395(0x1c6)),unauthorized_salesforce_error_1=require(a232_0x2b1395(0x1e9)),constants_1=require(a232_0x2b1395(0x1c9)),providers_tokens_1=require(a232_0x2b1395(0x1e7));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x7929a2=a232_0x2b1395;this[_0x7929a2(0x1b4)]=0x1388,this[_0x7929a2(0x1ac)]=auth_state_enum_1[_0x7929a2(0x1eb)]['Idle'],this[_0x7929a2(0x1da)]=new core_1[(_0x7929a2(0x1cf))](SalesforceAuthService_1[_0x7929a2(0x1e0)]),this[_0x7929a2(0x1be)]();}async['setAuthDetails'](){const _0x47a02a=a232_0x2b1395;this['logger'][_0x47a02a(0x1ab)](_0x47a02a(0x192),auth_state_enum_1[_0x47a02a(0x1eb)][this[_0x47a02a(0x1ac)]]);try{if(this[_0x47a02a(0x1ac)]===auth_state_enum_1[_0x47a02a(0x1eb)]['Error'])return;if(this[_0x47a02a(0x1ac)]===auth_state_enum_1[_0x47a02a(0x1eb)][_0x47a02a(0x1bc)])await this[_0x47a02a(0x1c0)]();else{const _0x311ee6=await this[_0x47a02a(0x1d1)](),_0xdbe677=await axios_1[_0x47a02a(0x1c1)]['get'](_0x47a02a(0x196)+constants_1[_0x47a02a(0x19f)],_0x311ee6)[_0x47a02a(0x19d)](()=>!![])[_0x47a02a(0x1c7)](()=>![]);!_0xdbe677&&await this['updateAccessToken']();}}catch(_0x4011fb){}}async[a232_0x2b1395(0x1c0)](){const _0x4e7efb=a232_0x2b1395;var _0x1bb03d,_0x1e90c5,_0xec049d;this[_0x4e7efb(0x1da)][_0x4e7efb(0x1ab)](_0x4e7efb(0x1b6));try{this[_0x4e7efb(0x1ac)]=auth_state_enum_1[_0x4e7efb(0x1eb)]['Updating'];const {refreshToken:_0x38076e,clientId:_0x1ce2a3,clientSecret:_0x108662,loginUrl:_0xc3c979}=typedi_1[_0x4e7efb(0x1c1)][_0x4e7efb(0x1a2)](providers_tokens_1[_0x4e7efb(0x1e8)]['salesforce']),{data:_0xedb26d}=await axios_1[_0x4e7efb(0x1c1)][_0x4e7efb(0x1b3)]((0x0,utils_1[_0x4e7efb(0x1b1)])(_0xc3c979,'/services/oauth2/token'),null,{'params':{'grant_type':_0x4e7efb(0x1d6),'refresh_token':_0x38076e,'client_id':_0x1ce2a3,'client_secret':_0x108662}});this[_0x4e7efb(0x1bf)]=_0xedb26d[_0x4e7efb(0x19e)],this[_0x4e7efb(0x1b7)]=_0xedb26d[_0x4e7efb(0x1de)],this[_0x4e7efb(0x1d7)]=_0xedb26d[_0x4e7efb(0x1d0)],this['authState']=auth_state_enum_1[_0x4e7efb(0x1eb)][_0x4e7efb(0x1ba)],this[_0x4e7efb(0x1da)][_0x4e7efb(0x1ab)](_0x4e7efb(0x19a),this[_0x4e7efb(0x1bf)]);}catch(_0x19239a){const _0x22afe7=((_0x1e90c5=(_0x1bb03d=_0x19239a===null||_0x19239a===void 0x0?void 0x0:_0x19239a[_0x4e7efb(0x1c3)])===null||_0x1bb03d===void 0x0?void 0x0:_0x1bb03d[_0x4e7efb(0x1b9)])===null||_0x1e90c5===void 0x0?void 0x0:_0x1e90c5[_0x4e7efb(0x1a9)])||((_0xec049d=_0x19239a===null||_0x19239a===void 0x0?void 0x0:_0x19239a[_0x4e7efb(0x1c3)])===null||_0xec049d===void 0x0?void 0x0:_0xec049d['data'])||_0x19239a[_0x4e7efb(0x1a8)];this[_0x4e7efb(0x1da)][_0x4e7efb(0x1a9)](_0x4e7efb(0x1d8),_0x22afe7),this[_0x4e7efb(0x1ac)]=auth_state_enum_1[_0x4e7efb(0x1eb)][_0x4e7efb(0x1af)];throw new invalid_refresh_token_error_1[(_0x4e7efb(0x1c8))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async[a232_0x2b1395(0x1a5)](){const _0x431ea8=a232_0x2b1395;this[_0x431ea8(0x1da)][_0x431ea8(0x1ab)](_0x431ea8(0x1b0));if(this[_0x431ea8(0x1ac)]===auth_state_enum_1['AuthState'][_0x431ea8(0x1d2)]||this[_0x431ea8(0x1ac)]===auth_state_enum_1['AuthState'][_0x431ea8(0x1bc)])return await(0x0,utils_1['sleep'])(this['AUTH_WAIT_TIME']),this[_0x431ea8(0x1a5)]();if(this[_0x431ea8(0x1ac)]===auth_state_enum_1[_0x431ea8(0x1eb)]['Error'])throw new invalid_refresh_token_error_1[(_0x431ea8(0x1c8))](errors_1[_0x431ea8(0x190)]);await this['updateAccessToken']();}async[a232_0x2b1395(0x1a3)](){const _0x40e50c=a232_0x2b1395;if(this[_0x40e50c(0x1ac)]===auth_state_enum_1[_0x40e50c(0x1eb)][_0x40e50c(0x1af)]){this['logger'][_0x40e50c(0x1ab)](_0x40e50c(0x1cd));throw new unauthorized_salesforce_error_1[(_0x40e50c(0x194))]();}if(this['authState']!==auth_state_enum_1[_0x40e50c(0x1eb)][_0x40e50c(0x1ba)])return this['logger']['log'](_0x40e50c(0x1e2)),await(0x0,utils_1[_0x40e50c(0x1a4)])(this[_0x40e50c(0x1b4)]),this[_0x40e50c(0x1a3)]();}['getAuthData'](){const _0x48b491=a232_0x2b1395;return{'orgId':this[_0x48b491(0x1cc)],'accessToken':this[_0x48b491(0x1b7)],'instanceUrl':this[_0x48b491(0x1bf)]};}async[a232_0x2b1395(0x1d1)](){const _0x459584=a232_0x2b1395;return await this['waitAuth'](),{'baseURL':this[_0x459584(0x1bf)],'headers':{'accept':'application/json','authorization':this[_0x459584(0x1d7)]+'\x20'+this[_0x459584(0x1b7)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a232_0x2b1395(0x197),[])],SalesforceAuthService),exports[a232_0x2b1395(0x1cb)]=SalesforceAuthService;