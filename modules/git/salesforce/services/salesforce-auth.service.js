const a180_0x213ba1=a180_0x12dd;(function(_0x582528,_0x244afc){const _0x28f2cb=a180_0x12dd,_0x178267=_0x582528();while(!![]){try{const _0x167cbf=parseInt(_0x28f2cb(0x1c8))/0x1*(parseInt(_0x28f2cb(0x204))/0x2)+parseInt(_0x28f2cb(0x1fe))/0x3*(parseInt(_0x28f2cb(0x1c1))/0x4)+-parseInt(_0x28f2cb(0x209))/0x5+-parseInt(_0x28f2cb(0x20b))/0x6+parseInt(_0x28f2cb(0x201))/0x7*(-parseInt(_0x28f2cb(0x1e2))/0x8)+parseInt(_0x28f2cb(0x1d1))/0x9*(-parseInt(_0x28f2cb(0x1fb))/0xa)+parseInt(_0x28f2cb(0x1ca))/0xb*(parseInt(_0x28f2cb(0x1bd))/0xc);if(_0x167cbf===_0x244afc)break;else _0x178267['push'](_0x178267['shift']());}catch(_0x111e2b){_0x178267['push'](_0x178267['shift']());}}}(a180_0x36f6,0x62719));function a180_0x12dd(_0x58c5a6,_0x298c43){const _0x468e61=a180_0x36f6();return a180_0x12dd=function(_0x2d2177,_0x5505e1){_0x2d2177=_0x2d2177-0x1b0;let _0x36f618=_0x468e61[_0x2d2177];return _0x36f618;},a180_0x12dd(_0x58c5a6,_0x298c43);}function a180_0x36f6(){const _0x53a88b=['access_token','typedi','1233150RWTdad','__importDefault','SalesforceAuthService','7EbqYEx','metadata','../enums/auth-state.enum','2LmGfFS','Updating','toString','__createBinding','search','421280rlyBFc','name','2496372BKbHVm','post','Service','message','forceUpdateToken','force\x20update\x20token','instance_url','getAuthData','tokenType','response','instanceUrl','__metadata','../../../../core','catch','60YvIDyS','token_type','hasOwnProperty','apply','4VWzWWb','__esModule','axios','../../providers/providers.tokens','updateAccessToken','InvalidRefreshTokenError','Logger','765942jdehgW','../errors/unauthorized-salesforce.error','1563727phQOWO','joinURL','services/data/','SALESFORCE_API_VERSION','__decorate','Tokens','../../../shared/utils','9lCSGhm','(((.+)+)+)+$','update\x20access\x20token','requestConfig','log','decorate','AuthState','../../../../constants/errors','getOwnPropertyDescriptor','defineProperty','salesforce','update\x20access\x20token\x20failed:\x20%s','../../../../constants','__setModuleDefault','get','Error','../errors/invalid-refresh-token.error','2092968RHUkPy','Idle','authState','application/json','error','data','object','logger','Active','setAuthDetails','call','refresh_token','length','/services/oauth2/token','waitAuth','sleep','check\x20auth:\x20current\x20state\x20-\x20%s','default','create','function','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','AUTH_WAIT_TIME','accessToken','constructor','access\x20token\x20updated\x20for\x20%s','7226130zAJIRZ'];a180_0x36f6=function(){return _0x53a88b;};return a180_0x36f6();}const a180_0x5505e1=(function(){let _0x421276=!![];return function(_0x1a8cb1,_0x141e1a){const _0x5c27d5=_0x421276?function(){const _0x147ff5=a180_0x12dd;if(_0x141e1a){const _0x203390=_0x141e1a[_0x147ff5(0x1c0)](_0x1a8cb1,arguments);return _0x141e1a=null,_0x203390;}}:function(){};return _0x421276=![],_0x5c27d5;};}()),a180_0x2d2177=a180_0x5505e1(this,function(){const _0xea6a31=a180_0x12dd;return a180_0x2d2177[_0xea6a31(0x206)]()[_0xea6a31(0x208)](_0xea6a31(0x1d2))['toString']()[_0xea6a31(0x1f9)](a180_0x2d2177)[_0xea6a31(0x208)](_0xea6a31(0x1d2));});a180_0x2d2177();'use strict';var __createBinding=this&&this[a180_0x213ba1(0x207)]||(Object[a180_0x213ba1(0x1f4)]?function(_0x494ac9,_0x383577,_0x881d06,_0x53ab8b){const _0xa18528=a180_0x213ba1;if(_0x53ab8b===undefined)_0x53ab8b=_0x881d06;Object[_0xa18528(0x1da)](_0x494ac9,_0x53ab8b,{'enumerable':!![],'get':function(){return _0x383577[_0x881d06];}});}:function(_0x55175e,_0x5c7b0c,_0x15cc23,_0x136bbc){if(_0x136bbc===undefined)_0x136bbc=_0x15cc23;_0x55175e[_0x136bbc]=_0x5c7b0c[_0x15cc23];}),__setModuleDefault=this&&this[a180_0x213ba1(0x1de)]||(Object[a180_0x213ba1(0x1f4)]?function(_0x44ce3e,_0x4e1daa){const _0x3dbae7=a180_0x213ba1;Object[_0x3dbae7(0x1da)](_0x44ce3e,_0x3dbae7(0x1f3),{'enumerable':!![],'value':_0x4e1daa});}:function(_0x9f6647,_0x370fad){const _0x46cf08=a180_0x213ba1;_0x9f6647[_0x46cf08(0x1f3)]=_0x370fad;}),__decorate=this&&this[a180_0x213ba1(0x1ce)]||function(_0x21f89d,_0x3a18c2,_0x2e850a,_0x375703){const _0x41614e=a180_0x213ba1;var _0x7e0bf3=arguments[_0x41614e(0x1ee)],_0x329636=_0x7e0bf3<0x3?_0x3a18c2:_0x375703===null?_0x375703=Object[_0x41614e(0x1d9)](_0x3a18c2,_0x2e850a):_0x375703,_0x19542a;if(typeof Reflect===_0x41614e(0x1e8)&&typeof Reflect['decorate']==='function')_0x329636=Reflect[_0x41614e(0x1d6)](_0x21f89d,_0x3a18c2,_0x2e850a,_0x375703);else{for(var _0x17b00d=_0x21f89d[_0x41614e(0x1ee)]-0x1;_0x17b00d>=0x0;_0x17b00d--)if(_0x19542a=_0x21f89d[_0x17b00d])_0x329636=(_0x7e0bf3<0x3?_0x19542a(_0x329636):_0x7e0bf3>0x3?_0x19542a(_0x3a18c2,_0x2e850a,_0x329636):_0x19542a(_0x3a18c2,_0x2e850a))||_0x329636;}return _0x7e0bf3>0x3&&_0x329636&&Object[_0x41614e(0x1da)](_0x3a18c2,_0x2e850a,_0x329636),_0x329636;},__importStar=this&&this['__importStar']||function(_0x17709a){const _0x56bdb1=a180_0x213ba1;if(_0x17709a&&_0x17709a[_0x56bdb1(0x1c2)])return _0x17709a;var _0x19127d={};if(_0x17709a!=null){for(var _0x1f8346 in _0x17709a)if(_0x1f8346!=='default'&&Object['prototype'][_0x56bdb1(0x1bf)][_0x56bdb1(0x1ec)](_0x17709a,_0x1f8346))__createBinding(_0x19127d,_0x17709a,_0x1f8346);}return __setModuleDefault(_0x19127d,_0x17709a),_0x19127d;},__metadata=this&&this[a180_0x213ba1(0x1ba)]||function(_0x2493d1,_0x558ff0){const _0x221d69=a180_0x213ba1;if(typeof Reflect==='object'&&typeof Reflect[_0x221d69(0x202)]===_0x221d69(0x1f5))return Reflect[_0x221d69(0x202)](_0x2493d1,_0x558ff0);},__importDefault=this&&this[a180_0x213ba1(0x1ff)]||function(_0x3cdb61){const _0x256456=a180_0x213ba1;return _0x3cdb61&&_0x3cdb61[_0x256456(0x1c2)]?_0x3cdb61:{'default':_0x3cdb61};},SalesforceAuthService_1;Object[a180_0x213ba1(0x1da)](exports,'__esModule',{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=__importStar(require(a180_0x213ba1(0x1fd))),errors_1=require(a180_0x213ba1(0x1d8)),core_1=require(a180_0x213ba1(0x1bb)),axios_1=__importDefault(require(a180_0x213ba1(0x1c3))),utils_1=require(a180_0x213ba1(0x1d0)),invalid_refresh_token_error_1=require(a180_0x213ba1(0x1e1)),auth_state_enum_1=require(a180_0x213ba1(0x203)),unauthorized_salesforce_error_1=require(a180_0x213ba1(0x1c9)),constants_1=require(a180_0x213ba1(0x1dd)),providers_tokens_1=require(a180_0x213ba1(0x1c4));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x171f82=a180_0x213ba1;this[_0x171f82(0x1f7)]=0x1388,this[_0x171f82(0x1e4)]=auth_state_enum_1[_0x171f82(0x1d7)][_0x171f82(0x1e3)],this[_0x171f82(0x1e9)]=new core_1[(_0x171f82(0x1c7))](SalesforceAuthService_1[_0x171f82(0x20a)]),this[_0x171f82(0x1eb)]();}async[a180_0x213ba1(0x1eb)](){const _0x11012a=a180_0x213ba1;this[_0x11012a(0x1e9)][_0x11012a(0x1d5)](_0x11012a(0x1f2),auth_state_enum_1[_0x11012a(0x1d7)][this['authState']]);try{if(this['authState']===auth_state_enum_1[_0x11012a(0x1d7)][_0x11012a(0x1e0)])return;if(this['authState']===auth_state_enum_1[_0x11012a(0x1d7)][_0x11012a(0x1e3)])await this[_0x11012a(0x1c5)]();else{const _0x9fd96b=await this['requestConfig'](),_0x411d3e=await axios_1[_0x11012a(0x1f3)][_0x11012a(0x1df)](_0x11012a(0x1cc)+constants_1[_0x11012a(0x1cd)],_0x9fd96b)['then'](()=>!![])[_0x11012a(0x1bc)](()=>![]);!_0x411d3e&&await this[_0x11012a(0x1c5)]();}}catch(_0x17cfae){}}async[a180_0x213ba1(0x1c5)](){const _0x236701=a180_0x213ba1;var _0x3f015c,_0x52354d,_0x500732;this[_0x236701(0x1e9)][_0x236701(0x1d5)](_0x236701(0x1d3));try{this[_0x236701(0x1e4)]=auth_state_enum_1[_0x236701(0x1d7)][_0x236701(0x205)];const {refreshToken:_0x849779,clientId:_0x12dd53,clientSecret:_0x24fdb2,loginUrl:_0x30f078}=typedi_1[_0x236701(0x1f3)][_0x236701(0x1df)](providers_tokens_1[_0x236701(0x1cf)][_0x236701(0x1db)]),{data:_0x12b8c3}=await axios_1[_0x236701(0x1f3)][_0x236701(0x1b0)](utils_1[_0x236701(0x1cb)](_0x30f078,_0x236701(0x1ef)),null,{'params':{'grant_type':_0x236701(0x1ed),'refresh_token':_0x849779,'client_id':_0x12dd53,'client_secret':_0x24fdb2}});this[_0x236701(0x1b9)]=_0x12b8c3[_0x236701(0x1b5)],this['accessToken']=_0x12b8c3[_0x236701(0x1fc)],this[_0x236701(0x1b7)]=_0x12b8c3[_0x236701(0x1be)],this['authState']=auth_state_enum_1['AuthState'][_0x236701(0x1ea)],this[_0x236701(0x1e9)][_0x236701(0x1d5)](_0x236701(0x1fa),this[_0x236701(0x1b9)]);}catch(_0x1d4a83){const _0x777864=((_0x52354d=(_0x3f015c=_0x1d4a83===null||_0x1d4a83===void 0x0?void 0x0:_0x1d4a83[_0x236701(0x1b8)])===null||_0x3f015c===void 0x0?void 0x0:_0x3f015c[_0x236701(0x1e7)])===null||_0x52354d===void 0x0?void 0x0:_0x52354d['error'])||((_0x500732=_0x1d4a83===null||_0x1d4a83===void 0x0?void 0x0:_0x1d4a83['response'])===null||_0x500732===void 0x0?void 0x0:_0x500732['data'])||_0x1d4a83[_0x236701(0x1b2)];this[_0x236701(0x1e9)][_0x236701(0x1e6)](_0x236701(0x1dc),_0x777864),this[_0x236701(0x1e4)]=auth_state_enum_1[_0x236701(0x1d7)][_0x236701(0x1e0)];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async[a180_0x213ba1(0x1b3)](){const _0x2d2a55=a180_0x213ba1;this[_0x2d2a55(0x1e9)][_0x2d2a55(0x1d5)](_0x2d2a55(0x1b4));if(this[_0x2d2a55(0x1e4)]===auth_state_enum_1['AuthState'][_0x2d2a55(0x205)]||this[_0x2d2a55(0x1e4)]===auth_state_enum_1[_0x2d2a55(0x1d7)][_0x2d2a55(0x1e3)])return await utils_1[_0x2d2a55(0x1f1)](this[_0x2d2a55(0x1f7)]),this[_0x2d2a55(0x1b3)]();if(this[_0x2d2a55(0x1e4)]===auth_state_enum_1['AuthState']['Error'])throw new invalid_refresh_token_error_1[(_0x2d2a55(0x1c6))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0x2d2a55(0x1c5)]();}async[a180_0x213ba1(0x1f0)](){const _0x557f82=a180_0x213ba1;if(this['authState']===auth_state_enum_1[_0x557f82(0x1d7)][_0x557f82(0x1e0)]){this[_0x557f82(0x1e9)][_0x557f82(0x1d5)]('create\x20authorized\x20request\x20failed:\x20authorization\x20error');throw new unauthorized_salesforce_error_1['UnauthorizedSalesforceError']();}if(this[_0x557f82(0x1e4)]!==auth_state_enum_1[_0x557f82(0x1d7)]['Active'])return this[_0x557f82(0x1e9)][_0x557f82(0x1d5)](_0x557f82(0x1f6)),await utils_1[_0x557f82(0x1f1)](this['AUTH_WAIT_TIME']),this[_0x557f82(0x1f0)]();}[a180_0x213ba1(0x1b6)](){const _0x139ed3=a180_0x213ba1;return{'orgId':this['orgId'],'accessToken':this[_0x139ed3(0x1f8)],'instanceUrl':this['instanceUrl']};}async[a180_0x213ba1(0x1d4)](){const _0x55358=a180_0x213ba1;return await this[_0x55358(0x1f0)](),{'baseURL':this['instanceUrl'],'headers':{'accept':_0x55358(0x1e5),'authorization':this[_0x55358(0x1b7)]+'\x20'+this[_0x55358(0x1f8)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1[a180_0x213ba1(0x1b1)](),__metadata('design:paramtypes',[])],SalesforceAuthService),exports[a180_0x213ba1(0x200)]=SalesforceAuthService;