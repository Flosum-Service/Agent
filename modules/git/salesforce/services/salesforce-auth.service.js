function a232_0x534b(){const _0x94d3f8=['create\x20authorized\x20request\x20failed:\x20authorization\x20error','decorate','defineProperty','configurable','then','ERR_INVALID_SALESFORCE_TOKEN','__importStar','183DyPrTV','1NMbojG','Service','InvalidRefreshTokenError','hasOwnProperty','../../../../core','search','123011jBgOAU','__setModuleDefault','tokenType','metadata','../errors/invalid-refresh-token.error','typedi','joinURL','(((.+)+)+)+$','catch','Active','response','constructor','check\x20auth:\x20current\x20state\x20-\x20%s','__decorate','892179YovMIy','getOwnPropertyDescriptor','../enums/auth-state.enum','updateAccessToken','Error','salesforce','axios','instanceUrl','UnauthorizedSalesforceError','6txlqGh','SalesforceAuthService','Idle','__importDefault','setAuthDetails','39KfluDk','object','token_type','post','310AgQFdk','__metadata','data','get','AuthState','force\x20update\x20token','2257716xVlMDB','112qPRUMf','length','1195660RlQaoL','../../../../constants/errors','requestConfig','SALESFORCE_API_VERSION','authState','log','../../../shared/utils','error','accessToken','412922SmwGoV','../../../../constants','name','__esModule','create','AUTH_WAIT_TIME','11418ocqLai','default','sleep','forceUpdateToken','27128JBpUrA','access\x20token\x20updated\x20for\x20%s','../../providers/providers.tokens','toString','waitAuth','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','logger','access_token','instance_url','services/data/','call','prototype','function','writable'];a232_0x534b=function(){return _0x94d3f8;};return a232_0x534b();}const a232_0x2f5e53=a232_0x5346;(function(_0x5bb967,_0xa0c07e){const _0x42b7a9=a232_0x5346,_0x576ce3=_0x5bb967();while(!![]){try{const _0x3ab58f=parseInt(_0x42b7a9(0x90))/0x1*(parseInt(_0x42b7a9(0xc8))/0x2)+-parseInt(_0x42b7a9(0x8f))/0x3*(parseInt(_0x42b7a9(0xd2))/0x4)+-parseInt(_0x42b7a9(0xbf))/0x5*(parseInt(_0x42b7a9(0xad))/0x6)+parseInt(_0x42b7a9(0x96))/0x7*(parseInt(_0x42b7a9(0xbd))/0x8)+-parseInt(_0x42b7a9(0xa4))/0x9+-parseInt(_0x42b7a9(0xb6))/0xa*(parseInt(_0x42b7a9(0xce))/0xb)+-parseInt(_0x42b7a9(0xbc))/0xc*(-parseInt(_0x42b7a9(0xb2))/0xd);if(_0x3ab58f===_0xa0c07e)break;else _0x576ce3['push'](_0x576ce3['shift']());}catch(_0x52edbb){_0x576ce3['push'](_0x576ce3['shift']());}}}(a232_0x534b,0x38d41));const a232_0x2215cc=(function(){let _0x59a6c3=!![];return function(_0xc2c782,_0x18c880){const _0x2ca0c6=_0x59a6c3?function(){if(_0x18c880){const _0x8e8808=_0x18c880['apply'](_0xc2c782,arguments);return _0x18c880=null,_0x8e8808;}}:function(){};return _0x59a6c3=![],_0x2ca0c6;};}()),a232_0x29eef3=a232_0x2215cc(this,function(){const _0x126be7=a232_0x5346;return a232_0x29eef3[_0x126be7(0xd5)]()['search'](_0x126be7(0x9d))[_0x126be7(0xd5)]()[_0x126be7(0xa1)](a232_0x29eef3)[_0x126be7(0x95)](_0x126be7(0x9d));});a232_0x29eef3();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a232_0x2f5e53(0xcc)]?function(_0x21bb03,_0x48051f,_0x244a3d,_0x318fbb){const _0x43b869=a232_0x2f5e53;if(_0x318fbb===undefined)_0x318fbb=_0x244a3d;var _0x37c7e0=Object[_0x43b869(0xa5)](_0x48051f,_0x244a3d);(!_0x37c7e0||('get'in _0x37c7e0?!_0x48051f['__esModule']:_0x37c7e0[_0x43b869(0x87)]||_0x37c7e0[_0x43b869(0x8b)]))&&(_0x37c7e0={'enumerable':!![],'get':function(){return _0x48051f[_0x244a3d];}}),Object[_0x43b869(0x8a)](_0x21bb03,_0x318fbb,_0x37c7e0);}:function(_0x561bc4,_0x342fc5,_0x46657c,_0x1931d7){if(_0x1931d7===undefined)_0x1931d7=_0x46657c;_0x561bc4[_0x1931d7]=_0x342fc5[_0x46657c];}),__setModuleDefault=this&&this[a232_0x2f5e53(0x97)]||(Object[a232_0x2f5e53(0xcc)]?function(_0x3a68d1,_0x437baf){const _0x4d16e4=a232_0x2f5e53;Object[_0x4d16e4(0x8a)](_0x3a68d1,_0x4d16e4(0xcf),{'enumerable':!![],'value':_0x437baf});}:function(_0x4a9086,_0x5ab8a7){const _0x435476=a232_0x2f5e53;_0x4a9086[_0x435476(0xcf)]=_0x5ab8a7;}),__decorate=this&&this[a232_0x2f5e53(0xa3)]||function(_0x34b419,_0x4d70d6,_0x292afd,_0x29c7b9){const _0x17ae6a=a232_0x2f5e53;var _0x1a4a94=arguments[_0x17ae6a(0xbe)],_0x504bf0=_0x1a4a94<0x3?_0x4d70d6:_0x29c7b9===null?_0x29c7b9=Object[_0x17ae6a(0xa5)](_0x4d70d6,_0x292afd):_0x29c7b9,_0x343ccd;if(typeof Reflect===_0x17ae6a(0xb3)&&typeof Reflect[_0x17ae6a(0x89)]==='function')_0x504bf0=Reflect['decorate'](_0x34b419,_0x4d70d6,_0x292afd,_0x29c7b9);else{for(var _0x44f253=_0x34b419[_0x17ae6a(0xbe)]-0x1;_0x44f253>=0x0;_0x44f253--)if(_0x343ccd=_0x34b419[_0x44f253])_0x504bf0=(_0x1a4a94<0x3?_0x343ccd(_0x504bf0):_0x1a4a94>0x3?_0x343ccd(_0x4d70d6,_0x292afd,_0x504bf0):_0x343ccd(_0x4d70d6,_0x292afd))||_0x504bf0;}return _0x1a4a94>0x3&&_0x504bf0&&Object['defineProperty'](_0x4d70d6,_0x292afd,_0x504bf0),_0x504bf0;},__importStar=this&&this[a232_0x2f5e53(0x8e)]||function(_0x4a336c){const _0x5b6ec9=a232_0x2f5e53;if(_0x4a336c&&_0x4a336c[_0x5b6ec9(0xcb)])return _0x4a336c;var _0xe1b2eb={};if(_0x4a336c!=null){for(var _0x571764 in _0x4a336c)if(_0x571764!=='default'&&Object[_0x5b6ec9(0x85)][_0x5b6ec9(0x93)][_0x5b6ec9(0x84)](_0x4a336c,_0x571764))__createBinding(_0xe1b2eb,_0x4a336c,_0x571764);}return __setModuleDefault(_0xe1b2eb,_0x4a336c),_0xe1b2eb;},__metadata=this&&this[a232_0x2f5e53(0xb7)]||function(_0x337b33,_0x168247){const _0x528c5c=a232_0x2f5e53;if(typeof Reflect===_0x528c5c(0xb3)&&typeof Reflect['metadata']===_0x528c5c(0x86))return Reflect[_0x528c5c(0x99)](_0x337b33,_0x168247);},__importDefault=this&&this[a232_0x2f5e53(0xb0)]||function(_0xaccd62){const _0x20b638=a232_0x2f5e53;return _0xaccd62&&_0xaccd62[_0x20b638(0xcb)]?_0xaccd62:{'default':_0xaccd62};},SalesforceAuthService_1;Object[a232_0x2f5e53(0x8a)](exports,a232_0x2f5e53(0xcb),{'value':!![]}),exports[a232_0x2f5e53(0xae)]=void 0x0;const typedi_1=__importStar(require(a232_0x2f5e53(0x9b))),errors_1=require(a232_0x2f5e53(0xc0)),core_1=require(a232_0x2f5e53(0x94)),axios_1=__importDefault(require(a232_0x2f5e53(0xaa))),utils_1=require(a232_0x2f5e53(0xc5)),invalid_refresh_token_error_1=require(a232_0x2f5e53(0x9a)),auth_state_enum_1=require(a232_0x2f5e53(0xa6)),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a232_0x2f5e53(0xc9)),providers_tokens_1=require(a232_0x2f5e53(0xd4));function a232_0x5346(_0x34b2b7,_0x3b5c35){const _0x25cd37=a232_0x534b();return a232_0x5346=function(_0x29eef3,_0x2215cc){_0x29eef3=_0x29eef3-0x84;let _0x534bd2=_0x25cd37[_0x29eef3];return _0x534bd2;},a232_0x5346(_0x34b2b7,_0x3b5c35);}let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x14795a=a232_0x2f5e53;this['AUTH_WAIT_TIME']=0x1388,this[_0x14795a(0xc3)]=auth_state_enum_1['AuthState'][_0x14795a(0xaf)],this[_0x14795a(0xd8)]=new core_1['Logger'](SalesforceAuthService_1[_0x14795a(0xca)]),this[_0x14795a(0xb1)]();}async['setAuthDetails'](){const _0x2712fb=a232_0x2f5e53;this[_0x2712fb(0xd8)][_0x2712fb(0xc4)](_0x2712fb(0xa2),auth_state_enum_1[_0x2712fb(0xba)][this[_0x2712fb(0xc3)]]);try{if(this[_0x2712fb(0xc3)]===auth_state_enum_1[_0x2712fb(0xba)]['Error'])return;if(this[_0x2712fb(0xc3)]===auth_state_enum_1[_0x2712fb(0xba)][_0x2712fb(0xaf)])await this[_0x2712fb(0xa7)]();else{const _0x2b9217=await this[_0x2712fb(0xc1)](),_0x5d88b4=await axios_1[_0x2712fb(0xcf)][_0x2712fb(0xb9)](_0x2712fb(0xdb)+constants_1[_0x2712fb(0xc2)],_0x2b9217)[_0x2712fb(0x8c)](()=>!![])[_0x2712fb(0x9e)](()=>![]);!_0x5d88b4&&await this[_0x2712fb(0xa7)]();}}catch(_0x2d61df){}}async['updateAccessToken'](){const _0x77533a=a232_0x2f5e53;var _0x2856c6,_0x141485,_0x519b08;this['logger'][_0x77533a(0xc4)]('update\x20access\x20token');try{this[_0x77533a(0xc3)]=auth_state_enum_1[_0x77533a(0xba)]['Updating'];const {refreshToken:_0x13c69a,clientId:_0x4310c8,clientSecret:_0x283fc2,loginUrl:_0x1d32ef}=typedi_1[_0x77533a(0xcf)][_0x77533a(0xb9)](providers_tokens_1['Tokens'][_0x77533a(0xa9)]),{data:_0x1cc0d9}=await axios_1[_0x77533a(0xcf)][_0x77533a(0xb5)]((0x0,utils_1[_0x77533a(0x9c)])(_0x1d32ef,'/services/oauth2/token'),null,{'params':{'grant_type':'refresh_token','refresh_token':_0x13c69a,'client_id':_0x4310c8,'client_secret':_0x283fc2}});this[_0x77533a(0xab)]=_0x1cc0d9[_0x77533a(0xda)],this['accessToken']=_0x1cc0d9[_0x77533a(0xd9)],this[_0x77533a(0x98)]=_0x1cc0d9[_0x77533a(0xb4)],this[_0x77533a(0xc3)]=auth_state_enum_1[_0x77533a(0xba)]['Active'],this[_0x77533a(0xd8)]['log'](_0x77533a(0xd3),this[_0x77533a(0xab)]);}catch(_0x4cca07){const _0x45ed2=((_0x141485=(_0x2856c6=_0x4cca07===null||_0x4cca07===void 0x0?void 0x0:_0x4cca07[_0x77533a(0xa0)])===null||_0x2856c6===void 0x0?void 0x0:_0x2856c6[_0x77533a(0xb8)])===null||_0x141485===void 0x0?void 0x0:_0x141485[_0x77533a(0xc6)])||((_0x519b08=_0x4cca07===null||_0x4cca07===void 0x0?void 0x0:_0x4cca07[_0x77533a(0xa0)])===null||_0x519b08===void 0x0?void 0x0:_0x519b08['data'])||_0x4cca07['message'];this[_0x77533a(0xd8)][_0x77533a(0xc6)]('update\x20access\x20token\x20failed:\x20%s',_0x45ed2),this[_0x77533a(0xc3)]=auth_state_enum_1[_0x77533a(0xba)]['Error'];throw new invalid_refresh_token_error_1[(_0x77533a(0x92))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async['forceUpdateToken'](){const _0x508b4c=a232_0x2f5e53;this[_0x508b4c(0xd8)][_0x508b4c(0xc4)](_0x508b4c(0xbb));if(this[_0x508b4c(0xc3)]===auth_state_enum_1[_0x508b4c(0xba)]['Updating']||this['authState']===auth_state_enum_1[_0x508b4c(0xba)][_0x508b4c(0xaf)])return await(0x0,utils_1[_0x508b4c(0xd0)])(this[_0x508b4c(0xcd)]),this[_0x508b4c(0xd1)]();if(this[_0x508b4c(0xc3)]===auth_state_enum_1[_0x508b4c(0xba)][_0x508b4c(0xa8)])throw new invalid_refresh_token_error_1[(_0x508b4c(0x92))](errors_1[_0x508b4c(0x8d)]);await this[_0x508b4c(0xa7)]();}async['waitAuth'](){const _0x4ab15f=a232_0x2f5e53;if(this[_0x4ab15f(0xc3)]===auth_state_enum_1[_0x4ab15f(0xba)][_0x4ab15f(0xa8)]){this['logger'][_0x4ab15f(0xc4)](_0x4ab15f(0x88));throw new unauthorized_salesforce_error_1[(_0x4ab15f(0xac))]();}if(this[_0x4ab15f(0xc3)]!==auth_state_enum_1['AuthState'][_0x4ab15f(0x9f)])return this['logger'][_0x4ab15f(0xc4)](_0x4ab15f(0xd7)),await(0x0,utils_1['sleep'])(this['AUTH_WAIT_TIME']),this[_0x4ab15f(0xd6)]();}['getAuthData'](){const _0x1f5753=a232_0x2f5e53;return{'orgId':this['orgId'],'accessToken':this[_0x1f5753(0xc7)],'instanceUrl':this[_0x1f5753(0xab)]};}async[a232_0x2f5e53(0xc1)](){const _0x132fd0=a232_0x2f5e53;return await this['waitAuth'](),{'baseURL':this[_0x132fd0(0xab)],'headers':{'accept':'application/json','authorization':this[_0x132fd0(0x98)]+'\x20'+this[_0x132fd0(0xc7)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a232_0x2f5e53(0x91)])(),__metadata('design:paramtypes',[])],SalesforceAuthService),exports[a232_0x2f5e53(0xae)]=SalesforceAuthService;