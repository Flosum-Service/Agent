function a243_0x1c34(_0x8f47b6,_0xbe2694){const _0x1a2940=a243_0x5c2b();return a243_0x1c34=function(_0x4a28f1,_0x34c782){_0x4a28f1=_0x4a28f1-0x149;let _0x5c2b4e=_0x1a2940[_0x4a28f1];return _0x5c2b4e;},a243_0x1c34(_0x8f47b6,_0xbe2694);}function a243_0x5c2b(){const _0x58d394=['updateAccessToken','31046256VqaPkf','instance_url','configurable','application/json','AUTH_WAIT_TIME','4610560qVxqvP','search','access_token','Tokens','instanceUrl','AuthState','log','(((.+)+)+)+$','4113504zBDFZT','246erCxQM','68803kCypya','1358912UUlxsX','name','788074aoCtip','response','orgId','Create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','../../../../core','SALESFORCE_API_VERSION','error','__importDefault','post','Active','design:paramtypes','then','catch','Idle','forceUpdateToken','hasOwnProperty','__decorate','defineProperty','InvalidRefreshTokenError','token_type','getOwnPropertyDescriptor','__createBinding','metadata','get','Update\x20access\x20token','toString','decorate','logger','object','tokenType','typedi','2LpwlUk','Error','requestConfig','../../providers/providers.tokens','Check\x20auth:\x20current\x20state\x20-\x20%s','data','joinURL','authState','getAuthData','default','call','axios','Updating','accessToken','message','waitAuth','length','../../../../constants','ERR_INVALID_SALESFORCE_TOKEN','Update\x20access\x20token\x20failed:\x20%s','writable','constructor','SalesforceAuthService','sleep','Service','../../../shared/utils','Logger','apply','__esModule','prototype','__metadata','1270281FGJxOn','Access\x20token\x20updated\x20for\x20%s','setAuthDetails','../errors/unauthorized-salesforce.error'];a243_0x5c2b=function(){return _0x58d394;};return a243_0x5c2b();}const a243_0x1b1f2d=a243_0x1c34;(function(_0x2daedd,_0x5658de){const _0x1da8cb=a243_0x1c34,_0x7c3979=_0x2daedd();while(!![]){try{const _0x2f08f7=-parseInt(_0x1da8cb(0x17d))/0x1+-parseInt(_0x1da8cb(0x19c))/0x2*(-parseInt(_0x1da8cb(0x166))/0x3)+-parseInt(_0x1da8cb(0x178))/0x4+-parseInt(_0x1da8cb(0x170))/0x5+-parseInt(_0x1da8cb(0x179))/0x6*(parseInt(_0x1da8cb(0x17a))/0x7)+-parseInt(_0x1da8cb(0x17b))/0x8+parseInt(_0x1da8cb(0x16b))/0x9;if(_0x2f08f7===_0x5658de)break;else _0x7c3979['push'](_0x7c3979['shift']());}catch(_0x74aab6){_0x7c3979['push'](_0x7c3979['shift']());}}}(a243_0x5c2b,0x891bc));const a243_0x34c782=(function(){let _0x2ddaeb=!![];return function(_0x4f0930,_0x421efc){const _0xef27b8=_0x2ddaeb?function(){const _0x260137=a243_0x1c34;if(_0x421efc){const _0x2bcb79=_0x421efc[_0x260137(0x162)](_0x4f0930,arguments);return _0x421efc=null,_0x2bcb79;}}:function(){};return _0x2ddaeb=![],_0xef27b8;};}()),a243_0x4a28f1=a243_0x34c782(this,function(){const _0x1a4838=a243_0x1c34;return a243_0x4a28f1[_0x1a4838(0x196)]()[_0x1a4838(0x171)](_0x1a4838(0x177))[_0x1a4838(0x196)]()[_0x1a4838(0x15c)](a243_0x4a28f1)[_0x1a4838(0x171)]('(((.+)+)+)+$');});a243_0x4a28f1();'use strict';var __createBinding=this&&this[a243_0x1b1f2d(0x192)]||(Object['create']?function(_0x13361b,_0x45df36,_0x57f99f,_0x334603){const _0x550acf=a243_0x1b1f2d;if(_0x334603===undefined)_0x334603=_0x57f99f;var _0x498b04=Object['getOwnPropertyDescriptor'](_0x45df36,_0x57f99f);(!_0x498b04||(_0x550acf(0x194)in _0x498b04?!_0x45df36[_0x550acf(0x163)]:_0x498b04[_0x550acf(0x15b)]||_0x498b04[_0x550acf(0x16d)]))&&(_0x498b04={'enumerable':!![],'get':function(){return _0x45df36[_0x57f99f];}}),Object[_0x550acf(0x18e)](_0x13361b,_0x334603,_0x498b04);}:function(_0x536b96,_0x48c1ca,_0x40a5b9,_0x125d46){if(_0x125d46===undefined)_0x125d46=_0x40a5b9;_0x536b96[_0x125d46]=_0x48c1ca[_0x40a5b9];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x2b5d9f,_0x4a94b0){const _0xccc8f9=a243_0x1b1f2d;Object[_0xccc8f9(0x18e)](_0x2b5d9f,'default',{'enumerable':!![],'value':_0x4a94b0});}:function(_0x4f79ac,_0x2f9a2d){const _0x20a4d7=a243_0x1b1f2d;_0x4f79ac[_0x20a4d7(0x150)]=_0x2f9a2d;}),__decorate=this&&this[a243_0x1b1f2d(0x18d)]||function(_0x3981da,_0x3c4afd,_0x43f76e,_0xd8c9ab){const _0x924f80=a243_0x1b1f2d;var _0x48ab12=arguments[_0x924f80(0x157)],_0x94f471=_0x48ab12<0x3?_0x3c4afd:_0xd8c9ab===null?_0xd8c9ab=Object[_0x924f80(0x191)](_0x3c4afd,_0x43f76e):_0xd8c9ab,_0x2434f1;if(typeof Reflect===_0x924f80(0x199)&&typeof Reflect[_0x924f80(0x197)]==='function')_0x94f471=Reflect[_0x924f80(0x197)](_0x3981da,_0x3c4afd,_0x43f76e,_0xd8c9ab);else{for(var _0x8ef0f1=_0x3981da[_0x924f80(0x157)]-0x1;_0x8ef0f1>=0x0;_0x8ef0f1--)if(_0x2434f1=_0x3981da[_0x8ef0f1])_0x94f471=(_0x48ab12<0x3?_0x2434f1(_0x94f471):_0x48ab12>0x3?_0x2434f1(_0x3c4afd,_0x43f76e,_0x94f471):_0x2434f1(_0x3c4afd,_0x43f76e))||_0x94f471;}return _0x48ab12>0x3&&_0x94f471&&Object[_0x924f80(0x18e)](_0x3c4afd,_0x43f76e,_0x94f471),_0x94f471;},__importStar=this&&this['__importStar']||function(_0x51c5d1){const _0x232d04=a243_0x1b1f2d;if(_0x51c5d1&&_0x51c5d1['__esModule'])return _0x51c5d1;var _0x1bd2ce={};if(_0x51c5d1!=null){for(var _0x1e3c27 in _0x51c5d1)if(_0x1e3c27!==_0x232d04(0x150)&&Object[_0x232d04(0x164)][_0x232d04(0x18c)][_0x232d04(0x151)](_0x51c5d1,_0x1e3c27))__createBinding(_0x1bd2ce,_0x51c5d1,_0x1e3c27);}return __setModuleDefault(_0x1bd2ce,_0x51c5d1),_0x1bd2ce;},__metadata=this&&this[a243_0x1b1f2d(0x165)]||function(_0x5d6a47,_0xd5661){const _0x5c6ca8=a243_0x1b1f2d;if(typeof Reflect===_0x5c6ca8(0x199)&&typeof Reflect[_0x5c6ca8(0x193)]==='function')return Reflect[_0x5c6ca8(0x193)](_0x5d6a47,_0xd5661);},__importDefault=this&&this[a243_0x1b1f2d(0x184)]||function(_0x309fc8){const _0x4f462d=a243_0x1b1f2d;return _0x309fc8&&_0x309fc8[_0x4f462d(0x163)]?_0x309fc8:{'default':_0x309fc8};},SalesforceAuthService_1;Object[a243_0x1b1f2d(0x18e)](exports,'__esModule',{'value':!![]}),exports[a243_0x1b1f2d(0x15d)]=void 0x0;const typedi_1=__importStar(require(a243_0x1b1f2d(0x19b))),errors_1=require('../../../../constants/errors'),core_1=require(a243_0x1b1f2d(0x181)),axios_1=__importDefault(require(a243_0x1b1f2d(0x152))),utils_1=require(a243_0x1b1f2d(0x160)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require(a243_0x1b1f2d(0x169)),constants_1=require(a243_0x1b1f2d(0x158)),providers_tokens_1=require(a243_0x1b1f2d(0x14a));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x4ae9e8=a243_0x1b1f2d;this[_0x4ae9e8(0x16f)]=0x1388,this[_0x4ae9e8(0x14e)]=auth_state_enum_1[_0x4ae9e8(0x175)][_0x4ae9e8(0x18a)],this[_0x4ae9e8(0x198)]=new core_1[(_0x4ae9e8(0x161))](SalesforceAuthService_1[_0x4ae9e8(0x17c)]),this[_0x4ae9e8(0x168)]();}async[a243_0x1b1f2d(0x168)](){const _0x3af1fb=a243_0x1b1f2d;this[_0x3af1fb(0x198)][_0x3af1fb(0x176)](_0x3af1fb(0x14b),auth_state_enum_1[_0x3af1fb(0x175)][this['authState']]);try{if(this[_0x3af1fb(0x14e)]===auth_state_enum_1['AuthState']['Error'])return;if(this[_0x3af1fb(0x14e)]===auth_state_enum_1[_0x3af1fb(0x175)][_0x3af1fb(0x18a)])await this[_0x3af1fb(0x16a)]();else{const _0x263166=await this[_0x3af1fb(0x149)](),_0xd95dfd=await axios_1[_0x3af1fb(0x150)][_0x3af1fb(0x194)]('services/data/'+constants_1[_0x3af1fb(0x182)],_0x263166)[_0x3af1fb(0x188)](()=>!![])[_0x3af1fb(0x189)](()=>![]);!_0xd95dfd&&await this['updateAccessToken']();}}catch(_0x930218){}}async[a243_0x1b1f2d(0x16a)](){const _0x103ea1=a243_0x1b1f2d;var _0x514a68,_0x427be6,_0x2e7ea5;this['logger'][_0x103ea1(0x176)](_0x103ea1(0x195));try{this[_0x103ea1(0x14e)]=auth_state_enum_1[_0x103ea1(0x175)][_0x103ea1(0x153)];const {refreshToken:_0x484956,clientId:_0x135295,clientSecret:_0x3d9f33,loginUrl:_0x406238}=typedi_1['default'][_0x103ea1(0x194)](providers_tokens_1[_0x103ea1(0x173)]['salesforce']),{data:_0x512db4}=await axios_1[_0x103ea1(0x150)][_0x103ea1(0x185)]((0x0,utils_1[_0x103ea1(0x14d)])(_0x406238,'/services/oauth2/token'),null,{'params':{'grant_type':'refresh_token','refresh_token':_0x484956,'client_id':_0x135295,'client_secret':_0x3d9f33}});this['instanceUrl']=_0x512db4[_0x103ea1(0x16c)],this['accessToken']=_0x512db4[_0x103ea1(0x172)],this['tokenType']=_0x512db4[_0x103ea1(0x190)],this[_0x103ea1(0x14e)]=auth_state_enum_1[_0x103ea1(0x175)][_0x103ea1(0x186)],this[_0x103ea1(0x198)][_0x103ea1(0x176)](_0x103ea1(0x167),this[_0x103ea1(0x174)]);}catch(_0x3d2e81){const _0x644d2a=((_0x427be6=(_0x514a68=_0x3d2e81===null||_0x3d2e81===void 0x0?void 0x0:_0x3d2e81[_0x103ea1(0x17e)])===null||_0x514a68===void 0x0?void 0x0:_0x514a68[_0x103ea1(0x14c)])===null||_0x427be6===void 0x0?void 0x0:_0x427be6[_0x103ea1(0x183)])||((_0x2e7ea5=_0x3d2e81===null||_0x3d2e81===void 0x0?void 0x0:_0x3d2e81[_0x103ea1(0x17e)])===null||_0x2e7ea5===void 0x0?void 0x0:_0x2e7ea5[_0x103ea1(0x14c)])||_0x3d2e81[_0x103ea1(0x155)];this[_0x103ea1(0x198)]['error'](_0x103ea1(0x15a),_0x644d2a),this[_0x103ea1(0x14e)]=auth_state_enum_1[_0x103ea1(0x175)][_0x103ea1(0x19d)];throw new invalid_refresh_token_error_1[(_0x103ea1(0x18f))](errors_1[_0x103ea1(0x159)]);}}async[a243_0x1b1f2d(0x18b)](){const _0x258efc=a243_0x1b1f2d;this[_0x258efc(0x198)][_0x258efc(0x176)]('Force\x20update\x20token');if(this['authState']===auth_state_enum_1['AuthState'][_0x258efc(0x153)]||this[_0x258efc(0x14e)]===auth_state_enum_1['AuthState'][_0x258efc(0x18a)])return await(0x0,utils_1[_0x258efc(0x15e)])(this[_0x258efc(0x16f)]),this['forceUpdateToken']();if(this['authState']===auth_state_enum_1['AuthState'][_0x258efc(0x19d)])throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0x258efc(0x16a)]();}async[a243_0x1b1f2d(0x156)](){const _0x44f3ab=a243_0x1b1f2d;if(this[_0x44f3ab(0x14e)]===auth_state_enum_1[_0x44f3ab(0x175)][_0x44f3ab(0x19d)]){this[_0x44f3ab(0x198)][_0x44f3ab(0x176)]('Create\x20authorized\x20request\x20failed:\x20authorization\x20error');throw new unauthorized_salesforce_error_1['UnauthorizedSalesforceError']();}if(this[_0x44f3ab(0x14e)]!==auth_state_enum_1['AuthState'][_0x44f3ab(0x186)])return this['logger'][_0x44f3ab(0x176)](_0x44f3ab(0x180)),await(0x0,utils_1[_0x44f3ab(0x15e)])(this[_0x44f3ab(0x16f)]),this[_0x44f3ab(0x156)]();}[a243_0x1b1f2d(0x14f)](){const _0x29662a=a243_0x1b1f2d;return{'orgId':this[_0x29662a(0x17f)],'accessToken':this[_0x29662a(0x154)],'instanceUrl':this[_0x29662a(0x174)]};}async[a243_0x1b1f2d(0x149)](){const _0x5986ae=a243_0x1b1f2d;return await this[_0x5986ae(0x156)](),{'baseURL':this[_0x5986ae(0x174)],'headers':{'accept':_0x5986ae(0x16e),'authorization':this[_0x5986ae(0x19a)]+'\x20'+this['accessToken']}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a243_0x1b1f2d(0x15f)])(),__metadata(a243_0x1b1f2d(0x187),[])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;