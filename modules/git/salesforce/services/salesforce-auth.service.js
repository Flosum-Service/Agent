const a193_0x3b18b8=a193_0x3f95;function a193_0x3f95(_0x1e6c62,_0x5e686b){const _0x493fb4=a193_0x5ebb();return a193_0x3f95=function(_0x366c6f,_0x38b465){_0x366c6f=_0x366c6f-0xbf;let _0x5ebbb1=_0x493fb4[_0x366c6f];return _0x5ebbb1;},a193_0x3f95(_0x1e6c62,_0x5e686b);}(function(_0x3beb9b,_0x24b668){const _0x1406af=a193_0x3f95,_0x22caa5=_0x3beb9b();while(!![]){try{const _0x5a94ad=-parseInt(_0x1406af(0xe8))/0x1+parseInt(_0x1406af(0xfc))/0x2+-parseInt(_0x1406af(0x10a))/0x3*(-parseInt(_0x1406af(0xf8))/0x4)+-parseInt(_0x1406af(0xd4))/0x5*(parseInt(_0x1406af(0xd3))/0x6)+parseInt(_0x1406af(0xf6))/0x7+-parseInt(_0x1406af(0xc7))/0x8+parseInt(_0x1406af(0xf5))/0x9*(parseInt(_0x1406af(0xdc))/0xa);if(_0x5a94ad===_0x24b668)break;else _0x22caa5['push'](_0x22caa5['shift']());}catch(_0x161081){_0x22caa5['push'](_0x22caa5['shift']());}}}(a193_0x5ebb,0xaf2d2));const a193_0x38b465=(function(){let _0x357c5c=!![];return function(_0x1a5f9f,_0x478dfa){const _0x3b1541=_0x357c5c?function(){if(_0x478dfa){const _0x54b1bc=_0x478dfa['apply'](_0x1a5f9f,arguments);return _0x478dfa=null,_0x54b1bc;}}:function(){};return _0x357c5c=![],_0x3b1541;};}()),a193_0x366c6f=a193_0x38b465(this,function(){const _0x2f8550=a193_0x3f95;return a193_0x366c6f['toString']()[_0x2f8550(0xe0)](_0x2f8550(0xf4))[_0x2f8550(0xc2)]()[_0x2f8550(0xdd)](a193_0x366c6f)[_0x2f8550(0xe0)](_0x2f8550(0xf4));});a193_0x366c6f();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a193_0x3b18b8(0xd8)]?function(_0x5249fc,_0x2e7c25,_0x3a3aa1,_0x2ec865){const _0x2b62b7=a193_0x3b18b8;if(_0x2ec865===undefined)_0x2ec865=_0x3a3aa1;var _0xb5df65=Object[_0x2b62b7(0x100)](_0x2e7c25,_0x3a3aa1);(!_0xb5df65||('get'in _0xb5df65?!_0x2e7c25[_0x2b62b7(0xd1)]:_0xb5df65[_0x2b62b7(0xd0)]||_0xb5df65[_0x2b62b7(0xdb)]))&&(_0xb5df65={'enumerable':!![],'get':function(){return _0x2e7c25[_0x3a3aa1];}}),Object['defineProperty'](_0x5249fc,_0x2ec865,_0xb5df65);}:function(_0x2ccccb,_0x242c7d,_0x5d7d59,_0x3c9a93){if(_0x3c9a93===undefined)_0x3c9a93=_0x5d7d59;_0x2ccccb[_0x3c9a93]=_0x242c7d[_0x5d7d59];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a193_0x3b18b8(0xd8)]?function(_0x1fe2a1,_0x551f6c){const _0xd452ac=a193_0x3b18b8;Object[_0xd452ac(0xed)](_0x1fe2a1,'default',{'enumerable':!![],'value':_0x551f6c});}:function(_0x3e1830,_0x4b1b17){const _0x30fe3a=a193_0x3b18b8;_0x3e1830[_0x30fe3a(0xc3)]=_0x4b1b17;}),__decorate=this&&this[a193_0x3b18b8(0xde)]||function(_0x1bc835,_0x3f20ca,_0x365783,_0xfd99a3){const _0xdf0e30=a193_0x3b18b8;var _0x85c777=arguments[_0xdf0e30(0xe3)],_0x1847d4=_0x85c777<0x3?_0x3f20ca:_0xfd99a3===null?_0xfd99a3=Object[_0xdf0e30(0x100)](_0x3f20ca,_0x365783):_0xfd99a3,_0x1ef1f5;if(typeof Reflect===_0xdf0e30(0xe6)&&typeof Reflect[_0xdf0e30(0xda)]==='function')_0x1847d4=Reflect[_0xdf0e30(0xda)](_0x1bc835,_0x3f20ca,_0x365783,_0xfd99a3);else{for(var _0x1119e6=_0x1bc835[_0xdf0e30(0xe3)]-0x1;_0x1119e6>=0x0;_0x1119e6--)if(_0x1ef1f5=_0x1bc835[_0x1119e6])_0x1847d4=(_0x85c777<0x3?_0x1ef1f5(_0x1847d4):_0x85c777>0x3?_0x1ef1f5(_0x3f20ca,_0x365783,_0x1847d4):_0x1ef1f5(_0x3f20ca,_0x365783))||_0x1847d4;}return _0x85c777>0x3&&_0x1847d4&&Object[_0xdf0e30(0xed)](_0x3f20ca,_0x365783,_0x1847d4),_0x1847d4;},__importStar=this&&this[a193_0x3b18b8(0xe7)]||function(_0x4090c5){const _0x172e58=a193_0x3b18b8;if(_0x4090c5&&_0x4090c5['__esModule'])return _0x4090c5;var _0x1c6549={};if(_0x4090c5!=null){for(var _0x390185 in _0x4090c5)if(_0x390185!==_0x172e58(0xc3)&&Object[_0x172e58(0xc8)]['hasOwnProperty']['call'](_0x4090c5,_0x390185))__createBinding(_0x1c6549,_0x4090c5,_0x390185);}return __setModuleDefault(_0x1c6549,_0x4090c5),_0x1c6549;},__metadata=this&&this[a193_0x3b18b8(0xfa)]||function(_0x419cfc,_0x32f650){const _0x17196b=a193_0x3b18b8;if(typeof Reflect===_0x17196b(0xe6)&&typeof Reflect[_0x17196b(0xf3)]===_0x17196b(0xfd))return Reflect[_0x17196b(0xf3)](_0x419cfc,_0x32f650);},__importDefault=this&&this['__importDefault']||function(_0x399fc7){const _0x328caa=a193_0x3b18b8;return _0x399fc7&&_0x399fc7[_0x328caa(0xd1)]?_0x399fc7:{'default':_0x399fc7};},SalesforceAuthService_1;Object[a193_0x3b18b8(0xed)](exports,'__esModule',{'value':!![]}),exports[a193_0x3b18b8(0xec)]=void 0x0;const typedi_1=__importStar(require('typedi')),errors_1=require(a193_0x3b18b8(0x109)),core_1=require(a193_0x3b18b8(0xff)),axios_1=__importDefault(require(a193_0x3b18b8(0x104))),utils_1=require(a193_0x3b18b8(0x102)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require(a193_0x3b18b8(0xf1)),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a193_0x3b18b8(0x10d)),providers_tokens_1=require('../../providers/providers.tokens');let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x365085=a193_0x3b18b8;this[_0x365085(0xc0)]=0x1388,this[_0x365085(0xd5)]=auth_state_enum_1[_0x365085(0xeb)][_0x365085(0x108)],this[_0x365085(0xd9)]=new core_1['Logger'](SalesforceAuthService_1[_0x365085(0x107)]),this[_0x365085(0xf2)]();}async[a193_0x3b18b8(0xf2)](){const _0x21d247=a193_0x3b18b8;this[_0x21d247(0xd9)][_0x21d247(0x105)](_0x21d247(0x10c),auth_state_enum_1[_0x21d247(0xeb)][this[_0x21d247(0xd5)]]);try{if(this[_0x21d247(0xd5)]===auth_state_enum_1['AuthState'][_0x21d247(0x10e)])return;if(this[_0x21d247(0xd5)]===auth_state_enum_1[_0x21d247(0xeb)][_0x21d247(0x108)])await this[_0x21d247(0xc9)]();else{const _0x4b3326=await this[_0x21d247(0xfb)](),_0x58710c=await axios_1[_0x21d247(0xc3)][_0x21d247(0xd2)](_0x21d247(0xbf)+constants_1[_0x21d247(0x10b)],_0x4b3326)['then'](()=>!![])[_0x21d247(0xe5)](()=>![]);!_0x58710c&&await this[_0x21d247(0xc9)]();}}catch(_0x159a2f){}}async[a193_0x3b18b8(0xc9)](){const _0x430b4c=a193_0x3b18b8;var _0x43955e,_0x3345b0,_0x143bb6;this[_0x430b4c(0xd9)]['log'](_0x430b4c(0xcb));try{this[_0x430b4c(0xd5)]=auth_state_enum_1[_0x430b4c(0xeb)][_0x430b4c(0xe4)];const {refreshToken:_0x700dd5,clientId:_0x181e95,clientSecret:_0x387c6d,loginUrl:_0x3a5065}=typedi_1['default']['get'](providers_tokens_1[_0x430b4c(0xf0)][_0x430b4c(0xc6)]),{data:_0xcc0bd9}=await axios_1['default']['post']((0x0,utils_1[_0x430b4c(0xce)])(_0x3a5065,_0x430b4c(0x103)),null,{'params':{'grant_type':_0x430b4c(0xee),'refresh_token':_0x700dd5,'client_id':_0x181e95,'client_secret':_0x387c6d}});this[_0x430b4c(0xdf)]=_0xcc0bd9['instance_url'],this[_0x430b4c(0xef)]=_0xcc0bd9['access_token'],this[_0x430b4c(0xc1)]=_0xcc0bd9['token_type'],this[_0x430b4c(0xd5)]=auth_state_enum_1[_0x430b4c(0xeb)][_0x430b4c(0xf9)],this[_0x430b4c(0xd9)][_0x430b4c(0x105)]('access\x20token\x20updated\x20for\x20%s',this[_0x430b4c(0xdf)]);}catch(_0x1a4fb4){const _0x2d9696=((_0x3345b0=(_0x43955e=_0x1a4fb4===null||_0x1a4fb4===void 0x0?void 0x0:_0x1a4fb4['response'])===null||_0x43955e===void 0x0?void 0x0:_0x43955e[_0x430b4c(0xd6)])===null||_0x3345b0===void 0x0?void 0x0:_0x3345b0['error'])||((_0x143bb6=_0x1a4fb4===null||_0x1a4fb4===void 0x0?void 0x0:_0x1a4fb4[_0x430b4c(0xfe)])===null||_0x143bb6===void 0x0?void 0x0:_0x143bb6[_0x430b4c(0xd6)])||_0x1a4fb4['message'];this[_0x430b4c(0xd9)]['error'](_0x430b4c(0xcf),_0x2d9696),this[_0x430b4c(0xd5)]=auth_state_enum_1[_0x430b4c(0xeb)]['Error'];throw new invalid_refresh_token_error_1[(_0x430b4c(0xea))](errors_1[_0x430b4c(0xcd)]);}}async[a193_0x3b18b8(0xe1)](){const _0x160370=a193_0x3b18b8;this[_0x160370(0xd9)][_0x160370(0x105)](_0x160370(0x106));if(this[_0x160370(0xd5)]===auth_state_enum_1[_0x160370(0xeb)][_0x160370(0xe4)]||this['authState']===auth_state_enum_1[_0x160370(0xeb)][_0x160370(0x108)])return await(0x0,utils_1[_0x160370(0xc4)])(this[_0x160370(0xc0)]),this['forceUpdateToken']();if(this[_0x160370(0xd5)]===auth_state_enum_1[_0x160370(0xeb)][_0x160370(0x10e)])throw new invalid_refresh_token_error_1[(_0x160370(0xea))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0x160370(0xc9)]();}async['waitAuth'](){const _0x3ea621=a193_0x3b18b8;if(this[_0x3ea621(0xd5)]===auth_state_enum_1[_0x3ea621(0xeb)][_0x3ea621(0x10e)]){this['logger'][_0x3ea621(0x105)](_0x3ea621(0xd7));throw new unauthorized_salesforce_error_1[(_0x3ea621(0xe9))]();}if(this[_0x3ea621(0xd5)]!==auth_state_enum_1[_0x3ea621(0xeb)][_0x3ea621(0xf9)])return this[_0x3ea621(0xd9)][_0x3ea621(0x105)](_0x3ea621(0xca)),await(0x0,utils_1[_0x3ea621(0xc4)])(this[_0x3ea621(0xc0)]),this[_0x3ea621(0xf7)]();}[a193_0x3b18b8(0x101)](){const _0x1f90a6=a193_0x3b18b8;return{'orgId':this[_0x1f90a6(0xc5)],'accessToken':this['accessToken'],'instanceUrl':this[_0x1f90a6(0xdf)]};}async['requestConfig'](){const _0x4b1cfc=a193_0x3b18b8;return await this['waitAuth'](),{'baseURL':this[_0x4b1cfc(0xdf)],'headers':{'accept':'application/json','authorization':this[_0x4b1cfc(0xc1)]+'\x20'+this['accessToken']}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a193_0x3b18b8(0xe2)])(),__metadata(a193_0x3b18b8(0xcc),[])],SalesforceAuthService),exports[a193_0x3b18b8(0xec)]=SalesforceAuthService;function a193_0x5ebb(){const _0x44d644=['AuthState','SalesforceAuthService','defineProperty','refresh_token','accessToken','Tokens','../enums/auth-state.enum','setAuthDetails','metadata','(((.+)+)+)+$','2907jdudXq','1478953DVdCWE','waitAuth','12TaFkTs','Active','__metadata','requestConfig','506732DKKeiM','function','response','../../../../core','getOwnPropertyDescriptor','getAuthData','../../../shared/utils','/services/oauth2/token','axios','log','force\x20update\x20token','name','Idle','../../../../constants/errors','106839cQWAaq','SALESFORCE_API_VERSION','check\x20auth:\x20current\x20state\x20-\x20%s','../../../../constants','Error','services/data/','AUTH_WAIT_TIME','tokenType','toString','default','sleep','orgId','salesforce','6842248lCIVPo','prototype','updateAccessToken','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','update\x20access\x20token','design:paramtypes','ERR_INVALID_SALESFORCE_TOKEN','joinURL','update\x20access\x20token\x20failed:\x20%s','writable','__esModule','get','42OxvGbN','402085gTshac','authState','data','create\x20authorized\x20request\x20failed:\x20authorization\x20error','create','logger','decorate','configurable','54370BPotjT','constructor','__decorate','instanceUrl','search','forceUpdateToken','Service','length','Updating','catch','object','__importStar','191913LiOgDI','UnauthorizedSalesforceError','InvalidRefreshTokenError'];a193_0x5ebb=function(){return _0x44d644;};return a193_0x5ebb();}