const a193_0x52079a=a193_0x3544;(function(_0x4dee99,_0x43a0e4){const _0x212abf=a193_0x3544,_0x5e1bc5=_0x4dee99();while(!![]){try{const _0xd38a2d=-parseInt(_0x212abf(0x205))/0x1*(-parseInt(_0x212abf(0x1e1))/0x2)+-parseInt(_0x212abf(0x1c8))/0x3*(-parseInt(_0x212abf(0x1e4))/0x4)+parseInt(_0x212abf(0x1f7))/0x5*(parseInt(_0x212abf(0x1c9))/0x6)+-parseInt(_0x212abf(0x1ca))/0x7*(parseInt(_0x212abf(0x1db))/0x8)+parseInt(_0x212abf(0x1e0))/0x9+-parseInt(_0x212abf(0x1f2))/0xa+parseInt(_0x212abf(0x20c))/0xb*(-parseInt(_0x212abf(0x1c4))/0xc);if(_0xd38a2d===_0x43a0e4)break;else _0x5e1bc5['push'](_0x5e1bc5['shift']());}catch(_0x315414){_0x5e1bc5['push'](_0x5e1bc5['shift']());}}}(a193_0x572d,0x84444));const a193_0x599c2f=(function(){let _0xead1a3=!![];return function(_0x2af6b5,_0x87832f){const _0x3e6d3c=_0xead1a3?function(){const _0xece40d=a193_0x3544;if(_0x87832f){const _0x441e77=_0x87832f[_0xece40d(0x1f5)](_0x2af6b5,arguments);return _0x87832f=null,_0x441e77;}}:function(){};return _0xead1a3=![],_0x3e6d3c;};}()),a193_0x54a865=a193_0x599c2f(this,function(){const _0x5607ef=a193_0x3544;return a193_0x54a865[_0x5607ef(0x1e9)]()['search'](_0x5607ef(0x1fc))['toString']()[_0x5607ef(0x1f0)](a193_0x54a865)[_0x5607ef(0x203)]('(((.+)+)+)+$');});function a193_0x3544(_0x51118f,_0x4d0fb2){const _0x59c3a0=a193_0x572d();return a193_0x3544=function(_0x54a865,_0x599c2f){_0x54a865=_0x54a865-0x1c1;let _0x572d25=_0x59c3a0[_0x54a865];return _0x572d25;},a193_0x3544(_0x51118f,_0x4d0fb2);}a193_0x54a865();'use strict';var __createBinding=this&&this[a193_0x52079a(0x1d6)]||(Object[a193_0x52079a(0x1c2)]?function(_0x52fc81,_0x5bc041,_0x5ba9c9,_0x27bd3a){const _0x4f7f91=a193_0x52079a;if(_0x27bd3a===undefined)_0x27bd3a=_0x5ba9c9;var _0x3f0f04=Object[_0x4f7f91(0x1eb)](_0x5bc041,_0x5ba9c9);(!_0x3f0f04||(_0x4f7f91(0x1d9)in _0x3f0f04?!_0x5bc041[_0x4f7f91(0x1fa)]:_0x3f0f04[_0x4f7f91(0x1cb)]||_0x3f0f04[_0x4f7f91(0x215)]))&&(_0x3f0f04={'enumerable':!![],'get':function(){return _0x5bc041[_0x5ba9c9];}}),Object[_0x4f7f91(0x214)](_0x52fc81,_0x27bd3a,_0x3f0f04);}:function(_0x30cdf8,_0x4c6176,_0xb6da88,_0x2a1dad){if(_0x2a1dad===undefined)_0x2a1dad=_0xb6da88;_0x30cdf8[_0x2a1dad]=_0x4c6176[_0xb6da88];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a193_0x52079a(0x1c2)]?function(_0x2cb219,_0x2bdaaf){const _0x3ac31e=a193_0x52079a;Object[_0x3ac31e(0x214)](_0x2cb219,'default',{'enumerable':!![],'value':_0x2bdaaf});}:function(_0x14bcf9,_0x2d4af5){const _0x3f01f0=a193_0x52079a;_0x14bcf9[_0x3f01f0(0x1ea)]=_0x2d4af5;}),__decorate=this&&this[a193_0x52079a(0x204)]||function(_0x59b99e,_0x589038,_0x4ac03,_0x1f89c6){const _0x552a41=a193_0x52079a;var _0x5231bc=arguments[_0x552a41(0x1e2)],_0x3c314f=_0x5231bc<0x3?_0x589038:_0x1f89c6===null?_0x1f89c6=Object[_0x552a41(0x1eb)](_0x589038,_0x4ac03):_0x1f89c6,_0x1b426e;if(typeof Reflect===_0x552a41(0x1e3)&&typeof Reflect[_0x552a41(0x1f4)]===_0x552a41(0x1cf))_0x3c314f=Reflect[_0x552a41(0x1f4)](_0x59b99e,_0x589038,_0x4ac03,_0x1f89c6);else{for(var _0x352d93=_0x59b99e[_0x552a41(0x1e2)]-0x1;_0x352d93>=0x0;_0x352d93--)if(_0x1b426e=_0x59b99e[_0x352d93])_0x3c314f=(_0x5231bc<0x3?_0x1b426e(_0x3c314f):_0x5231bc>0x3?_0x1b426e(_0x589038,_0x4ac03,_0x3c314f):_0x1b426e(_0x589038,_0x4ac03))||_0x3c314f;}return _0x5231bc>0x3&&_0x3c314f&&Object[_0x552a41(0x214)](_0x589038,_0x4ac03,_0x3c314f),_0x3c314f;},__importStar=this&&this[a193_0x52079a(0x1e7)]||function(_0x18d9e3){const _0x380971=a193_0x52079a;if(_0x18d9e3&&_0x18d9e3[_0x380971(0x1fa)])return _0x18d9e3;var _0x525b9b={};if(_0x18d9e3!=null){for(var _0x3506af in _0x18d9e3)if(_0x3506af!==_0x380971(0x1ea)&&Object[_0x380971(0x1c1)][_0x380971(0x1fb)]['call'](_0x18d9e3,_0x3506af))__createBinding(_0x525b9b,_0x18d9e3,_0x3506af);}return __setModuleDefault(_0x525b9b,_0x18d9e3),_0x525b9b;},__metadata=this&&this[a193_0x52079a(0x1f9)]||function(_0x4f5481,_0x2dc5b2){const _0x248782=a193_0x52079a;if(typeof Reflect===_0x248782(0x1e3)&&typeof Reflect[_0x248782(0x1f1)]===_0x248782(0x1cf))return Reflect['metadata'](_0x4f5481,_0x2dc5b2);},__importDefault=this&&this['__importDefault']||function(_0x21cd12){const _0x5bdf77=a193_0x52079a;return _0x21cd12&&_0x21cd12[_0x5bdf77(0x1fa)]?_0x21cd12:{'default':_0x21cd12};},SalesforceAuthService_1;function a193_0x572d(){const _0x3fce76=['data','log','../../../../constants','Updating','access_token','77ielHcz','instance_url','services/data/','Logger','design:paramtypes','Tokens','create\x20authorized\x20request\x20failed:\x20authorization\x20error','waitAuth','defineProperty','configurable','accessToken','post','Idle','prototype','create','AUTH_WAIT_TIME','1925844xgGnbp','SALESFORCE_API_VERSION','axios','forceUpdateToken','314892RKeIJr','572682XaFLcN','7isxoGj','writable','../enums/auth-state.enum','catch','../../../../constants/errors','function','authState','ERR_INVALID_SALESFORCE_TOKEN','error','logger','force\x20update\x20token','updateAccessToken','__createBinding','../errors/unauthorized-salesforce.error','name','get','message','1979752KPARvI','update\x20access\x20token','orgId','instanceUrl','access\x20token\x20updated\x20for\x20%s','4135851gYjaGC','222734JoWaVG','length','object','12ZeOTxn','update\x20access\x20token\x20failed:\x20%s','response','__importStar','Service','toString','default','getOwnPropertyDescriptor','../../providers/providers.tokens','Error','InvalidRefreshTokenError','setAuthDetails','constructor','metadata','5003810CsyJMd','Active','decorate','apply','AuthState','45HqrFrk','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','__metadata','__esModule','hasOwnProperty','(((.+)+)+)+$','check\x20auth:\x20current\x20state\x20-\x20%s','sleep','then','typedi','../errors/invalid-refresh-token.error','requestConfig','search','__decorate','7ZBchip','SalesforceAuthService'];a193_0x572d=function(){return _0x3fce76;};return a193_0x572d();}Object[a193_0x52079a(0x214)](exports,'__esModule',{'value':!![]}),exports[a193_0x52079a(0x206)]=void 0x0;const typedi_1=__importStar(require(a193_0x52079a(0x200))),errors_1=require(a193_0x52079a(0x1ce)),core_1=require('../../../../core'),axios_1=__importDefault(require(a193_0x52079a(0x1c6))),utils_1=require('../../../shared/utils'),invalid_refresh_token_error_1=require(a193_0x52079a(0x201)),auth_state_enum_1=require(a193_0x52079a(0x1cc)),unauthorized_salesforce_error_1=require(a193_0x52079a(0x1d7)),constants_1=require(a193_0x52079a(0x209)),providers_tokens_1=require(a193_0x52079a(0x1ec));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x50df79=a193_0x52079a;this['AUTH_WAIT_TIME']=0x1388,this[_0x50df79(0x1d0)]=auth_state_enum_1[_0x50df79(0x1f6)][_0x50df79(0x218)],this[_0x50df79(0x1d3)]=new core_1[(_0x50df79(0x20f))](SalesforceAuthService_1[_0x50df79(0x1d8)]),this[_0x50df79(0x1ef)]();}async['setAuthDetails'](){const _0x3bd4dd=a193_0x52079a;this[_0x3bd4dd(0x1d3)][_0x3bd4dd(0x208)](_0x3bd4dd(0x1fd),auth_state_enum_1[_0x3bd4dd(0x1f6)][this[_0x3bd4dd(0x1d0)]]);try{if(this['authState']===auth_state_enum_1[_0x3bd4dd(0x1f6)][_0x3bd4dd(0x1ed)])return;if(this[_0x3bd4dd(0x1d0)]===auth_state_enum_1['AuthState'][_0x3bd4dd(0x218)])await this['updateAccessToken']();else{const _0x561e93=await this[_0x3bd4dd(0x202)](),_0x293966=await axios_1[_0x3bd4dd(0x1ea)]['get'](_0x3bd4dd(0x20e)+constants_1[_0x3bd4dd(0x1c5)],_0x561e93)[_0x3bd4dd(0x1ff)](()=>!![])[_0x3bd4dd(0x1cd)](()=>![]);!_0x293966&&await this[_0x3bd4dd(0x1d5)]();}}catch(_0x3043e6){}}async['updateAccessToken'](){const _0x295e8e=a193_0x52079a;var _0x405294,_0x1ac2f4,_0xc0d5c;this[_0x295e8e(0x1d3)][_0x295e8e(0x208)](_0x295e8e(0x1dc));try{this[_0x295e8e(0x1d0)]=auth_state_enum_1['AuthState']['Updating'];const {refreshToken:_0x1ef162,clientId:_0x4c795f,clientSecret:_0x127137,loginUrl:_0x71f5a1}=typedi_1['default'][_0x295e8e(0x1d9)](providers_tokens_1[_0x295e8e(0x211)]['salesforce']),{data:_0x5623ce}=await axios_1[_0x295e8e(0x1ea)][_0x295e8e(0x217)]((0x0,utils_1['joinURL'])(_0x71f5a1,'/services/oauth2/token'),null,{'params':{'grant_type':'refresh_token','refresh_token':_0x1ef162,'client_id':_0x4c795f,'client_secret':_0x127137}});this[_0x295e8e(0x1de)]=_0x5623ce[_0x295e8e(0x20d)],this['accessToken']=_0x5623ce[_0x295e8e(0x20b)],this['tokenType']=_0x5623ce['token_type'],this['authState']=auth_state_enum_1[_0x295e8e(0x1f6)][_0x295e8e(0x1f3)],this['logger'][_0x295e8e(0x208)](_0x295e8e(0x1df),this['instanceUrl']);}catch(_0x27e6d5){const _0x1b1217=((_0x1ac2f4=(_0x405294=_0x27e6d5===null||_0x27e6d5===void 0x0?void 0x0:_0x27e6d5[_0x295e8e(0x1e6)])===null||_0x405294===void 0x0?void 0x0:_0x405294[_0x295e8e(0x207)])===null||_0x1ac2f4===void 0x0?void 0x0:_0x1ac2f4[_0x295e8e(0x1d2)])||((_0xc0d5c=_0x27e6d5===null||_0x27e6d5===void 0x0?void 0x0:_0x27e6d5[_0x295e8e(0x1e6)])===null||_0xc0d5c===void 0x0?void 0x0:_0xc0d5c['data'])||_0x27e6d5[_0x295e8e(0x1da)];this[_0x295e8e(0x1d3)][_0x295e8e(0x1d2)](_0x295e8e(0x1e5),_0x1b1217),this[_0x295e8e(0x1d0)]=auth_state_enum_1[_0x295e8e(0x1f6)][_0x295e8e(0x1ed)];throw new invalid_refresh_token_error_1[(_0x295e8e(0x1ee))](errors_1[_0x295e8e(0x1d1)]);}}async['forceUpdateToken'](){const _0x5dd24c=a193_0x52079a;this['logger'][_0x5dd24c(0x208)](_0x5dd24c(0x1d4));if(this[_0x5dd24c(0x1d0)]===auth_state_enum_1[_0x5dd24c(0x1f6)][_0x5dd24c(0x20a)]||this[_0x5dd24c(0x1d0)]===auth_state_enum_1[_0x5dd24c(0x1f6)][_0x5dd24c(0x218)])return await(0x0,utils_1['sleep'])(this[_0x5dd24c(0x1c3)]),this[_0x5dd24c(0x1c7)]();if(this['authState']===auth_state_enum_1['AuthState'][_0x5dd24c(0x1ed)])throw new invalid_refresh_token_error_1[(_0x5dd24c(0x1ee))](errors_1[_0x5dd24c(0x1d1)]);await this[_0x5dd24c(0x1d5)]();}async[a193_0x52079a(0x213)](){const _0x98f561=a193_0x52079a;if(this[_0x98f561(0x1d0)]===auth_state_enum_1[_0x98f561(0x1f6)][_0x98f561(0x1ed)]){this[_0x98f561(0x1d3)][_0x98f561(0x208)](_0x98f561(0x212));throw new unauthorized_salesforce_error_1['UnauthorizedSalesforceError']();}if(this[_0x98f561(0x1d0)]!==auth_state_enum_1['AuthState'][_0x98f561(0x1f3)])return this[_0x98f561(0x1d3)][_0x98f561(0x208)](_0x98f561(0x1f8)),await(0x0,utils_1[_0x98f561(0x1fe)])(this['AUTH_WAIT_TIME']),this['waitAuth']();}['getAuthData'](){const _0x2321b4=a193_0x52079a;return{'orgId':this[_0x2321b4(0x1dd)],'accessToken':this['accessToken'],'instanceUrl':this[_0x2321b4(0x1de)]};}async[a193_0x52079a(0x202)](){const _0x22d2a4=a193_0x52079a;return await this[_0x22d2a4(0x213)](),{'baseURL':this[_0x22d2a4(0x1de)],'headers':{'accept':'application/json','authorization':this['tokenType']+'\x20'+this[_0x22d2a4(0x216)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a193_0x52079a(0x1e8)])(),__metadata(a193_0x52079a(0x210),[])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;