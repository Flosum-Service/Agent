function a232_0x3eb5(_0x44159c,_0x45a991){const _0x4639d6=a232_0x3194();return a232_0x3eb5=function(_0x46e99f,_0x40fc45){_0x46e99f=_0x46e99f-0x1c0;let _0x3194e3=_0x4639d6[_0x46e99f];return _0x3194e3;},a232_0x3eb5(_0x44159c,_0x45a991);}const a232_0x2e519a=a232_0x3eb5;(function(_0x3454e1,_0x3b711f){const _0x59ddf8=a232_0x3eb5,_0xf62342=_0x3454e1();while(!![]){try{const _0x18e12e=-parseInt(_0x59ddf8(0x1ea))/0x1+-parseInt(_0x59ddf8(0x1c3))/0x2+parseInt(_0x59ddf8(0x1d6))/0x3+parseInt(_0x59ddf8(0x1dd))/0x4+-parseInt(_0x59ddf8(0x1cd))/0x5*(-parseInt(_0x59ddf8(0x1f1))/0x6)+parseInt(_0x59ddf8(0x1de))/0x7*(-parseInt(_0x59ddf8(0x1f5))/0x8)+parseInt(_0x59ddf8(0x1c0))/0x9*(parseInt(_0x59ddf8(0x1ed))/0xa);if(_0x18e12e===_0x3b711f)break;else _0xf62342['push'](_0xf62342['shift']());}catch(_0x4124ea){_0xf62342['push'](_0xf62342['shift']());}}}(a232_0x3194,0xb3a0c));function a232_0x3194(){const _0x2e497e=['getAuthData','../../../../constants/errors','setAuthDetails','post','../../../shared/utils','36ufnuTY','../../../../constants','get','1262388ytlTUY','default','configurable','AuthState','prototype','SALESFORCE_API_VERSION','application/json','/services/oauth2/token','Updating','ERR_INVALID_SALESFORCE_TOKEN','215hChsRK','decorate','accessToken','waitAuth','__createBinding','../errors/invalid-refresh-token.error','length','axios','salesforce','3545754ernWJx','call','../../providers/providers.tokens','Error','object','(((.+)+)+)+$','joinURL','2813008uZFJBT','7802529WqxMeE','force\x20update\x20token','AUTH_WAIT_TIME','SalesforceAuthService','access\x20token\x20updated\x20for\x20%s','logger','toString','Idle','__decorate','create','access_token','tokenType','1375718AyHqBb','forceUpdateToken','requestConfig','1296970QwYPyi','__esModule','search','getOwnPropertyDescriptor','202794VvjmIh','__setModuleDefault','design:paramtypes','updateAccessToken','8QmQUJb','create\x20authorized\x20request\x20failed:\x20authorization\x20error','apply','defineProperty','response','message','name','authState','writable','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','typedi','../../../../core','refresh_token','update\x20access\x20token\x20failed:\x20%s','log','instanceUrl','metadata','UnauthorizedSalesforceError','error','function','../enums/auth-state.enum','Logger','__importDefault','Active','Tokens'];a232_0x3194=function(){return _0x2e497e;};return a232_0x3194();}const a232_0x40fc45=(function(){let _0x1e3c4f=!![];return function(_0x4f4703,_0x33038e){const _0x23ea7a=_0x1e3c4f?function(){const _0x45caf4=a232_0x3eb5;if(_0x33038e){const _0x52bce6=_0x33038e[_0x45caf4(0x1f7)](_0x4f4703,arguments);return _0x33038e=null,_0x52bce6;}}:function(){};return _0x1e3c4f=![],_0x23ea7a;};}()),a232_0x46e99f=a232_0x40fc45(this,function(){const _0x353184=a232_0x3eb5;return a232_0x46e99f[_0x353184(0x1e4)]()['search'](_0x353184(0x1db))[_0x353184(0x1e4)]()['constructor'](a232_0x46e99f)[_0x353184(0x1ef)]('(((.+)+)+)+$');});a232_0x46e99f();'use strict';var __createBinding=this&&this[a232_0x2e519a(0x1d1)]||(Object[a232_0x2e519a(0x1e7)]?function(_0x465089,_0x1e1582,_0x4f8566,_0x37328a){const _0x5b68ed=a232_0x2e519a;if(_0x37328a===undefined)_0x37328a=_0x4f8566;var _0x127878=Object[_0x5b68ed(0x1f0)](_0x1e1582,_0x4f8566);(!_0x127878||(_0x5b68ed(0x1c2)in _0x127878?!_0x1e1582[_0x5b68ed(0x1ee)]:_0x127878[_0x5b68ed(0x1fd)]||_0x127878[_0x5b68ed(0x1c5)]))&&(_0x127878={'enumerable':!![],'get':function(){return _0x1e1582[_0x4f8566];}}),Object['defineProperty'](_0x465089,_0x37328a,_0x127878);}:function(_0x3eaeeb,_0x493f21,_0x1a2578,_0x388486){if(_0x388486===undefined)_0x388486=_0x1a2578;_0x3eaeeb[_0x388486]=_0x493f21[_0x1a2578];}),__setModuleDefault=this&&this[a232_0x2e519a(0x1f2)]||(Object[a232_0x2e519a(0x1e7)]?function(_0x1cb27c,_0x20b12c){const _0x3653b9=a232_0x2e519a;Object['defineProperty'](_0x1cb27c,_0x3653b9(0x1c4),{'enumerable':!![],'value':_0x20b12c});}:function(_0x5c6af9,_0x34fd51){const _0x37f9aa=a232_0x2e519a;_0x5c6af9[_0x37f9aa(0x1c4)]=_0x34fd51;}),__decorate=this&&this[a232_0x2e519a(0x1e6)]||function(_0x334b5b,_0x20590b,_0x237801,_0x3f70f4){const _0x5a0101=a232_0x2e519a;var _0x4ed041=arguments[_0x5a0101(0x1d3)],_0x2c99d9=_0x4ed041<0x3?_0x20590b:_0x3f70f4===null?_0x3f70f4=Object['getOwnPropertyDescriptor'](_0x20590b,_0x237801):_0x3f70f4,_0x573e72;if(typeof Reflect==='object'&&typeof Reflect[_0x5a0101(0x1ce)]===_0x5a0101(0x208))_0x2c99d9=Reflect[_0x5a0101(0x1ce)](_0x334b5b,_0x20590b,_0x237801,_0x3f70f4);else{for(var _0x36b8d3=_0x334b5b['length']-0x1;_0x36b8d3>=0x0;_0x36b8d3--)if(_0x573e72=_0x334b5b[_0x36b8d3])_0x2c99d9=(_0x4ed041<0x3?_0x573e72(_0x2c99d9):_0x4ed041>0x3?_0x573e72(_0x20590b,_0x237801,_0x2c99d9):_0x573e72(_0x20590b,_0x237801))||_0x2c99d9;}return _0x4ed041>0x3&&_0x2c99d9&&Object[_0x5a0101(0x1f8)](_0x20590b,_0x237801,_0x2c99d9),_0x2c99d9;},__importStar=this&&this['__importStar']||function(_0x410599){const _0x16d38f=a232_0x2e519a;if(_0x410599&&_0x410599[_0x16d38f(0x1ee)])return _0x410599;var _0x750ce0={};if(_0x410599!=null){for(var _0x4f68c0 in _0x410599)if(_0x4f68c0!=='default'&&Object[_0x16d38f(0x1c7)]['hasOwnProperty'][_0x16d38f(0x1d7)](_0x410599,_0x4f68c0))__createBinding(_0x750ce0,_0x410599,_0x4f68c0);}return __setModuleDefault(_0x750ce0,_0x410599),_0x750ce0;},__metadata=this&&this['__metadata']||function(_0x73d895,_0x51a39c){const _0x28c364=a232_0x2e519a;if(typeof Reflect===_0x28c364(0x1da)&&typeof Reflect[_0x28c364(0x205)]===_0x28c364(0x208))return Reflect[_0x28c364(0x205)](_0x73d895,_0x51a39c);},__importDefault=this&&this[a232_0x2e519a(0x20b)]||function(_0x1ad205){const _0x40cf0d=a232_0x2e519a;return _0x1ad205&&_0x1ad205[_0x40cf0d(0x1ee)]?_0x1ad205:{'default':_0x1ad205};},SalesforceAuthService_1;Object[a232_0x2e519a(0x1f8)](exports,a232_0x2e519a(0x1ee),{'value':!![]}),exports[a232_0x2e519a(0x1e1)]=void 0x0;const typedi_1=__importStar(require(a232_0x2e519a(0x1ff))),errors_1=require(a232_0x2e519a(0x20f)),core_1=require(a232_0x2e519a(0x200)),axios_1=__importDefault(require(a232_0x2e519a(0x1d4))),utils_1=require(a232_0x2e519a(0x212)),invalid_refresh_token_error_1=require(a232_0x2e519a(0x1d2)),auth_state_enum_1=require(a232_0x2e519a(0x209)),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a232_0x2e519a(0x1c1)),providers_tokens_1=require(a232_0x2e519a(0x1d8));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x5bd055=a232_0x2e519a;this[_0x5bd055(0x1e0)]=0x1388,this[_0x5bd055(0x1fc)]=auth_state_enum_1[_0x5bd055(0x1c6)]['Idle'],this[_0x5bd055(0x1e3)]=new core_1[(_0x5bd055(0x20a))](SalesforceAuthService_1[_0x5bd055(0x1fb)]),this['setAuthDetails']();}async[a232_0x2e519a(0x210)](){const _0x1d0db7=a232_0x2e519a;this[_0x1d0db7(0x1e3)][_0x1d0db7(0x203)]('check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1[_0x1d0db7(0x1c6)][this[_0x1d0db7(0x1fc)]]);try{if(this[_0x1d0db7(0x1fc)]===auth_state_enum_1['AuthState'][_0x1d0db7(0x1d9)])return;if(this['authState']===auth_state_enum_1['AuthState'][_0x1d0db7(0x1e5)])await this['updateAccessToken']();else{const _0x4125eb=await this['requestConfig'](),_0x2d788d=await axios_1[_0x1d0db7(0x1c4)]['get']('services/data/'+constants_1[_0x1d0db7(0x1c8)],_0x4125eb)['then'](()=>!![])['catch'](()=>![]);!_0x2d788d&&await this[_0x1d0db7(0x1f4)]();}}catch(_0x407f0a){}}async[a232_0x2e519a(0x1f4)](){const _0x57a798=a232_0x2e519a;var _0x35097e,_0x428ecb,_0x5724a0;this[_0x57a798(0x1e3)][_0x57a798(0x203)]('update\x20access\x20token');try{this[_0x57a798(0x1fc)]=auth_state_enum_1[_0x57a798(0x1c6)][_0x57a798(0x1cb)];const {refreshToken:_0x1622c4,clientId:_0xb0ce47,clientSecret:_0x54bd31,loginUrl:_0x2dff28}=typedi_1[_0x57a798(0x1c4)][_0x57a798(0x1c2)](providers_tokens_1[_0x57a798(0x20d)][_0x57a798(0x1d5)]),{data:_0x57e2ac}=await axios_1[_0x57a798(0x1c4)][_0x57a798(0x211)]((0x0,utils_1[_0x57a798(0x1dc)])(_0x2dff28,_0x57a798(0x1ca)),null,{'params':{'grant_type':_0x57a798(0x201),'refresh_token':_0x1622c4,'client_id':_0xb0ce47,'client_secret':_0x54bd31}});this['instanceUrl']=_0x57e2ac['instance_url'],this['accessToken']=_0x57e2ac[_0x57a798(0x1e8)],this['tokenType']=_0x57e2ac['token_type'],this[_0x57a798(0x1fc)]=auth_state_enum_1[_0x57a798(0x1c6)]['Active'],this[_0x57a798(0x1e3)][_0x57a798(0x203)](_0x57a798(0x1e2),this[_0x57a798(0x204)]);}catch(_0x341ba9){const _0x1b1699=((_0x428ecb=(_0x35097e=_0x341ba9===null||_0x341ba9===void 0x0?void 0x0:_0x341ba9[_0x57a798(0x1f9)])===null||_0x35097e===void 0x0?void 0x0:_0x35097e['data'])===null||_0x428ecb===void 0x0?void 0x0:_0x428ecb[_0x57a798(0x207)])||((_0x5724a0=_0x341ba9===null||_0x341ba9===void 0x0?void 0x0:_0x341ba9[_0x57a798(0x1f9)])===null||_0x5724a0===void 0x0?void 0x0:_0x5724a0['data'])||_0x341ba9[_0x57a798(0x1fa)];this['logger']['error'](_0x57a798(0x202),_0x1b1699),this[_0x57a798(0x1fc)]=auth_state_enum_1[_0x57a798(0x1c6)][_0x57a798(0x1d9)];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x57a798(0x1cc)]);}}async[a232_0x2e519a(0x1eb)](){const _0x35208d=a232_0x2e519a;this['logger']['log'](_0x35208d(0x1df));if(this[_0x35208d(0x1fc)]===auth_state_enum_1['AuthState'][_0x35208d(0x1cb)]||this['authState']===auth_state_enum_1[_0x35208d(0x1c6)][_0x35208d(0x1e5)])return await(0x0,utils_1['sleep'])(this[_0x35208d(0x1e0)]),this[_0x35208d(0x1eb)]();if(this[_0x35208d(0x1fc)]===auth_state_enum_1[_0x35208d(0x1c6)][_0x35208d(0x1d9)])throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0x35208d(0x1f4)]();}async['waitAuth'](){const _0x8affb3=a232_0x2e519a;if(this[_0x8affb3(0x1fc)]===auth_state_enum_1['AuthState'][_0x8affb3(0x1d9)]){this[_0x8affb3(0x1e3)]['log'](_0x8affb3(0x1f6));throw new unauthorized_salesforce_error_1[(_0x8affb3(0x206))]();}if(this['authState']!==auth_state_enum_1[_0x8affb3(0x1c6)][_0x8affb3(0x20c)])return this[_0x8affb3(0x1e3)][_0x8affb3(0x203)](_0x8affb3(0x1fe)),await(0x0,utils_1['sleep'])(this['AUTH_WAIT_TIME']),this['waitAuth']();}[a232_0x2e519a(0x20e)](){const _0x201727=a232_0x2e519a;return{'orgId':this['orgId'],'accessToken':this[_0x201727(0x1cf)],'instanceUrl':this[_0x201727(0x204)]};}async[a232_0x2e519a(0x1ec)](){const _0xdf2e2d=a232_0x2e519a;return await this[_0xdf2e2d(0x1d0)](),{'baseURL':this[_0xdf2e2d(0x204)],'headers':{'accept':_0xdf2e2d(0x1c9),'authorization':this[_0xdf2e2d(0x1e9)]+'\x20'+this[_0xdf2e2d(0x1cf)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a232_0x2e519a(0x1f3),[])],SalesforceAuthService),exports[a232_0x2e519a(0x1e1)]=SalesforceAuthService;