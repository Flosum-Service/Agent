const a232_0x4124a0=a232_0x4779;(function(_0x43124b,_0x3204d3){const _0x41820a=a232_0x4779,_0x5b0966=_0x43124b();while(!![]){try{const _0x28c6cf=parseInt(_0x41820a(0x1c2))/0x1*(-parseInt(_0x41820a(0x1e2))/0x2)+-parseInt(_0x41820a(0x1be))/0x3+parseInt(_0x41820a(0x1a4))/0x4+parseInt(_0x41820a(0x1aa))/0x5*(parseInt(_0x41820a(0x1b7))/0x6)+parseInt(_0x41820a(0x1e0))/0x7*(-parseInt(_0x41820a(0x19f))/0x8)+parseInt(_0x41820a(0x1c4))/0x9+parseInt(_0x41820a(0x1b5))/0xa*(parseInt(_0x41820a(0x1d1))/0xb);if(_0x28c6cf===_0x3204d3)break;else _0x5b0966['push'](_0x5b0966['shift']());}catch(_0x250a2d){_0x5b0966['push'](_0x5b0966['shift']());}}}(a232_0x4f63,0x7233d));function a232_0x4779(_0x198bc3,_0x3bdf12){const _0x4bb910=a232_0x4f63();return a232_0x4779=function(_0xf79e07,_0x169258){_0xf79e07=_0xf79e07-0x193;let _0x4f639e=_0x4bb910[_0xf79e07];return _0x4f639e;},a232_0x4779(_0x198bc3,_0x3bdf12);}const a232_0x169258=(function(){let _0x4e69ec=!![];return function(_0x1d2031,_0x14b601){const _0x5d9240=_0x4e69ec?function(){const _0x7b9051=a232_0x4779;if(_0x14b601){const _0x1dc2ef=_0x14b601[_0x7b9051(0x1d0)](_0x1d2031,arguments);return _0x14b601=null,_0x1dc2ef;}}:function(){};return _0x4e69ec=![],_0x5d9240;};}()),a232_0xf79e07=a232_0x169258(this,function(){const _0x4b04c4=a232_0x4779;return a232_0xf79e07[_0x4b04c4(0x1ae)]()[_0x4b04c4(0x1af)](_0x4b04c4(0x1e6))['toString']()['constructor'](a232_0xf79e07)['search'](_0x4b04c4(0x1e6));});a232_0xf79e07();'use strict';function a232_0x4f63(){const _0x556cc3=['salesforce','../../providers/providers.tokens','forceUpdateToken','instanceUrl','typedi','6634610XFgMeJ','error','12SqVQJs','getOwnPropertyDescriptor','update\x20access\x20token\x20failed:\x20%s','application/json','__metadata','__setModuleDefault','ERR_INVALID_SALESFORCE_TOKEN','1068279bWFPGD','force\x20update\x20token','Idle','instance_url','104DvOyUQ','decorate','4714137MczosD','create','default','../../../../constants/errors','create\x20authorized\x20request\x20failed:\x20authorization\x20error','metadata','post','../enums/auth-state.enum','getAuthData','data','/services/oauth2/token','__decorate','apply','11wYKBeY','Service','Logger','writable','Active','object','tokenType','AuthState','setAuthDetails','logger','update\x20access\x20token','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','then','get','call','2813293CidiBt','Error','7508sxuMVL','Tokens','AUTH_WAIT_TIME','sleep','(((.+)+)+)+$','name','../../../shared/utils','hasOwnProperty','defineProperty','length','SALESFORCE_API_VERSION','axios','__esModule','waitAuth','authState','joinURL','InvalidRefreshTokenError','8rdmlzV','Updating','../errors/unauthorized-salesforce.error','UnauthorizedSalesforceError','function','1312540SSQsCj','updateAccessToken','../errors/invalid-refresh-token.error','catch','log','refresh_token','251980sVNgKA','token_type','message','accessToken','toString','search'];a232_0x4f63=function(){return _0x556cc3;};return a232_0x4f63();}var __createBinding=this&&this['__createBinding']||(Object[a232_0x4124a0(0x1c5)]?function(_0x3f1734,_0x1926a2,_0x47db62,_0x8e0910){const _0x28956a=a232_0x4124a0;if(_0x8e0910===undefined)_0x8e0910=_0x47db62;var _0xf99452=Object[_0x28956a(0x1b8)](_0x1926a2,_0x47db62);(!_0xf99452||(_0x28956a(0x1de)in _0xf99452?!_0x1926a2['__esModule']:_0xf99452[_0x28956a(0x1d4)]||_0xf99452['configurable']))&&(_0xf99452={'enumerable':!![],'get':function(){return _0x1926a2[_0x47db62];}}),Object[_0x28956a(0x196)](_0x3f1734,_0x8e0910,_0xf99452);}:function(_0x9cf74a,_0x3d1d5c,_0x481b0d,_0x3b1c41){if(_0x3b1c41===undefined)_0x3b1c41=_0x481b0d;_0x9cf74a[_0x3b1c41]=_0x3d1d5c[_0x481b0d];}),__setModuleDefault=this&&this[a232_0x4124a0(0x1bc)]||(Object[a232_0x4124a0(0x1c5)]?function(_0xa465fc,_0x253c07){const _0x339453=a232_0x4124a0;Object[_0x339453(0x196)](_0xa465fc,_0x339453(0x1c6),{'enumerable':!![],'value':_0x253c07});}:function(_0x321744,_0x4af75d){const _0x82e19e=a232_0x4124a0;_0x321744[_0x82e19e(0x1c6)]=_0x4af75d;}),__decorate=this&&this[a232_0x4124a0(0x1cf)]||function(_0x2783db,_0x4d6807,_0x4ee8f2,_0x1181b9){const _0x502a42=a232_0x4124a0;var _0xe34880=arguments['length'],_0x3e70a1=_0xe34880<0x3?_0x4d6807:_0x1181b9===null?_0x1181b9=Object[_0x502a42(0x1b8)](_0x4d6807,_0x4ee8f2):_0x1181b9,_0x109697;if(typeof Reflect===_0x502a42(0x1d6)&&typeof Reflect[_0x502a42(0x1c3)]==='function')_0x3e70a1=Reflect[_0x502a42(0x1c3)](_0x2783db,_0x4d6807,_0x4ee8f2,_0x1181b9);else{for(var _0x3fb540=_0x2783db[_0x502a42(0x197)]-0x1;_0x3fb540>=0x0;_0x3fb540--)if(_0x109697=_0x2783db[_0x3fb540])_0x3e70a1=(_0xe34880<0x3?_0x109697(_0x3e70a1):_0xe34880>0x3?_0x109697(_0x4d6807,_0x4ee8f2,_0x3e70a1):_0x109697(_0x4d6807,_0x4ee8f2))||_0x3e70a1;}return _0xe34880>0x3&&_0x3e70a1&&Object['defineProperty'](_0x4d6807,_0x4ee8f2,_0x3e70a1),_0x3e70a1;},__importStar=this&&this['__importStar']||function(_0x3abbb8){const _0x3d21b8=a232_0x4124a0;if(_0x3abbb8&&_0x3abbb8[_0x3d21b8(0x19a)])return _0x3abbb8;var _0x257461={};if(_0x3abbb8!=null){for(var _0x58182d in _0x3abbb8)if(_0x58182d!==_0x3d21b8(0x1c6)&&Object['prototype'][_0x3d21b8(0x195)][_0x3d21b8(0x1df)](_0x3abbb8,_0x58182d))__createBinding(_0x257461,_0x3abbb8,_0x58182d);}return __setModuleDefault(_0x257461,_0x3abbb8),_0x257461;},__metadata=this&&this[a232_0x4124a0(0x1bb)]||function(_0x54e22a,_0x3e5928){const _0x44ef89=a232_0x4124a0;if(typeof Reflect===_0x44ef89(0x1d6)&&typeof Reflect[_0x44ef89(0x1c9)]===_0x44ef89(0x1a3))return Reflect[_0x44ef89(0x1c9)](_0x54e22a,_0x3e5928);},__importDefault=this&&this['__importDefault']||function(_0x422020){const _0x3af6b4=a232_0x4124a0;return _0x422020&&_0x422020[_0x3af6b4(0x19a)]?_0x422020:{'default':_0x422020};},SalesforceAuthService_1;Object[a232_0x4124a0(0x196)](exports,a232_0x4124a0(0x19a),{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=__importStar(require(a232_0x4124a0(0x1b4))),errors_1=require(a232_0x4124a0(0x1c7)),core_1=require('../../../../core'),axios_1=__importDefault(require(a232_0x4124a0(0x199))),utils_1=require(a232_0x4124a0(0x194)),invalid_refresh_token_error_1=require(a232_0x4124a0(0x1a6)),auth_state_enum_1=require(a232_0x4124a0(0x1cb)),unauthorized_salesforce_error_1=require(a232_0x4124a0(0x1a1)),constants_1=require('../../../../constants'),providers_tokens_1=require(a232_0x4124a0(0x1b1));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x2ade49=a232_0x4124a0;this[_0x2ade49(0x1e4)]=0x1388,this[_0x2ade49(0x19c)]=auth_state_enum_1[_0x2ade49(0x1d8)]['Idle'],this[_0x2ade49(0x1da)]=new core_1[(_0x2ade49(0x1d3))](SalesforceAuthService_1[_0x2ade49(0x193)]),this[_0x2ade49(0x1d9)]();}async['setAuthDetails'](){const _0x2c0bed=a232_0x4124a0;this[_0x2c0bed(0x1da)][_0x2c0bed(0x1a8)]('check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1[_0x2c0bed(0x1d8)][this[_0x2c0bed(0x19c)]]);try{if(this[_0x2c0bed(0x19c)]===auth_state_enum_1[_0x2c0bed(0x1d8)]['Error'])return;if(this['authState']===auth_state_enum_1[_0x2c0bed(0x1d8)]['Idle'])await this[_0x2c0bed(0x1a5)]();else{const _0x43e46a=await this['requestConfig'](),_0xc8b231=await axios_1['default'][_0x2c0bed(0x1de)]('services/data/'+constants_1[_0x2c0bed(0x198)],_0x43e46a)[_0x2c0bed(0x1dd)](()=>!![])[_0x2c0bed(0x1a7)](()=>![]);!_0xc8b231&&await this[_0x2c0bed(0x1a5)]();}}catch(_0x17787e){}}async[a232_0x4124a0(0x1a5)](){const _0x15687f=a232_0x4124a0;var _0x2c93a6,_0x163a71,_0x44ce62;this[_0x15687f(0x1da)][_0x15687f(0x1a8)](_0x15687f(0x1db));try{this[_0x15687f(0x19c)]=auth_state_enum_1['AuthState'][_0x15687f(0x1a0)];const {refreshToken:_0x1712f7,clientId:_0x429f37,clientSecret:_0x11860f,loginUrl:_0x36bc8d}=typedi_1[_0x15687f(0x1c6)][_0x15687f(0x1de)](providers_tokens_1[_0x15687f(0x1e3)][_0x15687f(0x1b0)]),{data:_0x8a63de}=await axios_1[_0x15687f(0x1c6)][_0x15687f(0x1ca)]((0x0,utils_1[_0x15687f(0x19d)])(_0x36bc8d,_0x15687f(0x1ce)),null,{'params':{'grant_type':_0x15687f(0x1a9),'refresh_token':_0x1712f7,'client_id':_0x429f37,'client_secret':_0x11860f}});this[_0x15687f(0x1b3)]=_0x8a63de[_0x15687f(0x1c1)],this['accessToken']=_0x8a63de['access_token'],this['tokenType']=_0x8a63de[_0x15687f(0x1ab)],this[_0x15687f(0x19c)]=auth_state_enum_1[_0x15687f(0x1d8)][_0x15687f(0x1d5)],this[_0x15687f(0x1da)][_0x15687f(0x1a8)]('access\x20token\x20updated\x20for\x20%s',this[_0x15687f(0x1b3)]);}catch(_0x451317){const _0x197c6d=((_0x163a71=(_0x2c93a6=_0x451317===null||_0x451317===void 0x0?void 0x0:_0x451317['response'])===null||_0x2c93a6===void 0x0?void 0x0:_0x2c93a6[_0x15687f(0x1cd)])===null||_0x163a71===void 0x0?void 0x0:_0x163a71[_0x15687f(0x1b6)])||((_0x44ce62=_0x451317===null||_0x451317===void 0x0?void 0x0:_0x451317['response'])===null||_0x44ce62===void 0x0?void 0x0:_0x44ce62[_0x15687f(0x1cd)])||_0x451317[_0x15687f(0x1ac)];this[_0x15687f(0x1da)][_0x15687f(0x1b6)](_0x15687f(0x1b9),_0x197c6d),this[_0x15687f(0x19c)]=auth_state_enum_1[_0x15687f(0x1d8)][_0x15687f(0x1e1)];throw new invalid_refresh_token_error_1[(_0x15687f(0x19e))](errors_1[_0x15687f(0x1bd)]);}}async[a232_0x4124a0(0x1b2)](){const _0x2c3509=a232_0x4124a0;this[_0x2c3509(0x1da)]['log'](_0x2c3509(0x1bf));if(this[_0x2c3509(0x19c)]===auth_state_enum_1[_0x2c3509(0x1d8)][_0x2c3509(0x1a0)]||this[_0x2c3509(0x19c)]===auth_state_enum_1[_0x2c3509(0x1d8)][_0x2c3509(0x1c0)])return await(0x0,utils_1[_0x2c3509(0x1e5)])(this[_0x2c3509(0x1e4)]),this[_0x2c3509(0x1b2)]();if(this[_0x2c3509(0x19c)]===auth_state_enum_1[_0x2c3509(0x1d8)][_0x2c3509(0x1e1)])throw new invalid_refresh_token_error_1[(_0x2c3509(0x19e))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0x2c3509(0x1a5)]();}async[a232_0x4124a0(0x19b)](){const _0x164546=a232_0x4124a0;if(this['authState']===auth_state_enum_1['AuthState']['Error']){this[_0x164546(0x1da)][_0x164546(0x1a8)](_0x164546(0x1c8));throw new unauthorized_salesforce_error_1[(_0x164546(0x1a2))]();}if(this['authState']!==auth_state_enum_1[_0x164546(0x1d8)][_0x164546(0x1d5)])return this[_0x164546(0x1da)][_0x164546(0x1a8)](_0x164546(0x1dc)),await(0x0,utils_1[_0x164546(0x1e5)])(this[_0x164546(0x1e4)]),this[_0x164546(0x19b)]();}[a232_0x4124a0(0x1cc)](){const _0x1564bd=a232_0x4124a0;return{'orgId':this['orgId'],'accessToken':this['accessToken'],'instanceUrl':this[_0x1564bd(0x1b3)]};}async['requestConfig'](){const _0x468340=a232_0x4124a0;return await this[_0x468340(0x19b)](),{'baseURL':this[_0x468340(0x1b3)],'headers':{'accept':_0x468340(0x1ba),'authorization':this[_0x468340(0x1d7)]+'\x20'+this[_0x468340(0x1ad)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a232_0x4124a0(0x1d2)])(),__metadata('design:paramtypes',[])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;