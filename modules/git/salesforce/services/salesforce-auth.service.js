const a227_0x5ad20f=a227_0xb8b9;(function(_0x2fd41b,_0x46c97d){const _0x17fdfe=a227_0xb8b9,_0x49db84=_0x2fd41b();while(!![]){try{const _0x44a41a=parseInt(_0x17fdfe(0x1b2))/0x1+-parseInt(_0x17fdfe(0x1c0))/0x2*(-parseInt(_0x17fdfe(0x192))/0x3)+parseInt(_0x17fdfe(0x1b7))/0x4*(parseInt(_0x17fdfe(0x1a8))/0x5)+-parseInt(_0x17fdfe(0x19c))/0x6*(-parseInt(_0x17fdfe(0x19b))/0x7)+-parseInt(_0x17fdfe(0x198))/0x8+-parseInt(_0x17fdfe(0x189))/0x9*(-parseInt(_0x17fdfe(0x1ba))/0xa)+-parseInt(_0x17fdfe(0x1d3))/0xb*(parseInt(_0x17fdfe(0x1cd))/0xc);if(_0x44a41a===_0x46c97d)break;else _0x49db84['push'](_0x49db84['shift']());}catch(_0x7cd7d5){_0x49db84['push'](_0x49db84['shift']());}}}(a227_0x1d72,0xc26e1));function a227_0x1d72(){const _0x435b77=['token_type','__decorate','7052143MMXBNQ','6sxdFGm','UnauthorizedSalesforceError','Error','sleep','call','length','post','force\x20update\x20token','getOwnPropertyDescriptor','../errors/unauthorized-salesforce.error','configurable','log','35WTwNDM','Active','catch','ERR_INVALID_SALESFORCE_TOKEN','get','decorate','metadata','AUTH_WAIT_TIME','update\x20access\x20token\x20failed:\x20%s','message','57538pbDZJy','../enums/auth-state.enum','typedi','tokenType','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','227464fSBuMG','then','constructor','7869540McdvmT','services/data/','create','create\x20authorized\x20request\x20failed:\x20authorization\x20error','__importStar','apply','66BElHsD','SALESFORCE_API_VERSION','axios','salesforce','logger','../../../../constants/errors','InvalidRefreshTokenError','error','search','name','AuthState','defineProperty','response','103308FyduWJ','authState','requestConfig','Logger','/services/oauth2/token','Updating','2937rmmyid','function','prototype','../../../shared/utils','instanceUrl','accessToken','instance_url','Idle','getAuthData','toString','9PmqHFC','(((.+)+)+)+$','data','default','check\x20auth:\x20current\x20state\x20-\x20%s','setAuthDetails','waitAuth','writable','refresh_token','121431GExwRP','Service','updateAccessToken','__esModule','__createBinding','SalesforceAuthService','3926048aIEnuz'];a227_0x1d72=function(){return _0x435b77;};return a227_0x1d72();}const a227_0x4d9c43=(function(){let _0x456698=!![];return function(_0x772e8f,_0x983858){const _0x476f35=_0x456698?function(){const _0x2f33f6=a227_0xb8b9;if(_0x983858){const _0x4ec4c7=_0x983858[_0x2f33f6(0x1bf)](_0x772e8f,arguments);return _0x983858=null,_0x4ec4c7;}}:function(){};return _0x456698=![],_0x476f35;};}()),a227_0x220b56=a227_0x4d9c43(this,function(){const _0x2c821a=a227_0xb8b9;return a227_0x220b56[_0x2c821a(0x188)]()[_0x2c821a(0x1c8)](_0x2c821a(0x18a))['toString']()[_0x2c821a(0x1b9)](a227_0x220b56)[_0x2c821a(0x1c8)](_0x2c821a(0x18a));});a227_0x220b56();'use strict';var __createBinding=this&&this[a227_0x5ad20f(0x196)]||(Object[a227_0x5ad20f(0x1bc)]?function(_0x5b7c5c,_0x30d236,_0x1433bd,_0x463397){const _0x8911f6=a227_0x5ad20f;if(_0x463397===undefined)_0x463397=_0x1433bd;var _0x219530=Object[_0x8911f6(0x1a4)](_0x30d236,_0x1433bd);(!_0x219530||(_0x8911f6(0x1ac)in _0x219530?!_0x30d236[_0x8911f6(0x195)]:_0x219530[_0x8911f6(0x190)]||_0x219530[_0x8911f6(0x1a6)]))&&(_0x219530={'enumerable':!![],'get':function(){return _0x30d236[_0x1433bd];}}),Object['defineProperty'](_0x5b7c5c,_0x463397,_0x219530);}:function(_0x3f0c48,_0x2952e6,_0x36636a,_0x54a8f5){if(_0x54a8f5===undefined)_0x54a8f5=_0x36636a;_0x3f0c48[_0x54a8f5]=_0x2952e6[_0x36636a];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a227_0x5ad20f(0x1bc)]?function(_0x544d60,_0x55a885){const _0x4d0882=a227_0x5ad20f;Object[_0x4d0882(0x1cb)](_0x544d60,'default',{'enumerable':!![],'value':_0x55a885});}:function(_0x4269b4,_0x2e8b2e){const _0x367ed6=a227_0x5ad20f;_0x4269b4[_0x367ed6(0x18c)]=_0x2e8b2e;}),__decorate=this&&this[a227_0x5ad20f(0x19a)]||function(_0x3f6efb,_0x3b5e35,_0x5d57ff,_0x1b1852){const _0x137884=a227_0x5ad20f;var _0xdf7092=arguments[_0x137884(0x1a1)],_0x12c4c9=_0xdf7092<0x3?_0x3b5e35:_0x1b1852===null?_0x1b1852=Object['getOwnPropertyDescriptor'](_0x3b5e35,_0x5d57ff):_0x1b1852,_0x347346;if(typeof Reflect==='object'&&typeof Reflect[_0x137884(0x1ad)]===_0x137884(0x180))_0x12c4c9=Reflect[_0x137884(0x1ad)](_0x3f6efb,_0x3b5e35,_0x5d57ff,_0x1b1852);else{for(var _0x333522=_0x3f6efb[_0x137884(0x1a1)]-0x1;_0x333522>=0x0;_0x333522--)if(_0x347346=_0x3f6efb[_0x333522])_0x12c4c9=(_0xdf7092<0x3?_0x347346(_0x12c4c9):_0xdf7092>0x3?_0x347346(_0x3b5e35,_0x5d57ff,_0x12c4c9):_0x347346(_0x3b5e35,_0x5d57ff))||_0x12c4c9;}return _0xdf7092>0x3&&_0x12c4c9&&Object[_0x137884(0x1cb)](_0x3b5e35,_0x5d57ff,_0x12c4c9),_0x12c4c9;},__importStar=this&&this[a227_0x5ad20f(0x1be)]||function(_0x1d7a18){const _0x8a6b94=a227_0x5ad20f;if(_0x1d7a18&&_0x1d7a18[_0x8a6b94(0x195)])return _0x1d7a18;var _0x116962={};if(_0x1d7a18!=null){for(var _0x1b941d in _0x1d7a18)if(_0x1b941d!==_0x8a6b94(0x18c)&&Object[_0x8a6b94(0x181)]['hasOwnProperty'][_0x8a6b94(0x1a0)](_0x1d7a18,_0x1b941d))__createBinding(_0x116962,_0x1d7a18,_0x1b941d);}return __setModuleDefault(_0x116962,_0x1d7a18),_0x116962;},__metadata=this&&this['__metadata']||function(_0x43a47f,_0x42839a){const _0x29aacd=a227_0x5ad20f;if(typeof Reflect==='object'&&typeof Reflect[_0x29aacd(0x1ae)]==='function')return Reflect['metadata'](_0x43a47f,_0x42839a);},__importDefault=this&&this['__importDefault']||function(_0x424669){const _0x45169d=a227_0x5ad20f;return _0x424669&&_0x424669[_0x45169d(0x195)]?_0x424669:{'default':_0x424669};},SalesforceAuthService_1;Object[a227_0x5ad20f(0x1cb)](exports,a227_0x5ad20f(0x195),{'value':!![]}),exports[a227_0x5ad20f(0x197)]=void 0x0;const typedi_1=__importStar(require(a227_0x5ad20f(0x1b4))),errors_1=require(a227_0x5ad20f(0x1c5)),core_1=require('../../../../core'),axios_1=__importDefault(require(a227_0x5ad20f(0x1c2))),utils_1=require(a227_0x5ad20f(0x182)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require(a227_0x5ad20f(0x1b3)),unauthorized_salesforce_error_1=require(a227_0x5ad20f(0x1a5)),constants_1=require('../../../../constants'),providers_tokens_1=require('../../providers/providers.tokens');function a227_0xb8b9(_0x51e8f3,_0x39697a){const _0x425a97=a227_0x1d72();return a227_0xb8b9=function(_0x220b56,_0x4d9c43){_0x220b56=_0x220b56-0x180;let _0x1d72d4=_0x425a97[_0x220b56];return _0x1d72d4;},a227_0xb8b9(_0x51e8f3,_0x39697a);}let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x4944fd=a227_0x5ad20f;this[_0x4944fd(0x1af)]=0x1388,this['authState']=auth_state_enum_1[_0x4944fd(0x1ca)][_0x4944fd(0x186)],this[_0x4944fd(0x1c4)]=new core_1[(_0x4944fd(0x1d0))](SalesforceAuthService_1[_0x4944fd(0x1c9)]),this[_0x4944fd(0x18e)]();}async[a227_0x5ad20f(0x18e)](){const _0x20896e=a227_0x5ad20f;this[_0x20896e(0x1c4)][_0x20896e(0x1a7)](_0x20896e(0x18d),auth_state_enum_1['AuthState'][this[_0x20896e(0x1ce)]]);try{if(this[_0x20896e(0x1ce)]===auth_state_enum_1[_0x20896e(0x1ca)][_0x20896e(0x19e)])return;if(this['authState']===auth_state_enum_1[_0x20896e(0x1ca)][_0x20896e(0x186)])await this['updateAccessToken']();else{const _0x41e3a2=await this['requestConfig'](),_0x2c0295=await axios_1[_0x20896e(0x18c)]['get'](_0x20896e(0x1bb)+constants_1[_0x20896e(0x1c1)],_0x41e3a2)[_0x20896e(0x1b8)](()=>!![])[_0x20896e(0x1aa)](()=>![]);!_0x2c0295&&await this[_0x20896e(0x194)]();}}catch(_0x42ad1c){}}async[a227_0x5ad20f(0x194)](){const _0x4605bb=a227_0x5ad20f;var _0x13633a,_0x42336c,_0x35dd4a;this[_0x4605bb(0x1c4)][_0x4605bb(0x1a7)]('update\x20access\x20token');try{this[_0x4605bb(0x1ce)]=auth_state_enum_1[_0x4605bb(0x1ca)]['Updating'];const {refreshToken:_0x208f9d,clientId:_0x59dc6e,clientSecret:_0x7b4851,loginUrl:_0x441cfc}=typedi_1[_0x4605bb(0x18c)][_0x4605bb(0x1ac)](providers_tokens_1['Tokens'][_0x4605bb(0x1c3)]),{data:_0x505c4d}=await axios_1[_0x4605bb(0x18c)][_0x4605bb(0x1a2)]((0x0,utils_1['joinURL'])(_0x441cfc,_0x4605bb(0x1d1)),null,{'params':{'grant_type':_0x4605bb(0x191),'refresh_token':_0x208f9d,'client_id':_0x59dc6e,'client_secret':_0x7b4851}});this[_0x4605bb(0x183)]=_0x505c4d[_0x4605bb(0x185)],this[_0x4605bb(0x184)]=_0x505c4d['access_token'],this[_0x4605bb(0x1b5)]=_0x505c4d[_0x4605bb(0x199)],this[_0x4605bb(0x1ce)]=auth_state_enum_1['AuthState'][_0x4605bb(0x1a9)],this[_0x4605bb(0x1c4)][_0x4605bb(0x1a7)]('access\x20token\x20updated\x20for\x20%s',this[_0x4605bb(0x183)]);}catch(_0xf4cfac){const _0x4db9c4=((_0x42336c=(_0x13633a=_0xf4cfac===null||_0xf4cfac===void 0x0?void 0x0:_0xf4cfac[_0x4605bb(0x1cc)])===null||_0x13633a===void 0x0?void 0x0:_0x13633a[_0x4605bb(0x18b)])===null||_0x42336c===void 0x0?void 0x0:_0x42336c['error'])||((_0x35dd4a=_0xf4cfac===null||_0xf4cfac===void 0x0?void 0x0:_0xf4cfac[_0x4605bb(0x1cc)])===null||_0x35dd4a===void 0x0?void 0x0:_0x35dd4a[_0x4605bb(0x18b)])||_0xf4cfac[_0x4605bb(0x1b1)];this[_0x4605bb(0x1c4)][_0x4605bb(0x1c7)](_0x4605bb(0x1b0),_0x4db9c4),this[_0x4605bb(0x1ce)]=auth_state_enum_1[_0x4605bb(0x1ca)][_0x4605bb(0x19e)];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x4605bb(0x1ab)]);}}async['forceUpdateToken'](){const _0x5bc119=a227_0x5ad20f;this['logger'][_0x5bc119(0x1a7)](_0x5bc119(0x1a3));if(this['authState']===auth_state_enum_1[_0x5bc119(0x1ca)][_0x5bc119(0x1d2)]||this['authState']===auth_state_enum_1[_0x5bc119(0x1ca)][_0x5bc119(0x186)])return await(0x0,utils_1[_0x5bc119(0x19f)])(this[_0x5bc119(0x1af)]),this['forceUpdateToken']();if(this[_0x5bc119(0x1ce)]===auth_state_enum_1[_0x5bc119(0x1ca)][_0x5bc119(0x19e)])throw new invalid_refresh_token_error_1[(_0x5bc119(0x1c6))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this[_0x5bc119(0x194)]();}async[a227_0x5ad20f(0x18f)](){const _0x5600bf=a227_0x5ad20f;if(this[_0x5600bf(0x1ce)]===auth_state_enum_1[_0x5600bf(0x1ca)][_0x5600bf(0x19e)]){this[_0x5600bf(0x1c4)][_0x5600bf(0x1a7)](_0x5600bf(0x1bd));throw new unauthorized_salesforce_error_1[(_0x5600bf(0x19d))]();}if(this[_0x5600bf(0x1ce)]!==auth_state_enum_1[_0x5600bf(0x1ca)][_0x5600bf(0x1a9)])return this[_0x5600bf(0x1c4)][_0x5600bf(0x1a7)](_0x5600bf(0x1b6)),await(0x0,utils_1[_0x5600bf(0x19f)])(this[_0x5600bf(0x1af)]),this[_0x5600bf(0x18f)]();}[a227_0x5ad20f(0x187)](){const _0x144c16=a227_0x5ad20f;return{'orgId':this['orgId'],'accessToken':this['accessToken'],'instanceUrl':this[_0x144c16(0x183)]};}async[a227_0x5ad20f(0x1cf)](){const _0x514174=a227_0x5ad20f;return await this[_0x514174(0x18f)](),{'baseURL':this[_0x514174(0x183)],'headers':{'accept':'application/json','authorization':this[_0x514174(0x1b5)]+'\x20'+this[_0x514174(0x184)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1[a227_0x5ad20f(0x193)])(),__metadata('design:paramtypes',[])],SalesforceAuthService),exports[a227_0x5ad20f(0x197)]=SalesforceAuthService;