function a175_0x26fd(_0x12a007,_0x2ab61e){const _0x699c86=a175_0x32ed();return a175_0x26fd=function(_0x91d5a2,_0x816302){_0x91d5a2=_0x91d5a2-0x1d0;let _0x32edf4=_0x699c86[_0x91d5a2];return _0x32edf4;},a175_0x26fd(_0x12a007,_0x2ab61e);}const a175_0x1b7671=a175_0x26fd;(function(_0x57be00,_0x309d42){const _0x3bfcf5=a175_0x26fd,_0x8a594f=_0x57be00();while(!![]){try{const _0x1efedc=parseInt(_0x3bfcf5(0x1d7))/0x1+parseInt(_0x3bfcf5(0x1e3))/0x2+parseInt(_0x3bfcf5(0x204))/0x3*(-parseInt(_0x3bfcf5(0x1de))/0x4)+-parseInt(_0x3bfcf5(0x214))/0x5+parseInt(_0x3bfcf5(0x20c))/0x6+-parseInt(_0x3bfcf5(0x21c))/0x7*(parseInt(_0x3bfcf5(0x20a))/0x8)+parseInt(_0x3bfcf5(0x1ef))/0x9*(-parseInt(_0x3bfcf5(0x202))/0xa);if(_0x1efedc===_0x309d42)break;else _0x8a594f['push'](_0x8a594f['shift']());}catch(_0x1d937a){_0x8a594f['push'](_0x8a594f['shift']());}}}(a175_0x32ed,0x445d1));function a175_0x32ed(){const _0x5631d1=['245228JSMPTp','SALESFORCE_API_VERSION','metadata','default','Logger','setAuthDetails','AuthState','251996AVqjUA','typedi','post','length','force\x20update\x20token','506258jAcUsb','toString','(((.+)+)+)+$','Active','axios','instanceUrl','search','decorate','__createBinding','create\x20authorized\x20request\x20failed:\x20authorization\x20error','access\x20token\x20updated\x20for\x20%s','requestConfig','9OsNBUA','/services/oauth2/token','../../../../constants/errors','defineProperty','get','access_token','services/data/','authState','SalesforceAuthService','tokenType','AUTH_WAIT_TIME','response','orgId','__importStar','Idle','update\x20access\x20token\x20failed:\x20%s','data','catch','check\x20auth:\x20current\x20state\x20-\x20%s','2189910VfdMXZ','call','9WFlypM','InvalidRefreshTokenError','logger','__decorate','refresh_token','salesforce','25216UDlfbk','../../../../core','2447742kkLsCV','__esModule','updateAccessToken','getOwnPropertyDescriptor','Tokens','accessToken','design:paramtypes','joinURL','823625LRViOZ','UnauthorizedSalesforceError','apply','__setModuleDefault','name','waitAuth','Error','../../providers/providers.tokens','119AHDmts','../errors/invalid-refresh-token.error','application/json','log','../enums/auth-state.enum','../../../shared/utils','../../../../constants','forceUpdateToken','error','constructor','Updating','../errors/unauthorized-salesforce.error','prototype'];a175_0x32ed=function(){return _0x5631d1;};return a175_0x32ed();}const a175_0x816302=(function(){let _0x1a32c5=!![];return function(_0xee7314,_0x1eaea7){const _0x5a748d=_0x1a32c5?function(){const _0x2f6600=a175_0x26fd;if(_0x1eaea7){const _0x48a617=_0x1eaea7[_0x2f6600(0x216)](_0xee7314,arguments);return _0x1eaea7=null,_0x48a617;}}:function(){};return _0x1a32c5=![],_0x5a748d;};}()),a175_0x91d5a2=a175_0x816302(this,function(){const _0x49dda5=a175_0x26fd;return a175_0x91d5a2[_0x49dda5(0x1e4)]()['search'](_0x49dda5(0x1e5))[_0x49dda5(0x1e4)]()[_0x49dda5(0x1d3)](a175_0x91d5a2)[_0x49dda5(0x1e9)](_0x49dda5(0x1e5));});a175_0x91d5a2();'use strict';var __createBinding=this&&this[a175_0x1b7671(0x1eb)]||(Object['create']?function(_0x5adcb1,_0x47ece4,_0x2ed73b,_0xba81e8){const _0x153e31=a175_0x1b7671;if(_0xba81e8===undefined)_0xba81e8=_0x2ed73b;Object[_0x153e31(0x1f2)](_0x5adcb1,_0xba81e8,{'enumerable':!![],'get':function(){return _0x47ece4[_0x2ed73b];}});}:function(_0x3cc0d9,_0x2adb38,_0xf20f70,_0x1814ef){if(_0x1814ef===undefined)_0x1814ef=_0xf20f70;_0x3cc0d9[_0x1814ef]=_0x2adb38[_0xf20f70];}),__setModuleDefault=this&&this[a175_0x1b7671(0x217)]||(Object['create']?function(_0x2cd525,_0x3fec05){const _0x3453de=a175_0x1b7671;Object[_0x3453de(0x1f2)](_0x2cd525,_0x3453de(0x1da),{'enumerable':!![],'value':_0x3fec05});}:function(_0x389047,_0x1abf7e){const _0x7dff8b=a175_0x1b7671;_0x389047[_0x7dff8b(0x1da)]=_0x1abf7e;}),__decorate=this&&this[a175_0x1b7671(0x207)]||function(_0x34e043,_0x3501c7,_0x16115d,_0x46168b){const _0x90460d=a175_0x1b7671;var _0x3dfdca=arguments['length'],_0x1d8039=_0x3dfdca<0x3?_0x3501c7:_0x46168b===null?_0x46168b=Object[_0x90460d(0x20f)](_0x3501c7,_0x16115d):_0x46168b,_0x28f86d;if(typeof Reflect==='object'&&typeof Reflect[_0x90460d(0x1ea)]==='function')_0x1d8039=Reflect[_0x90460d(0x1ea)](_0x34e043,_0x3501c7,_0x16115d,_0x46168b);else{for(var _0x47c98d=_0x34e043[_0x90460d(0x1e1)]-0x1;_0x47c98d>=0x0;_0x47c98d--)if(_0x28f86d=_0x34e043[_0x47c98d])_0x1d8039=(_0x3dfdca<0x3?_0x28f86d(_0x1d8039):_0x3dfdca>0x3?_0x28f86d(_0x3501c7,_0x16115d,_0x1d8039):_0x28f86d(_0x3501c7,_0x16115d))||_0x1d8039;}return _0x3dfdca>0x3&&_0x1d8039&&Object[_0x90460d(0x1f2)](_0x3501c7,_0x16115d,_0x1d8039),_0x1d8039;},__importStar=this&&this[a175_0x1b7671(0x1fc)]||function(_0x6a1fa3){const _0x37cb71=a175_0x1b7671;if(_0x6a1fa3&&_0x6a1fa3[_0x37cb71(0x20d)])return _0x6a1fa3;var _0x1ce81a={};if(_0x6a1fa3!=null){for(var _0xea0eaf in _0x6a1fa3)if(_0xea0eaf!==_0x37cb71(0x1da)&&Object[_0x37cb71(0x1d6)]['hasOwnProperty'][_0x37cb71(0x203)](_0x6a1fa3,_0xea0eaf))__createBinding(_0x1ce81a,_0x6a1fa3,_0xea0eaf);}return __setModuleDefault(_0x1ce81a,_0x6a1fa3),_0x1ce81a;},__metadata=this&&this['__metadata']||function(_0x3e40f6,_0x4534c4){const _0x278571=a175_0x1b7671;if(typeof Reflect==='object'&&typeof Reflect[_0x278571(0x1d9)]==='function')return Reflect['metadata'](_0x3e40f6,_0x4534c4);},__importDefault=this&&this['__importDefault']||function(_0x145eab){const _0x52797d=a175_0x1b7671;return _0x145eab&&_0x145eab[_0x52797d(0x20d)]?_0x145eab:{'default':_0x145eab};},SalesforceAuthService_1;Object['defineProperty'](exports,a175_0x1b7671(0x20d),{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=__importStar(require(a175_0x1b7671(0x1df))),errors_1=require(a175_0x1b7671(0x1f1)),core_1=require(a175_0x1b7671(0x20b)),axios_1=__importDefault(require(a175_0x1b7671(0x1e7))),utils_1=require(a175_0x1b7671(0x221)),invalid_refresh_token_error_1=require(a175_0x1b7671(0x21d)),auth_state_enum_1=require(a175_0x1b7671(0x220)),unauthorized_salesforce_error_1=require(a175_0x1b7671(0x1d5)),constants_1=require(a175_0x1b7671(0x1d0)),providers_tokens_1=require(a175_0x1b7671(0x21b));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x5f5887=a175_0x1b7671;this[_0x5f5887(0x1f9)]=0x1388,this['authState']=auth_state_enum_1[_0x5f5887(0x1dd)][_0x5f5887(0x1fd)],this['logger']=new core_1[(_0x5f5887(0x1db))](SalesforceAuthService_1[_0x5f5887(0x218)]),this[_0x5f5887(0x1dc)]();}async[a175_0x1b7671(0x1dc)](){const _0x223de4=a175_0x1b7671;this[_0x223de4(0x206)][_0x223de4(0x21f)](_0x223de4(0x201),auth_state_enum_1['AuthState'][this[_0x223de4(0x1f6)]]);try{if(this['authState']===auth_state_enum_1[_0x223de4(0x1dd)]['Error'])return;if(this[_0x223de4(0x1f6)]===auth_state_enum_1[_0x223de4(0x1dd)]['Idle'])await this[_0x223de4(0x20e)]();else{const _0x2ba12f=await this[_0x223de4(0x1ee)](),_0x5983ec=await axios_1[_0x223de4(0x1da)]['get'](_0x223de4(0x1f5)+constants_1[_0x223de4(0x1d8)],_0x2ba12f)['then'](()=>!![])[_0x223de4(0x200)](()=>![]);!_0x5983ec&&await this['updateAccessToken']();}}catch(_0x165776){}}async[a175_0x1b7671(0x20e)](){const _0xefc53d=a175_0x1b7671;var _0x391e60,_0x4b1e92,_0x7b2df1;this[_0xefc53d(0x206)]['log']('update\x20access\x20token');try{this[_0xefc53d(0x1f6)]=auth_state_enum_1[_0xefc53d(0x1dd)][_0xefc53d(0x1d4)];const {refreshToken:_0x202229,clientId:_0x42e48a,clientSecret:_0x24f8c4,loginUrl:_0x4c0ba2}=typedi_1['default'][_0xefc53d(0x1f3)](providers_tokens_1[_0xefc53d(0x210)][_0xefc53d(0x209)]),{data:_0x28dc19}=await axios_1[_0xefc53d(0x1da)][_0xefc53d(0x1e0)](utils_1[_0xefc53d(0x213)](_0x4c0ba2,_0xefc53d(0x1f0)),null,{'params':{'grant_type':_0xefc53d(0x208),'refresh_token':_0x202229,'client_id':_0x42e48a,'client_secret':_0x24f8c4}});this[_0xefc53d(0x1e8)]=_0x28dc19['instance_url'],this[_0xefc53d(0x211)]=_0x28dc19[_0xefc53d(0x1f4)],this['tokenType']=_0x28dc19['token_type'],this[_0xefc53d(0x1f6)]=auth_state_enum_1[_0xefc53d(0x1dd)][_0xefc53d(0x1e6)],this[_0xefc53d(0x206)]['log'](_0xefc53d(0x1ed),this[_0xefc53d(0x1e8)]);}catch(_0x1d78c8){const _0x112a2c=((_0x4b1e92=(_0x391e60=_0x1d78c8===null||_0x1d78c8===void 0x0?void 0x0:_0x1d78c8[_0xefc53d(0x1fa)])===null||_0x391e60===void 0x0?void 0x0:_0x391e60[_0xefc53d(0x1ff)])===null||_0x4b1e92===void 0x0?void 0x0:_0x4b1e92[_0xefc53d(0x1d2)])||((_0x7b2df1=_0x1d78c8===null||_0x1d78c8===void 0x0?void 0x0:_0x1d78c8[_0xefc53d(0x1fa)])===null||_0x7b2df1===void 0x0?void 0x0:_0x7b2df1['data'])||_0x1d78c8['message'];this[_0xefc53d(0x206)][_0xefc53d(0x1d2)](_0xefc53d(0x1fe),_0x112a2c),this['authState']=auth_state_enum_1[_0xefc53d(0x1dd)][_0xefc53d(0x21a)];throw new invalid_refresh_token_error_1[(_0xefc53d(0x205))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async[a175_0x1b7671(0x1d1)](){const _0x542305=a175_0x1b7671;this[_0x542305(0x206)][_0x542305(0x21f)](_0x542305(0x1e2));if(this[_0x542305(0x1f6)]===auth_state_enum_1[_0x542305(0x1dd)]['Updating']||this[_0x542305(0x1f6)]===auth_state_enum_1[_0x542305(0x1dd)][_0x542305(0x1fd)])return await utils_1['sleep'](this[_0x542305(0x1f9)]),this[_0x542305(0x1d1)]();if(this[_0x542305(0x1f6)]===auth_state_enum_1[_0x542305(0x1dd)]['Error'])throw new invalid_refresh_token_error_1[(_0x542305(0x205))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this['updateAccessToken']();}async[a175_0x1b7671(0x219)](){const _0x22c973=a175_0x1b7671;if(this['authState']===auth_state_enum_1[_0x22c973(0x1dd)]['Error']){this[_0x22c973(0x206)][_0x22c973(0x21f)](_0x22c973(0x1ec));throw new unauthorized_salesforce_error_1[(_0x22c973(0x215))]();}if(this[_0x22c973(0x1f6)]!==auth_state_enum_1[_0x22c973(0x1dd)]['Active'])return this[_0x22c973(0x206)][_0x22c973(0x21f)]('create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done'),await utils_1['sleep'](this[_0x22c973(0x1f9)]),this[_0x22c973(0x219)]();}['getAuthData'](){const _0x26adda=a175_0x1b7671;return{'orgId':this[_0x26adda(0x1fb)],'accessToken':this[_0x26adda(0x211)],'instanceUrl':this[_0x26adda(0x1e8)]};}async[a175_0x1b7671(0x1ee)](){const _0x2eddd6=a175_0x1b7671;return await this[_0x2eddd6(0x219)](),{'baseURL':this[_0x2eddd6(0x1e8)],'headers':{'accept':_0x2eddd6(0x21e),'authorization':this[_0x2eddd6(0x1f8)]+'\x20'+this[_0x2eddd6(0x211)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1['Service'](),__metadata(a175_0x1b7671(0x212),[])],SalesforceAuthService),exports[a175_0x1b7671(0x1f7)]=SalesforceAuthService;