const a227_0x1b3b57=a227_0x1d37;(function(_0x2b6ef5,_0x3174e3){const _0x3cb1a9=a227_0x1d37,_0x4e8da7=_0x2b6ef5();while(!![]){try{const _0x314e05=-parseInt(_0x3cb1a9(0x1ba))/0x1*(-parseInt(_0x3cb1a9(0x1f0))/0x2)+-parseInt(_0x3cb1a9(0x1d7))/0x3*(-parseInt(_0x3cb1a9(0x1bc))/0x4)+parseInt(_0x3cb1a9(0x1f3))/0x5*(parseInt(_0x3cb1a9(0x1bd))/0x6)+-parseInt(_0x3cb1a9(0x1ae))/0x7*(parseInt(_0x3cb1a9(0x1db))/0x8)+-parseInt(_0x3cb1a9(0x1d2))/0x9*(-parseInt(_0x3cb1a9(0x1a4))/0xa)+-parseInt(_0x3cb1a9(0x1b2))/0xb+parseInt(_0x3cb1a9(0x1d0))/0xc*(-parseInt(_0x3cb1a9(0x1c3))/0xd);if(_0x314e05===_0x3174e3)break;else _0x4e8da7['push'](_0x4e8da7['shift']());}catch(_0x3129e2){_0x4e8da7['push'](_0x4e8da7['shift']());}}}(a227_0x2905,0xcf98d));const a227_0x2c7c2b=(function(){let _0x247476=!![];return function(_0x300726,_0x595194){const _0x339385=_0x247476?function(){const _0x42b2a1=a227_0x1d37;if(_0x595194){const _0x491e95=_0x595194[_0x42b2a1(0x1ee)](_0x300726,arguments);return _0x595194=null,_0x491e95;}}:function(){};return _0x247476=![],_0x339385;};}()),a227_0x201acd=a227_0x2c7c2b(this,function(){const _0x44c5e9=a227_0x1d37;return a227_0x201acd[_0x44c5e9(0x1b5)]()[_0x44c5e9(0x1af)]('(((.+)+)+)+$')[_0x44c5e9(0x1b5)]()[_0x44c5e9(0x1e9)](a227_0x201acd)[_0x44c5e9(0x1af)](_0x44c5e9(0x1f2));});function a227_0x2905(){const _0x2b28d4=['__setModuleDefault','length','create\x20authorized\x20request\x20failed:\x20authorization\x20error','requestConfig','7xQciMx','search','waitAuth','application/json','11419837jvzBTu','data','check\x20auth:\x20current\x20state\x20-\x20%s','toString','catch','logger','update\x20access\x20token\x20failed:\x20%s','Error','287AwroZv','post','4hBLmnu','12dzrwNf','hasOwnProperty','ERR_INVALID_SALESFORCE_TOKEN','AuthState','authState','SALESFORCE_API_VERSION','13QvvYnv','instanceUrl','SalesforceAuthService','token_type','call','__createBinding','axios','defineProperty','Tokens','updateAccessToken','typedi','error','Idle','6574884hgLxdN','forceUpdateToken','252rlcYtz','default','log','../errors/invalid-refresh-token.error','joinURL','3982053LRKWus','sleep','__metadata','metadata','11941064PNctKV','/services/oauth2/token','UnauthorizedSalesforceError','create','__importDefault','tokenType','InvalidRefreshTokenError','getOwnPropertyDescriptor','access_token','object','design:paramtypes','__esModule','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','getAuthData','constructor','services/data/','../../../../constants/errors','accessToken','prototype','apply','../../providers/providers.tokens','3282rPkWuZ','instance_url','(((.+)+)+)+$','1765865KPRfcD','get','refresh_token','../../../../constants','writable','Active','response','Updating','name','salesforce','setAuthDetails','then','508700PFWFVu','configurable','decorate','AUTH_WAIT_TIME','Logger','../../../shared/utils'];a227_0x2905=function(){return _0x2b28d4;};return a227_0x2905();}a227_0x201acd();'use strict';var __createBinding=this&&this[a227_0x1b3b57(0x1c8)]||(Object[a227_0x1b3b57(0x1de)]?function(_0x31ab8a,_0x110638,_0x42438b,_0x15375e){const _0x1bd130=a227_0x1b3b57;if(_0x15375e===undefined)_0x15375e=_0x42438b;var _0x26f3ef=Object['getOwnPropertyDescriptor'](_0x110638,_0x42438b);(!_0x26f3ef||(_0x1bd130(0x1f4)in _0x26f3ef?!_0x110638[_0x1bd130(0x1e6)]:_0x26f3ef[_0x1bd130(0x1f7)]||_0x26f3ef[_0x1bd130(0x1a5)]))&&(_0x26f3ef={'enumerable':!![],'get':function(){return _0x110638[_0x42438b];}}),Object[_0x1bd130(0x1ca)](_0x31ab8a,_0x15375e,_0x26f3ef);}:function(_0x5944fe,_0x2bd67c,_0xf78e70,_0x4d58a1){if(_0x4d58a1===undefined)_0x4d58a1=_0xf78e70;_0x5944fe[_0x4d58a1]=_0x2bd67c[_0xf78e70];}),__setModuleDefault=this&&this[a227_0x1b3b57(0x1aa)]||(Object['create']?function(_0x4689ee,_0x4871aa){const _0x4d73f1=a227_0x1b3b57;Object[_0x4d73f1(0x1ca)](_0x4689ee,_0x4d73f1(0x1d3),{'enumerable':!![],'value':_0x4871aa});}:function(_0x2ce1ba,_0x36dc5f){const _0x591952=a227_0x1b3b57;_0x2ce1ba[_0x591952(0x1d3)]=_0x36dc5f;}),__decorate=this&&this['__decorate']||function(_0x1721c9,_0x19119e,_0x456146,_0x37596e){const _0x59cac8=a227_0x1b3b57;var _0x171e23=arguments[_0x59cac8(0x1ab)],_0x5abf25=_0x171e23<0x3?_0x19119e:_0x37596e===null?_0x37596e=Object[_0x59cac8(0x1e2)](_0x19119e,_0x456146):_0x37596e,_0x385ed5;if(typeof Reflect===_0x59cac8(0x1e4)&&typeof Reflect['decorate']==='function')_0x5abf25=Reflect[_0x59cac8(0x1a6)](_0x1721c9,_0x19119e,_0x456146,_0x37596e);else{for(var _0x576374=_0x1721c9['length']-0x1;_0x576374>=0x0;_0x576374--)if(_0x385ed5=_0x1721c9[_0x576374])_0x5abf25=(_0x171e23<0x3?_0x385ed5(_0x5abf25):_0x171e23>0x3?_0x385ed5(_0x19119e,_0x456146,_0x5abf25):_0x385ed5(_0x19119e,_0x456146))||_0x5abf25;}return _0x171e23>0x3&&_0x5abf25&&Object[_0x59cac8(0x1ca)](_0x19119e,_0x456146,_0x5abf25),_0x5abf25;},__importStar=this&&this['__importStar']||function(_0x92d801){const _0x2d4d9e=a227_0x1b3b57;if(_0x92d801&&_0x92d801[_0x2d4d9e(0x1e6)])return _0x92d801;var _0x2a7afc={};if(_0x92d801!=null){for(var _0x2cdc40 in _0x92d801)if(_0x2cdc40!=='default'&&Object[_0x2d4d9e(0x1ed)][_0x2d4d9e(0x1be)][_0x2d4d9e(0x1c7)](_0x92d801,_0x2cdc40))__createBinding(_0x2a7afc,_0x92d801,_0x2cdc40);}return __setModuleDefault(_0x2a7afc,_0x92d801),_0x2a7afc;},__metadata=this&&this[a227_0x1b3b57(0x1d9)]||function(_0x35f9b0,_0x5c5ed7){const _0xe40186=a227_0x1b3b57;if(typeof Reflect===_0xe40186(0x1e4)&&typeof Reflect[_0xe40186(0x1da)]==='function')return Reflect[_0xe40186(0x1da)](_0x35f9b0,_0x5c5ed7);},__importDefault=this&&this[a227_0x1b3b57(0x1df)]||function(_0x5a441f){return _0x5a441f&&_0x5a441f['__esModule']?_0x5a441f:{'default':_0x5a441f};},SalesforceAuthService_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a227_0x1b3b57(0x1c5)]=void 0x0;const typedi_1=__importStar(require(a227_0x1b3b57(0x1cd))),errors_1=require(a227_0x1b3b57(0x1eb)),core_1=require('../../../../core'),axios_1=__importDefault(require(a227_0x1b3b57(0x1c9))),utils_1=require(a227_0x1b3b57(0x1a9)),invalid_refresh_token_error_1=require(a227_0x1b3b57(0x1d5)),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a227_0x1b3b57(0x1f6)),providers_tokens_1=require(a227_0x1b3b57(0x1ef));function a227_0x1d37(_0x1aa4a6,_0x1a1e2a){const _0x442ee7=a227_0x2905();return a227_0x1d37=function(_0x201acd,_0x2c7c2b){_0x201acd=_0x201acd-0x1a0;let _0x2905ae=_0x442ee7[_0x201acd];return _0x2905ae;},a227_0x1d37(_0x1aa4a6,_0x1a1e2a);}let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x5c5ff1=a227_0x1b3b57;this[_0x5c5ff1(0x1a7)]=0x1388,this[_0x5c5ff1(0x1c1)]=auth_state_enum_1[_0x5c5ff1(0x1c0)][_0x5c5ff1(0x1cf)],this[_0x5c5ff1(0x1b7)]=new core_1[(_0x5c5ff1(0x1a8))](SalesforceAuthService_1[_0x5c5ff1(0x1a0)]),this[_0x5c5ff1(0x1a2)]();}async['setAuthDetails'](){const _0x1c43f2=a227_0x1b3b57;this[_0x1c43f2(0x1b7)][_0x1c43f2(0x1d4)](_0x1c43f2(0x1b4),auth_state_enum_1[_0x1c43f2(0x1c0)][this[_0x1c43f2(0x1c1)]]);try{if(this[_0x1c43f2(0x1c1)]===auth_state_enum_1[_0x1c43f2(0x1c0)][_0x1c43f2(0x1b9)])return;if(this['authState']===auth_state_enum_1[_0x1c43f2(0x1c0)][_0x1c43f2(0x1cf)])await this[_0x1c43f2(0x1cc)]();else{const _0x2479ba=await this[_0x1c43f2(0x1ad)](),_0x495b14=await axios_1['default'][_0x1c43f2(0x1f4)](_0x1c43f2(0x1ea)+constants_1[_0x1c43f2(0x1c2)],_0x2479ba)[_0x1c43f2(0x1a3)](()=>!![])[_0x1c43f2(0x1b6)](()=>![]);!_0x495b14&&await this['updateAccessToken']();}}catch(_0x13615a){}}async[a227_0x1b3b57(0x1cc)](){const _0x53accc=a227_0x1b3b57;var _0x278f64,_0x5f04df,_0x32e553;this[_0x53accc(0x1b7)][_0x53accc(0x1d4)]('update\x20access\x20token');try{this[_0x53accc(0x1c1)]=auth_state_enum_1[_0x53accc(0x1c0)][_0x53accc(0x1fa)];const {refreshToken:_0x11ee86,clientId:_0x192a8b,clientSecret:_0x2bda3b,loginUrl:_0x5d750a}=typedi_1[_0x53accc(0x1d3)][_0x53accc(0x1f4)](providers_tokens_1[_0x53accc(0x1cb)][_0x53accc(0x1a1)]),{data:_0x3ea9f1}=await axios_1['default'][_0x53accc(0x1bb)]((0x0,utils_1[_0x53accc(0x1d6)])(_0x5d750a,_0x53accc(0x1dc)),null,{'params':{'grant_type':_0x53accc(0x1f5),'refresh_token':_0x11ee86,'client_id':_0x192a8b,'client_secret':_0x2bda3b}});this[_0x53accc(0x1c4)]=_0x3ea9f1[_0x53accc(0x1f1)],this[_0x53accc(0x1ec)]=_0x3ea9f1[_0x53accc(0x1e3)],this[_0x53accc(0x1e0)]=_0x3ea9f1[_0x53accc(0x1c6)],this['authState']=auth_state_enum_1[_0x53accc(0x1c0)][_0x53accc(0x1f8)],this[_0x53accc(0x1b7)][_0x53accc(0x1d4)]('access\x20token\x20updated\x20for\x20%s',this[_0x53accc(0x1c4)]);}catch(_0x5b13b5){const _0x38c37f=((_0x5f04df=(_0x278f64=_0x5b13b5===null||_0x5b13b5===void 0x0?void 0x0:_0x5b13b5[_0x53accc(0x1f9)])===null||_0x278f64===void 0x0?void 0x0:_0x278f64['data'])===null||_0x5f04df===void 0x0?void 0x0:_0x5f04df[_0x53accc(0x1ce)])||((_0x32e553=_0x5b13b5===null||_0x5b13b5===void 0x0?void 0x0:_0x5b13b5[_0x53accc(0x1f9)])===null||_0x32e553===void 0x0?void 0x0:_0x32e553[_0x53accc(0x1b3)])||_0x5b13b5['message'];this[_0x53accc(0x1b7)][_0x53accc(0x1ce)](_0x53accc(0x1b8),_0x38c37f),this[_0x53accc(0x1c1)]=auth_state_enum_1[_0x53accc(0x1c0)][_0x53accc(0x1b9)];throw new invalid_refresh_token_error_1[(_0x53accc(0x1e1))](errors_1[_0x53accc(0x1bf)]);}}async['forceUpdateToken'](){const _0x397f51=a227_0x1b3b57;this[_0x397f51(0x1b7)]['log']('force\x20update\x20token');if(this['authState']===auth_state_enum_1[_0x397f51(0x1c0)]['Updating']||this[_0x397f51(0x1c1)]===auth_state_enum_1[_0x397f51(0x1c0)]['Idle'])return await(0x0,utils_1[_0x397f51(0x1d8)])(this[_0x397f51(0x1a7)]),this[_0x397f51(0x1d1)]();if(this['authState']===auth_state_enum_1[_0x397f51(0x1c0)][_0x397f51(0x1b9)])throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x397f51(0x1bf)]);await this[_0x397f51(0x1cc)]();}async['waitAuth'](){const _0x207b5d=a227_0x1b3b57;if(this[_0x207b5d(0x1c1)]===auth_state_enum_1[_0x207b5d(0x1c0)][_0x207b5d(0x1b9)]){this[_0x207b5d(0x1b7)][_0x207b5d(0x1d4)](_0x207b5d(0x1ac));throw new unauthorized_salesforce_error_1[(_0x207b5d(0x1dd))]();}if(this[_0x207b5d(0x1c1)]!==auth_state_enum_1[_0x207b5d(0x1c0)][_0x207b5d(0x1f8)])return this[_0x207b5d(0x1b7)][_0x207b5d(0x1d4)](_0x207b5d(0x1e7)),await(0x0,utils_1[_0x207b5d(0x1d8)])(this['AUTH_WAIT_TIME']),this[_0x207b5d(0x1b0)]();}[a227_0x1b3b57(0x1e8)](){const _0x2f924c=a227_0x1b3b57;return{'orgId':this['orgId'],'accessToken':this['accessToken'],'instanceUrl':this[_0x2f924c(0x1c4)]};}async[a227_0x1b3b57(0x1ad)](){const _0x1fbbe7=a227_0x1b3b57;return await this[_0x1fbbe7(0x1b0)](),{'baseURL':this[_0x1fbbe7(0x1c4)],'headers':{'accept':_0x1fbbe7(0x1b1),'authorization':this[_0x1fbbe7(0x1e0)]+'\x20'+this[_0x1fbbe7(0x1ec)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a227_0x1b3b57(0x1e5),[])],SalesforceAuthService),exports[a227_0x1b3b57(0x1c5)]=SalesforceAuthService;