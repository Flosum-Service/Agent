function a269_0x187f(){const _0xe7e5c0=['services/data/','design:paramtypes','InvalidRefreshTokenError','writable','(((.+)+)+)+$','__metadata','../../../../constants','length','isBulk1Url','Create\x20authorized\x20request\x20failed:\x20authorization\x20error','Create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','decorate','prototype','Update\x20access\x20token','forceUpdateToken','2676RKriAE','accessToken','@flosum/salesforce','refresh_token','authorization','9771715JRgHMj','isSoapUrl','3268035LxwWCi','/services/oauth2/token','Access\x20token\x20updated\x20for\x20%s','data','toString','<met:sessionId>','../enums/auth-state.enum','__setModuleDefault','AUTH_WAIT_TIME','error','10TPpqNB','response','catch','name','create','__importStar','../../../shared/utils','SALESFORCE_API_VERSION','setAuthDetails','Updating','apply','15NKWuHy','getOwnPropertyDescriptor','AuthState','logger','tokenType','instanceUrl','search','joinURL','application/json','constructor','__decorate','</met:sessionId>','Error','waitAuth','592eoGBMG','483747lEtURr','Idle','function','Update\x20access\x20token\x20failed:\x20%s','__esModule','SalesforceUtils','then','token_type','../../../../constants/errors','headers','13113120POjZFx','UnauthorizedSalesforceError','Logger','message','defineProperty','log','access_token','X-SFDC-Session','post','default','call','1321084FYMRde','getAuthData','Force\x20update\x20token','typedi','SalesforceAuthService','object','configurable','authState','instance_url','1004pyvXEZ','updateAccessToken','../../../../core','ERR_INVALID_SALESFORCE_TOKEN','6oqFjJe','Active','get','137879KOoCbf','salesforce'];a269_0x187f=function(){return _0xe7e5c0;};return a269_0x187f();}const a269_0x130c68=a269_0x5ceb;(function(_0x2294d0,_0x4ed963){const _0x50cedf=a269_0x5ceb,_0x2bdac4=_0x2294d0();while(!![]){try{const _0x2be814=parseInt(_0x50cedf(0x18e))/0x1*(parseInt(_0x50cedf(0x145))/0x2)+-parseInt(_0x50cedf(0x161))/0x3*(-parseInt(_0x50cedf(0x185))/0x4)+parseInt(_0x50cedf(0x14a))/0x5*(-parseInt(_0x50cedf(0x192))/0x6)+-parseInt(_0x50cedf(0x195))/0x7*(-parseInt(_0x50cedf(0x16f))/0x8)+-parseInt(_0x50cedf(0x14c))/0x9+-parseInt(_0x50cedf(0x156))/0xa*(parseInt(_0x50cedf(0x170))/0xb)+-parseInt(_0x50cedf(0x17a))/0xc;if(_0x2be814===_0x4ed963)break;else _0x2bdac4['push'](_0x2bdac4['shift']());}catch(_0xff307f){_0x2bdac4['push'](_0x2bdac4['shift']());}}}(a269_0x187f,0xf3aca));const a269_0x3818f7=(function(){let _0x2d290a=!![];return function(_0x45bee5,_0x5c4055){const _0x3dc7ad=_0x2d290a?function(){const _0x3afd34=a269_0x5ceb;if(_0x5c4055){const _0x4f0404=_0x5c4055[_0x3afd34(0x160)](_0x45bee5,arguments);return _0x5c4055=null,_0x4f0404;}}:function(){};return _0x2d290a=![],_0x3dc7ad;};}()),a269_0x5993d1=a269_0x3818f7(this,function(){const _0x982ce4=a269_0x5ceb;return a269_0x5993d1[_0x982ce4(0x150)]()[_0x982ce4(0x167)](_0x982ce4(0x19b))[_0x982ce4(0x150)]()[_0x982ce4(0x16a)](a269_0x5993d1)[_0x982ce4(0x167)](_0x982ce4(0x19b));});a269_0x5993d1();function a269_0x5ceb(_0xf499e2,_0x18a40e){const _0x55d701=a269_0x187f();return a269_0x5ceb=function(_0x5993d1,_0x3818f7){_0x5993d1=_0x5993d1-0x145;let _0x187f0a=_0x55d701[_0x5993d1];return _0x187f0a;},a269_0x5ceb(_0xf499e2,_0x18a40e);}'use strict';var __createBinding=this&&this['__createBinding']||(Object[a269_0x130c68(0x15a)]?function(_0x57903c,_0x18959b,_0x2e19e2,_0x444cc3){const _0xde8373=a269_0x130c68;if(_0x444cc3===undefined)_0x444cc3=_0x2e19e2;var _0xeb7a39=Object[_0xde8373(0x162)](_0x18959b,_0x2e19e2);(!_0xeb7a39||(_0xde8373(0x194)in _0xeb7a39?!_0x18959b[_0xde8373(0x174)]:_0xeb7a39[_0xde8373(0x19a)]||_0xeb7a39[_0xde8373(0x18b)]))&&(_0xeb7a39={'enumerable':!![],'get':function(){return _0x18959b[_0x2e19e2];}}),Object['defineProperty'](_0x57903c,_0x444cc3,_0xeb7a39);}:function(_0x282d89,_0x1eb618,_0x182d0d,_0x110f49){if(_0x110f49===undefined)_0x110f49=_0x182d0d;_0x282d89[_0x110f49]=_0x1eb618[_0x182d0d];}),__setModuleDefault=this&&this[a269_0x130c68(0x153)]||(Object[a269_0x130c68(0x15a)]?function(_0x29ed82,_0x2aa9ba){const _0x5a125c=a269_0x130c68;Object['defineProperty'](_0x29ed82,_0x5a125c(0x183),{'enumerable':!![],'value':_0x2aa9ba});}:function(_0x187d97,_0x4e4354){const _0x40dc04=a269_0x130c68;_0x187d97[_0x40dc04(0x183)]=_0x4e4354;}),__decorate=this&&this[a269_0x130c68(0x16b)]||function(_0xc5ef,_0x1e6816,_0x2cc228,_0x13757b){const _0x4fc321=a269_0x130c68;var _0x45f252=arguments[_0x4fc321(0x19e)],_0x310bf0=_0x45f252<0x3?_0x1e6816:_0x13757b===null?_0x13757b=Object[_0x4fc321(0x162)](_0x1e6816,_0x2cc228):_0x13757b,_0x1f89f3;if(typeof Reflect===_0x4fc321(0x18a)&&typeof Reflect[_0x4fc321(0x1a2)]==='function')_0x310bf0=Reflect[_0x4fc321(0x1a2)](_0xc5ef,_0x1e6816,_0x2cc228,_0x13757b);else{for(var _0x1eebff=_0xc5ef[_0x4fc321(0x19e)]-0x1;_0x1eebff>=0x0;_0x1eebff--)if(_0x1f89f3=_0xc5ef[_0x1eebff])_0x310bf0=(_0x45f252<0x3?_0x1f89f3(_0x310bf0):_0x45f252>0x3?_0x1f89f3(_0x1e6816,_0x2cc228,_0x310bf0):_0x1f89f3(_0x1e6816,_0x2cc228))||_0x310bf0;}return _0x45f252>0x3&&_0x310bf0&&Object[_0x4fc321(0x17e)](_0x1e6816,_0x2cc228,_0x310bf0),_0x310bf0;},__importStar=this&&this[a269_0x130c68(0x15b)]||function(_0x3cec0b){const _0x1e5cf8=a269_0x130c68;if(_0x3cec0b&&_0x3cec0b[_0x1e5cf8(0x174)])return _0x3cec0b;var _0x358415={};if(_0x3cec0b!=null){for(var _0xb8d296 in _0x3cec0b)if(_0xb8d296!==_0x1e5cf8(0x183)&&Object[_0x1e5cf8(0x1a3)]['hasOwnProperty'][_0x1e5cf8(0x184)](_0x3cec0b,_0xb8d296))__createBinding(_0x358415,_0x3cec0b,_0xb8d296);}return __setModuleDefault(_0x358415,_0x3cec0b),_0x358415;},__metadata=this&&this[a269_0x130c68(0x19c)]||function(_0x299712,_0x37b184){const _0x557211=a269_0x130c68;if(typeof Reflect===_0x557211(0x18a)&&typeof Reflect['metadata']===_0x557211(0x172))return Reflect['metadata'](_0x299712,_0x37b184);},__importDefault=this&&this['__importDefault']||function(_0x3477b0){const _0x5907e0=a269_0x130c68;return _0x3477b0&&_0x3477b0[_0x5907e0(0x174)]?_0x3477b0:{'default':_0x3477b0};},SalesforceAuthService_1;Object[a269_0x130c68(0x17e)](exports,a269_0x130c68(0x174),{'value':!![]}),exports[a269_0x130c68(0x189)]=void 0x0;const typedi_1=__importStar(require(a269_0x130c68(0x188))),errors_1=require(a269_0x130c68(0x178)),core_1=require(a269_0x130c68(0x190)),axios_1=__importDefault(require('axios')),utils_1=require(a269_0x130c68(0x15c)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require(a269_0x130c68(0x152)),unauthorized_salesforce_error_1=require('../errors/unauthorized-salesforce.error'),constants_1=require(a269_0x130c68(0x19d)),providers_tokens_1=require('../../providers/providers.tokens'),salesforce_1=require(a269_0x130c68(0x147));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x852273=a269_0x130c68;this[_0x852273(0x154)]=0x1388,this[_0x852273(0x18c)]=auth_state_enum_1['AuthState'][_0x852273(0x171)],this[_0x852273(0x164)]=new core_1[(_0x852273(0x17c))](SalesforceAuthService_1[_0x852273(0x159)]),this[_0x852273(0x15e)]();}async[a269_0x130c68(0x15e)](){const _0x3f679d=a269_0x130c68;this[_0x3f679d(0x164)]['log']('Check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1[_0x3f679d(0x163)][this[_0x3f679d(0x18c)]]);try{if(this[_0x3f679d(0x18c)]===auth_state_enum_1[_0x3f679d(0x163)][_0x3f679d(0x16d)])return;if(this[_0x3f679d(0x18c)]===auth_state_enum_1[_0x3f679d(0x163)][_0x3f679d(0x171)])await this[_0x3f679d(0x18f)]();else{const _0x4a3e3d=await this['requestConfig'](),_0x4a0f47=await axios_1[_0x3f679d(0x183)][_0x3f679d(0x194)](_0x3f679d(0x197)+constants_1[_0x3f679d(0x15d)],_0x4a3e3d)[_0x3f679d(0x176)](()=>!![])[_0x3f679d(0x158)](()=>![]);!_0x4a0f47&&await this['updateAccessToken']();}}catch(_0x4d2880){}}async[a269_0x130c68(0x18f)](){const _0x449bde=a269_0x130c68;var _0x1299ed,_0x4bbda4,_0x4f7e54;this[_0x449bde(0x164)][_0x449bde(0x17f)](_0x449bde(0x1a4));try{this[_0x449bde(0x18c)]=auth_state_enum_1[_0x449bde(0x163)][_0x449bde(0x15f)];const {refreshToken:_0x1c3b19,clientId:_0xe1c10f,clientSecret:_0xc3e5e,loginUrl:_0x49f396}=typedi_1[_0x449bde(0x183)][_0x449bde(0x194)](providers_tokens_1['Tokens'][_0x449bde(0x196)]),{data:_0x2015c4}=await axios_1[_0x449bde(0x183)][_0x449bde(0x182)]((0x0,utils_1[_0x449bde(0x168)])(_0x49f396,_0x449bde(0x14d)),null,{'params':{'grant_type':_0x449bde(0x148),'refresh_token':_0x1c3b19,'client_id':_0xe1c10f,'client_secret':_0xc3e5e}});this[_0x449bde(0x166)]=_0x2015c4[_0x449bde(0x18d)],this[_0x449bde(0x146)]=_0x2015c4[_0x449bde(0x180)],this[_0x449bde(0x165)]=_0x2015c4[_0x449bde(0x177)],this[_0x449bde(0x18c)]=auth_state_enum_1[_0x449bde(0x163)][_0x449bde(0x193)],this[_0x449bde(0x164)][_0x449bde(0x17f)](_0x449bde(0x14e),this[_0x449bde(0x166)]);}catch(_0x2c8e2a){const _0x4a708b=((_0x4bbda4=(_0x1299ed=_0x2c8e2a===null||_0x2c8e2a===void 0x0?void 0x0:_0x2c8e2a[_0x449bde(0x157)])===null||_0x1299ed===void 0x0?void 0x0:_0x1299ed[_0x449bde(0x14f)])===null||_0x4bbda4===void 0x0?void 0x0:_0x4bbda4[_0x449bde(0x155)])||((_0x4f7e54=_0x2c8e2a===null||_0x2c8e2a===void 0x0?void 0x0:_0x2c8e2a['response'])===null||_0x4f7e54===void 0x0?void 0x0:_0x4f7e54['data'])||_0x2c8e2a[_0x449bde(0x17d)];this[_0x449bde(0x164)][_0x449bde(0x155)](_0x449bde(0x173),_0x4a708b),this[_0x449bde(0x18c)]=auth_state_enum_1['AuthState'][_0x449bde(0x16d)];throw new invalid_refresh_token_error_1[(_0x449bde(0x199))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);}}async['forceUpdateToken'](){const _0x3993d8=a269_0x130c68;this[_0x3993d8(0x164)][_0x3993d8(0x17f)](_0x3993d8(0x187));if(this[_0x3993d8(0x18c)]===auth_state_enum_1['AuthState'][_0x3993d8(0x15f)]||this[_0x3993d8(0x18c)]===auth_state_enum_1['AuthState'][_0x3993d8(0x171)])return await(0x0,utils_1['sleep'])(this[_0x3993d8(0x154)]),this[_0x3993d8(0x1a5)]();if(this[_0x3993d8(0x18c)]===auth_state_enum_1['AuthState'][_0x3993d8(0x16d)])throw new invalid_refresh_token_error_1[(_0x3993d8(0x199))](errors_1[_0x3993d8(0x191)]);await this['updateAccessToken']();}async[a269_0x130c68(0x16e)](){const _0xcbeb46=a269_0x130c68;if(this[_0xcbeb46(0x18c)]===auth_state_enum_1[_0xcbeb46(0x163)][_0xcbeb46(0x16d)]){this[_0xcbeb46(0x164)][_0xcbeb46(0x17f)](_0xcbeb46(0x1a0));throw new unauthorized_salesforce_error_1[(_0xcbeb46(0x17b))]();}if(this['authState']!==auth_state_enum_1[_0xcbeb46(0x163)]['Active'])return this[_0xcbeb46(0x164)][_0xcbeb46(0x17f)](_0xcbeb46(0x1a1)),await(0x0,utils_1['sleep'])(this[_0xcbeb46(0x154)]),this[_0xcbeb46(0x16e)]();}[a269_0x130c68(0x186)](){const _0x3d22de=a269_0x130c68;return{'orgId':this['orgId'],'accessToken':this[_0x3d22de(0x146)],'instanceUrl':this['instanceUrl']};}async['requestConfig'](_0x38572e=''){const _0x2f300c=a269_0x130c68;await this[_0x2f300c(0x16e)]();const _0x3a11bb={'baseURL':this[_0x2f300c(0x166)],'headers':{'accept':_0x2f300c(0x169)}};if(salesforce_1['SalesforceUtils'][_0x2f300c(0x19f)](_0x38572e))_0x3a11bb[_0x2f300c(0x179)][_0x2f300c(0x181)]=this[_0x2f300c(0x146)];else salesforce_1[_0x2f300c(0x175)][_0x2f300c(0x14b)](_0x38572e)?_0x3a11bb[_0x2f300c(0x14f)]=_0x3a11bb[_0x2f300c(0x14f)]['replace'](/<met:sessionId>.+?<\/met:sessionId>/,_0x2f300c(0x151)+this[_0x2f300c(0x146)]+_0x2f300c(0x16c)):_0x3a11bb['headers'][_0x2f300c(0x149)]=this[_0x2f300c(0x165)]+'\x20'+this['accessToken'];return _0x3a11bb;}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a269_0x130c68(0x198),[])],SalesforceAuthService),exports[a269_0x130c68(0x189)]=SalesforceAuthService;