function a232_0xd177(){const _0x3354c3=['132iNGWSZ','getAuthData','token_type','requestConfig','response','access\x20token\x20updated\x20for\x20%s','function','create\x20authorized\x20request\x20failed:\x20authorization\x20error','SalesforceAuthService','Updating','../errors/invalid-refresh-token.error','force\x20update\x20token','InvalidRefreshTokenError','__createBinding','name','324741vAKrxd','data','accessToken','__esModule','then','toString','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','default','../../../../constants/errors','../../../../constants','instanceUrl','typedi','defineProperty','hasOwnProperty','post','constructor','length','AUTH_WAIT_TIME','design:paramtypes','AuthState','1012125awQhdd','Tokens','setAuthDetails','check\x20auth:\x20current\x20state\x20-\x20%s','catch','configurable','UnauthorizedSalesforceError','metadata','call','authState','../../providers/providers.tokens','__importDefault','4IHurKY','orgId','sleep','36sYnKiv','get','30TCfLWZ','create','writable','update\x20access\x20token','services/data/','../../../../core','6hnoYuk','SALESFORCE_API_VERSION','tokenType','instance_url','__importStar','167592zmHCCb','search','application/json','object','2682QpAgXX','Idle','../enums/auth-state.enum','prototype','228680xCyFoE','1218539SEcRUO','logger','__setModuleDefault','waitAuth','Error','../../../shared/utils','6730OBcclW','ERR_INVALID_SALESFORCE_TOKEN','(((.+)+)+)+$','../errors/unauthorized-salesforce.error','error','forceUpdateToken','log','apply','updateAccessToken','getOwnPropertyDescriptor','refresh_token'];a232_0xd177=function(){return _0x3354c3;};return a232_0xd177();}const a232_0x86c6e5=a232_0x39dc;(function(_0x15e30d,_0xef07bf){const _0x4413c6=a232_0x39dc,_0x3bc5b6=_0x15e30d();while(!![]){try{const _0x3cd43b=-parseInt(_0x4413c6(0xea))/0x1*(-parseInt(_0x4413c6(0x134))/0x2)+parseInt(_0x4413c6(0x10f))/0x3*(-parseInt(_0x4413c6(0x12f))/0x4)+parseInt(_0x4413c6(0x123))/0x5+-parseInt(_0x4413c6(0x13a))/0x6*(-parseInt(_0x4413c6(0xef))/0x7)+-parseInt(_0x4413c6(0xee))/0x8+parseInt(_0x4413c6(0x132))/0x9*(-parseInt(_0x4413c6(0xf5))/0xa)+-parseInt(_0x4413c6(0x100))/0xb*(parseInt(_0x4413c6(0xe6))/0xc);if(_0x3cd43b===_0xef07bf)break;else _0x3bc5b6['push'](_0x3bc5b6['shift']());}catch(_0x5436c3){_0x3bc5b6['push'](_0x3bc5b6['shift']());}}}(a232_0xd177,0x1ac30));function a232_0x39dc(_0x3e2130,_0x495575){const _0x3a8dba=a232_0xd177();return a232_0x39dc=function(_0x561bec,_0x27447f){_0x561bec=_0x561bec-0xe3;let _0xd1774a=_0x3a8dba[_0x561bec];return _0xd1774a;},a232_0x39dc(_0x3e2130,_0x495575);}const a232_0x27447f=(function(){let _0x226efb=!![];return function(_0x527b8a,_0x5efd87){const _0x303741=_0x226efb?function(){const _0x1feef5=a232_0x39dc;if(_0x5efd87){const _0x3f3268=_0x5efd87[_0x1feef5(0xfc)](_0x527b8a,arguments);return _0x5efd87=null,_0x3f3268;}}:function(){};return _0x226efb=![],_0x303741;};}()),a232_0x561bec=a232_0x27447f(this,function(){const _0x15c024=a232_0x39dc;return a232_0x561bec[_0x15c024(0x114)]()['search']('(((.+)+)+)+$')['toString']()[_0x15c024(0x11e)](a232_0x561bec)[_0x15c024(0xe7)](_0x15c024(0xf7));});a232_0x561bec();'use strict';var __createBinding=this&&this[a232_0x86c6e5(0x10d)]||(Object[a232_0x86c6e5(0x135)]?function(_0x29990f,_0x1483d7,_0x5952a7,_0x2c9e07){const _0x5ba6bc=a232_0x86c6e5;if(_0x2c9e07===undefined)_0x2c9e07=_0x5952a7;var _0x407660=Object[_0x5ba6bc(0xfe)](_0x1483d7,_0x5952a7);(!_0x407660||(_0x5ba6bc(0x133)in _0x407660?!_0x1483d7[_0x5ba6bc(0x112)]:_0x407660[_0x5ba6bc(0x136)]||_0x407660[_0x5ba6bc(0x128)]))&&(_0x407660={'enumerable':!![],'get':function(){return _0x1483d7[_0x5952a7];}}),Object[_0x5ba6bc(0x11b)](_0x29990f,_0x2c9e07,_0x407660);}:function(_0x3fe751,_0x22fe1f,_0x232c15,_0x415450){if(_0x415450===undefined)_0x415450=_0x232c15;_0x3fe751[_0x415450]=_0x22fe1f[_0x232c15];}),__setModuleDefault=this&&this[a232_0x86c6e5(0xf1)]||(Object[a232_0x86c6e5(0x135)]?function(_0x2c3b97,_0x1322d9){const _0x2918d3=a232_0x86c6e5;Object['defineProperty'](_0x2c3b97,_0x2918d3(0x116),{'enumerable':!![],'value':_0x1322d9});}:function(_0x38efe5,_0x2ba829){const _0x40c90d=a232_0x86c6e5;_0x38efe5[_0x40c90d(0x116)]=_0x2ba829;}),__decorate=this&&this['__decorate']||function(_0x3371b9,_0xb96905,_0x4dac43,_0x5c4543){const _0x596bf4=a232_0x86c6e5;var _0x792e80=arguments[_0x596bf4(0x11f)],_0x4b59ed=_0x792e80<0x3?_0xb96905:_0x5c4543===null?_0x5c4543=Object[_0x596bf4(0xfe)](_0xb96905,_0x4dac43):_0x5c4543,_0x50234a;if(typeof Reflect===_0x596bf4(0xe9)&&typeof Reflect['decorate']===_0x596bf4(0x106))_0x4b59ed=Reflect['decorate'](_0x3371b9,_0xb96905,_0x4dac43,_0x5c4543);else{for(var _0x234410=_0x3371b9['length']-0x1;_0x234410>=0x0;_0x234410--)if(_0x50234a=_0x3371b9[_0x234410])_0x4b59ed=(_0x792e80<0x3?_0x50234a(_0x4b59ed):_0x792e80>0x3?_0x50234a(_0xb96905,_0x4dac43,_0x4b59ed):_0x50234a(_0xb96905,_0x4dac43))||_0x4b59ed;}return _0x792e80>0x3&&_0x4b59ed&&Object['defineProperty'](_0xb96905,_0x4dac43,_0x4b59ed),_0x4b59ed;},__importStar=this&&this[a232_0x86c6e5(0xe5)]||function(_0x25d271){const _0x519374=a232_0x86c6e5;if(_0x25d271&&_0x25d271['__esModule'])return _0x25d271;var _0x233448={};if(_0x25d271!=null){for(var _0x271a6c in _0x25d271)if(_0x271a6c!==_0x519374(0x116)&&Object[_0x519374(0xed)][_0x519374(0x11c)][_0x519374(0x12b)](_0x25d271,_0x271a6c))__createBinding(_0x233448,_0x25d271,_0x271a6c);}return __setModuleDefault(_0x233448,_0x25d271),_0x233448;},__metadata=this&&this['__metadata']||function(_0x58b05f,_0x27bd18){const _0x474b80=a232_0x86c6e5;if(typeof Reflect==='object'&&typeof Reflect[_0x474b80(0x12a)]===_0x474b80(0x106))return Reflect[_0x474b80(0x12a)](_0x58b05f,_0x27bd18);},__importDefault=this&&this[a232_0x86c6e5(0x12e)]||function(_0x2b0cad){const _0x136cee=a232_0x86c6e5;return _0x2b0cad&&_0x2b0cad[_0x136cee(0x112)]?_0x2b0cad:{'default':_0x2b0cad};},SalesforceAuthService_1;Object[a232_0x86c6e5(0x11b)](exports,a232_0x86c6e5(0x112),{'value':!![]}),exports[a232_0x86c6e5(0x108)]=void 0x0;const typedi_1=__importStar(require(a232_0x86c6e5(0x11a))),errors_1=require(a232_0x86c6e5(0x117)),core_1=require(a232_0x86c6e5(0x139)),axios_1=__importDefault(require('axios')),utils_1=require(a232_0x86c6e5(0xf4)),invalid_refresh_token_error_1=require(a232_0x86c6e5(0x10a)),auth_state_enum_1=require(a232_0x86c6e5(0xec)),unauthorized_salesforce_error_1=require(a232_0x86c6e5(0xf8)),constants_1=require(a232_0x86c6e5(0x118)),providers_tokens_1=require(a232_0x86c6e5(0x12d));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(){const _0x379bb6=a232_0x86c6e5;this[_0x379bb6(0x120)]=0x1388,this['authState']=auth_state_enum_1[_0x379bb6(0x122)]['Idle'],this[_0x379bb6(0xf0)]=new core_1['Logger'](SalesforceAuthService_1[_0x379bb6(0x10e)]),this[_0x379bb6(0x125)]();}async[a232_0x86c6e5(0x125)](){const _0x20ed43=a232_0x86c6e5;this[_0x20ed43(0xf0)][_0x20ed43(0xfb)](_0x20ed43(0x126),auth_state_enum_1[_0x20ed43(0x122)][this[_0x20ed43(0x12c)]]);try{if(this[_0x20ed43(0x12c)]===auth_state_enum_1[_0x20ed43(0x122)][_0x20ed43(0xf3)])return;if(this['authState']===auth_state_enum_1[_0x20ed43(0x122)][_0x20ed43(0xeb)])await this[_0x20ed43(0xfd)]();else{const _0x2c337a=await this[_0x20ed43(0x103)](),_0x9cd5d7=await axios_1[_0x20ed43(0x116)][_0x20ed43(0x133)](_0x20ed43(0x138)+constants_1[_0x20ed43(0x13b)],_0x2c337a)[_0x20ed43(0x113)](()=>!![])[_0x20ed43(0x127)](()=>![]);!_0x9cd5d7&&await this[_0x20ed43(0xfd)]();}}catch(_0x55d06a){}}async[a232_0x86c6e5(0xfd)](){const _0x5b4f90=a232_0x86c6e5;var _0x23e635,_0x28ba88,_0xeaeb8e;this[_0x5b4f90(0xf0)][_0x5b4f90(0xfb)](_0x5b4f90(0x137));try{this[_0x5b4f90(0x12c)]=auth_state_enum_1[_0x5b4f90(0x122)][_0x5b4f90(0x109)];const {refreshToken:_0x4c4214,clientId:_0x283e57,clientSecret:_0x927b91,loginUrl:_0x4682c4}=typedi_1[_0x5b4f90(0x116)][_0x5b4f90(0x133)](providers_tokens_1[_0x5b4f90(0x124)]['salesforce']),{data:_0xe2c652}=await axios_1[_0x5b4f90(0x116)][_0x5b4f90(0x11d)]((0x0,utils_1['joinURL'])(_0x4682c4,'/services/oauth2/token'),null,{'params':{'grant_type':_0x5b4f90(0xff),'refresh_token':_0x4c4214,'client_id':_0x283e57,'client_secret':_0x927b91}});this['instanceUrl']=_0xe2c652[_0x5b4f90(0xe4)],this['accessToken']=_0xe2c652['access_token'],this[_0x5b4f90(0xe3)]=_0xe2c652[_0x5b4f90(0x102)],this['authState']=auth_state_enum_1[_0x5b4f90(0x122)]['Active'],this[_0x5b4f90(0xf0)]['log'](_0x5b4f90(0x105),this[_0x5b4f90(0x119)]);}catch(_0x38f9f9){const _0xdfa290=((_0x28ba88=(_0x23e635=_0x38f9f9===null||_0x38f9f9===void 0x0?void 0x0:_0x38f9f9[_0x5b4f90(0x104)])===null||_0x23e635===void 0x0?void 0x0:_0x23e635[_0x5b4f90(0x110)])===null||_0x28ba88===void 0x0?void 0x0:_0x28ba88[_0x5b4f90(0xf9)])||((_0xeaeb8e=_0x38f9f9===null||_0x38f9f9===void 0x0?void 0x0:_0x38f9f9[_0x5b4f90(0x104)])===null||_0xeaeb8e===void 0x0?void 0x0:_0xeaeb8e[_0x5b4f90(0x110)])||_0x38f9f9['message'];this[_0x5b4f90(0xf0)]['error']('update\x20access\x20token\x20failed:\x20%s',_0xdfa290),this[_0x5b4f90(0x12c)]=auth_state_enum_1[_0x5b4f90(0x122)][_0x5b4f90(0xf3)];throw new invalid_refresh_token_error_1[(_0x5b4f90(0x10c))](errors_1[_0x5b4f90(0xf6)]);}}async[a232_0x86c6e5(0xfa)](){const _0x31c546=a232_0x86c6e5;this[_0x31c546(0xf0)]['log'](_0x31c546(0x10b));if(this[_0x31c546(0x12c)]===auth_state_enum_1[_0x31c546(0x122)]['Updating']||this['authState']===auth_state_enum_1[_0x31c546(0x122)]['Idle'])return await(0x0,utils_1[_0x31c546(0x131)])(this[_0x31c546(0x120)]),this[_0x31c546(0xfa)]();if(this[_0x31c546(0x12c)]===auth_state_enum_1[_0x31c546(0x122)]['Error'])throw new invalid_refresh_token_error_1[(_0x31c546(0x10c))](errors_1[_0x31c546(0xf6)]);await this[_0x31c546(0xfd)]();}async['waitAuth'](){const _0x5049fd=a232_0x86c6e5;if(this['authState']===auth_state_enum_1[_0x5049fd(0x122)][_0x5049fd(0xf3)]){this[_0x5049fd(0xf0)]['log'](_0x5049fd(0x107));throw new unauthorized_salesforce_error_1[(_0x5049fd(0x129))]();}if(this[_0x5049fd(0x12c)]!==auth_state_enum_1[_0x5049fd(0x122)]['Active'])return this[_0x5049fd(0xf0)][_0x5049fd(0xfb)](_0x5049fd(0x115)),await(0x0,utils_1[_0x5049fd(0x131)])(this[_0x5049fd(0x120)]),this[_0x5049fd(0xf2)]();}[a232_0x86c6e5(0x101)](){const _0x5cdd1d=a232_0x86c6e5;return{'orgId':this[_0x5cdd1d(0x130)],'accessToken':this[_0x5cdd1d(0x111)],'instanceUrl':this[_0x5cdd1d(0x119)]};}async[a232_0x86c6e5(0x103)](){const _0x212d3c=a232_0x86c6e5;return await this[_0x212d3c(0xf2)](),{'baseURL':this[_0x212d3c(0x119)],'headers':{'accept':_0x212d3c(0xe8),'authorization':this[_0x212d3c(0xe3)]+'\x20'+this[_0x212d3c(0x111)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a232_0x86c6e5(0x121),[])],SalesforceAuthService),exports[a232_0x86c6e5(0x108)]=SalesforceAuthService;