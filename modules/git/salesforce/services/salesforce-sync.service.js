const a280_0x7567ea=a280_0x16c5;function a280_0x16c5(_0x190b79,_0x1d7183){const _0x1f2ec6=a280_0x6f22();return a280_0x16c5=function(_0x330f91,_0x3872c6){_0x330f91=_0x330f91-0x11b;let _0x6f226=_0x1f2ec6[_0x330f91];return _0x6f226;},a280_0x16c5(_0x190b79,_0x1d7183);}function a280_0x6f22(){const _0x3f343f=['\x0a\x20\x20\x20\x20\x20\x20','salesforceService','%parentId%','./salesforce-query.service','Repository__r','1677880xzKXlf','Components__r','object','280050sRFJlU','__decorate','getBranchRecordByName','updateRemoteState','search','333432azKHSt','../../../../constants','2032569pdjGJV','73608hCjwSW','1741858tlZreN','ERR_INVALID_ATTACHMENT_ID','Branch_Name__c','SalesforceSyncService','119zebYCT','getRepositoryRecordByName','SYNC_ATTACHMENT_FOR_BRANCH_NAME','patchObject','FlosumRepositorySyncDto','getBranchComponents','toString','GET_BRANCH_QUERY','defineProperty','getOwnPropertyDescriptor','typedi','21264JaLPOr','find','encodeBase64','setStatus','query','11mrjwUB','(((.+)+)+)+$','metadata','FLOSUM_NAMESPACE','getAllRepositoryNames','GET_COMPONENTS_QUERY','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','disableSync','\x20not\x20found\x20on\x20salesforce','SalesforceQueryService','Synchronization_Status__c','length','fromRepositoryRecord','../../../../constants/errors','GET_REPOSITORY_BY_NAME_QUERY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','15ROylCE','apply','getComponents','Branch\x20','Repository\x20with\x20Id\x20','GET_BRANCH_BY_NAME_QUERY','Branch\x20with\x20Id\x20','getRepositoryRecord','decorate','design:paramtypes','repositoryId','push','salesforceQuery','87FZPzvp','Repository\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','objectId','__metadata','function','../../../shared/utils','getComponentsFromRepository','fromBranchRecord','GET_REPOSITORIES_NAMES_QUERY','Sync_In_Progress__c','%id%','SalesforceNotFoundError','Attachment','getBranchRecord','getRepositoryRecords','Connection__c','replace','getAttachmentId','%name%','map','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','constructor','FLOSUM_GIT_NAMESPACE'];a280_0x6f22=function(){return _0x3f343f;};return a280_0x6f22();}(function(_0x378d04,_0x5b74a7){const _0x103939=a280_0x16c5,_0x243329=_0x378d04();while(!![]){try{const _0x5ca2ff=parseInt(_0x103939(0x163))/0x1+parseInt(_0x103939(0x162))/0x2+-parseInt(_0x103939(0x13a))/0x3*(-parseInt(_0x103939(0x172))/0x4)+parseInt(_0x103939(0x12d))/0x5*(parseInt(_0x103939(0x15a))/0x6)+-parseInt(_0x103939(0x167))/0x7*(parseInt(_0x103939(0x15f))/0x8)+-parseInt(_0x103939(0x161))/0x9+-parseInt(_0x103939(0x157))/0xa*(parseInt(_0x103939(0x11d))/0xb);if(_0x5ca2ff===_0x5b74a7)break;else _0x243329['push'](_0x243329['shift']());}catch(_0x30f9f6){_0x243329['push'](_0x243329['shift']());}}}(a280_0x6f22,0xecfb7));const a280_0x3872c6=(function(){let _0x5baf09=!![];return function(_0x44c62b,_0x175094){const _0x237d4e=_0x5baf09?function(){const _0x289490=a280_0x16c5;if(_0x175094){const _0x4d5cc9=_0x175094[_0x289490(0x12e)](_0x44c62b,arguments);return _0x175094=null,_0x4d5cc9;}}:function(){};return _0x5baf09=![],_0x237d4e;};}()),a280_0x330f91=a280_0x3872c6(this,function(){const _0x45148b=a280_0x16c5;return a280_0x330f91[_0x45148b(0x16d)]()[_0x45148b(0x15e)](_0x45148b(0x11e))['toString']()[_0x45148b(0x150)](a280_0x330f91)[_0x45148b(0x15e)](_0x45148b(0x11e));});a280_0x330f91();'use strict';var __decorate=this&&this[a280_0x7567ea(0x15b)]||function(_0xbd9821,_0x443bb5,_0x37de70,_0x3a8ce1){const _0x4b0eb6=a280_0x7567ea;var _0x53b5a1=arguments[_0x4b0eb6(0x128)],_0x1100a4=_0x53b5a1<0x3?_0x443bb5:_0x3a8ce1===null?_0x3a8ce1=Object[_0x4b0eb6(0x170)](_0x443bb5,_0x37de70):_0x3a8ce1,_0x5b65d1;if(typeof Reflect===_0x4b0eb6(0x159)&&typeof Reflect['decorate']==='function')_0x1100a4=Reflect[_0x4b0eb6(0x135)](_0xbd9821,_0x443bb5,_0x37de70,_0x3a8ce1);else{for(var _0x13a89f=_0xbd9821['length']-0x1;_0x13a89f>=0x0;_0x13a89f--)if(_0x5b65d1=_0xbd9821[_0x13a89f])_0x1100a4=(_0x53b5a1<0x3?_0x5b65d1(_0x1100a4):_0x53b5a1>0x3?_0x5b65d1(_0x443bb5,_0x37de70,_0x1100a4):_0x5b65d1(_0x443bb5,_0x37de70))||_0x1100a4;}return _0x53b5a1>0x3&&_0x1100a4&&Object[_0x4b0eb6(0x16f)](_0x443bb5,_0x37de70,_0x1100a4),_0x1100a4;},__metadata=this&&this[a280_0x7567ea(0x13e)]||function(_0x7ca883,_0x2765e2){const _0x266e3f=a280_0x7567ea;if(typeof Reflect===_0x266e3f(0x159)&&typeof Reflect[_0x266e3f(0x11f)]===_0x266e3f(0x13f))return Reflect[_0x266e3f(0x11f)](_0x7ca883,_0x2765e2);};Object[a280_0x7567ea(0x16f)](exports,'__esModule',{'value':!![]}),exports[a280_0x7567ea(0x166)]=void 0x0;const typedi_1=require(a280_0x7567ea(0x171)),constants_1=require(a280_0x7567ea(0x160)),errors_1=require(a280_0x7567ea(0x12a)),utils_1=require(a280_0x7567ea(0x140)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require('../errors/not-found.error'),queries_1=require('../queries'),salesforce_query_service_1=require(a280_0x7567ea(0x155)),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0x5ebcf7,_0x4bc7c2){const _0x440f32=a280_0x7567ea;this['salesforceQuery']=_0x5ebcf7,this[_0x440f32(0x153)]=_0x4bc7c2;}async[a280_0x7567ea(0x12f)](_0x4e917a){const _0x192de2=a280_0x7567ea;var _0x1a0491;const _0x3535b=await this[_0x192de2(0x139)]['query'](_0x4e917a),_0x21cb8a=[];for(const _0x4a10d1 of _0x3535b){const _0x2aee8e=(_0x1a0491=_0x4a10d1[constants_1[_0x192de2(0x120)]+_0x192de2(0x158)])===null||_0x1a0491===void 0x0?void 0x0:_0x1a0491['records'];_0x2aee8e&&_0x2aee8e['length']&&_0x21cb8a[_0x192de2(0x138)](_0x2aee8e[0x0]['Id']);}return _0x21cb8a;}async[a280_0x7567ea(0x121)](_0x11b413){const _0x14d2ed=a280_0x7567ea,_0xa55b1=await this[_0x14d2ed(0x139)][_0x14d2ed(0x11c)](queries_1[_0x14d2ed(0x143)][_0x14d2ed(0x14b)](/\%connection_id\%/g,_0x11b413));return _0xa55b1['map'](_0x113026=>{const _0x105e5f=_0x14d2ed;return _0x113026[constants_1['FLOSUM_GIT_NAMESPACE']+_0x105e5f(0x156)]?_0x113026[constants_1[_0x105e5f(0x151)]+_0x105e5f(0x156)]['Name']:_0x113026['Name'];});}async[a280_0x7567ea(0x149)](_0xc86fa7){const _0x5937bc=a280_0x7567ea,_0x570271=await this['salesforceQuery'][_0x5937bc(0x11c)](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x5937bc(0x14b)](/\%connection_id\%/g,_0xc86fa7));return _0x570271['map'](_0x49b52a=>flosum_repository_sync_dto_1[_0x5937bc(0x16b)][_0x5937bc(0x129)](_0x49b52a));}async['getBranchRecords'](_0x36cf8d){const _0x35d486=a280_0x7567ea,_0x3934a3=await this[_0x35d486(0x139)][_0x35d486(0x11c)](queries_1['GET_WAITING_BRANCHES_QUERY'][_0x35d486(0x14b)](/%repositories_ids\%/g,_0x36cf8d));return _0x3934a3[_0x35d486(0x14e)](_0x210fad=>flosum_repository_sync_dto_1[_0x35d486(0x16b)][_0x35d486(0x142)](_0x210fad));}async[a280_0x7567ea(0x134)](_0x4bbb0a){const _0x3bf336=a280_0x7567ea,_0x302063=await this[_0x3bf336(0x139)][_0x3bf336(0x11c)](queries_1['GET_REPOSITORY_QUERY'][_0x3bf336(0x14b)](_0x3bf336(0x145),_0x4bbb0a));if(_0x302063[_0x3bf336(0x128)]===0x0)throw new not_found_error_1[(_0x3bf336(0x146))](_0x3bf336(0x131)+_0x4bbb0a+_0x3bf336(0x125));return flosum_repository_sync_dto_1[_0x3bf336(0x16b)][_0x3bf336(0x129)](_0x302063[0x0]);}async[a280_0x7567ea(0x148)](_0x2ded2b){const _0xf0cf69=a280_0x7567ea,_0x21722a=await this[_0xf0cf69(0x139)][_0xf0cf69(0x11c)](queries_1[_0xf0cf69(0x16e)][_0xf0cf69(0x14b)](_0xf0cf69(0x145),_0x2ded2b));if(_0x21722a['length']===0x0)throw new not_found_error_1[(_0xf0cf69(0x146))](_0xf0cf69(0x133)+_0x2ded2b+_0xf0cf69(0x125));return flosum_repository_sync_dto_1[_0xf0cf69(0x16b)][_0xf0cf69(0x142)](_0x21722a[0x0]);}async[a280_0x7567ea(0x15c)](_0x556d34){const _0x42f49d=a280_0x7567ea,_0x2b65cc=await this[_0x42f49d(0x139)][_0x42f49d(0x11c)](queries_1[_0x42f49d(0x132)]['replace'](_0x42f49d(0x14d),_0x556d34));if(_0x2b65cc[_0x42f49d(0x128)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x42f49d(0x130)+_0x556d34+_0x42f49d(0x125));const _0x7c626=_0x2b65cc[_0x42f49d(0x173)](_0x47999c=>_0x47999c[constants_1[_0x42f49d(0x120)]+_0x42f49d(0x165)]===_0x556d34);if(!_0x7c626)throw new not_found_error_1[(_0x42f49d(0x146))]('Branch\x20'+_0x556d34+_0x42f49d(0x125));return flosum_repository_sync_dto_1[_0x42f49d(0x16b)][_0x42f49d(0x142)](_0x7c626);}async[a280_0x7567ea(0x168)](_0x2b7cbe){const _0x41a53b=a280_0x7567ea,_0x99465b=await this[_0x41a53b(0x139)]['query'](queries_1[_0x41a53b(0x12b)][_0x41a53b(0x14b)](_0x41a53b(0x14d),_0x2b7cbe));if(_0x99465b[_0x41a53b(0x128)]===0x0)throw new not_found_error_1[(_0x41a53b(0x146))](_0x41a53b(0x13b)+_0x2b7cbe+_0x41a53b(0x125));return flosum_repository_sync_dto_1[_0x41a53b(0x16b)][_0x41a53b(0x129)](_0x99465b[0x0]);}async[a280_0x7567ea(0x141)](_0x38302c){const _0x1a8600=a280_0x7567ea,_0x3e58e7=_0x1a8600(0x152)+queries_1[_0x1a8600(0x122)]+_0x1a8600(0x123)+_0x38302c+'\x27';return this['getComponents'](_0x3e58e7);}async[a280_0x7567ea(0x16c)](_0x1540cb){const _0xcd8e52=a280_0x7567ea,_0x1c5b61=_0xcd8e52(0x13c)+queries_1[_0xcd8e52(0x122)]+_0xcd8e52(0x12c)+_0x1540cb+'\x27';return this['getComponents'](_0x1c5b61);}async[a280_0x7567ea(0x14c)](_0x27d45c){const _0x520e2b=a280_0x7567ea;var _0x3a6baf;const _0x1bdd1e=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x520e2b(0x14b)](_0x520e2b(0x154),_0x27d45c[_0x520e2b(0x13d)])[_0x520e2b(0x14b)](_0x520e2b(0x14d),_0x27d45c[_0x520e2b(0x137)]?constants_1[_0x520e2b(0x14f)]:constants_1[_0x520e2b(0x169)]),_0x2dc5c2=await this[_0x520e2b(0x139)][_0x520e2b(0x11c)](_0x1bdd1e),_0x27a16d=(_0x3a6baf=_0x2dc5c2[0x0])===null||_0x3a6baf===void 0x0?void 0x0:_0x3a6baf['Id'];if(!_0x27a16d)throw new Error(errors_1[_0x520e2b(0x164)]);return _0x27a16d;}async['getRemoteStateAttachmentId'](_0x2da66e){const _0x476d68=a280_0x7567ea;let _0x17e352=await this['getAttachmentId'](_0x2da66e)['catch'](()=>null);return!_0x17e352&&(_0x17e352=await this[_0x476d68(0x153)]['createObject']('Attachment',{'Body':(0x0,utils_1[_0x476d68(0x174)])('{}'),'ParentId':_0x2da66e[_0x476d68(0x13d)],'ContentType':'text/plain','Name':_0x2da66e[_0x476d68(0x137)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x17e352;}async[a280_0x7567ea(0x15d)](_0x4d0571,_0x4a3430){const _0xb41990=a280_0x7567ea,_0x17a2fa=await this['getRemoteStateAttachmentId'](_0x4d0571);await this['salesforceService'][_0xb41990(0x16a)](_0xb41990(0x147),_0x17a2fa,{'Body':(0x0,utils_1[_0xb41990(0x174)])(JSON['stringify'](_0x4a3430))});}async[a280_0x7567ea(0x11b)](_0x44dfdc,_0x49352b){const _0x4c9312=a280_0x7567ea;await this[_0x4c9312(0x153)][_0x4c9312(0x16a)](_0x44dfdc['objectType'],_0x44dfdc[_0x4c9312(0x13d)],{[constants_1[_0x4c9312(0x151)]+_0x4c9312(0x127)]:_0x49352b});}async[a280_0x7567ea(0x124)](_0x37810c){const _0xa01f5b=a280_0x7567ea;await this[_0xa01f5b(0x153)][_0xa01f5b(0x16a)](constants_1[_0xa01f5b(0x151)]+_0xa01f5b(0x14a),_0x37810c,{[constants_1[_0xa01f5b(0x151)]+_0xa01f5b(0x144)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a280_0x7567ea(0x136),[salesforce_query_service_1[a280_0x7567ea(0x126)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports[a280_0x7567ea(0x166)]=SalesforceSyncService;