function a238_0x570c(){const _0x54e29f=['GET_REPOSITORIES_NAMES_QUERY','getBranchRecord','setStatus','GET_BRANCH_BY_NAME_QUERY','getBranchRecordByName','typedi','ERR_INVALID_ATTACHMENT_ID','getAttachmentId','design:paramtypes','map','GET_WAITING_BRANCHES_QUERY','salesforceService','createObject','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','GET_WAITING_REPOSITORIES_QUERY','\x20not\x20found\x20on\x20salesforce','objectId','Name','Sync_In_Progress__c','SalesforceSyncService','fromRepositoryRecord','decorate','encodeBase64','metadata','__metadata','2329456hoHdHN','query','2KyZbWJ','search','__decorate','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','2508919bkuvhq','12uEoiQS','getOwnPropertyDescriptor','%id%','8601940IWUQTM','4777597rCqtDF','getRepositoryRecordByName','../queries','getAllRepositoryNames','disableSync','./salesforce-query.service','4hIRqrN','__esModule','107992tKMXVz','Connection__c','FLOSUM_NAMESPACE','SalesforceNotFoundError','Components__r','GET_COMPONENTS_QUERY','getRepositoryRecords','patchObject','18gRcBbo','records','Branch\x20with\x20Id\x20','constructor','(((.+)+)+)+$','apply','salesforceQuery','toString','object','FLOSUM_GIT_NAMESPACE','SalesforceService','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','function','Repository__r','Synchronization_Status__c','Attachment','getBranchRecords','39924ThJjxa','getComponents','getRepositoryRecord','catch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','FlosumRepositorySyncDto','objectType','1956042gkfokR','Repository\x20with\x20Id\x20','Service','length','defineProperty','3530bORIPm','replace','%name%','../../../shared/utils','fromBranchRecord','getRemoteStateAttachmentId','SYNC_ATTACHMENT_FOR_BRANCH_NAME','GET_REPOSITORY_BY_NAME_QUERY','GET_REPOSITORY_QUERY','Branch\x20'];a238_0x570c=function(){return _0x54e29f;};return a238_0x570c();}const a238_0x47b296=a238_0x17e6;(function(_0x4fb1ee,_0x4eb71d){const _0x2fe52e=a238_0x17e6,_0x8ec2cf=_0x4fb1ee();while(!![]){try{const _0x1f4755=parseInt(_0x2fe52e(0x18b))/0x1*(parseInt(_0x2fe52e(0x19c))/0x2)+parseInt(_0x2fe52e(0x1bd))/0x3+-parseInt(_0x2fe52e(0x19a))/0x4*(parseInt(_0x2fe52e(0x193))/0x5)+parseInt(_0x2fe52e(0x1a4))/0x6*(parseInt(_0x2fe52e(0x18f))/0x7)+-parseInt(_0x2fe52e(0x189))/0x8+parseInt(_0x2fe52e(0x1b5))/0x9*(parseInt(_0x2fe52e(0x1c2))/0xa)+-parseInt(_0x2fe52e(0x194))/0xb*(parseInt(_0x2fe52e(0x190))/0xc);if(_0x1f4755===_0x4eb71d)break;else _0x8ec2cf['push'](_0x8ec2cf['shift']());}catch(_0x5edf81){_0x8ec2cf['push'](_0x8ec2cf['shift']());}}}(a238_0x570c,0xe9384));function a238_0x17e6(_0x467b1f,_0x11c5be){const _0x15ad16=a238_0x570c();return a238_0x17e6=function(_0x3e928a,_0x147f15){_0x3e928a=_0x3e928a-0x188;let _0x570c9c=_0x15ad16[_0x3e928a];return _0x570c9c;},a238_0x17e6(_0x467b1f,_0x11c5be);}const a238_0x147f15=(function(){let _0x511843=!![];return function(_0x3427a4,_0xfcef75){const _0x474075=_0x511843?function(){const _0x34f94c=a238_0x17e6;if(_0xfcef75){const _0x159804=_0xfcef75[_0x34f94c(0x1a9)](_0x3427a4,arguments);return _0xfcef75=null,_0x159804;}}:function(){};return _0x511843=![],_0x474075;};}()),a238_0x3e928a=a238_0x147f15(this,function(){const _0x55cb05=a238_0x17e6;return a238_0x3e928a[_0x55cb05(0x1ab)]()[_0x55cb05(0x18c)](_0x55cb05(0x1a8))[_0x55cb05(0x1ab)]()[_0x55cb05(0x1a7)](a238_0x3e928a)[_0x55cb05(0x18c)](_0x55cb05(0x1a8));});a238_0x3e928a();'use strict';var __decorate=this&&this[a238_0x47b296(0x18d)]||function(_0x860137,_0x54b59b,_0x2a5f00,_0x3fb350){const _0x279fa2=a238_0x47b296;var _0x19a3ab=arguments['length'],_0x37c650=_0x19a3ab<0x3?_0x54b59b:_0x3fb350===null?_0x3fb350=Object[_0x279fa2(0x191)](_0x54b59b,_0x2a5f00):_0x3fb350,_0x4ebe60;if(typeof Reflect===_0x279fa2(0x1ac)&&typeof Reflect[_0x279fa2(0x1e1)]===_0x279fa2(0x1b0))_0x37c650=Reflect[_0x279fa2(0x1e1)](_0x860137,_0x54b59b,_0x2a5f00,_0x3fb350);else{for(var _0x4d9fd1=_0x860137[_0x279fa2(0x1c0)]-0x1;_0x4d9fd1>=0x0;_0x4d9fd1--)if(_0x4ebe60=_0x860137[_0x4d9fd1])_0x37c650=(_0x19a3ab<0x3?_0x4ebe60(_0x37c650):_0x19a3ab>0x3?_0x4ebe60(_0x54b59b,_0x2a5f00,_0x37c650):_0x4ebe60(_0x54b59b,_0x2a5f00))||_0x37c650;}return _0x19a3ab>0x3&&_0x37c650&&Object[_0x279fa2(0x1c1)](_0x54b59b,_0x2a5f00,_0x37c650),_0x37c650;},__metadata=this&&this[a238_0x47b296(0x188)]||function(_0xe52d08,_0xb5452f){const _0x2c0958=a238_0x47b296;if(typeof Reflect==='object'&&typeof Reflect[_0x2c0958(0x1e3)]===_0x2c0958(0x1b0))return Reflect[_0x2c0958(0x1e3)](_0xe52d08,_0xb5452f);};Object[a238_0x47b296(0x1c1)](exports,a238_0x47b296(0x19b),{'value':!![]}),exports[a238_0x47b296(0x1df)]=void 0x0;const typedi_1=require(a238_0x47b296(0x1d1)),constants_1=require('../../../../constants'),errors_1=require('../../../../constants/errors'),utils_1=require(a238_0x47b296(0x1c5)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a238_0x47b296(0x196)),salesforce_query_service_1=require(a238_0x47b296(0x199)),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0x52128c,_0x4ff35e){const _0x3a265d=a238_0x47b296;this['salesforceQuery']=_0x52128c,this[_0x3a265d(0x1d7)]=_0x4ff35e;}async[a238_0x47b296(0x1b6)](_0xd541ca){const _0x4a3b23=a238_0x47b296;var _0x3876ee;const _0x565fa2=await this[_0x4a3b23(0x1aa)]['query'](_0xd541ca),_0x41ae77=[];for(const _0x37aa7d of _0x565fa2){const _0x3f7de3=(_0x3876ee=_0x37aa7d[constants_1['FLOSUM_NAMESPACE']+_0x4a3b23(0x1a0)])===null||_0x3876ee===void 0x0?void 0x0:_0x3876ee[_0x4a3b23(0x1a5)];_0x3f7de3&&_0x3f7de3[_0x4a3b23(0x1c0)]&&_0x41ae77['push'](_0x3f7de3[0x0]['Id']);}return _0x41ae77;}async[a238_0x47b296(0x197)](_0x5a5b0b){const _0xd560bf=a238_0x47b296,_0x193812=await this[_0xd560bf(0x1aa)]['query'](queries_1[_0xd560bf(0x1cc)][_0xd560bf(0x1c3)](/\%connection_id\%/g,_0x5a5b0b));return _0x193812[_0xd560bf(0x1d5)](_0xbe66c0=>{const _0x7a0444=_0xd560bf;return _0xbe66c0[constants_1['FLOSUM_GIT_NAMESPACE']+_0x7a0444(0x1b1)]?_0xbe66c0[constants_1[_0x7a0444(0x1ad)]+'Repository__r'][_0x7a0444(0x1dd)]:_0xbe66c0[_0x7a0444(0x1dd)];});}async[a238_0x47b296(0x1a2)](_0x140235){const _0x4657bb=a238_0x47b296,_0x315ea0=await this[_0x4657bb(0x1aa)]['query'](queries_1[_0x4657bb(0x1da)][_0x4657bb(0x1c3)](/\%connection_id\%/g,_0x140235));return _0x315ea0[_0x4657bb(0x1d5)](_0x24ef89=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4657bb(0x1e0)](_0x24ef89));}async[a238_0x47b296(0x1b4)](_0x288160){const _0x59482c=a238_0x47b296,_0x2b5ad3=await this[_0x59482c(0x1aa)][_0x59482c(0x18a)](queries_1[_0x59482c(0x1d6)][_0x59482c(0x1c3)](/%repositories_ids\%/g,_0x288160));return _0x2b5ad3[_0x59482c(0x1d5)](_0x29a894=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x29a894));}async[a238_0x47b296(0x1b7)](_0x3a538e){const _0x192aed=a238_0x47b296,_0xc4dd85=await this[_0x192aed(0x1aa)]['query'](queries_1[_0x192aed(0x1ca)][_0x192aed(0x1c3)](_0x192aed(0x192),_0x3a538e));if(_0xc4dd85[_0x192aed(0x1c0)]===0x0)throw new not_found_error_1[(_0x192aed(0x19f))](_0x192aed(0x1be)+_0x3a538e+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x192aed(0x1e0)](_0xc4dd85[0x0]);}async[a238_0x47b296(0x1cd)](_0x5bef84){const _0x4d48ac=a238_0x47b296,_0x388d83=await this[_0x4d48ac(0x1aa)][_0x4d48ac(0x18a)](queries_1['GET_BRANCH_QUERY']['replace'](_0x4d48ac(0x192),_0x5bef84));if(_0x388d83[_0x4d48ac(0x1c0)]===0x0)throw new not_found_error_1[(_0x4d48ac(0x19f))](_0x4d48ac(0x1a6)+_0x5bef84+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x4d48ac(0x1bb)][_0x4d48ac(0x1c6)](_0x388d83[0x0]);}async[a238_0x47b296(0x1d0)](_0x16c673){const _0x4b5e73=a238_0x47b296,_0x58552b=await this[_0x4b5e73(0x1aa)][_0x4b5e73(0x18a)](queries_1[_0x4b5e73(0x1cf)]['replace']('%name%',_0x16c673));if(_0x58552b[_0x4b5e73(0x1c0)]===0x0)throw new not_found_error_1[(_0x4b5e73(0x19f))](_0x4b5e73(0x1cb)+_0x16c673+_0x4b5e73(0x1db));const _0x1e2b61=_0x58552b['find'](_0x3de4eb=>_0x3de4eb[constants_1[_0x4b5e73(0x19e)]+'Branch_Name__c']===_0x16c673);if(!_0x1e2b61)throw new not_found_error_1['SalesforceNotFoundError'](_0x4b5e73(0x1cb)+_0x16c673+_0x4b5e73(0x1db));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4b5e73(0x1c6)](_0x1e2b61);}async[a238_0x47b296(0x195)](_0x3fc5d8){const _0x465363=a238_0x47b296,_0x220c83=await this[_0x465363(0x1aa)][_0x465363(0x18a)](queries_1[_0x465363(0x1c9)]['replace']('%name%',_0x3fc5d8));if(_0x220c83['length']===0x0)throw new not_found_error_1[(_0x465363(0x19f))]('Repository\x20'+_0x3fc5d8+_0x465363(0x1db));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x465363(0x1e0)](_0x220c83[0x0]);}async['getComponentsFromRepository'](_0x55ecee){const _0x3708f4=a238_0x47b296,_0x598686='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x3708f4(0x1a1)]+_0x3708f4(0x1af)+_0x55ecee+'\x27';return this[_0x3708f4(0x1b6)](_0x598686);}async['getBranchComponents'](_0x3dcc64){const _0x4412f9=a238_0x47b296,_0x4295f2=_0x4412f9(0x1b9)+queries_1[_0x4412f9(0x1a1)]+_0x4412f9(0x18e)+_0x3dcc64+'\x27';return this[_0x4412f9(0x1b6)](_0x4295f2);}async[a238_0x47b296(0x1d3)](_0x3f4eec){const _0x34c1c0=a238_0x47b296;var _0x28fc9e;const _0x527bed=queries_1[_0x34c1c0(0x1ba)]['replace']('%parentId%',_0x3f4eec['objectId'])[_0x34c1c0(0x1c3)](_0x34c1c0(0x1c4),_0x3f4eec['repositoryId']?constants_1[_0x34c1c0(0x1d9)]:constants_1[_0x34c1c0(0x1c8)]),_0x2666a0=await this['salesforceQuery'][_0x34c1c0(0x18a)](_0x527bed),_0x1f9944=(_0x28fc9e=_0x2666a0[0x0])===null||_0x28fc9e===void 0x0?void 0x0:_0x28fc9e['Id'];if(!_0x1f9944)throw new Error(errors_1[_0x34c1c0(0x1d2)]);return _0x1f9944;}async[a238_0x47b296(0x1c7)](_0x59f7a1){const _0x28850e=a238_0x47b296;let _0x5e5d69=await this[_0x28850e(0x1d3)](_0x59f7a1)[_0x28850e(0x1b8)](()=>null);return!_0x5e5d69&&(_0x5e5d69=await this[_0x28850e(0x1d7)][_0x28850e(0x1d8)]('Attachment',{'Body':(0x0,utils_1[_0x28850e(0x1e2)])('{}'),'ParentId':_0x59f7a1[_0x28850e(0x1dc)],'ContentType':'text/plain','Name':_0x59f7a1['repositoryId']?constants_1[_0x28850e(0x1d9)]:constants_1[_0x28850e(0x1c8)]})),_0x5e5d69;}async['updateRemoteState'](_0x3b349a,_0x5ec6f4){const _0x2d7fc4=a238_0x47b296,_0x64fede=await this[_0x2d7fc4(0x1c7)](_0x3b349a);await this[_0x2d7fc4(0x1d7)][_0x2d7fc4(0x1a3)](_0x2d7fc4(0x1b3),_0x64fede,{'Body':(0x0,utils_1[_0x2d7fc4(0x1e2)])(JSON['stringify'](_0x5ec6f4))});}async[a238_0x47b296(0x1ce)](_0x38eeea,_0x23faea){const _0x34702b=a238_0x47b296;await this[_0x34702b(0x1d7)]['patchObject'](_0x38eeea[_0x34702b(0x1bc)],_0x38eeea[_0x34702b(0x1dc)],{[constants_1[_0x34702b(0x1ad)]+_0x34702b(0x1b2)]:_0x23faea});}async[a238_0x47b296(0x198)](_0x2a34c0){const _0x159af5=a238_0x47b296;await this['salesforceService'][_0x159af5(0x1a3)](constants_1[_0x159af5(0x1ad)]+_0x159af5(0x19d),_0x2a34c0,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x159af5(0x1de)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a238_0x47b296(0x1bf)])(),__metadata(a238_0x47b296(0x1d4),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a238_0x47b296(0x1ae)]])],SalesforceSyncService),exports[a238_0x47b296(0x1df)]=SalesforceSyncService;