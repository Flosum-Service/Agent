function a204_0x2e73(_0x5d0e98,_0x2c3623){const _0x37e774=a204_0x2def();return a204_0x2e73=function(_0x3e2a1d,_0x1b8832){_0x3e2a1d=_0x3e2a1d-0x10c;let _0x2defcf=_0x37e774[_0x3e2a1d];return _0x2defcf;},a204_0x2e73(_0x5d0e98,_0x2c3623);}function a204_0x2def(){const _0x15d5de=['function','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Attachment','GET_REPOSITORY_QUERY','../../../../constants','%id%','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','constructor','GET_COMPONENTS_QUERY','6QtMjYj','GET_BRANCH_BY_NAME_QUERY','Repository__r','(((.+)+)+)+$','\x0a\x20\x20\x20\x20\x20\x20','FlosumRepositorySyncDto','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','replace','Branch\x20','fromBranchRecord','3ahHzVe','createObject','defineProperty','metadata','940708ifJCaS','query','%parentId%','Synchronization_Status__c','updateRemoteState','apply','Sync_In_Progress__c','stringify','FLOSUM_NAMESPACE','__decorate','map','1482450sQfkkW','GET_BRANCH_QUERY','./salesforce.service','getComponentsFromRepository','Branch\x20with\x20Id\x20','GET_WAITING_BRANCHES_QUERY','\x20not\x20found\x20on\x20salesforce','disableSync','getAttachmentId','SalesforceSyncService','patchObject','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','push','142983oNUEqL','find','getComponents','catch','__esModule','getRepositoryRecord','Connection__c','7223055ZhKRzE','toString','../dto/flosum-repository-sync.dto','13LlWUAH','891905SdPvUG','12XisQoB','fromRepositoryRecord','object','repositoryId','14812332GaCWAK','../queries','setStatus','length','getAllRepositoryNames','search','typedi','820809OqOBqn','objectId','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','FLOSUM_GIT_NAMESPACE','Components__r','%name%','getBranchRecords','getBranchComponents','salesforceQuery','SalesforceNotFoundError','decorate','GET_REPOSITORY_BY_NAME_QUERY','400cnEzUF','SYNC_ATTACHMENT_FOR_BRANCH_NAME','77ABRGbl','encodeBase64','Repository\x20with\x20Id\x20','design:paramtypes','ERR_INVALID_ATTACHMENT_ID','salesforceService','Name'];a204_0x2def=function(){return _0x15d5de;};return a204_0x2def();}const a204_0x389f04=a204_0x2e73;(function(_0x471ab3,_0x578997){const _0x119af5=a204_0x2e73,_0x53f4bf=_0x471ab3();while(!![]){try{const _0xce956b=-parseInt(_0x119af5(0x137))/0x1+parseInt(_0x119af5(0x163))/0x2*(parseInt(_0x119af5(0x15f))/0x3)+-parseInt(_0x119af5(0x12c))/0x4*(-parseInt(_0x119af5(0x12b))/0x5)+parseInt(_0x119af5(0x155))/0x6*(-parseInt(_0x119af5(0x127))/0x7)+parseInt(_0x119af5(0x143))/0x8*(-parseInt(_0x119af5(0x120))/0x9)+parseInt(_0x119af5(0x113))/0xa*(parseInt(_0x119af5(0x145))/0xb)+parseInt(_0x119af5(0x130))/0xc*(parseInt(_0x119af5(0x12a))/0xd);if(_0xce956b===_0x578997)break;else _0x53f4bf['push'](_0x53f4bf['shift']());}catch(_0xa381ac){_0x53f4bf['push'](_0x53f4bf['shift']());}}}(a204_0x2def,0x99f15));const a204_0x1b8832=(function(){let _0x19a329=!![];return function(_0x41b2f6,_0x5342b1){const _0x4e5cbb=_0x19a329?function(){const _0xe1be6d=a204_0x2e73;if(_0x5342b1){const _0x1a4a78=_0x5342b1[_0xe1be6d(0x10d)](_0x41b2f6,arguments);return _0x5342b1=null,_0x1a4a78;}}:function(){};return _0x19a329=![],_0x4e5cbb;};}()),a204_0x3e2a1d=a204_0x1b8832(this,function(){const _0x5d6f49=a204_0x2e73;return a204_0x3e2a1d['toString']()[_0x5d6f49(0x135)](_0x5d6f49(0x158))[_0x5d6f49(0x128)]()[_0x5d6f49(0x153)](a204_0x3e2a1d)[_0x5d6f49(0x135)](_0x5d6f49(0x158));});a204_0x3e2a1d();'use strict';var __decorate=this&&this[a204_0x389f04(0x111)]||function(_0x20e9a4,_0x474d79,_0x6e6fd2,_0xc48f92){const _0x2a6752=a204_0x389f04;var _0x4450a3=arguments[_0x2a6752(0x133)],_0x357e3e=_0x4450a3<0x3?_0x474d79:_0xc48f92===null?_0xc48f92=Object['getOwnPropertyDescriptor'](_0x474d79,_0x6e6fd2):_0xc48f92,_0x279a38;if(typeof Reflect===_0x2a6752(0x12e)&&typeof Reflect[_0x2a6752(0x141)]===_0x2a6752(0x14c))_0x357e3e=Reflect[_0x2a6752(0x141)](_0x20e9a4,_0x474d79,_0x6e6fd2,_0xc48f92);else{for(var _0x526158=_0x20e9a4[_0x2a6752(0x133)]-0x1;_0x526158>=0x0;_0x526158--)if(_0x279a38=_0x20e9a4[_0x526158])_0x357e3e=(_0x4450a3<0x3?_0x279a38(_0x357e3e):_0x4450a3>0x3?_0x279a38(_0x474d79,_0x6e6fd2,_0x357e3e):_0x279a38(_0x474d79,_0x6e6fd2))||_0x357e3e;}return _0x4450a3>0x3&&_0x357e3e&&Object[_0x2a6752(0x161)](_0x474d79,_0x6e6fd2,_0x357e3e),_0x357e3e;},__metadata=this&&this['__metadata']||function(_0x2151f3,_0x425624){const _0x2b4f8e=a204_0x389f04;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x2b4f8e(0x14c))return Reflect[_0x2b4f8e(0x162)](_0x2151f3,_0x425624);};Object['defineProperty'](exports,a204_0x389f04(0x124),{'value':!![]}),exports[a204_0x389f04(0x11c)]=void 0x0;const typedi_1=require(a204_0x389f04(0x136)),constants_1=require(a204_0x389f04(0x150)),errors_1=require('../../../../constants/errors'),utils_1=require('../../../shared/utils'),flosum_repository_sync_dto_1=require(a204_0x389f04(0x129)),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a204_0x389f04(0x131)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a204_0x389f04(0x115));let SalesforceSyncService=class SalesforceSyncService{constructor(_0xedee5a,_0x4df133){const _0x58cecd=a204_0x389f04;this[_0x58cecd(0x13f)]=_0xedee5a,this[_0x58cecd(0x14a)]=_0x4df133;}async[a204_0x389f04(0x122)](_0x1e3c05){const _0x8368d0=a204_0x389f04;var _0xe69c2;const _0x4d898e=await this[_0x8368d0(0x13f)]['query'](_0x1e3c05),_0x4fea2c=[];for(const _0x190168 of _0x4d898e){const _0x1eb4dd=(_0xe69c2=_0x190168[constants_1[_0x8368d0(0x110)]+_0x8368d0(0x13b)])===null||_0xe69c2===void 0x0?void 0x0:_0xe69c2['records'];_0x1eb4dd&&_0x1eb4dd[_0x8368d0(0x133)]&&_0x4fea2c[_0x8368d0(0x11f)](_0x1eb4dd[0x0]['Id']);}return _0x4fea2c;}async[a204_0x389f04(0x134)](_0x88232f){const _0x22829d=a204_0x389f04,_0x472e2e=await this[_0x22829d(0x13f)][_0x22829d(0x164)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x22829d(0x15c)](/\%connection_id\%/g,_0x88232f));return _0x472e2e[_0x22829d(0x112)](_0x3477bd=>{const _0x4bf5cc=_0x22829d;return _0x3477bd[constants_1[_0x4bf5cc(0x13a)]+'Repository__r']?_0x3477bd[constants_1[_0x4bf5cc(0x13a)]+_0x4bf5cc(0x157)][_0x4bf5cc(0x14b)]:_0x3477bd[_0x4bf5cc(0x14b)];});}async['getRepositoryRecords'](_0x11e39c){const _0x2d2c13=a204_0x389f04,_0x373454=await this[_0x2d2c13(0x13f)][_0x2d2c13(0x164)](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x2d2c13(0x15c)](/\%connection_id\%/g,_0x11e39c));return _0x373454['map'](_0x14d394=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromRepositoryRecord'](_0x14d394));}async[a204_0x389f04(0x13d)](_0x3a5a19){const _0x524a77=a204_0x389f04,_0x1d6b08=await this['salesforceQuery'][_0x524a77(0x164)](queries_1[_0x524a77(0x118)][_0x524a77(0x15c)](/%repositories_ids\%/g,_0x3a5a19));return _0x1d6b08['map'](_0x7a3e20=>flosum_repository_sync_dto_1[_0x524a77(0x15a)][_0x524a77(0x15e)](_0x7a3e20));}async[a204_0x389f04(0x125)](_0x2767f8){const _0x4daabb=a204_0x389f04,_0x58a6af=await this['salesforceQuery']['query'](queries_1[_0x4daabb(0x14f)]['replace'](_0x4daabb(0x151),_0x2767f8));if(_0x58a6af[_0x4daabb(0x133)]===0x0)throw new not_found_error_1[(_0x4daabb(0x140))](_0x4daabb(0x147)+_0x2767f8+_0x4daabb(0x119));return flosum_repository_sync_dto_1[_0x4daabb(0x15a)][_0x4daabb(0x12d)](_0x58a6af[0x0]);}async['getBranchRecord'](_0x390c75){const _0x4b34e5=a204_0x389f04,_0x227680=await this[_0x4b34e5(0x13f)][_0x4b34e5(0x164)](queries_1[_0x4b34e5(0x114)][_0x4b34e5(0x15c)](_0x4b34e5(0x151),_0x390c75));if(_0x227680[_0x4b34e5(0x133)]===0x0)throw new not_found_error_1[(_0x4b34e5(0x140))](_0x4b34e5(0x117)+_0x390c75+_0x4b34e5(0x119));return flosum_repository_sync_dto_1[_0x4b34e5(0x15a)]['fromBranchRecord'](_0x227680[0x0]);}async['getBranchRecordByName'](_0x1543ce){const _0x4a5290=a204_0x389f04,_0x1d5c87=await this[_0x4a5290(0x13f)][_0x4a5290(0x164)](queries_1[_0x4a5290(0x156)][_0x4a5290(0x15c)]('%name%',_0x1543ce));if(_0x1d5c87[_0x4a5290(0x133)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Branch\x20'+_0x1543ce+_0x4a5290(0x119));const _0x3d12d4=_0x1d5c87[_0x4a5290(0x121)](_0x4e6786=>_0x4e6786[constants_1[_0x4a5290(0x110)]+'Branch_Name__c']===_0x1543ce);if(!_0x3d12d4)throw new not_found_error_1[(_0x4a5290(0x140))](_0x4a5290(0x15d)+_0x1543ce+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x4a5290(0x15a)]['fromBranchRecord'](_0x3d12d4);}async['getRepositoryRecordByName'](_0x2fccbf){const _0x27cc30=a204_0x389f04,_0x41b0dc=await this[_0x27cc30(0x13f)][_0x27cc30(0x164)](queries_1[_0x27cc30(0x142)][_0x27cc30(0x15c)](_0x27cc30(0x13c),_0x2fccbf));if(_0x41b0dc[_0x27cc30(0x133)]===0x0)throw new not_found_error_1[(_0x27cc30(0x140))]('Repository\x20'+_0x2fccbf+_0x27cc30(0x119));return flosum_repository_sync_dto_1[_0x27cc30(0x15a)][_0x27cc30(0x12d)](_0x41b0dc[0x0]);}async[a204_0x389f04(0x116)](_0x84c6fe){const _0x1a2f48=a204_0x389f04,_0x4fb9ba=_0x1a2f48(0x159)+queries_1[_0x1a2f48(0x154)]+_0x1a2f48(0x11e)+_0x84c6fe+'\x27';return this[_0x1a2f48(0x122)](_0x4fb9ba);}async[a204_0x389f04(0x13e)](_0xe525f2){const _0x5d1ea1=a204_0x389f04,_0x31bd02=_0x5d1ea1(0x14d)+queries_1[_0x5d1ea1(0x154)]+_0x5d1ea1(0x152)+_0xe525f2+'\x27';return this[_0x5d1ea1(0x122)](_0x31bd02);}async[a204_0x389f04(0x11b)](_0x4403d6){const _0x33df53=a204_0x389f04;var _0x25ffdf;const _0x5679e8=queries_1[_0x33df53(0x15b)]['replace'](_0x33df53(0x165),_0x4403d6[_0x33df53(0x138)])[_0x33df53(0x15c)](_0x33df53(0x13c),_0x4403d6[_0x33df53(0x12f)]?constants_1[_0x33df53(0x139)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x39b447=await this['salesforceQuery'][_0x33df53(0x164)](_0x5679e8),_0x5b0f94=(_0x25ffdf=_0x39b447[0x0])===null||_0x25ffdf===void 0x0?void 0x0:_0x25ffdf['Id'];if(!_0x5b0f94)throw new Error(errors_1[_0x33df53(0x149)]);return _0x5b0f94;}async['getRemoteStateAttachmentId'](_0x4c47ba){const _0x2f524a=a204_0x389f04;let _0x493b79=await this[_0x2f524a(0x11b)](_0x4c47ba)[_0x2f524a(0x123)](()=>null);return!_0x493b79&&(_0x493b79=await this[_0x2f524a(0x14a)][_0x2f524a(0x160)](_0x2f524a(0x14e),{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x4c47ba[_0x2f524a(0x138)],'ContentType':'text/plain','Name':_0x4c47ba['repositoryId']?constants_1[_0x2f524a(0x139)]:constants_1[_0x2f524a(0x144)]})),_0x493b79;}async[a204_0x389f04(0x10c)](_0x4e6fad,_0x36c74d){const _0x54cc17=a204_0x389f04,_0x525535=await this['getRemoteStateAttachmentId'](_0x4e6fad);await this['salesforceService'][_0x54cc17(0x11d)](_0x54cc17(0x14e),_0x525535,{'Body':(0x0,utils_1[_0x54cc17(0x146)])(JSON[_0x54cc17(0x10f)](_0x36c74d))});}async[a204_0x389f04(0x132)](_0x5c8b21,_0x5af95a){const _0x9b331b=a204_0x389f04;await this[_0x9b331b(0x14a)]['patchObject'](_0x5c8b21['objectType'],_0x5c8b21[_0x9b331b(0x138)],{[constants_1[_0x9b331b(0x13a)]+_0x9b331b(0x166)]:_0x5af95a});}async[a204_0x389f04(0x11a)](_0x3eba97){const _0x13d82d=a204_0x389f04;await this[_0x13d82d(0x14a)][_0x13d82d(0x11d)](constants_1['FLOSUM_GIT_NAMESPACE']+_0x13d82d(0x126),_0x3eba97,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x13d82d(0x10e)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a204_0x389f04(0x148),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports[a204_0x389f04(0x11c)]=SalesforceSyncService;