function a204_0xce2e(_0x3e9810,_0x4bbbee){const _0x187008=a204_0x1bab();return a204_0xce2e=function(_0x195933,_0x5ab872){_0x195933=_0x195933-0x172;let _0x1bab09=_0x187008[_0x195933];return _0x1bab09;},a204_0xce2e(_0x3e9810,_0x4bbbee);}const a204_0x2e05a9=a204_0xce2e;(function(_0x515a5c,_0x1c42a9){const _0xe61e8f=a204_0xce2e,_0x1aa1b7=_0x515a5c();while(!![]){try{const _0xc0a9b1=parseInt(_0xe61e8f(0x1a0))/0x1+-parseInt(_0xe61e8f(0x185))/0x2*(parseInt(_0xe61e8f(0x194))/0x3)+parseInt(_0xe61e8f(0x1d1))/0x4+parseInt(_0xe61e8f(0x1b3))/0x5*(-parseInt(_0xe61e8f(0x1b8))/0x6)+parseInt(_0xe61e8f(0x1c8))/0x7+-parseInt(_0xe61e8f(0x172))/0x8*(parseInt(_0xe61e8f(0x182))/0x9)+parseInt(_0xe61e8f(0x177))/0xa;if(_0xc0a9b1===_0x1c42a9)break;else _0x1aa1b7['push'](_0x1aa1b7['shift']());}catch(_0x580d8a){_0x1aa1b7['push'](_0x1aa1b7['shift']());}}}(a204_0x1bab,0x7ad91));const a204_0x5ab872=(function(){let _0x2328a9=!![];return function(_0xcfbce1,_0x52f2c7){const _0x5cf72f=_0x2328a9?function(){const _0x31dfdf=a204_0xce2e;if(_0x52f2c7){const _0x2b0698=_0x52f2c7[_0x31dfdf(0x199)](_0xcfbce1,arguments);return _0x52f2c7=null,_0x2b0698;}}:function(){};return _0x2328a9=![],_0x5cf72f;};}()),a204_0x195933=a204_0x5ab872(this,function(){const _0x22eba=a204_0xce2e;return a204_0x195933['toString']()[_0x22eba(0x1be)](_0x22eba(0x1c5))[_0x22eba(0x1cb)]()[_0x22eba(0x1c6)](a204_0x195933)[_0x22eba(0x1be)](_0x22eba(0x1c5));});a204_0x195933();'use strict';var __decorate=this&&this[a204_0x2e05a9(0x184)]||function(_0x3abd45,_0x5e0dbc,_0xfe010b,_0x24bdeb){const _0x45b3ac=a204_0x2e05a9;var _0x402d36=arguments[_0x45b3ac(0x1cf)],_0x584f1d=_0x402d36<0x3?_0x5e0dbc:_0x24bdeb===null?_0x24bdeb=Object[_0x45b3ac(0x187)](_0x5e0dbc,_0xfe010b):_0x24bdeb,_0x243e20;if(typeof Reflect==='object'&&typeof Reflect[_0x45b3ac(0x1ac)]==='function')_0x584f1d=Reflect[_0x45b3ac(0x1ac)](_0x3abd45,_0x5e0dbc,_0xfe010b,_0x24bdeb);else{for(var _0x45fded=_0x3abd45[_0x45b3ac(0x1cf)]-0x1;_0x45fded>=0x0;_0x45fded--)if(_0x243e20=_0x3abd45[_0x45fded])_0x584f1d=(_0x402d36<0x3?_0x243e20(_0x584f1d):_0x402d36>0x3?_0x243e20(_0x5e0dbc,_0xfe010b,_0x584f1d):_0x243e20(_0x5e0dbc,_0xfe010b))||_0x584f1d;}return _0x402d36>0x3&&_0x584f1d&&Object['defineProperty'](_0x5e0dbc,_0xfe010b,_0x584f1d),_0x584f1d;},__metadata=this&&this[a204_0x2e05a9(0x1ca)]||function(_0x219f90,_0x40d1fb){const _0x11afc5=a204_0x2e05a9;if(typeof Reflect===_0x11afc5(0x19c)&&typeof Reflect[_0x11afc5(0x183)]===_0x11afc5(0x1a2))return Reflect['metadata'](_0x219f90,_0x40d1fb);};Object[a204_0x2e05a9(0x1ab)](exports,a204_0x2e05a9(0x17b),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a204_0x2e05a9(0x1a3)),constants_1=require('../../../../constants'),errors_1=require(a204_0x2e05a9(0x1c0)),utils_1=require('../../../shared/utils'),flosum_repository_sync_dto_1=require(a204_0x2e05a9(0x1cd)),not_found_error_1=require(a204_0x2e05a9(0x1bc)),queries_1=require(a204_0x2e05a9(0x17f)),salesforce_query_service_1=require(a204_0x2e05a9(0x19b)),salesforce_service_1=require(a204_0x2e05a9(0x173));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x410910,_0x5e261b){const _0x315ecf=a204_0x2e05a9;this[_0x315ecf(0x1a5)]=_0x410910,this[_0x315ecf(0x1a7)]=_0x5e261b;}async[a204_0x2e05a9(0x18b)](_0x53c09b){const _0x31de9f=a204_0x2e05a9;var _0x4e1613;const _0x325fef=await this[_0x31de9f(0x1a5)]['query'](_0x53c09b),_0x1991ba=[];for(const _0x4da7be of _0x325fef){const _0x4c7389=(_0x4e1613=_0x4da7be[constants_1['FLOSUM_NAMESPACE']+'Components__r'])===null||_0x4e1613===void 0x0?void 0x0:_0x4e1613[_0x31de9f(0x1cc)];_0x4c7389&&_0x4c7389[_0x31de9f(0x1cf)]&&_0x1991ba[_0x31de9f(0x189)](_0x4c7389[0x0]['Id']);}return _0x1991ba;}async[a204_0x2e05a9(0x195)](_0x4af2e5){const _0x3ffb2c=a204_0x2e05a9,_0x1142df=await this[_0x3ffb2c(0x1a5)]['query'](queries_1[_0x3ffb2c(0x1b2)][_0x3ffb2c(0x1b9)](/\%connection_id\%/g,_0x4af2e5));return _0x1142df[_0x3ffb2c(0x19d)](_0x1caa48=>{const _0xf84ad0=_0x3ffb2c;return _0x1caa48[constants_1[_0xf84ad0(0x19a)]+_0xf84ad0(0x1a1)]?_0x1caa48[constants_1[_0xf84ad0(0x19a)]+_0xf84ad0(0x1a1)][_0xf84ad0(0x191)]:_0x1caa48[_0xf84ad0(0x191)];});}async['getRepositoryRecords'](_0x589f8a){const _0x582d1e=a204_0x2e05a9,_0x4b4f6a=await this[_0x582d1e(0x1a5)]['query'](queries_1[_0x582d1e(0x179)]['replace'](/\%connection_id\%/g,_0x589f8a));return _0x4b4f6a[_0x582d1e(0x19d)](_0x53be7b=>flosum_repository_sync_dto_1[_0x582d1e(0x17e)][_0x582d1e(0x1ce)](_0x53be7b));}async[a204_0x2e05a9(0x1af)](_0x5a9e79){const _0x2e7f98=a204_0x2e05a9,_0x1cfa2e=await this['salesforceQuery']['query'](queries_1[_0x2e7f98(0x1c2)][_0x2e7f98(0x1b9)](/%repositories_ids\%/g,_0x5a9e79));return _0x1cfa2e[_0x2e7f98(0x19d)](_0x19eda7=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x2e7f98(0x178)](_0x19eda7));}async[a204_0x2e05a9(0x1b1)](_0x24ad1c){const _0x36f2ae=a204_0x2e05a9,_0x1001ee=await this[_0x36f2ae(0x1a5)]['query'](queries_1[_0x36f2ae(0x1ad)][_0x36f2ae(0x1b9)](_0x36f2ae(0x18e),_0x24ad1c));if(_0x1001ee[_0x36f2ae(0x1cf)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Repository\x20with\x20Id\x20'+_0x24ad1c+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x36f2ae(0x17e)][_0x36f2ae(0x1ce)](_0x1001ee[0x0]);}async[a204_0x2e05a9(0x192)](_0x2646d8){const _0x48a6b5=a204_0x2e05a9,_0x177dca=await this['salesforceQuery'][_0x48a6b5(0x190)](queries_1[_0x48a6b5(0x198)][_0x48a6b5(0x1b9)](_0x48a6b5(0x18e),_0x2646d8));if(_0x177dca[_0x48a6b5(0x1cf)]===0x0)throw new not_found_error_1[(_0x48a6b5(0x18d))](_0x48a6b5(0x1d4)+_0x2646d8+_0x48a6b5(0x1b6));return flosum_repository_sync_dto_1[_0x48a6b5(0x17e)]['fromBranchRecord'](_0x177dca[0x0]);}async[a204_0x2e05a9(0x18a)](_0x20469a){const _0x2f66b8=a204_0x2e05a9,_0x18b3d2=await this[_0x2f66b8(0x1a5)][_0x2f66b8(0x190)](queries_1[_0x2f66b8(0x1bf)]['replace'](_0x2f66b8(0x17a),_0x20469a));if(_0x18b3d2['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Branch\x20'+_0x20469a+_0x2f66b8(0x1b6));const _0x475e6a=_0x18b3d2[_0x2f66b8(0x17d)](_0x31d7bd=>_0x31d7bd[constants_1[_0x2f66b8(0x188)]+'Branch_Name__c']===_0x20469a);if(!_0x475e6a)throw new not_found_error_1[(_0x2f66b8(0x18d))]('Branch\x20'+_0x20469a+_0x2f66b8(0x1b6));return flosum_repository_sync_dto_1[_0x2f66b8(0x17e)]['fromBranchRecord'](_0x475e6a);}async[a204_0x2e05a9(0x1a6)](_0x377288){const _0x572916=a204_0x2e05a9,_0x4d2df6=await this[_0x572916(0x1a5)][_0x572916(0x190)](queries_1[_0x572916(0x19f)]['replace']('%name%',_0x377288));if(_0x4d2df6[_0x572916(0x1cf)]===0x0)throw new not_found_error_1[(_0x572916(0x18d))](_0x572916(0x1b4)+_0x377288+_0x572916(0x1b6));return flosum_repository_sync_dto_1[_0x572916(0x17e)][_0x572916(0x1ce)](_0x4d2df6[0x0]);}async[a204_0x2e05a9(0x1b7)](_0x1dc155){const _0x29ca07=a204_0x2e05a9,_0x3111c8=_0x29ca07(0x1c7)+queries_1[_0x29ca07(0x1d3)]+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x1dc155+'\x27';return this[_0x29ca07(0x18b)](_0x3111c8);}async[a204_0x2e05a9(0x1c1)](_0x399cfe){const _0x375add=a204_0x2e05a9,_0x2a4d10=_0x375add(0x181)+queries_1[_0x375add(0x1d3)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x399cfe+'\x27';return this[_0x375add(0x18b)](_0x2a4d10);}async['getAttachmentId'](_0x1fa6b6){const _0x39e30a=a204_0x2e05a9;var _0x302257;const _0x45f38f=queries_1[_0x39e30a(0x180)][_0x39e30a(0x1b9)](_0x39e30a(0x17c),_0x1fa6b6[_0x39e30a(0x196)])[_0x39e30a(0x1b9)](_0x39e30a(0x17a),_0x1fa6b6['repositoryId']?constants_1[_0x39e30a(0x186)]:constants_1[_0x39e30a(0x1aa)]),_0x50eac5=await this[_0x39e30a(0x1a5)][_0x39e30a(0x190)](_0x45f38f),_0x43a267=(_0x302257=_0x50eac5[0x0])===null||_0x302257===void 0x0?void 0x0:_0x302257['Id'];if(!_0x43a267)throw new Error(errors_1[_0x39e30a(0x1bd)]);return _0x43a267;}async[a204_0x2e05a9(0x1b5)](_0x492ebf){const _0x2c37a7=a204_0x2e05a9;let _0x4f1aeb=await this[_0x2c37a7(0x18f)](_0x492ebf)[_0x2c37a7(0x1bb)](()=>null);return!_0x4f1aeb&&(_0x4f1aeb=await this['salesforceService']['createObject'](_0x2c37a7(0x1c9),{'Body':(0x0,utils_1[_0x2c37a7(0x1a9)])('{}'),'ParentId':_0x492ebf[_0x2c37a7(0x196)],'ContentType':_0x2c37a7(0x175),'Name':_0x492ebf[_0x2c37a7(0x1b0)]?constants_1[_0x2c37a7(0x186)]:constants_1[_0x2c37a7(0x1aa)]})),_0x4f1aeb;}async[a204_0x2e05a9(0x1ae)](_0x19180c,_0x51a3ee){const _0x2db72f=a204_0x2e05a9,_0x2aef15=await this[_0x2db72f(0x1b5)](_0x19180c);await this[_0x2db72f(0x1a7)][_0x2db72f(0x193)](_0x2db72f(0x1c9),_0x2aef15,{'Body':(0x0,utils_1[_0x2db72f(0x1a9)])(JSON[_0x2db72f(0x1c4)](_0x51a3ee))});}async[a204_0x2e05a9(0x1ba)](_0x58cd57,_0x2353d5){const _0x71a359=a204_0x2e05a9;await this[_0x71a359(0x1a7)][_0x71a359(0x193)](_0x58cd57[_0x71a359(0x18c)],_0x58cd57[_0x71a359(0x196)],{[constants_1[_0x71a359(0x19a)]+_0x71a359(0x1c3)]:_0x2353d5});}async[a204_0x2e05a9(0x174)](_0x11c0a7){const _0x2b88e0=a204_0x2e05a9;await this[_0x2b88e0(0x1a7)][_0x2b88e0(0x193)](constants_1[_0x2b88e0(0x19a)]+_0x2b88e0(0x1d0),_0x11c0a7,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x2b88e0(0x1d2)]:![]});}};function a204_0x1bab(){const _0xc30b37=['getComponents','objectType','SalesforceNotFoundError','%id%','getAttachmentId','query','Name','getBranchRecord','patchObject','34896mAtpom','getAllRepositoryNames','objectId','SalesforceQueryService','GET_BRANCH_QUERY','apply','FLOSUM_GIT_NAMESPACE','./salesforce-query.service','object','map','SalesforceService','GET_REPOSITORY_BY_NAME_QUERY','862284JodqQD','Repository__r','function','typedi','design:paramtypes','salesforceQuery','getRepositoryRecordByName','salesforceService','Service','encodeBase64','SYNC_ATTACHMENT_FOR_BRANCH_NAME','defineProperty','decorate','GET_REPOSITORY_QUERY','updateRemoteState','getBranchRecords','repositoryId','getRepositoryRecord','GET_REPOSITORIES_NAMES_QUERY','1665oqJnqC','Repository\x20','getRemoteStateAttachmentId','\x20not\x20found\x20on\x20salesforce','getComponentsFromRepository','7356hrgjKq','replace','setStatus','catch','../errors/not-found.error','ERR_INVALID_ATTACHMENT_ID','search','GET_BRANCH_BY_NAME_QUERY','../../../../constants/errors','getBranchComponents','GET_WAITING_BRANCHES_QUERY','Synchronization_Status__c','stringify','(((.+)+)+)+$','constructor','\x0a\x20\x20\x20\x20\x20\x20','6363427oaauIP','Attachment','__metadata','toString','records','../dto/flosum-repository-sync.dto','fromRepositoryRecord','length','Connection__c','2150360sNIJgh','Sync_In_Progress__c','GET_COMPONENTS_QUERY','Branch\x20with\x20Id\x20','613576MgovTT','./salesforce.service','disableSync','text/plain','SalesforceSyncService','2302460bxIJSo','fromBranchRecord','GET_WAITING_REPOSITORIES_QUERY','%name%','__esModule','%parentId%','find','FlosumRepositorySyncDto','../queries','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','90SWwlEM','metadata','__decorate','148mwCFqM','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','getOwnPropertyDescriptor','FLOSUM_NAMESPACE','push','getBranchRecordByName'];a204_0x1bab=function(){return _0xc30b37;};return a204_0x1bab();}SalesforceSyncService=__decorate([(0x0,typedi_1[a204_0x2e05a9(0x1a8)])(),__metadata(a204_0x2e05a9(0x1a4),[salesforce_query_service_1[a204_0x2e05a9(0x197)],salesforce_service_1[a204_0x2e05a9(0x19e)]])],SalesforceSyncService),exports[a204_0x2e05a9(0x176)]=SalesforceSyncService;