const a243_0x597443=a243_0x333c;(function(_0x5aed3e,_0x168f2a){const _0x37e095=a243_0x333c,_0x332d9f=_0x5aed3e();while(!![]){try{const _0xbfcf48=-parseInt(_0x37e095(0x8b))/0x1*(-parseInt(_0x37e095(0x82))/0x2)+parseInt(_0x37e095(0xc3))/0x3+parseInt(_0x37e095(0xa2))/0x4*(parseInt(_0x37e095(0xa1))/0x5)+-parseInt(_0x37e095(0xa0))/0x6+-parseInt(_0x37e095(0xa9))/0x7*(-parseInt(_0x37e095(0x8f))/0x8)+-parseInt(_0x37e095(0x8c))/0x9*(parseInt(_0x37e095(0x84))/0xa)+parseInt(_0x37e095(0xca))/0xb*(-parseInt(_0x37e095(0xd5))/0xc);if(_0xbfcf48===_0x168f2a)break;else _0x332d9f['push'](_0x332d9f['shift']());}catch(_0x1aad3c){_0x332d9f['push'](_0x332d9f['shift']());}}}(a243_0x3a17,0xe9c3f));function a243_0x333c(_0x3b3218,_0x45b5c2){const _0x1b1adb=a243_0x3a17();return a243_0x333c=function(_0xaa1bfc,_0x6b4f76){_0xaa1bfc=_0xaa1bfc-0x77;let _0x3a170d=_0x1b1adb[_0xaa1bfc];return _0x3a170d;},a243_0x333c(_0x3b3218,_0x45b5c2);}const a243_0x6b4f76=(function(){let _0x5a35b1=!![];return function(_0x1bf103,_0x2d9877){const _0x31714d=_0x5a35b1?function(){if(_0x2d9877){const _0x140383=_0x2d9877['apply'](_0x1bf103,arguments);return _0x2d9877=null,_0x140383;}}:function(){};return _0x5a35b1=![],_0x31714d;};}()),a243_0xaa1bfc=a243_0x6b4f76(this,function(){const _0x49750d=a243_0x333c;return a243_0xaa1bfc['toString']()[_0x49750d(0xc7)](_0x49750d(0x8d))[_0x49750d(0x90)]()[_0x49750d(0xb5)](a243_0xaa1bfc)[_0x49750d(0xc7)](_0x49750d(0x8d));});a243_0xaa1bfc();'use strict';var __decorate=this&&this[a243_0x597443(0x92)]||function(_0x21309a,_0x42fab0,_0xf36224,_0x456664){const _0x523d33=a243_0x597443;var _0x346948=arguments['length'],_0x15840e=_0x346948<0x3?_0x42fab0:_0x456664===null?_0x456664=Object[_0x523d33(0x97)](_0x42fab0,_0xf36224):_0x456664,_0x470587;if(typeof Reflect===_0x523d33(0x87)&&typeof Reflect[_0x523d33(0xbd)]==='function')_0x15840e=Reflect[_0x523d33(0xbd)](_0x21309a,_0x42fab0,_0xf36224,_0x456664);else{for(var _0x1b6cb6=_0x21309a[_0x523d33(0x8a)]-0x1;_0x1b6cb6>=0x0;_0x1b6cb6--)if(_0x470587=_0x21309a[_0x1b6cb6])_0x15840e=(_0x346948<0x3?_0x470587(_0x15840e):_0x346948>0x3?_0x470587(_0x42fab0,_0xf36224,_0x15840e):_0x470587(_0x42fab0,_0xf36224))||_0x15840e;}return _0x346948>0x3&&_0x15840e&&Object[_0x523d33(0xa7)](_0x42fab0,_0xf36224,_0x15840e),_0x15840e;},__metadata=this&&this['__metadata']||function(_0x1f191e,_0x314e92){const _0x326f4e=a243_0x597443;if(typeof Reflect===_0x326f4e(0x87)&&typeof Reflect['metadata']===_0x326f4e(0xd1))return Reflect[_0x326f4e(0xd3)](_0x1f191e,_0x314e92);};Object[a243_0x597443(0xa7)](exports,a243_0x597443(0x78),{'value':!![]}),exports[a243_0x597443(0x9c)]=void 0x0;const typedi_1=require(a243_0x597443(0xbe)),constants_1=require(a243_0x597443(0xa8)),errors_1=require(a243_0x597443(0xb9)),utils_1=require(a243_0x597443(0x7b)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a243_0x597443(0xcd)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a243_0x597443(0xc9));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x364843,_0x4e1ccb){const _0x226fa7=a243_0x597443;this[_0x226fa7(0x83)]=_0x364843,this[_0x226fa7(0x7e)]=_0x4e1ccb;}async['getComponents'](_0xb72ac0){const _0xcf6fd1=a243_0x597443;var _0x32ca0d;const _0x20cafa=await this[_0xcf6fd1(0x83)]['query'](_0xb72ac0),_0x30b782=[];for(const _0x3d1a7e of _0x20cafa){const _0x2c3bbc=(_0x32ca0d=_0x3d1a7e[constants_1[_0xcf6fd1(0x95)]+_0xcf6fd1(0x7c)])===null||_0x32ca0d===void 0x0?void 0x0:_0x32ca0d[_0xcf6fd1(0xa4)];_0x2c3bbc&&_0x2c3bbc[_0xcf6fd1(0x8a)]&&_0x30b782[_0xcf6fd1(0xac)](_0x2c3bbc[0x0]['Id']);}return _0x30b782;}async[a243_0x597443(0xcf)](_0x485e86){const _0x4dfa8b=a243_0x597443,_0x167e3d=await this[_0x4dfa8b(0x83)][_0x4dfa8b(0x79)](queries_1[_0x4dfa8b(0xc6)][_0x4dfa8b(0xb4)](/\%connection_id\%/g,_0x485e86));return _0x167e3d['map'](_0x46eb6e=>{const _0x5dbef3=_0x4dfa8b;return _0x46eb6e[constants_1[_0x5dbef3(0x9f)]+_0x5dbef3(0x77)]?_0x46eb6e[constants_1[_0x5dbef3(0x9f)]+_0x5dbef3(0x77)][_0x5dbef3(0xa5)]:_0x46eb6e['Name'];});}async[a243_0x597443(0x7f)](_0x18d8e5){const _0x100771=a243_0x597443,_0x4ceb9c=await this[_0x100771(0x83)][_0x100771(0x79)](queries_1[_0x100771(0x81)][_0x100771(0xb4)](/\%connection_id\%/g,_0x18d8e5));return _0x4ceb9c[_0x100771(0xa3)](_0x2e38c=>flosum_repository_sync_dto_1[_0x100771(0xcb)][_0x100771(0xc2)](_0x2e38c));}async['getBranchRecords'](_0x44c8ee){const _0x451dda=a243_0x597443,_0x528eef=await this['salesforceQuery'][_0x451dda(0x79)](queries_1[_0x451dda(0x96)][_0x451dda(0xb4)](/%repositories_ids\%/g,_0x44c8ee));return _0x528eef['map'](_0x593695=>flosum_repository_sync_dto_1[_0x451dda(0xcb)]['fromBranchRecord'](_0x593695));}async[a243_0x597443(0xd4)](_0x15fe5b){const _0x3c8a2c=a243_0x597443,_0x5750c0=await this[_0x3c8a2c(0x83)][_0x3c8a2c(0x79)](queries_1[_0x3c8a2c(0x9b)][_0x3c8a2c(0xb4)](_0x3c8a2c(0xc8),_0x15fe5b));if(_0x5750c0[_0x3c8a2c(0x8a)]===0x0)throw new not_found_error_1[(_0x3c8a2c(0xbc))](_0x3c8a2c(0xd6)+_0x15fe5b+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x3c8a2c(0xcb)]['fromRepositoryRecord'](_0x5750c0[0x0]);}async[a243_0x597443(0x7a)](_0x61bf8e){const _0x5802b7=a243_0x597443,_0xba6bc9=await this[_0x5802b7(0x83)][_0x5802b7(0x79)](queries_1['GET_BRANCH_QUERY'][_0x5802b7(0xb4)](_0x5802b7(0xc8),_0x61bf8e));if(_0xba6bc9[_0x5802b7(0x8a)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x5802b7(0xd2)+_0x61bf8e+_0x5802b7(0xd7));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x5802b7(0xb1)](_0xba6bc9[0x0]);}async[a243_0x597443(0xab)](_0x420a90){const _0x35b098=a243_0x597443,_0xc79978=await this[_0x35b098(0x83)][_0x35b098(0x79)](queries_1[_0x35b098(0xbf)][_0x35b098(0xb4)](_0x35b098(0x88),_0x420a90));if(_0xc79978[_0x35b098(0x8a)]===0x0)throw new not_found_error_1[(_0x35b098(0xbc))](_0x35b098(0xb7)+_0x420a90+_0x35b098(0xd7));const _0x46e31=_0xc79978[_0x35b098(0xa6)](_0x3d4286=>_0x3d4286[constants_1[_0x35b098(0x95)]+_0x35b098(0xcc)]===_0x420a90);if(!_0x46e31)throw new not_found_error_1['SalesforceNotFoundError']('Branch\x20'+_0x420a90+_0x35b098(0xd7));return flosum_repository_sync_dto_1[_0x35b098(0xcb)][_0x35b098(0xb1)](_0x46e31);}async['getRepositoryRecordByName'](_0x10e2d0){const _0xc56b13=a243_0x597443,_0x5ae745=await this[_0xc56b13(0x83)][_0xc56b13(0x79)](queries_1[_0xc56b13(0xaa)][_0xc56b13(0xb4)](_0xc56b13(0x88),_0x10e2d0));if(_0x5ae745[_0xc56b13(0x8a)]===0x0)throw new not_found_error_1[(_0xc56b13(0xbc))](_0xc56b13(0xc1)+_0x10e2d0+_0xc56b13(0xd7));return flosum_repository_sync_dto_1[_0xc56b13(0xcb)]['fromRepositoryRecord'](_0x5ae745[0x0]);}async[a243_0x597443(0x91)](_0xdcb4bd){const _0x361882=a243_0x597443,_0x45035c=_0x361882(0xba)+queries_1[_0x361882(0x94)]+_0x361882(0xc4)+_0xdcb4bd+'\x27';return this[_0x361882(0xb0)](_0x45035c);}async[a243_0x597443(0x80)](_0x3b97c5){const _0x67181c=a243_0x597443,_0x11fe78='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x67181c(0x94)]+_0x67181c(0x7d)+_0x3b97c5+'\x27';return this[_0x67181c(0xb0)](_0x11fe78);}async[a243_0x597443(0xc0)](_0x5fb9e4){const _0x1ee83f=a243_0x597443;var _0x2fe44c;const _0x36f8a4=queries_1[_0x1ee83f(0xd0)][_0x1ee83f(0xb4)]('%parentId%',_0x5fb9e4[_0x1ee83f(0x86)])['replace']('%name%',_0x5fb9e4[_0x1ee83f(0xce)]?constants_1[_0x1ee83f(0x9a)]:constants_1[_0x1ee83f(0x8e)]),_0x389873=await this[_0x1ee83f(0x83)][_0x1ee83f(0x79)](_0x36f8a4),_0x385c05=(_0x2fe44c=_0x389873[0x0])===null||_0x2fe44c===void 0x0?void 0x0:_0x2fe44c['Id'];if(!_0x385c05)throw new Error(errors_1[_0x1ee83f(0x98)]);return _0x385c05;}async[a243_0x597443(0xad)](_0x95c9e5){const _0x388054=a243_0x597443;let _0x1d3004=await this['getAttachmentId'](_0x95c9e5)[_0x388054(0xbb)](()=>null);return!_0x1d3004&&(_0x1d3004=await this[_0x388054(0x7e)]['createObject'](_0x388054(0xb6),{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x95c9e5['objectId'],'ContentType':_0x388054(0x9d),'Name':_0x95c9e5[_0x388054(0xce)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x388054(0x8e)]})),_0x1d3004;}async[a243_0x597443(0x93)](_0x1db1e5,_0x5ddbb9){const _0x3bc7d3=a243_0x597443,_0x38de6c=await this[_0x3bc7d3(0xad)](_0x1db1e5);await this[_0x3bc7d3(0x7e)]['patchObject'](_0x3bc7d3(0xb6),_0x38de6c,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x3bc7d3(0x9e)](_0x5ddbb9))});}async[a243_0x597443(0xae)](_0x33826b,_0x5e9306){const _0x526c56=a243_0x597443;await this[_0x526c56(0x7e)]['patchObject'](_0x33826b[_0x526c56(0xb8)],_0x33826b[_0x526c56(0x86)],{[constants_1[_0x526c56(0x9f)]+_0x526c56(0x99)]:_0x5e9306});}async[a243_0x597443(0xaf)](_0x5eab4b){const _0x1b0edd=a243_0x597443;await this['salesforceService'][_0x1b0edd(0xb2)](constants_1[_0x1b0edd(0x9f)]+'Connection__c',_0x5eab4b,{[constants_1[_0x1b0edd(0x9f)]+_0x1b0edd(0x85)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x597443(0xb3)])(),__metadata(a243_0x597443(0x89),[salesforce_query_service_1[a243_0x597443(0xc5)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports[a243_0x597443(0x9c)]=SalesforceSyncService;function a243_0x3a17(){const _0x234a7b=['decorate','typedi','GET_BRANCH_BY_NAME_QUERY','getAttachmentId','Repository\x20','fromRepositoryRecord','4938609HMrdLu','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','SalesforceQueryService','GET_REPOSITORIES_NAMES_QUERY','search','%id%','./salesforce.service','341jDSHgH','FlosumRepositorySyncDto','Branch_Name__c','../queries','repositoryId','getAllRepositoryNames','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','function','Branch\x20with\x20Id\x20','metadata','getRepositoryRecord','47304ulKneU','Repository\x20with\x20Id\x20','\x20not\x20found\x20on\x20salesforce','Repository__r','__esModule','query','getBranchRecord','../../../shared/utils','Components__r','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','salesforceService','getRepositoryRecords','getBranchComponents','GET_WAITING_REPOSITORIES_QUERY','378QLLMtg','salesforceQuery','8710AHNolT','Sync_In_Progress__c','objectId','object','%name%','design:paramtypes','length','4563DebFMA','153ziVMjU','(((.+)+)+)+$','SYNC_ATTACHMENT_FOR_BRANCH_NAME','864360tQcDYK','toString','getComponentsFromRepository','__decorate','updateRemoteState','GET_COMPONENTS_QUERY','FLOSUM_NAMESPACE','GET_WAITING_BRANCHES_QUERY','getOwnPropertyDescriptor','ERR_INVALID_ATTACHMENT_ID','Synchronization_Status__c','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','GET_REPOSITORY_QUERY','SalesforceSyncService','text/plain','stringify','FLOSUM_GIT_NAMESPACE','11337456YLnqYE','5BhzJzZ','605372oTkDRE','map','records','Name','find','defineProperty','../../../../constants','21vqDyNQ','GET_REPOSITORY_BY_NAME_QUERY','getBranchRecordByName','push','getRemoteStateAttachmentId','setStatus','disableSync','getComponents','fromBranchRecord','patchObject','Service','replace','constructor','Attachment','Branch\x20','objectType','../../../../constants/errors','\x0a\x20\x20\x20\x20\x20\x20','catch','SalesforceNotFoundError'];a243_0x3a17=function(){return _0x234a7b;};return a243_0x3a17();}