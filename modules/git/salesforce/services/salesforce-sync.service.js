const a281_0x494a61=a281_0x4f88;(function(_0x5b5ea3,_0x27006d){const _0x9983db=a281_0x4f88,_0x1363b1=_0x5b5ea3();while(!![]){try{const _0x4edca8=-parseInt(_0x9983db(0xe0))/0x1*(-parseInt(_0x9983db(0xcc))/0x2)+parseInt(_0x9983db(0x11e))/0x3+-parseInt(_0x9983db(0xd2))/0x4*(-parseInt(_0x9983db(0xf3))/0x5)+parseInt(_0x9983db(0xdd))/0x6*(-parseInt(_0x9983db(0xed))/0x7)+parseInt(_0x9983db(0xc5))/0x8+parseInt(_0x9983db(0xd5))/0x9+parseInt(_0x9983db(0xd8))/0xa*(-parseInt(_0x9983db(0xf2))/0xb);if(_0x4edca8===_0x27006d)break;else _0x1363b1['push'](_0x1363b1['shift']());}catch(_0x87995){_0x1363b1['push'](_0x1363b1['shift']());}}}(a281_0x30a8,0x7ee26));const a281_0x45a13f=(function(){let _0x3e6924=!![];return function(_0x54aa8f,_0x427512){const _0x20419f=_0x3e6924?function(){const _0xfa7eb7=a281_0x4f88;if(_0x427512){const _0x3f9056=_0x427512[_0xfa7eb7(0xf9)](_0x54aa8f,arguments);return _0x427512=null,_0x3f9056;}}:function(){};return _0x3e6924=![],_0x20419f;};}()),a281_0x2c9b6a=a281_0x45a13f(this,function(){const _0x582e02=a281_0x4f88;return a281_0x2c9b6a[_0x582e02(0xfa)]()[_0x582e02(0xe8)](_0x582e02(0xc4))[_0x582e02(0xfa)]()[_0x582e02(0x11c)](a281_0x2c9b6a)[_0x582e02(0xe8)](_0x582e02(0xc4));});function a281_0x4f88(_0x5c3498,_0x4cf34b){const _0xba07bc=a281_0x30a8();return a281_0x4f88=function(_0x2c9b6a,_0x45a13f){_0x2c9b6a=_0x2c9b6a-0xc4;let _0x30a8e6=_0xba07bc[_0x2c9b6a];return _0x30a8e6;},a281_0x4f88(_0x5c3498,_0x4cf34b);}function a281_0x30a8(){const _0x11be6b=['../dto/flosum-repository-sync.dto','decorate','search','stringify','./salesforce-query.service','Attachment','SYNC_ATTACHMENT_FOR_BRANCH_NAME','3282979pbBhyy','find','objectType','defineProperty','disableSync','2387qApDVx','1376525RALtSx','__esModule','../../../../constants/errors','text/plain','Synchronization_Status__c','getComponentsFromRepository','apply','toString','Name','length','Repository\x20with\x20Id\x20','Branch\x20','GET_REPOSITORY_BY_NAME_QUERY','salesforceService','\x0a\x20\x20\x20\x20\x20\x20','../errors/not-found.error','GET_BRANCH_BY_NAME_QUERY','objectId','getRepositoryRecord','map','query','Repository__r','typedi','records','Components__r','fromRepositoryRecord','SalesforceNotFoundError','design:paramtypes','getAttachmentId','getRepositoryRecords','createObject','getRemoteStateAttachmentId','../queries','../../../shared/utils','getOwnPropertyDescriptor','catch','encodeBase64','salesforceQuery','object','getComponents','FLOSUM_NAMESPACE','constructor','__metadata','2094156mCYAQh','updateRemoteState','fromBranchRecord','__decorate','GET_REPOSITORY_QUERY','(((.+)+)+)+$','3067792UKNbjA','GET_COMPONENTS_QUERY','SalesforceSyncService','FlosumRepositorySyncDto','SalesforceQueryService','GET_WAITING_BRANCHES_QUERY','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','6218iOaLcu','FLOSUM_GIT_NAMESPACE','getAllRepositoryNames','Service','patchObject','function','8EUgRID','replace','Sync_In_Progress__c','9070533nDvRtb','getBranchRecord','metadata','98180SgWjza','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','SalesforceService','Repository\x20','%name%','12YABMAZ','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','getBranchRecordByName','305palsxK','%id%','GET_BRANCH_QUERY','./salesforce.service','\x20not\x20found\x20on\x20salesforce','\x0a\x20\x20\x20\x20\x20\x20\x20\x20'];a281_0x30a8=function(){return _0x11be6b;};return a281_0x30a8();}a281_0x2c9b6a();'use strict';var __decorate=this&&this[a281_0x494a61(0x121)]||function(_0x5c1ca6,_0x1763d5,_0x37af12,_0x222b73){const _0x3fc61d=a281_0x494a61;var _0x57eb7b=arguments[_0x3fc61d(0xfc)],_0xe5f780=_0x57eb7b<0x3?_0x1763d5:_0x222b73===null?_0x222b73=Object[_0x3fc61d(0x115)](_0x1763d5,_0x37af12):_0x222b73,_0x4801cd;if(typeof Reflect===_0x3fc61d(0x119)&&typeof Reflect[_0x3fc61d(0xe7)]===_0x3fc61d(0xd1))_0xe5f780=Reflect[_0x3fc61d(0xe7)](_0x5c1ca6,_0x1763d5,_0x37af12,_0x222b73);else{for(var _0x2ea205=_0x5c1ca6[_0x3fc61d(0xfc)]-0x1;_0x2ea205>=0x0;_0x2ea205--)if(_0x4801cd=_0x5c1ca6[_0x2ea205])_0xe5f780=(_0x57eb7b<0x3?_0x4801cd(_0xe5f780):_0x57eb7b>0x3?_0x4801cd(_0x1763d5,_0x37af12,_0xe5f780):_0x4801cd(_0x1763d5,_0x37af12))||_0xe5f780;}return _0x57eb7b>0x3&&_0xe5f780&&Object[_0x3fc61d(0xf0)](_0x1763d5,_0x37af12,_0xe5f780),_0xe5f780;},__metadata=this&&this[a281_0x494a61(0x11d)]||function(_0x3dff99,_0x1f7752){const _0x36c34a=a281_0x494a61;if(typeof Reflect===_0x36c34a(0x119)&&typeof Reflect[_0x36c34a(0xd7)]===_0x36c34a(0xd1))return Reflect['metadata'](_0x3dff99,_0x1f7752);};Object['defineProperty'](exports,a281_0x494a61(0xf4),{'value':!![]}),exports[a281_0x494a61(0xc7)]=void 0x0;const typedi_1=require(a281_0x494a61(0x109)),constants_1=require('../../../../constants'),errors_1=require(a281_0x494a61(0xf5)),utils_1=require(a281_0x494a61(0x114)),flosum_repository_sync_dto_1=require(a281_0x494a61(0xe6)),not_found_error_1=require(a281_0x494a61(0x102)),queries_1=require(a281_0x494a61(0x113)),salesforce_query_service_1=require(a281_0x494a61(0xea)),salesforce_service_1=require(a281_0x494a61(0xe3));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x3fb464,_0x3043be){const _0x17f8b4=a281_0x494a61;this[_0x17f8b4(0x118)]=_0x3fb464,this[_0x17f8b4(0x100)]=_0x3043be;}async['getComponents'](_0x488080){const _0x17442a=a281_0x494a61;var _0x353750;const _0x347301=await this[_0x17442a(0x118)][_0x17442a(0x107)](_0x488080),_0x26614d=[];for(const _0x186420 of _0x347301){const _0x4f2df4=(_0x353750=_0x186420[constants_1[_0x17442a(0x11b)]+_0x17442a(0x10b)])===null||_0x353750===void 0x0?void 0x0:_0x353750[_0x17442a(0x10a)];_0x4f2df4&&_0x4f2df4[_0x17442a(0xfc)]&&_0x26614d['push'](_0x4f2df4[0x0]['Id']);}return _0x26614d;}async[a281_0x494a61(0xce)](_0x1b9955){const _0x19d57d=a281_0x494a61,_0x48133b=await this[_0x19d57d(0x118)][_0x19d57d(0x107)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x19d57d(0xd3)](/\%connection_id\%/g,_0x1b9955));return _0x48133b[_0x19d57d(0x106)](_0x220a08=>{const _0x5bd9dd=_0x19d57d;return _0x220a08[constants_1[_0x5bd9dd(0xcd)]+_0x5bd9dd(0x108)]?_0x220a08[constants_1[_0x5bd9dd(0xcd)]+_0x5bd9dd(0x108)][_0x5bd9dd(0xfb)]:_0x220a08[_0x5bd9dd(0xfb)];});}async[a281_0x494a61(0x110)](_0xc4c654){const _0x2cb049=a281_0x494a61,_0x29d278=await this['salesforceQuery'][_0x2cb049(0x107)](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x2cb049(0xd3)](/\%connection_id\%/g,_0xc4c654));return _0x29d278[_0x2cb049(0x106)](_0x1decb7=>flosum_repository_sync_dto_1[_0x2cb049(0xc8)][_0x2cb049(0x10c)](_0x1decb7));}async['getBranchRecords'](_0x5549e6){const _0x352369=a281_0x494a61,_0x5ed0a4=await this[_0x352369(0x118)][_0x352369(0x107)](queries_1[_0x352369(0xca)][_0x352369(0xd3)](/%repositories_ids\%/g,_0x5549e6));return _0x5ed0a4[_0x352369(0x106)](_0xed1ecb=>flosum_repository_sync_dto_1[_0x352369(0xc8)][_0x352369(0x120)](_0xed1ecb));}async[a281_0x494a61(0x105)](_0x5e7010){const _0x9a038e=a281_0x494a61,_0x23f4cf=await this[_0x9a038e(0x118)][_0x9a038e(0x107)](queries_1[_0x9a038e(0x122)][_0x9a038e(0xd3)](_0x9a038e(0xe1),_0x5e7010));if(_0x23f4cf['length']===0x0)throw new not_found_error_1[(_0x9a038e(0x10d))](_0x9a038e(0xfd)+_0x5e7010+_0x9a038e(0xe4));return flosum_repository_sync_dto_1[_0x9a038e(0xc8)]['fromRepositoryRecord'](_0x23f4cf[0x0]);}async[a281_0x494a61(0xd6)](_0x543567){const _0x4bad9c=a281_0x494a61,_0xe1ce2b=await this['salesforceQuery'][_0x4bad9c(0x107)](queries_1[_0x4bad9c(0xe2)][_0x4bad9c(0xd3)](_0x4bad9c(0xe1),_0x543567));if(_0xe1ce2b[_0x4bad9c(0xfc)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Branch\x20with\x20Id\x20'+_0x543567+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4bad9c(0x120)](_0xe1ce2b[0x0]);}async[a281_0x494a61(0xdf)](_0x11788d){const _0x2fb566=a281_0x494a61,_0x23bc9f=await this[_0x2fb566(0x118)][_0x2fb566(0x107)](queries_1[_0x2fb566(0x103)][_0x2fb566(0xd3)](_0x2fb566(0xdc),_0x11788d));if(_0x23bc9f[_0x2fb566(0xfc)]===0x0)throw new not_found_error_1[(_0x2fb566(0x10d))](_0x2fb566(0xfe)+_0x11788d+_0x2fb566(0xe4));const _0x3ddf27=_0x23bc9f[_0x2fb566(0xee)](_0x277cd1=>_0x277cd1[constants_1[_0x2fb566(0x11b)]+'Branch_Name__c']===_0x11788d);if(!_0x3ddf27)throw new not_found_error_1[(_0x2fb566(0x10d))](_0x2fb566(0xfe)+_0x11788d+_0x2fb566(0xe4));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x2fb566(0x120)](_0x3ddf27);}async['getRepositoryRecordByName'](_0xb70f7b){const _0x247220=a281_0x494a61,_0x4abcc7=await this[_0x247220(0x118)]['query'](queries_1[_0x247220(0xff)][_0x247220(0xd3)]('%name%',_0xb70f7b));if(_0x4abcc7['length']===0x0)throw new not_found_error_1[(_0x247220(0x10d))](_0x247220(0xdb)+_0xb70f7b+_0x247220(0xe4));return flosum_repository_sync_dto_1[_0x247220(0xc8)]['fromRepositoryRecord'](_0x4abcc7[0x0]);}async[a281_0x494a61(0xf8)](_0x5cffc1){const _0x3e5a7b=a281_0x494a61,_0x61ff06=_0x3e5a7b(0x101)+queries_1[_0x3e5a7b(0xc6)]+_0x3e5a7b(0xcb)+_0x5cffc1+'\x27';return this[_0x3e5a7b(0x11a)](_0x61ff06);}async['getBranchComponents'](_0x292591){const _0x17b245=a281_0x494a61,_0x341bae=_0x17b245(0xe5)+queries_1[_0x17b245(0xc6)]+_0x17b245(0xde)+_0x292591+'\x27';return this[_0x17b245(0x11a)](_0x341bae);}async['getAttachmentId'](_0x44dd56){const _0x5c5dd3=a281_0x494a61;var _0x4e6a8b;const _0x42320a=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x5c5dd3(0xd3)]('%parentId%',_0x44dd56['objectId'])['replace'](_0x5c5dd3(0xdc),_0x44dd56['repositoryId']?constants_1[_0x5c5dd3(0xd9)]:constants_1[_0x5c5dd3(0xec)]),_0x11d97d=await this[_0x5c5dd3(0x118)][_0x5c5dd3(0x107)](_0x42320a),_0x20d8be=(_0x4e6a8b=_0x11d97d[0x0])===null||_0x4e6a8b===void 0x0?void 0x0:_0x4e6a8b['Id'];if(!_0x20d8be)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x20d8be;}async[a281_0x494a61(0x112)](_0x240949){const _0x28ec97=a281_0x494a61;let _0x180ea9=await this[_0x28ec97(0x10f)](_0x240949)[_0x28ec97(0x116)](()=>null);return!_0x180ea9&&(_0x180ea9=await this[_0x28ec97(0x100)][_0x28ec97(0x111)](_0x28ec97(0xeb),{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x240949[_0x28ec97(0x104)],'ContentType':_0x28ec97(0xf6),'Name':_0x240949['repositoryId']?constants_1[_0x28ec97(0xd9)]:constants_1[_0x28ec97(0xec)]})),_0x180ea9;}async[a281_0x494a61(0x11f)](_0x163f01,_0x3d0f12){const _0x1c435b=a281_0x494a61,_0x2f1a9c=await this[_0x1c435b(0x112)](_0x163f01);await this[_0x1c435b(0x100)][_0x1c435b(0xd0)](_0x1c435b(0xeb),_0x2f1a9c,{'Body':(0x0,utils_1[_0x1c435b(0x117)])(JSON[_0x1c435b(0xe9)](_0x3d0f12))});}async['setStatus'](_0x39ce6e,_0x4ff93a){const _0x340fd3=a281_0x494a61;await this[_0x340fd3(0x100)][_0x340fd3(0xd0)](_0x39ce6e[_0x340fd3(0xef)],_0x39ce6e[_0x340fd3(0x104)],{[constants_1[_0x340fd3(0xcd)]+_0x340fd3(0xf7)]:_0x4ff93a});}async[a281_0x494a61(0xf1)](_0x4b757e){const _0x5a1da2=a281_0x494a61;await this[_0x5a1da2(0x100)][_0x5a1da2(0xd0)](constants_1['FLOSUM_GIT_NAMESPACE']+'Connection__c',_0x4b757e,{[constants_1[_0x5a1da2(0xcd)]+_0x5a1da2(0xd4)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a281_0x494a61(0xcf)])(),__metadata(a281_0x494a61(0x10e),[salesforce_query_service_1[a281_0x494a61(0xc9)],salesforce_service_1[a281_0x494a61(0xda)]])],SalesforceSyncService),exports[a281_0x494a61(0xc7)]=SalesforceSyncService;