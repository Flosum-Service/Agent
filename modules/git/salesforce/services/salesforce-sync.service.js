const a243_0x118a76=a243_0x36b0;(function(_0x51c427,_0xd4ba4){const _0x970898=a243_0x36b0,_0x3276ea=_0x51c427();while(!![]){try{const _0x447c77=parseInt(_0x970898(0x192))/0x1+parseInt(_0x970898(0x1e5))/0x2*(-parseInt(_0x970898(0x1bf))/0x3)+-parseInt(_0x970898(0x19e))/0x4*(parseInt(_0x970898(0x1d3))/0x5)+-parseInt(_0x970898(0x1aa))/0x6+parseInt(_0x970898(0x1b4))/0x7*(-parseInt(_0x970898(0x1b0))/0x8)+-parseInt(_0x970898(0x1d0))/0x9+parseInt(_0x970898(0x1c0))/0xa;if(_0x447c77===_0xd4ba4)break;else _0x3276ea['push'](_0x3276ea['shift']());}catch(_0x343428){_0x3276ea['push'](_0x3276ea['shift']());}}}(a243_0xe60c,0xb7640));function a243_0xe60c(){const _0x4c69ba=['GET_COMPONENTS_QUERY','FlosumRepositorySyncDto','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','Connection__c','SalesforceNotFoundError','1450022mUaQSw','../dto/flosum-repository-sync.dto','SalesforceQueryService','Repository\x20with\x20Id\x20','getBranchRecords','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','encodeBase64','updateRemoteState','repositoryId','getAttachmentId','\x20not\x20found\x20on\x20salesforce','search','1672eHTVEF','function','\x0a\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','GET_WAITING_BRANCHES_QUERY','SYNC_ATTACHMENT_FOR_BRANCH_NAME','getComponents','decorate','%name%','replace','fromRepositoryRecord','getRepositoryRecords','6244038ephWvV','GET_REPOSITORY_BY_NAME_QUERY','getBranchRecordByName','getRepositoryRecord','fromBranchRecord','getComponentsFromRepository','168qwQBVc','length','../queries','query','394765rogHeq','toString','constructor','Repository\x20','%id%','GET_REPOSITORIES_NAMES_QUERY','SalesforceSyncService','stringify','Name','Components__r','text/plain','3WQLCLK','31989200cgCaII','../errors/not-found.error','salesforceService','./salesforce-query.service','getBranchComponents','__esModule','getAllRepositoryNames','%parentId%','Branch\x20with\x20Id\x20','(((.+)+)+)+$','Attachment','getBranchRecord','GET_BRANCH_BY_NAME_QUERY','Repository__r','typedi','push','4032837MmFUon','../../../shared/utils','catch','13535Igpjfn','metadata','setStatus','Sync_In_Progress__c','Branch\x20','GET_REPOSITORY_QUERY','__decorate','objectId','getRepositoryRecordByName','find','../../../../constants','GET_BRANCH_QUERY','salesforceQuery','defineProperty','FLOSUM_NAMESPACE','design:paramtypes','getRemoteStateAttachmentId','../../../../constants/errors','186374BPkmit','Synchronization_Status__c','__metadata','FLOSUM_GIT_NAMESPACE','map','object','SalesforceService','getOwnPropertyDescriptor'];a243_0xe60c=function(){return _0x4c69ba;};return a243_0xe60c();}const a243_0x3057a9=(function(){let _0x334ce0=!![];return function(_0xfd152d,_0xca3587){const _0x4c4bf2=_0x334ce0?function(){if(_0xca3587){const _0x23741b=_0xca3587['apply'](_0xfd152d,arguments);return _0xca3587=null,_0x23741b;}}:function(){};return _0x334ce0=![],_0x4c4bf2;};}()),a243_0x365923=a243_0x3057a9(this,function(){const _0x22eaba=a243_0x36b0;return a243_0x365923['toString']()[_0x22eaba(0x19d)](_0x22eaba(0x1c9))[_0x22eaba(0x1b5)]()[_0x22eaba(0x1b6)](a243_0x365923)[_0x22eaba(0x19d)](_0x22eaba(0x1c9));});function a243_0x36b0(_0x51f29f,_0x435966){const _0x43d329=a243_0xe60c();return a243_0x36b0=function(_0x365923,_0x3057a9){_0x365923=_0x365923-0x188;let _0xe60c67=_0x43d329[_0x365923];return _0xe60c67;},a243_0x36b0(_0x51f29f,_0x435966);}a243_0x365923();'use strict';var __decorate=this&&this[a243_0x118a76(0x1d9)]||function(_0x316459,_0x51f98f,_0x53cdfb,_0x536f75){const _0x5adc6f=a243_0x118a76;var _0x45975c=arguments[_0x5adc6f(0x1b1)],_0x19729b=_0x45975c<0x3?_0x51f98f:_0x536f75===null?_0x536f75=Object[_0x5adc6f(0x18c)](_0x51f98f,_0x53cdfb):_0x536f75,_0x48a5f4;if(typeof Reflect===_0x5adc6f(0x18a)&&typeof Reflect[_0x5adc6f(0x1a5)]===_0x5adc6f(0x19f))_0x19729b=Reflect[_0x5adc6f(0x1a5)](_0x316459,_0x51f98f,_0x53cdfb,_0x536f75);else{for(var _0x1d2855=_0x316459[_0x5adc6f(0x1b1)]-0x1;_0x1d2855>=0x0;_0x1d2855--)if(_0x48a5f4=_0x316459[_0x1d2855])_0x19729b=(_0x45975c<0x3?_0x48a5f4(_0x19729b):_0x45975c>0x3?_0x48a5f4(_0x51f98f,_0x53cdfb,_0x19729b):_0x48a5f4(_0x51f98f,_0x53cdfb))||_0x19729b;}return _0x45975c>0x3&&_0x19729b&&Object[_0x5adc6f(0x1e0)](_0x51f98f,_0x53cdfb,_0x19729b),_0x19729b;},__metadata=this&&this[a243_0x118a76(0x1e7)]||function(_0x67c8f1,_0x20c18c){const _0x405d3e=a243_0x118a76;if(typeof Reflect===_0x405d3e(0x18a)&&typeof Reflect[_0x405d3e(0x1d4)]===_0x405d3e(0x19f))return Reflect['metadata'](_0x67c8f1,_0x20c18c);};Object[a243_0x118a76(0x1e0)](exports,a243_0x118a76(0x1c5),{'value':!![]}),exports[a243_0x118a76(0x1ba)]=void 0x0;const typedi_1=require(a243_0x118a76(0x1ce)),constants_1=require(a243_0x118a76(0x1dd)),errors_1=require(a243_0x118a76(0x1e4)),utils_1=require(a243_0x118a76(0x1d1)),flosum_repository_sync_dto_1=require(a243_0x118a76(0x193)),not_found_error_1=require(a243_0x118a76(0x1c1)),queries_1=require(a243_0x118a76(0x1b2)),salesforce_query_service_1=require(a243_0x118a76(0x1c3)),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0x35dc5e,_0x43fcdf){const _0xdb1580=a243_0x118a76;this[_0xdb1580(0x1df)]=_0x35dc5e,this['salesforceService']=_0x43fcdf;}async[a243_0x118a76(0x1a4)](_0xc9e951){const _0x54c1f6=a243_0x118a76;var _0x9cb191;const _0x459e13=await this[_0x54c1f6(0x1df)]['query'](_0xc9e951),_0x5026b1=[];for(const _0x1c1dde of _0x459e13){const _0x2f9362=(_0x9cb191=_0x1c1dde[constants_1[_0x54c1f6(0x1e1)]+_0x54c1f6(0x1bd)])===null||_0x9cb191===void 0x0?void 0x0:_0x9cb191['records'];_0x2f9362&&_0x2f9362[_0x54c1f6(0x1b1)]&&_0x5026b1[_0x54c1f6(0x1cf)](_0x2f9362[0x0]['Id']);}return _0x5026b1;}async[a243_0x118a76(0x1c6)](_0x1a6f77){const _0x139d53=a243_0x118a76,_0x16bf52=await this[_0x139d53(0x1df)]['query'](queries_1[_0x139d53(0x1b9)][_0x139d53(0x1a7)](/\%connection_id\%/g,_0x1a6f77));return _0x16bf52[_0x139d53(0x189)](_0x2e8554=>{const _0x13768f=_0x139d53;return _0x2e8554[constants_1['FLOSUM_GIT_NAMESPACE']+_0x13768f(0x1cd)]?_0x2e8554[constants_1['FLOSUM_GIT_NAMESPACE']+_0x13768f(0x1cd)][_0x13768f(0x1bc)]:_0x2e8554[_0x13768f(0x1bc)];});}async[a243_0x118a76(0x1a9)](_0x4670d9){const _0x4add31=a243_0x118a76,_0x49f100=await this[_0x4add31(0x1df)]['query'](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x4add31(0x1a7)](/\%connection_id\%/g,_0x4670d9));return _0x49f100[_0x4add31(0x189)](_0x4da75a=>flosum_repository_sync_dto_1[_0x4add31(0x18e)][_0x4add31(0x1a8)](_0x4da75a));}async[a243_0x118a76(0x196)](_0x1b0cf6){const _0x4b4ef9=a243_0x118a76,_0x10184c=await this['salesforceQuery'][_0x4b4ef9(0x1b3)](queries_1[_0x4b4ef9(0x1a2)]['replace'](/%repositories_ids\%/g,_0x1b0cf6));return _0x10184c[_0x4b4ef9(0x189)](_0x15ef85=>flosum_repository_sync_dto_1[_0x4b4ef9(0x18e)][_0x4b4ef9(0x1ae)](_0x15ef85));}async[a243_0x118a76(0x1ad)](_0x3f9d54){const _0x46e345=a243_0x118a76,_0x255ce4=await this[_0x46e345(0x1df)][_0x46e345(0x1b3)](queries_1[_0x46e345(0x1d8)][_0x46e345(0x1a7)](_0x46e345(0x1b8),_0x3f9d54));if(_0x255ce4[_0x46e345(0x1b1)]===0x0)throw new not_found_error_1[(_0x46e345(0x191))](_0x46e345(0x195)+_0x3f9d54+_0x46e345(0x19c));return flosum_repository_sync_dto_1[_0x46e345(0x18e)][_0x46e345(0x1a8)](_0x255ce4[0x0]);}async[a243_0x118a76(0x1cb)](_0x4319dc){const _0x419eec=a243_0x118a76,_0x17b7d3=await this[_0x419eec(0x1df)][_0x419eec(0x1b3)](queries_1[_0x419eec(0x1de)][_0x419eec(0x1a7)](_0x419eec(0x1b8),_0x4319dc));if(_0x17b7d3[_0x419eec(0x1b1)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x419eec(0x1c8)+_0x4319dc+_0x419eec(0x19c));return flosum_repository_sync_dto_1[_0x419eec(0x18e)][_0x419eec(0x1ae)](_0x17b7d3[0x0]);}async[a243_0x118a76(0x1ac)](_0x1de0fd){const _0x490637=a243_0x118a76,_0x2a1960=await this[_0x490637(0x1df)]['query'](queries_1[_0x490637(0x1cc)][_0x490637(0x1a7)](_0x490637(0x1a6),_0x1de0fd));if(_0x2a1960[_0x490637(0x1b1)]===0x0)throw new not_found_error_1[(_0x490637(0x191))](_0x490637(0x1d7)+_0x1de0fd+_0x490637(0x19c));const _0xaf35a6=_0x2a1960[_0x490637(0x1dc)](_0x1c2dee=>_0x1c2dee[constants_1['FLOSUM_NAMESPACE']+'Branch_Name__c']===_0x1de0fd);if(!_0xaf35a6)throw new not_found_error_1[(_0x490637(0x191))](_0x490637(0x1d7)+_0x1de0fd+_0x490637(0x19c));return flosum_repository_sync_dto_1[_0x490637(0x18e)][_0x490637(0x1ae)](_0xaf35a6);}async[a243_0x118a76(0x1db)](_0x3b5914){const _0x13a731=a243_0x118a76,_0x141191=await this[_0x13a731(0x1df)][_0x13a731(0x1b3)](queries_1[_0x13a731(0x1ab)]['replace'](_0x13a731(0x1a6),_0x3b5914));if(_0x141191[_0x13a731(0x1b1)]===0x0)throw new not_found_error_1[(_0x13a731(0x191))](_0x13a731(0x1b7)+_0x3b5914+_0x13a731(0x19c));return flosum_repository_sync_dto_1[_0x13a731(0x18e)][_0x13a731(0x1a8)](_0x141191[0x0]);}async[a243_0x118a76(0x1af)](_0x5a5dcb){const _0x7b43d7=a243_0x118a76,_0x331360=_0x7b43d7(0x1a0)+queries_1[_0x7b43d7(0x18d)]+_0x7b43d7(0x18f)+_0x5a5dcb+'\x27';return this[_0x7b43d7(0x1a4)](_0x331360);}async[a243_0x118a76(0x1c4)](_0x540e7a){const _0x662c24=a243_0x118a76,_0x2ae740='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x662c24(0x18d)]+_0x662c24(0x1a1)+_0x540e7a+'\x27';return this['getComponents'](_0x2ae740);}async[a243_0x118a76(0x19b)](_0x8df4ab){const _0x580dd7=a243_0x118a76;var _0x4ec245;const _0x2c3830=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x580dd7(0x1a7)](_0x580dd7(0x1c7),_0x8df4ab[_0x580dd7(0x1da)])[_0x580dd7(0x1a7)](_0x580dd7(0x1a6),_0x8df4ab['repositoryId']?constants_1[_0x580dd7(0x197)]:constants_1[_0x580dd7(0x1a3)]),_0x597d83=await this['salesforceQuery'][_0x580dd7(0x1b3)](_0x2c3830),_0x596e84=(_0x4ec245=_0x597d83[0x0])===null||_0x4ec245===void 0x0?void 0x0:_0x4ec245['Id'];if(!_0x596e84)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x596e84;}async[a243_0x118a76(0x1e3)](_0xa73d2e){const _0x3f691a=a243_0x118a76;let _0x4bc4c3=await this[_0x3f691a(0x19b)](_0xa73d2e)[_0x3f691a(0x1d2)](()=>null);return!_0x4bc4c3&&(_0x4bc4c3=await this[_0x3f691a(0x1c2)]['createObject'](_0x3f691a(0x1ca),{'Body':(0x0,utils_1[_0x3f691a(0x198)])('{}'),'ParentId':_0xa73d2e[_0x3f691a(0x1da)],'ContentType':_0x3f691a(0x1be),'Name':_0xa73d2e[_0x3f691a(0x19a)]?constants_1[_0x3f691a(0x197)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x4bc4c3;}async[a243_0x118a76(0x199)](_0x9fa666,_0x4dc255){const _0x37f516=a243_0x118a76,_0xefcd84=await this[_0x37f516(0x1e3)](_0x9fa666);await this[_0x37f516(0x1c2)]['patchObject'](_0x37f516(0x1ca),_0xefcd84,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x37f516(0x1bb)](_0x4dc255))});}async[a243_0x118a76(0x1d5)](_0x3998fc,_0x4d4d35){const _0x346732=a243_0x118a76;await this[_0x346732(0x1c2)]['patchObject'](_0x3998fc['objectType'],_0x3998fc[_0x346732(0x1da)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x346732(0x1e6)]:_0x4d4d35});}async['disableSync'](_0x707205){const _0x52d6fb=a243_0x118a76;await this[_0x52d6fb(0x1c2)]['patchObject'](constants_1[_0x52d6fb(0x188)]+_0x52d6fb(0x190),_0x707205,{[constants_1[_0x52d6fb(0x188)]+_0x52d6fb(0x1d6)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a243_0x118a76(0x1e2),[salesforce_query_service_1[a243_0x118a76(0x194)],salesforce_service_1[a243_0x118a76(0x18b)]])],SalesforceSyncService),exports[a243_0x118a76(0x1ba)]=SalesforceSyncService;