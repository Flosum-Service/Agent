function a191_0x3117(){const _0x42fae9=['salesforceService','getBranchComponents','Name','text/plain','getBranchRecord','SalesforceSyncService','design:paramtypes','GET_WAITING_BRANCHES_QUERY','getRemoteStateAttachmentId','push','SalesforceNotFoundError','__decorate','GET_REPOSITORY_BY_NAME_QUERY','salesforceQuery','SalesforceService','../dto/flosum-repository-sync.dto','map','396BIZVrg','2810200ExLOmK','410DBRfFM','updateRemoteState','SYNC_ATTACHMENT_FOR_BRANCH_NAME','GET_BRANCH_QUERY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','catch','constructor','Sync_In_Progress__c','query','function','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','metadata','669753lnoTKD','search','Components__r','\x20not\x20found\x20on\x20salesforce','Repository\x20','13068384inlRjK','GET_COMPONENTS_QUERY','Attachment','FLOSUM_GIT_NAMESPACE','getBranchRecordByName','../../../shared/utils','setStatus','(((.+)+)+)+$','22472428kzUURo','../../../../constants/errors','fromRepositoryRecord','getComponentsFromRepository','Service','toString','FlosumRepositorySyncDto','getOwnPropertyDescriptor','%id%','patchObject','220317mwheuS','../../../../constants','Branch\x20with\x20Id\x20','getComponents','__esModule','12kSUlbp','decorate','%parentId%','../errors/not-found.error','stringify','./salesforce.service','encodeBase64','Repository__r','createObject','getAttachmentId','Synchronization_Status__c','typedi','defineProperty','329070GQrIFG','object','SalesforceQueryService','Connection__c','Branch\x20','replace','apply','find','fromBranchRecord','GET_BRANCH_BY_NAME_QUERY','getRepositoryRecords','length','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','7723cUrwFn','repositoryId','%name%','90UiqVEI','objectId','ERR_INVALID_ATTACHMENT_ID'];a191_0x3117=function(){return _0x42fae9;};return a191_0x3117();}const a191_0x4a8cac=a191_0x22fd;function a191_0x22fd(_0x472629,_0x2184e4){const _0x28c5f2=a191_0x3117();return a191_0x22fd=function(_0x2fd1ec,_0x4d38b6){_0x2fd1ec=_0x2fd1ec-0x1b5;let _0x3117af=_0x28c5f2[_0x2fd1ec];return _0x3117af;},a191_0x22fd(_0x472629,_0x2184e4);}(function(_0x2d4811,_0x4307a2){const _0x20e10b=a191_0x22fd,_0x391a8f=_0x2d4811();while(!![]){try{const _0x3e26c4=parseInt(_0x20e10b(0x1bc))/0x1*(parseInt(_0x20e10b(0x1d5))/0x2)+parseInt(_0x20e10b(0x1f8))/0x3*(parseInt(_0x20e10b(0x1fd))/0x4)+-parseInt(_0x20e10b(0x1d4))/0x5+parseInt(_0x20e10b(0x1bf))/0x6*(parseInt(_0x20e10b(0x1e1))/0x7)+parseInt(_0x20e10b(0x1e6))/0x8+-parseInt(_0x20e10b(0x1d3))/0x9*(parseInt(_0x20e10b(0x20a))/0xa)+-parseInt(_0x20e10b(0x1ee))/0xb;if(_0x3e26c4===_0x4307a2)break;else _0x391a8f['push'](_0x391a8f['shift']());}catch(_0x3846a2){_0x391a8f['push'](_0x391a8f['shift']());}}}(a191_0x3117,0xc80a9));const a191_0x4d38b6=(function(){let _0x2bcc99=!![];return function(_0x453db2,_0x86fd72){const _0x303c71=_0x2bcc99?function(){const _0x1d9aae=a191_0x22fd;if(_0x86fd72){const _0x412064=_0x86fd72[_0x1d9aae(0x1b5)](_0x453db2,arguments);return _0x86fd72=null,_0x412064;}}:function(){};return _0x2bcc99=![],_0x303c71;};}()),a191_0x2fd1ec=a191_0x4d38b6(this,function(){const _0xc8dce9=a191_0x22fd;return a191_0x2fd1ec[_0xc8dce9(0x1f3)]()[_0xc8dce9(0x1e2)]('(((.+)+)+)+$')[_0xc8dce9(0x1f3)]()[_0xc8dce9(0x1db)](a191_0x2fd1ec)[_0xc8dce9(0x1e2)](_0xc8dce9(0x1ed));});a191_0x2fd1ec();'use strict';var __decorate=this&&this[a191_0x4a8cac(0x1cd)]||function(_0x83ec39,_0x52c707,_0x4f2445,_0x2bd8ae){const _0x32610a=a191_0x4a8cac;var _0x1afb4f=arguments[_0x32610a(0x1ba)],_0xc62e1a=_0x1afb4f<0x3?_0x52c707:_0x2bd8ae===null?_0x2bd8ae=Object[_0x32610a(0x1f5)](_0x52c707,_0x4f2445):_0x2bd8ae,_0x394421;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0xc62e1a=Reflect[_0x32610a(0x1fe)](_0x83ec39,_0x52c707,_0x4f2445,_0x2bd8ae);else{for(var _0x4c6388=_0x83ec39['length']-0x1;_0x4c6388>=0x0;_0x4c6388--)if(_0x394421=_0x83ec39[_0x4c6388])_0xc62e1a=(_0x1afb4f<0x3?_0x394421(_0xc62e1a):_0x1afb4f>0x3?_0x394421(_0x52c707,_0x4f2445,_0xc62e1a):_0x394421(_0x52c707,_0x4f2445))||_0xc62e1a;}return _0x1afb4f>0x3&&_0xc62e1a&&Object[_0x32610a(0x209)](_0x52c707,_0x4f2445,_0xc62e1a),_0xc62e1a;},__metadata=this&&this['__metadata']||function(_0x303d6a,_0x3dae87){const _0x2e12c1=a191_0x4a8cac;if(typeof Reflect===_0x2e12c1(0x20b)&&typeof Reflect['metadata']===_0x2e12c1(0x1de))return Reflect[_0x2e12c1(0x1e0)](_0x303d6a,_0x3dae87);};Object[a191_0x4a8cac(0x209)](exports,a191_0x4a8cac(0x1fc),{'value':!![]}),exports[a191_0x4a8cac(0x1c7)]=void 0x0;const typedi_1=require(a191_0x4a8cac(0x208)),constants_1=require(a191_0x4a8cac(0x1f9)),errors_1=require(a191_0x4a8cac(0x1ef)),utils_1=require(a191_0x4a8cac(0x1eb)),flosum_repository_sync_dto_1=require(a191_0x4a8cac(0x1d1)),not_found_error_1=require(a191_0x4a8cac(0x200)),queries_1=require('../queries'),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a191_0x4a8cac(0x202));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x3f8926,_0x432ecd){this['salesforceQuery']=_0x3f8926,this['salesforceService']=_0x432ecd;}async[a191_0x4a8cac(0x1fb)](_0x647c69){const _0x3c418d=a191_0x4a8cac;var _0xcbc2e;const _0x38546b=await this['salesforceQuery'][_0x3c418d(0x1dd)](_0x647c69),_0x3bc460=[];for(const _0x4f4dfd of _0x38546b){const _0x1f682d=(_0xcbc2e=_0x4f4dfd[constants_1['FLOSUM_NAMESPACE']+_0x3c418d(0x1e3)])===null||_0xcbc2e===void 0x0?void 0x0:_0xcbc2e['records'];_0x1f682d&&_0x1f682d[_0x3c418d(0x1ba)]&&_0x3bc460[_0x3c418d(0x1cb)](_0x1f682d[0x0]['Id']);}return _0x3bc460;}async['getAllRepositoryNames'](_0x3fe5fc){const _0x2fec54=a191_0x4a8cac,_0x4cb14a=await this['salesforceQuery'][_0x2fec54(0x1dd)](queries_1['GET_REPOSITORIES_NAMES_QUERY']['replace'](/\%connection_id\%/g,_0x3fe5fc));return _0x4cb14a[_0x2fec54(0x1d2)](_0x5a6ad1=>{const _0x1e1e77=_0x2fec54;return _0x5a6ad1[constants_1['FLOSUM_GIT_NAMESPACE']+_0x1e1e77(0x204)]?_0x5a6ad1[constants_1[_0x1e1e77(0x1e9)]+'Repository__r']['Name']:_0x5a6ad1[_0x1e1e77(0x1c4)];});}async[a191_0x4a8cac(0x1b9)](_0x1ee0b4){const _0x15ef46=a191_0x4a8cac,_0x5b77d3=await this[_0x15ef46(0x1cf)][_0x15ef46(0x1dd)](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x15ef46(0x20f)](/\%connection_id\%/g,_0x1ee0b4));return _0x5b77d3[_0x15ef46(0x1d2)](_0x2eb581=>flosum_repository_sync_dto_1[_0x15ef46(0x1f4)]['fromRepositoryRecord'](_0x2eb581));}async['getBranchRecords'](_0x217aab){const _0x216cea=a191_0x4a8cac,_0x5590fe=await this[_0x216cea(0x1cf)][_0x216cea(0x1dd)](queries_1[_0x216cea(0x1c9)][_0x216cea(0x20f)](/%repositories_ids\%/g,_0x217aab));return _0x5590fe[_0x216cea(0x1d2)](_0x149e0f=>flosum_repository_sync_dto_1[_0x216cea(0x1f4)][_0x216cea(0x1b7)](_0x149e0f));}async['getRepositoryRecord'](_0x1fb2a4){const _0x473287=a191_0x4a8cac,_0x158cb7=await this[_0x473287(0x1cf)][_0x473287(0x1dd)](queries_1['GET_REPOSITORY_QUERY'][_0x473287(0x20f)](_0x473287(0x1f6),_0x1fb2a4));if(_0x158cb7[_0x473287(0x1ba)]===0x0)throw new not_found_error_1[(_0x473287(0x1cc))]('Repository\x20with\x20Id\x20'+_0x1fb2a4+_0x473287(0x1e4));return flosum_repository_sync_dto_1[_0x473287(0x1f4)][_0x473287(0x1f0)](_0x158cb7[0x0]);}async[a191_0x4a8cac(0x1c6)](_0x5e5a73){const _0x420656=a191_0x4a8cac,_0x36612f=await this['salesforceQuery'][_0x420656(0x1dd)](queries_1[_0x420656(0x1d8)][_0x420656(0x20f)]('%id%',_0x5e5a73));if(_0x36612f[_0x420656(0x1ba)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x420656(0x1fa)+_0x5e5a73+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x420656(0x1b7)](_0x36612f[0x0]);}async[a191_0x4a8cac(0x1ea)](_0x27e31a){const _0x5696bc=a191_0x4a8cac,_0x29fdd6=await this['salesforceQuery'][_0x5696bc(0x1dd)](queries_1[_0x5696bc(0x1b8)][_0x5696bc(0x20f)]('%name%',_0x27e31a));if(_0x29fdd6['length']===0x0)throw new not_found_error_1[(_0x5696bc(0x1cc))](_0x5696bc(0x20e)+_0x27e31a+'\x20not\x20found\x20on\x20salesforce');const _0x28c748=_0x29fdd6[_0x5696bc(0x1b6)](_0x5954fd=>_0x5954fd[constants_1['FLOSUM_NAMESPACE']+'Branch_Name__c']===_0x27e31a);if(!_0x28c748)throw new not_found_error_1[(_0x5696bc(0x1cc))](_0x5696bc(0x20e)+_0x27e31a+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x5696bc(0x1f4)][_0x5696bc(0x1b7)](_0x28c748);}async['getRepositoryRecordByName'](_0x3a70dd){const _0x12152b=a191_0x4a8cac,_0x5208f0=await this['salesforceQuery'][_0x12152b(0x1dd)](queries_1[_0x12152b(0x1ce)][_0x12152b(0x20f)]('%name%',_0x3a70dd));if(_0x5208f0['length']===0x0)throw new not_found_error_1[(_0x12152b(0x1cc))](_0x12152b(0x1e5)+_0x3a70dd+_0x12152b(0x1e4));return flosum_repository_sync_dto_1[_0x12152b(0x1f4)][_0x12152b(0x1f0)](_0x5208f0[0x0]);}async[a191_0x4a8cac(0x1f1)](_0x5455b1){const _0x1795d8=a191_0x4a8cac,_0x224415='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x1795d8(0x1e7)]+_0x1795d8(0x1bb)+_0x5455b1+'\x27';return this[_0x1795d8(0x1fb)](_0x224415);}async[a191_0x4a8cac(0x1c3)](_0xf7822b){const _0x1791b8=a191_0x4a8cac,_0x32f3da='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x1791b8(0x1e7)]+_0x1791b8(0x1d9)+_0xf7822b+'\x27';return this[_0x1791b8(0x1fb)](_0x32f3da);}async['getAttachmentId'](_0x667b09){const _0x195751=a191_0x4a8cac;var _0x4d45b4;const _0x42d781=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x195751(0x20f)](_0x195751(0x1ff),_0x667b09[_0x195751(0x1c0)])[_0x195751(0x20f)](_0x195751(0x1be),_0x667b09[_0x195751(0x1bd)]?constants_1[_0x195751(0x1df)]:constants_1[_0x195751(0x1d7)]),_0x428972=await this['salesforceQuery']['query'](_0x42d781),_0x37d485=(_0x4d45b4=_0x428972[0x0])===null||_0x4d45b4===void 0x0?void 0x0:_0x4d45b4['Id'];if(!_0x37d485)throw new Error(errors_1[_0x195751(0x1c1)]);return _0x37d485;}async['getRemoteStateAttachmentId'](_0x30461e){const _0x3ace5a=a191_0x4a8cac;let _0x32c89c=await this[_0x3ace5a(0x206)](_0x30461e)[_0x3ace5a(0x1da)](()=>null);return!_0x32c89c&&(_0x32c89c=await this[_0x3ace5a(0x1c2)][_0x3ace5a(0x205)](_0x3ace5a(0x1e8),{'Body':utils_1['encodeBase64']('{}'),'ParentId':_0x30461e[_0x3ace5a(0x1c0)],'ContentType':_0x3ace5a(0x1c5),'Name':_0x30461e['repositoryId']?constants_1[_0x3ace5a(0x1df)]:constants_1[_0x3ace5a(0x1d7)]})),_0x32c89c;}async[a191_0x4a8cac(0x1d6)](_0x34a372,_0x3edbbd){const _0x53bf22=a191_0x4a8cac,_0x323741=await this[_0x53bf22(0x1ca)](_0x34a372);await this['salesforceService'][_0x53bf22(0x1f7)](_0x53bf22(0x1e8),_0x323741,{'Body':utils_1[_0x53bf22(0x203)](JSON[_0x53bf22(0x201)](_0x3edbbd))});}async[a191_0x4a8cac(0x1ec)](_0xd2382,_0x463366){const _0x56b578=a191_0x4a8cac;await this[_0x56b578(0x1c2)][_0x56b578(0x1f7)](_0xd2382['objectType'],_0xd2382[_0x56b578(0x1c0)],{[constants_1[_0x56b578(0x1e9)]+_0x56b578(0x207)]:_0x463366});}async['disableSync'](_0x32dccb){const _0x80d4c0=a191_0x4a8cac;await this[_0x80d4c0(0x1c2)][_0x80d4c0(0x1f7)](constants_1[_0x80d4c0(0x1e9)]+_0x80d4c0(0x20d),_0x32dccb,{[constants_1[_0x80d4c0(0x1e9)]+_0x80d4c0(0x1dc)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a191_0x4a8cac(0x1f2)](),__metadata(a191_0x4a8cac(0x1c8),[salesforce_query_service_1[a191_0x4a8cac(0x20c)],salesforce_service_1[a191_0x4a8cac(0x1d0)]])],SalesforceSyncService),exports[a191_0x4a8cac(0x1c7)]=SalesforceSyncService;