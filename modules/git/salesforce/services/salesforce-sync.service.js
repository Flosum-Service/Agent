function a280_0x4d82(){const _0x4e73fb=['find','../../../../constants/errors','getBranchRecordByName','__esModule','%id%','GET_REPOSITORY_BY_NAME_QUERY','41940gLDiiE','decorate','GET_REPOSITORY_QUERY','getRepositoryRecordByName','metadata','8087154rjLDeb','replace','1399195aaRKeY','Service','patchObject','%name%','Connection__c','toString','SalesforceNotFoundError','Attachment','setStatus','query','GET_BRANCH_BY_NAME_QUERY','fromRepositoryRecord','push','FLOSUM_GIT_NAMESPACE','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','object','objectId','1604730PbCOJH','2145213ofjYke','getRemoteStateAttachmentId','SalesforceQueryService','(((.+)+)+)+$','\x20not\x20found\x20on\x20salesforce','Components__r','FLOSUM_NAMESPACE','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','typedi','GET_COMPONENTS_QUERY','8523184LyJnXW','10041hSClAW','\x0a\x20\x20\x20\x20\x20\x20','SalesforceSyncService','encodeBase64','catch','GET_WAITING_BRANCHES_QUERY','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','getBranchRecord','salesforceService','getComponentsFromRepository','function','map','defineProperty','getAllRepositoryNames','salesforceQuery','Repository\x20with\x20Id\x20','Name','Repository__r','__metadata','fromBranchRecord','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','8fzxjfD','../dto/flosum-repository-sync.dto','createObject','SYNC_ATTACHMENT_FOR_BRANCH_NAME','2xQiiKA','apply','records','length','getComponents','repositoryId','ERR_INVALID_ATTACHMENT_ID','FlosumRepositorySyncDto','Repository\x20','./salesforce-query.service','../../../shared/utils','../errors/not-found.error','Branch\x20with\x20Id\x20','getOwnPropertyDescriptor','updateRemoteState','4113MYplWY'];a280_0x4d82=function(){return _0x4e73fb;};return a280_0x4d82();}const a280_0x242de4=a280_0x43ba;(function(_0x95917a,_0x46e9b9){const _0x5ebf3c=a280_0x43ba,_0x1b7061=_0x95917a();while(!![]){try{const _0x32ae57=parseInt(_0x5ebf3c(0x21d))/0x1*(-parseInt(_0x5ebf3c(0x200))/0x2)+-parseInt(_0x5ebf3c(0x1e7))/0x3*(-parseInt(_0x5ebf3c(0x1fc))/0x4)+parseInt(_0x5ebf3c(0x22e))/0x5+parseInt(_0x5ebf3c(0x21b))/0x6+-parseInt(_0x5ebf3c(0x22f))/0x7+-parseInt(_0x5ebf3c(0x1e6))/0x8+-parseInt(_0x5ebf3c(0x20f))/0x9*(-parseInt(_0x5ebf3c(0x216))/0xa);if(_0x32ae57===_0x46e9b9)break;else _0x1b7061['push'](_0x1b7061['shift']());}catch(_0x5b239c){_0x1b7061['push'](_0x1b7061['shift']());}}}(a280_0x4d82,0xc8771));const a280_0x3a933d=(function(){let _0xcf03b0=!![];return function(_0x461768,_0x1dbced){const _0x2d9684=_0xcf03b0?function(){const _0x7eed1b=a280_0x43ba;if(_0x1dbced){const _0x3a556d=_0x1dbced[_0x7eed1b(0x201)](_0x461768,arguments);return _0x1dbced=null,_0x3a556d;}}:function(){};return _0xcf03b0=![],_0x2d9684;};}()),a280_0x2de6a4=a280_0x3a933d(this,function(){const _0x4748e8=a280_0x43ba;return a280_0x2de6a4[_0x4748e8(0x222)]()['search'](_0x4748e8(0x232))[_0x4748e8(0x222)]()['constructor'](a280_0x2de6a4)['search'](_0x4748e8(0x232));});a280_0x2de6a4();'use strict';var __decorate=this&&this['__decorate']||function(_0x460f75,_0x5cfd93,_0x7659bb,_0x391148){const _0x5c5b32=a280_0x43ba;var _0x1cde2=arguments['length'],_0x418a01=_0x1cde2<0x3?_0x5cfd93:_0x391148===null?_0x391148=Object[_0x5c5b32(0x20d)](_0x5cfd93,_0x7659bb):_0x391148,_0x105e5a;if(typeof Reflect===_0x5c5b32(0x22c)&&typeof Reflect[_0x5c5b32(0x217)]===_0x5c5b32(0x1f1))_0x418a01=Reflect['decorate'](_0x460f75,_0x5cfd93,_0x7659bb,_0x391148);else{for(var _0x79deef=_0x460f75['length']-0x1;_0x79deef>=0x0;_0x79deef--)if(_0x105e5a=_0x460f75[_0x79deef])_0x418a01=(_0x1cde2<0x3?_0x105e5a(_0x418a01):_0x1cde2>0x3?_0x105e5a(_0x5cfd93,_0x7659bb,_0x418a01):_0x105e5a(_0x5cfd93,_0x7659bb))||_0x418a01;}return _0x1cde2>0x3&&_0x418a01&&Object[_0x5c5b32(0x1f3)](_0x5cfd93,_0x7659bb,_0x418a01),_0x418a01;},__metadata=this&&this[a280_0x242de4(0x1f9)]||function(_0x3a3fa1,_0x196488){const _0x2e3071=a280_0x242de4;if(typeof Reflect===_0x2e3071(0x22c)&&typeof Reflect[_0x2e3071(0x21a)]===_0x2e3071(0x1f1))return Reflect[_0x2e3071(0x21a)](_0x3a3fa1,_0x196488);};Object[a280_0x242de4(0x1f3)](exports,a280_0x242de4(0x213),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a280_0x242de4(0x1e4)),constants_1=require('../../../../constants'),errors_1=require(a280_0x242de4(0x211)),utils_1=require(a280_0x242de4(0x20a)),flosum_repository_sync_dto_1=require(a280_0x242de4(0x1fd)),not_found_error_1=require(a280_0x242de4(0x20b)),queries_1=require('../queries'),salesforce_query_service_1=require(a280_0x242de4(0x209)),salesforce_service_1=require('./salesforce.service');function a280_0x43ba(_0xf92cae,_0x3b1fba){const _0xde769=a280_0x4d82();return a280_0x43ba=function(_0x2de6a4,_0x3a933d){_0x2de6a4=_0x2de6a4-0x1e3;let _0x4d82dd=_0xde769[_0x2de6a4];return _0x4d82dd;},a280_0x43ba(_0xf92cae,_0x3b1fba);}let SalesforceSyncService=class SalesforceSyncService{constructor(_0x136b5d,_0x34b517){const _0x231b2f=a280_0x242de4;this['salesforceQuery']=_0x136b5d,this[_0x231b2f(0x1ef)]=_0x34b517;}async[a280_0x242de4(0x204)](_0x5e2d3){const _0x5e6bcb=a280_0x242de4;var _0x500e2e;const _0x1886d6=await this[_0x5e6bcb(0x1f5)][_0x5e6bcb(0x226)](_0x5e2d3),_0x347d49=[];for(const _0x5bc771 of _0x1886d6){const _0x3c5aac=(_0x500e2e=_0x5bc771[constants_1[_0x5e6bcb(0x235)]+_0x5e6bcb(0x234)])===null||_0x500e2e===void 0x0?void 0x0:_0x500e2e[_0x5e6bcb(0x202)];_0x3c5aac&&_0x3c5aac['length']&&_0x347d49[_0x5e6bcb(0x229)](_0x3c5aac[0x0]['Id']);}return _0x347d49;}async[a280_0x242de4(0x1f4)](_0x2e9c94){const _0x55a4af=a280_0x242de4,_0x5c0b8f=await this['salesforceQuery']['query'](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x55a4af(0x21c)](/\%connection_id\%/g,_0x2e9c94));return _0x5c0b8f['map'](_0x104c9c=>{const _0x114a81=_0x55a4af;return _0x104c9c[constants_1[_0x114a81(0x22a)]+_0x114a81(0x1f8)]?_0x104c9c[constants_1[_0x114a81(0x22a)]+'Repository__r']['Name']:_0x104c9c[_0x114a81(0x1f7)];});}async['getRepositoryRecords'](_0x2f103e){const _0x245b5e=a280_0x242de4,_0x51f887=await this[_0x245b5e(0x1f5)][_0x245b5e(0x226)](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x245b5e(0x21c)](/\%connection_id\%/g,_0x2f103e));return _0x51f887[_0x245b5e(0x1f2)](_0x495485=>flosum_repository_sync_dto_1[_0x245b5e(0x207)][_0x245b5e(0x228)](_0x495485));}async['getBranchRecords'](_0x2c5b03){const _0x3fcb88=a280_0x242de4,_0x2b1825=await this[_0x3fcb88(0x1f5)]['query'](queries_1[_0x3fcb88(0x1ec)][_0x3fcb88(0x21c)](/%repositories_ids\%/g,_0x2c5b03));return _0x2b1825[_0x3fcb88(0x1f2)](_0x36311b=>flosum_repository_sync_dto_1[_0x3fcb88(0x207)][_0x3fcb88(0x1fa)](_0x36311b));}async['getRepositoryRecord'](_0xd7d2f9){const _0xf34e74=a280_0x242de4,_0x263d7d=await this[_0xf34e74(0x1f5)][_0xf34e74(0x226)](queries_1[_0xf34e74(0x218)][_0xf34e74(0x21c)](_0xf34e74(0x214),_0xd7d2f9));if(_0x263d7d[_0xf34e74(0x203)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0xf34e74(0x1f6)+_0xd7d2f9+_0xf34e74(0x233));return flosum_repository_sync_dto_1[_0xf34e74(0x207)][_0xf34e74(0x228)](_0x263d7d[0x0]);}async[a280_0x242de4(0x1ee)](_0x47f595){const _0x5740c1=a280_0x242de4,_0x3126ec=await this[_0x5740c1(0x1f5)][_0x5740c1(0x226)](queries_1['GET_BRANCH_QUERY'][_0x5740c1(0x21c)]('%id%',_0x47f595));if(_0x3126ec[_0x5740c1(0x203)]===0x0)throw new not_found_error_1[(_0x5740c1(0x223))](_0x5740c1(0x20c)+_0x47f595+_0x5740c1(0x233));return flosum_repository_sync_dto_1[_0x5740c1(0x207)]['fromBranchRecord'](_0x3126ec[0x0]);}async[a280_0x242de4(0x212)](_0x12f844){const _0x248573=a280_0x242de4,_0x55e29e=await this[_0x248573(0x1f5)][_0x248573(0x226)](queries_1[_0x248573(0x227)][_0x248573(0x21c)](_0x248573(0x220),_0x12f844));if(_0x55e29e[_0x248573(0x203)]===0x0)throw new not_found_error_1[(_0x248573(0x223))]('Branch\x20'+_0x12f844+'\x20not\x20found\x20on\x20salesforce');const _0x4d683b=_0x55e29e[_0x248573(0x210)](_0x256a8a=>_0x256a8a[constants_1['FLOSUM_NAMESPACE']+'Branch_Name__c']===_0x12f844);if(!_0x4d683b)throw new not_found_error_1[(_0x248573(0x223))]('Branch\x20'+_0x12f844+_0x248573(0x233));return flosum_repository_sync_dto_1[_0x248573(0x207)][_0x248573(0x1fa)](_0x4d683b);}async[a280_0x242de4(0x219)](_0x5bdb8d){const _0x3be262=a280_0x242de4,_0x405099=await this[_0x3be262(0x1f5)][_0x3be262(0x226)](queries_1[_0x3be262(0x215)][_0x3be262(0x21c)]('%name%',_0x5bdb8d));if(_0x405099['length']===0x0)throw new not_found_error_1[(_0x3be262(0x223))](_0x3be262(0x208)+_0x5bdb8d+_0x3be262(0x233));return flosum_repository_sync_dto_1[_0x3be262(0x207)][_0x3be262(0x228)](_0x405099[0x0]);}async[a280_0x242de4(0x1f0)](_0x34f376){const _0x334738=a280_0x242de4,_0x467e22=_0x334738(0x1e8)+queries_1['GET_COMPONENTS_QUERY']+_0x334738(0x1e3)+_0x34f376+'\x27';return this[_0x334738(0x204)](_0x467e22);}async['getBranchComponents'](_0x25f0c0){const _0x36f2b8=a280_0x242de4,_0x4d304b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x36f2b8(0x1e5)]+_0x36f2b8(0x1fb)+_0x25f0c0+'\x27';return this[_0x36f2b8(0x204)](_0x4d304b);}async['getAttachmentId'](_0x376d5c){const _0x42eefd=a280_0x242de4;var _0x4bf334;const _0x5ee6c4=queries_1[_0x42eefd(0x1ed)][_0x42eefd(0x21c)]('%parentId%',_0x376d5c[_0x42eefd(0x22d)])['replace']('%name%',_0x376d5c[_0x42eefd(0x205)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x42eefd(0x1ff)]),_0x3409e1=await this[_0x42eefd(0x1f5)]['query'](_0x5ee6c4),_0x1405ce=(_0x4bf334=_0x3409e1[0x0])===null||_0x4bf334===void 0x0?void 0x0:_0x4bf334['Id'];if(!_0x1405ce)throw new Error(errors_1[_0x42eefd(0x206)]);return _0x1405ce;}async[a280_0x242de4(0x230)](_0x458143){const _0x109a41=a280_0x242de4;let _0xa2065a=await this['getAttachmentId'](_0x458143)[_0x109a41(0x1eb)](()=>null);return!_0xa2065a&&(_0xa2065a=await this[_0x109a41(0x1ef)][_0x109a41(0x1fe)](_0x109a41(0x224),{'Body':(0x0,utils_1[_0x109a41(0x1ea)])('{}'),'ParentId':_0x458143['objectId'],'ContentType':'text/plain','Name':_0x458143[_0x109a41(0x205)]?constants_1[_0x109a41(0x22b)]:constants_1[_0x109a41(0x1ff)]})),_0xa2065a;}async[a280_0x242de4(0x20e)](_0xe69eb,_0x3269da){const _0x4fc663=a280_0x242de4,_0x1e226c=await this[_0x4fc663(0x230)](_0xe69eb);await this[_0x4fc663(0x1ef)][_0x4fc663(0x21f)](_0x4fc663(0x224),_0x1e226c,{'Body':(0x0,utils_1[_0x4fc663(0x1ea)])(JSON['stringify'](_0x3269da))});}async[a280_0x242de4(0x225)](_0x549215,_0x51a584){const _0x15f77f=a280_0x242de4;await this[_0x15f77f(0x1ef)][_0x15f77f(0x21f)](_0x549215['objectType'],_0x549215[_0x15f77f(0x22d)],{[constants_1['FLOSUM_GIT_NAMESPACE']+'Synchronization_Status__c']:_0x51a584});}async['disableSync'](_0x2048d8){const _0x151ad3=a280_0x242de4;await this[_0x151ad3(0x1ef)][_0x151ad3(0x21f)](constants_1[_0x151ad3(0x22a)]+_0x151ad3(0x221),_0x2048d8,{[constants_1[_0x151ad3(0x22a)]+'Sync_In_Progress__c']:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a280_0x242de4(0x21e)])(),__metadata('design:paramtypes',[salesforce_query_service_1[a280_0x242de4(0x231)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports[a280_0x242de4(0x1e9)]=SalesforceSyncService;