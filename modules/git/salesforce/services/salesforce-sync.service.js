const a243_0x23751c=a243_0xe956;(function(_0x3d8add,_0x115744){const _0x207f02=a243_0xe956,_0x439455=_0x3d8add();while(!![]){try{const _0x149bf7=-parseInt(_0x207f02(0x195))/0x1+-parseInt(_0x207f02(0x17a))/0x2*(-parseInt(_0x207f02(0x18a))/0x3)+-parseInt(_0x207f02(0x183))/0x4*(-parseInt(_0x207f02(0x188))/0x5)+-parseInt(_0x207f02(0x163))/0x6+-parseInt(_0x207f02(0x190))/0x7+-parseInt(_0x207f02(0x186))/0x8+parseInt(_0x207f02(0x191))/0x9;if(_0x149bf7===_0x115744)break;else _0x439455['push'](_0x439455['shift']());}catch(_0x318e4e){_0x439455['push'](_0x439455['shift']());}}}(a243_0x17b4,0x33c8f));const a243_0x25754f=(function(){let _0x497f0d=!![];return function(_0x48cf1f,_0x43415a){const _0x29a810=_0x497f0d?function(){const _0x3d23ae=a243_0xe956;if(_0x43415a){const _0x3b5305=_0x43415a[_0x3d23ae(0x176)](_0x48cf1f,arguments);return _0x43415a=null,_0x3b5305;}}:function(){};return _0x497f0d=![],_0x29a810;};}()),a243_0x1bcfdc=a243_0x25754f(this,function(){const _0x47fcee=a243_0xe956;return a243_0x1bcfdc[_0x47fcee(0x16f)]()[_0x47fcee(0x173)]('(((.+)+)+)+$')[_0x47fcee(0x16f)]()['constructor'](a243_0x1bcfdc)['search'](_0x47fcee(0x16b));});a243_0x1bcfdc();'use strict';var __decorate=this&&this[a243_0x23751c(0x159)]||function(_0x20c402,_0xb54738,_0x43ea04,_0x1ba8b5){const _0x3c5190=a243_0x23751c;var _0x283e09=arguments['length'],_0x26ae98=_0x283e09<0x3?_0xb54738:_0x1ba8b5===null?_0x1ba8b5=Object[_0x3c5190(0x18e)](_0xb54738,_0x43ea04):_0x1ba8b5,_0x12c5b7;if(typeof Reflect===_0x3c5190(0x17c)&&typeof Reflect['decorate']===_0x3c5190(0x169))_0x26ae98=Reflect[_0x3c5190(0x1a7)](_0x20c402,_0xb54738,_0x43ea04,_0x1ba8b5);else{for(var _0x5951f8=_0x20c402[_0x3c5190(0x156)]-0x1;_0x5951f8>=0x0;_0x5951f8--)if(_0x12c5b7=_0x20c402[_0x5951f8])_0x26ae98=(_0x283e09<0x3?_0x12c5b7(_0x26ae98):_0x283e09>0x3?_0x12c5b7(_0xb54738,_0x43ea04,_0x26ae98):_0x12c5b7(_0xb54738,_0x43ea04))||_0x26ae98;}return _0x283e09>0x3&&_0x26ae98&&Object['defineProperty'](_0xb54738,_0x43ea04,_0x26ae98),_0x26ae98;},__metadata=this&&this[a243_0x23751c(0x193)]||function(_0x3138b1,_0x33094f){const _0x4be143=a243_0x23751c;if(typeof Reflect===_0x4be143(0x17c)&&typeof Reflect[_0x4be143(0x18d)]===_0x4be143(0x169))return Reflect['metadata'](_0x3138b1,_0x33094f);};function a243_0x17b4(){const _0x5bfa55=['../errors/not-found.error','6YGroSx','FlosumRepositorySyncDto','object','typedi','SalesforceQueryService','SYNC_ATTACHMENT_FOR_BRANCH_NAME','Branch\x20with\x20Id\x20','../../../../constants','\x0a\x20\x20\x20\x20\x20\x20','779048ekOyuM','encodeBase64','getAttachmentId','2394712aLBsgv','Connection__c','10VfMuAE','./salesforce.service','287403NCUOiq','map','stringify','metadata','getOwnPropertyDescriptor','FLOSUM_NAMESPACE','74823MydgMP','1885914nsnMjM','Synchronization_Status__c','__metadata','Repository\x20','231829SPeIKu','createObject','GET_COMPONENTS_QUERY','Service','disableSync','../queries','Branch\x20','fromRepositoryRecord','Repository__r','../../../../constants/errors','text/plain','catch','salesforceService','getRepositoryRecord','replace','objectType','getAllRepositoryNames','salesforceQuery','decorate','repositoryId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Name','SalesforceNotFoundError','\x20not\x20found\x20on\x20salesforce','objectId','getBranchComponents','length','GET_REPOSITORY_BY_NAME_QUERY','getComponentsFromRepository','__decorate','fromBranchRecord','%name%','SalesforceService','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','query','Repository\x20with\x20Id\x20','ERR_INVALID_ATTACHMENT_ID','records','%id%','795030dBeCux','getRemoteStateAttachmentId','SalesforceSyncService','updateRemoteState','getBranchRecordByName','patchObject','function','Sync_In_Progress__c','(((.+)+)+)+$','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','GET_REPOSITORIES_NAMES_QUERY','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','toString','__esModule','../../../shared/utils','FLOSUM_GIT_NAMESPACE','search','getComponents','Attachment','apply','GET_REPOSITORY_QUERY','find'];a243_0x17b4=function(){return _0x5bfa55;};return a243_0x17b4();}function a243_0xe956(_0x5135e3,_0x2aa06a){const _0x562769=a243_0x17b4();return a243_0xe956=function(_0x1bcfdc,_0x25754f){_0x1bcfdc=_0x1bcfdc-0x153;let _0x17b453=_0x562769[_0x1bcfdc];return _0x17b453;},a243_0xe956(_0x5135e3,_0x2aa06a);}Object['defineProperty'](exports,a243_0x23751c(0x170),{'value':!![]}),exports[a243_0x23751c(0x165)]=void 0x0;const typedi_1=require(a243_0x23751c(0x17d)),constants_1=require(a243_0x23751c(0x181)),errors_1=require(a243_0x23751c(0x19e)),utils_1=require(a243_0x23751c(0x171)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a243_0x23751c(0x179)),queries_1=require(a243_0x23751c(0x19a)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a243_0x23751c(0x189));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x215a11,_0x12c65a){const _0xf15d17=a243_0x23751c;this[_0xf15d17(0x1a6)]=_0x215a11,this[_0xf15d17(0x1a1)]=_0x12c65a;}async[a243_0x23751c(0x174)](_0x515b58){const _0x3b02e4=a243_0x23751c;var _0x1ea97c;const _0x56eed7=await this[_0x3b02e4(0x1a6)][_0x3b02e4(0x15e)](_0x515b58),_0x33edcd=[];for(const _0x49f42f of _0x56eed7){const _0x31290b=(_0x1ea97c=_0x49f42f[constants_1[_0x3b02e4(0x18f)]+'Components__r'])===null||_0x1ea97c===void 0x0?void 0x0:_0x1ea97c[_0x3b02e4(0x161)];_0x31290b&&_0x31290b[_0x3b02e4(0x156)]&&_0x33edcd['push'](_0x31290b[0x0]['Id']);}return _0x33edcd;}async[a243_0x23751c(0x1a5)](_0x1aff63){const _0x21165a=a243_0x23751c,_0x8b0932=await this[_0x21165a(0x1a6)][_0x21165a(0x15e)](queries_1[_0x21165a(0x16d)]['replace'](/\%connection_id\%/g,_0x1aff63));return _0x8b0932[_0x21165a(0x18b)](_0x1f0704=>{const _0x2cb945=_0x21165a;return _0x1f0704[constants_1[_0x2cb945(0x172)]+'Repository__r']?_0x1f0704[constants_1[_0x2cb945(0x172)]+_0x2cb945(0x19d)][_0x2cb945(0x1aa)]:_0x1f0704[_0x2cb945(0x1aa)];});}async['getRepositoryRecords'](_0x1f1245){const _0x55772b=a243_0x23751c,_0x7d3692=await this['salesforceQuery'][_0x55772b(0x15e)](queries_1['GET_WAITING_REPOSITORIES_QUERY']['replace'](/\%connection_id\%/g,_0x1f1245));return _0x7d3692[_0x55772b(0x18b)](_0x4ffbfb=>flosum_repository_sync_dto_1[_0x55772b(0x17b)][_0x55772b(0x19c)](_0x4ffbfb));}async['getBranchRecords'](_0x3076d4){const _0x462465=a243_0x23751c,_0x393b34=await this[_0x462465(0x1a6)][_0x462465(0x15e)](queries_1['GET_WAITING_BRANCHES_QUERY']['replace'](/%repositories_ids\%/g,_0x3076d4));return _0x393b34[_0x462465(0x18b)](_0x4e6313=>flosum_repository_sync_dto_1[_0x462465(0x17b)][_0x462465(0x15a)](_0x4e6313));}async[a243_0x23751c(0x1a2)](_0x200260){const _0x218223=a243_0x23751c,_0x6ac75b=await this[_0x218223(0x1a6)][_0x218223(0x15e)](queries_1[_0x218223(0x177)][_0x218223(0x1a3)](_0x218223(0x162),_0x200260));if(_0x6ac75b[_0x218223(0x156)]===0x0)throw new not_found_error_1[(_0x218223(0x1ab))](_0x218223(0x15f)+_0x200260+_0x218223(0x153));return flosum_repository_sync_dto_1[_0x218223(0x17b)][_0x218223(0x19c)](_0x6ac75b[0x0]);}async['getBranchRecord'](_0x3a652f){const _0x3386ad=a243_0x23751c,_0x17474c=await this[_0x3386ad(0x1a6)][_0x3386ad(0x15e)](queries_1['GET_BRANCH_QUERY'][_0x3386ad(0x1a3)](_0x3386ad(0x162),_0x3a652f));if(_0x17474c[_0x3386ad(0x156)]===0x0)throw new not_found_error_1[(_0x3386ad(0x1ab))](_0x3386ad(0x180)+_0x3a652f+_0x3386ad(0x153));return flosum_repository_sync_dto_1[_0x3386ad(0x17b)][_0x3386ad(0x15a)](_0x17474c[0x0]);}async[a243_0x23751c(0x167)](_0x5016b1){const _0x16e9ee=a243_0x23751c,_0x211cdc=await this['salesforceQuery']['query'](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x16e9ee(0x1a3)](_0x16e9ee(0x15b),_0x5016b1));if(_0x211cdc[_0x16e9ee(0x156)]===0x0)throw new not_found_error_1[(_0x16e9ee(0x1ab))]('Branch\x20'+_0x5016b1+_0x16e9ee(0x153));const _0xc02b11=_0x211cdc[_0x16e9ee(0x178)](_0x153a88=>_0x153a88[constants_1[_0x16e9ee(0x18f)]+'Branch_Name__c']===_0x5016b1);if(!_0xc02b11)throw new not_found_error_1[(_0x16e9ee(0x1ab))](_0x16e9ee(0x19b)+_0x5016b1+_0x16e9ee(0x153));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x16e9ee(0x15a)](_0xc02b11);}async['getRepositoryRecordByName'](_0x597c35){const _0x2a6b6a=a243_0x23751c,_0x5b64fd=await this[_0x2a6b6a(0x1a6)][_0x2a6b6a(0x15e)](queries_1[_0x2a6b6a(0x157)][_0x2a6b6a(0x1a3)]('%name%',_0x597c35));if(_0x5b64fd['length']===0x0)throw new not_found_error_1[(_0x2a6b6a(0x1ab))](_0x2a6b6a(0x194)+_0x597c35+_0x2a6b6a(0x153));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x2a6b6a(0x19c)](_0x5b64fd[0x0]);}async[a243_0x23751c(0x158)](_0x4ed496){const _0x3fca88=a243_0x23751c,_0x1634f2=_0x3fca88(0x182)+queries_1['GET_COMPONENTS_QUERY']+_0x3fca88(0x16e)+_0x4ed496+'\x27';return this[_0x3fca88(0x174)](_0x1634f2);}async[a243_0x23751c(0x155)](_0x3f1f63){const _0x52f166=a243_0x23751c,_0x5bf132=_0x52f166(0x1a9)+queries_1[_0x52f166(0x197)]+_0x52f166(0x16c)+_0x3f1f63+'\x27';return this['getComponents'](_0x5bf132);}async['getAttachmentId'](_0x2ab69b){const _0x1f6396=a243_0x23751c;var _0x74924e;const _0x45d7d0=queries_1[_0x1f6396(0x15d)][_0x1f6396(0x1a3)]('%parentId%',_0x2ab69b['objectId'])[_0x1f6396(0x1a3)]('%name%',_0x2ab69b[_0x1f6396(0x1a8)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x1f6396(0x17f)]),_0x41f185=await this[_0x1f6396(0x1a6)][_0x1f6396(0x15e)](_0x45d7d0),_0x33175e=(_0x74924e=_0x41f185[0x0])===null||_0x74924e===void 0x0?void 0x0:_0x74924e['Id'];if(!_0x33175e)throw new Error(errors_1[_0x1f6396(0x160)]);return _0x33175e;}async[a243_0x23751c(0x164)](_0x556bf5){const _0x4d8b55=a243_0x23751c;let _0x492ef6=await this[_0x4d8b55(0x185)](_0x556bf5)[_0x4d8b55(0x1a0)](()=>null);return!_0x492ef6&&(_0x492ef6=await this[_0x4d8b55(0x1a1)][_0x4d8b55(0x196)]('Attachment',{'Body':(0x0,utils_1[_0x4d8b55(0x184)])('{}'),'ParentId':_0x556bf5[_0x4d8b55(0x154)],'ContentType':_0x4d8b55(0x19f),'Name':_0x556bf5[_0x4d8b55(0x1a8)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x4d8b55(0x17f)]})),_0x492ef6;}async[a243_0x23751c(0x166)](_0x247fe4,_0x11a8a5){const _0x2ec981=a243_0x23751c,_0x47da59=await this[_0x2ec981(0x164)](_0x247fe4);await this[_0x2ec981(0x1a1)][_0x2ec981(0x168)](_0x2ec981(0x175),_0x47da59,{'Body':(0x0,utils_1[_0x2ec981(0x184)])(JSON[_0x2ec981(0x18c)](_0x11a8a5))});}async['setStatus'](_0x2ebe97,_0x5b940e){const _0x188a9a=a243_0x23751c;await this['salesforceService'][_0x188a9a(0x168)](_0x2ebe97[_0x188a9a(0x1a4)],_0x2ebe97['objectId'],{[constants_1[_0x188a9a(0x172)]+_0x188a9a(0x192)]:_0x5b940e});}async[a243_0x23751c(0x199)](_0x3a8676){const _0x52f7d2=a243_0x23751c;await this[_0x52f7d2(0x1a1)][_0x52f7d2(0x168)](constants_1[_0x52f7d2(0x172)]+_0x52f7d2(0x187),_0x3a8676,{[constants_1[_0x52f7d2(0x172)]+_0x52f7d2(0x16a)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x23751c(0x198)])(),__metadata('design:paramtypes',[salesforce_query_service_1[a243_0x23751c(0x17e)],salesforce_service_1[a243_0x23751c(0x15c)]])],SalesforceSyncService),exports[a243_0x23751c(0x165)]=SalesforceSyncService;