const a243_0x40d42a=a243_0x1d13;(function(_0x265b9a,_0x34ef07){const _0x453f6b=a243_0x1d13,_0x55729b=_0x265b9a();while(!![]){try{const _0x4563e1=parseInt(_0x453f6b(0x9b))/0x1+-parseInt(_0x453f6b(0x75))/0x2*(-parseInt(_0x453f6b(0xaf))/0x3)+-parseInt(_0x453f6b(0xbf))/0x4*(-parseInt(_0x453f6b(0x7b))/0x5)+-parseInt(_0x453f6b(0xaa))/0x6*(-parseInt(_0x453f6b(0x9f))/0x7)+-parseInt(_0x453f6b(0x98))/0x8+parseInt(_0x453f6b(0x9c))/0x9+-parseInt(_0x453f6b(0xb4))/0xa*(parseInt(_0x453f6b(0x8d))/0xb);if(_0x4563e1===_0x34ef07)break;else _0x55729b['push'](_0x55729b['shift']());}catch(_0x4dd4d1){_0x55729b['push'](_0x55729b['shift']());}}}(a243_0x9643,0xa8d21));const a243_0x4b907a=(function(){let _0x1c8fc1=!![];return function(_0x5bb1cf,_0x5736fb){const _0x54a09d=_0x1c8fc1?function(){if(_0x5736fb){const _0x1960a0=_0x5736fb['apply'](_0x5bb1cf,arguments);return _0x5736fb=null,_0x1960a0;}}:function(){};return _0x1c8fc1=![],_0x54a09d;};}()),a243_0xb07637=a243_0x4b907a(this,function(){const _0x5a6062=a243_0x1d13;return a243_0xb07637[_0x5a6062(0x90)]()[_0x5a6062(0x85)](_0x5a6062(0x7d))[_0x5a6062(0x90)]()['constructor'](a243_0xb07637)[_0x5a6062(0x85)]('(((.+)+)+)+$');});a243_0xb07637();'use strict';var __decorate=this&&this['__decorate']||function(_0x1c2ec2,_0x439c37,_0x4093b8,_0x68ec54){const _0x5e6508=a243_0x1d13;var _0x11df84=arguments['length'],_0x536e1f=_0x11df84<0x3?_0x439c37:_0x68ec54===null?_0x68ec54=Object[_0x5e6508(0x92)](_0x439c37,_0x4093b8):_0x68ec54,_0xf1c73f;if(typeof Reflect===_0x5e6508(0xad)&&typeof Reflect[_0x5e6508(0x74)]===_0x5e6508(0xa1))_0x536e1f=Reflect[_0x5e6508(0x74)](_0x1c2ec2,_0x439c37,_0x4093b8,_0x68ec54);else{for(var _0x471a38=_0x1c2ec2['length']-0x1;_0x471a38>=0x0;_0x471a38--)if(_0xf1c73f=_0x1c2ec2[_0x471a38])_0x536e1f=(_0x11df84<0x3?_0xf1c73f(_0x536e1f):_0x11df84>0x3?_0xf1c73f(_0x439c37,_0x4093b8,_0x536e1f):_0xf1c73f(_0x439c37,_0x4093b8))||_0x536e1f;}return _0x11df84>0x3&&_0x536e1f&&Object['defineProperty'](_0x439c37,_0x4093b8,_0x536e1f),_0x536e1f;},__metadata=this&&this['__metadata']||function(_0xce6eba,_0x32d7b3){const _0x577c69=a243_0x1d13;if(typeof Reflect===_0x577c69(0xad)&&typeof Reflect[_0x577c69(0x87)]==='function')return Reflect['metadata'](_0xce6eba,_0x32d7b3);};Object['defineProperty'](exports,a243_0x40d42a(0x6f),{'value':!![]}),exports[a243_0x40d42a(0x78)]=void 0x0;function a243_0x1d13(_0x3b074a,_0x40a0d1){const _0x22a312=a243_0x9643();return a243_0x1d13=function(_0xb07637,_0x4b907a){_0xb07637=_0xb07637-0x6b;let _0x964313=_0x22a312[_0xb07637];return _0x964313;},a243_0x1d13(_0x3b074a,_0x40a0d1);}const typedi_1=require('typedi'),constants_1=require(a243_0x40d42a(0xbe)),errors_1=require('../../../../constants/errors'),utils_1=require('../../../shared/utils'),flosum_repository_sync_dto_1=require(a243_0x40d42a(0x77)),not_found_error_1=require(a243_0x40d42a(0xa5)),queries_1=require('../queries'),salesforce_query_service_1=require(a243_0x40d42a(0xbd)),salesforce_service_1=require(a243_0x40d42a(0x70));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x1b83be,_0x302f9c){const _0x304767=a243_0x40d42a;this[_0x304767(0x7a)]=_0x1b83be,this['salesforceService']=_0x302f9c;}async[a243_0x40d42a(0xc2)](_0x55116f){const _0x38987a=a243_0x40d42a;var _0x4e6d86;const _0x5caaf8=await this[_0x38987a(0x7a)][_0x38987a(0x9d)](_0x55116f),_0x3c3fa3=[];for(const _0x217e78 of _0x5caaf8){const _0x3904ac=(_0x4e6d86=_0x217e78[constants_1['FLOSUM_NAMESPACE']+_0x38987a(0x9e)])===null||_0x4e6d86===void 0x0?void 0x0:_0x4e6d86['records'];_0x3904ac&&_0x3904ac[_0x38987a(0xa6)]&&_0x3c3fa3['push'](_0x3904ac[0x0]['Id']);}return _0x3c3fa3;}async[a243_0x40d42a(0x88)](_0x1c3d79){const _0x1201c8=a243_0x40d42a,_0x5d5350=await this['salesforceQuery']['query'](queries_1[_0x1201c8(0xa8)]['replace'](/\%connection_id\%/g,_0x1c3d79));return _0x5d5350['map'](_0x177e1d=>{const _0x5b37f3=_0x1201c8;return _0x177e1d[constants_1[_0x5b37f3(0xae)]+_0x5b37f3(0x96)]?_0x177e1d[constants_1[_0x5b37f3(0xae)]+_0x5b37f3(0x96)][_0x5b37f3(0x91)]:_0x177e1d[_0x5b37f3(0x91)];});}async[a243_0x40d42a(0x86)](_0x48267d){const _0x25be05=a243_0x40d42a,_0x41594a=await this[_0x25be05(0x7a)][_0x25be05(0x9d)](queries_1[_0x25be05(0x84)]['replace'](/\%connection_id\%/g,_0x48267d));return _0x41594a[_0x25be05(0x97)](_0x545c57=>flosum_repository_sync_dto_1[_0x25be05(0x8a)][_0x25be05(0xc0)](_0x545c57));}async['getBranchRecords'](_0x26163e){const _0x17e3dd=a243_0x40d42a,_0x4435c6=await this[_0x17e3dd(0x7a)][_0x17e3dd(0x9d)](queries_1[_0x17e3dd(0x8f)][_0x17e3dd(0xa2)](/%repositories_ids\%/g,_0x26163e));return _0x4435c6[_0x17e3dd(0x97)](_0xb8d1c6=>flosum_repository_sync_dto_1[_0x17e3dd(0x8a)][_0x17e3dd(0xb6)](_0xb8d1c6));}async[a243_0x40d42a(0xa4)](_0x1df273){const _0x553e42=a243_0x40d42a,_0x5c8e70=await this[_0x553e42(0x7a)][_0x553e42(0x9d)](queries_1['GET_REPOSITORY_QUERY'][_0x553e42(0xa2)](_0x553e42(0x94),_0x1df273));if(_0x5c8e70[_0x553e42(0xa6)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x553e42(0x72)+_0x1df273+_0x553e42(0xba));return flosum_repository_sync_dto_1[_0x553e42(0x8a)]['fromRepositoryRecord'](_0x5c8e70[0x0]);}async[a243_0x40d42a(0xc1)](_0x32a87a){const _0xce4d86=a243_0x40d42a,_0x53f0ee=await this['salesforceQuery'][_0xce4d86(0x9d)](queries_1['GET_BRANCH_QUERY'][_0xce4d86(0xa2)](_0xce4d86(0x94),_0x32a87a));if(_0x53f0ee[_0xce4d86(0xa6)]===0x0)throw new not_found_error_1[(_0xce4d86(0x71))](_0xce4d86(0x73)+_0x32a87a+_0xce4d86(0xba));return flosum_repository_sync_dto_1[_0xce4d86(0x8a)][_0xce4d86(0xb6)](_0x53f0ee[0x0]);}async[a243_0x40d42a(0x6b)](_0x4b80a4){const _0x5a7058=a243_0x40d42a,_0x2d9128=await this[_0x5a7058(0x7a)][_0x5a7058(0x9d)](queries_1[_0x5a7058(0x80)][_0x5a7058(0xa2)](_0x5a7058(0x6c),_0x4b80a4));if(_0x2d9128[_0x5a7058(0xa6)]===0x0)throw new not_found_error_1[(_0x5a7058(0x71))](_0x5a7058(0x8c)+_0x4b80a4+_0x5a7058(0xba));const _0x5c4de9=_0x2d9128[_0x5a7058(0xa7)](_0x551bfc=>_0x551bfc[constants_1[_0x5a7058(0x6e)]+_0x5a7058(0xbb)]===_0x4b80a4);if(!_0x5c4de9)throw new not_found_error_1[(_0x5a7058(0x71))](_0x5a7058(0x8c)+_0x4b80a4+_0x5a7058(0xba));return flosum_repository_sync_dto_1[_0x5a7058(0x8a)][_0x5a7058(0xb6)](_0x5c4de9);}async[a243_0x40d42a(0x9a)](_0x1ca47e){const _0x3044d6=a243_0x40d42a,_0x309f8e=await this[_0x3044d6(0x7a)][_0x3044d6(0x9d)](queries_1[_0x3044d6(0x7f)]['replace'](_0x3044d6(0x6c),_0x1ca47e));if(_0x309f8e[_0x3044d6(0xa6)]===0x0)throw new not_found_error_1[(_0x3044d6(0x71))](_0x3044d6(0x95)+_0x1ca47e+_0x3044d6(0xba));return flosum_repository_sync_dto_1[_0x3044d6(0x8a)][_0x3044d6(0xc0)](_0x309f8e[0x0]);}async[a243_0x40d42a(0x7e)](_0x58986e){const _0x188543=a243_0x40d42a,_0x56438c=_0x188543(0xb5)+queries_1[_0x188543(0xb1)]+_0x188543(0xac)+_0x58986e+'\x27';return this['getComponents'](_0x56438c);}async[a243_0x40d42a(0xa0)](_0x4223d1){const _0x5c255e=a243_0x40d42a,_0x5f44fd=_0x5c255e(0xa3)+queries_1[_0x5c255e(0xb1)]+_0x5c255e(0xa9)+_0x4223d1+'\x27';return this[_0x5c255e(0xc2)](_0x5f44fd);}async[a243_0x40d42a(0x81)](_0x45a512){const _0x3ea2e0=a243_0x40d42a;var _0x8e7c62;const _0x48ef03=queries_1[_0x3ea2e0(0x8e)]['replace']('%parentId%',_0x45a512[_0x3ea2e0(0xb2)])[_0x3ea2e0(0xa2)](_0x3ea2e0(0x6c),_0x45a512['repositoryId']?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x1f0040=await this[_0x3ea2e0(0x7a)][_0x3ea2e0(0x9d)](_0x48ef03),_0x3e6666=(_0x8e7c62=_0x1f0040[0x0])===null||_0x8e7c62===void 0x0?void 0x0:_0x8e7c62['Id'];if(!_0x3e6666)throw new Error(errors_1[_0x3ea2e0(0x99)]);return _0x3e6666;}async['getRemoteStateAttachmentId'](_0x3f4e2d){const _0x3e3523=a243_0x40d42a;let _0x3f4509=await this[_0x3e3523(0x81)](_0x3f4e2d)['catch'](()=>null);return!_0x3f4509&&(_0x3f4509=await this['salesforceService'][_0x3e3523(0x83)](_0x3e3523(0x7c),{'Body':(0x0,utils_1[_0x3e3523(0x93)])('{}'),'ParentId':_0x3f4e2d[_0x3e3523(0xb2)],'ContentType':'text/plain','Name':_0x3f4e2d['repositoryId']?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x3f4509;}async[a243_0x40d42a(0xc3)](_0xcc75ed,_0x489c79){const _0x29f19e=a243_0x40d42a,_0x23dafd=await this['getRemoteStateAttachmentId'](_0xcc75ed);await this[_0x29f19e(0x82)][_0x29f19e(0xb0)](_0x29f19e(0x7c),_0x23dafd,{'Body':(0x0,utils_1[_0x29f19e(0x93)])(JSON[_0x29f19e(0xb9)](_0x489c79))});}async[a243_0x40d42a(0xab)](_0x1a85cb,_0x42a0cf){const _0x28ca35=a243_0x40d42a;await this[_0x28ca35(0x82)][_0x28ca35(0xb0)](_0x1a85cb[_0x28ca35(0x79)],_0x1a85cb[_0x28ca35(0xb2)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x28ca35(0xb8)]:_0x42a0cf});}async[a243_0x40d42a(0xb3)](_0x4b83d4){const _0x3c3b4c=a243_0x40d42a;await this['salesforceService'][_0x3c3b4c(0xb0)](constants_1[_0x3c3b4c(0xae)]+_0x3c3b4c(0xbc),_0x4b83d4,{[constants_1[_0x3c3b4c(0xae)]+_0x3c3b4c(0x76)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x40d42a(0x89)])(),__metadata(a243_0x40d42a(0x8b),[salesforce_query_service_1[a243_0x40d42a(0x6d)],salesforce_service_1[a243_0x40d42a(0xb7)]])],SalesforceSyncService),exports[a243_0x40d42a(0x78)]=SalesforceSyncService;function a243_0x9643(){const _0x2b192d=['\x20not\x20found\x20on\x20salesforce','Branch_Name__c','Connection__c','./salesforce-query.service','../../../../constants','32qkpUKZ','fromRepositoryRecord','getBranchRecord','getComponents','updateRemoteState','getBranchRecordByName','%name%','SalesforceQueryService','FLOSUM_NAMESPACE','__esModule','./salesforce.service','SalesforceNotFoundError','Repository\x20with\x20Id\x20','Branch\x20with\x20Id\x20','decorate','4KwXdxu','Sync_In_Progress__c','../dto/flosum-repository-sync.dto','SalesforceSyncService','objectType','salesforceQuery','11640KdKEKm','Attachment','(((.+)+)+)+$','getComponentsFromRepository','GET_REPOSITORY_BY_NAME_QUERY','GET_BRANCH_BY_NAME_QUERY','getAttachmentId','salesforceService','createObject','GET_WAITING_REPOSITORIES_QUERY','search','getRepositoryRecords','metadata','getAllRepositoryNames','Service','FlosumRepositorySyncDto','design:paramtypes','Branch\x20','3201BZXjDW','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','GET_WAITING_BRANCHES_QUERY','toString','Name','getOwnPropertyDescriptor','encodeBase64','%id%','Repository\x20','Repository__r','map','5060792nQIcUy','ERR_INVALID_ATTACHMENT_ID','getRepositoryRecordByName','972883UUvwMf','5891589zZXFuq','query','Components__r','8729511XfyBCM','getBranchComponents','function','replace','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getRepositoryRecord','../errors/not-found.error','length','find','GET_REPOSITORIES_NAMES_QUERY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','6DBlBnd','setStatus','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','object','FLOSUM_GIT_NAMESPACE','1939308gxuJGk','patchObject','GET_COMPONENTS_QUERY','objectId','disableSync','98350RLYriC','\x0a\x20\x20\x20\x20\x20\x20','fromBranchRecord','SalesforceService','Synchronization_Status__c','stringify'];a243_0x9643=function(){return _0x2b192d;};return a243_0x9643();}