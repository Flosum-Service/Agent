const a243_0x571469=a243_0x436e;function a243_0x436e(_0x4fa1c4,_0x51a2ec){const _0x5d259f=a243_0x25a9();return a243_0x436e=function(_0x4215ee,_0x479321){_0x4215ee=_0x4215ee-0xde;let _0x25a905=_0x5d259f[_0x4215ee];return _0x25a905;},a243_0x436e(_0x4fa1c4,_0x51a2ec);}(function(_0x16ddb1,_0xdf9834){const _0x416049=a243_0x436e,_0x46f957=_0x16ddb1();while(!![]){try{const _0x18dccc=parseInt(_0x416049(0x125))/0x1*(parseInt(_0x416049(0xe8))/0x2)+parseInt(_0x416049(0xe0))/0x3*(parseInt(_0x416049(0x121))/0x4)+parseInt(_0x416049(0x10e))/0x5*(-parseInt(_0x416049(0xf4))/0x6)+parseInt(_0x416049(0x127))/0x7+parseInt(_0x416049(0x109))/0x8*(-parseInt(_0x416049(0x108))/0x9)+parseInt(_0x416049(0x128))/0xa+-parseInt(_0x416049(0x102))/0xb;if(_0x18dccc===_0xdf9834)break;else _0x46f957['push'](_0x46f957['shift']());}catch(_0x59c3c5){_0x46f957['push'](_0x46f957['shift']());}}}(a243_0x25a9,0x6e86e));const a243_0x479321=(function(){let _0xc1ed33=!![];return function(_0x4c0e7b,_0x51a9d4){const _0x3dd836=_0xc1ed33?function(){if(_0x51a9d4){const _0x39c570=_0x51a9d4['apply'](_0x4c0e7b,arguments);return _0x51a9d4=null,_0x39c570;}}:function(){};return _0xc1ed33=![],_0x3dd836;};}()),a243_0x4215ee=a243_0x479321(this,function(){const _0x3092d5=a243_0x436e;return a243_0x4215ee[_0x3092d5(0x12c)]()['search'](_0x3092d5(0x12d))[_0x3092d5(0x12c)]()[_0x3092d5(0x124)](a243_0x4215ee)[_0x3092d5(0xed)](_0x3092d5(0x12d));});a243_0x4215ee();'use strict';var __decorate=this&&this[a243_0x571469(0xf3)]||function(_0x5d879b,_0x24a63e,_0x4e4f5c,_0x4d4333){const _0x2d2cf1=a243_0x571469;var _0x36c6d4=arguments[_0x2d2cf1(0xfc)],_0x3aec10=_0x36c6d4<0x3?_0x24a63e:_0x4d4333===null?_0x4d4333=Object['getOwnPropertyDescriptor'](_0x24a63e,_0x4e4f5c):_0x4d4333,_0x4bde6d;if(typeof Reflect==='object'&&typeof Reflect[_0x2d2cf1(0xe2)]==='function')_0x3aec10=Reflect[_0x2d2cf1(0xe2)](_0x5d879b,_0x24a63e,_0x4e4f5c,_0x4d4333);else{for(var _0x3b6e38=_0x5d879b[_0x2d2cf1(0xfc)]-0x1;_0x3b6e38>=0x0;_0x3b6e38--)if(_0x4bde6d=_0x5d879b[_0x3b6e38])_0x3aec10=(_0x36c6d4<0x3?_0x4bde6d(_0x3aec10):_0x36c6d4>0x3?_0x4bde6d(_0x24a63e,_0x4e4f5c,_0x3aec10):_0x4bde6d(_0x24a63e,_0x4e4f5c))||_0x3aec10;}return _0x36c6d4>0x3&&_0x3aec10&&Object[_0x2d2cf1(0x116)](_0x24a63e,_0x4e4f5c,_0x3aec10),_0x3aec10;},__metadata=this&&this[a243_0x571469(0xff)]||function(_0x2652cb,_0x22e7ea){const _0x39529a=a243_0x571469;if(typeof Reflect===_0x39529a(0x11f)&&typeof Reflect['metadata']===_0x39529a(0x136))return Reflect[_0x39529a(0x126)](_0x2652cb,_0x22e7ea);};function a243_0x25a9(){const _0x2c7f2a=['salesforceService','repositoryId','objectType','Repository\x20','Sync_In_Progress__c','length','fromRepositoryRecord','../../../../constants/errors','__metadata','Branch_Name__c','Service','13949628fgOtIs','ERR_INVALID_ATTACHMENT_ID','FLOSUM_GIT_NAMESPACE','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','../queries','salesforceQuery','63DoGlOC','889528fBieai','Connection__c','getAttachmentId','Branch\x20with\x20Id\x20','../errors/not-found.error','10BPdWHG','Branch\x20','objectId','push','SalesforceSyncService','./salesforce-query.service','SalesforceService','encodeBase64','defineProperty','Synchronization_Status__c','Components__r','catch','GET_COMPONENTS_QUERY','setStatus','design:paramtypes','getAllRepositoryNames','Repository\x20with\x20Id\x20','object','SalesforceNotFoundError','1067604qkngvX','getComponents','%name%','constructor','318790GWhntg','metadata','5383196WoleFS','7905450GzDprg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','FlosumRepositorySyncDto','\x0a\x20\x20\x20\x20\x20\x20','toString','(((.+)+)+)+$','GET_REPOSITORY_BY_NAME_QUERY','patchObject','fromBranchRecord','find','%id%','createObject','../../../../constants','getRemoteStateAttachmentId','function','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','%parentId%','getRepositoryRecords','__esModule','GET_BRANCH_BY_NAME_QUERY','Name','GET_WAITING_REPOSITORIES_QUERY','Repository__r','FLOSUM_NAMESPACE','\x20not\x20found\x20on\x20salesforce','6FMrXTA','Attachment','decorate','typedi','getBranchRecordByName','updateRemoteState','query','map','4BNjMrp','disableSync','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','records','./salesforce.service','search','stringify','replace','../dto/flosum-repository-sync.dto','text/plain','SYNC_ATTACHMENT_FOR_BRANCH_NAME','__decorate','695256NKCgTm','getRepositoryRecordByName','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'];a243_0x25a9=function(){return _0x2c7f2a;};return a243_0x25a9();}Object['defineProperty'](exports,a243_0x571469(0x13a),{'value':!![]}),exports[a243_0x571469(0x112)]=void 0x0;const typedi_1=require(a243_0x571469(0xe3)),constants_1=require(a243_0x571469(0x134)),errors_1=require(a243_0x571469(0xfe)),utils_1=require('../../../shared/utils'),flosum_repository_sync_dto_1=require(a243_0x571469(0xf0)),not_found_error_1=require(a243_0x571469(0x10d)),queries_1=require(a243_0x571469(0x106)),salesforce_query_service_1=require(a243_0x571469(0x113)),salesforce_service_1=require(a243_0x571469(0xec));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x373b7c,_0x3b2c85){const _0xe434d1=a243_0x571469;this['salesforceQuery']=_0x373b7c,this[_0xe434d1(0xf7)]=_0x3b2c85;}async['getComponents'](_0x2621bd){const _0x2e4d27=a243_0x571469;var _0x3d72b0;const _0x2fc803=await this[_0x2e4d27(0x107)]['query'](_0x2621bd),_0x3a78b2=[];for(const _0xef900f of _0x2fc803){const _0x1a24f8=(_0x3d72b0=_0xef900f[constants_1[_0x2e4d27(0xde)]+_0x2e4d27(0x118)])===null||_0x3d72b0===void 0x0?void 0x0:_0x3d72b0[_0x2e4d27(0xeb)];_0x1a24f8&&_0x1a24f8['length']&&_0x3a78b2[_0x2e4d27(0x111)](_0x1a24f8[0x0]['Id']);}return _0x3a78b2;}async[a243_0x571469(0x11d)](_0xd5bbbc){const _0x2f344f=a243_0x571469,_0x5d95f1=await this[_0x2f344f(0x107)][_0x2f344f(0xe6)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x2f344f(0xef)](/\%connection_id\%/g,_0xd5bbbc));return _0x5d95f1['map'](_0x36c79c=>{const _0x213d6c=_0x2f344f;return _0x36c79c[constants_1[_0x213d6c(0x104)]+_0x213d6c(0x13e)]?_0x36c79c[constants_1[_0x213d6c(0x104)]+_0x213d6c(0x13e)][_0x213d6c(0x13c)]:_0x36c79c[_0x213d6c(0x13c)];});}async[a243_0x571469(0x139)](_0xefed11){const _0x11f437=a243_0x571469,_0x23c566=await this[_0x11f437(0x107)][_0x11f437(0xe6)](queries_1[_0x11f437(0x13d)][_0x11f437(0xef)](/\%connection_id\%/g,_0xefed11));return _0x23c566['map'](_0x3c13a5=>flosum_repository_sync_dto_1[_0x11f437(0x12a)][_0x11f437(0xfd)](_0x3c13a5));}async['getBranchRecords'](_0x533544){const _0x24aeef=a243_0x571469,_0x11fdcb=await this[_0x24aeef(0x107)][_0x24aeef(0xe6)](queries_1['GET_WAITING_BRANCHES_QUERY'][_0x24aeef(0xef)](/%repositories_ids\%/g,_0x533544));return _0x11fdcb[_0x24aeef(0xe7)](_0xcab7c3=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0xcab7c3));}async['getRepositoryRecord'](_0x2cb90b){const _0x2d689a=a243_0x571469,_0x871f03=await this[_0x2d689a(0x107)][_0x2d689a(0xe6)](queries_1['GET_REPOSITORY_QUERY'][_0x2d689a(0xef)](_0x2d689a(0x132),_0x2cb90b));if(_0x871f03[_0x2d689a(0xfc)]===0x0)throw new not_found_error_1[(_0x2d689a(0x120))](_0x2d689a(0x11e)+_0x2cb90b+_0x2d689a(0xdf));return flosum_repository_sync_dto_1[_0x2d689a(0x12a)][_0x2d689a(0xfd)](_0x871f03[0x0]);}async['getBranchRecord'](_0x1f75a9){const _0x198bc8=a243_0x571469,_0x100ec4=await this[_0x198bc8(0x107)]['query'](queries_1['GET_BRANCH_QUERY'][_0x198bc8(0xef)](_0x198bc8(0x132),_0x1f75a9));if(_0x100ec4[_0x198bc8(0xfc)]===0x0)throw new not_found_error_1[(_0x198bc8(0x120))](_0x198bc8(0x10c)+_0x1f75a9+_0x198bc8(0xdf));return flosum_repository_sync_dto_1[_0x198bc8(0x12a)][_0x198bc8(0x130)](_0x100ec4[0x0]);}async[a243_0x571469(0xe4)](_0x25ae2b){const _0x39b9d2=a243_0x571469,_0x26ab24=await this[_0x39b9d2(0x107)]['query'](queries_1[_0x39b9d2(0x13b)]['replace']('%name%',_0x25ae2b));if(_0x26ab24[_0x39b9d2(0xfc)]===0x0)throw new not_found_error_1[(_0x39b9d2(0x120))](_0x39b9d2(0x10f)+_0x25ae2b+'\x20not\x20found\x20on\x20salesforce');const _0xba80d6=_0x26ab24[_0x39b9d2(0x131)](_0x579ad9=>_0x579ad9[constants_1[_0x39b9d2(0xde)]+_0x39b9d2(0x100)]===_0x25ae2b);if(!_0xba80d6)throw new not_found_error_1[(_0x39b9d2(0x120))](_0x39b9d2(0x10f)+_0x25ae2b+_0x39b9d2(0xdf));return flosum_repository_sync_dto_1[_0x39b9d2(0x12a)][_0x39b9d2(0x130)](_0xba80d6);}async[a243_0x571469(0xf5)](_0x40f9a8){const _0x30ad92=a243_0x571469,_0x411c65=await this[_0x30ad92(0x107)][_0x30ad92(0xe6)](queries_1[_0x30ad92(0x12e)][_0x30ad92(0xef)](_0x30ad92(0x123),_0x40f9a8));if(_0x411c65[_0x30ad92(0xfc)]===0x0)throw new not_found_error_1[(_0x30ad92(0x120))](_0x30ad92(0xfa)+_0x40f9a8+_0x30ad92(0xdf));return flosum_repository_sync_dto_1[_0x30ad92(0x12a)]['fromRepositoryRecord'](_0x411c65[0x0]);}async['getComponentsFromRepository'](_0xc5c004){const _0x59432c=a243_0x571469,_0x2d1fe9=_0x59432c(0x12b)+queries_1[_0x59432c(0x11a)]+_0x59432c(0xf6)+_0xc5c004+'\x27';return this[_0x59432c(0x122)](_0x2d1fe9);}async['getBranchComponents'](_0x60ea6a){const _0x59790b=a243_0x571469,_0x3b50a0=_0x59790b(0x129)+queries_1[_0x59790b(0x11a)]+_0x59790b(0x137)+_0x60ea6a+'\x27';return this[_0x59790b(0x122)](_0x3b50a0);}async[a243_0x571469(0x10b)](_0x106fb5){const _0x7d93a6=a243_0x571469;var _0x25e0e0;const _0x1db084=queries_1[_0x7d93a6(0x105)]['replace'](_0x7d93a6(0x138),_0x106fb5[_0x7d93a6(0x110)])['replace']('%name%',_0x106fb5[_0x7d93a6(0xf8)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x7d93a6(0xf2)]),_0x4e1b12=await this[_0x7d93a6(0x107)][_0x7d93a6(0xe6)](_0x1db084),_0x27ad58=(_0x25e0e0=_0x4e1b12[0x0])===null||_0x25e0e0===void 0x0?void 0x0:_0x25e0e0['Id'];if(!_0x27ad58)throw new Error(errors_1[_0x7d93a6(0x103)]);return _0x27ad58;}async[a243_0x571469(0x135)](_0x13364e){const _0x527f91=a243_0x571469;let _0x344df6=await this[_0x527f91(0x10b)](_0x13364e)[_0x527f91(0x119)](()=>null);return!_0x344df6&&(_0x344df6=await this[_0x527f91(0xf7)][_0x527f91(0x133)]('Attachment',{'Body':(0x0,utils_1[_0x527f91(0x115)])('{}'),'ParentId':_0x13364e[_0x527f91(0x110)],'ContentType':_0x527f91(0xf1),'Name':_0x13364e[_0x527f91(0xf8)]?constants_1[_0x527f91(0xea)]:constants_1[_0x527f91(0xf2)]})),_0x344df6;}async[a243_0x571469(0xe5)](_0x97cf4c,_0x498e6f){const _0x95994f=a243_0x571469,_0x2161ec=await this[_0x95994f(0x135)](_0x97cf4c);await this[_0x95994f(0xf7)]['patchObject'](_0x95994f(0xe1),_0x2161ec,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x95994f(0xee)](_0x498e6f))});}async[a243_0x571469(0x11b)](_0x1cd663,_0x4dd017){const _0x419509=a243_0x571469;await this[_0x419509(0xf7)]['patchObject'](_0x1cd663[_0x419509(0xf9)],_0x1cd663[_0x419509(0x110)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x419509(0x117)]:_0x4dd017});}async[a243_0x571469(0xe9)](_0x32c314){const _0x1dfc5b=a243_0x571469;await this[_0x1dfc5b(0xf7)][_0x1dfc5b(0x12f)](constants_1[_0x1dfc5b(0x104)]+_0x1dfc5b(0x10a),_0x32c314,{[constants_1[_0x1dfc5b(0x104)]+_0x1dfc5b(0xfb)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x571469(0x101)])(),__metadata(a243_0x571469(0x11c),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a243_0x571469(0x114)]])],SalesforceSyncService),exports[a243_0x571469(0x112)]=SalesforceSyncService;