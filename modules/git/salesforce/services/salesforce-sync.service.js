function a281_0x1ab4(_0x91987b,_0x3d20f2){const _0x46c76b=a281_0xec3c();return a281_0x1ab4=function(_0x4f6cfe,_0x37a581){_0x4f6cfe=_0x4f6cfe-0x10f;let _0xec3ce6=_0x46c76b[_0x4f6cfe];return _0xec3ce6;},a281_0x1ab4(_0x91987b,_0x3d20f2);}const a281_0x4253e9=a281_0x1ab4;(function(_0xc8b68b,_0x5eb707){const _0x8d747a=a281_0x1ab4,_0x1638e9=_0xc8b68b();while(!![]){try{const _0x1e4ca7=-parseInt(_0x8d747a(0x145))/0x1*(parseInt(_0x8d747a(0x162))/0x2)+-parseInt(_0x8d747a(0x164))/0x3+-parseInt(_0x8d747a(0x138))/0x4*(-parseInt(_0x8d747a(0x163))/0x5)+parseInt(_0x8d747a(0x152))/0x6+-parseInt(_0x8d747a(0x125))/0x7+-parseInt(_0x8d747a(0x15f))/0x8*(parseInt(_0x8d747a(0x122))/0x9)+parseInt(_0x8d747a(0x14d))/0xa*(parseInt(_0x8d747a(0x144))/0xb);if(_0x1e4ca7===_0x5eb707)break;else _0x1638e9['push'](_0x1638e9['shift']());}catch(_0x1b2af7){_0x1638e9['push'](_0x1638e9['shift']());}}}(a281_0xec3c,0x61fff));const a281_0x37a581=(function(){let _0x51f163=!![];return function(_0x2c3822,_0x3508a6){const _0xbe0e50=_0x51f163?function(){const _0x59e26f=a281_0x1ab4;if(_0x3508a6){const _0x4d57f0=_0x3508a6[_0x59e26f(0x150)](_0x2c3822,arguments);return _0x3508a6=null,_0x4d57f0;}}:function(){};return _0x51f163=![],_0xbe0e50;};}()),a281_0x4f6cfe=a281_0x37a581(this,function(){const _0x1f249a=a281_0x1ab4;return a281_0x4f6cfe[_0x1f249a(0x137)]()[_0x1f249a(0x146)](_0x1f249a(0x158))['toString']()[_0x1f249a(0x12a)](a281_0x4f6cfe)['search'](_0x1f249a(0x158));});function a281_0xec3c(){const _0x5ca7b1=['getRepositoryRecords','length','3836680BWebbN','%parentId%','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','14164yvNsdZ','3462115vnhmWD','251937SHNTkZ','Attachment','getComponents','%name%','Name','defineProperty','Branch_Name__c','objectType','fromRepositoryRecord','\x20not\x20found\x20on\x20salesforce','design:paramtypes','getRepositoryRecord','Repository__r','../../../shared/utils','../errors/not-found.error','find','SalesforceService','map','getRemoteStateAttachmentId','GET_WAITING_REPOSITORIES_QUERY','%id%','Sync_In_Progress__c','updateRemoteState','9dsDZsE','../dto/flosum-repository-sync.dto','getAttachmentId','5166889bplnAY','GET_BRANCH_QUERY','__esModule','getRepositoryRecordByName','SalesforceNotFoundError','constructor','disableSync','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','repositoryId','Connection__c','objectId','getBranchRecordByName','setStatus','replace','metadata','salesforceQuery','catch','getOwnPropertyDescriptor','toString','4WvDDNF','FLOSUM_GIT_NAMESPACE','Branch\x20','__metadata','typedi','__decorate','patchObject','FLOSUM_NAMESPACE','GET_REPOSITORY_QUERY','encodeBase64','decorate','Synchronization_Status__c','110JgSQES','1fASMVs','search','getComponentsFromRepository','../queries','SalesforceSyncService','SYNC_ATTACHMENT_FOR_BRANCH_NAME','GET_BRANCH_BY_NAME_QUERY','Components__r','933780XaJVpK','\x0a\x20\x20\x20\x20\x20\x20','salesforceService','apply','object','503862qNXeBO','Service','fromBranchRecord','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','Repository\x20with\x20Id\x20','createObject','(((.+)+)+)+$','query','FlosumRepositorySyncDto','stringify','../../../../constants'];a281_0xec3c=function(){return _0x5ca7b1;};return a281_0xec3c();}a281_0x4f6cfe();'use strict';var __decorate=this&&this[a281_0x4253e9(0x13d)]||function(_0x1effa0,_0x542cc4,_0x5d9aae,_0x34da33){const _0x345514=a281_0x4253e9;var _0x28bc62=arguments[_0x345514(0x15e)],_0x12ea22=_0x28bc62<0x3?_0x542cc4:_0x34da33===null?_0x34da33=Object[_0x345514(0x136)](_0x542cc4,_0x5d9aae):_0x34da33,_0xfbfb92;if(typeof Reflect===_0x345514(0x151)&&typeof Reflect[_0x345514(0x142)]==='function')_0x12ea22=Reflect[_0x345514(0x142)](_0x1effa0,_0x542cc4,_0x5d9aae,_0x34da33);else{for(var _0x30d4f9=_0x1effa0[_0x345514(0x15e)]-0x1;_0x30d4f9>=0x0;_0x30d4f9--)if(_0xfbfb92=_0x1effa0[_0x30d4f9])_0x12ea22=(_0x28bc62<0x3?_0xfbfb92(_0x12ea22):_0x28bc62>0x3?_0xfbfb92(_0x542cc4,_0x5d9aae,_0x12ea22):_0xfbfb92(_0x542cc4,_0x5d9aae))||_0x12ea22;}return _0x28bc62>0x3&&_0x12ea22&&Object[_0x345514(0x110)](_0x542cc4,_0x5d9aae,_0x12ea22),_0x12ea22;},__metadata=this&&this[a281_0x4253e9(0x13b)]||function(_0xbba888,_0x582ebe){const _0x193853=a281_0x4253e9;if(typeof Reflect==='object'&&typeof Reflect[_0x193853(0x133)]==='function')return Reflect['metadata'](_0xbba888,_0x582ebe);};Object[a281_0x4253e9(0x110)](exports,a281_0x4253e9(0x127),{'value':!![]}),exports[a281_0x4253e9(0x149)]=void 0x0;const typedi_1=require(a281_0x4253e9(0x13c)),constants_1=require(a281_0x4253e9(0x15c)),errors_1=require('../../../../constants/errors'),utils_1=require(a281_0x4253e9(0x118)),flosum_repository_sync_dto_1=require(a281_0x4253e9(0x123)),not_found_error_1=require(a281_0x4253e9(0x119)),queries_1=require(a281_0x4253e9(0x148)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0x2a56b1,_0x2ab1f5){const _0x2a4c06=a281_0x4253e9;this[_0x2a4c06(0x134)]=_0x2a56b1,this['salesforceService']=_0x2ab1f5;}async[a281_0x4253e9(0x166)](_0x556a47){const _0x4db57c=a281_0x4253e9;var _0x372a72;const _0x34360c=await this[_0x4db57c(0x134)][_0x4db57c(0x159)](_0x556a47),_0x25ba55=[];for(const _0x5ac98f of _0x34360c){const _0x506325=(_0x372a72=_0x5ac98f[constants_1['FLOSUM_NAMESPACE']+_0x4db57c(0x14c)])===null||_0x372a72===void 0x0?void 0x0:_0x372a72['records'];_0x506325&&_0x506325[_0x4db57c(0x15e)]&&_0x25ba55['push'](_0x506325[0x0]['Id']);}return _0x25ba55;}async['getAllRepositoryNames'](_0x5b4c10){const _0x8a05c1=a281_0x4253e9,_0x3b7408=await this[_0x8a05c1(0x134)][_0x8a05c1(0x159)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x8a05c1(0x132)](/\%connection_id\%/g,_0x5b4c10));return _0x3b7408[_0x8a05c1(0x11c)](_0x378a71=>{const _0x1fbf0d=_0x8a05c1;return _0x378a71[constants_1[_0x1fbf0d(0x139)]+_0x1fbf0d(0x117)]?_0x378a71[constants_1[_0x1fbf0d(0x139)]+_0x1fbf0d(0x117)]['Name']:_0x378a71[_0x1fbf0d(0x10f)];});}async[a281_0x4253e9(0x15d)](_0xcdf5e){const _0x1cbfb3=a281_0x4253e9,_0x355124=await this[_0x1cbfb3(0x134)][_0x1cbfb3(0x159)](queries_1[_0x1cbfb3(0x11e)][_0x1cbfb3(0x132)](/\%connection_id\%/g,_0xcdf5e));return _0x355124[_0x1cbfb3(0x11c)](_0x65b04a=>flosum_repository_sync_dto_1[_0x1cbfb3(0x15a)][_0x1cbfb3(0x113)](_0x65b04a));}async['getBranchRecords'](_0x282dcc){const _0x3dda79=a281_0x4253e9,_0x4aca1a=await this['salesforceQuery']['query'](queries_1['GET_WAITING_BRANCHES_QUERY'][_0x3dda79(0x132)](/%repositories_ids\%/g,_0x282dcc));return _0x4aca1a['map'](_0x146b20=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x146b20));}async[a281_0x4253e9(0x116)](_0xb90711){const _0x324e92=a281_0x4253e9,_0xb6ac2e=await this[_0x324e92(0x134)]['query'](queries_1[_0x324e92(0x140)][_0x324e92(0x132)](_0x324e92(0x11f),_0xb90711));if(_0xb6ac2e['length']===0x0)throw new not_found_error_1[(_0x324e92(0x129))](_0x324e92(0x156)+_0xb90711+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x324e92(0x113)](_0xb6ac2e[0x0]);}async['getBranchRecord'](_0x275aba){const _0x41e463=a281_0x4253e9,_0x959c2f=await this[_0x41e463(0x134)][_0x41e463(0x159)](queries_1[_0x41e463(0x126)][_0x41e463(0x132)](_0x41e463(0x11f),_0x275aba));if(_0x959c2f[_0x41e463(0x15e)]===0x0)throw new not_found_error_1[(_0x41e463(0x129))]('Branch\x20with\x20Id\x20'+_0x275aba+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x41e463(0x15a)]['fromBranchRecord'](_0x959c2f[0x0]);}async[a281_0x4253e9(0x130)](_0x42b66f){const _0xf5cc6c=a281_0x4253e9,_0x3d9b86=await this[_0xf5cc6c(0x134)][_0xf5cc6c(0x159)](queries_1[_0xf5cc6c(0x14b)][_0xf5cc6c(0x132)](_0xf5cc6c(0x167),_0x42b66f));if(_0x3d9b86[_0xf5cc6c(0x15e)]===0x0)throw new not_found_error_1[(_0xf5cc6c(0x129))](_0xf5cc6c(0x13a)+_0x42b66f+_0xf5cc6c(0x114));const _0x20b180=_0x3d9b86[_0xf5cc6c(0x11a)](_0x2eeab3=>_0x2eeab3[constants_1[_0xf5cc6c(0x13f)]+_0xf5cc6c(0x111)]===_0x42b66f);if(!_0x20b180)throw new not_found_error_1[(_0xf5cc6c(0x129))](_0xf5cc6c(0x13a)+_0x42b66f+_0xf5cc6c(0x114));return flosum_repository_sync_dto_1[_0xf5cc6c(0x15a)][_0xf5cc6c(0x154)](_0x20b180);}async[a281_0x4253e9(0x128)](_0x185f9c){const _0x8b2984=a281_0x4253e9,_0x5e079a=await this[_0x8b2984(0x134)][_0x8b2984(0x159)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x8b2984(0x132)](_0x8b2984(0x167),_0x185f9c));if(_0x5e079a[_0x8b2984(0x15e)]===0x0)throw new not_found_error_1[(_0x8b2984(0x129))]('Repository\x20'+_0x185f9c+_0x8b2984(0x114));return flosum_repository_sync_dto_1[_0x8b2984(0x15a)][_0x8b2984(0x113)](_0x5e079a[0x0]);}async[a281_0x4253e9(0x147)](_0x4d210a){const _0x55f730=a281_0x4253e9,_0x1a7e3c=_0x55f730(0x14e)+queries_1['GET_COMPONENTS_QUERY']+_0x55f730(0x161)+_0x4d210a+'\x27';return this[_0x55f730(0x166)](_0x1a7e3c);}async['getBranchComponents'](_0xe81c7){const _0x27357f=a281_0x4253e9,_0x276145=_0x27357f(0x12c)+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0xe81c7+'\x27';return this['getComponents'](_0x276145);}async[a281_0x4253e9(0x124)](_0x330393){const _0x4f121c=a281_0x4253e9;var _0x572f85;const _0x176c17=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x4f121c(0x132)](_0x4f121c(0x160),_0x330393[_0x4f121c(0x12f)])['replace'](_0x4f121c(0x167),_0x330393[_0x4f121c(0x12d)]?constants_1[_0x4f121c(0x155)]:constants_1[_0x4f121c(0x14a)]),_0x588191=await this[_0x4f121c(0x134)][_0x4f121c(0x159)](_0x176c17),_0x2ee237=(_0x572f85=_0x588191[0x0])===null||_0x572f85===void 0x0?void 0x0:_0x572f85['Id'];if(!_0x2ee237)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x2ee237;}async[a281_0x4253e9(0x11d)](_0x49c620){const _0x527368=a281_0x4253e9;let _0xf03749=await this[_0x527368(0x124)](_0x49c620)[_0x527368(0x135)](()=>null);return!_0xf03749&&(_0xf03749=await this[_0x527368(0x14f)][_0x527368(0x157)](_0x527368(0x165),{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x49c620[_0x527368(0x12f)],'ContentType':'text/plain','Name':_0x49c620[_0x527368(0x12d)]?constants_1[_0x527368(0x155)]:constants_1[_0x527368(0x14a)]})),_0xf03749;}async[a281_0x4253e9(0x121)](_0x3f96b4,_0x501fb0){const _0x46f0e1=a281_0x4253e9,_0x35d4d8=await this[_0x46f0e1(0x11d)](_0x3f96b4);await this[_0x46f0e1(0x14f)][_0x46f0e1(0x13e)](_0x46f0e1(0x165),_0x35d4d8,{'Body':(0x0,utils_1[_0x46f0e1(0x141)])(JSON[_0x46f0e1(0x15b)](_0x501fb0))});}async[a281_0x4253e9(0x131)](_0x98ab30,_0x4e7c3c){const _0x4573d8=a281_0x4253e9;await this['salesforceService'][_0x4573d8(0x13e)](_0x98ab30[_0x4573d8(0x112)],_0x98ab30[_0x4573d8(0x12f)],{[constants_1[_0x4573d8(0x139)]+_0x4573d8(0x143)]:_0x4e7c3c});}async[a281_0x4253e9(0x12b)](_0x1e5467){const _0x5553da=a281_0x4253e9;await this[_0x5553da(0x14f)][_0x5553da(0x13e)](constants_1[_0x5553da(0x139)]+_0x5553da(0x12e),_0x1e5467,{[constants_1[_0x5553da(0x139)]+_0x5553da(0x120)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a281_0x4253e9(0x153)])(),__metadata(a281_0x4253e9(0x115),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a281_0x4253e9(0x11b)]])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;