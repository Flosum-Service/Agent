const a243_0x15979e=a243_0x2867;(function(_0x4e2142,_0x1d18cc){const _0xb5aa76=a243_0x2867,_0x5bffb8=_0x4e2142();while(!![]){try{const _0x57c244=parseInt(_0xb5aa76(0x1dd))/0x1+-parseInt(_0xb5aa76(0x1d6))/0x2+-parseInt(_0xb5aa76(0x203))/0x3+-parseInt(_0xb5aa76(0x1c8))/0x4*(parseInt(_0xb5aa76(0x1b6))/0x5)+parseInt(_0xb5aa76(0x1b4))/0x6*(-parseInt(_0xb5aa76(0x204))/0x7)+parseInt(_0xb5aa76(0x1db))/0x8*(-parseInt(_0xb5aa76(0x1f4))/0x9)+parseInt(_0xb5aa76(0x1a5))/0xa;if(_0x57c244===_0x1d18cc)break;else _0x5bffb8['push'](_0x5bffb8['shift']());}catch(_0x274aa1){_0x5bffb8['push'](_0x5bffb8['shift']());}}}(a243_0x15fe,0xb72d4));const a243_0x44250f=(function(){let _0x274e37=!![];return function(_0x4c6d3b,_0x438c7f){const _0x590e95=_0x274e37?function(){const _0xf3d083=a243_0x2867;if(_0x438c7f){const _0x282378=_0x438c7f[_0xf3d083(0x1fe)](_0x4c6d3b,arguments);return _0x438c7f=null,_0x282378;}}:function(){};return _0x274e37=![],_0x590e95;};}()),a243_0x15ffd0=a243_0x44250f(this,function(){const _0x429196=a243_0x2867;return a243_0x15ffd0[_0x429196(0x1e8)]()[_0x429196(0x1b0)](_0x429196(0x1de))[_0x429196(0x1e8)]()[_0x429196(0x1ad)](a243_0x15ffd0)[_0x429196(0x1b0)](_0x429196(0x1de));});a243_0x15ffd0();'use strict';function a243_0x2867(_0x67c11f,_0x66fd09){const _0x37ee9f=a243_0x15fe();return a243_0x2867=function(_0x15ffd0,_0x44250f){_0x15ffd0=_0x15ffd0-0x1a3;let _0x15feac=_0x37ee9f[_0x15ffd0];return _0x15feac;},a243_0x2867(_0x67c11f,_0x66fd09);}var __decorate=this&&this[a243_0x15979e(0x1c2)]||function(_0x46ddda,_0x46d99a,_0x526902,_0x587357){const _0x57d596=a243_0x15979e;var _0x4a49b1=arguments['length'],_0x470f17=_0x4a49b1<0x3?_0x46d99a:_0x587357===null?_0x587357=Object[_0x57d596(0x1e2)](_0x46d99a,_0x526902):_0x587357,_0x1bca7e;if(typeof Reflect===_0x57d596(0x1b9)&&typeof Reflect[_0x57d596(0x1a3)]===_0x57d596(0x1ba))_0x470f17=Reflect[_0x57d596(0x1a3)](_0x46ddda,_0x46d99a,_0x526902,_0x587357);else{for(var _0x901464=_0x46ddda['length']-0x1;_0x901464>=0x0;_0x901464--)if(_0x1bca7e=_0x46ddda[_0x901464])_0x470f17=(_0x4a49b1<0x3?_0x1bca7e(_0x470f17):_0x4a49b1>0x3?_0x1bca7e(_0x46d99a,_0x526902,_0x470f17):_0x1bca7e(_0x46d99a,_0x526902))||_0x470f17;}return _0x4a49b1>0x3&&_0x470f17&&Object[_0x57d596(0x1cb)](_0x46d99a,_0x526902,_0x470f17),_0x470f17;},__metadata=this&&this['__metadata']||function(_0x1011ce,_0x11e821){const _0x3cc7ae=a243_0x15979e;if(typeof Reflect===_0x3cc7ae(0x1b9)&&typeof Reflect['metadata']===_0x3cc7ae(0x1ba))return Reflect[_0x3cc7ae(0x1d1)](_0x1011ce,_0x11e821);};Object['defineProperty'](exports,a243_0x15979e(0x1bc),{'value':!![]}),exports[a243_0x15979e(0x1da)]=void 0x0;const typedi_1=require(a243_0x15979e(0x1cd)),constants_1=require('../../../../constants'),errors_1=require(a243_0x15979e(0x1c6)),utils_1=require(a243_0x15979e(0x1aa)),flosum_repository_sync_dto_1=require(a243_0x15979e(0x1b7)),not_found_error_1=require('../errors/not-found.error'),queries_1=require('../queries'),salesforce_query_service_1=require(a243_0x15979e(0x1ae)),salesforce_service_1=require(a243_0x15979e(0x1ec));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x418ae0,_0x29f919){const _0x554e9a=a243_0x15979e;this['salesforceQuery']=_0x418ae0,this[_0x554e9a(0x1ea)]=_0x29f919;}async[a243_0x15979e(0x1a6)](_0x4b6e66){const _0x56bc19=a243_0x15979e;var _0x341651;const _0x2a54c3=await this[_0x56bc19(0x1df)][_0x56bc19(0x1c0)](_0x4b6e66),_0x5b93e8=[];for(const _0x1fd9e1 of _0x2a54c3){const _0x1439e3=(_0x341651=_0x1fd9e1[constants_1['FLOSUM_NAMESPACE']+_0x56bc19(0x1dc)])===null||_0x341651===void 0x0?void 0x0:_0x341651['records'];_0x1439e3&&_0x1439e3[_0x56bc19(0x1d4)]&&_0x5b93e8[_0x56bc19(0x1bd)](_0x1439e3[0x0]['Id']);}return _0x5b93e8;}async[a243_0x15979e(0x200)](_0x597b93){const _0x1ed7f0=a243_0x15979e,_0x145c1b=await this[_0x1ed7f0(0x1df)][_0x1ed7f0(0x1c0)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x1ed7f0(0x1f8)](/\%connection_id\%/g,_0x597b93));return _0x145c1b[_0x1ed7f0(0x1e3)](_0x19871a=>{const _0x2fe702=_0x1ed7f0;return _0x19871a[constants_1[_0x2fe702(0x1ac)]+_0x2fe702(0x1ce)]?_0x19871a[constants_1['FLOSUM_GIT_NAMESPACE']+_0x2fe702(0x1ce)][_0x2fe702(0x1b5)]:_0x19871a[_0x2fe702(0x1b5)];});}async['getRepositoryRecords'](_0x35d6bc){const _0x15ec0a=a243_0x15979e,_0x3cdbb0=await this[_0x15ec0a(0x1df)][_0x15ec0a(0x1c0)](queries_1[_0x15ec0a(0x1e7)][_0x15ec0a(0x1f8)](/\%connection_id\%/g,_0x35d6bc));return _0x3cdbb0['map'](_0x4acd18=>flosum_repository_sync_dto_1[_0x15ec0a(0x1be)][_0x15ec0a(0x1ef)](_0x4acd18));}async[a243_0x15979e(0x1eb)](_0x3581f5){const _0x141b0c=a243_0x15979e,_0x44711e=await this['salesforceQuery'][_0x141b0c(0x1c0)](queries_1[_0x141b0c(0x1ab)][_0x141b0c(0x1f8)](/%repositories_ids\%/g,_0x3581f5));return _0x44711e[_0x141b0c(0x1e3)](_0x1d534d=>flosum_repository_sync_dto_1[_0x141b0c(0x1be)]['fromBranchRecord'](_0x1d534d));}async[a243_0x15979e(0x1cc)](_0x20763c){const _0x502c8a=a243_0x15979e,_0x207fdf=await this[_0x502c8a(0x1df)]['query'](queries_1['GET_REPOSITORY_QUERY'][_0x502c8a(0x1f8)](_0x502c8a(0x1c3),_0x20763c));if(_0x207fdf['length']===0x0)throw new not_found_error_1[(_0x502c8a(0x1e1))](_0x502c8a(0x1f1)+_0x20763c+_0x502c8a(0x1e9));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x502c8a(0x1ef)](_0x207fdf[0x0]);}async[a243_0x15979e(0x1c4)](_0x36bffa){const _0x9ee488=a243_0x15979e,_0x49eb25=await this['salesforceQuery']['query'](queries_1[_0x9ee488(0x1bb)][_0x9ee488(0x1f8)](_0x9ee488(0x1c3),_0x36bffa));if(_0x49eb25[_0x9ee488(0x1d4)]===0x0)throw new not_found_error_1[(_0x9ee488(0x1e1))]('Branch\x20with\x20Id\x20'+_0x36bffa+_0x9ee488(0x1e9));return flosum_repository_sync_dto_1[_0x9ee488(0x1be)]['fromBranchRecord'](_0x49eb25[0x0]);}async[a243_0x15979e(0x1f5)](_0x1ab872){const _0x1f85f7=a243_0x15979e,_0x2f6c9b=await this[_0x1f85f7(0x1df)]['query'](queries_1[_0x1f85f7(0x1f7)][_0x1f85f7(0x1f8)]('%name%',_0x1ab872));if(_0x2f6c9b[_0x1f85f7(0x1d4)]===0x0)throw new not_found_error_1[(_0x1f85f7(0x1e1))](_0x1f85f7(0x1d9)+_0x1ab872+_0x1f85f7(0x1e9));const _0x5526d7=_0x2f6c9b[_0x1f85f7(0x1fc)](_0x122116=>_0x122116[constants_1[_0x1f85f7(0x1cf)]+_0x1f85f7(0x1a8)]===_0x1ab872);if(!_0x5526d7)throw new not_found_error_1[(_0x1f85f7(0x1e1))](_0x1f85f7(0x1d9)+_0x1ab872+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x1f85f7(0x1be)][_0x1f85f7(0x1af)](_0x5526d7);}async[a243_0x15979e(0x1c7)](_0x8d0495){const _0x5ac906=a243_0x15979e,_0x4010c7=await this[_0x5ac906(0x1df)][_0x5ac906(0x1c0)](queries_1[_0x5ac906(0x1d7)][_0x5ac906(0x1f8)](_0x5ac906(0x1e0),_0x8d0495));if(_0x4010c7['length']===0x0)throw new not_found_error_1[(_0x5ac906(0x1e1))](_0x5ac906(0x1f9)+_0x8d0495+_0x5ac906(0x1e9));return flosum_repository_sync_dto_1[_0x5ac906(0x1be)][_0x5ac906(0x1ef)](_0x4010c7[0x0]);}async[a243_0x15979e(0x1d5)](_0x12f818){const _0x52d88b=a243_0x15979e,_0x2ebfae=_0x52d88b(0x1c5)+queries_1[_0x52d88b(0x201)]+_0x52d88b(0x1e6)+_0x12f818+'\x27';return this[_0x52d88b(0x1a6)](_0x2ebfae);}async[a243_0x15979e(0x1ca)](_0x22c5d6){const _0x4644ed=a243_0x15979e,_0x4e8179=_0x4644ed(0x1b2)+queries_1[_0x4644ed(0x201)]+_0x4644ed(0x1b8)+_0x22c5d6+'\x27';return this[_0x4644ed(0x1a6)](_0x4e8179);}async[a243_0x15979e(0x1f0)](_0x24478a){const _0x314378=a243_0x15979e;var _0x8fb6d2;const _0xea287a=queries_1[_0x314378(0x1bf)]['replace'](_0x314378(0x1b3),_0x24478a['objectId'])[_0x314378(0x1f8)](_0x314378(0x1e0),_0x24478a[_0x314378(0x1d3)]?constants_1[_0x314378(0x1e5)]:constants_1[_0x314378(0x1d2)]),_0x4228e4=await this['salesforceQuery'][_0x314378(0x1c0)](_0xea287a),_0x49287b=(_0x8fb6d2=_0x4228e4[0x0])===null||_0x8fb6d2===void 0x0?void 0x0:_0x8fb6d2['Id'];if(!_0x49287b)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x49287b;}async[a243_0x15979e(0x202)](_0x52fa1d){const _0x3fcdc5=a243_0x15979e;let _0x2aabc7=await this[_0x3fcdc5(0x1f0)](_0x52fa1d)[_0x3fcdc5(0x1ee)](()=>null);return!_0x2aabc7&&(_0x2aabc7=await this[_0x3fcdc5(0x1ea)][_0x3fcdc5(0x1e4)](_0x3fcdc5(0x1ed),{'Body':(0x0,utils_1[_0x3fcdc5(0x1b1)])('{}'),'ParentId':_0x52fa1d[_0x3fcdc5(0x1fd)],'ContentType':_0x3fcdc5(0x1c1),'Name':_0x52fa1d['repositoryId']?constants_1[_0x3fcdc5(0x1e5)]:constants_1[_0x3fcdc5(0x1d2)]})),_0x2aabc7;}async['updateRemoteState'](_0x52f2ec,_0xba7759){const _0xfbc256=a243_0x15979e,_0x56016b=await this[_0xfbc256(0x202)](_0x52f2ec);await this[_0xfbc256(0x1ea)][_0xfbc256(0x1fb)](_0xfbc256(0x1ed),_0x56016b,{'Body':(0x0,utils_1[_0xfbc256(0x1b1)])(JSON[_0xfbc256(0x1f3)](_0xba7759))});}async[a243_0x15979e(0x1f6)](_0x1eb9c4,_0x463538){const _0x53a925=a243_0x15979e;await this[_0x53a925(0x1ea)][_0x53a925(0x1fb)](_0x1eb9c4[_0x53a925(0x1f2)],_0x1eb9c4[_0x53a925(0x1fd)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x53a925(0x1d8)]:_0x463538});}async[a243_0x15979e(0x1c9)](_0x4392e2){const _0x4c21bc=a243_0x15979e;await this[_0x4c21bc(0x1ea)][_0x4c21bc(0x1fb)](constants_1['FLOSUM_GIT_NAMESPACE']+_0x4c21bc(0x1d0),_0x4392e2,{[constants_1[_0x4c21bc(0x1ac)]+_0x4c21bc(0x1fa)]:![]});}};function a243_0x15fe(){const _0x4fd85e=['../../../../constants/errors','getRepositoryRecordByName','28oYGrHq','disableSync','getBranchComponents','defineProperty','getRepositoryRecord','typedi','Repository__r','FLOSUM_NAMESPACE','Connection__c','metadata','SYNC_ATTACHMENT_FOR_BRANCH_NAME','repositoryId','length','getComponentsFromRepository','1440608ptzkYH','GET_REPOSITORY_BY_NAME_QUERY','Synchronization_Status__c','Branch\x20','SalesforceSyncService','32hrtwLp','Components__r','66604rEYskn','(((.+)+)+)+$','salesforceQuery','%name%','SalesforceNotFoundError','getOwnPropertyDescriptor','map','createObject','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','GET_WAITING_REPOSITORIES_QUERY','toString','\x20not\x20found\x20on\x20salesforce','salesforceService','getBranchRecords','./salesforce.service','Attachment','catch','fromRepositoryRecord','getAttachmentId','Repository\x20with\x20Id\x20','objectType','stringify','2429172oRWZVY','getBranchRecordByName','setStatus','GET_BRANCH_BY_NAME_QUERY','replace','Repository\x20','Sync_In_Progress__c','patchObject','find','objectId','apply','design:paramtypes','getAllRepositoryNames','GET_COMPONENTS_QUERY','getRemoteStateAttachmentId','3785079hvQFES','252595AVjeJz','decorate','SalesforceService','45392220GNsRpO','getComponents','Service','Branch_Name__c','SalesforceQueryService','../../../shared/utils','GET_WAITING_BRANCHES_QUERY','FLOSUM_GIT_NAMESPACE','constructor','./salesforce-query.service','fromBranchRecord','search','encodeBase64','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','%parentId%','6UvewoA','Name','541300uOOJbX','../dto/flosum-repository-sync.dto','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','object','function','GET_BRANCH_QUERY','__esModule','push','FlosumRepositorySyncDto','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','query','text/plain','__decorate','%id%','getBranchRecord','\x0a\x20\x20\x20\x20\x20\x20'];a243_0x15fe=function(){return _0x4fd85e;};return a243_0x15fe();}SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x15979e(0x1a7)])(),__metadata(a243_0x15979e(0x1ff),[salesforce_query_service_1[a243_0x15979e(0x1a9)],salesforce_service_1[a243_0x15979e(0x1a4)]])],SalesforceSyncService),exports[a243_0x15979e(0x1da)]=SalesforceSyncService;