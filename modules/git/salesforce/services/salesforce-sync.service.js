const a186_0x2575ac=a186_0xa1f9;(function(_0x174383,_0x3e7827){const _0x2927a1=a186_0xa1f9,_0x1ceba1=_0x174383();while(!![]){try{const _0x53638b=-parseInt(_0x2927a1(0xaf))/0x1*(parseInt(_0x2927a1(0xa9))/0x2)+-parseInt(_0x2927a1(0x7b))/0x3+-parseInt(_0x2927a1(0xa1))/0x4*(parseInt(_0x2927a1(0xb8))/0x5)+parseInt(_0x2927a1(0x97))/0x6+parseInt(_0x2927a1(0xbf))/0x7*(-parseInt(_0x2927a1(0xc5))/0x8)+parseInt(_0x2927a1(0xb9))/0x9*(-parseInt(_0x2927a1(0x96))/0xa)+parseInt(_0x2927a1(0xa6))/0xb;if(_0x53638b===_0x3e7827)break;else _0x1ceba1['push'](_0x1ceba1['shift']());}catch(_0x1501aa){_0x1ceba1['push'](_0x1ceba1['shift']());}}}(a186_0x3f00,0x31f11));const a186_0xf213e6=(function(){let _0x4ed680=!![];return function(_0x35c9b8,_0x1d8a07){const _0x2fd97b=_0x4ed680?function(){const _0x1a6d2a=a186_0xa1f9;if(_0x1d8a07){const _0x1aa3f6=_0x1d8a07[_0x1a6d2a(0x7d)](_0x35c9b8,arguments);return _0x1d8a07=null,_0x1aa3f6;}}:function(){};return _0x4ed680=![],_0x2fd97b;};}()),a186_0x13ccab=a186_0xf213e6(this,function(){const _0x7478e7=a186_0xa1f9;return a186_0x13ccab[_0x7478e7(0xa0)]()[_0x7478e7(0xb4)](_0x7478e7(0x95))['toString']()[_0x7478e7(0xd5)](a186_0x13ccab)[_0x7478e7(0xb4)](_0x7478e7(0x95));});a186_0x13ccab();'use strict';function a186_0x3f00(){const _0x1420ae=['%id%','GET_BRANCH_QUERY','defineProperty','getRepositoryRecord','1526rBhygA','Repository\x20with\x20Id\x20','%name%','stringify','push','Connection__c','10936hbVXgX','ERR_INVALID_ATTACHMENT_ID','metadata','\x20not\x20found\x20on\x20salesforce','getBranchComponents','Sync_In_Progress__c','\x0a\x20\x20\x20\x20\x20\x20','map','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','getBranchRecords','decorate','SYNC_ATTACHMENT_FOR_BRANCH_NAME','Components__r','Attachment','../errors/not-found.error','catch','constructor','text/plain','FlosumRepositorySyncDto','../../../../constants','945231cMAlXQ','updateRemoteState','apply','salesforceService','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','./salesforce.service','./salesforce-query.service','replace','getBranchRecord','encodeBase64','objectId','query','setStatus','GET_WAITING_BRANCHES_QUERY','GET_REPOSITORY_QUERY','SalesforceSyncService','GET_WAITING_REPOSITORIES_QUERY','design:paramtypes','__decorate','FLOSUM_GIT_NAMESPACE','objectType','Branch\x20with\x20Id\x20','repositoryId','Branch\x20','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','salesforceQuery','(((.+)+)+)+$','654180hFpFlo','1464528EIyTfL','Synchronization_Status__c','length','getRepositoryRecordByName','getOwnPropertyDescriptor','SalesforceService','../queries','getRemoteStateAttachmentId','GET_COMPONENTS_QUERY','toString','185636VIeJkv','fromBranchRecord','Service','getComponents','getComponentsFromRepository','15695922eKJCWH','typedi','GET_REPOSITORY_BY_NAME_QUERY','309968nqrRKS','__esModule','SalesforceNotFoundError','fromRepositoryRecord','SalesforceQueryService','GET_BRANCH_BY_NAME_QUERY','1EeUydD','../../../shared/utils','../dto/flosum-repository-sync.dto','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getRepositoryRecords','search','records','../../../../constants/errors','__metadata','40UAiacv','45PrIaau','function'];a186_0x3f00=function(){return _0x1420ae;};return a186_0x3f00();}var __decorate=this&&this[a186_0x2575ac(0x8d)]||function(_0xec2a6e,_0x119454,_0x1864d9,_0x478744){const _0x18ddce=a186_0x2575ac;var _0x5eb93f=arguments[_0x18ddce(0x99)],_0x4fa83f=_0x5eb93f<0x3?_0x119454:_0x478744===null?_0x478744=Object[_0x18ddce(0x9b)](_0x119454,_0x1864d9):_0x478744,_0x3b669e;if(typeof Reflect==='object'&&typeof Reflect[_0x18ddce(0xcf)]===_0x18ddce(0xba))_0x4fa83f=Reflect[_0x18ddce(0xcf)](_0xec2a6e,_0x119454,_0x1864d9,_0x478744);else{for(var _0x1bbde0=_0xec2a6e['length']-0x1;_0x1bbde0>=0x0;_0x1bbde0--)if(_0x3b669e=_0xec2a6e[_0x1bbde0])_0x4fa83f=(_0x5eb93f<0x3?_0x3b669e(_0x4fa83f):_0x5eb93f>0x3?_0x3b669e(_0x119454,_0x1864d9,_0x4fa83f):_0x3b669e(_0x119454,_0x1864d9))||_0x4fa83f;}return _0x5eb93f>0x3&&_0x4fa83f&&Object[_0x18ddce(0xbd)](_0x119454,_0x1864d9,_0x4fa83f),_0x4fa83f;},__metadata=this&&this[a186_0x2575ac(0xb7)]||function(_0x11a54f,_0x20b98b){const _0x26741e=a186_0x2575ac;if(typeof Reflect==='object'&&typeof Reflect[_0x26741e(0xc7)]===_0x26741e(0xba))return Reflect[_0x26741e(0xc7)](_0x11a54f,_0x20b98b);};Object[a186_0x2575ac(0xbd)](exports,a186_0x2575ac(0xaa),{'value':!![]}),exports[a186_0x2575ac(0x8a)]=void 0x0;const typedi_1=require(a186_0x2575ac(0xa7)),constants_1=require(a186_0x2575ac(0x7a)),errors_1=require(a186_0x2575ac(0xb6)),utils_1=require(a186_0x2575ac(0xb0)),flosum_repository_sync_dto_1=require(a186_0x2575ac(0xb1)),not_found_error_1=require(a186_0x2575ac(0xd3)),queries_1=require(a186_0x2575ac(0x9d)),salesforce_query_service_1=require(a186_0x2575ac(0x81)),salesforce_service_1=require(a186_0x2575ac(0x80));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x31f003,_0x3bd9de){const _0x5428b=a186_0x2575ac;this[_0x5428b(0x94)]=_0x31f003,this[_0x5428b(0x7e)]=_0x3bd9de;}async['getComponents'](_0x4a7283){const _0x3ffa1c=a186_0x2575ac;var _0x2fbfd0;const _0x5d987c=await this[_0x3ffa1c(0x94)][_0x3ffa1c(0x86)](_0x4a7283),_0x1f3f49=[];for(const _0x32e885 of _0x5d987c){const _0xd66e83=(_0x2fbfd0=_0x32e885[constants_1['FLOSUM_NAMESPACE']+_0x3ffa1c(0xd1)])===null||_0x2fbfd0===void 0x0?void 0x0:_0x2fbfd0[_0x3ffa1c(0xb5)];_0xd66e83&&_0xd66e83[_0x3ffa1c(0x99)]&&_0x1f3f49[_0x3ffa1c(0xc3)](_0xd66e83[0x0]['Id']);}return _0x1f3f49;}async[a186_0x2575ac(0xb3)](_0x1a7699){const _0x50a18b=a186_0x2575ac,_0x55a97c=await this[_0x50a18b(0x94)]['query'](queries_1[_0x50a18b(0x8b)][_0x50a18b(0x82)](/\%connection_id\%/g,_0x1a7699));return _0x55a97c[_0x50a18b(0xcc)](_0x3896a9=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x50a18b(0xac)](_0x3896a9));}async[a186_0x2575ac(0xce)](_0x492b4c){const _0x90097f=a186_0x2575ac,_0x26ec14=await this[_0x90097f(0x94)][_0x90097f(0x86)](queries_1[_0x90097f(0x88)][_0x90097f(0x82)](/%repositories_ids\%/g,_0x492b4c));return _0x26ec14['map'](_0x1bb36a=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x90097f(0xa2)](_0x1bb36a));}async[a186_0x2575ac(0xbe)](_0x256d02){const _0x171ae0=a186_0x2575ac,_0x32932e=await this[_0x171ae0(0x94)][_0x171ae0(0x86)](queries_1[_0x171ae0(0x89)][_0x171ae0(0x82)]('%id%',_0x256d02));if(_0x32932e[_0x171ae0(0x99)]===0x0)throw new not_found_error_1[(_0x171ae0(0xab))](_0x171ae0(0xc0)+_0x256d02+_0x171ae0(0xc8));return flosum_repository_sync_dto_1[_0x171ae0(0xd7)]['fromRepositoryRecord'](_0x32932e[0x0]);}async[a186_0x2575ac(0x83)](_0x4a6a35){const _0x1c24a9=a186_0x2575ac,_0x45b9ff=await this['salesforceQuery'][_0x1c24a9(0x86)](queries_1[_0x1c24a9(0xbc)][_0x1c24a9(0x82)](_0x1c24a9(0xbb),_0x4a6a35));if(_0x45b9ff[_0x1c24a9(0x99)]===0x0)throw new not_found_error_1[(_0x1c24a9(0xab))](_0x1c24a9(0x90)+_0x4a6a35+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x1c24a9(0xd7)][_0x1c24a9(0xa2)](_0x45b9ff[0x0]);}async['getBranchRecordByName'](_0x5182f1){const _0x1f3e96=a186_0x2575ac,_0x3cd58e=await this[_0x1f3e96(0x94)][_0x1f3e96(0x86)](queries_1[_0x1f3e96(0xae)][_0x1f3e96(0x82)](_0x1f3e96(0xc1),_0x5182f1));if(_0x3cd58e['length']===0x0)throw new not_found_error_1[(_0x1f3e96(0xab))](_0x1f3e96(0x92)+_0x5182f1+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x1f3e96(0xa2)](_0x3cd58e[0x0]);}async[a186_0x2575ac(0x9a)](_0x571908){const _0x4dd39d=a186_0x2575ac,_0x20be3b=await this[_0x4dd39d(0x94)][_0x4dd39d(0x86)](queries_1[_0x4dd39d(0xa8)][_0x4dd39d(0x82)](_0x4dd39d(0xc1),_0x571908));if(_0x20be3b['length']===0x0)throw new not_found_error_1[(_0x4dd39d(0xab))]('Repository\x20'+_0x571908+_0x4dd39d(0xc8));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4dd39d(0xac)](_0x20be3b[0x0]);}async[a186_0x2575ac(0xa5)](_0x3b623c){const _0x2967a7=a186_0x2575ac,_0x503374=_0x2967a7(0xcb)+queries_1[_0x2967a7(0x9f)]+_0x2967a7(0x7f)+_0x3b623c+'\x27';return this[_0x2967a7(0xa4)](_0x503374);}async[a186_0x2575ac(0xc9)](_0x1e0767){const _0xfe1ac8=a186_0x2575ac,_0x9c08dd=_0xfe1ac8(0xb2)+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x1e0767+'\x27';return this[_0xfe1ac8(0xa4)](_0x9c08dd);}async['getAttachmentId'](_0x31c824){const _0x39a050=a186_0x2575ac;var _0x11c526;const _0x1f2871=queries_1[_0x39a050(0xcd)][_0x39a050(0x82)]('%parentId%',_0x31c824[_0x39a050(0x85)])[_0x39a050(0x82)]('%name%',_0x31c824['repositoryId']?constants_1[_0x39a050(0x93)]:constants_1[_0x39a050(0xd0)]),_0x5a621a=await this[_0x39a050(0x94)]['query'](_0x1f2871),_0x32bee9=(_0x11c526=_0x5a621a[0x0])===null||_0x11c526===void 0x0?void 0x0:_0x11c526['Id'];if(!_0x32bee9)throw new Error(errors_1[_0x39a050(0xc6)]);return _0x32bee9;}async['getRemoteStateAttachmentId'](_0x53819e){const _0xa4f2ab=a186_0x2575ac;let _0x1c648a=await this['getAttachmentId'](_0x53819e)[_0xa4f2ab(0xd4)](()=>null);return!_0x1c648a&&(_0x1c648a=await this[_0xa4f2ab(0x7e)]['createObject']('Attachment',{'Body':utils_1[_0xa4f2ab(0x84)]('{}'),'ParentId':_0x53819e[_0xa4f2ab(0x85)],'ContentType':_0xa4f2ab(0xd6),'Name':_0x53819e[_0xa4f2ab(0x91)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0xa4f2ab(0xd0)]})),_0x1c648a;}async[a186_0x2575ac(0x7c)](_0x3fb53c,_0x3d101e){const _0x2364f3=a186_0x2575ac,_0x896770=await this[_0x2364f3(0x9e)](_0x3fb53c);await this[_0x2364f3(0x7e)]['patchObject'](_0x2364f3(0xd2),_0x896770,{'Body':utils_1[_0x2364f3(0x84)](JSON[_0x2364f3(0xc2)](_0x3d101e))});}async[a186_0x2575ac(0x87)](_0x179c44,_0x2cf562){const _0x331ed4=a186_0x2575ac;await this[_0x331ed4(0x7e)]['patchObject'](_0x179c44[_0x331ed4(0x8f)],_0x179c44['objectId'],{[constants_1[_0x331ed4(0x8e)]+_0x331ed4(0x98)]:_0x2cf562});}async['disableSync'](_0x1650ed){const _0x207b8a=a186_0x2575ac;await this[_0x207b8a(0x7e)]['patchObject'](constants_1[_0x207b8a(0x8e)]+_0x207b8a(0xc4),_0x1650ed,{[constants_1[_0x207b8a(0x8e)]+_0x207b8a(0xca)]:![]});}};function a186_0xa1f9(_0x20462c,_0x562831){const _0x124c5d=a186_0x3f00();return a186_0xa1f9=function(_0x13ccab,_0xf213e6){_0x13ccab=_0x13ccab-0x7a;let _0x3f00bf=_0x124c5d[_0x13ccab];return _0x3f00bf;},a186_0xa1f9(_0x20462c,_0x562831);}SalesforceSyncService=__decorate([typedi_1[a186_0x2575ac(0xa3)](),__metadata(a186_0x2575ac(0x8c),[salesforce_query_service_1[a186_0x2575ac(0xad)],salesforce_service_1[a186_0x2575ac(0x9c)]])],SalesforceSyncService),exports[a186_0x2575ac(0x8a)]=SalesforceSyncService;