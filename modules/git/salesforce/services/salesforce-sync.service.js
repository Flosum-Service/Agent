function a280_0x10e3(_0x41446d,_0x26df28){const _0x11d07c=a280_0x5d3d();return a280_0x10e3=function(_0x338a38,_0x8e867d){_0x338a38=_0x338a38-0x160;let _0x5d3d3d=_0x11d07c[_0x338a38];return _0x5d3d3d;},a280_0x10e3(_0x41446d,_0x26df28);}const a280_0xa208db=a280_0x10e3;(function(_0x58e8b8,_0x22d0a6){const _0xaa12e7=a280_0x10e3,_0xcc52ec=_0x58e8b8();while(!![]){try{const _0x136b67=-parseInt(_0xaa12e7(0x17e))/0x1*(parseInt(_0xaa12e7(0x1bb))/0x2)+-parseInt(_0xaa12e7(0x19d))/0x3+-parseInt(_0xaa12e7(0x1ba))/0x4+parseInt(_0xaa12e7(0x1af))/0x5*(parseInt(_0xaa12e7(0x1b7))/0x6)+parseInt(_0xaa12e7(0x1a2))/0x7*(-parseInt(_0xaa12e7(0x18c))/0x8)+parseInt(_0xaa12e7(0x186))/0x9+parseInt(_0xaa12e7(0x176))/0xa;if(_0x136b67===_0x22d0a6)break;else _0xcc52ec['push'](_0xcc52ec['shift']());}catch(_0x10c442){_0xcc52ec['push'](_0xcc52ec['shift']());}}}(a280_0x5d3d,0x9546f));const a280_0x8e867d=(function(){let _0x7d1272=!![];return function(_0x234207,_0x1cf7aa){const _0x313de7=_0x7d1272?function(){if(_0x1cf7aa){const _0x5dc4c3=_0x1cf7aa['apply'](_0x234207,arguments);return _0x1cf7aa=null,_0x5dc4c3;}}:function(){};return _0x7d1272=![],_0x313de7;};}()),a280_0x338a38=a280_0x8e867d(this,function(){const _0x3220dd=a280_0x10e3;return a280_0x338a38[_0x3220dd(0x1b1)]()[_0x3220dd(0x16f)](_0x3220dd(0x1ae))['toString']()[_0x3220dd(0x18b)](a280_0x338a38)['search']('(((.+)+)+)+$');});a280_0x338a38();'use strict';var __decorate=this&&this[a280_0xa208db(0x1a8)]||function(_0x270cf7,_0x525be5,_0x2f59f9,_0x2b6cc){const _0x138c9b=a280_0xa208db;var _0x22390c=arguments[_0x138c9b(0x16a)],_0x30eabd=_0x22390c<0x3?_0x525be5:_0x2b6cc===null?_0x2b6cc=Object[_0x138c9b(0x161)](_0x525be5,_0x2f59f9):_0x2b6cc,_0x2e63e9;if(typeof Reflect===_0x138c9b(0x1b4)&&typeof Reflect[_0x138c9b(0x177)]===_0x138c9b(0x1bd))_0x30eabd=Reflect[_0x138c9b(0x177)](_0x270cf7,_0x525be5,_0x2f59f9,_0x2b6cc);else{for(var _0x44c1c4=_0x270cf7[_0x138c9b(0x16a)]-0x1;_0x44c1c4>=0x0;_0x44c1c4--)if(_0x2e63e9=_0x270cf7[_0x44c1c4])_0x30eabd=(_0x22390c<0x3?_0x2e63e9(_0x30eabd):_0x22390c>0x3?_0x2e63e9(_0x525be5,_0x2f59f9,_0x30eabd):_0x2e63e9(_0x525be5,_0x2f59f9))||_0x30eabd;}return _0x22390c>0x3&&_0x30eabd&&Object[_0x138c9b(0x1a3)](_0x525be5,_0x2f59f9,_0x30eabd),_0x30eabd;},__metadata=this&&this['__metadata']||function(_0x592dc0,_0x3206bf){const _0x5ccab1=a280_0xa208db;if(typeof Reflect==='object'&&typeof Reflect[_0x5ccab1(0x1a4)]===_0x5ccab1(0x1bd))return Reflect[_0x5ccab1(0x1a4)](_0x592dc0,_0x3206bf);};function a280_0x5d3d(){const _0x55f95b=['247098OvQtea','Name','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','1180628yjVFgz','1117238uDqzjf','disableSync','function','getComponents','getOwnPropertyDescriptor','objectType','../errors/not-found.error','design:paramtypes','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','../../../shared/utils','./salesforce.service','../dto/flosum-repository-sync.dto','SYNC_ATTACHMENT_FOR_BRANCH_NAME','length','SalesforceNotFoundError','getComponentsFromRepository','\x20not\x20found\x20on\x20salesforce','SalesforceQueryService','search','catch','\x0a\x20\x20\x20\x20\x20\x20','FlosumRepositorySyncDto','%id%','fromRepositoryRecord','FLOSUM_NAMESPACE','20386830WSIDJM','decorate','map','GET_COMPONENTS_QUERY','salesforceService','Repository__r','getAllRepositoryNames','setStatus','1KkSaTX','FLOSUM_GIT_NAMESPACE','replace','Sync_In_Progress__c','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','./salesforce-query.service','query','Components__r','3527928LRENBQ','Service','records','../../../../constants/errors','stringify','constructor','142000uIntKn','getRepositoryRecords','../../../../constants','%name%','Connection__c','Synchronization_Status__c','SalesforceSyncService','patchObject','getBranchRecord','GET_REPOSITORIES_NAMES_QUERY','encodeBase64','find','getAttachmentId','push','%parentId%','GET_REPOSITORY_QUERY','GET_REPOSITORY_BY_NAME_QUERY','2790105mWzkxA','getBranchComponents','getRepositoryRecord','getRemoteStateAttachmentId','ERR_INVALID_ATTACHMENT_ID','420gcAwdW','defineProperty','metadata','GET_BRANCH_QUERY','salesforceQuery','Attachment','__decorate','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','Branch\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getBranchRecordByName','GET_BRANCH_BY_NAME_QUERY','(((.+)+)+)+$','125smmwJt','fromBranchRecord','toString','../queries','createObject','object','objectId','Repository\x20with\x20Id\x20'];a280_0x5d3d=function(){return _0x55f95b;};return a280_0x5d3d();}Object[a280_0xa208db(0x1a3)](exports,'__esModule',{'value':!![]}),exports[a280_0xa208db(0x192)]=void 0x0;const typedi_1=require('typedi'),constants_1=require(a280_0xa208db(0x18e)),errors_1=require(a280_0xa208db(0x189)),utils_1=require(a280_0xa208db(0x166)),flosum_repository_sync_dto_1=require(a280_0xa208db(0x168)),not_found_error_1=require(a280_0xa208db(0x163)),queries_1=require(a280_0xa208db(0x1b2)),salesforce_query_service_1=require(a280_0xa208db(0x183)),salesforce_service_1=require(a280_0xa208db(0x167));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x30427c,_0x4e25b3){this['salesforceQuery']=_0x30427c,this['salesforceService']=_0x4e25b3;}async[a280_0xa208db(0x160)](_0x596c45){const _0x1e8d96=a280_0xa208db;var _0x17f4d9;const _0x3c2b43=await this[_0x1e8d96(0x1a6)]['query'](_0x596c45),_0x4d8e55=[];for(const _0x3816f8 of _0x3c2b43){const _0x4473cc=(_0x17f4d9=_0x3816f8[constants_1[_0x1e8d96(0x175)]+_0x1e8d96(0x185)])===null||_0x17f4d9===void 0x0?void 0x0:_0x17f4d9[_0x1e8d96(0x188)];_0x4473cc&&_0x4473cc[_0x1e8d96(0x16a)]&&_0x4d8e55[_0x1e8d96(0x199)](_0x4473cc[0x0]['Id']);}return _0x4d8e55;}async[a280_0xa208db(0x17c)](_0x466870){const _0x475a4b=a280_0xa208db,_0x1d1acc=await this[_0x475a4b(0x1a6)][_0x475a4b(0x184)](queries_1[_0x475a4b(0x195)]['replace'](/\%connection_id\%/g,_0x466870));return _0x1d1acc['map'](_0x59a305=>{const _0x17738f=_0x475a4b;return _0x59a305[constants_1['FLOSUM_GIT_NAMESPACE']+_0x17738f(0x17b)]?_0x59a305[constants_1['FLOSUM_GIT_NAMESPACE']+_0x17738f(0x17b)][_0x17738f(0x1b8)]:_0x59a305[_0x17738f(0x1b8)];});}async[a280_0xa208db(0x18d)](_0xd8f5f1){const _0x379c09=a280_0xa208db,_0x409cab=await this[_0x379c09(0x1a6)][_0x379c09(0x184)](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x379c09(0x180)](/\%connection_id\%/g,_0xd8f5f1));return _0x409cab['map'](_0x187ccb=>flosum_repository_sync_dto_1[_0x379c09(0x172)][_0x379c09(0x174)](_0x187ccb));}async['getBranchRecords'](_0x3e2912){const _0x125cbb=a280_0xa208db,_0x5547c9=await this[_0x125cbb(0x1a6)]['query'](queries_1['GET_WAITING_BRANCHES_QUERY'][_0x125cbb(0x180)](/%repositories_ids\%/g,_0x3e2912));return _0x5547c9[_0x125cbb(0x178)](_0x33c3e9=>flosum_repository_sync_dto_1[_0x125cbb(0x172)][_0x125cbb(0x1b0)](_0x33c3e9));}async[a280_0xa208db(0x19f)](_0x2fdeb8){const _0x1cbe4f=a280_0xa208db,_0x4b0ff4=await this['salesforceQuery'][_0x1cbe4f(0x184)](queries_1[_0x1cbe4f(0x19b)][_0x1cbe4f(0x180)](_0x1cbe4f(0x173),_0x2fdeb8));if(_0x4b0ff4[_0x1cbe4f(0x16a)]===0x0)throw new not_found_error_1[(_0x1cbe4f(0x16b))](_0x1cbe4f(0x1b6)+_0x2fdeb8+_0x1cbe4f(0x16d));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x1cbe4f(0x174)](_0x4b0ff4[0x0]);}async[a280_0xa208db(0x194)](_0x4f94c9){const _0x136759=a280_0xa208db,_0xe4b798=await this['salesforceQuery'][_0x136759(0x184)](queries_1[_0x136759(0x1a5)][_0x136759(0x180)](_0x136759(0x173),_0x4f94c9));if(_0xe4b798[_0x136759(0x16a)]===0x0)throw new not_found_error_1[(_0x136759(0x16b))]('Branch\x20with\x20Id\x20'+_0x4f94c9+_0x136759(0x16d));return flosum_repository_sync_dto_1[_0x136759(0x172)][_0x136759(0x1b0)](_0xe4b798[0x0]);}async[a280_0xa208db(0x1ac)](_0xef95a6){const _0x41b7b4=a280_0xa208db,_0x441ca0=await this[_0x41b7b4(0x1a6)]['query'](queries_1[_0x41b7b4(0x1ad)][_0x41b7b4(0x180)](_0x41b7b4(0x18f),_0xef95a6));if(_0x441ca0[_0x41b7b4(0x16a)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x41b7b4(0x1aa)+_0xef95a6+'\x20not\x20found\x20on\x20salesforce');const _0x3881ac=_0x441ca0[_0x41b7b4(0x197)](_0x156b7a=>_0x156b7a[constants_1[_0x41b7b4(0x175)]+'Branch_Name__c']===_0xef95a6);if(!_0x3881ac)throw new not_found_error_1['SalesforceNotFoundError'](_0x41b7b4(0x1aa)+_0xef95a6+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x41b7b4(0x172)][_0x41b7b4(0x1b0)](_0x3881ac);}async['getRepositoryRecordByName'](_0x1f7118){const _0x5a4c19=a280_0xa208db,_0x1005ee=await this[_0x5a4c19(0x1a6)]['query'](queries_1[_0x5a4c19(0x19c)][_0x5a4c19(0x180)](_0x5a4c19(0x18f),_0x1f7118));if(_0x1005ee['length']===0x0)throw new not_found_error_1[(_0x5a4c19(0x16b))]('Repository\x20'+_0x1f7118+_0x5a4c19(0x16d));return flosum_repository_sync_dto_1[_0x5a4c19(0x172)][_0x5a4c19(0x174)](_0x1005ee[0x0]);}async[a280_0xa208db(0x16c)](_0x549853){const _0x136802=a280_0xa208db,_0x4fd0c3=_0x136802(0x171)+queries_1[_0x136802(0x179)]+_0x136802(0x1b9)+_0x549853+'\x27';return this[_0x136802(0x160)](_0x4fd0c3);}async[a280_0xa208db(0x19e)](_0x5cb2b8){const _0x8f000f=a280_0xa208db,_0x3a75c1=_0x8f000f(0x1ab)+queries_1[_0x8f000f(0x179)]+_0x8f000f(0x182)+_0x5cb2b8+'\x27';return this[_0x8f000f(0x160)](_0x3a75c1);}async[a280_0xa208db(0x198)](_0x282c68){const _0x2ab60e=a280_0xa208db;var _0x2a8bca;const _0x263d80=queries_1[_0x2ab60e(0x165)][_0x2ab60e(0x180)](_0x2ab60e(0x19a),_0x282c68[_0x2ab60e(0x1b5)])[_0x2ab60e(0x180)](_0x2ab60e(0x18f),_0x282c68['repositoryId']?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x2ab60e(0x169)]),_0x3eaee4=await this['salesforceQuery'][_0x2ab60e(0x184)](_0x263d80),_0x18c48e=(_0x2a8bca=_0x3eaee4[0x0])===null||_0x2a8bca===void 0x0?void 0x0:_0x2a8bca['Id'];if(!_0x18c48e)throw new Error(errors_1[_0x2ab60e(0x1a1)]);return _0x18c48e;}async[a280_0xa208db(0x1a0)](_0x41e33f){const _0x4762dc=a280_0xa208db;let _0x58bdad=await this['getAttachmentId'](_0x41e33f)[_0x4762dc(0x170)](()=>null);return!_0x58bdad&&(_0x58bdad=await this[_0x4762dc(0x17a)][_0x4762dc(0x1b3)]('Attachment',{'Body':(0x0,utils_1[_0x4762dc(0x196)])('{}'),'ParentId':_0x41e33f['objectId'],'ContentType':'text/plain','Name':_0x41e33f['repositoryId']?constants_1[_0x4762dc(0x1a9)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x58bdad;}async['updateRemoteState'](_0x1a80c7,_0x5dffc7){const _0x49cd81=a280_0xa208db,_0x284df7=await this[_0x49cd81(0x1a0)](_0x1a80c7);await this[_0x49cd81(0x17a)][_0x49cd81(0x193)](_0x49cd81(0x1a7),_0x284df7,{'Body':(0x0,utils_1[_0x49cd81(0x196)])(JSON[_0x49cd81(0x18a)](_0x5dffc7))});}async[a280_0xa208db(0x17d)](_0x56481b,_0x36f833){const _0x99ce31=a280_0xa208db;await this[_0x99ce31(0x17a)][_0x99ce31(0x193)](_0x56481b[_0x99ce31(0x162)],_0x56481b['objectId'],{[constants_1[_0x99ce31(0x17f)]+_0x99ce31(0x191)]:_0x36f833});}async[a280_0xa208db(0x1bc)](_0x5a4e3d){const _0x18be58=a280_0xa208db;await this[_0x18be58(0x17a)]['patchObject'](constants_1['FLOSUM_GIT_NAMESPACE']+_0x18be58(0x190),_0x5a4e3d,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x18be58(0x181)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a280_0xa208db(0x187)])(),__metadata(a280_0xa208db(0x164),[salesforce_query_service_1[a280_0xa208db(0x16e)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports[a280_0xa208db(0x192)]=SalesforceSyncService;