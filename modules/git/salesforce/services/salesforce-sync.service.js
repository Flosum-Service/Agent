function a237_0x5eec(){const _0x423bb6=['createObject','SYNC_ATTACHMENT_FOR_BRANCH_NAME','toString','GET_WAITING_REPOSITORIES_QUERY','SalesforceNotFoundError','730056gteFki','length','fromRepositoryRecord','getComponents','SalesforceSyncService','FlosumRepositorySyncDto','typedi','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','%parentId%','query','../../../../constants','Branch\x20','getBranchRecordByName','text/plain','GET_REPOSITORY_QUERY','getBranchRecord','(((.+)+)+)+$','14261608rfIkUs','../../../shared/utils','1782788tLWMFr','getRepositoryRecords','Components__r','%id%','metadata','defineProperty','disableSync','Repository__r','3824832venjsy','constructor','design:paramtypes','__esModule','3037359Babxbm','getAttachmentId','apply','./salesforce.service','replace','GET_COMPONENTS_QUERY','Repository\x20','getBranchComponents','decorate','Attachment','2065320anmyUM','Name','Service','../../../../constants/errors','getBranchRecords','fromBranchRecord','repositoryId','GET_REPOSITORY_BY_NAME_QUERY','../dto/flosum-repository-sync.dto','__decorate','function','getRepositoryRecordByName','SalesforceQueryService','map','objectType','FLOSUM_NAMESPACE','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','Connection__c','catch','getRemoteStateAttachmentId','3vxkoTe','577462QltHht','GET_REPOSITORIES_NAMES_QUERY','getComponentsFromRepository','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','__metadata','objectId','object','Branch_Name__c','SalesforceService','\x0a\x20\x20\x20\x20\x20\x20','search','push','encodeBase64','FLOSUM_GIT_NAMESPACE','GET_BRANCH_BY_NAME_QUERY','records','patchObject','Synchronization_Status__c','setStatus','salesforceQuery','salesforceService','GET_BRANCH_QUERY','%name%','GET_WAITING_BRANCHES_QUERY','\x20not\x20found\x20on\x20salesforce','Repository\x20with\x20Id\x20','getAllRepositoryNames'];a237_0x5eec=function(){return _0x423bb6;};return a237_0x5eec();}const a237_0x43a687=a237_0x222d;(function(_0x468937,_0x5069f2){const _0x78cbef=a237_0x222d,_0x3a3ef6=_0x468937();while(!![]){try{const _0x18bcaf=-parseInt(_0x78cbef(0x1bd))/0x1*(-parseInt(_0x78cbef(0x1be))/0x2)+-parseInt(_0x78cbef(0x1fd))/0x3+-parseInt(_0x78cbef(0x1f9))/0x4+parseInt(_0x78cbef(0x1a9))/0x5+-parseInt(_0x78cbef(0x1de))/0x6+-parseInt(_0x78cbef(0x1f1))/0x7+parseInt(_0x78cbef(0x1ef))/0x8;if(_0x18bcaf===_0x5069f2)break;else _0x3a3ef6['push'](_0x3a3ef6['shift']());}catch(_0x3d7f66){_0x3a3ef6['push'](_0x3a3ef6['shift']());}}}(a237_0x5eec,0xaf089));const a237_0x27bada=(function(){let _0x197bc5=!![];return function(_0x41679b,_0x5ff2){const _0x5a836e=_0x197bc5?function(){const _0xc5c109=a237_0x222d;if(_0x5ff2){const _0x5d8267=_0x5ff2[_0xc5c109(0x1ff)](_0x41679b,arguments);return _0x5ff2=null,_0x5d8267;}}:function(){};return _0x197bc5=![],_0x5a836e;};}()),a237_0x15a419=a237_0x27bada(this,function(){const _0x4a012f=a237_0x222d;return a237_0x15a419[_0x4a012f(0x1db)]()[_0x4a012f(0x1c8)](_0x4a012f(0x1ee))['toString']()[_0x4a012f(0x1fa)](a237_0x15a419)[_0x4a012f(0x1c8)](_0x4a012f(0x1ee));});a237_0x15a419();'use strict';var __decorate=this&&this[a237_0x43a687(0x1b2)]||function(_0x5e958f,_0x43a2ee,_0x580733,_0x484c55){const _0x4bec57=a237_0x43a687;var _0x3eb30b=arguments[_0x4bec57(0x1df)],_0x2f1343=_0x3eb30b<0x3?_0x43a2ee:_0x484c55===null?_0x484c55=Object['getOwnPropertyDescriptor'](_0x43a2ee,_0x580733):_0x484c55,_0x29593b;if(typeof Reflect===_0x4bec57(0x1c4)&&typeof Reflect[_0x4bec57(0x1a7)]===_0x4bec57(0x1b3))_0x2f1343=Reflect['decorate'](_0x5e958f,_0x43a2ee,_0x580733,_0x484c55);else{for(var _0x9c54e=_0x5e958f[_0x4bec57(0x1df)]-0x1;_0x9c54e>=0x0;_0x9c54e--)if(_0x29593b=_0x5e958f[_0x9c54e])_0x2f1343=(_0x3eb30b<0x3?_0x29593b(_0x2f1343):_0x3eb30b>0x3?_0x29593b(_0x43a2ee,_0x580733,_0x2f1343):_0x29593b(_0x43a2ee,_0x580733))||_0x2f1343;}return _0x3eb30b>0x3&&_0x2f1343&&Object['defineProperty'](_0x43a2ee,_0x580733,_0x2f1343),_0x2f1343;},__metadata=this&&this[a237_0x43a687(0x1c2)]||function(_0x4b4373,_0xa7a240){const _0x49f913=a237_0x43a687;if(typeof Reflect===_0x49f913(0x1c4)&&typeof Reflect[_0x49f913(0x1f5)]===_0x49f913(0x1b3))return Reflect['metadata'](_0x4b4373,_0xa7a240);};Object[a237_0x43a687(0x1f6)](exports,a237_0x43a687(0x1fc),{'value':!![]}),exports[a237_0x43a687(0x1e2)]=void 0x0;function a237_0x222d(_0x14701f,_0x417025){const _0x4c109c=a237_0x5eec();return a237_0x222d=function(_0x15a419,_0x27bada){_0x15a419=_0x15a419-0x1a7;let _0x5eecb5=_0x4c109c[_0x15a419];return _0x5eecb5;},a237_0x222d(_0x14701f,_0x417025);}const typedi_1=require(a237_0x43a687(0x1e4)),constants_1=require(a237_0x43a687(0x1e8)),errors_1=require(a237_0x43a687(0x1ac)),utils_1=require(a237_0x43a687(0x1f0)),flosum_repository_sync_dto_1=require(a237_0x43a687(0x1b1)),not_found_error_1=require('../errors/not-found.error'),queries_1=require('../queries'),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a237_0x43a687(0x200));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x312652,_0x2a3a04){const _0xb63589=a237_0x43a687;this[_0xb63589(0x1d1)]=_0x312652,this['salesforceService']=_0x2a3a04;}async[a237_0x43a687(0x1e1)](_0xf77aa0){const _0x33ced5=a237_0x43a687;var _0x303ca0;const _0x6373bb=await this[_0x33ced5(0x1d1)][_0x33ced5(0x1e7)](_0xf77aa0),_0x1a9fea=[];for(const _0x62d30b of _0x6373bb){const _0x562b4a=(_0x303ca0=_0x62d30b[constants_1[_0x33ced5(0x1b8)]+_0x33ced5(0x1f3)])===null||_0x303ca0===void 0x0?void 0x0:_0x303ca0[_0x33ced5(0x1cd)];_0x562b4a&&_0x562b4a[_0x33ced5(0x1df)]&&_0x1a9fea[_0x33ced5(0x1c9)](_0x562b4a[0x0]['Id']);}return _0x1a9fea;}async[a237_0x43a687(0x1d8)](_0x38d789){const _0x49a2c7=a237_0x43a687,_0x2534c8=await this[_0x49a2c7(0x1d1)]['query'](queries_1[_0x49a2c7(0x1bf)][_0x49a2c7(0x201)](/\%connection_id\%/g,_0x38d789));return _0x2534c8[_0x49a2c7(0x1b6)](_0x15d265=>{const _0x476c50=_0x49a2c7;return _0x15d265[constants_1['FLOSUM_GIT_NAMESPACE']+_0x476c50(0x1f8)]?_0x15d265[constants_1[_0x476c50(0x1cb)]+_0x476c50(0x1f8)]['Name']:_0x15d265[_0x476c50(0x1aa)];});}async[a237_0x43a687(0x1f2)](_0x2ea408){const _0x3e7ee3=a237_0x43a687,_0x529260=await this[_0x3e7ee3(0x1d1)]['query'](queries_1[_0x3e7ee3(0x1dc)][_0x3e7ee3(0x201)](/\%connection_id\%/g,_0x2ea408));return _0x529260[_0x3e7ee3(0x1b6)](_0x2f2652=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x3e7ee3(0x1e0)](_0x2f2652));}async[a237_0x43a687(0x1ad)](_0x584a45){const _0x1af7a6=a237_0x43a687,_0x53da02=await this[_0x1af7a6(0x1d1)][_0x1af7a6(0x1e7)](queries_1[_0x1af7a6(0x1d5)][_0x1af7a6(0x201)](/%repositories_ids\%/g,_0x584a45));return _0x53da02['map'](_0xc8c327=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x1af7a6(0x1ae)](_0xc8c327));}async['getRepositoryRecord'](_0x47ed45){const _0x58a95e=a237_0x43a687,_0x24ad50=await this[_0x58a95e(0x1d1)][_0x58a95e(0x1e7)](queries_1[_0x58a95e(0x1ec)][_0x58a95e(0x201)](_0x58a95e(0x1f4),_0x47ed45));if(_0x24ad50[_0x58a95e(0x1df)]===0x0)throw new not_found_error_1[(_0x58a95e(0x1dd))](_0x58a95e(0x1d7)+_0x47ed45+_0x58a95e(0x1d6));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x58a95e(0x1e0)](_0x24ad50[0x0]);}async[a237_0x43a687(0x1ed)](_0x4a67f4){const _0x285531=a237_0x43a687,_0x2499f0=await this[_0x285531(0x1d1)]['query'](queries_1[_0x285531(0x1d3)][_0x285531(0x201)](_0x285531(0x1f4),_0x4a67f4));if(_0x2499f0[_0x285531(0x1df)]===0x0)throw new not_found_error_1[(_0x285531(0x1dd))]('Branch\x20with\x20Id\x20'+_0x4a67f4+_0x285531(0x1d6));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x2499f0[0x0]);}async[a237_0x43a687(0x1ea)](_0xdcc11c){const _0x4757bd=a237_0x43a687,_0x1f7049=await this[_0x4757bd(0x1d1)][_0x4757bd(0x1e7)](queries_1[_0x4757bd(0x1cc)][_0x4757bd(0x201)](_0x4757bd(0x1d4),_0xdcc11c));if(_0x1f7049['length']===0x0)throw new not_found_error_1[(_0x4757bd(0x1dd))]('Branch\x20'+_0xdcc11c+'\x20not\x20found\x20on\x20salesforce');const _0x501534=_0x1f7049['find'](_0x484861=>_0x484861[constants_1[_0x4757bd(0x1b8)]+_0x4757bd(0x1c5)]===_0xdcc11c);if(!_0x501534)throw new not_found_error_1[(_0x4757bd(0x1dd))](_0x4757bd(0x1e9)+_0xdcc11c+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x4757bd(0x1e3)][_0x4757bd(0x1ae)](_0x501534);}async[a237_0x43a687(0x1b4)](_0x3c01dc){const _0x2d5a18=a237_0x43a687,_0x5decb2=await this['salesforceQuery'][_0x2d5a18(0x1e7)](queries_1[_0x2d5a18(0x1b0)][_0x2d5a18(0x201)]('%name%',_0x3c01dc));if(_0x5decb2[_0x2d5a18(0x1df)]===0x0)throw new not_found_error_1[(_0x2d5a18(0x1dd))](_0x2d5a18(0x203)+_0x3c01dc+_0x2d5a18(0x1d6));return flosum_repository_sync_dto_1[_0x2d5a18(0x1e3)]['fromRepositoryRecord'](_0x5decb2[0x0]);}async[a237_0x43a687(0x1c0)](_0x4fe2d9){const _0x301a5d=a237_0x43a687,_0x536161=_0x301a5d(0x1c7)+queries_1[_0x301a5d(0x202)]+_0x301a5d(0x1b9)+_0x4fe2d9+'\x27';return this[_0x301a5d(0x1e1)](_0x536161);}async[a237_0x43a687(0x204)](_0x5257cd){const _0x4ca994=a237_0x43a687,_0x26a88c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+_0x4ca994(0x1e5)+_0x5257cd+'\x27';return this['getComponents'](_0x26a88c);}async[a237_0x43a687(0x1fe)](_0xf527aa){const _0x3044e5=a237_0x43a687;var _0x5a7fff;const _0x3d183f=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x3044e5(0x201)](_0x3044e5(0x1e6),_0xf527aa[_0x3044e5(0x1c3)])['replace'](_0x3044e5(0x1d4),_0xf527aa['repositoryId']?constants_1[_0x3044e5(0x1c1)]:constants_1[_0x3044e5(0x1da)]),_0x25b4c2=await this[_0x3044e5(0x1d1)][_0x3044e5(0x1e7)](_0x3d183f),_0x4563a4=(_0x5a7fff=_0x25b4c2[0x0])===null||_0x5a7fff===void 0x0?void 0x0:_0x5a7fff['Id'];if(!_0x4563a4)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x4563a4;}async[a237_0x43a687(0x1bc)](_0x134df0){const _0x38980e=a237_0x43a687;let _0x27f869=await this[_0x38980e(0x1fe)](_0x134df0)[_0x38980e(0x1bb)](()=>null);return!_0x27f869&&(_0x27f869=await this[_0x38980e(0x1d2)][_0x38980e(0x1d9)](_0x38980e(0x1a8),{'Body':(0x0,utils_1[_0x38980e(0x1ca)])('{}'),'ParentId':_0x134df0['objectId'],'ContentType':_0x38980e(0x1eb),'Name':_0x134df0[_0x38980e(0x1af)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x38980e(0x1da)]})),_0x27f869;}async['updateRemoteState'](_0x26dd27,_0xe20028){const _0x4a0d46=a237_0x43a687,_0x2b05df=await this[_0x4a0d46(0x1bc)](_0x26dd27);await this[_0x4a0d46(0x1d2)]['patchObject'](_0x4a0d46(0x1a8),_0x2b05df,{'Body':(0x0,utils_1[_0x4a0d46(0x1ca)])(JSON['stringify'](_0xe20028))});}async[a237_0x43a687(0x1d0)](_0x2454a1,_0x2bd8bc){const _0x3a99c8=a237_0x43a687;await this['salesforceService'][_0x3a99c8(0x1ce)](_0x2454a1[_0x3a99c8(0x1b7)],_0x2454a1[_0x3a99c8(0x1c3)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x3a99c8(0x1cf)]:_0x2bd8bc});}async[a237_0x43a687(0x1f7)](_0x93f8df){const _0x313ba0=a237_0x43a687;await this[_0x313ba0(0x1d2)][_0x313ba0(0x1ce)](constants_1[_0x313ba0(0x1cb)]+_0x313ba0(0x1ba),_0x93f8df,{[constants_1[_0x313ba0(0x1cb)]+'Sync_In_Progress__c']:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a237_0x43a687(0x1ab)])(),__metadata(a237_0x43a687(0x1fb),[salesforce_query_service_1[a237_0x43a687(0x1b5)],salesforce_service_1[a237_0x43a687(0x1c6)]])],SalesforceSyncService),exports[a237_0x43a687(0x1e2)]=SalesforceSyncService;