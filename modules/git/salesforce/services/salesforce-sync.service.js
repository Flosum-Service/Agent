const a281_0x421f82=a281_0x1c87;(function(_0x11c6df,_0x240969){const _0x15855d=a281_0x1c87,_0x3c413e=_0x11c6df();while(!![]){try{const _0x5e945c=-parseInt(_0x15855d(0x211))/0x1*(parseInt(_0x15855d(0x1f7))/0x2)+-parseInt(_0x15855d(0x21c))/0x3*(-parseInt(_0x15855d(0x22d))/0x4)+parseInt(_0x15855d(0x1db))/0x5+parseInt(_0x15855d(0x213))/0x6+-parseInt(_0x15855d(0x212))/0x7*(parseInt(_0x15855d(0x1f4))/0x8)+-parseInt(_0x15855d(0x1e6))/0x9+parseInt(_0x15855d(0x201))/0xa*(parseInt(_0x15855d(0x206))/0xb);if(_0x5e945c===_0x240969)break;else _0x3c413e['push'](_0x3c413e['shift']());}catch(_0x161da6){_0x3c413e['push'](_0x3c413e['shift']());}}}(a281_0x52b9,0xe14bc));const a281_0x1e624b=(function(){let _0x30e1a2=!![];return function(_0x442bf2,_0x3c9633){const _0x4d6203=_0x30e1a2?function(){const _0x565efc=a281_0x1c87;if(_0x3c9633){const _0x2ca1ac=_0x3c9633[_0x565efc(0x222)](_0x442bf2,arguments);return _0x3c9633=null,_0x2ca1ac;}}:function(){};return _0x30e1a2=![],_0x4d6203;};}()),a281_0x29beea=a281_0x1e624b(this,function(){const _0x2f0c73=a281_0x1c87;return a281_0x29beea['toString']()['search'](_0x2f0c73(0x204))[_0x2f0c73(0x1dd)]()[_0x2f0c73(0x1f3)](a281_0x29beea)[_0x2f0c73(0x1ff)](_0x2f0c73(0x204));});a281_0x29beea();function a281_0x1c87(_0x37017d,_0x527dfa){const _0x3fe524=a281_0x52b9();return a281_0x1c87=function(_0x29beea,_0x1e624b){_0x29beea=_0x29beea-0x1d3;let _0x52b9d3=_0x3fe524[_0x29beea];return _0x52b9d3;},a281_0x1c87(_0x37017d,_0x527dfa);}'use strict';var __decorate=this&&this[a281_0x421f82(0x1e1)]||function(_0x50ff53,_0x140c49,_0x43bd87,_0x55ff5e){const _0x307fda=a281_0x421f82;var _0x52c260=arguments[_0x307fda(0x1fa)],_0x42483a=_0x52c260<0x3?_0x140c49:_0x55ff5e===null?_0x55ff5e=Object[_0x307fda(0x220)](_0x140c49,_0x43bd87):_0x55ff5e,_0x28bf39;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x307fda(0x205))_0x42483a=Reflect['decorate'](_0x50ff53,_0x140c49,_0x43bd87,_0x55ff5e);else{for(var _0x10e99a=_0x50ff53[_0x307fda(0x1fa)]-0x1;_0x10e99a>=0x0;_0x10e99a--)if(_0x28bf39=_0x50ff53[_0x10e99a])_0x42483a=(_0x52c260<0x3?_0x28bf39(_0x42483a):_0x52c260>0x3?_0x28bf39(_0x140c49,_0x43bd87,_0x42483a):_0x28bf39(_0x140c49,_0x43bd87))||_0x42483a;}return _0x52c260>0x3&&_0x42483a&&Object[_0x307fda(0x20f)](_0x140c49,_0x43bd87,_0x42483a),_0x42483a;},__metadata=this&&this[a281_0x421f82(0x20a)]||function(_0x2c8aa9,_0x412fae){const _0x32544e=a281_0x421f82;if(typeof Reflect===_0x32544e(0x1ee)&&typeof Reflect['metadata']===_0x32544e(0x205))return Reflect[_0x32544e(0x1e3)](_0x2c8aa9,_0x412fae);};function a281_0x52b9(){const _0x2d0199=['design:paramtypes','getOwnPropertyDescriptor','getRemoteStateAttachmentId','apply','SalesforceSyncService','typedi','text/plain','SalesforceNotFoundError','records','__esModule','query','patchObject','Connection__c','setStatus','219440hKINRa','GET_BRANCH_QUERY','getRepositoryRecord','SalesforceQueryService','getRepositoryRecordByName','replace','%id%','objectId','./salesforce.service','Branch\x20with\x20Id\x20','82690yOglWn','FlosumRepositorySyncDto','toString','fromRepositoryRecord','stringify','getAllRepositoryNames','__decorate','Sync_In_Progress__c','metadata','Service','../dto/flosum-repository-sync.dto','6759504rgoOzf','%parentId%','Attachment','./salesforce-query.service','salesforceQuery','getComponentsFromRepository','GET_REPOSITORIES_NAMES_QUERY','../../../shared/utils','object','disableSync','GET_BRANCH_BY_NAME_QUERY','GET_REPOSITORY_BY_NAME_QUERY','../queries','constructor','5580944haQhXp','Repository__r','Name','115480GLelog','Repository\x20with\x20Id\x20','salesforceService','length','repositoryId','fromBranchRecord','../../../../constants/errors','../errors/not-found.error','search','updateRemoteState','30YhcmTL','getBranchRecords','find','(((.+)+)+)+$','function','4552097QtFcJS','encodeBase64','\x20not\x20found\x20on\x20salesforce','objectType','__metadata','%name%','push','getRepositoryRecords','getAttachmentId','defineProperty','getBranchComponents','4KgtCNX','7iWRIHV','5433282oMVlvy','FLOSUM_GIT_NAMESPACE','ERR_INVALID_ATTACHMENT_ID','SYNC_ATTACHMENT_FOR_BRANCH_NAME','getBranchRecordByName','map','SalesforceService','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','../../../../constants','24hIyqnd','FLOSUM_NAMESPACE','GET_WAITING_REPOSITORIES_QUERY'];a281_0x52b9=function(){return _0x2d0199;};return a281_0x52b9();}Object[a281_0x421f82(0x20f)](exports,a281_0x421f82(0x228),{'value':!![]}),exports[a281_0x421f82(0x223)]=void 0x0;const typedi_1=require(a281_0x421f82(0x224)),constants_1=require(a281_0x421f82(0x21b)),errors_1=require(a281_0x421f82(0x1fd)),utils_1=require(a281_0x421f82(0x1ed)),flosum_repository_sync_dto_1=require(a281_0x421f82(0x1e5)),not_found_error_1=require(a281_0x421f82(0x1fe)),queries_1=require(a281_0x421f82(0x1f2)),salesforce_query_service_1=require(a281_0x421f82(0x1e9)),salesforce_service_1=require(a281_0x421f82(0x1d9));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x4229a3,_0x1b5ec3){const _0x478634=a281_0x421f82;this['salesforceQuery']=_0x4229a3,this[_0x478634(0x1f9)]=_0x1b5ec3;}async['getComponents'](_0xba4e7c){const _0x49a70=a281_0x421f82;var _0x34dc57;const _0x268028=await this['salesforceQuery'][_0x49a70(0x229)](_0xba4e7c),_0x33ffbd=[];for(const _0x4a2b17 of _0x268028){const _0x4e8c3a=(_0x34dc57=_0x4a2b17[constants_1['FLOSUM_NAMESPACE']+'Components__r'])===null||_0x34dc57===void 0x0?void 0x0:_0x34dc57[_0x49a70(0x227)];_0x4e8c3a&&_0x4e8c3a['length']&&_0x33ffbd[_0x49a70(0x20c)](_0x4e8c3a[0x0]['Id']);}return _0x33ffbd;}async[a281_0x421f82(0x1e0)](_0xad9939){const _0x5d66dc=a281_0x421f82,_0x182331=await this[_0x5d66dc(0x1ea)][_0x5d66dc(0x229)](queries_1[_0x5d66dc(0x1ec)]['replace'](/\%connection_id\%/g,_0xad9939));return _0x182331[_0x5d66dc(0x218)](_0x4c49fb=>{const _0x2359f1=_0x5d66dc;return _0x4c49fb[constants_1[_0x2359f1(0x214)]+_0x2359f1(0x1f5)]?_0x4c49fb[constants_1['FLOSUM_GIT_NAMESPACE']+'Repository__r'][_0x2359f1(0x1f6)]:_0x4c49fb[_0x2359f1(0x1f6)];});}async[a281_0x421f82(0x20d)](_0x4ea71f){const _0x115054=a281_0x421f82,_0x3c1586=await this[_0x115054(0x1ea)][_0x115054(0x229)](queries_1[_0x115054(0x21e)][_0x115054(0x1d6)](/\%connection_id\%/g,_0x4ea71f));return _0x3c1586[_0x115054(0x218)](_0x510839=>flosum_repository_sync_dto_1[_0x115054(0x1dc)][_0x115054(0x1de)](_0x510839));}async[a281_0x421f82(0x202)](_0x4fb85a){const _0x4d0269=a281_0x421f82,_0x479354=await this[_0x4d0269(0x1ea)]['query'](queries_1['GET_WAITING_BRANCHES_QUERY']['replace'](/%repositories_ids\%/g,_0x4fb85a));return _0x479354[_0x4d0269(0x218)](_0x2bb706=>flosum_repository_sync_dto_1[_0x4d0269(0x1dc)][_0x4d0269(0x1fc)](_0x2bb706));}async[a281_0x421f82(0x1d3)](_0x3d64c1){const _0x43ae8d=a281_0x421f82,_0x9cd3b9=await this[_0x43ae8d(0x1ea)]['query'](queries_1['GET_REPOSITORY_QUERY'][_0x43ae8d(0x1d6)](_0x43ae8d(0x1d7),_0x3d64c1));if(_0x9cd3b9[_0x43ae8d(0x1fa)]===0x0)throw new not_found_error_1[(_0x43ae8d(0x226))](_0x43ae8d(0x1f8)+_0x3d64c1+_0x43ae8d(0x208));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromRepositoryRecord'](_0x9cd3b9[0x0]);}async['getBranchRecord'](_0x5eb701){const _0x4fc7f3=a281_0x421f82,_0x35e887=await this[_0x4fc7f3(0x1ea)][_0x4fc7f3(0x229)](queries_1[_0x4fc7f3(0x22e)][_0x4fc7f3(0x1d6)](_0x4fc7f3(0x1d7),_0x5eb701));if(_0x35e887['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x4fc7f3(0x1da)+_0x5eb701+_0x4fc7f3(0x208));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x35e887[0x0]);}async[a281_0x421f82(0x217)](_0x5c8627){const _0x254532=a281_0x421f82,_0x1091c2=await this[_0x254532(0x1ea)][_0x254532(0x229)](queries_1[_0x254532(0x1f0)][_0x254532(0x1d6)](_0x254532(0x20b),_0x5c8627));if(_0x1091c2[_0x254532(0x1fa)]===0x0)throw new not_found_error_1[(_0x254532(0x226))]('Branch\x20'+_0x5c8627+_0x254532(0x208));const _0x45de52=_0x1091c2[_0x254532(0x203)](_0x2d0bb6=>_0x2d0bb6[constants_1[_0x254532(0x21d)]+'Branch_Name__c']===_0x5c8627);if(!_0x45de52)throw new not_found_error_1[(_0x254532(0x226))]('Branch\x20'+_0x5c8627+_0x254532(0x208));return flosum_repository_sync_dto_1[_0x254532(0x1dc)][_0x254532(0x1fc)](_0x45de52);}async[a281_0x421f82(0x1d5)](_0xad16ba){const _0x21baa8=a281_0x421f82,_0x5c76ca=await this[_0x21baa8(0x1ea)][_0x21baa8(0x229)](queries_1[_0x21baa8(0x1f1)][_0x21baa8(0x1d6)](_0x21baa8(0x20b),_0xad16ba));if(_0x5c76ca[_0x21baa8(0x1fa)]===0x0)throw new not_found_error_1[(_0x21baa8(0x226))]('Repository\x20'+_0xad16ba+_0x21baa8(0x208));return flosum_repository_sync_dto_1[_0x21baa8(0x1dc)]['fromRepositoryRecord'](_0x5c76ca[0x0]);}async[a281_0x421f82(0x1eb)](_0x5f4c32){const _0x126616='\x0a\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x5f4c32+'\x27';return this['getComponents'](_0x126616);}async[a281_0x421f82(0x210)](_0x56e3b2){const _0x1468fc=a281_0x421f82,_0x5ad4ce='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+_0x1468fc(0x21a)+_0x56e3b2+'\x27';return this['getComponents'](_0x5ad4ce);}async['getAttachmentId'](_0x3d8e29){const _0x3c49d2=a281_0x421f82;var _0x355e38;const _0x18af33=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x3c49d2(0x1d6)](_0x3c49d2(0x1e7),_0x3d8e29[_0x3c49d2(0x1d8)])[_0x3c49d2(0x1d6)](_0x3c49d2(0x20b),_0x3d8e29[_0x3c49d2(0x1fb)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x1d6ecb=await this['salesforceQuery'][_0x3c49d2(0x229)](_0x18af33),_0x6c896e=(_0x355e38=_0x1d6ecb[0x0])===null||_0x355e38===void 0x0?void 0x0:_0x355e38['Id'];if(!_0x6c896e)throw new Error(errors_1[_0x3c49d2(0x215)]);return _0x6c896e;}async[a281_0x421f82(0x221)](_0x2b767b){const _0x59315b=a281_0x421f82;let _0x121494=await this[_0x59315b(0x20e)](_0x2b767b)['catch'](()=>null);return!_0x121494&&(_0x121494=await this['salesforceService']['createObject'](_0x59315b(0x1e8),{'Body':(0x0,utils_1[_0x59315b(0x207)])('{}'),'ParentId':_0x2b767b[_0x59315b(0x1d8)],'ContentType':_0x59315b(0x225),'Name':_0x2b767b[_0x59315b(0x1fb)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x59315b(0x216)]})),_0x121494;}async[a281_0x421f82(0x200)](_0x598557,_0x1f33ee){const _0x23949f=a281_0x421f82,_0x447ad0=await this['getRemoteStateAttachmentId'](_0x598557);await this[_0x23949f(0x1f9)][_0x23949f(0x22a)](_0x23949f(0x1e8),_0x447ad0,{'Body':(0x0,utils_1[_0x23949f(0x207)])(JSON[_0x23949f(0x1df)](_0x1f33ee))});}async[a281_0x421f82(0x22c)](_0xeb7dc4,_0x1e97cc){const _0x2efc15=a281_0x421f82;await this[_0x2efc15(0x1f9)]['patchObject'](_0xeb7dc4[_0x2efc15(0x209)],_0xeb7dc4[_0x2efc15(0x1d8)],{[constants_1[_0x2efc15(0x214)]+'Synchronization_Status__c']:_0x1e97cc});}async[a281_0x421f82(0x1ef)](_0x587871){const _0x5e8423=a281_0x421f82;await this[_0x5e8423(0x1f9)][_0x5e8423(0x22a)](constants_1[_0x5e8423(0x214)]+_0x5e8423(0x22b),_0x587871,{[constants_1[_0x5e8423(0x214)]+_0x5e8423(0x1e2)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a281_0x421f82(0x1e4)])(),__metadata(a281_0x421f82(0x21f),[salesforce_query_service_1[a281_0x421f82(0x1d4)],salesforce_service_1[a281_0x421f82(0x219)]])],SalesforceSyncService),exports[a281_0x421f82(0x223)]=SalesforceSyncService;