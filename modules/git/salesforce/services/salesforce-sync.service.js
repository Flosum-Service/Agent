const a243_0x4701a4=a243_0x5044;(function(_0x4df5d0,_0x4d02bb){const _0x58abce=a243_0x5044,_0x3ded23=_0x4df5d0();while(!![]){try{const _0x505592=parseInt(_0x58abce(0x173))/0x1+-parseInt(_0x58abce(0x182))/0x2*(parseInt(_0x58abce(0x1a1))/0x3)+parseInt(_0x58abce(0x176))/0x4*(-parseInt(_0x58abce(0x18d))/0x5)+-parseInt(_0x58abce(0x1b7))/0x6+parseInt(_0x58abce(0x195))/0x7*(-parseInt(_0x58abce(0x1af))/0x8)+-parseInt(_0x58abce(0x1b6))/0x9+parseInt(_0x58abce(0x1cd))/0xa*(parseInt(_0x58abce(0x17b))/0xb);if(_0x505592===_0x4d02bb)break;else _0x3ded23['push'](_0x3ded23['shift']());}catch(_0x1290ad){_0x3ded23['push'](_0x3ded23['shift']());}}}(a243_0x202c,0x2c063));function a243_0x202c(){const _0x2ceecf=['getComponentsFromRepository','salesforceService','SYNC_ATTACHMENT_FOR_BRANCH_NAME','query','%name%','15HGEuhl','stringify','push','\x0a\x20\x20\x20\x20\x20\x20','apply','../../../../constants/errors','GET_COMPONENTS_QUERY','getRemoteStateAttachmentId','objectId','map','getRepositoryRecords','FLOSUM_NAMESPACE','GET_WAITING_REPOSITORIES_QUERY','function','16BIlyIK','metadata','design:paramtypes','constructor','length','Repository__r','__decorate','544662VlsVPv','807300ufwZQX','text/plain','FlosumRepositorySyncDto','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','createObject','getComponents','getBranchComponents','GET_BRANCH_QUERY','../dto/flosum-repository-sync.dto','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','GET_REPOSITORY_QUERY','%id%','Branch_Name__c','getRepositoryRecord','defineProperty','./salesforce.service','objectType','getAttachmentId','typedi','__metadata','(((.+)+)+)+$','getAllRepositoryNames','10GxIyWh','__esModule','Attachment','disableSync','175033mDeifo','replace','fromBranchRecord','8qjMLEq','../queries','%parentId%','\x20not\x20found\x20on\x20salesforce','find','6119531WSiZbN','records','SalesforceQueryService','ERR_INVALID_ATTACHMENT_ID','GET_REPOSITORIES_NAMES_QUERY','catch','../../../../constants','67582MdoAar','Components__r','patchObject','Branch\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','Branch\x20with\x20Id\x20','getBranchRecords','toString','salesforceQuery','fromRepositoryRecord','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','373635zPfDai','setStatus','object','repositoryId','SalesforceSyncService','decorate','search','getOwnPropertyDescriptor','131439fAJYfa','getBranchRecord','SalesforceNotFoundError','../../../shared/utils','getBranchRecordByName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','SalesforceService'];a243_0x202c=function(){return _0x2ceecf;};return a243_0x202c();}const a243_0x1e3578=(function(){let _0x3f0928=!![];return function(_0x1d5ad9,_0x183505){const _0x1d3c87=_0x3f0928?function(){const _0x4cf6d9=a243_0x5044;if(_0x183505){const _0x7c2d06=_0x183505[_0x4cf6d9(0x1a5)](_0x1d5ad9,arguments);return _0x183505=null,_0x7c2d06;}}:function(){};return _0x3f0928=![],_0x1d3c87;};}()),a243_0x248809=a243_0x1e3578(this,function(){const _0x584555=a243_0x5044;return a243_0x248809[_0x584555(0x189)]()[_0x584555(0x193)](_0x584555(0x1cb))[_0x584555(0x189)]()[_0x584555(0x1b2)](a243_0x248809)[_0x584555(0x193)](_0x584555(0x1cb));});a243_0x248809();'use strict';var __decorate=this&&this[a243_0x4701a4(0x1b5)]||function(_0x22f7a1,_0x2aa725,_0x25ff40,_0x2f38d6){const _0x6fa1d8=a243_0x4701a4;var _0x22f823=arguments['length'],_0x585b31=_0x22f823<0x3?_0x2aa725:_0x2f38d6===null?_0x2f38d6=Object[_0x6fa1d8(0x194)](_0x2aa725,_0x25ff40):_0x2f38d6,_0x5e4e2;if(typeof Reflect==='object'&&typeof Reflect[_0x6fa1d8(0x192)]===_0x6fa1d8(0x1ae))_0x585b31=Reflect['decorate'](_0x22f7a1,_0x2aa725,_0x25ff40,_0x2f38d6);else{for(var _0x5ee82e=_0x22f7a1[_0x6fa1d8(0x1b3)]-0x1;_0x5ee82e>=0x0;_0x5ee82e--)if(_0x5e4e2=_0x22f7a1[_0x5ee82e])_0x585b31=(_0x22f823<0x3?_0x5e4e2(_0x585b31):_0x22f823>0x3?_0x5e4e2(_0x2aa725,_0x25ff40,_0x585b31):_0x5e4e2(_0x2aa725,_0x25ff40))||_0x585b31;}return _0x22f823>0x3&&_0x585b31&&Object[_0x6fa1d8(0x1c5)](_0x2aa725,_0x25ff40,_0x585b31),_0x585b31;},__metadata=this&&this[a243_0x4701a4(0x1ca)]||function(_0x442bb8,_0x4b812f){const _0x32ae1c=a243_0x4701a4;if(typeof Reflect===_0x32ae1c(0x18f)&&typeof Reflect[_0x32ae1c(0x1b0)]==='function')return Reflect[_0x32ae1c(0x1b0)](_0x442bb8,_0x4b812f);};Object[a243_0x4701a4(0x1c5)](exports,a243_0x4701a4(0x1ce),{'value':!![]}),exports[a243_0x4701a4(0x191)]=void 0x0;const typedi_1=require(a243_0x4701a4(0x1c9)),constants_1=require(a243_0x4701a4(0x181)),errors_1=require(a243_0x4701a4(0x1a6)),utils_1=require(a243_0x4701a4(0x198)),flosum_repository_sync_dto_1=require(a243_0x4701a4(0x1bf)),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a243_0x4701a4(0x177)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a243_0x4701a4(0x1c6));function a243_0x5044(_0x1b95f1,_0x827718){const _0x3313ad=a243_0x202c();return a243_0x5044=function(_0x248809,_0x1e3578){_0x248809=_0x248809-0x171;let _0x202c10=_0x3313ad[_0x248809];return _0x202c10;},a243_0x5044(_0x1b95f1,_0x827718);}let SalesforceSyncService=class SalesforceSyncService{constructor(_0x1c670e,_0x16837c){const _0x4ab947=a243_0x4701a4;this[_0x4ab947(0x18a)]=_0x1c670e,this[_0x4ab947(0x19d)]=_0x16837c;}async[a243_0x4701a4(0x1bc)](_0x105dfc){const _0x318150=a243_0x4701a4;var _0x39343c;const _0x2502f3=await this['salesforceQuery'][_0x318150(0x19f)](_0x105dfc),_0x56e61b=[];for(const _0x2d2f68 of _0x2502f3){const _0x6eb7a0=(_0x39343c=_0x2d2f68[constants_1['FLOSUM_NAMESPACE']+_0x318150(0x183)])===null||_0x39343c===void 0x0?void 0x0:_0x39343c[_0x318150(0x17c)];_0x6eb7a0&&_0x6eb7a0[_0x318150(0x1b3)]&&_0x56e61b[_0x318150(0x1a3)](_0x6eb7a0[0x0]['Id']);}return _0x56e61b;}async[a243_0x4701a4(0x1cc)](_0x542c5a){const _0x183300=a243_0x4701a4,_0x5946a0=await this['salesforceQuery'][_0x183300(0x19f)](queries_1[_0x183300(0x17f)][_0x183300(0x174)](/\%connection_id\%/g,_0x542c5a));return _0x5946a0[_0x183300(0x1aa)](_0x4d284e=>{const _0x300167=_0x183300;return _0x4d284e[constants_1['FLOSUM_GIT_NAMESPACE']+_0x300167(0x1b4)]?_0x4d284e[constants_1['FLOSUM_GIT_NAMESPACE']+'Repository__r']['Name']:_0x4d284e['Name'];});}async[a243_0x4701a4(0x1ab)](_0x42e53b){const _0x2c1dcc=a243_0x4701a4,_0x2adee4=await this[_0x2c1dcc(0x18a)]['query'](queries_1[_0x2c1dcc(0x1ad)][_0x2c1dcc(0x174)](/\%connection_id\%/g,_0x42e53b));return _0x2adee4[_0x2c1dcc(0x1aa)](_0x2fd911=>flosum_repository_sync_dto_1[_0x2c1dcc(0x1b9)][_0x2c1dcc(0x18b)](_0x2fd911));}async[a243_0x4701a4(0x188)](_0x536ad8){const _0x3d9106=a243_0x4701a4,_0x4847da=await this[_0x3d9106(0x18a)][_0x3d9106(0x19f)](queries_1['GET_WAITING_BRANCHES_QUERY']['replace'](/%repositories_ids\%/g,_0x536ad8));return _0x4847da[_0x3d9106(0x1aa)](_0x172c0b=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x3d9106(0x175)](_0x172c0b));}async[a243_0x4701a4(0x1c4)](_0x39aad1){const _0x3aa83c=a243_0x4701a4,_0x7c10a0=await this[_0x3aa83c(0x18a)]['query'](queries_1[_0x3aa83c(0x1c1)]['replace'](_0x3aa83c(0x1c2),_0x39aad1));if(_0x7c10a0[_0x3aa83c(0x1b3)]===0x0)throw new not_found_error_1[(_0x3aa83c(0x197))]('Repository\x20with\x20Id\x20'+_0x39aad1+_0x3aa83c(0x179));return flosum_repository_sync_dto_1[_0x3aa83c(0x1b9)][_0x3aa83c(0x18b)](_0x7c10a0[0x0]);}async[a243_0x4701a4(0x196)](_0x18dea1){const _0x3d12d8=a243_0x4701a4,_0x3ef9c3=await this[_0x3d12d8(0x18a)][_0x3d12d8(0x19f)](queries_1[_0x3d12d8(0x1be)]['replace'](_0x3d12d8(0x1c2),_0x18dea1));if(_0x3ef9c3[_0x3d12d8(0x1b3)]===0x0)throw new not_found_error_1[(_0x3d12d8(0x197))](_0x3d12d8(0x187)+_0x18dea1+_0x3d12d8(0x179));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x3ef9c3[0x0]);}async[a243_0x4701a4(0x199)](_0x44a237){const _0x538dba=a243_0x4701a4,_0x523667=await this[_0x538dba(0x18a)]['query'](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x538dba(0x174)](_0x538dba(0x1a0),_0x44a237));if(_0x523667[_0x538dba(0x1b3)]===0x0)throw new not_found_error_1[(_0x538dba(0x197))](_0x538dba(0x185)+_0x44a237+_0x538dba(0x179));const _0x42e1c5=_0x523667[_0x538dba(0x17a)](_0x552919=>_0x552919[constants_1[_0x538dba(0x1ac)]+_0x538dba(0x1c3)]===_0x44a237);if(!_0x42e1c5)throw new not_found_error_1['SalesforceNotFoundError'](_0x538dba(0x185)+_0x44a237+_0x538dba(0x179));return flosum_repository_sync_dto_1[_0x538dba(0x1b9)][_0x538dba(0x175)](_0x42e1c5);}async['getRepositoryRecordByName'](_0x4b2898){const _0x1248c6=a243_0x4701a4,_0x17bc60=await this['salesforceQuery'][_0x1248c6(0x19f)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x1248c6(0x174)](_0x1248c6(0x1a0),_0x4b2898));if(_0x17bc60['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Repository\x20'+_0x4b2898+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x1248c6(0x1b9)][_0x1248c6(0x18b)](_0x17bc60[0x0]);}async[a243_0x4701a4(0x19c)](_0x1e1b14){const _0xfe490d=a243_0x4701a4,_0x273bb9=_0xfe490d(0x1a4)+queries_1['GET_COMPONENTS_QUERY']+_0xfe490d(0x1ba)+_0x1e1b14+'\x27';return this['getComponents'](_0x273bb9);}async[a243_0x4701a4(0x1bd)](_0x3ca391){const _0x5f1a54=a243_0x4701a4,_0x4daa77=_0x5f1a54(0x19a)+queries_1[_0x5f1a54(0x1a7)]+_0x5f1a54(0x186)+_0x3ca391+'\x27';return this[_0x5f1a54(0x1bc)](_0x4daa77);}async['getAttachmentId'](_0x1429a1){const _0x32c31c=a243_0x4701a4;var _0x4fb273;const _0x2ebf67=queries_1[_0x32c31c(0x1c0)]['replace'](_0x32c31c(0x178),_0x1429a1[_0x32c31c(0x1a9)])[_0x32c31c(0x174)](_0x32c31c(0x1a0),_0x1429a1['repositoryId']?constants_1[_0x32c31c(0x18c)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x459856=await this[_0x32c31c(0x18a)][_0x32c31c(0x19f)](_0x2ebf67),_0x3dde5f=(_0x4fb273=_0x459856[0x0])===null||_0x4fb273===void 0x0?void 0x0:_0x4fb273['Id'];if(!_0x3dde5f)throw new Error(errors_1[_0x32c31c(0x17e)]);return _0x3dde5f;}async[a243_0x4701a4(0x1a8)](_0x2166ec){const _0x3c47fe=a243_0x4701a4;let _0x4e5976=await this[_0x3c47fe(0x1c8)](_0x2166ec)[_0x3c47fe(0x180)](()=>null);return!_0x4e5976&&(_0x4e5976=await this[_0x3c47fe(0x19d)][_0x3c47fe(0x1bb)](_0x3c47fe(0x171),{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x2166ec[_0x3c47fe(0x1a9)],'ContentType':_0x3c47fe(0x1b8),'Name':_0x2166ec[_0x3c47fe(0x190)]?constants_1[_0x3c47fe(0x18c)]:constants_1[_0x3c47fe(0x19e)]})),_0x4e5976;}async['updateRemoteState'](_0x4b9ff8,_0x5e664b){const _0x3ad620=a243_0x4701a4,_0x814abd=await this[_0x3ad620(0x1a8)](_0x4b9ff8);await this[_0x3ad620(0x19d)][_0x3ad620(0x184)]('Attachment',_0x814abd,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x3ad620(0x1a2)](_0x5e664b))});}async[a243_0x4701a4(0x18e)](_0x489151,_0x2560c5){const _0x2d15fc=a243_0x4701a4;await this[_0x2d15fc(0x19d)][_0x2d15fc(0x184)](_0x489151[_0x2d15fc(0x1c7)],_0x489151[_0x2d15fc(0x1a9)],{[constants_1['FLOSUM_GIT_NAMESPACE']+'Synchronization_Status__c']:_0x2560c5});}async[a243_0x4701a4(0x172)](_0xe87fbe){const _0x4dcb7a=a243_0x4701a4;await this[_0x4dcb7a(0x19d)]['patchObject'](constants_1['FLOSUM_GIT_NAMESPACE']+'Connection__c',_0xe87fbe,{[constants_1['FLOSUM_GIT_NAMESPACE']+'Sync_In_Progress__c']:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a243_0x4701a4(0x1b1),[salesforce_query_service_1[a243_0x4701a4(0x17d)],salesforce_service_1[a243_0x4701a4(0x19b)]])],SalesforceSyncService),exports[a243_0x4701a4(0x191)]=SalesforceSyncService;