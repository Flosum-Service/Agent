function a203_0x41db(_0x201a32,_0x3acf73){const _0x3f3956=a203_0x5505();return a203_0x41db=function(_0xb0bc7b,_0x536bb9){_0xb0bc7b=_0xb0bc7b-0x189;let _0x55055c=_0x3f3956[_0xb0bc7b];return _0x55055c;},a203_0x41db(_0x201a32,_0x3acf73);}function a203_0x5505(){const _0x3b1412=['apply','GET_BRANCH_BY_NAME_QUERY','Attachment','defineProperty','GET_WAITING_BRANCHES_QUERY','repositoryId','4CrmTOs','%name%','%id%','stringify','getComponents','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','__decorate','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','push','SalesforceNotFoundError','../../../../constants/errors','FLOSUM_GIT_NAMESPACE','ERR_INVALID_ATTACHMENT_ID','SalesforceService','getRepositoryRecordByName','699423HihwgI','__esModule','getRemoteStateAttachmentId','replace','query','Repository\x20with\x20Id\x20','Branch_Name__c','\x20not\x20found\x20on\x20salesforce','getOwnPropertyDescriptor','2509094gNwZZD','getRepositoryRecord','../queries','40104HwrqCk','../../../shared/utils','Repository__r','Branch\x20','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','length','getRepositoryRecords','objectId','__metadata','toString','updateRemoteState','GET_WAITING_REPOSITORIES_QUERY','salesforceService','FlosumRepositorySyncDto','design:paramtypes','189812VuKArq','(((.+)+)+)+$','patchObject','createObject','decorate','getBranchRecordByName','getAttachmentId','function','metadata','SYNC_ATTACHMENT_FOR_BRANCH_NAME','objectType','GET_COMPONENTS_QUERY','search','map','Sync_In_Progress__c','SalesforceSyncService','FLOSUM_NAMESPACE','records','1341UIjYwE','Repository\x20','fromRepositoryRecord','GET_REPOSITORIES_NAMES_QUERY','%parentId%','salesforceQuery','object','Branch\x20with\x20Id\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','GET_BRANCH_QUERY','../../../../constants','1674816XQeEwa','1895540WTSRrq','Name','fromBranchRecord','encodeBase64','Components__r','412464NlBorQ'];a203_0x5505=function(){return _0x3b1412;};return a203_0x5505();}const a203_0x5319b5=a203_0x41db;(function(_0x159cc8,_0x3d750e){const _0x31f2a5=a203_0x41db,_0x1e87c9=_0x159cc8();while(!![]){try{const _0xd7a018=parseInt(_0x31f2a5(0x1a5))/0x1+-parseInt(_0x31f2a5(0x1c8))/0x2+-parseInt(_0x31f2a5(0x18a))/0x3+parseInt(_0x31f2a5(0x1cf))/0x4*(-parseInt(_0x31f2a5(0x1c3))/0x5)+-parseInt(_0x31f2a5(0x1c2))/0x6+parseInt(_0x31f2a5(0x193))/0x7+parseInt(_0x31f2a5(0x196))/0x8*(parseInt(_0x31f2a5(0x1b7))/0x9);if(_0xd7a018===_0x3d750e)break;else _0x1e87c9['push'](_0x1e87c9['shift']());}catch(_0x1087e4){_0x1e87c9['push'](_0x1e87c9['shift']());}}}(a203_0x5505,0x303c6));const a203_0x536bb9=(function(){let _0x37cfc6=!![];return function(_0x1eb843,_0x1a6562){const _0x2728e7=_0x37cfc6?function(){const _0x304b9d=a203_0x41db;if(_0x1a6562){const _0x1af93c=_0x1a6562[_0x304b9d(0x1c9)](_0x1eb843,arguments);return _0x1a6562=null,_0x1af93c;}}:function(){};return _0x37cfc6=![],_0x2728e7;};}()),a203_0xb0bc7b=a203_0x536bb9(this,function(){const _0x582e76=a203_0x41db;return a203_0xb0bc7b['toString']()[_0x582e76(0x1b1)]('(((.+)+)+)+$')[_0x582e76(0x19f)]()['constructor'](a203_0xb0bc7b)[_0x582e76(0x1b1)](_0x582e76(0x1a6));});a203_0xb0bc7b();'use strict';var __decorate=this&&this[a203_0x5319b5(0x1d5)]||function(_0x4c60db,_0x3ee11b,_0x2f9932,_0x17bb37){const _0x49c7af=a203_0x5319b5;var _0x2a9862=arguments[_0x49c7af(0x19b)],_0x4d8c74=_0x2a9862<0x3?_0x3ee11b:_0x17bb37===null?_0x17bb37=Object[_0x49c7af(0x192)](_0x3ee11b,_0x2f9932):_0x17bb37,_0x2b83da;if(typeof Reflect===_0x49c7af(0x1bd)&&typeof Reflect[_0x49c7af(0x1a9)]==='function')_0x4d8c74=Reflect[_0x49c7af(0x1a9)](_0x4c60db,_0x3ee11b,_0x2f9932,_0x17bb37);else{for(var _0x411744=_0x4c60db['length']-0x1;_0x411744>=0x0;_0x411744--)if(_0x2b83da=_0x4c60db[_0x411744])_0x4d8c74=(_0x2a9862<0x3?_0x2b83da(_0x4d8c74):_0x2a9862>0x3?_0x2b83da(_0x3ee11b,_0x2f9932,_0x4d8c74):_0x2b83da(_0x3ee11b,_0x2f9932))||_0x4d8c74;}return _0x2a9862>0x3&&_0x4d8c74&&Object[_0x49c7af(0x1cc)](_0x3ee11b,_0x2f9932,_0x4d8c74),_0x4d8c74;},__metadata=this&&this[a203_0x5319b5(0x19e)]||function(_0x2be877,_0x4b3721){const _0x2dadae=a203_0x5319b5;if(typeof Reflect===_0x2dadae(0x1bd)&&typeof Reflect[_0x2dadae(0x1ad)]===_0x2dadae(0x1ac))return Reflect[_0x2dadae(0x1ad)](_0x2be877,_0x4b3721);};Object['defineProperty'](exports,a203_0x5319b5(0x18b),{'value':!![]}),exports[a203_0x5319b5(0x1b4)]=void 0x0;const typedi_1=require('typedi'),constants_1=require(a203_0x5319b5(0x1c1)),errors_1=require(a203_0x5319b5(0x1d9)),utils_1=require(a203_0x5319b5(0x197)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a203_0x5319b5(0x195)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0x16fc53,_0x5ddfdd){const _0x4df69e=a203_0x5319b5;this['salesforceQuery']=_0x16fc53,this[_0x4df69e(0x1a2)]=_0x5ddfdd;}async[a203_0x5319b5(0x1d3)](_0x15fe48){const _0x1ff6aa=a203_0x5319b5;var _0xb9a735;const _0x43dde1=await this['salesforceQuery']['query'](_0x15fe48),_0x1ac44b=[];for(const _0x297c84 of _0x43dde1){const _0xc1a750=(_0xb9a735=_0x297c84[constants_1[_0x1ff6aa(0x1b5)]+_0x1ff6aa(0x1c7)])===null||_0xb9a735===void 0x0?void 0x0:_0xb9a735[_0x1ff6aa(0x1b6)];_0xc1a750&&_0xc1a750[_0x1ff6aa(0x19b)]&&_0x1ac44b[_0x1ff6aa(0x1d7)](_0xc1a750[0x0]['Id']);}return _0x1ac44b;}async['getAllRepositoryNames'](_0x5048c1){const _0x387645=a203_0x5319b5,_0x533f6b=await this[_0x387645(0x1bc)][_0x387645(0x18e)](queries_1[_0x387645(0x1ba)][_0x387645(0x18d)](/\%connection_id\%/g,_0x5048c1));return _0x533f6b[_0x387645(0x1b2)](_0x5ef3d7=>{const _0x1f2035=_0x387645;return _0x5ef3d7[constants_1[_0x1f2035(0x1da)]+'Repository__r']?_0x5ef3d7[constants_1[_0x1f2035(0x1da)]+_0x1f2035(0x198)][_0x1f2035(0x1c4)]:_0x5ef3d7['Name'];});}async[a203_0x5319b5(0x19c)](_0x950054){const _0x5bbfdf=a203_0x5319b5,_0x4292f7=await this['salesforceQuery']['query'](queries_1[_0x5bbfdf(0x1a1)][_0x5bbfdf(0x18d)](/\%connection_id\%/g,_0x950054));return _0x4292f7[_0x5bbfdf(0x1b2)](_0x391bec=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x5bbfdf(0x1b9)](_0x391bec));}async['getBranchRecords'](_0x573b06){const _0x39d9c8=a203_0x5319b5,_0x450ec1=await this['salesforceQuery'][_0x39d9c8(0x18e)](queries_1[_0x39d9c8(0x1cd)][_0x39d9c8(0x18d)](/%repositories_ids\%/g,_0x573b06));return _0x450ec1[_0x39d9c8(0x1b2)](_0x4fc201=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x39d9c8(0x1c5)](_0x4fc201));}async[a203_0x5319b5(0x194)](_0x5b8bc6){const _0x3eb3c0=a203_0x5319b5,_0x1bdae7=await this[_0x3eb3c0(0x1bc)][_0x3eb3c0(0x18e)](queries_1['GET_REPOSITORY_QUERY'][_0x3eb3c0(0x18d)](_0x3eb3c0(0x1d1),_0x5b8bc6));if(_0x1bdae7['length']===0x0)throw new not_found_error_1[(_0x3eb3c0(0x1d8))](_0x3eb3c0(0x18f)+_0x5b8bc6+_0x3eb3c0(0x191));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x3eb3c0(0x1b9)](_0x1bdae7[0x0]);}async['getBranchRecord'](_0xa34d40){const _0x2eb6f2=a203_0x5319b5,_0x12b40e=await this[_0x2eb6f2(0x1bc)][_0x2eb6f2(0x18e)](queries_1[_0x2eb6f2(0x1c0)]['replace'](_0x2eb6f2(0x1d1),_0xa34d40));if(_0x12b40e['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x2eb6f2(0x1be)+_0xa34d40+_0x2eb6f2(0x191));return flosum_repository_sync_dto_1[_0x2eb6f2(0x1a3)][_0x2eb6f2(0x1c5)](_0x12b40e[0x0]);}async[a203_0x5319b5(0x1aa)](_0x5e87cc){const _0x3118fe=a203_0x5319b5,_0x515509=await this[_0x3118fe(0x1bc)]['query'](queries_1[_0x3118fe(0x1ca)]['replace']('%name%',_0x5e87cc));if(_0x515509['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Branch\x20'+_0x5e87cc+'\x20not\x20found\x20on\x20salesforce');const _0x2bd6ff=_0x515509['find'](_0x145355=>_0x145355[constants_1[_0x3118fe(0x1b5)]+_0x3118fe(0x190)]===_0x5e87cc);if(!_0x2bd6ff)throw new not_found_error_1['SalesforceNotFoundError'](_0x3118fe(0x199)+_0x5e87cc+_0x3118fe(0x191));return flosum_repository_sync_dto_1[_0x3118fe(0x1a3)][_0x3118fe(0x1c5)](_0x2bd6ff);}async[a203_0x5319b5(0x189)](_0x26ad34){const _0x293f35=a203_0x5319b5,_0x5423bf=await this['salesforceQuery'][_0x293f35(0x18e)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x293f35(0x18d)](_0x293f35(0x1d0),_0x26ad34));if(_0x5423bf[_0x293f35(0x19b)]===0x0)throw new not_found_error_1[(_0x293f35(0x1d8))](_0x293f35(0x1b8)+_0x26ad34+_0x293f35(0x191));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x293f35(0x1b9)](_0x5423bf[0x0]);}async['getComponentsFromRepository'](_0xf0739c){const _0x4e6b09='\x0a\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0xf0739c+'\x27';return this['getComponents'](_0x4e6b09);}async['getBranchComponents'](_0x455ad5){const _0x1b230e=a203_0x5319b5,_0x2a5737=_0x1b230e(0x1d4)+queries_1[_0x1b230e(0x1b0)]+_0x1b230e(0x1bf)+_0x455ad5+'\x27';return this[_0x1b230e(0x1d3)](_0x2a5737);}async[a203_0x5319b5(0x1ab)](_0x26d26e){const _0x46dc17=a203_0x5319b5;var _0x56b56b;const _0x29b70c=queries_1[_0x46dc17(0x19a)]['replace'](_0x46dc17(0x1bb),_0x26d26e[_0x46dc17(0x19d)])['replace'](_0x46dc17(0x1d0),_0x26d26e[_0x46dc17(0x1ce)]?constants_1[_0x46dc17(0x1d6)]:constants_1[_0x46dc17(0x1ae)]),_0x282248=await this[_0x46dc17(0x1bc)][_0x46dc17(0x18e)](_0x29b70c),_0x562917=(_0x56b56b=_0x282248[0x0])===null||_0x56b56b===void 0x0?void 0x0:_0x56b56b['Id'];if(!_0x562917)throw new Error(errors_1[_0x46dc17(0x1db)]);return _0x562917;}async[a203_0x5319b5(0x18c)](_0x244b9d){const _0x48b065=a203_0x5319b5;let _0x776732=await this[_0x48b065(0x1ab)](_0x244b9d)['catch'](()=>null);return!_0x776732&&(_0x776732=await this[_0x48b065(0x1a2)][_0x48b065(0x1a8)](_0x48b065(0x1cb),{'Body':(0x0,utils_1[_0x48b065(0x1c6)])('{}'),'ParentId':_0x244b9d[_0x48b065(0x19d)],'ContentType':'text/plain','Name':_0x244b9d[_0x48b065(0x1ce)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x48b065(0x1ae)]})),_0x776732;}async[a203_0x5319b5(0x1a0)](_0xfbc2f9,_0x4ae62d){const _0xc95a15=a203_0x5319b5,_0xeef584=await this['getRemoteStateAttachmentId'](_0xfbc2f9);await this[_0xc95a15(0x1a2)][_0xc95a15(0x1a7)](_0xc95a15(0x1cb),_0xeef584,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0xc95a15(0x1d2)](_0x4ae62d))});}async['setStatus'](_0x566533,_0x3a32a9){const _0x16e50a=a203_0x5319b5;await this[_0x16e50a(0x1a2)]['patchObject'](_0x566533[_0x16e50a(0x1af)],_0x566533[_0x16e50a(0x19d)],{[constants_1[_0x16e50a(0x1da)]+'Synchronization_Status__c']:_0x3a32a9});}async['disableSync'](_0x2f580a){const _0x419ca2=a203_0x5319b5;await this[_0x419ca2(0x1a2)][_0x419ca2(0x1a7)](constants_1[_0x419ca2(0x1da)]+'Connection__c',_0x2f580a,{[constants_1[_0x419ca2(0x1da)]+_0x419ca2(0x1b3)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a203_0x5319b5(0x1a4),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a203_0x5319b5(0x1dc)]])],SalesforceSyncService),exports[a203_0x5319b5(0x1b4)]=SalesforceSyncService;