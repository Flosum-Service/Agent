function a243_0x41c6(_0xe4a9d6,_0x2c902a){const _0x345bd9=a243_0x201e();return a243_0x41c6=function(_0x5beb40,_0xac1b06){_0x5beb40=_0x5beb40-0xfc;let _0x201e70=_0x345bd9[_0x5beb40];return _0x201e70;},a243_0x41c6(_0xe4a9d6,_0x2c902a);}const a243_0x106567=a243_0x41c6;(function(_0x38bd75,_0x439c43){const _0x276cae=a243_0x41c6,_0x580a51=_0x38bd75();while(!![]){try{const _0x357a1a=-parseInt(_0x276cae(0x135))/0x1*(parseInt(_0x276cae(0x120))/0x2)+parseInt(_0x276cae(0x152))/0x3*(parseInt(_0x276cae(0x151))/0x4)+parseInt(_0x276cae(0x10e))/0x5*(parseInt(_0x276cae(0x134))/0x6)+-parseInt(_0x276cae(0x150))/0x7*(parseInt(_0x276cae(0x106))/0x8)+-parseInt(_0x276cae(0x121))/0x9+parseInt(_0x276cae(0x124))/0xa+-parseInt(_0x276cae(0x12c))/0xb*(-parseInt(_0x276cae(0x13a))/0xc);if(_0x357a1a===_0x439c43)break;else _0x580a51['push'](_0x580a51['shift']());}catch(_0x9fe15){_0x580a51['push'](_0x580a51['shift']());}}}(a243_0x201e,0x8a8d1));function a243_0x201e(){const _0x179214=['function','updateRemoteState','Branch_Name__c','\x0a\x20\x20\x20\x20\x20\x20','fromBranchRecord','records','patchObject','7FWgYdI','1237480ncdoVb','3mJReJy','../../../shared/utils','encodeBase64','toString','objectType','(((.+)+)+)+$','apply','Components__r','query','\x20not\x20found\x20on\x20salesforce','GET_COMPONENTS_QUERY','find','SalesforceQueryService','getOwnPropertyDescriptor','6565744QGijGv','GET_BRANCH_BY_NAME_QUERY','stringify','../../../../constants/errors','getRemoteStateAttachmentId','Sync_In_Progress__c','getRepositoryRecords','constructor','105qiMEvH','SalesforceSyncService','getBranchRecord','FLOSUM_GIT_NAMESPACE','SYNC_ATTACHMENT_FOR_BRANCH_NAME','object','length','createObject','getAttachmentId','%name%','Repository\x20','Branch\x20','search','./salesforce.service','getAllRepositoryNames','catch','ERR_INVALID_ATTACHMENT_ID','__metadata','350722XefKRz','3025773mTMslY','salesforceService','Branch\x20with\x20Id\x20','8421310MjKlfl','Service','getBranchRecords','Repository__r','../errors/not-found.error','FlosumRepositorySyncDto','./salesforce-query.service','SalesforceNotFoundError','11KRvUvg','GET_REPOSITORY_BY_NAME_QUERY','fromRepositoryRecord','Attachment','decorate','getRepositoryRecord','repositoryId','objectId','244632YeVLOJ','2hEvUky','Synchronization_Status__c','getComponents','getBranchComponents','GET_WAITING_REPOSITORIES_QUERY','809148riEesB','SalesforceService','defineProperty','salesforceQuery','Connection__c','GET_REPOSITORY_QUERY','metadata','GET_REPOSITORIES_NAMES_QUERY','getComponentsFromRepository','design:paramtypes','replace','%parentId%','Name','getBranchRecordByName','__esModule'];a243_0x201e=function(){return _0x179214;};return a243_0x201e();}const a243_0xac1b06=(function(){let _0x1e801b=!![];return function(_0x2b382a,_0x419d15){const _0x65c8b7=_0x1e801b?function(){const _0x3fdff2=a243_0x41c6;if(_0x419d15){const _0xeac354=_0x419d15[_0x3fdff2(0xfe)](_0x2b382a,arguments);return _0x419d15=null,_0xeac354;}}:function(){};return _0x1e801b=![],_0x65c8b7;};}()),a243_0x5beb40=a243_0xac1b06(this,function(){const _0x2f5e37=a243_0x41c6;return a243_0x5beb40[_0x2f5e37(0x155)]()[_0x2f5e37(0x11a)](_0x2f5e37(0xfd))[_0x2f5e37(0x155)]()[_0x2f5e37(0x10d)](a243_0x5beb40)[_0x2f5e37(0x11a)](_0x2f5e37(0xfd));});a243_0x5beb40();'use strict';var __decorate=this&&this['__decorate']||function(_0x51a34f,_0x321b06,_0x1cb270,_0x10847d){const _0x59a039=a243_0x41c6;var _0x420533=arguments[_0x59a039(0x114)],_0x5403bf=_0x420533<0x3?_0x321b06:_0x10847d===null?_0x10847d=Object[_0x59a039(0x105)](_0x321b06,_0x1cb270):_0x10847d,_0x3c64a8;if(typeof Reflect===_0x59a039(0x113)&&typeof Reflect[_0x59a039(0x130)]===_0x59a039(0x149))_0x5403bf=Reflect[_0x59a039(0x130)](_0x51a34f,_0x321b06,_0x1cb270,_0x10847d);else{for(var _0x41be89=_0x51a34f[_0x59a039(0x114)]-0x1;_0x41be89>=0x0;_0x41be89--)if(_0x3c64a8=_0x51a34f[_0x41be89])_0x5403bf=(_0x420533<0x3?_0x3c64a8(_0x5403bf):_0x420533>0x3?_0x3c64a8(_0x321b06,_0x1cb270,_0x5403bf):_0x3c64a8(_0x321b06,_0x1cb270))||_0x5403bf;}return _0x420533>0x3&&_0x5403bf&&Object[_0x59a039(0x13c)](_0x321b06,_0x1cb270,_0x5403bf),_0x5403bf;},__metadata=this&&this[a243_0x106567(0x11f)]||function(_0x19da81,_0x1f5aee){const _0x5db847=a243_0x106567;if(typeof Reflect===_0x5db847(0x113)&&typeof Reflect['metadata']===_0x5db847(0x149))return Reflect[_0x5db847(0x140)](_0x19da81,_0x1f5aee);};Object['defineProperty'](exports,a243_0x106567(0x148),{'value':!![]}),exports[a243_0x106567(0x10f)]=void 0x0;const typedi_1=require('typedi'),constants_1=require('../../../../constants'),errors_1=require(a243_0x106567(0x109)),utils_1=require(a243_0x106567(0x153)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a243_0x106567(0x128)),queries_1=require('../queries'),salesforce_query_service_1=require(a243_0x106567(0x12a)),salesforce_service_1=require(a243_0x106567(0x11b));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x7ef701,_0x56cc68){const _0x41a469=a243_0x106567;this[_0x41a469(0x13d)]=_0x7ef701,this[_0x41a469(0x122)]=_0x56cc68;}async[a243_0x106567(0x137)](_0x31f2b6){const _0x472b79=a243_0x106567;var _0x5d2d11;const _0x14d621=await this[_0x472b79(0x13d)][_0x472b79(0x100)](_0x31f2b6),_0x1532d8=[];for(const _0x5678b2 of _0x14d621){const _0x5aadb4=(_0x5d2d11=_0x5678b2[constants_1['FLOSUM_NAMESPACE']+_0x472b79(0xff)])===null||_0x5d2d11===void 0x0?void 0x0:_0x5d2d11[_0x472b79(0x14e)];_0x5aadb4&&_0x5aadb4[_0x472b79(0x114)]&&_0x1532d8['push'](_0x5aadb4[0x0]['Id']);}return _0x1532d8;}async[a243_0x106567(0x11c)](_0x274736){const _0x1d11ca=a243_0x106567,_0x3d9474=await this[_0x1d11ca(0x13d)]['query'](queries_1[_0x1d11ca(0x141)]['replace'](/\%connection_id\%/g,_0x274736));return _0x3d9474['map'](_0x14d987=>{const _0x3edc99=_0x1d11ca;return _0x14d987[constants_1[_0x3edc99(0x111)]+_0x3edc99(0x127)]?_0x14d987[constants_1[_0x3edc99(0x111)]+_0x3edc99(0x127)][_0x3edc99(0x146)]:_0x14d987['Name'];});}async[a243_0x106567(0x10c)](_0x51da4c){const _0x55fe01=a243_0x106567,_0x89afd6=await this[_0x55fe01(0x13d)][_0x55fe01(0x100)](queries_1[_0x55fe01(0x139)][_0x55fe01(0x144)](/\%connection_id\%/g,_0x51da4c));return _0x89afd6['map'](_0x224de0=>flosum_repository_sync_dto_1[_0x55fe01(0x129)][_0x55fe01(0x12e)](_0x224de0));}async[a243_0x106567(0x126)](_0x12e830){const _0x4cf0e7=a243_0x106567,_0x5059e1=await this[_0x4cf0e7(0x13d)]['query'](queries_1['GET_WAITING_BRANCHES_QUERY'][_0x4cf0e7(0x144)](/%repositories_ids\%/g,_0x12e830));return _0x5059e1['map'](_0x20bddd=>flosum_repository_sync_dto_1[_0x4cf0e7(0x129)]['fromBranchRecord'](_0x20bddd));}async[a243_0x106567(0x131)](_0x58b1ba){const _0x37c306=a243_0x106567,_0x21dff1=await this[_0x37c306(0x13d)][_0x37c306(0x100)](queries_1[_0x37c306(0x13f)][_0x37c306(0x144)]('%id%',_0x58b1ba));if(_0x21dff1[_0x37c306(0x114)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Repository\x20with\x20Id\x20'+_0x58b1ba+_0x37c306(0x101));return flosum_repository_sync_dto_1[_0x37c306(0x129)][_0x37c306(0x12e)](_0x21dff1[0x0]);}async[a243_0x106567(0x110)](_0x5ecc68){const _0x3449eb=a243_0x106567,_0x3e0c94=await this[_0x3449eb(0x13d)][_0x3449eb(0x100)](queries_1['GET_BRANCH_QUERY'][_0x3449eb(0x144)]('%id%',_0x5ecc68));if(_0x3e0c94['length']===0x0)throw new not_found_error_1[(_0x3449eb(0x12b))](_0x3449eb(0x123)+_0x5ecc68+_0x3449eb(0x101));return flosum_repository_sync_dto_1[_0x3449eb(0x129)][_0x3449eb(0x14d)](_0x3e0c94[0x0]);}async[a243_0x106567(0x147)](_0x5563f3){const _0x23e0a1=a243_0x106567,_0x41812a=await this[_0x23e0a1(0x13d)][_0x23e0a1(0x100)](queries_1[_0x23e0a1(0x107)][_0x23e0a1(0x144)](_0x23e0a1(0x117),_0x5563f3));if(_0x41812a[_0x23e0a1(0x114)]===0x0)throw new not_found_error_1[(_0x23e0a1(0x12b))](_0x23e0a1(0x119)+_0x5563f3+_0x23e0a1(0x101));const _0x14e20f=_0x41812a[_0x23e0a1(0x103)](_0x51b793=>_0x51b793[constants_1['FLOSUM_NAMESPACE']+_0x23e0a1(0x14b)]===_0x5563f3);if(!_0x14e20f)throw new not_found_error_1[(_0x23e0a1(0x12b))](_0x23e0a1(0x119)+_0x5563f3+_0x23e0a1(0x101));return flosum_repository_sync_dto_1[_0x23e0a1(0x129)]['fromBranchRecord'](_0x14e20f);}async['getRepositoryRecordByName'](_0xb585df){const _0x56117c=a243_0x106567,_0x427454=await this[_0x56117c(0x13d)]['query'](queries_1[_0x56117c(0x12d)][_0x56117c(0x144)](_0x56117c(0x117),_0xb585df));if(_0x427454[_0x56117c(0x114)]===0x0)throw new not_found_error_1[(_0x56117c(0x12b))](_0x56117c(0x118)+_0xb585df+_0x56117c(0x101));return flosum_repository_sync_dto_1[_0x56117c(0x129)][_0x56117c(0x12e)](_0x427454[0x0]);}async[a243_0x106567(0x142)](_0x21aca2){const _0x505d5e=a243_0x106567,_0x3100bf=_0x505d5e(0x14c)+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x21aca2+'\x27';return this[_0x505d5e(0x137)](_0x3100bf);}async[a243_0x106567(0x138)](_0x4b775a){const _0x3a4f5e=a243_0x106567,_0x4d0c85='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x3a4f5e(0x102)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x4b775a+'\x27';return this[_0x3a4f5e(0x137)](_0x4d0c85);}async[a243_0x106567(0x116)](_0xe59ae3){const _0x6e82fa=a243_0x106567;var _0x18597c;const _0x215e1a=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x6e82fa(0x144)](_0x6e82fa(0x145),_0xe59ae3['objectId'])[_0x6e82fa(0x144)]('%name%',_0xe59ae3[_0x6e82fa(0x132)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x6e82fa(0x112)]),_0x3189bf=await this['salesforceQuery'][_0x6e82fa(0x100)](_0x215e1a),_0x104f88=(_0x18597c=_0x3189bf[0x0])===null||_0x18597c===void 0x0?void 0x0:_0x18597c['Id'];if(!_0x104f88)throw new Error(errors_1[_0x6e82fa(0x11e)]);return _0x104f88;}async[a243_0x106567(0x10a)](_0x3b72f2){const _0x321382=a243_0x106567;let _0x51e286=await this['getAttachmentId'](_0x3b72f2)[_0x321382(0x11d)](()=>null);return!_0x51e286&&(_0x51e286=await this[_0x321382(0x122)][_0x321382(0x115)](_0x321382(0x12f),{'Body':(0x0,utils_1[_0x321382(0x154)])('{}'),'ParentId':_0x3b72f2[_0x321382(0x133)],'ContentType':'text/plain','Name':_0x3b72f2[_0x321382(0x132)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x321382(0x112)]})),_0x51e286;}async[a243_0x106567(0x14a)](_0x272eff,_0x5dd579){const _0xd0dcfe=a243_0x106567,_0x424d30=await this['getRemoteStateAttachmentId'](_0x272eff);await this[_0xd0dcfe(0x122)]['patchObject'](_0xd0dcfe(0x12f),_0x424d30,{'Body':(0x0,utils_1[_0xd0dcfe(0x154)])(JSON[_0xd0dcfe(0x108)](_0x5dd579))});}async['setStatus'](_0x243918,_0x20f146){const _0x4e829f=a243_0x106567;await this[_0x4e829f(0x122)][_0x4e829f(0x14f)](_0x243918[_0x4e829f(0xfc)],_0x243918[_0x4e829f(0x133)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x4e829f(0x136)]:_0x20f146});}async['disableSync'](_0x39ed63){const _0x4ef50f=a243_0x106567;await this[_0x4ef50f(0x122)]['patchObject'](constants_1[_0x4ef50f(0x111)]+_0x4ef50f(0x13e),_0x39ed63,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x4ef50f(0x10b)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x106567(0x125)])(),__metadata(a243_0x106567(0x143),[salesforce_query_service_1[a243_0x106567(0x104)],salesforce_service_1[a243_0x106567(0x13b)]])],SalesforceSyncService),exports[a243_0x106567(0x10f)]=SalesforceSyncService;