function a238_0x588b(_0x3ce6c1,_0x46b3d4){const _0x176282=a238_0x29ae();return a238_0x588b=function(_0x4b39d3,_0x36a8a3){_0x4b39d3=_0x4b39d3-0x195;let _0x29ae1f=_0x176282[_0x4b39d3];return _0x29ae1f;},a238_0x588b(_0x3ce6c1,_0x46b3d4);}const a238_0x4f09e7=a238_0x588b;(function(_0x4bfb6a,_0x2cbc7b){const _0x28c130=a238_0x588b,_0x52ab8b=_0x4bfb6a();while(!![]){try{const _0x52f5eb=-parseInt(_0x28c130(0x1e8))/0x1*(-parseInt(_0x28c130(0x1bd))/0x2)+-parseInt(_0x28c130(0x1e4))/0x3+-parseInt(_0x28c130(0x19d))/0x4+parseInt(_0x28c130(0x1c6))/0x5+-parseInt(_0x28c130(0x1de))/0x6+-parseInt(_0x28c130(0x1b1))/0x7+parseInt(_0x28c130(0x1d8))/0x8*(parseInt(_0x28c130(0x1af))/0x9);if(_0x52f5eb===_0x2cbc7b)break;else _0x52ab8b['push'](_0x52ab8b['shift']());}catch(_0x3f834f){_0x52ab8b['push'](_0x52ab8b['shift']());}}}(a238_0x29ae,0xf402f));const a238_0x36a8a3=(function(){let _0x63b065=!![];return function(_0x5c94aa,_0x5c81ec){const _0x3fcd1a=_0x63b065?function(){const _0x55b194=a238_0x588b;if(_0x5c81ec){const _0x537ac0=_0x5c81ec[_0x55b194(0x1d2)](_0x5c94aa,arguments);return _0x5c81ec=null,_0x537ac0;}}:function(){};return _0x63b065=![],_0x3fcd1a;};}()),a238_0x4b39d3=a238_0x36a8a3(this,function(){const _0x2c9321=a238_0x588b;return a238_0x4b39d3[_0x2c9321(0x1bc)]()['search']('(((.+)+)+)+$')[_0x2c9321(0x1bc)]()[_0x2c9321(0x198)](a238_0x4b39d3)['search']('(((.+)+)+)+$');});a238_0x4b39d3();'use strict';var __decorate=this&&this[a238_0x4f09e7(0x1ca)]||function(_0x1e3110,_0x17cd1d,_0x2e2d6e,_0x242893){const _0x31fe18=a238_0x4f09e7;var _0x3c67bf=arguments['length'],_0x3f6178=_0x3c67bf<0x3?_0x17cd1d:_0x242893===null?_0x242893=Object[_0x31fe18(0x1cd)](_0x17cd1d,_0x2e2d6e):_0x242893,_0x2dfd3e;if(typeof Reflect==='object'&&typeof Reflect[_0x31fe18(0x19e)]===_0x31fe18(0x19b))_0x3f6178=Reflect[_0x31fe18(0x19e)](_0x1e3110,_0x17cd1d,_0x2e2d6e,_0x242893);else{for(var _0x4b6979=_0x1e3110[_0x31fe18(0x1c1)]-0x1;_0x4b6979>=0x0;_0x4b6979--)if(_0x2dfd3e=_0x1e3110[_0x4b6979])_0x3f6178=(_0x3c67bf<0x3?_0x2dfd3e(_0x3f6178):_0x3c67bf>0x3?_0x2dfd3e(_0x17cd1d,_0x2e2d6e,_0x3f6178):_0x2dfd3e(_0x17cd1d,_0x2e2d6e))||_0x3f6178;}return _0x3c67bf>0x3&&_0x3f6178&&Object['defineProperty'](_0x17cd1d,_0x2e2d6e,_0x3f6178),_0x3f6178;},__metadata=this&&this[a238_0x4f09e7(0x1db)]||function(_0x192417,_0x343a4e){const _0x541bdf=a238_0x4f09e7;if(typeof Reflect==='object'&&typeof Reflect[_0x541bdf(0x1ac)]===_0x541bdf(0x19b))return Reflect[_0x541bdf(0x1ac)](_0x192417,_0x343a4e);};Object[a238_0x4f09e7(0x1a1)](exports,a238_0x4f09e7(0x1c5),{'value':!![]}),exports[a238_0x4f09e7(0x1ed)]=void 0x0;function a238_0x29ae(){const _0x449546=['SalesforceService','fromBranchRecord','toString','1671994HwObPq','encodeBase64','GET_WAITING_BRANCHES_QUERY','design:paramtypes','length','disableSync','getAllRepositoryNames','Repository\x20','__esModule','537050VtDSvB','GET_REPOSITORIES_NAMES_QUERY','GET_WAITING_REPOSITORIES_QUERY','Service','__decorate','Branch\x20','getRepositoryRecordByName','getOwnPropertyDescriptor','./salesforce.service','objectId','query','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','apply','FLOSUM_GIT_NAMESPACE','GET_REPOSITORY_BY_NAME_QUERY','GET_COMPONENTS_QUERY','FLOSUM_NAMESPACE','Attachment','48zvViLY','stringify','Branch\x20with\x20Id\x20','__metadata','../../../shared/utils','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','2616504Lzswde','createObject','catch','FlosumRepositorySyncDto','../queries','%name%','3548742mbELmO','patchObject','Components__r','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','1RnKSGI','Repository__r','GET_BRANCH_QUERY','text/plain','SYNC_ATTACHMENT_FOR_BRANCH_NAME','SalesforceSyncService','getBranchRecord','SalesforceNotFoundError','Repository\x20with\x20Id\x20','getComponentsFromRepository','getBranchRecords','fromRepositoryRecord','constructor','salesforceQuery','getBranchRecordByName','function','GET_REPOSITORY_QUERY','6648736xtEUfQ','decorate','\x20not\x20found\x20on\x20salesforce','Synchronization_Status__c','defineProperty','getRepositoryRecord','map','getAttachmentId','Connection__c','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','GET_BRANCH_BY_NAME_QUERY','typedi','objectType','../../../../constants','getRemoteStateAttachmentId','metadata','../errors/not-found.error','repositoryId','7897491suUqSA','salesforceService','13494236oRlPbB','updateRemoteState','getRepositoryRecords','replace','SalesforceQueryService','push','Name','find','\x0a\x20\x20\x20\x20\x20\x20'];a238_0x29ae=function(){return _0x449546;};return a238_0x29ae();}const typedi_1=require(a238_0x4f09e7(0x1a8)),constants_1=require(a238_0x4f09e7(0x1aa)),errors_1=require('../../../../constants/errors'),utils_1=require(a238_0x4f09e7(0x1dc)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a238_0x4f09e7(0x1ad)),queries_1=require(a238_0x4f09e7(0x1e2)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a238_0x4f09e7(0x1ce));let SalesforceSyncService=class SalesforceSyncService{constructor(_0xdd961c,_0x25f35a){const _0xa92a43=a238_0x4f09e7;this[_0xa92a43(0x199)]=_0xdd961c,this[_0xa92a43(0x1b0)]=_0x25f35a;}async['getComponents'](_0x5d6a5e){const _0x31debe=a238_0x4f09e7;var _0x13e439;const _0x4ccb33=await this['salesforceQuery'][_0x31debe(0x1d0)](_0x5d6a5e),_0x49715a=[];for(const _0x507af9 of _0x4ccb33){const _0x2b02c7=(_0x13e439=_0x507af9[constants_1['FLOSUM_NAMESPACE']+_0x31debe(0x1e6)])===null||_0x13e439===void 0x0?void 0x0:_0x13e439['records'];_0x2b02c7&&_0x2b02c7[_0x31debe(0x1c1)]&&_0x49715a[_0x31debe(0x1b6)](_0x2b02c7[0x0]['Id']);}return _0x49715a;}async[a238_0x4f09e7(0x1c3)](_0x4284b6){const _0x4b949c=a238_0x4f09e7,_0xa725a7=await this['salesforceQuery']['query'](queries_1[_0x4b949c(0x1c7)][_0x4b949c(0x1b4)](/\%connection_id\%/g,_0x4284b6));return _0xa725a7[_0x4b949c(0x1a3)](_0x243a2a=>{const _0x57c686=_0x4b949c;return _0x243a2a[constants_1[_0x57c686(0x1d3)]+_0x57c686(0x1e9)]?_0x243a2a[constants_1[_0x57c686(0x1d3)]+'Repository__r']['Name']:_0x243a2a[_0x57c686(0x1b7)];});}async[a238_0x4f09e7(0x1b3)](_0x20db35){const _0x479427=a238_0x4f09e7,_0x559045=await this[_0x479427(0x199)][_0x479427(0x1d0)](queries_1[_0x479427(0x1c8)][_0x479427(0x1b4)](/\%connection_id\%/g,_0x20db35));return _0x559045[_0x479427(0x1a3)](_0x537ecf=>flosum_repository_sync_dto_1[_0x479427(0x1e1)][_0x479427(0x197)](_0x537ecf));}async[a238_0x4f09e7(0x196)](_0x39455c){const _0x1efc3c=a238_0x4f09e7,_0x5d8e1a=await this['salesforceQuery']['query'](queries_1[_0x1efc3c(0x1bf)]['replace'](/%repositories_ids\%/g,_0x39455c));return _0x5d8e1a[_0x1efc3c(0x1a3)](_0x3586c8=>flosum_repository_sync_dto_1[_0x1efc3c(0x1e1)][_0x1efc3c(0x1bb)](_0x3586c8));}async[a238_0x4f09e7(0x1a2)](_0x5b7441){const _0x1acc09=a238_0x4f09e7,_0x4f1fd7=await this['salesforceQuery']['query'](queries_1[_0x1acc09(0x19c)][_0x1acc09(0x1b4)]('%id%',_0x5b7441));if(_0x4f1fd7[_0x1acc09(0x1c1)]===0x0)throw new not_found_error_1[(_0x1acc09(0x1ef))](_0x1acc09(0x1f0)+_0x5b7441+_0x1acc09(0x19f));return flosum_repository_sync_dto_1[_0x1acc09(0x1e1)][_0x1acc09(0x197)](_0x4f1fd7[0x0]);}async[a238_0x4f09e7(0x1ee)](_0x14d985){const _0x52489d=a238_0x4f09e7,_0x6fe065=await this[_0x52489d(0x199)][_0x52489d(0x1d0)](queries_1[_0x52489d(0x1ea)][_0x52489d(0x1b4)]('%id%',_0x14d985));if(_0x6fe065[_0x52489d(0x1c1)]===0x0)throw new not_found_error_1[(_0x52489d(0x1ef))](_0x52489d(0x1da)+_0x14d985+_0x52489d(0x19f));return flosum_repository_sync_dto_1[_0x52489d(0x1e1)][_0x52489d(0x1bb)](_0x6fe065[0x0]);}async[a238_0x4f09e7(0x19a)](_0x4d81e3){const _0x91b936=a238_0x4f09e7,_0x2cab7d=await this[_0x91b936(0x199)][_0x91b936(0x1d0)](queries_1[_0x91b936(0x1a7)]['replace'](_0x91b936(0x1e3),_0x4d81e3));if(_0x2cab7d['length']===0x0)throw new not_found_error_1[(_0x91b936(0x1ef))](_0x91b936(0x1cb)+_0x4d81e3+_0x91b936(0x19f));const _0x13ffb1=_0x2cab7d[_0x91b936(0x1b8)](_0x78b141=>_0x78b141[constants_1[_0x91b936(0x1d6)]+'Branch_Name__c']===_0x4d81e3);if(!_0x13ffb1)throw new not_found_error_1[(_0x91b936(0x1ef))](_0x91b936(0x1cb)+_0x4d81e3+_0x91b936(0x19f));return flosum_repository_sync_dto_1[_0x91b936(0x1e1)][_0x91b936(0x1bb)](_0x13ffb1);}async[a238_0x4f09e7(0x1cc)](_0x36143e){const _0xbd1596=a238_0x4f09e7,_0x45bb2f=await this['salesforceQuery'][_0xbd1596(0x1d0)](queries_1[_0xbd1596(0x1d4)][_0xbd1596(0x1b4)](_0xbd1596(0x1e3),_0x36143e));if(_0x45bb2f[_0xbd1596(0x1c1)]===0x0)throw new not_found_error_1[(_0xbd1596(0x1ef))](_0xbd1596(0x1c4)+_0x36143e+_0xbd1596(0x19f));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0xbd1596(0x197)](_0x45bb2f[0x0]);}async[a238_0x4f09e7(0x195)](_0x573577){const _0x4a0575=a238_0x4f09e7,_0x4a0820=_0x4a0575(0x1b9)+queries_1['GET_COMPONENTS_QUERY']+_0x4a0575(0x1d1)+_0x573577+'\x27';return this['getComponents'](_0x4a0820);}async['getBranchComponents'](_0x590d78){const _0x5009fa=a238_0x4f09e7,_0x184188='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x5009fa(0x1d5)]+_0x5009fa(0x1dd)+_0x590d78+'\x27';return this['getComponents'](_0x184188);}async[a238_0x4f09e7(0x1a4)](_0x4270bb){const _0x20cc47=a238_0x4f09e7;var _0xd1403f;const _0x5dfb65=queries_1[_0x20cc47(0x1a6)]['replace']('%parentId%',_0x4270bb[_0x20cc47(0x1cf)])[_0x20cc47(0x1b4)](_0x20cc47(0x1e3),_0x4270bb['repositoryId']?constants_1[_0x20cc47(0x1e7)]:constants_1[_0x20cc47(0x1ec)]),_0x35d8c2=await this[_0x20cc47(0x199)][_0x20cc47(0x1d0)](_0x5dfb65),_0x3fc1c2=(_0xd1403f=_0x35d8c2[0x0])===null||_0xd1403f===void 0x0?void 0x0:_0xd1403f['Id'];if(!_0x3fc1c2)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x3fc1c2;}async[a238_0x4f09e7(0x1ab)](_0x5e9819){const _0xd88795=a238_0x4f09e7;let _0xcfdfa8=await this[_0xd88795(0x1a4)](_0x5e9819)[_0xd88795(0x1e0)](()=>null);return!_0xcfdfa8&&(_0xcfdfa8=await this['salesforceService'][_0xd88795(0x1df)](_0xd88795(0x1d7),{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x5e9819[_0xd88795(0x1cf)],'ContentType':_0xd88795(0x1eb),'Name':_0x5e9819[_0xd88795(0x1ae)]?constants_1[_0xd88795(0x1e7)]:constants_1[_0xd88795(0x1ec)]})),_0xcfdfa8;}async[a238_0x4f09e7(0x1b2)](_0x420986,_0x420f91){const _0x270833=a238_0x4f09e7,_0x3c8666=await this[_0x270833(0x1ab)](_0x420986);await this[_0x270833(0x1b0)]['patchObject'](_0x270833(0x1d7),_0x3c8666,{'Body':(0x0,utils_1[_0x270833(0x1be)])(JSON[_0x270833(0x1d9)](_0x420f91))});}async['setStatus'](_0x5aab41,_0x54ea35){const _0x64d33a=a238_0x4f09e7;await this['salesforceService'][_0x64d33a(0x1e5)](_0x5aab41[_0x64d33a(0x1a9)],_0x5aab41['objectId'],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x64d33a(0x1a0)]:_0x54ea35});}async[a238_0x4f09e7(0x1c2)](_0xf836b0){const _0x3c6637=a238_0x4f09e7;await this['salesforceService'][_0x3c6637(0x1e5)](constants_1[_0x3c6637(0x1d3)]+_0x3c6637(0x1a5),_0xf836b0,{[constants_1['FLOSUM_GIT_NAMESPACE']+'Sync_In_Progress__c']:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a238_0x4f09e7(0x1c9)])(),__metadata(a238_0x4f09e7(0x1c0),[salesforce_query_service_1[a238_0x4f09e7(0x1b5)],salesforce_service_1[a238_0x4f09e7(0x1ba)]])],SalesforceSyncService),exports[a238_0x4f09e7(0x1ed)]=SalesforceSyncService;