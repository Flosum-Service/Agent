const a243_0x2a250e=a243_0x3c47;(function(_0x2a5b77,_0x4db374){const _0x2f4d22=a243_0x3c47,_0x28fc24=_0x2a5b77();while(!![]){try{const _0x35ab36=parseInt(_0x2f4d22(0x12b))/0x1*(-parseInt(_0x2f4d22(0x14c))/0x2)+parseInt(_0x2f4d22(0x13c))/0x3+parseInt(_0x2f4d22(0x121))/0x4*(-parseInt(_0x2f4d22(0x111))/0x5)+-parseInt(_0x2f4d22(0x119))/0x6+parseInt(_0x2f4d22(0x113))/0x7+parseInt(_0x2f4d22(0x153))/0x8*(-parseInt(_0x2f4d22(0x156))/0x9)+-parseInt(_0x2f4d22(0x139))/0xa*(-parseInt(_0x2f4d22(0x14f))/0xb);if(_0x35ab36===_0x4db374)break;else _0x28fc24['push'](_0x28fc24['shift']());}catch(_0x559da1){_0x28fc24['push'](_0x28fc24['shift']());}}}(a243_0xb436,0xdcde2));function a243_0x3c47(_0x231b75,_0x4eb448){const _0x5e9d53=a243_0xb436();return a243_0x3c47=function(_0x50b6fb,_0x51bf53){_0x50b6fb=_0x50b6fb-0x102;let _0xb43627=_0x5e9d53[_0x50b6fb];return _0xb43627;},a243_0x3c47(_0x231b75,_0x4eb448);}const a243_0x51bf53=(function(){let _0x5db5f5=!![];return function(_0x5e2421,_0x490d60){const _0x415bd0=_0x5db5f5?function(){const _0x64f3ab=a243_0x3c47;if(_0x490d60){const _0x2fa084=_0x490d60[_0x64f3ab(0x128)](_0x5e2421,arguments);return _0x490d60=null,_0x2fa084;}}:function(){};return _0x5db5f5=![],_0x415bd0;};}()),a243_0x50b6fb=a243_0x51bf53(this,function(){const _0x1a5606=a243_0x3c47;return a243_0x50b6fb['toString']()[_0x1a5606(0x107)](_0x1a5606(0x157))[_0x1a5606(0x127)]()[_0x1a5606(0x140)](a243_0x50b6fb)[_0x1a5606(0x107)](_0x1a5606(0x157));});a243_0x50b6fb();function a243_0xb436(){const _0x2481bf=['patchObject','664sdlJKk','fromBranchRecord','text/plain','35469WvKFqd','(((.+)+)+)+$','getAttachmentId','push','__decorate','GET_REPOSITORIES_NAMES_QUERY','../../../../constants','Service','getBranchRecord','GET_WAITING_REPOSITORIES_QUERY','Synchronization_Status__c','salesforceQuery','Branch_Name__c','./salesforce.service','../dto/flosum-repository-sync.dto','design:paramtypes','salesforceService','objectId','function','./salesforce-query.service','FlosumRepositorySyncDto','GET_COMPONENTS_QUERY','search','../../../../constants/errors','GET_BRANCH_BY_NAME_QUERY','Sync_In_Progress__c','getBranchRecords','%id%','map','query','fromRepositoryRecord','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','1465PRBnHY','%name%','10303531NLOTqR','replace','GET_REPOSITORY_BY_NAME_QUERY','../queries','getOwnPropertyDescriptor','records','10591902GMUQeO','length','Repository\x20with\x20Id\x20','Name','getRepositoryRecordByName','encodeBase64','Attachment','updateRemoteState','24052WrcApF','GET_REPOSITORY_QUERY','__esModule','\x20not\x20found\x20on\x20salesforce','objectType','Branch\x20with\x20Id\x20','toString','apply','getRemoteStateAttachmentId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','38HfFwem','setStatus','Branch\x20','getComponentsFromRepository','metadata','Repository__r','object','\x0a\x20\x20\x20\x20\x20\x20','typedi','disableSync','SalesforceService','%parentId%','getComponents','FLOSUM_NAMESPACE','30SWwqlk','catch','getAllRepositoryNames','5054568IHkMcl','FLOSUM_GIT_NAMESPACE','../../../shared/utils','SalesforceSyncService','constructor','getBranchComponents','createObject','SalesforceNotFoundError','SYNC_ATTACHMENT_FOR_BRANCH_NAME','repositoryId','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','GET_WAITING_BRANCHES_QUERY','Repository\x20','decorate','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','62376UZlkoT','getRepositoryRecords','getBranchRecordByName','10219946alAVQt','defineProperty','__metadata'];a243_0xb436=function(){return _0x2481bf;};return a243_0xb436();}'use strict';var __decorate=this&&this[a243_0x2a250e(0x15a)]||function(_0x3db408,_0xf3fc3,_0x33eb16,_0x28924e){const _0x40bd49=a243_0x2a250e;var _0x27a30a=arguments[_0x40bd49(0x11a)],_0x4de5db=_0x27a30a<0x3?_0xf3fc3:_0x28924e===null?_0x28924e=Object[_0x40bd49(0x117)](_0xf3fc3,_0x33eb16):_0x28924e,_0x173995;if(typeof Reflect===_0x40bd49(0x131)&&typeof Reflect[_0x40bd49(0x14a)]===_0x40bd49(0x103))_0x4de5db=Reflect[_0x40bd49(0x14a)](_0x3db408,_0xf3fc3,_0x33eb16,_0x28924e);else{for(var _0xff026f=_0x3db408['length']-0x1;_0xff026f>=0x0;_0xff026f--)if(_0x173995=_0x3db408[_0xff026f])_0x4de5db=(_0x27a30a<0x3?_0x173995(_0x4de5db):_0x27a30a>0x3?_0x173995(_0xf3fc3,_0x33eb16,_0x4de5db):_0x173995(_0xf3fc3,_0x33eb16))||_0x4de5db;}return _0x27a30a>0x3&&_0x4de5db&&Object['defineProperty'](_0xf3fc3,_0x33eb16,_0x4de5db),_0x4de5db;},__metadata=this&&this[a243_0x2a250e(0x151)]||function(_0x9fdd9c,_0x30b2bf){const _0x479a57=a243_0x2a250e;if(typeof Reflect===_0x479a57(0x131)&&typeof Reflect[_0x479a57(0x12f)]===_0x479a57(0x103))return Reflect[_0x479a57(0x12f)](_0x9fdd9c,_0x30b2bf);};Object[a243_0x2a250e(0x150)](exports,a243_0x2a250e(0x123),{'value':!![]}),exports[a243_0x2a250e(0x13f)]=void 0x0;const typedi_1=require(a243_0x2a250e(0x133)),constants_1=require(a243_0x2a250e(0x15c)),errors_1=require(a243_0x2a250e(0x108)),utils_1=require(a243_0x2a250e(0x13e)),flosum_repository_sync_dto_1=require(a243_0x2a250e(0x164)),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a243_0x2a250e(0x116)),salesforce_query_service_1=require(a243_0x2a250e(0x104)),salesforce_service_1=require(a243_0x2a250e(0x163));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x513522,_0x29eb4d){const _0x18bccd=a243_0x2a250e;this['salesforceQuery']=_0x513522,this[_0x18bccd(0x166)]=_0x29eb4d;}async[a243_0x2a250e(0x137)](_0x579895){const _0x2e9629=a243_0x2a250e;var _0x5142cf;const _0x257f9f=await this[_0x2e9629(0x161)][_0x2e9629(0x10e)](_0x579895),_0xbfa09a=[];for(const _0xe77ae of _0x257f9f){const _0x350d00=(_0x5142cf=_0xe77ae[constants_1[_0x2e9629(0x138)]+'Components__r'])===null||_0x5142cf===void 0x0?void 0x0:_0x5142cf[_0x2e9629(0x118)];_0x350d00&&_0x350d00['length']&&_0xbfa09a[_0x2e9629(0x159)](_0x350d00[0x0]['Id']);}return _0xbfa09a;}async[a243_0x2a250e(0x13b)](_0x1f5e9c){const _0x597d23=a243_0x2a250e,_0xeb87de=await this[_0x597d23(0x161)][_0x597d23(0x10e)](queries_1[_0x597d23(0x15b)][_0x597d23(0x114)](/\%connection_id\%/g,_0x1f5e9c));return _0xeb87de[_0x597d23(0x10d)](_0x5e1037=>{const _0x1141cb=_0x597d23;return _0x5e1037[constants_1[_0x1141cb(0x13d)]+'Repository__r']?_0x5e1037[constants_1[_0x1141cb(0x13d)]+_0x1141cb(0x130)]['Name']:_0x5e1037[_0x1141cb(0x11c)];});}async[a243_0x2a250e(0x14d)](_0x4a603f){const _0x165393=a243_0x2a250e,_0x5f2a13=await this[_0x165393(0x161)]['query'](queries_1[_0x165393(0x15f)][_0x165393(0x114)](/\%connection_id\%/g,_0x4a603f));return _0x5f2a13[_0x165393(0x10d)](_0x568d43=>flosum_repository_sync_dto_1[_0x165393(0x105)]['fromRepositoryRecord'](_0x568d43));}async[a243_0x2a250e(0x10b)](_0x3526cb){const _0x165562=a243_0x2a250e,_0x2e612f=await this[_0x165562(0x161)]['query'](queries_1[_0x165562(0x148)][_0x165562(0x114)](/%repositories_ids\%/g,_0x3526cb));return _0x2e612f[_0x165562(0x10d)](_0x4cfffc=>flosum_repository_sync_dto_1[_0x165562(0x105)][_0x165562(0x154)](_0x4cfffc));}async['getRepositoryRecord'](_0x352666){const _0x2fb7c5=a243_0x2a250e,_0x1a9396=await this[_0x2fb7c5(0x161)]['query'](queries_1[_0x2fb7c5(0x122)][_0x2fb7c5(0x114)](_0x2fb7c5(0x10c),_0x352666));if(_0x1a9396[_0x2fb7c5(0x11a)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x2fb7c5(0x11b)+_0x352666+_0x2fb7c5(0x124));return flosum_repository_sync_dto_1[_0x2fb7c5(0x105)][_0x2fb7c5(0x10f)](_0x1a9396[0x0]);}async[a243_0x2a250e(0x15e)](_0x243917){const _0x46df99=a243_0x2a250e,_0xed3fc0=await this[_0x46df99(0x161)][_0x46df99(0x10e)](queries_1['GET_BRANCH_QUERY'][_0x46df99(0x114)](_0x46df99(0x10c),_0x243917));if(_0xed3fc0['length']===0x0)throw new not_found_error_1[(_0x46df99(0x143))](_0x46df99(0x126)+_0x243917+_0x46df99(0x124));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x46df99(0x154)](_0xed3fc0[0x0]);}async[a243_0x2a250e(0x14e)](_0x5046c4){const _0x177788=a243_0x2a250e,_0x51beff=await this[_0x177788(0x161)][_0x177788(0x10e)](queries_1[_0x177788(0x109)][_0x177788(0x114)](_0x177788(0x112),_0x5046c4));if(_0x51beff[_0x177788(0x11a)]===0x0)throw new not_found_error_1[(_0x177788(0x143))](_0x177788(0x12d)+_0x5046c4+_0x177788(0x124));const _0x5165c4=_0x51beff['find'](_0x45c572=>_0x45c572[constants_1[_0x177788(0x138)]+_0x177788(0x162)]===_0x5046c4);if(!_0x5165c4)throw new not_found_error_1[(_0x177788(0x143))]('Branch\x20'+_0x5046c4+_0x177788(0x124));return flosum_repository_sync_dto_1[_0x177788(0x105)][_0x177788(0x154)](_0x5165c4);}async[a243_0x2a250e(0x11d)](_0x84170e){const _0x2f953a=a243_0x2a250e,_0xdff521=await this[_0x2f953a(0x161)][_0x2f953a(0x10e)](queries_1[_0x2f953a(0x115)][_0x2f953a(0x114)](_0x2f953a(0x112),_0x84170e));if(_0xdff521[_0x2f953a(0x11a)]===0x0)throw new not_found_error_1[(_0x2f953a(0x143))](_0x2f953a(0x149)+_0x84170e+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x2f953a(0x105)]['fromRepositoryRecord'](_0xdff521[0x0]);}async[a243_0x2a250e(0x12e)](_0x5ddb06){const _0x5b9fb0=a243_0x2a250e,_0x36152a=_0x5b9fb0(0x132)+queries_1['GET_COMPONENTS_QUERY']+_0x5b9fb0(0x147)+_0x5ddb06+'\x27';return this[_0x5b9fb0(0x137)](_0x36152a);}async[a243_0x2a250e(0x141)](_0x256e1e){const _0x40151f=a243_0x2a250e,_0x48b88d=_0x40151f(0x12a)+queries_1[_0x40151f(0x106)]+_0x40151f(0x110)+_0x256e1e+'\x27';return this[_0x40151f(0x137)](_0x48b88d);}async[a243_0x2a250e(0x158)](_0x1a22b2){const _0x53a9c5=a243_0x2a250e;var _0x50f871;const _0x4e24e3=queries_1[_0x53a9c5(0x146)][_0x53a9c5(0x114)](_0x53a9c5(0x136),_0x1a22b2[_0x53a9c5(0x102)])[_0x53a9c5(0x114)](_0x53a9c5(0x112),_0x1a22b2[_0x53a9c5(0x145)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x53a9c5(0x144)]),_0xce10b8=await this[_0x53a9c5(0x161)][_0x53a9c5(0x10e)](_0x4e24e3),_0x378f64=(_0x50f871=_0xce10b8[0x0])===null||_0x50f871===void 0x0?void 0x0:_0x50f871['Id'];if(!_0x378f64)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x378f64;}async[a243_0x2a250e(0x129)](_0x147eb7){const _0x412652=a243_0x2a250e;let _0x14393e=await this['getAttachmentId'](_0x147eb7)[_0x412652(0x13a)](()=>null);return!_0x14393e&&(_0x14393e=await this[_0x412652(0x166)][_0x412652(0x142)]('Attachment',{'Body':(0x0,utils_1[_0x412652(0x11e)])('{}'),'ParentId':_0x147eb7[_0x412652(0x102)],'ContentType':_0x412652(0x155),'Name':_0x147eb7[_0x412652(0x145)]?constants_1[_0x412652(0x14b)]:constants_1[_0x412652(0x144)]})),_0x14393e;}async[a243_0x2a250e(0x120)](_0x1454ee,_0x3f5945){const _0x4d0755=a243_0x2a250e,_0x3c675c=await this[_0x4d0755(0x129)](_0x1454ee);await this[_0x4d0755(0x166)][_0x4d0755(0x152)](_0x4d0755(0x11f),_0x3c675c,{'Body':(0x0,utils_1['encodeBase64'])(JSON['stringify'](_0x3f5945))});}async[a243_0x2a250e(0x12c)](_0x1d2107,_0x41e594){const _0x38aa83=a243_0x2a250e;await this[_0x38aa83(0x166)][_0x38aa83(0x152)](_0x1d2107[_0x38aa83(0x125)],_0x1d2107['objectId'],{[constants_1[_0x38aa83(0x13d)]+_0x38aa83(0x160)]:_0x41e594});}async[a243_0x2a250e(0x134)](_0x243ae2){const _0x486e7a=a243_0x2a250e;await this[_0x486e7a(0x166)]['patchObject'](constants_1['FLOSUM_GIT_NAMESPACE']+'Connection__c',_0x243ae2,{[constants_1[_0x486e7a(0x13d)]+_0x486e7a(0x10a)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x2a250e(0x15d)])(),__metadata(a243_0x2a250e(0x165),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a243_0x2a250e(0x135)]])],SalesforceSyncService),exports[a243_0x2a250e(0x13f)]=SalesforceSyncService;