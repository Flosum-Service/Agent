const a243_0x526e5b=a243_0x2246;(function(_0x6c2eea,_0x44eef0){const _0x933c7e=a243_0x2246,_0x97aac2=_0x6c2eea();while(!![]){try{const _0x3ffb22=parseInt(_0x933c7e(0x1d1))/0x1+-parseInt(_0x933c7e(0x1b2))/0x2+-parseInt(_0x933c7e(0x1c8))/0x3*(-parseInt(_0x933c7e(0x1c5))/0x4)+-parseInt(_0x933c7e(0x19c))/0x5*(parseInt(_0x933c7e(0x197))/0x6)+-parseInt(_0x933c7e(0x1b1))/0x7+parseInt(_0x933c7e(0x191))/0x8+-parseInt(_0x933c7e(0x1d6))/0x9;if(_0x3ffb22===_0x44eef0)break;else _0x97aac2['push'](_0x97aac2['shift']());}catch(_0x91a537){_0x97aac2['push'](_0x97aac2['shift']());}}}(a243_0x3109,0x25dc9));const a243_0x58c028=(function(){let _0x513ca2=!![];return function(_0x130097,_0x5c4f22){const _0x4f3258=_0x513ca2?function(){const _0x41df67=a243_0x2246;if(_0x5c4f22){const _0x3142a4=_0x5c4f22[_0x41df67(0x1ca)](_0x130097,arguments);return _0x5c4f22=null,_0x3142a4;}}:function(){};return _0x513ca2=![],_0x4f3258;};}()),a243_0x1299f6=a243_0x58c028(this,function(){const _0x2fe5e9=a243_0x2246;return a243_0x1299f6[_0x2fe5e9(0x1bc)]()['search'](_0x2fe5e9(0x1c4))[_0x2fe5e9(0x1bc)]()[_0x2fe5e9(0x1c1)](a243_0x1299f6)['search'](_0x2fe5e9(0x1c4));});a243_0x1299f6();'use strict';var __decorate=this&&this['__decorate']||function(_0x407ac4,_0x3fef4,_0x393de2,_0x58475b){const _0x3f7525=a243_0x2246;var _0x508886=arguments[_0x3f7525(0x1c6)],_0x50ae89=_0x508886<0x3?_0x3fef4:_0x58475b===null?_0x58475b=Object[_0x3f7525(0x1d5)](_0x3fef4,_0x393de2):_0x58475b,_0x27f89c;if(typeof Reflect===_0x3f7525(0x190)&&typeof Reflect[_0x3f7525(0x1c3)]==='function')_0x50ae89=Reflect['decorate'](_0x407ac4,_0x3fef4,_0x393de2,_0x58475b);else{for(var _0x5a8240=_0x407ac4['length']-0x1;_0x5a8240>=0x0;_0x5a8240--)if(_0x27f89c=_0x407ac4[_0x5a8240])_0x50ae89=(_0x508886<0x3?_0x27f89c(_0x50ae89):_0x508886>0x3?_0x27f89c(_0x3fef4,_0x393de2,_0x50ae89):_0x27f89c(_0x3fef4,_0x393de2))||_0x50ae89;}return _0x508886>0x3&&_0x50ae89&&Object['defineProperty'](_0x3fef4,_0x393de2,_0x50ae89),_0x50ae89;},__metadata=this&&this['__metadata']||function(_0xbfb1d5,_0xd8bead){const _0x4bdab0=a243_0x2246;if(typeof Reflect==='object'&&typeof Reflect[_0x4bdab0(0x1cd)]===_0x4bdab0(0x1ab))return Reflect[_0x4bdab0(0x1cd)](_0xbfb1d5,_0xd8bead);};Object[a243_0x526e5b(0x1cb)](exports,'__esModule',{'value':!![]}),exports['SalesforceSyncService']=void 0x0;function a243_0x3109(){const _0x202d94=['encodeBase64','17515gfDeKp','%id%','Connection__c','FLOSUM_GIT_NAMESPACE','../../../shared/utils','typedi','getComponents','../errors/not-found.error','push','Repository\x20with\x20Id\x20','getRepositoryRecord','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','records','Branch\x20','patchObject','function','\x0a\x20\x20\x20\x20\x20\x20','Repository\x20','objectType','GET_BRANCH_QUERY','../../../../constants/errors','134869kryWUw','420954qNqaZX','GET_REPOSITORY_BY_NAME_QUERY','Attachment','getBranchComponents','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','createObject','GET_WAITING_REPOSITORIES_QUERY','salesforceService','replace','Service','toString','catch','Name','%parentId%','getAttachmentId','constructor','GET_COMPONENTS_QUERY','decorate','(((.+)+)+)+$','144092OCqpTO','length','FlosumRepositorySyncDto','15WvZLnF','Repository__r','apply','defineProperty','%name%','metadata','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','query','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','278123oLnHOl','salesforceQuery','\x20not\x20found\x20on\x20salesforce','getRemoteStateAttachmentId','getOwnPropertyDescriptor','1365948uxsQCd','objectId','fromBranchRecord','Components__r','FLOSUM_NAMESPACE','../queries','getBranchRecords','updateRemoteState','SYNC_ATTACHMENT_FOR_BRANCH_NAME','SalesforceSyncService','Synchronization_Status__c','SalesforceNotFoundError','./salesforce-query.service','GET_BRANCH_BY_NAME_QUERY','find','repositoryId','object','2308312vbibhr','setStatus','Branch_Name__c','map','fromRepositoryRecord','../dto/flosum-repository-sync.dto','360lLzWMX','../../../../constants','SalesforceService','Sync_In_Progress__c'];a243_0x3109=function(){return _0x202d94;};return a243_0x3109();}function a243_0x2246(_0x1e11cd,_0x995b70){const _0x37617e=a243_0x3109();return a243_0x2246=function(_0x1299f6,_0x58c028){_0x1299f6=_0x1299f6-0x18b;let _0x3109b9=_0x37617e[_0x1299f6];return _0x3109b9;},a243_0x2246(_0x1e11cd,_0x995b70);}const typedi_1=require(a243_0x526e5b(0x1a1)),constants_1=require(a243_0x526e5b(0x198)),errors_1=require(a243_0x526e5b(0x1b0)),utils_1=require(a243_0x526e5b(0x1a0)),flosum_repository_sync_dto_1=require(a243_0x526e5b(0x196)),not_found_error_1=require(a243_0x526e5b(0x1a3)),queries_1=require(a243_0x526e5b(0x1db)),salesforce_query_service_1=require(a243_0x526e5b(0x18c)),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0xe0ed47,_0x25221c){const _0x187fa2=a243_0x526e5b;this[_0x187fa2(0x1d2)]=_0xe0ed47,this[_0x187fa2(0x1b9)]=_0x25221c;}async[a243_0x526e5b(0x1a2)](_0x2ab5e4){const _0xfd6517=a243_0x526e5b;var _0x2141ea;const _0x17629d=await this[_0xfd6517(0x1d2)][_0xfd6517(0x1cf)](_0x2ab5e4),_0x5731b6=[];for(const _0x2ffcc4 of _0x17629d){const _0x21cbfd=(_0x2141ea=_0x2ffcc4[constants_1[_0xfd6517(0x1da)]+_0xfd6517(0x1d9)])===null||_0x2141ea===void 0x0?void 0x0:_0x2141ea[_0xfd6517(0x1a8)];_0x21cbfd&&_0x21cbfd[_0xfd6517(0x1c6)]&&_0x5731b6[_0xfd6517(0x1a4)](_0x21cbfd[0x0]['Id']);}return _0x5731b6;}async['getAllRepositoryNames'](_0x5d3c5f){const _0x354d12=a243_0x526e5b,_0x2b635e=await this[_0x354d12(0x1d2)][_0x354d12(0x1cf)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x354d12(0x1ba)](/\%connection_id\%/g,_0x5d3c5f));return _0x2b635e[_0x354d12(0x194)](_0xae0fda=>{const _0x1aea5a=_0x354d12;return _0xae0fda[constants_1[_0x1aea5a(0x19f)]+_0x1aea5a(0x1c9)]?_0xae0fda[constants_1[_0x1aea5a(0x19f)]+_0x1aea5a(0x1c9)][_0x1aea5a(0x1be)]:_0xae0fda[_0x1aea5a(0x1be)];});}async['getRepositoryRecords'](_0x1c18c2){const _0x208f89=a243_0x526e5b,_0x3082ac=await this['salesforceQuery'][_0x208f89(0x1cf)](queries_1[_0x208f89(0x1b8)][_0x208f89(0x1ba)](/\%connection_id\%/g,_0x1c18c2));return _0x3082ac[_0x208f89(0x194)](_0x50a2e1=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x208f89(0x195)](_0x50a2e1));}async[a243_0x526e5b(0x1dc)](_0x4fb4b9){const _0x5704fd=a243_0x526e5b,_0x15067f=await this[_0x5704fd(0x1d2)][_0x5704fd(0x1cf)](queries_1['GET_WAITING_BRANCHES_QUERY'][_0x5704fd(0x1ba)](/%repositories_ids\%/g,_0x4fb4b9));return _0x15067f[_0x5704fd(0x194)](_0x58b3e9=>flosum_repository_sync_dto_1[_0x5704fd(0x1c7)][_0x5704fd(0x1d8)](_0x58b3e9));}async[a243_0x526e5b(0x1a6)](_0x5256e){const _0x523990=a243_0x526e5b,_0x4d1dd9=await this[_0x523990(0x1d2)]['query'](queries_1['GET_REPOSITORY_QUERY']['replace'](_0x523990(0x19d),_0x5256e));if(_0x4d1dd9[_0x523990(0x1c6)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x523990(0x1a5)+_0x5256e+_0x523990(0x1d3));return flosum_repository_sync_dto_1[_0x523990(0x1c7)]['fromRepositoryRecord'](_0x4d1dd9[0x0]);}async['getBranchRecord'](_0x16ae99){const _0x3b43c4=a243_0x526e5b,_0x36494d=await this[_0x3b43c4(0x1d2)]['query'](queries_1[_0x3b43c4(0x1af)]['replace'](_0x3b43c4(0x19d),_0x16ae99));if(_0x36494d[_0x3b43c4(0x1c6)]===0x0)throw new not_found_error_1[(_0x3b43c4(0x18b))]('Branch\x20with\x20Id\x20'+_0x16ae99+_0x3b43c4(0x1d3));return flosum_repository_sync_dto_1[_0x3b43c4(0x1c7)][_0x3b43c4(0x1d8)](_0x36494d[0x0]);}async['getBranchRecordByName'](_0x42b0e2){const _0x854d96=a243_0x526e5b,_0x5b9c28=await this[_0x854d96(0x1d2)]['query'](queries_1[_0x854d96(0x18d)][_0x854d96(0x1ba)](_0x854d96(0x1cc),_0x42b0e2));if(_0x5b9c28['length']===0x0)throw new not_found_error_1[(_0x854d96(0x18b))](_0x854d96(0x1a9)+_0x42b0e2+_0x854d96(0x1d3));const _0xe7cb2a=_0x5b9c28[_0x854d96(0x18e)](_0x3baa1c=>_0x3baa1c[constants_1['FLOSUM_NAMESPACE']+_0x854d96(0x193)]===_0x42b0e2);if(!_0xe7cb2a)throw new not_found_error_1[(_0x854d96(0x18b))](_0x854d96(0x1a9)+_0x42b0e2+_0x854d96(0x1d3));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0xe7cb2a);}async['getRepositoryRecordByName'](_0x356a56){const _0x256fe6=a243_0x526e5b,_0x2d4d18=await this[_0x256fe6(0x1d2)][_0x256fe6(0x1cf)](queries_1[_0x256fe6(0x1b3)][_0x256fe6(0x1ba)](_0x256fe6(0x1cc),_0x356a56));if(_0x2d4d18['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x256fe6(0x1ad)+_0x356a56+_0x256fe6(0x1d3));return flosum_repository_sync_dto_1[_0x256fe6(0x1c7)][_0x256fe6(0x195)](_0x2d4d18[0x0]);}async['getComponentsFromRepository'](_0x32ab18){const _0x6136ca=a243_0x526e5b,_0x3ab156=_0x6136ca(0x1ac)+queries_1['GET_COMPONENTS_QUERY']+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x32ab18+'\x27';return this[_0x6136ca(0x1a2)](_0x3ab156);}async[a243_0x526e5b(0x1b5)](_0x519a78){const _0x4bdb63=a243_0x526e5b,_0x175d27=_0x4bdb63(0x1ce)+queries_1[_0x4bdb63(0x1c2)]+_0x4bdb63(0x1a7)+_0x519a78+'\x27';return this[_0x4bdb63(0x1a2)](_0x175d27);}async[a243_0x526e5b(0x1c0)](_0x4868c1){const _0x2ae16d=a243_0x526e5b;var _0x358b63;const _0x1ee76f=queries_1[_0x2ae16d(0x1d0)][_0x2ae16d(0x1ba)](_0x2ae16d(0x1bf),_0x4868c1[_0x2ae16d(0x1d7)])[_0x2ae16d(0x1ba)]('%name%',_0x4868c1[_0x2ae16d(0x18f)]?constants_1[_0x2ae16d(0x1b6)]:constants_1[_0x2ae16d(0x1de)]),_0x5755c9=await this[_0x2ae16d(0x1d2)][_0x2ae16d(0x1cf)](_0x1ee76f),_0x95136=(_0x358b63=_0x5755c9[0x0])===null||_0x358b63===void 0x0?void 0x0:_0x358b63['Id'];if(!_0x95136)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x95136;}async['getRemoteStateAttachmentId'](_0x2a7ea5){const _0x5e42e9=a243_0x526e5b;let _0x1e1dfc=await this[_0x5e42e9(0x1c0)](_0x2a7ea5)[_0x5e42e9(0x1bd)](()=>null);return!_0x1e1dfc&&(_0x1e1dfc=await this[_0x5e42e9(0x1b9)][_0x5e42e9(0x1b7)](_0x5e42e9(0x1b4),{'Body':(0x0,utils_1[_0x5e42e9(0x19b)])('{}'),'ParentId':_0x2a7ea5[_0x5e42e9(0x1d7)],'ContentType':'text/plain','Name':_0x2a7ea5[_0x5e42e9(0x18f)]?constants_1[_0x5e42e9(0x1b6)]:constants_1[_0x5e42e9(0x1de)]})),_0x1e1dfc;}async[a243_0x526e5b(0x1dd)](_0x3922a2,_0x581857){const _0x237884=a243_0x526e5b,_0xb30372=await this[_0x237884(0x1d4)](_0x3922a2);await this[_0x237884(0x1b9)][_0x237884(0x1aa)](_0x237884(0x1b4),_0xb30372,{'Body':(0x0,utils_1[_0x237884(0x19b)])(JSON['stringify'](_0x581857))});}async[a243_0x526e5b(0x192)](_0xb9a232,_0x4bf40){const _0x397ac0=a243_0x526e5b;await this[_0x397ac0(0x1b9)]['patchObject'](_0xb9a232[_0x397ac0(0x1ae)],_0xb9a232[_0x397ac0(0x1d7)],{[constants_1[_0x397ac0(0x19f)]+_0x397ac0(0x1e0)]:_0x4bf40});}async['disableSync'](_0x3ac859){const _0x3c878c=a243_0x526e5b;await this[_0x3c878c(0x1b9)][_0x3c878c(0x1aa)](constants_1[_0x3c878c(0x19f)]+_0x3c878c(0x19e),_0x3ac859,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x3c878c(0x19a)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a243_0x526e5b(0x1bb)])(),__metadata('design:paramtypes',[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a243_0x526e5b(0x199)]])],SalesforceSyncService),exports[a243_0x526e5b(0x1df)]=SalesforceSyncService;