const a238_0xfd80e3=a238_0x5f00;function a238_0x5f00(_0x16c839,_0x1414d2){const _0x479db1=a238_0x38ca();return a238_0x5f00=function(_0x530133,_0x2f6e5f){_0x530133=_0x530133-0x99;let _0x38ca96=_0x479db1[_0x530133];return _0x38ca96;},a238_0x5f00(_0x16c839,_0x1414d2);}(function(_0x4657b4,_0x1ef82e){const _0x55627b=a238_0x5f00,_0x44ca00=_0x4657b4();while(!![]){try{const _0x480646=parseInt(_0x55627b(0xa1))/0x1*(parseInt(_0x55627b(0x9b))/0x2)+-parseInt(_0x55627b(0xe1))/0x3*(-parseInt(_0x55627b(0xeb))/0x4)+parseInt(_0x55627b(0xcf))/0x5+-parseInt(_0x55627b(0xa8))/0x6*(parseInt(_0x55627b(0xc6))/0x7)+parseInt(_0x55627b(0xb9))/0x8+parseInt(_0x55627b(0xf1))/0x9*(-parseInt(_0x55627b(0xbb))/0xa)+parseInt(_0x55627b(0xa2))/0xb;if(_0x480646===_0x1ef82e)break;else _0x44ca00['push'](_0x44ca00['shift']());}catch(_0x55e5f8){_0x44ca00['push'](_0x44ca00['shift']());}}}(a238_0x38ca,0xb74b7));const a238_0x2f6e5f=(function(){let _0x396d9d=!![];return function(_0x12b9a8,_0x45bf8d){const _0x34c064=_0x396d9d?function(){const _0xb5f3cb=a238_0x5f00;if(_0x45bf8d){const _0x26c51d=_0x45bf8d[_0xb5f3cb(0xab)](_0x12b9a8,arguments);return _0x45bf8d=null,_0x26c51d;}}:function(){};return _0x396d9d=![],_0x34c064;};}()),a238_0x530133=a238_0x2f6e5f(this,function(){const _0x222ea7=a238_0x5f00;return a238_0x530133[_0x222ea7(0x9d)]()[_0x222ea7(0xf0)]('(((.+)+)+)+$')[_0x222ea7(0x9d)]()[_0x222ea7(0xac)](a238_0x530133)[_0x222ea7(0xf0)](_0x222ea7(0xe5));});a238_0x530133();function a238_0x38ca(){const _0x30ef67=['GET_REPOSITORY_QUERY','../../../../constants/errors','apply','constructor','getOwnPropertyDescriptor','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','SalesforceService','FlosumRepositorySyncDto','Repository\x20with\x20Id\x20','../errors/not-found.error','GET_REPOSITORIES_NAMES_QUERY','../queries','getComponentsFromRepository','ERR_INVALID_ATTACHMENT_ID','design:paramtypes','Repository__r','4981432YqsORk','getAttachmentId','370SVLmbJ','GET_COMPONENTS_QUERY','%id%','getBranchComponents','getBranchRecord','SalesforceSyncService','object','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','patchObject','query','records','8977864bjktDj','../../../shared/utils','replace','objectId','GET_BRANCH_QUERY','Sync_In_Progress__c','getRepositoryRecords','./salesforce.service','SalesforceQueryService','572175BqVQtV','fromBranchRecord','Synchronization_Status__c','FLOSUM_GIT_NAMESPACE','salesforceService','defineProperty','getComponents','createObject','setStatus','__esModule','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','Branch\x20with\x20Id\x20','Name','metadata','getRemoteStateAttachmentId','Attachment','./salesforce-query.service','\x20not\x20found\x20on\x20salesforce','33fCunVc','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','find','../../../../constants','(((.+)+)+)+$','repositoryId','disableSync','function','getAllRepositoryNames','Branch_Name__c','71412HyaKxZ','salesforceQuery','Service','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','push','search','328014QzrccL','fromRepositoryRecord','SalesforceNotFoundError','decorate','catch','1800024lhzJmW','objectType','toString','FLOSUM_NAMESPACE','length','Components__r','1NVCAYL','17031520VMBbMe','map','Branch\x20','../dto/flosum-repository-sync.dto','%name%','typedi','6VhFtEI'];a238_0x38ca=function(){return _0x30ef67;};return a238_0x38ca();}'use strict';var __decorate=this&&this['__decorate']||function(_0x265b3d,_0x103676,_0x506b9f,_0xfed0b2){const _0xd43a9f=a238_0x5f00;var _0x199e2e=arguments[_0xd43a9f(0x9f)],_0x52ef00=_0x199e2e<0x3?_0x103676:_0xfed0b2===null?_0xfed0b2=Object[_0xd43a9f(0xad)](_0x103676,_0x506b9f):_0xfed0b2,_0xf4adc3;if(typeof Reflect===_0xd43a9f(0xc1)&&typeof Reflect[_0xd43a9f(0x99)]==='function')_0x52ef00=Reflect[_0xd43a9f(0x99)](_0x265b3d,_0x103676,_0x506b9f,_0xfed0b2);else{for(var _0x4209af=_0x265b3d[_0xd43a9f(0x9f)]-0x1;_0x4209af>=0x0;_0x4209af--)if(_0xf4adc3=_0x265b3d[_0x4209af])_0x52ef00=(_0x199e2e<0x3?_0xf4adc3(_0x52ef00):_0x199e2e>0x3?_0xf4adc3(_0x103676,_0x506b9f,_0x52ef00):_0xf4adc3(_0x103676,_0x506b9f))||_0x52ef00;}return _0x199e2e>0x3&&_0x52ef00&&Object[_0xd43a9f(0xd4)](_0x103676,_0x506b9f,_0x52ef00),_0x52ef00;},__metadata=this&&this['__metadata']||function(_0x35e8b3,_0x6c828d){const _0x130036=a238_0x5f00;if(typeof Reflect==='object'&&typeof Reflect[_0x130036(0xdc)]===_0x130036(0xe8))return Reflect['metadata'](_0x35e8b3,_0x6c828d);};Object[a238_0xfd80e3(0xd4)](exports,a238_0xfd80e3(0xd8),{'value':!![]}),exports[a238_0xfd80e3(0xc0)]=void 0x0;const typedi_1=require(a238_0xfd80e3(0xa7)),constants_1=require(a238_0xfd80e3(0xe4)),errors_1=require(a238_0xfd80e3(0xaa)),utils_1=require(a238_0xfd80e3(0xc7)),flosum_repository_sync_dto_1=require(a238_0xfd80e3(0xa5)),not_found_error_1=require(a238_0xfd80e3(0xb2)),queries_1=require(a238_0xfd80e3(0xb4)),salesforce_query_service_1=require(a238_0xfd80e3(0xdf)),salesforce_service_1=require(a238_0xfd80e3(0xcd));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x5d341b,_0x529fe2){const _0x818c2=a238_0xfd80e3;this['salesforceQuery']=_0x5d341b,this[_0x818c2(0xd3)]=_0x529fe2;}async[a238_0xfd80e3(0xd5)](_0x27394f){const _0xf4a11=a238_0xfd80e3;var _0x39f3c1;const _0x16d9a9=await this[_0xf4a11(0xec)]['query'](_0x27394f),_0x1dd48b=[];for(const _0xdb5cd7 of _0x16d9a9){const _0x5a963d=(_0x39f3c1=_0xdb5cd7[constants_1[_0xf4a11(0x9e)]+_0xf4a11(0xa0)])===null||_0x39f3c1===void 0x0?void 0x0:_0x39f3c1[_0xf4a11(0xc5)];_0x5a963d&&_0x5a963d[_0xf4a11(0x9f)]&&_0x1dd48b[_0xf4a11(0xef)](_0x5a963d[0x0]['Id']);}return _0x1dd48b;}async[a238_0xfd80e3(0xe9)](_0x44b21e){const _0x13dac8=a238_0xfd80e3,_0x28c69f=await this[_0x13dac8(0xec)][_0x13dac8(0xc4)](queries_1[_0x13dac8(0xb3)][_0x13dac8(0xc8)](/\%connection_id\%/g,_0x44b21e));return _0x28c69f[_0x13dac8(0xa3)](_0x2b86de=>{const _0x16ef2e=_0x13dac8;return _0x2b86de[constants_1['FLOSUM_GIT_NAMESPACE']+'Repository__r']?_0x2b86de[constants_1[_0x16ef2e(0xd2)]+_0x16ef2e(0xb8)][_0x16ef2e(0xdb)]:_0x2b86de[_0x16ef2e(0xdb)];});}async[a238_0xfd80e3(0xcc)](_0x328263){const _0x11c11c=a238_0xfd80e3,_0x5d7079=await this[_0x11c11c(0xec)]['query'](queries_1['GET_WAITING_REPOSITORIES_QUERY'][_0x11c11c(0xc8)](/\%connection_id\%/g,_0x328263));return _0x5d7079[_0x11c11c(0xa3)](_0x29131a=>flosum_repository_sync_dto_1[_0x11c11c(0xb0)]['fromRepositoryRecord'](_0x29131a));}async['getBranchRecords'](_0x1ac4ae){const _0x29c367=a238_0xfd80e3,_0x503a22=await this['salesforceQuery'][_0x29c367(0xc4)](queries_1['GET_WAITING_BRANCHES_QUERY'][_0x29c367(0xc8)](/%repositories_ids\%/g,_0x1ac4ae));return _0x503a22[_0x29c367(0xa3)](_0x5d2f2c=>flosum_repository_sync_dto_1[_0x29c367(0xb0)][_0x29c367(0xd0)](_0x5d2f2c));}async['getRepositoryRecord'](_0x11aa89){const _0x4acced=a238_0xfd80e3,_0x128cd6=await this[_0x4acced(0xec)][_0x4acced(0xc4)](queries_1[_0x4acced(0xa9)][_0x4acced(0xc8)](_0x4acced(0xbd),_0x11aa89));if(_0x128cd6[_0x4acced(0x9f)]===0x0)throw new not_found_error_1[(_0x4acced(0xf3))](_0x4acced(0xb1)+_0x11aa89+_0x4acced(0xe0));return flosum_repository_sync_dto_1[_0x4acced(0xb0)]['fromRepositoryRecord'](_0x128cd6[0x0]);}async[a238_0xfd80e3(0xbf)](_0x7e7266){const _0x13ab6e=a238_0xfd80e3,_0x105d00=await this['salesforceQuery'][_0x13ab6e(0xc4)](queries_1[_0x13ab6e(0xca)][_0x13ab6e(0xc8)](_0x13ab6e(0xbd),_0x7e7266));if(_0x105d00[_0x13ab6e(0x9f)]===0x0)throw new not_found_error_1[(_0x13ab6e(0xf3))](_0x13ab6e(0xda)+_0x7e7266+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x13ab6e(0xb0)]['fromBranchRecord'](_0x105d00[0x0]);}async['getBranchRecordByName'](_0x2578e1){const _0x37012c=a238_0xfd80e3,_0x55b837=await this[_0x37012c(0xec)]['query'](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x37012c(0xc8)](_0x37012c(0xa6),_0x2578e1));if(_0x55b837[_0x37012c(0x9f)]===0x0)throw new not_found_error_1[(_0x37012c(0xf3))](_0x37012c(0xa4)+_0x2578e1+_0x37012c(0xe0));const _0x50f081=_0x55b837[_0x37012c(0xe3)](_0x309b1a=>_0x309b1a[constants_1[_0x37012c(0x9e)]+_0x37012c(0xea)]===_0x2578e1);if(!_0x50f081)throw new not_found_error_1[(_0x37012c(0xf3))]('Branch\x20'+_0x2578e1+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x37012c(0xb0)][_0x37012c(0xd0)](_0x50f081);}async['getRepositoryRecordByName'](_0x20da52){const _0x123cb9=a238_0xfd80e3,_0x107b4=await this['salesforceQuery'][_0x123cb9(0xc4)](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0x123cb9(0xc8)](_0x123cb9(0xa6),_0x20da52));if(_0x107b4[_0x123cb9(0x9f)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Repository\x20'+_0x20da52+_0x123cb9(0xe0));return flosum_repository_sync_dto_1[_0x123cb9(0xb0)][_0x123cb9(0xf2)](_0x107b4[0x0]);}async[a238_0xfd80e3(0xb5)](_0x475b0b){const _0x689caf=a238_0xfd80e3,_0x33cadb='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x689caf(0xbc)]+_0x689caf(0xc2)+_0x475b0b+'\x27';return this['getComponents'](_0x33cadb);}async[a238_0xfd80e3(0xbe)](_0xe921a8){const _0x509a96=a238_0xfd80e3,_0x48c7ee=_0x509a96(0xae)+queries_1[_0x509a96(0xbc)]+_0x509a96(0xd9)+_0xe921a8+'\x27';return this[_0x509a96(0xd5)](_0x48c7ee);}async[a238_0xfd80e3(0xba)](_0x130c21){const _0x359767=a238_0xfd80e3;var _0x323bb2;const _0x2c597c=queries_1[_0x359767(0xe2)][_0x359767(0xc8)]('%parentId%',_0x130c21['objectId'])[_0x359767(0xc8)](_0x359767(0xa6),_0x130c21[_0x359767(0xe6)]?constants_1[_0x359767(0xee)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x10345a=await this[_0x359767(0xec)]['query'](_0x2c597c),_0x4dae3b=(_0x323bb2=_0x10345a[0x0])===null||_0x323bb2===void 0x0?void 0x0:_0x323bb2['Id'];if(!_0x4dae3b)throw new Error(errors_1[_0x359767(0xb6)]);return _0x4dae3b;}async[a238_0xfd80e3(0xdd)](_0x6388bd){const _0xad2e78=a238_0xfd80e3;let _0x918067=await this['getAttachmentId'](_0x6388bd)[_0xad2e78(0x9a)](()=>null);return!_0x918067&&(_0x918067=await this[_0xad2e78(0xd3)][_0xad2e78(0xd6)](_0xad2e78(0xde),{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x6388bd[_0xad2e78(0xc9)],'ContentType':'text/plain','Name':_0x6388bd['repositoryId']?constants_1[_0xad2e78(0xee)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x918067;}async['updateRemoteState'](_0x1d9224,_0x4f5f59){const _0x1e8e7d=a238_0xfd80e3,_0x20c7b9=await this[_0x1e8e7d(0xdd)](_0x1d9224);await this[_0x1e8e7d(0xd3)][_0x1e8e7d(0xc3)](_0x1e8e7d(0xde),_0x20c7b9,{'Body':(0x0,utils_1['encodeBase64'])(JSON['stringify'](_0x4f5f59))});}async[a238_0xfd80e3(0xd7)](_0x3d48c0,_0x8198a6){const _0x5aa44d=a238_0xfd80e3;await this['salesforceService'][_0x5aa44d(0xc3)](_0x3d48c0[_0x5aa44d(0x9c)],_0x3d48c0[_0x5aa44d(0xc9)],{[constants_1[_0x5aa44d(0xd2)]+_0x5aa44d(0xd1)]:_0x8198a6});}async[a238_0xfd80e3(0xe7)](_0x4e218f){const _0x504c84=a238_0xfd80e3;await this[_0x504c84(0xd3)][_0x504c84(0xc3)](constants_1['FLOSUM_GIT_NAMESPACE']+'Connection__c',_0x4e218f,{[constants_1[_0x504c84(0xd2)]+_0x504c84(0xcb)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a238_0xfd80e3(0xed)])(),__metadata(a238_0xfd80e3(0xb7),[salesforce_query_service_1[a238_0xfd80e3(0xce)],salesforce_service_1[a238_0xfd80e3(0xaf)]])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;