const a282_0x1b947b=a282_0xcadd;function a282_0xcadd(_0x412df7,_0x1172c8){const _0x505aea=a282_0x151c();return a282_0xcadd=function(_0x14f15a,_0x466780){_0x14f15a=_0x14f15a-0xce;let _0x151caf=_0x505aea[_0x14f15a];return _0x151caf;},a282_0xcadd(_0x412df7,_0x1172c8);}(function(_0x5ccb66,_0x1fc470){const _0x57a092=a282_0xcadd,_0x2b9377=_0x5ccb66();while(!![]){try{const _0x309bbe=parseInt(_0x57a092(0x114))/0x1*(parseInt(_0x57a092(0x110))/0x2)+parseInt(_0x57a092(0x102))/0x3+-parseInt(_0x57a092(0x104))/0x4*(parseInt(_0x57a092(0xeb))/0x5)+-parseInt(_0x57a092(0xe9))/0x6*(parseInt(_0x57a092(0x106))/0x7)+-parseInt(_0x57a092(0xf9))/0x8*(-parseInt(_0x57a092(0xd1))/0x9)+parseInt(_0x57a092(0x10b))/0xa*(-parseInt(_0x57a092(0x120))/0xb)+parseInt(_0x57a092(0xf4))/0xc*(parseInt(_0x57a092(0xd8))/0xd);if(_0x309bbe===_0x1fc470)break;else _0x2b9377['push'](_0x2b9377['shift']());}catch(_0x10af27){_0x2b9377['push'](_0x2b9377['shift']());}}}(a282_0x151c,0xcdc21));const a282_0x466780=(function(){let _0x278726=!![];return function(_0x5d07ed,_0x1a3b22){const _0x4fb214=_0x278726?function(){const _0x13f56d=a282_0xcadd;if(_0x1a3b22){const _0xb8db71=_0x1a3b22[_0x13f56d(0xe1)](_0x5d07ed,arguments);return _0x1a3b22=null,_0xb8db71;}}:function(){};return _0x278726=![],_0x4fb214;};}()),a282_0x14f15a=a282_0x466780(this,function(){const _0x44f45c=a282_0xcadd;return a282_0x14f15a[_0x44f45c(0x108)]()[_0x44f45c(0xf2)](_0x44f45c(0xfb))['toString']()[_0x44f45c(0xf8)](a282_0x14f15a)[_0x44f45c(0xf2)](_0x44f45c(0xfb));});a282_0x14f15a();'use strict';var __decorate=this&&this[a282_0x1b947b(0x11e)]||function(_0xf78163,_0x1842c5,_0x264993,_0x5f0ac1){const _0x321196=a282_0x1b947b;var _0xa70178=arguments[_0x321196(0x11a)],_0x4f0be1=_0xa70178<0x3?_0x1842c5:_0x5f0ac1===null?_0x5f0ac1=Object['getOwnPropertyDescriptor'](_0x1842c5,_0x264993):_0x5f0ac1,_0x583d7e;if(typeof Reflect===_0x321196(0x12a)&&typeof Reflect[_0x321196(0xd9)]===_0x321196(0xf7))_0x4f0be1=Reflect['decorate'](_0xf78163,_0x1842c5,_0x264993,_0x5f0ac1);else{for(var _0x140f98=_0xf78163[_0x321196(0x11a)]-0x1;_0x140f98>=0x0;_0x140f98--)if(_0x583d7e=_0xf78163[_0x140f98])_0x4f0be1=(_0xa70178<0x3?_0x583d7e(_0x4f0be1):_0xa70178>0x3?_0x583d7e(_0x1842c5,_0x264993,_0x4f0be1):_0x583d7e(_0x1842c5,_0x264993))||_0x4f0be1;}return _0xa70178>0x3&&_0x4f0be1&&Object['defineProperty'](_0x1842c5,_0x264993,_0x4f0be1),_0x4f0be1;},__metadata=this&&this[a282_0x1b947b(0xdd)]||function(_0x3b2f1a,_0x4ad76a){const _0x2aaf33=a282_0x1b947b;if(typeof Reflect===_0x2aaf33(0x12a)&&typeof Reflect[_0x2aaf33(0x10d)]===_0x2aaf33(0xf7))return Reflect['metadata'](_0x3b2f1a,_0x4ad76a);};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a282_0x1b947b(0xe4)),constants_1=require(a282_0x1b947b(0xd6)),errors_1=require(a282_0x1b947b(0xf6)),utils_1=require(a282_0x1b947b(0xef)),flosum_repository_sync_dto_1=require(a282_0x1b947b(0xdc)),not_found_error_1=require(a282_0x1b947b(0xce)),queries_1=require(a282_0x1b947b(0xe8)),salesforce_query_service_1=require(a282_0x1b947b(0x10a)),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0x50dea0,_0x4c95e1){const _0x599311=a282_0x1b947b;this[_0x599311(0xde)]=_0x50dea0,this['salesforceService']=_0x4c95e1;}async[a282_0x1b947b(0xe6)](_0x4a0bc9){const _0x19a869=a282_0x1b947b;var _0x250130;const _0x58319e=await this[_0x19a869(0xde)][_0x19a869(0x11c)](_0x4a0bc9),_0x324485=[];for(const _0x35fcce of _0x58319e){const _0x48d53c=(_0x250130=_0x35fcce[constants_1[_0x19a869(0x113)]+'Components__r'])===null||_0x250130===void 0x0?void 0x0:_0x250130['records'];_0x48d53c&&_0x48d53c['length']&&_0x324485['push'](_0x48d53c[0x0]['Id']);}return _0x324485;}async[a282_0x1b947b(0xfa)](_0x3a88e4){const _0x5700bc=a282_0x1b947b,_0x448602=await this[_0x5700bc(0xde)][_0x5700bc(0x11c)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x5700bc(0x10e)](/\%connection_id\%/g,_0x3a88e4));return _0x448602[_0x5700bc(0xf0)](_0xa51023=>{const _0x3de3d6=_0x5700bc;return _0xa51023[constants_1[_0x3de3d6(0xe5)]+_0x3de3d6(0x126)]?_0xa51023[constants_1[_0x3de3d6(0xe5)]+_0x3de3d6(0x126)]['Name']:_0xa51023[_0x3de3d6(0xe2)];});}async[a282_0x1b947b(0x11f)](_0x4fd391){const _0x559b1f=a282_0x1b947b,_0x59ba3d=await this[_0x559b1f(0xde)][_0x559b1f(0x11c)](queries_1[_0x559b1f(0x103)][_0x559b1f(0x10e)](/\%connection_id\%/g,_0x4fd391));return _0x59ba3d[_0x559b1f(0xf0)](_0x50eb9b=>flosum_repository_sync_dto_1[_0x559b1f(0x118)][_0x559b1f(0xdf)](_0x50eb9b));}async[a282_0x1b947b(0xfc)](_0x39c4e5){const _0xcae36f=a282_0x1b947b,_0x35d52b=await this[_0xcae36f(0xde)][_0xcae36f(0x11c)](queries_1[_0xcae36f(0xdb)][_0xcae36f(0x10e)](/%repositories_ids\%/g,_0x39c4e5));return _0x35d52b[_0xcae36f(0xf0)](_0x31de69=>flosum_repository_sync_dto_1[_0xcae36f(0x118)][_0xcae36f(0x117)](_0x31de69));}async[a282_0x1b947b(0x112)](_0x161327){const _0x146113=a282_0x1b947b,_0xd93a01=await this[_0x146113(0xde)][_0x146113(0x11c)](queries_1[_0x146113(0x12c)][_0x146113(0x10e)](_0x146113(0x129),_0x161327));if(_0xd93a01[_0x146113(0x11a)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x146113(0x122)+_0x161327+_0x146113(0xec));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromRepositoryRecord'](_0xd93a01[0x0]);}async[a282_0x1b947b(0x109)](_0xd58a9c){const _0x59a815=a282_0x1b947b,_0x4d76dc=await this['salesforceQuery'][_0x59a815(0x11c)](queries_1['GET_BRANCH_QUERY'][_0x59a815(0x10e)]('%id%',_0xd58a9c));if(_0x4d76dc[_0x59a815(0x11a)]===0x0)throw new not_found_error_1[(_0x59a815(0x12d))](_0x59a815(0xed)+_0xd58a9c+_0x59a815(0xec));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x59a815(0x117)](_0x4d76dc[0x0]);}async[a282_0x1b947b(0xf5)](_0x7dc402){const _0x49823d=a282_0x1b947b,_0x29e01a=await this[_0x49823d(0xde)][_0x49823d(0x11c)](queries_1[_0x49823d(0xfd)][_0x49823d(0x10e)](_0x49823d(0x111),_0x7dc402));if(_0x29e01a['length']===0x0)throw new not_found_error_1[(_0x49823d(0x12d))](_0x49823d(0xfe)+_0x7dc402+'\x20not\x20found\x20on\x20salesforce');const _0x759236=_0x29e01a[_0x49823d(0xee)](_0x3a91bb=>_0x3a91bb[constants_1[_0x49823d(0x113)]+_0x49823d(0xf3)]===_0x7dc402);if(!_0x759236)throw new not_found_error_1[(_0x49823d(0x12d))](_0x49823d(0xfe)+_0x7dc402+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x49823d(0x117)](_0x759236);}async[a282_0x1b947b(0xff)](_0x445912){const _0x2b0f90=a282_0x1b947b,_0x1da4ff=await this['salesforceQuery']['query'](queries_1[_0x2b0f90(0xd7)][_0x2b0f90(0x10e)](_0x2b0f90(0x111),_0x445912));if(_0x1da4ff[_0x2b0f90(0x11a)]===0x0)throw new not_found_error_1[(_0x2b0f90(0x12d))]('Repository\x20'+_0x445912+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x2b0f90(0x118)][_0x2b0f90(0xdf)](_0x1da4ff[0x0]);}async[a282_0x1b947b(0xea)](_0x2e84b7){const _0x3107a3=a282_0x1b947b,_0x274614='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x3107a3(0x100)]+_0x3107a3(0x12f)+_0x2e84b7+'\x27';return this[_0x3107a3(0xe6)](_0x274614);}async[a282_0x1b947b(0x12b)](_0x5bd04c){const _0x6f9b0a=a282_0x1b947b,_0x115240=_0x6f9b0a(0x11d)+queries_1['GET_COMPONENTS_QUERY']+_0x6f9b0a(0x128)+_0x5bd04c+'\x27';return this['getComponents'](_0x115240);}async[a282_0x1b947b(0x10f)](_0x2422c8){const _0x30fde9=a282_0x1b947b;var _0x4f9684;const _0x4337a9=queries_1[_0x30fde9(0xd5)][_0x30fde9(0x10e)](_0x30fde9(0xcf),_0x2422c8[_0x30fde9(0x125)])[_0x30fde9(0x10e)](_0x30fde9(0x111),_0x2422c8['repositoryId']?constants_1[_0x30fde9(0x115)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x22c524=await this['salesforceQuery'][_0x30fde9(0x11c)](_0x4337a9),_0x39b742=(_0x4f9684=_0x22c524[0x0])===null||_0x4f9684===void 0x0?void 0x0:_0x4f9684['Id'];if(!_0x39b742)throw new Error(errors_1[_0x30fde9(0x116)]);return _0x39b742;}async[a282_0x1b947b(0x121)](_0x1554bf){const _0x188cc1=a282_0x1b947b;let _0x47a0f7=await this[_0x188cc1(0x10f)](_0x1554bf)[_0x188cc1(0xd3)](()=>null);return!_0x47a0f7&&(_0x47a0f7=await this[_0x188cc1(0x123)][_0x188cc1(0x119)](_0x188cc1(0x107),{'Body':(0x0,utils_1[_0x188cc1(0x10c)])('{}'),'ParentId':_0x1554bf['objectId'],'ContentType':'text/plain','Name':_0x1554bf[_0x188cc1(0x12e)]?constants_1[_0x188cc1(0x115)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x47a0f7;}async[a282_0x1b947b(0x127)](_0x3e4df0,_0x3e118f){const _0x45fa32=a282_0x1b947b,_0x331233=await this[_0x45fa32(0x121)](_0x3e4df0);await this[_0x45fa32(0x123)][_0x45fa32(0xe0)]('Attachment',_0x331233,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x45fa32(0xe3)](_0x3e118f))});}async[a282_0x1b947b(0xd4)](_0x26dbdf,_0x55a2d4){const _0x40a25e=a282_0x1b947b;await this[_0x40a25e(0x123)]['patchObject'](_0x26dbdf[_0x40a25e(0x101)],_0x26dbdf['objectId'],{[constants_1[_0x40a25e(0xe5)]+_0x40a25e(0xe7)]:_0x55a2d4});}async[a282_0x1b947b(0x105)](_0x56ffd0){const _0x15e032=a282_0x1b947b;await this[_0x15e032(0x123)][_0x15e032(0xe0)](constants_1[_0x15e032(0xe5)]+_0x15e032(0xda),_0x56ffd0,{[constants_1[_0x15e032(0xe5)]+_0x15e032(0xf1)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a282_0x1b947b(0xd0)])(),__metadata(a282_0x1b947b(0x11b),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a282_0x1b947b(0x124)]])],SalesforceSyncService),exports[a282_0x1b947b(0xd2)]=SalesforceSyncService;function a282_0x151c(){const _0x2093a3=['1093443GElGcv','decorate','Connection__c','GET_WAITING_BRANCHES_QUERY','../dto/flosum-repository-sync.dto','__metadata','salesforceQuery','fromRepositoryRecord','patchObject','apply','Name','stringify','typedi','FLOSUM_GIT_NAMESPACE','getComponents','Synchronization_Status__c','../queries','7605036AXWvum','getComponentsFromRepository','5EybCCm','\x20not\x20found\x20on\x20salesforce','Branch\x20with\x20Id\x20','find','../../../shared/utils','map','Sync_In_Progress__c','search','Branch_Name__c','288EqUDiS','getBranchRecordByName','../../../../constants/errors','function','constructor','8ywAObU','getAllRepositoryNames','(((.+)+)+)+$','getBranchRecords','GET_BRANCH_BY_NAME_QUERY','Branch\x20','getRepositoryRecordByName','GET_COMPONENTS_QUERY','objectType','3241971qtwmOC','GET_WAITING_REPOSITORIES_QUERY','3081136Nnfmlb','disableSync','7dqoFaZ','Attachment','toString','getBranchRecord','./salesforce-query.service','10ZhTAzy','encodeBase64','metadata','replace','getAttachmentId','80486emZeRk','%name%','getRepositoryRecord','FLOSUM_NAMESPACE','5pCMyJK','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','ERR_INVALID_ATTACHMENT_ID','fromBranchRecord','FlosumRepositorySyncDto','createObject','length','design:paramtypes','query','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','__decorate','getRepositoryRecords','7275818qaqNvf','getRemoteStateAttachmentId','Repository\x20with\x20Id\x20','salesforceService','SalesforceService','objectId','Repository__r','updateRemoteState','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','%id%','object','getBranchComponents','GET_REPOSITORY_QUERY','SalesforceNotFoundError','repositoryId','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','../errors/not-found.error','%parentId%','Service','2173293FejWCf','SalesforceSyncService','catch','setStatus','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','../../../../constants','GET_REPOSITORY_BY_NAME_QUERY'];a282_0x151c=function(){return _0x2093a3;};return a282_0x151c();}