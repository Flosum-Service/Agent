const a191_0x269812=a191_0x5796;function a191_0x3541(){const _0x3c06b4=['patchObject','salesforceQuery','getRepositoryRecords','objectId','../queries','getBranchRecords','GET_COMPONENTS_QUERY','3388446HpDnod','GET_WAITING_BRANCHES_QUERY','FLOSUM_GIT_NAMESPACE','Connection__c','GET_REPOSITORIES_NAMES_QUERY','GET_WAITING_REPOSITORIES_QUERY','GET_REPOSITORY_QUERY','fromRepositoryRecord','getBranchComponents','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','FLOSUM_NAMESPACE','34025xtZoIY','metadata','ERR_INVALID_ATTACHMENT_ID','6649687TYZulN','776DaYQDa','Repository\x20with\x20Id\x20','214fOlwor','length','__metadata','Service','../errors/not-found.error','./salesforce-query.service','SalesforceQueryService','3WNqDCc','(((.+)+)+)+$','query','encodeBase64','GET_BRANCH_BY_NAME_QUERY','getAllRepositoryNames','push','objectType','toString','fromBranchRecord','decorate','getComponents','SalesforceSyncService','__decorate','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','../../../../constants/errors','\x20not\x20found\x20on\x20salesforce','FlosumRepositorySyncDto','setStatus','function','SYNC_ATTACHMENT_FOR_BRANCH_NAME','GET_REPOSITORY_BY_NAME_QUERY','search','SalesforceNotFoundError','3079INoIkl','Branch\x20','./salesforce.service','\x0a\x20\x20\x20\x20\x20\x20','object','Branch\x20with\x20Id\x20','GET_BRANCH_QUERY','getBranchRecordByName','getRemoteStateAttachmentId','Sync_In_Progress__c','replace','getAttachmentId','%name%','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','constructor','map','Repository\x20','336jMrpbB','catch','10311PkddAe','Attachment','typedi','%parentId%','getOwnPropertyDescriptor','Name','Repository__r','%id%','1191828AHgWzN','SalesforceService','text/plain','salesforceService','createObject','../dto/flosum-repository-sync.dto','../../../shared/utils','1198220NgIgHT','defineProperty','stringify','../../../../constants','getRepositoryRecord'];a191_0x3541=function(){return _0x3c06b4;};return a191_0x3541();}(function(_0x340845,_0x53eca2){const _0x27df1f=a191_0x5796,_0x51e94a=_0x340845();while(!![]){try{const _0x39042b=-parseInt(_0x27df1f(0x1bd))/0x1*(parseInt(_0x27df1f(0x1fc))/0x2)+-parseInt(_0x27df1f(0x203))/0x3*(parseInt(_0x27df1f(0x1d8))/0x4)+-parseInt(_0x27df1f(0x1f6))/0x5*(-parseInt(_0x27df1f(0x1ce))/0x6)+parseInt(_0x27df1f(0x1d0))/0x7*(parseInt(_0x27df1f(0x1fa))/0x8)+-parseInt(_0x27df1f(0x1eb))/0x9+parseInt(_0x27df1f(0x1df))/0xa+parseInt(_0x27df1f(0x1f9))/0xb;if(_0x39042b===_0x53eca2)break;else _0x51e94a['push'](_0x51e94a['shift']());}catch(_0x3835b3){_0x51e94a['push'](_0x51e94a['shift']());}}}(a191_0x3541,0x3baac));const a191_0x7d9c5e=(function(){let _0x65576e=!![];return function(_0x3627a0,_0x1094e4){const _0x3e6bd4=_0x65576e?function(){if(_0x1094e4){const _0x3c50d2=_0x1094e4['apply'](_0x3627a0,arguments);return _0x1094e4=null,_0x3c50d2;}}:function(){};return _0x65576e=![],_0x3e6bd4;};}()),a191_0x2d1d7a=a191_0x7d9c5e(this,function(){const _0x2ecd39=a191_0x5796;return a191_0x2d1d7a[_0x2ecd39(0x20b)]()[_0x2ecd39(0x1bb)](_0x2ecd39(0x204))[_0x2ecd39(0x20b)]()[_0x2ecd39(0x1cb)](a191_0x2d1d7a)['search'](_0x2ecd39(0x204));});a191_0x2d1d7a();'use strict';function a191_0x5796(_0x5c18ff,_0x1a5569){const _0xdb6041=a191_0x3541();return a191_0x5796=function(_0x2d1d7a,_0x7d9c5e){_0x2d1d7a=_0x2d1d7a-0x1b9;let _0x35413b=_0xdb6041[_0x2d1d7a];return _0x35413b;},a191_0x5796(_0x5c18ff,_0x1a5569);}var __decorate=this&&this[a191_0x269812(0x210)]||function(_0x43e2ee,_0x426383,_0x1f7739,_0x56438c){const _0xa724ff=a191_0x269812;var _0x20fe50=arguments[_0xa724ff(0x1fd)],_0x420a2f=_0x20fe50<0x3?_0x426383:_0x56438c===null?_0x56438c=Object[_0xa724ff(0x1d4)](_0x426383,_0x1f7739):_0x56438c,_0x3c9b70;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0xa724ff(0x216))_0x420a2f=Reflect[_0xa724ff(0x20d)](_0x43e2ee,_0x426383,_0x1f7739,_0x56438c);else{for(var _0x5151fd=_0x43e2ee['length']-0x1;_0x5151fd>=0x0;_0x5151fd--)if(_0x3c9b70=_0x43e2ee[_0x5151fd])_0x420a2f=(_0x20fe50<0x3?_0x3c9b70(_0x420a2f):_0x20fe50>0x3?_0x3c9b70(_0x426383,_0x1f7739,_0x420a2f):_0x3c9b70(_0x426383,_0x1f7739))||_0x420a2f;}return _0x20fe50>0x3&&_0x420a2f&&Object[_0xa724ff(0x1e0)](_0x426383,_0x1f7739,_0x420a2f),_0x420a2f;},__metadata=this&&this[a191_0x269812(0x1fe)]||function(_0x48ca4a,_0x2dcb55){const _0xf4057b=a191_0x269812;if(typeof Reflect===_0xf4057b(0x1c1)&&typeof Reflect['metadata']===_0xf4057b(0x216))return Reflect[_0xf4057b(0x1f7)](_0x48ca4a,_0x2dcb55);};Object[a191_0x269812(0x1e0)](exports,'__esModule',{'value':!![]}),exports[a191_0x269812(0x20f)]=void 0x0;const typedi_1=require(a191_0x269812(0x1d2)),constants_1=require(a191_0x269812(0x1e2)),errors_1=require(a191_0x269812(0x212)),utils_1=require(a191_0x269812(0x1de)),flosum_repository_sync_dto_1=require(a191_0x269812(0x1dd)),not_found_error_1=require(a191_0x269812(0x200)),queries_1=require(a191_0x269812(0x1e8)),salesforce_query_service_1=require(a191_0x269812(0x201)),salesforce_service_1=require(a191_0x269812(0x1bf));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x431574,_0x508a68){const _0x54ee01=a191_0x269812;this[_0x54ee01(0x1e5)]=_0x431574,this[_0x54ee01(0x1db)]=_0x508a68;}async[a191_0x269812(0x20e)](_0x277241){const _0x73f703=a191_0x269812;var _0x190ed9;const _0xa5a00c=await this[_0x73f703(0x1e5)][_0x73f703(0x205)](_0x277241),_0x4d9b24=[];for(const _0x2ec478 of _0xa5a00c){const _0x3cf5c1=(_0x190ed9=_0x2ec478[constants_1[_0x73f703(0x1f5)]+'Components__r'])===null||_0x190ed9===void 0x0?void 0x0:_0x190ed9['records'];_0x3cf5c1&&_0x3cf5c1['length']&&_0x4d9b24[_0x73f703(0x209)](_0x3cf5c1[0x0]['Id']);}return _0x4d9b24;}async[a191_0x269812(0x208)](_0xb37691){const _0xb10a04=a191_0x269812,_0x769536=await this[_0xb10a04(0x1e5)][_0xb10a04(0x205)](queries_1[_0xb10a04(0x1ef)][_0xb10a04(0x1c7)](/\%connection_id\%/g,_0xb37691));return _0x769536[_0xb10a04(0x1cc)](_0x17f657=>{const _0x43f5da=_0xb10a04;return _0x17f657[constants_1[_0x43f5da(0x1ed)]+_0x43f5da(0x1d6)]?_0x17f657[constants_1[_0x43f5da(0x1ed)]+'Repository__r'][_0x43f5da(0x1d5)]:_0x17f657[_0x43f5da(0x1d5)];});}async[a191_0x269812(0x1e6)](_0x3de589){const _0x4771b2=a191_0x269812,_0x484ce3=await this[_0x4771b2(0x1e5)]['query'](queries_1[_0x4771b2(0x1f0)]['replace'](/\%connection_id\%/g,_0x3de589));return _0x484ce3['map'](_0x2161c3=>flosum_repository_sync_dto_1[_0x4771b2(0x214)][_0x4771b2(0x1f2)](_0x2161c3));}async[a191_0x269812(0x1e9)](_0x5ab31c){const _0x3270da=a191_0x269812,_0x174fab=await this[_0x3270da(0x1e5)]['query'](queries_1[_0x3270da(0x1ec)][_0x3270da(0x1c7)](/%repositories_ids\%/g,_0x5ab31c));return _0x174fab[_0x3270da(0x1cc)](_0x1bf412=>flosum_repository_sync_dto_1[_0x3270da(0x214)]['fromBranchRecord'](_0x1bf412));}async[a191_0x269812(0x1e3)](_0x201278){const _0x3624d6=a191_0x269812,_0x239be3=await this[_0x3624d6(0x1e5)][_0x3624d6(0x205)](queries_1[_0x3624d6(0x1f1)]['replace']('%id%',_0x201278));if(_0x239be3[_0x3624d6(0x1fd)]===0x0)throw new not_found_error_1[(_0x3624d6(0x1bc))](_0x3624d6(0x1fb)+_0x201278+_0x3624d6(0x213));return flosum_repository_sync_dto_1[_0x3624d6(0x214)][_0x3624d6(0x1f2)](_0x239be3[0x0]);}async['getBranchRecord'](_0x382b34){const _0x1fa7b4=a191_0x269812,_0x2bcfdc=await this[_0x1fa7b4(0x1e5)][_0x1fa7b4(0x205)](queries_1[_0x1fa7b4(0x1c3)]['replace'](_0x1fa7b4(0x1d7),_0x382b34));if(_0x2bcfdc[_0x1fa7b4(0x1fd)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x1fa7b4(0x1c2)+_0x382b34+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x1fa7b4(0x214)][_0x1fa7b4(0x20c)](_0x2bcfdc[0x0]);}async[a191_0x269812(0x1c4)](_0x5f3a7e){const _0x55f0c8=a191_0x269812,_0x4ef5be=await this[_0x55f0c8(0x1e5)][_0x55f0c8(0x205)](queries_1[_0x55f0c8(0x207)]['replace'](_0x55f0c8(0x1c9),_0x5f3a7e));if(_0x4ef5be[_0x55f0c8(0x1fd)]===0x0)throw new not_found_error_1[(_0x55f0c8(0x1bc))](_0x55f0c8(0x1be)+_0x5f3a7e+_0x55f0c8(0x213));return flosum_repository_sync_dto_1[_0x55f0c8(0x214)]['fromBranchRecord'](_0x4ef5be[0x0]);}async['getRepositoryRecordByName'](_0x4e63ee){const _0xa7c810=a191_0x269812,_0xd8b480=await this[_0xa7c810(0x1e5)]['query'](queries_1[_0xa7c810(0x1ba)]['replace'](_0xa7c810(0x1c9),_0x4e63ee));if(_0xd8b480[_0xa7c810(0x1fd)]===0x0)throw new not_found_error_1[(_0xa7c810(0x1bc))](_0xa7c810(0x1cd)+_0x4e63ee+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0xa7c810(0x1f2)](_0xd8b480[0x0]);}async['getComponentsFromRepository'](_0x29dd7d){const _0xd83b2=a191_0x269812,_0x5934ab=_0xd83b2(0x1c0)+queries_1['GET_COMPONENTS_QUERY']+_0xd83b2(0x1f4)+_0x29dd7d+'\x27';return this[_0xd83b2(0x20e)](_0x5934ab);}async[a191_0x269812(0x1f3)](_0x29a5ae){const _0x18a8bc=a191_0x269812,_0x28337b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x18a8bc(0x1ea)]+_0x18a8bc(0x211)+_0x29a5ae+'\x27';return this[_0x18a8bc(0x20e)](_0x28337b);}async[a191_0x269812(0x1c8)](_0x2cb662){const _0x408c12=a191_0x269812;var _0x3c9133;const _0x4c6d56=queries_1['GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY'][_0x408c12(0x1c7)](_0x408c12(0x1d3),_0x2cb662[_0x408c12(0x1e7)])[_0x408c12(0x1c7)](_0x408c12(0x1c9),_0x2cb662['repositoryId']?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x408c12(0x1b9)]),_0x6669=await this[_0x408c12(0x1e5)]['query'](_0x4c6d56),_0x2f6546=(_0x3c9133=_0x6669[0x0])===null||_0x3c9133===void 0x0?void 0x0:_0x3c9133['Id'];if(!_0x2f6546)throw new Error(errors_1[_0x408c12(0x1f8)]);return _0x2f6546;}async[a191_0x269812(0x1c5)](_0x581df1){const _0x442555=a191_0x269812;let _0x31924b=await this['getAttachmentId'](_0x581df1)[_0x442555(0x1cf)](()=>null);return!_0x31924b&&(_0x31924b=await this[_0x442555(0x1db)][_0x442555(0x1dc)](_0x442555(0x1d1),{'Body':utils_1[_0x442555(0x206)]('{}'),'ParentId':_0x581df1[_0x442555(0x1e7)],'ContentType':_0x442555(0x1da),'Name':_0x581df1['repositoryId']?constants_1[_0x442555(0x1ca)]:constants_1[_0x442555(0x1b9)]})),_0x31924b;}async['updateRemoteState'](_0x4c0a57,_0x123ce4){const _0x1eb424=a191_0x269812,_0x2ebcda=await this[_0x1eb424(0x1c5)](_0x4c0a57);await this[_0x1eb424(0x1db)][_0x1eb424(0x1e4)](_0x1eb424(0x1d1),_0x2ebcda,{'Body':utils_1['encodeBase64'](JSON[_0x1eb424(0x1e1)](_0x123ce4))});}async[a191_0x269812(0x215)](_0x2858cc,_0xc93a6d){const _0x1ea3d7=a191_0x269812;await this[_0x1ea3d7(0x1db)][_0x1ea3d7(0x1e4)](_0x2858cc[_0x1ea3d7(0x20a)],_0x2858cc[_0x1ea3d7(0x1e7)],{[constants_1[_0x1ea3d7(0x1ed)]+'Synchronization_Status__c']:_0xc93a6d});}async['disableSync'](_0x12b689){const _0x18e0ca=a191_0x269812;await this[_0x18e0ca(0x1db)][_0x18e0ca(0x1e4)](constants_1[_0x18e0ca(0x1ed)]+_0x18e0ca(0x1ee),_0x12b689,{[constants_1[_0x18e0ca(0x1ed)]+_0x18e0ca(0x1c6)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a191_0x269812(0x1ff)](),__metadata('design:paramtypes',[salesforce_query_service_1[a191_0x269812(0x202)],salesforce_service_1[a191_0x269812(0x1d9)]])],SalesforceSyncService),exports[a191_0x269812(0x20f)]=SalesforceSyncService;