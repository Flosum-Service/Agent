const a243_0x5db0ef=a243_0x5248;(function(_0x236dbe,_0x49e9c7){const _0xd9f0da=a243_0x5248,_0x5dd546=_0x236dbe();while(!![]){try{const _0xb734c8=-parseInt(_0xd9f0da(0xa5))/0x1*(-parseInt(_0xd9f0da(0xc5))/0x2)+-parseInt(_0xd9f0da(0xbd))/0x3+parseInt(_0xd9f0da(0x85))/0x4*(-parseInt(_0xd9f0da(0x82))/0x5)+parseInt(_0xd9f0da(0x86))/0x6*(-parseInt(_0xd9f0da(0xba))/0x7)+parseInt(_0xd9f0da(0x9d))/0x8+parseInt(_0xd9f0da(0xae))/0x9*(parseInt(_0xd9f0da(0xd4))/0xa)+-parseInt(_0xd9f0da(0xac))/0xb*(-parseInt(_0xd9f0da(0xc0))/0xc);if(_0xb734c8===_0x49e9c7)break;else _0x5dd546['push'](_0x5dd546['shift']());}catch(_0x4c8a3c){_0x5dd546['push'](_0x5dd546['shift']());}}}(a243_0x4882,0xde068));const a243_0x348d62=(function(){let _0x2f9ac4=!![];return function(_0x2b4f1a,_0x40abd1){const _0x15f588=_0x2f9ac4?function(){const _0x5f3bcf=a243_0x5248;if(_0x40abd1){const _0x5868bd=_0x40abd1[_0x5f3bcf(0xb5)](_0x2b4f1a,arguments);return _0x40abd1=null,_0x5868bd;}}:function(){};return _0x2f9ac4=![],_0x15f588;};}()),a243_0x3a6969=a243_0x348d62(this,function(){const _0x4056e1=a243_0x5248;return a243_0x3a6969[_0x4056e1(0xd0)]()[_0x4056e1(0xd9)](_0x4056e1(0xb8))[_0x4056e1(0xd0)]()[_0x4056e1(0x89)](a243_0x3a6969)[_0x4056e1(0xd9)]('(((.+)+)+)+$');});function a243_0x4882(){const _0x5f1574=['FlosumRepositorySyncDto','__esModule','__decorate','getAttachmentId','Name','Repository__r','toString','getBranchComponents','\x20not\x20found\x20on\x20salesforce','text/plain','139070vQpBHu','getBranchRecordByName','object','replace','SalesforceService','search','query','Repository\x20with\x20Id\x20','fromRepositoryRecord','defineProperty','salesforceService','getComponentsFromRepository','../../../../constants/errors','GET_REPOSITORIES_NAMES_QUERY','SalesforceNotFoundError','Branch\x20','FLOSUM_NAMESPACE','./salesforce.service','7043155pxvBuv','stringify','map','4ImWEUY','6HRLMoF','Synchronization_Status__c','GET_WAITING_BRANCHES_QUERY','constructor','GET_REPOSITORY_BY_NAME_QUERY','%id%','length','__metadata','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','typedi','SalesforceSyncService','records','Components__r','Attachment','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','patchObject','fromBranchRecord','metadata','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','encodeBase64','disableSync','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','9521488krqHbw','getRepositoryRecords','\x0a\x20\x20\x20\x20\x20\x20','getComponents','createObject','GET_REPOSITORY_QUERY','getRemoteStateAttachmentId','salesforceQuery','151031SNqDea','getBranchRecords','ERR_INVALID_ATTACHMENT_ID','design:paramtypes','GET_BRANCH_QUERY','Branch_Name__c','SalesforceQueryService','649vqVbOH','../queries','405OAMcRV','../errors/not-found.error','GET_COMPONENTS_QUERY','decorate','objectId','getRepositoryRecord','Branch\x20with\x20Id\x20','apply','%parentId%','../../../../constants','(((.+)+)+)+$','getAllRepositoryNames','8591114TMdylP','SYNC_ATTACHMENT_FOR_BRANCH_NAME','FLOSUM_GIT_NAMESPACE','279747CeONOJ','push','setStatus','63516vTLOVU','function','repositoryId','getRepositoryRecordByName','catch','20VjMODg','../../../shared/utils','objectType','GET_WAITING_REPOSITORIES_QUERY','%name%'];a243_0x4882=function(){return _0x5f1574;};return a243_0x4882();}a243_0x3a6969();'use strict';var __decorate=this&&this[a243_0x5db0ef(0xcc)]||function(_0x4b754d,_0x13ee9a,_0x2fda13,_0x22318e){const _0x4400f4=a243_0x5db0ef;var _0x5cbfa8=arguments[_0x4400f4(0x8c)],_0x43472d=_0x5cbfa8<0x3?_0x13ee9a:_0x22318e===null?_0x22318e=Object['getOwnPropertyDescriptor'](_0x13ee9a,_0x2fda13):_0x22318e,_0x13a3f5;if(typeof Reflect===_0x4400f4(0xd6)&&typeof Reflect[_0x4400f4(0xb1)]===_0x4400f4(0xc1))_0x43472d=Reflect[_0x4400f4(0xb1)](_0x4b754d,_0x13ee9a,_0x2fda13,_0x22318e);else{for(var _0x5455a7=_0x4b754d[_0x4400f4(0x8c)]-0x1;_0x5455a7>=0x0;_0x5455a7--)if(_0x13a3f5=_0x4b754d[_0x5455a7])_0x43472d=(_0x5cbfa8<0x3?_0x13a3f5(_0x43472d):_0x5cbfa8>0x3?_0x13a3f5(_0x13ee9a,_0x2fda13,_0x43472d):_0x13a3f5(_0x13ee9a,_0x2fda13))||_0x43472d;}return _0x5cbfa8>0x3&&_0x43472d&&Object[_0x4400f4(0x79)](_0x13ee9a,_0x2fda13,_0x43472d),_0x43472d;},__metadata=this&&this[a243_0x5db0ef(0x8d)]||function(_0xc2bb4d,_0x17973c){const _0x2cfbf3=a243_0x5db0ef;if(typeof Reflect==='object'&&typeof Reflect[_0x2cfbf3(0x97)]===_0x2cfbf3(0xc1))return Reflect[_0x2cfbf3(0x97)](_0xc2bb4d,_0x17973c);};Object[a243_0x5db0ef(0x79)](exports,a243_0x5db0ef(0xcb),{'value':!![]}),exports[a243_0x5db0ef(0x90)]=void 0x0;const typedi_1=require(a243_0x5db0ef(0x8f)),constants_1=require(a243_0x5db0ef(0xb7)),errors_1=require(a243_0x5db0ef(0x7c)),utils_1=require(a243_0x5db0ef(0xc6)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a243_0x5db0ef(0xaf)),queries_1=require(a243_0x5db0ef(0xad)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a243_0x5db0ef(0x81));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x147c38,_0x463065){const _0x52723f=a243_0x5db0ef;this[_0x52723f(0xa4)]=_0x147c38,this[_0x52723f(0x7a)]=_0x463065;}async[a243_0x5db0ef(0xa0)](_0x5369e0){const _0x5d2d27=a243_0x5db0ef;var _0x344a7c;const _0x2eefd7=await this[_0x5d2d27(0xa4)]['query'](_0x5369e0),_0x46de4f=[];for(const _0x19801e of _0x2eefd7){const _0x32c2fe=(_0x344a7c=_0x19801e[constants_1[_0x5d2d27(0x80)]+_0x5d2d27(0x92)])===null||_0x344a7c===void 0x0?void 0x0:_0x344a7c[_0x5d2d27(0x91)];_0x32c2fe&&_0x32c2fe[_0x5d2d27(0x8c)]&&_0x46de4f[_0x5d2d27(0xbe)](_0x32c2fe[0x0]['Id']);}return _0x46de4f;}async[a243_0x5db0ef(0xb9)](_0x18ad51){const _0x46b54e=a243_0x5db0ef,_0x17ba34=await this[_0x46b54e(0xa4)]['query'](queries_1[_0x46b54e(0x7d)]['replace'](/\%connection_id\%/g,_0x18ad51));return _0x17ba34['map'](_0x377f7a=>{const _0x109f32=_0x46b54e;return _0x377f7a[constants_1[_0x109f32(0xbc)]+_0x109f32(0xcf)]?_0x377f7a[constants_1['FLOSUM_GIT_NAMESPACE']+'Repository__r'][_0x109f32(0xce)]:_0x377f7a[_0x109f32(0xce)];});}async[a243_0x5db0ef(0x9e)](_0x1f5e82){const _0x4df6cc=a243_0x5db0ef,_0x44ebab=await this[_0x4df6cc(0xa4)][_0x4df6cc(0xda)](queries_1[_0x4df6cc(0xc8)]['replace'](/\%connection_id\%/g,_0x1f5e82));return _0x44ebab[_0x4df6cc(0x84)](_0x1e4d7a=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x4df6cc(0xdc)](_0x1e4d7a));}async[a243_0x5db0ef(0xa6)](_0x58d709){const _0xc33f74=a243_0x5db0ef,_0x5047e2=await this[_0xc33f74(0xa4)]['query'](queries_1[_0xc33f74(0x88)][_0xc33f74(0xd7)](/%repositories_ids\%/g,_0x58d709));return _0x5047e2[_0xc33f74(0x84)](_0x10d17c=>flosum_repository_sync_dto_1[_0xc33f74(0xca)][_0xc33f74(0x96)](_0x10d17c));}async[a243_0x5db0ef(0xb3)](_0x13b011){const _0x209165=a243_0x5db0ef,_0x417819=await this[_0x209165(0xa4)][_0x209165(0xda)](queries_1[_0x209165(0xa2)][_0x209165(0xd7)](_0x209165(0x8b),_0x13b011));if(_0x417819[_0x209165(0x8c)]===0x0)throw new not_found_error_1[(_0x209165(0x7e))](_0x209165(0xdb)+_0x13b011+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x209165(0xca)][_0x209165(0xdc)](_0x417819[0x0]);}async['getBranchRecord'](_0x1af824){const _0x3c023c=a243_0x5db0ef,_0x423c54=await this['salesforceQuery']['query'](queries_1[_0x3c023c(0xa9)][_0x3c023c(0xd7)](_0x3c023c(0x8b),_0x1af824));if(_0x423c54[_0x3c023c(0x8c)]===0x0)throw new not_found_error_1[(_0x3c023c(0x7e))](_0x3c023c(0xb4)+_0x1af824+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x3c023c(0x96)](_0x423c54[0x0]);}async[a243_0x5db0ef(0xd5)](_0x55d9e4){const _0x2f299f=a243_0x5db0ef,_0x4f5966=await this[_0x2f299f(0xa4)][_0x2f299f(0xda)](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x2f299f(0xd7)](_0x2f299f(0xc9),_0x55d9e4));if(_0x4f5966['length']===0x0)throw new not_found_error_1[(_0x2f299f(0x7e))](_0x2f299f(0x7f)+_0x55d9e4+_0x2f299f(0xd2));const _0x3ea0cd=_0x4f5966['find'](_0x4567af=>_0x4567af[constants_1[_0x2f299f(0x80)]+_0x2f299f(0xaa)]===_0x55d9e4);if(!_0x3ea0cd)throw new not_found_error_1['SalesforceNotFoundError'](_0x2f299f(0x7f)+_0x55d9e4+_0x2f299f(0xd2));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x2f299f(0x96)](_0x3ea0cd);}async[a243_0x5db0ef(0xc3)](_0x40172f){const _0xa44dbd=a243_0x5db0ef,_0x2e411b=await this[_0xa44dbd(0xa4)][_0xa44dbd(0xda)](queries_1[_0xa44dbd(0x8a)]['replace'](_0xa44dbd(0xc9),_0x40172f));if(_0x2e411b[_0xa44dbd(0x8c)]===0x0)throw new not_found_error_1[(_0xa44dbd(0x7e))]('Repository\x20'+_0x40172f+_0xa44dbd(0xd2));return flosum_repository_sync_dto_1[_0xa44dbd(0xca)]['fromRepositoryRecord'](_0x2e411b[0x0]);}async[a243_0x5db0ef(0x7b)](_0x449bde){const _0x54b50c=a243_0x5db0ef,_0x24a408=_0x54b50c(0x9f)+queries_1[_0x54b50c(0xb0)]+_0x54b50c(0x9b)+_0x449bde+'\x27';return this[_0x54b50c(0xa0)](_0x24a408);}async[a243_0x5db0ef(0xd1)](_0x12165e){const _0x4a86ed=a243_0x5db0ef,_0x28a7fa=_0x4a86ed(0x9c)+queries_1['GET_COMPONENTS_QUERY']+_0x4a86ed(0x8e)+_0x12165e+'\x27';return this[_0x4a86ed(0xa0)](_0x28a7fa);}async[a243_0x5db0ef(0xcd)](_0x249efa){const _0x2b5297=a243_0x5db0ef;var _0x1f50b7;const _0x565e12=queries_1[_0x2b5297(0x94)][_0x2b5297(0xd7)](_0x2b5297(0xb6),_0x249efa[_0x2b5297(0xb2)])[_0x2b5297(0xd7)](_0x2b5297(0xc9),_0x249efa[_0x2b5297(0xc2)]?constants_1[_0x2b5297(0x98)]:constants_1[_0x2b5297(0xbb)]),_0x4c98a7=await this[_0x2b5297(0xa4)]['query'](_0x565e12),_0x3c108b=(_0x1f50b7=_0x4c98a7[0x0])===null||_0x1f50b7===void 0x0?void 0x0:_0x1f50b7['Id'];if(!_0x3c108b)throw new Error(errors_1[_0x2b5297(0xa7)]);return _0x3c108b;}async[a243_0x5db0ef(0xa3)](_0x238c19){const _0x49a7bf=a243_0x5db0ef;let _0x3a091e=await this[_0x49a7bf(0xcd)](_0x238c19)[_0x49a7bf(0xc4)](()=>null);return!_0x3a091e&&(_0x3a091e=await this['salesforceService'][_0x49a7bf(0xa1)](_0x49a7bf(0x93),{'Body':(0x0,utils_1[_0x49a7bf(0x99)])('{}'),'ParentId':_0x238c19[_0x49a7bf(0xb2)],'ContentType':_0x49a7bf(0xd3),'Name':_0x238c19[_0x49a7bf(0xc2)]?constants_1[_0x49a7bf(0x98)]:constants_1[_0x49a7bf(0xbb)]})),_0x3a091e;}async['updateRemoteState'](_0x14705e,_0x501ae6){const _0x339f5b=a243_0x5db0ef,_0x5ca589=await this[_0x339f5b(0xa3)](_0x14705e);await this['salesforceService'][_0x339f5b(0x95)](_0x339f5b(0x93),_0x5ca589,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x339f5b(0x83)](_0x501ae6))});}async[a243_0x5db0ef(0xbf)](_0x8accba,_0x1ba046){const _0x30c2ab=a243_0x5db0ef;await this[_0x30c2ab(0x7a)][_0x30c2ab(0x95)](_0x8accba[_0x30c2ab(0xc7)],_0x8accba[_0x30c2ab(0xb2)],{[constants_1[_0x30c2ab(0xbc)]+_0x30c2ab(0x87)]:_0x1ba046});}async[a243_0x5db0ef(0x9a)](_0x50b685){const _0x407d82=a243_0x5db0ef;await this['salesforceService'][_0x407d82(0x95)](constants_1[_0x407d82(0xbc)]+'Connection__c',_0x50b685,{[constants_1[_0x407d82(0xbc)]+'Sync_In_Progress__c']:![]});}};function a243_0x5248(_0x180bc8,_0x39b310){const _0x192439=a243_0x4882();return a243_0x5248=function(_0x3a6969,_0x348d62){_0x3a6969=_0x3a6969-0x79;let _0x488271=_0x192439[_0x3a6969];return _0x488271;},a243_0x5248(_0x180bc8,_0x39b310);}SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a243_0x5db0ef(0xa8),[salesforce_query_service_1[a243_0x5db0ef(0xab)],salesforce_service_1[a243_0x5db0ef(0xd8)]])],SalesforceSyncService),exports[a243_0x5db0ef(0x90)]=SalesforceSyncService;