const a254_0x495e0d=a254_0x51f7;(function(_0x21519b,_0x59bd04){const _0x1176d4=a254_0x51f7,_0x3ac281=_0x21519b();while(!![]){try{const _0x9010e6=-parseInt(_0x1176d4(0x10f))/0x1+-parseInt(_0x1176d4(0x12e))/0x2+-parseInt(_0x1176d4(0x147))/0x3*(-parseInt(_0x1176d4(0x151))/0x4)+parseInt(_0x1176d4(0x13d))/0x5*(-parseInt(_0x1176d4(0x142))/0x6)+-parseInt(_0x1176d4(0x120))/0x7*(parseInt(_0x1176d4(0x115))/0x8)+parseInt(_0x1176d4(0x11e))/0x9+parseInt(_0x1176d4(0x10c))/0xa*(parseInt(_0x1176d4(0x134))/0xb);if(_0x9010e6===_0x59bd04)break;else _0x3ac281['push'](_0x3ac281['shift']());}catch(_0x1ecc72){_0x3ac281['push'](_0x3ac281['shift']());}}}(a254_0x5283,0x959d4));const a254_0x141d9e=(function(){let _0x35707f=!![];return function(_0x557ca7,_0x56ae57){const _0x33166a=_0x35707f?function(){const _0x1ba8f2=a254_0x51f7;if(_0x56ae57){const _0x44879c=_0x56ae57[_0x1ba8f2(0x14b)](_0x557ca7,arguments);return _0x56ae57=null,_0x44879c;}}:function(){};return _0x35707f=![],_0x33166a;};}()),a254_0x5d86b0=a254_0x141d9e(this,function(){const _0x3842de=a254_0x51f7;return a254_0x5d86b0[_0x3842de(0x12f)]()[_0x3842de(0x108)](_0x3842de(0x123))['toString']()['constructor'](a254_0x5d86b0)[_0x3842de(0x108)]('(((.+)+)+)+$');});a254_0x5d86b0();'use strict';function a254_0x5283(){const _0x20c179=['GET_WAITING_REPOSITORIES_QUERY','fromBranchRecord','getComponents','createObject','\x20not\x20found\x20on\x20salesforce','disableSync','search','../../../shared/utils','getBranchRecordByName','decorate','7950isZoDA','metadata','length','684005AFiQbD','text/plain','../dto/flosum-repository-sync.dto','map','SalesforceNotFoundError','Repository__r','3262136fjiYRe','../queries','%id%','updateRemoteState','encodeBase64','__esModule','object','ERR_INVALID_ATTACHMENT_ID','__metadata','5552739LvOwzK','push','21wKrQih','FlosumRepositorySyncDto','Branch\x20','(((.+)+)+)+$','typedi','salesforceService','salesforceQuery','\x0a\x20\x20\x20\x20\x20\x20','Synchronization_Status__c','Connection__c','Repository\x20','objectId','getBranchRecords','__decorate','902692QFkhSG','toString','SalesforceSyncService','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','%name%','FLOSUM_GIT_NAMESPACE','29689hsjmQi','GET_COMPONENTS_QUERY','repositoryId','getAttachmentId','function','objectType','Attachment','Name','getRepositoryRecordByName','225HGChqh','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','replace','Components__r','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','123882lpYJXu','query','records','SalesforceService','find','3413733ralmux','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','FLOSUM_NAMESPACE','design:paramtypes','apply','Branch\x20with\x20Id\x20','getRemoteStateAttachmentId','GET_BRANCH_BY_NAME_QUERY','Sync_In_Progress__c','fromRepositoryRecord','4fvXpee','GET_REPOSITORY_QUERY','%parentId%','getBranchComponents','getComponentsFromRepository','SYNC_ATTACHMENT_FOR_BRANCH_NAME','patchObject','./salesforce.service','Branch_Name__c','./salesforce-query.service','getRepositoryRecords','Repository\x20with\x20Id\x20','setStatus','defineProperty','GET_REPOSITORY_BY_NAME_QUERY','stringify','getBranchRecord','GET_BRANCH_QUERY'];a254_0x5283=function(){return _0x20c179;};return a254_0x5283();}function a254_0x51f7(_0x2d97dc,_0xe0f875){const _0x2ce829=a254_0x5283();return a254_0x51f7=function(_0x5d86b0,_0x141d9e){_0x5d86b0=_0x5d86b0-0x102;let _0x52836c=_0x2ce829[_0x5d86b0];return _0x52836c;},a254_0x51f7(_0x2d97dc,_0xe0f875);}var __decorate=this&&this[a254_0x495e0d(0x12d)]||function(_0x5aa0b2,_0x5f23d1,_0xacecf0,_0x1ad876){const _0x380f05=a254_0x495e0d;var _0x4d6958=arguments[_0x380f05(0x10e)],_0x85fb11=_0x4d6958<0x3?_0x5f23d1:_0x1ad876===null?_0x1ad876=Object['getOwnPropertyDescriptor'](_0x5f23d1,_0xacecf0):_0x1ad876,_0x416c9f;if(typeof Reflect==='object'&&typeof Reflect[_0x380f05(0x10b)]===_0x380f05(0x138))_0x85fb11=Reflect['decorate'](_0x5aa0b2,_0x5f23d1,_0xacecf0,_0x1ad876);else{for(var _0x479e47=_0x5aa0b2[_0x380f05(0x10e)]-0x1;_0x479e47>=0x0;_0x479e47--)if(_0x416c9f=_0x5aa0b2[_0x479e47])_0x85fb11=(_0x4d6958<0x3?_0x416c9f(_0x85fb11):_0x4d6958>0x3?_0x416c9f(_0x5f23d1,_0xacecf0,_0x85fb11):_0x416c9f(_0x5f23d1,_0xacecf0))||_0x85fb11;}return _0x4d6958>0x3&&_0x85fb11&&Object[_0x380f05(0x15e)](_0x5f23d1,_0xacecf0,_0x85fb11),_0x85fb11;},__metadata=this&&this[a254_0x495e0d(0x11d)]||function(_0x5e952b,_0xe827e0){const _0x555411=a254_0x495e0d;if(typeof Reflect===_0x555411(0x11b)&&typeof Reflect[_0x555411(0x10d)]==='function')return Reflect[_0x555411(0x10d)](_0x5e952b,_0xe827e0);};Object['defineProperty'](exports,a254_0x495e0d(0x11a),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a254_0x495e0d(0x124)),constants_1=require('../../../../constants'),errors_1=require('../../../../constants/errors'),utils_1=require(a254_0x495e0d(0x109)),flosum_repository_sync_dto_1=require(a254_0x495e0d(0x111)),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a254_0x495e0d(0x116)),salesforce_query_service_1=require(a254_0x495e0d(0x15a)),salesforce_service_1=require(a254_0x495e0d(0x158));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x1ca623,_0x289015){const _0x1b57fb=a254_0x495e0d;this[_0x1b57fb(0x126)]=_0x1ca623,this[_0x1b57fb(0x125)]=_0x289015;}async[a254_0x495e0d(0x104)](_0x454a04){const _0xa0e160=a254_0x495e0d;var _0x1e91ff;const _0x3dcedb=await this['salesforceQuery'][_0xa0e160(0x143)](_0x454a04),_0x66d6c=[];for(const _0x303599 of _0x3dcedb){const _0x4ee7d7=(_0x1e91ff=_0x303599[constants_1[_0xa0e160(0x149)]+_0xa0e160(0x140)])===null||_0x1e91ff===void 0x0?void 0x0:_0x1e91ff[_0xa0e160(0x144)];_0x4ee7d7&&_0x4ee7d7[_0xa0e160(0x10e)]&&_0x66d6c[_0xa0e160(0x11f)](_0x4ee7d7[0x0]['Id']);}return _0x66d6c;}async['getAllRepositoryNames'](_0x3197cf){const _0x32a4c2=a254_0x495e0d,_0x1773a1=await this[_0x32a4c2(0x126)][_0x32a4c2(0x143)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x32a4c2(0x13f)](/\%connection_id\%/g,_0x3197cf));return _0x1773a1[_0x32a4c2(0x112)](_0x49707c=>{const _0x428626=_0x32a4c2;return _0x49707c[constants_1[_0x428626(0x133)]+'Repository__r']?_0x49707c[constants_1[_0x428626(0x133)]+_0x428626(0x114)][_0x428626(0x13b)]:_0x49707c['Name'];});}async[a254_0x495e0d(0x15b)](_0x5183f7){const _0x43fe04=a254_0x495e0d,_0x5abcfd=await this['salesforceQuery'][_0x43fe04(0x143)](queries_1[_0x43fe04(0x102)]['replace'](/\%connection_id\%/g,_0x5183f7));return _0x5abcfd[_0x43fe04(0x112)](_0x8e8966=>flosum_repository_sync_dto_1[_0x43fe04(0x121)][_0x43fe04(0x150)](_0x8e8966));}async[a254_0x495e0d(0x12c)](_0x1ae9e0){const _0x113f72=a254_0x495e0d,_0x3de978=await this[_0x113f72(0x126)][_0x113f72(0x143)](queries_1['GET_WAITING_BRANCHES_QUERY']['replace'](/%repositories_ids\%/g,_0x1ae9e0));return _0x3de978[_0x113f72(0x112)](_0x2a39f4=>flosum_repository_sync_dto_1[_0x113f72(0x121)][_0x113f72(0x103)](_0x2a39f4));}async['getRepositoryRecord'](_0x855a45){const _0x5badad=a254_0x495e0d,_0x29e44d=await this[_0x5badad(0x126)][_0x5badad(0x143)](queries_1[_0x5badad(0x152)][_0x5badad(0x13f)](_0x5badad(0x117),_0x855a45));if(_0x29e44d['length']===0x0)throw new not_found_error_1[(_0x5badad(0x113))](_0x5badad(0x15c)+_0x855a45+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x5badad(0x121)]['fromRepositoryRecord'](_0x29e44d[0x0]);}async[a254_0x495e0d(0x161)](_0x54e9f0){const _0x5e0eb4=a254_0x495e0d,_0x2763a9=await this[_0x5e0eb4(0x126)][_0x5e0eb4(0x143)](queries_1[_0x5e0eb4(0x162)][_0x5e0eb4(0x13f)](_0x5e0eb4(0x117),_0x54e9f0));if(_0x2763a9[_0x5e0eb4(0x10e)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x5e0eb4(0x14c)+_0x54e9f0+_0x5e0eb4(0x106));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x5e0eb4(0x103)](_0x2763a9[0x0]);}async[a254_0x495e0d(0x10a)](_0x26fa4c){const _0x58a416=a254_0x495e0d,_0x2d755b=await this[_0x58a416(0x126)][_0x58a416(0x143)](queries_1[_0x58a416(0x14e)]['replace']('%name%',_0x26fa4c));if(_0x2d755b[_0x58a416(0x10e)]===0x0)throw new not_found_error_1[(_0x58a416(0x113))](_0x58a416(0x122)+_0x26fa4c+_0x58a416(0x106));const _0x54ad22=_0x2d755b[_0x58a416(0x146)](_0x11dfa6=>_0x11dfa6[constants_1[_0x58a416(0x149)]+_0x58a416(0x159)]===_0x26fa4c);if(!_0x54ad22)throw new not_found_error_1[(_0x58a416(0x113))](_0x58a416(0x122)+_0x26fa4c+_0x58a416(0x106));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x58a416(0x103)](_0x54ad22);}async[a254_0x495e0d(0x13c)](_0x37ad6a){const _0x29f78c=a254_0x495e0d,_0x26ae67=await this[_0x29f78c(0x126)][_0x29f78c(0x143)](queries_1[_0x29f78c(0x15f)][_0x29f78c(0x13f)](_0x29f78c(0x132),_0x37ad6a));if(_0x26ae67[_0x29f78c(0x10e)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x29f78c(0x12a)+_0x37ad6a+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x29f78c(0x150)](_0x26ae67[0x0]);}async[a254_0x495e0d(0x155)](_0x2bf214){const _0xd1b332=a254_0x495e0d,_0x2e9aa0=_0xd1b332(0x127)+queries_1[_0xd1b332(0x135)]+_0xd1b332(0x13e)+_0x2bf214+'\x27';return this['getComponents'](_0x2e9aa0);}async[a254_0x495e0d(0x154)](_0x41cf60){const _0x266234=a254_0x495e0d,_0x2bb7c0=_0x266234(0x131)+queries_1[_0x266234(0x135)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x41cf60+'\x27';return this['getComponents'](_0x2bb7c0);}async[a254_0x495e0d(0x137)](_0x59e809){const _0x14467d=a254_0x495e0d;var _0x4c9a87;const _0x5f2734=queries_1[_0x14467d(0x148)]['replace'](_0x14467d(0x153),_0x59e809[_0x14467d(0x12b)])[_0x14467d(0x13f)](_0x14467d(0x132),_0x59e809[_0x14467d(0x136)]?constants_1[_0x14467d(0x141)]:constants_1[_0x14467d(0x156)]),_0x4588b7=await this[_0x14467d(0x126)][_0x14467d(0x143)](_0x5f2734),_0x1b2d86=(_0x4c9a87=_0x4588b7[0x0])===null||_0x4c9a87===void 0x0?void 0x0:_0x4c9a87['Id'];if(!_0x1b2d86)throw new Error(errors_1[_0x14467d(0x11c)]);return _0x1b2d86;}async[a254_0x495e0d(0x14d)](_0x4ed0b9){const _0x1b87c7=a254_0x495e0d;let _0x318689=await this['getAttachmentId'](_0x4ed0b9)['catch'](()=>null);return!_0x318689&&(_0x318689=await this['salesforceService'][_0x1b87c7(0x105)]('Attachment',{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x4ed0b9['objectId'],'ContentType':_0x1b87c7(0x110),'Name':_0x4ed0b9[_0x1b87c7(0x136)]?constants_1[_0x1b87c7(0x141)]:constants_1[_0x1b87c7(0x156)]})),_0x318689;}async[a254_0x495e0d(0x118)](_0xa2b875,_0x39cdac){const _0x1d4e61=a254_0x495e0d,_0x443fa3=await this[_0x1d4e61(0x14d)](_0xa2b875);await this['salesforceService'][_0x1d4e61(0x157)](_0x1d4e61(0x13a),_0x443fa3,{'Body':(0x0,utils_1[_0x1d4e61(0x119)])(JSON[_0x1d4e61(0x160)](_0x39cdac))});}async[a254_0x495e0d(0x15d)](_0x3c6277,_0x562597){const _0xa82cf5=a254_0x495e0d;await this[_0xa82cf5(0x125)][_0xa82cf5(0x157)](_0x3c6277[_0xa82cf5(0x139)],_0x3c6277[_0xa82cf5(0x12b)],{[constants_1[_0xa82cf5(0x133)]+_0xa82cf5(0x128)]:_0x562597});}async[a254_0x495e0d(0x107)](_0x184c47){const _0x3c88cc=a254_0x495e0d;await this['salesforceService'][_0x3c88cc(0x157)](constants_1[_0x3c88cc(0x133)]+_0x3c88cc(0x129),_0x184c47,{[constants_1[_0x3c88cc(0x133)]+_0x3c88cc(0x14f)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a254_0x495e0d(0x14a),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a254_0x495e0d(0x145)]])],SalesforceSyncService),exports[a254_0x495e0d(0x130)]=SalesforceSyncService;