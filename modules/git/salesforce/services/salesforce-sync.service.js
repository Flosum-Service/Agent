function a238_0x284d(_0x28a65e,_0x2be98c){const _0x4c74f0=a238_0x1cd4();return a238_0x284d=function(_0x136ae3,_0x1ef91b){_0x136ae3=_0x136ae3-0x1e1;let _0x1cd4a1=_0x4c74f0[_0x136ae3];return _0x1cd4a1;},a238_0x284d(_0x28a65e,_0x2be98c);}const a238_0x3c2f95=a238_0x284d;(function(_0x2c2c5c,_0x1e166b){const _0x450a31=a238_0x284d,_0x5c2aaa=_0x2c2c5c();while(!![]){try{const _0x30ca7c=parseInt(_0x450a31(0x219))/0x1*(-parseInt(_0x450a31(0x1eb))/0x2)+-parseInt(_0x450a31(0x200))/0x3+parseInt(_0x450a31(0x21c))/0x4*(-parseInt(_0x450a31(0x227))/0x5)+parseInt(_0x450a31(0x1e2))/0x6*(-parseInt(_0x450a31(0x1ed))/0x7)+parseInt(_0x450a31(0x1e1))/0x8*(-parseInt(_0x450a31(0x1f6))/0x9)+parseInt(_0x450a31(0x239))/0xa+parseInt(_0x450a31(0x1fb))/0xb;if(_0x30ca7c===_0x1e166b)break;else _0x5c2aaa['push'](_0x5c2aaa['shift']());}catch(_0x333980){_0x5c2aaa['push'](_0x5c2aaa['shift']());}}}(a238_0x1cd4,0x493a4));const a238_0x1ef91b=(function(){let _0x2fb14a=!![];return function(_0xa2eede,_0x202923){const _0x219bd8=_0x2fb14a?function(){const _0x464c7d=a238_0x284d;if(_0x202923){const _0x18f324=_0x202923[_0x464c7d(0x1fc)](_0xa2eede,arguments);return _0x202923=null,_0x18f324;}}:function(){};return _0x2fb14a=![],_0x219bd8;};}()),a238_0x136ae3=a238_0x1ef91b(this,function(){const _0xfcb244=a238_0x284d;return a238_0x136ae3[_0xfcb244(0x20a)]()[_0xfcb244(0x1e9)](_0xfcb244(0x217))[_0xfcb244(0x20a)]()['constructor'](a238_0x136ae3)['search'](_0xfcb244(0x217));});a238_0x136ae3();'use strict';var __decorate=this&&this[a238_0x3c2f95(0x22c)]||function(_0x376d47,_0x26eac7,_0x4a48ae,_0x3a8ed1){const _0x40586d=a238_0x3c2f95;var _0xe458a2=arguments['length'],_0x335f7c=_0xe458a2<0x3?_0x26eac7:_0x3a8ed1===null?_0x3a8ed1=Object['getOwnPropertyDescriptor'](_0x26eac7,_0x4a48ae):_0x3a8ed1,_0x3bab51;if(typeof Reflect==='object'&&typeof Reflect[_0x40586d(0x20d)]===_0x40586d(0x1e3))_0x335f7c=Reflect[_0x40586d(0x20d)](_0x376d47,_0x26eac7,_0x4a48ae,_0x3a8ed1);else{for(var _0x2b6149=_0x376d47[_0x40586d(0x1ec)]-0x1;_0x2b6149>=0x0;_0x2b6149--)if(_0x3bab51=_0x376d47[_0x2b6149])_0x335f7c=(_0xe458a2<0x3?_0x3bab51(_0x335f7c):_0xe458a2>0x3?_0x3bab51(_0x26eac7,_0x4a48ae,_0x335f7c):_0x3bab51(_0x26eac7,_0x4a48ae))||_0x335f7c;}return _0xe458a2>0x3&&_0x335f7c&&Object[_0x40586d(0x1fd)](_0x26eac7,_0x4a48ae,_0x335f7c),_0x335f7c;},__metadata=this&&this['__metadata']||function(_0x525f0c,_0x8e2e5a){const _0x5840eb=a238_0x3c2f95;if(typeof Reflect===_0x5840eb(0x1ef)&&typeof Reflect[_0x5840eb(0x230)]==='function')return Reflect[_0x5840eb(0x230)](_0x525f0c,_0x8e2e5a);};Object[a238_0x3c2f95(0x1fd)](exports,a238_0x3c2f95(0x236),{'value':!![]}),exports[a238_0x3c2f95(0x211)]=void 0x0;const typedi_1=require(a238_0x3c2f95(0x21f)),constants_1=require('../../../../constants'),errors_1=require('../../../../constants/errors'),utils_1=require(a238_0x3c2f95(0x1e7)),flosum_repository_sync_dto_1=require(a238_0x3c2f95(0x205)),not_found_error_1=require(a238_0x3c2f95(0x22a)),queries_1=require(a238_0x3c2f95(0x215)),salesforce_query_service_1=require(a238_0x3c2f95(0x216)),salesforce_service_1=require('./salesforce.service');function a238_0x1cd4(){const _0x393413=['24Clodhd','function','salesforceService','Repository__r','%name%','../../../shared/utils','Repository\x20with\x20Id\x20','search','map','614278ByEGeD','length','944202FpcJsW','GET_COMPONENTS_QUERY','object','ERR_INVALID_ATTACHMENT_ID','Branch\x20','getBranchComponents','\x20not\x20found\x20on\x20salesforce','FLOSUM_GIT_NAMESPACE','records','90TBIIGQ','replace','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','GET_REPOSITORY_BY_NAME_QUERY','Connection__c','12555576SagTON','apply','defineProperty','getBranchRecord','FLOSUM_NAMESPACE','593769KqzbBO','Branch\x20with\x20Id\x20','getRepositoryRecordByName','query','getComponentsFromRepository','../dto/flosum-repository-sync.dto','GET_WAITING_REPOSITORIES_QUERY','catch','getComponents','fromRepositoryRecord','toString','SYNC_ATTACHMENT_FOR_BRANCH_NAME','text/plain','decorate','Synchronization_Status__c','Components__r','GET_REPOSITORY_QUERY','SalesforceSyncService','repositoryId','Sync_In_Progress__c','push','../queries','./salesforce-query.service','(((.+)+)+)+$','Attachment','1ovUgNI','salesforceQuery','patchObject','4oWkZLo','fromBranchRecord','GET_REPOSITORIES_NAMES_QUERY','typedi','Service','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','updateRemoteState','GET_WAITING_BRANCHES_QUERY','disableSync','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','design:paramtypes','610495dMLQqj','objectType','objectId','../errors/not-found.error','GET_BRANCH_BY_NAME_QUERY','__decorate','Name','getAttachmentId','%id%','metadata','GET_BRANCH_QUERY','SalesforceService','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','FlosumRepositorySyncDto','createObject','__esModule','stringify','getBranchRecordByName','3718890EpIgUB','Repository\x20','%parentId%','Branch_Name__c','encodeBase64','SalesforceNotFoundError','\x0a\x20\x20\x20\x20\x20\x20','37328bsBUal'];a238_0x1cd4=function(){return _0x393413;};return a238_0x1cd4();}let SalesforceSyncService=class SalesforceSyncService{constructor(_0x552c82,_0x503d20){const _0x55973e=a238_0x3c2f95;this[_0x55973e(0x21a)]=_0x552c82,this[_0x55973e(0x1e4)]=_0x503d20;}async[a238_0x3c2f95(0x208)](_0x278e1d){const _0x3e1bb8=a238_0x3c2f95;var _0x38f945;const _0x52d34d=await this[_0x3e1bb8(0x21a)][_0x3e1bb8(0x203)](_0x278e1d),_0x269d18=[];for(const _0x47086d of _0x52d34d){const _0x138446=(_0x38f945=_0x47086d[constants_1['FLOSUM_NAMESPACE']+_0x3e1bb8(0x20f)])===null||_0x38f945===void 0x0?void 0x0:_0x38f945[_0x3e1bb8(0x1f5)];_0x138446&&_0x138446[_0x3e1bb8(0x1ec)]&&_0x269d18[_0x3e1bb8(0x214)](_0x138446[0x0]['Id']);}return _0x269d18;}async['getAllRepositoryNames'](_0x30477d){const _0x4ed21c=a238_0x3c2f95,_0x12b5c0=await this[_0x4ed21c(0x21a)]['query'](queries_1[_0x4ed21c(0x21e)][_0x4ed21c(0x1f7)](/\%connection_id\%/g,_0x30477d));return _0x12b5c0[_0x4ed21c(0x1ea)](_0x312200=>{const _0x31b897=_0x4ed21c;return _0x312200[constants_1[_0x31b897(0x1f4)]+_0x31b897(0x1e5)]?_0x312200[constants_1[_0x31b897(0x1f4)]+_0x31b897(0x1e5)][_0x31b897(0x22d)]:_0x312200[_0x31b897(0x22d)];});}async['getRepositoryRecords'](_0x11e609){const _0x6c8055=a238_0x3c2f95,_0x32af31=await this[_0x6c8055(0x21a)][_0x6c8055(0x203)](queries_1[_0x6c8055(0x206)]['replace'](/\%connection_id\%/g,_0x11e609));return _0x32af31[_0x6c8055(0x1ea)](_0x49efab=>flosum_repository_sync_dto_1[_0x6c8055(0x234)][_0x6c8055(0x209)](_0x49efab));}async['getBranchRecords'](_0x532b92){const _0x2b5700=a238_0x3c2f95,_0x765e6f=await this[_0x2b5700(0x21a)]['query'](queries_1[_0x2b5700(0x223)][_0x2b5700(0x1f7)](/%repositories_ids\%/g,_0x532b92));return _0x765e6f['map'](_0x2af413=>flosum_repository_sync_dto_1[_0x2b5700(0x234)]['fromBranchRecord'](_0x2af413));}async['getRepositoryRecord'](_0x5874eb){const _0x460c41=a238_0x3c2f95,_0x1349a7=await this[_0x460c41(0x21a)][_0x460c41(0x203)](queries_1[_0x460c41(0x210)][_0x460c41(0x1f7)](_0x460c41(0x22f),_0x5874eb));if(_0x1349a7[_0x460c41(0x1ec)]===0x0)throw new not_found_error_1[(_0x460c41(0x23e))](_0x460c41(0x1e8)+_0x5874eb+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x460c41(0x234)][_0x460c41(0x209)](_0x1349a7[0x0]);}async[a238_0x3c2f95(0x1fe)](_0xb48dd9){const _0x10a180=a238_0x3c2f95,_0x402aa3=await this[_0x10a180(0x21a)][_0x10a180(0x203)](queries_1[_0x10a180(0x231)][_0x10a180(0x1f7)](_0x10a180(0x22f),_0xb48dd9));if(_0x402aa3[_0x10a180(0x1ec)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x10a180(0x201)+_0xb48dd9+_0x10a180(0x1f3));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x10a180(0x21d)](_0x402aa3[0x0]);}async[a238_0x3c2f95(0x238)](_0x2a45c1){const _0x1b1547=a238_0x3c2f95,_0xa0fc5a=await this['salesforceQuery']['query'](queries_1[_0x1b1547(0x22b)][_0x1b1547(0x1f7)]('%name%',_0x2a45c1));if(_0xa0fc5a[_0x1b1547(0x1ec)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x1b1547(0x1f1)+_0x2a45c1+_0x1b1547(0x1f3));const _0x35c124=_0xa0fc5a['find'](_0x19a66b=>_0x19a66b[constants_1[_0x1b1547(0x1ff)]+_0x1b1547(0x23c)]===_0x2a45c1);if(!_0x35c124)throw new not_found_error_1[(_0x1b1547(0x23e))](_0x1b1547(0x1f1)+_0x2a45c1+_0x1b1547(0x1f3));return flosum_repository_sync_dto_1[_0x1b1547(0x234)][_0x1b1547(0x21d)](_0x35c124);}async[a238_0x3c2f95(0x202)](_0x526397){const _0x426d68=a238_0x3c2f95,_0x205a52=await this[_0x426d68(0x21a)][_0x426d68(0x203)](queries_1[_0x426d68(0x1f9)][_0x426d68(0x1f7)](_0x426d68(0x1e6),_0x526397));if(_0x205a52[_0x426d68(0x1ec)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x426d68(0x23a)+_0x526397+_0x426d68(0x1f3));return flosum_repository_sync_dto_1[_0x426d68(0x234)][_0x426d68(0x209)](_0x205a52[0x0]);}async[a238_0x3c2f95(0x204)](_0x43de95){const _0x50c478=a238_0x3c2f95,_0x17cf35=_0x50c478(0x23f)+queries_1[_0x50c478(0x1ee)]+_0x50c478(0x225)+_0x43de95+'\x27';return this[_0x50c478(0x208)](_0x17cf35);}async[a238_0x3c2f95(0x1f2)](_0x4a5051){const _0x1418bd=a238_0x3c2f95,_0x3490f3=_0x1418bd(0x233)+queries_1[_0x1418bd(0x1ee)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x4a5051+'\x27';return this[_0x1418bd(0x208)](_0x3490f3);}async[a238_0x3c2f95(0x22e)](_0x18a1fd){const _0x4d22b5=a238_0x3c2f95;var _0x337b7a;const _0x58c078=queries_1[_0x4d22b5(0x1f8)][_0x4d22b5(0x1f7)](_0x4d22b5(0x23b),_0x18a1fd[_0x4d22b5(0x229)])[_0x4d22b5(0x1f7)](_0x4d22b5(0x1e6),_0x18a1fd[_0x4d22b5(0x212)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x4d22b5(0x20b)]),_0x5a4f82=await this[_0x4d22b5(0x21a)][_0x4d22b5(0x203)](_0x58c078),_0x46a220=(_0x337b7a=_0x5a4f82[0x0])===null||_0x337b7a===void 0x0?void 0x0:_0x337b7a['Id'];if(!_0x46a220)throw new Error(errors_1[_0x4d22b5(0x1f0)]);return _0x46a220;}async['getRemoteStateAttachmentId'](_0x2ae5bd){const _0x3a086f=a238_0x3c2f95;let _0x2aff8=await this['getAttachmentId'](_0x2ae5bd)[_0x3a086f(0x207)](()=>null);return!_0x2aff8&&(_0x2aff8=await this[_0x3a086f(0x1e4)][_0x3a086f(0x235)](_0x3a086f(0x218),{'Body':(0x0,utils_1[_0x3a086f(0x23d)])('{}'),'ParentId':_0x2ae5bd[_0x3a086f(0x229)],'ContentType':_0x3a086f(0x20c),'Name':_0x2ae5bd['repositoryId']?constants_1[_0x3a086f(0x221)]:constants_1[_0x3a086f(0x20b)]})),_0x2aff8;}async[a238_0x3c2f95(0x222)](_0x5a7182,_0x1d9bef){const _0x419611=a238_0x3c2f95,_0x336699=await this['getRemoteStateAttachmentId'](_0x5a7182);await this[_0x419611(0x1e4)][_0x419611(0x21b)](_0x419611(0x218),_0x336699,{'Body':(0x0,utils_1[_0x419611(0x23d)])(JSON[_0x419611(0x237)](_0x1d9bef))});}async['setStatus'](_0x342cca,_0xb9eec8){const _0x3a5e37=a238_0x3c2f95;await this[_0x3a5e37(0x1e4)]['patchObject'](_0x342cca[_0x3a5e37(0x228)],_0x342cca[_0x3a5e37(0x229)],{[constants_1[_0x3a5e37(0x1f4)]+_0x3a5e37(0x20e)]:_0xb9eec8});}async[a238_0x3c2f95(0x224)](_0x335f8e){const _0x3ef6b8=a238_0x3c2f95;await this[_0x3ef6b8(0x1e4)]['patchObject'](constants_1[_0x3ef6b8(0x1f4)]+_0x3ef6b8(0x1fa),_0x335f8e,{[constants_1[_0x3ef6b8(0x1f4)]+_0x3ef6b8(0x213)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a238_0x3c2f95(0x220)])(),__metadata(a238_0x3c2f95(0x226),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a238_0x3c2f95(0x232)]])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;