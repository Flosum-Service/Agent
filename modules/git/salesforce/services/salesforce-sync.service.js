const a204_0x10a5b3=a204_0x583b;(function(_0x4fac8a,_0x4afa84){const _0x2e7745=a204_0x583b,_0x30ee74=_0x4fac8a();while(!![]){try{const _0x4dd099=parseInt(_0x2e7745(0x1a9))/0x1+parseInt(_0x2e7745(0x198))/0x2*(parseInt(_0x2e7745(0x179))/0x3)+parseInt(_0x2e7745(0x187))/0x4+parseInt(_0x2e7745(0x1ca))/0x5*(-parseInt(_0x2e7745(0x17b))/0x6)+parseInt(_0x2e7745(0x18c))/0x7*(-parseInt(_0x2e7745(0x173))/0x8)+parseInt(_0x2e7745(0x1ac))/0x9+-parseInt(_0x2e7745(0x19a))/0xa*(parseInt(_0x2e7745(0x1bc))/0xb);if(_0x4dd099===_0x4afa84)break;else _0x30ee74['push'](_0x30ee74['shift']());}catch(_0x7691bb){_0x30ee74['push'](_0x30ee74['shift']());}}}(a204_0x2803,0xdbc6d));const a204_0x24edd2=(function(){let _0x2bd454=!![];return function(_0x2c0eb8,_0x4e092a){const _0x32e681=_0x2bd454?function(){const _0x373137=a204_0x583b;if(_0x4e092a){const _0x4fe825=_0x4e092a[_0x373137(0x18d)](_0x2c0eb8,arguments);return _0x4e092a=null,_0x4fe825;}}:function(){};return _0x2bd454=![],_0x32e681;};}()),a204_0x4881c8=a204_0x24edd2(this,function(){const _0x35b210=a204_0x583b;return a204_0x4881c8['toString']()[_0x35b210(0x1a5)](_0x35b210(0x18b))[_0x35b210(0x171)]()[_0x35b210(0x16e)](a204_0x4881c8)['search'](_0x35b210(0x18b));});a204_0x4881c8();'use strict';var __decorate=this&&this[a204_0x10a5b3(0x1b7)]||function(_0x58dabe,_0x2306c0,_0x5909d6,_0x423177){const _0x3c53d5=a204_0x10a5b3;var _0x3081ec=arguments[_0x3c53d5(0x1a0)],_0x4ab121=_0x3081ec<0x3?_0x2306c0:_0x423177===null?_0x423177=Object[_0x3c53d5(0x1b4)](_0x2306c0,_0x5909d6):_0x423177,_0x201b5a;if(typeof Reflect===_0x3c53d5(0x1b2)&&typeof Reflect['decorate']===_0x3c53d5(0x17a))_0x4ab121=Reflect[_0x3c53d5(0x18e)](_0x58dabe,_0x2306c0,_0x5909d6,_0x423177);else{for(var _0x181126=_0x58dabe[_0x3c53d5(0x1a0)]-0x1;_0x181126>=0x0;_0x181126--)if(_0x201b5a=_0x58dabe[_0x181126])_0x4ab121=(_0x3081ec<0x3?_0x201b5a(_0x4ab121):_0x3081ec>0x3?_0x201b5a(_0x2306c0,_0x5909d6,_0x4ab121):_0x201b5a(_0x2306c0,_0x5909d6))||_0x4ab121;}return _0x3081ec>0x3&&_0x4ab121&&Object[_0x3c53d5(0x191)](_0x2306c0,_0x5909d6,_0x4ab121),_0x4ab121;},__metadata=this&&this[a204_0x10a5b3(0x1bb)]||function(_0x189ab9,_0x5cc612){const _0x2a35d8=a204_0x10a5b3;if(typeof Reflect===_0x2a35d8(0x1b2)&&typeof Reflect['metadata']===_0x2a35d8(0x17a))return Reflect['metadata'](_0x189ab9,_0x5cc612);};Object[a204_0x10a5b3(0x191)](exports,a204_0x10a5b3(0x199),{'value':!![]}),exports[a204_0x10a5b3(0x1b3)]=void 0x0;const typedi_1=require(a204_0x10a5b3(0x192)),constants_1=require(a204_0x10a5b3(0x182)),errors_1=require('../../../../constants/errors'),utils_1=require('../../../shared/utils'),flosum_repository_sync_dto_1=require(a204_0x10a5b3(0x176)),not_found_error_1=require('../errors/not-found.error'),queries_1=require(a204_0x10a5b3(0x172)),salesforce_query_service_1=require(a204_0x10a5b3(0x189)),salesforce_service_1=require(a204_0x10a5b3(0x1c9));function a204_0x583b(_0x3b87a0,_0x56f79d){const _0x2ca8a8=a204_0x2803();return a204_0x583b=function(_0x4881c8,_0x24edd2){_0x4881c8=_0x4881c8-0x16c;let _0x280320=_0x2ca8a8[_0x4881c8];return _0x280320;},a204_0x583b(_0x3b87a0,_0x56f79d);}let SalesforceSyncService=class SalesforceSyncService{constructor(_0x29828f,_0x531bda){const _0x5deb1d=a204_0x10a5b3;this['salesforceQuery']=_0x29828f,this[_0x5deb1d(0x184)]=_0x531bda;}async[a204_0x10a5b3(0x19d)](_0x1c616c){const _0x1b72e2=a204_0x10a5b3;var _0x2c9005;const _0x165423=await this[_0x1b72e2(0x183)][_0x1b72e2(0x193)](_0x1c616c),_0x2c9e14=[];for(const _0x50bec9 of _0x165423){const _0x7da928=(_0x2c9005=_0x50bec9[constants_1[_0x1b72e2(0x178)]+_0x1b72e2(0x1af)])===null||_0x2c9005===void 0x0?void 0x0:_0x2c9005['records'];_0x7da928&&_0x7da928[_0x1b72e2(0x1a0)]&&_0x2c9e14[_0x1b72e2(0x197)](_0x7da928[0x0]['Id']);}return _0x2c9e14;}async[a204_0x10a5b3(0x16c)](_0x51cd71){const _0x4c160b=a204_0x10a5b3,_0x58b97c=await this[_0x4c160b(0x183)][_0x4c160b(0x193)](queries_1[_0x4c160b(0x1a3)][_0x4c160b(0x17d)](/\%connection_id\%/g,_0x51cd71));return _0x58b97c[_0x4c160b(0x1c1)](_0x101a97=>{const _0x104b06=_0x4c160b;return _0x101a97[constants_1[_0x104b06(0x1a4)]+_0x104b06(0x19b)]?_0x101a97[constants_1[_0x104b06(0x1a4)]+_0x104b06(0x19b)][_0x104b06(0x188)]:_0x101a97['Name'];});}async[a204_0x10a5b3(0x17f)](_0x3e6abf){const _0x56ccb6=a204_0x10a5b3,_0x481bd4=await this[_0x56ccb6(0x183)][_0x56ccb6(0x193)](queries_1[_0x56ccb6(0x19e)]['replace'](/\%connection_id\%/g,_0x3e6abf));return _0x481bd4[_0x56ccb6(0x1c1)](_0x4e9470=>flosum_repository_sync_dto_1[_0x56ccb6(0x17c)][_0x56ccb6(0x16d)](_0x4e9470));}async[a204_0x10a5b3(0x1ad)](_0x370f5c){const _0x35f55f=a204_0x10a5b3,_0x45e42d=await this[_0x35f55f(0x183)]['query'](queries_1[_0x35f55f(0x1c0)][_0x35f55f(0x17d)](/%repositories_ids\%/g,_0x370f5c));return _0x45e42d['map'](_0xf3fbda=>flosum_repository_sync_dto_1[_0x35f55f(0x17c)]['fromBranchRecord'](_0xf3fbda));}async[a204_0x10a5b3(0x1a6)](_0x17167c){const _0x10e3c7=a204_0x10a5b3,_0x2d7a41=await this[_0x10e3c7(0x183)][_0x10e3c7(0x193)](queries_1['GET_REPOSITORY_QUERY']['replace'](_0x10e3c7(0x18f),_0x17167c));if(_0x2d7a41[_0x10e3c7(0x1a0)]===0x0)throw new not_found_error_1['SalesforceNotFoundError']('Repository\x20with\x20Id\x20'+_0x17167c+_0x10e3c7(0x17e));return flosum_repository_sync_dto_1[_0x10e3c7(0x17c)][_0x10e3c7(0x16d)](_0x2d7a41[0x0]);}async[a204_0x10a5b3(0x175)](_0x1870b5){const _0x33db97=a204_0x10a5b3,_0x5f3ce2=await this[_0x33db97(0x183)][_0x33db97(0x193)](queries_1[_0x33db97(0x19f)][_0x33db97(0x17d)](_0x33db97(0x18f),_0x1870b5));if(_0x5f3ce2['length']===0x0)throw new not_found_error_1[(_0x33db97(0x1ae))](_0x33db97(0x18a)+_0x1870b5+_0x33db97(0x17e));return flosum_repository_sync_dto_1[_0x33db97(0x17c)][_0x33db97(0x1bf)](_0x5f3ce2[0x0]);}async[a204_0x10a5b3(0x1c4)](_0x4687c4){const _0x33199c=a204_0x10a5b3,_0x13e85a=await this[_0x33199c(0x183)][_0x33199c(0x193)](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x33199c(0x17d)]('%name%',_0x4687c4));if(_0x13e85a[_0x33199c(0x1a0)]===0x0)throw new not_found_error_1[(_0x33199c(0x1ae))](_0x33199c(0x1c5)+_0x4687c4+_0x33199c(0x17e));const _0x36945b=_0x13e85a[_0x33199c(0x190)](_0x2e548f=>_0x2e548f[constants_1['FLOSUM_NAMESPACE']+_0x33199c(0x1bd)]===_0x4687c4);if(!_0x36945b)throw new not_found_error_1[(_0x33199c(0x1ae))]('Branch\x20'+_0x4687c4+_0x33199c(0x17e));return flosum_repository_sync_dto_1[_0x33199c(0x17c)][_0x33199c(0x1bf)](_0x36945b);}async[a204_0x10a5b3(0x1b9)](_0x1922c3){const _0x4adcf3=a204_0x10a5b3,_0x38e5a0=await this[_0x4adcf3(0x183)][_0x4adcf3(0x193)](queries_1[_0x4adcf3(0x1aa)][_0x4adcf3(0x17d)](_0x4adcf3(0x1a7),_0x1922c3));if(_0x38e5a0[_0x4adcf3(0x1a0)]===0x0)throw new not_found_error_1[(_0x4adcf3(0x1ae))]('Repository\x20'+_0x1922c3+_0x4adcf3(0x17e));return flosum_repository_sync_dto_1[_0x4adcf3(0x17c)]['fromRepositoryRecord'](_0x38e5a0[0x0]);}async[a204_0x10a5b3(0x1b8)](_0x35efad){const _0x2b9978=a204_0x10a5b3,_0x1db7bf='\x0a\x20\x20\x20\x20\x20\x20'+queries_1['GET_COMPONENTS_QUERY']+_0x2b9978(0x1b1)+_0x35efad+'\x27';return this[_0x2b9978(0x19d)](_0x1db7bf);}async[a204_0x10a5b3(0x16f)](_0x2cf5e1){const _0x53d0f9=a204_0x10a5b3,_0x251f09=_0x53d0f9(0x1c3)+queries_1[_0x53d0f9(0x1b6)]+_0x53d0f9(0x185)+_0x2cf5e1+'\x27';return this[_0x53d0f9(0x19d)](_0x251f09);}async['getAttachmentId'](_0x328e20){const _0x25752a=a204_0x10a5b3;var _0x19a16e;const _0x415294=queries_1[_0x25752a(0x177)][_0x25752a(0x17d)](_0x25752a(0x194),_0x328e20[_0x25752a(0x196)])[_0x25752a(0x17d)](_0x25752a(0x1a7),_0x328e20[_0x25752a(0x174)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x25752a(0x1ba)]),_0x28e429=await this['salesforceQuery'][_0x25752a(0x193)](_0x415294),_0x5035be=(_0x19a16e=_0x28e429[0x0])===null||_0x19a16e===void 0x0?void 0x0:_0x19a16e['Id'];if(!_0x5035be)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x5035be;}async[a204_0x10a5b3(0x195)](_0x3bb522){const _0x464eb1=a204_0x10a5b3;let _0x7d5e90=await this[_0x464eb1(0x1cb)](_0x3bb522)[_0x464eb1(0x1c6)](()=>null);return!_0x7d5e90&&(_0x7d5e90=await this['salesforceService'][_0x464eb1(0x1b5)]('Attachment',{'Body':(0x0,utils_1[_0x464eb1(0x1a2)])('{}'),'ParentId':_0x3bb522[_0x464eb1(0x196)],'ContentType':_0x464eb1(0x1b0),'Name':_0x3bb522[_0x464eb1(0x174)]?constants_1[_0x464eb1(0x1ab)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x7d5e90;}async[a204_0x10a5b3(0x181)](_0x13e174,_0x309ed9){const _0x4c4714=a204_0x10a5b3,_0x2e0e3d=await this[_0x4c4714(0x195)](_0x13e174);await this[_0x4c4714(0x184)][_0x4c4714(0x19c)](_0x4c4714(0x1c8),_0x2e0e3d,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x4c4714(0x180)](_0x309ed9))});}async[a204_0x10a5b3(0x1be)](_0x2ba695,_0x5916bb){const _0x18004a=a204_0x10a5b3;await this[_0x18004a(0x184)][_0x18004a(0x19c)](_0x2ba695[_0x18004a(0x1c2)],_0x2ba695[_0x18004a(0x196)],{[constants_1[_0x18004a(0x1a4)]+_0x18004a(0x170)]:_0x5916bb});}async[a204_0x10a5b3(0x1a8)](_0x111c0a){const _0x223375=a204_0x10a5b3;await this[_0x223375(0x184)]['patchObject'](constants_1['FLOSUM_GIT_NAMESPACE']+_0x223375(0x1a1),_0x111c0a,{[constants_1[_0x223375(0x1a4)]+_0x223375(0x186)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a204_0x10a5b3(0x1cc),[salesforce_query_service_1[a204_0x10a5b3(0x1c7)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports[a204_0x10a5b3(0x1b3)]=SalesforceSyncService;function a204_0x2803(){const _0x526429=['repositoryId','getBranchRecord','../dto/flosum-repository-sync.dto','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','FLOSUM_NAMESPACE','947073wZcPpb','function','221160Cumsrq','FlosumRepositorySyncDto','replace','\x20not\x20found\x20on\x20salesforce','getRepositoryRecords','stringify','updateRemoteState','../../../../constants','salesforceQuery','salesforceService','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','Sync_In_Progress__c','5837664aIcjaH','Name','./salesforce-query.service','Branch\x20with\x20Id\x20','(((.+)+)+)+$','2513TvORam','apply','decorate','%id%','find','defineProperty','typedi','query','%parentId%','getRemoteStateAttachmentId','objectId','push','10lNYlwz','__esModule','10RjLcFj','Repository__r','patchObject','getComponents','GET_WAITING_REPOSITORIES_QUERY','GET_BRANCH_QUERY','length','Connection__c','encodeBase64','GET_REPOSITORIES_NAMES_QUERY','FLOSUM_GIT_NAMESPACE','search','getRepositoryRecord','%name%','disableSync','1697042XhcGmy','GET_REPOSITORY_BY_NAME_QUERY','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','6802992JxINqS','getBranchRecords','SalesforceNotFoundError','Components__r','text/plain','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','object','SalesforceSyncService','getOwnPropertyDescriptor','createObject','GET_COMPONENTS_QUERY','__decorate','getComponentsFromRepository','getRepositoryRecordByName','SYNC_ATTACHMENT_FOR_BRANCH_NAME','__metadata','37304641UwhEeY','Branch_Name__c','setStatus','fromBranchRecord','GET_WAITING_BRANCHES_QUERY','map','objectType','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','getBranchRecordByName','Branch\x20','catch','SalesforceQueryService','Attachment','./salesforce.service','160eGwHqY','getAttachmentId','design:paramtypes','getAllRepositoryNames','fromRepositoryRecord','constructor','getBranchComponents','Synchronization_Status__c','toString','../queries','440kboRFk'];a204_0x2803=function(){return _0x526429;};return a204_0x2803();}