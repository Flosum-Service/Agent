function a281_0x336f(){const _0x5cddb0=['__esModule','catch','replace','Branch_Name__c','../../../shared/utils','defineProperty','length','objectType','FlosumRepositorySyncDto','getRepositoryRecord','%id%','getComponents','search','Synchronization_Status__c','3596096gdmNya','Service','52598FePucg','map','Attachment','query','../../../../constants/errors','fromBranchRecord','1305894EJezGJ','4260996jKSvhs','GET_WAITING_BRANCHES_QUERY','getBranchRecordByName','2105JdtmvZ','SalesforceNotFoundError','SYNC_ATTACHMENT_FOR_BRANCH_NAME','../dto/flosum-repository-sync.dto','push','salesforceQuery','Repository__r','text/plain','getBranchRecord','%parentId%','\x20not\x20found\x20on\x20salesforce','FLOSUM_NAMESPACE','design:paramtypes','createObject','typedi','salesforceService','stringify','records','GET_REPOSITORY_BY_NAME_QUERY','1099102rRBBUJ','getAttachmentId','object','objectId','Branch\x20with\x20Id\x20','4492oiATXS','GET_BRANCH_QUERY','Sync_In_Progress__c','patchObject','1076712jtBQXu','getBranchRecords','../errors/not-found.error','Repository\x20with\x20Id\x20','find','./salesforce.service','getRepositoryRecordByName','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','GET_WAITING_REPOSITORIES_QUERY','repositoryId','24kBdTkj','./salesforce-query.service','getBranchComponents','decorate','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','getComponentsFromRepository','Connection__c','toString','GET_REPOSITORY_QUERY','function','fromRepositoryRecord','metadata','SalesforceSyncService','setStatus','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','SalesforceQueryService','SalesforceService','FLOSUM_GIT_NAMESPACE','ERR_INVALID_ATTACHMENT_ID','Name','../queries','%name%','GET_COMPONENTS_QUERY','encodeBase64','getRemoteStateAttachmentId'];a281_0x336f=function(){return _0x5cddb0;};return a281_0x336f();}function a281_0x242c(_0x143b20,_0x219130){const _0x43f658=a281_0x336f();return a281_0x242c=function(_0x208d43,_0xed8123){_0x208d43=_0x208d43-0xc0;let _0x336f5d=_0x43f658[_0x208d43];return _0x336f5d;},a281_0x242c(_0x143b20,_0x219130);}const a281_0x2c8e9a=a281_0x242c;(function(_0x4edb7e,_0x47cbdc){const _0x48674e=a281_0x242c,_0x237a3a=_0x4edb7e();while(!![]){try{const _0x296fae=parseInt(_0x48674e(0xd2))/0x1+-parseInt(_0x48674e(0xef))/0x2+-parseInt(_0x48674e(0xf8))/0x3+-parseInt(_0x48674e(0xf4))/0x4*(-parseInt(_0x48674e(0xdc))/0x5)+-parseInt(_0x48674e(0xd8))/0x6+-parseInt(_0x48674e(0xd0))/0x7+-parseInt(_0x48674e(0x102))/0x8*(-parseInt(_0x48674e(0xd9))/0x9);if(_0x296fae===_0x47cbdc)break;else _0x237a3a['push'](_0x237a3a['shift']());}catch(_0x4b49c9){_0x237a3a['push'](_0x237a3a['shift']());}}}(a281_0x336f,0x4aad9));const a281_0xed8123=(function(){let _0xcfd4da=!![];return function(_0x1e8939,_0x3f9f59){const _0x36b892=_0xcfd4da?function(){if(_0x3f9f59){const _0x5dec32=_0x3f9f59['apply'](_0x1e8939,arguments);return _0x3f9f59=null,_0x5dec32;}}:function(){};return _0xcfd4da=![],_0x36b892;};}()),a281_0x208d43=a281_0xed8123(this,function(){const _0xbaef64=a281_0x242c;return a281_0x208d43['toString']()['search']('(((.+)+)+)+$')[_0xbaef64(0x109)]()['constructor'](a281_0x208d43)[_0xbaef64(0xce)]('(((.+)+)+)+$');});a281_0x208d43();'use strict';var __decorate=this&&this['__decorate']||function(_0x16f0a0,_0x5e2520,_0x3cd650,_0x2d92a2){const _0x5025d5=a281_0x242c;var _0x2a02be=arguments[_0x5025d5(0xc8)],_0x60dac0=_0x2a02be<0x3?_0x5e2520:_0x2d92a2===null?_0x2d92a2=Object['getOwnPropertyDescriptor'](_0x5e2520,_0x3cd650):_0x2d92a2,_0x176318;if(typeof Reflect===_0x5025d5(0xf1)&&typeof Reflect[_0x5025d5(0x105)]==='function')_0x60dac0=Reflect[_0x5025d5(0x105)](_0x16f0a0,_0x5e2520,_0x3cd650,_0x2d92a2);else{for(var _0x4476bf=_0x16f0a0[_0x5025d5(0xc8)]-0x1;_0x4476bf>=0x0;_0x4476bf--)if(_0x176318=_0x16f0a0[_0x4476bf])_0x60dac0=(_0x2a02be<0x3?_0x176318(_0x60dac0):_0x2a02be>0x3?_0x176318(_0x5e2520,_0x3cd650,_0x60dac0):_0x176318(_0x5e2520,_0x3cd650))||_0x60dac0;}return _0x2a02be>0x3&&_0x60dac0&&Object[_0x5025d5(0xc7)](_0x5e2520,_0x3cd650,_0x60dac0),_0x60dac0;},__metadata=this&&this['__metadata']||function(_0x50cb16,_0x3792ad){const _0x59dc93=a281_0x242c;if(typeof Reflect===_0x59dc93(0xf1)&&typeof Reflect[_0x59dc93(0x10d)]===_0x59dc93(0x10b))return Reflect['metadata'](_0x50cb16,_0x3792ad);};Object[a281_0x2c8e9a(0xc7)](exports,a281_0x2c8e9a(0xc2),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a281_0x2c8e9a(0xea)),constants_1=require('../../../../constants'),errors_1=require(a281_0x2c8e9a(0xd6)),utils_1=require(a281_0x2c8e9a(0xc6)),flosum_repository_sync_dto_1=require(a281_0x2c8e9a(0xdf)),not_found_error_1=require(a281_0x2c8e9a(0xfa)),queries_1=require(a281_0x2c8e9a(0x116)),salesforce_query_service_1=require(a281_0x2c8e9a(0x103)),salesforce_service_1=require(a281_0x2c8e9a(0xfd));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x5371b3,_0x4d816a){const _0x2d76e6=a281_0x2c8e9a;this[_0x2d76e6(0xe1)]=_0x5371b3,this['salesforceService']=_0x4d816a;}async['getComponents'](_0xb3948){const _0x10c17d=a281_0x2c8e9a;var _0xe7fb9a;const _0x141367=await this[_0x10c17d(0xe1)]['query'](_0xb3948),_0x2cdf59=[];for(const _0x5f3498 of _0x141367){const _0x2716bc=(_0xe7fb9a=_0x5f3498[constants_1[_0x10c17d(0xe7)]+'Components__r'])===null||_0xe7fb9a===void 0x0?void 0x0:_0xe7fb9a[_0x10c17d(0xed)];_0x2716bc&&_0x2716bc[_0x10c17d(0xc8)]&&_0x2cdf59[_0x10c17d(0xe0)](_0x2716bc[0x0]['Id']);}return _0x2cdf59;}async['getAllRepositoryNames'](_0x2e091d){const _0x550626=a281_0x2c8e9a,_0x1be4eb=await this[_0x550626(0xe1)][_0x550626(0xd5)](queries_1['GET_REPOSITORIES_NAMES_QUERY'][_0x550626(0xc4)](/\%connection_id\%/g,_0x2e091d));return _0x1be4eb[_0x550626(0xd3)](_0x2cae4a=>{const _0xea9c03=_0x550626;return _0x2cae4a[constants_1['FLOSUM_GIT_NAMESPACE']+_0xea9c03(0xe2)]?_0x2cae4a[constants_1['FLOSUM_GIT_NAMESPACE']+_0xea9c03(0xe2)][_0xea9c03(0x115)]:_0x2cae4a[_0xea9c03(0x115)];});}async['getRepositoryRecords'](_0x1f4d3b){const _0x4828b=a281_0x2c8e9a,_0x46cc47=await this[_0x4828b(0xe1)]['query'](queries_1[_0x4828b(0x100)]['replace'](/\%connection_id\%/g,_0x1f4d3b));return _0x46cc47[_0x4828b(0xd3)](_0x7a0d4b=>flosum_repository_sync_dto_1[_0x4828b(0xca)][_0x4828b(0x10c)](_0x7a0d4b));}async[a281_0x2c8e9a(0xf9)](_0x23d81b){const _0x48ac4e=a281_0x2c8e9a,_0x24e136=await this[_0x48ac4e(0xe1)][_0x48ac4e(0xd5)](queries_1[_0x48ac4e(0xda)]['replace'](/%repositories_ids\%/g,_0x23d81b));return _0x24e136['map'](_0x20245f=>flosum_repository_sync_dto_1[_0x48ac4e(0xca)][_0x48ac4e(0xd7)](_0x20245f));}async[a281_0x2c8e9a(0xcb)](_0x1e9805){const _0x4255f3=a281_0x2c8e9a,_0x4d370d=await this[_0x4255f3(0xe1)][_0x4255f3(0xd5)](queries_1[_0x4255f3(0x10a)]['replace'](_0x4255f3(0xcc),_0x1e9805));if(_0x4d370d['length']===0x0)throw new not_found_error_1[(_0x4255f3(0xdd))](_0x4255f3(0xfb)+_0x1e9805+_0x4255f3(0xe6));return flosum_repository_sync_dto_1[_0x4255f3(0xca)][_0x4255f3(0x10c)](_0x4d370d[0x0]);}async[a281_0x2c8e9a(0xe4)](_0x4a9273){const _0x58c464=a281_0x2c8e9a,_0x5b4eb6=await this[_0x58c464(0xe1)]['query'](queries_1[_0x58c464(0xf5)][_0x58c464(0xc4)]('%id%',_0x4a9273));if(_0x5b4eb6[_0x58c464(0xc8)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x58c464(0xf3)+_0x4a9273+_0x58c464(0xe6));return flosum_repository_sync_dto_1[_0x58c464(0xca)][_0x58c464(0xd7)](_0x5b4eb6[0x0]);}async[a281_0x2c8e9a(0xdb)](_0x1ef848){const _0x13925c=a281_0x2c8e9a,_0x5f2dd2=await this[_0x13925c(0xe1)][_0x13925c(0xd5)](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x13925c(0xc4)]('%name%',_0x1ef848));if(_0x5f2dd2[_0x13925c(0xc8)]===0x0)throw new not_found_error_1[(_0x13925c(0xdd))]('Branch\x20'+_0x1ef848+_0x13925c(0xe6));const _0x21f206=_0x5f2dd2[_0x13925c(0xfc)](_0x4a6aeb=>_0x4a6aeb[constants_1[_0x13925c(0xe7)]+_0x13925c(0xc5)]===_0x1ef848);if(!_0x21f206)throw new not_found_error_1[(_0x13925c(0xdd))]('Branch\x20'+_0x1ef848+_0x13925c(0xe6));return flosum_repository_sync_dto_1[_0x13925c(0xca)][_0x13925c(0xd7)](_0x21f206);}async[a281_0x2c8e9a(0xfe)](_0x1cd8db){const _0xd62997=a281_0x2c8e9a,_0x35e00b=await this[_0xd62997(0xe1)][_0xd62997(0xd5)](queries_1[_0xd62997(0xee)]['replace'](_0xd62997(0x117),_0x1cd8db));if(_0x35e00b[_0xd62997(0xc8)]===0x0)throw new not_found_error_1[(_0xd62997(0xdd))]('Repository\x20'+_0x1cd8db+_0xd62997(0xe6));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0xd62997(0x10c)](_0x35e00b[0x0]);}async[a281_0x2c8e9a(0x107)](_0x13d3d5){const _0x38b2fd=a281_0x2c8e9a,_0x286241='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x38b2fd(0x118)]+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x13d3d5+'\x27';return this[_0x38b2fd(0xcd)](_0x286241);}async[a281_0x2c8e9a(0x104)](_0x49d6f8){const _0x24c2a1=a281_0x2c8e9a,_0x4289a8='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x24c2a1(0x118)]+_0x24c2a1(0x106)+_0x49d6f8+'\x27';return this[_0x24c2a1(0xcd)](_0x4289a8);}async['getAttachmentId'](_0x19dcfd){const _0x5e5982=a281_0x2c8e9a;var _0x1e3ef6;const _0x727e19=queries_1[_0x5e5982(0xff)][_0x5e5982(0xc4)](_0x5e5982(0xe5),_0x19dcfd[_0x5e5982(0xf2)])[_0x5e5982(0xc4)](_0x5e5982(0x117),_0x19dcfd['repositoryId']?constants_1[_0x5e5982(0x110)]:constants_1[_0x5e5982(0xde)]),_0x538eff=await this[_0x5e5982(0xe1)]['query'](_0x727e19),_0x57b1e1=(_0x1e3ef6=_0x538eff[0x0])===null||_0x1e3ef6===void 0x0?void 0x0:_0x1e3ef6['Id'];if(!_0x57b1e1)throw new Error(errors_1[_0x5e5982(0x114)]);return _0x57b1e1;}async['getRemoteStateAttachmentId'](_0x4408e1){const _0xc3c4f8=a281_0x2c8e9a;let _0x5886c9=await this[_0xc3c4f8(0xf0)](_0x4408e1)[_0xc3c4f8(0xc3)](()=>null);return!_0x5886c9&&(_0x5886c9=await this[_0xc3c4f8(0xeb)][_0xc3c4f8(0xe9)](_0xc3c4f8(0xd4),{'Body':(0x0,utils_1[_0xc3c4f8(0xc0)])('{}'),'ParentId':_0x4408e1[_0xc3c4f8(0xf2)],'ContentType':_0xc3c4f8(0xe3),'Name':_0x4408e1[_0xc3c4f8(0x101)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0xc3c4f8(0xde)]})),_0x5886c9;}async['updateRemoteState'](_0x456420,_0xc4aca1){const _0x4efcf6=a281_0x2c8e9a,_0x4858f2=await this[_0x4efcf6(0xc1)](_0x456420);await this[_0x4efcf6(0xeb)][_0x4efcf6(0xf7)](_0x4efcf6(0xd4),_0x4858f2,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x4efcf6(0xec)](_0xc4aca1))});}async[a281_0x2c8e9a(0x10f)](_0x5f1d89,_0x20f372){const _0x5b7d77=a281_0x2c8e9a;await this[_0x5b7d77(0xeb)][_0x5b7d77(0xf7)](_0x5f1d89[_0x5b7d77(0xc9)],_0x5f1d89[_0x5b7d77(0xf2)],{[constants_1[_0x5b7d77(0x113)]+_0x5b7d77(0xcf)]:_0x20f372});}async['disableSync'](_0x2eb4e9){const _0x5f2175=a281_0x2c8e9a;await this[_0x5f2175(0xeb)]['patchObject'](constants_1[_0x5f2175(0x113)]+_0x5f2175(0x108),_0x2eb4e9,{[constants_1[_0x5f2175(0x113)]+_0x5f2175(0xf6)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a281_0x2c8e9a(0xd1)])(),__metadata(a281_0x2c8e9a(0xe8),[salesforce_query_service_1[a281_0x2c8e9a(0x111)],salesforce_service_1[a281_0x2c8e9a(0x112)]])],SalesforceSyncService),exports[a281_0x2c8e9a(0x10e)]=SalesforceSyncService;