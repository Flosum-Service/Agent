const a238_0x1ec29c=a238_0x1e40;(function(_0x5c2c4e,_0x180c0d){const _0x9bda5b=a238_0x1e40,_0x1ad3b3=_0x5c2c4e();while(!![]){try{const _0x42c22c=-parseInt(_0x9bda5b(0xfb))/0x1*(parseInt(_0x9bda5b(0x108))/0x2)+parseInt(_0x9bda5b(0x123))/0x3+-parseInt(_0x9bda5b(0x101))/0x4*(-parseInt(_0x9bda5b(0xe2))/0x5)+parseInt(_0x9bda5b(0x11c))/0x6*(-parseInt(_0x9bda5b(0xf6))/0x7)+parseInt(_0x9bda5b(0xfe))/0x8+parseInt(_0x9bda5b(0xea))/0x9*(parseInt(_0x9bda5b(0xe5))/0xa)+-parseInt(_0x9bda5b(0x124))/0xb;if(_0x42c22c===_0x180c0d)break;else _0x1ad3b3['push'](_0x1ad3b3['shift']());}catch(_0xdb563c){_0x1ad3b3['push'](_0x1ad3b3['shift']());}}}(a238_0x5569,0x2b8b5));function a238_0x5569(){const _0x219014=['%parentId%','salesforceQuery','disableSync','defineProperty','objectType','Repository__r','getAllRepositoryNames','search','design:paramtypes','encodeBase64','2634kqqHER','text/plain','typedi','getAttachmentId','GET_WAITING_BRANCHES_QUERY','__decorate','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','148809FBTKNK','1910172FuelAe','FLOSUM_NAMESPACE','Repository\x20with\x20Id\x20','apply','SalesforceNotFoundError','../../../shared/utils','getRepositoryRecord','Branch_Name__c','SalesforceService','(((.+)+)+)+$','getBranchRecord','replace','objectId','getBranchRecords','length','%id%','../../../../constants','\x20not\x20found\x20on\x20salesforce','repositoryId','getRepositoryRecordByName','Branch\x20','setStatus','Connection__c','query','updateRemoteState','__esModule','createObject','./salesforce.service','./salesforce-query.service','GET_REPOSITORY_BY_NAME_QUERY','200650IuJdpC','fromBranchRecord','getComponents','10ghIXAL','FLOSUM_GIT_NAMESPACE','Sync_In_Progress__c','Synchronization_Status__c','Repository\x20','765441YQXPOA','Name','SalesforceQueryService','getBranchRecordByName','decorate','GET_WAITING_REPOSITORIES_QUERY','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','SYNC_ATTACHMENT_FOR_BRANCH_NAME','Branch\x20with\x20Id\x20','patchObject','object','salesforceService','2555esUsbm','getComponentsFromRepository','GET_REPOSITORIES_NAMES_QUERY','GET_REPOSITORY_QUERY','GET_BRANCH_QUERY','2ZGMHPh','getRemoteStateAttachmentId','records','2423808kBIysF','%name%','FlosumRepositorySyncDto','28MWScyB','Attachment','GET_COMPONENTS_QUERY','metadata','GET_BRANCH_BY_NAME_QUERY','toString','map','206294QPsWFE','getRepositoryRecords','../errors/not-found.error','SalesforceSyncService','push','catch','getOwnPropertyDescriptor','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','function','fromRepositoryRecord'];a238_0x5569=function(){return _0x219014;};return a238_0x5569();}const a238_0x466df2=(function(){let _0x232b7d=!![];return function(_0x2fff96,_0x271b69){const _0x2e2891=_0x232b7d?function(){const _0x4366bb=a238_0x1e40;if(_0x271b69){const _0x30b78d=_0x271b69[_0x4366bb(0x127)](_0x2fff96,arguments);return _0x271b69=null,_0x30b78d;}}:function(){};return _0x232b7d=![],_0x2e2891;};}()),a238_0x523b48=a238_0x466df2(this,function(){const _0x45ff52=a238_0x1e40;return a238_0x523b48[_0x45ff52(0x106)]()[_0x45ff52(0x119)](_0x45ff52(0x12d))[_0x45ff52(0x106)]()['constructor'](a238_0x523b48)[_0x45ff52(0x119)]('(((.+)+)+)+$');});a238_0x523b48();'use strict';var __decorate=this&&this[a238_0x1ec29c(0x121)]||function(_0x5b39d2,_0x42d1b8,_0x3e20ed,_0xc17476){const _0x1890e6=a238_0x1ec29c;var _0x22ece7=arguments[_0x1890e6(0x132)],_0x3b0aff=_0x22ece7<0x3?_0x42d1b8:_0xc17476===null?_0xc17476=Object[_0x1890e6(0x10e)](_0x42d1b8,_0x3e20ed):_0xc17476,_0x4c1551;if(typeof Reflect===_0x1890e6(0xf4)&&typeof Reflect[_0x1890e6(0xee)]===_0x1890e6(0x110))_0x3b0aff=Reflect[_0x1890e6(0xee)](_0x5b39d2,_0x42d1b8,_0x3e20ed,_0xc17476);else{for(var _0x417fac=_0x5b39d2['length']-0x1;_0x417fac>=0x0;_0x417fac--)if(_0x4c1551=_0x5b39d2[_0x417fac])_0x3b0aff=(_0x22ece7<0x3?_0x4c1551(_0x3b0aff):_0x22ece7>0x3?_0x4c1551(_0x42d1b8,_0x3e20ed,_0x3b0aff):_0x4c1551(_0x42d1b8,_0x3e20ed))||_0x3b0aff;}return _0x22ece7>0x3&&_0x3b0aff&&Object['defineProperty'](_0x42d1b8,_0x3e20ed,_0x3b0aff),_0x3b0aff;},__metadata=this&&this['__metadata']||function(_0x2326b0,_0x18c6c8){const _0x730562=a238_0x1ec29c;if(typeof Reflect===_0x730562(0xf4)&&typeof Reflect[_0x730562(0x104)]===_0x730562(0x110))return Reflect[_0x730562(0x104)](_0x2326b0,_0x18c6c8);};Object[a238_0x1ec29c(0x115)](exports,a238_0x1ec29c(0xdd),{'value':!![]}),exports[a238_0x1ec29c(0x10b)]=void 0x0;const typedi_1=require(a238_0x1ec29c(0x11e)),constants_1=require(a238_0x1ec29c(0x134)),errors_1=require('../../../../constants/errors'),utils_1=require(a238_0x1ec29c(0x129)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),not_found_error_1=require(a238_0x1ec29c(0x10a)),queries_1=require('../queries'),salesforce_query_service_1=require(a238_0x1ec29c(0xe0)),salesforce_service_1=require(a238_0x1ec29c(0xdf));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x24d977,_0x250490){const _0xffe118=a238_0x1ec29c;this[_0xffe118(0x113)]=_0x24d977,this['salesforceService']=_0x250490;}async[a238_0x1ec29c(0xe4)](_0x34ab19){const _0x4a64bc=a238_0x1ec29c;var _0x3f1e34;const _0x2f11df=await this[_0x4a64bc(0x113)]['query'](_0x34ab19),_0xabcd96=[];for(const _0x2cfa2d of _0x2f11df){const _0xde905a=(_0x3f1e34=_0x2cfa2d[constants_1[_0x4a64bc(0x125)]+'Components__r'])===null||_0x3f1e34===void 0x0?void 0x0:_0x3f1e34[_0x4a64bc(0xfd)];_0xde905a&&_0xde905a[_0x4a64bc(0x132)]&&_0xabcd96[_0x4a64bc(0x10c)](_0xde905a[0x0]['Id']);}return _0xabcd96;}async[a238_0x1ec29c(0x118)](_0x5c7973){const _0x544c31=a238_0x1ec29c,_0x2d2317=await this[_0x544c31(0x113)]['query'](queries_1[_0x544c31(0xf8)]['replace'](/\%connection_id\%/g,_0x5c7973));return _0x2d2317[_0x544c31(0x107)](_0x4ba3e2=>{const _0x33075a=_0x544c31;return _0x4ba3e2[constants_1['FLOSUM_GIT_NAMESPACE']+_0x33075a(0x117)]?_0x4ba3e2[constants_1[_0x33075a(0xe6)]+_0x33075a(0x117)][_0x33075a(0xeb)]:_0x4ba3e2['Name'];});}async[a238_0x1ec29c(0x109)](_0x48064e){const _0x398c5e=a238_0x1ec29c,_0x1cf86f=await this['salesforceQuery']['query'](queries_1[_0x398c5e(0xef)][_0x398c5e(0x12f)](/\%connection_id\%/g,_0x48064e));return _0x1cf86f[_0x398c5e(0x107)](_0x2612a5=>flosum_repository_sync_dto_1[_0x398c5e(0x100)]['fromRepositoryRecord'](_0x2612a5));}async[a238_0x1ec29c(0x131)](_0xab35dc){const _0x4ad9b2=a238_0x1ec29c,_0x111d18=await this[_0x4ad9b2(0x113)]['query'](queries_1[_0x4ad9b2(0x120)][_0x4ad9b2(0x12f)](/%repositories_ids\%/g,_0xab35dc));return _0x111d18[_0x4ad9b2(0x107)](_0x44b2f2=>flosum_repository_sync_dto_1[_0x4ad9b2(0x100)][_0x4ad9b2(0xe3)](_0x44b2f2));}async[a238_0x1ec29c(0x12a)](_0x240999){const _0x33053b=a238_0x1ec29c,_0x1a025f=await this['salesforceQuery'][_0x33053b(0x13b)](queries_1[_0x33053b(0xf9)][_0x33053b(0x12f)](_0x33053b(0x133),_0x240999));if(_0x1a025f[_0x33053b(0x132)]===0x0)throw new not_found_error_1[(_0x33053b(0x128))](_0x33053b(0x126)+_0x240999+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x33053b(0x111)](_0x1a025f[0x0]);}async[a238_0x1ec29c(0x12e)](_0x2c7591){const _0x28ba63=a238_0x1ec29c,_0x488d99=await this[_0x28ba63(0x113)]['query'](queries_1[_0x28ba63(0xfa)]['replace'](_0x28ba63(0x133),_0x2c7591));if(_0x488d99[_0x28ba63(0x132)]===0x0)throw new not_found_error_1[(_0x28ba63(0x128))](_0x28ba63(0xf2)+_0x2c7591+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x28ba63(0xe3)](_0x488d99[0x0]);}async[a238_0x1ec29c(0xed)](_0x1dcf84){const _0x42f12b=a238_0x1ec29c,_0x39d91a=await this[_0x42f12b(0x113)][_0x42f12b(0x13b)](queries_1[_0x42f12b(0x105)][_0x42f12b(0x12f)](_0x42f12b(0xff),_0x1dcf84));if(_0x39d91a[_0x42f12b(0x132)]===0x0)throw new not_found_error_1[(_0x42f12b(0x128))](_0x42f12b(0x138)+_0x1dcf84+_0x42f12b(0x135));const _0x23a4a0=_0x39d91a['find'](_0x30a17e=>_0x30a17e[constants_1[_0x42f12b(0x125)]+_0x42f12b(0x12b)]===_0x1dcf84);if(!_0x23a4a0)throw new not_found_error_1[(_0x42f12b(0x128))](_0x42f12b(0x138)+_0x1dcf84+_0x42f12b(0x135));return flosum_repository_sync_dto_1[_0x42f12b(0x100)][_0x42f12b(0xe3)](_0x23a4a0);}async[a238_0x1ec29c(0x137)](_0x4d8dbb){const _0x383697=a238_0x1ec29c,_0x876710=await this[_0x383697(0x113)][_0x383697(0x13b)](queries_1[_0x383697(0xe1)][_0x383697(0x12f)](_0x383697(0xff),_0x4d8dbb));if(_0x876710[_0x383697(0x132)]===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x383697(0xe9)+_0x4d8dbb+_0x383697(0x135));return flosum_repository_sync_dto_1[_0x383697(0x100)][_0x383697(0x111)](_0x876710[0x0]);}async[a238_0x1ec29c(0xf7)](_0x5a592a){const _0x5d3be8=a238_0x1ec29c,_0x5bc2ec='\x0a\x20\x20\x20\x20\x20\x20'+queries_1[_0x5d3be8(0x103)]+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x5a592a+'\x27';return this[_0x5d3be8(0xe4)](_0x5bc2ec);}async['getBranchComponents'](_0x325d7b){const _0x1749c9=a238_0x1ec29c,_0x44995c=_0x1749c9(0x122)+queries_1[_0x1749c9(0x103)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x325d7b+'\x27';return this[_0x1749c9(0xe4)](_0x44995c);}async[a238_0x1ec29c(0x11f)](_0x1491ec){const _0x5557cd=a238_0x1ec29c;var _0x8104e;const _0x5b9999=queries_1[_0x5557cd(0x10f)][_0x5557cd(0x12f)](_0x5557cd(0x112),_0x1491ec['objectId'])[_0x5557cd(0x12f)](_0x5557cd(0xff),_0x1491ec[_0x5557cd(0x136)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x5557cd(0xf1)]),_0x1968ff=await this[_0x5557cd(0x113)][_0x5557cd(0x13b)](_0x5b9999),_0x91b210=(_0x8104e=_0x1968ff[0x0])===null||_0x8104e===void 0x0?void 0x0:_0x8104e['Id'];if(!_0x91b210)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x91b210;}async[a238_0x1ec29c(0xfc)](_0x4c3412){const _0x2d8c01=a238_0x1ec29c;let _0x1b8b6f=await this[_0x2d8c01(0x11f)](_0x4c3412)[_0x2d8c01(0x10d)](()=>null);return!_0x1b8b6f&&(_0x1b8b6f=await this[_0x2d8c01(0xf5)][_0x2d8c01(0xde)](_0x2d8c01(0x102),{'Body':(0x0,utils_1[_0x2d8c01(0x11b)])('{}'),'ParentId':_0x4c3412['objectId'],'ContentType':_0x2d8c01(0x11d),'Name':_0x4c3412[_0x2d8c01(0x136)]?constants_1[_0x2d8c01(0xf0)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x1b8b6f;}async[a238_0x1ec29c(0x13c)](_0x5a4af4,_0x22ce54){const _0x54ea67=a238_0x1ec29c,_0x264f14=await this[_0x54ea67(0xfc)](_0x5a4af4);await this['salesforceService'][_0x54ea67(0xf3)](_0x54ea67(0x102),_0x264f14,{'Body':(0x0,utils_1[_0x54ea67(0x11b)])(JSON['stringify'](_0x22ce54))});}async[a238_0x1ec29c(0x139)](_0x3a1990,_0xd877aa){const _0x55a6c5=a238_0x1ec29c;await this[_0x55a6c5(0xf5)][_0x55a6c5(0xf3)](_0x3a1990[_0x55a6c5(0x116)],_0x3a1990[_0x55a6c5(0x130)],{[constants_1[_0x55a6c5(0xe6)]+_0x55a6c5(0xe8)]:_0xd877aa});}async[a238_0x1ec29c(0x114)](_0x5dd508){const _0xa6cc4c=a238_0x1ec29c;await this[_0xa6cc4c(0xf5)]['patchObject'](constants_1[_0xa6cc4c(0xe6)]+_0xa6cc4c(0x13a),_0x5dd508,{[constants_1[_0xa6cc4c(0xe6)]+_0xa6cc4c(0xe7)]:![]});}};function a238_0x1e40(_0x4f4021,_0x19c4e2){const _0x4a909e=a238_0x5569();return a238_0x1e40=function(_0x523b48,_0x466df2){_0x523b48=_0x523b48-0xdd;let _0x55693a=_0x4a909e[_0x523b48];return _0x55693a;},a238_0x1e40(_0x4f4021,_0x19c4e2);}SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a238_0x1ec29c(0x11a),[salesforce_query_service_1[a238_0x1ec29c(0xec)],salesforce_service_1[a238_0x1ec29c(0x12c)]])],SalesforceSyncService),exports[a238_0x1ec29c(0x10b)]=SalesforceSyncService;