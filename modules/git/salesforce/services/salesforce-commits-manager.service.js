const a259_0x5423e9=a259_0x1e47;(function(_0x25b1eb,_0x413946){const _0x178ec5=a259_0x1e47,_0x30f717=_0x25b1eb();while(!![]){try{const _0xdc04c4=-parseInt(_0x178ec5(0x1e3))/0x1+-parseInt(_0x178ec5(0x1de))/0x2*(parseInt(_0x178ec5(0x1f0))/0x3)+-parseInt(_0x178ec5(0x1ea))/0x4+-parseInt(_0x178ec5(0x201))/0x5*(parseInt(_0x178ec5(0x1f2))/0x6)+parseInt(_0x178ec5(0x1fa))/0x7*(parseInt(_0x178ec5(0x1e1))/0x8)+parseInt(_0x178ec5(0x1c7))/0x9+parseInt(_0x178ec5(0x1ec))/0xa;if(_0xdc04c4===_0x413946)break;else _0x30f717['push'](_0x30f717['shift']());}catch(_0x1dedb2){_0x30f717['push'](_0x30f717['shift']());}}}(a259_0x322f,0xa7ee0));const a259_0xb1a254=(function(){let _0x3a84c5=!![];return function(_0x3c2f9e,_0x38d91b){const _0x4e3f89=_0x3a84c5?function(){if(_0x38d91b){const _0x2804c6=_0x38d91b['apply'](_0x3c2f9e,arguments);return _0x38d91b=null,_0x2804c6;}}:function(){};return _0x3a84c5=![],_0x4e3f89;};}()),a259_0x2e056d=a259_0xb1a254(this,function(){const _0x353ed1=a259_0x1e47;return a259_0x2e056d[_0x353ed1(0x1d2)]()['search'](_0x353ed1(0x1cc))[_0x353ed1(0x1d2)]()[_0x353ed1(0x1dc)](a259_0x2e056d)[_0x353ed1(0x1d7)](_0x353ed1(0x1cc));});a259_0x2e056d();'use strict';var __importDefault=this&&this[a259_0x5423e9(0x205)]||function(_0x1ec176){const _0x250d7f=a259_0x5423e9;return _0x1ec176&&_0x1ec176[_0x250d7f(0x1f1)]?_0x1ec176:{'default':_0x1ec176};};Object[a259_0x5423e9(0x1f8)](exports,'__esModule',{'value':!![]}),exports[a259_0x5423e9(0x204)]=void 0x0;const core_1=require(a259_0x5423e9(0x1dd)),typedi_1=__importDefault(require('typedi')),constants_1=require('../../../../constants'),utils_1=require(a259_0x5423e9(0x1d5)),salesforce_error_1=require(a259_0x5423e9(0x1db)),composite_utils_1=require(a259_0x5423e9(0x1d6)),salesforce_components_manager_service_1=require(a259_0x5423e9(0x1e7)),salesforce_composite_service_1=require(a259_0x5423e9(0x1fd));function a259_0x1e47(_0x581686,_0x3ac3d0){const _0x39f9a2=a259_0x322f();return a259_0x1e47=function(_0x2e056d,_0xb1a254){_0x2e056d=_0x2e056d-0x1c3;let _0x322f82=_0x39f9a2[_0x2e056d];return _0x322f82;},a259_0x1e47(_0x581686,_0x3ac3d0);}class SalesforceCommitsManager{constructor(_0x190a9d){const _0xc7c6e3=a259_0x5423e9;this[_0xc7c6e3(0x1ca)]=_0x190a9d,this[_0xc7c6e3(0x1ef)]=0x3,this['logger']=new core_1['Logger'](SalesforceCommitsManager[_0xc7c6e3(0x1f5)]),this[_0xc7c6e3(0x1c4)]=this[_0xc7c6e3(0x1ca)]['logger'],this['composite']=typedi_1[_0xc7c6e3(0x1cd)][_0xc7c6e3(0x1c8)](salesforce_composite_service_1[_0xc7c6e3(0x203)]),this[_0xc7c6e3(0x1f3)]=[];}async[a259_0x5423e9(0x20d)](_0x4c0048,_0x5de650=![]){const _0x32f5c6=a259_0x5423e9,_0x5a2eb0=async _0x5142df=>{const _0x373cb1=a259_0x1e47;await this[_0x373cb1(0x20b)][_0x373cb1(0x1e0)](_0x373cb1(0x1d4)+_0x5142df[_0x373cb1(0x1f9)]((_0xae6371,_0x4cf901)=>_0xae6371+_0x4cf901['length'],0x0)+_0x373cb1(0x1c9));const _0x1da163=_0x5142df[_0x373cb1(0x208)]((_0x3a242b,_0x160170)=>({'graphId':'graph'+_0x160170,'compositeRequest':_0x3a242b})),_0x1a8f84=await this[_0x373cb1(0x1fb)][_0x373cb1(0x207)](_0x1da163);if(_0x5de650){const _0x583354=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x1a8f84);for(const {id:_0x52d422,ref:_0x2bee20}of _0x583354){const _0xacab3b=this[_0x373cb1(0x1f3)][_0x373cb1(0x1da)](_0x399dc9=>_0x399dc9[_0x373cb1(0x1d3)]===_0x2bee20);_0xacab3b&&(_0xacab3b['componentId']=_0x52d422);}}},_0x430de9=0x1e8480;let _0x2cb5f7=0x0,_0x1272ea=[];for(const _0x264ab6 of _0x4c0048){const _0x159276=_0x264ab6[_0x32f5c6(0x1f9)]((_0x41b493,_0x4a6b99)=>{const _0x5f3388=_0x32f5c6,_0x3488cb=JSON[_0x5f3388(0x1f4)](_0x4a6b99)[_0x5f3388(0x1f6)]*0x2;return _0x41b493+_0x3488cb;},0x0);if(_0x159276>constants_1[_0x32f5c6(0x1d0)])throw new salesforce_error_1['SalesforceError']('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+'\x20COMPONENTS_SIZE\x20=\x20'+_0x159276);_0x2cb5f7+_0x159276>constants_1[_0x32f5c6(0x1d0)]-_0x430de9&&(await _0x5a2eb0(_0x1272ea),_0x1272ea=[],_0x2cb5f7=0x0),_0x2cb5f7+=_0x159276,_0x1272ea[_0x32f5c6(0x20a)](_0x264ab6);}_0x1272ea[_0x32f5c6(0x1f6)]&&await _0x5a2eb0(_0x1272ea);}async[a259_0x5423e9(0x209)](_0x1d9e4b,_0x5ac2bb=![]){const _0x4d608d=a259_0x5423e9,_0x207396=(this[_0x4d608d(0x1ef)]+ +_0x5ac2bb)*0x3,_0x4ce719=(0x0,utils_1[_0x4d608d(0x1e6)])(_0x1d9e4b,_0x207396);try{while(_0x4ce719[_0x4d608d(0x1f6)]){const _0x2a166f=_0x4ce719[_0x4d608d(0x1e5)](0x0,Math[_0x4d608d(0x1df)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x207396));await this[_0x4d608d(0x20d)](_0x2a166f,_0x5ac2bb);}}catch(_0x268a82){this['logger'][_0x4d608d(0x1c6)](_0x268a82 instanceof salesforce_error_1[_0x4d608d(0x20c)]?JSON['stringify'](_0x268a82[_0x4d608d(0x1eb)](),null,0x2):_0x268a82),this[_0x4d608d(0x1c4)][_0x4d608d(0x1e0)](_0x268a82 instanceof salesforce_error_1['SalesforceError']?JSON[_0x4d608d(0x1f4)](_0x268a82[_0x4d608d(0x1eb)](),null,0x2):_0x268a82[_0x4d608d(0x1d2)]());throw _0x268a82;}}async['proceedCommitsToRepository'](_0xe4620f){const _0x25f2ec=a259_0x5423e9;for(const _0x1b0ab2 of _0xe4620f){if(!_0x1b0ab2[_0x25f2ec(0x1e4)][_0x25f2ec(0x1f6)]&&!_0x1b0ab2[_0x25f2ec(0x1d9)]['length']&&!_0x1b0ab2[_0x25f2ec(0x206)][_0x25f2ec(0x1f6)])continue;const _0x163611=[],_0x3a2956=[],_0x1c7372=new salesforce_components_manager_service_1[(_0x25f2ec(0x1c3))](this[_0x25f2ec(0x1ca)]['repositoryId'],this[_0x25f2ec(0x1ca)][_0x25f2ec(0x1ce)],_0x1b0ab2['author'],this['options']['recordTypes'],this['proceededComponentsMeta']);_0x163611[_0x25f2ec(0x20a)](...await _0x1c7372[_0x25f2ec(0x1c5)](_0x1b0ab2[_0x25f2ec(0x1e4)],this[_0x25f2ec(0x1ca)][_0x25f2ec(0x1cf)])),_0x163611[_0x25f2ec(0x20a)](...await _0x1c7372[_0x25f2ec(0x1ed)](_0x1b0ab2[_0x25f2ec(0x1d9)],this[_0x25f2ec(0x1ca)][_0x25f2ec(0x1cf)])),_0x3a2956[_0x25f2ec(0x20a)](await _0x1c7372[_0x25f2ec(0x1ee)](_0x1b0ab2[_0x25f2ec(0x206)],!![])),this['proceededComponentsMeta']=_0x1c7372[_0x25f2ec(0x1cb)](),await this[_0x25f2ec(0x209)](_0x163611,!![]);for(const _0x368f6d of _0x3a2956){_0x368f6d[_0x25f2ec(0x202)]['length']&&await this[_0x25f2ec(0x209)](_0x368f6d[_0x25f2ec(0x202)],!![]),_0x368f6d[_0x25f2ec(0x1d1)][_0x25f2ec(0x1f6)]&&await this[_0x25f2ec(0x209)](_0x368f6d[_0x25f2ec(0x1d1)],!![]),_0x368f6d[_0x25f2ec(0x1f7)][_0x25f2ec(0x1f6)]&&await this[_0x25f2ec(0x209)](_0x368f6d[_0x25f2ec(0x1f7)],!![]);}this['logger'][_0x25f2ec(0x1e0)](_0x25f2ec(0x1e9),_0x163611['length']);}}async[a259_0x5423e9(0x1e8)](_0x27e69a){const _0x51ef79=a259_0x5423e9,_0x4377bb=[],_0x41b71a=[];for(const _0x3b7a5c of _0x27e69a){if(!_0x3b7a5c[_0x51ef79(0x1e4)]['length']&&!_0x3b7a5c[_0x51ef79(0x1d9)][_0x51ef79(0x1f6)]&&!_0x3b7a5c[_0x51ef79(0x206)][_0x51ef79(0x1f6)])continue;const _0x534804=new salesforce_components_manager_service_1[(_0x51ef79(0x1c3))](this[_0x51ef79(0x1ca)][_0x51ef79(0x200)],this['options'][_0x51ef79(0x1ce)],_0x3b7a5c[_0x51ef79(0x1fc)],this[_0x51ef79(0x1ca)][_0x51ef79(0x1d8)],[]);_0x4377bb['push'](...await _0x534804['insert'](_0x3b7a5c[_0x51ef79(0x1e4)])),_0x4377bb[_0x51ef79(0x20a)](...await _0x534804['update'](_0x3b7a5c[_0x51ef79(0x1d9)])),_0x41b71a[_0x51ef79(0x20a)](await _0x534804[_0x51ef79(0x1ee)](_0x3b7a5c[_0x51ef79(0x206)]));}this[_0x51ef79(0x20b)][_0x51ef79(0x1e0)](_0x51ef79(0x1fe),_0x4377bb[_0x51ef79(0x1f6)]),await this[_0x51ef79(0x209)](_0x4377bb);const _0xa02f1c=_0x41b71a[_0x51ef79(0x1f9)]((_0x34acbd,_0x12058a)=>({'manifests':[..._0x34acbd[_0x51ef79(0x202)],..._0x12058a[_0x51ef79(0x202)]],'componentsToDelete':[..._0x34acbd[_0x51ef79(0x1f7)],..._0x12058a[_0x51ef79(0x1f7)]],'componentsToUpdate':[..._0x34acbd[_0x51ef79(0x1d1)],..._0x12058a['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0xa02f1c[_0x51ef79(0x202)][_0x51ef79(0x1f6)]&&await this[_0x51ef79(0x209)](_0xa02f1c[_0x51ef79(0x202)],!![]),_0xa02f1c[_0x51ef79(0x1d1)][_0x51ef79(0x1f6)]&&await this['proceedRequests'](_0xa02f1c['componentsToUpdate'],!![]),_0xa02f1c[_0x51ef79(0x1f7)][_0x51ef79(0x1f6)]&&await this['proceedRequests'](_0xa02f1c[_0x51ef79(0x1f7)],!![]);}async[a259_0x5423e9(0x1e2)](_0x96c4dc){const _0xd267cd=a259_0x5423e9;this[_0xd267cd(0x1ca)][_0xd267cd(0x1ce)]?await this['proceedCommitsToBranch'](_0x96c4dc):await this[_0xd267cd(0x1ff)](_0x96c4dc);}}exports[a259_0x5423e9(0x204)]=SalesforceCommitsManager;function a259_0x322f(){const _0x4a26d7=['commitId','SALESFORCE_MAX_REQUEST_SIZE_BYTES','componentsToUpdate','toString','reference','Sending\x20','../../../shared/utils','../utils/composite.utils','search','recordTypes','modified','find','../errors/salesforce.error','constructor','../../../../core','64THoPzf','floor','log','2124160IbBeMN','proceedCommits','458890GtouOF','inserted','splice','chunkArray','./salesforce-components-manager.service','proceedCommitsToBranch','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','2515352vZBkFG','toJSON','22584160CWknSi','update','delete','COMPONENTS_PER_CHUNK','13953OJMzCT','__esModule','1523226GEycmc','proceededComponentsMeta','stringify','name','length','componentsToDelete','defineProperty','reduce','7sozpfe','composite','author','./salesforce-composite.service','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','proceedCommitsToRepository','repositoryId','25QhVvYn','manifests','SalesforceCompositeService','SalesforceCommitsManager','__importDefault','removed','executeGraphs','map','proceedRequests','push','logger','SalesforceError','proceedChunksToUpload','SalesforceComponentsManager','sfLogger','insert','error','6028371NJgRID','get','\x20requests\x20to\x20composite\x20api.','options','getProceededComponentsMeta','(((.+)+)+)+$','default','branchId'];a259_0x322f=function(){return _0x4a26d7;};return a259_0x322f();}