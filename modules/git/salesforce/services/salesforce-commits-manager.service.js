function a260_0xc527(_0x1275e6,_0x5e505c){const _0x84b3ae=a260_0x2a37();return a260_0xc527=function(_0x2ba63b,_0x16a0ac){_0x2ba63b=_0x2ba63b-0x13c;let _0x2a37ad=_0x84b3ae[_0x2ba63b];return _0x2a37ad;},a260_0xc527(_0x1275e6,_0x5e505c);}const a260_0x364d0a=a260_0xc527;(function(_0x5a00a3,_0x3a8e3a){const _0x5a5bf7=a260_0xc527,_0x309648=_0x5a00a3();while(!![]){try{const _0x36905f=-parseInt(_0x5a5bf7(0x147))/0x1+-parseInt(_0x5a5bf7(0x16a))/0x2+-parseInt(_0x5a5bf7(0x14b))/0x3*(-parseInt(_0x5a5bf7(0x186))/0x4)+parseInt(_0x5a5bf7(0x156))/0x5*(parseInt(_0x5a5bf7(0x153))/0x6)+-parseInt(_0x5a5bf7(0x16c))/0x7+parseInt(_0x5a5bf7(0x16f))/0x8+parseInt(_0x5a5bf7(0x185))/0x9;if(_0x36905f===_0x3a8e3a)break;else _0x309648['push'](_0x309648['shift']());}catch(_0x29b56f){_0x309648['push'](_0x309648['shift']());}}}(a260_0x2a37,0x89972));const a260_0x16a0ac=(function(){let _0x26e06d=!![];return function(_0x4355a4,_0x1b2321){const _0x4cb854=_0x26e06d?function(){const _0x3a3ba8=a260_0xc527;if(_0x1b2321){const _0x5dd0f1=_0x1b2321[_0x3a3ba8(0x141)](_0x4355a4,arguments);return _0x1b2321=null,_0x5dd0f1;}}:function(){};return _0x26e06d=![],_0x4cb854;};}()),a260_0x2ba63b=a260_0x16a0ac(this,function(){const _0x42feda=a260_0xc527;return a260_0x2ba63b[_0x42feda(0x159)]()[_0x42feda(0x157)]('(((.+)+)+)+$')[_0x42feda(0x159)]()[_0x42feda(0x163)](a260_0x2ba63b)[_0x42feda(0x157)](_0x42feda(0x167));});function a260_0x2a37(){const _0x53d38b=['Logger','134118muuPUi','push','3068107dTUfXp','proceedCommitsToBranch','../../../shared/utils','6048952UFQCdU','componentsToDelete','proceedCommitsToRepository','typedi','__importDefault','SalesforceComponentsManager','SalesforceError','proceedChunksToUpload','map','recordTypes','commitId','getProceededComponentsMeta','./salesforce-components-manager.service','componentId','componentsToUpdate','floor','\x20COMPONENTS_SIZE\x20=\x20','../../../../core','\x20requests\x20to\x20composite\x20api.','executeGraphs','proceededComponentsMeta','author','1779777FfrEcB','4uLXwEW','removed','reduce','insert','stringify','defineProperty','graph','apply','options','manifests','logger','SALESFORCE_MAX_REQUEST_SIZE_BYTES','sfLogger','184237MEEFFl','SalesforceCommitsManager','../utils/composite.utils','delete','95643KIbWoh','inserted','./salesforce-composite.service','reference','repositoryId','extractComponentIdsFromGraphsResponse','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','../errors/salesforce.error','126vQtuxc','branchId','proceedRequests','63670lWQLNo','search','update','toString','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','length','find','COMPONENTS_PER_CHUNK','default','log','toJSON','__esModule','SalesforceCompositeService','constructor','modified','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','composite','(((.+)+)+)+$','../../../../constants'];a260_0x2a37=function(){return _0x53d38b;};return a260_0x2a37();}a260_0x2ba63b();'use strict';var __importDefault=this&&this[a260_0x364d0a(0x173)]||function(_0x46bbb4){const _0x4e6704=a260_0x364d0a;return _0x46bbb4&&_0x46bbb4[_0x4e6704(0x161)]?_0x46bbb4:{'default':_0x46bbb4};};Object[a260_0x364d0a(0x13f)](exports,a260_0x364d0a(0x161),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require(a260_0x364d0a(0x180)),typedi_1=__importDefault(require(a260_0x364d0a(0x172))),constants_1=require(a260_0x364d0a(0x168)),utils_1=require(a260_0x364d0a(0x16e)),salesforce_error_1=require(a260_0x364d0a(0x152)),composite_utils_1=require(a260_0x364d0a(0x149)),salesforce_components_manager_service_1=require(a260_0x364d0a(0x17b)),salesforce_composite_service_1=require(a260_0x364d0a(0x14d));class SalesforceCommitsManager{constructor(_0x33f0de){const _0xd0bddd=a260_0x364d0a;this[_0xd0bddd(0x142)]=_0x33f0de,this[_0xd0bddd(0x15d)]=0x3,this['logger']=new core_1[(_0xd0bddd(0x169))](SalesforceCommitsManager['name']),this[_0xd0bddd(0x146)]=this['options'][_0xd0bddd(0x144)],this['composite']=typedi_1[_0xd0bddd(0x15e)]['get'](salesforce_composite_service_1[_0xd0bddd(0x162)]),this[_0xd0bddd(0x183)]=[];}async[a260_0x364d0a(0x176)](_0x2e5e1e,_0x11b1a0=![]){const _0x11e7bc=a260_0x364d0a,_0x51851f=async _0x126a23=>{const _0x56f31c=a260_0xc527;await this[_0x56f31c(0x144)][_0x56f31c(0x15f)]('Sending\x20'+_0x126a23[_0x56f31c(0x13c)]((_0x237d71,_0x17f288)=>_0x237d71+_0x17f288[_0x56f31c(0x15b)],0x0)+_0x56f31c(0x181));const _0x28a358=_0x126a23[_0x56f31c(0x177)]((_0x1081b5,_0x45ec49)=>({'graphId':_0x56f31c(0x140)+_0x45ec49,'compositeRequest':_0x1081b5})),_0x4c8459=await this[_0x56f31c(0x166)][_0x56f31c(0x182)](_0x28a358);if(_0x11b1a0){const _0x29c004=(0x0,composite_utils_1[_0x56f31c(0x150)])(_0x4c8459);for(const {id:_0x33b754,ref:_0x2deba2}of _0x29c004){const _0x366d74=this[_0x56f31c(0x183)][_0x56f31c(0x15c)](_0x4dcb1c=>_0x4dcb1c[_0x56f31c(0x14e)]===_0x2deba2);_0x366d74&&(_0x366d74[_0x56f31c(0x17c)]=_0x33b754);}}},_0xcd60be=0x1e8480;let _0x54996c=0x0,_0x37353f=[];for(const _0x44bd98 of _0x2e5e1e){const _0x32a003=_0x44bd98['reduce']((_0x5ba01a,_0x59d3aa)=>{const _0x4d42cd=a260_0xc527,_0x8d06bb=JSON[_0x4d42cd(0x13e)](_0x59d3aa)['length']*0x2;return _0x5ba01a+_0x8d06bb;},0x0);if(_0x32a003>constants_1[_0x11e7bc(0x145)])throw new salesforce_error_1[(_0x11e7bc(0x175))](_0x11e7bc(0x151)+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+_0x11e7bc(0x17f)+_0x32a003);_0x54996c+_0x32a003>constants_1[_0x11e7bc(0x145)]-_0xcd60be&&(await _0x51851f(_0x37353f),_0x37353f=[],_0x54996c=0x0),_0x54996c+=_0x32a003,_0x37353f[_0x11e7bc(0x16b)](_0x44bd98);}_0x37353f[_0x11e7bc(0x15b)]&&await _0x51851f(_0x37353f);}async['proceedRequests'](_0x458e42,_0x19a518=![]){const _0x288a3f=a260_0x364d0a,_0x3122e0=(this[_0x288a3f(0x15d)]+ +_0x19a518)*0x3,_0x18722b=(0x0,utils_1['chunkArray'])(_0x458e42,_0x3122e0);try{while(_0x18722b[_0x288a3f(0x15b)]){const _0x25445e=_0x18722b['splice'](0x0,Math[_0x288a3f(0x17e)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x3122e0));await this[_0x288a3f(0x176)](_0x25445e,_0x19a518);}}catch(_0x3c9cc9){this[_0x288a3f(0x144)]['error'](_0x3c9cc9 instanceof salesforce_error_1[_0x288a3f(0x175)]?JSON[_0x288a3f(0x13e)](_0x3c9cc9[_0x288a3f(0x160)](),null,0x2):_0x3c9cc9),this[_0x288a3f(0x146)]['log'](_0x3c9cc9 instanceof salesforce_error_1[_0x288a3f(0x175)]?JSON['stringify'](_0x3c9cc9[_0x288a3f(0x160)](),null,0x2):_0x3c9cc9[_0x288a3f(0x159)]());throw _0x3c9cc9;}}async['proceedCommitsToRepository'](_0x16434d){const _0x4a0f6b=a260_0x364d0a;for(const _0x5affd0 of _0x16434d){if(!_0x5affd0[_0x4a0f6b(0x14c)]['length']&&!_0x5affd0[_0x4a0f6b(0x164)][_0x4a0f6b(0x15b)]&&!_0x5affd0[_0x4a0f6b(0x187)][_0x4a0f6b(0x15b)])continue;const _0x2fbe5f=[],_0x5774d7=[],_0x576d1c=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x4a0f6b(0x142)][_0x4a0f6b(0x14f)],this[_0x4a0f6b(0x142)][_0x4a0f6b(0x154)],_0x5affd0[_0x4a0f6b(0x184)],this[_0x4a0f6b(0x142)][_0x4a0f6b(0x178)],this['proceededComponentsMeta']);_0x2fbe5f[_0x4a0f6b(0x16b)](...await _0x576d1c[_0x4a0f6b(0x13d)](_0x5affd0[_0x4a0f6b(0x14c)],this[_0x4a0f6b(0x142)][_0x4a0f6b(0x179)])),_0x2fbe5f['push'](...await _0x576d1c['update'](_0x5affd0[_0x4a0f6b(0x164)],this[_0x4a0f6b(0x142)][_0x4a0f6b(0x179)])),_0x5774d7['push'](await _0x576d1c[_0x4a0f6b(0x14a)](_0x5affd0[_0x4a0f6b(0x187)],!![])),this[_0x4a0f6b(0x183)]=_0x576d1c[_0x4a0f6b(0x17a)](),await this['proceedRequests'](_0x2fbe5f,!![]);for(const _0x3093bd of _0x5774d7){_0x3093bd[_0x4a0f6b(0x143)][_0x4a0f6b(0x15b)]&&await this['proceedRequests'](_0x3093bd[_0x4a0f6b(0x143)],!![]),_0x3093bd['componentsToUpdate'][_0x4a0f6b(0x15b)]&&await this[_0x4a0f6b(0x155)](_0x3093bd[_0x4a0f6b(0x17d)],!![]),_0x3093bd['componentsToDelete'][_0x4a0f6b(0x15b)]&&await this[_0x4a0f6b(0x155)](_0x3093bd[_0x4a0f6b(0x170)],!![]);}this['logger'][_0x4a0f6b(0x15f)](_0x4a0f6b(0x165),_0x2fbe5f[_0x4a0f6b(0x15b)]);}}async[a260_0x364d0a(0x16d)](_0x8b3b78){const _0x3581c7=a260_0x364d0a,_0x177866=[],_0x3085f6=[];for(const _0x5272df of _0x8b3b78){if(!_0x5272df[_0x3581c7(0x14c)]['length']&&!_0x5272df[_0x3581c7(0x164)][_0x3581c7(0x15b)]&&!_0x5272df[_0x3581c7(0x187)][_0x3581c7(0x15b)])continue;const _0xc19fae=new salesforce_components_manager_service_1[(_0x3581c7(0x174))](this[_0x3581c7(0x142)]['repositoryId'],this[_0x3581c7(0x142)][_0x3581c7(0x154)],_0x5272df[_0x3581c7(0x184)],this['options']['recordTypes'],[]);_0x177866[_0x3581c7(0x16b)](...await _0xc19fae[_0x3581c7(0x13d)](_0x5272df[_0x3581c7(0x14c)])),_0x177866[_0x3581c7(0x16b)](...await _0xc19fae[_0x3581c7(0x158)](_0x5272df[_0x3581c7(0x164)])),_0x3085f6[_0x3581c7(0x16b)](await _0xc19fae[_0x3581c7(0x14a)](_0x5272df[_0x3581c7(0x187)]));}this[_0x3581c7(0x144)][_0x3581c7(0x15f)](_0x3581c7(0x15a),_0x177866[_0x3581c7(0x15b)]),await this[_0x3581c7(0x155)](_0x177866);const _0x234869=_0x3085f6[_0x3581c7(0x13c)]((_0x5a6f18,_0x383c3a)=>({'manifests':[..._0x5a6f18[_0x3581c7(0x143)],..._0x383c3a['manifests']],'componentsToDelete':[..._0x5a6f18['componentsToDelete'],..._0x383c3a[_0x3581c7(0x170)]],'componentsToUpdate':[..._0x5a6f18[_0x3581c7(0x17d)],..._0x383c3a['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x234869['manifests']['length']&&await this[_0x3581c7(0x155)](_0x234869[_0x3581c7(0x143)],!![]),_0x234869[_0x3581c7(0x17d)][_0x3581c7(0x15b)]&&await this[_0x3581c7(0x155)](_0x234869[_0x3581c7(0x17d)],!![]),_0x234869[_0x3581c7(0x170)][_0x3581c7(0x15b)]&&await this[_0x3581c7(0x155)](_0x234869[_0x3581c7(0x170)],!![]);}async['proceedCommits'](_0xcb0ce2){const _0xbfc6df=a260_0x364d0a;this[_0xbfc6df(0x142)]['branchId']?await this[_0xbfc6df(0x16d)](_0xcb0ce2):await this[_0xbfc6df(0x171)](_0xcb0ce2);}}exports[a260_0x364d0a(0x148)]=SalesforceCommitsManager;