const a270_0x456c07=a270_0x5568;function a270_0x5568(_0xdf34c4,_0x4efbe7){const _0x599bdd=a270_0x1d2d();return a270_0x5568=function(_0x3bb1cc,_0x5eb338){_0x3bb1cc=_0x3bb1cc-0x13f;let _0x1d2d67=_0x599bdd[_0x3bb1cc];return _0x1d2d67;},a270_0x5568(_0xdf34c4,_0x4efbe7);}function a270_0x1d2d(){const _0x4557db=['apply','./salesforce-composite.service','518DYkcMQ','113466fzFiaP','../../../shared/utils','(((.+)+)+)+$','options','./salesforce-components-manager.service','find','componentsToDelete','2816984yxjNGv','SalesforceCompositeService','update','name','repositoryId','\x20COMPONENTS_SIZE\x20=\x20','12jLpEbz','reduce','14191686XfxChI','Sending\x20','504440ZjoFEB','SALESFORCE_MAX_REQUEST_SIZE_BYTES','4951859ZCquJr','commitId','toJSON','\x20requests\x20to\x20composite\x20api.','../errors/salesforce.error','proceedCommitsToRepository','log','1285849VcaiAB','proceedChunksToUpload','removed','composite','COMPONENTS_PER_CHUNK','Logger','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','branchId','delete','error','defineProperty','length','sfLogger','executeGraphs','3216248ZdLjSr','insert','modified','__importDefault','search','../../../../constants','toString','default','getProceededComponentsMeta','author','stringify','inserted','recordTypes','componentsToUpdate','typedi','proceededComponentsMeta','push','logger','manifests','chunkArray','__esModule','SalesforceError','10mSokEB','splice','70sAIXmD','proceedCommitsToBranch','SalesforceCommitsManager','proceedRequests','get','reference','proceedCommits','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','graph'];a270_0x1d2d=function(){return _0x4557db;};return a270_0x1d2d();}(function(_0x25a73a,_0x2fe8b5){const _0x27e8f0=a270_0x5568,_0x507747=_0x25a73a();while(!![]){try{const _0x13476b=-parseInt(_0x27e8f0(0x182))/0x1+-parseInt(_0x27e8f0(0x179))/0x2*(-parseInt(_0x27e8f0(0x175))/0x3)+-parseInt(_0x27e8f0(0x16f))/0x4*(parseInt(_0x27e8f0(0x15a))/0x5)+parseInt(_0x27e8f0(0x168))/0x6*(parseInt(_0x27e8f0(0x167))/0x7)+-parseInt(_0x27e8f0(0x144))/0x8+-parseInt(_0x27e8f0(0x177))/0x9+parseInt(_0x27e8f0(0x15c))/0xa*(parseInt(_0x27e8f0(0x17b))/0xb);if(_0x13476b===_0x2fe8b5)break;else _0x507747['push'](_0x507747['shift']());}catch(_0xd40bfd){_0x507747['push'](_0x507747['shift']());}}}(a270_0x1d2d,0xd85eb));const a270_0x5eb338=(function(){let _0x468e69=!![];return function(_0x5ca128,_0x3e94bd){const _0x2f5cc3=_0x468e69?function(){const _0x37fefe=a270_0x5568;if(_0x3e94bd){const _0xc6008f=_0x3e94bd[_0x37fefe(0x165)](_0x5ca128,arguments);return _0x3e94bd=null,_0xc6008f;}}:function(){};return _0x468e69=![],_0x2f5cc3;};}()),a270_0x3bb1cc=a270_0x5eb338(this,function(){const _0x434c85=a270_0x5568;return a270_0x3bb1cc[_0x434c85(0x14a)]()['search'](_0x434c85(0x16a))[_0x434c85(0x14a)]()['constructor'](a270_0x3bb1cc)[_0x434c85(0x148)](_0x434c85(0x16a));});a270_0x3bb1cc();'use strict';var __importDefault=this&&this[a270_0x456c07(0x147)]||function(_0x71cd8f){return _0x71cd8f&&_0x71cd8f['__esModule']?_0x71cd8f:{'default':_0x71cd8f};};Object[a270_0x456c07(0x140)](exports,a270_0x456c07(0x158),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require(a270_0x456c07(0x152))),constants_1=require(a270_0x456c07(0x149)),utils_1=require(a270_0x456c07(0x169)),salesforce_error_1=require(a270_0x456c07(0x17f)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a270_0x456c07(0x16c)),salesforce_composite_service_1=require(a270_0x456c07(0x166));class SalesforceCommitsManager{constructor(_0xa22d87){const _0x3261a9=a270_0x456c07;this[_0x3261a9(0x16b)]=_0xa22d87,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x3261a9(0x155)]=new core_1[(_0x3261a9(0x187))](SalesforceCommitsManager[_0x3261a9(0x172)]),this[_0x3261a9(0x142)]=this[_0x3261a9(0x16b)][_0x3261a9(0x155)],this[_0x3261a9(0x185)]=typedi_1[_0x3261a9(0x14b)][_0x3261a9(0x160)](salesforce_composite_service_1[_0x3261a9(0x170)]),this[_0x3261a9(0x153)]=[];}async[a270_0x456c07(0x183)](_0x2a3d97,_0x187084=![]){const _0x1f3701=a270_0x456c07,_0x3532c8=async _0x4207ae=>{const _0x4d7a3f=a270_0x5568;await this[_0x4d7a3f(0x155)]['log'](_0x4d7a3f(0x178)+_0x4207ae[_0x4d7a3f(0x176)]((_0x21bd5a,_0x52dacf)=>_0x21bd5a+_0x52dacf[_0x4d7a3f(0x141)],0x0)+_0x4d7a3f(0x17e));const _0x5d2b60=_0x4207ae['map']((_0x8ccc90,_0x1983ba)=>({'graphId':_0x4d7a3f(0x164)+_0x1983ba,'compositeRequest':_0x8ccc90})),_0x39933f=await this[_0x4d7a3f(0x185)][_0x4d7a3f(0x143)](_0x5d2b60);if(_0x187084){const _0x2e6bcf=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x39933f);for(const {id:_0x621d8e,ref:_0x4de6ee}of _0x2e6bcf){const _0x3a3376=this[_0x4d7a3f(0x153)][_0x4d7a3f(0x16d)](_0x4e641b=>_0x4e641b[_0x4d7a3f(0x161)]===_0x4de6ee);_0x3a3376&&(_0x3a3376['componentId']=_0x621d8e);}}},_0x3d9f81=0x1e8480;let _0x533c9f=0x0,_0x3edc8e=[];for(const _0xf31b64 of _0x2a3d97){const _0x22b2fd=_0xf31b64[_0x1f3701(0x176)]((_0x56d87f,_0x2bc76e)=>{const _0x43aa57=_0x1f3701,_0x3cdb1a=JSON[_0x43aa57(0x14e)](_0x2bc76e)['length']*0x2;return _0x56d87f+_0x3cdb1a;},0x0);if(_0x22b2fd>constants_1[_0x1f3701(0x17a)])throw new salesforce_error_1[(_0x1f3701(0x159))](_0x1f3701(0x163)+constants_1[_0x1f3701(0x17a)]+_0x1f3701(0x174)+_0x22b2fd);_0x533c9f+_0x22b2fd>constants_1[_0x1f3701(0x17a)]-_0x3d9f81&&(await _0x3532c8(_0x3edc8e),_0x3edc8e=[],_0x533c9f=0x0),_0x533c9f+=_0x22b2fd,_0x3edc8e[_0x1f3701(0x154)](_0xf31b64);}_0x3edc8e[_0x1f3701(0x141)]&&await _0x3532c8(_0x3edc8e);}async[a270_0x456c07(0x15f)](_0x3affac,_0x8b6ef9=![]){const _0x328686=a270_0x456c07,_0x265b85=(this[_0x328686(0x186)]+ +_0x8b6ef9)*0x3,_0x5943dc=(0x0,utils_1[_0x328686(0x157)])(_0x3affac,_0x265b85);try{while(_0x5943dc[_0x328686(0x141)]){const _0x230d8d=_0x5943dc[_0x328686(0x15b)](0x0,Math['floor'](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x265b85));await this[_0x328686(0x183)](_0x230d8d,_0x8b6ef9);}}catch(_0x35a8be){this[_0x328686(0x155)][_0x328686(0x13f)](_0x35a8be instanceof salesforce_error_1[_0x328686(0x159)]?JSON[_0x328686(0x14e)](_0x35a8be[_0x328686(0x17d)](),null,0x2):_0x35a8be),this[_0x328686(0x142)]['log'](_0x35a8be instanceof salesforce_error_1[_0x328686(0x159)]?JSON['stringify'](_0x35a8be[_0x328686(0x17d)](),null,0x2):_0x35a8be[_0x328686(0x14a)]());throw _0x35a8be;}}async[a270_0x456c07(0x180)](_0x5d79b8){const _0x29efc3=a270_0x456c07;for(const _0x150b2a of _0x5d79b8){if(!_0x150b2a[_0x29efc3(0x14f)][_0x29efc3(0x141)]&&!_0x150b2a[_0x29efc3(0x146)][_0x29efc3(0x141)]&&!_0x150b2a[_0x29efc3(0x184)][_0x29efc3(0x141)])continue;const _0x51a747=[],_0x441616=[],_0xe81a8c=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x29efc3(0x16b)][_0x29efc3(0x173)],this['options'][_0x29efc3(0x189)],_0x150b2a[_0x29efc3(0x14d)],this[_0x29efc3(0x16b)]['recordTypes'],this[_0x29efc3(0x153)]);_0x51a747['push'](...await _0xe81a8c[_0x29efc3(0x145)](_0x150b2a[_0x29efc3(0x14f)],this[_0x29efc3(0x16b)]['commitId'])),_0x51a747['push'](...await _0xe81a8c[_0x29efc3(0x171)](_0x150b2a['modified'],this[_0x29efc3(0x16b)][_0x29efc3(0x17c)])),_0x441616[_0x29efc3(0x154)](await _0xe81a8c[_0x29efc3(0x18a)](_0x150b2a['removed'],!![])),this['proceededComponentsMeta']=_0xe81a8c[_0x29efc3(0x14c)](),await this[_0x29efc3(0x15f)](_0x51a747,!![]);for(const _0x496334 of _0x441616){_0x496334[_0x29efc3(0x156)][_0x29efc3(0x141)]&&await this[_0x29efc3(0x15f)](_0x496334[_0x29efc3(0x156)],!![]),_0x496334['componentsToUpdate'][_0x29efc3(0x141)]&&await this[_0x29efc3(0x15f)](_0x496334['componentsToUpdate'],!![]),_0x496334[_0x29efc3(0x16e)][_0x29efc3(0x141)]&&await this['proceedRequests'](_0x496334['componentsToDelete'],!![]);}this['logger']['log']('Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x51a747[_0x29efc3(0x141)]);}}async['proceedCommitsToBranch'](_0x76577d){const _0x33ce4f=a270_0x456c07,_0x2b6288=[],_0x263a1b=[];for(const _0x5300fd of _0x76577d){if(!_0x5300fd[_0x33ce4f(0x14f)][_0x33ce4f(0x141)]&&!_0x5300fd['modified'][_0x33ce4f(0x141)]&&!_0x5300fd['removed'][_0x33ce4f(0x141)])continue;const _0x4f12ce=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x33ce4f(0x16b)][_0x33ce4f(0x173)],this[_0x33ce4f(0x16b)][_0x33ce4f(0x189)],_0x5300fd[_0x33ce4f(0x14d)],this[_0x33ce4f(0x16b)][_0x33ce4f(0x150)],[]);_0x2b6288[_0x33ce4f(0x154)](...await _0x4f12ce[_0x33ce4f(0x145)](_0x5300fd[_0x33ce4f(0x14f)])),_0x2b6288[_0x33ce4f(0x154)](...await _0x4f12ce[_0x33ce4f(0x171)](_0x5300fd['modified'])),_0x263a1b[_0x33ce4f(0x154)](await _0x4f12ce[_0x33ce4f(0x18a)](_0x5300fd[_0x33ce4f(0x184)]));}this[_0x33ce4f(0x155)][_0x33ce4f(0x181)](_0x33ce4f(0x188),_0x2b6288['length']),await this['proceedRequests'](_0x2b6288);const _0x5643df=_0x263a1b['reduce']((_0x3f05be,_0x32ebc3)=>({'manifests':[..._0x3f05be[_0x33ce4f(0x156)],..._0x32ebc3['manifests']],'componentsToDelete':[..._0x3f05be[_0x33ce4f(0x16e)],..._0x32ebc3['componentsToDelete']],'componentsToUpdate':[..._0x3f05be['componentsToUpdate'],..._0x32ebc3['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x5643df[_0x33ce4f(0x156)][_0x33ce4f(0x141)]&&await this[_0x33ce4f(0x15f)](_0x5643df[_0x33ce4f(0x156)],!![]),_0x5643df[_0x33ce4f(0x151)][_0x33ce4f(0x141)]&&await this[_0x33ce4f(0x15f)](_0x5643df['componentsToUpdate'],!![]),_0x5643df[_0x33ce4f(0x16e)][_0x33ce4f(0x141)]&&await this['proceedRequests'](_0x5643df[_0x33ce4f(0x16e)],!![]);}async[a270_0x456c07(0x162)](_0x17ba3d){const _0x163f6a=a270_0x456c07;this[_0x163f6a(0x16b)][_0x163f6a(0x189)]?await this[_0x163f6a(0x15d)](_0x17ba3d):await this[_0x163f6a(0x180)](_0x17ba3d);}}exports[a270_0x456c07(0x15e)]=SalesforceCommitsManager;