const a194_0x159daa=a194_0x17a3;(function(_0x10c3de,_0x41be88){const _0x47a0cb=a194_0x17a3,_0x4b97ed=_0x10c3de();while(!![]){try{const _0x36a5d2=-parseInt(_0x47a0cb(0xb6))/0x1*(-parseInt(_0x47a0cb(0x92))/0x2)+parseInt(_0x47a0cb(0xa0))/0x3+parseInt(_0x47a0cb(0xae))/0x4+-parseInt(_0x47a0cb(0xa3))/0x5+-parseInt(_0x47a0cb(0xbf))/0x6+parseInt(_0x47a0cb(0x8d))/0x7*(-parseInt(_0x47a0cb(0xb1))/0x8)+parseInt(_0x47a0cb(0xab))/0x9;if(_0x36a5d2===_0x41be88)break;else _0x4b97ed['push'](_0x4b97ed['shift']());}catch(_0x2abcb5){_0x4b97ed['push'](_0x4b97ed['shift']());}}}(a194_0x3325,0x3ba4d));const a194_0x3fb60c=(function(){let _0x532762=!![];return function(_0x15b534,_0x376042){const _0x4b54ea=_0x532762?function(){const _0x93bbaf=a194_0x17a3;if(_0x376042){const _0xbe85a2=_0x376042[_0x93bbaf(0xa5)](_0x15b534,arguments);return _0x376042=null,_0xbe85a2;}}:function(){};return _0x532762=![],_0x4b54ea;};}()),a194_0x503162=a194_0x3fb60c(this,function(){const _0x4a4f89=a194_0x17a3;return a194_0x503162[_0x4a4f89(0x90)]()['search'](_0x4a4f89(0xb0))[_0x4a4f89(0x90)]()[_0x4a4f89(0x9a)](a194_0x503162)[_0x4a4f89(0xc2)](_0x4a4f89(0xb0));});a194_0x503162();'use strict';var __importDefault=this&&this[a194_0x159daa(0xb9)]||function(_0x491756){return _0x491756&&_0x491756['__esModule']?_0x491756:{'default':_0x491756};};Object[a194_0x159daa(0x99)](exports,a194_0x159daa(0xaf),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;function a194_0x3325(){const _0x38319b=['insert','proceedCommitsToRepository','search','find','componentsToUpdate','reduce','delete','length','SalesforceError','COMPONENTS_PER_CHUNK','composite','stringify','splice','reference','commitId','typedi','../../../../core','2345KiGYeI','recordTypes','logger','toString','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','14ApJKgD','../../../../constants','../errors/salesforce.error','options','branchId','componentId','executeGraphs','defineProperty','constructor','sfLogger','modified','inserted','proceedCommitsToBranch','extractComponentIdsFromGraphsResponse','660534asshTt','proceedRequests','repositoryId','556355EJbxpB','floor','apply','./salesforce-composite.service','componentsToDelete','SalesforceCompositeService','default','log','1358226LWtPFv','\x20requests\x20to\x20composite\x20api.','toJSON','1015804KalQoA','__esModule','(((.+)+)+)+$','7880VFrIWK','Sending\x20','removed','get','getProceededComponentsMeta','50311nsbSJG','update','SalesforceComponentsManager','__importDefault','proceededComponentsMeta','push','author','graph','manifests','1750038rwpWMo'];a194_0x3325=function(){return _0x38319b;};return a194_0x3325();}function a194_0x17a3(_0x392460,_0xd0fa5a){const _0x273458=a194_0x3325();return a194_0x17a3=function(_0x503162,_0x3fb60c){_0x503162=_0x503162-0x7f;let _0x33256a=_0x273458[_0x503162];return _0x33256a;},a194_0x17a3(_0x392460,_0xd0fa5a);}const core_1=require(a194_0x159daa(0x8c)),typedi_1=__importDefault(require(a194_0x159daa(0x8b))),constants_1=require(a194_0x159daa(0x93)),utils_1=require('../../../shared/utils'),salesforce_error_1=require(a194_0x159daa(0x94)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a194_0x159daa(0xa6));class SalesforceCommitsManager{constructor(_0x2ee4d8){const _0x4ddd3b=a194_0x159daa;this[_0x4ddd3b(0x95)]=_0x2ee4d8,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x4ddd3b(0x8f)]=new core_1['Logger'](SalesforceCommitsManager['name']),this[_0x4ddd3b(0x9b)]=this['options']['logger'],this[_0x4ddd3b(0x86)]=typedi_1[_0x4ddd3b(0xa9)][_0x4ddd3b(0xb4)](salesforce_composite_service_1[_0x4ddd3b(0xa8)]),this[_0x4ddd3b(0xba)]=[];}async[a194_0x159daa(0xa1)](_0x551846,_0x2d184d=![]){const _0x4f40e2=a194_0x159daa,_0x43e4d3=(this[_0x4f40e2(0x85)]+ +_0x2d184d)*0x3,_0x11129d=(0x0,utils_1['chunkArray'])(_0x551846,_0x43e4d3);try{while(_0x11129d[_0x4f40e2(0x83)]){const _0xa6e9f7=_0x11129d[_0x4f40e2(0x88)](0x0,Math[_0x4f40e2(0xa4)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x43e4d3));await this['logger'][_0x4f40e2(0xaa)](_0x4f40e2(0xb2)+_0xa6e9f7['length']*_0x43e4d3+_0x4f40e2(0xac));const _0x392fc8=_0xa6e9f7['map']((_0x413adc,_0x51734f)=>({'graphId':_0x4f40e2(0xbd)+_0x51734f,'compositeRequest':_0x413adc})),_0x2ed0c6=await this[_0x4f40e2(0x86)][_0x4f40e2(0x98)](_0x392fc8);if(_0x2d184d){const _0x3c2162=(0x0,composite_utils_1[_0x4f40e2(0x9f)])(_0x2ed0c6);for(const {id:_0x54ecc3,ref:_0x4be726}of _0x3c2162){const _0x3f7681=this[_0x4f40e2(0xba)][_0x4f40e2(0x7f)](_0x5438e9=>_0x5438e9[_0x4f40e2(0x89)]===_0x4be726);_0x3f7681&&(_0x3f7681[_0x4f40e2(0x97)]=_0x54ecc3);}}}}catch(_0x3af4cb){this[_0x4f40e2(0x8f)]['error'](_0x3af4cb instanceof salesforce_error_1['SalesforceError']?JSON[_0x4f40e2(0x87)](_0x3af4cb[_0x4f40e2(0xad)](),null,0x2):_0x3af4cb),this['sfLogger'][_0x4f40e2(0xaa)](_0x3af4cb instanceof salesforce_error_1[_0x4f40e2(0x84)]?JSON['stringify'](_0x3af4cb['toJSON'](),null,0x2):_0x3af4cb[_0x4f40e2(0x90)]());throw _0x3af4cb;}}async[a194_0x159daa(0xc1)](_0x244339){const _0x4ffd39=a194_0x159daa;for(const _0x476218 of _0x244339){if(!_0x476218[_0x4ffd39(0x9d)]['length']&&!_0x476218['modified'][_0x4ffd39(0x83)]&&!_0x476218[_0x4ffd39(0xb3)][_0x4ffd39(0x83)])continue;const _0x40615c=[],_0x5397a5=[],_0x24188f=new salesforce_components_manager_service_1[(_0x4ffd39(0xb8))](this[_0x4ffd39(0x95)]['repositoryId'],this[_0x4ffd39(0x95)][_0x4ffd39(0x96)],_0x476218[_0x4ffd39(0xbc)],this[_0x4ffd39(0x95)]['recordTypes'],this[_0x4ffd39(0xba)]);_0x40615c[_0x4ffd39(0xbb)](...await _0x24188f[_0x4ffd39(0xc0)](_0x476218[_0x4ffd39(0x9d)],this[_0x4ffd39(0x95)][_0x4ffd39(0x8a)])),_0x40615c[_0x4ffd39(0xbb)](...await _0x24188f[_0x4ffd39(0xb7)](_0x476218[_0x4ffd39(0x9c)],this[_0x4ffd39(0x95)][_0x4ffd39(0x8a)])),_0x5397a5[_0x4ffd39(0xbb)](await _0x24188f[_0x4ffd39(0x82)](_0x476218[_0x4ffd39(0xb3)],!![])),this[_0x4ffd39(0xba)]=_0x24188f[_0x4ffd39(0xb5)](),await this['proceedRequests'](_0x40615c,!![]);for(const _0x2d2fd5 of _0x5397a5){_0x2d2fd5[_0x4ffd39(0xbe)][_0x4ffd39(0x83)]&&await this['proceedRequests'](_0x2d2fd5[_0x4ffd39(0xbe)],!![]),_0x2d2fd5[_0x4ffd39(0x80)][_0x4ffd39(0x83)]&&await this[_0x4ffd39(0xa1)](_0x2d2fd5[_0x4ffd39(0x80)],!![]),_0x2d2fd5[_0x4ffd39(0xa7)][_0x4ffd39(0x83)]&&await this[_0x4ffd39(0xa1)](_0x2d2fd5['componentsToDelete'],!![]);}this[_0x4ffd39(0x8f)][_0x4ffd39(0xaa)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x40615c['length']);}}async[a194_0x159daa(0x9e)](_0x5557b2){const _0x50526b=a194_0x159daa,_0x1c2dda=[],_0x3a721c=[];for(const _0x22671c of _0x5557b2){if(!_0x22671c[_0x50526b(0x9d)][_0x50526b(0x83)]&&!_0x22671c[_0x50526b(0x9c)]['length']&&!_0x22671c[_0x50526b(0xb3)][_0x50526b(0x83)])continue;const _0x3eaa16=new salesforce_components_manager_service_1[(_0x50526b(0xb8))](this[_0x50526b(0x95)][_0x50526b(0xa2)],this[_0x50526b(0x95)]['branchId'],_0x22671c[_0x50526b(0xbc)],this[_0x50526b(0x95)][_0x50526b(0x8e)],[]);_0x1c2dda['push'](...await _0x3eaa16[_0x50526b(0xc0)](_0x22671c['inserted'])),_0x1c2dda[_0x50526b(0xbb)](...await _0x3eaa16[_0x50526b(0xb7)](_0x22671c['modified'])),_0x3a721c[_0x50526b(0xbb)](await _0x3eaa16[_0x50526b(0x82)](_0x22671c['removed']));}this['logger'][_0x50526b(0xaa)](_0x50526b(0x91),_0x1c2dda[_0x50526b(0x83)]),await this[_0x50526b(0xa1)](_0x1c2dda);const _0x16690d=_0x3a721c[_0x50526b(0x81)]((_0x3ae507,_0x18fa58)=>({'manifests':[..._0x3ae507[_0x50526b(0xbe)],..._0x18fa58[_0x50526b(0xbe)]],'componentsToDelete':[..._0x3ae507[_0x50526b(0xa7)],..._0x18fa58[_0x50526b(0xa7)]],'componentsToUpdate':[..._0x3ae507[_0x50526b(0x80)],..._0x18fa58[_0x50526b(0x80)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x16690d['manifests'][_0x50526b(0x83)]&&await this[_0x50526b(0xa1)](_0x16690d[_0x50526b(0xbe)],!![]),_0x16690d['componentsToUpdate'][_0x50526b(0x83)]&&await this[_0x50526b(0xa1)](_0x16690d[_0x50526b(0x80)],!![]),_0x16690d['componentsToDelete']['length']&&await this[_0x50526b(0xa1)](_0x16690d[_0x50526b(0xa7)],!![]);}async['proceedCommits'](_0x174cd8){const _0x5b5a92=a194_0x159daa;this['options'][_0x5b5a92(0x96)]?await this[_0x5b5a92(0x9e)](_0x174cd8):await this['proceedCommitsToRepository'](_0x174cd8);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;