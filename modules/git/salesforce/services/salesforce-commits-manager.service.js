const a272_0x4fb002=a272_0x3ea5;function a272_0x3ea5(_0x26a68e,_0x88388d){const _0x2baf12=a272_0x257a();return a272_0x3ea5=function(_0x449155,_0x18468a){_0x449155=_0x449155-0x1b6;let _0x257ab1=_0x2baf12[_0x449155];return _0x257ab1;},a272_0x3ea5(_0x26a68e,_0x88388d);}function a272_0x257a(){const _0x59d887=['SalesforceCommitsManager','log','commitId','SALESFORCE_MAX_REQUEST_SIZE_BYTES','Logger','recordTypes','3744XTFeKp','reference','proceededComponentsMeta','chunkArray','reduce','Sending\x20','../errors/salesforce.error','search','delete','1119ICJZDU','getProceededComponentsMeta','typedi','../utils/composite.utils','error','modified','9668tEMARa','default','composite','SalesforceComponentsManager','../../../../core','constructor','length','COMPONENTS_PER_CHUNK','removed','proceedChunksToUpload','__importDefault','../../../shared/utils','70081FkDMxm','manifests','6099688iwKVkH','branchId','splice','toString','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','4014gCPlUH','__esModule','2210610bzrmPp','SalesforceError','(((.+)+)+)+$','\x20requests\x20to\x20composite\x20api.','map','repositoryId','insert','2VTNmjV','proceedCommitsToRepository','20saFMqQ','./salesforce-composite.service','push','proceedCommitsToBranch','632998uRIirk','componentsToDelete','get','2111557NGoFGi','../../../../constants','proceedCommits','proceedRequests','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','defineProperty','floor','sfLogger','toJSON','stringify','author','options','executeGraphs','inserted','\x20COMPONENTS_SIZE\x20=\x20','find','componentsToUpdate','graph','logger','13610iZjhaP'];a272_0x257a=function(){return _0x59d887;};return a272_0x257a();}(function(_0x3ca8f3,_0x1d8821){const _0x524576=a272_0x3ea5,_0x1b60db=_0x3ca8f3();while(!![]){try{const _0x5e067a=parseInt(_0x524576(0x1bf))/0x1*(-parseInt(_0x524576(0x1c5))/0x2)+-parseInt(_0x524576(0x1eb))/0x3*(parseInt(_0x524576(0x1f1))/0x4)+-parseInt(_0x524576(0x1c1))/0x5*(-parseInt(_0x524576(0x1b8))/0x6)+parseInt(_0x524576(0x1c8))/0x7+-parseInt(_0x524576(0x1ff))/0x8+parseInt(_0x524576(0x1b6))/0x9*(-parseInt(_0x524576(0x1db))/0xa)+parseInt(_0x524576(0x1fd))/0xb*(parseInt(_0x524576(0x1e2))/0xc);if(_0x5e067a===_0x1d8821)break;else _0x1b60db['push'](_0x1b60db['shift']());}catch(_0xa7a252){_0x1b60db['push'](_0x1b60db['shift']());}}}(a272_0x257a,0xd1c01));const a272_0x18468a=(function(){let _0x3d87ff=!![];return function(_0x627fee,_0x3feb18){const _0x18bcfb=_0x3d87ff?function(){if(_0x3feb18){const _0x1d3f9e=_0x3feb18['apply'](_0x627fee,arguments);return _0x3feb18=null,_0x1d3f9e;}}:function(){};return _0x3d87ff=![],_0x18bcfb;};}()),a272_0x449155=a272_0x18468a(this,function(){const _0xd37737=a272_0x3ea5;return a272_0x449155[_0xd37737(0x202)]()[_0xd37737(0x1e9)](_0xd37737(0x1ba))[_0xd37737(0x202)]()[_0xd37737(0x1f6)](a272_0x449155)[_0xd37737(0x1e9)](_0xd37737(0x1ba));});a272_0x449155();'use strict';var __importDefault=this&&this[a272_0x4fb002(0x1fb)]||function(_0x1245d3){const _0x1d9328=a272_0x4fb002;return _0x1245d3&&_0x1245d3[_0x1d9328(0x1b7)]?_0x1245d3:{'default':_0x1245d3};};Object[a272_0x4fb002(0x1cd)](exports,a272_0x4fb002(0x1b7),{'value':!![]}),exports[a272_0x4fb002(0x1dc)]=void 0x0;const core_1=require(a272_0x4fb002(0x1f5)),typedi_1=__importDefault(require(a272_0x4fb002(0x1ed))),constants_1=require(a272_0x4fb002(0x1c9)),utils_1=require(a272_0x4fb002(0x1fc)),salesforce_error_1=require(a272_0x4fb002(0x1e8)),composite_utils_1=require(a272_0x4fb002(0x1ee)),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a272_0x4fb002(0x1c2));class SalesforceCommitsManager{constructor(_0x44ef35){const _0x2b7380=a272_0x4fb002;this[_0x2b7380(0x1d3)]=_0x44ef35,this[_0x2b7380(0x1f8)]=0x3,this[_0x2b7380(0x1da)]=new core_1[(_0x2b7380(0x1e0))](SalesforceCommitsManager['name']),this['sfLogger']=this[_0x2b7380(0x1d3)][_0x2b7380(0x1da)],this[_0x2b7380(0x1f3)]=typedi_1[_0x2b7380(0x1f2)][_0x2b7380(0x1c7)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x2b7380(0x1e4)]=[];}async[a272_0x4fb002(0x1fa)](_0x40b44b,_0x2d3b69=![]){const _0x4485af=a272_0x4fb002,_0x257b00=async _0x2a6ab5=>{const _0x19633d=a272_0x3ea5;await this['logger'][_0x19633d(0x1dd)](_0x19633d(0x1e7)+_0x2a6ab5[_0x19633d(0x1e6)]((_0x52e25b,_0x501207)=>_0x52e25b+_0x501207[_0x19633d(0x1f7)],0x0)+_0x19633d(0x1bb));const _0x133d12=_0x2a6ab5[_0x19633d(0x1bc)]((_0x85c525,_0x42a041)=>({'graphId':_0x19633d(0x1d9)+_0x42a041,'compositeRequest':_0x85c525})),_0xecf084=await this['composite'][_0x19633d(0x1d4)](_0x133d12);if(_0x2d3b69){const _0x57f45c=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0xecf084);for(const {id:_0x4b87a6,ref:_0x18fda1}of _0x57f45c){const _0x3b0a24=this['proceededComponentsMeta'][_0x19633d(0x1d7)](_0x15ea81=>_0x15ea81[_0x19633d(0x1e3)]===_0x18fda1);_0x3b0a24&&(_0x3b0a24['componentId']=_0x4b87a6);}}},_0x3018bc=0x1e8480;let _0x70f899=0x0,_0x4b02dd=[];for(const _0x294945 of _0x40b44b){const _0x513cef=_0x294945[_0x4485af(0x1e6)]((_0x5511a6,_0x5057d2)=>{const _0x1e5f63=_0x4485af,_0x4524af=JSON[_0x1e5f63(0x1d1)](_0x5057d2)['length']*0x2;return _0x5511a6+_0x4524af;},0x0);if(_0x513cef>constants_1[_0x4485af(0x1df)])throw new salesforce_error_1[(_0x4485af(0x1b9))](_0x4485af(0x203)+constants_1[_0x4485af(0x1df)]+_0x4485af(0x1d6)+_0x513cef);_0x70f899+_0x513cef>constants_1[_0x4485af(0x1df)]-_0x3018bc&&(await _0x257b00(_0x4b02dd),_0x4b02dd=[],_0x70f899=0x0),_0x70f899+=_0x513cef,_0x4b02dd[_0x4485af(0x1c3)](_0x294945);}_0x4b02dd['length']&&await _0x257b00(_0x4b02dd);}async[a272_0x4fb002(0x1cb)](_0x3400c0,_0x106cd5=![]){const _0x22d37c=a272_0x4fb002,_0x307d57=(this[_0x22d37c(0x1f8)]+ +_0x106cd5)*0x3,_0x3340da=(0x0,utils_1[_0x22d37c(0x1e5)])(_0x3400c0,_0x307d57);try{while(_0x3340da[_0x22d37c(0x1f7)]){const _0x27bd93=_0x3340da[_0x22d37c(0x201)](0x0,Math[_0x22d37c(0x1ce)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x307d57));await this[_0x22d37c(0x1fa)](_0x27bd93,_0x106cd5);}}catch(_0xe4bf74){this[_0x22d37c(0x1da)][_0x22d37c(0x1ef)](_0xe4bf74 instanceof salesforce_error_1[_0x22d37c(0x1b9)]?JSON[_0x22d37c(0x1d1)](_0xe4bf74[_0x22d37c(0x1d0)](),null,0x2):_0xe4bf74),this[_0x22d37c(0x1cf)]['log'](_0xe4bf74 instanceof salesforce_error_1[_0x22d37c(0x1b9)]?JSON[_0x22d37c(0x1d1)](_0xe4bf74[_0x22d37c(0x1d0)](),null,0x2):_0xe4bf74[_0x22d37c(0x202)]());throw _0xe4bf74;}}async[a272_0x4fb002(0x1c0)](_0x4ccb13){const _0xfc873=a272_0x4fb002;for(const _0x17b8fd of _0x4ccb13){if(!_0x17b8fd['inserted'][_0xfc873(0x1f7)]&&!_0x17b8fd['modified'][_0xfc873(0x1f7)]&&!_0x17b8fd[_0xfc873(0x1f9)][_0xfc873(0x1f7)])continue;const _0x5ad106=[],_0x584fe0=[],_0x33ab12=new salesforce_components_manager_service_1[(_0xfc873(0x1f4))](this[_0xfc873(0x1d3)]['repositoryId'],this[_0xfc873(0x1d3)][_0xfc873(0x200)],_0x17b8fd[_0xfc873(0x1d2)],this[_0xfc873(0x1d3)][_0xfc873(0x1e1)],this[_0xfc873(0x1e4)]);_0x5ad106[_0xfc873(0x1c3)](...await _0x33ab12[_0xfc873(0x1be)](_0x17b8fd[_0xfc873(0x1d5)],this[_0xfc873(0x1d3)][_0xfc873(0x1de)])),_0x5ad106[_0xfc873(0x1c3)](...await _0x33ab12['update'](_0x17b8fd[_0xfc873(0x1f0)],this[_0xfc873(0x1d3)][_0xfc873(0x1de)])),_0x584fe0[_0xfc873(0x1c3)](await _0x33ab12[_0xfc873(0x1ea)](_0x17b8fd[_0xfc873(0x1f9)],!![])),this[_0xfc873(0x1e4)]=_0x33ab12[_0xfc873(0x1ec)](),await this['proceedRequests'](_0x5ad106,!![]);for(const _0x22b026 of _0x584fe0){_0x22b026[_0xfc873(0x1fe)]['length']&&await this[_0xfc873(0x1cb)](_0x22b026[_0xfc873(0x1fe)],!![]),_0x22b026[_0xfc873(0x1d8)][_0xfc873(0x1f7)]&&await this[_0xfc873(0x1cb)](_0x22b026[_0xfc873(0x1d8)],!![]),_0x22b026[_0xfc873(0x1c6)][_0xfc873(0x1f7)]&&await this[_0xfc873(0x1cb)](_0x22b026['componentsToDelete'],!![]);}this['logger'][_0xfc873(0x1dd)](_0xfc873(0x204),_0x5ad106[_0xfc873(0x1f7)]);}}async[a272_0x4fb002(0x1c4)](_0x501c98){const _0x54d92c=a272_0x4fb002,_0x17563b=[],_0x2ffc83=[];for(const _0x2514ba of _0x501c98){if(!_0x2514ba[_0x54d92c(0x1d5)][_0x54d92c(0x1f7)]&&!_0x2514ba[_0x54d92c(0x1f0)][_0x54d92c(0x1f7)]&&!_0x2514ba[_0x54d92c(0x1f9)]['length'])continue;const _0x24d498=new salesforce_components_manager_service_1[(_0x54d92c(0x1f4))](this['options'][_0x54d92c(0x1bd)],this[_0x54d92c(0x1d3)][_0x54d92c(0x200)],_0x2514ba['author'],this[_0x54d92c(0x1d3)][_0x54d92c(0x1e1)],[]);_0x17563b[_0x54d92c(0x1c3)](...await _0x24d498['insert'](_0x2514ba[_0x54d92c(0x1d5)])),_0x17563b[_0x54d92c(0x1c3)](...await _0x24d498['update'](_0x2514ba['modified'])),_0x2ffc83['push'](await _0x24d498[_0x54d92c(0x1ea)](_0x2514ba[_0x54d92c(0x1f9)]));}this[_0x54d92c(0x1da)][_0x54d92c(0x1dd)](_0x54d92c(0x1cc),_0x17563b[_0x54d92c(0x1f7)]),await this[_0x54d92c(0x1cb)](_0x17563b);const _0x813e20=_0x2ffc83[_0x54d92c(0x1e6)]((_0x4f3386,_0x595b5e)=>({'manifests':[..._0x4f3386[_0x54d92c(0x1fe)],..._0x595b5e[_0x54d92c(0x1fe)]],'componentsToDelete':[..._0x4f3386[_0x54d92c(0x1c6)],..._0x595b5e[_0x54d92c(0x1c6)]],'componentsToUpdate':[..._0x4f3386[_0x54d92c(0x1d8)],..._0x595b5e[_0x54d92c(0x1d8)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x813e20[_0x54d92c(0x1fe)]['length']&&await this[_0x54d92c(0x1cb)](_0x813e20[_0x54d92c(0x1fe)],!![]),_0x813e20[_0x54d92c(0x1d8)][_0x54d92c(0x1f7)]&&await this[_0x54d92c(0x1cb)](_0x813e20[_0x54d92c(0x1d8)],!![]),_0x813e20[_0x54d92c(0x1c6)][_0x54d92c(0x1f7)]&&await this[_0x54d92c(0x1cb)](_0x813e20[_0x54d92c(0x1c6)],!![]);}async[a272_0x4fb002(0x1ca)](_0x178850){const _0x55ca39=a272_0x4fb002;this[_0x55ca39(0x1d3)][_0x55ca39(0x200)]?await this[_0x55ca39(0x1c4)](_0x178850):await this[_0x55ca39(0x1c0)](_0x178850);}}exports[a272_0x4fb002(0x1dc)]=SalesforceCommitsManager;