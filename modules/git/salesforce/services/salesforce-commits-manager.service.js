function a272_0x119a(){const _0x11a4ed=['(((.+)+)+)+$','../../../shared/utils','proceedCommitsToRepository','proceedCommitsToBranch','apply','floor','proceededComponentsMeta','repositoryId','COMPONENTS_PER_CHUNK','find','proceedRequests','../../../../constants','SalesforceCommitsManager','constructor','845960axuGpp','SalesforceComponentsManager','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','66142wwfSwG','typedi','executeGraphs','proceedCommits','log','composite','353470TXRoyP','767943wfbsCI','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','author','push','inserted','removed','splice','getProceededComponentsMeta','name','componentsToDelete','stringify','graph','40tflYit','length','modified','__esModule','toString','delete','SalesforceError','12943cDnNWr','1050XmJalT','branchId','default','search','./salesforce-components-manager.service','commitId','update','../../../../core','componentsToUpdate','recordTypes','58524jMluSJ','manifests','get','map','__importDefault','SalesforceCompositeService','componentId','761096IXYixn','SALESFORCE_MAX_REQUEST_SIZE_BYTES','reduce','extractComponentIdsFromGraphsResponse','proceedChunksToUpload','reference','sfLogger','1PjCpdV','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','error','\x20COMPONENTS_SIZE\x20=\x20','logger','options'];a272_0x119a=function(){return _0x11a4ed;};return a272_0x119a();}const a272_0x5d88f5=a272_0x7b7f;function a272_0x7b7f(_0x511f0b,_0x753486){const _0x1b72f5=a272_0x119a();return a272_0x7b7f=function(_0x4c45bd,_0x31564e){_0x4c45bd=_0x4c45bd-0x176;let _0x119ac6=_0x1b72f5[_0x4c45bd];return _0x119ac6;},a272_0x7b7f(_0x511f0b,_0x753486);}(function(_0x56287d,_0x17fa27){const _0xf79496=a272_0x7b7f,_0x5e97fb=_0x56287d();while(!![]){try{const _0x592e2f=-parseInt(_0xf79496(0x1b4))/0x1*(-parseInt(_0xf79496(0x181))/0x2)+-parseInt(_0xf79496(0x1a6))/0x3*(parseInt(_0xf79496(0x194))/0x4)+-parseInt(_0xf79496(0x17e))/0x5+-parseInt(_0xf79496(0x19c))/0x6*(-parseInt(_0xf79496(0x19b))/0x7)+parseInt(_0xf79496(0x1ad))/0x8+parseInt(_0xf79496(0x188))/0x9+parseInt(_0xf79496(0x187))/0xa;if(_0x592e2f===_0x17fa27)break;else _0x5e97fb['push'](_0x5e97fb['shift']());}catch(_0x29a77f){_0x5e97fb['push'](_0x5e97fb['shift']());}}}(a272_0x119a,0x32d39));const a272_0x31564e=(function(){let _0x3bab26=!![];return function(_0x55773e,_0x2329c6){const _0x56708e=_0x3bab26?function(){const _0x3801c8=a272_0x7b7f;if(_0x2329c6){const _0x4fb2f0=_0x2329c6[_0x3801c8(0x1be)](_0x55773e,arguments);return _0x2329c6=null,_0x4fb2f0;}}:function(){};return _0x3bab26=![],_0x56708e;};}()),a272_0x4c45bd=a272_0x31564e(this,function(){const _0x4e90ad=a272_0x7b7f;return a272_0x4c45bd[_0x4e90ad(0x198)]()[_0x4e90ad(0x19f)]('(((.+)+)+)+$')[_0x4e90ad(0x198)]()[_0x4e90ad(0x17d)](a272_0x4c45bd)[_0x4e90ad(0x19f)](_0x4e90ad(0x1ba));});a272_0x4c45bd();'use strict';var __importDefault=this&&this[a272_0x5d88f5(0x1aa)]||function(_0x9f53f8){const _0x44454c=a272_0x5d88f5;return _0x9f53f8&&_0x9f53f8[_0x44454c(0x197)]?_0x9f53f8:{'default':_0x9f53f8};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a272_0x5d88f5(0x17c)]=void 0x0;const core_1=require(a272_0x5d88f5(0x1a3)),typedi_1=__importDefault(require(a272_0x5d88f5(0x182))),constants_1=require(a272_0x5d88f5(0x17b)),utils_1=require(a272_0x5d88f5(0x1bb)),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a272_0x5d88f5(0x1a0)),salesforce_composite_service_1=require('./salesforce-composite.service');class SalesforceCommitsManager{constructor(_0x1450b9){const _0x4cec7b=a272_0x5d88f5;this['options']=_0x1450b9,this[_0x4cec7b(0x178)]=0x3,this[_0x4cec7b(0x1b8)]=new core_1['Logger'](SalesforceCommitsManager[_0x4cec7b(0x190)]),this[_0x4cec7b(0x1b3)]=this[_0x4cec7b(0x1b9)][_0x4cec7b(0x1b8)],this[_0x4cec7b(0x186)]=typedi_1[_0x4cec7b(0x19e)][_0x4cec7b(0x1a8)](salesforce_composite_service_1[_0x4cec7b(0x1ab)]),this[_0x4cec7b(0x176)]=[];}async[a272_0x5d88f5(0x1b1)](_0x39053c,_0x4242bd=![]){const _0x44df21=a272_0x5d88f5,_0x246085=async _0xfae6b5=>{const _0x45e152=a272_0x7b7f;await this[_0x45e152(0x1b8)][_0x45e152(0x185)]('Sending\x20'+_0xfae6b5['reduce']((_0xb812e7,_0x4a36cc)=>_0xb812e7+_0x4a36cc[_0x45e152(0x195)],0x0)+'\x20requests\x20to\x20composite\x20api.');const _0x1c7398=_0xfae6b5[_0x45e152(0x1a9)]((_0x152714,_0x52fd98)=>({'graphId':_0x45e152(0x193)+_0x52fd98,'compositeRequest':_0x152714})),_0x516b0c=await this['composite'][_0x45e152(0x183)](_0x1c7398);if(_0x4242bd){const _0xfcd8a1=(0x0,composite_utils_1[_0x45e152(0x1b0)])(_0x516b0c);for(const {id:_0x9d1415,ref:_0x109149}of _0xfcd8a1){const _0x8c0a0e=this[_0x45e152(0x176)][_0x45e152(0x179)](_0x4f1e42=>_0x4f1e42[_0x45e152(0x1b2)]===_0x109149);_0x8c0a0e&&(_0x8c0a0e[_0x45e152(0x1ac)]=_0x9d1415);}}},_0x342d01=0x1e8480;let _0x2bc45f=0x0,_0x66dfb9=[];for(const _0x192287 of _0x39053c){const _0x1665ac=_0x192287[_0x44df21(0x1af)]((_0x145845,_0x4d315b)=>{const _0x341138=_0x44df21,_0x2ea720=JSON[_0x341138(0x192)](_0x4d315b)['length']*0x2;return _0x145845+_0x2ea720;},0x0);if(_0x1665ac>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1[(_0x44df21(0x19a))](_0x44df21(0x1b5)+constants_1[_0x44df21(0x1ae)]+_0x44df21(0x1b7)+_0x1665ac);_0x2bc45f+_0x1665ac>constants_1[_0x44df21(0x1ae)]-_0x342d01&&(await _0x246085(_0x66dfb9),_0x66dfb9=[],_0x2bc45f=0x0),_0x2bc45f+=_0x1665ac,_0x66dfb9[_0x44df21(0x18b)](_0x192287);}_0x66dfb9[_0x44df21(0x195)]&&await _0x246085(_0x66dfb9);}async[a272_0x5d88f5(0x17a)](_0x56f8ae,_0x2210ff=![]){const _0x2282a6=a272_0x5d88f5,_0x103caf=(this['COMPONENTS_PER_CHUNK']+ +_0x2210ff)*0x3,_0x539c5a=(0x0,utils_1['chunkArray'])(_0x56f8ae,_0x103caf);try{while(_0x539c5a['length']){const _0x29664f=_0x539c5a[_0x2282a6(0x18e)](0x0,Math[_0x2282a6(0x1bf)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x103caf));await this['proceedChunksToUpload'](_0x29664f,_0x2210ff);}}catch(_0x33d000){this[_0x2282a6(0x1b8)][_0x2282a6(0x1b6)](_0x33d000 instanceof salesforce_error_1[_0x2282a6(0x19a)]?JSON[_0x2282a6(0x192)](_0x33d000['toJSON'](),null,0x2):_0x33d000),this[_0x2282a6(0x1b3)][_0x2282a6(0x185)](_0x33d000 instanceof salesforce_error_1['SalesforceError']?JSON[_0x2282a6(0x192)](_0x33d000['toJSON'](),null,0x2):_0x33d000[_0x2282a6(0x198)]());throw _0x33d000;}}async[a272_0x5d88f5(0x1bc)](_0x57ad9b){const _0x5d1156=a272_0x5d88f5;for(const _0x5397a0 of _0x57ad9b){if(!_0x5397a0[_0x5d1156(0x18c)][_0x5d1156(0x195)]&&!_0x5397a0['modified'][_0x5d1156(0x195)]&&!_0x5397a0['removed'][_0x5d1156(0x195)])continue;const _0x16e3a=[],_0x5ce0f6=[],_0x4ad3b4=new salesforce_components_manager_service_1[(_0x5d1156(0x17f))](this[_0x5d1156(0x1b9)][_0x5d1156(0x177)],this[_0x5d1156(0x1b9)][_0x5d1156(0x19d)],_0x5397a0['author'],this[_0x5d1156(0x1b9)][_0x5d1156(0x1a5)],this[_0x5d1156(0x176)]);_0x16e3a[_0x5d1156(0x18b)](...await _0x4ad3b4['insert'](_0x5397a0['inserted'],this['options']['commitId'])),_0x16e3a[_0x5d1156(0x18b)](...await _0x4ad3b4[_0x5d1156(0x1a2)](_0x5397a0[_0x5d1156(0x196)],this[_0x5d1156(0x1b9)][_0x5d1156(0x1a1)])),_0x5ce0f6[_0x5d1156(0x18b)](await _0x4ad3b4['delete'](_0x5397a0[_0x5d1156(0x18d)],!![])),this[_0x5d1156(0x176)]=_0x4ad3b4[_0x5d1156(0x18f)](),await this[_0x5d1156(0x17a)](_0x16e3a,!![]);for(const _0x3be871 of _0x5ce0f6){_0x3be871[_0x5d1156(0x1a7)][_0x5d1156(0x195)]&&await this[_0x5d1156(0x17a)](_0x3be871[_0x5d1156(0x1a7)],!![]),_0x3be871[_0x5d1156(0x1a4)][_0x5d1156(0x195)]&&await this[_0x5d1156(0x17a)](_0x3be871['componentsToUpdate'],!![]),_0x3be871[_0x5d1156(0x191)][_0x5d1156(0x195)]&&await this[_0x5d1156(0x17a)](_0x3be871[_0x5d1156(0x191)],!![]);}this[_0x5d1156(0x1b8)][_0x5d1156(0x185)](_0x5d1156(0x180),_0x16e3a[_0x5d1156(0x195)]);}}async[a272_0x5d88f5(0x1bd)](_0x4a3d18){const _0xef00ce=a272_0x5d88f5,_0x1b18d3=[],_0x139400=[];for(const _0x39d98d of _0x4a3d18){if(!_0x39d98d[_0xef00ce(0x18c)]['length']&&!_0x39d98d[_0xef00ce(0x196)]['length']&&!_0x39d98d[_0xef00ce(0x18d)]['length'])continue;const _0x52b3bb=new salesforce_components_manager_service_1[(_0xef00ce(0x17f))](this['options'][_0xef00ce(0x177)],this[_0xef00ce(0x1b9)][_0xef00ce(0x19d)],_0x39d98d[_0xef00ce(0x18a)],this['options']['recordTypes'],[]);_0x1b18d3['push'](...await _0x52b3bb['insert'](_0x39d98d[_0xef00ce(0x18c)])),_0x1b18d3[_0xef00ce(0x18b)](...await _0x52b3bb[_0xef00ce(0x1a2)](_0x39d98d[_0xef00ce(0x196)])),_0x139400[_0xef00ce(0x18b)](await _0x52b3bb[_0xef00ce(0x199)](_0x39d98d['removed']));}this['logger']['log'](_0xef00ce(0x189),_0x1b18d3['length']),await this[_0xef00ce(0x17a)](_0x1b18d3);const _0x31f25e=_0x139400[_0xef00ce(0x1af)]((_0x4288b6,_0x2c81ae)=>({'manifests':[..._0x4288b6['manifests'],..._0x2c81ae['manifests']],'componentsToDelete':[..._0x4288b6[_0xef00ce(0x191)],..._0x2c81ae['componentsToDelete']],'componentsToUpdate':[..._0x4288b6['componentsToUpdate'],..._0x2c81ae['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x31f25e[_0xef00ce(0x1a7)][_0xef00ce(0x195)]&&await this[_0xef00ce(0x17a)](_0x31f25e[_0xef00ce(0x1a7)],!![]),_0x31f25e[_0xef00ce(0x1a4)]['length']&&await this[_0xef00ce(0x17a)](_0x31f25e['componentsToUpdate'],!![]),_0x31f25e['componentsToDelete']['length']&&await this[_0xef00ce(0x17a)](_0x31f25e[_0xef00ce(0x191)],!![]);}async[a272_0x5d88f5(0x184)](_0x29f61d){const _0x4a08d0=a272_0x5d88f5;this[_0x4a08d0(0x1b9)]['branchId']?await this[_0x4a08d0(0x1bd)](_0x29f61d):await this['proceedCommitsToRepository'](_0x29f61d);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;