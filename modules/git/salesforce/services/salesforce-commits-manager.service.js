const a233_0x14c03c=a233_0x1e48;(function(_0x547d9b,_0x1cbc7b){const _0x2ca964=a233_0x1e48,_0x57e0ff=_0x547d9b();while(!![]){try{const _0x2565a3=parseInt(_0x2ca964(0xcc))/0x1*(-parseInt(_0x2ca964(0x9f))/0x2)+parseInt(_0x2ca964(0x89))/0x3*(parseInt(_0x2ca964(0x94))/0x4)+parseInt(_0x2ca964(0xbb))/0x5+parseInt(_0x2ca964(0xbd))/0x6+-parseInt(_0x2ca964(0x8e))/0x7*(parseInt(_0x2ca964(0xad))/0x8)+parseInt(_0x2ca964(0xbf))/0x9+-parseInt(_0x2ca964(0xb4))/0xa;if(_0x2565a3===_0x1cbc7b)break;else _0x57e0ff['push'](_0x57e0ff['shift']());}catch(_0x2e94e6){_0x57e0ff['push'](_0x57e0ff['shift']());}}}(a233_0x53a2,0x8e6c0));const a233_0x2c1438=(function(){let _0x5543dc=!![];return function(_0x32b418,_0x55049c){const _0x4e4628=_0x5543dc?function(){const _0x102c7a=a233_0x1e48;if(_0x55049c){const _0x19df3d=_0x55049c[_0x102c7a(0xaa)](_0x32b418,arguments);return _0x55049c=null,_0x19df3d;}}:function(){};return _0x5543dc=![],_0x4e4628;};}()),a233_0x1a7b6e=a233_0x2c1438(this,function(){const _0x126b42=a233_0x1e48;return a233_0x1a7b6e['toString']()[_0x126b42(0x92)]('(((.+)+)+)+$')[_0x126b42(0xa4)]()[_0x126b42(0xbc)](a233_0x1a7b6e)[_0x126b42(0x92)](_0x126b42(0x8a));});a233_0x1a7b6e();function a233_0x53a2(){const _0x207980=['8422580LxnlQL','map','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','recordTypes','SalesforceError','reduce','reference','4826685VsZHVT','constructor','3492816EpsYSY','proceedChunksToUpload','2625219sCoMbz','proceedCommitsToBranch','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','find','default','inserted','componentId','../utils/composite.utils','sfLogger','proceedCommitsToRepository','log','commitId','composite','347CdZrga','../../../../constants','componentsToUpdate','../../../shared/utils','proceedRequests','SalesforceComponentsManager','toJSON','name','93PBFaGO','(((.+)+)+)+$','error','manifests','removed','1127lMWfTN','extractComponentIdsFromGraphsResponse','splice','floor','search','push','73036SsKqjG','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','modified','executeGraphs','defineProperty','length','insert','getProceededComponentsMeta','repositoryId','update','chunkArray','1086ZWgKSX','proceededComponentsMeta','SALESFORCE_MAX_REQUEST_SIZE_BYTES','SalesforceCompositeService','typedi','toString','./salesforce-components-manager.service','COMPONENTS_PER_CHUNK','stringify','__esModule','componentsToDelete','apply','author','logger','39312dMjxaI','\x20COMPONENTS_SIZE\x20=\x20','proceedCommits','options','delete','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','branchId'];a233_0x53a2=function(){return _0x207980;};return a233_0x53a2();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x432e4c){const _0x352cc7=a233_0x1e48;return _0x432e4c&&_0x432e4c[_0x352cc7(0xa8)]?_0x432e4c:{'default':_0x432e4c};};Object[a233_0x14c03c(0x98)](exports,a233_0x14c03c(0xa8),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require(a233_0x14c03c(0xa3))),constants_1=require(a233_0x14c03c(0xcd)),utils_1=require(a233_0x14c03c(0xcf)),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a233_0x14c03c(0xc6)),salesforce_components_manager_service_1=require(a233_0x14c03c(0xa5)),salesforce_composite_service_1=require('./salesforce-composite.service');class SalesforceCommitsManager{constructor(_0x9f5cb4){const _0xac419a=a233_0x14c03c;this['options']=_0x9f5cb4,this[_0xac419a(0xa6)]=0x3,this[_0xac419a(0xac)]=new core_1['Logger'](SalesforceCommitsManager[_0xac419a(0xd3)]),this[_0xac419a(0xc7)]=this[_0xac419a(0xb0)][_0xac419a(0xac)],this[_0xac419a(0xcb)]=typedi_1[_0xac419a(0xc3)]['get'](salesforce_composite_service_1[_0xac419a(0xa2)]),this[_0xac419a(0xa0)]=[];}async[a233_0x14c03c(0xbe)](_0x518847,_0x593785=![]){const _0x2e173a=a233_0x14c03c,_0xd6e6a8=async _0x31efa1=>{const _0x15af11=a233_0x1e48;await this[_0x15af11(0xac)][_0x15af11(0xc9)]('Sending\x20'+_0x31efa1[_0x15af11(0xb9)]((_0x3370a8,_0x290329)=>_0x3370a8+_0x290329[_0x15af11(0x99)],0x0)+'\x20requests\x20to\x20composite\x20api.');const _0x1d724=_0x31efa1[_0x15af11(0xb5)]((_0xbe513,_0x649cd5)=>({'graphId':'graph'+_0x649cd5,'compositeRequest':_0xbe513})),_0x29913e=await this[_0x15af11(0xcb)][_0x15af11(0x97)](_0x1d724);if(_0x593785){const _0x55e5d3=(0x0,composite_utils_1[_0x15af11(0x8f)])(_0x29913e);for(const {id:_0x37e806,ref:_0x229c7a}of _0x55e5d3){const _0x17bca3=this[_0x15af11(0xa0)][_0x15af11(0xc2)](_0x58a41b=>_0x58a41b[_0x15af11(0xba)]===_0x229c7a);_0x17bca3&&(_0x17bca3[_0x15af11(0xc5)]=_0x37e806);}}},_0x1ea202=0x1e8480;let _0x889597=0x0,_0x52a040=[];for(const _0x39d7d6 of _0x518847){const _0x1b254e=_0x39d7d6[_0x2e173a(0xb9)]((_0x5ba218,_0x3d6112)=>{const _0x441fda=_0x2e173a,_0x3a7d3d=JSON[_0x441fda(0xa7)](_0x3d6112)['length']*0x2;return _0x5ba218+_0x3a7d3d;},0x0);if(_0x1b254e>constants_1[_0x2e173a(0xa1)])throw new salesforce_error_1[(_0x2e173a(0xb8))](_0x2e173a(0xc1)+constants_1[_0x2e173a(0xa1)]+_0x2e173a(0xae)+_0x1b254e);_0x889597+_0x1b254e>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x1ea202&&(await _0xd6e6a8(_0x52a040),_0x52a040=[],_0x889597=0x0),_0x889597+=_0x1b254e,_0x52a040[_0x2e173a(0x93)](_0x39d7d6);}_0x52a040['length']&&await _0xd6e6a8(_0x52a040);}async[a233_0x14c03c(0xd0)](_0x546f50,_0x55cf71=![]){const _0x2dc55e=a233_0x14c03c,_0x156de1=(this[_0x2dc55e(0xa6)]+ +_0x55cf71)*0x3,_0x1ef50d=(0x0,utils_1[_0x2dc55e(0x9e)])(_0x546f50,_0x156de1);try{while(_0x1ef50d[_0x2dc55e(0x99)]){const _0x562195=_0x1ef50d[_0x2dc55e(0x90)](0x0,Math[_0x2dc55e(0x91)](constants_1[_0x2dc55e(0xb6)]/_0x156de1));await this[_0x2dc55e(0xbe)](_0x562195,_0x55cf71);}}catch(_0x481365){this[_0x2dc55e(0xac)][_0x2dc55e(0x8b)](_0x481365 instanceof salesforce_error_1[_0x2dc55e(0xb8)]?JSON['stringify'](_0x481365['toJSON'](),null,0x2):_0x481365),this[_0x2dc55e(0xc7)][_0x2dc55e(0xc9)](_0x481365 instanceof salesforce_error_1[_0x2dc55e(0xb8)]?JSON[_0x2dc55e(0xa7)](_0x481365[_0x2dc55e(0xd2)](),null,0x2):_0x481365[_0x2dc55e(0xa4)]());throw _0x481365;}}async[a233_0x14c03c(0xc8)](_0x1ab008){const _0xe1fea7=a233_0x14c03c;for(const _0x2132a6 of _0x1ab008){if(!_0x2132a6[_0xe1fea7(0xc4)][_0xe1fea7(0x99)]&&!_0x2132a6[_0xe1fea7(0x96)][_0xe1fea7(0x99)]&&!_0x2132a6['removed'][_0xe1fea7(0x99)])continue;const _0x1b95d1=[],_0x5a9ee1=[],_0x46793a=new salesforce_components_manager_service_1[(_0xe1fea7(0xd1))](this[_0xe1fea7(0xb0)][_0xe1fea7(0x9c)],this[_0xe1fea7(0xb0)][_0xe1fea7(0xb3)],_0x2132a6[_0xe1fea7(0xab)],this[_0xe1fea7(0xb0)][_0xe1fea7(0xb7)],this[_0xe1fea7(0xa0)]);_0x1b95d1[_0xe1fea7(0x93)](...await _0x46793a[_0xe1fea7(0x9a)](_0x2132a6[_0xe1fea7(0xc4)],this[_0xe1fea7(0xb0)][_0xe1fea7(0xca)])),_0x1b95d1[_0xe1fea7(0x93)](...await _0x46793a[_0xe1fea7(0x9d)](_0x2132a6[_0xe1fea7(0x96)],this[_0xe1fea7(0xb0)][_0xe1fea7(0xca)])),_0x5a9ee1[_0xe1fea7(0x93)](await _0x46793a[_0xe1fea7(0xb1)](_0x2132a6[_0xe1fea7(0x8d)],!![])),this[_0xe1fea7(0xa0)]=_0x46793a[_0xe1fea7(0x9b)](),await this['proceedRequests'](_0x1b95d1,!![]);for(const _0x154a61 of _0x5a9ee1){_0x154a61['manifests']['length']&&await this[_0xe1fea7(0xd0)](_0x154a61[_0xe1fea7(0x8c)],!![]),_0x154a61[_0xe1fea7(0xce)][_0xe1fea7(0x99)]&&await this[_0xe1fea7(0xd0)](_0x154a61['componentsToUpdate'],!![]),_0x154a61[_0xe1fea7(0xa9)][_0xe1fea7(0x99)]&&await this[_0xe1fea7(0xd0)](_0x154a61[_0xe1fea7(0xa9)],!![]);}this[_0xe1fea7(0xac)][_0xe1fea7(0xc9)](_0xe1fea7(0x95),_0x1b95d1[_0xe1fea7(0x99)]);}}async[a233_0x14c03c(0xc0)](_0x4cd97f){const _0x226629=a233_0x14c03c,_0x1cafa9=[],_0x299074=[];for(const _0x22e49a of _0x4cd97f){if(!_0x22e49a[_0x226629(0xc4)][_0x226629(0x99)]&&!_0x22e49a['modified'][_0x226629(0x99)]&&!_0x22e49a[_0x226629(0x8d)][_0x226629(0x99)])continue;const _0x1e1bdc=new salesforce_components_manager_service_1[(_0x226629(0xd1))](this[_0x226629(0xb0)][_0x226629(0x9c)],this[_0x226629(0xb0)][_0x226629(0xb3)],_0x22e49a[_0x226629(0xab)],this[_0x226629(0xb0)][_0x226629(0xb7)],[]);_0x1cafa9['push'](...await _0x1e1bdc[_0x226629(0x9a)](_0x22e49a[_0x226629(0xc4)])),_0x1cafa9[_0x226629(0x93)](...await _0x1e1bdc[_0x226629(0x9d)](_0x22e49a['modified'])),_0x299074[_0x226629(0x93)](await _0x1e1bdc[_0x226629(0xb1)](_0x22e49a[_0x226629(0x8d)]));}this['logger'][_0x226629(0xc9)](_0x226629(0xb2),_0x1cafa9['length']),await this[_0x226629(0xd0)](_0x1cafa9);const _0x454d96=_0x299074['reduce']((_0x27d208,_0x26c514)=>({'manifests':[..._0x27d208['manifests'],..._0x26c514['manifests']],'componentsToDelete':[..._0x27d208[_0x226629(0xa9)],..._0x26c514[_0x226629(0xa9)]],'componentsToUpdate':[..._0x27d208[_0x226629(0xce)],..._0x26c514[_0x226629(0xce)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x454d96[_0x226629(0x8c)][_0x226629(0x99)]&&await this[_0x226629(0xd0)](_0x454d96[_0x226629(0x8c)],!![]),_0x454d96['componentsToUpdate']['length']&&await this[_0x226629(0xd0)](_0x454d96[_0x226629(0xce)],!![]),_0x454d96[_0x226629(0xa9)][_0x226629(0x99)]&&await this[_0x226629(0xd0)](_0x454d96['componentsToDelete'],!![]);}async[a233_0x14c03c(0xaf)](_0x13281c){const _0x577ba3=a233_0x14c03c;this[_0x577ba3(0xb0)]['branchId']?await this[_0x577ba3(0xc0)](_0x13281c):await this[_0x577ba3(0xc8)](_0x13281c);}}function a233_0x1e48(_0x60fc3e,_0x21c742){const _0x39a6ae=a233_0x53a2();return a233_0x1e48=function(_0x1a7b6e,_0x2c1438){_0x1a7b6e=_0x1a7b6e-0x89;let _0x53a2d0=_0x39a6ae[_0x1a7b6e];return _0x53a2d0;},a233_0x1e48(_0x60fc3e,_0x21c742);}exports['SalesforceCommitsManager']=SalesforceCommitsManager;