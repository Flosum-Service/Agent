const a194_0x46984a=a194_0x56e4;(function(_0x342f12,_0x2282f){const _0x3352e2=a194_0x56e4,_0x436b6f=_0x342f12();while(!![]){try{const _0x3a1f42=parseInt(_0x3352e2(0x101))/0x1+-parseInt(_0x3352e2(0x102))/0x2+-parseInt(_0x3352e2(0xfb))/0x3*(parseInt(_0x3352e2(0x107))/0x4)+-parseInt(_0x3352e2(0x10f))/0x5*(-parseInt(_0x3352e2(0xf2))/0x6)+-parseInt(_0x3352e2(0xf4))/0x7+parseInt(_0x3352e2(0x128))/0x8+parseInt(_0x3352e2(0x104))/0x9;if(_0x3a1f42===_0x2282f)break;else _0x436b6f['push'](_0x436b6f['shift']());}catch(_0x32f0d0){_0x436b6f['push'](_0x436b6f['shift']());}}}(a194_0x5d88,0x7d7fe));function a194_0x5d88(){const _0x206aa4=['SalesforceCompositeService','../errors/salesforce.error','defineProperty','componentsToUpdate','search','proceedCommits','SalesforceError','../../../shared/utils','6265544vNhVGP','(((.+)+)+)+$','push','toString','inserted','__esModule','proceededComponentsMeta','getProceededComponentsMeta','Sending\x20','author','removed','340350kdaQVh','repositoryId','3689042HvNlmQ','./salesforce-composite.service','stringify','toJSON','update','get','modified','2667gBUMnC','componentId','../../../../core','../../../../constants','find','error','683516uFdvcx','1318870UZlBnf','delete','7704396wvPBpK','logger','length','4076vzaSia','options','sfLogger','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','proceedRequests','\x20requests\x20to\x20composite\x20api.','manifests','map','25etjiDF','proceedCommitsToBranch','chunkArray','SalesforceComponentsManager','branchId','COMPONENTS_PER_CHUNK','composite','constructor','typedi','log','insert','recordTypes','componentsToDelete','reference','splice','reduce','SalesforceCommitsManager'];a194_0x5d88=function(){return _0x206aa4;};return a194_0x5d88();}const a194_0xe129e9=(function(){let _0xceeeae=!![];return function(_0x144990,_0x162cb1){const _0xe69793=_0xceeeae?function(){if(_0x162cb1){const _0x53b431=_0x162cb1['apply'](_0x144990,arguments);return _0x162cb1=null,_0x53b431;}}:function(){};return _0xceeeae=![],_0xe69793;};}()),a194_0x26d525=a194_0xe129e9(this,function(){const _0x39d7af=a194_0x56e4;return a194_0x26d525[_0x39d7af(0x12b)]()[_0x39d7af(0x124)](_0x39d7af(0x129))[_0x39d7af(0x12b)]()[_0x39d7af(0x116)](a194_0x26d525)['search'](_0x39d7af(0x129));});a194_0x26d525();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x461bd3){const _0x386794=a194_0x56e4;return _0x461bd3&&_0x461bd3[_0x386794(0x12d)]?_0x461bd3:{'default':_0x461bd3};};Object[a194_0x46984a(0x122)](exports,'__esModule',{'value':!![]}),exports[a194_0x46984a(0x11f)]=void 0x0;const core_1=require(a194_0x46984a(0xfd)),typedi_1=__importDefault(require(a194_0x46984a(0x117))),constants_1=require(a194_0x46984a(0xfe)),utils_1=require(a194_0x46984a(0x127)),salesforce_error_1=require(a194_0x46984a(0x121)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a194_0x46984a(0xf5));class SalesforceCommitsManager{constructor(_0x5a312f){const _0x361d4f=a194_0x46984a;this['options']=_0x5a312f,this[_0x361d4f(0x114)]=0x3,this[_0x361d4f(0x105)]=new core_1['Logger'](SalesforceCommitsManager['name']),this[_0x361d4f(0x109)]=this['options'][_0x361d4f(0x105)],this[_0x361d4f(0x115)]=typedi_1['default'][_0x361d4f(0xf9)](salesforce_composite_service_1[_0x361d4f(0x120)]),this['proceededComponentsMeta']=[];}async['proceedRequests'](_0x3848e2,_0x10102c=![]){const _0x460768=a194_0x46984a,_0x1184bb=(this[_0x460768(0x114)]+ +_0x10102c)*0x3,_0x1da803=(0x0,utils_1[_0x460768(0x111)])(_0x3848e2,_0x1184bb);try{while(_0x1da803[_0x460768(0x106)]){const _0x49cfa1=_0x1da803[_0x460768(0x11d)](0x0,Math['floor'](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x1184bb));await this[_0x460768(0x105)][_0x460768(0x118)](_0x460768(0x130)+_0x49cfa1[_0x460768(0x106)]*_0x1184bb+_0x460768(0x10c));const _0x209ce6=_0x49cfa1[_0x460768(0x10e)]((_0x395aab,_0x34ca51)=>({'graphId':'graph'+_0x34ca51,'compositeRequest':_0x395aab})),_0x2143b9=await this[_0x460768(0x115)]['executeGraphs'](_0x209ce6);if(_0x10102c){const _0x2feae8=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x2143b9);for(const {id:_0x149fb5,ref:_0x2149ff}of _0x2feae8){const _0x390822=this[_0x460768(0x12e)][_0x460768(0xff)](_0x425ea5=>_0x425ea5[_0x460768(0x11c)]===_0x2149ff);_0x390822&&(_0x390822[_0x460768(0xfc)]=_0x149fb5);}}}}catch(_0x33e710){this[_0x460768(0x105)][_0x460768(0x100)](_0x33e710 instanceof salesforce_error_1[_0x460768(0x126)]?JSON[_0x460768(0xf6)](_0x33e710[_0x460768(0xf7)](),null,0x2):_0x33e710),this[_0x460768(0x109)][_0x460768(0x118)](_0x33e710 instanceof salesforce_error_1[_0x460768(0x126)]?JSON['stringify'](_0x33e710['toJSON'](),null,0x2):_0x33e710[_0x460768(0x12b)]());throw _0x33e710;}}async['proceedCommitsToRepository'](_0x23451e){const _0x3f30ad=a194_0x46984a;for(const _0x130ba3 of _0x23451e){if(!_0x130ba3['inserted']['length']&&!_0x130ba3[_0x3f30ad(0xfa)][_0x3f30ad(0x106)]&&!_0x130ba3[_0x3f30ad(0xf1)][_0x3f30ad(0x106)])continue;const _0x2f0fd9=[],_0x3e7fe2=[],_0x3bf8bb=new salesforce_components_manager_service_1[(_0x3f30ad(0x112))](this['options'][_0x3f30ad(0xf3)],this[_0x3f30ad(0x108)]['branchId'],_0x130ba3['author'],this[_0x3f30ad(0x108)][_0x3f30ad(0x11a)],this['proceededComponentsMeta']);_0x2f0fd9[_0x3f30ad(0x12a)](...await _0x3bf8bb[_0x3f30ad(0x119)](_0x130ba3['inserted'],this[_0x3f30ad(0x108)]['commitId'])),_0x2f0fd9['push'](...await _0x3bf8bb[_0x3f30ad(0xf8)](_0x130ba3[_0x3f30ad(0xfa)],this['options']['commitId'])),_0x3e7fe2[_0x3f30ad(0x12a)](await _0x3bf8bb[_0x3f30ad(0x103)](_0x130ba3[_0x3f30ad(0xf1)],!![])),this[_0x3f30ad(0x12e)]=_0x3bf8bb[_0x3f30ad(0x12f)](),await this[_0x3f30ad(0x10b)](_0x2f0fd9,!![]);for(const _0x67db67 of _0x3e7fe2){_0x67db67['manifests'][_0x3f30ad(0x106)]&&await this['proceedRequests'](_0x67db67['manifests'],!![]),_0x67db67[_0x3f30ad(0x123)][_0x3f30ad(0x106)]&&await this[_0x3f30ad(0x10b)](_0x67db67[_0x3f30ad(0x123)],!![]),_0x67db67[_0x3f30ad(0x11b)]['length']&&await this['proceedRequests'](_0x67db67[_0x3f30ad(0x11b)],!![]);}this[_0x3f30ad(0x105)][_0x3f30ad(0x118)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x2f0fd9[_0x3f30ad(0x106)]);}}async[a194_0x46984a(0x110)](_0x2bcfa1){const _0x21323b=a194_0x46984a,_0x1a384d=[],_0x13336f=[];for(const _0x3722dc of _0x2bcfa1){if(!_0x3722dc[_0x21323b(0x12c)][_0x21323b(0x106)]&&!_0x3722dc[_0x21323b(0xfa)][_0x21323b(0x106)]&&!_0x3722dc[_0x21323b(0xf1)][_0x21323b(0x106)])continue;const _0xd27519=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x21323b(0x108)][_0x21323b(0xf3)],this['options'][_0x21323b(0x113)],_0x3722dc[_0x21323b(0xf0)],this['options'][_0x21323b(0x11a)],[]);_0x1a384d['push'](...await _0xd27519['insert'](_0x3722dc[_0x21323b(0x12c)])),_0x1a384d[_0x21323b(0x12a)](...await _0xd27519['update'](_0x3722dc['modified'])),_0x13336f[_0x21323b(0x12a)](await _0xd27519[_0x21323b(0x103)](_0x3722dc[_0x21323b(0xf1)]));}this[_0x21323b(0x105)][_0x21323b(0x118)](_0x21323b(0x10a),_0x1a384d[_0x21323b(0x106)]),await this['proceedRequests'](_0x1a384d);const _0x581356=_0x13336f[_0x21323b(0x11e)]((_0x570738,_0xd04990)=>({'manifests':[..._0x570738[_0x21323b(0x10d)],..._0xd04990['manifests']],'componentsToDelete':[..._0x570738['componentsToDelete'],..._0xd04990[_0x21323b(0x11b)]],'componentsToUpdate':[..._0x570738[_0x21323b(0x123)],..._0xd04990['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x581356['manifests'][_0x21323b(0x106)]&&await this['proceedRequests'](_0x581356['manifests'],!![]),_0x581356['componentsToUpdate'][_0x21323b(0x106)]&&await this['proceedRequests'](_0x581356[_0x21323b(0x123)],!![]),_0x581356[_0x21323b(0x11b)][_0x21323b(0x106)]&&await this[_0x21323b(0x10b)](_0x581356[_0x21323b(0x11b)],!![]);}async[a194_0x46984a(0x125)](_0x3723ab){const _0x3e3766=a194_0x46984a;this['options'][_0x3e3766(0x113)]?await this[_0x3e3766(0x110)](_0x3723ab):await this['proceedCommitsToRepository'](_0x3723ab);}}function a194_0x56e4(_0x371be8,_0x3fc559){const _0x462f88=a194_0x5d88();return a194_0x56e4=function(_0x26d525,_0xe129e9){_0x26d525=_0x26d525-0xf0;let _0x5d8831=_0x462f88[_0x26d525];return _0x5d8831;},a194_0x56e4(_0x371be8,_0x3fc559);}exports['SalesforceCommitsManager']=SalesforceCommitsManager;