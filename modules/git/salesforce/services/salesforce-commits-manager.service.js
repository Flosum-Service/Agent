const a244_0x1bacb2=a244_0x5463;(function(_0x39cb3d,_0x4e5f5e){const _0x468f67=a244_0x5463,_0x3c392e=_0x39cb3d();while(!![]){try{const _0xc87647=parseInt(_0x468f67(0x120))/0x1+parseInt(_0x468f67(0x146))/0x2+parseInt(_0x468f67(0x132))/0x3+parseInt(_0x468f67(0x135))/0x4*(-parseInt(_0x468f67(0x129))/0x5)+-parseInt(_0x468f67(0x12a))/0x6*(parseInt(_0x468f67(0x144))/0x7)+-parseInt(_0x468f67(0x12b))/0x8*(parseInt(_0x468f67(0x14e))/0x9)+-parseInt(_0x468f67(0x12f))/0xa*(parseInt(_0x468f67(0x10f))/0xb);if(_0xc87647===_0x4e5f5e)break;else _0x3c392e['push'](_0x3c392e['shift']());}catch(_0x58d544){_0x3c392e['push'](_0x3c392e['shift']());}}}(a244_0x496a,0xe8bb7));const a244_0x4d79c0=(function(){let _0x1a5ea6=!![];return function(_0x1192d3,_0x5f167b){const _0x2d4a7e=_0x1a5ea6?function(){const _0x498e1e=a244_0x5463;if(_0x5f167b){const _0x16bef4=_0x5f167b[_0x498e1e(0x10b)](_0x1192d3,arguments);return _0x5f167b=null,_0x16bef4;}}:function(){};return _0x1a5ea6=![],_0x2d4a7e;};}()),a244_0xd5d405=a244_0x4d79c0(this,function(){const _0x5b8b71=a244_0x5463;return a244_0xd5d405['toString']()[_0x5b8b71(0x122)](_0x5b8b71(0x134))[_0x5b8b71(0x121)]()[_0x5b8b71(0x130)](a244_0xd5d405)[_0x5b8b71(0x122)](_0x5b8b71(0x134));});a244_0xd5d405();'use strict';var __importDefault=this&&this[a244_0x1bacb2(0x114)]||function(_0x484112){const _0x35eb33=a244_0x1bacb2;return _0x484112&&_0x484112[_0x35eb33(0x148)]?_0x484112:{'default':_0x484112};};Object[a244_0x1bacb2(0x12e)](exports,'__esModule',{'value':!![]}),exports[a244_0x1bacb2(0x145)]=void 0x0;const core_1=require(a244_0x1bacb2(0x11a)),typedi_1=__importDefault(require(a244_0x1bacb2(0x10a))),constants_1=require(a244_0x1bacb2(0x126)),utils_1=require(a244_0x1bacb2(0x13d)),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a244_0x1bacb2(0x119)),salesforce_components_manager_service_1=require(a244_0x1bacb2(0x107)),salesforce_composite_service_1=require('./salesforce-composite.service');class SalesforceCommitsManager{constructor(_0x403a77){const _0x260c06=a244_0x1bacb2;this[_0x260c06(0x115)]=_0x403a77,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x260c06(0x128)]=new core_1[(_0x260c06(0x141))](SalesforceCommitsManager[_0x260c06(0x112)]),this['sfLogger']=this['options'][_0x260c06(0x128)],this['composite']=typedi_1[_0x260c06(0x14c)][_0x260c06(0x11e)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x260c06(0x10e)]=[];}async[a244_0x1bacb2(0x143)](_0x2fb205,_0x5d8e53=![]){const _0x4dc9ad=a244_0x1bacb2,_0x275d71=async _0x2ec113=>{const _0x542081=a244_0x5463;await this[_0x542081(0x128)][_0x542081(0x127)]('Sending\x20'+_0x2ec113[_0x542081(0x117)]((_0x531e9c,_0x3ef0a4)=>_0x531e9c+_0x3ef0a4[_0x542081(0x108)],0x0)+_0x542081(0x13a));const _0x58dd30=_0x2ec113[_0x542081(0x110)]((_0x379cb4,_0x40857a)=>({'graphId':_0x542081(0x149)+_0x40857a,'compositeRequest':_0x379cb4})),_0x8e8b7f=await this[_0x542081(0x109)]['executeGraphs'](_0x58dd30);if(_0x5d8e53){const _0x114c54=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x8e8b7f);for(const {id:_0xb0b570,ref:_0x4a86d4}of _0x114c54){const _0x31951d=this[_0x542081(0x10e)][_0x542081(0x113)](_0x4f91d4=>_0x4f91d4['reference']===_0x4a86d4);_0x31951d&&(_0x31951d['componentId']=_0xb0b570);}}},_0x120eec=0x1e8480;let _0x4f5af9=0x0,_0x48e64b=[];for(const _0x19173a of _0x2fb205){const _0x5cc2c0=_0x19173a['reduce']((_0x521582,_0x6f7890)=>{const _0xbd188a=a244_0x5463,_0x188e7e=JSON['stringify'](_0x6f7890)[_0xbd188a(0x108)]*0x2;return _0x521582+_0x188e7e;},0x0);if(_0x5cc2c0>constants_1[_0x4dc9ad(0x140)])throw new salesforce_error_1[(_0x4dc9ad(0x14b))]('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1[_0x4dc9ad(0x140)]+_0x4dc9ad(0x12c)+_0x5cc2c0);_0x4f5af9+_0x5cc2c0>constants_1[_0x4dc9ad(0x140)]-_0x120eec&&(await _0x275d71(_0x48e64b),_0x48e64b=[],_0x4f5af9=0x0),_0x4f5af9+=_0x5cc2c0,_0x48e64b[_0x4dc9ad(0x147)](_0x19173a);}_0x48e64b[_0x4dc9ad(0x108)]&&await _0x275d71(_0x48e64b);}async[a244_0x1bacb2(0x14a)](_0x2dd890,_0x7b2353=![]){const _0x4d055a=a244_0x1bacb2,_0x19bd90=(this['COMPONENTS_PER_CHUNK']+ +_0x7b2353)*0x3,_0x3baa7d=(0x0,utils_1['chunkArray'])(_0x2dd890,_0x19bd90);try{while(_0x3baa7d[_0x4d055a(0x108)]){const _0x253653=_0x3baa7d[_0x4d055a(0x139)](0x0,Math['floor'](constants_1[_0x4d055a(0x137)]/_0x19bd90));await this['proceedChunksToUpload'](_0x253653,_0x7b2353);}}catch(_0x383250){this['logger'][_0x4d055a(0x138)](_0x383250 instanceof salesforce_error_1[_0x4d055a(0x14b)]?JSON[_0x4d055a(0x11b)](_0x383250['toJSON'](),null,0x2):_0x383250),this['sfLogger'][_0x4d055a(0x127)](_0x383250 instanceof salesforce_error_1[_0x4d055a(0x14b)]?JSON[_0x4d055a(0x11b)](_0x383250[_0x4d055a(0x133)](),null,0x2):_0x383250[_0x4d055a(0x121)]());throw _0x383250;}}async[a244_0x1bacb2(0x11c)](_0x3a8286){const _0x469107=a244_0x1bacb2;for(const _0x145e52 of _0x3a8286){if(!_0x145e52[_0x469107(0x11f)][_0x469107(0x108)]&&!_0x145e52[_0x469107(0x10d)][_0x469107(0x108)]&&!_0x145e52[_0x469107(0x142)][_0x469107(0x108)])continue;const _0x1d4439=[],_0x41da1e=[],_0x4ace9e=new salesforce_components_manager_service_1[(_0x469107(0x111))](this[_0x469107(0x115)][_0x469107(0x12d)],this['options'][_0x469107(0x118)],_0x145e52['author'],this[_0x469107(0x115)][_0x469107(0x124)],this[_0x469107(0x10e)]);_0x1d4439[_0x469107(0x147)](...await _0x4ace9e[_0x469107(0x125)](_0x145e52[_0x469107(0x11f)],this[_0x469107(0x115)]['commitId'])),_0x1d4439[_0x469107(0x147)](...await _0x4ace9e[_0x469107(0x131)](_0x145e52['modified'],this['options'][_0x469107(0x10c)])),_0x41da1e[_0x469107(0x147)](await _0x4ace9e[_0x469107(0x136)](_0x145e52[_0x469107(0x142)],!![])),this[_0x469107(0x10e)]=_0x4ace9e[_0x469107(0x116)](),await this[_0x469107(0x14a)](_0x1d4439,!![]);for(const _0x3752a8 of _0x41da1e){_0x3752a8[_0x469107(0x11d)]['length']&&await this[_0x469107(0x14a)](_0x3752a8[_0x469107(0x11d)],!![]),_0x3752a8[_0x469107(0x14d)]['length']&&await this['proceedRequests'](_0x3752a8[_0x469107(0x14d)],!![]),_0x3752a8['componentsToDelete'][_0x469107(0x108)]&&await this[_0x469107(0x14a)](_0x3752a8[_0x469107(0x123)],!![]);}this[_0x469107(0x128)][_0x469107(0x127)](_0x469107(0x13b),_0x1d4439[_0x469107(0x108)]);}}async[a244_0x1bacb2(0x13f)](_0xb221ec){const _0x2558cf=a244_0x1bacb2,_0x430e9f=[],_0xfd34cb=[];for(const _0x2b6d3e of _0xb221ec){if(!_0x2b6d3e[_0x2558cf(0x11f)][_0x2558cf(0x108)]&&!_0x2b6d3e[_0x2558cf(0x10d)][_0x2558cf(0x108)]&&!_0x2b6d3e['removed'][_0x2558cf(0x108)])continue;const _0x21c2e2=new salesforce_components_manager_service_1[(_0x2558cf(0x111))](this['options'][_0x2558cf(0x12d)],this[_0x2558cf(0x115)]['branchId'],_0x2b6d3e[_0x2558cf(0x13e)],this['options'][_0x2558cf(0x124)],[]);_0x430e9f[_0x2558cf(0x147)](...await _0x21c2e2[_0x2558cf(0x125)](_0x2b6d3e[_0x2558cf(0x11f)])),_0x430e9f[_0x2558cf(0x147)](...await _0x21c2e2[_0x2558cf(0x131)](_0x2b6d3e[_0x2558cf(0x10d)])),_0xfd34cb[_0x2558cf(0x147)](await _0x21c2e2['delete'](_0x2b6d3e['removed']));}this[_0x2558cf(0x128)][_0x2558cf(0x127)](_0x2558cf(0x13c),_0x430e9f[_0x2558cf(0x108)]),await this[_0x2558cf(0x14a)](_0x430e9f);const _0x48bb18=_0xfd34cb[_0x2558cf(0x117)]((_0x48661a,_0x39c85d)=>({'manifests':[..._0x48661a[_0x2558cf(0x11d)],..._0x39c85d[_0x2558cf(0x11d)]],'componentsToDelete':[..._0x48661a[_0x2558cf(0x123)],..._0x39c85d[_0x2558cf(0x123)]],'componentsToUpdate':[..._0x48661a[_0x2558cf(0x14d)],..._0x39c85d['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x48bb18[_0x2558cf(0x11d)][_0x2558cf(0x108)]&&await this[_0x2558cf(0x14a)](_0x48bb18[_0x2558cf(0x11d)],!![]),_0x48bb18[_0x2558cf(0x14d)][_0x2558cf(0x108)]&&await this[_0x2558cf(0x14a)](_0x48bb18[_0x2558cf(0x14d)],!![]),_0x48bb18[_0x2558cf(0x123)][_0x2558cf(0x108)]&&await this[_0x2558cf(0x14a)](_0x48bb18[_0x2558cf(0x123)],!![]);}async['proceedCommits'](_0x25af0a){const _0x23dd5a=a244_0x1bacb2;this['options'][_0x23dd5a(0x118)]?await this['proceedCommitsToBranch'](_0x25af0a):await this[_0x23dd5a(0x11c)](_0x25af0a);}}function a244_0x5463(_0x3f3c37,_0x184435){const _0x3bf6b4=a244_0x496a();return a244_0x5463=function(_0xd5d405,_0x4d79c0){_0xd5d405=_0xd5d405-0x107;let _0x496a9b=_0x3bf6b4[_0xd5d405];return _0x496a9b;},a244_0x5463(_0x3f3c37,_0x184435);}exports['SalesforceCommitsManager']=SalesforceCommitsManager;function a244_0x496a(){const _0x32dd95=['8eVvvGM','\x20COMPONENTS_SIZE\x20=\x20','repositoryId','defineProperty','3414460KiKKaG','constructor','update','496692bYuuRt','toJSON','(((.+)+)+)+$','20zoIVJS','delete','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','error','splice','\x20requests\x20to\x20composite\x20api.','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','../../../shared/utils','author','proceedCommitsToBranch','SALESFORCE_MAX_REQUEST_SIZE_BYTES','Logger','removed','proceedChunksToUpload','5623653Hdizvi','SalesforceCommitsManager','3435872dpYnFo','push','__esModule','graph','proceedRequests','SalesforceError','default','componentsToUpdate','5277627QCdvbA','./salesforce-components-manager.service','length','composite','typedi','apply','commitId','modified','proceededComponentsMeta','11dTnqYY','map','SalesforceComponentsManager','name','find','__importDefault','options','getProceededComponentsMeta','reduce','branchId','../utils/composite.utils','../../../../core','stringify','proceedCommitsToRepository','manifests','get','inserted','1643209CVfELQ','toString','search','componentsToDelete','recordTypes','insert','../../../../constants','log','logger','842210AOeQpW','6yCpMfF'];a244_0x496a=function(){return _0x32dd95;};return a244_0x496a();}