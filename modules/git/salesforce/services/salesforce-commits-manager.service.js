const a233_0x28d4c4=a233_0x43ac;(function(_0x1bb09f,_0x4140df){const _0xc62fd5=a233_0x43ac,_0x4ba549=_0x1bb09f();while(!![]){try{const _0x197f1c=parseInt(_0xc62fd5(0xed))/0x1*(-parseInt(_0xc62fd5(0xf7))/0x2)+parseInt(_0xc62fd5(0xd5))/0x3*(-parseInt(_0xc62fd5(0xdd))/0x4)+-parseInt(_0xc62fd5(0xca))/0x5*(-parseInt(_0xc62fd5(0xe6))/0x6)+parseInt(_0xc62fd5(0xea))/0x7*(-parseInt(_0xc62fd5(0xcc))/0x8)+parseInt(_0xc62fd5(0x102))/0x9*(-parseInt(_0xc62fd5(0xd6))/0xa)+-parseInt(_0xc62fd5(0xeb))/0xb*(parseInt(_0xc62fd5(0xe5))/0xc)+-parseInt(_0xc62fd5(0xcd))/0xd*(-parseInt(_0xc62fd5(0xd0))/0xe);if(_0x197f1c===_0x4140df)break;else _0x4ba549['push'](_0x4ba549['shift']());}catch(_0x196aaf){_0x4ba549['push'](_0x4ba549['shift']());}}}(a233_0x57f4,0x7718e));const a233_0x43987c=(function(){let _0x1982c=!![];return function(_0x2e5043,_0x5b40e2){const _0x158982=_0x1982c?function(){const _0x559561=a233_0x43ac;if(_0x5b40e2){const _0x4d411c=_0x5b40e2[_0x559561(0xf2)](_0x2e5043,arguments);return _0x5b40e2=null,_0x4d411c;}}:function(){};return _0x1982c=![],_0x158982;};}()),a233_0x59031d=a233_0x43987c(this,function(){const _0x3eccff=a233_0x43ac;return a233_0x59031d[_0x3eccff(0xc5)]()[_0x3eccff(0xba)]('(((.+)+)+)+$')[_0x3eccff(0xc5)]()[_0x3eccff(0xcf)](a233_0x59031d)['search'](_0x3eccff(0xf0));});function a233_0x43ac(_0x4e35ca,_0x108c61){const _0x40862a=a233_0x57f4();return a233_0x43ac=function(_0x59031d,_0x43987c){_0x59031d=_0x59031d-0xb7;let _0x57f4e3=_0x40862a[_0x59031d];return _0x57f4e3;},a233_0x43ac(_0x4e35ca,_0x108c61);}a233_0x59031d();'use strict';var __importDefault=this&&this[a233_0x28d4c4(0xef)]||function(_0x3b2c5a){const _0x16f3c7=a233_0x28d4c4;return _0x3b2c5a&&_0x3b2c5a[_0x16f3c7(0xcb)]?_0x3b2c5a:{'default':_0x3b2c5a};};Object[a233_0x28d4c4(0xbb)](exports,'__esModule',{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require(a233_0x28d4c4(0xe0)),typedi_1=__importDefault(require(a233_0x28d4c4(0xf3))),constants_1=require('../../../../constants'),utils_1=require('../../../shared/utils'),salesforce_error_1=require(a233_0x28d4c4(0xc1)),composite_utils_1=require(a233_0x28d4c4(0xc7)),salesforce_components_manager_service_1=require(a233_0x28d4c4(0xd8)),salesforce_composite_service_1=require(a233_0x28d4c4(0xda));class SalesforceCommitsManager{constructor(_0x1fe88d){const _0xf0ce61=a233_0x28d4c4;this[_0xf0ce61(0xc0)]=_0x1fe88d,this[_0xf0ce61(0xd2)]=0x3,this[_0xf0ce61(0xb7)]=new core_1[(_0xf0ce61(0xff))](SalesforceCommitsManager[_0xf0ce61(0xf4)]),this[_0xf0ce61(0xdf)]=this[_0xf0ce61(0xc0)]['logger'],this['composite']=typedi_1[_0xf0ce61(0x104)][_0xf0ce61(0xb8)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0xf0ce61(0xe7)]=[];}async[a233_0x28d4c4(0xee)](_0x531a59,_0x1468a3=![]){const _0x55678e=a233_0x28d4c4,_0x2faad6=async _0x5016c4=>{const _0x44a48c=a233_0x43ac;await this[_0x44a48c(0xb7)][_0x44a48c(0xf1)]('Sending\x20'+_0x5016c4[_0x44a48c(0xc6)]((_0x48bef3,_0x51332b)=>_0x48bef3+_0x51332b['length'],0x0)+_0x44a48c(0xf9));const _0x10ceb5=_0x5016c4[_0x44a48c(0xc8)]((_0x101253,_0x1489d4)=>({'graphId':_0x44a48c(0xfa)+_0x1489d4,'compositeRequest':_0x101253})),_0x45c4e6=await this[_0x44a48c(0xdb)][_0x44a48c(0x106)](_0x10ceb5);if(_0x1468a3){const _0x24f643=(0x0,composite_utils_1[_0x44a48c(0x103)])(_0x45c4e6);for(const {id:_0x2ad1f8,ref:_0x26af8a}of _0x24f643){const _0x4e8da3=this[_0x44a48c(0xe7)]['find'](_0x56844a=>_0x56844a[_0x44a48c(0xfe)]===_0x26af8a);_0x4e8da3&&(_0x4e8da3[_0x44a48c(0xe9)]=_0x2ad1f8);}}},_0x3fb8c7=0x1e8480;let _0x22db90=0x0,_0x41a86f=[];for(const _0x4e1a27 of _0x531a59){const _0x5d2404=_0x4e1a27['reduce']((_0x5cf82d,_0x462ecd)=>{const _0x4f26e7=a233_0x43ac,_0x5509a1=JSON[_0x4f26e7(0xdc)](_0x462ecd)[_0x4f26e7(0xd1)]*0x2;return _0x5cf82d+_0x5509a1;},0x0);if(_0x5d2404>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1[(_0x55678e(0xc4))](_0x55678e(0xfc)+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+_0x55678e(0xfd)+_0x5d2404);_0x22db90+_0x5d2404>constants_1[_0x55678e(0xbe)]-_0x3fb8c7&&(await _0x2faad6(_0x41a86f),_0x41a86f=[],_0x22db90=0x0),_0x22db90+=_0x5d2404,_0x41a86f[_0x55678e(0xe3)](_0x4e1a27);}_0x41a86f[_0x55678e(0xd1)]&&await _0x2faad6(_0x41a86f);}async[a233_0x28d4c4(0xc9)](_0x1d3d74,_0x2b23d5=![]){const _0x1f69b7=a233_0x28d4c4,_0x266095=(this[_0x1f69b7(0xd2)]+ +_0x2b23d5)*0x3,_0x10025c=(0x0,utils_1['chunkArray'])(_0x1d3d74,_0x266095);try{while(_0x10025c[_0x1f69b7(0xd1)]){const _0x34652e=_0x10025c[_0x1f69b7(0xc3)](0x0,Math[_0x1f69b7(0xfb)](constants_1[_0x1f69b7(0xc2)]/_0x266095));await this[_0x1f69b7(0xee)](_0x34652e,_0x2b23d5);}}catch(_0x10e4f9){this[_0x1f69b7(0xb7)][_0x1f69b7(0xbc)](_0x10e4f9 instanceof salesforce_error_1[_0x1f69b7(0xc4)]?JSON[_0x1f69b7(0xdc)](_0x10e4f9[_0x1f69b7(0xd9)](),null,0x2):_0x10e4f9),this['sfLogger'][_0x1f69b7(0xf1)](_0x10e4f9 instanceof salesforce_error_1[_0x1f69b7(0xc4)]?JSON[_0x1f69b7(0xdc)](_0x10e4f9[_0x1f69b7(0xd9)](),null,0x2):_0x10e4f9[_0x1f69b7(0xc5)]());throw _0x10e4f9;}}async[a233_0x28d4c4(0xbd)](_0x3ac52e){const _0x3c579f=a233_0x28d4c4;for(const _0x5cba46 of _0x3ac52e){if(!_0x5cba46['inserted']['length']&&!_0x5cba46[_0x3c579f(0xe4)]['length']&&!_0x5cba46[_0x3c579f(0xde)][_0x3c579f(0xd1)])continue;const _0x3f8114=[],_0x48ce57=[],_0x474c8a=new salesforce_components_manager_service_1[(_0x3c579f(0xd3))](this[_0x3c579f(0xc0)][_0x3c579f(0x100)],this[_0x3c579f(0xc0)][_0x3c579f(0xf6)],_0x5cba46[_0x3c579f(0xf5)],this[_0x3c579f(0xc0)][_0x3c579f(0xd7)],this[_0x3c579f(0xe7)]);_0x3f8114[_0x3c579f(0xe3)](...await _0x474c8a[_0x3c579f(0xb9)](_0x5cba46[_0x3c579f(0xe1)],this[_0x3c579f(0xc0)][_0x3c579f(0x101)])),_0x3f8114[_0x3c579f(0xe3)](...await _0x474c8a[_0x3c579f(0x105)](_0x5cba46[_0x3c579f(0xe4)],this['options'][_0x3c579f(0x101)])),_0x48ce57[_0x3c579f(0xe3)](await _0x474c8a['delete'](_0x5cba46[_0x3c579f(0xde)],!![])),this[_0x3c579f(0xe7)]=_0x474c8a[_0x3c579f(0xec)](),await this[_0x3c579f(0xc9)](_0x3f8114,!![]);for(const _0x1b082b of _0x48ce57){_0x1b082b[_0x3c579f(0xe8)]['length']&&await this['proceedRequests'](_0x1b082b['manifests'],!![]),_0x1b082b['componentsToUpdate'][_0x3c579f(0xd1)]&&await this[_0x3c579f(0xc9)](_0x1b082b[_0x3c579f(0xbf)],!![]),_0x1b082b[_0x3c579f(0xce)][_0x3c579f(0xd1)]&&await this[_0x3c579f(0xc9)](_0x1b082b[_0x3c579f(0xce)],!![]);}this[_0x3c579f(0xb7)][_0x3c579f(0xf1)](_0x3c579f(0xe2),_0x3f8114[_0x3c579f(0xd1)]);}}async[a233_0x28d4c4(0xd4)](_0x3ae31c){const _0x3ed8b4=a233_0x28d4c4,_0x426ac8=[],_0xc4ecdf=[];for(const _0x243806 of _0x3ae31c){if(!_0x243806[_0x3ed8b4(0xe1)][_0x3ed8b4(0xd1)]&&!_0x243806[_0x3ed8b4(0xe4)][_0x3ed8b4(0xd1)]&&!_0x243806[_0x3ed8b4(0xde)]['length'])continue;const _0x30981c=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x3ed8b4(0xc0)]['repositoryId'],this['options']['branchId'],_0x243806[_0x3ed8b4(0xf5)],this[_0x3ed8b4(0xc0)][_0x3ed8b4(0xd7)],[]);_0x426ac8['push'](...await _0x30981c['insert'](_0x243806[_0x3ed8b4(0xe1)])),_0x426ac8['push'](...await _0x30981c[_0x3ed8b4(0x105)](_0x243806['modified'])),_0xc4ecdf[_0x3ed8b4(0xe3)](await _0x30981c['delete'](_0x243806[_0x3ed8b4(0xde)]));}this[_0x3ed8b4(0xb7)][_0x3ed8b4(0xf1)](_0x3ed8b4(0xf8),_0x426ac8[_0x3ed8b4(0xd1)]),await this[_0x3ed8b4(0xc9)](_0x426ac8);const _0x472f35=_0xc4ecdf[_0x3ed8b4(0xc6)]((_0x3aabb6,_0x1f44c4)=>({'manifests':[..._0x3aabb6[_0x3ed8b4(0xe8)],..._0x1f44c4[_0x3ed8b4(0xe8)]],'componentsToDelete':[..._0x3aabb6[_0x3ed8b4(0xce)],..._0x1f44c4['componentsToDelete']],'componentsToUpdate':[..._0x3aabb6['componentsToUpdate'],..._0x1f44c4[_0x3ed8b4(0xbf)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x472f35[_0x3ed8b4(0xe8)]['length']&&await this[_0x3ed8b4(0xc9)](_0x472f35[_0x3ed8b4(0xe8)],!![]),_0x472f35[_0x3ed8b4(0xbf)][_0x3ed8b4(0xd1)]&&await this[_0x3ed8b4(0xc9)](_0x472f35[_0x3ed8b4(0xbf)],!![]),_0x472f35[_0x3ed8b4(0xce)][_0x3ed8b4(0xd1)]&&await this[_0x3ed8b4(0xc9)](_0x472f35['componentsToDelete'],!![]);}async['proceedCommits'](_0x4c2c8c){const _0x1c490c=a233_0x28d4c4;this[_0x1c490c(0xc0)][_0x1c490c(0xf6)]?await this[_0x1c490c(0xd4)](_0x4c2c8c):await this[_0x1c490c(0xbd)](_0x4c2c8c);}}function a233_0x57f4(){const _0x1f211d=['modified','372rllxeU','354rlvOmP','proceededComponentsMeta','manifests','componentId','203EpUqoh','281776xzKNGN','getProceededComponentsMeta','1LMRxOR','proceedChunksToUpload','__importDefault','(((.+)+)+)+$','log','apply','typedi','name','author','branchId','778222qeqVfE','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','\x20requests\x20to\x20composite\x20api.','graph','floor','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','\x20COMPONENTS_SIZE\x20=\x20','reference','Logger','repositoryId','commitId','28683WXueaB','extractComponentIdsFromGraphsResponse','default','update','executeGraphs','logger','get','insert','search','defineProperty','error','proceedCommitsToRepository','SALESFORCE_MAX_REQUEST_SIZE_BYTES','componentsToUpdate','options','../errors/salesforce.error','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','splice','SalesforceError','toString','reduce','../utils/composite.utils','map','proceedRequests','62315wSawRb','__esModule','38768IWKEdI','299OCMWCJ','componentsToDelete','constructor','858802mvLNWA','length','COMPONENTS_PER_CHUNK','SalesforceComponentsManager','proceedCommitsToBranch','6TccFwD','530cwykJu','recordTypes','./salesforce-components-manager.service','toJSON','./salesforce-composite.service','composite','stringify','331464kYIgkV','removed','sfLogger','../../../../core','inserted','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','push'];a233_0x57f4=function(){return _0x1f211d;};return a233_0x57f4();}exports['SalesforceCommitsManager']=SalesforceCommitsManager;