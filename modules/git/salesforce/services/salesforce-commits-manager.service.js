const a270_0x533348=a270_0x5889;(function(_0x11f0db,_0x61e9f){const _0x5c162a=a270_0x5889,_0x5d19f0=_0x11f0db();while(!![]){try{const _0x366976=-parseInt(_0x5c162a(0x14f))/0x1*(-parseInt(_0x5c162a(0x179))/0x2)+parseInt(_0x5c162a(0x17c))/0x3*(-parseInt(_0x5c162a(0x14d))/0x4)+parseInt(_0x5c162a(0x167))/0x5+-parseInt(_0x5c162a(0x16b))/0x6*(-parseInt(_0x5c162a(0x152))/0x7)+-parseInt(_0x5c162a(0x17f))/0x8*(parseInt(_0x5c162a(0x15e))/0x9)+-parseInt(_0x5c162a(0x158))/0xa+parseInt(_0x5c162a(0x174))/0xb*(-parseInt(_0x5c162a(0x14e))/0xc);if(_0x366976===_0x61e9f)break;else _0x5d19f0['push'](_0x5d19f0['shift']());}catch(_0x3ae1ff){_0x5d19f0['push'](_0x5d19f0['shift']());}}}(a270_0x4d2f,0x4b127));const a270_0x52078a=(function(){let _0x216070=!![];return function(_0x230451,_0x17655f){const _0x3e6aac=_0x216070?function(){const _0x52212d=a270_0x5889;if(_0x17655f){const _0x481bd7=_0x17655f[_0x52212d(0x189)](_0x230451,arguments);return _0x17655f=null,_0x481bd7;}}:function(){};return _0x216070=![],_0x3e6aac;};}()),a270_0x6ff66d=a270_0x52078a(this,function(){const _0x138023=a270_0x5889;return a270_0x6ff66d[_0x138023(0x178)]()[_0x138023(0x15d)](_0x138023(0x16a))[_0x138023(0x178)]()['constructor'](a270_0x6ff66d)[_0x138023(0x15d)](_0x138023(0x16a));});a270_0x6ff66d();function a270_0x5889(_0x332e1a,_0x3dc899){const _0x176e95=a270_0x4d2f();return a270_0x5889=function(_0x6ff66d,_0x52078a){_0x6ff66d=_0x6ff66d-0x146;let _0x4d2f93=_0x176e95[_0x6ff66d];return _0x4d2f93;},a270_0x5889(_0x332e1a,_0x3dc899);}'use strict';var __importDefault=this&&this[a270_0x533348(0x180)]||function(_0x1615e8){const _0x3e3a12=a270_0x533348;return _0x1615e8&&_0x1615e8[_0x3e3a12(0x18f)]?_0x1615e8:{'default':_0x1615e8};};Object[a270_0x533348(0x169)](exports,a270_0x533348(0x18f),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require(a270_0x533348(0x17b)),typedi_1=__importDefault(require(a270_0x533348(0x188))),constants_1=require(a270_0x533348(0x185)),utils_1=require('../../../shared/utils'),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a270_0x533348(0x181)),salesforce_components_manager_service_1=require(a270_0x533348(0x151)),salesforce_composite_service_1=require(a270_0x533348(0x18e));class SalesforceCommitsManager{constructor(_0x1b8ee6){const _0xf93a1=a270_0x533348;this[_0xf93a1(0x170)]=_0x1b8ee6,this[_0xf93a1(0x194)]=0x3,this['logger']=new core_1[(_0xf93a1(0x15f))](SalesforceCommitsManager['name']),this[_0xf93a1(0x156)]=this[_0xf93a1(0x170)][_0xf93a1(0x14a)],this[_0xf93a1(0x16f)]=typedi_1[_0xf93a1(0x154)][_0xf93a1(0x183)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0xf93a1(0x165)]=[];}async[a270_0x533348(0x172)](_0x8f229e,_0x608b0f=![]){const _0x57bb43=a270_0x533348,_0xb2fe8a=async _0x4c4674=>{const _0x1c4e60=a270_0x5889;await this['logger'][_0x1c4e60(0x162)](_0x1c4e60(0x177)+_0x4c4674['reduce']((_0x14a35a,_0x4ae608)=>_0x14a35a+_0x4ae608[_0x1c4e60(0x150)],0x0)+_0x1c4e60(0x193));const _0x484ae7=_0x4c4674[_0x1c4e60(0x17d)]((_0x3058f5,_0x589d29)=>({'graphId':_0x1c4e60(0x149)+_0x589d29,'compositeRequest':_0x3058f5})),_0x176a8e=await this['composite'][_0x1c4e60(0x15c)](_0x484ae7);if(_0x608b0f){const _0x3ddfde=(0x0,composite_utils_1[_0x1c4e60(0x18c)])(_0x176a8e);for(const {id:_0x280b3f,ref:_0x57ccf0}of _0x3ddfde){const _0x598858=this[_0x1c4e60(0x165)][_0x1c4e60(0x187)](_0x3503e8=>_0x3503e8[_0x1c4e60(0x17e)]===_0x57ccf0);_0x598858&&(_0x598858[_0x1c4e60(0x191)]=_0x280b3f);}}},_0x4438f5=0x1e8480;let _0x5c0706=0x0,_0x2cd9a7=[];for(const _0x3fc40d of _0x8f229e){const _0x2cef46=_0x3fc40d['reduce']((_0x24f17c,_0x177575)=>{const _0x574b93=a270_0x5889,_0x561550=JSON[_0x574b93(0x17a)](_0x177575)[_0x574b93(0x150)]*0x2;return _0x24f17c+_0x561550;},0x0);if(_0x2cef46>constants_1[_0x57bb43(0x16e)])throw new salesforce_error_1[(_0x57bb43(0x16c))](_0x57bb43(0x184)+constants_1[_0x57bb43(0x16e)]+_0x57bb43(0x176)+_0x2cef46);_0x5c0706+_0x2cef46>constants_1[_0x57bb43(0x16e)]-_0x4438f5&&(await _0xb2fe8a(_0x2cd9a7),_0x2cd9a7=[],_0x5c0706=0x0),_0x5c0706+=_0x2cef46,_0x2cd9a7[_0x57bb43(0x173)](_0x3fc40d);}_0x2cd9a7['length']&&await _0xb2fe8a(_0x2cd9a7);}async[a270_0x533348(0x163)](_0x52d92d,_0x269e91=![]){const _0x353255=a270_0x533348,_0x250b18=(this[_0x353255(0x194)]+ +_0x269e91)*0x3,_0x58c154=(0x0,utils_1[_0x353255(0x14c)])(_0x52d92d,_0x250b18);try{while(_0x58c154[_0x353255(0x150)]){const _0x3858db=_0x58c154[_0x353255(0x182)](0x0,Math[_0x353255(0x153)](constants_1[_0x353255(0x18b)]/_0x250b18));await this[_0x353255(0x172)](_0x3858db,_0x269e91);}}catch(_0x50bd02){this['logger'][_0x353255(0x186)](_0x50bd02 instanceof salesforce_error_1[_0x353255(0x16c)]?JSON[_0x353255(0x17a)](_0x50bd02['toJSON'](),null,0x2):_0x50bd02),this[_0x353255(0x156)][_0x353255(0x162)](_0x50bd02 instanceof salesforce_error_1['SalesforceError']?JSON[_0x353255(0x17a)](_0x50bd02[_0x353255(0x18a)](),null,0x2):_0x50bd02['toString']());throw _0x50bd02;}}async['proceedCommitsToRepository'](_0x5b0345){const _0x19a6c0=a270_0x533348;for(const _0x15b02b of _0x5b0345){if(!_0x15b02b[_0x19a6c0(0x195)]['length']&&!_0x15b02b[_0x19a6c0(0x161)][_0x19a6c0(0x150)]&&!_0x15b02b[_0x19a6c0(0x190)][_0x19a6c0(0x150)])continue;const _0xc688f2=[],_0x1ad382=[],_0x7bcc14=new salesforce_components_manager_service_1[(_0x19a6c0(0x168))](this[_0x19a6c0(0x170)][_0x19a6c0(0x157)],this[_0x19a6c0(0x170)][_0x19a6c0(0x155)],_0x15b02b[_0x19a6c0(0x147)],this['options'][_0x19a6c0(0x164)],this['proceededComponentsMeta']);_0xc688f2[_0x19a6c0(0x173)](...await _0x7bcc14[_0x19a6c0(0x192)](_0x15b02b[_0x19a6c0(0x195)],this[_0x19a6c0(0x170)][_0x19a6c0(0x18d)])),_0xc688f2[_0x19a6c0(0x173)](...await _0x7bcc14[_0x19a6c0(0x14b)](_0x15b02b['modified'],this[_0x19a6c0(0x170)][_0x19a6c0(0x18d)])),_0x1ad382['push'](await _0x7bcc14[_0x19a6c0(0x15b)](_0x15b02b['removed'],!![])),this[_0x19a6c0(0x165)]=_0x7bcc14[_0x19a6c0(0x166)](),await this[_0x19a6c0(0x163)](_0xc688f2,!![]);for(const _0x5710ed of _0x1ad382){_0x5710ed[_0x19a6c0(0x146)]['length']&&await this[_0x19a6c0(0x163)](_0x5710ed[_0x19a6c0(0x146)],!![]),_0x5710ed[_0x19a6c0(0x148)][_0x19a6c0(0x150)]&&await this[_0x19a6c0(0x163)](_0x5710ed[_0x19a6c0(0x148)],!![]),_0x5710ed['componentsToDelete'][_0x19a6c0(0x150)]&&await this[_0x19a6c0(0x163)](_0x5710ed[_0x19a6c0(0x160)],!![]);}this['logger']['log'](_0x19a6c0(0x175),_0xc688f2[_0x19a6c0(0x150)]);}}async[a270_0x533348(0x159)](_0x41cbdb){const _0x5e7822=a270_0x533348,_0x170188=[],_0x1ad724=[];for(const _0x49b72a of _0x41cbdb){if(!_0x49b72a['inserted'][_0x5e7822(0x150)]&&!_0x49b72a['modified'][_0x5e7822(0x150)]&&!_0x49b72a[_0x5e7822(0x190)]['length'])continue;const _0x34dcd1=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this['options'][_0x5e7822(0x157)],this['options'][_0x5e7822(0x155)],_0x49b72a[_0x5e7822(0x147)],this[_0x5e7822(0x170)][_0x5e7822(0x164)],[]);_0x170188[_0x5e7822(0x173)](...await _0x34dcd1[_0x5e7822(0x192)](_0x49b72a[_0x5e7822(0x195)])),_0x170188[_0x5e7822(0x173)](...await _0x34dcd1['update'](_0x49b72a[_0x5e7822(0x161)])),_0x1ad724['push'](await _0x34dcd1[_0x5e7822(0x15b)](_0x49b72a['removed']));}this[_0x5e7822(0x14a)][_0x5e7822(0x162)](_0x5e7822(0x16d),_0x170188[_0x5e7822(0x150)]),await this['proceedRequests'](_0x170188);const _0x4ce002=_0x1ad724['reduce']((_0x94db1,_0x43f169)=>({'manifests':[..._0x94db1[_0x5e7822(0x146)],..._0x43f169[_0x5e7822(0x146)]],'componentsToDelete':[..._0x94db1[_0x5e7822(0x160)],..._0x43f169[_0x5e7822(0x160)]],'componentsToUpdate':[..._0x94db1[_0x5e7822(0x148)],..._0x43f169[_0x5e7822(0x148)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x4ce002[_0x5e7822(0x146)][_0x5e7822(0x150)]&&await this['proceedRequests'](_0x4ce002[_0x5e7822(0x146)],!![]),_0x4ce002[_0x5e7822(0x148)][_0x5e7822(0x150)]&&await this[_0x5e7822(0x163)](_0x4ce002['componentsToUpdate'],!![]),_0x4ce002[_0x5e7822(0x160)]['length']&&await this['proceedRequests'](_0x4ce002[_0x5e7822(0x160)],!![]);}async[a270_0x533348(0x15a)](_0x89a936){const _0x1a2697=a270_0x533348;this[_0x1a2697(0x170)][_0x1a2697(0x155)]?await this['proceedCommitsToBranch'](_0x89a936):await this['proceedCommitsToRepository'](_0x89a936);}}exports[a270_0x533348(0x171)]=SalesforceCommitsManager;function a270_0x4d2f(){const _0x505cc6=['\x20COMPONENTS_SIZE\x20=\x20','Sending\x20','toString','5360AHKdQU','stringify','../../../../core','1440111rlXmSF','map','reference','25512lvMwjC','__importDefault','../utils/composite.utils','splice','get','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','../../../../constants','error','find','typedi','apply','toJSON','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','extractComponentIdsFromGraphsResponse','commitId','./salesforce-composite.service','__esModule','removed','componentId','insert','\x20requests\x20to\x20composite\x20api.','COMPONENTS_PER_CHUNK','inserted','manifests','author','componentsToUpdate','graph','logger','update','chunkArray','4JqSXso','11436sAjlxp','226avyZea','length','./salesforce-components-manager.service','3681657VeDLmu','floor','default','branchId','sfLogger','repositoryId','2612780lGONiv','proceedCommitsToBranch','proceedCommits','delete','executeGraphs','search','513kUKlSi','Logger','componentsToDelete','modified','log','proceedRequests','recordTypes','proceededComponentsMeta','getProceededComponentsMeta','1809900KHwWRT','SalesforceComponentsManager','defineProperty','(((.+)+)+)+$','6GWXmsO','SalesforceError','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','SALESFORCE_MAX_REQUEST_SIZE_BYTES','composite','options','SalesforceCommitsManager','proceedChunksToUpload','push','3036XuXHHB','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)'];a270_0x4d2f=function(){return _0x505cc6;};return a270_0x4d2f();}