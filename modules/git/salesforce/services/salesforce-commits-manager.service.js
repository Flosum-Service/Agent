const a233_0x2755c9=a233_0x2b02;(function(_0x4b4b38,_0x36c616){const _0x59885c=a233_0x2b02,_0x3c6083=_0x4b4b38();while(!![]){try{const _0x5d2ee0=parseInt(_0x59885c(0x187))/0x1+parseInt(_0x59885c(0x194))/0x2+parseInt(_0x59885c(0x16a))/0x3*(parseInt(_0x59885c(0x19b))/0x4)+parseInt(_0x59885c(0x188))/0x5+parseInt(_0x59885c(0x16b))/0x6*(parseInt(_0x59885c(0x19f))/0x7)+parseInt(_0x59885c(0x192))/0x8*(-parseInt(_0x59885c(0x15f))/0x9)+-parseInt(_0x59885c(0x1ab))/0xa;if(_0x5d2ee0===_0x36c616)break;else _0x3c6083['push'](_0x3c6083['shift']());}catch(_0x8a069c){_0x3c6083['push'](_0x3c6083['shift']());}}}(a233_0x1e4f,0xb96b3));const a233_0xfa0587=(function(){let _0x23ec53=!![];return function(_0x5d4f18,_0x36c2fd){const _0x45bbc7=_0x23ec53?function(){if(_0x36c2fd){const _0x471368=_0x36c2fd['apply'](_0x5d4f18,arguments);return _0x36c2fd=null,_0x471368;}}:function(){};return _0x23ec53=![],_0x45bbc7;};}()),a233_0x15616a=a233_0xfa0587(this,function(){const _0x5b2621=a233_0x2b02;return a233_0x15616a[_0x5b2621(0x1a9)]()['search'](_0x5b2621(0x1a8))[_0x5b2621(0x1a9)]()[_0x5b2621(0x18b)](a233_0x15616a)[_0x5b2621(0x161)](_0x5b2621(0x1a8));});a233_0x15616a();function a233_0x2b02(_0x4edab8,_0x5e1e9f){const _0x4ff124=a233_0x1e4f();return a233_0x2b02=function(_0x15616a,_0xfa0587){_0x15616a=_0x15616a-0x15e;let _0x1e4fc6=_0x4ff124[_0x15616a];return _0x1e4fc6;},a233_0x2b02(_0x4edab8,_0x5e1e9f);}'use strict';var __importDefault=this&&this[a233_0x2755c9(0x1a7)]||function(_0x4f612c){return _0x4f612c&&_0x4f612c['__esModule']?_0x4f612c:{'default':_0x4f612c};};Object[a233_0x2755c9(0x1a1)](exports,a233_0x2755c9(0x17d),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;function a233_0x1e4f(){const _0x5edb7c=['stringify','__esModule','get','author','../errors/salesforce.error','graph','toJSON','map','chunkArray','SalesforceCompositeService','proceededComponentsMeta','26095GvzNNn','6139375NhVfkW','componentsToUpdate','manifests','constructor','delete','recordTypes','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','./salesforce-composite.service','log','executeGraphs','161512upzgcg','error','112000eQUAVo','proceedRequests','removed','../../../../constants','SalesforceCommitsManager','SalesforceComponentsManager','length','28fifTqw','update','../utils/composite.utils','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','569555pAFjWI','reduce','defineProperty','branchId','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','proceedCommits','name','options','__importDefault','(((.+)+)+)+$','toString','proceedCommitsToRepository','13172680iiWmdq','commitId','Logger','../../../../core','450FloeUe','Sending\x20','search','insert','componentId','push','SalesforceError','default','componentsToDelete','reference','\x20COMPONENTS_SIZE\x20=\x20','447402Uftuwd','54fQaDTE','modified','proceedChunksToUpload','extractComponentIdsFromGraphsResponse','./salesforce-components-manager.service','splice','proceedCommitsToBranch','repositoryId','inserted','typedi','find','composite','sfLogger','\x20requests\x20to\x20composite\x20api.','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','logger','SALESFORCE_MAX_REQUEST_SIZE_BYTES'];a233_0x1e4f=function(){return _0x5edb7c;};return a233_0x1e4f();}const core_1=require(a233_0x2755c9(0x15e)),typedi_1=__importDefault(require(a233_0x2755c9(0x174))),constants_1=require(a233_0x2755c9(0x197)),utils_1=require('../../../shared/utils'),salesforce_error_1=require(a233_0x2755c9(0x180)),composite_utils_1=require(a233_0x2755c9(0x19d)),salesforce_components_manager_service_1=require(a233_0x2755c9(0x16f)),salesforce_composite_service_1=require(a233_0x2755c9(0x18f));class SalesforceCommitsManager{constructor(_0x1af689){const _0x39938a=a233_0x2755c9;this[_0x39938a(0x1a6)]=_0x1af689,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x39938a(0x17a)]=new core_1[(_0x39938a(0x1ad))](SalesforceCommitsManager[_0x39938a(0x1a5)]),this[_0x39938a(0x177)]=this[_0x39938a(0x1a6)]['logger'],this[_0x39938a(0x176)]=typedi_1[_0x39938a(0x166)][_0x39938a(0x17e)](salesforce_composite_service_1[_0x39938a(0x185)]),this[_0x39938a(0x186)]=[];}async[a233_0x2755c9(0x16d)](_0x582a37,_0x710f4=![]){const _0x4e66dd=a233_0x2755c9,_0x3423b7=async _0xb7a5e3=>{const _0x11dab1=a233_0x2b02;await this[_0x11dab1(0x17a)]['log'](_0x11dab1(0x160)+_0xb7a5e3[_0x11dab1(0x1a0)]((_0x28575b,_0x52f780)=>_0x28575b+_0x52f780[_0x11dab1(0x19a)],0x0)+_0x11dab1(0x178));const _0x1c8a84=_0xb7a5e3[_0x11dab1(0x183)]((_0x75f9f5,_0x10c88a)=>({'graphId':_0x11dab1(0x181)+_0x10c88a,'compositeRequest':_0x75f9f5})),_0x5b125c=await this[_0x11dab1(0x176)][_0x11dab1(0x191)](_0x1c8a84);if(_0x710f4){const _0x588013=(0x0,composite_utils_1[_0x11dab1(0x16e)])(_0x5b125c);for(const {id:_0x18c955,ref:_0x4d78a5}of _0x588013){const _0x1eb7f2=this[_0x11dab1(0x186)][_0x11dab1(0x175)](_0x49cc8d=>_0x49cc8d[_0x11dab1(0x168)]===_0x4d78a5);_0x1eb7f2&&(_0x1eb7f2[_0x11dab1(0x163)]=_0x18c955);}}},_0x477f93=0x1e8480;let _0x41096c=0x0,_0x2ff802=[];for(const _0x12158d of _0x582a37){const _0x111e2a=_0x12158d[_0x4e66dd(0x1a0)]((_0x2d89c6,_0x5cd14c)=>{const _0x12a057=_0x4e66dd,_0x14658c=JSON[_0x12a057(0x17c)](_0x5cd14c)['length']*0x2;return _0x2d89c6+_0x14658c;},0x0);if(_0x111e2a>constants_1[_0x4e66dd(0x17b)])throw new salesforce_error_1[(_0x4e66dd(0x165))](_0x4e66dd(0x18e)+constants_1[_0x4e66dd(0x17b)]+_0x4e66dd(0x169)+_0x111e2a);_0x41096c+_0x111e2a>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x477f93&&(await _0x3423b7(_0x2ff802),_0x2ff802=[],_0x41096c=0x0),_0x41096c+=_0x111e2a,_0x2ff802[_0x4e66dd(0x164)](_0x12158d);}_0x2ff802['length']&&await _0x3423b7(_0x2ff802);}async[a233_0x2755c9(0x195)](_0x362205,_0x470d08=![]){const _0x6056f1=a233_0x2755c9,_0x17a688=(this['COMPONENTS_PER_CHUNK']+ +_0x470d08)*0x3,_0x43e567=(0x0,utils_1[_0x6056f1(0x184)])(_0x362205,_0x17a688);try{while(_0x43e567[_0x6056f1(0x19a)]){const _0x4bdca6=_0x43e567[_0x6056f1(0x170)](0x0,Math['floor'](constants_1[_0x6056f1(0x19e)]/_0x17a688));await this['proceedChunksToUpload'](_0x4bdca6,_0x470d08);}}catch(_0x3f142b){this[_0x6056f1(0x17a)][_0x6056f1(0x193)](_0x3f142b instanceof salesforce_error_1[_0x6056f1(0x165)]?JSON['stringify'](_0x3f142b[_0x6056f1(0x182)](),null,0x2):_0x3f142b),this[_0x6056f1(0x177)][_0x6056f1(0x190)](_0x3f142b instanceof salesforce_error_1[_0x6056f1(0x165)]?JSON[_0x6056f1(0x17c)](_0x3f142b[_0x6056f1(0x182)](),null,0x2):_0x3f142b['toString']());throw _0x3f142b;}}async[a233_0x2755c9(0x1aa)](_0x5c2881){const _0x3d3b87=a233_0x2755c9;for(const _0xb38d20 of _0x5c2881){if(!_0xb38d20['inserted'][_0x3d3b87(0x19a)]&&!_0xb38d20[_0x3d3b87(0x16c)][_0x3d3b87(0x19a)]&&!_0xb38d20[_0x3d3b87(0x196)][_0x3d3b87(0x19a)])continue;const _0x24beb4=[],_0x38ef25=[],_0x544a0e=new salesforce_components_manager_service_1[(_0x3d3b87(0x199))](this['options'][_0x3d3b87(0x172)],this[_0x3d3b87(0x1a6)][_0x3d3b87(0x1a2)],_0xb38d20[_0x3d3b87(0x17f)],this['options'][_0x3d3b87(0x18d)],this[_0x3d3b87(0x186)]);_0x24beb4[_0x3d3b87(0x164)](...await _0x544a0e['insert'](_0xb38d20[_0x3d3b87(0x173)],this[_0x3d3b87(0x1a6)][_0x3d3b87(0x1ac)])),_0x24beb4[_0x3d3b87(0x164)](...await _0x544a0e[_0x3d3b87(0x19c)](_0xb38d20[_0x3d3b87(0x16c)],this[_0x3d3b87(0x1a6)][_0x3d3b87(0x1ac)])),_0x38ef25[_0x3d3b87(0x164)](await _0x544a0e[_0x3d3b87(0x18c)](_0xb38d20[_0x3d3b87(0x196)],!![])),this[_0x3d3b87(0x186)]=_0x544a0e['getProceededComponentsMeta'](),await this[_0x3d3b87(0x195)](_0x24beb4,!![]);for(const _0x7219f4 of _0x38ef25){_0x7219f4[_0x3d3b87(0x18a)][_0x3d3b87(0x19a)]&&await this[_0x3d3b87(0x195)](_0x7219f4['manifests'],!![]),_0x7219f4[_0x3d3b87(0x189)][_0x3d3b87(0x19a)]&&await this[_0x3d3b87(0x195)](_0x7219f4['componentsToUpdate'],!![]),_0x7219f4[_0x3d3b87(0x167)][_0x3d3b87(0x19a)]&&await this[_0x3d3b87(0x195)](_0x7219f4['componentsToDelete'],!![]);}this['logger'][_0x3d3b87(0x190)](_0x3d3b87(0x1a3),_0x24beb4[_0x3d3b87(0x19a)]);}}async[a233_0x2755c9(0x171)](_0x90ff1f){const _0x50c51f=a233_0x2755c9,_0x361b92=[],_0x3e6ade=[];for(const _0x3d32ca of _0x90ff1f){if(!_0x3d32ca[_0x50c51f(0x173)][_0x50c51f(0x19a)]&&!_0x3d32ca[_0x50c51f(0x16c)][_0x50c51f(0x19a)]&&!_0x3d32ca[_0x50c51f(0x196)]['length'])continue;const _0x2a4750=new salesforce_components_manager_service_1[(_0x50c51f(0x199))](this['options'][_0x50c51f(0x172)],this['options'][_0x50c51f(0x1a2)],_0x3d32ca['author'],this[_0x50c51f(0x1a6)][_0x50c51f(0x18d)],[]);_0x361b92[_0x50c51f(0x164)](...await _0x2a4750[_0x50c51f(0x162)](_0x3d32ca[_0x50c51f(0x173)])),_0x361b92[_0x50c51f(0x164)](...await _0x2a4750['update'](_0x3d32ca[_0x50c51f(0x16c)])),_0x3e6ade[_0x50c51f(0x164)](await _0x2a4750['delete'](_0x3d32ca['removed']));}this[_0x50c51f(0x17a)][_0x50c51f(0x190)](_0x50c51f(0x179),_0x361b92[_0x50c51f(0x19a)]),await this['proceedRequests'](_0x361b92);const _0x396b73=_0x3e6ade[_0x50c51f(0x1a0)]((_0x26712d,_0x1e6a25)=>({'manifests':[..._0x26712d['manifests'],..._0x1e6a25[_0x50c51f(0x18a)]],'componentsToDelete':[..._0x26712d[_0x50c51f(0x167)],..._0x1e6a25['componentsToDelete']],'componentsToUpdate':[..._0x26712d[_0x50c51f(0x189)],..._0x1e6a25[_0x50c51f(0x189)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x396b73[_0x50c51f(0x18a)][_0x50c51f(0x19a)]&&await this[_0x50c51f(0x195)](_0x396b73[_0x50c51f(0x18a)],!![]),_0x396b73[_0x50c51f(0x189)][_0x50c51f(0x19a)]&&await this[_0x50c51f(0x195)](_0x396b73[_0x50c51f(0x189)],!![]),_0x396b73['componentsToDelete'][_0x50c51f(0x19a)]&&await this[_0x50c51f(0x195)](_0x396b73[_0x50c51f(0x167)],!![]);}async[a233_0x2755c9(0x1a4)](_0x1bd8e7){const _0x2be8c6=a233_0x2755c9;this[_0x2be8c6(0x1a6)]['branchId']?await this['proceedCommitsToBranch'](_0x1bd8e7):await this[_0x2be8c6(0x1aa)](_0x1bd8e7);}}exports[a233_0x2755c9(0x198)]=SalesforceCommitsManager;