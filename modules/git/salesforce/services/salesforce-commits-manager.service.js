const a233_0x4c1aff=a233_0x2be2;(function(_0x46b6c3,_0x1a8724){const _0xc137c5=a233_0x2be2,_0x1bc005=_0x46b6c3();while(!![]){try{const _0x36bba5=-parseInt(_0xc137c5(0x168))/0x1+-parseInt(_0xc137c5(0x149))/0x2*(parseInt(_0xc137c5(0x15d))/0x3)+parseInt(_0xc137c5(0x16b))/0x4*(parseInt(_0xc137c5(0x144))/0x5)+parseInt(_0xc137c5(0x160))/0x6*(-parseInt(_0xc137c5(0x174))/0x7)+-parseInt(_0xc137c5(0x175))/0x8*(-parseInt(_0xc137c5(0x159))/0x9)+parseInt(_0xc137c5(0x132))/0xa+parseInt(_0xc137c5(0x141))/0xb;if(_0x36bba5===_0x1a8724)break;else _0x1bc005['push'](_0x1bc005['shift']());}catch(_0x678671){_0x1bc005['push'](_0x1bc005['shift']());}}}(a233_0x9009,0x6b80a));const a233_0xbdc57=(function(){let _0x3cf71b=!![];return function(_0x33721e,_0x816872){const _0x46b724=_0x3cf71b?function(){const _0x16bd78=a233_0x2be2;if(_0x816872){const _0x1e0ebe=_0x816872[_0x16bd78(0x17d)](_0x33721e,arguments);return _0x816872=null,_0x1e0ebe;}}:function(){};return _0x3cf71b=![],_0x46b724;};}()),a233_0x280d01=a233_0xbdc57(this,function(){const _0x5901e1=a233_0x2be2;return a233_0x280d01[_0x5901e1(0x14d)]()[_0x5901e1(0x13a)](_0x5901e1(0x164))[_0x5901e1(0x14d)]()['constructor'](a233_0x280d01)[_0x5901e1(0x13a)]('(((.+)+)+)+$');});function a233_0x9009(){const _0x551e0f=['1624wRlzee','get','__esModule','default','update','COMPONENTS_PER_CHUNK','sfLogger','author','apply','error','2884290ISkjjk','SalesforceCommitsManager','graph','floor','commitId','chunkArray','push','delete','search','typedi','__importDefault','./salesforce-composite.service','composite','stringify','componentsToUpdate','11910690fSeKcE','modified','proceedChunksToUpload','3094035SfsJlx','repositoryId','branchId','defineProperty','../utils/composite.utils','692WzSTwZ','toJSON','reduce','inserted','toString','log','componentsToDelete','../../../../core','proceedCommitsToBranch','proceedCommitsToRepository','manifests','SALESFORCE_MAX_REQUEST_SIZE_BYTES','insert','SalesforceComponentsManager','proceedRequests','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','11133vUsEzs','logger','executeGraphs','\x20COMPONENTS_SIZE\x20=\x20','6120QvTOOk','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','recordTypes','1614mkPkAw','Logger','../../../shared/utils','\x20requests\x20to\x20composite\x20api.','(((.+)+)+)+$','getProceededComponentsMeta','componentId','./salesforce-components-manager.service','521728XxxMOa','map','removed','4OqMgJb','options','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','SalesforceError','proceededComponentsMeta','Sending\x20','find','length','splice','14917JNOFWW'];a233_0x9009=function(){return _0x551e0f;};return a233_0x9009();}a233_0x280d01();'use strict';var __importDefault=this&&this[a233_0x4c1aff(0x13c)]||function(_0x9b3abe){const _0x243405=a233_0x4c1aff;return _0x9b3abe&&_0x9b3abe[_0x243405(0x177)]?_0x9b3abe:{'default':_0x9b3abe};};function a233_0x2be2(_0x4b8bf2,_0xdc9629){const _0x4b71fb=a233_0x9009();return a233_0x2be2=function(_0x280d01,_0xbdc57){_0x280d01=_0x280d01-0x131;let _0x90092e=_0x4b71fb[_0x280d01];return _0x90092e;},a233_0x2be2(_0x4b8bf2,_0xdc9629);}Object[a233_0x4c1aff(0x147)](exports,'__esModule',{'value':!![]}),exports[a233_0x4c1aff(0x133)]=void 0x0;const core_1=require(a233_0x4c1aff(0x150)),typedi_1=__importDefault(require(a233_0x4c1aff(0x13b))),constants_1=require('../../../../constants'),utils_1=require(a233_0x4c1aff(0x162)),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a233_0x4c1aff(0x148)),salesforce_components_manager_service_1=require(a233_0x4c1aff(0x167)),salesforce_composite_service_1=require(a233_0x4c1aff(0x13d));class SalesforceCommitsManager{constructor(_0x2efc30){const _0x473e9d=a233_0x4c1aff;this[_0x473e9d(0x16c)]=_0x2efc30,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x473e9d(0x15a)]=new core_1[(_0x473e9d(0x161))](SalesforceCommitsManager['name']),this[_0x473e9d(0x17b)]=this[_0x473e9d(0x16c)][_0x473e9d(0x15a)],this[_0x473e9d(0x13e)]=typedi_1[_0x473e9d(0x178)][_0x473e9d(0x176)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x473e9d(0x16f)]=[];}async[a233_0x4c1aff(0x143)](_0x58f864,_0x3be4dc=![]){const _0x20efcb=a233_0x4c1aff,_0x474ace=async _0x58e382=>{const _0x566ead=a233_0x2be2;await this[_0x566ead(0x15a)][_0x566ead(0x14e)](_0x566ead(0x170)+_0x58e382[_0x566ead(0x14b)]((_0x514753,_0x2305a3)=>_0x514753+_0x2305a3[_0x566ead(0x172)],0x0)+_0x566ead(0x163));const _0x923aec=_0x58e382[_0x566ead(0x169)]((_0x1d3202,_0x4e6784)=>({'graphId':_0x566ead(0x134)+_0x4e6784,'compositeRequest':_0x1d3202})),_0x3bf6d2=await this[_0x566ead(0x13e)][_0x566ead(0x15b)](_0x923aec);if(_0x3be4dc){const _0x659bf1=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x3bf6d2);for(const {id:_0x61bc7e,ref:_0x1ae621}of _0x659bf1){const _0x4a07eb=this[_0x566ead(0x16f)][_0x566ead(0x171)](_0x5183dd=>_0x5183dd['reference']===_0x1ae621);_0x4a07eb&&(_0x4a07eb[_0x566ead(0x166)]=_0x61bc7e);}}},_0x4dfddc=0x1e8480;let _0x2634b3=0x0,_0x34689c=[];for(const _0x5bf6d9 of _0x58f864){const _0xcb3756=_0x5bf6d9[_0x20efcb(0x14b)]((_0x26c2d2,_0x5b5da6)=>{const _0x5d4503=_0x20efcb,_0x5f4eac=JSON[_0x5d4503(0x13f)](_0x5b5da6)[_0x5d4503(0x172)]*0x2;return _0x26c2d2+_0x5f4eac;},0x0);if(_0xcb3756>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1[(_0x20efcb(0x16e))](_0x20efcb(0x158)+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+_0x20efcb(0x15c)+_0xcb3756);_0x2634b3+_0xcb3756>constants_1[_0x20efcb(0x154)]-_0x4dfddc&&(await _0x474ace(_0x34689c),_0x34689c=[],_0x2634b3=0x0),_0x2634b3+=_0xcb3756,_0x34689c[_0x20efcb(0x138)](_0x5bf6d9);}_0x34689c[_0x20efcb(0x172)]&&await _0x474ace(_0x34689c);}async[a233_0x4c1aff(0x157)](_0x430718,_0x2e3cb8=![]){const _0x49da11=a233_0x4c1aff,_0x31a980=(this[_0x49da11(0x17a)]+ +_0x2e3cb8)*0x3,_0x13c68a=(0x0,utils_1[_0x49da11(0x137)])(_0x430718,_0x31a980);try{while(_0x13c68a[_0x49da11(0x172)]){const _0x4ee741=_0x13c68a[_0x49da11(0x173)](0x0,Math[_0x49da11(0x135)](constants_1[_0x49da11(0x16d)]/_0x31a980));await this[_0x49da11(0x143)](_0x4ee741,_0x2e3cb8);}}catch(_0x2452dc){this[_0x49da11(0x15a)][_0x49da11(0x131)](_0x2452dc instanceof salesforce_error_1[_0x49da11(0x16e)]?JSON[_0x49da11(0x13f)](_0x2452dc[_0x49da11(0x14a)](),null,0x2):_0x2452dc),this[_0x49da11(0x17b)][_0x49da11(0x14e)](_0x2452dc instanceof salesforce_error_1[_0x49da11(0x16e)]?JSON[_0x49da11(0x13f)](_0x2452dc[_0x49da11(0x14a)](),null,0x2):_0x2452dc['toString']());throw _0x2452dc;}}async[a233_0x4c1aff(0x152)](_0x4b4927){const _0xff3614=a233_0x4c1aff;for(const _0x3e0219 of _0x4b4927){if(!_0x3e0219[_0xff3614(0x14c)]['length']&&!_0x3e0219[_0xff3614(0x142)]['length']&&!_0x3e0219[_0xff3614(0x16a)]['length'])continue;const _0x3c79ac=[],_0xe36d70=[],_0x52560b=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0xff3614(0x16c)][_0xff3614(0x145)],this[_0xff3614(0x16c)]['branchId'],_0x3e0219[_0xff3614(0x17c)],this[_0xff3614(0x16c)][_0xff3614(0x15f)],this[_0xff3614(0x16f)]);_0x3c79ac[_0xff3614(0x138)](...await _0x52560b[_0xff3614(0x155)](_0x3e0219['inserted'],this[_0xff3614(0x16c)][_0xff3614(0x136)])),_0x3c79ac[_0xff3614(0x138)](...await _0x52560b[_0xff3614(0x179)](_0x3e0219[_0xff3614(0x142)],this['options'][_0xff3614(0x136)])),_0xe36d70[_0xff3614(0x138)](await _0x52560b['delete'](_0x3e0219[_0xff3614(0x16a)],!![])),this[_0xff3614(0x16f)]=_0x52560b[_0xff3614(0x165)](),await this['proceedRequests'](_0x3c79ac,!![]);for(const _0x31c4d0 of _0xe36d70){_0x31c4d0[_0xff3614(0x153)][_0xff3614(0x172)]&&await this[_0xff3614(0x157)](_0x31c4d0['manifests'],!![]),_0x31c4d0[_0xff3614(0x140)][_0xff3614(0x172)]&&await this[_0xff3614(0x157)](_0x31c4d0[_0xff3614(0x140)],!![]),_0x31c4d0[_0xff3614(0x14f)][_0xff3614(0x172)]&&await this[_0xff3614(0x157)](_0x31c4d0[_0xff3614(0x14f)],!![]);}this['logger']['log'](_0xff3614(0x15e),_0x3c79ac['length']);}}async[a233_0x4c1aff(0x151)](_0x3d4006){const _0x45debd=a233_0x4c1aff,_0x560f9a=[],_0x52ea0c=[];for(const _0x3a0737 of _0x3d4006){if(!_0x3a0737[_0x45debd(0x14c)][_0x45debd(0x172)]&&!_0x3a0737[_0x45debd(0x142)][_0x45debd(0x172)]&&!_0x3a0737[_0x45debd(0x16a)][_0x45debd(0x172)])continue;const _0x5db9d2=new salesforce_components_manager_service_1[(_0x45debd(0x156))](this[_0x45debd(0x16c)][_0x45debd(0x145)],this[_0x45debd(0x16c)][_0x45debd(0x146)],_0x3a0737['author'],this[_0x45debd(0x16c)][_0x45debd(0x15f)],[]);_0x560f9a[_0x45debd(0x138)](...await _0x5db9d2[_0x45debd(0x155)](_0x3a0737[_0x45debd(0x14c)])),_0x560f9a[_0x45debd(0x138)](...await _0x5db9d2[_0x45debd(0x179)](_0x3a0737[_0x45debd(0x142)])),_0x52ea0c[_0x45debd(0x138)](await _0x5db9d2[_0x45debd(0x139)](_0x3a0737[_0x45debd(0x16a)]));}this[_0x45debd(0x15a)][_0x45debd(0x14e)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x560f9a['length']),await this[_0x45debd(0x157)](_0x560f9a);const _0x52e8b1=_0x52ea0c[_0x45debd(0x14b)]((_0x3e4e84,_0x450fb5)=>({'manifests':[..._0x3e4e84[_0x45debd(0x153)],..._0x450fb5[_0x45debd(0x153)]],'componentsToDelete':[..._0x3e4e84['componentsToDelete'],..._0x450fb5[_0x45debd(0x14f)]],'componentsToUpdate':[..._0x3e4e84[_0x45debd(0x140)],..._0x450fb5[_0x45debd(0x140)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x52e8b1[_0x45debd(0x153)][_0x45debd(0x172)]&&await this[_0x45debd(0x157)](_0x52e8b1[_0x45debd(0x153)],!![]),_0x52e8b1[_0x45debd(0x140)]['length']&&await this[_0x45debd(0x157)](_0x52e8b1[_0x45debd(0x140)],!![]),_0x52e8b1['componentsToDelete'][_0x45debd(0x172)]&&await this[_0x45debd(0x157)](_0x52e8b1[_0x45debd(0x14f)],!![]);}async['proceedCommits'](_0x4fcccf){const _0x15eba1=a233_0x4c1aff;this[_0x15eba1(0x16c)][_0x15eba1(0x146)]?await this[_0x15eba1(0x151)](_0x4fcccf):await this[_0x15eba1(0x152)](_0x4fcccf);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;