const a272_0xe55ba7=a272_0x3cb2;(function(_0x5343ae,_0x19c990){const _0x42c03f=a272_0x3cb2,_0x34bfe8=_0x5343ae();while(!![]){try{const _0x441831=-parseInt(_0x42c03f(0xc3))/0x1+-parseInt(_0x42c03f(0xeb))/0x2*(parseInt(_0x42c03f(0xf6))/0x3)+-parseInt(_0x42c03f(0xea))/0x4*(parseInt(_0x42c03f(0xd5))/0x5)+-parseInt(_0x42c03f(0xe8))/0x6*(-parseInt(_0x42c03f(0xd0))/0x7)+-parseInt(_0x42c03f(0x105))/0x8*(parseInt(_0x42c03f(0xf1))/0x9)+-parseInt(_0x42c03f(0xdb))/0xa*(parseInt(_0x42c03f(0xcc))/0xb)+-parseInt(_0x42c03f(0x10b))/0xc*(-parseInt(_0x42c03f(0xe7))/0xd);if(_0x441831===_0x19c990)break;else _0x34bfe8['push'](_0x34bfe8['shift']());}catch(_0x3e83fc){_0x34bfe8['push'](_0x34bfe8['shift']());}}}(a272_0xb92b,0xabe9e));const a272_0x3a8a1e=(function(){let _0x256cd6=!![];return function(_0x249fbb,_0x38ec27){const _0x1dce36=_0x256cd6?function(){const _0x17a82b=a272_0x3cb2;if(_0x38ec27){const _0x1ee224=_0x38ec27[_0x17a82b(0xf8)](_0x249fbb,arguments);return _0x38ec27=null,_0x1ee224;}}:function(){};return _0x256cd6=![],_0x1dce36;};}()),a272_0x18e4c8=a272_0x3a8a1e(this,function(){const _0xcf493=a272_0x3cb2;return a272_0x18e4c8[_0xcf493(0xe1)]()['search'](_0xcf493(0x101))[_0xcf493(0xe1)]()['constructor'](a272_0x18e4c8)[_0xcf493(0xe3)](_0xcf493(0x101));});a272_0x18e4c8();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x367669){return _0x367669&&_0x367669['__esModule']?_0x367669:{'default':_0x367669};};function a272_0x3cb2(_0x31bdbf,_0x2fecc0){const _0x51594e=a272_0xb92b();return a272_0x3cb2=function(_0x18e4c8,_0x3a8a1e){_0x18e4c8=_0x18e4c8-0xc3;let _0xb92ba9=_0x51594e[_0x18e4c8];return _0xb92ba9;},a272_0x3cb2(_0x31bdbf,_0x2fecc0);}Object['defineProperty'](exports,a272_0xe55ba7(0xf3),{'value':!![]}),exports[a272_0xe55ba7(0xef)]=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require(a272_0xe55ba7(0xe0))),constants_1=require(a272_0xe55ba7(0xf0)),utils_1=require(a272_0xe55ba7(0xd1)),salesforce_error_1=require(a272_0xe55ba7(0xde)),composite_utils_1=require(a272_0xe55ba7(0xd6)),salesforce_components_manager_service_1=require(a272_0xe55ba7(0xd4)),salesforce_composite_service_1=require(a272_0xe55ba7(0xc7));class SalesforceCommitsManager{constructor(_0x2eff8e){const _0x5db3d1=a272_0xe55ba7;this[_0x5db3d1(0x100)]=_0x2eff8e,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x5db3d1(0xdf)]=new core_1[(_0x5db3d1(0xd7))](SalesforceCommitsManager[_0x5db3d1(0x102)]),this['sfLogger']=this['options'][_0x5db3d1(0xdf)],this[_0x5db3d1(0xe2)]=typedi_1[_0x5db3d1(0x107)][_0x5db3d1(0x104)](salesforce_composite_service_1[_0x5db3d1(0xdc)]),this[_0x5db3d1(0xe9)]=[];}async[a272_0xe55ba7(0x10c)](_0x47af5a,_0x267861=![]){const _0x3f1f75=a272_0xe55ba7,_0x1a7033=async _0x1beea2=>{const _0x145441=a272_0x3cb2;await this[_0x145441(0xdf)][_0x145441(0xda)]('Sending\x20'+_0x1beea2[_0x145441(0xce)]((_0x4abc34,_0x10fb09)=>_0x4abc34+_0x10fb09['length'],0x0)+_0x145441(0x103));const _0x19c4a8=_0x1beea2[_0x145441(0x109)]((_0x33b329,_0x3f0bc7)=>({'graphId':_0x145441(0xe4)+_0x3f0bc7,'compositeRequest':_0x33b329})),_0x38f7f7=await this[_0x145441(0xe2)][_0x145441(0xf2)](_0x19c4a8);if(_0x267861){const _0x544f32=(0x0,composite_utils_1[_0x145441(0x10a)])(_0x38f7f7);for(const {id:_0x37add5,ref:_0x460233}of _0x544f32){const _0x5d29c5=this[_0x145441(0xe9)]['find'](_0x1c77a1=>_0x1c77a1[_0x145441(0xfa)]===_0x460233);_0x5d29c5&&(_0x5d29c5[_0x145441(0x108)]=_0x37add5);}}},_0x5bb485=0x1e8480;let _0x39c84f=0x0,_0x2fe745=[];for(const _0x2492d5 of _0x47af5a){const _0x386031=_0x2492d5[_0x3f1f75(0xce)]((_0x45baa5,_0x44f52d)=>{const _0x36bba7=_0x3f1f75,_0x18c463=JSON[_0x36bba7(0xee)](_0x44f52d)['length']*0x2;return _0x45baa5+_0x18c463;},0x0);if(_0x386031>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1['SalesforceError']('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1[_0x3f1f75(0x106)]+'\x20COMPONENTS_SIZE\x20=\x20'+_0x386031);_0x39c84f+_0x386031>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x5bb485&&(await _0x1a7033(_0x2fe745),_0x2fe745=[],_0x39c84f=0x0),_0x39c84f+=_0x386031,_0x2fe745[_0x3f1f75(0xdd)](_0x2492d5);}_0x2fe745[_0x3f1f75(0xd3)]&&await _0x1a7033(_0x2fe745);}async[a272_0xe55ba7(0xd8)](_0x279df9,_0x4839e7=![]){const _0x8f84f0=a272_0xe55ba7,_0x4bcd30=(this[_0x8f84f0(0xc8)]+ +_0x4839e7)*0x3,_0x2f322b=(0x0,utils_1[_0x8f84f0(0xca)])(_0x279df9,_0x4bcd30);try{while(_0x2f322b[_0x8f84f0(0xd3)]){const _0x1a5045=_0x2f322b[_0x8f84f0(0x10d)](0x0,Math[_0x8f84f0(0xd2)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x4bcd30));await this[_0x8f84f0(0x10c)](_0x1a5045,_0x4839e7);}}catch(_0x4b447b){this[_0x8f84f0(0xdf)][_0x8f84f0(0xcd)](_0x4b447b instanceof salesforce_error_1[_0x8f84f0(0xf7)]?JSON['stringify'](_0x4b447b[_0x8f84f0(0xfc)](),null,0x2):_0x4b447b),this['sfLogger']['log'](_0x4b447b instanceof salesforce_error_1[_0x8f84f0(0xf7)]?JSON[_0x8f84f0(0xee)](_0x4b447b['toJSON'](),null,0x2):_0x4b447b[_0x8f84f0(0xe1)]());throw _0x4b447b;}}async[a272_0xe55ba7(0xc5)](_0x673aef){const _0x12a05d=a272_0xe55ba7;for(const _0xd04b90 of _0x673aef){if(!_0xd04b90[_0x12a05d(0xec)]['length']&&!_0xd04b90['modified']['length']&&!_0xd04b90[_0x12a05d(0xf9)][_0x12a05d(0xd3)])continue;const _0x1fe064=[],_0xe55a13=[],_0x1805c8=new salesforce_components_manager_service_1[(_0x12a05d(0xf5))](this[_0x12a05d(0x100)][_0x12a05d(0xc6)],this[_0x12a05d(0x100)]['branchId'],_0xd04b90[_0x12a05d(0xfd)],this[_0x12a05d(0x100)][_0x12a05d(0xc4)],this[_0x12a05d(0xe9)]);_0x1fe064[_0x12a05d(0xdd)](...await _0x1805c8[_0x12a05d(0xff)](_0xd04b90[_0x12a05d(0xec)],this[_0x12a05d(0x100)][_0x12a05d(0xe6)])),_0x1fe064['push'](...await _0x1805c8[_0x12a05d(0xc9)](_0xd04b90[_0x12a05d(0xe5)],this[_0x12a05d(0x100)][_0x12a05d(0xe6)])),_0xe55a13['push'](await _0x1805c8['delete'](_0xd04b90[_0x12a05d(0xf9)],!![])),this[_0x12a05d(0xe9)]=_0x1805c8[_0x12a05d(0xed)](),await this[_0x12a05d(0xd8)](_0x1fe064,!![]);for(const _0xb77054 of _0xe55a13){_0xb77054[_0x12a05d(0xcf)]['length']&&await this[_0x12a05d(0xd8)](_0xb77054[_0x12a05d(0xcf)],!![]),_0xb77054[_0x12a05d(0xd9)][_0x12a05d(0xd3)]&&await this[_0x12a05d(0xd8)](_0xb77054[_0x12a05d(0xd9)],!![]),_0xb77054[_0x12a05d(0xcb)][_0x12a05d(0xd3)]&&await this[_0x12a05d(0xd8)](_0xb77054[_0x12a05d(0xcb)],!![]);}this[_0x12a05d(0xdf)][_0x12a05d(0xda)](_0x12a05d(0xfb),_0x1fe064[_0x12a05d(0xd3)]);}}async['proceedCommitsToBranch'](_0x3a26c7){const _0x54f210=a272_0xe55ba7,_0x410087=[],_0x5b3571=[];for(const _0x41300c of _0x3a26c7){if(!_0x41300c[_0x54f210(0xec)][_0x54f210(0xd3)]&&!_0x41300c[_0x54f210(0xe5)]['length']&&!_0x41300c[_0x54f210(0xf9)]['length'])continue;const _0xffbe69=new salesforce_components_manager_service_1[(_0x54f210(0xf5))](this['options'][_0x54f210(0xc6)],this[_0x54f210(0x100)]['branchId'],_0x41300c[_0x54f210(0xfd)],this[_0x54f210(0x100)][_0x54f210(0xc4)],[]);_0x410087[_0x54f210(0xdd)](...await _0xffbe69[_0x54f210(0xff)](_0x41300c['inserted'])),_0x410087[_0x54f210(0xdd)](...await _0xffbe69[_0x54f210(0xc9)](_0x41300c[_0x54f210(0xe5)])),_0x5b3571[_0x54f210(0xdd)](await _0xffbe69['delete'](_0x41300c[_0x54f210(0xf9)]));}this[_0x54f210(0xdf)][_0x54f210(0xda)]('Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x410087['length']),await this['proceedRequests'](_0x410087);const _0x3a540c=_0x5b3571['reduce']((_0x1e125a,_0x28224a)=>({'manifests':[..._0x1e125a[_0x54f210(0xcf)],..._0x28224a['manifests']],'componentsToDelete':[..._0x1e125a['componentsToDelete'],..._0x28224a[_0x54f210(0xcb)]],'componentsToUpdate':[..._0x1e125a[_0x54f210(0xd9)],..._0x28224a['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x3a540c[_0x54f210(0xcf)][_0x54f210(0xd3)]&&await this[_0x54f210(0xd8)](_0x3a540c[_0x54f210(0xcf)],!![]),_0x3a540c[_0x54f210(0xd9)][_0x54f210(0xd3)]&&await this[_0x54f210(0xd8)](_0x3a540c['componentsToUpdate'],!![]),_0x3a540c[_0x54f210(0xcb)]['length']&&await this['proceedRequests'](_0x3a540c[_0x54f210(0xcb)],!![]);}async[a272_0xe55ba7(0xf4)](_0x6f6fe2){const _0x1b0a97=a272_0xe55ba7;this[_0x1b0a97(0x100)]['branchId']?await this[_0x1b0a97(0xfe)](_0x6f6fe2):await this[_0x1b0a97(0xc5)](_0x6f6fe2);}}exports[a272_0xe55ba7(0xef)]=SalesforceCommitsManager;function a272_0xb92b(){const _0x1bc9b7=['chunkArray','componentsToDelete','11JWxNvm','error','reduce','manifests','4942jMYgDv','../../../shared/utils','floor','length','./salesforce-components-manager.service','165XOzIpM','../utils/composite.utils','Logger','proceedRequests','componentsToUpdate','log','120580uXBQSx','SalesforceCompositeService','push','../errors/salesforce.error','logger','typedi','toString','composite','search','graph','modified','commitId','143ryMaBn','3474jkNyQv','proceededComponentsMeta','75156VMCSLH','2DRsfvn','inserted','getProceededComponentsMeta','stringify','SalesforceCommitsManager','../../../../constants','573444WNHYtt','executeGraphs','__esModule','proceedCommits','SalesforceComponentsManager','2260455LivkGX','SalesforceError','apply','removed','reference','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','toJSON','author','proceedCommitsToBranch','insert','options','(((.+)+)+)+$','name','\x20requests\x20to\x20composite\x20api.','get','24vbovqr','SALESFORCE_MAX_REQUEST_SIZE_BYTES','default','componentId','map','extractComponentIdsFromGraphsResponse','2657424jAjCag','proceedChunksToUpload','splice','563860qBHsOn','recordTypes','proceedCommitsToRepository','repositoryId','./salesforce-composite.service','COMPONENTS_PER_CHUNK','update'];a272_0xb92b=function(){return _0x1bc9b7;};return a272_0xb92b();}