const a228_0x535dee=a228_0x42c7;function a228_0x42c7(_0x47a18f,_0x5924fe){const _0x249848=a228_0xb75d();return a228_0x42c7=function(_0x468811,_0x38c703){_0x468811=_0x468811-0x173;let _0xb75d26=_0x249848[_0x468811];return _0xb75d26;},a228_0x42c7(_0x47a18f,_0x5924fe);}(function(_0x5618d1,_0x469663){const _0x39d13f=a228_0x42c7,_0x5d7dcb=_0x5618d1();while(!![]){try{const _0x1dc68f=-parseInt(_0x39d13f(0x17e))/0x1*(parseInt(_0x39d13f(0x1a6))/0x2)+parseInt(_0x39d13f(0x1b8))/0x3+parseInt(_0x39d13f(0x174))/0x4*(parseInt(_0x39d13f(0x173))/0x5)+parseInt(_0x39d13f(0x19c))/0x6+parseInt(_0x39d13f(0x17f))/0x7+-parseInt(_0x39d13f(0x186))/0x8+-parseInt(_0x39d13f(0x17c))/0x9;if(_0x1dc68f===_0x469663)break;else _0x5d7dcb['push'](_0x5d7dcb['shift']());}catch(_0xb64400){_0x5d7dcb['push'](_0x5d7dcb['shift']());}}}(a228_0xb75d,0x42edf));const a228_0x38c703=(function(){let _0x11c5d3=!![];return function(_0xc547bb,_0x20a682){const _0x5940d5=_0x11c5d3?function(){const _0x357294=a228_0x42c7;if(_0x20a682){const _0x1ae87d=_0x20a682[_0x357294(0x1b7)](_0xc547bb,arguments);return _0x20a682=null,_0x1ae87d;}}:function(){};return _0x11c5d3=![],_0x5940d5;};}()),a228_0x468811=a228_0x38c703(this,function(){const _0x4eef9c=a228_0x42c7;return a228_0x468811[_0x4eef9c(0x1a1)]()[_0x4eef9c(0x1b4)](_0x4eef9c(0x199))[_0x4eef9c(0x1a1)]()[_0x4eef9c(0x1a7)](a228_0x468811)[_0x4eef9c(0x1b4)](_0x4eef9c(0x199));});a228_0x468811();function a228_0xb75d(){const _0x193730=['delete','toJSON','SalesforceError','repositoryId','map','search','chunkArray','proceedCommitsToBranch','apply','1045032VwzQCT','stringify','log','SalesforceCommitsManager','2570sEJgkG','1276WbElNV','manifests','options','update','modified','\x20COMPONENTS_SIZE\x20=\x20','proceedChunksToUpload','executeGraphs','4245957qESDUa','error','116923nVXiVB','3371865lKFMrH','length','__esModule','SalesforceCompositeService','defineProperty','default','removed','3276976QJNHBm','componentId','COMPONENTS_PER_CHUNK','branchId','SalesforceComponentsManager','componentsToUpdate','insert','author','reduce','\x20requests\x20to\x20composite\x20api.','get','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','inserted','../../../../core','../utils/composite.utils','push','SALESFORCE_MAX_REQUEST_SIZE_BYTES','sfLogger','proceededComponentsMeta','(((.+)+)+)+$','proceedRequests','componentsToDelete','1670736vOEWYK','logger','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','Logger','proceedCommitsToRepository','toString','recordTypes','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','Sending\x20','commitId','2sCJDEc','constructor','name','reference','typedi','./salesforce-composite.service','./salesforce-components-manager.service','__importDefault','floor'];a228_0xb75d=function(){return _0x193730;};return a228_0xb75d();}'use strict';var __importDefault=this&&this[a228_0x535dee(0x1ad)]||function(_0x205d5b){const _0x45bc12=a228_0x535dee;return _0x205d5b&&_0x205d5b[_0x45bc12(0x181)]?_0x205d5b:{'default':_0x205d5b};};Object[a228_0x535dee(0x183)](exports,'__esModule',{'value':!![]}),exports[a228_0x535dee(0x1bb)]=void 0x0;const core_1=require(a228_0x535dee(0x193)),typedi_1=__importDefault(require(a228_0x535dee(0x1aa))),constants_1=require('../../../../constants'),utils_1=require('../../../shared/utils'),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a228_0x535dee(0x194)),salesforce_components_manager_service_1=require(a228_0x535dee(0x1ac)),salesforce_composite_service_1=require(a228_0x535dee(0x1ab));class SalesforceCommitsManager{constructor(_0x126195){const _0x24d2a9=a228_0x535dee;this[_0x24d2a9(0x176)]=_0x126195,this[_0x24d2a9(0x188)]=0x3,this[_0x24d2a9(0x19d)]=new core_1[(_0x24d2a9(0x19f))](SalesforceCommitsManager[_0x24d2a9(0x1a8)]),this[_0x24d2a9(0x197)]=this['options']['logger'],this['composite']=typedi_1[_0x24d2a9(0x184)][_0x24d2a9(0x190)](salesforce_composite_service_1[_0x24d2a9(0x182)]),this[_0x24d2a9(0x198)]=[];}async[a228_0x535dee(0x17a)](_0xd48668,_0x317e62=![]){const _0x210e3d=a228_0x535dee,_0x450bb5=async _0x54d030=>{const _0x151c33=a228_0x42c7;await this[_0x151c33(0x19d)][_0x151c33(0x1ba)](_0x151c33(0x1a4)+_0x54d030[_0x151c33(0x18e)]((_0x4e1cec,_0x24e10c)=>_0x4e1cec+_0x24e10c[_0x151c33(0x180)],0x0)+_0x151c33(0x18f));const _0x5815ed=_0x54d030[_0x151c33(0x1b3)]((_0x4c71e6,_0x51fc0f)=>({'graphId':'graph'+_0x51fc0f,'compositeRequest':_0x4c71e6})),_0x24efb9=await this['composite'][_0x151c33(0x17b)](_0x5815ed);if(_0x317e62){const _0x2f0105=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x24efb9);for(const {id:_0x4b2c60,ref:_0x10a195}of _0x2f0105){const _0x1d04e2=this[_0x151c33(0x198)]['find'](_0x5d4231=>_0x5d4231[_0x151c33(0x1a9)]===_0x10a195);_0x1d04e2&&(_0x1d04e2[_0x151c33(0x187)]=_0x4b2c60);}}},_0x3e4d16=0x1e8480;let _0x1963bc=0x0,_0x568725=[];for(const _0x47c008 of _0xd48668){const _0x135f78=_0x47c008[_0x210e3d(0x18e)]((_0x43a6c,_0xa38cff)=>{const _0x1fd22c=_0x210e3d,_0x106654=JSON[_0x1fd22c(0x1b9)](_0xa38cff)['length']*0x2;return _0x43a6c+_0x106654;},0x0);if(_0x135f78>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1[(_0x210e3d(0x1b1))]('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1[_0x210e3d(0x196)]+_0x210e3d(0x179)+_0x135f78);_0x1963bc+_0x135f78>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x3e4d16&&(await _0x450bb5(_0x568725),_0x568725=[],_0x1963bc=0x0),_0x1963bc+=_0x135f78,_0x568725[_0x210e3d(0x195)](_0x47c008);}_0x568725[_0x210e3d(0x180)]&&await _0x450bb5(_0x568725);}async[a228_0x535dee(0x19a)](_0x3fd70f,_0x3e15eb=![]){const _0x36733e=a228_0x535dee,_0x3508c6=(this['COMPONENTS_PER_CHUNK']+ +_0x3e15eb)*0x3,_0x27c215=(0x0,utils_1[_0x36733e(0x1b5)])(_0x3fd70f,_0x3508c6);try{while(_0x27c215['length']){const _0x3d25ae=_0x27c215['splice'](0x0,Math[_0x36733e(0x1ae)](constants_1[_0x36733e(0x191)]/_0x3508c6));await this['proceedChunksToUpload'](_0x3d25ae,_0x3e15eb);}}catch(_0x442ccd){this['logger'][_0x36733e(0x17d)](_0x442ccd instanceof salesforce_error_1[_0x36733e(0x1b1)]?JSON[_0x36733e(0x1b9)](_0x442ccd[_0x36733e(0x1b0)](),null,0x2):_0x442ccd),this[_0x36733e(0x197)][_0x36733e(0x1ba)](_0x442ccd instanceof salesforce_error_1[_0x36733e(0x1b1)]?JSON[_0x36733e(0x1b9)](_0x442ccd[_0x36733e(0x1b0)](),null,0x2):_0x442ccd['toString']());throw _0x442ccd;}}async[a228_0x535dee(0x1a0)](_0x1eb4f9){const _0x253256=a228_0x535dee;for(const _0x3e722a of _0x1eb4f9){if(!_0x3e722a[_0x253256(0x192)]['length']&&!_0x3e722a[_0x253256(0x178)]['length']&&!_0x3e722a[_0x253256(0x185)][_0x253256(0x180)])continue;const _0x2ff64b=[],_0x41c1ea=[],_0x473d22=new salesforce_components_manager_service_1[(_0x253256(0x18a))](this[_0x253256(0x176)][_0x253256(0x1b2)],this[_0x253256(0x176)]['branchId'],_0x3e722a[_0x253256(0x18d)],this[_0x253256(0x176)][_0x253256(0x1a2)],this[_0x253256(0x198)]);_0x2ff64b['push'](...await _0x473d22[_0x253256(0x18c)](_0x3e722a[_0x253256(0x192)],this[_0x253256(0x176)][_0x253256(0x1a5)])),_0x2ff64b['push'](...await _0x473d22[_0x253256(0x177)](_0x3e722a[_0x253256(0x178)],this['options'][_0x253256(0x1a5)])),_0x41c1ea[_0x253256(0x195)](await _0x473d22[_0x253256(0x1af)](_0x3e722a[_0x253256(0x185)],!![])),this[_0x253256(0x198)]=_0x473d22['getProceededComponentsMeta'](),await this['proceedRequests'](_0x2ff64b,!![]);for(const _0x12ebbb of _0x41c1ea){_0x12ebbb[_0x253256(0x175)][_0x253256(0x180)]&&await this[_0x253256(0x19a)](_0x12ebbb[_0x253256(0x175)],!![]),_0x12ebbb[_0x253256(0x18b)]['length']&&await this[_0x253256(0x19a)](_0x12ebbb[_0x253256(0x18b)],!![]),_0x12ebbb[_0x253256(0x19b)][_0x253256(0x180)]&&await this[_0x253256(0x19a)](_0x12ebbb[_0x253256(0x19b)],!![]);}this[_0x253256(0x19d)]['log'](_0x253256(0x1a3),_0x2ff64b[_0x253256(0x180)]);}}async[a228_0x535dee(0x1b6)](_0x2942a1){const _0x7f4d6=a228_0x535dee,_0x524938=[],_0x276910=[];for(const _0x302963 of _0x2942a1){if(!_0x302963['inserted'][_0x7f4d6(0x180)]&&!_0x302963[_0x7f4d6(0x178)][_0x7f4d6(0x180)]&&!_0x302963[_0x7f4d6(0x185)][_0x7f4d6(0x180)])continue;const _0x48094b=new salesforce_components_manager_service_1[(_0x7f4d6(0x18a))](this[_0x7f4d6(0x176)][_0x7f4d6(0x1b2)],this[_0x7f4d6(0x176)][_0x7f4d6(0x189)],_0x302963[_0x7f4d6(0x18d)],this[_0x7f4d6(0x176)][_0x7f4d6(0x1a2)],[]);_0x524938[_0x7f4d6(0x195)](...await _0x48094b[_0x7f4d6(0x18c)](_0x302963[_0x7f4d6(0x192)])),_0x524938[_0x7f4d6(0x195)](...await _0x48094b['update'](_0x302963[_0x7f4d6(0x178)])),_0x276910[_0x7f4d6(0x195)](await _0x48094b[_0x7f4d6(0x1af)](_0x302963['removed']));}this[_0x7f4d6(0x19d)][_0x7f4d6(0x1ba)](_0x7f4d6(0x19e),_0x524938[_0x7f4d6(0x180)]),await this[_0x7f4d6(0x19a)](_0x524938);const _0x4f91e9=_0x276910['reduce']((_0x1e6870,_0x3d2260)=>({'manifests':[..._0x1e6870[_0x7f4d6(0x175)],..._0x3d2260[_0x7f4d6(0x175)]],'componentsToDelete':[..._0x1e6870[_0x7f4d6(0x19b)],..._0x3d2260['componentsToDelete']],'componentsToUpdate':[..._0x1e6870[_0x7f4d6(0x18b)],..._0x3d2260[_0x7f4d6(0x18b)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x4f91e9[_0x7f4d6(0x175)][_0x7f4d6(0x180)]&&await this[_0x7f4d6(0x19a)](_0x4f91e9['manifests'],!![]),_0x4f91e9[_0x7f4d6(0x18b)][_0x7f4d6(0x180)]&&await this[_0x7f4d6(0x19a)](_0x4f91e9[_0x7f4d6(0x18b)],!![]),_0x4f91e9[_0x7f4d6(0x19b)]['length']&&await this[_0x7f4d6(0x19a)](_0x4f91e9[_0x7f4d6(0x19b)],!![]);}async['proceedCommits'](_0x54ad6c){const _0x90277f=a228_0x535dee;this['options'][_0x90277f(0x189)]?await this[_0x90277f(0x1b6)](_0x54ad6c):await this[_0x90277f(0x1a0)](_0x54ad6c);}}exports[a228_0x535dee(0x1bb)]=SalesforceCommitsManager;