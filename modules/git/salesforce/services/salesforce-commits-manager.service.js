const a227_0x257496=a227_0x2fcf;(function(_0x4ad1b8,_0x587ffa){const _0x852cd0=a227_0x2fcf,_0xf61ca9=_0x4ad1b8();while(!![]){try{const _0x17dfd9=-parseInt(_0x852cd0(0x18d))/0x1*(-parseInt(_0x852cd0(0x1a4))/0x2)+-parseInt(_0x852cd0(0x18e))/0x3+parseInt(_0x852cd0(0x1c7))/0x4+-parseInt(_0x852cd0(0x1c8))/0x5*(-parseInt(_0x852cd0(0x193))/0x6)+parseInt(_0x852cd0(0x1be))/0x7*(parseInt(_0x852cd0(0x187))/0x8)+-parseInt(_0x852cd0(0x1c0))/0x9*(parseInt(_0x852cd0(0x1a1))/0xa)+parseInt(_0x852cd0(0x19b))/0xb*(-parseInt(_0x852cd0(0x1c1))/0xc);if(_0x17dfd9===_0x587ffa)break;else _0xf61ca9['push'](_0xf61ca9['shift']());}catch(_0x4c77a1){_0xf61ca9['push'](_0xf61ca9['shift']());}}}(a227_0x2c8e,0x9ff80));function a227_0x2fcf(_0xba61c9,_0x3c3812){const _0x25a0e3=a227_0x2c8e();return a227_0x2fcf=function(_0x197b1b,_0x5a3916){_0x197b1b=_0x197b1b-0x187;let _0x2c8e6e=_0x25a0e3[_0x197b1b];return _0x2c8e6e;},a227_0x2fcf(_0xba61c9,_0x3c3812);}const a227_0x5a3916=(function(){let _0x563a43=!![];return function(_0x1c6a88,_0x32a07e){const _0x435065=_0x563a43?function(){const _0x3d3196=a227_0x2fcf;if(_0x32a07e){const _0x58fc1f=_0x32a07e[_0x3d3196(0x1a6)](_0x1c6a88,arguments);return _0x32a07e=null,_0x58fc1f;}}:function(){};return _0x563a43=![],_0x435065;};}()),a227_0x197b1b=a227_0x5a3916(this,function(){const _0x1fbf6f=a227_0x2fcf;return a227_0x197b1b[_0x1fbf6f(0x1d2)]()['search'](_0x1fbf6f(0x1a2))[_0x1fbf6f(0x1d2)]()[_0x1fbf6f(0x1a8)](a227_0x197b1b)[_0x1fbf6f(0x1b7)](_0x1fbf6f(0x1a2));});a227_0x197b1b();'use strict';var __importDefault=this&&this[a227_0x257496(0x1b5)]||function(_0x429a9d){const _0x204b20=a227_0x257496;return _0x429a9d&&_0x429a9d[_0x204b20(0x1b4)]?_0x429a9d:{'default':_0x429a9d};};Object[a227_0x257496(0x191)](exports,'__esModule',{'value':!![]}),exports[a227_0x257496(0x1d9)]=void 0x0;const core_1=require(a227_0x257496(0x1aa)),typedi_1=__importDefault(require('typedi')),constants_1=require(a227_0x257496(0x1cb)),utils_1=require(a227_0x257496(0x1c3)),salesforce_error_1=require(a227_0x257496(0x1b6)),composite_utils_1=require(a227_0x257496(0x1ce)),salesforce_components_manager_service_1=require(a227_0x257496(0x1a9)),salesforce_composite_service_1=require('./salesforce-composite.service');class SalesforceCommitsManager{constructor(_0x297515){const _0x5d867e=a227_0x257496;this[_0x5d867e(0x199)]=_0x297515,this[_0x5d867e(0x1a3)]=0x3,this['logger']=new core_1[(_0x5d867e(0x192))](SalesforceCommitsManager[_0x5d867e(0x1b0)]),this[_0x5d867e(0x1b3)]=this[_0x5d867e(0x199)][_0x5d867e(0x1bf)],this[_0x5d867e(0x1bc)]=typedi_1[_0x5d867e(0x19a)][_0x5d867e(0x19f)](salesforce_composite_service_1[_0x5d867e(0x1cd)]),this[_0x5d867e(0x1c9)]=[];}async[a227_0x257496(0x188)](_0x846dd,_0x4f4c16=![]){const _0x59421c=a227_0x257496,_0x495812=async _0x4a1957=>{const _0xf7d0b5=a227_0x2fcf;await this[_0xf7d0b5(0x1bf)][_0xf7d0b5(0x1c2)](_0xf7d0b5(0x1ae)+_0x4a1957[_0xf7d0b5(0x1bd)]((_0x36b1eb,_0x4cd072)=>_0x36b1eb+_0x4cd072['length'],0x0)+_0xf7d0b5(0x1d6));const _0x1fcef3=_0x4a1957[_0xf7d0b5(0x1d4)]((_0x1cb51c,_0x1f39e1)=>({'graphId':'graph'+_0x1f39e1,'compositeRequest':_0x1cb51c})),_0x34d56d=await this[_0xf7d0b5(0x1bc)][_0xf7d0b5(0x1cc)](_0x1fcef3);if(_0x4f4c16){const _0x28a965=(0x0,composite_utils_1[_0xf7d0b5(0x18a)])(_0x34d56d);for(const {id:_0x3e8a17,ref:_0x151f2a}of _0x28a965){const _0x59fa60=this[_0xf7d0b5(0x1c9)][_0xf7d0b5(0x19e)](_0x3af5bc=>_0x3af5bc[_0xf7d0b5(0x19d)]===_0x151f2a);_0x59fa60&&(_0x59fa60[_0xf7d0b5(0x1c6)]=_0x3e8a17);}}},_0x1e26aa=0x1e8480;let _0x497b53=0x0,_0x247fe8=[];for(const _0xd7dd61 of _0x846dd){const _0x27d01b=_0xd7dd61[_0x59421c(0x1bd)]((_0xf934c0,_0x15cdbf)=>{const _0x361f33=_0x59421c,_0x536e34=JSON[_0x361f33(0x1ad)](_0x15cdbf)[_0x361f33(0x1bb)]*0x2;return _0xf934c0+_0x536e34;},0x0);if(_0x27d01b>constants_1[_0x59421c(0x1d5)])throw new salesforce_error_1[(_0x59421c(0x1b2))](_0x59421c(0x1d8)+constants_1[_0x59421c(0x1d5)]+_0x59421c(0x18c)+_0x27d01b);_0x497b53+_0x27d01b>constants_1[_0x59421c(0x1d5)]-_0x1e26aa&&(await _0x495812(_0x247fe8),_0x247fe8=[],_0x497b53=0x0),_0x497b53+=_0x27d01b,_0x247fe8[_0x59421c(0x18b)](_0xd7dd61);}_0x247fe8['length']&&await _0x495812(_0x247fe8);}async['proceedRequests'](_0x35dcf5,_0x26ad7a=![]){const _0x4065b2=a227_0x257496,_0x5a065e=(this['COMPONENTS_PER_CHUNK']+ +_0x26ad7a)*0x3,_0x2ea2ed=(0x0,utils_1['chunkArray'])(_0x35dcf5,_0x5a065e);try{while(_0x2ea2ed['length']){const _0x4f3481=_0x2ea2ed[_0x4065b2(0x1c5)](0x0,Math[_0x4065b2(0x190)](constants_1[_0x4065b2(0x198)]/_0x5a065e));await this['proceedChunksToUpload'](_0x4f3481,_0x26ad7a);}}catch(_0x3d0ac4){this[_0x4065b2(0x1bf)][_0x4065b2(0x1cf)](_0x3d0ac4 instanceof salesforce_error_1[_0x4065b2(0x1b2)]?JSON[_0x4065b2(0x1ad)](_0x3d0ac4[_0x4065b2(0x1b9)](),null,0x2):_0x3d0ac4),this[_0x4065b2(0x1b3)]['log'](_0x3d0ac4 instanceof salesforce_error_1['SalesforceError']?JSON[_0x4065b2(0x1ad)](_0x3d0ac4[_0x4065b2(0x1b9)](),null,0x2):_0x3d0ac4[_0x4065b2(0x1d2)]());throw _0x3d0ac4;}}async[a227_0x257496(0x1ba)](_0x14ee8b){const _0x4d6094=a227_0x257496;for(const _0x47f727 of _0x14ee8b){if(!_0x47f727[_0x4d6094(0x1b8)]['length']&&!_0x47f727[_0x4d6094(0x1a7)][_0x4d6094(0x1bb)]&&!_0x47f727[_0x4d6094(0x197)][_0x4d6094(0x1bb)])continue;const _0x164d9f=[],_0x5846c1=[],_0x1be3c7=new salesforce_components_manager_service_1[(_0x4d6094(0x1ac))](this[_0x4d6094(0x199)][_0x4d6094(0x1ca)],this[_0x4d6094(0x199)]['branchId'],_0x47f727[_0x4d6094(0x189)],this[_0x4d6094(0x199)][_0x4d6094(0x1af)],this[_0x4d6094(0x1c9)]);_0x164d9f[_0x4d6094(0x18b)](...await _0x1be3c7[_0x4d6094(0x1a0)](_0x47f727[_0x4d6094(0x1b8)],this[_0x4d6094(0x199)][_0x4d6094(0x1a5)])),_0x164d9f[_0x4d6094(0x18b)](...await _0x1be3c7[_0x4d6094(0x1c4)](_0x47f727['modified'],this[_0x4d6094(0x199)][_0x4d6094(0x1a5)])),_0x5846c1[_0x4d6094(0x18b)](await _0x1be3c7[_0x4d6094(0x1ab)](_0x47f727[_0x4d6094(0x197)],!![])),this[_0x4d6094(0x1c9)]=_0x1be3c7[_0x4d6094(0x194)](),await this['proceedRequests'](_0x164d9f,!![]);for(const _0xcee52f of _0x5846c1){_0xcee52f[_0x4d6094(0x1d1)][_0x4d6094(0x1bb)]&&await this[_0x4d6094(0x195)](_0xcee52f[_0x4d6094(0x1d1)],!![]),_0xcee52f['componentsToUpdate'][_0x4d6094(0x1bb)]&&await this[_0x4d6094(0x195)](_0xcee52f[_0x4d6094(0x1d0)],!![]),_0xcee52f[_0x4d6094(0x1b1)][_0x4d6094(0x1bb)]&&await this['proceedRequests'](_0xcee52f['componentsToDelete'],!![]);}this[_0x4d6094(0x1bf)]['log'](_0x4d6094(0x19c),_0x164d9f[_0x4d6094(0x1bb)]);}}async[a227_0x257496(0x1d3)](_0x5ee752){const _0x4515df=a227_0x257496,_0x499ed6=[],_0xb0d53c=[];for(const _0x3bd887 of _0x5ee752){if(!_0x3bd887['inserted'][_0x4515df(0x1bb)]&&!_0x3bd887[_0x4515df(0x1a7)][_0x4515df(0x1bb)]&&!_0x3bd887[_0x4515df(0x197)][_0x4515df(0x1bb)])continue;const _0x4aa7c8=new salesforce_components_manager_service_1[(_0x4515df(0x1ac))](this[_0x4515df(0x199)]['repositoryId'],this['options'][_0x4515df(0x18f)],_0x3bd887['author'],this[_0x4515df(0x199)][_0x4515df(0x1af)],[]);_0x499ed6[_0x4515df(0x18b)](...await _0x4aa7c8[_0x4515df(0x1a0)](_0x3bd887[_0x4515df(0x1b8)])),_0x499ed6[_0x4515df(0x18b)](...await _0x4aa7c8[_0x4515df(0x1c4)](_0x3bd887[_0x4515df(0x1a7)])),_0xb0d53c[_0x4515df(0x18b)](await _0x4aa7c8[_0x4515df(0x1ab)](_0x3bd887[_0x4515df(0x197)]));}this[_0x4515df(0x1bf)][_0x4515df(0x1c2)](_0x4515df(0x196),_0x499ed6[_0x4515df(0x1bb)]),await this[_0x4515df(0x195)](_0x499ed6);const _0x17ad42=_0xb0d53c[_0x4515df(0x1bd)]((_0x14fe27,_0x1a26ad)=>({'manifests':[..._0x14fe27[_0x4515df(0x1d1)],..._0x1a26ad[_0x4515df(0x1d1)]],'componentsToDelete':[..._0x14fe27[_0x4515df(0x1b1)],..._0x1a26ad[_0x4515df(0x1b1)]],'componentsToUpdate':[..._0x14fe27[_0x4515df(0x1d0)],..._0x1a26ad[_0x4515df(0x1d0)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x17ad42[_0x4515df(0x1d1)][_0x4515df(0x1bb)]&&await this['proceedRequests'](_0x17ad42[_0x4515df(0x1d1)],!![]),_0x17ad42[_0x4515df(0x1d0)][_0x4515df(0x1bb)]&&await this['proceedRequests'](_0x17ad42[_0x4515df(0x1d0)],!![]),_0x17ad42[_0x4515df(0x1b1)][_0x4515df(0x1bb)]&&await this[_0x4515df(0x195)](_0x17ad42[_0x4515df(0x1b1)],!![]);}async[a227_0x257496(0x1d7)](_0xf974cf){const _0x32eb84=a227_0x257496;this['options'][_0x32eb84(0x18f)]?await this['proceedCommitsToBranch'](_0xf974cf):await this['proceedCommitsToRepository'](_0xf974cf);}}exports[a227_0x257496(0x1d9)]=SalesforceCommitsManager;function a227_0x2c8e(){const _0x3ceb48=['removed','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','options','default','19604937NsjSVQ','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','reference','find','get','insert','10xipgWA','(((.+)+)+)+$','COMPONENTS_PER_CHUNK','13692lKOUjO','commitId','apply','modified','constructor','./salesforce-components-manager.service','../../../../core','delete','SalesforceComponentsManager','stringify','Sending\x20','recordTypes','name','componentsToDelete','SalesforceError','sfLogger','__esModule','__importDefault','../errors/salesforce.error','search','inserted','toJSON','proceedCommitsToRepository','length','composite','reduce','7MSNYfb','logger','623277gCFSes','12LNRgbT','log','../../../shared/utils','update','splice','componentId','598628NDCOXr','45NtmmWg','proceededComponentsMeta','repositoryId','../../../../constants','executeGraphs','SalesforceCompositeService','../utils/composite.utils','error','componentsToUpdate','manifests','toString','proceedCommitsToBranch','map','SALESFORCE_MAX_REQUEST_SIZE_BYTES','\x20requests\x20to\x20composite\x20api.','proceedCommits','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','SalesforceCommitsManager','5200304uVaqSA','proceedChunksToUpload','author','extractComponentIdsFromGraphsResponse','push','\x20COMPONENTS_SIZE\x20=\x20','133SiLwIT','1080720boUprb','branchId','floor','defineProperty','Logger','771186sfmici','getProceededComponentsMeta','proceedRequests','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)'];a227_0x2c8e=function(){return _0x3ceb48;};return a227_0x2c8e();}