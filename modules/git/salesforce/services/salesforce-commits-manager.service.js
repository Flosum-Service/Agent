const a194_0x499890=a194_0x2261;(function(_0x2300ed,_0xf8ba5a){const _0x362339=a194_0x2261,_0x299e63=_0x2300ed();while(!![]){try{const _0x40b670=-parseInt(_0x362339(0x19d))/0x1*(parseInt(_0x362339(0x197))/0x2)+parseInt(_0x362339(0x19c))/0x3*(parseInt(_0x362339(0x16b))/0x4)+parseInt(_0x362339(0x163))/0x5*(parseInt(_0x362339(0x16e))/0x6)+parseInt(_0x362339(0x165))/0x7+parseInt(_0x362339(0x181))/0x8+parseInt(_0x362339(0x187))/0x9+-parseInt(_0x362339(0x169))/0xa;if(_0x40b670===_0xf8ba5a)break;else _0x299e63['push'](_0x299e63['shift']());}catch(_0x4f3862){_0x299e63['push'](_0x299e63['shift']());}}}(a194_0x4128,0xc3275));const a194_0x2f7ded=(function(){let _0x16c1cb=!![];return function(_0x559532,_0x5e1f1a){const _0x489529=_0x16c1cb?function(){const _0x383895=a194_0x2261;if(_0x5e1f1a){const _0x2ce17a=_0x5e1f1a[_0x383895(0x185)](_0x559532,arguments);return _0x5e1f1a=null,_0x2ce17a;}}:function(){};return _0x16c1cb=![],_0x489529;};}()),a194_0x3216fa=a194_0x2f7ded(this,function(){const _0x4dadd2=a194_0x2261;return a194_0x3216fa[_0x4dadd2(0x176)]()['search'](_0x4dadd2(0x19e))[_0x4dadd2(0x176)]()[_0x4dadd2(0x171)](a194_0x3216fa)[_0x4dadd2(0x178)]('(((.+)+)+)+$');});a194_0x3216fa();function a194_0x4128(){const _0x296f3c=['./salesforce-components-manager.service','toJSON','log','23457470OsXbyy','removed','32hPvoWs','sfLogger','componentsToUpdate','6XonbDK','repositoryId','delete','constructor','name','floor','options','../../../../core','toString','COMPONENTS_PER_CHUNK','search','error','componentId','update','branchId','./salesforce-composite.service','get','componentsToDelete','reference','10430096VWrLEy','executeGraphs','author','graph','apply','modified','2135817TjxMnl','SalesforceCompositeService','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','SalesforceCommitsManager','length','insert','proceedCommitsToRepository','SalesforceComponentsManager','stringify','extractComponentIdsFromGraphsResponse','find','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','recordTypes','composite','chunkArray','proceededComponentsMeta','2634286iUMvJV','proceedCommits','manifests','proceedRequests','push','363741ndkPRz','1fYvBoc','(((.+)+)+)+$','__esModule','logger','reduce','commitId','Sending\x20','../../../../constants','4782305HwoGwG','inserted','6963089mKAFmk'];a194_0x4128=function(){return _0x296f3c;};return a194_0x4128();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x2ef9ef){const _0x1e8768=a194_0x2261;return _0x2ef9ef&&_0x2ef9ef[_0x1e8768(0x19f)]?_0x2ef9ef:{'default':_0x2ef9ef};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a194_0x499890(0x18a)]=void 0x0;function a194_0x2261(_0x58112f,_0x2e0121){const _0x2d8579=a194_0x4128();return a194_0x2261=function(_0x3216fa,_0x2f7ded){_0x3216fa=_0x3216fa-0x163;let _0x4128c8=_0x2d8579[_0x3216fa];return _0x4128c8;},a194_0x2261(_0x58112f,_0x2e0121);}const core_1=require(a194_0x499890(0x175)),typedi_1=__importDefault(require('typedi')),constants_1=require(a194_0x499890(0x1a4)),utils_1=require('../../../shared/utils'),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a194_0x499890(0x166)),salesforce_composite_service_1=require(a194_0x499890(0x17d));class SalesforceCommitsManager{constructor(_0x4341d9){const _0x3165ea=a194_0x499890;this[_0x3165ea(0x174)]=_0x4341d9,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x3165ea(0x1a0)]=new core_1['Logger'](SalesforceCommitsManager[_0x3165ea(0x172)]),this[_0x3165ea(0x16c)]=this[_0x3165ea(0x174)][_0x3165ea(0x1a0)],this['composite']=typedi_1['default'][_0x3165ea(0x17e)](salesforce_composite_service_1[_0x3165ea(0x188)]),this['proceededComponentsMeta']=[];}async[a194_0x499890(0x19a)](_0x1466dd,_0x1052f9=![]){const _0x398fb4=a194_0x499890,_0x503b9e=(this[_0x398fb4(0x177)]+ +_0x1052f9)*0x3,_0x27e283=(0x0,utils_1[_0x398fb4(0x195)])(_0x1466dd,_0x503b9e);try{while(_0x27e283[_0x398fb4(0x18b)]){const _0x19408b=_0x27e283['splice'](0x0,Math[_0x398fb4(0x173)](constants_1[_0x398fb4(0x192)]/_0x503b9e));await this['logger']['log'](_0x398fb4(0x1a3)+_0x19408b['length']*_0x503b9e+'\x20requests\x20to\x20composite\x20api.');const _0x5b2acd=_0x19408b['map']((_0x1360ec,_0x2433c8)=>({'graphId':_0x398fb4(0x184)+_0x2433c8,'compositeRequest':_0x1360ec})),_0x337aac=await this[_0x398fb4(0x194)][_0x398fb4(0x182)](_0x5b2acd);if(_0x1052f9){const _0xd84b58=(0x0,composite_utils_1[_0x398fb4(0x190)])(_0x337aac);for(const {id:_0x2d4248,ref:_0x53682e}of _0xd84b58){const _0x594d8a=this[_0x398fb4(0x196)][_0x398fb4(0x191)](_0x293e18=>_0x293e18[_0x398fb4(0x180)]===_0x53682e);_0x594d8a&&(_0x594d8a[_0x398fb4(0x17a)]=_0x2d4248);}}}}catch(_0x57ab25){this[_0x398fb4(0x1a0)][_0x398fb4(0x179)](_0x57ab25 instanceof salesforce_error_1['SalesforceError']?JSON[_0x398fb4(0x18f)](_0x57ab25[_0x398fb4(0x167)](),null,0x2):_0x57ab25),this['sfLogger']['log'](_0x57ab25 instanceof salesforce_error_1['SalesforceError']?JSON['stringify'](_0x57ab25[_0x398fb4(0x167)](),null,0x2):_0x57ab25['toString']());throw _0x57ab25;}}async[a194_0x499890(0x18d)](_0x570ef4){const _0x2baa28=a194_0x499890;for(const _0x722ec5 of _0x570ef4){if(!_0x722ec5[_0x2baa28(0x164)][_0x2baa28(0x18b)]&&!_0x722ec5[_0x2baa28(0x186)]['length']&&!_0x722ec5[_0x2baa28(0x16a)][_0x2baa28(0x18b)])continue;const _0x4bd6e8=[],_0x1a1056=[],_0x3bebf6=new salesforce_components_manager_service_1[(_0x2baa28(0x18e))](this['options']['repositoryId'],this[_0x2baa28(0x174)]['branchId'],_0x722ec5[_0x2baa28(0x183)],this[_0x2baa28(0x174)][_0x2baa28(0x193)],this[_0x2baa28(0x196)]);_0x4bd6e8[_0x2baa28(0x19b)](...await _0x3bebf6[_0x2baa28(0x18c)](_0x722ec5[_0x2baa28(0x164)],this[_0x2baa28(0x174)][_0x2baa28(0x1a2)])),_0x4bd6e8[_0x2baa28(0x19b)](...await _0x3bebf6[_0x2baa28(0x17b)](_0x722ec5[_0x2baa28(0x186)],this[_0x2baa28(0x174)]['commitId'])),_0x1a1056['push'](await _0x3bebf6[_0x2baa28(0x170)](_0x722ec5[_0x2baa28(0x16a)],!![])),this[_0x2baa28(0x196)]=_0x3bebf6['getProceededComponentsMeta'](),await this['proceedRequests'](_0x4bd6e8,!![]);for(const _0x404d45 of _0x1a1056){_0x404d45[_0x2baa28(0x199)][_0x2baa28(0x18b)]&&await this[_0x2baa28(0x19a)](_0x404d45[_0x2baa28(0x199)],!![]),_0x404d45[_0x2baa28(0x16d)][_0x2baa28(0x18b)]&&await this[_0x2baa28(0x19a)](_0x404d45[_0x2baa28(0x16d)],!![]),_0x404d45['componentsToDelete'][_0x2baa28(0x18b)]&&await this[_0x2baa28(0x19a)](_0x404d45['componentsToDelete'],!![]);}this[_0x2baa28(0x1a0)]['log']('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x4bd6e8[_0x2baa28(0x18b)]);}}async['proceedCommitsToBranch'](_0x1d068e){const _0x370598=a194_0x499890,_0x2a62ff=[],_0x343afb=[];for(const _0x2b984d of _0x1d068e){if(!_0x2b984d[_0x370598(0x164)]['length']&&!_0x2b984d[_0x370598(0x186)][_0x370598(0x18b)]&&!_0x2b984d[_0x370598(0x16a)][_0x370598(0x18b)])continue;const _0x5424d1=new salesforce_components_manager_service_1[(_0x370598(0x18e))](this[_0x370598(0x174)][_0x370598(0x16f)],this[_0x370598(0x174)]['branchId'],_0x2b984d[_0x370598(0x183)],this['options'][_0x370598(0x193)],[]);_0x2a62ff[_0x370598(0x19b)](...await _0x5424d1[_0x370598(0x18c)](_0x2b984d[_0x370598(0x164)])),_0x2a62ff[_0x370598(0x19b)](...await _0x5424d1[_0x370598(0x17b)](_0x2b984d[_0x370598(0x186)])),_0x343afb[_0x370598(0x19b)](await _0x5424d1['delete'](_0x2b984d[_0x370598(0x16a)]));}this['logger'][_0x370598(0x168)](_0x370598(0x189),_0x2a62ff[_0x370598(0x18b)]),await this['proceedRequests'](_0x2a62ff);const _0xbfd109=_0x343afb[_0x370598(0x1a1)]((_0x277523,_0x2ef74d)=>({'manifests':[..._0x277523[_0x370598(0x199)],..._0x2ef74d[_0x370598(0x199)]],'componentsToDelete':[..._0x277523[_0x370598(0x17f)],..._0x2ef74d[_0x370598(0x17f)]],'componentsToUpdate':[..._0x277523['componentsToUpdate'],..._0x2ef74d[_0x370598(0x16d)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0xbfd109['manifests'][_0x370598(0x18b)]&&await this[_0x370598(0x19a)](_0xbfd109[_0x370598(0x199)],!![]),_0xbfd109[_0x370598(0x16d)][_0x370598(0x18b)]&&await this[_0x370598(0x19a)](_0xbfd109[_0x370598(0x16d)],!![]),_0xbfd109[_0x370598(0x17f)][_0x370598(0x18b)]&&await this[_0x370598(0x19a)](_0xbfd109[_0x370598(0x17f)],!![]);}async[a194_0x499890(0x198)](_0x55db94){const _0x54f62b=a194_0x499890;this['options'][_0x54f62b(0x17c)]?await this['proceedCommitsToBranch'](_0x55db94):await this[_0x54f62b(0x18d)](_0x55db94);}}exports[a194_0x499890(0x18a)]=SalesforceCommitsManager;