const a228_0x8a95a4=a228_0x5a9d;(function(_0x1c80ac,_0x5a595d){const _0x5085cd=a228_0x5a9d,_0x5924d3=_0x1c80ac();while(!![]){try{const _0x3f896a=-parseInt(_0x5085cd(0x1f1))/0x1*(-parseInt(_0x5085cd(0x1f2))/0x2)+-parseInt(_0x5085cd(0x1d8))/0x3+-parseInt(_0x5085cd(0x1ef))/0x4*(parseInt(_0x5085cd(0x1c8))/0x5)+parseInt(_0x5085cd(0x1e4))/0x6*(-parseInt(_0x5085cd(0x1c6))/0x7)+parseInt(_0x5085cd(0x1c7))/0x8+parseInt(_0x5085cd(0x1dd))/0x9*(parseInt(_0x5085cd(0x1ea))/0xa)+-parseInt(_0x5085cd(0x1b4))/0xb*(-parseInt(_0x5085cd(0x1f3))/0xc);if(_0x3f896a===_0x5a595d)break;else _0x5924d3['push'](_0x5924d3['shift']());}catch(_0x57a546){_0x5924d3['push'](_0x5924d3['shift']());}}}(a228_0x536c,0x2a9db));const a228_0x4528bc=(function(){let _0x2cf44a=!![];return function(_0xddf351,_0x72393e){const _0x334e3e=_0x2cf44a?function(){if(_0x72393e){const _0x183e0f=_0x72393e['apply'](_0xddf351,arguments);return _0x72393e=null,_0x183e0f;}}:function(){};return _0x2cf44a=![],_0x334e3e;};}()),a228_0x260546=a228_0x4528bc(this,function(){const _0x17f71b=a228_0x5a9d;return a228_0x260546['toString']()[_0x17f71b(0x1b8)](_0x17f71b(0x1ce))[_0x17f71b(0x1d7)]()[_0x17f71b(0x1d5)](a228_0x260546)[_0x17f71b(0x1b8)](_0x17f71b(0x1ce));});a228_0x260546();'use strict';function a228_0x536c(){const _0x2d7ec5=['./salesforce-components-manager.service','SalesforceComponentsManager','../../../../core','error','108GbsPBb','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','13907wgQDir','2vNSlpd','60FCJOUc','log','typedi','push','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','insert','repositoryId','commitId','COMPONENTS_PER_CHUNK','Logger','removed','branchId','__esModule','map','606551xUDzzr','manifests','../errors/salesforce.error','\x20COMPONENTS_SIZE\x20=\x20','search','floor','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','Sending\x20','../../../../constants','SalesforceError','splice','options','stringify','SALESFORCE_MAX_REQUEST_SIZE_BYTES','sfLogger','proceedRequests','reference','update','553434ZZdtnG','1934352oelLOA','42805iLhyDy','proceededComponentsMeta','length','../../../shared/utils','componentsToDelete','proceedCommitsToRepository','(((.+)+)+)+$','graph','proceedChunksToUpload','defineProperty','find','\x20requests\x20to\x20composite\x20api.','modified','constructor','inserted','toString','38343XNWFzd','default','../utils/composite.utils','name','componentId','9PnjhDK','proceedCommitsToBranch','./salesforce-composite.service','get','componentsToUpdate','reduce','delete','18UsDWTS','toJSON','logger','executeGraphs','composite','SalesforceCommitsManager','1242630NTcLkb'];a228_0x536c=function(){return _0x2d7ec5;};return a228_0x536c();}var __importDefault=this&&this['__importDefault']||function(_0x5dd74c){const _0x5e7957=a228_0x5a9d;return _0x5dd74c&&_0x5dd74c[_0x5e7957(0x1b2)]?_0x5dd74c:{'default':_0x5dd74c};};Object[a228_0x8a95a4(0x1d1)](exports,a228_0x8a95a4(0x1b2),{'value':!![]}),exports[a228_0x8a95a4(0x1e9)]=void 0x0;const core_1=require(a228_0x8a95a4(0x1ed)),typedi_1=__importDefault(require(a228_0x8a95a4(0x1f5))),constants_1=require(a228_0x8a95a4(0x1bc)),utils_1=require(a228_0x8a95a4(0x1cb)),salesforce_error_1=require(a228_0x8a95a4(0x1b6)),composite_utils_1=require(a228_0x8a95a4(0x1da)),salesforce_components_manager_service_1=require(a228_0x8a95a4(0x1eb)),salesforce_composite_service_1=require(a228_0x8a95a4(0x1df));function a228_0x5a9d(_0x45ddae,_0x4b49ca){const _0x4685dd=a228_0x536c();return a228_0x5a9d=function(_0x260546,_0x4528bc){_0x260546=_0x260546-0x1b1;let _0x536cda=_0x4685dd[_0x260546];return _0x536cda;},a228_0x5a9d(_0x45ddae,_0x4b49ca);}class SalesforceCommitsManager{constructor(_0x1c11b8){const _0x230ec7=a228_0x8a95a4;this[_0x230ec7(0x1bf)]=_0x1c11b8,this[_0x230ec7(0x1fb)]=0x3,this[_0x230ec7(0x1e6)]=new core_1[(_0x230ec7(0x1fc))](SalesforceCommitsManager[_0x230ec7(0x1db)]),this[_0x230ec7(0x1c2)]=this['options'][_0x230ec7(0x1e6)],this[_0x230ec7(0x1e8)]=typedi_1[_0x230ec7(0x1d9)][_0x230ec7(0x1e0)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x230ec7(0x1c9)]=[];}async[a228_0x8a95a4(0x1d0)](_0x1fb787,_0x41246d=![]){const _0x75458d=a228_0x8a95a4,_0x28a99e=async _0x176c64=>{const _0x329db5=a228_0x5a9d;await this[_0x329db5(0x1e6)][_0x329db5(0x1f4)](_0x329db5(0x1bb)+_0x176c64[_0x329db5(0x1e2)]((_0x5b1090,_0x431f6b)=>_0x5b1090+_0x431f6b['length'],0x0)+_0x329db5(0x1d3));const _0x485ccf=_0x176c64[_0x329db5(0x1b3)]((_0x3765ff,_0x590c5d)=>({'graphId':_0x329db5(0x1cf)+_0x590c5d,'compositeRequest':_0x3765ff})),_0xabdbad=await this[_0x329db5(0x1e8)][_0x329db5(0x1e7)](_0x485ccf);if(_0x41246d){const _0x2a1670=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0xabdbad);for(const {id:_0x4f5a1d,ref:_0xa894b3}of _0x2a1670){const _0x5881ed=this[_0x329db5(0x1c9)][_0x329db5(0x1d2)](_0x587633=>_0x587633[_0x329db5(0x1c4)]===_0xa894b3);_0x5881ed&&(_0x5881ed[_0x329db5(0x1dc)]=_0x4f5a1d);}}},_0x3d9731=0x1e8480;let _0x43011f=0x0,_0x34c960=[];for(const _0xd5da84 of _0x1fb787){const _0x130a97=_0xd5da84['reduce']((_0x36aadc,_0x5a24df)=>{const _0xf8e1fb=a228_0x5a9d,_0x284a66=JSON['stringify'](_0x5a24df)[_0xf8e1fb(0x1ca)]*0x2;return _0x36aadc+_0x284a66;},0x0);if(_0x130a97>constants_1[_0x75458d(0x1c1)])throw new salesforce_error_1[(_0x75458d(0x1bd))](_0x75458d(0x1f0)+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+_0x75458d(0x1b7)+_0x130a97);_0x43011f+_0x130a97>constants_1[_0x75458d(0x1c1)]-_0x3d9731&&(await _0x28a99e(_0x34c960),_0x34c960=[],_0x43011f=0x0),_0x43011f+=_0x130a97,_0x34c960['push'](_0xd5da84);}_0x34c960['length']&&await _0x28a99e(_0x34c960);}async[a228_0x8a95a4(0x1c3)](_0x25a764,_0x44a9ba=![]){const _0x3a2de4=a228_0x8a95a4,_0x43283d=(this[_0x3a2de4(0x1fb)]+ +_0x44a9ba)*0x3,_0x549eee=(0x0,utils_1['chunkArray'])(_0x25a764,_0x43283d);try{while(_0x549eee[_0x3a2de4(0x1ca)]){const _0x27c1ea=_0x549eee[_0x3a2de4(0x1be)](0x0,Math[_0x3a2de4(0x1b9)](constants_1[_0x3a2de4(0x1ba)]/_0x43283d));await this[_0x3a2de4(0x1d0)](_0x27c1ea,_0x44a9ba);}}catch(_0x2e480b){this[_0x3a2de4(0x1e6)][_0x3a2de4(0x1ee)](_0x2e480b instanceof salesforce_error_1[_0x3a2de4(0x1bd)]?JSON[_0x3a2de4(0x1c0)](_0x2e480b[_0x3a2de4(0x1e5)](),null,0x2):_0x2e480b),this[_0x3a2de4(0x1c2)][_0x3a2de4(0x1f4)](_0x2e480b instanceof salesforce_error_1['SalesforceError']?JSON[_0x3a2de4(0x1c0)](_0x2e480b['toJSON'](),null,0x2):_0x2e480b[_0x3a2de4(0x1d7)]());throw _0x2e480b;}}async[a228_0x8a95a4(0x1cd)](_0x32e375){const _0x1b32e5=a228_0x8a95a4;for(const _0x1d1798 of _0x32e375){if(!_0x1d1798[_0x1b32e5(0x1d6)]['length']&&!_0x1d1798['modified'][_0x1b32e5(0x1ca)]&&!_0x1d1798[_0x1b32e5(0x1fd)]['length'])continue;const _0x41d7a5=[],_0x4db212=[],_0xdb893b=new salesforce_components_manager_service_1[(_0x1b32e5(0x1ec))](this[_0x1b32e5(0x1bf)][_0x1b32e5(0x1f9)],this[_0x1b32e5(0x1bf)][_0x1b32e5(0x1b1)],_0x1d1798['author'],this['options']['recordTypes'],this[_0x1b32e5(0x1c9)]);_0x41d7a5[_0x1b32e5(0x1f6)](...await _0xdb893b[_0x1b32e5(0x1f8)](_0x1d1798[_0x1b32e5(0x1d6)],this[_0x1b32e5(0x1bf)][_0x1b32e5(0x1fa)])),_0x41d7a5['push'](...await _0xdb893b[_0x1b32e5(0x1c5)](_0x1d1798[_0x1b32e5(0x1d4)],this['options'][_0x1b32e5(0x1fa)])),_0x4db212['push'](await _0xdb893b['delete'](_0x1d1798[_0x1b32e5(0x1fd)],!![])),this[_0x1b32e5(0x1c9)]=_0xdb893b['getProceededComponentsMeta'](),await this[_0x1b32e5(0x1c3)](_0x41d7a5,!![]);for(const _0x1058fa of _0x4db212){_0x1058fa[_0x1b32e5(0x1b5)][_0x1b32e5(0x1ca)]&&await this[_0x1b32e5(0x1c3)](_0x1058fa[_0x1b32e5(0x1b5)],!![]),_0x1058fa[_0x1b32e5(0x1e1)]['length']&&await this['proceedRequests'](_0x1058fa[_0x1b32e5(0x1e1)],!![]),_0x1058fa[_0x1b32e5(0x1cc)][_0x1b32e5(0x1ca)]&&await this[_0x1b32e5(0x1c3)](_0x1058fa[_0x1b32e5(0x1cc)],!![]);}this[_0x1b32e5(0x1e6)]['log']('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x41d7a5[_0x1b32e5(0x1ca)]);}}async[a228_0x8a95a4(0x1de)](_0x5bddaa){const _0x900205=a228_0x8a95a4,_0x31792d=[],_0x7d63=[];for(const _0x4d79e7 of _0x5bddaa){if(!_0x4d79e7[_0x900205(0x1d6)][_0x900205(0x1ca)]&&!_0x4d79e7[_0x900205(0x1d4)][_0x900205(0x1ca)]&&!_0x4d79e7[_0x900205(0x1fd)][_0x900205(0x1ca)])continue;const _0x1eb447=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x900205(0x1bf)]['repositoryId'],this[_0x900205(0x1bf)][_0x900205(0x1b1)],_0x4d79e7['author'],this[_0x900205(0x1bf)]['recordTypes'],[]);_0x31792d[_0x900205(0x1f6)](...await _0x1eb447[_0x900205(0x1f8)](_0x4d79e7[_0x900205(0x1d6)])),_0x31792d[_0x900205(0x1f6)](...await _0x1eb447['update'](_0x4d79e7['modified'])),_0x7d63[_0x900205(0x1f6)](await _0x1eb447[_0x900205(0x1e3)](_0x4d79e7[_0x900205(0x1fd)]));}this[_0x900205(0x1e6)]['log'](_0x900205(0x1f7),_0x31792d[_0x900205(0x1ca)]),await this[_0x900205(0x1c3)](_0x31792d);const _0x4224b0=_0x7d63[_0x900205(0x1e2)]((_0x5a125d,_0xcc470e)=>({'manifests':[..._0x5a125d[_0x900205(0x1b5)],..._0xcc470e[_0x900205(0x1b5)]],'componentsToDelete':[..._0x5a125d['componentsToDelete'],..._0xcc470e[_0x900205(0x1cc)]],'componentsToUpdate':[..._0x5a125d['componentsToUpdate'],..._0xcc470e[_0x900205(0x1e1)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x4224b0[_0x900205(0x1b5)][_0x900205(0x1ca)]&&await this[_0x900205(0x1c3)](_0x4224b0[_0x900205(0x1b5)],!![]),_0x4224b0[_0x900205(0x1e1)][_0x900205(0x1ca)]&&await this[_0x900205(0x1c3)](_0x4224b0[_0x900205(0x1e1)],!![]),_0x4224b0[_0x900205(0x1cc)][_0x900205(0x1ca)]&&await this[_0x900205(0x1c3)](_0x4224b0[_0x900205(0x1cc)],!![]);}async['proceedCommits'](_0x4b29a2){const _0x54568a=a228_0x8a95a4;this['options']['branchId']?await this['proceedCommitsToBranch'](_0x4b29a2):await this[_0x54568a(0x1cd)](_0x4b29a2);}}exports[a228_0x8a95a4(0x1e9)]=SalesforceCommitsManager;