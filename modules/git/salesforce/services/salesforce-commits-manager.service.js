const a272_0x5b9b1e=a272_0x41ad;(function(_0x322e6e,_0x3014e1){const _0x17507f=a272_0x41ad,_0x102e08=_0x322e6e();while(!![]){try{const _0x406b61=parseInt(_0x17507f(0x165))/0x1+-parseInt(_0x17507f(0x15e))/0x2+-parseInt(_0x17507f(0x17b))/0x3*(-parseInt(_0x17507f(0x168))/0x4)+parseInt(_0x17507f(0x175))/0x5*(parseInt(_0x17507f(0x16a))/0x6)+-parseInt(_0x17507f(0x167))/0x7+parseInt(_0x17507f(0x182))/0x8+-parseInt(_0x17507f(0x191))/0x9*(-parseInt(_0x17507f(0x185))/0xa);if(_0x406b61===_0x3014e1)break;else _0x102e08['push'](_0x102e08['shift']());}catch(_0x32b20c){_0x102e08['push'](_0x102e08['shift']());}}}(a272_0x21ec,0x76291));const a272_0x106126=(function(){let _0x52236d=!![];return function(_0xd748cb,_0x18555e){const _0x91c31b=_0x52236d?function(){const _0xe5b541=a272_0x41ad;if(_0x18555e){const _0x3167b5=_0x18555e[_0xe5b541(0x166)](_0xd748cb,arguments);return _0x18555e=null,_0x3167b5;}}:function(){};return _0x52236d=![],_0x91c31b;};}()),a272_0x4f28d2=a272_0x106126(this,function(){const _0x592e7c=a272_0x41ad;return a272_0x4f28d2[_0x592e7c(0x15f)]()[_0x592e7c(0x18f)](_0x592e7c(0x181))[_0x592e7c(0x15f)]()[_0x592e7c(0x16e)](a272_0x4f28d2)[_0x592e7c(0x18f)](_0x592e7c(0x181));});a272_0x4f28d2();'use strict';var __importDefault=this&&this[a272_0x5b9b1e(0x198)]||function(_0x11ff66){return _0x11ff66&&_0x11ff66['__esModule']?_0x11ff66:{'default':_0x11ff66};};Object['defineProperty'](exports,a272_0x5b9b1e(0x18a),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;function a272_0x21ec(){const _0x110424=['../utils/composite.utils','push','commitId','getProceededComponentsMeta','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','modified','stringify','\x20COMPONENTS_SIZE\x20=\x20','proceedCommits','1468130dTGwhe','toString','reduce','inserted','splice','name','../../../shared/utils','44124XebtCn','apply','2668995uxUoDE','12JLJmPY','default','18QQWCAr','componentId','COMPONENTS_PER_CHUNK','sfLogger','constructor','proceededComponentsMeta','./salesforce-components-manager.service','composite','extractComponentIdsFromGraphsResponse','delete','executeGraphs','685710UvOpVt','proceedCommitsToBranch','get','componentsToUpdate','proceedRequests','insert','287331mhUlJd','componentsToDelete','proceedChunksToUpload','SALESFORCE_MAX_REQUEST_SIZE_BYTES','error','SalesforceError','(((.+)+)+)+$','1529608tLVJBB','../../../../constants','../errors/salesforce.error','810xEJcPH','toJSON','./salesforce-composite.service','typedi','find','__esModule','author','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','../../../../core','reference','search','recordTypes','73917pXkNFZ','removed','log','proceedCommitsToRepository','logger','length','Sending\x20','__importDefault','branchId','manifests','repositoryId','SalesforceComponentsManager','Logger','options','update'];a272_0x21ec=function(){return _0x110424;};return a272_0x21ec();}const core_1=require(a272_0x5b9b1e(0x18d)),typedi_1=__importDefault(require(a272_0x5b9b1e(0x188))),constants_1=require(a272_0x5b9b1e(0x183)),utils_1=require(a272_0x5b9b1e(0x164)),salesforce_error_1=require(a272_0x5b9b1e(0x184)),composite_utils_1=require(a272_0x5b9b1e(0x1a0)),salesforce_components_manager_service_1=require(a272_0x5b9b1e(0x170)),salesforce_composite_service_1=require(a272_0x5b9b1e(0x187));function a272_0x41ad(_0x40b551,_0x481c78){const _0x33d731=a272_0x21ec();return a272_0x41ad=function(_0x4f28d2,_0x106126){_0x4f28d2=_0x4f28d2-0x15b;let _0x21ec96=_0x33d731[_0x4f28d2];return _0x21ec96;},a272_0x41ad(_0x40b551,_0x481c78);}class SalesforceCommitsManager{constructor(_0x1515fe){const _0x59d9b2=a272_0x5b9b1e;this['options']=_0x1515fe,this[_0x59d9b2(0x16c)]=0x3,this[_0x59d9b2(0x195)]=new core_1[(_0x59d9b2(0x19d))](SalesforceCommitsManager[_0x59d9b2(0x163)]),this[_0x59d9b2(0x16d)]=this[_0x59d9b2(0x19e)][_0x59d9b2(0x195)],this[_0x59d9b2(0x171)]=typedi_1[_0x59d9b2(0x169)][_0x59d9b2(0x177)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x59d9b2(0x16f)]=[];}async[a272_0x5b9b1e(0x17d)](_0xbc4779,_0x4cca6d=![]){const _0x4e17b8=a272_0x5b9b1e,_0x432cf5=async _0x506111=>{const _0x37113b=a272_0x41ad;await this[_0x37113b(0x195)][_0x37113b(0x193)](_0x37113b(0x197)+_0x506111[_0x37113b(0x160)]((_0x1c22b9,_0x5b7f7a)=>_0x1c22b9+_0x5b7f7a['length'],0x0)+'\x20requests\x20to\x20composite\x20api.');const _0x75142f=_0x506111['map']((_0x703f28,_0xbee9e8)=>({'graphId':'graph'+_0xbee9e8,'compositeRequest':_0x703f28})),_0x177505=await this[_0x37113b(0x171)][_0x37113b(0x174)](_0x75142f);if(_0x4cca6d){const _0x11777d=(0x0,composite_utils_1[_0x37113b(0x172)])(_0x177505);for(const {id:_0x5d0923,ref:_0x440195}of _0x11777d){const _0x388965=this[_0x37113b(0x16f)][_0x37113b(0x189)](_0x2757e=>_0x2757e[_0x37113b(0x18e)]===_0x440195);_0x388965&&(_0x388965[_0x37113b(0x16b)]=_0x5d0923);}}},_0x5ce8ac=0x1e8480;let _0x50b3ac=0x0,_0x2e39d1=[];for(const _0x327b22 of _0xbc4779){const _0x5d3b63=_0x327b22[_0x4e17b8(0x160)]((_0x48949d,_0x36a412)=>{const _0x2de873=JSON['stringify'](_0x36a412)['length']*0x2;return _0x48949d+_0x2de873;},0x0);if(_0x5d3b63>constants_1[_0x4e17b8(0x17e)])throw new salesforce_error_1[(_0x4e17b8(0x180))](_0x4e17b8(0x1a4)+constants_1[_0x4e17b8(0x17e)]+_0x4e17b8(0x15c)+_0x5d3b63);_0x50b3ac+_0x5d3b63>constants_1[_0x4e17b8(0x17e)]-_0x5ce8ac&&(await _0x432cf5(_0x2e39d1),_0x2e39d1=[],_0x50b3ac=0x0),_0x50b3ac+=_0x5d3b63,_0x2e39d1['push'](_0x327b22);}_0x2e39d1[_0x4e17b8(0x196)]&&await _0x432cf5(_0x2e39d1);}async[a272_0x5b9b1e(0x179)](_0x2f7544,_0x71eaf=![]){const _0x2622fb=a272_0x5b9b1e,_0x5e2b2e=(this[_0x2622fb(0x16c)]+ +_0x71eaf)*0x3,_0x560724=(0x0,utils_1['chunkArray'])(_0x2f7544,_0x5e2b2e);try{while(_0x560724[_0x2622fb(0x196)]){const _0x16b5ea=_0x560724[_0x2622fb(0x162)](0x0,Math['floor'](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x5e2b2e));await this[_0x2622fb(0x17d)](_0x16b5ea,_0x71eaf);}}catch(_0x22bc97){this[_0x2622fb(0x195)][_0x2622fb(0x17f)](_0x22bc97 instanceof salesforce_error_1[_0x2622fb(0x180)]?JSON[_0x2622fb(0x15b)](_0x22bc97['toJSON'](),null,0x2):_0x22bc97),this[_0x2622fb(0x16d)]['log'](_0x22bc97 instanceof salesforce_error_1['SalesforceError']?JSON['stringify'](_0x22bc97[_0x2622fb(0x186)](),null,0x2):_0x22bc97[_0x2622fb(0x15f)]());throw _0x22bc97;}}async[a272_0x5b9b1e(0x194)](_0x3ff65e){const _0x3b4503=a272_0x5b9b1e;for(const _0x33d083 of _0x3ff65e){if(!_0x33d083[_0x3b4503(0x161)][_0x3b4503(0x196)]&&!_0x33d083[_0x3b4503(0x1a5)][_0x3b4503(0x196)]&&!_0x33d083[_0x3b4503(0x192)][_0x3b4503(0x196)])continue;const _0xa28182=[],_0x3e3127=[],_0x22b334=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this['options']['repositoryId'],this[_0x3b4503(0x19e)][_0x3b4503(0x199)],_0x33d083[_0x3b4503(0x18b)],this[_0x3b4503(0x19e)][_0x3b4503(0x190)],this[_0x3b4503(0x16f)]);_0xa28182['push'](...await _0x22b334[_0x3b4503(0x17a)](_0x33d083[_0x3b4503(0x161)],this[_0x3b4503(0x19e)][_0x3b4503(0x1a2)])),_0xa28182[_0x3b4503(0x1a1)](...await _0x22b334[_0x3b4503(0x19f)](_0x33d083[_0x3b4503(0x1a5)],this[_0x3b4503(0x19e)][_0x3b4503(0x1a2)])),_0x3e3127[_0x3b4503(0x1a1)](await _0x22b334[_0x3b4503(0x173)](_0x33d083[_0x3b4503(0x192)],!![])),this[_0x3b4503(0x16f)]=_0x22b334[_0x3b4503(0x1a3)](),await this['proceedRequests'](_0xa28182,!![]);for(const _0x48208e of _0x3e3127){_0x48208e['manifests'][_0x3b4503(0x196)]&&await this[_0x3b4503(0x179)](_0x48208e[_0x3b4503(0x19a)],!![]),_0x48208e['componentsToUpdate'][_0x3b4503(0x196)]&&await this[_0x3b4503(0x179)](_0x48208e[_0x3b4503(0x178)],!![]),_0x48208e['componentsToDelete']['length']&&await this['proceedRequests'](_0x48208e[_0x3b4503(0x17c)],!![]);}this[_0x3b4503(0x195)][_0x3b4503(0x193)](_0x3b4503(0x18c),_0xa28182[_0x3b4503(0x196)]);}}async[a272_0x5b9b1e(0x176)](_0x47267c){const _0xe1389e=a272_0x5b9b1e,_0x2a7790=[],_0x206824=[];for(const _0x34b7ec of _0x47267c){if(!_0x34b7ec[_0xe1389e(0x161)][_0xe1389e(0x196)]&&!_0x34b7ec[_0xe1389e(0x1a5)]['length']&&!_0x34b7ec[_0xe1389e(0x192)][_0xe1389e(0x196)])continue;const _0x2f3df6=new salesforce_components_manager_service_1[(_0xe1389e(0x19c))](this['options'][_0xe1389e(0x19b)],this[_0xe1389e(0x19e)]['branchId'],_0x34b7ec[_0xe1389e(0x18b)],this[_0xe1389e(0x19e)][_0xe1389e(0x190)],[]);_0x2a7790[_0xe1389e(0x1a1)](...await _0x2f3df6[_0xe1389e(0x17a)](_0x34b7ec['inserted'])),_0x2a7790['push'](...await _0x2f3df6['update'](_0x34b7ec[_0xe1389e(0x1a5)])),_0x206824[_0xe1389e(0x1a1)](await _0x2f3df6[_0xe1389e(0x173)](_0x34b7ec[_0xe1389e(0x192)]));}this[_0xe1389e(0x195)][_0xe1389e(0x193)]('Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x2a7790[_0xe1389e(0x196)]),await this[_0xe1389e(0x179)](_0x2a7790);const _0x9c7787=_0x206824['reduce']((_0x5a30e2,_0xcd9c3a)=>({'manifests':[..._0x5a30e2['manifests'],..._0xcd9c3a[_0xe1389e(0x19a)]],'componentsToDelete':[..._0x5a30e2[_0xe1389e(0x17c)],..._0xcd9c3a[_0xe1389e(0x17c)]],'componentsToUpdate':[..._0x5a30e2[_0xe1389e(0x178)],..._0xcd9c3a[_0xe1389e(0x178)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x9c7787[_0xe1389e(0x19a)][_0xe1389e(0x196)]&&await this['proceedRequests'](_0x9c7787[_0xe1389e(0x19a)],!![]),_0x9c7787['componentsToUpdate']['length']&&await this[_0xe1389e(0x179)](_0x9c7787[_0xe1389e(0x178)],!![]),_0x9c7787[_0xe1389e(0x17c)]['length']&&await this[_0xe1389e(0x179)](_0x9c7787[_0xe1389e(0x17c)],!![]);}async[a272_0x5b9b1e(0x15d)](_0x2d01db){const _0x5bdcc9=a272_0x5b9b1e;this['options'][_0x5bdcc9(0x199)]?await this[_0x5bdcc9(0x176)](_0x2d01db):await this[_0x5bdcc9(0x194)](_0x2d01db);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;