const a233_0x3da0e8=a233_0x3fed;(function(_0x3bb97f,_0x1e8a5e){const _0x47ad4e=a233_0x3fed,_0x484fcd=_0x3bb97f();while(!![]){try{const _0x35bb2b=-parseInt(_0x47ad4e(0x139))/0x1*(parseInt(_0x47ad4e(0x157))/0x2)+parseInt(_0x47ad4e(0x120))/0x3*(-parseInt(_0x47ad4e(0x151))/0x4)+parseInt(_0x47ad4e(0x145))/0x5+-parseInt(_0x47ad4e(0x138))/0x6+-parseInt(_0x47ad4e(0x13a))/0x7*(parseInt(_0x47ad4e(0x149))/0x8)+-parseInt(_0x47ad4e(0x141))/0x9+parseInt(_0x47ad4e(0x140))/0xa*(parseInt(_0x47ad4e(0x123))/0xb);if(_0x35bb2b===_0x1e8a5e)break;else _0x484fcd['push'](_0x484fcd['shift']());}catch(_0x4da6b1){_0x484fcd['push'](_0x484fcd['shift']());}}}(a233_0x14f8,0x6f77c));function a233_0x14f8(){const _0x58141c=['componentId','7256110YLBaZK','4917231sCCKZC','push','author','manifests','2456885KHXmKW','get','constructor','proceededComponentsMeta','556152BCjKtL','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','SalesforceCommitsManager','delete','\x20requests\x20to\x20composite\x20api.','splice','options','default','164JRnqNx','proceedChunksToUpload','COMPONENTS_PER_CHUNK','modified','__importDefault','toJSON','178cRyZjH','executeGraphs','../../../shared/utils','./salesforce-components-manager.service','SalesforceCompositeService','chunkArray','SALESFORCE_MAX_REQUEST_SIZE_BYTES','Logger','\x20COMPONENTS_SIZE\x20=\x20','(((.+)+)+)+$','update','insert','inserted','componentsToUpdate','proceedRequests','proceedCommitsToRepository','../errors/salesforce.error','composite','length','sfLogger','name','../utils/composite.utils','typedi','63501aNsPwj','reference','../../../../core','33VUqnbX','floor','apply','log','stringify','repositoryId','reduce','SalesforceError','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','removed','graph','search','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','recordTypes','toString','proceedCommitsToBranch','SalesforceComponentsManager','find','getProceededComponentsMeta','logger','proceedCommits','3175056weIhZO','2233yOjVFC','7OCDmUY','componentsToDelete','Sending\x20','branchId','./salesforce-composite.service'];a233_0x14f8=function(){return _0x58141c;};return a233_0x14f8();}const a233_0x36a9bc=(function(){let _0x2b0d2c=!![];return function(_0x57c97c,_0x2b7aa0){const _0x5a3794=_0x2b0d2c?function(){const _0x4b1525=a233_0x3fed;if(_0x2b7aa0){const _0x133a37=_0x2b7aa0[_0x4b1525(0x125)](_0x57c97c,arguments);return _0x2b7aa0=null,_0x133a37;}}:function(){};return _0x2b0d2c=![],_0x5a3794;};}()),a233_0x1b1963=a233_0x36a9bc(this,function(){const _0x1cb61a=a233_0x3fed;return a233_0x1b1963[_0x1cb61a(0x131)]()[_0x1cb61a(0x12e)](_0x1cb61a(0x160))[_0x1cb61a(0x131)]()[_0x1cb61a(0x147)](a233_0x1b1963)[_0x1cb61a(0x12e)](_0x1cb61a(0x160));});a233_0x1b1963();'use strict';var __importDefault=this&&this[a233_0x3da0e8(0x155)]||function(_0x42b306){return _0x42b306&&_0x42b306['__esModule']?_0x42b306:{'default':_0x42b306};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a233_0x3da0e8(0x14b)]=void 0x0;const core_1=require(a233_0x3da0e8(0x122)),typedi_1=__importDefault(require(a233_0x3da0e8(0x11f))),constants_1=require('../../../../constants'),utils_1=require(a233_0x3da0e8(0x159)),salesforce_error_1=require(a233_0x3da0e8(0x167)),composite_utils_1=require(a233_0x3da0e8(0x11e)),salesforce_components_manager_service_1=require(a233_0x3da0e8(0x15a)),salesforce_composite_service_1=require(a233_0x3da0e8(0x13e));function a233_0x3fed(_0x4a454b,_0x91637e){const _0x81ae0d=a233_0x14f8();return a233_0x3fed=function(_0x1b1963,_0x36a9bc){_0x1b1963=_0x1b1963-0x11c;let _0x14f8f8=_0x81ae0d[_0x1b1963];return _0x14f8f8;},a233_0x3fed(_0x4a454b,_0x91637e);}class SalesforceCommitsManager{constructor(_0x472f2c){const _0x586e93=a233_0x3da0e8;this[_0x586e93(0x14f)]=_0x472f2c,this[_0x586e93(0x153)]=0x3,this[_0x586e93(0x136)]=new core_1[(_0x586e93(0x15e))](SalesforceCommitsManager[_0x586e93(0x11d)]),this[_0x586e93(0x11c)]=this[_0x586e93(0x14f)][_0x586e93(0x136)],this[_0x586e93(0x168)]=typedi_1[_0x586e93(0x150)][_0x586e93(0x146)](salesforce_composite_service_1[_0x586e93(0x15b)]),this[_0x586e93(0x148)]=[];}async[a233_0x3da0e8(0x152)](_0x1ae45c,_0x485d11=![]){const _0x2ce8b2=a233_0x3da0e8,_0x2fb54b=async _0x4fafb4=>{const _0x31f307=a233_0x3fed;await this[_0x31f307(0x136)][_0x31f307(0x126)](_0x31f307(0x13c)+_0x4fafb4[_0x31f307(0x129)]((_0x377500,_0x31e374)=>_0x377500+_0x31e374['length'],0x0)+_0x31f307(0x14d));const _0x454693=_0x4fafb4['map']((_0xd8df30,_0x5933d8)=>({'graphId':_0x31f307(0x12d)+_0x5933d8,'compositeRequest':_0xd8df30})),_0x4b52c8=await this[_0x31f307(0x168)][_0x31f307(0x158)](_0x454693);if(_0x485d11){const _0x42bf83=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x4b52c8);for(const {id:_0xbb96c8,ref:_0x59e0d4}of _0x42bf83){const _0x15f0fe=this[_0x31f307(0x148)][_0x31f307(0x134)](_0x3a53a7=>_0x3a53a7[_0x31f307(0x121)]===_0x59e0d4);_0x15f0fe&&(_0x15f0fe[_0x31f307(0x13f)]=_0xbb96c8);}}},_0x1fc513=0x1e8480;let _0x176858=0x0,_0x1ceb95=[];for(const _0x31bcce of _0x1ae45c){const _0x3bc434=_0x31bcce['reduce']((_0x21069e,_0x15810f)=>{const _0x2a95cb=a233_0x3fed,_0x21a27e=JSON[_0x2a95cb(0x127)](_0x15810f)[_0x2a95cb(0x169)]*0x2;return _0x21069e+_0x21a27e;},0x0);if(_0x3bc434>constants_1[_0x2ce8b2(0x15d)])throw new salesforce_error_1[(_0x2ce8b2(0x12a))](_0x2ce8b2(0x12b)+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+_0x2ce8b2(0x15f)+_0x3bc434);_0x176858+_0x3bc434>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x1fc513&&(await _0x2fb54b(_0x1ceb95),_0x1ceb95=[],_0x176858=0x0),_0x176858+=_0x3bc434,_0x1ceb95[_0x2ce8b2(0x142)](_0x31bcce);}_0x1ceb95[_0x2ce8b2(0x169)]&&await _0x2fb54b(_0x1ceb95);}async[a233_0x3da0e8(0x165)](_0x1b38a8,_0x33526c=![]){const _0x29badc=a233_0x3da0e8,_0x258740=(this[_0x29badc(0x153)]+ +_0x33526c)*0x3,_0x48cacd=(0x0,utils_1[_0x29badc(0x15c)])(_0x1b38a8,_0x258740);try{while(_0x48cacd['length']){const _0x352f98=_0x48cacd[_0x29badc(0x14e)](0x0,Math[_0x29badc(0x124)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x258740));await this['proceedChunksToUpload'](_0x352f98,_0x33526c);}}catch(_0x1c31dd){this['logger']['error'](_0x1c31dd instanceof salesforce_error_1[_0x29badc(0x12a)]?JSON['stringify'](_0x1c31dd['toJSON'](),null,0x2):_0x1c31dd),this[_0x29badc(0x11c)][_0x29badc(0x126)](_0x1c31dd instanceof salesforce_error_1[_0x29badc(0x12a)]?JSON['stringify'](_0x1c31dd[_0x29badc(0x156)](),null,0x2):_0x1c31dd[_0x29badc(0x131)]());throw _0x1c31dd;}}async[a233_0x3da0e8(0x166)](_0x475ec8){const _0x209ea1=a233_0x3da0e8;for(const _0x466c34 of _0x475ec8){if(!_0x466c34[_0x209ea1(0x163)][_0x209ea1(0x169)]&&!_0x466c34[_0x209ea1(0x154)][_0x209ea1(0x169)]&&!_0x466c34[_0x209ea1(0x12c)][_0x209ea1(0x169)])continue;const _0x48d679=[],_0xf73d7e=[],_0x3e2fa3=new salesforce_components_manager_service_1[(_0x209ea1(0x133))](this[_0x209ea1(0x14f)]['repositoryId'],this[_0x209ea1(0x14f)][_0x209ea1(0x13d)],_0x466c34[_0x209ea1(0x143)],this['options']['recordTypes'],this['proceededComponentsMeta']);_0x48d679['push'](...await _0x3e2fa3[_0x209ea1(0x162)](_0x466c34[_0x209ea1(0x163)],this[_0x209ea1(0x14f)]['commitId'])),_0x48d679[_0x209ea1(0x142)](...await _0x3e2fa3[_0x209ea1(0x161)](_0x466c34[_0x209ea1(0x154)],this[_0x209ea1(0x14f)]['commitId'])),_0xf73d7e[_0x209ea1(0x142)](await _0x3e2fa3[_0x209ea1(0x14c)](_0x466c34[_0x209ea1(0x12c)],!![])),this[_0x209ea1(0x148)]=_0x3e2fa3[_0x209ea1(0x135)](),await this['proceedRequests'](_0x48d679,!![]);for(const _0x37dc70 of _0xf73d7e){_0x37dc70[_0x209ea1(0x144)][_0x209ea1(0x169)]&&await this[_0x209ea1(0x165)](_0x37dc70['manifests'],!![]),_0x37dc70[_0x209ea1(0x164)][_0x209ea1(0x169)]&&await this[_0x209ea1(0x165)](_0x37dc70[_0x209ea1(0x164)],!![]),_0x37dc70[_0x209ea1(0x13b)][_0x209ea1(0x169)]&&await this[_0x209ea1(0x165)](_0x37dc70[_0x209ea1(0x13b)],!![]);}this['logger'][_0x209ea1(0x126)](_0x209ea1(0x12f),_0x48d679[_0x209ea1(0x169)]);}}async[a233_0x3da0e8(0x132)](_0x4e06a0){const _0x3255c6=a233_0x3da0e8,_0x2a6ce3=[],_0x5a3cb7=[];for(const _0xfef888 of _0x4e06a0){if(!_0xfef888[_0x3255c6(0x163)][_0x3255c6(0x169)]&&!_0xfef888['modified'][_0x3255c6(0x169)]&&!_0xfef888[_0x3255c6(0x12c)][_0x3255c6(0x169)])continue;const _0x2a756f=new salesforce_components_manager_service_1[(_0x3255c6(0x133))](this[_0x3255c6(0x14f)][_0x3255c6(0x128)],this[_0x3255c6(0x14f)][_0x3255c6(0x13d)],_0xfef888[_0x3255c6(0x143)],this[_0x3255c6(0x14f)][_0x3255c6(0x130)],[]);_0x2a6ce3[_0x3255c6(0x142)](...await _0x2a756f[_0x3255c6(0x162)](_0xfef888['inserted'])),_0x2a6ce3['push'](...await _0x2a756f[_0x3255c6(0x161)](_0xfef888[_0x3255c6(0x154)])),_0x5a3cb7[_0x3255c6(0x142)](await _0x2a756f[_0x3255c6(0x14c)](_0xfef888['removed']));}this[_0x3255c6(0x136)]['log'](_0x3255c6(0x14a),_0x2a6ce3['length']),await this['proceedRequests'](_0x2a6ce3);const _0x6656c=_0x5a3cb7[_0x3255c6(0x129)]((_0x5778fb,_0x3988b1)=>({'manifests':[..._0x5778fb[_0x3255c6(0x144)],..._0x3988b1[_0x3255c6(0x144)]],'componentsToDelete':[..._0x5778fb[_0x3255c6(0x13b)],..._0x3988b1[_0x3255c6(0x13b)]],'componentsToUpdate':[..._0x5778fb[_0x3255c6(0x164)],..._0x3988b1[_0x3255c6(0x164)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x6656c['manifests']['length']&&await this[_0x3255c6(0x165)](_0x6656c['manifests'],!![]),_0x6656c['componentsToUpdate'][_0x3255c6(0x169)]&&await this[_0x3255c6(0x165)](_0x6656c[_0x3255c6(0x164)],!![]),_0x6656c[_0x3255c6(0x13b)][_0x3255c6(0x169)]&&await this[_0x3255c6(0x165)](_0x6656c[_0x3255c6(0x13b)],!![]);}async[a233_0x3da0e8(0x137)](_0x30b233){const _0x5ed801=a233_0x3da0e8;this[_0x5ed801(0x14f)][_0x5ed801(0x13d)]?await this[_0x5ed801(0x132)](_0x30b233):await this['proceedCommitsToRepository'](_0x30b233);}}exports[a233_0x3da0e8(0x14b)]=SalesforceCommitsManager;