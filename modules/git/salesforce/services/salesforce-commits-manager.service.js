const a176_0x1508ee=a176_0x4396;(function(_0x5abeaf,_0x20d3c3){const _0x35d0dc=a176_0x4396,_0x535a2d=_0x5abeaf();while(!![]){try{const _0x26b3f4=-parseInt(_0x35d0dc(0xdd))/0x1+parseInt(_0x35d0dc(0x10e))/0x2+parseInt(_0x35d0dc(0xfc))/0x3*(-parseInt(_0x35d0dc(0xd2))/0x4)+-parseInt(_0x35d0dc(0xec))/0x5*(-parseInt(_0x35d0dc(0x105))/0x6)+parseInt(_0x35d0dc(0xe2))/0x7*(parseInt(_0x35d0dc(0x107))/0x8)+-parseInt(_0x35d0dc(0xd8))/0x9*(parseInt(_0x35d0dc(0xdc))/0xa)+-parseInt(_0x35d0dc(0x115))/0xb*(-parseInt(_0x35d0dc(0x10f))/0xc);if(_0x26b3f4===_0x20d3c3)break;else _0x535a2d['push'](_0x535a2d['shift']());}catch(_0x4a6090){_0x535a2d['push'](_0x535a2d['shift']());}}}(a176_0x5ad0,0x5c98d));const a176_0x4a3d6f=(function(){let _0x112bcb=!![];return function(_0x3a1081,_0x318ba2){const _0x58fa80=_0x112bcb?function(){const _0x9f5202=a176_0x4396;if(_0x318ba2){const _0x58f0a6=_0x318ba2[_0x9f5202(0xe8)](_0x3a1081,arguments);return _0x318ba2=null,_0x58f0a6;}}:function(){};return _0x112bcb=![],_0x58fa80;};}()),a176_0x2f5003=a176_0x4a3d6f(this,function(){const _0x365978=a176_0x4396;return a176_0x2f5003[_0x365978(0xe7)]()[_0x365978(0xfa)](_0x365978(0xeb))['toString']()['constructor'](a176_0x2f5003)[_0x365978(0xfa)](_0x365978(0xeb));});function a176_0x4396(_0x3b2489,_0x12e2b0){const _0x5c4c34=a176_0x5ad0();return a176_0x4396=function(_0x2f5003,_0x4a3d6f){_0x2f5003=_0x2f5003-0xc8;let _0x5ad0eb=_0x5c4c34[_0x2f5003];return _0x5ad0eb;},a176_0x4396(_0x3b2489,_0x12e2b0);}a176_0x2f5003();'use strict';var __importDefault=this&&this[a176_0x1508ee(0xd7)]||function(_0x304969){return _0x304969&&_0x304969['__esModule']?_0x304969:{'default':_0x304969};};function a176_0x5ad0(){const _0x55cbb6=['SalesforceError','default','257782VfKZns','Sending\x20','gitSync','../errors/salesforce.error','send','toString','apply','recordTypes','proceedRequests','(((.+)+)+)+$','710UYJoRH','removed','find','map','../utils/composite.utils','composite','COMPONENTS_PER_CHUNK','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','modified','reference','SalesforceGitSyncService','../../../shared/utils','delete','componentsToDelete','search','proceededComponentsMeta','39498zBrIHj','splice','manifests','stringify','branchId','sfLogger','error','update','options','12276gIjguo','defineProperty','8zrIqlt','commitId','author','../../../../core','./salesforce-composite.service','logger','length','390748RhxQbw','12dAMWMb','SalesforceCommitsManager','toJSON','log','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','componentsToUpdate','13459897OMrkNr','inserted','executeGraphs','proceedCommitsToRepository','./salesforce-git-sync.service','repositoryId','floor','insert','extractComponentIdsFromGraphsResponse','push','\x20requests\x20to\x20composite\x20api.','chunkArray','28SgBqin','graph','reduce','proceedCommitsToBranch','SalesforceCompositeService','__importDefault','2151OdwAYp','Logger','getProceededComponentsMeta','SalesforceComponentsManager','26480eXLYhA','642048boegVf','proceedCommits','./salesforce-components-manager.service'];a176_0x5ad0=function(){return _0x55cbb6;};return a176_0x5ad0();}Object[a176_0x1508ee(0x106)](exports,'__esModule',{'value':!![]}),exports[a176_0x1508ee(0x110)]=void 0x0;const core_1=require(a176_0x1508ee(0x10a)),typedi_1=__importDefault(require('typedi')),constants_1=require('../../../../constants'),utils_1=require(a176_0x1508ee(0xf7)),salesforce_error_1=require(a176_0x1508ee(0xe5)),composite_utils_1=require(a176_0x1508ee(0xf0)),salesforce_components_manager_service_1=require(a176_0x1508ee(0xdf)),salesforce_composite_service_1=require(a176_0x1508ee(0x10b)),salesforce_git_sync_service_1=require(a176_0x1508ee(0xca));class SalesforceCommitsManager{constructor(_0x34ccb3){const _0x4e5a1f=a176_0x1508ee;this['options']=_0x34ccb3,this[_0x4e5a1f(0xf2)]=0x3,this[_0x4e5a1f(0x10c)]=new core_1[(_0x4e5a1f(0xd9))](SalesforceCommitsManager['name']),this[_0x4e5a1f(0x101)]=this[_0x4e5a1f(0x104)][_0x4e5a1f(0x10c)],this[_0x4e5a1f(0xf1)]=typedi_1['default']['get'](salesforce_composite_service_1[_0x4e5a1f(0xd6)]),this[_0x4e5a1f(0xe4)]=typedi_1[_0x4e5a1f(0xe1)]['get'](salesforce_git_sync_service_1[_0x4e5a1f(0xf6)]),this[_0x4e5a1f(0xfb)]=[];}async[a176_0x1508ee(0xea)](_0x4cae5e,_0x44d386=![]){const _0x20db4f=a176_0x1508ee,_0x43e68b=(this[_0x20db4f(0xf2)]+ +_0x44d386)*0x3,_0x403a0c=utils_1[_0x20db4f(0xd1)](_0x4cae5e,_0x43e68b);try{while(_0x403a0c[_0x20db4f(0x10d)]){const _0x244eb5=_0x403a0c[_0x20db4f(0xfd)](0x0,Math[_0x20db4f(0xcc)](constants_1[_0x20db4f(0x113)]/_0x43e68b));await this['sfLogger'][_0x20db4f(0x112)](_0x20db4f(0xe3)+_0x244eb5[_0x20db4f(0x10d)]*_0x43e68b+_0x20db4f(0xd0))[_0x20db4f(0xe6)]();const _0x175d1c=_0x244eb5[_0x20db4f(0xef)]((_0x535ca8,_0x29c8d1)=>({'graphId':_0x20db4f(0xd3)+_0x29c8d1,'compositeRequest':_0x535ca8})),_0x4e36f1=await this['composite'][_0x20db4f(0xc8)](_0x175d1c);if(_0x44d386){const _0x4bc544=composite_utils_1[_0x20db4f(0xce)](_0x4e36f1);for(const {id:_0x1a027a,ref:_0x45389c}of _0x4bc544){const _0x11eaa7=this['proceededComponentsMeta'][_0x20db4f(0xee)](_0x2720f0=>_0x2720f0[_0x20db4f(0xf5)]===_0x45389c);_0x11eaa7&&(_0x11eaa7['componentId']=_0x1a027a);}}}}catch(_0x462223){this['logger'][_0x20db4f(0x102)](_0x462223 instanceof salesforce_error_1[_0x20db4f(0xe0)]?JSON[_0x20db4f(0xff)](_0x462223[_0x20db4f(0x111)](),null,0x2):_0x462223),this[_0x20db4f(0x101)][_0x20db4f(0x112)](_0x462223 instanceof salesforce_error_1[_0x20db4f(0xe0)]?JSON[_0x20db4f(0xff)](_0x462223[_0x20db4f(0x111)](),null,0x2):_0x462223[_0x20db4f(0xe7)]());throw _0x462223;}}async[a176_0x1508ee(0xc9)](_0x3a9d23){const _0x25ede8=a176_0x1508ee;for(const _0x2fa4c0 of _0x3a9d23){if(!_0x2fa4c0['inserted'][_0x25ede8(0x10d)]&&!_0x2fa4c0['modified'][_0x25ede8(0x10d)]&&!_0x2fa4c0[_0x25ede8(0xed)][_0x25ede8(0x10d)])continue;const _0x40f6b5=[],_0x6f7b65=[],_0xe793e1=new salesforce_components_manager_service_1[(_0x25ede8(0xdb))](this[_0x25ede8(0x104)][_0x25ede8(0xcb)],this[_0x25ede8(0x104)][_0x25ede8(0x100)],_0x2fa4c0[_0x25ede8(0x109)],this[_0x25ede8(0x104)][_0x25ede8(0xe9)],this[_0x25ede8(0xfb)]);_0x40f6b5[_0x25ede8(0xcf)](...await _0xe793e1['insert'](_0x2fa4c0[_0x25ede8(0x116)],this[_0x25ede8(0x104)][_0x25ede8(0x108)])),_0x40f6b5[_0x25ede8(0xcf)](...await _0xe793e1[_0x25ede8(0x103)](_0x2fa4c0[_0x25ede8(0xf4)],this['options'][_0x25ede8(0x108)])),_0x6f7b65['push'](await _0xe793e1[_0x25ede8(0xf8)](_0x2fa4c0['removed'],!![])),this[_0x25ede8(0xfb)]=_0xe793e1[_0x25ede8(0xda)](),await this['proceedRequests'](_0x40f6b5,!![]);for(const _0x12f669 of _0x6f7b65){_0x12f669[_0x25ede8(0xfe)][_0x25ede8(0x10d)]&&await this[_0x25ede8(0xea)](_0x12f669[_0x25ede8(0xfe)],!![]),_0x12f669['componentsToUpdate']['length']&&await this[_0x25ede8(0xea)](_0x12f669[_0x25ede8(0x114)],!![]),_0x12f669['componentsToDelete'][_0x25ede8(0x10d)]&&await this[_0x25ede8(0xea)](_0x12f669['componentsToDelete'],!![]);}this[_0x25ede8(0x10c)][_0x25ede8(0x112)](_0x25ede8(0xf3),_0x40f6b5[_0x25ede8(0x10d)]);}}async[a176_0x1508ee(0xd5)](_0x55fe07){const _0x2bcd05=a176_0x1508ee,_0x33ef10=[],_0x1088f4=[];for(const _0x23efb3 of _0x55fe07){if(!_0x23efb3[_0x2bcd05(0x116)]['length']&&!_0x23efb3[_0x2bcd05(0xf4)][_0x2bcd05(0x10d)]&&!_0x23efb3[_0x2bcd05(0xed)][_0x2bcd05(0x10d)])continue;const _0x5bb1ec=new salesforce_components_manager_service_1[(_0x2bcd05(0xdb))](this[_0x2bcd05(0x104)][_0x2bcd05(0xcb)],this['options']['branchId'],_0x23efb3['author'],this['options'][_0x2bcd05(0xe9)],[]);_0x33ef10[_0x2bcd05(0xcf)](...await _0x5bb1ec[_0x2bcd05(0xcd)](_0x23efb3[_0x2bcd05(0x116)])),_0x33ef10[_0x2bcd05(0xcf)](...await _0x5bb1ec['update'](_0x23efb3[_0x2bcd05(0xf4)])),_0x1088f4['push'](await _0x5bb1ec[_0x2bcd05(0xf8)](_0x23efb3[_0x2bcd05(0xed)]));}this[_0x2bcd05(0x10c)]['log']('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x33ef10[_0x2bcd05(0x10d)]),await this['proceedRequests'](_0x33ef10);const _0x6ac77d=_0x1088f4[_0x2bcd05(0xd4)]((_0x38539c,_0x38e12f)=>({'manifests':[..._0x38539c[_0x2bcd05(0xfe)],..._0x38e12f[_0x2bcd05(0xfe)]],'componentsToDelete':[..._0x38539c[_0x2bcd05(0xf9)],..._0x38e12f[_0x2bcd05(0xf9)]],'componentsToUpdate':[..._0x38539c[_0x2bcd05(0x114)],..._0x38e12f['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x6ac77d['manifests'][_0x2bcd05(0x10d)]&&await this[_0x2bcd05(0xea)](_0x6ac77d[_0x2bcd05(0xfe)],!![]),_0x6ac77d[_0x2bcd05(0x114)][_0x2bcd05(0x10d)]&&await this[_0x2bcd05(0xea)](_0x6ac77d['componentsToUpdate'],!![]),_0x6ac77d['componentsToDelete'][_0x2bcd05(0x10d)]&&await this['proceedRequests'](_0x6ac77d[_0x2bcd05(0xf9)],!![]);}async[a176_0x1508ee(0xde)](_0x512741){const _0x2cbb6e=a176_0x1508ee;this['options']['branchId']?await this['proceedCommitsToBranch'](_0x512741):await this[_0x2cbb6e(0xc9)](_0x512741);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;