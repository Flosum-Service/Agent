const a228_0x5c06be=a228_0x12aa;(function(_0x19a883,_0x601d4){const _0x31dec8=a228_0x12aa,_0x73d79a=_0x19a883();while(!![]){try{const _0x789441=-parseInt(_0x31dec8(0xb1))/0x1+-parseInt(_0x31dec8(0xd8))/0x2*(parseInt(_0x31dec8(0xba))/0x3)+-parseInt(_0x31dec8(0xe5))/0x4+parseInt(_0x31dec8(0xae))/0x5+-parseInt(_0x31dec8(0xe3))/0x6+-parseInt(_0x31dec8(0xa6))/0x7*(-parseInt(_0x31dec8(0xc0))/0x8)+-parseInt(_0x31dec8(0xe8))/0x9*(-parseInt(_0x31dec8(0xa9))/0xa);if(_0x789441===_0x601d4)break;else _0x73d79a['push'](_0x73d79a['shift']());}catch(_0x348b5b){_0x73d79a['push'](_0x73d79a['shift']());}}}(a228_0x21b8,0x82533));const a228_0x480ea1=(function(){let _0x215aa1=!![];return function(_0x256d10,_0x369f7b){const _0x58d505=_0x215aa1?function(){if(_0x369f7b){const _0x4258aa=_0x369f7b['apply'](_0x256d10,arguments);return _0x369f7b=null,_0x4258aa;}}:function(){};return _0x215aa1=![],_0x58d505;};}()),a228_0x3f5d55=a228_0x480ea1(this,function(){const _0x260225=a228_0x12aa;return a228_0x3f5d55[_0x260225(0xe9)]()[_0x260225(0xea)](_0x260225(0xcc))['toString']()[_0x260225(0xef)](a228_0x3f5d55)['search']('(((.+)+)+)+$');});a228_0x3f5d55();function a228_0x12aa(_0x524c75,_0x4e2433){const _0x5bca5b=a228_0x21b8();return a228_0x12aa=function(_0x3f5d55,_0x480ea1){_0x3f5d55=_0x3f5d55-0xa4;let _0x21b864=_0x5bca5b[_0x3f5d55];return _0x21b864;},a228_0x12aa(_0x524c75,_0x4e2433);}function a228_0x21b8(){const _0x2ff46c=['5192682dvFSPR','../errors/salesforce.error','2344880LcCsYT','./salesforce-composite.service','composite','376137JinxNS','toString','search','branchId','componentsToDelete','SALESFORCE_MAX_REQUEST_SIZE_BYTES','insert','constructor','proceedRequests','error','4119486wCbIQy','commitId','proceedCommits','280BXFXuD','reduce','SalesforceCompositeService','get','author','2822985KEtPgh','inserted','reference','232062hKnTML','../../../../constants','stringify','componentsToUpdate','../../../../core','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','proceededComponentsMeta','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','__importDefault','317277gooIYI','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','getProceededComponentsMeta','typedi','recordTypes','log','8QSXksM','map','logger','graph','push','removed','chunkArray','length','manifests','find','\x20COMPONENTS_SIZE\x20=\x20','proceedChunksToUpload','(((.+)+)+)+$','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','proceedCommitsToRepository','update','SalesforceCommitsManager','extractComponentIdsFromGraphsResponse','__esModule','delete','SalesforceError','modified','repositoryId','../../../shared/utils','2gVHVXQ','COMPONENTS_PER_CHUNK','toJSON','proceedCommitsToBranch','Sending\x20','sfLogger','Logger','componentId','SalesforceComponentsManager','./salesforce-components-manager.service','options'];a228_0x21b8=function(){return _0x2ff46c;};return a228_0x21b8();}'use strict';var __importDefault=this&&this[a228_0x5c06be(0xb9)]||function(_0x56b064){return _0x56b064&&_0x56b064['__esModule']?_0x56b064:{'default':_0x56b064};};Object['defineProperty'](exports,a228_0x5c06be(0xd2),{'value':!![]}),exports[a228_0x5c06be(0xd0)]=void 0x0;const core_1=require(a228_0x5c06be(0xb5)),typedi_1=__importDefault(require(a228_0x5c06be(0xbd))),constants_1=require(a228_0x5c06be(0xb2)),utils_1=require(a228_0x5c06be(0xd7)),salesforce_error_1=require(a228_0x5c06be(0xe4)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a228_0x5c06be(0xe1)),salesforce_composite_service_1=require(a228_0x5c06be(0xe6));class SalesforceCommitsManager{constructor(_0x36b07f){const _0x4cbead=a228_0x5c06be;this['options']=_0x36b07f,this[_0x4cbead(0xd9)]=0x3,this[_0x4cbead(0xc2)]=new core_1[(_0x4cbead(0xde))](SalesforceCommitsManager['name']),this[_0x4cbead(0xdd)]=this[_0x4cbead(0xe2)][_0x4cbead(0xc2)],this[_0x4cbead(0xe7)]=typedi_1['default'][_0x4cbead(0xac)](salesforce_composite_service_1[_0x4cbead(0xab)]),this['proceededComponentsMeta']=[];}async[a228_0x5c06be(0xcb)](_0x5ec780,_0x5c440f=![]){const _0xe102a2=a228_0x5c06be,_0x1add12=async _0x1dcefa=>{const _0x1eb44b=a228_0x12aa;await this[_0x1eb44b(0xc2)]['log'](_0x1eb44b(0xdc)+_0x1dcefa[_0x1eb44b(0xaa)]((_0x338c8e,_0xc665b0)=>_0x338c8e+_0xc665b0['length'],0x0)+'\x20requests\x20to\x20composite\x20api.');const _0x5b4151=_0x1dcefa[_0x1eb44b(0xc1)]((_0x245e3,_0xe325e1)=>({'graphId':_0x1eb44b(0xc3)+_0xe325e1,'compositeRequest':_0x245e3})),_0x1e0b05=await this['composite']['executeGraphs'](_0x5b4151);if(_0x5c440f){const _0x3c7d79=(0x0,composite_utils_1[_0x1eb44b(0xd1)])(_0x1e0b05);for(const {id:_0x1b45e7,ref:_0x2faf63}of _0x3c7d79){const _0x59c705=this[_0x1eb44b(0xb7)][_0x1eb44b(0xc9)](_0x2f241c=>_0x2f241c[_0x1eb44b(0xb0)]===_0x2faf63);_0x59c705&&(_0x59c705[_0x1eb44b(0xdf)]=_0x1b45e7);}}},_0x1f1d59=0x1e8480;let _0x2fda5e=0x0,_0x3593c4=[];for(const _0x4b6619 of _0x5ec780){const _0x1a3416=_0x4b6619[_0xe102a2(0xaa)]((_0x356b99,_0x2123c4)=>{const _0x10f9ae=_0xe102a2,_0x35f702=JSON[_0x10f9ae(0xb3)](_0x2123c4)[_0x10f9ae(0xc7)]*0x2;return _0x356b99+_0x35f702;},0x0);if(_0x1a3416>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1[(_0xe102a2(0xd4))](_0xe102a2(0xb6)+constants_1[_0xe102a2(0xed)]+_0xe102a2(0xca)+_0x1a3416);_0x2fda5e+_0x1a3416>constants_1[_0xe102a2(0xed)]-_0x1f1d59&&(await _0x1add12(_0x3593c4),_0x3593c4=[],_0x2fda5e=0x0),_0x2fda5e+=_0x1a3416,_0x3593c4[_0xe102a2(0xc4)](_0x4b6619);}_0x3593c4[_0xe102a2(0xc7)]&&await _0x1add12(_0x3593c4);}async[a228_0x5c06be(0xa4)](_0x4bd122,_0x5b6447=![]){const _0x8fc385=a228_0x5c06be,_0x29884b=(this['COMPONENTS_PER_CHUNK']+ +_0x5b6447)*0x3,_0x2ff95b=(0x0,utils_1[_0x8fc385(0xc6)])(_0x4bd122,_0x29884b);try{while(_0x2ff95b[_0x8fc385(0xc7)]){const _0x432e50=_0x2ff95b['splice'](0x0,Math['floor'](constants_1[_0x8fc385(0xb8)]/_0x29884b));await this[_0x8fc385(0xcb)](_0x432e50,_0x5b6447);}}catch(_0x3ddb58){this[_0x8fc385(0xc2)][_0x8fc385(0xa5)](_0x3ddb58 instanceof salesforce_error_1[_0x8fc385(0xd4)]?JSON['stringify'](_0x3ddb58['toJSON'](),null,0x2):_0x3ddb58),this[_0x8fc385(0xdd)][_0x8fc385(0xbf)](_0x3ddb58 instanceof salesforce_error_1[_0x8fc385(0xd4)]?JSON['stringify'](_0x3ddb58[_0x8fc385(0xda)](),null,0x2):_0x3ddb58['toString']());throw _0x3ddb58;}}async[a228_0x5c06be(0xce)](_0x17500c){const _0x11e22b=a228_0x5c06be;for(const _0x19fd46 of _0x17500c){if(!_0x19fd46[_0x11e22b(0xaf)][_0x11e22b(0xc7)]&&!_0x19fd46[_0x11e22b(0xd5)]['length']&&!_0x19fd46['removed'][_0x11e22b(0xc7)])continue;const _0x537cda=[],_0x5d3ada=[],_0x2ad92c=new salesforce_components_manager_service_1[(_0x11e22b(0xe0))](this[_0x11e22b(0xe2)][_0x11e22b(0xd6)],this[_0x11e22b(0xe2)][_0x11e22b(0xeb)],_0x19fd46['author'],this[_0x11e22b(0xe2)][_0x11e22b(0xbe)],this[_0x11e22b(0xb7)]);_0x537cda[_0x11e22b(0xc4)](...await _0x2ad92c['insert'](_0x19fd46['inserted'],this[_0x11e22b(0xe2)][_0x11e22b(0xa7)])),_0x537cda[_0x11e22b(0xc4)](...await _0x2ad92c[_0x11e22b(0xcf)](_0x19fd46[_0x11e22b(0xd5)],this[_0x11e22b(0xe2)][_0x11e22b(0xa7)])),_0x5d3ada[_0x11e22b(0xc4)](await _0x2ad92c[_0x11e22b(0xd3)](_0x19fd46[_0x11e22b(0xc5)],!![])),this['proceededComponentsMeta']=_0x2ad92c[_0x11e22b(0xbc)](),await this['proceedRequests'](_0x537cda,!![]);for(const _0x5ca74a of _0x5d3ada){_0x5ca74a[_0x11e22b(0xc8)][_0x11e22b(0xc7)]&&await this['proceedRequests'](_0x5ca74a[_0x11e22b(0xc8)],!![]),_0x5ca74a['componentsToUpdate']['length']&&await this[_0x11e22b(0xa4)](_0x5ca74a[_0x11e22b(0xb4)],!![]),_0x5ca74a['componentsToDelete'][_0x11e22b(0xc7)]&&await this['proceedRequests'](_0x5ca74a[_0x11e22b(0xec)],!![]);}this[_0x11e22b(0xc2)]['log'](_0x11e22b(0xbb),_0x537cda[_0x11e22b(0xc7)]);}}async[a228_0x5c06be(0xdb)](_0x3462f9){const _0x5d8e71=a228_0x5c06be,_0x41e693=[],_0x243942=[];for(const _0x23e257 of _0x3462f9){if(!_0x23e257['inserted']['length']&&!_0x23e257[_0x5d8e71(0xd5)][_0x5d8e71(0xc7)]&&!_0x23e257['removed'][_0x5d8e71(0xc7)])continue;const _0x2d0c19=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x5d8e71(0xe2)][_0x5d8e71(0xd6)],this[_0x5d8e71(0xe2)][_0x5d8e71(0xeb)],_0x23e257[_0x5d8e71(0xad)],this[_0x5d8e71(0xe2)][_0x5d8e71(0xbe)],[]);_0x41e693[_0x5d8e71(0xc4)](...await _0x2d0c19[_0x5d8e71(0xee)](_0x23e257[_0x5d8e71(0xaf)])),_0x41e693[_0x5d8e71(0xc4)](...await _0x2d0c19[_0x5d8e71(0xcf)](_0x23e257['modified'])),_0x243942[_0x5d8e71(0xc4)](await _0x2d0c19[_0x5d8e71(0xd3)](_0x23e257[_0x5d8e71(0xc5)]));}this[_0x5d8e71(0xc2)][_0x5d8e71(0xbf)](_0x5d8e71(0xcd),_0x41e693['length']),await this[_0x5d8e71(0xa4)](_0x41e693);const _0x393895=_0x243942[_0x5d8e71(0xaa)]((_0x1ed44f,_0x11e1fc)=>({'manifests':[..._0x1ed44f[_0x5d8e71(0xc8)],..._0x11e1fc[_0x5d8e71(0xc8)]],'componentsToDelete':[..._0x1ed44f[_0x5d8e71(0xec)],..._0x11e1fc[_0x5d8e71(0xec)]],'componentsToUpdate':[..._0x1ed44f[_0x5d8e71(0xb4)],..._0x11e1fc[_0x5d8e71(0xb4)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x393895['manifests']['length']&&await this[_0x5d8e71(0xa4)](_0x393895[_0x5d8e71(0xc8)],!![]),_0x393895[_0x5d8e71(0xb4)][_0x5d8e71(0xc7)]&&await this['proceedRequests'](_0x393895[_0x5d8e71(0xb4)],!![]),_0x393895[_0x5d8e71(0xec)]['length']&&await this[_0x5d8e71(0xa4)](_0x393895[_0x5d8e71(0xec)],!![]);}async[a228_0x5c06be(0xa8)](_0xcc4e87){const _0x2edbdd=a228_0x5c06be;this[_0x2edbdd(0xe2)][_0x2edbdd(0xeb)]?await this[_0x2edbdd(0xdb)](_0xcc4e87):await this['proceedCommitsToRepository'](_0xcc4e87);}}exports[a228_0x5c06be(0xd0)]=SalesforceCommitsManager;