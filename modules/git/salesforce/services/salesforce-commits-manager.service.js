const a270_0xb9ff94=a270_0x222b;function a270_0x241e(){const _0x320a09=['stringify','recordTypes','13644jZTAGQ','find','(((.+)+)+)+$','99767xKwmpM','__esModule','../../../shared/utils','SalesforceError','toJSON','log','getProceededComponentsMeta','proceededComponentsMeta','./salesforce-composite.service','branchId','reference','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','__importDefault','delete','SalesforceCommitsManager','modified','reduce','Sending\x20','length','\x20COMPONENTS_SIZE\x20=\x20','COMPONENTS_PER_CHUNK','get','2skxGGI','extractComponentIdsFromGraphsResponse','logger','Logger','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','removed','default','defineProperty','proceedCommits','2142kzNOku','9800Qqyckd','options','../../../../constants','../utils/composite.utils','componentsToDelete','search','floor','proceedCommitsToBranch','2617345aolsBC','../errors/salesforce.error','chunkArray','componentsToUpdate','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','\x20requests\x20to\x20composite\x20api.','constructor','apply','typedi','159WPQQKL','SalesforceComponentsManager','sfLogger','14355lPitRZ','4152050nISqaH','toString','update','composite','repositoryId','SALESFORCE_MAX_REQUEST_SIZE_BYTES','46316KpdYSx','insert','manifests','446064towipc','error','author','proceedRequests','commitId','inserted','proceedChunksToUpload','63UbpXco','push','../../../../core','executeGraphs','componentId','proceedCommitsToRepository'];a270_0x241e=function(){return _0x320a09;};return a270_0x241e();}(function(_0x3248a6,_0x1d8742){const _0x3b557b=a270_0x222b,_0x2988c6=_0x3248a6();while(!![]){try{const _0xf3f66f=parseInt(_0x3b557b(0x1a8))/0x1*(-parseInt(_0x3b557b(0x1be))/0x2)+-parseInt(_0x3b557b(0x1d9))/0x3*(-parseInt(_0x3b557b(0x1e3))/0x4)+parseInt(_0x3b557b(0x1d0))/0x5+-parseInt(_0x3b557b(0x1e6))/0x6*(-parseInt(_0x3b557b(0x1ed))/0x7)+-parseInt(_0x3b557b(0x1c8))/0x8*(parseInt(_0x3b557b(0x1c7))/0x9)+parseInt(_0x3b557b(0x1dd))/0xa+-parseInt(_0x3b557b(0x1dc))/0xb*(parseInt(_0x3b557b(0x1a5))/0xc);if(_0xf3f66f===_0x1d8742)break;else _0x2988c6['push'](_0x2988c6['shift']());}catch(_0x189dec){_0x2988c6['push'](_0x2988c6['shift']());}}}(a270_0x241e,0x548f3));function a270_0x222b(_0x5d69c2,_0x3aaf43){const _0x43d94d=a270_0x241e();return a270_0x222b=function(_0x229ea2,_0x1cc99b){_0x229ea2=_0x229ea2-0x1a5;let _0x241e5d=_0x43d94d[_0x229ea2];return _0x241e5d;},a270_0x222b(_0x5d69c2,_0x3aaf43);}const a270_0x1cc99b=(function(){let _0x513956=!![];return function(_0x53c843,_0x3ac1f2){const _0x432e10=_0x513956?function(){const _0xa1a15b=a270_0x222b;if(_0x3ac1f2){const _0x1f39ae=_0x3ac1f2[_0xa1a15b(0x1d7)](_0x53c843,arguments);return _0x3ac1f2=null,_0x1f39ae;}}:function(){};return _0x513956=![],_0x432e10;};}()),a270_0x229ea2=a270_0x1cc99b(this,function(){const _0x498101=a270_0x222b;return a270_0x229ea2[_0x498101(0x1de)]()[_0x498101(0x1cd)](_0x498101(0x1a7))[_0x498101(0x1de)]()[_0x498101(0x1d6)](a270_0x229ea2)[_0x498101(0x1cd)](_0x498101(0x1a7));});a270_0x229ea2();'use strict';var __importDefault=this&&this[a270_0xb9ff94(0x1b4)]||function(_0x56bcc3){const _0x5b22e2=a270_0xb9ff94;return _0x56bcc3&&_0x56bcc3[_0x5b22e2(0x1a9)]?_0x56bcc3:{'default':_0x56bcc3};};Object[a270_0xb9ff94(0x1c5)](exports,a270_0xb9ff94(0x1a9),{'value':!![]}),exports[a270_0xb9ff94(0x1b6)]=void 0x0;const core_1=require(a270_0xb9ff94(0x1ef)),typedi_1=__importDefault(require(a270_0xb9ff94(0x1d8))),constants_1=require(a270_0xb9ff94(0x1ca)),utils_1=require(a270_0xb9ff94(0x1aa)),salesforce_error_1=require(a270_0xb9ff94(0x1d1)),composite_utils_1=require(a270_0xb9ff94(0x1cb)),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a270_0xb9ff94(0x1b0));class SalesforceCommitsManager{constructor(_0x2db230){const _0x2ab979=a270_0xb9ff94;this[_0x2ab979(0x1c9)]=_0x2db230,this[_0x2ab979(0x1bc)]=0x3,this[_0x2ab979(0x1c0)]=new core_1[(_0x2ab979(0x1c1))](SalesforceCommitsManager['name']),this[_0x2ab979(0x1db)]=this[_0x2ab979(0x1c9)]['logger'],this[_0x2ab979(0x1e0)]=typedi_1[_0x2ab979(0x1c4)][_0x2ab979(0x1bd)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x2ab979(0x1af)]=[];}async[a270_0xb9ff94(0x1ec)](_0x5c0d5d,_0x340c95=![]){const _0x13a66a=a270_0xb9ff94,_0x590e48=async _0x58e398=>{const _0x2f9e51=a270_0x222b;await this[_0x2f9e51(0x1c0)][_0x2f9e51(0x1ad)](_0x2f9e51(0x1b9)+_0x58e398[_0x2f9e51(0x1b8)]((_0x563b02,_0xd901ff)=>_0x563b02+_0xd901ff[_0x2f9e51(0x1ba)],0x0)+_0x2f9e51(0x1d5));const _0xd1dbc8=_0x58e398['map']((_0x4d9620,_0x439391)=>({'graphId':'graph'+_0x439391,'compositeRequest':_0x4d9620})),_0x5bcc81=await this[_0x2f9e51(0x1e0)][_0x2f9e51(0x1f0)](_0xd1dbc8);if(_0x340c95){const _0x58395e=(0x0,composite_utils_1[_0x2f9e51(0x1bf)])(_0x5bcc81);for(const {id:_0x4f4fb0,ref:_0x1414b4}of _0x58395e){const _0x4d1b4d=this['proceededComponentsMeta'][_0x2f9e51(0x1a6)](_0x116249=>_0x116249[_0x2f9e51(0x1b2)]===_0x1414b4);_0x4d1b4d&&(_0x4d1b4d[_0x2f9e51(0x1f1)]=_0x4f4fb0);}}},_0x57157a=0x1e8480;let _0x2a8f5c=0x0,_0xb44a59=[];for(const _0x5ba5e8 of _0x5c0d5d){const _0x39bdd3=_0x5ba5e8['reduce']((_0x2368d3,_0x3b6762)=>{const _0x492b88=a270_0x222b,_0x3307a1=JSON['stringify'](_0x3b6762)[_0x492b88(0x1ba)]*0x2;return _0x2368d3+_0x3307a1;},0x0);if(_0x39bdd3>constants_1[_0x13a66a(0x1e2)])throw new salesforce_error_1[(_0x13a66a(0x1ab))](_0x13a66a(0x1d4)+constants_1[_0x13a66a(0x1e2)]+_0x13a66a(0x1bb)+_0x39bdd3);_0x2a8f5c+_0x39bdd3>constants_1[_0x13a66a(0x1e2)]-_0x57157a&&(await _0x590e48(_0xb44a59),_0xb44a59=[],_0x2a8f5c=0x0),_0x2a8f5c+=_0x39bdd3,_0xb44a59[_0x13a66a(0x1ee)](_0x5ba5e8);}_0xb44a59[_0x13a66a(0x1ba)]&&await _0x590e48(_0xb44a59);}async['proceedRequests'](_0x7182a6,_0x1f8b28=![]){const _0xb32deb=a270_0xb9ff94,_0x48c961=(this['COMPONENTS_PER_CHUNK']+ +_0x1f8b28)*0x3,_0xfe7c20=(0x0,utils_1[_0xb32deb(0x1d2)])(_0x7182a6,_0x48c961);try{while(_0xfe7c20[_0xb32deb(0x1ba)]){const _0x321820=_0xfe7c20['splice'](0x0,Math[_0xb32deb(0x1ce)](constants_1[_0xb32deb(0x1c2)]/_0x48c961));await this[_0xb32deb(0x1ec)](_0x321820,_0x1f8b28);}}catch(_0xd73b30){this['logger'][_0xb32deb(0x1e7)](_0xd73b30 instanceof salesforce_error_1['SalesforceError']?JSON[_0xb32deb(0x1f3)](_0xd73b30[_0xb32deb(0x1ac)](),null,0x2):_0xd73b30),this['sfLogger']['log'](_0xd73b30 instanceof salesforce_error_1[_0xb32deb(0x1ab)]?JSON[_0xb32deb(0x1f3)](_0xd73b30[_0xb32deb(0x1ac)](),null,0x2):_0xd73b30['toString']());throw _0xd73b30;}}async[a270_0xb9ff94(0x1f2)](_0x409e25){const _0x5723a5=a270_0xb9ff94;for(const _0x2c6022 of _0x409e25){if(!_0x2c6022[_0x5723a5(0x1eb)]['length']&&!_0x2c6022[_0x5723a5(0x1b7)][_0x5723a5(0x1ba)]&&!_0x2c6022[_0x5723a5(0x1c3)][_0x5723a5(0x1ba)])continue;const _0x236cd0=[],_0x25e0d7=[],_0x5a564d=new salesforce_components_manager_service_1[(_0x5723a5(0x1da))](this['options']['repositoryId'],this[_0x5723a5(0x1c9)]['branchId'],_0x2c6022[_0x5723a5(0x1e8)],this['options']['recordTypes'],this[_0x5723a5(0x1af)]);_0x236cd0[_0x5723a5(0x1ee)](...await _0x5a564d[_0x5723a5(0x1e4)](_0x2c6022[_0x5723a5(0x1eb)],this[_0x5723a5(0x1c9)][_0x5723a5(0x1ea)])),_0x236cd0[_0x5723a5(0x1ee)](...await _0x5a564d[_0x5723a5(0x1df)](_0x2c6022[_0x5723a5(0x1b7)],this[_0x5723a5(0x1c9)][_0x5723a5(0x1ea)])),_0x25e0d7['push'](await _0x5a564d[_0x5723a5(0x1b5)](_0x2c6022[_0x5723a5(0x1c3)],!![])),this[_0x5723a5(0x1af)]=_0x5a564d[_0x5723a5(0x1ae)](),await this[_0x5723a5(0x1e9)](_0x236cd0,!![]);for(const _0xfa169d of _0x25e0d7){_0xfa169d[_0x5723a5(0x1e5)][_0x5723a5(0x1ba)]&&await this['proceedRequests'](_0xfa169d['manifests'],!![]),_0xfa169d[_0x5723a5(0x1d3)][_0x5723a5(0x1ba)]&&await this[_0x5723a5(0x1e9)](_0xfa169d['componentsToUpdate'],!![]),_0xfa169d['componentsToDelete'][_0x5723a5(0x1ba)]&&await this['proceedRequests'](_0xfa169d[_0x5723a5(0x1cc)],!![]);}this[_0x5723a5(0x1c0)][_0x5723a5(0x1ad)]('Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x236cd0['length']);}}async[a270_0xb9ff94(0x1cf)](_0x2906c4){const _0x32c4c0=a270_0xb9ff94,_0xbfb62b=[],_0x263473=[];for(const _0x293c6a of _0x2906c4){if(!_0x293c6a[_0x32c4c0(0x1eb)][_0x32c4c0(0x1ba)]&&!_0x293c6a[_0x32c4c0(0x1b7)]['length']&&!_0x293c6a['removed']['length'])continue;const _0x1ac0f7=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x32c4c0(0x1c9)][_0x32c4c0(0x1e1)],this['options']['branchId'],_0x293c6a[_0x32c4c0(0x1e8)],this[_0x32c4c0(0x1c9)][_0x32c4c0(0x1f4)],[]);_0xbfb62b[_0x32c4c0(0x1ee)](...await _0x1ac0f7[_0x32c4c0(0x1e4)](_0x293c6a[_0x32c4c0(0x1eb)])),_0xbfb62b[_0x32c4c0(0x1ee)](...await _0x1ac0f7[_0x32c4c0(0x1df)](_0x293c6a[_0x32c4c0(0x1b7)])),_0x263473['push'](await _0x1ac0f7['delete'](_0x293c6a[_0x32c4c0(0x1c3)]));}this['logger'][_0x32c4c0(0x1ad)](_0x32c4c0(0x1b3),_0xbfb62b['length']),await this[_0x32c4c0(0x1e9)](_0xbfb62b);const _0x4283a1=_0x263473[_0x32c4c0(0x1b8)]((_0x4bc30f,_0x31b43b)=>({'manifests':[..._0x4bc30f[_0x32c4c0(0x1e5)],..._0x31b43b[_0x32c4c0(0x1e5)]],'componentsToDelete':[..._0x4bc30f[_0x32c4c0(0x1cc)],..._0x31b43b[_0x32c4c0(0x1cc)]],'componentsToUpdate':[..._0x4bc30f[_0x32c4c0(0x1d3)],..._0x31b43b[_0x32c4c0(0x1d3)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x4283a1['manifests'][_0x32c4c0(0x1ba)]&&await this[_0x32c4c0(0x1e9)](_0x4283a1[_0x32c4c0(0x1e5)],!![]),_0x4283a1[_0x32c4c0(0x1d3)][_0x32c4c0(0x1ba)]&&await this['proceedRequests'](_0x4283a1[_0x32c4c0(0x1d3)],!![]),_0x4283a1['componentsToDelete']['length']&&await this[_0x32c4c0(0x1e9)](_0x4283a1['componentsToDelete'],!![]);}async[a270_0xb9ff94(0x1c6)](_0x1e5507){const _0x1cc02b=a270_0xb9ff94;this[_0x1cc02b(0x1c9)][_0x1cc02b(0x1b1)]?await this['proceedCommitsToBranch'](_0x1e5507):await this[_0x1cc02b(0x1f2)](_0x1e5507);}}exports[a270_0xb9ff94(0x1b6)]=SalesforceCommitsManager;