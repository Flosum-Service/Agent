const a228_0x48978d=a228_0x1754;(function(_0x5e2f02,_0xa231db){const _0x5a3acb=a228_0x1754,_0xab1e60=_0x5e2f02();while(!![]){try{const _0x30f690=parseInt(_0x5a3acb(0x1ad))/0x1+-parseInt(_0x5a3acb(0x194))/0x2*(parseInt(_0x5a3acb(0x1c7))/0x3)+parseInt(_0x5a3acb(0x18d))/0x4+parseInt(_0x5a3acb(0x1bd))/0x5*(-parseInt(_0x5a3acb(0x19c))/0x6)+-parseInt(_0x5a3acb(0x1b1))/0x7+parseInt(_0x5a3acb(0x18e))/0x8+parseInt(_0x5a3acb(0x1a9))/0x9;if(_0x30f690===_0xa231db)break;else _0xab1e60['push'](_0xab1e60['shift']());}catch(_0x1255df){_0xab1e60['push'](_0xab1e60['shift']());}}}(a228_0x105f,0x4d78e));const a228_0x515c11=(function(){let _0x394fb1=!![];return function(_0x4f6a70,_0x5d2b4c){const _0x4f561a=_0x394fb1?function(){const _0x55dcb2=a228_0x1754;if(_0x5d2b4c){const _0x2c3428=_0x5d2b4c[_0x55dcb2(0x1b7)](_0x4f6a70,arguments);return _0x5d2b4c=null,_0x2c3428;}}:function(){};return _0x394fb1=![],_0x4f561a;};}()),a228_0x266bfa=a228_0x515c11(this,function(){const _0x3c1ced=a228_0x1754;return a228_0x266bfa[_0x3c1ced(0x19e)]()[_0x3c1ced(0x1c5)](_0x3c1ced(0x190))[_0x3c1ced(0x19e)]()[_0x3c1ced(0x1b5)](a228_0x266bfa)['search']('(((.+)+)+)+$');});a228_0x266bfa();'use strict';function a228_0x1754(_0x17ee6e,_0x27e9b5){const _0x2b3100=a228_0x105f();return a228_0x1754=function(_0x266bfa,_0x515c11){_0x266bfa=_0x266bfa-0x182;let _0x105f6c=_0x2b3100[_0x266bfa];return _0x105f6c;},a228_0x1754(_0x17ee6e,_0x27e9b5);}function a228_0x105f(){const _0xc6f473=['proceededComponentsMeta','options','../../../../core','\x20requests\x20to\x20composite\x20api.','2502756wbdjVO','845720nYYYwV','proceedCommits','(((.+)+)+)+$','recordTypes','chunkArray','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','1042iqPKUL','reference','log','\x20COMPONENTS_SIZE\x20=\x20','default','Logger','repositoryId','SalesforceComponentsManager','9822AgHvOL','push','toString','../utils/composite.utils','modified','graph','SalesforceError','defineProperty','get','COMPONENTS_PER_CHUNK','./salesforce-components-manager.service','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','../../../../constants','1670535Ubqpha','composite','find','__importDefault','302040xWnnRf','componentsToUpdate','branchId','typedi','1300971yxFpPz','manifests','author','stringify','constructor','SalesforceCommitsManager','apply','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','toJSON','reduce','../errors/salesforce.error','proceedCommitsToRepository','565zvTAPp','removed','inserted','map','componentId','length','Sending\x20','componentsToDelete','search','error','3057jUBFXQ','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','logger','delete','SALESFORCE_MAX_REQUEST_SIZE_BYTES','update','sfLogger','proceedRequests','floor','insert','proceedChunksToUpload','__esModule'];a228_0x105f=function(){return _0xc6f473;};return a228_0x105f();}var __importDefault=this&&this[a228_0x48978d(0x1ac)]||function(_0x3d4251){const _0x29c16d=a228_0x48978d;return _0x3d4251&&_0x3d4251[_0x29c16d(0x188)]?_0x3d4251:{'default':_0x3d4251};};Object[a228_0x48978d(0x1a3)](exports,a228_0x48978d(0x188),{'value':!![]}),exports[a228_0x48978d(0x1b6)]=void 0x0;const core_1=require(a228_0x48978d(0x18b)),typedi_1=__importDefault(require(a228_0x48978d(0x1b0))),constants_1=require(a228_0x48978d(0x1a8)),utils_1=require('../../../shared/utils'),salesforce_error_1=require(a228_0x48978d(0x1bb)),composite_utils_1=require(a228_0x48978d(0x19f)),salesforce_components_manager_service_1=require(a228_0x48978d(0x1a6)),salesforce_composite_service_1=require('./salesforce-composite.service');class SalesforceCommitsManager{constructor(_0x448494){const _0x5727b3=a228_0x48978d;this['options']=_0x448494,this[_0x5727b3(0x1a5)]=0x3,this[_0x5727b3(0x1c9)]=new core_1[(_0x5727b3(0x199))](SalesforceCommitsManager['name']),this[_0x5727b3(0x183)]=this[_0x5727b3(0x18a)][_0x5727b3(0x1c9)],this['composite']=typedi_1[_0x5727b3(0x198)][_0x5727b3(0x1a4)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x5727b3(0x189)]=[];}async[a228_0x48978d(0x187)](_0x3fbe3f,_0x4720e0=![]){const _0x4ad132=a228_0x48978d,_0x35b851=async _0x3e40e2=>{const _0x5a669b=a228_0x1754;await this[_0x5a669b(0x1c9)][_0x5a669b(0x196)](_0x5a669b(0x1c3)+_0x3e40e2[_0x5a669b(0x1ba)]((_0x30ac2d,_0x4bf298)=>_0x30ac2d+_0x4bf298[_0x5a669b(0x1c2)],0x0)+_0x5a669b(0x18c));const _0x44ce6a=_0x3e40e2[_0x5a669b(0x1c0)]((_0x58781f,_0x3d44d7)=>({'graphId':_0x5a669b(0x1a1)+_0x3d44d7,'compositeRequest':_0x58781f})),_0x2b05d2=await this[_0x5a669b(0x1aa)]['executeGraphs'](_0x44ce6a);if(_0x4720e0){const _0x47fd4d=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x2b05d2);for(const {id:_0x36d6ee,ref:_0xb128a4}of _0x47fd4d){const _0x5d2ea7=this[_0x5a669b(0x189)][_0x5a669b(0x1ab)](_0x5c08ba=>_0x5c08ba[_0x5a669b(0x195)]===_0xb128a4);_0x5d2ea7&&(_0x5d2ea7[_0x5a669b(0x1c1)]=_0x36d6ee);}}},_0x4e1146=0x1e8480;let _0x4e858f=0x0,_0x1a311f=[];for(const _0x25535c of _0x3fbe3f){const _0x5d206d=_0x25535c['reduce']((_0x3b9acc,_0x282788)=>{const _0x510c1b=a228_0x1754,_0x34db09=JSON[_0x510c1b(0x1b4)](_0x282788)[_0x510c1b(0x1c2)]*0x2;return _0x3b9acc+_0x34db09;},0x0);if(_0x5d206d>constants_1[_0x4ad132(0x1cb)])throw new salesforce_error_1[(_0x4ad132(0x1a2))](_0x4ad132(0x193)+constants_1[_0x4ad132(0x1cb)]+_0x4ad132(0x197)+_0x5d206d);_0x4e858f+_0x5d206d>constants_1[_0x4ad132(0x1cb)]-_0x4e1146&&(await _0x35b851(_0x1a311f),_0x1a311f=[],_0x4e858f=0x0),_0x4e858f+=_0x5d206d,_0x1a311f['push'](_0x25535c);}_0x1a311f['length']&&await _0x35b851(_0x1a311f);}async[a228_0x48978d(0x184)](_0x55c708,_0xa35526=![]){const _0x27a199=a228_0x48978d,_0x49e902=(this[_0x27a199(0x1a5)]+ +_0xa35526)*0x3,_0x2ce41c=(0x0,utils_1[_0x27a199(0x192)])(_0x55c708,_0x49e902);try{while(_0x2ce41c['length']){const _0x58cf18=_0x2ce41c['splice'](0x0,Math[_0x27a199(0x185)](constants_1[_0x27a199(0x1a7)]/_0x49e902));await this['proceedChunksToUpload'](_0x58cf18,_0xa35526);}}catch(_0x14546d){this[_0x27a199(0x1c9)][_0x27a199(0x1c6)](_0x14546d instanceof salesforce_error_1['SalesforceError']?JSON['stringify'](_0x14546d[_0x27a199(0x1b9)](),null,0x2):_0x14546d),this[_0x27a199(0x183)]['log'](_0x14546d instanceof salesforce_error_1['SalesforceError']?JSON[_0x27a199(0x1b4)](_0x14546d['toJSON'](),null,0x2):_0x14546d['toString']());throw _0x14546d;}}async[a228_0x48978d(0x1bc)](_0x102088){const _0x4ade02=a228_0x48978d;for(const _0x5f2175 of _0x102088){if(!_0x5f2175[_0x4ade02(0x1bf)][_0x4ade02(0x1c2)]&&!_0x5f2175[_0x4ade02(0x1a0)]['length']&&!_0x5f2175[_0x4ade02(0x1be)]['length'])continue;const _0x2146a4=[],_0x3a8ca6=[],_0x472e6d=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x4ade02(0x18a)][_0x4ade02(0x19a)],this[_0x4ade02(0x18a)][_0x4ade02(0x1af)],_0x5f2175[_0x4ade02(0x1b3)],this['options'][_0x4ade02(0x191)],this[_0x4ade02(0x189)]);_0x2146a4['push'](...await _0x472e6d[_0x4ade02(0x186)](_0x5f2175[_0x4ade02(0x1bf)],this['options']['commitId'])),_0x2146a4['push'](...await _0x472e6d[_0x4ade02(0x182)](_0x5f2175['modified'],this[_0x4ade02(0x18a)]['commitId'])),_0x3a8ca6[_0x4ade02(0x19d)](await _0x472e6d[_0x4ade02(0x1ca)](_0x5f2175[_0x4ade02(0x1be)],!![])),this[_0x4ade02(0x189)]=_0x472e6d['getProceededComponentsMeta'](),await this['proceedRequests'](_0x2146a4,!![]);for(const _0x32a123 of _0x3a8ca6){_0x32a123['manifests'][_0x4ade02(0x1c2)]&&await this[_0x4ade02(0x184)](_0x32a123[_0x4ade02(0x1b2)],!![]),_0x32a123[_0x4ade02(0x1ae)][_0x4ade02(0x1c2)]&&await this['proceedRequests'](_0x32a123[_0x4ade02(0x1ae)],!![]),_0x32a123[_0x4ade02(0x1c4)][_0x4ade02(0x1c2)]&&await this[_0x4ade02(0x184)](_0x32a123[_0x4ade02(0x1c4)],!![]);}this[_0x4ade02(0x1c9)][_0x4ade02(0x196)](_0x4ade02(0x1b8),_0x2146a4['length']);}}async['proceedCommitsToBranch'](_0xf0ae01){const _0x2a1a7a=a228_0x48978d,_0xdab95a=[],_0x753822=[];for(const _0x55b2ab of _0xf0ae01){if(!_0x55b2ab['inserted'][_0x2a1a7a(0x1c2)]&&!_0x55b2ab[_0x2a1a7a(0x1a0)][_0x2a1a7a(0x1c2)]&&!_0x55b2ab[_0x2a1a7a(0x1be)][_0x2a1a7a(0x1c2)])continue;const _0x48577c=new salesforce_components_manager_service_1[(_0x2a1a7a(0x19b))](this[_0x2a1a7a(0x18a)]['repositoryId'],this[_0x2a1a7a(0x18a)][_0x2a1a7a(0x1af)],_0x55b2ab[_0x2a1a7a(0x1b3)],this['options'][_0x2a1a7a(0x191)],[]);_0xdab95a[_0x2a1a7a(0x19d)](...await _0x48577c[_0x2a1a7a(0x186)](_0x55b2ab[_0x2a1a7a(0x1bf)])),_0xdab95a[_0x2a1a7a(0x19d)](...await _0x48577c[_0x2a1a7a(0x182)](_0x55b2ab[_0x2a1a7a(0x1a0)])),_0x753822[_0x2a1a7a(0x19d)](await _0x48577c[_0x2a1a7a(0x1ca)](_0x55b2ab[_0x2a1a7a(0x1be)]));}this[_0x2a1a7a(0x1c9)][_0x2a1a7a(0x196)](_0x2a1a7a(0x1c8),_0xdab95a[_0x2a1a7a(0x1c2)]),await this[_0x2a1a7a(0x184)](_0xdab95a);const _0x412f0e=_0x753822[_0x2a1a7a(0x1ba)]((_0x243bf6,_0x2b2a03)=>({'manifests':[..._0x243bf6[_0x2a1a7a(0x1b2)],..._0x2b2a03['manifests']],'componentsToDelete':[..._0x243bf6[_0x2a1a7a(0x1c4)],..._0x2b2a03['componentsToDelete']],'componentsToUpdate':[..._0x243bf6[_0x2a1a7a(0x1ae)],..._0x2b2a03[_0x2a1a7a(0x1ae)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x412f0e[_0x2a1a7a(0x1b2)][_0x2a1a7a(0x1c2)]&&await this[_0x2a1a7a(0x184)](_0x412f0e[_0x2a1a7a(0x1b2)],!![]),_0x412f0e[_0x2a1a7a(0x1ae)][_0x2a1a7a(0x1c2)]&&await this[_0x2a1a7a(0x184)](_0x412f0e[_0x2a1a7a(0x1ae)],!![]),_0x412f0e[_0x2a1a7a(0x1c4)]['length']&&await this[_0x2a1a7a(0x184)](_0x412f0e[_0x2a1a7a(0x1c4)],!![]);}async[a228_0x48978d(0x18f)](_0x239526){const _0x11e9a3=a228_0x48978d;this['options'][_0x11e9a3(0x1af)]?await this['proceedCommitsToBranch'](_0x239526):await this[_0x11e9a3(0x1bc)](_0x239526);}}exports[a228_0x48978d(0x1b6)]=SalesforceCommitsManager;