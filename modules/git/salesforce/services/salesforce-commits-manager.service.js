function a233_0x4bf7(_0x51a6b1,_0x2a4a3a){const _0x313406=a233_0x2c6f();return a233_0x4bf7=function(_0x1ff8ce,_0x43f570){_0x1ff8ce=_0x1ff8ce-0x14f;let _0x2c6f6f=_0x313406[_0x1ff8ce];return _0x2c6f6f;},a233_0x4bf7(_0x51a6b1,_0x2a4a3a);}const a233_0x25d53f=a233_0x4bf7;(function(_0x20f5c4,_0x2da070){const _0x54d433=a233_0x4bf7,_0x535acd=_0x20f5c4();while(!![]){try{const _0x35a387=-parseInt(_0x54d433(0x169))/0x1*(parseInt(_0x54d433(0x189))/0x2)+parseInt(_0x54d433(0x154))/0x3+parseInt(_0x54d433(0x17b))/0x4+-parseInt(_0x54d433(0x193))/0x5+-parseInt(_0x54d433(0x164))/0x6*(-parseInt(_0x54d433(0x186))/0x7)+-parseInt(_0x54d433(0x182))/0x8+-parseInt(_0x54d433(0x159))/0x9*(parseInt(_0x54d433(0x18b))/0xa);if(_0x35a387===_0x2da070)break;else _0x535acd['push'](_0x535acd['shift']());}catch(_0x61350b){_0x535acd['push'](_0x535acd['shift']());}}}(a233_0x2c6f,0x6c0d9));const a233_0x43f570=(function(){let _0xcb27b=!![];return function(_0x37bc46,_0x399781){const _0x390055=_0xcb27b?function(){const _0x2369a7=a233_0x4bf7;if(_0x399781){const _0x14b1cc=_0x399781[_0x2369a7(0x14f)](_0x37bc46,arguments);return _0x399781=null,_0x14b1cc;}}:function(){};return _0xcb27b=![],_0x390055;};}()),a233_0x1ff8ce=a233_0x43f570(this,function(){const _0x7ca9ea=a233_0x4bf7;return a233_0x1ff8ce[_0x7ca9ea(0x184)]()[_0x7ca9ea(0x161)](_0x7ca9ea(0x156))[_0x7ca9ea(0x184)]()[_0x7ca9ea(0x150)](a233_0x1ff8ce)[_0x7ca9ea(0x161)](_0x7ca9ea(0x156));});a233_0x1ff8ce();'use strict';var __importDefault=this&&this[a233_0x25d53f(0x177)]||function(_0x33a2c8){const _0x35604=a233_0x25d53f;return _0x33a2c8&&_0x33a2c8[_0x35604(0x176)]?_0x33a2c8:{'default':_0x33a2c8};};Object[a233_0x25d53f(0x15c)](exports,'__esModule',{'value':!![]}),exports[a233_0x25d53f(0x16b)]=void 0x0;const core_1=require(a233_0x25d53f(0x162)),typedi_1=__importDefault(require(a233_0x25d53f(0x178))),constants_1=require(a233_0x25d53f(0x165)),utils_1=require(a233_0x25d53f(0x192)),salesforce_error_1=require(a233_0x25d53f(0x195)),composite_utils_1=require(a233_0x25d53f(0x18f)),salesforce_components_manager_service_1=require(a233_0x25d53f(0x15d)),salesforce_composite_service_1=require(a233_0x25d53f(0x18c));function a233_0x2c6f(){const _0x24aab5=['SalesforceError','toJSON','Sending\x20','proceedCommitsToBranch','__esModule','__importDefault','typedi','componentsToUpdate','delete','1387612CbpGiy','find','SALESFORCE_MAX_REQUEST_SIZE_BYTES','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','log','chunkArray','splice','668704hdkzoI','error','toString','modified','70VpYTLN','composite','get','16urwGtZ','proceededComponentsMeta','10qyZpuK','./salesforce-composite.service','proceedCommitsToRepository','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','../utils/composite.utils','author','stringify','../../../shared/utils','2075270MzLkgM','options','../errors/salesforce.error','proceedRequests','SalesforceCompositeService','proceedChunksToUpload','apply','constructor','reduce','commitId','push','1972887bsyyDk','SalesforceComponentsManager','(((.+)+)+)+$','repositoryId','branchId','3385791KxUJRt','manifests','\x20requests\x20to\x20composite\x20api.','defineProperty','./salesforce-components-manager.service','removed','insert','getProceededComponentsMeta','search','../../../../core','componentId','368274DVggEM','../../../../constants','default','COMPONENTS_PER_CHUNK','logger','37612beLQCS','inserted','SalesforceCommitsManager','length','sfLogger','update','floor','componentsToDelete','extractComponentIdsFromGraphsResponse'];a233_0x2c6f=function(){return _0x24aab5;};return a233_0x2c6f();}class SalesforceCommitsManager{constructor(_0x5c4f76){const _0x3712ef=a233_0x25d53f;this['options']=_0x5c4f76,this[_0x3712ef(0x167)]=0x3,this[_0x3712ef(0x168)]=new core_1['Logger'](SalesforceCommitsManager['name']),this['sfLogger']=this[_0x3712ef(0x194)]['logger'],this[_0x3712ef(0x187)]=typedi_1[_0x3712ef(0x166)][_0x3712ef(0x188)](salesforce_composite_service_1[_0x3712ef(0x197)]),this[_0x3712ef(0x18a)]=[];}async[a233_0x25d53f(0x198)](_0x20d9af,_0x387888=![]){const _0x5df6a1=a233_0x25d53f,_0x408c87=async _0x421592=>{const _0x21ff79=a233_0x4bf7;await this[_0x21ff79(0x168)][_0x21ff79(0x17f)](_0x21ff79(0x174)+_0x421592[_0x21ff79(0x151)]((_0x18541c,_0xaba02b)=>_0x18541c+_0xaba02b[_0x21ff79(0x16c)],0x0)+_0x21ff79(0x15b));const _0x3297f=_0x421592['map']((_0x2a7279,_0x4d05a7)=>({'graphId':'graph'+_0x4d05a7,'compositeRequest':_0x2a7279})),_0x4c6b5f=await this['composite']['executeGraphs'](_0x3297f);if(_0x387888){const _0x260c55=(0x0,composite_utils_1[_0x21ff79(0x171)])(_0x4c6b5f);for(const {id:_0x36c753,ref:_0x4c4a0d}of _0x260c55){const _0x56de86=this[_0x21ff79(0x18a)][_0x21ff79(0x17c)](_0x338b1c=>_0x338b1c['reference']===_0x4c4a0d);_0x56de86&&(_0x56de86[_0x21ff79(0x163)]=_0x36c753);}}},_0x21e151=0x1e8480;let _0x15ff46=0x0,_0x315a81=[];for(const _0x22fe74 of _0x20d9af){const _0x3545d5=_0x22fe74[_0x5df6a1(0x151)]((_0x44ba6f,_0x31a30a)=>{const _0x2f4e08=_0x5df6a1,_0x4936d1=JSON[_0x2f4e08(0x191)](_0x31a30a)[_0x2f4e08(0x16c)]*0x2;return _0x44ba6f+_0x4936d1;},0x0);if(_0x3545d5>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1['SalesforceError'](_0x5df6a1(0x18e)+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+'\x20COMPONENTS_SIZE\x20=\x20'+_0x3545d5);_0x15ff46+_0x3545d5>constants_1[_0x5df6a1(0x17d)]-_0x21e151&&(await _0x408c87(_0x315a81),_0x315a81=[],_0x15ff46=0x0),_0x15ff46+=_0x3545d5,_0x315a81['push'](_0x22fe74);}_0x315a81[_0x5df6a1(0x16c)]&&await _0x408c87(_0x315a81);}async['proceedRequests'](_0x4bd84e,_0xa1f178=![]){const _0x56dfa8=a233_0x25d53f,_0x77c94=(this[_0x56dfa8(0x167)]+ +_0xa1f178)*0x3,_0x487e27=(0x0,utils_1[_0x56dfa8(0x180)])(_0x4bd84e,_0x77c94);try{while(_0x487e27[_0x56dfa8(0x16c)]){const _0x10f4de=_0x487e27[_0x56dfa8(0x181)](0x0,Math[_0x56dfa8(0x16f)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x77c94));await this['proceedChunksToUpload'](_0x10f4de,_0xa1f178);}}catch(_0x59eab4){this[_0x56dfa8(0x168)][_0x56dfa8(0x183)](_0x59eab4 instanceof salesforce_error_1[_0x56dfa8(0x172)]?JSON[_0x56dfa8(0x191)](_0x59eab4[_0x56dfa8(0x173)](),null,0x2):_0x59eab4),this[_0x56dfa8(0x16d)]['log'](_0x59eab4 instanceof salesforce_error_1[_0x56dfa8(0x172)]?JSON[_0x56dfa8(0x191)](_0x59eab4[_0x56dfa8(0x173)](),null,0x2):_0x59eab4['toString']());throw _0x59eab4;}}async[a233_0x25d53f(0x18d)](_0x4b458a){const _0x1062bb=a233_0x25d53f;for(const _0x42a0a6 of _0x4b458a){if(!_0x42a0a6['inserted'][_0x1062bb(0x16c)]&&!_0x42a0a6[_0x1062bb(0x185)][_0x1062bb(0x16c)]&&!_0x42a0a6['removed']['length'])continue;const _0x5d291b=[],_0x479c67=[],_0x2bc277=new salesforce_components_manager_service_1[(_0x1062bb(0x155))](this[_0x1062bb(0x194)]['repositoryId'],this[_0x1062bb(0x194)][_0x1062bb(0x158)],_0x42a0a6['author'],this[_0x1062bb(0x194)]['recordTypes'],this['proceededComponentsMeta']);_0x5d291b[_0x1062bb(0x153)](...await _0x2bc277[_0x1062bb(0x15f)](_0x42a0a6['inserted'],this[_0x1062bb(0x194)][_0x1062bb(0x152)])),_0x5d291b[_0x1062bb(0x153)](...await _0x2bc277[_0x1062bb(0x16e)](_0x42a0a6[_0x1062bb(0x185)],this[_0x1062bb(0x194)]['commitId'])),_0x479c67['push'](await _0x2bc277[_0x1062bb(0x17a)](_0x42a0a6[_0x1062bb(0x15e)],!![])),this[_0x1062bb(0x18a)]=_0x2bc277[_0x1062bb(0x160)](),await this['proceedRequests'](_0x5d291b,!![]);for(const _0x159efe of _0x479c67){_0x159efe[_0x1062bb(0x15a)][_0x1062bb(0x16c)]&&await this['proceedRequests'](_0x159efe[_0x1062bb(0x15a)],!![]),_0x159efe[_0x1062bb(0x179)][_0x1062bb(0x16c)]&&await this[_0x1062bb(0x196)](_0x159efe[_0x1062bb(0x179)],!![]),_0x159efe[_0x1062bb(0x170)]['length']&&await this[_0x1062bb(0x196)](_0x159efe[_0x1062bb(0x170)],!![]);}this[_0x1062bb(0x168)][_0x1062bb(0x17f)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x5d291b['length']);}}async[a233_0x25d53f(0x175)](_0x2e30a3){const _0x3dc720=a233_0x25d53f,_0x5ba7bf=[],_0x52eef8=[];for(const _0x25d2d6 of _0x2e30a3){if(!_0x25d2d6[_0x3dc720(0x16a)][_0x3dc720(0x16c)]&&!_0x25d2d6[_0x3dc720(0x185)]['length']&&!_0x25d2d6['removed'][_0x3dc720(0x16c)])continue;const _0x133fee=new salesforce_components_manager_service_1[(_0x3dc720(0x155))](this['options'][_0x3dc720(0x157)],this[_0x3dc720(0x194)][_0x3dc720(0x158)],_0x25d2d6[_0x3dc720(0x190)],this['options']['recordTypes'],[]);_0x5ba7bf[_0x3dc720(0x153)](...await _0x133fee[_0x3dc720(0x15f)](_0x25d2d6[_0x3dc720(0x16a)])),_0x5ba7bf['push'](...await _0x133fee[_0x3dc720(0x16e)](_0x25d2d6[_0x3dc720(0x185)])),_0x52eef8['push'](await _0x133fee[_0x3dc720(0x17a)](_0x25d2d6['removed']));}this[_0x3dc720(0x168)][_0x3dc720(0x17f)](_0x3dc720(0x17e),_0x5ba7bf[_0x3dc720(0x16c)]),await this[_0x3dc720(0x196)](_0x5ba7bf);const _0x49d3c3=_0x52eef8[_0x3dc720(0x151)]((_0x4ffc90,_0x29ce44)=>({'manifests':[..._0x4ffc90[_0x3dc720(0x15a)],..._0x29ce44[_0x3dc720(0x15a)]],'componentsToDelete':[..._0x4ffc90[_0x3dc720(0x170)],..._0x29ce44[_0x3dc720(0x170)]],'componentsToUpdate':[..._0x4ffc90[_0x3dc720(0x179)],..._0x29ce44[_0x3dc720(0x179)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x49d3c3['manifests'][_0x3dc720(0x16c)]&&await this[_0x3dc720(0x196)](_0x49d3c3[_0x3dc720(0x15a)],!![]),_0x49d3c3[_0x3dc720(0x179)][_0x3dc720(0x16c)]&&await this['proceedRequests'](_0x49d3c3[_0x3dc720(0x179)],!![]),_0x49d3c3['componentsToDelete'][_0x3dc720(0x16c)]&&await this['proceedRequests'](_0x49d3c3[_0x3dc720(0x170)],!![]);}async['proceedCommits'](_0xe6a4c){const _0x31370a=a233_0x25d53f;this[_0x31370a(0x194)]['branchId']?await this[_0x31370a(0x175)](_0xe6a4c):await this[_0x31370a(0x18d)](_0xe6a4c);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;