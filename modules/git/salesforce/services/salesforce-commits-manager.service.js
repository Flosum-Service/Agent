const a243_0x1d3877=a243_0x5eb3;(function(_0x1ee48f,_0x42b42c){const _0x324b5a=a243_0x5eb3,_0x165938=_0x1ee48f();while(!![]){try{const _0x551ccf=-parseInt(_0x324b5a(0x1fd))/0x1+parseInt(_0x324b5a(0x206))/0x2+-parseInt(_0x324b5a(0x205))/0x3+-parseInt(_0x324b5a(0x22c))/0x4*(parseInt(_0x324b5a(0x212))/0x5)+parseInt(_0x324b5a(0x233))/0x6*(parseInt(_0x324b5a(0x1fa))/0x7)+-parseInt(_0x324b5a(0x209))/0x8+-parseInt(_0x324b5a(0x1f8))/0x9*(-parseInt(_0x324b5a(0x21d))/0xa);if(_0x551ccf===_0x42b42c)break;else _0x165938['push'](_0x165938['shift']());}catch(_0x5e9f2d){_0x165938['push'](_0x165938['shift']());}}}(a243_0xd8fe,0x9f029));const a243_0x40e6ce=(function(){let _0x330a44=!![];return function(_0x1f7a3e,_0x3c9a81){const _0x2e4304=_0x330a44?function(){const _0x1e3418=a243_0x5eb3;if(_0x3c9a81){const _0x4798c3=_0x3c9a81[_0x1e3418(0x1f7)](_0x1f7a3e,arguments);return _0x3c9a81=null,_0x4798c3;}}:function(){};return _0x330a44=![],_0x2e4304;};}()),a243_0x2c7a1e=a243_0x40e6ce(this,function(){const _0x30760e=a243_0x5eb3;return a243_0x2c7a1e[_0x30760e(0x224)]()[_0x30760e(0x221)]('(((.+)+)+)+$')[_0x30760e(0x224)]()[_0x30760e(0x21b)](a243_0x2c7a1e)['search']('(((.+)+)+)+$');});a243_0x2c7a1e();'use strict';var __importDefault=this&&this[a243_0x1d3877(0x220)]||function(_0x2f48ea){const _0x2c4057=a243_0x1d3877;return _0x2f48ea&&_0x2f48ea[_0x2c4057(0x218)]?_0x2f48ea:{'default':_0x2f48ea};};Object['defineProperty'](exports,a243_0x1d3877(0x218),{'value':!![]}),exports[a243_0x1d3877(0x232)]=void 0x0;const core_1=require(a243_0x1d3877(0x236)),typedi_1=__importDefault(require('typedi')),constants_1=require('../../../../constants'),utils_1=require(a243_0x1d3877(0x1ff)),salesforce_error_1=require(a243_0x1d3877(0x230)),composite_utils_1=require(a243_0x1d3877(0x23c)),salesforce_components_manager_service_1=require(a243_0x1d3877(0x235)),salesforce_composite_service_1=require(a243_0x1d3877(0x229));class SalesforceCommitsManager{constructor(_0x47716f){const _0x31c140=a243_0x1d3877;this['options']=_0x47716f,this[_0x31c140(0x228)]=0x3,this[_0x31c140(0x20a)]=new core_1[(_0x31c140(0x1fc))](SalesforceCommitsManager[_0x31c140(0x204)]),this[_0x31c140(0x20c)]=this[_0x31c140(0x20d)][_0x31c140(0x20a)],this[_0x31c140(0x239)]=typedi_1['default'][_0x31c140(0x217)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x31c140(0x1f9)]=[];}async['proceedChunksToUpload'](_0x551f49,_0x392de5=![]){const _0x58cba9=a243_0x1d3877,_0x3474be=async _0x3c4ba3=>{const _0x2de658=a243_0x5eb3;await this[_0x2de658(0x20a)][_0x2de658(0x200)](_0x2de658(0x20f)+_0x3c4ba3['reduce']((_0x9c2cf1,_0x677315)=>_0x9c2cf1+_0x677315[_0x2de658(0x226)],0x0)+_0x2de658(0x1fe));const _0x2a2745=_0x3c4ba3['map']((_0x28c99c,_0x1b5662)=>({'graphId':_0x2de658(0x201)+_0x1b5662,'compositeRequest':_0x28c99c})),_0x19158c=await this[_0x2de658(0x239)][_0x2de658(0x234)](_0x2a2745);if(_0x392de5){const _0x5249e1=(0x0,composite_utils_1['extractComponentIdsFromGraphsResponse'])(_0x19158c);for(const {id:_0x1d2b9a,ref:_0x32badf}of _0x5249e1){const _0x2c5416=this['proceededComponentsMeta'][_0x2de658(0x1f6)](_0x50ec30=>_0x50ec30[_0x2de658(0x216)]===_0x32badf);_0x2c5416&&(_0x2c5416[_0x2de658(0x210)]=_0x1d2b9a);}}},_0x1d619c=0x1e8480;let _0x3255de=0x0,_0x58eb75=[];for(const _0x5f0e51 of _0x551f49){const _0x286f29=_0x5f0e51[_0x58cba9(0x1fb)]((_0x212b94,_0x507541)=>{const _0x2ebe4b=_0x58cba9,_0x3e5919=JSON['stringify'](_0x507541)[_0x2ebe4b(0x226)]*0x2;return _0x212b94+_0x3e5919;},0x0);if(_0x286f29>constants_1[_0x58cba9(0x203)])throw new salesforce_error_1[(_0x58cba9(0x225))]('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+_0x58cba9(0x215)+_0x286f29);_0x3255de+_0x286f29>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x1d619c&&(await _0x3474be(_0x58eb75),_0x58eb75=[],_0x3255de=0x0),_0x3255de+=_0x286f29,_0x58eb75['push'](_0x5f0e51);}_0x58eb75[_0x58cba9(0x226)]&&await _0x3474be(_0x58eb75);}async[a243_0x1d3877(0x211)](_0xdf480f,_0x41e0dc=![]){const _0x2e319d=a243_0x1d3877,_0x5c64f7=(this[_0x2e319d(0x228)]+ +_0x41e0dc)*0x3,_0x11e46e=(0x0,utils_1[_0x2e319d(0x20e)])(_0xdf480f,_0x5c64f7);try{while(_0x11e46e[_0x2e319d(0x226)]){const _0x258f0e=_0x11e46e[_0x2e319d(0x222)](0x0,Math[_0x2e319d(0x213)](constants_1[_0x2e319d(0x22f)]/_0x5c64f7));await this['proceedChunksToUpload'](_0x258f0e,_0x41e0dc);}}catch(_0x331062){this[_0x2e319d(0x20a)][_0x2e319d(0x23a)](_0x331062 instanceof salesforce_error_1[_0x2e319d(0x225)]?JSON['stringify'](_0x331062[_0x2e319d(0x207)](),null,0x2):_0x331062),this[_0x2e319d(0x20c)][_0x2e319d(0x200)](_0x331062 instanceof salesforce_error_1[_0x2e319d(0x225)]?JSON[_0x2e319d(0x21f)](_0x331062[_0x2e319d(0x207)](),null,0x2):_0x331062['toString']());throw _0x331062;}}async[a243_0x1d3877(0x22a)](_0x1c6362){const _0x512de2=a243_0x1d3877;for(const _0x94aabc of _0x1c6362){if(!_0x94aabc[_0x512de2(0x21a)][_0x512de2(0x226)]&&!_0x94aabc['modified']['length']&&!_0x94aabc[_0x512de2(0x21e)][_0x512de2(0x226)])continue;const _0x22c4bc=[],_0x4ce0db=[],_0x4c941c=new salesforce_components_manager_service_1[(_0x512de2(0x219))](this[_0x512de2(0x20d)][_0x512de2(0x238)],this[_0x512de2(0x20d)][_0x512de2(0x202)],_0x94aabc['author'],this[_0x512de2(0x20d)]['recordTypes'],this['proceededComponentsMeta']);_0x22c4bc[_0x512de2(0x208)](...await _0x4c941c[_0x512de2(0x231)](_0x94aabc[_0x512de2(0x21a)],this['options'][_0x512de2(0x1f4)])),_0x22c4bc['push'](...await _0x4c941c[_0x512de2(0x22e)](_0x94aabc[_0x512de2(0x22d)],this['options'][_0x512de2(0x1f4)])),_0x4ce0db[_0x512de2(0x208)](await _0x4c941c['delete'](_0x94aabc[_0x512de2(0x21e)],!![])),this[_0x512de2(0x1f9)]=_0x4c941c[_0x512de2(0x223)](),await this[_0x512de2(0x211)](_0x22c4bc,!![]);for(const _0x5eed36 of _0x4ce0db){_0x5eed36[_0x512de2(0x21c)][_0x512de2(0x226)]&&await this['proceedRequests'](_0x5eed36[_0x512de2(0x21c)],!![]),_0x5eed36[_0x512de2(0x237)][_0x512de2(0x226)]&&await this[_0x512de2(0x211)](_0x5eed36['componentsToUpdate'],!![]),_0x5eed36[_0x512de2(0x22b)]['length']&&await this[_0x512de2(0x211)](_0x5eed36[_0x512de2(0x22b)],!![]);}this[_0x512de2(0x20a)][_0x512de2(0x200)](_0x512de2(0x214),_0x22c4bc['length']);}}async[a243_0x1d3877(0x20b)](_0x4d7575){const _0x27f57d=a243_0x1d3877,_0x2269a2=[],_0x1e5ed8=[];for(const _0x7fd743 of _0x4d7575){if(!_0x7fd743['inserted'][_0x27f57d(0x226)]&&!_0x7fd743[_0x27f57d(0x22d)]['length']&&!_0x7fd743['removed'][_0x27f57d(0x226)])continue;const _0x3e67a1=new salesforce_components_manager_service_1[(_0x27f57d(0x219))](this[_0x27f57d(0x20d)][_0x27f57d(0x238)],this[_0x27f57d(0x20d)][_0x27f57d(0x202)],_0x7fd743[_0x27f57d(0x23b)],this[_0x27f57d(0x20d)][_0x27f57d(0x1f5)],[]);_0x2269a2[_0x27f57d(0x208)](...await _0x3e67a1['insert'](_0x7fd743[_0x27f57d(0x21a)])),_0x2269a2[_0x27f57d(0x208)](...await _0x3e67a1['update'](_0x7fd743['modified'])),_0x1e5ed8['push'](await _0x3e67a1['delete'](_0x7fd743[_0x27f57d(0x21e)]));}this[_0x27f57d(0x20a)][_0x27f57d(0x200)](_0x27f57d(0x227),_0x2269a2[_0x27f57d(0x226)]),await this[_0x27f57d(0x211)](_0x2269a2);const _0x595205=_0x1e5ed8[_0x27f57d(0x1fb)]((_0x4ebcce,_0x5e3b3d)=>({'manifests':[..._0x4ebcce[_0x27f57d(0x21c)],..._0x5e3b3d[_0x27f57d(0x21c)]],'componentsToDelete':[..._0x4ebcce['componentsToDelete'],..._0x5e3b3d[_0x27f57d(0x22b)]],'componentsToUpdate':[..._0x4ebcce['componentsToUpdate'],..._0x5e3b3d[_0x27f57d(0x237)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x595205[_0x27f57d(0x21c)]['length']&&await this[_0x27f57d(0x211)](_0x595205[_0x27f57d(0x21c)],!![]),_0x595205['componentsToUpdate'][_0x27f57d(0x226)]&&await this['proceedRequests'](_0x595205[_0x27f57d(0x237)],!![]),_0x595205['componentsToDelete'][_0x27f57d(0x226)]&&await this[_0x27f57d(0x211)](_0x595205[_0x27f57d(0x22b)],!![]);}async['proceedCommits'](_0x2003fd){const _0x5f477a=a243_0x1d3877;this['options'][_0x5f477a(0x202)]?await this[_0x5f477a(0x20b)](_0x2003fd):await this[_0x5f477a(0x22a)](_0x2003fd);}}function a243_0x5eb3(_0x2b54ce,_0x373670){const _0xf20fb2=a243_0xd8fe();return a243_0x5eb3=function(_0x2c7a1e,_0x40e6ce){_0x2c7a1e=_0x2c7a1e-0x1f4;let _0xd8fe57=_0xf20fb2[_0x2c7a1e];return _0xd8fe57;},a243_0x5eb3(_0x2b54ce,_0x373670);}exports[a243_0x1d3877(0x232)]=SalesforceCommitsManager;function a243_0xd8fe(){const _0x459873=['name','3293655JAtujB','1187594VoOzkS','toJSON','push','9876664XXinSU','logger','proceedCommitsToBranch','sfLogger','options','chunkArray','Sending\x20','componentId','proceedRequests','44740VZxDVJ','floor','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','\x20COMPONENTS_SIZE\x20=\x20','reference','get','__esModule','SalesforceComponentsManager','inserted','constructor','manifests','10QEnkCp','removed','stringify','__importDefault','search','splice','getProceededComponentsMeta','toString','SalesforceError','length','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','COMPONENTS_PER_CHUNK','./salesforce-composite.service','proceedCommitsToRepository','componentsToDelete','332xCYwtD','modified','update','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','../errors/salesforce.error','insert','SalesforceCommitsManager','31782AIHOpE','executeGraphs','./salesforce-components-manager.service','../../../../core','componentsToUpdate','repositoryId','composite','error','author','../utils/composite.utils','commitId','recordTypes','find','apply','25036254ABiKSI','proceededComponentsMeta','854mWMlNL','reduce','Logger','295380GJTJDg','\x20requests\x20to\x20composite\x20api.','../../../shared/utils','log','graph','branchId','SALESFORCE_MAX_REQUEST_SIZE_BYTES'];a243_0xd8fe=function(){return _0x459873;};return a243_0xd8fe();}