const a233_0x961a67=a233_0x1dad;function a233_0xaaad(){const _0x2551de=['SalesforceCommitsManager','constructor','componentsToUpdate','12977271gQKqPk','proceedCommitsToBranch','proceedRequests','COMPONENTS_PER_CHUNK','3391700wcinAa','SALESFORCE_MAX_REQUEST_SIZE_BYTES','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','update','default','55KYeYUF','author','commitId','toJSON','branchId','__importDefault','../errors/salesforce.error','options','get','extractComponentIdsFromGraphsResponse','modified','defineProperty','1WzgFzG','2862978NClLHR','delete','removed','sfLogger','\x20requests\x20to\x20composite\x20api.','proceedCommits','SalesforceCompositeService','map','\x20COMPONENTS_SIZE\x20=\x20','SalesforceError','componentsToDelete','6QezGpp','repositoryId','getProceededComponentsMeta','proceedChunksToUpload','floor','chunkArray','length','8gQXYkI','109684jGgSlB','reduce','stringify','proceedCommitsToRepository','componentId','12HqABRl','SalesforceComponentsManager','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','531769ytMwCH','../utils/composite.utils','recordTypes','(((.+)+)+)+$','../../../shared/utils','../../../../core','executeGraphs','2260929varoyb','proceededComponentsMeta','apply','manifests','push','composite','__esModule','logger','error','1073523cJrAHa','toString','insert','log','name','inserted','graph','Logger'];a233_0xaaad=function(){return _0x2551de;};return a233_0xaaad();}(function(_0x22d913,_0x5e78b1){const _0x37b7c1=a233_0x1dad,_0x25d5f0=_0x22d913();while(!![]){try{const _0x13e866=-parseInt(_0x37b7c1(0xd8))/0x1*(parseInt(_0x37b7c1(0xd9))/0x2)+parseInt(_0x37b7c1(0xfb))/0x3+-parseInt(_0x37b7c1(0xec))/0x4*(parseInt(_0x37b7c1(0xcc))/0x5)+parseInt(_0x37b7c1(0xe4))/0x6*(parseInt(_0x37b7c1(0xf4))/0x7)+-parseInt(_0x37b7c1(0xeb))/0x8*(-parseInt(_0x37b7c1(0xc3))/0x9)+parseInt(_0x37b7c1(0xc7))/0xa+-parseInt(_0x37b7c1(0x104))/0xb*(-parseInt(_0x37b7c1(0xf1))/0xc);if(_0x13e866===_0x5e78b1)break;else _0x25d5f0['push'](_0x25d5f0['shift']());}catch(_0x2188bc){_0x25d5f0['push'](_0x25d5f0['shift']());}}}(a233_0xaaad,0xee144));const a233_0x1c6fcb=(function(){let _0x29462c=!![];return function(_0x3ddca0,_0x3ef8f1){const _0x21df30=_0x29462c?function(){const _0x6a875=a233_0x1dad;if(_0x3ef8f1){const _0x55d9d7=_0x3ef8f1[_0x6a875(0xfd)](_0x3ddca0,arguments);return _0x3ef8f1=null,_0x55d9d7;}}:function(){};return _0x29462c=![],_0x21df30;};}()),a233_0x2033db=a233_0x1c6fcb(this,function(){const _0x5d6b0e=a233_0x1dad;return a233_0x2033db[_0x5d6b0e(0xb9)]()['search'](_0x5d6b0e(0xf7))[_0x5d6b0e(0xb9)]()[_0x5d6b0e(0xc1)](a233_0x2033db)['search'](_0x5d6b0e(0xf7));});a233_0x2033db();'use strict';var __importDefault=this&&this[a233_0x961a67(0xd1)]||function(_0x4acf4e){const _0x14b975=a233_0x961a67;return _0x4acf4e&&_0x4acf4e[_0x14b975(0x101)]?_0x4acf4e:{'default':_0x4acf4e};};function a233_0x1dad(_0x195d5a,_0xe6a1c8){const _0x2f92f7=a233_0xaaad();return a233_0x1dad=function(_0x2033db,_0x1c6fcb){_0x2033db=_0x2033db-0xb9;let _0xaaadba=_0x2f92f7[_0x2033db];return _0xaaadba;},a233_0x1dad(_0x195d5a,_0xe6a1c8);}Object[a233_0x961a67(0xd7)](exports,a233_0x961a67(0x101),{'value':!![]}),exports[a233_0x961a67(0xc0)]=void 0x0;const core_1=require(a233_0x961a67(0xf9)),typedi_1=__importDefault(require('typedi')),constants_1=require('../../../../constants'),utils_1=require(a233_0x961a67(0xf8)),salesforce_error_1=require(a233_0x961a67(0xd2)),composite_utils_1=require(a233_0x961a67(0xf5)),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require('./salesforce-composite.service');class SalesforceCommitsManager{constructor(_0x55ce60){const _0x3210ec=a233_0x961a67;this[_0x3210ec(0xd3)]=_0x55ce60,this[_0x3210ec(0xc6)]=0x3,this[_0x3210ec(0x102)]=new core_1[(_0x3210ec(0xbf))](SalesforceCommitsManager[_0x3210ec(0xbc)]),this[_0x3210ec(0xdc)]=this[_0x3210ec(0xd3)]['logger'],this[_0x3210ec(0x100)]=typedi_1[_0x3210ec(0xcb)][_0x3210ec(0xd4)](salesforce_composite_service_1[_0x3210ec(0xdf)]),this[_0x3210ec(0xfc)]=[];}async[a233_0x961a67(0xe7)](_0x4ffb4e,_0x387d6e=![]){const _0x18fb97=a233_0x961a67,_0x43c3fa=async _0x3f8191=>{const _0x41cea3=a233_0x1dad;await this['logger'][_0x41cea3(0xbb)]('Sending\x20'+_0x3f8191[_0x41cea3(0xed)]((_0x2b7fc7,_0x4890e5)=>_0x2b7fc7+_0x4890e5['length'],0x0)+_0x41cea3(0xdd));const _0x45712c=_0x3f8191[_0x41cea3(0xe0)]((_0x51a2fe,_0x5308dd)=>({'graphId':_0x41cea3(0xbe)+_0x5308dd,'compositeRequest':_0x51a2fe})),_0x18557e=await this['composite'][_0x41cea3(0xfa)](_0x45712c);if(_0x387d6e){const _0x553818=(0x0,composite_utils_1[_0x41cea3(0xd5)])(_0x18557e);for(const {id:_0x155dff,ref:_0x1959ce}of _0x553818){const _0x5b1cbb=this['proceededComponentsMeta']['find'](_0xbb0c=>_0xbb0c['reference']===_0x1959ce);_0x5b1cbb&&(_0x5b1cbb[_0x41cea3(0xf0)]=_0x155dff);}}},_0x52f367=0x1e8480;let _0x42e71e=0x0,_0x348dfd=[];for(const _0x2e7ddc of _0x4ffb4e){const _0xc44f50=_0x2e7ddc[_0x18fb97(0xed)]((_0x14567d,_0x690317)=>{const _0x5264df=_0x18fb97,_0x121b3d=JSON[_0x5264df(0xee)](_0x690317)[_0x5264df(0xea)]*0x2;return _0x14567d+_0x121b3d;},0x0);if(_0xc44f50>constants_1[_0x18fb97(0xc8)])throw new salesforce_error_1[(_0x18fb97(0xe2))]('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1[_0x18fb97(0xc8)]+_0x18fb97(0xe1)+_0xc44f50);_0x42e71e+_0xc44f50>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x52f367&&(await _0x43c3fa(_0x348dfd),_0x348dfd=[],_0x42e71e=0x0),_0x42e71e+=_0xc44f50,_0x348dfd[_0x18fb97(0xff)](_0x2e7ddc);}_0x348dfd['length']&&await _0x43c3fa(_0x348dfd);}async[a233_0x961a67(0xc5)](_0x341aed,_0x44e055=![]){const _0x38cc44=a233_0x961a67,_0x52e182=(this[_0x38cc44(0xc6)]+ +_0x44e055)*0x3,_0x1b7c80=(0x0,utils_1[_0x38cc44(0xe9)])(_0x341aed,_0x52e182);try{while(_0x1b7c80[_0x38cc44(0xea)]){const _0x236142=_0x1b7c80['splice'](0x0,Math[_0x38cc44(0xe8)](constants_1[_0x38cc44(0xf3)]/_0x52e182));await this['proceedChunksToUpload'](_0x236142,_0x44e055);}}catch(_0x340c39){this[_0x38cc44(0x102)][_0x38cc44(0x103)](_0x340c39 instanceof salesforce_error_1[_0x38cc44(0xe2)]?JSON['stringify'](_0x340c39[_0x38cc44(0xcf)](),null,0x2):_0x340c39),this[_0x38cc44(0xdc)]['log'](_0x340c39 instanceof salesforce_error_1['SalesforceError']?JSON[_0x38cc44(0xee)](_0x340c39[_0x38cc44(0xcf)](),null,0x2):_0x340c39[_0x38cc44(0xb9)]());throw _0x340c39;}}async[a233_0x961a67(0xef)](_0x4662e6){const _0x4ff959=a233_0x961a67;for(const _0x3401e7 of _0x4662e6){if(!_0x3401e7[_0x4ff959(0xbd)][_0x4ff959(0xea)]&&!_0x3401e7['modified'][_0x4ff959(0xea)]&&!_0x3401e7['removed'][_0x4ff959(0xea)])continue;const _0x5dcc45=[],_0x2bca7a=[],_0xf4a1e7=new salesforce_components_manager_service_1[(_0x4ff959(0xf2))](this['options'][_0x4ff959(0xe5)],this['options'][_0x4ff959(0xd0)],_0x3401e7[_0x4ff959(0xcd)],this[_0x4ff959(0xd3)][_0x4ff959(0xf6)],this[_0x4ff959(0xfc)]);_0x5dcc45[_0x4ff959(0xff)](...await _0xf4a1e7['insert'](_0x3401e7[_0x4ff959(0xbd)],this[_0x4ff959(0xd3)][_0x4ff959(0xce)])),_0x5dcc45[_0x4ff959(0xff)](...await _0xf4a1e7[_0x4ff959(0xca)](_0x3401e7['modified'],this[_0x4ff959(0xd3)][_0x4ff959(0xce)])),_0x2bca7a[_0x4ff959(0xff)](await _0xf4a1e7[_0x4ff959(0xda)](_0x3401e7['removed'],!![])),this['proceededComponentsMeta']=_0xf4a1e7[_0x4ff959(0xe6)](),await this[_0x4ff959(0xc5)](_0x5dcc45,!![]);for(const _0x6e41c9 of _0x2bca7a){_0x6e41c9[_0x4ff959(0xfe)][_0x4ff959(0xea)]&&await this[_0x4ff959(0xc5)](_0x6e41c9[_0x4ff959(0xfe)],!![]),_0x6e41c9['componentsToUpdate']['length']&&await this[_0x4ff959(0xc5)](_0x6e41c9[_0x4ff959(0xc2)],!![]),_0x6e41c9[_0x4ff959(0xe3)][_0x4ff959(0xea)]&&await this[_0x4ff959(0xc5)](_0x6e41c9['componentsToDelete'],!![]);}this[_0x4ff959(0x102)][_0x4ff959(0xbb)](_0x4ff959(0xc9),_0x5dcc45['length']);}}async['proceedCommitsToBranch'](_0x303c89){const _0x15b98f=a233_0x961a67,_0x3e8dfa=[],_0x40e598=[];for(const _0x342321 of _0x303c89){if(!_0x342321[_0x15b98f(0xbd)]['length']&&!_0x342321['modified']['length']&&!_0x342321[_0x15b98f(0xdb)][_0x15b98f(0xea)])continue;const _0xa80b18=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x15b98f(0xd3)][_0x15b98f(0xe5)],this[_0x15b98f(0xd3)]['branchId'],_0x342321[_0x15b98f(0xcd)],this[_0x15b98f(0xd3)][_0x15b98f(0xf6)],[]);_0x3e8dfa[_0x15b98f(0xff)](...await _0xa80b18[_0x15b98f(0xba)](_0x342321['inserted'])),_0x3e8dfa[_0x15b98f(0xff)](...await _0xa80b18[_0x15b98f(0xca)](_0x342321[_0x15b98f(0xd6)])),_0x40e598['push'](await _0xa80b18[_0x15b98f(0xda)](_0x342321['removed']));}this[_0x15b98f(0x102)][_0x15b98f(0xbb)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x3e8dfa[_0x15b98f(0xea)]),await this[_0x15b98f(0xc5)](_0x3e8dfa);const _0x3e8a86=_0x40e598[_0x15b98f(0xed)]((_0x2f38ef,_0x525b4e)=>({'manifests':[..._0x2f38ef[_0x15b98f(0xfe)],..._0x525b4e[_0x15b98f(0xfe)]],'componentsToDelete':[..._0x2f38ef['componentsToDelete'],..._0x525b4e[_0x15b98f(0xe3)]],'componentsToUpdate':[..._0x2f38ef[_0x15b98f(0xc2)],..._0x525b4e[_0x15b98f(0xc2)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x3e8a86[_0x15b98f(0xfe)][_0x15b98f(0xea)]&&await this[_0x15b98f(0xc5)](_0x3e8a86['manifests'],!![]),_0x3e8a86[_0x15b98f(0xc2)]['length']&&await this[_0x15b98f(0xc5)](_0x3e8a86[_0x15b98f(0xc2)],!![]),_0x3e8a86[_0x15b98f(0xe3)][_0x15b98f(0xea)]&&await this['proceedRequests'](_0x3e8a86[_0x15b98f(0xe3)],!![]);}async[a233_0x961a67(0xde)](_0x236c7a){const _0x2ee318=a233_0x961a67;this[_0x2ee318(0xd3)]['branchId']?await this[_0x2ee318(0xc4)](_0x236c7a):await this[_0x2ee318(0xef)](_0x236c7a);}}exports[a233_0x961a67(0xc0)]=SalesforceCommitsManager;