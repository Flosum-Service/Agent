const a233_0x360b29=a233_0x54d3;function a233_0x2476(){const _0x1026b9=['497520aBvUbv','componentsToUpdate','../../../../core','reduce','recordTypes','get','toString','composite','componentId','proceededComponentsMeta','189597OYfFjH','search','__importDefault','update','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','173524MWksIM','Logger','proceedCommitsToRepository','inserted','\x20COMPONENTS_SIZE\x20=\x20','../errors/salesforce.error','apply','SalesforceCommitsManager','logger','chunkArray','getProceededComponentsMeta','105WDHerP','executeGraphs','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','../../../../constants','manifests','modified','toJSON','230178WgTxPh','\x20requests\x20to\x20composite\x20api.','push','stringify','SalesforceComponentsManager','819620UTridY','graph','SalesforceError','proceedCommits','702420sBAwNX','removed','log','__esModule','branchId','extractComponentIdsFromGraphsResponse','default','./salesforce-composite.service','proceedChunksToUpload','1471670nZzZYS','typedi','SalesforceCompositeService','./salesforce-components-manager.service','componentsToDelete','COMPONENTS_PER_CHUNK','reference','SALESFORCE_MAX_REQUEST_SIZE_BYTES','name','delete','repositoryId','../../../shared/utils','sfLogger','proceedRequests','length','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','splice','defineProperty','../utils/composite.utils','constructor','commitId','insert','proceedCommitsToBranch','Sending\x20','author','options'];a233_0x2476=function(){return _0x1026b9;};return a233_0x2476();}function a233_0x54d3(_0x2ea827,_0x5e29fd){const _0x162670=a233_0x2476();return a233_0x54d3=function(_0x363090,_0x1264e3){_0x363090=_0x363090-0x1eb;let _0x2476ad=_0x162670[_0x363090];return _0x2476ad;},a233_0x54d3(_0x2ea827,_0x5e29fd);}(function(_0x3907ad,_0x1be748){const _0x25bcdf=a233_0x54d3,_0x1fa13f=_0x3907ad();while(!![]){try{const _0x5cb6ba=-parseInt(_0x25bcdf(0x20e))/0x1+-parseInt(_0x25bcdf(0x1fc))/0x2+-parseInt(_0x25bcdf(0x1f7))/0x3+-parseInt(_0x25bcdf(0x213))/0x4+-parseInt(_0x25bcdf(0x220))/0x5+parseInt(_0x25bcdf(0x217))/0x6+parseInt(_0x25bcdf(0x207))/0x7*(parseInt(_0x25bcdf(0x1ed))/0x8);if(_0x5cb6ba===_0x1be748)break;else _0x1fa13f['push'](_0x1fa13f['shift']());}catch(_0x3a2613){_0x1fa13f['push'](_0x1fa13f['shift']());}}}(a233_0x2476,0x29a2e));const a233_0x1264e3=(function(){let _0xbbfb11=!![];return function(_0xe299bc,_0x4870a9){const _0x177f7f=_0xbbfb11?function(){const _0x313320=a233_0x54d3;if(_0x4870a9){const _0x18af44=_0x4870a9[_0x313320(0x202)](_0xe299bc,arguments);return _0x4870a9=null,_0x18af44;}}:function(){};return _0xbbfb11=![],_0x177f7f;};}()),a233_0x363090=a233_0x1264e3(this,function(){const _0x5ba864=a233_0x54d3;return a233_0x363090[_0x5ba864(0x1f3)]()[_0x5ba864(0x1f8)]('(((.+)+)+)+$')['toString']()[_0x5ba864(0x233)](a233_0x363090)[_0x5ba864(0x1f8)]('(((.+)+)+)+$');});a233_0x363090();'use strict';var __importDefault=this&&this[a233_0x360b29(0x1f9)]||function(_0x21243e){const _0x27d77a=a233_0x360b29;return _0x21243e&&_0x21243e[_0x27d77a(0x21a)]?_0x21243e:{'default':_0x21243e};};Object[a233_0x360b29(0x231)](exports,a233_0x360b29(0x21a),{'value':!![]}),exports[a233_0x360b29(0x203)]=void 0x0;const core_1=require(a233_0x360b29(0x1ef)),typedi_1=__importDefault(require(a233_0x360b29(0x221))),constants_1=require(a233_0x360b29(0x20a)),utils_1=require(a233_0x360b29(0x22b)),salesforce_error_1=require(a233_0x360b29(0x201)),composite_utils_1=require(a233_0x360b29(0x232)),salesforce_components_manager_service_1=require(a233_0x360b29(0x223)),salesforce_composite_service_1=require(a233_0x360b29(0x21e));class SalesforceCommitsManager{constructor(_0x5d831e){const _0x58106f=a233_0x360b29;this['options']=_0x5d831e,this[_0x58106f(0x225)]=0x3,this[_0x58106f(0x204)]=new core_1[(_0x58106f(0x1fd))](SalesforceCommitsManager[_0x58106f(0x228)]),this[_0x58106f(0x22c)]=this[_0x58106f(0x1ec)][_0x58106f(0x204)],this[_0x58106f(0x1f4)]=typedi_1[_0x58106f(0x21d)][_0x58106f(0x1f2)](salesforce_composite_service_1[_0x58106f(0x222)]),this[_0x58106f(0x1f6)]=[];}async[a233_0x360b29(0x21f)](_0x61fb5,_0x2392fc=![]){const _0x12f1ef=a233_0x360b29,_0xf72d6f=async _0x1fb803=>{const _0x38ea4f=a233_0x54d3;await this[_0x38ea4f(0x204)]['log'](_0x38ea4f(0x237)+_0x1fb803[_0x38ea4f(0x1f0)]((_0x26654a,_0x402125)=>_0x26654a+_0x402125[_0x38ea4f(0x22e)],0x0)+_0x38ea4f(0x20f));const _0x384462=_0x1fb803['map']((_0x2be834,_0x31beea)=>({'graphId':_0x38ea4f(0x214)+_0x31beea,'compositeRequest':_0x2be834})),_0x578228=await this['composite'][_0x38ea4f(0x208)](_0x384462);if(_0x2392fc){const _0xdc2ebe=(0x0,composite_utils_1[_0x38ea4f(0x21c)])(_0x578228);for(const {id:_0x574931,ref:_0x19f943}of _0xdc2ebe){const _0x1b695a=this[_0x38ea4f(0x1f6)]['find'](_0x451ebd=>_0x451ebd[_0x38ea4f(0x226)]===_0x19f943);_0x1b695a&&(_0x1b695a[_0x38ea4f(0x1f5)]=_0x574931);}}},_0x1864e8=0x1e8480;let _0x1c9d13=0x0,_0x20a6f3=[];for(const _0x4d8b8a of _0x61fb5){const _0x5b34cb=_0x4d8b8a[_0x12f1ef(0x1f0)]((_0x5d2995,_0x487e43)=>{const _0x74cc74=_0x12f1ef,_0x2d1c2a=JSON[_0x74cc74(0x211)](_0x487e43)[_0x74cc74(0x22e)]*0x2;return _0x5d2995+_0x2d1c2a;},0x0);if(_0x5b34cb>constants_1[_0x12f1ef(0x227)])throw new salesforce_error_1[(_0x12f1ef(0x215))]('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1[_0x12f1ef(0x227)]+_0x12f1ef(0x200)+_0x5b34cb);_0x1c9d13+_0x5b34cb>constants_1[_0x12f1ef(0x227)]-_0x1864e8&&(await _0xf72d6f(_0x20a6f3),_0x20a6f3=[],_0x1c9d13=0x0),_0x1c9d13+=_0x5b34cb,_0x20a6f3['push'](_0x4d8b8a);}_0x20a6f3[_0x12f1ef(0x22e)]&&await _0xf72d6f(_0x20a6f3);}async[a233_0x360b29(0x22d)](_0x471260,_0x52ab77=![]){const _0x1a5b49=a233_0x360b29,_0x33f5de=(this[_0x1a5b49(0x225)]+ +_0x52ab77)*0x3,_0x3ecf35=(0x0,utils_1[_0x1a5b49(0x205)])(_0x471260,_0x33f5de);try{while(_0x3ecf35[_0x1a5b49(0x22e)]){const _0x18f6a3=_0x3ecf35[_0x1a5b49(0x230)](0x0,Math['floor'](constants_1[_0x1a5b49(0x22f)]/_0x33f5de));await this['proceedChunksToUpload'](_0x18f6a3,_0x52ab77);}}catch(_0x3aaf01){this[_0x1a5b49(0x204)]['error'](_0x3aaf01 instanceof salesforce_error_1[_0x1a5b49(0x215)]?JSON[_0x1a5b49(0x211)](_0x3aaf01[_0x1a5b49(0x20d)](),null,0x2):_0x3aaf01),this['sfLogger']['log'](_0x3aaf01 instanceof salesforce_error_1[_0x1a5b49(0x215)]?JSON[_0x1a5b49(0x211)](_0x3aaf01['toJSON'](),null,0x2):_0x3aaf01[_0x1a5b49(0x1f3)]());throw _0x3aaf01;}}async[a233_0x360b29(0x1fe)](_0x2d5e99){const _0x386dde=a233_0x360b29;for(const _0x52d1ab of _0x2d5e99){if(!_0x52d1ab[_0x386dde(0x1ff)]['length']&&!_0x52d1ab[_0x386dde(0x20c)][_0x386dde(0x22e)]&&!_0x52d1ab[_0x386dde(0x218)][_0x386dde(0x22e)])continue;const _0x51d4b1=[],_0x425794=[],_0x338bdc=new salesforce_components_manager_service_1[(_0x386dde(0x212))](this[_0x386dde(0x1ec)][_0x386dde(0x22a)],this[_0x386dde(0x1ec)][_0x386dde(0x21b)],_0x52d1ab[_0x386dde(0x1eb)],this[_0x386dde(0x1ec)][_0x386dde(0x1f1)],this['proceededComponentsMeta']);_0x51d4b1[_0x386dde(0x210)](...await _0x338bdc[_0x386dde(0x235)](_0x52d1ab[_0x386dde(0x1ff)],this['options']['commitId'])),_0x51d4b1[_0x386dde(0x210)](...await _0x338bdc['update'](_0x52d1ab[_0x386dde(0x20c)],this['options'][_0x386dde(0x234)])),_0x425794[_0x386dde(0x210)](await _0x338bdc[_0x386dde(0x229)](_0x52d1ab['removed'],!![])),this[_0x386dde(0x1f6)]=_0x338bdc[_0x386dde(0x206)](),await this[_0x386dde(0x22d)](_0x51d4b1,!![]);for(const _0x1c2a2d of _0x425794){_0x1c2a2d[_0x386dde(0x20b)][_0x386dde(0x22e)]&&await this[_0x386dde(0x22d)](_0x1c2a2d['manifests'],!![]),_0x1c2a2d[_0x386dde(0x1ee)]['length']&&await this['proceedRequests'](_0x1c2a2d[_0x386dde(0x1ee)],!![]),_0x1c2a2d[_0x386dde(0x224)]['length']&&await this['proceedRequests'](_0x1c2a2d[_0x386dde(0x224)],!![]);}this[_0x386dde(0x204)]['log'](_0x386dde(0x209),_0x51d4b1[_0x386dde(0x22e)]);}}async[a233_0x360b29(0x236)](_0x260446){const _0x44f26b=a233_0x360b29,_0x47374f=[],_0x529352=[];for(const _0x1aca77 of _0x260446){if(!_0x1aca77[_0x44f26b(0x1ff)][_0x44f26b(0x22e)]&&!_0x1aca77['modified'][_0x44f26b(0x22e)]&&!_0x1aca77[_0x44f26b(0x218)][_0x44f26b(0x22e)])continue;const _0x10d512=new salesforce_components_manager_service_1[(_0x44f26b(0x212))](this['options'][_0x44f26b(0x22a)],this['options'][_0x44f26b(0x21b)],_0x1aca77[_0x44f26b(0x1eb)],this[_0x44f26b(0x1ec)][_0x44f26b(0x1f1)],[]);_0x47374f[_0x44f26b(0x210)](...await _0x10d512['insert'](_0x1aca77[_0x44f26b(0x1ff)])),_0x47374f[_0x44f26b(0x210)](...await _0x10d512[_0x44f26b(0x1fa)](_0x1aca77['modified'])),_0x529352[_0x44f26b(0x210)](await _0x10d512[_0x44f26b(0x229)](_0x1aca77['removed']));}this[_0x44f26b(0x204)][_0x44f26b(0x219)](_0x44f26b(0x1fb),_0x47374f['length']),await this[_0x44f26b(0x22d)](_0x47374f);const _0x595e8b=_0x529352[_0x44f26b(0x1f0)]((_0x3489fb,_0x3c6a52)=>({'manifests':[..._0x3489fb[_0x44f26b(0x20b)],..._0x3c6a52[_0x44f26b(0x20b)]],'componentsToDelete':[..._0x3489fb[_0x44f26b(0x224)],..._0x3c6a52['componentsToDelete']],'componentsToUpdate':[..._0x3489fb[_0x44f26b(0x1ee)],..._0x3c6a52['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x595e8b[_0x44f26b(0x20b)][_0x44f26b(0x22e)]&&await this['proceedRequests'](_0x595e8b['manifests'],!![]),_0x595e8b[_0x44f26b(0x1ee)][_0x44f26b(0x22e)]&&await this[_0x44f26b(0x22d)](_0x595e8b[_0x44f26b(0x1ee)],!![]),_0x595e8b['componentsToDelete'][_0x44f26b(0x22e)]&&await this[_0x44f26b(0x22d)](_0x595e8b[_0x44f26b(0x224)],!![]);}async[a233_0x360b29(0x216)](_0x512571){const _0x19b1dc=a233_0x360b29;this[_0x19b1dc(0x1ec)][_0x19b1dc(0x21b)]?await this[_0x19b1dc(0x236)](_0x512571):await this[_0x19b1dc(0x1fe)](_0x512571);}}exports[a233_0x360b29(0x203)]=SalesforceCommitsManager;