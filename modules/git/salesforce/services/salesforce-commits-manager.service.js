const a270_0x5267d5=a270_0x30dc;(function(_0x341658,_0x1d87a4){const _0x46522c=a270_0x30dc,_0x369645=_0x341658();while(!![]){try{const _0x30f3d2=-parseInt(_0x46522c(0x1c8))/0x1+parseInt(_0x46522c(0x194))/0x2*(parseInt(_0x46522c(0x19f))/0x3)+-parseInt(_0x46522c(0x1c2))/0x4*(-parseInt(_0x46522c(0x19b))/0x5)+parseInt(_0x46522c(0x1aa))/0x6+parseInt(_0x46522c(0x1a6))/0x7+parseInt(_0x46522c(0x1a4))/0x8*(parseInt(_0x46522c(0x1ac))/0x9)+-parseInt(_0x46522c(0x1b5))/0xa;if(_0x30f3d2===_0x1d87a4)break;else _0x369645['push'](_0x369645['shift']());}catch(_0x56448d){_0x369645['push'](_0x369645['shift']());}}}(a270_0x3ef2,0xcf8fc));function a270_0x3ef2(){const _0x43aa81=['modified','composite','16814790TwVZOd','options','toJSON','reduce','proceedCommitsToBranch','recordTypes','extractComponentIdsFromGraphsResponse','inserted','(((.+)+)+)+$','graph','\x20COMPONENTS_SIZE\x20=\x20','chunkArray','proceededComponentsMeta','5584892kRYWSz','branchId','componentsToUpdate','componentId','author','proceedRequests','1151629FHCnCt','get','floor','SalesforceCommitsManager','sfLogger','commitId','length','default','../../../../core','COMPONENTS_PER_CHUNK','SalesforceError','./salesforce-components-manager.service','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','proceedChunksToUpload','SALESFORCE_MAX_REQUEST_SIZE_BYTES','proceedCommitsToRepository','stringify','proceedCommits','push','name','getProceededComponentsMeta','search','88aTdqEY','apply','../utils/composite.utils','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','../../../shared/utils','logger','SalesforceComponentsManager','5TXShaX','delete','Sending\x20','insert','4215iWdJKc','typedi','manifests','reference','Logger','11864496PgcdGE','../../../../constants','4499474dibWDd','removed','toString','splice','596358GsJqXp','executeGraphs','9fozKuu','__importDefault','./salesforce-composite.service','repositoryId','defineProperty','componentsToDelete','log'];a270_0x3ef2=function(){return _0x43aa81;};return a270_0x3ef2();}function a270_0x30dc(_0x4c2bb6,_0x5174f0){const _0x5bf4a9=a270_0x3ef2();return a270_0x30dc=function(_0x316fb7,_0x65a516){_0x316fb7=_0x316fb7-0x185;let _0x3ef2dc=_0x5bf4a9[_0x316fb7];return _0x3ef2dc;},a270_0x30dc(_0x4c2bb6,_0x5174f0);}const a270_0x65a516=(function(){let _0x1e09c9=!![];return function(_0x5a8c83,_0x1af3d5){const _0x26c957=_0x1e09c9?function(){const _0x592a72=a270_0x30dc;if(_0x1af3d5){const _0x4f56e6=_0x1af3d5[_0x592a72(0x195)](_0x5a8c83,arguments);return _0x1af3d5=null,_0x4f56e6;}}:function(){};return _0x1e09c9=![],_0x26c957;};}()),a270_0x316fb7=a270_0x65a516(this,function(){const _0x2c8708=a270_0x30dc;return a270_0x316fb7[_0x2c8708(0x1a8)]()[_0x2c8708(0x193)]('(((.+)+)+)+$')['toString']()['constructor'](a270_0x316fb7)[_0x2c8708(0x193)](_0x2c8708(0x1bd));});a270_0x316fb7();'use strict';var __importDefault=this&&this[a270_0x5267d5(0x1ad)]||function(_0x43e7e3){return _0x43e7e3&&_0x43e7e3['__esModule']?_0x43e7e3:{'default':_0x43e7e3};};Object[a270_0x5267d5(0x1b0)](exports,'__esModule',{'value':!![]}),exports[a270_0x5267d5(0x1cb)]=void 0x0;const core_1=require(a270_0x5267d5(0x186)),typedi_1=__importDefault(require(a270_0x5267d5(0x1a0))),constants_1=require(a270_0x5267d5(0x1a5)),utils_1=require(a270_0x5267d5(0x198)),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a270_0x5267d5(0x196)),salesforce_components_manager_service_1=require(a270_0x5267d5(0x189)),salesforce_composite_service_1=require(a270_0x5267d5(0x1ae));class SalesforceCommitsManager{constructor(_0x45ed13){const _0x49852c=a270_0x5267d5;this[_0x49852c(0x1b6)]=_0x45ed13,this[_0x49852c(0x187)]=0x3,this[_0x49852c(0x199)]=new core_1[(_0x49852c(0x1a3))](SalesforceCommitsManager[_0x49852c(0x191)]),this[_0x49852c(0x1cc)]=this[_0x49852c(0x1b6)][_0x49852c(0x199)],this[_0x49852c(0x1b4)]=typedi_1[_0x49852c(0x185)][_0x49852c(0x1c9)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x49852c(0x1c1)]=[];}async[a270_0x5267d5(0x18b)](_0x1f0d3d,_0x2e03ac=![]){const _0x22bbf8=a270_0x5267d5,_0x490d45=async _0x15cb22=>{const _0x3cb708=a270_0x30dc;await this[_0x3cb708(0x199)][_0x3cb708(0x1b2)](_0x3cb708(0x19d)+_0x15cb22['reduce']((_0xbfd753,_0x56b71b)=>_0xbfd753+_0x56b71b[_0x3cb708(0x1ce)],0x0)+'\x20requests\x20to\x20composite\x20api.');const _0x1d6e04=_0x15cb22['map']((_0x389bcf,_0x10559c)=>({'graphId':_0x3cb708(0x1be)+_0x10559c,'compositeRequest':_0x389bcf})),_0x2c4427=await this[_0x3cb708(0x1b4)][_0x3cb708(0x1ab)](_0x1d6e04);if(_0x2e03ac){const _0x2010e3=(0x0,composite_utils_1[_0x3cb708(0x1bb)])(_0x2c4427);for(const {id:_0x9d103c,ref:_0x1d37f1}of _0x2010e3){const _0x53c5e4=this['proceededComponentsMeta']['find'](_0x49642b=>_0x49642b[_0x3cb708(0x1a2)]===_0x1d37f1);_0x53c5e4&&(_0x53c5e4[_0x3cb708(0x1c5)]=_0x9d103c);}}},_0x2229a5=0x1e8480;let _0x408448=0x0,_0x5689f1=[];for(const _0x216232 of _0x1f0d3d){const _0x44176e=_0x216232[_0x22bbf8(0x1b8)]((_0x3a6be7,_0xe9ea64)=>{const _0x15acdc=_0x22bbf8,_0x175dcc=JSON['stringify'](_0xe9ea64)[_0x15acdc(0x1ce)]*0x2;return _0x3a6be7+_0x175dcc;},0x0);if(_0x44176e>constants_1[_0x22bbf8(0x18c)])throw new salesforce_error_1['SalesforceError']('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']+_0x22bbf8(0x1bf)+_0x44176e);_0x408448+_0x44176e>constants_1[_0x22bbf8(0x18c)]-_0x2229a5&&(await _0x490d45(_0x5689f1),_0x5689f1=[],_0x408448=0x0),_0x408448+=_0x44176e,_0x5689f1['push'](_0x216232);}_0x5689f1[_0x22bbf8(0x1ce)]&&await _0x490d45(_0x5689f1);}async[a270_0x5267d5(0x1c7)](_0x174bb9,_0x2969c4=![]){const _0x5645a5=a270_0x5267d5,_0x301fb9=(this[_0x5645a5(0x187)]+ +_0x2969c4)*0x3,_0x3769be=(0x0,utils_1[_0x5645a5(0x1c0)])(_0x174bb9,_0x301fb9);try{while(_0x3769be[_0x5645a5(0x1ce)]){const _0xf5cf7d=_0x3769be[_0x5645a5(0x1a9)](0x0,Math[_0x5645a5(0x1ca)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x301fb9));await this[_0x5645a5(0x18b)](_0xf5cf7d,_0x2969c4);}}catch(_0x4a5f02){this[_0x5645a5(0x199)]['error'](_0x4a5f02 instanceof salesforce_error_1['SalesforceError']?JSON[_0x5645a5(0x18e)](_0x4a5f02[_0x5645a5(0x1b7)](),null,0x2):_0x4a5f02),this[_0x5645a5(0x1cc)][_0x5645a5(0x1b2)](_0x4a5f02 instanceof salesforce_error_1[_0x5645a5(0x188)]?JSON[_0x5645a5(0x18e)](_0x4a5f02[_0x5645a5(0x1b7)](),null,0x2):_0x4a5f02['toString']());throw _0x4a5f02;}}async[a270_0x5267d5(0x18d)](_0x3ada05){const _0x572307=a270_0x5267d5;for(const _0x3c3847 of _0x3ada05){if(!_0x3c3847['inserted']['length']&&!_0x3c3847[_0x572307(0x1b3)]['length']&&!_0x3c3847[_0x572307(0x1a7)][_0x572307(0x1ce)])continue;const _0xa13e5d=[],_0x457d4d=[],_0x3b240c=new salesforce_components_manager_service_1[(_0x572307(0x19a))](this[_0x572307(0x1b6)][_0x572307(0x1af)],this[_0x572307(0x1b6)][_0x572307(0x1c3)],_0x3c3847[_0x572307(0x1c6)],this[_0x572307(0x1b6)][_0x572307(0x1ba)],this[_0x572307(0x1c1)]);_0xa13e5d[_0x572307(0x190)](...await _0x3b240c[_0x572307(0x19e)](_0x3c3847[_0x572307(0x1bc)],this[_0x572307(0x1b6)][_0x572307(0x1cd)])),_0xa13e5d[_0x572307(0x190)](...await _0x3b240c['update'](_0x3c3847[_0x572307(0x1b3)],this[_0x572307(0x1b6)][_0x572307(0x1cd)])),_0x457d4d[_0x572307(0x190)](await _0x3b240c[_0x572307(0x19c)](_0x3c3847[_0x572307(0x1a7)],!![])),this['proceededComponentsMeta']=_0x3b240c[_0x572307(0x192)](),await this['proceedRequests'](_0xa13e5d,!![]);for(const _0x26e17a of _0x457d4d){_0x26e17a[_0x572307(0x1a1)][_0x572307(0x1ce)]&&await this[_0x572307(0x1c7)](_0x26e17a[_0x572307(0x1a1)],!![]),_0x26e17a[_0x572307(0x1c4)][_0x572307(0x1ce)]&&await this[_0x572307(0x1c7)](_0x26e17a[_0x572307(0x1c4)],!![]),_0x26e17a['componentsToDelete'][_0x572307(0x1ce)]&&await this[_0x572307(0x1c7)](_0x26e17a['componentsToDelete'],!![]);}this[_0x572307(0x199)][_0x572307(0x1b2)](_0x572307(0x18a),_0xa13e5d[_0x572307(0x1ce)]);}}async[a270_0x5267d5(0x1b9)](_0x524630){const _0x5a8dd5=a270_0x5267d5,_0x46aa3a=[],_0x385d8f=[];for(const _0x5b7910 of _0x524630){if(!_0x5b7910['inserted'][_0x5a8dd5(0x1ce)]&&!_0x5b7910[_0x5a8dd5(0x1b3)][_0x5a8dd5(0x1ce)]&&!_0x5b7910[_0x5a8dd5(0x1a7)][_0x5a8dd5(0x1ce)])continue;const _0x37f75c=new salesforce_components_manager_service_1[(_0x5a8dd5(0x19a))](this['options'][_0x5a8dd5(0x1af)],this[_0x5a8dd5(0x1b6)][_0x5a8dd5(0x1c3)],_0x5b7910[_0x5a8dd5(0x1c6)],this['options'][_0x5a8dd5(0x1ba)],[]);_0x46aa3a['push'](...await _0x37f75c[_0x5a8dd5(0x19e)](_0x5b7910['inserted'])),_0x46aa3a[_0x5a8dd5(0x190)](...await _0x37f75c['update'](_0x5b7910[_0x5a8dd5(0x1b3)])),_0x385d8f[_0x5a8dd5(0x190)](await _0x37f75c[_0x5a8dd5(0x19c)](_0x5b7910[_0x5a8dd5(0x1a7)]));}this['logger'][_0x5a8dd5(0x1b2)](_0x5a8dd5(0x197),_0x46aa3a['length']),await this[_0x5a8dd5(0x1c7)](_0x46aa3a);const _0x54e29a=_0x385d8f[_0x5a8dd5(0x1b8)]((_0xc2e3d2,_0x35417a)=>({'manifests':[..._0xc2e3d2[_0x5a8dd5(0x1a1)],..._0x35417a[_0x5a8dd5(0x1a1)]],'componentsToDelete':[..._0xc2e3d2[_0x5a8dd5(0x1b1)],..._0x35417a['componentsToDelete']],'componentsToUpdate':[..._0xc2e3d2[_0x5a8dd5(0x1c4)],..._0x35417a[_0x5a8dd5(0x1c4)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x54e29a[_0x5a8dd5(0x1a1)][_0x5a8dd5(0x1ce)]&&await this[_0x5a8dd5(0x1c7)](_0x54e29a[_0x5a8dd5(0x1a1)],!![]),_0x54e29a['componentsToUpdate'][_0x5a8dd5(0x1ce)]&&await this[_0x5a8dd5(0x1c7)](_0x54e29a[_0x5a8dd5(0x1c4)],!![]),_0x54e29a[_0x5a8dd5(0x1b1)][_0x5a8dd5(0x1ce)]&&await this[_0x5a8dd5(0x1c7)](_0x54e29a[_0x5a8dd5(0x1b1)],!![]);}async[a270_0x5267d5(0x18f)](_0x1e7aa1){const _0x1e77dc=a270_0x5267d5;this['options'][_0x1e77dc(0x1c3)]?await this[_0x1e77dc(0x1b9)](_0x1e7aa1):await this[_0x1e77dc(0x18d)](_0x1e7aa1);}}exports[a270_0x5267d5(0x1cb)]=SalesforceCommitsManager;