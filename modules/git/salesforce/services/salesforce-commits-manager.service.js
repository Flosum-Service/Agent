const a194_0x5d3b38=a194_0x3f24;(function(_0x3519ec,_0x51f3d7){const _0x3ed260=a194_0x3f24,_0x5f49db=_0x3519ec();while(!![]){try{const _0x4d62a9=-parseInt(_0x3ed260(0x180))/0x1+-parseInt(_0x3ed260(0x17c))/0x2+-parseInt(_0x3ed260(0x159))/0x3*(-parseInt(_0x3ed260(0x185))/0x4)+parseInt(_0x3ed260(0x198))/0x5+-parseInt(_0x3ed260(0x19a))/0x6*(parseInt(_0x3ed260(0x169))/0x7)+parseInt(_0x3ed260(0x195))/0x8+parseInt(_0x3ed260(0x18f))/0x9*(parseInt(_0x3ed260(0x171))/0xa);if(_0x4d62a9===_0x51f3d7)break;else _0x5f49db['push'](_0x5f49db['shift']());}catch(_0xd85812){_0x5f49db['push'](_0x5f49db['shift']());}}}(a194_0x760c,0x6202b));const a194_0x5da8ce=(function(){let _0x4f2a23=!![];return function(_0xd7b10c,_0x1eb0a1){const _0x513fd2=_0x4f2a23?function(){const _0x6e68d9=a194_0x3f24;if(_0x1eb0a1){const _0x1fb21d=_0x1eb0a1[_0x6e68d9(0x183)](_0xd7b10c,arguments);return _0x1eb0a1=null,_0x1fb21d;}}:function(){};return _0x4f2a23=![],_0x513fd2;};}()),a194_0x1666dd=a194_0x5da8ce(this,function(){const _0x38c953=a194_0x3f24;return a194_0x1666dd['toString']()['search']('(((.+)+)+)+$')[_0x38c953(0x196)]()[_0x38c953(0x189)](a194_0x1666dd)[_0x38c953(0x18a)](_0x38c953(0x192));});a194_0x1666dd();function a194_0x3f24(_0x72802b,_0x373190){const _0x139602=a194_0x760c();return a194_0x3f24=function(_0x1666dd,_0x5da8ce){_0x1666dd=_0x1666dd-0x157;let _0x760c6c=_0x139602[_0x1666dd];return _0x760c6c;},a194_0x3f24(_0x72802b,_0x373190);}'use strict';function a194_0x760c(){const _0x2dac97=['author','stringify','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','toJSON','sfLogger','./salesforce-components-manager.service','1833910EtDmCE','../../../shared/utils','modified','default','typedi','length','COMPONENTS_PER_CHUNK','proceedCommits','SalesforceComponentsManager','componentsToUpdate','componentId','614334ZtSwYD','proceedCommitsToRepository','../errors/salesforce.error','proceedCommitsToBranch','661499bnIbpd','componentsToDelete','logger','apply','composite','2050692OSEqcy','\x20requests\x20to\x20composite\x20api.','insert','Logger','constructor','search','recordTypes','branchId','name','SalesforceError','9wGYUQi','options','find','(((.+)+)+)+$','__esModule','SalesforceCompositeService','4487920YwKMhN','toString','log','2950550tPaRbj','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','2862282SFZzHC','getProceededComponentsMeta','proceedRequests','reduce','get','3zPmDAz','repositoryId','inserted','delete','SalesforceCommitsManager','proceededComponentsMeta','./salesforce-composite.service','error','map','update','push','extractComponentIdsFromGraphsResponse','floor','manifests','__importDefault','reference','7FHSPRh','removed'];a194_0x760c=function(){return _0x2dac97;};return a194_0x760c();}var __importDefault=this&&this[a194_0x5d3b38(0x167)]||function(_0x4b8513){return _0x4b8513&&_0x4b8513['__esModule']?_0x4b8513:{'default':_0x4b8513};};Object['defineProperty'](exports,a194_0x5d3b38(0x193),{'value':!![]}),exports[a194_0x5d3b38(0x15d)]=void 0x0;const core_1=require('../../../../core'),typedi_1=__importDefault(require(a194_0x5d3b38(0x175))),constants_1=require('../../../../constants'),utils_1=require(a194_0x5d3b38(0x172)),salesforce_error_1=require(a194_0x5d3b38(0x17e)),composite_utils_1=require('../utils/composite.utils'),salesforce_components_manager_service_1=require(a194_0x5d3b38(0x170)),salesforce_composite_service_1=require(a194_0x5d3b38(0x15f));class SalesforceCommitsManager{constructor(_0x5ae0c1){const _0x47e00b=a194_0x5d3b38;this[_0x47e00b(0x190)]=_0x5ae0c1,this[_0x47e00b(0x177)]=0x3,this['logger']=new core_1[(_0x47e00b(0x188))](SalesforceCommitsManager[_0x47e00b(0x18d)]),this[_0x47e00b(0x16f)]=this[_0x47e00b(0x190)][_0x47e00b(0x182)],this[_0x47e00b(0x184)]=typedi_1[_0x47e00b(0x174)][_0x47e00b(0x158)](salesforce_composite_service_1[_0x47e00b(0x194)]),this[_0x47e00b(0x15e)]=[];}async[a194_0x5d3b38(0x19c)](_0x143f94,_0x2cefe7=![]){const _0x405710=a194_0x5d3b38,_0x33e642=(this[_0x405710(0x177)]+ +_0x2cefe7)*0x3,_0x45f1e9=(0x0,utils_1['chunkArray'])(_0x143f94,_0x33e642);try{while(_0x45f1e9['length']){const _0x343ad1=_0x45f1e9['splice'](0x0,Math[_0x405710(0x165)](constants_1[_0x405710(0x199)]/_0x33e642));await this[_0x405710(0x182)][_0x405710(0x197)]('Sending\x20'+_0x343ad1[_0x405710(0x176)]*_0x33e642+_0x405710(0x186));const _0x46058f=_0x343ad1[_0x405710(0x161)]((_0x4571c1,_0xd9abce)=>({'graphId':'graph'+_0xd9abce,'compositeRequest':_0x4571c1})),_0x11b34f=await this[_0x405710(0x184)]['executeGraphs'](_0x46058f);if(_0x2cefe7){const _0x351c9e=(0x0,composite_utils_1[_0x405710(0x164)])(_0x11b34f);for(const {id:_0x910eda,ref:_0x4c2b48}of _0x351c9e){const _0x1b126a=this[_0x405710(0x15e)][_0x405710(0x191)](_0x3d5c8a=>_0x3d5c8a[_0x405710(0x168)]===_0x4c2b48);_0x1b126a&&(_0x1b126a[_0x405710(0x17b)]=_0x910eda);}}}}catch(_0x4fb22d){this[_0x405710(0x182)][_0x405710(0x160)](_0x4fb22d instanceof salesforce_error_1[_0x405710(0x18e)]?JSON[_0x405710(0x16c)](_0x4fb22d[_0x405710(0x16e)](),null,0x2):_0x4fb22d),this['sfLogger']['log'](_0x4fb22d instanceof salesforce_error_1['SalesforceError']?JSON[_0x405710(0x16c)](_0x4fb22d[_0x405710(0x16e)](),null,0x2):_0x4fb22d[_0x405710(0x196)]());throw _0x4fb22d;}}async[a194_0x5d3b38(0x17d)](_0x380efe){const _0x25f06c=a194_0x5d3b38;for(const _0x39f0e0 of _0x380efe){if(!_0x39f0e0['inserted'][_0x25f06c(0x176)]&&!_0x39f0e0['modified'][_0x25f06c(0x176)]&&!_0x39f0e0[_0x25f06c(0x16a)]['length'])continue;const _0x456429=[],_0x44b420=[],_0x4e8e36=new salesforce_components_manager_service_1[(_0x25f06c(0x179))](this['options']['repositoryId'],this[_0x25f06c(0x190)][_0x25f06c(0x18c)],_0x39f0e0[_0x25f06c(0x16b)],this['options'][_0x25f06c(0x18b)],this[_0x25f06c(0x15e)]);_0x456429[_0x25f06c(0x163)](...await _0x4e8e36[_0x25f06c(0x187)](_0x39f0e0['inserted'],this['options']['commitId'])),_0x456429[_0x25f06c(0x163)](...await _0x4e8e36[_0x25f06c(0x162)](_0x39f0e0['modified'],this['options']['commitId'])),_0x44b420['push'](await _0x4e8e36[_0x25f06c(0x15c)](_0x39f0e0[_0x25f06c(0x16a)],!![])),this[_0x25f06c(0x15e)]=_0x4e8e36[_0x25f06c(0x19b)](),await this[_0x25f06c(0x19c)](_0x456429,!![]);for(const _0x1ef91a of _0x44b420){_0x1ef91a[_0x25f06c(0x166)][_0x25f06c(0x176)]&&await this[_0x25f06c(0x19c)](_0x1ef91a[_0x25f06c(0x166)],!![]),_0x1ef91a[_0x25f06c(0x17a)]['length']&&await this[_0x25f06c(0x19c)](_0x1ef91a[_0x25f06c(0x17a)],!![]),_0x1ef91a[_0x25f06c(0x181)][_0x25f06c(0x176)]&&await this[_0x25f06c(0x19c)](_0x1ef91a[_0x25f06c(0x181)],!![]);}this['logger'][_0x25f06c(0x197)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x456429[_0x25f06c(0x176)]);}}async[a194_0x5d3b38(0x17f)](_0x5a0120){const _0x308759=a194_0x5d3b38,_0x59adad=[],_0x30408c=[];for(const _0x294d1f of _0x5a0120){if(!_0x294d1f[_0x308759(0x15b)][_0x308759(0x176)]&&!_0x294d1f['modified'][_0x308759(0x176)]&&!_0x294d1f[_0x308759(0x16a)][_0x308759(0x176)])continue;const _0x146196=new salesforce_components_manager_service_1[(_0x308759(0x179))](this[_0x308759(0x190)][_0x308759(0x15a)],this[_0x308759(0x190)][_0x308759(0x18c)],_0x294d1f[_0x308759(0x16b)],this['options'][_0x308759(0x18b)],[]);_0x59adad[_0x308759(0x163)](...await _0x146196[_0x308759(0x187)](_0x294d1f[_0x308759(0x15b)])),_0x59adad[_0x308759(0x163)](...await _0x146196[_0x308759(0x162)](_0x294d1f[_0x308759(0x173)])),_0x30408c['push'](await _0x146196[_0x308759(0x15c)](_0x294d1f['removed']));}this['logger'][_0x308759(0x197)](_0x308759(0x16d),_0x59adad[_0x308759(0x176)]),await this['proceedRequests'](_0x59adad);const _0x57b93f=_0x30408c[_0x308759(0x157)]((_0x38375d,_0xa6c569)=>({'manifests':[..._0x38375d[_0x308759(0x166)],..._0xa6c569[_0x308759(0x166)]],'componentsToDelete':[..._0x38375d[_0x308759(0x181)],..._0xa6c569['componentsToDelete']],'componentsToUpdate':[..._0x38375d[_0x308759(0x17a)],..._0xa6c569['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x57b93f['manifests'][_0x308759(0x176)]&&await this[_0x308759(0x19c)](_0x57b93f[_0x308759(0x166)],!![]),_0x57b93f[_0x308759(0x17a)][_0x308759(0x176)]&&await this[_0x308759(0x19c)](_0x57b93f[_0x308759(0x17a)],!![]),_0x57b93f[_0x308759(0x181)][_0x308759(0x176)]&&await this[_0x308759(0x19c)](_0x57b93f[_0x308759(0x181)],!![]);}async[a194_0x5d3b38(0x178)](_0x2e3289){const _0x3eb7e2=a194_0x5d3b38;this[_0x3eb7e2(0x190)][_0x3eb7e2(0x18c)]?await this[_0x3eb7e2(0x17f)](_0x2e3289):await this[_0x3eb7e2(0x17d)](_0x2e3289);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;