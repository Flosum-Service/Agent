const a233_0x45a7ab=a233_0xbd05;(function(_0x94cd49,_0x3692ac){const _0x2dbf2e=a233_0xbd05,_0x2f438b=_0x94cd49();while(!![]){try{const _0x12ca7b=-parseInt(_0x2dbf2e(0x156))/0x1*(parseInt(_0x2dbf2e(0x118))/0x2)+parseInt(_0x2dbf2e(0x12c))/0x3+-parseInt(_0x2dbf2e(0x141))/0x4*(parseInt(_0x2dbf2e(0x14b))/0x5)+parseInt(_0x2dbf2e(0x11a))/0x6*(parseInt(_0x2dbf2e(0x12a))/0x7)+-parseInt(_0x2dbf2e(0x129))/0x8*(parseInt(_0x2dbf2e(0x146))/0x9)+parseInt(_0x2dbf2e(0x151))/0xa*(parseInt(_0x2dbf2e(0x140))/0xb)+parseInt(_0x2dbf2e(0x11f))/0xc*(-parseInt(_0x2dbf2e(0x136))/0xd);if(_0x12ca7b===_0x3692ac)break;else _0x2f438b['push'](_0x2f438b['shift']());}catch(_0x5cfb97){_0x2f438b['push'](_0x2f438b['shift']());}}}(a233_0x3e89,0xe94eb));const a233_0x547798=(function(){let _0x5ddf5a=!![];return function(_0x3cacfb,_0x26f633){const _0x51a155=_0x5ddf5a?function(){const _0x2c5c55=a233_0xbd05;if(_0x26f633){const _0x5e9ecb=_0x26f633[_0x2c5c55(0x14e)](_0x3cacfb,arguments);return _0x26f633=null,_0x5e9ecb;}}:function(){};return _0x5ddf5a=![],_0x51a155;};}()),a233_0x2da29a=a233_0x547798(this,function(){const _0x2dac74=a233_0xbd05;return a233_0x2da29a[_0x2dac74(0x123)]()['search'](_0x2dac74(0x145))[_0x2dac74(0x123)]()[_0x2dac74(0x132)](a233_0x2da29a)[_0x2dac74(0x157)](_0x2dac74(0x145));});a233_0x2da29a();function a233_0x3e89(){const _0x1a760f=['toJSON','floor','recordTypes','removed','repositoryId','33832lGSvlL','434AOwyrS','proceededComponentsMeta','5557359tNOpmq','author','error','modified','./salesforce-components-manager.service','\x20requests\x20to\x20composite\x20api.','constructor','../errors/salesforce.error','proceedCommits','splice','8607547TvgIWu','inserted','length','reduce','map','executeGraphs','../../../../constants','proceedCommitsToBranch','componentsToDelete','branchId','22jPmJtv','16472XbKHfY','typedi','proceedCommitsToRepository','push','(((.+)+)+)+$','1107cltjOZ','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','../utils/composite.utils','options','COMPONENTS_PER_CHUNK','245CQtaia','stringify','logger','apply','reference','SalesforceError','1423740HOTRtd','Sending\x20','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','SalesforceCompositeService','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','2003HjwnlD','search','../../../../core','extractComponentIdsFromGraphsResponse','log','manifests','proceedChunksToUpload','../../../shared/utils','update','SalesforceCommitsManager','SALESFORCE_MAX_REQUEST_SIZE_BYTES','defineProperty','SalesforceComponentsManager','548YJOXDZ','composite','72708wYUXoh','componentsToUpdate','chunkArray','proceedRequests','commitId','12hHimSp','delete','Logger','__esModule','toString'];a233_0x3e89=function(){return _0x1a760f;};return a233_0x3e89();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3f3224){return _0x3f3224&&_0x3f3224['__esModule']?_0x3f3224:{'default':_0x3f3224};};function a233_0xbd05(_0x36f35c,_0x37a961){const _0x16a6f1=a233_0x3e89();return a233_0xbd05=function(_0x2da29a,_0x547798){_0x2da29a=_0x2da29a-0x115;let _0x3e89f4=_0x16a6f1[_0x2da29a];return _0x3e89f4;},a233_0xbd05(_0x36f35c,_0x37a961);}Object[a233_0x45a7ab(0x116)](exports,a233_0x45a7ab(0x122),{'value':!![]}),exports[a233_0x45a7ab(0x15f)]=void 0x0;const core_1=require(a233_0x45a7ab(0x158)),typedi_1=__importDefault(require(a233_0x45a7ab(0x142))),constants_1=require(a233_0x45a7ab(0x13c)),utils_1=require(a233_0x45a7ab(0x15d)),salesforce_error_1=require(a233_0x45a7ab(0x133)),composite_utils_1=require(a233_0x45a7ab(0x148)),salesforce_components_manager_service_1=require(a233_0x45a7ab(0x130)),salesforce_composite_service_1=require('./salesforce-composite.service');class SalesforceCommitsManager{constructor(_0x577305){const _0x3fb2c8=a233_0x45a7ab;this['options']=_0x577305,this[_0x3fb2c8(0x14a)]=0x3,this['logger']=new core_1[(_0x3fb2c8(0x121))](SalesforceCommitsManager['name']),this['sfLogger']=this[_0x3fb2c8(0x149)][_0x3fb2c8(0x14d)],this[_0x3fb2c8(0x119)]=typedi_1['default']['get'](salesforce_composite_service_1[_0x3fb2c8(0x154)]),this[_0x3fb2c8(0x12b)]=[];}async['proceedChunksToUpload'](_0x3a3f8a,_0x56dab4=![]){const _0x4bfd14=a233_0x45a7ab,_0x3b9dd1=async _0x5daf84=>{const _0x3c7fa7=a233_0xbd05;await this['logger'][_0x3c7fa7(0x15a)](_0x3c7fa7(0x152)+_0x5daf84[_0x3c7fa7(0x139)]((_0xf18e65,_0x51395b)=>_0xf18e65+_0x51395b['length'],0x0)+_0x3c7fa7(0x131));const _0x3d4b99=_0x5daf84[_0x3c7fa7(0x13a)]((_0x4fafdc,_0x36dbfd)=>({'graphId':'graph'+_0x36dbfd,'compositeRequest':_0x4fafdc})),_0x1d8ebf=await this['composite'][_0x3c7fa7(0x13b)](_0x3d4b99);if(_0x56dab4){const _0x592a28=(0x0,composite_utils_1[_0x3c7fa7(0x159)])(_0x1d8ebf);for(const {id:_0x5aa313,ref:_0x525216}of _0x592a28){const _0x59b127=this[_0x3c7fa7(0x12b)]['find'](_0x461212=>_0x461212[_0x3c7fa7(0x14f)]===_0x525216);_0x59b127&&(_0x59b127['componentId']=_0x5aa313);}}},_0x4f533a=0x1e8480;let _0xc908b2=0x0,_0x413088=[];for(const _0x3fec2e of _0x3a3f8a){const _0x15dc63=_0x3fec2e[_0x4bfd14(0x139)]((_0x54575b,_0x3961cf)=>{const _0x53daa2=_0x4bfd14,_0x394f74=JSON[_0x53daa2(0x14c)](_0x3961cf)[_0x53daa2(0x138)]*0x2;return _0x54575b+_0x394f74;},0x0);if(_0x15dc63>constants_1[_0x4bfd14(0x115)])throw new salesforce_error_1[(_0x4bfd14(0x150))]('Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20'+constants_1[_0x4bfd14(0x115)]+'\x20COMPONENTS_SIZE\x20=\x20'+_0x15dc63);_0xc908b2+_0x15dc63>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x4f533a&&(await _0x3b9dd1(_0x413088),_0x413088=[],_0xc908b2=0x0),_0xc908b2+=_0x15dc63,_0x413088['push'](_0x3fec2e);}_0x413088[_0x4bfd14(0x138)]&&await _0x3b9dd1(_0x413088);}async[a233_0x45a7ab(0x11d)](_0x42b6dc,_0x58e926=![]){const _0x280a90=a233_0x45a7ab,_0x396b23=(this[_0x280a90(0x14a)]+ +_0x58e926)*0x3,_0x321c6a=(0x0,utils_1[_0x280a90(0x11c)])(_0x42b6dc,_0x396b23);try{while(_0x321c6a['length']){const _0x2c6728=_0x321c6a[_0x280a90(0x135)](0x0,Math[_0x280a90(0x125)](constants_1[_0x280a90(0x153)]/_0x396b23));await this[_0x280a90(0x15c)](_0x2c6728,_0x58e926);}}catch(_0x7c5b74){this[_0x280a90(0x14d)][_0x280a90(0x12e)](_0x7c5b74 instanceof salesforce_error_1['SalesforceError']?JSON[_0x280a90(0x14c)](_0x7c5b74['toJSON'](),null,0x2):_0x7c5b74),this['sfLogger'][_0x280a90(0x15a)](_0x7c5b74 instanceof salesforce_error_1['SalesforceError']?JSON[_0x280a90(0x14c)](_0x7c5b74[_0x280a90(0x124)](),null,0x2):_0x7c5b74['toString']());throw _0x7c5b74;}}async[a233_0x45a7ab(0x143)](_0x278458){const _0x4fdb44=a233_0x45a7ab;for(const _0x348e43 of _0x278458){if(!_0x348e43[_0x4fdb44(0x137)]['length']&&!_0x348e43[_0x4fdb44(0x12f)]['length']&&!_0x348e43['removed'][_0x4fdb44(0x138)])continue;const _0x470fe6=[],_0x350455=[],_0x5090d1=new salesforce_components_manager_service_1[(_0x4fdb44(0x117))](this['options'][_0x4fdb44(0x128)],this[_0x4fdb44(0x149)][_0x4fdb44(0x13f)],_0x348e43[_0x4fdb44(0x12d)],this[_0x4fdb44(0x149)][_0x4fdb44(0x126)],this[_0x4fdb44(0x12b)]);_0x470fe6[_0x4fdb44(0x144)](...await _0x5090d1['insert'](_0x348e43[_0x4fdb44(0x137)],this[_0x4fdb44(0x149)][_0x4fdb44(0x11e)])),_0x470fe6['push'](...await _0x5090d1[_0x4fdb44(0x15e)](_0x348e43['modified'],this[_0x4fdb44(0x149)][_0x4fdb44(0x11e)])),_0x350455[_0x4fdb44(0x144)](await _0x5090d1[_0x4fdb44(0x120)](_0x348e43[_0x4fdb44(0x127)],!![])),this[_0x4fdb44(0x12b)]=_0x5090d1['getProceededComponentsMeta'](),await this['proceedRequests'](_0x470fe6,!![]);for(const _0x568ae5 of _0x350455){_0x568ae5[_0x4fdb44(0x15b)]['length']&&await this[_0x4fdb44(0x11d)](_0x568ae5[_0x4fdb44(0x15b)],!![]),_0x568ae5['componentsToUpdate'][_0x4fdb44(0x138)]&&await this['proceedRequests'](_0x568ae5[_0x4fdb44(0x11b)],!![]),_0x568ae5[_0x4fdb44(0x13e)][_0x4fdb44(0x138)]&&await this[_0x4fdb44(0x11d)](_0x568ae5[_0x4fdb44(0x13e)],!![]);}this[_0x4fdb44(0x14d)]['log'](_0x4fdb44(0x147),_0x470fe6['length']);}}async[a233_0x45a7ab(0x13d)](_0x599cd2){const _0x273840=a233_0x45a7ab,_0x39a748=[],_0x507a22=[];for(const _0x3edeff of _0x599cd2){if(!_0x3edeff[_0x273840(0x137)]['length']&&!_0x3edeff[_0x273840(0x12f)][_0x273840(0x138)]&&!_0x3edeff[_0x273840(0x127)][_0x273840(0x138)])continue;const _0x3e3efb=new salesforce_components_manager_service_1[(_0x273840(0x117))](this[_0x273840(0x149)][_0x273840(0x128)],this[_0x273840(0x149)][_0x273840(0x13f)],_0x3edeff[_0x273840(0x12d)],this[_0x273840(0x149)][_0x273840(0x126)],[]);_0x39a748['push'](...await _0x3e3efb['insert'](_0x3edeff[_0x273840(0x137)])),_0x39a748[_0x273840(0x144)](...await _0x3e3efb[_0x273840(0x15e)](_0x3edeff['modified'])),_0x507a22[_0x273840(0x144)](await _0x3e3efb['delete'](_0x3edeff[_0x273840(0x127)]));}this[_0x273840(0x14d)][_0x273840(0x15a)](_0x273840(0x155),_0x39a748[_0x273840(0x138)]),await this['proceedRequests'](_0x39a748);const _0x55c3ed=_0x507a22[_0x273840(0x139)]((_0x50854a,_0x1ced27)=>({'manifests':[..._0x50854a[_0x273840(0x15b)],..._0x1ced27[_0x273840(0x15b)]],'componentsToDelete':[..._0x50854a[_0x273840(0x13e)],..._0x1ced27[_0x273840(0x13e)]],'componentsToUpdate':[..._0x50854a[_0x273840(0x11b)],..._0x1ced27[_0x273840(0x11b)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x55c3ed[_0x273840(0x15b)][_0x273840(0x138)]&&await this[_0x273840(0x11d)](_0x55c3ed['manifests'],!![]),_0x55c3ed[_0x273840(0x11b)][_0x273840(0x138)]&&await this['proceedRequests'](_0x55c3ed[_0x273840(0x11b)],!![]),_0x55c3ed[_0x273840(0x13e)]['length']&&await this[_0x273840(0x11d)](_0x55c3ed[_0x273840(0x13e)],!![]);}async[a233_0x45a7ab(0x134)](_0x393153){const _0x4bea75=a233_0x45a7ab;this[_0x4bea75(0x149)][_0x4bea75(0x13f)]?await this['proceedCommitsToBranch'](_0x393153):await this['proceedCommitsToRepository'](_0x393153);}}exports[a233_0x45a7ab(0x15f)]=SalesforceCommitsManager;