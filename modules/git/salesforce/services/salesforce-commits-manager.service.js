const a177_0x14523f=a177_0x16c1;(function(_0x582abd,_0x58f43c){const _0x172fdb=a177_0x16c1,_0x3e1add=_0x582abd();while(!![]){try{const _0x4d049a=-parseInt(_0x172fdb(0x191))/0x1*(parseInt(_0x172fdb(0x19b))/0x2)+-parseInt(_0x172fdb(0x1c2))/0x3*(parseInt(_0x172fdb(0x184))/0x4)+parseInt(_0x172fdb(0x1a3))/0x5+parseInt(_0x172fdb(0x1a7))/0x6+-parseInt(_0x172fdb(0x1a5))/0x7+parseInt(_0x172fdb(0x1c6))/0x8*(-parseInt(_0x172fdb(0x189))/0x9)+parseInt(_0x172fdb(0x1bc))/0xa;if(_0x4d049a===_0x58f43c)break;else _0x3e1add['push'](_0x3e1add['shift']());}catch(_0x227b22){_0x3e1add['push'](_0x3e1add['shift']());}}}(a177_0x2b4e,0x98019));const a177_0x514088=(function(){let _0x12aa3d=!![];return function(_0x33f390,_0x5d21d3){const _0x18f909=_0x12aa3d?function(){if(_0x5d21d3){const _0x41018f=_0x5d21d3['apply'](_0x33f390,arguments);return _0x5d21d3=null,_0x41018f;}}:function(){};return _0x12aa3d=![],_0x18f909;};}()),a177_0x4e190b=a177_0x514088(this,function(){const _0x50d8d8=a177_0x16c1;return a177_0x4e190b[_0x50d8d8(0x1b4)]()[_0x50d8d8(0x1bb)](_0x50d8d8(0x18a))[_0x50d8d8(0x1b4)]()[_0x50d8d8(0x187)](a177_0x4e190b)['search']('(((.+)+)+)+$');});a177_0x4e190b();'use strict';function a177_0x16c1(_0x11ca3f,_0x309a67){const _0x3d33ce=a177_0x2b4e();return a177_0x16c1=function(_0x4e190b,_0x514088){_0x4e190b=_0x4e190b-0x181;let _0x2b4eee=_0x3d33ce[_0x4e190b];return _0x2b4eee;},a177_0x16c1(_0x11ca3f,_0x309a67);}function a177_0x2b4e(){const _0x12109e=['12dUAyrD','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','SalesforceComponentsManager','modified','15112qoFTdy','insert','gitSync','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','SalesforceCommitsManager','removed','727948GOaRfs','floor','options','constructor','extractComponentIdsFromGraphsResponse','657MdlEuh','(((.+)+)+)+$','toJSON','defineProperty','delete','splice','__importDefault','./salesforce-composite.service','16265UvAsYc','../../../../core','../../../../constants','author','push','proceededComponentsMeta','SalesforceGitSyncService','inserted','find','manifests','130laLPvn','SalesforceError','composite','branchId','proceedCommitsToRepository','name','recordTypes','log','4357465AnPbFV','../errors/salesforce.error','424851DrJRej','stringify','3565236oZQATf','../utils/composite.utils','../../../shared/utils','logger','reference','proceedCommitsToBranch','graph','componentsToDelete','./salesforce-git-sync.service','send','COMPONENTS_PER_CHUNK','__esModule','get','toString','componentsToUpdate','repositoryId','map','length','commitId','sfLogger','search','11406810tVYhNy','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','typedi','executeGraphs','error','proceedRequests'];a177_0x2b4e=function(){return _0x12109e;};return a177_0x2b4e();}var __importDefault=this&&this[a177_0x14523f(0x18f)]||function(_0x3f7bf9){const _0xa758fe=a177_0x14523f;return _0x3f7bf9&&_0x3f7bf9[_0xa758fe(0x1b2)]?_0x3f7bf9:{'default':_0x3f7bf9};};Object[a177_0x14523f(0x18c)](exports,a177_0x14523f(0x1b2),{'value':!![]}),exports[a177_0x14523f(0x182)]=void 0x0;const core_1=require(a177_0x14523f(0x192)),typedi_1=__importDefault(require(a177_0x14523f(0x1be))),constants_1=require(a177_0x14523f(0x193)),utils_1=require(a177_0x14523f(0x1a9)),salesforce_error_1=require(a177_0x14523f(0x1a4)),composite_utils_1=require(a177_0x14523f(0x1a8)),salesforce_components_manager_service_1=require('./salesforce-components-manager.service'),salesforce_composite_service_1=require(a177_0x14523f(0x190)),salesforce_git_sync_service_1=require(a177_0x14523f(0x1af));class SalesforceCommitsManager{constructor(_0x3e2e64){const _0x3d7afe=a177_0x14523f;this['options']=_0x3e2e64,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x3d7afe(0x1aa)]=new core_1['Logger'](SalesforceCommitsManager[_0x3d7afe(0x1a0)]),this[_0x3d7afe(0x1ba)]=this[_0x3d7afe(0x186)]['logger'],this['composite']=typedi_1['default'][_0x3d7afe(0x1b3)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x3d7afe(0x1c8)]=typedi_1['default']['get'](salesforce_git_sync_service_1[_0x3d7afe(0x197)]),this[_0x3d7afe(0x196)]=[];}async[a177_0x14523f(0x1c1)](_0x31ee96,_0x2e1917=![]){const _0x4a85fc=a177_0x14523f,_0x2181db=(this[_0x4a85fc(0x1b1)]+ +_0x2e1917)*0x3,_0x3b61f1=utils_1['chunkArray'](_0x31ee96,_0x2181db);try{while(_0x3b61f1[_0x4a85fc(0x1b8)]){const _0x10bf73=_0x3b61f1[_0x4a85fc(0x18e)](0x0,Math[_0x4a85fc(0x185)](constants_1[_0x4a85fc(0x1c3)]/_0x2181db));await this[_0x4a85fc(0x1ba)][_0x4a85fc(0x1a2)]('Sending\x20'+_0x10bf73[_0x4a85fc(0x1b8)]*_0x2181db+'\x20requests\x20to\x20composite\x20api.')[_0x4a85fc(0x1b0)]();const _0x5972f6=_0x10bf73[_0x4a85fc(0x1b7)]((_0xf356ad,_0x33b25d)=>({'graphId':_0x4a85fc(0x1ad)+_0x33b25d,'compositeRequest':_0xf356ad})),_0x570ab1=await this[_0x4a85fc(0x19d)][_0x4a85fc(0x1bf)](_0x5972f6);if(_0x2e1917){const _0x371710=composite_utils_1[_0x4a85fc(0x188)](_0x570ab1);for(const {id:_0x298a68,ref:_0x2df2f0}of _0x371710){const _0x3f2f4a=this[_0x4a85fc(0x196)][_0x4a85fc(0x199)](_0x544748=>_0x544748[_0x4a85fc(0x1ab)]===_0x2df2f0);_0x3f2f4a&&(_0x3f2f4a['componentId']=_0x298a68);}}}}catch(_0x3bfc9a){this[_0x4a85fc(0x1aa)][_0x4a85fc(0x1c0)](_0x3bfc9a instanceof salesforce_error_1[_0x4a85fc(0x19c)]?JSON[_0x4a85fc(0x1a6)](_0x3bfc9a[_0x4a85fc(0x18b)](),null,0x2):_0x3bfc9a),this['sfLogger']['log'](_0x3bfc9a instanceof salesforce_error_1['SalesforceError']?JSON[_0x4a85fc(0x1a6)](_0x3bfc9a[_0x4a85fc(0x18b)](),null,0x2):_0x3bfc9a[_0x4a85fc(0x1b4)]());throw _0x3bfc9a;}}async[a177_0x14523f(0x19f)](_0x315ec4){const _0x5aec8d=a177_0x14523f;for(const _0x43faa5 of _0x315ec4){if(!_0x43faa5['inserted'][_0x5aec8d(0x1b8)]&&!_0x43faa5['modified'][_0x5aec8d(0x1b8)]&&!_0x43faa5[_0x5aec8d(0x183)][_0x5aec8d(0x1b8)])continue;const _0x5336c0=[],_0x2f973b=[],_0x5e2f13=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x5aec8d(0x186)][_0x5aec8d(0x1b6)],this[_0x5aec8d(0x186)][_0x5aec8d(0x19e)],_0x43faa5[_0x5aec8d(0x194)],this[_0x5aec8d(0x186)][_0x5aec8d(0x1a1)],this['proceededComponentsMeta']);_0x5336c0['push'](...await _0x5e2f13[_0x5aec8d(0x1c7)](_0x43faa5[_0x5aec8d(0x198)],this['options'][_0x5aec8d(0x1b9)])),_0x5336c0[_0x5aec8d(0x195)](...await _0x5e2f13['update'](_0x43faa5[_0x5aec8d(0x1c5)],this['options'][_0x5aec8d(0x1b9)])),_0x2f973b[_0x5aec8d(0x195)](await _0x5e2f13[_0x5aec8d(0x18d)](_0x43faa5['removed'],!![])),this[_0x5aec8d(0x196)]=_0x5e2f13['getProceededComponentsMeta'](),await this[_0x5aec8d(0x1c1)](_0x5336c0,!![]);for(const _0x3a04e6 of _0x2f973b){_0x3a04e6[_0x5aec8d(0x19a)][_0x5aec8d(0x1b8)]&&await this[_0x5aec8d(0x1c1)](_0x3a04e6[_0x5aec8d(0x19a)],!![]),_0x3a04e6['componentsToUpdate']['length']&&await this['proceedRequests'](_0x3a04e6[_0x5aec8d(0x1b5)],!![]),_0x3a04e6['componentsToDelete'][_0x5aec8d(0x1b8)]&&await this[_0x5aec8d(0x1c1)](_0x3a04e6[_0x5aec8d(0x1ae)],!![]);}this[_0x5aec8d(0x1aa)][_0x5aec8d(0x1a2)](_0x5aec8d(0x1bd),_0x5336c0[_0x5aec8d(0x1b8)]);}}async[a177_0x14523f(0x1ac)](_0x5a555b){const _0x591282=a177_0x14523f,_0x47d616=[],_0x17175c=[];for(const _0x4c6b13 of _0x5a555b){if(!_0x4c6b13[_0x591282(0x198)][_0x591282(0x1b8)]&&!_0x4c6b13['modified'][_0x591282(0x1b8)]&&!_0x4c6b13['removed']['length'])continue;const _0x3f8c61=new salesforce_components_manager_service_1[(_0x591282(0x1c4))](this[_0x591282(0x186)]['repositoryId'],this[_0x591282(0x186)]['branchId'],_0x4c6b13[_0x591282(0x194)],this[_0x591282(0x186)][_0x591282(0x1a1)],[]);_0x47d616[_0x591282(0x195)](...await _0x3f8c61[_0x591282(0x1c7)](_0x4c6b13['inserted'])),_0x47d616[_0x591282(0x195)](...await _0x3f8c61['update'](_0x4c6b13['modified'])),_0x17175c['push'](await _0x3f8c61['delete'](_0x4c6b13[_0x591282(0x183)]));}this[_0x591282(0x1aa)][_0x591282(0x1a2)](_0x591282(0x181),_0x47d616[_0x591282(0x1b8)]),await this[_0x591282(0x1c1)](_0x47d616);const _0x2efb6b=_0x17175c['reduce']((_0x4d00cc,_0x45196e)=>({'manifests':[..._0x4d00cc[_0x591282(0x19a)],..._0x45196e[_0x591282(0x19a)]],'componentsToDelete':[..._0x4d00cc['componentsToDelete'],..._0x45196e[_0x591282(0x1ae)]],'componentsToUpdate':[..._0x4d00cc[_0x591282(0x1b5)],..._0x45196e['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x2efb6b[_0x591282(0x19a)][_0x591282(0x1b8)]&&await this[_0x591282(0x1c1)](_0x2efb6b[_0x591282(0x19a)],!![]),_0x2efb6b[_0x591282(0x1b5)][_0x591282(0x1b8)]&&await this[_0x591282(0x1c1)](_0x2efb6b['componentsToUpdate'],!![]),_0x2efb6b[_0x591282(0x1ae)][_0x591282(0x1b8)]&&await this[_0x591282(0x1c1)](_0x2efb6b['componentsToDelete'],!![]);}async['proceedCommits'](_0x3762be){const _0x52a2e6=a177_0x14523f;this[_0x52a2e6(0x186)][_0x52a2e6(0x19e)]?await this['proceedCommitsToBranch'](_0x3762be):await this[_0x52a2e6(0x19f)](_0x3762be);}}exports['SalesforceCommitsManager']=SalesforceCommitsManager;