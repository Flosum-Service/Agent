const a243_0xe67b6e=a243_0x9827;(function(_0x219b1d,_0x152ca4){const _0x56f02e=a243_0x9827,_0x3d5a8e=_0x219b1d();while(!![]){try{const _0x4d60ac=-parseInt(_0x56f02e(0x1b0))/0x1+-parseInt(_0x56f02e(0x1c6))/0x2*(parseInt(_0x56f02e(0x18f))/0x3)+parseInt(_0x56f02e(0x19b))/0x4+-parseInt(_0x56f02e(0x1b8))/0x5*(parseInt(_0x56f02e(0x1c3))/0x6)+-parseInt(_0x56f02e(0x1c8))/0x7*(-parseInt(_0x56f02e(0x1c7))/0x8)+parseInt(_0x56f02e(0x1bd))/0x9*(parseInt(_0x56f02e(0x195))/0xa)+parseInt(_0x56f02e(0x1a1))/0xb*(parseInt(_0x56f02e(0x18b))/0xc);if(_0x4d60ac===_0x152ca4)break;else _0x3d5a8e['push'](_0x3d5a8e['shift']());}catch(_0x500cbd){_0x3d5a8e['push'](_0x3d5a8e['shift']());}}}(a243_0x5e2c,0xe5c33));const a243_0x3b331a=(function(){let _0x131b11=!![];return function(_0x130926,_0x154a38){const _0xa493a1=_0x131b11?function(){const _0x546eff=a243_0x9827;if(_0x154a38){const _0x3bc3a7=_0x154a38[_0x546eff(0x197)](_0x130926,arguments);return _0x154a38=null,_0x3bc3a7;}}:function(){};return _0x131b11=![],_0xa493a1;};}()),a243_0x1d3717=a243_0x3b331a(this,function(){const _0x2e800f=a243_0x9827;return a243_0x1d3717[_0x2e800f(0x196)]()[_0x2e800f(0x191)](_0x2e800f(0x19d))[_0x2e800f(0x196)]()[_0x2e800f(0x1af)](a243_0x1d3717)[_0x2e800f(0x191)](_0x2e800f(0x19d));});function a243_0x9827(_0x3967c3,_0xb9fd2d){const _0x32c0e8=a243_0x5e2c();return a243_0x9827=function(_0x1d3717,_0x3b331a){_0x1d3717=_0x1d3717-0x18a;let _0x5e2cc5=_0x32c0e8[_0x1d3717];return _0x5e2cc5;},a243_0x9827(_0x3967c3,_0xb9fd2d);}a243_0x1d3717();'use strict';function a243_0x5e2c(){const _0x5768c7=['__esModule','error','get','options','COMPONENTS_PER_CHUNK','executeGraphs','SalesforceCommitsManager','\x20requests\x20to\x20composite\x20api.','getProceededComponentsMeta','stringify','extractComponentIdsFromGraphsResponse','delete','1596KREKim','SalesforceComponentsManager','./salesforce-composite.service','componentsToUpdate','179028zxbcqM','sfLogger','search','reduce','repositoryId','author','1105950kzDzDK','toString','apply','manifests','removed','SALESFORCE_MAX_REQUEST_SIZE_BYTES','7198028gAWfBD','splice','(((.+)+)+)+$','map','\x20COMPONENTS_SIZE\x20=\x20','branchId','61501JWLkoj','proceededComponentsMeta','graph','insert','../../../../core','length','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','../errors/salesforce.error','composite','SalesforceError','reference','componentId','__importDefault','proceedRequests','constructor','1658837BCzsYi','find','proceedCommits','defineProperty','../../../../constants','typedi','modified','inserted','10TpzknD','Cannot\x20upload\x20components\x20due\x20to\x20size\x20-\x20MAX_SIZE\x20=\x20','Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)','componentsToDelete','logger','36YPhXaz','toJSON','push','../../../shared/utils','proceedCommitsToBranch','proceedChunksToUpload','2241378nILXXL','floor','update','40PYZBrc','1244080tccExY','70BRfddW','../utils/composite.utils','./salesforce-components-manager.service','log','commitId','recordTypes'];a243_0x5e2c=function(){return _0x5768c7;};return a243_0x5e2c();}var __importDefault=this&&this[a243_0xe67b6e(0x1ad)]||function(_0xc9f565){const _0x3190fc=a243_0xe67b6e;return _0xc9f565&&_0xc9f565[_0x3190fc(0x1ce)]?_0xc9f565:{'default':_0xc9f565};};Object[a243_0xe67b6e(0x1b3)](exports,a243_0xe67b6e(0x1ce),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;const core_1=require(a243_0xe67b6e(0x1a5)),typedi_1=__importDefault(require(a243_0xe67b6e(0x1b5))),constants_1=require(a243_0xe67b6e(0x1b4)),utils_1=require(a243_0xe67b6e(0x1c0)),salesforce_error_1=require(a243_0xe67b6e(0x1a8)),composite_utils_1=require(a243_0xe67b6e(0x1c9)),salesforce_components_manager_service_1=require(a243_0xe67b6e(0x1ca)),salesforce_composite_service_1=require(a243_0xe67b6e(0x18d));class SalesforceCommitsManager{constructor(_0x261795){const _0x1481e6=a243_0xe67b6e;this['options']=_0x261795,this[_0x1481e6(0x1d2)]=0x3,this[_0x1481e6(0x1bc)]=new core_1['Logger'](SalesforceCommitsManager['name']),this[_0x1481e6(0x190)]=this[_0x1481e6(0x1d1)]['logger'],this[_0x1481e6(0x1a9)]=typedi_1['default'][_0x1481e6(0x1d0)](salesforce_composite_service_1['SalesforceCompositeService']),this[_0x1481e6(0x1a2)]=[];}async[a243_0xe67b6e(0x1c2)](_0x36203d,_0x45e21a=![]){const _0x171e1f=a243_0xe67b6e,_0x5cd930=async _0x3bb4a6=>{const _0x3195d6=a243_0x9827;await this[_0x3195d6(0x1bc)][_0x3195d6(0x1cb)]('Sending\x20'+_0x3bb4a6[_0x3195d6(0x192)]((_0x55d7ce,_0x2fd1f1)=>_0x55d7ce+_0x2fd1f1[_0x3195d6(0x1a6)],0x0)+_0x3195d6(0x1d5));const _0x4adf26=_0x3bb4a6[_0x3195d6(0x19e)]((_0x952b4a,_0x42d578)=>({'graphId':_0x3195d6(0x1a3)+_0x42d578,'compositeRequest':_0x952b4a})),_0x23e91e=await this[_0x3195d6(0x1a9)][_0x3195d6(0x1d3)](_0x4adf26);if(_0x45e21a){const _0x19c315=(0x0,composite_utils_1[_0x3195d6(0x1d8)])(_0x23e91e);for(const {id:_0x119ddd,ref:_0x1ecb5f}of _0x19c315){const _0x2e9948=this[_0x3195d6(0x1a2)][_0x3195d6(0x1b1)](_0x2ae436=>_0x2ae436[_0x3195d6(0x1ab)]===_0x1ecb5f);_0x2e9948&&(_0x2e9948[_0x3195d6(0x1ac)]=_0x119ddd);}}},_0x43de99=0x1e8480;let _0x31e846=0x0,_0x5c2f50=[];for(const _0x129dd6 of _0x36203d){const _0x490fad=_0x129dd6[_0x171e1f(0x192)]((_0x2f38fe,_0x430c0d)=>{const _0x599e6b=_0x171e1f,_0x35663f=JSON[_0x599e6b(0x1d7)](_0x430c0d)['length']*0x2;return _0x2f38fe+_0x35663f;},0x0);if(_0x490fad>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES'])throw new salesforce_error_1[(_0x171e1f(0x1aa))](_0x171e1f(0x1b9)+constants_1[_0x171e1f(0x19a)]+_0x171e1f(0x19f)+_0x490fad);_0x31e846+_0x490fad>constants_1['SALESFORCE_MAX_REQUEST_SIZE_BYTES']-_0x43de99&&(await _0x5cd930(_0x5c2f50),_0x5c2f50=[],_0x31e846=0x0),_0x31e846+=_0x490fad,_0x5c2f50['push'](_0x129dd6);}_0x5c2f50[_0x171e1f(0x1a6)]&&await _0x5cd930(_0x5c2f50);}async['proceedRequests'](_0x54cd25,_0xe0ca9e=![]){const _0x470450=a243_0xe67b6e,_0x225733=(this[_0x470450(0x1d2)]+ +_0xe0ca9e)*0x3,_0x155003=(0x0,utils_1['chunkArray'])(_0x54cd25,_0x225733);try{while(_0x155003[_0x470450(0x1a6)]){const _0x30309f=_0x155003[_0x470450(0x19c)](0x0,Math[_0x470450(0x1c4)](constants_1[_0x470450(0x1a7)]/_0x225733));await this[_0x470450(0x1c2)](_0x30309f,_0xe0ca9e);}}catch(_0x372e96){this['logger'][_0x470450(0x1cf)](_0x372e96 instanceof salesforce_error_1[_0x470450(0x1aa)]?JSON[_0x470450(0x1d7)](_0x372e96[_0x470450(0x1be)](),null,0x2):_0x372e96),this[_0x470450(0x190)][_0x470450(0x1cb)](_0x372e96 instanceof salesforce_error_1[_0x470450(0x1aa)]?JSON[_0x470450(0x1d7)](_0x372e96[_0x470450(0x1be)](),null,0x2):_0x372e96['toString']());throw _0x372e96;}}async['proceedCommitsToRepository'](_0x27753d){const _0x4d066d=a243_0xe67b6e;for(const _0x36dd15 of _0x27753d){if(!_0x36dd15[_0x4d066d(0x1b7)][_0x4d066d(0x1a6)]&&!_0x36dd15['modified']['length']&&!_0x36dd15['removed'][_0x4d066d(0x1a6)])continue;const _0x17946e=[],_0x31dd0f=[],_0x275e89=new salesforce_components_manager_service_1[(_0x4d066d(0x18c))](this[_0x4d066d(0x1d1)][_0x4d066d(0x193)],this[_0x4d066d(0x1d1)][_0x4d066d(0x1a0)],_0x36dd15['author'],this['options'][_0x4d066d(0x1cd)],this[_0x4d066d(0x1a2)]);_0x17946e[_0x4d066d(0x1bf)](...await _0x275e89[_0x4d066d(0x1a4)](_0x36dd15[_0x4d066d(0x1b7)],this[_0x4d066d(0x1d1)][_0x4d066d(0x1cc)])),_0x17946e[_0x4d066d(0x1bf)](...await _0x275e89['update'](_0x36dd15[_0x4d066d(0x1b6)],this[_0x4d066d(0x1d1)][_0x4d066d(0x1cc)])),_0x31dd0f[_0x4d066d(0x1bf)](await _0x275e89[_0x4d066d(0x18a)](_0x36dd15[_0x4d066d(0x199)],!![])),this[_0x4d066d(0x1a2)]=_0x275e89[_0x4d066d(0x1d6)](),await this[_0x4d066d(0x1ae)](_0x17946e,!![]);for(const _0x301214 of _0x31dd0f){_0x301214[_0x4d066d(0x198)][_0x4d066d(0x1a6)]&&await this[_0x4d066d(0x1ae)](_0x301214['manifests'],!![]),_0x301214[_0x4d066d(0x18e)][_0x4d066d(0x1a6)]&&await this[_0x4d066d(0x1ae)](_0x301214['componentsToUpdate'],!![]),_0x301214[_0x4d066d(0x1bb)]['length']&&await this[_0x4d066d(0x1ae)](_0x301214['componentsToDelete'],!![]);}this['logger']['log'](_0x4d066d(0x1ba),_0x17946e[_0x4d066d(0x1a6)]);}}async[a243_0xe67b6e(0x1c1)](_0x5e0590){const _0xfb8b40=a243_0xe67b6e,_0x2b71e3=[],_0x389343=[];for(const _0x57251b of _0x5e0590){if(!_0x57251b[_0xfb8b40(0x1b7)][_0xfb8b40(0x1a6)]&&!_0x57251b[_0xfb8b40(0x1b6)]['length']&&!_0x57251b['removed']['length'])continue;const _0x4b309f=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0xfb8b40(0x1d1)][_0xfb8b40(0x193)],this[_0xfb8b40(0x1d1)][_0xfb8b40(0x1a0)],_0x57251b[_0xfb8b40(0x194)],this[_0xfb8b40(0x1d1)]['recordTypes'],[]);_0x2b71e3[_0xfb8b40(0x1bf)](...await _0x4b309f[_0xfb8b40(0x1a4)](_0x57251b[_0xfb8b40(0x1b7)])),_0x2b71e3[_0xfb8b40(0x1bf)](...await _0x4b309f[_0xfb8b40(0x1c5)](_0x57251b[_0xfb8b40(0x1b6)])),_0x389343[_0xfb8b40(0x1bf)](await _0x4b309f[_0xfb8b40(0x18a)](_0x57251b[_0xfb8b40(0x199)]));}this['logger'][_0xfb8b40(0x1cb)]('Have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x2b71e3['length']),await this[_0xfb8b40(0x1ae)](_0x2b71e3);const _0x1e24e7=_0x389343[_0xfb8b40(0x192)]((_0x1524e2,_0x524731)=>({'manifests':[..._0x1524e2['manifests'],..._0x524731[_0xfb8b40(0x198)]],'componentsToDelete':[..._0x1524e2[_0xfb8b40(0x1bb)],..._0x524731[_0xfb8b40(0x1bb)]],'componentsToUpdate':[..._0x1524e2[_0xfb8b40(0x18e)],..._0x524731['componentsToUpdate']]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x1e24e7[_0xfb8b40(0x198)]['length']&&await this[_0xfb8b40(0x1ae)](_0x1e24e7[_0xfb8b40(0x198)],!![]),_0x1e24e7[_0xfb8b40(0x18e)][_0xfb8b40(0x1a6)]&&await this[_0xfb8b40(0x1ae)](_0x1e24e7['componentsToUpdate'],!![]),_0x1e24e7[_0xfb8b40(0x1bb)][_0xfb8b40(0x1a6)]&&await this[_0xfb8b40(0x1ae)](_0x1e24e7[_0xfb8b40(0x1bb)],!![]);}async[a243_0xe67b6e(0x1b2)](_0x3937aa){const _0x51f3a6=a243_0xe67b6e;this[_0x51f3a6(0x1d1)][_0x51f3a6(0x1a0)]?await this[_0x51f3a6(0x1c1)](_0x3937aa):await this['proceedCommitsToRepository'](_0x3937aa);}}exports[a243_0xe67b6e(0x1d4)]=SalesforceCommitsManager;