const a236_0x47bfdc=a236_0x5d57;function a236_0x5d57(_0xdaf913,_0x2f2154){const _0x124c72=a236_0x495a();return a236_0x5d57=function(_0x251399,_0x40b44a){_0x251399=_0x251399-0x72;let _0x495a13=_0x124c72[_0x251399];return _0x495a13;},a236_0x5d57(_0xdaf913,_0x2f2154);}(function(_0x1328a2,_0x384611){const _0x1487a3=a236_0x5d57,_0x4d881f=_0x1328a2();while(!![]){try{const _0x3868e4=-parseInt(_0x1487a3(0xa8))/0x1+-parseInt(_0x1487a3(0x79))/0x2*(-parseInt(_0x1487a3(0x82))/0x3)+parseInt(_0x1487a3(0x9e))/0x4+-parseInt(_0x1487a3(0x74))/0x5+-parseInt(_0x1487a3(0xb7))/0x6+parseInt(_0x1487a3(0x9c))/0x7*(-parseInt(_0x1487a3(0x9f))/0x8)+parseInt(_0x1487a3(0xb3))/0x9*(parseInt(_0x1487a3(0x99))/0xa);if(_0x3868e4===_0x384611)break;else _0x4d881f['push'](_0x4d881f['shift']());}catch(_0x1b19b9){_0x4d881f['push'](_0x4d881f['shift']());}}}(a236_0x495a,0x3dba1));const a236_0x40b44a=(function(){let _0x245b8a=!![];return function(_0x560bea,_0x251aed){const _0x642996=_0x245b8a?function(){if(_0x251aed){const _0x22bddc=_0x251aed['apply'](_0x560bea,arguments);return _0x251aed=null,_0x22bddc;}}:function(){};return _0x245b8a=![],_0x642996;};}()),a236_0x251399=a236_0x40b44a(this,function(){const _0x9f1c72=a236_0x5d57;return a236_0x251399['toString']()[_0x9f1c72(0x8a)]('(((.+)+)+)+$')[_0x9f1c72(0x73)]()[_0x9f1c72(0x81)](a236_0x251399)[_0x9f1c72(0x8a)](_0x9f1c72(0x83));});a236_0x251399();'use strict';var __decorate=this&&this['__decorate']||function(_0xed5ed,_0x2b7911,_0x2148d9,_0x4601df){const _0x3c8c9a=a236_0x5d57;var _0x197b4f=arguments[_0x3c8c9a(0xb2)],_0x506ff2=_0x197b4f<0x3?_0x2b7911:_0x4601df===null?_0x4601df=Object['getOwnPropertyDescriptor'](_0x2b7911,_0x2148d9):_0x4601df,_0x39c2ec;if(typeof Reflect===_0x3c8c9a(0x89)&&typeof Reflect['decorate']===_0x3c8c9a(0xab))_0x506ff2=Reflect[_0x3c8c9a(0x7b)](_0xed5ed,_0x2b7911,_0x2148d9,_0x4601df);else{for(var _0x14a2ec=_0xed5ed[_0x3c8c9a(0xb2)]-0x1;_0x14a2ec>=0x0;_0x14a2ec--)if(_0x39c2ec=_0xed5ed[_0x14a2ec])_0x506ff2=(_0x197b4f<0x3?_0x39c2ec(_0x506ff2):_0x197b4f>0x3?_0x39c2ec(_0x2b7911,_0x2148d9,_0x506ff2):_0x39c2ec(_0x2b7911,_0x2148d9))||_0x506ff2;}return _0x197b4f>0x3&&_0x506ff2&&Object['defineProperty'](_0x2b7911,_0x2148d9,_0x506ff2),_0x506ff2;},__metadata=this&&this[a236_0x47bfdc(0x7e)]||function(_0x5607e8,_0x226936){const _0xc185a0=a236_0x47bfdc;if(typeof Reflect===_0xc185a0(0x89)&&typeof Reflect[_0xc185a0(0x96)]==='function')return Reflect[_0xc185a0(0x96)](_0x5607e8,_0x226936);};Object[a236_0x47bfdc(0x9d)](exports,'__esModule',{'value':!![]}),exports[a236_0x47bfdc(0xa4)]=void 0x0;const not_found_error_1=require(a236_0x47bfdc(0x7a)),typedi_1=require(a236_0x47bfdc(0xb8)),constants_1=require('../../../../constants'),queries_1=require('../queries'),flosum_naming_utils_1=require(a236_0x47bfdc(0x88)),salesforce_query_service_1=require(a236_0x47bfdc(0x90)),salesforce_rest_service_1=require(a236_0x47bfdc(0xb6));function a236_0x495a(){const _0x42ae3c=['15rqvVDE','(((.+)+)+)+$','Completed','map','push','File_Name__c','../utils/flosum-naming.utils','object','search','Version__c','post','fetchBranchComponentsByFilenames','SalesforceQueryService','splice','./salesforce-query.service','replace','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','GET_COMPONENT_RECORD_TYPES_QUERY','GET_BRANCH_COMPONENTS_QUERY','%repositoryId%','metadata','CRC32__c','%branchId%','20NewIYh','Component_Name__c','FLOSUM_COMMIT','14KyOTOG','defineProperty','307480HAXHZm','1903624cvNpYw','FLOSUM_NAMESPACE','getRepositoryIdByName','getComponentRecordTypes','fetchRepositoryComponentsByFilenames','SalesforceGitSyncService','MAX_QUERY_ARRAY_ITEMS','query','GET_REPOSITORY_COMPONENTS_QUERY','331998BwBpNI','%fileNames%','restService','function','SalesforceRestService','fetchRepositoryComponents','%componentIds%','Name','\x22\x20not\x20found\x20in\x20flosum.','NotFoundError','length','4013838xDxDvT','fetchCommitManifestsByComponentIds','extractComponentMetadataFromRecord','./salesforce-rest.service','1268082PKNopT','typedi','Status__c','queryService','%name%','toString','763400Ibpbms','Service','GET_REPOSITORY_BY_NAME_QUERY','Branch\x20\x22','substr','182372JcdurQ','../../../../core/errors/not-found.error','decorate','Is_From_Agent__c','Component_Type__c','__metadata','FLOSUM_GIT_NAMESPACE','join','constructor'];a236_0x495a=function(){return _0x42ae3c;};return a236_0x495a();}let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x5da26e,_0x2e4467){const _0x219352=a236_0x47bfdc;this[_0x219352(0xba)]=_0x5da26e,this[_0x219352(0xaa)]=_0x2e4467,this[_0x219352(0xa5)]=0xc8;}[a236_0x47bfdc(0xb5)](_0x261d4f){const _0x4ef0e7=a236_0x47bfdc,_0x336faf=(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x261d4f,[_0x4ef0e7(0x9a),_0x4ef0e7(0x7d),_0x4ef0e7(0x97),_0x4ef0e7(0x87),_0x4ef0e7(0x8b),'Id']);return{'id':_0x336faf['Id'],'name':_0x336faf['Component_Name__c'],'type':_0x336faf[_0x4ef0e7(0x7d)],'fileName':_0x336faf[_0x4ef0e7(0x87)],'crc32':_0x336faf[_0x4ef0e7(0x97)],'version':+_0x336faf['Version__c']};}async[a236_0x47bfdc(0xa1)](_0x1b44eb){const _0x1fd132=a236_0x47bfdc,[_0x407b86]=await this[_0x1fd132(0xba)][_0x1fd132(0xa6)](queries_1[_0x1fd132(0x76)][_0x1fd132(0x91)](_0x1fd132(0x72),_0x1b44eb));if(!_0x407b86)throw new not_found_error_1[(_0x1fd132(0xb1))]('Repository\x20\x22'+_0x1b44eb+_0x1fd132(0xb0));return _0x407b86['Id'];}async['getBranchIdByName'](_0x327eae){const _0x2a529f=a236_0x47bfdc,[_0x1806f0]=await this[_0x2a529f(0xba)]['query'](queries_1['GET_BRANCH_BY_NAME_QUERY']['replace']('%name%',_0x327eae));if(!_0x1806f0)throw new not_found_error_1[(_0x2a529f(0xb1))](_0x2a529f(0x77)+_0x327eae+_0x2a529f(0xb0));return _0x1806f0['Id'];}async[a236_0x47bfdc(0xa2)](){const _0x30140b=a236_0x47bfdc,_0x2eea04=await this[_0x30140b(0xba)][_0x30140b(0xa6)](queries_1[_0x30140b(0x93)]);return _0x2eea04[_0x30140b(0x85)](_0x3eb07=>(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x3eb07,['Id','Name']))[_0x30140b(0x85)](_0x5ed30a=>({'id':_0x5ed30a['Id'],'name':_0x5ed30a[_0x30140b(0xaf)]}));}async[a236_0x47bfdc(0xa3)](_0x4ced43,_0x29c70d){const _0x7d0020=a236_0x47bfdc,_0x2a4431=[];while(_0x4ced43[_0x7d0020(0xb2)]){const _0x5f32e1=queries_1[_0x7d0020(0x92)][_0x7d0020(0x91)]('%fileNames%',_0x4ced43[_0x7d0020(0x8f)](0x0,this[_0x7d0020(0xa5)])[_0x7d0020(0x85)](_0x18c198=>'\x27'+_0x18c198+'\x27')[_0x7d0020(0x80)](','))[_0x7d0020(0x91)]('%repositoryId%',_0x29c70d),_0x54dbca=await this[_0x7d0020(0xba)][_0x7d0020(0xa6)](_0x5f32e1);_0x2a4431['push'](..._0x54dbca);}return _0x2a4431[_0x7d0020(0x85)](_0x4e929d=>this['extractComponentMetadataFromRecord'](_0x4e929d));}async[a236_0x47bfdc(0x8d)](_0x1c8f18,_0x2eb1d7){const _0x18288a=a236_0x47bfdc,_0x418b81=[];while(_0x1c8f18[_0x18288a(0xb2)]){const _0x1656ab=queries_1['GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY'][_0x18288a(0x91)](_0x18288a(0xa9),_0x1c8f18[_0x18288a(0x8f)](0x0,this['MAX_QUERY_ARRAY_ITEMS'])['map'](_0xfa1d50=>'\x27'+_0xfa1d50+'\x27')[_0x18288a(0x80)](','))['replace']('%branchId%',_0x2eb1d7),_0x376aa6=await this[_0x18288a(0xba)][_0x18288a(0xa6)](_0x1656ab);_0x418b81['push'](..._0x376aa6);}return _0x418b81['map'](_0x32a5c6=>this[_0x18288a(0xb5)](_0x32a5c6));}async[a236_0x47bfdc(0xad)](_0x4a9a86){const _0x4ccf64=a236_0x47bfdc,_0x3ba23e=queries_1[_0x4ccf64(0xa7)][_0x4ccf64(0x91)](_0x4ccf64(0x95),_0x4a9a86),_0x28baa0=await this[_0x4ccf64(0xba)][_0x4ccf64(0xa6)](_0x3ba23e);return _0x28baa0[_0x4ccf64(0x85)](_0x39f5ee=>this['extractComponentMetadataFromRecord'](_0x39f5ee));}async['fetchBranchComponents'](_0x449b83){const _0x554a74=a236_0x47bfdc,_0x4b2257=queries_1[_0x554a74(0x94)][_0x554a74(0x91)](_0x554a74(0x98),_0x449b83),_0x591c36=await this[_0x554a74(0xba)][_0x554a74(0xa6)](_0x4b2257);return _0x591c36[_0x554a74(0x85)](_0x186784=>this['extractComponentMetadataFromRecord'](_0x186784));}async[a236_0x47bfdc(0xb4)](_0x496fcc){const _0xb89fa0=a236_0x47bfdc,_0x5d6ea2=[..._0x496fcc],_0x17b8a7=[];while(_0x5d6ea2[_0xb89fa0(0xb2)]){const _0x5cd865=queries_1['GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS'][_0xb89fa0(0x91)](_0xb89fa0(0xae),_0x5d6ea2[_0xb89fa0(0x8f)](0x0,this[_0xb89fa0(0xa5)])[_0xb89fa0(0x85)](_0x219d9a=>'\x27'+_0x219d9a+'\x27')[_0xb89fa0(0x80)](',')),_0x40e8dd=await this[_0xb89fa0(0xba)][_0xb89fa0(0xa6)](_0x5cd865);_0x17b8a7[_0xb89fa0(0x86)](..._0x40e8dd[_0xb89fa0(0x85)](_0x5d85d2=>_0x5d85d2['Id']));}return _0x17b8a7;}async['createCommit'](_0x13e91a,_0x547951){const _0x4481eb=a236_0x47bfdc;return this['restService'][_0x4481eb(0x8c)](constants_1[_0x4481eb(0x9b)],{[constants_1[_0x4481eb(0xa0)]+'Repository__c']:_0x547951,[constants_1[_0x4481eb(0xa0)]+'Commit_Name__c']:_0x13e91a[_0x4481eb(0x78)](0x0,0xff),[constants_1[_0x4481eb(0xa0)]+_0x4481eb(0xb9)]:_0x4481eb(0x84),[constants_1[_0x4481eb(0x7f)]+_0x4481eb(0x7c)]:!![]});}};SalesforceGitSyncService=__decorate([(0x0,typedi_1[a236_0x47bfdc(0x75)])(),__metadata('design:paramtypes',[salesforce_query_service_1[a236_0x47bfdc(0x8e)],salesforce_rest_service_1[a236_0x47bfdc(0xac)]])],SalesforceGitSyncService),exports[a236_0x47bfdc(0xa4)]=SalesforceGitSyncService;