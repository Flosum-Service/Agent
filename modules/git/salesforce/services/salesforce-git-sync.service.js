const a274_0x1ed83d=a274_0x30a7;(function(_0x4c419a,_0x70f77c){const _0x509648=a274_0x30a7,_0x1bcb21=_0x4c419a();while(!![]){try{const _0x41cee1=-parseInt(_0x509648(0x116))/0x1*(parseInt(_0x509648(0x10f))/0x2)+-parseInt(_0x509648(0x11f))/0x3*(parseInt(_0x509648(0x149))/0x4)+parseInt(_0x509648(0x118))/0x5*(parseInt(_0x509648(0x13b))/0x6)+parseInt(_0x509648(0x153))/0x7+-parseInt(_0x509648(0x150))/0x8+-parseInt(_0x509648(0x138))/0x9+parseInt(_0x509648(0x11e))/0xa;if(_0x41cee1===_0x70f77c)break;else _0x1bcb21['push'](_0x1bcb21['shift']());}catch(_0x29944f){_0x1bcb21['push'](_0x1bcb21['shift']());}}}(a274_0x294d,0x531d0));const a274_0x3e9750=(function(){let _0x18197f=!![];return function(_0x29ba8b,_0x4f183f){const _0x5b752d=_0x18197f?function(){const _0x267045=a274_0x30a7;if(_0x4f183f){const _0x574752=_0x4f183f[_0x267045(0x14e)](_0x29ba8b,arguments);return _0x4f183f=null,_0x574752;}}:function(){};return _0x18197f=![],_0x5b752d;};}()),a274_0x4e3ae5=a274_0x3e9750(this,function(){const _0x42d97a=a274_0x30a7;return a274_0x4e3ae5[_0x42d97a(0x131)]()[_0x42d97a(0x13c)]('(((.+)+)+)+$')[_0x42d97a(0x131)]()['constructor'](a274_0x4e3ae5)[_0x42d97a(0x13c)](_0x42d97a(0x145));});a274_0x4e3ae5();'use strict';var __decorate=this&&this[a274_0x1ed83d(0x130)]||function(_0x55a420,_0x4fe370,_0x2c6680,_0x589c5b){const _0x4aecb9=a274_0x1ed83d;var _0x7e3b9c=arguments['length'],_0xf0fbeb=_0x7e3b9c<0x3?_0x4fe370:_0x589c5b===null?_0x589c5b=Object[_0x4aecb9(0x114)](_0x4fe370,_0x2c6680):_0x589c5b,_0x5d747d;if(typeof Reflect===_0x4aecb9(0x10e)&&typeof Reflect[_0x4aecb9(0x127)]==='function')_0xf0fbeb=Reflect[_0x4aecb9(0x127)](_0x55a420,_0x4fe370,_0x2c6680,_0x589c5b);else{for(var _0x17695f=_0x55a420[_0x4aecb9(0x126)]-0x1;_0x17695f>=0x0;_0x17695f--)if(_0x5d747d=_0x55a420[_0x17695f])_0xf0fbeb=(_0x7e3b9c<0x3?_0x5d747d(_0xf0fbeb):_0x7e3b9c>0x3?_0x5d747d(_0x4fe370,_0x2c6680,_0xf0fbeb):_0x5d747d(_0x4fe370,_0x2c6680))||_0xf0fbeb;}return _0x7e3b9c>0x3&&_0xf0fbeb&&Object[_0x4aecb9(0x12f)](_0x4fe370,_0x2c6680,_0xf0fbeb),_0xf0fbeb;},__metadata=this&&this[a274_0x1ed83d(0x123)]||function(_0x447905,_0x188195){const _0x596233=a274_0x1ed83d;if(typeof Reflect===_0x596233(0x10e)&&typeof Reflect['metadata']===_0x596233(0x117))return Reflect[_0x596233(0x132)](_0x447905,_0x188195);};function a274_0x294d(){const _0x5a207b=['getBranchIdByName','apply','map','3616088xzrhZA','SalesforceQueryService','Version__c','1470903qPMlRf','getComponentRecordTypes','%branchId%','MAX_QUERY_ARRAY_ITEMS','FLOSUM_GIT_NAMESPACE','splice','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','replace','object','10adUXve','queryService','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY','Name','fetchBranchComponentsByFilenames','getOwnPropertyDescriptor','GET_BRANCH_COMPONENTS_QUERY','104849JNYkQx','function','70940nWzKBr','GET_COMPONENT_RECORD_TYPES_QUERY','Commit_Name__c','NotFoundError','typedi','fetchRepositoryComponentsByFilenames','14119290ezQrfE','801mgKOeu','getRepositoryIdByName','SalesforceGitSyncService','extractComponentMetadataFromRecord','__metadata','../../../../constants','__esModule','length','decorate','./salesforce-rest.service','join','query','Is_From_Agent__c','design:paramtypes','Component_Type__c','Service','defineProperty','__decorate','toString','metadata','%fileNames%','\x22\x20not\x20found\x20in\x20flosum.','restService','Component_Name__c','Status__c','1665171uFbiNK','%componentIds%','File_Name__c','54zcysdD','search','Repository__c','GET_BRANCH_BY_NAME_QUERY','createCommit','CRC32__c','./salesforce-query.service','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','extractFieldsFromRecord','push','(((.+)+)+)+$','FLOSUM_NAMESPACE','%name%','Repository\x20\x22','3716jhEXJT','GET_REPOSITORY_BY_NAME_QUERY','FLOSUM_COMMIT','../queries'];a274_0x294d=function(){return _0x5a207b;};return a274_0x294d();}Object[a274_0x1ed83d(0x12f)](exports,a274_0x1ed83d(0x125),{'value':!![]}),exports[a274_0x1ed83d(0x121)]=void 0x0;const not_found_error_1=require('../../../../core/errors/not-found.error'),typedi_1=require(a274_0x1ed83d(0x11c)),constants_1=require(a274_0x1ed83d(0x124)),queries_1=require(a274_0x1ed83d(0x14c)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_query_service_1=require(a274_0x1ed83d(0x141)),salesforce_rest_service_1=require(a274_0x1ed83d(0x128));let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x5791db,_0x588639){const _0x4ec64a=a274_0x1ed83d;this[_0x4ec64a(0x110)]=_0x5791db,this[_0x4ec64a(0x135)]=_0x588639,this[_0x4ec64a(0x156)]=0xc8;}['extractComponentMetadataFromRecord'](_0x2e3d30){const _0x22a6ae=a274_0x1ed83d,_0x2d8adf=(0x0,flosum_naming_utils_1[_0x22a6ae(0x143)])(_0x2e3d30,['Component_Name__c',_0x22a6ae(0x12d),'CRC32__c',_0x22a6ae(0x13a),_0x22a6ae(0x152),'Id']);return{'id':_0x2d8adf['Id'],'name':_0x2d8adf[_0x22a6ae(0x136)],'type':_0x2d8adf[_0x22a6ae(0x12d)],'fileName':_0x2d8adf[_0x22a6ae(0x13a)],'crc32':_0x2d8adf[_0x22a6ae(0x140)],'version':+_0x2d8adf[_0x22a6ae(0x152)]};}async[a274_0x1ed83d(0x120)](_0x26797a){const _0x593293=a274_0x1ed83d,[_0x5af339]=await this[_0x593293(0x110)][_0x593293(0x12a)](queries_1[_0x593293(0x14a)]['replace'](_0x593293(0x147),_0x26797a));if(!_0x5af339)throw new not_found_error_1['NotFoundError'](_0x593293(0x148)+_0x26797a+_0x593293(0x134));return _0x5af339['Id'];}async[a274_0x1ed83d(0x14d)](_0x28a7a7){const _0x5a6847=a274_0x1ed83d,[_0x5db85e]=await this['queryService'][_0x5a6847(0x12a)](queries_1[_0x5a6847(0x13e)]['replace'](_0x5a6847(0x147),_0x28a7a7));if(!_0x5db85e)throw new not_found_error_1[(_0x5a6847(0x11b))]('Branch\x20\x22'+_0x28a7a7+_0x5a6847(0x134));return _0x5db85e['Id'];}async[a274_0x1ed83d(0x154)](){const _0x4c6216=a274_0x1ed83d,_0xb60347=await this[_0x4c6216(0x110)]['query'](queries_1[_0x4c6216(0x119)]);return _0xb60347[_0x4c6216(0x14f)](_0x34bb24=>(0x0,flosum_naming_utils_1[_0x4c6216(0x143)])(_0x34bb24,['Id','Name']))[_0x4c6216(0x14f)](_0x29b1e4=>({'id':_0x29b1e4['Id'],'name':_0x29b1e4[_0x4c6216(0x112)]}));}async[a274_0x1ed83d(0x11d)](_0x5cec3f,_0x586e87){const _0x1a8220=a274_0x1ed83d,_0x1a0c00=[];while(_0x5cec3f['length']){const _0x17ccf3=queries_1[_0x1a8220(0x10c)][_0x1a8220(0x10d)](_0x1a8220(0x133),_0x5cec3f['splice'](0x0,this[_0x1a8220(0x156)])[_0x1a8220(0x14f)](_0x1e0b59=>'\x27'+_0x1e0b59+'\x27')[_0x1a8220(0x129)](','))[_0x1a8220(0x10d)]('%repositoryId%',_0x586e87),_0x44dfb2=await this[_0x1a8220(0x110)][_0x1a8220(0x12a)](_0x17ccf3);_0x1a0c00[_0x1a8220(0x144)](..._0x44dfb2);}return _0x1a0c00[_0x1a8220(0x14f)](_0x101231=>this['extractComponentMetadataFromRecord'](_0x101231));}async[a274_0x1ed83d(0x113)](_0x2403ee,_0x509138){const _0x35c8d6=a274_0x1ed83d,_0x9c27da=[];while(_0x2403ee[_0x35c8d6(0x126)]){const _0x313430=queries_1[_0x35c8d6(0x111)]['replace'](_0x35c8d6(0x133),_0x2403ee[_0x35c8d6(0x158)](0x0,this[_0x35c8d6(0x156)])['map'](_0x30b70f=>'\x27'+_0x30b70f+'\x27')['join'](','))['replace'](_0x35c8d6(0x155),_0x509138),_0x22916f=await this[_0x35c8d6(0x110)]['query'](_0x313430);_0x9c27da[_0x35c8d6(0x144)](..._0x22916f);}return _0x9c27da[_0x35c8d6(0x14f)](_0x3f7a0f=>this[_0x35c8d6(0x122)](_0x3f7a0f));}async['fetchRepositoryComponents'](_0x4862f9){const _0x147303=a274_0x1ed83d,_0x25cb74=queries_1['GET_REPOSITORY_COMPONENTS_QUERY']['replace']('%repositoryId%',_0x4862f9),_0x370a5a=await this[_0x147303(0x110)]['query'](_0x25cb74);return _0x370a5a[_0x147303(0x14f)](_0x11cae6=>this[_0x147303(0x122)](_0x11cae6));}async['fetchBranchComponents'](_0x111378){const _0x526818=a274_0x1ed83d,_0x51cc29=queries_1[_0x526818(0x115)]['replace']('%branchId%',_0x111378),_0x20260a=await this[_0x526818(0x110)][_0x526818(0x12a)](_0x51cc29);return _0x20260a['map'](_0x10c0db=>this['extractComponentMetadataFromRecord'](_0x10c0db));}async['fetchCommitManifestsByComponentIds'](_0x5522eb){const _0x2eb924=a274_0x1ed83d,_0x565ba8=[..._0x5522eb],_0x26f814=[];while(_0x565ba8[_0x2eb924(0x126)]){const _0x106b1b=queries_1[_0x2eb924(0x142)]['replace'](_0x2eb924(0x139),_0x565ba8['splice'](0x0,this[_0x2eb924(0x156)])['map'](_0x36d103=>'\x27'+_0x36d103+'\x27')[_0x2eb924(0x129)](',')),_0x3bde0b=await this['queryService'][_0x2eb924(0x12a)](_0x106b1b);_0x26f814[_0x2eb924(0x144)](..._0x3bde0b['map'](_0x57cf29=>_0x57cf29['Id']));}return _0x26f814;}async[a274_0x1ed83d(0x13f)](_0x400dc4,_0x37f3ea){const _0x24e1f5=a274_0x1ed83d;return this['restService']['post'](constants_1[_0x24e1f5(0x14b)],{[constants_1[_0x24e1f5(0x146)]+_0x24e1f5(0x13d)]:_0x37f3ea,[constants_1[_0x24e1f5(0x146)]+_0x24e1f5(0x11a)]:_0x400dc4['substr'](0x0,0xff),[constants_1[_0x24e1f5(0x146)]+_0x24e1f5(0x137)]:'Completed',[constants_1[_0x24e1f5(0x157)]+_0x24e1f5(0x12b)]:!![]});}};function a274_0x30a7(_0x58a683,_0x287d3f){const _0x215e7a=a274_0x294d();return a274_0x30a7=function(_0x4e3ae5,_0x3e9750){_0x4e3ae5=_0x4e3ae5-0x10c;let _0x294d30=_0x215e7a[_0x4e3ae5];return _0x294d30;},a274_0x30a7(_0x58a683,_0x287d3f);}SalesforceGitSyncService=__decorate([(0x0,typedi_1[a274_0x1ed83d(0x12e)])(),__metadata(a274_0x1ed83d(0x12c),[salesforce_query_service_1[a274_0x1ed83d(0x151)],salesforce_rest_service_1['SalesforceRestService']])],SalesforceGitSyncService),exports[a274_0x1ed83d(0x121)]=SalesforceGitSyncService;