const a273_0x5ec1db=a273_0x191e;(function(_0x12d619,_0x1a4286){const _0x202681=a273_0x191e,_0x1fff0f=_0x12d619();while(!![]){try{const _0x2d460e=parseInt(_0x202681(0xcb))/0x1+parseInt(_0x202681(0xdf))/0x2+-parseInt(_0x202681(0xb4))/0x3*(parseInt(_0x202681(0xe8))/0x4)+-parseInt(_0x202681(0xe6))/0x5*(-parseInt(_0x202681(0xab))/0x6)+-parseInt(_0x202681(0xb3))/0x7*(parseInt(_0x202681(0xb9))/0x8)+-parseInt(_0x202681(0xcd))/0x9*(parseInt(_0x202681(0xd8))/0xa)+parseInt(_0x202681(0xc7))/0xb*(parseInt(_0x202681(0xd5))/0xc);if(_0x2d460e===_0x1a4286)break;else _0x1fff0f['push'](_0x1fff0f['shift']());}catch(_0x118940){_0x1fff0f['push'](_0x1fff0f['shift']());}}}(a273_0x5953,0x33e90));const a273_0x17c73c=(function(){let _0x4dfaa4=!![];return function(_0x39b22d,_0x17678d){const _0x59942b=_0x4dfaa4?function(){const _0x40485d=a273_0x191e;if(_0x17678d){const _0x3c2a36=_0x17678d[_0x40485d(0xc2)](_0x39b22d,arguments);return _0x17678d=null,_0x3c2a36;}}:function(){};return _0x4dfaa4=![],_0x59942b;};}()),a273_0x5a0d0a=a273_0x17c73c(this,function(){const _0xd10edc=a273_0x191e;return a273_0x5a0d0a['toString']()[_0xd10edc(0xa8)](_0xd10edc(0xe7))[_0xd10edc(0xc3)]()[_0xd10edc(0xa7)](a273_0x5a0d0a)[_0xd10edc(0xa8)](_0xd10edc(0xe7));});function a273_0x5953(){const _0x5ae396=['Component_Name__c','fetchBranchComponents','Version__c','%branchId%','replace','15290xnVJsh','(((.+)+)+)+$','1267844UjgwQV','%repositoryId%','../../../../core/errors/not-found.error','Name','Repository\x20\x22','CRC32__c','function','%name%','substr','Service','object','./salesforce-query.service','decorate','SalesforceGitSyncService','Repository__c','NotFoundError','Completed','push','constructor','search','defineProperty','queryService','174XmrvuB','__metadata','getOwnPropertyDescriptor','createCommit','extractComponentMetadataFromRecord','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY','Branch\x20\x22','post','7XgkdBc','3UViTcC','fetchBranchComponentsByFilenames','fetchCommitManifestsByComponentIds','Component_Type__c','length','3321064hOjYgt','join','getRepositoryIdByName','getBranchIdByName','Status__c','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','restService','extractFieldsFromRecord','FLOSUM_NAMESPACE','apply','toString','%componentIds%','GET_BRANCH_COMPONENTS_QUERY','FLOSUM_GIT_NAMESPACE','6723959fTGdWe','query','SalesforceRestService','getComponentRecordTypes','141754zaRCza','GET_BRANCH_BY_NAME_QUERY','711jpMlgO','%fileNames%','MAX_QUERY_ARRAY_ITEMS','\x22\x20not\x20found\x20in\x20flosum.','Is_From_Agent__c','__esModule','../utils/flosum-naming.utils','fetchRepositoryComponentsByFilenames','12QzlBPl','map','metadata','10510NYhuKS','SalesforceQueryService','Commit_Name__c','design:paramtypes','GET_COMPONENT_RECORD_TYPES_QUERY','GET_REPOSITORY_COMPONENTS_QUERY','__decorate','372084ujqMBU','splice'];a273_0x5953=function(){return _0x5ae396;};return a273_0x5953();}a273_0x5a0d0a();'use strict';var __decorate=this&&this[a273_0x5ec1db(0xde)]||function(_0x297313,_0x3825d0,_0xa844b2,_0x5c3ee1){const _0x53b9ee=a273_0x5ec1db;var _0x3d5d8d=arguments['length'],_0x448540=_0x3d5d8d<0x3?_0x3825d0:_0x5c3ee1===null?_0x5c3ee1=Object[_0x53b9ee(0xad)](_0x3825d0,_0xa844b2):_0x5c3ee1,_0xd99396;if(typeof Reflect===_0x53b9ee(0x9f)&&typeof Reflect[_0x53b9ee(0xa1)]===_0x53b9ee(0x9b))_0x448540=Reflect[_0x53b9ee(0xa1)](_0x297313,_0x3825d0,_0xa844b2,_0x5c3ee1);else{for(var _0x705382=_0x297313[_0x53b9ee(0xb8)]-0x1;_0x705382>=0x0;_0x705382--)if(_0xd99396=_0x297313[_0x705382])_0x448540=(_0x3d5d8d<0x3?_0xd99396(_0x448540):_0x3d5d8d>0x3?_0xd99396(_0x3825d0,_0xa844b2,_0x448540):_0xd99396(_0x3825d0,_0xa844b2))||_0x448540;}return _0x3d5d8d>0x3&&_0x448540&&Object[_0x53b9ee(0xa9)](_0x3825d0,_0xa844b2,_0x448540),_0x448540;},__metadata=this&&this[a273_0x5ec1db(0xac)]||function(_0x458bc4,_0x562b37){const _0x112da8=a273_0x5ec1db;if(typeof Reflect==='object'&&typeof Reflect[_0x112da8(0xd7)]==='function')return Reflect['metadata'](_0x458bc4,_0x562b37);};Object[a273_0x5ec1db(0xa9)](exports,a273_0x5ec1db(0xd2),{'value':!![]}),exports[a273_0x5ec1db(0xa2)]=void 0x0;const not_found_error_1=require(a273_0x5ec1db(0x97)),typedi_1=require('typedi'),constants_1=require('../../../../constants'),queries_1=require('../queries'),flosum_naming_utils_1=require(a273_0x5ec1db(0xd3)),salesforce_query_service_1=require(a273_0x5ec1db(0xa0)),salesforce_rest_service_1=require('./salesforce-rest.service');function a273_0x191e(_0x5c5856,_0x31b34e){const _0x2c78b1=a273_0x5953();return a273_0x191e=function(_0x5a0d0a,_0x17c73c){_0x5a0d0a=_0x5a0d0a-0x97;let _0x5953c2=_0x2c78b1[_0x5a0d0a];return _0x5953c2;},a273_0x191e(_0x5c5856,_0x31b34e);}let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x596ad9,_0x1c6874){const _0x7a39af=a273_0x5ec1db;this[_0x7a39af(0xaa)]=_0x596ad9,this[_0x7a39af(0xbf)]=_0x1c6874,this['MAX_QUERY_ARRAY_ITEMS']=0xc8;}[a273_0x5ec1db(0xaf)](_0x1e88e3){const _0x130367=a273_0x5ec1db,_0x3f8abb=(0x0,flosum_naming_utils_1[_0x130367(0xc0)])(_0x1e88e3,[_0x130367(0xe1),_0x130367(0xb7),_0x130367(0x9a),'File_Name__c','Version__c','Id']);return{'id':_0x3f8abb['Id'],'name':_0x3f8abb[_0x130367(0xe1)],'type':_0x3f8abb['Component_Type__c'],'fileName':_0x3f8abb['File_Name__c'],'crc32':_0x3f8abb[_0x130367(0x9a)],'version':+_0x3f8abb[_0x130367(0xe3)]};}async[a273_0x5ec1db(0xbb)](_0x4aa744){const _0xc5b944=a273_0x5ec1db,[_0x4dee94]=await this['queryService']['query'](queries_1['GET_REPOSITORY_BY_NAME_QUERY'][_0xc5b944(0xe5)](_0xc5b944(0x9c),_0x4aa744));if(!_0x4dee94)throw new not_found_error_1[(_0xc5b944(0xa4))](_0xc5b944(0x99)+_0x4aa744+_0xc5b944(0xd0));return _0x4dee94['Id'];}async[a273_0x5ec1db(0xbc)](_0x2d0c51){const _0x1587b9=a273_0x5ec1db,[_0x392209]=await this['queryService'][_0x1587b9(0xc8)](queries_1[_0x1587b9(0xcc)][_0x1587b9(0xe5)](_0x1587b9(0x9c),_0x2d0c51));if(!_0x392209)throw new not_found_error_1[(_0x1587b9(0xa4))](_0x1587b9(0xb1)+_0x2d0c51+_0x1587b9(0xd0));return _0x392209['Id'];}async[a273_0x5ec1db(0xca)](){const _0x395343=a273_0x5ec1db,_0x5647c7=await this['queryService'][_0x395343(0xc8)](queries_1[_0x395343(0xdc)]);return _0x5647c7[_0x395343(0xd6)](_0x29ee7e=>(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x29ee7e,['Id',_0x395343(0x98)]))[_0x395343(0xd6)](_0x44e786=>({'id':_0x44e786['Id'],'name':_0x44e786[_0x395343(0x98)]}));}async[a273_0x5ec1db(0xd4)](_0xd77f5e,_0xd1e03c){const _0x4d2d04=a273_0x5ec1db,_0x407854=[];while(_0xd77f5e[_0x4d2d04(0xb8)]){const _0x41a9d1=queries_1[_0x4d2d04(0xbe)][_0x4d2d04(0xe5)](_0x4d2d04(0xce),_0xd77f5e[_0x4d2d04(0xe0)](0x0,this[_0x4d2d04(0xcf)])[_0x4d2d04(0xd6)](_0x4846e8=>'\x27'+_0x4846e8+'\x27')[_0x4d2d04(0xba)](','))[_0x4d2d04(0xe5)](_0x4d2d04(0xe9),_0xd1e03c),_0x53c583=await this[_0x4d2d04(0xaa)][_0x4d2d04(0xc8)](_0x41a9d1);_0x407854[_0x4d2d04(0xa6)](..._0x53c583);}return _0x407854[_0x4d2d04(0xd6)](_0x2c395d=>this['extractComponentMetadataFromRecord'](_0x2c395d));}async[a273_0x5ec1db(0xb5)](_0x17cc7e,_0x188fd0){const _0x1988f7=a273_0x5ec1db,_0xdf9256=[];while(_0x17cc7e[_0x1988f7(0xb8)]){const _0xfe89c6=queries_1[_0x1988f7(0xb0)][_0x1988f7(0xe5)](_0x1988f7(0xce),_0x17cc7e[_0x1988f7(0xe0)](0x0,this[_0x1988f7(0xcf)])[_0x1988f7(0xd6)](_0x856ec2=>'\x27'+_0x856ec2+'\x27')[_0x1988f7(0xba)](','))[_0x1988f7(0xe5)](_0x1988f7(0xe4),_0x188fd0),_0x27f630=await this['queryService'][_0x1988f7(0xc8)](_0xfe89c6);_0xdf9256[_0x1988f7(0xa6)](..._0x27f630);}return _0xdf9256['map'](_0x2ab068=>this[_0x1988f7(0xaf)](_0x2ab068));}async['fetchRepositoryComponents'](_0x31b3c5){const _0x42d5d7=a273_0x5ec1db,_0x1c5a03=queries_1[_0x42d5d7(0xdd)][_0x42d5d7(0xe5)](_0x42d5d7(0xe9),_0x31b3c5),_0x138e6c=await this[_0x42d5d7(0xaa)]['query'](_0x1c5a03);return _0x138e6c[_0x42d5d7(0xd6)](_0x9b283a=>this[_0x42d5d7(0xaf)](_0x9b283a));}async[a273_0x5ec1db(0xe2)](_0xa037a5){const _0x2adb34=a273_0x5ec1db,_0x100fe1=queries_1[_0x2adb34(0xc5)][_0x2adb34(0xe5)](_0x2adb34(0xe4),_0xa037a5),_0xa7964=await this['queryService'][_0x2adb34(0xc8)](_0x100fe1);return _0xa7964[_0x2adb34(0xd6)](_0x163d65=>this['extractComponentMetadataFromRecord'](_0x163d65));}async[a273_0x5ec1db(0xb6)](_0x1213cc){const _0x43f3c1=a273_0x5ec1db,_0x32768a=[..._0x1213cc],_0xa1637f=[];while(_0x32768a['length']){const _0x2b72cb=queries_1['GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS'][_0x43f3c1(0xe5)](_0x43f3c1(0xc4),_0x32768a[_0x43f3c1(0xe0)](0x0,this[_0x43f3c1(0xcf)])[_0x43f3c1(0xd6)](_0x4714be=>'\x27'+_0x4714be+'\x27')[_0x43f3c1(0xba)](',')),_0x26d458=await this[_0x43f3c1(0xaa)]['query'](_0x2b72cb);_0xa1637f[_0x43f3c1(0xa6)](..._0x26d458['map'](_0x461e9d=>_0x461e9d['Id']));}return _0xa1637f;}async[a273_0x5ec1db(0xae)](_0x3bbcbb,_0x1c0297){const _0x11704e=a273_0x5ec1db;return this[_0x11704e(0xbf)][_0x11704e(0xb2)](constants_1['FLOSUM_COMMIT'],{[constants_1[_0x11704e(0xc1)]+_0x11704e(0xa3)]:_0x1c0297,[constants_1[_0x11704e(0xc1)]+_0x11704e(0xda)]:_0x3bbcbb[_0x11704e(0x9d)](0x0,0xff),[constants_1[_0x11704e(0xc1)]+_0x11704e(0xbd)]:_0x11704e(0xa5),[constants_1[_0x11704e(0xc6)]+_0x11704e(0xd1)]:!![]});}};SalesforceGitSyncService=__decorate([(0x0,typedi_1[a273_0x5ec1db(0x9e)])(),__metadata(a273_0x5ec1db(0xdb),[salesforce_query_service_1[a273_0x5ec1db(0xd9)],salesforce_rest_service_1[a273_0x5ec1db(0xc9)]])],SalesforceGitSyncService),exports[a273_0x5ec1db(0xa2)]=SalesforceGitSyncService;