const a197_0x65aa53=a197_0x171e;(function(_0x19d0f6,_0x1fd686){const _0x506b1b=a197_0x171e,_0x1a6d5d=_0x19d0f6();while(!![]){try{const _0x4e1c2f=parseInt(_0x506b1b(0x223))/0x1+parseInt(_0x506b1b(0x222))/0x2*(-parseInt(_0x506b1b(0x1f9))/0x3)+-parseInt(_0x506b1b(0x1fd))/0x4+-parseInt(_0x506b1b(0x211))/0x5*(parseInt(_0x506b1b(0x235))/0x6)+parseInt(_0x506b1b(0x215))/0x7*(parseInt(_0x506b1b(0x224))/0x8)+parseInt(_0x506b1b(0x1f7))/0x9*(parseInt(_0x506b1b(0x221))/0xa)+parseInt(_0x506b1b(0x21b))/0xb*(-parseInt(_0x506b1b(0x204))/0xc);if(_0x4e1c2f===_0x1fd686)break;else _0x1a6d5d['push'](_0x1a6d5d['shift']());}catch(_0x225184){_0x1a6d5d['push'](_0x1a6d5d['shift']());}}}(a197_0x298b,0x972cb));const a197_0x5e7420=(function(){let _0x3fb526=!![];return function(_0x588119,_0x248cec){const _0x4e649=_0x3fb526?function(){const _0x30e944=a197_0x171e;if(_0x248cec){const _0x4a2b67=_0x248cec[_0x30e944(0x233)](_0x588119,arguments);return _0x248cec=null,_0x4a2b67;}}:function(){};return _0x3fb526=![],_0x4e649;};}()),a197_0x1bd6b0=a197_0x5e7420(this,function(){const _0xd73a24=a197_0x171e;return a197_0x1bd6b0[_0xd73a24(0x1fc)]()[_0xd73a24(0x217)](_0xd73a24(0x1f1))[_0xd73a24(0x1fc)]()[_0xd73a24(0x21a)](a197_0x1bd6b0)[_0xd73a24(0x217)]('(((.+)+)+)+$');});function a197_0x298b(){const _0x7cc885=['196328wwQmwM','%repositoryId%','\x22\x20not\x20found\x20in\x20flosum.','substr','../queries','map','createCommit','extractComponentMetadataFromRecord','queryService','splice','getBranchIdByName','SalesforceGitSyncService','getComponentRecordTypes','fetchCommitManifestsByComponentIds','join','apply','metadata','3340578zNvMHn','%fileNames%','replace','__decorate','Name','(((.+)+)+)+$','GET_BRANCH_COMPONENTS_QUERY','Version__c','FLOSUM_NAMESPACE','restService','Status__c','44280HUAKvs','push','28617ifHMsj','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','toString','583284bVNacx','File_Name__c','%name%','object','__esModule','MAX_QUERY_ARRAY_ITEMS','GET_BRANCH_BY_NAME_QUERY','24HYDjKx','query','defineProperty','NotFoundError','Service','Is_From_Agent__c','function','typedi','../utils/flosum-naming.utils','%componentIds%','GET_REPOSITORY_COMPONENTS_QUERY','getRepositoryIdByName','SalesforceRestService','5wvqKCP','Completed','%branchId%','Commit_Name__c','140TzhBXv','post','search','extractFieldsFromRecord','./salesforce-query.service','constructor','5690245qvhqTI','decorate','length','GET_REPOSITORY_BY_NAME_QUERY','FLOSUM_COMMIT','CRC32__c','1920srIooG','28ipKuPz','1054471vbnOwk'];a197_0x298b=function(){return _0x7cc885;};return a197_0x298b();}a197_0x1bd6b0();'use strict';var __decorate=this&&this[a197_0x65aa53(0x1ef)]||function(_0x263ffa,_0x26dc73,_0x221c73,_0x4b37db){const _0x143b12=a197_0x65aa53;var _0x36e213=arguments['length'],_0x3f2e5d=_0x36e213<0x3?_0x26dc73:_0x4b37db===null?_0x4b37db=Object['getOwnPropertyDescriptor'](_0x26dc73,_0x221c73):_0x4b37db,_0x4f5ec9;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x143b12(0x20a))_0x3f2e5d=Reflect[_0x143b12(0x21c)](_0x263ffa,_0x26dc73,_0x221c73,_0x4b37db);else{for(var _0x1c6913=_0x263ffa['length']-0x1;_0x1c6913>=0x0;_0x1c6913--)if(_0x4f5ec9=_0x263ffa[_0x1c6913])_0x3f2e5d=(_0x36e213<0x3?_0x4f5ec9(_0x3f2e5d):_0x36e213>0x3?_0x4f5ec9(_0x26dc73,_0x221c73,_0x3f2e5d):_0x4f5ec9(_0x26dc73,_0x221c73))||_0x3f2e5d;}return _0x36e213>0x3&&_0x3f2e5d&&Object[_0x143b12(0x206)](_0x26dc73,_0x221c73,_0x3f2e5d),_0x3f2e5d;},__metadata=this&&this['__metadata']||function(_0x3e7ecc,_0x2d299f){const _0x44278c=a197_0x65aa53;if(typeof Reflect===_0x44278c(0x200)&&typeof Reflect[_0x44278c(0x234)]==='function')return Reflect['metadata'](_0x3e7ecc,_0x2d299f);};Object[a197_0x65aa53(0x206)](exports,a197_0x65aa53(0x201),{'value':!![]}),exports['SalesforceGitSyncService']=void 0x0;const not_found_error_1=require('../../../../core/errors/not-found.error'),typedi_1=require(a197_0x65aa53(0x20b)),constants_1=require('../../../../constants'),queries_1=require(a197_0x65aa53(0x228)),flosum_naming_utils_1=require(a197_0x65aa53(0x20c)),salesforce_query_service_1=require(a197_0x65aa53(0x219)),salesforce_rest_service_1=require('./salesforce-rest.service');let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x216407,_0x3d5ba6){const _0x19db66=a197_0x65aa53;this[_0x19db66(0x22c)]=_0x216407,this['restService']=_0x3d5ba6,this[_0x19db66(0x202)]=0xc8;}[a197_0x65aa53(0x22b)](_0x5951be){const _0x180306=a197_0x65aa53,_0x126fc3=(0x0,flosum_naming_utils_1[_0x180306(0x218)])(_0x5951be,['Component_Name__c','Component_Type__c',_0x180306(0x220),_0x180306(0x1fe),_0x180306(0x1f3),'Id']);return{'id':_0x126fc3['Id'],'name':_0x126fc3['Component_Name__c'],'type':_0x126fc3['Component_Type__c'],'fileName':_0x126fc3[_0x180306(0x1fe)],'crc32':_0x126fc3[_0x180306(0x220)],'version':+_0x126fc3[_0x180306(0x1f3)]};}async[a197_0x65aa53(0x20f)](_0x4f11c6){const _0x131ad1=a197_0x65aa53,[_0x2b5b21]=await this[_0x131ad1(0x22c)][_0x131ad1(0x205)](queries_1[_0x131ad1(0x21e)]['replace'](_0x131ad1(0x1ff),_0x4f11c6));if(!_0x2b5b21)throw new not_found_error_1[(_0x131ad1(0x207))]('Repository\x20\x22'+_0x4f11c6+'\x22\x20not\x20found\x20in\x20flosum.');return _0x2b5b21['Id'];}async[a197_0x65aa53(0x22e)](_0x5769f3){const _0x3221d9=a197_0x65aa53,[_0x360b3c]=await this['queryService'][_0x3221d9(0x205)](queries_1[_0x3221d9(0x203)][_0x3221d9(0x1ee)](_0x3221d9(0x1ff),_0x5769f3));if(!_0x360b3c)throw new not_found_error_1[(_0x3221d9(0x207))]('Branch\x20\x22'+_0x5769f3+_0x3221d9(0x226));return _0x360b3c['Id'];}async[a197_0x65aa53(0x230)](){const _0x1196fd=a197_0x65aa53,_0x17dc09=await this['queryService'][_0x1196fd(0x205)](queries_1['GET_COMPONENT_RECORD_TYPES_QUERY']);return _0x17dc09['map'](_0x526f13=>(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x526f13,['Id',_0x1196fd(0x1f0)]))[_0x1196fd(0x229)](_0x555dd6=>({'id':_0x555dd6['Id'],'name':_0x555dd6[_0x1196fd(0x1f0)]}));}async['fetchRepositoryComponentsByFilenames'](_0x46bbf9,_0x27e55e){const _0x5144fc=a197_0x65aa53,_0x310458=[];while(_0x46bbf9[_0x5144fc(0x21d)]){const _0x4b3116=queries_1[_0x5144fc(0x1fb)]['replace'](_0x5144fc(0x1ed),_0x46bbf9['splice'](0x0,this[_0x5144fc(0x202)])[_0x5144fc(0x229)](_0x1e5d5a=>'\x27'+_0x1e5d5a+'\x27')[_0x5144fc(0x232)](','))[_0x5144fc(0x1ee)]('%repositoryId%',_0x27e55e),_0x3c1d18=await this['queryService'][_0x5144fc(0x205)](_0x4b3116);_0x310458[_0x5144fc(0x1f8)](..._0x3c1d18);}return _0x310458[_0x5144fc(0x229)](_0x17d105=>this[_0x5144fc(0x22b)](_0x17d105));}async['fetchBranchComponentsByFilenames'](_0x37e36b,_0x19b09f){const _0x5d3a63=a197_0x65aa53,_0x27a1fd=[];while(_0x37e36b[_0x5d3a63(0x21d)]){const _0x25b4cc=queries_1[_0x5d3a63(0x1fa)]['replace'](_0x5d3a63(0x1ed),_0x37e36b[_0x5d3a63(0x22d)](0x0,this[_0x5d3a63(0x202)])[_0x5d3a63(0x229)](_0x3efe7f=>'\x27'+_0x3efe7f+'\x27')[_0x5d3a63(0x232)](','))[_0x5d3a63(0x1ee)](_0x5d3a63(0x213),_0x19b09f),_0x1719dc=await this[_0x5d3a63(0x22c)][_0x5d3a63(0x205)](_0x25b4cc);_0x27a1fd[_0x5d3a63(0x1f8)](..._0x1719dc);}return _0x27a1fd[_0x5d3a63(0x229)](_0x3211bb=>this[_0x5d3a63(0x22b)](_0x3211bb));}async['fetchRepositoryComponents'](_0x1239f8){const _0x1f22d7=a197_0x65aa53,_0x323f49=queries_1[_0x1f22d7(0x20e)][_0x1f22d7(0x1ee)](_0x1f22d7(0x225),_0x1239f8),_0x2d44a8=await this['queryService'][_0x1f22d7(0x205)](_0x323f49);return _0x2d44a8[_0x1f22d7(0x229)](_0xd2fd79=>this[_0x1f22d7(0x22b)](_0xd2fd79));}async['fetchBranchComponents'](_0x41fede){const _0x3efe98=a197_0x65aa53,_0x5e3454=queries_1[_0x3efe98(0x1f2)]['replace']('%branchId%',_0x41fede),_0x38bf1f=await this[_0x3efe98(0x22c)][_0x3efe98(0x205)](_0x5e3454);return _0x38bf1f[_0x3efe98(0x229)](_0x32d40d=>this[_0x3efe98(0x22b)](_0x32d40d));}async[a197_0x65aa53(0x231)](_0x324506){const _0x16062f=a197_0x65aa53,_0x3e6a39=[..._0x324506],_0x567bc7=[];while(_0x3e6a39[_0x16062f(0x21d)]){const _0x212ce6=queries_1['GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS']['replace'](_0x16062f(0x20d),_0x3e6a39[_0x16062f(0x22d)](0x0,this[_0x16062f(0x202)])[_0x16062f(0x229)](_0x5e6902=>'\x27'+_0x5e6902+'\x27')[_0x16062f(0x232)](',')),_0x31ef63=await this[_0x16062f(0x22c)][_0x16062f(0x205)](_0x212ce6);_0x567bc7['push'](..._0x31ef63['map'](_0x7d0c31=>_0x7d0c31['Id']));}return _0x567bc7;}async[a197_0x65aa53(0x22a)](_0x4238ec,_0xfb03be){const _0x22a740=a197_0x65aa53;return this[_0x22a740(0x1f5)][_0x22a740(0x216)](constants_1[_0x22a740(0x21f)],{[constants_1['FLOSUM_NAMESPACE']+'Repository__c']:_0xfb03be,[constants_1[_0x22a740(0x1f4)]+_0x22a740(0x214)]:_0x4238ec[_0x22a740(0x227)](0x0,0xff),[constants_1[_0x22a740(0x1f4)]+_0x22a740(0x1f6)]:_0x22a740(0x212),[constants_1['FLOSUM_GIT_NAMESPACE']+_0x22a740(0x209)]:!![]});}};function a197_0x171e(_0x51e468,_0x19e043){const _0x1b2bb3=a197_0x298b();return a197_0x171e=function(_0x1bd6b0,_0x5e7420){_0x1bd6b0=_0x1bd6b0-0x1ed;let _0x298bac=_0x1b2bb3[_0x1bd6b0];return _0x298bac;},a197_0x171e(_0x51e468,_0x19e043);}SalesforceGitSyncService=__decorate([(0x0,typedi_1[a197_0x65aa53(0x208)])(),__metadata('design:paramtypes',[salesforce_query_service_1['SalesforceQueryService'],salesforce_rest_service_1[a197_0x65aa53(0x210)]])],SalesforceGitSyncService),exports[a197_0x65aa53(0x22f)]=SalesforceGitSyncService;