const a273_0x2b37c8=a273_0xd165;function a273_0xd165(_0x1e0f2c,_0x4f67f8){const _0x17f1ba=a273_0x51e3();return a273_0xd165=function(_0x54b2a6,_0x2b2cb3){_0x54b2a6=_0x54b2a6-0xca;let _0x51e363=_0x17f1ba[_0x54b2a6];return _0x51e363;},a273_0xd165(_0x1e0f2c,_0x4f67f8);}(function(_0x1e1d20,_0xbe1512){const _0x4ff467=a273_0xd165,_0x2a0296=_0x1e1d20();while(!![]){try{const _0x22c9f0=parseInt(_0x4ff467(0xe3))/0x1*(parseInt(_0x4ff467(0xf8))/0x2)+parseInt(_0x4ff467(0xe9))/0x3+-parseInt(_0x4ff467(0x112))/0x4*(-parseInt(_0x4ff467(0xfb))/0x5)+-parseInt(_0x4ff467(0xeb))/0x6+-parseInt(_0x4ff467(0xdc))/0x7+-parseInt(_0x4ff467(0xd1))/0x8+parseInt(_0x4ff467(0x109))/0x9;if(_0x22c9f0===_0xbe1512)break;else _0x2a0296['push'](_0x2a0296['shift']());}catch(_0x38001f){_0x2a0296['push'](_0x2a0296['shift']());}}}(a273_0x51e3,0x41d81));const a273_0x2b2cb3=(function(){let _0x540ca8=!![];return function(_0xdd09ef,_0xed4d09){const _0x20153a=_0x540ca8?function(){const _0x4d42b5=a273_0xd165;if(_0xed4d09){const _0x2144f8=_0xed4d09[_0x4d42b5(0xe2)](_0xdd09ef,arguments);return _0xed4d09=null,_0x2144f8;}}:function(){};return _0x540ca8=![],_0x20153a;};}()),a273_0x54b2a6=a273_0x2b2cb3(this,function(){const _0x5d4a1b=a273_0xd165;return a273_0x54b2a6[_0x5d4a1b(0xde)]()[_0x5d4a1b(0xe1)]('(((.+)+)+)+$')[_0x5d4a1b(0xde)]()[_0x5d4a1b(0xd7)](a273_0x54b2a6)[_0x5d4a1b(0xe1)](_0x5d4a1b(0xda));});a273_0x54b2a6();'use strict';var __decorate=this&&this[a273_0x2b37c8(0xe8)]||function(_0x1db14d,_0x3c17b9,_0x5ece5f,_0x32e5e6){const _0x130e05=a273_0x2b37c8;var _0x2d974e=arguments['length'],_0x3e03e7=_0x2d974e<0x3?_0x3c17b9:_0x32e5e6===null?_0x32e5e6=Object[_0x130e05(0x100)](_0x3c17b9,_0x5ece5f):_0x32e5e6,_0x44bb47;if(typeof Reflect===_0x130e05(0xd9)&&typeof Reflect[_0x130e05(0xca)]===_0x130e05(0xf3))_0x3e03e7=Reflect[_0x130e05(0xca)](_0x1db14d,_0x3c17b9,_0x5ece5f,_0x32e5e6);else{for(var _0x50868a=_0x1db14d[_0x130e05(0xfc)]-0x1;_0x50868a>=0x0;_0x50868a--)if(_0x44bb47=_0x1db14d[_0x50868a])_0x3e03e7=(_0x2d974e<0x3?_0x44bb47(_0x3e03e7):_0x2d974e>0x3?_0x44bb47(_0x3c17b9,_0x5ece5f,_0x3e03e7):_0x44bb47(_0x3c17b9,_0x5ece5f))||_0x3e03e7;}return _0x2d974e>0x3&&_0x3e03e7&&Object[_0x130e05(0x104)](_0x3c17b9,_0x5ece5f,_0x3e03e7),_0x3e03e7;},__metadata=this&&this[a273_0x2b37c8(0x105)]||function(_0xf44ad1,_0x26e77c){const _0x99aecf=a273_0x2b37c8;if(typeof Reflect===_0x99aecf(0xd9)&&typeof Reflect['metadata']==='function')return Reflect[_0x99aecf(0xea)](_0xf44ad1,_0x26e77c);};Object[a273_0x2b37c8(0x104)](exports,a273_0x2b37c8(0xf7),{'value':!![]}),exports[a273_0x2b37c8(0xcd)]=void 0x0;const not_found_error_1=require('../../../../core/errors/not-found.error'),typedi_1=require(a273_0x2b37c8(0xee)),constants_1=require('../../../../constants'),queries_1=require(a273_0x2b37c8(0xd3)),flosum_naming_utils_1=require(a273_0x2b37c8(0xf6)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_rest_service_1=require('./salesforce-rest.service');let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x21ccae,_0x173276){const _0x35e97e=a273_0x2b37c8;this[_0x35e97e(0xdf)]=_0x21ccae,this[_0x35e97e(0xdd)]=_0x173276,this[_0x35e97e(0x10a)]=0xc8;}[a273_0x2b37c8(0xef)](_0x4d4560){const _0x2eabee=a273_0x2b37c8,_0x2fe727=(0x0,flosum_naming_utils_1[_0x2eabee(0xd0)])(_0x4d4560,[_0x2eabee(0x10d),_0x2eabee(0x101),_0x2eabee(0xcc),_0x2eabee(0xe7),_0x2eabee(0x110),'Id']);return{'id':_0x2fe727['Id'],'name':_0x2fe727[_0x2eabee(0x10d)],'type':_0x2fe727['Component_Type__c'],'fileName':_0x2fe727['File_Name__c'],'crc32':_0x2fe727[_0x2eabee(0xcc)],'version':+_0x2fe727[_0x2eabee(0x110)]};}async['getRepositoryIdByName'](_0x158c41){const _0x220f56=a273_0x2b37c8,[_0x122a1d]=await this[_0x220f56(0xdf)]['query'](queries_1[_0x220f56(0xd6)][_0x220f56(0xf1)]('%name%',_0x158c41));if(!_0x122a1d)throw new not_found_error_1[(_0x220f56(0x10c))]('Repository\x20\x22'+_0x158c41+'\x22\x20not\x20found\x20in\x20flosum.');return _0x122a1d['Id'];}async[a273_0x2b37c8(0x107)](_0x6eec42){const _0x1df58d=a273_0x2b37c8,[_0x1fe4b0]=await this[_0x1df58d(0xdf)]['query'](queries_1['GET_BRANCH_BY_NAME_QUERY'][_0x1df58d(0xf1)]('%name%',_0x6eec42));if(!_0x1fe4b0)throw new not_found_error_1[(_0x1df58d(0x10c))]('Branch\x20\x22'+_0x6eec42+_0x1df58d(0xed));return _0x1fe4b0['Id'];}async[a273_0x2b37c8(0xec)](){const _0x54a9a6=a273_0x2b37c8,_0x44ddd3=await this[_0x54a9a6(0xdf)][_0x54a9a6(0xfe)](queries_1['GET_COMPONENT_RECORD_TYPES_QUERY']);return _0x44ddd3[_0x54a9a6(0xf0)](_0x80cb15=>(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x80cb15,['Id',_0x54a9a6(0xdb)]))[_0x54a9a6(0xf0)](_0x6ad541=>({'id':_0x6ad541['Id'],'name':_0x6ad541['Name']}));}async[a273_0x2b37c8(0x10b)](_0x34f663,_0x5e865a){const _0x42b7f2=a273_0x2b37c8,_0x62b30e=[];while(_0x34f663[_0x42b7f2(0xfc)]){const _0x57ca7f=queries_1[_0x42b7f2(0x10e)]['replace']('%fileNames%',_0x34f663['splice'](0x0,this[_0x42b7f2(0x10a)])[_0x42b7f2(0xf0)](_0x833805=>'\x27'+_0x833805+'\x27')[_0x42b7f2(0xce)](','))['replace']('%repositoryId%',_0x5e865a),_0x59d6ef=await this[_0x42b7f2(0xdf)][_0x42b7f2(0xfe)](_0x57ca7f);_0x62b30e['push'](..._0x59d6ef);}return _0x62b30e['map'](_0x4d380e=>this['extractComponentMetadataFromRecord'](_0x4d380e));}async[a273_0x2b37c8(0xf2)](_0x1521ab,_0x3606f0){const _0x528c05=a273_0x2b37c8,_0x4f5d28=[];while(_0x1521ab[_0x528c05(0xfc)]){const _0x438ef6=queries_1[_0x528c05(0xe0)][_0x528c05(0xf1)](_0x528c05(0xd8),_0x1521ab['splice'](0x0,this[_0x528c05(0x10a)])[_0x528c05(0xf0)](_0x5ee45e=>'\x27'+_0x5ee45e+'\x27')[_0x528c05(0xce)](','))[_0x528c05(0xf1)](_0x528c05(0x102),_0x3606f0),_0x34c5cd=await this['queryService'][_0x528c05(0xfe)](_0x438ef6);_0x4f5d28['push'](..._0x34c5cd);}return _0x4f5d28[_0x528c05(0xf0)](_0x1dfd0b=>this[_0x528c05(0xef)](_0x1dfd0b));}async['fetchRepositoryComponents'](_0x29ac88){const _0x48d7c5=a273_0x2b37c8,_0x25fcd8=queries_1[_0x48d7c5(0xd5)][_0x48d7c5(0xf1)](_0x48d7c5(0xe4),_0x29ac88),_0x26f073=await this[_0x48d7c5(0xdf)][_0x48d7c5(0xfe)](_0x25fcd8);return _0x26f073['map'](_0x3a05bb=>this[_0x48d7c5(0xef)](_0x3a05bb));}async[a273_0x2b37c8(0xcb)](_0x4ac1d9){const _0x2752dd=a273_0x2b37c8,_0x25f062=queries_1[_0x2752dd(0xe6)][_0x2752dd(0xf1)]('%branchId%',_0x4ac1d9),_0x55c5d9=await this[_0x2752dd(0xdf)][_0x2752dd(0xfe)](_0x25f062);return _0x55c5d9[_0x2752dd(0xf0)](_0x5738cb=>this[_0x2752dd(0xef)](_0x5738cb));}async[a273_0x2b37c8(0xf4)](_0x46b8b3){const _0x50c581=a273_0x2b37c8,_0x3058c8=[..._0x46b8b3],_0x3da18b=[];while(_0x3058c8['length']){const _0x298406=queries_1[_0x50c581(0xcf)][_0x50c581(0xf1)](_0x50c581(0xfd),_0x3058c8[_0x50c581(0x111)](0x0,this[_0x50c581(0x10a)])[_0x50c581(0xf0)](_0x493913=>'\x27'+_0x493913+'\x27')['join'](',')),_0x1aa0e3=await this[_0x50c581(0xdf)]['query'](_0x298406);_0x3da18b[_0x50c581(0xf5)](..._0x1aa0e3[_0x50c581(0xf0)](_0x38d358=>_0x38d358['Id']));}return _0x3da18b;}async[a273_0x2b37c8(0x108)](_0x50dde7,_0x2b2bd4){const _0x5a0fc0=a273_0x2b37c8;return this[_0x5a0fc0(0xdd)][_0x5a0fc0(0x103)](constants_1['FLOSUM_COMMIT'],{[constants_1[_0x5a0fc0(0x106)]+'Repository__c']:_0x2b2bd4,[constants_1[_0x5a0fc0(0x106)]+_0x5a0fc0(0xfa)]:_0x50dde7[_0x5a0fc0(0xe5)](0x0,0xff),[constants_1[_0x5a0fc0(0x106)]+'Status__c']:_0x5a0fc0(0xf9),[constants_1[_0x5a0fc0(0xd2)]+'Is_From_Agent__c']:!![]});}};function a273_0x51e3(){const _0x4db385=['search','apply','36878oIKiAJ','%repositoryId%','substr','GET_BRANCH_COMPONENTS_QUERY','File_Name__c','__decorate','15777PIwdrS','metadata','2775012LgIFIz','getComponentRecordTypes','\x22\x20not\x20found\x20in\x20flosum.','typedi','extractComponentMetadataFromRecord','map','replace','fetchBranchComponentsByFilenames','function','fetchCommitManifestsByComponentIds','push','../utils/flosum-naming.utils','__esModule','2fEqSOr','Completed','Commit_Name__c','1634090TrollY','length','%componentIds%','query','SalesforceQueryService','getOwnPropertyDescriptor','Component_Type__c','%branchId%','post','defineProperty','__metadata','FLOSUM_NAMESPACE','getBranchIdByName','createCommit','10060128RyRCpW','MAX_QUERY_ARRAY_ITEMS','fetchRepositoryComponentsByFilenames','NotFoundError','Component_Name__c','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','design:paramtypes','Version__c','splice','4bxjMSS','decorate','fetchBranchComponents','CRC32__c','SalesforceGitSyncService','join','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','extractFieldsFromRecord','2473096sRwrFN','FLOSUM_GIT_NAMESPACE','../queries','Service','GET_REPOSITORY_COMPONENTS_QUERY','GET_REPOSITORY_BY_NAME_QUERY','constructor','%fileNames%','object','(((.+)+)+)+$','Name','3117877xLwrUR','restService','toString','queryService','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY'];a273_0x51e3=function(){return _0x4db385;};return a273_0x51e3();}SalesforceGitSyncService=__decorate([(0x0,typedi_1[a273_0x2b37c8(0xd4)])(),__metadata(a273_0x2b37c8(0x10f),[salesforce_query_service_1[a273_0x2b37c8(0xff)],salesforce_rest_service_1['SalesforceRestService']])],SalesforceGitSyncService),exports['SalesforceGitSyncService']=SalesforceGitSyncService;