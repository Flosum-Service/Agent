const a273_0x561417=a273_0x1ff6;function a273_0x1ff6(_0x1bfdc3,_0x3e517c){const _0x131793=a273_0x116a();return a273_0x1ff6=function(_0xdbfaf7,_0x11d537){_0xdbfaf7=_0xdbfaf7-0x185;let _0x116aca=_0x131793[_0xdbfaf7];return _0x116aca;},a273_0x1ff6(_0x1bfdc3,_0x3e517c);}(function(_0x4cf685,_0xf9178e){const _0x3130e1=a273_0x1ff6,_0x3940b7=_0x4cf685();while(!![]){try{const _0x2e8404=parseInt(_0x3130e1(0x191))/0x1*(-parseInt(_0x3130e1(0x1a5))/0x2)+-parseInt(_0x3130e1(0x1c9))/0x3+parseInt(_0x3130e1(0x19e))/0x4+parseInt(_0x3130e1(0x1a9))/0x5*(-parseInt(_0x3130e1(0x197))/0x6)+parseInt(_0x3130e1(0x1c0))/0x7*(parseInt(_0x3130e1(0x1ab))/0x8)+parseInt(_0x3130e1(0x186))/0x9*(-parseInt(_0x3130e1(0x195))/0xa)+parseInt(_0x3130e1(0x1a6))/0xb;if(_0x2e8404===_0xf9178e)break;else _0x3940b7['push'](_0x3940b7['shift']());}catch(_0x1444ac){_0x3940b7['push'](_0x3940b7['shift']());}}}(a273_0x116a,0x2806b));const a273_0x11d537=(function(){let _0xc52bcc=!![];return function(_0x3ceb5a,_0x3ebb08){const _0x1d367c=_0xc52bcc?function(){const _0x4af274=a273_0x1ff6;if(_0x3ebb08){const _0xfc25f9=_0x3ebb08[_0x4af274(0x1b9)](_0x3ceb5a,arguments);return _0x3ebb08=null,_0xfc25f9;}}:function(){};return _0xc52bcc=![],_0x1d367c;};}()),a273_0xdbfaf7=a273_0x11d537(this,function(){const _0x2736a1=a273_0x1ff6;return a273_0xdbfaf7[_0x2736a1(0x19f)]()['search'](_0x2736a1(0x196))['toString']()[_0x2736a1(0x1bb)](a273_0xdbfaf7)[_0x2736a1(0x1be)](_0x2736a1(0x196));});a273_0xdbfaf7();'use strict';var __decorate=this&&this['__decorate']||function(_0x3de3b6,_0x198b61,_0x1954e5,_0x44b6e7){const _0x25d7be=a273_0x1ff6;var _0x2218cd=arguments[_0x25d7be(0x18c)],_0x2772d9=_0x2218cd<0x3?_0x198b61:_0x44b6e7===null?_0x44b6e7=Object[_0x25d7be(0x1c7)](_0x198b61,_0x1954e5):_0x44b6e7,_0x11e95a;if(typeof Reflect==='object'&&typeof Reflect[_0x25d7be(0x1b8)]===_0x25d7be(0x187))_0x2772d9=Reflect['decorate'](_0x3de3b6,_0x198b61,_0x1954e5,_0x44b6e7);else{for(var _0x4d2a29=_0x3de3b6[_0x25d7be(0x18c)]-0x1;_0x4d2a29>=0x0;_0x4d2a29--)if(_0x11e95a=_0x3de3b6[_0x4d2a29])_0x2772d9=(_0x2218cd<0x3?_0x11e95a(_0x2772d9):_0x2218cd>0x3?_0x11e95a(_0x198b61,_0x1954e5,_0x2772d9):_0x11e95a(_0x198b61,_0x1954e5))||_0x2772d9;}return _0x2218cd>0x3&&_0x2772d9&&Object[_0x25d7be(0x1ae)](_0x198b61,_0x1954e5,_0x2772d9),_0x2772d9;},__metadata=this&&this[a273_0x561417(0x1b3)]||function(_0x5a2b98,_0x6bbcfa){const _0x1ee951=a273_0x561417;if(typeof Reflect===_0x1ee951(0x18d)&&typeof Reflect[_0x1ee951(0x1cb)]===_0x1ee951(0x187))return Reflect['metadata'](_0x5a2b98,_0x6bbcfa);};function a273_0x116a(){const _0x40931d=['getRepositoryIdByName','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY','5TFWIuO','FLOSUM_GIT_NAMESPACE','8adTtVI','%fileNames%','GET_COMPONENT_RECORD_TYPES_QUERY','defineProperty','FLOSUM_NAMESPACE','../../../../core/errors/not-found.error','GET_BRANCH_BY_NAME_QUERY','GET_REPOSITORY_BY_NAME_QUERY','__metadata','query','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','Repository\x20\x22','Commit_Name__c','decorate','apply','SalesforceQueryService','constructor','design:paramtypes','join','search','__esModule','746102RGaHtx','%name%','Repository__c','SalesforceRestService','Completed','%componentIds%','Component_Name__c','getOwnPropertyDescriptor','%branchId%','940641dQMhjI','push','metadata','../utils/flosum-naming.utils','9ylvFDc','function','replace','map','splice','MAX_QUERY_ARRAY_ITEMS','length','object','Branch\x20\x22','GET_BRANCH_COMPONENTS_QUERY','restService','1aqICed','Status__c','substr','getBranchIdByName','666320EmfARp','(((.+)+)+)+$','1453110pSkQnG','Service','fetchRepositoryComponents','extractFieldsFromRecord','SalesforceGitSyncService','%repositoryId%','../queries','1079056ncDHeo','toString','extractComponentMetadataFromRecord','fetchBranchComponentsByFilenames','File_Name__c','Name','queryService','309624bpNtAS','6212503IXOBIw'];a273_0x116a=function(){return _0x40931d;};return a273_0x116a();}Object[a273_0x561417(0x1ae)](exports,a273_0x561417(0x1bf),{'value':!![]}),exports[a273_0x561417(0x19b)]=void 0x0;const not_found_error_1=require(a273_0x561417(0x1b0)),typedi_1=require('typedi'),constants_1=require('../../../../constants'),queries_1=require(a273_0x561417(0x19d)),flosum_naming_utils_1=require(a273_0x561417(0x185)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_rest_service_1=require('./salesforce-rest.service');let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x1cd063,_0x3aca04){const _0x56a724=a273_0x561417;this[_0x56a724(0x1a4)]=_0x1cd063,this[_0x56a724(0x190)]=_0x3aca04,this[_0x56a724(0x18b)]=0xc8;}[a273_0x561417(0x1a0)](_0x5d24a7){const _0x1cecda=a273_0x561417,_0x5cebb6=(0x0,flosum_naming_utils_1['extractFieldsFromRecord'])(_0x5d24a7,[_0x1cecda(0x1c6),'Component_Type__c','CRC32__c',_0x1cecda(0x1a2),'Version__c','Id']);return{'id':_0x5cebb6['Id'],'name':_0x5cebb6['Component_Name__c'],'type':_0x5cebb6['Component_Type__c'],'fileName':_0x5cebb6[_0x1cecda(0x1a2)],'crc32':_0x5cebb6['CRC32__c'],'version':+_0x5cebb6['Version__c']};}async[a273_0x561417(0x1a7)](_0x41f078){const _0x243dd6=a273_0x561417,[_0x1e6711]=await this[_0x243dd6(0x1a4)]['query'](queries_1[_0x243dd6(0x1b2)]['replace']('%name%',_0x41f078));if(!_0x1e6711)throw new not_found_error_1['NotFoundError'](_0x243dd6(0x1b6)+_0x41f078+'\x22\x20not\x20found\x20in\x20flosum.');return _0x1e6711['Id'];}async[a273_0x561417(0x194)](_0x1774bc){const _0x5b766b=a273_0x561417,[_0xb2db7e]=await this[_0x5b766b(0x1a4)][_0x5b766b(0x1b4)](queries_1[_0x5b766b(0x1b1)][_0x5b766b(0x188)](_0x5b766b(0x1c1),_0x1774bc));if(!_0xb2db7e)throw new not_found_error_1['NotFoundError'](_0x5b766b(0x18e)+_0x1774bc+'\x22\x20not\x20found\x20in\x20flosum.');return _0xb2db7e['Id'];}async['getComponentRecordTypes'](){const _0x44d8b7=a273_0x561417,_0x2eae31=await this[_0x44d8b7(0x1a4)][_0x44d8b7(0x1b4)](queries_1[_0x44d8b7(0x1ad)]);return _0x2eae31[_0x44d8b7(0x189)](_0x109363=>(0x0,flosum_naming_utils_1[_0x44d8b7(0x19a)])(_0x109363,['Id','Name']))['map'](_0x172826=>({'id':_0x172826['Id'],'name':_0x172826[_0x44d8b7(0x1a3)]}));}async['fetchRepositoryComponentsByFilenames'](_0x5dad6e,_0x1e393c){const _0x3b64f7=a273_0x561417,_0x11806e=[];while(_0x5dad6e[_0x3b64f7(0x18c)]){const _0x44ea08=queries_1[_0x3b64f7(0x1b5)]['replace'](_0x3b64f7(0x1ac),_0x5dad6e['splice'](0x0,this[_0x3b64f7(0x18b)])['map'](_0x3362a5=>'\x27'+_0x3362a5+'\x27')['join'](','))['replace'](_0x3b64f7(0x19c),_0x1e393c),_0x5c08f8=await this[_0x3b64f7(0x1a4)]['query'](_0x44ea08);_0x11806e[_0x3b64f7(0x1ca)](..._0x5c08f8);}return _0x11806e['map'](_0x4e2342=>this[_0x3b64f7(0x1a0)](_0x4e2342));}async[a273_0x561417(0x1a1)](_0x37c0b4,_0xf5542f){const _0x34f435=a273_0x561417,_0x569fc2=[];while(_0x37c0b4[_0x34f435(0x18c)]){const _0x4181a0=queries_1[_0x34f435(0x1a8)][_0x34f435(0x188)](_0x34f435(0x1ac),_0x37c0b4[_0x34f435(0x18a)](0x0,this[_0x34f435(0x18b)])[_0x34f435(0x189)](_0x124522=>'\x27'+_0x124522+'\x27')[_0x34f435(0x1bd)](','))[_0x34f435(0x188)](_0x34f435(0x1c8),_0xf5542f),_0x576f8b=await this[_0x34f435(0x1a4)]['query'](_0x4181a0);_0x569fc2[_0x34f435(0x1ca)](..._0x576f8b);}return _0x569fc2[_0x34f435(0x189)](_0x1ebbe3=>this[_0x34f435(0x1a0)](_0x1ebbe3));}async[a273_0x561417(0x199)](_0x372df0){const _0xc7cc=a273_0x561417,_0x54eb92=queries_1['GET_REPOSITORY_COMPONENTS_QUERY'][_0xc7cc(0x188)](_0xc7cc(0x19c),_0x372df0),_0x4f57d6=await this['queryService'][_0xc7cc(0x1b4)](_0x54eb92);return _0x4f57d6['map'](_0x6c1b36=>this['extractComponentMetadataFromRecord'](_0x6c1b36));}async['fetchBranchComponents'](_0x4a9268){const _0x2dae84=a273_0x561417,_0xfc45=queries_1[_0x2dae84(0x18f)][_0x2dae84(0x188)](_0x2dae84(0x1c8),_0x4a9268),_0x277676=await this[_0x2dae84(0x1a4)]['query'](_0xfc45);return _0x277676[_0x2dae84(0x189)](_0x5a4d67=>this['extractComponentMetadataFromRecord'](_0x5a4d67));}async['fetchCommitManifestsByComponentIds'](_0x204b42){const _0xd7f401=a273_0x561417,_0x38aee5=[..._0x204b42],_0x43330c=[];while(_0x38aee5['length']){const _0x10c197=queries_1['GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS'][_0xd7f401(0x188)](_0xd7f401(0x1c5),_0x38aee5[_0xd7f401(0x18a)](0x0,this[_0xd7f401(0x18b)])[_0xd7f401(0x189)](_0xfafc39=>'\x27'+_0xfafc39+'\x27')[_0xd7f401(0x1bd)](',')),_0x4b76b8=await this['queryService'][_0xd7f401(0x1b4)](_0x10c197);_0x43330c[_0xd7f401(0x1ca)](..._0x4b76b8['map'](_0x537ce6=>_0x537ce6['Id']));}return _0x43330c;}async['createCommit'](_0x1cfe3c,_0x47f9f3){const _0x58ef48=a273_0x561417;return this[_0x58ef48(0x190)]['post'](constants_1['FLOSUM_COMMIT'],{[constants_1[_0x58ef48(0x1af)]+_0x58ef48(0x1c2)]:_0x47f9f3,[constants_1[_0x58ef48(0x1af)]+_0x58ef48(0x1b7)]:_0x1cfe3c[_0x58ef48(0x193)](0x0,0xff),[constants_1[_0x58ef48(0x1af)]+_0x58ef48(0x192)]:_0x58ef48(0x1c4),[constants_1[_0x58ef48(0x1aa)]+'Is_From_Agent__c']:!![]});}};SalesforceGitSyncService=__decorate([(0x0,typedi_1[a273_0x561417(0x198)])(),__metadata(a273_0x561417(0x1bc),[salesforce_query_service_1[a273_0x561417(0x1ba)],salesforce_rest_service_1[a273_0x561417(0x1c3)]])],SalesforceGitSyncService),exports[a273_0x561417(0x19b)]=SalesforceGitSyncService;