const a231_0x5d05ae=a231_0x47ea;function a231_0x29c3(){const _0x465ef8=['Branch\x20\x22','getComponentRecordTypes','FLOSUM_GIT_NAMESPACE','Completed','design:paramtypes','Status__c','constructor','GET_REPOSITORY_COMPONENTS_QUERY','apply','File_Name__c','MAX_QUERY_ARRAY_ITEMS','createCommit','Version__c','FLOSUM_NAMESPACE','Service','GET_REPOSITORY_BY_NAME_QUERY','./salesforce-query.service','queryService','4652eEMWfW','search','restService','SalesforceRestService','SalesforceQueryService','1197720yYFUKd','Component_Name__c','query','%fileNames%','(((.+)+)+)+$','__decorate','66528kgxtFG','../queries','28WCUOFA','\x22\x20not\x20found\x20in\x20flosum.','splice','join','typedi','Name','function','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','NotFoundError','1193704KQcBbr','object','176QIMJmo','fetchBranchComponents','../../../../core/errors/not-found.error','%name%','length','post','Is_From_Agent__c','FLOSUM_COMMIT','GET_COMPONENT_RECORD_TYPES_QUERY','../../../../constants','473275nnIDHZ','CRC32__c','Repository\x20\x22','1359480YnrwRL','../utils/flosum-naming.utils','fetchCommitManifestsByComponentIds','replace','extractComponentMetadataFromRecord','GET_BRANCH_COMPONENTS_QUERY','push','3195dUcoVx','%branchId%','Commit_Name__c','metadata','1217376zXjbhS','981EkZfWR','substr','%repositoryId%','./salesforce-rest.service','fetchRepositoryComponentsByFilenames','__esModule','decorate','extractFieldsFromRecord','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','Repository__c','SalesforceGitSyncService','__metadata','map','defineProperty'];a231_0x29c3=function(){return _0x465ef8;};return a231_0x29c3();}(function(_0x4aa133,_0x48f976){const _0x1c42a7=a231_0x47ea,_0x2a0eb7=_0x4aa133();while(!![]){try{const _0x1477b1=-parseInt(_0x1c42a7(0x1b3))/0x1+parseInt(_0x1c42a7(0x1a7))/0x2+-parseInt(_0x1c42a7(0x1bd))/0x3*(parseInt(_0x1c42a7(0x1e2))/0x4)+-parseInt(_0x1c42a7(0x1b6))/0x5+parseInt(_0x1c42a7(0x1c1))/0x6*(-parseInt(_0x1c42a7(0x19e))/0x7)+-parseInt(_0x1c42a7(0x19c))/0x8*(-parseInt(_0x1c42a7(0x1c2))/0x9)+-parseInt(_0x1c42a7(0x196))/0xa*(-parseInt(_0x1c42a7(0x1a9))/0xb);if(_0x1477b1===_0x48f976)break;else _0x2a0eb7['push'](_0x2a0eb7['shift']());}catch(_0x5cf013){_0x2a0eb7['push'](_0x2a0eb7['shift']());}}}(a231_0x29c3,0x986aa));const a231_0x14ac9a=(function(){let _0x1420a3=!![];return function(_0x12c8f4,_0x50f8e7){const _0x51ed29=_0x1420a3?function(){const _0x27833a=a231_0x47ea;if(_0x50f8e7){const _0x3b809b=_0x50f8e7[_0x27833a(0x1d8)](_0x12c8f4,arguments);return _0x50f8e7=null,_0x3b809b;}}:function(){};return _0x1420a3=![],_0x51ed29;};}()),a231_0x3b6c73=a231_0x14ac9a(this,function(){const _0x532663=a231_0x47ea;return a231_0x3b6c73['toString']()[_0x532663(0x192)](_0x532663(0x19a))['toString']()[_0x532663(0x1d6)](a231_0x3b6c73)[_0x532663(0x192)](_0x532663(0x19a));});function a231_0x47ea(_0x215129,_0x2f7f02){const _0x76da7d=a231_0x29c3();return a231_0x47ea=function(_0x3b6c73,_0x14ac9a){_0x3b6c73=_0x3b6c73-0x192;let _0x29c3ad=_0x76da7d[_0x3b6c73];return _0x29c3ad;},a231_0x47ea(_0x215129,_0x2f7f02);}a231_0x3b6c73();'use strict';var __decorate=this&&this[a231_0x5d05ae(0x19b)]||function(_0x5c9f3d,_0x1fa174,_0x5d6f8c,_0x2e8c67){const _0x1b2a85=a231_0x5d05ae;var _0xc4f779=arguments[_0x1b2a85(0x1ad)],_0x5b391d=_0xc4f779<0x3?_0x1fa174:_0x2e8c67===null?_0x2e8c67=Object['getOwnPropertyDescriptor'](_0x1fa174,_0x5d6f8c):_0x2e8c67,_0x5d9ae9;if(typeof Reflect===_0x1b2a85(0x1a8)&&typeof Reflect[_0x1b2a85(0x1c8)]===_0x1b2a85(0x1a4))_0x5b391d=Reflect['decorate'](_0x5c9f3d,_0x1fa174,_0x5d6f8c,_0x2e8c67);else{for(var _0x32a2f7=_0x5c9f3d['length']-0x1;_0x32a2f7>=0x0;_0x32a2f7--)if(_0x5d9ae9=_0x5c9f3d[_0x32a2f7])_0x5b391d=(_0xc4f779<0x3?_0x5d9ae9(_0x5b391d):_0xc4f779>0x3?_0x5d9ae9(_0x1fa174,_0x5d6f8c,_0x5b391d):_0x5d9ae9(_0x1fa174,_0x5d6f8c))||_0x5b391d;}return _0xc4f779>0x3&&_0x5b391d&&Object[_0x1b2a85(0x1cf)](_0x1fa174,_0x5d6f8c,_0x5b391d),_0x5b391d;},__metadata=this&&this[a231_0x5d05ae(0x1cd)]||function(_0x5164b3,_0x3ff5bc){const _0x302f12=a231_0x5d05ae;if(typeof Reflect===_0x302f12(0x1a8)&&typeof Reflect[_0x302f12(0x1c0)]===_0x302f12(0x1a4))return Reflect['metadata'](_0x5164b3,_0x3ff5bc);};Object[a231_0x5d05ae(0x1cf)](exports,a231_0x5d05ae(0x1c7),{'value':!![]}),exports[a231_0x5d05ae(0x1cc)]=void 0x0;const not_found_error_1=require(a231_0x5d05ae(0x1ab)),typedi_1=require(a231_0x5d05ae(0x1a2)),constants_1=require(a231_0x5d05ae(0x1b2)),queries_1=require(a231_0x5d05ae(0x19d)),flosum_naming_utils_1=require(a231_0x5d05ae(0x1b7)),salesforce_query_service_1=require(a231_0x5d05ae(0x1e0)),salesforce_rest_service_1=require(a231_0x5d05ae(0x1c5));let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x128e7b,_0x1ecd53){const _0x5042d8=a231_0x5d05ae;this[_0x5042d8(0x1e1)]=_0x128e7b,this[_0x5042d8(0x193)]=_0x1ecd53,this['MAX_QUERY_ARRAY_ITEMS']=0xc8;}['extractComponentMetadataFromRecord'](_0x47cef1){const _0x320f43=a231_0x5d05ae,_0xa8ce84=(0x0,flosum_naming_utils_1[_0x320f43(0x1c9)])(_0x47cef1,[_0x320f43(0x197),'Component_Type__c','CRC32__c',_0x320f43(0x1d9),_0x320f43(0x1dc),'Id']);return{'id':_0xa8ce84['Id'],'name':_0xa8ce84[_0x320f43(0x197)],'type':_0xa8ce84['Component_Type__c'],'fileName':_0xa8ce84['File_Name__c'],'crc32':_0xa8ce84[_0x320f43(0x1b4)],'version':+_0xa8ce84[_0x320f43(0x1dc)]};}async['getRepositoryIdByName'](_0x5417f7){const _0x156366=a231_0x5d05ae,[_0x58182c]=await this['queryService']['query'](queries_1[_0x156366(0x1df)][_0x156366(0x1b9)](_0x156366(0x1ac),_0x5417f7));if(!_0x58182c)throw new not_found_error_1['NotFoundError'](_0x156366(0x1b5)+_0x5417f7+_0x156366(0x19f));return _0x58182c['Id'];}async['getBranchIdByName'](_0x21c3df){const _0x224f92=a231_0x5d05ae,[_0x53af5c]=await this[_0x224f92(0x1e1)]['query'](queries_1['GET_BRANCH_BY_NAME_QUERY']['replace'](_0x224f92(0x1ac),_0x21c3df));if(!_0x53af5c)throw new not_found_error_1[(_0x224f92(0x1a6))](_0x224f92(0x1d0)+_0x21c3df+'\x22\x20not\x20found\x20in\x20flosum.');return _0x53af5c['Id'];}async[a231_0x5d05ae(0x1d1)](){const _0x5db56c=a231_0x5d05ae,_0xf69de4=await this[_0x5db56c(0x1e1)][_0x5db56c(0x198)](queries_1[_0x5db56c(0x1b1)]);return _0xf69de4[_0x5db56c(0x1ce)](_0x4c1c43=>(0x0,flosum_naming_utils_1[_0x5db56c(0x1c9)])(_0x4c1c43,['Id',_0x5db56c(0x1a3)]))[_0x5db56c(0x1ce)](_0x4783b5=>({'id':_0x4783b5['Id'],'name':_0x4783b5['Name']}));}async[a231_0x5d05ae(0x1c6)](_0x43d7ce,_0x206bb9){const _0x3825a0=a231_0x5d05ae,_0x55f57a=[];while(_0x43d7ce[_0x3825a0(0x1ad)]){const _0x593bf2=queries_1[_0x3825a0(0x1a5)][_0x3825a0(0x1b9)](_0x3825a0(0x199),_0x43d7ce[_0x3825a0(0x1a0)](0x0,this[_0x3825a0(0x1da)])[_0x3825a0(0x1ce)](_0x29cbfb=>'\x27'+_0x29cbfb+'\x27')['join'](','))[_0x3825a0(0x1b9)](_0x3825a0(0x1c4),_0x206bb9),_0x2da9ec=await this[_0x3825a0(0x1e1)][_0x3825a0(0x198)](_0x593bf2);_0x55f57a['push'](..._0x2da9ec);}return _0x55f57a[_0x3825a0(0x1ce)](_0x234123=>this['extractComponentMetadataFromRecord'](_0x234123));}async['fetchBranchComponentsByFilenames'](_0x1d8f07,_0x3e997f){const _0x559e7f=a231_0x5d05ae,_0x4432fb=[];while(_0x1d8f07['length']){const _0x501eb2=queries_1['GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY'][_0x559e7f(0x1b9)](_0x559e7f(0x199),_0x1d8f07[_0x559e7f(0x1a0)](0x0,this[_0x559e7f(0x1da)])[_0x559e7f(0x1ce)](_0x154b78=>'\x27'+_0x154b78+'\x27')[_0x559e7f(0x1a1)](','))[_0x559e7f(0x1b9)](_0x559e7f(0x1be),_0x3e997f),_0x388c6e=await this['queryService'][_0x559e7f(0x198)](_0x501eb2);_0x4432fb[_0x559e7f(0x1bc)](..._0x388c6e);}return _0x4432fb['map'](_0x3863ac=>this[_0x559e7f(0x1ba)](_0x3863ac));}async['fetchRepositoryComponents'](_0x46fb0c){const _0x45ece5=a231_0x5d05ae,_0x182970=queries_1[_0x45ece5(0x1d7)][_0x45ece5(0x1b9)]('%repositoryId%',_0x46fb0c),_0x201e63=await this[_0x45ece5(0x1e1)][_0x45ece5(0x198)](_0x182970);return _0x201e63[_0x45ece5(0x1ce)](_0x20c350=>this['extractComponentMetadataFromRecord'](_0x20c350));}async[a231_0x5d05ae(0x1aa)](_0xcc9d6f){const _0x2feb23=a231_0x5d05ae,_0x56d2e2=queries_1[_0x2feb23(0x1bb)][_0x2feb23(0x1b9)]('%branchId%',_0xcc9d6f),_0x3b77ca=await this[_0x2feb23(0x1e1)][_0x2feb23(0x198)](_0x56d2e2);return _0x3b77ca[_0x2feb23(0x1ce)](_0x1921f6=>this[_0x2feb23(0x1ba)](_0x1921f6));}async[a231_0x5d05ae(0x1b8)](_0x3bf0e5){const _0x4f59b0=a231_0x5d05ae,_0x1d4c02=[..._0x3bf0e5],_0x28793d=[];while(_0x1d4c02[_0x4f59b0(0x1ad)]){const _0x419abc=queries_1[_0x4f59b0(0x1ca)]['replace']('%componentIds%',_0x1d4c02[_0x4f59b0(0x1a0)](0x0,this[_0x4f59b0(0x1da)])[_0x4f59b0(0x1ce)](_0x12bae9=>'\x27'+_0x12bae9+'\x27')[_0x4f59b0(0x1a1)](',')),_0x32cdc9=await this[_0x4f59b0(0x1e1)]['query'](_0x419abc);_0x28793d['push'](..._0x32cdc9[_0x4f59b0(0x1ce)](_0x3de00f=>_0x3de00f['Id']));}return _0x28793d;}async[a231_0x5d05ae(0x1db)](_0x84539d,_0x16b898){const _0x327984=a231_0x5d05ae;return this[_0x327984(0x193)][_0x327984(0x1ae)](constants_1[_0x327984(0x1b0)],{[constants_1['FLOSUM_NAMESPACE']+_0x327984(0x1cb)]:_0x16b898,[constants_1[_0x327984(0x1dd)]+_0x327984(0x1bf)]:_0x84539d[_0x327984(0x1c3)](0x0,0xff),[constants_1['FLOSUM_NAMESPACE']+_0x327984(0x1d5)]:_0x327984(0x1d3),[constants_1[_0x327984(0x1d2)]+_0x327984(0x1af)]:!![]});}};SalesforceGitSyncService=__decorate([(0x0,typedi_1[a231_0x5d05ae(0x1de)])(),__metadata(a231_0x5d05ae(0x1d4),[salesforce_query_service_1[a231_0x5d05ae(0x195)],salesforce_rest_service_1[a231_0x5d05ae(0x194)]])],SalesforceGitSyncService),exports['SalesforceGitSyncService']=SalesforceGitSyncService;