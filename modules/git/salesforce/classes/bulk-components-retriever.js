const a257_0x2760b0=a257_0x166f;(function(_0x2faebf,_0x52d0e7){const _0x4cd062=a257_0x166f,_0x4046b7=_0x2faebf();while(!![]){try{const _0x49b6ea=-parseInt(_0x4cd062(0x1b4))/0x1+-parseInt(_0x4cd062(0x1a5))/0x2+-parseInt(_0x4cd062(0x1bb))/0x3+-parseInt(_0x4cd062(0x18e))/0x4*(-parseInt(_0x4cd062(0x1b3))/0x5)+parseInt(_0x4cd062(0x1ab))/0x6*(-parseInt(_0x4cd062(0x187))/0x7)+parseInt(_0x4cd062(0x18a))/0x8+parseInt(_0x4cd062(0x195))/0x9*(parseInt(_0x4cd062(0x1a4))/0xa);if(_0x49b6ea===_0x52d0e7)break;else _0x4046b7['push'](_0x4046b7['shift']());}catch(_0x260eb){_0x4046b7['push'](_0x4046b7['shift']());}}}(a257_0x213c,0x3a6a0));const a257_0x52f221=(function(){let _0x3e8303=!![];return function(_0x5106dc,_0x5d547c){const _0xb1b821=_0x3e8303?function(){const _0x4905a6=a257_0x166f;if(_0x5d547c){const _0x3851e2=_0x5d547c[_0x4905a6(0x1a7)](_0x5106dc,arguments);return _0x5d547c=null,_0x3851e2;}}:function(){};return _0x3e8303=![],_0xb1b821;};}()),a257_0xa355b=a257_0x52f221(this,function(){const _0x2ba44b=a257_0x166f;return a257_0xa355b[_0x2ba44b(0x18c)]()[_0x2ba44b(0x1ba)](_0x2ba44b(0x190))['toString']()[_0x2ba44b(0x185)](a257_0xa355b)[_0x2ba44b(0x1ba)](_0x2ba44b(0x190));});function a257_0x166f(_0x59ba61,_0x85b7c0){const _0x1c0b56=a257_0x213c();return a257_0x166f=function(_0xa355b,_0x52f221){_0xa355b=_0xa355b-0x185;let _0x213c49=_0x1c0b56[_0xa355b];return _0x213c49;},a257_0x166f(_0x59ba61,_0x85b7c0);}a257_0xa355b();'use strict';Object[a257_0x2760b0(0x1b8)](exports,a257_0x2760b0(0x198),{'value':!![]}),exports['BulkComponentsRetriever']=void 0x0;function a257_0x213c(){const _0x60f643=['API','toString','retrieveComponents','657284uYByQq','splice','(((.+)+)+)+$','Component_Name__c','Bulk1RetrieveData','BulkComponentsRetriever','Bulk1JobOperation','10244133YbMzZd','ids','ParentId','__esModule','Name','../../../../core','select','where','request','retrieve','body','APPLICATION_XML','execute','Attachment','Query','10URrYmM','686028xpYIXO','BulkXmlStreamParser','apply','values','ParentId\x20IN\x20(:ids)','length','148848fkKOuc','set','Component__r','Version__c','@flosum/salesforce','QueryBuilder','retrieveAttachments','Body','5iHgGAq','404771HBotDU','pipe','SalesforceConstants','logger','defineProperty','Component_History__c','search','430233sufjIE','components','constructor','name','119FPjTiP','FLOSUM_NAMESPACE','from','1997104ZHRGmU'];a257_0x213c=function(){return _0x60f643;};return a257_0x213c();}const salesforce_1=require(a257_0x2760b0(0x1af)),core_1=require(a257_0x2760b0(0x19a)),constants_1=require('../../../../constants'),BINARY_FIELDS=[a257_0x2760b0(0x1b2)],MAX_IDS_CHUNK_LENGTH=0xfa0;class BulkComponentsRetriever{constructor({request:_0x5dd35e,ids:_0x2ac9a9}){const _0x22aee5=a257_0x2760b0;this[_0x22aee5(0x1bc)]=new Map(),this['request']=_0x5dd35e,this['ids']=_0x2ac9a9,this[_0x22aee5(0x1b7)]=new core_1['Logger'](BulkComponentsRetriever[_0x22aee5(0x186)]);}async[a257_0x2760b0(0x18d)](_0x15969e){const _0x5a390f=a257_0x2760b0,_0x127e4c=new salesforce_1[(_0x5a390f(0x1b0))]()[_0x5a390f(0x19b)]('Id',constants_1[_0x5a390f(0x188)]+'Component__r.'+constants_1[_0x5a390f(0x188)]+_0x5a390f(0x191),constants_1[_0x5a390f(0x188)]+_0x5a390f(0x1ae))[_0x5a390f(0x189)](constants_1['FLOSUM_NAMESPACE']+_0x5a390f(0x1b9))[_0x5a390f(0x19c)]('Id\x20IN\x20(:ids)',{'ids':_0x15969e}),_0x50afc2=new salesforce_1['CompositeRetrieveData']({'api':salesforce_1[_0x5a390f(0x1b6)]['API'],'queryBuilder':_0x127e4c,'instance':this['request'],'isTooling':![]});do{const {records:_0x4b9bfe}=await _0x50afc2['execute']();for(const _0x32cabe of _0x4b9bfe){this['components'][_0x5a390f(0x1ac)](_0x32cabe['Id'],{'fileName':_0x32cabe[constants_1[_0x5a390f(0x188)]+_0x5a390f(0x1ad)][constants_1[_0x5a390f(0x188)]+'Component_Name__c'],'fileType':'','body':'','version':_0x32cabe[constants_1['FLOSUM_NAMESPACE']+_0x5a390f(0x1ae)]});}}while(!_0x50afc2['getIsDone']());}async[a257_0x2760b0(0x1b1)](_0x300307){const _0x1dfffa=a257_0x2760b0,_0x233284=new salesforce_1['QueryBuilder']()[_0x1dfffa(0x19b)](_0x1dfffa(0x1b2),_0x1dfffa(0x199),_0x1dfffa(0x197))[_0x1dfffa(0x189)](_0x1dfffa(0x1a2))[_0x1dfffa(0x19c)](_0x1dfffa(0x1a9),{'ids':_0x300307}),_0x4069e9=new salesforce_1[(_0x1dfffa(0x192))]({'instance':this[_0x1dfffa(0x19d)],'api':salesforce_1[_0x1dfffa(0x1b6)][_0x1dfffa(0x18b)],'pollInterval':0x1388,'queryBuilder':_0x233284,'objectName':_0x1dfffa(0x1a2),'contentType':salesforce_1['BulkV1QueryContentType'][_0x1dfffa(0x1a0)],'jobOperation':salesforce_1[_0x1dfffa(0x194)][_0x1dfffa(0x1a3)]});do{const _0x58bedf=await _0x4069e9[_0x1dfffa(0x1a1)]();if(!_0x58bedf)break;const _0x18cc94=new salesforce_1[(_0x1dfffa(0x1a6))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x59268c,ParentId:_0xde10cb,Body:_0x6d57bf}of _0x58bedf[_0x1dfffa(0x1b5)](_0x18cc94)){const _0x280e84=this['components']['get'](_0xde10cb);if(!_0x280e84){this[_0x1dfffa(0x1b7)]['error']('Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.',_0xde10cb,_0x59268c);continue;}_0x280e84[_0x1dfffa(0x19f)]=_0x6d57bf,_0x280e84['fileType']=_0x59268c;}}while(!_0x4069e9['getIsDone']());}async[a257_0x2760b0(0x19e)](){const _0x5e8524=a257_0x2760b0;do{const _0x546088=this[_0x5e8524(0x196)][_0x5e8524(0x18f)](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x5e8524(0x18d)](_0x546088),await this[_0x5e8524(0x1b1)](_0x546088);}while(this[_0x5e8524(0x196)][_0x5e8524(0x1aa)]);return[...this[_0x5e8524(0x1bc)][_0x5e8524(0x1a8)]()];}}exports[a257_0x2760b0(0x193)]=BulkComponentsRetriever;