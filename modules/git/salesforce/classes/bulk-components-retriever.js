const a258_0x2bbb82=a258_0x4c7c;(function(_0x3e23f6,_0x4c4c31){const _0x2ab60d=a258_0x4c7c,_0x4df859=_0x3e23f6();while(!![]){try{const _0x32957a=parseInt(_0x2ab60d(0x1a8))/0x1*(parseInt(_0x2ab60d(0x19f))/0x2)+-parseInt(_0x2ab60d(0x195))/0x3+-parseInt(_0x2ab60d(0x1c1))/0x4*(-parseInt(_0x2ab60d(0x1b5))/0x5)+-parseInt(_0x2ab60d(0x1a3))/0x6*(parseInt(_0x2ab60d(0x1a4))/0x7)+-parseInt(_0x2ab60d(0x1b6))/0x8+parseInt(_0x2ab60d(0x1af))/0x9+parseInt(_0x2ab60d(0x19d))/0xa;if(_0x32957a===_0x4c4c31)break;else _0x4df859['push'](_0x4df859['shift']());}catch(_0x521441){_0x4df859['push'](_0x4df859['shift']());}}}(a258_0x41cf,0x3c55e));const a258_0x23a7b5=(function(){let _0x4c0b40=!![];return function(_0x9018a1,_0x290313){const _0xc22769=_0x4c0b40?function(){const _0x29e796=a258_0x4c7c;if(_0x290313){const _0x11da16=_0x290313[_0x29e796(0x1ba)](_0x9018a1,arguments);return _0x290313=null,_0x11da16;}}:function(){};return _0x4c0b40=![],_0xc22769;};}()),a258_0x1a5fb5=a258_0x23a7b5(this,function(){const _0x590bc8=a258_0x4c7c;return a258_0x1a5fb5['toString']()[_0x590bc8(0x1c2)](_0x590bc8(0x193))['toString']()[_0x590bc8(0x1b2)](a258_0x1a5fb5)['search'](_0x590bc8(0x193));});function a258_0x4c7c(_0x2f2573,_0x331125){const _0x327939=a258_0x41cf();return a258_0x4c7c=function(_0x1a5fb5,_0x23a7b5){_0x1a5fb5=_0x1a5fb5-0x190;let _0x41cf1d=_0x327939[_0x1a5fb5];return _0x41cf1d;},a258_0x4c7c(_0x2f2573,_0x331125);}a258_0x1a5fb5();'use strict';Object[a258_0x2bbb82(0x1cb)](exports,a258_0x2bbb82(0x1ae),{'value':!![]}),exports[a258_0x2bbb82(0x1a2)]=void 0x0;const salesforce_1=require(a258_0x2bbb82(0x197)),core_1=require(a258_0x2bbb82(0x1ac)),constants_1=require('../../../../constants'),promises_1=require(a258_0x2bbb82(0x1c7)),fs_internal_1=require(a258_0x2bbb82(0x1ad)),path_1=require('../../../../configs/path'),BINARY_FIELDS=['Body'],MAX_IDS_CHUNK_LENGTH=0xfa0;class BulkComponentsRetriever{constructor({request:_0x580f9c,ids:_0x317753}){const _0x482a6e=a258_0x2bbb82;this[_0x482a6e(0x1ca)]=new Map(),this[_0x482a6e(0x194)]=_0x580f9c,this[_0x482a6e(0x1bf)]=_0x317753,this[_0x482a6e(0x1b0)]=new core_1['Logger'](BulkComponentsRetriever[_0x482a6e(0x1bb)]);}async[a258_0x2bbb82(0x1a1)](_0x141bf6){const _0x57d5ae=a258_0x2bbb82,_0x48b675=new salesforce_1[(_0x57d5ae(0x199))]()[_0x57d5ae(0x1c9)]('Id',constants_1[_0x57d5ae(0x19b)]+'Component__r.'+constants_1[_0x57d5ae(0x19b)]+_0x57d5ae(0x1c3),constants_1[_0x57d5ae(0x19b)]+'Version__c')[_0x57d5ae(0x1b8)](constants_1[_0x57d5ae(0x19b)]+_0x57d5ae(0x1a7))[_0x57d5ae(0x1bc)]('Id\x20IN\x20(:ids)',{'ids':_0x141bf6}),_0x540add=new salesforce_1[(_0x57d5ae(0x1be))]({'api':salesforce_1[_0x57d5ae(0x190)][_0x57d5ae(0x1b7)],'queryBuilder':_0x48b675,'instance':this[_0x57d5ae(0x194)],'isTooling':![]});do{const {records:_0xa88424}=await _0x540add['execute']();for(const _0x15b335 of _0xa88424){this[_0x57d5ae(0x1ca)][_0x57d5ae(0x1ab)](_0x15b335['Id'],{'fileName':_0x15b335[constants_1['FLOSUM_NAMESPACE']+'Component__r'][constants_1[_0x57d5ae(0x19b)]+'Component_Name__c'],'fileType':'','body':'','version':_0x15b335[constants_1[_0x57d5ae(0x19b)]+'Version__c']});}}while(!_0x540add[_0x57d5ae(0x1c4)]());}async[a258_0x2bbb82(0x19e)](_0x540542){const _0x274256=a258_0x2bbb82,_0x4fdbe5=new salesforce_1[(_0x274256(0x199))]()[_0x274256(0x1c9)]('Body',_0x274256(0x1c6),_0x274256(0x196))[_0x274256(0x1b8)](_0x274256(0x1bd))[_0x274256(0x1bc)](_0x274256(0x1b1),{'ids':_0x540542});!await fs_internal_1['FS']['exists'](path_1[_0x274256(0x1b3)])&&await(0x0,promises_1[_0x274256(0x19c)])(path_1[_0x274256(0x1b3)],{'recursive':!![]});const _0xd862f9=new salesforce_1[(_0x274256(0x191))]({'instance':this['request'],'api':salesforce_1[_0x274256(0x190)][_0x274256(0x1b7)],'pollInterval':0x1388,'queryBuilder':_0x4fdbe5,'objectName':'Attachment','contentType':salesforce_1[_0x274256(0x1a0)][_0x274256(0x198)],'jobOperation':salesforce_1[_0x274256(0x1b4)][_0x274256(0x192)],'tmpPath':path_1[_0x274256(0x1b3)]});do{const _0xbf263f=await _0xd862f9[_0x274256(0x1a6)]();if(!_0xbf263f)break;const _0x526885=new salesforce_1[(_0x274256(0x1aa))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x90182a,ParentId:_0x1c8324,Body:_0x46b4df}of _0xbf263f[_0x274256(0x1c5)](_0x526885)){const _0x1e86d4=this[_0x274256(0x1ca)][_0x274256(0x1b9)](_0x1c8324);if(!_0x1e86d4){this[_0x274256(0x1b0)][_0x274256(0x1c0)]('Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.',_0x1c8324,_0x90182a);continue;}_0x1e86d4['body']=_0x46b4df,_0x1e86d4[_0x274256(0x19a)]=_0x90182a;}}while(!_0xd862f9[_0x274256(0x1c4)]());}async['retrieve'](){const _0x2b11e8=a258_0x2bbb82;do{const _0x5013c4=this['ids'][_0x2b11e8(0x1a5)](0x0,MAX_IDS_CHUNK_LENGTH);await this['retrieveComponents'](_0x5013c4),await this['retrieveAttachments'](_0x5013c4);}while(this['ids'][_0x2b11e8(0x1a9)]);return[...this[_0x2b11e8(0x1ca)][_0x2b11e8(0x1c8)]()];}}function a258_0x41cf(){const _0x3093d9=['2huxTsP','BulkV1QueryContentType','retrieveComponents','BulkComponentsRetriever','6wOpAeO','1485673rJiaiS','splice','execute','Component_History__c','358102asEaOG','length','BulkXmlStreamParser','set','../../../../core','../../internal/fs.internal','__esModule','3319758tVyxNb','logger','ParentId\x20IN\x20(:ids)','constructor','tmpPath','Bulk1JobOperation','556205HtDvxz','503352cIabgR','API','from','get','apply','name','where','Attachment','CompositeRetrieveData','ids','error','4ZmKYDA','search','Component_Name__c','getIsDone','pipe','Name','fs/promises','values','select','components','defineProperty','SalesforceConstants','Bulk1RetrieveData','Query','(((.+)+)+)+$','request','980226FtBmxj','ParentId','@flosum/salesforce','APPLICATION_XML','QueryBuilder','fileType','FLOSUM_NAMESPACE','mkdir','108290QrBkdp','retrieveAttachments'];a258_0x41cf=function(){return _0x3093d9;};return a258_0x41cf();}exports[a258_0x2bbb82(0x1a2)]=BulkComponentsRetriever;