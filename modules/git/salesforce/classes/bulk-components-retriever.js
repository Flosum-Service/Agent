const a247_0x1e5ed5=a247_0x30b0;function a247_0x30b0(_0x1e358b,_0x1ef3d5){const _0x27b191=a247_0x4ea7();return a247_0x30b0=function(_0x31f1a1,_0x3232ce){_0x31f1a1=_0x31f1a1-0x15d;let _0x4ea79a=_0x27b191[_0x31f1a1];return _0x4ea79a;},a247_0x30b0(_0x1e358b,_0x1ef3d5);}(function(_0x1f98fa,_0xb1ea55){const _0x5bcd93=a247_0x30b0,_0x19ac2c=_0x1f98fa();while(!![]){try{const _0x2eb678=-parseInt(_0x5bcd93(0x18a))/0x1+-parseInt(_0x5bcd93(0x180))/0x2+parseInt(_0x5bcd93(0x190))/0x3*(parseInt(_0x5bcd93(0x161))/0x4)+-parseInt(_0x5bcd93(0x169))/0x5+-parseInt(_0x5bcd93(0x17b))/0x6*(parseInt(_0x5bcd93(0x16b))/0x7)+-parseInt(_0x5bcd93(0x172))/0x8*(parseInt(_0x5bcd93(0x168))/0x9)+parseInt(_0x5bcd93(0x17d))/0xa*(parseInt(_0x5bcd93(0x16a))/0xb);if(_0x2eb678===_0xb1ea55)break;else _0x19ac2c['push'](_0x19ac2c['shift']());}catch(_0x3e342a){_0x19ac2c['push'](_0x19ac2c['shift']());}}}(a247_0x4ea7,0x93e3a));const a247_0x3232ce=(function(){let _0x1ef555=!![];return function(_0x1b123b,_0x498c8c){const _0x5b801f=_0x1ef555?function(){const _0x5c9ac5=a247_0x30b0;if(_0x498c8c){const _0x3f07f9=_0x498c8c[_0x5c9ac5(0x183)](_0x1b123b,arguments);return _0x498c8c=null,_0x3f07f9;}}:function(){};return _0x1ef555=![],_0x5b801f;};}()),a247_0x31f1a1=a247_0x3232ce(this,function(){const _0x5169d0=a247_0x30b0;return a247_0x31f1a1[_0x5169d0(0x160)]()[_0x5169d0(0x18e)](_0x5169d0(0x192))['toString']()[_0x5169d0(0x16c)](a247_0x31f1a1)[_0x5169d0(0x18e)](_0x5169d0(0x192));});a247_0x31f1a1();'use strict';Object[a247_0x1e5ed5(0x176)](exports,'__esModule',{'value':!![]}),exports[a247_0x1e5ed5(0x16f)]=void 0x0;const salesforce_1=require(a247_0x1e5ed5(0x163)),core_1=require('../../../../core'),constants_1=require(a247_0x1e5ed5(0x16d)),BINARY_FIELDS=[a247_0x1e5ed5(0x189)],MAX_IDS_CHUNK_LENGTH=0xfa0;function a247_0x4ea7(){const _0x5d03d6=['select','Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.','FLOSUM_NAMESPACE','defineProperty','Name','set','BulkV1QueryContentType','fileType','2634vIgojc','Bulk1RetrieveData','50530JIPDXY','retrieveAttachments','logger','1931578UgEMvB','Attachment','where','apply','body','pipe','Version__c','ids','get','Body','156423gXTHOr','retrieveComponents','Component_Name__c','length','search','SalesforceConstants','81AjQJID','components','(((.+)+)+)+$','getIsDone','Bulk1JobOperation','APPLICATION_XML','error','toString','48856OumopH','request','@flosum/salesforce','values','CompositeRetrieveData','BulkXmlStreamParser','ParentId\x20IN\x20(:ids)','1521uMPzWI','5007395cEsGMJ','7535MaMFMP','8631aSeMmr','constructor','../../../../constants','from','BulkComponentsRetriever','execute','splice','24632EDLOPN'];a247_0x4ea7=function(){return _0x5d03d6;};return a247_0x4ea7();}class BulkComponentsRetriever{constructor({request:_0x27041c,ids:_0x2b375d}){const _0x2e4ab5=a247_0x1e5ed5;this['components']=new Map(),this[_0x2e4ab5(0x162)]=_0x27041c,this[_0x2e4ab5(0x187)]=_0x2b375d,this[_0x2e4ab5(0x17f)]=new core_1['Logger'](BulkComponentsRetriever['name']);}async['retrieveComponents'](_0x40ef4a){const _0x5330ea=a247_0x1e5ed5,_0x5aecea=new salesforce_1['QueryBuilder']()[_0x5330ea(0x173)]('Id',constants_1['FLOSUM_NAMESPACE']+'Component__r.'+constants_1[_0x5330ea(0x175)]+_0x5330ea(0x18c),constants_1[_0x5330ea(0x175)]+_0x5330ea(0x186))[_0x5330ea(0x16e)](constants_1[_0x5330ea(0x175)]+'Component_History__c')[_0x5330ea(0x182)]('Id\x20IN\x20(:ids)',{'ids':_0x40ef4a}),_0x488735=new salesforce_1[(_0x5330ea(0x165))]({'api':salesforce_1[_0x5330ea(0x18f)]['API'],'queryBuilder':_0x5aecea,'instance':this[_0x5330ea(0x162)],'isTooling':![]});do{const {records:_0x3c966e}=await _0x488735[_0x5330ea(0x170)]();for(const _0x2f404b of _0x3c966e){this['components'][_0x5330ea(0x178)](_0x2f404b['Id'],{'fileName':_0x2f404b[constants_1[_0x5330ea(0x175)]+'Component__r'][constants_1['FLOSUM_NAMESPACE']+_0x5330ea(0x18c)],'fileType':'','body':'','version':_0x2f404b[constants_1[_0x5330ea(0x175)]+_0x5330ea(0x186)]});}}while(!_0x488735[_0x5330ea(0x193)]());}async['retrieveAttachments'](_0x23d075){const _0xe5453c=a247_0x1e5ed5,_0x20dd49=new salesforce_1['QueryBuilder']()[_0xe5453c(0x173)](_0xe5453c(0x189),_0xe5453c(0x177),'ParentId')[_0xe5453c(0x16e)](_0xe5453c(0x181))['where'](_0xe5453c(0x167),{'ids':_0x23d075}),_0x36eb51=new salesforce_1[(_0xe5453c(0x17c))]({'instance':this[_0xe5453c(0x162)],'api':salesforce_1[_0xe5453c(0x18f)]['API'],'pollInterval':0x1388,'queryBuilder':_0x20dd49,'objectName':_0xe5453c(0x181),'contentType':salesforce_1[_0xe5453c(0x179)][_0xe5453c(0x15e)],'jobOperation':salesforce_1[_0xe5453c(0x15d)]['Query']});do{const _0x119c26=await _0x36eb51[_0xe5453c(0x170)]();if(!_0x119c26)break;const _0x1dcbbd=new salesforce_1[(_0xe5453c(0x166))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x1e25ca,ParentId:_0x384d07,Body:_0x1b5581}of _0x119c26[_0xe5453c(0x185)](_0x1dcbbd)){const _0x116cae=this[_0xe5453c(0x191)][_0xe5453c(0x188)](_0x384d07);if(!_0x116cae){this['logger'][_0xe5453c(0x15f)](_0xe5453c(0x174),_0x384d07,_0x1e25ca);continue;}_0x116cae[_0xe5453c(0x184)]=_0x1b5581,_0x116cae[_0xe5453c(0x17a)]=_0x1e25ca;}}while(!_0x36eb51[_0xe5453c(0x193)]());}async['retrieve'](){const _0x12ee29=a247_0x1e5ed5;do{const _0x363da8=this['ids'][_0x12ee29(0x171)](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x12ee29(0x18b)](_0x363da8),await this[_0x12ee29(0x17e)](_0x363da8);}while(this[_0x12ee29(0x187)][_0x12ee29(0x18d)]);return[...this['components'][_0x12ee29(0x164)]()];}}exports[a247_0x1e5ed5(0x16f)]=BulkComponentsRetriever;