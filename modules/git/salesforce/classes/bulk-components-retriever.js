const a259_0x325127=a259_0x2a2d;(function(_0x1ee09f,_0x1acbe6){const _0xdb7996=a259_0x2a2d,_0x296d5a=_0x1ee09f();while(!![]){try{const _0x2a4d3b=-parseInt(_0xdb7996(0xa8))/0x1*(-parseInt(_0xdb7996(0x89))/0x2)+-parseInt(_0xdb7996(0xa5))/0x3*(-parseInt(_0xdb7996(0xb3))/0x4)+-parseInt(_0xdb7996(0xbf))/0x5+parseInt(_0xdb7996(0x8a))/0x6*(parseInt(_0xdb7996(0x8b))/0x7)+parseInt(_0xdb7996(0xb9))/0x8+-parseInt(_0xdb7996(0xaa))/0x9*(-parseInt(_0xdb7996(0x83))/0xa)+-parseInt(_0xdb7996(0x94))/0xb;if(_0x2a4d3b===_0x1acbe6)break;else _0x296d5a['push'](_0x296d5a['shift']());}catch(_0x26c35f){_0x296d5a['push'](_0x296d5a['shift']());}}}(a259_0x1562,0x59938));function a259_0x1562(){const _0x1480b0=['FLOSUM_NAMESPACE','API','CompositeRetrieveData','12370lxEnMp','Attachment','get','Bulk1JobOperation','Version__c','splice','807304TjJUOX','734538AbtOzy','14hnbaBG','../../../../core','../../../../configs/path','Body','exists','toString','retrieveAttachments','name','constructor','14895034nuqrWZ','ParentId','retrieve','BulkComponentsRetriever','where','Query','tmpPath','BulkV1QueryContentType','length','Component__r','__esModule','ids','@flosum/salesforce','../../internal/fs.internal','body','apply','error','3YcFQiF','retrieveComponents','select','1mNCtTf','search','1467fjtJVX','Id\x20IN\x20(:ids)','from','logger','values','QueryBuilder','request','Bulk1RetrieveData','BulkXmlStreamParser','1352396yrqaac','APPLICATION_XML','getIsDone','components','(((.+)+)+)+$','Name','5864896TXpuXB','Component_Name__c','set','Component_History__c','SalesforceConstants','Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.','1001710wrzgWR'];a259_0x1562=function(){return _0x1480b0;};return a259_0x1562();}function a259_0x2a2d(_0xb914fe,_0x5c4f89){const _0x834504=a259_0x1562();return a259_0x2a2d=function(_0x173744,_0x4b9399){_0x173744=_0x173744-0x81;let _0x15627=_0x834504[_0x173744];return _0x15627;},a259_0x2a2d(_0xb914fe,_0x5c4f89);}const a259_0x4b9399=(function(){let _0x54cbb5=!![];return function(_0x4f304b,_0x115df9){const _0xea7c75=_0x54cbb5?function(){const _0x15f11a=a259_0x2a2d;if(_0x115df9){const _0x264b29=_0x115df9[_0x15f11a(0xa3)](_0x4f304b,arguments);return _0x115df9=null,_0x264b29;}}:function(){};return _0x54cbb5=![],_0xea7c75;};}()),a259_0x173744=a259_0x4b9399(this,function(){const _0x5aa4d4=a259_0x2a2d;return a259_0x173744[_0x5aa4d4(0x90)]()['search'](_0x5aa4d4(0xb7))['toString']()[_0x5aa4d4(0x93)](a259_0x173744)[_0x5aa4d4(0xa9)](_0x5aa4d4(0xb7));});a259_0x173744();'use strict';Object['defineProperty'](exports,a259_0x325127(0x9e),{'value':!![]}),exports[a259_0x325127(0x97)]=void 0x0;const salesforce_1=require(a259_0x325127(0xa0)),core_1=require(a259_0x325127(0x8c)),constants_1=require('../../../../constants'),promises_1=require('fs/promises'),fs_internal_1=require(a259_0x325127(0xa1)),path_1=require(a259_0x325127(0x8d)),BINARY_FIELDS=[a259_0x325127(0x8e)],MAX_IDS_CHUNK_LENGTH=0xfa0;class BulkComponentsRetriever{constructor({request:_0x498adb,ids:_0x447336}){const _0x537f81=a259_0x325127;this[_0x537f81(0xb6)]=new Map(),this['request']=_0x498adb,this[_0x537f81(0x9f)]=_0x447336,this[_0x537f81(0xad)]=new core_1['Logger'](BulkComponentsRetriever[_0x537f81(0x92)]);}async[a259_0x325127(0xa6)](_0x220260){const _0x230770=a259_0x325127,_0xa8865b=new salesforce_1[(_0x230770(0xaf))]()['select']('Id',constants_1[_0x230770(0xc0)]+'Component__r.'+constants_1[_0x230770(0xc0)]+'Component_Name__c',constants_1[_0x230770(0xc0)]+_0x230770(0x87))[_0x230770(0xac)](constants_1[_0x230770(0xc0)]+_0x230770(0xbc))[_0x230770(0x98)](_0x230770(0xab),{'ids':_0x220260}),_0x23a538=new salesforce_1[(_0x230770(0x82))]({'api':salesforce_1[_0x230770(0xbd)][_0x230770(0x81)],'queryBuilder':_0xa8865b,'instance':this[_0x230770(0xb0)],'isTooling':![]});do{const {records:_0x2ef7a4}=await _0x23a538['execute']();for(const _0x24f894 of _0x2ef7a4){this['components'][_0x230770(0xbb)](_0x24f894['Id'],{'fileName':_0x24f894[constants_1[_0x230770(0xc0)]+_0x230770(0x9d)][constants_1[_0x230770(0xc0)]+_0x230770(0xba)],'fileType':'','body':'','version':_0x24f894[constants_1['FLOSUM_NAMESPACE']+_0x230770(0x87)]});}}while(!_0x23a538[_0x230770(0xb5)]());}async[a259_0x325127(0x91)](_0x920e2){const _0x192c55=a259_0x325127,_0x20e198=new salesforce_1[(_0x192c55(0xaf))]()[_0x192c55(0xa7)](_0x192c55(0x8e),_0x192c55(0xb8),_0x192c55(0x95))[_0x192c55(0xac)](_0x192c55(0x84))[_0x192c55(0x98)]('ParentId\x20IN\x20(:ids)',{'ids':_0x920e2});!await fs_internal_1['FS'][_0x192c55(0x8f)](path_1['tmpPath'])&&await(0x0,promises_1['mkdir'])(path_1[_0x192c55(0x9a)],{'recursive':!![]});const _0x38fda1=new salesforce_1[(_0x192c55(0xb1))]({'instance':this[_0x192c55(0xb0)],'api':salesforce_1['SalesforceConstants'][_0x192c55(0x81)],'pollInterval':0x1388,'queryBuilder':_0x20e198,'objectName':_0x192c55(0x84),'contentType':salesforce_1[_0x192c55(0x9b)][_0x192c55(0xb4)],'jobOperation':salesforce_1[_0x192c55(0x86)][_0x192c55(0x99)],'tmpPath':path_1[_0x192c55(0x9a)]});do{const _0x269cc8=await _0x38fda1['execute']();if(!_0x269cc8)break;const _0x55197e=new salesforce_1[(_0x192c55(0xb2))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0xc41f8d,ParentId:_0x407fad,Body:_0xb6e7a9}of _0x269cc8['pipe'](_0x55197e)){const _0x7122bb=this[_0x192c55(0xb6)][_0x192c55(0x85)](_0x407fad);if(!_0x7122bb){this[_0x192c55(0xad)][_0x192c55(0xa4)](_0x192c55(0xbe),_0x407fad,_0xc41f8d);continue;}_0x7122bb[_0x192c55(0xa2)]=_0xb6e7a9,_0x7122bb['fileType']=_0xc41f8d;}}while(!_0x38fda1[_0x192c55(0xb5)]());}async[a259_0x325127(0x96)](){const _0x3ae6e7=a259_0x325127;do{const _0x3e863c=this[_0x3ae6e7(0x9f)][_0x3ae6e7(0x88)](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x3ae6e7(0xa6)](_0x3e863c),await this[_0x3ae6e7(0x91)](_0x3e863c);}while(this[_0x3ae6e7(0x9f)][_0x3ae6e7(0x9c)]);return[...this[_0x3ae6e7(0xb6)][_0x3ae6e7(0xae)]()];}}exports['BulkComponentsRetriever']=BulkComponentsRetriever;