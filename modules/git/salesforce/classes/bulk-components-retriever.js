const a258_0xec9902=a258_0x1d01;(function(_0x2216c0,_0x19376e){const _0x1b18e5=a258_0x1d01,_0x5476ca=_0x2216c0();while(!![]){try{const _0x6cb273=-parseInt(_0x1b18e5(0x1a7))/0x1*(parseInt(_0x1b18e5(0x198))/0x2)+parseInt(_0x1b18e5(0x1c6))/0x3+-parseInt(_0x1b18e5(0x1ab))/0x4*(parseInt(_0x1b18e5(0x1a9))/0x5)+-parseInt(_0x1b18e5(0x1b1))/0x6*(parseInt(_0x1b18e5(0x1ca))/0x7)+-parseInt(_0x1b18e5(0x19d))/0x8+-parseInt(_0x1b18e5(0x1c4))/0x9+parseInt(_0x1b18e5(0x1af))/0xa*(parseInt(_0x1b18e5(0x1b0))/0xb);if(_0x6cb273===_0x19376e)break;else _0x5476ca['push'](_0x5476ca['shift']());}catch(_0x57f6aa){_0x5476ca['push'](_0x5476ca['shift']());}}}(a258_0x2256,0xaa986));const a258_0x41c8ab=(function(){let _0x7677a7=!![];return function(_0x2d543a,_0x123a3b){const _0x5827ff=_0x7677a7?function(){if(_0x123a3b){const _0x432a4d=_0x123a3b['apply'](_0x2d543a,arguments);return _0x123a3b=null,_0x432a4d;}}:function(){};return _0x7677a7=![],_0x5827ff;};}()),a258_0x10da53=a258_0x41c8ab(this,function(){const _0x480525=a258_0x1d01;return a258_0x10da53['toString']()[_0x480525(0x1b3)]('(((.+)+)+)+$')[_0x480525(0x1aa)]()[_0x480525(0x1b2)](a258_0x10da53)[_0x480525(0x1b3)](_0x480525(0x1c8));});a258_0x10da53();'use strict';Object[a258_0xec9902(0x1c3)](exports,'__esModule',{'value':!![]}),exports[a258_0xec9902(0x1bf)]=void 0x0;function a258_0x2256(){const _0x53dfa7=['Component_Name__c','fileType','10096wdFNoP','retrieve','Attachment','Bulk1JobOperation','length','2558560hUESVZ','where','CompositeRetrieveData','getIsDone','FLOSUM_NAMESPACE','Logger','select','Component__r','components','../../../../constants','95FgyGAe','Component__r.','102240EqgFXJ','toString','76yDRZXe','from','Query','body','11939450uYMzCu','22YgutTC','253422iLOgQX','constructor','search','execute','retrieveComponents','ids','Version__c','SalesforceConstants','Id\x20IN\x20(:ids)','set','API','Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.','Component_History__c','ParentId\x20IN\x20(:ids)','BulkComponentsRetriever','logger','Body','request','defineProperty','12147903hhPWzI','pipe','2672292BfEttc','QueryBuilder','(((.+)+)+)+$','BulkV1QueryContentType','7gHCQRy'];a258_0x2256=function(){return _0x53dfa7;};return a258_0x2256();}const salesforce_1=require('@flosum/salesforce'),core_1=require('../../../../core'),constants_1=require(a258_0xec9902(0x1a6)),BINARY_FIELDS=['Body'],MAX_IDS_CHUNK_LENGTH=0xfa0;function a258_0x1d01(_0x13edf,_0x3b80b5){const _0x2cb7c4=a258_0x2256();return a258_0x1d01=function(_0x10da53,_0x41c8ab){_0x10da53=_0x10da53-0x196;let _0x225642=_0x2cb7c4[_0x10da53];return _0x225642;},a258_0x1d01(_0x13edf,_0x3b80b5);}class BulkComponentsRetriever{constructor({request:_0x38048d,ids:_0x141ed4}){const _0x445e44=a258_0xec9902;this['components']=new Map(),this[_0x445e44(0x1c2)]=_0x38048d,this[_0x445e44(0x1b6)]=_0x141ed4,this[_0x445e44(0x1c0)]=new core_1[(_0x445e44(0x1a2))](BulkComponentsRetriever['name']);}async[a258_0xec9902(0x1b5)](_0x4f7fe5){const _0x4512e3=a258_0xec9902,_0x237fad=new salesforce_1[(_0x4512e3(0x1c7))]()[_0x4512e3(0x1a3)]('Id',constants_1[_0x4512e3(0x1a1)]+_0x4512e3(0x1a8)+constants_1[_0x4512e3(0x1a1)]+_0x4512e3(0x196),constants_1[_0x4512e3(0x1a1)]+_0x4512e3(0x1b7))[_0x4512e3(0x1ac)](constants_1[_0x4512e3(0x1a1)]+_0x4512e3(0x1bd))[_0x4512e3(0x19e)](_0x4512e3(0x1b9),{'ids':_0x4f7fe5}),_0x5cfa1e=new salesforce_1[(_0x4512e3(0x19f))]({'api':salesforce_1[_0x4512e3(0x1b8)][_0x4512e3(0x1bb)],'queryBuilder':_0x237fad,'instance':this['request'],'isTooling':![]});do{const {records:_0x20f8c1}=await _0x5cfa1e[_0x4512e3(0x1b4)]();for(const _0x4e384d of _0x20f8c1){this[_0x4512e3(0x1a5)][_0x4512e3(0x1ba)](_0x4e384d['Id'],{'fileName':_0x4e384d[constants_1[_0x4512e3(0x1a1)]+_0x4512e3(0x1a4)][constants_1['FLOSUM_NAMESPACE']+_0x4512e3(0x196)],'fileType':'','body':'','version':_0x4e384d[constants_1[_0x4512e3(0x1a1)]+'Version__c']});}}while(!_0x5cfa1e[_0x4512e3(0x1a0)]());}async['retrieveAttachments'](_0x5cf262){const _0x1aecc5=a258_0xec9902,_0x38cf08=new salesforce_1['QueryBuilder']()['select'](_0x1aecc5(0x1c1),'Name','ParentId')[_0x1aecc5(0x1ac)](_0x1aecc5(0x19a))[_0x1aecc5(0x19e)](_0x1aecc5(0x1be),{'ids':_0x5cf262}),_0x52c0f6=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x1aecc5(0x1c2)],'api':salesforce_1[_0x1aecc5(0x1b8)][_0x1aecc5(0x1bb)],'pollInterval':0x1388,'queryBuilder':_0x38cf08,'objectName':_0x1aecc5(0x19a),'contentType':salesforce_1[_0x1aecc5(0x1c9)]['APPLICATION_XML'],'jobOperation':salesforce_1[_0x1aecc5(0x19b)][_0x1aecc5(0x1ad)]});do{const _0x49c54b=await _0x52c0f6['execute']();if(!_0x49c54b)break;const _0x33ce34=new salesforce_1['BulkXmlStreamParser']({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x35f8bb,ParentId:_0x5778df,Body:_0x5ba7c0}of _0x49c54b[_0x1aecc5(0x1c5)](_0x33ce34)){const _0x5128d0=this[_0x1aecc5(0x1a5)]['get'](_0x5778df);if(!_0x5128d0){this[_0x1aecc5(0x1c0)]['error'](_0x1aecc5(0x1bc),_0x5778df,_0x35f8bb);continue;}_0x5128d0[_0x1aecc5(0x1ae)]=_0x5ba7c0,_0x5128d0[_0x1aecc5(0x197)]=_0x35f8bb;}}while(!_0x52c0f6[_0x1aecc5(0x1a0)]());}async[a258_0xec9902(0x199)](){const _0x2f58c1=a258_0xec9902;do{const _0xcb3938=this[_0x2f58c1(0x1b6)]['splice'](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x2f58c1(0x1b5)](_0xcb3938),await this['retrieveAttachments'](_0xcb3938);}while(this[_0x2f58c1(0x1b6)][_0x2f58c1(0x19c)]);return[...this['components']['values']()];}}exports['BulkComponentsRetriever']=BulkComponentsRetriever;