const a247_0x59e172=a247_0x410b;function a247_0x410b(_0x5081a0,_0x2d37a0){const _0x2a04d7=a247_0x5b05();return a247_0x410b=function(_0x50b5ba,_0x352313){_0x50b5ba=_0x50b5ba-0x86;let _0x5b05ce=_0x2a04d7[_0x50b5ba];return _0x5b05ce;},a247_0x410b(_0x5081a0,_0x2d37a0);}(function(_0x29b4f6,_0x461dac){const _0x4d7583=a247_0x410b,_0x765c8=_0x29b4f6();while(!![]){try{const _0x17f19a=parseInt(_0x4d7583(0x9b))/0x1*(parseInt(_0x4d7583(0xba))/0x2)+-parseInt(_0x4d7583(0x9a))/0x3*(-parseInt(_0x4d7583(0x95))/0x4)+-parseInt(_0x4d7583(0x93))/0x5+-parseInt(_0x4d7583(0x94))/0x6*(-parseInt(_0x4d7583(0xbe))/0x7)+parseInt(_0x4d7583(0x9e))/0x8+-parseInt(_0x4d7583(0xa5))/0x9+-parseInt(_0x4d7583(0x8b))/0xa*(parseInt(_0x4d7583(0xb1))/0xb);if(_0x17f19a===_0x461dac)break;else _0x765c8['push'](_0x765c8['shift']());}catch(_0x339359){_0x765c8['push'](_0x765c8['shift']());}}}(a247_0x5b05,0x80563));const a247_0x352313=(function(){let _0x6244c7=!![];return function(_0x556af6,_0x60cca8){const _0x5e5a3f=_0x6244c7?function(){if(_0x60cca8){const _0xc62d8f=_0x60cca8['apply'](_0x556af6,arguments);return _0x60cca8=null,_0xc62d8f;}}:function(){};return _0x6244c7=![],_0x5e5a3f;};}()),a247_0x50b5ba=a247_0x352313(this,function(){const _0x1c3024=a247_0x410b;return a247_0x50b5ba[_0x1c3024(0x91)]()[_0x1c3024(0x8e)](_0x1c3024(0xad))[_0x1c3024(0x91)]()['constructor'](a247_0x50b5ba)['search'](_0x1c3024(0xad));});function a247_0x5b05(){const _0x187d02=['search','Bulk1JobOperation','getIsDone','toString','retrieveAttachments','3529440IRAiGr','550026yCsaIX','20OELiwC','retrieveComponents','ParentId\x20IN\x20(:ids)','request','name','13989mXNUTc','2uyPjlr','splice','Logger','7127400IxiwNL','values','Query','ids','SalesforceConstants','@flosum/salesforce','components','1209087ywaFxJ','Attachment','ParentId','APPLICATION_XML','BulkV1QueryContentType','Bulk1RetrieveData','BulkXmlStreamParser','Id\x20IN\x20(:ids)','(((.+)+)+)+$','CompositeRetrieveData','fileType','execute','11PQLSkn','error','Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.','API','from','defineProperty','logger','pipe','FLOSUM_NAMESPACE','692844NJqvNV','__esModule','length','body','56Snsarb','Body','get','QueryBuilder','Component__r.','where','BulkComponentsRetriever','9745540NXdYiq','Component_History__c','Version__c'];a247_0x5b05=function(){return _0x187d02;};return a247_0x5b05();}a247_0x50b5ba();'use strict';Object[a247_0x59e172(0xb6)](exports,a247_0x59e172(0xbb),{'value':!![]}),exports[a247_0x59e172(0x8a)]=void 0x0;const salesforce_1=require(a247_0x59e172(0xa3)),core_1=require('../../../../core'),constants_1=require('../../../../constants'),BINARY_FIELDS=['Body'],MAX_IDS_CHUNK_LENGTH=0xfa0;class BulkComponentsRetriever{constructor({request:_0x25bcc9,ids:_0x3309eb}){const _0x4f697d=a247_0x59e172;this['components']=new Map(),this[_0x4f697d(0x98)]=_0x25bcc9,this[_0x4f697d(0xa1)]=_0x3309eb,this[_0x4f697d(0xb7)]=new core_1[(_0x4f697d(0x9d))](BulkComponentsRetriever[_0x4f697d(0x99)]);}async[a247_0x59e172(0x96)](_0x586b56){const _0x140535=a247_0x59e172,_0x5281ed=new salesforce_1[(_0x140535(0x87))]()['select']('Id',constants_1[_0x140535(0xb9)]+_0x140535(0x88)+constants_1[_0x140535(0xb9)]+'Component_Name__c',constants_1[_0x140535(0xb9)]+_0x140535(0x8d))[_0x140535(0xb5)](constants_1[_0x140535(0xb9)]+_0x140535(0x8c))[_0x140535(0x89)](_0x140535(0xac),{'ids':_0x586b56}),_0x5a1d27=new salesforce_1[(_0x140535(0xae))]({'api':salesforce_1[_0x140535(0xa2)][_0x140535(0xb4)],'queryBuilder':_0x5281ed,'instance':this[_0x140535(0x98)],'isTooling':![]});do{const {records:_0x5f4209}=await _0x5a1d27[_0x140535(0xb0)]();for(const _0x38720c of _0x5f4209){this[_0x140535(0xa4)]['set'](_0x38720c['Id'],{'fileName':_0x38720c[constants_1['FLOSUM_NAMESPACE']+'Component__r'][constants_1[_0x140535(0xb9)]+'Component_Name__c'],'fileType':'','body':'','version':_0x38720c[constants_1['FLOSUM_NAMESPACE']+'Version__c']});}}while(!_0x5a1d27['getIsDone']());}async[a247_0x59e172(0x92)](_0x4692aa){const _0x2437d6=a247_0x59e172,_0x1a7b48=new salesforce_1['QueryBuilder']()['select'](_0x2437d6(0xbf),'Name',_0x2437d6(0xa7))[_0x2437d6(0xb5)](_0x2437d6(0xa6))[_0x2437d6(0x89)](_0x2437d6(0x97),{'ids':_0x4692aa}),_0x5f01a8=new salesforce_1[(_0x2437d6(0xaa))]({'instance':this[_0x2437d6(0x98)],'api':salesforce_1[_0x2437d6(0xa2)]['API'],'pollInterval':0x1388,'queryBuilder':_0x1a7b48,'objectName':_0x2437d6(0xa6),'contentType':salesforce_1[_0x2437d6(0xa9)][_0x2437d6(0xa8)],'jobOperation':salesforce_1[_0x2437d6(0x8f)][_0x2437d6(0xa0)]});do{const _0x5dec23=await _0x5f01a8[_0x2437d6(0xb0)]();if(!_0x5dec23)break;const _0x2cb216=new salesforce_1[(_0x2437d6(0xab))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x496140,ParentId:_0x23d604,Body:_0x37159b}of _0x5dec23[_0x2437d6(0xb8)](_0x2cb216)){const _0x100930=this[_0x2437d6(0xa4)][_0x2437d6(0x86)](_0x23d604);if(!_0x100930){this['logger'][_0x2437d6(0xb2)](_0x2437d6(0xb3),_0x23d604,_0x496140);continue;}_0x100930[_0x2437d6(0xbd)]=_0x37159b,_0x100930[_0x2437d6(0xaf)]=_0x496140;}}while(!_0x5f01a8[_0x2437d6(0x90)]());}async['retrieve'](){const _0x1db7a7=a247_0x59e172;do{const _0x27c37a=this[_0x1db7a7(0xa1)][_0x1db7a7(0x9c)](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x1db7a7(0x96)](_0x27c37a),await this[_0x1db7a7(0x92)](_0x27c37a);}while(this[_0x1db7a7(0xa1)][_0x1db7a7(0xbc)]);return[...this[_0x1db7a7(0xa4)][_0x1db7a7(0x9f)]()];}}exports[a247_0x59e172(0x8a)]=BulkComponentsRetriever;