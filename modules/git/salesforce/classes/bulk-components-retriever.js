const a259_0xfc7f91=a259_0x507e;(function(_0x3c60c6,_0x335c4e){const _0x2dabf4=a259_0x507e,_0x3d2b8c=_0x3c60c6();while(!![]){try{const _0x3b5745=parseInt(_0x2dabf4(0x1c8))/0x1*(-parseInt(_0x2dabf4(0x1d6))/0x2)+parseInt(_0x2dabf4(0x1db))/0x3*(parseInt(_0x2dabf4(0x1e5))/0x4)+parseInt(_0x2dabf4(0x1ea))/0x5+-parseInt(_0x2dabf4(0x1e8))/0x6+parseInt(_0x2dabf4(0x1ce))/0x7+-parseInt(_0x2dabf4(0x1e6))/0x8*(-parseInt(_0x2dabf4(0x1c4))/0x9)+parseInt(_0x2dabf4(0x1de))/0xa*(parseInt(_0x2dabf4(0x1cc))/0xb);if(_0x3b5745===_0x335c4e)break;else _0x3d2b8c['push'](_0x3d2b8c['shift']());}catch(_0x12316a){_0x3d2b8c['push'](_0x3d2b8c['shift']());}}}(a259_0x1cf2,0xf11c9));const a259_0x5d95d8=(function(){let _0x3693d5=!![];return function(_0x314522,_0x575740){const _0x5a310d=_0x3693d5?function(){if(_0x575740){const _0x38ef37=_0x575740['apply'](_0x314522,arguments);return _0x575740=null,_0x38ef37;}}:function(){};return _0x3693d5=![],_0x5a310d;};}()),a259_0x43bac4=a259_0x5d95d8(this,function(){const _0x93f3bd=a259_0x507e;return a259_0x43bac4[_0x93f3bd(0x1e9)]()[_0x93f3bd(0x1b9)](_0x93f3bd(0x1be))[_0x93f3bd(0x1e9)]()[_0x93f3bd(0x1cf)](a259_0x43bac4)[_0x93f3bd(0x1b9)](_0x93f3bd(0x1be));});a259_0x43bac4();function a259_0x1cf2(){const _0x1975b7=['retrieveAttachments','Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.','pipe','Query','BulkComponentsRetriever','Component__r','defineProperty','search','tmpPath','../../internal/fs.internal','ParentId\x20IN\x20(:ids)','body','(((.+)+)+)+$','Id\x20IN\x20(:ids)','error','Name','getIsDone','where','9JSQURZ','from','FLOSUM_NAMESPACE','length','1640WVPNMd','../../../../core','splice','__esModule','11jUScQG','components','3619777OvhWsr','constructor','Logger','Attachment','exists','Component_Name__c','execute','retrieve','998HCozIq','Version__c','retrieveComponents','SalesforceConstants','ParentId','3mRXWCi','Bulk1RetrieveData','../../../../configs/path','2877510Wwlrxl','select','Bulk1JobOperation','ids','request','QueryBuilder','set','1800940QaAhkE','14400552JvvCwr','API','10759422aSCfvD','toString','2720120HrMXWs','values','Component_History__c','Component__r.','logger','BulkXmlStreamParser','../../../../constants','@flosum/salesforce'];a259_0x1cf2=function(){return _0x1975b7;};return a259_0x1cf2();}'use strict';Object[a259_0xfc7f91(0x1b8)](exports,a259_0xfc7f91(0x1cb),{'value':!![]}),exports[a259_0xfc7f91(0x1b6)]=void 0x0;const salesforce_1=require(a259_0xfc7f91(0x1f1)),core_1=require(a259_0xfc7f91(0x1c9)),constants_1=require(a259_0xfc7f91(0x1f0)),promises_1=require('fs/promises'),fs_internal_1=require(a259_0xfc7f91(0x1bb)),path_1=require(a259_0xfc7f91(0x1dd)),BINARY_FIELDS=['Body'],MAX_IDS_CHUNK_LENGTH=0xfa0;class BulkComponentsRetriever{constructor({request:_0x24e386,ids:_0x56d2d2}){const _0x294466=a259_0xfc7f91;this[_0x294466(0x1cd)]=new Map(),this[_0x294466(0x1e2)]=_0x24e386,this[_0x294466(0x1e1)]=_0x56d2d2,this[_0x294466(0x1ee)]=new core_1[(_0x294466(0x1d0))](BulkComponentsRetriever['name']);}async[a259_0xfc7f91(0x1d8)](_0x5136bf){const _0x381f53=a259_0xfc7f91,_0x1984b4=new salesforce_1[(_0x381f53(0x1e3))]()[_0x381f53(0x1df)]('Id',constants_1[_0x381f53(0x1c6)]+_0x381f53(0x1ed)+constants_1[_0x381f53(0x1c6)]+_0x381f53(0x1d3),constants_1[_0x381f53(0x1c6)]+_0x381f53(0x1d7))[_0x381f53(0x1c5)](constants_1[_0x381f53(0x1c6)]+_0x381f53(0x1ec))['where'](_0x381f53(0x1bf),{'ids':_0x5136bf}),_0x116605=new salesforce_1['CompositeRetrieveData']({'api':salesforce_1[_0x381f53(0x1d9)][_0x381f53(0x1e7)],'queryBuilder':_0x1984b4,'instance':this[_0x381f53(0x1e2)],'isTooling':![]});do{const {records:_0x1fe6e9}=await _0x116605[_0x381f53(0x1d4)]();for(const _0x545552 of _0x1fe6e9){this[_0x381f53(0x1cd)][_0x381f53(0x1e4)](_0x545552['Id'],{'fileName':_0x545552[constants_1[_0x381f53(0x1c6)]+_0x381f53(0x1b7)][constants_1[_0x381f53(0x1c6)]+_0x381f53(0x1d3)],'fileType':'','body':'','version':_0x545552[constants_1['FLOSUM_NAMESPACE']+_0x381f53(0x1d7)]});}}while(!_0x116605[_0x381f53(0x1c2)]());}async[a259_0xfc7f91(0x1f2)](_0x50c832){const _0x25183a=a259_0xfc7f91,_0x2cf655=new salesforce_1[(_0x25183a(0x1e3))]()['select']('Body',_0x25183a(0x1c1),_0x25183a(0x1da))[_0x25183a(0x1c5)]('Attachment')[_0x25183a(0x1c3)](_0x25183a(0x1bc),{'ids':_0x50c832});!await fs_internal_1['FS'][_0x25183a(0x1d2)](path_1['tmpPath'])&&await(0x0,promises_1['mkdir'])(path_1[_0x25183a(0x1ba)],{'recursive':!![]});const _0x1f1eea=new salesforce_1[(_0x25183a(0x1dc))]({'instance':this[_0x25183a(0x1e2)],'api':salesforce_1[_0x25183a(0x1d9)][_0x25183a(0x1e7)],'pollInterval':0x1388,'queryBuilder':_0x2cf655,'objectName':_0x25183a(0x1d1),'contentType':salesforce_1['BulkV1QueryContentType']['APPLICATION_XML'],'jobOperation':salesforce_1[_0x25183a(0x1e0)][_0x25183a(0x1b5)],'tmpPath':path_1[_0x25183a(0x1ba)]});do{const _0x5d811a=await _0x1f1eea[_0x25183a(0x1d4)]();if(!_0x5d811a)break;const _0x274363=new salesforce_1[(_0x25183a(0x1ef))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x50a347,ParentId:_0x5ed41b,Body:_0x62a59d}of _0x5d811a[_0x25183a(0x1f4)](_0x274363)){const _0x54a503=this['components']['get'](_0x5ed41b);if(!_0x54a503){this[_0x25183a(0x1ee)][_0x25183a(0x1c0)](_0x25183a(0x1f3),_0x5ed41b,_0x50a347);continue;}_0x54a503[_0x25183a(0x1bd)]=_0x62a59d,_0x54a503['fileType']=_0x50a347;}}while(!_0x1f1eea[_0x25183a(0x1c2)]());}async[a259_0xfc7f91(0x1d5)](){const _0x474bb5=a259_0xfc7f91;do{const _0x455742=this[_0x474bb5(0x1e1)][_0x474bb5(0x1ca)](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x474bb5(0x1d8)](_0x455742),await this[_0x474bb5(0x1f2)](_0x455742);}while(this[_0x474bb5(0x1e1)][_0x474bb5(0x1c7)]);return[...this[_0x474bb5(0x1cd)][_0x474bb5(0x1eb)]()];}}function a259_0x507e(_0x419d44,_0x2e64b9){const _0x232723=a259_0x1cf2();return a259_0x507e=function(_0x43bac4,_0x5d95d8){_0x43bac4=_0x43bac4-0x1b5;let _0x1cf241=_0x232723[_0x43bac4];return _0x1cf241;},a259_0x507e(_0x419d44,_0x2e64b9);}exports['BulkComponentsRetriever']=BulkComponentsRetriever;