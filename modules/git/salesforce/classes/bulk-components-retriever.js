const a259_0x2f0ae5=a259_0x8150;function a259_0x8150(_0x37407c,_0x591d73){const _0xe2ec74=a259_0x1021();return a259_0x8150=function(_0x3d97c0,_0x91e5f){_0x3d97c0=_0x3d97c0-0xb3;let _0x102160=_0xe2ec74[_0x3d97c0];return _0x102160;},a259_0x8150(_0x37407c,_0x591d73);}(function(_0x10d1f9,_0x14aadd){const _0x33ed24=a259_0x8150,_0x380001=_0x10d1f9();while(!![]){try{const _0x12f2f0=parseInt(_0x33ed24(0xc0))/0x1*(-parseInt(_0x33ed24(0xed))/0x2)+parseInt(_0x33ed24(0xe2))/0x3*(parseInt(_0x33ed24(0xb7))/0x4)+-parseInt(_0x33ed24(0xe5))/0x5+parseInt(_0x33ed24(0xce))/0x6+-parseInt(_0x33ed24(0xd0))/0x7*(parseInt(_0x33ed24(0xe9))/0x8)+-parseInt(_0x33ed24(0xd4))/0x9*(-parseInt(_0x33ed24(0xcc))/0xa)+-parseInt(_0x33ed24(0xd3))/0xb*(-parseInt(_0x33ed24(0xde))/0xc);if(_0x12f2f0===_0x14aadd)break;else _0x380001['push'](_0x380001['shift']());}catch(_0x41f677){_0x380001['push'](_0x380001['shift']());}}}(a259_0x1021,0xaad9d));function a259_0x1021(){const _0x4d25c6=['1315914vGegzJ','body','1328061OtgCfJ','ParentId\x20IN\x20(:ids)','../../internal/fs.internal','8690xPjPni','45VqfXTz','name','__esModule','BulkV1QueryContentType','ParentId','CompositeRetrieveData','fileType','get','apply','Component_Name__c','44220YxFBhC','retrieveAttachments','tmpPath','retrieveComponents','507CrpdaW','Component__r.','exists','4926030rTfJqC','Version__c','where','logger','56BMCltg','Query','SalesforceConstants','Id\x20IN\x20(:ids)','12510evYkWR','@flosum/salesforce','Bulk1JobOperation','(((.+)+)+)+$','FLOSUM_NAMESPACE','Name','QueryBuilder','Attachment','toString','Bulk1RetrieveData','execute','set','select','Component_History__c','25248AOCmQm','APPLICATION_XML','API','ids','../../../../core','fs/promises','Logger','BulkComponentsRetriever','../../../../configs/path','222oRJFFp','pipe','request','values','defineProperty','components','Body','../../../../constants','error','from','BulkXmlStreamParser','splice','408970TgcTIu','Component__r'];a259_0x1021=function(){return _0x4d25c6;};return a259_0x1021();}const a259_0x91e5f=(function(){let _0x166431=!![];return function(_0xff1307,_0x4d7c8b){const _0x5501af=_0x166431?function(){const _0x1967ce=a259_0x8150;if(_0x4d7c8b){const _0x44cd70=_0x4d7c8b[_0x1967ce(0xdc)](_0xff1307,arguments);return _0x4d7c8b=null,_0x44cd70;}}:function(){};return _0x166431=![],_0x5501af;};}()),a259_0x3d97c0=a259_0x91e5f(this,function(){const _0xba050f=a259_0x8150;return a259_0x3d97c0[_0xba050f(0xf5)]()['search'](_0xba050f(0xf0))[_0xba050f(0xf5)]()['constructor'](a259_0x3d97c0)['search'](_0xba050f(0xf0));});a259_0x3d97c0();'use strict';Object[a259_0x2f0ae5(0xc4)](exports,a259_0x2f0ae5(0xd6),{'value':!![]}),exports[a259_0x2f0ae5(0xbe)]=void 0x0;const salesforce_1=require(a259_0x2f0ae5(0xee)),core_1=require(a259_0x2f0ae5(0xbb)),constants_1=require(a259_0x2f0ae5(0xc7)),promises_1=require(a259_0x2f0ae5(0xbc)),fs_internal_1=require(a259_0x2f0ae5(0xd2)),path_1=require(a259_0x2f0ae5(0xbf)),BINARY_FIELDS=[a259_0x2f0ae5(0xc6)],MAX_IDS_CHUNK_LENGTH=0xfa0;class BulkComponentsRetriever{constructor({request:_0x403d4f,ids:_0x28f52d}){const _0x33a78d=a259_0x2f0ae5;this[_0x33a78d(0xc5)]=new Map(),this[_0x33a78d(0xc2)]=_0x403d4f,this[_0x33a78d(0xba)]=_0x28f52d,this[_0x33a78d(0xe8)]=new core_1[(_0x33a78d(0xbd))](BulkComponentsRetriever[_0x33a78d(0xd5)]);}async['retrieveComponents'](_0x31f818){const _0x1025ba=a259_0x2f0ae5,_0x155df2=new salesforce_1['QueryBuilder']()[_0x1025ba(0xb5)]('Id',constants_1['FLOSUM_NAMESPACE']+_0x1025ba(0xe3)+constants_1['FLOSUM_NAMESPACE']+_0x1025ba(0xdd),constants_1[_0x1025ba(0xf1)]+_0x1025ba(0xe6))[_0x1025ba(0xc9)](constants_1[_0x1025ba(0xf1)]+_0x1025ba(0xb6))[_0x1025ba(0xe7)](_0x1025ba(0xec),{'ids':_0x31f818}),_0x21a1d5=new salesforce_1[(_0x1025ba(0xd9))]({'api':salesforce_1[_0x1025ba(0xeb)][_0x1025ba(0xb9)],'queryBuilder':_0x155df2,'instance':this[_0x1025ba(0xc2)],'isTooling':![]});do{const {records:_0x1092e6}=await _0x21a1d5[_0x1025ba(0xb3)]();for(const _0x4a53d6 of _0x1092e6){this[_0x1025ba(0xc5)][_0x1025ba(0xb4)](_0x4a53d6['Id'],{'fileName':_0x4a53d6[constants_1['FLOSUM_NAMESPACE']+_0x1025ba(0xcd)][constants_1[_0x1025ba(0xf1)]+_0x1025ba(0xdd)],'fileType':'','body':'','version':_0x4a53d6[constants_1[_0x1025ba(0xf1)]+_0x1025ba(0xe6)]});}}while(!_0x21a1d5['getIsDone']());}async['retrieveAttachments'](_0x1bec24){const _0x4f560b=a259_0x2f0ae5,_0x4ea1dd=new salesforce_1[(_0x4f560b(0xf3))]()['select'](_0x4f560b(0xc6),_0x4f560b(0xf2),_0x4f560b(0xd8))[_0x4f560b(0xc9)]('Attachment')[_0x4f560b(0xe7)](_0x4f560b(0xd1),{'ids':_0x1bec24});!await fs_internal_1['FS'][_0x4f560b(0xe4)](path_1['tmpPath'])&&await(0x0,promises_1['mkdir'])(path_1[_0x4f560b(0xe0)],{'recursive':!![]});const _0x2effc1=new salesforce_1[(_0x4f560b(0xf6))]({'instance':this[_0x4f560b(0xc2)],'api':salesforce_1[_0x4f560b(0xeb)][_0x4f560b(0xb9)],'pollInterval':0x1388,'queryBuilder':_0x4ea1dd,'objectName':_0x4f560b(0xf4),'contentType':salesforce_1[_0x4f560b(0xd7)][_0x4f560b(0xb8)],'jobOperation':salesforce_1[_0x4f560b(0xef)][_0x4f560b(0xea)],'tmpPath':path_1[_0x4f560b(0xe0)]});do{const _0x58c3ea=await _0x2effc1['execute']();if(!_0x58c3ea)break;const _0x43c614=new salesforce_1[(_0x4f560b(0xca))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x5672d4,ParentId:_0xdf07a8,Body:_0x28ed69}of _0x58c3ea[_0x4f560b(0xc1)](_0x43c614)){const _0x2f86bc=this[_0x4f560b(0xc5)][_0x4f560b(0xdb)](_0xdf07a8);if(!_0x2f86bc){this[_0x4f560b(0xe8)][_0x4f560b(0xc8)]('Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.',_0xdf07a8,_0x5672d4);continue;}_0x2f86bc[_0x4f560b(0xcf)]=_0x28ed69,_0x2f86bc[_0x4f560b(0xda)]=_0x5672d4;}}while(!_0x2effc1['getIsDone']());}async['retrieve'](){const _0x39f82f=a259_0x2f0ae5;do{const _0x1a932b=this[_0x39f82f(0xba)][_0x39f82f(0xcb)](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x39f82f(0xe1)](_0x1a932b),await this[_0x39f82f(0xdf)](_0x1a932b);}while(this[_0x39f82f(0xba)]['length']);return[...this[_0x39f82f(0xc5)][_0x39f82f(0xc3)]()];}}exports[a259_0x2f0ae5(0xbe)]=BulkComponentsRetriever;