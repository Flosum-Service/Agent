const a247_0x371464=a247_0x3554;(function(_0x263125,_0x1c841f){const _0x77906c=a247_0x3554,_0x705638=_0x263125();while(!![]){try{const _0x4cfbe6=-parseInt(_0x77906c(0xe7))/0x1*(parseInt(_0x77906c(0xf0))/0x2)+-parseInt(_0x77906c(0xfc))/0x3+-parseInt(_0x77906c(0xff))/0x4*(-parseInt(_0x77906c(0xd9))/0x5)+-parseInt(_0x77906c(0x10c))/0x6+parseInt(_0x77906c(0xf3))/0x7*(-parseInt(_0x77906c(0xe1))/0x8)+-parseInt(_0x77906c(0x104))/0x9*(parseInt(_0x77906c(0xf6))/0xa)+parseInt(_0x77906c(0xe0))/0xb*(parseInt(_0x77906c(0xe3))/0xc);if(_0x4cfbe6===_0x1c841f)break;else _0x705638['push'](_0x705638['shift']());}catch(_0x353cbd){_0x705638['push'](_0x705638['shift']());}}}(a247_0x5741,0xc4f5b));const a247_0x5ca612=(function(){let _0x4c20dd=!![];return function(_0x11b71a,_0x209624){const _0x5f1cfe=_0x4c20dd?function(){const _0x5ed8c3=a247_0x3554;if(_0x209624){const _0x321968=_0x209624[_0x5ed8c3(0xf8)](_0x11b71a,arguments);return _0x209624=null,_0x321968;}}:function(){};return _0x4c20dd=![],_0x5f1cfe;};}()),a247_0x84b0b4=a247_0x5ca612(this,function(){const _0x241099=a247_0x3554;return a247_0x84b0b4[_0x241099(0x107)]()[_0x241099(0xdf)](_0x241099(0x101))[_0x241099(0x107)]()['constructor'](a247_0x84b0b4)[_0x241099(0xdf)](_0x241099(0x101));});a247_0x84b0b4();function a247_0x3554(_0x2738ea,_0x36c282){const _0x18b056=a247_0x5741();return a247_0x3554=function(_0x84b0b4,_0x5ca612){_0x84b0b4=_0x84b0b4-0xd6;let _0x5741e5=_0x18b056[_0x84b0b4];return _0x5741e5;},a247_0x3554(_0x2738ea,_0x36c282);}'use strict';function a247_0x5741(){const _0x3e6232=['Component__r','@flosum/salesforce','error','BulkXmlStreamParser','Bulk1JobOperation','search','29447eTbbYV','16ZEFstb','../../../../constants','23412LZPyao','components','Version__c','where','1404814WmEQBT','__esModule','fileType','execute','Attachment','from','retrieve','Component_History__c','Component__r.','2srYkQc','Query','length','2936591WlIRel','request','Component_Name__c','1365980fgLlnN','FLOSUM_NAMESPACE','apply','SalesforceConstants','BulkComponentsRetriever','CompositeRetrieveData','480984iWEntn','QueryBuilder','retrieveComponents','122524zLcYXQ','Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.','(((.+)+)+)+$','name','getIsDone','99SiLvSv','ParentId','Name','toString','APPLICATION_XML','Body','API','set','5077650OgEHSO','retrieveAttachments','select','get','ids','Id\x20IN\x20(:ids)','55vaglEO'];a247_0x5741=function(){return _0x3e6232;};return a247_0x5741();}Object['defineProperty'](exports,a247_0x371464(0xe8),{'value':!![]}),exports[a247_0x371464(0xfa)]=void 0x0;const salesforce_1=require(a247_0x371464(0xdb)),core_1=require('../../../../core'),constants_1=require(a247_0x371464(0xe2)),BINARY_FIELDS=[a247_0x371464(0x109)],MAX_IDS_CHUNK_LENGTH=0xfa0;class BulkComponentsRetriever{constructor({request:_0x47fcae,ids:_0x49f656}){const _0x3e74e8=a247_0x371464;this['components']=new Map(),this[_0x3e74e8(0xf4)]=_0x47fcae,this[_0x3e74e8(0xd7)]=_0x49f656,this['logger']=new core_1['Logger'](BulkComponentsRetriever[_0x3e74e8(0x102)]);}async[a247_0x371464(0xfe)](_0x90567b){const _0x314471=a247_0x371464,_0x15cf6f=new salesforce_1[(_0x314471(0xfd))]()[_0x314471(0x10e)]('Id',constants_1['FLOSUM_NAMESPACE']+_0x314471(0xef)+constants_1[_0x314471(0xf7)]+_0x314471(0xf5),constants_1[_0x314471(0xf7)]+'Version__c')[_0x314471(0xec)](constants_1['FLOSUM_NAMESPACE']+_0x314471(0xee))[_0x314471(0xe6)](_0x314471(0xd8),{'ids':_0x90567b}),_0x315d8e=new salesforce_1[(_0x314471(0xfb))]({'api':salesforce_1['SalesforceConstants']['API'],'queryBuilder':_0x15cf6f,'instance':this[_0x314471(0xf4)],'isTooling':![]});do{const {records:_0x3df119}=await _0x315d8e[_0x314471(0xea)]();for(const _0x40550d of _0x3df119){this[_0x314471(0xe4)][_0x314471(0x10b)](_0x40550d['Id'],{'fileName':_0x40550d[constants_1[_0x314471(0xf7)]+_0x314471(0xda)][constants_1[_0x314471(0xf7)]+_0x314471(0xf5)],'fileType':'','body':'','version':_0x40550d[constants_1[_0x314471(0xf7)]+_0x314471(0xe5)]});}}while(!_0x315d8e['getIsDone']());}async[a247_0x371464(0x10d)](_0x49f6d0){const _0x5bf473=a247_0x371464,_0x28a0b6=new salesforce_1[(_0x5bf473(0xfd))]()['select']('Body',_0x5bf473(0x106),_0x5bf473(0x105))[_0x5bf473(0xec)](_0x5bf473(0xeb))[_0x5bf473(0xe6)]('ParentId\x20IN\x20(:ids)',{'ids':_0x49f6d0}),_0x366ddc=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x5bf473(0xf4)],'api':salesforce_1[_0x5bf473(0xf9)][_0x5bf473(0x10a)],'pollInterval':0x1388,'queryBuilder':_0x28a0b6,'objectName':_0x5bf473(0xeb),'contentType':salesforce_1['BulkV1QueryContentType'][_0x5bf473(0x108)],'jobOperation':salesforce_1[_0x5bf473(0xde)][_0x5bf473(0xf1)]});do{const _0x38ce01=await _0x366ddc['execute']();if(!_0x38ce01)break;const _0x17b3d2=new salesforce_1[(_0x5bf473(0xdd))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x45d5fb,ParentId:_0x2cc2e8,Body:_0x4d1eed}of _0x38ce01['pipe'](_0x17b3d2)){const _0x4c4544=this[_0x5bf473(0xe4)][_0x5bf473(0xd6)](_0x2cc2e8);if(!_0x4c4544){this['logger'][_0x5bf473(0xdc)](_0x5bf473(0x100),_0x2cc2e8,_0x45d5fb);continue;}_0x4c4544['body']=_0x4d1eed,_0x4c4544[_0x5bf473(0xe9)]=_0x45d5fb;}}while(!_0x366ddc[_0x5bf473(0x103)]());}async[a247_0x371464(0xed)](){const _0x41f457=a247_0x371464;do{const _0x4b455d=this['ids']['splice'](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x41f457(0xfe)](_0x4b455d),await this['retrieveAttachments'](_0x4b455d);}while(this[_0x41f457(0xd7)][_0x41f457(0xf2)]);return[...this[_0x41f457(0xe4)]['values']()];}}exports['BulkComponentsRetriever']=BulkComponentsRetriever;