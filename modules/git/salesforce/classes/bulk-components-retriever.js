const a257_0x21fa7f=a257_0x1553;(function(_0x101b52,_0x36bbfe){const _0x2f9561=a257_0x1553,_0x4cf5ac=_0x101b52();while(!![]){try{const _0x4f4fae=parseInt(_0x2f9561(0x125))/0x1+parseInt(_0x2f9561(0x145))/0x2+-parseInt(_0x2f9561(0x147))/0x3+parseInt(_0x2f9561(0x13a))/0x4+parseInt(_0x2f9561(0x11e))/0x5*(-parseInt(_0x2f9561(0x127))/0x6)+parseInt(_0x2f9561(0x11f))/0x7+parseInt(_0x2f9561(0x144))/0x8;if(_0x4f4fae===_0x36bbfe)break;else _0x4cf5ac['push'](_0x4cf5ac['shift']());}catch(_0x5e8f49){_0x4cf5ac['push'](_0x4cf5ac['shift']());}}}(a257_0xf7c9,0xeab00));const a257_0x337346=(function(){let _0x3e8171=!![];return function(_0x36d9ae,_0x2173bc){const _0x30a001=_0x3e8171?function(){const _0x1019e3=a257_0x1553;if(_0x2173bc){const _0x3ad6d5=_0x2173bc[_0x1019e3(0x143)](_0x36d9ae,arguments);return _0x2173bc=null,_0x3ad6d5;}}:function(){};return _0x3e8171=![],_0x30a001;};}()),a257_0x5858a2=a257_0x337346(this,function(){const _0x15d93b=a257_0x1553;return a257_0x5858a2[_0x15d93b(0x120)]()[_0x15d93b(0x12a)](_0x15d93b(0x149))[_0x15d93b(0x120)]()[_0x15d93b(0x123)](a257_0x5858a2)[_0x15d93b(0x12a)](_0x15d93b(0x149));});a257_0x5858a2();'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a257_0x21fa7f(0x12d)]=void 0x0;function a257_0x1553(_0x26076f,_0x16dd0e){const _0x266e9f=a257_0xf7c9();return a257_0x1553=function(_0x5858a2,_0x337346){_0x5858a2=_0x5858a2-0x11e;let _0xf7c9df=_0x266e9f[_0x5858a2];return _0xf7c9df;},a257_0x1553(_0x26076f,_0x16dd0e);}const salesforce_1=require(a257_0x21fa7f(0x128)),core_1=require(a257_0x21fa7f(0x150)),constants_1=require(a257_0x21fa7f(0x121)),BINARY_FIELDS=[a257_0x21fa7f(0x13c)],MAX_IDS_CHUNK_LENGTH=0xfa0;function a257_0xf7c9(){const _0x18c54a=['pipe','Component_History__c','Parent\x20record\x20(%s)\x20for\x20file\x20(%s)\x20was\x20not\x20found.','error','retrieveComponents','body','BulkXmlStreamParser','ids','2419184HhOpFC','CompositeRetrieveData','Body','ParentId','components','length','splice','name','APPLICATION_XML','apply','14804872CEDWXz','2223156yoIkVb','QueryBuilder','2934030TtCxRY','getIsDone','(((.+)+)+)+$','Id\x20IN\x20(:ids)','Logger','FLOSUM_NAMESPACE','select','retrieve','Attachment','../../../../core','Query','9030235HCqEfk','142625Ufxciu','toString','../../../../constants','request','constructor','Component__r','157979tdXvhM','retrieveAttachments','6YWeQtC','@flosum/salesforce','logger','search','where','get','BulkComponentsRetriever','execute','API','from','Name'];a257_0xf7c9=function(){return _0x18c54a;};return a257_0xf7c9();}class BulkComponentsRetriever{constructor({request:_0x507baf,ids:_0xa8620a}){const _0x251f30=a257_0x21fa7f;this[_0x251f30(0x13e)]=new Map(),this[_0x251f30(0x122)]=_0x507baf,this[_0x251f30(0x139)]=_0xa8620a,this[_0x251f30(0x129)]=new core_1[(_0x251f30(0x14b))](BulkComponentsRetriever[_0x251f30(0x141)]);}async[a257_0x21fa7f(0x136)](_0x3a21ee){const _0x570cf6=a257_0x21fa7f,_0x855517=new salesforce_1[(_0x570cf6(0x146))]()[_0x570cf6(0x14d)]('Id',constants_1[_0x570cf6(0x14c)]+'Component__r.'+constants_1[_0x570cf6(0x14c)]+'Component_Name__c',constants_1['FLOSUM_NAMESPACE']+'Version__c')[_0x570cf6(0x130)](constants_1[_0x570cf6(0x14c)]+_0x570cf6(0x133))['where'](_0x570cf6(0x14a),{'ids':_0x3a21ee}),_0xeb76fe=new salesforce_1[(_0x570cf6(0x13b))]({'api':salesforce_1['SalesforceConstants'][_0x570cf6(0x12f)],'queryBuilder':_0x855517,'instance':this[_0x570cf6(0x122)],'isTooling':![]});do{const {records:_0x149ccc}=await _0xeb76fe['execute']();for(const _0x11f4ed of _0x149ccc){this['components']['set'](_0x11f4ed['Id'],{'fileName':_0x11f4ed[constants_1[_0x570cf6(0x14c)]+_0x570cf6(0x124)][constants_1[_0x570cf6(0x14c)]+'Component_Name__c'],'fileType':'','body':'','version':_0x11f4ed[constants_1['FLOSUM_NAMESPACE']+'Version__c']});}}while(!_0xeb76fe['getIsDone']());}async[a257_0x21fa7f(0x126)](_0x100016){const _0x2f0ed3=a257_0x21fa7f,_0x2e597d=new salesforce_1[(_0x2f0ed3(0x146))]()[_0x2f0ed3(0x14d)]('Body',_0x2f0ed3(0x131),_0x2f0ed3(0x13d))['from']('Attachment')[_0x2f0ed3(0x12b)]('ParentId\x20IN\x20(:ids)',{'ids':_0x100016}),_0x166706=new salesforce_1['Bulk1RetrieveData']({'instance':this[_0x2f0ed3(0x122)],'api':salesforce_1['SalesforceConstants'][_0x2f0ed3(0x12f)],'pollInterval':0x1388,'queryBuilder':_0x2e597d,'objectName':_0x2f0ed3(0x14f),'contentType':salesforce_1['BulkV1QueryContentType'][_0x2f0ed3(0x142)],'jobOperation':salesforce_1['Bulk1JobOperation'][_0x2f0ed3(0x151)]});do{const _0x567142=await _0x166706[_0x2f0ed3(0x12e)]();if(!_0x567142)break;const _0x3104e0=new salesforce_1[(_0x2f0ed3(0x138))]({'binaryFields':BINARY_FIELDS});for await(const {Name:_0x5a8317,ParentId:_0x2590e3,Body:_0x169dff}of _0x567142[_0x2f0ed3(0x132)](_0x3104e0)){const _0x124493=this['components'][_0x2f0ed3(0x12c)](_0x2590e3);if(!_0x124493){this[_0x2f0ed3(0x129)][_0x2f0ed3(0x135)](_0x2f0ed3(0x134),_0x2590e3,_0x5a8317);continue;}_0x124493[_0x2f0ed3(0x137)]=_0x169dff,_0x124493['fileType']=_0x5a8317;}}while(!_0x166706[_0x2f0ed3(0x148)]());}async[a257_0x21fa7f(0x14e)](){const _0x1b4f50=a257_0x21fa7f;do{const _0x3e7295=this[_0x1b4f50(0x139)][_0x1b4f50(0x140)](0x0,MAX_IDS_CHUNK_LENGTH);await this[_0x1b4f50(0x136)](_0x3e7295),await this['retrieveAttachments'](_0x3e7295);}while(this[_0x1b4f50(0x139)][_0x1b4f50(0x13f)]);return[...this[_0x1b4f50(0x13e)]['values']()];}}exports[a257_0x21fa7f(0x12d)]=BulkComponentsRetriever;