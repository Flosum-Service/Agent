const a268_0x487380=a268_0xfc57;function a268_0xfc57(_0x115cf5,_0x597017){const _0x7ad58e=a268_0x488f();return a268_0xfc57=function(_0x3cab13,_0x54484d){_0x3cab13=_0x3cab13-0x1a1;let _0x488fa4=_0x7ad58e[_0x3cab13];return _0x488fa4;},a268_0xfc57(_0x115cf5,_0x597017);}(function(_0x16b598,_0x4ca403){const _0x4a2c5b=a268_0xfc57,_0x3a35fa=_0x16b598();while(!![]){try{const _0x31f05a=parseInt(_0x4a2c5b(0x1a5))/0x1+parseInt(_0x4a2c5b(0x1be))/0x2+-parseInt(_0x4a2c5b(0x1a1))/0x3+parseInt(_0x4a2c5b(0x1b9))/0x4+parseInt(_0x4a2c5b(0x1a6))/0x5+parseInt(_0x4a2c5b(0x1bd))/0x6+parseInt(_0x4a2c5b(0x1cd))/0x7*(-parseInt(_0x4a2c5b(0x1d0))/0x8);if(_0x31f05a===_0x4ca403)break;else _0x3a35fa['push'](_0x3a35fa['shift']());}catch(_0x295e85){_0x3a35fa['push'](_0x3a35fa['shift']());}}}(a268_0x488f,0x706cb));const a268_0x54484d=(function(){let _0x1b941d=!![];return function(_0x51ac11,_0x451e0a){const _0x15fad2=_0x1b941d?function(){if(_0x451e0a){const _0x4106de=_0x451e0a['apply'](_0x51ac11,arguments);return _0x451e0a=null,_0x4106de;}}:function(){};return _0x1b941d=![],_0x15fad2;};}()),a268_0x3cab13=a268_0x54484d(this,function(){const _0x39cc95=a268_0xfc57;return a268_0x3cab13['toString']()[_0x39cc95(0x1bf)](_0x39cc95(0x1af))[_0x39cc95(0x1c3)]()[_0x39cc95(0x1ab)](a268_0x3cab13)['search'](_0x39cc95(0x1af));});function a268_0x488f(){const _0x418c42=['isExistsPath','join','243803occLwp','1883975MHDkoV','readFile','jobState','setError','status','constructor','init','writeFile','FsUtils','(((.+)+)+)+$','warnings','IN_PROGRESS','fs/promises','stringify','Job\x20not\x20found.','utf-8','push','create','then','3009936FqTsGe','../../../../constants/job','getTime','getJobStatePath','2478342OSYgYX','852808LyzOml','search','completedDate','../enums/logger.enums','addWarning','toString','createdDate','parse','COMPLETED','statePath','path','JobStatus','FAILED','getJobState','setCompleted','12245506JoQgXU','defineProperty','QUEUED','8BvXiLK','__esModule','default','8082waFowO','update'];a268_0x488f=function(){return _0x418c42;};return a268_0x488f();}a268_0x3cab13();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x20eb80){const _0x29be7d=a268_0xfc57;return _0x20eb80&&_0x20eb80[_0x29be7d(0x1d1)]?_0x20eb80:{'default':_0x20eb80};};Object[a268_0x487380(0x1ce)](exports,'__esModule',{'value':!![]});const logger_enums_1=require(a268_0x487380(0x1c1)),path_1=__importDefault(require(a268_0x487380(0x1c8))),promises_1=require(a268_0x487380(0x1b2)),utils_1=require('@flosum/utils'),job_1=require(a268_0x487380(0x1ba));class StateManager{constructor(_0x4b0a8f){const _0x57e8e9=a268_0x487380;this[_0x57e8e9(0x1c7)]=StateManager[_0x57e8e9(0x1bc)](_0x4b0a8f);}static[a268_0x487380(0x1bc)](_0x126104){const _0x2d05ee=a268_0x487380;return path_1[_0x2d05ee(0x1d2)][_0x2d05ee(0x1a4)](_0x126104,job_1['JOB_LOG_STATE_FILENAME']);}static async[a268_0x487380(0x1b7)](_0x13b6cf,_0x41a910){const _0x38223a=a268_0x487380,_0x3eeba4=StateManager[_0x38223a(0x1bc)](_0x13b6cf),_0x4fb60b={'id':_0x41a910,'status':logger_enums_1[_0x38223a(0x1c9)][_0x38223a(0x1cf)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x38223a(0x1ad)])(_0x3eeba4,JSON['stringify'](_0x4fb60b));}static async[a268_0x487380(0x1cb)](_0x561096){const _0x501c16=a268_0x487380,_0x2eba67=StateManager['getJobStatePath'](_0x561096);if(await utils_1[_0x501c16(0x1ae)][_0x501c16(0x1a3)](_0x2eba67))return(0x0,promises_1[_0x501c16(0x1a7)])(_0x2eba67,_0x501c16(0x1b5))[_0x501c16(0x1b8)](JSON[_0x501c16(0x1c5)]);throw new Error(_0x501c16(0x1b4));}async[a268_0x487380(0x1a2)](){const _0x37e111=a268_0x487380;await(0x0,promises_1['writeFile'])(this[_0x37e111(0x1c7)],JSON[_0x37e111(0x1b3)](this['jobState']));}async[a268_0x487380(0x1ac)](){const _0x5465c2=a268_0x487380;return this['jobState']=await(0x0,promises_1[_0x5465c2(0x1a7)])(this['statePath'],_0x5465c2(0x1b5))[_0x5465c2(0x1b8)](JSON[_0x5465c2(0x1c5)]),this;}async['setInProgress'](){const _0x831252=a268_0x487380;this['jobState'][_0x831252(0x1aa)]=logger_enums_1[_0x831252(0x1c9)][_0x831252(0x1b1)],this[_0x831252(0x1a8)][_0x831252(0x1c4)]=new Date()[_0x831252(0x1bb)](),await this['update']();}async[a268_0x487380(0x1cc)](){const _0x124989=a268_0x487380;this[_0x124989(0x1a8)]['status']=logger_enums_1['JobStatus'][_0x124989(0x1c6)],this[_0x124989(0x1a8)][_0x124989(0x1c0)]=new Date()[_0x124989(0x1bb)](),await this[_0x124989(0x1a2)]();}async[a268_0x487380(0x1a9)]({message:_0x397be1}){const _0x1bc548=a268_0x487380;this[_0x1bc548(0x1a8)][_0x1bc548(0x1aa)]=logger_enums_1[_0x1bc548(0x1c9)][_0x1bc548(0x1ca)],this[_0x1bc548(0x1a8)][_0x1bc548(0x1c0)]=new Date()[_0x1bc548(0x1bb)](),this['jobState']['error']=_0x397be1,await this[_0x1bc548(0x1a2)]();}[a268_0x487380(0x1c2)](_0x5413ab){const _0x43f19a=a268_0x487380;return this[_0x43f19a(0x1a8)][_0x43f19a(0x1b0)][_0x43f19a(0x1b6)](_0x5413ab),this[_0x43f19a(0x1a2)]();}}exports[a268_0x487380(0x1d2)]=StateManager;