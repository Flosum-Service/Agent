const a268_0x17a86f=a268_0x11e0;(function(_0x114407,_0x43af97){const _0x5b660b=a268_0x11e0,_0x4a4c11=_0x114407();while(!![]){try{const _0x2b1fb3=-parseInt(_0x5b660b(0x211))/0x1+-parseInt(_0x5b660b(0x1ef))/0x2+parseInt(_0x5b660b(0x1f2))/0x3*(-parseInt(_0x5b660b(0x214))/0x4)+parseInt(_0x5b660b(0x205))/0x5*(-parseInt(_0x5b660b(0x219))/0x6)+parseInt(_0x5b660b(0x220))/0x7*(-parseInt(_0x5b660b(0x222))/0x8)+-parseInt(_0x5b660b(0x21d))/0x9*(parseInt(_0x5b660b(0x1f4))/0xa)+-parseInt(_0x5b660b(0x1f1))/0xb*(-parseInt(_0x5b660b(0x206))/0xc);if(_0x2b1fb3===_0x43af97)break;else _0x4a4c11['push'](_0x4a4c11['shift']());}catch(_0x1db491){_0x4a4c11['push'](_0x4a4c11['shift']());}}}(a268_0x10e7,0x1f7b8));const a268_0x5ee920=(function(){let _0x15661b=!![];return function(_0x2a90be,_0x3a3bb6){const _0x400a1c=_0x15661b?function(){const _0x15c047=a268_0x11e0;if(_0x3a3bb6){const _0xbc4055=_0x3a3bb6[_0x15c047(0x1f9)](_0x2a90be,arguments);return _0x3a3bb6=null,_0xbc4055;}}:function(){};return _0x15661b=![],_0x400a1c;};}()),a268_0xa1152a=a268_0x5ee920(this,function(){const _0x4d076f=a268_0x11e0;return a268_0xa1152a[_0x4d076f(0x208)]()['search'](_0x4d076f(0x1f3))[_0x4d076f(0x208)]()[_0x4d076f(0x20c)](a268_0xa1152a)[_0x4d076f(0x1ff)](_0x4d076f(0x1f3));});a268_0xa1152a();function a268_0x10e7(){const _0x4ba0b6=['FsUtils','6BKBAed','parse','../../../../constants/job','IN_PROGRESS','62559tcRjSv','FAILED','status','1281aRBdwF','setCompleted','8984YpwIig','407238hDloTe','update','141251wqivps','3dnttbq','(((.+)+)+)+$','290CKkFVJ','getJobStatePath','fs/promises','init','JobStatus','apply','isExistsPath','readFile','addWarning','then','COMPLETED','search','getTime','QUEUED','stringify','setError','__esModule','704105qZdcgU','1008YPBcER','utf-8','toString','writeFile','JOB_LOG_STATE_FILENAME','getJobState','constructor','__importDefault','Job\x20not\x20found.','setInProgress','error','178647kjLTlT','jobState','statePath','78068GrroFC','path','default','warnings'];a268_0x10e7=function(){return _0x4ba0b6;};return a268_0x10e7();}'use strict';function a268_0x11e0(_0x1c741f,_0xf46400){const _0x53ea01=a268_0x10e7();return a268_0x11e0=function(_0xa1152a,_0x5ee920){_0xa1152a=_0xa1152a-0x1ef;let _0x10e7d2=_0x53ea01[_0xa1152a];return _0x10e7d2;},a268_0x11e0(_0x1c741f,_0xf46400);}var __importDefault=this&&this[a268_0x17a86f(0x20d)]||function(_0x1f9401){const _0x11b594=a268_0x17a86f;return _0x1f9401&&_0x1f9401[_0x11b594(0x204)]?_0x1f9401:{'default':_0x1f9401};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a268_0x17a86f(0x215))),promises_1=require(a268_0x17a86f(0x1f6)),utils_1=require('@flosum/utils'),job_1=require(a268_0x17a86f(0x21b));class StateManager{constructor(_0x21d53c){const _0x391ac1=a268_0x17a86f;this[_0x391ac1(0x213)]=StateManager['getJobStatePath'](_0x21d53c);}static['getJobStatePath'](_0x12ca7f){const _0x1602ef=a268_0x17a86f;return path_1[_0x1602ef(0x216)]['join'](_0x12ca7f,job_1[_0x1602ef(0x20a)]);}static async['create'](_0x27241a,_0x1a46bd){const _0x38264b=a268_0x17a86f,_0x22529f=StateManager[_0x38264b(0x1f5)](_0x27241a),_0x108fdc={'id':_0x1a46bd,'status':logger_enums_1['JobStatus'][_0x38264b(0x201)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x38264b(0x209)])(_0x22529f,JSON[_0x38264b(0x202)](_0x108fdc));}static async[a268_0x17a86f(0x20b)](_0x278c6a){const _0x14e7a6=a268_0x17a86f,_0x3c6321=StateManager[_0x14e7a6(0x1f5)](_0x278c6a);if(await utils_1[_0x14e7a6(0x218)][_0x14e7a6(0x1fa)](_0x3c6321))return(0x0,promises_1[_0x14e7a6(0x1fb)])(_0x3c6321,_0x14e7a6(0x207))[_0x14e7a6(0x1fd)](JSON[_0x14e7a6(0x21a)]);throw new Error(_0x14e7a6(0x20e));}async[a268_0x17a86f(0x1f0)](){const _0x28f0ce=a268_0x17a86f;await(0x0,promises_1[_0x28f0ce(0x209)])(this[_0x28f0ce(0x213)],JSON[_0x28f0ce(0x202)](this['jobState']));}async[a268_0x17a86f(0x1f7)](){const _0x325614=a268_0x17a86f;return this['jobState']=await(0x0,promises_1[_0x325614(0x1fb)])(this[_0x325614(0x213)],'utf-8')['then'](JSON[_0x325614(0x21a)]),this;}async[a268_0x17a86f(0x20f)](){const _0x4f4708=a268_0x17a86f;this[_0x4f4708(0x212)]['status']=logger_enums_1[_0x4f4708(0x1f8)][_0x4f4708(0x21c)],this[_0x4f4708(0x212)]['createdDate']=new Date()['getTime'](),await this[_0x4f4708(0x1f0)]();}async[a268_0x17a86f(0x221)](){const _0x5159b5=a268_0x17a86f;this[_0x5159b5(0x212)]['status']=logger_enums_1['JobStatus'][_0x5159b5(0x1fe)],this['jobState']['completedDate']=new Date()['getTime'](),await this[_0x5159b5(0x1f0)]();}async[a268_0x17a86f(0x203)]({message:_0x27f99c}){const _0x15a2b7=a268_0x17a86f;this[_0x15a2b7(0x212)][_0x15a2b7(0x21f)]=logger_enums_1['JobStatus'][_0x15a2b7(0x21e)],this[_0x15a2b7(0x212)]['completedDate']=new Date()[_0x15a2b7(0x200)](),this[_0x15a2b7(0x212)][_0x15a2b7(0x210)]=_0x27f99c,await this[_0x15a2b7(0x1f0)]();}[a268_0x17a86f(0x1fc)](_0x16d164){const _0x2c09d1=a268_0x17a86f;return this[_0x2c09d1(0x212)][_0x2c09d1(0x217)]['push'](_0x16d164),this[_0x2c09d1(0x1f0)]();}}exports['default']=StateManager;