const a267_0x3f63c1=a267_0x1910;(function(_0x3a82c6,_0x234bf2){const _0x5347ef=a267_0x1910,_0x49fc33=_0x3a82c6();while(!![]){try{const _0x2f748e=parseInt(_0x5347ef(0x8c))/0x1*(parseInt(_0x5347ef(0xa0))/0x2)+-parseInt(_0x5347ef(0x93))/0x3*(-parseInt(_0x5347ef(0x94))/0x4)+parseInt(_0x5347ef(0x91))/0x5+parseInt(_0x5347ef(0xa7))/0x6*(-parseInt(_0x5347ef(0xaa))/0x7)+parseInt(_0x5347ef(0xb6))/0x8*(parseInt(_0x5347ef(0x8e))/0x9)+-parseInt(_0x5347ef(0x8d))/0xa*(-parseInt(_0x5347ef(0xa8))/0xb)+parseInt(_0x5347ef(0xa4))/0xc*(-parseInt(_0x5347ef(0xbb))/0xd);if(_0x2f748e===_0x234bf2)break;else _0x49fc33['push'](_0x49fc33['shift']());}catch(_0x576fb1){_0x49fc33['push'](_0x49fc33['shift']());}}}(a267_0xba66,0x87d7d));const a267_0x3056be=(function(){let _0x247120=!![];return function(_0x2eacce,_0x356906){const _0x4ebe40=_0x247120?function(){const _0x24c0f1=a267_0x1910;if(_0x356906){const _0x5d8d26=_0x356906[_0x24c0f1(0x99)](_0x2eacce,arguments);return _0x356906=null,_0x5d8d26;}}:function(){};return _0x247120=![],_0x4ebe40;};}()),a267_0x51374e=a267_0x3056be(this,function(){const _0x256de4=a267_0x1910;return a267_0x51374e['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](a267_0x51374e)[_0x256de4(0x90)](_0x256de4(0xb5));});function a267_0xba66(){const _0x4fef33=['utf-8','Job\x20not\x20found.','FAILED','status','setCompleted','(((.+)+)+)+$','304HqkNDz','statePath','join','default','getJobState','20892846mjXAov','855553MPftWX','10XRkuBa','85149tjSDZv','JOB_LOG_STATE_FILENAME','search','1344600hgXTmw','update','105FcgMgu','32452qPzium','getJobStatePath','fs/promises','IN_PROGRESS','stringify','apply','JobStatus','QUEUED','create','completedDate','FsUtils','setInProgress','2ciMTcp','__importDefault','path','__esModule','12FXQIGa','then','../enums/logger.enums','2104518wnBAzF','8209982itznXV','jobState','7ShYHaz','readFile','writeFile','getTime','setError','addWarning'];a267_0xba66=function(){return _0x4fef33;};return a267_0xba66();}a267_0x51374e();'use strict';var __importDefault=this&&this[a267_0x3f63c1(0xa1)]||function(_0x5e3e08){const _0x2df1ba=a267_0x3f63c1;return _0x5e3e08&&_0x5e3e08[_0x2df1ba(0xa3)]?_0x5e3e08:{'default':_0x5e3e08};};function a267_0x1910(_0x2679a9,_0x1cdff2){const _0x5d617b=a267_0xba66();return a267_0x1910=function(_0x51374e,_0x3056be){_0x51374e=_0x51374e-0x8c;let _0xba663d=_0x5d617b[_0x51374e];return _0xba663d;},a267_0x1910(_0x2679a9,_0x1cdff2);}Object['defineProperty'](exports,a267_0x3f63c1(0xa3),{'value':!![]});const logger_enums_1=require(a267_0x3f63c1(0xa6)),path_1=__importDefault(require(a267_0x3f63c1(0xa2))),promises_1=require(a267_0x3f63c1(0x96)),utils_1=require('@flosum/utils'),job_1=require('../../../../constants/job');class StateManager{constructor(_0x4c6ae7){const _0x4ff403=a267_0x3f63c1;this[_0x4ff403(0xb7)]=StateManager[_0x4ff403(0x95)](_0x4c6ae7);}static['getJobStatePath'](_0xc98453){const _0x58c8ee=a267_0x3f63c1;return path_1[_0x58c8ee(0xb9)][_0x58c8ee(0xb8)](_0xc98453,job_1[_0x58c8ee(0x8f)]);}static async[a267_0x3f63c1(0x9c)](_0x253ce6,_0x1b2299){const _0x5c1010=a267_0x3f63c1,_0x13513d=StateManager[_0x5c1010(0x95)](_0x253ce6),_0x28f2df={'id':_0x1b2299,'status':logger_enums_1[_0x5c1010(0x9a)][_0x5c1010(0x9b)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x5c1010(0xac)])(_0x13513d,JSON['stringify'](_0x28f2df));}static async[a267_0x3f63c1(0xba)](_0x589564){const _0x1719d3=a267_0x3f63c1,_0x2eb938=StateManager['getJobStatePath'](_0x589564);if(await utils_1[_0x1719d3(0x9e)]['isExistsPath'](_0x2eb938))return(0x0,promises_1[_0x1719d3(0xab)])(_0x2eb938,_0x1719d3(0xb0))['then'](JSON['parse']);throw new Error(_0x1719d3(0xb1));}async[a267_0x3f63c1(0x92)](){const _0x3adca3=a267_0x3f63c1;await(0x0,promises_1[_0x3adca3(0xac)])(this[_0x3adca3(0xb7)],JSON[_0x3adca3(0x98)](this[_0x3adca3(0xa9)]));}async['init'](){const _0x1bf578=a267_0x3f63c1;return this['jobState']=await(0x0,promises_1['readFile'])(this[_0x1bf578(0xb7)],_0x1bf578(0xb0))[_0x1bf578(0xa5)](JSON['parse']),this;}async[a267_0x3f63c1(0x9f)](){const _0x50087b=a267_0x3f63c1;this[_0x50087b(0xa9)]['status']=logger_enums_1[_0x50087b(0x9a)][_0x50087b(0x97)],this[_0x50087b(0xa9)]['createdDate']=new Date()[_0x50087b(0xad)](),await this[_0x50087b(0x92)]();}async[a267_0x3f63c1(0xb4)](){const _0x246675=a267_0x3f63c1;this[_0x246675(0xa9)][_0x246675(0xb3)]=logger_enums_1['JobStatus']['COMPLETED'],this[_0x246675(0xa9)][_0x246675(0x9d)]=new Date()[_0x246675(0xad)](),await this[_0x246675(0x92)]();}async[a267_0x3f63c1(0xae)]({message:_0x1c89ed}){const _0x1730c9=a267_0x3f63c1;this[_0x1730c9(0xa9)]['status']=logger_enums_1[_0x1730c9(0x9a)][_0x1730c9(0xb2)],this[_0x1730c9(0xa9)]['completedDate']=new Date()[_0x1730c9(0xad)](),this['jobState']['error']=_0x1c89ed,await this[_0x1730c9(0x92)]();}[a267_0x3f63c1(0xaf)](_0x59d261){const _0x133797=a267_0x3f63c1;return this[_0x133797(0xa9)]['warnings']['push'](_0x59d261),this['update']();}}exports['default']=StateManager;