const a268_0x45cee8=a268_0x50bb;(function(_0x6dac5e,_0x3db298){const _0x47b0c1=a268_0x50bb,_0x403e05=_0x6dac5e();while(!![]){try{const _0x18c8b9=parseInt(_0x47b0c1(0x91))/0x1*(-parseInt(_0x47b0c1(0xa4))/0x2)+parseInt(_0x47b0c1(0xba))/0x3+-parseInt(_0x47b0c1(0xac))/0x4+-parseInt(_0x47b0c1(0x98))/0x5+parseInt(_0x47b0c1(0x90))/0x6+-parseInt(_0x47b0c1(0x95))/0x7*(-parseInt(_0x47b0c1(0xb7))/0x8)+-parseInt(_0x47b0c1(0xb5))/0x9*(-parseInt(_0x47b0c1(0x9a))/0xa);if(_0x18c8b9===_0x3db298)break;else _0x403e05['push'](_0x403e05['shift']());}catch(_0x1fee82){_0x403e05['push'](_0x403e05['shift']());}}}(a268_0x1ac6,0x8b07a));const a268_0x30a03c=(function(){let _0x2ce8d7=!![];return function(_0x54dc6c,_0x4f0d5a){const _0x1faf10=_0x2ce8d7?function(){const _0x44bd52=a268_0x50bb;if(_0x4f0d5a){const _0x4ea9c3=_0x4f0d5a[_0x44bd52(0xbf)](_0x54dc6c,arguments);return _0x4f0d5a=null,_0x4ea9c3;}}:function(){};return _0x2ce8d7=![],_0x1faf10;};}()),a268_0x14d263=a268_0x30a03c(this,function(){const _0x373661=a268_0x50bb;return a268_0x14d263[_0x373661(0xa6)]()[_0x373661(0xa1)](_0x373661(0x9e))['toString']()['constructor'](a268_0x14d263)[_0x373661(0xa1)](_0x373661(0x9e));});a268_0x14d263();function a268_0x50bb(_0x31fc61,_0x24e0a3){const _0x4f7c18=a268_0x1ac6();return a268_0x50bb=function(_0x14d263,_0x30a03c){_0x14d263=_0x14d263-0x90;let _0x1ac6ac=_0x4f7c18[_0x14d263];return _0x1ac6ac;},a268_0x50bb(_0x31fc61,_0x24e0a3);}'use strict';var __importDefault=this&&this[a268_0x45cee8(0xb4)]||function(_0xb08d2e){return _0xb08d2e&&_0xb08d2e['__esModule']?_0xb08d2e:{'default':_0xb08d2e};};Object[a268_0x45cee8(0x9d)](exports,a268_0x45cee8(0xbb),{'value':!![]});function a268_0x1ac6(){const _0x52a030=['2820Vchusw','parse','path','defineProperty','(((.+)+)+)+$','IN_PROGRESS','utf-8','search','Job\x20not\x20found.','then','1461274VrPyGW','init','toString','writeFile','push','completedDate','fs/promises','QUEUED','960476LstfnL','status','FAILED','statePath','../../../../constants/job','stringify','getJobState','getTime','__importDefault','29313ZggCAK','default','24HYTObL','JOB_LOG_STATE_FILENAME','createdDate','427662fbyKGm','__esModule','jobState','JobStatus','getJobStatePath','apply','isExistsPath','6717990fSwatW','1ejEpnn','COMPLETED','update','addWarning','984473CGsQZm','create','readFile','5311940Bvikks','warnings'];a268_0x1ac6=function(){return _0x52a030;};return a268_0x1ac6();}const logger_enums_1=require('../enums/logger.enums'),path_1=__importDefault(require(a268_0x45cee8(0x9c))),promises_1=require(a268_0x45cee8(0xaa)),utils_1=require('@flosum/utils'),job_1=require(a268_0x45cee8(0xb0));class StateManager{constructor(_0x2353f){const _0x4ef4e5=a268_0x45cee8;this[_0x4ef4e5(0xaf)]=StateManager['getJobStatePath'](_0x2353f);}static['getJobStatePath'](_0x4be2a7){const _0x31872a=a268_0x45cee8;return path_1[_0x31872a(0xb6)]['join'](_0x4be2a7,job_1[_0x31872a(0xb8)]);}static async[a268_0x45cee8(0x96)](_0xd37517,_0x497c7c){const _0x50d7fa=a268_0x45cee8,_0x1bbc20=StateManager[_0x50d7fa(0xbe)](_0xd37517),_0x1b81f5={'id':_0x497c7c,'status':logger_enums_1[_0x50d7fa(0xbd)][_0x50d7fa(0xab)],'createdDate':null,'completedDate':null,'error':null,'warnings':[]};await(0x0,promises_1[_0x50d7fa(0xa7)])(_0x1bbc20,JSON[_0x50d7fa(0xb1)](_0x1b81f5));}static async[a268_0x45cee8(0xb2)](_0x49acfc){const _0x9cfc0e=a268_0x45cee8,_0x186b13=StateManager[_0x9cfc0e(0xbe)](_0x49acfc);if(await utils_1['FsUtils'][_0x9cfc0e(0xc0)](_0x186b13))return(0x0,promises_1['readFile'])(_0x186b13,'utf-8')[_0x9cfc0e(0xa3)](JSON[_0x9cfc0e(0x9b)]);throw new Error(_0x9cfc0e(0xa2));}async[a268_0x45cee8(0x93)](){const _0x98d8ca=a268_0x45cee8;await(0x0,promises_1[_0x98d8ca(0xa7)])(this['statePath'],JSON[_0x98d8ca(0xb1)](this[_0x98d8ca(0xbc)]));}async[a268_0x45cee8(0xa5)](){const _0x324857=a268_0x45cee8;return this[_0x324857(0xbc)]=await(0x0,promises_1[_0x324857(0x97)])(this[_0x324857(0xaf)],_0x324857(0xa0))[_0x324857(0xa3)](JSON[_0x324857(0x9b)]),this;}async['setInProgress'](){const _0x128875=a268_0x45cee8;this[_0x128875(0xbc)][_0x128875(0xad)]=logger_enums_1[_0x128875(0xbd)][_0x128875(0x9f)],this[_0x128875(0xbc)][_0x128875(0xb9)]=new Date()['getTime'](),await this[_0x128875(0x93)]();}async['setCompleted'](){const _0x521dd3=a268_0x45cee8;this[_0x521dd3(0xbc)][_0x521dd3(0xad)]=logger_enums_1[_0x521dd3(0xbd)][_0x521dd3(0x92)],this['jobState'][_0x521dd3(0xa9)]=new Date()[_0x521dd3(0xb3)](),await this[_0x521dd3(0x93)]();}async['setError']({message:_0x34cc93}){const _0x4b0fc2=a268_0x45cee8;this[_0x4b0fc2(0xbc)]['status']=logger_enums_1[_0x4b0fc2(0xbd)][_0x4b0fc2(0xae)],this[_0x4b0fc2(0xbc)][_0x4b0fc2(0xa9)]=new Date()[_0x4b0fc2(0xb3)](),this['jobState']['error']=_0x34cc93,await this['update']();}[a268_0x45cee8(0x94)](_0x4d48bd){const _0x371dfc=a268_0x45cee8;return this[_0x371dfc(0xbc)][_0x371dfc(0x99)][_0x371dfc(0xa8)](_0x4d48bd),this[_0x371dfc(0x93)]();}}exports[a268_0x45cee8(0xb6)]=StateManager;