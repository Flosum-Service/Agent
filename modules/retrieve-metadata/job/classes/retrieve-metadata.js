const a314_0x2501cc=a314_0x4280;(function(_0xaeac9a,_0x43ef4c){const _0x51b5d0=a314_0x4280,_0x3a2fe6=_0xaeac9a();while(!![]){try{const _0xb8ec12=-parseInt(_0x51b5d0(0x187))/0x1+-parseInt(_0x51b5d0(0x183))/0x2*(parseInt(_0x51b5d0(0x165))/0x3)+-parseInt(_0x51b5d0(0x169))/0x4+-parseInt(_0x51b5d0(0x16f))/0x5*(-parseInt(_0x51b5d0(0x161))/0x6)+-parseInt(_0x51b5d0(0x16b))/0x7*(-parseInt(_0x51b5d0(0x189))/0x8)+-parseInt(_0x51b5d0(0x162))/0x9*(-parseInt(_0x51b5d0(0x175))/0xa)+-parseInt(_0x51b5d0(0x173))/0xb*(parseInt(_0x51b5d0(0x179))/0xc);if(_0xb8ec12===_0x43ef4c)break;else _0x3a2fe6['push'](_0x3a2fe6['shift']());}catch(_0xa944b7){_0x3a2fe6['push'](_0x3a2fe6['shift']());}}}(a314_0x2cdd,0x61c26));const a314_0x354eee=(function(){let _0x115d0e=!![];return function(_0x2b62fd,_0x27b447){const _0xe9fe0f=_0x115d0e?function(){const _0x282a41=a314_0x4280;if(_0x27b447){const _0x1012c2=_0x27b447[_0x282a41(0x17f)](_0x2b62fd,arguments);return _0x27b447=null,_0x1012c2;}}:function(){};return _0x115d0e=![],_0xe9fe0f;};}()),a314_0x1d8e43=a314_0x354eee(this,function(){const _0x4cb996=a314_0x4280;return a314_0x1d8e43['toString']()[_0x4cb996(0x168)]('(((.+)+)+)+$')[_0x4cb996(0x16d)]()[_0x4cb996(0x174)](a314_0x1d8e43)['search']('(((.+)+)+)+$');});a314_0x1d8e43();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x50712d){return _0x50712d&&_0x50712d['__esModule']?_0x50712d:{'default':_0x50712d};};function a314_0x2cdd(){const _0x46b51b=['jobStorePath','1797838ZxrcwI','logger','toString','RETRIEVE_RESULT_FOLDER_NAME','94315hOHoDy','push','retrieveResultsPath','metadataFolder','121UAhyJb','constructor','20OZxUFl','shortid','writeFile','__esModule','168444WcDogw','default','jszip','path','addWarning','fs/promises','apply','Item\x20\x27','components','stateManager','26EKBwkS','generateAsync','stringify','AuthManager','272374SQEHzG','\x27\x20exceed\x20limit\x20\x27','16gmxrvJ','create','.json','AxiosInstanceUtils','makeDir','length','init','@flosum/salesforce','join','object-sizeof','writeChunk','execute','6tTwzhM','2634219swOBHv','items','fileName','60855ailoXd','../../../shared/managers/auth.manager','RETRIEVE_RESULTS_IDS_FILENAME','search','108020toWWcK'];a314_0x2cdd=function(){return _0x46b51b;};return a314_0x2cdd();}function a314_0x4280(_0x45c005,_0x350847){const _0x27e4fd=a314_0x2cdd();return a314_0x4280=function(_0x1d8e43,_0x354eee){_0x1d8e43=_0x1d8e43-0x15e;let _0x2cdda7=_0x27e4fd[_0x1d8e43];return _0x2cdda7;},a314_0x4280(_0x45c005,_0x350847);}Object['defineProperty'](exports,a314_0x2501cc(0x178),{'value':!![]});const salesforce_1=require(a314_0x2501cc(0x190)),manifest_manger_1=__importDefault(require('./manifest-manger')),path_1=__importDefault(require(a314_0x2501cc(0x17c))),promises_1=require(a314_0x2501cc(0x17e)),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require(a314_0x2501cc(0x15e))),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require(a314_0x2501cc(0x166)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a314_0x2501cc(0x176))),jszip_1=__importDefault(require(a314_0x2501cc(0x17b)));class RetrieveMetadata{constructor(_0x389f01,_0x1c7383,_0x5684e0){const _0x38fd37=a314_0x2501cc;this[_0x38fd37(0x16a)]=_0x389f01,this[_0x38fd37(0x16c)]=_0x1c7383,this[_0x38fd37(0x182)]=_0x5684e0,this[_0x38fd37(0x172)]=path_1[_0x38fd37(0x17a)][_0x38fd37(0x191)](this[_0x38fd37(0x16a)],constants_1[_0x38fd37(0x16e)]),this[_0x38fd37(0x171)]=path_1['default'][_0x38fd37(0x191)](this[_0x38fd37(0x16a)],constants_1[_0x38fd37(0x167)]);}async['writeChunk'](_0x4a4042){const _0x54330c=a314_0x2501cc,_0x29e26d=(0x0,shortid_1[_0x54330c(0x17a)])();return await(0x0,promises_1[_0x54330c(0x177)])(path_1[_0x54330c(0x17a)][_0x54330c(0x191)](this[_0x54330c(0x172)],_0x29e26d+_0x54330c(0x18b)),JSON[_0x54330c(0x185)](_0x4a4042)),_0x29e26d;}async['execute'](){const _0x2c02b7=a314_0x2501cc,{credentials:_0x12729a,declarativeFilter:_0x23c9c6,metadataTypes:_0x467668,maxChunkSize:_0x4f7ecc,maxChunkItems:_0x5136e9,apiVersion:_0x3af9c6}=await new manifest_manger_1[(_0x2c02b7(0x17a))](this[_0x2c02b7(0x16a)])[_0x2c02b7(0x18f)](),_0x4e67d5=await salesforce_1[_0x2c02b7(0x18c)][_0x2c02b7(0x18a)](new auth_manager_1[(_0x2c02b7(0x186))](_0x12729a),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x54fdab=await retrieve_factory_1['default']['create'](_0x4e67d5,this[_0x2c02b7(0x16c)],_0x23c9c6,_0x467668,_0x3af9c6)[_0x2c02b7(0x160)]();await(0x0,fs_utils_1[_0x2c02b7(0x18d)])(this[_0x2c02b7(0x172)]);let _0x2bd189=[];const _0x542d12=[];let _0x5485ad=0x0;for(const _0x4991b9 in _0x54fdab[_0x2c02b7(0x163)]){for(const {listMetadataItem:_0x3be8d6,files:_0x3a6142}of _0x54fdab[_0x2c02b7(0x163)][_0x4991b9][_0x2c02b7(0x181)]){const _0x58de79=new jszip_1[(_0x2c02b7(0x17a))]();for(const _0x536481 in _0x3a6142){await _0x58de79['file'](_0x536481,_0x3a6142[_0x536481]);}const _0x3660a9=await _0x58de79[_0x2c02b7(0x184)]({'type':'base64','compression':'DEFLATE','compressionOptions':{'level':0x9}}),_0x4d95f7={..._0x3be8d6,'zip':_0x3660a9},_0x4f7bdc=(0x0,object_sizeof_1[_0x2c02b7(0x17a)])(_0x4d95f7);if(_0x4f7bdc>_0x4f7ecc){await this[_0x2c02b7(0x182)][_0x2c02b7(0x17d)](_0x2c02b7(0x180)+_0x3be8d6[_0x2c02b7(0x164)]+'\x27\x20size\x20\x27'+_0x4f7bdc+_0x2c02b7(0x188)+_0x4f7ecc+'\x27');continue;}if(_0x5485ad+_0x4f7bdc>_0x4f7ecc||_0x2bd189['length']>=_0x5136e9){const _0x457d13=await this[_0x2c02b7(0x15f)](_0x2bd189);_0x542d12[_0x2c02b7(0x170)](_0x457d13),_0x5485ad=0x0,_0x2bd189=[];}_0x2bd189[_0x2c02b7(0x170)](_0x4d95f7),_0x5485ad+=_0x4f7bdc;}}if(_0x2bd189[_0x2c02b7(0x18e)]){const _0x5bfefc=await this[_0x2c02b7(0x15f)](_0x2bd189);_0x542d12['push'](_0x5bfefc);}await(0x0,promises_1[_0x2c02b7(0x177)])(this[_0x2c02b7(0x171)],JSON[_0x2c02b7(0x185)](_0x542d12));}}exports[a314_0x2501cc(0x17a)]=RetrieveMetadata;