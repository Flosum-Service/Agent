const a314_0x8a4ce7=a314_0x59cb;function a314_0x43c4(){const _0x38d7f9=['init','items','(((.+)+)+)+$','1351399BFZZXW','constructor','14817672VZcZaR','makeDir','fs/promises','metadataFolder','../../constants','\x27\x20size\x20\x27','./retrieve-factory','join','base64','\x27\x20exceed\x20limit\x20\x27','create','retrieveResultsPath','writeFile','5272728kCiiJE','../../../shared/utils/fs.utils','components','1460nQMvgJ','length','./manifest-manger','1901835FVCvUD','push','@flosum/salesforce','shortid','generateAsync','addWarning','RETRIEVE_RESULTS_IDS_FILENAME','DEFLATE','path','1436966LonKaV','744492WyRheE','execute','RETRIEVE_RESULT_FOLDER_NAME','.json','stateManager','default','toString','8SrlKRB','AxiosInstanceUtils','jobStorePath','writeChunk','__esModule','apply','defineProperty','12635ultZbv','jszip','logger','__importDefault'];a314_0x43c4=function(){return _0x38d7f9;};return a314_0x43c4();}(function(_0x2d3d47,_0x144948){const _0xe16ecf=a314_0x59cb,_0x53ab92=_0x2d3d47();while(!![]){try{const _0x49bed4=-parseInt(_0xe16ecf(0xbf))/0x1+parseInt(_0xe16ecf(0xbe))/0x2+parseInt(_0xe16ecf(0xb5))/0x3+parseInt(_0xe16ecf(0xb2))/0x4*(-parseInt(_0xe16ecf(0xcd))/0x5)+-parseInt(_0xe16ecf(0xaf))/0x6+-parseInt(_0xe16ecf(0xd4))/0x7*(-parseInt(_0xe16ecf(0xc6))/0x8)+parseInt(_0xe16ecf(0xd6))/0x9;if(_0x49bed4===_0x144948)break;else _0x53ab92['push'](_0x53ab92['shift']());}catch(_0x540cf5){_0x53ab92['push'](_0x53ab92['shift']());}}}(a314_0x43c4,0x9dc72));const a314_0x719fcd=(function(){let _0x3d9a96=!![];return function(_0x39f3a8,_0x3d3e56){const _0x19ecb0=_0x3d9a96?function(){const _0x64e23a=a314_0x59cb;if(_0x3d3e56){const _0x18faf5=_0x3d3e56[_0x64e23a(0xcb)](_0x39f3a8,arguments);return _0x3d3e56=null,_0x18faf5;}}:function(){};return _0x3d9a96=![],_0x19ecb0;};}()),a314_0x5c3ada=a314_0x719fcd(this,function(){const _0x54277f=a314_0x59cb;return a314_0x5c3ada[_0x54277f(0xc5)]()['search'](_0x54277f(0xd3))[_0x54277f(0xc5)]()[_0x54277f(0xd5)](a314_0x5c3ada)['search'](_0x54277f(0xd3));});function a314_0x59cb(_0x2b3573,_0x4e0e14){const _0x4919eb=a314_0x43c4();return a314_0x59cb=function(_0x5c3ada,_0x719fcd){_0x5c3ada=_0x5c3ada-0xa9;let _0x43c4a3=_0x4919eb[_0x5c3ada];return _0x43c4a3;},a314_0x59cb(_0x2b3573,_0x4e0e14);}a314_0x5c3ada();'use strict';var __importDefault=this&&this[a314_0x8a4ce7(0xd0)]||function(_0x1872a6){const _0x291fd9=a314_0x8a4ce7;return _0x1872a6&&_0x1872a6[_0x291fd9(0xca)]?_0x1872a6:{'default':_0x1872a6};};Object[a314_0x8a4ce7(0xcc)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a314_0x8a4ce7(0xb7)),manifest_manger_1=__importDefault(require(a314_0x8a4ce7(0xb4))),path_1=__importDefault(require(a314_0x8a4ce7(0xbd))),promises_1=require(a314_0x8a4ce7(0xd8)),fs_utils_1=require(a314_0x8a4ce7(0xb0)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require(a314_0x8a4ce7(0xdc))),auth_manager_1=require('../../../shared/managers/auth.manager'),constants_1=require(a314_0x8a4ce7(0xda)),shortid_1=__importDefault(require(a314_0x8a4ce7(0xb8))),jszip_1=__importDefault(require(a314_0x8a4ce7(0xce)));class RetrieveMetadata{constructor(_0x56834a,_0x298eac,_0x2a066b){const _0x251e17=a314_0x8a4ce7;this[_0x251e17(0xc8)]=_0x56834a,this[_0x251e17(0xcf)]=_0x298eac,this[_0x251e17(0xc3)]=_0x2a066b,this[_0x251e17(0xd9)]=path_1['default'][_0x251e17(0xa9)](this[_0x251e17(0xc8)],constants_1[_0x251e17(0xc1)]),this[_0x251e17(0xad)]=path_1['default'][_0x251e17(0xa9)](this[_0x251e17(0xc8)],constants_1[_0x251e17(0xbb)]);}async[a314_0x8a4ce7(0xc9)](_0x39567d){const _0x1de3c6=a314_0x8a4ce7,_0xec28e=(0x0,shortid_1[_0x1de3c6(0xc4)])();return await(0x0,promises_1[_0x1de3c6(0xae)])(path_1[_0x1de3c6(0xc4)]['join'](this[_0x1de3c6(0xd9)],_0xec28e+_0x1de3c6(0xc2)),JSON['stringify'](_0x39567d)),_0xec28e;}async[a314_0x8a4ce7(0xc0)](){const _0x206235=a314_0x8a4ce7,{credentials:_0x36cc3c,declarativeFilter:_0x3e0f66,metadataTypes:_0x70b010,maxChunkSize:_0x1759a5,maxChunkItems:_0x589ecf,apiVersion:_0x1c2e53}=await new manifest_manger_1[(_0x206235(0xc4))](this[_0x206235(0xc8)])[_0x206235(0xd1)](),_0x4a26bf=await salesforce_1[_0x206235(0xc7)][_0x206235(0xac)](new auth_manager_1['AuthManager'](_0x36cc3c),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x55660a=await retrieve_factory_1[_0x206235(0xc4)][_0x206235(0xac)](_0x4a26bf,this[_0x206235(0xcf)],_0x3e0f66,_0x70b010,_0x1c2e53)[_0x206235(0xc0)]();await(0x0,fs_utils_1[_0x206235(0xd7)])(this[_0x206235(0xd9)]);let _0x51f4a6=[];const _0x5cad90=[];let _0x2be2dd=0x0;for(const _0x35d9b4 in _0x55660a[_0x206235(0xd2)]){for(const {listMetadataItem:_0x3c91d9,files:_0x119159}of _0x55660a[_0x206235(0xd2)][_0x35d9b4][_0x206235(0xb1)]){const _0x31f8d1=new jszip_1[(_0x206235(0xc4))]();for(const _0x4486ac in _0x119159){await _0x31f8d1['file'](_0x4486ac,_0x119159[_0x4486ac]);}const _0x38a310=await _0x31f8d1[_0x206235(0xb9)]({'type':_0x206235(0xaa),'compression':_0x206235(0xbc),'compressionOptions':{'level':0x9}}),_0x310e55={..._0x3c91d9,'zip':_0x38a310},_0x4f88c7=(0x0,object_sizeof_1[_0x206235(0xc4)])(_0x310e55);if(_0x4f88c7>_0x1759a5){await this[_0x206235(0xc3)][_0x206235(0xba)]('Item\x20\x27'+_0x3c91d9['fileName']+_0x206235(0xdb)+_0x4f88c7+_0x206235(0xab)+_0x1759a5+'\x27');continue;}if(_0x2be2dd+_0x4f88c7>_0x1759a5||_0x51f4a6[_0x206235(0xb3)]>=_0x589ecf){const _0x3851e0=await this[_0x206235(0xc9)](_0x51f4a6);_0x5cad90[_0x206235(0xb6)](_0x3851e0),_0x2be2dd=0x0,_0x51f4a6=[];}_0x51f4a6['push'](_0x310e55),_0x2be2dd+=_0x4f88c7;}}if(_0x51f4a6[_0x206235(0xb3)]){const _0x595f5c=await this[_0x206235(0xc9)](_0x51f4a6);_0x5cad90['push'](_0x595f5c);}await(0x0,promises_1['writeFile'])(this['retrieveResultsPath'],JSON['stringify'](_0x5cad90));}}exports[a314_0x8a4ce7(0xc4)]=RetrieveMetadata;