function a314_0xfa60(_0x5ae45b,_0x39c587){const _0x28f987=a314_0x1051();return a314_0xfa60=function(_0x21583b,_0x37b74f){_0x21583b=_0x21583b-0x98;let _0x10511d=_0x28f987[_0x21583b];return _0x10511d;},a314_0xfa60(_0x5ae45b,_0x39c587);}const a314_0x347b67=a314_0xfa60;function a314_0x1051(){const _0x5eee94=['(((.+)+)+)+$','AxiosInstanceUtils','stateManager','353148noacoY','create','\x27\x20exceed\x20limit\x20\x27','.json','../../../shared/utils/fs.utils','18NlVecZ','writeFile','items','logger','shortid','stringify','__esModule','526012uvPbhf','retrieveResultsPath','path','15fgBezd','base64','\x27\x20size\x20\x27','7902037wqbFdv','default','112006ZoaPxO','Item\x20\x27','5ntqiyO','addWarning','14DfFuwR','execute','fileName','2482860wtkABE','join','init','length','writeChunk','@flosum/salesforce','makeDir','RETRIEVE_RESULTS_IDS_FILENAME','toString','generateAsync','DEFLATE','push','95796wkIHEM','RETRIEVE_RESULT_FOLDER_NAME','fs/promises','jobStorePath','1777744NriJED','./manifest-manger','apply'];a314_0x1051=function(){return _0x5eee94;};return a314_0x1051();}(function(_0x4d28d2,_0x3606f6){const _0x4ad405=a314_0xfa60,_0x428bbc=_0x4d28d2();while(!![]){try{const _0x599018=-parseInt(_0x4ad405(0x98))/0x1+-parseInt(_0x4ad405(0xa0))/0x2*(-parseInt(_0x4ad405(0x9b))/0x3)+parseInt(_0x4ad405(0xb3))/0x4*(parseInt(_0x4ad405(0xa2))/0x5)+parseInt(_0x4ad405(0xbd))/0x6*(parseInt(_0x4ad405(0xa4))/0x7)+parseInt(_0x4ad405(0xb7))/0x8+-parseInt(_0x4ad405(0xc2))/0x9*(parseInt(_0x4ad405(0xa7))/0xa)+parseInt(_0x4ad405(0x9e))/0xb;if(_0x599018===_0x3606f6)break;else _0x428bbc['push'](_0x428bbc['shift']());}catch(_0x1b6942){_0x428bbc['push'](_0x428bbc['shift']());}}}(a314_0x1051,0x52ee1));const a314_0x37b74f=(function(){let _0x403e41=!![];return function(_0x9f11d9,_0x34c163){const _0x3239bb=_0x403e41?function(){const _0x17089e=a314_0xfa60;if(_0x34c163){const _0x524f7f=_0x34c163[_0x17089e(0xb9)](_0x9f11d9,arguments);return _0x34c163=null,_0x524f7f;}}:function(){};return _0x403e41=![],_0x3239bb;};}()),a314_0x21583b=a314_0x37b74f(this,function(){const _0xd83d46=a314_0xfa60;return a314_0x21583b[_0xd83d46(0xaf)]()['search'](_0xd83d46(0xba))[_0xd83d46(0xaf)]()['constructor'](a314_0x21583b)['search'](_0xd83d46(0xba));});a314_0x21583b();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1eb261){const _0x52486b=a314_0xfa60;return _0x1eb261&&_0x1eb261[_0x52486b(0xc8)]?_0x1eb261:{'default':_0x1eb261};};Object['defineProperty'](exports,a314_0x347b67(0xc8),{'value':!![]});const salesforce_1=require(a314_0x347b67(0xac)),manifest_manger_1=__importDefault(require(a314_0x347b67(0xb8))),path_1=__importDefault(require(a314_0x347b67(0x9a))),promises_1=require(a314_0x347b67(0xb5)),fs_utils_1=require(a314_0x347b67(0xc1)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require('../../../shared/managers/auth.manager'),constants_1=require('../../constants'),shortid_1=__importDefault(require(a314_0x347b67(0xc6))),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x1f1e0e,_0xbc963b,_0x616583){const _0xd4ea46=a314_0x347b67;this['jobStorePath']=_0x1f1e0e,this[_0xd4ea46(0xc5)]=_0xbc963b,this[_0xd4ea46(0xbc)]=_0x616583,this['metadataFolder']=path_1['default'][_0xd4ea46(0xa8)](this['jobStorePath'],constants_1[_0xd4ea46(0xb4)]),this[_0xd4ea46(0x99)]=path_1[_0xd4ea46(0x9f)][_0xd4ea46(0xa8)](this[_0xd4ea46(0xb6)],constants_1[_0xd4ea46(0xae)]);}async['writeChunk'](_0x43ea56){const _0x5220d8=a314_0x347b67,_0x40669b=(0x0,shortid_1[_0x5220d8(0x9f)])();return await(0x0,promises_1[_0x5220d8(0xc3)])(path_1[_0x5220d8(0x9f)][_0x5220d8(0xa8)](this['metadataFolder'],_0x40669b+_0x5220d8(0xc0)),JSON[_0x5220d8(0xc7)](_0x43ea56)),_0x40669b;}async[a314_0x347b67(0xa5)](){const _0x4867fd=a314_0x347b67,{credentials:_0x27a3f8,declarativeFilter:_0xad0ed9,metadataTypes:_0xf46964,maxChunkSize:_0x3cf384,maxChunkItems:_0x3244dc,apiVersion:_0x9fa880}=await new manifest_manger_1[(_0x4867fd(0x9f))](this[_0x4867fd(0xb6)])[_0x4867fd(0xa9)](),_0x4e4619=await salesforce_1[_0x4867fd(0xbb)][_0x4867fd(0xbe)](new auth_manager_1['AuthManager'](_0x27a3f8),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x2583ad=await retrieve_factory_1[_0x4867fd(0x9f)][_0x4867fd(0xbe)](_0x4e4619,this[_0x4867fd(0xc5)],_0xad0ed9,_0xf46964,_0x9fa880)[_0x4867fd(0xa5)]();await(0x0,fs_utils_1[_0x4867fd(0xad)])(this['metadataFolder']);let _0x4c472a=[];const _0x19bcab=[];let _0x340630=0x0;for(const _0x352c63 in _0x2583ad[_0x4867fd(0xc4)]){for(const {listMetadataItem:_0x28ef66,files:_0x43311c}of _0x2583ad[_0x4867fd(0xc4)][_0x352c63]['components']){const _0x211eef=new jszip_1[(_0x4867fd(0x9f))]();for(const _0x5d4049 in _0x43311c){await _0x211eef['file'](_0x5d4049,_0x43311c[_0x5d4049]);}const _0x1bb78f=await _0x211eef[_0x4867fd(0xb0)]({'type':_0x4867fd(0x9c),'compression':_0x4867fd(0xb1),'compressionOptions':{'level':0x9}}),_0x45589e={..._0x28ef66,'zip':_0x1bb78f},_0xa84447=(0x0,object_sizeof_1[_0x4867fd(0x9f)])(_0x45589e);if(_0xa84447>_0x3cf384){await this['stateManager'][_0x4867fd(0xa3)](_0x4867fd(0xa1)+_0x28ef66[_0x4867fd(0xa6)]+_0x4867fd(0x9d)+_0xa84447+_0x4867fd(0xbf)+_0x3cf384+'\x27');continue;}if(_0x340630+_0xa84447>_0x3cf384||_0x4c472a[_0x4867fd(0xaa)]>=_0x3244dc){const _0x98e25b=await this[_0x4867fd(0xab)](_0x4c472a);_0x19bcab[_0x4867fd(0xb2)](_0x98e25b),_0x340630=0x0,_0x4c472a=[];}_0x4c472a['push'](_0x45589e),_0x340630+=_0xa84447;}}if(_0x4c472a[_0x4867fd(0xaa)]){const _0x2b1291=await this['writeChunk'](_0x4c472a);_0x19bcab[_0x4867fd(0xb2)](_0x2b1291);}await(0x0,promises_1[_0x4867fd(0xc3)])(this[_0x4867fd(0x99)],JSON['stringify'](_0x19bcab));}}exports['default']=RetrieveMetadata;