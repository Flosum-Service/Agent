function a316_0x52b1(_0x147f0b,_0x28894e){const _0x124a54=a316_0x4dc5();return a316_0x52b1=function(_0x3756b3,_0x4031c1){_0x3756b3=_0x3756b3-0xf1;let _0x4dc539=_0x124a54[_0x3756b3];return _0x4dc539;},a316_0x52b1(_0x147f0b,_0x28894e);}const a316_0x27b800=a316_0x52b1;(function(_0x28ca59,_0x37ecc5){const _0x5b6fa4=a316_0x52b1,_0x458fb9=_0x28ca59();while(!![]){try{const _0x46a237=parseInt(_0x5b6fa4(0xf9))/0x1+-parseInt(_0x5b6fa4(0x117))/0x2+-parseInt(_0x5b6fa4(0x114))/0x3+-parseInt(_0x5b6fa4(0xfe))/0x4*(parseInt(_0x5b6fa4(0x115))/0x5)+-parseInt(_0x5b6fa4(0x11d))/0x6+-parseInt(_0x5b6fa4(0x108))/0x7+parseInt(_0x5b6fa4(0x101))/0x8;if(_0x46a237===_0x37ecc5)break;else _0x458fb9['push'](_0x458fb9['shift']());}catch(_0x2e3196){_0x458fb9['push'](_0x458fb9['shift']());}}}(a316_0x4dc5,0x46816));const a316_0x4031c1=(function(){let _0x43953e=!![];return function(_0x3e43e0,_0x5052a9){const _0x117cea=_0x43953e?function(){if(_0x5052a9){const _0x31986e=_0x5052a9['apply'](_0x3e43e0,arguments);return _0x5052a9=null,_0x31986e;}}:function(){};return _0x43953e=![],_0x117cea;};}()),a316_0x3756b3=a316_0x4031c1(this,function(){const _0x269356=a316_0x52b1;return a316_0x3756b3[_0x269356(0xff)]()['search']('(((.+)+)+)+$')['toString']()[_0x269356(0x113)](a316_0x3756b3)[_0x269356(0x110)](_0x269356(0x10d));});a316_0x3756b3();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1fd33a){const _0x441894=a316_0x52b1;return _0x1fd33a&&_0x1fd33a[_0x441894(0x104)]?_0x1fd33a:{'default':_0x1fd33a};};Object['defineProperty'](exports,a316_0x27b800(0x104),{'value':!![]});const salesforce_1=require(a316_0x27b800(0x100)),manifest_manger_1=__importDefault(require('./manifest-manger')),path_1=__importDefault(require(a316_0x27b800(0x102))),promises_1=require(a316_0x27b800(0x10f)),fs_utils_1=require(a316_0x27b800(0xf6)),object_sizeof_1=__importDefault(require(a316_0x27b800(0xfb))),retrieve_factory_1=__importDefault(require(a316_0x27b800(0x119))),auth_manager_1=require(a316_0x27b800(0xf1)),constants_1=require(a316_0x27b800(0x118)),shortid_1=__importDefault(require(a316_0x27b800(0x103))),jszip_1=__importDefault(require(a316_0x27b800(0x10b)));class RetrieveMetadata{constructor(_0x342fda,_0x43c87a,_0x5bbd28){const _0x308dfb=a316_0x27b800;this[_0x308dfb(0x11f)]=_0x342fda,this['logger']=_0x43c87a,this['stateManager']=_0x5bbd28,this['metadataFolder']=path_1[_0x308dfb(0x10c)][_0x308dfb(0x107)](this[_0x308dfb(0x11f)],constants_1[_0x308dfb(0x11e)]),this['retrieveResultsPath']=path_1[_0x308dfb(0x10c)][_0x308dfb(0x107)](this['jobStorePath'],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async[a316_0x27b800(0x10a)](_0x10418b){const _0x1903aa=a316_0x27b800,_0x525e70=(0x0,shortid_1[_0x1903aa(0x10c)])();return await(0x0,promises_1['writeFile'])(path_1[_0x1903aa(0x10c)][_0x1903aa(0x107)](this[_0x1903aa(0xf2)],_0x525e70+_0x1903aa(0x116)),JSON[_0x1903aa(0xfc)](_0x10418b)),_0x525e70;}async['execute'](){const _0x26a885=a316_0x27b800,{credentials:_0x13b3ee,declarativeFilter:_0x544fb0,metadataTypes:_0x553509,maxChunkSize:_0x5920ce,maxChunkItems:_0xe08046,apiVersion:_0x12216d}=await new manifest_manger_1[(_0x26a885(0x10c))](this[_0x26a885(0x11f)])[_0x26a885(0x106)](),_0x330cc9=await salesforce_1['AxiosInstanceUtils']['create'](new auth_manager_1[(_0x26a885(0x112))](_0x13b3ee),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x1c5c4a=await retrieve_factory_1[_0x26a885(0x10c)][_0x26a885(0xfa)](_0x330cc9,this[_0x26a885(0xf3)],_0x544fb0,_0x553509,_0x12216d)['execute']();await(0x0,fs_utils_1['makeDir'])(this[_0x26a885(0xf2)]);let _0x3f9921=[];const _0xf7b53c=[];let _0x4cf6c9=0x0;for(const _0x220233 in _0x1c5c4a[_0x26a885(0x11a)]){for(const {listMetadataItem:_0x1c2c6f,files:_0x39149a}of _0x1c5c4a[_0x26a885(0x11a)][_0x220233][_0x26a885(0x109)]){const _0x4bdb05=new jszip_1[(_0x26a885(0x10c))]();for(const _0x3c0059 in _0x39149a){await _0x4bdb05[_0x26a885(0x120)](_0x3c0059,_0x39149a[_0x3c0059]);}const _0xf99ae2=await _0x4bdb05[_0x26a885(0x10e)]({'type':_0x26a885(0xfd),'compression':_0x26a885(0x111),'compressionOptions':{'level':0x9}}),_0x280242={..._0x1c2c6f,'zip':_0xf99ae2},_0x1f7c27=(0x0,object_sizeof_1[_0x26a885(0x10c)])(_0x280242);if(_0x1f7c27>_0x5920ce){await this[_0x26a885(0x121)][_0x26a885(0x11c)](_0x26a885(0xf4)+_0x1c2c6f[_0x26a885(0x105)]+_0x26a885(0xf5)+_0x1f7c27+_0x26a885(0xf7)+_0x5920ce+'\x27');continue;}if(_0x4cf6c9+_0x1f7c27>_0x5920ce||_0x3f9921[_0x26a885(0x11b)]>=_0xe08046){const _0x50c53d=await this['writeChunk'](_0x3f9921);_0xf7b53c['push'](_0x50c53d),_0x4cf6c9=0x0,_0x3f9921=[];}_0x3f9921['push'](_0x280242),_0x4cf6c9+=_0x1f7c27;}}if(_0x3f9921['length']){const _0x29959c=await this[_0x26a885(0x10a)](_0x3f9921);_0xf7b53c[_0x26a885(0xf8)](_0x29959c);}await(0x0,promises_1['writeFile'])(this['retrieveResultsPath'],JSON[_0x26a885(0xfc)](_0xf7b53c));}}function a316_0x4dc5(){const _0x1637e8=['items','length','addWarning','936984TNrzbm','RETRIEVE_RESULT_FOLDER_NAME','jobStorePath','file','stateManager','../../../shared/managers/auth.manager','metadataFolder','logger','Item\x20\x27','\x27\x20size\x20\x27','../../../shared/utils/fs.utils','\x27\x20exceed\x20limit\x20\x27','push','1420sXucIC','create','object-sizeof','stringify','base64','42116RTDSPl','toString','@flosum/salesforce','14894040FltLzs','path','shortid','__esModule','fileName','init','join','2944571RJsltD','components','writeChunk','jszip','default','(((.+)+)+)+$','generateAsync','fs/promises','search','DEFLATE','AuthManager','constructor','1730547VWYjNq','85AmnsxN','.json','483452KMPzCA','../../constants','./retrieve-factory'];a316_0x4dc5=function(){return _0x1637e8;};return a316_0x4dc5();}exports['default']=RetrieveMetadata;