const a266_0x227694=a266_0x2e57;function a266_0x2e57(_0x28815c,_0x5eea46){const _0x206107=a266_0x226a();return a266_0x2e57=function(_0x2a3d45,_0x43f16d){_0x2a3d45=_0x2a3d45-0x88;let _0x226af=_0x206107[_0x2a3d45];return _0x226af;},a266_0x2e57(_0x28815c,_0x5eea46);}(function(_0x4aa2d2,_0x44530e){const _0x421aa2=a266_0x2e57,_0x5a9110=_0x4aa2d2();while(!![]){try{const _0x4a2191=-parseInt(_0x421aa2(0xa4))/0x1+parseInt(_0x421aa2(0xb8))/0x2*(parseInt(_0x421aa2(0xba))/0x3)+parseInt(_0x421aa2(0x8b))/0x4+parseInt(_0x421aa2(0xb1))/0x5*(-parseInt(_0x421aa2(0xb2))/0x6)+-parseInt(_0x421aa2(0xa0))/0x7+parseInt(_0x421aa2(0x98))/0x8+parseInt(_0x421aa2(0x92))/0x9;if(_0x4a2191===_0x44530e)break;else _0x5a9110['push'](_0x5a9110['shift']());}catch(_0x260aa3){_0x5a9110['push'](_0x5a9110['shift']());}}}(a266_0x226a,0x3d8dd));const a266_0x43f16d=(function(){let _0x329cff=!![];return function(_0x600ef9,_0x4afdfc){const _0x12390f=_0x329cff?function(){const _0x2cc08b=a266_0x2e57;if(_0x4afdfc){const _0x2ef889=_0x4afdfc[_0x2cc08b(0x8d)](_0x600ef9,arguments);return _0x4afdfc=null,_0x2ef889;}}:function(){};return _0x329cff=![],_0x12390f;};}()),a266_0x2a3d45=a266_0x43f16d(this,function(){const _0x133942=a266_0x2e57;return a266_0x2a3d45[_0x133942(0xa8)]()[_0x133942(0x89)](_0x133942(0x8a))['toString']()['constructor'](a266_0x2a3d45)['search'](_0x133942(0x8a));});a266_0x2a3d45();function a266_0x226a(){const _0x54e4d9=['__esModule','AuthManager','items','writeChunk','jobStorePath','137545sGFVjU','18FylpQr','makeDir','base64','../../../shared/utils/fs.utils','addWarning','logger','6uBygUN','stateManager','262674HlGMJA','@flosum/salesforce','AxiosInstanceUtils','length','search','(((.+)+)+)+$','512044SYvcnh','init','apply','object-sizeof','fileName','RETRIEVE_RESULTS_IDS_FILENAME','\x27\x20size\x20\x27','6975189ZZRVsH','execute','./retrieve-factory','push','generateAsync','../../../shared/managers/auth.manager','111656peqpFi','DEFLATE','metadataFolder','writeFile','join','retrieveResultsPath','stringify','defineProperty','3406564eJIBhU','../../constants','\x27\x20exceed\x20limit\x20\x27','path','358359lJFBQg','file','shortid','default','toString','./manifest-manger','components','create'];a266_0x226a=function(){return _0x54e4d9;};return a266_0x226a();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x27d8db){const _0x4df439=a266_0x2e57;return _0x27d8db&&_0x27d8db[_0x4df439(0xac)]?_0x27d8db:{'default':_0x27d8db};};Object[a266_0x227694(0x9f)](exports,a266_0x227694(0xac),{'value':!![]});const salesforce_1=require(a266_0x227694(0xbb)),manifest_manger_1=__importDefault(require(a266_0x227694(0xa9))),path_1=__importDefault(require(a266_0x227694(0xa3))),promises_1=require('fs/promises'),fs_utils_1=require(a266_0x227694(0xb5)),object_sizeof_1=__importDefault(require(a266_0x227694(0x8e))),retrieve_factory_1=__importDefault(require(a266_0x227694(0x94))),auth_manager_1=require(a266_0x227694(0x97)),constants_1=require(a266_0x227694(0xa1)),shortid_1=__importDefault(require(a266_0x227694(0xa6))),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x118d19,_0x3570e2,_0x5e244b){const _0x366dfb=a266_0x227694;this[_0x366dfb(0xb0)]=_0x118d19,this['logger']=_0x3570e2,this[_0x366dfb(0xb9)]=_0x5e244b,this[_0x366dfb(0x9a)]=path_1[_0x366dfb(0xa7)][_0x366dfb(0x9c)](this[_0x366dfb(0xb0)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0x366dfb(0x9d)]=path_1['default']['join'](this[_0x366dfb(0xb0)],constants_1[_0x366dfb(0x90)]);}async[a266_0x227694(0xaf)](_0x597844){const _0x22d4f3=a266_0x227694,_0x4e0476=(0x0,shortid_1[_0x22d4f3(0xa7)])();return await(0x0,promises_1[_0x22d4f3(0x9b)])(path_1[_0x22d4f3(0xa7)][_0x22d4f3(0x9c)](this[_0x22d4f3(0x9a)],_0x4e0476+'.json'),JSON['stringify'](_0x597844)),_0x4e0476;}async[a266_0x227694(0x93)](){const _0x327a02=a266_0x227694,{credentials:_0x15aa16,declarativeFilter:_0xae68fb,maxChunkSize:_0x3e3e0c,maxChunkItems:_0x449e67}=await new manifest_manger_1[(_0x327a02(0xa7))](this[_0x327a02(0xb0)])[_0x327a02(0x8c)](),_0x1a8183=await salesforce_1[_0x327a02(0xbc)][_0x327a02(0xab)](new auth_manager_1[(_0x327a02(0xad))](_0x15aa16),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x582942=await retrieve_factory_1[_0x327a02(0xa7)][_0x327a02(0xab)](_0x1a8183,this[_0x327a02(0xb7)],_0xae68fb)['execute']();await(0x0,fs_utils_1[_0x327a02(0xb3)])(this[_0x327a02(0x9a)]);let _0x406819=[];const _0x21c72e=[];let _0x1ae9ff=0x0;for(const _0x561bef in _0x582942[_0x327a02(0xae)]){for(const {listMetadataItem:_0x2ddf03,files:_0x2a4627}of _0x582942[_0x327a02(0xae)][_0x561bef][_0x327a02(0xaa)]){const _0x43ab4a=new jszip_1[(_0x327a02(0xa7))]();for(const _0x279e65 in _0x2a4627){await _0x43ab4a[_0x327a02(0xa5)](_0x279e65,_0x2a4627[_0x279e65]);}const _0x2ae89c=await _0x43ab4a[_0x327a02(0x96)]({'type':_0x327a02(0xb4),'compression':_0x327a02(0x99),'compressionOptions':{'level':0x9}}),_0x32b35c={..._0x2ddf03,'zip':_0x2ae89c},_0x1b9ce0=(0x0,object_sizeof_1[_0x327a02(0xa7)])(_0x32b35c);if(_0x1b9ce0>_0x3e3e0c){await this[_0x327a02(0xb9)][_0x327a02(0xb6)]('Item\x20\x27'+_0x2ddf03[_0x327a02(0x8f)]+_0x327a02(0x91)+_0x1b9ce0+_0x327a02(0xa2)+_0x3e3e0c+'\x27');continue;}if(_0x1ae9ff+_0x1b9ce0>_0x3e3e0c||_0x406819[_0x327a02(0x88)]>=_0x449e67){const _0x3b10a2=await this[_0x327a02(0xaf)](_0x406819);_0x21c72e[_0x327a02(0x95)](_0x3b10a2),_0x1ae9ff=0x0,_0x406819=[];}_0x406819[_0x327a02(0x95)](_0x32b35c),_0x1ae9ff+=_0x1b9ce0;}}if(_0x406819[_0x327a02(0x88)]){const _0x26874e=await this['writeChunk'](_0x406819);_0x21c72e[_0x327a02(0x95)](_0x26874e);}await(0x0,promises_1[_0x327a02(0x9b)])(this[_0x327a02(0x9d)],JSON[_0x327a02(0x9e)](_0x21c72e));}}exports['default']=RetrieveMetadata;