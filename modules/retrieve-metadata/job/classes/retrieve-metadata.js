const a304_0x4242b4=a304_0x16ae;(function(_0x529922,_0x1e4323){const _0x285475=a304_0x16ae,_0xc1f083=_0x529922();while(!![]){try{const _0x4aa030=parseInt(_0x285475(0x1de))/0x1*(parseInt(_0x285475(0x1c3))/0x2)+-parseInt(_0x285475(0x1ae))/0x3+-parseInt(_0x285475(0x1d2))/0x4+parseInt(_0x285475(0x1dc))/0x5*(-parseInt(_0x285475(0x1d4))/0x6)+-parseInt(_0x285475(0x1ad))/0x7*(parseInt(_0x285475(0x1d6))/0x8)+-parseInt(_0x285475(0x1d5))/0x9*(parseInt(_0x285475(0x1b5))/0xa)+parseInt(_0x285475(0x1b6))/0xb*(parseInt(_0x285475(0x1ba))/0xc);if(_0x4aa030===_0x1e4323)break;else _0xc1f083['push'](_0xc1f083['shift']());}catch(_0x59fed7){_0xc1f083['push'](_0xc1f083['shift']());}}}(a304_0x148c,0x7c528));const a304_0xca3bb8=(function(){let _0x5343b3=!![];return function(_0x41a299,_0x433e0a){const _0x19ba64=_0x5343b3?function(){if(_0x433e0a){const _0x29e8a2=_0x433e0a['apply'](_0x41a299,arguments);return _0x433e0a=null,_0x29e8a2;}}:function(){};return _0x5343b3=![],_0x19ba64;};}()),a304_0x55e131=a304_0xca3bb8(this,function(){const _0x20472=a304_0x16ae;return a304_0x55e131[_0x20472(0x1d8)]()[_0x20472(0x1c7)]('(((.+)+)+)+$')[_0x20472(0x1d8)]()['constructor'](a304_0x55e131)['search'](_0x20472(0x1c9));});a304_0x55e131();'use strict';var __importDefault=this&&this[a304_0x4242b4(0x1c1)]||function(_0x10d6e1){const _0x58b2e8=a304_0x4242b4;return _0x10d6e1&&_0x10d6e1[_0x58b2e8(0x1ab)]?_0x10d6e1:{'default':_0x10d6e1};};Object[a304_0x4242b4(0x1be)](exports,a304_0x4242b4(0x1ab),{'value':!![]});const salesforce_1=require(a304_0x4242b4(0x1b7)),manifest_manger_1=__importDefault(require('./manifest-manger')),path_1=__importDefault(require(a304_0x4242b4(0x1b8))),promises_1=require(a304_0x4242b4(0x1d9)),fs_utils_1=require(a304_0x4242b4(0x1d3)),object_sizeof_1=__importDefault(require(a304_0x4242b4(0x1bd))),retrieve_factory_1=__importDefault(require(a304_0x4242b4(0x1bb))),auth_manager_1=require(a304_0x4242b4(0x1cd)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a304_0x4242b4(0x1da))),jszip_1=__importDefault(require('jszip'));function a304_0x16ae(_0x317211,_0x156930){const _0x2aed9d=a304_0x148c();return a304_0x16ae=function(_0x55e131,_0xca3bb8){_0x55e131=_0x55e131-0x1ab;let _0x148cbd=_0x2aed9d[_0x55e131];return _0x148cbd;},a304_0x16ae(_0x317211,_0x156930);}class RetrieveMetadata{constructor(_0x9b857,_0x59b111,_0x22c4a1){const _0x33d3e7=a304_0x4242b4;this['jobStorePath']=_0x9b857,this[_0x33d3e7(0x1bc)]=_0x59b111,this[_0x33d3e7(0x1ca)]=_0x22c4a1,this[_0x33d3e7(0x1d7)]=path_1[_0x33d3e7(0x1ce)][_0x33d3e7(0x1b0)](this[_0x33d3e7(0x1c6)],constants_1[_0x33d3e7(0x1c8)]),this[_0x33d3e7(0x1ac)]=path_1[_0x33d3e7(0x1ce)]['join'](this[_0x33d3e7(0x1c6)],constants_1[_0x33d3e7(0x1bf)]);}async[a304_0x4242b4(0x1c2)](_0x57306b){const _0x51fbb1=a304_0x4242b4,_0x27cbdf=(0x0,shortid_1[_0x51fbb1(0x1ce)])();return await(0x0,promises_1['writeFile'])(path_1[_0x51fbb1(0x1ce)][_0x51fbb1(0x1b0)](this[_0x51fbb1(0x1d7)],_0x27cbdf+_0x51fbb1(0x1cb)),JSON[_0x51fbb1(0x1cf)](_0x57306b)),_0x27cbdf;}async[a304_0x4242b4(0x1b4)](){const _0xa53ac2=a304_0x4242b4,{credentials:_0x52e762,declarativeFilter:_0x13d8f2,metadataTypes:_0x3a4f83,maxChunkSize:_0x541872,maxChunkItems:_0x5cb89f,apiVersion:_0x2d044c}=await new manifest_manger_1['default'](this[_0xa53ac2(0x1c6)])['init'](),_0x156d1e=await salesforce_1[_0xa53ac2(0x1d1)][_0xa53ac2(0x1d0)](new auth_manager_1[(_0xa53ac2(0x1b1))](_0x52e762),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x4b352f=await retrieve_factory_1['default'][_0xa53ac2(0x1d0)](_0x156d1e,this[_0xa53ac2(0x1bc)],_0x13d8f2,_0x3a4f83,_0x2d044c)['execute']();await(0x0,fs_utils_1['makeDir'])(this['metadataFolder']);let _0x5e003b=[];const _0x26cc3b=[];let _0x2c9e60=0x0;for(const _0x1a6fe0 in _0x4b352f[_0xa53ac2(0x1cc)]){for(const {listMetadataItem:_0x210343,files:_0x42c346}of _0x4b352f['items'][_0x1a6fe0][_0xa53ac2(0x1b2)]){const _0x2bbbfb=new jszip_1['default']();for(const _0x5bac28 in _0x42c346){await _0x2bbbfb['file'](_0x5bac28,_0x42c346[_0x5bac28]);}const _0x40208c=await _0x2bbbfb[_0xa53ac2(0x1dd)]({'type':_0xa53ac2(0x1db),'compression':_0xa53ac2(0x1c4),'compressionOptions':{'level':0x9}}),_0x4513fd={..._0x210343,'zip':_0x40208c},_0x20db34=(0x0,object_sizeof_1['default'])(_0x4513fd);if(_0x20db34>_0x541872){await this[_0xa53ac2(0x1ca)]['addWarning']('Item\x20\x27'+_0x210343[_0xa53ac2(0x1b3)]+_0xa53ac2(0x1c5)+_0x20db34+_0xa53ac2(0x1c0)+_0x541872+'\x27');continue;}if(_0x2c9e60+_0x20db34>_0x541872||_0x5e003b[_0xa53ac2(0x1b9)]>=_0x5cb89f){const _0x3d0592=await this[_0xa53ac2(0x1c2)](_0x5e003b);_0x26cc3b['push'](_0x3d0592),_0x2c9e60=0x0,_0x5e003b=[];}_0x5e003b[_0xa53ac2(0x1af)](_0x4513fd),_0x2c9e60+=_0x20db34;}}if(_0x5e003b['length']){const _0x3a663a=await this['writeChunk'](_0x5e003b);_0x26cc3b[_0xa53ac2(0x1af)](_0x3a663a);}await(0x0,promises_1['writeFile'])(this[_0xa53ac2(0x1ac)],JSON[_0xa53ac2(0x1cf)](_0x26cc3b));}}exports[a304_0x4242b4(0x1ce)]=RetrieveMetadata;function a304_0x148c(){const _0x340b71=['base64','67445xrdvjF','generateAsync','537yorqVE','__esModule','retrieveResultsPath','5621VcpVir','1682394vzghDA','push','join','AuthManager','components','fileName','execute','455020EqQWHT','63833MGbFFZ','@flosum/salesforce','path','length','3828MTjXvY','./retrieve-factory','logger','object-sizeof','defineProperty','RETRIEVE_RESULTS_IDS_FILENAME','\x27\x20exceed\x20limit\x20\x27','__importDefault','writeChunk','2198tdfYJe','DEFLATE','\x27\x20size\x20\x27','jobStorePath','search','RETRIEVE_RESULT_FOLDER_NAME','(((.+)+)+)+$','stateManager','.json','items','../../../shared/managers/auth.manager','default','stringify','create','AxiosInstanceUtils','2173728EOYjJY','../../../shared/utils/fs.utils','30uHAImE','135QIkPYh','776sBbjqe','metadataFolder','toString','fs/promises','shortid'];a304_0x148c=function(){return _0x340b71;};return a304_0x148c();}