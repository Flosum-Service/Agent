const a315_0x51a680=a315_0x3b04;function a315_0x3b04(_0x562dfb,_0x408214){const _0x4737f7=a315_0x153d();return a315_0x3b04=function(_0x334d46,_0x22cc04){_0x334d46=_0x334d46-0x1d0;let _0x153de7=_0x4737f7[_0x334d46];return _0x153de7;},a315_0x3b04(_0x562dfb,_0x408214);}(function(_0x264395,_0x540a8e){const _0x3d72ec=a315_0x3b04,_0xf0e3ea=_0x264395();while(!![]){try{const _0x5bd04f=parseInt(_0x3d72ec(0x206))/0x1+parseInt(_0x3d72ec(0x1fc))/0x2+-parseInt(_0x3d72ec(0x1d8))/0x3*(-parseInt(_0x3d72ec(0x203))/0x4)+parseInt(_0x3d72ec(0x1ea))/0x5*(-parseInt(_0x3d72ec(0x1de))/0x6)+parseInt(_0x3d72ec(0x1d4))/0x7*(-parseInt(_0x3d72ec(0x1dd))/0x8)+parseInt(_0x3d72ec(0x1f0))/0x9*(-parseInt(_0x3d72ec(0x1d3))/0xa)+parseInt(_0x3d72ec(0x1fb))/0xb;if(_0x5bd04f===_0x540a8e)break;else _0xf0e3ea['push'](_0xf0e3ea['shift']());}catch(_0x5c21e7){_0xf0e3ea['push'](_0xf0e3ea['shift']());}}}(a315_0x153d,0x206b4));const a315_0x22cc04=(function(){let _0x4a36fc=!![];return function(_0x2d223c,_0x4e31ae){const _0x263be0=_0x4a36fc?function(){const _0x541e69=a315_0x3b04;if(_0x4e31ae){const _0x59dfe9=_0x4e31ae[_0x541e69(0x204)](_0x2d223c,arguments);return _0x4e31ae=null,_0x59dfe9;}}:function(){};return _0x4a36fc=![],_0x263be0;};}()),a315_0x334d46=a315_0x22cc04(this,function(){const _0x1b8c2e=a315_0x3b04;return a315_0x334d46[_0x1b8c2e(0x1f2)]()['search'](_0x1b8c2e(0x1e7))[_0x1b8c2e(0x1f2)]()[_0x1b8c2e(0x1da)](a315_0x334d46)[_0x1b8c2e(0x1d1)](_0x1b8c2e(0x1e7));});a315_0x334d46();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x807932){return _0x807932&&_0x807932['__esModule']?_0x807932:{'default':_0x807932};};Object[a315_0x51a680(0x202)](exports,a315_0x51a680(0x1d9),{'value':!![]});const salesforce_1=require(a315_0x51a680(0x1ec)),manifest_manger_1=__importDefault(require(a315_0x51a680(0x205))),path_1=__importDefault(require(a315_0x51a680(0x1f3))),promises_1=require(a315_0x51a680(0x207)),fs_utils_1=require(a315_0x51a680(0x1fe)),object_sizeof_1=__importDefault(require(a315_0x51a680(0x1fa))),retrieve_factory_1=__importDefault(require(a315_0x51a680(0x201))),auth_manager_1=require(a315_0x51a680(0x1e9)),constants_1=require(a315_0x51a680(0x1fd)),shortid_1=__importDefault(require(a315_0x51a680(0x1e6))),jszip_1=__importDefault(require(a315_0x51a680(0x1ed)));class RetrieveMetadata{constructor(_0x580d9b,_0x18960b,_0x19268c){const _0xcbfe42=a315_0x51a680;this['jobStorePath']=_0x580d9b,this['logger']=_0x18960b,this[_0xcbfe42(0x1d6)]=_0x19268c,this[_0xcbfe42(0x1dc)]=path_1[_0xcbfe42(0x1ef)][_0xcbfe42(0x1e3)](this['jobStorePath'],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0xcbfe42(0x1db)]=path_1['default']['join'](this['jobStorePath'],constants_1[_0xcbfe42(0x200)]);}async[a315_0x51a680(0x1f4)](_0x2a366e){const _0x5c6f20=a315_0x51a680,_0x1fccff=(0x0,shortid_1['default'])();return await(0x0,promises_1['writeFile'])(path_1[_0x5c6f20(0x1ef)]['join'](this['metadataFolder'],_0x1fccff+_0x5c6f20(0x1d0)),JSON['stringify'](_0x2a366e)),_0x1fccff;}async[a315_0x51a680(0x1f1)](){const _0x43407b=a315_0x51a680,{credentials:_0x512fea,declarativeFilter:_0x53d0b0,metadataTypes:_0xce0114,maxChunkSize:_0x151618,maxChunkItems:_0x38593d,apiVersion:_0x2da6cf}=await new manifest_manger_1[(_0x43407b(0x1ef))](this['jobStorePath'])[_0x43407b(0x1f6)](),_0x6c32be=await salesforce_1[_0x43407b(0x1e4)][_0x43407b(0x1ee)](new auth_manager_1['AuthManager'](_0x512fea),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x3e68a8=await retrieve_factory_1[_0x43407b(0x1ef)]['create'](_0x6c32be,this[_0x43407b(0x1e5)],_0x53d0b0,_0xce0114,_0x2da6cf)[_0x43407b(0x1f1)]();await(0x0,fs_utils_1[_0x43407b(0x1e1)])(this[_0x43407b(0x1dc)]);let _0x1dc909=[];const _0x3ea7fd=[];let _0x575a76=0x0;for(const _0x1329e3 in _0x3e68a8[_0x43407b(0x1ff)]){for(const {listMetadataItem:_0x122eb3,files:_0x57fe39}of _0x3e68a8[_0x43407b(0x1ff)][_0x1329e3][_0x43407b(0x1d7)]){const _0x22579c=new jszip_1[(_0x43407b(0x1ef))]();for(const _0xfbeb51 in _0x57fe39){await _0x22579c[_0x43407b(0x1e0)](_0xfbeb51,_0x57fe39[_0xfbeb51]);}const _0x5d2efd=await _0x22579c[_0x43407b(0x1d5)]({'type':_0x43407b(0x1df),'compression':'DEFLATE','compressionOptions':{'level':0x9}}),_0x2dfba3={..._0x122eb3,'zip':_0x5d2efd},_0x428b1a=(0x0,object_sizeof_1[_0x43407b(0x1ef)])(_0x2dfba3);if(_0x428b1a>_0x151618){await this[_0x43407b(0x1d6)][_0x43407b(0x1f9)]('Item\x20\x27'+_0x122eb3[_0x43407b(0x1d2)]+_0x43407b(0x1f8)+_0x428b1a+_0x43407b(0x1e8)+_0x151618+'\x27');continue;}if(_0x575a76+_0x428b1a>_0x151618||_0x1dc909[_0x43407b(0x1f5)]>=_0x38593d){const _0x4ae2c2=await this[_0x43407b(0x1f4)](_0x1dc909);_0x3ea7fd[_0x43407b(0x1f7)](_0x4ae2c2),_0x575a76=0x0,_0x1dc909=[];}_0x1dc909['push'](_0x2dfba3),_0x575a76+=_0x428b1a;}}if(_0x1dc909[_0x43407b(0x1f5)]){const _0x483bcd=await this[_0x43407b(0x1f4)](_0x1dc909);_0x3ea7fd[_0x43407b(0x1f7)](_0x483bcd);}await(0x0,promises_1[_0x43407b(0x1eb)])(this[_0x43407b(0x1db)],JSON[_0x43407b(0x1e2)](_0x3ea7fd));}}exports[a315_0x51a680(0x1ef)]=RetrieveMetadata;function a315_0x153d(){const _0x27341e=['349608pPUWff','../../constants','../../../shared/utils/fs.utils','items','RETRIEVE_RESULTS_IDS_FILENAME','./retrieve-factory','defineProperty','420xrxQeY','apply','./manifest-manger','242552AKqceI','fs/promises','.json','search','fileName','2284680IZvuZM','3059MZKyVP','generateAsync','stateManager','components','5241cvQfAt','__esModule','constructor','retrieveResultsPath','metadataFolder','4456bwByAJ','255576KBoDjw','base64','file','makeDir','stringify','join','AxiosInstanceUtils','logger','shortid','(((.+)+)+)+$','\x27\x20exceed\x20limit\x20\x27','../../../shared/managers/auth.manager','5JQMArs','writeFile','@flosum/salesforce','jszip','create','default','9IhucZY','execute','toString','path','writeChunk','length','init','push','\x27\x20size\x20\x27','addWarning','object-sizeof','511170SEHFKT'];a315_0x153d=function(){return _0x27341e;};return a315_0x153d();}