const a267_0x4c1809=a267_0x540f;(function(_0x3b730a,_0x50f49f){const _0x4f1373=a267_0x540f,_0x540b80=_0x3b730a();while(!![]){try{const _0x458c9d=-parseInt(_0x4f1373(0x17d))/0x1*(parseInt(_0x4f1373(0x1a3))/0x2)+-parseInt(_0x4f1373(0x1a9))/0x3*(-parseInt(_0x4f1373(0x198))/0x4)+parseInt(_0x4f1373(0x19d))/0x5+-parseInt(_0x4f1373(0x18d))/0x6+parseInt(_0x4f1373(0x1a6))/0x7*(-parseInt(_0x4f1373(0x19b))/0x8)+parseInt(_0x4f1373(0x182))/0x9+parseInt(_0x4f1373(0x181))/0xa*(parseInt(_0x4f1373(0x1a0))/0xb);if(_0x458c9d===_0x50f49f)break;else _0x540b80['push'](_0x540b80['shift']());}catch(_0x130b1f){_0x540b80['push'](_0x540b80['shift']());}}}(a267_0x3909,0xdf403));const a267_0x3cdde2=(function(){let _0x365e84=!![];return function(_0x8a3a6b,_0x214233){const _0x180761=_0x365e84?function(){const _0x4705ad=a267_0x540f;if(_0x214233){const _0x1d95a9=_0x214233[_0x4705ad(0x1a5)](_0x8a3a6b,arguments);return _0x214233=null,_0x1d95a9;}}:function(){};return _0x365e84=![],_0x180761;};}()),a267_0x13086b=a267_0x3cdde2(this,function(){const _0x5d4ad5=a267_0x540f;return a267_0x13086b[_0x5d4ad5(0x18c)]()[_0x5d4ad5(0x186)](_0x5d4ad5(0x183))['toString']()[_0x5d4ad5(0x17f)](a267_0x13086b)[_0x5d4ad5(0x186)](_0x5d4ad5(0x183));});a267_0x13086b();function a267_0x540f(_0x39de90,_0x57ed86){const _0x3c517d=a267_0x3909();return a267_0x540f=function(_0x13086b,_0x3cdde2){_0x13086b=_0x13086b-0x174;let _0x3909ab=_0x3c517d[_0x13086b];return _0x3909ab;},a267_0x540f(_0x39de90,_0x57ed86);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3cc427){return _0x3cc427&&_0x3cc427['__esModule']?_0x3cc427:{'default':_0x3cc427};};function a267_0x3909(){const _0x260c3c=['__esModule','fileName','writeFile','../../constants','Item\x20\x27','toString','4421436kovjod','makeDir','./manifest-manger','../../../shared/utils/fs.utils','metadataFolder','base64','retrieveResultsPath','defineProperty','file','jobStorePath','AxiosInstanceUtils','4gFCfuS','generateAsync','components','824DfaZUs','path','1623895VLiDjQ','.json','items','44qItAxK','\x27\x20exceed\x20limit\x20\x27','execute','1467902RPsDdS','DEFLATE','apply','11592GXoajq','\x27\x20size\x20\x27','length','1973019KxMfsB','jszip','shortid','init','@flosum/salesforce','logger','join','push','RETRIEVE_RESULTS_IDS_FILENAME','default','../../../shared/managers/auth.manager','2vgRBHP','stateManager','constructor','writeChunk','2787530mUABng','10731123KaPxrq','(((.+)+)+)+$','stringify','AuthManager','search'];a267_0x3909=function(){return _0x260c3c;};return a267_0x3909();}Object[a267_0x4c1809(0x194)](exports,a267_0x4c1809(0x187),{'value':!![]});const salesforce_1=require(a267_0x4c1809(0x176)),manifest_manger_1=__importDefault(require(a267_0x4c1809(0x18f))),path_1=__importDefault(require(a267_0x4c1809(0x19c))),promises_1=require('fs/promises'),fs_utils_1=require(a267_0x4c1809(0x190)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require(a267_0x4c1809(0x17c)),constants_1=require(a267_0x4c1809(0x18a)),shortid_1=__importDefault(require(a267_0x4c1809(0x174))),jszip_1=__importDefault(require(a267_0x4c1809(0x1aa)));class RetrieveMetadata{constructor(_0x1a97b8,_0x5d0334,_0x43ee9f){const _0x40b6fb=a267_0x4c1809;this[_0x40b6fb(0x196)]=_0x1a97b8,this[_0x40b6fb(0x177)]=_0x5d0334,this[_0x40b6fb(0x17e)]=_0x43ee9f,this[_0x40b6fb(0x191)]=path_1[_0x40b6fb(0x17b)][_0x40b6fb(0x178)](this[_0x40b6fb(0x196)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0x40b6fb(0x193)]=path_1[_0x40b6fb(0x17b)][_0x40b6fb(0x178)](this[_0x40b6fb(0x196)],constants_1[_0x40b6fb(0x17a)]);}async[a267_0x4c1809(0x180)](_0x482bbe){const _0x30b41d=a267_0x4c1809,_0x132fce=(0x0,shortid_1[_0x30b41d(0x17b)])();return await(0x0,promises_1['writeFile'])(path_1[_0x30b41d(0x17b)][_0x30b41d(0x178)](this['metadataFolder'],_0x132fce+_0x30b41d(0x19e)),JSON[_0x30b41d(0x184)](_0x482bbe)),_0x132fce;}async[a267_0x4c1809(0x1a2)](){const _0x42afa8=a267_0x4c1809,{credentials:_0x1d836f,declarativeFilter:_0x53cba4,metadataTypes:_0x272191,maxChunkSize:_0x1bb61e,maxChunkItems:_0x1451e6,apiVersion:_0x149911}=await new manifest_manger_1[(_0x42afa8(0x17b))](this[_0x42afa8(0x196)])[_0x42afa8(0x175)](),_0x425abc=await salesforce_1[_0x42afa8(0x197)]['create'](new auth_manager_1[(_0x42afa8(0x185))](_0x1d836f),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x1cfc8b=await retrieve_factory_1[_0x42afa8(0x17b)]['create'](_0x425abc,this[_0x42afa8(0x177)],_0x53cba4,_0x272191,_0x149911)[_0x42afa8(0x1a2)]();await(0x0,fs_utils_1[_0x42afa8(0x18e)])(this[_0x42afa8(0x191)]);let _0x446b81=[];const _0x3e064e=[];let _0xadde5a=0x0;for(const _0x456c86 in _0x1cfc8b[_0x42afa8(0x19f)]){for(const {listMetadataItem:_0x5737f5,files:_0x1c496a}of _0x1cfc8b['items'][_0x456c86][_0x42afa8(0x19a)]){const _0x4dc95b=new jszip_1[(_0x42afa8(0x17b))]();for(const _0x44072d in _0x1c496a){await _0x4dc95b[_0x42afa8(0x195)](_0x44072d,_0x1c496a[_0x44072d]);}const _0x2d9241=await _0x4dc95b[_0x42afa8(0x199)]({'type':_0x42afa8(0x192),'compression':_0x42afa8(0x1a4),'compressionOptions':{'level':0x9}}),_0x27cbca={..._0x5737f5,'zip':_0x2d9241},_0x37eb42=(0x0,object_sizeof_1['default'])(_0x27cbca);if(_0x37eb42>_0x1bb61e){await this[_0x42afa8(0x17e)]['addWarning'](_0x42afa8(0x18b)+_0x5737f5[_0x42afa8(0x188)]+_0x42afa8(0x1a7)+_0x37eb42+_0x42afa8(0x1a1)+_0x1bb61e+'\x27');continue;}if(_0xadde5a+_0x37eb42>_0x1bb61e||_0x446b81[_0x42afa8(0x1a8)]>=_0x1451e6){const _0x239208=await this[_0x42afa8(0x180)](_0x446b81);_0x3e064e[_0x42afa8(0x179)](_0x239208),_0xadde5a=0x0,_0x446b81=[];}_0x446b81[_0x42afa8(0x179)](_0x27cbca),_0xadde5a+=_0x37eb42;}}if(_0x446b81[_0x42afa8(0x1a8)]){const _0x2741a9=await this[_0x42afa8(0x180)](_0x446b81);_0x3e064e[_0x42afa8(0x179)](_0x2741a9);}await(0x0,promises_1[_0x42afa8(0x189)])(this[_0x42afa8(0x193)],JSON[_0x42afa8(0x184)](_0x3e064e));}}exports[a267_0x4c1809(0x17b)]=RetrieveMetadata;