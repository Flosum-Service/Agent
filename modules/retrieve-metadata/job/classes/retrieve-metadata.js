const a304_0x2e10c2=a304_0x489c;(function(_0x1e1ae4,_0x3f7092){const _0x4676b6=a304_0x489c,_0x6d56c9=_0x1e1ae4();while(!![]){try{const _0x15e687=-parseInt(_0x4676b6(0xa4))/0x1*(parseInt(_0x4676b6(0x9e))/0x2)+-parseInt(_0x4676b6(0xb8))/0x3*(parseInt(_0x4676b6(0x88))/0x4)+parseInt(_0x4676b6(0xb5))/0x5*(parseInt(_0x4676b6(0xa3))/0x6)+parseInt(_0x4676b6(0x95))/0x7*(-parseInt(_0x4676b6(0xb7))/0x8)+-parseInt(_0x4676b6(0xb6))/0x9*(-parseInt(_0x4676b6(0xa9))/0xa)+-parseInt(_0x4676b6(0xa2))/0xb+parseInt(_0x4676b6(0xac))/0xc;if(_0x15e687===_0x3f7092)break;else _0x6d56c9['push'](_0x6d56c9['shift']());}catch(_0x41e2c0){_0x6d56c9['push'](_0x6d56c9['shift']());}}}(a304_0x2ed2,0xc2cb5));const a304_0x83980c=(function(){let _0x4c944a=!![];return function(_0x23c9c6,_0x3e26a5){const _0x3b3729=_0x4c944a?function(){if(_0x3e26a5){const _0x57ee46=_0x3e26a5['apply'](_0x23c9c6,arguments);return _0x3e26a5=null,_0x57ee46;}}:function(){};return _0x4c944a=![],_0x3b3729;};}()),a304_0x3ce1f2=a304_0x83980c(this,function(){const _0x50c752=a304_0x489c;return a304_0x3ce1f2['toString']()[_0x50c752(0x86)](_0x50c752(0xb9))['toString']()['constructor'](a304_0x3ce1f2)[_0x50c752(0x86)](_0x50c752(0xb9));});a304_0x3ce1f2();'use strict';var __importDefault=this&&this[a304_0x2e10c2(0xa1)]||function(_0x592176){return _0x592176&&_0x592176['__esModule']?_0x592176:{'default':_0x592176};};Object[a304_0x2e10c2(0x9a)](exports,a304_0x2e10c2(0x90),{'value':!![]});const salesforce_1=require(a304_0x2e10c2(0xab)),manifest_manger_1=__importDefault(require(a304_0x2e10c2(0x99))),path_1=__importDefault(require(a304_0x2e10c2(0x89))),promises_1=require(a304_0x2e10c2(0x97)),fs_utils_1=require(a304_0x2e10c2(0x9f)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require(a304_0x2e10c2(0xb0))),auth_manager_1=require(a304_0x2e10c2(0xa8)),constants_1=require(a304_0x2e10c2(0x9c)),shortid_1=__importDefault(require(a304_0x2e10c2(0xa5))),jszip_1=__importDefault(require('jszip'));function a304_0x489c(_0x41aa55,_0xa1d199){const _0x2760a4=a304_0x2ed2();return a304_0x489c=function(_0x3ce1f2,_0x83980c){_0x3ce1f2=_0x3ce1f2-0x82;let _0x2ed21d=_0x2760a4[_0x3ce1f2];return _0x2ed21d;},a304_0x489c(_0x41aa55,_0xa1d199);}function a304_0x2ed2(){const _0x33d46e=['618093MHQXAa','5898640WGcQhp','366UKuijJ','(((.+)+)+)+$','Item\x20\x27','push','create','makeDir','search','\x27\x20size\x20\x27','10056faVaYi','path','metadataFolder','components','items','length','default','.json','__esModule','\x27\x20exceed\x20limit\x20\x27','jobStorePath','base64','DEFLATE','14IOMYKG','fileName','fs/promises','RETRIEVE_RESULT_FOLDER_NAME','./manifest-manger','defineProperty','stateManager','../../constants','init','4486BnZrjK','../../../shared/utils/fs.utils','addWarning','__importDefault','7437265VqIMei','384sUmskD','394gAjqKB','shortid','logger','generateAsync','../../../shared/managers/auth.manager','200YtBXJA','execute','@flosum/salesforce','21304248RmcpFa','stringify','file','writeFile','./retrieve-factory','AxiosInstanceUtils','join','retrieveResultsPath','AuthManager','77360rXRhLe'];a304_0x2ed2=function(){return _0x33d46e;};return a304_0x2ed2();}class RetrieveMetadata{constructor(_0x429b00,_0x376b9a,_0x235736){const _0x400258=a304_0x2e10c2;this[_0x400258(0x92)]=_0x429b00,this[_0x400258(0xa6)]=_0x376b9a,this[_0x400258(0x9b)]=_0x235736,this[_0x400258(0x8a)]=path_1['default'][_0x400258(0xb2)](this[_0x400258(0x92)],constants_1[_0x400258(0x98)]),this[_0x400258(0xb3)]=path_1['default'][_0x400258(0xb2)](this[_0x400258(0x92)],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async['writeChunk'](_0x178dc7){const _0x2d7a4c=a304_0x2e10c2,_0x31c64a=(0x0,shortid_1[_0x2d7a4c(0x8e)])();return await(0x0,promises_1[_0x2d7a4c(0xaf)])(path_1[_0x2d7a4c(0x8e)][_0x2d7a4c(0xb2)](this[_0x2d7a4c(0x8a)],_0x31c64a+_0x2d7a4c(0x8f)),JSON[_0x2d7a4c(0xad)](_0x178dc7)),_0x31c64a;}async[a304_0x2e10c2(0xaa)](){const _0x6cda90=a304_0x2e10c2,{credentials:_0x3d8533,declarativeFilter:_0x4954ee,metadataTypes:_0x3b6061,maxChunkSize:_0x3016b8,maxChunkItems:_0xbaf763,apiVersion:_0x499d61}=await new manifest_manger_1['default'](this[_0x6cda90(0x92)])[_0x6cda90(0x9d)](),_0x11ee63=await salesforce_1[_0x6cda90(0xb1)]['create'](new auth_manager_1[(_0x6cda90(0xb4))](_0x3d8533),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x363c28=await retrieve_factory_1[_0x6cda90(0x8e)][_0x6cda90(0x84)](_0x11ee63,this[_0x6cda90(0xa6)],_0x4954ee,_0x3b6061,_0x499d61)[_0x6cda90(0xaa)]();await(0x0,fs_utils_1[_0x6cda90(0x85)])(this[_0x6cda90(0x8a)]);let _0x107158=[];const _0x171ed0=[];let _0x242b7d=0x0;for(const _0x504671 in _0x363c28[_0x6cda90(0x8c)]){for(const {listMetadataItem:_0x3d4758,files:_0x15fb23}of _0x363c28[_0x6cda90(0x8c)][_0x504671][_0x6cda90(0x8b)]){const _0x3742b0=new jszip_1[(_0x6cda90(0x8e))]();for(const _0x2fda84 in _0x15fb23){await _0x3742b0[_0x6cda90(0xae)](_0x2fda84,_0x15fb23[_0x2fda84]);}const _0x553d75=await _0x3742b0[_0x6cda90(0xa7)]({'type':_0x6cda90(0x93),'compression':_0x6cda90(0x94),'compressionOptions':{'level':0x9}}),_0x11bbe5={..._0x3d4758,'zip':_0x553d75},_0x2c4408=(0x0,object_sizeof_1[_0x6cda90(0x8e)])(_0x11bbe5);if(_0x2c4408>_0x3016b8){await this['stateManager'][_0x6cda90(0xa0)](_0x6cda90(0x82)+_0x3d4758[_0x6cda90(0x96)]+_0x6cda90(0x87)+_0x2c4408+_0x6cda90(0x91)+_0x3016b8+'\x27');continue;}if(_0x242b7d+_0x2c4408>_0x3016b8||_0x107158[_0x6cda90(0x8d)]>=_0xbaf763){const _0x580fa2=await this['writeChunk'](_0x107158);_0x171ed0[_0x6cda90(0x83)](_0x580fa2),_0x242b7d=0x0,_0x107158=[];}_0x107158[_0x6cda90(0x83)](_0x11bbe5),_0x242b7d+=_0x2c4408;}}if(_0x107158[_0x6cda90(0x8d)]){const _0x60c95b=await this['writeChunk'](_0x107158);_0x171ed0[_0x6cda90(0x83)](_0x60c95b);}await(0x0,promises_1[_0x6cda90(0xaf)])(this[_0x6cda90(0xb3)],JSON['stringify'](_0x171ed0));}}exports['default']=RetrieveMetadata;