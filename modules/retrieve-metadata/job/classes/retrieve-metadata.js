const a272_0x52fc02=a272_0x2b36;(function(_0x2740c9,_0x151b42){const _0x941444=a272_0x2b36,_0x170f41=_0x2740c9();while(!![]){try{const _0x444266=-parseInt(_0x941444(0xb6))/0x1*(-parseInt(_0x941444(0xb0))/0x2)+-parseInt(_0x941444(0xb9))/0x3+parseInt(_0x941444(0xdb))/0x4*(parseInt(_0x941444(0xb7))/0x5)+parseInt(_0x941444(0xbd))/0x6+parseInt(_0x941444(0xcb))/0x7+parseInt(_0x941444(0xbf))/0x8+-parseInt(_0x941444(0xd7))/0x9;if(_0x444266===_0x151b42)break;else _0x170f41['push'](_0x170f41['shift']());}catch(_0x15b460){_0x170f41['push'](_0x170f41['shift']());}}}(a272_0x564d,0xdc653));const a272_0x2c3f0c=(function(){let _0x527fec=!![];return function(_0xf312e6,_0x39b6f2){const _0x75c6db=_0x527fec?function(){if(_0x39b6f2){const _0x405060=_0x39b6f2['apply'](_0xf312e6,arguments);return _0x39b6f2=null,_0x405060;}}:function(){};return _0x527fec=![],_0x75c6db;};}()),a272_0x2d64f3=a272_0x2c3f0c(this,function(){const _0x22b8b6=a272_0x2b36;return a272_0x2d64f3['toString']()[_0x22b8b6(0xc2)]('(((.+)+)+)+$')[_0x22b8b6(0xc9)]()[_0x22b8b6(0xc6)](a272_0x2d64f3)[_0x22b8b6(0xc2)]('(((.+)+)+)+$');});function a272_0x2b36(_0x16143,_0x41d9d4){const _0xa36074=a272_0x564d();return a272_0x2b36=function(_0x2d64f3,_0x2c3f0c){_0x2d64f3=_0x2d64f3-0xaf;let _0x564d88=_0xa36074[_0x2d64f3];return _0x564d88;},a272_0x2b36(_0x16143,_0x41d9d4);}a272_0x2d64f3();'use strict';var __importDefault=this&&this[a272_0x52fc02(0xbe)]||function(_0x573885){const _0xfcbfc0=a272_0x52fc02;return _0x573885&&_0x573885[_0xfcbfc0(0xbc)]?_0x573885:{'default':_0x573885};};function a272_0x564d(){const _0x59a86f=['constructor','../../../shared/managers/auth.manager','logger','toString','../../../shared/utils/fs.utils','8786673ayDjvA','push','stringify','generateAsync','path','length','\x27\x20exceed\x20limit\x20\x27','RETRIEVE_RESULTS_IDS_FILENAME','default','makeDir','stateManager','fileName','16372350teUZeD','./retrieve-factory','file','jobStorePath','97580pSjARh','items','\x27\x20size\x20\x27','.json','base64','1744NaThwQ','./manifest-manger','writeFile','object-sizeof','../../constants','join','187OdsYHi','345mKXSOA','init','5190663yEedSo','components','RETRIEVE_RESULT_FOLDER_NAME','__esModule','6533778iGIHlJ','__importDefault','2092712phTKgz','@flosum/salesforce','metadataFolder','search','writeChunk','create','AuthManager'];a272_0x564d=function(){return _0x59a86f;};return a272_0x564d();}Object['defineProperty'](exports,a272_0x52fc02(0xbc),{'value':!![]});const salesforce_1=require(a272_0x52fc02(0xc0)),manifest_manger_1=__importDefault(require(a272_0x52fc02(0xb1))),path_1=__importDefault(require(a272_0x52fc02(0xcf))),promises_1=require('fs/promises'),fs_utils_1=require(a272_0x52fc02(0xca)),object_sizeof_1=__importDefault(require(a272_0x52fc02(0xb3))),retrieve_factory_1=__importDefault(require(a272_0x52fc02(0xd8))),auth_manager_1=require(a272_0x52fc02(0xc7)),constants_1=require(a272_0x52fc02(0xb4)),shortid_1=__importDefault(require('shortid')),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x474bd9,_0x16dc1e,_0x44e558){const _0x26eb91=a272_0x52fc02;this[_0x26eb91(0xda)]=_0x474bd9,this[_0x26eb91(0xc8)]=_0x16dc1e,this[_0x26eb91(0xd5)]=_0x44e558,this['metadataFolder']=path_1[_0x26eb91(0xd3)][_0x26eb91(0xb5)](this[_0x26eb91(0xda)],constants_1[_0x26eb91(0xbb)]),this['retrieveResultsPath']=path_1[_0x26eb91(0xd3)]['join'](this[_0x26eb91(0xda)],constants_1[_0x26eb91(0xd2)]);}async['writeChunk'](_0x11f97e){const _0x17d45e=a272_0x52fc02,_0x2353c4=(0x0,shortid_1[_0x17d45e(0xd3)])();return await(0x0,promises_1['writeFile'])(path_1['default']['join'](this[_0x17d45e(0xc1)],_0x2353c4+_0x17d45e(0xde)),JSON[_0x17d45e(0xcd)](_0x11f97e)),_0x2353c4;}async['execute'](){const _0x5a2b47=a272_0x52fc02,{credentials:_0x3a31ca,declarativeFilter:_0x5e500d,metadataTypes:_0x1e4e92,maxChunkSize:_0xc6375a,maxChunkItems:_0x41cef9,apiVersion:_0x3fc886}=await new manifest_manger_1[(_0x5a2b47(0xd3))](this[_0x5a2b47(0xda)])[_0x5a2b47(0xb8)](),_0xea57a3=await salesforce_1['AxiosInstanceUtils'][_0x5a2b47(0xc4)](new auth_manager_1[(_0x5a2b47(0xc5))](_0x3a31ca),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x1dc149=await retrieve_factory_1[_0x5a2b47(0xd3)][_0x5a2b47(0xc4)](_0xea57a3,this[_0x5a2b47(0xc8)],_0x5e500d,_0x1e4e92,_0x3fc886)['execute']();await(0x0,fs_utils_1[_0x5a2b47(0xd4)])(this[_0x5a2b47(0xc1)]);let _0x409ec7=[];const _0x261f30=[];let _0x514597=0x0;for(const _0x1d3392 in _0x1dc149['items']){for(const {listMetadataItem:_0x27eb8f,files:_0x591f93}of _0x1dc149[_0x5a2b47(0xdc)][_0x1d3392][_0x5a2b47(0xba)]){const _0x208c6d=new jszip_1[(_0x5a2b47(0xd3))]();for(const _0x2bfab2 in _0x591f93){await _0x208c6d[_0x5a2b47(0xd9)](_0x2bfab2,_0x591f93[_0x2bfab2]);}const _0x549d76=await _0x208c6d[_0x5a2b47(0xce)]({'type':_0x5a2b47(0xaf),'compression':'DEFLATE','compressionOptions':{'level':0x9}}),_0x21393={..._0x27eb8f,'zip':_0x549d76},_0x1dc024=(0x0,object_sizeof_1[_0x5a2b47(0xd3)])(_0x21393);if(_0x1dc024>_0xc6375a){await this[_0x5a2b47(0xd5)]['addWarning']('Item\x20\x27'+_0x27eb8f[_0x5a2b47(0xd6)]+_0x5a2b47(0xdd)+_0x1dc024+_0x5a2b47(0xd1)+_0xc6375a+'\x27');continue;}if(_0x514597+_0x1dc024>_0xc6375a||_0x409ec7[_0x5a2b47(0xd0)]>=_0x41cef9){const _0x45f56e=await this[_0x5a2b47(0xc3)](_0x409ec7);_0x261f30[_0x5a2b47(0xcc)](_0x45f56e),_0x514597=0x0,_0x409ec7=[];}_0x409ec7[_0x5a2b47(0xcc)](_0x21393),_0x514597+=_0x1dc024;}}if(_0x409ec7[_0x5a2b47(0xd0)]){const _0x2acb62=await this[_0x5a2b47(0xc3)](_0x409ec7);_0x261f30[_0x5a2b47(0xcc)](_0x2acb62);}await(0x0,promises_1[_0x5a2b47(0xb2)])(this['retrieveResultsPath'],JSON['stringify'](_0x261f30));}}exports[a272_0x52fc02(0xd3)]=RetrieveMetadata;