const a272_0x5d1a40=a272_0x6b99;(function(_0x99830e,_0x497df3){const _0x4aa153=a272_0x6b99,_0x21f6c4=_0x99830e();while(!![]){try{const _0x3614b7=-parseInt(_0x4aa153(0x1c8))/0x1+-parseInt(_0x4aa153(0x1b1))/0x2*(-parseInt(_0x4aa153(0x1ac))/0x3)+parseInt(_0x4aa153(0x1a2))/0x4*(-parseInt(_0x4aa153(0x1a1))/0x5)+-parseInt(_0x4aa153(0x1d3))/0x6*(-parseInt(_0x4aa153(0x1a7))/0x7)+parseInt(_0x4aa153(0x1b9))/0x8*(parseInt(_0x4aa153(0x1cd))/0x9)+-parseInt(_0x4aa153(0x1b8))/0xa+parseInt(_0x4aa153(0x1c3))/0xb;if(_0x3614b7===_0x497df3)break;else _0x21f6c4['push'](_0x21f6c4['shift']());}catch(_0x5e346c){_0x21f6c4['push'](_0x21f6c4['shift']());}}}(a272_0x1af1,0x9f268));const a272_0x4672b6=(function(){let _0x1e86f3=!![];return function(_0x2876df,_0x1a87e7){const _0x5534a4=_0x1e86f3?function(){if(_0x1a87e7){const _0x5db77e=_0x1a87e7['apply'](_0x2876df,arguments);return _0x1a87e7=null,_0x5db77e;}}:function(){};return _0x1e86f3=![],_0x5534a4;};}()),a272_0x3aecc9=a272_0x4672b6(this,function(){const _0xc66322=a272_0x6b99;return a272_0x3aecc9[_0xc66322(0x1ce)]()['search'](_0xc66322(0x1aa))[_0xc66322(0x1ce)]()[_0xc66322(0x1b5)](a272_0x3aecc9)['search'](_0xc66322(0x1aa));});a272_0x3aecc9();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x35e834){const _0x52c9e5=a272_0x6b99;return _0x35e834&&_0x35e834[_0x52c9e5(0x1d2)]?_0x35e834:{'default':_0x35e834};};Object[a272_0x5d1a40(0x1b3)](exports,a272_0x5d1a40(0x1d2),{'value':!![]});function a272_0x6b99(_0x505004,_0x6b2e53){const _0x1c471f=a272_0x1af1();return a272_0x6b99=function(_0x3aecc9,_0x4672b6){_0x3aecc9=_0x3aecc9-0x1a1;let _0x1af1ff=_0x1c471f[_0x3aecc9];return _0x1af1ff;},a272_0x6b99(_0x505004,_0x6b2e53);}const salesforce_1=require(a272_0x5d1a40(0x1d4)),manifest_manger_1=__importDefault(require(a272_0x5d1a40(0x1b2))),path_1=__importDefault(require('path')),promises_1=require('fs/promises'),fs_utils_1=require(a272_0x5d1a40(0x1c5)),object_sizeof_1=__importDefault(require(a272_0x5d1a40(0x1c2))),retrieve_factory_1=__importDefault(require(a272_0x5d1a40(0x1bf))),auth_manager_1=require('../../../shared/managers/auth.manager'),constants_1=require(a272_0x5d1a40(0x1be)),shortid_1=__importDefault(require(a272_0x5d1a40(0x1ca))),jszip_1=__importDefault(require(a272_0x5d1a40(0x1c0)));class RetrieveMetadata{constructor(_0x337400,_0x28d7fa,_0xc29c8c){const _0x5b3344=a272_0x5d1a40;this[_0x5b3344(0x1c7)]=_0x337400,this[_0x5b3344(0x1cb)]=_0x28d7fa,this[_0x5b3344(0x1c1)]=_0xc29c8c,this['metadataFolder']=path_1[_0x5b3344(0x1cc)][_0x5b3344(0x1c9)](this[_0x5b3344(0x1c7)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this['retrieveResultsPath']=path_1[_0x5b3344(0x1cc)][_0x5b3344(0x1c9)](this['jobStorePath'],constants_1[_0x5b3344(0x1ba)]);}async['writeChunk'](_0x2494d9){const _0x53b61f=a272_0x5d1a40,_0x191faa=(0x0,shortid_1[_0x53b61f(0x1cc)])();return await(0x0,promises_1[_0x53b61f(0x1d1)])(path_1[_0x53b61f(0x1cc)][_0x53b61f(0x1c9)](this['metadataFolder'],_0x191faa+_0x53b61f(0x1bc)),JSON[_0x53b61f(0x1a6)](_0x2494d9)),_0x191faa;}async[a272_0x5d1a40(0x1a9)](){const _0x2df2ff=a272_0x5d1a40,{credentials:_0x43c923,declarativeFilter:_0x22824c,metadataTypes:_0x3c1380,maxChunkSize:_0x26afaf,maxChunkItems:_0x148ed7,apiVersion:_0x286d47}=await new manifest_manger_1['default'](this[_0x2df2ff(0x1c7)])[_0x2df2ff(0x1bd)](),_0x390980=await salesforce_1[_0x2df2ff(0x1c4)][_0x2df2ff(0x1b7)](new auth_manager_1[(_0x2df2ff(0x1a3))](_0x43c923),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x1b0323=await retrieve_factory_1[_0x2df2ff(0x1cc)][_0x2df2ff(0x1b7)](_0x390980,this[_0x2df2ff(0x1cb)],_0x22824c,_0x3c1380,_0x286d47)['execute']();await(0x0,fs_utils_1[_0x2df2ff(0x1ae)])(this[_0x2df2ff(0x1b6)]);let _0xb88dc7=[];const _0x452771=[];let _0x42d2d2=0x0;for(const _0x14dd97 in _0x1b0323[_0x2df2ff(0x1a4)]){for(const {listMetadataItem:_0x5258da,files:_0x1e703a}of _0x1b0323[_0x2df2ff(0x1a4)][_0x14dd97][_0x2df2ff(0x1d0)]){const _0x598383=new jszip_1[(_0x2df2ff(0x1cc))]();for(const _0x3c637f in _0x1e703a){await _0x598383[_0x2df2ff(0x1d5)](_0x3c637f,_0x1e703a[_0x3c637f]);}const _0xcebdda=await _0x598383[_0x2df2ff(0x1c6)]({'type':'base64','compression':_0x2df2ff(0x1ad),'compressionOptions':{'level':0x9}}),_0x52e8d6={..._0x5258da,'zip':_0xcebdda},_0x407281=(0x0,object_sizeof_1['default'])(_0x52e8d6);if(_0x407281>_0x26afaf){await this['stateManager'][_0x2df2ff(0x1af)](_0x2df2ff(0x1cf)+_0x5258da[_0x2df2ff(0x1a8)]+_0x2df2ff(0x1b4)+_0x407281+'\x27\x20exceed\x20limit\x20\x27'+_0x26afaf+'\x27');continue;}if(_0x42d2d2+_0x407281>_0x26afaf||_0xb88dc7[_0x2df2ff(0x1bb)]>=_0x148ed7){const _0x5078c9=await this['writeChunk'](_0xb88dc7);_0x452771['push'](_0x5078c9),_0x42d2d2=0x0,_0xb88dc7=[];}_0xb88dc7[_0x2df2ff(0x1ab)](_0x52e8d6),_0x42d2d2+=_0x407281;}}if(_0xb88dc7[_0x2df2ff(0x1bb)]){const _0x1e7a61=await this[_0x2df2ff(0x1a5)](_0xb88dc7);_0x452771[_0x2df2ff(0x1ab)](_0x1e7a61);}await(0x0,promises_1['writeFile'])(this[_0x2df2ff(0x1b0)],JSON[_0x2df2ff(0x1a6)](_0x452771));}}exports[a272_0x5d1a40(0x1cc)]=RetrieveMetadata;function a272_0x1af1(){const _0x3c1747=['RETRIEVE_RESULTS_IDS_FILENAME','length','.json','init','../../constants','./retrieve-factory','jszip','stateManager','object-sizeof','5035921jXDUnQ','AxiosInstanceUtils','../../../shared/utils/fs.utils','generateAsync','jobStorePath','899164YhiHXq','join','shortid','logger','default','19206vdHFWK','toString','Item\x20\x27','components','writeFile','__esModule','35718wIeFNT','@flosum/salesforce','file','5JohwEf','669796JxYwJE','AuthManager','items','writeChunk','stringify','427JvQTkn','fileName','execute','(((.+)+)+)+$','push','106695sLjzQR','DEFLATE','makeDir','addWarning','retrieveResultsPath','38uKykgY','./manifest-manger','defineProperty','\x27\x20size\x20\x27','constructor','metadataFolder','create','3906440fJxhFs','2296XNQTAV'];a272_0x1af1=function(){return _0x3c1747;};return a272_0x1af1();}