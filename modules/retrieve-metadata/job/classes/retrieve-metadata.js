const a266_0x2631a5=a266_0x568e;(function(_0x356633,_0x153d93){const _0x397163=a266_0x568e,_0x16a34a=_0x356633();while(!![]){try{const _0x1b6c8c=parseInt(_0x397163(0x141))/0x1*(parseInt(_0x397163(0x15c))/0x2)+-parseInt(_0x397163(0x136))/0x3+parseInt(_0x397163(0x14f))/0x4*(parseInt(_0x397163(0x138))/0x5)+-parseInt(_0x397163(0x13b))/0x6+parseInt(_0x397163(0x159))/0x7+parseInt(_0x397163(0x145))/0x8*(parseInt(_0x397163(0x15b))/0x9)+parseInt(_0x397163(0x149))/0xa*(parseInt(_0x397163(0x12f))/0xb);if(_0x1b6c8c===_0x153d93)break;else _0x16a34a['push'](_0x16a34a['shift']());}catch(_0x4e4859){_0x16a34a['push'](_0x16a34a['shift']());}}}(a266_0x3f03,0xd5c4b));const a266_0x12a3e2=(function(){let _0x4bb61a=!![];return function(_0x4bef52,_0x795aa2){const _0x1c1a39=_0x4bb61a?function(){const _0x5b31ba=a266_0x568e;if(_0x795aa2){const _0x7e1aca=_0x795aa2[_0x5b31ba(0x150)](_0x4bef52,arguments);return _0x795aa2=null,_0x7e1aca;}}:function(){};return _0x4bb61a=![],_0x1c1a39;};}()),a266_0x35072a=a266_0x12a3e2(this,function(){const _0x1575d6=a266_0x568e;return a266_0x35072a[_0x1575d6(0x144)]()['search'](_0x1575d6(0x146))['toString']()['constructor'](a266_0x35072a)[_0x1575d6(0x154)](_0x1575d6(0x146));});a266_0x35072a();'use strict';function a266_0x568e(_0x5df09d,_0x1d0169){const _0x23d85c=a266_0x3f03();return a266_0x568e=function(_0x35072a,_0x12a3e2){_0x35072a=_0x35072a-0x12b;let _0x3f0392=_0x23d85c[_0x35072a];return _0x3f0392;},a266_0x568e(_0x5df09d,_0x1d0169);}var __importDefault=this&&this[a266_0x2631a5(0x15a)]||function(_0x417912){const _0x3cdcf8=a266_0x2631a5;return _0x417912&&_0x417912[_0x3cdcf8(0x14c)]?_0x417912:{'default':_0x417912};};Object[a266_0x2631a5(0x140)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a266_0x2631a5(0x12b)),manifest_manger_1=__importDefault(require(a266_0x2631a5(0x14a))),path_1=__importDefault(require(a266_0x2631a5(0x132))),promises_1=require('fs/promises'),fs_utils_1=require(a266_0x2631a5(0x158)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require(a266_0x2631a5(0x13e))),auth_manager_1=require(a266_0x2631a5(0x13d)),constants_1=require(a266_0x2631a5(0x137)),shortid_1=__importDefault(require(a266_0x2631a5(0x15d))),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x50186d,_0x1dc61d,_0x238ce7){const _0x2181e0=a266_0x2631a5;this[_0x2181e0(0x12c)]=_0x50186d,this[_0x2181e0(0x12e)]=_0x1dc61d,this[_0x2181e0(0x155)]=_0x238ce7,this[_0x2181e0(0x134)]=path_1['default'][_0x2181e0(0x12d)](this[_0x2181e0(0x12c)],constants_1[_0x2181e0(0x15f)]),this[_0x2181e0(0x130)]=path_1[_0x2181e0(0x14e)][_0x2181e0(0x12d)](this[_0x2181e0(0x12c)],constants_1[_0x2181e0(0x153)]);}async[a266_0x2631a5(0x15e)](_0x1ce43d){const _0x5a8bb3=a266_0x2631a5,_0x4c94c8=(0x0,shortid_1[_0x5a8bb3(0x14e)])();return await(0x0,promises_1[_0x5a8bb3(0x142)])(path_1[_0x5a8bb3(0x14e)][_0x5a8bb3(0x12d)](this[_0x5a8bb3(0x134)],_0x4c94c8+'.json'),JSON[_0x5a8bb3(0x152)](_0x1ce43d)),_0x4c94c8;}async['execute'](){const _0x518516=a266_0x2631a5,{credentials:_0x58b50f,declarativeFilter:_0x476129,maxChunkSize:_0x124c00,maxChunkItems:_0x3b984b,apiVersion:_0x29aee7}=await new manifest_manger_1[(_0x518516(0x14e))](this[_0x518516(0x12c)])[_0x518516(0x157)](),_0x21ea82=await salesforce_1[_0x518516(0x14b)][_0x518516(0x133)](new auth_manager_1[(_0x518516(0x135))](_0x58b50f),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x47de2d=await retrieve_factory_1[_0x518516(0x14e)]['create'](_0x21ea82,this[_0x518516(0x12e)],_0x476129,_0x29aee7)['execute']();await(0x0,fs_utils_1[_0x518516(0x143)])(this[_0x518516(0x134)]);let _0x337cfd=[];const _0x3ebfb7=[];let _0x565a97=0x0;for(const _0xb708c0 in _0x47de2d[_0x518516(0x13a)]){for(const {listMetadataItem:_0x14d391,files:_0x36d7cb}of _0x47de2d[_0x518516(0x13a)][_0xb708c0][_0x518516(0x156)]){const _0x33518d=new jszip_1['default']();for(const _0x390ed4 in _0x36d7cb){await _0x33518d[_0x518516(0x14d)](_0x390ed4,_0x36d7cb[_0x390ed4]);}const _0x5dc090=await _0x33518d[_0x518516(0x13c)]({'type':_0x518516(0x131),'compression':_0x518516(0x13f),'compressionOptions':{'level':0x9}}),_0x122419={..._0x14d391,'zip':_0x5dc090},_0x5a335d=(0x0,object_sizeof_1[_0x518516(0x14e)])(_0x122419);if(_0x5a335d>_0x124c00){await this['stateManager'][_0x518516(0x151)]('Item\x20\x27'+_0x14d391['fileName']+'\x27\x20size\x20\x27'+_0x5a335d+_0x518516(0x148)+_0x124c00+'\x27');continue;}if(_0x565a97+_0x5a335d>_0x124c00||_0x337cfd['length']>=_0x3b984b){const _0x4f83fd=await this['writeChunk'](_0x337cfd);_0x3ebfb7[_0x518516(0x147)](_0x4f83fd),_0x565a97=0x0,_0x337cfd=[];}_0x337cfd[_0x518516(0x147)](_0x122419),_0x565a97+=_0x5a335d;}}if(_0x337cfd[_0x518516(0x139)]){const _0x29134b=await this['writeChunk'](_0x337cfd);_0x3ebfb7[_0x518516(0x147)](_0x29134b);}await(0x0,promises_1[_0x518516(0x142)])(this[_0x518516(0x130)],JSON[_0x518516(0x152)](_0x3ebfb7));}}function a266_0x3f03(){const _0x16cc29=['addWarning','stringify','RETRIEVE_RESULTS_IDS_FILENAME','search','stateManager','components','init','../../../shared/utils/fs.utils','8573425GjQfOC','__importDefault','6283179uMPjTK','349668kHHvAh','shortid','writeChunk','RETRIEVE_RESULT_FOLDER_NAME','@flosum/salesforce','jobStorePath','join','logger','11UmnyEM','retrieveResultsPath','base64','path','create','metadataFolder','AuthManager','5127966SzOLRT','../../constants','330nxOvWi','length','items','5961312xIFvEu','generateAsync','../../../shared/managers/auth.manager','./retrieve-factory','DEFLATE','defineProperty','3lKCOJV','writeFile','makeDir','toString','8OIqRlB','(((.+)+)+)+$','push','\x27\x20exceed\x20limit\x20\x27','55630KmUCZy','./manifest-manger','AxiosInstanceUtils','__esModule','file','default','68212HCtlQL','apply'];a266_0x3f03=function(){return _0x16cc29;};return a266_0x3f03();}exports['default']=RetrieveMetadata;