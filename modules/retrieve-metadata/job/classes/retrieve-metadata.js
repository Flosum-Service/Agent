const a272_0x42374a=a272_0x59e9;(function(_0x9e0d53,_0x45d368){const _0x1d2c85=a272_0x59e9,_0xf4cb2=_0x9e0d53();while(!![]){try{const _0x48e20f=-parseInt(_0x1d2c85(0x1ad))/0x1*(-parseInt(_0x1d2c85(0x1a3))/0x2)+parseInt(_0x1d2c85(0x1a4))/0x3*(-parseInt(_0x1d2c85(0x1af))/0x4)+parseInt(_0x1d2c85(0x1be))/0x5+parseInt(_0x1d2c85(0x1b1))/0x6*(parseInt(_0x1d2c85(0x1aa))/0x7)+parseInt(_0x1d2c85(0x1c5))/0x8*(parseInt(_0x1d2c85(0x1c1))/0x9)+parseInt(_0x1d2c85(0x1b2))/0xa*(-parseInt(_0x1d2c85(0x194))/0xb)+parseInt(_0x1d2c85(0x1a7))/0xc*(parseInt(_0x1d2c85(0x1ab))/0xd);if(_0x48e20f===_0x45d368)break;else _0xf4cb2['push'](_0xf4cb2['shift']());}catch(_0x66e4c6){_0xf4cb2['push'](_0xf4cb2['shift']());}}}(a272_0x2bc4,0x6e98f));const a272_0x1bef1a=(function(){let _0x60c12e=!![];return function(_0x4f6dcf,_0x4c0d4a){const _0x2c3912=_0x60c12e?function(){const _0x4562b5=a272_0x59e9;if(_0x4c0d4a){const _0x4170a3=_0x4c0d4a[_0x4562b5(0x1a8)](_0x4f6dcf,arguments);return _0x4c0d4a=null,_0x4170a3;}}:function(){};return _0x60c12e=![],_0x2c3912;};}()),a272_0x23fa52=a272_0x1bef1a(this,function(){const _0x1fc814=a272_0x59e9;return a272_0x23fa52[_0x1fc814(0x192)]()[_0x1fc814(0x190)]('(((.+)+)+)+$')[_0x1fc814(0x192)]()[_0x1fc814(0x1bc)](a272_0x23fa52)[_0x1fc814(0x190)]('(((.+)+)+)+$');});function a272_0x59e9(_0x1e1ebe,_0x43800e){const _0x4b88c9=a272_0x2bc4();return a272_0x59e9=function(_0x23fa52,_0x1bef1a){_0x23fa52=_0x23fa52-0x190;let _0x2bc446=_0x4b88c9[_0x23fa52];return _0x2bc446;},a272_0x59e9(_0x1e1ebe,_0x43800e);}a272_0x23fa52();'use strict';var __importDefault=this&&this[a272_0x42374a(0x195)]||function(_0x34ce1a){const _0x13b767=a272_0x42374a;return _0x34ce1a&&_0x34ce1a[_0x13b767(0x1a9)]?_0x34ce1a:{'default':_0x34ce1a};};Object['defineProperty'](exports,a272_0x42374a(0x1a9),{'value':!![]});const salesforce_1=require(a272_0x42374a(0x1b0)),manifest_manger_1=__importDefault(require(a272_0x42374a(0x1c0))),path_1=__importDefault(require(a272_0x42374a(0x1a2))),promises_1=require(a272_0x42374a(0x19e)),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require(a272_0x42374a(0x1c3))),retrieve_factory_1=__importDefault(require(a272_0x42374a(0x1b9))),auth_manager_1=require(a272_0x42374a(0x1a1)),constants_1=require('../../constants'),shortid_1=__importDefault(require('shortid')),jszip_1=__importDefault(require(a272_0x42374a(0x198)));function a272_0x2bc4(){const _0x12d04f=['2666350qEWdnO','jobStorePath','./manifest-manger','603xbSffE','create','object-sizeof','items','39008gPwvWM','search','stringify','toString','AuthManager','742511bBBOFx','__importDefault','.json','default','jszip','AxiosInstanceUtils','\x27\x20size\x20\x27','execute','stateManager','push','fs/promises','retrieveResultsPath','writeFile','../../../shared/managers/auth.manager','path','86PIkIuu','12JjQefO','logger','file','24wuovUK','apply','__esModule','175PMVwGw','614952pVXpwp','join','751WHEdBO','writeChunk','527652IvsSnB','@flosum/salesforce','63312PBrXXm','40NQGPzX','fileName','length','DEFLATE','init','metadataFolder','addWarning','./retrieve-factory','RETRIEVE_RESULTS_IDS_FILENAME','components','constructor','base64'];a272_0x2bc4=function(){return _0x12d04f;};return a272_0x2bc4();}class RetrieveMetadata{constructor(_0x3a8045,_0x2cee56,_0x5599bb){const _0x4d1877=a272_0x42374a;this[_0x4d1877(0x1bf)]=_0x3a8045,this[_0x4d1877(0x1a5)]=_0x2cee56,this[_0x4d1877(0x19c)]=_0x5599bb,this[_0x4d1877(0x1b7)]=path_1[_0x4d1877(0x197)][_0x4d1877(0x1ac)](this[_0x4d1877(0x1bf)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0x4d1877(0x19f)]=path_1['default']['join'](this['jobStorePath'],constants_1[_0x4d1877(0x1ba)]);}async[a272_0x42374a(0x1ae)](_0x219ed4){const _0x32f620=a272_0x42374a,_0x229c0c=(0x0,shortid_1[_0x32f620(0x197)])();return await(0x0,promises_1[_0x32f620(0x1a0)])(path_1['default'][_0x32f620(0x1ac)](this[_0x32f620(0x1b7)],_0x229c0c+_0x32f620(0x196)),JSON[_0x32f620(0x191)](_0x219ed4)),_0x229c0c;}async[a272_0x42374a(0x19b)](){const _0x1bb756=a272_0x42374a,{credentials:_0x509487,declarativeFilter:_0x2d1b63,metadataTypes:_0x1d6747,maxChunkSize:_0x27909e,maxChunkItems:_0x10666d,apiVersion:_0x3e3e65}=await new manifest_manger_1[(_0x1bb756(0x197))](this['jobStorePath'])[_0x1bb756(0x1b6)](),_0x5e1db6=await salesforce_1[_0x1bb756(0x199)]['create'](new auth_manager_1[(_0x1bb756(0x193))](_0x509487),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x38e8ef=await retrieve_factory_1[_0x1bb756(0x197)][_0x1bb756(0x1c2)](_0x5e1db6,this['logger'],_0x2d1b63,_0x1d6747,_0x3e3e65)[_0x1bb756(0x19b)]();await(0x0,fs_utils_1['makeDir'])(this[_0x1bb756(0x1b7)]);let _0x54bf90=[];const _0x32f02e=[];let _0x26bede=0x0;for(const _0xf7a42c in _0x38e8ef[_0x1bb756(0x1c4)]){for(const {listMetadataItem:_0xc1aa88,files:_0x33abd3}of _0x38e8ef[_0x1bb756(0x1c4)][_0xf7a42c][_0x1bb756(0x1bb)]){const _0x51c891=new jszip_1[(_0x1bb756(0x197))]();for(const _0x4a2fba in _0x33abd3){await _0x51c891[_0x1bb756(0x1a6)](_0x4a2fba,_0x33abd3[_0x4a2fba]);}const _0x4419e4=await _0x51c891['generateAsync']({'type':_0x1bb756(0x1bd),'compression':_0x1bb756(0x1b5),'compressionOptions':{'level':0x9}}),_0x2c58ce={..._0xc1aa88,'zip':_0x4419e4},_0x606e45=(0x0,object_sizeof_1[_0x1bb756(0x197)])(_0x2c58ce);if(_0x606e45>_0x27909e){await this[_0x1bb756(0x19c)][_0x1bb756(0x1b8)]('Item\x20\x27'+_0xc1aa88[_0x1bb756(0x1b3)]+_0x1bb756(0x19a)+_0x606e45+'\x27\x20exceed\x20limit\x20\x27'+_0x27909e+'\x27');continue;}if(_0x26bede+_0x606e45>_0x27909e||_0x54bf90[_0x1bb756(0x1b4)]>=_0x10666d){const _0x23a1c2=await this[_0x1bb756(0x1ae)](_0x54bf90);_0x32f02e[_0x1bb756(0x19d)](_0x23a1c2),_0x26bede=0x0,_0x54bf90=[];}_0x54bf90['push'](_0x2c58ce),_0x26bede+=_0x606e45;}}if(_0x54bf90['length']){const _0x47fa8f=await this[_0x1bb756(0x1ae)](_0x54bf90);_0x32f02e[_0x1bb756(0x19d)](_0x47fa8f);}await(0x0,promises_1[_0x1bb756(0x1a0)])(this[_0x1bb756(0x19f)],JSON['stringify'](_0x32f02e));}}exports[a272_0x42374a(0x197)]=RetrieveMetadata;