const a267_0x42a7fe=a267_0x3043;(function(_0x2e4bc2,_0x57eba2){const _0x20348b=a267_0x3043,_0x52a32b=_0x2e4bc2();while(!![]){try{const _0xef15c9=parseInt(_0x20348b(0x21a))/0x1*(-parseInt(_0x20348b(0x20e))/0x2)+parseInt(_0x20348b(0x206))/0x3+-parseInt(_0x20348b(0x225))/0x4*(parseInt(_0x20348b(0x215))/0x5)+-parseInt(_0x20348b(0x221))/0x6*(-parseInt(_0x20348b(0x21c))/0x7)+-parseInt(_0x20348b(0x1f5))/0x8*(-parseInt(_0x20348b(0x1fc))/0x9)+parseInt(_0x20348b(0x218))/0xa*(-parseInt(_0x20348b(0x1f4))/0xb)+-parseInt(_0x20348b(0x209))/0xc*(-parseInt(_0x20348b(0x21d))/0xd);if(_0xef15c9===_0x57eba2)break;else _0x52a32b['push'](_0x52a32b['shift']());}catch(_0x51c3fc){_0x52a32b['push'](_0x52a32b['shift']());}}}(a267_0x50fb,0x663f8));function a267_0x3043(_0x4e1ffa,_0x51ceae){const _0x49f8c4=a267_0x50fb();return a267_0x3043=function(_0x130d5b,_0x48a11e){_0x130d5b=_0x130d5b-0x1ef;let _0x50fb3d=_0x49f8c4[_0x130d5b];return _0x50fb3d;},a267_0x3043(_0x4e1ffa,_0x51ceae);}const a267_0x48a11e=(function(){let _0x2615ca=!![];return function(_0x578301,_0x311f0e){const _0xd404c3=_0x2615ca?function(){if(_0x311f0e){const _0x4dd711=_0x311f0e['apply'](_0x578301,arguments);return _0x311f0e=null,_0x4dd711;}}:function(){};return _0x2615ca=![],_0xd404c3;};}()),a267_0x130d5b=a267_0x48a11e(this,function(){const _0x23defe=a267_0x3043;return a267_0x130d5b[_0x23defe(0x214)]()['search'](_0x23defe(0x1fd))[_0x23defe(0x214)]()['constructor'](a267_0x130d5b)['search']('(((.+)+)+)+$');});a267_0x130d5b();'use strict';var __importDefault=this&&this[a267_0x42a7fe(0x203)]||function(_0x18902e){const _0x20c667=a267_0x42a7fe;return _0x18902e&&_0x18902e[_0x20c667(0x202)]?_0x18902e:{'default':_0x18902e};};function a267_0x50fb(){const _0x3dc214=['__esModule','__importDefault','metadataFolder','generateAsync','1210770UqEJWE','stringify','init','12Bwalxo','DEFLATE','addWarning','.json','shortid','122ZCZibq','./manifest-manger','execute','fs/promises','base64','writeChunk','toString','1585cayVuc','join','AuthManager','4398670TAfxTJ','./retrieve-factory','11545OWZjuS','../../constants','32137FzmVSD','14097005lPFaIY','makeDir','components','logger','588woTikp','path','@flosum/salesforce','retrieveResultsPath','9572mmLIPV','\x27\x20size\x20\x27','RETRIEVE_RESULT_FOLDER_NAME','stateManager','jobStorePath','RETRIEVE_RESULTS_IDS_FILENAME','AxiosInstanceUtils','11AIoIjC','3068864SSnswM','jszip','default','../../../shared/managers/auth.manager','writeFile','items','defineProperty','9BsbeIb','(((.+)+)+)+$','push','length','Item\x20\x27','\x27\x20exceed\x20limit\x20\x27'];a267_0x50fb=function(){return _0x3dc214;};return a267_0x50fb();}Object[a267_0x42a7fe(0x1fb)](exports,a267_0x42a7fe(0x202),{'value':!![]});const salesforce_1=require(a267_0x42a7fe(0x223)),manifest_manger_1=__importDefault(require(a267_0x42a7fe(0x20f))),path_1=__importDefault(require(a267_0x42a7fe(0x222))),promises_1=require(a267_0x42a7fe(0x211)),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require(a267_0x42a7fe(0x219))),auth_manager_1=require(a267_0x42a7fe(0x1f8)),constants_1=require(a267_0x42a7fe(0x21b)),shortid_1=__importDefault(require(a267_0x42a7fe(0x20d))),jszip_1=__importDefault(require(a267_0x42a7fe(0x1f6)));class RetrieveMetadata{constructor(_0x453691,_0x5c98e2,_0x1a77c6){const _0x3b469d=a267_0x42a7fe;this[_0x3b469d(0x1f1)]=_0x453691,this[_0x3b469d(0x220)]=_0x5c98e2,this[_0x3b469d(0x1f0)]=_0x1a77c6,this['metadataFolder']=path_1[_0x3b469d(0x1f7)][_0x3b469d(0x216)](this[_0x3b469d(0x1f1)],constants_1[_0x3b469d(0x1ef)]),this['retrieveResultsPath']=path_1['default'][_0x3b469d(0x216)](this[_0x3b469d(0x1f1)],constants_1[_0x3b469d(0x1f2)]);}async['writeChunk'](_0x130784){const _0x422df7=a267_0x42a7fe,_0xfa58e1=(0x0,shortid_1[_0x422df7(0x1f7)])();return await(0x0,promises_1[_0x422df7(0x1f9)])(path_1[_0x422df7(0x1f7)]['join'](this['metadataFolder'],_0xfa58e1+_0x422df7(0x20c)),JSON[_0x422df7(0x207)](_0x130784)),_0xfa58e1;}async[a267_0x42a7fe(0x210)](){const _0x3c91de=a267_0x42a7fe,{credentials:_0x349da3,declarativeFilter:_0x43c19b,metadataTypes:_0x1f8c1a,maxChunkSize:_0x1c997e,maxChunkItems:_0x34b6ca,apiVersion:_0x422c57}=await new manifest_manger_1[(_0x3c91de(0x1f7))](this[_0x3c91de(0x1f1)])[_0x3c91de(0x208)](),_0x3249f1=await salesforce_1[_0x3c91de(0x1f3)]['create'](new auth_manager_1[(_0x3c91de(0x217))](_0x349da3),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x2e0198=await retrieve_factory_1[_0x3c91de(0x1f7)]['create'](_0x3249f1,this['logger'],_0x43c19b,_0x1f8c1a,_0x422c57)[_0x3c91de(0x210)]();await(0x0,fs_utils_1[_0x3c91de(0x21e)])(this[_0x3c91de(0x204)]);let _0x3e1ce8=[];const _0x35c7d3=[];let _0x346b45=0x0;for(const _0x126909 in _0x2e0198[_0x3c91de(0x1fa)]){for(const {listMetadataItem:_0x44ce2b,files:_0x185682}of _0x2e0198[_0x3c91de(0x1fa)][_0x126909][_0x3c91de(0x21f)]){const _0x30f7cb=new jszip_1['default']();for(const _0x4b718c in _0x185682){await _0x30f7cb['file'](_0x4b718c,_0x185682[_0x4b718c]);}const _0x5dfa60=await _0x30f7cb[_0x3c91de(0x205)]({'type':_0x3c91de(0x212),'compression':_0x3c91de(0x20a),'compressionOptions':{'level':0x9}}),_0x3028ce={..._0x44ce2b,'zip':_0x5dfa60},_0x3ec79b=(0x0,object_sizeof_1['default'])(_0x3028ce);if(_0x3ec79b>_0x1c997e){await this[_0x3c91de(0x1f0)][_0x3c91de(0x20b)](_0x3c91de(0x200)+_0x44ce2b['fileName']+_0x3c91de(0x226)+_0x3ec79b+_0x3c91de(0x201)+_0x1c997e+'\x27');continue;}if(_0x346b45+_0x3ec79b>_0x1c997e||_0x3e1ce8[_0x3c91de(0x1ff)]>=_0x34b6ca){const _0x14aab7=await this[_0x3c91de(0x213)](_0x3e1ce8);_0x35c7d3[_0x3c91de(0x1fe)](_0x14aab7),_0x346b45=0x0,_0x3e1ce8=[];}_0x3e1ce8[_0x3c91de(0x1fe)](_0x3028ce),_0x346b45+=_0x3ec79b;}}if(_0x3e1ce8[_0x3c91de(0x1ff)]){const _0x545a02=await this[_0x3c91de(0x213)](_0x3e1ce8);_0x35c7d3[_0x3c91de(0x1fe)](_0x545a02);}await(0x0,promises_1[_0x3c91de(0x1f9)])(this[_0x3c91de(0x224)],JSON[_0x3c91de(0x207)](_0x35c7d3));}}exports['default']=RetrieveMetadata;