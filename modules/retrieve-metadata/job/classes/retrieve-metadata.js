function a315_0x353b(){const _0x3de1f4=['object-sizeof','jobStorePath','generateAsync','(((.+)+)+)+$','stringify','1388740mbDKEd','./manifest-manger','create','.json','\x27\x20size\x20\x27','file','jszip','default','components','defineProperty','fs/promises','../../../shared/managers/auth.manager','../../../shared/utils/fs.utils','join','__importDefault','AxiosInstanceUtils','Item\x20\x27','base64','\x27\x20exceed\x20limit\x20\x27','1601919qGUXoz','search','writeFile','addWarning','stateManager','writeChunk','shortid','1230448hERKsb','retrieveResultsPath','logger','push','126287ENbmZN','constructor','items','DEFLATE','execute','length','12645616yWPZzG','179034WEzwsr','@flosum/salesforce','RETRIEVE_RESULT_FOLDER_NAME','490UhLhQS','13728xzsXTM','metadataFolder'];a315_0x353b=function(){return _0x3de1f4;};return a315_0x353b();}const a315_0x1cec0a=a315_0x21b0;function a315_0x21b0(_0x5b8f36,_0x168193){const _0x3b4a8c=a315_0x353b();return a315_0x21b0=function(_0x3744e7,_0x2d977c){_0x3744e7=_0x3744e7-0xf2;let _0x353b38=_0x3b4a8c[_0x3744e7];return _0x353b38;},a315_0x21b0(_0x5b8f36,_0x168193);}(function(_0x1d8a83,_0x5c1917){const _0x186b2d=a315_0x21b0,_0x3eb01f=_0x1d8a83();while(!![]){try{const _0x2d9a1a=parseInt(_0x186b2d(0x107))/0x1+parseInt(_0x186b2d(0xfc))/0x2+parseInt(_0x186b2d(0xf5))/0x3+parseInt(_0x186b2d(0x112))/0x4+-parseInt(_0x186b2d(0x10a))/0x5*(-parseInt(_0x186b2d(0x10b))/0x6)+parseInt(_0x186b2d(0x100))/0x7+-parseInt(_0x186b2d(0x106))/0x8;if(_0x2d9a1a===_0x5c1917)break;else _0x3eb01f['push'](_0x3eb01f['shift']());}catch(_0x38d58c){_0x3eb01f['push'](_0x3eb01f['shift']());}}}(a315_0x353b,0x52453));const a315_0x2d977c=(function(){let _0x20d122=!![];return function(_0x5de5c1,_0x46f838){const _0x5b8e38=_0x20d122?function(){if(_0x46f838){const _0x3a0fcf=_0x46f838['apply'](_0x5de5c1,arguments);return _0x46f838=null,_0x3a0fcf;}}:function(){};return _0x20d122=![],_0x5b8e38;};}()),a315_0x3744e7=a315_0x2d977c(this,function(){const _0x10f033=a315_0x21b0;return a315_0x3744e7['toString']()[_0x10f033(0xf6)](_0x10f033(0x110))['toString']()[_0x10f033(0x101)](a315_0x3744e7)['search']('(((.+)+)+)+$');});a315_0x3744e7();'use strict';var __importDefault=this&&this[a315_0x1cec0a(0x120)]||function(_0xcc5bd3){return _0xcc5bd3&&_0xcc5bd3['__esModule']?_0xcc5bd3:{'default':_0xcc5bd3};};Object[a315_0x1cec0a(0x11b)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a315_0x1cec0a(0x108)),manifest_manger_1=__importDefault(require(a315_0x1cec0a(0x113))),path_1=__importDefault(require('path')),promises_1=require(a315_0x1cec0a(0x11c)),fs_utils_1=require(a315_0x1cec0a(0x11e)),object_sizeof_1=__importDefault(require(a315_0x1cec0a(0x10d))),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require(a315_0x1cec0a(0x11d)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a315_0x1cec0a(0xfb))),jszip_1=__importDefault(require(a315_0x1cec0a(0x118)));class RetrieveMetadata{constructor(_0x4a4b25,_0x443be9,_0x20ea57){const _0x1ebede=a315_0x1cec0a;this[_0x1ebede(0x10e)]=_0x4a4b25,this[_0x1ebede(0xfe)]=_0x443be9,this[_0x1ebede(0xf9)]=_0x20ea57,this[_0x1ebede(0x10c)]=path_1[_0x1ebede(0x119)][_0x1ebede(0x11f)](this[_0x1ebede(0x10e)],constants_1[_0x1ebede(0x109)]),this[_0x1ebede(0xfd)]=path_1[_0x1ebede(0x119)][_0x1ebede(0x11f)](this[_0x1ebede(0x10e)],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async[a315_0x1cec0a(0xfa)](_0x101639){const _0x28aba3=a315_0x1cec0a,_0x3ce675=(0x0,shortid_1[_0x28aba3(0x119)])();return await(0x0,promises_1[_0x28aba3(0xf7)])(path_1['default'][_0x28aba3(0x11f)](this[_0x28aba3(0x10c)],_0x3ce675+_0x28aba3(0x115)),JSON[_0x28aba3(0x111)](_0x101639)),_0x3ce675;}async[a315_0x1cec0a(0x104)](){const _0x55c5e6=a315_0x1cec0a,{credentials:_0x26abc9,declarativeFilter:_0x4a159c,metadataTypes:_0x790e51,maxChunkSize:_0x1ffa18,maxChunkItems:_0x8029d,apiVersion:_0x4108a6}=await new manifest_manger_1['default'](this['jobStorePath'])['init'](),_0xb103dc=await salesforce_1[_0x55c5e6(0x121)][_0x55c5e6(0x114)](new auth_manager_1['AuthManager'](_0x26abc9),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x5a3ce6=await retrieve_factory_1[_0x55c5e6(0x119)][_0x55c5e6(0x114)](_0xb103dc,this['logger'],_0x4a159c,_0x790e51,_0x4108a6)['execute']();await(0x0,fs_utils_1['makeDir'])(this[_0x55c5e6(0x10c)]);let _0x17fa73=[];const _0x588220=[];let _0x1274e1=0x0;for(const _0x1855df in _0x5a3ce6[_0x55c5e6(0x102)]){for(const {listMetadataItem:_0x55520e,files:_0x3c8693}of _0x5a3ce6[_0x55c5e6(0x102)][_0x1855df][_0x55c5e6(0x11a)]){const _0x423d25=new jszip_1['default']();for(const _0x561bbf in _0x3c8693){await _0x423d25[_0x55c5e6(0x117)](_0x561bbf,_0x3c8693[_0x561bbf]);}const _0x48b939=await _0x423d25[_0x55c5e6(0x10f)]({'type':_0x55c5e6(0xf3),'compression':_0x55c5e6(0x103),'compressionOptions':{'level':0x9}}),_0x2aadad={..._0x55520e,'zip':_0x48b939},_0x1729c9=(0x0,object_sizeof_1[_0x55c5e6(0x119)])(_0x2aadad);if(_0x1729c9>_0x1ffa18){await this[_0x55c5e6(0xf9)][_0x55c5e6(0xf8)](_0x55c5e6(0xf2)+_0x55520e['fileName']+_0x55c5e6(0x116)+_0x1729c9+_0x55c5e6(0xf4)+_0x1ffa18+'\x27');continue;}if(_0x1274e1+_0x1729c9>_0x1ffa18||_0x17fa73[_0x55c5e6(0x105)]>=_0x8029d){const _0x2cb7e1=await this[_0x55c5e6(0xfa)](_0x17fa73);_0x588220['push'](_0x2cb7e1),_0x1274e1=0x0,_0x17fa73=[];}_0x17fa73['push'](_0x2aadad),_0x1274e1+=_0x1729c9;}}if(_0x17fa73[_0x55c5e6(0x105)]){const _0x54b3b9=await this[_0x55c5e6(0xfa)](_0x17fa73);_0x588220[_0x55c5e6(0xff)](_0x54b3b9);}await(0x0,promises_1['writeFile'])(this['retrieveResultsPath'],JSON[_0x55c5e6(0x111)](_0x588220));}}exports['default']=RetrieveMetadata;