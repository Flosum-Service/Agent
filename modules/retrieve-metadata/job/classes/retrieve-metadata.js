const a314_0x42c0c8=a314_0x34c0;function a314_0x3b83(){const _0x2b041a=['../../../shared/managers/auth.manager','join','\x27\x20exceed\x20limit\x20\x27','fileName','stateManager','logger','shortid','toString','components','length','base64','path','object-sizeof','create','9711xjxzNr','retrieveResultsPath','3829644McJuXN','metadataFolder','Item\x20\x27','default','items','62346lybISm','push','jobStorePath','../../constants','446274rGncDT','stringify','1228itxzeX','5pgWMvs','apply','DEFLATE','__esModule','RETRIEVE_RESULTS_IDS_FILENAME','8705058TJuUuJ','constructor','1kEhUof','13341512QKYLtm','execute','27581213CbqaBw','generateAsync','RETRIEVE_RESULT_FOLDER_NAME','\x27\x20size\x20\x27','50xWKcVk','./manifest-manger','writeChunk','search'];a314_0x3b83=function(){return _0x2b041a;};return a314_0x3b83();}(function(_0x344f65,_0x6e2b8a){const _0x5eb70b=a314_0x34c0,_0x45054c=_0x344f65();while(!![]){try{const _0x5876a2=-parseInt(_0x5eb70b(0x189))/0x1*(parseInt(_0x5eb70b(0x17b))/0x2)+parseInt(_0x5eb70b(0x174))/0x3*(-parseInt(_0x5eb70b(0x181))/0x4)+parseInt(_0x5eb70b(0x182))/0x5*(-parseInt(_0x5eb70b(0x187))/0x6)+-parseInt(_0x5eb70b(0x176))/0x7+parseInt(_0x5eb70b(0x18a))/0x8+-parseInt(_0x5eb70b(0x17f))/0x9*(parseInt(_0x5eb70b(0x162))/0xa)+parseInt(_0x5eb70b(0x18c))/0xb;if(_0x5876a2===_0x6e2b8a)break;else _0x45054c['push'](_0x45054c['shift']());}catch(_0x322f2a){_0x45054c['push'](_0x45054c['shift']());}}}(a314_0x3b83,0xdcc53));const a314_0x6054cd=(function(){let _0x246b88=!![];return function(_0x242ff8,_0x2fddcf){const _0x2f5885=_0x246b88?function(){const _0x468e5d=a314_0x34c0;if(_0x2fddcf){const _0x4b5f61=_0x2fddcf[_0x468e5d(0x183)](_0x242ff8,arguments);return _0x2fddcf=null,_0x4b5f61;}}:function(){};return _0x246b88=![],_0x2f5885;};}()),a314_0x533560=a314_0x6054cd(this,function(){const _0x1e13d8=a314_0x34c0;return a314_0x533560[_0x1e13d8(0x16d)]()['search']('(((.+)+)+)+$')[_0x1e13d8(0x16d)]()[_0x1e13d8(0x188)](a314_0x533560)[_0x1e13d8(0x165)]('(((.+)+)+)+$');});a314_0x533560();'use strict';function a314_0x34c0(_0x385371,_0x29e074){const _0x5ab61a=a314_0x3b83();return a314_0x34c0=function(_0x533560,_0x6054cd){_0x533560=_0x533560-0x160;let _0x3b83af=_0x5ab61a[_0x533560];return _0x3b83af;},a314_0x34c0(_0x385371,_0x29e074);}var __importDefault=this&&this['__importDefault']||function(_0x53546c){const _0x426233=a314_0x34c0;return _0x53546c&&_0x53546c[_0x426233(0x185)]?_0x53546c:{'default':_0x53546c};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const salesforce_1=require('@flosum/salesforce'),manifest_manger_1=__importDefault(require(a314_0x42c0c8(0x163))),path_1=__importDefault(require(a314_0x42c0c8(0x171))),promises_1=require('fs/promises'),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require(a314_0x42c0c8(0x172))),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require(a314_0x42c0c8(0x166)),constants_1=require(a314_0x42c0c8(0x17e)),shortid_1=__importDefault(require(a314_0x42c0c8(0x16c))),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x5e02d0,_0x556db5,_0x207aed){const _0x46708d=a314_0x42c0c8;this['jobStorePath']=_0x5e02d0,this[_0x46708d(0x16b)]=_0x556db5,this[_0x46708d(0x16a)]=_0x207aed,this[_0x46708d(0x177)]=path_1[_0x46708d(0x179)]['join'](this[_0x46708d(0x17d)],constants_1[_0x46708d(0x160)]),this[_0x46708d(0x175)]=path_1[_0x46708d(0x179)]['join'](this[_0x46708d(0x17d)],constants_1[_0x46708d(0x186)]);}async[a314_0x42c0c8(0x164)](_0x3e59b6){const _0x1b1c60=a314_0x42c0c8,_0x5e697a=(0x0,shortid_1[_0x1b1c60(0x179)])();return await(0x0,promises_1['writeFile'])(path_1[_0x1b1c60(0x179)][_0x1b1c60(0x167)](this[_0x1b1c60(0x177)],_0x5e697a+'.json'),JSON[_0x1b1c60(0x180)](_0x3e59b6)),_0x5e697a;}async['execute'](){const _0x5c2dc0=a314_0x42c0c8,{credentials:_0x16372b,declarativeFilter:_0x35cf8d,metadataTypes:_0x28efcc,maxChunkSize:_0x41476e,maxChunkItems:_0xe7d270,apiVersion:_0x27fbd6}=await new manifest_manger_1[(_0x5c2dc0(0x179))](this['jobStorePath'])['init'](),_0x263b58=await salesforce_1['AxiosInstanceUtils'][_0x5c2dc0(0x173)](new auth_manager_1['AuthManager'](_0x16372b),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x46639f=await retrieve_factory_1['default'][_0x5c2dc0(0x173)](_0x263b58,this[_0x5c2dc0(0x16b)],_0x35cf8d,_0x28efcc,_0x27fbd6)[_0x5c2dc0(0x18b)]();await(0x0,fs_utils_1['makeDir'])(this[_0x5c2dc0(0x177)]);let _0x561a66=[];const _0xa16464=[];let _0x5bd8a0=0x0;for(const _0x1414be in _0x46639f[_0x5c2dc0(0x17a)]){for(const {listMetadataItem:_0x444b21,files:_0x5d4094}of _0x46639f[_0x5c2dc0(0x17a)][_0x1414be][_0x5c2dc0(0x16e)]){const _0x22ed8f=new jszip_1[(_0x5c2dc0(0x179))]();for(const _0x272c9e in _0x5d4094){await _0x22ed8f['file'](_0x272c9e,_0x5d4094[_0x272c9e]);}const _0x5ac3db=await _0x22ed8f[_0x5c2dc0(0x18d)]({'type':_0x5c2dc0(0x170),'compression':_0x5c2dc0(0x184),'compressionOptions':{'level':0x9}}),_0x364280={..._0x444b21,'zip':_0x5ac3db},_0x3cc485=(0x0,object_sizeof_1[_0x5c2dc0(0x179)])(_0x364280);if(_0x3cc485>_0x41476e){await this[_0x5c2dc0(0x16a)]['addWarning'](_0x5c2dc0(0x178)+_0x444b21[_0x5c2dc0(0x169)]+_0x5c2dc0(0x161)+_0x3cc485+_0x5c2dc0(0x168)+_0x41476e+'\x27');continue;}if(_0x5bd8a0+_0x3cc485>_0x41476e||_0x561a66[_0x5c2dc0(0x16f)]>=_0xe7d270){const _0x346c51=await this[_0x5c2dc0(0x164)](_0x561a66);_0xa16464[_0x5c2dc0(0x17c)](_0x346c51),_0x5bd8a0=0x0,_0x561a66=[];}_0x561a66[_0x5c2dc0(0x17c)](_0x364280),_0x5bd8a0+=_0x3cc485;}}if(_0x561a66[_0x5c2dc0(0x16f)]){const _0x4770f8=await this[_0x5c2dc0(0x164)](_0x561a66);_0xa16464[_0x5c2dc0(0x17c)](_0x4770f8);}await(0x0,promises_1['writeFile'])(this['retrieveResultsPath'],JSON[_0x5c2dc0(0x180)](_0xa16464));}}exports[a314_0x42c0c8(0x179)]=RetrieveMetadata;