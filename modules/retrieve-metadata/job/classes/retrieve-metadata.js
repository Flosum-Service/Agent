function a267_0x2029(){const _0x2b7786=['stringify','items','./manifest-manger','init','base64','RETRIEVE_RESULTS_IDS_FILENAME','constructor','stateManager','create','__importDefault','join','566834JFDAJE','makeDir','Item\x20\x27','path','components','28271480rwrxNz','6oBvPFt','apply','(((.+)+)+)+$','generateAsync','file','search','metadataFolder','default','AuthManager','jobStorePath','2562ZwbztO','toString','writeFile','jszip','fs/promises','1976290MKwWwQ','../../../shared/managers/auth.manager','AxiosInstanceUtils','DEFLATE','54uUGwis','232184BttWSt','./retrieve-factory','length','../../constants','push','shortid','@flosum/salesforce','retrieveResultsPath','addWarning','defineProperty','224wBkHzu','10904670YXkmPO','.json','execute','39405eerEuO','logger','writeChunk'];a267_0x2029=function(){return _0x2b7786;};return a267_0x2029();}const a267_0x2cc0f1=a267_0x17bd;(function(_0x295d85,_0x1df82f){const _0x48cd53=a267_0x17bd,_0x32c6b8=_0x295d85();while(!![]){try{const _0xa2ef65=-parseInt(_0x48cd53(0x14d))/0x1+-parseInt(_0x48cd53(0x15b))/0x2+-parseInt(_0x48cd53(0x13e))/0x3*(parseInt(_0x48cd53(0x13f))/0x4)+-parseInt(_0x48cd53(0x13a))/0x5*(-parseInt(_0x48cd53(0x161))/0x6)+-parseInt(_0x48cd53(0x16b))/0x7*(parseInt(_0x48cd53(0x149))/0x8)+-parseInt(_0x48cd53(0x14a))/0x9+parseInt(_0x48cd53(0x160))/0xa;if(_0xa2ef65===_0x1df82f)break;else _0x32c6b8['push'](_0x32c6b8['shift']());}catch(_0x1f5b6e){_0x32c6b8['push'](_0x32c6b8['shift']());}}}(a267_0x2029,0x9a82e));const a267_0x3a10a8=(function(){let _0x5a627c=!![];return function(_0x307ee5,_0x4fb25b){const _0x16afe0=_0x5a627c?function(){const _0xb39487=a267_0x17bd;if(_0x4fb25b){const _0x57ee6c=_0x4fb25b[_0xb39487(0x162)](_0x307ee5,arguments);return _0x4fb25b=null,_0x57ee6c;}}:function(){};return _0x5a627c=![],_0x16afe0;};}()),a267_0x4e07d1=a267_0x3a10a8(this,function(){const _0x3ce37c=a267_0x17bd;return a267_0x4e07d1['toString']()['search'](_0x3ce37c(0x163))[_0x3ce37c(0x136)]()[_0x3ce37c(0x156)](a267_0x4e07d1)[_0x3ce37c(0x166)](_0x3ce37c(0x163));});function a267_0x17bd(_0x1f786a,_0x11a726){const _0x588833=a267_0x2029();return a267_0x17bd=function(_0x4e07d1,_0x3a10a8){_0x4e07d1=_0x4e07d1-0x136;let _0x20294b=_0x588833[_0x4e07d1];return _0x20294b;},a267_0x17bd(_0x1f786a,_0x11a726);}a267_0x4e07d1();'use strict';var __importDefault=this&&this[a267_0x2cc0f1(0x159)]||function(_0x223f4d){return _0x223f4d&&_0x223f4d['__esModule']?_0x223f4d:{'default':_0x223f4d};};Object[a267_0x2cc0f1(0x148)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a267_0x2cc0f1(0x145)),manifest_manger_1=__importDefault(require(a267_0x2cc0f1(0x152))),path_1=__importDefault(require(a267_0x2cc0f1(0x15e))),promises_1=require(a267_0x2cc0f1(0x139)),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require(a267_0x2cc0f1(0x140))),auth_manager_1=require(a267_0x2cc0f1(0x13b)),constants_1=require(a267_0x2cc0f1(0x142)),shortid_1=__importDefault(require(a267_0x2cc0f1(0x144))),jszip_1=__importDefault(require(a267_0x2cc0f1(0x138)));class RetrieveMetadata{constructor(_0x1caad5,_0x3055bb,_0x3ddefd){const _0x146209=a267_0x2cc0f1;this[_0x146209(0x16a)]=_0x1caad5,this['logger']=_0x3055bb,this[_0x146209(0x157)]=_0x3ddefd,this[_0x146209(0x167)]=path_1[_0x146209(0x168)][_0x146209(0x15a)](this[_0x146209(0x16a)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0x146209(0x146)]=path_1[_0x146209(0x168)][_0x146209(0x15a)](this[_0x146209(0x16a)],constants_1[_0x146209(0x155)]);}async[a267_0x2cc0f1(0x14f)](_0x135603){const _0x49616c=a267_0x2cc0f1,_0x2b6382=(0x0,shortid_1[_0x49616c(0x168)])();return await(0x0,promises_1['writeFile'])(path_1[_0x49616c(0x168)][_0x49616c(0x15a)](this[_0x49616c(0x167)],_0x2b6382+_0x49616c(0x14b)),JSON['stringify'](_0x135603)),_0x2b6382;}async[a267_0x2cc0f1(0x14c)](){const _0x16e5ed=a267_0x2cc0f1,{credentials:_0xc7b7bf,declarativeFilter:_0x105289,metadataTypes:_0x10af4c,maxChunkSize:_0x1fa85f,maxChunkItems:_0x211e4e,apiVersion:_0x15929f}=await new manifest_manger_1['default'](this[_0x16e5ed(0x16a)])[_0x16e5ed(0x153)](),_0x362ebc=await salesforce_1[_0x16e5ed(0x13c)][_0x16e5ed(0x158)](new auth_manager_1[(_0x16e5ed(0x169))](_0xc7b7bf),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x3784e0=await retrieve_factory_1['default'][_0x16e5ed(0x158)](_0x362ebc,this[_0x16e5ed(0x14e)],_0x105289,_0x10af4c,_0x15929f)[_0x16e5ed(0x14c)]();await(0x0,fs_utils_1[_0x16e5ed(0x15c)])(this[_0x16e5ed(0x167)]);let _0x38b883=[];const _0x1e3374=[];let _0x460f9a=0x0;for(const _0x298c0c in _0x3784e0[_0x16e5ed(0x151)]){for(const {listMetadataItem:_0x3595c0,files:_0x3d77e6}of _0x3784e0['items'][_0x298c0c][_0x16e5ed(0x15f)]){const _0x3f4d87=new jszip_1['default']();for(const _0x19e341 in _0x3d77e6){await _0x3f4d87[_0x16e5ed(0x165)](_0x19e341,_0x3d77e6[_0x19e341]);}const _0x28ffa5=await _0x3f4d87[_0x16e5ed(0x164)]({'type':_0x16e5ed(0x154),'compression':_0x16e5ed(0x13d),'compressionOptions':{'level':0x9}}),_0x35ae8b={..._0x3595c0,'zip':_0x28ffa5},_0x50d4d9=(0x0,object_sizeof_1[_0x16e5ed(0x168)])(_0x35ae8b);if(_0x50d4d9>_0x1fa85f){await this['stateManager'][_0x16e5ed(0x147)](_0x16e5ed(0x15d)+_0x3595c0['fileName']+'\x27\x20size\x20\x27'+_0x50d4d9+'\x27\x20exceed\x20limit\x20\x27'+_0x1fa85f+'\x27');continue;}if(_0x460f9a+_0x50d4d9>_0x1fa85f||_0x38b883[_0x16e5ed(0x141)]>=_0x211e4e){const _0x52f17e=await this['writeChunk'](_0x38b883);_0x1e3374[_0x16e5ed(0x143)](_0x52f17e),_0x460f9a=0x0,_0x38b883=[];}_0x38b883['push'](_0x35ae8b),_0x460f9a+=_0x50d4d9;}}if(_0x38b883['length']){const _0x8272f5=await this[_0x16e5ed(0x14f)](_0x38b883);_0x1e3374[_0x16e5ed(0x143)](_0x8272f5);}await(0x0,promises_1[_0x16e5ed(0x137)])(this[_0x16e5ed(0x146)],JSON[_0x16e5ed(0x150)](_0x1e3374));}}exports[a267_0x2cc0f1(0x168)]=RetrieveMetadata;