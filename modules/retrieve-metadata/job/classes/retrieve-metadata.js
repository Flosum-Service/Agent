const a272_0x5e6e5a=a272_0x5780;(function(_0xe3dd9a,_0x102b35){const _0x502930=a272_0x5780,_0x54783e=_0xe3dd9a();while(!![]){try{const _0xf0e4f2=-parseInt(_0x502930(0x1cc))/0x1+-parseInt(_0x502930(0x1ed))/0x2+parseInt(_0x502930(0x1ef))/0x3*(parseInt(_0x502930(0x1e0))/0x4)+parseInt(_0x502930(0x1e3))/0x5+parseInt(_0x502930(0x1d4))/0x6+parseInt(_0x502930(0x1d3))/0x7+-parseInt(_0x502930(0x1dc))/0x8*(parseInt(_0x502930(0x1ec))/0x9);if(_0xf0e4f2===_0x102b35)break;else _0x54783e['push'](_0x54783e['shift']());}catch(_0x59e487){_0x54783e['push'](_0x54783e['shift']());}}}(a272_0x4544,0xd7938));const a272_0x4ecbcf=(function(){let _0x378fa2=!![];return function(_0x180d99,_0x54f129){const _0x15c788=_0x378fa2?function(){const _0x47e786=a272_0x5780;if(_0x54f129){const _0x24a64a=_0x54f129[_0x47e786(0x1e1)](_0x180d99,arguments);return _0x54f129=null,_0x24a64a;}}:function(){};return _0x378fa2=![],_0x15c788;};}()),a272_0x5a9b9a=a272_0x4ecbcf(this,function(){const _0x821f0f=a272_0x5780;return a272_0x5a9b9a['toString']()[_0x821f0f(0x1c3)](_0x821f0f(0x1da))[_0x821f0f(0x1d0)]()[_0x821f0f(0x1d2)](a272_0x5a9b9a)[_0x821f0f(0x1c3)](_0x821f0f(0x1da));});a272_0x5a9b9a();function a272_0x5780(_0xc6cab,_0x6ead30){const _0x52774d=a272_0x4544();return a272_0x5780=function(_0x5a9b9a,_0x4ecbcf){_0x5a9b9a=_0x5a9b9a-0x1c2;let _0x4544ed=_0x52774d[_0x5a9b9a];return _0x4544ed;},a272_0x5780(_0xc6cab,_0x6ead30);}function a272_0x4544(){const _0x3839a4=['4510197qzejjF','writeFile','items','execute','../../../shared/utils/fs.utils','addWarning','defineProperty','path','search','\x27\x20exceed\x20limit\x20\x27','default','writeChunk','RETRIEVE_RESULT_FOLDER_NAME','AxiosInstanceUtils','object-sizeof','__importDefault','length','508831nkEPER','__esModule','generateAsync','fs/promises','toString','Item\x20\x27','constructor','11261054wMwvkk','202242BSLgQg','../../constants','\x27\x20size\x20\x27','create','push','../../../shared/managers/auth.manager','(((.+)+)+)+$','DEFLATE','419960cLfxCA','stringify','logger','@flosum/salesforce','4jUZaKF','apply','RETRIEVE_RESULTS_IDS_FILENAME','6869975CTAuqw','./manifest-manger','./retrieve-factory','base64','init','makeDir','jobStorePath','metadataFolder','components','369wnhTOb','1951394GZODNL','join'];a272_0x4544=function(){return _0x3839a4;};return a272_0x4544();}'use strict';var __importDefault=this&&this[a272_0x5e6e5a(0x1ca)]||function(_0xa24857){const _0x1b0f41=a272_0x5e6e5a;return _0xa24857&&_0xa24857[_0x1b0f41(0x1cd)]?_0xa24857:{'default':_0xa24857};};Object[a272_0x5e6e5a(0x1f5)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a272_0x5e6e5a(0x1df)),manifest_manger_1=__importDefault(require(a272_0x5e6e5a(0x1e4))),path_1=__importDefault(require(a272_0x5e6e5a(0x1c2))),promises_1=require(a272_0x5e6e5a(0x1cf)),fs_utils_1=require(a272_0x5e6e5a(0x1f3)),object_sizeof_1=__importDefault(require(a272_0x5e6e5a(0x1c9))),retrieve_factory_1=__importDefault(require(a272_0x5e6e5a(0x1e5))),auth_manager_1=require(a272_0x5e6e5a(0x1d9)),constants_1=require(a272_0x5e6e5a(0x1d5)),shortid_1=__importDefault(require('shortid')),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x5d6444,_0x187c9e,_0x22f3db){const _0x550233=a272_0x5e6e5a;this[_0x550233(0x1e9)]=_0x5d6444,this[_0x550233(0x1de)]=_0x187c9e,this['stateManager']=_0x22f3db,this[_0x550233(0x1ea)]=path_1[_0x550233(0x1c5)][_0x550233(0x1ee)](this[_0x550233(0x1e9)],constants_1[_0x550233(0x1c7)]),this['retrieveResultsPath']=path_1[_0x550233(0x1c5)][_0x550233(0x1ee)](this[_0x550233(0x1e9)],constants_1[_0x550233(0x1e2)]);}async[a272_0x5e6e5a(0x1c6)](_0x13199c){const _0x3864e4=a272_0x5e6e5a,_0x126852=(0x0,shortid_1[_0x3864e4(0x1c5)])();return await(0x0,promises_1[_0x3864e4(0x1f0)])(path_1[_0x3864e4(0x1c5)][_0x3864e4(0x1ee)](this[_0x3864e4(0x1ea)],_0x126852+'.json'),JSON[_0x3864e4(0x1dd)](_0x13199c)),_0x126852;}async[a272_0x5e6e5a(0x1f2)](){const _0xe0d93a=a272_0x5e6e5a,{credentials:_0x1de7a9,declarativeFilter:_0x19453e,metadataTypes:_0x221803,maxChunkSize:_0x2da31c,maxChunkItems:_0x2dffcb,apiVersion:_0x40a7bf}=await new manifest_manger_1['default'](this['jobStorePath'])[_0xe0d93a(0x1e7)](),_0x393a89=await salesforce_1[_0xe0d93a(0x1c8)]['create'](new auth_manager_1['AuthManager'](_0x1de7a9),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x3b0269=await retrieve_factory_1[_0xe0d93a(0x1c5)][_0xe0d93a(0x1d7)](_0x393a89,this[_0xe0d93a(0x1de)],_0x19453e,_0x221803,_0x40a7bf)['execute']();await(0x0,fs_utils_1[_0xe0d93a(0x1e8)])(this[_0xe0d93a(0x1ea)]);let _0x51f7a1=[];const _0x7d504b=[];let _0x1bb9d0=0x0;for(const _0x4e7f54 in _0x3b0269[_0xe0d93a(0x1f1)]){for(const {listMetadataItem:_0x8a8c64,files:_0xfdf0aa}of _0x3b0269['items'][_0x4e7f54][_0xe0d93a(0x1eb)]){const _0x2a3a49=new jszip_1['default']();for(const _0xe01eae in _0xfdf0aa){await _0x2a3a49['file'](_0xe01eae,_0xfdf0aa[_0xe01eae]);}const _0x4c907b=await _0x2a3a49[_0xe0d93a(0x1ce)]({'type':_0xe0d93a(0x1e6),'compression':_0xe0d93a(0x1db),'compressionOptions':{'level':0x9}}),_0x1203d3={..._0x8a8c64,'zip':_0x4c907b},_0x45938c=(0x0,object_sizeof_1[_0xe0d93a(0x1c5)])(_0x1203d3);if(_0x45938c>_0x2da31c){await this['stateManager'][_0xe0d93a(0x1f4)](_0xe0d93a(0x1d1)+_0x8a8c64['fileName']+_0xe0d93a(0x1d6)+_0x45938c+_0xe0d93a(0x1c4)+_0x2da31c+'\x27');continue;}if(_0x1bb9d0+_0x45938c>_0x2da31c||_0x51f7a1[_0xe0d93a(0x1cb)]>=_0x2dffcb){const _0x540074=await this['writeChunk'](_0x51f7a1);_0x7d504b[_0xe0d93a(0x1d8)](_0x540074),_0x1bb9d0=0x0,_0x51f7a1=[];}_0x51f7a1['push'](_0x1203d3),_0x1bb9d0+=_0x45938c;}}if(_0x51f7a1[_0xe0d93a(0x1cb)]){const _0xcfe74b=await this[_0xe0d93a(0x1c6)](_0x51f7a1);_0x7d504b[_0xe0d93a(0x1d8)](_0xcfe74b);}await(0x0,promises_1['writeFile'])(this['retrieveResultsPath'],JSON[_0xe0d93a(0x1dd)](_0x7d504b));}}exports[a272_0x5e6e5a(0x1c5)]=RetrieveMetadata;