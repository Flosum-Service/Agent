const a272_0x449b07=a272_0x57c7;(function(_0xde64f,_0x1f451d){const _0x45d525=a272_0x57c7,_0x5a5588=_0xde64f();while(!![]){try{const _0x2b17b9=-parseInt(_0x45d525(0x178))/0x1+parseInt(_0x45d525(0x179))/0x2+-parseInt(_0x45d525(0x16c))/0x3+-parseInt(_0x45d525(0x155))/0x4+parseInt(_0x45d525(0x15e))/0x5*(-parseInt(_0x45d525(0x172))/0x6)+parseInt(_0x45d525(0x16d))/0x7+parseInt(_0x45d525(0x163))/0x8;if(_0x2b17b9===_0x1f451d)break;else _0x5a5588['push'](_0x5a5588['shift']());}catch(_0x3d5708){_0x5a5588['push'](_0x5a5588['shift']());}}}(a272_0xc08b,0xd7644));const a272_0x2c7d0a=(function(){let _0x2e02b6=!![];return function(_0x136437,_0x1a5eee){const _0x46843e=_0x2e02b6?function(){const _0x1bdd1e=a272_0x57c7;if(_0x1a5eee){const _0x571c21=_0x1a5eee[_0x1bdd1e(0x171)](_0x136437,arguments);return _0x1a5eee=null,_0x571c21;}}:function(){};return _0x2e02b6=![],_0x46843e;};}()),a272_0x25a1e0=a272_0x2c7d0a(this,function(){const _0x393e48=a272_0x57c7;return a272_0x25a1e0[_0x393e48(0x175)]()[_0x393e48(0x158)]('(((.+)+)+)+$')['toString']()[_0x393e48(0x152)](a272_0x25a1e0)[_0x393e48(0x158)](_0x393e48(0x17b));});a272_0x25a1e0();function a272_0x57c7(_0x5bfa03,_0x403e02){const _0x3faba0=a272_0xc08b();return a272_0x57c7=function(_0x25a1e0,_0x2c7d0a){_0x25a1e0=_0x25a1e0-0x150;let _0xc08ba7=_0x3faba0[_0x25a1e0];return _0xc08ba7;},a272_0x57c7(_0x5bfa03,_0x403e02);}'use strict';var __importDefault=this&&this[a272_0x449b07(0x165)]||function(_0x1d3359){const _0x3956b5=a272_0x449b07;return _0x1d3359&&_0x1d3359[_0x3956b5(0x17e)]?_0x1d3359:{'default':_0x1d3359};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const salesforce_1=require(a272_0x449b07(0x17d)),manifest_manger_1=__importDefault(require(a272_0x449b07(0x157))),path_1=__importDefault(require(a272_0x449b07(0x159))),promises_1=require(a272_0x449b07(0x160)),fs_utils_1=require(a272_0x449b07(0x176)),object_sizeof_1=__importDefault(require(a272_0x449b07(0x166))),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require('../../../shared/managers/auth.manager'),constants_1=require('../../constants'),shortid_1=__importDefault(require(a272_0x449b07(0x164))),jszip_1=__importDefault(require(a272_0x449b07(0x174)));class RetrieveMetadata{constructor(_0x25cdff,_0x31cc61,_0x41886b){const _0x34f0ea=a272_0x449b07;this[_0x34f0ea(0x162)]=_0x25cdff,this[_0x34f0ea(0x156)]=_0x31cc61,this[_0x34f0ea(0x150)]=_0x41886b,this['metadataFolder']=path_1['default'][_0x34f0ea(0x153)](this[_0x34f0ea(0x162)],constants_1[_0x34f0ea(0x16f)]),this[_0x34f0ea(0x15f)]=path_1['default'][_0x34f0ea(0x153)](this[_0x34f0ea(0x162)],constants_1[_0x34f0ea(0x15c)]);}async[a272_0x449b07(0x17c)](_0x40c8ca){const _0x3aca6c=a272_0x449b07,_0x3924ff=(0x0,shortid_1[_0x3aca6c(0x154)])();return await(0x0,promises_1[_0x3aca6c(0x15b)])(path_1[_0x3aca6c(0x154)][_0x3aca6c(0x153)](this['metadataFolder'],_0x3924ff+'.json'),JSON[_0x3aca6c(0x16a)](_0x40c8ca)),_0x3924ff;}async[a272_0x449b07(0x151)](){const _0x217fb1=a272_0x449b07,{credentials:_0x55a3de,declarativeFilter:_0x273fbd,metadataTypes:_0x3f2184,maxChunkSize:_0x5252cb,maxChunkItems:_0x23bb9a,apiVersion:_0x440140}=await new manifest_manger_1['default'](this[_0x217fb1(0x162)])['init'](),_0x5cf151=await salesforce_1[_0x217fb1(0x170)][_0x217fb1(0x167)](new auth_manager_1[(_0x217fb1(0x16b))](_0x55a3de),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x236ab9=await retrieve_factory_1['default'][_0x217fb1(0x167)](_0x5cf151,this[_0x217fb1(0x156)],_0x273fbd,_0x3f2184,_0x440140)[_0x217fb1(0x151)]();await(0x0,fs_utils_1[_0x217fb1(0x17a)])(this[_0x217fb1(0x161)]);let _0x1dc8e6=[];const _0x83aaed=[];let _0x2b5c05=0x0;for(const _0x4a5d3b in _0x236ab9[_0x217fb1(0x16e)]){for(const {listMetadataItem:_0x4120bb,files:_0x1a135a}of _0x236ab9[_0x217fb1(0x16e)][_0x4a5d3b][_0x217fb1(0x173)]){const _0x57a905=new jszip_1['default']();for(const _0x48f8cf in _0x1a135a){await _0x57a905['file'](_0x48f8cf,_0x1a135a[_0x48f8cf]);}const _0x616eec=await _0x57a905['generateAsync']({'type':_0x217fb1(0x15d),'compression':_0x217fb1(0x15a),'compressionOptions':{'level':0x9}}),_0x5202bd={..._0x4120bb,'zip':_0x616eec},_0x23b890=(0x0,object_sizeof_1[_0x217fb1(0x154)])(_0x5202bd);if(_0x23b890>_0x5252cb){await this[_0x217fb1(0x150)]['addWarning']('Item\x20\x27'+_0x4120bb['fileName']+'\x27\x20size\x20\x27'+_0x23b890+_0x217fb1(0x169)+_0x5252cb+'\x27');continue;}if(_0x2b5c05+_0x23b890>_0x5252cb||_0x1dc8e6['length']>=_0x23bb9a){const _0x15223c=await this['writeChunk'](_0x1dc8e6);_0x83aaed[_0x217fb1(0x177)](_0x15223c),_0x2b5c05=0x0,_0x1dc8e6=[];}_0x1dc8e6['push'](_0x5202bd),_0x2b5c05+=_0x23b890;}}if(_0x1dc8e6[_0x217fb1(0x168)]){const _0x136246=await this[_0x217fb1(0x17c)](_0x1dc8e6);_0x83aaed[_0x217fb1(0x177)](_0x136246);}await(0x0,promises_1[_0x217fb1(0x15b)])(this['retrieveResultsPath'],JSON[_0x217fb1(0x16a)](_0x83aaed));}}exports[a272_0x449b07(0x154)]=RetrieveMetadata;function a272_0xc08b(){const _0x2becc7=['create','length','\x27\x20exceed\x20limit\x20\x27','stringify','AuthManager','4168041uiTFCn','3665088vugfpV','items','RETRIEVE_RESULT_FOLDER_NAME','AxiosInstanceUtils','apply','268710kXwwGL','components','jszip','toString','../../../shared/utils/fs.utils','push','1337052HookmP','2111490nLZJbi','makeDir','(((.+)+)+)+$','writeChunk','@flosum/salesforce','__esModule','stateManager','execute','constructor','join','default','3391928CsPtBg','logger','./manifest-manger','search','path','DEFLATE','writeFile','RETRIEVE_RESULTS_IDS_FILENAME','base64','170hXnmpV','retrieveResultsPath','fs/promises','metadataFolder','jobStorePath','35199888HEITYZ','shortid','__importDefault','object-sizeof'];a272_0xc08b=function(){return _0x2becc7;};return a272_0xc08b();}