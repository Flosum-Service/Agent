function a287_0x1074(_0x1cfca3,_0x389b60){const _0x5014e2=a287_0x55fe();return a287_0x1074=function(_0x3db186,_0x23c891){_0x3db186=_0x3db186-0x12d;let _0x55fed0=_0x5014e2[_0x3db186];return _0x55fed0;},a287_0x1074(_0x1cfca3,_0x389b60);}const a287_0x1b1ef5=a287_0x1074;(function(_0xe820cf,_0x1a88a1){const _0x23e2cc=a287_0x1074,_0x3e4f30=_0xe820cf();while(!![]){try{const _0x4f5047=-parseInt(_0x23e2cc(0x153))/0x1+parseInt(_0x23e2cc(0x13d))/0x2+-parseInt(_0x23e2cc(0x136))/0x3*(-parseInt(_0x23e2cc(0x142))/0x4)+parseInt(_0x23e2cc(0x154))/0x5*(parseInt(_0x23e2cc(0x132))/0x6)+-parseInt(_0x23e2cc(0x15a))/0x7*(parseInt(_0x23e2cc(0x159))/0x8)+parseInt(_0x23e2cc(0x14e))/0x9*(parseInt(_0x23e2cc(0x164))/0xa)+-parseInt(_0x23e2cc(0x143))/0xb*(parseInt(_0x23e2cc(0x13a))/0xc);if(_0x4f5047===_0x1a88a1)break;else _0x3e4f30['push'](_0x3e4f30['shift']());}catch(_0x2d2a79){_0x3e4f30['push'](_0x3e4f30['shift']());}}}(a287_0x55fe,0xe5948));const a287_0x23c891=(function(){let _0x1fe879=!![];return function(_0x1ef707,_0x108d4f){const _0x3d52bd=_0x1fe879?function(){if(_0x108d4f){const _0x5a1f50=_0x108d4f['apply'](_0x1ef707,arguments);return _0x108d4f=null,_0x5a1f50;}}:function(){};return _0x1fe879=![],_0x3d52bd;};}()),a287_0x3db186=a287_0x23c891(this,function(){const _0x2a0057=a287_0x1074;return a287_0x3db186[_0x2a0057(0x160)]()[_0x2a0057(0x147)](_0x2a0057(0x158))['toString']()[_0x2a0057(0x15d)](a287_0x3db186)['search']('(((.+)+)+)+$');});a287_0x3db186();'use strict';var __importDefault=this&&this[a287_0x1b1ef5(0x130)]||function(_0x3a8e55){const _0x5935c1=a287_0x1b1ef5;return _0x3a8e55&&_0x3a8e55[_0x5935c1(0x139)]?_0x3a8e55:{'default':_0x3a8e55};};function a287_0x55fe(){const _0x236e11=['3196512iKeSqS','length','../../../shared/managers/auth.manager','init','object-sizeof','1680948QTXmCf','33azMJzS','RETRIEVE_RESULT_FOLDER_NAME','fileName','../../../shared/utils/fs.utils','search','.json','\x27\x20size\x20\x27','DEFLATE','default','items','shortid','9ztyCHg','Item\x20\x27','join','addWarning','RETRIEVE_RESULTS_IDS_FILENAME','1847079mOvDLf','6110qizFRE','create','jobStorePath','writeFile','(((.+)+)+)+$','4152qpBvou','6083nccWtt','defineProperty','execute','constructor','AxiosInstanceUtils','jszip','toString','components','base64','../../constants','12612930zuAuWm','fs/promises','makeDir','writeChunk','__importDefault','push','1698hICUSc','./manifest-manger','\x27\x20exceed\x20limit\x20\x27','logger','9AQKThh','metadataFolder','stringify','__esModule','4910544GjXlJP','retrieveResultsPath','stateManager'];a287_0x55fe=function(){return _0x236e11;};return a287_0x55fe();}Object[a287_0x1b1ef5(0x15b)](exports,a287_0x1b1ef5(0x139),{'value':!![]});const salesforce_1=require('@flosum/salesforce'),manifest_manger_1=__importDefault(require(a287_0x1b1ef5(0x133))),path_1=__importDefault(require('path')),promises_1=require(a287_0x1b1ef5(0x12d)),fs_utils_1=require(a287_0x1b1ef5(0x146)),object_sizeof_1=__importDefault(require(a287_0x1b1ef5(0x141))),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require(a287_0x1b1ef5(0x13f)),constants_1=require(a287_0x1b1ef5(0x163)),shortid_1=__importDefault(require(a287_0x1b1ef5(0x14d))),jszip_1=__importDefault(require(a287_0x1b1ef5(0x15f)));class RetrieveMetadata{constructor(_0x4ae324,_0x596541,_0x42bb53){const _0x1fd7ad=a287_0x1b1ef5;this['jobStorePath']=_0x4ae324,this[_0x1fd7ad(0x135)]=_0x596541,this['stateManager']=_0x42bb53,this[_0x1fd7ad(0x137)]=path_1[_0x1fd7ad(0x14b)][_0x1fd7ad(0x150)](this[_0x1fd7ad(0x156)],constants_1[_0x1fd7ad(0x144)]),this[_0x1fd7ad(0x13b)]=path_1[_0x1fd7ad(0x14b)][_0x1fd7ad(0x150)](this[_0x1fd7ad(0x156)],constants_1[_0x1fd7ad(0x152)]);}async[a287_0x1b1ef5(0x12f)](_0x2469f2){const _0x45ef33=a287_0x1b1ef5,_0x5470ce=(0x0,shortid_1[_0x45ef33(0x14b)])();return await(0x0,promises_1[_0x45ef33(0x157)])(path_1[_0x45ef33(0x14b)][_0x45ef33(0x150)](this['metadataFolder'],_0x5470ce+_0x45ef33(0x148)),JSON[_0x45ef33(0x138)](_0x2469f2)),_0x5470ce;}async['execute'](){const _0x29f034=a287_0x1b1ef5,{credentials:_0x341aa5,declarativeFilter:_0x3a614b,metadataTypes:_0x53f678,maxChunkSize:_0xbf5201,maxChunkItems:_0x13d742,apiVersion:_0x175651}=await new manifest_manger_1['default'](this[_0x29f034(0x156)])[_0x29f034(0x140)](),_0x19472e=await salesforce_1[_0x29f034(0x15e)][_0x29f034(0x155)](new auth_manager_1['AuthManager'](_0x341aa5),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x5ad54a=await retrieve_factory_1['default'][_0x29f034(0x155)](_0x19472e,this[_0x29f034(0x135)],_0x3a614b,_0x53f678,_0x175651)[_0x29f034(0x15c)]();await(0x0,fs_utils_1[_0x29f034(0x12e)])(this[_0x29f034(0x137)]);let _0x8354bc=[];const _0x423aac=[];let _0x3665a=0x0;for(const _0x2de076 in _0x5ad54a['items']){for(const {listMetadataItem:_0x5b7dfd,files:_0xae3a8e}of _0x5ad54a[_0x29f034(0x14c)][_0x2de076][_0x29f034(0x161)]){const _0x366216=new jszip_1[(_0x29f034(0x14b))]();for(const _0x16ed47 in _0xae3a8e){await _0x366216['file'](_0x16ed47,_0xae3a8e[_0x16ed47]);}const _0x5de0a1=await _0x366216['generateAsync']({'type':_0x29f034(0x162),'compression':_0x29f034(0x14a),'compressionOptions':{'level':0x9}}),_0x3bd209={..._0x5b7dfd,'zip':_0x5de0a1},_0x500662=(0x0,object_sizeof_1['default'])(_0x3bd209);if(_0x500662>_0xbf5201){await this[_0x29f034(0x13c)][_0x29f034(0x151)](_0x29f034(0x14f)+_0x5b7dfd[_0x29f034(0x145)]+_0x29f034(0x149)+_0x500662+_0x29f034(0x134)+_0xbf5201+'\x27');continue;}if(_0x3665a+_0x500662>_0xbf5201||_0x8354bc[_0x29f034(0x13e)]>=_0x13d742){const _0x415959=await this['writeChunk'](_0x8354bc);_0x423aac[_0x29f034(0x131)](_0x415959),_0x3665a=0x0,_0x8354bc=[];}_0x8354bc[_0x29f034(0x131)](_0x3bd209),_0x3665a+=_0x500662;}}if(_0x8354bc[_0x29f034(0x13e)]){const _0x26bff9=await this[_0x29f034(0x12f)](_0x8354bc);_0x423aac[_0x29f034(0x131)](_0x26bff9);}await(0x0,promises_1[_0x29f034(0x157)])(this[_0x29f034(0x13b)],JSON[_0x29f034(0x138)](_0x423aac));}}exports[a287_0x1b1ef5(0x14b)]=RetrieveMetadata;