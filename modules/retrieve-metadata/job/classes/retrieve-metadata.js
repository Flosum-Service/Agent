const a288_0x49d8ed=a288_0x3093;(function(_0x4f33f6,_0x408fc2){const _0x58ee87=a288_0x3093,_0x4c85c0=_0x4f33f6();while(!![]){try{const _0x463102=parseInt(_0x58ee87(0xbe))/0x1*(parseInt(_0x58ee87(0xb4))/0x2)+parseInt(_0x58ee87(0xc9))/0x3*(-parseInt(_0x58ee87(0xb6))/0x4)+-parseInt(_0x58ee87(0xa7))/0x5*(-parseInt(_0x58ee87(0x95))/0x6)+parseInt(_0x58ee87(0xbb))/0x7*(-parseInt(_0x58ee87(0xbf))/0x8)+parseInt(_0x58ee87(0xa0))/0x9*(-parseInt(_0x58ee87(0x99))/0xa)+-parseInt(_0x58ee87(0xc3))/0xb*(parseInt(_0x58ee87(0x96))/0xc)+parseInt(_0x58ee87(0xc7))/0xd*(parseInt(_0x58ee87(0xa4))/0xe);if(_0x463102===_0x408fc2)break;else _0x4c85c0['push'](_0x4c85c0['shift']());}catch(_0x4072f1){_0x4c85c0['push'](_0x4c85c0['shift']());}}}(a288_0x184d,0xdc0a4));const a288_0x5b364a=(function(){let _0x3c49a1=!![];return function(_0x125c72,_0x7d6407){const _0x107e0b=_0x3c49a1?function(){const _0x313c47=a288_0x3093;if(_0x7d6407){const _0x4d9c05=_0x7d6407[_0x313c47(0x9f)](_0x125c72,arguments);return _0x7d6407=null,_0x4d9c05;}}:function(){};return _0x3c49a1=![],_0x107e0b;};}()),a288_0x52097c=a288_0x5b364a(this,function(){const _0x115ed7=a288_0x3093;return a288_0x52097c['toString']()[_0x115ed7(0xbd)](_0x115ed7(0x9c))[_0x115ed7(0x9e)]()[_0x115ed7(0xa8)](a288_0x52097c)['search']('(((.+)+)+)+$');});a288_0x52097c();'use strict';var __importDefault=this&&this[a288_0x49d8ed(0xc5)]||function(_0x46cd73){return _0x46cd73&&_0x46cd73['__esModule']?_0x46cd73:{'default':_0x46cd73};};Object[a288_0x49d8ed(0xaf)](exports,a288_0x49d8ed(0xc8),{'value':!![]});const salesforce_1=require('@flosum/salesforce'),manifest_manger_1=__importDefault(require(a288_0x49d8ed(0xcb))),path_1=__importDefault(require(a288_0x49d8ed(0xba))),promises_1=require(a288_0x49d8ed(0xb1)),fs_utils_1=require(a288_0x49d8ed(0xb9)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require(a288_0x49d8ed(0xc4))),auth_manager_1=require(a288_0x49d8ed(0x93)),constants_1=require(a288_0x49d8ed(0xaa)),shortid_1=__importDefault(require(a288_0x49d8ed(0xb7))),jszip_1=__importDefault(require(a288_0x49d8ed(0xb5)));function a288_0x3093(_0x26f071,_0x2bfdb3){const _0x28c5af=a288_0x184d();return a288_0x3093=function(_0x52097c,_0x5b364a){_0x52097c=_0x52097c-0x93;let _0x184d5a=_0x28c5af[_0x52097c];return _0x184d5a;},a288_0x3093(_0x26f071,_0x2bfdb3);}class RetrieveMetadata{constructor(_0x4a1812,_0x37cf5c,_0x205d51){const _0x503fd7=a288_0x49d8ed;this[_0x503fd7(0xc0)]=_0x4a1812,this['logger']=_0x37cf5c,this[_0x503fd7(0xbc)]=_0x205d51,this[_0x503fd7(0xa2)]=path_1[_0x503fd7(0xa3)]['join'](this[_0x503fd7(0xc0)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this['retrieveResultsPath']=path_1[_0x503fd7(0xa3)]['join'](this[_0x503fd7(0xc0)],constants_1[_0x503fd7(0x98)]);}async[a288_0x49d8ed(0xca)](_0x2a57c2){const _0x924aea=a288_0x49d8ed,_0x428204=(0x0,shortid_1['default'])();return await(0x0,promises_1[_0x924aea(0x94)])(path_1['default'][_0x924aea(0x97)](this['metadataFolder'],_0x428204+_0x924aea(0xae)),JSON[_0x924aea(0xab)](_0x2a57c2)),_0x428204;}async[a288_0x49d8ed(0x9a)](){const _0x3da2da=a288_0x49d8ed,{credentials:_0x2d1c11,declarativeFilter:_0x31d9e3,metadataTypes:_0x48bf91,maxChunkSize:_0x45a764,maxChunkItems:_0x49f643,apiVersion:_0x26dcf8}=await new manifest_manger_1[(_0x3da2da(0xa3))](this[_0x3da2da(0xc0)])[_0x3da2da(0xa1)](),_0x14e1e=await salesforce_1[_0x3da2da(0xad)][_0x3da2da(0xc1)](new auth_manager_1['AuthManager'](_0x2d1c11),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x35b90c=await retrieve_factory_1[_0x3da2da(0xa3)]['create'](_0x14e1e,this['logger'],_0x31d9e3,_0x48bf91,_0x26dcf8)['execute']();await(0x0,fs_utils_1[_0x3da2da(0xb8)])(this[_0x3da2da(0xa2)]);let _0x492f1a=[];const _0x1fe7ed=[];let _0x45fb6c=0x0;for(const _0x2b2f46 in _0x35b90c['items']){for(const {listMetadataItem:_0x2f535a,files:_0x47747f}of _0x35b90c['items'][_0x2b2f46][_0x3da2da(0xc2)]){const _0x5a8ddb=new jszip_1[(_0x3da2da(0xa3))]();for(const _0x8ec1cb in _0x47747f){await _0x5a8ddb[_0x3da2da(0xa9)](_0x8ec1cb,_0x47747f[_0x8ec1cb]);}const _0xa2592e=await _0x5a8ddb[_0x3da2da(0xc6)]({'type':_0x3da2da(0xb2),'compression':'DEFLATE','compressionOptions':{'level':0x9}}),_0x2b968f={..._0x2f535a,'zip':_0xa2592e},_0x4af2ae=(0x0,object_sizeof_1['default'])(_0x2b968f);if(_0x4af2ae>_0x45a764){await this[_0x3da2da(0xbc)]['addWarning'](_0x3da2da(0xa6)+_0x2f535a[_0x3da2da(0x9b)]+_0x3da2da(0xb3)+_0x4af2ae+_0x3da2da(0xb0)+_0x45a764+'\x27');continue;}if(_0x45fb6c+_0x4af2ae>_0x45a764||_0x492f1a[_0x3da2da(0x9d)]>=_0x49f643){const _0x5064a3=await this[_0x3da2da(0xca)](_0x492f1a);_0x1fe7ed['push'](_0x5064a3),_0x45fb6c=0x0,_0x492f1a=[];}_0x492f1a[_0x3da2da(0xa5)](_0x2b968f),_0x45fb6c+=_0x4af2ae;}}if(_0x492f1a['length']){const _0x458ac0=await this[_0x3da2da(0xca)](_0x492f1a);_0x1fe7ed[_0x3da2da(0xa5)](_0x458ac0);}await(0x0,promises_1[_0x3da2da(0x94)])(this[_0x3da2da(0xac)],JSON[_0x3da2da(0xab)](_0x1fe7ed));}}function a288_0x184d(){const _0x1dc3d4=['create','components','11832073OhmaVj','./retrieve-factory','__importDefault','generateAsync','2856347dhTwiF','__esModule','405ZuWXBU','writeChunk','./manifest-manger','../../../shared/managers/auth.manager','writeFile','9288972uhBMAu','12xxdjQv','join','RETRIEVE_RESULTS_IDS_FILENAME','140WwdSke','execute','fileName','(((.+)+)+)+$','length','toString','apply','691830JjyFmG','init','metadataFolder','default','140BkkkZW','push','Item\x20\x27','5LdXVjQ','constructor','file','../../constants','stringify','retrieveResultsPath','AxiosInstanceUtils','.json','defineProperty','\x27\x20exceed\x20limit\x20\x27','fs/promises','base64','\x27\x20size\x20\x27','642FGXojX','jszip','7372chFcYX','shortid','makeDir','../../../shared/utils/fs.utils','path','203BSNNeM','stateManager','search','739GfoAlG','187768piJheR','jobStorePath'];a288_0x184d=function(){return _0x1dc3d4;};return a288_0x184d();}exports['default']=RetrieveMetadata;