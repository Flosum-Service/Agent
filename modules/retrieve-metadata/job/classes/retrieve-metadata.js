const a315_0x5d060a=a315_0x4b3d;(function(_0x5eb3eb,_0x40c107){const _0x12dfb7=a315_0x4b3d,_0x1b6a03=_0x5eb3eb();while(!![]){try{const _0x463b7b=-parseInt(_0x12dfb7(0x18a))/0x1*(-parseInt(_0x12dfb7(0x182))/0x2)+parseInt(_0x12dfb7(0x18d))/0x3+parseInt(_0x12dfb7(0x17e))/0x4*(-parseInt(_0x12dfb7(0x174))/0x5)+parseInt(_0x12dfb7(0x184))/0x6+-parseInt(_0x12dfb7(0x171))/0x7*(-parseInt(_0x12dfb7(0x164))/0x8)+parseInt(_0x12dfb7(0x175))/0x9+-parseInt(_0x12dfb7(0x176))/0xa;if(_0x463b7b===_0x40c107)break;else _0x1b6a03['push'](_0x1b6a03['shift']());}catch(_0x67bd62){_0x1b6a03['push'](_0x1b6a03['shift']());}}}(a315_0x4628,0x36bf3));function a315_0x4b3d(_0x2ea506,_0x56ec91){const _0x10cd99=a315_0x4628();return a315_0x4b3d=function(_0x4287a3,_0x569410){_0x4287a3=_0x4287a3-0x15f;let _0x462886=_0x10cd99[_0x4287a3];return _0x462886;},a315_0x4b3d(_0x2ea506,_0x56ec91);}const a315_0x569410=(function(){let _0x5deb48=!![];return function(_0x1eb9ba,_0xd86bbc){const _0x199d56=_0x5deb48?function(){const _0x55882a=a315_0x4b3d;if(_0xd86bbc){const _0x5a2239=_0xd86bbc[_0x55882a(0x177)](_0x1eb9ba,arguments);return _0xd86bbc=null,_0x5a2239;}}:function(){};return _0x5deb48=![],_0x199d56;};}()),a315_0x4287a3=a315_0x569410(this,function(){const _0x1531a3=a315_0x4b3d;return a315_0x4287a3[_0x1531a3(0x18f)]()[_0x1531a3(0x18e)](_0x1531a3(0x180))[_0x1531a3(0x18f)]()[_0x1531a3(0x179)](a315_0x4287a3)[_0x1531a3(0x18e)](_0x1531a3(0x180));});a315_0x4287a3();'use strict';var __importDefault=this&&this[a315_0x5d060a(0x185)]||function(_0x3b8f87){const _0x184fc2=a315_0x5d060a;return _0x3b8f87&&_0x3b8f87[_0x184fc2(0x181)]?_0x3b8f87:{'default':_0x3b8f87};};Object[a315_0x5d060a(0x192)](exports,a315_0x5d060a(0x181),{'value':!![]});const salesforce_1=require(a315_0x5d060a(0x16c)),manifest_manger_1=__importDefault(require('./manifest-manger')),path_1=__importDefault(require('path')),promises_1=require(a315_0x5d060a(0x16e)),fs_utils_1=require(a315_0x5d060a(0x165)),object_sizeof_1=__importDefault(require(a315_0x5d060a(0x15f))),retrieve_factory_1=__importDefault(require(a315_0x5d060a(0x17d))),auth_manager_1=require(a315_0x5d060a(0x18b)),constants_1=require(a315_0x5d060a(0x16a)),shortid_1=__importDefault(require(a315_0x5d060a(0x187))),jszip_1=__importDefault(require(a315_0x5d060a(0x16d)));class RetrieveMetadata{constructor(_0x2f4ccf,_0x52f462,_0x2c3cdf){const _0x364686=a315_0x5d060a;this[_0x364686(0x169)]=_0x2f4ccf,this['logger']=_0x52f462,this[_0x364686(0x170)]=_0x2c3cdf,this[_0x364686(0x172)]=path_1['default'][_0x364686(0x191)](this[_0x364686(0x169)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this['retrieveResultsPath']=path_1[_0x364686(0x17b)]['join'](this[_0x364686(0x169)],constants_1[_0x364686(0x17c)]);}async[a315_0x5d060a(0x163)](_0x3594f8){const _0x27235c=a315_0x5d060a,_0x4ecdc=(0x0,shortid_1[_0x27235c(0x17b)])();return await(0x0,promises_1['writeFile'])(path_1['default'][_0x27235c(0x191)](this[_0x27235c(0x172)],_0x4ecdc+_0x27235c(0x183)),JSON[_0x27235c(0x16f)](_0x3594f8)),_0x4ecdc;}async[a315_0x5d060a(0x18c)](){const _0x2435a7=a315_0x5d060a,{credentials:_0x2f4e19,declarativeFilter:_0x25cc58,metadataTypes:_0x6b6da6,maxChunkSize:_0x24fac4,maxChunkItems:_0x470c7f,apiVersion:_0x3bb50e}=await new manifest_manger_1[(_0x2435a7(0x17b))](this['jobStorePath'])[_0x2435a7(0x194)](),_0x286d22=await salesforce_1[_0x2435a7(0x193)][_0x2435a7(0x167)](new auth_manager_1[(_0x2435a7(0x160))](_0x2f4e19),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x35e2b4=await retrieve_factory_1[_0x2435a7(0x17b)][_0x2435a7(0x167)](_0x286d22,this['logger'],_0x25cc58,_0x6b6da6,_0x3bb50e)[_0x2435a7(0x18c)]();await(0x0,fs_utils_1[_0x2435a7(0x166)])(this['metadataFolder']);let _0x422436=[];const _0xb0ca74=[];let _0x3f1fbc=0x0;for(const _0x2b1059 in _0x35e2b4[_0x2435a7(0x16b)]){for(const {listMetadataItem:_0x48cab2,files:_0x211767}of _0x35e2b4[_0x2435a7(0x16b)][_0x2b1059][_0x2435a7(0x17f)]){const _0x27c6e9=new jszip_1[(_0x2435a7(0x17b))]();for(const _0x17029d in _0x211767){await _0x27c6e9['file'](_0x17029d,_0x211767[_0x17029d]);}const _0x5be8c9=await _0x27c6e9[_0x2435a7(0x189)]({'type':_0x2435a7(0x161),'compression':_0x2435a7(0x173),'compressionOptions':{'level':0x9}}),_0x1e3562={..._0x48cab2,'zip':_0x5be8c9},_0x3b9b5d=(0x0,object_sizeof_1[_0x2435a7(0x17b)])(_0x1e3562);if(_0x3b9b5d>_0x24fac4){await this['stateManager'][_0x2435a7(0x186)](_0x2435a7(0x162)+_0x48cab2['fileName']+_0x2435a7(0x178)+_0x3b9b5d+'\x27\x20exceed\x20limit\x20\x27'+_0x24fac4+'\x27');continue;}if(_0x3f1fbc+_0x3b9b5d>_0x24fac4||_0x422436[_0x2435a7(0x190)]>=_0x470c7f){const _0x2aac7c=await this[_0x2435a7(0x163)](_0x422436);_0xb0ca74[_0x2435a7(0x17a)](_0x2aac7c),_0x3f1fbc=0x0,_0x422436=[];}_0x422436[_0x2435a7(0x17a)](_0x1e3562),_0x3f1fbc+=_0x3b9b5d;}}if(_0x422436[_0x2435a7(0x190)]){const _0x149c36=await this[_0x2435a7(0x163)](_0x422436);_0xb0ca74[_0x2435a7(0x17a)](_0x149c36);}await(0x0,promises_1[_0x2435a7(0x168)])(this[_0x2435a7(0x188)],JSON['stringify'](_0xb0ca74));}}exports[a315_0x5d060a(0x17b)]=RetrieveMetadata;function a315_0x4628(){const _0x1372c9=['AxiosInstanceUtils','init','object-sizeof','AuthManager','base64','Item\x20\x27','writeChunk','436168cEWLvy','../../../shared/utils/fs.utils','makeDir','create','writeFile','jobStorePath','../../constants','items','@flosum/salesforce','jszip','fs/promises','stringify','stateManager','7KmKNwP','metadataFolder','DEFLATE','396535tyxmqq','2098737sNSLur','6532810jDuZQX','apply','\x27\x20size\x20\x27','constructor','push','default','RETRIEVE_RESULTS_IDS_FILENAME','./retrieve-factory','4sFxitL','components','(((.+)+)+)+$','__esModule','220PPQaFY','.json','1139892TrSvwI','__importDefault','addWarning','shortid','retrieveResultsPath','generateAsync','3963WpLHva','../../../shared/managers/auth.manager','execute','129615kkeJVj','search','toString','length','join','defineProperty'];a315_0x4628=function(){return _0x1372c9;};return a315_0x4628();}