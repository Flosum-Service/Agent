const a272_0x256998=a272_0x1dfb;(function(_0x51e79a,_0x2a2170){const _0x110667=a272_0x1dfb,_0x336073=_0x51e79a();while(!![]){try{const _0xd51b9d=-parseInt(_0x110667(0x107))/0x1+-parseInt(_0x110667(0x10f))/0x2*(-parseInt(_0x110667(0x132))/0x3)+parseInt(_0x110667(0x123))/0x4*(-parseInt(_0x110667(0x130))/0x5)+parseInt(_0x110667(0x10c))/0x6*(-parseInt(_0x110667(0x12c))/0x7)+-parseInt(_0x110667(0x11d))/0x8*(-parseInt(_0x110667(0x102))/0x9)+parseInt(_0x110667(0x116))/0xa+parseInt(_0x110667(0x115))/0xb;if(_0xd51b9d===_0x2a2170)break;else _0x336073['push'](_0x336073['shift']());}catch(_0x18ee3a){_0x336073['push'](_0x336073['shift']());}}}(a272_0x3c49,0xe0c94));const a272_0x112fea=(function(){let _0x34bd54=!![];return function(_0x4db0ac,_0x1aac42){const _0x50c61e=_0x34bd54?function(){const _0x27f2d4=a272_0x1dfb;if(_0x1aac42){const _0x22fed5=_0x1aac42[_0x27f2d4(0x125)](_0x4db0ac,arguments);return _0x1aac42=null,_0x22fed5;}}:function(){};return _0x34bd54=![],_0x50c61e;};}()),a272_0x2a9b6d=a272_0x112fea(this,function(){const _0x5d838d=a272_0x1dfb;return a272_0x2a9b6d[_0x5d838d(0x103)]()[_0x5d838d(0x113)]('(((.+)+)+)+$')[_0x5d838d(0x103)]()[_0x5d838d(0x122)](a272_0x2a9b6d)[_0x5d838d(0x113)]('(((.+)+)+)+$');});a272_0x2a9b6d();function a272_0x3c49(){const _0x313fcf=['push','26293949egHTZC','4435380VYeuTY','length','fs/promises','stringify','@flosum/salesforce','default','jszip','8CcORBK','join','\x27\x20exceed\x20limit\x20\x27','DEFLATE','items','constructor','12qgyWhM','execute','apply','base64','addWarning','writeChunk','jobStorePath','makeDir','RETRIEVE_RESULTS_IDS_FILENAME','23863LJIOUQ','generateAsync','../../../shared/utils/fs.utils','writeFile','1254605kBaOgc','stateManager','5181ZifXtV','retrieveResultsPath','__esModule','Item\x20\x27','defineProperty','1034892rjlwxo','toString','./manifest-manger','../../../shared/managers/auth.manager','\x27\x20size\x20\x27','736050PmxzTH','create','metadataFolder','AxiosInstanceUtils','fileName','1542ynNXVu','RETRIEVE_RESULT_FOLDER_NAME','../../constants','390sBFkjf','__importDefault','logger','path','search'];a272_0x3c49=function(){return _0x313fcf;};return a272_0x3c49();}'use strict';function a272_0x1dfb(_0x3b168c,_0x254d90){const _0x1b9281=a272_0x3c49();return a272_0x1dfb=function(_0x2a9b6d,_0x112fea){_0x2a9b6d=_0x2a9b6d-0x102;let _0x3c496d=_0x1b9281[_0x2a9b6d];return _0x3c496d;},a272_0x1dfb(_0x3b168c,_0x254d90);}var __importDefault=this&&this[a272_0x256998(0x110)]||function(_0x4624bd){const _0x160f3c=a272_0x256998;return _0x4624bd&&_0x4624bd[_0x160f3c(0x134)]?_0x4624bd:{'default':_0x4624bd};};Object[a272_0x256998(0x136)](exports,a272_0x256998(0x134),{'value':!![]});const salesforce_1=require(a272_0x256998(0x11a)),manifest_manger_1=__importDefault(require(a272_0x256998(0x104))),path_1=__importDefault(require(a272_0x256998(0x112))),promises_1=require(a272_0x256998(0x118)),fs_utils_1=require(a272_0x256998(0x12e)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require(a272_0x256998(0x105)),constants_1=require(a272_0x256998(0x10e)),shortid_1=__importDefault(require('shortid')),jszip_1=__importDefault(require(a272_0x256998(0x11c)));class RetrieveMetadata{constructor(_0x319459,_0x2c72dd,_0x5b262f){const _0xcd7af=a272_0x256998;this[_0xcd7af(0x129)]=_0x319459,this[_0xcd7af(0x111)]=_0x2c72dd,this[_0xcd7af(0x131)]=_0x5b262f,this['metadataFolder']=path_1['default'][_0xcd7af(0x11e)](this[_0xcd7af(0x129)],constants_1[_0xcd7af(0x10d)]),this[_0xcd7af(0x133)]=path_1[_0xcd7af(0x11b)][_0xcd7af(0x11e)](this['jobStorePath'],constants_1[_0xcd7af(0x12b)]);}async[a272_0x256998(0x128)](_0x4fa94){const _0x64848a=a272_0x256998,_0x44b767=(0x0,shortid_1[_0x64848a(0x11b)])();return await(0x0,promises_1[_0x64848a(0x12f)])(path_1[_0x64848a(0x11b)][_0x64848a(0x11e)](this['metadataFolder'],_0x44b767+'.json'),JSON[_0x64848a(0x119)](_0x4fa94)),_0x44b767;}async[a272_0x256998(0x124)](){const _0x5b3dd8=a272_0x256998,{credentials:_0x4f9cd4,declarativeFilter:_0x2b6ee2,metadataTypes:_0x178dc3,maxChunkSize:_0x2e6d76,maxChunkItems:_0x409720,apiVersion:_0x19deca}=await new manifest_manger_1[(_0x5b3dd8(0x11b))](this[_0x5b3dd8(0x129)])['init'](),_0x1bfffd=await salesforce_1[_0x5b3dd8(0x10a)][_0x5b3dd8(0x108)](new auth_manager_1['AuthManager'](_0x4f9cd4),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x4745cf=await retrieve_factory_1[_0x5b3dd8(0x11b)][_0x5b3dd8(0x108)](_0x1bfffd,this[_0x5b3dd8(0x111)],_0x2b6ee2,_0x178dc3,_0x19deca)[_0x5b3dd8(0x124)]();await(0x0,fs_utils_1[_0x5b3dd8(0x12a)])(this[_0x5b3dd8(0x109)]);let _0x574345=[];const _0x293ba8=[];let _0xbd7f7=0x0;for(const _0x221bc4 in _0x4745cf[_0x5b3dd8(0x121)]){for(const {listMetadataItem:_0x5f3f25,files:_0x3e288b}of _0x4745cf[_0x5b3dd8(0x121)][_0x221bc4]['components']){const _0x1f1888=new jszip_1[(_0x5b3dd8(0x11b))]();for(const _0x184186 in _0x3e288b){await _0x1f1888['file'](_0x184186,_0x3e288b[_0x184186]);}const _0x35b3ee=await _0x1f1888[_0x5b3dd8(0x12d)]({'type':_0x5b3dd8(0x126),'compression':_0x5b3dd8(0x120),'compressionOptions':{'level':0x9}}),_0x5951eb={..._0x5f3f25,'zip':_0x35b3ee},_0x2edb8a=(0x0,object_sizeof_1[_0x5b3dd8(0x11b)])(_0x5951eb);if(_0x2edb8a>_0x2e6d76){await this['stateManager'][_0x5b3dd8(0x127)](_0x5b3dd8(0x135)+_0x5f3f25[_0x5b3dd8(0x10b)]+_0x5b3dd8(0x106)+_0x2edb8a+_0x5b3dd8(0x11f)+_0x2e6d76+'\x27');continue;}if(_0xbd7f7+_0x2edb8a>_0x2e6d76||_0x574345[_0x5b3dd8(0x117)]>=_0x409720){const _0x1caa68=await this['writeChunk'](_0x574345);_0x293ba8['push'](_0x1caa68),_0xbd7f7=0x0,_0x574345=[];}_0x574345[_0x5b3dd8(0x114)](_0x5951eb),_0xbd7f7+=_0x2edb8a;}}if(_0x574345[_0x5b3dd8(0x117)]){const _0x2b4403=await this[_0x5b3dd8(0x128)](_0x574345);_0x293ba8['push'](_0x2b4403);}await(0x0,promises_1[_0x5b3dd8(0x12f)])(this[_0x5b3dd8(0x133)],JSON['stringify'](_0x293ba8));}}exports[a272_0x256998(0x11b)]=RetrieveMetadata;