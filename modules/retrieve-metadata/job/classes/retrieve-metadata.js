const a267_0x8fc31d=a267_0x5d30;(function(_0x4d9ec4,_0x50fe87){const _0x3e77c8=a267_0x5d30,_0x135266=_0x4d9ec4();while(!![]){try{const _0xd11ac8=-parseInt(_0x3e77c8(0x121))/0x1*(-parseInt(_0x3e77c8(0x125))/0x2)+-parseInt(_0x3e77c8(0x112))/0x3*(parseInt(_0x3e77c8(0x10b))/0x4)+parseInt(_0x3e77c8(0x114))/0x5*(-parseInt(_0x3e77c8(0x111))/0x6)+-parseInt(_0x3e77c8(0x105))/0x7*(parseInt(_0x3e77c8(0x123))/0x8)+-parseInt(_0x3e77c8(0x113))/0x9*(-parseInt(_0x3e77c8(0x104))/0xa)+parseInt(_0x3e77c8(0xfd))/0xb+parseInt(_0x3e77c8(0xfa))/0xc*(parseInt(_0x3e77c8(0x109))/0xd);if(_0xd11ac8===_0x50fe87)break;else _0x135266['push'](_0x135266['shift']());}catch(_0x4770b7){_0x135266['push'](_0x135266['shift']());}}}(a267_0x266b,0x8ec12));function a267_0x5d30(_0x19e172,_0x3cc46c){const _0x10a92f=a267_0x266b();return a267_0x5d30=function(_0x2feb78,_0x3303bb){_0x2feb78=_0x2feb78-0xf9;let _0x266b51=_0x10a92f[_0x2feb78];return _0x266b51;},a267_0x5d30(_0x19e172,_0x3cc46c);}const a267_0x3303bb=(function(){let _0x3fc3dd=!![];return function(_0x469729,_0x50acd4){const _0x49b526=_0x3fc3dd?function(){const _0x5b4949=a267_0x5d30;if(_0x50acd4){const _0x1fed7f=_0x50acd4[_0x5b4949(0x128)](_0x469729,arguments);return _0x50acd4=null,_0x1fed7f;}}:function(){};return _0x3fc3dd=![],_0x49b526;};}()),a267_0x2feb78=a267_0x3303bb(this,function(){const _0xaeb40f=a267_0x5d30;return a267_0x2feb78[_0xaeb40f(0x10a)]()[_0xaeb40f(0x126)](_0xaeb40f(0x106))[_0xaeb40f(0x10a)]()['constructor'](a267_0x2feb78)[_0xaeb40f(0x126)](_0xaeb40f(0x106));});a267_0x2feb78();'use strict';var __importDefault=this&&this[a267_0x8fc31d(0x11d)]||function(_0x4d4425){const _0x39984f=a267_0x8fc31d;return _0x4d4425&&_0x4d4425[_0x39984f(0xff)]?_0x4d4425:{'default':_0x4d4425};};Object[a267_0x8fc31d(0x118)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a267_0x8fc31d(0x12d)),manifest_manger_1=__importDefault(require('./manifest-manger')),path_1=__importDefault(require('path')),promises_1=require(a267_0x8fc31d(0xfe)),fs_utils_1=require(a267_0x8fc31d(0x12b)),object_sizeof_1=__importDefault(require(a267_0x8fc31d(0xfc))),retrieve_factory_1=__importDefault(require(a267_0x8fc31d(0x12e))),auth_manager_1=require(a267_0x8fc31d(0x10f)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a267_0x8fc31d(0x110))),jszip_1=__importDefault(require(a267_0x8fc31d(0x117)));class RetrieveMetadata{constructor(_0x447185,_0xad9263,_0x1c26b3){const _0x397da9=a267_0x8fc31d;this['jobStorePath']=_0x447185,this[_0x397da9(0x108)]=_0xad9263,this[_0x397da9(0x11e)]=_0x1c26b3,this['metadataFolder']=path_1[_0x397da9(0x127)]['join'](this[_0x397da9(0x101)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0x397da9(0x10d)]=path_1[_0x397da9(0x127)][_0x397da9(0x116)](this['jobStorePath'],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async[a267_0x8fc31d(0x119)](_0x4a4775){const _0x31317d=a267_0x8fc31d,_0x4a729d=(0x0,shortid_1[_0x31317d(0x127)])();return await(0x0,promises_1['writeFile'])(path_1[_0x31317d(0x127)][_0x31317d(0x116)](this['metadataFolder'],_0x4a729d+_0x31317d(0x120)),JSON[_0x31317d(0xf9)](_0x4a4775)),_0x4a729d;}async['execute'](){const _0x196d24=a267_0x8fc31d,{credentials:_0x44b73d,declarativeFilter:_0x24e6c8,metadataTypes:_0x426739,maxChunkSize:_0x2e6ea5,maxChunkItems:_0x2924fb,apiVersion:_0x456e1b}=await new manifest_manger_1[(_0x196d24(0x127))](this[_0x196d24(0x101)])[_0x196d24(0x129)](),_0x4d1df4=await salesforce_1[_0x196d24(0x122)][_0x196d24(0x115)](new auth_manager_1[(_0x196d24(0x11c))](_0x44b73d),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x1fb1b7=await retrieve_factory_1['default'][_0x196d24(0x115)](_0x4d1df4,this[_0x196d24(0x108)],_0x24e6c8,_0x426739,_0x456e1b)[_0x196d24(0x12a)]();await(0x0,fs_utils_1[_0x196d24(0xfb)])(this[_0x196d24(0x11f)]);let _0x3aa7db=[];const _0x445b7e=[];let _0x2a5917=0x0;for(const _0x14b990 in _0x1fb1b7[_0x196d24(0x10e)]){for(const {listMetadataItem:_0x2cf3d7,files:_0x5f097b}of _0x1fb1b7[_0x196d24(0x10e)][_0x14b990]['components']){const _0x217f9f=new jszip_1[(_0x196d24(0x127))]();for(const _0x47a8bd in _0x5f097b){await _0x217f9f[_0x196d24(0x10c)](_0x47a8bd,_0x5f097b[_0x47a8bd]);}const _0x35998f=await _0x217f9f[_0x196d24(0x11b)]({'type':_0x196d24(0x11a),'compression':'DEFLATE','compressionOptions':{'level':0x9}}),_0x1305f2={..._0x2cf3d7,'zip':_0x35998f},_0x1b5c22=(0x0,object_sizeof_1[_0x196d24(0x127)])(_0x1305f2);if(_0x1b5c22>_0x2e6ea5){await this[_0x196d24(0x11e)][_0x196d24(0x124)](_0x196d24(0x103)+_0x2cf3d7[_0x196d24(0x102)]+_0x196d24(0x12c)+_0x1b5c22+_0x196d24(0x100)+_0x2e6ea5+'\x27');continue;}if(_0x2a5917+_0x1b5c22>_0x2e6ea5||_0x3aa7db['length']>=_0x2924fb){const _0x439f60=await this[_0x196d24(0x119)](_0x3aa7db);_0x445b7e[_0x196d24(0x107)](_0x439f60),_0x2a5917=0x0,_0x3aa7db=[];}_0x3aa7db[_0x196d24(0x107)](_0x1305f2),_0x2a5917+=_0x1b5c22;}}if(_0x3aa7db['length']){const _0x1865b1=await this['writeChunk'](_0x3aa7db);_0x445b7e[_0x196d24(0x107)](_0x1865b1);}await(0x0,promises_1['writeFile'])(this[_0x196d24(0x10d)],JSON[_0x196d24(0xf9)](_0x445b7e));}}exports['default']=RetrieveMetadata;function a267_0x266b(){const _0x301516=['4MpafPX','file','retrieveResultsPath','items','../../../shared/managers/auth.manager','shortid','6DqQdtM','1749999NIuCnd','1557cyZRNt','3308885TtORux','create','join','jszip','defineProperty','writeChunk','base64','generateAsync','AuthManager','__importDefault','stateManager','metadataFolder','.json','497911UfpYXD','AxiosInstanceUtils','8akEDok','addWarning','2FuOldT','search','default','apply','init','execute','../../../shared/utils/fs.utils','\x27\x20size\x20\x27','@flosum/salesforce','./retrieve-factory','stringify','528yzhDNG','makeDir','object-sizeof','6633209VHpNOF','fs/promises','__esModule','\x27\x20exceed\x20limit\x20\x27','jobStorePath','fileName','Item\x20\x27','37010DrOHZr','4950085rJpPMN','(((.+)+)+)+$','push','logger','235118iBVFBr','toString'];a267_0x266b=function(){return _0x301516;};return a267_0x266b();}