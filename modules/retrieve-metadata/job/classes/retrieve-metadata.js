const a272_0x413b34=a272_0x4b5f;function a272_0x4b5f(_0x2e17b5,_0x44d9d6){const _0x25c6ec=a272_0x4f56();return a272_0x4b5f=function(_0x22f9a3,_0xa804ec){_0x22f9a3=_0x22f9a3-0xa4;let _0x4f56bc=_0x25c6ec[_0x22f9a3];return _0x4f56bc;},a272_0x4b5f(_0x2e17b5,_0x44d9d6);}(function(_0x4d31a8,_0x49af57){const _0x5377af=a272_0x4b5f,_0x5e5686=_0x4d31a8();while(!![]){try{const _0x52f18b=-parseInt(_0x5377af(0xd3))/0x1*(parseInt(_0x5377af(0xc7))/0x2)+parseInt(_0x5377af(0xc3))/0x3+parseInt(_0x5377af(0xca))/0x4+-parseInt(_0x5377af(0xb6))/0x5+-parseInt(_0x5377af(0xb2))/0x6*(parseInt(_0x5377af(0xcc))/0x7)+-parseInt(_0x5377af(0xa4))/0x8*(-parseInt(_0x5377af(0xaf))/0x9)+parseInt(_0x5377af(0xc4))/0xa*(parseInt(_0x5377af(0xbd))/0xb);if(_0x52f18b===_0x49af57)break;else _0x5e5686['push'](_0x5e5686['shift']());}catch(_0x202c5f){_0x5e5686['push'](_0x5e5686['shift']());}}}(a272_0x4f56,0x53c46));const a272_0xa804ec=(function(){let _0x1a5681=!![];return function(_0x1742cd,_0x51e88e){const _0x91cb39=_0x1a5681?function(){if(_0x51e88e){const _0x4ae98e=_0x51e88e['apply'](_0x1742cd,arguments);return _0x51e88e=null,_0x4ae98e;}}:function(){};return _0x1a5681=![],_0x91cb39;};}()),a272_0x22f9a3=a272_0xa804ec(this,function(){const _0x33b6b5=a272_0x4b5f;return a272_0x22f9a3[_0x33b6b5(0xbb)]()[_0x33b6b5(0xd5)](_0x33b6b5(0xa5))['toString']()[_0x33b6b5(0xcf)](a272_0x22f9a3)[_0x33b6b5(0xd5)]('(((.+)+)+)+$');});a272_0x22f9a3();'use strict';var __importDefault=this&&this[a272_0x413b34(0xb8)]||function(_0x34712b){const _0x11f51c=a272_0x413b34;return _0x34712b&&_0x34712b[_0x11f51c(0xc8)]?_0x34712b:{'default':_0x34712b};};Object['defineProperty'](exports,a272_0x413b34(0xc8),{'value':!![]});const salesforce_1=require(a272_0x413b34(0xb0)),manifest_manger_1=__importDefault(require(a272_0x413b34(0xa6))),path_1=__importDefault(require(a272_0x413b34(0xad))),promises_1=require(a272_0x413b34(0xc0)),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require(a272_0x413b34(0xbe))),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require('../../../shared/managers/auth.manager'),constants_1=require(a272_0x413b34(0xc1)),shortid_1=__importDefault(require(a272_0x413b34(0xb3))),jszip_1=__importDefault(require(a272_0x413b34(0xae)));class RetrieveMetadata{constructor(_0x34cb1f,_0x5051a4,_0x4a0092){const _0x237255=a272_0x413b34;this[_0x237255(0xa8)]=_0x34cb1f,this[_0x237255(0xbf)]=_0x5051a4,this[_0x237255(0xd1)]=_0x4a0092,this[_0x237255(0xac)]=path_1[_0x237255(0xa7)]['join'](this['jobStorePath'],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0x237255(0xb9)]=path_1[_0x237255(0xa7)][_0x237255(0xcd)](this[_0x237255(0xa8)],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async[a272_0x413b34(0xb5)](_0x42b4b4){const _0x19f645=a272_0x413b34,_0x416261=(0x0,shortid_1[_0x19f645(0xa7)])();return await(0x0,promises_1[_0x19f645(0xba)])(path_1[_0x19f645(0xa7)][_0x19f645(0xcd)](this['metadataFolder'],_0x416261+'.json'),JSON[_0x19f645(0xb7)](_0x42b4b4)),_0x416261;}async[a272_0x413b34(0xb4)](){const _0x33ef11=a272_0x413b34,{credentials:_0x1b34ff,declarativeFilter:_0xd55f9,metadataTypes:_0x5cb92b,maxChunkSize:_0x2a4f7d,maxChunkItems:_0x13fde6,apiVersion:_0x1acbb6}=await new manifest_manger_1['default'](this['jobStorePath'])[_0x33ef11(0xaa)](),_0x95b5cf=await salesforce_1[_0x33ef11(0xd2)][_0x33ef11(0xcb)](new auth_manager_1[(_0x33ef11(0xb1))](_0x1b34ff),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x252482=await retrieve_factory_1[_0x33ef11(0xa7)][_0x33ef11(0xcb)](_0x95b5cf,this[_0x33ef11(0xbf)],_0xd55f9,_0x5cb92b,_0x1acbb6)[_0x33ef11(0xb4)]();await(0x0,fs_utils_1['makeDir'])(this[_0x33ef11(0xac)]);let _0x5e6d5d=[];const _0x491a78=[];let _0x325ee7=0x0;for(const _0x46d53e in _0x252482[_0x33ef11(0xd0)]){for(const {listMetadataItem:_0xf2a63f,files:_0x59c2c3}of _0x252482[_0x33ef11(0xd0)][_0x46d53e][_0x33ef11(0xc5)]){const _0x50adb9=new jszip_1[(_0x33ef11(0xa7))]();for(const _0x58aea5 in _0x59c2c3){await _0x50adb9[_0x33ef11(0xab)](_0x58aea5,_0x59c2c3[_0x58aea5]);}const _0x4019a3=await _0x50adb9['generateAsync']({'type':'base64','compression':_0x33ef11(0xc6),'compressionOptions':{'level':0x9}}),_0x1bfde5={..._0xf2a63f,'zip':_0x4019a3},_0x4ae149=(0x0,object_sizeof_1[_0x33ef11(0xa7)])(_0x1bfde5);if(_0x4ae149>_0x2a4f7d){await this['stateManager'][_0x33ef11(0xbc)](_0x33ef11(0xd6)+_0xf2a63f[_0x33ef11(0xce)]+_0x33ef11(0xc9)+_0x4ae149+_0x33ef11(0xd4)+_0x2a4f7d+'\x27');continue;}if(_0x325ee7+_0x4ae149>_0x2a4f7d||_0x5e6d5d['length']>=_0x13fde6){const _0x5f22c9=await this['writeChunk'](_0x5e6d5d);_0x491a78[_0x33ef11(0xa9)](_0x5f22c9),_0x325ee7=0x0,_0x5e6d5d=[];}_0x5e6d5d['push'](_0x1bfde5),_0x325ee7+=_0x4ae149;}}if(_0x5e6d5d[_0x33ef11(0xc2)]){const _0x35c607=await this['writeChunk'](_0x5e6d5d);_0x491a78[_0x33ef11(0xa9)](_0x35c607);}await(0x0,promises_1[_0x33ef11(0xba)])(this['retrieveResultsPath'],JSON[_0x33ef11(0xb7)](_0x491a78));}}exports['default']=RetrieveMetadata;function a272_0x4f56(){const _0x44ecd3=['\x27\x20size\x20\x27','348976wwwjdy','create','3974411ljmaWf','join','fileName','constructor','items','stateManager','AxiosInstanceUtils','3hlGljP','\x27\x20exceed\x20limit\x20\x27','search','Item\x20\x27','327480vxeBnH','(((.+)+)+)+$','./manifest-manger','default','jobStorePath','push','init','file','metadataFolder','path','jszip','54IaLkHV','@flosum/salesforce','AuthManager','6UTrIIa','shortid','execute','writeChunk','1080055kpaniv','stringify','__importDefault','retrieveResultsPath','writeFile','toString','addWarning','11asWoUo','object-sizeof','logger','fs/promises','../../constants','length','1284945PhZdyz','5035660cAkVJd','components','DEFLATE','91894bTtglt','__esModule'];a272_0x4f56=function(){return _0x44ecd3;};return a272_0x4f56();}