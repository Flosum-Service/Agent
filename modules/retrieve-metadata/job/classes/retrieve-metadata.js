const a316_0x106b67=a316_0x33ff;function a316_0x55c1(){const _0x2b6087=['writeFile','AxiosInstanceUtils','AuthManager','fs/promises','logger','push','.json','items','create','1725410YQfEYa','retrieveResultsPath','stateManager','base64','Item\x20\x27','../../../shared/managers/auth.manager','RETRIEVE_RESULT_FOLDER_NAME','60562wxztvn','generateAsync','@flosum/salesforce','1168688PaUXCj','./retrieve-factory','jobStorePath','addWarning','init','file','fileName','search','4RmPTsL','349374tYAkle','3OXkQKk','execute','jszip','../../../shared/utils/fs.utils','default','1200619TGZuUz','stringify','components','writeChunk','2125572FYVCJf','length','__esModule','metadataFolder','./manifest-manger','shortid','2249490XDGbJw','9AWwgec','object-sizeof','join','toString','path','(((.+)+)+)+$','DEFLATE'];a316_0x55c1=function(){return _0x2b6087;};return a316_0x55c1();}(function(_0x539618,_0x2e2b16){const _0x2abcbb=a316_0x33ff,_0x391b55=_0x539618();while(!![]){try{const _0x98bc0e=parseInt(_0x2abcbb(0xb8))/0x1*(parseInt(_0x2abcbb(0xdf))/0x2)+-parseInt(_0x2abcbb(0xb7))/0x3+parseInt(_0x2abcbb(0xea))/0x4*(-parseInt(_0x2abcbb(0xd8))/0x5)+parseInt(_0x2abcbb(0xc1))/0x6+-parseInt(_0x2abcbb(0xbd))/0x7+parseInt(_0x2abcbb(0xe2))/0x8+-parseInt(_0x2abcbb(0xc8))/0x9*(-parseInt(_0x2abcbb(0xc7))/0xa);if(_0x98bc0e===_0x2e2b16)break;else _0x391b55['push'](_0x391b55['shift']());}catch(_0x57eb87){_0x391b55['push'](_0x391b55['shift']());}}}(a316_0x55c1,0x2cb2b));const a316_0x498bc3=(function(){let _0x48a536=!![];return function(_0x1d87fa,_0x5d5b34){const _0x18f3c2=_0x48a536?function(){if(_0x5d5b34){const _0x3cac64=_0x5d5b34['apply'](_0x1d87fa,arguments);return _0x5d5b34=null,_0x3cac64;}}:function(){};return _0x48a536=![],_0x18f3c2;};}()),a316_0x377a6e=a316_0x498bc3(this,function(){const _0x553812=a316_0x33ff;return a316_0x377a6e[_0x553812(0xcb)]()[_0x553812(0xe9)](_0x553812(0xcd))['toString']()['constructor'](a316_0x377a6e)['search'](_0x553812(0xcd));});a316_0x377a6e();'use strict';function a316_0x33ff(_0x5c7273,_0x518bf5){const _0x3921f7=a316_0x55c1();return a316_0x33ff=function(_0x377a6e,_0x498bc3){_0x377a6e=_0x377a6e-0xb7;let _0x55c162=_0x3921f7[_0x377a6e];return _0x55c162;},a316_0x33ff(_0x5c7273,_0x518bf5);}var __importDefault=this&&this['__importDefault']||function(_0x2526a0){return _0x2526a0&&_0x2526a0['__esModule']?_0x2526a0:{'default':_0x2526a0};};Object['defineProperty'](exports,a316_0x106b67(0xc3),{'value':!![]});const salesforce_1=require(a316_0x106b67(0xe1)),manifest_manger_1=__importDefault(require(a316_0x106b67(0xc5))),path_1=__importDefault(require(a316_0x106b67(0xcc))),promises_1=require(a316_0x106b67(0xd2)),fs_utils_1=require(a316_0x106b67(0xbb)),object_sizeof_1=__importDefault(require(a316_0x106b67(0xc9))),retrieve_factory_1=__importDefault(require(a316_0x106b67(0xe3))),auth_manager_1=require(a316_0x106b67(0xdd)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a316_0x106b67(0xc6))),jszip_1=__importDefault(require(a316_0x106b67(0xba)));class RetrieveMetadata{constructor(_0x1b79dd,_0x2f2e69,_0x301630){const _0x2e142e=a316_0x106b67;this[_0x2e142e(0xe4)]=_0x1b79dd,this[_0x2e142e(0xd3)]=_0x2f2e69,this[_0x2e142e(0xda)]=_0x301630,this[_0x2e142e(0xc4)]=path_1[_0x2e142e(0xbc)]['join'](this['jobStorePath'],constants_1[_0x2e142e(0xde)]),this['retrieveResultsPath']=path_1[_0x2e142e(0xbc)][_0x2e142e(0xca)](this[_0x2e142e(0xe4)],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async[a316_0x106b67(0xc0)](_0x51e00d){const _0x54636a=a316_0x106b67,_0x7f6a6d=(0x0,shortid_1[_0x54636a(0xbc)])();return await(0x0,promises_1[_0x54636a(0xcf)])(path_1[_0x54636a(0xbc)]['join'](this[_0x54636a(0xc4)],_0x7f6a6d+_0x54636a(0xd5)),JSON['stringify'](_0x51e00d)),_0x7f6a6d;}async['execute'](){const _0x39f54b=a316_0x106b67,{credentials:_0x1e8e93,declarativeFilter:_0x1ad002,metadataTypes:_0x35fba9,maxChunkSize:_0x43705a,maxChunkItems:_0x558359,apiVersion:_0x5753d0}=await new manifest_manger_1['default'](this[_0x39f54b(0xe4)])[_0x39f54b(0xe6)](),_0x4f8574=await salesforce_1[_0x39f54b(0xd0)]['create'](new auth_manager_1[(_0x39f54b(0xd1))](_0x1e8e93),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x159536=await retrieve_factory_1[_0x39f54b(0xbc)][_0x39f54b(0xd7)](_0x4f8574,this['logger'],_0x1ad002,_0x35fba9,_0x5753d0)[_0x39f54b(0xb9)]();await(0x0,fs_utils_1['makeDir'])(this[_0x39f54b(0xc4)]);let _0x5f432b=[];const _0x5564d3=[];let _0x5590a0=0x0;for(const _0x160fd3 in _0x159536[_0x39f54b(0xd6)]){for(const {listMetadataItem:_0x239102,files:_0x5a44a0}of _0x159536[_0x39f54b(0xd6)][_0x160fd3][_0x39f54b(0xbf)]){const _0x48edb7=new jszip_1[(_0x39f54b(0xbc))]();for(const _0x3bc361 in _0x5a44a0){await _0x48edb7[_0x39f54b(0xe7)](_0x3bc361,_0x5a44a0[_0x3bc361]);}const _0x5cd5c9=await _0x48edb7[_0x39f54b(0xe0)]({'type':_0x39f54b(0xdb),'compression':_0x39f54b(0xce),'compressionOptions':{'level':0x9}}),_0x4cfe4b={..._0x239102,'zip':_0x5cd5c9},_0x525eac=(0x0,object_sizeof_1[_0x39f54b(0xbc)])(_0x4cfe4b);if(_0x525eac>_0x43705a){await this[_0x39f54b(0xda)][_0x39f54b(0xe5)](_0x39f54b(0xdc)+_0x239102[_0x39f54b(0xe8)]+'\x27\x20size\x20\x27'+_0x525eac+'\x27\x20exceed\x20limit\x20\x27'+_0x43705a+'\x27');continue;}if(_0x5590a0+_0x525eac>_0x43705a||_0x5f432b['length']>=_0x558359){const _0x355d41=await this['writeChunk'](_0x5f432b);_0x5564d3[_0x39f54b(0xd4)](_0x355d41),_0x5590a0=0x0,_0x5f432b=[];}_0x5f432b['push'](_0x4cfe4b),_0x5590a0+=_0x525eac;}}if(_0x5f432b[_0x39f54b(0xc2)]){const _0x56b5c0=await this[_0x39f54b(0xc0)](_0x5f432b);_0x5564d3[_0x39f54b(0xd4)](_0x56b5c0);}await(0x0,promises_1[_0x39f54b(0xcf)])(this[_0x39f54b(0xd9)],JSON[_0x39f54b(0xbe)](_0x5564d3));}}exports[a316_0x106b67(0xbc)]=RetrieveMetadata;