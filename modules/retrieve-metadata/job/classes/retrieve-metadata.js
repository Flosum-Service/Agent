function a288_0x965b(_0x3722a7,_0x1c5cfb){const _0x34c50e=a288_0x3ee4();return a288_0x965b=function(_0x568e61,_0x3d1805){_0x568e61=_0x568e61-0x9d;let _0x3ee4e0=_0x34c50e[_0x568e61];return _0x3ee4e0;},a288_0x965b(_0x3722a7,_0x1c5cfb);}const a288_0x36c9a1=a288_0x965b;(function(_0x1aa183,_0xf3e72b){const _0x1a485c=a288_0x965b,_0x18209e=_0x1aa183();while(!![]){try{const _0x1c0640=-parseInt(_0x1a485c(0xb4))/0x1*(-parseInt(_0x1a485c(0x9f))/0x2)+-parseInt(_0x1a485c(0xa7))/0x3+-parseInt(_0x1a485c(0xc6))/0x4+-parseInt(_0x1a485c(0xb5))/0x5*(parseInt(_0x1a485c(0xca))/0x6)+parseInt(_0x1a485c(0xa2))/0x7*(parseInt(_0x1a485c(0xb6))/0x8)+parseInt(_0x1a485c(0xa4))/0x9*(-parseInt(_0x1a485c(0xbe))/0xa)+parseInt(_0x1a485c(0xa8))/0xb;if(_0x1c0640===_0xf3e72b)break;else _0x18209e['push'](_0x18209e['shift']());}catch(_0x48d1f8){_0x18209e['push'](_0x18209e['shift']());}}}(a288_0x3ee4,0x39036));const a288_0x3d1805=(function(){let _0x3d11ee=!![];return function(_0x279d43,_0x39ce9d){const _0x4f2fe3=_0x3d11ee?function(){if(_0x39ce9d){const _0x3cd80d=_0x39ce9d['apply'](_0x279d43,arguments);return _0x39ce9d=null,_0x3cd80d;}}:function(){};return _0x3d11ee=![],_0x4f2fe3;};}()),a288_0x568e61=a288_0x3d1805(this,function(){const _0x2a8662=a288_0x965b;return a288_0x568e61[_0x2a8662(0xb9)]()[_0x2a8662(0xa1)](_0x2a8662(0xba))[_0x2a8662(0xb9)]()[_0x2a8662(0xbc)](a288_0x568e61)['search'](_0x2a8662(0xba));});a288_0x568e61();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x12fb94){return _0x12fb94&&_0x12fb94['__esModule']?_0x12fb94:{'default':_0x12fb94};};function a288_0x3ee4(){const _0x241c3d=['@flosum/salesforce','AxiosInstanceUtils','default','metadataFolder','push','4494HGODpp','fs/promises','search','43547nMtJJM','retrieveResultsPath','459207oirFoO','RETRIEVE_RESULTS_IDS_FILENAME','object-sizeof','368952VnNnED','4776596lwQehD','DEFLATE','join','items','jobStorePath','.json','addWarning','components','stateManager','writeChunk','writeFile','path','61cIccCK','77890cPMmhM','296OjrEaA','create','length','toString','(((.+)+)+)+$','execute','constructor','defineProperty','10UbfOso','makeDir','Item\x20\x27','\x27\x20exceed\x20limit\x20\x27','AuthManager','../../constants','./manifest-manger','./retrieve-factory','952668XHlzNQ','stringify','file','logger','60gYgpnM'];a288_0x3ee4=function(){return _0x241c3d;};return a288_0x3ee4();}Object[a288_0x36c9a1(0xbd)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a288_0x36c9a1(0xcb)),manifest_manger_1=__importDefault(require(a288_0x36c9a1(0xc4))),path_1=__importDefault(require(a288_0x36c9a1(0xb3))),promises_1=require(a288_0x36c9a1(0xa0)),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require(a288_0x36c9a1(0xa6))),retrieve_factory_1=__importDefault(require(a288_0x36c9a1(0xc5))),auth_manager_1=require('../../../shared/managers/auth.manager'),constants_1=require(a288_0x36c9a1(0xc3)),shortid_1=__importDefault(require('shortid')),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x16906d,_0x4afc85,_0x53a7fc){const _0xcd9adb=a288_0x36c9a1;this['jobStorePath']=_0x16906d,this[_0xcd9adb(0xc9)]=_0x4afc85,this[_0xcd9adb(0xb0)]=_0x53a7fc,this['metadataFolder']=path_1['default'][_0xcd9adb(0xaa)](this['jobStorePath'],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0xcd9adb(0xa3)]=path_1[_0xcd9adb(0xcd)][_0xcd9adb(0xaa)](this['jobStorePath'],constants_1[_0xcd9adb(0xa5)]);}async[a288_0x36c9a1(0xb1)](_0x129b5d){const _0x2c8a9a=a288_0x36c9a1,_0x2db507=(0x0,shortid_1[_0x2c8a9a(0xcd)])();return await(0x0,promises_1[_0x2c8a9a(0xb2)])(path_1[_0x2c8a9a(0xcd)][_0x2c8a9a(0xaa)](this[_0x2c8a9a(0x9d)],_0x2db507+_0x2c8a9a(0xad)),JSON[_0x2c8a9a(0xc7)](_0x129b5d)),_0x2db507;}async[a288_0x36c9a1(0xbb)](){const _0x59700c=a288_0x36c9a1,{credentials:_0x5bd2ec,declarativeFilter:_0xf86a14,metadataTypes:_0x269919,maxChunkSize:_0x2da5bc,maxChunkItems:_0x24280b,apiVersion:_0x49a4bd}=await new manifest_manger_1['default'](this[_0x59700c(0xac)])['init'](),_0x49687a=await salesforce_1[_0x59700c(0xcc)][_0x59700c(0xb7)](new auth_manager_1[(_0x59700c(0xc2))](_0x5bd2ec),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x225f1f=await retrieve_factory_1[_0x59700c(0xcd)]['create'](_0x49687a,this[_0x59700c(0xc9)],_0xf86a14,_0x269919,_0x49a4bd)[_0x59700c(0xbb)]();await(0x0,fs_utils_1[_0x59700c(0xbf)])(this['metadataFolder']);let _0x25641d=[];const _0x45565d=[];let _0x3413f0=0x0;for(const _0x22fa7b in _0x225f1f[_0x59700c(0xab)]){for(const {listMetadataItem:_0x2bf9db,files:_0x58c83e}of _0x225f1f[_0x59700c(0xab)][_0x22fa7b][_0x59700c(0xaf)]){const _0x5ccd86=new jszip_1[(_0x59700c(0xcd))]();for(const _0x54eb0c in _0x58c83e){await _0x5ccd86[_0x59700c(0xc8)](_0x54eb0c,_0x58c83e[_0x54eb0c]);}const _0x5ad75f=await _0x5ccd86['generateAsync']({'type':'base64','compression':_0x59700c(0xa9),'compressionOptions':{'level':0x9}}),_0x18470b={..._0x2bf9db,'zip':_0x5ad75f},_0x545d04=(0x0,object_sizeof_1[_0x59700c(0xcd)])(_0x18470b);if(_0x545d04>_0x2da5bc){await this[_0x59700c(0xb0)][_0x59700c(0xae)](_0x59700c(0xc0)+_0x2bf9db['fileName']+'\x27\x20size\x20\x27'+_0x545d04+_0x59700c(0xc1)+_0x2da5bc+'\x27');continue;}if(_0x3413f0+_0x545d04>_0x2da5bc||_0x25641d[_0x59700c(0xb8)]>=_0x24280b){const _0x44b488=await this['writeChunk'](_0x25641d);_0x45565d[_0x59700c(0x9e)](_0x44b488),_0x3413f0=0x0,_0x25641d=[];}_0x25641d[_0x59700c(0x9e)](_0x18470b),_0x3413f0+=_0x545d04;}}if(_0x25641d['length']){const _0x54afd2=await this[_0x59700c(0xb1)](_0x25641d);_0x45565d[_0x59700c(0x9e)](_0x54afd2);}await(0x0,promises_1[_0x59700c(0xb2)])(this['retrieveResultsPath'],JSON['stringify'](_0x45565d));}}exports[a288_0x36c9a1(0xcd)]=RetrieveMetadata;