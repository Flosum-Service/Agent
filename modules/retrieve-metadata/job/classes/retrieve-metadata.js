const a272_0x3bc7c5=a272_0x2af1;(function(_0x51cef9,_0x4fe945){const _0x5d3f86=a272_0x2af1,_0x151e3d=_0x51cef9();while(!![]){try{const _0x15f911=-parseInt(_0x5d3f86(0x175))/0x1*(parseInt(_0x5d3f86(0x195))/0x2)+-parseInt(_0x5d3f86(0x168))/0x3*(parseInt(_0x5d3f86(0x184))/0x4)+-parseInt(_0x5d3f86(0x16b))/0x5*(-parseInt(_0x5d3f86(0x17e))/0x6)+-parseInt(_0x5d3f86(0x189))/0x7*(-parseInt(_0x5d3f86(0x19a))/0x8)+-parseInt(_0x5d3f86(0x17c))/0x9+-parseInt(_0x5d3f86(0x17f))/0xa*(-parseInt(_0x5d3f86(0x191))/0xb)+-parseInt(_0x5d3f86(0x193))/0xc*(-parseInt(_0x5d3f86(0x18a))/0xd);if(_0x15f911===_0x4fe945)break;else _0x151e3d['push'](_0x151e3d['shift']());}catch(_0x180ae4){_0x151e3d['push'](_0x151e3d['shift']());}}}(a272_0x527b,0xa5484));const a272_0x3b6fbd=(function(){let _0x226870=!![];return function(_0x16882a,_0x532663){const _0x23d8a1=_0x226870?function(){const _0x34029f=a272_0x2af1;if(_0x532663){const _0x1a119a=_0x532663[_0x34029f(0x171)](_0x16882a,arguments);return _0x532663=null,_0x1a119a;}}:function(){};return _0x226870=![],_0x23d8a1;};}()),a272_0xb3ee9a=a272_0x3b6fbd(this,function(){const _0x461247=a272_0x2af1;return a272_0xb3ee9a[_0x461247(0x16a)]()[_0x461247(0x163)](_0x461247(0x190))['toString']()[_0x461247(0x172)](a272_0xb3ee9a)['search'](_0x461247(0x190));});function a272_0x527b(){const _0x259941=['logger','Item\x20\x27','execute','object-sizeof','(((.+)+)+)+$','319sGntlk','__importDefault','6616752znPsuK','retrieveResultsPath','74038NaBgXZ','defineProperty','components','fileName','items','2798056CdRghA','push','jobStorePath','generateAsync','search','stringify','../../constants','RETRIEVE_RESULT_FOLDER_NAME','default','9003Nwdueh','writeChunk','toString','3125CvuKoK','@flosum/salesforce','DEFLATE','../../../shared/managers/auth.manager','./retrieve-factory','length','apply','constructor','__esModule','create','2hfCthX','RETRIEVE_RESULTS_IDS_FILENAME','./manifest-manger','makeDir','init','stateManager','fs/promises','7276851KOTAIp','\x27\x20exceed\x20limit\x20\x27','11358oFilRg','156890voxNBR','file','AxiosInstanceUtils','AuthManager','path','1772OoNTlw','join','.json','shortid','writeFile','14nZRWNq','13KBnUbW','metadataFolder'];a272_0x527b=function(){return _0x259941;};return a272_0x527b();}a272_0xb3ee9a();function a272_0x2af1(_0x2e6337,_0x52e6f5){const _0x496156=a272_0x527b();return a272_0x2af1=function(_0xb3ee9a,_0x3b6fbd){_0xb3ee9a=_0xb3ee9a-0x160;let _0x527b44=_0x496156[_0xb3ee9a];return _0x527b44;},a272_0x2af1(_0x2e6337,_0x52e6f5);}'use strict';var __importDefault=this&&this[a272_0x3bc7c5(0x192)]||function(_0x1c44cf){const _0x2590be=a272_0x3bc7c5;return _0x1c44cf&&_0x1c44cf[_0x2590be(0x173)]?_0x1c44cf:{'default':_0x1c44cf};};Object[a272_0x3bc7c5(0x196)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a272_0x3bc7c5(0x16c)),manifest_manger_1=__importDefault(require(a272_0x3bc7c5(0x177))),path_1=__importDefault(require(a272_0x3bc7c5(0x183))),promises_1=require(a272_0x3bc7c5(0x17b)),fs_utils_1=require('../../../shared/utils/fs.utils'),object_sizeof_1=__importDefault(require(a272_0x3bc7c5(0x18f))),retrieve_factory_1=__importDefault(require(a272_0x3bc7c5(0x16f))),auth_manager_1=require(a272_0x3bc7c5(0x16e)),constants_1=require(a272_0x3bc7c5(0x165)),shortid_1=__importDefault(require(a272_0x3bc7c5(0x187))),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x17f963,_0x34ec7c,_0x420fce){const _0x59b22a=a272_0x3bc7c5;this[_0x59b22a(0x161)]=_0x17f963,this[_0x59b22a(0x18c)]=_0x34ec7c,this[_0x59b22a(0x17a)]=_0x420fce,this[_0x59b22a(0x18b)]=path_1[_0x59b22a(0x167)][_0x59b22a(0x185)](this[_0x59b22a(0x161)],constants_1[_0x59b22a(0x166)]),this['retrieveResultsPath']=path_1[_0x59b22a(0x167)][_0x59b22a(0x185)](this['jobStorePath'],constants_1[_0x59b22a(0x176)]);}async[a272_0x3bc7c5(0x169)](_0x4fb107){const _0x42ad2b=a272_0x3bc7c5,_0x5c35d7=(0x0,shortid_1['default'])();return await(0x0,promises_1[_0x42ad2b(0x188)])(path_1[_0x42ad2b(0x167)][_0x42ad2b(0x185)](this['metadataFolder'],_0x5c35d7+_0x42ad2b(0x186)),JSON[_0x42ad2b(0x164)](_0x4fb107)),_0x5c35d7;}async[a272_0x3bc7c5(0x18e)](){const _0xc68314=a272_0x3bc7c5,{credentials:_0x58b320,declarativeFilter:_0x322b03,metadataTypes:_0x218a03,maxChunkSize:_0x211e84,maxChunkItems:_0x581f91,apiVersion:_0x19a0a6}=await new manifest_manger_1['default'](this['jobStorePath'])[_0xc68314(0x179)](),_0x476d58=await salesforce_1[_0xc68314(0x181)][_0xc68314(0x174)](new auth_manager_1[(_0xc68314(0x182))](_0x58b320),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x37d407=await retrieve_factory_1[_0xc68314(0x167)][_0xc68314(0x174)](_0x476d58,this[_0xc68314(0x18c)],_0x322b03,_0x218a03,_0x19a0a6)[_0xc68314(0x18e)]();await(0x0,fs_utils_1[_0xc68314(0x178)])(this['metadataFolder']);let _0x4449bf=[];const _0x224e89=[];let _0xefe5b9=0x0;for(const _0x5ccc21 in _0x37d407[_0xc68314(0x199)]){for(const {listMetadataItem:_0x4ffcae,files:_0x30147b}of _0x37d407[_0xc68314(0x199)][_0x5ccc21][_0xc68314(0x197)]){const _0x158353=new jszip_1[(_0xc68314(0x167))]();for(const _0x3dda0d in _0x30147b){await _0x158353[_0xc68314(0x180)](_0x3dda0d,_0x30147b[_0x3dda0d]);}const _0x2ec2e5=await _0x158353[_0xc68314(0x162)]({'type':'base64','compression':_0xc68314(0x16d),'compressionOptions':{'level':0x9}}),_0x36b21b={..._0x4ffcae,'zip':_0x2ec2e5},_0x4ddec7=(0x0,object_sizeof_1[_0xc68314(0x167)])(_0x36b21b);if(_0x4ddec7>_0x211e84){await this[_0xc68314(0x17a)]['addWarning'](_0xc68314(0x18d)+_0x4ffcae[_0xc68314(0x198)]+'\x27\x20size\x20\x27'+_0x4ddec7+_0xc68314(0x17d)+_0x211e84+'\x27');continue;}if(_0xefe5b9+_0x4ddec7>_0x211e84||_0x4449bf[_0xc68314(0x170)]>=_0x581f91){const _0x2f7e2b=await this[_0xc68314(0x169)](_0x4449bf);_0x224e89['push'](_0x2f7e2b),_0xefe5b9=0x0,_0x4449bf=[];}_0x4449bf[_0xc68314(0x160)](_0x36b21b),_0xefe5b9+=_0x4ddec7;}}if(_0x4449bf['length']){const _0x2532f8=await this[_0xc68314(0x169)](_0x4449bf);_0x224e89[_0xc68314(0x160)](_0x2532f8);}await(0x0,promises_1[_0xc68314(0x188)])(this[_0xc68314(0x194)],JSON[_0xc68314(0x164)](_0x224e89));}}exports[a272_0x3bc7c5(0x167)]=RetrieveMetadata;