const a266_0x18ed6c=a266_0x1264;(function(_0x4d3736,_0x29aa65){const _0x3d1cda=a266_0x1264,_0x3f5cd8=_0x4d3736();while(!![]){try{const _0x1c8440=-parseInt(_0x3d1cda(0x18b))/0x1+-parseInt(_0x3d1cda(0x15a))/0x2*(parseInt(_0x3d1cda(0x17d))/0x3)+-parseInt(_0x3d1cda(0x184))/0x4*(parseInt(_0x3d1cda(0x175))/0x5)+-parseInt(_0x3d1cda(0x179))/0x6*(-parseInt(_0x3d1cda(0x176))/0x7)+parseInt(_0x3d1cda(0x164))/0x8*(-parseInt(_0x3d1cda(0x162))/0x9)+parseInt(_0x3d1cda(0x16e))/0xa+parseInt(_0x3d1cda(0x178))/0xb*(parseInt(_0x3d1cda(0x168))/0xc);if(_0x1c8440===_0x29aa65)break;else _0x3f5cd8['push'](_0x3f5cd8['shift']());}catch(_0x5719f6){_0x3f5cd8['push'](_0x3f5cd8['shift']());}}}(a266_0x1cd8,0x307a8));const a266_0x409d4f=(function(){let _0x2937f4=!![];return function(_0x10d4c1,_0x77b58d){const _0x355ec1=_0x2937f4?function(){const _0x3f7bf6=a266_0x1264;if(_0x77b58d){const _0x5a670a=_0x77b58d[_0x3f7bf6(0x161)](_0x10d4c1,arguments);return _0x77b58d=null,_0x5a670a;}}:function(){};return _0x2937f4=![],_0x355ec1;};}()),a266_0x24f011=a266_0x409d4f(this,function(){const _0x15c708=a266_0x1264;return a266_0x24f011[_0x15c708(0x171)]()[_0x15c708(0x185)](_0x15c708(0x188))[_0x15c708(0x171)]()['constructor'](a266_0x24f011)[_0x15c708(0x185)]('(((.+)+)+)+$');});a266_0x24f011();'use strict';function a266_0x1264(_0x449ecf,_0x141632){const _0xad85e5=a266_0x1cd8();return a266_0x1264=function(_0x24f011,_0x409d4f){_0x24f011=_0x24f011-0x158;let _0x1cd888=_0xad85e5[_0x24f011];return _0x1cd888;},a266_0x1264(_0x449ecf,_0x141632);}var __importDefault=this&&this[a266_0x18ed6c(0x182)]||function(_0xf74654){const _0x3aef71=a266_0x18ed6c;return _0xf74654&&_0xf74654[_0x3aef71(0x18d)]?_0xf74654:{'default':_0xf74654};};function a266_0x1cd8(){const _0xcd82a1=['__esModule','\x27\x20size\x20\x27','object-sizeof','path','metadataFolder','AuthManager','RETRIEVE_RESULT_FOLDER_NAME','push','28FAoJus','RETRIEVE_RESULTS_IDS_FILENAME','fileName','jszip','writeFile','stateManager','items','apply','387JCLFZV','default','12568OEaTAh','./retrieve-factory','defineProperty','execute','2680716tyZIvM','stringify','file','logger','init','create','583650BBYzFR','Item\x20\x27','shortid','toString','makeDir','base64','DEFLATE','10mCglfP','469ITqJIJ','jobStorePath','11ljCiQL','27516hblCji','join','addWarning','writeChunk','39369TkpDlo','\x27\x20exceed\x20limit\x20\x27','components','@flosum/salesforce','generateAsync','__importDefault','../../../shared/utils/fs.utils','226172FRTvCu','search','.json','length','(((.+)+)+)+$','../../../shared/managers/auth.manager','./manifest-manger','26091NMZrGK','retrieveResultsPath'];a266_0x1cd8=function(){return _0xcd82a1;};return a266_0x1cd8();}Object[a266_0x18ed6c(0x166)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a266_0x18ed6c(0x180)),manifest_manger_1=__importDefault(require(a266_0x18ed6c(0x18a))),path_1=__importDefault(require(a266_0x18ed6c(0x190))),promises_1=require('fs/promises'),fs_utils_1=require(a266_0x18ed6c(0x183)),object_sizeof_1=__importDefault(require(a266_0x18ed6c(0x18f))),retrieve_factory_1=__importDefault(require(a266_0x18ed6c(0x165))),auth_manager_1=require(a266_0x18ed6c(0x189)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a266_0x18ed6c(0x170))),jszip_1=__importDefault(require(a266_0x18ed6c(0x15d)));class RetrieveMetadata{constructor(_0x25410f,_0xf2c51,_0x54c19e){const _0x529263=a266_0x18ed6c;this['jobStorePath']=_0x25410f,this[_0x529263(0x16b)]=_0xf2c51,this[_0x529263(0x15f)]=_0x54c19e,this['metadataFolder']=path_1[_0x529263(0x163)][_0x529263(0x17a)](this['jobStorePath'],constants_1[_0x529263(0x158)]),this[_0x529263(0x18c)]=path_1['default']['join'](this[_0x529263(0x177)],constants_1[_0x529263(0x15b)]);}async[a266_0x18ed6c(0x17c)](_0x53393d){const _0x393bc8=a266_0x18ed6c,_0x8dfddb=(0x0,shortid_1[_0x393bc8(0x163)])();return await(0x0,promises_1[_0x393bc8(0x15e)])(path_1[_0x393bc8(0x163)]['join'](this[_0x393bc8(0x191)],_0x8dfddb+_0x393bc8(0x186)),JSON[_0x393bc8(0x169)](_0x53393d)),_0x8dfddb;}async['execute'](){const _0x32497a=a266_0x18ed6c,{credentials:_0x1810ff,declarativeFilter:_0x2c38c4,maxChunkSize:_0x1bac34,maxChunkItems:_0x31fe67,apiVersion:_0x543e39}=await new manifest_manger_1['default'](this[_0x32497a(0x177)])[_0x32497a(0x16c)](),_0x39c130=await salesforce_1['AxiosInstanceUtils'][_0x32497a(0x16d)](new auth_manager_1[(_0x32497a(0x192))](_0x1810ff),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x4d625e=await retrieve_factory_1[_0x32497a(0x163)][_0x32497a(0x16d)](_0x39c130,this[_0x32497a(0x16b)],_0x2c38c4,_0x543e39)[_0x32497a(0x167)]();await(0x0,fs_utils_1[_0x32497a(0x172)])(this[_0x32497a(0x191)]);let _0x5d4e32=[];const _0xa42143=[];let _0x544884=0x0;for(const _0x36a481 in _0x4d625e['items']){for(const {listMetadataItem:_0x585545,files:_0x445390}of _0x4d625e[_0x32497a(0x160)][_0x36a481][_0x32497a(0x17f)]){const _0xddc6dd=new jszip_1[(_0x32497a(0x163))]();for(const _0x41eb0b in _0x445390){await _0xddc6dd[_0x32497a(0x16a)](_0x41eb0b,_0x445390[_0x41eb0b]);}const _0x2957ac=await _0xddc6dd[_0x32497a(0x181)]({'type':_0x32497a(0x173),'compression':_0x32497a(0x174),'compressionOptions':{'level':0x9}}),_0xa6d114={..._0x585545,'zip':_0x2957ac},_0x13ff1d=(0x0,object_sizeof_1['default'])(_0xa6d114);if(_0x13ff1d>_0x1bac34){await this['stateManager'][_0x32497a(0x17b)](_0x32497a(0x16f)+_0x585545[_0x32497a(0x15c)]+_0x32497a(0x18e)+_0x13ff1d+_0x32497a(0x17e)+_0x1bac34+'\x27');continue;}if(_0x544884+_0x13ff1d>_0x1bac34||_0x5d4e32[_0x32497a(0x187)]>=_0x31fe67){const _0x30a65c=await this[_0x32497a(0x17c)](_0x5d4e32);_0xa42143['push'](_0x30a65c),_0x544884=0x0,_0x5d4e32=[];}_0x5d4e32[_0x32497a(0x159)](_0xa6d114),_0x544884+=_0x13ff1d;}}if(_0x5d4e32[_0x32497a(0x187)]){const _0x4b8b7e=await this[_0x32497a(0x17c)](_0x5d4e32);_0xa42143[_0x32497a(0x159)](_0x4b8b7e);}await(0x0,promises_1[_0x32497a(0x15e)])(this[_0x32497a(0x18c)],JSON[_0x32497a(0x169)](_0xa42143));}}exports[a266_0x18ed6c(0x163)]=RetrieveMetadata;