const a272_0x16ce5f=a272_0xdf7d;(function(_0x1e60b7,_0x35fa7d){const _0x431100=a272_0xdf7d,_0x165c94=_0x1e60b7();while(!![]){try{const _0x38817f=-parseInt(_0x431100(0x11b))/0x1+-parseInt(_0x431100(0x10c))/0x2+parseInt(_0x431100(0x121))/0x3+-parseInt(_0x431100(0xff))/0x4+parseInt(_0x431100(0x109))/0x5+-parseInt(_0x431100(0x122))/0x6+parseInt(_0x431100(0x104))/0x7*(parseInt(_0x431100(0x127))/0x8);if(_0x38817f===_0x35fa7d)break;else _0x165c94['push'](_0x165c94['shift']());}catch(_0x1977c0){_0x165c94['push'](_0x165c94['shift']());}}}(a272_0x7c38,0x490eb));const a272_0x2cc8a6=(function(){let _0x572be4=!![];return function(_0x5f5074,_0x1c85f7){const _0xa62ce1=_0x572be4?function(){const _0x4233a9=a272_0xdf7d;if(_0x1c85f7){const _0x1b6f6b=_0x1c85f7[_0x4233a9(0x12f)](_0x5f5074,arguments);return _0x1c85f7=null,_0x1b6f6b;}}:function(){};return _0x572be4=![],_0xa62ce1;};}()),a272_0x389d7c=a272_0x2cc8a6(this,function(){const _0xd4ae37=a272_0xdf7d;return a272_0x389d7c['toString']()['search'](_0xd4ae37(0x116))[_0xd4ae37(0x102)]()[_0xd4ae37(0x10e)](a272_0x389d7c)[_0xd4ae37(0x12b)]('(((.+)+)+)+$');});a272_0x389d7c();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3ced7d){const _0x8455ea=a272_0xdf7d;return _0x3ced7d&&_0x3ced7d[_0x8455ea(0x11e)]?_0x3ced7d:{'default':_0x3ced7d};};function a272_0xdf7d(_0x5cd646,_0x3bdcfb){const _0x201b84=a272_0x7c38();return a272_0xdf7d=function(_0x389d7c,_0x2cc8a6){_0x389d7c=_0x389d7c-0xfb;let _0x7c381c=_0x201b84[_0x389d7c];return _0x7c381c;},a272_0xdf7d(_0x5cd646,_0x3bdcfb);}Object[a272_0x16ce5f(0x110)](exports,'__esModule',{'value':!![]});const salesforce_1=require('@flosum/salesforce'),manifest_manger_1=__importDefault(require(a272_0x16ce5f(0x107))),path_1=__importDefault(require(a272_0x16ce5f(0x10d))),promises_1=require(a272_0x16ce5f(0x12e)),fs_utils_1=require(a272_0x16ce5f(0x11f)),object_sizeof_1=__importDefault(require(a272_0x16ce5f(0x108))),retrieve_factory_1=__importDefault(require(a272_0x16ce5f(0xfd))),auth_manager_1=require(a272_0x16ce5f(0xfb)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a272_0x16ce5f(0x10f))),jszip_1=__importDefault(require(a272_0x16ce5f(0x124)));class RetrieveMetadata{constructor(_0x290011,_0x6dded8,_0x49ddd5){const _0x3e9773=a272_0x16ce5f;this[_0x3e9773(0x101)]=_0x290011,this[_0x3e9773(0x125)]=_0x6dded8,this[_0x3e9773(0x128)]=_0x49ddd5,this[_0x3e9773(0x111)]=path_1[_0x3e9773(0x10a)][_0x3e9773(0x100)](this['jobStorePath'],constants_1[_0x3e9773(0x11c)]),this['retrieveResultsPath']=path_1['default'][_0x3e9773(0x100)](this['jobStorePath'],constants_1[_0x3e9773(0x115)]);}async[a272_0x16ce5f(0x129)](_0x1f3aef){const _0x402c7d=a272_0x16ce5f,_0x5cd3c6=(0x0,shortid_1[_0x402c7d(0x10a)])();return await(0x0,promises_1[_0x402c7d(0xfe)])(path_1[_0x402c7d(0x10a)]['join'](this[_0x402c7d(0x111)],_0x5cd3c6+'.json'),JSON[_0x402c7d(0x112)](_0x1f3aef)),_0x5cd3c6;}async[a272_0x16ce5f(0x113)](){const _0x51645f=a272_0x16ce5f,{credentials:_0x2561e8,declarativeFilter:_0x2fcc41,metadataTypes:_0x26455b,maxChunkSize:_0x49ee75,maxChunkItems:_0x562fc4,apiVersion:_0x412cff}=await new manifest_manger_1[(_0x51645f(0x10a))](this['jobStorePath'])[_0x51645f(0x123)](),_0x43418d=await salesforce_1[_0x51645f(0xfc)][_0x51645f(0x120)](new auth_manager_1[(_0x51645f(0x114))](_0x2561e8),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x38d25e=await retrieve_factory_1[_0x51645f(0x10a)]['create'](_0x43418d,this[_0x51645f(0x125)],_0x2fcc41,_0x26455b,_0x412cff)[_0x51645f(0x113)]();await(0x0,fs_utils_1[_0x51645f(0x105)])(this['metadataFolder']);let _0x3bec20=[];const _0x1c18e1=[];let _0x37e34e=0x0;for(const _0xec4c8 in _0x38d25e[_0x51645f(0x118)]){for(const {listMetadataItem:_0x542351,files:_0x16a972}of _0x38d25e[_0x51645f(0x118)][_0xec4c8][_0x51645f(0x12a)]){const _0x5cdd5f=new jszip_1['default']();for(const _0x4db7de in _0x16a972){await _0x5cdd5f[_0x51645f(0x106)](_0x4db7de,_0x16a972[_0x4db7de]);}const _0x4248a3=await _0x5cdd5f[_0x51645f(0x103)]({'type':'base64','compression':_0x51645f(0x11a),'compressionOptions':{'level':0x9}}),_0x5440fe={..._0x542351,'zip':_0x4248a3},_0x55caab=(0x0,object_sizeof_1[_0x51645f(0x10a)])(_0x5440fe);if(_0x55caab>_0x49ee75){await this[_0x51645f(0x128)][_0x51645f(0x126)]('Item\x20\x27'+_0x542351[_0x51645f(0x12d)]+_0x51645f(0x11d)+_0x55caab+_0x51645f(0x10b)+_0x49ee75+'\x27');continue;}if(_0x37e34e+_0x55caab>_0x49ee75||_0x3bec20[_0x51645f(0x119)]>=_0x562fc4){const _0x29a025=await this[_0x51645f(0x129)](_0x3bec20);_0x1c18e1[_0x51645f(0x12c)](_0x29a025),_0x37e34e=0x0,_0x3bec20=[];}_0x3bec20[_0x51645f(0x12c)](_0x5440fe),_0x37e34e+=_0x55caab;}}if(_0x3bec20[_0x51645f(0x119)]){const _0x468ad8=await this[_0x51645f(0x129)](_0x3bec20);_0x1c18e1[_0x51645f(0x12c)](_0x468ad8);}await(0x0,promises_1[_0x51645f(0xfe)])(this[_0x51645f(0x117)],JSON['stringify'](_0x1c18e1));}}function a272_0x7c38(){const _0x35e4ad=['./retrieve-factory','writeFile','1248448VywxNV','join','jobStorePath','toString','generateAsync','604009YohEUH','makeDir','file','./manifest-manger','object-sizeof','878910IlIZyA','default','\x27\x20exceed\x20limit\x20\x27','493402goEtSA','path','constructor','shortid','defineProperty','metadataFolder','stringify','execute','AuthManager','RETRIEVE_RESULTS_IDS_FILENAME','(((.+)+)+)+$','retrieveResultsPath','items','length','DEFLATE','31865UHgPLe','RETRIEVE_RESULT_FOLDER_NAME','\x27\x20size\x20\x27','__esModule','../../../shared/utils/fs.utils','create','445794SqtrOQ','1783974GRVaFj','init','jszip','logger','addWarning','80hJjbZM','stateManager','writeChunk','components','search','push','fileName','fs/promises','apply','../../../shared/managers/auth.manager','AxiosInstanceUtils'];a272_0x7c38=function(){return _0x35e4ad;};return a272_0x7c38();}exports[a272_0x16ce5f(0x10a)]=RetrieveMetadata;