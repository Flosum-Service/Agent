function a288_0x341e(_0x50a287,_0xaba9fd){const _0x536510=a288_0x35ef();return a288_0x341e=function(_0x2970f6,_0x278b15){_0x2970f6=_0x2970f6-0x93;let _0x35ef8c=_0x536510[_0x2970f6];return _0x35ef8c;},a288_0x341e(_0x50a287,_0xaba9fd);}const a288_0x1c22a4=a288_0x341e;(function(_0x32bcaa,_0x35a767){const _0xc910ef=a288_0x341e,_0x37ef77=_0x32bcaa();while(!![]){try{const _0x1a1280=parseInt(_0xc910ef(0xb8))/0x1+parseInt(_0xc910ef(0x9a))/0x2+-parseInt(_0xc910ef(0x95))/0x3*(parseInt(_0xc910ef(0xad))/0x4)+-parseInt(_0xc910ef(0xb7))/0x5+-parseInt(_0xc910ef(0xa0))/0x6*(-parseInt(_0xc910ef(0xc8))/0x7)+parseInt(_0xc910ef(0xc4))/0x8*(parseInt(_0xc910ef(0xa4))/0x9)+-parseInt(_0xc910ef(0xc7))/0xa;if(_0x1a1280===_0x35a767)break;else _0x37ef77['push'](_0x37ef77['shift']());}catch(_0xab43b){_0x37ef77['push'](_0x37ef77['shift']());}}}(a288_0x35ef,0x524f1));const a288_0x278b15=(function(){let _0x416578=!![];return function(_0xd20570,_0x35cc89){const _0x4495b9=_0x416578?function(){const _0x276d9f=a288_0x341e;if(_0x35cc89){const _0x34e147=_0x35cc89[_0x276d9f(0xbe)](_0xd20570,arguments);return _0x35cc89=null,_0x34e147;}}:function(){};return _0x416578=![],_0x4495b9;};}()),a288_0x2970f6=a288_0x278b15(this,function(){const _0x557ea1=a288_0x341e;return a288_0x2970f6[_0x557ea1(0xb0)]()[_0x557ea1(0xbb)]('(((.+)+)+)+$')['toString']()['constructor'](a288_0x2970f6)[_0x557ea1(0xbb)](_0x557ea1(0xaf));});a288_0x2970f6();'use strict';var __importDefault=this&&this[a288_0x1c22a4(0xbd)]||function(_0x5b90bf){const _0x22d367=a288_0x1c22a4;return _0x5b90bf&&_0x5b90bf[_0x22d367(0xba)]?_0x5b90bf:{'default':_0x5b90bf};};Object[a288_0x1c22a4(0x96)](exports,a288_0x1c22a4(0xba),{'value':!![]});function a288_0x35ef(){const _0x3db124=['generateAsync','components','length','./retrieve-factory','push','224XdmcVk','path','(((.+)+)+)+$','toString','stateManager','AuthManager','\x27\x20exceed\x20limit\x20\x27','DEFLATE','.json','fs/promises','637420cgWrTt','389800lwdKkq','base64','__esModule','search','./manifest-manger','__importDefault','apply','join','jobStorePath','RETRIEVE_RESULT_FOLDER_NAME','writeChunk','retrieveResultsPath','3405208DjfsaB','../../constants','Item\x20\x27','8139460iENhnj','910BlXCLt','fileName','shortid','metadataFolder','6054VnnEEV','defineProperty','execute','../../../shared/managers/auth.manager','makeDir','635888KxenLV','items','@flosum/salesforce','init','jszip','../../../shared/utils/fs.utils','11916IvlzgC','create','\x27\x20size\x20\x27','logger','9MGHMND','default','addWarning','stringify'];a288_0x35ef=function(){return _0x3db124;};return a288_0x35ef();}const salesforce_1=require(a288_0x1c22a4(0x9c)),manifest_manger_1=__importDefault(require(a288_0x1c22a4(0xbc))),path_1=__importDefault(require(a288_0x1c22a4(0xae))),promises_1=require(a288_0x1c22a4(0xb6)),fs_utils_1=require(a288_0x1c22a4(0x9f)),object_sizeof_1=__importDefault(require('object-sizeof')),retrieve_factory_1=__importDefault(require(a288_0x1c22a4(0xab))),auth_manager_1=require(a288_0x1c22a4(0x98)),constants_1=require(a288_0x1c22a4(0xc5)),shortid_1=__importDefault(require(a288_0x1c22a4(0x93))),jszip_1=__importDefault(require(a288_0x1c22a4(0x9e)));class RetrieveMetadata{constructor(_0x46ac4c,_0x467f1c,_0x233f58){const _0x114cb0=a288_0x1c22a4;this[_0x114cb0(0xc0)]=_0x46ac4c,this[_0x114cb0(0xa3)]=_0x467f1c,this[_0x114cb0(0xb1)]=_0x233f58,this[_0x114cb0(0x94)]=path_1['default'][_0x114cb0(0xbf)](this['jobStorePath'],constants_1[_0x114cb0(0xc1)]),this['retrieveResultsPath']=path_1['default']['join'](this[_0x114cb0(0xc0)],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async['writeChunk'](_0x413c42){const _0x4dd92e=a288_0x1c22a4,_0x333824=(0x0,shortid_1[_0x4dd92e(0xa5)])();return await(0x0,promises_1['writeFile'])(path_1[_0x4dd92e(0xa5)]['join'](this[_0x4dd92e(0x94)],_0x333824+_0x4dd92e(0xb5)),JSON[_0x4dd92e(0xa7)](_0x413c42)),_0x333824;}async[a288_0x1c22a4(0x97)](){const _0x42f23c=a288_0x1c22a4,{credentials:_0x4d43f1,declarativeFilter:_0x4e1ebe,metadataTypes:_0x5c7a92,maxChunkSize:_0x528f10,maxChunkItems:_0x458ac0,apiVersion:_0x13f62d}=await new manifest_manger_1['default'](this[_0x42f23c(0xc0)])[_0x42f23c(0x9d)](),_0x4c522a=await salesforce_1['AxiosInstanceUtils'][_0x42f23c(0xa1)](new auth_manager_1[(_0x42f23c(0xb2))](_0x4d43f1),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x1a7192=await retrieve_factory_1[_0x42f23c(0xa5)][_0x42f23c(0xa1)](_0x4c522a,this[_0x42f23c(0xa3)],_0x4e1ebe,_0x5c7a92,_0x13f62d)[_0x42f23c(0x97)]();await(0x0,fs_utils_1[_0x42f23c(0x99)])(this[_0x42f23c(0x94)]);let _0x3406b4=[];const _0x4f230d=[];let _0x2a349f=0x0;for(const _0x3f6394 in _0x1a7192[_0x42f23c(0x9b)]){for(const {listMetadataItem:_0xa202f7,files:_0x20d88f}of _0x1a7192['items'][_0x3f6394][_0x42f23c(0xa9)]){const _0x593490=new jszip_1[(_0x42f23c(0xa5))]();for(const _0x1ce919 in _0x20d88f){await _0x593490['file'](_0x1ce919,_0x20d88f[_0x1ce919]);}const _0x4fc71c=await _0x593490[_0x42f23c(0xa8)]({'type':_0x42f23c(0xb9),'compression':_0x42f23c(0xb4),'compressionOptions':{'level':0x9}}),_0x527ede={..._0xa202f7,'zip':_0x4fc71c},_0x497ce4=(0x0,object_sizeof_1[_0x42f23c(0xa5)])(_0x527ede);if(_0x497ce4>_0x528f10){await this[_0x42f23c(0xb1)][_0x42f23c(0xa6)](_0x42f23c(0xc6)+_0xa202f7[_0x42f23c(0xc9)]+_0x42f23c(0xa2)+_0x497ce4+_0x42f23c(0xb3)+_0x528f10+'\x27');continue;}if(_0x2a349f+_0x497ce4>_0x528f10||_0x3406b4[_0x42f23c(0xaa)]>=_0x458ac0){const _0x48ed08=await this[_0x42f23c(0xc2)](_0x3406b4);_0x4f230d[_0x42f23c(0xac)](_0x48ed08),_0x2a349f=0x0,_0x3406b4=[];}_0x3406b4['push'](_0x527ede),_0x2a349f+=_0x497ce4;}}if(_0x3406b4[_0x42f23c(0xaa)]){const _0x515363=await this['writeChunk'](_0x3406b4);_0x4f230d[_0x42f23c(0xac)](_0x515363);}await(0x0,promises_1['writeFile'])(this[_0x42f23c(0xc3)],JSON['stringify'](_0x4f230d));}}exports[a288_0x1c22a4(0xa5)]=RetrieveMetadata;