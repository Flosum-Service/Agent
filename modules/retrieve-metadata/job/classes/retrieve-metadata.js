const a266_0x158f54=a266_0x454d;(function(_0x5a24b7,_0x173b85){const _0x3f2313=a266_0x454d,_0x266e1d=_0x5a24b7();while(!![]){try{const _0x255484=-parseInt(_0x3f2313(0x15b))/0x1*(-parseInt(_0x3f2313(0x164))/0x2)+parseInt(_0x3f2313(0x182))/0x3+-parseInt(_0x3f2313(0x179))/0x4*(parseInt(_0x3f2313(0x171))/0x5)+parseInt(_0x3f2313(0x163))/0x6*(parseInt(_0x3f2313(0x16e))/0x7)+parseInt(_0x3f2313(0x16a))/0x8*(-parseInt(_0x3f2313(0x189))/0x9)+-parseInt(_0x3f2313(0x16d))/0xa+-parseInt(_0x3f2313(0x186))/0xb;if(_0x255484===_0x173b85)break;else _0x266e1d['push'](_0x266e1d['shift']());}catch(_0xd1cf16){_0x266e1d['push'](_0x266e1d['shift']());}}}(a266_0x46b5,0xaf4d4));const a266_0x35b7c6=(function(){let _0x421e0a=!![];return function(_0x5bedad,_0x130913){const _0x5bdc4f=_0x421e0a?function(){const _0x6aa81a=a266_0x454d;if(_0x130913){const _0x461ccf=_0x130913[_0x6aa81a(0x17d)](_0x5bedad,arguments);return _0x130913=null,_0x461ccf;}}:function(){};return _0x421e0a=![],_0x5bdc4f;};}()),a266_0xd5fe0c=a266_0x35b7c6(this,function(){const _0x3609ab=a266_0x454d;return a266_0xd5fe0c[_0x3609ab(0x17a)]()[_0x3609ab(0x166)](_0x3609ab(0x187))['toString']()[_0x3609ab(0x183)](a266_0xd5fe0c)[_0x3609ab(0x166)](_0x3609ab(0x187));});a266_0xd5fe0c();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1ea9c1){const _0x1596e7=a266_0x454d;return _0x1ea9c1&&_0x1ea9c1[_0x1596e7(0x16c)]?_0x1ea9c1:{'default':_0x1ea9c1};};Object[a266_0x158f54(0x167)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a266_0x158f54(0x160)),manifest_manger_1=__importDefault(require('./manifest-manger')),path_1=__importDefault(require(a266_0x158f54(0x168))),promises_1=require(a266_0x158f54(0x184)),fs_utils_1=require(a266_0x158f54(0x173)),object_sizeof_1=__importDefault(require(a266_0x158f54(0x162))),retrieve_factory_1=__importDefault(require(a266_0x158f54(0x17b))),auth_manager_1=require(a266_0x158f54(0x17c)),constants_1=require('../../constants'),shortid_1=__importDefault(require(a266_0x158f54(0x18c))),jszip_1=__importDefault(require(a266_0x158f54(0x170)));class RetrieveMetadata{constructor(_0x4cc3bf,_0x5fcbda){const _0x5809db=a266_0x158f54;this[_0x5809db(0x188)]=_0x4cc3bf,this['logger']=_0x5fcbda,this[_0x5809db(0x175)]=path_1[_0x5809db(0x174)][_0x5809db(0x17e)](this[_0x5809db(0x188)],constants_1[_0x5809db(0x15c)]),this[_0x5809db(0x178)]=path_1[_0x5809db(0x174)][_0x5809db(0x17e)](this['jobStorePath'],constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);}async[a266_0x158f54(0x16b)](_0x51d634){const _0x5aad39=a266_0x158f54,_0x4b373c=(0x0,shortid_1[_0x5aad39(0x174)])();return await(0x0,promises_1[_0x5aad39(0x180)])(path_1[_0x5aad39(0x174)][_0x5aad39(0x17e)](this['metadataFolder'],_0x4b373c+'.json'),JSON[_0x5aad39(0x17f)](_0x51d634)),_0x4b373c;}async[a266_0x158f54(0x165)](){const _0x59ca4e=a266_0x158f54,{credentials:_0x51a13e,declarativeFilter:_0x384758,maxChunkSize:_0x27792b,maxChunkItems:_0x262bb9}=await new manifest_manger_1[(_0x59ca4e(0x174))](this[_0x59ca4e(0x188)])[_0x59ca4e(0x18a)](),_0x4058a0=await salesforce_1[_0x59ca4e(0x181)][_0x59ca4e(0x176)](new auth_manager_1[(_0x59ca4e(0x177))](_0x51a13e),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x1a0e18=await retrieve_factory_1[_0x59ca4e(0x174)][_0x59ca4e(0x176)](_0x4058a0,this[_0x59ca4e(0x18b)],_0x384758)[_0x59ca4e(0x165)]();await(0x0,fs_utils_1[_0x59ca4e(0x161)])(this['metadataFolder']);let _0x19fd3f=[];const _0x44eee7=[];let _0x327d87=0x0;for(const _0x5d69db in _0x1a0e18[_0x59ca4e(0x169)]){for(const {listMetadataItem:_0x5e6dc9,files:_0x3fa2e5}of _0x1a0e18[_0x59ca4e(0x169)][_0x5d69db]['components']){const _0x4aef86=new jszip_1[(_0x59ca4e(0x174))]();for(const _0x1b1e47 in _0x3fa2e5){await _0x4aef86[_0x59ca4e(0x15e)](_0x1b1e47,_0x3fa2e5[_0x1b1e47]);}const _0xa3b8f3=await _0x4aef86[_0x59ca4e(0x172)]({'type':_0x59ca4e(0x16f),'compression':_0x59ca4e(0x15d),'compressionOptions':{'level':0x9}}),_0x2bd33c={..._0x5e6dc9,'zip':_0xa3b8f3},_0x49bcfa=(0x0,object_sizeof_1[_0x59ca4e(0x174)])(_0x2bd33c);if(_0x49bcfa>_0x27792b)throw Error('Item\x20size\x20\x27'+_0x49bcfa+_0x59ca4e(0x18d)+_0x27792b+'\x27');if(_0x327d87+_0x49bcfa>_0x27792b||_0x19fd3f[_0x59ca4e(0x185)]>=_0x262bb9){const _0x2ded35=await this[_0x59ca4e(0x16b)](_0x19fd3f);_0x44eee7[_0x59ca4e(0x15f)](_0x2ded35),_0x327d87=0x0,_0x19fd3f=[];}_0x19fd3f['push'](_0x2bd33c),_0x327d87+=_0x49bcfa;}}if(_0x19fd3f[_0x59ca4e(0x185)]){const _0x241aaf=await this[_0x59ca4e(0x16b)](_0x19fd3f);_0x44eee7[_0x59ca4e(0x15f)](_0x241aaf);}await(0x0,promises_1[_0x59ca4e(0x180)])(this[_0x59ca4e(0x178)],JSON[_0x59ca4e(0x17f)](_0x44eee7));}}function a266_0x454d(_0x579e87,_0x221dad){const _0x2e061d=a266_0x46b5();return a266_0x454d=function(_0xd5fe0c,_0x35b7c6){_0xd5fe0c=_0xd5fe0c-0x15b;let _0x46b5d5=_0x2e061d[_0xd5fe0c];return _0x46b5d5;},a266_0x454d(_0x579e87,_0x221dad);}exports[a266_0x158f54(0x174)]=RetrieveMetadata;function a266_0x46b5(){const _0x371862=['211724zLepjK','toString','./retrieve-factory','../../../shared/managers/auth.manager','apply','join','stringify','writeFile','AxiosInstanceUtils','2913723ipjEfp','constructor','fs/promises','length','5270529VhdemG','(((.+)+)+)+$','jobStorePath','833463wmpFNJ','init','logger','shortid','\x27\x20exceed\x20max\x20chunk\x20size\x20\x27','1KPSDlI','RETRIEVE_RESULT_FOLDER_NAME','DEFLATE','file','push','@flosum/salesforce','makeDir','object-sizeof','4169922lsmUIf','598722EgnhqL','execute','search','defineProperty','path','items','40OntmiJ','writeChunk','__esModule','2524480GRNTte','7nDElal','base64','jszip','5iahWkn','generateAsync','../../../shared/utils/fs.utils','default','metadataFolder','create','AuthManager','retrieveResultsPath'];a266_0x46b5=function(){return _0x371862;};return a266_0x46b5();}