const a272_0x4674fc=a272_0x5e89;(function(_0x3d0388,_0x494019){const _0x5c613f=a272_0x5e89,_0x5043cf=_0x3d0388();while(!![]){try{const _0x1586aa=-parseInt(_0x5c613f(0xfb))/0x1*(parseInt(_0x5c613f(0xe3))/0x2)+parseInt(_0x5c613f(0xe6))/0x3*(parseInt(_0x5c613f(0xf2))/0x4)+parseInt(_0x5c613f(0xdd))/0x5*(-parseInt(_0x5c613f(0xf9))/0x6)+parseInt(_0x5c613f(0xf1))/0x7*(parseInt(_0x5c613f(0xe0))/0x8)+parseInt(_0x5c613f(0xe9))/0x9*(-parseInt(_0x5c613f(0xd7))/0xa)+parseInt(_0x5c613f(0xda))/0xb+parseInt(_0x5c613f(0xfa))/0xc;if(_0x1586aa===_0x494019)break;else _0x5043cf['push'](_0x5043cf['shift']());}catch(_0x26445e){_0x5043cf['push'](_0x5043cf['shift']());}}}(a272_0x254f,0xa073a));const a272_0x18c57c=(function(){let _0x2f1c21=!![];return function(_0x4ffcee,_0x50e24d){const _0x3ea895=_0x2f1c21?function(){if(_0x50e24d){const _0x4d49f8=_0x50e24d['apply'](_0x4ffcee,arguments);return _0x50e24d=null,_0x4d49f8;}}:function(){};return _0x2f1c21=![],_0x3ea895;};}()),a272_0x2eaeda=a272_0x18c57c(this,function(){const _0x29eaf3=a272_0x5e89;return a272_0x2eaeda['toString']()['search'](_0x29eaf3(0xd1))['toString']()[_0x29eaf3(0xd3)](a272_0x2eaeda)[_0x29eaf3(0xe2)]('(((.+)+)+)+$');});function a272_0x254f(){const _0xa27e9e=['../../../shared/utils/fs.utils','items','(((.+)+)+)+$','file','constructor','AuthManager','./manifest-manger','stateManager','108890tbIHAP','metadataFolder','join','2155395FMMvkR','defineProperty','\x27\x20exceed\x20limit\x20\x27','10GxUGaA','writeChunk','../../../shared/managers/auth.manager','8312jLRmiY','jszip','search','6aOJpsM','@flosum/salesforce','length','15HhPoLX','jobStorePath','default','180eLnMJF','generateAsync','push','stringify','DEFLATE','./retrieve-factory','execute','\x27\x20size\x20\x27','2149XSuyWn','460780bUeGgv','create','init','base64','RETRIEVE_RESULTS_IDS_FILENAME','fs/promises','__esModule','2781930gGoYPH','13054380aLaHNw','125486nDXuEY','../../constants','writeFile','addWarning','makeDir','Item\x20\x27','.json','path','object-sizeof','logger','retrieveResultsPath','AxiosInstanceUtils'];a272_0x254f=function(){return _0xa27e9e;};return a272_0x254f();}a272_0x2eaeda();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1c6246){const _0xd260fe=a272_0x5e89;return _0x1c6246&&_0x1c6246[_0xd260fe(0xf8)]?_0x1c6246:{'default':_0x1c6246};};Object[a272_0x4674fc(0xdb)](exports,'__esModule',{'value':!![]});const salesforce_1=require(a272_0x4674fc(0xe4)),manifest_manger_1=__importDefault(require(a272_0x4674fc(0xd5))),path_1=__importDefault(require(a272_0x4674fc(0x102))),promises_1=require(a272_0x4674fc(0xf7)),fs_utils_1=require(a272_0x4674fc(0x107)),object_sizeof_1=__importDefault(require(a272_0x4674fc(0x103))),retrieve_factory_1=__importDefault(require(a272_0x4674fc(0xee))),auth_manager_1=require(a272_0x4674fc(0xdf)),constants_1=require(a272_0x4674fc(0xfc)),shortid_1=__importDefault(require('shortid')),jszip_1=__importDefault(require(a272_0x4674fc(0xe1)));function a272_0x5e89(_0x33caca,_0x1b44ac){const _0x4e3661=a272_0x254f();return a272_0x5e89=function(_0x2eaeda,_0x18c57c){_0x2eaeda=_0x2eaeda-0xd1;let _0x254f09=_0x4e3661[_0x2eaeda];return _0x254f09;},a272_0x5e89(_0x33caca,_0x1b44ac);}class RetrieveMetadata{constructor(_0x507f36,_0x4b8da4,_0x5dbcf2){const _0xb4e193=a272_0x4674fc;this[_0xb4e193(0xe7)]=_0x507f36,this[_0xb4e193(0x104)]=_0x4b8da4,this[_0xb4e193(0xd6)]=_0x5dbcf2,this['metadataFolder']=path_1[_0xb4e193(0xe8)][_0xb4e193(0xd9)](this[_0xb4e193(0xe7)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this[_0xb4e193(0x105)]=path_1[_0xb4e193(0xe8)]['join'](this[_0xb4e193(0xe7)],constants_1[_0xb4e193(0xf6)]);}async[a272_0x4674fc(0xde)](_0x1203cd){const _0x26eb77=a272_0x4674fc,_0x1807e0=(0x0,shortid_1['default'])();return await(0x0,promises_1['writeFile'])(path_1[_0x26eb77(0xe8)][_0x26eb77(0xd9)](this[_0x26eb77(0xd8)],_0x1807e0+_0x26eb77(0x101)),JSON[_0x26eb77(0xec)](_0x1203cd)),_0x1807e0;}async[a272_0x4674fc(0xef)](){const _0x23d8fd=a272_0x4674fc,{credentials:_0x432bee,declarativeFilter:_0x2a4742,metadataTypes:_0xfbcda0,maxChunkSize:_0xe5c3b6,maxChunkItems:_0x70a78b,apiVersion:_0x1c11f8}=await new manifest_manger_1[(_0x23d8fd(0xe8))](this[_0x23d8fd(0xe7)])[_0x23d8fd(0xf4)](),_0x2dc0f5=await salesforce_1[_0x23d8fd(0x106)]['create'](new auth_manager_1[(_0x23d8fd(0xd4))](_0x432bee),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0xff82bd=await retrieve_factory_1[_0x23d8fd(0xe8)][_0x23d8fd(0xf3)](_0x2dc0f5,this[_0x23d8fd(0x104)],_0x2a4742,_0xfbcda0,_0x1c11f8)['execute']();await(0x0,fs_utils_1[_0x23d8fd(0xff)])(this['metadataFolder']);let _0x3c23aa=[];const _0x3e6961=[];let _0x261d20=0x0;for(const _0x282001 in _0xff82bd[_0x23d8fd(0x108)]){for(const {listMetadataItem:_0x102a69,files:_0x415a79}of _0xff82bd[_0x23d8fd(0x108)][_0x282001]['components']){const _0x25062b=new jszip_1['default']();for(const _0x2de63e in _0x415a79){await _0x25062b[_0x23d8fd(0xd2)](_0x2de63e,_0x415a79[_0x2de63e]);}const _0x4c0417=await _0x25062b[_0x23d8fd(0xea)]({'type':_0x23d8fd(0xf5),'compression':_0x23d8fd(0xed),'compressionOptions':{'level':0x9}}),_0x534a8a={..._0x102a69,'zip':_0x4c0417},_0x3d5712=(0x0,object_sizeof_1[_0x23d8fd(0xe8)])(_0x534a8a);if(_0x3d5712>_0xe5c3b6){await this[_0x23d8fd(0xd6)][_0x23d8fd(0xfe)](_0x23d8fd(0x100)+_0x102a69['fileName']+_0x23d8fd(0xf0)+_0x3d5712+_0x23d8fd(0xdc)+_0xe5c3b6+'\x27');continue;}if(_0x261d20+_0x3d5712>_0xe5c3b6||_0x3c23aa[_0x23d8fd(0xe5)]>=_0x70a78b){const _0x3de2c9=await this[_0x23d8fd(0xde)](_0x3c23aa);_0x3e6961[_0x23d8fd(0xeb)](_0x3de2c9),_0x261d20=0x0,_0x3c23aa=[];}_0x3c23aa[_0x23d8fd(0xeb)](_0x534a8a),_0x261d20+=_0x3d5712;}}if(_0x3c23aa[_0x23d8fd(0xe5)]){const _0x5602ad=await this[_0x23d8fd(0xde)](_0x3c23aa);_0x3e6961['push'](_0x5602ad);}await(0x0,promises_1[_0x23d8fd(0xfd)])(this[_0x23d8fd(0x105)],JSON['stringify'](_0x3e6961));}}exports[a272_0x4674fc(0xe8)]=RetrieveMetadata;