const a267_0x4dbd7b=a267_0x19b1;(function(_0x2e1ed3,_0x4ab819){const _0x12f71b=a267_0x19b1,_0x5b5d66=_0x2e1ed3();while(!![]){try{const _0x5a2140=-parseInt(_0x12f71b(0x13b))/0x1+-parseInt(_0x12f71b(0x125))/0x2*(-parseInt(_0x12f71b(0x12e))/0x3)+parseInt(_0x12f71b(0x12c))/0x4*(-parseInt(_0x12f71b(0x145))/0x5)+-parseInt(_0x12f71b(0x11a))/0x6+-parseInt(_0x12f71b(0x126))/0x7*(-parseInt(_0x12f71b(0x112))/0x8)+-parseInt(_0x12f71b(0x11d))/0x9+parseInt(_0x12f71b(0x140))/0xa*(parseInt(_0x12f71b(0x121))/0xb);if(_0x5a2140===_0x4ab819)break;else _0x5b5d66['push'](_0x5b5d66['shift']());}catch(_0x12ab70){_0x5b5d66['push'](_0x5b5d66['shift']());}}}(a267_0x2cbc,0xd7ef7));function a267_0x19b1(_0x421b14,_0x5d9022){const _0x2fa622=a267_0x2cbc();return a267_0x19b1=function(_0x303a59,_0x16cca2){_0x303a59=_0x303a59-0x10f;let _0x2cbcb4=_0x2fa622[_0x303a59];return _0x2cbcb4;},a267_0x19b1(_0x421b14,_0x5d9022);}const a267_0x16cca2=(function(){let _0x1735ef=!![];return function(_0x28fd12,_0x6abf88){const _0x18017d=_0x1735ef?function(){const _0x153abe=a267_0x19b1;if(_0x6abf88){const _0x2135cf=_0x6abf88[_0x153abe(0x119)](_0x28fd12,arguments);return _0x6abf88=null,_0x2135cf;}}:function(){};return _0x1735ef=![],_0x18017d;};}()),a267_0x303a59=a267_0x16cca2(this,function(){const _0xeff59=a267_0x19b1;return a267_0x303a59[_0xeff59(0x123)]()[_0xeff59(0x110)]('(((.+)+)+)+$')[_0xeff59(0x123)]()[_0xeff59(0x136)](a267_0x303a59)[_0xeff59(0x110)]('(((.+)+)+)+$');});a267_0x303a59();'use strict';var __importDefault=this&&this[a267_0x4dbd7b(0x137)]||function(_0x42dc5c){const _0x5c7609=a267_0x4dbd7b;return _0x42dc5c&&_0x42dc5c[_0x5c7609(0x128)]?_0x42dc5c:{'default':_0x42dc5c};};function a267_0x2cbc(){const _0x6eb3ad=['generateAsync','toString','\x27\x20size\x20\x27','4102BbcrWv','6015275gHSInX','makeDir','__esModule','fileName','retrieveResultsPath','./manifest-manger','1780424AorIBi','path','372xEkEjj','DEFLATE','push','addWarning','length','join','metadataFolder','RETRIEVE_RESULTS_IDS_FILENAME','constructor','__importDefault','stringify','defineProperty','stateManager','193672uOjbqY','jobStorePath','.json','AxiosInstanceUtils','../../../shared/utils/fs.utils','5990weetHV','writeFile','Item\x20\x27','object-sizeof','init','5YuKGmj','default','search','components','16IPwkCb','AuthManager','@flosum/salesforce','logger','\x27\x20exceed\x20limit\x20\x27','shortid','fs/promises','apply','122244nmNuqd','create','writeChunk','12268728bQdRtw','file','items','execute','17149sLiQHJ'];a267_0x2cbc=function(){return _0x6eb3ad;};return a267_0x2cbc();}Object[a267_0x4dbd7b(0x139)](exports,a267_0x4dbd7b(0x128),{'value':!![]});const salesforce_1=require(a267_0x4dbd7b(0x114)),manifest_manger_1=__importDefault(require(a267_0x4dbd7b(0x12b))),path_1=__importDefault(require(a267_0x4dbd7b(0x12d))),promises_1=require(a267_0x4dbd7b(0x118)),fs_utils_1=require(a267_0x4dbd7b(0x13f)),object_sizeof_1=__importDefault(require(a267_0x4dbd7b(0x143))),retrieve_factory_1=__importDefault(require('./retrieve-factory')),auth_manager_1=require('../../../shared/managers/auth.manager'),constants_1=require('../../constants'),shortid_1=__importDefault(require(a267_0x4dbd7b(0x117))),jszip_1=__importDefault(require('jszip'));class RetrieveMetadata{constructor(_0x305ba1,_0x2a65f6,_0x3a5c7f){const _0x2a1506=a267_0x4dbd7b;this[_0x2a1506(0x13c)]=_0x305ba1,this[_0x2a1506(0x115)]=_0x2a65f6,this[_0x2a1506(0x13a)]=_0x3a5c7f,this[_0x2a1506(0x134)]=path_1[_0x2a1506(0x10f)][_0x2a1506(0x133)](this[_0x2a1506(0x13c)],constants_1['RETRIEVE_RESULT_FOLDER_NAME']),this['retrieveResultsPath']=path_1['default'][_0x2a1506(0x133)](this[_0x2a1506(0x13c)],constants_1[_0x2a1506(0x135)]);}async[a267_0x4dbd7b(0x11c)](_0x5cb793){const _0x5add90=a267_0x4dbd7b,_0x1c72e2=(0x0,shortid_1[_0x5add90(0x10f)])();return await(0x0,promises_1[_0x5add90(0x141)])(path_1['default'][_0x5add90(0x133)](this['metadataFolder'],_0x1c72e2+_0x5add90(0x13d)),JSON['stringify'](_0x5cb793)),_0x1c72e2;}async['execute'](){const _0x180e90=a267_0x4dbd7b,{credentials:_0x1e90a4,declarativeFilter:_0x3b367d,maxChunkSize:_0x2f7f34,maxChunkItems:_0x289073,apiVersion:_0x17c14c}=await new manifest_manger_1[(_0x180e90(0x10f))](this[_0x180e90(0x13c)])[_0x180e90(0x144)](),_0x927ad=await salesforce_1[_0x180e90(0x13e)][_0x180e90(0x11b)](new auth_manager_1[(_0x180e90(0x113))](_0x1e90a4),[],{'maxContentLength':Infinity,'maxBodyLength':Infinity}),_0x16bc82=await retrieve_factory_1[_0x180e90(0x10f)][_0x180e90(0x11b)](_0x927ad,this[_0x180e90(0x115)],_0x3b367d,_0x17c14c)[_0x180e90(0x120)]();await(0x0,fs_utils_1[_0x180e90(0x127)])(this['metadataFolder']);let _0x1c7212=[];const _0x3c7e03=[];let _0x3792f9=0x0;for(const _0x4973c5 in _0x16bc82['items']){for(const {listMetadataItem:_0x214e78,files:_0x3f77ab}of _0x16bc82[_0x180e90(0x11f)][_0x4973c5][_0x180e90(0x111)]){const _0x36309c=new jszip_1[(_0x180e90(0x10f))]();for(const _0x26e034 in _0x3f77ab){await _0x36309c[_0x180e90(0x11e)](_0x26e034,_0x3f77ab[_0x26e034]);}const _0x2b280d=await _0x36309c[_0x180e90(0x122)]({'type':'base64','compression':_0x180e90(0x12f),'compressionOptions':{'level':0x9}}),_0x2e1d8a={..._0x214e78,'zip':_0x2b280d},_0x565000=(0x0,object_sizeof_1['default'])(_0x2e1d8a);if(_0x565000>_0x2f7f34){await this[_0x180e90(0x13a)][_0x180e90(0x131)](_0x180e90(0x142)+_0x214e78[_0x180e90(0x129)]+_0x180e90(0x124)+_0x565000+_0x180e90(0x116)+_0x2f7f34+'\x27');continue;}if(_0x3792f9+_0x565000>_0x2f7f34||_0x1c7212['length']>=_0x289073){const _0x5747e6=await this[_0x180e90(0x11c)](_0x1c7212);_0x3c7e03[_0x180e90(0x130)](_0x5747e6),_0x3792f9=0x0,_0x1c7212=[];}_0x1c7212[_0x180e90(0x130)](_0x2e1d8a),_0x3792f9+=_0x565000;}}if(_0x1c7212[_0x180e90(0x132)]){const _0x342e72=await this[_0x180e90(0x11c)](_0x1c7212);_0x3c7e03[_0x180e90(0x130)](_0x342e72);}await(0x0,promises_1[_0x180e90(0x141)])(this[_0x180e90(0x12a)],JSON[_0x180e90(0x138)](_0x3c7e03));}}exports[a267_0x4dbd7b(0x10f)]=RetrieveMetadata;