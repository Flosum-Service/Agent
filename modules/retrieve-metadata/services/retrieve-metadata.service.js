function a274_0x1fc2(_0x4c5a6b,_0x44d85f){const _0x2838c7=a274_0x4975();return a274_0x1fc2=function(_0x570cec,_0x5be9f3){_0x570cec=_0x570cec-0x91;let _0x497522=_0x2838c7[_0x570cec];return _0x497522;},a274_0x1fc2(_0x4c5a6b,_0x44d85f);}const a274_0x2954d7=a274_0x1fc2;(function(_0x8fb242,_0x168595){const _0x557355=a274_0x1fc2,_0x54e5d9=_0x8fb242();while(!![]){try{const _0x403c36=-parseInt(_0x557355(0x9a))/0x1*(-parseInt(_0x557355(0x98))/0x2)+parseInt(_0x557355(0xb0))/0x3*(parseInt(_0x557355(0x95))/0x4)+-parseInt(_0x557355(0xb7))/0x5+parseInt(_0x557355(0xc7))/0x6+parseInt(_0x557355(0xbd))/0x7+parseInt(_0x557355(0xba))/0x8+parseInt(_0x557355(0xc4))/0x9*(-parseInt(_0x557355(0xc8))/0xa);if(_0x403c36===_0x168595)break;else _0x54e5d9['push'](_0x54e5d9['shift']());}catch(_0x1b363e){_0x54e5d9['push'](_0x54e5d9['shift']());}}}(a274_0x4975,0x2caf4));const a274_0x5be9f3=(function(){let _0x29c210=!![];return function(_0x2baf92,_0x347b04){const _0x2a42ef=_0x29c210?function(){const _0x1d3ca9=a274_0x1fc2;if(_0x347b04){const _0x534d56=_0x347b04[_0x1d3ca9(0xc2)](_0x2baf92,arguments);return _0x347b04=null,_0x534d56;}}:function(){};return _0x29c210=![],_0x2a42ef;};}()),a274_0x570cec=a274_0x5be9f3(this,function(){const _0xf8251a=a274_0x1fc2;return a274_0x570cec[_0xf8251a(0xbe)]()['search']('(((.+)+)+)+$')[_0xf8251a(0xbe)]()[_0xf8251a(0xc6)](a274_0x570cec)['search'](_0xf8251a(0xb8));});a274_0x570cec();function a274_0x4975(){const _0x1cf194=['runJob','default','864090IGpbKY','(((.+)+)+)+$','JOB_PATH','982264VaxBRT','getJobsIds','NotFoundError','2513455alVcFG','toString','getJobState','getResultChunk','../constants','apply','isExistsPath','9zEnhia','JOB_LOG_DETAILS_FILENAME','constructor','2004792vDRajJ','6625070NDEueu','../job/classes/manifest-manger','.json','../../../constants/job','__esModule','Job\x20log\x20not\x20found.','readFile','create','4AgQDlG','BadRequestError','getJobLogs','244wqdlpR','parse','294PMgTYA','Chunk\x20not\x20found.','data','catch','FsUtils','getJobStatus','makeDir','../../../configs/path','../../shared/utils/fs.utils','@flosum/utils','IN_PROGRESS','init','../../shared/utils/csv.utils','then','JobStatus','Job\x20not\x20completed.','retrieveMetadataFolder','dataPath','generateJobId','fs/promises','setError','utf-8','499515lkJjQt','../../../core/errors/not-found.error','join','RETRIEVE_METADATA_FOLDER_NAME','defineProperty'];a274_0x4975=function(){return _0x1cf194;};return a274_0x4975();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x390785){const _0x2f034f=a274_0x1fc2;return _0x390785&&_0x390785[_0x2f034f(0x91)]?_0x390785:{'default':_0x390785};};Object[a274_0x2954d7(0xb4)](exports,'__esModule',{'value':!![]});const job_utils_1=__importDefault(require('../../shared/utils/job.utils')),path_1=__importDefault(require('path')),manifest_manger_1=__importDefault(require(a274_0x2954d7(0xc9))),state_manger_1=__importDefault(require('../job/classes/state-manger')),promises_1=require(a274_0x2954d7(0xad)),utils_1=require(a274_0x2954d7(0xa3)),csv_utils_1=__importDefault(require(a274_0x2954d7(0xa6))),not_found_error_1=require(a274_0x2954d7(0xb1)),logger_enums_1=require('../job/enums/logger.enums'),bad_request_error_1=require('../../../core/errors/bad-request.error'),job_1=require(a274_0x2954d7(0xcb)),fs_utils_1=require(a274_0x2954d7(0xa2)),constants_1=require(a274_0x2954d7(0xc1)),path_2=require(a274_0x2954d7(0xa1));class RetrieveMetadataService{static async['getJobs'](_0x4397c2,_0x3aa7f1){const _0x4dde8a=a274_0x2954d7,_0x4a06f1=await job_utils_1[_0x4dde8a(0xb6)][_0x4dde8a(0xbb)](RetrieveMetadataService[_0x4dde8a(0xaa)]),_0x3fba51=await job_utils_1['default']['sortJobsIds'](RetrieveMetadataService[_0x4dde8a(0xaa)],_0x4a06f1),_0x51f0d3=_0x3fba51['slice'](_0x3aa7f1,_0x3aa7f1+_0x4397c2),_0x21d163=[];for(const _0x35ea59 of _0x51f0d3){const _0x2aeba5=await state_manger_1[_0x4dde8a(0xb6)][_0x4dde8a(0xbf)](path_1[_0x4dde8a(0xb6)][_0x4dde8a(0xb2)](RetrieveMetadataService[_0x4dde8a(0xaa)],_0x35ea59));_0x21d163['push'](_0x2aeba5);}return _0x21d163;}static async['createRetrieveJob'](_0x1e9b36){const _0x533e7e=a274_0x2954d7,_0x3e54b1=job_utils_1[_0x533e7e(0xb6)][_0x533e7e(0xac)](),_0x20ff1a=path_1[_0x533e7e(0xb6)][_0x533e7e(0xb2)](RetrieveMetadataService[_0x533e7e(0xaa)],_0x3e54b1);await(0x0,fs_utils_1[_0x533e7e(0xa0)])(_0x20ff1a),await manifest_manger_1['default'][_0x533e7e(0x94)](_0x20ff1a,_0x1e9b36),await state_manger_1['default'][_0x533e7e(0x94)](_0x20ff1a,_0x3e54b1);const _0x32b2d4=path_1[_0x533e7e(0xb6)][_0x533e7e(0xb2)](__dirname,job_1[_0x533e7e(0xb9)]);return job_utils_1[_0x533e7e(0xb6)][_0x533e7e(0xb5)](_0x32b2d4,{'jobStorePath':_0x20ff1a,'jobId':_0x3e54b1})[_0x533e7e(0x9d)](async _0x1c5463=>{const _0x3f346b=_0x533e7e,_0x59aecc=new state_manger_1[(_0x3f346b(0xb6))](_0x20ff1a);await _0x59aecc[_0x3f346b(0xa5)](),await _0x59aecc[_0x3f346b(0xae)](_0x1c5463);}),{'jobId':_0x3e54b1};}static async['getResult'](_0x199e3a){const _0x454c95=a274_0x2954d7,{status:_0x55edce}=await RetrieveMetadataService[_0x454c95(0x9f)](_0x199e3a);if(_0x55edce===logger_enums_1[_0x454c95(0xa8)][_0x454c95(0xa4)])throw new bad_request_error_1[(_0x454c95(0x96))](_0x454c95(0xa9));const _0x32901d=path_1[_0x454c95(0xb6)][_0x454c95(0xb2)](RetrieveMetadataService[_0x454c95(0xaa)],_0x199e3a,constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);if(await utils_1[_0x454c95(0x9e)][_0x454c95(0xc3)](_0x32901d))return(0x0,promises_1[_0x454c95(0x93)])(_0x32901d,'utf-8')['then'](JSON[_0x454c95(0x99)]);else throw new not_found_error_1[(_0x454c95(0xbc))]('Result\x20not\x20found.');}static async[a274_0x2954d7(0xc0)](_0x13b921,_0x2052a1){const _0x23f7c5=a274_0x2954d7,{status:_0x1f1c36}=await RetrieveMetadataService['getJobStatus'](_0x13b921);if(_0x1f1c36===logger_enums_1[_0x23f7c5(0xa8)][_0x23f7c5(0xa4)])throw new bad_request_error_1[(_0x23f7c5(0x96))](_0x23f7c5(0xa9));const _0x4e7e42=path_1[_0x23f7c5(0xb6)]['join'](RetrieveMetadataService[_0x23f7c5(0xaa)],_0x13b921,constants_1['RETRIEVE_RESULT_FOLDER_NAME']),_0x330a1b={'data':[]};if(await utils_1['FsUtils'][_0x23f7c5(0xc3)](path_1[_0x23f7c5(0xb6)][_0x23f7c5(0xb2)](_0x4e7e42,_0x2052a1+_0x23f7c5(0xca))))_0x330a1b[_0x23f7c5(0x9c)]=await(0x0,promises_1['readFile'])(path_1[_0x23f7c5(0xb6)][_0x23f7c5(0xb2)](_0x4e7e42,_0x2052a1+_0x23f7c5(0xca)),_0x23f7c5(0xaf))[_0x23f7c5(0xa7)](JSON['parse']);else throw new not_found_error_1['NotFoundError'](_0x23f7c5(0x9b));return _0x330a1b;}static async[a274_0x2954d7(0x9f)](_0x42d56b){const _0x262200=a274_0x2954d7;try{return await state_manger_1[_0x262200(0xb6)]['getJobState'](path_1[_0x262200(0xb6)]['join'](RetrieveMetadataService['retrieveMetadataFolder'],_0x42d56b));}catch(_0x527313){throw new not_found_error_1[(_0x262200(0xbc))](_0x527313);}}static async[a274_0x2954d7(0x97)](_0x186f2c){const _0x5759a0=a274_0x2954d7,_0x5a9f4e=path_1[_0x5759a0(0xb6)][_0x5759a0(0xb2)](RetrieveMetadataService[_0x5759a0(0xaa)],_0x186f2c,job_1[_0x5759a0(0xc5)]);if(await utils_1[_0x5759a0(0x9e)][_0x5759a0(0xc3)](_0x5a9f4e))return(0x0,promises_1[_0x5759a0(0x93)])(_0x5a9f4e,_0x5759a0(0xaf))[_0x5759a0(0xa7)](_0x250bbc=>csv_utils_1[_0x5759a0(0xb6)][_0x5759a0(0x99)](_0x250bbc,{'columns':!![]}));throw new not_found_error_1[(_0x5759a0(0xbc))](_0x5759a0(0x92));}}exports[a274_0x2954d7(0xb6)]=RetrieveMetadataService,RetrieveMetadataService[a274_0x2954d7(0xaa)]=path_1[a274_0x2954d7(0xb6)][a274_0x2954d7(0xb2)](path_2[a274_0x2954d7(0xab)],constants_1[a274_0x2954d7(0xb3)]);