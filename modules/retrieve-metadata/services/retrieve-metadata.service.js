const a274_0x1c90d9=a274_0x3d66;(function(_0x4e1eff,_0x1494bd){const _0x39d137=a274_0x3d66,_0x4aeaa7=_0x4e1eff();while(!![]){try{const _0x3e82be=-parseInt(_0x39d137(0x136))/0x1+-parseInt(_0x39d137(0x12f))/0x2*(parseInt(_0x39d137(0x137))/0x3)+-parseInt(_0x39d137(0x105))/0x4*(parseInt(_0x39d137(0x112))/0x5)+parseInt(_0x39d137(0x128))/0x6*(-parseInt(_0x39d137(0x12e))/0x7)+-parseInt(_0x39d137(0x11c))/0x8*(parseInt(_0x39d137(0x104))/0x9)+parseInt(_0x39d137(0x12b))/0xa*(parseInt(_0x39d137(0x146))/0xb)+-parseInt(_0x39d137(0x10f))/0xc*(-parseInt(_0x39d137(0x11d))/0xd);if(_0x3e82be===_0x1494bd)break;else _0x4aeaa7['push'](_0x4aeaa7['shift']());}catch(_0x300c8c){_0x4aeaa7['push'](_0x4aeaa7['shift']());}}}(a274_0x2b95,0xa350d));const a274_0x2c8a2f=(function(){let _0x2f1c30=!![];return function(_0x55f83a,_0x1949ac){const _0x2559dc=_0x2f1c30?function(){const _0x431fd1=a274_0x3d66;if(_0x1949ac){const _0x18cba7=_0x1949ac[_0x431fd1(0x131)](_0x55f83a,arguments);return _0x1949ac=null,_0x18cba7;}}:function(){};return _0x2f1c30=![],_0x2559dc;};}()),a274_0x10ee77=a274_0x2c8a2f(this,function(){const _0x2b7edb=a274_0x3d66;return a274_0x10ee77[_0x2b7edb(0x10d)]()[_0x2b7edb(0x123)](_0x2b7edb(0x133))[_0x2b7edb(0x10d)]()[_0x2b7edb(0x139)](a274_0x10ee77)[_0x2b7edb(0x123)]('(((.+)+)+)+$');});function a274_0x3d66(_0x3f4cb8,_0x1d7f1d){const _0x3cb3f7=a274_0x2b95();return a274_0x3d66=function(_0x10ee77,_0x2c8a2f){_0x10ee77=_0x10ee77-0xff;let _0x2b95c4=_0x3cb3f7[_0x10ee77];return _0x2b95c4;},a274_0x3d66(_0x3f4cb8,_0x1d7f1d);}a274_0x10ee77();'use strict';var __importDefault=this&&this[a274_0x1c90d9(0x106)]||function(_0x3b7374){const _0x261b80=a274_0x1c90d9;return _0x3b7374&&_0x3b7374[_0x261b80(0x145)]?_0x3b7374:{'default':_0x3b7374};};Object[a274_0x1c90d9(0x10b)](exports,a274_0x1c90d9(0x145),{'value':!![]});const job_utils_1=__importDefault(require('../../shared/utils/job.utils')),path_1=__importDefault(require(a274_0x1c90d9(0x10c))),manifest_manger_1=__importDefault(require(a274_0x1c90d9(0x11f))),state_manger_1=__importDefault(require(a274_0x1c90d9(0x13f))),promises_1=require(a274_0x1c90d9(0x13b)),utils_1=require(a274_0x1c90d9(0x120)),csv_utils_1=__importDefault(require('../../shared/utils/csv.utils')),not_found_error_1=require(a274_0x1c90d9(0x101)),logger_enums_1=require(a274_0x1c90d9(0x13e)),bad_request_error_1=require(a274_0x1c90d9(0x148)),job_1=require(a274_0x1c90d9(0x10e)),fs_utils_1=require(a274_0x1c90d9(0x113)),constants_1=require(a274_0x1c90d9(0x11e)),path_2=require(a274_0x1c90d9(0x122));class RetrieveMetadataService{static async[a274_0x1c90d9(0x12a)](_0x9b6962,_0x3b7800){const _0xf69076=a274_0x1c90d9,_0x2144e0=await job_utils_1[_0xf69076(0x130)][_0xf69076(0x144)](RetrieveMetadataService[_0xf69076(0xff)]),_0x2528b2=await job_utils_1['default'][_0xf69076(0x132)](RetrieveMetadataService[_0xf69076(0xff)],_0x2144e0),_0x1ba61a=_0x2528b2[_0xf69076(0x147)](_0x3b7800,_0x3b7800+_0x9b6962),_0xa245d0=[];for(const _0x9eecd4 of _0x1ba61a){const _0x43c302=await state_manger_1['default'][_0xf69076(0x13a)](path_1['default'][_0xf69076(0x12d)](RetrieveMetadataService['retrieveMetadataFolder'],_0x9eecd4));_0xa245d0[_0xf69076(0x100)](_0x43c302);}return _0xa245d0;}static async[a274_0x1c90d9(0x141)](_0xe3fe91){const _0x3fedf1=a274_0x1c90d9,_0x3cf8fe=job_utils_1[_0x3fedf1(0x130)][_0x3fedf1(0x135)](),_0x11c866=path_1[_0x3fedf1(0x130)][_0x3fedf1(0x12d)](RetrieveMetadataService[_0x3fedf1(0xff)],_0x3cf8fe);await(0x0,fs_utils_1[_0x3fedf1(0x11a)])(_0x11c866),await manifest_manger_1['default'][_0x3fedf1(0x121)](_0x11c866,_0xe3fe91),await state_manger_1[_0x3fedf1(0x130)][_0x3fedf1(0x121)](_0x11c866,_0x3cf8fe);const _0x4d41e0=path_1[_0x3fedf1(0x130)][_0x3fedf1(0x12d)](__dirname,job_1[_0x3fedf1(0x124)]);return job_utils_1[_0x3fedf1(0x130)][_0x3fedf1(0x111)](_0x4d41e0,{'jobStorePath':_0x11c866,'jobId':_0x3cf8fe})[_0x3fedf1(0x11b)](async _0x423a4e=>{const _0x5dd966=_0x3fedf1,_0x2a8128=new state_manger_1[(_0x5dd966(0x130))](_0x11c866);await _0x2a8128['init'](),await _0x2a8128[_0x5dd966(0x13d)](_0x423a4e);}),{'jobId':_0x3cf8fe};}static async[a274_0x1c90d9(0x116)](_0x36a8c0){const _0x421799=a274_0x1c90d9,{status:_0x401820}=await RetrieveMetadataService['getJobStatus'](_0x36a8c0);if(_0x401820===logger_enums_1[_0x421799(0x143)][_0x421799(0x134)])throw new bad_request_error_1[(_0x421799(0x10a))](_0x421799(0x125));const _0x5258b3=path_1[_0x421799(0x130)][_0x421799(0x12d)](RetrieveMetadataService[_0x421799(0xff)],_0x36a8c0,constants_1[_0x421799(0x126)]);if(await utils_1[_0x421799(0x119)][_0x421799(0x109)](_0x5258b3))return(0x0,promises_1[_0x421799(0x142)])(_0x5258b3,_0x421799(0x129))[_0x421799(0x108)](JSON[_0x421799(0x118)]);else throw new not_found_error_1[(_0x421799(0x115))](_0x421799(0x114));}static async[a274_0x1c90d9(0x110)](_0x38de48,_0x3dbb65){const _0x4d4c4c=a274_0x1c90d9,{status:_0x1f832f}=await RetrieveMetadataService[_0x4d4c4c(0x127)](_0x38de48);if(_0x1f832f===logger_enums_1[_0x4d4c4c(0x143)][_0x4d4c4c(0x134)])throw new bad_request_error_1['BadRequestError'](_0x4d4c4c(0x125));const _0x2d749f=path_1[_0x4d4c4c(0x130)]['join'](RetrieveMetadataService[_0x4d4c4c(0xff)],_0x38de48,constants_1[_0x4d4c4c(0x140)]),_0x49b386={'data':[]};if(await utils_1['FsUtils'][_0x4d4c4c(0x109)](path_1[_0x4d4c4c(0x130)][_0x4d4c4c(0x12d)](_0x2d749f,_0x3dbb65+_0x4d4c4c(0x103))))_0x49b386['data']=await(0x0,promises_1['readFile'])(path_1[_0x4d4c4c(0x130)]['join'](_0x2d749f,_0x3dbb65+_0x4d4c4c(0x103)),'utf-8')[_0x4d4c4c(0x108)](JSON['parse']);else throw new not_found_error_1['NotFoundError'](_0x4d4c4c(0x102));return _0x49b386;}static async[a274_0x1c90d9(0x127)](_0x1c6e34){const _0x359a0f=a274_0x1c90d9;try{return await state_manger_1[_0x359a0f(0x130)][_0x359a0f(0x13a)](path_1['default']['join'](RetrieveMetadataService['retrieveMetadataFolder'],_0x1c6e34));}catch(_0x51ee14){throw new not_found_error_1['NotFoundError'](_0x51ee14);}}static async[a274_0x1c90d9(0x107)](_0x2e44a7){const _0x59f998=a274_0x1c90d9,_0x382376=path_1[_0x59f998(0x130)][_0x59f998(0x12d)](RetrieveMetadataService[_0x59f998(0xff)],_0x2e44a7,job_1[_0x59f998(0x117)]);if(await utils_1[_0x59f998(0x119)][_0x59f998(0x109)](_0x382376))return(0x0,promises_1['readFile'])(_0x382376,'utf-8')[_0x59f998(0x108)](_0x4f1eea=>csv_utils_1[_0x59f998(0x130)][_0x59f998(0x118)](_0x4f1eea,{'columns':!![]}));throw new not_found_error_1[(_0x59f998(0x115))](_0x59f998(0x13c));}}function a274_0x2b95(){const _0x527eed=['../../../core/errors/not-found.error','Chunk\x20not\x20found.','.json','3987Xjhhck','184OQtMcZ','__importDefault','getJobLogs','then','isExistsPath','BadRequestError','defineProperty','path','toString','../../../constants/job','32204688IEzVGg','getResultChunk','runJob','89545JutEOZ','../../shared/utils/fs.utils','Result\x20not\x20found.','NotFoundError','getResult','JOB_LOG_DETAILS_FILENAME','parse','FsUtils','makeDir','catch','8BRrDlD','13VTDCkO','../constants','../job/classes/manifest-manger','@flosum/utils','create','../../../configs/path','search','JOB_PATH','Job\x20not\x20completed.','RETRIEVE_RESULTS_IDS_FILENAME','getJobStatus','18bfVgsb','utf-8','getJobs','30ttLZDX','RETRIEVE_METADATA_FOLDER_NAME','join','289506uHUysf','2196938ZzLtHZ','default','apply','sortJobsIds','(((.+)+)+)+$','IN_PROGRESS','generateJobId','1082054cYlbrP','3AfAAjk','dataPath','constructor','getJobState','fs/promises','Job\x20log\x20not\x20found.','setError','../job/enums/logger.enums','../job/classes/state-manger','RETRIEVE_RESULT_FOLDER_NAME','createRetrieveJob','readFile','JobStatus','getJobsIds','__esModule','4084927CmpHiR','slice','../../../core/errors/bad-request.error','retrieveMetadataFolder','push'];a274_0x2b95=function(){return _0x527eed;};return a274_0x2b95();}exports[a274_0x1c90d9(0x130)]=RetrieveMetadataService,RetrieveMetadataService[a274_0x1c90d9(0xff)]=path_1[a274_0x1c90d9(0x130)][a274_0x1c90d9(0x12d)](path_2[a274_0x1c90d9(0x138)],constants_1[a274_0x1c90d9(0x12c)]);