function a319_0x8478(){const _0x3ec35b=['utf-8','379dDeCxJ','__importDefault','.json','getJobStatus','../../shared/utils/csv.utils','getResult','../../shared/enums/logger.enums','apply','@flosum/utils','setError','isExistsPath','slice','../../../core/errors/bad-request.error','Job\x20not\x20completed.','createRetrieveJob','join','../job/classes/manifest-manger','search','RETRIEVE_METADATA_FOLDER_NAME','getJobState','init','(((.+)+)+)+$','../../../constants/job','runJob','path','Result\x20not\x20found.','getJobsIds','564CPtSgH','1831437WUrVxs','__esModule','readFile','Chunk\x20not\x20found.','IN_PROGRESS','5719wiFiXP','getJobs','retrieveMetadataFolder','40zZtLlS','then','create','BadRequestError','../../../core/errors/not-found.error','push','toString','default','Job\x20log\x20not\x20found.','1166sBfGOl','91158CvfERw','JOB_LOG_DETAILS_FILENAME','NotFoundError','getResultChunk','11MIdiuV','../../shared/managers/state-manger','../constants','constructor','2464720qbMsho','FsUtils','fs/promises','1287475TexASA','generateJobId','makeDir','../../shared/utils/fs.utils','../../../configs/path','JobStatus','parse','../../shared/utils/job.utils','1523648FQIBkz','catch'];a319_0x8478=function(){return _0x3ec35b;};return a319_0x8478();}const a319_0xfeeefa=a319_0xc0c2;(function(_0x181c86,_0x419dff){const _0x339f3d=a319_0xc0c2,_0x18fdac=_0x181c86();while(!![]){try{const _0x9d317e=parseInt(_0x339f3d(0x162))/0x1*(-parseInt(_0x339f3d(0x18f))/0x2)+-parseInt(_0x339f3d(0x190))/0x3*(-parseInt(_0x339f3d(0x186))/0x4)+parseInt(_0x339f3d(0x19b))/0x5+parseInt(_0x339f3d(0x17d))/0x6*(parseInt(_0x339f3d(0x183))/0x7)+parseInt(_0x339f3d(0x15f))/0x8+-parseInt(_0x339f3d(0x17e))/0x9+parseInt(_0x339f3d(0x198))/0xa*(-parseInt(_0x339f3d(0x194))/0xb);if(_0x9d317e===_0x419dff)break;else _0x18fdac['push'](_0x18fdac['shift']());}catch(_0x141a09){_0x18fdac['push'](_0x18fdac['shift']());}}}(a319_0x8478,0x267f7));const a319_0x5cf6cd=(function(){let _0x367b1a=!![];return function(_0xc87169,_0x38e04a){const _0x56f548=_0x367b1a?function(){const _0xe1be25=a319_0xc0c2;if(_0x38e04a){const _0x5542ce=_0x38e04a[_0xe1be25(0x169)](_0xc87169,arguments);return _0x38e04a=null,_0x5542ce;}}:function(){};return _0x367b1a=![],_0x56f548;};}()),a319_0x5a530f=a319_0x5cf6cd(this,function(){const _0x31f71d=a319_0xc0c2;return a319_0x5a530f[_0x31f71d(0x18c)]()['search'](_0x31f71d(0x177))[_0x31f71d(0x18c)]()[_0x31f71d(0x197)](a319_0x5a530f)[_0x31f71d(0x173)]('(((.+)+)+)+$');});function a319_0xc0c2(_0xd250f,_0x5d882a){const _0x2b0134=a319_0x8478();return a319_0xc0c2=function(_0x5a530f,_0x5cf6cd){_0x5a530f=_0x5a530f-0x15d;let _0x8478f0=_0x2b0134[_0x5a530f];return _0x8478f0;},a319_0xc0c2(_0xd250f,_0x5d882a);}a319_0x5a530f();'use strict';var __importDefault=this&&this[a319_0xfeeefa(0x163)]||function(_0x5605fa){return _0x5605fa&&_0x5605fa['__esModule']?_0x5605fa:{'default':_0x5605fa};};Object['defineProperty'](exports,a319_0xfeeefa(0x17f),{'value':!![]});const job_utils_1=__importDefault(require(a319_0xfeeefa(0x15e))),path_1=__importDefault(require(a319_0xfeeefa(0x17a))),manifest_manger_1=__importDefault(require(a319_0xfeeefa(0x172))),state_manger_1=__importDefault(require(a319_0xfeeefa(0x195))),promises_1=require(a319_0xfeeefa(0x19a)),utils_1=require(a319_0xfeeefa(0x16a)),csv_utils_1=__importDefault(require(a319_0xfeeefa(0x166))),not_found_error_1=require(a319_0xfeeefa(0x18a)),logger_enums_1=require(a319_0xfeeefa(0x168)),bad_request_error_1=require(a319_0xfeeefa(0x16e)),job_1=require(a319_0xfeeefa(0x178)),fs_utils_1=require(a319_0xfeeefa(0x19e)),constants_1=require(a319_0xfeeefa(0x196)),path_2=require(a319_0xfeeefa(0x19f));class RetrieveMetadataService{static async[a319_0xfeeefa(0x184)](_0x7671dc,_0x156ac2){const _0x3b4cc3=a319_0xfeeefa,_0x2441a3=await job_utils_1[_0x3b4cc3(0x18d)][_0x3b4cc3(0x17c)](RetrieveMetadataService[_0x3b4cc3(0x185)]),_0x3164a9=await job_utils_1['default']['sortJobsIds'](RetrieveMetadataService[_0x3b4cc3(0x185)],_0x2441a3),_0x58e202=_0x3164a9[_0x3b4cc3(0x16d)](_0x156ac2,_0x156ac2+_0x7671dc),_0x4d09f6=[];for(const _0x4d70b3 of _0x58e202){const _0x3e1886=await state_manger_1['default']['getJobState'](path_1['default']['join'](RetrieveMetadataService[_0x3b4cc3(0x185)],_0x4d70b3));_0x4d09f6[_0x3b4cc3(0x18b)](_0x3e1886);}return _0x4d09f6;}static async[a319_0xfeeefa(0x170)](_0x4aa2a7){const _0x116058=a319_0xfeeefa,_0x424055=job_utils_1[_0x116058(0x18d)][_0x116058(0x19c)](),_0xbd92ad=path_1[_0x116058(0x18d)]['join'](RetrieveMetadataService['retrieveMetadataFolder'],_0x424055);await(0x0,fs_utils_1[_0x116058(0x19d)])(_0xbd92ad),await manifest_manger_1[_0x116058(0x18d)][_0x116058(0x188)](_0xbd92ad,_0x4aa2a7),await state_manger_1[_0x116058(0x18d)][_0x116058(0x188)](_0xbd92ad,_0x424055);const _0x4702f4=path_1[_0x116058(0x18d)][_0x116058(0x171)](__dirname,job_1['JOB_PATH']);return job_utils_1[_0x116058(0x18d)][_0x116058(0x179)](_0x4702f4,{'jobStorePath':_0xbd92ad,'jobId':_0x424055})[_0x116058(0x160)](async _0x5a9e2e=>{const _0x4c68db=_0x116058,_0x556a35=new state_manger_1[(_0x4c68db(0x18d))](_0xbd92ad);await _0x556a35[_0x4c68db(0x176)](),await _0x556a35[_0x4c68db(0x16b)](_0x5a9e2e);}),{'jobId':_0x424055};}static async[a319_0xfeeefa(0x167)](_0xebcf18){const _0x1c7ddd=a319_0xfeeefa,{status:_0x5e3d75}=await RetrieveMetadataService[_0x1c7ddd(0x165)](_0xebcf18);if(_0x5e3d75===logger_enums_1[_0x1c7ddd(0x1a0)][_0x1c7ddd(0x182)])throw new bad_request_error_1[(_0x1c7ddd(0x189))]('Job\x20not\x20completed.');const _0x59311d=path_1['default'][_0x1c7ddd(0x171)](RetrieveMetadataService[_0x1c7ddd(0x185)],_0xebcf18,constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);if(await utils_1[_0x1c7ddd(0x199)][_0x1c7ddd(0x16c)](_0x59311d))return(0x0,promises_1[_0x1c7ddd(0x180)])(_0x59311d,_0x1c7ddd(0x161))[_0x1c7ddd(0x187)](JSON[_0x1c7ddd(0x15d)]);else throw new not_found_error_1[(_0x1c7ddd(0x192))](_0x1c7ddd(0x17b));}static async[a319_0xfeeefa(0x193)](_0x5e95ee,_0x4fee11){const _0x3b5929=a319_0xfeeefa,{status:_0x291f1f}=await RetrieveMetadataService[_0x3b5929(0x165)](_0x5e95ee);if(_0x291f1f===logger_enums_1[_0x3b5929(0x1a0)][_0x3b5929(0x182)])throw new bad_request_error_1[(_0x3b5929(0x189))](_0x3b5929(0x16f));const _0x46ff4a=path_1[_0x3b5929(0x18d)][_0x3b5929(0x171)](RetrieveMetadataService[_0x3b5929(0x185)],_0x5e95ee,constants_1['RETRIEVE_RESULT_FOLDER_NAME']),_0x2d6fe2={'data':[]};if(await utils_1[_0x3b5929(0x199)][_0x3b5929(0x16c)](path_1[_0x3b5929(0x18d)]['join'](_0x46ff4a,_0x4fee11+_0x3b5929(0x164))))_0x2d6fe2['data']=await(0x0,promises_1[_0x3b5929(0x180)])(path_1[_0x3b5929(0x18d)]['join'](_0x46ff4a,_0x4fee11+_0x3b5929(0x164)),_0x3b5929(0x161))[_0x3b5929(0x187)](JSON[_0x3b5929(0x15d)]);else throw new not_found_error_1[(_0x3b5929(0x192))](_0x3b5929(0x181));return _0x2d6fe2;}static async[a319_0xfeeefa(0x165)](_0x47a2bc){const _0x5e658c=a319_0xfeeefa;try{return await state_manger_1['default'][_0x5e658c(0x175)](path_1[_0x5e658c(0x18d)][_0x5e658c(0x171)](RetrieveMetadataService[_0x5e658c(0x185)],_0x47a2bc));}catch(_0x54a448){throw new not_found_error_1[(_0x5e658c(0x192))](_0x54a448);}}static async['getJobLogs'](_0x48e2f6){const _0x16b4d6=a319_0xfeeefa,_0x2e477e=path_1[_0x16b4d6(0x18d)]['join'](RetrieveMetadataService[_0x16b4d6(0x185)],_0x48e2f6,job_1[_0x16b4d6(0x191)]);if(await utils_1['FsUtils']['isExistsPath'](_0x2e477e))return(0x0,promises_1[_0x16b4d6(0x180)])(_0x2e477e,_0x16b4d6(0x161))[_0x16b4d6(0x187)](_0x4e051e=>csv_utils_1[_0x16b4d6(0x18d)]['parse'](_0x4e051e,{'columns':!![]}));throw new not_found_error_1[(_0x16b4d6(0x192))](_0x16b4d6(0x18e));}}exports[a319_0xfeeefa(0x18d)]=RetrieveMetadataService,RetrieveMetadataService['retrieveMetadataFolder']=path_1[a319_0xfeeefa(0x18d)][a319_0xfeeefa(0x171)](path_2['dataPath'],constants_1[a319_0xfeeefa(0x174)]);