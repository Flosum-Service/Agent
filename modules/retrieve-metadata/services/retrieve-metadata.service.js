const a293_0x182696=a293_0x4864;function a293_0x4864(_0x14bdbf,_0x509291){const _0x25e303=a293_0x52cd();return a293_0x4864=function(_0x5592e7,_0x1c2e00){_0x5592e7=_0x5592e7-0x19d;let _0x52cd26=_0x25e303[_0x5592e7];return _0x52cd26;},a293_0x4864(_0x14bdbf,_0x509291);}(function(_0x531885,_0x5d004e){const _0x507e89=a293_0x4864,_0x16385e=_0x531885();while(!![]){try{const _0x15fd67=-parseInt(_0x507e89(0x1ab))/0x1*(-parseInt(_0x507e89(0x1b9))/0x2)+-parseInt(_0x507e89(0x1cc))/0x3*(parseInt(_0x507e89(0x1c3))/0x4)+-parseInt(_0x507e89(0x1c0))/0x5+-parseInt(_0x507e89(0x1bd))/0x6+-parseInt(_0x507e89(0x1ce))/0x7+parseInt(_0x507e89(0x1ca))/0x8*(parseInt(_0x507e89(0x1a2))/0x9)+parseInt(_0x507e89(0x1d6))/0xa*(parseInt(_0x507e89(0x1d4))/0xb);if(_0x15fd67===_0x5d004e)break;else _0x16385e['push'](_0x16385e['shift']());}catch(_0x3699d3){_0x16385e['push'](_0x16385e['shift']());}}}(a293_0x52cd,0x3caf7));const a293_0x1c2e00=(function(){let _0x486053=!![];return function(_0x438135,_0x5757ba){const _0x3e2c2a=_0x486053?function(){const _0x953f65=a293_0x4864;if(_0x5757ba){const _0x19db92=_0x5757ba[_0x953f65(0x1d3)](_0x438135,arguments);return _0x5757ba=null,_0x19db92;}}:function(){};return _0x486053=![],_0x3e2c2a;};}()),a293_0x5592e7=a293_0x1c2e00(this,function(){const _0x2a14e7=a293_0x4864;return a293_0x5592e7['toString']()['search'](_0x2a14e7(0x1de))[_0x2a14e7(0x1b4)]()[_0x2a14e7(0x1a7)](a293_0x5592e7)[_0x2a14e7(0x1b8)](_0x2a14e7(0x1de));});a293_0x5592e7();'use strict';var __importDefault=this&&this[a293_0x182696(0x1cb)]||function(_0x4436ed){const _0xfeaf65=a293_0x182696;return _0x4436ed&&_0x4436ed[_0xfeaf65(0x1a9)]?_0x4436ed:{'default':_0x4436ed};};Object[a293_0x182696(0x1d1)](exports,a293_0x182696(0x1a9),{'value':!![]});const job_utils_1=__importDefault(require(a293_0x182696(0x1bf))),path_1=__importDefault(require(a293_0x182696(0x1e2))),manifest_manger_1=__importDefault(require(a293_0x182696(0x1b3))),state_manger_1=__importDefault(require(a293_0x182696(0x1b7))),promises_1=require(a293_0x182696(0x1b0)),utils_1=require(a293_0x182696(0x1c9)),csv_utils_1=__importDefault(require(a293_0x182696(0x1c7))),not_found_error_1=require(a293_0x182696(0x1d8)),logger_enums_1=require(a293_0x182696(0x1a3)),bad_request_error_1=require(a293_0x182696(0x19f)),job_1=require(a293_0x182696(0x1c8)),fs_utils_1=require('../../shared/utils/fs.utils'),constants_1=require('../constants'),path_2=require(a293_0x182696(0x1af));class RetrieveMetadataService{static async[a293_0x182696(0x1d2)](_0x3439dd,_0x526cec){const _0x367eee=a293_0x182696,_0x2f3f39=await job_utils_1[_0x367eee(0x1b5)][_0x367eee(0x19d)](RetrieveMetadataService[_0x367eee(0x1c6)]),_0x3ade23=await job_utils_1['default']['sortJobsIds'](RetrieveMetadataService[_0x367eee(0x1c6)],_0x2f3f39),_0x22554d=_0x3ade23[_0x367eee(0x1a1)](_0x526cec,_0x526cec+_0x3439dd),_0x230208=[];for(const _0x3eefd5 of _0x22554d){const _0x204b94=await state_manger_1[_0x367eee(0x1b5)][_0x367eee(0x1d9)](path_1['default'][_0x367eee(0x1a6)](RetrieveMetadataService[_0x367eee(0x1c6)],_0x3eefd5));_0x230208[_0x367eee(0x1b1)](_0x204b94);}return _0x230208;}static async[a293_0x182696(0x1d5)](_0x2b6523){const _0x225052=a293_0x182696,_0x378935=job_utils_1[_0x225052(0x1b5)][_0x225052(0x1c2)](),_0xee2ac0=path_1[_0x225052(0x1b5)][_0x225052(0x1a6)](RetrieveMetadataService[_0x225052(0x1c6)],_0x378935);await(0x0,fs_utils_1[_0x225052(0x1e1)])(_0xee2ac0),await manifest_manger_1[_0x225052(0x1b5)]['create'](_0xee2ac0,_0x2b6523),await state_manger_1[_0x225052(0x1b5)][_0x225052(0x1c1)](_0xee2ac0,_0x378935);const _0x2a1106=path_1[_0x225052(0x1b5)][_0x225052(0x1a6)](__dirname,job_1[_0x225052(0x1aa)]);return job_utils_1[_0x225052(0x1b5)][_0x225052(0x1dd)](_0x2a1106,{'jobStorePath':_0xee2ac0,'jobId':_0x378935})[_0x225052(0x1ba)](async _0x393a24=>{const _0x3ecb38=_0x225052,_0x3c3c0b=new state_manger_1[(_0x3ecb38(0x1b5))](_0xee2ac0);await _0x3c3c0b[_0x3ecb38(0x1c4)](),await _0x3c3c0b[_0x3ecb38(0x1c5)](_0x393a24);}),{'jobId':_0x378935};}static async[a293_0x182696(0x1cf)](_0x24ed54){const _0x30f1f7=a293_0x182696,{status:_0x1cf95a}=await RetrieveMetadataService[_0x30f1f7(0x1ac)](_0x24ed54);if(_0x1cf95a===logger_enums_1[_0x30f1f7(0x1a4)][_0x30f1f7(0x1b2)])throw new bad_request_error_1[(_0x30f1f7(0x19e))](_0x30f1f7(0x1d0));const _0x378e1f=path_1['default'][_0x30f1f7(0x1a6)](RetrieveMetadataService[_0x30f1f7(0x1c6)],_0x24ed54,constants_1['RETRIEVE_RESULTS_IDS_FILENAME']);if(await utils_1[_0x30f1f7(0x1ad)][_0x30f1f7(0x1a0)](_0x378e1f))return(0x0,promises_1['readFile'])(_0x378e1f,_0x30f1f7(0x1a8))[_0x30f1f7(0x1df)](JSON[_0x30f1f7(0x1da)]);else throw new not_found_error_1[(_0x30f1f7(0x1cd))](_0x30f1f7(0x1dc));}static async[a293_0x182696(0x1a5)](_0x2a37ad,_0x375915){const _0x5615b7=a293_0x182696,{status:_0x21ff1c}=await RetrieveMetadataService[_0x5615b7(0x1ac)](_0x2a37ad);if(_0x21ff1c===logger_enums_1[_0x5615b7(0x1a4)][_0x5615b7(0x1b2)])throw new bad_request_error_1['BadRequestError'](_0x5615b7(0x1d0));const _0xbc36e0=path_1[_0x5615b7(0x1b5)][_0x5615b7(0x1a6)](RetrieveMetadataService[_0x5615b7(0x1c6)],_0x2a37ad,constants_1[_0x5615b7(0x1e0)]),_0x349dbb={'data':[]};if(await utils_1[_0x5615b7(0x1ad)][_0x5615b7(0x1a0)](path_1[_0x5615b7(0x1b5)]['join'](_0xbc36e0,_0x375915+_0x5615b7(0x1e3))))_0x349dbb[_0x5615b7(0x1be)]=await(0x0,promises_1[_0x5615b7(0x1bc)])(path_1['default']['join'](_0xbc36e0,_0x375915+_0x5615b7(0x1e3)),_0x5615b7(0x1a8))['then'](JSON[_0x5615b7(0x1da)]);else throw new not_found_error_1[(_0x5615b7(0x1cd))](_0x5615b7(0x1bb));return _0x349dbb;}static async[a293_0x182696(0x1ac)](_0x4f1237){const _0x2e474d=a293_0x182696;try{return await state_manger_1[_0x2e474d(0x1b5)]['getJobState'](path_1[_0x2e474d(0x1b5)]['join'](RetrieveMetadataService[_0x2e474d(0x1c6)],_0x4f1237));}catch(_0x3e4685){throw new not_found_error_1[(_0x2e474d(0x1cd))](_0x3e4685);}}static async[a293_0x182696(0x1ae)](_0x50249a){const _0x29d977=a293_0x182696,_0x1e3d00=path_1[_0x29d977(0x1b5)][_0x29d977(0x1a6)](RetrieveMetadataService['retrieveMetadataFolder'],_0x50249a,job_1[_0x29d977(0x1d7)]);if(await utils_1[_0x29d977(0x1ad)][_0x29d977(0x1a0)](_0x1e3d00))return(0x0,promises_1[_0x29d977(0x1bc)])(_0x1e3d00,_0x29d977(0x1a8))['then'](_0x2e83d9=>csv_utils_1[_0x29d977(0x1b5)][_0x29d977(0x1da)](_0x2e83d9,{'columns':!![]}));throw new not_found_error_1[(_0x29d977(0x1cd))](_0x29d977(0x1db));}}exports[a293_0x182696(0x1b5)]=RetrieveMetadataService,RetrieveMetadataService[a293_0x182696(0x1c6)]=path_1[a293_0x182696(0x1b5)][a293_0x182696(0x1a6)](path_2['dataPath'],constants_1[a293_0x182696(0x1b6)]);function a293_0x52cd(){const _0x4ea148=['IN_PROGRESS','../job/classes/manifest-manger','toString','default','RETRIEVE_METADATA_FOLDER_NAME','../../shared/managers/state-manger','search','2DfAezM','catch','Chunk\x20not\x20found.','readFile','2837088VvnTmf','data','../../shared/utils/job.utils','2440080LDNkZI','create','generateJobId','4zuwaUI','init','setError','retrieveMetadataFolder','../../shared/utils/csv.utils','../../../constants/job','@flosum/utils','2488jcpoDl','__importDefault','10401xDBSZt','NotFoundError','2147936vKnyyR','getResult','Job\x20not\x20completed.','defineProperty','getJobs','apply','41129EqoZkI','createRetrieveJob','2470BRurDo','JOB_LOG_DETAILS_FILENAME','../../../core/errors/not-found.error','getJobState','parse','Job\x20log\x20not\x20found.','Result\x20not\x20found.','runJob','(((.+)+)+)+$','then','RETRIEVE_RESULT_FOLDER_NAME','makeDir','path','.json','getJobsIds','BadRequestError','../../../core/errors/bad-request.error','isExistsPath','slice','4464bEUCjF','../../shared/enums/logger.enums','JobStatus','getResultChunk','join','constructor','utf-8','__esModule','JOB_PATH','441957bZgvEh','getJobStatus','FsUtils','getJobLogs','../../../configs/path','fs/promises','push'];a293_0x52cd=function(){return _0x4ea148;};return a293_0x52cd();}